{"hands_on_practices": [{"introduction": "Before we can navigate the complexities of nonlinear systems, we must first master the linear landscape. This foundational exercise grounds our understanding in the behavior of linear systems, which form the basis for the Center Manifold Theorem. By dissecting a linear system into its core components—the stable, center, and unstable subspaces—you will build crucial intuition about how a system's modes evolve over time and verify the fundamental property of subspace invariance [@problem_id:2691770].", "problem": "Consider the Linear Time-Invariant (LTI) system $\\dot{x}=A x$ with $A=\\mathrm{diag}(0,0,-1,2)\\in\\mathbb{R}^{4\\times 4}$. In the context of the center manifold theorem, one decomposes the state space into the direct sum of the stable, center, and unstable subspaces $E^{s}$, $E^{c}$, and $E^{u}$, respectively. Starting only from the fundamental definitions that $E^{s}$ is spanned by generalized eigenvectors associated with eigenvalues of $A$ whose real parts are strictly negative, $E^{c}$ is spanned by generalized eigenvectors associated with eigenvalues whose real parts are zero, and $E^{u}$ is spanned by generalized eigenvectors associated with eigenvalues whose real parts are strictly positive:\n\n1. Determine the eigenvalues and corresponding eigenspaces of $A$, and from them compute the decomposition $\\mathbb{R}^{4}=E^{s}\\oplus E^{c}\\oplus E^{u}$ by providing explicit bases for $E^{s}$, $E^{c}$, and $E^{u}$.\n\n2. Prove that each subspace is $A$-invariant, in the sense that $A E^{\\sigma}\\subseteq E^{\\sigma}$ for $\\sigma\\in\\{s,c,u\\}$, by direct argument from the definitions and the structure of $A$.\n\n3. Construct the projection matrices $P^{s}$, $P^{c}$, and $P^{u}$ onto $E^{s}$, $E^{c}$, and $E^{u}$, respectively, along the direct sum decomposition $\\mathbb{R}^{4}=E^{s}\\oplus E^{c}\\oplus E^{u}$. Verify from first principles that $P^{\\sigma}$ is idempotent, that $P^{s}+P^{c}+P^{u}=I$, that $P^{\\sigma}P^{\\tau}=0$ for $\\sigma\\neq\\tau$, and that $A P^{\\sigma}=P^{\\sigma} A$ for each $\\sigma\\in\\{s,c,u\\}$, thereby confirming invariance.\n\nReport your final answer as the ordered triple of projection matrices $(P^{s},P^{c},P^{u})$ presented as a single row matrix. No rounding is required.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard exercise in linear systems theory, requiring the application of fundamental definitions of eigenspaces, invariant subspaces, and projection operators to a specified system. All necessary information is provided, and the tasks are unambiguous. We proceed with the solution.\n\nThe system under consideration is the Linear Time-Invariant (LTI) system $\\dot{x}=A x$, where the state $x \\in \\mathbb{R}^{4}$ and the matrix $A \\in \\mathbb{R}^{4\\times 4}$ is given by\n$$\nA = \\mathrm{diag}(0, 0, -1, 2) = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix}.\n$$\nThe state space $\\mathbb{R}^{4}$ is to be decomposed into the direct sum of the stable, center, and unstable subspaces, $E^{s} \\oplus E^{c} \\oplus E^{u}$.\n\n**1. Eigenvalues, Eigenspaces, and Subspace Decomposition**\n\nFirst, we determine the eigenvalues and corresponding eigenspaces of the matrix $A$. Since $A$ is a diagonal matrix, its eigenvalues are the diagonal entries: $\\lambda_{1}=0$, $\\lambda_{2}=0$, $\\lambda_{3}=-1$, and $\\lambda_{4}=2$.\n\nThe eigenspace for an eigenvalue $\\lambda$ is the null space of the matrix $(A - \\lambda I)$. Let $v = (v_{1}, v_{2}, v_{3}, v_{4})^{T}$ be an eigenvector.\n\nFor $\\lambda=0$:\nThe eigenspace is the null space of $A$. The equation $Av=0$ gives:\n$$\n\\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} -v_{3} = 0 \\\\ 2v_{4} = 0 \\end{cases}\n$$\nThis implies $v_{3}=0$ and $v_{4}=0$, while $v_{1}$ and $v_{2}$ are arbitrary. The eigenspace is spanned by the standard basis vectors $e_{1} = (1, 0, 0, 0)^{T}$ and $e_{2} = (0, 1, 0, 0)^{T}$. The geometric multiplicity is $2$, which equals the algebraic multiplicity of the eigenvalue $\\lambda=0$.\n\nFor $\\lambda=-1$:\nThe eigenspace is the null space of $(A - (-1)I) = A + I$. The equation $(A+I)v=0$ gives:\n$$\n\\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} v_{1} = 0 \\\\ v_{2} = 0 \\\\ 3v_{4} = 0 \\end{cases}\n$$\nThis implies $v_{1}=0$, $v_{2}=0$, and $v_{4}=0$, while $v_{3}$ is arbitrary. The eigenspace is spanned by the standard basis vector $e_{3} = (0, 0, 1, 0)^{T}$.\n\nFor $\\lambda=2$:\nThe eigenspace is the null space of $(A-2I)$. The equation $(A-2I)v=0$ gives:\n$$\n\\begin{pmatrix} -2 & 0 & 0 & 0 \\\\ 0 & -2 & 0 & 0 \\\\ 0 & 0 & -3 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} -2v_{1} = 0 \\\\ -2v_{2} = 0 \\\\ -3v_{3} = 0 \\end{cases}\n$$\nThis implies $v_{1}=0$, $v_{2}=0$, and $v_{3}=0$, while $v_{4}$ is arbitrary. The eigenspace is spanned by the standard basis vector $e_{4} = (0, 0, 0, 1)^{T}$.\n\nSince for each eigenvalue the geometric multiplicity equals the algebraic multiplicity, there are no non-trivial generalized eigenvectors. The generalized eigenspaces are identical to the eigenspaces.\n\nNow, we construct the subspaces $E^{s}$, $E^{c}$, and $E^{u}$ based on the real parts of the eigenvalues.\n- The stable subspace $E^{s}$ is spanned by eigenvectors corresponding to eigenvalues with strictly negative real parts. The only such eigenvalue is $\\lambda = -1$.\n  $$E^{s} = \\mathrm{span}\\{e_{3}\\}$$\n  A basis for $E^{s}$ is $\\{e_{3} = (0, 0, 1, 0)^{T}\\}$.\n- The center subspace $E^{c}$ is spanned by eigenvectors corresponding to eigenvalues with zero real parts. The only such eigenvalue is $\\lambda = 0$.\n  $$E^{c} = \\mathrm{span}\\{e_{1}, e_{2}\\}$$\n  A basis for $E^{c}$ is $\\{e_{1} = (1, 0, 0, 0)^{T}, e_{2} = (0, 1, 0, 0)^{T}\\}$.\n- The unstable subspace $E^{u}$ is spanned by eigenvectors corresponding to eigenvalues with strictly positive real parts. The only such eigenvalue is $\\lambda = 2$.\n  $$E^{u} = \\mathrm{span}\\{e_{4}\\}$$\n  A basis for $E^{u}$ is $\\{e_{4} = (0, 0, 0, 1)^{T}\\}$.\n\nThe set of basis vectors $\\{e_{3}, e_{1}, e_{2}, e_{4}\\}$ is a permutation of the standard basis for $\\mathbb{R}^{4}$, confirming the direct sum decomposition $\\mathbb{R}^{4} = E^{s} \\oplus E^{c} \\oplus E^{u}$.\n\n**2. Proof of A-invariance**\n\nWe prove that $A E^{\\sigma} \\subseteq E^{\\sigma}$ for $\\sigma \\in \\{s, c, u\\}$. A subspace $E$ is $A$-invariant if for any vector $v \\in E$, the vector $Av$ is also in $E$.\n\n- For $E^{s}$: Let $v \\in E^{s}$. Then $v = c e_{3}$ for some scalar $c \\in \\mathbb{R}$.\n  $Av = A(c e_{3}) = c(A e_{3})$. Since $e_{3}$ is an eigenvector with eigenvalue $-1$, $A e_{3} = -1 \\cdot e_{3}$.\n  Thus, $Av = c(-1 \\cdot e_{3}) = (-c)e_{3}$, which is a scalar multiple of $e_{3}$ and therefore lies in $E^{s}$. So, $A E^{s} \\subseteq E^{s}$.\n\n- For $E^{c}$: Let $v \\in E^{c}$. Then $v = c_{1}e_{1} + c_{2}e_{2}$ for some scalars $c_{1}, c_{2} \\in \\mathbb{R}$.\n  $Av = A(c_{1}e_{1} + c_{2}e_{2}) = c_{1}(A e_{1}) + c_{2}(A e_{2})$. Since $e_{1}$ and $e_{2}$ are eigenvectors with eigenvalue $0$, $A e_{1} = 0$ and $A e_{2} = 0$.\n  Thus, $Av = c_{1}(0) + c_{2}(0) = 0$. The zero vector is in every subspace, including $E^{c}$. So, $A E^{c} \\subseteq E^{c}$.\n\n- For $E^{u}$: Let $v \\in E^{u}$. Then $v = c e_{4}$ for some scalar $c \\in \\mathbb{R}$.\n  $Av = A(c e_{4}) = c(A e_{4})$. Since $e_{4}$ is an eigenvector with eigenvalue $2$, $A e_{4} = 2 \\cdot e_{4}$.\n  Thus, $Av = c(2 \\cdot e_{4}) = (2c)e_{4}$, which is a scalar multiple of $e_{4}$ and therefore lies in $E^{u}$. So, $A E^{u} \\subseteq E^{u}$.\n\nEach subspace is indeed $A$-invariant.\n\n**3. Projection Matrices and Verification**\n\nAny vector $x = (x_{1}, x_{2}, x_{3}, x_{4})^{T} \\in \\mathbb{R}^{4}$ can be written as $x = x_{1}e_{1} + x_{2}e_{2} + x_{3}e_{3} + x_{4}e_{4}$. We can uniquely decompose $x$ as $x = x^{s} + x^{c} + x^{u}$, where $x^{\\sigma} \\in E^{\\sigma}$.\n$x^{s} = x_{3}e_{3} = (0, 0, x_{3}, 0)^{T}$\n$x^{c} = x_{1}e_{1} + x_{2}e_{2} = (x_{1}, x_{2}, 0, 0)^{T}$\n$x^{u} = x_{4}e_{4} = (0, 0, 0, x_{4})^{T}$\n\nThe projection matrices $P^{\\sigma}$ are defined by $P^{\\sigma}x = x^{\\sigma}$.\n- $P^{s}x = x^{s}$ implies $P^{s} = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} = \\mathrm{diag}(0, 0, 1, 0)$.\n- $P^{c}x = x^{c}$ implies $P^{c} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} = \\mathrm{diag}(1, 1, 0, 0)$.\n- $P^{u}x = x^{u}$ implies $P^{u} = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} = \\mathrm{diag}(0, 0, 0, 1)$.\n\nWe verify the required properties:\n- **Idempotency ($P^{\\sigma}P^{\\sigma} = P^{\\sigma}$)**: Since all $P^{\\sigma}$ are diagonal matrices with entries being either $0$ or $1$, squaring them squares the diagonal entries. As $0^{2}=0$ and $1^{2}=1$, the matrices are unchanged. For example, $(P^{s})^{2} = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(0,0,1,0) = \\mathrm{diag}(0^{2},0^{2},1^{2},0^{2}) = P^{s}$. The same holds for $P^{c}$ and $P^{u}$.\n\n- **Completeness ($P^{s}+P^{c}+P^{u}=I$)**:\n  $$P^{s}+P^{c}+P^{u} = \\mathrm{diag}(0,0,1,0) + \\mathrm{diag(1,1,0,0)} + \\mathrm{diag}(0,0,0,1) = \\mathrm{diag}(0+1+0, 0+1+0, 1+0+0, 0+0+1) = \\mathrm{diag}(1,1,1,1) = I_{4}.$$\n\n- **Orthogonality ($P^{\\sigma}P^{\\tau}=0$ for $\\sigma\\neq\\tau$)**: The product of diagonal matrices is a diagonal matrix of the products of corresponding entries. The non-zero entries of $P^{s}$, $P^{c}$, and $P^{u}$ are in disjoint positions.\n  $$P^{s}P^{c} = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(1,1,0,0) = \\mathrm{diag}(0,0,0,0) = 0.$$\n  $$P^{s}P^{u} = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(0,0,0,1) = \\mathrm{diag}(0,0,0,0) = 0.$$\n  $$P^{c}P^{u} = \\mathrm{diag}(1,1,0,0)\\mathrm{diag}(0,0,0,1) = \\mathrm{diag}(0,0,0,0) = 0.$$\n\n- **Commutation with A ($A P^{\\sigma}=P^{\\sigma} A$)**: Since $A$ and all $P^{\\sigma}$ are diagonal matrices, they commute. We verify this explicitly.\n  For $\\sigma=s$:\n  $A P^{s} = \\mathrm{diag}(0,0,-1,2)\\mathrm{diag}(0,0,1,0) = \\mathrm{diag}(0,0,-1,0)$.\n  $P^{s} A = \\mathrm{diag}(0,0,1,0)\\mathrm{diag}(0,0,-1,2) = \\mathrm{diag}(0,0,-1,0)$.\n  For $\\sigma=c$:\n  $A P^{c} = \\mathrm{diag}(0,0,-1,2)\\mathrm{diag}(1,1,0,0) = \\mathrm{diag}(0,0,0,0) = 0$.\n  $P^{c} A = \\mathrm{diag}(1,1,0,0)\\mathrm{diag}(0,0,-1,2) = \\mathrm{diag}(0,0,0,0) = 0$.\n  For $\\sigma=u$:\n  $A P^{u} = \\mathrm{diag}(0,0,-1,2)\\mathrm{diag}(0,0,0,1) = \\mathrm{diag}(0,0,0,2)$.\n  $P^{u} A = \\mathrm{diag}(0,0,0,1)\\mathrm{diag}(0,0,-1,2) = \\mathrm{diag}(0,0,0,2)$.\nAll properties are verified from first principles.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n&\n\\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}\n&\n\\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$", "id": "2691770"}, {"introduction": "With the linear foundation in place, we now turn to the heart of the theorem: its application to nonlinear systems. The central idea is that the essential dynamics near an equilibrium are captured on a lower-dimensional, curved surface known as the center manifold. This practice provides a step-by-step guide for calculating a local approximation of this manifold and deriving the reduced dynamics, a core skill for analyzing the stability of nonlinear systems where linearization fails to give a conclusive answer [@problem_id:2691758].", "problem": "Consider the autonomous nonlinear system in state variables $x$ and $z$ given by\n$$\n\\dot{x} = z, \\qquad \\dot{z} = -z + x^{2},\n$$\nwith equilibrium at the origin $(x,z)=(0,0)$. In the sense of the Center Manifold Theorem from nonlinear systems and control, there exists a one-dimensional center manifold through the origin tangent to the center subspace of the linearization. Starting only from the fundamental definitions of linearization, invariant manifolds, and the chain rule for differentiation, do the following:\n\n1. Justify the existence of a one-dimensional center manifold for the system at the origin by analyzing the linearization and its spectrum. Specify the associated center subspace.\n\n2. Parameterize a local invariant manifold as a graph $z = w(x)$ with $w(0)=0$ and $w'(0)=0$. Using only the invariance condition derived from the chain rule and the system dynamics, determine the coefficients in the Taylor expansion\n$$\nw(x) = a x^{2} + b x^{3} + \\mathcal{O}(x^{4})\n$$\nneeded to obtain the second-order approximation. Report explicitly the second-order approximation $w_{2}(x)$.\n\n3. Derive the reduced scalar dynamics on the center manifold up to and including the cubic term. Using this reduced dynamics, classify the local stability type of the origin for the full system (e.g., asymptotically stable, unstable, or one-sided/semi-stable), and explain the reasoning.\n\nAnswer specification:\n- Your final reported expressions should be the second-order center manifold approximation $w_{2}(x)$ and the reduced scalar dynamics on it truncated to cubic order. Express the final answer as a row matrix $\\begin{pmatrix} w_{2}(x) & f_{c}(x) \\end{pmatrix}$, where $f_{c}(x)$ denotes the reduced scalar right-hand side on the center manifold up to the cubic term.\n- No numerical rounding is required.\n- There are no physical units.", "solution": "We analyze the system\n$$\n\\dot{x} = z, \\qquad \\dot{z} = -z + x^{2},\n$$\nat the equilibrium $(x,z)=(0,0)$.\n\nStep 1: Linearization and center subspace.\nThe Jacobian matrix at the origin is obtained from the first-order terms of the vector field:\n$$\nA = \\begin{bmatrix}\n\\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial z} \\\\\n\\frac{\\partial \\dot{z}}{\\partial x} & \\frac{\\partial \\dot{z}}{\\partial z}\n\\end{bmatrix}_{(0,0)}\n=\n\\begin{bmatrix}\n0 & 1 \\\\\n0 & -1\n\\end{bmatrix}.\n$$\nThe characteristic polynomial is $\\lambda(\\lambda+1)=0$, so the eigenvalues are $\\lambda_{c}=0$ and $\\lambda_{s}=-1$. The eigenvalue $\\lambda_{c}=0$ corresponds to the center subspace, and $\\lambda_{s}=-1$ corresponds to the stable subspace. An eigenvector for $\\lambda_{c}=0$ is $v_{c}=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$, so the center subspace is\n$$\nE^{c}=\\{(x,z)\\in\\mathbb{R}^{2} : z=0\\}.\n$$\nBy the Center Manifold Theorem (for ordinary differential equations in nonlinear control and dynamical systems), there exists a one-dimensional center manifold tangent to $E^{c}$ at the origin.\n\nStep 2: Center manifold parameterization and invariance equation.\nWe parameterize the local center manifold as a graph $z=w(x)$ with $w(0)=0$ and $w'(0)=0$ to ensure tangency to $E^{c}$. The invariance condition is derived from the chain rule: along the manifold, $z=w(x)$ and the time derivative of $z$ satisfies\n$$\n\\dot{z} = \\frac{dw}{dt} = w'(x)\\,\\dot{x}.\n$$\nFrom the system, along the manifold we also have\n$$\n\\dot{x} = z = w(x), \\qquad \\dot{z} = -z + x^{2} = -w(x) + x^{2}.\n$$\nEquating these two expressions for $\\dot{z}$ yields the invariance equation\n$$\nw'(x)\\,w(x) = -w(x) + x^{2}.\n$$\nSeek a Taylor series $w(x)=a x^{2} + b x^{3} + \\mathcal{O}(x^{4})$ consistent with $w(0)=0$ and $w'(0)=0$. Then\n$$\nw'(x) = 2 a x + 3 b x^{2} + \\mathcal{O}(x^{3}).\n$$\nCompute the left-hand side:\n$$\nw'(x)\\,w(x) = \\big(2 a x + 3 b x^{2} + \\mathcal{O}(x^{3})\\big)\\big(a x^{2} + b x^{3} + \\mathcal{O}(x^{4})\\big)\n= 2 a^{2} x^{3} + \\mathcal{O}(x^{4}).\n$$\nCompute the right-hand side:\n$$\n-w(x) + x^{2} = -(a x^{2} + b x^{3} + \\mathcal{O}(x^{4})) + x^{2}\n= (1-a) x^{2} - b x^{3} + \\mathcal{O}(x^{4}).\n$$\nMatch coefficients of like powers of $x$:\n- At order $x^{2}$: the left-hand side has coefficient $0$, so $0 = 1 - a$, hence $a=1$.\n- At order $x^{3}$: the left-hand side has coefficient $2 a^{2}=2$, so $2 = -b$, hence $b = -2$.\n\nTherefore,\n$$\nw(x) = x^{2} - 2 x^{3} + \\mathcal{O}(x^{4}),\n$$\nand the requested second-order approximation is\n$$\nw_{2}(x) = x^{2}.\n$$\n\nStep 3: Reduced dynamics and classification.\nOn the center manifold, the reduced scalar dynamics is given by the $x$-component restricted to $z=w(x)$:\n$$\n\\dot{x} = z = w(x) = x^{2} - 2 x^{3} + \\mathcal{O}(x^{4}).\n$$\nTruncating to cubic order,\n$$\nf_{c}(x) = x^{2} - 2 x^{3}.\n$$\nTo classify the equilibrium at $x=0$ under this reduced dynamics, consider the dominant term $x^{2}$ near $x=0$. For $x>0$ sufficiently small, $f_{c}(x)>0$, so $x(t)$ increases away from $0$ (repelling to the right). For $x<0$ sufficiently small, $f_{c}(x)>0$ as well, so $x(t)$ increases toward $0$ from the left (attracting from the left). Thus the origin is semi-stable (one-sided stable): it is not Lyapunov stable for the full system because trajectories starting with small $x>0$ move away, while those with small $x<0$ approach $0$ along the center manifold as $t\\to\\infty$. The Center Manifold Theorem ensures this classification carries over to the full system in a neighborhood of the origin because the stable direction ($z$-direction) is exponentially attracting and slaved to the center dynamics.", "answer": "$$\\boxed{\\begin{pmatrix} x^{2} & x^{2} - 2 x^{3} \\end{pmatrix}}$$", "id": "2691758"}, {"introduction": "This final practice demonstrates the power of the Center Manifold Theorem not just for analysis, but for synthesis and control design. We will investigate a system whose open-loop dynamics exhibit a line of non-isolated equilibria, a scenario where stabilization is non-trivial. By identifying the exact center manifold, you will see how it becomes the stage for designing a feedback controller to selectively alter the system's behavior and achieve local asymptotic stability [@problem_id:2691670].", "problem": "Consider the nonlinear control-affine system in two state variables $x \\in \\mathbb{R}$ and $y \\in \\mathbb{R}$,\n$$\n\\dot{x} \\;=\\; y^{2} \\;+\\; u, \n\\qquad\n\\dot{y} \\;=\\; -\\,y \\;+\\; x\\,y,\n$$\nwith input $u \\in \\mathbb{R}$. Work in a neighborhood of the origin and analyze the dynamics from first principles. Use only the definition of the center manifold, the local invariance condition, and linearization, without invoking any pre-stated formulas for the center manifold beyond these definitions.\n\nTasks:\n- Derive the Jacobian of the open-loop system at the origin and determine the eigenstructure. From this, identify the center subspace.\n- Using the local invariance condition for a center manifold $y = h(x)$ with $h(0) = 0$ and $h'(0) = 0$, determine the lowest-order nontrivial approximation for $h(x)$ and thereby identify a center manifold $W^{c}$ of the open-loop system. \n- Show that the open-loop reduced dynamics on $W^{c}$ has a continuum of equilibria and interpret the implication for stability.\n- Now close the loop with the state feedback $u(x) = -\\,x$. Using the same center manifold $W^{c}$ identified above, write down the reduced closed-loop dynamics and argue, using linearization and comparison arguments, that the origin is locally asymptotically stable for the full system.\n- Define the reduced Control Lyapunov candidate on the center manifold by $V_{c}(x) = \\tfrac{1}{2} x^{2}$ and compute its time derivative along the closed-loop reduced dynamics on $W^{c}$.\n\nExpress your final answer as the analytic expression for $\\dot{V}_{c}(x)$ along the closed-loop reduced dynamics on $W^{c}$. No numerical approximation is required and no units are involved. The final answer must be a single closed-form expression.", "solution": "The problem will be validated before any attempt at a solution is made.\n\nFirst, I extract the givens provided in the problem statement.\nThe system dynamics are given by:\n$$\n\\begin{cases}\n\\dot{x} \\;=\\; y^{2} \\;+\\; u \\\\\n\\dot{y} \\;=\\; -\\,y \\;+\\; x\\,y\n\\end{cases}\n$$\nwhere $x, y \\in \\mathbb{R}$ are the state variables and $u \\in \\mathbb{R}$ is the control input. The analysis is to be performed in a neighborhood of the origin $(x,y) = (0,0)$.\nTasks specified:\n1. For the open-loop system ($u=0$), derive the Jacobian at the origin, its eigenstructure, and identify the center subspace.\n2. Find an approximation for the center manifold, described as $y = h(x)$ with conditions $h(0) = 0$ and $h'(0) = 0$, by using the local invariance condition.\n3. Determine the open-loop reduced dynamics on this manifold and analyze stability.\n4. For the closed-loop system with feedback $u(x) = -x$, use the previously identified manifold to find the reduced dynamics and analyze the stability of the full system.\n5. With the reduced Control Lyapunov function candidate $V_{c}(x) = \\frac{1}{2} x^{2}$, compute its time derivative $\\dot{V}_{c}(x)$ along the closed-loop reduced dynamics.\n\nNow, I will validate the problem. The problem is formulated in standard mathematical language of control theory and dynamical systems. It is self-contained. The system is a well-defined nonlinear control-affine system. The tasks requested are standard procedures in the analysis of nonlinear systems via the center manifold theorem. A potential ambiguity lies in the instruction \"determine the lowest-order nontrivial approximation for $h(x)$\", which presumes such an approximation exists. The validity of this premise must be checked during the solution. A critical observation, which will be demonstrated, is that the open-loop center manifold is also an invariant manifold for the closed-loop system, rendering the analysis exact rather than approximate. This subtlety makes the problem well-posed and scientifically sound, not flawed. The problem is therefore deemed valid. I will proceed with the solution.\n\nFirst, we analyze the open-loop system, for which $u=0$. The dynamics are:\n$$\n\\dot{x} = y^{2}\n$$\n$$\n\\dot{y} = -y + xy\n$$\nThe system is written in vector form $\\dot{\\mathbf{z}} = \\mathbf{f}(\\mathbf{z})$, where $\\mathbf{z} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ and $\\mathbf{f}(x,y) = \\begin{pmatrix} y^{2} \\\\ -y + xy \\end{pmatrix}$.\nThe Jacobian matrix of the vector field $\\mathbf{f}$ is:\n$$\nA = D\\mathbf{f}(x,y) = \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x} & \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 0 & 2y \\\\ y & -1+x \\end{pmatrix}\n$$\nEvaluating at the origin $(0,0)$, we obtain the matrix for the linearized system:\n$$\nA = D\\mathbf{f}(0,0) = \\begin{pmatrix} 0 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\nThe eigenvalues are the diagonal entries, $\\lambda_{1} = 0$ and $\\lambda_{2} = -1$. The presence of an eigenvalue with a zero real part indicates the existence of a center manifold. The eigenvalue $\\lambda_{2} = -1$ corresponds to a stable manifold.\nThe eigenvector for the center eigenvalue $\\lambda_{1} = 0$ is found by solving $(A - 0I)\\mathbf{v} = \\mathbf{0}$:\n$$\n\\begin{pmatrix} 0 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies -v_{2} = 0\n$$\nThis gives $v_{2}=0$ with $v_{1}$ arbitrary. We choose the eigenvector $\\mathbf{v}_{c} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The center subspace $E^{c}$ is the span of this vector, which is the $x$-axis.\nThe eigenvector for the stable eigenvalue $\\lambda_{2} = -1$ is found by solving $(A - (-1)I)\\mathbf{v} = \\mathbf{0}$:\n$$\n\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies v_{1} = 0\n$$\nThis gives $v_{1}=0$ with $v_{2}$ arbitrary. We choose the eigenvector $\\mathbf{v}_{s} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$. The stable subspace $E^{s}$ is the span of this vector, which is the $y$-axis.\n\nNext, we determine the center manifold $W^{c}$, which is tangent to $E^{c}$ at the origin. It can be locally represented as a graph $y = h(x)$. The tangency conditions imply $h(0) = 0$ and $h'(0) = 0$. For a trajectory to remain on the manifold, the invariance condition must hold. Differentiating $y(t) = h(x(t))$ with respect to time gives $\\dot{y} = h'(x)\\dot{x}$. We substitute the open-loop dynamics into this equation:\n$$\n-y + xy = h'(x) (y^{2})\n$$\nSince this must hold for points on the manifold, we substitute $y=h(x)$:\n$$\n-h(x) + x h(x) = h'(x) [h(x)]^{2}\n$$\nThis can be written as $h(x)(x-1) = h'(x)[h(x)]^{2}$. We seek a solution for $h(x)$ as a power series around $x=0$. Given $h(0)=0$ and $h'(0)=0$, the series must start with a term of order at least two: $h(x) = a_{2}x^{2} + a_{3}x^{3} + \\dots$.\nSubstituting this into the invariance equation:\n$$\n(a_{2}x^{2} + a_{3}x^{3} + \\dots)(x-1) = (2a_{2}x + 3a_{3}x^{2} + \\dots)(a_{2}x^{2} + a_{3}x^{3} + \\dots)^{2}\n$$\nExpanding the left side:\n$$\n-a_{2}x^{2} + (a_{2}-a_{3})x^{3} + \\dots\n$$\nThe right side is of order $O(x^{5})$ since the first term of $h'(x)$ is $O(x)$ and the first term of $[h(x)]^2$ is $O(x^4)$.\n$$\n-a_{2}x^{2} + (a_{2}-a_{3})x^{3} + \\dots = O(x^{5})\n$$\nBy comparing coefficients of like powers of $x$, we find:\nFor $x^{2}$: $-a_{2} = 0 \\implies a_{2} = 0$.\nFor $x^{3}$: $a_{2}-a_{3} = 0$. Since $a_{2}=0$, this implies $a_{3}=0$.\nContinuing this process, all coefficients $a_{k}$ must be zero. This leads to the unique analytic solution $h(x) = 0$. Despite the problem's phrasing about a \"nontrivial approximation\", the only formally correct center manifold is the trivial one, $y=0$. Thus, the center manifold is $W^{c} = \\{(x,y) \\in \\mathbb{R}^{2} \\mid y=0\\}$.\n\nThe reduced dynamics on $W^{c}$ for the open-loop system are found by substituting $y=0$ into the $\\dot{x}$ equation:\n$$\n\\dot{x} = y^{2} \\implies \\dot{x} = 0^{2} = 0\n$$\nThe reduced dynamics are $\\dot{x}=0$. Any point $x=c$ is an equilibrium for this reduced system. This corresponds to a continuum of equilibria along the $x$-axis for the full system. For stability, this implies the origin is Lyapunov stable, but not asymptotically stable, as a small perturbation in $x$ will result in the state remaining at the perturbed location, not returning to the origin.\n\nNow, we introduce the state feedback control law $u(x) = -x$. The closed-loop system is:\n$$\n\\dot{x} = y^{2} - x\n$$\n$$\n\\dot{y} = -y + xy\n$$\nThe problem instructs us to use the same manifold $W^{c}$ (i.e., $y=0$) to analyze this new system. We must first check if this is a valid procedure. A manifold is invariant if a trajectory starting on it remains on it. If we set $y(0)=0$ in the closed-loop system, the $\\dot{y}$ equation becomes $\\dot{y} = -0 + x \\cdot 0 = 0$. This implies that if $y$ starts at zero, it stays at zero. Therefore, $W^{c}$ defined by $y=0$ is an invariant manifold for the closed-loop system. The analysis on this manifold is exact, not an approximation.\nThe reduced dynamics for the closed-loop system on $W^{c}$ are found by substituting $y=0$ into the closed-loop $\\dot{x}$ equation:\n$$\n\\dot{x} = y^{2} - x \\implies \\dot{x} = 0^{2} - x = -x\n$$\nThe reduced one-dimensional system is $\\dot{x} = -x$. The origin $x=0$ of this system is exponentially stable. According to the center manifold theorem, the local asymptotic stability of the origin of the full system is determined by the stability of the reduced dynamics on the center manifold. Since the reduced dynamics are asymptotically stable, and the dynamics transverse to the manifold are stable (governed by the eigenvalue $\\lambda_{2} = -1$), we conclude that the origin $(0,0)$ of the closed-loop system is locally asymptotically stable.\n\nFinally, we compute the time derivative of the Lyapunov candidate $V_{c}(x) = \\frac{1}{2} x^{2}$ on the center manifold. The derivative is taken along the trajectories of the closed-loop reduced dynamics, $\\dot{x} = -x$.\nUsing the chain rule:\n$$\n\\dot{V}_{c}(x) = \\frac{dV_{c}}{dx}\\frac{dx}{dt} = \\frac{d}{dx}\\left(\\frac{1}{2}x^{2}\\right) \\dot{x}\n$$\nWe have $\\frac{dV_{c}}{dx} = x$ and $\\dot{x} = -x$. Substituting these yields:\n$$\n\\dot{V}_{c}(x) = (x)(-x) = -x^{2}\n$$\nThis expression for $\\dot{V}_{c}(x)$ is the final result requested.", "answer": "$$\\boxed{-x^{2}}$$", "id": "2691670"}]}