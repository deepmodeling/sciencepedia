{"hands_on_practices": [{"introduction": "The cornerstone of passivity analysis for linear time-invariant (LTI) systems is the positive real (PR) condition. This first exercise provides essential practice in applying this condition directly from its definition, using basic complex analysis to evaluate a system's passivity in the frequency domain. By working through this problem [@problem_id:2730380], you will build a solid foundation in the fundamental test for passivity and its variants, such as strict positive realness.", "problem": "Consider the real-rational, single-input single-output transfer function $G(s) = \\dfrac{s+1}{s^{2}+2s+2}$. Work from first principles of passivity and positive realness as follows.\n\n- Definition (Positive Realness): A real-rational transfer function $G(s)$ is positive real if it is analytic in the open right half-plane $\\{s \\in \\mathbb{C} : \\Re(s) &gt; 0\\}$ and satisfies $\\Re\\{G(\\mathrm{j}\\omega)\\} \\ge 0$ for all real $\\omega$ where $G(\\mathrm{j}\\omega)$ is defined. For a scalar real-rational $G(s)$, the frequency-domain Hermitian part $H(\\omega) \\triangleq G(\\mathrm{j}\\omega) + G(-\\mathrm{j}\\omega)^{\\top}$ equals $2 \\Re\\{G(\\mathrm{j}\\omega)\\}$ because $G(-\\mathrm{j}\\omega)^{\\top} = \\overline{G(\\mathrm{j}\\omega)}$.\n\n- Strictness assessment: Say that $G(s)$ is strictly positive real with a uniform margin if there exists $\\varepsilon &gt; 0$ such that $H(\\omega) \\succeq 2 \\varepsilon$ for all real $\\omega$.\n\nTasks:\n\n1. Starting from the definition above and without invoking any pre-packaged passivity tests, derive an explicit real-valued expression for $H(\\omega)$ as a function of $\\omega \\in \\mathbb{R}$ by direct complex arithmetic on $G(\\mathrm{j}\\omega)$.\n\n2. Using only the analyticity of $G(s)$ and your derived $H(\\omega)$, determine whether $G(s)$ is positive real and whether it is strictly positive real with a uniform margin in the sense defined above. Justify each step from the definitions.\n\n3. Compute the infimum\n$$\nh_{\\star} \\triangleq \\inf_{\\omega \\in \\mathbb{R}} \\lambda_{\\min}\\!\\big(H(\\omega)\\big),\n$$\nwhere for the scalar case $\\lambda_{\\min}$ returns the scalar value itself. Report the value of $h_{\\star}$ as your final answer.\n\nThe final answer must be a single real number. No rounding is required.", "solution": "We are tasked with the analysis of the positive realness of a given single-input single-output transfer function $G(s) = \\dfrac{s+1}{s^{2}+2s+2}$. The analysis must proceed from first principles as defined in the problem statement.\n\nFirst, we must validate the problem. The givens are the transfer function $G(s)$, and definitions for positive realness (PR), its strict version with a uniform margin (SPR), and the Hermitian frequency-domain function $H(\\omega)$. The tasks are to derive $H(\\omega)$, analyze the PR and SPR properties of $G(s)$, and compute the infimum $h_{\\star}$ of $H(\\omega)$. The problem is self-contained, scientifically grounded in control theory, and well-posed. The definitions are standard and the transfer function is a simple rational function. There are no contradictions or ambiguities. The problem is valid. We proceed to the solution.\n\nThe first task is to derive an explicit expression for the Hermitian function $H(\\omega) \\triangleq G(\\mathrm{j}\\omega) + G(-\\mathrm{j}\\omega)^{\\top}$. For a scalar transfer function, this simplifies to $H(\\omega) = 2 \\Re\\{G(\\mathrm{j}\\omega)\\}$. We substitute $s = \\mathrm{j}\\omega$ into $G(s)$, where $\\mathrm{j}$ is the imaginary unit and $\\omega \\in \\mathbb{R}$.\n\n$$\nG(\\mathrm{j}\\omega) = \\frac{(\\mathrm{j}\\omega)+1}{(\\mathrm{j}\\omega)^{2}+2(\\mathrm{j}\\omega)+2} = \\frac{1+\\mathrm{j}\\omega}{-\\omega^{2}+2\\mathrm{j}\\omega+2} = \\frac{1+\\mathrm{j}\\omega}{(2-\\omega^{2})+\\mathrm{j}(2\\omega)}\n$$\n\nTo find the real part of this complex expression, we multiply the numerator and the denominator by the complex conjugate of the denominator, which is $(2-\\omega^{2})-\\mathrm{j}(2\\omega)$.\n\nThe numerator becomes:\n$$\n(1+\\mathrm{j}\\omega)((2-\\omega^{2})-\\mathrm{j}(2\\omega)) = 1 \\cdot (2-\\omega^{2}) - 1 \\cdot \\mathrm{j}(2\\omega) + \\mathrm{j}\\omega \\cdot (2-\\omega^{2}) - (\\mathrm{j}\\omega)\\mathrm{j}(2\\omega)\n$$\n$$\n= (2-\\omega^{2}) - 2\\mathrm{j}\\omega + 2\\mathrm{j}\\omega - \\mathrm{j}\\omega^{3} - \\mathrm{j}^{2}2\\omega^{2} = (2-\\omega^{2}) + 2\\omega^{2} - \\mathrm{j}\\omega^{3} = (2+\\omega^{2}) - \\mathrm{j}\\omega^{3}\n$$\n\nThe denominator becomes the squared magnitude of the original denominator:\n$$\n((2-\\omega^{2})+\\mathrm{j}(2\\omega))((2-\\omega^{2})-\\mathrm{j}(2\\omega)) = (2-\\omega^{2})^{2} + (2\\omega)^{2} = (4-4\\omega^{2}+\\omega^{4}) + 4\\omega^{2} = \\omega^{4}+4\n$$\n\nThus, the expression for $G(\\mathrm{j}\\omega)$ is:\n$$\nG(\\mathrm{j}\\omega) = \\frac{(2+\\omega^{2}) - \\mathrm{j}\\omega^{3}}{\\omega^{4}+4} = \\frac{2+\\omega^{2}}{\\omega^{4}+4} - \\mathrm{j}\\frac{\\omega^{3}}{\\omega^{4}+4}\n$$\n\nThe real part is therefore $\\Re\\{G(\\mathrm{j}\\omega)\\} = \\frac{2+\\omega^{2}}{\\omega^{4}+4}$.\nAccording to the definition provided, $H(\\omega) = 2\\Re\\{G(\\mathrm{j}\\omega)\\}$.\nSo, the explicit real-valued expression for $H(\\omega)$ is:\n$$\nH(\\omega) = \\frac{2(2+\\omega^{2})}{\\omega^{4}+4}\n$$\nThis completes the first task.\n\nThe second task is to determine if $G(s)$ is positive real (PR) and strictly positive real (SPR) with a uniform margin.\nA transfer function is positive real if two conditions are met:\n1. $G(s)$ is analytic in the open right half-plane, i.e., for all $s \\in \\mathbb{C}$ with $\\Re\\{s\\} > 0$.\n2. $\\Re\\{G(\\mathrm{j}\\omega)\\} \\ge 0$ for all real $\\omega$ where $G(\\mathrm{j}\\omega)$ is defined.\n\nFor the first condition, we find the poles of $G(s)$ by solving the denominator equation $s^{2}+2s+2=0$. Using the quadratic formula:\n$$\ns = \\frac{-2 \\pm \\sqrt{2^{2}-4(1)(2)}}{2(1)} = \\frac{-2 \\pm \\sqrt{4-8}}{2} = \\frac{-2 \\pm \\sqrt{-4}}{2} = \\frac{-2 \\pm 2\\mathrm{j}}{2} = -1 \\pm \\mathrm{j}\n$$\nThe poles are at $s_1 = -1+\\mathrm{j}$ and $s_2 = -1-\\mathrm{j}$. Both poles have a real part equal to $-1$, which is strictly negative. Since $G(s)$ is a rational function, it is analytic everywhere except at its poles. As both poles are in the open left half-plane, $G(s)$ is analytic in the entire open right half-plane. The first condition for positive realness is satisfied.\n\nFor the second condition, we inspect the sign of $\\Re\\{G(\\mathrm{j}\\omega)\\} = \\frac{2+\\omega^{2}}{\\omega^{4}+4}$.\nFor any real number $\\omega$, the numerator $2+\\omega^{2}$ is always positive, with a minimum value of $2$ at $\\omega=0$. The denominator $\\omega^{4}+4$ is also always positive, with a minimum value of $4$ at $\\omega=0$. The ratio of two positive numbers is always positive. Therefore, $\\Re\\{G(\\mathrm{j}\\omega)\\} > 0$ for all $\\omega \\in \\mathbb{R}$, which implies $\\Re\\{G(\\mathrm{j}\\omega)\\} \\ge 0$. The second condition is also satisfied.\nSince both conditions are satisfied, we conclude that $G(s)$ is positive real.\n\nNow, we assess if $G(s)$ is strictly positive real with a uniform margin. This property requires the existence of a constant $\\varepsilon > 0$ such that $H(\\omega) \\ge 2\\varepsilon$ for all $\\omega \\in \\mathbb{R}$. This is equivalent to requiring $\\Re\\{G(\\mathrm{j}\\omega)\\} \\ge \\varepsilon > 0$. We must determine if the function $f(\\omega) = \\Re\\{G(\\mathrm{j}\\omega)\\} = \\frac{2+\\omega^{2}}{\\omega^{4}+4}$ has a strictly positive infimum.\nLet us examine the limit of $f(\\omega)$ as $|\\omega| \\to \\infty$:\n$$\n\\lim_{|\\omega| \\to \\infty} f(\\omega) = \\lim_{|\\omega| \\to \\infty} \\frac{2+\\omega^{2}}{\\omega^{4}+4} = \\lim_{|\\omega| \\to \\infty} \\frac{\\omega^{2}(2/\\omega^{2}+1)}{\\omega^{4}(1+4/\\omega^{4})} = \\lim_{|\\omega| \\to \\infty} \\frac{1}{\\omega^{2}} \\cdot \\frac{1+2/\\omega^{2}}{1+4/\\omega^{4}} = 0 \\cdot 1 = 0\n$$\nSince the function is always positive but approaches $0$ as $|\\omega| \\to \\infty$, its greatest lower bound (infimum) over $\\mathbb{R}$ is $0$. Therefore, there does not exist any $\\varepsilon > 0$ for which $\\Re\\{G(\\mathrm{j}\\omega)\\} \\ge \\varepsilon$ holds for all $\\omega$. Consequently, $G(s)$ is not strictly positive real with a uniform margin as per the specified definition.\n\nThe third task is to compute the infimum $h_{\\star} = \\inf_{\\omega \\in \\mathbb{R}} \\lambda_{\\min}(H(\\omega))$.\nFor the scalar case, this simplifies to $h_{\\star} = \\inf_{\\omega \\in \\mathbb{R}} H(\\omega)$.\nWe have the function $H(\\omega) = \\frac{2(2+\\omega^{2})}{\\omega^{4}+4}$.\nAs established earlier, the numerator $2(2+\\omega^{2})$ is always positive, and the denominator $\\omega^{4}+4$ is always positive. Thus, $H(\\omega) > 0$ for all $\\omega \\in \\mathbb{R}$.\nWe consider the limit of $H(\\omega)$ as $|\\omega| \\to \\infty$:\n$$\n\\lim_{|\\omega| \\to \\infty} H(\\omega) = \\lim_{|\\omega| \\to \\infty} \\frac{4+2\\omega^{2}}{\\omega^{4}+4} = 0\n$$\nThe function $H(\\omega)$ is continuous and strictly positive for all real $\\omega$, and it approaches $0$ as $|\\omega| \\to \\infty$. The infimum of a set is its greatest lower bound. Since $H(\\omega)$ can be made arbitrarily close to $0$ by taking $|\\omega|$ large enough, but never becomes negative or zero, the greatest lower bound is exactly $0$.\nTherefore, $h_{\\star} = 0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2730380"}, {"introduction": "Beyond the frequency domain, passivity has a powerful physical interpretation rooted in energy dissipation and storage. This practice [@problem_id:2730422] explores the time-domain definition of passivity using a storage function, illustrating the concept of a lossless systemâ€”one that stores and returns energy without dissipation. By computing the system's passivity indices, you will learn to quantify the degree to which a system is passive with respect to its input and output, providing a deeper understanding of its energetic behavior.", "problem": "Consider the Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) system defined on the state space $\\mathbb{R}$ with input $u(t) \\in \\mathbb{R}$, state $x(t) \\in \\mathbb{R}$, and output $y(t) \\in \\mathbb{R}$, given by the dynamics\n$$\n\\dot{x}(t) = u(t), \\quad y(t) = x(t),\n$$\nwith initial condition $x(0) = 0$. Let the standard passivity supply rate be $w(u,y) = u\\,y$, and recall that a system is passive if there exists a continuously differentiable storage function $V(x) \\ge 0$ with $V(0)=0$ such that, for all $T \\ge 0$ and all inputs $u(\\cdot)$ that generate trajectories $(x(\\cdot),y(\\cdot))$, the dissipation inequality\n$$\nV(x(T)) - V(x(0)) \\le \\int_{0}^{T} u(t)\\,y(t)\\,dt\n$$\nholds. The system is called lossless if the inequality holds with equality for all $T \\ge 0$ and all trajectories. The system is called strictly passive if there exists $\\varepsilon > 0$ such that\n$$\nV(x(T)) - V(x(0)) \\le \\int_{0}^{T} \\big(u(t)\\,y(t) - \\varepsilon \\big(u(t)^{2} + y(t)^{2}\\big)\\big)\\,dt\n$$\nfor all $T \\ge 0$.\n\nDefine the passivity indices $\\nu$ and $\\rho$ (input and output passivity indices, respectively) by requiring that there exists a storage function $V(x) \\ge 0$ such that\n$$\nV(x(T)) - V(x(0)) \\le \\int_{0}^{T} \\big(u(t)\\,y(t) - \\nu\\,u(t)^{2} - \\rho\\,y(t)^{2}\\big)\\,dt\n$$\nfor all $T \\ge 0$. The largest pair $(\\nu_{\\star},\\rho_{\\star})$ for which the above inequality holds is called the tight passivity indices.\n\nTasks:\n1) Using only the given definitions, construct a storage function $V(x)$ and prove that the system is lossless but not strictly passive.\n2) Compute the tight passivity indices $(\\nu_{\\star},\\rho_{\\star})$. Report your final answer as a single row matrix $\\begin{pmatrix} \\nu_{\\star} & \\rho_{\\star} \\end{pmatrix}$. No units are required.", "solution": "The problem is first validated.\n\n**Step 1: Extract Givens**\n- System Dynamics: $\\dot{x}(t) = u(t)$, $y(t) = x(t)$.\n- State Space: $x(t) \\in \\mathbb{R}$.\n- Input Space: $u(t) \\in \\mathbb{R}$.\n- Output Space: $y(t) \\in \\mathbb{R}$.\n- Initial Condition: $x(0) = 0$.\n- Passivity Supply Rate: $w(u,y) = u\\,y$.\n- Definition of Passivity: There exists a continuously differentiable storage function $V(x) \\ge 0$ with $V(0)=0$ such that $V(x(T)) - V(x(0)) \\le \\int_{0}^{T} u(t)\\,y(t)\\,dt$ for all $T \\ge 0$.\n- Definition of Lossless: The passivity inequality holds with equality.\n- Definition of Strict Passivity: There exists $\\varepsilon > 0$ and a storage function $V$ such that $V(x(T)) - V(x(0)) \\le \\int_{0}^{T} \\big(u(t)\\,y(t) - \\varepsilon \\big(u(t)^{2} + y(t)^{2}\\big)\\big)\\,dt$ for all $T \\ge 0$.\n- Definition of Passivity Indices $(\\nu, \\rho)$: There exists a storage function $V$ such that $V(x(T)) - V(x(0)) \\le \\int_{0}^{T} \\big(u(t)\\,y(t) - \\nu\\,u(t)^{2} - \\rho\\,y(t)^{2}\\big)\\,dt$ for all $T \\ge 0$.\n- Definition of Tight Passivity Indices $(\\nu_{\\star},\\rho_{\\star})$: The largest pair for which the above inequality holds.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard exercise in the analysis of passivity for a linear time-invariant system. All terms are defined formally and are consistent with established control theory literature. The system itself is a simple integrator, a fundamental and well-understood model. The problem is self-contained, unambiguous, and scientifically grounded. It is not ill-posed, contradictory, or trivial.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be constructed.\n\n**Task 1: Prove the system is lossless but not strictly passive.**\n\nTo investigate passivity, we seek a storage function $V(x)$. A candidate storage function is proposed as $V(x) = \\frac{1}{2}x^2$.\nWe verify the properties of this function:\n1.  $V(x) = \\frac{1}{2}x^2 \\ge 0$ for all $x \\in \\mathbb{R}$.\n2.  $V(0) = 0$.\n3.  $V(x)$ is continuously differentiable.\n\nThe passivity inequality in differential form is $\\dot{V}(x(t)) \\le u(t)y(t)$.\nLet us compute the time derivative of our candidate storage function along the system's trajectories:\n$$\n\\dot{V}(x(t)) = \\frac{d}{dt}\\left(\\frac{1}{2}x(t)^2\\right) = x(t)\\dot{x}(t)\n$$\nSubstituting the system dynamics, $\\dot{x}(t) = u(t)$ and $y(t) = x(t)$, we obtain:\n$$\n\\dot{V}(x(t)) = y(t)u(t)\n$$\nIntegrating this from $t=0$ to $t=T$:\n$$\n\\int_{0}^{T} \\dot{V}(x(t))\\,dt = V(x(T)) - V(x(0)) = \\int_{0}^{T} u(t)y(t)\\,dt\n$$\nThis equation shows that the dissipation inequality holds with equality for our choice of $V(x)$. By definition, a system for which the passivity inequality holds with equality for all trajectories is a **lossless** system.\n\nNext, we investigate strict passivity. A system is strictly passive if there exists a storage function $V(x)$ and a constant $\\varepsilon > 0$ such that the following differential inequality holds:\n$$\n\\dot{V}(x) \\le u y - \\varepsilon(u^2 + y^2)\n$$\nUsing the chain rule $\\dot{V}(x) = \\frac{\\partial V}{\\partial x}\\dot{x}$ and substituting the system dynamics $\\dot{x}=u, y=x$, we get:\n$$\n\\frac{\\partial V}{\\partial x}u \\le ux - \\varepsilon(u^2 + x^2)\n$$\nThis inequality must hold for all $u \\in \\mathbb{R}$ and all $x \\in \\mathbb{R}$. Let us rearrange the terms to form a quadratic expression in the variable $u$:\n$$\n\\varepsilon u^2 + \\left(\\frac{\\partial V}{\\partial x} - x\\right)u + \\varepsilon x^2 \\le 0\n$$\nSince $\\varepsilon > 0$, the left-hand side is a quadratic function of $u$ that opens upwards. Such a parabola has a global minimum and approaches $+\\infty$ as $|u| \\to \\infty$. It is therefore impossible for this expression to be less than or equal to zero for all values of $u$. The inequality cannot be satisfied for any choice of a continuously differentiable function $V(x)$.\nConsequently, no such storage function exists, and the system is **not strictly passive**.\n\n**Task 2: Compute the tight passivity indices $(\\nu_{\\star},\\rho_{\\star})$.**\n\nWe must find the set of pairs $(\\nu, \\rho)$ for which there exists a storage function $V(x)$ satisfying the inequality:\n$$\n\\dot{V}(x) \\le u y - \\nu u^2 - \\rho y^2\n$$\nSubstituting the system dynamics, we get:\n$$\n\\frac{\\partial V}{\\partial x}u \\le ux - \\nu u^2 - \\rho x^2\n$$\nRearranging terms into a quadratic in $u$:\n$$\n\\nu u^2 + \\left(\\frac{\\partial V}{\\partial x} - x\\right)u + \\rho x^2 \\le 0\n$$\nThis inequality must hold for all $u \\in \\mathbb{R}$ for some choice of $V(x)$.\n\nFirst, consider the coefficient of the $u^2$ term, $\\nu$. If $\\nu > 0$, the quadratic opens upwards and cannot be non-positive for all $u$. Thus, we must have $\\nu \\le 0$.\n\nCase 1: $\\nu = 0$.\nThe inequality becomes linear in $u$: $\\left(\\frac{\\partial V}{\\partial x} - x\\right)u + \\rho x^2 \\le 0$. For this to hold for all $u$, the coefficient of $u$ must be zero.\n$$\n\\frac{\\partial V}{\\partial x} - x = 0 \\implies \\frac{\\partial V}{\\partial x} = x\n$$\nIntegrating this gives $V(x) = \\frac{1}{2}x^2 + C$. The condition $V(0)=0$ implies $C=0$, so $V(x)=\\frac{1}{2}x^2$, which is a valid storage function.\nWith the coefficient of $u$ being zero, the inequality reduces to $\\rho x^2 \\le 0$. Since $x^2 \\ge 0$, this holds for all $x$ if and only if $\\rho \\le 0$.\nSo, any pair $(0, \\rho)$ with $\\rho \\le 0$ is a valid pair of passivity indices.\n\nCase 2: $\\nu < 0$.\nThe quadratic in $u$ opens downwards. For it to be non-positive for all $u$, its maximum value must be non-positive. The maximum of a quadratic $Au^2+Bu+C$ with $A<0$ is $C - \\frac{B^2}{4A}$.\nIn our case, $A = \\nu$, $B = \\frac{\\partial V}{\\partial x} - x$, and $C = \\rho x^2$. The condition is:\n$$\n\\rho x^2 - \\frac{\\left(\\frac{\\partial V}{\\partial x} - x\\right)^2}{4\\nu} \\le 0\n$$\nMultiplying by $4\\nu$ (which is negative) reverses the inequality sign:\n$$\n4\\nu\\rho x^2 - \\left(\\frac{\\partial V}{\\partial x} - x\\right)^2 \\ge 0 \\implies \\left(\\frac{\\partial V}{\\partial x} - x\\right)^2 \\le 4\\nu\\rho x^2\n$$\nFor the right-hand side to be non-negative, we must have $4\\nu\\rho \\ge 0$. As $\\nu < 0$, this implies $\\rho \\le 0$. With $\\nu < 0$ and $\\rho \\le 0$, we have $\\nu\\rho \\ge 0$. Taking the square root of both sides:\n$$\n\\left|\\frac{\\partial V}{\\partial x} - x\\right| \\le 2\\sqrt{\\nu\\rho}|x|\n$$\nThis further implies $-\\left(2\\sqrt{\\nu\\rho}\\right)|x| \\le \\frac{\\partial V}{\\partial x} - x \\le \\left(2\\sqrt{\\nu\\rho}\\right)|x|$, or:\n$$\nx - 2\\sqrt{\\nu\\rho}|x| \\le \\frac{\\partial V}{\\partial x} \\le x + 2\\sqrt{\\nu\\rho}|x|\n$$\nFor a storage function $V(x)$ to exist, we must be able to integrate this differential inequality. To ensure $V(x) \\ge 0$ with $V(0)=0$, we integrate from $0$ to $x$. For $x > 0$:\n$$\nV(x) = \\int_{0}^{x} \\frac{\\partial V}{\\partial\\xi}\\,d\\xi \\ge \\int_{0}^{x} (\\xi - 2\\sqrt{\\nu\\rho}\\xi)\\,d\\xi = \\frac{x^2}{2}(1 - 2\\sqrt{\\nu\\rho})\n$$\nFor $V(x)$ to be non-negative, we require its lower bound to be non-negative:\n$$\n\\frac{x^2}{2}(1 - 2\\sqrt{\\nu\\rho}) \\ge 0 \\implies 1 - 2\\sqrt{\\nu\\rho} \\ge 0\n$$\n$$\n1 \\ge 2\\sqrt{\\nu\\rho} \\implies \\sqrt{\\nu\\rho} \\le \\frac{1}{2} \\implies \\nu\\rho \\le \\frac{1}{4}\n$$\nThe complete set of valid passivity indices is the set of pairs $(\\nu, \\rho)$ such that $\\nu \\le 0$, $\\rho \\le 0$, and $\\nu\\rho \\le \\frac{1}{4}$.\n\nThe problem asks for \"the largest pair $(\\nu_{\\star},\\rho_{\\star})$\". This implies the maximum element in the set of valid indices with respect to the component-wise partial order, i.e., $(\\nu_1, \\rho_1) \\ge (\\nu_2, \\rho_2)$ if $\\nu_1 \\ge \\nu_2$ and $\\rho_1 \\ge \\rho_2$.\nLet $S = \\{(\\nu, \\rho) \\in \\mathbb{R}^2 \\mid \\nu \\le 0, \\rho \\le 0, \\nu\\rho \\le \\frac{1}{4}\\}$.\nConsider the pair $(0,0)$. It is in $S$ because $0 \\le 0$ and $0 \\times 0 \\le \\frac{1}{4}$.\nFor any other pair $(\\nu, \\rho) \\in S$, we have $\\nu \\le 0$ and $\\rho \\le 0$. Thus, $(0,0) \\ge (\\nu, \\rho)$ for all $(\\nu, \\rho) \\in S$.\nTherefore, the pair $(0,0)$ is the unique largest element in the set of valid indices.\n\nThe tight passivity indices are $(\\nu_{\\star},\\rho_{\\star}) = (0,0)$.", "answer": "$$\\boxed{\\begin{pmatrix} 0 & 0 \\end{pmatrix}}$$", "id": "2730422"}, {"introduction": "A central application of passivity is guaranteeing the stability of interconnected systems, but these powerful theorems rely on the crucial assumption of well-posedness. This advanced exercise [@problem_id:2730416] presents a counterexample where this assumption is violated due to an algebraic loop created by direct feedthrough terms, even though the individual components are passive. You will analyze why the interconnection fails and devise a regularization scheme to restore passivity, highlighting a critical consideration for practical control design.", "problem": "Consider scalar, single-input single-output, linear time-invariant systems with the supply rate $w(u,y) = u\\,y$ and passivity interpreted in the frequency domain as the positive real property: for a transfer function $G(s)$, passivity requires $G(s)$ to be analytic in $\\operatorname{Re}(s) > 0$ and to satisfy $\\operatorname{Re}\\,G(\\mathrm{j}\\omega) \\ge 0$ for all real $\\omega$. Two systems $\\Sigma_1$ and $\\Sigma_2$ are said to be interconnected by instantaneous positive feedback if their signals satisfy $u_1 = r + y_2$, $u_2 = y_1$, where $r$ is an external input.\n\n1) Construct a concrete counterexample showing that even if each component is passive, the interconnection by instantaneous positive feedback can violate the well-posedness assumption required by passivity theorems. Specifically, take $\\Sigma_1$ and $\\Sigma_2$ to be passive, with transfer functions $G_1(s) = 1 + \\dfrac{b}{s+1}$ and $G_2(s) = 1$, where $b \\in (0,1)$ is a fixed constant. Explain, starting from the passivity definition and the concept of well-posedness for algebraic loops, why the interconnection with $u_1 = r + y_2$, $u_2 = y_1$ is not well-posed.\n\n2) Propose a regularization that perturbs only the instantaneous (algebraic) part of $\\Sigma_1$ by introducing a small series loss while preserving passivity of the component. Concretely, replace $G_1(s)$ by $G_{1,\\delta}(s) = (1 - \\delta) + \\dfrac{b}{s+1}$ with $\\delta \\in (0,1)$. Derive, from first principles using the interconnection equations and the definition of passivity in the frequency domain, the closed-loop transfer $G_{\\mathrm{cl}}(s)$ from $r$ to $y_1$ and a necessary and sufficient inequality on $\\delta$ that guarantees $\\operatorname{Re}\\,G_{\\mathrm{cl}}(\\mathrm{j}\\omega) \\ge 0$ for all real $\\omega$.\n\nWhat is the smallest value of $\\delta$ expressed in terms of $b$ that guarantees passivity of the regularized closed-loop transfer $G_{\\mathrm{cl}}(s)$? Provide your final answer as a closed-form analytic expression in terms of $b$.", "solution": "This problem addresses the topic of passivity in linear time-invariant (LTI) feedback systems, specifically focusing on the critical issue of well-posedness in interconnections with direct feedthrough terms. We will first demonstrate the failure of well-posedness in a positive feedback loop of two passive systems and then analyze a regularization method to restore passivity to the closed-loop system.\n\nFirst, we analyze the problem as stated in Part 1. We are given two passive systems $\\Sigma_1$ and $\\Sigma_2$ with transfer functions $G_1(s) = 1 + \\dfrac{b}{s+1}$ and $G_2(s) = 1$, where $b \\in (0,1)$. We must verify that these components are indeed passive. A transfer function $G(s)$ represents a passive system if it is positive real, which requires it to be analytic in the open right-half plane ($\\operatorname{Re}(s) > 0$) and to satisfy $\\operatorname{Re}[G(\\mathrm{j}\\omega)] \\ge 0$ for all real $\\omega$.\n\nFor $G_2(s) = 1$, the function is analytic everywhere, and $\\operatorname{Re}[G_2(\\mathrm{j}\\omega)] = \\operatorname{Re}[1] = 1 \\ge 0$. Thus, $\\Sigma_2$ is passive.\n\nFor $G_1(s) = 1 + \\dfrac{b}{s+1}$, the only pole is at $s = -1$, which is in the left-half plane, so $G_1(s)$ is analytic in $\\operatorname{Re}(s) > 0$. We check the real part on the imaginary axis:\n$$\n\\operatorname{Re}[G_1(\\mathrm{j}\\omega)] = \\operatorname{Re}\\left[1 + \\frac{b}{1+\\mathrm{j}\\omega}\\right] = \\operatorname{Re}\\left[1 + \\frac{b(1-\\mathrm{j}\\omega)}{1+\\omega^2}\\right] = 1 + \\frac{b}{1+\\omega^2}\n$$\nGiven that $b > 0$ and $1+\\omega^2 \\ge 1$, the term $\\dfrac{b}{1+\\omega^2}$ is always positive. Therefore, $\\operatorname{Re}[G_1(\\mathrm{j}\\omega)] > 1 \\ge 0$ for all $\\omega$. Thus, $\\Sigma_1$ is also passive.\n\nThe interconnection is given by $u_1 = r + y_2$ and $u_2 = y_1$. Well-posedness of an interconnection concerns the existence and uniqueness of a solution for the internal signals for any external input $r$. For LTI systems, this is directly related to the algebraic loop formed by the direct feedthrough terms. The direct feedthrough term of a transfer function $G(s)$ is the gain at infinite frequency, $D = \\lim_{s \\to \\infty} G(s)$.\nFor our systems, the feedthrough terms are:\n$$\nD_1 = \\lim_{s \\to \\infty} G_1(s) = \\lim_{s \\to \\infty} \\left(1 + \\frac{b}{s+1}\\right) = 1\n$$\n$$\nD_2 = \\lim_{s \\to \\infty} G_2(s) = \\lim_{s \\to \\infty} 1 = 1\n$$\nThe algebraic relationships between the instantaneous parts of the signals are $y_{1,alg} = D_1 u_1$ and $y_{2,alg} = D_2 u_2$. Substituting these into the interconnection equations gives:\n$$\nu_1 = r + y_{2,alg} = r + D_2 u_2\n$$\n$$\nu_2 = y_{1,alg} = D_1 u_1\n$$\nSubstituting the second equation into the first yields an equation for $u_1$ in terms of the external input $r$:\n$$\nu_1 = r + D_2 (D_1 u_1) \\implies u_1 (1 - D_1 D_2) = r\n$$\nA unique solution for $u_1$ exists for any arbitrary $r$ if and only if the matrix $(I - D)$ is invertible, where $D$ is the feedthrough matrix of the interconnection. For this scalar case, the condition is $1 - D_1 D_2 \\neq 0$.\nIn our case, $1 - D_1 D_2 = 1 - (1)(1) = 0$. The equation becomes $0 \\cdot u_1 = r$. If $r \\neq 0$, there is no solution. If $r = 0$, there are infinitely many solutions. In either case, the internal signals are not uniquely determined by the external input. This is the definition of ill-posedness. The passivity theorem, which states that the feedback interconnection of passive systems is passive, relies on the assumption of well-posedness, which is violated here. This violation manifests as an improper closed-loop transfer function, implying infinite gain at infinite frequencies, which is not physically realizable.\n\nNow we proceed to Part 2, where we introduce a regularization. The transfer function $G_1(s)$ is replaced by $G_{1,\\delta}(s) = (1-\\delta) + \\dfrac{b}{s+1}$ with $\\delta \\in (0,1)$. The component $\\Sigma_2$ remains $G_2(s)=1$. The regularization introduces a loss $(-\\delta)$ in the direct feedthrough path of $\\Sigma_1$. The new feedthrough term is $D_{1,\\delta} = 1-\\delta$. The well-posedness condition becomes $1 - D_{1,\\delta}D_2 = 1 - (1-\\delta)(1) = \\delta$. Since $\\delta \\in (0,1)$, we have $\\delta \\neq 0$, so the regularized interconnection is well-posed.\n\nWe now derive the closed-loop transfer function $G_{\\mathrm{cl}}(s)$ from the input $r$ to the output $y_1$. The relationship in the Laplace domain is $Y_1(s) = G_{\\mathrm{cl}}(s)R(s)$. The general formula for this positive feedback configuration is:\n$$\nG_{\\mathrm{cl}}(s) = \\frac{G_{1,\\delta}(s)}{1 - G_{1,\\delta}(s)G_2(s)}\n$$\nSubstituting the expressions for the transfer functions:\n$$\nG_{\\mathrm{cl}}(s) = \\frac{(1-\\delta) + \\frac{b}{s+1}}{1 - \\left((1-\\delta) + \\frac{b}{s+1}\\right)(1)} = \\frac{\\frac{(1-\\delta)(s+1)+b}{s+1}}{1 - (1-\\delta) - \\frac{b}{s+1}} = \\frac{\\frac{(1-\\delta)s + (1-\\delta+b)}{s+1}}{\\frac{\\delta(s+1)-b}{s+1}}\n$$\n$$\nG_{\\mathrm{cl}}(s) = \\frac{(1-\\delta)s + 1-\\delta+b}{\\delta s + \\delta-b}\n$$\nFor this closed-loop system to be passive, two conditions must be met.\n1. Analyticity in $\\operatorname{Re}(s)>0$: The poles of $G_{\\mathrm{cl}}(s)$ must lie in the closed left-half plane, $\\operatorname{Re}(s) \\le 0$. Any simple poles on the imaginary axis must have positive real residues. The pole of $G_{\\mathrm{cl}}(s)$ is the root of the denominator: $\\delta s + \\delta - b = 0$, which gives the pole location $s_p = \\dfrac{b-\\delta}{\\delta}$. Since $\\delta > 0$, the condition $\\operatorname{Re}(s_p) \\le 0$ requires $b-\\delta \\le 0$, which implies $\\delta \\ge b$. If $\\delta = b$, the pole is at $s_p = 0$. The residue at this simple pole is $\\lim_{s \\to 0} s G_{\\mathrm{cl}}(s) = \\lim_{s \\to 0} s \\dfrac{(1-b)s+1}{b s} = \\dfrac{1}{b}$. Since $b \\in (0,1)$, the residue $1/b$ is real and positive, which is permissible for a passive system. Thus, the stability condition is $\\delta \\ge b$.\n\n2. Positive Real Part on the Imaginary Axis: We must have $\\operatorname{Re}[G_{\\mathrm{cl}}(\\mathrm{j}\\omega)] \\ge 0$ for all real $\\omega$.\n$$\nG_{\\mathrm{cl}}(\\mathrm{j}\\omega) = \\frac{(1-\\delta)\\mathrm{j}\\omega + (1-\\delta+b)}{\\delta\\mathrm{j}\\omega + (\\delta-b)}\n$$\nTo find the real part, we multiply the numerator and denominator by the conjugate of the denominator:\n$$\n\\operatorname{Re}[G_{\\mathrm{cl}}(\\mathrm{j}\\omega)] = \\operatorname{Re}\\left[ \\frac{((1-\\delta+b) + (1-\\delta)\\mathrm{j}\\omega)((\\delta-b) - \\delta\\mathrm{j}\\omega)}{|\\delta\\mathrm{j}\\omega + (\\delta-b)|^2} \\right]\n$$\nThe denominator is real and positive. The real part of the numerator is:\n$$\n\\operatorname{Re}[\\text{num}] = (1-\\delta+b)(\\delta-b) + ((1-\\delta)\\omega)(\\delta\\omega) = (1-\\delta+b)(\\delta-b) + (1-\\delta)\\delta\\omega^2\n$$\nSo, the condition becomes:\n$$\n\\frac{(1-\\delta+b)(\\delta-b) + (1-\\delta)\\delta\\omega^2}{(\\delta-b)^2 + (\\delta\\omega)^2} \\ge 0\n$$\nSince the denominator is always non-negative, the numerator must be non-negative for all $\\omega$. Let $N(\\omega) = (1-\\delta+b)(\\delta-b) + (1-\\delta)\\delta\\omega^2$. Given $\\delta \\in (0,1)$, the term $(1-\\delta)\\delta\\omega^2$ is non-negative. Therefore, the minimum value of $N(\\omega)$ occurs at $\\omega=0$. The condition reduces to $N(0) \\ge 0$:\n$$\n(1-\\delta+b)(\\delta-b) \\ge 0\n$$\nSince $\\delta \\in (0,1)$ and $b \\in (0,1)$, the first factor $(1-\\delta+b)$ is always positive. The inequality is thus satisfied if and only if the second factor is non-negative:\n$$\n\\delta - b \\ge 0 \\implies \\delta \\ge b\n$$\nBoth the stability condition and the positive real part condition yield the same necessary and sufficient inequality: $\\delta \\ge b$.\nThe problem asks for the smallest value of $\\delta$ that guarantees passivity. This corresponds to the minimum value in the allowed range for $\\delta$. The required range is $\\delta \\ge b$. Since $\\delta \\in (0,1)$ and $b \\in (0,1)$, the full condition for $\\delta$ is $b \\le \\delta < 1$. The smallest value in this set is $b$.", "answer": "$$\n\\boxed{b}\n$$", "id": "2730416"}]}