{"hands_on_practices": [{"introduction": "The ability to move from the frequency domain back to the time domain is a cornerstone of system analysis. This practice focuses on a crucial technique: inverting a Z-transform with repeated poles. By working from first principles [@problem_id:2757913], you will not only calculate the time-domain signal but also gain a deeper understanding of why repeated poles at $z=p$ lead to responses containing terms like $n^{m-1} p^n$, a fundamental insight into system dynamics.", "problem": "A right-sided discrete-time signal with bilateral Z-transform $X(z)$ has repeated poles. You are told that $X(z)$ is rational, its region of convergence is $|z| > \\rho$, and the signal is causal and absolutely summable. Consider the specific case\n$$\nX(z) \\;=\\; \\frac{1}{\\bigl(1 - \\tfrac{1}{2}\\,z^{-1}\\bigr)^{3}\\,\\bigl(1 + \\tfrac{1}{3}\\,z^{-1}\\bigr)^{2}},\n$$\nwith region of convergence $|z| > \\tfrac{1}{2}$. Beginning from the definition of the bilateral Z-transform,\n$$\n\\mathcal{Z}\\{x[n]\\}(z) \\;=\\; X(z) \\;=\\; \\sum_{n=-\\infty}^{\\infty} x[n]\\,z^{-n},\n$$\nand using only foundational results such as linearity, the geometric series, and its generalizations obtained by repeated summation or differentiation (but without invoking any pre-memorized inversion shortcuts), carry out the following:\n\n- Decompose $X(z)$ into a sum of terms of the form $\\dfrac{C}{\\bigl(1 - p\\,z^{-1}\\bigr)^{m}}$ by determining the coefficients $C$ associated with the repeated poles at $p=\\tfrac{1}{2}$ of multiplicity $m=3$ and at $p=-\\tfrac{1}{3}$ of multiplicity $m=2$.\n\n- From first principles, derive the corresponding time-domain sequences for each repeated-pole term by expanding in powers of $z^{-1}$ and identifying the coefficients in $n$. Explicitly connect your derivation to the binomial expansion to show that these coefficients are polynomials in $n$ of degree $m-1$ multiplying $p^{n}$, and explain how this relates to the leading-order behavior proportional to $n^{m-1}\\,p^{n}$.\n\nExpress your final result as a single, closed-form analytic expression for $x[n]$ valid for all $n \\in \\mathbb{Z}$, using the unit-step $u[n]$ to encode causality. Do not leave the answer as a summation. No rounding is required, and no physical units are involved.", "solution": "The problem requires the determination of the inverse Z-transform of a given rational function $X(z)$ with repeated poles. The solution must proceed from first principles, avoiding direct use of lookup tables for Z-transform pairs. The process involves two main stages: partial fraction expansion of $X(z)$ and principled inversion of each term.\n\nThe given Z-transform is:\n$$\nX(z) = \\frac{1}{\\bigl(1 - \\tfrac{1}{2}\\,z^{-1}\\bigr)^{3}\\,\\bigl(1 + \\tfrac{1}{3}\\,z^{-1}\\bigr)^{2}}\n$$\nThe region of convergence (ROC) is given as $|z| > \\frac{1}{2}$. The poles of $X(z)$ are at $z = \\frac{1}{2}$ (multiplicity $3$) and $z = -\\frac{1}{3}$ (multiplicity $2$). Since the ROC is the exterior of a circle containing all poles, the signal $x[n]$ is causal and right-sided, which is consistent with the problem statement. The fact that the ROC includes the unit circle $|z|=1$ confirms the statement that the signal is absolutely summable.\n\nLet us define a variable $v = z^{-1}$. The function becomes:\n$$\nF(v) = X(z) = \\frac{1}{\\bigl(1 - \\tfrac{1}{2}v\\bigr)^{3}\\,\\bigl(1 + \\tfrac{1}{3}v\\bigr)^{2}}\n$$\nThis is a proper rational function in $v$. We seek a partial fraction expansion of the form:\n$$\nF(v) = \\frac{A_1}{1 - \\frac{1}{2}v} + \\frac{A_2}{\\bigl(1 - \\frac{1}{2}v\\bigr)^2} + \\frac{A_3}{\\bigl(1 - \\frac{1}{2}v\\bigr)^3} + \\frac{B_1}{1 + \\frac{1}{3}v} + \\frac{B_2}{\\bigl(1 + \\frac{1}{3}v\\bigr)^2}\n$$\nTo find the coefficients $A_k$ associated with the pole at $v=2$, we define a function $G_A(v)$ by removing the pole factor:\n$$\nG_A(v) = \\bigl(1 - \\tfrac{1}{2}v\\bigr)^3 F(v) = \\frac{1}{\\bigl(1 + \\tfrac{1}{3}v\\bigr)^2} = \\bigl(1 + \\tfrac{1}{3}v\\bigr)^{-2}\n$$\nThe coefficients $A_k$ are related to the Taylor series expansion of $G_A(v)$ around the point $v=2$. We have:\n$$\nG_A(v) = A_3 + A_2\\bigl(1 - \\tfrac{1}{2}v\\bigr) + A_1\\bigl(1 - \\tfrac{1}{2}v\\bigr)^2 + \\dots\n$$\nBy setting $v=p' = \\frac{1}{1/2} = 2$, and noting that the expansion variable is $x = (1 - v/p')$, the coefficients are given by the formula $A_{3-k} = \\frac{(-p')^k}{k!} G_A^{(k)}(p')$, where $G_A^{(k)}$ is the $k$-th derivative of $G_A$.\n\nFor $k=0$:\n$A_3 = G_A(2) = \\bigl(1 + \\frac{2}{3}\\bigr)^{-2} = \\bigl(\\frac{5}{3}\\bigr)^{-2} = \\frac{9}{25}$.\n\nFor $k=1$:\n$G_A'(v) = -2\\bigl(1 + \\frac{1}{3}v\\bigr)^{-3} \\cdot \\frac{1}{3} = -\\frac{2}{3}\\bigl(1 + \\frac{1}{3}v\\bigr)^{-3}$.\n$G_A'(2) = -\\frac{2}{3}\\bigl(\\frac{5}{3}\\bigr)^{-3} = -\\frac{2}{3} \\cdot \\frac{27}{125} = -\\frac{18}{125}$.\n$A_2 = \\frac{(-2)^1}{1!} G_A'(2) = -2 \\cdot \\bigl(-\\frac{18}{125}\\bigr) = \\frac{36}{125}$.\n\nFor $k=2$:\n$G_A''(v) = -\\frac{2}{3} \\cdot (-3)\\bigl(1 + \\frac{1}{3}v\\bigr)^{-4} \\cdot \\frac{1}{3} = \\frac{2}{3}\\bigl(1 + \\frac{1}{3}v\\bigr)^{-4}$.\n$G_A''(2) = \\frac{2}{3}\\bigl(\\frac{5}{3}\\bigr)^{-4} = \\frac{2}{3} \\cdot \\frac{81}{625} = \\frac{54}{625}$.\n$A_1 = \\frac{(-2)^2}{2!} G_A''(2) = \\frac{4}{2} \\cdot \\frac{54}{625} = \\frac{108}{625}$.\n\nSimilarly, for the coefficients $B_k$ associated with the pole at $v=-3$:\n$$\nG_B(v) = \\bigl(1 + \\tfrac{1}{3}v\\bigr)^2 F(v) = \\frac{1}{\\bigl(1 - \\tfrac{1}{2}v\\bigr)^3} = \\bigl(1 - \\tfrac{1}{2}v\\bigr)^{-3}\n$$\nThe expansion point is $p' = \\frac{1}{-1/3} = -3$.\nFor $k=0$:\n$B_2 = G_B(-3) = \\bigl(1 - \\frac{1}{2}(-3)\\bigr)^{-3} = \\bigl(1 + \\frac{3}{2}\\bigr)^{-3} = \\bigl(\\frac{5}{2}\\bigr)^{-3} = \\frac{8}{125}$.\n\nFor $k=1$:\n$G_B'(v) = -3\\bigl(1 - \\frac{1}{2}v\\bigr)^{-4} \\cdot (-\\frac{1}{2}) = \\frac{3}{2}\\bigl(1 - \\frac{1}{2}v\\bigr)^{-4}$.\n$G_B'(-3) = \\frac{3}{2}\\bigl(1 - \\frac{1}{2}(-3)\\bigr)^{-4} = \\frac{3}{2}\\bigl(\\frac{5}{2}\\bigr)^{-4} = \\frac{3}{2} \\cdot \\frac{16}{625} = \\frac{24}{625}$.\n$B_1 = \\frac{(-p')^1}{1!} G_B'(-3) = \\frac{-(-3)}{1} \\cdot \\frac{24}{625} = 3 \\cdot \\frac{24}{625} = \\frac{72}{625}$.\n\nThe partial fraction expansion is:\n$$\nX(z) = \\frac{108/625}{1 - \\frac{1}{2}z^{-1}} + \\frac{36/125}{\\bigl(1 - \\frac{1}{2}z^{-1}\\bigr)^2} + \\frac{9/25}{\\bigl(1 - \\frac{1}{2}z^{-1}\\bigr)^3} + \\frac{72/625}{1 + \\frac{1}{3}z^{-1}} + \\frac{8/125}{\\bigl(1 + \\frac{1}{3}z^{-1}\\bigr)^2}\n$$\nNext, we derive the inverse Z-transform for each term from first principles. The fundamental building block is the geometric series for a causal signal:\n$$\n\\frac{1}{1 - pz^{-1}} = \\sum_{n=0}^{\\infty} (pz^{-1})^n = \\sum_{n=0}^{\\infty} p^n z^{-n}\n$$\nComparing this with the definition $X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$, we identify the corresponding time-domain sequence as $p^n u[n]$, where $u[n]$ is the unit step function.\n\nTo find the inverse transform of terms with repeated poles, we use differentiation. Differentiating the geometric series relation with respect to $p$:\n$$\n\\frac{\\partial}{\\partial p}\\left(\\frac{1}{1 - pz^{-1}}\\right) = \\frac{z^{-1}}{(1 - pz^{-1})^2} \\quad \\text{and} \\quad \\frac{\\partial}{\\partial p}\\left(\\sum_{n=0}^{\\infty} p^n z^{-n}\\right) = \\sum_{n=0}^{\\infty} n p^{n-1} z^{-n}\n$$\nEquating these gives $\\frac{1}{(1-pz^{-1})^2} = \\sum_{n=0}^{\\infty} n p^{n-1} z^{-(n-1)} = z \\sum_{n=0}^{\\infty} n p^{n-1} z^{-n}$. This route is not direct. A better approach is differentiation with respect to $z^{-1}$:\n$$\n\\frac{d}{d(z^{-1})} \\left(\\frac{1}{1-pz^{-1}}\\right) = \\frac{p}{(1-pz^{-1})^2} \\quad \\text{and} \\quad \\frac{d}{d(z^{-1})} \\left(\\sum_{n=0}^{\\infty} p^n (z^{-1})^n \\right) = \\sum_{n=1}^{\\infty} n p^n (z^{-1})^{n-1}\n$$\nLetting $k=n-1$, the series is $\\sum_{k=0}^{\\infty} (k+1) p^{k+1} (z^{-1})^k$. Thus,\n$$\n\\frac{p}{(1-pz^{-1})^2} = \\sum_{n=0}^{\\infty} (n+1) p^{n+1} z^{-n} \\implies \\frac{1}{(1-pz^{-1})^2} = \\sum_{n=0}^{\\infty} (n+1) p^n z^{-n}\n$$\nThe corresponding sequence is $(n+1)p^n u[n]$.\n\nAlternatively, using the generalized binomial theorem $(1-x)^{-m} = \\sum_{n=0}^{\\infty} \\binom{n+m-1}{n} x^n$:\n$$\n\\frac{1}{(1-pz^{-1})^m} = \\sum_{n=0}^{\\infty} \\binom{n+m-1}{n} (pz^{-1})^n = \\sum_{n=0}^{\\infty} \\binom{n+m-1}{m-1} p^n z^{-n}\n$$\nThe inverse transform is $\\binom{n+m-1}{m-1} p^n u[n]$. The binomial coefficient $\\binom{n+m-1}{m-1} = \\frac{(n+m-1)\\dots(n+1)}{(m-1)!}$ is a polynomial in $n$ of degree $m-1$. Its leading term is $\\frac{n^{m-1}}{(m-1)!}$, so the sequence behaves as $n^{m-1}p^n$ for large $n$.\n\nFor $m=2$, we have $\\binom{n+1}{1} = n+1$, confirming our differentiation result.\nFor $m=3$, we have $\\binom{n+2}{2} = \\frac{(n+2)(n+1)}{2}$.\n\nUsing these derived pairs and the linearity of the Z-transform, we find $x[n]$:\n$x[n] = \\mathcal{Z}^{-1}\\{X(z)\\} = x_1[n] + x_2[n] + x_3[n] + x_4[n] + x_5[n]$.\n$x_1[n] = \\frac{108}{625} (\\frac{1}{2})^n u[n]$\n$x_2[n] = \\frac{36}{125} (n+1) (\\frac{1}{2})^n u[n]$\n$x_3[n] = \\frac{9}{25} \\binom{n+2}{2} (\\frac{1}{2})^n u[n] = \\frac{9}{50} (n+2)(n+1) (\\frac{1}{2})^n u[n]$\n$x_4[n] = \\frac{72}{625} (-\\frac{1}{3})^n u[n]$\n$x_5[n] = \\frac{8}{125} (n+1) (-\\frac{1}{3})^n u[n]$\n\nCombining terms:\n$x[n] = \\left[ \\frac{108}{625} + \\frac{36}{125}(n+1) + \\frac{9}{50}(n^2+3n+2) \\right] \\left(\\frac{1}{2}\\right)^n u[n] \\\\ \\qquad + \\left[ \\frac{72}{625} + \\frac{8}{125}(n+1) \\right] \\left(-\\frac{1}{3}\\right)^n u[n]$\n\nSimplify the polynomial coefficients. For the first term:\n$P_1(n) = \\frac{9}{50}n^2 + \\left(\\frac{36}{125} + \\frac{27}{50}\\right)n + \\left(\\frac{108}{625} + \\frac{36}{125} + \\frac{18}{50}\\right)$\n$P_1(n) = \\frac{225}{1250}n^2 + \\left(\\frac{360}{1250} + \\frac{675}{1250}\\right)n + \\left(\\frac{216}{1250} + \\frac{360}{1250} + \\frac{450}{1250}\\right)$\n$P_1(n) = \\frac{225 n^2 + 1035 n + 1026}{1250} = \\frac{9}{1250}(25n^2 + 115n + 114)$\n\nFor the second term:\n$P_2(n) = \\frac{8}{125}n + \\left(\\frac{72}{625} + \\frac{8}{125}\\right) = \\frac{40}{625}n + \\left(\\frac{72}{625} + \\frac{40}{625}\\right)$\n$P_2(n) = \\frac{40n + 112}{625} = \\frac{8}{625}(5n + 14)$\n\nThe final expression for $x[n]$ is:\n$x[n] = \\left( \\frac{9}{1250}(25n^2 + 115n + 114) \\left(\\frac{1}{2}\\right)^n + \\frac{8}{625}(5n + 14) \\left(-\\frac{1}{3}\\right)^n \\right) u[n]$\nThis is the complete, closed-form expression for the sequence $x[n]$ for all $n \\in \\mathbb{Z}$.", "answer": "$$\n\\boxed{\\left( \\frac{9}{1250}(25n^2 + 115n + 114) \\left(\\frac{1}{2}\\right)^n + \\frac{8}{625}(5n + 14) \\left(-\\frac{1}{3}\\right)^n \\right) u[n]}\n$$", "id": "2757913"}, {"introduction": "Understanding a system's stability is paramount in control theory and signal processing. This exercise [@problem_id:2757940] delves into the important case of marginal stability, where poles lie directly on the unit circle. By analyzing the system's impulse response, you will uncover the crucial difference between a bounded response and an absolutely summable one, clarifying why such systems are not Bounded-Input Bounded-Output (BIBO) stable.", "problem": "Consider the causal Linear Time-Invariant (LTI) system defined by the constant-coefficient difference equation\n$$y[n]-2\\cos(\\omega_0)\\,y[n-1]+y[n-2]=x[n],$$\nwith $0<\\omega_0<\\pi$ and zero initial rest conditions. Let $h[n]$ denote the impulse response (the output when $x[n]=\\delta[n]$). Let $H(z)$ denote the Z-transform of $h[n]$ with region of convergence (ROC), and let $\\mathcal{F}\\{h[n]\\}$ denote the Discrete-Time Fourier Transform (DTFT) of $h[n]$ if it exists. Recall that Bounded-Input Bounded-Output (BIBO) stability for an LTI system is equivalent to the absolute summability of its impulse response and that the DTFT exists in the usual sense if and only if the ROC of $H(z)$ includes the unit circle $|z|=1$.\n\nSelect all statements that are correct for the above system:\n\nA. The transfer function $H(z)$ has poles at $z=e^{\\pm j\\omega_0}$, and the impulse response $h[n]$ is bounded for all $n\\in\\mathbb{Z}$ but is not absolutely summable; hence the system is marginally stable.\n\nB. The system is BIBO stable because $h[n]$ is bounded for all $n$.\n\nC. For the causal system, the ROC of $H(z)$ includes the unit circle $|z|=1$, so the DTFT $\\mathcal{F}\\{h[n]\\}$ exists and coincides with the steady-state frequency response.\n\nD. The series $\\sum_{n=0}^{\\infty}\\lvert h[n]\\rvert$ diverges because $\\lvert h[n]\\rvert$ does not approach $0$ as $n\\to\\infty$.\n\nE. If the two poles at $z=e^{\\pm j\\omega_0}$ were replaced by a repeated (double) pole at $z=e^{j\\omega_0}$, the impulse response would remain bounded and still be not absolutely summable.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Causal Linear Time-Invariant (LTI) system.\n- Difference equation: $y[n]-2\\cos(\\omega_0)\\,y[n-1]+y[n-2]=x[n]$.\n- Parameter range: $0<\\omega_0<\\pi$.\n- Initial conditions: zero initial rest.\n- $h[n]$: impulse response.\n- $H(z)$: Z-transform of $h[n]$.\n- $\\mathcal{F}\\{h[n]\\}$: Discrete-Time Fourier Transform (DTFT) of $h[n]$.\n- Definition of Bounded-Input Bounded-Output (BIBO) stability: absolute summability of $h[n]$, i.e., $\\sum_{n=-\\infty}^{\\infty} \\lvert h[n] \\rvert < \\infty$.\n- Condition for DTFT existence: Region of Convergence (ROC) of $H(z)$ includes the unit circle, $\\lvert z \\rvert=1$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is formulated using standard definitions and principles of discrete-time linear systems theory. The difference equation is a valid representation of an LTI system. The specified parameter range for $\\omega_0$ is well-defined. The initial conditions ensure a unique response. The statements provided for BIBO stability and DTFT existence are correct textbook definitions. The problem is self-contained, mathematically sound, and objective. It is a standard problem in the analysis of LTI systems.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. We proceed to a full solution.\n\n**Derivation and Analysis**\n\nFirst, we determine the system's transfer function, $H(z)$, by applying the Z-transform to the difference equation. Using the time-shifting property $\\mathcal{Z}\\{f[n-k]\\} = z^{-k} F(z)$ and assuming zero initial conditions, we obtain:\n$$Y(z) - 2\\cos(\\omega_0)z^{-1}Y(z) + z^{-2}Y(z) = X(z)$$\n$$Y(z)(1 - 2\\cos(\\omega_0)z^{-1} + z^{-2}) = X(z)$$\nThe transfer function $H(z) = Y(z)/X(z)$ is therefore:\n$$H(z) = \\frac{1}{1 - 2\\cos(\\omega_0)z^{-1} + z^{-2}} = \\frac{z^2}{z^2 - 2\\cos(\\omega_0)z + 1}$$\n\nNext, we find the poles of $H(z)$ by finding the roots of the denominator polynomial $z^2 - 2\\cos(\\omega_0)z + 1 = 0$. Using the quadratic formula:\n$$z = \\frac{2\\cos(\\omega_0) \\pm \\sqrt{(2\\cos(\\omega_0))^2 - 4}}{2} = \\cos(\\omega_0) \\pm \\sqrt{\\cos^2(\\omega_0) - 1}$$\nUsing the identity $\\cos^2(\\omega_0) - 1 = -\\sin^2(\\omega_0)$, we get:\n$$z = \\cos(\\omega_0) \\pm \\sqrt{- \\sin^2(\\omega_0)} = \\cos(\\omega_0) \\pm j\\sin(\\omega_0)$$\nBy Euler's formula, the poles are $p_1 = e^{j\\omega_0}$ and $p_2 = e^{-j\\omega_0}$.\nSince $0 < \\omega_0 < \\pi$, we know that $\\sin(\\omega_0) \\neq 0$, which ensures the poles are distinct and complex. The magnitude of both poles is $\\lvert e^{\\pm j\\omega_0} \\rvert = 1$. Thus, the poles lie on the unit circle.\n\nThe problem states the system is causal. For a causal system, the Region of Convergence (ROC) is the region in the z-plane outside the outermost pole. Here, the poles are on the unit circle, so the ROC is $\\lvert z \\rvert > 1$.\n\nBIBO stability requires that the ROC of $H(z)$ includes the unit circle $\\lvert z \\rvert = 1$. Since the ROC is $\\lvert z \\rvert > 1$, it does not include the unit circle. Therefore, the system is not BIBO stable. This implies that the impulse response $h[n]$ is not absolutely summable, i.e., $\\sum_{n=-\\infty}^{\\infty} \\lvert h[n] \\rvert = \\infty$.\n\nTo analyze the properties of the impulse response $h[n]$, we find its expression by inverse Z-transforming $H(z)$. Using partial fraction expansion:\n$$H(z) = \\frac{1}{(1 - e^{j\\omega_0}z^{-1})(1 - e^{-j\\omega_0}z^{-1})} = \\frac{A}{1 - e^{j\\omega_0}z^{-1}} + \\frac{B}{1 - e^{-j\\omega_0}z^{-1}}$$\nThe coefficients are:\n$$A = \\frac{1}{1-e^{-j2\\omega_0}} = \\frac{1}{e^{-j\\omega_0}(e^{j\\omega_0}-e^{-j\\omega_0})} = \\frac{e^{j\\omega_0}}{2j\\sin(\\omega_0)}$$\n$$B = \\frac{1}{1-e^{j2\\omega_0}} = \\frac{1}{e^{j\\omega_0}(e^{-j\\omega_0}-e^{j\\omega_0})} = \\frac{-e^{-j\\omega_0}}{2j\\sin(\\omega_0)}$$\nThus,\n$$H(z) = \\frac{1}{2j\\sin(\\omega_0)} \\left( \\frac{e^{j\\omega_0}}{1-e^{j\\omega_0}z^{-1}} - \\frac{e^{-j\\omega_0}}{1-e^{-j\\omega_0}z^{-1}} \\right)$$\nFor a causal system, the inverse Z-transform of $\\frac{1}{1-pz^{-1}}$ is $p^n u[n]$. Applying this, we get the impulse response:\n$$h[n] = \\frac{1}{2j\\sin(\\omega_0)} \\left( e^{j\\omega_0}(e^{j\\omega_0})^n - e^{-j\\omega_0}(e^{-j\\omega_0})^n \\right) u[n]$$\n$$h[n] = \\frac{1}{2j\\sin(\\omega_0)} \\left( e^{j(n+1)\\omega_0} - e^{-j(n+1)\\omega_0} \\right) u[n]$$\nUsing the identity $\\sin(\\theta) = \\frac{e^{j\\theta} - e^{-j\\theta}}{2j}$, this simplifies to:\n$$h[n] = \\frac{\\sin((n+1)\\omega_0)}{\\sin(\\omega_0)} u[n]$$\nFor $n \\ge 0$, the magnitude of the impulse response is $\\lvert h[n] \\rvert = \\frac{\\lvert \\sin((n+1)\\omega_0) \\rvert}{\\lvert \\sin(\\omega_0) \\rvert}$.\nSince $\\lvert \\sin(\\theta) \\rvert \\le 1$ and $0 < \\omega_0 < \\pi$ implies $\\sin(\\omega_0) \\ne 0$, we have $\\lvert h[n] \\rvert \\le \\frac{1}{\\lvert \\sin(\\omega_0) \\rvert}$. This means the impulse response $h[n]$ is bounded for all $n$.\nHowever, the terms $\\lvert h[n] \\rvert$ do not approach $0$ as $n \\to \\infty$. By the term test for divergence, the series $\\sum_{n=0}^{\\infty} \\lvert h[n] \\rvert$ must diverge. The system is therefore not BIBO stable. Systems with simple, non-repeated poles on the unit circle are defined as marginally stable.\n\n**Option-by-Option Analysis**\n\n**A. The transfer function $H(z)$ has poles at $z=e^{\\pm j\\omega_0}$, and the impulse response $h[n]$ is bounded for all $n\\in\\mathbb{Z}$ but is not absolutely summable; hence the system is marginally stable.**\n- **Poles:** Our calculation shows the poles are indeed at $z=e^{\\pm j\\omega_0}$. This is correct.\n- **Impulse Response Properties:** We found $h[n] = \\frac{\\sin((n+1)\\omega_0)}{\\sin(\\omega_0)} u[n]$. This is bounded but not absolutely summable. This is correct.\n- **Conclusion:** The term for such a system is \"marginally stable\". This is correct.\nThe statement is entirely correct. Verdict: **Correct**.\n\n**B. The system is BIBO stable because $h[n]$ is bounded for all $n$.**\nThe premise is that the system is BIBO stable. This is false. The reason given, \"$h[n]$ is bounded for all $n$\", is a necessary but not sufficient condition for BIBO stability. The correct condition is absolute summability. This statement propagates a common misunderstanding. Verdict: **Incorrect**.\n\n**C. For the causal system, the ROC of $H(z)$ includes the unit circle $|z|=1$, so the DTFT $\\mathcal{F}\\{h[n]\\}$ exists and coincides with the steady-state frequency response.**\nThe ROC for this causal system with poles on the unit circle is $\\lvert z \\rvert > 1$. This region does not include the unit circle. The DTFT, defined as the Z-transform evaluated on the unit circle, does not exist as a convergent function in the usual sense because the impulse response is not absolutely summable. The statement is factually wrong on its primary claim. Verdict: **Incorrect**.\n\n**D. The series $\\sum_{n=0}^{\\infty}\\lvert h[n]\\rvert$ diverges because $\\lvert h[n]\\rvert$ does not approach $0$ as $n\\to\\infty$.**\nThe system is not BIBO stable, which means by definition that the series $\\sum_{n=0}^{\\infty}\\lvert h[n]\\rvert$ diverges. The reason given is that $\\lim_{n \\to \\infty} \\lvert h[n] \\rvert \\neq 0$. As we established, $\\lvert h[n] \\rvert = \\frac{\\lvert \\sin((n+1)\\omega_0) \\rvert}{\\lvert \\sin(\\omega_0) \\rvert}$, and this sequence does not converge to $0$. The term test for divergence states that if the terms of a series do not tend to zero, the series diverges. This is a valid and correct justification for the divergence. Verdict: **Correct**.\n\n**E. If the two poles at $z=e^{\\pm j\\omega_0}$ were replaced by a repeated (double) pole at $z=e^{j\\omega_0}$, the impulse response would remain bounded and still be not absolutely summable.**\nA system with a double pole at $p_0=e^{j\\omega_0}$ could have a transfer function like $H_{new}(z) = \\frac{1}{(1-e^{j\\omega_0}z^{-1})^2}$. The inverse Z-transform for a causal system is found from the pair $(n+1)p_0^n u[n] \\leftrightarrow \\frac{1}{(1-p_0z^{-1})^2}$ for $\\lvert z \\rvert > \\lvert p_0 \\rvert$.\nThe impulse response would be $h_{new}[n] = (n+1)(e^{j\\omega_0})^n u[n]$.\nThe magnitude is $\\lvert h_{new}[n] \\rvert = (n+1) \\lvert e^{j\\omega_0} \\rvert^n = (n+1) \\cdot 1^n = n+1$ for $n \\ge 0$.\nThe impulse response magnitude grows linearly with $n$ and is therefore **unbounded**. The statement claims the response would remain bounded, which is false. A repeated pole on the unit circle leads to an unstable system with an unbounded impulse response. Verdict: **Incorrect**.", "answer": "$$\\boxed{AD}$$", "id": "2757940"}, {"introduction": "Analytical shortcuts like the Final Value Theorem are powerful but must be used with caution. This practice [@problem_id:2757911] illustrates the potential pitfalls of applying this theorem without first verifying the system's stability. By examining systems with poles on or outside the unit circle, you will see firsthand how a naive calculation can yield a misleading finite value while the true time-domain response either diverges or fails to converge, reinforcing the importance of theoretical rigor.", "problem": "Consider two causal discrete-time Linear Time-Invariant (LTI) systems driven by the unit step input $u[k]$ defined by $u[k]=0$ for $k<0$ and $u[k]=1$ for $k\\ge 0$. Let their transfer functions (Z-transform of the impulse responses) be\n- System $\\mathcal{S}_1$: $H_1(z)=\\dfrac{z}{z-1.1}$,\n- System $\\mathcal{S}_2$: $H_2(z)=\\dfrac{z}{z+1}$.\n\nA commonly used but hazardous shortcut is to infer the steady-state value $\\lim_{k\\to\\infty} y[k]$ of the output $y[k]$ by applying the final value theorem for the Z-transform without checking its applicability conditions. In particular, one may compute a finite candidate number by evaluating a limit at $z=1$ derived from the Z-domain representation of the output, even when stability or pole-location requirements are not satisfied.\n\nUsing only foundational definitions and facts about the Z-transform, causality, region of convergence, and pole locations, determine for each system whether this naive shortcut produces a finite “final value” prediction and whether the actual time-domain output $y[k]$ converges as $k\\to\\infty$. Then, identify the correct explanation in terms of the locations of the poles of the relevant Z-domain expressions relative to the unit circle.\n\nWhich option is correct?\n\nA. Both $\\mathcal{S}_1$ and $\\mathcal{S}_2$ are counterexamples: a naive “final value” computation yields a finite number for each, namely $-10$ for $\\mathcal{S}_1$ and $\\tfrac{1}{2}$ for $\\mathcal{S}_2$, yet the actual $y_1[k]$ diverges in magnitude (exponential growth) and $y_2[k]$ does not converge (persistent oscillation). The failures occur because the relevant Z-domain expressions have, respectively, a pole outside the unit circle at $z=1.1$ and a pole on the unit circle at $z=-1$.\n\nB. Only $\\mathcal{S}_1$ is a counterexample: the naive “final value” is finite ($-10$), but $y_1[k]$ converges to a different finite value; for $\\mathcal{S}_2$, the naive “final value” ($\\tfrac{1}{2}$) agrees with $\\lim_{k\\to\\infty} y_2[k]$.\n\nC. Only $\\mathcal{S}_2$ is a counterexample: the naive “final value” is finite ($\\tfrac{1}{2}$), but $y_2[k]$ diverges in magnitude; for $\\mathcal{S}_1$, the naive “final value” ($-10$) agrees with $\\lim_{k\\to\\infty} y_1[k]$.\n\nD. Neither $\\mathcal{S}_1$ nor $\\mathcal{S}_2$ is a counterexample: in both cases the naive “final value” equals the true $\\lim_{k\\to\\infty} y[k]$ because the substitution $z\\to 1$ is justified whenever that limit exists as a finite number in algebraic manipulation.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extract Givens**\n- Causal discrete-time Linear Time-Invariant (LTI) systems $\\mathcal{S}_1$ and $\\mathcal{S}_2$.\n- Input: unit step $u[k]$, where $u[k]=0$ for $k<0$ and $u[k]=1$ for $k\\ge 0$.\n- Transfer function of System $\\mathcal{S}_1$: $H_1(z)=\\dfrac{z}{z-1.1}$.\n- Transfer function of System $\\mathcal{S}_2$: $H_2(z)=\\dfrac{z}{z+1}$.\n- Task: Analyze a naive application of the final value theorem, which involves computing a \"final value\" by evaluating a limit at $z=1$ without checking applicability conditions. For each system, compare this naive result to the actual limiting behavior of the output $y[k]$ and explain the outcome based on pole locations.\n\n**Step 2: Validate Using Extracted Givens**\n- The problem is **scientifically grounded** in the established theory of discrete-time control systems and Z-transforms.\n- The problem is **well-posed**, providing all necessary functions ($H_1(z), H_2(z)$) and the input ($u[k]$) to uniquely determine the outputs ($y_1[k], y_2[k]$) and their properties. The term \"causal\" unambiguously defines the region of convergence (ROC) for the systems.\n- The problem is **objective**, stated in precise mathematical language.\n- The setup is **complete and consistent**.\n\n**Step 3: Verdict and Action**\nThe problem statement is found to be valid. A rigorous derivation of the solution will now proceed.\n\nThe analysis is based on fundamental principles. The Z-transform of the input unit step function $u[k]$ is given by\n$$U(z) = \\mathcal{Z}\\{u[k]\\} = \\sum_{k=0}^{\\infty} (1)z^{-k} = \\frac{1}{1-z^{-1}} = \\frac{z}{z-1}, \\quad |z|>1$$\nThe Z-transform of the output $Y(z)$ of an LTI system with transfer function $H(z)$ is the product of the transfer function and the input's Z-transform, $Y(z) = H(z)U(z)$. The final value theorem for the Z-transform states that if the sequence $y[k]$ converges to a finite limit, then $\\lim_{k\\to\\infty} y[k] = \\lim_{z\\to 1} (z-1)Y(z)$. A sufficient condition for the applicability of this theorem is that all poles of the function $(z-1)Y(z)$ must lie strictly inside the unit circle, i.e., have magnitude less than $1$. The \"naive shortcut\" mentioned in the problem consists of computing the limit $\\lim_{z\\to 1} (z-1)Y(z)$ irrespective of this condition.\n\n**Analysis of System $\\mathcal{S}_1$**\n\nThe transfer function is $H_1(z) = \\dfrac{z}{z-1.1}$.\nThe Z-transform of the output is\n$$Y_1(z) = H_1(z)U(z) = \\left( \\frac{z}{z-1.1} \\right) \\left( \\frac{z}{z-1} \\right) = \\frac{z^2}{(z-1.1)(z-1)}$$\nThe naive \"final value\" is computed as:\n$$y_{1,ss}^{\\text{naive}} = \\lim_{z\\to 1} (z-1)Y_1(z) = \\lim_{z\\to 1} (z-1)\\frac{z^2}{(z-1.1)(z-1)} = \\lim_{z\\to 1} \\frac{z^2}{z-1.1} = \\frac{1^2}{1-1.1} = \\frac{1}{-0.1} = -10$$\nThis computation yields a finite number, $-10$.\n\nNow, we check the condition for the final value theorem. The function to be examined is $(z-1)Y_1(z) = \\dfrac{z^2}{z-1.1}$. The poles of this function are the roots of the denominator, which is $z-1.1=0$, giving a pole at $z=1.1$. The magnitude of this pole is $|1.1| > 1$, which is outside the unit circle. The theorem is not applicable.\n\nTo find the actual behavior of the output $y_1[k]$, we must compute the inverse Z-transform of $Y_1(z)$. We perform a partial fraction expansion of $Y_1(z)/z$:\n$$\\frac{Y_1(z)}{z} = \\frac{z}{(z-1.1)(z-1)} = \\frac{A}{z-1.1} + \\frac{B}{z-1}$$\nThe coefficients are:\n$$A = \\left. \\frac{z}{z-1} \\right|_{z=1.1} = \\frac{1.1}{1.1-1} = \\frac{1.1}{0.1} = 11$$\n$$B = \\left. \\frac{z}{z-1.1} \\right|_{z=1} = \\frac{1}{1-1.1} = \\frac{1}{-0.1} = -10$$\nThus,\n$$Y_1(z) = 11 \\left( \\frac{z}{z-1.1} \\right) - 10 \\left( \\frac{z}{z-1} \\right)$$\nUsing the Z-transform pair $\\mathcal{Z}\\{a^k u[k]\\} = \\frac{z}{z-a}$ for $|z|>|a|$, the inverse transform is:\n$$y_1[k] = \\left( 11(1.1)^k - 10(1)^k \\right) u[k] = (11(1.1)^k - 10)u[k]$$\nAs $k \\to \\infty$, the term $(1.1)^k$ grows without bound since its base $1.1$ is greater than $1$. Therefore, $\\lim_{k\\to\\infty} y_1[k] = \\infty$. The output diverges with exponential growth.\n\nConclusion for $\\mathcal{S}_1$: The naive calculation yields a finite value of $-10$, but the actual output diverges. This is a counterexample to the naive shortcut. The failure is correctly attributed to the pole of $(z-1)Y_1(z)$ at $z=1.1$, located outside the unit circle.\n\n**Analysis of System $\\mathcal{S}_2$**\n\nThe transfer function is $H_2(z) = \\dfrac{z}{z+1}$.\nThe Z-transform of the output is\n$$Y_2(z) = H_2(z)U(z) = \\left( \\frac{z}{z+1} \\right) \\left( \\frac{z}{z-1} \\right) = \\frac{z^2}{(z+1)(z-1)}$$\nThe naive \"final value\" is computed as:\n$$y_{2,ss}^{\\text{naive}} = \\lim_{z\\to 1} (z-1)Y_2(z) = \\lim_{z\\to 1} (z-1)\\frac{z^2}{(z+1)(z-1)} = \\lim_{z\\to 1} \\frac{z^2}{z+1} = \\frac{1^2}{1+1} = \\frac{1}{2}$$\nThis computation yields a finite number, $\\frac{1}{2}$.\n\nWe check the condition for the final value theorem. The function is $(z-1)Y_2(z) = \\dfrac{z^2}{z+1}$. The poles are roots of $z+1=0$, giving a pole at $z=-1$. The magnitude is $|-1|=1$. A pole on the unit circle (other than a single pole at $z=1$ in $Y(z)$ which is cancelled) violates the strict requirement that poles be *inside* the unit circle. The theorem is not applicable.\n\nTo find the actual behavior of $y_2[k]$, we perform a partial fraction expansion of $Y_2(z)/z$:\n$$\\frac{Y_2(z)}{z} = \\frac{z}{(z+1)(z-1)} = \\frac{A}{z+1} + \\frac{B}{z-1}$$\nThe coefficients are:\n$$A = \\left. \\frac{z}{z-1} \\right|_{z=-1} = \\frac{-1}{-1-1} = \\frac{1}{2}$$\n$$B = \\left. \\frac{z}{z+1} \\right|_{z=1} = \\frac{1}{1+1} = \\frac{1}{2}$$\nThus,\n$$Y_2(z) = \\frac{1}{2} \\left( \\frac{z}{z+1} \\right) + \\frac{1}{2} \\left( \\frac{z}{z-1} \\right)$$\nThe inverse Z-transform is:\n$$y_2[k] = \\left( \\frac{1}{2}(-1)^k + \\frac{1}{2}(1)^k \\right) u[k] = \\frac{1}{2}(1 + (-1)^k)u[k]$$\nThe sequence $y_2[k]$ for $k \\ge 0$ is $1, 0, 1, 0, 1, \\dots$. This sequence oscillates between $0$ and $1$ and does not converge to a single value. Therefore, $\\lim_{k\\to\\infty} y_2[k]$ does not exist.\n\nConclusion for $\\mathcal{S}_2$: The naive calculation yields a finite value of $\\frac{1}{2}$, but the actual output does not converge. This is also a counterexample to the naive shortcut. The failure is correctly attributed to the pole of $(z-1)Y_2(z)$ at $z=-1$, located on the unit circle.\n\n**Evaluation of Options**\n\nA. **Correct**. This option correctly states that both systems are counterexamples. It provides the correct naive final values: $-10$ for $\\mathcal{S}_1$ and $\\frac{1}{2}$ for $\\mathcal{S}_2$. It accurately describes the true behavior of the outputs: $y_1[k]$ diverges exponentially and $y_2[k]$ exhibits persistent oscillation (does not converge). Crucially, it provides the correct justification by identifying the poles of the relevant expressions, $(z-1)Y_1(z)$ at $z=1.1$ (outside the unit circle) and $(z-1)Y_2(z)$ at $z=-1$ (on the unit circle), as the reason for the failure of the final value theorem.\n\nB. **Incorrect**. This option is incorrect on multiple accounts. It claims $y_1[k]$ converges, when it diverges. It also claims the naive and actual final values for $\\mathcal{S}_2$ agree, when in fact $y_2[k]$ does not converge at all.\n\nC. **Incorrect**. This option incorrectly claims that the naive value for $\\mathcal{S}_1$ agrees with its limit, which is false as the output diverges. It also mischaracterizes the behavior of $y_2[k]$ as diverging in magnitude, when it is bounded and oscillating.\n\nD. **Incorrect**. This option incorrectly claims that neither system is a counterexample. This is patently false based on the derivations above. The reasoning provided is precisely the fallacy the problem is designed to expose: the validity of the final value theorem is not guaranteed by the existence of an algebraic limit but depends on the pole locations.", "answer": "$$\\boxed{A}$$", "id": "2757911"}]}