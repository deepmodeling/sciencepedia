{"hands_on_practices": [{"introduction": "The first step in creating a state-space model is to determine its correct dimension, which corresponds to the system's McMillan degree. This exercise [@problem_id:1754747] highlights that the apparent order of a system, judged by the degree of the denominator in its initial transfer function, can be misleading. By identifying and canceling common factors between the numerator and denominator, you will find the irreducible transfer function that represents the system's minimal dynamics and then construct a corresponding model using the standard controller canonical form.", "problem": "A stable Linear Time-Invariant (LTI) system is a critical component in the design of an electronic signal processing unit. The behavior of such a system is described by its transfer function, $H(s)$, which relates the Laplace transform of the output, $Y(s)$, to the Laplace transform of the input, $U(s)$, via $Y(s) = H(s)U(s)$.\n\nThe specific transfer function for the system under consideration is given by:\n$$H(s) = \\frac{s^2 + 5s + 6}{s^3 + 7s^2 + 17s + 15}$$\n\nTo implement this system digitally, it is necessary to first find a state-space representation. A state-space model is given by the set of equations:\n$$\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)$$\n$$y(t) = C \\mathbf{x}(t) + D u(t)$$\nwhere $\\mathbf{x}(t)$ is the state vector, $u(t)$ is the input, and $y(t)$ is the output. The matrices are $A$, $B$, $C$, and $D$.\n\nDetermine a minimal state-space realization for this system in **controller canonical form**. A minimal realization is one with the smallest possible dimension for the state vector. Once you have determined the matrices $A$, $B$, $C$, and $D$ for the minimal second-order system, calculate the value of the expression $\\text{Tr}(A) + A_{21} + C_1 - B_2$. Here, $\\text{Tr}(A)$ is the trace of matrix $A$, $A_{21}$ is the element in the second row and first column of $A$, $C_1$ is the first element of the row vector $C = [C_1 \\ C_2]$, and $B_2$ is the second element of the column vector $B = [B_1 \\ B_2]^T$.", "solution": "We start from the given transfer function $H(s) = \\dfrac{s^{2} + 5s + 6}{s^{3} + 7s^{2} + 17s + 15}$ with $Y(s) = H(s)U(s)$. Factor numerator and denominator to check for pole-zero cancellations:\n$$s^{2} + 5s + 6 = (s+2)(s+3), \\quad s^{3} + 7s^{2} + 17s + 15 = (s+3)(s^{2} + 4s + 5).$$\nCancel the common factor $(s+3)$ to obtain the minimal transfer function\n$$H_{\\min}(s) = \\frac{s+2}{s^{2} + 4s + 5}.$$\nThe minimal realization therefore has order $2$.\n\nFor a strictly proper second-order transfer function\n$$H(s) = \\frac{b_{1}s + b_{0}}{s^{2} + a_{1}s + a_{0}}, \\quad D = 0,$$\nthe controller canonical form is given by\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -a_{0} & -a_{1} \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} b_{0} & b_{1} \\end{pmatrix}, \\quad D = 0.$$\nTo verify, compute the transfer function from this realization:\n$$(sI - A) = \\begin{pmatrix} s & -1 \\\\ a_{0} & s + a_{1} \\end{pmatrix}, \\quad (sI - A)^{-1} B = \\frac{1}{s^{2} + a_{1}s + a_{0}} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix},$$\nso\n$$H(s) = C(sI - A)^{-1}B + D = \\frac{b_{0} + b_{1}s}{s^{2} + a_{1}s + a_{0}},$$\nas required.\n\nFor $H_{\\min}(s) = \\dfrac{s+2}{s^{2} + 4s + 5}$ we identify $a_{1} = 4$, $a_{0} = 5$, $b_{1} = 1$, $b_{0} = 2$. Hence\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -5 & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 2 & 1 \\end{pmatrix}, \\quad D = 0.$$\n\nNow compute the requested expression. The trace is $\\text{Tr}(A) = 0 + (-4) = -4$. The element $A_{21} = -5$, the first element of $C$ is $C_{1} = 2$, and the second element of $B$ is $B_{2} = 1$. Therefore,\n$$\\text{Tr}(A) + A_{21} + C_{1} - B_{2} = (-4) + (-5) + 2 - 1 = -8.$$", "answer": "$$\\boxed{-8}$$", "id": "1754747"}, {"introduction": "Once the minimal order of a system is known, we can construct a state-space model, and there are multiple ways to do so. This practice [@problem_id:2880756] demonstrates a physically intuitive method based on parallel decomposition, where each mode of the system is modeled as a separate first-order state. More importantly, it reinforces the fundamental definition of minimality by tasking you to prove that the resulting realization is both controllable and observable, thereby solidifying the link between these core concepts and the state-space representation.", "problem": "Consider a Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) system in the Laplace variable domain with transfer function\n$$\nH(s)=\\frac{s+2}{(s+1)(s+3)}.\n$$\nStarting from core definitions, determine the McMillan degree of the system by reasoning about pole-zero structure and cancellations. Then construct a minimal state-space realization by decomposing the transfer function into a sum of strictly proper first-order terms and realizing each mode as a first-order state driven by the input, with the outputs added to form the total output. Verify minimality by proving both controllability and observability of the constructed realization directly from their rank tests based on the definitions. Do not assume any canonical form without derivation.\n\nProvide your final answer as a row matrix listing, in order,\n$$\nn,\\ a_{11},\\ a_{12},\\ a_{21},\\ a_{22},\\ b_{1},\\ b_{2},\\ c_{1},\\ c_{2},\\ d,\n$$\nwhere $n$ is the McMillan degree, $\\mathbf{A}=\\begin{pmatrix}a_{11}&a_{12}\\\\a_{21}&a_{22}\\end{pmatrix}$, $\\mathbf{B}=\\begin{pmatrix}b_{1}\\\\b_{2}\\end{pmatrix}$, $\\mathbf{C}=\\begin{pmatrix}c_{1}&c_{2}\\end{pmatrix}$, and $D=d$. No rounding is required, and all entries must be exact real values.", "solution": "The McMillan degree of a Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) system is defined as the dimension of a minimal realization, which equals the sum of the orders of the irreducible pole factors of the transfer function after all pole-zero cancellations. For a strictly proper rational transfer function, if there are no pole-zero cancellations, the McMillan degree equals the degree of the denominator polynomial.\n\nWe start from the given transfer function\n$$\nH(s)=\\frac{s+2}{(s+1)(s+3)}.\n$$\nThe denominator factors are $(s+1)(s+3)$ with simple poles at $s=-1$ and $s=-3$. The numerator zero is at $s=-2$, which does not cancel any pole. Therefore, there are no pole-zero cancellations, and the McMillan degree is\n$$\nn=2.\n$$\n\nTo construct a minimal realization from first principles, we use the decomposition of $H(s)$ into a sum of simple first-order terms, each corresponding to a single mode. We perform partial fraction expansion:\n$$\n\\frac{s+2}{(s+1)(s+3)}=\\frac{A}{s+1}+\\frac{B}{s+3}.\n$$\nEquating numerators,\n$$\ns+2=A(s+3)+B(s+1)=(A+B)s+(3A+B).\n$$\nMatching coefficients yields\n$$\nA+B=1,\\qquad 3A+B=2.\n$$\nSubtracting gives\n$$\n2A=1\\ \\Rightarrow\\ A=\\frac{1}{2},\\qquad B=1-A=\\frac{1}{2}.\n$$\nHence\n$$\nH(s)=\\frac{1}{2}\\cdot\\frac{1}{s+1}+\\frac{1}{2}\\cdot\\frac{1}{s+3}.\n$$\n\nWe now realize each term as a first-order state driven by the common input and producing a weighted output, then sum the outputs. For a term of the form $k/(s+a)$, a first-order realization consistent with the definition of the transfer function $H(s)=C(s\\mathbf{I}-\\mathbf{A})^{-1}B+D$ is\n$$\n\\dot{x}=-a\\,x+u,\\quad y=k\\,x,\\quad D=0,\n$$\nsince\n$$\nC(s\\mathbf{I}-\\mathbf{A})^{-1}B=\\frac{k}{s+a}.\n$$\n\nApplying this to the two terms gives two states $x_{1}$ and $x_{2}$:\n- For $\\frac{1}{2}\\cdot\\frac{1}{s+1}$, choose $A_{1}=-1$, $B_{1}=1$, $C_{1}=\\frac{1}{2}$.\n- For $\\frac{1}{2}\\cdot\\frac{1}{s+3}$, choose $A_{2}=-3$, $B_{2}=1$, $C_{2}=\\frac{1}{2}$.\n\nStacking these in parallel (driven by the same input $u$ and summed at the output) yields the realization\n$$\n\\dot{\\mathbf{x}}=\\mathbf{A}\\mathbf{x}+\\mathbf{B}u,\\qquad y=\\mathbf{C}\\mathbf{x}+Du,\n$$\nwith\n$$\n\\mathbf{A}=\\begin{pmatrix}-1 & 0 \\\\ 0 & -3\\end{pmatrix},\\quad \\mathbf{B}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad \\mathbf{C}=\\begin{pmatrix}\\tfrac{1}{2} & \\tfrac{1}{2}\\end{pmatrix},\\quad D=0.\n$$\nVerification that this realization matches $H(s)$:\n$$\n\\mathbf{C}(s\\mathbf{I}-\\mathbf{A})^{-1}\\mathbf{B}=\\begin{pmatrix}\\tfrac{1}{2} & \\tfrac{1}{2}\\end{pmatrix}\\begin{pmatrix}\\frac{1}{s+1} & 0 \\\\ 0 & \\frac{1}{s+3}\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=\\frac{1}{2}\\cdot\\frac{1}{s+1}+\\frac{1}{2}\\cdot\\frac{1}{s+3}=H(s).\n$$\n\nWe next verify controllability and observability using their definitions. The controllability matrix for $(\\mathbf{A},\\mathbf{B})$ is\n$$\n\\mathcal{C}=\\begin{bmatrix}\\mathbf{B} & \\mathbf{A}\\mathbf{B}\\end{bmatrix}=\\begin{bmatrix}1 & -1 \\\\ 1 & -3\\end{bmatrix}.\n$$\nIts determinant is\n$$\n\\det(\\mathcal{C})=(1)(-3)-(1)(-1)=-3+1=-2\\neq 0,\n$$\nso $\\mathcal{C}$ has full rank $2$ and the pair is controllable.\n\nThe observability matrix for $(\\mathbf{A},\\mathbf{C})$ is\n$$\n\\mathcal{O}=\\begin{bmatrix}\\mathbf{C} \\\\ \\mathbf{C}\\mathbf{A}\\end{bmatrix}=\\begin{bmatrix}\\tfrac{1}{2} & \\tfrac{1}{2} \\\\ -\\tfrac{1}{2} & -\\tfrac{3}{2}\\end{bmatrix}.\n$$\nIts determinant is\n$$\n\\det(\\mathcal{O})=\\left(\\tfrac{1}{2}\\right)\\left(-\\tfrac{3}{2}\\right)-\\left(\\tfrac{1}{2}\\right)\\left(-\\tfrac{1}{2}\\right)=-\\tfrac{3}{4}+\\tfrac{1}{4}=-\\tfrac{1}{2}\\neq 0,\n$$\nso $\\mathcal{O}$ has full rank $2$ and the pair is observable.\n\nThus the realization is controllable and observable, hence minimal, with McMillan degree $n=2$.\n\nTo present the final answer in the requested order\n$$\nn,\\ a_{11},\\ a_{12},\\ a_{21},\\ a_{22},\\ b_{1},\\ b_{2},\\ c_{1},\\ c_{2},\\ d,\n$$\nwe substitute the computed values:\n$$\nn=2,\\quad a_{11}=-1,\\ a_{12}=0,\\ a_{21}=0,\\ a_{22}=-3,\\quad b_{1}=1,\\ b_{2}=1,\\quad c_{1}=\\tfrac{1}{2},\\ c_{2}=\\tfrac{1}{2},\\quad d=0.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2 & -1 & 0 & 0 & -3 & 1 & 1 & \\tfrac{1}{2} & \\tfrac{1}{2} & 0\\end{pmatrix}}$$", "id": "2880756"}, {"introduction": "Why is finding a *minimal* realization so important? This advanced problem [@problem_id:2749016] explores the critical consequences of non-minimal models by having you deliberately construct one with hidden dynamics. You will see how an internally unstable system can misleadingly exhibit a perfectly stable transfer function, a phenomenon caused by \"hidden modes\" that are neither controllable from the input nor observable at the output. This exercise powerfully illustrates that the transfer function does not tell the whole story, and that internal stability is a crucial property revealed only by analyzing a minimal state-space realization.", "problem": "Consider the single-input single-output linear time-invariant system with transfer function\n$$G(s) = \\frac{s + 4}{s^{2} + 5 s + 6}.$$\nThis transfer function is strictly proper and stable. Starting only from the state-space definition of a transfer function, namely that for a realization $(A,B,C,D)$ the input-output map under zero initial conditions is\n$$G(s) = C\\,(s I - A)^{-1} B + D,$$\ncarry out the following.\n\n1) Construct a minimal-order stable realization $(A_{\\mathrm{min}},B_{\\mathrm{min}},C_{\\mathrm{min}},D_{\\mathrm{min}})$ for $G(s)$ and justify that it matches $G(s)$ by direct evaluation from the definition above.\n\n2) Augment your minimal realization to a nonminimal realization $(A,B,C,D)$ that is internally unstable but still realizes the same $G(s)$ due to pole-zero cancellations arising from lack of controllability and/or observability. Specifically, embed an additional unreachable and unobservable two-dimensional subsystem whose dynamics matrix has distinct real unstable eigenvalues at $s=2$ and $s=5$. Clearly specify your block-structured $(A,B,C,D)$.\n\n3) Prove directly from $G(s) = C\\,(s I - A)^{-1} B + D$ that your augmented nonminimal realization has the same transfer function $G(s)$ as the original, and explain why the unstable internal poles do not appear as poles of $G(s)$.\n\n4) Identify the hidden unstable modes of your constructed realization.\n\nAnswer format: Report only the hidden unstable eigenvalues from part 4 as a single row matrix using the LaTeX $\\mathrm{pmatrix}$ environment. No rounding is required and no units are involved.", "solution": "**1) Minimal-Order Stable Realization**\n\nThe given transfer function is $G(s) = \\frac{s + 4}{s^{2} + 5 s + 6}$.\nA minimal realization has an order equal to the degree of the denominator of the irreducible transfer function, which is $n=2$. We construct a realization in controller canonical form. For a general second-order transfer function $G(s) = \\frac{b_1 s + b_0}{s^2 + a_1 s + a_0}$, the controller canonical form is given by:\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -a_0 & -a_1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} b_0 & b_1 \\end{pmatrix}, \\quad D = [0]$$\nFrom $G(s)$, we identify the coefficients: $a_1=5$, $a_0=6$, $b_1=1$, and $b_0=4$. Since the transfer function is strictly proper, $D_{\\mathrm{min}}=0$.\nThus, a minimal realization is:\n$$A_{\\mathrm{min}} = \\begin{pmatrix} 0 & 1 \\\\ -6 & -5 \\end{pmatrix}, \\quad B_{\\mathrm{min}} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C_{\\mathrm{min}} = \\begin{pmatrix} 4 & 1 \\end{pmatrix}, \\quad D_{\\mathrm{min}} = 0$$\nThe eigenvalues of $A_{\\mathrm{min}}$ are the roots of the characteristic equation $\\det(sI - A_{\\mathrm{min}}) = s(s+5) - (1)(-6) = s^2+5s+6 = 0$, which are $s=-2$ and $s=-3$. Both are in the left-half plane, so this realization is stable.\n\nTo verify this realization, we compute the transfer function $G_{\\mathrm{min}}(s) = C_{\\mathrm{min}}(sI - A_{\\mathrm{min}})^{-1} B_{\\mathrm{min}} + D_{\\mathrm{min}}$.\n$$sI - A_{\\mathrm{min}} = \\begin{pmatrix} s & -1 \\\\ 6 & s+5 \\end{pmatrix}$$\nThe inverse is:\n$$(sI - A_{\\mathrm{min}})^{-1} = \\frac{1}{\\det(sI-A_{\\mathrm{min}})} \\begin{pmatrix} s+5 & 1 \\\\ -6 & s \\end{pmatrix} = \\frac{1}{s^2+5s+6} \\begin{pmatrix} s+5 & 1 \\\\ -6 & s \\end{pmatrix}$$\nNow, we compute the product:\n$$G_{\\mathrm{min}}(s) = \\begin{pmatrix} 4 & 1 \\end{pmatrix} \\frac{1}{s^2+5s+6} \\begin{pmatrix} s+5 & 1 \\\\ -6 & s \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n$$G_{\\mathrm{min}}(s) = \\frac{1}{s^2+5s+6} \\begin{pmatrix} 4 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix} = \\frac{4(1) + 1(s)}{s^2+5s+6} = \\frac{s+4}{s^2+5s+6}$$\nThis matches the given $G(s)$, so the realization is correct.\n\n**2) Augmented Nonminimal Unstable Realization**\n\nWe must augment the minimal realization with a two-dimensional subsystem that is both unreachable (uncontrollable) and unobservable, and has unstable eigenvalues at $s=2$ and $s=5$.\nLet the state of the minimal system be $x_{\\mathrm{min}} \\in \\mathbb{R}^2$ and the state of the hidden subsystem be $x_{\\mathrm{hid}} \\in \\mathbb{R}^2$. The augmented state vector is $x = \\begin{pmatrix} x_{\\mathrm{min}} \\\\ x_{\\mathrm{hid}} \\end{pmatrix}$.\nTo ensure the added subsystem is unreachable and unobservable, we can place it in a block-diagonal structure, decoupling it from the minimal realization.\nThe dynamics of the hidden subsystem are governed by a matrix $A_{\\mathrm{hid}}$ whose eigenvalues are $2$ and $5$. A simple choice is the diagonal matrix $A_{\\mathrm{hid}} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 5 \\end{pmatrix}$.\nThe augmented state-space matrices $(A,B,C,D)$ are constructed as follows:\n$$A = \\begin{pmatrix} A_{\\mathrm{min}} & 0 \\\\ 0 & A_{\\mathrm{hid}} \\end{pmatrix}, \\quad B = \\begin{pmatrix} B_{\\mathrm{min}} \\\\ 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} C_{\\mathrm{min}} & 0 \\end{pmatrix}, \\quad D = D_{\\mathrm{min}}$$\nSubstituting the specific matrices:\n$$A = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ -6 & -5 & 0 & 0 \\\\ 0 & 0 & 2 & 0 \\\\ 0 & 0 & 0 & 5 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 4 & 1 & 0 & 0 \\end{pmatrix}, \\quad D = 0$$\nThe eigenvalues of $A$ are the union of the eigenvalues of the diagonal blocks: $\\{-2, -3, 2, 5\\}$. The presence of eigenvalues $2$ and $5$ makes this realization internally unstable. The structure of $B$ and $C$ ensures the subsystem with states $x_3, x_4$ is unreachable and unobservable.\n\n**3) Verification of the Augmented Realization**\n\nWe prove that this nonminimal realization yields the same transfer function $G(s)$. We compute $G_{\\mathrm{aug}}(s) = C(sI - A)^{-1} B + D$.\nThe matrix $sI-A$ has a block-diagonal structure:\n$$sI - A = \\begin{pmatrix} sI - A_{\\mathrm{min}} & 0 \\\\ 0 & sI - A_{\\mathrm{hid}} \\end{pmatrix}$$\nIts inverse is the block-diagonal matrix of the inverses:\n$$(sI - A)^{-1} = \\begin{pmatrix} (sI - A_{\\mathrm{min}})^{-1} & 0 \\\\ 0 & (sI - A_{\\mathrm{hid}})^{-1} \\end{pmatrix}$$\nThe transfer function is then:\n$$G_{\\mathrm{aug}}(s) = \\begin{pmatrix} C_{\\mathrm{min}} & 0 \\end{pmatrix} \\begin{pmatrix} (sI - A_{\\mathrm{min}})^{-1} & 0 \\\\ 0 & (sI-A_{\\mathrm{hid}})^{-1} \\end{pmatrix} \\begin{pmatrix} B_{\\mathrm{min}} \\\\ 0 \\end{pmatrix} + 0$$\nPerforming the block matrix multiplication:\n$$G_{\\mathrm{aug}}(s) = C_{\\mathrm{min}} (sI - A_{\\mathrm{min}})^{-1} B_{\\mathrm{min}} + 0 \\cdot (sI-A_{\\mathrm{hid}})^{-1} \\cdot 0$$\n$$G_{\\mathrm{aug}}(s) = C_{\\mathrm{min}} (sI - A_{\\mathrm{min}})^{-1} B_{\\mathrm{min}} = G(s)$$\nThis proves that the augmented realization has the same transfer function as the original minimal system.\n\nThe unstable poles of the realization, which are the eigenvalues $s=2$ and $s=5$ of the matrix $A$, do not appear as poles of the transfer function $G(s)$. The transfer function only reflects the dynamics of the controllable and observable part of the system. In the expression for $G_{\\mathrm{aug}}(s)$, the term $(sI-A_{\\mathrm{hid}})^{-1}$ contains the factors $(s-2)$ and $(s-5)$ in its denominator. However, this block is pre-multiplied by a zero block in $C$ and post-multiplied by a zero block in $B$. This algebraic nullification is the mathematical manifestation of pole-zero cancellation. The unstable dynamics are \"hidden\" from the input-output map because they are neither excited by the input (uncontrollable) nor visible in the output (unobservable).\n\n**4) Identification of Hidden Unstable Modes**\n\nThe modes of the system are the eigenvalues of the state matrix $A$. The eigenvalues of the augmented matrix $A$ are $\\{-2, -3, 2, 5\\}$.\nThe poles of the transfer function $G(s)$ are $\\{-2, -3\\}$. These correspond to the controllable and observable modes of the system.\nThe hidden modes are the eigenvalues of $A$ that are not poles of $G(s)$. These are the modes associated with the uncontrollable and/or unobservable part of the system.\nBy comparison, the hidden modes are $\\{2, 5\\}$.\nA mode is unstable if its corresponding eigenvalue has a non-negative real part. Both $2$ and $5$ are positive real numbers.\nTherefore, the hidden unstable modes are precisely the eigenvalues of the augmented subsystem, $s=2$ and $s=5$.", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 5 \\end{pmatrix}}$$", "id": "2749016"}]}