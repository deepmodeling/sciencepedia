{"hands_on_practices": [{"introduction": "The design of a feedback controller begins with the assumption that all state variables are available for measurement. This exercise establishes the foundational technique of state-feedback pole placement, where the goal is to shape the system's dynamic response by assigning eigenvalues to the closed-loop system matrix. By working through the derivation from first principles, you will solidify your understanding of how system controllability guarantees the ability to arbitrarily place poles and see how a canonical system form simplifies the gain calculation [@problem_id:2693684].", "problem": "Consider the single-input single-output linear time-invariant system given in state space by\n$$\n\\dot{x}(t) = A x(t) + b\\,u(t), \n\\qquad y(t) = c\\,x(t),\n$$\nwith\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}0 \\\\ 0 \\\\ 0 \\\\ 1\\end{pmatrix}, \n\\quad\nc = \\begin{pmatrix}1 & 0 & 0 & 0\\end{pmatrix}.\n$$\nYou will design a state-feedback gain for pole placement using a derivation rooted in the controllability concept and the Cayley–Hamilton theorem, and then discuss how this integrates with an observer to yield an output-feedback realization.\n\nTasks:\n1) Starting from the definition of the controllability matrix and the Cayley–Hamilton theorem, derive the expression that yields a state-feedback gain $K \\in \\mathbb{R}^{1\\times 4}$ which assigns an arbitrary prescribed monic characteristic polynomial to the closed-loop matrix $A - bK$. Your derivation must explicitly justify why the expression is valid under the controllability assumption, and it must express the gain in terms of $A$, $b$, and the controllability matrix.\n\n2) For the system above, compute the unique state-feedback gain $K$ that places the closed-loop poles at the prescribed locations $\\{-1,-2,-3,-4\\}$, i.e., that assigns the desired characteristic polynomial\n$$\n\\varphi_{d}(s) = (s+1)(s+2)(s+3)(s+4).\n$$\nProvide $K$ as a $1\\times 4$ row vector. Express your answer in exact integers; do not round.\n\n3) Suppose only the output $y(t)$ is measured. Explain how to realize a dynamic output-feedback controller by constructing a Luenberger observer with gain $L \\in \\mathbb{R}^{4\\times 1}$ and control law $u(t) = -K \\hat{x}(t)$, and write down the estimation error dynamics. State how the eigenvalues of the combined controller–observer closed-loop system relate to the chosen controller and observer poles. You should not compute $L$ numerically.\n\n4) Discuss, from a numerical analysis perspective, the sensitivity of the gain-computation expression derived in Task 1 when applied to high-order or poorly conditioned realizations. Identify at least two principled mitigation strategies that reduce numerical sensitivity while preserving the pole-placement objective.\n\nYour final reported answer must be the gain $K$ from Task 2 as a single $1\\times 4$ row vector.", "solution": "The problem presented is a standard exercise in linear control theory, concerning the design and analysis of a state-feedback controller and an observer for a single-input single-output (SISO) linear time-invariant (LTI) system. All components of the problem are well-defined, scientifically sound, and internally consistent. The provided system data are complete and properly structured for the tasks. Therefore, the problem is valid and a rigorous solution can be constructed.\n\nThe system is described by the state-space equations:\n$$\n\\dot{x}(t) = A x(t) + b\\,u(t), \n\\qquad y(t) = c\\,x(t)\n$$\nwith matrices\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}0 \\\\ 0 \\\\ 0 \\\\ 1\\end{pmatrix}, \n\\quad\nc = \\begin{pmatrix}1 & 0 & 0 & 0\\end{pmatrix}.\n$$\nThe order of the system is $n=4$.\n\nThe tasks will be addressed in sequence.\n\n**Task 1: Derivation of the State-Feedback Gain Expression**\n\nThe objective is to find a state-feedback gain matrix $K \\in \\mathbb{R}^{1 \\times n}$ for the control law $u(t) = -Kx(t)$ such that the closed-loop system $\\dot{x}(t) = (A-bK)x(t)$ has a prescribed characteristic polynomial $\\varphi_d(s)$.\n\nThe existence of a unique gain $K$ that can assign an arbitrary set of $n$ self-conjugate closed-loop poles (or, equivalently, an arbitrary real characteristic polynomial of degree $n$) is guaranteed if and only if the system pair $(A,b)$ is controllable. Controllability implies that the controllability matrix $\\mathcal{C} = \\begin{pmatrix} b & Ab & \\dots & A^{n-1}b \\end{pmatrix}$ has full rank, i.e., $\\text{rank}(\\mathcal{C}) = n$, which means $\\mathcal{C}$ is invertible.\n\nThe derivation is most transparently performed by transforming the system into controllable canonical form (CCF). If $(A,b)$ is controllable, there exists an invertible transformation matrix $T$ such that the transformed state $z=Tx$ evolves according to $\\dot{z} = \\bar{A}z + \\bar{b}u$, where $\\bar{A} = TAT^{-1}$ and $\\bar{b} = Tb$ are in CCF:\n$$\n\\bar{A} = \\begin{pmatrix}\n0 & 1 & 0 & \\dots & 0 \\\\\n0 & 0 & 1 & \\dots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\dots & 1 \\\\\n-a_0 & -a_1 & -a_2 & \\dots & -a_{n-1}\n\\end{pmatrix}, \\quad\n\\bar{b} = \\begin{pmatrix}\n0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1\n\\end{pmatrix}.\n$$\nThe coefficients $a_i$ in the last row of $\\bar{A}$ define the characteristic polynomial of the open-loop system, $\\varphi_A(s) = \\det(sI - A) = \\det(sI - \\bar{A}) = s^n + a_{n-1}s^{n-1} + \\dots + a_1s + a_0$.\n\nThe feedback law in the transformed coordinates is $u = -Kx = -K T^{-1} z = -\\bar{K}z$, where $\\bar{K} = K T^{-1}$. The closed-loop matrix in the new coordinates is $\\bar{A}_{cl} = \\bar{A} - \\bar{b}\\bar{K}$.\n$$\n\\bar{A} - \\bar{b}\\bar{K} = \\begin{pmatrix}\n0 & 1 & \\dots & 0 \\\\\n\\vdots & & \\ddots & \\vdots \\\\\n0 & 0 & \\dots & 1 \\\\\n-a_0 & -a_1 & \\dots & -a_{n-1}\n\\end{pmatrix} -\n\\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix}\n\\begin{pmatrix} \\bar{k}_1 & \\bar{k}_2 & \\dots & \\bar{k}_n \\end{pmatrix}\n= \\begin{pmatrix}\n0 & 1 & \\dots & 0 \\\\\n\\vdots & & \\ddots & \\vdots \\\\\n0 & 0 & \\dots & 1 \\\\\n-(a_0+\\bar{k}_1) & -(a_1+\\bar{k}_2) & \\dots & -(a_{n-1}+\\bar{k}_n)\n\\end{pmatrix}.\n$$\nThe characteristic polynomial of this matrix is $\\varphi_{cl}(s) = s^n + (a_{n-1}+\\bar{k}_n)s^{n-1} + \\dots + (a_0+\\bar{k}_1)$. Let the desired characteristic polynomial be $\\varphi_d(s) = s^n + \\alpha_{n-1}s^{n-1} + \\dots + \\alpha_0$. By equating the coefficients of $\\varphi_{cl}(s)$ and $\\varphi_d(s)$, we find the required gain $\\bar{K}$ in the CCF basis:\n$$\na_i + \\bar{k}_{i+1} = \\alpha_i \\implies \\bar{k}_{i+1} = \\alpha_i - a_i \\quad \\text{for } i = 0, \\dots, n-1.\n$$\nThus, $\\bar{K} = \\begin{pmatrix} \\alpha_0-a_0 & \\alpha_1-a_1 & \\dots & \\alpha_{n-1}-a_{n-1} \\end{pmatrix}$.\n\nThe gain in the original coordinates is recovered by transforming back: $K = \\bar{K}T$. While this procedure proves the existence and provides a method for computing $K$, it requires finding the transformation $T$. A more direct expression, known as Ackermann's formula, relates $K$ directly to the original system matrices and the desired polynomial. The formula is rooted in the same principles of controllability and also leverages the Cayley-Hamilton theorem, which states that any matrix satisfies its own characteristic equation, i.e., $\\varphi_A(A) = 0$.\n\nThe expression for the gain $K$ is given by:\n$$\nK = \\begin{pmatrix} 0 & 0 & \\dots & 1 \\end{pmatrix} \\mathcal{C}^{-1} \\varphi_d(A)\n$$\nwhere $\\mathcal{C} = \\begin{pmatrix} b & Ab & \\dots & A^{n-1}b \\end{pmatrix}$ is the controllability matrix and $\\varphi_d(A)$ is the matrix polynomial $\\varphi_d(A) = A^n + \\alpha_{n-1}A^{n-1} + \\dots + \\alpha_1 A + \\alpha_0 I$. The invertibility of $\\mathcal{C}$ is guaranteed by system controllability. This formula represents a compact, symbolic solution to the pole placement problem derived from the transformation-based method.\n\n**Task 2: Computation of the State-Feedback Gain**\n\nThe given system is already in controllable canonical form with $n=4$. The last row of $A$ contains the negated coefficients of its characteristic polynomial.\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-a_0 & -a_1 & -a_2 & -a_3\n\\end{pmatrix} = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & -2 & -3 & -4\n\\end{pmatrix}.\n$$\nThe coefficients of the open-loop characteristic polynomial $\\varphi_A(s) = s^4 + a_3 s^3 + a_2 s^2 + a_1 s + a_0$ are $a_0 = 1$, $a_1 = 2$, $a_2 = 3$, and $a_3 = 4$.\n\nThe desired closed-loop poles are at $\\{-1, -2, -3, -4\\}$. The desired characteristic polynomial is:\n$$\n\\varphi_d(s) = (s+1)(s+2)(s+3)(s+4)\n$$\nExpanding this polynomial:\n$$\n\\varphi_d(s) = (s^2 + 3s + 2)(s^2 + 7s + 12) = s^4 + 7s^3 + 12s^2 + 3s^3 + 21s^2 + 36s + 2s^2 + 14s + 24\n$$\n$$\n\\varphi_d(s) = s^4 + 10s^3 + 35s^2 + 50s + 24.\n$$\nThe coefficients of the desired polynomial $\\varphi_d(s) = s^4 + \\alpha_3 s^3 + \\alpha_2 s^2 + \\alpha_1 s + \\alpha_0$ are $\\alpha_0 = 24$, $\\alpha_1 = 50$, $\\alpha_2 = 35$, and $\\alpha_3 = 10$.\n\nSince the system is in CCF, we are already in the \"bar\" coordinates from Task 1, so $T=I$ and $K=\\bar{K}$. The gain is computed directly as:\n$$\nK = \\begin{pmatrix} \\alpha_0 - a_0 & \\alpha_1 - a_1 & \\alpha_2 - a_2 & \\alpha_3 - a_3 \\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix} 24 - 1 & 50 - 2 & 35 - 3 & 10 - 4 \\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix} 23 & 48 & 32 & 6 \\end{pmatrix}.\n$$\n\n**Task 3: Output-Feedback Controller-Observer Structure**\n\nWhen the full state vector $x(t)$ is not directly measurable and only the output $y(t) = cx(t)$ is available, we must estimate the state. This is accomplished using a state observer, typically a Luenberger observer. The observer is a dynamical system that generates an estimate $\\hat{x}(t)$ of the state $x(t)$.\n\nThe observer dynamics are given by:\n$$\n\\dot{\\hat{x}}(t) = A\\hat{x}(t) + bu(t) + L(y(t) - \\hat{y}(t))\n$$\nwhere $\\hat{x}(t)$ is the state estimate, $\\hat{y}(t) = c\\hat{x}(t)$ is the estimated output, and $L \\in \\mathbb{R}^{n \\times 1}$ is the observer gain matrix. The term $L(y - \\hat{y})$ is a correction term that uses the output estimation error to drive the state estimate towards the true state. The control law is then implemented using the estimated state: $u(t) = -K\\hat{x}(t)$.\n\nThe dynamics of the estimation error, defined as $e(t) = x(t) - \\hat{x}(t)$, are found by subtracting the observer equation from the system state equation:\n$$\n\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = (Ax + bu) - (A\\hat{x} + bu + L(y - \\hat{y}))\n$$\nSubstituting $y=cx$ and $\\hat{y}=c\\hat{x}$:\n$$\n\\dot{e}(t) = A(x-\\hat{x}) - L(cx-c\\hat{x}) = A e(t) - Lc\\,e(t) = (A-Lc)e(t).\n$$\nThe estimation error dynamics are autonomous, evolving according to $\\dot{e}(t) = (A-Lc)e(t)$. For the estimate $\\hat{x}(t)$ to converge to $x(t)$, the error $e(t)$ must converge to zero. This requires the matrix $A-Lc$ to be Hurwitz (all its eigenvalues must have negative real parts). The poles of the observer (the eigenvalues of $A-Lc$) can be arbitrarily placed by choosing $L$ if and only if the system pair $(A,c)$ is observable.\n\nThe structure of the complete closed-loop system, comprising the plant, the observer, and the feedback law, demonstrates the **separation principle**. The state dynamics become $\\dot{x} = Ax + b(-K\\hat{x}) = Ax - bK(x-e) = (A-bK)x + bKe$. The combined dynamics of the state and the error are:\n$$\n\\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{pmatrix} = \\begin{pmatrix} A-bK & bK \\\\ 0 & A-Lc \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}.\n$$\nBecause the system matrix is block upper-triangular, its eigenvalues are the union of the eigenvalues of the diagonal blocks. Therefore, the set of $2n$ closed-loop poles of the combined controller-observer system is the union of:\n1.  The $n$ eigenvalues of the state-feedback controller, determined by $\\det(sI-(A-bK))=0$.\n2.  The $n$ eigenvalues of the observer, determined by $\\det(sI-(A-Lc))=0$.\n\nThis separation allows the controller gain $K$ and the observer gain $L$ to be designed independently. The controller poles (eigenvalues of $A-bK$) are chosen to meet performance specifications, while the observer poles (eigenvalues of $A-Lc$) are typically chosen to be faster (e.g., $2$ to $5$ times) than the controller poles to ensure the estimation error converges quickly.\n\n**Task 4: Numerical Sensitivity and Mitigation**\n\nThe expression $K = \\begin{pmatrix} 0 & \\dots & 1 \\end{pmatrix} \\mathcal{C}^{-1} \\varphi_d(A)$, while elegant, is known to be numerically sensitive, particularly for high-order systems ($n \\gg 1$). The two primary sources of numerical instability are:\n\n1.  **Ill-Conditioning of the Controllability Matrix $\\mathcal{C}$**: The columns of $\\mathcal{C}$ are $A^i b$. If the matrix $A$ has eigenvalues with magnitudes far from $1$, the norms of the column vectors $A^i b$ can grow or decay exponentially with $i$. This can make the columns of $\\mathcal{C}$ nearly linearly dependent, causing $\\mathcal{C}$ to be ill-conditioned (i.e., have a large condition number). The numerical inversion of such a matrix is highly unstable and will amplify any small errors in the system data or from floating-point arithmetic, leading to a highly inaccurate gain $K$.\n\n2.  **Computation of the Matrix Polynomial $\\varphi_d(A)$**: Calculating $\\varphi_d(A) = \\sum_{i=0}^n \\alpha_i A^i$ requires computing matrix powers up to $A^n$. This can be numerically unstable and prone to large floating-point errors, particularly if $A$ has large entries or a large norm. The combination of an ill-conditioned $\\mathcal{C}^{-1}$ and a large-norm $\\varphi_d(A)$ can result in catastrophic error amplification.\n\nTo address these numerical issues, more robust algorithms are used in practice. Two principled mitigation strategies are:\n\n1.  **Orthogonal Transformation Methods**: Instead of explicitly forming and inverting $\\mathcal{C}$, robust pole placement algorithms use a series of numerically stable orthogonal transformations (e.g., using Householder reflections or Givens rotations, as in QR decomposition). For example, the staircase algorithm (or methods by Petkov, Christov, and Konstantinov) transforms the pair $(A,b)$ into a \"staircase\" form, which is a generalization of the CCF, using orthogonal matrices. Pole placement is then performed on this better-conditioned form. Since orthogonal transformations preserve Euclidean norms and condition numbers, these methods avoid the instabilities associated with non-orthogonal transformations and explicit matrix inversion. MATLAB's `place` command is based on such a robust algorithm.\n\n2.  **Transformation to a Balanced Realization**: Another strategy is to first transform the system to a basis where the state variables are \"equally\" controllable and observable. This is achieved through a state transformation to a balanced realization, where the controllability and observability Gramians are equal and diagonal. Pole placement performed on this balanced system is often much better conditioned. Although the balancing transformation itself can be computationally intensive, it often results in matrices with better numerical properties, leading to a more reliable gain calculation. The resulting gain is then transformed back to the original state basis. This method improves the conditioning of the underlying problem representation before the pole placement algorithm is applied.", "answer": "$$\n\\boxed{\\begin{pmatrix} 23 & 48 & 32 & 6 \\end{pmatrix}}\n$$", "id": "2693684"}, {"introduction": "In most practical scenarios, measuring the full state vector is impossible or prohibitively expensive, making state estimation a necessity. This practice focuses on the design of a Luenberger observer, the second key component in an output-feedback control structure. Leveraging the powerful concept of duality, you will see that designing an observer gain $L$ to control the estimation error dynamics is mathematically equivalent to designing a state-feedback controller for a related \"dual\" system, reinforcing the symmetry inherent in linear systems theory [@problem_id:2693676].", "problem": "Consider the linear time-invariant system with state-space realization given by\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\nwhere\n$$A = \\begin{pmatrix}\n0 & 0 & -4 \\\\\n1 & 0 & -3 \\\\\n0 & 1 & -2\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n1 & 0 & 0\n\\end{pmatrix}.$$\nAssume an observer-based output-feedback implementation\n$$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - C \\hat{x}(t)\\big), \\quad u(t) = -K \\hat{x}(t),$$\nwhere $L \\in \\mathbb{R}^{3 \\times 1}$ is the observer gain and $K \\in \\mathbb{R}^{1 \\times 3}$ is a state-feedback gain. You may use the fact (separation principle) that if the pair $(A,B)$ is controllable and the pair $(A,C)$ is observable, then the closed-loop poles under this dynamic output feedback are the union of the eigenvalues of $A - B K$ and $A - L C$, and that these two sets can be assigned independently.\n\nThe pair $(A,C)$ is observable. Using the duality between controllability and observability along with first principles of characteristic polynomial assignment (without invoking any unproven shortcuts), construct an observer gain $L$ so that the observer error dynamics matrix $A - L C$ has eigenvalues at $-1$, $-2$, and $-3$. Provide your final answer as the exact components of $L$.\n\nYour answer must be a calculation. Express your final answer as a single row vector containing the entries of $L$ in exact form. No rounding is required and no units are involved.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens\nThe state-space representation of a linear time-invariant system is given by:\nSystem dynamics: $\\dot{x}(t) = A x(t) + B u(t)$, $y(t) = C x(t)$\nSystem matrices:\n$A = \\begin{pmatrix}\n0 & 0 & -4 \\\\\n1 & 0 & -3 \\\\\n0 & 1 & -2\n\\end{pmatrix}$, $B = \\begin{pmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{pmatrix}$, $C = \\begin{pmatrix}\n1 & 0 & 0\n\\end{pmatrix}$.\nObserver-based output-feedback controller:\n$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))$\n$u(t) = -K \\hat{x}(t)$\n$L \\in \\mathbb{R}^{3 \\times 1}$ is the observer gain. $K \\in \\mathbb{R}^{1 \\times 3}$ is the state-feedback gain.\nThe separation principle is given as a fact, stating that closed-loop poles are the union of eigenvalues of $A-BK$ and $A-LC$.\nThe pair $(A,C)$ is stated to be observable.\nThe objective is to find the observer gain $L$ such that the observer error dynamics matrix, $A-LC$, has eigenvalues at $\\{-1, -2, -3\\}$.\nThe method must use the principle of duality and characteristic polynomial assignment from first principles.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It is a standard pole placement problem for a Luenberger observer, a fundamental topic in control theory. All concepts, variables, and mathematical structures are well-established. The problem is well-posed. The condition that $(A,C)$ is observable guarantees that the poles of the observer error dynamics can be arbitrarily placed, ensuring a unique solution for $L$ exists for the given desired eigenvalues. The problem is objective and expressed in precise mathematical language. The data is complete and consistent; all required matrices and target eigenvalues are provided. The values are numerically sound and do not present any physical or mathematical contradictions. The problem requires a standard, verifiable calculation.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe task is to design an observer gain vector $L$ such that the eigenvalues of the observer error dynamics matrix, $A-LC$, are located at $\\{-1, -2, -3\\}$. The problem notes the duality between observability and controllability. The pole placement problem for an observer for the pair $(A,C)$ is dual to the pole placement problem for a state-feedback controller for the pair $(A^T, C^T)$. The eigenvalues of $A-LC$ are identical to the eigenvalues of its transpose, $(A-LC)^T = A^T - C^T L^T$. Finding the gain $L$ for the observer is therefore equivalent to finding the controller gain $K_d = L^T$ for the dual system $(A^T, C^T)$.\n\nHowever, we are required to solve this using first principles of characteristic polynomial assignment. This method involves directly computing the characteristic polynomial of the matrix $A-LC$ and comparing it to the desired characteristic polynomial. This procedure is fundamental and applies to both the primal observer problem and the dual controller problem. We shall proceed by directly computing the characteristic polynomial of $A-LC$.\n\nLet the observer gain vector be $L = \\begin{pmatrix} l_1 \\\\ l_2 \\\\ l_3 \\end{pmatrix}$.\nThe matrix product $LC$ is:\n$$LC = \\begin{pmatrix} l_1 \\\\ l_2 \\\\ l_3 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} l_1 & 0 & 0 \\\\ l_2 & 0 & 0 \\\\ l_3 & 0 & 0 \\end{pmatrix}$$\nThe observer error dynamics matrix, $A-LC$, is then:\n$$A-LC = \\begin{pmatrix} 0 & 0 & -4 \\\\ 1 & 0 & -3 \\\\ 0 & 1 & -2 \\end{pmatrix} - \\begin{pmatrix} l_1 & 0 & 0 \\\\ l_2 & 0 & 0 \\\\ l_3 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} -l_1 & 0 & -4 \\\\ 1-l_2 & 0 & -3 \\\\ -l_3 & 1 & -2 \\end{pmatrix}$$\nThe characteristic polynomial of $A-LC$, denoted by $p_{actual}(\\lambda)$, is given by the determinant of $\\lambda I - (A-LC)$:\n$$p_{actual}(\\lambda) = \\det(\\lambda I - (A-LC)) = \\det \\begin{pmatrix} \\lambda - (-l_1) & -0 & -(-4) \\\\ -(1-l_2) & \\lambda-0 & -(-3) \\\\ -(-l_3) & -1 & \\lambda-(-2) \\end{pmatrix} = \\det \\begin{pmatrix} \\lambda+l_1 & 0 & 4 \\\\ l_2-1 & \\lambda & 3 \\\\ l_3 & -1 & \\lambda+2 \\end{pmatrix}$$\nWe compute the determinant by cofactor expansion along the first row:\n$$p_{actual}(\\lambda) = (\\lambda+l_1) \\det \\begin{pmatrix} \\lambda & 3 \\\\ -1 & \\lambda+2 \\end{pmatrix} - 0 \\cdot \\det(\\dots) + 4 \\det \\begin{pmatrix} l_2-1 & \\lambda \\\\ l_3 & -1 \\end{pmatrix}$$\n$$p_{actual}(\\lambda) = (\\lambda+l_1)[\\lambda(\\lambda+2) - (3)(-1)] + 4[(l_2-1)(-1) - \\lambda l_3]$$\n$$p_{actual}(\\lambda) = (\\lambda+l_1)(\\lambda^2+2\\lambda+3) + 4(-l_2+1-\\lambda l_3)$$\n$$p_{actual}(\\lambda) = (\\lambda^3+2\\lambda^2+3\\lambda) + (l_1\\lambda^2+2l_1\\lambda+3l_1) + (4-4l_2-4\\lambda l_3)$$\nCollecting terms by powers of $\\lambda$:\n$$p_{actual}(\\lambda) = \\lambda^3 + (l_1+2)\\lambda^2 + (2l_1 - 4l_3 + 3)\\lambda + (3l_1 - 4l_2 + 4)$$\nThe desired eigenvalues are $\\{-1, -2, -3\\}$. The desired characteristic polynomial, $p_{des}(\\lambda)$, is the product of the corresponding factors:\n$$p_{des}(\\lambda) = (\\lambda - (-1))(\\lambda - (-2))(\\lambda - (-3)) = (\\lambda+1)(\\lambda+2)(\\lambda+3)$$\n$$p_{des}(\\lambda) = (\\lambda^2 + 3\\lambda + 2)(\\lambda+3) = \\lambda^3 + 3\\lambda^2 + 2\\lambda + 3\\lambda^2 + 9\\lambda + 6$$\n$$p_{des}(\\lambda) = \\lambda^3 + 6\\lambda^2 + 11\\lambda + 6$$\nTo achieve the desired pole placement, the actual characteristic polynomial must be identical to the desired one. We equate the coefficients of like powers of $\\lambda$ from $p_{actual}(\\lambda)$ and $p_{des}(\\lambda)$:\nComparing $p_{actual}(\\lambda) = \\lambda^3 + (l_1+2)\\lambda^2 + (2l_1 - 4l_3 + 3)\\lambda + (3l_1 - 4l_2 + 4)$ and $p_{des}(\\lambda) = \\lambda^3 + 6\\lambda^2 + 11\\lambda + 6$, we obtain a system of linear equations for $l_1$, $l_2$, and $l_3$.\n\n1.  Coefficient of $\\lambda^2$:\n    $$l_1+2 = 6 \\implies l_1 = 4$$\n2.  Coefficient of $\\lambda^1$:\n    $$2l_1 - 4l_3 + 3 = 11$$\n    Substituting $l_1=4$:\n    $$2(4) - 4l_3 + 3 = 11$$\n    $$8 - 4l_3 + 3 = 11$$\n    $$11 - 4l_3 = 11$$\n    $$-4l_3 = 0 \\implies l_3 = 0$$\n3.  Coefficient of $\\lambda^0$ (constant term):\n    $$3l_1 - 4l_2 + 4 = 6$$\n    Substituting $l_1=4$:\n    $$3(4) - 4l_2 + 4 = 6$$\n    $$12 - 4l_2 + 4 = 6$$\n    $$16 - 4l_2 = 6$$\n    $$-4l_2 = 6 - 16 = -10$$\n    $$l_2 = \\frac{-10}{-4} = \\frac{5}{2}$$\nThus, the components of the observer gain vector are $l_1=4$, $l_2=\\frac{5}{2}$, and $l_3=0$.\nThe observer gain is $L = \\begin{pmatrix} 4 \\\\ \\frac{5}{2} \\\\ 0 \\end{pmatrix}$. The final answer is requested as a row vector.", "answer": "$$\\boxed{\\begin{pmatrix} 4 & \\frac{5}{2} & 0 \\end{pmatrix}}$$", "id": "2693676"}, {"introduction": "Having learned to independently place controller and observer poles, a crucial question arises: are there fundamental limitations to what feedback can achieve? This exercise explores the concept of invariant zeros, which are intrinsic properties of a plant that cannot be altered by feedback. Understanding and identifying these zeros is critical, as attempting to place a closed-loop pole at the location of an unstable zero results in a hidden, internal instability, a catastrophic flaw that must be avoided in any robust control design [@problem_id:2693652].", "problem": "Consider the single-input single-output linear time-invariant plant given by the minimal state-space realization\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),\n$$\nwith\n$$\nA = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}, \\quad D = 0.\n$$\nAll matrices are real and time-invariant. You are to use fundamental definitions from linear systems theory, including controllability, observability, invariant zeros via the Rosenbrock system matrix, and the observer-based output feedback structure grounded in the separation principle.\n\nTasks:\n1) Verify that the realization is minimal by checking that the pair $\\left(A,B\\right)$ is controllable and the pair $\\left(A,C\\right)$ is observable.\n\n2) Using the definition of invariant zeros as the complex values $s \\in \\mathbb{C}$ for which the Rosenbrock system matrix\n$$\n\\mathcal{R}(s) \\triangleq \\begin{bmatrix} s I - A & -B \\\\ C & 0 \\end{bmatrix}\n$$\nloses rank, compute the invariant zero(s) of the plant.\n\n3) Consider an observer-based output feedback controller constructed by combining a full state-feedback law and a full-order Luenberger observer, where the controller gains are chosen such that the eigenvalues of $A - B K$ are at $\\{-2,-4\\}$ and the eigenvalues of $A - L C$ are at $\\{-5,-6\\}$. Using the separation principle and the definition of internal stability for the closed-loop interconnection, explain how the invariant zero(s) of the plant constrain achievable closed-loop pole locations, specifically addressing the prohibition of unstable pole-zero cancellations.\n\nFinal deliverable:\nCompute the minimum absolute spectral separation between the invariant zero(s) found in Task 2 and the set of closed-loop poles $\\{-2,-4,-5,-6\\}$ arising from the combined observer-based design in Task 3. Express the final value as an exact real number (no rounding).", "solution": "The problem statement is parsed and validated. All givens are extracted verbatim: the state-space representation $\\dot{x}(t) = A x(t) + B u(t)$, $y(t) = C x(t)$ with matrices $A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, $C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$, and $D = 0$. The tasks involve verifying minimality, computing invariant zeros via the Rosenbrock system matrix $\\mathcal{R}(s)$, and analyzing an observer-based controller with specified closed-loop poles at $\\{-2, -4, -5, -6\\}$. The problem is scientifically grounded in established linear control theory, is well-posed, objective, and self-contained. It contains no logical contradictions, vague terminology, or factual inaccuracies. The problem is therefore deemed valid and a solution will be provided.\n\nThe solution proceeds by sequentially addressing the three tasks.\n\nTask 1: Verification of Minimality.\nA linear time-invariant system realization is minimal if and only if it is both controllable and observable.\n\nFirst, we assess the controllability of the pair $(A, B)$. The system is controllable if the controllability matrix $\\mathcal{C}$ has full rank, which for a second-order system is rank $2$. The controllability matrix is defined as $\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix}$.\n\nGiven $A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$ and $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, we compute the product $AB$:\n$$\nAB = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\end{bmatrix}.\n$$\nThe controllability matrix $\\mathcal{C}$ is then:\n$$\n\\mathcal{C} = \\begin{bmatrix} 0 & 1 \\\\ 1 & -3 \\end{bmatrix}.\n$$\nTo check for full rank, we compute the determinant of $\\mathcal{C}$:\n$$\n\\det(\\mathcal{C}) = (0)(-3) - (1)(1) = -1.\n$$\nSince $\\det(\\mathcal{C}) \\neq 0$, the matrix $\\mathcal{C}$ has rank $2$. Therefore, the pair $(A, B)$ is controllable.\n\nNext, we assess the observability of the pair $(A, C)$. The system is observable if the observability matrix $\\mathcal{O}$ has full rank $2$. The observability matrix is defined as $\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}$.\n\nGiven $C = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$, we compute the product $CA$:\n$$\nCA = \\begin{bmatrix} 1 & -1 \\end{bmatrix} \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} = \\begin{bmatrix} (1)(0) + (-1)(-2) & (1)(1) + (-1)(-3) \\end{bmatrix} = \\begin{bmatrix} 2 & 4 \\end{bmatrix}.\n$$\nThe observability matrix $\\mathcal{O}$ is then:\n$$\n\\mathcal{O} = \\begin{bmatrix} 1 & -1 \\\\ 2 & 4 \\end{bmatrix}.\n$$\nTo check for full rank, we compute the determinant of $\\mathcal{O}$:\n$$\n\\det(\\mathcal{O}) = (1)(4) - (-1)(2) = 4 + 2 = 6.\n$$\nSince $\\det(\\mathcal{O}) \\neq 0$, the matrix $\\mathcal{O}$ has rank $2$. Therefore, the pair $(A, C)$ is observable.\nBecause the system is both controllable and observable, the state-space realization is minimal.\n\nTask 2: Computation of Invariant Zeros.\nThe invariant zeros are the complex numbers $s \\in \\mathbb{C}$ for which the Rosenbrock system matrix $\\mathcal{R}(s)$ loses rank. For a single-input single-output (SISO) system, this corresponds to the values of $s$ for which $\\det(\\mathcal{R}(s)) = 0$. The matrix is defined as:\n$$\n\\mathcal{R}(s) = \\begin{bmatrix} sI - A & -B \\\\ C & D \\end{bmatrix}.\n$$\nSubstituting the given matrices with $D=0$, we have:\n$$\nsI - A = s \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} = \\begin{bmatrix} s & -1 \\\\ 2 & s+3 \\end{bmatrix}.\n$$\nThus, the Rosenbrock matrix is:\n$$\n\\mathcal{R}(s) = \\begin{bmatrix} s & -1 & 0 \\\\ 2 & s+3 & -1 \\\\ 1 & -1 & 0 \\end{bmatrix}.\n$$\nWe compute the determinant of this $3 \\times 3$ matrix, for instance, by cofactor expansion along the third column:\n$$\n\\det(\\mathcal{R}(s)) = (0) \\cdot \\det\\begin{pmatrix} 2 & s+3 \\\\ 1 & -1 \\end{pmatrix} - (-1) \\cdot \\det\\begin{pmatrix} s & -1 \\\\ 1 & -1 \\end{pmatrix} + (0) \\cdot \\det\\begin{pmatrix} s & -1 \\\\ 2 & s+3 \\end{pmatrix}.\n$$\n$$\n\\det(\\mathcal{R}(s)) = (1) \\cdot \\big( s(-1) - (-1)(1) \\big) = -s + 1.\n$$\nThe invariant zeros are the roots of $\\det(\\mathcal{R}(s)) = 0$:\n$$\n-s + 1 = 0 \\implies s = 1.\n$$\nThe system has a single invariant zero at $z=1$.\n\nTask 3: Analysis of the Observer-Based Controller and Final Calculation.\nAn observer-based output feedback controller for the plant $\\dot{x} = Ax + Bu, y = Cx$ consists of a full-order Luenberger observer $\\dot{\\hat{x}} = A\\hat{x} + Bu + L(y - C\\hat{x})$ and a state-feedback control law using the estimated state, $u = -K\\hat{x}$. The dynamics of the estimation error $e(t) = x(t) - \\hat{x}(t)$ are given by $\\dot{e} = (A - LC)e$. The dynamics of the plant state under feedback are $\\dot{x} = Ax + B(-K\\hat{x}) = Ax - BK(x-e) = (A-BK)x + BKe$. The composite closed-loop system dynamics for the state vector $[x^T, e^T]^T$ are:\n$$\n\\frac{d}{dt} \\begin{bmatrix} x \\\\ e \\end{bmatrix} = \\begin{bmatrix} A-BK & BK \\\\ 0 & A-LC \\end{bmatrix} \\begin{bmatrix} x \\\\ e \\end{bmatrix}.\n$$\nThe eigenvalues of this block upper-triangular matrix are the union of the eigenvalues of the diagonal blocks. This is the separation principle: the closed-loop poles are the set of eigenvalues of $A-BK$ (controller poles) and the set of eigenvalues of $A-LC$ (observer poles). The problem specifies these sets to be $\\sigma(A-BK) = \\{-2, -4\\}$ and $\\sigma(A-LC) = \\{-5, -6\\}$. Thus, the complete set of closed-loop poles is $\\{-2, -4, -5, -6\\}$.\n\nInvariant zeros are a fundamental property of the plant and cannot be altered by feedback. For a minimal system, the invariant zeros are identical to the zeros of the plant's transfer function $G(s) = C(sI-A)^{-1}B$. An attempt to place a closed-loop pole at the location of a plant zero results in a pole-zero cancellation. If the zero is unstable (i.e., has a non-negative real part), this cancellation renders the closed-loop system internally unstable, even if the overall input-output transfer function might appear stable. The internal instability arises from either an unobservable mode (if the pole is from $A-BK$) or an uncontrollable mode (if the pole is from $A-LC$) at the zero location.\nThe invariant zero we computed is $z=1$, which lies in the right half-plane, $\\Re(z) > 0$. This is an unstable zero. Therefore, a stable closed-loop system design must not place any poles at $s=1$. The specified design with poles at $\\{-2, -4, -5, -6\\}$ respects this fundamental constraint, as all poles are in the left half-plane and are distinct from the zero.\n\nFinally, we compute the minimum absolute spectral separation between the invariant zero and the set of closed-loop poles. The invariant zero is $z = 1$. The set of closed-loop poles is $P = \\{-2, -4, -5, -6\\}$. We must find $\\min_{p \\in P} |z - p|$.\nThe individual separations are:\n$$\n|1 - (-2)| = |1 + 2| = 3.\n$$\n$$\n|1 - (-4)| = |1 + 4| = 5.\n$$\n$$\n|1 - (-5)| = |1 + 5| = 6.\n$$\n$$\n|1 - (-6)| = |1 + 6| = 7.\n$$\nThe minimum value among $\\{3, 5, 6, 7\\}$ is $3$.", "answer": "$$\\boxed{3}$$", "id": "2693652"}]}