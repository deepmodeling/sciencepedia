{"hands_on_practices": [{"introduction": "This foundational practice explores the core mechanism of state feedback using the most direct approach: manipulating the characteristic polynomial. By deriving the closed-loop characteristic equation in terms of the feedback gain $K$, you will use coefficient matching to place the system's poles at desired locations. This exercise [@problem_id:2732424] provides a concrete understanding of how state feedback directly reshapes system dynamics and highlights the fundamental prerequisite of controllability for arbitrary pole placement.", "problem": "Consider the single-input linear time-invariant (LTI) state-space system with state feedback of the form $u = K x$, where $K \\in \\mathbb{R}^{1 \\times 3}$ is constrained to be real-valued:\n$$\n\\dot{x} = A x + B u, \\quad\nA = \\begin{bmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-3 & -4 & -5\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{bmatrix}.\n$$\nYou must reason from the definitions of controllability, eigenvalues, and characteristic polynomials, and the properties of real polynomials, without invoking any prepackaged pole-placement formula.\n\nTasks:\n- Using the definition of the controllability matrix and its rank, justify whether the pair $(A,B)$ is controllable. Then, using only the facts that $(i)$ the closed-loop matrix with state feedback $u = K x$ is $A + B K$, $(ii)$ the characteristic polynomial of a real matrix has real coefficients if all entries are real, and $(iii)$ for any polynomial with real coefficients, nonreal roots occur in complex-conjugate pairs, explain why it is meaningful to seek a real $K$ that assigns a closed-loop complex-conjugate pole pair together with a real pole.\n- For the desired closed-loop eigenvalues at $s = -3$ and $s = -1 \\pm 2i$, determine the unique real feedback row vector $K = \\begin{bmatrix} k_{1} & k_{2} & k_{3} \\end{bmatrix}$ that exactly places the closed-loop poles at these locations by direct computation from the characteristic equation of $A + B K$ and coefficient matching.\n\nAnswer specification:\n- Provide your final answer as the single row vector $K$.\n- No rounding is required; report exact values with no units.", "solution": "We are given the single-input linear time-invariant (LTI) system\n$$\n\\dot{x} = A x + B u, \\quad A \\in \\mathbb{R}^{3 \\times 3}, \\; B \\in \\mathbb{R}^{3 \\times 1}, \\quad u = K x, \\; K \\in \\mathbb{R}^{1 \\times 3}.\n$$\nUnder state feedback $u = K x$, the closed-loop state matrix is $A_{\\mathrm{cl}} = A + B K$. The closed-loop eigenvalues are the roots of the characteristic polynomial $\\chi_{A_{\\mathrm{cl}}}(s) = \\det(s I - A_{\\mathrm{cl}})$.\n\nStep $1$: Controllability of $(A,B)$.\nBy definition, the controllability matrix is\n$$\n\\mathcal{C} = \\begin{bmatrix} B & A B & A^{2} B \\end{bmatrix}.\n$$\nCompute $A B$ and $A^{2} B$:\n$$\nB = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}, \\quad\nA B = \\begin{bmatrix} 0 \\\\ 1 \\\\ -5 \\end{bmatrix}, \\quad\nA^{2} B = A (A B) = A \\begin{bmatrix} 0 \\\\ 1 \\\\ -5 \\end{bmatrix}\n= \\begin{bmatrix} 1 \\\\ -5 \\\\ 21 \\end{bmatrix}.\n$$\nThus\n$$\n\\mathcal{C} = \\begin{bmatrix}\n0 & 0 & 1 \\\\\n0 & 1 & -5 \\\\\n1 & -5 & 21\n\\end{bmatrix}.\n$$\nIts determinant is\n$$\n\\det(\\mathcal{C}) = 0 \\cdot \\det \\begin{bmatrix} 1 & -5 \\\\ -5 & 21 \\end{bmatrix}\n- 0 \\cdot \\det \\begin{bmatrix} 0 & -5 \\\\ 1 & 21 \\end{bmatrix}\n+ 1 \\cdot \\det \\begin{bmatrix} 0 & 1 \\\\ 1 & -5 \\end{bmatrix}\n= (0) - (0) + (0 \\cdot (-5) - 1 \\cdot 1) = -1 \\neq 0.\n$$\nTherefore $\\operatorname{rank}(\\mathcal{C}) = 3$, and the pair $(A,B)$ is controllable.\n\nStep $2$: Why real feedback $K$ can assign complex-conjugate poles.\nFor real $K$, the entries of $A_{\\mathrm{cl}} = A + B K$ are real, hence its characteristic polynomial $\\chi_{A_{\\mathrm{cl}}}(s)$ has real coefficients. A well-known property of polynomials with real coefficients is that any nonreal root $z \\in \\mathbb{C} \\setminus \\mathbb{R}$ implies $\\overline{z}$ is also a root. Consequently, a real state-feedback $K$ can only produce complex-conjugate pairs of eigenvalues. Because $(A,B)$ is controllable, the set of achievable closed-loop characteristic polynomials contains all monic cubic polynomials with real coefficients; thus it is meaningful and feasible to assign one real pole together with one complex-conjugate pair using a real $K$.\n\nStep $3$: Compute $\\chi_{A + B K}(s)$ and match coefficients.\nLet $K = \\begin{bmatrix} k_{1} & k_{2} & k_{3} \\end{bmatrix}$. Then\n$$\nA + B K = \\begin{bmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-3 & -4 & -5\n\\end{bmatrix} + \n\\begin{bmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{bmatrix}\n\\begin{bmatrix}\nk_{1} & k_{2} & k_{3}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-3 + k_{1} & -4 + k_{2} & -5 + k_{3}\n\\end{bmatrix}.\n$$\nForm $s I - (A + B K)$:\n$$\ns I - (A + B K) =\n\\begin{bmatrix}\ns & 0 & 0 \\\\\n0 & s & 0 \\\\\n0 & 0 & s\n\\end{bmatrix} -\n\\begin{bmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-3 + k_{1} & -4 + k_{2} & -5 + k_{3}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\ns & -1 & 0 \\\\\n0 & s & -1 \\\\\n3 - k_{1} & 4 - k_{2} & s + 5 - k_{3}\n\\end{bmatrix}.\n$$\nCompute the determinant by expansion along the first row:\n$$\n\\chi_{A + B K}(s) = \\det\\!\\begin{bmatrix}\ns & -1 & 0 \\\\\n0 & s & -1 \\\\\n3 - k_{1} & 4 - k_{2} & s + 5 - k_{3}\n\\end{bmatrix}\n= s \\cdot \\det \\begin{bmatrix} s & -1 \\\\ 4 - k_{2} & s + 5 - k_{3} \\end{bmatrix}\n+ 1 \\cdot \\det \\begin{bmatrix} 0 & -1 \\\\ 3 - k_{1} & s + 5 - k_{3} \\end{bmatrix}.\n$$\nThe two $2 \\times 2$ determinants are\n$$\n\\det \\begin{bmatrix} s & -1 \\\\ 4 - k_{2} & s + 5 - k_{3} \\end{bmatrix}\n= s (s + 5 - k_{3}) - (-1)(4 - k_{2}) = s(s + 5 - k_{3}) + (4 - k_{2}),\n$$\n$$\n\\det \\begin{bmatrix} 0 & -1 \\\\ 3 - k_{1} & s + 5 - k_{3} \\end{bmatrix}\n= 0 \\cdot (s + 5 - k_{3}) - (-1)(3 - k_{1}) = 3 - k_{1}.\n$$\nHence\n$$\n\\chi_{A + B K}(s) = s \\big( s(s + 5 - k_{3}) + (4 - k_{2}) \\big) + (3 - k_{1})\n= s^{3} + (5 - k_{3}) s^{2} + (4 - k_{2}) s + (3 - k_{1}).\n$$\n\nStep $4$: Impose the desired eigenvalues and solve for $K$.\nThe desired closed-loop eigenvalues are $s = -3$ and $s = -1 \\pm 2i$. The corresponding monic cubic with real coefficients is\n$$\n(s + 3)\\big( (s + 1)^{2} + 4 \\big) = (s + 3)(s^{2} + 2 s + 5) = s^{3} + 5 s^{2} + 11 s + 15.\n$$\nEquating coefficients with $\\chi_{A + B K}(s)$ yields\n$$\n5 - k_{3} = 5, \\quad 4 - k_{2} = 11, \\quad 3 - k_{1} = 15.\n$$\nSolving gives\n$$\nk_{3} = 0, \\quad k_{2} = -7, \\quad k_{1} = -12.\n$$\nTherefore, the unique real state-feedback row vector that assigns the specified poles is\n$$\nK = \\begin{bmatrix} -12 & -7 & 0 \\end{bmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-12 & -7 & 0\\end{pmatrix}}$$", "id": "2732424"}, {"introduction": "This exercise serves as a critical case study on the distinction between input-output stability and the much stronger condition of internal stability. You will analyze a design that employs pole-zero cancellation, a common technique in transfer function-based methods, to eliminate an unstable plant pole from the closed-loop transfer function. Through this analysis [@problem_id:2732455], you will discover why such a cancellation, while algebraically tempting, results in a system with a hidden unstable mode, underscoring the vital importance of ensuring the stability of all internal system dynamics.", "problem": "Consider a single-input single-output, linear time-invariant plant with strictly proper transfer function\n$$G(s) = \\frac{s+1}{(s-2)(s+3)}.$$\nA designer proposes a strictly proper, rational output-feedback controller\n$$C(s) = k\\,\\frac{s-2}{s+a}, \\quad a>0,$$\nin unity feedback interconnection with the plant, with the explicit intent to cancel the plant’s unstable pole at $s=2$ in the closed-loop input-output map. The reference signal is $r$, the control input is $u$, and the output is $y$. The interconnection is the standard unity feedback configuration, where the error is $e = r - y$ and $u = C(s)e$.\n\nStarting only from the fundamental algebra of linear time-invariant block diagrams and the definition of internal stability (all internal signals remain bounded for every bounded input and every finite-energy initial condition of all internal states), answer the following.\n\n1) Derive the closed-loop transfer function $T(s) = \\dfrac{Y(s)}{R(s)}$ from the unity feedback interconnection of $G(s)$ and $C(s)$.\n\n2) Impose the external pole-placement objective that the closed-loop transfer function $T(s)$ has exactly the two poles at $s=-4$ and $s=-6$. Under the exact pole-zero cancellation of the plant pole at $s=2$ by the controller zero at $s=2$, determine the unique real values of $a$ and $k$ that achieve this objective.\n\n3) Using the concept of internal stability, argue whether the overall interconnection is internally stable or not under this design, and identify the location of any unstable internal mode that remains after the cancellation in the input-output map.\n\nProvide as your final result the exact value of $k$ (no rounding). Do not include any units.", "solution": "This problem investigates the consequences of canceling an unstable plant pole with a controller zero. We are given the plant transfer function $G(s)$ and the controller transfer function $C(s)$:\n$$G(s) = \\frac{s+1}{(s-2)(s+3)}$$\n$$C(s) = k\\,\\frac{s-2}{s+a}, \\quad a > 0$$\n\n1) Derivation of the closed-loop transfer function $T(s) = \\frac{Y(s)}{R(s)}$.\nFor a standard unity feedback configuration, the closed-loop transfer function from the reference $R(s)$ to the output $Y(s)$ is given by:\n$$T(s) = \\frac{G(s)C(s)}{1 + G(s)C(s)}$$\nFirst, we compute the loop gain $L(s) = G(s)C(s)$:\n$$L(s) = \\left( \\frac{s+1}{(s-2)(s+3)} \\right) \\left( k\\,\\frac{s-2}{s+a} \\right)$$\nThe term $(s-2)$ appears in the numerator of $C(s)$ and the denominator of $G(s)$. This is the intended pole-zero cancellation. Performing this algebraic cancellation yields:\n$$L(s) = \\frac{k(s+1)}{(s+3)(s+a)}$$\nNow, we substitute this into the expression for $T(s)$:\n$$T(s) = \\frac{\\frac{k(s+1)}{(s+3)(s+a)}}{1 + \\frac{k(s+1)}{(s+3)(s+a)}} = \\frac{k(s+1)}{(s+3)(s+a) + k(s+1)}$$\nExpanding the denominator gives the characteristic polynomial of the input-output map:\n$$T(s) = \\frac{k(s+1)}{s^2 + (a+3)s + 3a + ks + k} = \\frac{k(s+1)}{s^2 + (a+k+3)s + (3a+k)}$$\n\n2) Determination of controller parameters $a$ and $k$.\nThe design objective is to place the closed-loop poles of $T(s)$ at $s=-4$ and $s=-6$. The desired characteristic polynomial is therefore:\n$$D_{des}(s) = (s+4)(s+6) = s^2 + 10s + 24$$\nBy comparing the coefficients of the denominator of $T(s)$ with the desired characteristic polynomial $D_{des}(s)$, we obtain a system of two linear equations for the parameters $a$ and $k$:\n1.  Matching the coefficient of $s^1$: $a+k+3 = 10 \\implies a+k = 7$\n2.  Matching the coefficient of $s^0$: $3a+k = 24$\nWe solve this system. Subtracting the first equation from the second gives:\n$$(3a+k) - (a+k) = 24 - 7$$\n$$2a = 17 \\implies a = \\frac{17}{2} = 8.5$$\nThis value satisfies the given constraint $a>0$. Substituting $a = 8.5$ back into the first equation:\n$$8.5 + k = 7 \\implies k = 7 - 8.5 = -1.5$$\nThus, the parameters are $a = \\frac{17}{2}$ and $k = -\\frac{3}{2}$.\n\n3) Analysis of internal stability.\nInternal stability of a feedback system requires that all poles of all possible closed-loop transfer functions between external inputs and internal signals be in the open left-half complex plane. This is equivalent to checking the roots of the overall system characteristic polynomial, which is given by $D_G(s)D_C(s) + N_G(s)N_C(s) = 0$, where $G(s) = \\frac{N_G(s)}{D_G(s)}$ and $C(s) = \\frac{N_C(s)}{D_C(s)}$ are coprime factorizations.\nIn our case:\n$N_G(s) = s+1$, $D_G(s) = (s-2)(s+3) = s^2+s-6$\n$N_C(s) = k(s-2)$, $D_C(s) = s+a$\nThe system characteristic polynomial $D_{cl}(s)$ is:\n$$D_{cl}(s) = D_G(s)D_C(s) + N_G(s)N_C(s)$$\n$$D_{cl}(s) = ((s-2)(s+3))(s+a) + (s+1)(k(s-2))$$\nWe can factor out the common term $(s-2)$:\n$$D_{cl}(s) = (s-2) \\left[ (s+3)(s+a) + k(s+1) \\right]$$\nThe term in the square brackets is precisely the denominator of the input-output transfer function $T(s)$, which we designed to be equal to $(s+4)(s+6)$. Therefore, the complete characteristic polynomial of the internal system is:\n$$D_{cl}(s) = (s-2)(s+4)(s+6)$$\nThe poles of the internal system are the roots of $D_{cl}(s) = 0$, which are $s_1=2$, $s_2=-4$, and $s_3=-6$.\nSince there is a pole at $s=2$, which is in the right-half plane, the closed-loop system is **internally unstable**.\nThe unstable mode at $s=2$ was \"hidden\" in the input-output map $Y(s)/R(s)$ due to the pole-zero cancellation. However, this mode is not eliminated from the system dynamics. It would be excited by initial conditions of the plant state corresponding to this mode, or by disturbances injected at the plant input. This cancellation of an unstable RHP pole with a RHP zero is a fundamentally flawed design practice that results in internal instability. The unstable internal mode is located at $s=2$.\n\nThe problem asks for the exact value of $k$. From our calculation in part 2, $k = -1.5$.", "answer": "$$\n\\boxed{-\\frac{3}{2}}\n$$", "id": "2732455"}, {"introduction": "This advanced problem delves into the structural limitations of pole placement in multi-input systems, a topic of significant theoretical and practical importance. While controllability ensures that eigenvalues can be arbitrarily placed, it does not guarantee that any Jordan structure for a repeated eigenvalue is achievable. This practice [@problem_id:2732374] challenges you to apply the fundamental constraints imposed by the system's controllability indices to determine which closed-loop Jordan forms are realizable, providing a deeper insight into the fine structure of state-feedback design.", "problem": "Consider a linear time-invariant state-space system with state dimension $n$ given by $\\dot{x} = A x + B u$, where $A \\in \\mathbb{R}^{n \\times n}$ and $B \\in \\mathbb{R}^{n \\times m}$. Assume the pair $(A,B)$ is controllable. A static state-feedback law $u = K x$ yields the closed-loop matrix $A_{\\mathrm{cl}} = A + B K$. Let $m \\ge 1$ and let the controllability indices of $(A,B)$ (defined as the lengths of the controllability chains in a Brunovský decomposition) be $\\mu_1 \\ge \\mu_2 \\ge \\cdots \\ge \\mu_m$, with $\\sum_{i=1}^m \\mu_i = n$.\n\nA repeated eigenvalue corresponds to a Jordan structure in the closed loop, encoded by the sizes of its Jordan blocks. The ability to realize a specified Jordan structure at a repeated eigenvalue under state feedback is constrained by the interaction between $B$ and the iterated reachability subspaces generated by $A$.\n\nSuppose $n = 7$, $m = 2$, and the controllability indices are $\\mu_1 = 4$, $\\mu_2 = 3$. You are tasked with placing one repeated eigenvalue $\\lambda \\in \\mathbb{C}$ of algebraic multiplicity $5$ in the closed loop (the remaining $2$ eigenvalues are simple and can be freely chosen away from $\\lambda$). Which of the following Jordan structures for the eigenvalue $\\lambda$ can be realized by some constant state-feedback $K$?\n\nChoose all that apply. Each option lists the sizes of the Jordan blocks associated with $\\lambda$ in $A_{\\mathrm{cl}}$.\n\n- A. $[3,2]$\n- B. $[4,1]$\n- C. $[2,2,1]$\n- D. $[5]$\n- E. $[3,1,1]$", "solution": "The ability to assign a specific Jordan structure to a closed-loop system matrix $A_{\\mathrm{cl}} = A + B K$ is constrained by properties derived from the controllability indices $\\mu_1, \\ldots, \\mu_m$.\n\n**Constraint 1: Geometric Multiplicity**\nThe number of Jordan blocks associated with any eigenvalue $\\lambda$, known as its geometric multiplicity $g_{\\lambda}$, cannot exceed the number of system inputs, $m$. In this problem, $m=2$, so any realizable Jordan structure for the eigenvalue $\\lambda$ can have at most $2$ blocks. This constraint arises from the Popov-Belevitch-Hautus (PBH) test for controllability.\n\n**Constraint 2: Majorization by Controllability Indices**\nA more detailed constraint, established by Rosenbrock's theorem, relates the partition of the state dimension $n$ formed by the sizes of all Jordan blocks of $A_{\\mathrm{cl}}$ to the partition formed by the controllability indices. Let the Jordan block sizes be sorted in descending order as $\\rho = (\\rho_1, \\rho_2, \\ldots)$, and the controllability indices as $\\mu = (\\mu_1, \\ldots, \\mu_m)$. For a structure to be assignable, the partition $\\rho$ must be majorized by $\\mu$. This means:\n$$ \\sum_{i=1}^k \\rho_i \\le \\sum_{i=1}^k \\mu_i \\quad \\text{for all } k \\ge 1 $$\nFor this problem, $\\mu=(4,3)$. The most restrictive condition from this theorem is for $k=1$, which implies that the size of the largest Jordan block in the entire closed-loop system cannot exceed the largest controllability index: $\\rho_1 \\le \\mu_1 = 4$.\n\n**Option-by-Option Analysis**\n\nWe evaluate each option using these two constraints. The total state dimension is $n=7$, and the eigenvalue $\\lambda$ has algebraic multiplicity 5. The remaining 2 eigenvalues are simple, corresponding to two Jordan blocks of size 1.\n\n- **A. [3,2]**\n    - Geometric Multiplicity: The structure for $\\lambda$ has 2 blocks. This satisfies the constraint $g_{\\lambda} \\le m=2$.\n    - Majorization: The full Jordan structure of $A_{\\mathrm{cl}}$ consists of blocks of sizes $(3, 2, 1, 1)$. The sorted partition of $n=7$ is $\\rho = (3,2,1,1)$. The largest block size is $\\rho_1 = 3$. This satisfies $\\rho_1 \\le \\mu_1=4$. The structure is assignable.\n    - Verdict: **Correct**.\n\n- **B. [4,1]**\n    - Geometric Multiplicity: The structure for $\\lambda$ has 2 blocks. This satisfies $g_{\\lambda} \\le m=2$.\n    - Majorization: The full Jordan structure consists of blocks of sizes $(4, 1, 1, 1)$. The sorted partition is $\\rho = (4,1,1,1)$. The largest block size is $\\rho_1 = 4$. This satisfies $\\rho_1 \\le \\mu_1=4$. The structure is assignable.\n    - Verdict: **Correct**.\n\n- **C. [2,2,1]**\n    - Geometric Multiplicity: The structure for $\\lambda$ has 3 blocks. This violates the constraint $g_{\\lambda} \\le m=2$. The structure is not realizable.\n    - Verdict: **Incorrect**.\n\n- **D. [5]**\n    - Geometric Multiplicity: The structure for $\\lambda$ has 1 block. This satisfies $g_{\\lambda} \\le m=2$.\n    - Majorization: The full Jordan structure consists of blocks of sizes $(5, 1, 1)$. The sorted partition is $\\rho = (5,1,1)$. The largest block size is $\\rho_1 = 5$. This violates the constraint $\\rho_1 \\le \\mu_1=4$. The structure is not assignable.\n    - Verdict: **Incorrect**.\n\n- **E. [3,1,1]**\n    - Geometric Multiplicity: The structure for $\\lambda$ has 3 blocks. This violates the constraint $g_{\\lambda} \\le m=2$. The structure is not realizable.\n    - Verdict: **Incorrect**.\n\nBased on the analysis, only options A and B describe realizable Jordan structures.", "answer": "$$\\boxed{AB}$$", "id": "2732374"}]}