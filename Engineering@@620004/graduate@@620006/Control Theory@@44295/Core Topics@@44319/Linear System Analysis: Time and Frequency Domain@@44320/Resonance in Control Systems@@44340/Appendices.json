{"hands_on_practices": [{"introduction": "Understanding resonance begins with quantifying it. This foundational exercise guides you through deriving the key characteristics of resonance in a canonical second-order system from first principles. By applying basic calculus to the system's frequency response, you will determine the precise expressions for the resonant frequency $\\omega_r$ and the peak magnitude $M_r$, providing the essential tools for analyzing any underdamped system. This practice will solidify your understanding of how system parameters like natural frequency $\\omega_n$ and damping ratio $\\zeta$ directly shape its resonant behavior. [@problem_id:2740189]", "problem": "A single-input single-output linear time-invariant second-order closed-loop system has the transfer function\n$$\nT(s) \\;=\\; \\frac{\\omega_n^{2}}{s^{2} + 2 \\zeta \\,\\omega_n\\, s + \\omega_n^{2}},\n$$\nwhere $\\zeta \\in (0,1)$ is the damping ratio and $\\omega_n > 0$ is the natural frequency. The steady-state sinusoidal response magnitude at angular frequency $\\omega$ is given by $|T(j\\omega)|$.\n\nDefine the resonant frequency $\\omega_r$ as the angular frequency that maximizes $|T(j\\omega)|$ and define the resonant peak $M_r$ as $M_r = \\max_{\\omega \\ge 0} |T(j\\omega)|$. The $-3$ dB bandwidth around the resonant peak is defined as $\\Delta \\omega = \\omega_{+} - \\omega_{-}$, where $\\omega_{\\pm}$ are the two frequencies satisfying $|T(j\\omega_{\\pm})| = M_r / \\sqrt{2}$.\n\nStarting from the definitions above and standard calculus on the frequency response, derive $\\omega_r$ and $M_r$ from first principles (without invoking pre-memorized resonance formulas). Then, using a small-damping second-order approximation justified from the local curvature of $|T(j\\omega)|$ near $\\omega_r$, estimate the $-3$ dB bandwidth $\\Delta \\omega$ for small $\\zeta$.\n\nEvaluate your final expressions for the specific parameter values $\\zeta = 0.1$ and $\\omega_n = 10$ and provide numerical values for $\\omega_r$ (in rad/s), $M_r$ (dimensionless), and the estimated $\\Delta \\omega$ (in rad/s). Round your answers to four significant figures. Express angular frequencies in radians per second (rad/s).", "solution": "The problem presented is a standard exercise in the analysis of second-order linear time-invariant systems. It is scientifically grounded, well-posed, objective, and internally consistent. Therefore, a solution will be provided.\n\nThe closed-loop transfer function is given by\n$$\nT(s) = \\frac{\\omega_n^{2}}{s^{2} + 2\\zeta\\omega_n s + \\omega_n^{2}}\n$$\nwhere the damping ratio $\\zeta$ is in the range $(0,1)$ and the natural frequency $\\omega_n > 0$.\n\nTo find the frequency response, we substitute $s = j\\omega$:\n$$\nT(j\\omega) = \\frac{\\omega_n^{2}}{(j\\omega)^{2} + 2\\zeta\\omega_n(j\\omega) + \\omega_n^{2}} = \\frac{\\omega_n^{2}}{(\\omega_n^{2} - \\omega^{2}) + j(2\\zeta\\omega_n\\omega)}\n$$\nThe squared magnitude of the frequency response is\n$$\n|T(j\\omega)|^{2} = \\frac{(\\omega_n^{2})^{2}}{(\\omega_n^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_n\\omega)^{2}}\n$$\nThe resonant frequency $\\omega_r$ is the frequency $\\omega \\ge 0$ that maximizes $|T(j\\omega)|$. This is equivalent to minimizing the denominator, which we denote as $D(\\omega)$:\n$$\nD(\\omega) = (\\omega_n^{2} - \\omega^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2} = \\omega^{4} - 2\\omega_n^{2}\\omega^{2} + \\omega_n^{4} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2} = \\omega^{4} + 2(2\\zeta^{2}-1)\\omega_n^{2}\\omega^{2} + \\omega_n^{4}\n$$\nTo find the minimum of $D(\\omega)$ for $\\omega > 0$, we differentiate with respect to $\\omega$ and set the derivative to zero:\n$$\n\\frac{dD}{d\\omega} = 4\\omega^{3} + 4(2\\zeta^{2}-1)\\omega_n^{2}\\omega = 0\n$$\nSince we are interested in a non-trivial peak for $\\omega > 0$, we can divide by $4\\omega$:\n$$\n\\omega^{2} + (2\\zeta^{2}-1)\\omega_n^{2} = 0 \\quad \\implies \\quad \\omega^{2} = (1-2\\zeta^{2})\\omega_n^{2}\n$$\nA real, positive solution for $\\omega_r$ exists if and only if $1-2\\zeta^{2} > 0$, which means $\\zeta < 1/\\sqrt{2}$. For $\\zeta \\ge 1/\\sqrt{2}$, the derivative is non-negative for all $\\omega \\ge 0$, so the maximum of $|T(j\\omega)|$ occurs at $\\omega=0$. Given $\\zeta=0.1$ for the numerical evaluation, the condition is satisfied.\nThe resonant frequency is therefore:\n$$\n\\omega_r = \\omega_n \\sqrt{1 - 2\\zeta^{2}}\n$$\nThe resonant peak $M_r$ is the value of $|T(j\\omega)|$ at $\\omega=\\omega_r$. We evaluate the magnitude squared $|T(j\\omega_r)|^{2}$ by substituting $\\omega_r^2$ into the expression for $|T(j\\omega)|^2$:\n$$\n|T(j\\omega_r)|^{2} = \\frac{\\omega_n^{4}}{(\\omega_n^{2} - \\omega_r^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega_r^{2}}\n$$\nUsing $\\omega_r^{2} = (1-2\\zeta^{2})\\omega_n^{2}$, we have $\\omega_n^{2} - \\omega_r^{2} = 2\\zeta^{2}\\omega_n^{2}$. Substituting this into the denominator:\n$$\n(\\omega_n^{2} - \\omega_r^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega_r^{2} = (2\\zeta^{2}\\omega_n^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}(\\omega_n^{2}(1-2\\zeta^{2})) \\\\\n= 4\\zeta^{4}\\omega_n^{4} + 4\\zeta^{2}\\omega_n^{4}(1-2\\zeta^{2}) \\\\\n= 4\\zeta^{4}\\omega_n^{4} + 4\\zeta^{2}\\omega_n^{4} - 8\\zeta^{4}\\omega_n^{4} \\\\\n= 4\\zeta^{2}\\omega_n^{4}(1-\\zeta^{2})\n$$\nSo, the squared peak magnitude is:\n$$\nM_r^{2} = |T(j\\omega_r)|^{2} = \\frac{\\omega_n^{4}}{4\\zeta^{2}\\omega_n^{4}(1-\\zeta^{2})} = \\frac{1}{4\\zeta^{2}(1-\\zeta^{2})}\n$$\nThe resonant peak is:\n$$\nM_r = \\frac{1}{2\\zeta\\sqrt{1-\\zeta^{2}}}\n$$\nNext, we find the bandwidth $\\Delta \\omega = \\omega_{+} - \\omega_{-}$. The frequencies $\\omega_{\\pm}$ are defined by the condition $|T(j\\omega_{\\pm})| = M_r/\\sqrt{2}$, which is equivalent to $|T(j\\omega_{\\pm})|^2 = M_r^2/2$.\n$$\n\\frac{\\omega_n^{4}}{(\\omega_n^{2} - \\omega^{2})^{2} + 4\\zeta^{2}\\omega_n^{2}\\omega^{2}} = \\frac{1}{2} \\left(\\frac{1}{4\\zeta^{2}(1-\\zeta^{2})}\\right) = \\frac{1}{8\\zeta^{2}(1-\\zeta^{2})}\n$$\nLet $x = \\omega^2$. The denominator equation becomes:\n$$\n(\\omega_n^{2} - x)^{2} + 4\\zeta^{2}\\omega_n^{2}x = 8\\zeta^{2}(1-\\zeta^{2})\\omega_n^{4}\n$$\nExpanding and rearranging terms yields a quadratic equation in $x$:\n$$\n\\omega_n^{4} - 2\\omega_n^{2}x + x^{2} + 4\\zeta^{2}\\omega_n^{2}x = 8\\zeta^{2}\\omega_n^{4} - 8\\zeta^{4}\\omega_n^{4} \\\\\nx^{2} + (4\\zeta^{2}-2)\\omega_n^{2}x + (\\omega_n^{4} - 8\\zeta^{2}\\omega_n^{4} + 8\\zeta^{4}\\omega_n^{4}) = 0\n$$\nThe solutions $x_{\\pm} = \\omega_{\\pm}^2$ are given by the quadratic formula:\n$$\nx_{\\pm} = \\frac{-(4\\zeta^{2}-2)\\omega_n^{2} \\pm \\sqrt{((4\\zeta^{2}-2)\\omega_n^{2})^{2} - 4(\\omega_n^{4} - 8\\zeta^{2}\\omega_n^{4} + 8\\zeta^{4}\\omega_n^{4})}}{2} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{(4\\zeta^{2}-2)^{2} - 4(1 - 8\\zeta^{2} + 8\\zeta^{4})} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{16\\zeta^{4}-16\\zeta^{2}+4 - 4 + 32\\zeta^{2} - 32\\zeta^{4}} \\\\\n= (1-2\\zeta^{2})\\omega_n^{2} \\pm \\frac{\\omega_n^{2}}{2}\\sqrt{16\\zeta^{2}-16\\zeta^{4}} = (1-2\\zeta^{2})\\omega_n^{2} \\pm 2\\zeta\\omega_n^{2}\\sqrt{1-\\zeta^{2}}\n$$\nThe problem asks for an estimate of $\\Delta \\omega = \\omega_{+} - \\omega_{-}$ for small $\\zeta$. We have $\\omega_{\\pm} = \\sqrt{x_{\\pm}}$.\n$$\n\\omega_{\\pm} = \\omega_n \\sqrt{(1-2\\zeta^{2}) \\pm 2\\zeta\\sqrt{1-\\zeta^{2}}}\n$$\nFor small $\\zeta$, we use the Taylor expansion $\\sqrt{1-u} \\approx 1 - u/2$:\n$$\n\\sqrt{1-\\zeta^{2}} \\approx 1 - \\frac{\\zeta^{2}}{2}\n$$\n$$\nx_{\\pm} \\approx \\omega_n^{2}\\left(1-2\\zeta^{2} \\pm 2\\zeta(1-\\frac{\\zeta^{2}}{2})\\right) = \\omega_n^{2}(1-2\\zeta^{2} \\pm (2\\zeta - \\zeta^{3}))\n$$\nNow we find $\\omega_{\\pm} = \\sqrt{x_{\\pm}}$ using $\\sqrt{1+\\epsilon} \\approx 1+\\epsilon/2$:\n$$\n\\omega_{+} \\approx \\omega_n \\sqrt{1 + 2\\zeta - 2\\zeta^{2}} \\approx \\omega_n \\left(1 + \\frac{1}{2}(2\\zeta - 2\\zeta^{2})\\right) = \\omega_n(1+\\zeta-\\zeta^{2})\n$$\n$$\n\\omega_{-} \\approx \\omega_n \\sqrt{1 - 2\\zeta - 2\\zeta^{2}} \\approx \\omega_n \\left(1 - \\frac{1}{2}(2\\zeta + 2\\zeta^{2})\\right) = \\omega_n(1-\\zeta-\\zeta^{2})\n$$\nThe bandwidth $\\Delta\\omega$ is then estimated as:\n$$\n\\Delta\\omega = \\omega_{+} - \\omega_{-} \\approx \\omega_n(1+\\zeta-\\zeta^{2}) - \\omega_n(1-\\zeta-\\zeta^{2}) = 2\\zeta\\omega_n\n$$\nThis is the standard first-order approximation for the $-3$ dB bandwidth around the resonant peak for a lightly damped system.\n\nNow we evaluate these expressions for $\\zeta=0.1$ and $\\omega_n=10$ rad/s.\n\nResonant frequency:\n$$\n\\omega_r = 10 \\sqrt{1 - 2(0.1)^{2}} = 10 \\sqrt{1 - 0.02} = 10 \\sqrt{0.98} \\approx 9.8994949\\,\\text{rad/s}\n$$\nRounding to four significant figures gives $\\omega_r = 9.899$ rad/s.\n\nResonant peak:\n$$\nM_r = \\frac{1}{2(0.1)\\sqrt{1-(0.1)^{2}}} = \\frac{1}{0.2\\sqrt{0.99}} = \\frac{5}{\\sqrt{0.99}} \\approx 5.025189...\n$$\nRounding to four significant figures gives $M_r = 5.025$.\n\nEstimated bandwidth:\n$$\n\\Delta \\omega \\approx 2\\zeta\\omega_n = 2(0.1)(10) = 2 \\,\\text{rad/s}\n$$\nRounding to four significant figures gives $\\Delta\\omega = 2.000$ rad/s.\n\nThe asked-for values are $\\omega_r$, $M_r$, and the estimated $\\Delta \\omega$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 9.899 & 5.025 & 2.000 \\end{pmatrix}}\n$$", "id": "2740189"}, {"introduction": "Moving from analysis to design, this practice addresses a common engineering challenge: shaping a system's response to meet multiple objectives. You will synthesize a simple proportional controller to adjust the closed-loop behavior of a resonant plant, aiming to satisfy a specific amplitude requirement while adhering to a critical damping constraint. This exercise demonstrates the fundamental trade-offs inherent in control design, where enhancing one aspect of performance can affect stability and robustness. [@problem_id:2740155]", "problem": "Consider a unity-feedback loop with a Linear Time-Invariant (LTI) plant modeled as a mass–spring–damper in normalized form\n$$\nG(s) \\;=\\; \\frac{1}{s^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2}},\n$$\nwhere $\\omega_{0} = 10$ (radians per second) is the natural frequency and $\\zeta_{0} = 0.3$ is the open-loop damping ratio. The controller is a scalar gain $k_{r} \\in \\mathbb{R}_{>0}$. The closed-loop complementary sensitivity is, by definition,\n$$\nT(s) \\;=\\; \\frac{k_{r}\\,G(s)}{1 + k_{r}\\,G(s)}.\n$$\n\nYou are asked to design $k_{r}$ so that the closed-loop amplitude at the specified frequency $\\omega_{r} = 10$ (radians per second) equals the target value $A_{r} = 0.50$, that is,\n$$\n\\bigl|T(j\\,\\omega_{r})\\bigr| \\;=\\; A_{r}.\n$$\nAmong all $k_{r} > 0$ that achieve this amplitude specification, you must ensure that the resulting closed-loop damping ratio $\\zeta_{c}$, defined by casting the closed-loop characteristic polynomial into the standard second-order form $s^{2} + 2\\,\\zeta_{c}\\,\\omega_{c}\\,s + \\omega_{c}^{2}$, satisfies the constraint $\\zeta_{c} \\ge \\zeta_{\\min}$ with $\\zeta_{\\min} = 0.25$.\n\nOnce such a $k_{r}$ is selected, compute the resulting resonance peak, that is, the maximum value of the closed-loop complementary sensitivity magnitude $\\max_{\\omega \\ge 0} |T(j\\,\\omega)|$.\n\nExpress the final answer as a single real number (dimensionless). Round your answer to four significant figures.", "solution": "We begin from the unity-feedback definition of the complementary sensitivity,\n$$\nT(s) \\;=\\; \\frac{k_{r}\\,G(s)}{1 + k_{r}\\,G(s)}.\n$$\nWith $G(s) = 1/(s^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2})$, this simplifies algebraically to\n$$\nT(s) \\;=\\; \\frac{k_{r}}{s^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2} + k_{r}}.\n$$\nTherefore, the closed-loop characteristic polynomial is\n$$\ns^{2} + 2\\,\\zeta_{0}\\,\\omega_{0}\\,s + \\omega_{0}^{2} + k_{r}.\n$$\nMatching to the standard second-order form $s^{2} + 2\\,\\zeta_{c}\\,\\omega_{c}\\,s + \\omega_{c}^{2}$ gives the identities\n$$\n\\omega_{c}^{2} \\;=\\; \\omega_{0}^{2} + k_{r}, \n\\qquad\n2\\,\\zeta_{c}\\,\\omega_{c} \\;=\\; 2\\,\\zeta_{0}\\,\\omega_{0}\n\\;\\;\\Rightarrow\\;\\;\n\\zeta_{c} \\;=\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\sqrt{\\omega_{0}^{2} + k_{r}}}.\n$$\n\nAmplitude specification at $\\omega_{r}$. Evaluating $T(j\\,\\omega)$ in magnitude yields\n$$\n\\bigl|T(j\\,\\omega)\\bigr| \\;=\\; \\frac{k_{r}}{\\sqrt{\\bigl(\\omega_{0}^{2} + k_{r} - \\omega^{2}\\bigr)^{2} + \\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega\\bigr)^{2}}}.\n$$\nImposing $\\bigl|T(j\\,\\omega_{r})\\bigr| = A_{r}$ gives the equation\n$$\n\\frac{k_{r}}{\\sqrt{\\bigl(\\omega_{0}^{2} + k_{r} - \\omega_{r}^{2}\\bigr)^{2} + \\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r}\\bigr)^{2}}} \\;=\\; A_{r}.\n$$\nSquaring both sides and rearranging leads to a quadratic in $k_{r}$,\n$$\n\\bigl(1 - A_{r}^{2}\\bigr)\\,k_{r}^{2} \\;-\\; 2\\,A_{r}^{2}\\,(\\omega_{0}^{2} - \\omega_{r}^{2})\\,k_{r} \\;-\\; A_{r}^{2}\\!\\left[(\\omega_{0}^{2} - \\omega_{r}^{2})^{2} + \\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r}\\bigr)^{2}\\right] \\;=\\; 0,\n$$\nwhose positive solution is\n$$\nk_{r} \\;=\\; \\frac{A_{r}^{2}\\,(\\omega_{0}^{2} - \\omega_{r}^{2}) + A_{r}\\,\\sqrt{(\\omega_{0}^{2} - \\omega_{r}^{2})^{2} + \\bigl(1 - A_{r}^{2}\\bigr)\\,\\bigl(2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r}\\bigr)^{2}}}{1 - A_{r}^{2}}.\n$$\nFor the given values $\\omega_{r} = \\omega_{0} = 10$, $\\zeta_{0} = 0.3$, and $A_{r} = 0.50$, we have $\\omega_{0}^{2} - \\omega_{r}^{2} = 0$ and $2\\,\\zeta_{0}\\,\\omega_{0}\\,\\omega_{r} = 2 \\cdot 0.3 \\cdot 10 \\cdot 10 = 60$, so this simplifies to\n$$\nk_{r} \\;=\\; \\frac{A_{r}\\,\\sqrt{\\bigl(1 - A_{r}^{2}\\bigr)\\,(60)^{2}}}{1 - A_{r}^{2}}\n\\;=\\; \\frac{60\\,A_{r}}{\\sqrt{1 - A_{r}^{2}}}.\n$$\nSubstituting $A_{r} = 0.50$,\n$$\nk_{r} \\;=\\; \\frac{60 \\cdot 0.50}{\\sqrt{1 - 0.50^{2}}}\n\\;=\\; \\frac{30}{\\sqrt{0.75}}\n\\;\\approx\\; 34.6410161513775.\n$$\n\nDamping ratio constraint. The closed-loop damping ratio is $\\zeta_{c} = \\zeta_{0}\\,\\omega_{0} / \\sqrt{\\omega_{0}^{2} + k_{r}}$. The requirement $\\zeta_{c} \\ge \\zeta_{\\min}$ is equivalent to\n$$\n\\sqrt{\\omega_{0}^{2} + k_{r}} \\;\\le\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\zeta_{\\min}}\n\\;\\;\\Longleftrightarrow\\;\\;\nk_{r} \\;\\le\\; \\omega_{0}^{2}\\!\\left(\\frac{\\zeta_{0}^{2}}{\\zeta_{\\min}^{2}} - 1\\right).\n$$\nWith $\\omega_{0} = 10$, $\\zeta_{0} = 0.3$, and $\\zeta_{\\min} = 0.25$,\n$$\nk_{r}^{\\max} \\;=\\; 10^{2}\\!\\left(\\frac{0.3^{2}}{0.25^{2}} - 1\\right) \\;=\\; 100\\,(1.44 - 1) \\;=\\; 44,\n$$\nand the designed $k_{r} \\approx 34.6410161513775$ satisfies the constraint.\n\nResonance peak computation. Write\n$$\n\\omega_{c}^{2} \\;=\\; \\omega_{0}^{2} + k_{r},\n\\qquad\n2\\,\\zeta_{c}\\,\\omega_{c} \\;=\\; 2\\,\\zeta_{0}\\,\\omega_{0},\n\\qquad\n\\zeta_{c} \\;=\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\omega_{c}}.\n$$\nThe magnitude of $T(j\\,\\omega)$ is\n$$\n\\bigl|T(j\\,\\omega)\\bigr| \\;=\\; \\frac{k_{r}}{\\sqrt{\\bigl(\\omega_{c}^{2} - \\omega^{2}\\bigr)^{2} + \\bigl(2\\,\\zeta_{c}\\,\\omega_{c}\\,\\omega\\bigr)^{2}}}.\n$$\nTo locate the resonance, differentiate the squared denominator $h(\\omega) = (\\omega_{c}^{2} - \\omega^{2})^{2} + (2\\,\\zeta_{c}\\,\\omega_{c}\\,\\omega)^{2}$ and set $\\mathrm{d}h/\\mathrm{d}\\omega = 0$, obtaining\n$$\n\\omega_{p}^{2} \\;=\\; \\omega_{c}^{2}\\,\\bigl(1 - 2\\,\\zeta_{c}^{2}\\bigr),\n\\quad \\text{provided} \\quad \\zeta_{c} < \\frac{1}{\\sqrt{2}},\n$$\nwhich holds here because $\\zeta_{c} \\le \\zeta_{0} = 0.3$. Substituting $\\omega = \\omega_{p}$ into $\\bigl|T(j\\,\\omega)\\bigr|$ and simplifying yields\n$$\n\\max_{\\omega \\ge 0} \\bigl|T(j\\,\\omega)\\bigr|\n\\;=\\;\n\\frac{k_{r}}{2\\,\\omega_{c}^{2}\\,\\zeta_{c}\\,\\sqrt{1 - \\zeta_{c}^{2}}}.\n$$\nUsing the designed $k_{r}$,\n$$\n\\omega_{c}^{2} \\;=\\; \\omega_{0}^{2} + k_{r} \\;\\approx\\; 100 + 34.6410161513775 \\;=\\; 134.6410161513775,\n$$\n$$\n\\zeta_{c} \\;=\\; \\frac{\\zeta_{0}\\,\\omega_{0}}{\\sqrt{\\omega_{c}^{2}}}\n\\;\\approx\\; \\frac{3}{\\sqrt{134.6410161513775}}\n\\;\\approx\\; 0.258544,\n$$\n$$\n\\sqrt{1 - \\zeta_{c}^{2}} \\;\\approx\\; \\sqrt{1 - 0.0668444} \\;\\approx\\; 0.966000.\n$$\nTherefore,\n$$\n\\max_{\\omega \\ge 0} \\bigl|T(j\\,\\omega)\\bigr|\n\\;\\approx\\;\n\\frac{34.6410161513775}{2 \\cdot 134.6410161513775 \\cdot 0.258544 \\cdot 0.966000}\n\\;\\approx\\; 0.5151,\n$$\nrounded to four significant figures. This is the requested resonance peak magnitude (dimensionless).", "answer": "$$\\boxed{0.5151}$$", "id": "2740155"}, {"introduction": "A successful continuous-time design is only as good as its digital implementation. This practice delves into a crucial and often-overlooked aspect of digital control: the non-intuitive effects of discretization. By examining the process of converting a continuous-time notch filter to a digital one using the bilinear transform, you will uncover the phenomenon of frequency warping and derive the necessary 'pre-warping' correction to ensure accurate resonance suppression in the digital domain. [@problem_id:2740191]", "problem": "A continuous-time single-input single-output plant has a lightly damped resonance at the angular frequency $\\omega_{r}$ (in radians per second). You will design a digital notch filter to suppress this resonance by first specifying a continuous-time second-order notch with center frequency $\\omega_{n}$ and then discretizing it with the bilinear transform (BLT) at sampling period $T$. Assume $0<\\omega_{r}T<\\pi$ so that the resonance is not aliased by sampling, and that damping is sufficiently small that the notch center governs the suppression effectiveness.\n\nUse only the following foundational definitions to guide your derivation:\n\n- Continuous-time frequency response evaluation: substitute $s=j\\omega$.\n- Discrete-time frequency response evaluation: substitute $z=\\exp(j\\Omega)$ where $\\Omega$ is the discrete-time radian frequency (radians per sample).\n- Bilinear transform (BLT) mapping: $s=\\dfrac{2}{T}\\dfrac{z-1}{z+1}$.\n\nTask:\n1. Starting from these definitions, derive the mapping between the continuous-time frequency variable $\\omega$ and the discrete-time frequency variable $\\Omega$ that results from the bilinear transform.\n2. Use this mapping to explain, without invoking any additional formulas, why directly setting the continuous-time notch center to $\\omega_{n}=\\omega_{r}$ and then discretizing produces a digital notch center that does not coincide with the sampled resonance at discrete frequency $\\Omega_{r}=\\omega_{r}T$.\n3. Derive a pre-warping rule that selects a continuous-time notch center $\\omega_{n}^{\\star}$ as a function of $\\omega_{r}$ and $T$ so that, after bilinear discretization, the center of the digital notch aligns exactly with the sampled resonance at $\\Omega_{r}=\\omega_{r}T$.\n\nAnswer specification: Provide your final answer as a single closed-form expression for $\\omega_{n}^{\\star}$ in terms of $\\omega_{r}$ and $T$. Do not include any units in the final answer box and do not round; an exact analytic expression is required.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of digital control theory, well-posed, and objective. It contains no logical contradictions, missing information, or pseudoscientific claims. I will proceed with a full derivation.\n\nThe problem requires a three-part derivation concerning the design of a digital notch filter via the bilinear transform (BLT). The core of the problem lies in the non-linear relationship, or \"warping,\" between the continuous-time frequency axis and the discrete-time frequency axis introduced by the BLT. We will address each task in sequence.\n\nFirst, we derive the mapping between the continuous-time frequency variable $\\omega$ and the discrete-time frequency variable $\\Omega$. The problem provides the necessary foundational definitions: the continuous-time frequency response is found by substituting $s=j\\omega$, the discrete-time frequency response by substituting $z=\\exp(j\\Omega)$, and the BLT mapping itself is $s=\\frac{2}{T}\\frac{z-1}{z+1}$.\n\nWe begin by substituting the frequency-domain representations for $s$ and $z$ into the BLT equation:\n$$\nj\\omega = \\frac{2}{T} \\frac{\\exp(j\\Omega) - 1}{\\exp(j\\Omega) + 1}\n$$\nTo simplify the expression on the right-hand side, we factor out a term $\\exp(j\\Omega/2)$ from both the numerator and the denominator:\n$$\nj\\omega = \\frac{2}{T} \\frac{\\exp(j\\Omega/2) \\left( \\exp(j\\Omega/2) - \\exp(-j\\Omega/2) \\right)}{\\exp(j\\Omega/2) \\left( \\exp(j\\Omega/2) + \\exp(-j\\Omega/2) \\right)}\n$$\nThe term $\\exp(j\\Omega/2)$ cancels. We now use Euler's formulas for the sine and cosine functions:\n$$\n\\sin(x) = \\frac{\\exp(jx) - \\exp(-jx)}{2j} \\implies 2j\\sin(x) = \\exp(jx) - \\exp(-jx)\n$$\n$$\n\\cos(x) = \\frac{\\exp(jx) + \\exp(-jx)}{2} \\implies 2\\cos(x) = \\exp(jx) + \\exp(-jx)\n$$\nSubstituting these identities with $x = \\Omega/2$ into our equation yields:\n$$\nj\\omega = \\frac{2}{T} \\frac{2j\\sin(\\Omega/2)}{2\\cos(\\Omega/2)}\n$$\nThis simplifies to:\n$$\nj\\omega = \\frac{2}{T} j\\tan(\\frac{\\Omega}{2})\n$$\nDividing both sides by the imaginary unit $j$, we arrive at the anaytical mapping between the continuous frequency $\\omega$ and the discrete frequency $\\Omega$:\n$$\n\\omega = \\frac{2}{T} \\tan\\left(\\frac{\\Omega}{2}\\right)\n$$\nThis relationship is non-linear and is the source of the frequency warping phenomenon.\n\nSecond, we use this mapping to explain why the naive approach of setting the continuous-time notch center frequency $\\omega_n$ to the plant resonance frequency $\\omega_r$ fails to place the digital notch at the correct location. The target discrete frequency for the notch is the sampled resonance frequency, $\\Omega_r = \\omega_r T$. The naive approach assumes that by setting $\\omega_n = \\omega_r$, the resulting discrete notch center, let us call it $\\Omega_n$, will be equal to $\\Omega_r$.\n\nLet us test this assumption. We take the derived frequency mapping and substitute the continuous-time notch center $\\omega_n$ and the resulting discrete-time notch center $\\Omega_n$:\n$$\n\\omega_n = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\nApplying the naive choice $\\omega_n = \\omega_r$, we have:\n$$\n\\omega_r = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\nWe now solve for the resulting discrete frequency $\\Omega_n$:\n$$\n\\frac{\\omega_r T}{2} = \\tan\\left(\\frac{\\Omega_n}{2}\\right)\n$$\n$$\n\\Omega_n = 2 \\arctan\\left(\\frac{\\omega_r T}{2}\\right)\n$$\nThe intended target frequency is $\\Omega_r = \\omega_r T$. The question is whether $\\Omega_n = \\Omega_r$. We must compare $2 \\arctan(x)$ with $2x$ for $x = \\frac{\\omega_r T}{2}$. It is a fundamental property of the arctangent function that for any positive argument $x>0$, the inequality $\\arctan(x) < x$ holds. The problem statement specifies $0 < \\omega_r T < \\pi$, which ensures that $x = \\frac{\\omega_r T}{2}$ is positive.\nTherefore:\n$$\n\\arctan\\left(\\frac{\\omega_r T}{2}\\right) < \\frac{\\omega_r T}{2}\n$$\nMultiplying by $2$:\n$$\n2 \\arctan\\left(\\frac{\\omega_r T}{2}\\right) < \\omega_r T\n$$\nThis means $\\Omega_n < \\Omega_r$. The naive design places the digital notch at a frequency strictly lower than the target resonance frequency. This occurs because the non-linear warping compresses higher continuous frequencies more than lower ones when mapping them to the discrete frequency range. A simple linear scaling is incorrect.\n\nThird, we derive the pre-warping rule. The objective is to select a specific continuous-time notch center, which we shall call $\\omega_n^{\\star}$, such that after discretization via the BLT, the resulting discrete notch is centered precisely at the target frequency $\\Omega_r = \\omega_r T$.\n\nWe use our frequency mapping equation, this time with the pre-warped continuous frequency $\\omega_n^{\\star}$ on the left-hand side and the desired target discrete frequency $\\Omega_r$ on the right-hand side. The equation must be satisfied by design:\n$$\n\\omega_n^{\\star} = \\frac{2}{T} \\tan\\left(\\frac{\\Omega_r}{2}\\right)\n$$\nWe now substitute the definition of the target frequency, $\\Omega_r = \\omega_r T$:\n$$\n\\omega_n^{\\star} = \\frac{2}{T} \\tan\\left(\\frac{\\omega_r T}{2}\\right)\n$$\nThis expression gives the required continuous-time center frequency $\\omega_n^{\\star}$ to use in the analog prototype filter. When a continuous-time notch filter centered at this frequency $\\omega_n^{\\star}$ is discretized using the bilinear transform with sampling period $T$, the resulting digital notch filter will have its center located exactly at the desired discrete frequency $\\Omega_r = \\omega_r T$, thereby correctly suppressing the plant resonance. This process is known as frequency pre-warping.", "answer": "$$\n\\boxed{\\frac{2}{T} \\tan\\left(\\frac{\\omega_{r} T}{2}\\right)}\n$$", "id": "2740191"}]}