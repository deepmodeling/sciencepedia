{"hands_on_practices": [{"introduction": "Bode plots are not merely analytical tools; they are a canvas for design. This exercise guides you through a fundamental controller synthesis task: shaping the open-loop frequency response to enhance stability. By analytically deriving the parameters of a lead-lag compensator, you will discover how to precisely place the gain crossover frequency to achieve the maximum possible phase margin, a cornerstone technique for designing robust feedback systems [@problem_id:2690850].", "problem": "Consider the open-loop transfer function\n$$\nL(s)=\\frac{K\\left(1+\\frac{s}{z}\\right)}{s\\left(1+\\frac{s}{p}\\right)},\n$$\nwhere $K0$ is a scalar gain and $z0$, $p0$ are real constants with $z\\neq p$. The Bode plot is defined from the frequency response $L(j\\omega)$, where the magnitude is $|L(j\\omega)|$ and the phase is $\\angle L(j\\omega)$. The gain crossover frequency $\\omega_{c}$ is defined by the solution of $|L(j\\omega_{c})|=1$. The phase margin $\\phi_{m}$ is defined by $\\phi_{m}=\\pi+\\angle L(j\\omega_{c})$ (angle in radians), and the gain margin $\\gamma_{m}$ is the reciprocal of the magnitude at the phase crossover frequency $\\omega_{p}$, where $\\angle L(j\\omega_{p})=-\\pi$ (if such $\\omega_{p}$ exists). All angles must be expressed in radians.\n\nTasks:\n- Using only the foundational definitions above, derive $|L(j\\omega)|$ and $\\angle L(j\\omega)$ as functions of $\\omega$, $K$, $z$, and $p$.\n- Express the phase margin $\\phi_{m}$ and gain margin $\\gamma_{m}$ in terms of $K$, $z$, $p$, and the gain crossover frequency $\\omega_{c}$ defined by $|L(j\\omega_{c})|=1$. State clearly whether a finite phase crossover exists.\n- Impose the constraint that the gain crossover is at a designer-specified $\\omega_{c}0$ by solving $|L(j\\omega_{c})|=1$ for $K=K(\\omega_{c})$. Then, eliminate $K$ from $\\phi_{m}$ and maximize $\\phi_{m}$ with respect to $\\omega_{c}0$. Finally, report only the exact symbolic expression for the optimal gain $K$ (in terms of $z$ and $p$) that achieves the maximal phase margin under the gain-crossover constraint.\n\nYour final answer must be a single analytic expression. Do not include units in the final answer. Angles, where relevant, are in radians.", "solution": "The problem as stated is well-posed, scientifically grounded, and contains all necessary information for a rigorous solution. We shall proceed directly to the derivation as requested.\n\nThe open-loop transfer function is given by\n$$\nL(s)=\\frac{K\\left(1+\\frac{s}{z}\\right)}{s\\left(1+\\frac{s}{p}\\right)}\n$$\nwith $K0$, $z0$, and $p0$, where $z \\neq p$.\n\nTo find the frequency response, we substitute $s=j\\omega$, where $j=\\sqrt{-1}$ and $\\omega$ is the angular frequency.\n$$\nL(j\\omega) = \\frac{K\\left(1+j\\frac{\\omega}{z}\\right)}{j\\omega\\left(1+j\\frac{\\omega}{p}\\right)}\n$$\n\nThe first task is to derive the magnitude $|L(j\\omega)|$ and phase $\\angle L(j\\omega)$.\nThe magnitude of a product and quotient of complex numbers is the product and quotient of their magnitudes.\n$$\n|L(j\\omega)| = \\frac{|K| \\cdot \\left|1+j\\frac{\\omega}{z}\\right|}{|j\\omega| \\cdot \\left|1+j\\frac{\\omega}{p}\\right|}\n$$\nSince $K0$, $|K|=K$. For $\\omega0$, $|j\\omega|=\\omega$. The magnitudes of the complex terms are calculated as $\\sqrt{a^2+b^2}$.\n$$\n|L(j\\omega)| = \\frac{K \\sqrt{1^2 + \\left(\\frac{\\omega}{z}\\right)^2}}{\\omega \\sqrt{1^2 + \\left(\\frac{\\omega}{p}\\right)^2}} = \\frac{K\\sqrt{1+\\frac{\\omega^2}{z^2}}}{\\omega\\sqrt{1+\\frac{\\omega^2}{p^2}}}\n$$\nThe phase is the sum and difference of the phases of the individual terms.\n$$\n\\angle L(j\\omega) = \\angle K + \\angle\\left(1+j\\frac{\\omega}{z}\\right) - \\angle(j\\omega) - \\angle\\left(1+j\\frac{\\omega}{p}\\right)\n$$\nSince $K$ is a positive real number, $\\angle K = 0$. The phase of $j\\omega$ is $\\frac{\\pi}{2}$ for $\\omega0$. The phase of a complex number $a+jb$ is $\\arctan(b/a)$.\n$$\n\\angle L(j\\omega) = 0 + \\arctan\\left(\\frac{\\omega}{z}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega}{p}\\right)\n$$\n\nThe second task is to express the phase margin $\\phi_{m}$ and gain margin $\\gamma_{m}$.\nThe phase margin is defined as $\\phi_{m} = \\pi + \\angle L(j\\omega_c)$, where $\\omega_c$ is the gain crossover frequency.\nSubstituting the expression for the phase at $\\omega_c$:\n$$\n\\phi_{m} = \\pi + \\left(\\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\\right) = \\frac{\\pi}{2} + \\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\n$$\nThe gain margin $\\gamma_{m}$ requires finding the phase crossover frequency $\\omega_{p}$, at which $\\angle L(j\\omega_{p}) = -\\pi$.\n$$\n\\arctan\\left(\\frac{\\omega_p}{z}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega_p}{p}\\right) = -\\pi\n$$\n$$\n\\arctan\\left(\\frac{\\omega_p}{z}\\right) - \\arctan\\left(\\frac{\\omega_p}{p}\\right) = -\\frac{\\pi}{2}\n$$\nUsing the identity $\\arctan(a)-\\arctan(b) = \\arctan\\left(\\frac{a-b}{1+ab}\\right)$, we get:\n$$\n\\arctan\\left(\\frac{\\frac{\\omega_p}{z} - \\frac{\\omega_p}{p}}{1+\\frac{\\omega_p^2}{zp}}\\right) = \\arctan\\left(\\frac{\\omega_p(p-z)}{zp+\\omega_p^2}\\right) = -\\frac{\\pi}{2}\n$$\nThe arctangent function approaches $-\\frac{\\pi}{2}$ only as its argument approaches $-\\infty$. For any finite, positive $\\omega_p$, $z$, and $p$, the denominator $zp+\\omega_p^2$ is strictly positive. The numerator $\\omega_p(p-z)$ is finite. Therefore, the argument of the arctangent is always finite. This means there is no finite, positive frequency $\\omega_p$ for which the phase equals $-\\pi$. Consequently, the system has no finite phase crossover frequency, and the gain margin $\\gamma_m$ is infinite.\n\nThe third task is to find the optimal gain $K$ that maximizes the phase margin $\\phi_{m}$. The gain $K$ allows us to set the gain crossover frequency $\\omega_c$ to any desired value. We must first find the optimal $\\omega_c$ that maximizes $\\phi_m$ and then find the corresponding $K$.\nThe phase margin is a function of $\\omega_c$:\n$$\n\\phi_{m}(\\omega_c) = \\frac{\\pi}{2} + \\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\n$$\nTo find the extremum, we differentiate $\\phi_{m}$ with respect to $\\omega_c$ and set the derivative to zero.\n$$\n\\frac{d\\phi_{m}}{d\\omega_c} = \\frac{d}{d\\omega_c}\\left(\\arctan\\left(\\frac{\\omega_c}{z}\\right) - \\arctan\\left(\\frac{\\omega_c}{p}\\right)\\right) = 0\n$$\n$$\n\\frac{1/z}{1+(\\omega_c/z)^2} - \\frac{1/p}{1+(\\omega_c/p)^2} = 0\n$$\n$$\n\\frac{z}{z^2+\\omega_c^2} = \\frac{p}{p^2+\\omega_c^2}\n$$\n$$\nz(p^2+\\omega_c^2) = p(z^2+\\omega_c^2)\n$$\n$$\nzp^2+z\\omega_c^2 = pz^2+p\\omega_c^2\n$$\n$$\nzp^2-pz^2 = p\\omega_c^2 - z\\omega_c^2\n$$\n$$\nzp(p-z) = \\omega_c^2(p-z)\n$$\nSince $z \\neq p$, we can divide by $(p-z)$:\n$$\n\\omega_c^2 = zp \\implies \\omega_c = \\sqrt{zp}\n$$\nThis gives the crossover frequency $\\omega_c^*$ for an extremal phase margin. An analysis of the second derivative shows this is a maximum if $pz$ and a minimum if $zp$. The problem asks for maximization, so we proceed under the condition $pz$, which corresponds to a lead compensator action.\nThe final step is to find the value of $K$ that places the gain crossover at this optimal frequency $\\omega_c^*=\\sqrt{zp}$. We use the condition $|L(j\\omega_c^*)|=1$.\n$$\n\\frac{K \\sqrt{1+\\frac{(\\omega_c^*)^2}{z^2}}}{\\omega_c^* \\sqrt{1+\\frac{(\\omega_c^*)^2}{p^2}}} = 1\n$$\nSolving for $K$:\n$$\nK = \\frac{\\omega_c^* \\sqrt{1+\\frac{(\\omega_c^*)^2}{p^2}}}{\\sqrt{1+\\frac{(\\omega_c^*)^2}{z^2}}}\n$$\nSubstitute $\\omega_c^* = \\sqrt{zp}$:\n$$\nK_{opt} = \\frac{\\sqrt{zp} \\sqrt{1+\\frac{zp}{p^2}}}{\\sqrt{1+\\frac{zp}{z^2}}} = \\frac{\\sqrt{zp} \\sqrt{1+\\frac{z}{p}}}{\\sqrt{1+\\frac{p}{z}}}\n$$\n$$\nK_{opt} = \\sqrt{zp} \\frac{\\sqrt{\\frac{p+z}{p}}}{\\sqrt{\\frac{z+p}{z}}} = \\sqrt{zp} \\sqrt{\\frac{p+z}{p} \\cdot \\frac{z}{z+p}} = \\sqrt{zp} \\sqrt{\\frac{z}{p}}\n$$\n$$\nK_{opt} = \\sqrt{z}\\sqrt{p} \\frac{\\sqrt{z}}{\\sqrt{p}} = (\\sqrt{z})^2 = z\n$$\nThus, the optimal gain to achieve maximum phase margin is $K=z$.", "answer": "$$\\boxed{z}$$", "id": "2690850"}, {"introduction": "While control design often involves shaping frequency response to our advantage, some systems present inherent, unchangeable limitations. This practice delves into the crucial concept of non-minimum phase (NMP) systems, specifically those with right-half-plane (RHP) zeros. You will analytically demonstrate how an RHP zero adds performance-degrading phase lag without altering the magnitude plot, providing a first-principles understanding of why these systems are fundamentally more challenging to control [@problem_id:2690779].", "problem": "Consider the single-input single-output open-loop transfer function\n$$\nL(s) \\;=\\; K\\,G(s), \\qquad G(s) \\;=\\; \\frac{1 - s/z}{1 + s/p},\n$$\nwith $z0$, $p0$, and real gain $K0$. The numerator zero is in the Right-Half-Plane (RHP), at $s=z$, and the pole is in the Left-Half-Plane (LHP), at $s=-p$. Use only the sinusoidal steady-state definition of frequency response, the modulus and argument of complex numbers, and basic algebraic manipulation.\n\nTasks:\n- Starting from the definition of the frequency response $G(\\mathrm{j}\\omega)$, derive an exact analytic expression for the gain crossover frequency $\\omega_{gc}$, defined by the condition $|L(\\mathrm{j}\\omega_{gc})|=1$, in terms of $K$, $z$, and $p$. State clearly any conditions under which a positive real solution $\\omega_{gc}$ exists.\n- Specialize your analytic expression to the parameter values $K=0.5$, $z=2$ rad/s, and $p=10$ rad/s, and evaluate $\\omega_{gc}$ numerically. \n- Using the exact phase of $G(\\mathrm{j}\\omega)$, determine the open-loop phase $\\angle L(\\mathrm{j}\\omega_{gc})$ for the given RHP zero and compare it with the phase of a hypothetical minimum-phase counterpart in which the numerator is replaced by $1 + s/z$ while keeping the same $K$, $z$, and $p$. Explain, from first principles, how the RHP zero modifies the phase margin at $\\omega_{gc}$ relative to the minimum-phase counterpart. Express any angles in degrees.\n\nAnswer specification:\n- Report only the numerical value of the gain crossover frequency $\\omega_{gc}$ for $K=0.5$, $z=2$ rad/s, $p=10$ rad/s.\n- Express $\\omega_{gc}$ in rad/s.\n- Round your answer to $4$ significant figures.", "solution": "The problem presented is well-posed, scientifically grounded, and self-contained. It is a standard problem in linear control theory, suitable for analysis. We shall proceed with the derivation and solution.\n\nThe open-loop transfer function is given by\n$$\nL(s) = K \\frac{1 - s/z}{1 + s/p}\n$$\nwhere $K  0$, $z  0$, and $p  0$. The zero at $s = z$ is in the Right-Half-Plane (RHP), making this a non-minimum-phase system.\n\nFirst, we derive the expression for the gain crossover frequency, $\\omega_{gc}$. By definition, this is the frequency $\\omega  0$ at which the magnitude of the frequency response is unity. The frequency response is obtained by substituting $s = \\mathrm{j}\\omega$:\n$$\nL(\\mathrm{j}\\omega) = K \\frac{1 - \\mathrm{j}\\omega/z}{1 + \\mathrm{j}\\omega/p}\n$$\nThe magnitude is given by the modulus of this complex function:\n$$\n|L(\\mathrm{j}\\omega)| = |K| \\frac{|1 - \\mathrm{j}\\omega/z|}{|1 + \\mathrm{j}\\omega/p|}\n$$\nSince $K$ is a positive real gain, $|K|=K$. The modulus of the numerator is $|1 - \\mathrm{j}\\omega/z| = \\sqrt{1^2 + (-\\omega/z)^2} = \\sqrt{1 + (\\omega/z)^2}$. The modulus of the denominator is $|1 + \\mathrm{j}\\omega/p| = \\sqrt{1^2 + (\\omega/p)^2} = \\sqrt{1 + (\\omega/p)^2}$. Thus, the magnitude is:\n$$\n|L(\\mathrm{j}\\omega)| = K \\sqrt{\\frac{1 + \\omega^2/z^2}{1 + \\omega^2/p^2}}\n$$\nThe gain crossover condition is $|L(\\mathrm{j}\\omega_{gc})|=1$.\n$$\n1 = K \\sqrt{\\frac{1 + \\omega_{gc}^2/z^2}{1 + \\omega_{gc}^2/p^2}}\n$$\nTo solve for $\\omega_{gc}$, we square both sides and rearrange the equation:\n$$\n\\frac{1}{K^2} = \\frac{1 + \\omega_{gc}^2/z^2}{1 + \\omega_{gc}^2/p^2}\n$$\n$$\n1 + \\frac{\\omega_{gc}^2}{p^2} = K^2 \\left(1 + \\frac{\\omega_{gc}^2}{z^2}\\right) = K^2 + \\frac{K^2 \\omega_{gc}^2}{z^2}\n$$\nWe collect terms involving $\\omega_{gc}^2$:\n$$\n\\omega_{gc}^2 \\left(\\frac{1}{p^2} - \\frac{K^2}{z^2}\\right) = K^2 - 1\n$$\n$$\n\\omega_{gc}^2 \\left(\\frac{z^2 - K^2 p^2}{p^2 z^2}\\right) = K^2 - 1\n$$\nSolving for $\\omega_{gc}^2$ yields:\n$$\n\\omega_{gc}^2 = \\frac{p^2 z^2 (K^2 - 1)}{z^2 - K^2 p^2}\n$$\nFor a positive real solution $\\omega_{gc}$ to exist, the expression for $\\omega_{gc}^2$ must be positive. Since $p^2 z^2$ is always positive, this condition is equivalent to:\n$$\n\\frac{K^2 - 1}{z^2 - K^2 p^2}  0\n$$\nThis inequality holds if and only if the numerator and denominator have the same sign.\nCase 1: $K^2 - 1  0$ and $z^2 - K^2 p^2  0$. This implies $K  1$ and $z  Kp$, or $K  z/p$.\nCase 2: $K^2 - 1  0$ and $z^2 - K^2 p^2  0$. This implies $0  K  1$ and $z  Kp$, or $K  z/p$.\nThese two conditions can be summarized by observing the DC gain $|L(0)| = K$ and the high-frequency gain $\\lim_{\\omega \\to \\infty} |L(\\mathrm{j}\\omega)| = K(p/z)$. A unique crossover frequency exists if and only if the gain magnitude plot crosses unity, which means that unity gain must lie between the DC and high-frequency gains. That is, $(|L(0)|-1)(|L(\\mathrm{j}\\infty)|-1)  0$, or $(K-1)(Kp/z - 1)  0$. This is precisely equivalent to the two cases derived above.\n\nNow, we specialize to the given parameter values: $K=0.5$, $z=2 \\text{ rad/s}$, and $p=10 \\text{ rad/s}$.\nWe check the condition for existence. Here, $K=0.5  1$. We must be in Case 2, which requires $K  z/p$.\n$z/p = 2/10 = 0.2$. The condition is $0.5  0.2$, which is true. Therefore, a unique positive real solution for $\\omega_{gc}$ exists.\nWe substitute the values into the derived expression for $\\omega_{gc}^2$:\n$$\n\\omega_{gc}^2 = \\frac{10^2 \\cdot 2^2 \\cdot (0.5^2 - 1)}{2^2 - 0.5^2 \\cdot 10^2} = \\frac{100 \\cdot 4 \\cdot (0.25 - 1)}{4 - 0.25 \\cdot 100} = \\frac{400(-0.75)}{4 - 25} = \\frac{-300}{-21} = \\frac{100}{7}\n$$\nThe gain crossover frequency is:\n$$\n\\omega_{gc} = \\sqrt{\\frac{100}{7}} = \\frac{10}{\\sqrt{7}} \\approx 3.7796447... \\text{ rad/s}\n$$\nRounding to $4$ significant figures, we get $\\omega_{gc} \\approx 3.780$ rad/s.\n\nNext, we analyze the phase. The phase of the open-loop system is:\n$$\n\\angle L(\\mathrm{j}\\omega) = \\angle(1 - \\mathrm{j}\\omega/z) - \\angle(1 + \\mathrm{j}\\omega/p) = -\\arctan(\\omega/z) - \\arctan(\\omega/p)\n$$\nAt $\\omega_{gc} = 10/\\sqrt{7}$, the phase is:\n$$\n\\angle L(\\mathrm{j}\\omega_{gc}) = -\\arctan\\left(\\frac{10/\\sqrt{7}}{2}\\right) - \\arctan\\left(\\frac{10/\\sqrt{7}}{10}\\right) = -\\arctan\\left(\\frac{5}{\\sqrt{7}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{7}}\\right)\n$$\nNumerically, $\\arctan(5/\\sqrt{7}) \\approx 62.10^\\circ$ and $\\arctan(1/\\sqrt{7}) \\approx 20.70^\\circ$.\nSo, $\\angle L(\\mathrm{j}\\omega_{gc}) \\approx -62.10^\\circ - 20.70^\\circ = -82.80^\\circ$.\n\nThe hypothetical minimum-phase (MP) counterpart has the transfer function $L_{MP}(s) = K \\frac{1 + s/z}{1 + s/p}$. Its magnitude is $|L_{MP}(\\mathrm{j}\\omega)| = K \\sqrt{\\frac{1 + (\\omega/z)^2}{1 + (\\omega/p)^2}}$, which is identical to $|L(\\mathrm{j}\\omega)|$. Therefore, its gain crossover frequency is also $\\omega_{gc} = 10/\\sqrt{7}$ rad/s.\nThe phase of the MP system, however, is different:\n$$\n\\angle L_{MP}(\\mathrm{j}\\omega) = \\angle(1 + \\mathrm{j}\\omega/z) - \\angle(1 + \\mathrm{j}\\omega/p) = \\arctan(\\omega/z) - \\arctan(\\omega/p)\n$$\nAt $\\omega_{gc}$, the phase of the MP system is:\n$$\n\\angle L_{MP}(\\mathrm{j}\\omega_{gc}) = \\arctan\\left(\\frac{5}{\\sqrt{7}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{7}}\\right) \\approx 62.10^\\circ - 20.70^\\circ = 41.40^\\circ\n$$\n\nThe effect of the RHP zero is now clear. For any frequency $\\omega$, the magnitude contributions from a zero term, whether $1-s/z$ or $1+s/z$, are identical: $\\sqrt{1+(\\omega/z)^2}$. This is why $\\omega_{gc}$ does not change.\nThe phase contributions are fundamentally different. A minimum-phase zero $1+s/z$ contributes a positive phase (phase lead) of $\\arctan(\\omega/z)$, which increases from $0$ to $90^\\circ$. A non-minimum-phase zero $1-s/z$ contributes a negative phase (phase lag) of $-\\arctan(\\omega/z)$, which decreases from $0$ to $-90^\\circ$.\nAt the gain crossover frequency $\\omega_{gc}$, the RHP zero contributes a phase lag of $-\\arctan(\\omega_{gc}/z)$, whereas its MP counterpart would have contributed a phase lead of $\\arctan(\\omega_{gc}/z)$. The difference in phase between the RHP system and the MP system is therefore $-2\\arctan(\\omega_{gc}/z)$. For the given parameters, this additional phase lag is $-2 \\times 62.10^\\circ = -124.2^\\circ$.\nThe phase margin, $PM = 180^\\circ + \\angle L(\\mathrm{j}\\omega_{gc})$, is directly impacted.\nFor the RHP system, $PM_{RHP} = 180^\\circ - 82.80^\\circ = 97.2^\\circ$.\nFor the MP system, $PM_{MP} = 180^\\circ + 41.40^\\circ = 221.4^\\circ$.\nThe RHP zero has reduced the phase margin by an amount $2\\arctan(\\omega_{gc}/z) = 124.2^\\circ$ compared to its minimum-phase counterpart. This demonstrates the performance-limiting nature of RHP zeros: they add phase lag while increasing gain, a combination that degrades stability margin.\nThe problem only asks for the numerical value of $\\omega_{gc}$.", "answer": "$$\n\\boxed{3.780}\n$$", "id": "2690779"}, {"introduction": "This final practice integrates analysis and synthesis into a comprehensive design challenge: stabilizing an unstable plant and ensuring robust performance. Starting with a system containing a right-half-plane pole, you will use computational tools to design a controller that meets a suite of modern specifications, including sensitivity peak, noise attenuation, and classical gain and phase margins. This exercise demonstrates the complete workflow of a control engineer, from theoretical design to numerical verification using Bode plots [@problem_id:2690827].", "problem": "You are given an open-loop plant with one Right-Half-Plane (RHP) pole. The plant transfer function is\n$$\nP(s) \\;=\\; \\frac{s + 1}{(s - 1)(s + 3)} \\, ,\n$$\nwhich has an unstable pole at $s = +1$. You will form the loop transfer function $L(s)$ by multiplying $P(s)$ with a controller $C(s)$ of the form\n$$\nC(s) \\;=\\; k \\cdot \\frac{s/z + 1}{s/p + 1} \\cdot \\frac{1}{s/\\omega_f + 1} \\;=\\; k \\cdot \\frac{s + z}{s + p} \\cdot \\frac{\\omega_f}{s + \\omega_f} \\, ,\n$$\nwhere $k \\in \\mathbb{R}$ is a scalar gain, and $z$, $p$, $\\omega_f$ are positive real constants (all frequencies in $\\mathrm{rad/s}$). Thus\n$$\nL(s) \\;=\\; C(s) P(s) \\, ,\\quad S(s) \\;=\\; \\frac{1}{1 + L(s)} \\, ,\\quad T(s) \\;=\\; \\frac{L(s)}{1 + L(s)} \\, .\n$$\n\nYour task is to construct Bode magnitude and phase data for $L(j\\omega)$ and then, using only first principles and core definitions of Bode-plot-based robustness measures, compute and verify the following performance and robustness metrics:\n\n- Closed-loop internal stability: all poles of the characteristic polynomial of $1 + L(s)$ must have strictly negative real parts.\n- Sensitivity peak: the maximum value of $\\lvert S(j\\omega)\\rvert$ over a logarithmically spaced frequency grid must not exceed $2.0$.\n- High-frequency noise attenuation: the value $\\lvert T(j\\omega_{\\mathrm{na}})\\rvert$ at $\\omega_{\\mathrm{na}} = 100$ $\\mathrm{rad/s}$ must be less than or equal to $0.5$.\n- Phase margin (in degrees): compute the standard Bode phase margin as $180 + \\angle L(j\\omega_{\\mathrm{gc}})$ at the lowest positive unity-gain crossover $\\omega_{\\mathrm{gc}}$ where $\\lvert L(j\\omega_{\\mathrm{gc}})\\rvert = 1$. The phase margin must be greater than or equal to $35$ degrees. Angles must be expressed in degrees.\n- Gain margin (in decibels): compute the gain margin as the reciprocal of the magnitude at any phase crossover where $\\angle L(j\\omega) = -180^\\circ + 360^\\circ m$ for some integer $m$, expressed in decibels as $20 \\log_{10}(\\mathrm{GM})$. If there is no such phase crossover, take the gain margin to be $+\\infty$ in decibels. The gain margin must be greater than or equal to $6$ decibels, where an infinite gain margin is considered acceptable.\n\nFundamental base and definitions to use:\n\n- The Bode magnitude and phase are defined pointwise from the complex frequency response $L(j\\omega)$.\n- The sensitivity and complementary sensitivity are defined pointwise as $S(j\\omega) = 1/(1 + L(j\\omega))$ and $T(j\\omega) = L(j\\omega)/(1 + L(j\\omega))$.\n- The unity-gain crossover is any $\\omega_{\\mathrm{gc}}  0$ such that $\\lvert L(j\\omega_{\\mathrm{gc}})\\rvert = 1$; use the lowest such frequency if multiple exist.\n- The phase margin at $\\omega_{\\mathrm{gc}}$ is $180$ degrees plus the phase of $L(j\\omega_{\\mathrm{gc}})$ expressed in degrees.\n- The gain margin is computed at any frequency $\\omega$ where the phase is $-180$ degrees modulo $360$ degrees; it is the reciprocal of the magnitude at that frequency, expressed in decibels. If no such crossing exists, the gain margin is $+\\infty$ decibels.\n\nImplementation requirements:\n\n- Use a logarithmically spaced frequency grid $\\omega \\in [10^{-3}, 10^{3}]$ $\\mathrm{rad/s}$ with at least $4096$ points to approximate all frequency-domain quantities.\n- Angles must be computed and reported in degrees. Frequencies are in $\\mathrm{rad/s}$.\n- Stability must be checked by forming the closed-loop characteristic polynomial of $1 + L(s)$ and verifying all its roots have strictly negative real parts.\n- Interpolate linearly on a suitable scale when locating crossover frequencies.\n\nTest suite:\n\nEvaluate the following three controller parameter sets $(k, z, p, \\omega_f)$:\n\n- Case A (happy path): $(k, z, p, \\omega_f) = (-20.0, 0.5, 5.0, 50.0)$.\n- Case B (near boundary): $(k, z, p, \\omega_f) = (-8.0, 0.5, 5.0, 80.0)$.\n- Case C (edge case): $(k, z, p, \\omega_f) = (50.0, 0.5, 5.0, 50.0)$.\n\nFor each case, your program must output a boolean indicating whether all acceptance conditions are simultaneously satisfied:\n- closed-loop internal stability is true,\n- $\\max_{\\omega} \\lvert S(j\\omega)\\rvert \\le 2.0$,\n- $\\lvert T(j100)\\rvert \\le 0.5$,\n- phase margin $\\ge 35$ degrees and defined,\n- gain margin $\\ge 6$ decibels (an infinite gain margin counts as acceptable).\n\nFinal output format:\n\nYour program should produce a single line of output containing the three boolean results for the cases A, B, C as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True]\"). No other text must be printed. All angles must be in degrees and all frequencies in $\\mathrm{rad/s}$, but the output consists only of booleans as specified.", "solution": "The problem presented is a well-defined exercise in classical control theory. It is scientifically grounded, objective, and contains all necessary information to proceed with a rigorous analysis. The problem is therefore deemed valid.\n\nThe task is to evaluate three sets of controller parameters $(k, z, p, \\omega_f)$ for a given plant $P(s)$ against five performance and robustness criteria. The plant is specified as $P(s) = \\frac{s + 1}{(s - 1)(s + 3)}$, possessing an unstable pole at $s = 1$. The controller has the form $C(s) = k \\cdot \\frac{s + z}{s + p} \\cdot \\frac{\\omega_f}{s + \\omega_f}$. The open-loop transfer function is $L(s) = C(s)P(s)$.\n\nA systematic procedure is designed to verify each parameter set against the specified requirements. The final verdict for each case is true if and only if all five conditions are met simultaneously.\n\nStep 1: Closed-Loop Internal Stability Analysis\nThe fundamental requirement is the stability of the closed-loop system. The poles of the closed-loop system are the roots of the characteristic equation $1 + L(s) = 0$. This is equivalent to finding the roots of the numerator of $1 + L(s)$. Let this characteristic polynomial be $D_{CL}(s)$.\n$$\n1 + L(s) = 1 + k \\omega_f \\frac{(s+z)(s+1)}{(s+p)(s+\\omega_f)(s-1)(s+3)} = 0\n$$\n$$\nD_{CL}(s) = (s+p)(s+\\omega_f)(s-1)(s+3) + k \\omega_f (s+z)(s+1) = 0\n$$\nThis is a fourth-order polynomial in $s$, $D_{CL}(s) = c_4s^4 + c_3s^3 + c_2s^2 + c_1s + c_0$, with coefficients:\n$$\n\\begin{align*}\nc_4 = 1 \\\\\nc_3 = p + \\omega_f + 2 \\\\\nc_2 = 2p + 2\\omega_f + p\\omega_f + k\\omega_f - 3 \\\\\nc_1 = 2p\\omega_f - 3p - 3\\omega_f + k\\omega_f(z+1) \\\\\nc_0 = k\\omega_f z - 3p\\omega_f\n\\end{align*}\n$$\nFor each parameter set $(k, z, p, \\omega_f)$, these coefficients are computed, and the roots of the polynomial are found numerically. The system is internally stable if and only if all roots have strictly negative real parts, i.e., $\\mathrm{Re}(\\lambda)  0$ for all roots $\\lambda$ of $D_{CL}(s)$.\n\nStep 2: Frequency Response Generation\nAll frequency-domain metrics are derived from the complex frequency response $L(j\\omega)$. A logarithmically spaced frequency grid $\\omega$ is generated over the interval $[10^{-3}, 10^3]$ $\\mathrm{rad/s}$ with $4096$ points. At each frequency $\\omega_i$ on this grid, the complex value $L(j\\omega_i)$ is computed. From this, the magnitude $|L(j\\omega_i)|$ and phase $\\angle L(j\\omega_i)$ are obtained. The phase is numerically unwrapped to ensure continuity across the $\\pm 180^\\circ$ boundary, which is crucial for correctly identifying phase crossovers.\n\nStep 3: Verification of Performance Metrics\nThe following performance metrics are checked:\n- Sensitivity Peak: The sensitivity function is computed pointwise as $S(j\\omega) = 1/(1 + L(j\\omega))$. The peak sensitivity is the maximum value of its magnitude over the frequency grid, $M_S = \\max_{\\omega} |S(j\\omega)|$. The condition is $M_S \\le 2.0$.\n- High-Frequency Noise Attenuation: The complementary sensitivity function is $T(j\\omega) = L(j\\omega)/(1 + L(j\\omega))$. Its magnitude is evaluated at the specified noise attenuation frequency $\\omega_{\\mathrm{na}} = 100$ $\\mathrm{rad/s}$. The condition is $|T(j100)| \\le 0.5$.\n\nStep 4: Verification of Robustness Margins\nThe standard Bode margins are computed and checked:\n- Phase Margin (PM): The unity-gain crossover frequency, $\\omega_{\\mathrm{gc}}$, is the lowest frequency at which $|L(j\\omega_{\\mathrm{gc}})| = 1$. This frequency is found by searching for the first interval $[\\omega_i, \\omega_{i+1}]$ on the grid where the magnitude in decibels, $20\\log_{10}|L(j\\omega)|$, crosses $0$. The precise value of $\\omega_{\\mathrm{gc}}$ is found by linear interpolation of $\\log_{10}(\\omega)$ versus the magnitude in decibels. The phase at this crossover frequency, $\\angle L(j\\omega_{\\mathrm{gc}})$, is then found by linear interpolation of $\\log_{10}(\\omega)$ versus the unwrapped phase in degrees. The phase margin is defined as $PM = 180^\\circ + \\angle L(j\\omega_{\\mathrm{gc}})$. The condition is $PM \\ge 35^\\circ$. If no unity-gain crossover exists, the PM is undefined, and the condition is not met.\n- Gain Margin (GM): The phase crossover frequencies, $\\omega_{\\mathrm{pc}}$, are any frequencies where the phase is $\\angle L(j\\omega_{\\mathrm{pc}}) = -180^\\circ + m \\cdot 360^\\circ$ for any integer $m$. All such crossings are found on the grid. For each crossing, the precise $\\omega_{\\mathrm{pc}}$ is determined via linear interpolation of $\\log_{10}(\\omega)$ versus phase. The magnitude $|L(j\\omega_{\\mathrm{pc}})|$ is then found by interpolating the magnitude (in decibels) at $\\omega_{\\mathrm{pc}}$. The gain margin for that crossing, in decibels, is $GM_{\\mathrm{dB}} = -20\\log_{10}|L(j\\omega_{\\mathrm{pc}})|$. If multiple phase crossovers exist, the system gain margin is the minimum of all computed margins, as this represents the most restrictive stability bound. The condition is that this minimum $GM \\ge 6$ $\\mathrm{dB}$. If no phase crossover is found, the gain margin is taken to be $+\\infty$, which satisfies the condition.\n\nStep 5: Final Evaluation\nFor each of the three test cases, all five criteria—stability, sensitivity peak, noise attenuation, phase margin, and gain margin—are evaluated as described. The final result for a given case is `True` if all five conditions pass, and `False` otherwise. This entire procedure is implemented in the provided program.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_case(k, z, p, omega_f):\n    \"\"\"\n    Analyzes a given controller configuration against a set of five criteria.\n\n    Args:\n        k (float): Controller gain.\n        z (float): Controller zero.\n        p (float): Controller pole.\n        omega_f (float): Controller filter pole frequency.\n\n    Returns:\n        bool: True if all criteria are met, False otherwise.\n    \"\"\"\n    # 1. Internal Stability Check\n    # Characteristic polynomial: D_CL(s) = 1 + L(s) = 0\n    # D_CL(s) = (s+p)(s+omega_f)(s-1)(s+3) + k*omega_f*(s+z)(s+1)\n    # D_CL(s) = c4*s^4 + c3*s^3 + c2*s^2 + c1*s + c0\n    c4 = 1.0\n    c3 = p + omega_f + 2.0\n    c2 = 2.0 * p + 2.0 * omega_f + p * omega_f + k * omega_f - 3.0\n    c1 = 2.0 * p * omega_f - 3.0 * p - 3.0 * omega_f + k * omega_f * (z + 1.0)\n    c0 = k * omega_f * z - 3.0 * p * omega_f\n    \n    coeffs = [c4, c3, c2, c1, c0]\n    roots = np.roots(coeffs)\n    is_stable = np.all(np.real(roots)  0)\n\n    # 2. Frequency Response Generation\n    omega = np.logspace(-3, 3, 4096)\n    s = 1j * omega\n\n    # L(s) = C(s)P(s) = k * (s+z)/(s+p) * w_f/(s+w_f) * (s+1)/((s-1)(s+3))\n    P_s = (s + 1.0) / ((s - 1.0) * (s + 3.0))\n    C_s = k * (s + z) / (s + p) * omega_f / (s + omega_f)\n    L_jw = C_s * P_s\n\n    # 3. Sensitivity Peak Check\n    S_jw = 1.0 / (1.0 + L_jw)\n    max_S = np.max(np.abs(S_jw))\n    s_peak_ok = max_S = 2.0\n\n    # 4. High-Frequency Noise Attenuation Check\n    s_na = 1j * 100.0\n    P_na = (s_na + 1.0) / ((s_na - 1.0) * (s_na + 3.0))\n    C_na = k * (s_na + z) / (s_na + p) * omega_f / (s_na + omega_f)\n    L_na = C_na * P_na\n    T_na = L_na / (1.0 + L_na)\n    noise_atten_ok = np.abs(T_na) = 0.5\n\n    mag_db = 20.0 * np.log10(np.abs(L_jw))\n    phase_rad_unwrapped = np.unwrap(np.angle(L_jw))\n    phase_deg_unwrapped = np.rad2deg(phase_rad_unwrapped)\n    log_omega = np.log10(omega)\n\n    # 5. Phase Margin Check\n    pm_ok = False\n    # Find all crossings of 0 dB from above\n    gc_indices = np.where((mag_db[:-1] = 0)  (mag_db[1:]  0))[0]\n    if gc_indices.size  0:\n        # Use the lowest frequency crossover\n        idx = gc_indices[0]\n        # Interpolate to find omega_gc on a log-freq scale\n        log_omega_gc = np.interp(0.0, [mag_db[idx + 1], mag_db[idx]], [log_omega[idx + 1], log_omega[idx]])\n        # Interpolate phase at omega_gc\n        phase_at_gc = np.interp(log_omega_gc, log_omega, phase_deg_unwrapped)\n        pm = 180.0 + phase_at_gc\n        pm_ok = pm = 35.0\n\n    # 6. Gain Margin Check\n    gm_ok = False\n    all_gms_db = []\n    # Test for phase crossings at -180, -540, -900, ... degrees\n    min_phase = np.min(phase_deg_unwrapped)\n    target_phases = np.arange(-180.0, min_phase - 1.0, -360.0)\n\n    for target_phase in target_phases:\n        pc_indices = np.where(np.diff(np.sign(phase_deg_unwrapped - target_phase)) != 0)[0]\n        for idx in pc_indices:\n            # Interpolate to find omega_pc on a log-freq scale\n            log_omega_pc = np.interp(target_phase, \n                                     [phase_deg_unwrapped[idx], phase_deg_unwrapped[idx+1]], \n                                     [log_omega[idx], log_omega[idx+1]])\n            # Interpolate magnitude at omega_pc\n            mag_db_at_pc = np.interp(log_omega_pc, log_omega, mag_db)\n            gm_db = -mag_db_at_pc\n            all_gms_db.append(gm_db)\n    \n    if not all_gms_db: # No phase crossovers found\n        gm_ok = True  # Infinite GM is acceptable\n    else:\n        min_gm_db = min(all_gms_db)\n        if min_gm_db = 6.0:\n            gm_ok = True\n\n    return is_stable and s_peak_ok and noise_atten_ok and pm_ok and gm_ok\n\ndef solve():\n    test_cases = [\n        (-20.0, 0.5, 5.0, 50.0), # Case A\n        (-8.0, 0.5, 5.0, 80.0),  # Case B\n        (50.0, 0.5, 5.0, 50.0),  # Case C\n    ]\n\n    results = []\n    for k_val, z_val, p_val, omega_f_val in test_cases:\n        result = analyze_case(k_val, z_val, p_val, omega_f_val)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2690827"}]}