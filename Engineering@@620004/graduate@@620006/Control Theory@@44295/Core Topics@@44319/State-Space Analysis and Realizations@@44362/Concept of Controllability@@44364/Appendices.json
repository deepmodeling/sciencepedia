{"hands_on_practices": [{"introduction": "The most fundamental method for determining if a linear time-invariant (LTI) system is controllable is the Kalman rank condition. This test requires constructing the controllability matrix $\\mathcal{C}$, whose columns span the entire reachable subspace if the system is controllable. This exercise [@problem_id:2694383] provides a direct, hands-on application of this test, allowing you to build the matrix from the system's $A$ and $B$ matrices and determine controllability by calculating its rank.", "problem": "Consider a continuous-time Linear Time-Invariant (LTI) state-space system defined by the differential equation $\\dot{x}(t)=A x(t)+B u(t)$, where $x(t) \\in \\mathbb{R}^{2}$ and $u(t) \\in \\mathbb{R}$. Let\n$$\nA=\\begin{bmatrix}1  0 \\\\ 0  2\\end{bmatrix}, \\quad B=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}.\n$$\nUse the definition of controllability as the property that every state can be reached from the origin in finite time by some admissible input, and standard linear algebra facts about subspaces generated by repeated actions of $A$ on $B$, to explicitly construct a basis for the reachable subspace. From this construction, assemble the controllability matrix $C$ that spans this subspace and determine whether the system is controllable by computing the rank of $C$. Report your final answer as the rank value $r$ of $C$. No rounding is required, and no units are involved. Your final answer must be a single real number.", "solution": "The problem provided is a standard exercise in linear control theory and is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We shall proceed with the analysis.\n\nThe system under consideration is a continuous-time Linear Time-Invariant (LTI) system described by the state-space equation $\\dot{x}(t) = A x(t) + B u(t)$. The state vector $x(t)$ is in $\\mathbb{R}^{2}$, which implies the dimension of the state space is $n=2$. The input $u(t)$ is a scalar, $u(t) \\in \\mathbb{R}$. The system matrices are given as:\n$$\nA = \\begin{bmatrix} 1  0 \\\\ 0  2 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThe problem requires us to determine the controllability of the system. A fundamental result in control theory, the Kalman rank condition, states that an LTI system is completely state controllable if and only if its controllability matrix has full rank, i.e., $\\text{rank}(C) = n$.\n\nThe problem directs us to first construct a basis for the reachable subspace. The reachable subspace, $\\mathcal{R}$, is the set of all states that can be reached from the origin in finite time. For an LTI system, this subspace is spanned by the columns of the controllability matrix. This subspace is also characterized as the smallest $A$-invariant subspace containing the image of $B$, denoted $\\text{Im}(B)$. It is given by the span of the vectors generated by repeated application of $A$ to the columns of $B$:\n$$\n\\mathcal{R} = \\text{span}\\{B, AB, A^2B, \\dots, A^{n-1}B\\}\n$$\nFor this problem, the dimension of the state space is $n=2$. Therefore, the reachable subspace is spanned by the column vectors of $B$ and $AB$. Let us compute these vectors.\n\nThe first vector is the column of the matrix $B$:\n$$\nv_1 = B = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThe second vector is obtained by applying the state matrix $A$ to the vector $v_1$:\n$$\nv_2 = AB = \\begin{bmatrix} 1  0 \\\\ 0  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} (1)(1) + (0)(1) \\\\ (0)(1) + (2)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\n$$\nThe reachable subspace $\\mathcal{R}$ is therefore $\\text{span}\\{v_1, v_2\\} = \\text{span}\\left\\{ \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}, \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} \\right\\}$.\n\nTo form a basis for this subspace, we must verify that the vectors $v_1$ and $v_2$ are linearly independent. We check if there exists a non-zero scalar $k$ such that $v_2 = k v_1$.\n$$\n\\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} = k \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThis vector equation yields a system of two linear equations:\n$1 = k \\cdot 1 \\implies k=1$\n$2 = k \\cdot 1 \\implies k=2$\nThe requirement that $k=1$ and $k=2$ simultaneously is a contradiction. Thus, the vectors $v_1$ and $v_2$ are linearly independent. Since we have a set of two linearly independent vectors in a $2$-dimensional space $\\mathbb{R}^2$, they form a basis for $\\mathbb{R}^2$. This means the reachable subspace is the entire state space, $\\mathcal{R} = \\mathbb{R}^2$.\n\nThe controllability matrix $C$ is constructed by concatenating these basis vectors:\n$$\nC = \\begin{bmatrix} B  AB \\end{bmatrix} = \\begin{bmatrix} v_1  v_2 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 1  2 \\end{bmatrix}\n$$\nThe final task is to determine the rank of $C$, which we denote by $r$. The rank of a matrix is the dimension of the space spanned by its columns. As we have already established that the two columns of the $2 \\times 2$ matrix $C$ are linearly independent, the rank of $C$ must be $2$.\n\nAn alternative method to determine the rank of a square matrix is to compute its determinant. A matrix has full rank if and only if its determinant is non-zero.\n$$\n\\det(C) = \\det\\left(\\begin{bmatrix} 1  1 \\\\ 1  2 \\end{bmatrix}\\right) = (1)(2) - (1)(1) = 2 - 1 = 1\n$$\nSince $\\det(C) = 1 \\neq 0$, the matrix $C$ is of full rank. The rank of $C$ is $r=2$. Because the rank of the controllability matrix ($r=2$) is equal to the dimension of the state space ($n=2$), the system is completely controllable. The problem asks for the rank value $r$.", "answer": "$$\n\\boxed{2}\n$$", "id": "2694383"}, {"introduction": "While the Kalman rank test provides a clear \"yes\" or \"no\" answer, the Popov-Belevitch-Hautus (PBH) test offers a deeper, physical insight into why a system might be uncontrollable. It connects controllability to the system's eigenstructure, testing whether any of the system's natural modes are 'orthogonal' to the input's influence. This practice [@problem_id:2694430] will guide you through this eigenstructure-based analysis, strengthening your intuition about the relationship between system modes and control authority.", "problem": "Consider the linear time-invariant state-space system defined by the pair $\\left(A,B\\right)$ with\n$$\nA=\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix},\\quad B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix}.\n$$\nStarting from the definition of controllability for a linear time-invariant system $\\dot{x}=Ax+Bu$ and using the eigenstructure-based criterion that underlies the Popov–Belevitch–Hautus (PBH) test, determine the dimension of the controllable subspace of the pair $\\left(A,B\\right)$. Express your final answer as a single integer with no units.", "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n- The system is a linear time-invariant (LTI) state-space model: $\\dot{x}=Ax+Bu$.\n- State matrix: $A=\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix}$.\n- Input matrix: $B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix}$.\n- The task is to determine the dimension of the controllable subspace of the pair $(A,B)$.\n- The required method is the eigenstructure-based criterion underlying the Popov–Belevitch–Hautus (PBH) test.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in linear control theory. All necessary data are provided, and the matrices are mathematically consistent. No scientific principles are violated. The problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\nThe concept of controllability for an LTI system concerns the ability of an external input $u(t)$ to move the internal state $x(t)$ from any initial state to any final state within a finite time. The controllable subspace is the set of all states that can be reached from the origin. Its dimension quantifies the extent of this controllability.\n\nThe Popov–Belevitch–Hautus (PBH) test provides a criterion for controllability based on the eigenstructure of the system. A system is completely controllable if and only if for every eigenvalue $\\lambda$ of the matrix $A$, the rank of the matrix $[A - \\lambda I, B]$ is equal to the dimension of the state space, $n$.\n\nThe problem demands the use of the fundamental criterion that underlies this test. This criterion states that an LTI system is uncontrollable if and only if there exists a left eigenvector of the matrix $A$ that is orthogonal to the columns of the matrix $B$. A left eigenvector $v$ corresponding to an eigenvalue $\\lambda$ satisfies the relation $v^H A = \\lambda v^H$, where $v^H$ is the conjugate transpose of $v$. For real matrices, this simplifies to $v^T A = \\lambda v^T$, which is equivalent to $A^T v = \\lambda v$. An uncontrollable mode associated with $\\lambda$ exists if and only if there is a non-zero vector $v$ such that $A^T v = \\lambda v$ and $v^T B = 0$.\n\nThe dimension of the controllable subspace is $n - k$, where $n$ is the dimension of the state space and $k$ is the number of linearly independent left eigenvectors of $A$ that are orthogonal to the columns of $B$.\n\nFirst, we determine the dimension of the state space. The state matrix $A$ is a $2 \\times 2$ matrix, so the state dimension is $n=2$.\n\nNext, we find the eigenvalues of the matrix $A$. The characteristic equation is given by $\\det(A - \\lambda I) = 0$.\n$$\n\\det\\left(\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix} - \\lambda\\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}\\right) = \\det\\begin{bmatrix}-\\lambda  1\\\\ -2  -3-\\lambda\\end{bmatrix} = 0\n$$\n$$\n(-\\lambda)(-3-\\lambda) - (1)(-2) = 0\n$$\n$$\n\\lambda^2 + 3\\lambda + 2 = 0\n$$\nFactoring this quadratic equation yields:\n$$\n(\\lambda+1)(\\lambda+2) = 0\n$$\nThe eigenvalues of $A$ are $\\lambda_1 = -1$ and $\\lambda_2 = -2$.\n\nNow, we must find the left eigenvectors for each of these eigenvalues. A left eigenvector $v$ for an eigenvalue $\\lambda$ is an eigenvector of $A^T$ corresponding to the same eigenvalue $\\lambda$. The transpose of $A$ is:\n$$\nA^T = \\begin{bmatrix}0  -2\\\\ 1  -3\\end{bmatrix}\n$$\n\nFor $\\lambda_1 = -1$, we seek a vector $v_1$ such that $(A^T - \\lambda_1 I)v_1 = 0$:\n$$\n(A^T + 1 \\cdot I)v_1 = \\begin{bmatrix}0+1  -2\\\\ 1  -3+1\\end{bmatrix}\\begin{bmatrix}v_{11}\\\\ v_{12}\\end{bmatrix} = \\begin{bmatrix}1  -2\\\\ 1  -2\\end{bmatrix}\\begin{bmatrix}v_{11}\\\\ v_{12}\\end{bmatrix} = \\begin{bmatrix}0\\\\ 0\\end{bmatrix}\n$$\nThis gives the equation $v_{11} - 2v_{12} = 0$, or $v_{11} = 2v_{12}$. A representative left eigenvector is $v_1 = \\begin{bmatrix}2\\\\ 1\\end{bmatrix}$.\n\nFor $\\lambda_2 = -2$, we seek a vector $v_2$ such that $(A^T - \\lambda_2 I)v_2 = 0$:\n$$\n(A^T + 2 \\cdot I)v_2 = \\begin{bmatrix}0+2  -2\\\\ 1  -3+2\\end{bmatrix}\\begin{bmatrix}v_{21}\\\\ v_{22}\\end{bmatrix} = \\begin{bmatrix}2  -2\\\\ 1  -1\\end{bmatrix}\\begin{bmatrix}v_{21}\\\\ v_{22}\\end{bmatrix} = \\begin{bmatrix}0\\\\ 0\\end{bmatrix}\n$$\nThis gives the equation $v_{21} - v_{22} = 0$, or $v_{21} = v_{22}$. A representative left eigenvector is $v_2 = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$.\n\nThe next step is to test the orthogonality condition $v^T B = 0$ for each left eigenvector. The input matrix is $B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix}$.\n\nFor $v_1 = \\begin{bmatrix}2\\\\ 1\\end{bmatrix}$:\n$$\nv_1^T B = \\begin{bmatrix}2  1\\end{bmatrix}\\begin{bmatrix}1\\\\ 0\\end{bmatrix} = (2)(1) + (1)(0) = 2\n$$\nSince $v_1^T B \\neq 0$, the mode associated with the eigenvalue $\\lambda_1 = -1$ is controllable.\n\nFor $v_2 = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$:\n$$\nv_2^T B = \\begin{bmatrix}1  1\\end{bmatrix}\\begin{bmatrix}1\\\\ 0\\end{bmatrix} = (1)(1) + (1)(0) = 1\n$$\nSince $v_2^T B \\neq 0$, the mode associated with the eigenvalue $\\lambda_2 = -2$ is controllable.\n\nNeither of the left eigenvectors of $A$ is orthogonal to the input matrix $B$. Therefore, there are no uncontrollable modes. The dimension of the uncontrollable subspace is $k=0$.\n\nThe dimension of the controllable subspace is $n - k = 2 - 0 = 2$. This means the system is completely controllable, and the controllable subspace spans the entire state space $\\mathbb{R}^2$.", "answer": "$$\\boxed{2}$$", "id": "2694430"}, {"introduction": "Verifying controllability is often the first step; the next is to leverage this property for controller design. A key result states that any controllable system can be transformed into a standard, simplified structure known as the controllability canonical form. This exercise [@problem_id:2694418] demonstrates this powerful consequence by having you construct the exact similarity transformation that achieves this canonical form, a foundational technique for methods such as state-feedback pole placement.", "problem": "Consider the continuous-time linear time-invariant (LTI) system $\\dot{x} = A x + B u$ with state dimension $n = 3$ and single input $m = 1$, where\n$$\nA = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n-1  -2  -3\n\\end{pmatrix},\n\\quad\nB = \\begin{pmatrix}\n0 \\\\\n1 \\\\\n1\n\\end{pmatrix}.\n$$\nStarting only from core definitions (namely, controllability, the controllability matrix, and the reachable subspace) and without using any pre-packaged transformation formulas, do the following:\n\n1. Using the concept of controllability chains generated by the input vector, construct a similarity transformation $T \\in \\mathbb{R}^{3 \\times 3}$ and an input transformation $U \\in \\mathbb{R}$ that place the controllable pair $(A,B)$ into the controllability canonical (controllable companion) form with input placed in the first state, that is, into a pair $(\\bar{A},\\bar{B})$ where\n$$\n\\bar{B} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix},\n\\qquad\n\\bar{A} = \\begin{pmatrix}\n0  0  \\star \\\\\n1  0  \\star \\\\\n0  1  \\star\n\\end{pmatrix},\n$$\nwith the $\\star$ entries determined by your construction from first principles.\n\n2. Verify your construction by direct multiplication, i.e., show that $T^{-1} A T = \\bar{A}$ and $T^{-1} B U = \\bar{B}$.\n\n3. Report the exact value of $\\det(T)$.\n\nExpress the final answer as the exact integer value of $\\det(T)$. No rounding is required, and no units are involved. The final answer must be a single real number.", "solution": "The problem requires the construction of a similarity transformation matrix $T \\in \\mathbb{R}^{3 \\times 3}$ and an input transformation scalar $U \\in \\mathbb{R}$ to convert a given linear time-invariant (LTI) system into controllability canonical form.\n\nFirst, we must validate the problem statement. The system is defined by the state-space equation $\\dot{x} = Ax + Bu$, with matrices:\n$$\nA = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n-1  -2  -3\n\\end{pmatrix},\n\\quad\nB = \\begin{pmatrix}\n0 \\\\\n1 \\\\\n1\n\\end{pmatrix}\n$$\nThe state dimension is $n=3$ and the input dimension is $m=1$. The target canonical form is specified by the pair $(\\bar{A}, \\bar{B})$ where:\n$$\n\\bar{B} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix},\n\\qquad\n\\bar{A} = \\begin{pmatrix}\n0  0  \\star \\\\\n1  0  \\star \\\\\n0  1  \\star\n\\end{pmatrix}\n$$\nThe transformation is defined by a change of coordinates $x = T\\bar{x}$ and a change of input $u=U\\bar{u}$. Substituting these into the state equation yields:\n$$\nT\\dot{\\bar{x}} = A(T\\bar{x}) + B(U\\bar{u})\n$$\n$$\n\\dot{\\bar{x}} = (T^{-1}AT)\\bar{x} + (T^{-1}BU)\\bar{u}\n$$\nThis implies the relations $\\bar{A} = T^{-1}AT$ and $\\bar{B} = T^{-1}BU$.\n\nA prerequisite for this transformation is that the system must be controllable. Controllability is assessed by the rank of the controllability matrix $\\mathcal{C} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix}$.\nWe compute the columns of $\\mathcal{C}$:\n$$\nB = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nAB = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -1  -2  -3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -5 \\end{pmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -1  -2  -3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -5 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -5 \\\\ -1 - 2 + 15 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -5 \\\\ 12 \\end{pmatrix}\n$$\nThe controllability matrix is therefore:\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  1  1 \\\\ 1  1  -5 \\\\ 1  -5  12 \\end{pmatrix}\n$$\nThe determinant of $\\mathcal{C}$ is:\n$$\n\\det(\\mathcal{C}) = 0 \\cdot (12 - 25) - 1 \\cdot (12 - (-5)) + 1 \\cdot (-5 - 1) = -1(17) + 1(-6) = -23\n$$\nSince $\\det(\\mathcal{C}) = -23 \\neq 0$, the matrix has full rank $n=3$, and the system is controllable. The problem is valid and a solution exists.\n\nThe problem demands a construction based on \"controllability chains generated by the input vector\". This is a direct instruction to use the vectors $B, AB, A^2B, \\dots$ to form the basis of the transformation. The most direct interpretation is to construct the transformation matrix $T$ using these vectors as its columns. Let the columns of $T$ be $t_1, t_2, t_3$.\n$$\nT = \\begin{pmatrix} t_1  t_2  t_3 \\end{pmatrix} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix} = \\mathcal{C}\n$$\nSo, we define the similarity transformation matrix as:\n$$\nT = \\begin{pmatrix} 0  1  1 \\\\ 1  1  -5 \\\\ 1  -5  12 \\end{pmatrix}\n$$\nWith $T$ now fixed, we determine the input transformation $U$. The relation is $\\bar{B} = T^{-1}BU$, and the target is $\\bar{B} = e_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n$$\ne_1 = \\mathcal{C}^{-1}BU\n$$\nBy the very construction of the controllability matrix $\\mathcal{C}$, its first column is $B$. Thus, $\\mathcal{C}e_1 = B$. Multiplying by $\\mathcal{C}^{-1}$ from the left gives $\\mathcal{C}^{-1}B = e_1$.\nSubstituting this into the equation for $U$ gives:\n$$\ne_1 = (e_1)U\n$$\nSince $U$ is a scalar ($m=1$), this immediately implies $U=1$.\n\nNow, we verify the transformation and determine the unknown entries in $\\bar{A}$.\nThe transformed state matrix is $\\bar{A} = T^{-1}AT = \\mathcal{C}^{-1}A\\mathcal{C}$.\nWe have:\n$$\nA\\mathcal{C} = A \\begin{pmatrix} B  AB  A^2B \\end{pmatrix} = \\begin{pmatrix} AB  A^2B  A^3B \\end{pmatrix}\n$$\nTo find $A^3B$, we use the Cayley-Hamilton theorem. The characteristic polynomial of $A$ is $p_A(\\lambda)=\\det(\\lambda I - A)$.\n$$\np_A(\\lambda) = \\det \\begin{pmatrix} \\lambda  -1  0 \\\\ 0  \\lambda  -1 \\\\ 1  2  \\lambda+3 \\end{pmatrix} = \\lambda(\\lambda(\\lambda+3) - (-2)) - (-1)(0 - (-1)) = \\lambda(\\lambda^2+3\\lambda+2) - 1\n$$\n$$\np_A(\\lambda) = \\lambda^3 + 3\\lambda^2 + 2\\lambda - 1\n$$\nBy the Cayley-Hamilton theorem, $p_A(A) = 0$, so $A^3 + 3A^2 + 2A - I = 0$, which implies $A^3 = -3A^2 - 2A + I$.\nApplying this to $B$:\n$$\nA^3B = (-3A^2 - 2A + I)B = -3A^2B - 2AB + B\n$$\nWe can express $A\\mathcal{C}$ in terms of the columns of $\\mathcal{C}$:\n$$\nA\\mathcal{C} = \\begin{pmatrix} AB  A^2B  B - 2AB - 3A^2B \\end{pmatrix} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 1  0  -2 \\\\ 0  1  -3 \\end{pmatrix}\n$$\nThis shows $A\\mathcal{C} = \\mathcal{C} \\bar{A}_{computed}$, where\n$$\n\\bar{A}_{computed} = \\begin{pmatrix} 0  0  1 \\\\ 1  0  -2 \\\\ 0  1  -3 \\end{pmatrix}\n$$\nMultiplying by $\\mathcal{C}^{-1}$ from the left gives $\\bar{A} = \\mathcal{C}^{-1}A\\mathcal{C} = \\bar{A}_{computed}$. This matrix perfectly matches the required structure $\\bar{A} = \\begin{pmatrix} 0  0  \\star \\\\ 1  0  \\star \\\\ 0  1  \\star \\end{pmatrix}$, with the star entries determined as $1, -2, -3$.\nThe construction is thus verified.\n\nThe final step is to report the determinant of the transformation matrix $T$.\n$$\n\\det(T) = \\det(\\mathcal{C}) = -23\n$$\nThis is an exact integer value as required.", "answer": "$$\\boxed{-23}$$", "id": "2694418"}]}