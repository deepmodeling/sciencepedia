{"hands_on_practices": [{"introduction": "The principle of duality offers more than just theoretical elegance; it provides a powerful shortcut in control system design. This exercise demonstrates the practical application of duality in the classic pole placement problem for a linear time-invariant system. By first designing a state-feedback controller and then explicitly using the dual formulation, you will see how the observer design problem for placing the eigenvalues of $A - L C$ transforms into a familiar controller design problem for a related system, reinforcing the deep structural connection between controllability and observability [@problem_id:2703047].", "problem": "Consider the following single-input single-output linear time-invariant (LTI) state-space model with state $x \\in \\mathbb{R}^{2}$, input $u \\in \\mathbb{R}$, and output $y \\in \\mathbb{R}$:\n$$\n\\dot{x} = A x + B u,\\quad y = C x,\n$$\nwhere\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\nYou are to design a full-state feedback and a full-order Luenberger observer. Use only the core definitions of controllability and observability and the fundamental fact that state feedback $u = -K x$ yields closed-loop matrix $A - B K$, and that the observer error dynamics are governed by $A - L C$. \n\nTask:\n- First, verify from first principles that the pair $(A,B)$ is controllable and the pair $(A,C)$ is observable.\n- Then, choose the desired closed-loop poles for the state-feedback as the complex conjugate pair $-1 \\pm 2 i$ and derive the unique real row vector $K = \\begin{pmatrix} k_{1} & k_{2} \\end{pmatrix}$ that assigns these poles to $A - B K$.\n- Finally, choose the desired observer error-dynamics poles as the same complex conjugate pair $-1 \\pm 2 i$ and derive the unique real column vector $L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}$ that assigns these poles to $A - L C$. Your reasoning should make explicit use of the duality between controllability and observability at the level of matrices and characteristic polynomials.\n\nReport your final answer as a single row vector $\\big(k_{1},\\,k_{2},\\,l_{1},\\,l_{2}\\big)$. No numerical rounding is required, and no units are involved. The final answer must be a single row in the order specified.", "solution": "Before a solution is attempted, the problem statement must be rigorously validated.\n\nGivens are extracted verbatim:\nA single-input single-output linear time-invariant (LTI) state-space model is given by $\\dot{x} = A x + B u$ and $y = C x$.\nThe state is $x \\in \\mathbb{R}^{2}$, input is $u \\in \\mathbb{R}$, and output is $y \\in \\mathbb{R}$.\nThe system matrices are specified as:\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\nA full-state feedback controller with law $u = -K x$ is to be designed, where the gain is a real row vector $K = \\begin{pmatrix} k_{1} & k_{2} \\end{pmatrix}$. The desired closed-loop poles for the state-feedback are the complex conjugate pair $-1 \\pm 2 i$.\nA full-order Luenberger observer is to be designed, where the gain is a real column vector $L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}$. The desired observer error-dynamics poles are also $-1 \\pm 2 i$.\nThe tasks are to: 1) verify controllability of $(A,B)$ and observability of $(A,C)$ from first principles; 2) derive the unique gain $K$; and 3) derive the unique gain $L$ by making explicit use of the duality between controllability and observability.\n\nValidation of the problem statement:\nThe problem is a standard, well-defined exercise in linear control systems theory. It is scientifically grounded, using fundamental concepts such as state-space representation, controllability, observability, pole placement, and duality. All necessary information is provided, and the dimensions of the matrices ($A$ is $2 \\times 2$, $B$ is $2 \\times 1$, $C$ is $1 \\times 2$) are consistent. The problem is objective, free of ambiguity, and mathematically formalizable. There are no violations of physical principles or logical inconsistencies. The problem is therefore deemed **valid**. We proceed with the solution.\n\nThe solution is constructed in three parts as requested.\n\nFirst, we verify controllability and observability from first principles.\nThe system is controllable if and only if its controllability matrix, $\\mathcal{C}$, has full rank. For a system of dimension $n=2$, the controllability matrix is $\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix}$.\nWe compute the product $AB$:\n$$ AB = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -3 \\end{pmatrix} $$\nThe controllability matrix is then formed:\n$$ \\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & -3 \\end{pmatrix} $$\nThe rank of $\\mathcal{C}$ is determined by its determinant.\n$$ \\det(\\mathcal{C}) = (0)(-3) - (1)(1) = -1 $$\nSince $\\det(\\mathcal{C}) = -1 \\neq 0$, the matrix $\\mathcal{C}$ has rank $2$, which is the dimension of the state space. Therefore, the pair $(A,B)$ is controllable.\n\nThe system is observable if and only if its observability matrix, $\\mathcal{O}$, has full rank. For $n=2$, the observability matrix is $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$.\nWe compute the product $CA$:\n$$ CA = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (0)(-2) & (1)(1) + (0)(-3) \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\end{pmatrix} $$\nThe observability matrix is:\n$$ \\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = I_{2} $$\nwhere $I_2$ is the $2 \\times 2$ identity matrix. The determinant is $\\det(\\mathcal{O}) = 1 \\neq 0$. Thus, $\\mathcal{O}$ has full rank, and the pair $(A,C)$ is observable.\n\nSecond, we design the state-feedback gain $K$ for pole placement.\nThe closed-loop system with state feedback $u=-Kx$ has dynamics governed by the matrix $A_{cl} = A-BK$. The eigenvalues of $A_{cl}$ are the roots of its characteristic polynomial, $\\chi_{cl}(s) = \\det(sI - (A-BK))$.\nWe compute the matrix $A-BK$:\n$$ A-BK = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} k_{1} & k_{2} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ k_{1} & k_{2} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -2-k_{1} & -3-k_{2} \\end{pmatrix} $$\nThe characteristic polynomial is:\n$$ \\chi_{cl}(s) = \\det \\begin{pmatrix} s & -1 \\\\ 2+k_{1} & s+3+k_{2} \\end{pmatrix} = s(s+3+k_{2}) - (-1)(2+k_{1}) = s^{2} + (3+k_{2})s + (2+k_{1}) $$\nThe desired poles are $-1+2i$ and $-1-2i$. The corresponding desired characteristic polynomial is:\n$$ \\chi_{des}(s) = (s - (-1+2i))(s - (-1-2i)) = ((s+1)-2i)((s+1)+2i) = (s+1)^{2} - (2i)^{2} = s^{2}+2s+1 - (-4) = s^{2}+2s+5 $$\nEquating the coefficients of $\\chi_{cl}(s)$ and $\\chi_{des}(s)$:\nFor the $s^1$ term: $3+k_{2} = 2$, which implies $k_{2} = -1$.\nFor the $s^0$ term: $2+k_{1} = 5$, which implies $k_{1} = 3$.\nThe state-feedback gain vector is $K = \\begin{pmatrix} 3 & -1 \\end{pmatrix}$.\n\nThird, we design the observer gain $L$ using the principle of duality.\nThe observer error dynamics are governed by the matrix $A_{obs} = A-LC$. The pole placement problem for the observer is to choose $L$ such that the eigenvalues of $A-LC$ are at a desired location. The duality principle asserts that the pair $(A,C)$ is observable if and only if the dual pair $(A^{T}, C^{T})$ is controllable. The problem of finding an observer gain $L$ for the system $(A,C)$ is dual to finding a state-feedback gain $K_{dual}$ for the system with matrices $(A^{T}, C^{T})$. The eigenvalues of $A-LC$ are identical to the eigenvalues of its transpose, $(A-LC)^{T} = A^{T} - C^{T}L^{T}$.\nWe can solve the observer problem by finding a state-feedback gain $K_{dual} = L^{T}$ for the dual system defined by state matrix $A' = A^{T}$ and input matrix $B' = C^{T}$.\nThe dual system matrices are:\n$$ A' = A^{T} = \\begin{pmatrix} 0 & -2 \\\\ 1 & -3 \\end{pmatrix}, \\quad B' = C^{T} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\nWe seek a gain $K' = \\begin{pmatrix} k'_{1} & k'_{2} \\end{pmatrix}$ for this dual system, where $L^{T} = \\begin{pmatrix} l_{1} & l_{2} \\end{pmatrix} = K'$. The closed-loop matrix for the dual system is $A' - B'K'$.\n$$ A' - B'K' = \\begin{pmatrix} 0 & -2 \\\\ 1 & -3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} l_{1} & l_{2} \\end{pmatrix} = \\begin{pmatrix} 0 & -2 \\\\ 1 & -3 \\end{pmatrix} - \\begin{pmatrix} l_{1} & l_{2} \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} -l_{1} & -2-l_{2} \\\\ 1 & -3 \\end{pmatrix} $$\nThe characteristic polynomial of the observer error, $\\chi_{obs}(s)$, is the characteristic polynomial of this dual closed-loop system:\n$$ \\chi_{obs}(s) = \\det(sI - (A' - B'K')) = \\det \\begin{pmatrix} s+l_{1} & 2+l_{2} \\\\ -1 & s+3 \\end{pmatrix} = (s+l_{1})(s+3) + (2+l_{2}) = s^{2}+(3+l_{1})s+(3l_{1}+l_{2}+2) $$\nThe desired observer poles are $-1 \\pm 2i$, which correspond to the same desired characteristic polynomial $\\chi_{des}(s) = s^{2}+2s+5$.\nEquating coefficients:\nFor the $s^1$ term: $3+l_{1} = 2$, which implies $l_{1} = -1$.\nFor the $s^0$ term: $3l_{1}+l_{2}+2 = 5$.\nSubstituting $l_{1}=-1$ into the second equation gives $3(-1)+l_{2}+2 = 5$, which simplifies to $-3+l_{2}+2 = 5$, or $-1+l_{2}=5$. This yields $l_{2} = 6$.\nThe gain for the dual problem is $L^{T} = K' = \\begin{pmatrix} -1 & 6 \\end{pmatrix}$. The observer gain is the transpose of this vector:\n$$ L = (L^{T})^{T} = \\begin{pmatrix} -1 \\\\ 6 \\end{pmatrix} $$\nThus, the components are $l_{1}=-1$ and $l_{2}=6$.\n\nThe problem requires a final answer as a single row vector $(k_{1}, k_2, l_{1}, l_{2})$.\nFrom our derivations, $k_{1}=3$, $k_{2}=-1$, $l_{1}=-1$, and $l_{2}=6$.\nThe resultant vector is $\\begin{pmatrix} 3 & -1 & -1 & 6 \\end{pmatrix}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 3 & -1 & -1 & 6 \\end{pmatrix}}\n$$", "id": "2703047"}, {"introduction": "Before designing a controller or observer, one must first verify that the system is controllable and observable, but the standard Kalman rank test can be numerically unreliable. This practice explores a system that is analytically controllable yet numerically ill-conditioned, highlighting the superiority of the Popov-Belevitch-Hautus (PBH) test. You will rigorously certify controllability and then, using duality, observability, gaining crucial insight into the practical challenges of numerical computation in control theory [@problem_id:2703025].", "problem": "Consider the linear time-invariant state-space system in continuous time given by the state equation $\\dot{x}(t) = A x(t) + B u(t)$ with\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix},\n$$\nwhere $\\varepsilon$ is a nonzero real parameter with $|\\varepsilon| \\ll 1$. Let $S(\\varepsilon)$ denote the Kalman controllability matrix constructed from $(A,B)$, and let $C = B^{\\top}$ so that the output equation is $y(t) = C x(t)$. \n\nUsing only foundational definitions and standard rank tests from linear systems theory, do the following:\n\n1. From first principles, construct $S(\\varepsilon)$ and analyze its conditioning as $|\\varepsilon| \\to 0$. Explain why numerical rank tests on $S(\\varepsilon)$ can be unreliable for small $|\\varepsilon|$ even when the system is controllable.\n2. Apply the Popov-Belevitch-Hautus (PBH) test for controllability to $(A,B)$ and rigorously certify controllability for all admissible $\\varepsilon$ by checking the appropriate rank condition at the eigenvalues of $A$.\n3. Apply the dual Popov-Belevitch-Hautus test for observability to $(A,C)$ and rigorously certify observability for all admissible $\\varepsilon$ by checking the appropriate rank condition at the eigenvalues of $A$.\n\nAnswer specification: Report the exact, closed-form symbolic expression for $\\det\\!\\big(S(\\varepsilon)\\big)$ as a function of $\\varepsilon$. No numerical rounding is required, and no units are needed. The final answer must be a single expression.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed within the domain of linear systems control theory. It requests an analysis of controllability and observability for a specified linear time-invariant system. The premises are factually sound, and the questions are objective and formalizable. Therefore, a solution will be provided.\n\nThe system is described by the state equation $\\dot{x}(t) = A x(t) + B u(t)$, where the state is $x(t) \\in \\mathbb{R}^{2}$ and the input is $u(t) \\in \\mathbb{R}$. The given matrices are:\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}\n$$\nThe parameter $\\varepsilon$ is a nonzero real number, with the condition $|\\varepsilon| \\ll 1$ provided for analytical context regarding numerical stability. The output matrix is defined as $C = B^{\\top} = \\begin{pmatrix} 1 & \\varepsilon \\end{pmatrix}$.\n\nWe proceed with the three required analyses.\n\n1.  Construction and analysis of the Kalman controllability matrix $S(\\varepsilon)$.\n    For a system with state dimension $n=2$, the Kalman controllability matrix is constructed as $S(\\varepsilon) = \\begin{pmatrix} B & AB \\end{pmatrix}$. We must first compute the product $AB$:\n    $$\n    AB = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 1 \\cdot \\varepsilon \\\\ 0 \\cdot 1 + 1 \\cdot \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1 + \\varepsilon \\\\ \\varepsilon \\end{pmatrix}\n    $$\n    Now, we construct the matrix $S(\\varepsilon)$ by concatenating the vectors $B$ and $AB$:\n    $$\n    S(\\varepsilon) = \\begin{pmatrix} 1 & 1+\\varepsilon \\\\ \\varepsilon & \\varepsilon \\end{pmatrix}\n    $$\n    A fundamental theorem of control theory states that the system is controllable if and only if the controllability matrix has full rank. For this $2 \\times 2$ matrix, this condition is equivalent to its determinant being nonzero. We compute the determinant:\n    $$\n    \\det\\!\\big(S(\\varepsilon)\\big) = (1)(\\varepsilon) - (1+\\varepsilon)(\\varepsilon) = \\varepsilon - \\varepsilon - \\varepsilon^2 = -\\varepsilon^2\n    $$\n    The problem specifies that $\\varepsilon$ is a nonzero real parameter. Therefore, $\\det\\!\\big(S(\\varepsilon)\\big) = -\\varepsilon^2 \\neq 0$ for all admissible values of $\\varepsilon$. Analytically, the system is controllable.\n\n    However, the problem requires an analysis of conditioning as $|\\varepsilon| \\to 0$. As $\\varepsilon$ approaches $0$, the determinant $\\det\\!\\big(S(\\varepsilon)\\big)$ approaches $0$. A matrix whose determinant is near zero is known as nearly singular or ill-conditioned. In numerical computation, which uses finite-precision arithmetic, rank is often determined by examining the singular values. The singular values of $S(\\varepsilon)$ are the square roots of the eigenvalues of $S(\\varepsilon)^{\\top}S(\\varepsilon)$. Let us examine the column vectors of $S(\\varepsilon)$: $v_1 = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}$ and $v_2 = \\begin{pmatrix} 1+\\varepsilon \\\\ \\varepsilon \\end{pmatrix}$. As $\\varepsilon \\to 0$, $v_1 \\to \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ and $v_2 \\to \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The two column vectors become nearly collinear. A numerical algorithm attempting to compute the rank of $S(\\varepsilon)$ for a very small $\\varepsilon$ (e.g., smaller than machine epsilon) might compute one of the singular values to be effectively zero, thus incorrectly concluding that the matrix is rank-deficient and the system is uncontrollable. This is a classic example where direct application of a numerical rank test on the Kalman matrix can fail due to ill-conditioning, even when the system is analytically controllable.\n\n2.  Application of the Popov-Belevitch-Hautus (PBH) test for controllability.\n    The PBH test provides a more numerically stable alternative for assessing controllability. The pair $(A,B)$ is controllable if and only if the matrix $\\begin{pmatrix} \\lambda I - A & B \\end{pmatrix}$ has full row rank for every eigenvalue $\\lambda$ of $A$. The rank must be equal to the state dimension, which is $n=2$.\n\n    First, we find the eigenvalues of $A$. Since $A$ is an upper triangular matrix, its eigenvalues are its diagonal entries. Thus, we have a repeated eigenvalue $\\lambda_1 = \\lambda_2 = 1$. We need to check the PBH rank condition only for $\\lambda=1$.\n\n    We construct the PBH matrix for $\\lambda=1$:\n    $$\n    M_c = \\begin{pmatrix} 1 \\cdot I - A & B \\end{pmatrix} = \\left( \\begin{array}{cc|c} 1 - 1 & -1 & 1 \\\\ 0 & 1-1 & \\varepsilon \\end{array} \\right) = \\left( \\begin{array}{cc|c} 0 & -1 & 1 \\\\ 0 & 0 & \\varepsilon \\end{array} \\right)\n    $$\n    This is a $2 \\times 3$ matrix. We must check if it has rank $2$. The rank of a matrix is the number of linearly independent rows. The rows are $r_1 = \\begin{pmatrix} 0 & -1 & 1 \\end{pmatrix}$ and $r_2 = \\begin{pmatrix} 0 & 0 & \\varepsilon \\end{pmatrix}$. Since $\\varepsilon \\neq 0$, the second row $r_2$ is not a zero vector. The first row $r_1$ is also not a zero vector. Furthermore, $r_1$ is not a scalar multiple of $r_2$ (and vice-versa). Therefore, the two rows are linearly independent. The rank of $M_c$ is $2$.\n    Since the PBH matrix has full row rank for the only eigenvalue of $A$, the system is rigorously certified as controllable for all $\\varepsilon \\neq 0$. This test does not suffer from the same numerical issue as the Kalman matrix test because it does not involve the formation of a nearly singular matrix.\n\n3.  Application of the dual PBH test for observability.\n    The concept of duality states that the pair $(A, C)$ is observable if and only if the dual pair $(A^{\\top}, C^{\\top})$ is controllable. The PBH test for observability states that the pair $(A, C)$ is observable if and only if the matrix $\\begin{pmatrix} \\lambda I - A \\\\ C \\end{pmatrix}$ has full column rank (equal to $n=2$) for every eigenvalue $\\lambda$ of $A$.\n\n    The output matrix is $C = B^{\\top} = \\begin{pmatrix} 1 & \\varepsilon \\end{pmatrix}$. The eigenvalue of $A$ is $\\lambda=1$.\n    We construct the observability PBH matrix for $\\lambda=1$:\n    $$\n    M_o = \\begin{pmatrix} 1 \\cdot I - A \\\\ C \\end{pmatrix} = \\begin{pmatrix} 0 & -1 \\\\ 0 & 0 \\\\ \\hline 1 & \\varepsilon \\end{pmatrix}\n    $$\n    This is a $3 \\times 2$ matrix. We must check if it has rank $2$. The rank is the number of linearly independent columns. The columns are $w_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ and $w_2 = \\begin{pmatrix} -1 \\\\ 0 \\\\ \\varepsilon \\end{pmatrix}$.\n    To check for linear independence, we seek solutions to the equation $c_1 w_1 + c_2 w_2 = 0$:\n    $$\n    c_1 \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} + c_2 \\begin{pmatrix} -1 \\\\ 0 \\\\ \\varepsilon \\end{pmatrix} = \\begin{pmatrix} -c_2 \\\\ 0 \\\\ c_1 + c_2 \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n    $$\n    From the first component, we must have $-c_2 = 0$, which implies $c_2 = 0$. Substituting this into the third component equation gives $c_1 + 0 \\cdot \\varepsilon = 0$, which implies $c_1 = 0$.\n    The only solution is the trivial one, $c_1 = 0$ and $c_2 = 0$. Thus, the columns are linearly independent, and the rank of $M_o$ is $2$.\n    Since the observability PBH matrix has full column rank for the only eigenvalue of $A$, the pair $(A,C)$ is observable. This holds for all real values of $\\varepsilon$, including $\\varepsilon = 0$. The observability of this system does not degrade as $|\\varepsilon| \\to 0$.\n\nThe final answer requested is the symbolic expression for $\\det\\!\\big(S(\\varepsilon)\\big)$. Based on the calculation in the first part, this is $-\\varepsilon^2$.", "answer": "$$\n\\boxed{-\\varepsilon^{2}}\n$$", "id": "2703025"}, {"introduction": "The duality principle extends beyond simple checks for controllability and observability to reveal a profound symmetry in the internal structure of linear systems. This exercise guides you through the process of performing a Kalman decomposition, which partitions the state space into four fundamental subspaces based on their control and observation properties. By constructing this decomposition for both a primal system and its dual, you will witness firsthand how the dimensions and roles of these subspaces are mirrored, providing a concrete understanding of the deep structural implications of duality [@problem_id:2703050].", "problem": "Consider the linear time-invariant (LTI) system defined by the state-space matrices\n$$\nA=\\begin{pmatrix}\n2 & 0 & 0 & 0\\\\\n0 & -1 & 0 & 0\\\\\n0 & 0 & 3 & 0\\\\\n0 & 0 & 0 & 7\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n1 & 0 & 1 & 0\n\\end{pmatrix}.\n$$\nUsing only the fundamental definitions of controllability and observability for linear time-invariant systems and the construction of the Kalman decomposition from the reachable subspace and the unobservable subspace, perform the following tasks without invoking any shortcut formulas beyond those definitions:\n\n1) Determine the dimensions and explicit spanning sets of the controllable subspace and the observable subspace of the given system.\n\n2) From these, identify the four Kalman subspaces: controllable–observable, controllable–unobservable, uncontrollable–observable, and uncontrollable–unobservable. Construct a change-of-basis matrix $T$ whose columns form a basis ordered as controllable–observable first, then controllable–unobservable, then uncontrollable–observable, and finally uncontrollable–unobservable.\n\n3) Compute the transformed triple $(A_{k},B_{k},C_{k})$ with $A_{k}=T^{-1}AT$, $B_{k}=T^{-1}B$, and $C_{k}=CT$, and exhibit the block structure that corresponds to the Kalman decomposition in this ordering.\n\n4) Form the dual system $(A^{\\top},C^{\\top},B^{\\top})$. Using the same first-principles approach, determine the corresponding four subspaces for the dual and verify the block correspondence under duality, namely that the controllable–unobservable block in the original corresponds in dimension to the uncontrollable–observable block in the dual, and vice versa, while the controllable–observable and uncontrollable–unobservable blocks correspond to themselves under duality.\n\nFinally, let $A_{co}$ and $A_{uu}$ denote the controllable–observable and uncontrollable–unobservable diagonal blocks of $A_{k}$, respectively. Compute the scalar\n$$\ns \\equiv \\det(A_{co})\\cdot \\det(A_{uu}).\n$$\nReport only the value of $s$ as your final answer. No rounding is required.", "solution": "The problem presented is a standard exercise in linear systems theory concerning controllability, observability, and the Kalman canonical decomposition. It is scientifically grounded, well-posed, and all necessary information is provided. We shall proceed with a rigorous, step-by-step solution based on fundamental principles as demanded. The state-space is of dimension $n=4$.\n\nFirst, we determine the controllable and observable subspaces for the given linear time-invariant (LTI) system.\nThe system is defined by the matrices:\n$$\nA=\\begin{pmatrix}\n2 & 0 & 0 & 0\\\\\n0 & -1 & 0 & 0\\\\\n0 & 0 & 3 & 0\\\\\n0 & 0 & 0 & 7\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n1 & 0 & 1 & 0\n\\end{pmatrix}\n$$\n\nThe controllable subspace, denoted $\\mathcal{C}$, is the reachable subspace from the origin, which for an LTI system is the image of the controllability matrix $\\mathcal{M}_c = \\begin{pmatrix} B & AB & A^2B & \\dots & A^{n-1}B \\end{pmatrix}$. For $n=4$, we compute the columns:\n$B = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$AB = \\begin{pmatrix} 2 & 0 & 0 & 0\\\\ 0 & -1 & 0 & 0\\\\ 0 & 0 & 3 & 0\\\\ 0 & 0 & 0 & 7 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$A^2B = A(AB) = \\begin{pmatrix} 4 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$A^3B = A(A^2B) = \\begin{pmatrix} 8 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\nThe controllability matrix is thus:\n$$ \\mathcal{M}_c = \\begin{pmatrix} 1 & 2 & 4 & 8 \\\\ 1 & -1 & 1 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\nThe image of $\\mathcal{M}_c$ is spanned by its linearly independent columns. The first two columns are linearly independent, and the remaining columns are linear combinations of the first two. The subspace is spanned by the vectors $(1, 1, 0, 0)^\\top$ and $(2, -1, 0, 0)^\\top$. This is equivalent to the span of the standard basis vectors $e_1 = (1, 0, 0, 0)^\\top$ and $e_2 = (0, 1, 0, 0)^\\top$.\nTherefore, the controllable subspace is $\\mathcal{C} = \\text{span}\\{e_1, e_2\\}$, and its dimension is $\\dim(\\mathcal{C})=2$.\n\nNext, we find the unobservable subspace, $\\mathcal{N}$, defined as the kernel of the observability matrix $\\mathcal{M}_o = \\begin{pmatrix} C^\\top & (CA)^\\top & (CA^2)^\\top & \\dots & (CA^{n-1})^\\top \\end{pmatrix}^\\top$. We compute the rows:\n$C = \\begin{pmatrix} 1 & 0 & 1 & 0 \\end{pmatrix}$\n$CA = \\begin{pmatrix} 1 & 0 & 1 & 0 \\end{pmatrix}A = \\begin{pmatrix} 2 & 0 & 3 & 0 \\end{pmatrix}$\n$CA^2 = (CA)A = \\begin{pmatrix} 4 & 0 & 9 & 0 \\end{pmatrix}$\n$CA^3 = (CA^2)A = \\begin{pmatrix} 8 & 0 & 27 & 0 \\end{pmatrix}$\nThe observability matrix is:\n$$ \\mathcal{M}_o = \\begin{pmatrix} 1 & 0 & 1 & 0 \\\\ 2 & 0 & 3 & 0 \\\\ 4 & 0 & 9 & 0 \\\\ 8 & 0 & 27 & 0 \\end{pmatrix} $$\nThe unobservable subspace $\\mathcal{N}$ is the set of all vectors $x = (x_1, x_2, x_3, x_4)^\\top$ such that $\\mathcal{M}_o x = 0$. The system of equations implies $x_1+x_3=0$ and $2x_1+3x_3=0$, which has the unique solution $x_1=0, x_3=0$. There are no constraints on $x_2$ and $x_4$. Thus, any vector in $\\mathcal{N}$ is of the form $(0, x_2, 0, x_4)^\\top$.\nThe unobservable subspace is $\\mathcal{N} = \\text{span}\\{e_2, e_4\\}$, and its dimension is $\\dim(\\mathcal{N})=2$.\nThe observable subspace $\\mathcal{O}$ is the orthogonal complement of the unobservable subspace, $\\mathcal{O}=\\mathcal{N}^\\perp$. Thus, $\\mathcal{O} = (\\text{span}\\{e_2, e_4\\})^\\perp = \\text{span}\\{e_1, e_3\\}$, and its dimension is $\\dim(\\mathcal{O})=2$.\n\nWith $\\mathcal{C}$ and $\\mathcal{N}$ determined, we construct the four Kalman subspaces:\n1. Controllable-observable subspace: $S_{co} = \\mathcal{C} \\cap \\mathcal{O} = \\text{span}\\{e_1, e_2\\} \\cap \\text{span}\\{e_1, e_3\\} = \\text{span}\\{e_1\\}$.\n2. Controllable-unobservable subspace: $S_{cu} = \\mathcal{C} \\cap \\mathcal{N} = \\text{span}\\{e_1, e_2\\} \\cap \\text{span}\\{e_2, e_4\\} = \\text{span}\\{e_2\\}$.\n3. Uncontrollable-observable subspace: $S_{uo} = \\mathcal{C}^\\perp \\cap \\mathcal{O} = \\text{span}\\{e_3, e_4\\} \\cap \\text{span}\\{e_1, e_3\\} = \\text{span}\\{e_3\\}$.\n4. Uncontrollable-unobservable subspace: $S_{uu} = \\mathcal{C}^\\perp \\cap \\mathcal{N} = \\text{span}\\{e_3, e_4\\} \\cap \\text{span}\\{e_2, e_4\\} = \\text{span}\\{e_4\\}$.\nEach subspace is of dimension $1$. A basis for the entire state space, ordered according to the Kalman decomposition $\\{S_{co}, S_{cu}, S_{uo}, S_{uu}\\}$, is $\\{e_1, e_2, e_3, e_4\\}$. The change-of-basis matrix $T$ formed by these column vectors is the identity matrix $T=I_4$.\n\nThe transformed state-space representation $(A_k, B_k, C_k)$ is given by $A_k=T^{-1}AT$, $B_k=T^{-1}B$, and $C_k=CT$. Since $T=I_4$, the transformed system is identical to the original system: $(A_k, B_k, C_k) = (A, B, C)$. The state variables are already decoupled according to the Kalman subspaces. We exhibit the block structure:\n$$ A_k = A = \\begin{pmatrix} 2 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 0 \\\\ 0 & 0 & 3 & 0 \\\\ 0 & 0 & 0 & 7 \\end{pmatrix} = \\begin{pmatrix} A_{co} & 0 & 0 & 0 \\\\ 0 & A_{cu} & 0 & 0 \\\\ 0 & 0 & A_{uo} & 0 \\\\ 0 & 0 & 0 & A_{uu} \\end{pmatrix} $$\n$$ B_k = B = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} B_{co} \\\\ B_{cu} \\\\ 0 \\\\ 0 \\end{pmatrix} \\quad C_k = C = \\begin{pmatrix} 1 & 0 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} C_{co} & 0 & C_{uo} & 0 \\end{pmatrix} $$\nThe individual blocks are:\n$A_{co} = (2)$, $A_{cu} = (-1)$, $A_{uo} = (3)$, $A_{uu} = (7)$.\n$B_{co} = (1)$, $B_{cu} = (1)$.\n$C_{co} = (1)$, $C_{uo} = (1)$.\nThe structure is block-diagonal as the Kalman subspaces are A-invariant, a consequence of $A$ being diagonal.\n\nNow we analyze the dual system $(\\tilde{A}, \\tilde{B}, \\tilde{C})=(A^\\top, C^\\top, B^\\top)$.\n$\\tilde{A} = A^\\top = A$.\n$\\tilde{B} = C^\\top = (1, 0, 1, 0)^\\top$.\n$\\tilde{C} = B^\\top = (1, 1, 0, 0)$.\nThe controllable subspace of the dual system, $\\tilde{\\mathcal{C}}$, is the image of $\\tilde{\\mathcal{M}}_c = \\begin{pmatrix} \\tilde{B} & \\tilde{A}\\tilde{B} & \\dots \\end{pmatrix}$.\n$\\tilde{A}\\tilde{B} = A C^\\top = (2, 0, 3, 0)^\\top$.\nThe columns of $\\tilde{\\mathcal{M}}_c$ span the same subspace as $(1, 0, 1, 0)^\\top$ and $(2, 0, 3, 0)^\\top$, which is $\\text{span}\\{e_1, e_3\\}$. So, $\\tilde{\\mathcal{C}} = \\text{span}\\{e_1, e_3\\}$. This is identical to the original system's observable subspace $\\mathcal{O}$, as predicted by duality theory. $\\dim(\\tilde{\\mathcal{C}}) = 2$.\nThe unobservable subspace of the dual system, $\\tilde{\\mathcal{N}}$, is the kernel of its observability matrix $\\tilde{\\mathcal{M}}_o$, whose rows are $\\tilde{C}, \\tilde{C}\\tilde{A}, \\dots$.\n$\\tilde{C}\\tilde{A} = B^\\top A = (2, -1, 0, 0)$.\nThe kernel is for vectors $x$ where $x_1+x_2=0$ and $2x_1-x_2=0$, which implies $x_1=0, x_2=0$. Thus $\\tilde{\\mathcal{N}} = \\text{span}\\{e_3, e_4\\}$. The observable subspace of the dual is $\\tilde{\\mathcal{O}} = \\tilde{\\mathcal{N}}^\\perp = \\text{span}\\{e_1, e_2\\}$, which is identical to the original system's controllable subspace $\\mathcal{C}$.\n\nThe Kalman subspaces for the dual system are:\n$\\tilde{S}_{co} = \\tilde{\\mathcal{C}} \\cap \\tilde{\\mathcal{O}} = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_1, e_2\\} = \\text{span}\\{e_1\\}$.\n$\\tilde{S}_{cu} = \\tilde{\\mathcal{C}} \\cap \\tilde{\\mathcal{N}} = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_3, e_4\\} = \\text{span}\\{e_3\\}$.\n$\\tilde{S}_{uo} = \\tilde{\\mathcal{C}}^\\perp \\cap \\tilde{\\mathcal{O}} = \\text{span}\\{e_2, e_4\\} \\cap \\text{span}\\{e_1, e_2\\} = \\text{span}\\{e_2\\}$.\n$\\tilde{S}_{uu} = \\tilde{\\mathcal{C}}^\\perp \\cap \\tilde{\\mathcal{N}} = \\text{span}\\{e_2, e_4\\} \\cap \\text{span}\\{e_3, e_4\\} = \\text{span}\\{e_4\\}$.\nThe dimensions are all $1$. We verify the correspondence:\n$\\dim(S_{co})=1$ corresponds to $\\dim(\\tilde{S}_{co})=1$.\n$\\dim(S_{cu})=1$ corresponds to $\\dim(\\tilde{S}_{uo})=1$.\n$\\dim(S_{uo})=1$ corresponds to $\\dim(\\tilde{S}_{cu})=1$.\n$\\dim(S_{uu})=1$ corresponds to $\\dim(\\tilde{S}_{uu})=1$.\nThe duality correspondence is confirmed.\n\nFinally, we compute the scalar $s \\equiv \\det(A_{co})\\cdot \\det(A_{uu})$.\nFrom the decomposition of $A_k$, we have the $1\\times1$ matrices $A_{co}=(2)$ and $A_{uu}=(7)$.\nThe determinants are $\\det(A_{co}) = 2$ and $\\det(A_{uu}) = 7$.\nThe product is $s = 2 \\cdot 7 = 14$.", "answer": "$$\n\\boxed{14}\n$$", "id": "2703050"}]}