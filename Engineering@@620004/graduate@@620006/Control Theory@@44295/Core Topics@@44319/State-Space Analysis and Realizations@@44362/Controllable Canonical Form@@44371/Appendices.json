{"hands_on_practices": [{"introduction": "The journey into controllable canonical form begins with the fundamental skill of its construction. This exercise [@problem_id:2697097] guides you through deriving the controllable canonical state-space realization directly from a system's transfer function, $G(s)$. This process establishes a direct and systematic link between the external input-output description and a specific, structured internal model, which is a cornerstone of modern control design.", "problem": "Consider a real-coefficient Single-Input Single-Output (SISO) strictly proper transfer function of order three,\n$$\nG(s)=\\frac{b_{0}s^{2}+b_{1}s+b_{2}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}},\n$$\nwith real parameters $a_{0},a_{1},a_{2},b_{0},b_{1},b_{2}$. Starting from the foundational definitions of state-space realizations and transfer functions, and without appealing to pre-memorized canonical templates, construct a minimal controllable canonical form realization $(A,B,C,D)$ that realizes $G(s)$, using a state basis that makes the controllability matrix in a companion-like form. Then, using only this realization and the definition of impulse response, determine the exact closed-form expression for the second derivative at zero of the impulse response $h(t)$, namely $h''(0^{+})$, expressed purely in terms of $a_{0},a_{1},a_{2},b_{0},b_{1},b_{2}$. Your final answer must be a single analytical expression. No numerical rounding is required, and no units are needed.", "solution": "The problem requires the derivation of a minimal controllable canonical form realization for a given Single-Input Single-Output (SISO) transfer function, and then to use this realization to find the second derivative of the impulse response at time $t=0^{+}$.\n\nThe given transfer function is\n$$ G(s) = \\frac{Y(s)}{U(s)} = \\frac{b_{0}s^{2}+b_{1}s+b_{2}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}} $$\nThis corresponds to the input-output relationship in the Laplace domain:\n$$ (s^{3}+a_{2}s^{2}+a_{1}s+a_{0})Y(s) = (b_{0}s^{2}+b_{1}s+b_{2})U(s) $$\n\nTo construct a state-space realization $(A, B, C, D)$ of the form $\\dot{x} = Ax + Bu$ and $y = Cx + Du$ from foundational principles, we must avoid derivatives of the input $u(t)$ in the state equation. We introduce an auxiliary variable $X(s)$ such that:\n$$ s^{3}+a_{2}s^{2}+a_{1}s+a_{0} = \\frac{U(s)}{X(s)} $$\nand\n$$ b_{0}s^{2}+b_{1}s+b_{2} = \\frac{Y(s)}{X(s)} $$\nFrom the first equation, we obtain a differential equation for an auxiliary variable $x(t) = \\mathcal{L}^{-1}\\{X(s)\\}$ that only involves the input $u(t)$:\n$$ U(s) = (s^{3}+a_{2}s^{2}+a_{1}s+a_{0})X(s) $$\nIn the time domain, this becomes:\n$$ \\frac{d^{3}x}{dt^{3}} + a_{2}\\frac{d^{2}x}{dt^{2}} + a_{1}\\frac{dx}{dt} + a_{0}x = u(t) $$\nWe are free to choose the state variables. To obtain the controllable canonical form, we define the state vector $x$ with components:\n$$ x_{1}(t) = x(t) $$\n$$ x_{2}(t) = \\frac{dx}{dt}(t) $$\n$$ x_{3}(t) = \\frac{d^{2}x}{dt^{2}}(t) $$\nThe state equations are derived from these definitions:\n$$ \\dot{x}_{1} = x_{2} $$\n$$ \\dot{x}_{2} = x_{3} $$\nAnd from the differential equation for $x(t)$:\n$$ \\dot{x}_{3} = \\frac{d^{3}x}{dt^{3}} = -a_{0}x_{1} - a_{1}x_{2} - a_{2}x_{3} + u(t) $$\nThese equations can be written in matrix form $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$:\n$$ \\begin{pmatrix} \\dot{x}_{1} \\\\ \\dot{x}_{2} \\\\ \\dot{x}_{3} \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -a_{0}  -a_{1}  -a_{2} \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} u(t) $$\nThus, the state matrix $A$ and input matrix $B$ are:\n$$ A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -a_{0}  -a_{1}  -a_{2} \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\nThe matrix $A$ is in companion form, as required for the controllable canonical form. This realization is guaranteed to be controllable. For it to be minimal, it must also be observable, which is equivalent to the transfer function having no pole-zero cancellations. We assume this is the case, as is standard for symbolically defined problems.\n\nNext, we derive the output equation. From our auxiliary variable definition, $Y(s) = (b_{0}s^{2}+b_{1}s+b_{2})X(s)$. Taking the inverse Laplace transform gives:\n$$ y(t) = b_{0}\\frac{d^{2}x}{dt^{2}} + b_{1}\\frac{dx}{dt} + b_{2}x $$\nSubstituting the state variable definitions, we get the output equation:\n$$ y(t) = b_{0}x_{3}(t) + b_{1}x_{2}(t) + b_{2}x_{1}(t) $$\nThis can be written in matrix form $y = C\\mathbf{x} + Du$:\n$$ y(t) = \\begin{pmatrix} b_{2}  b_{1}  b_{0} \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} $$\nSo the output matrix $C$ is:\n$$ C = \\begin{pmatrix} b_{2}  b_{1}  b_{0} \\end{pmatrix} $$\nThe given transfer function is strictly proper, as the degree of the numerator ($2$) is less than the degree of the denominator ($3$). This implies that the direct feedthrough term $D$ must be zero, i.e., $D=0$. Our derivation confirms this.\n\nThe constructed minimal controllable canonical form realization is $(A, B, C, D)$ with the matrices defined above.\n\nNow, we proceed to compute $h''(0^{+})$, the second derivative of the impulse response at $t=0^{+}$. The impulse response $h(t)$ is the output $y(t)$ of the system when the input is the Dirac delta function, $u(t) = \\delta(t)$, and the initial state is zero, $\\mathbf{x}(0^{-}) = \\mathbf{0}$.\nThe state equation is $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\delta(t)$. Integrating from $t=0^{-}$ to $t=0^{+}$:\n$$ \\int_{0^{-}}^{0^{+}} \\dot{\\mathbf{x}}(t) dt = \\int_{0^{-}}^{0^{+}} A\\mathbf{x}(t) dt + \\int_{0^{-}}^{0^{+}} B\\delta(t) dt $$\n$$ \\mathbf{x}(0^{+}) - \\mathbf{x}(0^{-}) = \\mathbf{0} + B $$\nSince $\\mathbf{x}(0^{-}) = \\mathbf{0}$, the initial state for the system's free evolution for $t0$ is $\\mathbf{x}(0^{+}) = B$.\n\nFor $t0$, the input $u(t)$ is zero, so the system dynamics are given by $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t)$. The solution to this homogeneous equation is $\\mathbf{x}(t) = e^{At}\\mathbf{x}(0^{+})$. The impulse response for $t0$ is thus:\n$$ h(t) = y(t) = C\\mathbf{x}(t) = C e^{At} \\mathbf{x}(0^{+}) = C e^{At} B $$\nTo find the derivatives, we differentiate $h(t)$ with respect to time:\n$$ h'(t) = \\frac{d}{dt}(C e^{At} B) = C \\frac{d}{dt}(e^{At}) B = C (A e^{At}) B = CAe^{At}B $$\n$$ h''(t) = \\frac{d}{dt}(CA e^{At} B) = CA \\frac{d}{dt}(e^{At}) B = CA(A e^{At}) B = CA^{2}e^{At}B $$\nWe evaluate these derivatives at $t=0^{+}$. Since $e^{A \\cdot 0} = I$ (the identity matrix), we have:\n$$ h''(0^{+}) = CA^{2}e^{A\\cdot 0}B = CA^{2}B $$\nNow we must compute this matrix product. First, we find $A^{2}B$:\n$$ AB = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -a_{0}  -a_{1}  -a_{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -a_{2} \\end{pmatrix} $$\n$$ A^{2}B = A(AB) = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -a_{0}  -a_{1}  -a_{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -a_{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -a_{2} \\\\ -a_{1} + a_2^{2} \\end{pmatrix} $$\nFinally, we pre-multiply by $C$ to find $h''(0^{+})$:\n$$ h''(0^{+}) = CA^{2}B = \\begin{pmatrix} b_{2}  b_{1}  b_{0} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -a_{2} \\\\ a_2^{2} - a_{1} \\end{pmatrix} $$\n$$ h''(0^{+}) = b_{2}(1) + b_{1}(-a_{2}) + b_{0}(a_2^{2} - a_{1}) $$\n$$ h''(0^{+}) = b_{2} - a_{2}b_{1} + b_{0}a_2^{2} - b_{0}a_{1} $$\nThis is the final analytical expression for the second derivative of the impulse response at $t=0^{+}$.", "answer": "$$ \\boxed{b_{0}a_2^{2} - b_{0}a_{1} - b_{1}a_{2} + b_{2}} $$", "id": "2697097"}, {"introduction": "Building a state-space model is one thing; understanding what it reveals about the system's intrinsic properties is another. This problem [@problem_id:1573658] delves into the crucial relationship between a transfer function's properties and the resulting state-space model's observability. By constructing a controllable canonical form for a system with a pole-zero cancellation, you will discover firsthand how a non-minimal transfer function leads to an unobservable state-space realization, providing a concrete example of a hidden internal dynamic.", "problem": "Consider a linear time-invariant (LTI) system described by the transfer function:\n$$G(s) = \\frac{s + a}{s^2 + (a+b)s + ab}$$\nwhere $Y(s)$ is the Laplace transform of the output signal $y(t)$, $U(s)$ is the Laplace transform of the input signal $u(t)$, and $a$ and $b$ are distinct positive real constants.\n\nFirst, determine the controllable canonical form of the state-space representation for this system. The state-space representation is defined by the equations $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B u(t)$ and $y(t) = C\\mathbf{x}(t) + D u(t)$.\n\nBased on this state-space representation, which of the following statements correctly describes the properties of the system?\n\nA. The system is controllable and observable.\n\nB. The system is controllable but unobservable.\n\nC. The system is uncontrollable but observable.\n\nD. The system is uncontrollable and unobservable.", "solution": "We are given the transfer function\n$$G(s) = \\frac{s + a}{s^{2} + (a + b)s + ab} = \\frac{s + a}{s^{2} + a_{1}s + a_{0}},$$\nwith $a_{1} = a + b$ and $a_{0} = ab$, and $a, b$ distinct positive constants. For the controllable canonical form of order two, choose\n$$A = \\begin{pmatrix} 0  1 \\\\ -a_{0}  -a_{1} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -ab  -(a + b) \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad D = 0,$$\nand let $C = \\begin{pmatrix} c_{1}  c_{2} \\end{pmatrix}$ be determined by matching the transfer function.\n\nCompute\n$$sI - A = \\begin{pmatrix} s  -1 \\\\ a_{0}  s + a_{1} \\end{pmatrix}, \\quad (sI - A)^{-1} = \\frac{1}{s^{2} + a_{1}s + a_{0}} \\begin{pmatrix} s + a_{1}  1 \\\\ -a_{0}  s \\end{pmatrix}.$$\nThus\n$$(sI - A)^{-1}B = \\frac{1}{s^{2} + a_{1}s + a_{0}} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix},$$\nand the transfer function is\n$$G(s) = C(sI - A)^{-1}B + D = \\frac{c_{2}s + c_{1}}{s^{2} + a_{1}s + a_{0}}.$$\nMatching to $G(s) = \\dfrac{s + a}{s^{2} + a_{1}s + a_{0}}$ yields $c_{2} = 1$ and $c_{1} = a$, so\n$$C = \\begin{pmatrix} a  1 \\end{pmatrix}, \\quad D = 0.$$\n\nTherefore, a controllable canonical state-space realization is\n$$A = \\begin{pmatrix} 0  1 \\\\ -ab  -(a + b) \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} a  1 \\end{pmatrix}, \\quad D = 0.$$\n\nControllability: The controllability matrix is\n$$\\mathcal{C} = \\begin{pmatrix} B  AB \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  -(a + b) \\end{pmatrix},$$\nwith determinant $\\det(\\mathcal{C}) = -1 \\neq 0$, hence the system is controllable.\n\nObservability: The observability matrix is\n$$\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} a  1 \\\\ -ab  -b \\end{pmatrix},$$\nwhose determinant is\n$$\\det(\\mathcal{O}) = a(-b) - 1(-ab) = -ab + ab = 0,$$\nso the system is unobservable. This unobservability is consistent with the pole-zero cancellation $G(s) = \\dfrac{s + a}{(s + a)(s + b)} = \\dfrac{1}{s + b}$, which removes the mode at $s = -a$ from the input-output map.\n\nHence, the correct statement is that the system is controllable but unobservable.", "answer": "$$\\boxed{B}$$", "id": "1573658"}, {"introduction": "Canonical forms are not just abstract mathematical tools; they are deeply connected to the analysis of real physical systems. This practice [@problem_id:2697134] bridges the gap between a \"natural\" state-space model derived from physical principles (like a motor-cart system) and the structured controllable canonical form. You will start with a non-canonical system matrix $A$ and, by applying first principles of controllability, construct the exact similarity transformation $T$ that converts the system into its canonical equivalent, demonstrating the universality of this form for any controllable linear system.", "problem": "Consider a single-input single-output (SISO) linear time-invariant mechanical–electromechanical model consisting of a unit-mass cart driven by a direct-current motor through a rack-and-pinion with viscous damping. The physical state variables are the cart position $x$, the motor armature current $i$, and the cart velocity $v$. With input voltage $u$, choose the naive ordering of the state vector as $s = [\\,x,\\ i,\\ v\\,]^{\\top}$ (rather than the commonly used phase-variable ordering). For parameter values $m = 1$, viscous coefficient $b = 2$, back-emf constant $k_{e} = 1$, torque constant $k_{t} = 1$, armature inductance $L = 1$, and armature resistance $R = 1$, the linearized state-space model in this naive ordering is\n$$\n\\dot{s} = A s + b\\, u,\\quad \nA = \\begin{pmatrix}\n0  0  1\\\\\n0  -1  -1\\\\\n0  1  -2\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}\n0\\\\\n1\\\\\n0\n\\end{pmatrix}.\n$$\nThis $A$ is not in a companion (controllable canonical) pattern under any trivial permutation of the coordinates, because the actuator state $i$ has been interposed between $x$ and $v$.\n\nUsing only foundational definitions from linear systems and controllability, do the following:\n- Establish that the pair $(A,b)$ is controllable.\n- Construct an exact similarity transformation $T$ that maps $(A,b)$ into the controllable canonical form with input vector $\\bar{b} = e_{1}$ and system matrix $\\bar{A}$ having ones on its subdiagonal (that is, the controllable Frobenius companion form).\n- Your construction must start from first principles: the definition of controllability, the controllability subspace, and basis change. Do not assume any pre-memorized formula for $T$; derive it by reasoning from the definitions.\n- Finally, compute the exact value of $\\det(T)$.\n\nAnswer format requirement: Provide the single real number $\\det(T)$ as your final answer. No rounding is required.", "solution": "We begin from fundamental definitions. For a SISO pair $(A,b)$ of dimension $n$, the controllability matrix is defined as\n$$\n\\mathcal{C} \\equiv \\begin{pmatrix} b  A b  \\cdots  A^{n-1} b \\end{pmatrix}.\n$$\nThe pair $(A,b)$ is controllable if and only if $\\mathop{\\mathrm{rank}}(\\mathcal{C}) = n$. Moreover, when $(A,b)$ is controllable, the ordered set $\\{b, A b, \\ldots, A^{n-1} b\\}$ is a basis of $\\mathbb{R}^{n}$. Expressing $A$ in this basis yields a matrix with ones on its subdiagonal and a final column determined by the unique coordinates of $A^{n} b$ in that basis. When the single-input single-output (SISO) pair is controllable (controllability index equal to $n$), this is the controllable Frobenius companion form, and the associated similarity transformation can be taken as the change-of-basis matrix whose columns are that basis.\n\nStep 1: Compute the controllability matrix and verify controllability.\nWe compute successively:\n$$\nb = \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix},\\quad\nA b = A \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix}.\n$$\nNext,\n$$\nA^{2} b = A (A b) = A \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix}\n= -\\,\\text{col}_{2}(A) + \\text{col}_{3}(A)\n= - \\begin{pmatrix} 0\\\\ -1\\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1\\\\ -1\\\\ -2 \\end{pmatrix}\n= \\begin{pmatrix} 1\\\\ 0\\\\ -3 \\end{pmatrix}.\n$$\nHence the controllability matrix is\n$$\n\\mathcal{C} = \\begin{pmatrix} b  A b  A^{2} b \\end{pmatrix}\n= \\begin{pmatrix}\n0  0  1\\\\\n1  -1  0\\\\\n0  1  -3\n\\end{pmatrix}.\n$$\nCompute its determinant:\n$$\n\\det(\\mathcal{C}) = \n\\begin{vmatrix}\n0  0  1\\\\\n1  -1  0\\\\\n0  1  -3\n\\end{vmatrix}\n= 0 \\cdot \\begin{vmatrix} -1  0\\\\ 1  -3 \\end{vmatrix}\n- 0 \\cdot \\begin{vmatrix} 1  0\\\\ 0  -3 \\end{vmatrix}\n+ 1 \\cdot \\begin{vmatrix} 1  -1\\\\ 0  1 \\end{vmatrix}\n= 1.\n$$\nTherefore $\\mathop{\\mathrm{rank}}(\\mathcal{C}) = 3$, and the pair $(A,b)$ is controllable.\n\nStep 2: Construct the similarity transformation $T$ from first principles.\nBecause $\\{b, A b, A^{2} b\\}$ is a basis, take that ordered basis as the new controllability basis. Let the columns of $T$ be these basis vectors:\n$$\nT \\equiv \\mathcal{C} = \\begin{pmatrix}\n0  0  1\\\\\n1  -1  0\\\\\n0  1  -3\n\\end{pmatrix}.\n$$\nDefine the new coordinates $z$ by $s = T z$, i.e., $z = T^{-1} s$. In this basis, the matrix of the linear map $A$ is $A_{c} = T^{-1} A T$, whose columns are the coordinates of $A$ acting on the basis vectors. Using $v_{1} = b$, $v_{2} = A b$, $v_{3} = A^{2} b$, we have\n- $A v_{1} = v_{2}$, so the first column of $A_{c}$ is $e_{2}$.\n- $A v_{2} = v_{3}$, so the second column of $A_{c}$ is $e_{3}$.\n- $A v_{3} = A^{3} b$ must be expressed in the basis $\\{v_{1}, v_{2}, v_{3}\\}$.\n\nTo find $A^{3} b$ in this basis from fundamentals, we invoke the Cayley–Hamilton theorem for $A$. First compute the characteristic polynomial of $A$:\n$$\np(\\lambda) = \\det(\\lambda I - A) \n= \\det \\begin{pmatrix}\n\\lambda  0  -1\\\\\n0  \\lambda + 1  1\\\\\n0  -1  \\lambda + 2\n\\end{pmatrix}\n= \\lambda \\big((\\lambda + 1)(\\lambda + 2) + 1\\big) \n= \\lambda \\left(\\lambda^{2} + 3 \\lambda + 3\\right)\n= \\lambda^{3} + 3 \\lambda^{2} + 3 \\lambda.\n$$\nBy Cayley–Hamilton, $A^{3} + 3 A^{2} + 3 A = 0$, hence\n$$\nA^{3} b = -\\,3 A^{2} b - 3 A b.\n$$\nIn coordinates with respect to the basis $\\{v_{1}, v_{2}, v_{3}\\} = \\{b, A b, A^{2} b\\}$, this reads\n$$\nA v_{3} = -\\,3 v_{2} - 3 v_{3} + 0 \\cdot v_{1},\n$$\nso the third column of $A_{c}$ is $\\begin{pmatrix} 0\\\\ -3\\\\ -3 \\end{pmatrix}$. Consequently,\n$$\nA_{c} = T^{-1} A T\n= \\begin{pmatrix}\n0  0  0\\\\\n1  0  -3\\\\\n0  1  -3\n\\end{pmatrix},\n\\quad\nb_{c} = T^{-1} b = e_{1},\n$$\nwhich is precisely the controllable Frobenius companion form with ones on the subdiagonal and final column given by the negatives of the coefficients of $p(\\lambda)$, namely $\\big(-a_{0}, -a_{1}, -a_{2}\\big)^{\\top} = \\big(0, -3, -3\\big)^{\\top}$.\n\nThus, the exact similarity transformation is $T = \\mathcal{C}$.\n\nStep 3: Compute $\\det(T)$.\nFrom the computation in Step $1$, $\\det(T) = \\det(\\mathcal{C}) = 1$.\n\nTherefore, the exact value of $\\det(T)$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "2697134"}]}