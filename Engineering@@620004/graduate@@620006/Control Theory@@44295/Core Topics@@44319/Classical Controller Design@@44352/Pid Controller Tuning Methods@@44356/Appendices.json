{"hands_on_practices": [{"introduction": "Tuning a PID controller often begins with an empirical model of the process, such as the First-Order Plus Dead Time (FOPDT) model. However, the identified parameters for dead-time ($L$) and time-constant ($T$) are never perfect. This first practice invites you to explore the consequence of these inevitable modeling errors by using first-order sensitivity analysis to determine how uncertainties in the plant model propagate to the final controller parameters derived from the Ziegler-Nichols reaction-curve method [@problem_id:2731985]. This exercise provides a foundational analytical tool for understanding the robustness of a tuning recipe.", "problem": "A thermal process is well approximated by a First Order Plus Dead Time (FOPDT) model with transfer function $G_{p}(s)=\\dfrac{K \\exp(-L s)}{T s+1}$, where $K$ is the steady-state gain, $L$ is the apparent input-output dead-time, and $T$ is the dominant time constant. The controller is designed as a Proportional-Integral-Derivative (PID) controller using the classical Ziegler–Nichols (Z-N) reaction-curve tuning rules based on the FOPDT parameters. Assume that $K$ is known exactly from steady-state data, but the identified dynamics $(L,T)$ are affected by small biases $(\\Delta L,\\Delta T)$ due to measurement and fitting errors. Using first-order sensitivity analysis (i.e., total differentials and linearization), derive the first-order approximations of the fractional errors in the tuned parameters $(K_{p},T_{i},T_{d})$ induced by $(\\Delta L,\\Delta T)$ under the Z-N reaction-curve method for PID control. Express your final result as a single row vector containing $\\Delta K_{p}/K_{p}$, $\\Delta T_{i}/T_{i}$, and $\\Delta T_{d}/T_{d}$ in terms of $L$, $T$, $\\Delta L$, and $\\Delta T$. No numerical evaluation or rounding is required, and no units should be included in the final expression.", "solution": "The First Order Plus Dead Time (FOPDT) model is $G_{p}(s)=\\dfrac{K \\exp(-L s)}{T s+1}$ with process gain $K$, dead time $L$, and time constant $T$. Under the classical Ziegler–Nichols (Z-N) reaction-curve tuning rules for Proportional-Integral-Derivative (PID) control, the tuned controller parameters are deterministic functions of the identified FOPDT parameters. We take as foundational that these rules express $(K_{p},T_{i},T_{d})$ as smooth functions of $(K,L,T)$, and we assume the process gain $K$ is known exactly (so $\\Delta K=0$). The goal is to propagate small identification errors $(\\Delta L,\\Delta T)$ into the corresponding small changes $(\\Delta K_{p},\\Delta T_{i},\\Delta T_{d})$ using first-order sensitivity analysis, i.e., total differentials.\n\nFor a scalar function $f(L,T)$ that depends smoothly on $L$ and $T$, the first-order variation due to small changes $(\\Delta L,\\Delta T)$ is given by the total differential\n$$\n\\Delta f \\approx \\frac{\\partial f}{\\partial L}\\,\\Delta L+\\frac{\\partial f}{\\partial T}\\,\\Delta T,\n$$\nand the corresponding fractional variation is\n$$\n\\frac{\\Delta f}{f}\\approx \\frac{1}{f}\\frac{\\partial f}{\\partial L}\\,\\Delta L+\\frac{1}{f}\\frac{\\partial f}{\\partial T}\\,\\Delta T.\n$$\n\nThe classical Ziegler–Nichols reaction-curve rules for a PID controller on an FOPDT process can be written as\n$$\nK_{p}=\\alpha\\,\\frac{T}{K\\,L},\\qquad T_{i}=\\beta\\,L,\\qquad T_{d}=\\gamma\\,L,\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are positive constants. For the conventional Ziegler–Nichols PID settings, these constants are\n$$\n\\alpha=1.2,\\qquad \\beta=2,\\qquad \\gamma=0.5.\n$$\nWe proceed symbolically; the constants will cancel in the fractional sensitivities except where parameters depend on a single variable.\n\nConsider $K_{p}(L,T)=\\alpha\\,\\dfrac{T}{K\\,L}$. Its partial derivatives are\n$$\n\\frac{\\partial K_{p}}{\\partial T}=\\frac{\\alpha}{K\\,L}=\\frac{K_{p}}{T},\\qquad\n\\frac{\\partial K_{p}}{\\partial L}=-\\alpha\\,\\frac{T}{K\\,L^{2}}=-\\frac{K_{p}}{L}.\n$$\nThus the first-order change is\n$$\n\\Delta K_{p}\\approx \\frac{K_{p}}{T}\\,\\Delta T-\\frac{K_{p}}{L}\\,\\Delta L,\n$$\nand the fractional change is\n$$\n\\frac{\\Delta K_{p}}{K_{p}}\\approx \\frac{\\Delta T}{T}-\\frac{\\Delta L}{L}.\n$$\n\nNext, $T_{i}(L)=\\beta\\,L$ depends only on $L$, so\n$$\n\\frac{\\partial T_{i}}{\\partial L}=\\beta=\\frac{T_{i}}{L},\n$$\nand hence\n$$\n\\Delta T_{i}\\approx \\frac{T_{i}}{L}\\,\\Delta L\\quad\\Rightarrow\\quad \\frac{\\Delta T_{i}}{T_{i}}\\approx \\frac{\\Delta L}{L}.\n$$\n\nSimilarly, $T_{d}(L)=\\gamma\\,L$ yields\n$$\n\\frac{\\partial T_{d}}{\\partial L}=\\gamma=\\frac{T_{d}}{L},\n$$\nso\n$$\n\\Delta T_{d}\\approx \\frac{T_{d}}{L}\\,\\Delta L\\quad\\Rightarrow\\quad \\frac{\\Delta T_{d}}{T_{d}}\\approx \\frac{\\Delta L}{L}.\n$$\n\nCollecting these results, the first-order fractional error vector is\n$$\n\\begin{pmatrix}\n\\dfrac{\\Delta K_{p}}{K_{p}} & \\dfrac{\\Delta T_{i}}{T_{i}} & \\dfrac{\\Delta T_{d}}{T_{d}}\n\\end{pmatrix}\n\\approx\n\\begin{pmatrix}\n\\dfrac{\\Delta T}{T}-\\dfrac{\\Delta L}{L} & \\dfrac{\\Delta L}{L} & \\dfrac{\\Delta L}{L}\n\\end{pmatrix}.\n$$\nThis expression is independent of the particular numerical values of $\\alpha$, $\\beta$, and $\\gamma$ so long as the functional dependencies $K_{p}\\propto T/L$, $T_{i}\\propto L$, and $T_{d}\\propto L$ hold, which they do for the classical Ziegler–Nichols reaction-curve PID rules. The assumption $\\Delta K=0$ is critical to eliminate any additional contribution from uncertainty in $K$; if $\\Delta K\\neq 0$, one would add the term $-(\\Delta K/K)$ to $\\Delta K_{p}/K_{p}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{\\Delta K_{p}}{K_{p}} & \\dfrac{\\Delta T_{i}}{T_{i}} & \\dfrac{\\Delta T_{d}}{T_{d}}\\end{pmatrix}=\\begin{pmatrix}\\dfrac{\\Delta T}{T}-\\dfrac{\\Delta L}{L} & \\dfrac{\\Delta L}{L} & \\dfrac{\\Delta L}{L}\\end{pmatrix}}$$", "id": "2731985"}, {"introduction": "While sensitivity analysis reveals the direction and relative magnitude of tuning errors, a crucial next step is to quantify their impact on closed-loop stability. This practice presents a common real-world scenario: the process gain changes after the controller has been tuned and commissioned. By calculating the gain margin of the system tuned with nominal parameters but operating with the actual, higher gain, you will gain hands-on experience in assessing the robustness of a ZN-tuned system and understanding how close a parameter variation can push the system toward instability [@problem_id:2731986].", "problem": "A single-input single-output process is well-approximated by a first-order-plus-dead-time (FOPDT) model with transfer function $P(s) = \\dfrac{K \\exp(-L s)}{T s + 1}$. The nominal reaction-curve identification provides $K = K_{0}$, $L = 1$, and $T = 4$, with $K_{0} = 2$. A Proportional-Integral (PI) controller is tuned using the Ziegler–Nichols (ZN) open-loop step-response method based on the nominal model. After the controller is implemented, the process gain increases by $20\\%$ (that is, $K$ becomes $1.2 K_{0}$), while $L$ and $T$ remain unchanged.\n\nStarting from the definitions of the loop transfer function, frequency response, and the gain margin (defined as the reciprocal of the open-loop magnitude at the phase-crossover frequency where the open-loop phase equals $-\\pi$), determine the resulting gain margin of the closed-loop with the fixed PI controller acting on the process with the increased gain. Assume angular frequency is measured in radians per second. Round your final numerical answer to four significant figures. Express the final answer as a pure number with no units.", "solution": "The problem statement is subjected to validation before any attempt at a solution is made.\n\nFirst, the givens are extracted verbatim from the problem statement:\n- Process model: First-order-plus-dead-time (FOPDT).\n- Process transfer function: $P(s) = \\dfrac{K \\exp(-L s)}{T s + 1}$.\n- Nominal model parameters: $K = K_{0} = 2$, $L = 1$, $T = 4$.\n- Controller type: Proportional-Integral (PI).\n- Tuning method: Ziegler–Nichols (ZN) open-loop step-response method.\n- Process parameter change: The process gain $K$ increases by $20\\%$ to $1.2 K_{0}$. The parameters $L$ and $T$ remain unchanged.\n- Objective: Determine the resulting gain margin ($GM$) of the closed-loop system.\n- Definition of Gain Margin: $GM$ is the reciprocal of the open-loop magnitude at the phase-crossover frequency, $\\omega_{pc}$, where the open-loop phase equals $-\\pi$.\n- Final answer requirement: Numerical value rounded to four significant figures.\n\nThe problem is scientifically grounded, using standard models (FOPDT), controllers (PI), and analysis techniques (frequency response, gain margin) from the field of control theory. It is well-posed, providing all necessary information to uniquely determine the controller parameters and analyze the stability of the modified system. The language is objective and precise. The task of evaluating the robustness of a control system to parameter variations is a standard and meaningful problem in engineering. Therefore, the problem is declared valid.\n\nThe solution proceeds as follows.\n\nStep 1: Determine the PI controller parameters.\nThe controller is tuned using the Ziegler-Nichols open-loop method based on the *nominal* FOPDT model parameters: $K_0=2$, $L=1$, and $T=4$.\nFor a PI controller, the ZN tuning rules are:\nProportional gain: $K_p = \\dfrac{0.9 T}{K_0 L}$\nIntegral time: $T_i = \\dfrac{L}{0.3} = \\dfrac{10}{3} L$\n\nSubstituting the nominal values:\n$K_p = \\dfrac{0.9 \\times 4}{2 \\times 1} = \\dfrac{3.6}{2} = 1.8$\n$T_i = \\dfrac{10}{3} \\times 1 = \\dfrac{10}{3}$\n\nThe transfer function of the PI controller is $C(s) = K_p \\left(1 + \\dfrac{1}{T_i s}\\right)$.\n$C(s) = 1.8 \\left(1 + \\dfrac{1}{(10/3) s}\\right) = 1.8 \\left(1 + \\dfrac{0.3}{s}\\right) = 1.8 \\dfrac{s + 0.3}{s}$\n\nStep 2: Define the new open-loop transfer function.\nAfter the controller is implemented, the process gain increases by $20\\%$. The new gain is $K' = 1.2 K_0 = 1.2 \\times 2 = 2.4$. The parameters $L=1$ and $T=4$ are unchanged.\nThe new process transfer function is $P'(s) = \\dfrac{K' \\exp(-L s)}{T s + 1} = \\dfrac{2.4 \\exp(-s)}{4s + 1}$.\n\nThe open-loop transfer function of the system with the fixed controller and the modified process is $G_{OL}(s) = C(s) P'(s)$.\n$G_{OL}(s) = \\left(1.8 \\dfrac{s + 0.3}{s}\\right) \\left(\\dfrac{2.4 \\exp(-s)}{4s + 1}\\right) = \\dfrac{4.32 (s + 0.3) \\exp(-s)}{s(4s + 1)}$\n\nStep 3: Find the phase-crossover frequency, $\\omega_{pc}$.\nThe phase-crossover frequency $\\omega_{pc}$ is the frequency at which the phase of the open-loop frequency response is equal to $-\\pi$ radians.\nThe frequency response is obtained by setting $s = j\\omega$:\n$G_{OL}(j\\omega) = \\dfrac{4.32 (j\\omega + 0.3) \\exp(-j\\omega)}{j\\omega(4j\\omega + 1)}$\n\nThe phase angle of $G_{OL}(j\\omega)$ is the sum of the phases of the individual terms:\n$\\angle G_{OL}(j\\omega) = \\angle(4.32) + \\angle(j\\omega + 0.3) + \\angle(\\exp(-j\\omega)) - \\angle(j\\omega) - \\angle(4j\\omega + 1)$\n$\\angle G_{OL}(j\\omega) = 0 + \\arctan\\left(\\dfrac{\\omega}{0.3}\\right) - \\omega - \\dfrac{\\pi}{2} - \\arctan(4\\omega)$\n\nWe set this expression to $-\\pi$ to find $\\omega = \\omega_{pc}$:\n$\\arctan\\left(\\dfrac{\\omega_{pc}}{0.3}\\right) - \\omega_{pc} - \\dfrac{\\pi}{2} - \\arctan(4\\omega_{pc}) = -\\pi$\nRearranging the terms yields a transcendental equation for $\\omega_{pc}$:\n$\\dfrac{\\pi}{2} = \\omega_{pc} + \\arctan(4\\omega_{pc}) - \\arctan\\left(\\dfrac{\\omega_{pc}}{0.3}\\right)$\nThis equation must be solved numerically. Let $f(\\omega) = \\omega + \\arctan(4\\omega) - \\arctan(\\frac{10}{3}\\omega) - \\frac{\\pi}{2}$. We seek the root of $f(\\omega) = 0$.\nNumerical solution of this equation yields $\\omega_{pc} \\approx 1.5387$ rad/s.\n\nStep 4: Calculate the magnitude at the phase-crossover frequency.\nThe magnitude of the open-loop frequency response is:\n$|G_{OL}(j\\omega)| = \\dfrac{|4.32| |j\\omega + 0.3| |\\exp(-j\\omega)|}{|j\\omega| |4j\\omega + 1|} = \\dfrac{4.32 \\sqrt{\\omega^2 + 0.3^2}}{\\omega \\sqrt{(4\\omega)^2 + 1^2}}$\n$|G_{OL}(j\\omega)| = \\dfrac{4.32 \\sqrt{\\omega^2 + 0.09}}{\\omega \\sqrt{16\\omega^2 + 1}}$\n\nSubstitute $\\omega = \\omega_{pc} = 1.5387$:\n$|G_{OL}(j\\omega_{pc})| = \\dfrac{4.32 \\sqrt{(1.5387)^2 + 0.09}}{1.5387 \\sqrt{16(1.5387)^2 + 1}}$\n$|G_{OL}(j\\omega_{pc})| = \\dfrac{4.32 \\sqrt{2.3676 + 0.09}}{1.5387 \\sqrt{16(2.3676) + 1}} = \\dfrac{4.32 \\sqrt{2.4576}}{1.5387 \\sqrt{37.8816 + 1}}$\n$|G_{OL}(j\\omega_{pc})| = \\dfrac{4.32 \\times 1.5676}{1.5387 \\times \\sqrt{38.8816}} = \\dfrac{6.7721}{1.5387 \\times 6.2355} \\approx \\dfrac{6.7721}{9.5934}$\n$|G_{OL}(j\\omega_{pc})| \\approx 0.70591$\n\nStep 5: Calculate the Gain Margin.\nThe gain margin is defined as the reciprocal of this magnitude:\n$GM = \\dfrac{1}{|G_{OL}(j\\omega_{pc})|} = \\dfrac{1}{0.70591} \\approx 1.41662$\n\nFinally, rounding the result to four significant figures as required by the problem statement gives $1.417$.", "answer": "$$\\boxed{1.417}$$", "id": "2731986"}, {"introduction": "Ultimately, a controller's worth is judged by its performance in the time domain. This final practice shifts our focus to an Integrating Plus Dead Time (IPDT) process, a common and challenging case in industry an its non-self-regulating dynamics. You will first derive the Ziegler-Nichols tuning parameters for this specific class of systems and then use numerical simulation to evaluate the closed-loop step response [@problem_id:2731954]. By computing metrics like the Integral of Squared Error (ISE) and overshoot, you will directly confront the fundamental trade-off between fast, aggressive control and safe, robust stability.", "problem": "You are given an Integrating Plus Dead Time (IPDT) process under unity feedback with plant transfer function $G_{p}(s) = \\dfrac{K \\, e^{-L s}}{s}$, where $K &gt; 0$ is the steady-state gain and $L &gt; 0$ is the dead time in seconds. The controller is a Proportional-Integral (PI) controller $C(s) = K_{p} \\left(1 + \\dfrac{1}{T_{i} s}\\right)$. The controller parameters are to be selected by the closed-loop Ziegler–Nichols (ZN) method based on the ultimate gain $K_{\\mathrm{u}}$ and ultimate period $P_{\\mathrm{u}}$.\n\nStarting from the fundamental frequency-domain definitions of loop stability and phase/magnitude conditions at the verge of instability (Nyquist viewpoint), derive the expressions for the ultimate frequency $\\omega_{\\mathrm{u}}$ and the Ziegler–Nichols parameters for this IPDT plant. Use the following well-tested facts as the basis of your derivation:\n- The frequency response of the integrator contributes a phase of $-\\dfrac{\\pi}{2}$ and a magnitude of $\\dfrac{1}{\\omega}$ at $s = j \\omega$.\n- The time delay contributes a phase of $-\\omega L$ radians and a magnitude of $1$.\n- The closed-loop Ziegler–Nichols method defines $K_{\\mathrm{u}}$ and $P_{\\mathrm{u}}$ by driving a proportional-only loop to sustained oscillations, at which the open-loop frequency response satisfies an angle of $-\\pi$ radians and a magnitude of $1$.\n- The Ziegler–Nichols PI settings from $K_{\\mathrm{u}}$ and $P_{\\mathrm{u}}$ are $K_{p} = 0.45 \\, K_{\\mathrm{u}}$ and $T_{i} = \\dfrac{P_{\\mathrm{u}}}{1.2}$.\n\nAfter deriving $K_{p}$ and $T_{i}}$ in terms of $K$ and $L$, simulate the unity-feedback closed loop to a unit step command $r(t) = 1$ for $t \\ge 0$, with zero initial conditions, and evaluate the Integral of Squared Error (ISE),\n$$\n\\mathrm{ISE} = \\int_{0}^{T_{\\text{end}}} e(t)^{2} \\, dt, \\quad e(t) = r(t) - y(t),\n$$\nwhere $y(t)$ is the process output. Use a numerically sound time-domain simulation that respects the dead time $L$ exactly or by an accurate approximation. If an approximation is used, justify it in the solution and ensure it is consistent with the sampling interval. Use seconds for time. Report the ISE as a floating-point value rounded to $5$ decimal places.\n\nAdditionally, quantify aggressiveness versus robustness using a simple interpretable numerical criterion. Define the overshoot fraction as\n$$\nM_{p} = \\max\\{0, \\max_{t \\in [0, T_{\\text{end}}]} y(t) - 1\\}.\n$$\nClassify the closed-loop as aggressive if $M_{p} &gt; 0.2$ and robust otherwise. Report this as an integer flag $A$ with $A = 1$ for aggressive and $A = 0$ for robust.\n\nTest Suite:\nFor each parameter pair $(K, L)$ below, compute and return the pair $[\\mathrm{ISE}, A]$ for a unit step input.\n- Case $1$: $K = 1.0$, $L = 1.0$.\n- Case $2$: $K = 1.0$, $L = 2.0$.\n- Case $3$: $K = 0.5$, $L = 1.0$.\n- Case $4$: $K = 2.0$, $L = 1.0$.\n\nSimulation requirements:\n- Use a fixed time step $\\Delta t$ that resolves the dead time $L$; a practical choice is $\\Delta t \\le \\dfrac{L}{400}$ with an upper bound such as $\\Delta t \\le 10^{-3}$ seconds.\n- Use $T_{\\text{end}} = 30 L$ seconds to capture the transient and the approach to steady state.\n- Implement the dead time by a numerically consistent method, such as a first-in first-out buffer with linear interpolation for sub-sample delays.\n- Use Euler integration for the plant integrator and the controller integrator or another method with equivalent clarity and stability at the chosen $\\Delta t$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result is itself a two-element list $[\\mathrm{ISE}, A]$ in the same order as the test suite. For example: $[[x_{1},a_{1}],[x_{2},a_{2}],[x_{3},a_{3}],[x_{4},a_{4}]]$, where each $x_{i}$ is the ISE rounded to $5$ decimal places and each $a_{i}$ is $0$ or $1$.", "solution": "The problem requires the derivation of Proportional-Integral (PI) controller parameters for an Integrating Plus Dead Time (IPDT) process using the Ziegler-Nichols (ZN) closed-loop tuning method, followed by a time-domain simulation to evaluate the performance of the resulting control system. The validation of the problem statement finds it to be scientifically grounded, well-posed, and objective. We proceed with the solution.\n\nFirst, we derive the analytical expressions for the controller parameters. The process is described by the transfer function $G_{p}(s) = \\dfrac{K e^{-L s}}{s}$, with gain $K > 0$ and dead time $L > 0$. The ZN closed-loop method requires finding the ultimate gain, $K_{\\mathrm{u}}$, and ultimate period, $P_{\\mathrm{u}}$, by placing the process under proportional-only control, $C(s) = K_{c}$, and finding the gain $K_{c} = K_{\\mathrm{u}}$ that causes sustained oscillations.\n\nThe open-loop transfer function for this test is $G_{OL}(s) = C(s)G_{p}(s) = K_{c} \\dfrac{K e^{-L s}}{s}$.\nTo find the point of marginal stability, we analyze the frequency response by substituting $s = j \\omega$, where $\\omega$ is the angular frequency.\n$$\nG_{OL}(j\\omega) = K_{c} \\dfrac{K e^{-j\\omega L}}{j\\omega}\n$$\nThe magnitude and phase of the frequency response are, respectively:\n$$\n|G_{OL}(j\\omega)| = \\left| K_{c} \\dfrac{K}{j\\omega} e^{-j\\omega L} \\right| = K_{c} \\dfrac{K}{\\omega} |e^{-j\\omega L}| = \\dfrac{K_{c} K}{\\omega}\n$$\n$$\n\\angle G_{OL}(j\\omega) = \\angle K_{c} + \\angle K + \\angle e^{-j\\omega L} - \\angle j\\omega\n$$\nSince $K_{c} > 0$ and $K > 0$, their phases are $0$. The phase of the integrator $1/j\\omega$ is $-\\pi/2$ radians, and the phase of the time delay $e^{-j\\omega L}$ is $-\\omega L$ radians.\n$$\n\\angle G_{OL}(j\\omega) = 0 + 0 - \\omega L - \\dfrac{\\pi}{2} = -\\left(\\omega L + \\dfrac{\\pi}{2}\\right)\n$$\nAccording to the Nyquist stability criterion, sustained oscillations occur when the frequency response locus passes through the critical point $(-1, 0j)$, which corresponds to a magnitude of $1$ and a phase of $-\\pi$ radians. Let the frequency at which this occurs be the ultimate frequency, $\\omega_{\\mathrm{u}}$.\n\nThe phase condition is:\n$$\n\\angle G_{OL}(j\\omega_{\\mathrm{u}}) = -\\pi \\implies -\\left(\\omega_{\\mathrm{u}} L + \\dfrac{\\pi}{2}\\right) = -\\pi\n$$\nSolving for $\\omega_{\\mathrm{u}}$ yields:\n$$\n\\omega_{\\mathrm{u}} L = \\dfrac{\\pi}{2} \\implies \\omega_{\\mathrm{u}} = \\dfrac{\\pi}{2L}\n$$\nThe ultimate period $P_{\\mathrm{u}}$ is related to $\\omega_{\\mathrm{u}}$ by $P_{\\mathrm{u}} = 2\\pi / \\omega_{\\mathrm{u}}$.\n$$\nP_{\\mathrm{u}} = \\dfrac{2\\pi}{\\pi / (2L)} = 4L\n$$\nThe magnitude condition, with $K_{c} = K_{\\mathrm{u}}$, is:\n$$\n|G_{OL}(j\\omega_{\\mathrm{u}})| = 1 \\implies \\dfrac{K_{\\mathrm{u}} K}{\\omega_{\\mathrm{u}}} = 1\n$$\nSolving for the ultimate gain $K_{\\mathrm{u}}$ gives:\n$$\nK_{\\mathrm{u}} = \\dfrac{\\omega_{\\mathrm{u}}}{K} = \\dfrac{\\pi / (2L)}{K} = \\dfrac{\\pi}{2KL}\n$$\nWith $K_{\\mathrm{u}}$ and $P_{\\mathrm{u}}$ determined, the PI controller parameters $K_{p}$ and $T_{i}$ are calculated using the specified ZN tuning rules:\n$$\nK_{p} = 0.45 K_{\\mathrm{u}} = 0.45 \\left( \\dfrac{\\pi}{2KL} \\right) = \\dfrac{0.45\\pi}{2KL}\n$$\n$$\nT_{i} = \\dfrac{P_{\\mathrm{u}}}{1.2} = \\dfrac{4L}{1.2} = \\dfrac{10}{3}L\n$$\nThese expressions for $K_{p}$ and $T_{i}$ are functions only of the plant parameters $K$ and $L$.\n\nNext, we define the numerical methodology for simulating the closed-loop system response to a unit step input $r(t)=1$. The system is under unity feedback, so the error signal is $e(t) = r(t) - y(t)$, where $y(t)$ is the plant output.\nThe PI controller output $u(t)$ is given by:\n$$\nu(t) = K_{p}e(t) + \\dfrac{K_{p}}{T_{i}}\\int_{0}^{t} e(\\tau)d\\tau\n$$\nThe plant behavior is described by the differential equation with time delay:\n$$\n\\dfrac{dy(t)}{dt} = K u(t-L)\n$$\nWe discretize these equations for numerical simulation using the Explicit Euler method with a fixed time step $\\Delta t$. Let $y_k$, $e_k$, and $u_k$ represent the values of the variables at time $t_k = k\\Delta t$. The integral term in the controller is represented by a state variable $x_{I}$, which is updated at each step.\n\nThe discrete-time simulation algorithm proceeds as follows:\nInitialize states: $y_0 = 0$, $x_{I,0} = 0$.\nFor each time step $k = 0, 1, 2, \\dots$:\n$1$. Calculate the error: $e_k = 1 - y_k$.\n$2$. Calculate the controller output: $u_k = K_p e_k + \\dfrac{K_p}{T_i} x_{I,k}$. Store $u_k$ in a history buffer.\n$3$. Update the controller's integrator state for the next step: $x_{I,k+1} = x_{I,k} + \\Delta t \\cdot e_k$.\n$4$. Determine the delayed control input $u(t_k - L)$. The delay in samples is $d = L/\\Delta t$. If $d$ is not an integer, linear interpolation is required between past samples of $u$. The value $u(t_k-L) = u((k-d)\\Delta t)$ is interpolated using the stored values $u_{k-d_{\\text{int}}-1}$ and $u_{k-d_{\\text{int}}}$, where $d_{\\text{int}} = \\lfloor d \\rfloor$ and $d_{\\text{frac}} = d - d_{\\text{int}}$. The interpolated value is $u_{\\text{delayed}, k} = (1 - d_{\\text{frac}})u_{k-d_{\\text{int}}} + d_{\\text{frac}}u_{k-d_{\\text{int}}-1}$. For $t_k < L$, $u_{\\text{delayed},k} = 0$.\n$5$. Update the plant output for the next step: $y_{k+1} = y_k + \\Delta t \\cdot K \\cdot u_{\\text{delayed},k}$.\n\nThe simulation parameters are set according to the problem statement: $\\Delta t = \\min(L/400, 10^{-3})$ and $T_{\\text{end}} = 30L$.\n\nFinally, the performance metrics are computed from the simulation results.\nThe Integral of Squared Error (ISE) is approximated by a sum:\n$$\n\\mathrm{ISE} = \\int_{0}^{T_{\\text{end}}} e(t)^{2} \\, dt \\approx \\sum_{k=0}^{N-1} e_k^2 \\Delta t, \\quad \\text{where } N = \\frac{T_{\\text{end}}}{\\Delta t}\n$$\nThe overshoot fraction $M_p$ is calculated as:\n$$\nM_{p} = \\max\\{0, \\max_{k} y_k - 1\\}\n$$\nThe system response is classified as aggressive ($A=1$) if $M_p > 0.2$, and robust ($A=0$) otherwise.\n\nThis complete procedure is implemented to evaluate the specified test cases.", "answer": "[[3.40742, 1], [6.81483, 1], [3.40742, 1], [3.40742, 1]]", "id": "2731954"}]}