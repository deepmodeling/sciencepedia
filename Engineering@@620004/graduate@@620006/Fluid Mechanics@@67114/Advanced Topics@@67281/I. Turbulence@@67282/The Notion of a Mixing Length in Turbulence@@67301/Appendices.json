{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we start with the very foundation of the mixing length concept. This exercise draws a powerful analogy between the random motion of molecules in a gas and the chaotic swirling of eddies in a turbulent fluid. By applying this analogy and a simple scaling argument, you will derive an estimate for the \"eddy viscosity,\" a term that quantifies how turbulence enhances momentum transport [@problem_id:1921384]. This practice is crucial for building physical intuition and demonstrates how complex phenomena can often be understood through elegant, first-principle estimations.", "problem": "In the study of astrophysical accretion disks, such as the protoplanetary disks from which solar systems form, the transport of angular momentum is a key process that allows matter to spiral inwards and accrete onto the central star. While molecular viscosity is far too weak to explain observed accretion rates, turbulence within the disk provides a much more effective mechanism.\n\nThis turbulent transport can be modeled by postulating an 'eddy viscosity'. Consider a simplified picture of this turbulence based on an analogy with the kinetic theory of gases. In a gas, molecular viscosity arises from the random thermal motion of molecules exchanging momentum over a mean free path. In a turbulent fluid, we can imagine that fluid parcels, or 'eddies', play the role of molecules.\n\nLet's model this process. An eddy, a coherent blob of fluid, carries the mean momentum of its point of origin. It travels a characteristic 'mixing length' $l_m$ before it dissolves and mixes its momentum with the surrounding fluid. The characteristic velocity of these turbulent eddies relative to the mean flow is $v'$. By analogy with kinetic theory, the turbulent kinematic viscosity, $\\nu_{turb}$, is expected to be of the order of the product of the characteristic eddy velocity and the mixing length.\n\nFor the largest, most energy-containing eddies in a large-scale flow, it is reasonable to assume that their properties are dictated by the global characteristics of the flow itself. Suppose the flow is characterized by a single large-scale velocity $U$ and a single large-scale length $L$. Assume that the characteristic speed of the largest eddies is on the order of the global velocity scale, i.e., $v' \\sim U$. Furthermore, assume that the mixing length for these dominant eddies is on the order of the global length scale, i.e., $l_m \\sim L$.\n\nBased on this model and these scaling assumptions, find an expression for the turbulent kinematic viscosity $\\nu_{turb}$ in terms of $U$ and $L$. Your answer should be the simplest possible expression consistent with the scaling relationships.", "solution": "Start from the eddy-viscosity analogy with kinetic theory: turbulent transport of momentum by eddies with characteristic velocity $v'$ and mixing length $l_m$ leads to a turbulent kinematic viscosity that scales as\n$$\n\\nu_{turb} \\sim v' \\, l_m,\n$$\nsince the momentum flux is proportional to the product of a characteristic velocity and the distance over which momentum is exchanged. This expression has the correct dimensions, $[v'][l_m]=L^{2}T^{-1}$, matching those of kinematic viscosity.\n\nFor the largest, energy-containing eddies in a flow characterized by a single global velocity and length scale, adopt the scaling assumptions\n$$\nv' \\sim U, \\qquad l_m \\sim L.\n$$\nSubstituting these into the scaling for $\\nu_{turb}$ gives\n$$\n\\nu_{turb} \\sim U L.\n$$\nDiscarding order-unity constants as per the scaling argument, the simplest consistent expression is\n$$\n\\nu_{turb} = U L.\n$$", "answer": "$$\\boxed{UL}$$", "id": "1921384"}, {"introduction": "Having established the basic idea of a mixing length, we now turn to understanding its application in a realistic geometry. A robust physical model must respect the underlying symmetries and constraints of the system it describes. This practice challenges you to think critically about the physical and kinematic reasons why the mixing length must vanish at the centerline of a pipe with an axisymmetric turbulent flow [@problem_id:1812839]. Mastering this concept ensures you can correctly apply boundary conditions, a vital step in setting up any valid fluid dynamics model.", "problem": "In the study of fluid mechanics, zero-equation turbulence models provide a simplified way to estimate the effects of turbulence without solving additional transport equations. One of the earliest and most famous is Prandtl's mixing length model. This model is used to approximate the turbulent shear stress, $\\tau_t$, in a flow. Consider a fully developed, incompressible, and axisymmetric turbulent flow moving through a long, straight, circular pipe of radius $R$.\n\nThe mixing length, $l_m$, is physically interpreted as the average transverse distance a coherent fluid parcel (an \"eddy\") travels before it mixes with the surrounding fluid and loses its distinct momentum. For axisymmetric flow in a pipe, it is a fundamental requirement of the model that the mixing length $l_m$ must be zero at the centerline of the pipe (i.e., at a radial position $r=0$).\n\nWhich of the following statements provides the most accurate and fundamental physical reason for this requirement?\n\nA. The no-slip condition at the pipe wall ($r=R$) dictates that the velocity is zero there, and this boundary condition forces the velocity gradient, and consequently the mixing length, to be zero at the centerline.\n\nB. Due to axisymmetry, there can be no net transport of momentum across the centerline. This implies that the transverse velocity fluctuations responsible for turbulent mixing must vanish at $r=0$, kinematically preventing eddies from crossing the centerline and thus forcing their characteristic travel distance (the mixing length) to be zero.\n\nC. The mean velocity profile has a maximum value at the centerline. Calculus dictates that any smooth function at a maximum must have a first derivative of zero, so the mean velocity gradient is zero at $r=0$, which in turn requires the mixing length to be zero.\n\nD. At the centerline of the pipe, viscous shear stresses reach their maximum value, overwhelming any turbulent effects. Since the mixing length model only describes turbulence, the mixing length must be set to zero where viscous effects are completely dominant.\n\nE. For an axisymmetric flow, the pressure is constant across any given radial cross-section. The absence of a radial pressure gradient means there is no force to drive the turbulent eddies across the centerline, so the mixing length must be zero.", "solution": "For fully developed, incompressible, axisymmetric turbulent flow in a circular pipe, the mean axial velocity is $U(r)$ and the relevant shear stress component is\n$$\n\\tau_{rz}(r)= -\\rho\\,\\overline{u'v_r'}+\\mu \\frac{dU}{dr}.\n$$\nIn fully developed pipe flow, the total shear stress varies linearly with $r$ and satisfies\n$$\n\\tau_{rz}(r)=-\\frac{r}{2}\\frac{dp}{dz},\n$$\nso $\\tau_{rz}(0)=0$. In Prandtl’s mixing-length model, the turbulent shear stress is closed as\n$$\n\\tau_{t} \\equiv -\\rho\\,\\overline{u'v_r'}=\\rho\\,l_{m}^{2}\\left|\\frac{dU}{dr}\\right|\\frac{dU}{dr}.\n$$\nBecause the centerline is a point of symmetry, the mean velocity $U(r)$ attains a maximum there, so\n$$\n\\left.\\frac{dU}{dr}\\right|_{r=0}=0.\n$$\nThis immediately yields $\\tau_{t}(0)=0$ irrespective of the value of $l_{m}(0)$. Therefore, the vanishing of the mean gradient at $r=0$ does not by itself require $l_{m}(0)=0$, so invoking only $\\frac{dU}{dr}(0)=0$ (as in statement C) is not a sufficient or fundamental reason.\n\nTo determine the behavior of $l_{m}$ at the axis, one must use the kinematics implied by axisymmetry and regularity of the velocity field at $r=0$. Let $(u', v'_r)$ denote the axial and radial components of the instantaneous velocity fluctuations, with $v'_r$ the transverse (radial) component. In cylindrical coordinates, the radial component is $v'_r=v'_x \\cos\\theta+v'_y\\sin\\theta$, where $(v'_x,v'_y)$ are Cartesian components in a plane normal to the pipe axis and $\\theta$ is the polar angle. For a smooth, single-valued velocity field, the limit of $v'_r$ as $r\\to 0$ must be independent of $\\theta$. The only way this can hold for arbitrary $\\theta$ is\n$$\nv'_r(r=0)=0.\n$$\nHence, by symmetry and regularity, the instantaneous transverse (radial) velocity fluctuation vanishes exactly at the centerline, and therefore the turbulent transport across the centerline is kinematically prohibited at $r=0$. In particular,\n$$\n\\overline{u'v_r'}(0)=0,\n$$\nreflecting the absence of transverse transport through the axis.\n\nPrandtl’s mixing length $l_{m}$ is the characteristic transverse distance an eddy (a coherent parcel) can travel before losing its identity and mixing. At $r=0$, because $v'_r=0$ exactly by the axisymmetry-induced kinematic constraint, an eddy cannot cross the centerline; its characteristic transverse travel distance there must therefore be zero:\n$$\nl_{m}(0)=0.\n$$\nThis argument is the fundamental physical reason for the requirement. By contrast: (A) incorrectly attributes centerline behavior to the wall no-slip condition; (C) confuses $\\tau_{t}(0)=0$ due to $\\frac{dU}{dr}(0)=0$ with the independent requirement on $l_{m}$; (D) is false because viscous shear is actually zero at the centerline; and (E) misattributes turbulent transport to a radial pressure force, which is not the mechanism of turbulent mixing.\n\nTherefore, the most accurate and fundamental reason is the axisymmetry-imposed kinematic constraint that forbids transverse fluctuations and transport at the axis, forcing $l_{m}(0)=0$.", "answer": "$$\\boxed{B}$$", "id": "1812839"}, {"introduction": "This final practice integrates the preceding concepts into a comprehensive computational exercise, bridging the gap between abstract theory and practical application. You will implement a complete numerical model for turbulent flow in a channel, starting from the fundamental momentum balance and incorporating the Prandtl mixing length model with near-wall corrections [@problem_id:2381390]. By numerically solving for the velocity profile and comparing your results to the universal \"law of the wall,\" you will gain firsthand experience in the methods of computational fluid dynamics and witness how a simplified model can successfully predict complex, real-world turbulent behavior.", "problem": "Implement a complete, runnable program that computes the turbulent mean velocity profile in a plane channel using an algebraic mixing length model and quantitatively compares it to the universal law of the wall. The channel is plane, fully developed, steady, and incompressible, with streamwise coordinate $x$ and wall-normal coordinate $y$. The flow is driven by a constant mean pressure gradient, and the mean velocity is $U(y)$.\n\nStarting point and modeling assumptions to be used:\n- Begin from the Reynolds-averaged momentum balance (Reynolds-Averaged Navier–Stokes (RANS) in the streamwise direction) specialized to steady, fully developed, one-dimensional mean flow in a plane channel. The mean momentum equation reduces to a balance between the constant pressure gradient and the wall-normal gradient of the total shear stress.\n- Introduce the Boussinesq eddy viscosity hypothesis for the Reynolds shear stress, so that the total shear stress can be written as\n$$\n\\tau_{\\text{tot}}(y) \\;=\\; \\mu \\,\\frac{dU}{dy} \\;-\\; \\rho \\,\\overline{u'v'} \\;=\\; \\rho\\left(\\nu + \\nu_t\\right)\\,\\frac{dU}{dy},\n$$\nwhere $\\mu$ is the dynamic viscosity, $\\rho$ is the density, $\\nu=\\mu/\\rho$ is the kinematic viscosity, and $\\nu_t$ is the eddy viscosity.\n- Use the well-tested fact that for fully developed plane channel flow, the total shear stress varies linearly across the half-channel: \n$$\n\\tau_{\\text{tot}}(y) \\;=\\; \\tau_w\\left(1-\\frac{y}{\\delta}\\right),\n$$\nwhere $\\tau_w$ is the wall shear stress at $y=0$ and $\\delta$ is the channel half-height. Define the friction velocity $u_\\tau$ by $\\tau_w=\\rho\\,u_\\tau^2$.\n- Adopt the Prandtl mixing length model with near-wall damping (van Driest):\n$$\n\\nu_t \\;=\\; l_m^2 \\left|\\frac{dU}{dy}\\right|,\\qquad \nl_m \\;=\\; \\kappa\\, y \\left[1-\\exp\\!\\left(-\\frac{y^+}{A^+}\\right)\\right],\\qquad\ny^+ \\;=\\; \\frac{y\\,u_\\tau}{\\nu},\n$$\nwhere $\\kappa$ is the von Kármán constant, $A^+$ is the van Driest damping constant, and $y^+$ is the wall coordinate in wall units.\n\nTask requirements:\n1. From the fundamental statements above, derive an algebraic relation between the mean shear $g(y)=dU/dy$ and the known quantities $\\nu$, $l_m(y)$, $u_\\tau$, and $\\delta$. Your derivation must eliminate the pressure gradient in favor of the total stress distribution across the channel. Do not assume any target formula for $g(y)$; derive it explicitly from the definitions and balances given.\n2. Use the positive, physically admissible branch of your algebraic relation for $g(y)$ and implement a numerical procedure to obtain $U(y)$ across $y\\in[0,\\delta]$ by integrating $g(y)$ subject to the no-slip boundary condition $U(0)=0$. Compute the non-dimensional profiles $y^+=y\\,u_\\tau/\\nu$ and $U^+=U/u_\\tau$.\n3. Compare the computed $U^+(y^+)$ to the universal law of the wall in the logarithmic region:\n$$\nU^+_{\\log}(y^+) \\;=\\; \\frac{1}{\\kappa}\\,\\ln y^+ \\;+\\; B,\n$$\nwith given constants $\\kappa$ and $B$ for a smooth wall. Quantify the discrepancy using the root-mean-square (RMS) difference over a specified log-layer window.\n4. Use the following physical constants for all cases: kinematic viscosity $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, channel half-height $\\delta = 0.05\\,\\mathrm{m}$, von Kármán constant $\\kappa = 0.41$, log-law intercept $B=5.2$, and van Driest constant $A^+=26$. For each case, determine $u_\\tau$ from the given friction Reynolds number $Re_\\tau$ via $Re_\\tau = u_\\tau\\,\\delta/\\nu$.\n5. Compute the RMS error between $U^+$ and $U^+_{\\log}$ over the interval $y^+ \\in [30,\\; 0.3\\,Re_\\tau]$. If this interval contains no grid points, evaluate the absolute difference at the single grid point whose $y^+$ is closest to $30$ from the available grid and return this value as the RMS error for that case.\n\nNumerical implementation requirements:\n- Use a uniform grid in $y$ with $N$ points including the walls at $y=0$ and the centerline at $y=\\delta$ for each case. Integrate $g(y)$ by a consistent second-order accurate trapezoidal rule to obtain $U(y)$.\n- Angles do not appear in this problem; consequently, no angle unit is required.\n- All reported comparisons must be dimensionless; there is no requirement to report physical units in the final errors.\n- The program must not read any input and must use the test suite below verbatim.\n\nTest suite (use in this exact order):\n- Case $1$: $Re_\\tau = 180$, $N=1500$.\n- Case $2$: $Re_\\tau = 395$, $N=2000$.\n- Case $3$: $Re_\\tau = 1000$, $N=4000$.\n- Case $4$ (edge case with a very small logarithmic interval): $Re_\\tau = 90$, $N=1500$.\n\nFinal output specification:\n- Your program must produce a single line containing a Python-style list of the four RMS errors corresponding to the four cases, in the same order as above. Each RMS error must be a floating-point number rounded to exactly three decimal places. The printed line must have the format\n$[e_1,e_2,e_3,e_4]$\nwith no spaces anywhere. For example, a valid output would look like $[0.123,0.456,0.789,1.234]$.", "solution": "The problem requires the computation of the mean velocity profile in a turbulent plane channel flow using an algebraic mixing length model. The solution involves deriving an expression for the mean velocity gradient, numerically integrating it, and comparing the resulting non-dimensional velocity profile to the universal law of the wall.\n\nThe starting point is the Reynolds-averaged momentum equation for a steady, fully developed channel flow, which simplifies to a balance between the mean pressure gradient and the gradient of the total shear stress, $\\tau_{\\text{tot}}$. The problem provides a linear profile for the total stress across the channel half-height $\\delta$:\n$$\n\\tau_{\\text{tot}}(y) = \\tau_w \\left(1 - \\frac{y}{\\delta}\\right)\n$$\nwhere $\\tau_w$ is the shear stress at the wall ($y=0$). The wall shear stress defines the friction velocity $u_\\tau$ via $\\tau_w = \\rho u_\\tau^2$, where $\\rho$ is the fluid density.\n\nThe Boussinesq hypothesis relates the Reynolds shear stress to the mean velocity gradient, allowing the total stress to be expressed as:\n$$\n\\tau_{\\text{tot}}(y) = \\rho (\\nu + \\nu_t) \\frac{dU}{dy}\n$$\nHere, $\\nu$ is the kinematic viscosity and $\\nu_t$ is the turbulent or eddy viscosity. We adopt the Prandtl mixing length model for $\\nu_t$, which states $\\nu_t = l_m^2 |dU/dy|$, where $l_m$ is the mixing length. For the mean flow in the half-channel $y \\in [0, \\delta]$, the velocity gradient $dU/dy$ is non-negative, so we can write $|dU/dy| = dU/dy$. Letting $g(y) = dU/dy$, the eddy viscosity becomes $\\nu_t = l_m^2 g(y)$.\n\nEquating the two expressions for $\\tau_{\\text{tot}}(y)$ and substituting the definition of $u_\\tau$ yields:\n$$\n\\rho (\\nu + l_m^2 g(y)) g(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)\n$$\nDividing by $\\rho$, we obtain an algebraic equation for the velocity gradient $g(y)$:\n$$\n(\\nu + l_m^2 g(y)) g(y) = u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)\n$$\nThis rearranges into a quadratic equation for $g(y)$:\n$$\nl_m^2 [g(y)]^2 + \\nu g(y) - u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right) = 0\n$$\nThis is a standard quadratic equation of the form $ax^2+bx+c=0$ with $x=g(y)$, $a=l_m^2$, $b=\\nu$, and $c=-u_\\tau^2(1-y/\\delta)$. The solution is given by the quadratic formula:\n$$\ng(y) = \\frac{-\\nu \\pm \\sqrt{\\nu^2 - 4(l_m^2)\\left[-u_\\tau^2\\left(1 - \\frac{y}{\\delta}\\right)\\right]}}{2l_m^2} = \\frac{-\\nu \\pm \\sqrt{\\nu^2 + 4l_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2l_m^2}\n$$\nSince the velocity increases from the wall to the centerline, the gradient $g(y)$ must be non-negative. The term under the square root is always greater than or equal to $\\sqrt{\\nu^2}=|\\nu|=\\nu$. Therefore, to ensure $g(y) \\ge 0$, we must choose the positive sign. The physically admissible root is:\n$$\ng(y) = \\frac{-\\nu + \\sqrt{\\nu^2 + 4l_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2l_m^2}\n$$\nThis relation is valid for $y>0$. At the wall, $y=0$, the mixing length $l_m$ is zero. In this limit, the quadratic equation simplifies to $\\nu g(0) - u_\\tau^2 = 0$, which gives $g(0) = u_\\tau^2/\\nu$. At the centerline, $y=\\delta$, the term $(1-y/\\delta)$ is zero, leading to $g(\\delta) = (-\\nu + \\sqrt{\\nu^2})/(2l_m^2) = 0$, correctly reproducing the zero-slope condition due to symmetry. The mixing length $l_m$ itself is given by the van Driest damped model:\n$$\nl_m(y) = \\kappa y \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]\n$$\nwhere $y^+ = yu_\\tau/\\nu$ is the wall-normal coordinate in viscous wall units, $\\kappa$ is the von Kármán constant, and $A^+$ is the van Driest damping constant.\n\nThe numerical solution is obtained by first discretizing the half-channel height $y \\in [0, \\delta]$ into a uniform grid of $N$ points, $y_i = i \\cdot \\Delta y$ for $i=0, \\dots, N-1$, with grid spacing $\\Delta y = \\delta/(N-1)$. The velocity gradient $g(y_i)$ is computed at each grid point using the derived formula, handling the special case at $y_0=0$.\nThe mean velocity profile $U(y)$ is then found by numerically integrating $g(y)$ from the wall, subject to the no-slip boundary condition $U(0)=0$. We employ the second-order accurate trapezoidal rule:\n$$\nU(y_{i+1}) = U(y_i) + \\frac{\\Delta y}{2}[g(y_i) + g(y_{i+1})], \\quad \\text{for } i=0, \\dots, N-2\n$$\nThis is implemented as a cumulative sum for efficiency.\n\nAfter computing $U(y)$, the profile is non-dimensionalized into wall units: the dimensionless velocity is $U^+ = U/u_\\tau$ and the dimensionless distance is $y^+ = yu_\\tau/\\nu$.\nThe computed profile $U^+(y^+)$ is compared against the theoretical law of the wall for the logarithmic region:\n$$\nU^+_{\\log}(y^+) = \\frac{1}{\\kappa}\\ln y^+ + B\n$$\nwhere $B$ is the log-law intercept constant. The discrepancy is quantified by the root-mean-square (RMS) error, calculated over the interval $y^+ \\in [30, 0.3 Re_\\tau]$, where $Re_\\tau = u_\\tau \\delta / \\nu$ is the friction Reynolds number. If this interval contains $M$ grid points indexed by the set $J$, the RMS error is:\n$$\n\\text{Error}_{\\text{RMS}} = \\sqrt{\\frac{1}{M}\\sum_{i \\in J} \\left[U^+(y^+_i) - U^+_{\\log}(y^+_i)\\right]^2}\n$$\nFor cases where the grid does not resolve this interval (i.e., no grid points fall within it), the problem specifies to calculate the absolute difference $|U^+(y^+_k) - U^+_{\\log}(y^+_k)|$ at the single grid point $y^+_k$ that is closest to $y^+=30$. This value is then reported as the error for that case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the turbulent mean velocity profile in a plane channel using a mixing length model\n    and compares it to the law of the wall to find the RMS error.\n    \"\"\"\n    # Physical and model constants\n    NU = 1.5e-5  # Kinematic viscosity (m^2/s)\n    DELTA = 0.05  # Channel half-height (m)\n    KAPPA = 0.41  # von Kármán constant\n    B = 5.2       # Log-law intercept\n    A_PLUS = 26.0 # van Driest damping constant\n\n    # Test cases: (Re_tau, N)\n    test_cases = [\n        (180, 1500),\n        (395, 2000),\n        (1000, 4000),\n        (90, 1500),\n    ]\n\n    results = []\n    \n    for Re_tau, N in test_cases:\n        # 1. Setup grid and flow parameters\n        u_tau = Re_tau * NU / DELTA\n        dy = DELTA / (N - 1)\n        y = np.linspace(0, DELTA, N, dtype=np.float64)\n        y_plus = y * u_tau / NU\n\n        # 2. Compute the mean velocity gradient g(y) = dU/dy\n        g = np.zeros(N, dtype=np.float64)\n\n        # At the wall (y=0), lm=0, the quadratic equation for g simplifies\n        g[0] = u_tau**2 / NU\n\n        # For y > 0\n        y_slice = y[1:]\n        y_plus_slice = y_plus[1:]\n        \n        # Mixing length with van Driest damping\n        lm = KAPPA * y_slice * (1.0 - np.exp(-y_plus_slice / A_PLUS))\n        \n        # Solve the quadratic equation for g(y): lm^2 * g^2 + nu * g - C = 0\n        # where C = u_tau^2 * (1 - y/delta)\n        # We use the positive root for g.\n        c_term = u_tau**2 * (1.0 - y_slice / DELTA)\n        discriminant = NU**2 + 4.0 * lm**2 * c_term\n        g[1:] = (-NU + np.sqrt(discriminant)) / (2.0 * lm**2)\n\n        # 3. Integrate g(y) to get U(y) using the trapezoidal rule\n        U = np.zeros(N, dtype=np.float64)\n        # U(0)=0 due to no-slip condition.\n        # U[i+1] = U[i] + 0.5 * dy * (g[i] + g[i+1])\n        # This is equivalent to a cumulative sum of the trapezoidal areas.\n        integrand = 0.5 * dy * (g[:-1] + g[1:])\n        U[1:] = np.cumsum(integrand)\n\n        # 4. Non-dimensionalize velocity\n        U_plus = U / u_tau\n\n        # 5. Compare with log law and compute RMS error\n        log_layer_start = 30.0\n        log_layer_end = 0.3 * Re_tau\n\n        # Find points within the logarithmic layer\n        log_mask = (y_plus >= log_layer_start) & (y_plus <= log_layer_end)\n        \n        num_points_in_log_layer = np.sum(log_mask)\n\n        if num_points_in_log_layer > 0:\n            # Normal case: compute RMS error over the log-layer points\n            y_plus_log = y_plus[log_mask]\n            U_plus_log = U_plus[log_mask]\n            \n            U_log_analytic = (1.0 / KAPPA) * np.log(y_plus_log) + B\n            \n            error = np.sqrt(np.mean((U_plus_log - U_log_analytic)**2))\n        else:\n            # Edge case: no grid points in the log layer interval\n            # Find the single grid point closest to y+=30\n            # Note: y_plus[0] is 0. Exclude it to avoid issues with log(0) and to ensure\n            # the search is in the physically relevant region. The closest point will not be y=0.\n            idx_closest = np.argmin(np.abs(y_plus[1:] - log_layer_start)) + 1\n            \n            y_p_eval = y_plus[idx_closest]\n            U_p_eval = U_plus[idx_closest]\n            \n            U_log_analytic_eval = (1.0 / KAPPA) * np.log(y_p_eval) + B\n            \n            error = np.abs(U_p_eval - U_log_analytic_eval)\n\n        results.append(error)\n\n    # Format output as specified\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2381390"}]}