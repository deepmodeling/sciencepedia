{"hands_on_practices": [{"introduction": "Understanding how to decompose a turbulent flow begins with the mathematical tool of filtering. This first exercise [@problem_id:481692] provides a fundamental hands-on experience by having you derive the transfer function for the widely used two-dimensional top-hat filter. By working through this derivation, you will directly see how a simple averaging operation in physical space translates into a scale-dependent attenuation in Fourier space, which is the very essence of separating large scales from small ones.", "problem": "In Large Eddy Simulation (LES) of turbulent flows, the velocity field $\\mathbf{u}(\\mathbf{x}, t)$ is decomposed into a large-scale (filtered) component, $\\bar{\\mathbf{u}}(\\mathbf{x}, t)$, and a small-scale (subgrid-scale) component, $\\mathbf{u}'(\\mathbf{x}, t)$. The filtering operation is defined spatially by a convolution with a filter kernel $G(\\mathbf{x})$:\n$$\n\\bar{f}(\\mathbf{x}) = \\int_{\\mathbb{R}^2} G(\\mathbf{x} - \\mathbf{x}') f(\\mathbf{x}') d^2\\mathbf{x}'\n$$\nwhere $f(\\mathbf{x})$ is any field variable and we consider a two-dimensional domain, $\\mathbf{x} = (x_1, x_2) \\in \\mathbb{R}^2$. The filter kernel $G(\\mathbf{x})$ must be normalized such that $\\int_{\\mathbb{R}^2} G(\\mathbf{x}) d^2\\mathbf{x} = 1$.\n\nIn Fourier space, this convolution becomes a simple multiplication:\n$$\n\\hat{\\bar{f}}(\\mathbf{k}) = \\hat{G}(\\mathbf{k}) \\hat{f}(\\mathbf{k})\n$$\nwhere $\\hat{G}(\\mathbf{k})$ is the transfer function of the filter, and $\\hat{f}(\\mathbf{k})$ is the Fourier transform of $f(\\mathbf{x})$. The two-dimensional Fourier transform is defined as:\n$$\n\\hat{f}(\\mathbf{k}) = \\int_{\\mathbb{R}^2} f(\\mathbf{x}) e^{-i \\mathbf{k} \\cdot \\mathbf{x}} d^2\\mathbf{x}\n$$\nwhere $\\mathbf{k} = (k_1, k_2)$ is the wavevector.\n\nConsider the two-dimensional spatial top-hat filter (or box filter) of characteristic width $\\Delta$, defined as:\n$$\nG(x_1, x_2) = \n\\begin{cases} \n\\frac{1}{\\Delta^2} & \\text{if } |x_1| \\le \\frac{\\Delta}{2} \\text{ and } |x_2| \\le \\frac{\\Delta}{2} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nDerive the analytical expression for the transfer function $\\hat{G}(\\mathbf{k})$ corresponding to this filter.", "solution": "1. Relevant equations:\n- Filter definition: \n$$\\bar{f}(\\mathbf{x})=\\int_{\\mathbb{R}^2}G(\\mathbf{x}-\\mathbf{x}')f(\\mathbf{x}')\\,d^2\\mathbf{x}'$$\n- Fourier transform: \n$$\\hat{f}(\\mathbf{k})=\\int_{\\mathbb{R}^2}f(\\mathbf{x})e^{-i\\mathbf{k}\\cdot\\mathbf{x}}\\,d^2\\mathbf{x}$$\n- Convolution theorem: \n$$\\hat{\\bar{f}}(\\mathbf{k})=\\hat{G}(\\mathbf{k})\\,\\hat{f}(\\mathbf{k})$$\n\n2. Compute $\\hat{G}(\\mathbf{k})$ for \n$$G(x_1,x_2)=\\begin{cases}\\frac{1}{\\Delta^2}&|x_1|\\le\\frac{\\Delta}{2},\\,|x_2|\\le\\frac{\\Delta}{2}\\\\0&\\text{otherwise}\\end{cases}.$$\nBy definition,\n$$\n\\hat{G}(\\mathbf{k})\n=\\int_{\\mathbb{R}^2}G(x_1,x_2)e^{-i(k_1x_1+k_2x_2)}\\,dx_1\\,dx_2.\n$$\nSince $G$ is nonzero only on the box,\n$$\n\\hat{G}(\\mathbf{k})\n=\\frac{1}{\\Delta^2}\\int_{-\\frac{\\Delta}{2}}^{\\frac{\\Delta}{2}}e^{-ik_1x_1}dx_1\n\\int_{-\\frac{\\Delta}{2}}^{\\frac{\\Delta}{2}}e^{-ik_2x_2}dx_2.\n$$\n\n3. Evaluate each one-dimensional integral:\n$$\n\\int_{-\\frac{\\Delta}{2}}^{\\frac{\\Delta}{2}}e^{-ik_jx_j}dx_j\n=\\left[\\frac{e^{-ik_jx_j}}{-ik_j}\\right]_{-\\frac{\\Delta}{2}}^{\\frac{\\Delta}{2}}\n=\\frac{e^{-i k_j\\Delta/2}-e^{i k_j\\Delta/2}}{-i k_j}\n=\\frac{2\\sin\\!\\bigl(\\tfrac{k_j\\Delta}{2}\\bigr)}{k_j},\n\\quad j=1,2.\n$$\n\n4. Combine results:\n$$\n\\hat{G}(\\mathbf{k})\n=\\frac{1}{\\Delta^2}\\,\\frac{2\\sin\\!\\bigl(\\tfrac{k_1\\Delta}{2}\\bigr)}{k_1}\n\\frac{2\\sin\\!\\bigl(\\tfrac{k_2\\Delta}{2}\\bigr)}{k_2}\n=\\frac{4}{\\Delta^2k_1k_2}\\sin\\!\\Bigl(\\tfrac{k_1\\Delta}{2}\\Bigr)\\sin\\!\\Bigl(\\tfrac{k_2\\Delta}{2}\\Bigr).\n$$\nRewriting in normalized sinc form:\n$$\n\\hat{G}(\\mathbf{k})\n=\\frac{\\sin\\!\\bigl(\\tfrac{k_1\\Delta}{2}\\bigr)}{\\tfrac{k_1\\Delta}{2}}\n\\;\\frac{\\sin\\!\\bigl(\\tfrac{k_2\\Delta}{2}\\bigr)}{\\tfrac{k_2\\Delta}{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\sin\\!\\bigl(\\tfrac{k_1\\Delta}{2}\\bigr)}{\\tfrac{k_1\\Delta}{2}}\\;\\frac{\\sin\\!\\bigl(\\tfrac{k_2\\Delta}{2}\\bigr)}{\\tfrac{k_2\\Delta}{2}}}$$", "id": "481692"}, {"introduction": "With a grasp of the filtering operation, we now investigate its most critical consequence in fluid dynamics. This practice [@problem_id:481779] moves from abstract definitions to a concrete application by calculating the subgrid-scale (SGS) stress tensor for an idealized flow, the Taylor-Green vortex. This exercise powerfully illustrates the 'closure problem' of Large Eddy Simulation: you will find that even when the filtered velocities are known exactly, an unclosed stress term, $\\tau_{ij} = \\overline{u_i u_j} - \\bar{u}_i \\bar{u}_j$, arises from the nonlinear interactions, highlighting the very reason turbulence models are necessary.", "problem": "In the context of Large Eddy Simulation (LES) of turbulent flows, the velocity field $\\mathbf{u}(\\mathbf{x}, t)$ is decomposed into a resolved (large-scale) component, $\\bar{\\mathbf{u}}(\\mathbf{x}, t)$, and a subgrid-scale (unresolved) component, $\\mathbf{u}'(\\mathbf{x}, t)$, via a low-pass filtering operation. Applying this filter to the incompressible Navier-Stokes equations gives rise to an unclosed term known as the subgrid-scale (SGS) stress tensor, $\\tau_{ij} = \\overline{u_i u_j} - \\bar{u}_i \\bar{u}_j$. This tensor represents the effect of the unresolved scales on the resolved scales and must be modeled.\n\nConsider the two-dimensional Taylor-Green vortex, an exact analytical solution to the incompressible Navier-Stokes equations, which describes a decaying grid of counter-rotating vortices. The velocity components are given by:\n$$\nu_1(x_1, x_2, t) = U_0 e^{-2\\nu k_0^2 t} \\cos(k_0 x_1) \\sin(k_0 x_2)\n$$\n$$\nu_2(x_1, x_2, t) = -U_0 e^{-2\\nu k_0^2 t} \\sin(k_0 x_1) \\cos(k_0 x_2)\n$$\nwhere $U_0$ is a characteristic velocity, $k_0$ is the fundamental wavenumber, and $\\nu$ is the kinematic viscosity.\n\nWe apply a sharp spectral filter (or ideal cut-off filter) to this flow. The filter operation is defined in Fourier space. For any function $f(\\mathbf{x})$, its filtered counterpart $\\bar{f}(\\mathbf{x})$ is obtained by multiplying its Fourier transform, $\\hat{f}(\\mathbf{k})$, by a filter function $\\hat{G}(\\mathbf{k})$ such that $\\hat{\\bar{f}}(\\mathbf{k}) = \\hat{G}(\\mathbf{k})\\hat{f}(\\mathbf{k})$. The sharp spectral filter is defined by:\n$$\n\\hat{G}(\\mathbf{k}) = \\begin{cases} 1 & \\text{if } |\\mathbf{k}| \\le k_c \\\\ 0 & \\text{if } |\\mathbf{k}| > k_c \\end{cases}\n$$\nwhere $\\mathbf{k}=(k_1, k_2)$ is the wavevector and $k_c$ is the cutoff wavenumber.\n\nSet the filter cutoff wavenumber to be $k_c = \\sqrt{3} k_0$. Derive the exact analytical expression for the off-diagonal component of the subgrid-scale stress tensor, $\\tau_{12}(x_1, x_2, t)$.", "solution": "1. Define the SGS stress component\n$$\n\\tau_{12}=\\overline{u_1u_2}-\\bar u_1\\,\\bar u_2.\n$$\n\n2. Write the exact product $u_1u_2$:\n$$\nu_1u_2\n=-U_0^2e^{-4\\nu k_0^2t}\\,\\cos(k_0x_1)\\sin(k_0x_2)\\,\\sin(k_0x_1)\\cos(k_0x_2)\n=-\\frac{U_0^2}{4}e^{-4\\nu k_0^2t}\\sin(2k_0x_1)\\sin(2k_0x_2).\n$$\n\n3. Observe that each velocity component has Fourier support at $|\\mathbf{k}|=\\sqrt2\\,k_0<\\sqrt3\\,k_0$, so\n$$\n\\bar u_1=u_1,\\quad\\bar u_2=u_2,\n$$\nand hence\n$$\n\\bar u_1\\,\\bar u_2\n=u_1u_2\n=-\\frac{U_0^2}{4}e^{-4\\nu k_0^2t}\\sin(2k_0x_1)\\sin(2k_0x_2).\n$$\n\n4. The product $u_1u_2\\propto\\sin(2k_0x_1)\\sin(2k_0x_2)$ has Fourier modes at $|\\mathbf{k}|=2\\sqrt2\\,k_0>\\sqrt3\\,k_0$, so the sharp spectral filter annihilates it:\n$$\n\\overline{u_1u_2}=0.\n$$\n\n5. Therefore\n$$\n\\tau_{12}\n=\\overline{u_1u_2}-\\bar u_1\\,\\bar u_2\n=0-\\bigl(-\\tfrac{U_0^2}{4}e^{-4\\nu k_0^2t}\\sin(2k_0x_1)\\sin(2k_0x_2)\\bigr)\n=\\frac{U_0^2}{4}e^{-4\\nu k_0^2t}\\sin(2k_0x_1)\\sin(2k_0x_2).\n$$", "answer": "$$\\boxed{\\frac{U_0^2}{4}e^{-4\\nu k_0^2t}\\sin\\bigl(2k_0x_1\\bigr)\\sin\\bigl(2k_0x_2\\bigr)}$$", "id": "481779"}, {"introduction": "The choice of filter is a key decision in any Large Eddy Simulation, yet different filters, like the smooth Gaussian and the abrupt sharp spectral cutoff, are not immediately comparable. This final exercise [@problem_id:481790] delves into this nuance by asking you to find an equivalence between these two filters based on a physically crucial metric: the subfilter-scale kinetic energy. By working with the Kolmogorov energy spectrum, you will develop a more sophisticated understanding of how a filter's properties relate to the energy cascade of turbulence and learn a practical method for characterizing its effective cutoff.", "problem": "In Large Eddy Simulation (LES) of turbulence, a spatial filtering operation is used to separate the large, energy-containing scales of motion from the small, subfilter scales. The filtered velocity field, $\\bar{\\mathbf{u}}(\\mathbf{x})$, is defined by a convolution with a filter kernel $G$. Two common one-dimensional filters are the Gaussian filter and the sharp spectral cutoff filter.\n\nThe one-dimensional Gaussian filter is defined in physical space by the kernel\n$$\nG_\\Delta(x) = \\frac{1}{\\Delta \\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2\\Delta^2}\\right)\n$$\nwhere $\\Delta$ is the characteristic filter width. Its Fourier transform (or transfer function) is $\\hat{G}_\\Delta(k) = \\exp\\left(-\\frac{k^2\\Delta^2}{2}\\right)$.\n\nThe one-dimensional sharp spectral cutoff filter is defined in Fourier space by its transfer function\n$$\n\\hat{G}_c(k) = \\begin{cases} 1 & |k| \\le k_c \\\\ 0 & |k| > k_c \\end{cases}\n$$\nwhere $k_c$ is the cutoff wavenumber.\n\nA key quantity in LES is the subfilter-scale (SFS) kinetic energy, which represents the kinetic energy of the scales removed by the filter. For a given one-dimensional kinetic energy spectrum $E(k)$, the SFS energy is given by\n$$\nk_{sfs} = \\int_0^\\infty E(k) \\left(1 - |\\hat{G}(k)|^2\\right) dk\n$$\nAssume the energy spectrum in the inertial subrange is described by the Kolmogorov power law, $E(k) = A k^{-5/3}$, where $A$ is a constant.\n\nBy equating the subfilter-scale kinetic energy produced by the Gaussian filter to that produced by the sharp spectral cutoff filter, derive an expression for the equivalent cutoff wavenumber $k_c$ in terms of the Gaussian filter width $\\Delta$. The relationship can be written as $k_c = \\frac{\\alpha}{\\Delta}$. Derive the exact analytical expression for the constant $\\alpha$.", "solution": "We equate the SFS‐kinetic energies for the Gaussian filter and the spectral cutoff filter with $E(k)=Ak^{-5/3}$.\n\n1. Definitions of SFS energy  \n$$\nk_{sfs}^G=\\int_0^\\infty A\\,k^{-5/3}\\bigl(1-e^{-k^2\\Delta^2}\\bigr)\\,dk,\n\\qquad\nk_{sfs}^c=\\int_0^\\infty A\\,k^{-5/3}\\bigl(1-|\\hat G_c|^2\\bigr)\\,dk\n=\\int_{k_c}^\\infty A\\,k^{-5/3}dk.\n$$\n\n2. Evaluate the cutoff integral  \n$$\n\\int_{k_c}^\\infty k^{-5/3}dk\n=\\Bigl[-\\tfrac{3}{2}k^{-2/3}\\Bigr]_{k_c}^\\infty\n=\\tfrac{3}{2}k_c^{-2/3}.\n$$\n\n3. Evaluate the Gaussian integral by $x=k^2\\Delta^2$  \n$$\nI=\\int_0^\\infty k^{-5/3}(1-e^{-k^2\\Delta^2})dk\n=\\frac12\\,\\Delta^{2/3}\\!\\int_0^\\infty x^{-4/3}(1-e^{-x})dx.\n$$\nUse \n$$\n\\int_0^\\infty x^{\\alpha-1}(1-e^{-x})dx\n=-\\frac{\\Gamma(\\alpha+1)}{\\alpha},\\quad\\alpha=-\\tfrac13,\n$$\nso\n$$\nI=\\frac12\\,\\Delta^{2/3}\n\\Bigl(3\\,\\Gamma(\\tfrac23)\\Bigr)\n=\\frac{3}{2}\\,\\Gamma\\!\\bigl(\\tfrac23\\bigr)\\,\\Delta^{2/3}.\n$$\n\n4. Equate SFS energies and solve for $k_c$  \n$$\n\\frac{3}{2}\\Gamma\\bigl(\\tfrac23\\bigr)\\Delta^{2/3}\n=\\frac{3}{2}k_c^{-2/3}\n\\quad\\Longrightarrow\\quad\nk_c^{-2/3}=\\Gamma\\bigl(\\tfrac23\\bigr)\\Delta^{2/3}\n\\;\\Longrightarrow\\;\nk_c=\\bigl[\\Gamma(\\tfrac23)\\bigr]^{-\\tfrac32}\\,\\Delta^{-1}.\n$$\n\nThus $k_c=\\alpha/\\Delta$ with \n$$\n\\alpha=\\bigl[\\Gamma(\\tfrac23)\\bigr]^{-\\tfrac32}.\n$$", "answer": "$$\\boxed{\\frac{1}{\\left[\\Gamma\\!\\bigl(\\tfrac{2}{3}\\bigr)\\right]^{3/2}}}$$", "id": "481790"}]}