{"hands_on_practices": [{"introduction": "Many problems in solid mechanics involve geometries like cylinders or spheres, requiring the use of curvilinear coordinates. Simply memorizing the form of differential operators in these systems is not enough for deep understanding. This exercise [@problem_id:2644624] guides you through the fundamental derivation of the divergence operator in cylindrical coordinates, starting from the general definition of the covariant derivative. By working through this process, you will gain a robust understanding of how the geometry of the space, captured by the metric tensor and Christoffel symbols, dictates the form of these crucial operators.", "problem": "Consider small-deformation kinematics of an axisymmetric solid body using cylindrical coordinates $(r,\\theta,z)$ with the line element $ds^{2}=dr^{2}+r^{2}d\\theta^{2}+dz^{2}$. Let the material velocity field be axisymmetric and have no circumferential component, so that $\\mathbf{v}(r,z)=v_{r}(r,z)\\,\\mathbf{e}_{r}+v_{z}(r,z)\\,\\mathbf{e}_{z}$ with $\\partial_{\\theta}(\\cdot)=0$ and $v_{\\theta}=0$. The volumetric strain rate equals the divergence of $\\mathbf{v}$.\n\nStarting from the covariant definition of divergence in a general curvilinear coordinate system,\n$$\n\\nabla\\cdot\\mathbf{v}=\\nabla_{i}v^{i},\n$$\nwhere $\\nabla_{i}v^{j}=\\partial_{i}v^{j}+\\Gamma^{j}_{\\,ik}v^{k}$, and using only the cylindrical metric $g_{ij}=\\mathrm{diag}(1,r^{2},1)$, derive the expression for $\\nabla\\cdot\\mathbf{v}$ specialized to the axisymmetric case described above. Then, for the specific axisymmetric field\n$$\nv_{r}(r,z)=\\alpha\\,r\\,z^{2}+\\beta\\,r^{3},\\qquad v_{z}(r,z)=\\gamma\\,z^{3}+\\delta\\,r^{2}z,\n$$\nwith $\\alpha,\\beta,\\gamma,\\delta$ being constants, compute the divergence $\\nabla\\cdot\\mathbf{v}$ as a simplified analytic function of $r$ and $z$. Express your final answer as a single closed-form expression in terms of $\\alpha,\\beta,\\gamma,\\delta,r,z$. No numerical evaluation is required and no units need to be reported.", "solution": "The task is to compute the divergence of the given velocity field, $\\nabla \\cdot \\mathbf{v}$. The problem specifies using the general definition of covariant divergence, $\\nabla\\cdot\\mathbf{v}=\\nabla_{i}v^{i}$, where repeated indices imply summation. Let the coordinates be $x^{1}=r$, $x^{2}=\\theta$, $x^{3}=z$. The definition expands to:\n$$\n\\nabla\\cdot\\mathbf{v} = \\sum_{i=1}^{3} \\nabla_{i}v^{i} = \\sum_{i=1}^{3} \\left( \\frac{\\partial v^{i}}{\\partial x^{i}} + \\sum_{j,k=1}^{3} \\Gamma^{i}_{\\,jk} v^{j} \\right)\n$$\nThis is incorrect. The summation is not over all indices. The correct expansion of the contracted covariant derivative is:\n$$\n\\nabla\\cdot\\mathbf{v} = \\nabla_{i}v^{i} = \\frac{\\partial v^{i}}{\\partial x^{i}} + \\Gamma^{i}_{\\,ik}v^{k}\n$$\nThe problem statement itself gives $\\nabla_{i}v^{j}=\\partial_{i}v^{j}+\\Gamma^{j}_{\\,ik}v^{k}$, so $\\nabla_{i}v^{i}=\\partial_{i}v^{i}+\\Gamma^{i}_{\\,ik}v^{k}$. Let us expand this sum over $i$ and $k$:\n$$\n\\nabla\\cdot\\mathbf{v} = \\left(\\frac{\\partial v^{r}}{\\partial r}+\\frac{\\partial v^{\\theta}}{\\partial \\theta}+\\frac{\\partial v^{z}}{\\partial z}\\right) + \\left(\\Gamma^{r}_{\\,rk}v^{k} + \\Gamma^{\\theta}_{\\,\\theta k}v^{k} + \\Gamma^{z}_{\\,zk}v^{k}\\right)\n$$\nThe velocity field is given in terms of its physical components, $\\mathbf{v} = v_{r}\\mathbf{e}_{r} + v_{z}\\mathbf{e}_{z}$. The relationship between physical components $(v_{\\hat{r}}, v_{\\hat{\\theta}}, v_{\\hat{z}})$ and contravariant components $(v^r, v^\\theta, v^z)$ is $v_{\\hat{i}} = \\sqrt{g_{ii}} v^i$ (no summation). The metric tensor is $g_{ij} = \\mathrm{diag}(1, r^{2}, 1)$.\nThus, we have:\n$v_{r} = v_{\\hat{r}} = \\sqrt{g_{rr}}v^{r} = \\sqrt{1}v^{r} = v^{r}$.\n$v_{\\theta} = v_{\\hat{\\theta}} = \\sqrt{g_{\\theta\\theta}}v^{\\theta} = r v^{\\theta}$. Since $v_{\\theta}=0$, it follows that $v^{\\theta}=0$.\n$v_{z} = v_{\\hat{z}} = \\sqrt{g_{zz}}v^{z} = \\sqrt{1}v^{z} = v^{z}$.\nThe contravariant velocity components are $(v^r, v^\\theta, v^z) = (v_r(r,z), 0, v_z(r,z))$.\nThe problem also states axisymmetry, so $\\partial_{\\theta}(\\cdot) = 0$.\nSubstituting these into the expanded divergence formula:\n$$\n\\nabla\\cdot\\mathbf{v} = \\left(\\frac{\\partial v_{r}}{\\partial r} + 0 + \\frac{\\partial v_{z}}{\\partial z}\\right) + \\left(\\Gamma^{r}_{r r}v_{r} + \\Gamma^{r}_{r z}v_{z}\\right) + \\left(\\Gamma^{\\theta}_{\\theta r}v_{r} + \\Gamma^{\\theta}_{\\theta z}v_{z}\\right) + \\left(\\Gamma^{z}_{z r}v_{r} + \\Gamma^{z}_{z z}v_{z}\\right)\n$$\nWe must now compute the Christoffel symbols of the second kind, $\\Gamma^{i}_{\\,jk} = \\frac{1}{2}g^{im}\\left(\\partial_{j}g_{mk} + \\partial_{k}g_{mj} - \\partial_{m}g_{jk}\\right)$.\nThe metric tensor is $g_{ij} = \\mathrm{diag}(1, r^{2}, 1)$ and its inverse is $g^{ij} = \\mathrm{diag}(1, r^{-2}, 1)$.\nThe only non-zero partial derivative of the metric components is $\\partial_{r}g_{\\theta\\theta} = \\partial_{1}g_{22} = 2r$.\nLet us calculate the required Christoffel symbols:\n$\\Gamma^{r}_{rr} = \\frac{1}{2}g^{rr}(\\partial_{r}g_{rr} + \\partial_{r}g_{rr} - \\partial_{r}g_{rr}) = 0$.\n$\\Gamma^{r}_{rz} = \\frac{1}{2}g^{rr}(\\partial_{r}g_{zr} + \\partial_{z}g_{rr} - \\partial_{r}g_{rz}) = 0$.\n$\\Gamma^{\\theta}_{\\theta r} = \\frac{1}{2}g^{\\theta\\theta}(\\partial_{\\theta}g_{r\\theta} + \\partial_{r}g_{\\theta\\theta} - \\partial_{\\theta}g_{\\theta r}) = \\frac{1}{2}r^{-2}(0+2r-0) = \\frac{1}{r}$.\n$\\Gamma^{\\theta}_{\\theta z} = \\frac{1}{2}g^{\\theta\\theta}(\\partial_{\\theta}g_{z\\theta} + \\partial_{z}g_{\\theta\\theta} - \\partial_{\\theta}g_{\\theta z}) = \\frac{1}{2}r^{-2}(0+0-0) = 0$.\n$\\Gamma^{z}_{zr} = \\frac{1}{2}g^{zz}(\\partial_{z}g_{rz} + \\partial_{r}g_{zz} - \\partial_{z}g_{zr}) = 0$.\n$\\Gamma^{z}_{zz} = \\frac{1}{2}g^{zz}(\\partial_{z}g_{zz} + \\partial_{z}g_{zz} - \\partial_{z}g_{zz}) = 0$.\nSubstituting these values back into the expression for the divergence:\n$$\n\\nabla\\cdot\\mathbf{v} = \\frac{\\partial v_{r}}{\\partial r} + \\frac{\\partial v_{z}}{\\partial z} + (0)v_{r} + (0)v_{z} + \\left(\\frac{1}{r}\\right)v_{r} + (0)v_{z} + (0)v_{r} + (0)v_{z}\n$$\n$$\n\\nabla\\cdot\\mathbf{v} = \\frac{\\partial v_{r}}{\\partial r} + \\frac{v_{r}}{r} + \\frac{\\partial v_{z}}{\\partial z}\n$$\nThis is the expression for the divergence of an axisymmetric vector field with no circumferential component in cylindrical coordinates. This expression can be more compactly written as $\\frac{1}{r}\\frac{\\partial}{\\partial r}(r v_{r}) + \\frac{\\partial v_{z}}{\\partial z}$.\n\nNow we apply this formula to the specific velocity field given:\n$v_{r}(r,z) = \\alpha r z^{2} + \\beta r^{3}$\n$v_{z}(r,z) = \\gamma z^{3} + \\delta r^{2} z$\n\nWe compute the necessary partial derivatives:\n$$\n\\frac{\\partial v_{r}}{\\partial r} = \\frac{\\partial}{\\partial r}(\\alpha r z^{2} + \\beta r^{3}) = \\alpha z^{2} + 3\\beta r^{2}\n$$\n$$\n\\frac{\\partial v_{z}}{\\partial z} = \\frac{\\partial}{\\partial z}(\\gamma z^{3} + \\delta r^{2} z) = 3\\gamma z^{2} + \\delta r^{2}\n$$\nNow, substitute these derivatives and $v_r$ into the divergence formula:\n$$\n\\nabla\\cdot\\mathbf{v} = \\left(\\alpha z^{2} + 3\\beta r^{2}\\right) + \\frac{1}{r}\\left(\\alpha r z^{2} + \\beta r^{3}\\right) + \\left(3\\gamma z^{2} + \\delta r^{2}\\right)\n$$\nSimplify the term $\\frac{v_r}{r}$:\n$$\n\\frac{1}{r}\\left(\\alpha r z^{2} + \\beta r^{3}\\right) = \\alpha z^{2} + \\beta r^{2}\n$$\nCombine all terms:\n$$\n\\nabla\\cdot\\mathbf{v} = (\\alpha z^{2} + 3\\beta r^{2}) + (\\alpha z^{2} + \\beta r^{2}) + (3\\gamma z^{2} + \\delta r^{2})\n$$\nGroup terms by powers of $r$ and $z$:\n$$\n\\nabla\\cdot\\mathbf{v} = (3\\beta + \\beta + \\delta)r^{2} + (\\alpha + \\alpha + 3\\gamma)z^{2}\n$$\nFinally, we arrive at the simplified expression for the divergence:\n$$\n\\nabla\\cdot\\mathbf{v} = (4\\beta + \\delta)r^{2} + (2\\alpha + 3\\gamma)z^{2}\n$$\nThis is the final analytical function for the divergence of the given velocity field.", "answer": "$$\n\\boxed{(4\\beta + \\delta)r^{2} + (2\\alpha + 3\\gamma)z^{2}}\n$$", "id": "2644624"}, {"introduction": "In the theory of finite elasticity, we must carefully distinguish between the undeformed (material) and deformed (spatial) configurations of a body. Physical laws can be written in either frame, and it is essential to know how to translate vector and tensor quantities between them. This practice [@problem_id:2644646] provides hands-on experience with the Piola transform, which maps vector fields from the spatial to the material frame. By performing this transformation and verifying a key identity for the divergence, you will solidify your grasp of the kinematics of large deformations.", "problem": "A homogeneous deformation maps a reference configuration with position vector $X \\in \\mathbb{R}^{3}$ to the current configuration with position vector $x \\in \\mathbb{R}^{3}$ by $x=\\chi(X)=\\mathbf{F}X$, where $\\mathbf{F}=\\mathrm{diag}(\\lambda,1,1)$ with $\\lambda>0$ and $J=\\det \\mathbf{F}=\\lambda$. Consider the spatial vector field $v(x)$ defined in the current configuration by $v(x)=\\begin{pmatrix}x_{1}\\\\ x_{2}^{2}\\\\ x_{3}^{3}\\end{pmatrix}$. Assume all quantities are non-dimensional.\n\nStarting only from the conservation of flux across corresponding surfaces in the reference and current configurations and from the divergence theorem, determine the referential vector field $V(X)$ whose flux through any material surface in the reference configuration equals the flux of $v(x)$ through the image surface in the current configuration under the given deformation. Then compute the divergence of this referential field with respect to $X$ and compare it to the spatial divergence of $v(x)$ evaluated at $x=\\chi(X)$ multiplied by $J$. Provide a closed-form expression for $\\mathrm{Div}_{X}\\,V(X)$.\n\nYour final answer must be a single analytic expression in terms of $\\lambda$, $X_{2}$, and $X_{3}$, with no units or approximations.", "solution": "The problem states that the referential vector field $V(X)$ and the spatial vector field $v(x)$ are related by the conservation of flux through corresponding material and spatial surfaces, $S_0$ and $S = \\chi(S_0)$, respectively. This relationship is given by the integral equality:\n$$\n\\int_{S_0} V(X) \\cdot N \\, dS_0 = \\int_S v(x) \\cdot n \\, dS\n$$\nwhere $N$ is the unit normal to the surface $S_0$ in the reference configuration and $n$ is the unit normal to the surface $S$ in the current configuration.\n\nTo find the local relationship between $V(X)$ and $v(x)$, we must relate the differential surface elements. This is accomplished using Nanson's formula, which connects the spatial surface element $n \\, dS$ to the material surface element $N \\, dS_0$:\n$$\nn \\, dS = J (\\mathbf{F}^{-T}) N \\, dS_0\n$$\nwhere $\\mathbf{F}$ is the deformation gradient, $J = \\det \\mathbf{F}$ is the Jacobian of the deformation, and $\\mathbf{F}^{-T} = (\\mathbf{F}^{-1})^T$.\n\nSubstituting Nanson's formula into the flux conservation equation gives:\n$$\n\\int_{S_0} V(X) \\cdot N \\, dS_0 = \\int_{S_0} v(\\chi(X)) \\cdot (J (\\mathbf{F}^{-T}) N) \\, dS_0\n$$\nUsing the property of the dot product $(A\\mathbf{a}) \\cdot \\mathbf{b} = \\mathbf{a} \\cdot (A^T \\mathbf{b})$, we can rewrite the right-hand side integrand:\n$$\nv \\cdot (J \\mathbf{F}^{-T} N) = (J (\\mathbf{F}^{-T})^T v) \\cdot N = (J \\mathbf{F}^{-1} v) \\cdot N\n$$\nThe integral equality thus becomes:\n$$\n\\int_{S_0} V(X) \\cdot N \\, dS_0 = \\int_{S_0} (J \\mathbf{F}^{-1} v(\\chi(X))) \\cdot N \\, dS_0\n$$\nSince this equality must hold for any arbitrary material surface $S_0$, the integrands must be equal for any choice of normal vector $N$. This implies the local relationship:\n$$\nV(X) = J \\mathbf{F}^{-1} v(\\chi(X))\n$$\nThis is the Piola transform of the vector field $v$.\n\nNow we compute this expression for the given data. The deformation gradient is $\\mathbf{F} = \\mathrm{diag}(\\lambda, 1, 1)$, so its inverse is $\\mathbf{F}^{-1} = \\mathrm{diag}(\\lambda^{-1}, 1, 1)$. The Jacobian is $J = \\det \\mathbf{F} = \\lambda$.\nThe spatial vector field is $v(x) = \\begin{pmatrix} x_1 \\\\ x_2^2 \\\\ x_3^3 \\end{pmatrix}$.\nThe deformation map is $x = \\mathbf{F}X$, which in component form is $x_1 = \\lambda X_1$, $x_2 = X_2$, and $x_3 = X_3$.\nWe express $v$ in terms of the material coordinates $X$:\n$$\nv(\\chi(X)) = \\begin{pmatrix} \\lambda X_1 \\\\ X_2^2 \\\\ X_3^3 \\end{pmatrix}\n$$\nNow we can determine the referential field $V(X)$:\n$$\nV(X) = J \\mathbf{F}^{-1} v(\\chi(X)) = \\lambda \\begin{pmatrix} \\lambda^{-1} & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\lambda X_1 \\\\ X_2^2 \\\\ X_3^3 \\end{pmatrix}\n$$\n$$\nV(X) = \\lambda \\begin{pmatrix} \\lambda^{-1} (\\lambda X_1) \\\\ (1)(X_2^2) \\\\ (1)(X_3^3) \\end{pmatrix} = \\lambda \\begin{pmatrix} X_1 \\\\ X_2^2 \\\\ X_3^3 \\end{pmatrix} = \\begin{pmatrix} \\lambda X_1 \\\\ \\lambda X_2^2 \\\\ \\lambda X_3^3 \\end{pmatrix}\n$$\nThis is the referential vector field $V(X)$.\n\nThe next step is to compute the divergence of $V(X)$ with respect to the material coordinates $X = (X_1, X_2, X_3)$, denoted as $\\mathrm{Div}_{X}\\,V(X)$.\n$$\n\\mathrm{Div}_{X}\\,V(X) = \\frac{\\partial V_1}{\\partial X_1} + \\frac{\\partial V_2}{\\partial X_2} + \\frac{\\partial V_3}{\\partial X_3}\n$$\nThe components of $V(X)$ are $V_1 = \\lambda X_1$, $V_2 = \\lambda X_2^2$, and $V_3 = \\lambda X_3^3$. Their partial derivatives are:\n$$\n\\frac{\\partial V_1}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(\\lambda X_1) = \\lambda\n$$\n$$\n\\frac{\\partial V_2}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(\\lambda X_2^2) = 2 \\lambda X_2\n$$\n$$\n\\frac{\\partial V_3}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(\\lambda X_3^3) = 3 \\lambda X_3^2\n$$\nSumming these components gives the divergence of the referential field:\n$$\n\\mathrm{Div}_{X}\\,V(X) = \\lambda + 2 \\lambda X_2 + 3 \\lambda X_3^2 = \\lambda (1 + 2 X_2 + 3 X_3^2)\n$$\n\nFinally, for comparison, we compute the spatial divergence of $v(x)$ and relate it to the material divergence. The spatial divergence, $\\mathrm{div}_{x}\\,v(x)$, is with respect to the spatial coordinates $x=(x_1, x_2, x_3)$:\n$$\n\\mathrm{div}_{x}\\,v(x) = \\frac{\\partial v_1}{\\partial x_1} + \\frac{\\partial v_2}{\\partial x_2} + \\frac{\\partial v_3}{\\partial x_3}\n$$\nThe components of $v(x)$ are $v_1 = x_1$, $v_2 = x_2^2$, and $v_3 = x_3^3$. Their partial derivatives are:\n$$\n\\frac{\\partial v_1}{\\partial x_1} = 1\n$$\n$$\n\\frac{\\partial v_2}{\\partial x_2} = 2 x_2\n$$\n$$\n\\frac{\\partial v_3}{\\partial x_3} = 3 x_3^2\n$$\nSo, the spatial divergence is:\n$$\n\\mathrm{div}_{x}\\,v(x) = 1 + 2 x_2 + 3 x_3^2\n$$\nThe problem asks to compare $\\mathrm{Div}_{X}\\,V(X)$ to $J \\cdot (\\mathrm{div}_{x}\\,v)$ evaluated in the reference configuration. We multiply by $J=\\lambda$ and substitute the mapping $x_2=X_2, x_3=X_3$:\n$$\nJ \\cdot (\\mathrm{div}_{x}\\,v(\\chi(X))) = \\lambda (1 + 2 X_2 + 3 X_3^2) = \\lambda + 2 \\lambda X_2 + 3 \\lambda X_3^2\n$$\nComparing this result with the previously computed $\\mathrm{Div}_{X}\\,V(X)$, we see they are identical. This confirms the general identity for Piola-transformed vector fields, $\\mathrm{Div}(J\\mathbf{F}^{-1}v) = J(\\mathrm{div}\\,v)\\circ\\chi$.\n\nThe problem requires a closed-form expression for $\\mathrm{Div}_{X}\\,V(X)$. This has been found to be $\\lambda(1 + 2 X_2 + 3 X_3^2)$.", "answer": "$$\\boxed{\\lambda(1 + 2 X_2 + 3 X_3^2)}$$", "id": "2644646"}, {"introduction": "Bridging the gap between continuous mechanics and computational simulation requires discretizing differential operators in a way that preserves their essential mathematical structure. This advanced exercise [@problem_id:2644608] explores the powerful concept of mimetic finite differences on a staggered grid. You will construct discrete divergence and curl operators directly from their integral definitions and prove that the fundamental vector identity $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = \\mathbf{0}$ is satisfied exactly, a property crucial for robust simulations in fields like electromagnetism and dislocation mechanics.", "problem": "In three-dimensional linear elasticity and dislocation mechanics, the vector potential field $\\mathbf{A}$ is often introduced so that the incompatibility associated with dislocation density can be represented by the curl of $\\mathbf{A}$. Consider a uniform Cartesian grid with spacings $h_x$, $h_y$, and $h_z$ in the $x$-, $y$-, and $z$-directions, respectively, with periodic boundary conditions. Adopt a staggered placement of degrees of freedom as follows: the components of the vector potential $\\mathbf{A} = (A_x, A_y, A_z)$ are stored on edges aligned with their respective coordinate axes, that is, $A_x$ at locations $(i, j+\\tfrac{1}{2}, k+\\tfrac{1}{2})$, $A_y$ at $(i+\\tfrac{1}{2}, j, k+\\tfrac{1}{2})$, and $A_z$ at $(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}, k)$, where $(i,j,k)\\in\\mathbb{Z}^3$ indexes the cell centers at positions $(i h_x, j h_y, k h_z)$. Define a discrete curl operator $\\nabla_h \\times$ that produces a face-centered field $\\mathbf{B} = \\nabla_h \\times \\mathbf{A}$, with $B_x$ at $(i+\\tfrac{1}{2}, j, k)$, $B_y$ at $(i, j+\\tfrac{1}{2}, k)$, and $B_z$ at $(i, j, k+\\tfrac{1}{2})$, by invoking the integral definition of the curl via Stokes’ theorem on each face and approximating the circulation by oriented edge differences divided by the face area. Then define a discrete divergence operator $\\nabla_h \\cdot$ that maps face-centered fields to cell centers by invoking Gauss’ theorem and approximating fluxes as signed face contributions divided by the cell volume.\n\nUsing only the fundamental integral theorems of vector calculus (Stokes’ theorem and Gauss’ divergence theorem) as your starting point, derive the central-difference stencils that result from these constructions for all components of $\\nabla_h \\times \\mathbf{A}$ and for $\\nabla_h \\cdot \\mathbf{B}$. Prove that for any discrete edge-centered field $\\mathbf{A}$ on this staggered grid, the composition $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A})$ vanishes identically at every cell center.\n\nFinally, consider the discrete Fourier transform corresponding to the periodic grid and the above staggering, and compute the discrete Fourier symbol of the composed operator $\\nabla_h \\cdot (\\nabla_h \\times \\cdot)$. Report this symbol as a single scalar expression as your final answer. No numerical rounding is required for your answer, and no physical units are needed.", "solution": "The goal is to construct discrete operators from first principles so that the geometric identities of vector calculus are preserved at the discrete level. We begin with the integral definitions that are the foundation of curl and divergence.\n\nBy Stokes’ theorem, for a smooth vector field $\\mathbf{A}$ and a face $S$ with boundary $\\partial S$ and unit normal $\\mathbf{n}$,\n$$\n\\int_{S} (\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{n} \\, dS \\;=\\; \\oint_{\\partial S} \\mathbf{A} \\cdot d\\boldsymbol{\\ell}.\n$$\nOn a rectangular face with edges aligned to coordinate axes, the line integral on the right is the oriented sum of $\\mathbf{A}\\cdot d\\boldsymbol{\\ell}$ along the four edges. On a uniform grid, dividing by the face area provides a consistent discrete approximation of the normal component of $\\nabla \\times \\mathbf{A}$ at the face center. This motivates a discrete curl $\\nabla_h \\times$ that maps the edge-centered components of $\\mathbf{A}$ to face-centered components of $\\mathbf{B}=\\nabla_h\\times\\mathbf{A}$.\n\nSimilarly, by Gauss’ divergence theorem, for a smooth vector field $\\mathbf{B}$ and a cell $V$ with boundary $\\partial V$ and outward unit normal $\\mathbf{n}$,\n$$\n\\int_{V} \\nabla \\cdot \\mathbf{B}\\, dV \\;=\\; \\oint_{\\partial V} \\mathbf{B} \\cdot \\mathbf{n}\\, dS.\n$$\nOn a rectangular cell, the surface integral is the signed sum of normal fluxes across the six faces. On a uniform grid, dividing by the cell volume yields a discrete divergence $\\nabla_h \\cdot$ that maps face-centered $\\mathbf{B}$ to a cell-centered scalar.\n\nWe now write the explicit stencils implied by these constructions.\n\nDefine the face-centered components of $\\mathbf{B}=\\nabla_h\\times\\mathbf{A}$ by\n$$\nB_x\\big|_{i+\\frac{1}{2},j,k} \\;=\\; \\frac{ A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i+\\frac{1}{2},\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;-\\; \\frac{ A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}} }{ h_z },\n$$\n$$\nB_y\\big|_{i,\\,j+\\frac{1}{2},\\,k} \\;=\\; \\frac{ A_x\\big|_{i,\\,j+\\frac{1}{2},\\,k+\\frac{1}{2}} - A_x\\big|_{i,\\,j+\\frac{1}{2},\\,k-\\frac{1}{2}} }{ h_z } \\;-\\; \\frac{ A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i-\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} }{ h_x },\n$$\n$$\nB_z\\big|_{i,\\,j,\\,k+\\frac{1}{2}} \\;=\\; \\frac{ A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} }{ h_x } \\;-\\; \\frac{ A_x\\big|_{i,\\,j+\\frac{1}{2},\\,k+\\frac{1}{2}} - A_x\\big|_{i,\\,j-\\frac{1}{2},\\,k+\\frac{1}{2}} }{ h_y }.\n$$\nThese are the central differences obtained by evaluating the circulation around each face of a control volume, divided by face area, and they place $B_x$, $B_y$, and $B_z$ on the $x$-, $y$-, and $z$-faces, respectively.\n\nDefine the cell-centered discrete divergence of a face-centered field $\\mathbf{B}$ by\n$$\n(\\nabla_h \\cdot \\mathbf{B})\\big|_{i,j,k} \\;=\\; \\frac{ B_x\\big|_{i+\\frac{1}{2},\\,j,\\,k} - B_x\\big|_{i-\\frac{1}{2},\\,j,\\,k} }{ h_x } \\;+\\; \\frac{ B_y\\big|_{i,\\,j+\\frac{1}{2},\\,k} - B_y\\big|_{i,\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;+\\; \\frac{ B_z\\big|_{i,\\,j,\\,k+\\frac{1}{2}} - B_z\\big|_{i,\\,j,\\,k-\\frac{1}{2}} }{ h_z }.\n$$\nThis is the central difference form of Gauss’ theorem, dividing the net outward flux by the cell volume.\n\nWe now prove that $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A}) \\equiv 0$ pointwise at each cell $(i,j,k)$. Substituting $\\mathbf{B}=\\nabla_h\\times\\mathbf{A}$ into the divergence yields\n$$\n(\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A}))\\big|_{i,j,k}\n= D_x B_x + D_y B_y + D_z B_z,\n$$\nwhere, for brevity, we define the centered difference operators in each direction acting on the appropriate staggered fields,\n$$\nD_x B_x \\;=\\; \\frac{ B_x\\big|_{i+\\frac{1}{2},\\,j,\\,k} - B_x\\big|_{i-\\frac{1}{2},\\,j,\\,k} }{ h_x }, \\quad\nD_y B_y \\;=\\; \\frac{ B_y\\big|_{i,\\,j+\\frac{1}{2},\\,k} - B_y\\big|_{i,\\,j-\\frac{1}{2},\\,k} }{ h_y }, \\quad\nD_z B_z \\;=\\; \\frac{ B_z\\big|_{i,\\,j,\\,k+\\frac{1}{2}} - B_z\\big|_{i,\\,j,\\,k-\\frac{1}{2}} }{ h_z }.\n$$\nUsing the curl stencils, expand each term. For $D_x B_x$,\n$$\nD_x B_x \\;=\\; \\frac{1}{h_x}\\left[\n\\left(\\frac{ A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i+\\frac{1}{2},\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;-\\; \\frac{ A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}} }{ h_z }\\right)\n-\n\\left(\\frac{ A_z\\big|_{i-\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i-\\frac{1}{2},\\,j-\\frac{1}{2},\\,k} }{ h_y } \\;-\\; \\frac{ A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}} }{ h_z }\\right)\n\\right].\n$$\nGroup terms to see the action of mixed central differences on edge-centered fields:\n$$\nD_x B_x \\;=\\; \\frac{1}{h_x h_y}\\left[\n\\big(A_z\\big|_{i+\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i+\\frac{1}{2},\\,j-\\frac{1}{2},\\,k}\\big)\n-\n\\big(A_z\\big|_{i-\\frac{1}{2},\\,j+\\frac{1}{2},\\,k} - A_z\\big|_{i-\\frac{1}{2},\\,j-\\frac{1}{2},\\,k}\\big)\n\\right]\n\\;-\\; \\frac{1}{h_x h_z}\\left[\n\\big(A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i+\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}}\\big)\n-\n\\big(A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k+\\frac{1}{2}} - A_y\\big|_{i-\\frac{1}{2},\\,j,\\,k-\\frac{1}{2}}\\big)\n\\right].\n$$\nRecognizing that this is the composition of centered differences in $x$ and $y$ (respectively $x$ and $z$) acting on $A_z$ (respectively $A_y$), we write compactly\n$$\nD_x B_x \\;=\\; D_x D_y A_z \\;-\\; D_x D_z A_y,\n$$\nwith the understanding that $D_x$, $D_y$, and $D_z$ are centered difference operators defined at the appropriate staggered locations so that these compositions are well-defined.\n\nAnalogously, expand the other terms:\n$$\nD_y B_y \\;=\\; D_y D_z A_x \\;-\\; D_y D_x A_z,\\qquad\nD_z B_z \\;=\\; D_z D_x A_y \\;-\\; D_z D_y A_x.\n$$\nSumming these three expressions, we have\n$$\nD_x B_x + D_y B_y + D_z B_z\n\\;=\\;\n\\big(D_x D_y A_z - D_y D_x A_z\\big)\n\\;+\\;\n\\big(D_y D_z A_x - D_z D_y A_x\\big)\n\\;+\\;\n\\big(D_z D_x A_y - D_x D_z A_y\\big).\n$$\nOn a uniform grid with the stated staggering, the centered difference operators commute when acting on the consistently staggered fields, that is,\n$$\nD_\\alpha D_\\beta \\phi \\;=\\; D_\\beta D_\\alpha \\phi\n$$\nfor any pair of directions $\\alpha,\\beta\\in\\{x,y,z\\}$ and any discrete scalar field $\\phi$ located at the appropriate staggered positions. This commutativity follows from the translational invariance and symmetry of the uniform central differences and is visible directly from the index expressions as mixed second differences that are symmetric in the order of application. Consequently, each parenthesis in the sum vanishes:\n$$\nD_x D_y A_z - D_y D_x A_z \\;=\\; 0,\\quad\nD_y D_z A_x - D_z D_y A_x \\;=\\; 0,\\quad\nD_z D_x A_y - D_x D_z A_y \\;=\\; 0.\n$$\nTherefore,\n$$\n(\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A}))\\big|_{i,j,k} \\;=\\; 0\n$$\nat every cell center $(i,j,k)$ for all discrete edge-centered fields $\\mathbf{A}$, as required.\n\nWe now compute the discrete Fourier symbol of the composed operator. Let the grid be periodic and consider a discrete Fourier mode consistent with the staggering. While the individual symbols of $D_x$, $D_y$, $D_z$, and the staggered interpolations carry phase factors due to half-index shifts, the above pointwise identity shows that the composition $\\nabla_h \\cdot (\\nabla_h \\times \\cdot)$ is identically zero as a discrete operator. Hence its discrete Fourier symbol, which is the representation of the operator in the Fourier basis, is the scalar $0$ for all discrete wavenumbers. No further calculation is necessary beyond the established identity, because a linear operator that is identically zero in physical space has identically zero symbol in Fourier space.\n\nThus, the discrete Fourier symbol of $\\nabla_h \\cdot (\\nabla_h \\times \\cdot)$ is $0$.", "answer": "$$\\boxed{0}$$", "id": "2644608"}]}