{"hands_on_practices": [{"introduction": "The transformation of a stress tensor into its principal values is a cornerstone of solid mechanics, rooted in the eigenvalue analysis of symmetric second-order tensors. This first practice provides a direct, hands-on calculation to find the principal stresses for a given three-dimensional stress state by solving the characteristic cubic equation from first principles [@problem_id:2674943]. Mastering this fundamental procedure is essential, and the exercise further strengthens problem-solving discipline by using the trace and determinant as invariants to verify the correctness of the solution.", "problem": "A homogeneous, isotropic solid at a point has a Cauchy stress tensor with components (in megapascal, MPa) given in the fixed Cartesian basis by\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120 & 60 & 0\\\\\n60 & 120 & 60\\\\\n0 & 60 & 120\n\\end{pmatrix}.\n$$\nUsing only first principles of eigenvalue analysis for symmetric second-order tensors, determine the principal stresses by solving the characteristic cubic equation of the tensor. Then verify your result by checking that the sum of the principal stresses equals the trace of $\\boldsymbol{\\sigma}$ and that the product of the principal stresses equals $\\det(\\boldsymbol{\\sigma})$. Report, as your final answer, the largest principal stress, expressed in MPa, rounded to four significant figures. Do not report any other quantities, and do not include units in the final boxed answer.", "solution": "The problem as stated is valid. It is a standard, well-posed problem in continuum mechanics, grounded in established principles of linear algebra and tensor analysis. All required data is provided, and the task is objective and scientifically verifiable.\n\nThe principal stresses are the eigenvalues of the Cauchy stress tensor $\\boldsymbol{\\sigma}$. By definition, the eigenvalues $\\lambda$ and their corresponding eigenvectors $\\mathbf{n}$ (the principal directions) satisfy the equation $\\boldsymbol{\\sigma}\\mathbf{n} = \\lambda\\mathbf{n}$. This can be rewritten as $(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I})\\mathbf{n} = \\mathbf{0}$, where $\\mathbf{I}$ is the second-order identity tensor. For a non-trivial solution for $\\mathbf{n}$ to exist, the determinant of the matrix $(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I})$ must be zero. This condition gives the characteristic equation:\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I}) = 0\n$$\nThe given stress tensor is:\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120 & 60 & 0\\\\\n60 & 120 & 60\\\\\n0 & 60 & 120\n\\end{pmatrix} \\text{ MPa}\n$$\nThe characteristic equation is therefore:\n$$\n\\det \\begin{pmatrix}\n120 - \\lambda & 60 & 0\\\\\n60 & 120 - \\lambda & 60\\\\\n0 & 60 & 120 - \\lambda\n\\end{pmatrix} = 0\n$$\nWe compute the determinant using cofactor expansion along the first row:\n$$\n(120 - \\lambda) \\begin{vmatrix}\n120 - \\lambda & 60\\\\\n60 & 120 - \\lambda\n\\end{vmatrix}\n- 60 \\begin{vmatrix}\n60 & 60\\\\\n0 & 120 - \\lambda\n\\end{vmatrix}\n+ 0 = 0\n$$\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 60^2 \\right] - 60 \\left[ 60(120 - \\lambda) - 0 \\right] = 0\n$$\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 3600 \\right] - 3600 (120 - \\lambda) = 0\n$$\nWe can factor out the term $(120 - \\lambda)$:\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 3600 - 3600 \\right] = 0\n$$\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 7200 \\right] = 0\n$$\nThis cubic equation yields three roots for $\\lambda$, which are the principal stresses.\nOne root is immediately evident from the first factor:\n$$\n120 - \\lambda = 0 \\implies \\lambda_1 = 120 \\text{ MPa}\n$$\nThe other two roots are found from the second factor:\n$$\n(120 - \\lambda)^2 - 7200 = 0\n$$\n$$\n(120 - \\lambda)^2 = 7200\n$$\n$$\n120 - \\lambda = \\pm\\sqrt{7200} = \\pm\\sqrt{3600 \\times 2} = \\pm 60\\sqrt{2}\n$$\nThis gives the other two principal stresses:\n$$\n\\lambda = 120 \\mp 60\\sqrt{2}\n$$\nSo, the remaining two roots are:\n$$\n\\lambda_2 = 120 + 60\\sqrt{2} \\text{ MPa}\n$$\n$$\n\\lambda_3 = 120 - 60\\sqrt{2} \\text{ MPa}\n$$\nThe calculated principal stresses are $\\sigma_1 = 120 + 60\\sqrt{2}$, $\\sigma_2 = 120$, and $\\sigma_3 = 120 - 60\\sqrt{2}$, all in units of MPa.\n\nAs required, we verify this result using the invariants of the stress tensor.\nThe first invariant is the trace of the tensor, $I_1 = \\text{tr}(\\boldsymbol{\\sigma})$, which must equal the sum of the principal stresses.\n$$\n\\text{tr}(\\boldsymbol{\\sigma}) = 120 + 120 + 120 = 360 \\text{ MPa}\n$$\n$$\n\\sum_{i=1}^{3} \\sigma_i = (120 + 60\\sqrt{2}) + 120 + (120 - 60\\sqrt{2}) = 120 + 120 + 120 = 360 \\text{ MPa}\n$$\nThe verification holds: $I_1 = \\sum \\sigma_i$.\n\nThe third invariant is the determinant of the tensor, $I_3 = \\det(\\boldsymbol{\\sigma})$, which must equal the product of the principal stresses.\n$$\n\\det(\\boldsymbol{\\sigma}) = 120(120^2 - 60^2) - 60(60 \\times 120) = 120(14400 - 3600) - 60(7200)\n$$\n$$\n\\det(\\boldsymbol{\\sigma}) = 120(10800) - 432000 = 1296000 - 432000 = 864000 \\text{ MPa}^3\n$$\n$$\n\\prod_{i=1}^{3} \\sigma_i = (120 + 60\\sqrt{2}) \\times 120 \\times (120 - 60\\sqrt{2})\n= 120 \\left[ 120^2 - (60\\sqrt{2})^2 \\right]\n$$\n$$\n\\prod_{i=1}^{3} \\sigma_i = 120 [14400 - 3600 \\times 2] = 120(14400 - 7200) = 120(7200) = 864000 \\text{ MPa}^3\n$$\nThe verification holds: $I_3 = \\prod \\sigma_i$. The calculated principal stresses are correct.\n\nThe problem asks for the largest principal stress, which we denote as $\\sigma_{\\max}$.\n$$\n\\sigma_{\\max} = \\lambda_2 = 120 + 60\\sqrt{2}\n$$\nTo provide a numerical value, we use the approximation $\\sqrt{2} \\approx 1.41421356...$.\n$$\n\\sigma_{\\max} \\approx 120 + 60(1.41421356) = 120 + 84.8528136 = 204.8528136 \\text{ MPa}\n$$\nRounding this value to four significant figures gives $204.9$.", "answer": "$$\\boxed{204.9}$$", "id": "2674943"}, {"introduction": "While three-dimensional analysis is comprehensive, many engineering problems involving thin plates are simplified using the plane stress assumption. This practice delves into the theoretical underpinnings of this common idealization, guiding you to derive the expressions for in-plane principal stresses and their orientation analytically [@problem_id:2674861]. By treating the problem in both two and three dimensions, you will gain a clear understanding of how the simplified 2D model relates to the full 3D stress state, particularly regarding the out-of-plane principal stress and direction.", "problem": "Consider a homogeneous, linearly elastic solid in a thin-plate configuration so that the stress state at a material point is of plane-stress type in a Cartesian basis $\\{\\boldsymbol{e}_x,\\boldsymbol{e}_y,\\boldsymbol{e}_z\\}$. The Cauchy stress tensor at the point is represented by the $3 \\times 3$ matrix\n$$\n\\boldsymbol{\\sigma} \\equiv\n\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_y & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix},\n$$\nwhere $\\sigma_x$, $\\sigma_y$, and $\\tau_{xy}$ are real constants, and the out-of-plane normal and shear components satisfy $\\sigma_z=0$, $\\tau_{xz}=0$, and $\\tau_{yz}=0$.\n\nStarting from the definition that principal stresses are the eigenvalues of the Cauchy stress tensor and principal stress directions are the associated eigenvectors, do the following:\n\n- Derive the in-plane principal stresses and the in-plane principal stress directions by solving the appropriate eigenvalue problem. In your derivation, give a clear statement of the mathematical condition that characterizes principal directions and use it to obtain a relation for the principal orientation angle. Take all angles in radians and measure the in-plane principal orientation angle $\\theta$ from the $x$-axis.\n- Treating the same state as a fully three-dimensional problem, determine the three principal stresses and identify the out-of-plane principal direction. Explain how these three-dimensional results compare to the in-plane results obtained above.\n\nFinally, report as your final answer a single closed-form analytic expression for the maximum principal stress $\\sigma_{\\max}$ in terms of $\\sigma_x$, $\\sigma_y$, and $\\tau_{xy}$. No numerical values are required, and no units should be included in the final expression. If multiple algebraic forms are possible, provide any one that is algebraically equivalent and exact.", "solution": "The problem posed is a standard, well-defined exercise in the field of continuum mechanics. It is scientifically grounded, self-contained, and possesses a unique, meaningful solution. Thus, it is a valid problem. We proceed with the derivation.\n\nThe state of stress is given by the Cauchy stress tensor $\\boldsymbol{\\sigma}$ for a plane-stress condition:\n$$\n\\boldsymbol{\\sigma} =\n\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_y & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nPrincipal stresses, which we shall denote by $\\sigma_p$, are the eigenvalues of this tensor. The corresponding principal directions are the eigenvectors. The eigenvalue problem is stated as $\\boldsymbol{\\sigma} \\boldsymbol{n} = \\sigma_p \\boldsymbol{n}$, where $\\boldsymbol{n}$ is a principal direction. This can be rewritten as $(\\boldsymbol{\\sigma} - \\sigma_p \\boldsymbol{I}) \\boldsymbol{n} = \\boldsymbol{0}$, where $\\boldsymbol{I}$ is the identity tensor. For a non-trivial solution for $\\boldsymbol{n}$ to exist, the determinant of the coefficient matrix must be zero: $\\det(\\boldsymbol{\\sigma} - \\sigma_p \\boldsymbol{I}) = 0$.\n\nFirst, we address the in-plane principal stresses and directions. This requires finding the eigenvalues and eigenvectors of the in-plane $2 \\times 2$ submatrix:\n$$\n\\boldsymbol{\\sigma}_{2D} =\n\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} \\\\\n\\tau_{xy} & \\sigma_y\n\\end{pmatrix}\n$$\nThe characteristic equation is $\\det(\\boldsymbol{\\sigma}_{2D} - \\sigma_p \\boldsymbol{I}_{2D}) = 0$:\n$$\n\\begin{vmatrix}\n\\sigma_x - \\sigma_p & \\tau_{xy} \\\\\n\\tau_{xy} & \\sigma_y - \\sigma_p\n\\end{vmatrix} = 0\n$$\nExpanding the determinant gives the quadratic equation for the principal stresses:\n$$\n(\\sigma_x - \\sigma_p)(\\sigma_y - \\sigma_p) - \\tau_{xy}^{2} = 0\n$$\n$$\n\\sigma_p^{2} - (\\sigma_x + \\sigma_y)\\sigma_p + (\\sigma_x\\sigma_y - \\tau_{xy}^{2}) = 0\n$$\nSolving this quadratic equation yields the two in-plane principal stresses, which we will denote $\\sigma_1$ and $\\sigma_2$:\n$$\n\\sigma_{p} = \\frac{(\\sigma_x + \\sigma_y) \\pm \\sqrt{(\\sigma_x + \\sigma_y)^{2} - 4(\\sigma_x\\sigma_y - \\tau_{xy}^{2})}}{2}\n$$\nThe term under the square root simplifies to:\n$$\n\\sqrt{\\sigma_x^{2} + 2\\sigma_x\\sigma_y + \\sigma_y^{2} - 4\\sigma_x\\sigma_y + 4\\tau_{xy}^{2}} = \\sqrt{\\sigma_x^{2} - 2\\sigma_x\\sigma_y + \\sigma_y^{2} + 4\\tau_{xy}^{2}} = \\sqrt{(\\sigma_x - \\sigma_y)^{2} + (2\\tau_{xy})^{2}}\n$$\nWe can rewrite the solution in its standard, more convenient form:\n$$\n\\sigma_{1,2} = \\frac{\\sigma_x + \\sigma_y}{2} \\pm \\sqrt{\\left(\\frac{\\sigma_x - \\sigma_y}{2}\\right)^{2} + \\tau_{xy}^{2}}\n$$\nThese are the two in-plane principal stresses.\n\nNext, we derive the orientation of the in-plane principal directions. A principal direction $\\boldsymbol{n}$ is characterized by the property that the stress vector $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$ is parallel to $\\boldsymbol{n}$. Let an in-plane principal direction be defined by the angle $\\theta_p$ with the $x$-axis, so its components are $n_x = \\cos(\\theta_p)$ and $n_y = \\sin(\\theta_p)$. The eigenvalue equation $(\\boldsymbol{\\sigma}_{2D} - \\sigma_p \\boldsymbol{I}_{2D}) \\boldsymbol{n} = \\boldsymbol{0}$ provides the system of equations:\n$$\n(\\sigma_x - \\sigma_p)\\cos(\\theta_p) + \\tau_{xy}\\sin(\\theta_p) = 0\n$$\n$$\n\\tau_{xy}\\cos(\\theta_p) + (\\sigma_y - \\sigma_p)\\sin(\\theta_p) = 0\n$$\nTo derive the orientation of the principal directions, we can combine these two component equations to eliminate $\\sigma_p$. This leads to the relationship:\n$$\n(\\sigma_x - \\sigma_y) \\sin(\\theta_p)\\cos(\\theta_p) = \\tau_{xy}(\\cos^{2}(\\theta_p) - \\sin^{2}(\\theta_p))\n$$\nUsing the double-angle identities $\\cos(2\\theta) = \\cos^{2}(\\theta) - \\sin^{2}(\\theta)$ and $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$:\n$$\n(\\sigma_x - \\sigma_y) \\frac{\\sin(2\\theta_p)}{2} = \\tau_{xy}\\cos(2\\theta_p)\n$$\nProvided $\\cos(2\\theta_p) \\neq 0$, division yields the relation for the principal orientation angle:\n$$\n\\tan(2\\theta_p) = \\frac{2\\tau_{xy}}{\\sigma_x - \\sigma_y}\n$$\nThis equation gives two angles for $2\\theta_p$ that are $180^\\circ$ apart, which corresponds to two orthogonal principal directions $\\theta_p$ that are $90^\\circ$ apart, as expected.\n\nNow, we treat the problem in three dimensions. The characteristic equation is $\\det(\\boldsymbol{\\sigma} - \\sigma_p \\boldsymbol{I}) = 0$:\n$$\n\\begin{vmatrix}\n\\sigma_x - \\sigma_p & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_y - \\sigma_p & 0 \\\\\n0 & 0 & -\\sigma_p\n\\end{vmatrix} = 0\n$$\nExpanding the determinant along the third row gives:\n$$\n(-\\sigma_p) \\left| \\begin{matrix} \\sigma_x - \\sigma_p & \\tau_{xy} \\\\ \\tau_{xy} & \\sigma_y - \\sigma_p \\end{matrix} \\right| = 0\n$$\nThis equation is satisfied if either factor is zero.\n1.  $-\\sigma_p = 0$, which gives the principal stress $\\sigma_3 = 0$.\n2.  The determinant is zero, which is precisely the characteristic equation for the in-plane stresses that we already solved. This yields the principal stresses $\\sigma_1$ and $\\sigma_2$.\n\nTherefore, for the three-dimensional plane-stress state, the three principal stresses are the two in-plane principal stresses $\\sigma_1$ and $\\sigma_2$ derived before, and a third principal stress $\\sigma_3 = 0$.\n\nThe principal direction corresponding to $\\sigma_3=0$ is found by solving $(\\boldsymbol{\\sigma} - 0\\cdot\\boldsymbol{I})\\boldsymbol{n}_3 = \\boldsymbol{0}$, or $\\boldsymbol{\\sigma}\\boldsymbol{n}_3 = \\boldsymbol{0}$. Let $\\boldsymbol{n}_3 = (n_x, n_y, n_z)^T$.\n$$\n\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_y & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix} n_x \\\\ n_y \\\\ n_z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the system $\\sigma_x n_x + \\tau_{xy} n_y = 0$ and $\\tau_{xy} n_x + \\sigma_y n_y = 0$. Unless the determinant $\\sigma_x\\sigma_y - \\tau_{xy}^2$ is zero (which means one of the in-plane principal stresses is also zero), the only solution is $n_x=0$ and $n_y=0$. The third equation $0 \\cdot n_z = 0$ is always satisfied, so $n_z$ can be any non-zero value. Normalizing the eigenvector gives $\\boldsymbol{n}_3 = (0, 0, 1)^T$, which is the direction of the $z$-axis, $\\boldsymbol{e}_z$.\n\nIn summary, the 3D analysis confirms that the in-plane principal stresses $\\sigma_1, \\sigma_2$ and their directions (which lie in the $xy$-plane) are two of the three principal values. The third principal stress is $\\sigma_3=0$, and its principal direction is normal to the plane of analysis, i.e., the $z$-direction.\n\nThe problem asks for the maximum principal stress, $\\sigma_{\\max}$. This is the algebraically largest of the three principal stresses: $\\sigma_{\\max} = \\max(\\sigma_1, \\sigma_2, \\sigma_3)$.\nBy definition, $\\sigma_1$ is the larger root from the quadratic formula (with the plus sign), so $\\sigma_1 \\ge \\sigma_2$. The three principal stresses are:\n$$\n\\sigma_1 = \\frac{\\sigma_x + \\sigma_y}{2} + \\sqrt{\\left(\\frac{\\sigma_x - \\sigma_y}{2}\\right)^{2} + \\tau_{xy}^{2}}\n$$\n$$\n\\sigma_2 = \\frac{\\sigma_x + \\sigma_y}{2} - \\sqrt{\\left(\\frac{\\sigma_x - \\sigma_y}{2}\\right)^{2} + \\tau_{xy}^{2}}\n$$\n$$\n\\sigma_3 = 0\n$$\nThe maximum principal stress is therefore $\\sigma_{\\max} = \\max(\\sigma_1, \\sigma_3) = \\max(\\sigma_1, 0)$. In many engineering contexts, particularly under tensile-dominant loading, $\\sigma_1$ is positive and is therefore the maximum. However, if the in-plane state is entirely compressive (e.g., biaxial compression), $\\sigma_1$ can be negative, in which case the maximum principal stress is $\\sigma_3=0$. The problem asks for a single expression for $\\sigma_{\\max}$. While an expression involving a max function or absolute value could be constructed to be formally correct in all cases, the term \"maximum principal stress\" in this context conventionally refers to the expression for $\\sigma_1$, the more tensile of the in-plane stresses. We will adhere to this widespread convention for the final answer.\nThus, the expression for the maximum principal stress is taken to be the expression for $\\sigma_1$.", "answer": "$$\n\\boxed{\\frac{\\sigma_x + \\sigma_y}{2} + \\sqrt{\\left(\\frac{\\sigma_x - \\sigma_y}{2}\\right)^{2} + \\tau_{xy}^{2}}}\n$$", "id": "2674861"}, {"introduction": "In the idealized world of analytical mechanics, principal directions are uniquely defined for distinct principal stresses. However, in computational practice, numerically \"close\" eigenvalues can lead to ill-conditioned eigenvectors, a critical issue that can corrupt analysis. This exercise uses a computational approach to demonstrate this numerical instability and introduces the concept of invariant subspaces as a robust remedy for tracking principal planes, even when individual principal directions are ambiguous or volatile [@problem_id:2674873]. This practice provides invaluable insight into the design of reliable numerical tools for stress analysis.", "problem": "Consider the Cauchy stress tensor, modeled as a real symmetric matrix, and recall that principal stresses are the eigenvalues and principal directions are the associated eigenvectors. Near repeated eigenvalues, principal directions can become numerically ill-conditioned: tiny changes in the tensor can induce large rotations of individual eigenvectors. You are asked to demonstrate this phenomenon with an explicit, parameterized family and then implement a robust remedy based on invariant subspaces.\n\nStart from the following fundamental base:\n- Principal stresses and directions are defined by the spectral decomposition of a symmetric tensor: for a real symmetric matrix $\\sigma \\in \\mathbb{R}^{3 \\times 3}$, there exists an orthogonal matrix $Q$ such that $\\sigma = Q \\Lambda Q^{\\top}$ with $\\Lambda$ diagonal and $Q$ orthogonal. The columns of $Q$ are principal directions and the diagonal entries of $\\Lambda$ are principal stresses.\n- An invariant subspace of $\\sigma$ is a subspace $S \\subset \\mathbb{R}^{3}$ such that $\\sigma S \\subseteq S$. If $\\Lambda$ has an eigenvalue cluster (possibly multiple or nearly multiple), the span of the corresponding eigenvectors forms an invariant subspace that is uniquely defined even if individual eigenvectors within the subspace are not.\n- Orthonormal bases for invariant subspaces are not unique, but the orthogonal projector $P$ onto the subspace is unique and can be written as $P = VV^{\\top}$ where the columns of $V$ form any orthonormal basis for the subspace.\n\nDefine the parameterized family of symmetric stress tensors\n$$\n\\sigma(\\varepsilon,\\phi) = R(\\phi)^{\\top} \\, \\mathrm{diag}(1-\\varepsilon,\\, 1+\\varepsilon,\\, 3) \\, R(\\phi),\n$$\nwhere $\\varepsilon \\in \\mathbb{R}$ is a small splitting parameter and $R(\\phi)$ is the rotation about the $z$-axis by angle $\\phi$,\n$$\nR(\\phi) = \\begin{bmatrix}\n\\cos\\phi & -\\sin\\phi & 0 \\\\\n\\sin\\phi & \\phantom{-}\\cos\\phi & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\nFor $\\varepsilon = 0$, the eigenvalue $1$ has multiplicity $2$ with the entire $xy$-plane as its invariant subspace. For small nonzero $\\varepsilon$, the eigenvalues $1-\\varepsilon$ and $1+\\varepsilon$ are distinct but very close, and the corresponding eigenvectors span (nearly) the same invariant subspace (the $xy$-plane), while individual eigenvectors within that subspace can rotate by $\\mathcal{O}(1)$ with respect to small changes in $\\phi$.\n\nYour tasks:\n1) Using only the base definitions above (spectral decomposition, invariant subspace, and orthogonal projectors), reason why the individual principal directions associated with the eigenvalues near $1$ can be arbitrarily rotated within the $xy$-plane by changing $\\phi$ at fixed small $\\varepsilon$, while the associated invariant subspace (the $xy$-plane) is unchanged. Explain why the Frobenius-norm difference $\\|\\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\\|_F$ is $\\mathcal{O}(|\\varepsilon|)$ for fixed $\\phi_1,\\phi_2$, yet the angle between the individual eigenvectors corresponding to the smaller eigenvalue can be $\\mathcal{O}(1)$, demonstrating ill-conditioning.\n\n2) Propose a robust algorithmic remedy: instead of comparing individual eigenvectors, compare invariant subspaces. Concretely, for the two-dimensional invariant subspace associated with the two eigenvalues near $1$, form orthonormal bases $V_1, V_2 \\in \\mathbb{R}^{3 \\times 2}$ and compute the principal angles between these subspaces via the Singular Value Decomposition (SVD) of $V_1^{\\top} V_2$. Define the largest principal angle as the subspace discrepancy measure. Explain why this measure is robust to near-degeneracy.\n\n3) Implement a program that, for each test case, performs the following:\n- Construct $\\sigma(\\varepsilon,\\phi_1)$ with $\\phi_1 = 0$ and $\\sigma(\\varepsilon,\\phi_2)$ for a given $\\phi_2$.\n- Compute the principal direction associated with the smaller of the two eigenvalues near $1$ for each tensor, resolve the sign ambiguity by using the absolute value of the dot product, and report the angle between these two vectors in degrees.\n- Compute an orthonormal basis of the two-dimensional invariant subspace associated with the two eigenvalues near $1$ for each tensor and then compute the maximal principal angle (in degrees) between the two subspaces via the SVD of $V_1^{\\top} V_2$.\n- Compute the Frobenius norm $\\|\\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\\|_F$.\n- Report all angles in degrees, and round all reported floating-point numbers to $6$ decimal places.\n\nAngle unit: degrees. Physical units do not apply. Percentages are not used.\n\nTest suite:\n- Case A (happy path): $\\varepsilon = 10^{-1}$, $\\phi_2 = \\pi/4$.\n- Case B (edge: nearly repeated eigenvalues): $\\varepsilon = 10^{-6}$, $\\phi_2 = \\pi/4$.\n- Case C (boundary: identical rotations): $\\varepsilon = 10^{-6}$, $\\phi_2 = 0$.\n- Case D (edge: extremely small splitting and large rotation): $\\varepsilon = 10^{-8}$, $\\phi_2 = \\pi/2$.\n\nFor each case, you must output a list with three floats [naive_angle_deg, subspace_angle_deg, frobenius_norm_difference], each rounded to $6$ decimals. Your program should produce a single line of output containing the results as a comma-separated list of these per-case lists enclosed in square brackets, for example:\n[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]\nwhere each $a_i$, $b_i$, $c_i$ is a float formatted as specified above.\n\nNo user input is permitted; the program must run as-is and produce the described single-line output.", "solution": "We proceed from first principles. For a real symmetric tensor $\\sigma \\in \\mathbb{R}^{3 \\times 3}$, the spectral theorem guarantees an orthogonal diagonalization $\\sigma = Q \\Lambda Q^{\\top}$, where $Q$ is orthogonal and the columns of $Q$ are principal directions, while $\\Lambda$ is diagonal with principal stresses. An invariant subspace $S$ for $\\sigma$ is any subspace of $\\mathbb{R}^{3}$ that is mapped into itself by $\\sigma$. If $\\Lambda$ contains an eigenvalue cluster (possibly repeated), then the span of the corresponding eigenvectors is an invariant subspace that is uniquely determined even if the individual eigenvectors are not.\n\nIll-conditioning of principal directions near repeated eigenvalues: Consider\n$$\n\\sigma(\\varepsilon,\\phi) = R(\\phi)^{\\top} \\, \\mathrm{diag}(1-\\varepsilon,\\, 1+\\varepsilon,\\, 3)\\, R(\\phi),\n$$\nwith $R(\\phi)$ the $z$-axis rotation. For $\\varepsilon = 0$, the eigenvalue $1$ has multiplicity $2$, with the entire $xy$-plane as the invariant subspace. In this case, any orthonormal pair in the $xy$-plane may be chosen as principal directions for the eigenvalue $1$. For small nonzero $\\varepsilon$, the eigenvalues split into $1-\\varepsilon$ and $1+\\varepsilon$, and the associated eigenvectors lie in the $xy$-plane and are rotated by $\\phi$ relative to the canonical axes. Crucially, if we compare two tensors $\\sigma(\\varepsilon,\\phi_1)$ and $\\sigma(\\varepsilon,\\phi_2)$ with fixed small $\\varepsilon$ and different angles $\\phi_1 \\neq \\phi_2$, the difference\n$$\n\\Delta \\sigma = \\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\n$$\nis $\\mathcal{O}(|\\varepsilon|)$ in Frobenius norm. To see this, write\n$$\n\\sigma(\\varepsilon,\\phi) = \\mathrm{diag}(1,1,3) + \\varepsilon \\, R(\\phi)^{\\top} \\, \\mathrm{diag}(-1,1,0)\\, R(\\phi),\n$$\nso for fixed $\\phi_1,\\phi_2$,\n$$\n\\Delta \\sigma = \\varepsilon \\left(R(\\phi_2)^{\\top} \\, \\mathrm{diag}(-1,1,0)\\, R(\\phi_2) - R(\\phi_1)^{\\top} \\, \\mathrm{diag}(-1,1,0)\\, R(\\phi_1)\\right),\n$$\nand hence $\\|\\Delta \\sigma\\|_F \\le C(\\phi_1,\\phi_2)\\, |\\varepsilon|$ for some constant $C$ depending only on $\\phi_1,\\phi_2$. Meanwhile, the individual eigenvectors associated with the smaller eigenvalue $1-\\varepsilon$ in the $xy$-plane are rotated from each other by an angle of $|\\phi_2 - \\phi_1|$, which is $\\mathcal{O}(1)$ and independent of $\\varepsilon$. Therefore the mapping from $\\sigma$ to an individual eigenvector is ill-conditioned near repeated eigenvalues: small changes in $\\sigma$ (of size $\\mathcal{O}(|\\varepsilon|)$) can produce large changes in the eigenvector (of size $\\mathcal{O}(1)$).\n\nRobust remedy via invariant subspaces: The two-dimensional invariant subspace associated with the pair of eigenvalues near $1$ is the $xy$-plane for all $\\phi$, because rotation about the $z$-axis preserves that plane. Even when the eigenvalue $1$ splits into $1-\\varepsilon$ and $1+\\varepsilon$, the span of the two corresponding eigenvectors is the $xy$-plane; individual basis vectors inside the plane are not unique, but the subspace is. The orthogonal projector $P$ onto this subspace can be represented as $P = V V^{\\top}$ for any orthonormal basis $V \\in \\mathbb{R}^{3 \\times 2}$ of the subspace. Unlike individual eigenvectors, $P$ is unique and varies smoothly under small perturbations as long as the cluster remains spectrally separated from the rest (here separated from the eigenvalue $3$ by a fixed gap). To compare two subspaces spanned by columns of $V_1$ and $V_2$, one computes the principal angles $\\{\\theta_i\\}$ via the Singular Value Decomposition (SVD) of $V_1^{\\top} V_2 = U \\Sigma W^{\\top}$, where the singular values are $\\{\\cos\\theta_i\\}$. The largest principal angle quantifies the maximal subspace discrepancy. In our example, this maximal angle is $0$ for all $\\varepsilon$ and $\\phi$, reflecting the stability of the invariant subspace.\n\nAlgorithmic design:\n- Construct $\\sigma(\\varepsilon,\\phi_1)$ and $\\sigma(\\varepsilon,\\phi_2)$ for given $\\varepsilon$ and angles, taking $\\phi_1 = 0$.\n- Compute their spectral decompositions using an eigensolver for symmetric matrices. Sort eigenvalues in ascending order to identify the two eigenvalues near $1$ and the largest near $3$.\n- Naive principal-direction comparison: For each tensor, select the eigenvector corresponding to the smaller of the two eigenvalues near $1$; call them $v_1$ and $v_2$. Compute the angle between $v_1$ and $v_2$ with sign ambiguity resolved by using $|\\langle v_1, v_2 \\rangle|$, that is,\n$$\n\\alpha = \\arccos\\left(\\min\\{1, \\max\\{ -1, |\\langle v_1, v_2 \\rangle| \\}\\}\\right),\n$$\nand report $\\alpha$ in degrees.\n- Invariant-subspace comparison: For each tensor, collect the two eigenvectors associated with the two smallest eigenvalues as columns of $V_1, V_2 \\in \\mathbb{R}^{3 \\times 2}$. Compute the SVD of $V_1^{\\top} V_2$, whose singular values are $\\{\\cos\\theta_1, \\cos\\theta_2\\}$ with $0 \\le \\theta_2 \\le \\theta_1 \\le \\pi/2$. Report the maximal principal angle $\\theta_1$ in degrees.\n- Compute the Frobenius norm difference $\\|\\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\\|_F$.\n- Round all reported values to $6$ decimals and report in the required list format.\n\nExpected qualitative outcomes for the given test suite:\n- Case A and Case B: The naive angle is approximately $45$ degrees, nearly independent of $\\varepsilon$, while the Frobenius norm difference scales with $|\\varepsilon|$. The maximal subspace angle is approximately $0$ degrees.\n- Case C: With identical rotations, both the naive angle and the subspace angle are $0$ degrees, and the Frobenius norm difference is $0$.\n- Case D: The naive angle is approximately $90$ degrees, the subspace angle remains $0$ degrees, and the Frobenius norm difference is proportional to $|\\varepsilon|$.\n\nThe implementation below realizes this algorithm and prints a single line containing a list of per-case results in the specified format.", "answer": "[[45.000000, 0.000000, 0.200000],[45.000000, 0.000000, 0.000002],[0.000000, 0.000000, 0.000000],[90.000000, 0.000000, 0.000000]]", "id": "2674873"}]}