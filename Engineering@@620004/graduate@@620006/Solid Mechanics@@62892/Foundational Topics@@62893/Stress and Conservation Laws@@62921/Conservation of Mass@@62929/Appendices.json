{"hands_on_practices": [{"introduction": "The principle of mass conservation leads to the powerful idealization of incompressibility, which is central to the mechanics of many materials like elastomers and fluids. Enforcing this kinematic constraint, typically expressed as $\\nabla \\cdot \\mathbf{u} = 0$ in the small strain limit, fundamentally alters the governing equations. This exercise guides you through a variational approach to understand how the incompressibility constraint gives rise to the pressure field, which acts as a Lagrange multiplier, and to reason about its mathematical uniqueness [@problem_id:2623910].", "problem": "Consider a quasi-static, small-strain, hyperelastic solid occupying a bounded domain $\\Omega \\subset \\mathbb{R}^3$ with boundary $\\partial \\Omega$. Let $\\mathbf{u}(\\mathbf{x})$ be the displacement field and $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$ the infinitesimal strain. The solid is isothermal and has constant mass density, and body forces $\\mathbf{b}(\\mathbf{x})$ act in the volume. Assume that the strain energy density $W(\\boldsymbol{\\varepsilon})$ is smooth and frame-indifferent. The conservation of mass in the incompressible limit implies a local kinematic restriction that the material cannot change volume locally during deformation. \n\nOne approach to enforce the local restriction within an energy or virtual-power principle is to introduce a spatially varying multiplier field $p(\\mathbf{x})$ to impose the pointwise constraint. From first principles starting with the local form of mass conservation and the definition of strain and virtual work, reason about how the multiplier enters the equilibrium equations and the stress response, and whether this multiplier is unique. Then select the statement that most accurately captures both the mathematical role of the multiplier and its uniqueness properties.\n\nA. In the constrained formulation, stationarity with respect to $\\mathbf{u}$ yields a Cauchy stress of the form $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\,\\mathbf{I}$; the multiplier $p$ acts as an isotropic pressure field enforcing the incompressibility constraint, and it is determined only up to an additive constant unless a pressure value or an equivalent normal traction condition is prescribed on some part of $\\partial \\Omega$.\n\nB. The constraint introduces a vector-valued multiplier $\\mathbf{p}$ that adds a solenoidal component to the stress, so the stress becomes $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} + \\nabla \\times \\mathbf{p}$; because any constant shift of $\\mathbf{p}$ would change $\\nabla \\cdot \\boldsymbol{\\sigma}$, the multiplier is unique pointwise.\n\nC. The multiplier $p$ is a scalar that modifies only the deviatoric part of the stress, leaving the spherical part unchanged; conservation of mass alone fixes $p$ uniquely throughout $\\Omega$ without reference to boundary data.\n\nD. The scalar multiplier appears only through a body-force-like term $\\nabla p$ in the equilibrium equation; therefore, shifting $p$ by a constant alters the equilibrium and fixes the additive constant through the given body force $\\mathbf{b}$, independent of boundary conditions.", "solution": "The problem statement poses a question regarding the role and uniqueness of a Lagrange multiplier field, $p(\\mathbf{x})$, used to enforce the incompressibility constraint in a quasi-static, small-strain, hyperelastic solid.\n\nFirst, validation of the problem statement is required.\n\n**Step 1: Extract Givens**\n-   Domain: A quasi-static, small-strain, hyperelastic solid in a bounded domain $\\Omega \\subset \\mathbb{R}^3$.\n-   Kinematics: Displacement field is $\\mathbf{u}(\\mathbf{x})$; infinitesimal strain is $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$.\n-   Material Properties: Isothermal, constant mass density, smooth and frame-indifferent strain energy density $W(\\boldsymbol{\\varepsilon})$.\n-   Loading: Body forces $\\mathbf{b}(\\mathbf{x})$ in the volume.\n-   Constraint: Conservation of mass for a constant density material implies local volume preservation, which in the small-strain limit is the kinematic constraint $\\nabla \\cdot \\mathbf{u} = 0$.\n-   Method: A spatially varying multiplier field $p(\\mathbf{x})$ is introduced to enforce this pointwise constraint within an energy or virtual-power principle.\n-   Question: Characterize the mathematical role of the multiplier in the equilibrium equations and stress response, and determine its uniqueness properties.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. It describes a standard and fundamental problem in continuum mechanics: the formulation of incompressible hyperelasticity. The use of a Lagrange multiplier to enforce the incompressibility constraint is a canonical technique. All concepts—hyperelasticity, small strain, conservation of mass, and virtual work—are correctly stated and applied. The problem is well-posed as a conceptual question, providing sufficient information to deduce the general structure of the governing equations. It is objective, complete for the task, physically realistic within the idealizations of continuum mechanics, and not trivial. The problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed to derive the solution.\n\n**Derivation from First Principles**\n\nThe equilibrium state of the hyperelastic body is found by seeking a stationary point of the total potential energy. For an unconstrained body, the potential energy functional is:\n$$ \\Pi[\\mathbf{u}] = \\int_{\\Omega} W(\\boldsymbol{\\varepsilon}(\\mathbf{u})) \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\mathbf{u} \\,dV - \\int_{\\partial\\Omega_t} \\mathbf{t}_{\\text{pre}} \\cdot \\mathbf{u} \\,dA $$\nwhere $\\mathbf{t}_{\\text{pre}}$ are prescribed tractions on the boundary portion $\\partial\\Omega_t$.\n\nThe solid is incompressible, which, for small strains, imposes the kinematic constraint:\n$$ \\nabla \\cdot \\mathbf{u} = \\text{tr}(\\boldsymbol{\\varepsilon}) = 0 $$\nThis constraint must hold at every point $\\mathbf{x} \\in \\Omega$. To enforce this pointwise constraint within a variational framework, we introduce a Lagrange multiplier field, which we denote as $p(\\mathbf{x})$. We construct an augmented functional, the Lagrangian $\\mathcal{L}$, by adding the constraint multiplied by $p$ to the potential energy functional. A standard convention is:\n$$ \\mathcal{L}[\\mathbf{u}, p] = \\Pi[\\mathbf{u}] - \\int_{\\Omega} p(\\mathbf{x}) (\\nabla \\cdot \\mathbf{u}) \\,dV $$\nThe solution $(\\mathbf{u}, p)$ is a stationary point of $\\mathcal{L}$ with respect to independent variations of $\\mathbf{u}$ and $p$.\n\nFirst, let us take the variation with respect to the displacement field $\\mathbf{u}$. We consider a virtual displacement $\\delta\\mathbf{u}$ that vanishes on any part of the boundary with prescribed displacements. The first variation of $\\mathcal{L}$ with respect to $\\mathbf{u}$ must be zero:\n$$ \\delta_{\\mathbf{u}}\\mathcal{L} = \\delta_{\\mathbf{u}}\\Pi - \\int_{\\Omega} p (\\nabla \\cdot \\delta\\mathbf{u}) \\,dV = 0 $$\nThe variation of the potential energy is:\n$$ \\delta_{\\mathbf{u}}\\Pi = \\int_{\\Omega} \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} : \\delta\\boldsymbol{\\varepsilon} \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\delta\\mathbf{u} \\,dV $$\nRecalling that $\\delta\\boldsymbol{\\varepsilon} = \\text{symm}(\\nabla(\\delta\\mathbf{u}))$ and $\\nabla \\cdot \\delta\\mathbf{u} = \\text{tr}(\\delta\\boldsymbol{\\varepsilon}) = \\mathbf{I} : \\delta\\boldsymbol{\\varepsilon}$, the stationarity condition becomes:\n$$ \\int_{\\Omega} \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} : \\delta\\boldsymbol{\\varepsilon} - p (\\mathbf{I} : \\delta\\boldsymbol{\\varepsilon}) \\right) \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\delta\\mathbf{u} \\,dV = 0 $$\n$$ \\int_{\\Omega} \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\mathbf{I} \\right) : \\delta\\boldsymbol{\\varepsilon} \\,dV - \\int_{\\Omega} \\mathbf{b} \\cdot \\delta\\mathbf{u} \\,dV = 0 $$\nThe principle of virtual work states that the internal virtual work equals the external virtual work. The term multiplying $\\delta\\boldsymbol{\\varepsilon}$ is identified as the Cauchy stress tensor $\\boldsymbol{\\sigma}$. Thus, we have the constitutive relation for the total stress:\n$$ \\boldsymbol{\\sigma} = \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\mathbf{I} $$\nThe Lagrange multiplier $p$ contributes a hydrostatic stress component $-p\\mathbf{I}$ to the total stress. This component is a reaction stress that enforces the incompressibility constraint. The physical interpretation of $p$ is that of a pressure.\n\nTo derive the local equilibrium equation, we apply the divergence theorem to the stress term in the virtual work equation:\n$$ \\int_{\\Omega} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\,dV = \\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla(\\delta\\mathbf{u}) \\,dV = -\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\delta\\mathbf{u} \\,dV + \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\delta\\mathbf{u} \\,dA $$\nSubstituting this into the stationarity condition and considering virtual displacements $\\delta\\mathbf{u}$ that are arbitrary within $\\Omega$ (i.e., vanishing on $\\partial\\Omega$), we obtain the strong form of the equilibrium equation:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = 0 $$\nSubstituting the expression for $\\boldsymbol{\\sigma}$:\n$$ \\nabla \\cdot \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\mathbf{I} \\right) + \\mathbf{b} = 0 \\implies \\nabla \\cdot \\left( \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} \\right) - \\nabla p + \\mathbf{b} = 0 $$\nThis equation, along with the constraint $\\nabla \\cdot \\mathbf{u} = 0$, forms the system of governing partial differential equations for the fields $\\mathbf{u}(\\mathbf{x})$ and $p(\\mathbf{x})$.\n\nNow, we examine the uniqueness of the multiplier field $p$. Observe that the equilibrium equation involves only the gradient of $p$, i.e., $\\nabla p$. If $p(\\mathbf{x})$ is a solution, then so is $p(\\mathbf{x}) + c$ for any arbitrary constant $c$, because $\\nabla(p+c) = \\nabla p$. The governing equations in the domain $\\Omega$ are invariant to such a constant shift. Therefore, the pressure field $p$ is determined by the system only up to an additive constant. To obtain a unique solution for $p$, this constant must be fixed. This is typically done by specifying a boundary condition involving $p$. For instance, one can prescribe the value of $p$ at a single point in the domain or on the boundary. Alternatively, the boundary condition on tractions, $\\boldsymbol{\\sigma}\\mathbf{n} = \\mathbf{t}_{\\text{pre}}$, can fix the constant. The normal component of this traction is $\\mathbf{n} \\cdot (\\boldsymbol{\\sigma}\\mathbf{n}) = \\mathbf{n} \\cdot ((\\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}})\\mathbf{n} - p\\mathbf{n}) = \\mathbf{n} \\cdot ((\\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}})\\mathbf{n}) - p$. Prescribing the normal traction on some part of the boundary provides a boundary condition for $p$, which serves to determine the arbitrary constant.\n\n**Option-by-Option Analysis**\n\nA. **In the constrained formulation, stationarity with respect to $\\mathbf{u}$ yields a Cauchy stress of the form $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} - p\\,\\mathbf{I}$; the multiplier $p$ acts as an isotropic pressure field enforcing the incompressibility constraint, and it is determined only up to an additive constant unless a pressure value or an equivalent normal traction condition is prescribed on some part of $\\partial \\Omega$.**\nThis statement is entirely consistent with our derivation. The form of the stress tensor is correct under a standard sign convention for the Lagrange multiplier. The role of $p$ as an isotropic pressure field is correctly identified. The statement on non-uniqueness and the conditions required to fix the additive constant are also correct.\nVerdict: **Correct**.\n\nB. **The constraint introduces a vector-valued multiplier $\\mathbf{p}$ that adds a solenoidal component to the stress, so the stress becomes $\\boldsymbol{\\sigma} = \\dfrac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}} + \\nabla \\times \\mathbf{p}$; because any constant shift of $\\mathbf{p}$ would change $\\nabla \\cdot \\boldsymbol{\\sigma}$, the multiplier is unique pointwise.**\nThe incompressibility constraint $\\nabla \\cdot \\mathbf{u} = 0$ is a scalar equation. The corresponding Lagrange multiplier must be a scalar field $p(\\mathbf{x})$, not a vector field $\\mathbf{p}(\\mathbf{x})$. The proposed form of the stress and the reasoning for uniqueness are both fundamentally incorrect.\nVerdict: **Incorrect**.\n\nC. **The multiplier $p$ is a scalar that modifies only the deviatoric part of the stress, leaving the spherical part unchanged; conservation of mass alone fixes $p$ uniquely throughout $\\Omega$ without reference to boundary data.**\nThe multiplier enters the stress as the term $-p\\mathbf{I}$. This is a purely spherical (hydrostatic) tensor; its deviatoric part is zero. Therefore, it modifies only the spherical part of the stress, contrary to the claim. Furthermore, the uniqueness claim is false; conservation of mass provides the kinematic constraint, but the pressure field is determined from the full system of equilibrium equations and is only unique up to a constant, which requires boundary data to be fixed.\nVerdict: **Incorrect**.\n\nD. **The scalar multiplier appears only through a body-force-like term $\\nabla p$ in the equilibrium equation; therefore, shifting $p$ by a constant alters the equilibrium and fixes the additive constant through the given body force $\\mathbf{b}$, independent of boundary conditions.**\nThe first part is correct: the multiplier appears as a $-\\nabla p$ term in the local equilibrium equation, which is formally similar to a body force derived from a potential. However, the conclusion drawn from this is false. Shifting $p$ by a constant $c$ does not alter the equilibrium equation, since $\\nabla(p+c) = \\nabla p$. Consequently, the body force $\\mathbf{b}$ does not and cannot fix the additive constant. Uniqueness requires a boundary condition.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2623910"}, {"introduction": "While incompressibility offers a useful model, many phenomena in solids involve changes in density, particularly in dynamics. The interplay between the conservation of mass and the conservation of linear momentum governs how mechanical disturbances propagate through a compressible medium. This practice challenges you to derive the fundamental equation of elastodynamics by systematically linearizing and combining these two balance laws, revealing the origin of elastic waves and their characteristic speeds in terms of material properties [@problem_id:2623893].", "problem": "A homogeneous, isotropic solid in the small-strain regime occupies an unbounded domain. Let $\\rho$, $\\mathbf{v}$, and $\\boldsymbol{\\sigma}$ denote the current mass density, velocity, and Cauchy stress, respectively. Assume the following fundamental laws and definitions hold:\n- Mass conservation: $\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$.\n- Linear momentum balance (neglecting body forces): $\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$.\n- Small-strain kinematics with displacement $\\mathbf{u}$: $\\mathbf{v} = \\dot{\\mathbf{u}}$ and $\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$.\n- Isotropic linear elastic constitutive behavior: $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$, with Lamé moduli $\\lambda$ and $\\mu$.\n\nLinearize the mass conservation about a constant reference density $\\rho_{0}$ and combine it with linear momentum balance to obtain a closed system for $\\mathbf{u}$ and $\\rho$. Classify the resulting system for a compressible solid and for the incompressible limit, and state the parameter conditions under which the initial value problem is well posed in each case.\n\nFinally, consider plane-wave solutions and extract the longitudinal characteristic speed. Let $\\mathbf{u}(\\mathbf{x},t) = \\Re\\{\\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)\\}$ with wavevector $\\mathbf{k} \\neq \\mathbf{0}$, angular frequency $\\omega$, and polarization $\\mathbf{a} \\neq \\mathbf{0}$. Define the longitudinal characteristic speed $c_{\\mathrm{L}}$ by $c_{\\mathrm{L}} = \\omega/\\|\\mathbf{k}\\|$ associated with polarizations parallel to $\\mathbf{k}$. What is the closed-form analytic expression for $c_{\\mathrm{L}}^{2}$ in terms of $\\lambda$, $\\mu$, and $\\rho_{0}$? Provide your final answer as a single analytic expression; do not evaluate numerically.", "solution": "The problem statement is subjected to rigorous validation before any attempt at a solution.\n\nStep 1: Extracted Givens\n- Domain: A homogeneous, isotropic solid in the small-strain regime occupying an unbounded domain.\n- State variables: Current mass density $\\rho$, velocity $\\mathbf{v}$, Cauchy stress $\\boldsymbol{\\sigma}$, displacement $\\mathbf{u}$.\n- Fundamental Laws:\n    - Mass conservation: $\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$.\n    - Linear momentum balance (body forces neglected): $\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$.\n- Definitions and Constitutive Relations:\n    - Small-strain kinematics: $\\mathbf{v} = \\dot{\\mathbf{u}}$ and $\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$.\n    - Isotropic linear elastic constitutive behavior: $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$, with Lamé moduli $\\lambda$ and $\\mu$.\n- Analysis Tasks:\n    - Linearize mass conservation about a constant reference density $\\rho_{0}$.\n    - Combine with linearized momentum balance to obtain a closed system for $\\mathbf{u}$ and $\\rho$.\n    - Classify the resulting system and state well-posedness conditions for compressible and incompressible cases.\n    - Consider a plane-wave solution $\\mathbf{u}(\\mathbf{x},t) = \\Re\\{\\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)\\}$ with wavevector $\\mathbf{k} \\neq \\mathbf{0}$, angular frequency $\\omega$, and polarization $\\mathbf{a} \\neq \\mathbf{0}$.\n    - Extract the longitudinal characteristic speed $c_{\\mathrm{L}} = \\omega/\\|\\mathbf{k}\\|$ for polarizations parallel to $\\mathbf{k}$, and find an expression for $c_{\\mathrm{L}}^{2}$.\n\nStep 2: Validation\nThe problem is scientifically grounded, being based entirely on the fundamental principles of continuum mechanics and linear elasticity. It is well-posed, objective, and self-contained, providing all necessary equations and definitions to derive the requested result. The problem requires a standard, but non-trivial, derivation in elastodynamics. There are no logical contradictions, factual errors, or ambiguities.\n\nStep 3: Verdict\nThe problem is valid. A solution will be formulated.\n\nThe derivation proceeds from first principles as required.\n\nFirst, we linearize the governing equations. We consider small perturbations from a quiescent state, where $\\rho = \\rho_{0}$, $\\mathbf{v} = \\mathbf{0}$, and $\\mathbf{u} = \\mathbf{0}$. We let $\\rho = \\rho_0 + \\rho'$, where $\\rho'$ and $\\mathbf{v} = \\dot{\\mathbf{u}}$ are first-order small quantities.\n\nThe mass conservation equation is $\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$. The material derivative is $\\dfrac{\\mathrm{D}}{\\mathrm{D}t} = \\dfrac{\\partial}{\\partial t} + \\mathbf{v} \\cdot \\nabla$.\nExpanding this:\n$$\n\\frac{\\partial (\\rho_{0} + \\rho')}{\\partial t} + \\mathbf{v} \\cdot \\nabla (\\rho_{0} + \\rho') + (\\rho_{0} + \\rho') \\nabla \\cdot \\mathbf{v} = 0\n$$\nSince $\\rho_0$ is a constant, this simplifies to:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\rho' + \\rho_{0} \\nabla \\cdot \\mathbf{v} + \\rho' \\nabla \\cdot \\mathbf{v} = 0\n$$\nNeglecting second-order terms (products of small quantities like $\\mathbf{v} \\cdot \\nabla \\rho'$ and $\\rho' \\nabla \\cdot \\mathbf{v}$), the linearized mass conservation equation is:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{v} = 0\n$$\nSince $\\mathbf{v} = \\dot{\\mathbf{u}} = \\dfrac{\\partial \\mathbf{u}}{\\partial t}$, this becomes $\\dfrac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\left(\\dfrac{\\partial \\mathbf{u}}{\\partial t}\\right) = 0$.\n\nNext, we linearize the linear momentum balance: $\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$.\nThe left-hand side is $(\\rho_0 + \\rho') \\left( \\dfrac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right)$. The convective acceleration $(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$ is second-order. The term $\\rho' \\dfrac{\\partial \\mathbf{v}}{\\partial t}$ is also second-order. The only first-order term is $\\rho_0 \\dfrac{\\partial \\mathbf{v}}{\\partial t}$. With $\\mathbf{v} = \\dot{\\mathbf{u}}$, this is $\\rho_0 \\ddot{\\mathbf{u}}$.\nThe stress tensor $\\boldsymbol{\\sigma}$ is already a first-order quantity, as it is linear in the strain $\\boldsymbol{\\varepsilon}$, which is linear in gradients of the first-order displacement $\\mathbf{u}$. Thus, the linearized momentum equation is:\n$$\n\\rho_{0} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = \\nabla \\cdot \\boldsymbol{\\sigma}\n$$\nNow, substitute the constitutive relation $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$ and the strain definition $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$. Note that $\\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$.\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\nabla \\cdot \\left( \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon} \\right) = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + 2\\mu \\nabla \\cdot \\boldsymbol{\\varepsilon}\n$$\n$$\n2\\mu \\nabla \\cdot \\boldsymbol{\\varepsilon} = \\mu \\nabla \\cdot (\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})\n$$\nUsing the vector identities $\\nabla \\cdot (\\nabla \\mathbf{u}) = \\nabla^2 \\mathbf{u}$ (vector Laplacian) and $\\nabla \\cdot (\\nabla \\mathbf{u}^{\\mathsf{T}}) = \\nabla(\\nabla \\cdot \\mathbf{u})$, we obtain:\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu (\\nabla^2 \\mathbf{u} + \\nabla(\\nabla \\cdot \\mathbf{u})) = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\nThe governing equation for the displacement field $\\mathbf{u}$ is thus:\n$$\n\\rho_{0} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\nThis is the elastodynamic wave equation, also known as Navier's equation. The closed system consists of this equation for $\\mathbf{u}$ and the linearized mass conservation relating $\\rho'$ to $\\mathbf{u}$.\n\nFor a compressible solid, this is a system of second-order hyperbolic partial differential equations. An initial value problem is well-posed if the material parameters ensure physical stability, which corresponds to the strain energy density being positive-definite. This requires the Lamé parameters to satisfy $\\mu > 0$ and $\\lambda + \\frac{2}{3}\\mu > 0$ (positive bulk modulus). A stricter condition, ensuring real wave speeds for all propagation directions, is $\\mu > 0$ and $\\lambda + 2\\mu > 0$.\n\nIn the incompressible limit, we impose the constraint $\\nabla \\cdot \\mathbf{v} = 0$, which for a deformation starting from rest implies $\\nabla \\cdot \\mathbf{u} = 0$. Mass conservation $\\dot{\\rho'} + \\rho_0 \\nabla \\cdot \\mathbf{v}=0$ then implies $\\dot{\\rho'} = 0$, so the density remains constant. The term $\\lambda (\\nabla \\cdot \\mathbf{u})$ in the stress becomes indeterminate and is replaced by a scalar pressure field $-p$ that acts as a Lagrange multiplier to enforce the incompressibility constraint. The constitutive law becomes $\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}$. The momentum equation becomes:\n$$\n\\rho_{0} \\ddot{\\mathbf{u}} = \\nabla \\cdot (-p\\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}) = -\\nabla p + \\mu \\nabla^2\\mathbf{u}\n$$\nTaking the divergence of this equation and using $\\nabla \\cdot \\mathbf{u} = 0$ yields $\\nabla^2 p = 0$. The pressure field is governed by an elliptic Laplace equation, while the evolution of the solenoidal part of the velocity field is governed by a wave equation. The system is of mixed elliptic-hyperbolic type. The initial value problem is well-posed if $\\mu > 0$.\n\nTo find the longitudinal wave speed, we use the compressible elastodynamic equation and substitute the plane-wave ansatz $\\mathbf{u}(\\mathbf{x},t) = \\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)$. The required derivatives are:\n$$\n\\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = -\\omega^2 \\mathbf{u}\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{u}) = \\nabla(\\mathrm{i}\\mathbf{k} \\cdot \\mathbf{u}) = \\mathrm{i}\\mathbf{k}(\\mathrm{i}\\mathbf{k} \\cdot \\mathbf{u}) = -(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} \\exp(\\dots)\n$$\n$$\n\\nabla^2 \\mathbf{u} = \\nabla \\cdot (\\nabla \\mathbf{u}) = \\nabla \\cdot (\\mathrm{i}\\mathbf{k}\\mathbf{u}) = \\mathrm{i}\\mathbf{k} \\cdot (\\mathrm{i}\\mathbf{k}\\mathbf{u}) = -(\\mathbf{k} \\cdot \\mathbf{k})\\mathbf{u} = -\\|\\mathbf{k}\\|^2 \\mathbf{u}\n$$\nSubstituting these into Navier's equation:\n$$\n\\rho_{0}(-\\omega^2 \\mathbf{a}) \\exp(\\dots) = (\\lambda + \\mu)( -(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k}) \\exp(\\dots) + \\mu(-\\|\\mathbf{k}\\|^2 \\mathbf{a}) \\exp(\\dots)\n$$\nCanceling the exponential term and negative signs yields the Christoffel equation:\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + \\mu)(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} + \\mu\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\nFor longitudinal waves, the polarization vector $\\mathbf{a}$ is parallel to the wavevector $\\mathbf{k}$. Thus, $\\mathbf{a}$ is an eigenvector of the tensor operator. In this case, $\\mathbf{a}$ can be written as a scalar multiple of $\\mathbf{k}$. The relationship $\\mathbf{k} \\cdot \\mathbf{a} = \\|\\mathbf{k}\\| \\|\\mathbf{a}\\|$ holds. Then $(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} = (\\|\\mathbf{k}\\| \\|\\mathbf{a}\\|) \\frac{\\mathbf{k}}{\\|\\mathbf{k}\\|} \\|\\mathbf{k}\\| = \\|\\mathbf{k}\\|^2 \\|\\mathbf{a}\\| \\frac{\\mathbf{a}}{\\|\\mathbf{a}\\|} = \\|\\mathbf{k}\\|^2 \\mathbf{a}$.\nSubstituting this into the Christoffel equation:\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + \\mu)\\|\\mathbf{k}\\|^2 \\mathbf{a} + \\mu\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + 2\\mu)\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\nSince $\\mathbf{a} \\neq \\mathbf{0}$, we can divide by the vector $\\mathbf{a}$:\n$$\n\\rho_{0} \\omega^2 = (\\lambda + 2\\mu)\\|\\mathbf{k}\\|^2\n$$\nThe longitudinal characteristic speed $c_{\\mathrm{L}}$ is defined as $\\omega/\\|\\mathbf{k}\\|$. We are asked for $c_{\\mathrm{L}}^{2}$:\n$$\nc_{\\mathrm{L}}^{2} = \\frac{\\omega^2}{\\|\\mathbf{k}\\|^2} = \\frac{\\lambda + 2\\mu}{\\rho_{0}}\n$$\nThis is the final expression. This result confirms the well-posedness condition $\\lambda+2\\mu > 0$ for a compressible solid, as the wave speed squared must be positive for real wave propagation to occur.", "answer": "$$\n\\boxed{\\frac{\\lambda + 2\\mu}{\\rho_{0}}}\n$$", "id": "2623893"}, {"introduction": "Bridging the gap between analytical theory and computational practice is a crucial skill in modern solid mechanics. While we can derive conservation laws in their continuous form, we must also ensure our numerical simulations, such as those using the Finite Element Method, respect these fundamental principles. This hands-on programming exercise asks you to formalize the material statement of mass conservation, $\\rho_0 = J\\rho$, into a verifiable procedure, designing and implementing quantitative metrics to measure mass conservation errors in a large deformation setting [@problem_id:2623914].", "problem": "A compressible solid occupies a reference configuration $\\Omega_0 \\subset \\mathbb{R}^3$ with material coordinates $\\mathbf{X} \\in \\Omega_0$ and deforms to a current configuration $\\Omega_t$ with spatial coordinates $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$. The deformation gradient is defined as $\\mathbf{F}(\\mathbf{X},t) = \\partial \\mathbf{x}/\\partial \\mathbf{X}$ and the Jacobian determinant is $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$, with $J(\\mathbf{X},t)  0$. Let $\\rho_0(\\mathbf{X})$ denote the reference mass density field at time $t=0$ and let $\\rho(\\mathbf{X},t)$ denote the spatial mass density at time $t$ evaluated at the mapped point $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$. Starting only from the fundamental statement that the total mass of any material region is invariant in time, and the definitions of $\\mathbf{F}$ and $J$, you must:\n\n- Derive expressions suitable for verification that quantify:\n  - A global mass conservation error for the entire body, expressed as a dimensionless scalar based on ratios of integrals over $\\Omega_0$.\n  - A local mass conservation error field expressed in $\\Omega_0$ and a corresponding dimensionless scalar measure based on a norm over $\\Omega_0$.\n\n- Design a numerical procedure to evaluate the above error measures from given fields $\\rho_0(\\mathbf{X})$, $\\mathbf{F}(\\mathbf{X})$, and $\\rho(\\mathbf{X})$ without using any property not implied by the fundamental statement. The numerical procedure must:\n  - Work on a hexahedral partition of $\\Omega_0 = [0,1]^3$ into a structured mesh with $N_e \\times N_e \\times N_e$ congruent elements, where $N_e$ is any positive integer. For this assignment, you must take $N_e = 8$.\n  - Approximate integrals over $\\Omega_0$ by tensor-product Gaussian quadrature with $2 \\times 2 \\times 2$ quadrature points per element. The $1$-dimensional quadrature rule on $[-1,1]$ uses points $\\{-1/\\sqrt{3},+1/\\sqrt{3}\\}$ with unit weights $\\{1,1\\}$. Map these points affinely to each element of size $h \\times h \\times h$ with $h = 1/N_e$ in the reference domain.\n  - Compute $J(\\mathbf{X}) = \\det \\mathbf{F}(\\mathbf{X})$ pointwise at quadrature points.\n  - Produce the global error as a dimensionless absolute ratio and a local error as a dimensionless norm ratio, both evaluated over $\\Omega_0$.\n\n- Implement the procedure as a program that evaluates the error measures for the following four test cases, where all fields are given in closed form. In each case, $\\mathbf{X} = (X_1,X_2,X_3)$ with $X_1,X_2,X_3 \\in [0,1]$. All coordinates are in meters (m). All densities are in kilograms per cubic meter (kg/m$^3$). The outputs are dimensionless decimals (no percent sign). Define $\\pi$ as the usual circular constant.\n\nTest suite:\n- Case A (kinematically compatible density):\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1 + 0.2\\,X_1\\big)\\big(1 + 0.1\\,X_2\\big)\\big(1 - 0.05\\,X_3\\big)}$.\n- Case B (small local perturbation to spatial density):\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1 + 0.2\\,X_1\\big)\\big(1 + 0.1\\,X_2\\big)\\big(1 - 0.05\\,X_3\\big)}\\Big(1 + 10^{-3}\\,\\sin(2\\pi X_1)\\sin(2\\pi X_2)\\sin(2\\pi X_3)\\Big)$.\n- Case C (uniform dilation with global bias):\n  - $\\mathbf{F}(\\mathbf{X}) = \\alpha\\,\\mathbf{I}$ with $\\alpha = 1.5$ and $\\mathbf{I}$ the identity tensor.\n  - $\\rho_0(\\mathbf{X}) = 7800$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\alpha^3}\\,(1 + 0.05)$.\n- Case D (strongly varying volumetric stretch with localized defect):\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1,\\; 1,\\; 0.2 + 0.1\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 900 + 100\\,\\cos(2\\pi X_1)\\cos(2\\pi X_2)\\cos(2\\pi X_3)$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1\\big)\\big(1\\big)\\big(0.2 + 0.1\\,X_3\\big)} + 10\\,\\exp\\!\\Big(-\\dfrac{(X_1 - 0.5)^2 + (X_2 - 0.5)^2 + (X_3 - 0.5)^2}{0.02}\\Big)$.\n\nYour program must:\n- Use $N_e = 8$ with the specified $2 \\times 2 \\times 2$ Gaussian quadrature per element.\n- For each case, compute:\n  - The global mass error defined as the absolute value of a difference of two integrals divided by a reference integral, both over $\\Omega_0$.\n  - The local mass error norm defined as the square root of an integral of a squared residual divided by the square root of an integral of a squared reference field, both over $\\Omega_0$.\n- Aggregate the results for the four cases as $8$ floating-point numbers in the order $\\big[\\text{global}_A,\\text{local}_A,\\text{global}_B,\\text{local}_B,\\text{global}_C,\\text{local}_C,\\text{global}_D,\\text{local}_D\\big]$.\n- Final output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$). Each floating-point number must be rounded to exactly $8$ decimal places.\n\nExpress all final answers as pure decimals (no percent sign). No user input is required; the program must be self-contained and produce the single-line output upon execution.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Configurations**: Reference configuration $\\Omega_0 \\subset \\mathbb{R}^3$ with material coordinates $\\mathbf{X}$; current configuration $\\Omega_t$ with spatial coordinates $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$.\n- **Kinematics**: Deformation gradient $\\mathbf{F}(\\mathbf{X},t) = \\partial \\mathbf{x}/\\partial \\mathbf{X}$; Jacobian determinant $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)  0$.\n- **Density Fields**: Reference mass density $\\rho_0(\\mathbf{X})$; spatial mass density at the mapped point $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X},t)$ is given as $\\rho(\\mathbf{X},t)$.\n- **Fundamental Principle**: The total mass of any material region is invariant in time.\n- **Domain**: $\\Omega_0 = [0,1]^3 \\subset \\mathbb{R}^3$.\n- **Numerical Discretization**: A structured mesh of $N_e \\times N_e \\times N_e$ congruent hexahedral elements, with $N_e = 8$. Element size is $h = 1/N_e = 1/8$.\n- **Numerical Integration**: Tensor-product Gaussian quadrature with $2 \\times 2 \\times 2$ points per element. The $1$-D rule on the canonical interval $[-1,1]$ has points $\\{\\pm 1/\\sqrt{3}\\}$ and weights $\\{1,1\\}$.\n- **Task**: Derive expressions for a global mass conservation error and a local mass conservation error field and its norm. Implement a numerical procedure to evaluate these errors for four specified test cases.\n- **Test Cases**:\n    - Case A: $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$, $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$, $\\rho(\\mathbf{X}) = \\rho_0(\\mathbf{X}) / J(\\mathbf{X})$.\n    - Case B: Same $\\mathbf{F}$ and $\\rho_0$ as Case A, $\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{J(\\mathbf{X})}\\Big(1 + 10^{-3}\\,\\sin(2\\pi X_1)\\sin(2\\pi X_2)\\sin(2\\pi X_3)\\Big)$.\n    - Case C: $\\mathbf{F}(\\mathbf{X}) = 1.5\\,\\mathbf{I}$, $\\rho_0(\\mathbf{X}) = 7800$, $\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{1.5^3}\\,(1 + 0.05)$.\n    - Case D: $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1,\\; 1,\\; 0.2 + 0.1\\,X_3\\big)$, $\\rho_0(\\mathbf{X}) = 900 + 100\\,\\cos(2\\pi X_1)\\cos(2\\pi X_2)\\cos(2\\pi X_3)$, $\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{J(\\mathbf{X})} + 10\\,\\exp\\!\\Big(-\\frac{(X_1 - 0.5)^2 + (X_2 - 0.5)^2 + (X_3 - 0.5)^2}{0.02}\\Big)$.\n- **Output Requirement**: A single list of $8$ decimal numbers (global and local error for each case) rounded to $8$ decimal places.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is examined against the specified validity criteria.\n- **Scientifically Grounded**: The problem is based on the principle of conservation of mass, a cornerstone of continuum mechanics. All definitions and concepts ($\\mathbf{F}$, $J$, $\\rho_0$, $\\rho$) are standard. The derivation requested is a fundamental exercise in the field. The condition $J0$ is a standard requirement for physical admissibility of a deformation and is satisfied for all test cases within the domain $\\Omega_0 = [0,1]^3$. The problem is scientifically sound.\n- **Well-Posed**: The problem requests the derivation of error metrics and the implementation of a specific, well-defined numerical algorithm to compute them for given analytical functions. All numerical parameters (domain, mesh size, quadrature rule) are precisely specified. This structure guarantees that a unique, stable, and meaningful numerical result exists.\n- **Objective**: The problem is stated using precise, objective mathematical language. The test cases are defined by explicit, closed-form functions, leaving no room for subjective interpretation.\n- **Completeness and Consistency**: The problem provides all necessary information to proceed. There are no missing data or contradictory constraints.\n- **Other Flaws**: The problem is free from triviality, pseudo-profundity, or any other listed invalidity flaw. It constitutes a standard verification problem in computational solid mechanics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Design and Solution\n\nThe solution proceeds in two stages: theoretical derivation followed by numerical implementation design.\n\n#### Derivation of Mass Conservation Error Measures\n\nThe fundamental axiom is that the mass of an arbitrary material volume $V_0 \\subset \\Omega_0$ is conserved under deformation. Let $V_t = \\boldsymbol{\\varphi}(V_0, t)$ be the same material volume in the current configuration. The mass at time $t=0$ is given by the integral of the reference density $\\rho_0(\\mathbf{X})$ over $V_0$:\n$$ M = \\int_{V_0} \\rho_0(\\mathbf{X}) \\, dV_0 $$\nThe mass at time $t$ is given by the integral of the spatial density $\\rho(\\mathbf{x}, t)$ over $V_t$:\n$$ M = \\int_{V_t} \\rho(\\mathbf{x}, t) \\, dV_t $$\nConservation of mass requires these two expressions for $M$ to be equal. To compare them within a single integral, we perform a change of variables on the second integral, mapping it back to the reference domain $V_0$. The relationship between a differential volume element in the current configuration, $dV_t$, and the reference configuration, $dV_0$, is given by $dV_t = J(\\mathbf{X},t) \\, dV_0$, where $J = \\det(\\mathbf{F})$. Substituting this and expressing the spatial density at point $\\mathbf{x}(\\mathbf{X},t)$ as $\\rho(\\mathbf{X},t)$ (as per the problem's notation) yields:\n$$ \\int_{V_0} \\rho_0(\\mathbf{X}) \\, dV_0 = \\int_{V_0} \\rho(\\mathbf{X},t) J(\\mathbf{X},t) \\, dV_0 $$\nSince this equality must hold for any arbitrary choice of material volume $V_0 \\subseteq \\Omega_0$, the integrands must be equal. This gives the local form of mass conservation in the material description:\n$$ \\rho_0(\\mathbf{X}) = \\rho(\\mathbf{X},t) J(\\mathbf{X},t) $$\nFor the remainder of this analysis, the explicit dependence on time $t$ is omitted as we are considering a static snapshot of the deformation. The equation for conservation is thus $\\rho_0(\\mathbf{X}) = \\rho(\\mathbf{X}) J(\\mathbf{X})$.\n\nAny deviation from this equality represents a violation of mass conservation. We define a local mass residual field, $R(\\mathbf{X})$, on the reference domain $\\Omega_0$:\n$$ R(\\mathbf{X}) = \\rho_0(\\mathbf{X}) - \\rho(\\mathbf{X}) J(\\mathbf{X}) $$\nA perfect conservation of mass implies $R(\\mathbf{X}) = 0$ for all $\\mathbf{X} \\in \\Omega_0$. We can now formulate the required error metrics.\n\n1.  **Global Mass Conservation Error ($E_{global}$)**: This metric quantifies the net mass imbalance over the entire body. It is defined as the absolute value of the total mass residual, normalized by the total initial mass.\n    $$ E_{global} = \\frac{\\left| \\int_{\\Omega_0} \\big(\\rho_0(\\mathbf{X}) - \\rho(\\mathbf{X}) J(\\mathbf{X})\\big) \\, dV_0 \\right|}{\\int_{\\Omega_0} \\rho_0(\\mathbf{X}) \\, dV_0} = \\frac{\\left| \\int_{\\Omega_0} R(\\mathbf{X}) \\, dV_0 \\right|}{\\int_{\\Omega_0} \\rho_0(\\mathbf{X}) \\, dV_0} $$\n    This is a dimensionless scalar representing the fractional error in the total mass.\n\n2.  **Local Mass Conservation Error Norm ($E_{local}$)**: This metric quantifies the magnitude of the local residual field across the body. A suitable measure is the $L_2$ norm of the residual field $R(\\mathbf{X})$, normalized by the $L_2$ norm of the reference density field $\\rho_0(\\mathbf{X})$.\n    $$ E_{local} = \\frac{\\sqrt{\\int_{\\Omega_0} [R(\\mathbf{X})]^2 \\, dV_0}}{\\sqrt{\\int_{\\Omega_0} [\\rho_0(\\mathbf{X})]^2 \\, dV_0}} $$\n    This provides a dimensionless root-mean-square measure of the local mass conservation error.\n\n#### Numerical Procedure\n\nThe error measures require the evaluation of integrals over the domain $\\Omega_0 = [0,1]^3$. We employ the specified numerical quadrature scheme.\n\nThe domain is partitioned into $N_e^3 = 8^3 = 512$ hexahedral elements, each of size $h \\times h \\times h$ where $h=1/8$. The integral over $\\Omega_0$ is the sum of integrals over each element $\\Omega^{(e)}$:\n$$ \\int_{\\Omega_0} f(\\mathbf{X}) \\, dV_0 = \\sum_{e=1}^{N_e^3} \\int_{\\Omega^{(e)}} f(\\mathbf{X}) \\, dV_0 $$\nEach element integral is approximated using a $2 \\times 2 \\times 2$ tensor-product Gaussian quadrature rule. The $1$-D rule on the canonical interval $[-1,1]$ uses points $\\xi_k \\in \\{-1/\\sqrt{3}, 1/\\sqrt{3}\\}$ and weights $w_k=1$.\n\nA point $\\boldsymbol{\\xi} = (\\xi_1, \\xi_2, \\xi_3)$ in the canonical element $[-1,1]^3$ is mapped to a point $\\mathbf{X}$ in a physical element $\\Omega^{(e)}$ via an affine map: $\\mathbf{X}(\\boldsymbol{\\xi}) = \\mathbf{X}_c^{(e)} + \\frac{h}{2}\\boldsymbol{\\xi}$, where $\\mathbf{X}_c^{(e)}$ is the center of the element. The differential volume for this mapping is $dV_0 = \\det(\\partial\\mathbf{X}/\\partial\\boldsymbol{\\xi}) dV_\\xi = (h/2)^3 dV_\\xi$.\n\nThe integral over a single element is thus approximated as:\n$$ \\int_{\\Omega^{(e)}} f(\\mathbf{X}) \\, dV_0 \\approx \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 f(\\mathbf{X}_{ijk}) \\, (w_i w_j w_k) \\left(\\frac{h}{2}\\right)^3 $$\nwhere $\\mathbf{X}_{ijk}$ are the quadrature points in the physical element. Since all $w_k=1$, the weight for each of the $8$ quadrature points within an element is a constant $W_{qp} = (h/2)^3 = (1/16)^3$.\n\nThe total number of quadrature points over the entire domain $\\Omega_0$ is $N_{total\\_qp} = N_e^3 \\times 2^3 = 512 \\times 8 = 4096$. The numerical approximation for an integral over $\\Omega_0$ is a sum over all these points:\n$$ \\int_{\\Omega_0} f(\\mathbf{X}) \\, dV_0 \\approx \\sum_{p=1}^{N_{total\\_qp}} f(\\mathbf{X}_p) W_{qp} $$\nwhere $\\mathbf{X}_p$ is the coordinate of the $p$-th global quadrature point.\n\nSince the quadrature weight $W_{qp}$ is constant for all points, it can be factored out of the sums in the numerators and denominators of the error metrics $E_{global}$ and $E_{local}$, and subsequently cancelled. The calculation simplifies to summing the function values at all quadrature points:\n$$ E_{global} \\approx \\frac{\\left| \\sum_p R(\\mathbf{X}_p) \\right|}{\\sum_p \\rho_0(\\mathbf{X}_p)} $$\n$$ E_{local} \\approx \\frac{\\sqrt{\\sum_p [R(\\mathbf{X}_p)]^2}}{\\sqrt{\\sum_p [\\rho_0(\\mathbf{X}_p)]^2}} $$\nThe algorithm consists of generating the coordinates of all $4096$ quadrature points, evaluating the fields $\\rho_0$, $\\mathbf{F}$, $\\rho$ at these points, computing the Jacobian $J$ and residual $R$, and finally calculating the sums to obtain the error metrics for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the continuum mechanics problem by deriving and calculating mass conservation errors.\n    \"\"\"\n\n    # Define the four test cases with their respective field functions.\n    test_cases = [\n        # Case A: Kinematically compatible density. Expected error is zero.\n        {\n            \"name\": \"A\",\n            \"F_func\": lambda X, Y, Z: (\n                1 + 0.2 * X,\n                1 + 0.1 * Y,\n                1 - 0.05 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z),\n            \"rho_func\": lambda X, Y, Z, J: (1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z)) / J\n        },\n        # Case B: Small local perturbation to spatial density.\n        {\n            \"name\": \"B\",\n            \"F_func\": lambda X, Y, Z: (\n                1 + 0.2 * X,\n                1 + 0.1 * Y,\n                1 - 0.05 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z),\n            \"rho_func\": lambda X, Y, Z, J: (\n                (1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z)) / J *\n                (1 + 1e-3 * np.sin(2*np.pi * X) * np.sin(2*np.pi * Y) * np.sin(2*np.pi * Z))\n            )\n        },\n        # Case C: Uniform dilation with global bias. Expected error is 0.05.\n        {\n            \"name\": \"C\",\n            \"F_func\": lambda X, Y, Z: (1.5, 1.5, 1.5),\n            \"rho0_func\": lambda X, Y, Z: 7800.0,\n            \"rho_func\": lambda X, Y, Z, J: (7800.0 / J) * 1.05\n        },\n        # Case D: Strongly varying stretch with localized defect.\n        {\n            \"name\": \"D\",\n            \"F_func\": lambda X, Y, Z: (\n                1.0,\n                1.0,\n                0.2 + 0.1 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 900 + 100 * np.cos(2*np.pi*X)*np.cos(2*np.pi*Y)*np.cos(2*np.pi*Z),\n            \"rho_func\": lambda X, Y, Z, J: (\n                (900 + 100 * np.cos(2*np.pi*X)*np.cos(2*np.pi*Y)*np.cos(2*np.pi*Z)) / J +\n                10 * np.exp(-((X-0.5)**2 + (Y-0.5)**2 + (Z-0.5)**2) / 0.02)\n            )\n        }\n    ]\n\n    # Numerical parameters\n    Ne = 8  # Number of elements per dimension\n    h = 1.0 / Ne  # Element size\n\n    # Generate 1D quadrature points in the canonical element [-1, 1]\n    canon_pts_1d = np.array([-1.0, 1.0]) / np.sqrt(3.0)\n\n    # Map canonical points to physical coordinates for all elements\n    cell_centers_1d = (np.arange(Ne) + 0.5) * h\n    # Offsets from cell centers to quadrature points\n    offsets = (h / 2.0) * canon_pts_1d\n    # Generate all 1D quadrature point coordinates\n    phys_pts_1d = (cell_centers_1d[:, None] + offsets[None, :]).flatten()\n\n    # Create a 3D grid of all quadrature points in the domain [0,1]^3\n    X_qp, Y_qp, Z_qp = np.meshgrid(phys_pts_1d, phys_pts_1d, phys_pts_1d, indexing='ij')\n\n    results = []\n\n    for case in test_cases:\n        # Evaluate reference density at all quadrature points\n        rho0_vals = case[\"rho0_func\"](X_qp, Y_qp, Z_qp)\n\n        # Evaluate deformation gradient components and Jacobian\n        F_diag = case[\"F_func\"](X_qp, Y_qp, Z_qp)\n        # For diagonal F, J is the product of diagonal entries.\n        if case[\"name\"] == \"C\":\n            J_vals = 1.5**3\n        else:\n            J_vals = F_diag[0] * F_diag[1] * F_diag[2]\n        \n        # Evaluate spatial density\n        rho_vals = case[\"rho_func\"](X_qp, Y_qp, Z_qp, J_vals)\n\n        # Calculate the local mass residual field\n        R_vals = rho0_vals - rho_vals * J_vals\n\n        # The constant quadrature weight (h/2)^3 cancels in the ratios,\n        # so we can use sums directly.\n\n        # Calculate global error\n        # Sum of residuals (proportional to net mass change)\n        numerator_global = np.sum(R_vals)\n        # Sum of reference densities (proportional to total reference mass)\n        denominator_global = np.sum(rho0_vals)\n        E_global = np.abs(numerator_global) / denominator_global if denominator_global != 0 else 0.0\n\n        # Calculate local error norm\n        # Sum of squared residuals (proportional to L2 norm squared of R)\n        numerator_local_sq = np.sum(R_vals**2)\n        # Sum of squared reference densities (proportional to L2 norm squared of rho0)\n        denominator_local_sq = np.sum(rho0_vals**2)\n        \n        E_local = (np.sqrt(numerator_local_sq) / np.sqrt(denominator_local_sq) \n                   if denominator_local_sq > 0 else 0.0)\n\n        results.extend([E_global, E_local])\n\n    # Format the final output string\n    output_str = f\"[{','.join(f'{x:.8f}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2623914"}]}