{"hands_on_practices": [{"introduction": "The Principle of Minimum Potential Energy provides a powerful framework not only for deriving governing equations but also for finding approximate solutions. This practice introduces the Rayleigh-Ritz method, a classic variational technique where the displacement field is approximated by a set of admissible functions with unknown coefficients. By minimizing the total potential energy with respect to these coefficients, you will determine an approximate solution for the deflection of a cantilever beam, gaining hands-on experience in applying the core tenets of energy minimization to structural analysis [@problem_id:2675671].", "problem": "A slender, prismatic, linearly elastic Euler–Bernoulli beam of length $L$ and constant flexural rigidity $E I$ is clamped at $x=0$ and free at $x=L$. A static concentrated load of magnitude $P$ acts vertically downward at $x=L$. Assume small deflections and the validity of linearized kinematics. Using the principle of minimum potential energy and a Rayleigh–Ritz reduced model, approximate the transverse deflection field $w(x)$ by the two-parameter admissible form\n$$\nw(x)=a\\,\\phi_{1}(x)+b\\,\\phi_{2}(x), \\quad \\phi_{1}(x)=\\left(\\frac{x}{L}\\right)^{2}, \\quad \\phi_{2}(x)=\\left(\\frac{x}{L}\\right)^{3},\n$$\nwhich satisfies the essential boundary conditions $w(0)=0$ and $w'(0)=0$ at the clamp for any coefficients $a$ and $b$.\n\nStarting from fundamental definitions for the bending strain energy and external work, construct the total potential energy functional, enforce its stationarity with respect to the coefficients $a$ and $b$, and determine the resulting Rayleigh–Ritz approximation for the tip deflection $w(L)$.\n\nProvide your final answer as a closed-form analytic expression in terms of $P$, $E$, $I$, and $L$. Do not compute any numerical values and do not include units in your final expression.", "solution": "**Solution Derivation**\nThe principle of minimum potential energy states that for a conservative system in stable equilibrium, the total potential energy $\\Pi$ is stationary with respect to admissible kinematic variations. The total potential energy is the sum of the internal strain energy $U$ and the potential energy of the external loads $V$.\n$$\n\\Pi = U + V\n$$\nThe strain energy $U$ for an Euler-Bernoulli beam under the assumption of small deflections is given by:\n$$\nU = \\frac{1}{2} \\int_{0}^{L} EI [w''(x)]^2 dx\n$$\nwhere $w''(x)$ is the curvature of the beam. The potential energy of the external concentrated load $P$ acting at $x=L$ is:\n$$\nV = -P w(L)\n$$\nThe approximate deflection field is given by $w(x) = a\\left(\\frac{x}{L}\\right)^2 + b\\left(\\frac{x}{L}\\right)^3$. We first compute the second derivative, $w''(x)$:\n$$\nw'(x) = \\frac{d}{dx}\\left[a\\frac{x^2}{L^2} + b\\frac{x^3}{L^3}\\right] = a\\frac{2x}{L^2} + b\\frac{3x^2}{L^3}\n$$\n$$\nw''(x) = \\frac{d}{dx}\\left[a\\frac{2x}{L^2} + b\\frac{3x^2}{L^3}\\right] = a\\frac{2}{L^2} + b\\frac{6x}{L^3}\n$$\nNow, we substitute $w''(x)$ into the expression for the strain energy $U$:\n$$\nU = \\frac{1}{2} \\int_{0}^{L} EI \\left( \\frac{2a}{L^2} + \\frac{6bx}{L^3} \\right)^2 dx\n$$\nExpand the integrand:\n$$\nU = \\frac{EI}{2} \\int_{0}^{L} \\left( \\frac{4a^2}{L^4} + \\frac{24abx}{L^5} + \\frac{36b^2x^2}{L^6} \\right) dx\n$$\nPerform the integration with respect to $x$ from $0$ to $L$:\n$$\nU = \\frac{EI}{2} \\left[ \\frac{4a^2x}{L^4} + \\frac{24abx^2}{2L^5} + \\frac{36b^2x^3}{3L^6} \\right]_{0}^{L}\n$$\n$$\nU = \\frac{EI}{2} \\left( \\frac{4a^2L}{L^4} + \\frac{12abL^2}{L^5} + \\frac{12b^2L^3}{L^6} \\right) = \\frac{EI}{2L^3} (4a^2 + 12ab + 12b^2)\n$$\n$$\nU = \\frac{EI}{L^3} (2a^2 + 6ab + 6b^2)\n$$\nNext, we determine the potential energy of the external load. The deflection at the tip $x=L$ is:\n$$\nw(L) = a\\left(\\frac{L}{L}\\right)^2 + b\\left(\\frac{L}{L}\\right)^3 = a+b\n$$\nSo, the potential energy of the load is:\n$$\nV = -P w(L) = -P(a+b)\n$$\nThe total potential energy $\\Pi$ is a function of the unknown coefficients $a$ and $b$:\n$$\n\\Pi(a,b) = U + V = \\frac{EI}{L^3} (2a^2 + 6ab + 6b^2) - P(a+b)\n$$\nTo find the equilibrium values of $a$ and $b$, we enforce the stationarity conditions by taking partial derivatives of $\\Pi$ with respect to $a$ and $b$ and setting them to zero:\n$$\n\\frac{\\partial \\Pi}{\\partial a} = \\frac{EI}{L^3}(4a + 6b) - P = 0 \\quad \\implies \\quad 4a + 6b = \\frac{PL^3}{EI}\n$$\n$$\n\\frac{\\partial \\Pi}{\\partial b} = \\frac{EI}{L^3}(6a + 12b) - P = 0 \\quad \\implies \\quad 6a + 12b = \\frac{PL^3}{EI}\n$$\nThis gives us a system of two linear equations for $a$ and $b$:\n1. $4a + 6b = \\frac{PL^3}{EI}$\n2. $6a + 12b = \\frac{PL^3}{EI}$\n\nTo solve this system, we can multiply the first equation by $2$:\n3. $8a + 12b = \\frac{2PL^3}{EI}$\n\nSubtracting the second equation from this new equation (3) eliminates $b$:\n$$\n(8a + 12b) - (6a + 12b) = \\frac{2PL^3}{EI} - \\frac{PL^3}{EI}\n$$\n$$\n2a = \\frac{PL^3}{EI} \\quad \\implies \\quad a = \\frac{PL^3}{2EI}\n$$\nSubstitute this result for $a$ back into the first equation:\n$$\n4\\left(\\frac{PL^3}{2EI}\\right) + 6b = \\frac{PL^3}{EI}\n$$\n$$\n\\frac{2PL^3}{EI} + 6b = \\frac{PL^3}{EI}\n$$\n$$\n6b = \\frac{PL^3}{EI} - \\frac{2PL^3}{EI} = -\\frac{PL^3}{EI}\n$$\n$$\nb = -\\frac{PL^3}{6EI}\n$$\nThe problem asks for the tip deflection, $w(L)$, which is given by $w(L) = a+b$.\n$$\nw(L) = \\frac{PL^3}{2EI} + \\left(-\\frac{PL^3}{6EI}\\right) = \\frac{3PL^3 - PL^3}{6EI} = \\frac{2PL^3}{6EI}\n$$\n$$\nw(L) = \\frac{PL^3}{3EI}\n$$\nThis result is the exact solution for the tip deflection of a cantilever beam with a point load at the free end. The chosen trial functions were capable of representing the exact deflection profile, so the Rayleigh-Ritz method correctly identified the exact coefficients.", "answer": "$$\\boxed{\\frac{P L^{3}}{3 E I}}$$", "id": "2675671"}, {"introduction": "An equilibrium state is not only a stationary point of the potential energy; its stability depends on the nature of that stationarity. This exercise delves into the crucial concept of stability by using the second variation of the potential energy functional as a diagnostic tool [@problem_id:2675668]. By analyzing the classic Euler buckling problem, you will explore how the potential energy landscape changes with applied load, leading to a transition from a stable minimum to a state of neutral stability at the critical bifurcation point.", "problem": "An initially straight, slender, prismatic elastic column of length $L$ and constant bending stiffness $E I$ has pin (simple) supports at $x=0$ and $x=L$. It is subjected to a conservative, configuration-independent axial compressive dead load $P$ applied at the ends along the axis of the undeformed column. Small transverse deflections $w(x)$ are permitted, with the standard small-slope approximation valid. Assume linear elastic bending energy for the column and use geometrically exact arclength for the end-shortening, consistently linearized to the appropriate order.\n\nUsing only fundamental definitions from elasticity and work-energy balance, the principle of stationary potential energy, and the second-variation stability criterion, decide which of the following statements are correct. Select all that apply.\n\nA. For the dead-load problem described, the straight configuration $w(x)\\equiv 0$ is a stationary point of the total potential energy for all $P \\ge 0$, but it is a strict local minimizer if and only if $PP_{\\mathrm{cr}}$, where $P_{\\mathrm{cr}}=\\dfrac{\\pi^2 E I}{L^2}$.\n\nB. The second variation of the total potential energy at $w\\equiv 0$ is given by $\\delta^2 \\Pi[0;\\eta]=\\displaystyle \\int_0^L \\big(E I\\,\\eta''(x)^2+P\\,\\eta'(x)^2\\big)\\,dx$ for all admissible variations $\\eta$, hence it is positive definite for all $P0$ and the straight configuration is always stable.\n\nC. At $P=P_{\\mathrm{cr}}$, the second variation at $w\\equiv 0$ is positive semidefinite with a one-dimensional nullspace spanned by $\\eta(x)=\\sin\\!\\big(\\dfrac{\\pi x}{L}\\big)$, indicating neutral stability and a bifurcation point.\n\nD. If the axial load were instead a follower load of the same magnitude $P$ (always tangent to the deformed axis), then the existence of a scalar total potential energy functional is guaranteed, and the same stationarity and second-variation conclusions would apply unchanged.\n\nE. If, instead of prescribing the dead load $P$, one prescribes the total end-shortening $\\Delta=\\Delta_0$ and seeks equilibria by minimizing the internal strain energy subject to this constraint via a Lagrange multiplier, then the multiplier equals the axial force in equilibrium and the second-variation stability test detects the onset of buckling at the same critical value $P_{\\mathrm{cr}}=\\dfrac{\\pi^2 E I}{L^2}$.", "solution": "**Derivation of the Total Potential Energy Functional**\n\nThe total potential energy $\\Pi$ is the sum of the internal strain energy $U$ and the potential energy of the external loads $V$.\n$$ \\Pi[w] = U[w] + V[w] $$\nThe internal strain energy due to bending, under the small-slope approximation where curvature $\\kappa \\approx w''(x)$, is given by:\n$$ U[w] = \\frac{1}{2} \\int_0^L EI (\\kappa(x))^2 dx = \\frac{1}{2} \\int_0^L EI (w''(x))^2 dx $$\nThe potential energy of the external dead load $P$ is $V[w] = -P \\Delta$, where $\\Delta$ is the axial shortening of the column due to bending. The work is done by the force $P$ over this distance. The shortening $\\Delta$ is the difference between the arc length of the deformed curve and the initial length $L$. For small slopes, the arc length $s$ is approximated as:\n$$ s = \\int_0^L \\sqrt{1 + (w'(x))^2} dx \\approx \\int_0^L \\left(1 + \\frac{1}{2}(w'(x))^2\\right) dx = L + \\frac{1}{2} \\int_0^L (w'(x))^2 dx $$\nThe shortening is therefore $\\Delta = s - L = \\frac{1}{2} \\int_0^L (w'(x))^2 dx$.\nThe potential energy of the load is:\n$$ V[w] = -\\frac{P}{2} \\int_0^L (w'(x))^2 dx $$\nCombining these, the total potential energy functional is:\n$$ \\Pi[w] = \\frac{1}{2} \\int_0^L \\left( EI (w''(x))^2 - P (w'(x))^2 \\right) dx $$\nEquilibrium configurations are stationary points of $\\Pi$, meaning the first variation $\\delta \\Pi[w; \\eta]$ must be zero for all admissible variations $\\eta$ (where $\\eta(0)=\\eta(L)=0$ due to the pin supports). A configuration is stable if it corresponds to a local minimum of $\\Pi$, which is tested by the second variation, $\\delta^2 \\Pi$.\n\nThe trivial configuration, $w(x) \\equiv 0$, is always an equilibrium state because $\\Pi[0] = 0$ and the Euler-Lagrange equation for $\\Pi$, which is $EI w'''' + P w'' = 0$, is trivially satisfied.\n\nThe stability of the trivial state is determined by the sign of the second variation of $\\Pi$ evaluated at $w \\equiv 0$:\n$$ \\delta^2 \\Pi[0; \\eta] = \\frac{d^2}{d\\epsilon^2} \\Pi[\\epsilon\\eta] \\Big|_{\\epsilon=0} = \\int_0^L \\left( EI (\\eta''(x))^2 - P (\\eta'(x))^2 \\right) dx $$\nThe trivial state is stable (a strict local minimum) if $\\delta^2 \\Pi[0; \\eta]  0$ for all admissible $\\eta \\not\\equiv 0$.\n\n**Evaluation of Options**\n\n**Option A:** \"For the dead-load problem described, the straight configuration $w(x)\\equiv 0$ is a stationary point of the total potential energy for all $P \\ge 0$, but it is a strict local minimizer if and only if $PP_{\\mathrm{cr}}$, where $P_{\\mathrm{cr}}=\\dfrac{\\pi^2 E I}{L^2}$.\"\n\nAs established, $w(x) \\equiv 0$ is always a stationary point. To test for a minimum, we analyze the sign of $\\delta^2 \\Pi[0; \\eta]$. We can expand any admissible variation $\\eta(x)$ in a Fourier sine series: $\\eta(x) = \\sum_{n=1}^\\infty a_n \\sin(\\frac{n\\pi x}{L})$. Substituting this into the expression for $\\delta^2 \\Pi$ and using orthogonality relations yields:\n$$ \\delta^2 \\Pi[0; \\eta] = \\frac{L}{2} \\sum_{n=1}^\\infty a_n^2 \\left( EI \\left(\\frac{n\\pi}{L}\\right)^4 - P \\left(\\frac{n\\pi}{L}\\right)^2 \\right) = \\frac{L}{2} \\sum_{n=1}^\\infty a_n^2 \\left(\\frac{n\\pi}{L}\\right)^2 \\left( EI \\left(\\frac{n\\pi}{L}\\right)^2 - P \\right) $$\nFor $\\delta^2 \\Pi$ to be positive for any choice of coefficients $a_n$ (not all zero), the term in the parentheses must be positive for all $n \\ge 1$. The term is minimized for $n=1$. Thus, we require:\n$$ EI \\left(\\frac{\\pi}{L}\\right)^2 - P  0 \\implies P  \\frac{\\pi^2 EI}{L^2} $$\nLetting $P_{\\mathrm{cr}} = \\frac{\\pi^2 EI}{L^2}$, the condition for the straight configuration to be a strict local minimizer is $P  P_{\\mathrm{cr}}$. This is an \"if and only if\" condition. If $P \\ge P_{\\mathrm{cr}}$, the second variation is not positive definite, so it is not a strict local minimizer. The statement is entirely correct.\n**Verdict: Correct**\n\n**Option B:** \"The second variation of the total potential energy at $w\\equiv 0$ is given by $\\delta^2 \\Pi[0;\\eta]=\\displaystyle \\int_0^L \\big(E I\\,\\eta''(x)^2+P\\,\\eta'(x)^2\\big)\\,dx$ for all admissible variations $\\eta$, hence it is positive definite for all $P0$ and the straight configuration is always stable.\"\n\nOur derivation shows the second variation is $\\delta^2 \\Pi[0; \\eta] = \\int_0^L \\left( EI (\\eta'')^2 - P (\\eta')^2 \\right) dx$. The statement incorrectly presents the sign of the term containing $P$ as positive. A compressive load $P$ reduces the system's stiffness with respect to transverse deflections, hence the negative sign. The given formula is incorrect. If the formula were correct, for $P0$, the integrand would be a sum of non-negative terms, making the functional positive definite and incorrectly implying the column is always stable under compression.\n**Verdict: Incorrect**\n\n**Option C:** \"At $P=P_{\\mathrm{cr}}$, the second variation at $w\\equiv 0$ is positive semidefinite with a one-dimensional nullspace spanned by $\\eta(x)=\\sin\\!\\big(\\dfrac{\\pi x}{L}\\big)$, indicating neutral stability and a bifurcation point.\"\n\nAt $P = P_{\\mathrm{cr}} = \\frac{\\pi^2 EI}{L^2}$, the expression for the second variation becomes:\n$$ \\delta^2 \\Pi[0; \\eta] = \\frac{L}{2} \\sum_{n=1}^\\infty a_n^2 \\left(\\frac{n\\pi}{L}\\right)^2 \\left( EI \\left(\\frac{n\\pi}{L}\\right)^2 - \\frac{\\pi^2 EI}{L^2} \\right) = \\frac{L}{2} \\frac{\\pi^2 EI}{L^2} \\sum_{n=1}^\\infty a_n^2 \\left(\\frac{n\\pi}{L}\\right)^2 (n^2 - 1) $$\nFor $n=1$, the term $(n^2 - 1)$ is zero. For all $n1$, $(n^2 - 1)  0$. Therefore, $\\delta^2 \\Pi[0; \\eta] \\ge 0$ for any variation, making it positive semidefinite. The equality $\\delta^2 \\Pi = 0$ holds if and only if $a_n=0$ for all $n1$. This means the nullspace (the set of variations for which $\\delta^2 \\Pi = 0$) consists of functions of the form $\\eta(x) = a_1 \\sin(\\frac{\\pi x}{L})$. This is a one-dimensional space spanned by $\\sin(\\frac{\\pi x}{L})$. This condition signifies neutral stability and is the mathematical indicator of a static bifurcation point, where a new, non-trivial equilibrium path (the buckled shape) emerges.\n**Verdict: Correct**\n\n**Option D:** \"If the axial load were instead a follower load of the same magnitude $P$ (always tangent to the deformed axis), then the existence of a scalar total potential energy functional is guaranteed, and the same stationarity and second-variation conclusions would apply unchanged.\"\n\nA fundamental requirement for the existence of a scalar potential energy functional is that all external forces must be conservative. A follower load, by definition, changes its direction based on the configuration (deformation) of the body. Such configuration-dependent forces are non-conservative. Therefore, a scalar total potential energy does not exist for a follower-load problem. The principle of stationary potential energy and the associated second-variation stability test are inapplicable. The stability of such systems must be investigated through non-conservative methods, like the principle of virtual work in its dynamic form (Lagrange's equations of motion). The resulting stability problem (Beck's problem) yields a different critical load ($P_{cr} \\approx 20.05 EI/L^2$) and a different instability mechanism (flutter), not static bifurcation.\n**Verdict: Incorrect**\n\n**Option E:** \"If, instead of prescribing the dead load $P$, one prescribes the total end-shortening $\\Delta=\\Delta_0$ and seeks equilibria by minimizing the internal strain energy subject to this constraint via a Lagrange multiplier, then the multiplier equals the axial force in equilibrium and the second-variation stability test detects the onset of buckling at the same critical value $P_{\\mathrm{cr}}=\\dfrac{\\pi^2 E I}{L^2}$.\"\n\nThis describes transitioning from a load-controlled problem to a displacement-controlled one. The problem becomes: find stationary points of $U[w]$ subject to the constraint $g[w] \\equiv \\frac{1}{2} \\int_0^L (w'(x))^2 dx - \\Delta_0 = 0$. We form the augmented functional (Lagrangian) $L[w, \\lambda] = U[w] - \\lambda g[w]$.\n$$ L[w, \\lambda] = \\frac{1}{2} \\int_0^L EI (w''(x))^2 dx - \\lambda \\left( \\frac{1}{2} \\int_0^L (w'(x))^2 dx - \\Delta_0 \\right) $$\nSetting the first variation with respect to $w$ to zero, $\\delta_w L = 0$, yields the Euler-Lagrange equation: $EI w'''' + \\lambda w'' = 0$. Comparing this with the equilibrium equation from the load-controlled case ($EI w'''' + P w'' = 0$), we identify the Lagrange multiplier $\\lambda$ with the axial force $P$. This is a general result: the multiplier is the generalized force conjugate to the constraint.\nStability is lost when the trivial solution ceases to be a constrained minimum of the strain energy. This occurs when the second variation of the Lagrangian, $\\delta^2 L = \\int_0^L (EI (\\eta'')^2 - \\lambda (\\eta')^2) dx$, ceases to be positive for all admissible variations $\\eta$ that are compatible with the (linearized) constraint. The critical condition is when $\\delta^2 L$ first becomes zero for some non-trivial $\\eta$. This leads to the eigenvalue problem for $\\lambda$: $\\lambda = \\min_{\\eta} \\frac{\\int_0^L EI (\\eta'')^2 dx}{\\int_0^L (\\eta')^2 dx}$. The minimum value is obtained for the first mode shape $\\eta(x) = \\sin(\\frac{\\pi x}{L})$, yielding $\\lambda_{\\mathrm{cr}} = \\frac{\\pi^2 EI}{L^2}$. Since $\\lambda=P$, the critical load is the same as in the load-controlled case. This equivalence is expected for conservative systems.\n**Verdict: Correct**", "answer": "$$\\boxed{ACE}$$", "id": "2675668"}, {"introduction": "The power of the Principle of Minimum Potential Energy extends profoundly into computational mechanics, providing a robust foundation for solving complex nonlinear problems. This practice challenges you to implement a finite element model for a bar with a unilateral contact constraint, a problem whose solution is governed by a variational inequality [@problem_id:2675683]. You will translate the abstract concept of minimizing a functional subject to an inequality constraint into a concrete computational algorithm, exploring the practical application of Karush–Kuhn–Tucker (KKT) conditions to determine contact status and reaction forces.", "problem": "You are given a one-dimensional linear elastic bar of length $L$, constant cross-sectional area $A$, and Young's modulus $E$. The bar is clamped at the left end ($x=0$) and subject to a concentrated axial force $P$ applied at the right end ($x=L$). The right end is in possible frictionless unilateral contact with a rigid stop located at a gap $g$ from the clamped configuration, which enforces the unilateral kinematic constraint $u(L) \\le g$, where $u(x)$ is the axial displacement field along the bar. Assume small strains and small displacements, and linear elastic behavior.\n\nAccording to the principle of minimum potential energy, the actual displacement field $u(x)$ among all kinematically admissible fields minimizes the total potential energy. Let the strain energy density be $W(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^2$, the strain be $\\varepsilon = du/dx$, and the external potential be $-P\\,u(L)$. In the presence of the unilateral constraint at $x=L$, the minimum is taken over all $u(x)$ satisfying $u(0)=0$ and $u(L)\\le g$. This leads to a variational inequality and associated Karush–Kuhn–Tucker (KKT) conditions with a nonnegative contact multiplier.\n\nTask: Discretize the bar using $N$ uniform two-node axial finite elements, with nodal displacements $\\{u_i\\}_{i=0}^{N}$, where $u_0 = 0$ is fixed. Assemble the global stiffness matrix $K \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ using linear shape functions and element length $h=L/N$, with each element stiffness $k_e = \\dfrac{EA}{h}\\begin{bmatrix}1  -1\\\\ -1  1\\end{bmatrix}$. Let the global force vector be $f \\in \\mathbb{R}^{N+1}$ with $f_N = P$ and zeros elsewhere. Define the discrete total potential energy as\n$$\n\\Pi(u) = \\tfrac{1}{2}\\,u^\\top K u - f^\\top u,\n$$\nwhere $u = (u_0,\\dots,u_N)^\\top$ and admissibility requires $u_0 = 0$ and $u_N \\le g$.\n\nYour program must compute, for each specified test case, the triplet consisting of:\n- the tip displacement $u_N$ in meters, \n- the boolean contact status indicating whether the unilateral constraint is active (true if $u_N$ is enforced to equal $g$ by contact reaction, false otherwise), and\n- the contact reaction $\\,\\lambda\\,$ in Newtons, defined as the nonnegative Lagrange multiplier associated with the inequality $u_N \\le g$ in the KKT conditions. Use the sign convention where the equilibrium condition reads $K u - f + \\lambda e_N = 0$, with $e_N$ the canonical unit vector corresponding to the tip degree of freedom. Under this convention, the reaction is computed from a converged displacement as $\\lambda = f_N - (K u)_N$ and must satisfy $\\lambda \\ge 0$ when contact is active, and $\\lambda = 0$ when contact is inactive.\n\nYour algorithm must be based on the following fundamental base:\n- Linear kinematics $\\varepsilon = du/dx$ and Hooke's law $\\sigma = E \\varepsilon$,\n- The principle of minimum potential energy leading to convex quadratic minimization,\n- Unilateral contact modeled as the inequality constraint $u_N \\le g$ with nonnegative multiplier $\\lambda$, implying the complementarity conditions $u_N \\le g$, $\\lambda \\ge 0$, and $\\lambda\\,(u_N - g) = 0$.\n\nDo not use any pre-derived shortcut formulas in your implementation; instead, assemble $K$ and $f$, enforce $u_0=0$, and solve the resulting convex quadratic problem with the unilateral constraint at the tip using a mathematically sound method (for instance, a small active-set check that first solves the unconstrained reduced system, tests the inequality at $u_N$, and, if violated, enforces $u_N = g$ and recomputes the state and reaction).\n\nNumerical instructions:\n- All inputs and outputs are in International System (SI) units: $L$ in meters, $A$ in square meters, $E$ in Pascals, $P$ and $\\lambda$ in Newtons, $g$ and displacements in meters.\n- Express the tip displacement in meters and the contact reaction in Newtons as floating-point numbers. The contact status must be a boolean.\n- Do not include angles. No percentages appear in this problem.\n- Use a numerical tolerance $\\,\\tau = 10^{-12}\\,$ when comparing the inequality $u_N \\le g$ to decide contact activity.\n\nTest suite:\nProvide solutions for the following four cases, each given as a tuple $(E, A, L, N, P, g)$:\n1. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 3.0\\times 10^{3},\\, 1.0\\times 10^{-2})$,\n2. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 3.0\\times 10^{3},\\, 1.0\\times 10^{-4})$,\n3. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 3.0\\times 10^{3},\\, 8.571428571428572\\times 10^{-4})$,\n4. $(7.0\\times 10^{10},\\, 1.0\\times 10^{-4},\\, 2.0,\\, 5,\\, 0.0,\\, 1.0\\times 10^{-4})$.\n\nFinal output format:\nYour program should produce a single line of output containing a comma-separated list of the four results, in the same order as the test suite, enclosed in square brackets. Each result must itself be a list in the order $[u_N,\\, \\text{contact\\_active},\\, \\lambda]$. For example, the output format must be like\n\"[ [u1,True,lambda1],[u2,False,lambda2],[u3,True,lambda3],[u4,False,lambda4] ]\"\nbut with the actual numerical values and booleans in place of the placeholders.", "solution": "The solution methodology follows the finite element method (FEM) combined with an active-set strategy to handle the unilateral contact constraint, as specified in the problem statement. The principle of minimum potential energy provides the theoretical foundation for this approach. The total potential energy $\\Pi(u)$ for the discretized system is a quadratic function of the nodal displacements $u$, which must be minimized subject to the kinematic constraints $u_0=0$ and $u_N \\le g$.\n\nFirst, we discretize the bar of length $L$ into $N$ uniform linear finite elements. Each element has length $h=L/N$. This results in a system with $N+1$ nodes, indexed from $0$ to $N$, with corresponding axial displacements $u_0, u_1, \\dots, u_N$. The element stiffness matrix $k_e$ for a two-node bar element is given by:\n$$\nk_e = \\frac{EA}{h}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\nwhere $E$ is Young's modulus and $A$ is the cross-sectional area. The global stiffness matrix $K \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ is assembled by iterating through all elements and adding their contributions to the corresponding global degrees of freedom.\n\nThe global external force vector $f \\in \\mathbb{R}^{N+1}$ is constructed by considering the concentrated force $P$ at the tip of the bar (node $N$). This results in a vector where all entries are zero except for $f_N = P$.\n\nThe essential boundary condition $u_0=0$ is handled by partitioning the system of equations. We separate the degrees of freedom into known (or prescribed) and unknown. Initially, only $u_0$ is known. The system of equations $Ku=F$ is reduced to a smaller system involving only the unknown displacements $u_1, \\dots, u_N$. Let $u_R = [u_1, \\dots, u_N]^T$ be the vector of free displacements. The reduced system is $K_{RR} u_R = f_R$, where $K_{RR}$ is the submatrix of $K$ corresponding to the free DOFs, and $f_R$ is the corresponding subvector of $f$.\n\nThe core of the problem is the unilateral contact constraint $u_N \\le g$ at the tip node. This inequality is managed using a simple and robust active-set method, which involves two main stages:\n\n1.  **Trial Step (Assume No Contact):** First, we solve the problem assuming the constraint is inactive ($\\lambda=0$). The reduced linear system $K_{RR} u_R = f_R$ is solved for $u_R$. This gives a trial displacement field, including the tip displacement, which we denote $u_N^{\\text{unc}}$. We then check if this trial solution is kinematically admissible with respect to the contact constraint. Using the specified tolerance $\\tau = 10^{-12}$, we test if $u_N^{\\text{unc}} \\le g + \\tau$.\n\n2.  **Decision and Correction (If Necessary):**\n    -   **If $u_N^{\\text{unc}} \\le g + \\tau$:** The trial solution is valid. The constraint is inactive. The final tip displacement is $u_N = u_N^{\\text{unc}}$, the contact status is `False`, and the contact reaction force $\\lambda$ is zero, as per the complementarity condition $\\lambda(u_N-g)=0$ with $u_N  g$ (or $u_N=g$ but without an enforcing reaction).\n    -   **If $u_N^{\\text{unc}}  g + \\tau$:** The trial solution violates the constraint. This means contact is active, and the constraint must be enforced as an equality, $u_N = g$. The problem is then re-solved with two prescribed displacements: $u_0=0$ and $u_N=g$. The unknown displacements are now $u_1, \\dots, u_{N-1}$. A new, smaller linear system is formed by partitioning $K$ and $f$ to solve for these internal displacements. The right-hand side of this system includes a term accounting for the effect of the prescribed non-zero displacement $g$ at node $N$. Once the full displacement vector $u$ is known (with $u_0=0$ and $u_N=g$), the final result is: the tip displacement is $u_N=g$, and the contact status is `True`. The contact reaction force $\\lambda$ is then calculated. It is the force required to maintain equilibrium while enforcing the displacement $u_N=g$. From the equilibrium equation at node $N$, $(K u)_N = f_N - \\lambda$, the reaction is computed as:\n        $$\n        \\lambda = f_N - (K u)_N\n        $$\n        This value must be non-negative, a condition which is guaranteed by the logic of activating the contact constraint only when the unconstrained displacement would have exceeded the gap.\n\nThis procedure correctly implements the Karush-Kuhn-Tucker (KKT) conditions for this constrained optimization problem and provides the required outputs for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n    # Test suite from the problem statement\n    # Each case is a tuple: (E, A, L, N, P, g)\n    test_cases = [\n        (7.0e10, 1.0e-4, 2.0, 5, 3.0e3, 1.0e-2),\n        (7.0e10, 1.0e-4, 2.0, 5, 3.0e3, 1.0e-4),\n        (7.0e10, 1.0e-4, 2.0, 5, 3.0e3, 8.571428571428572e-4),\n        (7.0e10, 1.0e-4, 2.0, 5, 0.0, 1.0e-4),\n    ]\n\n    results_as_strings = []\n    for case in test_cases:\n        u_N, contact_active, lambda_val = solve_case(*case)\n        # Format each result as '[u_N,contact_status,lambda]'\n        results_as_strings.append(f\"[{u_N},{str(contact_active)},{lambda_val}]\")\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_as_strings)}]\")\n\ndef solve_case(E, A, L, N, P, g):\n    \"\"\"\n    Solves the 1D bar problem with a unilateral contact constraint for a single test case.\n\n    Args:\n        E (float): Young's modulus [Pa]\n        A (float): Cross-sectional area [m^2]\n        L (float): Length of the bar [m]\n        N (int): Number of finite elements\n        P (float): Applied axial force at the tip [N]\n        g (float): Gap to the rigid stop [m]\n\n    Returns:\n        tuple: A triplet containing:\n            - u_N (float): Tip displacement [m]\n            - contact_active (bool): True if contact is active, False otherwise\n            - lambda_val (float): Contact reaction force [N]\n    \"\"\"\n    num_nodes = N + 1\n    h = L / N\n    tau = 1e-12  # Numerical tolerance for contact check\n\n    # 1. Assemble global stiffness matrix K and force vector f\n    k_e_val = E * A / h\n    k_e = k_e_val * np.array([[1, -1], [-1, 1]])\n    \n    K = np.zeros((num_nodes, num_nodes))\n    for i in range(N):\n        # Add element stiffness matrix to global matrix\n        K[i:i+2, i:i+2] += k_e\n\n    f = np.zeros(num_nodes)\n    f[N] = P\n\n    # 2. Trial step: Solve unconstrained problem (assuming no contact)\n    # The system is reduced by applying the constraint u_0 = 0.\n    # We solve for DOFs 1 to N.\n    dofs_free = np.arange(1, num_nodes)\n    K_red = K[np.ix_(dofs_free, dofs_free)]\n    f_red = f[dofs_free]\n    \n    u_R = np.linalg.solve(K_red, f_red)\n    u_N_unc = u_R[-1]\n\n    # 3. Check contact condition\n    if u_N_unc = g + tau:\n        # Case: Contact is NOT active\n        u_N = u_N_unc\n        contact_active = False\n        lambda_val = 0.0\n    else:\n        # Case: Contact IS active\n        u_N = g\n        contact_active = True\n        \n        # Re-solve for internal DOFs u_1, ..., u_{N-1}\n        # with u_0 = 0 and u_N = g set as knowns.\n        dofs_internal = np.arange(1, N) # DOFs from 1 to N-1\n        \n        # Partition K for internal DOFs\n        K_internal = K[np.ix_(dofs_internal, dofs_internal)]\n        \n        # Calculate effective force vector considering the prescribed displacement u_N = g.\n        # The contribution from u_0 is zero.\n        f_effective = f[dofs_internal] - K[dofs_internal, N] * g\n        \n        u_internal = np.linalg.solve(K_internal, f_effective)\n        \n        # Assemble the full displacement vector\n        u_full = np.zeros(num_nodes)\n        u_full[dofs_internal] = u_internal\n        u_full[N] = g\n        \n        # Calculate the contact reaction lambda = f_N - (K*u)_N\n        internal_force_at_N = K[N, :] @ u_full\n        lambda_val = f[N] - internal_force_at_N\n\n    return u_N, contact_active, lambda_val\n\nsolve()\n```", "id": "2675683"}]}