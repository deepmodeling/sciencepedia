{"hands_on_practices": [{"introduction": "Verifying a theorem from first principles is a crucial step in mastering it. This practice guides you through the analysis of a simple truss with a nonlinear material law using two distinct methods: first, by directly applying static equilibrium and kinematic relations, and second, by constructing the system's total complementary energy and applying the Crotti-Engesser theorem. By demonstrating that both paths lead to the identical load-displacement relationship, this exercise provides a concrete verification of the theorem's validity for conservative, nonlinearly elastic systems.", "problem": "Consider a symmetric two-bar pin-jointed truss in a vertical plane. The supports are located at coordinates $\\left(-a,\\,0\\right)$ and $\\left(a,\\,0\\right)$, and the apex joint is located at $\\left(0,\\,h\\right)$ in the undeformed configuration. The two equal bars connect the apex to the left and right supports. A vertical load $P$ (downward) is applied at the apex. Assume small displacements with linearized kinematics, so that the initial direction cosines of each bar remain constant in the equilibrium relations. Each bar is massless, and only axial force is carried.\n\nEach bar is made of a conservative, nonlinearly elastic material described at the element level by the axial force–elongation law\n$$\nN \\;=\\; k\\,\\sinh\\!\\left(\\frac{\\Delta}{\\Delta_{0}}\\right),\n$$\nwith $k \\gt 0$ and $\\Delta_{0} \\gt 0$ material constants, $N$ the axial force (tension positive), and $\\Delta$ the axial elongation of the bar. This relation is strictly monotone and invertible, and the stored energy is path independent. These are precisely the assumptions under which the Crotti–Engesser theorem holds.\n\nLet $\\delta$ denote the vertical displacement (downward positive) of the apex. Let $L=\\sqrt{a^{2}+h^{2}}$ be the undeformed length of each bar, and let $\\theta$ be the initial angle each bar makes with the horizontal, so that $\\sin\\theta=h/L$.\n\nTasks:\n- Using only static equilibrium at the apex, the small-displacement kinematic projection, and the constitutive relation, derive a closed-form expression for the load–displacement response $\\delta(P)$ in terms of $P$, $a$, $h$, $k$, and $\\Delta_{0}$. Do not introduce any additional approximations beyond those stated.\n- Define the complementary energy of one bar as\n$$\nU^{*}_{e}(N)\\;=\\;\\int_{0}^{N}\\Delta(n)\\,dn,\n$$\nwhere $\\Delta(n)$ is the inverse of the given constitutive law. Compute the total complementary energy $U^{*}(P)$ of the two-bar truss along the equilibrium path, expressing it in terms of $P$, $a$, $h$, $k$, and $\\Delta_{0}$.\n- Differentiate $U^{*}(P)$ with respect to $P$ at fixed geometry and material parameters, and compare the result with the $\\delta(P)$ obtained directly. Under the stated assumptions, verify the equality and simplify the expressions as far as possible.\n\nProvide as your final answer the single closed-form analytical expression for $\\delta(P)$ obtained from the direct equilibrium and constitutive inversion route. Use the International System of Units (SI): take $P$ and $k$ in newtons and $\\Delta_{0}$, $a$, $h$, $L$ in meters, so that $\\delta$ is in meters. Do not include units in your final boxed expression. No numerical rounding is required.", "solution": "We begin from first principles appropriate to statics and conservative nonlinear elasticity: (i) static equilibrium of forces at the apex, (ii) small-displacement kinematics relating nodal displacement to bar elongation by projection onto the bar axis, and (iii) the constitutive relation and its inverse, which exists by monotonicity, together with the definition of complementary energy as an integral of generalized displacements with respect to generalized forces.\n\nGeometry and kinematics. The undeformed length of each bar is\n$$\nL \\;=\\; \\sqrt{a^{2}+h^{2}},\n$$\nand the initial direction cosine with respect to the vertical is $\\sin\\theta=h/L$. Under small displacements, the vertical displacement $\\delta$ of the apex projects onto each bar to produce an axial elongation\n$$\n\\Delta \\;=\\; \\delta\\,\\sin\\theta \\;=\\; \\delta\\,\\frac{h}{L}.\n$$\n\nEquilibrium at the apex. Let $N$ denote the common axial tension in the two bars under the symmetric vertical load $P$. Static equilibrium at the apex requires the sum of vertical components of the bar forces to balance $P$:\n$$\n2\\,N\\,\\sin\\theta \\;=\\; P \\;\\;\\;\\Rightarrow\\;\\;\\; N(P) \\;=\\; \\frac{P}{2\\,\\sin\\theta} \\;=\\; \\frac{P\\,L}{2\\,h}.\n$$\n\nConstitutive inversion and direct load–displacement response. The given bar constitutive relation is\n$$\nN \\;=\\; k\\,\\sinh\\!\\left(\\frac{\\Delta}{\\Delta_{0}}\\right).\n$$\nBy monotonicity, it is invertible. The inverse gives the elongation as a function of axial force:\n$$\n\\Delta(N) \\;=\\; \\Delta_{0}\\,\\arcsinh\\!\\left(\\frac{N}{k}\\right).\n$$\nCombining with the kinematic projection,\n$$\n\\delta \\;=\\; \\frac{\\Delta}{\\sin\\theta} \\;=\\; \\frac{\\Delta_{0}}{\\sin\\theta}\\,\\arcsinh\\!\\left(\\frac{N}{k}\\right).\n$$\nSubstitute the equilibrium relation $N(P)=P/\\left(2\\sin\\theta\\right)$ to obtain\n$$\n\\delta(P) \\;=\\; \\frac{\\Delta_{0}}{\\sin\\theta}\\,\\arcsinh\\!\\left(\\frac{1}{k}\\,\\frac{P}{2\\,\\sin\\theta}\\right)\n\\;=\\; \\frac{\\Delta_{0}}{\\sin\\theta}\\,\\arcsinh\\!\\left(\\frac{P}{2\\,k\\,\\sin\\theta}\\right).\n$$\nUsing $\\sin\\theta=h/L$,\n$$\n\\delta(P) \\;=\\; \\frac{\\Delta_{0}\\,L}{h}\\,\\arcsinh\\!\\left(\\frac{P\\,L}{2\\,k\\,h}\\right).\n$$\n\nComplementary energy and the Crotti–Engesser verification. For a conservative, monotone, nonlinear elastic element with force $N$ and corresponding elongation $\\Delta(N)$, the complementary energy of one bar is defined by\n$$\nU^{*}_{e}(N) \\;=\\; \\int_{0}^{N} \\Delta(n)\\,dn \\;=\\; \\Delta_{0}\\int_{0}^{N} \\arcsinh\\!\\left(\\frac{n}{k}\\right)\\,dn.\n$$\nWe evaluate this integral in closed form. A standard antiderivative is\n$$\n\\int \\arcsinh(x)\\,dx \\;=\\; x\\,\\arcsinh(x) \\;-\\; \\sqrt{x^{2}+1} \\;+\\; C.\n$$\nWith the substitution $x=n/k$ and $dn=k\\,dx$, we obtain\n$$\n\\int_{0}^{N} \\arcsinh\\!\\left(\\frac{n}{k}\\right)\\,dn\n\\;=\\; \\left[n\\,\\arcsinh\\!\\left(\\frac{n}{k}\\right) \\;-\\; k\\,\\sqrt{1+\\left(\\frac{n}{k}\\right)^{2}}\\right]_{n=0}^{n=N}\n\\;=\\; N\\,\\arcsinh\\!\\left(\\frac{N}{k}\\right) \\;-\\; k\\,\\sqrt{1+\\left(\\frac{N}{k}\\right)^{2}} \\;+\\; k.\n$$\nTherefore, for one bar,\n$$\nU^{*}_{e}(N) \\;=\\; \\Delta_{0}\\,\\Bigg[\\,N\\,\\arcsinh\\!\\left(\\frac{N}{k}\\right) \\;-\\; k\\,\\sqrt{1+\\left(\\frac{N}{k}\\right)^{2}} \\;+\\; k \\,\\Bigg].\n$$\nThe total complementary energy of the symmetric two-bar truss is\n$$\nU^{*}(P) \\;=\\; 2\\,U^{*}_{e}\\!\\left(N(P)\\right)\n\\;=\\; 2\\,\\Delta_{0}\\,\\Bigg[\\,N(P)\\,\\arcsinh\\!\\left(\\frac{N(P)}{k}\\right) \\;-\\; k\\,\\sqrt{1+\\left(\\frac{N(P)}{k}\\right)^{2}} \\;+\\; k \\,\\Bigg],\n$$\nwith $N(P)=P\\,L/(2\\,h)$.\n\nTo compare with the direct response, differentiate $U^{*}(P)$ with respect to $P$ along the equilibrium path. It is more transparent to use the defining integral and the chain rule:\n$$\nU^{*}(P) \\;=\\; 2 \\int_{0}^{N(P)} \\Delta(n)\\,dn \\;\\;\\Rightarrow\\;\\; \\frac{dU^{*}}{dP} \\;=\\; 2\\,\\Delta\\!\\left(N(P)\\right)\\,\\frac{dN}{dP}.\n$$\nFrom equilibrium, $N(P)=P/(2\\,\\sin\\theta)$, so\n$$\n\\frac{dN}{dP} \\;=\\; \\frac{1}{2\\,\\sin\\theta}.\n$$\nUsing $\\Delta(N)=\\Delta_{0}\\,\\arcsinh\\!\\left(N/k\\right)$,\n$$\n\\frac{dU^{*}}{dP} \\;=\\; 2\\,\\Delta_{0}\\,\\arcsinh\\!\\left(\\frac{N(P)}{k}\\right)\\,\\frac{1}{2\\,\\sin\\theta}\n\\;=\\; \\frac{\\Delta_{0}}{\\sin\\theta}\\,\\arcsinh\\!\\left(\\frac{1}{k}\\,\\frac{P}{2\\,\\sin\\theta}\\right).\n$$\nRecognizing $\\sin\\theta=h/L$ and simplifying recovers exactly the direct load–displacement response,\n$$\n\\frac{dU^{*}}{dP} \\;=\\; \\frac{\\Delta_{0}\\,L}{h}\\,\\arcsinh\\!\\left(\\frac{P\\,L}{2\\,k\\,h}\\right) \\;=\\; \\delta(P).\n$$\nThus, under the stated assumptions of conservative, invertible, nonlinear elasticity and small-displacement kinematics with fixed geometry in the equilibrium relations, the derivative of the total complementary energy with respect to the applied load equals the corresponding generalized displacement, consistently with the content of the Crotti–Engesser theorem.\n\nThe required closed-form expression for the load–displacement response is therefore\n$$\n\\delta(P) \\;=\\; \\frac{\\Delta_{0}\\,L}{h}\\,\\arcsinh\\!\\left(\\frac{P\\,L}{2\\,k\\,h}\\right),\n$$\nwhere $L=\\sqrt{a^{2}+h^{2}}$.", "answer": "$$\\boxed{\\frac{\\Delta_{0}\\,\\sqrt{a^{2}+h^{2}}}{h}\\,\\arcsinh\\!\\left(\\frac{P\\,\\sqrt{a^{2}+h^{2}}}{2\\,k\\,h}\\right)}$$", "id": "2628188"}, {"introduction": "With the theorem's validity established, we can now wield it as an effective tool for structural analysis. This exercise asks you to determine the end rotation of a cantilever beam that includes a localized, nonlinearly elastic rotational spring—a common model in joint mechanics. You will assemble the total complementary energy, $U^*(M)$, from its linear and nonlinear parts and then obtain the solution directly through differentiation, showcasing the elegance of the energy-based approach for complex systems.", "problem": "A prismatic, slender Euler–Bernoulli cantilever beam of length $L$ and constant flexural rigidity $E I$ is subjected at its free end to a quasi-static, monotonically increasing applied end moment $M$ (no transverse forces). Along the beam there is a localized mechanical joint that is modeled as a concentrated rotational spring with relative rotation $\\theta$ and stored energy (potential) $U_h(\\theta)$ given by\n$$\nU_h(\\theta) \\;=\\; \\frac{k}{2}\\,\\theta^{2} \\;+\\; \\frac{\\alpha}{4}\\,\\theta^{4},\n$$\nwith $k>0$ and $\\alpha>0$. Assume geometrically small rotations and strains in the beam, linear elastic bending for the prismatic segments, and that the spring is stable, strictly monotone, and path-independent. The joint is located at an arbitrary position along the span but transmits the end moment $M$ without slip; the internal bending moment is uniform along the beam. \n\nUsing only fundamental work-conjugacy and energy principles, do the following:\n\n1) Construct the total complementary energy $U^{*}(M)$ of the system as a function of the applied end moment $M$, including both the distributed beam contribution and the localized hinge contribution. Express the hinge complementary energy contribution in terms of $M$ by using the Legendre transform of $U_h(\\theta)$.\n\n2) Then, compute the free-end rotation $\\Theta(M)$ in radians using the Crotti–Engesser (complementary energy) approach as the generalized displacement conjugate to $M$. Your final answer must be a single closed-form analytic expression for $\\Theta(M)$ in terms of $M$, $L$, $E I$, $k$, and $\\alpha$ (no numerical substitution). Express the angle in radians. Do not provide intermediate equations or inequalities as the final answer.", "solution": "The total rotation at the free end, $\\Theta$, is the sum of the rotation from the elastic bending of the beam itself, $\\Theta_{\\text{beam}}$, and the relative rotation at the localized nonlinear hinge, $\\theta$. This is a statement of kinematic compatibility for components in series:\n$$ \\Theta = \\Theta_{\\text{beam}} + \\theta $$\nAccording to the Crotti-Engesser theorem, the total rotation $\\Theta$ (the generalized displacement conjugate to the applied moment $M$) is the derivative of the total complementary energy of the system, $U^*(M)$, with respect to $M$:\n$$ \\Theta(M) = \\frac{dU^*(M)}{dM} $$\nThe total complementary energy $U^*$ is the sum of the complementary energies of the beam and the hinge:\n$$ U^*(M) = U^*_{\\text{beam}}(M) + U^*_{\\text{hinge}}(M) $$\nApplying the theorem, we can find the total rotation by summing the rotations of each component, which are derived from their respective complementary energies:\n$$ \\Theta(M) = \\frac{d}{dM} \\left( U^*_{\\text{beam}}(M) + U^*_{\\text{hinge}}(M) \\right) = \\frac{dU^*_{\\text{beam}}}{dM} + \\frac{dU^*_{\\text{hinge}}}{dM} = \\Theta_{\\text{beam}} + \\theta $$\nWe proceed by calculating each component.\n\n**1. Beam Contribution:**\nFor a linear elastic Euler-Bernoulli beam, the complementary energy density is $u^* = m^2/(2EI)$, where $m$ is the internal bending moment. Since the beam is under a pure end moment $M$, the internal moment is constant, $m(x) = M$. The total complementary energy of the beam is:\n$$ U^*_{\\text{beam}}(M) = \\int_0^L \\frac{M^2}{2EI} dx = \\frac{M^2 L}{2EI} $$\nThe rotation contribution from the beam is its derivative with respect to $M$:\n$$ \\Theta_{\\text{beam}}(M) = \\frac{dU^*_{\\text{beam}}}{dM} = \\frac{ML}{EI} $$\nThis is the standard result for a cantilever under a pure moment.\n\n**2. Hinge Contribution:**\nThe potential (strain) energy of the hinge is $U_h(\\theta) = \\frac{k}{2}\\theta^2 + \\frac{\\alpha}{4}\\theta^4$. The moment $M$ transmitted through the hinge is the derivative of its potential energy with respect to the rotation $\\theta$:\n$$ M(\\theta) = \\frac{dU_h}{d\\theta} = k\\theta + \\alpha\\theta^3 $$\nTo find the hinge rotation $\\theta$ as a function of $M$, we must invert this nonlinear constitutive relation. This involves solving the cubic equation for $\\theta$:\n$$ \\alpha\\theta^3 + k\\theta - M = 0 \\quad \\Rightarrow \\quad \\theta^3 + \\frac{k}{\\alpha}\\theta - \\frac{M}{\\alpha} = 0 $$\nThis is a depressed cubic equation of the form $x^3+px+q=0$, with $x=\\theta$, $p = k/\\alpha$, and $q = -M/\\alpha$. Since $k > 0$ and $\\alpha > 0$, the discriminant is positive, guaranteeing a single real root given by Cardano's formula:\n$$ \\theta(M) = \\sqrt[3]{-\\frac{q}{2} + \\sqrt{\\left(\\frac{q}{2}\\right)^2 + \\left(\\frac{p}{3}\\right)^3}} + \\sqrt[3]{-\\frac{q}{2} - \\sqrt{\\left(\\frac{q}{2}\\right)^2 + \\left(\\frac{p}{3}\\right)^3}} $$\nSubstituting $p=k/\\alpha$ and $q=-M/\\alpha$:\n$$ \\theta(M) = \\left(\\frac{M}{2\\alpha} + \\sqrt{\\frac{M^2}{4\\alpha^2} + \\frac{k^3}{27\\alpha^3}}\\right)^{1/3} + \\left(\\frac{M}{2\\alpha} - \\sqrt{\\frac{M^2}{4\\alpha^2} + \\frac{k^3}{27\\alpha^3}}\\right)^{1/3} $$\n\n**3. Total Rotation:**\nCombining the contributions from the beam and the hinge gives the total end rotation $\\Theta(M)$:\n$$ \\Theta(M) = \\Theta_{\\text{beam}} + \\theta(M) = \\frac{ML}{EI} + \\left(\\frac{M}{2\\alpha} + \\sqrt{\\frac{M^2}{4\\alpha^2} + \\frac{k^3}{27\\alpha^3}}\\right)^{1/3} + \\left(\\frac{M}{2\\alpha} - \\sqrt{\\frac{M^2}{4\\alpha^2} + \\frac{k^3}{27\\alpha^3}}\\right)^{1/3} $$\nThis is the required closed-form expression.", "answer": "$$\n\\boxed{\\frac{ML}{EI} + \\left(\\frac{M}{2\\alpha} + \\sqrt{\\frac{M^2}{4\\alpha^2} + \\frac{k^3}{27\\alpha^3}}\\right)^{1/3} + \\left(\\frac{M}{2\\alpha} - \\sqrt{\\frac{M^2}{4\\alpha^2} + \\frac{k^3}{27\\alpha^3}}\\right)^{1/3}}\n$$", "id": "2628192"}, {"introduction": "The final practice connects analytical theory to modern computational methods, a vital skill for engineers and researchers. You will derive the differential form of the Crotti-Engesser theorem, which expresses the system's tangent compliance, and then implement a numerical routine to solve the resulting ordinary differential equation. This computational exercise provides a tangible understanding of how the theorem is applied incrementally and serves as a powerful verification of the theory at an algorithmic level.", "problem": "Consider a one-dimensional, prismatic but possibly tapered, nonlinearly elastic bar of length $L$ subjected to a prescribed axial end load $P \\ge 0$. Assume infinitesimal strain kinematics, no body forces, and small displacements. Let the axial displacement at the loaded end relative to the fixed end be $u(P)$, the axial strain be $\\varepsilon(x;P)$, the axial Cauchy stress be $\\sigma(x;P)$, and the axial force be $N(x;P)$. Assume a deterministic cross-sectional area variation $A(x)$, with $x \\in [0,L]$, that is strictly positive over the domain. The bar is traction-free on its lateral surface, and the load is applied quasi-statically.\n\nFoundational base to be used:\n- Fundamental equilibrium for an axially loaded bar under the stated assumptions: $N(x;P) \\equiv P$ for all $x \\in [0,L]$.\n- Definition of axial stress: $\\sigma(x;P) = N(x;P)/A(x)$.\n- Small strain kinematics: the end-shortening (or elongation if positive) satisfies $u(P) = \\int_{0}^{L} \\varepsilon(x;P)\\,dx$.\n- Constitutive nonlinearity is pointwise, monotonic, and elastic: $\\sigma = \\sigma(\\varepsilon)$ with a strictly positive tangent modulus $E_{\\mathrm{t}}(\\varepsilon) = d\\sigma/d\\varepsilon > 0$. The complementary compliance satisfies $d\\varepsilon/d\\sigma = 1/E_{\\mathrm{t}}(\\varepsilon)$.\n- Chain rule in single-variable calculus.\n\nYour task is to formalize and verify the Crotti–Engesser theorem for this class of bars. In words, in a conservative nonlinearly elastic system, the derivative of a generalized displacement with respect to a load parameter equals the generalized displacement predicted by the linearized system formed with the current tangent stiffness distribution. For the present bar, you must start from the foundational base above (and nowhere else) and derive a first-order ordinary differential equation in $P$ for $u(P)$ whose right-hand side depends on $A(x)$ and the current tangent modulus field $E_{\\mathrm{t}}(x;P)$ evaluated along the equilibrium path. Do not use any pre-packaged formulas for this theorem; derive everything from the stated foundations.\n\nThen, implement a program that, for each test case below and for each prescribed load value, computes:\n- A “direct” nonlinear solution $u_{\\mathrm{dir}}(P)$ by solving, for each $x$, the pointwise constitutive equation $\\sigma(\\varepsilon) = P/A(x)$ to obtain $\\varepsilon(x;P)$ exactly, and numerically integrating $\\varepsilon(x;P)$ over $x$.\n- A Crotti–Engesser-derived solution $u_{\\mathrm{CE}}(P)$ by first deriving the ordinary differential equation in $P$ for $u(P)$ from the foundational base, then numerically integrating it from $P=0$ to the target $P$ along the equilibrium path, using the current tangent modulus $E_{\\mathrm{t}}(x;P)$.\n\nFinally, demonstrate agreement by reporting, for each test case, whether the maximum absolute discrepancy $\\max_{P \\in \\mathcal{P}} |u_{\\mathrm{dir}}(P) - u_{\\mathrm{CE}}(P)|$ over the specified load set $\\mathcal{P}$ is within a given absolute tolerance $\\delta$.\n\nConstitutive laws and area profiles for the test suite:\n- Test case $\\#1$ (smooth hardening, uniform area):\n  - Length $L = 1.0\\,\\mathrm{m}$.\n  - Area $A(x) \\equiv A_{0}$ with $A_{0} = 1.0\\times 10^{-3}\\,\\mathrm{m}^{2}$.\n  - Constitutive law $\\sigma = E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3}$ with $E = 2.0\\times 10^{11}\\,\\mathrm{Pa}$ and $\\alpha = 5.0\\times 10^{12}\\,\\mathrm{Pa}$.\n  - Load set $\\mathcal{P} = \\{\\,5.0\\times 10^{3}\\,\\mathrm{N},\\ 2.0\\times 10^{4}\\,\\mathrm{N},\\ 5.0\\times 10^{4}\\,\\mathrm{N}\\,\\}$.\n- Test case $\\#2$ (smooth hardening, linearly tapered area):\n  - Length $L = 2.0\\,\\mathrm{m}$.\n  - Area $A(x) = A_{0}\\bigl(1 + \\gamma\\,x/L\\bigr)$ with $A_{0} = 8.0\\times 10^{-4}\\,\\mathrm{m}^{2}$ and $\\gamma = -0.5$.\n  - Constitutive law $\\sigma = E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3}$ with $E = 2.1\\times 10^{11}\\,\\mathrm{Pa}$ and $\\alpha = 1.0\\times 10^{13}\\,\\mathrm{Pa}$.\n  - Load set $\\mathcal{P} = \\{\\,3.0\\times 10^{3}\\,\\mathrm{N},\\ 1.2\\times 10^{4}\\,\\mathrm{N},\\ 2.5\\times 10^{4}\\,\\mathrm{N},\\ 4.0\\times 10^{4}\\,\\mathrm{N}\\,\\}$.\n- Test case $\\#3$ (bilinear hardening, linearly tapered area):\n  - Length $L = 1.5\\,\\mathrm{m}$.\n  - Area $A(x) = A_{0}\\bigl(1 + \\gamma\\,x/L\\bigr)$ with $A_{0} = 1.2\\times 10^{-3}\\,\\mathrm{m}^{2}$ and $\\gamma = -0.6$.\n  - Bilinear constitutive law defined by an initial modulus $E = 2.1\\times 10^{11}\\,\\mathrm{Pa}$, a yield strain $\\varepsilon_{y} = 1.2\\times 10^{-3}$, and a positive post-yield tangent modulus $H = 1.0\\times 10^{10}\\,\\mathrm{Pa}$:\n    - If $\\varepsilon \\le \\varepsilon_{y}$, then $\\sigma = E\\,\\varepsilon$.\n    - If $\\varepsilon \\ge \\varepsilon_{y}$, then $\\sigma = \\sigma_{y} + H(\\varepsilon - \\varepsilon_{y})$ with $\\sigma_{y} = E\\,\\varepsilon_{y}$.\n  - Load set $\\mathcal{P} = \\{\\,5.0\\times 10^{4}\\,\\mathrm{N},\\ 1.5\\times 10^{5}\\,\\mathrm{N},\\ 3.0\\times 10^{5}\\,\\mathrm{N},\\ 5.0\\times 10^{5}\\,\\mathrm{N}\\,\\}$.\n\nImplementation requirements:\n- Compute the “direct” displacement $u_{\\mathrm{dir}}(P)$ in $\\mathrm{m}$ by solving, for each spatial location $x$, the pointwise equation $\\sigma(\\varepsilon) = P/A(x)$ exactly for $\\varepsilon(x;P)$ and then numerically integrating $\\varepsilon(x;P)$ over $x \\in [0,L]$.\n  - For the smooth hardening law, solve the cubic equation in $\\varepsilon$ exactly using a robust real-root formula or an equivalent mathematically exact transform. For the bilinear law, use its closed-form inverse.\n- Compute the Crotti–Engesser-derived displacement $u_{\\mathrm{CE}}(P)$ in $\\mathrm{m}$ by first deriving from the foundational base an ordinary differential equation in $P$ for $u(P)$, and then numerically integrating it from $P=0$ to the target $P$ using a quadrature that is at least second-order accurate in $P$ and in $x$. You must explicitly use the tangent modulus $E_{\\mathrm{t}}(x;P)$ of the current state along the equilibrium path.\n- Use consistent SI units: lengths in $\\mathrm{m}$, areas in $\\mathrm{m}^{2}$, loads in $\\mathrm{N}$, stresses in $\\mathrm{Pa}$, and moduli in $\\mathrm{Pa}$. Express all computed displacements internally and conceptually in $\\mathrm{m}$.\n- Verification tolerance: declare agreement for a test case if the maximum absolute discrepancy over its load set satisfies $\\max_{P \\in \\mathcal{P}} |u_{\\mathrm{dir}}(P) - u_{\\mathrm{CE}}(P)| \\le \\delta$, with $\\delta = 1.0\\times 10^{-9}\\,\\mathrm{m}$.\n- Your program should produce a single line of output containing the pass/fail results for the three test cases as a comma-separated list of booleans enclosed in square brackets, for example, `[True,False,True]`.\n\nYour program must be a complete, runnable script that takes no input and uses only the specified libraries.", "solution": "The task is to derive the differential form of the Crotti-Engesser theorem for a one-dimensional, nonlinearly elastic bar and then use it as the basis for a numerical solution.\n\n**1. Derivation of the Differential Equation**\nWe start from the foundational principles provided. The axial displacement at the loaded end, $u(P)$, is the integral of the axial strain, $\\varepsilon(x;P)$, over the bar's length, $L$:\n$$\nu(P) = \\int_{0}^{L} \\varepsilon(x;P)\\,dx\n$$\nWe seek the rate of change of this displacement with respect to the load $P$. Differentiating with respect to $P$ and applying the Leibniz integral rule (as the integration limits are constant) gives:\n$$\n\\frac{du}{dP} = \\frac{d}{dP} \\int_{0}^{L} \\varepsilon(x;P)\\,dx = \\int_{0}^{L} \\frac{\\partial \\varepsilon}{\\partial P}(x;P)\\,dx\n$$\nTo find the partial derivative $\\frac{\\partial \\varepsilon}{\\partial P}$, we use the chain rule, noting the dependencies $\\varepsilon(\\sigma)$ and $\\sigma(x, P)$:\n$$\n\\frac{\\partial \\varepsilon}{\\partial P}(x;P) = \\frac{d\\varepsilon}{d\\sigma} \\cdot \\frac{\\partial \\sigma}{\\partial P}(x;P)\n$$\nFrom the provided foundations:\n- The term $\\frac{d\\varepsilon}{d\\sigma}$ is the local compliance, which is the reciprocal of the tangent modulus $E_{\\mathrm{t}} = d\\sigma/d\\varepsilon$. Thus, $\\frac{d\\varepsilon}{d\\sigma} = \\frac{1}{E_{\\mathrm{t}}(\\varepsilon(x;P))}$. The tangent modulus depends on the current strain, making it a function of position $x$ and load $P$.\n- The term $\\frac{\\partial \\sigma}{\\partial P}$ is found from the stress definition $\\sigma(x;P) = P/A(x)$, which gives $\\frac{\\partial \\sigma}{\\partial P} = \\frac{1}{A(x)}$.\n\nSubstituting these into the chain rule expression yields:\n$$\n\\frac{\\partial \\varepsilon}{\\partial P}(x;P) = \\frac{1}{E_{\\mathrm{t}}(x;P)} \\cdot \\frac{1}{A(x)}\n$$\nFinally, substituting this back into the integral for $du/dP$, we arrive at the desired first-order ordinary differential equation for the end displacement $u(P)$:\n$$\n\\frac{du}{dP} = \\int_{0}^{L} \\frac{1}{E_{\\mathrm{t}}(x;P)A(x)}\\,dx\n$$\nThis equation is a statement of the Crotti-Engesser theorem in differential form for this system. The right-hand side represents the bar's total tangent compliance. The initial condition is $u(P=0) = 0$.\n\n**2. Numerical Verification Procedure**\nThe problem requires comparing two computational methods:\n\n- **Direct Solution ($u_{\\mathrm{dir}}(P)$):** For a given load $P$, the strain field $\\varepsilon(x;P)$ is found by solving the pointwise constitutive equation $\\sigma(\\varepsilon) = P/A(x)$ at discretized points along the bar. The total displacement is then found by numerically integrating this strain field: $u_{\\mathrm{dir}}(P) = \\int_{0}^{L} \\varepsilon(x;P)\\,dx$.\n\n- **Crotti-Engesser Solution ($u_{\\mathrm{CE}}(P)$):** This solution is found by numerically integrating the derived ODE from $P=0$ to a target load $P_{\\text{target}}$:\n$$\nu_{\\mathrm{CE}}(P_{\\text{target}}) = \\int_{0}^{P_{\\text{target}}} \\left( \\frac{du}{dP} \\right) dP = \\int_{0}^{P_{\\text{target}}} \\left( \\int_{0}^{L} \\frac{1}{E_{\\mathrm{t}}(x;P)A(x)}\\,dx \\right) dP\n$$\nThis involves a nested integration. The outer integral is over the load $P$, and for each load step, the inner integral over the length $x$ computes the system's total compliance, which depends on the state-dependent tangent modulus field $E_{\\mathrm{t}}(x;P)$.\n\nThe Python script in the answer implements both methods and verifies that their results agree within a tight tolerance, confirming the theorem at an algorithmic level.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and verify the Crotti-Engesser theorem numerically.\n    \"\"\"\n    \n    # Absolute tolerance for comparing the direct and Crotti-Engesser solutions.\n    DELTA = 1.0e-9  # m\n\n    # Define test cases\n    test_cases = [\n        {\n            \"L\": 1.0, # m\n            \"A_func\": lambda x: 1.0e-3, # m^2\n            \"law_params\": ('cubic', 2.0e11, 5.0e12), # E in Pa, alpha in Pa\n            \"P_set\": [5.0e3, 2.0e4, 5.0e4], # N\n        },\n        {\n            \"L\": 2.0,\n            \"A_func\": lambda x, A0=8.0e-4, gamma=-0.5, L=2.0: A0 * (1 + gamma * x / L),\n            \"law_params\": ('cubic', 2.1e11, 1.0e13),\n            \"P_set\": [3.0e3, 1.2e4, 2.5e4, 4.0e4],\n        },\n        {\n            \"L\": 1.5,\n            \"A_func\": lambda x, A0=1.2e-3, gamma=-0.6, L=1.5: A0 * (1 + gamma * x / L),\n            \"law_params\": ('bilinear', 2.1e11, 1.2e-3, 1.0e10), # E in Pa, eps_y, H in Pa\n            \"P_set\": [5.0e4, 1.5e5, 3.0e5, 5.0e5],\n        },\n    ]\n\n    results = []\n    \n    # Set high precision for numerical integration\n    q_opts = {'epsabs': 1e-14, 'epsrel': 1e-14, 'limit': 100}\n\n    for case in test_cases:\n        L = case[\"L\"]\n        A_func = case[\"A_func\"]\n        law_params = case[\"law_params\"]\n        P_set = case[\"P_set\"]\n\n        max_discrepancy = 0.0\n        for P in P_set:\n            u_dir = _calc_u_dir(P, L, A_func, law_params, q_opts)\n            u_ce = _calc_u_ce(P, L, A_func, law_params, q_opts)\n            max_discrepancy = max(max_discrepancy, abs(u_dir - u_ce))\n        \n        results.append(max_discrepancy <= DELTA)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef _get_strain_and_Et(sigma, law_params):\n    \"\"\"\n    Computes strain and tangent modulus for a given stress and material law.\n    `sigma`: Cauchy stress (Pa)\n    `law_params`: Tuple defining the constitutive law.\n    Returns: (strain, tangent_modulus)\n    \"\"\"\n    law_type = law_params[0]\n    \n    if law_type == 'cubic':\n        E, alpha = law_params[1], law_params[2]\n        # Solve the depressed cubic equation: e^3 + p*e + q = 0\n        p = E / alpha\n        q = -sigma / alpha\n        \n        # Cardano's formula for the single real root.\n        # The discriminant is always positive for P >= 0 and E, alpha > 0.\n        delta_sqrt = np.sqrt((q / 2)**2 + (p / 3)**3)\n        cbrt1 = np.cbrt(-q / 2 + delta_sqrt)\n        cbrt2 = np.cbrt(-q / 2 - delta_sqrt)\n        strain = cbrt1 + cbrt2\n        Et = E + 3 * alpha * strain**2\n        return strain, Et\n        \n    elif law_type == 'bilinear':\n        E, eps_y, H = law_params[1], law_params[2], law_params[3]\n        sigma_y = E * eps_y\n        \n        if sigma <= sigma_y:\n            strain = sigma / E\n            Et = E\n        else:\n            strain = eps_y + (sigma - sigma_y) / H\n            Et = H\n        return strain, Et\n\ndef _calc_u_dir(P, L, A_func, law_params, q_opts):\n    \"\"\"\n    Computes displacement using the direct integration method.\n    u_dir = integral[0, L] of epsilon(x; P) dx\n    \"\"\"\n    def integrand_strain(x):\n        area = A_func(x)\n        # Problem statement guarantees A(x) > 0.\n        stress = P / area\n        strain, _ = _get_strain_and_Et(stress, law_params)\n        return strain\n    \n    u_dir, _ = integrate.quad(integrand_strain, 0, L, **q_opts)\n    return u_dir\n\ndef _calc_u_ce(P_target, L, A_func, law_params, q_opts):\n    \"\"\"\n    Computes displacement by integrating the Crotti-Engesser ODE.\n    u_ce = integral[0, P_target] of (integral[0, L] of 1/(Et*A) dx) dP\n    \"\"\"\n    def compliance(P_current):\n        \"\"\" Computes du/dP at a given load P_current. \"\"\"\n\n        def integrand_compliance_density(x):\n            \"\"\" Computes 1 / (Et(x) * A(x)) at a given x. \"\"\"\n            area = A_func(x)\n            \n            # For P=0, stress=0, strain=0. Et is the initial elastic modulus.\n            if P_current == 0.0:\n                if law_params[0] == 'cubic':\n                    Et_initial = law_params[1]\n                else: # bilinear\n                    Et_initial = law_params[1]\n                return 1.0 / (Et_initial * area)\n\n            stress = P_current / area\n            _, Et = _get_strain_and_Et(stress, law_params)\n            return 1.0 / (Et * area)\n        \n        # Inner integral over the length L\n        total_compliance, _ = integrate.quad(integrand_compliance_density, 0, L, **q_opts)\n        return total_compliance\n\n    # Outer integral over the load P\n    u_ce, _ = integrate.quad(compliance, 0, P_target, **q_opts)\n    return u_ce\n\nsolve()\n```", "id": "2628181"}]}