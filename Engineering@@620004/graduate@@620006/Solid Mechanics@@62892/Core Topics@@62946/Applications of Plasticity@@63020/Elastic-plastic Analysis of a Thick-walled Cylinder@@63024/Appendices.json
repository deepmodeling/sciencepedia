{"hands_on_practices": [{"introduction": "Understanding when and where a component first yields is the critical first step in any structural integrity assessment. This exercise explores this crucial threshold by comparing the elastic stress states under two common engineering idealizations: plane stress and plane strain. By analyzing how axial constraints affect the stress distribution using the Lamé solution and the von Mises criterion, you will determine how these different assumptions influence the predicted pressure that initiates plastic deformation in a thick-walled cylinder [@problem_id:2633859].", "problem": "A long, closed-ended, thick-walled cylindrical pressure vessel of inner radius $r_i$ and outer radius $r_o$ is subjected to an internal pressure $p$ and zero external pressure. Assume small strains and an isotropic, linear-elastic, perfectly plastic material with Young’s modulus $E$, Poisson’s ratio $\\nu$, and von Mises yield stress $\\sigma_y$. Consider two load cases in the initial, fully elastic regime: (i) a very long cylinder with axial displacement constrained such that the axial strain is zero (plane strain, nonzero axial stress), and (ii) a thin slice with no axial stress (plane stress).\n\nLet $A$ and $B$ denote the constants of the classical Lamé elastic solution for a thick-walled cylinder under internal pressure, so that the axisymmetric radial and circumferential (hoop) Cauchy stresses can be represented by functions parameterized by $A$ and $B$. Using only axisymmetric equilibrium in cylindrical coordinates, linear elasticity, the plane strain condition for case (i), and the von Mises equivalent stress definition, carry out the following:\n\n- Derive the axial stress $\\sigma_z$ under plane strain in terms of $A$, $B$, and $\\nu$.\n- Derive a closed-form expression for the von Mises equivalent stress distribution $\\sigma_{eq}(r)$ in the fully elastic regime for case (i), in terms of $A$, $B$, $\\nu$, and $r$.\n- Using the fact that initial yielding occurs at the location where $\\sigma_{eq}(r)$ attains its maximum, determine the internal pressure $p$ that causes first yield at $r=r_i$ for case (i) and for case (ii). Then form the exact symbolic ratio of these two pressures (plane strain divided by plane stress) as a function of $r_i$, $r_o$, and $\\nu$.\n\nProvide only this ratio as your final answer. No numerical evaluation is required, and no rounding is needed. The final answer must be a single exact analytic expression with no units.", "solution": "The problem posed is a standard exercise in the linear elastic analysis of a thick-walled pressure vessel, a topic central to solid mechanics. It requires the application of fundamental principles, namely the Lamé solution for axisymmetric stress, Hooke's law for isotropic materials, and the von Mises yield criterion.\n\nFirst, the problem statement must be validated for scientific soundness, clarity, and completeness.\n\n**Step 1: Extract Givens**\n-   Geometry: A long, closed-ended, thick-walled cylinder with inner radius $r_i$ and outer radius $r_o$.\n-   Loading: Internal pressure $p$, zero external pressure.\n-   Material Properties: Isotropic, linear-elastic, perfectly plastic material with Young’s modulus $E$, Poisson’s ratio $\\nu$, and von Mises yield stress $\\sigma_y$.\n-   Assumptions: Small strains, axisymmetric conditions.\n-   Stress Representation: Radial stress $\\sigma_r$ and hoop stress $\\sigma_\\theta$ are given by the Lamé solution form, parameterized by constants $A$ and $B$.\n-   Load Cases:\n    -   Case (i): Plane strain, characterized by zero axial strain, $\\epsilon_z = 0$.\n    -   Case (ii): Plane stress, characterized by zero axial stress, $\\sigma_z = 0$.\n-   Required tasks:\n    1.  Derive the axial stress $\\sigma_z$ under plane strain in terms of $A$, $B$, and $\\nu$.\n    2.  Derive the von Mises equivalent stress $\\sigma_{eq}(r)$ under plane strain in terms of $A$, $B$, $\\nu$, and $r$.\n    3.  Determine the ratio of the internal pressures that cause first yield at $r=r_i$ for case (i) versus case (ii).\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is based on the classical theory of elasticity and plasticity, which are well-established fields of physics and engineering. The use of Lamé's equations and the von Mises criterion is standard practice.\n-   **Well-Posed:** The problem provides all necessary information (geometry, loading, material properties, and failure criterion) to determine a unique solution. The two cases (plane strain and plane stress) are standard, well-defined idealizations.\n-   **Objective:** The problem is stated using precise, unambiguous technical language.\n\n**Verdict and Action:** The problem is valid. It is a well-posed, scientifically sound problem in solid mechanics. I will proceed with the derivation.\n\nThe general Lamé solution for the radial and circumferential (hoop) stresses in a thick-walled cylinder is given by:\n$$ \\sigma_r(r) = A - \\frac{B}{r^2} $$\n$$ \\sigma_\\theta(r) = A + \\frac{B}{r^2} $$\nThe constants $A$ and $B$ are determined from the boundary conditions on the radial stress:\n1.  At the inner surface, $r=r_i$, the radial stress equals the negative of the internal pressure: $\\sigma_r(r_i) = -p$.\n2.  At the outer surface, $r=r_o$, the radial stress is zero due to zero external pressure: $\\sigma_r(r_o) = 0$.\n\nApplying these conditions:\n$$ A - \\frac{B}{r_o^2} = 0 \\implies A = \\frac{B}{r_o^2} $$\n$$ A - \\frac{B}{r_i^2} = -p $$\nSubstituting the expression for $A$ into the second equation:\n$$ \\frac{B}{r_o^2} - \\frac{B}{r_i^2} = -p \\implies B \\left( \\frac{r_i^2 - r_o^2}{r_i^2 r_o^2} \\right) = -p $$\nSolving for $B$ and subsequently for $A$:\n$$ B = \\frac{p r_i^2 r_o^2}{r_o^2 - r_i^2} $$\n$$ A = \\frac{p r_i^2}{r_o^2 - r_i^2} $$\nThese expressions for $A$ and $B$ are valid for both case (i) and case (ii).\n\n**Task 1: Axial Stress $\\sigma_z$ for Plane Strain (Case i)**\nFor an isotropic, linear-elastic material, the axial strain $\\epsilon_z$ is given by the generalized Hooke's Law:\n$$ \\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - \\nu(\\sigma_r + \\sigma_\\theta) \\right] $$\nThe condition for plane strain is $\\epsilon_z=0$. This implies:\n$$ \\sigma_z - \\nu(\\sigma_r + \\sigma_\\theta) = 0 \\implies \\sigma_z = \\nu(\\sigma_r + \\sigma_\\theta) $$\nSubstituting the Lamé solutions for $\\sigma_r$ and $\\sigma_\\theta$:\n$$ \\sigma_r + \\sigma_\\theta = \\left(A - \\frac{B}{r^2}\\right) + \\left(A + \\frac{B}{r^2}\\right) = 2A $$\nTherefore, the axial stress under plane strain is constant across the wall thickness:\n$$ \\sigma_z = 2\\nu A $$\n\n**Task 2: von Mises Stress $\\sigma_{eq}(r)$ for Plane Strain (Case i)**\nThe von Mises equivalent stress, $\\sigma_{eq}$, is defined as:\n$$ \\sigma_{eq}^2 = \\frac{1}{2} \\left[ (\\sigma_r - \\sigma_\\theta)^2 + (\\sigma_\\theta - \\sigma_z)^2 + (\\sigma_z - \\sigma_r)^2 \\right] $$\nWe compute the stress differences:\n-   $\\sigma_r - \\sigma_\\theta = \\left(A - \\frac{B}{r^2}\\right) - \\left(A + \\frac{B}{r^2}\\right) = -\\frac{2B}{r^2}$\n-   $\\sigma_\\theta - \\sigma_z = \\left(A + \\frac{B}{r^2}\\right) - (2\\nu A) = (1-2\\nu)A + \\frac{B}{r^2}$\n-   $\\sigma_z - \\sigma_r = (2\\nu A) - \\left(A - \\frac{B}{r^2}\\right) = (2\\nu-1)A + \\frac{B}{r^2}$\n\nSubstituting these into the expression for $\\sigma_{eq}^2$:\n$$ \\sigma_{eq}^2 = \\frac{1}{2} \\left[ \\left(-\\frac{2B}{r^2}\\right)^2 + \\left((1-2\\nu)A + \\frac{B}{r^2}\\right)^2 + \\left((2\\nu-1)A + \\frac{B}{r^2}\\right)^2 \\right] $$\nUsing the identity $(X+Y)^2 + (-X+Y)^2 = 2X^2 + 2Y^2$ where $X=(1-2\\nu)A$ and $Y=B/r^2$:\n$$ \\sigma_{eq}^2 = \\frac{1}{2} \\left[ \\frac{4B^2}{r^4} + 2((1-2\\nu)A)^2 + 2\\left(\\frac{B}{r^2}\\right)^2 \\right] $$\n$$ \\sigma_{eq}^2 = \\frac{1}{2} \\left[ \\frac{6B^2}{r^4} + 2(1-2\\nu)^2 A^2 \\right] = (1-2\\nu)^2 A^2 + \\frac{3B^2}{r^4} $$\nThus, the von Mises equivalent stress distribution for plane strain is:\n$$ \\sigma_{eq}(r) = \\sqrt{(1-2\\nu)^2 A^2 + \\frac{3B^2}{r^4}} $$\n\n**Task 3: Ratio of Yield Pressures**\nFirst, we find the pressure $p_{strain}$ that causes initial yield in the plane strain case. Yielding occurs when $\\sigma_{eq}(r)$ first reaches the yield stress $\\sigma_y$. The maximum value of $\\sigma_{eq}(r)$ occurs where $r$ is minimum, which is at the inner radius $r=r_i$.\nSetting $\\sigma_{eq}(r_i) = \\sigma_y$:\n$$ \\sigma_y^2 = (1-2\\nu)^2 A^2 + \\frac{3B^2}{r_i^4} $$\nSubstitute the expressions for $A$ and $B$ in terms of $p_{strain}$:\n$$ A = \\frac{p_{strain} r_i^2}{r_o^2 - r_i^2}, \\quad B = \\frac{p_{strain} r_i^2 r_o^2}{r_o^2 - r_i^2} $$\n$$ \\sigma_y^2 = (1-2\\nu)^2 \\left(\\frac{p_{strain} r_i^2}{r_o^2 - r_i^2}\\right)^2 + \\frac{3}{r_i^4} \\left(\\frac{p_{strain} r_i^2 r_o^2}{r_o^2 - r_i^2}\\right)^2 $$\n$$ \\sigma_y^2 = \\frac{p_{strain}^2}{(r_o^2 - r_i^2)^2} \\left[ (1-2\\nu)^2 r_i^4 + 3r_o^4 \\right] $$\nSolving for $p_{strain}$:\n$$ p_{strain} = \\frac{\\sigma_y (r_o^2 - r_i^2)}{\\sqrt{3r_o^4 + (1-2\\nu)^2 r_i^4}} $$\n\nNext, we find the pressure $p_{stress}$ that causes initial yield in the plane stress case (Case ii). Here, $\\sigma_z = 0$. The von Mises equivalent stress becomes:\n$$ \\sigma_{eq, stress}^2 = \\sigma_r^2 + \\sigma_\\theta^2 - \\sigma_r\\sigma_\\theta = \\left(A - \\frac{B}{r^2}\\right)^2 + \\left(A + \\frac{B}{r^2}\\right)^2 - \\left(A^2 - \\frac{B^2}{r^4}\\right) $$\n$$ \\sigma_{eq, stress}^2 = (A^2 - \\frac{2AB}{r^2} + \\frac{B^2}{r^4}) + (A^2 + \\frac{2AB}{r^2} + \\frac{B^2}{r^4}) - A^2 + \\frac{B^2}{r^4} = A^2 + \\frac{3B^2}{r^4} $$\nAgain, the maximum stress occurs at $r=r_i$. Setting $\\sigma_{eq, stress}(r_i) = \\sigma_y$:\n$$ \\sigma_y^2 = A^2 + \\frac{3B^2}{r_i^4} $$\nSubstitute $A$ and $B$ in terms of $p_{stress}$:\n$$ \\sigma_y^2 = \\left(\\frac{p_{stress} r_i^2}{r_o^2 - r_i^2}\\right)^2 + \\frac{3}{r_i^4} \\left(\\frac{p_{stress} r_i^2 r_o^2}{r_o^2 - r_i^2}\\right)^2 $$\n$$ \\sigma_y^2 = \\frac{p_{stress}^2}{(r_o^2 - r_i^2)^2} \\left[ r_i^4 + 3r_o^4 \\right] $$\nSolving for $p_{stress}$:\n$$ p_{stress} = \\frac{\\sigma_y (r_o^2 - r_i^2)}{\\sqrt{3r_o^4 + r_i^4}} $$\n\nFinally, we form the required ratio:\n$$ \\frac{p_{strain}}{p_{stress}} = \\frac{\\frac{\\sigma_y (r_o^2 - r_i^2)}{\\sqrt{3r_o^4 + (1-2\\nu)^2 r_i^4}}}{\\frac{\\sigma_y (r_o^2 - r_i^2)}{\\sqrt{3r_o^4 + r_i^4}}} = \\frac{\\sqrt{3r_o^4 + r_i^4}}{\\sqrt{3r_o^4 + (1-2\\nu)^2 r_i^4}} $$\nThis simplifies to the final expression.", "answer": "$$\n\\boxed{\\sqrt{\\frac{3 r_o^4 + r_i^4}{3 r_o^4 + (1-2\\nu)^2 r_i^4}}}\n$$", "id": "2633859"}, {"introduction": "Once yielding has begun, the next challenge is to predict how the plastic region grows with increasing load. This practice problem delves into the heart of post-yield analysis by having you derive the pressure-plasticity relationship from first principles for two fundamental yield criteria: Tresca and von Mises. By comparing their predictions for the evolution of the plastic radius, you will gain direct insight into how the choice of material model governs the calculated load-carrying capacity of the cylinder [@problem_id:2633860].", "problem": "A long, closed-ended, thick-walled cylindrical tube of inner radius $a$ and outer radius $b$ ($a  b$) is subjected to a monotonically increasing internal pressure $p_i$, with zero external pressure. The material is isotropic, homogeneous, and follows small-strain linear elasticity up to yield with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and rigid-perfectly plastic behavior beyond yield. Assume that, during plastic flow, the cylinder is in axial plane strain (axial total strain $ \\varepsilon_z = 0$), and that the plastic flow is associative (normality) for both the distortion-energy (von Mises, also called $J_2$) and maximum shear stress (Tresca) criteria. Let the uniaxial tensile yield stress be $\\sigma_y$.\n\nAs the pressure $p_i$ increases, an elastic-plastic interface develops at a radius $r_p$, with $a \\le r_p \\le b$, such that the region $a \\le r \\le r_p$ is plastic and $r_p \\le r \\le b$ is elastic. Take as fundamental starting points: the axisymmetric radial equilibrium equation in cylindrical coordinates, the Hooke law for linear elasticity, the plane-strain kinematic constraint, and the definitions of the von Mises ($J_2$) and Tresca yield criteria with associated flow.\n\nStarting from those bases (without invoking any pre-tabulated elastic-plastic cylinder formulas), derive, for each of the two yield criteria, the relation between the internal pressure $p_i$ and the plastic radius $r_p$, by enforcing:\n- radial equilibrium in each region,\n- the appropriate yield condition and associated flow in the plastic annulus,\n- continuity of radial and hoop stresses at $r=r_p$,\n- the traction boundary conditions $\\sigma_r(a) = -p_i$ and $\\sigma_r(b) = 0$.\n\nThen use your derived relations to determine the exact ratio\n$$\\frac{p_i^{\\mathrm{VM}}(r_p)}{p_i^{\\mathrm{Tr}}(r_p)}$$\npredicted by the von Mises and Tresca criteria for the same geometry $(a,b)$, material $(\\sigma_y)$, and the same plastic radius $r_p \\in [a,b]$. Express your final answer as an exact expression (no numerical rounding is required). No units are required for the final ratio.", "solution": "The problem requires the derivation of the internal pressure $p_i$ required to cause plastic yielding up to a radius $r_p$ in a thick-walled cylinder, for both the Tresca and von Mises yield criteria. The final objective is to find the ratio of these pressures, $p_i^{\\mathrm{VM}}(r_p) / p_i^{\\mathrm{Tr}}(r_p)$. The derivation must begin from fundamental principles.\n\nThe analysis is performed under the assumption of axial symmetry and plane strain, $\\varepsilon_z = 0$. The fundamental equation for radial equilibrium in cylindrical coordinates $(r, \\theta, z)$ is:\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0\n$$\nwhere $\\sigma_r$ is the radial stress and $\\sigma_\\theta$ is the hoop (circumferential) stress.\n\nThe cylinder is divided into two regions: an outer elastic annulus $r_p \\le r \\le b$ and an inner plastic annulus $a \\le r \\le r_p$.\n\nFirst, we establish the yield condition in a form suitable for this problem. The problem states to use the yield criteria with their associated flow rules under the plane strain condition $\\varepsilon_z = 0$.\n\nFor the Tresca criterion, the yield function is $f = \\max(|\\sigma_1-\\sigma_2|, |\\sigma_2-\\sigma_3|, |\\sigma_3-\\sigma_1|) - \\sigma_y = 0$. For internal pressure, we have $\\sigma_\\theta > \\sigma_z > \\sigma_r$. The plane strain condition $\\varepsilon_z = 0$ is satisfied by the plastic flow rule if $\\sigma_z$ is the intermediate principal stress. In this case, the Tresca criterion simplifies to:\n$$\n\\sigma_\\theta - \\sigma_r = \\sigma_y\n$$\n\nFor the von Mises criterion, the associated flow rule under plastic deformation requires $d\\varepsilon_{ij}^p = d\\lambda \\, s_{ij}$, where $s_{ij}$ is the deviatoric stress tensor. The plane strain condition on total strain, $\\varepsilon_z = 0$, is typically approximated in rigid-plastic or elastic-perfectly plastic analysis by assuming the plastic strain dominates, so $\\varepsilon_z^p \\approx 0$. The flow rule $d\\varepsilon_z^p = d\\lambda \\, s_{zz} = 0$ implies $s_{zz}=0$. This means $\\sigma_z - \\frac{1}{3}(\\sigma_r+\\sigma_\\theta+\\sigma_z)=0$, which simplifies to $\\sigma_z = \\frac{1}{2}(\\sigma_r + \\sigma_\\theta)$. Substituting this into the von Mises yield criterion $\\frac{1}{2}[(\\sigma_r-\\sigma_\\theta)^2 + (\\sigma_\\theta-\\sigma_z)^2 + (\\sigma_z-\\sigma_r)^2] = \\sigma_y^2$ gives:\n$$\n\\frac{1}{2}\\left[(\\sigma_r-\\sigma_\\theta)^2 + \\left(\\frac{\\sigma_\\theta-\\sigma_r}{2}\\right)^2 + \\left(\\frac{\\sigma_r-\\sigma_\\theta}{2}\\right)^2\\right] = \\sigma_y^2\n$$\n$$\n\\frac{3}{4}(\\sigma_\\theta - \\sigma_r)^2 = \\sigma_y^2 \\implies \\sigma_\\theta - \\sigma_r = \\frac{2}{\\sqrt{3}}\\sigma_y\n$$\nHere we note a subtlety: this form for the von Mises criterion, derived from plastic flow kinematics, is inconsistent with the elastic relation $\\sigma_z = \\nu(\\sigma_r+\\sigma_\\theta)$ unless Poisson's ratio $\\nu = 1/2$. A strict analysis would require a more complex treatment at the elastic-plastic interface. However, the problem directs the use of the flow rule as a fundamental starting point, which implies we are to use this simplified plane strain yield condition. This is a standard approach in many textbook treatments.\n\nWe can thus unify the analysis by defining a generic yield strength in shear for plane strain, $S$, such that the yield condition in the plastic region is $\\sigma_\\theta - \\sigma_r = S$.\nFor Tresca: $S_{\\mathrm{Tr}} = \\sigma_y$.\nFor von Mises: $S_{\\mathrm{VM}} = \\frac{2}{\\sqrt{3}}\\sigma_y$.\n\nNow, we analyze each region.\n\n**Elastic Region ($r_p \\le r \\le b$)**\nThe elastic stresses in a thick-walled cylinder have the general Lamé solution form, which satisfies equilibrium:\n$$\n\\sigma_r(r) = C_1 - \\frac{C_2}{r^2}\n$$\n$$\n\\sigma_\\theta(r) = C_1 + \\frac{C_2}{r^2}\n$$\nThe constants $C_1$ and $C_2$ are determined by the boundary conditions for this region. The outer surface is traction-free, so $\\sigma_r(b) = 0$.\n$$\nC_1 - \\frac{C_2}{b^2} = 0 \\implies C_1 = \\frac{C_2}{b^2}\n$$\nThe stresses become:\n$$\n\\sigma_r(r) = C_2\\left(\\frac{1}{b^2} - \\frac{1}{r^2}\\right) \\quad \\text{and} \\quad \\sigma_\\theta(r) = C_2\\left(\\frac{1}{b^2} + \\frac{1}{r^2}\\right)\n$$\nAt the elastic-plastic interface, $r=r_p$, the material is at the point of yielding. The stress state must satisfy the yield condition $\\sigma_\\theta(r_p) - \\sigma_r(r_p) = S$.\n$$\n\\left[C_2\\left(\\frac{1}{b^2} + \\frac{1}{r_p^2}\\right)\\right] - \\left[C_2\\left(\\frac{1}{b^2} - \\frac{1}{r_p^2}\\right)\\right] = S\n$$\n$$\n\\frac{2C_2}{r_p^2} = S \\implies C_2 = \\frac{S r_p^2}{2}\n$$\nThe radial stress at the interface $r=r_p$ is therefore:\n$$\n\\sigma_r(r_p) = \\frac{S r_p^2}{2} \\left(\\frac{1}{b^2} - \\frac{1}{r_p^2}\\right) = \\frac{S}{2} \\left(\\frac{r_p^2}{b^2} - 1\\right)\n$$\n\n**Plastic Region ($a \\le r \\le r_p$)**\nIn this region, the stresses must satisfy both equilibrium and the yield condition $\\sigma_\\theta - \\sigma_r = S$. Substituting the yield condition into the equilibrium equation:\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{-S}{r} = 0 \\implies \\frac{d\\sigma_r}{dr} = \\frac{S}{r}\n$$\nWe integrate this equation from the inner radius $a$ to the interface radius $r_p$:\n$$\n\\int_{\\sigma_r(a)}^{\\sigma_r(r_p)} d\\sigma_r = \\int_a^{r_p} S \\frac{dr}{r}\n$$\n$$\n\\sigma_r(r_p) - \\sigma_r(a) = S \\left[ \\ln(r) \\right]_a^{r_p} = S \\ln\\left(\\frac{r_p}{a}\\right)\n$$\nThe boundary condition at the inner surface is $\\sigma_r(a) = -p_i$. Substituting this:\n$$\n\\sigma_r(r_p) - (-p_i) = S \\ln\\left(\\frac{r_p}{a}\\right) \\implies p_i = S \\ln\\left(\\frac{r_p}{a}\\right) - \\sigma_r(r_p)\n$$\n\n**Pressure-Radius Relation**\nTo find the relation between $p_i$ and $r_p$, we use the continuity of radial stress at the interface $r=r_p$. We substitute the expression for $\\sigma_r(r_p)$ from the elastic solution into the equation for $p_i$:\n$$\np_i = S \\ln\\left(\\frac{r_p}{a}\\right) - \\left[\\frac{S}{2} \\left(\\frac{r_p^2}{b^2} - 1\\right)\\right]\n$$\n$$\np_i(r_p) = S \\left[ \\ln\\left(\\frac{r_p}{a}\\right) - \\frac{1}{2}\\frac{r_p^2}{b^2} + \\frac{1}{2} \\right] = S \\left[ \\ln\\left(\\frac{r_p}{a}\\right) + \\frac{1}{2}\\left(1 - \\frac{r_p^2}{b^2}\\right) \\right]\n$$\nThis is the general expression for the internal pressure as a function of the plastic zone radius $r_p$.\n\n**Ratio of Pressures**\nNow, we write the specific expressions for the von Mises and Tresca criteria.\n\nFor von Mises (VM), using $S_{\\mathrm{VM}} = \\frac{2}{\\sqrt{3}}\\sigma_y$:\n$$\np_i^{\\mathrm{VM}}(r_p) = \\frac{2}{\\sqrt{3}}\\sigma_y \\left[ \\ln\\left(\\frac{r_p}{a}\\right) + \\frac{1}{2}\\left(1 - \\frac{r_p^2}{b^2}\\right) \\right]\n$$\n\nFor Tresca (Tr), using $S_{\\mathrm{Tr}} = \\sigma_y$:\n$$\np_i^{\\mathrm{Tr}}(r_p) = \\sigma_y \\left[ \\ln\\left(\\frac{r_p}{a}\\right) + \\frac{1}{2}\\left(1 - \\frac{r_p^2}{b^2}\\right) \\right]\n$$\n\nThe problem asks for the ratio $\\frac{p_i^{\\mathrm{VM}}(r_p)}{p_i^{\\mathrm{Tr}}(r_p)}$.\n$$\n\\frac{p_i^{\\mathrm{VM}}(r_p)}{p_i^{\\mathrm{Tr}}(r_p)} = \\frac{\\frac{2}{\\sqrt{3}}\\sigma_y \\left[ \\ln\\left(\\frac{r_p}{a}\\right) + \\frac{1}{2}\\left(1 - \\frac{r_p^2}{b^2}\\right) \\right]}{\\sigma_y \\left[ \\ln\\left(\\frac{r_p}{a}\\right) + \\frac{1}{2}\\left(1 - \\frac{r_p^2}{b^2}\\right) \\right]}\n$$\nThe term in the square brackets is non-zero for any elastic-plastic state where $r_p > a$, and also for the initial yield state ($r_p=a$), allowing for cancellation. The ratio is therefore independent of the geometry ($a$, $b$) and the extent of plastic deformation ($r_p$).\n$$\n\\frac{p_i^{\\mathrm{VM}}(r_p)}{p_i^{\\mathrm{Tr}}(r_p)} = \\frac{2}{\\sqrt{3}}\n$$\nThis constant ratio stems directly from the ratio of the effective yield strengths in shear under the plane strain assumption for the two criteria.", "answer": "$$\\boxed{\\frac{2}{\\sqrt{3}}}$$", "id": "2633860"}, {"introduction": "While analytical solutions offer fundamental insights, most real-world elastic-plastic analyses rely on numerical methods, particularly the finite element method (FEM). This hands-on computational exercise bridges the gap between theory and practice by guiding you through the implementation of a return mapping algorithm, a cornerstone of modern computational plasticity. You will develop a Newton-Raphson scheme to enforce yield consistency for a von Mises material with hardening, a procedure at the heart of commercial FEM software [@problem_id:2633902].", "problem": "Consider a thick-walled cylinder under axisymmetric loading in the small-strain regime, discretized in the radial direction. Focus on a single radial grid point at which the elastic predictor (trial) Cauchy stress state in the current load increment is known. Assume isotropic linear elasticity and associative von Mises plasticity with linear isotropic hardening.\n\nYour task is to formulate and implement a local Newton–Raphson (NR) iteration to enforce yield consistency and associated flow at this grid point. The update is performed on the plastic consistency parameter increment, which should be treated as a scalar unknown.\n\nBegin from the following fundamental base:\n- Small-strain kinematics with additive strain decomposition, linear isotropic elasticity with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and shear modulus $G = \\dfrac{E}{2(1+\\nu)}$.\n- Cauchy stress tensor $\\boldsymbol{\\sigma}$, its deviatoric part $\\mathbf{s} = \\boldsymbol{\\sigma} - \\dfrac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\mathbf{I}$, and von Mises equivalent stress $\\sigma_{\\mathrm{eq}} = \\sqrt{\\dfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}}$.\n- Von Mises yield function with linear isotropic hardening: $f(\\boldsymbol{\\sigma}, \\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\alpha)$, where $\\sigma_{y}(\\alpha) = \\sigma_{y0} + H\\,\\alpha$, initial yield stress $\\sigma_{y0}$, plastic hardening modulus $H$, and internal variable $\\alpha$ equal to the accumulated equivalent plastic strain.\n- Associated flow, plastic incompressibility, and standard Kuhn–Tucker conditions for rate-independent plasticity.\n- Local return mapping at a single grid point: given the elastic trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ and prior internal variable $\\alpha_n$, determine the plastic consistency increment $\\Delta\\lambda \\ge 0$ such that yield consistency is enforced and the updated state satisfies associative flow. The updated internal variable is $\\alpha_{n+1} = \\alpha_n + \\Delta\\lambda$.\n\nDefine a one-dimensional NR residual $r(\\Delta\\lambda)$ that enforces yield consistency at the end of the increment, together with its Jacobian $dr/d(\\Delta\\lambda)$. The unknown is the scalar $\\Delta\\lambda$. Use a robust iteration with an initial guess $\\Delta\\lambda_0 = 0$, a stopping criterion $\\lvert r(\\Delta\\lambda)\\rvert \\le \\varepsilon$ with tolerance $\\varepsilon = 10^{-9}$ in units of stress, and enforce $\\Delta\\lambda \\ge 0$ during the iteration.\n\nAssume axisymmetry with principal components $(\\sigma_r,\\sigma_{\\theta},\\sigma_z)$ and no shear at the grid point. You are given the elastic trial Cauchy stress components $(\\sigma_r^{\\mathrm{tr}},\\sigma_{\\theta}^{\\mathrm{tr}},\\sigma_z^{\\mathrm{tr}})$ in megapascal (MPa), Young’s modulus $E$ in megapascal (MPa), Poisson’s ratio $\\nu$ (dimensionless), initial yield $\\sigma_{y0}$ in megapascal (MPa), hardening modulus $H$ in megapascal (MPa), and prior internal variable $\\alpha_n$ (dimensionless). You must:\n- Compute $G = \\dfrac{E}{2(1+\\nu)}$.\n- Compute the trial deviatoric stress $\\mathbf{s}^{\\mathrm{tr}}$ and $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$.\n- If $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} \\le \\sigma_y(\\alpha_n)$, take $\\Delta\\lambda = 0$ (purely elastic).\n- Otherwise, solve for $\\Delta\\lambda$ via the local NR iteration on the yield-consistency residual.\n\nYou are not to assume any pre-derived return-mapping shortcut in the problem statement; derive the residual and Jacobian starting from the definitions above.\n\nPhysical units: report the plastic consistency increment $\\Delta\\lambda$ as a dimensionless float for each test case. Stresses and moduli used in intermediate computations are in megapascal (MPa).\n\nTest suite to implement and solve:\n- Case $1$ (elastic regime):\n  - $E = 210000$ MPa, $\\nu = 0.3$, $\\sigma_{y0} = 400$ MPa, $H = 1000$ MPa, $\\alpha_n = 0$,\n  - $(\\sigma_r^{\\mathrm{tr}},\\sigma_{\\theta}^{\\mathrm{tr}},\\sigma_z^{\\mathrm{tr}}) = (0, 300, 0)$ MPa.\n- Case $2$ (onset of yield, boundary):\n  - $E = 210000$ MPa, $\\nu = 0.3$, $\\sigma_{y0} = 400$ MPa, $H = 1000$ MPa, $\\alpha_n = 0$,\n  - $(\\sigma_r^{\\mathrm{tr}},\\sigma_{\\theta}^{\\mathrm{tr}},\\sigma_z^{\\mathrm{tr}}) = (-33.3333333333333, 366.6666666666667, -33.3333333333333)$ MPa.\n- Case $3$ (plastic correction with no prior hardening):\n  - $E = 210000$ MPa, $\\nu = 0.3$, $\\sigma_{y0} = 400$ MPa, $H = 1000$ MPa, $\\alpha_n = 0$,\n  - $(\\sigma_r^{\\mathrm{tr}},\\sigma_{\\theta}^{\\mathrm{tr}},\\sigma_z^{\\mathrm{tr}}) = (-50, 550, -50)$ MPa.\n- Case $4$ (plastic correction with prior hardening):\n  - $E = 210000$ MPa, $\\nu = 0.3$, $\\sigma_{y0} = 400$ MPa, $H = 1000$ MPa, $\\alpha_n = 0.05$,\n  - $(\\sigma_r^{\\mathrm{tr}},\\sigma_{\\theta}^{\\mathrm{tr}},\\sigma_z^{\\mathrm{tr}}) = (-233.3333333333333, 466.6666666666667, -233.3333333333333)$ MPa.\n\nFinal output format: your program should produce a single line of output containing the four computed values of $\\Delta\\lambda$ as a comma-separated list enclosed in square brackets, for example $[\\Delta\\lambda_1,\\Delta\\lambda_2,\\Delta\\lambda_3,\\Delta\\lambda_4]$. Each $\\Delta\\lambda$ must be printed as a floating-point number (dimensionless). No extra text should be printed.", "solution": "The problem requires the formulation and implementation of a numerical algorithm to solve for the plastic consistency increment, $\\Delta\\lambda$, for a single point subjected to an axisymmetric stress state. The material behavior is governed by von Mises plasticity with linear isotropic hardening. The solution will be obtained via a local Newton-Raphson (NR) iteration on the yield consistency condition.\n\nFirst, we establish the theoretical foundation. The problem operates under the assumption of small strains, where the total strain tensor $\\boldsymbol{\\varepsilon}$ is additively decomposed into an elastic part $\\boldsymbol{\\varepsilon}^e$ and a plastic part $\\boldsymbol{\\varepsilon}^p$:\n$$\n\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p\n$$\nThe stress-strain relationship is governed by Hooke's law for isotropic linear elasticity, $\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}^e$, where $\\mathbf{C}$ is the fourth-order elasticity tensor.\n\nThe core of the problem is the return mapping algorithm, which is an operator split method comprising an elastic predictor step followed by a plastic corrector step.\n\nStep 1: Elastic Predictor.\nGiven the state at the beginning of a time increment (or load step) $n$, characterized by the plastic strain $\\boldsymbol{\\varepsilon}^p_n$ and the accumulated equivalent plastic strain $\\alpha_n$, we compute a trial stress state, $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$. This is done by assuming the entire strain increment $\\Delta\\boldsymbol{\\varepsilon}$ is purely elastic:\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{C} : (\\boldsymbol{\\varepsilon}^e_n + \\Delta\\boldsymbol{\\varepsilon}) = \\boldsymbol{\\sigma}_n + \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}\n$$\nThe problem provides $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ directly. From this trial stress, we compute the trial deviatoric stress $\\mathbf{s}^{\\mathrm{tr}}$ and the trial von Mises equivalent stress $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$:\n$$\n\\sigma_m^{\\mathrm{tr}} = \\frac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}})\n$$\n$$\n\\mathbf{s}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\sigma_m^{\\mathrm{tr}} \\mathbf{I}\n$$\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} \\mathbf{s}^{\\mathrm{tr}} : \\mathbf{s}^{\\mathrm{tr}}}\n$$\nNext, we evaluate the yield function using the trial state and the internal variable from the previous step, $\\alpha_n$:\n$$\nf^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y(\\alpha_n) \\quad \\text{where} \\quad \\sigma_y(\\alpha_n) = \\sigma_{y0} + H\\alpha_n\n$$\nIf $f^{\\mathrm{tr}} \\le 0$, the point remains elastic (or is neutral loading from a plastic state). The trial state is the true state at the end of the increment, $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$. Consequently, the plastic strain does not change, $\\Delta\\boldsymbol{\\varepsilon}^p = \\mathbf{0}$, and the plastic consistency increment is $\\Delta\\lambda = 0$.\n\nIf $f^{\\mathrm{tr}} > 0$, the trial state lies outside the yield surface. A plastic correction is necessary to return the stress state to the updated yield surface.\n\nStep 2: Plastic Corrector.\nThe updated stress $\\boldsymbol{\\sigma}_{n+1}$ is related to the trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ by accounting for the plastic strain increment $\\Delta\\boldsymbol{\\varepsilon}^p$:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}^p\n$$\nThe plastic strain increment is determined by the associative flow rule, integrated using an implicit backward Euler scheme for unconditional stability:\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\\bigg|_{\\boldsymbol{\\sigma}_{n+1}} = \\Delta\\lambda \\frac{3}{2} \\frac{\\mathbf{s}_{n+1}}{\\sigma_{\\mathrm{eq}, n+1}}\n$$\nwhere $\\Delta\\lambda \\ge 0$ is the plastic consistency parameter. Since $\\mathrm{tr}(\\mathbf{s}_{n+1}) = 0$, the plastic flow is isochoric, meaning $\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = 0$. For an isotropic elastic material, the stress update can be decomposed. The mean stress is unaffected by the plastic correction: $\\sigma_{m, n+1} = \\sigma_m^{\\mathrm{tr}}$. The deviatoric stress update is:\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2G \\Delta\\boldsymbol{\\varepsilon}^p = \\mathbf{s}^{\\mathrm{tr}} - 2G \\left( \\Delta\\lambda \\frac{3}{2} \\frac{\\mathbf{s}_{n+1}}{\\sigma_{\\mathrm{eq}, n+1}} \\right) = \\mathbf{s}^{\\mathrm{tr}} - 3G\\Delta\\lambda \\frac{\\mathbf{s}_{n+1}}{\\sigma_{\\mathrm{eq}, n+1}}\n$$\nwhere $G = E / (2(1+\\nu))$ is the shear modulus. Rearranging this equation for $\\mathbf{s}_{n+1}$ reveals that $\\mathbf{s}_{n+1}$ and $\\mathbf{s}^{\\mathrm{tr}}$ are collinear:\n$$\n\\mathbf{s}_{n+1} \\left( 1 + \\frac{3G\\Delta\\lambda}{\\sigma_{\\mathrm{eq}, n+1}} \\right) = \\mathbf{s}^{\\mathrm{tr}}\n$$\nThis collinearity implies that the direction of the deviatoric stress does not change during the correction, i.e., $\\frac{\\mathbf{s}_{n+1}}{\\sigma_{\\mathrm{eq}, n+1}} = \\frac{\\mathbf{s}^{\\mathrm{tr}}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}}$. Substituting this back into the deviatoric stress update yields:\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 3G\\Delta\\lambda \\frac{\\mathbf{s}^{\\mathrm{tr}}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}}\n$$\nTaking the von Mises equivalent measure of both sides (by calculating $\\sqrt{\\frac{3}{2} \\mathbf{s}_{n+1}:\\mathbf{s}_{n+1}}$) results in a scalar relationship for the updated equivalent stress:\n$$\n\\sigma_{\\mathrm{eq}, n+1} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\lambda\n$$\nThis is the well-known radial return mapping equation for von Mises plasticity.\n\nStep 3: Newton-Raphson Iteration.\nThe goal is to find $\\Delta\\lambda \\ge 0$ that satisfies the yield consistency condition at the end of the step, $f(\\boldsymbol{\\sigma}_{n+1}, \\alpha_{n+1}) = 0$. This condition forms the basis of our residual equation for the NR iteration:\n$$\nr(\\Delta\\lambda) = \\sigma_{\\mathrm{eq}, n+1} - \\sigma_y(\\alpha_{n+1}) = 0\n$$\nThe updated internal variable $\\alpha_{n+1}$ is given by $\\alpha_{n+1} = \\alpha_n + \\Delta\\alpha$, where for von Mises plasticity, $\\Delta\\alpha = \\Delta\\lambda$. The updated yield stress is $\\sigma_y(\\alpha_{n+1}) = \\sigma_{y0} + H(\\alpha_n + \\Delta\\lambda) = \\sigma_y(\\alpha_n) + H\\Delta\\lambda$.\nSubstituting the expressions for $\\sigma_{\\mathrm{eq}, n+1}$ and $\\sigma_y(\\alpha_{n+1})$ into the residual equation:\n$$\nr(\\Delta\\lambda) = (\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\lambda) - (\\sigma_y(\\alpha_n) + H\\Delta\\lambda)\n$$\nRearranging terms, we obtain the final form of the residual:\n$$\nr(\\Delta\\lambda) = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y(\\alpha_n) - (3G + H)\\Delta\\lambda\n$$\nFor the NR iteration, we also need the Jacobian (the derivative of the residual with respect to the unknown $\\Delta\\lambda$):\n$$\nJ(\\Delta\\lambda) = \\frac{dr}{d(\\Delta\\lambda)} = -(3G + H)\n$$\nThe Newton-Raphson update rule for the $k$-th iteration is:\n$$\n\\Delta\\lambda^{(k+1)} = \\Delta\\lambda^{(k)} - \\frac{r(\\Delta\\lambda^{(k)})}{J(\\Delta\\lambda^{(k)})}\n$$\nWith an initial guess $\\Delta\\lambda^{(0)}=0$, the first iteration yields:\n$$\n\\Delta\\lambda^{(1)} = 0 - \\frac{r(0)}{-(3G+H)} = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y(\\alpha_n)}{3G+H}\n$$\nSince the residual $r(\\Delta\\lambda)$ is a linear function of $\\Delta\\lambda$, the Newton-Raphson method converges to the exact solution in a single iteration. The iteration loop in the implementation is thus formally required but will always terminate after one step for plastic cases. The value of $\\Delta\\lambda$ will be positive since we only enter this step when $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} > \\sigma_y(\\alpha_n)$, and $G, H > 0$.\n\nThe algorithm is summarized as follows:\n1.  Provide material parameters $E$, $\\nu$, $\\sigma_{y0}$, $H$, and the state $(\\boldsymbol{\\sigma}^{\\mathrm{tr}}, \\alpha_n)$.\n2.  Compute shear modulus $G = E / (2(1+\\nu))$.\n3.  Compute trial mean stress $\\sigma_m^{\\mathrm{tr}}$, deviatoric stress $\\mathbf{s}^{\\mathrm{tr}}$, and equivalent stress $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$.\n4.  Compute the current yield stress $\\sigma_y(\\alpha_n) = \\sigma_{y0} + H\\alpha_n$.\n5.  Check for yielding: If $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y(\\alpha_n) \\le 0$, set $\\Delta\\lambda = 0$.\n6.  If $f^{\\mathrm{tr}} > 0$, solve for $\\Delta\\lambda$ using the NR scheme:\n    a. Initialize $\\Delta\\lambda=0$ and set tolerance $\\varepsilon = 10^{-9}$.\n    b. Iterate: calculate $r(\\Delta\\lambda)$ and $J$. If $|r(\\Delta\\lambda)| \\le \\varepsilon$, stop. Otherwise, update $\\Delta\\lambda \\leftarrow \\Delta\\lambda - r/J$.\n    c. For linear hardening, this is equivalent to the direct calculation: $\\Delta\\lambda = f^{\\mathrm{tr}} / (3G+H)$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the plastic consistency increment (Delta_lambda) for several\n    test cases using a local Newton-Raphson iteration for a J2 plasticity\n    model with linear isotropic hardening.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (E, nu, sigma_y0, H, alpha_n, sigma_tr_components)\n    test_cases = [\n        (210000.0, 0.3, 400.0, 1000.0, 0.0, np.array([0.0, 300.0, 0.0])),\n        (210000.0, 0.3, 400.0, 1000.0, 0.0, np.array([-33.3333333333333, 366.6666666666667, -33.3333333333333])),\n        (210000.0, 0.3, 400.0, 1000.0, 0.0, np.array([-50.0, 550.0, -50.0])),\n        (210000.0, 0.3, 400.0, 1000.0, 0.05, np.array([-233.3333333333333, 466.6666666666667, -233.3333333333333])),\n    ]\n\n    results = []\n    tolerance = 1e-9 # Stress units (MPa)\n    max_iterations = 10 # More than enough, as it converges in 1 step\n\n    for case in test_cases:\n        E, nu, sigma_y0, H, alpha_n, sigma_tr = case\n\n        # 1. Compute shear modulus\n        G = E / (2.0 * (1.0 + nu))\n\n        # 2. Compute trial deviatoric stress and equivalent stress\n        sigma_m_tr = np.mean(sigma_tr)\n        s_tr = sigma_tr - sigma_m_tr\n        # Note: s_tr:s_tr is the sum of squares of components for principal stresses\n        sigma_eq_tr = np.sqrt(3.0 / 2.0 * np.dot(s_tr, s_tr))\n\n        # 3. Compute current yield stress\n        sigma_y_n = sigma_y0 + H * alpha_n\n\n        # 4. Check for yielding\n        f_tr = sigma_eq_tr - sigma_y_n\n\n        delta_lambda = 0.0\n        if f_tr > 0:\n            # 5. Plastic step: solve for delta_lambda using Newton-Raphson\n            # Initialize unknown\n            delta_lambda_k = 0.0\n\n            for _ in range(max_iterations):\n                # Calculate residual of the yield consistency equation\n                # r = sigma_eq_tr - 3*G*delta_lambda - (sigma_y_n + H*delta_lambda)\n                residual = f_tr - (3.0 * G + H) * delta_lambda_k\n\n                # Check for convergence\n                if abs(residual) = tolerance:\n                    break\n\n                # Calculate Jacobian (derivative of residual w.r.t delta_lambda_k)\n                jacobian = -(3.0 * G + H)\n\n                # Newton-Raphson update\n                correction = -residual / jacobian\n                delta_lambda_k += correction\n                \n                # Enforce non-negativity constraint (though not strictly necessary here)\n                delta_lambda_k = max(0.0, delta_lambda_k)\n\n            delta_lambda = delta_lambda_k\n            \n        results.append(delta_lambda)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2633902"}]}