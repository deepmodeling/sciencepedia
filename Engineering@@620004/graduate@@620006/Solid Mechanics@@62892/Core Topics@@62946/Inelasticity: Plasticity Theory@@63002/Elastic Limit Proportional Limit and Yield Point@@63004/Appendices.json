{"hands_on_practices": [{"introduction": "This first practice provides a foundational exercise in the theory of plasticity. You will apply and contrast two of the most important phenomenological models for the onset of yielding: the Tresca and von Mises criteria. By calculating the critical loading parameter for a given biaxial stress state, you will gain hands-on experience in using these criteria and appreciate how their different physical bases—maximum shear stress versus distortional energy—lead to distinct predictions for material failure [@problem_id:2633393].", "problem": "A homogeneous, isotropic, linearly elastic solid is loaded proportionally along the stress path\n$$\n\\boldsymbol{\\sigma}(\\alpha)=\\alpha\\,\\mathrm{diag}\\!\\left(120,\\,-60,\\,0\\right)\\ \\text{MPa},\n$$\nwhere $\\alpha \\ge 0$ is a scalar loading parameter and the diagonal entries are principal Cauchy stresses in a fixed orthonormal basis. The material has a uniaxial tensile yield strength $\\,\\sigma_{y}=300\\,$ MPa as measured in a monotonic tension test, and it is idealized as elastic-perfectly plastic so that the onset of yielding coincides with the proportional limit.\n\nTwo alternative yield-onset criteria are considered:\n\n1) The maximum shear stress criterion (Tresca): yielding initiates when the maximum shear stress in the current state equals the maximum shear stress at uniaxial yielding.\n\n2) The distortional energy criterion (von Mises): yielding initiates when the second invariant of the deviatoric stress tensor equals that at uniaxial yielding.\n\nStarting from the above definitions and basic tensor-stress notions, determine the proportional loading parameter at first yield for each criterion, that is, find the two values $\\,\\alpha_{\\mathrm{T}}\\,$ and $\\,\\alpha_{\\mathrm{VM}}\\,$ such that $\\boldsymbol{\\sigma}(\\alpha)$ first reaches the onset of yield according to the Tresca and von Mises criteria, respectively. Express your final answer as a pair $\\left(\\alpha_{\\mathrm{T}},\\,\\alpha_{\\mathrm{VM}}\\right)$ in exact form (no rounding) and do not include units in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard exercise in the application of phenomenological yield criteria from the theory of plasticity. All necessary data and definitions are provided, and there are no internal contradictions, ambiguities, or factual inaccuracies. The problem is therefore deemed valid and a formal solution can be constructed.\n\nThe stress tensor for the given proportional loading path is given in its principal stress basis as:\n$$\n\\boldsymbol{\\sigma}(\\alpha) = \\begin{pmatrix} 120\\alpha & 0 & 0 \\\\ 0 & -60\\alpha & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\text{MPa}\n$$\nThe principal stresses are therefore $\\sigma_1 = 120\\alpha$, $\\sigma_2 = -60\\alpha$, and $\\sigma_3 = 0$. Since the loading parameter $\\alpha \\ge 0$, the ordering of principal stresses is $\\sigma_1 \\ge \\sigma_3 \\ge \\sigma_2$. The uniaxial tensile yield strength is given as $\\sigma_{y} = 300 \\text{ MPa}$.\n\nWe will now determine the critical value of the loading parameter $\\alpha$ at the onset of yield for each of the two specified criteria.\n\n**1. Tresca (Maximum Shear Stress) Criterion**\n\nThe Tresca criterion states that yielding initiates when the maximum shear stress, $\\tau_{\\text{max}}$, in the material reaches a critical value. This critical value is determined from a simple uniaxial tension test.\n\nFirst, we determine the maximum shear stress at yield in the uniaxial tension test. The stress state is $\\boldsymbol{\\sigma}_{\\text{uniaxial}} = \\text{diag}(\\sigma_y, 0, 0)$. The principal stresses are $\\sigma_{y}$, $0$, and $0$. The maximum shear stress is given by half the difference between the maximum and minimum principal stresses:\n$$\n\\tau_{\\text{yield}} = \\frac{\\sigma_{\\text{max}} - \\sigma_{\\text{min}}}{2} = \\frac{\\sigma_y - 0}{2} = \\frac{\\sigma_y}{2}\n$$\nSubstituting the given value $\\sigma_y = 300 \\text{ MPa}$:\n$$\n\\tau_{\\text{yield}} = \\frac{300}{2} = 150 \\text{ MPa}\n$$\nNext, we calculate the maximum shear stress for the given multi-axial stress state, $\\boldsymbol{\\sigma}(\\alpha)$. The principal stresses are $\\sigma_1 = 120\\alpha$, $\\sigma_2 = -60\\alpha$, and $\\sigma_3 = 0$. The maximum and minimum principal stresses are $\\sigma_{\\text{max}} = \\sigma_1 = 120\\alpha$ and $\\sigma_{\\text{min}} = \\sigma_2 = -60\\alpha$.\nThe maximum shear stress is:\n$$\n\\tau_{\\text{max}}(\\alpha) = \\frac{\\sigma_{\\text{max}} - \\sigma_{\\text{min}}}{2} = \\frac{120\\alpha - (-60\\alpha)}{2} = \\frac{180\\alpha}{2} = 90\\alpha\n$$\nAccording to the Tresca criterion, yielding occurs when $\\tau_{\\text{max}}(\\alpha_{\\mathrm{T}}) = \\tau_{\\text{yield}}$. We denote the critical parameter as $\\alpha_{\\mathrm{T}}$.\n$$\n90\\alpha_{\\mathrm{T}} = 150\n$$\nSolving for $\\alpha_{\\mathrm{T}}$:\n$$\n\\alpha_{\\mathrm{T}} = \\frac{150}{90} = \\frac{15}{9} = \\frac{5}{3}\n$$\n\n**2. Von Mises (Distortional Energy) Criterion**\n\nThe von Mises criterion states that yielding initiates when the second invariant of the deviatoric stress tensor, $J_2$, reaches a critical value determined from the uniaxial tension test.\n\nFirst, we determine the value of $J_2$ at yield in the uniaxial tension test. The principal stresses are $\\sigma_1 = \\sigma_y$, $\\sigma_2 = 0$, and $\\sigma_3 = 0$. The hydrostatic stress is $\\sigma_m = \\frac{1}{3}(\\sigma_1 + \\sigma_2 + \\sigma_3) = \\frac{\\sigma_y}{3}$. The principal deviatoric stresses are $s_1 = \\sigma_y - \\frac{\\sigma_y}{3} = \\frac{2\\sigma_y}{3}$, $s_2 = 0 - \\frac{\\sigma_y}{3} = -\\frac{\\sigma_y}{3}$, and $s_3 = 0 - \\frac{\\sigma_y}{3} = -\\frac{\\sigma_y}{3}$.\nThe second invariant of the deviatoric stress tensor, $J_2 = \\frac{1}{2}(s_1^2 + s_2^2 + s_3^2)$, is:\n$$\n(J_2)_{\\text{yield}} = \\frac{1}{2} \\left[ \\left(\\frac{2\\sigma_y}{3}\\right)^2 + \\left(-\\frac{\\sigma_y}{3}\\right)^2 + \\left(-\\frac{\\sigma_y}{3}\\right)^2 \\right] = \\frac{1}{2} \\left[ \\frac{4\\sigma_y^2}{9} + \\frac{\\sigma_y^2}{9} + \\frac{\\sigma_y^2}{9} \\right] = \\frac{1}{2} \\left( \\frac{6\\sigma_y^2}{9} \\right) = \\frac{\\sigma_y^2}{3}\n$$\nSubstituting $\\sigma_y = 300 \\text{ MPa}$:\n$$\n(J_2)_{\\text{yield}} = \\frac{(300)^2}{3} = \\frac{90000}{3} = 30000 \\text{ MPa}^2\n$$\nNext, we calculate $J_2$ for the given multi-axial stress state $\\boldsymbol{\\sigma}(\\alpha)$. The principal stresses are $\\sigma_1 = 120\\alpha$, $\\sigma_2 = -60\\alpha$, $\\sigma_3 = 0$. The hydrostatic stress is $\\sigma_m = \\frac{1}{3}(120\\alpha - 60\\alpha + 0) = \\frac{60\\alpha}{3} = 20\\alpha$.\nThe principal deviatoric stresses are:\n$s_1 = \\sigma_1 - \\sigma_m = 120\\alpha - 20\\alpha = 100\\alpha$\n$s_2 = \\sigma_2 - \\sigma_m = -60\\alpha - 20\\alpha = -80\\alpha$\n$s_3 = \\sigma_3 - \\sigma_m = 0 - 20\\alpha = -20\\alpha$\nThe second invariant $J_2(\\alpha)$ is:\n$$\nJ_2(\\alpha) = \\frac{1}{2} \\left[ (100\\alpha)^2 + (-80\\alpha)^2 + (-20\\alpha)^2 \\right] = \\frac{\\alpha^2}{2} [10000 + 6400 + 400] = \\frac{\\alpha^2}{2} [16800] = 8400\\alpha^2\n$$\nAlternatively, using the formula in terms of principal stresses, $J_2 = \\frac{1}{6}[(\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - \\sigma_3)^2 + (\\sigma_3 - \\sigma_1)^2]$:\n$$\nJ_2(\\alpha) = \\frac{1}{6} \\left[ (120\\alpha - (-60\\alpha))^2 + (-60\\alpha - 0)^2 + (0 - 120\\alpha)^2 \\right] = \\frac{\\alpha^2}{6} [180^2 + (-60)^2 + (-120)^2]\n$$\n$$\nJ_2(\\alpha) = \\frac{\\alpha^2}{6} [32400 + 3600 + 14400] = \\frac{\\alpha^2}{6} [50400] = 8400\\alpha^2\n$$\nThe results are consistent. According to the von Mises criterion, yielding occurs when $J_2(\\alpha_{\\mathrm{VM}}) = (J_2)_{\\text{yield}}$. We denote the critical parameter as $\\alpha_{\\mathrm{VM}}$.\n$$\n8400\\alpha_{\\mathrm{VM}}^2 = 30000\n$$\nSolving for $\\alpha_{\\mathrm{VM}}^2$:\n$$\n\\alpha_{\\mathrm{VM}}^2 = \\frac{30000}{8400} = \\frac{300}{84} = \\frac{100}{28} = \\frac{25}{7}\n$$\nSince $\\alpha \\ge 0$, we take the positive square root:\n$$\n\\alpha_{\\mathrm{VM}} = \\sqrt{\\frac{25}{7}} = \\frac{5}{\\sqrt{7}}\n$$\nThe problem requires the pair $(\\alpha_{\\mathrm{T}}, \\alpha_{\\mathrm{VM}})$. The final result is the ordered pair of the two calculated parameters.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{3} & \\frac{5}{\\sqrt{7}} \\end{pmatrix}}\n$$", "id": "2633393"}, {"introduction": "Moving from pure theory to its application in experimental mechanics, this problem challenges you to interpret a set of hypothetical cyclic loading data. You will operationalize the definition of the elastic limit by applying rigorous, quantitative criteria based on measurement noise and statistical significance for both residual strain and energy dissipation. This exercise is crucial for developing an understanding of how abstract material properties are precisely and objectively determined from real-world, imperfect measurements [@problem_id:2633435].", "problem": "A metallic specimen is subjected to a sequence of symmetric, strain-controlled uniaxial loading–unloading cycles with increasing peak strain. For each cycle, the following are recorded: the peak strain $\\,\\varepsilon_{\\max}\\,$, the corresponding peak Cauchy stress $\\,\\sigma_{\\max}\\,$ on the loading branch, the residual strain after full unloading $\\,\\varepsilon_{\\mathrm{res}}\\,$, and the enclosed hysteresis-loop area per unit volume $\\,W_{\\mathrm{diss}}\\,$ (energy dissipated per cycle, with units of $\\mathrm{J}/\\mathrm{m}^{3}$, numerically equal to $\\mathrm{Pa}$). The cycles are conducted slowly enough that rate effects are negligible, and the loading branches up to the first five cycles appear visually linear with a common slope. The instrument noise is characterized by a standard deviation in strain measurement of $\\,s_{\\varepsilon}=3.0\\times 10^{-6}\\,$ and a standard deviation in energy-dissipation measurement of $\\,s_{W}=1.00\\times 10^{2}\\,\\mathrm{Pa}\\,$. The recorded data are:\n\n- Cycle 1: $\\varepsilon_{\\max}=2.0\\times 10^{-4}$, $\\sigma_{\\max}=1.40\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=1.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=1.80\\times 10^{2}\\,\\mathrm{Pa}$.\n- Cycle 2: $\\varepsilon_{\\max}=4.0\\times 10^{-4}$, $\\sigma_{\\max}=2.80\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=2.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=2.10\\times 10^{2}\\,\\mathrm{Pa}$.\n- Cycle 3: $\\varepsilon_{\\max}=6.0\\times 10^{-4}$, $\\sigma_{\\max}=4.20\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=3.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=2.60\\times 10^{2}\\,\\mathrm{Pa}$.\n- Cycle 4: $\\varepsilon_{\\max}=8.0\\times 10^{-4}$, $\\sigma_{\\max}=5.60\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=5.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=4.20\\times 10^{2}\\,\\mathrm{Pa}$.\n- Cycle 5: $\\varepsilon_{\\max}=1.0\\times 10^{-3}$, $\\sigma_{\\max}=7.00\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=8.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=6.80\\times 10^{2}\\,\\mathrm{Pa}$.\n- Cycle 6: $\\varepsilon_{\\max}=1.2\\times 10^{-3}$, $\\sigma_{\\max}=8.40\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=1.2\\times 10^{-5}$, $W_{\\mathrm{diss}}=1.20\\times 10^{3}\\,\\mathrm{Pa}$.\n- Cycle 7: $\\varepsilon_{\\max}=1.4\\times 10^{-3}$, $\\sigma_{\\max}=9.80\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=2.0\\times 10^{-5}$, $W_{\\mathrm{diss}}=1.60\\times 10^{3}\\,\\mathrm{Pa}$.\n- Cycle 8: $\\varepsilon_{\\max}=1.6\\times 10^{-3}$, $\\sigma_{\\max}=1.12\\times 10^{8}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=4.0\\times 10^{-5}$, $W_{\\mathrm{diss}}=2.20\\times 10^{3}\\,\\mathrm{Pa}$.\n\nDefine the elastic limit as the largest peak strain $\\,\\varepsilon_{\\max}\\,$ for which unloading produces negligible plastic strain and negligible hysteresis, each understood quantitatively as follows:\n\n- Negligible plastic strain means $\\,|\\varepsilon_{\\mathrm{res}}|\\,$ is statistically indistinguishable from zero under a three–standard deviation criterion, using the given strain noise.\n- Negligible hysteresis means $\\,W_{\\mathrm{diss}}\\,$ is not resolvably different from the energy expected of a conservative linear elastic cycle. Use a dual acceptance bound formed by the larger of an absolute floor based on three–standard deviation energy noise and a relative bound equal to two percent of the ideal recoverable elastic energy density stored at the peak strain.\n\nFor the relative bound, take the ideal recoverable elastic energy density to be the area under the loading branch from zero to $\\,\\varepsilon_{\\max}\\,$.\n\nUsing only fundamental definitions (path independence for linear elasticity, plastic strain as nonrecoverable strain, and energy density as the stress–strain line integral), determine the elastic-limit peak strain from the dataset under the acceptance policy above. Express the elastic-limit strain as a pure strain (unitless) and round your answer to four significant figures. Do not include units in your final answer.", "solution": "The problem requires the determination of the elastic-limit peak strain from a given set of experimental data. The validity of the problem statement must first be established.\n\nProblem Validation:\n\nStep 1: Extract Givens\n-   Symmetric, strain-controlled uniaxial loading–unloading cycles with increasing peak strain.\n-   Data recorded for each cycle: peak strain $\\varepsilon_{\\max}$, peak Cauchy stress $\\sigma_{\\max}$, residual strain after unloading $\\varepsilon_{\\mathrm{res}}$, and dissipated energy per unit volume $W_{\\mathrm{diss}}$.\n-   Rate effects are negligible.\n-   Loading branches up to the first five cycles appear visually linear with a common slope.\n-   Instrument noise standard deviations: strain $s_{\\varepsilon}=3.0\\times 10^{-6}$, energy dissipation $s_{W}=1.00\\times 10^{2}\\,\\mathrm{Pa}$.\n-   Dataset:\n    -   Cycle 1: $\\varepsilon_{\\max}=2.0\\times 10^{-4}$, $\\sigma_{\\max}=1.40\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=1.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=1.80\\times 10^{2}\\,\\mathrm{Pa}$.\n    -   Cycle 2: $\\varepsilon_{\\max}=4.0\\times 10^{-4}$, $\\sigma_{\\max}=2.80\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=2.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=2.10\\times 10^{2}\\,\\mathrm{Pa}$.\n    -   Cycle 3: $\\varepsilon_{\\max}=6.0\\times 10^{-4}$, $\\sigma_{\\max}=4.20\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=3.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=2.60\\times 10^{2}\\,\\mathrm{Pa}$.\n    -   Cycle 4: $\\varepsilon_{\\max}=8.0\\times 10^{-4}$, $\\sigma_{\\max}=5.60\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=5.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=4.20\\times 10^{2}\\,\\mathrm{Pa}$.\n    -   Cycle 5: $\\varepsilon_{\\max}=1.0\\times 10^{-3}$, $\\sigma_{\\max}=7.00\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=8.0\\times 10^{-6}$, $W_{\\mathrm{diss}}=6.80\\times 10^{2}\\,\\mathrm{Pa}$.\n    -   Cycle 6: $\\varepsilon_{\\max}=1.2\\times 10^{-3}$, $\\sigma_{\\max}=8.40\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=1.2\\times 10^{-5}$, $W_{\\mathrm{diss}}=1.20\\times 10^{3}\\,\\mathrm{Pa}$.\n    -   Cycle 7: $\\varepsilon_{\\max}=1.4\\times 10^{-3}$, $\\sigma_{\\max}=9.80\\times 10^{7}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=2.0\\times 10^{-5}$, $W_{\\mathrm{diss}}=1.60\\times 10^{3}\\,\\mathrm{Pa}$.\n    -   Cycle 8: $\\varepsilon_{\\max}=1.6\\times 10^{-3}$, $\\sigma_{\\max}=1.12\\times 10^{8}\\,\\mathrm{Pa}$, $\\varepsilon_{\\mathrm{res}}=4.0\\times 10^{-5}$, $W_{\\mathrm{diss}}=2.20\\times 10^{3}\\,\\mathrm{Pa}$.\n-   Definition of elastic limit: The largest peak strain $\\varepsilon_{\\max}$ for which two conditions are met.\n    -   Condition A (Negligible plastic strain): $|\\varepsilon_{\\mathrm{res}}|$ is statistically indistinguishable from zero under a three–standard deviation criterion: $|\\varepsilon_{\\mathrm{res}}| \\le 3 s_{\\varepsilon}$.\n    -   Condition B (Negligible hysteresis): $W_{\\mathrm{diss}}$ is not resolvably different from the energy expected of a conservative linear elastic cycle. The acceptance bound for $W_{\\mathrm{diss}}$ is the larger of two values:\n        -   An absolute floor based on three–standard deviation energy noise: $3 s_{W}$.\n        -   A relative bound equal to two percent of the ideal recoverable elastic energy density at peak strain: $0.02 U_e$.\n-   Ideal recoverable elastic energy density $U_e$ is the area under the loading branch from zero to $\\varepsilon_{\\max}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It provides a complete dataset and a set of precise, formal definitions to be applied to that data. The task is a standard analysis in experimental solid mechanics, free of contradiction, ambiguity, or factual unsoundness. The problem is valid.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nSolution:\nThe task is to find the largest peak strain, $\\varepsilon_{\\max}$, that satisfies the two specified criteria for the elastic limit. We will evaluate each cycle sequentially.\n\nFirst, we establish the quantitative thresholds for the two criteria.\n\nCriterion A: Negligible Residual Strain\nThe threshold for the residual strain is defined by a three-standard deviation criterion.\n$$ |\\varepsilon_{\\mathrm{res}}| \\le 3 s_{\\varepsilon} $$\nGiven $s_{\\varepsilon} = 3.0 \\times 10^{-6}$, the threshold is:\n$$ 3 s_{\\varepsilon} = 3 \\times (3.0 \\times 10^{-6}) = 9.0 \\times 10^{-6} $$\nA cycle is acceptable under this criterion if its measured residual strain $\\varepsilon_{\\mathrm{res}}$ is less than or equal to $9.0 \\times 10^{-6}$.\n\nCriterion B: Negligible Hysteresis\nThe threshold for dissipated energy, $W_{\\mathrm{bound}}$, is the maximum of an absolute and a relative bound.\n$$ W_{\\mathrm{diss}} \\le W_{\\mathrm{bound}} = \\max(3 s_{W}, 0.02 U_e) $$\nThe absolute bound is:\n$$ 3 s_{W} = 3 \\times (1.00 \\times 10^{2}\\,\\mathrm{Pa}) = 300\\,\\mathrm{Pa} $$\nThe relative bound depends on the ideal recoverable elastic energy density, $U_e$. For a linear elastic material, $U_e$ is the area of the triangle under the stress-strain curve up to the peak stress and strain:\n$$ U_e = \\frac{1}{2} \\sigma_{\\max} \\varepsilon_{\\max} $$\nThe problem states the loading branch is linear for the first five cycles. Let us verify this by calculating the apparent Young's modulus, $E = \\sigma_{\\max} / \\varepsilon_{\\max}$, for these cycles.\nFor Cycle 1: $E = \\frac{1.40 \\times 10^{7}\\,\\mathrm{Pa}}{2.0 \\times 10^{-4}} = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$.\nFor Cycle 2: $E = \\frac{2.80 \\times 10^{7}\\,\\mathrm{Pa}}{4.0 \\times 10^{-4}} = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$.\nFor Cycle 3: $E = \\frac{4.20 \\times 10^{7}\\,\\mathrm{Pa}}{6.0 \\times 10^{-4}} = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$.\nFor Cycle 4: $E = \\frac{5.60 \\times 10^{7}\\,\\mathrm{Pa}}{8.0 \\times 10^{-4}} = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$.\nFor Cycle 5: $E = \\frac{7.00 \\times 10^{7}\\,\\mathrm{Pa}}{1.0 \\times 10^{-3}} = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$.\nThe modulus is indeed constant at $E = 70\\,\\mathrm{GPa}$ through the first five cycles, validating the use of the linear elastic energy density formula.\n\nWe now evaluate each cycle against both criteria.\n\nCycle 1: $\\varepsilon_{\\max} = 2.0 \\times 10^{-4}$\n-   Criterion A: $\\varepsilon_{\\mathrm{res}} = 1.0 \\times 10^{-6}$. Is $1.0 \\times 10^{-6} \\le 9.0 \\times 10^{-6}$? Yes.\n-   Criterion B: $W_{\\mathrm{diss}} = 1.80 \\times 10^{2}\\,\\mathrm{Pa}$.\n    -   $U_e = \\frac{1}{2} (1.40 \\times 10^{7}\\,\\mathrm{Pa})(2.0 \\times 10^{-4}) = 1.40 \\times 10^{3}\\,\\mathrm{Pa}$.\n    -   Relative bound = $0.02 \\times U_e = 0.02 \\times (1.40 \\times 10^{3}\\,\\mathrm{Pa}) = 28\\,\\mathrm{Pa}$.\n    -   $W_{\\mathrm{bound}} = \\max(300\\,\\mathrm{Pa}, 28\\,\\mathrm{Pa}) = 300\\,\\mathrm{Pa}$.\n    -   Is $1.80 \\times 10^{2}\\,\\mathrm{Pa} \\le 300\\,\\mathrm{Pa}$? Yes.\n-   Result: Cycle 1 passes both criteria.\n\nCycle 2: $\\varepsilon_{\\max} = 4.0 \\times 10^{-4}$\n-   Criterion A: $\\varepsilon_{\\mathrm{res}} = 2.0 \\times 10^{-6}$. Is $2.0 \\times 10^{-6} \\le 9.0 \\times 10^{-6}$? Yes.\n-   Criterion B: $W_{\\mathrm{diss}} = 2.10 \\times 10^{2}\\,\\mathrm{Pa}$.\n    -   $U_e = \\frac{1}{2} (2.80 \\times 10^{7}\\,\\mathrm{Pa})(4.0 \\times 10^{-4}) = 5.60 \\times 10^{3}\\,\\mathrm{Pa}$.\n    -   Relative bound = $0.02 \\times (5.60 \\times 10^{3}\\,\\mathrm{Pa}) = 112\\,\\mathrm{Pa}$.\n    -   $W_{\\mathrm{bound}} = \\max(300\\,\\mathrm{Pa}, 112\\,\\mathrm{Pa}) = 300\\,\\mathrm{Pa}$.\n    -   Is $2.10 \\times 10^{2}\\,\\mathrm{Pa} \\le 300\\,\\mathrm{Pa}$? Yes.\n-   Result: Cycle 2 passes both criteria.\n\nCycle 3: $\\varepsilon_{\\max} = 6.0 \\times 10^{-4}$\n-   Criterion A: $\\varepsilon_{\\mathrm{res}} = 3.0 \\times 10^{-6}$. Is $3.0 \\times 10^{-6} \\le 9.0 \\times 10^{-6}$? Yes.\n-   Criterion B: $W_{\\mathrm{diss}} = 2.60 \\times 10^{2}\\,\\mathrm{Pa}$.\n    -   $U_e = \\frac{1}{2} (4.20 \\times 10^{7}\\,\\mathrm{Pa})(6.0 \\times 10^{-4}) = 1.26 \\times 10^{4}\\,\\mathrm{Pa}$.\n    -   Relative bound = $0.02 \\times (1.26 \\times 10^{4}\\,\\mathrm{Pa}) = 252\\,\\mathrm{Pa}$.\n    -   $W_{\\mathrm{bound}} = \\max(300\\,\\mathrm{Pa}, 252\\,\\mathrm{Pa}) = 300\\,\\mathrm{Pa}$.\n    -   Is $2.60 \\times 10^{2}\\,\\mathrm{Pa} \\le 300\\,\\mathrm{Pa}$? Yes.\n-   Result: Cycle 3 passes both criteria.\n\nCycle 4: $\\varepsilon_{\\max} = 8.0 \\times 10^{-4}$\n-   Criterion A: $\\varepsilon_{\\mathrm{res}} = 5.0 \\times 10^{-6}$. Is $5.0 \\times 10^{-6} \\le 9.0 \\times 10^{-6}$? Yes.\n-   Criterion B: $W_{\\mathrm{diss}} = 4.20 \\times 10^{2}\\,\\mathrm{Pa}$.\n    -   $U_e = \\frac{1}{2} (5.60 \\times 10^{7}\\,\\mathrm{Pa})(8.0 \\times 10^{-4}) = 2.24 \\times 10^{4}\\,\\mathrm{Pa}$.\n    -   Relative bound = $0.02 \\times (2.24 \\times 10^{4}\\,\\mathrm{Pa}) = 448\\,\\mathrm{Pa}$.\n    -   $W_{\\mathrm{bound}} = \\max(300\\,\\mathrm{Pa}, 448\\,\\mathrm{Pa}) = 448\\,\\mathrm{Pa}$.\n    -   Is $4.20 \\times 10^{2}\\,\\mathrm{Pa} \\le 448\\,\\mathrm{Pa}$? Yes.\n-   Result: Cycle 4 passes both criteria.\n\nCycle 5: $\\varepsilon_{\\max} = 1.0 \\times 10^{-3}$\n-   Criterion A: $\\varepsilon_{\\mathrm{res}} = 8.0 \\times 10^{-6}$. Is $8.0 \\times 10^{-6} \\le 9.0 \\times 10^{-6}$? Yes.\n-   Criterion B: $W_{\\mathrm{diss}} = 6.80 \\times 10^{2}\\,\\mathrm{Pa}$.\n    -   $U_e = \\frac{1}{2} (7.00 \\times 10^{7}\\,\\mathrm{Pa})(1.0 \\times 10^{-3}) = 3.50 \\times 10^{4}\\,\\mathrm{Pa}$.\n    -   Relative bound = $0.02 \\times (3.50 \\times 10^{4}\\,\\mathrm{Pa}) = 700\\,\\mathrm{Pa}$.\n    -   $W_{\\mathrm{bound}} = \\max(300\\,\\mathrm{Pa}, 700\\,\\mathrm{Pa}) = 700\\,\\mathrm{Pa}$.\n    -   Is $6.80 \\times 10^{2}\\,\\mathrm{Pa} \\le 700\\,\\mathrm{Pa}$? Yes.\n-   Result: Cycle 5 passes both criteria.\n\nCycle 6: $\\varepsilon_{\\max} = 1.2 \\times 10^{-3}$\n-   Criterion A: $\\varepsilon_{\\mathrm{res}} = 1.2 \\times 10^{-5} = 12.0 \\times 10^{-6}$. Is $12.0 \\times 10^{-6} \\le 9.0 \\times 10^{-6}$? No.\n-   Result: Cycle 6 fails. The material has exceeded its elastic limit as defined.\n\nSince the cycles are conducted with monotonically increasing peak strain, and the plastic effects ($\\varepsilon_{\\mathrm{res}}$ and $W_{\\mathrm{diss}}$) are also monotonically increasing, any cycle beyond Cycle 6 will also fail the criteria. We can confirm this for completeness. For example, for Cycle 7, $\\varepsilon_{\\mathrm{res}} = 2.0 \\times 10^{-5} > 9.0 \\times 10^{-6}$, so it also fails.\n\nThe elastic limit is defined as the largest peak strain $\\varepsilon_{\\max}$ for which the cycle remains within the defined elastic bounds. Cycles 1 through 5 satisfy the criteria. Cycle 6 is the first to fail. Therefore, the largest peak strain corresponding to elastic behavior is that of Cycle 5.\nThe elastic-limit peak strain is $\\varepsilon_{\\max} = 1.0 \\times 10^{-3}$.\nThe problem requires the answer to be rounded to four significant figures, which is $1.000 \\times 10^{-3}$.", "answer": "$$\n\\boxed{1.000 \\times 10^{-3}}\n$$", "id": "2633435"}, {"introduction": "This final practice advances into the realm of computational materials science, where you will design an algorithm to automatically detect the proportional limit from noisy data. By implementing a model selection procedure based on the Akaike Information Criterion (AIC), you will learn to statistically distinguish between a purely linear response and a piecewise-linear response with a distinct yield point. This hands-on coding task develops skills in modern, data-driven analysis, enabling robust and reproducible characterization of material behavior from experimental datasets [@problem_id:2633470].", "problem": "Design and implement a complete, runnable program that, given noisy uniaxial stress–strain datasets, infers the proportional limit by model selection between a single-segment linear elastic model and a two-segment continuous piecewise-linear model with a single break. The proportional limit is defined as the strain value at which the initial linear proportionality between stress and strain ceases to hold. Your solution must start from first principles and core definitions in solid mechanics and statistics, refrain from shortcut formulas, and produce results that are reproducible and testable.\n\nStart from the following physical and statistical bases:\n\n- In the initial elastic regime of a uniaxial test, Hooke’s law holds: for stress $\\sigma$ and strain $\\varepsilon$, $\\sigma = E \\,\\varepsilon$ with Young’s modulus $E$. The proportional limit is the maximal $\\varepsilon$ for which this relation remains a good description of the observed data.\n- Observed data are noisy realizations of an underlying deterministic relation: for observed pairs $\\{(\\varepsilon_i,\\sigma_i)\\}_{i=1}^N$ with strictly increasing strains $\\varepsilon_1 &lt; \\cdots &lt; \\varepsilon_N$, assume additive, independent, identically distributed Gaussian noise with zero mean and unknown variance $\\sigma_\\eta^2$.\n- Consider two candidate mean functions:\n  1. Single-segment model $\\mathcal{M}_1$: $\\mu(\\varepsilon;\\theta_1) = m\\,\\varepsilon$ with parameter $\\theta_1 = (m)$ and the physical constraint that the line passes through the origin.\n  2. Two-segment continuous model $\\mathcal{M}_2(j)$ indexed by a discrete break index $j \\in \\{1,\\dots,N-1\\}$ that enforces continuity at the break $\\varepsilon_j$ and a linear elastic first segment through the origin: for $i \\le j$, $\\mu(\\varepsilon_i;\\theta_2) = m_1\\,\\varepsilon_i$, and for $i &gt; j$, $\\mu(\\varepsilon_i;\\theta_2) = m_2\\,\\varepsilon_i + c_2$, with continuity $m_1 \\varepsilon_j = m_2 \\varepsilon_j + c_2$, which implies $c_2 = (m_1 - m_2)\\,\\varepsilon_j$. The parameter vector is $\\theta_2 = (m_1,m_2)$ for each $j$, while $c_2$ is determined by continuity.\n\nFor each model, define the residual sum of squares as $S = \\sum_{i=1}^N (\\sigma_i - \\mu(\\varepsilon_i;\\cdot))^2$ and adopt the Gaussian maximum likelihood with unknown variance. Use the Akaike Information Criterion (AIC) to select between all candidates, where\n$$\n\\mathrm{AIC} = N \\,\\ln\\!\\left(\\frac{S}{N}\\right) + 2k,\n$$\nand $k$ is the total number of free parameters. For $\\mathcal{M}_1$, take $k = 2$ (one mean parameter $m$ and one variance parameter). For $\\mathcal{M}_2(j)$, take $k = 4$ (two mean parameters $m_1,m_2$, one variance parameter, and one discrete break parameter $j$). Among the full candidate set $\\{\\mathcal{M}_1\\} \\cup \\{\\mathcal{M}_2(j): j \\in \\mathcal{J}\\}$, where $\\mathcal{J}$ restricts $j$ so that both segments contain at least $m_{\\min}$ data points, select the model with minimum AIC. To quantify statistical confidence, compute Akaike weights over the full candidate set,\n$$\nw_r = \\frac{\\exp\\!\\big(-\\tfrac{1}{2}\\Delta_r\\big)}{\\sum_{q} \\exp\\!\\big(-\\tfrac{1}{2}\\Delta_q\\big)},\\quad \\Delta_r = \\mathrm{AIC}_r - \\min_q \\mathrm{AIC}_q,\n$$\nand report the weight of the selected model.\n\nFor efficient evaluation of $\\mathcal{M}_2(j)$ without providing shortcuts, you must derive the closed-form least-squares estimators under the linear constraints for each candidate $j$ by solving the normal equations arising from minimizing the residual sum of squares with respect to $m_1$ and $m_2$. Use the definitions\n$$\nx_i = \\varepsilon_i,\\quad y_i = \\sigma_i,\\quad x_j = \\varepsilon_j,\\quad u_i = x_i - x_j\\ \\text{for}\\ i &gt; j,\n$$\nand the segment sums\n$$\nS^{(A)}_{xx} = \\sum_{i \\le j} x_i^2,\\quad S^{(A)}_{xy} = \\sum_{i \\le j} x_i y_i,\\quad n_B = N - j - 1,\n$$\n$$\nS^{(B)}_{u} = \\sum_{i&gt;j} u_i,\\quad S^{(B)}_{uu} = \\sum_{i&gt;j} u_i^2,\\quad S^{(B)}_{yu} = \\sum_{i&gt;j} y_i u_i,\\quad S^{(B)}_{y} = \\sum_{i&gt;j} y_i.\n$$\nThen minimize\n$$\nS(j;m_1,m_2) = \\sum_{i \\le j} (y_i - m_1 x_i)^2 + \\sum_{i&gt;j} \\big(y_i - m_2 x_i - (m_1 - m_2)x_j\\big)^2,\n$$\nby solving the linear system\n$$\n\\begin{bmatrix}\nS^{(A)}_{xx} + n_B x_j^2 & x_j S^{(B)}_{u} \\\\\nx_j S^{(B)}_{u} & S^{(B)}_{uu}\n\\end{bmatrix}\n\\begin{bmatrix}\nm_1 \\\\ m_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nS^{(A)}_{xy} + x_j S^{(B)}_{y} \\\\\nS^{(B)}_{yu}\n\\end{bmatrix},\n$$\nand set $c_2 = (m_1 - m_2)\\,x_j$. Compute $S(j) = S(j;m_1^\\star,m_2^\\star)$ at the optimizer.\n\nData generation for the test suite must follow physically realistic parameters and be reproducible. Generate synthetic datasets as follows, with stress in megapascal (MPa) and strain dimensionless, and enforce continuity of the underlying noiseless piecewise-linear constitutive curve. For each test case, generate a strictly increasing strain grid of $N$ points evenly spaced on $[0,\\varepsilon_{\\max}]$, compute the noiseless stress as\n$$\n\\sigma^\\star(\\varepsilon) = \\begin{cases}\nE\\,\\varepsilon, & \\varepsilon \\le \\varepsilon_b,\\\\\nE\\,\\varepsilon_b + \\alpha E\\,(\\varepsilon - \\varepsilon_b), & \\varepsilon &gt; \\varepsilon_b,\n\\end{cases}\n$$\nwith $E$ in MPa and $\\alpha \\in (0,1]$, and add independent Gaussian noise $\\eta \\sim \\mathcal{N}(0,\\sigma_\\eta^2)$ to obtain $\\sigma = \\sigma^\\star + \\eta$. Use the NumPy random number generator with the specified seed for each test case.\n\nImplement and run your algorithm on the following four test cases, using $m_{\\min} = 8$:\n\n- Case $1$: $N = 200$, $\\varepsilon_{\\max} = 0.01$, $E = 210{,}000\\,\\text{MPa}$, $\\varepsilon_b = 0.0012$, $\\alpha = 0.6$, $\\sigma_\\eta = 5\\,\\text{MPa}$, seed $= 42$.\n- Case $2$: $N = 150$, $\\varepsilon_{\\max} = 0.02$, $E = 70{,}000\\,\\text{MPa}$, $\\varepsilon_b = 0.018$, $\\alpha = 0.3$, $\\sigma_\\eta = 3\\,\\text{MPa}$, seed $= 7$.\n- Case $3$: $N = 160$, $\\varepsilon_{\\max} = 0.015$, $E = 110{,}000\\,\\text{MPa}$, no break (i.e., set $\\alpha = 1$ and ignore $\\varepsilon_b$), $\\sigma_\\eta = 4\\,\\text{MPa}$, seed $= 123$.\n- Case $4$: $N = 200$, $\\varepsilon_{\\max} = 0.012$, $E = 100{,}000\\,\\text{MPa}$, $\\varepsilon_b = 0.0008$, $\\alpha = 0.9$, $\\sigma_\\eta = 8\\,\\text{MPa}$, seed $= 99$.\n\nYour program must, for each case, evaluate $\\mathcal{M}_1$ and all admissible $\\mathcal{M}_2(j)$ with $j$ chosen so that both segments have at least $m_{\\min}$ data points, compute AIC for every candidate, compute Akaike weights over the entire candidate set, and select the model with minimal AIC. For the selected model, report:\n\n- the break index as an integer (use $-1$ if $\\mathcal{M}_1$ is selected),\n- the estimated break strain as a float in strain units (use $0$ if $\\mathcal{M}_1$ is selected),\n- the estimated Young’s modulus $E$ of the first segment as a float in $\\text{GPa}$, rounded to three decimals,\n- a model indicator integer ($0$ for $\\mathcal{M}_1$ and $1$ for $\\mathcal{M}_2$),\n- the Akaike weight of the selected model as a float rounded to three decimals.\n\nAngle units are not applicable. Physical units must be adhered to: stress in $\\text{MPa}$, strain dimensionless, and report $E$ in $\\text{GPa}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the order specified above. For example, a syntactically valid output would look like\n$[\\,[j_1,\\varepsilon_{b,1},E_{1,\\text{GPa}},m_1,w_1],\\,[j_2,\\varepsilon_{b,2},E_{2,\\text{GPa}},m_2,w_2],\\,[j_3,\\varepsilon_{b,3},E_{3,\\text{GPa}},m_3,w_3],\\,[j_4,\\varepsilon_{b,4},E_{4,\\text{GPa}},m_4,w_4]\\,]$,\nwith numeric entries provided according to the rounding rules above. Ensure that break strain values are printed with at least six decimal places.", "solution": "The problem requires the design and implementation of an algorithm to identify the proportional limit in noisy uniaxial stress-strain data. This is framed as a model selection problem, where we must choose between a single-segment linear model and a two-segment piecewise-linear model. The selection is based on the Akaike Information Criterion (AIC), a rigorous statistical tool for balancing model fit and complexity. The entire process, from data generation to final parameter estimation, must be grounded in first principles of solid mechanics and statistics.\n\nThe methodological approach is as follows:\nFirst, we define the mathematical and statistical description of the candidate models. Second, we derive the parameter estimators for each model by applying the principle of maximum likelihood, which, under the assumption of Gaussian noise, is equivalent to the method of least squares. Third, we formalize the model selection procedure using the Akaike Information Criterion (AIC) and define the Akaike weights to quantify confidence. Finally, we detail the algorithmic implementation for executing this procedure on the provided test cases.\n\n**1. Model Formulation and Statistical Framework**\n\nWe are given a set of $N$ noisy observations $\\{(\\varepsilon_i, \\sigma_i)\\}_{i=1}^N$, where $\\varepsilon_i$ is the strain and $\\sigma_i$ is the corresponding stress. The strains are strictly increasing, $\\varepsilon_1 < \\varepsilon_2 < \\dots < \\varepsilon_N$. We assume the data are generated from an underlying deterministic function $\\mu(\\varepsilon)$ with additive, independent, and identically distributed (i.i.d.) Gaussian noise, $\\eta_i \\sim \\mathcal{N}(0, \\sigma_\\eta^2)$. Thus, an observed stress is $\\sigma_i = \\mu(\\varepsilon_i) + \\eta_i$.\n\nWe consider two candidate models for the mean function $\\mu(\\varepsilon)$:\n\n**Model $\\mathcal{M}_1$: Single-Segment Linear Model**\nThis model represents a purely elastic material following Hooke's Law, constrained to pass through the origin $(\\varepsilon, \\sigma) = (0, 0)$.\n$$\n\\mathcal{M}_1: \\quad \\mu(\\varepsilon_i; m) = m\\,\\varepsilon_i\n$$\nThis model has one parameter for the mean function, the Young's modulus $m = E$.\n\n**Model $\\mathcal{M}_2(j)$: Two-Segment Piecewise-Linear Model**\nThis model describes a material with an elastic region followed by a region with a different, typically lower, stiffness. The model is defined by a breakpoint at index $j \\in \\{1, \\dots, N-1\\}$. The first segment passes through the origin, and continuity is enforced at the breakpoint $\\varepsilon_j$.\n$$\n\\mathcal{M}_2(j): \\quad \\mu(\\varepsilon_i; m_1, m_2) = \\begin{cases} m_1\\,\\varepsilon_i, & i \\le j \\\\ m_2\\,\\varepsilon_i + c_2, & i > j \\end{cases}\n$$\nThe continuity constraint at $\\varepsilon_j$ dictates that $m_1\\,\\varepsilon_j = m_2\\,\\varepsilon_j + c_2$, which determines the intercept of the second segment as $c_2 = (m_1 - m_2)\\,\\varepsilon_j$. This model has two parameters for the mean function, the two slopes $m_1$ and $m_2$. The breakpoint index $j$ is also a parameter to be determined.\n\n**2. Parameter Estimation by Least Squares**\n\nUnder the assumption of i.i.d. Gaussian noise, the maximum likelihood estimators for the model parameters are those that minimize the Residual Sum of Squares (RSS), defined as $S = \\sum_{i=1}^N (\\sigma_i - \\mu(\\varepsilon_i; \\boldsymbol{\\theta}))^2$, where $\\boldsymbol{\\theta}$ is the vector of model parameters.\n\n_For Model $\\mathcal{M}_1$_:\nThe RSS is $S_1(m) = \\sum_{i=1}^N (\\sigma_i - m\\,\\varepsilon_i)^2$. To find the optimal $m$, we set the derivative with respect to $m$ to zero:\n$$\n\\frac{dS_1}{dm} = -2 \\sum_{i=1}^N \\varepsilon_i (\\sigma_i - m\\,\\varepsilon_i) = 0\n$$\nThis yields the standard ordinary least squares (OLS) estimator for a line through the origin:\n$$\n\\hat{m} = \\frac{\\sum_{i=1}^N \\varepsilon_i \\sigma_i}{\\sum_{i=1}^N \\varepsilon_i^2}\n$$\nThe minimized RSS is then $S_1^\\star = \\sum_{i=1}^N (\\sigma_i - \\hat{m}\\,\\varepsilon_i)^2$.\n\n_For Model $\\mathcal{M}_2(j)$_:\nFor a fixed breakpoint index $j$, the RSS is a function of $m_1$ and $m_2$:\n$$\nS(j; m_1, m_2) = \\sum_{i=1}^j (\\sigma_i - m_1\\,\\varepsilon_i)^2 + \\sum_{i=j+1}^N \\big(\\sigma_i - m_2\\,\\varepsilon_i - (m_1 - m_2)\\varepsilon_j\\big)^2\n$$\nTo minimize this with respect to $m_1$ and $m_2$, we solve the system of normal equations $\\partial S / \\partial m_1 = 0$ and $\\partial S / \\partial m_2 = 0$. Using the notation provided in the problem statement ($x_i=\\varepsilon_i, y_i=\\sigma_i$, etc.), this leads to the following $2 \\times 2$ linear system for the estimators $(\\hat{m}_1, \\hat{m}_2)$:\n$$\n\\begin{bmatrix}\nS^{(A)}_{xx} + n_B x_j^2 & x_j S^{(B)}_{u} \\\\\nx_j S^{(B)}_{u} & S^{(B)}_{uu}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\hat{m}_1 \\\\ \\hat{m}_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nS^{(A)}_{xy} + x_j S^{(B)}_{y} \\\\\nS^{(B)}_{yu}\n\\end{bmatrix}\n$$\nThis system must be solved for each candidate breakpoint $j$ in the valid range $\\mathcal{J}$. The valid range is determined by the constraint that each segment must contain at least $m_{\\min}$ data points. For 0-based indexing from $0$ to $N-1$, this implies $j+1 \\ge m_{\\min}$ and $N-(j+1) \\ge m_{\\min}$, so $j \\in [m_{\\min}-1, N-m_{\\min}-1]$. After solving for $\\hat{m}_1(j)$ and $\\hat{m}_2(j)$, the corresponding minimized RSS, $S_2^\\star(j)$, is computed.\n\n**3. Model Selection and Confidence**\n\n**Akaike Information Criterion (AIC)**\nAIC provides a relative measure of model quality, penalizing for the number of estimated parameters to prevent overfitting. It is defined as:\n$$\n\\mathrm{AIC} = N \\ln\\left(\\frac{S^\\star}{N}\\right) + 2k\n$$\nwhere $S^\\star$ is the minimized RSS and $k$ is the total number of free parameters.\n- For $\\mathcal{M}_1$, we have one mean parameter ($m$) and one variance parameter ($\\sigma_\\eta^2$), so $k_1 = 2$.\n- For $\\mathcal{M}_2(j)$, we have two mean parameters ($m_1, m_2$), one breakpoint location parameter ($j$), and one variance parameter ($\\sigma_\\eta^2$), so $k_2 = 4$.\n\nThe model with the minimum AIC value across the set of all candidates, $\\{\\mathcal{M}_1\\} \\cup \\{\\mathcal{M}_2(j) : j \\in \\mathcal{J}\\}$, is selected as the best description of the data. If $\\mathcal{M}_1$ is selected, the proportional limit is not present in the data. If $\\mathcal{M}_2(j_{\\text{best}})$ is selected, the proportional limit is estimated as the break strain $\\varepsilon_{j_{\\text{best}}}$.\n\n**Akaike Weights**\nTo quantify the confidence in the selected model, we compute Akaike weights. The weight $w_r$ of a model $r$ is the probability that it is the best model in the set, given the data. It is calculated from the differences in AIC values, $\\Delta_r = \\mathrm{AIC}_r - \\min_q \\mathrm{AIC}_q$:\n$$\nw_r = \\frac{\\exp(-\\frac{1}{2}\\Delta_r)}{\\sum_{q} \\exp(-\\frac{1}{2}\\Delta_q)}\n$$\nThe sum is over all candidate models. We report the weight of the winning model.\n\n**4. Algorithmic Implementation**\n\nThe overall algorithm proceeds as follows for each test case:\n1.  **Data Generation**: A synthetic stress-strain dataset is generated according to the specified parameters ($N$, $\\varepsilon_{\\max}$, $E$, $\\varepsilon_b$, $\\alpha$, $\\sigma_\\eta$) and random seed.\n2.  **Model $\\mathcal{M}_1$ Evaluation**:\n    - Compute the estimator $\\hat{m}$ using the OLS formula.\n    - Calculate the RSS, $S_1^\\star$.\n    - Compute $\\mathrm{AIC}_1 = N \\ln(S_1^\\star/N) + 2k_1$.\n3.  **Model $\\mathcal{M}_2(j)$ Evaluation**:\n    - To optimize the loop over candidate breakpoints $j$, pre-compute the cumulative sums of $\\varepsilon_i$, $\\sigma_i$, $\\varepsilon_i^2$, and $\\varepsilon_i \\sigma_i$. This allows for $O(1)$ calculation of the segment sums required for the normal equations.\n    - Iterate through each valid index $j \\in [m_{\\min}-1, N-m_{\\min}-1]$.\n    - For each $j$, assemble and solve the $2 \\times 2$ linear system for $(\\hat{m}_1(j), \\hat{m}_2(j))$.\n    - Compute the corresponding RSS, $S_2^\\star(j)$.\n    - Compute $\\mathrm{AIC}_2(j) = N \\ln(S_2^\\star(j)/N) + 2k_2$.\n4.  **Model Selection and Reporting**:\n    - Collect all computed AIC values into a single list.\n    - Identify the minimum AIC and the corresponding model.\n    - Calculate the Akaike weights for all models based on their AIC differences.\n    - Extract and format the results for the best model: the break index $j$ (or $-1$ for $\\mathcal{M}_1$), the break strain $\\varepsilon_j$ (or $0$ for $\\mathcal{M}_1$), the first segment's modulus $E = \\hat{m}_1$ in GPa, a model indicator (0 or 1), and the Akaike weight of the selected model.\n\nThis structured, principle-based approach ensures that the estimation of the proportional limit is reproducible, statistically robust, and physically meaningful.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the proportional limit in noisy stress-strain data by model selection\n    between a single-segment and a two-segment piecewise-linear model using AIC.\n    \"\"\"\n    test_cases = [\n        # Case 1: N=200, eps_max=0.01, E=210000, eps_b=0.0012, alpha=0.6, sigma_eta=5, seed=42\n        (200, 0.01, 210000.0, 0.0012, 0.6, 5.0, 42),\n        # Case 2: N=150, eps_max=0.02, E=70000, eps_b=0.018, alpha=0.3, sigma_eta=3, seed=7\n        (150, 0.02, 70000.0, 0.018, 0.3, 3.0, 7),\n        # Case 3: N=160, eps_max=0.015, E=110000, no break (alpha=1), sigma_eta=4, seed=123\n        (160, 0.015, 110000.0, 0.0, 1.0, 4.0, 123),\n        # Case 4: N=200, eps_max=0.012, E=100000, eps_b=0.0008, alpha=0.9, sigma_eta=8, seed=99\n        (200, 0.012, 100000.0, 0.0008, 0.9, 8.0, 99)\n    ]\n\n    m_min = 8\n    all_results = []\n\n    for case_params in test_cases:\n        N, eps_max, E_mpa, eps_b, alpha, sigma_eta, seed = case_params\n        \n        # 1. Generate data\n        rng = np.random.default_rng(seed)\n        eps = np.linspace(0, eps_max, N, dtype=np.float64)\n        \n        if alpha == 1.0:\n            sigma_star = E_mpa * eps\n        else:\n            sigma_star = np.piecewise(eps,\n                                      [eps <= eps_b, eps > eps_b],\n                                      [lambda e: E_mpa * e,\n                                       lambda e: E_mpa * eps_b + alpha * E_mpa * (e - eps_b)])\n        \n        noise = rng.normal(0, sigma_eta, N)\n        sigma = sigma_star + noise\n\n        x = eps\n        y = sigma\n\n        aic_values = []\n        model_params = []\n\n        # 2. Evaluate Model M1 (single segment)\n        # OLS through the origin: m = sum(xy) / sum(x^2)\n        m_hat_1 = np.dot(x, y) / np.dot(x, x)\n        y_hat_1 = m_hat_1 * x\n        S1 = np.sum((y - y_hat_1)**2)\n        k1 = 2.0  # Parameters: m, sigma_eta^2\n        # Handle S1=0 case to avoid log(0)\n        if S1 <= 0:\n            S1 = np.finfo(float).eps\n        aic1 = N * np.log(S1 / N) + 2 * k1\n        \n        aic_values.append(aic1)\n        model_params.append({'j': -1, 'eps_b': 0.0, 'm1': m_hat_1, 'type': 0})\n\n        # 3. Evaluate Model M2(j) (two segments)\n        # Precompute cumulative sums for efficiency\n        cx = np.cumsum(x)\n        cy = np.cumsum(y)\n        cx2 = np.cumsum(x**2)\n        cxy = np.cumsum(x * y)\n        \n        total_x, total_y, total_x2, total_xy = cx[-1], cy[-1], cx2[-1], cxy[-1]\n\n        j_min = m_min - 1\n        j_max = N - m_min - 1\n        \n        for j in range(j_min, j_max + 1):\n            n_B = N - 1 - j\n            x_j = x[j]\n\n            # Segment A (0 to j)\n            S_A_xx = cx2[j]\n            S_A_xy = cxy[j]\n            \n            # Segment B (j+1 to N-1)\n            sum_x_B = total_x - cx[j]\n            sum_y_B = total_y - cy[j]\n            sum_x2_B = total_x2 - cx2[j]\n            sum_xy_B = total_xy - cxy[j]\n            \n            S_B_u = sum_x_B - n_B * x_j\n            S_B_uu = sum_x2_B - 2 * x_j * sum_x_B + n_B * x_j**2\n            S_B_y = sum_y_B\n            S_B_yu = sum_xy_B - x_j * sum_y_B\n            \n            # Assemble and solve the 2x2 system for (m1, m2)\n            a = S_A_xx + n_B * x_j**2\n            b = x_j * S_B_u\n            d = S_B_uu\n            \n            det = a * d - b * b\n            if abs(det) < 1e-15: continue # Skip if matrix is singular\n\n            f = S_A_xy + x_j * S_B_y\n            g = S_B_yu\n            \n            A_matrix = np.array([[a, b], [b, d]])\n            b_vector = np.array([f, g])\n            \n            try:\n                m1_hat, m2_hat = np.linalg.solve(A_matrix, b_vector)\n            except np.linalg.LinAlgError:\n                continue\n            \n            # Calculate RSS\n            y_hat_2 = np.zeros(N)\n            y_hat_2[:j+1] = m1_hat * x[:j+1]\n            c2 = (m1_hat - m2_hat) * x_j\n            y_hat_2[j+1:] = m2_hat * x[j+1:] + c2\n            \n            S2_j = np.sum((y - y_hat_2)**2)\n            k2 = 4.0 # Parameters: m1, m2, j, sigma_eta^2\n            if S2_j <= 0:\n                S2_j = np.finfo(float).eps\n            aic2_j = N * np.log(S2_j / N) + 2 * k2\n            \n            aic_values.append(aic2_j)\n            model_params.append({'j': j, 'eps_b': x[j], 'm1': m1_hat, 'type': 1})\n\n        # 4. Model Selection and Akaike Weights\n        aic_values = np.array(aic_values)\n        min_aic_val = np.min(aic_values)\n        best_model_idx = np.argmin(aic_values)\n        \n        delta_aic = aic_values - min_aic_val\n        exp_term = np.exp(-0.5 * delta_aic)\n        sum_exp_term = np.sum(exp_term)\n        best_model_weight = exp_term[best_model_idx] / sum_exp_term\n        \n        # 5. Format Output\n        best_model = model_params[best_model_idx]\n        \n        j_res = best_model['j']\n        eps_b_res = best_model['eps_b']\n        E_gpa_res = best_model['m1'] / 1000.0\n        model_type_res = best_model['type']\n        \n        all_results.append(\n            f\"[{j_res}, {eps_b_res:.8f}, {E_gpa_res:.3f}, {model_type_res}, {best_model_weight:.3f}]\"\n        )\n        \n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n\n```", "id": "2633470"}]}