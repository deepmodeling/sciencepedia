{"hands_on_practices": [{"introduction": "The power of the Extended Finite Element Method (XFEM) lies in its ability to enrich the standard polynomial approximation with functions that capture known solution features, such as discontinuities. This foundational practice [@problem_id:2637808] explores the core of this idea, known as the partition-of-unity method. By deriving the explicit mathematical form of Heaviside-enriched shape functions for a simple quadrilateral element, you will gain a tangible understanding of how a sharp displacement jump is incorporated into the continuous framework of FEM.", "problem": "Consider a single four-node bilinear quadrilateral finite element used in the extended finite element method (XFEM) for cracked bodies under small-strain linear elasticity. The element is axis-aligned with nodes ordered counterclockwise and located at $\\mathbf{x}_1=(0,0)$, $\\mathbf{x}_2=(2,0)$, $\\mathbf{x}_3=(2,2)$, and $\\mathbf{x}_4=(0,2)$. A straight crack cuts the element and is represented implicitly by a signed distance level-set function $\\phi(\\mathbf{x})=\\mathbf{n}\\cdot(\\mathbf{x}-\\mathbf{x}_0)$ with unit normal $\\mathbf{n}=(0,1)$ and point $\\mathbf{x}_0=(1,1)$ on the crack, so that $\\phi(\\mathbf{x})=y-1$. The Heaviside function $H(\\phi)$ used for strong-discontinuity enrichment is defined by $H(\\phi)=+1$ for $\\phi>0$, $H(\\phi)=-1$ for $\\phi<0$ (you may leave $H(0)$ undefined since evaluation points will not lie on the crack). The standard bilinear shape functions $N_i(\\xi,\\eta)$ are defined over the parent coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and the element is mapped affinely from the parent domain to the physical coordinates.\n\nStarting from the partition-of-unity concept and the definition of the Heaviside function as an indicator of the two crack faces, do the following:\n\n- Derive the explicit expressions of the bilinear shape functions $N_i(\\xi,\\eta)$ and the affine mapping between $(\\xi,\\eta)$ and $(x,y)$ for this rectangular element. Then, using the level-set representation, derive the enrichment functions $N_i(\\mathbf{x})\\,H(\\phi(\\mathbf{x}))$.\n\n- Using these results, evaluate the enriched shape functions at the physical point $\\mathbf{x}^{\\star}=(1.5,0.5)$ strictly inside the element. Express your final answer as the row matrix $\\bigl[N_1(\\mathbf{x}^{\\star})H(\\phi(\\mathbf{x}^{\\star})),\\;N_2(\\mathbf{x}^{\\star})H(\\phi(\\mathbf{x}^{\\star})),\\;N_3(\\mathbf{x}^{\\star})H(\\phi(\\mathbf{x}^{\\star})),\\;N_4(\\mathbf{x}^{\\star})H(\\phi(\\mathbf{x}^{\\star}))\\bigr]$.\n\n- Based on first principles (weak form of equilibrium, partition of unity, and the definition of the Heaviside function), reason about the continuity properties of the enriched displacement field within each subdomain $\\{\\phi>0\\}$ and $\\{\\phi<0\\}$ and across the crack $\\{\\phi=0\\}$ for the enrichment $N_i(\\mathbf{x})\\,H(\\phi(\\mathbf{x}))$. Comment on how the widely used shifted Heaviside enrichment $N_i(\\mathbf{x})\\bigl(H(\\phi(\\mathbf{x}))-H(\\phi(\\mathbf{x}_i))\\bigr)$ modifies nodal interpolation and continuity, without using any problem-specific numerical values.\n\nProvide the final answer as specified. No rounding is required and no units are involved in the final answer.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, objective, and complete. It describes a standard application of the extended finite element method (XFEM) for a cracked body. All required data are provided, and the questions are answerable within the established theoretical framework of solid mechanics and numerical methods. No flaws are identified. The solution proceeds.\n\nThe problem requires a three-part analysis concerning a $4$-node bilinear quadrilateral element transected by a straight crack.\n\nFirst, we derive the element shape functions and the geometric mapping. The standard bilinear shape functions $N_i(\\xi, \\eta)$ for a $4$-node element in the parent domain $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ are given by:\n$$ N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) $$\n$$ N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) $$\n$$ N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) $$\n$$ N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta) $$\nThe isoparametric mapping from parent coordinates $(\\xi, \\eta)$ to physical coordinates $\\mathbf{x}=(x,y)$ is defined by $\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{x}_i$. Using the given nodal coordinates $\\mathbf{x}_1=(0,0)$, $\\mathbf{x}_2=(2,0)$, $\\mathbf{x}_3=(2,2)$, and $\\mathbf{x}_4=(0,2)$, the mapping becomes:\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(2) = \\frac{1}{2}(1+\\xi)[(1-\\eta)+(1+\\eta)] = 1+\\xi $$\n$$ y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i = \\frac{1}{4}(1+\\xi)(1+\\eta)(2) + \\frac{1}{4}(1-\\xi)(1+\\eta)(2) = \\frac{1}{2}(1+\\eta)[(1+\\xi)+(1-\\xi)] = 1+\\eta $$\nThis is an affine mapping. The inverse mapping is readily obtained as $\\xi = x-1$ and $\\eta = y-1$.\nSubstituting this inverse mapping into the shape function definitions yields the shape functions in physical coordinates:\n$$ N_1(x, y) = \\frac{1}{4}(1-(x-1))(1-(y-1)) = \\frac{1}{4}(2-x)(2-y) $$\n$$ N_2(x, y) = \\frac{1}{4}(1+(x-1))(1-(y-1)) = \\frac{1}{4}x(2-y) $$\n$$ N_3(x, y) = \\frac{1}{4}(1+(x-1))(1+(y-1)) = \\frac{1}{4}xy $$\n$$ N_4(x, y) = \\frac{1}{4}(1-(x-1))(1+(y-1)) = \\frac{1}{4}(2-x)y $$\nThe crack is described by the level-set function $\\phi(\\mathbf{x}) = y-1$. The enrichment is based on the Heaviside function $H(\\phi)$, resulting in enrichment functions $N_i(\\mathbf{x}) H(\\phi(\\mathbf{x}))$.\n\nSecond, we evaluate these enriched shape functions at the specified point $\\mathbf{x}^{\\star}=(1.5, 0.5)$.\nFirst, evaluate the standard shape functions $N_i$ at $\\mathbf{x}^{\\star}$ where $x=1.5$ and $y=0.5$:\n$$ N_1(1.5, 0.5) = \\frac{1}{4}(2-1.5)(2-0.5) = \\frac{1}{4}(0.5)(1.5) = \\frac{0.75}{4} = \\frac{3}{16} $$\n$$ N_2(1.5, 0.5) = \\frac{1}{4}(1.5)(2-0.5) = \\frac{1}{4}(1.5)(1.5) = \\frac{2.25}{4} = \\frac{9}{16} $$\n$$ N_3(1.5, 0.5) = \\frac{1}{4}(1.5)(0.5) = \\frac{0.75}{4} = \\frac{3}{16} $$\n$$ N_4(1.5, 0.5) = \\frac{1}{4}(2-1.5)(0.5) = \\frac{1}{4}(0.5)(0.5) = \\frac{0.25}{4} = \\frac{1}{16} $$\nAs a consistency check, their sum is $\\frac{3+9+3+1}{16} = \\frac{16}{16} = 1$, which confirms the partition-of-unity property.\nNext, evaluate the level-set function at $\\mathbf{x}^{\\star}$:\n$$ \\phi(\\mathbf{x}^{\\star}) = y^{\\star} - 1 = 0.5 - 1 = -0.5 $$\nSince $\\phi(\\mathbf{x}^{\\star}) < 0$, the Heaviside function evaluates to $H(\\phi(\\mathbf{x}^{\\star})) = -1$.\nThe enriched shape functions at $\\mathbf{x}^{\\star}$ are therefore:\n$$ N_1(\\mathbf{x}^{\\star}) H(\\phi(\\mathbf{x}^{\\star})) = \\frac{3}{16} \\times (-1) = -\\frac{3}{16} $$\n$$ N_2(\\mathbf{x}^{\\star}) H(\\phi(\\mathbf{x}^{\\star})) = \\frac{9}{16} \\times (-1) = -\\frac{9}{16} $$\n$$ N_3(\\mathbf{x}^{\\star}) H(\\phi(\\mathbf{x}^{\\star})) = \\frac{3}{16} \\times (-1) = -\\frac{3}{16} $$\n$$ N_4(\\mathbf{x}^{\\star}) H(\\phi(\\mathbf{x}^{\\star})) = \\frac{1}{16} \\times (-1) = -\\frac{1}{16} $$\n\nThird, we discuss the continuity properties. The XFEM displacement approximation $\\mathbf{u}^h(\\mathbf{x})$ for a cracked body is:\n$$ \\mathbf{u}^h(\\mathbf{x}) = \\sum_{i \\in I} N_i(\\mathbf{x}) \\mathbf{u}_i + \\sum_{j \\in J} N_j(\\mathbf{x}) H(\\phi(\\mathbf{x})) \\mathbf{a}_j $$\nwhere $I$ is the set of all nodes, $J$ is the subset of nodes whose support is cut by the crack, $\\mathbf{u}_i$ are the standard nodal displacement degrees of freedom (DOFs), and $\\mathbf{a}_j$ are the enriched DOFs.\nWithin each subdomain, i.e., where $\\phi(\\mathbf{x})$ does not change sign, $H(\\phi(\\mathbf{x}))$ is a constant ($+1$ or $-1$).\nFor the subdomain $\\{\\mathbf{x} | \\phi(\\mathbf{x}) > 0\\}$, $\\mathbf{u}^h(\\mathbf{x}) = \\sum_{i} N_i(\\mathbf{x}) \\mathbf{u}_i + \\sum_{j} N_j(\\mathbf{x}) \\mathbf{a}_j = \\sum_{k} N_k(\\mathbf{x}) \\mathbf{c}_k^{+}$, where $\\mathbf{c}_k^{+}$ are combined DOFs. Since the shape functions $N_k(\\mathbf{x})$ are continuous ($C^0$) within the element, the displacement field $\\mathbf{u}^h(\\mathbf{x})$ is also continuous within this subdomain. The same logic applies to the subdomain $\\{\\mathbf{x} | \\phi(\\mathbf{x}) < 0\\}$.\nAcross the crack interface $\\{\\mathbf{x} | \\phi(\\mathbf{x}) = 0\\}$, the Heaviside function jumps from $-1$ to $+1$. The displacement jump $\\llbracket \\mathbf{u}^h \\rrbracket$ at a point $\\mathbf{x}_c$ on the crack is:\n$$ \\llbracket \\mathbf{u}^h \\rrbracket = \\lim_{\\epsilon \\to 0^+} (\\mathbf{u}^h(\\mathbf{x}_c+\\epsilon\\mathbf{n}) - \\mathbf{u}^h(\\mathbf{x}_c-\\epsilon\\mathbf{n})) $$\nThe standard part $\\sum N_i \\mathbf{u}_i$ is continuous. The jump is entirely due to the enriched part:\n$$ \\llbracket \\mathbf{u}^h \\rrbracket = \\sum_{j \\in J} N_j(\\mathbf{x}_c) \\mathbf{a}_j \\llbracket H(\\phi) \\rrbracket = \\sum_{j \\in J} N_j(\\mathbf{x}_c) \\mathbf{a}_j ((+1) - (-1)) = 2 \\sum_{j \\in J} N_j(\\mathbf{x}_c) \\mathbf{a}_j $$\nThis non-zero jump models the strong discontinuity (the crack opening/sliding).\n\nThe shifted Heaviside enrichment uses the function $N_i(\\mathbf{x}) \\left( H(\\phi(\\mathbf{x})) - H(\\phi(\\mathbf{x}_i)) \\right)$. The displacement approximation becomes:\n$$ \\mathbf{u}^h(\\mathbf{x}) = \\sum_{i \\in I} N_i(\\mathbf{x}) \\mathbf{u}_i + \\sum_{j \\in J} N_j(\\mathbf{x}) \\left( H(\\phi(\\mathbf{x})) - H(\\phi(\\mathbf{x}_j)) \\right) \\mathbf{a}_j $$\nThe term $H(\\phi(\\mathbf{x}_j))$ is a constant for each node $j$. The jump function $\\llbracket H(\\phi(\\mathbf{x})) - H(\\phi(\\mathbf{x}_j)) \\rrbracket = \\llbracket H(\\phi(\\mathbf{x})) \\rrbracket = 2$. Therefore, the displacement jump across the crack is identical to the unshifted case: $\\llbracket \\mathbf{u}^h \\rrbracket = 2 \\sum_{j \\in J} N_j(\\mathbf{x}_c) \\mathbf{a}_j$. The shifted function correctly introduces the strong discontinuity.\nThe key modification concerns nodal interpolation. Consider the value of the total displacement at a node $\\mathbf{x}_k$:\n$$ \\mathbf{u}^h(\\mathbf{x}_k) = \\sum_{i \\in I} N_i(\\mathbf{x}_k) \\mathbf{u}_i + \\sum_{j \\in J} N_j(\\mathbf{x}_k) \\left( H(\\phi(\\mathbf{x}_k)) - H(\\phi(\\mathbf{x}_j)) \\right) \\mathbf{a}_j $$\nBy the Kronecker delta property of shape functions, $N_i(\\mathbf{x}_k) = \\delta_{ik}$. The expression simplifies to:\n$$ \\mathbf{u}^h(\\mathbf{x}_k) = \\mathbf{u}_k + \\sum_{j \\in J} \\delta_{jk} \\left( H(\\phi(\\mathbf{x}_k)) - H(\\phi(\\mathbf{x}_j)) \\right) \\mathbf{a}_j = \\mathbf{u}_k + \\left( H(\\phi(\\mathbf{x}_k)) - H(\\phi(\\mathbf{x}_k)) \\right) \\mathbf{a}_k = \\mathbf{u}_k $$\nThus, with the shifted enrichment, the nodal DOF $\\mathbf{u}_k$ recovers its direct physical meaning as the total displacement at node $k$. In the unshifted formulation, $\\mathbf{u}^h(\\mathbf{x}_k) = \\mathbf{u}_k + H(\\phi(\\mathbf{x}_k))\\mathbf{a}_k$, obscuring the physical meaning of $\\mathbf{u}_k$. This restoration of the standard interpolation property is a significant advantage for applying essential boundary conditions.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{3}{16} & -\\frac{9}{16} & -\\frac{3}{16} & -\\frac{1}{16} \\end{pmatrix}}\n$$", "id": "2637808"}, {"introduction": "Once the principle of enrichment is understood, the next practical challenge is to algorithmically determine which parts of a finite element mesh require modification. This exercise [@problem_id:2637826] addresses this crucial step by using a dual level-set representation to describe a crack geometry. You will implement a set of precise, tolerance-aware logical rules to automatically classify elements and nodes, deciding whether they require Heaviside enrichment for the crack body or specialized tip functions for the crack front.", "problem": "You are given a two-level-set representation of a planar crack for use with the Extended Finite Element Method (XFEM). The representation uses two signed distance fields: a normal level set $\\phi(\\mathbf{x})$ to represent the crack surface and a tangential level set $\\psi(\\mathbf{x})$ to represent the crack-front (tip) coordinate. The crack set is defined by the following foundational definitions:\n- The actual crack faces (the interior, i.e., the broken material) are the set $\\{\\mathbf{x} \\mid \\phi(\\mathbf{x}) = 0, \\ \\psi(\\mathbf{x}) < 0\\}$.\n- The crack tip is the point set $\\{\\mathbf{x} \\mid \\phi(\\mathbf{x}) = 0, \\ \\psi(\\mathbf{x}) = 0\\}$.\n\nIn a nodal discretization, you are provided the nodal values $\\{\\phi_i\\}$ and $\\{\\psi_i\\}$ at the nodes $\\{i\\}$ of a mesh. For each element $e$ with node-index set $\\mathcal{N}(e)$, you must classify the element into exactly one of the following mutually exclusive categories based on the sign patterns of $\\{\\phi_i\\}_{i \\in \\mathcal{N}(e)}$ and $\\{\\psi_i\\}_{i \\in \\mathcal{N}(e)}$:\n- Standard element ($0$): No crack-related enrichment is required.\n- Cracked element ($1$): The actual crack passes through at least one vertex (node) of the element, but the element interior is not split by the crack and does not contain the tip.\n- Heaviside element ($2$): The actual crack faces split the element interior (discontinuous displacement across the crack faces), and the element does not contain the tip.\n- Tip element ($3$): The element contains the crack tip (requires near-tip asymptotic enrichment).\n\nUse the following robust, tolerance-aware logical criteria. Let the tolerance be $\\varepsilon = 10^{-7}$. Define the tolerance-aware sign function\n$$\n\\operatorname{sgn}_\\varepsilon(a) = \n\\begin{cases}\n-1, & a < -\\varepsilon,\\\\\n0, & |a| \\le \\varepsilon,\\\\\n+1, & a > \\varepsilon.\n\\end{cases}\n$$\nFor an element $e$, define the sets of tolerance-aware signs\n$$\nS_\\phi(e) = \\{\\operatorname{sgn}_\\varepsilon(\\phi_i) \\mid i \\in \\mathcal{N}(e)\\}, \\quad\nS_\\psi(e) = \\{\\operatorname{sgn}_\\varepsilon(\\psi_i) \\mid i \\in \\mathcal{N}(e)\\}.\n$$\nDefine the boolean predicates\n- $\\text{has\\_sign\\_change}(S) \\equiv (\\min S = -1) \\wedge (\\max S = +1)$,\n- $\\text{all\\_behind\\_tip}(e) \\equiv \\max\\{\\psi_i \\mid i \\in \\mathcal{N}(e)\\} < -\\varepsilon$.\n\nThen classify elements using:\n1. Tip element ($3$) if and only if $\\text{has\\_sign\\_change}(S_\\phi(e))$ and $\\text{has\\_sign\\_change}(S_\\psi(e))$.\n2. Heaviside element ($2$) if and only if $\\text{has\\_sign\\_change}(S_\\phi(e))$ and $\\text{all\\_behind\\_tip}(e)$ and the element is not a tip element.\n3. Cracked element ($1$) if and only if the element is neither a tip nor a Heaviside element and there exists some node $j \\in \\mathcal{N}(e)$ satisfying $|\\phi_j| \\le \\varepsilon$ and $\\psi_j < -\\varepsilon$.\n4. Standard element ($0$) otherwise.\n\nNext, classify each node $i$ into exactly one of the following mutually exclusive categories based on its membership in enriched elements and its own level-set values:\n- Standard node ($0$).\n- Cracked node ($1$).\n- Heaviside node ($2$).\n- Tip node ($3$).\n\nUse the following precedence-ordered rules for nodes, with the same tolerance $\\varepsilon$:\n1. Tip node ($3$): Node $i$ belongs to at least one tip element.\n2. Cracked node ($1$): $|\\phi_i| \\le \\varepsilon$ and $\\psi_i < -\\varepsilon$.\n3. Heaviside node ($2$): Node $i$ belongs to at least one Heaviside element.\n4. Standard node ($0$): None of the above conditions apply.\n\nImplement these rules in a program and apply them to the following test suite. The mesh is defined by node-level-set values and element connectivities. All numbers are in dimensionless units.\n\nTest suite:\n- Tolerance: $\\varepsilon = 10^{-7}$.\n- Nodes indexed by $i \\in \\{0,1,\\dots,11\\}$ with pairs $(\\phi_i,\\psi_i)$:\n  - $i=0$: $(+0.3,\\ -0.5)$\n  - $i=1$: $(-0.4,\\ -0.6)$\n  - $i=2$: $(+0.2,\\ -0.1)$\n  - $i=3$: $(-0.1,\\ -0.2)$\n  - $i=4$: $(0.0,\\ -0.3)$\n  - $i=5$: $(+0.2,\\ +0.1)$\n  - $i=6$: $(-0.2,\\ +0.2)$\n  - $i=7$: $(+0.05,\\ -0.05)$\n  - $i=8$: $(+0.3,\\ +0.4)$\n  - $i=9$: $(-0.3,\\ +0.3)$\n  - $i=10$: $(+10^{-8},\\ -0.4)$\n  - $i=11$: $(0.0,\\ 0.0)$\n- Elements $e \\in \\{0,1,2,3,4,5\\}$ with node-index sets $\\mathcal{N}(e)$:\n  - $e=0$: $\\{0,1,2\\}$\n  - $e=1$: $\\{2,5,6\\}$\n  - $e=2$: $\\{2,4,5\\}$\n  - $e=3$: $\\{5,8,9\\}$\n  - $e=4$: $\\{0,2,7\\}$\n  - $e=5$: $\\{2,6,11\\}$\n\nYour program must:\n- Implement the above logical criteria precisely, using the specified tolerance $\\varepsilon$.\n- Produce two integer lists:\n  - The first list contains the element classifications in index order $e=0$ to $e=5$, using the integer codes $0$ (standard), $1$ (cracked), $2$ (Heaviside), $3$ (tip).\n  - The second list contains the node classifications in index order $i=0$ to $i=11$, using the same integer code mapping.\n\nFinal output format:\n- Your program should produce a single line of output containing the two lists as a single comma-separated list enclosed in square brackets, i.e., the exact format is $[[a_0,a_1,\\dots,a_5],[b_0,b_1,\\dots,b_{11}]]$ with no spaces.\n- Each $a_e$ and $b_i$ must be an integer.\n\nNo user input should be read. The program must be self-contained and run deterministically.", "solution": "The problem presented is a well-posed and scientifically grounded exercise in computational mechanics, specifically concerning the classification of finite elements and their nodes for crack analysis using the Extended Finite Element Method (XFEM). All definitions, rules, and data are provided, allowing for a deterministic and verifiable solution. The problem is valid.\n\nThe solution process is divided into two main stages: first, the classification of each element, and second, the classification of each node according to the specified logical criteria.\n\nThe fundamental parameters are the tolerance $\\varepsilon = 10^{-7}$ and the nodal level-set values $(\\phi_i, \\psi_i)$.\n\nFirst, we establish the tolerance-aware sign for each nodal level-set value using the function:\n$$\n\\operatorname{sgn}_\\varepsilon(a) = \n\\begin{cases}\n-1, & a < -\\varepsilon \\\\\n0, & |a| \\le \\varepsilon \\\\\n+1, & a > \\varepsilon\n\\end{cases}\n$$\nThe signs for all $12$ nodes are pre-calculated:\n- Node $0: (\\phi_0, \\psi_0) = (+0.3, -0.5) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_0), \\operatorname{sgn}_\\varepsilon(\\psi_0)) = (+1, -1)$\n- Node $1: (\\phi_1, \\psi_1) = (-0.4, -0.6) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_1), \\operatorname{sgn}_\\varepsilon(\\psi_1)) = (-1, -1)$\n- Node $2: (\\phi_2, \\psi_2) = (+0.2, -0.1) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_2), \\operatorname{sgn}_\\varepsilon(\\psi_2)) = (+1, -1)$\n- Node $3: (\\phi_3, \\psi_3) = (-0.1, -0.2) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_3), \\operatorname{sgn}_\\varepsilon(\\psi_3)) = (-1, -1)$\n- Node $4: (\\phi_4, \\psi_4) = (0.0, -0.3) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_4), \\operatorname{sgn}_\\varepsilon(\\psi_4)) = (0, -1)$\n- Node $5: (\\phi_5, \\psi_5) = (+0.2, +0.1) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_5), \\operatorname{sgn}_\\varepsilon(\\psi_5)) = (+1, +1)$\n- Node $6: (\\phi_6, \\psi_6) = (-0.2, +0.2) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_6), \\operatorname{sgn}_\\varepsilon(\\psi_6)) = (-1, +1)$\n- Node $7: (\\phi_7, \\psi_7) = (+0.05, -0.05) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_7), \\operatorname{sgn}_\\varepsilon(\\psi_7)) = (+1, -1)$\n- Node $8: (\\phi_8, \\psi_8) = (+0.3, +0.4) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_8), \\operatorname{sgn}_\\varepsilon(\\psi_8)) = (+1, +1)$\n- Node $9: (\\phi_9, \\psi_9) = (-0.3, +0.3) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_9), \\operatorname{sgn}_\\varepsilon(\\psi_9)) = (-1, +1)$\n- Node $10: (\\phi_{10}, \\psi_{10}) = (+10^{-8}, -0.4) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_{10}), \\operatorname{sgn}_\\varepsilon(\\psi_{10})) = (0, -1)$\n- Node $11: (\\phi_{11}, \\psi_{11}) = (0.0, 0.0) \\implies (\\operatorname{sgn}_\\varepsilon(\\phi_{11}), \\operatorname{sgn}_\\varepsilon(\\psi_{11})) = (0, 0)$\n\n**Stage 1: Element Classification**\n\nWe analyze each element $e \\in \\{0, \\dots, 5\\}$ using the defined rules, which are mutually exclusive due to their structure.\n\n- **Element $e=0, \\mathcal{N}(0)=\\{0, 1, 2\\}$**:\n  - $S_\\phi(0)=\\{\\operatorname{sgn}_\\varepsilon(\\phi_0), \\operatorname{sgn}_\\varepsilon(\\phi_1), \\operatorname{sgn}_\\varepsilon(\\phi_2)\\} = \\{+1, -1, +1\\}$.\n  - $S_\\psi(0)=\\{\\operatorname{sgn}_\\varepsilon(\\psi_0), \\operatorname{sgn}_\\varepsilon(\\psi_1), \\operatorname{sgn}_\\varepsilon(\\psi_2)\\} = \\{-1, -1, -1\\}$.\n  - $\\text{has\\_sign\\_change}(S_\\phi(0))$ is true. $\\text{has\\_sign\\_change}(S_\\psi(0))$ is false. Thus, not a Tip element.\n  - $\\text{all\\_behind\\_tip}(0)$ is true since $\\max\\{\\psi_0, \\psi_1, \\psi_2\\} = -0.1 < -\\varepsilon$.\n  - Rule 2 applies: $\\text{has\\_sign\\_change}(S_\\phi)$ is true and $\\text{all\\_behind\\_tip}(e)$ is true.\n  - Classification: **Heaviside element (2)**.\n\n- **Element $e=1, \\mathcal{N}(1)=\\{2, 5, 6\\}$**:\n  - $S_\\phi(1)=\\{\\operatorname{sgn}_\\varepsilon(\\phi_2), \\operatorname{sgn}_\\varepsilon(\\phi_5), \\operatorname{sgn}_\\varepsilon(\\phi_6)\\} = \\{+1, +1, -1\\}$.\n  - $S_\\psi(1)=\\{\\operatorname{sgn}_\\varepsilon(\\psi_2), \\operatorname{sgn}_\\varepsilon(\\psi_5), \\operatorname{sgn}_\\varepsilon(\\psi_6)\\} = \\{-1, +1, +1\\}$.\n  - $\\text{has\\_sign\\_change}(S_\\phi(1))$ is true. $\\text{has\\_sign\\_change}(S_\\psi(1))$ is true.\n  - Rule 1 applies.\n  - Classification: **Tip element (3)**.\n\n- **Element $e=2, \\mathcal{N}(2)=\\{2, 4, 5\\}$**:\n  - $S_\\phi(2)=\\{\\operatorname{sgn}_\\varepsilon(\\phi_2), \\operatorname{sgn}_\\varepsilon(\\phi_4), \\operatorname{sgn}_\\varepsilon(\\phi_5)\\} = \\{+1, 0, +1\\}$.\n  - $S_\\psi(2)=\\{\\operatorname{sgn}_\\varepsilon(\\psi_2), \\operatorname{sgn}_\\varepsilon(\\psi_4), \\operatorname{sgn}_\\varepsilon(\\psi_5)\\} = \\{-1, -1, +1\\}$.\n  - $\\text{has\\_sign\\_change}(S_\\phi(2))$ is false. Not a Tip or Heaviside element.\n  - Rule 3 check: For node $j=4$, $|\\phi_4|=0.0 \\le \\varepsilon$ and $\\psi_4=-0.3 < -\\varepsilon$. The condition is satisfied.\n  - Classification: **Cracked element (1)**.\n\n- **Element $e=3, \\mathcal{N}(3)=\\{5, 8, 9\\}$**:\n  - $S_\\phi(3)=\\{\\operatorname{sgn}_\\varepsilon(\\phi_5), \\operatorname{sgn}_\\varepsilon(\\phi_8), \\operatorname{sgn}_\\varepsilon(\\phi_9)\\} = \\{+1, +1, -1\\}$.\n  - $S_\\psi(3)=\\{\\operatorname{sgn}_\\varepsilon(\\psi_5), \\operatorname{sgn}_\\varepsilon(\\psi_8), \\operatorname{sgn}_\\varepsilon(\\psi_9)\\} = \\{+1, +1, +1\\}$.\n  - $\\text{has\\_sign\\_change}(S_\\phi(3))$ is true, but $\\text{has\\_sign\\_change}(S_\\psi(3))$ is false. Not a Tip element.\n  - $\\text{all\\_behind\\_tip}(3)$ is false since $\\max\\{\\psi_5, \\psi_8, \\psi_9\\} = 0.4 > -\\varepsilon$. Not a Heaviside element.\n  - Rule 3 check: No node $j \\in \\{5, 8, 9\\}$ has $|\\phi_j| \\le \\varepsilon$. Not a Cracked element.\n  - Rule 4 applies.\n  - Classification: **Standard element (0)**.\n\n- **Element $e=4, \\mathcal{N}(4)=\\{0, 2, 7\\}$**:\n  - $S_\\phi(4)=\\{\\operatorname{sgn}_\\varepsilon(\\phi_0), \\operatorname{sgn}_\\varepsilon(\\phi_2), \\operatorname{sgn}_\\varepsilon(\\phi_7)\\} = \\{+1, +1, +1\\}$.\n  - $S_\\psi(4)=\\{\\operatorname{sgn}_\\varepsilon(\\psi_0), \\operatorname{sgn}_\\varepsilon(\\psi_2), \\operatorname{sgn}_\\varepsilon(\\psi_7)\\} = \\{-1, -1, -1\\}$.\n  - $\\text{has\\_sign\\_change}(S_\\phi(4))$ is false. Not a Tip or Heaviside element.\n  - Rule 3 check: No node $j \\in \\{0, 2, 7\\}$ has $|\\phi_j| \\le \\varepsilon$. Not a Cracked element.\n  - Rule 4 applies.\n  - Classification: **Standard element (0)**.\n\n- **Element $e=5, \\mathcal{N}(5)=\\{2, 6, 11\\}$**:\n  - $S_\\phi(5)=\\{\\operatorname{sgn}_\\varepsilon(\\phi_2), \\operatorname{sgn}_\\varepsilon(\\phi_6), \\operatorname{sgn}_\\varepsilon(\\phi_{11})\\} = \\{+1, -1, 0\\}$.\n  - $S_\\psi(5)=\\{\\operatorname{sgn}_\\varepsilon(\\psi_2), \\operatorname{sgn}_\\varepsilon(\\psi_6), \\operatorname{sgn}_\\varepsilon(\\psi_{11})\\} = \\{-1, +1, 0\\}$.\n  - $\\text{has\\_sign\\_change}(S_\\phi(5))$ is true. $\\text{has\\_sign\\_change}(S_\\psi(5))$ is true.\n  - Rule 1 applies.\n  - Classification: **Tip element (3)**.\n\nThe resulting element classification list is $[2, 3, 1, 0, 0, 3]$.\n\n**Stage 2: Node Classification**\n\nWe classify each node $i \\in \\{0, \\dots, 11\\}$ based on the precedence-ordered rules. A map of node-to-element-membership is constructed first to facilitate this.\n- Tip elements are $\\{1, 5\\}$.\n- Heaviside elements are $\\{0\\}$.\n\n- **Node 0**: In elements $\\{0, 4\\}$. Rule 1 (Tip): No. Rule 2 (Cracked, $|\\phi_0| \\le \\varepsilon \\land \\psi_0 < -\\varepsilon $): No ($|\\phi_0|=0.3$). Rule 3 (Heaviside): Yes, in element $0$. Classification: **Heaviside (2)**.\n- **Node 1**: In element $\\{0\\}$. Rule 1 (Tip): No. Rule 2 (Cracked): No ($|\\phi_1|=0.4$). Rule 3 (Heaviside): Yes, in element $0$. Classification: **Heaviside (2)**.\n- **Node 2**: In elements $\\{0, 1, 2, 4, 5\\}$. Rule 1 (Tip): Yes, in elements $1$ and $5$. Classification: **Tip (3)**.\n- **Node 3**: In no elements. Rule 1: No. Rule 2: No ($|\\phi_3|=0.1$). Rule 3: No. Rule 4: Yes. Classification: **Standard (0)**.\n- **Node 4**: In element $\\{2\\}$. Rule 1: No. Rule 2: Yes ($|\\phi_4|=0.0 \\le \\varepsilon$ and $\\psi_4=-0.3 < -\\varepsilon$). Classification: **Cracked (1)**.\n- **Node 5**: In elements $\\{1, 2, 3\\}$. Rule 1: Yes, in element $1$. Classification: **Tip (3)**.\n- **Node 6**: In elements $\\{1, 5\\}$. Rule 1: Yes, in elements $1$ and $5$. Classification: **Tip (3)**.\n- **Node 7**: In element $\\{4\\}$. Rule 1: No. Rule 2: No ($|\\phi_7|=0.05$). Rule 3: No. Rule 4: Yes. Classification: **Standard (0)**.\n- **Node 8**: In element $\\{3\\}$. Rule 1: No. Rule 2: No ($|\\phi_8|=0.3$). Rule 3: No. Rule 4: Yes. Classification: **Standard (0)**.\n- **Node 9**: In element $\\{3\\}$. Rule 1: No. Rule 2: No ($|\\phi_9|=0.3$). Rule 3: No. Rule 4: Yes. Classification: **Standard (0)**.\n- **Node 10**: In no elements. Rule 1: No. Rule 2: Yes ($|\\phi_{10}|=10^{-8} \\le \\varepsilon$ and $\\psi_{10}=-0.4 < -\\varepsilon$). Classification: **Cracked (1)**.\n- **Node 11**: In element $\\{5\\}$. Rule 1: Yes, in element $5$. Classification: **Tip (3)**.\n\nThe resulting node classification list is $[2, 2, 3, 0, 1, 3, 3, 0, 0, 0, 1, 3]$.", "answer": "[[2,3,1,0,0,3],[2,2,3,0,1,3,3,0,0,0,1,3]]", "id": "2637826"}, {"introduction": "The ultimate goal of enriching the displacement field is to solve the governing equations of equilibrium, which in FEM boils down to assembling and solving a linear system. This practice [@problem_id:2637785] delves into the computational heart of XFEM by showing how enrichment modifies the element stiffness matrix. Starting from the principle of virtual work, you will derive the new strain-displacement relations and calculate a specific stiffness term that couples the standard and enriched degrees of freedom, revealing the direct impact of the enrichment on the system equations.", "problem": "A two-dimensional, homogeneous, isotropic, linear elastic solid in plane strain is discretized using a four-node bilinear quadrilateral element of side length $a$ and unit thickness $t=1$. The element is aligned with the global axes and occupies the square $[0,a]\\times[0,a]$. The material has Young’s modulus $E$ and Poisson’s ratio $\\nu$. The element is cut by a traction-free straight crack such that a fraction $f_{-}$ of the element area lies on the negative side and the remaining fraction $f_{+}=1-f_{-}$ lies on the positive side of the crack, where the Heaviside enrichment function $H(\\boldsymbol{x})$ equals $-1$ and $+1$, respectively. The Heaviside value at node $1$ is $H_{1}=+1$ (node $1$ lies on the positive side).\n\nThe displacement approximation with the Extended Finite Element Method (XFEM) uses the partition of unity with a Heaviside enrichment. With standard nodal displacements $\\{\\boldsymbol{u}_{i}\\}$ and enrichment degrees of freedom (DOFs) $\\{\\boldsymbol{a}_{j}\\}$, the enriched displacement field is\n$$\n\\boldsymbol{u}(\\boldsymbol{x})=\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\,\\boldsymbol{u}_{i}+\\sum_{j\\in\\mathcal{J}} N_{j}(\\boldsymbol{x})\\big(H(\\boldsymbol{x})-H_{j}\\big)\\,\\boldsymbol{a}_{j},\n$$\nwhere $\\mathcal{J}$ is the set of Heaviside-enriched nodes and $N_{i}$ are the bilinear shape functions. The small-strain tensor satisfies\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{x})=\\mathcal{L}\\,\\boldsymbol{u}(\\boldsymbol{x}),\n$$\nwith the differential operator $\\mathcal{L}$ that maps displacement to strain in the usual way for plane strain. The constitutive relation is $\\boldsymbol{\\sigma}=\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}$ with $\\boldsymbol{D}$ the plane strain elasticity matrix. Ignoring the distributional gradient of $H(\\boldsymbol{x})$ (which is supported only on the crack line and does not contribute to the domain stiffness of a traction-free crack), the element is integrated as the union of two disjoint subdomains where $H(\\boldsymbol{x})$ is constant.\n\nTasks:\n1. Starting from the weak form of linear elasticity, state the element stiffness contribution that couples standard and enriched DOFs in terms of the strain-displacement matrices, and write the strain-displacement matrices $\\boldsymbol{B}_{i}^{\\mathrm{std}}$ and $\\boldsymbol{B}_{i}^{H}$ for node $i$ on a subdomain where $H(\\boldsymbol{x})$ is constant. Clearly identify how the Heaviside enrichment modifies the strain-displacement relation on each subdomain.\n2. Consider a single Heaviside-enriched node, $i=1$, and compute the scalar entry of the element stiffness matrix that couples the standard $x$-DOF of node $1$ to the enriched $x$-DOF of node $1$, denoted by $K_{(1x),(1a_{x})}^{(e)}$. Use one-point quadrature on each subdomain, with the strain-displacement matrices evaluated at the element centroid. The element side length is $a=10\\,\\mathrm{mm}$, Young's modulus is $E=210\\times 10^{3}\\,\\mathrm{N/mm^2}$, Poisson's ratio is $\\nu=0.30$, the area fraction is $f_{-}=0.40$, and thickness is $t=1\\,\\mathrm{mm}$. Express your final answer in $\\mathrm{N/mm}$ and round your answer to four significant figures.\n\nUseful data for centroidal gradients of bilinear shape functions on a square of side $a$: at the centroid, the derivatives for node $1$ are\n$$\n\\frac{\\partial N_{1}}{\\partial x}=-\\frac{1}{2a},\\qquad \\frac{\\partial N_{1}}{\\partial y}=-\\frac{1}{2a}.\n$$", "solution": "The problem requires an analysis of the stiffness matrix for a quadrilateral element enriched with a Heaviside function in the context of the Extended Finite Element Method (XFEM). First, the problem is validated for correctness, and as it is found to be valid, a solution is derived.\n\nThe problem statement poses two tasks. The first is conceptual, requiring the derivation of the coupling stiffness term and the identification of the strain-displacement matrices. The second is a specific calculation of a stiffness matrix component.\n\nFor the first task, we begin with the principle of virtual work. The internal virtual work for an element is given by\n$$ \\delta W_{\\text{int}}^{(e)} = \\int_{\\Omega^{(e)}} \\delta\\boldsymbol{\\varepsilon}^{T} \\boldsymbol{\\sigma} \\, d\\Omega $$\nwhere $\\boldsymbol{\\sigma}$ is the stress tensor, $\\delta\\boldsymbol{\\varepsilon}$ is the virtual strain tensor, and $\\Omega^{(e)}$ is the element domain. Using the linear elastic constitutive relation $\\boldsymbol{\\sigma} = \\boldsymbol{D} \\boldsymbol{\\varepsilon}$, this becomes\n$$ \\delta W_{\\text{int}}^{(e)} = \\int_{\\Omega^{(e)}} \\delta\\boldsymbol{\\varepsilon}^{T} \\boldsymbol{D} \\boldsymbol{\\varepsilon} \\, d\\Omega $$\nThe displacement field $\\boldsymbol{u}(\\boldsymbol{x})$ and the virtual displacement field $\\delta\\boldsymbol{u}(\\boldsymbol{x})$ are approximated using the XFEM partition of unity framework:\n$$ \\boldsymbol{u}(\\boldsymbol{x})=\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\,\\boldsymbol{u}_{i}+\\sum_{j\\in\\mathcal{J}} N_{j}(\\boldsymbol{x})\\big(H(\\boldsymbol{x})-H_{j}\\big)\\,\\boldsymbol{a}_{j} $$\n$$ \\delta\\boldsymbol{u}(\\boldsymbol{x})=\\sum_{i=1}^{4} N_{i}(\\boldsymbol{x})\\,\\delta\\boldsymbol{u}_{i}+\\sum_{j\\in\\mathcal{J}} N_{j}(\\boldsymbol{x})\\big(H(\\boldsymbol{x})-H_{j}\\big)\\,\\delta\\boldsymbol{a}_{j} $$\nHere, $\\boldsymbol{u}_i$ are standard nodal displacements and $\\boldsymbol{a}_j$ are enriched degrees of freedom (DOFs) for the set of enriched nodes $\\mathcal{J}$. The strain field $\\boldsymbol{\\varepsilon} = \\mathcal{L}\\boldsymbol{u}$ is obtained by applying the symmetric gradient operator $\\mathcal{L}$. Crucially, the problem states to ignore the distributional part of the gradient of $H(\\boldsymbol{x})$, which is a standard procedure for traction-free cracks. Therefore, $\\nabla(N_j(H-H_j)) \\approx (\\nabla N_j)(H-H_j)$. This leads to the strain field:\n$$ \\boldsymbol{\\varepsilon}(\\boldsymbol{x}) \\approx \\sum_{i=1}^{4} (\\mathcal{L}N_i) \\boldsymbol{u}_i + \\sum_{j\\in\\mathcal{J}} (H(\\boldsymbol{x})-H_j) (\\mathcal{L}N_j) \\boldsymbol{a}_j $$\nThis can be written in matrix form as:\n$$ \\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\sum_{i=1}^{4} \\boldsymbol{B}_{i}^{\\mathrm{std}} \\boldsymbol{u}_i + \\sum_{j\\in\\mathcal{J}} (H(\\boldsymbol{x})-H_j) \\boldsymbol{B}_{j}^{\\mathrm{std}} \\boldsymbol{a}_j $$\nwhere $\\boldsymbol{B}_{i}^{\\mathrm{std}}$ is the standard strain-displacement matrix for node $i$:\n$$ \\boldsymbol{B}_{i}^{\\mathrm{std}}(\\boldsymbol{x}) = \\begin{pmatrix} \\frac{\\partial N_{i}}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_{i}}{\\partial y} \\\\ \\frac{\\partial N_{i}}{\\partial y} & \\frac{\\partial N_{i}}{\\partial x} \\end{pmatrix} $$\nThe contribution to strain from enriched DOFs at node $j$ is given by $\\boldsymbol{B}_{j}^{H}\\boldsymbol{a}_j$. From the strain expression above, we identify the enriched strain-displacement matrix on any subdomain where $H(\\boldsymbol{x})$ is constant as:\n$$ \\boldsymbol{B}_{j}^{H}(\\boldsymbol{x}) = \\big(H(\\boldsymbol{x}) - H_j\\big) \\boldsymbol{B}_{j}^{\\mathrm{std}}(\\boldsymbol{x}) $$\nThe Heaviside enrichment modifies the strain-displacement relation by scaling the standard $\\boldsymbol{B}$-matrix with the factor $(H(\\boldsymbol{x}) - H_j)$, which is piecewise constant.\n\nSubstituting the discretized strain and virtual strain into the internal work expression yields the element stiffness matrix. The coupling submatrix between the standard DOFs of node $i$ ($\\boldsymbol{u}_i$) and the enriched DOFs of node $j$ ($\\boldsymbol{a}_j$) is derived from the cross-term in the virtual work expression: $\\int_{\\Omega^{(e)}} (\\delta\\boldsymbol{\\varepsilon}^{\\text{std},i})^T \\boldsymbol{D} \\boldsymbol{\\varepsilon}^{\\text{enr},j} \\, d \\Omega$. This gives the requested stiffness contribution:\n$$ \\boldsymbol{K}_{ij}^{\\mathrm{std}-H} = \\int_{\\Omega^{(e)}} (\\boldsymbol{B}_{i}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{j}^{H} \\, t \\, dA = \\int_{\\Omega^{(e)}} \\big(H(\\boldsymbol{x}) - H_j\\big) (\\boldsymbol{B}_{i}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{j}^{\\mathrm{std}} \\, t \\, dA $$\nThis completes the first task.\n\nFor the second task, we must compute the specific stiffness entry $K_{(1x),(1a_{x})}^{(e)}$, which couples the standard $x$-DOF of node $1$ to the enriched $x$-DOF of node $1$. The relevant nodes are thus $i=j=1$. The stiffness submatrix is:\n$$ \\boldsymbol{K}_{11}^{\\mathrm{std}-H} = \\int_{\\Omega^{(e)}} \\big(H(\\boldsymbol{x}) - H_1\\big) (\\boldsymbol{B}_{1}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{1}^{\\mathrm{std}} \\, t \\, dA $$\nThe domain $\\Omega^{(e)}$ is split into two subdomains: $\\Omega_{-}^{(e)}$ where $H(\\boldsymbol{x})=-1$, and $\\Omega_{+}^{(e)}$ where $H(\\boldsymbol{x})=+1$. We are given $H_1 = +1$. The integral becomes:\n$$ \\boldsymbol{K}_{11}^{\\mathrm{std}-H} = \\int_{\\Omega_{-}^{(e)}} (-1 - 1) (\\boldsymbol{B}_{1}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{1}^{\\mathrm{std}} \\, t \\, dA + \\int_{\\Omega_{+}^{(e)}} (+1 - 1) (\\boldsymbol{B}_{1}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{1}^{\\mathrm{std}} \\, t \\, dA $$\nThe integral over $\\Omega_{+}^{(e)}$ is zero. This simplifies to:\n$$ \\boldsymbol{K}_{11}^{\\mathrm{std}-H} = -2 \\int_{\\Omega_{-}^{(e)}} (\\boldsymbol{B}_{1}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{1}^{\\mathrm{std}} \\, t \\, dA $$\nWe use one-point quadrature at the element centroid $\\boldsymbol{x}_c$ for this integral. The area of the subdomain $\\Omega_{-}^{(e)}$ is $A_{-} = f_{-} A_{\\text{elem}} = f_{-} a^2$. The approximation is:\n$$ \\boldsymbol{K}_{11}^{\\mathrm{std}-H} \\approx -2 \\, t \\, (f_{-} a^2) \\left[ (\\boldsymbol{B}_{1}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{1}^{\\mathrm{std}} \\right]_{\\boldsymbol{x}_c} $$\nThe entry $K_{(1x),(1a_{x})}^{(e)}$ is the $(1,1)$ component of this $2 \\times 2$ matrix. Let the matrix product be $\\boldsymbol{M} = (\\boldsymbol{B}_{1}^{\\mathrm{std}})^T \\boldsymbol{D} \\boldsymbol{B}_{1}^{\\mathrm{std}}$. We seek the component $M_{11}$.\nThe elasticity matrix $\\boldsymbol{D}$ for plane strain is:\n$$ \\boldsymbol{D} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix} 1-\\nu & \\nu & 0 \\\\ \\nu & 1-\\nu & 0 \\\\ 0 & 0 & \\frac{1-2\\nu}{2} \\end{pmatrix} $$\nLet $D_{11} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}$ and $D_{33} = \\frac{E}{2(1+\\nu)}$.\nThe B-matrix at the centroid, using the given derivatives $\\frac{\\partial N_1}{\\partial x} = -\\frac{1}{2a}$ and $\\frac{\\partial N_1}{\\partial y} = -\\frac{1}{2a}$, is:\n$$ \\boldsymbol{B}_{1}^{\\mathrm{std}}|_{\\boldsymbol{x}_c} = \\begin{pmatrix} -1/(2a) & 0 \\\\ 0 & -1/(2a) \\\\ -1/(2a) & -1/(2a) \\end{pmatrix} $$\nThe $(1,1)$ component of the product $\\boldsymbol{M}$ is:\n$$ M_{11} = \\left( \\frac{\\partial N_1}{\\partial x} \\right)^2 D_{11} + \\left( \\frac{\\partial N_1}{\\partial y} \\right)^2 D_{33} = \\left(-\\frac{1}{2a}\\right)^2 D_{11} + \\left(-\\frac{1}{2a}\\right)^2 D_{33} = \\frac{1}{4a^2} (D_{11} + D_{33}) $$\nSubstituting this into the expression for $K_{(1x),(1a_{x})}^{(e)}$:\n$$ K_{(1x),(1a_{x})}^{(e)} \\approx -2 \\, t \\, (f_{-} a^2) \\left[ \\frac{1}{4a^2} (D_{11} + D_{33}) \\right] = - \\frac{1}{2} f_{-} t (D_{11} + D_{33}) $$\nThe term $a^2$ cancels, as expected. Now we combine the terms for $(D_{11} + D_{33})$:\n$$ D_{11} + D_{33} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} + \\frac{E}{2(1+\\nu)} = \\frac{E}{(1+\\nu)} \\left( \\frac{2(1-\\nu) + (1-2\\nu)}{2(1-2\\nu)} \\right) = \\frac{E(3-4\\nu)}{2(1+\\nu)(1-2\\nu)} $$\nThe final symbolic expression for the stiffness component is:\n$$ K_{(1x),(1a_{x})}^{(e)} = - \\frac{1}{2} f_{-} t \\left( \\frac{E(3-4\\nu)}{2(1+\\nu)(1-2\\nu)} \\right) = - \\frac{E f_{-} t (3-4\\nu)}{4(1+\\nu)(1-2\\nu)} $$\nNow, we substitute the given numerical values: $E=210\\times 10^{3}\\,\\mathrm{N/mm^2}$, $\\nu=0.30$, $f_{-}=0.40$, and $t=1\\,\\mathrm{mm}$.\n$$ K_{(1x),(1a_{x})}^{(e)} = - \\frac{(210 \\times 10^{3}) (0.40) (1) (3 - 4 \\times 0.30)}{4(1+0.30)(1 - 2 \\times 0.30)} $$\n$$ K_{(1x),(1a_{x})}^{(e)} = - \\frac{(210 \\times 10^{3}) (0.40) (1.8)}{4(1.3)(0.4)} = - \\frac{151200}{2.08} \\approx -72692.30769 \\, \\mathrm{N/mm} $$\nRounding the result to four significant figures gives $-72690 \\, \\mathrm{N/mm}$.", "answer": "$$\\boxed{-72690}$$", "id": "2637785"}]}