{"hands_on_practices": [{"introduction": "Mastering the Quasicontinuum (QC) method begins with understanding its core computational mechanics. This practice provides a foundational exercise in applying the QC framework to a simple one-dimensional atomic chain [@problem_id:2923438]. By calculating the total potential energy and the resulting nodal forces from first principles, you will gain hands-on experience with the essential steps of kinematic interpolation and energy summation that underpin this powerful multiscale technique.", "problem": "Consider a one-dimensional chain of $9$ atoms indexed by $i=0,1,\\ldots,8$ with reference positions $X_i=i\\,a_0$, where $a_0>0$ is the reference nearest-neighbor spacing. The atomic interactions are restricted to nearest neighbors via a pair potential $\\phi(r)$ that depends only on the current bond length $r$. The chain is coarse-grained by the Quasicontinuum (QC) method using a two-element mesh with representative atoms (also called repatoms) at $i=0,4,8$, thereby defining two elements: element $1$ spanning $[X_0,X_4]$ and element $2$ spanning $[X_4,X_8]$. Assume the local Cauchy–Born approximation in each element with linear interpolation of displacements between repatoms, and use the uniform-weight summation rule that counts all nearest-neighbor bonds in each element.\n\nThe pair potential is harmonic about $a_0$, i.e., $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$, with stiffness $k>0$. Let the repatom displacements be prescribed as $u_0=0$, $u_4=\\bar{u}$, and $u_8=2\\bar{u}$, where $\\bar{u}>0$ is a given constant. With these data, the QC total potential energy is defined as the sum of the element contributions obtained by counting the $4$ bonds in each element, each deformed consistently with the element’s linear displacement field.\n\nStarting from the definitions of the bond-length change induced by a linear displacement field and the Cauchy–Born relation, derive the QC total energy $E_{\\mathrm{QC}}(u)$ as a function of the repatom displacements. Then, compute $E_{\\mathrm{QC}}(u)$ for the specific values $k=100~\\mathrm{N/m}$, $a_0=2.5\\times 10^{-10}~\\mathrm{m}$, and $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$. Finally, obtain the internal nodal forces at the repatoms by differentiation, $\\mathbf{F}=-\\nabla E_{\\mathrm{QC}}(u)$ evaluated at the given displacements, and report the three components $F_0$, $F_4$, and $F_8$.\n\nAnswer specification:\n- Express the energy in $\\mathrm{J}$ and the forces in $\\mathrm{N}$.\n- Round all reported quantities to three significant figures.\n- Provide your final answer as a single row matrix containing first $E_{\\mathrm{QC}}(u)$, followed by $F_0$, $F_4$, and $F_8$, in that order.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extracted Givens.\n- A one-dimensional chain of $9$ atoms, indexed $i=0,1,\\ldots,8$.\n- Reference positions: $X_i=i\\,a_0$, with lattice parameter $a_0>0$.\n- Interaction potential: Nearest-neighbor harmonic pair potential $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$, with stiffness $k>0$.\n- Coarse-graining: QuasiContinuum (QC) method with representative atoms (repatoms) at indices $0$, $4$, and $8$.\n- Mesh: Two elements, element $1$ over $[X_0, X_4]$ and element $2$ over $[X_4,X_8]$.\n- Approximations: Local Cauchy–Born rule with linear interpolation of displacements.\n- Summation rule: Uniform-weight summation, counting $4$ bonds in each element.\n- Prescribed displacements: $u_0=0$, $u_4=\\bar{u}$, $u_8=2\\bar{u}$.\n- Constants: $k=100~\\mathrm{N/m}$, $a_0=2.5\\times 10^{-10}~\\mathrm{m}$, $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$.\n- Required outputs: Total QC energy $E_{\\mathrm{QC}}(u)$ and nodal forces $F_0$, $F_4$, $F_8$, with numerical values rounded to three significant figures.\n\nStep 2: Validation Using Extracted Givens.\nThe problem is scientifically grounded, as it describes a standard application of the QuasiContinuum method, a well-established multiscale technique in computational materials science. The use of a harmonic potential corresponds to the linear elastic limit, and the Cauchy-Born approximation is a fundamental tenet of the method. The problem is well-posed; it provides all necessary data, parameters, and boundary conditions to arrive at a unique, meaningful solution. The definitions are clear, self-contained, and consistent. For instance, the domain of element $1$, $[X_0, X_4]$, contains atoms $0, 1, 2, 3, 4$ and thus the four nearest-neighbor bonds $(0,1), (1,2), (2,3), (3,4)$, which is consistent with the specified count of $4$ bonds. The same holds for element $2$. The numerical values are physically plausible for an atomic system. The problem does not violate any of the invalidity criteria.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be derived.\n\nDerivation of the QC Total Energy $E_{\\mathrm{QC}}(u)$.\nThe total energy is the sum of the energies of the two elements, $E_{\\mathrm{QC}} = E^{(1)} + E^{(2)}$.\n\nFor element $1$, spanning repatoms $0$ and $4$, the reference length is $L_1 = X_4 - X_0 = 4a_0$. The displacement field $u(X)$ for $X \\in [X_0, X_4]$ is assumed to be linear:\n$$u(X) = u_0 \\left(1 - \\frac{X-X_0}{L_1}\\right) + u_4 \\left(\\frac{X-X_0}{L_1}\\right)$$\nThe macroscopic deformation gradient $F$ is constant within the element and is given by $F = 1 + du/dX$.\n$$F^{(1)} = 1 + \\frac{u_4 - u_0}{X_4 - X_0} = 1 + \\frac{u_4 - u_0}{4a_0}$$\nAccording to the local Cauchy–Born approximation, every bond in the element deforms according to this macroscopic gradient. The deformed bond length $r^{(1)}$ is:\n$$r^{(1)} = F^{(1)} a_0 = \\left(1 + \\frac{u_4 - u_0}{4a_0}\\right) a_0 = a_0 + \\frac{u_4 - u_0}{4}$$\nThe energy stored in a single such bond is:\n$$\\phi(r^{(1)}) = \\frac{1}{2}k(r^{(1)} - a_0)^2 = \\frac{1}{2}k\\left(\\frac{u_4 - u_0}{4}\\right)^2$$\nElement $1$ contains $4$ bonds. Using the uniform-weight summation rule, the energy of element $1$ is:\n$$E^{(1)} = 4 \\times \\phi(r^{(1)}) = 4 \\times \\frac{1}{2}k\\frac{(u_4 - u_0)^2}{16} = \\frac{k}{8}(u_4 - u_0)^2$$\nSimilarly, for element $2$, spanning repatoms $4$ and $8$ over a reference length $L_2 = X_8 - X_4 = 4a_0$:\n$$F^{(2)} = 1 + \\frac{u_8 - u_4}{X_8 - X_4} = 1 + \\frac{u_8 - u_4}{4a_0}$$\n$$r^{(2)} = F^{(2)} a_0 = a_0 + \\frac{u_8 - u_4}{4}$$\nThe energy of element $2$, which also contains $4$ bonds, is:\n$$E^{(2)} = 4 \\times \\frac{1}{2}k(r^{(2)} - a_0)^2 = \\frac{k}{8}(u_8 - u_4)^2$$\nThe total QC energy is the sum of the element energies:\n$$E_{\\mathrm{QC}}(u_0, u_4, u_8) = E^{(1)} + E^{(2)} = \\frac{k}{8}(u_4 - u_0)^2 + \\frac{k}{8}(u_8 - u_4)^2$$\n\nNumerical Calculation of Energy.\nSubstituting the prescribed displacements $u_0=0$, $u_4=\\bar{u}$, and $u_8=2\\bar{u}$:\n$$E_{\\mathrm{QC}} = \\frac{k}{8}(\\bar{u} - 0)^2 + \\frac{k}{8}(2\\bar{u} - \\bar{u})^2 = \\frac{k}{8}\\bar{u}^2 + \\frac{k}{8}\\bar{u}^2 = \\frac{k}{4}\\bar{u}^2$$\nUsing the given values $k=100~\\mathrm{N/m}$ and $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$:\n$$E_{\\mathrm{QC}} = \\frac{100~\\mathrm{N/m}}{4} (4.0\\times 10^{-11}~\\mathrm{m})^2 = (25~\\mathrm{N/m}) \\times (16.0 \\times 10^{-22}~\\mathrm{m}^2) = 400 \\times 10^{-22}~\\mathrm{J} = 4.0 \\times 10^{-20}~\\mathrm{J}$$\nRounded to three significant figures, the energy is $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$.\n\nDerivation and Calculation of Nodal Forces.\nThe internal forces on the repatoms are given by the negative gradient of the total potential energy, $\\mathbf{F} = -\\nabla E_{\\mathrm{QC}}(u)$. The components are $F_i = -\\partial E_{\\mathrm{QC}} / \\partial u_i$.\n$$F_0 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_0} = -\\frac{k}{8} \\cdot 2(u_4-u_0)(-1) = \\frac{k}{4}(u_4 - u_0)$$\n$$F_8 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_8} = -\\frac{k}{8} \\cdot 2(u_8-u_4)(1) = -\\frac{k}{4}(u_8 - u_4)$$\n$$F_4 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_4} = -\\left[ \\frac{k}{8} \\cdot 2(u_4-u_0)(1) + \\frac{k}{8} \\cdot 2(u_8-u_4)(-1) \\right] = -\\frac{k}{4}\\left[ (u_4-u_0) - (u_8-u_4) \\right] = -\\frac{k}{4}(2u_4 - u_0 - u_8)$$\nSubstituting the prescribed displacements ($u_0=0, u_4=\\bar{u}, u_8=2\\bar{u}$) and numerical values:\n$$F_0 = \\frac{k}{4}(\\bar{u} - 0) = \\frac{k}{4}\\bar{u} = \\frac{100}{4}(4.0\\times 10^{-11}) = 25 \\times 4.0\\times 10^{-11} = 100 \\times 10^{-11}~\\mathrm{N} = 1.0 \\times 10^{-9}~\\mathrm{N}$$\nTo three significant figures, $F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$.\n\n$$F_8 = -\\frac{k}{4}(2\\bar{u} - \\bar{u}) = -\\frac{k}{4}\\bar{u} = -1.0 \\times 10^{-9}~\\mathrm{N}$$\nTo three significant figures, $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$.\n\n$$F_4 = -\\frac{k}{4}(2\\bar{u} - 0 - 2\\bar{u}) = -\\frac{k}{4}(0) = 0~\\mathrm{N}$$\nThe force $F_4$ is exactly zero because the strain is uniform across the two elements. Uniform strain implies the force exerted by element $1$ on repatom $4$ is equal and opposite to the force exerted by element $2$ on repatom $4$. The value is exactly $0$.\n\nThe final results are $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$, $F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$, $F_4 = 0~\\mathrm{N}$, and $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$.", "answer": "$$\\boxed{\\begin{pmatrix} 4.00 \\times 10^{-20} & 1.00 \\times 10^{-9} & 0 & -1.00 \\times 10^{-9} \\end{pmatrix}}$$", "id": "2923438"}, {"introduction": "A central assumption of the standard QC method is that the displacement of atoms can be accurately described by interpolating between a few representative atoms (repatoms). This exercise moves to two dimensions to critically examine this kinematic approximation in a tangible way [@problem_id:2923417]. By comparing the QC-interpolated positions of atoms against their true positions under a non-uniform deformation field, you will directly quantify the method's interpolation error and develop an intuition for the sources of inaccuracy in QC simulations.", "problem": "Consider a two-dimensional hexagonal (triangular) Bravais lattice with primitive vectors $\\mathbf{a}_{1} = (a, 0)$ and $\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}\\,a}{2}\\right)$, where $a>0$ is the lattice parameter. In a standard quasicontinuum discretization, consider a single linear three-node triangular finite element whose vertices coincide with three lattice sites (the representative atoms, also called repatoms):\n$$\n\\mathbf{R}_{1} = (0,0), \\quad \\mathbf{R}_{2} = 2\\mathbf{a}_{1} = (2a, 0), \\quad \\mathbf{R}_{3} = 2\\mathbf{a}_{2} = \\left(a, \\sqrt{3}\\,a\\right).\n$$\nLet the atomistic displacement field be quadratic,\n$$\n\\mathbf{u}(\\mathbf{x}) = \\begin{pmatrix} u_{x}(\\mathbf{x}) \\\\ u_{y}(\\mathbf{x}) \\end{pmatrix} = \\begin{pmatrix} \\kappa\\,x^{2} \\\\ \\kappa\\,y^{2} \\end{{pmatrix},\n$$\nwhere $\\kappa \\in \\mathbb{R}$ is a constant and $\\mathbf{x}=(x,y)$. The repatom nodal displacements are taken as the exact values of $\\mathbf{u}(\\mathbf{x})$ at the three vertices $\\mathbf{R}_{i}$. For any atom $\\mathbf{X}$ in the element, the quasicontinuum kinematic approximation uses linear finite element interpolation of displacements,\n$$\n\\mathbf{u}_{h}(\\mathbf{X}) = N_{1}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{1}) + N_{2}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{2}) + N_{3}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{3}),\n$$\nwhere $N_{i}$ are the standard barycentric shape functions on the triangle $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$.\n\n(a) Enumerate all lattice sites $\\mathbf{X}$ that lie in the closed triangular element $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$.\n\n(b) Using the definition of barycentric coordinates (shape functions) on a triangle from first principles, compute explicitly the interpolated deformed positions $\\mathbf{X} + \\mathbf{u}_{h}(\\mathbf{X})$ for all such atoms.\n\n(c) Define the pointwise interpolation error at an atom as $\\mathbf{e}(\\mathbf{X}) = \\mathbf{u}(\\mathbf{X}) - \\mathbf{u}_{h}(\\mathbf{X})$. Using only the nodal values and the linear interpolation formula above, compute the maximum Euclidean norm of the interpolation error over all atoms in this element,\n$$\nE_{\\max} = \\max_{\\mathbf{X} \\in \\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3} \\cap \\{\\text{lattice sites}\\}} \\|\\mathbf{e}(\\mathbf{X})\\|_{2}.\n$$\n\nExpress your final answer symbolically in terms of $a$ and $\\kappa$. Do not include units in your final expression.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nStep 1: Extracted Givens.\n- A two-dimensional hexagonal Bravais lattice with primitive vectors $\\mathbf{a}_{1} = (a, 0)$ and $\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}\\,a}{2}\\right)$, where $a>0$.\n- A linear three-node triangular finite element with vertices (repatoms) at $\\mathbf{R}_{1} = (0,0)$, $\\mathbf{R}_{2} = 2\\mathbf{a}_{1} = (2a, 0)$, and $\\mathbf{R}_{3} = 2\\mathbf{a}_{2} = \\left(a, \\sqrt{3}\\,a\\right)$.\n- An atomistic displacement field given by $\\mathbf{u}(\\mathbf{x}) = \\begin{pmatrix} \\kappa\\,x^{2} \\\\ \\kappa\\,y^{2} \\end{pmatrix}$, for $\\mathbf{x}=(x,y)$ and $\\kappa \\in \\mathbb{R}$.\n- Nodal displacements are exact: $\\mathbf{u}(\\mathbf{R}_{i})$.\n- The quasicontinuum (QC) kinematic approximation (interpolated displacement) for an atom at $\\mathbf{X}$ is $\\mathbf{u}_{h}(\\mathbf{X}) = \\sum_{i=1}^{3} N_{i}(\\mathbf{X})\\,\\mathbf{u}(\\mathbf{R}_{i})$, where $N_{i}$ are the standard barycentric shape functions.\n- The objective is to (a) enumerate all lattice sites $\\mathbf{X}$ within the closed element $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$, (b) compute the interpolated deformed positions $\\mathbf{X} + \\mathbf{u}_{h}(\\mathbf{X})$, and (c) find the maximum Euclidean norm of the pointwise interpolation error, $E_{\\max} = \\max_{\\mathbf{X}} \\|\\mathbf{u}(\\mathbf{X}) - \\mathbf{u}_{h}(\\mathbf{X})\\|_{2}$, over all atoms in the element.\n\nStep 2: Validation.\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard calculation in the field of computational materials science, specifically within the quasicontinuum method framework. The concepts of Bravais lattices, finite element interpolation, and error analysis are fundamental and correctly applied. All necessary data, including lattice geometry, element vertices, and the displacement field, are provided, making the problem self-contained and solvable. There are no scientific inaccuracies, contradictions, or ambiguities.\n\nStep 3: Verdict.\nThe problem is valid. A solution will be provided.\n\nThe solution proceeds by addressing each part of the problem systematically.\n\n(a) Enumeration of lattice sites\nA general position of an atom in the hexagonal lattice is given by $\\mathbf{X} = n_{1}\\mathbf{a}_{1} + n_{2}\\mathbf{a}_{2}$, where $n_{1}, n_{2} \\in \\mathbb{Z}$. In Cartesian coordinates, this is $\\mathbf{X}(n_{1}, n_{2}) = (x,y) = \\left(n_{1}a + n_{2}\\frac{a}{2}, n_{2}\\frac{\\sqrt{3}a}{2}\\right)$.\nThe vertices of the triangular element are $\\mathbf{R}_{1}=(0,0)$, $\\mathbf{R}_{2}=(2a,0)$, and $\\mathbf{R}_{3}=(a, \\sqrt{3}a)$.\nAn atom at $\\mathbf{X}(x,y)$ is inside the closed triangle $\\triangle \\mathbf{R}_{1}\\mathbf{R}_{2}\\mathbf{R}_{3}$ if it satisfies the following three linear inequalities defining the triangle's boundaries:\n1.  Edge $\\mathbf{R}_{1}\\mathbf{R}_{2}$: $y \\geq 0$\n2.  Edge $\\mathbf{R}_{1}\\mathbf{R}_{3}$: $y \\leq \\sqrt{3}x$\n3.  Edge $\\mathbf{R}_{2}\\mathbf{R}_{3}$: $y \\leq -\\sqrt{3}(x-2a)$, or $\\sqrt{3}x+y \\leq 2\\sqrt{3}a$\n\nSubstituting the lattice site coordinates in terms of $n_{1}$ and $n_{2}$:\n1.  $n_{2}\\frac{\\sqrt{3}a}{2} \\geq 0 \\implies n_{2} \\geq 0$.\n2.  $n_{2}\\frac{\\sqrt{3}a}{2} \\leq \\sqrt{3}\\left(n_{1}a + n_{2}\\frac{a}{2}\\right) \\implies \\frac{n_{2}}{2} \\leq n_{1} + \\frac{n_{2}}{2} \\implies n_{1} \\geq 0$.\n3.  $\\sqrt{3}\\left(n_{1}a + n_{2}\\frac{a}{2}\\right) + n_{2}\\frac{\\sqrt{3}a}{2} \\leq 2\\sqrt{3}a \\implies n_{1} + \\frac{n_{2}}{2} + \\frac{n_{2}}{2} \\leq 2 \\implies n_{1} + n_{2} \\leq 2$.\n\nWe seek all integer pairs $(n_{1}, n_{2})$ satisfying $n_{1} \\geq 0$, $n_{2} \\geq 0$, and $n_{1}+n_{2} \\leq 2$. The valid pairs are:\n- $n_{2}=0$: $n_{1} \\in \\{0, 1, 2\\} \\implies (0,0), (1,0), (2,0)$.\n- $n_{2}=1$: $n_{1} \\in \\{0, 1\\} \\implies (0,1), (1,1)$.\n- $n_{2}=2$: $n_{1}=0 \\implies (0,2)$.\n\nThese $6$ pairs correspond to the following lattice sites:\n1.  $(n_1,n_2)=(0,0): \\mathbf{X}_{1} = 0\\mathbf{a}_{1} + 0\\mathbf{a}_{2} = (0,0) = \\mathbf{R}_{1}$\n2.  $(n_1,n_2)=(1,0): \\mathbf{X}_{2} = 1\\mathbf{a}_{1} + 0\\mathbf{a}_{2} = (a,0)$\n3.  $(n_1,n_2)=(2,0): \\mathbf{X}_{3} = 2\\mathbf{a}_{1} + 0\\mathbf{a}_{2} = (2a,0) = \\mathbf{R}_{2}$\n4.  $(n_1,n_2)=(0,1): \\mathbf{X}_{4} = 0\\mathbf{a}_{1} + 1\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2}\\right)$\n5.  $(n_1,n_2)=(1,1): \\mathbf{X}_{5} = 1\\mathbf{a}_{1} + 1\\mathbf{a}_{2} = \\left(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2}\\right)$\n6.  $(n_1,n_2)=(0,2): \\mathbf{X}_{6} = 0\\mathbf{a}_{1} + 2\\mathbf{a}_{2} = (a, \\sqrt{3}a) = \\mathbf{R}_{3}$\nThere are $6$ atoms in the closed element. Three are the repatoms ($\\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3$) and three lie on the element edges.\n\n(b) Interpolated deformed positions\nThe interpolated displacement $\\mathbf{u}_h(\\mathbf{X})$ is given by $\\mathbf{u}_{h}(\\mathbf{X}) = N_{1}(\\mathbf{X})\\mathbf{u}(\\mathbf{R}_{1}) + N_{2}(\\mathbf{X})\\mathbf{u}(\\mathbf{R}_{2}) + N_{3}(\\mathbf{X})\\mathbf{u}(\\mathbf{R}_{3})$.\nFirst, we compute the nodal displacements $\\mathbf{u}(\\mathbf{R}_{i})$ using $\\mathbf{u}(x,y) = (\\kappa x^2, \\kappa y^2)$:\n- $\\mathbf{u}(\\mathbf{R}_{1}) = \\mathbf{u}(0,0) = (0,0)$.\n- $\\mathbf{u}(\\mathbf{R}_{2}) = \\mathbf{u}(2a,0) = (\\kappa(2a)^2, \\kappa 0^2) = (4\\kappa a^2, 0)$.\n- $\\mathbf{u}(\\mathbf{R}_{3}) = \\mathbf{u}(a,\\sqrt{3}a) = (\\kappa a^2, \\kappa(\\sqrt{3}a)^2) = (\\kappa a^2, 3\\kappa a^2)$.\n\nNext, we find the shape functions $N_i$. For a point $\\mathbf{X}=(x,y)$, the barycentric coordinates $N_i$ satisfy the system:\n$$ \\begin{pmatrix} 1 & 1 & 1 \\\\ x_1 & x_2 & x_3 \\\\ y_1 & y_2 & y_3 \\end{pmatrix} \\begin{pmatrix} N_1 \\\\ N_2 \\\\ N_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ x \\\\ y \\end{pmatrix} \\implies \\begin{pmatrix} 1 & 1 & 1 \\\\ 0 & 2a & a \\\\ 0 & 0 & \\sqrt{3}a \\end{pmatrix} \\begin{pmatrix} N_1 \\\\ N_2 \\\\ N_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ x \\\\ y \\end{pmatrix} $$\nSolving this system by back-substitution gives:\n$N_{3}(x,y) = \\frac{y}{\\sqrt{3}a}$\n$N_{2}(x,y) = \\frac{x - aN_3}{2a} = \\frac{x}{2a} - \\frac{y}{2\\sqrt{3}a}$\n$N_{1}(x,y) = 1 - N_2 - N_3 = 1 - \\frac{x}{2a} - \\frac{y}{2\\sqrt{3}a}$\n\nThe interpolated displacement field is $\\mathbf{u}_h(x,y) = N_{2}(x,y)\\mathbf{u}(\\mathbf{R}_{2}) + N_{3}(x,y)\\mathbf{u}(\\mathbf{R}_{3})$:\n$$ \\mathbf{u}_h(x,y) = \\left(\\frac{x}{2a} - \\frac{y}{2\\sqrt{3}a}\\right) \\begin{pmatrix} 4\\kappa a^2 \\\\ 0 \\end{pmatrix} + \\left(\\frac{y}{\\sqrt{3}a}\\right) \\begin{pmatrix} \\kappa a^2 \\\\ 3\\kappa a^2 \\end{pmatrix} = \\begin{pmatrix} 2\\kappa ax - \\frac{2\\kappa ay}{\\sqrt{3}} + \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\sqrt{3}\\kappa ay \\end{pmatrix} = \\begin{pmatrix} 2\\kappa ax - \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\sqrt{3}\\kappa ay \\end{pmatrix} $$\nThe deformed position of an atom is $\\mathbf{x}_{\\text{def}} = \\mathbf{X} + \\mathbf{u}_h(\\mathbf{X})$.\nFor the repatoms, $\\mathbf{u}_h(\\mathbf{R}_i) = \\mathbf{u}(\\mathbf{R}_i)$.\n1. $\\mathbf{X}_{1}=(0,0)$: $\\mathbf{x}_{\\text{def}} = (0,0) + (0,0) = (0,0)$.\n2. $\\mathbf{X}_{3}=(2a,0)$: $\\mathbf{x}_{\\text{def}} = (2a,0) + (4\\kappa a^2, 0) = (2a+4\\kappa a^2, 0)$.\n3. $\\mathbf{X}_{6}=(a,\\sqrt{3}a)$: $\\mathbf{x}_{\\text{def}} = (a,\\sqrt{3}a) + (\\kappa a^2, 3\\kappa a^2) = (a+\\kappa a^2, \\sqrt{3}a+3\\kappa a^2)$.\n\nFor the other atoms:\n4. $\\mathbf{X}_{2}=(a,0)$: $\\mathbf{u}_h(a,0) = (2\\kappa a^2, 0)$. Deformed position: $(a + 2\\kappa a^2, 0)$.\n5. $\\mathbf{X}_{4}=(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2})$: $\\mathbf{u}_h = \\left(2\\kappa a(\\frac{a}{2}) - \\frac{\\kappa a}{\\sqrt{3}}(\\frac{\\sqrt{3}a}{2}), \\sqrt{3}\\kappa a(\\frac{\\sqrt{3}a}{2})\\right) = \\left(\\frac{\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2}\\right)$. Deformed position: $(\\frac{a}{2} + \\frac{\\kappa a^2}{2}, \\frac{\\sqrt{3}a}{2} + \\frac{3\\kappa a^2}{2})$.\n6. $\\mathbf{X}_{5}=(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2})$: $\\mathbf{u}_h = \\left(2\\kappa a(\\frac{3a}{2}) - \\frac{\\kappa a}{\\sqrt{3}}(\\frac{\\sqrt{3}a}{2}), \\sqrt{3}\\kappa a(\\frac{\\sqrt{3}a}{2})\\right) = \\left(\\frac{5\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2}\\right)$. Deformed position: $(\\frac{3a}{2} + \\frac{5\\kappa a^2}{2}, \\frac{\\sqrt{3}a}{2} + \\frac{3\\kappa a^2}{2})$.\n\n(c) Maximum interpolation error\nThe interpolation error is $\\mathbf{e}(\\mathbf{X}) = \\mathbf{u}(\\mathbf{X}) - \\mathbf{u}_h(\\mathbf{X})$.\n$\\mathbf{e}(x,y) = \\begin{pmatrix} \\kappa x^2 \\\\ \\kappa y^2 \\end{pmatrix} - \\begin{pmatrix} 2\\kappa ax - \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\sqrt{3}\\kappa ay \\end{pmatrix} = \\begin{pmatrix} \\kappa x^2 - 2\\kappa ax + \\frac{\\kappa ay}{\\sqrt{3}} \\\\ \\kappa y^2 - \\sqrt{3}\\kappa ay \\end{pmatrix}$.\nBy construction, the error at the repatoms is zero: $\\mathbf{e}(\\mathbf{R}_1) = \\mathbf{e}(\\mathbf{R}_2) = \\mathbf{e}(\\mathbf{R}_3) = \\mathbf{0}$. We calculate the error for the other three atoms.\n- For $\\mathbf{X}_{2}=(a,0)$:\n$\\mathbf{e}(a,0) = (\\kappa a^2 - 2\\kappa a^2, 0) = (-\\kappa a^2, 0)$.\n$\\|\\mathbf{e}(a,0)\\|_{2} = \\sqrt{(-\\kappa a^2)^2} = |\\kappa|a^2$.\n\n- For $\\mathbf{X}_{4}=(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2})$:\nThe exact displacement is $\\mathbf{u}(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\kappa(\\frac{a}{2})^2, \\kappa(\\frac{\\sqrt{3}a}{2})^2) = (\\frac{\\kappa a^2}{4}, \\frac{3\\kappa a^2}{4})$.\nThe interpolated displacement was found to be $\\mathbf{u}_h(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\frac{\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2})$.\n$\\mathbf{e}(\\mathbf{X}_{4}) = (\\frac{\\kappa a^2}{4} - \\frac{\\kappa a^2}{2}, \\frac{3\\kappa a^2}{4} - \\frac{3\\kappa a^2}{2}) = (-\\frac{\\kappa a^2}{4}, -\\frac{3\\kappa a^2}{4})$.\n$\\|\\mathbf{e}(\\mathbf{X}_{4})\\|_{2} = \\sqrt{(-\\frac{\\kappa a^2}{4})^2 + (-\\frac{3\\kappa a^2}{4})^2} = \\sqrt{\\frac{\\kappa^2 a^4}{16} + \\frac{9\\kappa^2 a^4}{16}} = \\sqrt{\\frac{10\\kappa^2 a^4}{16}} = \\frac{\\sqrt{10}}{4}|\\kappa|a^2$.\n\n- For $\\mathbf{X}_{5}=(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2})$:\nThe exact displacement is $\\mathbf{u}(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\kappa(\\frac{3a}{2})^2, \\kappa(\\frac{\\sqrt{3}a}{2})^2) = (\\frac{9\\kappa a^2}{4}, \\frac{3\\kappa a^2}{4})$.\nThe interpolated displacement was found to be $\\mathbf{u}_h(\\frac{3a}{2}, \\frac{\\sqrt{3}a}{2}) = (\\frac{5\\kappa a^2}{2}, \\frac{3\\kappa a^2}{2})$.\n$\\mathbf{e}(\\mathbf{X}_{5}) = (\\frac{9\\kappa a^2}{4} - \\frac{10\\kappa a^2}{4}, \\frac{3\\kappa a^2}{4} - \\frac{6\\kappa a^2}{4}) = (-\\frac{\\kappa a^2}{4}, -\\frac{3\\kappa a^2}{4})$.\nThe error vector is identical to that for $\\mathbf{X}_{4}$, so $\\|\\mathbf{e}(\\mathbf{X}_{5})\\|_{2} = \\frac{\\sqrt{10}}{4}|\\kappa|a^2$.\n\nTo find the maximum error $E_{\\max}$, we compare the norms: $|\\kappa|a^2$, $\\frac{\\sqrt{10}}{4}|\\kappa|a^2$, and $0$.\nWe compare $1$ and $\\frac{\\sqrt{10}}{4}$. Since $16 > 10$, we have $\\sqrt{16} > \\sqrt{10}$, so $4 > \\sqrt{10}$, which implies $1 > \\frac{\\sqrt{10}}{4}$.\nThus, the maximum error norm occurs at the atom $\\mathbf{X}_{2}=(a,0)$.\nThe maximum value is $E_{\\max} = |\\kappa|a^2$.", "answer": "$$\n\\boxed{|\\kappa|a^{2}}\n$$", "id": "2923417"}, {"introduction": "A key challenge in any multiscale method is ensuring a seamless and physically consistent coupling between fine-scale and coarse-scale regions. This advanced problem delves into a notorious artifact of early QC formulations known as \"ghost forces\"—spurious forces that arise at the atomistic/continuum interface even under uniform deformation [@problem_id:2678008]. By constructing an energy-based coupling and calculating the resulting force imbalance, you will uncover a fundamental flaw that has driven the development of more sophisticated and accurate QC coupling techniques.", "problem": "Consider a one-dimensional ($1$D) infinite atomic chain with reference lattice parameter $a>0$ and atoms labeled by indices $i \\in \\mathbb{Z}$ with reference positions $x_i = i a$. The deformed positions are denoted by $y_i \\in \\mathbb{R}$. The total atomistic energy is a sum of pairwise interactions up to second neighbors,\n$$\nE^{\\mathrm{atom}}(y) \\;=\\; \\sum_{i \\in \\mathbb{Z}} \\Big[ \\phi_1\\!\\big(|y_{i+1}-y_i|\\big) + \\phi_2\\!\\big(|y_{i+2}-y_i|\\big) \\Big],\n$$\nwhere $\\phi_1$ and $\\phi_2$ are smooth pair potentials for the nearest and next-nearest neighbor interactions, respectively. Forces are defined by energy gradients, i.e., the force on atom $i$ is $f_i(y) = -\\partial E/\\partial y_i$.\n\nA uniform macroscopic deformation is given by $y_i = F x_i = F i a$ for a fixed stretch $F>0$. In the fully atomistic model, symmetry implies $f_i(y)=0$ for all $i$ under this uniform deformation.\n\nDefine ghost forces in the quasicontinuum (QC) method as nonzero forces predicted under a uniform deformation. Construct the following energy-based atomistic/continuum (a/c) coupling in $1$D with an interface between an atomistic region $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$ and a continuum region $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$:\n\n- All nearest-neighbor bonds are retained exactly everywhere, i.e., every pair $\\{i,i+1\\}$ contributes $\\phi_1(|y_{i+1}-y_i|)$ to the QC energy.\n\n- Next-nearest-neighbor bonds entirely contained in $\\mathcal{A}$ contribute exactly, i.e., every pair $\\{i,i+2\\}$ with $i+2 \\le 0$ contributes $\\phi_2(|y_{i+2}-y_i|)$.\n\n- Next-nearest-neighbor bonds entirely contained in $\\mathcal{C}$ are approximated by a Cauchy–Born continuum energy that is a function of the constant deformation gradient $F$ in $\\mathcal{C}$; in particular, each such bond contributes $\\phi_2(2Fa)$, and this continuum energy depends only on degrees of freedom in $\\mathcal{C}$ (so its variation with respect to $y_0$ is zero).\n\n- Next-nearest-neighbor bonds that cross the interface (i.e., with one endpoint in $\\mathcal{A}$ and the other in $\\mathcal{C}$) are not explicitly represented in the QC energy.\n\nUnder the uniform deformation $y_i = F i a$, compute the net QC force on the interfacial atom $i=0$. This nonzero force is the ghost force at the a/c interface in this energy-based QC coupling. Provide your final answer as a single closed-form analytic expression in terms of $F$, $a$, and derivatives of the potentials evaluated at the relevant bond lengths. Do not include units in the final answer. If simplification is possible, provide the simplest expression consistent with the stated assumptions.", "solution": "The problem asks for the net quasicontinuum (QC) force on the interfacial atom $i=0$ under a uniform deformation. This force is known as a ghost force, as it should be zero in a perfectly consistent coarse-grained model.\n\nFirst, the problem statement is validated.\nGivens are extracted verbatim:\n- System: $1$D infinite atomic chain, reference positions $x_i = i a$ for $i \\in \\mathbb{Z}$ and $a>0$. Deformed positions are $y_i$.\n- Atomistic Energy: $E^{\\mathrm{atom}}(y) = \\sum_{i \\in \\mathbb{Z}} [ \\phi_1(|y_{i+1}-y_i|) + \\phi_2(|y_{i+2}-y_i|) ]$.\n- Force: $f_i(y) = -\\partial E/\\partial y_i$.\n- Uniform Deformation: $y_i = F x_i = F i a$ for $F>0$.\n- QC partitioning: Atomistic region $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$, continuum region $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$.\n- QC Energy Construction:\n    1. All nearest-neighbor (NN) bonds $\\{i,i+1\\}$ contribute $\\phi_1(|y_{i+1}-y_i|)$.\n    2. Next-nearest-neighbor (NNN) bonds $\\{i,i+2\\}$ with $i \\le -2$ contribute $\\phi_2(|y_{i+2}-y_i|)$.\n    3. NNN bonds $\\{i,i+2\\}$ with $i \\ge 1$ are approximated, and their energy contribution has zero variation with respect to $y_0$.\n    4. NNN bonds crossing the interface, $\\{ -1, 1 \\}$ and $\\{ 0, 2 \\}$, are not represented in the QC energy.\n\nThe problem is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard problem in the study of the quasicontinuum method. Therefore, the problem is valid.\n\nThe force on atom $k$ is defined as the negative gradient of the total energy with respect to its position $y_k$: $f_k^{\\mathrm{qc}} = -\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_k}$. We are asked to compute this force for the interfacial atom $k=0$.\nThe total QC energy, $E^{\\mathrm{qc}}$, is constructed according to the rules provided:\n$$\nE^{\\mathrm{qc}}(y) = \\sum_{i \\in \\mathbb{Z}} \\phi_1(|y_{i+1}-y_i|) + \\sum_{i \\in \\mathbb{Z}, i \\le -2} \\phi_2(|y_{i+2}-y_i|) + E_{\\mathcal{C}}^{\\mathrm{NNN}}(y_j | j \\ge 1)\n$$\nwhere $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ is the energy from NNN bonds in the continuum region $\\mathcal{C}$, which by definition does not depend on $y_0$. Note that the NNN bonds across the interface, corresponding to $i=-1$ and $i=0$ in the full atomistic sum, are omitted from this energy expression.\n\nTo find the force on atom $0$, $f_0^{\\mathrm{qc}}$, we must differentiate $E^{\\mathrm{qc}}$ with respect to $y_0$. We only need to consider terms in $E^{\\mathrm{qc}}$ that are functions of $y_0$.\n1. From the sum of NN interactions, $\\sum_i \\phi_1(|y_{i+1}-y_i|)$, the terms involving $y_0$ are for $i=0$ and $i=-1$: $\\phi_1(|y_1 - y_0|)$ and $\\phi_1(|y_0 - y_{-1}|)$.\n2. From the sum of NNN interactions in $\\mathcal{A}$, $\\sum_{i \\le -2} \\phi_2(|y_{i+2}-y_i|)$, the term involving $y_0$ is when $i+2=0$, which means $i=-2$. This satisfies the condition $i \\le -2$. So, the term is $\\phi_2(|y_0 - y_{-2}|)$. The term for $i=0$ is not in this sum.\n3. The continuum energy $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ has $\\frac{\\partial E_{\\mathcal{C}}^{\\mathrm{NNN}}}{\\partial y_0} = 0$ by definition.\n4. The NNN interaction between atom $0$ and atom $2$ is explicitly excluded.\n\nThus, the part of the QC energy that depends on $y_0$ is:\n$$\nE_{y_0-\\text{dep}}^{\\mathrm{qc}} = \\phi_1(|y_1 - y_0|) + \\phi_1(|y_0 - y_{-1}|) + \\phi_2(|y_0 - y_{-2}|)\n$$\nThe force on atom $0$ is $f_0^{\\mathrm{qc}} = -\\frac{\\partial}{\\partial y_0} E_{y_0-\\text{dep}}^{\\mathrm{qc}}$. Let us compute the derivatives of each term using the chain rule, where $\\phi'(r) = \\frac{d\\phi}{dr}(r)$.\n$$\n\\frac{\\partial}{\\partial y_k} \\phi(|y_j - y_i|) = \\phi'(|y_j - y_i|) \\cdot \\mathrm{sgn}(y_j - y_i) \\cdot (\\delta_{kj} - \\delta_{ki})\n$$\nApplying this to our terms:\n- For $\\phi_1(|y_1-y_0|)$: $i=0, j=1, k=0$. The derivative is $\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0) (-1) = -\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0)$.\n- For $\\phi_1(|y_0-y_{-1}|)$: $i=-1, j=0, k=0$. The derivative is $\\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1}) (1) = \\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1})$.\n- For $\\phi_2(|y_0-y_{-2}|)$: $i=-2, j=0, k=0$. The derivative is $\\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2}) (1) = \\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2})$.\n\nSumming these derivatives gives $\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_0}$. The force is the negative of this sum:\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(|y_1-y_0|)\\mathrm{sgn}(y_1-y_0) + \\phi_1'(|y_0-y_{-1}|)\\mathrm{sgn}(y_0-y_{-1}) + \\phi_2'(|y_0-y_{-2}|)\\mathrm{sgn}(y_0-y_{-2}) \\right]\n$$\nNow, we evaluate this expression for the uniform deformation $y_i = F i a$, where $F>0$ and $a>0$.\n- Bond length $y_1 - y_0 = F(1)a - F(0)a = Fa$. Since $Fa>0$, $|y_1-y_0| = Fa$ and $\\mathrm{sgn}(y_1-y_0)=1$.\n- Bond length $y_0 - y_{-1} = F(0)a - F(-1)a = Fa$. Since $Fa>0$, $|y_0-y_{-1}| = Fa$ and $\\mathrm{sgn}(y_0-y_{-1})=1$.\n- Bond length $y_0 - y_{-2} = F(0)a - F(-2)a = 2Fa$. Since $2Fa>0$, $|y_0-y_{-2}| = 2Fa$ and $\\mathrm{sgn}(y_0-y_{-2})=1$.\n\nSubstituting these into the force expression:\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) \\cdot (1) + \\phi_1'(Fa) \\cdot (1) + \\phi_2'(2Fa) \\cdot (1) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) + \\phi_1'(Fa) + \\phi_2'(2Fa) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = - [ 0 + \\phi_2'(2Fa) ] = -\\phi_2'(2Fa)\n$$\nThis nonzero force is the ghost force at the interface. It arises because the force contribution on atom $0$ from atom $2$ is missing in the QC energy formulation, breaking the force balance that exists in the full atomistic system. In the atomistic system, the force on atom $0$ from atom $2$ would be $\\phi_2'(|y_2-y_0|)\\mathrm{sgn}(y_2-y_0) = \\phi_2'(2Fa)$, which is precisely the negative of the sum of all other forces acting on atom $0$ under uniform deformation, thus ensuring the total force is zero. The QC method's omission of this single interaction term leads to the calculated residual force.\nThe final expression is in terms of $F$, $a$, and the derivative of the potential $\\phi_2$ evaluated at the NNN bond length $2Fa$.", "answer": "$$\n\\boxed{-\\phi_2'(2Fa)}\n$$", "id": "2678008"}]}