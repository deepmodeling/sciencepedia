{"hands_on_practices": [{"introduction": "Dynamic Mechanical Analysis (DMA) provides raw data in the form of stress and strain amplitudes and the phase angle between them. This first practice establishes the fundamental skill of converting these experimental observables into the core properties that define a material's viscoelastic response. By working through this problem, you will derive and apply the foundational equations that connect the measured phase-shifted sinusoidal signals to the storage modulus $E'$, which quantifies the elastic (stored energy) component, and the loss modulus $E''$, which quantifies the viscous (dissipated energy) component [@problem_id:2623222].", "problem": "A homogeneous, isotropic, one-dimensional linear viscoelastic solid is subjected to a steady harmonic test in Dynamic Mechanical Analysis (DMA). At a fixed angular frequency, the measured stress and strain histories are sinusoidal with a constant phase difference: the stress amplitude is $\\sigma_{0}$, the strain amplitude is $\\varepsilon_{0}$, and the stress leads the strain by a phase angle $\\delta$. The material is assumed to be within the linear viscoelastic regime, and inertial effects are negligible so that one-dimensional constitutive relations apply.\n\nStarting only from the fundamental definition that, under steady harmonic loading, the stress and strain are sinusoidal with a constant phase difference and that the complex modulus encodes both the in-phase and out-of-phase responses associated with recoverable (elastic) and dissipative (viscous) processes, derive expressions for the storage modulus $E'$ and the loss modulus $E''$ in terms of $\\sigma_{0}$, $\\varepsilon_{0}$, and $\\delta$, as well as the magnitude $\\lvert E^{*} \\rvert$ of the complex modulus. Then, using the measured values $\\sigma_{0} = 100\\,\\text{kPa}$, $\\varepsilon_{0} = 0.01$, and $\\delta = 20^{\\circ}$ at the test frequency, compute $E'$, $E''$, and $\\lvert E^{*} \\rvert$.\n\nExpress all three final results in megapascals (MPa) and round each to four significant figures. Treat the given phase angle $\\delta$ in degrees; if you convert to radians for intermediate steps, ensure consistency in your trigonometric evaluations.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It provides all necessary information for a unique solution and adheres to the fundamental principles of linear viscoelasticity. We will therefore proceed with its solution.\n\nThe problem describes a one-dimensional, steady-state harmonic loading scenario. The time-dependent strain, $\\varepsilon(t)$, and stress, $\\sigma(t)$, are sinusoidal with the same angular frequency, $\\omega$. We can represent the strain as the reference signal:\n$$ \\varepsilon(t) = \\varepsilon_{0} \\sin(\\omega t) $$\nwhere $\\varepsilon_{0}$ is the strain amplitude. The problem states that the stress leads the strain by a phase angle $\\delta$. Therefore, the stress response is given by:\n$$ \\sigma(t) = \\sigma_{0} \\sin(\\omega t + \\delta) $$\nwhere $\\sigma_{0}$ is the stress amplitude.\n\nTo analyze the relationship between stress and strain, it is most convenient to use complex number representation. The time-dependent strain and stress can be written as the imaginary parts of complex functions, $\\varepsilon^{*}(t)$ and $\\sigma^{*}(t)$:\n$$ \\varepsilon(t) = \\Im\\{\\varepsilon^{*}(t)\\} = \\Im\\{\\varepsilon_{0} e^{i\\omega t}\\} $$\n$$ \\sigma(t) = \\Im\\{\\sigma^{*}(t)\\} = \\Im\\{\\sigma_{0} e^{i(\\omega t + \\delta)}\\} $$\nwhere $i = \\sqrt{-1}$.\n\nThe complex modulus, $E^{*}$, is defined for a linear viscoelastic material as the ratio of the complex stress to the complex strain under steady-state harmonic loading:\n$$ E^{*} = \\frac{\\sigma^{*}(t)}{\\varepsilon^{*}(t)} $$\nSubstituting the complex expressions for stress and strain, we have:\n$$ E^{*} = \\frac{\\sigma_{0} e^{i(\\omega t + \\delta)}}{\\varepsilon_{0} e^{i\\omega t}} = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\frac{e^{i\\omega t} e^{i\\delta}}{e^{i\\omega t}} = \\frac{\\sigma_{0}}{\\varepsilon_{0}} e^{i\\delta} $$\nUsing Euler's formula, $e^{i\\delta} = \\cos(\\delta) + i \\sin(\\delta)$, the complex modulus can be expressed in its Cartesian form:\n$$ E^{*} = \\frac{\\sigma_{0}}{\\varepsilon_{0}} (\\cos(\\delta) + i \\sin(\\delta)) $$\n\nBy definition, the complex modulus $E^{*}$ is also expressed in terms of the storage modulus, $E'$, and the loss modulus, $E''$, as:\n$$ E^{*} = E' + i E'' $$\nHere, $E'$ represents the in-phase (elastic) component of the response, corresponding to energy stored and recovered per cycle. $E''$ represents the out-of-phase (viscous) component, corresponding to energy dissipated as heat per cycle.\n\nBy equating the two expressions for $E^{*}$, we can identify the real and imaginary parts:\n$$ E' + i E'' = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\cos(\\delta) + i \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\sin(\\delta) $$\nEquating the real parts gives the expression for the storage modulus:\n$$ E' = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\cos(\\delta) $$\nEquating the imaginary parts gives the expression for the loss modulus:\n$$ E'' = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\sin(\\delta) $$\n\nThe magnitude of the complex modulus, $\\lvert E^{*} \\rvert$, can be derived directly from the polar form $E^{*} = (\\sigma_{0}/\\varepsilon_{0}) e^{i\\delta}$:\n$$ \\lvert E^{*} \\rvert = \\left| \\frac{\\sigma_{0}}{\\varepsilon_{0}} e^{i\\delta} \\right| = \\frac{\\sigma_{0}}{\\varepsilon_{0}} |e^{i\\delta}| = \\frac{\\sigma_{0}}{\\varepsilon_{0}} $$\nsince $|e^{i\\delta}| = \\sqrt{\\cos^2(\\delta) + \\sin^2(\\delta)} = 1$. This magnitude represents the overall stiffness of the material under the specific dynamic conditions.\n\nNow, we compute the numerical values using the given data:\n$\\sigma_{0} = 100\\,\\text{kPa}$\n$\\varepsilon_{0} = 0.01$\n$\\delta = 20^{\\circ}$\n\nFirst, we must ensure consistent units. The final results are required in megapascals (MPa).\n$$ \\sigma_{0} = 100\\,\\text{kPa} = 100 \\times 10^{3}\\,\\text{Pa} = 0.1 \\times 10^{6}\\,\\text{Pa} = 0.1\\,\\text{MPa} $$\nThe strain $\\varepsilon_{0}$ is a dimensionless quantity.\n\nWe calculate the magnitude of the complex modulus, $\\lvert E^{*} \\rvert$:\n$$ \\lvert E^{*} \\rvert = \\frac{\\sigma_{0}}{\\varepsilon_{0}} = \\frac{0.1\\,\\text{MPa}}{0.01} = 10\\,\\text{MPa} $$\nTo express this with four significant figures, we write it as $10.00\\,\\text{MPa}$.\n\nNext, we calculate the storage modulus, $E'$:\n$$ E' = \\lvert E^{*} \\rvert \\cos(\\delta) = (10\\,\\text{MPa}) \\cos(20^{\\circ}) $$\nUsing a calculator, $\\cos(20^{\\circ}) \\approx 0.9396926$.\n$$ E' \\approx 10 \\times 0.9396926\\,\\text{MPa} = 9.396926\\,\\text{MPa} $$\nRounding to four significant figures, $E' = 9.397\\,\\text{MPa}$.\n\nFinally, we calculate the loss modulus, $E''$:\n$$ E'' = \\lvert E^{*} \\rvert \\sin(\\delta) = (10\\,\\text{MPa}) \\sin(20^{\\circ}) $$\nUsing a calculator, $\\sin(20^{\\circ}) \\approx 0.3420201$.\n$$ E'' \\approx 10 \\times 0.3420201\\,\\text{MPa} = 3.420201\\,\\text{MPa} $$\nRounding to four significant figures, $E'' = 3.420\\,\\text{MPa}$. The trailing zero is significant and must be retained.\n\nThe requested values are $E'$, $E''$, and $\\lvert E^{*} \\rvert$ in MPa, rounded to four significant figures.", "answer": "$$ \\boxed{ \\begin{pmatrix} 9.397 & 3.420 & 10.00 \\end{pmatrix} } $$", "id": "2623222"}, {"introduction": "While our first exercise focused on calculating $E'$ and $E''$ from data, this next practice bridges the gap between these frequency-domain properties and tangible physical models. We will use the classic Kelvin–Voigt model, which represents a viscoelastic solid as a spring and dashpot in parallel, to see how model parameters like elastic modulus $E$ and viscosity $\\eta$ directly give rise to the complex modulus. This exercise is crucial for building physical intuition about how microscopic mechanisms of elasticity and dissipation manifest as measurable, frequency-dependent material behavior [@problem_id:2623286].", "problem": "A homogeneous, isotropic, linearly viscoelastic solid in uniaxial small strain is modeled by the Kelvin–Voigt constitutive relation, which states that the Cauchy stress is the sum of an elastic and a viscous contribution. In one dimension, this may be written as $\\sigma(t)=E\\,\\varepsilon(t)+\\eta\\,\\dot{\\varepsilon}(t)$, where $E$ is the elastic modulus and $\\eta$ is the viscosity. Under a steady-state harmonic strain input $\\varepsilon(t)=\\varepsilon_{0}\\cos(\\omega t)$, the stress response is also harmonic but generally not in phase with the strain. The storage modulus $E'$ and the loss modulus $E''$ are defined via the complex modulus $E^{*}=E'+\\mathrm{i}E''$, which relates the complex stress amplitude to the complex strain amplitude in sinusoidal steady state. The loss tangent is defined as $\\tan\\delta=E''/E'$.\n\nStarting solely from the Kelvin–Voigt constitutive relation and the harmonic input, derive the linear response in steady state and identify $E'$ and $E''$ from first principles. Then, for $E=1\\,\\text{GPa}$, $\\eta=10^{8}\\,\\text{Pa}\\cdot\\text{s}$, and $\\omega=1\\,\\text{rad}\\,\\text{s}^{-1}$, compute the numerical values of $E'$, $E''$, and $\\tan\\delta$.\n\nExpress $E'$ and $E''$ in $\\text{GPa}$, and express $\\tan\\delta$ as a pure decimal (dimensionless). Round all three quantities to four significant figures.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\nStep 1: Extract Givens\nThe givens are extracted verbatim from the problem statement:\n- Constitutive relation (Kelvin–Voigt model): $\\sigma(t)=E\\,\\varepsilon(t)+\\eta\\,\\dot{\\varepsilon}(t)$\n- $E$: elastic modulus\n- $\\eta$: viscosity\n- Strain input: $\\varepsilon(t)=\\varepsilon_{0}\\cos(\\omega t)$\n- Complex modulus definition: $E^{*}=E'+\\mathrm{i}E''$\n- Loss tangent definition: $\\tan\\delta=E''/E'$\n- Numerical values: $E=1\\,\\text{GPa}$, $\\eta=10^{8}\\,\\text{Pa}\\cdot\\text{s}$, $\\omega=1\\,\\text{rad}\\,\\text{s}^{-1}$\n- Task: Derive $E'$ and $E''$, and compute the numerical values of $E'$, $E''$, and $\\tan\\delta$.\n- Output format: $E'$ and $E''$ in $\\text{GPa}$, $\\tan\\delta$ as a dimensionless decimal, all rounded to four significant figures.\n\nStep 2: Validate Using Extracted Givens\nThe problem is analyzed against the established criteria:\n- **Scientifically Grounded**: The problem is based on the Kelvin–Voigt model, a fundamental and standard construct in the linear theory of viscoelasticity. The concepts of storage modulus, loss modulus, and complex modulus are standard definitions in solid mechanics and materials science for characterizing material response under dynamic loading. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a clear constitutive equation, a specified input stimulus, and asks for derivable quantities. All necessary parameters and definitions ($E$, $\\eta$, $\\omega$, $E'$, $E''$) are provided. The unit consistency is verified: the term $E$ has units of pressure ($\\text{Pa}$), and the term $\\eta\\omega$ has units of $(\\text{Pa}\\cdot\\text{s}) \\cdot (\\text{rad}\\cdot\\text{s}^{-1})$, which is $\\text{Pa}$ since the radian is dimensionless. The problem is dimensionally consistent and self-contained.\n- **Objective**: The problem is stated using precise mathematical and physical language, free of any subjectivity or ambiguity.\n\nStep 3: Verdict and Action\nThe problem is valid. It is a standard, well-posed problem in continuum mechanics. There are no scientific or logical flaws. Therefore, a solution will be provided.\n\nThe objective is to determine the storage modulus $E'$ and loss modulus $E''$ from the given Kelvin-Voigt constitutive model under harmonic loading. The most direct and rigorous method employs complex notation.\n\nThe strain input is given as $\\varepsilon(t)=\\varepsilon_{0}\\cos(\\omega t)$. For a linear system, we may represent this real-valued strain as the real part of a complex exponential function. Let the complex strain be $\\varepsilon^{*}(t) = \\varepsilon_{0} \\exp(\\mathrm{i}\\omega t)$. The actual physical strain is $\\varepsilon(t) = \\text{Re}\\{\\varepsilon^{*}(t)\\}$.\n\nThe strain rate is the time derivative of the strain. For the complex strain, this is:\n$$ \\dot{\\varepsilon}^{*}(t) = \\frac{d}{dt} \\left( \\varepsilon_{0} \\exp(\\mathrm{i}\\omega t) \\right) = \\mathrm{i}\\omega \\varepsilon_{0} \\exp(\\mathrm{i}\\omega t) = \\mathrm{i}\\omega \\varepsilon^{*}(t) $$\nThe complex stress, $\\sigma^{*}(t)$, is related to the complex strain and strain rate through the given constitutive law:\n$$ \\sigma^{*}(t) = E\\,\\varepsilon^{*}(t) + \\eta\\,\\dot{\\varepsilon}^{*}(t) $$\nSubstituting the expression for $\\dot{\\varepsilon}^{*}(t)$:\n$$ \\sigma^{*}(t) = E\\,\\varepsilon^{*}(t) + \\eta\\,(\\mathrm{i}\\omega \\varepsilon^{*}(t)) $$\nFactoring out $\\varepsilon^{*}(t)$:\n$$ \\sigma^{*}(t) = (E + \\mathrm{i}\\eta\\omega)\\,\\varepsilon^{*}(t) $$\nThe complex modulus, $E^{*}$, is defined by the relation $\\sigma^{*}(t) = E^{*} \\varepsilon^{*}(t)$. By direct comparison with the equation derived above, we identify the complex modulus for the Kelvin-Voigt model as:\n$$ E^{*} = E + \\mathrm{i}\\eta\\omega $$\nThe problem also provides the general definition of the complex modulus in terms of the storage modulus, $E'$, and the loss modulus, $E''$:\n$$ E^{*} = E' + \\mathrm{i}E'' $$\nBy equating the two expressions for $E^{*}$, we can identify $E'$ and $E''$ by comparing the real and imaginary parts:\n$$ E' + \\mathrm{i}E'' = E + \\mathrm{i}\\eta\\omega $$\nThe real part gives the storage modulus:\n$$ E' = E $$\nThe imaginary part gives the loss modulus:\n$$ E'' = \\eta\\omega $$\nThis completes the derivation from first principles. The storage modulus $E'$ is equal to the elastic modulus $E$ and is independent of frequency for this model. The loss modulus $E''$ is directly proportional to both viscosity $\\eta$ and angular frequency $\\omega$.\n\nThe loss tangent, $\\tan\\delta$, is defined as the ratio of the loss modulus to the storage modulus:\n$$ \\tan\\delta = \\frac{E''}{E'} = \\frac{\\eta\\omega}{E} $$\nThis quantity represents the ratio of energy dissipated to energy stored per cycle.\n\nNow, we compute the numerical values using the provided data: $E=1\\,\\text{GPa}$, $\\eta=10^{8}\\,\\text{Pa}\\cdot\\text{s}$, and $\\omega=1\\,\\text{rad}\\,\\text{s}^{-1}$. All values must be rounded to four significant figures.\n\nFirst, ensure unit consistency. We are given $E=1\\,\\text{GPa} = 1 \\times 10^{9}\\,\\text{Pa}$.\nThe storage modulus is:\n$$ E' = E = 1\\,\\text{GPa} $$\nTo express this to four significant figures, we write $1.000\\,\\text{GPa}$.\n\nThe loss modulus is:\n$$ E'' = \\eta\\omega = (10^{8}\\,\\text{Pa}\\cdot\\text{s}) \\cdot (1\\,\\text{rad}\\cdot\\text{s}^{-1}) = 10^{8}\\,\\text{Pa} $$\nTo express this in GPa, we convert units:\n$$ E'' = 10^{8}\\,\\text{Pa} \\times \\frac{1\\,\\text{GPa}}{10^{9}\\,\\text{Pa}} = 0.1\\,\\text{GPa} $$\nTo express this to four significant figures, we write $0.1000\\,\\text{GPa}$.\n\nThe loss tangent is:\n$$ \\tan\\delta = \\frac{E''}{E'} = \\frac{0.1\\,\\text{GPa}}{1\\,\\text{GPa}} = 0.1 $$\nThis is a dimensionless quantity. To express this to four significant figures, we write $0.1000$.\n\nThe final numerical results, rounded to four significant figures as required, are:\n- $E' = 1.000\\,\\text{GPa}$\n- $E'' = 0.1000\\,\\text{GPa}$\n- $\\tan\\delta = 0.1000$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.000 & 0.1000 & 0.1000\n\\end{pmatrix}\n}\n$$", "id": "2623286"}, {"introduction": "The entire framework of linear viscoelasticity, and the very definitions of $E'$ and $E''$, rests on the critical assumption that the material's response is linear with respect to the applied strain. This advanced computational practice puts you in the role of an experimental scientist tasked with validating this assumption. You will design and implement a virtual experiment to identify the material's Linear Viscoelastic Range (LVR) by analyzing the stress response for signatures of nonlinearity—namely, the emergence of higher harmonics and the dependence of moduli on strain amplitude [@problem_id:2623338]. This exercise highlights an essential step in ensuring the accuracy and validity of any real-world DMA measurement.", "problem": "You are tasked with designing and implementing a quantitative algorithm to verify the linear viscoelastic response of a material measured by Dynamic Mechanical Analysis (DMA) under amplitude sweeps. The algorithm must be based on the following fundamental bases and observations:\n\n1. Under a prescribed sinusoidal strain input of the form $\\varepsilon(t)=\\varepsilon_{0}\\sin(\\omega t)$, a linear viscoelastic material produces a stress response at the same angular frequency $\\omega$ with a phase shift. In the frequency-domain description, this is captured by the complex modulus $E^{*}=E'+i E''$, where $E'$ (storage modulus) is the in-phase component and $E''$ (loss modulus) is the out-of-phase component relative to the input strain.\n\n2. When the response departs from linear viscoelasticity (e.g., because of amplitude-dependent stiffness or nonlinear constitutive terms), higher harmonics appear in the stress response at odd multiples of the excitation frequency (for example $3\\omega$, $5\\omega$), and the apparent moduli $E'$ and $E''$ become amplitude dependent.\n\nYour method must:\n- Generate strain-controlled DMA signals $\\varepsilon(t)=\\varepsilon_{0}\\sin(\\omega t)$ with frequency $f$ (in $\\mathrm{Hz}$) and angular frequency $\\omega=2\\pi f$ (in $\\mathrm{rad/s}$).\n- Generate stress signals $\\sigma(t)$ for a generalized viscoelastic response that includes a linear Kelvin–Voigt part and a cubic nonlinearity:\n  $$\\sigma(t)=E\\,\\varepsilon(t)+\\eta\\,\\dot{\\varepsilon}(t)+k_{3}\\,\\varepsilon(t)^{3},$$\n  where $E$ is the elastic modulus (in $\\mathrm{MPa}$), $\\eta$ is the viscosity (in $\\mathrm{MPa\\cdot s}$), and $k_{3}$ is the cubic stiffness coefficient (in $\\mathrm{MPa}$). The strain $\\varepsilon$ is dimensionless, and time $t$ is in $\\mathrm{s}$, with angles measured in radians.\n\n- Extract the fundamental (at $\\omega$) and higher harmonic components (at $3\\omega$ and $5\\omega$) of the stress response by orthogonal projection onto $\\sin(n\\omega t)$ and $\\cos(n\\omega t)$ for $n\\in\\{1,3,5\\}$ over an integer number of cycles. From the $n=1$ components, determine the storage and loss moduli via the in-phase (sine) and quadrature (cosine) projections normalized by $\\varepsilon_{0}$.\n\n- Quantify the Linear Viscoelastic Range (LVR) at a given frequency $f$ using two simultaneous criteria:\n  (a) Harmonic purity: For each tested $\\varepsilon_{0}$, the ratio $R_{3} = A_{3}/A_{1}$ and $R_{5} = A_{5}/A_{1}$ must satisfy $R_{3}\\le r_{\\max}$ and $R_{5}\\le r_{\\max}$, where $A_{n}$ is the amplitude of the $n$th harmonic of $\\sigma(t)$ obtained from the orthogonal projections.\n  (b) Amplitude-invariance of moduli: Let $E'_{\\text{ref}}$ and $E''_{\\text{ref}}$ denote the storage and loss moduli at the smallest tested amplitude $\\varepsilon_{0,\\min}$. For a tested $\\varepsilon_{0}$ to be acceptable, both relative deviations must satisfy\n  $$\\left|\\frac{E'(\\varepsilon_{0})-E'_{\\text{ref}}}{E'_{\\text{ref}}}\\right|\\le \\tau_{\\mathrm{mod}},\\quad \\left|\\frac{E''(\\varepsilon_{0})-E''_{\\text{ref}}}{E''_{\\text{ref}}}\\right|\\le \\tau_{\\mathrm{mod}}.$$\n\n- Define the acceptable strain amplitude range as the largest contiguous range starting from the minimum tested amplitude up to the largest amplitude for which both criteria (a) and (b) hold.\n\nImplementation details:\n- Use numerical signals sampled uniformly over an integer number of cycles to ensure orthogonality of projections. Use at least $N_{\\mathrm{ppc}}=1024$ samples per cycle and $N_{\\mathrm{cyc}}=8$ cycles, so the total number of samples is $N= N_{\\mathrm{ppc}}\\times N_{\\mathrm{cyc}}$. Use time in $\\mathrm{s}$ and angles in radians.\n- Extract harmonic coefficients by discrete-time orthogonal projection. For a signal $x(t)$, define the sine and cosine projections at angular frequency $\\Omega$ as:\n  $$C_{\\sin}(\\Omega)=\\frac{2}{T}\\int_{0}^{T} x(t)\\sin(\\Omega t)\\,dt,\\quad C_{\\cos}(\\Omega)=\\frac{2}{T}\\int_{0}^{T} x(t)\\cos(\\Omega t)\\,dt,$$\n  and in discrete time approximate these integrals by uniform-sampling Riemann sums. The amplitude at that harmonic is $A=\\sqrt{C_{\\sin}^{2}+C_{\\cos}^{2}}$. For $n=1$, define\n  $$E'=\\frac{C_{\\sin}(\\omega)}{\\varepsilon_{0}},\\quad E''=\\frac{C_{\\cos}(\\omega)}{\\varepsilon_{0}}.$$\n\n- Angle unit: radians. Frequency unit: $\\mathrm{Hz}$. Stress unit: $\\mathrm{MPa}$. Strain is dimensionless.\n\nYour program must apply this method to the following test suite. For each test case, use the same amplitude sweep\n$\\varepsilon_{0}\\in\\left\\{1.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-3},\\,1.0\\times 10^{-2}\\right\\}$ (dimensionless). Adopt $r_{\\max}=2.0\\times 10^{-2}$ and $\\tau_{\\mathrm{mod}}=1.0\\times 10^{-1}$.\n\nTest suite:\n- Case A (pure linear Kelvin–Voigt): $E=1.5\\,\\mathrm{MPa}$, $\\eta=0.8\\,\\mathrm{MPa\\cdot s}$, $k_{3}=0\\,\\mathrm{MPa}$, $f=1.0\\,\\mathrm{Hz}$.\n- Case B (weak cubic nonlinearity): $E=1.5\\,\\mathrm{MPa}$, $\\eta=0.8\\,\\mathrm{MPa\\cdot s}$, $k_{3}=4.2\\times 10^{3}\\,\\mathrm{MPa}$, $f=1.0\\,\\mathrm{Hz}$.\n- Case C (stronger cubic nonlinearity): $E=1.5\\,\\mathrm{MPa}$, $\\eta=0.8\\,\\mathrm{MPa\\cdot s}$, $k_{3}=2.0\\times 10^{4}\\,\\mathrm{MPa}$, $f=1.0\\,\\mathrm{Hz}$.\n\nFor each case, determine the maximum acceptable strain amplitude (dimensionless) in the sense defined above. If no amplitude satisfies both criteria, return $0.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC]\"), where each result is the maximum acceptable strain amplitude (dimensionless) for Cases A, B, and C, respectively. The numbers must be printed as plain decimal floats (dimensionless). No additional text should be printed.", "solution": "The problem posed is a well-defined computational exercise in solid mechanics, specifically in the characterization of material viscoelasticity. The task is to implement a specific, quantitative algorithm to determine the linear viscoelastic range (LVR) of a material from simulated Dynamic Mechanical Analysis (DMA) data. The problem is scientifically sound, internally consistent, and contains all necessary information for its resolution. We shall proceed with the solution.\n\nThe core of the problem is to distinguish between linear and nonlinear viscoelastic responses. A material is considered linear viscoelastic if, under a sinusoidal strain input $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$, the resultant stress $\\sigma(t)$ is also sinusoidal at the same angular frequency $\\omega$, possibly with a phase shift $\\delta$. This behavior is described by the complex modulus $E^{*}(\\omega) = E'(\\omega) + iE''(\\omega)$, where the storage modulus $E'$ and loss modulus $E''$ are independent of the strain amplitude $\\varepsilon_{0}$. When the material response becomes nonlinear, which typically occurs at larger strain amplitudes, the stress signal becomes distorted. This distortion manifests as the appearance of higher-order harmonics (at frequencies $3\\omega$, $5\\omega$, etc.) in the stress spectrum and a dependency of the apparent moduli $E'$ and $E''$ on $\\varepsilon_{0}$.\n\nThe algorithm to be implemented follows these principles.\n\nFirst, we generate the necessary time-domain signals. A discrete time vector $t$ is created over an integer number of cycles $N_{\\mathrm{cyc}}=8$ with a sufficient number of samples per cycle $N_{\\mathrm{ppc}}=1024$ to prevent aliasing and ensure accurate integration. The total number of points is $N=N_{\\mathrm{ppc}} \\times N_{\\mathrm{cyc}}$, and the total duration is $T = N_{\\mathrm{cyc}} / f$, where $f=1.0\\,\\mathrm{Hz}$ is the test frequency. For each strain amplitude $\\varepsilon_0$ in the specified sweep, the strain signal $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$ and its time derivative $\\dot{\\varepsilon}(t) = \\varepsilon_{0}\\omega\\cos(\\omega t)$ are computed, with $\\omega=2\\pi f$. The corresponding stress signal $\\sigma(t)$ is then synthesized using the provided generalized Kelvin-Voigt model with a cubic nonlinearity:\n$$\n\\sigma(t) = E\\,\\varepsilon(t) + \\eta\\,\\dot{\\varepsilon}(t) + k_{3}\\,\\varepsilon(t)^{3}\n$$\nwhere the parameters $E$, $\\eta$, and $k_3$ are given for each test case.\n\nSecond, we analyze the harmonic content of the generated stress signal $\\sigma(t)$. This is achieved by orthogonal projection, which is numerically implemented as a discrete Fourier analysis. For each harmonic of interest, with angular frequency $\\Omega_n = n\\omega$ for $n \\in \\{1, 3, 5\\}$, we compute the sine and cosine projection coefficients:\n$$\nC_{\\sin}(n\\omega) = \\frac{2}{N} \\sum_{i=0}^{N-1} \\sigma(t_i) \\sin(n\\omega t_i)\n$$\n$$\nC_{\\cos}(n\\omega) = \\frac{2}{N} \\sum_{i=0}^{N-1} \\sigma(t_i) \\cos(n\\omega t_i)\n$$\nThese formulae are the discrete-time equivalents of the continuous-time integral definitions provided in the problem, arising from a Riemann sum approximation over $N$ uniform samples. The amplitude of the $n$-th harmonic is then $A_n = \\sqrt{C_{\\sin}(n\\omega)^2 + C_{\\cos}(n\\omega)^2}$.\n\nFrom the fundamental harmonic ($n=1$) projections, the apparent storage and loss moduli are determined as:\n$$\nE'(\\varepsilon_0) = \\frac{C_{\\sin}(\\omega)}{\\varepsilon_0}\n$$\n$$\nE''(\\varepsilon_0) = \\frac{C_{\\cos}(\\omega)}{\\varepsilon_0}\n$$\nThese calculations are performed for every strain amplitude $\\varepsilon_0$ in the sweep.\n\nThird, we apply the two criteria to define the LVR. For each amplitude $\\varepsilon_0$:\n1.  **Harmonic Purity Criterion**: The ratios of the amplitudes of the $3$rd and $5$th harmonics to the fundamental, $R_3 = A_3/A_1$ and $R_5 = A_5/A_1$, must not exceed a tolerance $r_{\\max} = 2.0 \\times 10^{-2}$.\n2.  **Modulus Invariance Criterion**: The relative deviations of the storage and loss moduli from their reference values, $E'_{\\mathrm{ref}}$ and $E''_{\\mathrm{ref}}$ (measured at the lowest strain amplitude $\\varepsilon_{0,\\min}$), must not exceed a tolerance $\\tau_{\\mathrm{mod}} = 1.0 \\times 10^{-1}$. The conditions are:\n    $$\n    \\left|\\frac{E'(\\varepsilon_{0}) - E'_{\\mathrm{ref}}}{E'_{\\mathrm{ref}}}\\right| \\le \\tau_{\\mathrm{mod}} \\quad \\text{and} \\quad \\left|\\frac{E''(\\varepsilon_{0}) - E''_{\\mathrm{ref}}}{E''_{\\mathrm{ref}}}\\right| \\le \\tau_{\\mathrm{mod}}\n    $$\n\nFinally, the LVR is determined as the largest contiguous range of strain amplitudes, starting from $\\varepsilon_{0,\\min}$, for which both criteria are simultaneously satisfied. The algorithm iterates through the amplitudes in ascending order. The maximum acceptable strain amplitude is the largest value in this contiguous range. If the conditions are not met even for the smallest amplitude, the result is $0.0$. This procedure is systematically applied to each test case to derive the required results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of determining the linear viscoelastic range (LVR)\n    for materials under dynamic loading based on specified criteria.\n    \"\"\"\n\n    def calculate_max_strain(params):\n        \"\"\"\n        Calculates the maximum acceptable strain amplitude for a single test case.\n\n        Args:\n            params (dict): A dictionary containing material and test parameters:\n                           E, eta, k3, f, amplitudes, r_max, tau_mod.\n\n        Returns:\n            float: The maximum acceptable strain amplitude.\n        \"\"\"\n        # Unpack parameters\n        E = params['E']\n        eta = params['eta']\n        k3 = params['k3']\n        f = params['f']\n        amplitudes = params['amplitudes']\n        r_max = params['r_max']\n        tau_mod = params['tau_mod']\n\n        # Simulation parameters\n        N_ppc = 1024\n        N_cyc = 8\n        N = N_ppc * N_cyc\n        \n        # Time and frequency setup\n        omega = 2.0 * np.pi * f\n        T = N_cyc / f\n        dt = T / N\n        t = np.arange(N) * dt\n\n        # Store results for each amplitude\n        results_per_amp = []\n\n        for eps0 in amplitudes:\n            # Generate signals\n            strain = eps0 * np.sin(omega * t)\n            strain_rate = eps0 * omega * np.cos(omega * t)\n            stress = E * strain + eta * strain_rate + k3 * (strain**3)\n\n            harmonic_data = {}\n            for n in [1, 3, 5]:\n                omega_n = n * omega\n                \n                # Orthogonal projection using discrete summation\n                sin_proj = (2.0 / N) * np.sum(stress * np.sin(omega_n * t))\n                cos_proj = (2.0 / N) * np.sum(stress * np.cos(omega_n * t))\n                \n                amplitude_n = np.sqrt(sin_proj**2 + cos_proj**2)\n                \n                harmonic_data[n] = {\n                    'sin_proj': sin_proj,\n                    'cos_proj': cos_proj,\n                    'amp': amplitude_n\n                }\n\n            # Calculate moduli from fundamental harmonic\n            E_prime = harmonic_data[1]['sin_proj'] / eps0\n            E_double_prime = harmonic_data[1]['cos_proj'] / eps0\n\n            results_per_amp.append({\n                'eps0': eps0,\n                'E_prime': E_prime,\n                'E_double_prime': E_double_prime,\n                'A1': harmonic_data[1]['amp'],\n                'A3': harmonic_data[3]['amp'],\n                'A5': harmonic_data[5]['amp']\n            })\n\n        # Apply LVR criteria\n        if not results_per_amp:\n            return 0.0\n\n        # Reference values from the smallest amplitude\n        ref_result = results_per_amp[0]\n        E_prime_ref = ref_result['E_prime']\n        E_double_prime_ref = ref_result['E_double_prime']\n        \n        # Handle potential zero reference values, though not expected here\n        if E_prime_ref == 0.0 or E_double_prime_ref == 0.0:\n            # This case implies a purely viscous or elastic material with zero E' or E''.\n            # The relative error check is ill-defined. Based on problem context, this won't happen.\n            # But for robustness, we can assume failure.\n            return 0.0\n\n        max_acceptable_amplitude = 0.0\n        \n        for res in results_per_amp:\n            # Check harmonic purity\n            A1 = res['A1']\n            if A1 == 0: # Avoid division by zero\n                harmonic_ok = False\n            else:\n                R3 = res['A3'] / A1\n                R5 = res['A5'] / A1\n                harmonic_ok = (R3 <= r_max) and (R5 <= r_max)\n\n            # Check modulus invariance\n            E_prime_dev = abs((res['E_prime'] - E_prime_ref) / E_prime_ref)\n            E_double_prime_dev = abs((res['E_double_prime'] - E_double_prime_ref) / E_double_prime_ref)\n            moduli_ok = (E_prime_dev <= tau_mod) and (E_double_prime_dev <= tau_mod)\n\n            # Check combined criteria for contiguous range\n            if harmonic_ok and moduli_ok:\n                max_acceptable_amplitude = res['eps0']\n            else:\n                # Break at the first amplitude that fails, as we need a contiguous range\n                break\n        \n        return max_acceptable_amplitude\n\n\n    # Shared parameters for all test cases\n    shared_params = {\n        'amplitudes': np.array([1.0e-4, 5.0e-4, 1.0e-3, 5.0e-3, 1.0e-2]),\n        'r_max': 2.0e-2,\n        'tau_mod': 1.0e-1,\n        'f': 1.0,\n    }\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {'E': 1.5, 'eta': 0.8, 'k3': 0.0},  # Case A\n        {'E': 1.5, 'eta': 0.8, 'k3': 4.2e3}, # Case B\n        {'E': 1.5, 'eta': 0.8, 'k3': 2.0e4}, # Case C\n    ]\n    \n    final_results = []\n    for case_params in test_cases:\n        full_params = {**shared_params, **case_params}\n        result = calculate_max_strain(full_params)\n        final_results.append(result)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "2623338"}]}