{"hands_on_practices": [{"introduction": "This chapter begins with a foundational exercise designed to build your intuition for the limit analysis theorems. We will analyze a simple two-bar truss, applying both the static (lower bound) and kinematic (upper bound) theorems to determine its collapse load. By constructing both a statically admissible force field and a kinematically admissible collapse mechanism, you will demonstrate how these two powerful methods bracket and, in this ideal determinate case, precisely identify the exact solution [@problem_id:2654975]. This practice is essential for solidifying the theoretical underpinnings of limit analysis before we tackle more complex systems.", "problem": "A pin-jointed two-bar truss supports a vertical load at its apex. The two identical bars are connected at their lower ends to fixed, frictionless pins located at coordinates $\\left(-a,\\,0\\right)$ and $\\left(+a,\\,0\\right)$ in a Cartesian frame, and they meet at the apex joint at $\\left(0,\\,h\\right)$. Each bar has constant cross-sectional area $A$ and obeys a rigid, ideally plastic, rate-independent uniaxial constitutive behavior with yield stress $\\sigma_{y}$ in both tension and compression. The bars carry only axial force, are perfectly braced against instability, and geometric changes are small so that first-order kinematics and equilibrium are valid for virtual work statements.\n\nA downward vertical load $P=\\lambda\\,P_{0}$ is applied at the apex, where $P_{0}0$ is a fixed reference load and $\\lambda$ is a non-dimensional load factor. The truss collapses when a plastic mechanism forms with bars at their yield condition $|N|\\le N_{p}$, where $N$ is the axial force in a bar and $N_{p}=\\sigma_{y}A$ is the plastic axial capacity.\n\nUsing only the foundational principles of equilibrium, compatibility, the definition of the plastic axial capacity, and the statements of the lower bound (static) and upper bound (kinematic) theorems of limit analysis:\n\n- Construct a statically admissible axial force field that satisfies equilibrium of the apex joint and the yield condition in the two bars, and deduce a lower bound on the collapse load factor $\\lambda$.\n- Construct a kinematically admissible collapse mechanism with a consistent virtual velocity field at the apex and fixed supports, invoke the principle of virtual work and the principle of maximum plastic dissipation for rigid, ideally plastic behavior to deduce an upper bound on $\\lambda$.\n- Show that, when the stress field and mechanism are chosen consistently with the geometry and the yield surface, the lower and upper bounds coincide, thereby yielding the exact critical load factor $\\lambda_{c}$.\n\nExpress the exact $\\lambda_{c}$ as a closed-form analytic expression in terms of $a$, $h$, $A$, $\\sigma_{y}$, and $P_{0}$. Do not perform any numerical substitutions. Your final answer must be a single analytic expression for $\\lambda_{c}$ without units.", "solution": "We begin by recording the basic geometric and mechanical facts. The bar from $\\left(-a,\\,0\\right)$ to $\\left(0,\\,h\\right)$ and the bar from $\\left(+a,\\,0\\right)$ to $\\left(0,\\,h\\right)$ are identical, each having length\n$$\nL=\\sqrt{a^{2}+h^{2}}.\n$$\nLet $\\mathbf{e}_{1}$ and $\\mathbf{e}_{2}$ be unit vectors along the bars from the lower supports to the apex joint. By geometry,\n$$\n\\mathbf{e}_{1}=\\left(\\frac{a}{L},\\,\\frac{h}{L}\\right),\\qquad \\mathbf{e}_{2}=\\left(-\\frac{a}{L},\\,\\frac{h}{L}\\right).\n$$\nLet the unknown axial force in each bar be $N_{1}$ and $N_{2}$, taken positive in tension along $\\mathbf{e}_{1}$ and $\\mathbf{e}_{2}$, respectively. The applied load at the apex is $\\mathbf{P}=(0,\\,-P)$ with $P=\\lambda P_{0}0$.\n\nLower bound (static theorem). The lower bound theorem asserts that if there exists a statically admissible field of internal forces that satisfies global equilibrium with the applied load and the yield condition $|N_{i}|\\le N_{p}$ everywhere, then the associated load is a safe estimate that does not exceed the true collapse load. For the pin-jointed truss, equilibrium at the apex requires\n$$\nN_{1}\\,\\mathbf{e}_{1}+N_{2}\\,\\mathbf{e}_{2}+\\mathbf{P}=\\mathbf{0}.\n$$\nBy symmetry of geometry and loading, a statically admissible choice is $N_{1}=N_{2}=N$. Projecting onto the vertical direction,\n$$\nN\\left(\\frac{h}{L}\\right)+N\\left(\\frac{h}{L}\\right)-P=0\\quad\\Longrightarrow\\quad 2N\\frac{h}{L}=P.\n$$\nImposing the yield constraint $|N|\\le N_{p}=\\sigma_{y}A$ and seeking the largest admissible $P$ gives the lower bound when $N=+N_{p}$:\n$$\nP_{\\mathrm{LB}}=2N_{p}\\frac{h}{L}=2\\,\\sigma_{y}A\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\nHence the lower bound on the load factor is\n$$\n\\lambda_{\\mathrm{LB}}=\\frac{P_{\\mathrm{LB}}}{P_{0}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n\nUpper bound (kinematic theorem). The upper bound theorem asserts that for any kinematically admissible velocity field that is compatible with supports and mechanisms, the external power equals the internal plastic dissipation at collapse, and this provides an upper bound on the collapse load. For a rate-independent rigid, ideally plastic material with a convex symmetric yield surface $|N|\\le N_{p}$ in one dimension, the principle of maximum plastic dissipation implies that, for a prescribed axial plastic extension rate $\\dot{\\Delta}$, the internal power in each bar attains the maximum value $N_{p}\\,|\\dot{\\Delta}|$ when the axial force takes the value $N=N_{p}\\,\\mathrm{sign}(\\dot{\\Delta})$.\n\nChoose a kinematically admissible mechanism in which the apex has a vertical velocity $\\mathbf{v}=(0,\\,-v)$ with $v0$, while the supports are fixed. The small-deformation compatibility gives the axial rate in each bar as the projection of the relative velocity of the apex on the barâ€™s unit axis:\n$$\n\\dot{\\Delta}_{1}=\\mathbf{v}\\cdot\\mathbf{e}_{1}=(0,\\,-v)\\cdot\\left(\\frac{a}{L},\\,\\frac{h}{L}\\right)=-v\\,\\frac{h}{L},\\qquad\n\\dot{\\Delta}_{2}=\\mathbf{v}\\cdot\\mathbf{e}_{2}=(0,\\,-v)\\cdot\\left(-\\frac{a}{L},\\,\\frac{h}{L}\\right)=-v\\,\\frac{h}{L}.\n$$\nTherefore, the total internal plastic dissipation rate is\n$$\n\\dot{W}_{\\mathrm{int}}=N_{p}\\,|\\dot{\\Delta}_{1}|+N_{p}\\,|\\dot{\\Delta}_{2}|=2\\,N_{p}\\,\\left(\\frac{v\\,h}{L}\\right)=2\\,\\sigma_{y}A\\,\\frac{v\\,h}{\\sqrt{a^{2}+h^{2}}}.\n$$\nThe external power is the product of the applied load and the compatible velocity in the direction of the load:\n$$\n\\dot{W}_{\\mathrm{ext}}=P\\,v=\\lambda P_{0}\\,v.\n$$\nEquating external power and internal dissipation at collapse gives the kinematic upper bound\n$$\n\\lambda_{\\mathrm{UB}}\\,P_{0}\\,v=2\\,\\sigma_{y}A\\,\\frac{v\\,h}{\\sqrt{a^{2}+h^{2}}}\\quad\\Longrightarrow\\quad \\lambda_{\\mathrm{UB}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n\nCoincidence of bounds and exactness. The lower bound and upper bound derived above are equal:\n$$\n\\lambda_{\\mathrm{LB}}=\\lambda_{\\mathrm{UB}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\nThis equality occurs because the statically admissible field and the kinematically admissible mechanism are consistent with the geometry and the symmetric yield surface: both bars are activated, and the directions of axial plastic flow selected in the kinematic analysis are those that maximize dissipation subject to $|N|\\le N_{p}$, which is dual to the static field that saturates $|N|=N_{p}$ and satisfies equilibrium. By the fundamental theorems of limit analysis, when a common value is obtained from both bounds, it is the exact collapse load factor $\\lambda_{c}$.\n\nTherefore, the exact critical load factor is\n$$\n\\lambda_{c}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$", "answer": "$$\\boxed{2\\,\\dfrac{\\sigma_{y}A}{P_{0}}\\,\\dfrac{h}{\\sqrt{a^{2}+h^{2}}}}$$", "id": "2654975"}, {"introduction": "In our final exercise, we generalize the computational approach from discrete structures to continua, addressing a more complex material behavior. You will formulate the lower bound limit analysis for a two-dimensional body under the von Mises yield condition as a Second-Order Cone Program (SOCP) [@problem_id:2654990]. This advanced practice bridges the gap between plasticity theory and contemporary numerical optimization, equipping you with the tools to analyze the plastic collapse of continuous media, a critical skill in advanced mechanical and civil engineering applications.", "problem": "Consider the lower bound (static) theorem of limit analysis for a two-dimensional continuum discretized into a finite number of constant-stress elements. Let the vector of unknown element stresses be $s \\in \\mathbb{R}^{3 n_{\\mathrm{el}}}$, where each element $e$ contributes the triplet $s_e = [\\sigma_{xx}^{(e)}, \\sigma_{yy}^{(e)}, \\sigma_{xy}^{(e)}]^{\\mathsf{T}}$. The discretized equilibrium in the weak form is modeled by a full-rank linear system $A s = \\lambda f$, where $A \\in \\mathbb{R}^{3 n_{\\mathrm{el}} \\times 3 n_{\\mathrm{el}}}$ is the assembled equilibrium operator, $f \\in \\mathbb{R}^{3 n_{\\mathrm{el}}}$ represents a fixed load pattern, and $\\lambda \\ge 0$ is the load factor to be maximized. Assume plane stress so that $\\sigma_{zz}^{(e)} = 0$ for all elements.\n\nThe material obeys the von Mises yield condition. In continuum form, von Mises yielding can be expressed as $\\|\\mathrm{dev}\\,\\sigma\\|_{F} \\le \\sqrt{2/3}\\,\\sigma_{y}$, where $\\mathrm{dev}\\,\\sigma$ is the deviatoric part of the Cauchy stress tensor and $\\sigma_{y}$ is the yield stress. Under plane stress ($\\sigma_{zz}=0$), this is equivalent to the inequality $\\sigma_{\\mathrm{eq}}(\\sigma_{xx},\\sigma_{yy},\\sigma_{xy}) \\le \\sigma_{y}$, where the von Mises equivalent stress is defined by\n$$\n\\sigma_{\\mathrm{eq}}^2 = \\sigma_{xx}^2 - \\sigma_{xx}\\sigma_{yy} + \\sigma_{yy}^2 + 3\\,\\sigma_{xy}^2.\n$$\nDefine the matrix\n$$\nH \\equiv \\begin{bmatrix}\n1  -\\tfrac{1}{2}  0 \\\\\n-\\tfrac{1}{2}  1  0 \\\\\n0  0  3\n\\end{bmatrix},\n$$\nso that for each element $e$, if $z_e \\equiv \\begin{bmatrix}\\sigma_{xx}^{(e)}  \\sigma_{yy}^{(e)}  \\sigma_{xy}^{(e)}\\end{bmatrix}^{\\mathsf{T}}$, then $\\sigma_{\\mathrm{eq}}(s_e)^2 = z_e^{\\mathsf{T}} H z_e$. The matrix $H$ is symmetric positive definite, hence there exists a (not necessarily unique) matrix $L \\in \\mathbb{R}^{3 \\times 3}$ such that $H = L^{\\mathsf{T}} L$ (for example, the Cholesky factor). Therefore, the per-element von Mises constraint is equivalently expressed as the second-order cone (Euclidean norm) constraint $\\|L z_e\\|_2 \\le \\sigma_{y,e}$.\n\nTasks:\n1) Starting only from the definitions above, derive the following optimization model for the lower bound problem:\n- Decision variables: the stacked stress vector $s \\in \\mathbb{R}^{3 n_{\\mathrm{el}}}$ and the scalar load factor $\\lambda \\in \\mathbb{R}$.\n- Objective: maximize $\\lambda$.\n- Constraints: $A s = \\lambda f$ and, for each element $e$, $\\|L z_e\\|_2 \\le \\sigma_{y,e}$. Explicitly justify that this is a second-order cone program (SOCP) by identifying linear and second-order cone constraints, and by connecting $\\|\\mathrm{dev}\\,\\sigma\\|_{F} \\le \\sqrt{2/3}\\,\\sigma_{y}$ in plane stress to $\\|L z_e\\|_2 \\le \\sigma_{y,e}$ using the positive definiteness of $H$.\n\n2) For the specific case where $A$ is square and invertible, show that the unique stress field corresponding to $\\lambda=1$ is $S \\equiv A^{-1} f$, so that for general $\\lambda$ any feasible stress must satisfy $s = \\lambda S$. Deduce that the optimal load factor is\n$$\n\\lambda^\\star = \\min_{e=1,\\dots,n_{\\mathrm{el}}} \\frac{\\sigma_{y,e}}{\\sigma_{\\mathrm{eq}}(S_e)},\n$$\nwhere $S_e$ extracts the three components corresponding to element $e$ from $S$ and $\\sigma_{\\mathrm{eq}}(\\cdot)$ is the von Mises equivalent stress defined above. Conclude that this is the exact optimal value of the SOCP when $A$ is invertible.\n\n3) Implement a program that, for each test case below, computes the optimal load factor $\\lambda^\\star$ using the formula from Task 2. All quantities in the test suite are nondimensionalized; no physical units are used. Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, with each number rounded to $9$ decimal places (for example, $[0.123000000,1.000000000,3.141592654]$).\n\nTest suite:\n- Case 1 (single element): $n_{\\mathrm{el}}=1$, $A = \\begin{bmatrix} 2  -1  0 \\\\ 0  1  2 \\\\ 1  0  -1 \\end{bmatrix}$, $f = \\begin{bmatrix} 1 \\\\ 2 \\\\ 0.5 \\end{bmatrix}$, $\\sigma_{y,1} = 1.0$.\n- Case 2 (two elements, block diagonal equilibrium): $n_{\\mathrm{el}}=2$, $A = \\mathrm{diag}(A_0,A_0)$ with $A_0 = \\begin{bmatrix} 2  -1  0 \\\\ 0  1  2 \\\\ 1  0  -1 \\end{bmatrix}$, and $f = \\begin{bmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 2 \\\\ -1 \\\\ 1 \\end{bmatrix}$, $\\sigma_{y} = \\begin{bmatrix} 1.2 \\\\ 1.0 \\end{bmatrix}$.\n- Case 3 (two elements with matched active constraints): same $A$ and $f$ as Case 2, and $\\sigma_{y} = \\begin{bmatrix} 1.5\\sqrt{1.75} \\\\ 1.5\\sqrt{1.375} \\end{bmatrix}$.\n\nYour program should output a single line in the exact format: a Python-style list of the three computed $\\lambda^\\star$ values, rounded to $9$ decimal places, in the order of the cases, i.e., $[\\lambda^\\star_{\\text{Case 1}},\\lambda^\\star_{\\text{Case 2}},\\lambda^\\star_{\\text{Case 3}}]$.", "solution": "**Task 1: Derivation of the SOCP Model**\n\nThe lower bound theorem seeks the maximum load factor $\\lambda$ for which a stress field exists that is both statically admissible (satisfies equilibrium) and plastically admissible (does not violate the yield criterion).\n\n- **Objective:** The goal is to find the highest possible load, so we maximize the load factor $\\lambda$:\n  $$ \\text{maximize} \\quad \\lambda $$\n- **Decision Variables:** The variables are the stacked vector of element stresses $s \\in \\mathbb{R}^{3 n_{\\mathrm{el}}}$ and the scalar load factor $\\lambda \\in \\mathbb{R}$.\n- **Constraints:**\n  1.  **Equilibrium (Linear Constraint):** The stress field must be in equilibrium with the applied loads. This is given by the linear equality constraint:\n      $$ A s = \\lambda f \\quad \\text{or} \\quad A s - \\lambda f = 0 $$\n  2.  **Yield (Second-Order Cone Constraints):** The stress in each element must not violate the von Mises yield criterion. For each element $e$, with stress vector $z_e$, this is $\\sigma_{\\mathrm{eq}}(z_e) \\le \\sigma_{y,e}$, which is equivalent to $\\sigma_{\\mathrm{eq}}(z_e)^2 \\le \\sigma_{y,e}^2$. Using the provided matrix $H$, this becomes:\n      $$ z_e^{\\mathsf{T}} H z_e \\le \\sigma_{y,e}^2 $$\n      The matrix $H$ is symmetric positive definite (its eigenvalues are $\\{3/2, 1/2, 3\\}$, all positive), so it admits a factorization $H = L^{\\mathsf{T}} L$. The constraint can be rewritten as:\n      $$ (L z_e)^{\\mathsf{T}} (L z_e) = \\|L z_e\\|_2^2 \\le \\sigma_{y,e}^2 $$\n      Taking the square root gives the standard second-order cone (SOC) constraint for each element:\n      $$ \\|L z_e\\|_2 \\le \\sigma_{y,e} $$\n\nThe complete optimization model is therefore:\n$$\n\\begin{array}{lcl}\n\\underset{s, \\lambda}{\\text{maximize}}  \\lambda  \\\\\n\\text{subject to}  A s - \\lambda f = 0  (\\text{Linear equality constraints}) \\\\\n \\|L z_e\\|_2 \\le \\sigma_{y,e}, \\quad e=1, \\dots, n_{\\mathrm{el}}  (\\text{Second-order cone constraints})\n\\end{array}\n$$\nThis is a Second-Order Cone Program (SOCP) because it has a linear objective function, linear equality constraints, and second-order cone constraints.\n\n**Task 2: Solution for Invertible A**\n\nWhen the equilibrium matrix $A$ is square and invertible, we can uniquely solve the equilibrium equation for the stress vector $s$ in terms of $\\lambda$:\n$$\ns = A^{-1}(\\lambda f) = \\lambda (A^{-1} f)\n$$\nDefine a reference stress vector $S \\equiv A^{-1} f$. This corresponds to the stress field for a unit load factor ($\\lambda=1$). Any feasible stress field must be of the form $s = \\lambda S$, which implies element stress vectors $z_e = \\lambda S_e$.\n\nSubstituting this into the yield constraints from Task 1:\n$$\n\\|L (\\lambda S_e)\\|_2 \\le \\sigma_{y,e} \\implies \\lambda \\|L S_e\\|_2 \\le \\sigma_{y,e}\n$$\nAs established in the problem, $\\|L S_e\\|_2 = \\sqrt{S_e^{\\mathsf{T}} H S_e} = \\sigma_{\\mathrm{eq}}(S_e)$. The constraint for each element is:\n$$\n\\lambda \\, \\sigma_{\\mathrm{eq}}(S_e) \\le \\sigma_{y,e} \\implies \\lambda \\le \\frac{\\sigma_{y,e}}{\\sigma_{\\mathrm{eq}}(S_e)}\n$$\nTo satisfy this for all elements, $\\lambda$ must be less than or equal to the minimum of these ratios. Maximizing $\\lambda$ means we take the equality:\n$$\n\\lambda^\\star = \\min_{e=1,\\dots,n_{\\mathrm{el}}} \\frac{\\sigma_{y,e}}{\\sigma_{\\mathrm{eq}}(S_e)}\n$$\nThis is the exact optimal load factor, as any larger value would violate the yield condition in at least one element.\n\n**Task 3: Numerical Results**\n\nUsing the formula from Task 2, we calculate $\\lambda^\\star$ for each case. The core steps are to solve $A S = f$ for the reference stress $S$, calculate the equivalent stress $\\sigma_{\\mathrm{eq}}(S_e)$ for each element, and find the minimum ratio $\\sigma_{y,e} / \\sigma_{\\mathrm{eq}}(S_e)$.\n\n**Case 1:**\n- $A = \\begin{bmatrix} 2  -1  0 \\\\ 0  1  2 \\\\ 1  0  -1 \\end{bmatrix}$, $f = \\begin{bmatrix} 1 \\\\ 2 \\\\ 0.5 \\end{bmatrix}$, $\\sigma_{y,1} = 1.0$.\n- Solving $AS = f$ gives $S = S_1 = \\begin{bmatrix} 1  1  0.5 \\end{bmatrix}^{\\mathsf{T}}$.\n- $\\sigma_{\\mathrm{eq}}(S_1)^2 = 1^2 - 1(1) + 1^2 + 3(0.5)^2 = 1.75$. So, $\\sigma_{\\mathrm{eq}}(S_1) = \\sqrt{1.75}$.\n- $\\lambda^\\star = \\frac{1.0}{\\sqrt{1.75}} \\approx 0.755928946$.\n\n**Case 2:**\n- The system is uncoupled for two elements.\n- Element 1: $f_1 = \\begin{bmatrix} 1  2  0.5 \\end{bmatrix}^{\\mathsf{T}}$, $\\sigma_{y,1} = 1.2$. This gives $S_1 = \\begin{bmatrix} 1  1  0.5 \\end{bmatrix}^{\\mathsf{T}}$ and $\\sigma_{\\mathrm{eq}}(S_1) = \\sqrt{1.75}$. The ratio is $\\frac{1.2}{\\sqrt{1.75}} \\approx 0.907114735$.\n- Element 2: $f_2 = \\begin{bmatrix} 2  -1  1 \\end{bmatrix}^{\\mathsf{T}}$, $\\sigma_{y,2} = 1.0$. This gives $S_2 = \\begin{bmatrix} 0.75  -0.5  -0.25 \\end{bmatrix}^{\\mathsf{T}}$ and $\\sigma_{\\mathrm{eq}}(S_2) = \\sqrt{1.375}$. The ratio is $\\frac{1.0}{\\sqrt{1.375}} \\approx 0.852802865$.\n- $\\lambda^\\star = \\min(0.907114735, 0.852802865) = 0.852802865$.\n\n**Case 3:**\n- $S_1$, $S_2$, and the equivalent stresses are the same as in Case 2.\n- Yield stresses: $\\sigma_{y,1} = 1.5\\sqrt{1.75}$, $\\sigma_{y,2} = 1.5\\sqrt{1.375}$.\n- The ratios are $\\frac{1.5\\sqrt{1.75}}{\\sqrt{1.75}} = 1.5$ and $\\frac{1.5\\sqrt{1.375}}{\\sqrt{1.375}} = 1.5$.\n- $\\lambda^\\star = \\min(1.5, 1.5) = 1.5$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal load factor lambda_star for the given test cases\n    based on the lower bound theorem of limit analysis for an invertible A matrix.\n    \"\"\"\n\n    # Define a function to calculate the von Mises equivalent stress\n    def calc_sigma_eq(s_e):\n        \"\"\"\n        Calculates the von Mises equivalent stress for a given stress vector.\n        s_e: numpy array of shape (3,) with [sigma_xx, sigma_yy, sigma_xy]\n        \"\"\"\n        s_xx, s_yy, s_xy = s_e[0], s_e[1], s_e[2]\n        sigma_eq_sq = s_xx**2 - s_xx * s_yy + s_yy**2 + 3 * s_xy**2\n        return np.sqrt(sigma_eq_sq)\n\n    # --- Test Case 1 ---\n    nel1 = 1\n    A1 = np.array([[2., -1., 0.], [0., 1., 2.], [1., 0., -1.]])\n    f1 = np.array([1., 2., 0.5])\n    sig_y1 = np.array([1.0])\n    case1 = (nel1, A1, f1, sig_y1)\n\n    # --- Test Case 2 ---\n    nel2 = 2\n    A0_case2 = np.array([[2., -1., 0.], [0., 1., 2.], [1., 0., -1.]])\n    A2 = np.block([\n        [A0_case2, np.zeros((3, 3))],\n        [np.zeros((3, 3)), A0_case2]\n    ])\n    f2 = np.array([1., 2., 0.5, 2., -1., 1.])\n    sig_y2 = np.array([1.2, 1.0])\n    case2 = (nel2, A2, f2, sig_y2)\n\n    # --- Test Case 3 ---\n    nel3 = 2\n    A3 = A2 # Same as Case 2\n    f3 = f2 # Same as Case 2\n    sig_y3 = np.array([1.5 * np.sqrt(1.75), 1.5 * np.sqrt(1.375)])\n    case3 = (nel3, A3, f3, sig_y3)\n\n    test_cases = [case1, case2, case3]\n    results = []\n\n    for case in test_cases:\n        n_el, A, f, sig_y = case\n        \n        # Step 1: Compute the reference stress field S = A^{-1} * f\n        # np.linalg.solve is numerically preferred over np.linalg.inv\n        S = np.linalg.solve(A, f)\n        \n        # Step 2: For each element, compute the ratio sigma_y_e / sigma_eq(S_e)\n        ratios = []\n        for e in range(n_el):\n            # Extract the stress components for the current element\n            # Python slicing is exclusive of the end index\n            start_idx = e * 3\n            end_idx = (e + 1) * 3\n            S_e = S[start_idx:end_idx]\n            \n            # Get the yield stress for the current element\n            sig_y_e = sig_y[e]\n            \n            # Calculate the von Mises equivalent stress for S_e\n            sigma_eq_S_e = calc_sigma_eq(S_e)\n            \n            # The ratio gives the collapse load factor for this element\n            if sigma_eq_S_e  1e-12:  # Avoid division by zero\n                ratios.append(sig_y_e / sigma_eq_S_e)\n            else:\n                # If reference stress is zero, this element imposes no limit\n                ratios.append(np.inf)\n        \n        # Step 3: The optimal load factor is the minimum of these ratios\n        lambda_star = np.min(ratios)\n        results.append(lambda_star)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to 9 decimal places.\n    formatted_results = [f\"{r:.9f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2654990"}]}