{"hands_on_practices": [{"introduction": "This first practice serves as a foundational exercise, distilling the shakedown concept to its most essential form. By analyzing a simple, statically determinate uniaxial bar, we explore the shakedown limit in a scenario where the structure cannot develop self-equilibrating residual stresses [@problem_id:2684265]. This deliberate simplification reveals a crucial insight: in the absence of this self-healing mechanism, the condition for elastic shakedown becomes identical to the condition for purely elastic behavior throughout the entire load history.", "problem": "Consider a straight, prismatic bar of length $L$ and constant cross-sectional area $A$, made of an isotropic, rate-independent, small-strain elastic–perfectly plastic (EPP) material with Young’s modulus $E$ and uniaxial yield stress $\\sigma_{y}$ governed by the von Mises yield criterion (which reduces to $|\\sigma|\\le \\sigma_{y}$ in uniaxial stress). The bar is axially loaded in a statically determinate manner between smooth, frictionless axial grips so that only uniform axial stress fields are statically admissible. The applied service loading is stress-controlled and time-periodic with an arbitrary waveform bounded by a mean component and an alternating component, namely the linear-elastic stress response (ignoring plasticity) is\n$$\n\\sigma^{e}(t)=\\sigma_{m}+\\sigma_{a}\\,s(t),\n$$\nwhere $\\sigma_{m}\\in\\mathbb{R}$ is the mean stress, $\\sigma_{a}\\ge 0$ is the alternating amplitude, and $s(t)$ is a bounded dimensionless function with $|s(t)|\\le 1$ for all time $t$ and zero time-mean over a cycle. Assume small strains, associative flow, and no hardening (perfect plasticity).\n\nUsing only first principles, the von Mises yield condition in uniaxial form, and the static (Melan) and kinematic (Koiter) shakedown theorems from plasticity theory, determine the exact analytical expression for the boundary in the $(\\sigma_{m},\\sigma_{a})$-plane that separates elastic shakedown from ratchetting for this bar. Express your final result as a single closed-form expression giving the boundary value of $\\sigma_{a}$ in terms of $\\sigma_{m}$ and $\\sigma_{y}$. No numerical evaluation is required, and no units should be included in the final expression.", "solution": "The problem posed is a fundamental application of the shakedown theorems of plasticity to a simple one-dimensional system. A critical examination of the problem statement is required before proceeding.\n\nFirst, we perform the problem validation.\n\nStep 1: Extract Givens\n- Structure: A straight, prismatic bar of length $L$ and constant cross-sectional area $A$.\n- Material: Isotropic, rate-independent, small-strain elastic–perfectly plastic (EPP).\n- Material Properties: Young’s modulus $E$, uniaxial yield stress $\\sigma_{y}$.\n- Yield Criterion: von Mises, which for uniaxial stress is $|\\sigma| \\le \\sigma_{y}$.\n- Loading & Constraints: Axial, statically determinate, smooth frictionless grips, only uniform axial stress fields are statically admissible.\n- Applied Loading: Stress-controlled, time-periodic.\n- Linear-Elastic Stress Response: $\\sigma^{e}(t) = \\sigma_{m} + \\sigma_{a}\\,s(t)$.\n- Parameters: $\\sigma_{m} \\in \\mathbb{R}$ (mean stress), $\\sigma_{a} \\ge 0$ (alternating amplitude), $s(t)$ is a dimensionless function with $|s(t)| \\le 1$.\n- Assumptions: Small strains, associative flow, no hardening.\n- Objective: Determine the analytical boundary in the $(\\sigma_{m}, \\sigma_{a})$-plane separating elastic shakedown from ratchetting, using Melan's and Koiter's theorems. Express the result for $\\sigma_{a}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a classical scenario in solid mechanics. All required information is provided. The central feature of the problem is the explicit statement that the bar is loaded in a \"statically determinate manner\" such that \"only uniform axial stress fields are statically admissible\". This is not a flaw but a crucial constraint. For a prismatic bar loaded only at its ends, a uniform axial stress field $\\sigma^{r}$ is self-equilibrated if and only if the resultant force on any cross-section is zero, which requires $\\sigma^{r}A = 0$, implying $\\sigma^{r}=0$. Therefore, the system cannot sustain a non-zero residual stress field. This simplification, dictated by the problem statement, makes the problem a specific and well-defined case for shakedown analysis. The problem is valid.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be derived from first principles as required.\n\nNow, we proceed to the solution.\n\nThe central theorem for this analysis is Melan's static shakedown theorem. It states that an elastic-plastic body will shake down (i.e., after some initial plastic deformation, its subsequent response to the load history becomes purely elastic) if a time-independent, self-equilibrated residual stress field $\\sigma^{r}_{ij}$ can be found such that the sum of the elastic stress field $\\sigma^{e}_{ij}(t)$ and the residual stress field is everywhere and at all times within the elastic domain. For the present one-dimensional problem, this condition is expressed as finding a $\\sigma^{r}$ such that:\n$$\n|\\sigma^{e}(t) + \\sigma^{r}| \\le \\sigma_{y}\n$$\nfor all time $t$.\n\nAs established during validation, the problem specifies a statically determinate configuration where the only admissible self-equilibrated stress field is the zero field. Therefore, we must set $\\sigma^{r} = 0$. The capacity for the structure to develop beneficial residual stresses to achieve shakedown from an initially plastic state is absent. In this specific context, \"elastic shakedown\" can only occur if the response is purely elastic from the onset.\n\nWith $\\sigma^{r} = 0$, Melan's criterion for shakedown simplifies to the condition for purely elastic behavior:\n$$\n|\\sigma^{e}(t)| \\le \\sigma_{y}\n$$\nThe purely elastic stress response is given as $\\sigma^{e}(t) = \\sigma_{m} + \\sigma_{a}\\,s(t)$. The function $s(t)$ is bounded such that $|s(t)| \\le 1$. To satisfy the condition for all time $t$, we must check the extrema of $\\sigma^{e}(t)$. The maximum and minimum values of the elastic stress occur when $s(t)=1$ and $s(t)=-1$, respectively:\n$$\n\\sigma^{e}_{\\max} = \\sigma_{m} + \\sigma_{a}\n$$\n$$\n\\sigma^{e}_{\\min} = \\sigma_{m} - \\sigma_{a}\n$$\nThe shakedown condition thus requires that both these extrema lie within the elastic range $[-\\sigma_{y}, \\sigma_{y}]$:\n$1$. $\\sigma^{e}_{\\max} \\le \\sigma_{y} \\implies \\sigma_{m} + \\sigma_{a} \\le \\sigma_{y}$\n$2$. $\\sigma^{e}_{\\min} \\ge -\\sigma_{y} \\implies \\sigma_{m} - \\sigma_{a} \\ge -\\sigma_{y}$\n\nThese two inequalities define the domain of elastic shakedown in the $(\\sigma_{m}, \\sigma_{a})$-plane. The second inequality can be rewritten, by multiplying by $-1$, as $-\\sigma_{m} + \\sigma_{a} \\le \\sigma_{y}$.\nAssuming $\\sigma_{a} \\ge 0$, these two conditions, $\\sigma_{m} + \\sigma_{a} \\le \\sigma_{y}$ and $-\\sigma_{m} + \\sigma_{a} \\le \\sigma_{y}$, can be consolidated into a single compact expression:\n$$\n|\\sigma_{m}| + \\sigma_{a} \\le \\sigma_{y}\n$$\nThis inequality defines the region of safe operation where the structure shakes down (in this case, by remaining elastic).\n\nThe problem asks for the boundary that separates elastic shakedown from ratchetting. If the condition $|\\sigma_{m}| + \\sigma_{a} \\le \\sigma_{y}$ is violated, so that $|\\sigma_{m}| + \\sigma_{a} > \\sigma_{y}$, yielding occurs. Because no residual stress can be sustained ($\\sigma^{r}=0$), this yielding is not a one-time event that allows the structure to adapt; it will repeat on every cycle. This repeated, one-sided plastic deformation is, by definition, ratchetting (incremental plastic collapse). For example, if $\\sigma_{m} > 0$, the condition $\\sigma_{m} + \\sigma_{a} > \\sigma_{y}$ means the bar yields in tension on every loading peak, accumulating plastic strain. This continues as long as reverse yielding does not occur, i.e., as long as $\\sigma_{m} - \\sigma_{a} > -\\sigma_{y}$. The boundary where this behavior begins is precisely when the shakedown condition becomes an equality.\n\nTherefore, the boundary separating the elastic shakedown domain from the ratchetting domain is given by the equation:\n$$\n|\\sigma_{m}| + \\sigma_{a} = \\sigma_{y}\n$$\nThe problem requires an expression for the boundary value of $\\sigma_{a}$ in terms of $\\sigma_{m}$ and $\\sigma_{y}$. Solving the boundary equation for $\\sigma_{a}$ yields the final expression:\n$$\n\\sigma_{a} = \\sigma_{y} - |\\sigma_{m}|\n$$\nThis expression is valid for the region where shakedown is possible, which requires $|\\sigma_{m}| \\le \\sigma_{y}$. If $|\\sigma_{m}| > \\sigma_{y}$, collapse occurs on the first application of the mean stress alone, and cyclic analysis is irrelevant.\nThe use of Koiter's theorem would provide a complementary (upper-bound) view, confirming that for any stress state $(\\sigma_{m}, \\sigma_{a})$ outside this boundary, a kinematically admissible plastic strain rate cycle exists which leads to failure, thus corroborating the result from Melan's theorem.", "answer": "$$\n\\boxed{\\sigma_{y} - |\\sigma_{m}|}\n$$", "id": "2684265"}, {"introduction": "Building upon the foundational concepts, this exercise applies the dual shakedown theorems to a classic structural mechanics problem: a two-bar truss under cyclic loading [@problem_id:2916255]. Here, you will be guided to determine the shakedown load factor by employing both Melan's static (lower-bound) theorem and Koiter's kinematic (upper-bound) theorem. The primary goal is to actively demonstrate the powerful duality between these two approaches, showing how they converge to the exact shakedown limit for a statically determinate structure, thereby deepening your analytical problem-solving skills.", "problem": "A planar pin-jointed two-bar truss is formed by a top node at coordinates $(0,h)$ connected by straight bars to two fixed supports at $(-L/2,0)$ and $(+L/2,0)$, with $L&gt;0$ and $h&gt;0$. Both bars have equal cross-sectional areas and the same symmetric axial yield force $N_y$ in tension and compression, with ideal elastic-perfectly plastic behavior and small deformations. Consider a repeated two-point load history consisting of the following extreme patterns applied at the top node: pattern A is a horizontal point load of magnitude $H_0$ acting in the $+x$ direction, and pattern B is a horizontal point load of magnitude $H_0$ acting in the $-x$ direction. The structure is subjected to infinite repetition of these two extremes in any order, scaled by a common load factor $\\lambda \\ge 0$.\n\nUsing only first principles (equilibrium, compatibility, and the definitions of Melan’s static shakedown theorem and Koiter’s kinematic shakedown theorem), determine the maximum shakedown load factor $\\lambda_{\\mathrm{sh}}$ for this truss. Proceed by:\n\n- Establishing the elastic axial force in each bar per unit horizontal load at the top node by enforcing nodal equilibrium.\n\n- Applying Melan’s static shakedown theorem by constructing admissible residual axial forces and writing the shakedown condition under both extreme load patterns. From this, obtain a safe bound on $\\lambda$.\n\n- Applying Koiter’s kinematic shakedown theorem by proposing a horizontal slip mechanism at the top node, computing the plastic dissipation per half-cycle in terms of the member direction cosines and the slip amplitude, and equating it to the external work over the same half-cycle to obtain an unsafe bound on $\\lambda$.\n\nShow that these bounds coincide, and thus identify the exact shakedown load factor $\\lambda_{\\mathrm{sh}}$.\n\nExpress your final answer as a single simplified symbolic expression in terms of $N_y$, $H_0$, $L$, and $h$. No units are required. Do not provide an inequality. Do not approximate your answer.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\nStep 1: Extract Givens\n- Structure: A planar pin-jointed two-bar truss.\n- Geometry: Top node at $(0, h)$, two fixed supports at $(-L/2, 0)$ and $(+L/2, 0)$. Parameters $L>0$ and $h>0$.\n- Member Properties: Both bars have equal cross-sectional areas, ideal elastic-perfectly plastic behavior, and a symmetric axial yield force $N_y$ in tension and compression. Small deformations are assumed.\n- Loading History: A repeated two-point load history is applied at the top node.\n  - Pattern A: Horizontal point load of magnitude $H_0$ in the $+x$ direction.\n  - Pattern B: Horizontal point load of magnitude $H_0$ in the $-x$ direction.\n- Load Application: The load patterns are scaled by a common load factor $\\lambda \\ge 0$. The structure is subjected to infinite repetition of these extremes in any order.\n- Required Task: Determine the maximum shakedown load factor $\\lambda_{\\mathrm{sh}}$ using first principles.\n- Mandated Procedure:\n  1. Establish the elastic axial force in each bar per unit horizontal load.\n  2. Apply Melan’s static shakedown theorem to obtain a safe bound.\n  3. Apply Koiter’s kinematic shakedown theorem to obtain an unsafe bound.\n  4. Show that the bounds coincide and provide the exact shakedown load factor $\\lambda_{\\mathrm{sh}}$.\n- Final Answer: A single simplified symbolic expression for $\\lambda_{\\mathrm{sh}}$ in terms of $N_y$, $H_0$, $L$, and $h$.\n\nStep 2: Validate Using Extracted Givens\n- Scientific Grounding: The problem is a canonical example in the theory of plastic analysis of structures, specifically applying the shakedown theorems of Melan and Koiter. All concepts (equilibrium, elastic-perfectly plastic material, shakedown) are fundamental to solid mechanics. The problem is scientifically sound.\n- Well-Posedness: The problem provides all necessary information—geometry, material model, and load history—to determine a unique shakedown load factor. It is well-posed.\n- Objectivity: The problem is stated in precise, technical language, free from any subjective or ambiguous terms.\n\nStep 3: Verdict and Action\nThe problem is valid. It is a standard, well-defined problem in structural mechanics. A solution will be provided following the prescribed methodology.\n\nThe solution proceeds as follows.\n\nFirst, we define the geometry and determine the elastic response of the truss to a horizontal load. Let bar 1 connect the support at $(-L/2, 0)$ to the top node at $(0, h)$, and bar 2 connect the support at $(+L/2, 0)$ to the top node. The length of each bar, $l$, is identical:\n$$l = \\sqrt{\\left(\\frac{L}{2}\\right)^2 + h^2} = \\frac{1}{2}\\sqrt{L^2 + 4h^2}$$\nLet $N_1$ and $N_2$ be the axial forces in bars 1 and 2, respectively, with tension defined as positive. Let a horizontal load $H$ be applied at the top node in the $+x$ direction. The equilibrium equations at the top node are derived from a free-body diagram. The unit vector along bar 1 pointing from the support to the node is $\\vec{u}_1 = \\frac{1}{l}(L/2, h)$. The unit vector along bar 2 is $\\vec{u}_2 = \\frac{1}{l}(-L/2, h)$. Equilibrium requires that the sum of forces from the bars and the external load $\\vec{F}_{ext} = (H, 0)$ is zero:\n$$N_1 \\vec{u}_1 + N_2 \\vec{u}_2 + \\vec{F}_{ext} = \\vec{0}$$\nWriting this in component form:\nSum of forces in x-direction: $N_1 \\frac{L}{2l} - N_2 \\frac{L}{2l} + H = 0 \\implies (N_1 - N_2)\\frac{L}{2l} = -H$\nSum of forces in y-direction: $N_1 \\frac{h}{l} + N_2 \\frac{h}{l} = 0 \\implies N_1 + N_2 = 0 \\implies N_1 = -N_2$\nSubstituting $N_1 = -N_2$ into the x-equilibrium equation gives:\n$$(-N_2 - N_2)\\frac{L}{2l} = -H \\implies -N_2 \\frac{L}{l} = -H \\implies N_2 = H \\frac{l}{L}$$\nThus, $N_1 = -H \\frac{l}{L}$. The elastic axial forces per unit horizontal load are $n_1^E = -l/L$ and $n_2^E = +l/L$. The elastic force response $N_i^E(t)$ is simply the product of these influence coefficients and the time-varying load $H(t)$. The load history involves extremes $H = \\pm \\lambda H_0$. The envelope of elastic axial forces is:\nFor pattern A ($H = \\lambda H_0$): $N_{1,A}^E = -\\lambda H_0 \\frac{l}{L}$ and $N_{2,A}^E = +\\lambda H_0 \\frac{l}{L}$.\nFor pattern B ($H = -\\lambda H_0$): $N_{1,B}^E = +\\lambda H_0 \\frac{l}{L}$ and $N_{2,B}^E = -\\lambda H_0 \\frac{l}{L}$.\nThe full range of elastic force in each bar is $\\Delta N_i^E = \\max(N_i^E) - \\min(N_i^E) = 2\\lambda H_0 \\frac{l}{L}$.\n\nNext, we apply Melan’s static shakedown theorem. The theorem states that shakedown is guaranteed if there exists a time-independent, self-equilibrated residual force field $N_i^R$ such that the superposition of the elastic response and the residual state remains within the yield limits at all times:\n$$|N_i^E(t) + N_i^R| \\le N_y \\quad \\forall i, \\forall t$$\nA residual force field must be in equilibrium with zero external loads. For this truss, this requires:\n$$(N_1^R - N_2^R)\\frac{L}{2l} = 0 \\quad \\text{and} \\quad (N_1^R + N_2^R)\\frac{h}{l} = 0$$\nThese two linear homogeneous equations for $N_1^R$ and $N_2^R$ have only the trivial solution $N_1^R = N_2^R = 0$. This is expected, as the truss is statically determinate, and thus cannot sustain a non-zero residual force state.\nWith $N_i^R=0$, Melan's condition simplifies to the elastic limit condition:\n$$|N_i^E(t)| \\le N_y \\quad \\forall i, \\forall t$$\nThe maximum magnitude of the elastic force in either bar is $\\max |N_i^E(t)| = \\lambda H_0 \\frac{l}{L}$. Therefore, the condition for shakedown becomes:\n$$\\lambda H_0 \\frac{l}{L} \\le N_y$$\nThis provides a safe lower bound for the shakedown load factor, $\\lambda_S$: $\\lambda_{sh} \\ge \\lambda_S = \\frac{N_y L}{H_0 l}$.\n\nNow, we apply Koiter’s kinematic shakedown theorem. The theorem provides an unsafe upper bound on the shakedown load factor. Failure (non-shakedown) occurs if, for any kinematically admissible plastic mechanism, the work done by the elastic forces on the plastic deformations over a cycle exceeds the internal dissipation. Equality gives an unsafe bound $\\lambda_K$, such that $\\lambda_{sh} \\le \\lambda_K$.\nWe postulate a mechanism of alternating plasticity, where the structure yields at both extremes of the loading cycle. The mechanism consists of a horizontal plastic slip $\\Delta u_x$ of the top node. Let us consider a full cycle.\nIn the first half-cycle, the load changes from pattern B to pattern A. Let us assume plastic flow occurs with a leftward slip $\\Delta u_x < 0$ at the instant the load reaches its maximum positive value, $H=\\lambda H_0$. This slip corresponds to plastic shortenings and elongations in the bars. The change in length of a bar is the projection of the nodal displacement onto the bar's axis. For a nodal displacement $(u_x, 0)$:\n$\\Delta \\delta_1^p = u_x \\frac{L}{2l}$ and $\\Delta \\delta_2^p = -u_x \\frac{L}{2l}$.\nFor a leftward slip ($u_x < 0$), $\\Delta \\delta_1^p < 0$ (shortening) and $\\Delta \\delta_2^p > 0$ (elongation). According to the plastic flow rule, this requires bar 1 to be at compressive yield ($N_1 = -N_y$) and bar 2 at tensile yield ($N_2 = +N_y$).\nIn the second half-cycle (A to B), the opposite occurs: a rightward slip $u_x > 0$ when $H=-\\lambda H_0$. This corresponds to $\\Delta \\delta_1^p > 0$ and $\\Delta \\delta_2^p < 0$, requiring $N_1=+N_y$ and $N_2=-N_y$.\nThe range of elastic stress must not exceed twice the yield strength to prevent this alternating plasticity.\n$|\\Delta N_i^E| = |N_{i,A}^E - N_{i,B}^E| \\le 2N_y$\nThe range of elastic force in bar 1 is $\\Delta N_1^E = (-\\lambda H_0 \\frac{l}{L}) - (+\\lambda H_0 \\frac{l}{L}) = -2\\lambda H_0 \\frac{l}{L}$.\nThe condition for shakedown is:\n$$|-2\\lambda H_0 \\frac{l}{L}| \\le 2N_y \\implies 2\\lambda H_0 \\frac{l}{L} \\le 2N_y \\implies \\lambda H_0 \\frac{l}{L} \\le N_y$$\nThis yields an unsafe upper bound $\\lambda_K = \\frac{N_y L}{H_0 l}$. Therefore, $\\lambda_{sh} \\le \\frac{N_y L}{H_0 l}$.\n\nFinally, we combine the bounds from both theorems. Melan's theorem gives $\\lambda_{sh} \\ge \\frac{N_y L}{H_0 l}$, and Koiter's theorem gives $\\lambda_{sh} \\le \\frac{N_y L}{H_0 l}$. Since the lower bound and the upper bound coincide, we have found the exact shakedown load factor:\n$$\\lambda_{sh} = \\frac{N_y L}{H_0 l}$$\nTo express this in terms of the given geometric parameters $L$ and $h$, we substitute the expression for the bar length $l$:\n$$\\lambda_{sh} = \\frac{N_y L}{H_0 \\left(\\frac{1}{2}\\sqrt{L^2 + 4h^2}\\right)} = \\frac{2 N_y L}{H_0 \\sqrt{L^2 + 4h^2}}$$\nThis is the final expression for the shakedown load factor.", "answer": "$$\\boxed{\\frac{2 N_y L}{H_0 \\sqrt{L^2 + 4h^2}}}$$", "id": "2916255"}, {"introduction": "This capstone practice advances our study into statically indeterminate systems, where the true power of shakedown analysis is realized. We will investigate a parallel two-bar system that can develop beneficial residual forces to enhance its performance under cyclic loads [@problem_id:2684228]. This hands-on computational exercise requires you to formulate the shakedown problem as a Linear Programming task, bridging fundamental theory with the numerical methods used in modern engineering design and demonstrating how to find an optimal residual stress state to maximize the cyclic load capacity.", "problem": "Consider a verification problem for shakedown analysis in solid mechanics. The structure is an axially loaded system composed of $2$ parallel, straight, prismatic bars connecting a rigid left support to a rigid right support. The bars are perfectly aligned and experience the same end shortening/elongation because the supports are rigid and coaxial. Let the axial stiffnesses be $k_1$ and $k_2$ (force per unit displacement), and let the corresponding axial yield forces be $N_{y1}$ and $N_{y2}$ (force). The system is subjected to a fully reversed cyclic scalar load $P \\in [-\\lambda P_0, \\lambda P_0]$, where $P_0 &gt; 0$ is a given reference amplitude and $\\lambda \\ge 0$ is the unknown non-dimensional load factor.\n\nYou must compute approximate Melan (static) and Koiter (kinematic) shakedown bounds for this structure using coarse discretizations of the load domain and then demonstrate convergence as the discretization is refined. The derivations and algorithm must be grounded only in the following fundamental base:\n- Equilibrium of forces at the common node and supports.\n- Linear elasticity in the elastic regime (Hooke’s law) with stiffnesses $k_1$ and $k_2$.\n- The idealized perfectly plastic yield condition in axial force: $|N_i| \\le N_{yi}$ for bar $i \\in \\{1,2\\}$.\n- Melan’s static shakedown theorem (existence of a time-independent self-equilibrated residual force field that keeps stresses within yield for all loadings in the prescribed convex load domain).\n- Koiter’s kinematic shakedown theorem (for any kinematically admissible plastic strain-rate mechanism, the maximum load factor such that the plastic dissipation bounds the rate of external work for all loadings in the prescribed convex load domain).\n\nModeling choices for this $2$-bar parallel system:\n- Under purely elastic response, the axial forces in the bars are proportional to stiffness sharing: $N_{1}^{\\mathrm{el}}(P) = a_1 P$ and $N_{2}^{\\mathrm{el}}(P) = a_2 P$, where $a_i = \\dfrac{k_i}{k_1 + k_2}$ for $i \\in \\{1,2\\}$.\n- A residual self-equilibrated force vector is parameterized as $(R_1, R_2) = (t, -t)$ with unknown scalar $t \\in \\mathbb{R}$.\n\nDiscretization of the convex load domain:\n- The true convex load domain is the closed interval $[-1, 1]$ in the scaled parameter $s = P/(\\lambda P_0)$.\n- To approximate the universal quantifiers “for all $s \\in [-1,1]$” in both Melan’s and Koiter’s theorems, you will use interior sampling points $s_j \\in (-1,1)$ only, excluding the endpoints.\n- For a given integer $m \\ge 1$, define $m$ interior points $s_j = -1 + \\dfrac{2j}{m+1}$ for $j \\in \\{1,2,\\dots,m\\}$. Note that $\\max_j |s_j| = 1 - \\dfrac{2}{m+1} \\in (0,1)$ and increases monotonically to $1$ as $m \\to \\infty$.\n\nApproximate Melan (static) bound for a given $m$:\n- Seek the largest $\\lambda$ for which there exists a time-independent residual vector $(R_1,R_2)=(t,-t)$ such that, for each bar $i \\in \\{1,2\\}$ and each sampled load parameter $s_j$, the yield inequality $|a_i\\, s_j\\, \\lambda P_0 + R_i| \\le N_{yi}$ holds.\n- Formulate this as a Linear Programming (LP) problem (Linear Programming (LP) is the mathematical optimization of a linear objective subject to linear inequalities). Introduce decision variables $\\lambda \\ge 0$ and $t \\in \\mathbb{R}$, and enforce, for each $i \\in \\{1,2\\}$ and each $s_j$, the pair of linear constraints\n  $$\n  a_i\\, s_j\\, \\lambda P_0 + R_i \\le N_{yi}, \\quad -a_i\\, s_j\\, \\lambda P_0 - R_i \\le N_{yi}.\n  $$\n  Maximize $\\lambda$ (equivalently, minimize $-\\lambda$) subject to these constraints and the bound $\\lambda \\ge 0$.\n\nApproximate Koiter (kinematic) bound for a given $m$:\n- Consider kinematically admissible plastic strain-rate mechanisms consistent with the rigid supports. Because the bars are in parallel between the same rigid supports, the end-to-end velocity is common, so a collapse mechanism can be described by a single end velocity rate $\\dot{u}$. In perfect plastic flow with associated rule, plastic power dissipation equals $D = (N_{y1} + N_{y2})\\, |\\dot{u}|$ whenever both bars participate in the mechanism (which is admissible here because compatibility enforces equal end displacement rate).\n- The external power rate under load $P$ is $W = P \\dot{u}$. Over the discretized load set $\\{s_j\\}$, the supremum of the magnitude of external power for a given $\\dot{u}$ is $\\sup_j |P|\\, |\\dot{u}| = \\lambda P_0 \\left(\\max_j |s_j|\\right) |\\dot{u}|$.\n- The kinematic inequality requires $D \\ge \\sup_j |W|$ for safety against incremental collapse. This yields the approximate upper bound\n  $$\n  \\lambda_{\\mathrm{kin}}^{(m)} \\;=\\; \\frac{N_{y1} + N_{y2}}{P_0 \\; \\max_j |s_j|}.\n  $$\n  Because $\\dot{u} \\ne 0$ cancels, there is no remaining minimization over mechanisms in this parallel-bar verification problem.\n\nConvergence upon refinement:\n- As $m$ increases, $\\max_j |s_j|$ increases to $1$, so both the approximate Melan and Koiter bounds converge monotonically downward to their respective exact values (those obtained with the true suprema at $s=\\pm 1$).\n- You must compute both bounds for a coarse $m$ and a refined $m$ and report the values to demonstrate the convergence trend.\n\nUnits and required numerics:\n- Treat all forces in arbitrary consistent force units and all stiffnesses in consistent force-per-displacement units. The output load factors $\\lambda$ are unitless scalars. Express all final numerical outputs as real numbers (floating-point), not percentages.\n- Angle units do not apply.\n\nTest suite:\nFor each of the following parameter sets, compute the approximate Melan and Koiter shakedown bounds for $m_{\\mathrm{coarse}} = 3$ and $m_{\\mathrm{refined}} = 33$.\n- Case A (happy path): $k_1 = 1.0$, $k_2 = 1.0$, $N_{y1} = 100.0$, $N_{y2} = 100.0$, $P_0 = 1.0$.\n- Case B (unequal yield strengths): $k_1 = 1.0$, $k_2 = 1.0$, $N_{y1} = 60.0$, $N_{y2} = 140.0$, $P_0 = 1.0$.\n- Case C (stiffness contrast): $k_1 = 3.0$, $k_2 = 1.0$, $N_{y1} = 100.0$, $N_{y2} = 100.0$, $P_0 = 1.0$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- For each case in the order A, B, C, output the $4$ numbers in the order\n  $[\\lambda_{\\mathrm{stat}}^{(m_{\\mathrm{coarse}})}, \\lambda_{\\mathrm{kin}}^{(m_{\\mathrm{coarse}})}, \\lambda_{\\mathrm{stat}}^{(m_{\\mathrm{refined}})}, \\lambda_{\\mathrm{kin}}^{(m_{\\mathrm{refined}})}]$,\n  then concatenate these triplets for all cases into one flat list.\n- Thus the full output is a flat list of $12$ floating-point numbers:\n  $[\\text{A-coarse-static}, \\text{A-coarse-kin}, \\text{A-refined-static}, \\text{A-refined-kin}, \\text{B-coarse-static}, \\text{B-coarse-kin}, \\text{B-refined-static}, \\text{B-refined-kin}, \\text{C-coarse-static}, \\text{C-coarse-kin}, \\text{C-refined-static}, \\text{C-refined-kin}]$.\n\nYour code must:\n- Implement the Linear Programming problem for the approximate Melan bound using the constraints above on the sampled points.\n- Implement the approximate Koiter bound using the formula above on the same sampled points.\n- Use $m_{\\mathrm{coarse}} = 3$ and $m_{\\mathrm{refined}} = 33$ as specified.\n- Produce exactly the single-line output in the format described.", "solution": "The problem as stated is subjected to rigorous validation and is found to be valid. It is scientifically grounded in the principles of solid mechanics, specifically the shakedown theorems of Melan and Koiter. The problem is well-posed, with all necessary data and definitions provided to formulate and solve for the required quantities. The language is objective and precise. Therefore, I will proceed with a complete solution.\n\nThe objective is to compute approximate static (Melan) and kinematic (Koiter) shakedown bounds for a two-bar system under a cyclic load $P \\in [-\\lambda P_0, \\lambda P_0]$. The approximation arises from discretizing the normalized load domain $s = P/(\\lambda P_0) \\in [-1, 1]$ into a finite set of $m$ interior points.\n\nLet the system properties be the bar stiffnesses $k_1, k_2$ and yield forces $N_{y1}, N_{y2}$. The reference load amplitude is $P_0$.\n\nUnder an external load $P$, the elastic forces in the bars are $N_1^{\\mathrm{el}} = a_1 P$ and $N_2^{\\mathrm{el}} = a_2 P$, where the distribution factors are functions of the stiffnesses:\n$$\na_1 = \\frac{k_1}{k_1 + k_2}, \\quad a_2 = \\frac{k_2}{k_1 + k_2}\n$$\nA time-independent, self-equilibrated residual force field is parameterized by a scalar $t$ as $(R_1, R_2) = (t, -t)$. The total force in bar $i$ is $N_i = N_i^{\\mathrm{el}} + R_i$.\n\nThe load domain is discretized using $m$ points $s_j = -1 + \\frac{2j}{m+1}$ for $j \\in \\{1, \\dots, m\\}$. The maximum absolute value of these points is a key parameter for both bounds:\n$$\nS_{\\max}^{(m)} = \\max_{j=1, \\dots, m} |s_j| = \\left| -1 + \\frac{2}{m+1} \\right| = 1 - \\frac{2}{m+1}\n$$\n\n**Approximate Kinematic (Koiter) Bound**\n\nKoiter's upper bound theorem, applied to a discrete load set, states that for any admissible plastic mechanism, the shakedown load factor $\\lambda$ is bounded by the ratio of plastic dissipation rate to the supremum of the external power rate over the load set. For the given fully-reversed load cycle and a mechanism where both bars yield simultaneously (which is admissible), this gives the formula:\n$$\n\\lambda_{\\mathrm{kin}}^{(m)} = \\frac{N_{y1} + N_{y2}}{P_0 \\sup_j |s_j|}\n$$\nSubstituting the expression for $\\max_j |s_j| = S_{\\max}^{(m)}$:\n$$\n\\lambda_{\\mathrm{kin}}^{(m)} = \\frac{N_{y1} + N_{y2}}{P_0 \\left(1 - \\frac{2}{m+1}\\right)}\n$$\nThis provides a direct method for calculating the approximate kinematic bound. As $m \\to \\infty$, $S_{\\max}^{(m)} \\to 1$, and $\\lambda_{\\mathrm{kin}}^{(m)}$ converges downwards to the exact kinematic bound $\\lambda_{\\mathrm{kin}} = (N_{y1} + N_{y2}) / P_0$.\n\n**Approximate Static (Melan) Bound**\n\nMelan's static theorem states that shakedown occurs if a time-independent residual stress field can be found such that the superposition of elastic and residual stresses remains within the yield limits for all possible loads in the domain. For the discretized load set, we seek the maximum load factor $\\lambda$ for which there exists a residual force parameter $t$ satisfying the yield conditions for all bars $i \\in \\{1, 2\\}$ and all load points $s_j$:\n$$\n| N_i^{\\mathrm{el}}(s_j \\lambda P_0) + R_i | \\le N_{yi}\n$$\nSubstituting the expressions for elastic and residual forces:\n$$\n|a_1 s_j \\lambda P_0 + t| \\le N_{y1} \\quad \\text{for } j=1, \\dots, m \\\\\n|a_2 s_j \\lambda P_0 - t| \\le N_{y2} \\quad \\text{for } j=1, \\dots, m\n$$\nThis constitutes a Linear Programming (LP) problem. The goal is to maximize $\\lambda$ subject to the above constraints. The variables of the optimization are $\\lambda$ and $t$. We can write the program as:\n$$\n\\text{minimize} \\quad c^T \\mathbf{x} = -\\lambda\n$$\nwhere $\\mathbf{x} = [\\lambda, t]^T$. The constraints are non-negativity for the load factor, $\\lambda \\ge 0$, while $t$ is a free variable. The yield conditions are expressed as $4m$ linear inequalities:\n$$\n\\begin{cases}\n+a_i s_j P_0 \\lambda + R_i \\le N_{yi} \\\\\n-a_i s_j P_0 \\lambda - R_i \\le N_{yi}\n\\end{cases}\n\\quad \\text{for } i \\in \\{1,2\\}, j \\in \\{1, \\dots, m\\}, \\text{ with } R_1=t, R_2=-t.\n$$\nThis LP problem can be solved numerically. For this specific problem structure, it is also possible to find an analytical solution. The constraints on $t$ can be aggregated over all $s_j$:\nFrom bar 1: $\\max_{j} (-N_{y1} - a_1 s_j \\lambda P_0) \\le t \\le \\min_{j} (N_{y1} - a_1 s_j \\lambda P_0)$, which simplifies to\n$$\na_1 \\lambda P_0 S_{\\max}^{(m)} - N_{y1} \\le t \\le -a_1 \\lambda P_0 S_{\\max}^{(m)} + N_{y1}\n$$\nFrom bar 2: $\\max_{j} (-N_{y2} + a_2 s_j \\lambda P_0) \\le t \\le \\min_{j} (N_{y2} + a_2 s_j \\lambda P_0)$, which simplifies to\n$$\na_2 \\lambda P_0 S_{\\max}^{(m)} - N_{y2} \\le t \\le -a_2 \\lambda P_0 S_{\\max}^{(m)} + N_{y2}\n$$\nFor a feasible $t$ to exist, the lower bound of one interval must be less than or equal to the upper bound of the other. This leads to two conditions, both of which reduce to:\n$$\n(a_1+a_2) \\lambda P_0 S_{\\max}^{(m)} \\le N_{y1} + N_{y2}\n$$\nSince $a_1+a_2=1$, the maximum $\\lambda$ is:\n$$\n\\lambda_{\\mathrm{stat}}^{(m)} = \\frac{N_{y1} + N_{y2}}{P_0 S_{\\max}^{(m)}} = \\frac{N_{y1} + N_{y2}}{P_0 \\left(1 - \\frac{2}{m+1}\\right)}\n$$\nThis demonstrates that for this problem, the approximate static and kinematic bounds are identical: $\\lambda_{\\mathrm{stat}}^{(m)} = \\lambda_{\\mathrm{kin}}^{(m)}$. The numerical implementation will use the LP formulation for the static bound as required, and the equality of results will serve as a verification of the implementation.\n\nThe computation will be performed for $m_{\\mathrm{coarse}} = 3$ and $m_{\\mathrm{refined}} = 33$ for each test case.\nFor $m=3$, $S_{\\max}^{(3)} = 1 - 2/4 = 0.5$.\nFor $m=33$, $S_{\\max}^{(33)} = 1 - 2/34 = 16/17 \\approx 0.941176$.\nThe results will show the expected downward convergence as $m$ increases from $3$ to $33$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef compute_shakedown_bounds(params, m):\n    \"\"\"\n    Computes approximate Melan (static) and Koiter (kinematic) shakedown bounds.\n\n    Args:\n        params (tuple): A tuple containing (k1, k2, Ny1, Ny2, P0).\n        m (int): The number of interior sampling points for load discretization.\n\n    Returns:\n        tuple: A tuple containing (lambda_stat, lambda_kin).\n    \"\"\"\n    k1, k2, Ny1, Ny2, P0 = params\n\n    # 1. Calculate system parameters\n    k_total = k1 + k2\n    if k_total == 0:\n        # Avoid division by zero, although problem constraints imply k_i > 0\n        a1, a2 = 0.5, 0.5\n    else:\n        a1 = k1 / k_total\n        a2 = k2 / k_total\n\n    # 2. Define load discretization\n    s_j = np.array([-1 + 2 * j / (m + 1) for j in range(1, m + 1)])\n    max_abs_s = 1.0 - 2.0 / (m + 1)\n\n    # 3. Compute Approximate Koiter (Kinematic) Bound\n    # This is a direct calculation.\n    if P0 == 0 or max_abs_s == 0:\n        lambda_kin = float('inf')\n    else:\n        lambda_kin = (Ny1 + Ny2) / (P0 * max_abs_s)\n\n    # 4. Compute Approximate Melan (Static) Bound using Linear Programming\n    # The LP problem is to maximize lambda, which is equivalent to minimizing -lambda.\n    # Variables are x = [lambda, t].\n    c = [-1.0, 0.0]\n\n    # The constraints are of the form A_ub * x <= b_ub\n    # For each s_j, there are 4 inequalities:\n    # |a1*sj*lambda*P0 + t| <= Ny1  =>  a1*sj*P0*lambda + t <= Ny1 AND -a1*sj*P0*lambda - t <= Ny1\n    # |a2*sj*lambda*P0 - t| <= Ny2  =>  a2*sj*P0*lambda - t <= Ny2 AND -a2*sj*P0*lambda + t <= Ny2\n    num_constraints = 4 * m\n    A_ub = np.zeros((num_constraints, 2))\n    b_ub = np.zeros(num_constraints)\n\n    for j, sj in enumerate(s_j):\n        # Bar 1 constraints\n        A_ub[4 * j, :] = [a1 * sj * P0, 1.0]\n        b_ub[4 * j] = Ny1\n        A_ub[4 * j + 1, :] = [-a1 * sj * P0, -1.0]\n        b_ub[4 * j + 1] = Ny1\n        \n        # Bar 2 constraints\n        A_ub[4 * j + 2, :] = [a2 * sj * P0, -1.0]\n        b_ub[4 * j + 2] = Ny2\n        A_ub[4 * j + 3, :] = [-a2 * sj * P0, 1.0]\n        b_ub[4 * j + 3] = Ny2\n\n    # Bounds on variables: lambda >= 0, t is unbounded\n    bounds = [(0, None), (None, None)]\n\n    # Solve the LP problem\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method='highs-ipm')\n\n    if res.success:\n        lambda_stat = res.x[0]\n    else:\n        # Should not happen for this well-posed problem\n        lambda_stat = float('nan')\n\n    return lambda_stat, lambda_kin\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and format output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k1, k2, Ny1, Ny2, P0)\n        (1.0, 1.0, 100.0, 100.0, 1.0),  # Case A\n        (1.0, 1.0, 60.0, 140.0, 1.0),   # Case B\n        (3.0, 1.0, 100.0, 100.0, 1.0),   # Case C\n    ]\n\n    m_coarse = 3\n    m_refined = 33\n\n    results = []\n    for case in test_cases:\n        # Compute bounds for coarse discretization\n        lambda_stat_coarse, lambda_kin_coarse = compute_shakedown_bounds(case, m_coarse)\n        results.extend([lambda_stat_coarse, lambda_kin_coarse])\n\n        # Compute bounds for refined discretization\n        lambda_stat_refined, lambda_kin_refined = compute_shakedown_bounds(case, m_refined)\n        results.extend([lambda_stat_refined, lambda_kin_refined])\n\n    # Final print statement in the exact required format.\n    # Convert results to string representation for joining.\n    # Using a format specifier to avoid excessive precision.\n    formatted_results = [f\"{val:.10g}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2684228"}]}