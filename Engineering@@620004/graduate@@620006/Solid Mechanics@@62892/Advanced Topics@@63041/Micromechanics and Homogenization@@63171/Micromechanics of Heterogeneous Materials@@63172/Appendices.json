{"hands_on_practices": [{"introduction": "This first exercise grounds your understanding of homogenization in a simple yet illustrative case: the layered composite loaded normal to its layers. By applying variational principles, you will derive the effective modulus under Kinematic (KUBC) and Static (SUBC) Uniform Boundary Conditions. This practice reveals the physical basis of these conditions and their direct connection to the classical Reuss bound, providing a rigorous foundation for tackling more complex materials. [@problem_id:2662595]", "problem": "A two-phase, linearly elastic, perfectly bonded layered composite is constructed by stacking layers of phase $1$ with Young's modulus $E_1$ and phase $2$ with Young's modulus $E_2$ along the $x_2$-direction (interfaces normal to $x_2$). Let the volume fractions be $c_1$ and $c_2$, with $c_1 + c_2 = 1$. Consider an ensemble-equivalent representative volume element (RVE) of thickness $L$ in the $x_2$-direction and unit cross-sectional area in the $x_1$–$x_3$ plane. Assume small strains and uniaxial loading in the $x_2$-direction so that only $\\varepsilon_{22}$ and $\\sigma_{22}$ are nonzero.\n\nUsing a first-principles variational formulation grounded in the principle of minimum potential energy and Hill–Mandel macro-homogeneity, derive expressions for the apparent axial modulus of the layered composite in the $x_2$-direction under:\n- Kinematic Uniform Boundary Conditions (KUBC): prescribe an affine displacement field on the RVE boundary consistent with a uniform macroscopic strain $\\bar{\\varepsilon}_{22}$.\n- Static Uniform Boundary Conditions (SUBC): prescribe a uniform traction on the RVE boundary consistent with a uniform macroscopic stress $\\bar{\\sigma}_{22}$.\n\nExpress each apparent modulus $\\tilde{E}^{\\mathrm{KUBC}}$ and $\\tilde{E}^{\\mathrm{SUBC}}$ in terms of $E_1$, $E_2$, $c_1$, and $c_2$.\n\nThen, for the numerical data $E_1 = 150$ GPa, $E_2 = 15$ GPa, $c_1 = 0.7$, and $c_2 = 0.3$, evaluate the two apparent moduli and compare them with the classical Voigt and Reuss bounds for loading normal to the layers, defined via uniform-strain and uniform-stress assumptions, respectively. \n\nProvide your final results as a row matrix containing, in order, $\\tilde{E}^{\\mathrm{KUBC}}$, $\\tilde{E}^{\\mathrm{SUBC}}$, $E_{\\mathrm{Voigt}}$, and $E_{\\mathrm{Reuss}}$. Round your answers to four significant figures. Express all moduli in gigapascals (GPa).", "solution": "**Derivation of Apparent Moduli**\n\nThe problem concerns a layered composite loaded normal to the layers, which in mechanics is known as a \"series\" model. The effective modulus in the $x_2$-direction, $\\tilde{E}_{22}$, relates the average stress $\\bar{\\sigma}_{22}$ to the average strain $\\bar{\\varepsilon}_{22}$ via $\\bar{\\sigma}_{22} = \\tilde{E}_{22} \\bar{\\varepsilon}_{22}$. The Hill-Mandel macro-homogeneity condition, which links microscopic and macroscopic work, requires that $\\bar{\\sigma}_{22} \\bar{\\varepsilon}_{22} = \\langle \\sigma_{22} \\varepsilon_{22} \\rangle$, where $\\langle \\cdot \\rangle$ denotes a volume average over the RVE.\n\n**1. Kinematic Uniform Boundary Conditions (KUBC)**\n\nUnder KUBC, an affine displacement field corresponding to a uniform macroscopic strain $\\bar{\\varepsilon}$ is prescribed on the boundary $\\partial V$ of the RVE. For our one-dimensional problem, the displacement $u_2(x_2)$ must satisfy:\n$$ u_2(0) = 0 \\quad \\text{and} \\quad u_2(L) = \\bar{\\varepsilon}_{22} L $$\nThe principle of minimum potential energy states that the true displacement field minimizes the total potential energy functional $\\Pi$ among all kinematically admissible fields. For our RVE of unit area, the functional is:\n$$ \\Pi[u_2] = \\int_0^L \\frac{1}{2} E(x_2) (\\varepsilon_{22}(x_2))^2 dx_2 = \\int_0^L \\frac{1}{2} E(x_2) \\left(\\frac{du_2}{dx_2}\\right)^2 dx_2 $$\nTo find the minimizing function $u_2(x_2)$, we use the Euler-Lagrange equation for the integrand $F = \\frac{1}{2} E(x_2) (u_2')^2$:\n$$ \\frac{\\partial F}{\\partial u_2} - \\frac{d}{dx_2} \\left(\\frac{\\partial F}{\\partial u_2'}\\right) = 0 \\implies 0 - \\frac{d}{dx_2} \\left( E(x_2) \\frac{du_2}{dx_2} \\right) = 0 $$\nThis equation implies that the term $E(x_2) \\frac{du_2}{dx_2}$ is constant throughout the RVE. Recognizing that $\\sigma_{22}(x_2) = E(x_2) \\varepsilon_{22}(x_2) = E(x_2) \\frac{du_2}{dx_2}$, we conclude that the microscopic stress field $\\sigma_{22}$ is uniform, i.e., $\\sigma_{22}(x_2) = \\sigma_0$.\nThe corresponding strain field is non-uniform: $\\varepsilon_{22}(x_2) = \\sigma_0 / E(x_2)$.\nWe determine the constant $\\sigma_0$ by integrating the strain to satisfy the displacement boundary conditions:\n$$ \\int_0^L \\varepsilon_{22}(x_2) dx_2 = u_2(L) - u_2(0) = \\bar{\\varepsilon}_{22} L $$\n$$ \\int_0^L \\frac{\\sigma_0}{E(x_2)} dx_2 = \\sigma_0 \\int_0^L \\frac{1}{E(x_2)} dx_2 = \\bar{\\varepsilon}_{22} L $$\nThe integral is the volume average of the inverse of the modulus, $\\langle E^{-1} \\rangle$, multiplied by $L$:\n$$ \\int_0^L \\frac{1}{E(x_2)} dx_2 = \\frac{L_1}{E_1} + \\frac{L_2}{E_2} = \\frac{c_1 L}{E_1} + \\frac{c_2 L}{E_2} = L \\left( \\frac{c_1}{E_1} + \\frac{c_2}{E_2} \\right) $$\nSubstituting this back, we get:\n$$ \\sigma_0 L \\left( \\frac{c_1}{E_1} + \\frac{c_2}{E_2} \\right) = \\bar{\\varepsilon}_{22} L \\implies \\sigma_0 = \\frac{\\bar{\\varepsilon}_{22}}{\\frac{c_1}{E_1} + \\frac{c_2}{E_2}} $$\nThe macroscopic stress $\\bar{\\sigma}_{22}$ is the volume average of the microscopic stress. Since $\\sigma_{22}(x_2) = \\sigma_0$ is uniform, $\\bar{\\sigma}_{22} = \\langle \\sigma_{22} \\rangle = \\sigma_0$.\nThe apparent modulus under KUBC is therefore:\n$$ \\tilde{E}^{\\mathrm{KUBC}} = \\frac{\\bar{\\sigma}_{22}}{\\bar{\\varepsilon}_{22}} = \\frac{\\sigma_0}{\\bar{\\varepsilon}_{22}} = \\left( \\frac{c_1}{E_1} + \\frac{c_2}{E_2} \\right)^{-1} $$\n\n**2. Static Uniform Boundary Conditions (SUBC)**\n\nUnder SUBC, a uniform traction field corresponding to a uniform macroscopic stress $\\bar{\\sigma}$ is prescribed on the boundary $\\partial V$. For our case, this means the traction $t_2$ on the face at $x_2=L$ is $t_2 = \\bar{\\sigma}_{22}$, and on the face at $x_2=0$ is $t_2 = -\\bar{\\sigma}_{22}$.\nThe local stress must satisfy the static equilibrium equation, which in the absence of body forces is $\\sigma_{22,2} = \\frac{d\\sigma_{22}}{dx_2} = 0$. This implies that the stress $\\sigma_{22}$ must be constant throughout the RVE.\nApplying the traction boundary condition at $x_2=L$, we have $\\sigma_{22}(L) = t_2 = \\bar{\\sigma}_{22}$.\nThus, the microscopic stress field is uniform and equal to the macroscopic stress: $\\sigma_{22}(x_2) = \\bar{\\sigma}_{22}$. This is a statically admissible field, and in this 1D case, it is the exact solution.\nThe macroscopic strain $\\bar{\\varepsilon}_{22}$ is the volume average of the microscopic strain field:\n$$ \\bar{\\varepsilon}_{22} = \\langle \\varepsilon_{22} \\rangle = \\left\\langle \\frac{\\sigma_{22}(x_2)}{E(x_2)} \\right\\rangle = \\left\\langle \\frac{\\bar{\\sigma}_{22}}{E(x_2)} \\right\\rangle = \\bar{\\sigma}_{22} \\left\\langle \\frac{1}{E(x_2)} \\right\\rangle $$\nThe average of the inverse modulus is $\\langle E^{-1} \\rangle = c_1 E_1^{-1} + c_2 E_2^{-1}$. So,\n$$ \\bar{\\varepsilon}_{22} = \\bar{\\sigma}_{22} \\left( \\frac{c_1}{E_1} + \\frac{c_2}{E_2} \\right) $$\nThe apparent modulus under SUBC is then:\n$$ \\tilde{E}^{\\mathrm{SUBC}} = \\frac{\\bar{\\sigma}_{22}}{\\bar{\\varepsilon}_{22}} = \\left( \\frac{c_1}{E_1} + \\frac{c_2}{E_2} \\right)^{-1} $$\nFor this specific lamination and loading direction, the exact solution derived from either KUBC or SUBC yields the same apparent modulus.\n\n**3. Comparison with Voigt and Reuss Bounds**\n\nThe classical bounds are derived from uniform field assumptions:\n- The **Voigt bound** is obtained by assuming a uniform strain field ($\\varepsilon_{22} = \\bar{\\varepsilon}_{22}$). This represents a parallel model and gives an upper bound for the effective modulus.\n  $$ E_{\\mathrm{Voigt}} = \\langle E \\rangle = c_1 E_1 + c_2 E_2 $$\n- The **Reuss bound** is obtained by assuming a uniform stress field ($\\sigma_{22} = \\bar{\\sigma}_{22}$). This represents a series model and gives a lower bound for the effective modulus.\n  $$ E_{\\mathrm{Reuss}} = \\langle E^{-1} \\rangle^{-1} = \\left( \\frac{c_1}{E_1} + \\frac{c_2}{E_2} \\right)^{-1} $$\nFrom our derivations, it is evident that for loading normal to the layers, the exact solution for the apparent modulus under both KUBC and SUBC coincides with the Reuss bound.\n$$ \\tilde{E}^{\\mathrm{KUBC}} = \\tilde{E}^{\\mathrm{SUBC}} = E_{\\mathrm{Reuss}} $$\n\n**4. Numerical Evaluation**\n\nGiven data: $E_1 = 150 \\text{ GPa}$, $E_2 = 15 \\text{ GPa}$, $c_1 = 0.7$, $c_2 = 0.3$.\n\n- **Apparent moduli and Reuss bound**:\n$$ \\tilde{E}^{\\mathrm{KUBC}} = \\tilde{E}^{\\mathrm{SUBC}} = E_{\\mathrm{Reuss}} = \\left( \\frac{0.7}{150} + \\frac{0.3}{15} \\right)^{-1} = \\left( \\frac{7}{1500} + \\frac{30}{1500} \\right)^{-1} = \\left( \\frac{37}{1500} \\right)^{-1} = \\frac{1500}{37} \\approx 40.54054 \\text{ GPa} $$\n- **Voigt bound**:\n$$ E_{\\mathrm{Voigt}} = (0.7)(150) + (0.3)(15) = 105 + 4.5 = 109.5 \\text{ GPa} $$\n\nRounding to four significant figures, the required values in GPa are:\n- $\\tilde{E}^{\\mathrm{KUBC}} = 40.54$\n- $\\tilde{E}^{\\mathrm{SUBC}} = 40.54$\n- $E_{\\mathrm{Voigt}} = 109.5$\n- $E_{\\mathrm{Reuss}} = 40.54$\nThe results are compiled into the required matrix format.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40.54 & 40.54 & 109.5 & 40.54\n\\end{pmatrix}\n}\n$$", "id": "2662595"}, {"introduction": "Moving from one-dimensional laminates to three-dimensional particulate composites, this practice explores the relationship between two powerful predictive models: the Mori-Tanaka (MT) estimate and the Hashin-Shtrikman (HS) bounds. You will derive the effective bulk modulus for a composite with spherical inclusions using both frameworks. This exercise is designed to lead you to a profound and non-obvious conclusion about the equivalence of these methods for this specific, yet common, microstructure. [@problem_id:2662631]", "problem": "Consider a statistically isotropic, two-phase, linear-elastic composite consisting of a matrix and a family of identical, randomly distributed, non-overlapping spherical inclusions. Let the matrix have bulk modulus $K_{m}$ and shear modulus $\\mu_{m}$, and let the inclusion phase have bulk modulus $K_{i}$ and shear modulus $\\mu_{i}$. The inclusion volume fraction is $f \\in (0,1)$. Assume small strains and that phases are perfectly bonded. Suppose further that the phase contrast is parameterized by a positive scalar $c$ so that $K_{i} = c\\,K_{m}$ and $\\mu_{i} = c\\,\\mu_{m}$, with $c \\in [c_{\\min}, c_{\\max}]$, where $c_{\\min} = 0.2$ and $c_{\\max} = 5$. The composite is subjected to a macroscopically uniform hydrostatic strain so that only effective bulk response is probed.\n\nUsing only fundamental micromechanical principles applicable to this setting—namely, the linear elastic constitutive law for isotropic media, Eshelby’s solution for a spherical inclusion in an infinite isotropic matrix under uniform remote fields, Hill’s lemma for energetic consistency, and variational bounding ideas that lead to the Hashin–Shtrikman (HS) extremal bounds—perform the following:\n\n1) Starting from these principles, derive the Mori–Tanaka (MT) estimate $K_{\\mathrm{MT}}(c)$ of the effective bulk modulus in terms of $K_{m}$, $\\mu_{m}$, $f$, and $c$.\n\n2) Using the same principles, construct the Hashin–Shtrikman bound for the bulk modulus obtained by employing the matrix as the comparison medium, denoted $K_{\\mathrm{HS,mat}}(c)$, again in terms of $K_{m}$, $\\mu_{m}$, $f$, and $c$.\n\n3) Define the ratio $R(c) = K_{\\mathrm{MT}}(c)\\big/ K_{\\mathrm{HS,mat}}(c)$. Determine the value of $\\displaystyle \\sup_{c \\in [c_{\\min}, c_{\\max}]} R(c)$ and express your final answer as a dimensionless number. No units are required.\n\nThe final answer must be a single real number. If rounding were necessary, it would be specified in significant figures; here, no rounding is required.", "solution": "The analysis proceeds in three parts as requested.\n\n**1) Derivation of the Mori–Tanaka (MT) Estimate $K_{\\mathrm{MT}}(c)$**\n\nThe effective bulk modulus $K_{\\mathrm{eff}}$ relates the average hydrostatic stress, $\\bar{\\sigma}_{p} = \\frac{1}{3}\\bar{\\sigma}_{kk}$, to the average volumetric strain, $\\bar{\\varepsilon}_{v} = \\bar{\\varepsilon}_{kk}$, by $\\bar{\\sigma}_{p} = K_{\\mathrm{eff}}\\bar{\\varepsilon}_{v}$. From Hill's lemma, the macroscopic response is determined by the volume averages of the stress and strain fields. For a two-phase composite, these averages are:\n$$ \\bar{\\boldsymbol{\\varepsilon}} = (1-f)\\bar{\\boldsymbol{\\varepsilon}}_{m} + f\\bar{\\boldsymbol{\\varepsilon}}_{i} \\quad \\implies \\quad \\bar{\\varepsilon}_{v} = (1-f)\\bar{\\varepsilon}_{v,m} + f\\bar{\\varepsilon}_{v,i} $$\n$$ \\bar{\\boldsymbol{\\sigma}} = (1-f)\\bar{\\boldsymbol{\\sigma}}_{m} + f\\bar{\\boldsymbol{\\sigma}}_{i} \\quad \\implies \\quad \\bar{\\sigma}_{p} = (1-f)K_{m}\\bar{\\varepsilon}_{v,m} + f K_{i}\\bar{\\varepsilon}_{v,i} $$\nHere, subscripts $m$ and $i$ denote the matrix and inclusion phases, respectively.\n\nThe Mori–Tanaka method is based on a specific averaging scheme. It considers a single inclusion embedded in the matrix material, subjected to a far-field strain equal to the average strain in the matrix phase, $\\bar{\\boldsymbol{\\varepsilon}}_{m}$.\n\nFor a single spherical inclusion in an infinite isotropic matrix under a uniform far-field hydrostatic strain, Eshelby's solution shows that the strain field inside the inclusion is also uniform and hydrostatic. The relationship between the inclusion's volumetric strain, $\\varepsilon_{v,i}$, and the far-field volumetric strain, $\\varepsilon_{v,0}$, is given by:\n$$ \\varepsilon_{v,i} = \\frac{K_{m} + \\frac{4}{3}\\mu_{m}}{K_{i} + \\frac{4}{3}\\mu_{m}} \\varepsilon_{v,0} $$\nThe MT hypothesis sets $\\varepsilon_{v,0} = \\bar{\\varepsilon}_{v,m}$, leading to the relation:\n$$ \\bar{\\varepsilon}_{v,i} = \\frac{K_{m} + \\frac{4}{3}\\mu_{m}}{K_{i} + \\frac{4}{3}\\mu_{m}} \\bar{\\varepsilon}_{v,m} $$\nLet us define $\\alpha_{m} = \\frac{4}{3}\\mu_{m}$. Then $\\bar{\\varepsilon}_{v,i} = \\frac{K_{m}+\\alpha_{m}}{K_{i}+\\alpha_{m}}\\bar{\\varepsilon}_{v,m}$.\n\nSubstitute this into the average strain relation:\n$$ \\bar{\\varepsilon}_{v} = (1-f)\\bar{\\varepsilon}_{v,m} + f \\left(\\frac{K_{m}+\\alpha_{m}}{K_{i}+\\alpha_{m}}\\right) \\bar{\\varepsilon}_{v,m} = \\left[ 1-f + f\\frac{K_{m}+\\alpha_{m}}{K_{i}+\\alpha_{m}} \\right] \\bar{\\varepsilon}_{v,m} $$\nNow, the effective bulk modulus $K_{\\mathrm{MT}}$ is found from the average stress relation:\n$$ K_{\\mathrm{MT}} = \\frac{\\bar{\\sigma}_{p}}{\\bar{\\varepsilon}_{v}} = \\frac{(1-f)K_{m}\\bar{\\varepsilon}_{v,m} + f K_{i}\\bar{\\varepsilon}_{v,i}}{\\bar{\\varepsilon}_{v}} = \\frac{\\left[ (1-f)K_{m} + f K_{i} \\left(\\frac{K_{m}+\\alpha_{m}}{K_{i}+\\alpha_{m}}\\right) \\right] \\bar{\\varepsilon}_{v,m}}{\\left[ 1-f + f\\frac{K_{m}+\\alpha_{m}}{K_{i}+\\alpha_{m}} \\right] \\bar{\\varepsilon}_{v,m}} $$\nSimplifying this expression yields:\n$$ K_{\\mathrm{MT}} = K_{m} + \\frac{f(K_{i}-K_{m})}{1+(1-f)\\frac{K_{i}-K_{m}}{K_{m}+\\alpha_{m}}} = K_{m} + \\frac{f(K_{i}-K_{m})(K_{m}+\\alpha_{m})}{K_{m}+\\alpha_{m}+(1-f)(K_{i}-K_{m})} $$\nUsing the given parameterization $K_{i}=c K_{m}$, we get:\n$$ K_{\\mathrm{MT}}(c) = K_{m} + \\frac{f(c-1)K_{m}}{1+(1-f)\\frac{(c-1)K_{m}}{K_{m} + \\frac{4}{3}\\mu_{m}}} $$\n\n**2) Construction of the Hashin–Shtrikman Bound $K_{\\mathrm{HS,mat}}(c)$**\n\nThe Hashin–Shtrikman (HS) bounds are derived from a variational principle using a polarization stress or strain field within a homogeneous comparison medium. For a two-phase composite, choosing one of the constituent phases as the comparison medium yields the bounds. The problem specifies using the matrix as the comparison medium.\n\nFor statistically isotropic composites, the HS bounds on the effective bulk modulus are given by the general formula:\n$$ K_{\\mathrm{HS}}^{\\pm} = K_{1} + \\frac{f_{2}}{\\frac{1}{K_{2}-K_{1}} + \\frac{f_{1}}{K_{1} + \\frac{4}{3}\\mu_{1}}} $$\nwhere phase $1$ is the comparison medium and phase $2$ is the other phase. The result is the lower bound $K_{\\mathrm{HS}}^{-}$ if phase $1$ is the softer phase ($K_1<K_2, \\mu_1<\\mu_2$), and the upper bound $K_{\\mathrm{HS}}^{+}$ if phase $1$ is the stiffer phase.\n\nThe problem asks for $K_{\\mathrm{HS,mat}}(c)$, which is the bound obtained when the matrix is the comparison medium. Thus, we set phase $1$ as the matrix ($m$) and phase $2$ as the inclusion ($i$). The volume fractions are $f_1 = 1-f$ and $f_2 = f$.\n$$ K_{\\mathrm{HS,mat}} = K_{m} + \\frac{f}{\\frac{1}{K_{i}-K_{m}} + \\frac{1-f}{K_{m} + \\frac{4}{3}\\mu_{m}}} $$\nRearranging this expression:\n$$ K_{\\mathrm{HS,mat}} = K_{m} + \\frac{f(K_{i}-K_{m})}{1+(1-f)\\frac{K_{i}-K_{m}}{K_{m}+\\frac{4}{3}\\mu_{m}}} $$\nSubstituting $K_{i}=c K_{m}$:\n$$ K_{\\mathrm{HS,mat}}(c) = K_{m} + \\frac{f(c-1)K_{m}}{1+(1-f)\\frac{(c-1)K_{m}}{K_{m} + \\frac{4}{3}\\mu_{m}}} $$\nThese bounds are known to be attainable by a special microstructure, the \"composite spheres assemblage,\" which rigorously validates this formula.\n\nBy direct comparison of the expressions derived in Part 1 and Part 2, it is evident that for spherical inclusions, the Mori–Tanaka estimate for the effective bulk modulus is identical to the Hashin–Shtrikman bound obtained when the matrix is the comparison material.\n$$ K_{\\mathrm{MT}}(c) = K_{\\mathrm{HS,mat}}(c) $$\nThis is a fundamental result in micromechanics for this specific class of heterogeneous materials.\n\n**3) Determination of $\\displaystyle \\sup_{c \\in [c_{\\min}, c_{\\max}]} R(c)$**\n\nThe ratio $R(c)$ is defined as:\n$$ R(c) = \\frac{K_{\\mathrm{MT}}(c)}{K_{\\mathrm{HS,mat}}(c)} $$\nFrom the derivations above, we have established that $K_{\\mathrm{MT}}(c) = K_{\\mathrm{HS,mat}}(c)$ for all values of $f$, $c$, $K_{m}$, and $\\mu_{m}$ for which the moduli are physically meaningful (i.e., positive). The denominator $K_{\\mathrm{HS,mat}}(c)$ corresponds to an effective modulus of a stable composite and is therefore non-zero and positive for the given range of $c \\in [0.2, 5]$.\n\nTherefore, the ratio is identically equal to unity:\n$$ R(c) = 1, \\quad \\forall c \\in [0.2, 5] $$\nThe problem asks for the supremum of this function over the specified interval. The supremum of a constant function is the constant itself.\n$$ \\sup_{c \\in [0.2, 5]} R(c) = \\sup_{c \\in [0.2, 5]} (1) = 1 $$", "answer": "$$\\boxed{1}$$", "id": "2662631"}, {"introduction": "This final practice transitions from analytical estimates to computational micromechanics by introducing the Differential Effective Medium (DEM) scheme. You will formulate the governing ordinary differential equations (ODEs) that describe the evolution of effective properties as inclusions are incrementally added to a matrix. The core of this hands-on task is to then implement a numerical solver to integrate these ODEs, transforming theoretical equations into a predictive computational tool for material design. [@problem_id:2662617]", "problem": "You are tasked with deriving and implementing the Differential Effective Medium (DEM) scheme for an isotropic two-phase composite with spherical inclusions. The composite is formed by incrementally adding a small volume fraction of inclusions with isotropic elastic moduli into a homogeneous isotropic matrix. The goal is to formulate the Ordinary Differential Equation (ODE) governing the evolution of the effective isotropic moduli with inclusion volume fraction and to integrate this ODE numerically.\n\nStarting from the fundamental laws and core definitions of linear elasticity (Hooke’s law for isotropic materials), together with the well-tested dilute inclusion response based on the classical single-inclusion solution in an infinite matrix, derive the coupled ODE system for the bulk modulus $K(\\phi)$ and the shear modulus $G(\\phi)$ as functions of the inclusion volume fraction $\\phi$. The derivation must begin with:\n- The definition of the isotropic stiffness in terms of the bulk modulus $K$ and shear modulus $G$.\n- The dilute concentration factors for a single spherical inclusion embedded in an infinite matrix.\n- Conservation of total volume during incremental addition of inclusions, and the fact that the DEM increment is referenced to the remaining fraction $1 - \\phi$ of the composite that has not yet been replaced by inclusions.\n\nThen, implement a program that:\n1. Uses your derived ODE system to compute the effective moduli by integrating from $\\phi = 0$ with initial conditions $K(0) = K_{\\mathrm{m}}$ and $G(0) = G_{\\mathrm{m}}$, where $K_{\\mathrm{m}}$ and $G_{\\mathrm{m}}$ are the matrix moduli.\n2. For each test case listed below, integrates to the specified final inclusion volume fraction $\\phi_{\\mathrm{end}}$ and evaluates physically motivated logical conditions on the computed effective moduli to verify the implementation.\n\nPhysical assumptions and modeling choices you must adopt:\n- Both phases are linearly elastic, homogeneous, and isotropic.\n- Inclusions are spherical and non-interacting in the incremental step (dilute), and the inclusion fields are evaluated in the current effective medium.\n- The DEM increment is referenced to the remaining host volume $1 - \\phi$.\n- The overall medium remains mechanically stable, that is, $K(\\phi) > 0$ and $G(\\phi) > 0$ for all $\\phi$ considered.\n\nAll elastic moduli must be treated in gigapascals (GPa). The inclusion volume fraction $\\phi$ is dimensionless and must be expressed as a decimal number (not a percentage). Although your program must compute the effective moduli in $\\mathrm{GPa}$, the final reported results for this task are booleans that test correctness properties of the computed moduli, so no physical units appear in the final output.\n\nTest suite. For each test case, the parameters are given as $(K_{\\mathrm{m}}, G_{\\mathrm{m}}, K_{\\mathrm{i}}, G_{\\mathrm{i}}, \\phi_{\\mathrm{end}})$, where subscripts $\\mathrm{m}$ and $\\mathrm{i}$ denote matrix and inclusion, respectively. All moduli are in $\\mathrm{GPa}$ and all numbers must be interpreted exactly as written:\n- Test case $1$: $(37.0, 14.0, 140.0, 60.0, 0.30)$\n- Test case $2$: $(37.0, 14.0, 0.0, 0.0, 0.35)$\n- Test case $3$: $(50.0, 20.0, 5.0, 2.0, 0.25)$\n- Test case $4$: $(70.0, 30.0, 70.0, 30.0, 0.60)$\n- Test case $5$: $(30.0, 12.0, 200.0, 90.0, 0.0)$\n\nFor each test case, compute $(K_{\\mathrm{eff}}, G_{\\mathrm{eff}})$ at $\\phi = \\phi_{\\mathrm{end}}$ and evaluate a single boolean according to the following rule:\n- If $\\phi_{\\mathrm{end}} = 0$, return true if $K_{\\mathrm{eff}}$ equals $K_{\\mathrm{m}}$ and $G_{\\mathrm{eff}}$ equals $G_{\\mathrm{m}}$ within a small numerical tolerance.\n- If $(K_{\\mathrm{i}}, G_{\\mathrm{i}}) = (K_{\\mathrm{m}}, G_{\\mathrm{m}})$, return true if $K_{\\mathrm{eff}}$ equals $K_{\\mathrm{m}}$ and $G_{\\mathrm{eff}}$ equals $G_{\\mathrm{m}}$ within a small numerical tolerance for the given $\\phi_{\\mathrm{end}}$.\n- If $K_{\\mathrm{i}} > K_{\\mathrm{m}}$ and $G_{\\mathrm{i}} > G_{\\mathrm{m}}$ (stiff inclusions), return true if $K_{\\mathrm{m}} < K_{\\mathrm{eff}} < K_{\\mathrm{i}}$ and $G_{\\mathrm{m}} < G_{\\mathrm{eff}} < G_{\\mathrm{i}}$.\n- If $K_{\\mathrm{i}} < K_{\\mathrm{m}}$ and $G_{\\mathrm{i}} < G_{\\mathrm{m}}$ (soft inclusions), return true if $K_{\\mathrm{i}} < K_{\\mathrm{eff}} < K_{\\mathrm{m}}$ and $G_{\\mathrm{i}} < G_{\\mathrm{eff}} < G_{\\mathrm{m}}$.\n- Otherwise, return true if each of $K_{\\mathrm{eff}}$ and $G_{\\mathrm{eff}}$ strictly lies between its corresponding phase moduli.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[true,false,true,true,false]\"), in the exact order of the test suite listed above. The output booleans must be capitalized as in the Python language, that is, \"True\" or \"False\".", "solution": "The objective is to derive and implement the governing equations for the effective elastic moduli of a two-phase isotropic composite material using the Differential Effective Medium (DEM) scheme. The composite consists of a matrix phase with bulk modulus $K_{\\mathrm{m}}$ and shear modulus $G_{\\mathrm{m}}$, and an inclusion phase with moduli $K_{\\mathrm{i}}$ and $G_{\\mathrm{i}}$. The inclusions are assumed to be spherical and are incrementally added to the matrix.\n\nThe foundation of any homogenization scheme for linear elastic composites is Hooke's law. For an isotropic material, the stiffness tensor $\\mathbb{C}$ relates the stress tensor $\\sigma$ and strain tensor $\\epsilon$ as $\\sigma = \\mathbb{C} : \\epsilon$. This relation can be decomposed into volumetric and deviatoric parts, using the bulk modulus $K$ and shear modulus $G$ as:\n$$\n\\sigma_{kk} = 3K \\epsilon_{kk}\n$$\n$$\ns = 2G e\n$$\nwhere $\\sigma_{kk}$ is the trace of the stress tensor, $\\epsilon_{kk}$ is the trace of the strain tensor, $s$ is the deviatoric stress tensor, and $e$ is the deviatoric strain tensor.\n\nThe DEM scheme is an iterative homogenization procedure. We begin with a pure matrix material at an inclusion volume fraction $\\phi = 0$, for which the effective moduli are trivially $K(0) = K_{\\mathrm{m}}$ and $G(0) = G_{\\mathrm{m}}$. We then imagine adding an infinitesimal volume fraction of inclusions to the current homogenized medium.\n\nConsider a composite at an inclusion volume fraction $\\phi$, with known effective moduli $K(\\phi)$ and $G(\\phi)$. This composite is now treated as the effective matrix for the next incremental step. We add a small volume of inclusions, $dV_{\\mathrm{i}}$, which displaces an equal volume of the effective matrix material. The total volume of the composite is $V$. The volume fraction of the added inclusions with respect to the remaining host material (of volume $(1-\\phi)V$) is given by:\n$$\nd\\phi' = \\frac{dV_{\\mathrm{i}}}{(1-\\phi)V}\n$$\nThe change in the overall inclusion volume fraction, $d\\phi$, is $dV_{\\mathrm{i}}/V$. From this, we establish the crucial relationship for the DEM scheme:\n$$\nd\\phi' = \\frac{d\\phi}{1-\\phi}\n$$\nThe problem is now reduced to finding the change in effective moduli, $dK$ and $dG$, when a small volume fraction $d\\phi'$ of inclusions is added to a matrix with current properties $K(\\phi)$ and $G(\\phi)$. For this, we use the dilute estimate, which is exact in the limit of infinitesimal concentrations. The effective moduli of a dilute suspension of spherical inclusions in a matrix are given by:\n$$\nK_{\\mathrm{eff}} = K_{\\mathrm{matrix}} + d\\phi' (K_{\\mathrm{i}} - K_{\\mathrm{matrix}}) P\n$$\n$$\nG_{\\mathrm{eff}} = G_{\\mathrm{matrix}} + d\\phi' (G_{\\mathrm{i}} - G_{\\mathrm{matrix}}) Q\n$$\nwhere $P$ and $Q$ are concentration factors derived from the solution to the single inclusion problem (Eshelby's problem). For spherical inclusions in an isotropic matrix, these factors depend on the moduli of both the inclusion and the matrix. In our iterative scheme, the \"matrix\" is the effective medium at volume fraction $\\phi$. Thus, we have:\n$$\nK(\\phi) + dK = K(\\phi) + \\frac{d\\phi}{1-\\phi} (K_{\\mathrm{i}} - K(\\phi)) P(\\phi)\n$$\n$$\nG(\\phi) + dG = G(\\phi) + \\frac{d\\phi}{1-\\phi} (G_{\\mathrm{i}} - G(\\phi)) Q(\\phi)\n$$\nThe concentration factors $P(\\phi)$ and $Q(\\phi)$ are functions of the current effective moduli $K(\\phi)$ and $G(\\phi)$:\n$$\nP(\\phi) = \\frac{K(\\phi) + \\frac{4}{3}G(\\phi)}{K_{\\mathrm{i}} + \\frac{4}{3}G(\\phi)}\n$$\n$$\nQ(\\phi) = \\frac{G(\\phi) + F(\\phi)}{G_{\\mathrm{i}} + F(\\phi)}\n$$\nwhere the term $F(\\phi)$ is a function of the effective moduli, defined as:\n$$\nF(\\phi) = \\frac{G(\\phi) \\left( 9K(\\phi) + 8G(\\phi) \\right)}{6 \\left( K(\\phi) + 2G(\\phi) \\right)}\n$$\nBy rearranging the incremental equations, we arrive at a system of coupled first-order ordinary differential equations (ODEs) for the effective moduli as functions of the inclusion volume fraction $\\phi$:\n$$\n\\frac{dK}{d\\phi} = \\frac{K_{\\mathrm{i}} - K}{1-\\phi} \\left( \\frac{K + \\frac{4}{3}G}{K_{\\mathrm{i}} + \\frac{4}{3}G} \\right)\n$$\n$$\n\\frac{dG}{d\\phi} = \\frac{G_{\\mathrm{i}} - G}{1-\\phi} \\left( \\frac{G + F}{G_{\\mathrm{i}} + F} \\right) \\quad \\text{with} \\quad F = \\frac{G(9K + 8G)}{6(K + 2G)}\n$$\nThese equations are to be integrated from $\\phi = 0$ to the desired final volume fraction $\\phi_{\\mathrm{end}}$. The initial conditions are those of the pure matrix material:\n$$\nK(0) = K_{\\mathrm{m}}\n$$\n$$\nG(0) = G_{\\mathrm{m}}\n$$\nThe numerical implementation will involve a standard ODE solver, such as `solve_ivp` from the `scipy.integrate` library in Python. A function will be defined to compute the right-hand side of the ODE system, i.e., the derivatives $[dK/d\\phi, dG/d\\phi]$, given the current state $[\\phi, (K, G)]$. This function will be passed to the solver, along with the integration interval $[0, \\phi_{\\mathrm{end}}]$ and the initial state vector $[K_{\\mathrm{m}}, G_{\\mathrm{m}}]$.\n\nFor each test case provided, the program must:\n1.  Set the material parameters $(K_{\\mathrm{m}}, G_{\\mathrm{m}}, K_{\\mathrm{i}}, G_{\\mathrm{i}})$ and the final volume fraction $\\phi_{\\mathrm{end}}$.\n2.  Solve the ODE system to find the effective moduli $K_{\\mathrm{eff}} = K(\\phi_{\\mathrm{end}})$ and $G_{\\mathrm{eff}} = G(\\phi_{\\mathrm{end}})$.\n3.  Evaluate the specified logical conditions to determine the boolean result. These conditions serve as physical and numerical consistency checks, verifying that the computed moduli behave as expected (e.g., they lie within the bounds of the constituent moduli) and that the implementation correctly handles trivial cases (e.g., zero inclusion content or identical phases).\n\nThis concludes the theoretical formulation required for the computational task. The provided physical assumptions, such as linear elasticity and isotropy, are embedded within this derivation. The condition of mechanical stability, $K(\\phi) > 0$ and $G(\\phi) > 0$, is expected to hold for the given material parameters. Special attention is required for the case of voids ($K_{\\mathrm{i}}=0, G_{\\mathrm{i}}=0$), but the structure of the ODEs is robust against division by zero provided the effective moduli remain positive.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and implements the Differential Effective Medium (DEM) scheme\n    for a two-phase composite with spherical inclusions.\n    \"\"\"\n\n    test_cases = [\n        # (K_m, G_m, K_i, G_i, phi_end) in GPa\n        (37.0, 14.0, 140.0, 60.0, 0.30),  # Test case 1: Stiff inclusions\n        (37.0, 14.0, 0.0, 0.0, 0.35),     # Test case 2: Voids (soft inclusions)\n        (50.0, 20.0, 5.0, 2.0, 0.25),     # Test case 3: Soft inclusions\n        (70.0, 30.0, 70.0, 30.0, 0.60),   # Test case 4: Identical phases\n        (30.0, 12.0, 200.0, 90.0, 0.0),    # Test case 5: Zero volume fraction\n    ]\n\n    results = []\n\n    for case in test_cases:\n        K_m, G_m, K_i, G_i, phi_end = case\n\n        # If integration interval is zero, the result is the initial condition.\n        if phi_end == 0.0:\n            K_eff, G_eff = K_m, G_m\n        else:\n            # Define the coupled ODE system for the DEM scheme.\n            def dem_ode(phi, y, K_i_val, G_i_val):\n                K, G = y\n                \n                #\n                # The state variables K and G must remain positive to be physical.\n                # If they ever become non-positive, something is wrong.\n                # We add a small epsilon to denominators to prevent division by zero\n                # in edge cases, though the physics should prevent this.\n                #\n                epsilon = 1e-12\n\n                # If K or G is non-positive, stop or return large gradient to let solver know\n                if K = 0 or G = 0:\n                    return [np.inf, np.inf]\n                \n                # Check for identical phases, which should result in zero change.\n                if np.isclose(K_i_val, K) and np.isclose(G_i_val, G):\n                    return [0.0, 0.0]\n\n                # F-term calculation\n                F = (G * (9.0 * K + 8.0 * G)) / (6.0 * (K + 2.0 * G))\n\n                # Denominators in concentration factors\n                denom_K = K_i_val + (4.0/3.0) * G\n                denom_G = G_i_val + F\n                \n                # Derivatives (dK/dphi, dG/dphi)\n                # Note the 1/(1-phi) term.\n                if phi >= 1.0:\n                   # This should not be reached by the solver if phi_end  1\n                   dK_dphi = np.inf\n                   dG_dphi = np.inf\n                else:\n                    dK_dphi = ((K_i_val - K) / (1.0 - phi)) * \\\n                              ((K + (4.0/3.0) * G) / (denom_K + epsilon))\n                    \n                    dG_dphi = ((G_i_val - G) / (1.0 - phi)) * \\\n                              ((G + F) / (denom_G + epsilon))\n                \n                return [dK_dphi, dG_dphi]\n\n            # Initial conditions\n            y0 = [K_m, G_m]\n            \n            # Integration span\n            phi_span = [0, phi_end]\n\n            # Solve the ODE system\n            sol = solve_ivp(\n                dem_ode,\n                phi_span,\n                y0,\n                args=(K_i, G_i),\n                method='RK45',\n                dense_output=True\n            )\n            \n            # Extract the final values for K_eff and G_eff\n            K_eff, G_eff = sol.sol(phi_end)\n\n        # Evaluate the logical conditions as per the problem statement\n        is_correct = False\n        if phi_end == 0:\n            is_correct = np.isclose(K_eff, K_m) and np.isclose(G_eff, G_m)\n        elif np.isclose(K_i, K_m) and np.isclose(G_i, G_m):\n            is_correct = np.isclose(K_eff, K_m) and np.isclose(G_eff, G_m)\n        elif K_i > K_m and G_i > G_m:  # Stiff inclusions\n            is_correct = (K_m  K_eff  K_i) and (G_m  G_eff  G_i)\n        elif K_i  K_m and G_i  G_m:  # Soft inclusions (including voids)\n            is_correct = (K_i  K_eff  K_m) and (G_i  G_eff  G_m)\n        else: # Mixed stiffness\n            is_correct = (min(K_m, K_i)  K_eff  max(K_m, K_i)) and \\\n                         (min(G_m, G_i)  G_eff  max(G_m, G_i))\n\n        results.append(is_correct)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2662617"}]}