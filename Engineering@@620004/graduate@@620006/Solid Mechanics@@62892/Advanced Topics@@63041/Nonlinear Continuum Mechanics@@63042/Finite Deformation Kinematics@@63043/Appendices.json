{"hands_on_practices": [{"introduction": "Before delving into complex deformations, we must first establish what constitutes a physically possible transformation of a material body. This practice explores the fundamental principle of the impenetrability of matter, which translates into a strict mathematical constraint on the deformation mapping. By analyzing a hypothetical mapping [@problem_id:2639552], you will calculate the Jacobian determinant $J = \\det(\\mathbf{F})$ and articulate why its sign is critical for physical admissibility, ensuring that matter does not pass through itself and that volume remains a positive quantity.", "problem": "A deformation of a continuum body from a reference configuration with material coordinates $\\boldsymbol{X} = (X_{1},X_{2},X_{3})$ to the current configuration with spatial coordinates $\\boldsymbol{x} = (x_{1},x_{2},x_{3})$ is given by the smooth mapping $\\boldsymbol{x} = \\boldsymbol{\\chi}(\\boldsymbol{X})$ defined on the reference domain $\\mathcal{B}_{0} = \\{ \\boldsymbol{X} \\in \\mathbb{R}^{3} \\}$ by\n$$\nx_{1} = -2\\,X_{1} + X_{2}\\,X_{3}, \\qquad\nx_{2} = 3\\,X_{2}, \\qquad\nx_{3} = \\tfrac{1}{3}\\,X_{3}.\n$$\nStarting from the fundamental definitions of a deformation mapping, the deformation gradient, and the local volume ratio, carry out the following:\n\n1. Derive the deformation gradient $\\boldsymbol{F}(\\boldsymbol{X})$ and its Jacobian determinant $J(\\boldsymbol{X})$ for this mapping, using first principles (no pre-stated formulas beyond those definitions).\n2. Evaluate $J$ at the material point $\\boldsymbol{X}^{\\ast} = (1,-2,3)$.\n3. Using only core kinematic principles (local volume change, orientation preservation, and the requirement that rigid-body motions be represented by proper rotations), explain why the sign you obtain for $J(\\boldsymbol{X}^{\\ast})$ renders this mapping physically inadmissible as a deformation of matter, even though the mapping is smooth and locally invertible at $\\boldsymbol{X}^{\\ast}$.\n\nExpress your final answer to part 2 as a pure number (dimensionless). No rounding is required.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of finite deformation kinematics, is well-posed with all necessary information provided, and is expressed in objective, mathematical language. It requires a standard derivation and a physical interpretation based on first principles, which is a legitimate task in solid mechanics. I will now proceed with the solution.\n\nThe problem requires a three-part analysis of a given deformation mapping. The mapping describes the final spatial coordinates $\\boldsymbol{x} = (x_{1}, x_{2}, x_{3})$ of a material point as a function of its initial reference coordinates $\\boldsymbol{X} = (X_{1}, X_{2}, X_{3})$. The mapping $\\boldsymbol{x} = \\boldsymbol{\\chi}(\\boldsymbol{X})$ is given by the component functions:\n$$\nx_{1} = -2X_{1} + X_{2}X_{3} \\\\\nx_{2} = 3X_{2} \\\\\nx_{3} = \\frac{1}{3}X_{3}\n$$\n\nPart 1: Derivation of the deformation gradient $\\boldsymbol{F}$ and its Jacobian determinant $J$.\n\nThe deformation gradient tensor, $\\boldsymbol{F}$, is defined as the gradient of the deformation mapping $\\boldsymbol{\\chi}$ with respect to the material coordinates $\\boldsymbol{X}$. In component form, its elements $F_{ij}$ are given by the partial derivatives of the spatial coordinates with respect to the material coordinates:\n$$\nF_{ij} = \\frac{\\partial x_{i}}{\\partial X_{j}}\n$$\nWe compute these nine components explicitly for the given mapping.\n\nFor $i=1$:\n$$\nF_{11} = \\frac{\\partial x_{1}}{\\partial X_{1}} = \\frac{\\partial}{\\partial X_{1}}(-2X_{1} + X_{2}X_{3}) = -2 \\\\\nF_{12} = \\frac{\\partial x_{1}}{\\partial X_{2}} = \\frac{\\partial}{\\partial X_{2}}(-2X_{1} + X_{2}X_{3}) = X_{3} \\\\\nF_{13} = \\frac{\\partial x_{1}}{\\partial X_{3}} = \\frac{\\partial}{\\partial X_{3}}(-2X_{1} + X_{2}X_{3}) = X_{2}\n$$\n\nFor $i=2$:\n$$\nF_{21} = \\frac{\\partial x_{2}}{\\partial X_{1}} = \\frac{\\partial}{\\partial X_{1}}(3X_{2}) = 0 \\\\\nF_{22} = \\frac{\\partial x_{2}}{\\partial X_{2}} = \\frac{\\partial}{\\partial X_{2}}(3X_{2}) = 3 \\\\\nF_{23} = \\frac{\\partial x_{2}}{\\partial X_{3}} = \\frac{\\partial}{\\partial X_{3}}(3X_{2}) = 0\n$$\n\nFor $i=3$:\n$$\nF_{31} = \\frac{\\partial x_{3}}{\\partial X_{1}} = \\frac{\\partial}{\\partial X_{1}}(\\frac{1}{3}X_{3}) = 0 \\\\\nF_{32} = \\frac{\\partial x_{3}}{\\partial X_{2}} = \\frac{\\partial}{\\partial X_{2}}(\\frac{1}{3}X_{3}) = 0 \\\\\nF_{33} = \\frac{\\partial x_{3}}{\\partial X_{3}} = \\frac{\\partial}{\\partial X_{3}}(\\frac{1}{3}X_{3}) = \\frac{1}{3}\n$$\n\nAssembling these components into a matrix representation, the deformation gradient $\\boldsymbol{F}(\\boldsymbol{X})$ is:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} -2 & X_{3} & X_{2} \\\\ 0 & 3 & 0 \\\\ 0 & 0 & \\frac{1}{3} \\end{pmatrix}\n$$\nThe Jacobian determinant, $J(\\boldsymbol{X})$, is the determinant of the deformation gradient matrix, $J = \\det(\\boldsymbol{F})$. For the derived matrix $\\boldsymbol{F}$, which is an upper triangular matrix, the determinant is the product of its diagonal elements:\n$$\nJ(\\boldsymbol{X}) = \\det(\\boldsymbol{F}) = (-2) \\cdot (3) \\cdot (\\frac{1}{3}) = -2\n$$\nWe observe that the Jacobian $J$ is a constant value, independent of the material point $\\boldsymbol{X}$.\n\nPart 2: Evaluation of $J$ at the material point $\\boldsymbol{X}^{\\ast} = (1, -2, 3)$.\n\nAs determined above, the Jacobian $J$ is constant for all $\\boldsymbol{X}$. Therefore, its value at the specific point $\\boldsymbol{X}^{\\ast} = (1, -2, 3)$ is simply this constant value.\n$$\nJ(\\boldsymbol{X}^{\\ast}) = -2\n$$\n\nPart 3: Explanation of physical inadmissibility.\n\nThe Jacobian determinant $J$ has a fundamental physical interpretation as the local volume ratio. Specifically, it relates an infinitesimal volume element $dV$ in the reference configuration $\\mathcal{B}_{0}$ to the corresponding infinitesimal volume element $dv$ in the current configuration $\\mathcal{B}$ via the relation:\n$$\ndv = J\\,dV\n$$\nA volume element, whether in the reference or current configuration, must represent a physical volume occupied by matter. By definition, physical volume must be a positive quantity. Therefore, we must have $dV > 0$ and $dv > 0$. For the equality $dv = J\\,dV$ to hold true under these physical constraints, it is a mathematical necessity that the Jacobian $J$ must be strictly positive:\n$$\nJ > 0\n$$\nA value of $J \\leq 0$ violates this fundamental requirement.\n\nThe sign of $J$ determines the local orientation of the material. A positive Jacobian, $J > 0$, signifies that the mapping preserves the local orientation of the material. For instance, a right-handed system of infinitesimal vectors embedded in the material remains right-handed after deformation. This is consistent with all physically possible deformations, including stretch, shear, and rigid-body rotation. A rigid-body motion must be a proper rotation, represented by an orthogonal tensor $\\boldsymbol{Q}$ with $\\det(\\boldsymbol{Q}) = +1$. The condition $J>0$ is the general kinematic extension of this principle to deformable bodies.\n\nA negative Jacobian, $J < 0$, implies a local inversion of the material element, equivalent to a reflection. This would mean that a right-handed material basis is mapped into a left-handed one. Such a transformation requires matter to pass through itself, which is a violation of the principle of impenetrability of matter. It is not a physically admissible process for a continuous material body.\n\nIn this problem, we calculated that $J(\\boldsymbol{X}^{\\ast}) = -2$. The negative sign indicates that the deformation mapping attempts to invert the material orientation at the point $\\boldsymbol{X}^{\\ast}$ (and, indeed, at all points, since $J$ is constant). While the mapping is smooth and mathematically invertible at $\\boldsymbol{X}^{\\ast}$ (since $J \\neq 0$), it is physically inadmissible because it would require a local configuration where matter penetrates itself, which is impossible. Therefore, the proposed mapping cannot represent a real deformation of a physical body.", "answer": "$$\n\\boxed{-2}\n$$", "id": "2639552"}, {"introduction": "A common pitfall in transitioning from infinitesimal to finite strain theory is misinterpreting the displacement gradient as a measure of deformation. This exercise serves as a crucial counterexample, demonstrating how a pure rigid body rotation can induce a large displacement gradient while the material experiences zero actual strain [@problem_id:2639548]. Working through this will solidify your understanding of why objective, frame-indifferent measures like the Green–Lagrange strain tensor $\\mathbf{E}$ are essential for correctly characterizing finite deformations.", "problem": "A three-dimensional elastic body undergoes a homogeneous rigid rotation about the fixed $z$-axis by an angle $\\theta = \\frac{2\\pi}{3}$ (radians). The motion is defined by $\\boldsymbol{x} = \\boldsymbol{R} \\boldsymbol{X}$ with respect to a reference configuration, where\n$$\n\\boldsymbol{R} =\n\\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta & 0 \\\\\n\\sin\\theta & \\phantom{-}\\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\nStarting only from the foundational definitions of the deformation gradient $\\boldsymbol{F}$, the Right Cauchy–Green tensor $\\boldsymbol{C}$, the Green–Lagrange strain tensor $\\boldsymbol{E}$, the left Cauchy–Green tensor $\\boldsymbol{b}$, and the Euler–Almansi strain tensor $\\boldsymbol{e}$, do the following:\n\n- Derive $\\boldsymbol{F}$ for this motion and use it to demonstrate that both $\\boldsymbol{E}$ and $\\boldsymbol{e}$ vanish everywhere in the body.\n- Define the displacement field $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$ and compute the material displacement gradient $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$.\n- Compute the Frobenius norm of the material displacement gradient, $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$, where $\\| \\boldsymbol{A} \\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{A}^{\\mathsf{T}} \\boldsymbol{A})}$ for any second-order tensor $\\boldsymbol{A}$.\n\nThis construction serves as a counterexample showing that large rigid body rotations can produce a large displacement gradient while leaving all strain tensors equal to zero. Report as your final answer the exact value of $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$ for $\\theta = \\frac{2\\pi}{3}$. No units are required. Express your answer in exact form; do not approximate or round.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted.\n- Motion: $\\boldsymbol{x} = \\boldsymbol{R} \\boldsymbol{X}$\n- Rotation matrix:\n$$\n\\boldsymbol{R} =\n\\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta & 0 \\\\\n\\sin\\theta & \\phantom{-}\\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n- Angle of rotation: $\\theta = \\frac{2\\pi}{3}$\n- Foundational definitions: Deformation gradient $\\boldsymbol{F}$, Right Cauchy–Green tensor $\\boldsymbol{C}$, Green–Lagrange strain tensor $\\boldsymbol{E}$, left Cauchy–Green tensor $\\boldsymbol{b}$, Euler–Almansi strain tensor $\\boldsymbol{e}$.\n- Displacement field: $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$\n- Material displacement gradient: $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$\n- Frobenius norm: $\\| \\boldsymbol{A} \\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{A}^{\\mathsf{T}} \\boldsymbol{A})}$\n\nValidation proceeds. The problem is a standard exercise in continuum mechanics, specifically in the topic of finite deformation kinematics. It is scientifically grounded, well-posed, objective, and internally consistent. It contains all necessary information for a unique solution. The problem serves to illustrate the important distinction between the displacement gradient, which can be large in a rigid rotation, and strain, which is zero for such a motion. The problem statement is therefore valid. We proceed to the solution.\n\nThe motion of the body is given by the mapping $\\boldsymbol{x} = \\boldsymbol{x}(\\boldsymbol{X}) = \\boldsymbol{R}\\boldsymbol{X}$, where $\\boldsymbol{X}$ is the position vector of a particle in the reference configuration and $\\boldsymbol{x}$ is its position in the current configuration. The matrix $\\boldsymbol{R}$ is constant for this homogeneous deformation.\n\nStep 1: Derive the deformation gradient $\\boldsymbol{F}$ and strain tensors $\\boldsymbol{E}$ and $\\boldsymbol{e}$.\nThe deformation gradient tensor $\\boldsymbol{F}$ is defined as the material gradient of the motion:\n$$\n\\boldsymbol{F} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} = \\nabla_{\\! \\boldsymbol{X}} (\\boldsymbol{R}\\boldsymbol{X})\n$$\nSince $\\boldsymbol{R}$ is a constant matrix with respect to the material coordinates $\\boldsymbol{X}$, the derivative is simply:\n$$\n\\boldsymbol{F} = \\boldsymbol{R}\n$$\nThe Right Cauchy–Green tensor $\\boldsymbol{C}$ is defined as $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$. Substituting $\\boldsymbol{F} = \\boldsymbol{R}$:\n$$\n\\boldsymbol{C} = \\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R}\n$$\nThe matrix $\\boldsymbol{R}$ represents a rotation, which is an orthogonal transformation. A property of any orthogonal tensor is that its transpose is its inverse, so $\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the second-order identity tensor. Therefore:\n$$\n\\boldsymbol{C} = \\boldsymbol{I}\n$$\nThe Green–Lagrange strain tensor $\\boldsymbol{E}$ is defined as $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$. Using our result for $\\boldsymbol{C}$:\n$$\n\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{I}) = \\boldsymbol{O}\n$$\nwhere $\\boldsymbol{O}$ is the zero tensor.\n\nNext, we consider the spatial strain tensor. The left Cauchy–Green tensor $\\boldsymbol{b}$ is defined as $\\boldsymbol{b} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$. Substituting $\\boldsymbol{F} = \\boldsymbol{R}$:\n$$\n\\boldsymbol{b} = \\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}}\n$$\nAgain, from the orthogonality of $\\boldsymbol{R}$, we have $\\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}} = \\boldsymbol{I}$. Thus:\n$$\n\\boldsymbol{b} = \\boldsymbol{I}\n$$\nThe Euler–Almansi strain tensor $\\boldsymbol{e}$ is defined as $\\boldsymbol{e} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{b}^{-1})$. Since $\\boldsymbol{b} = \\boldsymbol{I}$, its inverse is also the identity, $\\boldsymbol{b}^{-1} = \\boldsymbol{I}^{-1} = \\boldsymbol{I}$. Substituting this into the definition of $\\boldsymbol{e}$:\n$$\n\\boldsymbol{e} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{I}) = \\boldsymbol{O}\n$$\nBoth the Green–Lagrange and Euler–Almansi strain tensors are zero, which is the correct and expected result for a rigid body motion, as it induces no deformation or stretching.\n\nStep 2: Compute the material displacement gradient, $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$.\nThe displacement vector field $\\boldsymbol{u}$ is defined as $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$. Substituting the given motion $\\boldsymbol{x} = \\boldsymbol{R}\\boldsymbol{X}$:\n$$\n\\boldsymbol{u} = \\boldsymbol{R}\\boldsymbol{X} - \\boldsymbol{X} = (\\boldsymbol{R} - \\boldsymbol{I})\\boldsymbol{X}\n$$\nThe material displacement gradient is the tensor $\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u} = \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}}$.\n$$\n\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} [(\\boldsymbol{R} - \\boldsymbol{I})\\boldsymbol{X}]\n$$\nSince the tensor $(\\boldsymbol{R} - \\boldsymbol{I})$ is constant for a homogeneous motion:\n$$\n\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u} = \\boldsymbol{R} - \\boldsymbol{I}\n$$\nThis demonstrates that even with zero strain, the displacement gradient is non-zero.\n\nStep 3: Compute the Frobenius norm of the material displacement gradient, $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$.\nThe Frobenius norm is defined as $\\|\\boldsymbol{H}\\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H})}$. We first compute the product $\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}$:\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = (\\boldsymbol{R} - \\boldsymbol{I})^{\\mathsf{T}}(\\boldsymbol{R} - \\boldsymbol{I}) = (\\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{I})(\\boldsymbol{R} - \\boldsymbol{I})\n$$\nExpanding the product gives:\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = \\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} - \\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{R} + \\boldsymbol{I}\n$$\nUsing the orthogonality property $\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\boldsymbol{I}$:\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = \\boldsymbol{I} - \\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{R} + \\boldsymbol{I} = 2\\boldsymbol{I} - (\\boldsymbol{R} + \\boldsymbol{R}^{\\mathsf{T}})\n$$\nNow we take the trace of this expression. The trace is a linear operator:\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = \\operatorname{tr}(2\\boldsymbol{I}) - \\operatorname{tr}(\\boldsymbol{R} + \\boldsymbol{R}^{\\mathsf{T}}) = 2\\operatorname{tr}(\\boldsymbol{I}) - \\operatorname{tr}(\\boldsymbol{R}) - \\operatorname{tr}(\\boldsymbol{R}^{\\mathsf{T}})\n$$\nIn three dimensions, $\\operatorname{tr}(\\boldsymbol{I}) = 3$. Also, $\\operatorname{tr}(\\boldsymbol{R}) = \\operatorname{tr}(\\boldsymbol{R}^{\\mathsf{T}})$. So:\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = 2(3) - 2\\operatorname{tr}(\\boldsymbol{R}) = 6 - 2\\operatorname{tr}(\\boldsymbol{R})\n$$\nThe trace of the given rotation matrix $\\boldsymbol{R}$ is:\n$$\n\\operatorname{tr}(\\boldsymbol{R}) = \\cos\\theta + \\cos\\theta + 1 = 2\\cos\\theta + 1\n$$\nSubstituting this into the expression for the trace of $\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}$:\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = 6 - 2(2\\cos\\theta + 1) = 6 - 4\\cos\\theta - 2 = 4 - 4\\cos\\theta\n$$\nThe Frobenius norm is the square root:\n$$\n\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F} = \\sqrt{4 - 4\\cos\\theta} = 2\\sqrt{1 - \\cos\\theta}\n$$\nThe problem specifies the angle of rotation $\\theta = \\frac{2\\pi}{3}$. We must evaluate the expression for this value. The cosine of this angle is:\n$$\n\\cos\\left(\\frac{2\\pi}{3}\\right) = -\\frac{1}{2}\n$$\nSubstituting this value:\n$$\n\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F} = 2\\sqrt{1 - \\left(-\\frac{1}{2}\\right)} = 2\\sqrt{1 + \\frac{1}{2}} = 2\\sqrt{\\frac{3}{2}}\n$$\nTo simplify the expression:\n$$\n2\\sqrt{\\frac{3}{2}} = 2 \\frac{\\sqrt{3}}{\\sqrt{2}} = \\frac{2\\sqrt{3}\\sqrt{2}}{2} = \\sqrt{6}\n$$\nThe exact value of the Frobenius norm of the material displacement gradient is $\\sqrt{6}$. This large value, where the norm is greater than $1$, coupled with zero strain, correctly illustrates the counter-intuitive nature of finite rotation kinematics when analyzed with measures developed for infinitesimal deformations.", "answer": "$$\\boxed{\\sqrt{6}}$$", "id": "2639548"}, {"introduction": "The polar decomposition, which uniquely separates the deformation gradient $\\mathbf{F}$ into a pure rotation $\\mathbf{R}$ and a pure stretch $\\mathbf{U}$, is the cornerstone of finite deformation kinematics. This advanced practice bridges theory with robust computation, guiding you to derive an algorithm for the polar decomposition based on the Singular Value Decomposition (SVD) [@problem_id:2886399]. You will not only implement this algorithm but also prove that it finds the rotation that is 'closest' to the deformation gradient, providing deep insight into the geometric and variational foundations of continuum mechanics.", "problem": "You are given a square matrix representing a finite deformation gradient in materials mechanics. Let the deformation gradient be a real matrix $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$ with $\\det(\\mathbf{F}) > 0$. The right polar decomposition seeks a proper rotation $\\mathbf{R} \\in \\mathrm{SO}(n)$ and a symmetric positive-definite stretch $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$ such that $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$. All angles in this problem must be interpreted in radians.\n\nYour tasks:\n\n1) Starting only from the fundamental definitions of the singular value decomposition, orthogonal matrices, Frobenius norm, and symmetric positive-definite matrices, derive an algorithm that computes the right polar decomposition of $\\mathbf{F}$ using the singular value decomposition. The algorithm must work for any $\\mathbf{F}$ with $\\det(\\mathbf{F}) > 0$, and it must return $\\mathbf{R} \\in \\mathrm{SO}(n)$ and $\\mathbf{U}$ symmetric positive-definite.\n\n2) Prove that the rotation $\\mathbf{R}$ produced by your algorithm is the unique minimizer of the problem\n$$\n\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F,\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm, and that the associated $\\mathbf{U} = \\mathbf{R}^\\top \\mathbf{F}$ is symmetric positive-definite. Your proof must be principle-based, starting from the unitary invariance of the Frobenius norm and standard spectral inequalities, without assuming the target result.\n\n3) Implement a program that:\n- Computes the singular value decomposition of each given test matrix $\\mathbf{F}$.\n- Uses your derived algorithm to compute $\\mathbf{R}$ and $\\mathbf{U}$ for each case.\n- For each test case, computes a single real-valued diagnostic that quantitatively verifies one of the core properties implied by your derivation and proof.\n\nUse the following test suite of deformation gradients:\n- Case 1 (two-dimensional diagonal stretch): $\\mathbf{F}_1 = \\begin{bmatrix} 2.0 & 0.0 \\\\ 0.0 & 0.5 \\end{bmatrix}$. Output the absolute difference between $\\|\\mathbf{F}_1 - \\mathbf{R}_1\\|_F$ and the value $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$, where $\\sigma_i$ are the singular values of $\\mathbf{F}_1$.\n- Case 2 (two-dimensional rotated stretch): Let $\\theta = 0.4$ (radians), $\\mathbf{R}_{\\mathrm{true}} = \\begin{bmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{bmatrix}$, and $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(1.2, 0.8)$. Define $\\mathbf{F}_2 = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$. Output $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$.\n- Case 3 (three-dimensional general symmetric stretch with nontrivial eigenbasis): Let $\\phi = 0.6$ (radians), $\\mathbf{Q} = \\begin{bmatrix} \\cos\\phi & -\\sin\\phi & 0 \\\\ \\sin\\phi & \\cos\\phi & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}$, $\\mathbf{D} = \\operatorname{diag}(1.5, 0.9, 1.1)$, and $\\mathbf{U}_{\\mathrm{true}} = \\mathbf{Q}\\mathbf{D}\\mathbf{Q}^\\top$. Let $\\alpha = -0.7$ (radians) and $\\mathbf{R}_{\\mathrm{true}}^{(x)} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & \\cos\\alpha & -\\sin\\alpha \\\\ 0 & \\sin\\alpha & \\cos\\alpha \\end{bmatrix}$. Define $\\mathbf{F}_3 = \\mathbf{R}_{\\mathrm{true}}^{(x)} \\mathbf{U}_{\\mathrm{true}}$. Output $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$.\n- Case 4 (two-dimensional ill-conditioned stretch): Let $\\beta = 1.1$ (radians), $\\mathbf{R}_{\\beta} = \\begin{bmatrix} \\cos\\beta & -\\sin\\beta \\\\ \\sin\\beta & \\cos\\beta \\end{bmatrix}$, and $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(10^{-6}, 3.0)$. Define $\\mathbf{F}_4 = \\mathbf{R}_{\\beta} \\mathbf{U}_{\\mathrm{true}}$. Output the absolute difference between $\\|\\mathbf{F}_4 - \\mathbf{R}_4\\|_F$ and the value $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$.\n\nAll computations must assume angles in radians. Your program must aggregate the four diagnostics into a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases 1 through 4. Each diagnostic must be a real number (a float). It is acceptable to round the outputs to a fixed number of decimal places, but you must be consistent across all four outputs.\n\nNotes:\n- The singular values in the expressions above refer to those of the corresponding $\\mathbf{F}$ in each case.\n- Ensure all $\\mathbf{F}_k$ used have strictly positive determinants so that a proper rotation exists in the polar decomposition.", "solution": "The problem posed is a standard exercise in continuum mechanics and linear algebra. It is well-posed, scientifically grounded, and contains all necessary information for a complete and unique solution. The specified test cases are consistent with the theoretical framework and have determinants greater than zero, as required. The problem is therefore deemed valid.\n\nThe solution is presented in three parts, as requested: first, the derivation of the algorithm for right polar decomposition; second, the proof of the associated minimization property; and third, an explanation of the implementation applied to the test cases.\n\n### 1. Algorithm Derivation for Right Polar Decomposition\n\nThe objective is to find a proper rotation matrix $\\mathbf{R} \\in \\mathrm{SO}(n)$ (i.e., $\\mathbf{R}^\\top\\mathbf{R}=\\mathbf{I}$ and $\\det(\\mathbf{R})=+1$) and a symmetric positive-definite stretch tensor $\\mathbf{U}$ such that for a given deformation gradient $\\mathbf{F}$ with $\\det(\\mathbf{F}) > 0$, the right polar decomposition holds:\n$$ \\mathbf{F} = \\mathbf{R}\\mathbf{U} $$\nWe start from the Singular Value Decomposition (SVD) of $\\mathbf{F}$, which is defined for any real matrix $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$ as:\n$$ \\mathbf{F} = \\mathbf{V} \\mathbf{\\Sigma} \\mathbf{W}^\\top $$\nHere, $\\mathbf{V}$ and $\\mathbf{W}$ are orthogonal matrices ($\\mathbf{V}^\\top\\mathbf{V} = \\mathbf{I}$, $\\mathbf{W}^\\top\\mathbf{W} = \\mathbf{I}$), and $\\mathbf{\\Sigma}$ is a diagonal matrix containing the singular values $\\sigma_i \\ge 0$ of $\\mathbf{F}$. Since the problem states $\\det(\\mathbf{F}) > 0$, $\\mathbf{F}$ is invertible, which implies that all singular values are strictly positive, $\\sigma_i > 0$.\n\nWe seek to express $\\mathbf{R}$ and $\\mathbf{U}$ in terms of $\\mathbf{V}$, $\\mathbf{\\Sigma}$, and $\\mathbf{W}$. A natural construction is to group the orthogonal and symmetric parts of the SVD. Let us propose the following candidates for $\\mathbf{R}$ and $\\mathbf{U}$:\n$$ \\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top $$\n$$ \\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top $$\nWe must verify that these choices satisfy the required properties.\n\nFirst, check if the decomposition is valid:\n$$ \\mathbf{R}\\mathbf{U} = (\\mathbf{V}\\mathbf{W}^\\top)(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\mathbf{V}(\\mathbf{W}^\\top\\mathbf{W})\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{I}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{F} $$\nThe decomposition is correct.\n\nSecond, verify the properties of $\\mathbf{U}$.\nSymmetry:\n$$ \\mathbf{U}^\\top = (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top = (\\mathbf{W}^\\top)^\\top \\mathbf{\\Sigma}^\\top \\mathbf{W}^\\top = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{U} $$\nsince $\\mathbf{\\Sigma}$ is diagonal and thus symmetric. $\\mathbf{U}$ is symmetric.\n\nPositive-definiteness: For any non-zero vector $\\mathbf{x} \\in \\mathbb{R}^n$, we examine the quadratic form $\\mathbf{x}^\\top\\mathbf{U}\\mathbf{x}$:\n$$ \\mathbf{x}^\\top\\mathbf{U}\\mathbf{x} = \\mathbf{x}^\\top (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) \\mathbf{x} = (\\mathbf{W}^\\top\\mathbf{x})^\\top \\mathbf{\\Sigma} (\\mathbf{W}^\\top\\mathbf{x}) $$\nLet $\\mathbf{y} = \\mathbf{W}^\\top\\mathbf{x}$. Since $\\mathbf{W}$ is orthogonal and $\\mathbf{x} \\neq \\mathbf{0}$, $\\mathbf{y} \\neq \\mathbf{0}$. The expression becomes:\n$$ \\mathbf{y}^\\top \\mathbf{\\Sigma} \\mathbf{y} = \\sum_{i=1}^n \\sigma_i y_i^2 $$\nAs established, $\\sigma_i > 0$ for all $i$. Since $\\mathbf{y} \\neq \\mathbf{0}$, at least one $y_i \\neq 0$. Thus, $\\sum_{i=1}^n \\sigma_i y_i^2 > 0$. This confirms that $\\mathbf{U}$ is positive-definite.\n\nThird, verify the properties of $\\mathbf{R}$.\nOrthogonality:\n$$ \\mathbf{R}^\\top\\mathbf{R} = (\\mathbf{V}\\mathbf{W}^\\top)^\\top(\\mathbf{V}\\mathbf{W}^\\top) = (\\mathbf{W}\\mathbf{V}^\\top)(\\mathbf{V}\\mathbf{W}^\\top) = \\mathbf{W}(\\mathbf{V}^\\top\\mathbf{V})\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{W}^\\top = \\mathbf{I} $$\n$\\mathbf{R}$ is orthogonal.\n\nProper rotation: We must ensure $\\det(\\mathbf{R}) = +1$.\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}) $$\nFrom the SVD, $\\det(\\mathbf{F}) = \\det(\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{\\Sigma})\\det(\\mathbf{W}) = (\\det(\\mathbf{V})\\det(\\mathbf{W})) \\prod_{i=1}^n \\sigma_i$.\nGiven $\\det(\\mathbf{F}) > 0$ and knowing $\\prod \\sigma_i > 0$, it must be that $\\det(\\mathbf{V})\\det(\\mathbf{W}) > 0$.\nThe determinants of orthogonal matrices can only be $+1$ or $-1$. Therefore, $\\det(\\mathbf{V})$ and $\\det(\\mathbf{W})$ must have the same sign. Their product is necessarily $+1$.\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\nThus, $\\mathbf{R}$ is a proper rotation matrix, i.e., $\\mathbf{R} \\in \\mathrm{SO}(n)$.\n\nThe algorithm derived from these first principles is as follows:\n1.  For a given matrix $\\mathbf{F}$ with $\\det(\\mathbf{F}) > 0$, compute its SVD: $\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$.\n2.  The rotation matrix is $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$.\n3.  The stretch tensor is $\\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top$. Alternatively, it can be computed via $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$.\n\n### 2. Proof of Minimality and Uniqueness\n\nWe must prove that $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ is the unique minimizer of the problem $\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F$.\n\nThe Frobenius norm squared is $\\|\\mathbf{A}\\|_F^2 = \\operatorname{Tr}(\\mathbf{A}^\\top\\mathbf{A})$. We expand the objective function:\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}((\\mathbf{F} - \\mathbf{Q})^\\top(\\mathbf{F} - \\mathbf{Q})) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F} - \\mathbf{F}^\\top\\mathbf{Q} - \\mathbf{Q}^\\top\\mathbf{F} + \\mathbf{Q}^\\top\\mathbf{Q}) $$\nSince $\\mathbf{Q} \\in \\mathrm{SO}(n)$, $\\mathbf{Q}$ is orthogonal, so $\\mathbf{Q}^\\top\\mathbf{Q} = \\mathbf{I}$ and $\\operatorname{Tr}(\\mathbf{I}) = n$. Also, $\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) = \\operatorname{Tr}((\\mathbf{F}^\\top\\mathbf{Q})^\\top) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$.\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\|\\mathbf{F}\\|_F^2 + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) $$\nMinimizing this expression with respect to $\\mathbf{Q}$ is equivalent to maximizing the term $\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$.\n\nSubstitute the SVD of $\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$ into the trace:\n$$ \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\operatorname{Tr}((\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) $$\nUsing the cyclic property of the trace, $\\operatorname{Tr}(\\mathbf{ABC}) = \\operatorname{Tr}(\\mathbf{CAB})$:\n$$ \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}\\mathbf{W}) $$\nLet $\\mathbf{Z} = \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W}$. Since $\\mathbf{V}$, $\\mathbf{Q}$, and $\\mathbf{W}$ are orthogonal, their product $\\mathbf{Z}$ is also orthogonal. We want to maximize $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ over all orthogonal $\\mathbf{Z}$ that can be formed from a $\\mathbf{Q} \\in \\mathrm{SO}(n)$.\n$$ \\det(\\mathbf{Z}) = \\det(\\mathbf{V}^\\top)\\det(\\mathbf{Q})\\det(\\mathbf{W}) = \\det(\\mathbf{V})^{-1} (+1) \\det(\\mathbf{W}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\nThe last step is because $\\det(\\mathbf{V}) = \\det(\\mathbf{V}^\\top)$ for orthogonal matrices with determinant $\\pm 1$, or simply because $\\det(\\mathbf{V})^2=1$. More rigorously, $\\det(\\mathbf{V}^\\top\\mathbf{V})=1 \\implies \\det(\\mathbf{V}^\\top)\\det(\\mathbf{V})=1 \\implies \\det(\\mathbf{V})^2=1$. So $\\det(\\mathbf{V}^\\top)=\\det(\\mathbf{V})$.\nThus, we must maximize $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ over all $\\mathbf{Z} \\in \\mathrm{SO}(n)$.\n\nThe trace is $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) = \\sum_{i=1}^n \\sigma_i Z_{ii}$. By von Neumann's trace inequality, $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_i \\sigma_i(\\mathbf{\\Sigma})\\sigma_i(\\mathbf{Z})$. The singular values of $\\mathbf{\\Sigma}$ are $\\sigma_i$ and the singular values of an orthogonal matrix $\\mathbf{Z}$ are all $1$.\n$$ \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_{i=1}^n \\sigma_i $$\nEquality holds if $\\mathbf{\\Sigma}$ and $\\mathbf{Z}$ can be simultaneously diagonalized by the same pair of orthogonal matrices. Since $\\mathbf{\\Sigma}$ is already diagonal, this condition implies that $\\mathbf{Z}$ must also be diagonal. An orthogonal diagonal matrix must have diagonal entries of $\\pm 1$.\nTo maximize $\\sum_i \\sigma_i Z_{ii}$ where $\\sigma_i > 0$ and $Z_{ii} = \\pm 1$, we must choose $Z_{ii}=+1$ for all $i$. This leads to the unique choice $\\mathbf{Z} = \\mathbf{I}$.\nThe identity matrix $\\mathbf{I}$ is in $\\mathrm{SO}(n)$ since $\\det(\\mathbf{I})=+1$.\nTherefore, the maximum of $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ is achieved uniquely when $\\mathbf{Z} = \\mathbf{I}$.\n\nSetting $\\mathbf{Z} = \\mathbf{I}$ gives the optimal $\\mathbf{Q}$:\n$$ \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W} = \\mathbf{I} \\implies \\mathbf{Q} = \\mathbf{V}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{W}^\\top $$\nThis is precisely the matrix $\\mathbf{R}$ derived in the previous section. This proves that $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ is the unique minimizer of $\\|\\mathbf{F} - \\mathbf{Q}\\|_F$ for $\\mathbf{Q} \\in \\mathrm{SO}(n)$.\n\nThe proof that the associated stretch tensor $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$ is symmetric and positive-definite has already been demonstrated in the algorithm derivation section.\n\n### 3. Implementation and Verification\n\nThe Python implementation will follow the derived algorithm. For each test matrix $\\mathbf{F}_k$, we perform the following steps:\n1.  Construct $\\mathbf{F}_k$.\n2.  Compute its SVD using `numpy.linalg.svd`: $\\mathbf{V}$, $\\mathbf{S}$ (vector of singular values), $\\mathbf{W}^\\top$.\n3.  Calculate $\\mathbf{R}_k = \\mathbf{V} \\mathbf{W}^\\top$.\n4.  Calculate the required diagnostic quantity.\n\nFor Cases $1$ and $4$, the diagnostic is $|\\,\\|\\mathbf{F}_k - \\mathbf{R}_k\\|_F - \\sqrt{\\sum (\\sigma_i - 1)^2}\\,|$.\nFrom the proof in Section 2, the minimum value of the objective function is:\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\|\\mathbf{F}\\|_F^2 + n - 2 \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{R}) $$\nWe showed that $\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{R}) = \\sum \\sigma_i$. Also, $\\|\\mathbf{F}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}^2\\mathbf{W}^\\top) = \\operatorname{Tr}(\\mathbf{\\Sigma}^2) = \\sum \\sigma_i^2$.\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\sum \\sigma_i^2 + n - 2\\sum \\sigma_i = \\sum_{i=1}^n (\\sigma_i^2 - 2\\sigma_i + 1) = \\sum_{i=1}^n (\\sigma_i - 1)^2 $$\nTaking the square root, we get exactly $\\|\\mathbf{F} - \\mathbf{R}\\|_F = \\sqrt{\\sum (\\sigma_i - 1)^2}$.\nTherefore, the diagnostic for Cases $1$ and $4$ is expected to be zero, up to floating-point precision errors. This serves as a quantitative verification of our minimization proof.\n\nFor Cases $2$ and $3$, the matrices $\\mathbf{F}_k$ are constructed in the form $\\mathbf{F}_k = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$, where $\\mathbf{R}_{\\mathrm{true}}$ is a proper rotation and $\\mathbf{U}_{\\mathrm{true}}$ is symmetric positive-definite. This is, by definition, the right polar decomposition. Since the polar decomposition of an invertible matrix is unique, our algorithm must recover $\\mathbf{R}_k = \\mathbf{R}_{\\mathrm{true}}$ and $\\mathbf{U}_k = \\mathbf{U}_{\\mathrm{true}}$. The diagnostics $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$ and $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$ are therefore expected to be zero, up to numerical precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the right polar decomposition for several deformation gradients and\n    calculates specific diagnostic values to verify the theoretical results.\n    \"\"\"\n\n    # --- Test Case 1: 2D diagonal stretch ---\n    F1 = np.array([[2.0, 0.0], [0.0, 0.5]])\n\n    # --- Test Case 2: 2D rotated stretch ---\n    theta = 0.4\n    R_true2 = np.array([[np.cos(theta), -np.sin(theta)],\n                        [np.sin(theta), np.cos(theta)]])\n    U_true2 = np.diag([1.2, 0.8])\n    F2 = R_true2 @ U_true2\n\n    # --- Test Case 3: 3D general symmetric stretch ---\n    phi = 0.6\n    Q3 = np.array([[np.cos(phi), -np.sin(phi), 0.0],\n                   [np.sin(phi), np.cos(phi), 0.0],\n                   [0.0, 0.0, 1.0]])\n    D3 = np.diag([1.5, 0.9, 1.1])\n    U_true3 = Q3 @ D3 @ Q3.T\n    \n    alpha = -0.7\n    R_true3_x = np.array([[1.0, 0.0, 0.0],\n                          [0.0, np.cos(alpha), -np.sin(alpha)],\n                          [0.0, np.sin(alpha), np.cos(alpha)]])\n    F3 = R_true3_x @ U_true3\n\n    # --- Test Case 4: 2D ill-conditioned stretch ---\n    beta = 1.1\n    R_beta4 = np.array([[np.cos(beta), -np.sin(beta)],\n                        [np.sin(beta), np.cos(beta)]])\n    U_true4 = np.diag([1e-6, 3.0])\n    F4 = R_beta4 @ U_true4\n\n    test_cases = [\n        {'F': F1, 'type': 'diag_check'},\n        {'F': F2, 'type': 'R_check', 'R_true': R_true2},\n        {'F': F3, 'type': 'U_check', 'U_true': U_true3},\n        {'F': F4, 'type': 'diag_check'}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        F = case['F']\n        \n        # Core algorithm: Right Polar Decomposition using SVD\n        # F = V @ Sigma @ Wt\n        V, S_vec, Wt = np.linalg.svd(F)\n        \n        # Check for reflection and correct if necessary.\n        # This is needed for the general case where det(F) could be < 0.\n        # For this problem, det(F) > 0, so det(V)*det(Wt) is always 1.\n        if np.linalg.det(V) * np.linalg.det(Wt) < 0:\n            V_corr = V.copy()\n            V_corr[:, -1] *= -1\n            R = V_corr @ Wt\n        else:\n            R = V @ Wt\n\n        if case['type'] == 'diag_check':\n            # Diagnostic: | ||F - R||_F - sqrt(sum((sigma_i - 1)^2)) |\n            norm_F_minus_R = np.linalg.norm(F - R, 'fro')\n            norm_s_minus_1 = np.sqrt(np.sum((S_vec - 1)**2))\n            diagnostic = np.abs(norm_F_minus_R - norm_s_minus_1)\n            results.append(diagnostic)\n            \n        elif case['type'] == 'R_check':\n            # Diagnostic: ||R - R_true||_F\n            R_true = case['R_true']\n            diagnostic = np.linalg.norm(R - R_true, 'fro')\n            results.append(diagnostic)\n\n        elif case['type'] == 'U_check':\n            # U can be computed as U = R.T @ F\n            U = R.T @ F\n            U_true = case['U_true']\n            # Diagnostic: ||U - U_true||_F\n            diagnostic = np.linalg.norm(U - U_true, 'fro')\n            results.append(diagnostic)\n\n    # Format the output as a comma-separated list of floats in a single line.\n    # Use scientific notation for consistency and to handle very small numbers.\n    formatted_results = [f\"{res:.8e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2886399"}]}