{"hands_on_practices": [{"introduction": "A valid constitutive law must be independent of the observer's reference frame, a principle known as material frame-indifference or objectivity. This exercise provides a direct, hands-on test of this requirement by applying several common objective stress rates to a case of pure rigid body rotation. Since there is no physical deformation, any objective measure of the stress rate must evaluate to zero, a property you will verify from first principles for the Zaremba-Jaumann, Truesdell, and Green-Naghdi rates [@problem_id:2905964].", "problem": "Consider a spatially uniform motion of a homogeneous continuum defined by the mapping $ \\boldsymbol{x} = \\boldsymbol{R}(t)\\,\\boldsymbol{X} $ with $ \\boldsymbol{F}(t) = \\boldsymbol{R}(t) $, where $ \\boldsymbol{R}(t) \\in \\mathrm{SO}(3) $ is the proper orthogonal rotation about the $ z $-axis by the angle $ \\theta(t) $, given explicitly by\n$$\n\\boldsymbol{R}(t) = \\begin{pmatrix}\n\\cos\\theta(t) & -\\sin\\theta(t) & 0 \\\\\n\\sin\\theta(t) & \\cos\\theta(t) & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n\\qquad \\dot{\\theta}(t) = \\omega \\;\\; \\text{(constant)}, \\quad \\theta(0)=0.\n$$\nStarting from the kinematic definitions $ \\boldsymbol{L} = \\nabla \\boldsymbol{v} $, $ \\boldsymbol{D} = \\tfrac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{T}) $, and $ \\boldsymbol{W} = \\tfrac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{T}) $, perform the following steps:\n\n1) Compute the velocity gradient $ \\boldsymbol{L}(t) $ for this motion and its symmetric and skew-symmetric parts $ \\boldsymbol{D}(t) $ and $ \\boldsymbol{W}(t) $.\n\n2) Consider a spatial Cauchy stress evolving by rigid rotation of a constant, symmetric reference tensor $ \\boldsymbol{\\sigma}_{0} $,\n$$\n\\boldsymbol{\\sigma}(t) = \\boldsymbol{R}(t)\\,\\boldsymbol{\\sigma}_{0}\\,\\boldsymbol{R}^{T}(t),\n\\qquad \\boldsymbol{\\sigma}_{0} = \\begin{pmatrix}\ns_{11} & s_{12} & s_{13} \\\\\ns_{12} & s_{22} & s_{23} \\\\\ns_{13} & s_{23} & s_{33}\n\\end{pmatrix},\n$$\nand compute the material time derivative $ \\dot{\\boldsymbol{\\sigma}}(t) $.\n\n3) Using only foundational kinematics and the standard definitions of the Zaremba–Jaumann corotational rate, the Truesdell rate, and the Green–Naghdi rate, evaluate each candidate stress rate for the above motion and stress field, and use your results to test their objectivity under pure rigid-body rotation. Report the common tensor value that these three rates attain for this motion as a single explicit $ 3 \\times 3 $ tensor expression.\n\nGive your final answer as that single $ 3 \\times 3 $ expression. No units are required. No rounding is required.", "solution": "The problem statement is subjected to validation.\n\nGivens extracted verbatim are:\n1.  Motion mapping: $ \\boldsymbol{x} = \\boldsymbol{R}(t)\\,\\boldsymbol{X} $.\n2.  Deformation gradient: $ \\boldsymbol{F}(t) = \\boldsymbol{R}(t) $, where $ \\boldsymbol{R}(t) \\in \\mathrm{SO}(3) $ is a proper orthogonal rotation.\n3.  Rotation tensor matrix: $ \\boldsymbol{R}(t) = \\begin{pmatrix} \\cos\\theta(t) & -\\sin\\theta(t) & 0 \\\\ \\sin\\theta(t) & \\cos\\theta(t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $.\n4.  Angular velocity: $ \\dot{\\theta}(t) = \\omega $ (constant).\n5.  Initial condition: $ \\theta(0)=0 $.\n6.  Kinematic definitions: $ \\boldsymbol{L} = \\nabla \\boldsymbol{v} $, $ \\boldsymbol{D} = \\tfrac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{T}) $, $ \\boldsymbol{W} = \\tfrac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{T}) $.\n7.  Cauchy stress evolution: $ \\boldsymbol{\\sigma}(t) = \\boldsymbol{R}(t)\\,\\boldsymbol{\\sigma}_{0}\\,\\boldsymbol{R}^{T}(t) $.\n8.  Reference stress tensor: $ \\boldsymbol{\\sigma}_{0} = \\begin{pmatrix} s_{11} & s_{12} & s_{13} \\\\ s_{12} & s_{22} & s_{23} \\\\ s_{13} & s_{23} & s_{33} \\end{pmatrix} $, which is constant and symmetric.\n\nThe problem is validated against the specified criteria. It is scientifically grounded in continuum mechanics, well-posed with all necessary definitions and data, and objectively formulated. It does not violate any fundamental principles, is not incomplete or contradictory, and presents a non-trivial, formalizable problem directly related to the topic of objective stress rates. The problem is therefore deemed valid. The solution proceeds.\n\nThe solution is constructed in three parts as requested.\n\nPart 1: Computation of $ \\boldsymbol{L} $, $ \\boldsymbol{D} $, and $ \\boldsymbol{W} $.\nThe velocity gradient tensor $ \\boldsymbol{L} $ is defined in the spatial description by $ \\boldsymbol{L} = \\dot{\\boldsymbol{F}}\\boldsymbol{F}^{-1} $. Given $ \\boldsymbol{F}(t) = \\boldsymbol{R}(t) $ and that $ \\boldsymbol{R}(t) $ is an orthogonal tensor, we have $ \\boldsymbol{F}^{-1} = \\boldsymbol{R}^{-1} = \\boldsymbol{R}^{T} $.\nThus, $ \\boldsymbol{L}(t) = \\dot{\\boldsymbol{R}}(t)\\boldsymbol{R}^{T}(t) $.\nFirst, we compute the time derivative of $ \\boldsymbol{R}(t) $:\n$$\n\\dot{\\boldsymbol{R}}(t) = \\frac{d}{dt} \\begin{pmatrix} \\cos\\theta & -\\sin\\theta & 0 \\\\ \\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} -\\sin\\theta \\cdot \\dot{\\theta} & -\\cos\\theta \\cdot \\dot{\\theta} & 0 \\\\ \\cos\\theta \\cdot \\dot{\\theta} & -\\sin\\theta \\cdot \\dot{\\theta} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nSubstituting $ \\dot{\\theta} = \\omega $:\n$$\n\\dot{\\boldsymbol{R}}(t) = \\omega \\begin{pmatrix} -\\sin\\theta & -\\cos\\theta & 0 \\\\ \\cos\\theta & -\\sin\\theta & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nNow, we compute $ \\boldsymbol{L}(t) = \\dot{\\boldsymbol{R}}(t)\\boldsymbol{R}^{T}(t) $:\n$$\n\\boldsymbol{L}(t) = \\omega \\begin{pmatrix} -\\sin\\theta & -\\cos\\theta & 0 \\\\ \\cos\\theta & -\\sin\\theta & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta & \\sin\\theta & 0 \\\\ -\\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{L}(t) = \\omega \\begin{pmatrix} (-\\sin\\theta\\cos\\theta + \\cos\\theta\\sin\\theta) & (-\\sin^2\\theta - \\cos^2\\theta) & 0 \\\\ (\\cos^2\\theta + \\sin^2\\theta) & (\\cos\\theta\\sin\\theta - \\sin\\theta\\cos\\theta) & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nUsing the identity $ \\sin^2\\theta + \\cos^2\\theta = 1 $, this simplifies to:\n$$\n\\boldsymbol{L}(t) = \\omega \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe velocity gradient $ \\boldsymbol{L} $ is a constant skew-symmetric tensor. This tensor represents the spatial angular velocity of the rigid body motion.\n\nNext, we compute the rate of deformation tensor $ \\boldsymbol{D} $ and the spin tensor $ \\boldsymbol{W} $.\n$ \\boldsymbol{D} $ is the symmetric part of $ \\boldsymbol{L} $:\n$$\n\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{T}) = \\frac{1}{2} \\left[ \\omega \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\omega \\begin{pmatrix} 0 & 1 & 0 \\\\ -1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right] = \\frac{\\omega}{2} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\boldsymbol{0}\n$$\nThe result $ \\boldsymbol{D} = \\boldsymbol{0} $ confirms that the motion is rigid (isochoric and shear-free).\n\n$ \\boldsymbol{W} $ is the skew-symmetric part of $ \\boldsymbol{L} $:\n$$\n\\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{T}) = \\frac{1}{2} \\left[ \\boldsymbol{L} - (-\\boldsymbol{L}) \\right] = \\boldsymbol{L} = \\omega \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nFor a rigid body motion, the velocity gradient is purely skew-symmetric, so $ \\boldsymbol{W} = \\boldsymbol{L} $.\n\nPart 2: Computation of the material time derivative $ \\dot{\\boldsymbol{\\sigma}}(t) $.\nGiven $ \\boldsymbol{\\sigma}(t) = \\boldsymbol{R}(t)\\boldsymbol{\\sigma}_{0}\\boldsymbol{R}^{T}(t) $ where $ \\boldsymbol{\\sigma}_{0} $ is constant. We differentiate with respect to time using the product rule:\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{R}}\\boldsymbol{\\sigma}_{0}\\boldsymbol{R}^{T} + \\boldsymbol{R}\\boldsymbol{\\sigma}_{0}\\dot{\\boldsymbol{R}}^{T}\n$$\nWe use the relations $ \\dot{\\boldsymbol{R}} = \\boldsymbol{L}\\boldsymbol{R} $ and $ \\dot{\\boldsymbol{R}}^{T} = (\\boldsymbol{L}\\boldsymbol{R})^T = \\boldsymbol{R}^{T}\\boldsymbol{L}^{T} $. Substituting these into the expression for $ \\dot{\\boldsymbol{\\sigma}} $:\n$$\n\\dot{\\boldsymbol{\\sigma}} = (\\boldsymbol{L}\\boldsymbol{R})\\boldsymbol{\\sigma}_{0}\\boldsymbol{R}^{T} + \\boldsymbol{R}\\boldsymbol{\\sigma}_{0}(\\boldsymbol{R}^{T}\\boldsymbol{L}^{T}) = \\boldsymbol{L}(\\boldsymbol{R}\\boldsymbol{\\sigma}_{0}\\boldsymbol{R}^{T}) + (\\boldsymbol{R}\\boldsymbol{\\sigma}_{0}\\boldsymbol{R}^{T})\\boldsymbol{L}^{T}\n$$\nRecognizing $ \\boldsymbol{\\sigma} = \\boldsymbol{R}\\boldsymbol{\\sigma}_{0}\\boldsymbol{R}^{T} $, we obtain:\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{L}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{L}^{T}\n$$\nFor this specific motion, we found $ \\boldsymbol{L} = \\boldsymbol{W} $ and therefore $ \\boldsymbol{L}^{T} = -\\boldsymbol{W} $. Substituting these gives an alternative form:\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{W}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{W}\n$$\n\nPart 3: Evaluation of objective stress rates.\nAn objective stress rate must vanish for any stress tensor that is purely convected and rotated with the material, which is the case described by $ \\boldsymbol{\\sigma}(t) = \\boldsymbol{R}(t)\\boldsymbol{\\sigma}_{0}\\boldsymbol{R}^{T}(t) $. We test the three specified rates.\n\nA. Zaremba–Jaumann rate ($ \\overset{\\nabla}{\\boldsymbol{\\sigma}} $):\nThe definition is $ \\overset{\\nabla}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{W} $.\nUsing the result from Part 2, $ \\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{W}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{W} $, we have:\n$$\n\\overset{\\nabla}{\\boldsymbol{\\sigma}} = (\\boldsymbol{W}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{W}) - \\boldsymbol{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{W} = \\boldsymbol{0}\n$$\n\nB. Truesdell rate ($ \\overset{\\circ}{\\boldsymbol{\\sigma}} $):\nThe definition is $ \\overset{\\circ}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{L}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{L}^{T} + (\\mathrm{tr}\\,\\boldsymbol{D})\\boldsymbol{\\sigma} $.\nFrom Part 1, we have $ \\boldsymbol{D} = \\boldsymbol{0} $, so $ \\mathrm{tr}\\,\\boldsymbol{D} = 0 $. The definition simplifies to $ \\overset{\\circ}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{L}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{L}^{T} $.\nFrom Part 2, we have $ \\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{L}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{L}^{T} $. Substituting this gives:\n$$\n\\overset{\\circ}{\\boldsymbol{\\sigma}} = (\\boldsymbol{L}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{L}^{T}) - \\boldsymbol{L}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{L}^{T} = \\boldsymbol{0}\n$$\n\nC. Green–Naghdi rate ($ \\overset{\\square}{\\boldsymbol{\\sigma}} $):\nThe definition is $ \\overset{\\square}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{\\Omega}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{\\Omega} $, where $ \\boldsymbol{\\Omega} = \\dot{\\mathcal{R}}\\mathcal{R}^T $ and $ \\mathcal{R} $ is the rotation tensor from the polar decomposition $ \\boldsymbol{F} = \\mathcal{R}\\boldsymbol{U} $.\nIn this problem, $ \\boldsymbol{F} = \\boldsymbol{R} $, which is already a rotation tensor. Thus, the polar decomposition is trivial with $ \\mathcal{R} = \\boldsymbol{R} $ and $ \\boldsymbol{U} = \\boldsymbol{I} $.\nThe spin tensor $ \\boldsymbol{\\Omega} $ is therefore $ \\boldsymbol{\\Omega} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{T} $. From Part 1, we computed this to be $ \\boldsymbol{L} $, which also equals $ \\boldsymbol{W} $.\nSo, for this motion, the Green–Naghdi rate is formally identical to the Zaremba–Jaumann rate:\n$$\n\\overset{\\square}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{W}\n$$\nAs shown for the Jaumann rate, this evaluates to:\n$$\n\\overset{\\square}{\\boldsymbol{\\sigma}} = \\boldsymbol{0}\n$$\n\nAll three objective stress rates correctly evaluate to the zero tensor, demonstrating their property of objectivity for a pure rigid body rotation. The common tensor value they attain is the $ 3 \\times 3 $ zero tensor.\n$$\n\\boldsymbol{0} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThis is the final result.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2905964"}, {"introduction": "Having established the mathematical definition of objectivity, we now explore its tangible physical consequences. This practice examines the case of simple shear, a ubiquitous deformation mode in both solids and fluids, using the Zaremba-Jaumann objective rate. Your analysis will reveal a non-intuitive yet critical coupling between the rates of change of normal stresses and the existing shear stress, a real physical phenomenon that demonstrates why frame-indifferent formulations are essential for accurately modeling material behavior [@problem_id:2666138].", "problem": "Consider an incompressible, isothermal continuum undergoing plane simple shear with velocity field $\\mathbf{v}(x,y,t) = (\\dot{\\gamma}\\,y,\\,0)$, where $\\dot{\\gamma}$ is a constant shear rate. Let $\\boldsymbol{\\sigma}(x,y,t)$ denote the Cauchy stress tensor, assumed symmetric, and restrict attention to the $x$–$y$ plane. Using only objective, frame-indifferent measures of stress rate, determine the Zaremba–Jaumann objective stress rate $\\boldsymbol{\\sigma}^{\\nabla J}$ as an explicit $2\\times 2$ tensor expression written in terms of the components of $\\boldsymbol{\\sigma}$ and the scalar $\\dot{\\gamma}$. Then, by inspecting your expression, identify which components of $\\boldsymbol{\\sigma}^{\\nabla J}$ couple normal and shear stress components.\n\nExpress your final answer as a single $2\\times 2$ matrix-valued analytic expression in terms of $\\dot{\\boldsymbol{\\sigma}}$, $\\boldsymbol{\\sigma}$, and $\\dot{\\gamma}$, with all components made explicit. No numerical evaluation is required and no rounding applies. Angle measures, if any, should be interpreted in radians.", "solution": "The problem statement is assessed to be valid. It is a well-posed problem in continuum mechanics that is scientifically grounded, self-contained, and objective. We proceed with the solution.\n\nThe Zaremba–Jaumann objective stress rate, $\\boldsymbol{\\sigma}^{\\nabla J}$, provides a frame-indifferent measure of the rate of change of the Cauchy stress tensor $\\boldsymbol{\\sigma}$. Its definition is given by:\n$$ \\boldsymbol{\\sigma}^{\\nabla J} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{W} \\boldsymbol{\\sigma} + \\boldsymbol{\\sigma} \\boldsymbol{W} $$\nwhere $\\dot{\\boldsymbol{\\sigma}}$ is the material time derivative of the Cauchy stress tensor, and $\\boldsymbol{W}$ is the spin tensor, which is the skew-symmetric part of the velocity gradient tensor $\\boldsymbol{L}$.\n\nFirst, we must determine the velocity gradient tensor $\\boldsymbol{L}$ from the given velocity field $\\mathbf{v} = (\\dot{\\gamma}y, 0)$. In the two-dimensional Cartesian coordinate system $(x, y)$, the components of $\\mathbf{v}$ are $v_x = \\dot{\\gamma}y$ and $v_y = 0$. The components of the velocity gradient tensor, $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$, are computed as:\n$$\n\\boldsymbol{L} = \\nabla\\mathbf{v} =\n\\begin{pmatrix}\n\\frac{\\partial v_x}{\\partial x} & \\frac{\\partial v_x}{\\partial y} \\\\\n\\frac{\\partial v_y}{\\partial x} & \\frac{\\partial v_y}{\\partial y}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{\\partial (\\dot{\\gamma}y)}{\\partial x} & \\frac{\\partial (\\dot{\\gamma}y)}{\\partial y} \\\\\n\\frac{\\partial (0)}{\\partial x} & \\frac{\\partial (0)}{\\partial y}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\dot{\\gamma} \\\\\n0 & 0\n\\end{pmatrix}\n$$\nThe spin tensor $\\boldsymbol{W}$ is defined as $\\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^T)$. The transpose of $\\boldsymbol{L}$ is:\n$$\n\\boldsymbol{L}^T =\n\\begin{pmatrix}\n0 & 0 \\\\\n\\dot{\\gamma} & 0\n\\end{pmatrix}\n$$\nThus, the spin tensor is:\n$$\n\\boldsymbol{W} = \\frac{1}{2} \\left(\n\\begin{pmatrix}\n0 & \\dot{\\gamma} \\\\\n0 & 0\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n0 & 0 \\\\\n\\dot{\\gamma} & 0\n\\end{pmatrix}\n\\right) = \\frac{1}{2}\n\\begin{pmatrix}\n0 & \\dot{\\gamma} \\\\\n-\\dot{\\gamma} & 0\n\\end{pmatrix}\n$$\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ is symmetric, so in the $x$–$y$ plane it has the form:\n$$\n\\boldsymbol{\\sigma} =\n\\begin{pmatrix}\n\\sigma_{xx} & \\sigma_{xy} \\\\\n\\sigma_{yx} & \\sigma_{yy}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sigma_{xx} & \\sigma_{xy} \\\\\n\\sigma_{xy} & \\sigma_{yy}\n\\end{pmatrix}\n$$\nThe material derivative of the stress tensor $\\dot{\\boldsymbol{\\sigma}}$ is given by:\n$$\n\\dot{\\boldsymbol{\\sigma}} =\n\\begin{pmatrix}\n\\dot{\\sigma}_{xx} & \\dot{\\sigma}_{xy} \\\\\n\\dot{\\sigma}_{xy} & \\dot{\\sigma}_{yy}\n\\end{pmatrix}\n$$\nNow we compute the correction term $\\boldsymbol{\\sigma}\\boldsymbol{W} - \\boldsymbol{W}\\boldsymbol{\\sigma}$:\n$$\n\\boldsymbol{W}\\boldsymbol{\\sigma} = \\frac{1}{2}\n\\begin{pmatrix}\n0 & \\dot{\\gamma} \\\\\n-\\dot{\\gamma} & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\sigma_{xx} & \\sigma_{xy} \\\\\n\\sigma_{xy} & \\sigma_{yy}\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n\\dot{\\gamma} \\sigma_{xy} & \\dot{\\gamma} \\sigma_{yy} \\\\\n-\\dot{\\gamma} \\sigma_{xx} & -\\dot{\\gamma} \\sigma_{xy}\n\\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\sigma}\\boldsymbol{W} = \\frac{1}{2}\n\\begin{pmatrix}\n\\sigma_{xx} & \\sigma_{xy} \\\\\n\\sigma_{xy} & \\sigma_{yy}\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & \\dot{\\gamma} \\\\\n-\\dot{\\gamma} & 0\n\\end{pmatrix}\n= \\frac{1}{2}\n\\begin{pmatrix}\n-\\dot{\\gamma} \\sigma_{xy} & \\dot{\\gamma} \\sigma_{xx} \\\\\n-\\dot{\\gamma} \\sigma_{yy} & \\dot{\\gamma} \\sigma_{xy}\n\\end{pmatrix}\n$$\nThe Jaumann rate is $\\boldsymbol{\\sigma}^{\\nabla J} = \\dot{\\boldsymbol{\\sigma}} + (\\boldsymbol{\\sigma}\\boldsymbol{W} - \\boldsymbol{W}\\boldsymbol{\\sigma})$. The correction term is:\n$$\n\\boldsymbol{\\sigma}\\boldsymbol{W} - \\boldsymbol{W}\\boldsymbol{\\sigma} = \\frac{1}{2}\n\\begin{pmatrix}\n-2\\dot{\\gamma} \\sigma_{xy} & \\dot{\\gamma} (\\sigma_{xx} - \\sigma_{yy}) \\\\\n\\dot{\\gamma} (\\sigma_{xx} - \\sigma_{yy}) & 2\\dot{\\gamma} \\sigma_{xy}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\dot{\\gamma} \\sigma_{xy} & \\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) \\\\\n\\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) & \\dot{\\gamma} \\sigma_{xy}\n\\end{pmatrix}\n$$\nSubstituting this into the definition of the Jaumann rate, we obtain the final expression:\n$$\n\\boldsymbol{\\sigma}^{\\nabla J} =\n\\begin{pmatrix}\n\\dot{\\sigma}_{xx} & \\dot{\\sigma}_{xy} \\\\\n\\dot{\\sigma}_{xy} & \\dot{\\sigma}_{yy}\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n-\\dot{\\gamma} \\sigma_{xy} & \\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) \\\\\n\\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) & \\dot{\\gamma} \\sigma_{xy}\n\\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\sigma}^{\\nabla J} =\n\\begin{pmatrix}\n\\dot{\\sigma}_{xx} - \\dot{\\gamma} \\sigma_{xy} & \\dot{\\sigma}_{xy} + \\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) \\\\\n\\dot{\\sigma}_{xy} + \\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) & \\dot{\\sigma}_{yy} + \\dot{\\gamma} \\sigma_{xy}\n\\end{pmatrix}\n$$\nUpon inspection of this result, we identify the coupling between normal and shear stress components. The normal components of the objective rate, $\\sigma^{\\nabla J}_{xx}$ and $\\sigma^{\\nabla J}_{yy}$, explicitly depend on the shear stress component $\\sigma_{xy}$. Conversely, the shear component of the objective rate, $\\sigma^{\\nabla J}_{xy}$, explicitly depends on the normal stress components $\\sigma_{xx}$ and $\\sigma_{yy}$. This coupling is a direct consequence of the rotational part of the deformation and is fundamental to the objective formulation of constitutive relations in rheology and solid mechanics. All components of the objective rate tensor exhibit this coupling.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\dot{\\sigma}_{xx} - \\dot{\\gamma} \\sigma_{xy} & \\dot{\\sigma}_{xy} + \\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) \\\\\n\\dot{\\sigma}_{xy} + \\frac{\\dot{\\gamma}}{2} (\\sigma_{xx} - \\sigma_{yy}) & \\dot{\\sigma}_{yy} + \\dot{\\gamma} \\sigma_{xy}\n\\end{pmatrix}\n}\n$$", "id": "2666138"}, {"introduction": "Bridging the gap between analytical theory and computational simulation is a crucial step in modern mechanics. This final practice guides you through the development of a corotational stress update algorithm, a robust technique central to finite element software for handling large deformations and rotations. By implementing a numerical scheme based on the Green-Naghdi rate, you will gain practical experience in translating the abstract concepts of objective rates into a functional code capable of solving realistic engineering problems [@problem_id:2666098].", "problem": "Consider a three-dimensional continuum with deformation gradient $F(t) \\in \\mathbb{R}^{3 \\times 3}$, admitting the polar decomposition $F(t) = R(t) U(t)$ where $R(t) \\in \\mathrm{SO}(3)$ is the proper orthogonal rotation and $U(t)$ is the right stretch. Let the Cauchy stress be $\\sigma(t) \\in \\mathbb{R}^{3 \\times 3}$, and define the spatial velocity gradient $L(t) = \\dot{F}(t) F(t)^{-1}$ with symmetric part $D(t) = \\tfrac{1}{2}(L(t) + L(t)^{T})$. The Green–Naghdi corotational spin is defined by $\\Omega(t) = \\dot{R}(t) R(t)^{T}$, which is skew-symmetric, and the Green–Naghdi objective rate of Cauchy stress satisfies, for an isotropic hypoelastic solid,\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = \\dot{\\sigma}(t) + \\sigma(t) \\, \\Omega(t) - \\Omega(t) \\, \\sigma(t) = \\lambda \\, \\text{tr}\\big(D(t)\\big) I + 2 \\mu \\, D(t),\n$$\nwhere $\\lambda$ and $\\mu$ are the Lamé parameters, $I$ is the identity, and $\\text{tr}(\\cdot)$ is the trace. The Lamé parameters are related to Young’s modulus $E$ and Poisson’s ratio $\\nu$ by $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$.\n\nYour task is to derive from first principles an algorithmic stress update over a time step $[t_n, t_{n+1}]$ of duration $\\Delta t = t_{n+1} - t_{n}$ that:\n- Extracts the midpoint rotation $R_{n+\\frac{1}{2}}$ from the midpoint deformation gradient $F_{n+\\frac{1}{2}}$ using the polar decomposition, and\n- Computes the Green–Naghdi spin at the midpoint as $\\Omega_{n+\\frac{1}{2}} = \\dot{R} R^{T}$ approximated at the midpoint. You must use only $F_n$, $F_{n+1}$, and $F_{n+\\frac{1}{2}}$ and no angular parametrizations; angles, when used for test construction, are specified in radians.\n- Updates the Cauchy stress $\\sigma_{n} = \\sigma(t_n)$ to $\\sigma_{n+1} = \\sigma(t_{n+1})$ for a linear isotropic hypoelastic solid using the Green–Naghdi objective rate in a midpoint scheme that is consistent with frame indifference, by working in a corotational frame.\n\nYou must start from the definitions above and from $F(t)$ kinematics, and systematically derive a midpoint algorithm that is objectively correct under rigid body motions. Propose a discrete approximation for $L_{n+\\frac{1}{2}}$ from $F_n$, $F_{n+1}$, and $F_{n+\\frac{1}{2}}$, and a discrete approximation for $\\Omega_{n+\\frac{1}{2}}$ from $R_n$, $R_{n+1}$, and $R_{n+\\frac{1}{2}}$. Clarify how you map stresses and strain rates to the corotational frame to eliminate spin in the constitutive update, and how you map back to the spatial frame at $t_{n+1}$.\n\nImplement your derived algorithm as a program that, for each test case below, computes the required output. All physical quantities must be handled in the specified units. Angles must be treated in radians. Unless otherwise stated, matrices are $3 \\times 3$. All outputs must be expressed in Pascals (for stress components or norms) and rounded to six decimal places. The final program output must be a single line containing a comma-separated list enclosed in square brackets.\n\nUse the following test suite. For each case, you are given $E$ (in Pascals), $\\nu$ (dimensionless), $\\Delta t$ (in seconds), $F_n$, $F_{n+1}$, and $\\sigma_n$ (in Pascals). Define the midpoint deformation gradient as $F_{n+\\frac{1}{2}} = \\tfrac{1}{2}(F_n + F_{n+1})$, and use it to extract $R_{n+\\frac{1}{2}}$. For each case, compute the specified scalar output:\n\n- Case A (rigid rotation objectivity check; angles in radians): Let $E = 200 \\times 10^{9}$, $\\nu = 0.30$, $\\Delta t = 0.02$. Take $F_n = I$, $F_{n+1} = R_z(\\theta)$ with $\\theta = \\dfrac{\\pi}{18}$, where $R_z(\\theta)$ is the rotation about the $z$-axis by $\\theta$. Let\n$$\n\\sigma_n = \\begin{bmatrix}\n100 \\times 10^{6} & 20 \\times 10^{6} & 0\\\\\n20 \\times 10^{6} & 50 \\times 10^{6} & 0\\\\\n0 & 0 & 10 \\times 10^{6}\n\\end{bmatrix}.\n$$\nCompute $\\sigma_{n+1}$ with your Green–Naghdi update and output the Frobenius norm of the difference between $\\sigma_{n+1}$ and the exact rigid rotation of $\\sigma_n$ over the step, i.e., $\\left\\| \\sigma_{n+1} - \\boldsymbol{Q} \\, \\sigma_n \\, \\boldsymbol{Q}^{T} \\right\\|_F$, where $\\boldsymbol{Q} = R_{n+1} R_n^{T}$. Output this single float in Pascals, rounded to six decimal places.\n\n- Case B (uniaxial stretch, no rotation): Let $E = 200 \\times 10^{9}$, $\\nu = 0.30$, $\\Delta t = 1.0$. Take $F_n = I$, $F_{n+1} = \\mathrm{diag}(1.01, 1, 1)$, and $\\sigma_n = 0$. Compute $\\sigma_{n+1}$ and output the value of $\\sigma_{11}$ in Pascals, rounded to six decimal places.\n\n- Case C (combined rotation and stretch): Let $E = 100 \\times 10^{9}$, $\\nu = 0.25$, $\\Delta t = 0.1$. Take $F_n = I$, $F_{n+1} = R_z(\\vartheta) \\, \\mathrm{diag}(1.02, 0.99, 1)$ with $\\vartheta = 0.25$, and $\\sigma_n = 0$. Compute $\\sigma_{n+1}$ and output $\\mathrm{tr}(\\sigma_{n+1})$ in Pascals, rounded to six decimal places.\n\n- Case D (near-incompressible simple shear): Let $E = 1.0 \\times 10^{6}$, $\\nu = 0.499$, $\\Delta t = 1.0$. Take $F_n = I$, $F_{n+1} = \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix}$ with $\\gamma = 0.02$, and $\\sigma_n = 0$. Compute $\\sigma_{n+1}$ and output the value of $\\sigma_{12}$ in Pascals, rounded to six decimal places.\n\nImplementation constraints and output format:\n- Angles must be treated in radians.\n- Use $L_{n+\\frac{1}{2}} \\approx \\big(F_{n+1} - F_n\\big) F_{n+\\frac{1}{2}}^{-1} / \\Delta t$ and $D_{n+\\frac{1}{2}} = \\tfrac{1}{2}(L_{n+\\frac{1}{2}} + L_{n+\\frac{1}{2}}^{T})$.\n- Extract $R_n$, $R_{n+\\frac{1}{2}}$, and $R_{n+1}$ from the polar decomposition of $F_n$, $F_{n+\\frac{1}{2}}$, and $F_{n+1}$, respectively, using $R = F \\, (F^{T} F)^{-1/2}$ with the positive-definite inverse square root.\n- Compute $\\Omega_{n+\\frac{1}{2}} \\approx \\big(R_{n+1} - R_n\\big) R_{n+\\frac{1}{2}}^{T} / \\Delta t$.\n- Update $\\sigma$ over the time step in a corotational frame consistent with the Green–Naghdi rate, and map back to the spatial configuration at $t_{n+1}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{resultA},\\text{resultB},\\text{resultC},\\text{resultD}]$), with each result rounded to six decimal places and expressed in Pascals.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n\nThe following definitions and data are provided:\n- **Kinematics**: Deformation gradient $F(t) \\in \\mathbb{R}^{3 \\times 3}$, with polar decomposition $F(t) = R(t) U(t)$. $R(t) \\in \\mathrm{SO}(3)$ is the rotation, $U(t)$ is the right stretch.\n- **Velocity Gradient**: The spatial velocity gradient is $L(t) = \\dot{F}(t) F(t)^{-1}$, with symmetric part $D(t) = \\tfrac{1}{2}(L(t) + L(t)^{T})$.\n- **Stress and Stress Rate**: The Cauchy stress is $\\sigma(t)$. The Green–Naghdi objective stress rate is defined as:\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = \\dot{\\sigma}(t) + \\sigma(t) \\, \\Omega(t) - \\Omega(t) \\, \\sigma(t)\n$$\nwhere the corotational spin is $\\Omega(t) = \\dot{R}(t) R(t)^{T}$.\n- **Constitutive Law**: For an isotropic hypoelastic solid:\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = \\lambda \\, \\text{tr}\\big(D(t)\\big) I + 2 \\mu \\, D(t)\n$$\nwhere $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$ are Lamé parameters, $I$ is the identity matrix.\n- **Numerical Scheme Approximations**:\n    - Midpoint deformation gradient: $F_{n+\\frac{1}{2}} = \\tfrac{1}{2}(F_n + F_{n+1})$.\n    - Rotation extraction: $R = F \\, (F^{T} F)^{-1/2}$.\n    - Midpoint velocity gradient: $L_{n+\\frac{1}{2}} \\approx \\big(F_{n+1} - F_n\\big) F_{n+\\frac{1}{2}}^{-1} / \\Delta t$.\n    - Midpoint spin: $\\Omega_{n+\\frac{1}{2}} \\approx \\big(R_{n+1} - R_n\\big) R_{n+\\frac{1}{2}}^{T} / \\Delta t$.\n- **Test Cases**: Four specific test cases (A, B, C, D) are provided with all necessary material parameters ($E$, $\\nu$), time step duration ($\\Delta t$), initial and final deformation gradients ($F_n$, $F_{n+1}$), and initial Cauchy stress ($\\sigma_n$). Specific scalar outputs are requested for each case.\n\n#### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded (Critical)**: The problem is rooted in the fundamental principles of continuum mechanics, specifically the theory of objective stress rates for hypoelastic materials. The Green-Naghdi rate, polar decomposition, and the associated constitutive models are standard, well-established concepts in solid mechanics literature. The problem is free from scientific error.\n- **Well-Posed**: The problem is well-posed. It requests the derivation and implementation of a specific numerical algorithm for a given differential equation. All necessary boundary conditions (in time, i.e., initial state) and kinematic drivers ($F(t)$) are provided. The required numerical approximations are explicitly stated, which ensures a unique procedure is to be followed.\n- **Objective (Critical)**: The problem is formulated in precise mathematical and physical language, devoid of any subjectivity or ambiguity.\n- **Incomplete or Contradictory Setup**: The setup is complete. For each test case, all required input data are provided. There are no contradictions in the definitions or requirements.\n- **Unrealistic or Infeasible**: The material properties and deformation scenarios described are standard for academic and engineering problems. The values are physically plausible.\n- **Pseudo-Profound, Trivial, Tautological**: The problem is substantial. It requires a correct derivation of an objective stress integration algorithm, which is a non-trivial task in computational mechanics, and its careful implementation.\n\n#### Step 3: Verdict and Action\n\nThe problem is valid. It is a well-defined problem in computational solid mechanics that is scientifically sound, objective, and internally consistent. A solution will be provided.\n\n### Derivation of the Stress Update Algorithm\n\nThe objective is to derive a numerical algorithm to update the Cauchy stress tensor $\\sigma_n$ at time $t_n$ to $\\sigma_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$. The algorithm must be objective, meaning it must yield correctly transformed results under a superimposed rigid body motion. This is achieved by working in a corotational coordinate system.\n\nThe core idea of a corotational method is to perform the constitutive update in a frame that rotates with the material, thereby eliminating the spin terms. We define a corotational stress tensor, $\\sigma^R(t)$, by rotating the Cauchy stress tensor from the spatial frame back to a fixed reference orientation using the material rotation $R(t)$:\n$$\n\\sigma(t) = R(t) \\sigma^R(t) R(t)^T\n$$\nWe find the relationship between their rates by taking the material time derivative using the product rule:\n$$\n\\dot{\\sigma} = \\dot{R} \\sigma^R R^T + R \\dot{\\sigma}^R R^T + R \\sigma^R \\dot{R}^T\n$$\nUsing the definition of the spin $\\Omega = \\dot{R}R^T$ and the identity $\\dot{R}^T = -\\Omega R^T$ (which follows from differentiating $R R^T = I$), we can substitute these into the expression. We can also substitute $\\sigma^R = R^T \\sigma R$:\n$$\n\\dot{\\sigma} = (\\dot{R}R^T)(R \\sigma^R R^T) + R\\dot{\\sigma}^R R^T + (R \\sigma^R R^T)(R^T \\dot{R}^T R) = \\Omega\\sigma + R\\dot{\\sigma}^R R^T + \\sigma (R^T \\dot{R}^T R)^T\n$$\nThis path is becoming complicated. A more direct path is:\n$$\n\\dot{\\sigma} = \\Omega\\sigma - \\sigma\\Omega + R\\dot{\\sigma}^R R^T\n$$\nRearranging this equation gives:\n$$\nR\\dot{\\sigma}^R R^T = \\dot{\\sigma} - \\Omega\\sigma + \\sigma\\Omega = \\dot{\\sigma} + \\sigma\\Omega - \\Omega\\sigma\n$$\nThe right-hand side is precisely the Green–Naghdi rate $\\overset{\\text{GN}}{\\sigma}$ as defined in the problem statement. Thus, we have the key relationship:\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = R(t) \\dot{\\sigma}^R(t) R(t)^T\n$$\nSubstituting this into the hypoelastic constitutive law gives:\n$$\nR \\dot{\\sigma}^R R^T = \\lambda \\, \\text{tr}(D) I + 2\\mu D\n$$\nWe can move the rotation tensors to the right side and define a corotational rate-of-deformation tensor $D^R = R^T D R$. Using the property that the trace is invariant under cyclic permutation, $\\text{tr}(D) = \\text{tr}(R^T D R) = \\text{tr}(D^R)$, we obtain a simple differential equation in the corotational frame:\n$$\n\\dot{\\sigma}^R(t) = \\lambda \\, \\text{tr}\\big(D^R(t)\\big) I + 2\\mu D^R(t)\n$$\nThis ODE is free of spin terms and can be integrated numerically. Using a midpoint rule over the time step $[t_n, t_{n+1}]$:\n$$\n\\sigma^R(t_{n+1}) - \\sigma^R(t_n) \\approx \\Delta t \\left[ \\lambda \\, \\text{tr}\\big(D^R_{n+\\frac{1}{2}}\\big) I + 2\\mu D^R_{n+\\frac{1}{2}} \\right]\n$$\nLet's call the right-hand side $\\Delta \\sigma^R$. We relate the corotational stresses back to the Cauchy stresses: $\\sigma^R_n = R_n^T \\sigma_n R_n$ and $\\sigma_{n+1} = R_{n+1} \\sigma^R_{n+1} R_{n+1}^T$.\nThe update for $\\sigma^R_{n+1}$ is $\\sigma^R_{n+1} \\approx \\sigma^R_n + \\Delta\\sigma^R$. Substituting into the expression for $\\sigma_{n+1}$:\n$$\n\\sigma_{n+1} = R_{n+1} \\left( R_n^T \\sigma_n R_n + \\Delta \\sigma^R \\right) R_{n+1}^T\n$$\nThis algorithm is objective by construction. It rotates the initial stress from configuration $n$ to a fixed material frame, adds the stress increment due to deformation computed in that frame, and finally rotates the result to the final spatial configuration $n+1$.\n\nThe algorithm proceeds as follows:\n1.  **Material Properties**: From given $E$ and $\\nu$, calculate the Lamé parameters $\\lambda$ and $\\mu$.\n2.  **Kinematics**:\n    a. Given $F_n$ and $F_{n+1}$, compute the midpoint deformation gradient $F_{n+\\frac{1}{2}} = \\tfrac{1}{2}(F_n + F_{n+1})$.\n    b. Perform polar decomposition $F = RU$ for $F_n$, $F_{n+1}$, and $F_{n+\\frac{1}{2}}$ to obtain the rotation tensors $R_n$, $R_{n+1}$, and $R_{n+\\frac{1}{2}}$.\n    c. Compute the midpoint spatial velocity gradient $L_{n+\\frac{1}{2}} = \\frac{1}{\\Delta t} (F_{n+1} - F_n) F_{n+\\frac{1}{2}}^{-1}$.\n    d. Symmetrize to get the rate of deformation tensor: $D_{n+\\frac{1}{2}} = \\tfrac{1}{2}(L_{n+\\frac{1}{2}} + L_{n+\\frac{1}{2}}^T)$.\n3.  **Constitutive Update**:\n    a. Transform the rate of deformation to the corotational frame defined by the midpoint rotation: $D^R_{n+\\frac{1}{2}} = R_{n+\\frac{1}{2}}^T D_{n+\\frac{1}{2}} R_{n+\\frac{1}{2}}$.\n    b. Calculate the corotational stress increment. Using $\\text{tr}(D^R_{n+\\frac{1}{2}}) = \\text{tr}(D_{n+\\frac{1}{2}})$:\n    $$\n    \\Delta \\sigma^R = \\Delta t \\left( \\lambda \\, \\text{tr}(D_{n+\\frac{1}{2}}) I + 2\\mu D^R_{n+\\frac{1}{2}} \\right)\n    $$\n4.  **Stress Update and Mapping**:\n    a. Compute the final stress $\\sigma_{n+1}$ using the derived update formula:\n    $$\n    \\sigma_{n+1} = R_{n+1} \\left( R_n^T \\sigma_n R_n + \\Delta \\sigma^R \\right) R_{n+1}^T\n    $$\nThis algorithm provides the complete procedure for implementation.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import sqrtm, inv, norm\n\ndef solve():\n    \"\"\"\n    Solves the problem by implementing the derived Green-Naghdi stress update algorithm\n    for the four given test cases.\n    \"\"\"\n\n    def get_lame_params(E, nu):\n        \"\"\"Computes Lamé parameters lambda and mu from Young's modulus and Poisson's ratio.\"\"\"\n        lam = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n        mu = E / (2 * (1 + nu))\n        return lam, mu\n\n    def polar_decomposition(F):\n        \"\"\"\n        Performs polar decomposition F = RU using the specified method R = F * (F^T F)^(-1/2).\n        Returns the rotation matrix R.\n        \"\"\"\n        C = F.T @ F  # Right Cauchy-Green tensor\n        # U = sqrtm(C), so U_inv = inv(sqrtm(C))\n        U_inv = inv(sqrtm(C))\n        R = F @ U_inv\n        return R\n\n    def compute_stress_update(E, nu, dt, F_n, F_np1, sigma_n):\n        \"\"\"\n        Implements the derived corotational stress update algorithm for a single time step.\n        \"\"\"\n        # 1. Material Properties\n        lam, mu = get_lame_params(E, nu)\n\n        # 2. Kinematics\n        F_mid = 0.5 * (F_n + F_np1)\n\n        R_n = polar_decomposition(F_n)\n        R_np1 = polar_decomposition(F_np1)\n        R_mid = polar_decomposition(F_mid)\n\n        # Midpoint velocity gradient L and rate of deformation D\n        F_mid_inv = inv(F_mid)\n        L_mid = (F_np1 - F_n) @ F_mid_inv / dt\n        D_mid = 0.5 * (L_mid + L_mid.T)\n\n        # 3. Constitutive Update in Corotational Frame\n        D_r_mid = R_mid.T @ D_mid @ R_mid\n        trace_D = np.trace(D_mid)\n        \n        delta_sigma_r = dt * (lam * trace_D * np.eye(3) + 2 * mu * D_r_mid)\n\n        # 4. Stress Update and Mapping\n        sigma_r_n = R_n.T @ sigma_n @ R_n\n        sigma_r_np1 = sigma_r_n + delta_sigma_r\n        sigma_np1 = R_np1 @ sigma_r_np1 @ R_np1.T\n\n        return sigma_np1\n        \n    # --- Test Cases ---\n\n    # Case A: Rigid rotation objectivity check\n    E_A = 200e9\n    nu_A = 0.30\n    dt_A = 0.02\n    theta_A = np.pi / 18.0\n    c, s = np.cos(theta_A), np.sin(theta_A)\n    F_n_A = np.eye(3)\n    F_np1_A = np.array([[c, -s, 0], [s, c, 0], [0, 0, 1]])\n    sigma_n_A = np.array([\n        [100e6, 20e6, 0],\n        [20e6, 50e6, 0],\n        [0, 0, 10e6]\n    ])\n    \n    sigma_np1_A_computed = compute_stress_update(E_A, nu_A, dt_A, F_n_A, F_np1_A, sigma_n_A)\n    \n    # Exact rotation for comparison\n    R_n_A = polar_decomposition(F_n_A)\n    R_np1_A = polar_decomposition(F_np1_A)\n    Q = R_np1_A @ R_n_A.T\n    sigma_np1_A_exact = Q @ sigma_n_A @ Q.T\n    \n    result_A = norm(sigma_np1_A_computed - sigma_np1_A_exact, 'fro')\n\n    # Case B: Uniaxial stretch\n    E_B = 200e9\n    nu_B = 0.30\n    dt_B = 1.0\n    F_n_B = np.eye(3)\n    F_np1_B = np.diag([1.01, 1, 1])\n    sigma_n_B = np.zeros((3, 3))\n    \n    sigma_np1_B = compute_stress_update(E_B, nu_B, dt_B, F_n_B, F_np1_B, sigma_n_B)\n    result_B = sigma_np1_B[0, 0]\n\n    # Case C: Combined rotation and stretch\n    E_C = 100e9\n    nu_C = 0.25\n    dt_C = 0.1\n    theta_C = 0.25\n    c, s = np.cos(theta_C), np.sin(theta_C)\n    F_n_C = np.eye(3)\n    stretch_C = np.diag([1.02, 0.99, 1])\n    rot_C = np.array([[c, -s, 0], [s, c, 0], [0, 0, 1]])\n    F_np1_C = rot_C @ stretch_C\n    sigma_n_C = np.zeros((3, 3))\n\n    sigma_np1_C = compute_stress_update(E_C, nu_C, dt_C, F_n_C, F_np1_C, sigma_n_C)\n    result_C = np.trace(sigma_np1_C)\n\n    # Case D: Near-incompressible simple shear\n    E_D = 1.0e6\n    nu_D = 0.499\n    dt_D = 1.0\n    gamma_D = 0.02\n    F_n_D = np.eye(3)\n    F_np1_D = np.array([\n        [1, gamma_D, 0],\n        [0, 1, 0],\n        [0, 0, 1]\n    ])\n    sigma_n_D = np.zeros((3, 3))\n\n    sigma_np1_D = compute_stress_update(E_D, nu_D, dt_D, F_n_D, F_np1_D, sigma_n_D)\n    result_D = sigma_np1_D[0, 1]\n\n    # --- Final Output ---\n    results = [result_A, result_B, result_C, result_D]\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2666098"}]}