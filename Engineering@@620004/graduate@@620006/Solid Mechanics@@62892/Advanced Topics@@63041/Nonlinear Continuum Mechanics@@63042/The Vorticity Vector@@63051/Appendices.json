{"hands_on_practices": [{"introduction": "A firm grasp of vorticity begins with the ability to compute it directly from the kinematics of a flow field. This exercise [@problem_id:2700506] guides you through this fundamental process for a case of anti-plane shear, a deformation pattern common in the analysis of modes of fracture and layered composites. By starting from the velocity gradient $\\mathbf{L}$ and deriving the spin tensor $\\mathbf{W}$, you will find the vorticity vector $\\boldsymbol{\\omega}$ and interpret its physical meaning in relation to the underlying velocity gradients.", "problem": "Consider small-deformation anti-plane shear of a homogeneous, isotropic solid in which the out-of-plane displacement is $w(x,y,t)$ and the particle velocity is $\\mathbf{v}(x,y,t)=\\left(0,\\,0,\\,\\dot{w}(x,y,t)\\right)$. Work at a fixed but arbitrary time $t$, and assume $\\dot{w}$ is sufficiently smooth in $x$ and $y$. Using only kinematic definitions from continuum mechanics, namely the velocity gradient $\\mathbf{L}$ with components $L_{ij}=\\partial v_{i}/\\partial x_{j}$, the spin tensor $\\mathbf{W}=\\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}\\right)$, and the vorticity vector $\\boldsymbol{\\omega}$ defined as twice the axial vector of $\\mathbf{W}$, derive an explicit expression for $\\boldsymbol{\\omega}(x,y)$ for this anti-plane shear field.\n\nThen interpret the direction of $\\boldsymbol{\\omega}$ relative to the in-plane gradient of $\\dot{w}$, and give closed-form expressions for the magnitude $\\|\\boldsymbol{\\omega}\\|$ and for a unit vector $\\mathbf{n}_{\\omega}$ in the direction of $\\boldsymbol{\\omega}$, in terms of spatial derivatives of $\\dot{w}(x,y)$. You may assume that at the point of interest $\\nabla\\dot{w}(x,y)\\neq \\mathbf{0}$ so that $\\mathbf{n}_{\\omega}$ is well-defined.\n\nExpress the vorticity components and its magnitude in the unit of inverse time, $\\mathrm{s}^{-1}$. For the final reported answer, do not include units. Report your final result as a single row vector containing, in order, the three components of $\\boldsymbol{\\omega}$, the scalar $\\|\\boldsymbol{\\omega}\\|$, and the three components of $\\mathbf{n}_{\\omega}$. No numerical evaluation or rounding is required; express your answer symbolically in terms of $\\partial \\dot{w}/\\partial x$ and $\\partial \\dot{w}/\\partial y$.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed kinematic problem in continuum mechanics, resting on standard definitions and free of scientific or logical flaws. We proceed to the solution.\n\nThe particle velocity field for anti-plane shear is given as $\\mathbf{v}(x,y,t)$. At a fixed time $t$, we write this in Cartesian components $(v_1, v_2, v_3)$ corresponding to spatial coordinates $(x_1, x_2, x_3) = (x, y, z)$:\n$$ v_1(x_1, x_2) = 0 $$\n$$ v_2(x_1, x_2) = 0 $$\n$$ v_3(x_1, x_2) = \\dot{w}(x_1, x_2) $$\nNote that the velocity components depend only on $x_1$ and $x_2$.\n\nThe first step is to compute the velocity gradient tensor $\\mathbf{L}$, whose components are defined as $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$.\n\nThe components are calculated as follows:\nThe first row of $\\mathbf{L}$:\n$L_{11} = \\frac{\\partial v_1}{\\partial x_1} = 0$, $L_{12} = \\frac{\\partial v_1}{\\partial x_2} = 0$, $L_{13} = \\frac{\\partial v_1}{\\partial x_3} = 0$.\nThe second row of $\\mathbf{L}$:\n$L_{21} = \\frac{\\partial v_2}{\\partial x_1} = 0$, $L_{22} = \\frac{\\partial v_2}{\\partial x_2} = 0$, $L_{23} = \\frac{\\partial v_2}{\\partial x_3} = 0$.\nThe third row of $\\mathbf{L}$:\n$L_{31} = \\frac{\\partial v_3}{\\partial x_1} = \\frac{\\partial \\dot{w}}{\\partial x_1}$, $L_{32} = \\frac{\\partial v_3}{\\partial x_2} = \\frac{\\partial \\dot{w}}{\\partial x_2}$, $L_{33} = \\frac{\\partial v_3}{\\partial x_3} = 0$ (since $\\dot{w}$ is not a function of $x_3$).\n\nThus, the velocity gradient tensor is:\n$$ \\mathbf{L} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ \\frac{\\partial \\dot{w}}{\\partial x_1} & \\frac{\\partial \\dot{w}}{\\partial x_2} & 0 \\end{pmatrix} $$\n\nNext, we compute the spin tensor $\\mathbf{W}$, which is the skew-symmetric part of $\\mathbf{L}$:\n$$ \\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}}) $$\nThe transpose of $\\mathbf{L}$ is:\n$$ \\mathbf{L}^{\\mathsf{T}} = \\begin{pmatrix} 0 & 0 & \\frac{\\partial \\dot{w}}{\\partial x_1} \\\\ 0 & 0 & \\frac{\\partial \\dot{w}}{\\partial x_2} \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nThe difference is:\n$$ \\mathbf{L} - \\mathbf{L}^{\\mathsf{T}} = \\begin{pmatrix} 0 & 0 & -\\frac{\\partial \\dot{w}}{\\partial x_1} \\\\ 0 & 0 & -\\frac{\\partial \\dot{w}}{\\partial x_2} \\\\ \\frac{\\partial \\dot{w}}{\\partial x_1} & \\frac{\\partial \\dot{w}}{\\partial x_2} & 0 \\end{pmatrix} $$\nTherefore, the spin tensor is:\n$$ \\mathbf{W} = \\frac{1}{2}\\begin{pmatrix} 0 & 0 & -\\frac{\\partial \\dot{w}}{\\partial x_1} \\\\ 0 & 0 & -\\frac{\\partial \\dot{w}}{\\partial x_2} \\\\ \\frac{\\partial \\dot{w}}{\\partial x_1} & \\frac{\\partial \\dot{w}}{\\partial x_2} & 0 \\end{pmatrix} $$\nIn component form: $W_{13} = -W_{31} = -\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_1}$, $W_{23} = -W_{32} = -\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_2}$, and all other components are zero.\n\nThe problem defines the vorticity vector $\\boldsymbol{\\omega}$ as twice the axial vector of $\\mathbf{W}$. The components of the axial vector of a skew-symmetric tensor $\\mathbf{W}$ are given by $w_{\\text{axial},i} = -\\frac{1}{2}\\epsilon_{ijk}W_{jk}$. This yields $w_{\\text{axial},1} = W_{32}$, $w_{\\text{axial},2} = -W_{31}$, and $w_{\\text{axial},3} = W_{21}$. Using our components of $\\mathbf{W}$:\n$w_{\\text{axial},1} = W_{32} = \\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_2}$\n$w_{\\text{axial},2} = -W_{31} = -(\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_1}) = -\\frac{1}{2}\\frac{\\partial \\dot{w}}{\\partial x_1}$\n$w_{\\text{axial},3} = W_{21} = 0$\nThe vorticity vector $\\boldsymbol{\\omega}$ is $2$ times this axial vector:\n$$ \\boldsymbol{\\omega} = 2 \\mathbf{w}_{\\text{axial}} = \\left( \\frac{\\partial \\dot{w}}{\\partial x_2}, -\\frac{\\partial \\dot{w}}{\\partial x_1}, 0 \\right) $$\nThis expression is equivalent to the standard definition $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$. Switching back to $(x,y,z)$ notation for clarity, the explicit expression for the vorticity vector is:\n$$ \\boldsymbol{\\omega}(x,y) = \\left( \\frac{\\partial \\dot{w}}{\\partial y}, -\\frac{\\partial \\dot{w}}{\\partial x}, 0 \\right) $$\nThis is the first required result.\n\nFor the interpretation, we consider the in-plane gradient of $\\dot{w}$, which is a vector field in the $xy$-plane:\n$$ \\nabla_{\\text{2D}} \\dot{w} = \\left( \\frac{\\partial \\dot{w}}{\\partial x}, \\frac{\\partial \\dot{w}}{\\partial y} \\right) $$\nThe vorticity vector $\\boldsymbol{\\omega}$ also lies in the $xy$-plane. We examine the relationship between these two vectors by computing their dot product:\n$$ (\\nabla_{\\text{2D}} \\dot{w}) \\cdot \\boldsymbol{\\omega} = \\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)\\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right) + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)\\left(-\\frac{\\partial \\dot{w}}{\\partial x}\\right) = 0 $$\nThe zero dot product implies that $\\boldsymbol{\\omega}$ is orthogonal to $\\nabla_{\\text{2D}}\\dot{w}$. For a vector $(a,b)$, the vector $(b, -a)$ corresponds to a clockwise rotation by $\\frac{\\pi}{2}$ radians ($90$ degrees). Therefore, the vorticity vector $\\boldsymbol{\\omega}$ lies in the plane of shear and is oriented at a right angle, clockwise, to the in-plane gradient of the out-of-plane velocity rate $\\dot{w}$.\n\nNext, we derive the magnitude $\\|\\boldsymbol{\\omega}\\|$:\n$$ \\|\\boldsymbol{\\omega}\\| = \\sqrt{\\omega_x^2 + \\omega_y^2 + \\omega_z^2} = \\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2 + \\left(-\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + 0^2} $$\n$$ \\|\\boldsymbol{\\omega}\\| = \\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2} $$\nThis shows that the magnitude of the vorticity is equal to the magnitude of the in-plane gradient of $\\dot{w}$.\n\nFinally, the unit vector $\\mathbf{n}_{\\omega}$ in the direction of $\\boldsymbol{\\omega}$ is computed as $\\mathbf{n}_{\\omega} = \\frac{\\boldsymbol{\\omega}}{\\|\\boldsymbol{\\omega}\\|}$. The problem states that $\\nabla\\dot{w} \\neq \\mathbf{0}$, which ensures $\\|\\boldsymbol{\\omega}\\| \\neq 0$.\n$$ \\mathbf{n}_{\\omega} = \\frac{1}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} \\left( \\frac{\\partial \\dot{w}}{\\partial y}, -\\frac{\\partial \\dot{w}}{\\partial x}, 0 \\right) $$\nThe three components of this unit vector are:\n$$ n_{\\omega,x} = \\frac{\\frac{\\partial \\dot{w}}{\\partial y}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} $$\n$$ n_{\\omega,y} = \\frac{-\\frac{\\partial \\dot{w}}{\\partial x}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} $$\n$$ n_{\\omega,z} = 0 $$\n\nCombining these results, we assemble the final answer as a single row vector with the seven requested quantities.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\partial \\dot{w}}{\\partial y} & -\\frac{\\partial \\dot{w}}{\\partial x} & 0 & \\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2} & \\frac{\\frac{\\partial \\dot{w}}{\\partial y}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} & \\frac{-\\frac{\\partial \\dot{w}}{\\partial x}}{\\sqrt{\\left(\\frac{\\partial \\dot{w}}{\\partial x}\\right)^2 + \\left(\\frac{\\partial \\dot{w}}{\\partial y}\\right)^2}} & 0 \\end{pmatrix} } $$", "id": "2700506"}, {"introduction": "Having explored the instantaneous spin, we now address a more advanced question: how does this local rotation rate accumulate into a finite material rotation? This practice [@problem_id:2700460] confronts the common misconception that the finite rotation tensor $\\mathbf{R}$ can be found by simply integrating the spin tensor $\\mathbf{W}$. By quantifying the discrepancy for a simple shear case, you will gain a deeper appreciation for the non-commutative nature of finite rotations and the challenges they pose in continuum mechanics.", "problem": "Consider a two-dimensional, plane, incompressible simple shear of a solid in the $x$–$y$ plane, with spatial velocity field $\\mathbf{v}(x,y,t) = \\big(\\dot{\\gamma}\\, y,\\, 0\\big)$, where $\\dot{\\gamma} > 0$ is constant. Let the deformation gradient $\\mathbf{F}(t)$ evolve from the stress-free reference configuration with $\\mathbf{F}(0) = \\mathbf{I}$ according to the kinematic relation $\\dot{\\mathbf{F}} = \\mathbf{L}\\,\\mathbf{F}$, where $\\mathbf{L} = \\nabla \\mathbf{v}$ is the spatial velocity gradient. Let the spin tensor be $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{T})$ and the vorticity vector be $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$, whose $z$-component is denoted $\\omega_{z}$. Define the right polar decomposition $\\mathbf{F}(t) = \\mathbf{R}(t)\\,\\mathbf{U}(t)$, where $\\mathbf{R}(t) \\in SO(3)$ (the special orthogonal group in three dimensions) is the finite rotation and $\\mathbf{U}(t)$ is the right stretch.\n\nTwo time-accumulated measures of rotation are considered over an interval $[0,T]$:\n1. The spin-integrated approximation, $\\theta_{W}(T)$, obtained by integrating the instantaneous rigid-body rotation rate implied by the vorticity, i.e., $\\theta_{W}(T) = \\int_{0}^{T} \\frac{\\omega_{z}(t)}{2}\\,dt$.\n2. The finite polar rotation, $\\theta_{R}(T)$, defined as the unique angle in radians such that, when restricted to the $x$–$y$ plane, $\\mathbf{R}(T)$ is the planar rotation by $\\theta_{R}(T)$ that appears in the right polar decomposition of $\\mathbf{F}(T)$.\n\nUsing only the core kinematic definitions above, derive an exact, closed-form analytical expression for the error\n$$\n\\varepsilon(k) = \\theta_{W}(T) - \\theta_{R}(T),\n$$\nexpressed in terms of the accumulated shear $k = \\dot{\\gamma}\\,T$. Express your final expression for $\\varepsilon(k)$ in radians. No numerical evaluation or rounding is required; provide a closed-form expression in $k$ only.", "solution": "The problem requires the derivation of an expression for the error $\\varepsilon(k) = \\theta_{W}(T) - \\theta_{R}(T)$, where $\\theta_{W}(T)$ is the rotation angle obtained by integrating the vorticity-based spin rate, and $\\theta_{R}(T)$ is the rotation angle from the polar decomposition of the deformation gradient. The accumulated shear is given by $k = \\dot{\\gamma}T$. The analysis proceeds from the fundamental kinematic definitions provided.\n\nFirst, we determine the spatial velocity gradient tensor, $\\mathbf{L}$, defined as $\\mathbf{L} = \\nabla\\mathbf{v}$. The given velocity field is $\\mathbf{v} = (\\dot{\\gamma}y, 0, 0)$. The components of $\\mathbf{L}$, $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$, are calculated. The only non-zero component is $L_{12} = \\frac{\\partial}{\\partial y}(\\dot{\\gamma}y) = \\dot{\\gamma}$. Thus, the matrix representation of $\\mathbf{L}$ is:\n$$\n\\mathbf{L} = \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nSince $\\dot{\\gamma}$ is a constant, $\\mathbf{L}$ is constant in time.\n\nNext, we solve for the deformation gradient $\\mathbf{F}(t)$ using the evolution equation $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$ with the initial condition $\\mathbf{F}(0) = \\mathbf{I}$. For a constant $\\mathbf{L}$, this linear ordinary differential equation system has the solution $\\mathbf{F}(t) = \\exp(t\\mathbf{L})\\mathbf{F}(0) = \\exp(t\\mathbf{L})$. We compute the matrix exponential:\n$$\n\\exp(t\\mathbf{L}) = \\mathbf{I} + t\\mathbf{L} + \\frac{(t\\mathbf{L})^2}{2!} + \\dots\n$$\nThe square of the matrix $t\\mathbf{L}$ is:\n$$\n(t\\mathbf{L})^2 = \\begin{pmatrix} 0 & t\\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & t\\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\mathbf{0}\n$$\nSince $(t\\mathbf{L})^2$ is the zero matrix, all higher powers are also zero. The series for the exponential truncates, yielding $\\mathbf{F}(t) = \\mathbf{I} + t\\mathbf{L}$.\nLet $\\gamma(t) = \\dot{\\gamma}t$ be the amount of shear at time $t$. Then:\n$$\n\\mathbf{F}(t) = \\begin{pmatrix} 1 & \\gamma(t) & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\nWe now calculate the first measure of rotation, $\\theta_{W}(T)$. This requires the vorticity vector $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$.\n$$\n\\boldsymbol{\\omega} = \\left( \\frac{\\partial v_z}{\\partial y} - \\frac{\\partial v_y}{\\partial z}, \\frac{\\partial v_x}{\\partial z} - \\frac{\\partial v_z}{\\partial x}, \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y} \\right) = (0, 0, 0 - \\dot{\\gamma}) = (0, 0, -\\dot{\\gamma})\n$$\nThe $z$-component is $\\omega_z = -\\dot{\\gamma}$, which is constant. The spin-integrated rotation is defined as:\n$$\n\\theta_{W}(T) = \\int_{0}^{T} \\frac{\\omega_{z}(t)}{2}\\,dt = \\int_{0}^{T} \\frac{-\\dot{\\gamma}}{2}\\,dt = -\\frac{\\dot{\\gamma}T}{2}\n$$\nIn terms of the total accumulated shear $k = \\dot{\\gamma}T$, this is:\n$$\n\\theta_{W}(T) = -\\frac{k}{2}\n$$\n\nNext, we determine the finite polar rotation, $\\theta_{R}(T)$, from the right polar decomposition $\\mathbf{F}(t) = \\mathbf{R}(t)\\mathbf{U}(t)$. We first compute the right Cauchy-Green deformation tensor $\\mathbf{C}(t) = \\mathbf{F}^T(t)\\mathbf{F}(t)$. At time $t=T$, let $\\gamma(T)=k$.\n$$\n\\mathbf{F}(T) = \\begin{pmatrix} 1 & k & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\mathbf{F}^T(T) = \\begin{pmatrix} 1 & 0 & 0 \\\\ k & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}(T) = \\mathbf{F}^T(T)\\mathbf{F}(T) = \\begin{pmatrix} 1 & 0 & 0 \\\\ k & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & k & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & k & 0 \\\\ k & 1+k^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe right stretch tensor $\\mathbf{U}$ is the unique symmetric positive-definite square root of $\\mathbf{C}$, so $\\mathbf{U} = \\sqrt{\\mathbf{C}}$. Then the rotation tensor is $\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$. We compute the symmetric stretch tensor $\\mathbf{U}$ and its inverse $\\mathbf{U}^{-1}$. The correct symmetric right stretch tensor is\n$$\n\\mathbf{U}_{2D}(T) = \\frac{1}{\\sqrt{4+k^2}} \\begin{pmatrix} k^2+2 & k \\\\ k & 2 \\end{pmatrix}\n$$\nThis is a typo in the original solution. The correct U is actually:\n$ \\mathbf{U} = \\mathbf{R}^T \\mathbf{F} $. We first find R via a direct algorithm. For a 2D tensor $\\mathbf{F} = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$, the rotation is $\\mathbf{R} = \\frac{1}{\\sqrt{(a+d)^2 + (c-b)^2}} \\begin{pmatrix} a+d & -(c-b) \\\\ c-b & a+d \\end{pmatrix}$.\nFor our $\\mathbf{F} = \\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix}$, we have $a=1, b=k, c=0, d=1$.\n$$\n\\mathbf{R}_{2D}(T) = \\frac{1}{\\sqrt{(1+1)^2 + (0-k)^2}} \\begin{pmatrix} 1+1 & -(0-k) \\\\ 0-k & 1+1 \\end{pmatrix} = \\frac{1}{\\sqrt{4+k^2}} \\begin{pmatrix} 2 & k \\\\ -k & 2 \\end{pmatrix}\n$$\nA general planar rotation by an angle $\\theta_{R}$ is represented by the matrix $\\begin{pmatrix} \\cos\\theta_{R} & -\\sin\\theta_{R} \\\\ \\sin\\theta_{R} & \\cos\\theta_{R} \\end{pmatrix}$. By comparing this with our derived $\\mathbf{R}_{2D}(T)$, we identify:\n$$\n\\cos(\\theta_{R}(T)) = \\frac{2}{\\sqrt{4+k^2}} \\quad \\text{and} \\quad \\sin(\\theta_{R}(T)) = \\frac{-k}{\\sqrt{4+k^2}}\n$$\nThe tangent of the angle is $\\tan(\\theta_{R}(T)) = \\frac{\\sin(\\theta_{R}(T))}{\\cos(\\theta_{R}(T))} = -\\frac{k}{2}$. Since $\\cos(\\theta_{R}) > 0$ and $\\sin(\\theta_{R}) < 0$ for $k>0$, the angle is in the fourth quadrant. The angle is given uniquely by the arctangent function:\n$$\n\\theta_{R}(T) = \\arctan\\left(-\\frac{k}{2}\\right) = -\\arctan\\left(\\frac{k}{2}\\right)\n$$\nFinally, we compute the error $\\varepsilon(k) = \\theta_{W}(T) - \\theta_{R}(T)$:\n$$\n\\varepsilon(k) = \\left( -\\frac{k}{2} \\right) - \\left( -\\arctan\\left(\\frac{k}{2}\\right) \\right) = \\arctan\\left(\\frac{k}{2}\\right) - \\frac{k}{2}\n$$\nThis is the required closed-form analytical expression for the error in terms of the accumulated shear $k$.", "answer": "$$\n\\boxed{\\arctan\\left(\\frac{k}{2}\\right) - \\frac{k}{2}}\n$$", "id": "2700460"}, {"introduction": "The previous exercise revealed that instantaneous spin does not straightforwardly integrate to finite rotation, a challenge that is central to computational mechanics. This hands-on numerical practice [@problem_id:2700502] provides a direct solution by showing how to construct a frame-invariant, or 'objective', constitutive update. You will implement a corotational algorithm that uses the vorticity vector $\\boldsymbol{\\omega}$ to correctly handle material spin, ensuring that your numerical model's predictions are physically sound and independent of the observer's reference frame.", "problem": "You are tasked with designing and implementing a principled time-stepping algorithm for updating a spin-dependent internal vector-valued variable in finite-deformation solid mechanics while preserving frame invariance (objectivity) of the stored energy. The target is to start from first principles and produce a robust update that uses the vorticity vector. Your final program must compute results for a specified test suite and print them in a single prescribed format.\n\nConsider a spatial velocity field with spatial velocity gradient $\\mathbf{L} = \\nabla \\mathbf{v}$. Define the spin tensor as the skew-symmetric part $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$ and the corresponding spin vector $\\mathbf{w}$ as its axial vector. The vorticity vector is defined as $\\boldsymbol{\\omega} = 2\\mathbf{w}$, which is equivalent to $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$. Let $\\mathbf{a}(t) \\in \\mathbb{R}^{3}$ denote a spatial internal vector whose evolution may depend on the local spin; assume the stored energy density depends on $\\mathbf{a}$ only through the quadratic form $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$ with $k > 0$ constant. Frame invariance (objectivity) requires that superposed rigid body motions do not alter the stored energy; equivalently, if $\\mathbf{S}(t)$ is any proper orthogonal tensor, then a superposed rigid rotation $\\mathbf{a} \\mapsto \\mathbf{S}\\mathbf{a}$ must leave $\\psi$ unchanged. Your task is to derive, from first principles and core definitions only, an algorithmic update of $\\mathbf{a}$ over a single time step that uses the spin vector $\\mathbf{w}$ in such a way that $\\psi$ remains invariant under arbitrary superposed rigid rotations.\n\nSpecifically, over a single time step of duration $\\Delta t$, suppose that within the step the spin is represented by the skew-symmetric generator $\\mathbf{W}$ associated with the spin vector $\\mathbf{w}$, and that the intrinsic (dissipative) evolution of $\\mathbf{a}$ occurs in a corotating frame via a linear relaxation $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$ with $\\lambda \\ge 0$ constant, where $\\widehat{\\mathbf{a}}$ denotes the internal variable expressed in the corotating frame. Your derivation should begin from the definitions of $\\mathbf{W}$, $\\mathbf{w}$, and objectivity; it must use a physically sound finite rotation over the step induced by the spin (obtained from the skew-symmetric generator), and it must articulate how to transform to and from the corotating frame to ensure that the stored energy density $\\psi$ is unaffected by superposed rigid motions. Do not assume any “shortcut” constitutive update formulas; instead, justify each step from the foundational kinematic definitions and the requirement of objectivity.\n\nImplementation requirements:\n- Use the exact finite rotation induced by the spin over the step as generated by the skew-symmetric operator corresponding to $\\mathbf{w}$ held constant during the step. Angles must be in radians. \n- Use the corotational update consistent with the objectivity requirement, where the dissipative model $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$ acts in the corotating frame.\n- The stored energy is $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$. Numerically verify energy invariance where appropriate.\n- All inputs are dimensionless; no physical unit conversions are required. \n\nTest suite to implement and evaluate:\n1. Pure rigid-body spin, no dissipation (energy conservation): \n   - Initial internal vector $\\mathbf{a}_{0} = [\\,1.2,\\,-0.7,\\,0.3\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,0,\\,0,\\,10\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.01$.\n   - Relaxation parameter $\\lambda = 0$.\n   - Stiffness $k = 2.0$.\n   - Output a boolean indicating whether the energy is conserved within a tolerance of $10^{-10}$ over one step.\n\n2. Frame invariance under superposed rigid rotation (objectivity check):\n   - Initial internal vector $\\mathbf{a}_{0} = [\\,0.3,\\,0.5,\\,-1.1\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,2.0,\\,-1.0,\\,0.5\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.02$.\n   - Relaxation parameter $\\lambda = 0$.\n   - Stiffness $k = 3.0$.\n   - Superposed rigid rotation $\\mathbf{S}$: rotation about the $x$-axis by angle $\\theta_{\\mathrm{s}} = 0.8$ radians (i.e., a proper orthogonal matrix corresponding to this axis-angle).\n   - Compute the update in two ways over one step: (A) in the original frame; (B) in the rotated frame starting from $\\mathbf{a}'_{0} = \\mathbf{S}\\mathbf{a}_{0}$ with $\\boldsymbol{\\omega}' = \\mathbf{S}\\boldsymbol{\\omega}$, and then map the result back by $\\mathbf{S}^{\\mathsf{T}}$. Output a boolean that is true if both the updated vectors satisfy $\\mathbf{a}_{1} = \\mathbf{S}^{\\mathsf{T}} \\mathbf{a}'_{1}$ within a tolerance of $10^{-10}$ and the final energies match within $10^{-10}$.\n\n3. Zero spin with dissipation (energy ratio):\n   - Initial internal vector $\\mathbf{a}_{0} = [\\,1.0,\\,2.0,\\,-1.0\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,0,\\,0,\\,0\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.02$.\n   - Relaxation parameter $\\lambda = 5.0$.\n   - Stiffness $k = 1.5$.\n   - Output the float ratio $\\psi(\\mathbf{a}_{1})/\\psi(\\mathbf{a}_{0})$ after one step.\n\n4. Combined spin and dissipation (objectivity of energy change under rotation):\n   - Initial internal vector $\\mathbf{a}_{0} = [\\,0.2,\\,-0.3,\\,0.4\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,4.0,\\,3.0,\\,0.0\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.005$.\n   - Relaxation parameter $\\lambda = 20.0$.\n   - Stiffness $k = 0.7$.\n   - Output a boolean that is true if the energy ratio $\\psi(\\mathbf{a}_{1})/\\psi(\\mathbf{a}_{0})$ matches the value predicted by dissipation alone in the corotating frame, namely $(1-\\lambda \\Delta t)^{2}$, within a tolerance of $10^{-12}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the four test cases above. For example, the format must be exactly like $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$, where the first, second, and fourth entries are booleans and the third is a float.", "solution": "The goal is to construct a time discretization for a spin-dependent internal vector $\\mathbf{a} \\in \\mathbb{R}^{3}$ that preserves frame invariance (objectivity) of the quadratic stored energy $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$, starting from fundamental definitions.\n\nFundamental kinematics:\n- The spatial velocity gradient is $\\mathbf{L} = \\nabla \\mathbf{v}$. Its skew-symmetric part is the spin tensor $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$.\n- The spin vector $\\mathbf{w}$ is the axial vector of $\\mathbf{W}$. The vorticity vector is $\\boldsymbol{\\omega} = 2\\mathbf{w}$. The mapping $\\mathbf{w} \\mapsto \\mathbf{W}$ is $\\mathbf{W} = \\operatorname{skew}(\\mathbf{w})$, where for $\\mathbf{w} = [\\,w_{x},\\,w_{y},\\,w_{z}\\,]^{\\mathsf{T}}$,\n$$\n\\operatorname{skew}(\\mathbf{w}) \\equiv\n\\begin{bmatrix}\n0 & -w_{z} & w_{y} \\\\\nw_{z} & 0 & -w_{x} \\\\\n-w_{y} & w_{x} & 0\n\\end{bmatrix}.\n$$\n\nObjectivity and corotational rate:\n- Frame invariance requires that superposed rigid body motions do not affect the physical response. For any proper orthogonal tensor $\\mathbf{S}(t)$, if $\\mathbf{a}$ transforms as $\\mathbf{a} \\mapsto \\mathbf{S}\\mathbf{a}$, then the stored energy must satisfy $\\psi(\\mathbf{a}) = \\psi(\\mathbf{S}\\mathbf{a})$. The quadratic form $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$ already satisfies this invariance since $\\lVert \\mathbf{S}\\mathbf{a} \\rVert = \\lVert \\mathbf{a} \\rVert$.\n- To ensure that the evolution law for $\\mathbf{a}$ is objective, its rate must be corotational. Introducing a rotation tensor $\\mathbf{R}(t)$ that follows the material spin via $\\dot{\\mathbf{R}}(t) = \\mathbf{W}(t)\\mathbf{R}(t)$ with $\\mathbf{R}(t_{n}) = \\mathbf{I}$ within a step, define the corotated internal variable $\\widehat{\\mathbf{a}}(t) = \\mathbf{R}(t)^{\\mathsf{T}}\\mathbf{a}(t)$. Differentiating gives\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\widehat{\\mathbf{a}} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left(\\mathbf{R}^{\\mathsf{T}} \\mathbf{a}\\right)\n= \\dot{\\mathbf{R}}^{\\mathsf{T}} \\mathbf{a} + \\mathbf{R}^{\\mathsf{T}} \\dot{\\mathbf{a}}\n= -\\mathbf{R}^{\\mathsf{T}}\\mathbf{W}^{\\mathsf{T}}\\mathbf{a} + \\mathbf{R}^{\\mathsf{T}} \\dot{\\mathbf{a}}\n= \\mathbf{R}^{\\mathsf{T}}(\\dot{\\mathbf{a}} - \\mathbf{W}\\mathbf{a}),\n$$\nsince $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$ for skew-symmetric $\\mathbf{W}$. An objective constitutive prescription is to model the intrinsic evolution in the corotating frame as\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\widehat{\\mathbf{a}} = G(\\widehat{\\mathbf{a}}),\n$$\nwith $G$ independent of superposed rigid rotations. For the present test, we take $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$ with $\\lambda \\ge 0$.\n\nFinite-rotation update over a time step:\n- Over a time step $[\\,t_{n}, t_{n} + \\Delta t\\,]$, approximate $\\mathbf{W}$ as constant (first-order hold) with generator $\\mathbf{W}_{n} = \\operatorname{skew}(\\mathbf{w}_{n})$. The exact finite rotation induced by the spin over the step is the proper orthogonal tensor\n$$\n\\mathbf{Q} = \\exp(\\Delta t \\, \\mathbf{W}_{n}),\n$$\nthe matrix exponential of a skew-symmetric matrix, which yields a rotation. If $\\theta = \\lVert \\mathbf{w}_{n} \\rVert \\Delta t$ and $\\widehat{\\boldsymbol{k}} = \\mathbf{w}_{n}/\\lVert \\mathbf{w}_{n} \\rVert$ for $\\lVert \\mathbf{w}_{n} \\rVert > 0$, then $\\mathbf{Q}$ is the rotation by angle $\\theta$ about axis $\\widehat{\\boldsymbol{k}}$. This can be computed robustly via Rodrigues’ formula; for very small $\\theta$, a series expansion provides a numerically stable approximation.\n\nObjective time-stepping algorithm:\n1. From the input vorticity $\\boldsymbol{\\omega}_{n}$, compute the spin vector $\\mathbf{w}_{n} = \\boldsymbol{\\omega}_{n}/2$.\n2. Build $\\mathbf{W}_{n} = \\operatorname{skew}(\\mathbf{w}_{n})$ and compute $\\mathbf{Q} = \\exp(\\Delta t \\, \\mathbf{W}_{n})$.\n3. Transform to the corotating frame at $t_{n}$ by $\\widehat{\\mathbf{a}}_{n} = \\mathbf{Q}^{\\mathsf{T}} \\mathbf{a}_{n}$.\n4. Advance the intrinsic evolution explicitly in the corotating frame:\n$$\n\\widehat{\\mathbf{a}}_{n+1} = \\widehat{\\mathbf{a}}_{n} + \\Delta t \\, G(\\widehat{\\mathbf{a}}_{n}) = (1 - \\lambda \\Delta t)\\, \\widehat{\\mathbf{a}}_{n}.\n$$\n5. Rotate back to the spatial frame:\n$$\n\\mathbf{a}_{n+1} = \\mathbf{Q} \\, \\widehat{\\mathbf{a}}_{n+1}.\n$$\nThis update is first-order accurate in time for both the rotation and the intrinsic evolution and exactly satisfies the composition of a finite rotation with a linear relaxation in the corotating frame.\n\nWhy objectivity holds:\n- Under any superposed rigid rotation $\\mathbf{S}$, the vorticity, spin, and internal vector transform as $\\boldsymbol{\\omega} \\mapsto \\mathbf{S}\\boldsymbol{\\omega}$, $\\mathbf{w} \\mapsto \\mathbf{S}\\mathbf{w}$, and $\\mathbf{a} \\mapsto \\mathbf{S}\\mathbf{a}$. The spin tensor transforms as $\\mathbf{W} \\mapsto \\mathbf{S} \\mathbf{W} \\mathbf{S}^{\\mathsf{T}}$. The step rotation obeys $\\mathbf{Q} \\mapsto \\mathbf{Q}' = \\exp(\\Delta t \\, \\mathbf{S}\\mathbf{W}\\mathbf{S}^{\\mathsf{T}}) = \\mathbf{S}\\, \\exp(\\Delta t \\mathbf{W}) \\, \\mathbf{S}^{\\mathsf{T}} = \\mathbf{S}\\mathbf{Q}\\mathbf{S}^{\\mathsf{T}}$, due to invariance of the exponential under similarity transforms. The corotated variable transforms as $\\widehat{\\mathbf{a}}_{n}' = \\mathbf{Q}'^{\\mathsf{T}} \\mathbf{a}_{n}' = (\\mathbf{S}\\mathbf{Q}\\mathbf{S}^{\\mathsf{T}})^{\\mathsf{T}} \\mathbf{S} \\mathbf{a}_{n} = \\mathbf{S} \\widehat{\\mathbf{a}}_{n}$. Because $G$ is formulated in the corotating frame and is isotropic here ($G = -\\lambda \\widehat{\\mathbf{a}}$), one has $\\widehat{\\mathbf{a}}_{n+1}' = (1 - \\lambda \\Delta t) \\widehat{\\mathbf{a}}_{n}' = \\mathbf{S} \\widehat{\\mathbf{a}}_{n+1}$. Rotating back gives $\\mathbf{a}_{n+1}' = \\mathbf{Q}' \\widehat{\\mathbf{a}}_{n+1}' = \\mathbf{S} \\mathbf{Q} \\mathbf{S}^{\\mathsf{T}} \\mathbf{S} \\widehat{\\mathbf{a}}_{n+1} = \\mathbf{S} \\mathbf{a}_{n+1}$. Consequently, $\\lVert \\mathbf{a}_{n+1}' \\rVert = \\lVert \\mathbf{a}_{n+1} \\rVert$ and $\\psi$ is unaffected by the superposed rotation, ensuring objectivity.\n- In particular, for pure spin with $\\lambda = 0$, the update reduces to $\\mathbf{a}_{n+1} = \\mathbf{Q} \\mathbf{a}_{n}$, a rigid rotation in space; hence $\\lVert \\mathbf{a}_{n+1} \\rVert = \\lVert \\mathbf{a}_{n} \\rVert$ and $\\psi$ is conserved exactly (modulo numerical roundoff).\n- For nonzero $\\lambda$, the magnitude changes solely through $(1 - \\lambda \\Delta t)$ in the corotating frame, implying $\\lVert \\mathbf{a}_{n+1} \\rVert = |1 - \\lambda \\Delta t| \\, \\lVert \\mathbf{a}_{n} \\rVert$, independent of the spin. Therefore, the energy ratio is\n$$\n\\frac{\\psi(\\mathbf{a}_{n+1})}{\\psi(\\mathbf{a}_{n})} = \\frac{\\tfrac{1}{2} k \\lVert \\mathbf{a}_{n+1} \\rVert^{2}}{\\tfrac{1}{2} k \\lVert \\mathbf{a}_{n} \\rVert^{2}} = (1 - \\lambda \\Delta t)^{2}.\n$$\n\nAlgorithmic details for computation:\n- Compute $\\mathbf{w} = \\boldsymbol{\\omega}/2$. Construct $\\mathbf{W}$ from $\\mathbf{w}$ via the axial map.\n- Compute $\\mathbf{Q} = \\exp(\\Delta t \\, \\mathbf{W})$. For numerical robustness, use Rodrigues’ formula when $\\theta = \\lVert \\mathbf{w} \\rVert \\Delta t$ is not extremely small, and a truncated series $\\mathbf{Q} \\approx \\mathbf{I} + \\Delta t \\, \\mathbf{W} + \\tfrac{1}{2} (\\Delta t \\, \\mathbf{W})^{2}$ when $\\theta$ is very small.\n- Perform the corotational explicit Euler update in the corotating frame and rotate back as stated.\n\nTest suite expectations:\n1. With $\\boldsymbol{\\omega} = [\\,0,\\,0,\\,10\\,]^{\\mathsf{T}}$, $\\Delta t = 0.01$, $\\lambda = 0$, energy is conserved, yielding a boolean $\\mathrm{True}$ within tolerance $10^{-10}$.\n2. With $\\boldsymbol{\\omega} = [\\,2.0,\\,-1.0,\\,0.5\\,]^{\\mathsf{T}}$, $\\Delta t = 0.02$, $\\lambda = 0$, and a superposed rotation, the objectivity condition $\\mathbf{a}_{1}' = \\mathbf{S}\\mathbf{a}_{1}$ holds and energies match, yielding boolean $\\mathrm{True}$ within tolerance $10^{-10}$.\n3. With $\\boldsymbol{\\omega} = [\\,0,\\,0,\\,0\\,]^{\\mathsf{T}}$, $\\Delta t = 0.02$, $\\lambda = 5.0$, the energy ratio is $(1 - \\lambda \\Delta t)^{2} = (1 - 5.0 \\times 0.02)^{2} = 0.81$, output as a float.\n4. With $\\boldsymbol{\\omega} = [\\,4.0,\\,3.0,\\,0.0\\,]^{\\mathsf{T}}$, $\\Delta t = 0.005$, $\\lambda = 20.0$, the energy ratio should equal $(1 - \\lambda \\Delta t)^{2} = (1 - 20.0 \\times 0.005)^{2} = 0.81$, hence the boolean test comparing the computed ratio to $0.81$ within $10^{-12}$ should be $\\mathrm{True}$.\n\nThe program must implement this algorithm and print the results for the four tests as a single list on one line, in the specified order and format.", "answer": "```python\nimport numpy as np\n\ndef skew_from_vec(w):\n    wx, wy, wz = w\n    return np.array([[0.0, -wz, wy],\n                     [wz,  0.0, -wx],\n                     [-wy, wx,  0.0]], dtype=float)\n\ndef rotation_from_w_dt(w, dt, tol=1e-12):\n    # Construct proper orthogonal rotation Q = exp(dt * W(w))\n    w = np.asarray(w, dtype=float).reshape(3)\n    wnorm = np.linalg.norm(w)\n    if wnorm < tol:\n        # Small-angle series: Q ≈ I + dt*W + 0.5*(dt*W)^2\n        Wdt = skew_from_vec(w) * dt\n        return np.eye(3) + Wdt + 0.5 * (Wdt @ Wdt)\n    # Axis-angle Rodrigues\n    k = w / wnorm\n    K = skew_from_vec(k)\n    theta = wnorm * dt\n    s = np.sin(theta)\n    c = np.cos(theta)\n    return np.eye(3) + s * K + (1.0 - c) * (K @ K)\n\ndef objective_update_a(a_n, omega, dt, lam):\n    # One-step objective update using corotational explicit Euler with linear relaxation\n    # omega is vorticity, w is spin vector\n    w = omega / 2.0\n    Q = rotation_from_w_dt(w, dt)\n    # Corotational transform\n    a_hat_n = Q.T @ a_n\n    # Intrinsic evolution in corotating frame: a_hat_{n+1} = (1 - lam*dt) a_hat_n\n    a_hat_np1 = (1.0 - lam * dt) * a_hat_n\n    # Rotate back\n    a_np1 = Q @ a_hat_np1\n    return a_np1\n\ndef energy(a, k):\n    return 0.5 * k * float(a @ a)\n\ndef test_case_1():\n    a0 = np.array([1.2, -0.7, 0.3], dtype=float)\n    omega = np.array([0.0, 0.0, 10.0], dtype=float)\n    dt = 0.01\n    lam = 0.0\n    k = 2.0\n    E0 = energy(a0, k)\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    return abs(E1 - E0) <= 1e-10\n\ndef rotation_about_x(theta):\n    c = np.cos(theta)\n    s = np.sin(theta)\n    return np.array([[1.0, 0.0, 0.0],\n                     [0.0, c,   -s ],\n                     [0.0, s,    c ]], dtype=float)\n\ndef test_case_2():\n    a0 = np.array([0.3, 0.5, -1.1], dtype=float)\n    omega = np.array([2.0, -1.0, 0.5], dtype=float)\n    dt = 0.02\n    lam = 0.0\n    k = 3.0\n    # Frame A\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    # Superposed rotation S about x by 0.8 rad\n    theta_s = 0.8\n    S = rotation_about_x(theta_s)\n    # Transform to frame B\n    a0p = S @ a0\n    omegap = S @ omega\n    # Update in frame B\n    a1p = objective_update_a(a0p, omegap, dt, lam)\n    # Map back to frame A\n    a1_back = S.T @ a1p\n    E1p = energy(a1p, k)  # energy is frame-invariant with same k\n    same_vec = np.allclose(a1_back, a1, atol=1e-10, rtol=0.0)\n    same_energy = abs(E1p - E1) <= 1e-10\n    return bool(same_vec and same_energy)\n\ndef test_case_3():\n    a0 = np.array([1.0, 2.0, -1.0], dtype=float)\n    omega = np.array([0.0, 0.0, 0.0], dtype=float)\n    dt = 0.02\n    lam = 5.0\n    k = 1.5\n    E0 = energy(a0, k)\n    if E0 == 0: return 0.0\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    ratio = E1 / E0\n    return float(ratio)\n\ndef test_case_4():\n    a0 = np.array([0.2, -0.3, 0.4], dtype=float)\n    omega = np.array([4.0, 3.0, 0.0], dtype=float)\n    dt = 0.005\n    lam = 20.0\n    k = 0.7\n    E0 = energy(a0, k)\n    if E0 == 0: return False\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    ratio = E1 / E0\n    expected = (1.0 - lam * dt) ** 2\n    return abs(ratio - expected) <= 1e-12\n\ndef solve():\n    results = []\n    results.append(test_case_1())\n    results.append(test_case_2())\n    results.append(test_case_3())\n    results.append(test_case_4())\n    print(f\"[{','.join(str(r) for r in results).replace('True', 'true').replace('False', 'false')}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2700502"}]}