{"hands_on_practices": [{"introduction": "Any rigorous analysis of a structure begins with its constitutive law, the mathematical relationship between stress and strain. For functionally graded materials, this law becomes position-dependent. This foundational exercise [@problem_id:2660898] guides you through the derivation of the plane-stress constitutive matrix for an FGM plate, a critical building block for developing theories for FGM plates and shells. Mastering this derivation is an essential first step in understanding how graded properties are formally incorporated into the governing equations of continuum mechanics.", "problem": "Consider a thin functionally graded material (FGM) plate of thickness $h$, with the through-thickness coordinate $z \\in [-h/2,h/2]$ measured from the mid-surface. The material is locally isotropic at each $z$ and obeys small-strain linear elasticity. The Young’s modulus varies through the thickness as $E(z) = E_0 \\left(1 + \\beta z \\right)$, where $E_0>0$ and $\\beta$ are constants, and the Poisson’s ratio is constant, denoted by $\\nu$ with $-1<\\nu<\\tfrac{1}{2}$. Assume plane-stress conditions appropriate for a thin plate, so that $\\sigma_{zz}=\\tau_{yz}=\\tau_{zx}=0$. Let the in-plane stress and engineering strain vectors be defined as\n$$\n\\boldsymbol{\\sigma} = \n\\begin{pmatrix}\n\\sigma_{xx} \\\\\n\\sigma_{yy} \\\\\n\\tau_{xy}\n\\end{pmatrix},\n\\qquad\n\\boldsymbol{\\varepsilon} = \n\\begin{pmatrix}\n\\varepsilon_{xx} \\\\\n\\varepsilon_{yy} \\\\\n\\gamma_{xy}\n\\end{pmatrix},\n$$\nwhere $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$ is the engineering shear strain.\n\nStarting from the three-dimensional isotropic linear elastic relations and enforcing the plane-stress condition, derive the plane-stress constitutive matrix $Q(z)$ such that $\\boldsymbol{\\sigma} = Q(z)\\,\\boldsymbol{\\varepsilon}$. Express your final result as a single closed-form analytic expression for $Q(z)$ in terms of $E_0$, $\\beta$, $\\nu$, and $z$. No numerical evaluation is required, and no units are needed in the final expression.", "solution": "The problem requires the derivation of the plane-stress constitutive matrix $Q(z)$ for a functionally graded material plate where the Young's modulus $E$ varies linearly through the thickness and the Poisson's ratio $\\nu$ is constant. The derivation begins with the general three-dimensional Hooke's law for a locally isotropic and linear elastic material.\n\nThe constitutive relations, which express strains in terms of stresses, are given by:\n$$\n\\begin{align*}\n\\varepsilon_{xx} &= \\frac{1}{E(z)} \\left[ \\sigma_{xx} - \\nu (\\sigma_{yy} + \\sigma_{zz}) \\right] \\\\\n\\varepsilon_{yy} &= \\frac{1}{E(z)} \\left[ \\sigma_{yy} - \\nu (\\sigma_{xx} + \\sigma_{zz}) \\right] \\\\\n\\varepsilon_{zz} &= \\frac{1}{E(z)} \\left[ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) \\right] \\\\\n\\gamma_{xy} &= \\frac{1}{G(z)} \\tau_{xy}, \\quad \\gamma_{yz} = \\frac{1}{G(z)} \\tau_{yz}, \\quad \\gamma_{zx} = \\frac{1}{G(z)} \\tau_{zx}\n\\end{align*}\n$$\nHere, $\\varepsilon_{ij}$ are the normal strain components, and $\\gamma_{ij}$ are the engineering shear strain components. The material properties $E(z)$ and $G(z)$ are the position-dependent Young's modulus and shear modulus, respectively. For an isotropic material, the shear modulus is related to the Young's modulus and Poisson's ratio by $G(z) = \\frac{E(z)}{2(1+\\nu)}$. Note that $\\nu$ is a constant.\n\nThe problem specifies plane-stress conditions, which are appropriate for a thin plate. This condition implies that stress components acting perpendicular to the plate's mid-surface are zero:\n$$\n\\sigma_{zz} = \\tau_{yz} = \\tau_{zx} = 0\n$$\nApplying these conditions to the 3D constitutive equations simplifies them significantly. The out-of-plane shear strains $\\gamma_{yz}$ and $\\gamma_{zx}$ become zero. The in-plane strain-stress relations reduce to:\n$$\n\\begin{align*}\n\\varepsilon_{xx} &= \\frac{1}{E(z)} (\\sigma_{xx} - \\nu \\sigma_{yy}) \\quad &(1) \\\\\n\\varepsilon_{yy} &= \\frac{1}{E(z)} (\\sigma_{yy} - \\nu \\sigma_{xx}) \\quad &(2) \\\\\n\\gamma_{xy} &= \\frac{1}{G(z)} \\tau_{xy} = \\frac{2(1+\\nu)}{E(z)} \\tau_{xy} \\quad &(3)\n\\end{align*}\n$$\nThe problem requires the matrix $Q(z)$ in the relation $\\boldsymbol{\\sigma} = Q(z)\\boldsymbol{\\varepsilon}$. This requires us to invert the above system of equations to express stresses ($\\sigma_{xx}$, $\\sigma_{yy}$, $\\tau_{xy}$) in terms of strains ($\\varepsilon_{xx}$, $\\varepsilon_{yy}$, $\\gamma_{xy}$).\n\nFirst, we solve the coupled system of equations $(1)$ and $(2)$ for $\\sigma_{xx}$ and $\\sigma_{yy}$. From equation $(1)$, we can write:\n$$\nE(z) \\varepsilon_{xx} = \\sigma_{xx} - \\nu \\sigma_{yy}\n$$\nFrom equation $(2)$, we have:\n$$\nE(z) \\varepsilon_{yy} = \\sigma_{yy} - \\nu \\sigma_{xx}\n$$\nWe can express this system in matrix form:\n$$\n\\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\end{pmatrix}\n= \\frac{1}{E(z)}\n\\begin{pmatrix} 1 & -\\nu \\\\ -\\nu & 1 \\end{pmatrix}\n\\begin{pmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\end{pmatrix}\n$$\nTo solve for the stresses, we must invert the $2 \\times 2$ matrix:\n$$\n\\begin{pmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\end{pmatrix}\n= E(z)\n\\begin{pmatrix} 1 & -\\nu \\\\ -\\nu & 1 \\end{pmatrix}^{-1}\n\\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\end{pmatrix}\n$$\nThe inverse of the matrix is:\n$$\n\\begin{pmatrix} 1 & -\\nu \\\\ -\\nu & 1 \\end{pmatrix}^{-1} = \\frac{1}{1 - (-\\nu)(-\\nu)} \\begin{pmatrix} 1 & \\nu \\\\ \\nu & 1 \\end{pmatrix} = \\frac{1}{1-\\nu^2} \\begin{pmatrix} 1 & \\nu \\\\ \\nu & 1 \\end{pmatrix}\n$$\nSubstituting this back, we obtain the expressions for the normal stresses:\n$$\n\\begin{pmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\end{pmatrix}\n= \\frac{E(z)}{1-\\nu^2}\n\\begin{pmatrix} 1 & \\nu \\\\ \\nu & 1 \\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\end{pmatrix}\n$$\nThis expands to:\n$$\n\\sigma_{xx} = \\frac{E(z)}{1-\\nu^2} (\\varepsilon_{xx} + \\nu \\varepsilon_{yy})\n$$\n$$\n\\sigma_{yy} = \\frac{E(z)}{1-\\nu^2} (\\varepsilon_{yy} + \\nu \\varepsilon_{xx})\n$$\nNext, we invert equation $(3)$ to find the shear stress $\\tau_{xy}$:\n$$\n\\tau_{xy} = G(z) \\gamma_{xy} = \\frac{E(z)}{2(1+\\nu)} \\gamma_{xy}\n$$\nNow we assemble these results into the matrix equation $\\boldsymbol{\\sigma} = Q(z)\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{\\sigma} = (\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy})^T$ and $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^T$.\n$$\n\\begin{pmatrix}\n\\sigma_{xx} \\\\\n\\sigma_{yy} \\\\\n\\tau_{xy}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{E(z)}{1-\\nu^2} & \\frac{\\nu E(z)}{1-\\nu^2} & 0 \\\\\n\\frac{\\nu E(z)}{1-\\nu^2} & \\frac{E(z)}{1-\\nu^2} & 0 \\\\\n0 & 0 & \\frac{E(z)}{2(1+\\nu)}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\varepsilon_{xx} \\\\\n\\varepsilon_{yy} \\\\\n\\gamma_{xy}\n\\end{pmatrix}\n$$\nThe matrix in this equation is the plane-stress constitutive matrix $Q(z)$. We can simplify a term in the matrix:\n$$\n\\frac{E(z)}{2(1+\\nu)} = \\frac{E(z)}{1-\\nu^2} \\cdot \\frac{1-\\nu^2}{2(1+\\nu)} = \\frac{E(z)}{1-\\nu^2} \\cdot \\frac{(1-\\nu)(1+\\nu)}{2(1+\\nu)} = \\frac{E(z)}{1-\\nu^2} \\cdot \\frac{1-\\nu}{2}\n$$\nThis allows us to factor out the term $\\frac{E(z)}{1-\\nu^2}$ from the entire matrix:\n$$\nQ(z) = \\frac{E(z)}{1-\\nu^2}\n\\begin{pmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{pmatrix}\n$$\nFinally, we substitute the given expression for the Young's modulus, $E(z) = E_0 (1 + \\beta z)$, into this result.\n$$\nQ(z) = \\frac{E_0(1 + \\beta z)}{1-\\nu^2}\n\\begin{pmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{pmatrix}\n$$\nThis is the final closed-form analytical expression for the plane-stress constitutive matrix $Q(z)$ in terms of the given parameters.", "answer": "$$\\boxed{\\frac{E_0(1 + \\beta z)}{1-\\nu^2}\n\\begin{pmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{pmatrix}}$$", "id": "2660898"}, {"introduction": "A common engineering approach is to approximate a complex heterogeneous material with an equivalent homogeneous one, but how accurate is this? This practice [@problem_id:2660829] explores the concept of effective bending rigidity in an FGM beam and requires you to quantify the error introduced by using a simple area-averaged modulus. The exercise provides crucial physical insight into why bending stiffness depends on the higher-order moments of the modulus distribution, not just its mean value, highlighting the limitations of simple homogenization.", "problem": "A straight prismatic beam of length $L$, width $b$, and thickness $h$ is made of a functionally graded material (FGM). The elastic modulus varies smoothly through the thickness coordinate $z$ (measured from the mid-plane, so $z \\in [-h/2, h/2]$) according to\n$$\nE(z) = E_{0}\\left[1 + \\eta \\left(\\frac{2 z}{h}\\right)^{2}\\right],\n$$\nwhere $E_{0} \\gt 0$ is a constant reference modulus and $\\eta \\ge 0$ is a prescribed non-dimensional gradient parameter. The beam is simply supported at $x=0$ and $x=L$ and is subjected to a spatially uniform transverse load of intensity $q$ (force per unit length) along its span. Assume small deflections and the Euler–Bernoulli kinematic assumption that plane sections remain plane and normal to the deformed centerline, with no shear deformation.\n\nAn engineer approximates the graded beam by an equivalent homogeneous beam having the same cross-sectional geometry and elastic modulus equal to the area-average\n$$\nE_{\\text{eq}}=\\frac{1}{A}\\int_{A} E(z)\\, dA,\n$$\nwhere $A$ is the cross-sectional area. Under identical loading and supports, the engineer uses $E_{\\text{eq}}$ times the centroidal second moment of area to predict the maximum midspan deflection.\n\nStarting from the equilibrium and compatibility relations of Euler–Bernoulli beam theory, and without introducing any ad hoc correction factors, derive a closed-form expression for the relative error in the predicted maximum midspan deflection,\n$$\n\\delta \\equiv \\frac{w_{\\text{eq}} - w_{\\text{true}}}{w_{\\text{true}}},\n$$\nwhere $w_{\\text{eq}}$ is the maximum midspan deflection predicted using the equivalent homogeneous beam with modulus $E_{\\text{eq}}$, and $w_{\\text{true}}$ is the corresponding deflection of the actual graded beam.\n\nExpress your final answer as a single simplified analytic expression in terms of $\\eta$ only. No numerical evaluation is required.", "solution": "The fundamental governing equation for the deflection $w(x)$ of an Euler–Bernoulli beam relates the bending moment $M(x)$ to the curvature $\\frac{d^{2}w}{dx^{2}}$ through the effective bending rigidity, denoted here as $(EI)_{\\text{eff}}$. For a beam with elastic modulus $E$ varying through the thickness coordinate $z$, the moment-curvature relationship is\n$$\nM(x) = \\left(\\int_{A} E(z) z^{2} \\,dA\\right) \\frac{d^{2}w}{dx^{2}}\n$$\nwhere the integral term is the effective bending rigidity, $(EI)_{\\text{eff}}$. For a simply supported beam of length $L$ under a uniform load $q$, the maximum midspan deflection is given by the standard formula\n$$\nw_{\\text{max}} = \\frac{5qL^{4}}{384 (EI)_{\\text{eff}}}\n$$\nThe deflection is inversely proportional to the effective bending rigidity. The relative error $\\delta$ can thus be expressed in terms of the true and equivalent rigidities:\n$$\n\\delta \\equiv \\frac{w_{\\text{eq}} - w_{\\text{true}}}{w_{\\text{true}}} = \\frac{\\frac{5qL^{4}}{384 (EI)_{\\text{eq}}} - \\frac{5qL^{4}}{384 (EI)_{\\text{true}}}}{\\frac{5qL^{4}}{384 (EI)_{\\text{true}}}} = \\frac{(EI)_{\\text{true}}}{(EI)_{\\text{eq}}} - 1\n$$\nThe task reduces to calculating the true rigidity $(EI)_{\\text{true}}$ and the equivalent rigidity $(EI)_{\\text{eq}}$.\n\nFirst, we calculate the true effective bending rigidity, $(EI)_{\\text{true}}$, for the functionally graded beam. The cross-section is a rectangle of width $b$ and thickness $h$, so the differential area element is $dA = b \\,dz$.\n$$\n(EI)_{\\text{true}} = \\int_{A} E(z) z^{2} \\,dA = \\int_{-h/2}^{h/2} E_{0}\\left[1 + \\eta \\left(\\frac{2 z}{h}\\right)^{2}\\right] z^{2} b \\,dz\n$$\n$$\n(EI)_{\\text{true}} = E_{0}b \\int_{-h/2}^{h/2} \\left[z^{2} + \\frac{4\\eta}{h^{2}}z^{4}\\right] \\,dz\n$$\nThe integrand is an even function of $z$, so we can simplify the integral:\n$$\n(EI)_{\\text{true}} = 2E_{0}b \\int_{0}^{h/2} \\left[z^{2} + \\frac{4\\eta}{h^{2}}z^{4}\\right] \\,dz = 2E_{0}b \\left[\\frac{z^{3}}{3} + \\frac{4\\eta}{h^{2}}\\frac{z^{5}}{5}\\right]_{0}^{h/2}\n$$\n$$\n(EI)_{\\text{true}} = 2E_{0}b \\left[\\frac{(h/2)^{3}}{3} + \\frac{4\\eta}{5h^{2}}(h/2)^{5}\\right] = 2E_{0}b \\left[\\frac{h^{3}}{24} + \\frac{4\\eta h^{5}}{5h^{2}(32)}\\right]\n$$\n$$\n(EI)_{\\text{true}} = 2E_{0}b \\left[\\frac{h^{3}}{24} + \\frac{\\eta h^{3}}{40}\\right] = E_{0}bh^{3}\\left[\\frac{1}{12} + \\frac{\\eta}{20}\\right]\n$$\nRecognizing the second moment of area for a homogeneous rectangular cross-section as $I = \\frac{bh^{3}}{12}$, we can write:\n$$\n(EI)_{\\text{true}} = E_{0} \\frac{bh^{3}}{12} \\left[1 + \\frac{12\\eta}{20}\\right] = E_{0}I \\left(1 + \\frac{3\\eta}{5}\\right)\n$$\n\nNext, we calculate the rigidity of the equivalent homogeneous beam, $(EI)_{\\text{eq}}$. First, we must find the area-averaged modulus $E_{\\text{eq}}$ as prescribed. The cross-sectional area is $A = bh$.\n$$\nE_{\\text{eq}} = \\frac{1}{A} \\int_{A} E(z) \\,dA = \\frac{1}{bh} \\int_{-h/2}^{h/2} E_{0}\\left[1 + \\eta \\left(\\frac{2 z}{h}\\right)^{2}\\right] b \\,dz\n$$\n$$\nE_{\\text{eq}} = \\frac{E_{0}}{h} \\int_{-h/2}^{h/2} \\left[1 + \\frac{4\\eta}{h^{2}}z^{2}\\right] \\,dz\n$$\nAgain, the integrand is an even function:\n$$\nE_{\\text{eq}} = \\frac{2E_{0}}{h} \\int_{0}^{h/2} \\left[1 + \\frac{4\\eta}{h^{2}}z^{2}\\right] \\,dz = \\frac{2E_{0}}{h} \\left[z + \\frac{4\\eta}{h^{2}}\\frac{z^{3}}{3}\\right]_{0}^{h/2}\n$$\n$$\nE_{\\text{eq}} = \\frac{2E_{0}}{h} \\left[\\frac{h}{2} + \\frac{4\\eta (h/2)^{3}}{3h^{2}}\\right] = \\frac{2E_{0}}{h} \\left[\\frac{h}{2} + \\frac{4\\eta h^{3}}{24h^{2}}\\right]\n$$\n$$\nE_{\\text{eq}} = \\frac{2E_{0}}{h} \\left[\\frac{h}{2} + \\frac{\\eta h}{6}\\right] = E_{0}\\left(1 + \\frac{\\eta}{3}\\right)\n$$\nThe equivalent bending rigidity is the product of this constant modulus $E_{\\text{eq}}$ and the centroidal second moment of area $I = \\frac{bh^{3}}{12}$.\n$$\n(EI)_{\\text{eq}} = E_{\\text{eq}} I = E_{0}\\left(1 + \\frac{\\eta}{3}\\right)I\n$$\nNow, we can compute the relative error $\\delta$.\n$$\n\\delta = \\frac{(EI)_{\\text{true}}}{(EI)_{\\text{eq}}} - 1 = \\frac{E_{0}I \\left(1 + \\frac{3\\eta}{5}\\right)}{E_{0}I \\left(1 + \\frac{\\eta}{3}\\right)} - 1 = \\frac{1 + \\frac{3\\eta}{5}}{1 + \\frac{\\eta}{3}} - 1\n$$\nTo simplify the expression, we find a common denominator:\n$$\n\\delta = \\frac{1 + \\frac{3\\eta}{5} - \\left(1 + \\frac{\\eta}{3}\\right)}{1 + \\frac{\\eta}{3}} = \\frac{\\frac{3\\eta}{5} - \\frac{\\eta}{3}}{1 + \\frac{\\eta}{3}}\n$$\nThe numerator is $\\frac{3\\eta}{5} - \\frac{\\eta}{3} = \\frac{9\\eta - 5\\eta}{15} = \\frac{4\\eta}{15}$.\nThe denominator is $1 + \\frac{\\eta}{3} = \\frac{3+\\eta}{3}$.\nThus, the relative error is:\n$$\n\\delta = \\frac{\\frac{4\\eta}{15}}{\\frac{3+\\eta}{3}} = \\frac{4\\eta}{15} \\cdot \\frac{3}{3+\\eta} = \\frac{4\\eta}{5(3+\\eta)}\n$$\nThis is the final simplified expression for the relative error in terms of the gradient parameter $\\eta$. Since $\\eta \\ge 0$, the error $\\delta \\ge 0$, which signifies that the homogeneous approximation overestimates the deflection by underestimating the effective bending stiffness. This is physically correct, as the simple area average of the modulus fails to give proper weight to the stiffer material in the outer fibers, which contributes more significantly to the bending rigidity.", "answer": "$$\n\\boxed{\\frac{4\\eta}{5(3+\\eta)}}\n$$", "id": "2660829"}, {"introduction": "Since analytical solutions for FGM structures are often intractable, numerical techniques like the Finite Element Method (FEM) are indispensable tools for analysis and design. This problem [@problem_id:2660878] delves into the heart of computational mechanics for FGMs by deriving the stiffness matrix for an isoparametric element that includes property interpolation. By analyzing the polynomial degree of the integrand, this exercise addresses the vital and practical issue of selecting the correct numerical quadrature rule to ensure the stiffness matrix is computed accurately, bridging the gap between continuous theory and computational implementation.", "problem": "Consider a two-dimensional, four-node, bilinear isoparametric quadrilateral element in plane stress, occupying a rectangular domain in physical space with side lengths $L_{x}$ and $L_{y}$. The isoparametric mapping from the parent square $[-1,1] \\times [-1,1]$ with parent coordinates $(\\xi,\\eta)$ to the physical coordinates $(x,y)$ is affine: $x(\\xi,\\eta) = x_{c} + \\tfrac{L_{x}}{2}\\,\\xi$ and $y(\\xi,\\eta) = y_{c} + \\tfrac{L_{y}}{2}\\,\\eta$, where $(x_{c},y_{c})$ is the center of the rectangle. The displacement field is interpolated with the standard bilinear shape functions $N_{i}(\\xi,\\eta)$, $i=1,\\dots,4$, so that $u_{x}(x,y) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,d_{xi}$ and $u_{y}(x,y) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,d_{yi}$, where $d_{xi}$ and $d_{yi}$ are the nodal displacement components.\n\nThe material is a functionally graded isotropic elastic solid in plane stress with constant Poisson ratio $\\nu$ and spatially varying Young’s modulus $E(x,y)$. The modulus is interpolated isoparametrically from nodal values via property interpolation, $E(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,E_{i}$, where $E_{i}$ are the nodal moduli. The plane-stress constitutive matrix is $C(\\xi,\\eta) = \\dfrac{E(\\xi,\\eta)}{1-\\nu^{2}} \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\tfrac{1-\\nu}{2} \\end{bmatrix}$, and the small-strain tensor components are collected as $\\epsilon = [\\epsilon_{xx},\\,\\epsilon_{yy},\\,\\gamma_{xy}]^{T}$ with $\\epsilon = B(\\xi,\\eta)\\,d$ for an appropriate strain-displacement matrix $B(\\xi,\\eta)$ and nodal displacement vector $d$.\n\nStarting from the principle of virtual work and standard definitions of strain and stress for small deformations in linear elasticity, perform the following tasks:\n\n1. Derive the bilinear isoparametric element stiffness matrix in the parent domain by expressing the internal virtual work in terms of the nodal displacements, identifying the strain-displacement matrix $B(\\xi,\\eta)$, the constitutive matrix $C(\\xi,\\eta)$, and the Jacobian determinant $\\det J$. Do not assume a priori any specific integral form; instead, derive it from first principles and the isoparametric mapping.\n\n2. Using the affine mapping specified, determine whether $\\det J$ is constant and characterize the dependence of the entries of $B(\\xi,\\eta)$ on $\\xi$ and $\\eta$ (i.e., classify the polynomial degree of these entries in $\\xi$ and $\\eta$).\n\n3. With property interpolation $E(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,E_{i}$ and constant $\\nu$, determine the highest polynomial degree in $\\xi$ and in $\\eta$ that appears in any scalar component of the integrand of the stiffness matrix, i.e., in each component of the matrix field $B(\\xi,\\eta)^{T} C(\\xi,\\eta) B(\\xi,\\eta)\\,\\det J$ over the parent domain.\n\n4. Based on your polynomial degree assessment, determine the minimum number $n$ of Gauss–Legendre quadrature points per direction required to exactly integrate all stiffness matrix components over the parent square by a tensor-product quadrature rule. Report as your final answer the minimum total number of quadrature points $N_{\\text{tot}} = n^{2}$ needed for exact integration. The final answer is a single integer and is dimensionless. No rounding is necessary.", "solution": "The problem requires a systematic derivation and analysis of the stiffness matrix for a specific finite element configuration. We address each task sequentially.\n\n**1. Derivation of the Element Stiffness Matrix**\n\nThe element stiffness matrix, denoted $K^e$, relates the nodal forces to the nodal displacements of an element. Its derivation begins with the principle of virtual work. The internal virtual work $\\delta W_{\\text{int}}$ for a deformable body occupying a volume $V_e$ is given by:\n$$ \\delta W_{\\text{int}} = \\int_{V_e} \\delta\\epsilon^T \\sigma \\, dV $$\nFor a two-dimensional plane stress problem with a constant thickness $t$, this becomes an integral over the element area $A_e$:\n$$ \\delta W_{\\text{int}} = t \\int_{A_e} \\delta\\epsilon^T \\sigma \\, dA $$\nWe will assume unit thickness, $t=1$, as is conventional when its value is not specified.\nThe constitutive relation for linear elasticity is $\\sigma = C \\epsilon$, where $\\sigma$ is the stress vector, $\\epsilon$ is the strain vector, and $C$ is the material constitutive matrix. The strain is derived from the nodal displacement vector $d$ through the strain-displacement matrix $B$, such that $\\epsilon = B d$. For small deformations, $B$ depends on position but not on the displacements. The virtual strain is thus $\\delta\\epsilon = B \\delta d$.\n\nSubstituting these relations into the internal virtual work expression:\n$$ \\delta W_{\\text{int}} = \\int_{A_e} (B \\delta d)^T (C B d) \\, dA = (\\delta d)^T \\left( \\int_{A_e} B^T C B \\, dA \\right) d $$\nFrom the equivalence $\\delta W_{\\text{int}} = (\\delta d)^T K^e d$, we identify the element stiffness matrix as:\n$$ K^e = \\int_{A_e} B^T C B \\, dA $$\nThe isoparametric formulation maps the physical domain $(x,y)$ to a parent domain $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$. The integral must be transformed to this parent domain. The differential area element transforms as $dA = \\det(J) \\, d\\xi d\\eta$, where $J$ is the Jacobian matrix of the coordinate transformation. The stiffness matrix integral becomes:\n$$ K^e = \\int_{-1}^{1} \\int_{-1}^{1} B(\\xi,\\eta)^T C(\\xi,\\eta) B(\\xi,\\eta) \\det(J) \\, d\\xi d\\eta $$\nThe components of the strain vector $\\epsilon = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^T$ are given by derivatives of the displacement field $(u_x, u_y)$. Using the chain rule for differentiation:\n$$ \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} $$\nThe displacement field is interpolated from nodal displacements $d_i = [d_{xi}, d_{yi}]^T$ using shape functions $N_i(\\xi, \\eta)$:\n$u_x = \\sum_{i=1}^{4} N_i d_{xi}$ and $u_y = \\sum_{i=1}^{4} N_i d_{yi}$.\nThe strain components are:\n$$ \\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial x} d_{xi}, \\quad \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial y} d_{yi}, \\quad \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\sum_{i=1}^{4} \\left( \\frac{\\partial N_i}{\\partial y} d_{xi} + \\frac{\\partial N_i}{\\partial x} d_{yi} \\right) $$\nAssembling these into the matrix form $\\epsilon = B d$, where $d = [d_{x1}, d_{y1}, \\dots, d_{x4}, d_{y4}]^T$, we find that $B = [B_1, B_2, B_3, B_4]$, where each $B_i$ is a $3 \\times 2$ matrix:\n$$ B_i(\\xi, \\eta) = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix} $$\nThe derivatives of the shape functions with respect to physical coordinates are computed as:\n$$ \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} $$\nThe constitutive matrix $C(\\xi, \\eta)$ is provided in the problem statement, depending on the spatially varying Young's modulus $E(\\xi, \\eta)$ and constant Poisson's ratio $\\nu$. This completes the derivation and definition of all terms required for the stiffness matrix.\n\n**2. Jacobian and Strain-Displacement Matrix Characterization**\n\nThe problem specifies an affine mapping for a rectangular element:\n$x(\\xi,\\eta) = x_{c} + \\frac{L_{x}}{2}\\xi$ and $y(\\xi,\\eta) = y_{c} + \\frac{L_{y}}{2}\\eta$.\nThe Jacobian matrix $J$ of this transformation is:\n$$ J = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\frac{L_x}{2} & 0 \\\\ 0 & \\frac{L_y}{2} \\end{bmatrix} $$\nThe determinant of the Jacobian is $\\det(J) = (\\frac{L_x}{2})(\\frac{L_y}{2}) - (0)(0) = \\frac{L_x L_y}{4}$. Since $L_x$ and $L_y$ are constants, **$\\det(J)$ is constant** throughout the element.\n\nThe inverse Jacobian matrix is also constant:\n$$ J^{-1} = \\begin{bmatrix} \\frac{2}{L_x} & 0 \\\\ 0 & \\frac{2}{L_y} \\end{bmatrix} $$\nThe derivatives of the shape functions with respect to physical coordinates are then:\n$$ \\frac{\\partial N_i}{\\partial x} = \\frac{2}{L_x} \\frac{\\partial N_i}{\\partial \\xi}, \\quad \\frac{\\partial N_i}{\\partial y} = \\frac{2}{L_y} \\frac{\\partial N_i}{\\partial \\eta} $$\nThe standard bilinear shape functions $N_i(\\xi,\\eta) = \\frac{1}{4}(1\\pm\\xi)(1\\pm\\eta)$ have derivatives that are linear functions of one parent coordinate. For example, for node $1$, $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, so $\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$ and $\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$.\nIn general, $\\frac{\\partial N_i}{\\partial \\xi}$ is a linear polynomial in $\\eta$ only (degree $0$ in $\\xi$, degree $1$ in $\\eta$), and $\\frac{\\partial N_i}{\\partial \\eta}$ is a linear polynomial in $\\xi$ only (degree $1$ in $\\xi$, degree $0$ in $\\eta$).\nConsequently, the entries of the strain-displacement matrix $B(\\xi,\\eta)$ are composed of terms $\\frac{\\partial N_i}{\\partial x}$ and $\\frac{\\partial N_i}{\\partial y}$. The entries are therefore polynomials that are, at most, **linear in $\\xi$ (and constant in $\\eta$), or linear in $\\eta$ (and constant in $\\xi$)**.\n\n**3. Polynomial Degree of the Integrand**\n\nThe integrand of the stiffness matrix is the matrix product $K_{\\text{int}}(\\xi, \\eta) = B(\\xi, \\eta)^T C(\\xi, \\eta) B(\\xi, \\eta) \\det(J)$. We analyze the polynomial degree of each component:\n- $\\det(J)$: A constant, its polynomial degree is $0$ in both $\\xi$ and $\\eta$.\n- $B(\\xi, \\eta)$: Its entries are polynomials of degree at most $1$ in $\\xi$ or $\\eta$, as determined in Task 2.\n- $C(\\xi, \\eta)$: Its entries are proportional to $E(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) E_i$. Since $N_i$ are bilinear, $E(\\xi, \\eta)$ is a general bilinear polynomial of the form $a_0 + a_1\\xi + a_2\\eta + a_3\\xi\\eta$. The highest degree of its terms is $1$ in $\\xi$ and $1$ in $\\eta$ simultaneously.\n\nAn entry of the product $B^T C B$ is a sum of terms of the form (entry from $B^T$) $\\times$ (entry from $C$) $\\times$ (entry from $B$). The degree of a product of polynomials is the sum of their degrees.\nLet's analyze a typical term in an entry of $B^T C B$, for example, arising from the matrix product: $(g_i g_j) C_{kl}$.\nThe term $g_i \\propto \\frac{\\partial N_i}{\\partial y}$ is linear in $\\xi$, so its degree with respect to $(\\xi, \\eta)$ is $(1,0)$. The product $g_i g_j$ is thus a quadratic polynomial in $\\xi$, with degree $(2,0)$.\nThe term $C_{kl}$ is bilinear, with highest degree terms being $(1,1)$.\nThe product $(g_i g_j) C_{kl}$ will therefore have a degree of $(2,0) + (1,1) = (3,1)$. This means it contains terms up to $\\xi^3\\eta^1$. The highest degree in $\\xi$ is $3$.\nSymmetrically, a term of the form $(f_i f_j) C_{kl}$, where $f_i \\propto \\frac{\\partial N_i}{\\partial x}$ is linear in $\\eta$ (degree $(0,1)$), will have a degree of $(0,2) + (1,1) = (1,3)$. This means it contains terms up to $\\xi^1\\eta^3$. The highest degree in $\\eta$ is $3$.\nOther products, like $(f_i g_j) C_{kl}$, give degrees of $(1,1)+(1,1)=(2,2)$.\nConsidering all possible combinations, the highest polynomial degree that appears in any scalar component of the integrand $B^T C B \\det(J)$ is **$3$ in $\\xi$** and **$3$ in $\\eta$**.\n\n**4. Minimum Number of Quadrature Points**\n\nA one-dimensional Gauss-Legendre quadrature rule with $n$ points can integrate a polynomial of degree up to $2n-1$ exactly. For a tensor-product rule on the square domain, we must choose the number of points in each direction, $n$, to be sufficient for the highest polynomial degree in that direction.\nFrom Task 3, the maximum polynomial degree to be integrated in the $\\xi$-direction is $p_{\\xi} = 3$. The minimum number of points $n$ must satisfy:\n$$ 2n - 1 \\ge 3 \\implies 2n \\ge 4 \\implies n \\ge 2 $$\nThe minimum integer value for $n$ is $2$.\nSimilarly, for the $\\eta$-direction, the maximum polynomial degree is $p_{\\eta} = 3$, which also requires a minimum of $n=2$ points.\nTherefore, the minimum number of Gauss-Legendre quadrature points per direction is $n=2$.\nThe total number of quadrature points required for exact integration using a tensor-product grid is $N_{\\text{tot}} = n \\times n = n^2$.\nFor $n=2$, the minimum total number of quadrature points is:\n$$ N_{\\text{tot}} = 2^2 = 4 $$", "answer": "$$\\boxed{4}$$", "id": "2660878"}]}