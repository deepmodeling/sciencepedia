{"hands_on_practices": [{"introduction": "This first exercise introduces a cornerstone concept in continuum mechanics: treating magnetostriction as an eigenstrain, or a 'stress-free' strain. This powerful viewpoint allows us to decouple the intrinsic deformation of the material from its elastic response to mechanical constraints. By working through this problem [@problem_id:2899540], you will apply the generalized Hooke's law to a simple isotropic case, clarifying the fundamental tensorial relationship between longitudinal and transverse magnetostriction under the common assumption of volume conservation.", "problem": "An elastically isotropic cubic ferromagnetic polycrystal is magnetized uniformly to saturation along the unit vector $\\hat{\\mathbf{z}}$. The magnetically induced strain can be modeled as an eigenstrain tensor $\\epsilon^{m}_{ij}$ that is symmetric, axisymmetric about $\\hat{\\mathbf{z}}$, and has zero trace (no magnetically induced volume change) for this material. The specimen is a long rod whose lateral surface and ends are traction-free. Under these conditions, the total measured longitudinal magnetostriction along $\\hat{\\mathbf{z}}$ is $\\epsilon_{L}$, and the lateral (transverse) stress components satisfy $\\sigma_{xx}=\\sigma_{yy}=0$.\n\nUsing the generalized Hooke law for isotropic elasticity with an eigenstrain, and the stated invariances of the magnetically induced eigenstrain, determine the transverse strain $\\epsilon_{T}$ (the common value of $\\epsilon_{xx}$ and $\\epsilon_{yy}$) in terms of $\\epsilon_{L}$. Then verify whether the total volumetric strain is zero under these conditions.\n\nYour final answer must be a single closed-form analytic expression for $\\epsilon_{T}$ in terms of $\\epsilon_{L}$. No numerical approximation is required, and no units are needed in the final answer.", "solution": "The problem requires the determination of the transverse strain $\\epsilon_{T}$ in terms of the longitudinal magnetostriction $\\epsilon_{L}$ for an elastically isotropic material under specific conditions. To solve this, we will employ the principles of continuum mechanics, specifically the theory of linear elasticity incorporating an eigenstrain.\n\nThe fundamental constitutive relation connecting stress, strain, and eigenstrain is the generalized Hooke's law. For an isotropic material, the total strain tensor $\\epsilon_{ij}$ can be decomposed into an elastic part $\\epsilon^e_{ij}$ and a non-elastic eigenstrain part $\\epsilon^m_{ij}$:\n$$ \\epsilon_{ij} = \\epsilon^e_{ij} + \\epsilon^m_{ij} $$\nThe elastic strain, $\\epsilon^e_{ij}$, is induced by stress, $\\sigma_{ij}$, according to the relation:\n$$ \\epsilon^e_{ij} = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_{ij} - \\nu \\sigma_{kk} \\delta_{ij} \\right] $$\nwhere $E$ is the Young's modulus, $\\nu$ is the Poisson's ratio, $\\sigma_{kk} = \\sigma_{11} + \\sigma_{22} + \\sigma_{33}$ is the trace of the stress tensor, and $\\delta_{ij}$ is the Kronecker delta.\n\nThe problem specifies that the specimen is a long rod with traction-free lateral surfaces and ends. For a uniform eigenstrain, and in the absence of any externally applied forces, this condition implies that the body is in a state of zero stress. The problem statement explicitly confirms the lateral stress components are zero, $\\sigma_{xx}=\\sigma_{yy}=0$. The traction-free end condition implies the axial stress component is also zero, $\\sigma_{zz}=0$. Therefore, the stress tensor is identically zero throughout the material:\n$$ \\sigma_{ij} = 0 $$\nConsequently, the trace of the stress tensor is also zero, $\\sigma_{kk} = 0$. Substituting this zero-stress condition into the equation for the elastic strain gives:\n$$ \\epsilon^e_{ij} = \\frac{1}{E} \\left[ (1+\\nu)(0) - \\nu (0) \\delta_{ij} \\right] = 0 $$\nThe elastic strain is zero. This leads to the crucial conclusion that the total measured strain is equal to the magnetically induced eigenstrain:\n$$ \\epsilon_{ij} = \\epsilon^m_{ij} $$\n\nNext, we analyze the properties of the eigenstrain tensor $\\epsilon^m_{ij}$ as provided in the problem statement. Magnetization is uniform along the $\\hat{\\mathbf{z}}$ axis.\n$1$. The tensor is symmetric: $\\epsilon^m_{ij} = \\epsilon^m_{ji}$.\n$2$. The tensor is axisymmetric about the $\\hat{\\mathbf{z}}$ axis. This physical symmetry dictates the mathematical form of the tensor. In the $(x,y,z)$ coordinate system, the diagonal components must satisfy $\\epsilon^m_{xx} = \\epsilon^m_{yy}$, and the off-diagonal components $\\epsilon^m_{xz}$, $\\epsilon^m_{yz}$, and $\\epsilon^m_{xy}$ must be zero. Let us denote the transverse component as $\\epsilon^m_T = \\epsilon^m_{xx} = \\epsilon^m_{yy}$ and the longitudinal component as $\\epsilon^m_L = \\epsilon^m_{zz}$.\n$3$. The tensor has zero trace, which corresponds to no magnetically induced volume change:\n$$ \\text{tr}(\\epsilon^m) = \\epsilon^m_{xx} + \\epsilon^m_{yy} + \\epsilon^m_{zz} = 0 $$\nSubstituting our notation for the components into the zero-trace condition yields a direct relationship between the longitudinal and transverse eigenstrains:\n$$ 2\\epsilon^m_T + \\epsilon^m_L = 0 \\quad \\implies \\quad \\epsilon^m_L = -2\\epsilon^m_T $$\n\nThe problem defines the total measured strain components as the longitudinal magnetostriction $\\epsilon_{L}$ and the transverse strain $\\epsilon_{T}$:\n$$ \\epsilon_{zz} = \\epsilon_{L} $$\n$$ \\epsilon_{xx} = \\epsilon_{yy} = \\epsilon_{T} $$\nSince we have shown that the total strain equals the eigenstrain ($\\epsilon_{ij} = \\epsilon^m_{ij}$), we can equate their corresponding components:\n$$ \\epsilon_{L} = \\epsilon^m_{zz} = \\epsilon^m_L $$\n$$ \\epsilon_{T} = \\epsilon^m_{xx} = \\epsilon^m_{yy} = \\epsilon^m_T $$\nBy substituting these identities into the relationship $\\epsilon^m_L = -2\\epsilon^m_T$, we connect the total measured strains:\n$$ \\epsilon_{L} = -2\\epsilon_{T} $$\nSolving this equation for the transverse strain $\\epsilon_{T}$ provides the desired result:\n$$ \\epsilon_{T} = -\\frac{1}{2}\\epsilon_{L} $$\n\nAs a final verification, the problem asks whether the total volumetric strain is zero. The total volumetric strain, $\\epsilon_V$, is the trace of the total strain tensor, $\\epsilon_{kk}$.\n$$ \\epsilon_V = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz} = \\epsilon_{T} + \\epsilon_{T} + \\epsilon_{L} = 2\\epsilon_{T} + \\epsilon_{L} $$\nSubstituting the derived expression for $\\epsilon_{T}$:\n$$ \\epsilon_V = 2\\left(-\\frac{1}{2}\\epsilon_{L}\\right) + \\epsilon_{L} = -\\epsilon_{L} + \\epsilon_{L} = 0 $$\nThe total volumetric strain is indeed zero, which is consistent with the fact that the total strain is equal to the volume-conserving eigenstrain.", "answer": "$$\n\\boxed{-\\frac{1}{2}\\epsilon_{L}}\n$$", "id": "2899540"}, {"introduction": "While the isotropic model is instructive, most magnetostrictive materials exhibit strong anisotropy. This practice [@problem_id:2899529] delves into this complexity by using a fundamental energy minimization principle to derive the classic expression for magnetostriction in cubic crystals. Completing this exercise will provide insight into how crystal symmetry and magnetoelastic energy terms dictate the direction-dependent deformation, connecting microscopic physics to the macroscopic engineering constants $\\lambda_{100}$ and $\\lambda_{111}$.", "problem": "A single-domain cubic ferromagnetic crystal is subjected to a saturating magnetic field that aligns the magnetization along a prescribed crystallographic direction. Consider the lowest-order magnetoelastic coupling consistent with cubic symmetry and small strains, and assume linear elasticity for a cubic crystal. Let $\\alpha_{i}$ denote the direction cosines of the magnetization relative to the cubic axes, and let $\\varepsilon_{ij}$ denote the small strain tensor. The magnetoelastic energy density is bilinear in $\\varepsilon_{ij}$ and quadratic in $\\alpha_{i}$, and the elastic energy density is quadratic in $\\varepsilon_{ij}$. In the absence of externally applied stress, the equilibrium strain minimizes the total energy. The longitudinal magnetostriction is defined as the fractional change in length measured along a direction with direction cosines $\\beta_{i}$, given by $\\varepsilon_{\\ell}=\\beta_{i}\\beta_{j}\\varepsilon_{ij}$. Under saturation, take the longitudinal magnetostriction to be measured along the magnetization direction, that is, $\\beta_{i}=\\alpha_{i}$.\n\nUsing only these fundamental starting points and symmetry, derive the general form of the longitudinal saturation magnetostriction along the magnetization direction for a cubic crystal and determine the longitudinal strain values for saturation along the crystallographic directions $[100]$, $[110]$, and $[111]$. Express the final results solely in terms of the conventional saturation magnetostriction constants $\\lambda_{100}$ and $\\lambda_{111}$, defined, respectively, as the longitudinal saturation strains measured along $[100]$ and $[111]$ when magnetization is along the same directions. Present your final three answers in a single row vector in the order $[100]$, $[110]$, $[111]$. No numerical approximation is required, and no units should be included in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It represents a standard derivation in the theory of magnetoelasticity. We may therefore proceed with the solution.\n\nThe total free energy density $U_T$ of the crystal, in the absence of an external magnetic field but under the influence of an internal saturating field, is the sum of the elastic energy density $U_{el}$ and the magnetoelastic energy density $U_{me}$.\n$$\nU_T = U_{el} + U_{me}\n$$\nFor a cubic crystal, under the assumption of linear elasticity (small strains $\\varepsilon_{ij}$), the elastic energy density is given by:\n$$\nU_{el} = \\frac{1}{2} c_{11}(\\varepsilon_{11}^2 + \\varepsilon_{22}^2 + \\varepsilon_{33}^2) + c_{12}(\\varepsilon_{11}\\varepsilon_{22} + \\varepsilon_{22}\\varepsilon_{33} + \\varepsilon_{33}\\varepsilon_{11}) + 2 c_{44}(\\varepsilon_{12}^2 + \\varepsilon_{23}^2 + \\varepsilon_{31}^2)\n$$\nwhere $c_{11}$, $c_{12}$, and $c_{44}$ are the three independent elastic stiffness constants for a cubic crystal. The magnetoelastic energy density, to the lowest order consistent with cubic symmetry, bilinear in strain $\\varepsilon_{ij}$ and quadratic in the direction cosines $\\alpha_i$ of the magnetization, is:\n$$\nU_{me} = B_1(\\varepsilon_{11}\\alpha_1^2 + \\varepsilon_{22}\\alpha_2^2 + \\varepsilon_{33}\\alpha_3^2) + 2B_2(\\varepsilon_{12}\\alpha_1\\alpha_2 + \\varepsilon_{23}\\alpha_2\\alpha_3 + \\varepsilon_{31}\\alpha_3\\alpha_1)\n$$\nwhere $B_1$ and $B_2$ are the magnetoelastic coupling constants.\n\nIn the absence of externally applied stress, the crystal deforms to a state of equilibrium where the total energy density $U_T$ is minimized with respect to the strain components $\\varepsilon_{ij}$. This condition is expressed as:\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{ij}} = 0 \\quad \\text{for all } i, j\n$$\nWe compute these derivatives for the diagonal and off-diagonal components of the strain tensor.\n\nFor the diagonal components ($i=j$):\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{11}} = c_{11}\\varepsilon_{11} + c_{12}(\\varepsilon_{22} + \\varepsilon_{33}) + B_1\\alpha_1^2 = 0\n$$\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{22}} = c_{11}\\varepsilon_{22} + c_{12}(\\varepsilon_{11} + \\varepsilon_{33}) + B_1\\alpha_2^2 = 0\n$$\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{33}} = c_{11}\\varepsilon_{33} + c_{12}(\\varepsilon_{11} + \\varepsilon_{22}) + B_1\\alpha_3^2 = 0\n$$\nThis is a system of linear equations for the normal strains $\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}$. It can be solved by inverting the matrix of elastic constants. The solution for $\\varepsilon_{11}$ (and others by cyclic permutation of indices) is:\n$$\n\\varepsilon_{11} = -\\frac{B_1}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\left[ (c_{11}+c_{12})\\alpha_1^2 - c_{12}(\\alpha_2^2 + \\alpha_3^2) \\right]\n$$\nUsing the normalization condition $\\alpha_1^2 + \\alpha_2^2 + \\alpha_3^2 = 1$, we can simplify this to:\n$$\n\\varepsilon_{11} = -\\frac{B_1}{c_{11}-c_{12}} \\alpha_1^2 + \\frac{B_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})}\n$$\nBy symmetry, we have analogous expressions for $\\varepsilon_{22}$ and $\\varepsilon_{33}$:\n$$\n\\varepsilon_{22} = -\\frac{B_1}{c_{11}-c_{12}} \\alpha_2^2 + \\frac{B_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})}\n$$\n$$\n\\varepsilon_{33} = -\\frac{B_1}{c_{11}-c_{12}} \\alpha_3^2 + \\frac{B_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})}\n$$\n\nFor the off-diagonal components ($i \\neq j$):\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{12}} = 4c_{44}\\varepsilon_{12} + 2B_2\\alpha_1\\alpha_2 = 0 \\implies \\varepsilon_{12} = -\\frac{B_2}{2c_{44}}\\alpha_1\\alpha_2\n$$\nAnd similarly for the other shear strains:\n$$\n\\varepsilon_{23} = -\\frac{B_2}{2c_{44}}\\alpha_2\\alpha_3\n$$\n$$\n\\varepsilon_{31} = -\\frac{B_2}{2c_{44}}\\alpha_3\\alpha_1\n$$\n\nThe longitudinal magnetostriction, $\\varepsilon_{\\ell}$, is the fractional change in length measured along the direction of magnetization. According to the problem definition, this means we set the direction cosines of measurement $\\beta_i$ equal to the direction cosines of magnetization $\\alpha_i$.\n$$\n\\varepsilon_{\\ell} = \\sum_{i,j=1}^3 \\beta_i \\beta_j \\varepsilon_{ij} = \\sum_{i,j=1}^3 \\alpha_i \\alpha_j \\varepsilon_{ij} = \\sum_{i=1}^3 \\alpha_i^2\\varepsilon_{ii} + 2\\sum_{i<j} \\alpha_i\\alpha_j\\varepsilon_{ij}\n$$\nSubstituting the derived equilibrium strain components:\n$$\n\\varepsilon_{\\ell} = \\sum_{i=1}^3 \\alpha_i^2 \\left( -\\frac{B_1}{c_{11}-c_{12}} \\alpha_i^2 + \\frac{B_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\right) + 2 \\left( \\alpha_1\\alpha_2(-\\frac{B_2}{2c_{44}}\\alpha_1\\alpha_2) + \\dots \\right)\n$$\n$$\n\\varepsilon_{\\ell} = -\\frac{B_1}{c_{11}-c_{12}} \\sum_i \\alpha_i^4 + \\frac{B_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\sum_i \\alpha_i^2 - \\frac{B_2}{c_{44}} \\sum_{i<j} \\alpha_i^2\\alpha_j^2\n$$\nUsing $\\sum_i \\alpha_i^2 = 1$ and the identity $\\sum_i \\alpha_i^4 = (\\sum_i \\alpha_i^2)^2 - 2\\sum_{i<j} \\alpha_i^2\\alpha_j^2 = 1 - 2(\\alpha_1^2\\alpha_2^2 + \\alpha_2^2\\alpha_3^2 + \\alpha_3^2\\alpha_1^2)$:\n$$\n\\varepsilon_{\\ell} = -\\frac{B_1}{c_{11}-c_{12}} (1 - 2\\Phi) + \\frac{B_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} - \\frac{B_2}{c_{44}}\\Phi\n$$\nwhere $\\Phi = \\alpha_1^2\\alpha_2^2 + \\alpha_2^2\\alpha_3^2 + \\alpha_3^2\\alpha_1^2$.\nRearranging the terms, we collect the constant and $\\Phi$-dependent parts:\n$$\n\\varepsilon_{\\ell} = \\left( -\\frac{B_1}{c_{11}-c_{12}} + \\frac{B_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\right) + \\left( \\frac{2B_1}{c_{11}-c_{12}} - \\frac{B_2}{c_{44}} \\right) \\Phi\n$$\nThis expression is of the form $\\varepsilon_{\\ell} = C_0 + C_1 \\Phi$. We now express the constants $C_0$ and $C_1$ in terms of the conventional saturation magnetostriction constants $\\lambda_{100}$ and $\\lambda_{111}$.\n\nBy definition, $\\lambda_{100}$ is the longitudinal saturation strain along the $[100]$ direction, where $(\\alpha_1, \\alpha_2, \\alpha_3) = (1, 0, 0)$. In this case, $\\Phi = 1^2 \\cdot 0^2 + 0^2 \\cdot 0^2 + 0^2 \\cdot 1^2 = 0$.\n$$\n\\lambda_{100} = \\varepsilon_{\\ell}([100]) = C_0 + C_1(0) = C_0\n$$\nBy definition, $\\lambda_{111}$ is the longitudinal saturation strain along the $[111]$ direction, where $(\\alpha_1, \\alpha_2, \\alpha_3) = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$. In this case, $\\alpha_1^2 = \\alpha_2^2 = \\alpha_3^2 = 1/3$, and $\\Phi = (1/3)(1/3) + (1/3)(1/3) + (1/3)(1/3) = 3/9 = 1/3$.\n$$\n\\lambda_{111} = \\varepsilon_{\\ell}([111]) = C_0 + C_1(1/3) = \\lambda_{100} + C_1/3\n$$\nFrom this, we solve for $C_1$: $C_1 = 3(\\lambda_{111} - \\lambda_{100})$.\nSubstituting these into the general expression for $\\varepsilon_{\\ell}$:\n$$\n\\varepsilon_{\\ell} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})(\\alpha_1^2\\alpha_2^2 + \\alpha_2^2\\alpha_3^2 + \\alpha_3^2\\alpha_1^2)\n$$\nThis is the general form of the longitudinal saturation magnetostriction for a cubic crystal. We now evaluate it for the three specified directions.\n\n1.  Magnetization along $[100]$:\n    $(\\alpha_1, \\alpha_2, \\alpha_3) = (1, 0, 0)$. As calculated before, $\\Phi = 0$.\n    $$\n    \\varepsilon_{\\ell,[100]} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})(0) = \\lambda_{100}\n    $$\n\n2.  Magnetization along $[110]$:\n    The normalized direction cosines are $(\\alpha_1, \\alpha_2, \\alpha_3) = (1/\\sqrt{2}, 1/\\sqrt{2}, 0)$.\n    Thus, $\\alpha_1^2=1/2$, $\\alpha_2^2=1/2$, $\\alpha_3^2=0$.\n    $\\Phi = (1/2)(1/2) + (1/2)(0) + (0)(1/2) = 1/4$.\n    $$\n    \\varepsilon_{\\ell,[110]} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})\\left(\\frac{1}{4}\\right) = \\lambda_{100} + \\frac{3}{4}\\lambda_{111} - \\frac{3}{4}\\lambda_{100} = \\frac{1}{4}\\lambda_{100} + \\frac{3}{4}\\lambda_{111}\n    $$\n\n3.  Magnetization along $[111]$:\n    $(\\alpha_1, \\alpha_2, \\alpha_3) = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$. As calculated before, $\\Phi = 1/3$.\n    $$\n    \\varepsilon_{\\ell,[111]} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})\\left(\\frac{1}{3}\\right) = \\lambda_{100} + \\lambda_{111} - \\lambda_{100} = \\lambda_{111}\n    $$\n\nThe three requested values are thus $\\lambda_{100}$, $\\frac{1}{4}\\lambda_{100} + \\frac{3}{4}\\lambda_{111}$, and $\\lambda_{111}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\lambda_{100} & \\frac{1}{4}\\lambda_{100} + \\frac{3}{4}\\lambda_{111} & \\lambda_{111} \\end{pmatrix}}\n$$", "id": "2899529"}, {"introduction": "Analytical solutions are often limited to simple geometries, and modern engineering relies heavily on computational methods. This final exercise bridges the gap between theory and practice by guiding you through the formulation of the core components for a Finite Element Method (FEM) simulation of a coupled magneto-mechanical problem [@problem_id:2899518]. By implementing the consistent tangent operators, you will gain hands-on experience with the numerical building blocks used to analyze and design complex magnetoelastic devices and systems.", "problem": "You are asked to derive, discretize, and implement the consistent linearization (tangent operators) of the coupled magneto-mechanical weak forms for a two-dimensional small-strain, magnetostatic, linear magnetoelastic problem, suitable for a Newton–Raphson solution in the finite element method. The coupled fields are the displacement vector field $\\mathbf{u} = [u_x,u_y]^T$ and the scalar magnetic potential $\\phi$, with the magnetic field $\\mathbf{h} = \\nabla \\phi$. Work in plane strain and assume linear constitutive behavior with a symmetric positive-definite elastic stiffness tensor and magnetic permeability tensor, and a constant linear magnetoelastic coupling tensor. All derivations must be from first principles using a potential energy density.\n\nBase your derivation on the following well-tested facts and fundamental relations:\n- Small-strain kinematics: the infinitesimal strain tensor is $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^T)$, and its Voigt representation is $\\boldsymbol{\\varepsilon}_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$, where $\\gamma_{xy} = 2\\varepsilon_{xy}$.\n- Magnetostatics without free currents: $\\nabla \\times \\mathbf{h} = \\mathbf{0}$ so that $\\mathbf{h} = \\nabla \\phi$, and the magnetic flux density is $\\mathbf{b} = \\boldsymbol{\\mu}\\,\\mathbf{h} - \\mathbf{P}^T \\boldsymbol{\\varepsilon}_v$ when derived from an energy potential defined below.\n- Use the free energy density\n$$\n\\psi(\\boldsymbol{\\varepsilon}_v,\\mathbf{h}) = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_v^T \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v + \\tfrac{1}{2}\\,\\mathbf{h}^T \\boldsymbol{\\mu}\\,\\mathbf{h} - \\boldsymbol{\\varepsilon}_v^T \\mathbf{P}\\,\\mathbf{h},\n$$\nwhere $\\mathbf{C}\\in\\mathbb{R}^{3\\times 3}$ is the plane-strain elastic stiffness, $\\boldsymbol{\\mu}\\in\\mathbb{R}^{2\\times 2}$ is the magnetic permeability tensor, and $\\mathbf{P}\\in\\mathbb{R}^{3\\times 2}$ is the linear magnetoelastic coupling matrix mapping the magnetic field to Voigt stress space. All tensors are constant over the element domain.\n\nFrom $\\psi$, define the constitutive relations\n$$\n\\boldsymbol{\\sigma}_v = \\frac{\\partial \\psi}{\\partial \\boldsymbol{\\varepsilon}_v} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v - \\mathbf{P}\\,\\mathbf{h}, \\qquad\n\\mathbf{b} = \\frac{\\partial \\psi}{\\partial \\mathbf{h}} = \\boldsymbol{\\mu}\\,\\mathbf{h} - \\mathbf{P}^T \\boldsymbol{\\varepsilon}_v.\n$$\nThe coupled weak forms (internal virtual work) are\n$$\n\\int_{\\Omega} \\delta \\boldsymbol{\\varepsilon}_v^T \\boldsymbol{\\sigma}_v \\, \\mathrm{d}\\Omega = 0,\n\\qquad\n\\int_{\\Omega} (\\nabla \\delta \\phi)^T \\mathbf{b}\\, \\mathrm{d}\\Omega = 0,\n$$\nwith $\\mathbf{h}=\\nabla \\phi$. Discretize the domain using a single constant-strain triangle (CST) element of thickness $t$ with linear shape functions for both displacement and scalar potential. Let the element geometry be specified by nodal coordinates $(x_i,y_i)$ for nodes $i=1,2,3$. Use Voigt notation for strains and stresses and collect the displacement degrees of freedom in the vector $\\mathbf{u}_e\\in\\mathbb{R}^{6}$ and the nodal scalar potentials in $\\boldsymbol{\\phi}_e\\in\\mathbb{R}^{3}$.\n\nTasks:\n1. Starting from the free energy density $\\psi$, derive the coupled weak forms and obtain the consistent linearization suitable for a Newton–Raphson method, explicitly identifying the tangent submatrices\n$$\n\\mathbf{K}_{uu} = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{C}\\, \\mathbf{B}\\,\\mathrm{d}\\Omega,\\quad\n\\mathbf{K}_{u\\phi} = -\\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{P}\\,\\mathbf{G}\\,\\mathrm{d}\\Omega,\\quad\n\\mathbf{K}_{\\phi u} = -\\int_{\\Omega_e} \\mathbf{G}^T \\mathbf{P}^T \\mathbf{B}\\,\\mathrm{d}\\Omega,\\quad\n\\mathbf{K}_{\\phi\\phi} = \\int_{\\Omega_e} \\mathbf{G}^T \\boldsymbol{\\mu}\\, \\mathbf{G}\\,\\mathrm{d}\\Omega,\n$$\nwhere $\\mathbf{B}\\in\\mathbb{R}^{3\\times 6}$ is the constant strain–displacement matrix for the CST in plane strain and $\\mathbf{G}\\in\\mathbb{R}^{2\\times 3}$ collects the constant gradients of the scalar potential shape functions.\n2. For plane strain, express the elastic stiffness matrix $\\mathbf{C}$ in terms of Young’s modulus $E$ and Poisson’s ratio $\\nu$ using Lamé parameters $\\lambda$ and $G$ with $\\lambda = \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}$ and $G = \\dfrac{E}{2(1+\\nu)}$, so that\n$$\n\\mathbf{C} = \\begin{bmatrix}\n\\lambda + 2G & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2G & 0 \\\\\n0 & 0 & G\n\\end{bmatrix}.\n$$\n3. For a single CST element, the matrices $\\mathbf{B}$ and $\\mathbf{G}$ are constant over the element. Use the standard CST formulas: with node coordinates $(x_i,y_i)$, area $A$ satisfies $2A = x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)$, and\n$$\nb_1 = y_2 - y_3,\\quad b_2 = y_3 - y_1,\\quad b_3 = y_1 - y_2, \\\\\nc_1 = x_3 - x_2,\\quad c_2 = x_1 - x_3,\\quad c_3 = x_2 - x_1,\n$$\nwith $\\partial N_i/\\partial x = b_i/(2A)$ and $\\partial N_i/\\partial y = c_i/(2A)$. Then\n$$\n\\mathbf{B} = \\frac{1}{2A}\n\\begin{bmatrix}\nb_1 & 0 & b_2 & 0 & b_3 & 0 \\\\\n0 & c_1 & 0 & c_2 & 0 & c_3 \\\\\nc_1 & b_1 & c_2 & b_2 & c_3 & b_3\n\\end{bmatrix},\\qquad\n\\mathbf{G} = \\frac{1}{2A}\n\\begin{bmatrix}\nb_1 & b_2 & b_3 \\\\\nc_1 & c_2 & c_3\n\\end{bmatrix}.\n$$\n4. Implement the element tangents using one-point integration for the CST (i.e., exact for constant matrices), so that each integral simplifies to a multiplication by the element “volume” $tA$:\n$$\n\\mathbf{K}_{uu} = tA\\, \\mathbf{B}^T \\mathbf{C}\\, \\mathbf{B},\\quad\n\\mathbf{K}_{u\\phi} = -tA\\, \\mathbf{B}^T \\mathbf{P}\\,\\mathbf{G},\\quad\n\\mathbf{K}_{\\phi u} = -tA\\, \\mathbf{G}^T \\mathbf{P}^T \\mathbf{B},\\quad\n\\mathbf{K}_{\\phi\\phi} = tA\\, \\mathbf{G}^T \\boldsymbol{\\mu}\\, \\mathbf{G}.\n$$\n\nNumerical implementation requirements:\n- Use the following test suite of $4$ element parameter sets. For each case, the input consists of node coordinates in meters, Young’s modulus $E$ in Pascals, Poisson’s ratio $\\nu$ (dimensionless), thickness $t$ in meters, magnetic permeability tensor $\\boldsymbol{\\mu}$ in Henries per meter, and coupling matrix $\\mathbf{P}$ in Pascals times meter per Ampere (so that $\\boldsymbol{\\sigma}_v = \\mathbf{C}\\boldsymbol{\\varepsilon}_v - \\mathbf{P}\\mathbf{h}$ has units of Pascal when $\\mathbf{h}$ is in Ampere per meter). All matrices are given in row-major order.\n- Test case 1:\n  - Nodes: $(x_1,y_1)=(0.0,0.0)$, $(x_2,y_2)=(1.0,0.0)$, $(x_3,y_3)=(0.0,1.0)$ in meters.\n  - $E = 2.10\\times 10^{11}$ Pa, $\\nu = 0.30$, $t = 1.0\\times 10^{-2}$ m.\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 6.0\\times 10^{-6} & 1.0\\times 10^{-6} \\\\ 1.0\\times 10^{-6} & 4.0\\times 10^{-6} \\end{bmatrix}$ H/m.\n  - $\\mathbf{P} = \\begin{bmatrix} 1.2\\times 10^{5} & -0.8\\times 10^{5} \\\\ 0.6\\times 10^{5} & 1.1\\times 10^{5} \\\\ 0.2\\times 10^{5} & -0.4\\times 10^{5} \\end{bmatrix}$ Pa·m/A.\n- Test case 2:\n  - Nodes: $(x_1,y_1)=(0.0,0.0)$, $(x_2,y_2)=(1.0,0.0)$, $(x_3,y_3)=(0.0,1.0)$ in meters.\n  - $E = 7.0\\times 10^{10}$ Pa, $\\nu = 0.33$, $t = 2.0\\times 10^{-2}$ m.\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 5.0\\times 10^{-6} & 0.0 \\\\ 0.0 & 5.0\\times 10^{-6} \\end{bmatrix}$ H/m.\n  - $\\mathbf{P} = \\mathbf{0}_{3\\times 2}$ (exactly zero coupling).\n- Test case 3:\n  - Nodes: $(x_1,y_1)=(0.0,0.0)$, $(x_2,y_2)=(0.8,0.0)$, $(x_3,y_3)=(0.0,0.6)$ in meters.\n  - $E = 3.5\\times 10^{9}$ Pa, $\\nu = 0.499$, $t = 5.0\\times 10^{-3}$ m.\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 2.0\\times 10^{-6} & 0.0 \\\\ 0.0 & 7.0\\times 10^{-6} \\end{bmatrix}$ H/m.\n  - $\\mathbf{P} = \\begin{bmatrix} 5.0\\times 10^{4} & 3.0\\times 10^{4} \\\\ 1.0\\times 10^{4} & 2.0\\times 10^{4} \\\\ -2.0\\times 10^{4} & 1.0\\times 10^{4} \\end{bmatrix}$ Pa·m/A.\n- Test case 4:\n  - Nodes: $(x_1,y_1)=(0.0,0.0)$, $(x_2,y_2)=(2.0,0.0)$, $(x_3,y_3)=(0.0,0.2)$ in meters.\n  - $E = 1.10\\times 10^{11}$ Pa, $\\nu = 0.25$, $t = 1.5\\times 10^{-2}$ m.\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 3.0\\times 10^{-6} & -0.5\\times 10^{-6} \\\\ -0.5\\times 10^{-6} & 3.5\\times 10^{-6} \\end{bmatrix}$ H/m.\n  - $\\mathbf{P} = \\begin{bmatrix} -9.0\\times 10^{4} & 4.0\\times 10^{4} \\\\ 2.0\\times 10^{4} & -7.0\\times 10^{4} \\\\ 3.0\\times 10^{4} & 3.0\\times 10^{4} \\end{bmatrix}$ Pa·m/A.\n\nComputation and output:\n- For each test case, compute the element tangent submatrices $\\mathbf{K}_{uu}\\in\\mathbb{R}^{6\\times 6}$, $\\mathbf{K}_{\\phi\\phi}\\in\\mathbb{R}^{3\\times 3}$, and $\\mathbf{K}_{u\\phi}\\in\\mathbb{R}^{6\\times 3}$ using the formulas above.\n- For each test case, report the following three scalar quantities:\n  1. The Frobenius norm of $\\mathbf{K}_{uu}$, in Newton per meter (N/m), rounded to six decimal places.\n  2. The Frobenius norm of $\\mathbf{K}_{\\phi\\phi}$, in Henry (H), rounded to six decimal places.\n  3. The Frobenius norm of $\\mathbf{K}_{u\\phi}$, in Newton per Ampere (N/A), rounded to six decimal places.\n- Final output format: Your program should produce a single line of output containing the results for all test cases concatenated in order, as a comma-separated list enclosed in square brackets. For example, the output should have the form\n  $$\n  [r_{1,1}, r_{1,2}, r_{1,3}, r_{2,1}, r_{2,2}, r_{2,3}, r_{3,1}, r_{3,2}, r_{3,3}, r_{4,1}, r_{4,2}, r_{4,3}],\n  $$\n  where $r_{k,1}$, $r_{k,2}$, $r_{k,3}$ are the three requested norms for test case $k=1,2,3,4$, each rounded to six decimal places and expressed in the specified units.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed, scientifically grounded problem in computational magneto-mechanics, providing all necessary definitions, constants, and data for a unique solution. We shall proceed with the derivation and implementation.\n\nThe objective is to derive the consistent tangent stiffness matrix for a coupled linear magnetoelastic problem and implement its calculation for a Constant Strain Triangle (CST) element. The derivation begins from the provided free energy density per unit volume, $\\psi$.\n\nThe free energy density is given as:\n$$\n\\psi(\\boldsymbol{\\varepsilon}_v,\\mathbf{h}) = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_v^T \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v + \\tfrac{1}{2}\\,\\mathbf{h}^T \\boldsymbol{\\mu}\\,\\mathbf{h} - \\boldsymbol{\\varepsilon}_v^T \\mathbf{P}\\,\\mathbf{h}\n$$\nwhere $\\boldsymbol{\\varepsilon}_v$ is the strain vector in Voigt notation, $\\mathbf{h}$ is the magnetic field, $\\mathbf{C}$ is the elastic stiffness matrix, $\\boldsymbol{\\mu}$ is the magnetic permeability tensor, and $\\mathbf{P}$ is the magnetoelastic coupling matrix. The problem states that $\\mathbf{C}$ and $\\boldsymbol{\\mu}$ are symmetric and positive-definite.\n\nThe constitutive relations for the Voigt stress vector $\\boldsymbol{\\sigma}_v$ and magnetic flux density vector $\\mathbf{b}$ are derived from $\\psi$:\n$$\n\\boldsymbol{\\sigma}_v = \\frac{\\partial \\psi}{\\partial \\boldsymbol{\\varepsilon}_v} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v - \\mathbf{P}\\,\\mathbf{h}\n$$\n$$\n\\mathbf{b} = \\frac{\\partial \\psi}{\\partial \\mathbf{h}} = \\boldsymbol{\\mu}\\,\\mathbf{h} - \\mathbf{P}^T \\boldsymbol{\\varepsilon}_v\n$$\nThese relationships are linear in the field variables $\\boldsymbol{\\varepsilon}_v$ and $\\mathbf{h}$.\n\nThe governing equations are expressed in weak form, representing the principle of virtual work for the coupled system. For arbitrary admissible variations of the displacement, $\\delta\\mathbf{u}$, and the magnetic potential, $\\delta\\phi$, we have:\n$$\n\\int_{\\Omega} \\delta \\boldsymbol{\\varepsilon}_v^T \\boldsymbol{\\sigma}_v \\, \\mathrm{d}\\Omega = 0 \\quad \\text{(Mechanical equilibrium)}\n$$\n$$\n\\int_{\\Omega} (\\nabla \\delta \\phi)^T \\mathbf{b}\\, \\mathrm{d}\\Omega = 0 \\quad \\text{(Gauss's law for magnetism)}\n$$\nwhere $\\delta\\boldsymbol{\\varepsilon}_v$ is the virtual strain corresponding to $\\delta\\mathbf{u}$, and $\\nabla\\delta\\phi$ is the virtual magnetic field.\n\nWe discretize the fields using the finite element method. For a single element, the displacement field $\\mathbf{u}$ and the scalar potential field $\\phi$ are interpolated from their nodal values, $\\mathbf{u}_e \\in \\mathbb{R}^6$ and $\\boldsymbol{\\phi}_e \\in \\mathbb{R}^3$, respectively:\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{N}_u(\\mathbf{x}) \\mathbf{u}_e\n$$\n$$\n\\phi(\\mathbf{x}) = \\mathbf{N}_\\phi(\\mathbf{x}) \\boldsymbol{\\phi}_e\n$$\nHere, $\\mathbf{N}_u$ and $\\mathbf{N}_\\phi$ are matrices of shape functions. For a CST element with linear shape functions, the strain-displacement relationship and the gradient of the potential become:\n$$\n\\boldsymbol{\\varepsilon}_v(\\mathbf{x}) = \\mathbf{B} \\mathbf{u}_e\n$$\n$$\n\\mathbf{h}(\\mathbf{x}) = \\nabla\\phi = \\mathbf{G} \\boldsymbol{\\phi}_e\n$$\nThe matrices $\\mathbf{B} \\in \\mathbb{R}^{3\\times 6}$ and $\\mathbf{G} \\in \\mathbb{R}^{2\\times 3}$ are constant within the element. The variations are similarly discretized: $\\delta\\boldsymbol{\\varepsilon}_v = \\mathbf{B}\\delta\\mathbf{u}_e$ and $\\nabla\\delta\\phi = \\mathbf{G}\\delta\\boldsymbol{\\phi}_e$.\n\nSubstituting the constitutive and kinematic relations into the weak forms, we obtain the element residual vectors, $\\mathbf{R}_u$ and $\\mathbf{R}_\\phi$:\n$$\n\\mathbf{R}_u(\\mathbf{u}_e, \\boldsymbol{\\phi}_e) = \\int_{\\Omega_e} \\mathbf{B}^T \\boldsymbol{\\sigma}_v \\, \\mathrm{d}\\Omega = \\int_{\\Omega_e} \\mathbf{B}^T (\\mathbf{C} \\mathbf{B} \\mathbf{u}_e - \\mathbf{P} \\mathbf{G} \\boldsymbol{\\phi}_e) \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{R}_\\phi(\\mathbf{u}_e, \\boldsymbol{\\phi}_e) = \\int_{\\Omega_e} \\mathbf{G}^T \\mathbf{b} \\, \\mathrm{d}\\Omega = \\int_{\\Omega_e} \\mathbf{G}^T (\\boldsymbol{\\mu} \\mathbf{G} \\boldsymbol{\\phi}_e - \\mathbf{P}^T \\mathbf{B} \\mathbf{u}_e) \\, \\mathrm{d}\\Omega\n$$\n\nFor a Newton-Raphson iterative solution scheme, the tangent stiffness matrix $\\mathbf{K}$ is required. It is the derivative of the residual vector $\\mathbf{R} = [\\mathbf{R}_u^T, \\mathbf{R}_\\phi^T]^T$ with respect to the vector of nodal unknowns $\\mathbf{d} = [\\mathbf{u}_e^T, \\boldsymbol{\\phi}_e^T]^T$. The tangent matrix is a $9 \\times 9$ block matrix:\n$$\n\\mathbf{K} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{d}} = \\begin{bmatrix} \\frac{\\partial \\mathbf{R}_u}{\\partial \\mathbf{u}_e} & \\frac{\\partial \\mathbf{R}_u}{\\partial \\boldsymbol{\\phi}_e} \\\\ \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\mathbf{u}_e} & \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\boldsymbol{\\phi}_e} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{K}_{uu} & \\mathbf{K}_{u\\phi} \\\\ \\mathbf{K}_{\\phi u} & \\mathbf{K}_{\\phi\\phi} \\end{bmatrix}\n$$\nSince the constitutive relations are linear, the derivatives are constant. Performing the differentiations yields the submatrices:\n$$\n\\mathbf{K}_{uu} = \\frac{\\partial \\mathbf{R}_u}{\\partial \\mathbf{u}_e} = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{K}_{u\\phi} = \\frac{\\partial \\mathbf{R}_u}{\\partial \\boldsymbol{\\phi}_e} = \\int_{\\Omega_e} \\mathbf{B}^T (-\\mathbf{P} \\mathbf{G}) \\, \\mathrm{d}\\Omega = -\\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{P} \\mathbf{G} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{K}_{\\phi u} = \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\mathbf{u}_e} = \\int_{\\Omega_e} \\mathbf{G}^T (-\\mathbf{P}^T \\mathbf{B}) \\, \\mathrm{d}\\Omega = -\\int_{\\Omega_e} \\mathbf{G}^T \\mathbf{P}^T \\mathbf{B} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{K}_{\\phi\\phi} = \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\boldsymbol{\\phi}_e} = \\int_{\\Omega_e} \\mathbf{G}^T \\boldsymbol{\\mu} \\mathbf{G} \\, \\mathrm{d}\\Omega\n$$\nThese expressions match those provided in the problem statement. The overall tangent matrix $\\mathbf{K}$ is symmetric, as $\\mathbf{K}_{\\phi u} = \\mathbf{K}_{u\\phi}^T$, which follows from the existence of the potential $\\psi$.\n\nFor a CST element of thickness $t$, the integrand in each expression is constant over the element domain $\\Omega_e$. The integration simplifies to a multiplication by the element aera-thickness product, $t A_e$, where $A_e$ is the area of the triangle.\n$$\n\\mathbf{K}_{uu} = t A_e \\, \\mathbf{B}^T \\mathbf{C} \\mathbf{B}\n$$\n$$\n\\mathbf{K}_{u\\phi} = -t A_e \\, \\mathbf{B}^T \\mathbf{P} \\mathbf{G}\n$$\n$$\n\\mathbf{K}_{\\phi\\phi} = t A_e \\, \\mathbf{G}^T \\boldsymbol{\\mu} \\mathbf{G}\n$$\n\nThe implementation requires computing these matrices for the specified test cases. We first compute the geometric factors $b_i, c_i$ from nodal coordinates $(x_i, y_i)$, the element area $A_e$, and then construct the matrices $\\mathbf{B}$ and $\\mathbf{G}$. The plane strain elastic stiffness matrix $\\mathbf{C}$ is constructed from Young's modulus $E$ and Poisson's ratio $\\nu$. Finally, the tangent submatrices are assembled and their Frobenius norms are calculated. The procedure is implemented in the provided Python code.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Frobenius norms of the tangent submatrices for several\n    magnetoelastic CST element test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"E\": 2.10e11,\n            \"nu\": 0.30,\n            \"t\": 1.0e-2,\n            \"mu\": np.array([[6.0e-6, 1.0e-6], [1.0e-6, 4.0e-6]]),\n            \"P\": np.array([[1.2e5, -0.8e5], [0.6e5, 1.1e5], [0.2e5, -0.4e5]])\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"E\": 7.0e10,\n            \"nu\": 0.33,\n            \"t\": 2.0e-2,\n            \"mu\": np.array([[5.0e-6, 0.0], [0.0, 5.0e-6]]),\n            \"P\": np.zeros((3, 2))\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [0.8, 0.0], [0.0, 0.6]]),\n            \"E\": 3.5e9,\n            \"nu\": 0.499,\n            \"t\": 5.0e-3,\n            \"mu\": np.array([[2.0e-6, 0.0], [0.0, 7.0e-6]]),\n            \"P\": np.array([[5.0e4, 3.0e4], [1.0e4, 2.0e4], [-2.0e4, 1.0e4]])\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [2.0, 0.0], [0.0, 0.2]]),\n            \"E\": 1.10e11,\n            \"nu\": 0.25,\n            \"t\": 1.5e-2,\n            \"mu\": np.array([[3.0e-6, -0.5e-6], [-0.5e-6, 3.5e-6]]),\n            \"P\": np.array([[-9.0e4, 4.0e4], [2.0e4, -7.0e4], [3.0e4, 3.0e4]])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        nodes = case[\"nodes\"]\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n        t = case[\"t\"]\n        mu_tensor = case[\"mu\"]\n        P_matrix = case[\"P\"]\n\n        x1, y1 = nodes[0]\n        x2, y2 = nodes[1]\n        x3, y3 = nodes[2]\n\n        # Calculate element area and geometric factors\n        area = 0.5 * (x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n        vol = t * area\n\n        b1 = y2 - y3\n        b2 = y3 - y1\n        b3 = y1 - y2\n        c1 = x3 - x2\n        c2 = x1 - x3\n        c3 = x2 - x1\n\n        # Construct B matrix (strain-displacement)\n        B = (1.0 / (2.0 * area)) * np.array([\n            [b1, 0, b2, 0, b3, 0],\n            [0, c1, 0, c2, 0, c3],\n            [c1, b1, c2, b2, c3, b3]\n        ])\n\n        # Construct G matrix (potential gradient)\n        G = (1.0 / (2.0 * area)) * np.array([\n            [b1, b2, b3],\n            [c1, c2, c3]\n        ])\n\n        # Construct C matrix (plane strain elastic stiffness)\n        lame_G = E / (2.0 * (1.0 + nu))\n        lame_lambda = (E * nu) / ((1.0 + nu) * (1.0 - 2.0 * nu))\n        C = np.array([\n            [lame_lambda + 2 * lame_G, lame_lambda, 0],\n            [lame_lambda, lame_lambda + 2 * lame_G, 0],\n            [0, 0, lame_G]\n        ])\n\n        # Calculate tangent submatrices\n        # K_uu [N/m]\n        K_uu = vol * B.T @ C @ B\n        # K_uphi [N/A]\n        K_uphi = -vol * B.T @ P_matrix @ G\n        # K_phiphi [H]\n        K_phiphi = vol * G.T @ mu_tensor @ G\n\n        # Calculate Frobenius norms\n        norm_K_uu = np.linalg.norm(K_uu, 'fro')\n        norm_K_phiphi = np.linalg.norm(K_phiphi, 'fro')\n        norm_K_uphi = np.linalg.norm(K_uphi, 'fro')\n        \n        results.append(f\"{norm_K_uu:.6f}\")\n        results.append(f\"{norm_K_phiphi:.6f}\")\n        results.append(f\"{norm_K_uphi:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2899518"}]}