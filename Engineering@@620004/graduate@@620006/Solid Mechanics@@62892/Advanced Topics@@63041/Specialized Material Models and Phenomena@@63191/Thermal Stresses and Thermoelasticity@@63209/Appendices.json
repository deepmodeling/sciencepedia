{"hands_on_practices": [{"introduction": "Thermal stresses are a direct consequence of mechanical constraint. An unconstrained body free to expand or contract with temperature changes will remain stress-free. This first exercise [@problem_id:2928480] provides the most fundamental demonstration of this principle. By deriving the stress in a simple bar fully restrained at its ends, you will solidify your understanding of the core thermoelastic concept: the total strain dictated by the boundary conditions is the sum of a thermal strain from temperature change and a mechanical strain that generates stress.", "problem": "A homogeneous, isotropic, linearly elastic prismatic bar of length $L$ and uniform cross-sectional area $A$ is perfectly restrained at both ends along its axis so that its net axial elongation is prevented. The bar is initially stress-free at a uniform temperature and then subjected to a uniform temperature increase $\\Delta T$. The material has Young’s modulus $E$ and linear coefficient of thermal expansion $\\alpha$. Assume small strains, quasi-static conditions, uncoupled thermoelasticity (the temperature field is prescribed and unaffected by deformation), no body forces, and traction-free lateral surfaces. Take tensile stress as positive.\n\nStarting from the linearized kinematics, the balance of linear momentum, and the constitutive structure of linear, isotropic, uncoupled thermoelasticity, derive the uniform axial Cauchy stress in the bar. Express your final answer as a closed-form analytic expression in terms of $E$, $\\alpha$, and $\\Delta T$ only. Do not include units in your final expression.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n**Step 1: Extraction of Givens**\n- A homogeneous, isotropic, linearly elastic prismatic bar.\n- Length: $L$.\n- Uniform cross-sectional area: $A$.\n- Boundary conditions: Perfectly restrained at both ends, preventing net axial elongation.\n- Initial state: Stress-free at a uniform temperature.\n- Loading: A uniform temperature increase $\\Delta T$.\n- Material properties: Young’s modulus $E$ and linear coefficient of thermal expansion $\\alpha$.\n- Assumptions: Small strains, quasi-static conditions, uncoupled thermoelasticity, no body forces, traction-free lateral surfaces.\n- Convention: Tensile stress is positive.\n- Objective: Derive the uniform axial Cauchy stress in the bar.\n\n**Step 2: Validation of the Problem Statement**\nThe problem is a standard exercise in the linear theory of thermoelasticity.\n- **Scientific Grounding**: The problem is based on the fundamental principles of continuum mechanics, specifically linear elasticity and thermal expansion. All concepts, such as Young's modulus, thermal expansion coefficient, stress, and strain, are well-established scientific constructs.\n- **Well-Posedness**: The problem is well-posed. The geometry, material properties, loading, and boundary conditions are specified, and they lead to a unique and stable solution.\n- **Objectivity**: The problem is stated in precise, objective language without ambiguity or subjective elements.\n- **Completeness and Consistency**: The provided information is sufficient and self-consistent. The condition of perfect restraint is the key constraint that defines the problem.\n\n**Step 3: Verdict**\nThe problem is deemed **valid**. A solution based on fundamental principles will now be derived.\n\nWe begin by establishing a coordinate system. Let the axis of the bar be aligned with the $x$-axis, with the bar occupying the domain $x \\in [0, L]$. Due to the uniform cross-section and the nature of the constraints and loading, this is a one-dimensional problem in terms of its mechanical response. The only non-zero displacement component is the axial displacement $u_x(x)$, and the only non-zero stress component of interest is the axial stress $\\sigma_{xx}(x)$.\n\nThe derivation proceeds from the fundamental equations of continuum mechanics.\n\nFirst, we consider the **balance of linear momentum**. For a quasi-static process with no body forces, the equilibrium equation in one dimension is:\n$$ \\frac{d\\sigma_{xx}}{dx} = 0 $$\nIntegrating this equation with respect to $x$ shows that the axial stress $\\sigma_{xx}$ must be constant along the length of the bar. We denote this constant stress as $\\sigma$:\n$$ \\sigma_{xx}(x) = \\sigma $$\n\nSecond, we state the **constitutive law** for a linear, isotropic, thermoelastic material in one dimension. The total axial strain $\\varepsilon_{xx}$ is the sum of the mechanical strain and the thermal strain. The mechanical strain is related to the stress via Young's modulus $E$, and the thermal strain $\\varepsilon_{th}$ is related to the temperature change $\\Delta T$ via the coefficient of thermal expansion $\\alpha$. The total strain is thus given by:\n$$ \\varepsilon_{xx} = \\frac{\\sigma_{xx}}{E} + \\varepsilon_{th} $$\nThe thermal strain is defined as:\n$$ \\varepsilon_{th} = \\alpha \\Delta T $$\nSubstituting this into the constitutive relation yields:\n$$ \\varepsilon_{xx} = \\frac{\\sigma_{xx}}{E} + \\alpha \\Delta T $$\n\nThird, we employ the **kinematic relationship** between strain and displacement. For small strains, the axial strain is the spatial derivative of the axial displacement:\n$$ \\varepsilon_{xx} = \\frac{du_x}{dx} $$\n\nCombining these results, we substitute $\\sigma_{xx} = \\sigma$ into the constitutive equation. Since $E$, $\\alpha$, and $\\Delta T$ are all uniform constants, the axial strain $\\varepsilon_{xx}$ must also be constant along the length of the bar.\n\nFinally, we apply the **boundary condition**. The problem states that the bar is \"perfectly restrained at both ends\" such that its \"net axial elongation is prevented.\" This translates to a condition on the total change in length, $\\delta_L$. The total elongation is the integral of the axial strain over the bar's length:\n$$ \\delta_L = \\int_0^L \\varepsilon_{xx} \\, dx $$\nThe constraint is that $\\delta_L = 0$.\n$$ \\int_0^L \\varepsilon_{xx} \\, dx = 0 $$\nSince we have established that $\\varepsilon_{xx}$ is a constant, the integral becomes:\n$$ \\varepsilon_{xx} \\int_0^L dx = \\varepsilon_{xx} L = 0 $$\nGiven that the length of the bar $L$ is non-zero, this requires the total axial strain to be zero everywhere:\n$$ \\varepsilon_{xx} = 0 $$\n\nNow, we substitute this kinematic result, $\\varepsilon_{xx} = 0$, back into the constitutive equation:\n$$ 0 = \\frac{\\sigma_{xx}}{E} + \\alpha \\Delta T $$\nSolving for the axial stress $\\sigma_{xx}$ gives:\n$$ \\frac{\\sigma_{xx}}{E} = -\\alpha \\Delta T $$\n$$ \\sigma_{xx} = -E \\alpha \\Delta T $$\nThis is the uniform axial Cauchy stress in the bar. The negative sign indicates that for a positive temperature increase ($\\Delta T > 0$), the stress is compressive, as expected for a constrained heated bar. The result depends only on the material properties $E$ and $\\alpha$, and the temperature change $\\Delta T$, as required.", "answer": "$$\n\\boxed{-E \\alpha \\Delta T}\n$$", "id": "2928480"}, {"introduction": "Having established the basic principle in one dimension, we now explore how it applies to more complex geometries. A common question is whether geometric features like holes or cutouts automatically generate thermal stress. This practice [@problem_id:2920492] challenges that assumption by examining an infinite plate with a circular hole. You will discover the crucial distinction between local geometry and global constraints, and demonstrate that for a homogeneous, isotropic body under uniform heating, stress only arises when free expansion is prevented by far-field boundary conditions.", "problem": "An infinite, thin, homogeneous, isotropic, linear elastic plate containing a traction-free circular hole of radius $a$ is subjected to a spatially uniform temperature change $\\Delta T$. The plate is in a state of plane stress, with Young’s modulus $E$, Poisson’s ratio $\\nu$, and coefficient of thermal expansion $\\alpha$. There are no body forces. Assume small strains and linear thermoelasticity with thermal strain $\\boldsymbol{\\varepsilon}^{\\mathrm{th}} = \\alpha \\Delta T \\mathbf{I}$, where $\\mathbf{I}$ is the second-order identity tensor.\n\nConsider the following scenarios:\n- Case U (unconstrained free expansion): The plate is free to expand, with traction-free boundaries (including the hole), and no kinematic constraints at infinity.\n- Case X (partial in-plane constraint): The plate’s macroscopic expansion is prevented only along the $x$-direction at infinity in the sense that the remote in-plane mechanical response enforces $\\varepsilon_{xx} \\to 0$ as $r \\to \\infty$, while there is no constraint in the $y$-direction and no applied tractions at infinity in $y$.\n- Case B (full in-plane constraint): The plate’s macroscopic in-plane expansion is prevented in both $x$ and $y$ at infinity in the sense that the remote in-plane mechanical response enforces $\\varepsilon_{xx} \\to 0$ and $\\varepsilon_{yy} \\to 0$ as $r \\to \\infty$.\n\nUsing only the governing laws of linear thermoelasticity (balance, compatibility, and linear elastic constitutive equations with thermal strain), and recognizing that the hole boundary is traction free, decide which of the following statements are correct. Select all that apply.\n\nA. In Case U, there exists a displacement field $\\mathbf{u}(\\mathbf{x})$ such that $\\boldsymbol{\\varepsilon} = \\alpha \\Delta T \\mathbf{I}$ everywhere, implying $\\boldsymbol{\\sigma} = \\mathbf{0}$ throughout the plate, including in the vicinity of the hole.\n\nB. In Case B, the far-field stress is a uniform biaxial state with $\\sigma_{xx}^\\infty = \\sigma_{yy}^\\infty = - E \\alpha \\Delta T / (1 - \\nu)$, and the circumferential (hoop) stress at the hole boundary $r = a$ is independent of the polar angle and equal to $2 \\sigma_{xx}^\\infty$.\n\nC. In Case X, the far-field stress is uniaxial with $\\sigma_{xx}^\\infty = - E \\alpha \\Delta T$ and $\\sigma_{yy}^\\infty = 0$. In this case, at the hole boundary $r = a$, the maximum magnitude of the circumferential stress is $3 |\\sigma_{xx}^\\infty|$ and occurs at $\\theta = \\pm \\pi/2$ (with $\\theta$ measured from the $x$-axis).\n\nD. Even in Case U, the presence of the curved hole boundary necessarily generates a nonzero thermal hoop stress near the hole that scales with $\\alpha \\Delta T$, because a uniform dilation cannot satisfy the traction-free boundary condition on a curved surface.\n\nE. If the material were orthotropic in-plane with distinct, uniform thermal expansion coefficients $\\alpha_x \\neq \\alpha_y$ but remained homogeneous and unconstrained (as in Case U), a uniform temperature change would necessarily generate nonzero stress near the hole, because the radial direction samples different principal expansion coefficients with angle.\n\nChoose all options that are correct. Give no partial selections; choose exactly those statements that are true under the stated assumptions.", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n-   **Geometry and Material**: An infinite, thin, homogeneous, isotropic, linear elastic plate with a traction-free circular hole of radius $a$.\n-   **State and Properties**: State of plane stress. Young’s modulus $E$, Poisson’s ratio $\\nu$, coefficient of thermal expansion $\\alpha$.\n-   **Loading and Fields**: Spatially uniform temperature change $\\Delta T$. No body forces.\n-   **Theory**: Small strains, linear thermoelasticity. Thermal strain is $\\boldsymbol{\\varepsilon}^{\\mathrm{th}} = \\alpha \\Delta T \\mathbf{I}$, where $\\mathbf{I}$ is the second-order identity tensor.\n-   **Boundary Conditions (Cases)**:\n    -   **Case U (unconstrained)**: Free expansion, traction-free boundaries (including the hole), no kinematic constraints at infinity.\n    -   **Case X (partial constraint)**: At infinity ($r \\to \\infty$), $\\varepsilon_{xx} \\to 0$, no constraint in the $y$-direction, and no applied tractions at infinity in $y$.\n    -   **Case B (full constraint)**: At infinity ($r \\to \\infty$), $\\varepsilon_{xx} \\to 0$ and $\\varepsilon_{yy} \\to 0$.\n-   **Core Task**: Evaluate the correctness of the five provided statements using the governing laws of linear thermoelasticity.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in the theory of linear thermoelasticity, specifically addressing thermal stresses in a multiply-connected domain (a plate with a hole).\n-   **Scientifically Grounded**: The problem is based on the classical theory of elasticity and thermoelasticity. All concepts, such as plane stress, Hooke's law, thermal strain, and stress concentration, are well-established principles of continuum mechanics.\n-   **Well-Posed**: For each case (U, X, B), the combination of geometry, material laws, and boundary conditions defines a well-posed boundary value problem for which a unique solution is expected to exist.\n-   **Objective**: The problem is stated using precise, standard terminology from solid mechanics, leaving no room for subjective interpretation.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and objective. It contains no contradictions, missing information, or fallacious premises. The idealization of an \"infinite plate\" is a standard and valid construct in this context. Therefore, the problem is **valid**. I will proceed with a full derivation and analysis.\n\nThe governing equations of linear thermoelasticity are:\n1.  **Equilibrium (no body forces)**: $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$.\n2.  **Kinematics (small strain)**: $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$. This implies a compatibility condition on the strain field.\n3.  **Constitutive Law (plane stress, isotropic)**: The total strain $\\boldsymbol{\\varepsilon}$ is the sum of mechanical strain $\\boldsymbol{\\varepsilon}^{\\mathrm{el}}$ and thermal strain $\\boldsymbol{\\varepsilon}^{\\mathrm{th}}$. The stress is related to the mechanical strain: $\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}^{\\mathrm{el}} = \\mathbf{C} : (\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{\\mathrm{th}})$. In component form for plane stress:\n    $$ \\varepsilon_{xx} = \\frac{1}{E}(\\sigma_{xx} - \\nu \\sigma_{yy}) + \\alpha \\Delta T $$\n    $$ \\varepsilon_{yy} = \\frac{1}{E}(\\sigma_{yy} - \\nu \\sigma_{xx}) + \\alpha \\Delta T $$\n    Inverting for stresses:\n    $$ \\sigma_{xx} = \\frac{E}{1-\\nu^2} [(\\varepsilon_{xx} - \\alpha \\Delta T) + \\nu(\\varepsilon_{yy} - \\alpha \\Delta T)] $$\n    $$ \\sigma_{yy} = \\frac{E}{1-\\nu^2} [(\\varepsilon_{yy} - \\alpha \\Delta T) + \\nu(\\varepsilon_{xx} - \\alpha \\Delta T)] $$\n\nI will now evaluate each statement.\n\n**Statement A Analysis**\n\nIn Case U, the plate is entirely unconstrained. We hypothesize a solution corresponding to uniform free thermal expansion. Consider the displacement field $\\mathbf{u}(\\mathbf{x}) = \\alpha \\Delta T \\mathbf{x}$. In Cartesian coordinates, $u_x = \\alpha \\Delta T x$ and $u_y = \\alpha \\Delta T y$.\nThe components of the total strain tensor $\\boldsymbol{\\varepsilon}$ are:\n$$ \\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\alpha \\Delta T $$\n$$ \\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\alpha \\Delta T $$\n$$ \\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = 0 $$\nThus, the total strain is $\\boldsymbol{\\varepsilon} = \\alpha \\Delta T \\mathbf{I}$. This is precisely the given thermal strain, $\\boldsymbol{\\varepsilon}^{\\mathrm{th}}$.\nThe mechanical strain is $\\boldsymbol{\\varepsilon}^{\\mathrm{el}} = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{\\mathrm{th}} = \\mathbf{0}$.\nConsequently, the stress tensor is $\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}^{\\mathrm{el}} = \\mathbf{0}$ everywhere in the plate.\nThis \"solution\" must satisfy all governing equations and boundary conditions:\n1.  **Equilibrium**: $\\nabla \\cdot \\boldsymbol{\\sigma} = \\nabla \\cdot \\mathbf{0} = \\mathbf{0}$. Satisfied.\n2.  **Compatibility**: The strain field is derived from a well-defined, single-valued displacement field, so it is automatically compatible.\n3.  **Boundary Conditions**: Since $\\boldsymbol{\\sigma} = \\mathbf{0}$ everywhere, the traction vector $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ is zero on any surface. This satisfies the traction-free condition on the hole boundary ($r=a$) and at infinity.\n\nThe proposed state is a valid solution. A uniform temperature change in an unconstrained, homogeneous body (even if multiply-connected) induces no thermal stresses.\n\nVerdict: **Correct**.\n\n**Statement B Analysis**\n\nIn Case B, the plate is constrained at infinity such that $\\varepsilon_{xx} \\to 0$ and $\\varepsilon_{yy} \\to 0$. Far from the hole, the plate is effectively continuous. We use the constitutive equations to find the far-field stresses ($\\sigma_{xx}^\\infty, \\sigma_{yy}^\\infty$).\nSetting $\\varepsilon_{xx} = 0$ and $\\varepsilon_{yy} = 0$ in the stress-strain relations:\n$$ \\sigma_{xx}^\\infty = \\frac{E}{1-\\nu^2} [(0 - \\alpha \\Delta T) + \\nu(0 - \\alpha \\Delta T)] = \\frac{E(-\\alpha \\Delta T)(1+\\nu)}{1-\\nu^2} = -\\frac{E \\alpha \\Delta T}{1-\\nu} $$\n$$ \\sigma_{yy}^\\infty = \\frac{E}{1-\\nu^2} [(0 - \\alpha \\Delta T) + \\nu(0 - \\alpha \\Delta T)] = -\\frac{E \\alpha \\Delta T}{1-\\nu} $$\nThis confirms the first part of the statement: the far-field stress is a uniform biaxial state with $\\sigma_{xx}^\\infty = \\sigma_{yy}^\\infty = - E \\alpha \\Delta T / (1 - \\nu)$. Let this far-field stress be denoted by $S$.\nThe problem is now reduced to an infinite plate with a traction-free hole subjected to a remote biaxial stress $\\sigma_{xx}^\\infty = \\sigma_{yy}^\\infty = S$. This is a classical axisymmetric problem. The hoop stress $\\sigma_{\\theta\\theta}$ is given by the Kirsch solution:\n$$ \\sigma_{\\theta\\theta}(r) = S \\left(1 + \\frac{a^2}{r^2}\\right) $$\nAt the hole boundary, $r=a$:\n$$ \\sigma_{\\theta\\theta}|_{r=a} = S \\left(1 + \\frac{a^2}{a^2}\\right) = 2S = 2\\sigma_{xx}^\\infty $$\nThis stress is independent of the polar angle $\\theta$, as stated. The second part of the statement is also correct.\n\nVerdict: **Correct**.\n\n**Statement C Analysis**\n\nIn Case X, the constraints at infinity are $\\varepsilon_{xx} \\to 0$ and\n$\\sigma_{yy}^{\\infty}=0$ (no constraint nor applied traction in the $y$-direction).\nFirst, find the far-field stress $\\sigma_{xx}^\\infty$ using the constitutive law for $\\varepsilon_{xx}$:\n$$ \\varepsilon_{xx}^\\infty = \\frac{1}{E}(\\sigma_{xx}^\\infty - \\nu \\sigma_{yy}^\\infty) + \\alpha \\Delta T $$\nSubstituting the given conditions $\\varepsilon_{xx}^\\infty = 0$ and $\\sigma_{yy}^\\infty = 0$:\n$$ 0 = \\frac{1}{E}(\\sigma_{xx}^\\infty - 0) + \\alpha \\Delta T \\implies \\sigma_{xx}^\\infty = -E \\alpha \\Delta T $$\nThe far-field stress is uniaxial, as stated. Let $S = \\sigma_{xx}^\\infty = -E \\alpha \\Delta T$.\nThe problem reduces to an infinite plate with a traction-free hole under remote uniaxial stress $S$ in the $x$-direction. The hoop stress at the hole boundary ($r=a$) from the Kirsch solution is:\n$$ \\sigma_{\\theta\\theta}|_{r=a} = S(1 - 2\\cos(2\\theta)) $$\nWe seek the maximum magnitude of this stress. The value of $\\sigma_{\\theta\\theta}$ varies with angle $\\theta$:\n-   Maximum value occurs when $\\cos(2\\theta)=-1$ (i.e., $2\\theta = \\pi$, so $\\theta = \\pm \\pi/2$). At these points, $\\sigma_{\\theta\\theta} = S(1 - 2(-1)) = 3S$.\n-   Minimum value occurs when $\\cos(2\\theta)=1$ (i.e., $2\\theta = 0$, so $\\theta = 0$). At this point, $\\sigma_{\\theta\\theta} = S(1 - 2(1)) = -S$.\nThe stress varies between $-S$ and $3S$. The maximum magnitude is $|3S| = 3|S| = 3|\\sigma_{xx}^\\infty|$. This maximum magnitude occurs at $\\theta = \\pm \\pi/2$. All parts of the statement are consistent with the derivation.\n\nVerdict: **Correct**.\n\n**Statement D Analysis**\n\nThis statement claims that in Case U (unconstrained), the curved hole boundary *must* generate stress because a uniform dilation cannot satisfy the traction-free boundary condition on a curved surface. This is fundamentally incorrect. As demonstrated in the analysis for Statement A, the state of zero stress, $\\boldsymbol{\\sigma}=\\mathbf{0}$, is a valid solution. The traction vector is given by $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$. If the stress tensor is zero everywhere, the traction vector is zero on *any* surface, regardless of its shape or orientation. The reasoning in the statement is fallacious.\n\nVerdict: **Incorrect**.\n\n**Statement E Analysis**\n\nThis statement considers a hypothetical unconstrained orthotropic plate with thermal expansion coefficients $\\alpha_x \\neq \\alpha_y$. It claims that a uniform temperature change $\\Delta T$ will necessarily generate stress near the hole.\nThe thermal strain tensor is now anisotropic: $\\varepsilon_{xx}^{\\mathrm{th}} = \\alpha_x \\Delta T$, $\\varepsilon_{yy}^{\\mathrm{th}} = \\alpha_y \\Delta T$, $\\varepsilon_{xy}^{\\mathrm{th}} = 0$.\nTo determine if stress is generated, we check if a stress-free state is possible. A stress-free state requires the mechanical strain to be zero, which means the total strain must equal the thermal strain: $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{\\mathrm{th}}$.\nFor this to be a valid strain state in a body, it must be compatible. A strain field is compatible if it can be derived from a single-valued, continuous displacement field. The compatibility condition in 2D is $\\frac{\\partial^2 \\varepsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\varepsilon_{yy}}{\\partial x^2} = 2 \\frac{\\partial^2 \\varepsilon_{xy}}{\\partial x \\partial y}$.\nSince $\\varepsilon_{xx}$, $\\varepsilon_{yy}$, and $\\varepsilon_{xy}$ are all constants, their second derivatives are all zero, and the compatibility equation ($0+0=0$) is satisfied. This means the strain field is compatible.\nThe corresponding single-valued displacement field is $u_x = (\\alpha_x \\Delta T) x$ and $u_y = (\\alpha_y \\Delta T) y$. Since this displacement field is single-valued, it is valid for a multiply-connected domain like a plate with a hole.\nThe state described by $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{\\mathrm{th}}$ and $\\boldsymbol{\\sigma} = \\mathbf{0}$ satisfies equilibrium and the traction-free boundary conditions. Therefore, it is the correct solution. No stress is generated. The statement is incorrect. The generation of thermal stresses in a homogeneous body depends on the incompatibility of the thermal strain field, not on its anisotropy. A uniform thermal strain field is always compatible.\n\nVerdict: **Incorrect**.", "answer": "$$\\boxed{ABC}$$", "id": "2920492"}, {"introduction": "While analytical solutions are invaluable for building intuition, most real-world thermoelastic problems are too complex for closed-form analysis and require numerical methods. This final practice [@problem_id:2701615] serves as a bridge from theory to practical application, guiding you through the implementation of thermal loads within a Finite Element (FE) framework. By treating thermal strain as an initial strain and constructing the equivalent nodal forces, you will not only develop valuable computational skills but also gain a deeper appreciation for how thermoelasticity is modeled in modern engineering simulation software.", "problem": "Consider a one-dimensional, prismatic, linearly elastic bar undergoing an uncoupled thermoelastic response. The bar occupies the interval $[0,L]$ on the real line and has constant cross-sectional area $A$, Young’s modulus $E$, and coefficient of linear thermal expansion $\\alpha$. Let the axial displacement field be $u(x)$, the total infinitesimal strain be $\\varepsilon(x)$, the thermal strain be $\\varepsilon_{\\mathrm{th}}(x)$, and the Cauchy stress be $\\sigma(x)$. Assume small strains and small displacements and neglect inertia and body forces.\n\nYou will implement thermal strains as initial strains in a one-dimensional Finite Element (FE) code for the axial bar and verify consistency with the continuous virtual work statement. The essential tasks are:\n\n- Starting from fundamental laws and core definitions (linear momentum balance in the absence of inertia and body forces, linear kinematics, and linear thermoelastic constitutive behavior), build the Galerkin weak form for the axial bar with thermal strains treated as initial strains.\n- Discretize with linear, two-node bar elements on a uniform mesh of $N_{\\mathrm{el}}$ elements and $N_{\\mathrm{n}} = N_{\\mathrm{el}} + 1$ nodes. Impose essential boundary conditions using standard FE procedures suitable for symmetric positive definite systems.\n- Assemble the global stiffness matrix and the global thermal equivalent nodal load arising from the initial strains. No external mechanical tractions are applied in any test case below.\n- Solve the resulting linear system for nodal displacements $u_{a}$ at all unconstrained degrees of freedom, compute the reaction forces at constrained degrees of freedom, and verify the virtual work consistency described next.\n\nVerification of consistency with the continuous virtual work statement must be done as follows. For any virtual displacement field $\\delta u(x)$ that satisfies the essential boundary conditions (vanishes where $u$ is prescribed), the continuous thermal virtual work is the integral of the thermal part of the stress power against the virtual strain. Let $\\delta \\boldsymbol{U}$ denote the vector of nodal virtual displacements for the FE space and $\\boldsymbol{f}_{\\mathrm{th}}$ denote the assembled global thermal equivalent nodal load vector. Your code must verify, for several independent choices of $\\delta \\boldsymbol{U}$, that the discrete virtual work $\\delta \\boldsymbol{U}^{\\mathsf{T}} \\boldsymbol{f}_{\\mathrm{th}}$ matches the continuous thermal virtual work computed by direct numerical integration of the continuous expression over the domain, up to numerical quadrature error.\n\nAll physical quantities must be handled in the International System of Units (SI). Report all outputs in the exact units specified below. The program must not read any input and must use the test suite specified below. Use double-precision arithmetic.\n\nFundamental base and modeling assumptions to use:\n\n- Kinematics: $\\varepsilon(x) = \\dfrac{du}{dx}$.\n- Thermal strain: $\\varepsilon_{\\mathrm{th}}(x) = \\alpha\\,\\Delta T(x)$, where $\\Delta T(x)$ is the prescribed temperature change field.\n- Linear thermoelastic constitutive law: $\\sigma(x) = E \\big(\\varepsilon(x) - \\varepsilon_{\\mathrm{th}}(x) \\big)$.\n- Static equilibrium without body forces: $\\dfrac{d}{dx}\\big(A\\,\\sigma(x)\\big) = 0$ in the interior, with essential and traction boundary conditions applied in the standard manner.\n\nTest suite and required outputs:\n\nImplement three test cases. For each case, construct a uniform mesh and carry out the FE assembly with thermal strains as initial strains. For the virtual work verification, use three independent virtual nodal vectors $\\delta \\boldsymbol{U}$ (deterministically generated) that satisfy the essential boundary conditions of the case.\n\n- Case $\\#1$ (both ends fixed, uniform temperature):\n  - Parameters: $L = 0.5\\,\\mathrm{m}$, $A = 2.0\\times 10^{-4}\\,\\mathrm{m}^{2}$, $E = 70.0\\times 10^{9}\\,\\mathrm{Pa}$, $\\alpha = 23.0\\times 10^{-6}\\,\\mathrm{K}^{-1}$, uniform $\\Delta T(x) \\equiv 100.0\\,\\mathrm{K}$, $N_{\\mathrm{el}} = 10$.\n  - Boundary conditions: $u(0) = 0$ and $u(L) = 0$.\n  - Outputs to compute:\n    1. $w_{1}$: the maximum over the three choices of virtual fields of the absolute discrepancy between the discrete and continuous thermal virtual work, in $\\mathrm{N}\\cdot\\mathrm{m}$.\n    2. $p_{1}$: the absolute difference between the magnitude of either end reaction (they should be equal in magnitude) from the FE solution and the analytical prediction for the constrained thermal force based on the spatial average of $\\Delta T(x)$, in $\\mathrm{N}$. Use the continuous formula for the reaction magnitude derived from equilibrium with both ends fixed and constant axial force.\n\n- Case $\\#2$ (left end fixed, right end traction-free, uniform temperature):\n  - Parameters: $L = 1.2\\,\\mathrm{m}$, $A = 1.5\\times 10^{-4}\\,\\mathrm{m}^{2}$, $E = 200.0\\times 10^{9}\\,\\mathrm{Pa}$, $\\alpha = 12.0\\times 10^{-6}\\,\\mathrm{K}^{-1}$, uniform $\\Delta T(x) \\equiv 30.0\\,\\mathrm{K}$, $N_{\\mathrm{el}} = 12$.\n  - Boundary conditions and tractions: $u(0) = 0$, traction-free at $x=L$.\n  - Outputs to compute:\n    1. $w_{2}$: the maximum over the three choices of virtual fields of the absolute discrepancy between the discrete and continuous thermal virtual work, in $\\mathrm{N}\\cdot\\mathrm{m}$.\n    2. $p_{2}$: the absolute difference between the FE-computed displacement at $x=L$ and the analytical free thermal expansion $\\int_{0}^{L}\\alpha\\,\\Delta T(x)\\,dx$, in $\\mathrm{m}$.\n\n- Case $\\#3$ (both ends fixed, linearly varying temperature):\n  - Parameters: $L = 0.8\\,\\mathrm{m}$, $A = 1.0\\times 10^{-4}\\,\\mathrm{m}^{2}$, $E = 210.0\\times 10^{9}\\,\\mathrm{Pa}$, $\\alpha = 11.0\\times 10^{-6}\\,\\mathrm{K}^{-1}$, linear $\\Delta T(x) = \\Delta T_{0} + g\\,x$ with $\\Delta T_{0} = 10.0\\,\\mathrm{K}$ and $g = 50.0\\,\\mathrm{K}/\\mathrm{m}$, $N_{\\mathrm{el}} = 16$.\n  - Boundary conditions: $u(0) = 0$ and $u(L) = 0$.\n  - Outputs to compute:\n    1. $w_{3}$: the maximum over the three choices of virtual fields of the absolute discrepancy between the discrete and continuous thermal virtual work, in $\\mathrm{N}\\cdot\\mathrm{m}$.\n    2. $p_{3}$: the absolute difference between the magnitude of either end reaction from the FE solution and the analytical prediction based on the spatial average of $\\Delta T(x)$ (appropriate for the axial bar with both ends fixed), in $\\mathrm{N}$.\n\nNumerical integration requirements:\n\n- For FE assembly, use Gaussian quadrature with at least $2$ points per element.\n- For the continuous virtual work computation and for the analytical averages of $\\Delta T(x)$ needed in the outputs $p_{1}$ and $p_{3}$, evaluate the required integrals by Gaussian quadrature with at least $5$ points per element; this must be implemented numerically, not symbolically, to ensure a uniform computational approach across cases.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets: $[w_{1},p_{1},w_{2},p_{2},w_{3},p_{3}]$.\n- All $w_{i}$ must be in $\\mathrm{N}\\cdot\\mathrm{m}$, $p_{1}$ and $p_{3}$ must be in $\\mathrm{N}$, and $p_{2}$ must be in $\\mathrm{m}$.\n- No additional text should be printed.", "solution": "The problem presented requires the development and verification of a one-dimensional finite element (FE) model for linear thermoelasticity. The problem is well-posed, scientifically sound, and contains all necessary information for its solution. We proceed with the derivation and implementation.\n\nThe fundamental principle governing the static response of the elastic bar is the balance of linear momentum. In the absence of body forces, the strong form of the equilibrium equation is given by:\n$$\n\\frac{d\\sigma}{dx} = 0\n$$\nwhere $\\sigma(x)$ is the axial Cauchy stress. The cross-sectional area $A$ is constant, so this simplifies from $\\frac{d(A\\sigma)}{dx}=0$. The principle of virtual work provides the weak form, which states that for any kinematically admissible virtual displacement field $\\delta u(x)$, the internal virtual work must equal the external virtual work. With no applied external mechanical tractions, and for virtual displacements vanishing at essential boundaries, this is:\n$$\n\\int_{0}^{L} \\sigma(x) \\delta\\varepsilon(x) A \\, dx = 0\n$$\nwhere $\\delta\\varepsilon(x) = d(\\delta u)/dx$ is the virtual strain.\n\nThe linear thermoelastic constitutive law relates stress to the mechanical strain, which is the total strain $\\varepsilon(x)$ minus the thermal strain $\\varepsilon_{\\mathrm{th}}(x)$:\n$$\n\\sigma(x) = E \\left(\\varepsilon(x) - \\varepsilon_{\\mathrm{th}}(x)\\right)\n$$\nHere, $E$ is Young's modulus, the total strain is given by the kinematic relation $\\varepsilon(x) = du/dx$, and the thermal strain is $\\varepsilon_{\\mathrm{th}}(x) = \\alpha \\Delta T(x)$, with $\\alpha$ being the coefficient of linear thermal expansion and $\\Delta T(x)$ the temperature change field.\n\nSubstituting the constitutive relation into the weak form yields:\n$$\n\\int_{0}^{L} E \\left(\\frac{du}{dx} - \\alpha \\Delta T(x)\\right) \\delta\\left(\\frac{du}{dx}\\right) A \\, dx = 0\n$$\nRearranging terms separates the problem into a stiffness part and a load part. We seek a displacement field $u(x)$ from an appropriate function space such that for all admissible virtual displacements $\\delta u(x)$:\n$$\n\\int_{0}^{L} E A \\frac{du}{dx} \\frac{d(\\delta u)}{dx} \\, dx = \\int_{0}^{L} E A \\alpha \\Delta T(x) \\frac{d(\\delta u)}{dx} \\, dx\n$$\nThis is the continuous Galerkin weak form of the problem. The left-hand side defines a bilinear form related to the system's stiffness, and the right-hand side is a linear functional corresponding to the thermal loading.\n\nFor the finite element discretization, the domain $[0, L]$ is subdivided into $N_{\\mathrm{el}}$ linear, two-node elements of uniform length $h = L/N_{\\mathrm{el}}$. Within each element $e$, the displacement field $u^{(e)}$ is interpolated from the nodal displacements $\\boldsymbol{u}^{(e)} = [u_1, u_2]^T$ using linear shape functions $\\boldsymbol{N}(\\xi) = [\\frac{1-\\xi}{2}, \\frac{1+\\xi}{2}]$ in the local coordinate $\\xi \\in [-1, 1]$:\n$$\nu^{(e)}(\\xi) = \\boldsymbol{N}(\\xi) \\boldsymbol{u}^{(e)}\n$$\nThe strain within the element is constant and is given by $\\varepsilon^{(e)} = \\boldsymbol{B} \\boldsymbol{u}^{(e)}$, where the strain-displacement matrix $\\boldsymbol{B}$ is:\n$$\n\\boldsymbol{B} = \\frac{d\\boldsymbol{N}}{dx} = \\frac{d\\boldsymbol{N}}{d\\xi} \\frac{d\\xi}{dx} = \\frac{1}{h} [-1, 1]\n$$\nThe same interpolation is applied to the virtual displacement field, $\\delta u^{(e)} = \\boldsymbol{N}(\\xi) \\delta\\boldsymbol{u}^{(e)}$, and virtual strain, $\\delta\\varepsilon^{(e)} = \\boldsymbol{B} \\delta\\boldsymbol{u}^{(e)}$.\n\nSubstituting these FE approximations into the weak form and summing over all elements results in the discretized system of linear equations $\\boldsymbol{K} \\boldsymbol{U} = \\boldsymbol{F}_{\\mathrm{th}}$, where $\\boldsymbol{U}$ is the global vector of nodal displacements. The element stiffness matrix $\\boldsymbol{k}^{(e)}$ is:\n$$\n\\boldsymbol{k}^{(e)} = \\int_{\\Omega_e} \\boldsymbol{B}^T E A \\boldsymbol{B} \\, dx = \\boldsymbol{B}^T E A \\boldsymbol{B} h = \\frac{EA}{h}\n\\begin{pmatrix}\n1 & -1 \\\\\n-1 & 1\n\\end{pmatrix}\n$$\nThe element thermal load vector $\\boldsymbol{f}_{\\mathrm{th}}^{(e)}$ treats the thermal strain as an initial strain. Its calculation requires integrating over the element domain:\n$$\n\\boldsymbol{f}_{\\mathrm{th}}^{(e)} = \\int_{\\Omega_e} \\boldsymbol{B}^T E A \\varepsilon_{\\mathrm{th}}(x) \\, dx = \\boldsymbol{B}^T E A \\alpha \\int_{x_i}^{x_{i+1}} \\Delta T(x) \\, dx\n$$\nThis integral is computed numerically using Gaussian quadrature with $n_p=2$ points, as specified. The integral over $x$ is mapped to an integral over $\\xi$:\n$$\n\\int_{x_i}^{x_{i+1}} \\Delta T(x) \\, dx = \\frac{h}{2} \\int_{-1}^{1} \\Delta T(\\xi) \\, d\\xi \\approx \\frac{h}{2} \\sum_{k=1}^{n_p} w_k \\Delta T(x(\\xi_k))\n$$\nwhere $w_k$ and $\\xi_k$ are the Gauss weights and points.\n\nAfter assembling the global stiffness matrix $\\boldsymbol{K}$ and global thermal load vector $\\boldsymbol{F}_{\\mathrm{th}}$, essential boundary conditions are imposed by partitioning the system into free and constrained degrees of freedom (DOFs). The system for the unknown free displacements $\\boldsymbol{U}_f$ is solved, and the full displacement vector $\\boldsymbol{U}$ is constructed. Reaction forces $\\boldsymbol{R}$ at the constrained DOFs are then calculated from the full system response:\n$$\n\\boldsymbol{R} = (\\boldsymbol{K}\\boldsymbol{U} - \\boldsymbol{F}_{\\mathrm{th}})_{\\text{constrained DOFs}}\n$$\n\nThe virtual work consistency check compares the discrete thermal virtual work, $W_{\\mathrm{disc}} = \\delta \\boldsymbol{U}^T \\boldsymbol{F}_{\\mathrm{th}}$, with the continuous thermal virtual work, $W_{\\mathrm{cont}}$. The continuous expression is:\n$$\nW_{\\mathrm{cont}} = \\int_{0}^{L} E A \\alpha \\Delta T(x) \\delta\\varepsilon(x) \\, dx\n$$\nwhere the virtual strain $\\delta\\varepsilon(x)$ is derived from the chosen nodal virtual displacement vector $\\delta\\boldsymbol{U}$. This integral is evaluated numerically using a higher-order Gaussian quadrature ($n_p \\ge 5$ points per element) to serve as a high-accuracy reference. The discrepancy $|W_{\\mathrm{disc}} - W_{\\mathrm{cont}}|$ arises from the difference in numerical quadrature rules used for the assembly of $\\boldsymbol{F}_{\\mathrm{th}}$ and the evaluation of $W_{\\mathrm{cont}}$.\n\nFor the analytical checks:\n- Cases $\\#1$ and $\\#3$ (both ends fixed): The total elongation is zero. For a constant stress $\\sigma_c$ (required by equilibrium), its value is determined by the average temperature change $\\overline{\\Delta T}$: $\\sigma_c = -E \\alpha \\overline{\\Delta T}$. The magnitude of the reaction force is $|A\\sigma_c| = A E \\alpha \\overline{\\Delta T}$.\nThe average temperature $\\overline{\\Delta T} = \\frac{1}{L}\\int_0^L \\Delta T(x)\\,dx$ is computed numerically using a $5$-point Gaussian quadrature rule per element for consistency with the problem requirements.\n- Case $\\#2$ (cantilevered bar): With a traction-free end, the stress throughout the bar is zero. The total strain equals the thermal strain, $\\varepsilon(x) = \\alpha \\Delta T(x)$. The displacement at the free end $x=L$ is the total elongation, $u(L) = \\int_0^L \\alpha \\Delta T(x) \\, dx$. For the given uniform temperature, this simplifies to $u(L) = \\alpha \\Delta T L$.\n\nThe implementation will follow these derivations precisely for each test case specified.", "answer": "```python\nimport numpy as np\n\ndef run_case(L, A, E, alpha, delta_T_func, N_el, bc_type):\n    \"\"\"\n    Solves a single thermoelastic bar problem using the Finite Element Method.\n\n    Args:\n        L (float): Length of the bar.\n        A (float): Cross-sectional area.\n        E (float): Young's modulus.\n        alpha (float): Coefficient of thermal expansion.\n        delta_T_func (callable): Function for temperature change Delta T(x).\n        N_el (int): Number of elements.\n        bc_type (str): Boundary condition type ('fixed-fixed' or 'fixed-free').\n\n    Returns:\n        tuple: (w, p) where w is the max virtual work discrepancy and p is the\n               discrepancy with the analytical solution.\n    \"\"\"\n    N_n = N_el + 1\n    h = L / N_el\n    x_nodes = np.linspace(0, L, N_n)\n\n    # Gaussian quadrature points and weights\n    gauss_pts_assembly, gauss_wts_assembly = np.polynomial.legendre.leggauss(2)\n    gauss_pts_verify, gauss_wts_verify = np.polynomial.legendre.leggauss(5)\n\n    # Initialize global matrices\n    K = np.zeros((N_n, N_n))\n    F_th = np.zeros(N_n)\n\n    # Element stiffness matrix (constant for all elements)\n    k_e = (E * A / h) * np.array([[1, -1], [-1, 1]])\n\n    # Assembly loop\n    for i in range(N_el):\n        # Assemble stiffness\n        nodes = [i, i + 1]\n        K[np.ix_(nodes, nodes)] += k_e\n\n        # Calculate and assemble thermal load vector\n        f_th_e_val = 0.0\n        for gp, gw in zip(gauss_pts_assembly, gauss_wts_assembly):\n            x_gp = x_nodes[i] + (h / 2.0) * (1.0 + gp)\n            f_th_e_val += gw * delta_T_func(x_gp)\n        \n        f_th_e = (E * A * alpha / 2.0) * f_th_e_val * np.array([-1, 1]) * h # B.T * E*A*alpha * integral\n        f_th_e = (E * A * alpha / h) * h/2.0 * f_th_e_val * np.array([-1, 1])\n        # Correction of the formula based on derivation\n        # f_th_e = B^T * E*A*alpha * integral(DeltaT)\n        # integral term = (h/2) * sum(w_k * DeltaT(xi_k))\n        # B^T = (1/h) * [-1, 1]^T\n        f_th_e = (1/h) * np.array([[-1], [1]]) * E * A * alpha * (h/2) * f_th_e_val\n        F_th[nodes] += f_th_e.flatten()\n\n    # Apply boundary conditions\n    if bc_type == 'fixed-fixed':\n        constrained_dofs = [0, N_n - 1]\n    elif bc_type == 'fixed-free':\n        constrained_dofs = [0]\n    else:\n        raise ValueError(\"Unknown boundary condition type\")\n    \n    free_dofs = np.setdiff1d(np.arange(N_n), constrained_dofs)\n    \n    K_ff = K[np.ix_(free_dofs, free_dofs)]\n    F_th_f = F_th[free_dofs]\n\n    # For this problem U_c is always zero.\n    U_f = np.linalg.solve(K_ff, F_th_f)\n    \n    U = np.zeros(N_n)\n    U[free_dofs] = U_f\n\n    # --- Virtual Work Verification ---\n    discrepancies = []\n    \n    # Generate 3 deterministic, independent virtual displacement vectors\n    delta_U_vectors = []\n    for p in range(1, 4):\n        delta_U = np.zeros(N_n)\n        for i in free_dofs:\n            delta_U[i] = (i / float(N_el))**p\n        delta_U_vectors.append(delta_U)\n\n    for delta_U in delta_U_vectors:\n        # Discrete virtual work\n        W_disc = delta_U.T @ F_th\n\n        # Continuous virtual work (high-accuracy numerical integration)\n        W_cont = 0.0\n        for i in range(N_el):\n            delta_u_e = delta_U[i:i+2]\n            delta_eps_e = (delta_u_e[1] - delta_u_e[0]) / h\n            \n            integral_val = 0.0\n            for gp, gw in zip(gauss_pts_verify, gauss_wts_verify):\n                x_gp = x_nodes[i] + (h / 2.0) * (1.0 + gp)\n                integral_val += gw * delta_T_func(x_gp)\n            \n            W_cont += (E * A * alpha * delta_eps_e) * (h / 2.0) * integral_val\n\n        discrepancies.append(abs(W_disc - W_cont))\n\n    w = max(discrepancies)\n\n    # --- Analytical Comparison ---\n    if bc_type == 'fixed-fixed':\n        # Calculate analytical reaction force\n        avg_delta_T_integral = 0.0\n        for i in range(N_el):\n            integral_val = 0.0\n            for gp, gw in zip(gauss_pts_verify, gauss_wts_verify):\n                x_gp = x_nodes[i] + (h / 2.0) * (1.0 + gp)\n                integral_val += gw * delta_T_func(x_gp)\n            avg_delta_T_integral += (h / 2.0) * integral_val\n        \n        avg_delta_T = avg_delta_T_integral / L\n        R_analytical = E * A * alpha * avg_delta_T\n\n        # Calculate FE reaction force\n        Reactions = K @ U - F_th\n        R_fe = Reactions[constrained_dofs[0]]\n        \n        p = abs(R_fe - R_analytical)\n\n    elif bc_type == 'fixed-free':\n        # Analytical free end displacement\n        u_L_analytical_integral = 0.0\n        for i in range(N_el):\n            integral_val = 0.0\n            for gp, gw in zip(gauss_pts_verify, gauss_wts_verify):\n                x_gp = x_nodes[i] + (h / 2.0) * (1.0 + gp)\n                integral_val += gw * delta_T_func(x_gp)\n            u_L_analytical_integral += (h / 2.0) * integral_val\n\n        u_L_analytical = alpha * u_L_analytical_integral\n        \n        # FE free end displacement\n        u_L_fe = U[-1]\n        \n        p = abs(u_L_fe - u_L_analytical)\n        \n    return w, p\n\ndef solve():\n    # Test cases parameters\n    \n    # Case 1\n    params1 = {\n        'L': 0.5, 'A': 2.0e-4, 'E': 70.0e9, 'alpha': 23.0e-6,\n        'delta_T_func': lambda x: 100.0, 'N_el': 10, 'bc_type': 'fixed-fixed'\n    }\n    w1, p1 = run_case(**params1)\n\n    # Case 2\n    params2 = {\n        'L': 1.2, 'A': 1.5e-4, 'E': 200.0e9, 'alpha': 12.0e-6,\n        'delta_T_func': lambda x: 30.0, 'N_el': 12, 'bc_type': 'fixed-free'\n    }\n    w2, p2 = run_case(**params2)\n\n    # Case 3\n    params3 = {\n        'L': 0.8, 'A': 1.0e-4, 'E': 210.0e9, 'alpha': 11.0e-6,\n        'delta_T_func': lambda x: 10.0 + 50.0 * x, 'N_el': 16, 'bc_type': 'fixed-fixed'\n    }\n    w3, p3 = run_case(**params3)\n\n    results = [w1, p1, w2, p2, w3, p3]\n    \n    # Format output as specified\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n\n```", "id": "2701615"}]}