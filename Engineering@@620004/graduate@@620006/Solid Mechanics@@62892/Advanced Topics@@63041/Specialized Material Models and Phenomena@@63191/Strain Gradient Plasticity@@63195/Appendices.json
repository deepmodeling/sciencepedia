{"hands_on_practices": [{"introduction": "This first exercise grounds our understanding of strain gradient plasticity in its physical origins: the behavior of dislocations. We will derive the well-known \"smaller is stronger\" phenomenon from a fundamental, mechanism-based model. By combining the Taylor dislocation hardening law with a kinematic description of geometrically necessary dislocations (GNDs), you will calculate how the yield stress of a thin film becomes dependent on its thickness, a direct consequence of plastic strain gradients. [@problem_id:2688863]", "problem": "Consider a polycrystalline metallic layer of thickness $h$ subjected to uniaxial tension along the $x$-direction, with plastic flow constrained by rigid passivation on the top and bottom surfaces located at $y=\\pm h/2$. Assume the plastic flow is uniaxial so that the only nonzero plastic strain component is $\\varepsilon_{xx}^{p}(y)$, and that constraint enforces $\\varepsilon_{xx}^{p}(\\pm h/2)=0$ while plastic flow develops in the interior. For scaling purposes, adopt the kinematically admissible piecewise linear profile\n$$\n\\varepsilon_{xx}^{p}(y)=\\varepsilon_{y}\\left(1-\\frac{2|y|}{h}\\right), \\quad |y|\\le \\frac{h}{2},\n$$\nwith $\\varepsilon_{xx}^{p}(y)=0$ outside this interval. Define the scalar effective plastic strain and its effective gradient for this one-dimensional variation by\n$$\n\\varepsilon^{p}(y)=|\\varepsilon_{xx}^{p}(y)|, \\qquad \\eta^{p}(y)=\\left|\\frac{d\\varepsilon_{xx}^{p}}{dy}\\right|.\n$$\nAdopt the Taylor dislocation model as the fundamental basis: the shear flow stress is $\\tau=\\alpha\\,\\mu\\,b\\,\\sqrt{\\rho}$, where $\\alpha$ is a dimensionless constant, $\\mu$ is the shear modulus, $b$ is the magnitude of the Burgers vector, and $\\rho=\\rho_{S}+\\rho_{G}$ is the total dislocation density, the sum of statistically stored dislocations and geometrically necessary dislocations. Use the mechanism-based strain gradient (MSG) plasticity relation for geometrically necessary dislocations, $\\rho_{G}=\\bar{r}\\,\\eta^{p}/b$, where $\\bar{r}$ is the Nye factor, and relate the tensile flow stress by $\\sigma=M\\,\\tau$ with Taylor factor $M$. Let $\\sigma_{y0}$ denote the homogeneous (no-gradient) tensile flow stress associated with the same reference plastic strain $\\varepsilon_{y}$, so that $\\sigma_{y0}=M\\,\\alpha\\,\\mu\\,b\\,\\sqrt{\\rho_{S}(\\varepsilon_{y})}$.\n\nUsing these foundations, derive the size-dependent macroscopic yield stress $\\sigma_{y}(h)$ predicted by MSG plasticity at the reference plastic strain $\\varepsilon_{y}$ by eliminating $\\rho_{S}$ in favor of $\\sigma_{y0}$ and defining the macroscopic effective plastic strain gradient as the cross-sectional average $\\bar{\\eta}^{p}=\\frac{1}{h}\\int_{-h/2}^{h/2}\\eta^{p}(y)\\,dy$.\n\nThen, compare qualitatively (in words, no calculation required) the leading-order scaling of the strengthening with $h$ to that predicted by a Fleck–Hutchinson (FH) dissipative strain gradient plasticity model in which a dissipative material length $l_{d}$ enters the effective plastic work rate as $\\sqrt{(\\dot{\\varepsilon}^{p})^{2}+l_{d}^{2}(\\dot{\\eta}^{p})^{2}}$. State, for both models, the exponent of $h$ governing the leading dependence of the strengthening in the limits of large $h$ and small $h$.\n\nProvide your final result for $\\sigma_{y}(h)$ as a closed-form analytic expression in terms of $h$, $\\sigma_{y0}$, $M$, $\\alpha$, $\\mu$, $b$, $\\bar{r}$, and $\\varepsilon_{y}$. Express the final stress in Pascals (Pa). No numerical evaluation is required.", "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of continuum mechanics and dislocation theory, well-posed, and all terms are objectively defined. We may therefore proceed with the derivation and analysis.\n\nThe problem asks for two main results:\n$1$. The derivation of the macroscopic yield stress $\\sigma_{y}(h)$ as a function of film thickness $h$ based on the mechanism-based strain gradient (MSG) plasticity model.\n$2$. A qualitative comparison of the size-dependent strengthening predicted by the MSG model with that of a Fleck–Hutchinson (FH) dissipative strain gradient plasticity model, focusing on the scaling exponents with respect to $h$.\n\nFirst, we derive the expression for $\\sigma_{y}(h)$. The derivation follows a logical sequence of steps based on the provided assumptions.\n\nStep 1: Calculate the effective plastic strain gradient $\\eta^{p}(y)$.\nThe problem provides a kinematically admissible plastic strain profile:\n$$\n\\varepsilon_{xx}^{p}(y) = \\varepsilon_{y}\\left(1-\\frac{2|y|}{h}\\right) \\quad \\text{for} \\quad |y| \\le \\frac{h}{2}\n$$\nThe effective plastic strain gradient is defined as $\\eta^{p}(y) = \\left|\\frac{d\\varepsilon_{xx}^{p}}{dy}\\right|$. We compute the derivative of $\\varepsilon_{xx}^{p}(y)$. The derivative of $|y|$ is $\\text{sgn}(y)$ for $y \\neq 0$.\n$$\n\\frac{d\\varepsilon_{xx}^{p}}{dy} = \\varepsilon_{y} \\frac{d}{dy}\\left(1-\\frac{2|y|}{h}\\right) = -\\frac{2\\varepsilon_{y}}{h} \\frac{d|y|}{dy} = -\\frac{2\\varepsilon_{y}}{h}\\text{sgn}(y)\n$$\nThe magnitude of this derivative is constant for $y \\in [-h/2, 0) \\cup (0, h/2]$:\n$$\n\\eta^{p}(y) = \\left|-\\frac{2\\varepsilon_{y}}{h}\\text{sgn}(y)\\right| = \\frac{2\\varepsilon_{y}}{h}\n$$\nThe reference strain $\\varepsilon_y$ is a positive magnitude, so $|\\varepsilon_y| = \\varepsilon_y$.\n\nStep 2: Calculate the macroscopic effective plastic strain gradient $\\bar{\\eta}^{p}$.\nThis is defined as the average of $\\eta^{p}(y)$ over the film thickness $h$:\n$$\n\\bar{\\eta}^{p} = \\frac{1}{h}\\int_{-h/2}^{h/2}\\eta^{p}(y)\\,dy\n$$\nSince $\\eta^{p}(y)$ is constant across the thickness (except at the non-differentiable point $y=0$, which has zero measure and does not affect the integral), the average is simply the constant value itself:\n$$\n\\bar{\\eta}^{p} = \\frac{1}{h}\\int_{-h/2}^{h/2} \\frac{2\\varepsilon_{y}}{h}\\,dy = \\frac{1}{h} \\left(\\frac{2\\varepsilon_{y}}{h}\\right) [y]_{-h/2}^{h/2} = \\frac{2\\varepsilon_{y}}{h^2} \\left(\\frac{h}{2} - \\left(-\\frac{h}{2}\\right)\\right) = \\frac{2\\varepsilon_{y}}{h^2}(h) = \\frac{2\\varepsilon_{y}}{h}\n$$\n\nStep 3: Determine the macroscopic dislocation densities.\nThe MSG model posits that the density of geometrically necessary dislocations (GNDs), $\\rho_{G}$, accommodates the plastic strain gradient. For the macroscopic model, we use the average gradient $\\bar{\\eta}^{p}$ to define a macroscopic GND density, $\\bar{\\rho}_{G}$:\n$$\n\\bar{\\rho}_{G} = \\frac{\\bar{r}\\,\\bar{\\eta}^{p}}{b} = \\frac{2\\bar{r}\\varepsilon_{y}}{bh}\n$$\nThe density of statistically stored dislocations (SSDs), $\\rho_{S}$, is related to the homogeneous (gradient-free) flow stress $\\sigma_{y0}$ at the same reference strain $\\varepsilon_{y}$. From the given relation $\\sigma_{y0}=M\\,\\alpha\\,\\mu\\,b\\,\\sqrt{\\rho_{S}(\\varepsilon_{y})}$, we solve for $\\rho_{S}(\\varepsilon_{y})$:\n$$\n\\rho_{S}(\\varepsilon_{y}) = \\left(\\frac{\\sigma_{y0}}{M\\,\\alpha\\,\\mu\\,b}\\right)^2\n$$\n\nStep 4: Derive the size-dependent macroscopic yield stress $\\sigma_{y}(h)$.\nThe total dislocation density for the macroscopic description is the sum of the SSD and macroscopic GND densities: $\\bar{\\rho} = \\rho_{S}(\\varepsilon_{y}) + \\bar{\\rho}_{G}$.\nThe macroscopic yield stress $\\sigma_{y}(h)$ is then found using the Taylor model with this total density:\n$$\n\\sigma_{y}(h) = M\\,\\alpha\\,\\mu\\,b\\,\\sqrt{\\bar{\\rho}} = M\\,\\alpha\\,\\mu\\,b\\,\\sqrt{\\rho_{S}(\\varepsilon_{y}) + \\bar{\\rho}_{G}}\n$$\nSubstituting the expressions for $\\rho_{S}$ and $\\bar{\\rho}_{G}$:\n$$\n\\sigma_{y}(h) = M\\,\\alpha\\,\\mu\\,b\\,\\sqrt{\\left(\\frac{\\sigma_{y0}}{M\\,\\alpha\\,\\mu\\,b}\\right)^2 + \\frac{2\\bar{r}\\varepsilon_{y}}{bh}}\n$$\nWe bring the factor $M\\,\\alpha\\,\\mu\\,b$ inside the square root to simplify:\n$$\n\\sigma_{y}(h) = \\sqrt{(M\\,\\alpha\\,\\mu\\,b)^2 \\left[ \\left(\\frac{\\sigma_{y0}}{M\\,\\alpha\\,\\mu\\,b}\\right)^2 + \\frac{2\\bar{r}\\varepsilon_{y}}{bh} \\right]} = \\sqrt{\\sigma_{y0}^2 + (M\\,\\alpha\\,\\mu\\,b)^2 \\frac{2\\bar{r}\\varepsilon_{y}}{bh}}\n$$\nThis gives the final expression for the size-dependent yield stress:\n$$\n\\sigma_{y}(h) = \\sqrt{\\sigma_{y0}^2 + \\frac{2(M\\,\\alpha\\,\\mu)^2\\,b\\,\\bar{r}\\,\\varepsilon_{y}}{h}}\n$$\nThis expression provides the yield stress in terms of the specified material and experimental parameters. The units of the expression are units of stress. If all input parameters are in SI units, the result will be in Pascals (Pa).\n\nSecond, we perform the qualitative comparison of scaling laws. The strengthening is defined as $\\Delta\\sigma(h) = \\sigma_{y}(h) - \\sigma_{y0}$.\n\nFor the MSG model, the derived stress is $\\sigma_y(h) = \\sigma_{y0} \\sqrt{1 + C/h}$, where $C = \\frac{2(M\\,\\alpha\\,\\mu)^2 b \\bar{r} \\varepsilon_y}{\\sigma_{y0}^2}$ is a constant grouping material parameters.\n- In the limit of large thickness ($h \\to \\infty$, so $C/h \\to 0$), we use the Taylor expansion $\\sqrt{1+x} \\approx 1 + x/2$. The strengthening is $\\Delta\\sigma(h) = \\sigma_{y0}(\\sqrt{1+C/h}-1) \\approx \\sigma_{y0}(1 + C/(2h) - 1) = \\sigma_{y0}C/(2h)$. Thus, the strengthening scales as $h^{-1}$. The governing exponent is $-1$.\n- In the limit of small thickness ($h \\to 0$, so $C/h \\to \\infty$), the gradient term dominates. $\\sigma_y(h) \\approx \\sigma_{y0}\\sqrt{C/h}$. As $\\sigma_y(h) \\gg \\sigma_{y0}$, the strengthening itself is essentially the total stress, $\\Delta\\sigma(h) \\approx \\sigma_y(h) \\propto h^{-1/2}$. The governing exponent is $-1/2$.\n\nFor the Fleck–Hutchinson (FH) model, it is a phenomenological higher-order theory. The specific dissipative form mentioned involves a material length scale $l_d$. For this class of models, when applied to problems of constrained plastic flow in thin films, the strengthening has a different functional form. Without detailed calculation, which is not requested, we invoke the standard result for such theories. The strengthening is typically found to be proportional to the ratio of the intrinsic material length scale to the external size parameter, i.e., $\\Delta\\sigma(h) \\propto l_d/h$.\n- This implies a scaling law of $\\Delta\\sigma(h) \\propto h^{-1}$. This dependence holds for both large and small $h$ limits within the typical range of applicability of the theory. The governing exponent is consistently $-1$.\n\nIn summary:\n- MSG plasticity predicts a transition in the strengthening exponent from $-1$ for large sizes to $-1/2$ for small sizes. This is a characteristic feature of Taylor-based models where stress is proportional to the square root of dislocation density.\n- FH-type dissipative models typically predict a single strengthening exponent of $-1$ across all sizes. This difference in scaling behavior is a key distinction between the two theoretical frameworks.\n\nFinal statement on the scaling exponents:\n- MSG Model: The exponent is $-1$ for large $h$ and $-1/2$ for small $h$.\n- FH Model: The exponent is $-1$ for both large and small $h$.", "answer": "$$\n\\boxed{\\sqrt{\\sigma_{y0}^2 + \\frac{2(M\\,\\alpha\\,\\mu)^2\\,b\\,\\bar{r}\\,\\varepsilon_{y}}{h}}}\n$$", "id": "2688863"}, {"introduction": "Moving from a specific mechanistic model to a more general and powerful framework, this practice introduces the energetic formulation of strain gradient plasticity. Using the principle of minimum potential energy and variational calculus, you will discover how material boundaries can enforce constraints on plastic flow, giving rise to \"boundary layers\" of non-uniform deformation. Your task will be to derive the governing differential equation for plastic strain and determine the characteristic thickness of this boundary layer, revealing its direct connection to the intrinsic material length scale, $\\ell$. [@problem_id:2688885]", "problem": "A thin metallic foil of thickness $t$ occupies the region $y \\in [-t/2,\\, t/2]$ and is subjected to uniform, quasi-static pure bending about the $z$-axis, producing a prescribed macroscopic curvature $\\kappa$ in the $x$-direction. Assume small strains and small rotations. The axial total strain is thus $\\varepsilon(y) = \\kappa\\, y$. Consider an energetic formulation of one-dimensional, rate-independent strain gradient plasticity (SGP), in which the Helmholtz free energy density per unit reference volume is\n$$\nw(\\varepsilon, \\varepsilon^{p}, \\varepsilon^{p}_{,y}) \\;=\\; \\tfrac{1}{2}\\, E\\,\\big(\\varepsilon - \\varepsilon^{p}\\big)^{2} \\;+\\; \\tfrac{1}{2}\\, H\\, \\big(\\varepsilon^{p}\\big)^{2} \\;+\\; \\tfrac{1}{2}\\, H\\, \\ell^{2}\\, \\big(\\varepsilon^{p}_{,y}\\big)^{2},\n$$\nwhere $E$ is the Young’s modulus, $H$ is a constant isotropic hardening modulus, $\\ell$ is a material length scale parameter, and $\\varepsilon^{p}(y)$ is the axial plastic strain. Adopt micro-hard boundary conditions at the foil surfaces, namely that the plastic strain vanishes at $y=\\pm t/2$.\n\nStarting from the principle of minimum potential energy and basic variational calculus, and assuming that $\\varepsilon^{p}(y)$ depends only on $y$, show that a boundary layer of plastic strain develops adjacent to each surface. Define the characteristic thickness $\\delta$ of this boundary layer as the $1/\\exp(1)$ decay length of the homogeneous part of the solution for $\\varepsilon^{p}(y)$, measured inward from a surface where $\\varepsilon^{p}$ is forced to vanish by the micro-hard boundary condition. Derive $\\delta$ in closed form in terms of $E$, $H$, and $\\ell$.\n\nAnswer specification:\n- Your final answer must be a single, closed-form analytic expression for $\\delta$ in terms of $E$, $H$, and $\\ell$.\n- Express $\\delta$ in meters, taking $\\ell$ in meters and $E$ and $H$ in Pascals. Do not include the unit in the final boxed expression.\n- No numerical rounding is required.", "solution": "The problem presented is a valid exercise in continuum mechanics, specifically in the field of strain gradient plasticity. It is scientifically grounded, well-posed, and contains sufficient information for a unique solution to be derived. I will now proceed with the formal derivation.\n\nThe starting point is the total potential energy of the system, which, in the context of this one-dimensional problem, is the integral of the Helmholtz free energy density, $w$, over the thickness of the foil. Let the potential energy per unit area in the $x-z$ plane be denoted by $\\Pi$.\n$$\n\\Pi[\\varepsilon^{p}] = \\int_{-t/2}^{t/2} w\\left(\\varepsilon(y), \\varepsilon^{p}(y), \\varepsilon^{p}_{,y}(y)\\right) dy\n$$\nThe problem provides the expression for the free energy density $w$ and the total strain $\\varepsilon(y) = \\kappa y$. Substituting these into the functional gives:\n$$\n\\Pi[\\varepsilon^{p}] = \\int_{-t/2}^{t/2} \\left[ \\frac{1}{2} E \\big(\\kappa y - \\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\big(\\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\ell^{2} \\big(\\varepsilon^{p}_{,y}\\big)^{2} \\right] dy\n$$\nwhere $\\varepsilon^{p}_{,y}$ denotes the derivative of the plastic strain $\\varepsilon^{p}$ with respect to the coordinate $y$.\n\nThe principle of minimum potential energy states that the equilibrium configuration of the system is the one that minimizes the functional $\\Pi[\\varepsilon^{p}]$. To find the function $\\varepsilon^{p}(y)$ that extremizes this functional, we employ the calculus of variations. The integrand, which we shall call the Lagrangian $L$, is a function of $y$, $\\varepsilon^{p}$, and $\\varepsilon^{p}_{,y}$:\n$$\nL(y, \\varepsilon^{p}, \\varepsilon^{p}_{,y}) = \\frac{1}{2} E \\big(\\kappa y - \\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\big(\\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\ell^{2} \\big(\\varepsilon^{p}_{,y}\\big)^{2}\n$$\nThe Euler-Lagrange equation for this variational problem is:\n$$\n\\frac{\\partial L}{\\partial \\varepsilon^{p}} - \\frac{d}{dy}\\left(\\frac{\\partial L}{\\partial \\varepsilon^{p}_{,y}}\\right) = 0\n$$\nWe compute the required partial derivatives of the Lagrangian $L$:\n$$\n\\frac{\\partial L}{\\partial \\varepsilon^{p}} = \\frac{\\partial}{\\partial \\varepsilon^{p}} \\left[ \\frac{1}{2} E \\big(\\kappa y - \\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\big(\\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\ell^{2} \\big(\\varepsilon^{p}_{,y}\\big)^{2} \\right] \\\\\n= E \\big(\\kappa y - \\varepsilon^{p}\\big)(-1) + H \\varepsilon^{p} = (E+H)\\varepsilon^{p} - E\\kappa y\n$$\n$$\n\\frac{\\partial L}{\\partial \\varepsilon^{p}_{,y}} = \\frac{\\partial}{\\partial \\varepsilon^{p}_{,y}} \\left[ \\frac{1}{2} E \\big(\\kappa y - \\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\big(\\varepsilon^{p}\\big)^{2} + \\frac{1}{2} H \\ell^{2} \\big(\\varepsilon^{p}_{,y}\\big)^{2} \\right] = H \\ell^{2} \\varepsilon^{p}_{,y}\n$$\nSubstituting these expressions into the Euler-Lagrange equation yields the governing ordinary differential equation (ODE) for the plastic strain $\\varepsilon^{p}(y)$:\n$$\n(E+H)\\varepsilon^{p} - E\\kappa y - \\frac{d}{dy}\\left(H \\ell^{2} \\varepsilon^{p}_{,y}\\right) = 0\n$$\nSince $H$ and $\\ell$ are constants, this simplifies to a second-order, linear, inhomogeneous ODE:\n$$\n(E+H)\\varepsilon^{p} - H \\ell^{2} \\frac{d^2\\varepsilon^{p}}{dy^2} = E\\kappa y\n$$\nRearranging the terms into standard form gives:\n$$\n\\frac{d^2\\varepsilon^{p}}{dy^2} - \\frac{E+H}{H \\ell^{2}} \\varepsilon^{p} = -\\frac{E\\kappa}{H \\ell^{2}} y\n$$\nThe problem asks for the characteristic thickness $\\delta$ of the plastic boundary layer, which is defined as the $1/\\exp(1)$ decay length of the homogeneous part of the solution for $\\varepsilon^{p}(y)$. The homogeneous part of the derived ODE is:\n$$\n\\frac{d^2\\varepsilon^{p}_{h}}{dy^2} - \\frac{E+H}{H \\ell^{2}} \\varepsilon^{p}_{h} = 0\n$$\nwhere $\\varepsilon^{p}_{h}$ is the homogeneous solution. This is a standard form of a second-order homogeneous ODE with constant coefficients. The general solution is of the form $\\varepsilon^{p}_{h}(y) = C_1 \\exp(\\lambda y) + C_2 \\exp(-\\lambda y)$, where the characteristic roots $\\lambda$ are found from the characteristic equation:\n$$\n\\lambda^2 - \\frac{E+H}{H \\ell^{2}} = 0\n$$\nSolving for $\\lambda$ gives:\n$$\n\\lambda = \\pm \\sqrt{\\frac{E+H}{H \\ell^{2}}}\n$$\nThe solution involves exponential terms of the form $\\exp(\\pm \\lambda y)$. The characteristic decay length, which we denote by $\\delta$, is the reciprocal of the magnitude of the characteristic root $\\lambda$.\n$$\n\\delta = \\frac{1}{|\\lambda|} = \\frac{1}{\\sqrt{\\frac{E+H}{H \\ell^{2}}}}\n$$\nSimplifying this expression yields the closed-form for $\\delta$:\n$$\n\\delta = \\sqrt{\\frac{H \\ell^{2}}{E+H}} = \\ell \\sqrt{\\frac{H}{E+H}}\n$$\nThis length scale, $\\delta$, governs the thickness of the boundary layers that form near the surfaces $y = \\pm t/2$ to satisfy the micro-hard boundary conditions $\\varepsilon^{p}(\\pm t/2) = 0$. The exponential terms in the homogeneous solution decay over this characteristic length, demonstrating the formation of these boundary layers, a hallmark of strain gradient plasticity theories. The parameter $\\delta$ is a combination of the conventional hardening modulus $H$, the elastic modulus $E$, and the material length scale $\\ell$ that is intrinsic to the gradient formulation. The dimensional analysis, with $E$ and $H$ in Pascals ($\\text{N}/\\text{m}^2$) and $\\ell$ in meters ($\\text{m}$), confirms that $\\delta$ has units of length, as is required.", "answer": "$$ \\boxed{\\ell \\sqrt{\\frac{H}{E+H}}} $$", "id": "2688885"}, {"introduction": "The final step in mastering a physical theory is to apply it to real-world data. In this capstone practice, you will step into the role of a materials scientist to bridge theory and experiment. Using a dataset representative of micro-pillar compression tests, you will linearize the mechanism-based strain gradient (MSG) model and use a constrained least-squares fit to estimate the material's intrinsic length scale parameter. This exercise provides critical hands-on experience in extracting material parameters, a vital skill for modern research in mechanics. [@problem_id:2688851]", "problem": "You will construct a principled estimator for a single effective material length scale in Mechanism-based Strain Gradient (MSG) plasticity from micro-pillar compression data. The estimator must be derived from first principles starting with the Taylor relation and a kinematic estimate of the plastic strain gradient, and then implemented as a constrained least-squares fit of a linearized model across pillar diameters. You will also quantify the sensitivity of the inferred length scale to the latent hardening parameter.\n\nConsider face-centered cubic (FCC) metals compressed as micro-pillars of circular cross-section with diameter $D$ (in $\\mu\\text{m}$), at a fixed equivalent plastic strain offset $\\varepsilon_p^\\star$ (dimensionless). The flow stress is $\\sigma$ (in $\\text{MPa}$). Begin from the Taylor relation for the flow stress on multiple slip systems,\n$$\\sigma = M \\,\\alpha\\, \\mu\\, b\\, \\sqrt{\\rho_S + \\rho_G},$$\nwhere $M$ is the Taylor factor (dimensionless), $\\alpha$ is the dislocation interaction coefficient (dimensionless), $\\mu$ is the shear modulus (in $\\text{MPa}$), $b$ is the magnitude of the Burgers vector (in $\\mu\\text{m}$), $\\rho_S$ is the statistically stored dislocation density (in $\\mu\\text{m}^{-2}$), and $\\rho_G$ is the geometrically necessary dislocation density (in $\\mu\\text{m}^{-2}$). The geometrically necessary dislocation density is related to a scalar measure of the equivalent plastic strain gradient $\\eta^p$ by\n$$\\rho_G = \\bar{r} \\,\\frac{\\eta^p}{b},$$\nwith $\\bar{r}$ the Nye factor (dimensionless). For micro-pillar compression at fixed offset $\\varepsilon_p^\\star$, model the dominant magnitude of the plastic strain gradient by the scaling\n$$\\eta^p \\approx c\\,\\frac{\\varepsilon_p^\\star}{D},$$\nwhere $c$ is a dimensionless geometry factor that reflects the heterogeneous plastic strain field across the pillar diameter.\n\nUse these relations to show that $\\sigma^2$ is an affine function of $1/D$. Then, given a separately measured bulk flow stress at the same plastic strain offset $\\sigma_{\\text{bulk}}$ (in $\\text{MPa}$), interpret the large-diameter limit as defining $\\rho_S$ via $\\sigma_{\\text{bulk}} = M \\alpha \\mu b \\sqrt{\\rho_S}$. Exploit this to eliminate $\\rho_S$ and enforce the intercept of the linearization in $1/D$ to be $\\sigma_{\\text{bulk}}^2$.\n\nYour program must:\n- Derive a constrained least squares estimator of the slope in the linear relation between $\\sigma^2$ and $1/D$ with the intercept fixed to $\\sigma_{\\text{bulk}}^2$, and from it compute a single effective length scale $\\ell_{\\text{hat}}$ (in $\\mu\\text{m}$) that is consistent across all diameters for one dataset.\n- For sensitivity analysis, adopt a latent hardening model in which the Taylor factor $M$ depends on the latent hardening parameter $q$ through a piecewise-linear mapping representative of random-texture FCC:\n  - At $q=1.0$, set $M=2.70$.\n  - At $q=2.0$, set $M=3.06$.\n  - For $q\\in[1.0,2.0]$, interpolate linearly between these values. For $q$ outside this range, clamp $M$ to the nearest endpoint.\n- Using the Taylor relation and the model for $\\eta^p$, show that the theory-predicted effective length is\n$$\\ell_{\\text{th}}(q) \\;=\\; \\frac{M(q)^2\\,\\alpha^2\\,\\mu^2\\, b\\, \\bar{r}\\, c\\, \\varepsilon_p^\\star}{\\sigma_{\\text{bulk}}^2},$$\nand define a sensitivity ratio\n$$r(q) \\;=\\; \\frac{\\ell_{\\text{th}}(q)}{\\ell_{\\text{hat}}}.$$\n\nImplement the above estimator and sensitivity calculation for the following test suite. In each case, use the given material constants, the pillar diameters, the measured flow stresses at the prescribed strain offset, and the listed bulk flow stress. Treat the measured flow stresses as the only data used in the constrained fit. All stresses are in $\\text{MPa}$, all diameters are in $\\mu\\text{m}$, and the final effective length must be reported in $\\mu\\text{m}$. Use the following constants for all tests (consistent units):\n- Shear modulus: $\\mu = 26000$,\n- Burgers vector magnitude (FCC): $b = 2.86\\times 10^{-4}$,\n- Dislocation interaction coefficient: $\\alpha = 0.50$,\n- Nye factor: $\\bar{r} = 1.9$,\n- Geometry factor: $c = 10.0$,\n- Plastic strain offset: $\\varepsilon_p^\\star = 0.02$.\nUse the latent hardening parameter set $q \\in \\{\\,1.0,\\,1.4,\\,1.8\\,\\}$.\n\nTest suite of datasets:\n- Case A (happy path, moderate diameters):\n  - Diameters: $[1.0,\\,2.0,\\,5.0,\\,10.0]$,\n  - Measured flow stresses: $[558.569,\\,485.077,\\,436.357,\\,418.564]$,\n  - Bulk flow stress: $\\sigma_{\\text{bulk}} = 400.0$.\n- Case B (large-diameter limit, weak size effect):\n  - Diameters: $[10.0,\\,20.0,\\,50.0,\\,100.0]$,\n  - Measured flow stresses: $[463.472,\\,456.690,\\,452.696,\\,451.351]$,\n  - Bulk flow stress: $\\sigma_{\\text{bulk}} = 450.0$.\n- Case C (small diameters, strong gradients):\n  - Diameters: $[0.5,\\,0.75,\\,1.0]$,\n  - Measured flow stresses: $[967.947,\\,862.662,\\,805.596]$,\n  - Bulk flow stress: $\\sigma_{\\text{bulk}} = 600.0$.\n\nNumerical and output requirements:\n- For each dataset, compute $\\ell_{\\text{hat}}$ (in $\\mu\\text{m}$) by minimizing the sum of squared residuals between the measured $\\sigma^2$ and the model $\\sigma_{\\text{bulk}}^2 + B/D$ with respect to the slope $B$ only. Then report $\\ell_{\\text{hat}} = B/\\sigma_{\\text{bulk}}^2$.\n- For each dataset and each $q \\in \\{\\,1.0,\\,1.4,\\,1.8\\,\\}$, compute the sensitivity ratios $r(q)$ using the formula for $\\ell_{\\text{th}}(q)$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n  $$[\\;\\ell_{\\text{hat}}^{(A)},\\; r^{(A)}(1.0),\\; r^{(A)}(1.4),\\; r^{(A)}(1.8),\\; \\ell_{\\text{hat}}^{(B)},\\; r^{(B)}(1.0),\\; r^{(B)}(1.4),\\; r^{(B)}(1.8),\\; \\ell_{\\text{hat}}^{(C)},\\; r^{(C)}(1.0),\\; r^{(C)}(1.4),\\; r^{(C)}(1.8)\\;].$$\n- Express all reported numbers in $\\mu\\text{m}$ for effective lengths and as dimensionless ratios for $r(q)$, rounded to six decimal places in the printed output.", "solution": "The problem statement is scientifically sound, well-posed, and contains all necessary information for a unique solution. We shall therefore proceed with the derivation and computation.\n\nThe objective is to derive an estimator for an effective material length scale, $\\ell_{\\text{hat}}$, from micro-pillar compression data within the framework of mechanism-based strain gradient plasticity. This involves several steps: first, establishing a linear relationship between the square of the flow stress and the inverse of the pillar diameter; second, deriving a constrained least-squares estimator for the parameters of this model; and third, performing a sensitivity analysis with respect to a latent hardening parameter.\n\n### Derivation of the Linear Model\n\nWe begin with the Taylor relation for the flow stress $\\sigma$ in a face-centered cubic (FCC) metal:\n$$ \\sigma = M \\alpha \\mu b \\sqrt{\\rho_S + \\rho_G} $$\nHere, $M$ is the Taylor factor, $\\alpha$ is a dimensionless dislocation interaction coefficient, $\\mu$ is the shear modulus, $b$ is the magnitude of the Burgers vector, $\\rho_S$ is the density of statistically stored dislocations (SSDs), and $\\rho_G$ is the density of geometrically necessary dislocations (GNDs).\n\nSquaring both sides of the equation gives a relation for the squared flow stress:\n$$ \\sigma^2 = (M \\alpha \\mu b)^2 (\\rho_S + \\rho_G) = (M \\alpha \\mu b)^2 \\rho_S + (M \\alpha \\mu b)^2 \\rho_G $$\n\nThe problem posits that the bulk flow stress, $\\sigma_{\\text{bulk}}$, corresponds to the limit of a very large pillar ($D \\to \\infty$), where the contribution from strain gradients, and thus GNDs, vanishes ($\\rho_G \\to 0$). Therefore, the bulk flow stress is related to the SSD density by:\n$$ \\sigma_{\\text{bulk}}^2 = (M \\alpha \\mu b)^2 \\rho_S $$\nThis allows us to substitute the first term in the expression for $\\sigma^2$:\n$$ \\sigma^2 = \\sigma_{\\text{bulk}}^2 + (M \\alpha \\mu b)^2 \\rho_G $$\n\nNext, we incorporate the models for GND density and the plastic strain gradient. The GND density $\\rho_G$ is related to the equivalent plastic strain gradient $\\eta^p$ through the Nye relation:\n$$ \\rho_G = \\bar{r} \\frac{\\eta^p}{b} $$\nwhere $\\bar{r}$ is the Nye factor, a dimensionless constant. For micro-pillar compression, the strain gradient $\\eta^p$ is approximated to be inversely proportional to the pillar diameter $D$:\n$$ \\eta^p \\approx c \\frac{\\varepsilon_p^\\star}{D} $$\nwhere $c$ is a dimensionless geometry factor and $\\varepsilon_p^\\star$ is the fixed plastic strain offset.\n\nSubstituting these two relations into the equation for $\\sigma^2$ yields:\n$$ \\sigma^2 = \\sigma_{\\text{bulk}}^2 + (M \\alpha \\mu b)^2 \\left( \\bar{r} \\frac{c \\varepsilon_p^\\star / D}{b} \\right) $$\n$$ \\sigma^2 = \\sigma_{\\text{bulk}}^2 + \\frac{1}{D} \\left( M^2 \\alpha^2 \\mu^2 b \\bar{r} c \\varepsilon_p^\\star \\right) $$\nThis equation is of the form $\\sigma^2 = A + B/D$, which is an affine function of $1/D$. The intercept is $A = \\sigma_{\\text{bulk}}^2$ and the slope is $B = M^2 \\alpha^2 \\mu^2 b \\bar{r} c \\varepsilon_p^\\star$.\n\n### Constrained Least-Squares Estimator\n\nWe are given a set of $n$ experimental data points $(D_i, \\sigma_i)$. We wish to fit the model $\\sigma_i^2 = \\sigma_{\\text{bulk}}^2 + B/D_i$. The intercept is fixed to the known value $\\sigma_{\\text{bulk}}^2$. We seek the value of the slope, $B$, that minimizes the sum of squared residuals.\nLet $y_i = \\sigma_i^2$ and $x_i = 1/D_i$. We can rewrite the model for the transformed variables $y'_i = y_i - \\sigma_{\\text{bulk}}^2 = \\sigma_i^2 - \\sigma_{\\text{bulk}}^2$ as a linear regression through the origin:\n$$ y'_i = B x_i $$\nThe sum of squared residuals, $S(B)$, is:\n$$ S(B) = \\sum_{i=1}^n (y'_i - B x_i)^2 $$\nTo find the minimum, we differentiate $S(B)$ with respect to $B$ and set the result to zero:\n$$ \\frac{dS}{dB} = \\sum_{i=1}^n -2x_i(y'_i - B x_i) = 0 $$\n$$ \\sum_{i=1}^n x_i y'_i - B \\sum_{i=1}^n x_i^2 = 0 $$\nSolving for $B$ gives the least-squares estimator, which we denote $B_{\\text{fit}}$:\n$$ B_{\\text{fit}} = \\frac{\\sum_{i=1}^n x_i y'_i}{\\sum_{i=1}^n x_i^2} = \\frac{\\sum_{i=1}^n (1/D_i)(\\sigma_i^2 - \\sigma_{\\text{bulk}}^2)}{\\sum_{i=1}^n (1/D_i)^2} $$\nThe problem defines the estimated effective material length scale $\\ell_{\\text{hat}}$ as:\n$$ \\ell_{\\text{hat}} = \\frac{B_{\\text{fit}}}{\\sigma_{\\text{bulk}}^2} $$\n\n### Sensitivity Analysis\n\nThe sensitivity analysis explores how the inferred length scale depends on the latent hardening parameter $q$, which influences the Taylor factor $M$.\n\nThe Taylor factor $M$ is modeled as a piecewise-linear function of $q \\in [1.0, 2.0]$:\n$$ M(q) = M(1.0) + \\frac{M(2.0) - M(1.0)}{2.0 - 1.0}(q - 1.0) $$\nUsing the given values $M(1.0) = 2.70$ and $M(2.0) = 3.06$:\n$$ M(q) = 2.70 + (3.06 - 2.70)(q - 1.0) = 2.70 + 0.36(q - 1.0) $$\nFor $q < 1.0$, $M(q)$ is clamped to $2.70$, and for $q > 2.0$, $M(q)$ is clamped to $3.06$. The specified values $q \\in \\{1.0, 1.4, 1.8\\}$ all lie within the linear interpolation region.\n\nThe theory-predicted effective length scale, $\\ell_{\\text{th}}(q)$, is derived from the theoretical expression for the slope $B$ and the definition of the length scale. The theoretical slope $B(q)$ is an explicit function of $M(q)$:\n$$ B(q) = M(q)^2 \\alpha^2 \\mu^2 b \\bar{r} c \\varepsilon_p^\\star $$\nThe theoretical length scale is then:\n$$ \\ell_{\\text{th}}(q) = \\frac{B(q)}{\\sigma_{\\text{bulk}}^2} = \\frac{M(q)^2 \\alpha^2 \\mu^2 b \\bar{r} c \\varepsilon_p^\\star}{\\sigma_{\\text{bulk}}^2} $$\nThis matches the formula given in the problem statement.\n\nFinally, the sensitivity ratio $r(q)$ is defined as the ratio of the theoretical length scale to the one estimated from data:\n$$ r(q) = \\frac{\\ell_{\\text{th}}(q)}{\\ell_{\\text{hat}}} $$\nThis ratio quantifies the agreement between the model prediction (for a given $q$) and the experimental data. A value of $r(q) \\approx 1$ indicates that the chosen value of $q$ and its corresponding $M(q)$ provide a model consistent with the observed size effect.\n\nThe implementation will now proceed by applying these derived formulas to the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the strain gradient plasticity problem by deriving an estimator\n    for the material length scale and performing a sensitivity analysis.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement\n    MU = 26000.0  # Shear modulus (MPa)\n    B_VEC = 2.86e-4  # Burgers vector magnitude (micrometers)\n    ALPHA = 0.50  # Dislocation interaction coefficient (dimensionless)\n    R_BAR = 1.9  # Nye factor (dimensionless)\n    C_GEOM = 10.0  # Geometry factor (dimensionless)\n    EPS_P_STAR = 0.02  # Plastic strain offset (dimensionless)\n\n    # Define the test cases\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"diameters\": np.array([1.0, 2.0, 5.0, 10.0]),\n            \"stresses\": np.array([558.569, 485.077, 436.357, 418.564]),\n            \"sigma_bulk\": 400.0,\n        },\n        {\n            \"name\": \"Case B\",\n            \"diameters\": np.array([10.0, 20.0, 50.0, 100.0]),\n            \"stresses\": np.array([463.472, 456.690, 452.696, 451.351]),\n            \"sigma_bulk\": 450.0,\n        },\n        {\n            \"name\": \"Case C\",\n            \"diameters\": np.array([0.5, 0.75, 1.0]),\n            \"stresses\": np.array([967.947, 862.662, 805.596]),\n            \"sigma_bulk\": 600.0,\n        },\n    ]\n\n    # Latent hardening parameter set\n    q_values = [1.0, 1.4, 1.8]\n    \n    # Store all results in a single list\n    all_results = []\n\n    def get_taylor_factor(q):\n        \"\"\"\n        Calculates the Taylor factor M(q) based on the piecewise-linear model.\n        \"\"\"\n        if q < 1.0:\n            return 2.70\n        elif q > 2.0:\n            return 3.06\n        else:\n            # Linear interpolation for q in [1.0, 2.0]\n            return 2.70 + 0.36 * (q - 1.0)\n\n    for case in test_cases:\n        D = case[\"diameters\"]\n        sigma = case[\"stresses\"]\n        sigma_bulk = case[\"sigma_bulk\"]\n        \n        # --- Step 1: Calculate the estimated length scale l_hat ---\n        \n        # Transform variables for constrained linear regression through the origin\n        # The model is y' = B * x, where y' = sigma^2 - sigma_bulk^2 and x = 1/D\n        x = 1.0 / D\n        y_prime = sigma**2 - sigma_bulk**2\n        \n        # Calculate the slope B_fit using the least-squares formula\n        numerator = np.dot(x, y_prime)\n        denominator = np.dot(x, x)\n        B_fit = numerator / denominator\n        \n        # Calculate the estimated effective length scale l_hat\n        l_hat = B_fit / (sigma_bulk**2)\n        all_results.append(l_hat)\n        \n        # --- Step 2: Perform sensitivity analysis ---\n        \n        for q in q_values:\n            # Calculate Taylor factor M(q)\n            M_q = get_taylor_factor(q)\n            \n            # Calculate the theoretical slope B(q)\n            B_theory_q = (M_q**2) * (ALPHA**2) * (MU**2) * B_VEC * R_BAR * C_GEOM * EPS_P_STAR\n            \n            # Calculate the theoretical length scale l_th(q)\n            l_th_q = B_theory_q / (sigma_bulk**2)\n            \n            # Calculate the sensitivity ratio r(q)\n            r_q = l_th_q / l_hat\n            all_results.append(r_q)\n\n    # Format the final output string\n    # All values rounded to six decimal places\n    formatted_results = [f\"{res:.6f}\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2688851"}]}