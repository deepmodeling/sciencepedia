{"hands_on_practices": [{"introduction": "The contact between two rough surfaces can be conceptually simplified by considering the interaction of a single asperity. This problem-solving practice focuses on that fundamental building block, guiding you through the derivation of the classic Hertzian contact relationships for a spherical asperity. More importantly, it challenges you to move beyond idealized theory and critically assess the model's validity by checking for the onset of plastic deformation, a crucial step for applying contact mechanics to real engineering materials [@problem_id:2915129].", "problem": "A single smooth asperity on a nominally rough surface is modeled as a rigid sphere of radius $R$ indenting an elastic isotropic half-space with effective (or composite) modulus $E^*$ under a normal force $P$. The contact is frictionless and non-adhesive, and small-strain, small-slope kinematics apply. You may treat the local summit geometry of the asperity as parabolic. The materialâ€™s yield strength is $\\sigma_y$. In multi-asperity theories of rough surface contact, this single-asperity contact constitutes the fundamental local contact element.\n\nStarting from fundamental principles of linear elasticity for axisymmetric normal contact of a smooth indenter on a half-space, namely: (i) geometric compatibility of surface profiles within the contact (gap closure equals the elastic approach), (ii) equilibrium between the applied load and the distributed contact pressure, and (iii) the standard Boussinesq solution for surface displacements under normal tractions on a half-space, derive the relations linking the contact radius $a$, approach (indentation) $\\delta$, and maximum contact pressure $p_0$ to $R$, $E^*$, and $P$. State any additional idealizations you use. Then evaluate $a$, $\\delta$, and $p_0$ numerically for\n$R=10\\,\\mu\\mathrm{m}$, $E^*=100\\,\\mathrm{GPa}$, $P=10\\,\\mathrm{mN}$, and assume $\\sigma_y=1.0\\,\\mathrm{GPa}$.\n\nFinally, critically assess whether the linear elasticity assumption is reasonable by comparing the maximum von Mises equivalent stress beneath the contact to $\\sigma_y$ using a standard elastic Hertzian contact result for axisymmetric, frictionless contact. Report your decision as an indicator $I$ defined by $I=1$ if the linear elastic assumption is reasonable and $I=0$ otherwise. Round all reported numerical quantities to three significant figures.\n\nAnswer formatting:\n- Express $a$ in $\\mu\\mathrm{m}$, $\\delta$ in $\\mathrm{nm}$, $p_0$ in $\\mathrm{GPa}$, and $I$ as the indicator $0$ or $1$.\n- Provide your final answer as a single row matrix $\\begin{pmatrix} a & \\delta & p_0 & I \\end{pmatrix}$ with no units inside the matrix.", "solution": "The problem presented is a classical exercise in contact mechanics, specifically the Hertzian theory of elastic contact between a sphere and a flat. First, the problem is validated and found to be well-posed, scientifically sound, and internally consistent. We shall now proceed with its solution. The solution is structured into three parts: first, the derivation of the governing equations from fundamental principles; second, the numerical evaluation of the contact parameters; and third, a critical assessment of the linear elasticity assumption.\n\nThe problem models an asperity as a rigid sphere of radius $R$ indenting an elastic half-space, with the combined elastic properties of the system captured by an effective modulus $E^*$. The contact is subject to a normal force $P$. We are to derive the relationships for the contact radius $a$, the indentation depth (approach) $\\delta$, and the maximum contact pressure $p_0$.\n\nThe derivation proceeds from three fundamental principles as stipulated.\n\n1.  **Geometric Compatibility**:\n    Let a coordinate system be established with its origin at the initial point of contact and the $z$-axis directed into the elastic half-space. The undeformed profile of the spherical indenter, using the allowed parabolic approximation for small slopes, is given by $z_s(r) = r^2/(2R)$, where $r$ is the radial coordinate. When an indentation of depth $\\delta$ occurs, the surface of the half-space deforms by an amount $w(r)$. For the two bodies to remain in contact within a circular region of radius $a$, the following geometric condition must be met for $r \\le a$:\n    $$w(r) + z_s(r) = \\delta$$\n    Substituting the parabolic profile gives the required shape of the deformed surface under the indenter:\n    $$w(r) = \\delta - \\frac{r^2}{2R}$$\n\n2.  **Pressure-Displacement Relationship (Boussinesq Solution)**:\n    Hertz postulated a semi-ellipsoidal (or hemispherical in 3D) pressure distribution, which has been proven to be correct for this geometry. The pressure $p(r)$ is given by:\n    $$p(r) = p_0 \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2} \\quad \\text{for } r \\le a$$\n    where $p_0$ is the maximum pressure at the center of contact ($r=0$).\n    The surface displacement $w(r)$ resulting from such a pressure distribution on an elastic half-space is a standard result derived from the Boussinesq potential solution. For the composite displacement of two bodies characterized by $E^*$, this displacement within the contact area ($r \\le a$) is:\n    $$w(r) = \\frac{\\pi p_0}{4aE^*}(2a^2 - r^2)$$\n    By equating the two expressions for $w(r)$, we enforce compatibility between the geometry and the elastic response:\n    $$\\delta - \\frac{r^2}{2R} = \\frac{\\pi p_0 a}{2E^*} - \\frac{\\pi p_0 r^2}{4aE^*}$$\n    For this identity to hold for all $r \\in [0, a]$, the coefficients of the constant terms and the $r^2$ terms on both sides must be equal.\n    Matching the coefficients of $r^2$:\n    $$\\frac{1}{2R} = \\frac{\\pi p_0}{4aE^*} \\implies p_0 = \\frac{2aE^*}{\\pi R}$$\n    Matching the constant terms:\n    $$\\delta = \\frac{\\pi p_0 a}{2E^*}$$\n    Substituting the expression for $p_0$ into the expression for $\\delta$, we obtain a purely geometric relationship between indentation and contact radius:\n    $$\\delta = \\frac{\\pi a}{2E^*} \\left( \\frac{2aE^*}{\\pi R} \\right) = \\frac{a^2}{R}$$\n\n3.  **Equilibrium**:\n    The total applied normal force $P$ must be balanced by the integral of the pressure distribution over the contact area:\n    $$P = \\int_0^a p(r) \\cdot 2\\pi r \\, dr = \\int_0^a p_0 \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2} \\cdot 2\\pi r \\, dr$$\n    Performing the integration, for instance by substituting $u = 1 - (r/a)^2$, yields:\n    $$P = \\frac{2}{3} \\pi p_0 a^2$$\n\nFrom these three derived relationships, we can express $a$, $\\delta$, and $p_0$ in terms of the given parameters $P$, $R$, and $E^*$.\nFirst, substitute $p_0 = 2aE^*/(\\pi R)$ into the force equilibrium equation:\n$$P = \\frac{2}{3}\\pi a^2 \\left(\\frac{2aE^*}{\\pi R}\\right) = \\frac{4a^3 E^*}{3R}$$\nFrom this, we solve for the contact radius $a$:\n$$a = \\left( \\frac{3PR}{4E^*} \\right)^{1/3}$$\nNow, we can find the indentation $\\delta$ and maximum pressure $p_0$:\n$$\\delta = \\frac{a^2}{R} = \\frac{1}{R} \\left( \\frac{3PR}{4E^*} \\right)^{2/3} = \\left( \\frac{9P^2}{16RE^{*2}} \\right)^{1/3}$$\n$$p_0 = \\frac{2aE^*}{\\pi R} = \\frac{2E^*}{\\pi R} \\left( \\frac{3PR}{4E^*} \\right)^{1/3} = \\left( \\frac{6P(E^*)^2}{\\pi^3 R^2} \\right)^{1/3}$$\n\nNow, we perform the numerical calculations using the provided values:\n$R = 10\\,\\mu\\mathrm{m} = 1 \\times 10^{-5}\\,\\mathrm{m}$\n$E^* = 100\\,\\mathrm{GPa} = 1 \\times 10^{11}\\,\\mathrm{Pa}$\n$P = 10\\,\\mathrm{mN} = 1 \\times 10^{-2}\\,\\mathrm{N}$\n$\\sigma_y = 1.0\\,\\mathrm{GPa} = 1 \\times 10^9\\,\\mathrm{Pa}$\n\nContact radius $a$:\n$$a = \\left( \\frac{3(1 \\times 10^{-2}\\,\\mathrm{N})(1 \\times 10^{-5}\\,\\mathrm{m})}{4(1 \\times 10^{11}\\,\\mathrm{Pa})} \\right)^{1/3} = \\left( \\frac{3 \\times 10^{-7}}{4 \\times 10^{11}} \\right)^{1/3} = (0.75 \\times 10^{-18})^{1/3}\\,\\mathrm{m}$$\n$$a \\approx 0.90856 \\times 10^{-6}\\,\\mathrm{m} = 0.90856\\,\\mu\\mathrm{m}$$\nTo three significant figures, $a = 0.909\\,\\mu\\mathrm{m}$.\n\nIndentation depth $\\delta$:\n$$\\delta = \\frac{a^2}{R} = \\frac{(0.90856 \\times 10^{-6}\\,\\mathrm{m})^2}{1 \\times 10^{-5}\\,\\mathrm{m}} \\approx 8.2548 \\times 10^{-8}\\,\\mathrm{m} = 82.548\\,\\mathrm{nm}$$\nTo three significant figures, $\\delta = 82.5\\,\\mathrm{nm}$.\n\nMaximum pressure $p_0$:\n$$p_0 = \\frac{3P}{2\\pi a^2} = \\frac{3(1 \\times 10^{-2}\\,\\mathrm{N})}{2\\pi(0.90856 \\times 10^{-6}\\,\\mathrm{m})^2} \\approx 5.784 \\times 10^9\\,\\mathrm{Pa} = 5.784\\,\\mathrm{GPa}$$\nTo three significant figures, $p_0 = 5.78\\,\\mathrm{GPa}$.\n\nFinally, we assess the validity of the linear elastic assumption. Plastic yielding is predicted to initiate when the maximum von Mises equivalent stress, $\\sigma_{\\text{vM,max}}$, reaches the material's yield strength, $\\sigma_y$. For a Hertzian point contact, yielding begins subsurface. The maximum von Mises stress is proportional to the maximum contact pressure $p_0$. The exact relationship depends on the Poisson's ratio, $\\nu$, of the elastic material, which is not provided. We make the standard idealization of assuming $\\nu=0.3$, a typical value for metals. For this value, the maximum von Mises stress is located at a depth of approximately $z \\approx 0.48a$ and is given by:\n$$\\sigma_{\\text{vM,max}} \\approx 0.6 \\, p_0$$\nUsing our calculated value for $p_0$:\n$$\\sigma_{\\text{vM,max}} \\approx 0.6 \\times 5.78\\,\\mathrm{GPa} \\approx 3.47\\,\\mathrm{GPa}$$\nWe must compare this value to the material's yield strength, $\\sigma_y = 1.0\\,\\mathrm{GPa}$.\nSince $\\sigma_{\\text{vM,max}} \\approx 3.47\\,\\mathrm{GPa}$ is significantly greater than $\\sigma_y = 1.0\\,\\mathrm{GPa}$, substantial plastic deformation is expected to occur. Therefore, the assumption of purely linear elastic behavior is not reasonable under these loading conditions. The contact is in the elastic-plastic regime.\nThis leads to the conclusion that the indicator $I$, which is $1$ if the assumption is reasonable and $0$ otherwise, must be $0$.\n\nThe final results, rounded to three significant figures, are:\n-   $a = 0.909\\,\\mu\\mathrm{m}$\n-   $\\delta = 82.5\\,\\mathrm{nm}$\n-   $p_0 = 5.78\\,\\mathrm{GPa}$\n-   $I = 0$", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.909 & 82.5 & 5.78 & 0 \\end{pmatrix} } $$", "id": "2915129"}, {"introduction": "With the mechanics of a single asperity established, the next challenge is to model the collective behavior of an entire population of asperities. This exercise introduces the powerful Greenwood-Williamson (GW) framework, which merges deterministic Hertzian mechanics with statistical descriptions of surface topography [@problem_id:2915129]. You will derive the integral forms for key macroscopic quantitiesâ€”number of contacts, true contact area, and loadâ€”and learn the essential skill of non-dimensionalization to create a universal model [@problem_id:2682372].", "problem": "A nominally flat rough surface is modeled using the Greenwoodâ€“Williamson (GW) model (Greenwoodâ€“Williamson). The summit heights of the surface, measured from the mean plane, are assumed independently and identically distributed according to a Gaussian probability density with zero mean and standard deviation $\\,\\sigma\\,$,\n$$\n\\phi(z)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{z^{2}}{2\\sigma^{2}}\\right).\n$$\nSummits are assumed spherical with a common radius of curvature $\\,R\\,$ and areal number density $\\,\\eta\\,$ (number of summits per unit nominal area). The surface is pressed against a rigid plane to a mean plane separation $\\,d\\,$. An individual summit of height $\\,z\\,$ is in contact if and only if $\\,z>d\\,$, with indentation $\\,\\delta=z-d\\,$. For a contacting summit, Hertzian contact applies: the micro-contact area and load for indentation $\\,\\delta\\,$ are\n$$\na(\\delta)=\\pi R\\,\\delta,\\qquad p(\\delta)=\\frac{4}{3}\\,E^{*}\\,R^{1/2}\\,\\delta^{3/2},\n$$\nwhere $\\,E^{*}\\,$ is the effective elastic modulus in normal contact. Consider a nominal apparent area $\\,A_{0}\\,$ that contains, on average, $\\,\\eta A_{0}\\,$ summits.\n\nStarting from these definitions and first principles of probability and Hertzian normal contact, derive expressions for:\n- the expected number of contacting summits $\\,N\\,$ over $\\,A_{0}\\,$,\n- the total true contact area $\\,A\\,$ over $\\,A_{0}\\,$,\n- the total normal load $\\,W\\,$ carried over $\\,A_{0}\\,$,\n\nas integrals over the summit height variable $\\,z\\,$. Then, perform a rigorous non-dimensionalization by introducing the normalized variables $\\,\\bar{z}=z/\\sigma\\,$ and $\\,\\bar{d}=d/\\sigma\\,$, and rewrite the three quantities in the following dimensionless forms:\n$$\n\\frac{N}{\\eta A_{0}},\\qquad \\frac{A}{\\eta A_{0}\\,\\pi R\\,\\sigma},\\qquad \\frac{W}{\\eta A_{0}\\,E^{*}\\,R^{1/2}\\,\\sigma^{3/2}}.\n$$\nExpress each of these ratios explicitly as an integral in the variable $\\,\\bar{z}\\,$ involving only $\\,\\bar{d}\\,$, the standard normal density $\\,\\frac{1}{\\sqrt{2\\pi}}\\exp(-\\bar{z}^{2}/2)\\,$, and numerical (dimensionless) constants.\n\nProvide your final answer as a single row matrix containing, in order,\n$$\n\\left(\\frac{N}{\\eta A_{0}},\\ \\frac{A}{\\eta A_{0}\\,\\pi R\\,\\sigma},\\ \\frac{W}{\\eta A_{0}\\,E^{*}\\,R^{1/2}\\,\\sigma^{3/2}}\\right),\n$$\nexpressed purely in terms of $\\,\\bar{d}\\,$ and the standard normal density as specified. Do not include any units in the final answer. No numerical evaluation is required, and no rounding is necessary.", "solution": "The Greenwoodâ€“Williamson (GW) model treats the rough surface as a random ensemble of spherical summits. The statistical input is the summit height probability density function (Gaussian) and the areal summit density $\\,\\eta\\,$. The mechanistic input is Hertzian normal contact for a spherical asperity with radius $\\,R\\,$ pressing into a rigid plane.\n\nFundamental probabilistic modeling:\n- The expected number of summits in $\\,A_{0}\\,$ with heights in $[z,z+dz]$ is $\\,\\eta A_{0}\\,\\phi(z)\\,dz\\,$.\n- A summit is in contact if $\\,z>d\\,$, with indentation $\\,\\delta=z-d>0\\,$.\n\nFundamental Hertzian relations for a single spherical summit:\n- Micro-contact area for indentation $\\,\\delta\\,$ is $\\,a(\\delta)=\\pi R\\,\\delta\\,$.\n- Micro-contact load for indentation $\\,\\delta\\,$ is $\\,p(\\delta)=\\frac{4}{3}E^{*}R^{1/2}\\delta^{3/2}\\,$.\n\nTherefore, by linearity of expectation and integrating over all contacting heights $\\,z>d\\,$:\n1) Expected number of contacting summits:\n$$\nN=\\int_{d}^{\\infty}\\bigl(\\eta A_{0}\\,\\phi(z)\\bigr)\\,dz=\\eta A_{0}\\int_{d}^{\\infty}\\phi(z)\\,dz.\n$$\n\n2) Total true contact area:\nFor summits at height $\\,z\\,$, the indentation is $\\,\\delta=z-d\\,$, hence the micro-area is $\\,a(z-d)=\\pi R(z-d)\\,$. Summing (integrating) over contacting heights:\n$$\nA=\\int_{d}^{\\infty}\\bigl(\\eta A_{0}\\,\\phi(z)\\bigr)\\,\\pi R\\,(z-d)\\,dz\n=\\eta A_{0}\\,\\pi R\\int_{d}^{\\infty}(z-d)\\,\\phi(z)\\,dz.\n$$\n\n3) Total normal load:\nSimilarly, the micro-load is $\\,p(z-d)=\\frac{4}{3}E^{*}R^{1/2}(z-d)^{3/2}\\,$, so\n$$\nW=\\int_{d}^{\\infty}\\bigl(\\eta A_{0}\\,\\phi(z)\\bigr)\\,\\frac{4}{3}E^{*}R^{1/2}\\,(z-d)^{3/2}\\,dz\n=\\eta A_{0}\\,\\frac{4}{3}E^{*}R^{1/2}\\int_{d}^{\\infty}(z-d)^{3/2}\\,\\phi(z)\\,dz.\n$$\n\nThese are the Greenwoodâ€“Williamson integrals in dimensional variables. We now non-dimensionalize using the normalized variables\n$$\n\\bar{z}=\\frac{z}{\\sigma},\\qquad \\bar{d}=\\frac{d}{\\sigma}.\n$$\nUnder this change of variables, $\\,z=\\sigma\\bar{z}\\,$, $\\,dz=\\sigma\\,d\\bar{z}\\,$, and the Gaussian density transforms as\n$$\n\\phi(z)\\,dz=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{z^{2}}{2\\sigma^{2}}\\right)\\,\\sigma\\,d\\bar{z}\n=\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{\\bar{z}^{2}}{2}\\right)\\,d\\bar{z}.\n$$\nDefine the standard normal density in the nondimensional variable as\n$$\n\\varphi(\\bar{z})=\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{\\bar{z}^{2}}{2}\\right).\n$$\nAlso $\\,z-d=\\sigma(\\bar{z}-\\bar{d})\\,$, so the integrands involving indentation powers scale as $\\,\\sigma^{m}(\\bar{z}-\\bar{d})^{m}\\,$ for exponent $\\,m\\,$.\n\nApplying the change of variables:\n\n1) Number of contacts:\n$$\nN=\\eta A_{0}\\int_{\\bar{d}}^{\\infty}\\varphi(\\bar{z})\\,d\\bar{z}.\n$$\nHence the dimensionless ratio is\n$$\n\\frac{N}{\\eta A_{0}}=\\int_{\\bar{d}}^{\\infty}\\varphi(\\bar{z})\\,d\\bar{z}.\n$$\n\n2) Total true contact area:\n$$\nA=\\eta A_{0}\\,\\pi R\\int_{d}^{\\infty}(z-d)\\,\\phi(z)\\,dz\n=\\eta A_{0}\\,\\pi R\\int_{\\bar{d}}^{\\infty}\\bigl[\\sigma(\\bar{z}-\\bar{d})\\bigr]\\varphi(\\bar{z})\\,d\\bar{z}\n=\\eta A_{0}\\,\\pi R\\,\\sigma\\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})\\,\\varphi(\\bar{z})\\,d\\bar{z}.\n$$\nTherefore,\n$$\n\\frac{A}{\\eta A_{0}\\,\\pi R\\,\\sigma}=\\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})\\,\\varphi(\\bar{z})\\,d\\bar{z}.\n$$\n\n3) Total load:\n$$\nW=\\eta A_{0}\\,\\frac{4}{3}E^{*}R^{1/2}\\int_{d}^{\\infty}(z-d)^{3/2}\\,\\phi(z)\\,dz\n=\\eta A_{0}\\,\\frac{4}{3}E^{*}R^{1/2}\\int_{\\bar{d}}^{\\infty}\\bigl[\\sigma(\\bar{z}-\\bar{d})\\bigr]^{3/2}\\,\\varphi(\\bar{z})\\,d\\bar{z}.\n$$\nExtracting the factor $\\,\\sigma^{3/2}\\,$ gives\n$$\nW=\\eta A_{0}\\,\\frac{4}{3}E^{*}R^{1/2}\\,\\sigma^{3/2}\\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})^{3/2}\\,\\varphi(\\bar{z})\\,d\\bar{z},\n$$\nso that\n$$\n\\frac{W}{\\eta A_{0}\\,E^{*}\\,R^{1/2}\\,\\sigma^{3/2}}=\\frac{4}{3}\\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})^{3/2}\\,\\varphi(\\bar{z})\\,d\\bar{z}.\n$$\n\nCollecting the three required nondimensional expressions in the requested order, we have\n$$\n\\left(\\frac{N}{\\eta A_{0}},\\ \\frac{A}{\\eta A_{0}\\,\\pi R\\,\\sigma},\\ \\frac{W}{\\eta A_{0}\\,E^{*}\\,R^{1/2}\\,\\sigma^{3/2}}\\right)\n=\\left(\\int_{\\bar{d}}^{\\infty}\\varphi(\\bar{z})\\,d\\bar{z},\\ \\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})\\,\\varphi(\\bar{z})\\,d\\bar{z},\\ \\frac{4}{3}\\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})^{3/2}\\,\\varphi(\\bar{z})\\,d\\bar{z}\\right),\n$$\nwith $\\,\\varphi(\\bar{z})=(1/\\sqrt{2\\pi})\\exp(-\\bar{z}^{2}/2)\\,$. These involve only the nondimensional separation $\\,\\bar{d}\\,$ and numerical constants, as required.", "answer": "$$\\boxed{\\begin{pmatrix}\n\\displaystyle \\int_{\\bar{d}}^{\\infty}\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{\\bar{z}^{2}}{2}\\right)\\,d\\bar{z} & \\displaystyle \\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})\\,\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{\\bar{z}^{2}}{2}\\right)\\,d\\bar{z} & \\displaystyle \\frac{4}{3}\\int_{\\bar{d}}^{\\infty}(\\bar{z}-\\bar{d})^{3/2}\\,\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{\\bar{z}^{2}}{2}\\right)\\,d\\bar{z}\n\\end{pmatrix}}$$", "id": "2682372"}, {"introduction": "Theoretical models gain their full power when they can be used for quantitative prediction and design. This final practice moves from derivation to application, challenging you to implement the Greenwood-Williamson model computationally. Through a systematic sensitivity analysis, you will develop a practical understanding of how surface texture parameters ($\\eta$, $R$, and $\\sigma$) govern the macroscopic contact response, honing valuable skills in numerical methods and data-driven modeling [@problem_id:2682384].", "problem": "Consider the classical contact between a nominally flat elastic half-space and a rigid rough surface whose summit asperities are idealized as identical spheres. Adopt the following foundational base, and do not use any pre-derived model-specific shortcuts beyond these fundamentals.\n\n1. Single-asperity elastic contact is governed by axisymmetric Hertz theory for a sphere of radius $R$ indenting a flat elastic half-space with composite elastic modulus $E^\\ast$. If the normal approach between the sphere and flat is $\\delta \\ge 0$, then the contact radius, real contact area, and normal load for the single asperity follow directly from the standard Hertz relations.\n2. The summits (asperity peaks) are assumed to be located at geometric positions with number density $\\eta$ per unit nominal area, have identical spherical radius $R$, and their heights (measured from the mean plane) are independent and identically distributed as a Gaussian (normal) random field with mean zero and standard deviation $\\sigma$. That is, the summit height $h$ has probability density function $\\varphi(h) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{h^2}{2\\sigma^2}\\right)$.\n3. Let the mean plane separation be $d$. Only summits with $h \\gt d$ are in contact. For these summits, the interference is $\\delta = h - d$.\n\nTask A (derivation requirement to guide implementation):\nStarting from the above base (Hertz theory and the Gaussian summit height distribution), and using only these definitions, derive expressions for:\n- the total real contact area per unit nominal area, denoted $A/A_0$, as a function of the nondimensional separation $W := d/\\sigma$,\n- the total normal contact load per unit nominal area, denoted $P/A_0$, as a function of $W$,\n- and the normal contact stiffness per unit nominal area, defined as $K_n(W) := -\\frac{\\partial}{\\partial d}\\left(P/A_0\\right)$, expressed as a function of $W$.\n\nAll final expressions in your implementation must be obtained by directly combining the Hertz relations with the Gaussian statistics by appropriate integration over the contacting summit population, without introducing any additional empirical fitting.\n\nTask B (computational implementation and sensitivity analysis):\nImplement a program that evaluates $A(W)$ and $K_n(W)$ numerically for prescribed parameter ranges by direct numerical integration implied by your derivation in Task A. Use the following specifications.\n\n- Material and geometric constants:\n  - Composite elastic modulus $E^\\ast = 1.00 \\times 10^{11}$ in Pascals.\n  - Nominal (apparent) area $A_0$ is used only to normalize quantities; report $A(W)$ as $A/A_0$ (dimensionless), and $K_n(W)$ as $K_n/A_0$ but post-processed as described below so that all reported metrics are dimensionless.\n- Parameters to vary:\n  - Summit density $\\eta$ in $\\mathrm{m}^{-2}$.\n  - Summit radius $R$ in $\\mathrm{m}$.\n  - Summit height standard deviation $\\sigma$ in $\\mathrm{m}$.\n- Nondimensional separation grid:\n  - Use the set $W \\in \\{0.0,\\,0.5,\\,1.0,\\,1.5,\\,2.0,\\,3.0,\\,4.0\\}$ (dimensionless).\n\nFor each test case below, construct a sensitivity study and response surfaces as follows.\n\n1. Sampling in parameter space:\n   - For each parameter range $[x_{\\min}, x_{\\max}]$, select three log-uniform levels $\\{x_{\\min}, \\sqrt{x_{\\min}x_{\\max}}, x_{\\max}\\}$. Form the full $3\\times 3\\times 3$ factorial grid across $\\eta$, $R$, and $\\sigma$.\n   - For each grid point and each $W$ in the specified set, compute:\n     - $A(W)$ as $A/A_0$ (dimensionless),\n     - $K_n(W)$ as $K_n/A_0$ in $\\mathrm{Pa/m}$. Then transform these responses using base-10 logarithms to produce $\\log_{10} A(W)$ and $\\log_{10} K_n(W)$, rendering both responses dimensionless for regression and error reporting.\n\n2. Response surface model (for each $W$ and each response separately):\n   - Use the predictors $\\mathbf{x} = [\\log_{10}\\eta,\\ \\log_{10}R,\\ \\log_{10}\\sigma]$.\n   - Fit a second-order polynomial (quadratic) response surface\n     $$\\hat{y}(\\mathbf{x}) = c_0 + c_1 x_1 + c_2 x_2 + c_3 x_3 + c_4 x_1^2 + c_5 x_2^2 + c_6 x_3^2 + c_7 x_1 x_2 + c_8 x_1 x_3 + c_9 x_2 x_3,$$\n     where $y$ is either $\\log_{10} A(W)$ or $\\log_{10} K_n(W)$. Use ordinary least squares.\n\n3. Error metric:\n   - For each response and each $W$, compute the root-mean-square error (RMSE) between the true $\\log_{10}$ response values and the quadratic model predictions over the $27$ factorial points. Average the RMSE over all $W$ values to obtain a single average RMSE per response for the test case. Report these two average RMSE values (for $\\log_{10} A$ and for $\\log_{10} K_n$). Both RMSE values are dimensionless.\n\n4. Local gradient-based sensitivities at the center:\n   - At the geometric center of each parameter cube, i.e., at $\\mathbf{x}_0 = [\\log_{10}\\sqrt{\\eta_{\\min}\\eta_{\\max}},\\, \\log_{10}\\sqrt{R_{\\min}R_{\\max}},\\, \\log_{10}\\sqrt{\\sigma_{\\min}\\sigma_{\\max}}]$, and at $W=1.0$, compute from the fitted quadratic models the gradients\n     $$\\left.\\frac{\\partial \\log_{10}A}{\\partial \\log_{10}\\eta}\\right|_{\\mathbf{x}_0},\\ \\left.\\frac{\\partial \\log_{10}A}{\\partial \\log_{10}R}\\right|_{\\mathbf{x}_0},\\ \\left.\\frac{\\partial \\log_{10}A}{\\partial \\log_{10}\\sigma}\\right|_{\\mathbf{x}_0},$$\n     $$\\left.\\frac{\\partial \\log_{10}K_n}{\\partial \\log_{10}\\eta}\\right|_{\\mathbf{x}_0},\\ \\left.\\frac{\\partial \\log_{10}K_n}{\\partial \\log_{10}R}\\right|_{\\mathbf{x}_0},\\ \\left.\\frac{\\partial \\log_{10}K_n}{\\partial \\log_{10}\\sigma}\\right|_{\\mathbf{x}_0}.$$\n   - These six sensitivities are dimensionless.\n\nTest suite:\nProvide results for the following three test cases (distinct parameter ranges). In all cases, take $E^\\ast = 1.00 \\times 10^{11}\\ \\mathrm{Pa}$.\n\n- Case 1 (typical engineering roughness):\n  - $\\eta \\in [1.0\\times 10^{8},\\ 4.0\\times 10^{8}]$ in $\\mathrm{m}^{-2}$,\n  - $R \\in [5.0\\times 10^{-6},\\ 2.0\\times 10^{-5}]$ in $\\mathrm{m}$,\n  - $\\sigma \\in [2.0\\times 10^{-7},\\ 1.0\\times 10^{-6}]$ in $\\mathrm{m}$.\n\n- Case 2 (smoother and sparser surface):\n  - $\\eta \\in [1.0\\times 10^{6},\\ 5.0\\times 10^{6}]$ in $\\mathrm{m}^{-2}$,\n  - $R \\in [1.0\\times 10^{-6},\\ 5.0\\times 10^{-6}]$ in $\\mathrm{m}$,\n  - $\\sigma \\in [5.0\\times 10^{-8},\\ 2.0\\times 10^{-7}]$ in $\\mathrm{m}$.\n\n- Case 3 (dense and blunt asperities):\n  - $\\eta \\in [1.0\\times 10^{9},\\ 3.0\\times 10^{9}]$ in $\\mathrm{m}^{-2}$,\n  - $R \\in [5.0\\times 10^{-5},\\ 2.0\\times 10^{-4}]$ in $\\mathrm{m}$,\n  - $\\sigma \\in [1.0\\times 10^{-6},\\ 3.0\\times 10^{-6}]$ in $\\mathrm{m}$.\n\nFinal output format:\nYour program should produce a single line of output containing, for each test case in the order Case 1, Case 2, Case 3, the following eight dimensionless floats in sequence:\n- average RMSE over $W$ for $\\log_{10} A$,\n- average RMSE over $W$ for $\\log_{10} K_n$,\n- $\\left.\\frac{\\partial \\log_{10}A}{\\partial \\log_{10}\\eta}\\right|_{W=1,\\ \\mathbf{x}_0}$,\n- $\\left.\\frac{\\partial \\log_{10}A}{\\partial \\log_{10}R}\\right|_{W=1,\\ \\mathbf{x}_0}$,\n- $\\left.\\frac{\\partial \\log_{10}A}{\\partial \\log_{10}\\sigma}\\right|_{W=1,\\ \\mathbf{x}_0}$,\n- $\\left.\\frac{\\partial \\log_{10}K_n}{\\partial \\log_{10}\\eta}\\right|_{W=1,\\ \\mathbf{x}_0}$,\n- $\\left.\\frac{\\partial \\log_{10}K_n}{\\partial \\log_{10}R}\\right|_{W=1,\\ \\mathbf{x}_0}$,\n- $\\left.\\frac{\\partial \\log_{10}K_n}{\\partial \\log_{10}\\sigma}\\right|_{W=1,\\ \\mathbf{x}_0}$.\n\nAggregate all $3\\times 8=24$ numbers into a single comma-separated list enclosed in square brackets, for example:\n\"[r1,r2,r3,...,r24]\".\nAll reported numbers are dimensionless because they are expressed in base-10 logarithmic units for both responses and predictors. No physical units need to be included in the output line.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on the classical Greenwood-Williamson model of elastic rough surface contact, which is a cornerstone of tribology. The assumptions are standard, the parameters are physically plausible, and the tasks are specified with sufficient precision for a unique and meaningful solution to be determined. The problem is valid and we proceed with its solution.\n\nThe solution requires two stages: first, the derivation of the necessary physical quantities from fundamental principles as specified, and second, the numerical implementation and analysis.\n\n**Task A: Derivation of Contact Metrics**\n\nThe model assumes a rigid rough surface with a Gaussian distribution of summit heights pressing against a flat elastic half-space. The summit heights $h$ are measured from a mean plane and follow the probability density function (PDF) $\\varphi(h) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp(-\\frac{h^2}{2\\sigma^2})$, where $\\sigma$ is the standard deviation of summit heights. Let $d$ be the separation between the mean plane of the summits and the rigid flat. A summit makes contact only if its height $h$ is greater than $d$. The local interference or compression is thus $\\delta = h - d$ for $h > d$. All summits are spherical with radius $R$. The contact behavior of a single asperity is governed by Hertzian theory, yielding a contact area $A_{asp} = \\pi R \\delta$ and a contact load $P_{asp} = \\frac{4}{3} E^\\ast R^{1/2} \\delta^{3/2}$, where $E^\\ast$ is the composite elastic modulus.\n\nThe total expected value of any contact metric is obtained by integrating the contribution from a single asperity over the population of contacting summits. The number of summits per unit nominal area with heights in the interval $[h, h+dh]$ is $\\eta \\varphi(h) dh$, where $\\eta$ is the number density of summits.\n\nFor convenience, we introduce the normalized height $s = h/\\sigma$ and the normalized separation $W = d/\\sigma$. The standard normal PDF is $\\phi(s) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-s^2/2)$. The condition for contact $h > d$ becomes $s > W$.\n\n1.  **Total Real Contact Area per Unit Nominal Area ($A/A_0$)**\n    The total area is the sum of individual asperity contact areas. The expected area per unit nominal area, $A/A_0$, is:\n    $$ \\frac{A}{A_0} = \\eta \\int_d^\\infty A_{asp}(h-d) \\varphi(h) \\,dh = \\eta \\int_d^\\infty \\pi R (h-d) \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-\\frac{h^2}{2\\sigma^2}} \\,dh $$\n    Changing variables to $s = h/\\sigma$ and $W = d/\\sigma$:\n    $$ \\frac{A}{A_0}(W) = \\eta \\pi R \\int_W^\\infty (\\sigma s - \\sigma W) \\frac{1}{\\sqrt{2\\pi}} e^{-s^2/2} \\,ds = \\eta \\pi R \\sigma \\int_W^\\infty (s - W) \\phi(s) \\,ds $$\n    We define the Greenwood-Williamson statistical integral of order $k$ as $F_k(W) = \\int_W^\\infty (s-W)^k \\phi(s) \\,ds$.\n    The expression for the normalized real contact area is thus:\n    $$ \\frac{A}{A_0}(W) = \\eta \\pi R \\sigma F_1(W) $$\n\n2.  **Total Normal Contact Load per Unit Nominal Area ($P/A_0$)**\n    Similarly, the expected load per unit nominal area, $P/A_0$, is found by integrating the single-asperity load:\n    $$ \\frac{P}{A_0} = \\eta \\int_d^\\infty P_{asp}(h-d) \\varphi(h) \\,dh = \\eta \\int_d^\\infty \\frac{4}{3} E^\\ast R^{1/2} (h-d)^{3/2} \\varphi(h) \\,dh $$\n    Changing variables to $s$ and $W$:\n    $$ \\frac{P}{A_0}(W) = \\eta \\frac{4}{3} E^\\ast R^{1/2} \\int_W^\\infty (\\sigma s - \\sigma W)^{3/2} \\phi(s) \\,ds = \\frac{4}{3} \\eta E^\\ast R^{1/2} \\sigma^{3/2} \\int_W^\\infty (s - W)^{3/2} \\phi(s) \\,ds $$\n    In terms of the statistical integral, this is:\n    $$ \\frac{P}{A_0}(W) = \\frac{4}{3} \\eta E^\\ast R^{1/2} \\sigma^{3/2} F_{3/2}(W) $$\n\n3.  **Normal Contact Stiffness per Unit Nominal Area ($K_n/A_0$)**\n    The stiffness is defined as the negative rate of change of load with separation, $K_n = - \\frac{\\partial P}{\\partial d}$. The stiffness per unit nominal area is $K_n/A_0 = -\\frac{\\partial}{\\partial d}(P/A_0)$. We apply the Leibniz integral rule to the expression for $P/A_0(d)$:\n    $$ \\frac{\\partial}{\\partial d} \\left(\\frac{P}{A_0}\\right) = \\eta \\frac{4}{3} E^\\ast R^{1/2} \\frac{\\partial}{\\partial d} \\left[ \\int_d^\\infty (h-d)^{3/2} \\varphi(h) \\,dh \\right] $$\n    $$ \\frac{\\partial}{\\partial d} \\left(\\frac{P}{A_0}\\right) = \\eta \\frac{4}{3} E^\\ast R^{1/2} \\left[ \\int_d^\\infty \\frac{\\partial}{\\partial d}(h-d)^{3/2} \\varphi(h) \\,dh - (d-d)^{3/2}\\varphi(d) \\right] $$\n    The boundary term is zero. The derivative of the integrand is $-\\frac{3}{2}(h-d)^{1/2}$.\n    $$ \\frac{\\partial}{\\partial d} \\left(\\frac{P}{A_0}\\right) = - \\eta \\frac{4}{3} E^\\ast R^{1/2} \\frac{3}{2} \\int_d^\\infty (h-d)^{1/2} \\varphi(h) \\,dh = -2 \\eta E^\\ast R^{1/2} \\int_d^\\infty (h-d)^{1/2} \\varphi(h) \\,dh $$\n    Therefore, the stiffness per unit area is:\n    $$ \\frac{K_n}{A_0} = - \\frac{\\partial}{\\partial d} \\left(\\frac{P}{A_0}\\right) = 2 \\eta E^\\ast R^{1/2} \\int_d^\\infty (h-d)^{1/2} \\varphi(h) \\,dh $$\n    In non-dimensional form, this becomes:\n    $$ \\frac{K_n}{A_0}(W) = 2 \\eta E^\\ast R^{1/2} \\sigma^{1/2} \\int_W^\\infty (s-W)^{1/2} \\phi(s) \\,ds = 2 \\eta E^\\ast \\sqrt{R\\sigma} F_{1/2}(W) $$\n\n**Task B: Computational Implementation**\n\nThe implementation follows the derived formulae. For each test case, we perform a sensitivity study.\n\nFirst, a $3 \\times 3 \\times 3$ full factorial sampling grid is created for the parameters $\\eta$, $R$, and $\\sigma$. The levels for each parameter $[x_{min}, x_{max}]$ are chosen to be log-uniform: $\\{x_{min}, \\sqrt{x_{min}x_{max}}, x_{max}\\}$. This results in $27$ parameter combinations.\n\nFor each of these $27$ combinations, and for each specified non-dimensional separation $W$, the quantities $A(W)/A_0$ and $K_n(W)/A_0$ are computed by numerically evaluating the integrals $F_1(W)$ and $F_{1/2}(W)$ using `scipy.integrate.quad`. The responses are then transformed via the base-10 logarithm: $y_A = \\log_{10}(A/A_0)$ and $y_{K_n} = \\log_{10}(K_n/A_0)$. Although taking the logarithm of a dimensional quantity like $K_n/A_0$ (in units of Pa/m) is formally imprecise, it is a standard practice in engineering log-log analysis and does not affect the calculation of the dimensionless sensitivities.\n\nFor each response ($y_A$ and $y_{K_n}$) and for each value of $W$, a second-order polynomial response surface model is fitted to the $27$ data points. The predictors for this model are the base-$10$ logarithms of the input parameters, $\\mathbf{x} = [\\log_{10}\\eta, \\log_{10}R, \\log_{10}\\sigma]$. The model has the form:\n$\\hat{y}(\\mathbf{x}) = c_0 + \\sum_{i=1}^3 c_i x_i + \\sum_{i=1}^3 c_{i+3} x_i^2 + c_7 x_1 x_2 + c_8 x_1 x_3 + c_9 x_2 x_3$.\nThe $10$ coefficients $\\mathbf{c}$ are determined using ordinary least squares regression.\n\nThe root-mean-square error (RMSE) between the model predictions $\\hat{y}$ and the true computed values $y$ is calculated for each $W$. These RMSE values are then averaged over all $W \\in \\{0.0, 0.5, \\dots, 4.0\\}$ to yield a single average RMSE for each response ($A/A_0$ and $K_n/A_0$), providing a measure of the quadratic model's overall fit.\n\nFinally, local sensitivities are computed. These are the gradients of the fitted response surface model, evaluated at the geometric center of the parameter space, $\\mathbf{x}_0$, and at a fixed separation $W=1.0$. For example, the sensitivity of the contact area to the summit density is given by:\n$$ \\left.\\frac{\\partial \\log_{10}A}{\\partial \\log_{10}\\eta}\\right|_{\\mathbf{x}_0, W=1.0} = \\left.\\frac{\\partial \\hat{y}_A}{\\partial x_1}\\right|_{\\mathbf{x}_0} = c_1 + 2c_4 x_{1,0} + c_7 x_{2,0} + c_8 x_{3,0} $$\nwhere the coefficients $c_i$ are from the fit at $W=1.0$ and $x_{i,0}$ are the components of $\\mathbf{x}_0$. The other five sensitivities are computed analogously. These six gradients, along with the two average RMSE values, constitute the eight required outputs for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the rough surface contact problem as specified.\n    Derives metrics from the Greenwood-Williamson model, performs a sensitivity\n    analysis using a quadratic response surface, and reports RMSE and gradient-based\n    sensitivities.\n    \"\"\"\n    # Define constants\n    E_STAR = 1.00e11  # Pa\n    W_VALUES = [0.0, 0.5, 1.0, 1.5, 2.0, 3.0, 4.0]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (typical engineering roughness)\n        {\n            'eta_range': (1.0e8, 4.0e8),\n            'R_range': (5.0e-6, 2.0e-5),\n            'sigma_range': (2.0e-7, 1.0e-6)\n        },\n        # Case 2 (smoother and sparser surface)\n        {\n            'eta_range': (1.0e6, 5.0e6),\n            'R_range': (1.0e-6, 5.0e-6),\n            'sigma_range': (5.0e-8, 2.0e-7)\n        },\n        # Case 3 (dense and blunt asperities)\n        {\n            'eta_range': (1.0e9, 3.0e9),\n            'R_range': (5.0e-5, 2.0e-4),\n            'sigma_range': (1.0e-6, 3.0e-6)\n        }\n    ]\n\n    # Cache for statistical integrals F_k(W) to avoid re-computation\n    Fk_cache = {}\n\n    def get_Fk(k, W):\n        \"\"\"\n        Calculates the Greenwood-Williamson statistical integral F_k(W).\n        F_k(W) = integral from W to infinity of (s-W)^k * phi(s) ds\n        \"\"\"\n        if (k, W) in Fk_cache:\n            return Fk_cache[(k, W)]\n\n        integrand = lambda s: (s - W)**k * (1 / np.sqrt(2 * np.pi)) * np.exp(-s**2 / 2)\n        \n        # quad is robust, but for W=0 and k<1, singularity is at the boundary.\n        # It handles this correctly.\n        val, _ = integrate.quad(integrand, W, np.inf)\n        Fk_cache[(k, W)] = val\n        return val\n\n    def build_design_matrix(X_log):\n        \"\"\"\n        Constructs the design matrix for a second-order polynomial model.\n        \"\"\"\n        x1 = X_log[:, 0]\n        x2 = X_log[:, 1]\n        x3 = X_log[:, 2]\n        \n        # Columns correspond to: 1, x1, x2, x3, x1^2, x2^2, x3^2, x1*x2, x1*x3, x2*x3\n        X_design = np.vstack([\n            np.ones_like(x1), x1, x2, x3, x1**2, x2**2, x3**2, x1*x2, x1*x3, x2*x3\n        ]).T\n        return X_design\n\n    all_results = []\n    \n    for case in test_cases:\n        # 1. Sampling in parameter space\n        eta_min, eta_max = case['eta_range']\n        R_min, R_max = case['R_range']\n        sigma_min, sigma_max = case['sigma_range']\n        \n        eta_levels = [eta_min, np.sqrt(eta_min * eta_max), eta_max]\n        R_levels = [R_min, np.sqrt(R_min * R_max), R_max]\n        sigma_levels = [sigma_min, np.sqrt(sigma_min * sigma_max), sigma_max]\n        \n        param_grid = []\n        for eta in eta_levels:\n            for R in R_levels:\n                for sigma in sigma_levels:\n                    param_grid.append((eta, R, sigma))\n        \n        num_params = len(param_grid)\n        num_w = len(W_VALUES)\n        \n        # Calculate true responses from the GW model\n        Y_A_log = np.zeros((num_params, num_w))\n        Y_Kn_log = np.zeros((num_params, num_w))\n\n        for i, (eta, R, sigma) in enumerate(param_grid):\n            for j, W in enumerate(W_VALUES):\n                F1 = get_Fk(1.0, W)\n                F1_2 = get_Fk(0.5, W)\n\n                # Area per unit nominal area (dimensionless)\n                A_div_A0 = eta * np.pi * R * sigma * F1\n                # Stiffness per unit nominal area (Pa/m)\n                Kn_div_A0 = 2 * eta * E_STAR * np.sqrt(R * sigma) * F1_2\n\n                if A_div_A0 > 0:\n                    Y_A_log[i, j] = np.log10(A_div_A0)\n                else: # handles log(0) for large W\n                    Y_A_log[i, j] = -np.inf\n                \n                if Kn_div_A0 > 0:\n                    Y_Kn_log[i, j] = np.log10(Kn_div_A0)\n                else:\n                    Y_Kn_log[i, j] = -np.inf\n        \n        # Prepare for regression\n        X_log = np.log10(np.array(param_grid))\n        X_design = build_design_matrix(X_log)\n        \n        rmses_A = []\n        rmses_Kn = []\n        c_A_w1, c_Kn_w1 = None, None\n\n        # 2. Response surface model fitting and RMSE calculation\n        for j, W in enumerate(W_VALUES):\n            y_A = Y_A_log[:, j]\n            y_Kn = Y_Kn_log[:, j]\n            \n            # Fit for Area\n            c_A = np.linalg.lstsq(X_design, y_A, rcond=None)[0]\n            y_A_pred = X_design @ c_A\n            rmse_A = np.sqrt(np.mean((y_A - y_A_pred)**2))\n            rmses_A.append(rmse_A)\n            \n            # Fit for Stiffness\n            c_Kn = np.linalg.lstsq(X_design, y_Kn, rcond=None)[0]\n            y_Kn_pred = X_design @ c_Kn\n            rmse_Kn = np.sqrt(np.mean((y_Kn - y_Kn_pred)**2))\n            rmses_Kn.append(rmse_Kn)\n            \n            if W == 1.0:\n                c_A_w1 = c_A\n                c_Kn_w1 = c_Kn\n        \n        # 3. Average RMSE metric\n        avg_rmse_A = np.mean(rmses_A)\n        avg_rmse_Kn = np.mean(rmses_Kn)\n        \n        # 4. Local gradient-based sensitivities\n        center_x = np.log10([\n            np.sqrt(eta_min * eta_max),\n            np.sqrt(R_min * R_max),\n            np.sqrt(sigma_min * sigma_max)\n        ])\n        x1_c, x2_c, x3_c = center_x\n        \n        def calculate_sensitivities(c, center_x_vals):\n            x1, x2, x3 = center_x_vals\n            sens_x1 = c[1] + 2*c[4]*x1 + c[7]*x2 + c[8]*x3\n            sens_x2 = c[2] + 2*c[5]*x2 + c[7]*x1 + c[9]*x3\n            sens_x3 = c[3] + 2*c[6]*x3 + c[8]*x1 + c[9]*x2\n            return sens_x1, sens_x2, sens_x3\n        \n        sens_A_eta, sens_A_R, sens_A_sigma = calculate_sensitivities(c_A_w1, center_x)\n        sens_Kn_eta, sens_Kn_R, sens_Kn_sigma = calculate_sensitivities(c_Kn_w1, center_x)\n        \n        case_results = [\n            avg_rmse_A, avg_rmse_Kn,\n            sens_A_eta, sens_A_R, sens_A_sigma,\n            sens_Kn_eta, sens_Kn_R, sens_Kn_sigma\n        ]\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2682384"}]}