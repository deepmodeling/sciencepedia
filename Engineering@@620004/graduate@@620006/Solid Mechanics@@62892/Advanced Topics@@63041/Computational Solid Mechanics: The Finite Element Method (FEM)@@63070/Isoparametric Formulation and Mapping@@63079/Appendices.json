{"hands_on_practices": [{"introduction": "The heart of the isoparametric finite element method is the transformation of integrals over complex physical element shapes into integrals over a simple parent square. This transformation relies on a mapping whose properties dictate the accuracy of the numerical integration used to compute matrices like the element stiffness, $\\boldsymbol{K}_{e}$. This practice problem explores the relationship between the geometry of a bilinear quadrilateral element, the resulting polynomial order of the stiffness matrix integrand, and the number of Gauss quadrature points required for exact integration. By working through this analysis [@problem_id:2651702], you will gain a fundamental understanding of why specific quadrature rules, such as the $2 \\times 2$ scheme for Q4 elements, are standard practice and, critically, under what conditions these rules are exact or merely approximations.", "problem": "A bilinear quadrilateral finite element (often denoted $Q4$ in the Finite Element Method (FEM)) is used for a homogeneous, linearly elastic solid in plane stress or plane strain. The element is formulated isoparametrically with natural coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, bilinear shape functions $N_{i}(\\xi,\\eta)$, and a mapping $\\boldsymbol{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\boldsymbol{x}_{i}$. The element stiffness matrix is\n$$\n\\boldsymbol{K}_{e}=\\int_{\\Omega_{e}}\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{B}\\,\\mathrm{d}\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1}\\boldsymbol{B}^{\\mathsf{T}}(\\xi,\\eta)\\,\\boldsymbol{D}\\,\\boldsymbol{B}(\\xi,\\eta)\\,\\det\\boldsymbol{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $\\boldsymbol{D}$ is the constant material matrix, $\\boldsymbol{B}(\\xi,\\eta)$ is the strain–displacement matrix obtained via the chain rule with the Jacobian $\\boldsymbol{J}(\\xi,\\eta)$ of the isoparametric mapping, and $\\det\\boldsymbol{J}(\\xi,\\eta)$ is the Jacobian determinant. The integral is evaluated by a tensor-product Gauss–Legendre quadrature with $n_{\\xi}\\times n_{\\eta}$ points. Using only the following foundational facts:\n- Bilinear shape functions are polynomials that are at most linear in each natural coordinate.\n- The Jacobian $\\boldsymbol{J}(\\xi,\\eta)$ of an affine (parallelogram) mapping is constant, while for a general bilinear mapping it has entries that are linear in $\\xi$ and $\\eta$, so $\\det\\boldsymbol{J}(\\xi,\\eta)$ is, in general, a polynomial of total degree up to $2$.\n- A one-dimensional Gauss–Legendre rule with $n$ points integrates exactly any polynomial of degree up to $2n-1$; a tensor-product rule in two dimensions inherits this exactness in each coordinate.\n\nDetermine the minimal number of Gauss points needed to exactly integrate $\\boldsymbol{K}_{e}$ for a bilinear quadrilateral under linear material behavior, and justify your choice by tracking the polynomial order of the integrand. Choose the statement that is correct.\n\nA. $1\\times 1$ Gauss points are sufficient to integrate $\\boldsymbol{K}_{e}$ exactly for any bilinear quadrilateral, because the shape functions are bilinear.\n\nB. $2\\times 2$ Gauss points integrate $\\boldsymbol{K}_{e}$ exactly for any bilinear quadrilateral, including arbitrarily distorted elements, because the highest polynomial degree in the integrand is $2$.\n\nC. $2\\times 2$ Gauss points integrate $\\boldsymbol{K}_{e}$ exactly when the mapping is affine (rectangle or parallelogram), because the integrand is then a polynomial of degree at most $2$ in each natural coordinate; for a general bilinear (distorted) mapping the integrand is rational and no finite tensor-product Gauss–Legendre rule is exact for all such elements.\n\nD. $3\\times 3$ Gauss points are required to integrate $\\boldsymbol{K}_{e}$ exactly for any bilinear quadrilateral, because the integrand has cubic terms even for an affine mapping.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- Element: A bilinear quadrilateral finite element ($Q4$).\n- Physics: Homogeneous, linearly elastic solid in plane stress or plane strain.\n- Formulation: Isoparametric with natural coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$.\n- Shape functions: Bilinear, $N_{i}(\\xi,\\eta)$.\n- Mapping: $\\boldsymbol{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\boldsymbol{x}_{i}$.\n- Element stiffness matrix: $\\boldsymbol{K}_{e} = \\int_{-1}^{1}\\int_{-1}^{1}\\boldsymbol{B}^{\\mathsf{T}}(\\xi,\\eta)\\,\\boldsymbol{D}\\,\\boldsymbol{B}(\\xi,\\eta)\\,\\det\\boldsymbol{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\n- Material matrix $\\boldsymbol{D}$ is constant.\n- Strain-displacement matrix $\\boldsymbol{B}(\\xi,\\eta)$ is obtained via chain rule with Jacobian $\\boldsymbol{J}(\\xi,\\eta)$.\n- Numerical integration: Tensor-product Gauss–Legendre quadrature with $n_{\\xi}\\times n_{\\eta}$ points.\n- Foundational Fact 1: Bilinear shape functions are polynomials that are at most linear in each natural coordinate.\n- Foundational Fact 2: The Jacobian $\\boldsymbol{J}(\\xi,\\eta)$ of an affine (parallelogram) mapping is constant. For a general bilinear mapping, its entries are linear in $\\xi$ and $\\eta$, and $\\det\\boldsymbol{J}(\\xi,\\eta)$ is a polynomial of total degree up to $2$.\n- Foundational Fact 3: A one-dimensional Gauss–Legendre rule with $n$ points integrates exactly any polynomial of degree up to $2n-1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It provides a standard theoretical question from the field of computational solid mechanics (Finite Element Method). All provided definitions and \"foundational facts\" are consistent with established theory. The problem is self-contained and free of contradictions, ambiguities, or pseudo-scientific claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be derived.\n\nThe objective is to determine the minimal number of Gauss quadrature points required to exactly integrate the element stiffness matrix $\\boldsymbol{K}_{e}$. This requires analyzing the polynomial order of the integrand, which is the matrix-valued function $\\boldsymbol{I}(\\xi,\\eta) = \\boldsymbol{B}^{\\mathsf{T}}(\\xi,\\eta)\\,\\boldsymbol{D}\\,\\boldsymbol{B}(\\xi,\\eta)\\,\\det\\boldsymbol{J}(\\xi,\\eta)$. The material matrix $\\boldsymbol{D}$ is constant and does not influence the polynomial character of the integrand. We must analyze the structure of $\\boldsymbol{B}(\\xi,\\eta)$ and $\\det\\boldsymbol{J}(\\xi,\\eta)$.\n\nThe strain-displacement matrix $\\boldsymbol{B}$ relates the strain components to the nodal displacements. Its entries are composed of derivatives of the shape functions with respect to the global coordinates $(x,y)$. These are obtained via the chain rule:\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = \\frac{1}{\\det\\boldsymbol{J}} \\begin{pmatrix} J_{22} & -J_{12} \\\\ -J_{21} & J_{11} \\end{pmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix}\n$$\nThe entries of the $\\boldsymbol{B}$ matrix for a node $i$ are constructed from terms like $\\frac{\\partial N_i}{\\partial x}$ and $\\frac{\\partial N_i}{\\partial y}$. For example:\n$$\n\\frac{\\partial N_i}{\\partial x} = \\frac{1}{\\det\\boldsymbol{J}} \\left( J_{22} \\frac{\\partial N_i}{\\partial \\xi} - J_{12} \\frac{\\partial N_i}{\\partial \\eta} \\right)\n$$\nWe must analyze two distinct cases for the isoparametric mapping.\n\n**Case 1: General (Distorted) Bilinear Quadrilateral**\n\nAccording to Foundational Fact 1, the bilinear shape functions $N_i(\\xi, \\eta)$ are linear in each coordinate. For instance, $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$. The derivatives are:\n- $\\frac{\\partial N_i}{\\partial \\xi}$: a polynomial that is linear in $\\eta$.\n- $\\frac{\\partial N_i}{\\partial \\eta}$: a polynomial that is linear in $\\xi$.\n\nAccording to Foundational Fact 2, for a general mapping, the entries of the Jacobian $\\boldsymbol{J}$ are linear in $\\xi$ and $\\eta$. More specifically, the entries $J_{11} = \\frac{\\partial x}{\\partial \\xi}$ and $J_{12} = \\frac{\\partial y}{\\partial \\xi}$ are linear in $\\eta$. The entries $J_{21} = \\frac{\\partial x}{\\partial \\eta}$ and $J_{22} = \\frac{\\partial y}{\\partial \\eta}$ are linear in $\\xi$.\nThe determinant, $\\det\\boldsymbol{J} = J_{11}J_{22} - J_{12}J_{21}$, is therefore a product of a function linear in $\\eta$ and a function linear in $\\xi$, minus another such product. The result is a polynomial of the form $p(\\xi,\\eta) = c_0 + c_1\\xi + c_2\\eta + c_3\\xi\\eta$. This is linear in each coordinate separately.\n\nNow consider the numerator of a term in $\\boldsymbol{B}$, such as $J_{22} \\frac{\\partial N_i}{\\partial \\xi} - J_{12} \\frac{\\partial N_i}{\\partial \\eta}$.\n- $J_{22}$ is linear in $\\xi$. $\\frac{\\partial N_i}{\\partial \\xi}$ is linear in $\\eta$. Their product contains a $\\xi\\eta$ term.\n- $J_{12}$ is linear in $\\eta$. $\\frac{\\partial N_i}{\\partial \\eta}$ is linear in $\\xi$. Their product contains a $\\xi\\eta$ term.\nThe numerator is thus a polynomial of the same form as $\\det\\boldsymbol{J}$: linear in each coordinate.\nTherefore, the entries of the $\\boldsymbol{B}$ matrix are **rational functions**, of the form $\\frac{\\text{Polynomial}(\\xi,\\eta)}{\\det\\boldsymbol{J}(\\xi,\\eta)}$.\n\nThe integrand for the stiffness matrix contains terms of the form $\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{B} \\det\\boldsymbol{J}$. An arbitrary entry in this product will behave as:\n$$\n\\left( \\frac{\\text{Poly}_1}{\\det\\boldsymbol{J}} \\right) \\left( \\frac{\\text{Poly}_2}{\\det\\boldsymbol{J}} \\right) \\det\\boldsymbol{J} = \\frac{\\text{Poly}_1 \\cdot \\text{Poly}_2}{\\det\\boldsymbol{J}}\n$$\nThis is a rational function, where the denominator is, in general, not a constant. A Gauss-Legendre quadrature rule is designed for the exact integration of polynomials. It cannot, in general, exactly integrate a rational function with a variable denominator using a finite number of points.\n\n**Case 2: Affine Mapping (Rectangle or Parallelogram)**\n\nAccording to Foundational Fact 2, for an affine mapping, the Jacobian matrix $\\boldsymbol{J}$ is constant. Consequently, its inverse $\\boldsymbol{J}^{-1}$ and determinant $\\det\\boldsymbol{J}$ are also constant.\nThe derivatives of the shape functions with respect to global coordinates are now:\n$$\n\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}\n$$\nSince $\\boldsymbol{J}^{-1}$ is a matrix of constants, $\\frac{\\partial N_i}{\\partial x}$ and $\\frac{\\partial N_i}{\\partial y}$ are linear combinations of $\\frac{\\partial N_i}{\\partial \\xi}$ (linear in $\\eta$) and $\\frac{\\partial N_i}{\\partial \\eta}$ (linear in $\\xi$). Thus, the entries of the $\\boldsymbol{B}$ matrix are polynomials of the form $a+b\\xi+c\\eta$.\n\nThe integrand $\\boldsymbol{I}(\\xi,\\eta) = \\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{B}\\,\\det\\boldsymbol{J}$ is now a polynomial, since $\\boldsymbol{D}$ and $\\det\\boldsymbol{J}$ are constants. The entries of the product $\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{B}$ are formed by multiplying two entries of $\\boldsymbol{B}$, which are linear polynomials in $\\xi$ and $\\eta$. The product of two such polynomials, e.g., $(a_1+b_1\\xi+c_1\\eta)(a_2+b_2\\xi+c_2\\eta)$, results in a polynomial containing terms up to $\\xi^2$, $\\eta^2$, and $\\xi\\eta$. The highest degree in the variable $\\xi$ is $2$, and the highest degree in the variable $\\eta$ is $2$.\n\nAccording to Foundational Fact 3, a 1-D Gauss rule with $n$ points exactly integrates a polynomial of degree up to $2n-1$. To exactly integrate a polynomial of degree $p=2$, we must have $2n-1 \\ge 2$, which implies $2n \\ge 3$, or $n \\ge 1.5$. The minimum integer value for $n$ is $2$.\nSince the integrand is a polynomial of degree at most $2$ in each coordinate direction, a tensor-product rule requires $2$ points in the $\\xi$ direction and $2$ points in the $\\eta$ direction. Thus, a $2 \\times 2$ Gauss-Legendre quadrature is both necessary and sufficient for exact integration in the case of an affine mapping.\n\n**Evaluation of Options**\n\n*   **A. $1\\times 1$ Gauss points are sufficient to integrate $\\boldsymbol{K}_{e}$ exactly for any bilinear quadrilateral, because the shape functions are bilinear.**\n    **Incorrect.** A $1 \\times 1$ rule integrates polynomials up to degree $2(1)-1=1$. As shown, even for the simplest non-trivial affine mapping (a rectangle), the integrand is quadratic in each coordinate. Therefore, $1 \\times 1$ is insufficient.\n\n*   **B. $2\\times 2$ Gauss points integrate $\\boldsymbol{K}_{e}$ exactly for any bilinear quadrilateral, including arbitrarily distorted elements, because the highest polynomial degree in the integrand is $2$.**\n    **Incorrect.** For a general, arbitrarily distorted element, the integrand is a rational function, not a polynomial. No finite Gauss-Legendre rule can guarantee exact integration. The premise that the integrand is a polynomial of degree $2$ for *any* bilinear quadrilateral is false.\n\n*   **C. $2\\times 2$ Gauss points integrate $\\boldsymbol{K}_{e}$ exactly when the mapping is affine (rectangle or parallelogram), because the integrand is then a polynomial of degree at most $2$ in each natural coordinate; for a general bilinear (distorted) mapping the integrand is rational and no finite tensor-product Gauss–Legendre rule is exact for all such elements.**\n    **Correct.** This statement accurately reflects the derived conclusions. It correctly identifies that for an affine map, the integrand is a polynomial of degree $2$ in each coordinate, for which a $2 \\times 2$ rule is exact and minimal. It also correctly states that for a general distorted element, the integrand is a rational function, which cannot be integrated exactly by a finite Gauss-Legendre rule in general.\n\n*   **D. $3\\times 3$ Gauss points are required to integrate $\\boldsymbol{K}_{e}$ exactly for any bilinear quadrilateral, because the integrand has cubic terms even for an affine mapping.**\n    **Incorrect.** The premise that the integrand has cubic terms for an affine mapping is false; it is quadratic. Therefore, a $2 \\times 2$ rule is sufficient, and a $3 \\times 3$ rule is not required (it is an overkill). Furthermore, for a general element, no finite rule is exact.", "answer": "$$\\boxed{C}$$", "id": "2651702"}, {"introduction": "A valid isoparametric mapping must be one-to-one, a condition that mathematically requires the Jacobian determinant, $J$, to be positive throughout the entire element. In practice, finite element codes often check this condition only at the numerical quadrature points, assuming this is sufficient to guarantee element quality. This exercise challenges that common assumption by presenting a carefully constructed counterexample, asking you to analyze a specific distorted quadrilateral whose mapping appears valid at the standard $2 \\times 2$ Gauss points but is actually locally inverted (i.e., $J \\lt 0$) in another region. Completing this calculation [@problem_id:2651722] provides a crucial, hands-on lesson in the potential unreliability of common element quality checks and reinforces the importance of understanding the true geometry of distorted elements.", "problem": "You are given a four-node bilinear isoparametric quadrilateral in two dimensions. The parent (reference) coordinates of the nodes are $(-1,-1)$, $(+1,-1)$, $(+1,+1)$, and $(-1,+1)$, and the standard bilinear isoparametric shape functions are to be used to map from parent coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ to physical coordinates $(x,y)$. The isoparametric mapping is defined by $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)X_i$ and $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)Y_i$, where $(X_i,Y_i)$ are the physical coordinates of the nodes. The Jacobian determinant $J(\\xi,\\eta)$ of this mapping is defined by $J=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$ and governs the local area scaling between the parent and physical elements.\n\nConsider the following physical nodal coordinates (in the same node order as above):\n- $Y_1=-1$, $Y_2=-1$, $Y_3=+1$, $Y_4=+1$,\n- $X_1=\\tfrac{1}{2}$, $X_2=-\\tfrac{1}{2}$, $X_3=\\tfrac{5}{2}$, $X_4=-\\tfrac{5}{2}$.\n\nStarting from the definitions of isoparametric mapping and the Jacobian determinant, perform the following:\n1. Derive explicit expressions for $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$.\n2. Derive the Jacobian determinant $J(\\xi,\\eta)$.\n3. Evaluate $J(\\xi,\\eta)$ at the four two-point Gaussian quadrature (GQ) locations $(\\xi,\\eta)=(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$ and verify its sign at those points.\n4. Evaluate $J(\\xi,\\eta)$ at the interior point $(\\xi,\\eta)=(0,-\\tfrac{4}{5})$, demonstrate that the mapping becomes locally inverted there, and report this value.\n\nBriefly explain the implication of your findings for the reliability of element quality checks that only test $J>0$ at the GQ points. For the purposes of grading, provide as your final answer only the computed value of $J$ at $(\\xi,\\eta)=(0,-\\tfrac{4}{5})$. No rounding is required, and no physical units are associated with $J$.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, objective, and internally consistent. It represents a standard, albeit carefully constructed, exercise in the finite element method to test the understanding of isoparametric mapping and element quality metrics. The problem is valid, and a solution will be provided.\n\nThe four-node bilinear isoparametric element utilizes shape functions $N_i(\\xi, \\eta)$ to map from the parent domain $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ to the physical domain $(x,y)$. The shape functions for nodes $1, 2, 3, 4$ in standard order are:\n$$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\nThe physical nodal coordinates $(X_i, Y_i)$ are given as:\nNode 1: $(X_1, Y_1) = (\\frac{1}{2}, -1)$\nNode 2: $(X_2, Y_2) = (-\\frac{1}{2}, -1)$\nNode 3: $(X_3, Y_3) = (\\frac{5}{2}, 1)$\nNode 4: $(X_4, Y_4) = (-\\frac{5}{2}, 1)$\n\n**1. Derivation of $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$**\n\nThe isoparametric mapping is defined by $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) X_i$ and $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) Y_i$.\n\nFirst, we derive the expression for the $y$-coordinate:\n$$y(\\xi,\\eta) = N_1(-1) + N_2(-1) + N_3(1) + N_4(1)$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -1(1-\\xi)(1-\\eta) - 1(1+\\xi)(1-\\eta) + 1(1+\\xi)(1+\\eta) + 1(1-\\xi)(1+\\eta) ]$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -(1-\\eta)( (1-\\xi) + (1+\\xi) ) + (1+\\eta)( (1+\\xi) + (1-\\xi) ) ]$$\n$$y(\\xi,\\eta) = \\frac{1}{4} [ -2(1-\\eta) + 2(1+\\eta) ] = \\frac{1}{2} [ -1+\\eta + 1+\\eta ] = \\frac{1}{2}(2\\eta) = \\eta$$\nSo, the mapping for the $y$-coordinate is simply $y(\\xi,\\eta) = \\eta$.\n\nNext, we derive the expression for the $x$-coordinate:\n$$x(\\xi,\\eta) = N_1 X_1 + N_2 X_2 + N_3 X_3 + N_4 X_4$$\n$$x(\\xi,\\eta) = \\frac{1}{4} [ (\\frac{1}{2})(1-\\xi)(1-\\eta) + (-\\frac{1}{2})(1+\\xi)(1-\\eta) + (\\frac{5}{2})(1+\\xi)(1+\\eta) + (-\\frac{5}{2})(1-\\xi)(1+\\eta) ]$$\nFactor out $\\frac{1}{8}$:\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\xi)(1-\\eta) - (1+\\xi)(1-\\eta) + 5(1+\\xi)(1+\\eta) - 5(1-\\xi)(1+\\eta) ]$$\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\eta)((1-\\xi)-(1+\\xi)) + 5(1+\\eta)((1+\\xi)-(1-\\xi)) ]$$\n$$x(\\xi,\\eta) = \\frac{1}{8} [ (1-\\eta)(-2\\xi) + 5(1+\\eta)(2\\xi) ]$$\n$$x(\\xi,\\eta) = \\frac{2\\xi}{8} [ -(1-\\eta) + 5(1+\\eta) ] = \\frac{\\xi}{4} [ -1+\\eta+5+5\\eta ] = \\frac{\\xi}{4}(4+6\\eta)$$\n$$x(\\xi,\\eta) = \\xi(1+\\frac{3}{2}\\eta)$$\n\nThe explicit expressions for the mapping are $x(\\xi,\\eta) = \\xi(1+\\frac{3}{2}\\eta)$ and $y(\\xi,\\eta)=\\eta$.\n\n**2. Derivation of the Jacobian Determinant $J(\\xi,\\eta)$**\n\nThe Jacobian matrix of the mapping is $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$.\nThe partial derivatives are:\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\xi + \\frac{3}{2}\\xi\\eta \\right) = 1 + \\frac{3}{2}\\eta$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\xi + \\frac{3}{2}\\xi\\eta \\right) = \\frac{3}{2}\\xi$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\eta) = 0$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\eta) = 1$$\n\nThe Jacobian matrix is:\n$$\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 + \\frac{3}{2}\\eta & \\frac{3}{2}\\xi \\\\ 0 & 1 \\end{pmatrix}$$\nThe Jacobian determinant, $J(\\xi,\\eta) = \\det(\\mathbf{J})$, is:\n$$J(\\xi,\\eta) = (1 + \\frac{3}{2}\\eta)(1) - (\\frac{3}{2}\\xi)(0) = 1 + \\frac{3}{2}\\eta$$\n\n**3. Evaluation of $J$ at Gaussian Quadrature Points**\n\nThe four two-point Gaussian quadrature (GQ) locations are $(\\xi,\\eta) = (\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}})$. Since $J$ depends only on $\\eta$, we only need to evaluate it for $\\eta = \\pm \\frac{1}{\\sqrt{3}}$.\n\nFor $\\eta = +\\frac{1}{\\sqrt{3}}$:\n$$J = 1 + \\frac{3}{2}\\left(\\frac{1}{\\sqrt{3}}\\right) = 1 + \\frac{\\sqrt{3}}{2}$$\nSince $\\sqrt{3} \\approx 1.732$, $J \\approx 1 + 0.866 = 1.866 > 0$.\n\nFor $\\eta = -\\frac{1}{\\sqrt{3}}$:\n$$J = 1 + \\frac{3}{2}\\left(-\\frac{1}{\\sqrt{3}}\\right) = 1 - \\frac{\\sqrt{3}}{2}$$\nSince $\\frac{\\sqrt{3}}{2} \\approx 0.866  1$, $J \\approx 1 - 0.866 = 0.134 > 0$.\n\nAt all four GQ points, the Jacobian determinant is positive. This element would pass a standard quality check based on evaluation at these points.\n\n**4. Evaluation of $J$ at $(\\xi,\\eta)=(0,-\\frac{4}{5})$**\n\nWe now evaluate the Jacobian determinant at the specified interior point $(\\xi,\\eta)=(0, -\\frac{4}{5})$.\n$$J\\left(0, -\\frac{4}{5}\\right) = 1 + \\frac{3}{2}\\eta = 1 + \\frac{3}{2}\\left(-\\frac{4}{5}\\right) = 1 - \\frac{12}{10} = 1 - \\frac{6}{5} = \\frac{5}{5} - \\frac{6}{5} = -\\frac{1}{5}$$\nThe Jacobian determinant is negative at this point, $J = -\\frac{1}{5}$. This demonstrates that the isoparametric mapping is locally inverted (i.e., it folds back on itself) in a region inside the element.\n\n**Implications for Element Quality Checks**\n\nThe primary implication is that relying solely on checking $J > 0$ at the standard Gaussian quadrature points is an insufficient and unreliable method for ensuring a valid, non-degenerate element geometry over the entire parent domain. Numerical integration schemes for element matrices are typically implemented by summing weighted function evaluations at GQ points. If $J > 0$ at these points, the numerical integration routine will execute without error, and a finite element code will likely accept the element. However, the existence of a region where $J \\le 0$, as demonstrated here, signifies a violation of the fundamental requirement of a one-to-one mapping from the parent element to the physical element. This physically means the element geometry is \"tangled\" or \"inverted\". An analysis using such an element would produce physically meaningless results, despite the absence of computational errors during the assembly phase.\n\nThis problem illustrates that for distorted elements, particularly non-convex or \"bowtie\" shapes, more robust quality checks are necessary. For bilinear quadrilaterals, the Jacobian $J(\\xi, \\eta)$ is a linear function of $\\xi$ and $\\eta$. Its extrema must therefore occur at the corners of the parent domain $(\\xi, \\eta) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$. A sufficient check for this class of elements is to verify that the Jacobian is positive at all four corner nodes. In this case, with $J = 1 + \\frac{3}{2}\\eta$, the minimum value occurs at $\\eta=-1$, where $J = 1 - \\frac{3}{2} = -\\frac{1}{2}$. This confirms a portion of the element is invalid, a fact missed by checking only at the GQ points.", "answer": "$$\\boxed{-\\frac{1}{5}}$$", "id": "2651722"}, {"introduction": "While full integration is often necessary for accuracy, reduced integration—using fewer quadrature points than required for exactness—is a popular technique used to improve element performance and reduce computational cost. This practice is not without its pitfalls, the most famous of which is the introduction of non-physical, zero-energy deformation modes. This problem guides you through a theoretical analysis of a bilinear quadrilateral element under single-point reduced integration, with the core task of determining the rank of the resulting stiffness matrix to identify the number of spurious \"hourglass\" modes. This derivation [@problem_id:2651763] is fundamental to advanced finite element theory, revealing precisely how and why rank deficiency arises from the interplay between the isoparametric mapping and the choice of quadrature rule, and providing a deep understanding of the trade-offs between computational efficiency and numerical stability.", "problem": "Consider a $4$-node bilinear quadrilateral isoparametric finite element in small-strain, linear elasticity. The element occupies a physical domain obtained by mapping the parent square $\\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$ via the standard bilinear isoparametric mapping with nodal coordinates $\\{(x_i,y_i)\\}_{i=1}^4$. Let the thickness be constant $t>0$ and the symmetric constitutive matrix for plane strain be positive definite, denoted by $D \\in \\mathbb{R}^{3 \\times 3}$. The element displacement field is interpolated by the same bilinear shape functions $\\{N_i(\\xi,\\eta)\\}_{i=1}^4$ acting on the nodal degrees of freedom $\\{u_i, v_i\\}_{i=1}^4$.\n\nStarting from first principles of the isoparametric formulation, namely: the definition of the isoparametric mapping, the Jacobian matrix $J(\\xi,\\eta)$, the small-strain tensor expressed through the spatial gradient of the displacement field, and the energy-conjugate definition of the element stiffness matrix as the integral over the element of $B^{\\mathsf{T}} D B$ weighted by the physical differential area, perform the following tasks:\n\na) Formulate the element stiffness matrix $K_e$ as an integral over the parent domain in terms of the strain–displacement matrix $B(\\xi,\\eta)$ and the Jacobian determinant $\\det J(\\xi,\\eta)$.\n\nb) Specialize the formulation to a reduced integration scheme that uses a single Gauss point located at $(\\xi,\\eta)=(0,0)$ with the appropriate tensor-product Gauss weight. Express the resulting reduced-integration stiffness matrix $K_e^{\\mathrm{RI}}$ in terms of quantities evaluated at $(\\xi,\\eta)=(0,0)$.\n\nc) By analyzing the mapping and the structure of $B(\\xi,\\eta)$ for the bilinear quadrilateral, determine the rank of $K_e^{\\mathrm{RI}}$ under the assumption that the Jacobian at the Gauss point is nonsingular, i.e., $\\det J(0,0) \\neq 0$, and that $D$ is positive definite. Then compute the dimension of the non-rigid-body nullspace of $K_e^{\\mathrm{RI}}$ (the number of independent hourglass modes).\n\nd) Explain, using the role of the isoparametric mapping and the evaluation at a single quadrature point, under what geometric conditions on the mapping the rank can drop further, and why.\n\nState as your final answer the number obtained in part c) as a single integer (no units). No rounding is necessary.", "solution": "This is a standard problem in the theory of the finite element method. We will address each part systematically based on first principles. The problem is valid as it is scientifically grounded in computational solid mechanics, is well-posed, objective, and internally consistent.\n\na) Formulation of the element stiffness matrix $K_e$.\n\nThe foundation of the isoparametric formulation is the use of the same shape functions to interpolate both the geometry and the displacement field. For a $4$-node bilinear quadrilateral element, the shape functions are given by $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i \\xi)(1+\\eta_i \\eta)$ for $i=1, 2, 3, 4$, where $(\\xi_i, \\eta_i)$ are the coordinates of the nodes in the parent square, typically taken as $(-1, -1)$, $(1, -1)$, $(1, 1)$, and $(-1, 1)$ respectively.\n\nThe physical coordinates $(x, y)$ are mapped from the parent coordinates $(\\xi, \\eta)$ as:\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i $$\n$$ y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\nSimilarly, the displacement field $(u, v)$ is interpolated from the nodal displacements $(u_i, v_i)$:\n$$ u(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i $$\n$$ v(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) v_i $$\nThe small-strain tensor components in a $2D$ plane strain problem are given by the vector $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$, where:\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\nTo compute these spatial derivatives, we use the chain rule, which relates derivatives in the physical space to derivatives in the parent space via the Jacobian matrix $\\mathbf{J}$:\n$$ \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = \\mathbf{J} \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} $$\nTherefore, the spatial derivatives are $\\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{pmatrix}$.\nThe strains can be written in terms of nodal displacements using the strain-displacement matrix $B$. Let the nodal displacement vector be $\\mathbf{d} = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathsf{T}}$. Then $\\varepsilon = B \\mathbf{d}$. The matrix $B$ can be written as $B = [B_1, B_2, B_3, B_4]$, where each submatrix $B_i$ is a $3 \\times 2$ matrix:\n$$ B_i(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix} $$\nThe spatial derivatives of the shape functions are computed as:\n$$ \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-1}(\\xi, \\eta) \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} $$\nThe element stiffness matrix $K_e$ is defined from the strain energy integral over the element volume $V_e$:\n$$ K_e = \\int_{V_e} B^{\\mathsf{T}} D B \\, dV $$\nFor an element of constant thickness $t$, $dV = t \\, dA$, where $dA$ is the differential area in the physical domain. To evaluate this integral, we change variables to the parent domain, for which $dA = \\det \\mathbf{J}(\\xi, \\eta) \\, d\\xi \\, d\\eta$. The integration limits are from $-1$ to $1$ for both $\\xi$ and $\\eta$.\nThe expression for the element stiffness matrix is therefore:\n$$ K_e = t \\int_{-1}^{1} \\int_{-1}^{1} B(\\xi, \\eta)^{\\mathsf{T}} D B(\\xi, \\eta) \\det \\mathbf{J}(\\xi, \\eta) \\, d\\xi \\, d\\eta $$\nThis completes the formulation for part a).\n\nb) Reduced-integration stiffness matrix $K_e^{\\mathrm{RI}}$.\n\nReduced integration for this element involves using a single Gauss quadrature point to approximate the integral. The standard single-point rule for the domain $[-1, 1] \\times [-1, 1]$ uses the point $(\\xi_1, \\eta_1) = (0, 0)$ with a weight $w_1 = 2 \\times 2 = 4$.\nThe integral is approximated as:\n$$ \\int_{-1}^{1} \\int_{-1}^{1} f(\\xi, \\eta) \\, d\\xi \\, d\\eta \\approx w_1 f(\\xi_1, \\eta_1) = 4 f(0, 0) $$\nApplying this to the expression for $K_e$, we obtain the reduced-integration stiffness matrix $K_e^{\\mathrm{RI}}$:\n$$ K_e^{\\mathrm{RI}} = 4 t B(0, 0)^{\\mathsf{T}} D B(0, 0) \\det \\mathbf{J}(0, 0) $$\nwhere all terms, $B$, $\\mathbf{J}$, and $\\det \\mathbf{J}$, are evaluated at the center of the parent element, $(\\xi, \\eta) = (0, 0)$.\n\nc) Rank analysis and number of hourglass modes.\n\nThe stiffness matrix $K_e^{\\mathrm{RI}}$ is an $8 \\times 8$ matrix, as there are $8$ nodal degrees of freedom. Its rank is determined by the ranks of the matrices in its definition. We are given that the thickness $t > 0$, the constitutive matrix $D$ is positive definite (and thus has rank $3$), and the Jacobian at the center is nonsingular, so $\\det \\mathbf{J}(0, 0) \\neq 0$. The rank of a product of matrices is limited by the minimum rank of any matrix in the product. The formula for $K_e^{\\mathrm{RI}}$ is of the form $C^{\\mathsf{T}} M C$. The rank of such a matrix is equal to the rank of $C$, provided $M$ is positive definite. In our case, $C = B(0,0)$ and $M=D$ (scaled by constants). Thus, $\\mathrm{rank}(K_e^{\\mathrm{RI}}) = \\mathrm{rank}(B(0, 0))$.\n\nWe must find the rank of the $3 \\times 8$ matrix $B(0, 0)$. The derivatives of the shape functions at $(\\xi, \\eta) = (0, 0)$ are:\n$$ \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0)} = \\frac{1}{4} \\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0)} = \\frac{1}{4} \\eta_i $$\nLet $\\mathbf{b}_i(0,0) = [\\frac{\\partial N_i}{\\partial x}, \\frac{\\partial N_i}{\\partial y}]^{\\mathsf{T}}$ at $(0,0)$. We have $\\mathbf{b}_i(0,0) = \\mathbf{J}(0,0)^{-1} [\\frac{1}{4}\\xi_i, \\frac{1}{4}\\eta_i]^{\\mathsf{T}}$.\nThe matrix $B(0,0)$ has three rows. Let's examine their linear independence. A linear combination of the rows being zero, $c_1 \\mathbf{r}_1 + c_2 \\mathbf{r}_2 + c_3 \\mathbf{r}_3 = \\mathbf{0}$, yields two vector equations in $\\mathbb{R}^4$:\nFor the $u_i$ components: $c_1 [\\dots, \\frac{\\partial N_i}{\\partial x}, \\dots] + c_3 [\\dots, \\frac{\\partial N_i}{\\partial y}, \\dots] = \\mathbf{0}$\nFor the $v_i$ components: $c_2 [\\dots, \\frac{\\partial N_i}{\\partial y}, \\dots] + c_3 [\\dots, \\frac{\\partial N_i}{\\partial x}, \\dots] = \\mathbf{0}$\nLet the vectors of nodal derivatives be $\\mathbf{g}_x = [\\frac{\\partial N_1}{\\partial x}, \\dots, \\frac{\\partial N_4}{\\partial x}]^{\\mathsf{T}}$ and $\\mathbf{g}_y = [\\frac{\\partial N_1}{\\partial y}, \\dots, \\frac{\\partial N_4}{\\partial y}]^{\\mathsf{T}}$, both evaluated at $(0,0)$. These equations are $c_1 \\mathbf{g}_x + c_3 \\mathbf{g}_y = \\mathbf{0}$ and $c_2 \\mathbf{g}_y + c_3 \\mathbf{g}_x = \\mathbf{0}$.\nThe vectors $\\mathbf{g}_x$ and $\\mathbf{g}_y$ are linear combinations of the vectors $\\boldsymbol{\\xi} = [-1, 1, 1, -1]^{\\mathsf{T}}$ and $\\boldsymbol{\\eta} = [-1, -1, 1, 1]^{\\mathsf{T}}$. Since $\\mathbf{J}(0,0)^{-1}$ is nonsingular, $\\mathbf{g}_x$ and $\\mathbf{g}_y$ are linearly independent vectors in $\\mathbb{R}^4$. From the first equation, the linear independence of $\\mathbf{g}_x$ and $\\mathbf{g}_y$ forces $c_1=0$ and $c_3=0$. Substituting $c_3=0$ into the second equation gives $c_2 \\mathbf{g}_y = \\mathbf{0}$, which implies $c_2=0$ since $\\mathbf{g}_y$ is not a zero vector.\nThus, the only solution is $c_1=c_2=c_3=0$, proving that the three rows of $B(0,0)$ are linearly independent.\nTherefore, the rank of $B(0,0)$ is $3$. Consequently, $\\mathrm{rank}(K_e^{\\mathrm{RI}}) = 3$.\n\nThe dimension of the nullspace (nullity) of $K_e^{\\mathrm{RI}}$ is given by the rank-nullity theorem:\n$$ \\mathrm{dim}(\\mathrm{ker}(K_e^{\\mathrm{RI}})) = (\\text{number of DOFs}) - \\mathrm{rank}(K_e^{\\mathrm{RI}}) = 8 - 3 = 5 $$\nThe nullspace of the stiffness matrix contains vectors corresponding to zero-energy deformation modes. For a $2D$ body, there are 3 rigid-body modes (two translations, one rotation) which produce no strain and hence no strain energy. These $3$ modes are part of the $5$-dimensional nullspace of $K_e^{\\mathrm{RI}}$.\nThe remaining modes in the nullspace are non-physical, zero-energy modes known as hourglass modes. Their number is:\n$$ \\text{Number of hourglass modes} = \\mathrm{dim}(\\mathrm{ker}(K_e^{\\mathrm{RI}})) - (\\text{number of rigid-body modes}) = 5 - 3 = 2 $$\nThese two modes are spurious and are an artifact of the reduced integration scheme.\n\nd) Conditions for further rank drop.\n\nThe conclusion that $\\mathrm{rank}(K_e^{\\mathrm{RI}}) = 3$ is critically dependent on the assumption that the Jacobian matrix at the integration point, $\\mathbf{J}(0, 0)$, is nonsingular. If this assumption is violated, the rank analysis changes.\nA further drop in the rank of $K_e^{\\mathrm{RI}}$ occurs if the rank of $B(0,0)$ drops below $3$. Our proof of linear independence of the rows of $B(0,0)$ would fail if the vectors $\\mathbf{g}_x$ and $\\mathbf{g}_y$ become linearly dependent. This occurs precisely when $\\mathbf{J}(0, 0)$ is singular, i.e., $\\det \\mathbf{J}(0, 0) = 0$.\nThe geometric condition for $\\det \\mathbf{J}(0, 0) = 0$ is that the mapping from the parent to the physical element becomes singular at the center. The Jacobian at the center can be expressed as:\n$$ \\mathbf{J}(0,0) = \\frac{1}{4} \\begin{pmatrix} \\sum_{i=1}^4 \\xi_i x_i  \\sum_{i=1}^4 \\xi_i y_i \\\\ \\sum_{i=1}^4 \\eta_i x_i  \\sum_{i=1}^4 \\eta_i y_i \\end{pmatrix} $$\nIts determinant vanishes when the two row vectors (or column vectors) are linearly dependent. This can happen for severely distorted element geometries, such as self-intersecting (\"butterfly\" or \"crossed\") quadrilaterals, where the mapping effectively \"folds\" over itself. For example, if the nodes are ordered in such a way that the element boundary crosses itself.\nWhen $\\det \\mathbf{J}(0, 0) = 0$, the inverse $\\mathbf{J}(0,0)^{-1}$ does not exist, and the standard calculation of spatial derivatives and the $B$ matrix breaks down. Physically, a singular Jacobian at a point means that a non-zero area in the parent domain can map to a line or a point in the physical domain. The element has no stiffness against certain deformation patterns at that point, leading to additional zero-energy modes and a drop in the rank of the stiffness matrix beyond what is caused by standard hourglassing.", "answer": "$$\\boxed{2}$$", "id": "2651763"}]}