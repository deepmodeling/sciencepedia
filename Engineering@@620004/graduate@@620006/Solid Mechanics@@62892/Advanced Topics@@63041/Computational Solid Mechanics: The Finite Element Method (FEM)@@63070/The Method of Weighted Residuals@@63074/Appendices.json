{"hands_on_practices": [{"introduction": "This exercise serves as a fundamental walkthrough of the Galerkin finite element procedure, a powerful application of the method of weighted residuals. You will translate a differential equation into its integral weak form, construct element-level stiffness matrices from this form, and assemble them into a global system. Mastering this core process [@problem_id:2698892] is the essential first step toward applying the method to complex engineering problems.", "problem": "A one-dimensional steady diffusion problem on the dimensionless domain $\\Omega = [0,1]$ is governed by the strong form $- \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) = f(x)$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. Consider the material conductivity $k(x) = 2(1+x)$ and a vanishing source $f(x) = 0$. Discretize $\\Omega$ by a nonuniform mesh with nodes at $x_0 = 0$, $x_1 = \\frac{1}{4}$, $x_2 = \\frac{3}{4}$, and $x_3 = 1$, and approximate $u(x)$ by a piecewise-linear finite element expansion using continuous Lagrange shape functions on each element. Using the method of weighted residuals with Galerkin weights (i.e., test functions equal to the trial shape functions), perform the following tasks:\n\n1. Starting from the strong form and conservation of flux, derive the weak form by multiplying by an admissible weight $w(x)$ and integrating over $\\Omega$, then applying integration by parts to shift derivatives off $u(x)$. Clearly identify the bilinear form and the linear functional.\n\n2. For a generic element $e$ with end-nodes at $x_i$ and $x_{i+1}$ and element size $h_e = x_{i+1}-x_i$, write the element-level Galerkin expressions for the stiffness entries $k^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} k(x)\\,\\frac{dN_a}{dx}\\,\\frac{dN_b}{dx}\\,dx$ for $a,b \\in \\{1,2\\}$, where $N_1$ and $N_2$ are the local linear shape functions on element $e$. Show the integrals explicitly before evaluating them.\n\n3. Evaluate these integrals exactly for each element of the given mesh and compute the explicit $2\\times 2$ element stiffness matrices for elements on $[x_0,x_1]$, $[x_1,x_2]$, and $[x_2,x_3]$.\n\n4. Assemble the global stiffness matrix corresponding to the four-node mesh. Then enforce the essential boundary conditions $u(0)=0$ and $u(1)=0$ by eliminating the boundary degrees of freedom, thereby producing the reduced $2\\times 2$ global matrix associated with the interior nodes at $x_1$ and $x_2$.\n\n5. Using the discrete energy identity associated with the Galerkin method, justify why the reduced global matrix is symmetric and positive definite under the given boundary conditions and $k(x)>0$.\n\n6. Finally, for the interior vector $\\widehat{\\boldsymbol{u}} = \\begin{pmatrix}1 & 1\\end{pmatrix}^{\\mathsf T}$, compute the discrete energy $E_h = \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$, where $\\mathbf{K}$ is the reduced global matrix from step $4$. Report only the scalar value of $E_h$ as your final answer. No rounding is required; provide the exact value as a pure number (dimensionless).", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It describes a standard application of the Galerkin finite element method to a one-dimensional boundary value problem in continuum mechanics. All necessary data, including the governing equation, domain, boundary conditions, material properties, and mesh discretization, are provided without ambiguity or contradiction. Therefore, the problem is valid, and a rigorous solution can be constructed.\n\nThe solution proceeds by addressing each of the six tasks in sequence.\n\n1. Derivation of the weak form.\nThe strong form of the governing equation is given as\n$$- \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) = f(x) \\quad \\text{for } x \\in (0,1)$$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\nTo derive the weak form, we multiply the strong form by an admissible weight function $w(x)$ and integrate over the domain $\\Omega = [0,1]$. An admissible weight function must be sufficiently smooth and must satisfy the homogeneous form of any essential (Dirichlet) boundary conditions. Thus, we require $w(0)=0$ and $w(1)=0$.\n\nThe weighted integral statement is:\n$$ - \\int_{0}^{1} w(x) \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right) \\,dx = \\int_{0}^{1} w(x) f(x) \\,dx $$\nWe apply integration by parts to the left-hand side term. Using the formula $\\int_{a}^{b} v \\, du' \\, dx = [vu]_{a}^{b} - \\int_{a}^{b} v' u \\, dx$, we identify $v=w(x)$ and $u' = \\frac{d}{dx}\\!\\left( k(x)\\,\\frac{du}{dx} \\right)$. This implies $u=k(x)\\frac{du}{dx}$ and $v'=\\frac{dw}{dx}$. The left-hand side becomes:\n$$ \\int_{0}^{1} \\frac{dw}{dx} k(x) \\frac{du}{dx} \\,dx - \\left[ w(x) k(x) \\frac{du}{dx} \\right]_{0}^{1} = \\int_{0}^{1} w(x) f(x) \\,dx $$\nThe boundary term, $\\left[ w(x) k(x) \\frac{du}{dx} \\right]_{0}^{1} = w(1) k(1) \\frac{du}{dx}(1) - w(0) k(0) \\frac{du}{dx}(0)$, vanishes because the weight functions are chosen from a space where $w(0)=0$ and $w(1)=0$.\n\nThis leaves the final weak form: find a function $u(x)$ that satisfies the essential boundary conditions such that for all admissible weight functions $w(x)$, the following equation holds:\n$$ \\int_{0}^{1} k(x) \\frac{du}{dx} \\frac{dw}{dx} \\,dx = \\int_{0}^{1} f(x) w(x) \\,dx $$\nThe bilinear form, $B(u,w)$, is the part of the weak form that is linear in both $u$ and $w$:\n$$ B(u,w) = \\int_{0}^{1} k(x) \\frac{du}{dx} \\frac{dw}{dx} \\,dx $$\nThe linear functional, $L(w)$, is the part that is linear in $w$:\n$$ L(w) = \\int_{0}^{1} f(x) w(x) \\,dx $$\n\n2. Element-level Galerkin expressions.\nFor a generic element $e$ spanning the interval $[x_i, x_{i+1}]$ with length $h_e = x_{i+1}-x_i$, the approximate solution $u_h(x)$ is interpolated using local linear shape functions $N_1(x)$ and $N_2(x)$:\n$$ u_h(x)|_{e} = u_i^{(e)} N_1(x) + u_{i+1}^{(e)} N_2(x) $$\nThe shape functions are defined as $N_1(x) = \\frac{x_{i+1}-x}{h_e}$ and $N_2(x) = \\frac{x-x_i}{h_e}$. Their derivatives with respect to $x$ are constant over the element:\n$$ \\frac{dN_1}{dx} = -\\frac{1}{h_e}, \\quad \\frac{dN_2}{dx} = \\frac{1}{h_e} $$\nIn the Galerkin method, the weight functions $w(x)$ are chosen from the same set of functions as the trial functions, i.e., $w(x) = N_a(x)$ for $a \\in \\{1,2\\}$. The element stiffness matrix entries $k^{(e)}_{ab}$ are then given by evaluating the bilinear form for pairs of shape functions on the element domain:\n$$ k^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} k(x)\\,\\frac{dN_a}{dx}\\,\\frac{dN_b}{dx}\\,dx $$\nWriting these integrals explicitly for $a,b \\in \\{1,2\\}$:\n$$ k^{(e)}_{11} = \\int_{x_i}^{x_{i+1}} k(x) \\left( -\\frac{1}{h_e} \\right) \\left( -\\frac{1}{h_e} \\right) dx = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{12} = \\int_{x_i}^{x_{i+1}} k(x) \\left( -\\frac{1}{h_e} \\right) \\left( \\frac{1}{h_e} \\right) dx = -\\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{21} = \\int_{x_i}^{x_{i+1}} k(x) \\left( \\frac{1}{h_e} \\right) \\left( -\\frac{1}{h_e} \\right) dx = -\\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n$$ k^{(e)}_{22} = \\int_{x_i}^{x_{i+1}} k(x) \\left( \\frac{1}{h_e} \\right) \\left( \\frac{1}{h_e} \\right) dx = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx $$\n\n3. Evaluation and computation of element stiffness matrices.\nThe material conductivity is $k(x) = 2(1+x)$. The integral of $k(x)$ over a generic element is:\n$$ \\int_{x_i}^{x_{i+1}} 2(1+x) \\,dx = \\left[ 2x + x^2 \\right]_{x_i}^{x_{i+1}} = (2x_{i+1} + x_{i+1}^2) - (2x_i + x_i^2) = 2(x_{i+1}-x_i) + (x_{i+1}^2-x_i^2) = h_e(2 + x_i + x_{i+1}) $$\nThe scalar coefficient for the element matrix is $C_e = \\frac{1}{h_e^2} \\int_{x_i}^{x_{i+1}} k(x) \\,dx = \\frac{h_e(2+x_i+x_{i+1})}{h_e^2} = \\frac{2+x_i+x_{i+1}}{h_e}$.\n\nThe mesh nodes are $x_0 = 0$, $x_1 = \\frac{1}{4}$, $x_2 = \\frac{3}{4}$, and $x_3 = 1$.\n\nElement 1 ($e=1$): $[x_0, x_1] = [0, \\frac{1}{4}]$.\n$h_1 = x_1 - x_0 = \\frac{1}{4}$.\n$C_1 = \\frac{2+0+\\frac{1}{4}}{\\frac{1}{4}} = \\frac{9/4}{1/4} = 9$.\n$\\mathbf{K}^{(1)} = 9 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 9 & -9 \\\\ -9 & 9 \\end{pmatrix}$.\n\nElement 2 ($e=2$): $[x_1, x_2] = [\\frac{1}{4}, \\frac{3}{4}]$.\n$h_2 = x_2 - x_1 = \\frac{3}{4} - \\frac{1}{4} = \\frac{1}{2}$.\n$C_2 = \\frac{2+\\frac{1}{4}+\\frac{3}{4}}{\\frac{1}{2}} = \\frac{2+1}{\\frac{1}{2}} = \\frac{3}{\\frac{1}{2}} = 6$.\n$\\mathbf{K}^{(2)} = 6 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 6 & -6 \\\\ -6 & 6 \\end{pmatrix}$.\n\nElement 3 ($e=3$): $[x_2, x_3] = [\\frac{3}{4}, 1]$.\n$h_3 = x_3 - x_2 = 1 - \\frac{3}{4} = \\frac{1}{4}$.\n$C_3 = \\frac{2+\\frac{3}{4}+1}{\\frac{1}{4}} = \\frac{3+\\frac{3}{4}}{\\frac{1}{4}} = \\frac{15/4}{1/4} = 15$.\n$\\mathbf{K}^{(3)} = 15 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 15 & -15 \\\\ -15 & 15 \\end{pmatrix}$.\n\n4. Assembly and reduction of the global stiffness matrix.\nThe $4 \\times 4$ global stiffness matrix $\\mathbf{K}_{global}$ is assembled by summing the contributions from each element matrix at the corresponding global degrees of freedom (nodes $0, 1, 2, 3$).\n$K_{11} = K^{(1)}_{11} = 9$\n$K_{22} = K^{(1)}_{22} + K^{(2)}_{11} = 9 + 6 = 15$\n$K_{33} = K^{(2)}_{22} + K^{(3)}_{11} = 6 + 15 = 21$\n$K_{44} = K^{(3)}_{22} = 15$\n$K_{12} = K_{21} = K^{(1)}_{12} = -9$\n$K_{23} = K_{32} = K^{(2)}_{12} = -6$\n$K_{34} = K_{43} = K^{(3)}_{12} = -15$\n$$ \\mathbf{K}_{global} = \\begin{pmatrix}\n9 & -9 & 0 & 0 \\\\\n-9 & 15 & -6 & 0 \\\\\n0 & -6 & 21 & -15 \\\\\n0 & 0 & -15 & 15\n\\end{pmatrix} $$\nThe essential boundary conditions are $u(0)=u_0=0$ and $u(1)=u_3=0$. To obtain the reduced system for the interior unknowns $u_1$ and $u_2$, we eliminate the rows and columns corresponding to degrees of freedom $0$ and $3$. This yields the $2 \\times 2$ reduced global matrix $\\mathbf{K}$ associated with the interior nodes $1$ and $2$:\n$$ \\mathbf{K} = \\begin{pmatrix}\n15 & -6 \\\\\n-6 & 21\n\\end{pmatrix} $$\n\n5. Justification of symmetric positive definite (SPD) property.\nThe discrete energy of the system for an approximate solution $u_h(x)$ is given by $\\frac{1}{2}B(u_h, u_h)$. For a displacement vector $\\widehat{\\boldsymbol{u}}$ of free degrees of freedom, this corresponds to the quadratic form $\\frac{1}{2}\\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$.\n\nSymmetry: The bilinear form $B(u,w) = \\int_{0}^{1} k \\frac{du}{dx}\\frac{dw}{dx} dx$ is symmetric because scalar multiplication is commutative, i.e., $B(u,w)=B(w,u)$. The stiffness matrix $\\mathbf{K}$ is the discrete representation of this bilinear form, with entries $K_{ij} = B(N_j, N_i)$. Therefore, $K_{ij} = B(N_j, N_i) = B(N_i, N_j) = K_{ji}$, proving that $\\mathbf{K}$ is symmetric. This is confirmed by the computed matrix.\n\nPositive Definiteness: We must show that $\\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}} > 0$ for any non-zero vector $\\widehat{\\boldsymbol{u}} \\neq \\mathbf{0}$. The quadratic form corresponds to the integral:\n$$ \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}} = B(u_h, u_h) = \\int_{0}^{1} k(x) \\left( \\frac{du_h}{dx} \\right)^2 dx $$\nwhere $u_h(x)$ is the piecewise-linear function constructed from the vector $\\widehat{\\boldsymbol{u}}$ and satisfying $u_h(0)=0$ and $u_h(1)=0$.\nThe problem states $k(x) = 2(1+x)$, which is strictly positive for all $x \\in [0,1]$. The term $(\\frac{du_h}{dx})^2$ is always non-negative. Therefore, the integrand $k(x)(\\frac{du_h}{dx})^2$ is non-negative everywhere on the domain. The integral can be zero if and only if the integrand is zero almost everywhere. Since $k(x)>0$, this requires $\\frac{du_h}{dx} = 0$ for all $x \\in (0,1)$. This implies that $u_h(x)$ must be a constant function. However, any function $u_h(x)$ corresponding to the reduced system must satisfy the boundary conditions $u_h(0)=0$. A constant function that is zero at $x=0$ must be identically zero, $u_h(x)=0$. This corresponds to a vector of nodal displacements where all entries are zero, i.e., $\\widehat{\\boldsymbol{u}}=\\mathbf{0}$.\nThus, for any non-zero vector $\\widehat{\\boldsymbol{u}}$, the corresponding function $u_h(x)$ is not identically zero, its derivative $\\frac{du_h}{dx}$ is not identically zero, and the integral is strictly positive. This proves that the reduced matrix $\\mathbf{K}$ is positive definite.\n\n6. Computation of discrete energy.\nWe are asked to compute the discrete energy $E_h = \\widehat{\\boldsymbol{u}}^{\\mathsf T}\\,\\mathbf{K}\\,\\widehat{\\boldsymbol{u}}$ for the interior displacement vector $\\widehat{\\boldsymbol{u}} = \\begin{pmatrix}1 & 1\\end{pmatrix}^{\\mathsf T}$ and the reduced matrix $\\mathbf{K} = \\begin{pmatrix} 15 & -6 \\\\ -6 & 21 \\end{pmatrix}$.\n$$ E_h = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 15 & -6 \\\\ -6 & 21 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nFirst, we compute the product $\\mathbf{K}\\widehat{\\boldsymbol{u}}$:\n$$ \\begin{pmatrix} 15 & -6 \\\\ -6 & 21 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 15 \\cdot 1 - 6 \\cdot 1 \\\\ -6 \\cdot 1 + 21 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 15 \\end{pmatrix} $$\nThen, we compute the dot product with $\\widehat{\\boldsymbol{u}}^{\\mathsf T}$:\n$$ E_h = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 9 \\\\ 15 \\end{pmatrix} = 1 \\cdot 9 + 1 \\cdot 15 = 24 $$\nThe discrete energy is $24$.", "answer": "$$\n\\boxed{24}\n$$", "id": "2698892"}, {"introduction": "This practice explores the concept of 'exactness' within an approximation method. By employing a higher-order trial function that happens to contain the true solution for a loaded bar, you will discover that the Galerkin method can recover the exact analytical result. This exercise [@problem_id:2698887] powerfully demonstrates that the accuracy of the MWR is fundamentally tied to the richness of the chosen trial function space.", "problem": "A straight, prismatic bar of length $L$, constant cross-sectional area $A$, and Young’s modulus $E$ lies along the $x$-axis with $x \\in [0,L]$. The bar is fixed at the left end, so the axial displacement satisfies the essential boundary condition $u(0)=0$. The right end at $x=L$ is traction-free. The bar is subjected to a uniform axial body force per unit length $p$ (constant in $x$), directed along the axis.\n\nStarting from the one-dimensional axial equilibrium in strong form, derived from balance of linear momentum and Hooke’s law for small strains,\n$$-\\,\\frac{d}{dx}\\!\\left(EA\\,\\frac{du}{dx}\\right) \\;=\\; p \\quad \\text{in } (0,L),$$\ntogether with the essential boundary condition $u(0)=0$ and the natural boundary condition $EA\\,u'(L)=0$, use the Method of Weighted Residuals (MWR), specifically the Bubnov–Galerkin choice where weighting functions equal the trial functions, to construct and solve the discrete equations over a single quadratic element spanning the entire bar.\n\nAdopt a quadratic Lagrange trial space on the single element with interpolation nodes at $x=0$, $x=L/2$, and $x=L$. Impose the essential boundary condition directly at $x=0$. Use the corresponding quadratic Lagrange shape functions as weights associated with the unconstrained degrees of freedom. Assemble the resulting algebraic system and solve for the nodal unknowns to obtain the approximate displacement field $u_h(x)$.\n\nThen, obtain the exact solution $u_{\\text{exact}}(x)$ by direct integration of the strong form with the given boundary conditions, and compare it with $u_h(x)$. Provide, as your final answer, the fully simplified closed-form expression of the approximate displacement field $u_h(x)$ in terms of $p$, $E$, $A$, $L$, and $x$. Do not perform any numerical substitutions; no rounding is required. Express the final answer without units.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- **System**: A straight, prismatic bar of length $L$, constant cross-sectional area $A$, and Young’s modulus $E$.\n- **Domain**: The bar occupies the spatial domain $x \\in [0,L]$.\n- **Governing Equation (Strong Form)**: $-\\frac{d}{dx}\\left(EA\\,\\frac{du}{dx}\\right) = p$ in $(0,L)$, where $p$ is a constant.\n- **Boundary Conditions**:\n  - Essential Boundary Condition (EBC): $u(0)=0$ (fixed end).\n  - Natural Boundary Condition (NBC): $EA\\,u'(L)=0$ (traction-free end).\n- **Methodology**: Method of Weighted Residuals (MWR), specifically the Bubnov-Galerkin method.\n- **Discretization**: A single quadratic element spanning the domain $[0,L]$.\n- **Trial Space**: Quadratic Lagrange trial functions with interpolation nodes at $x=0$, $x=L/2$, and $x=L$.\n- **BC Implementation**: The EBC $u(0)=0$ is to be imposed directly.\n- **Weighting Functions**: Quadratic Lagrange shape functions corresponding to the unconstrained degrees of freedom.\n- **Objective**:\n  1. Construct and solve the discrete algebraic system to find the approximate displacement field $u_h(x)$.\n  2. Obtain the exact solution $u_{\\text{exact}}(x)$.\n  3. Compare $u_h(x)$ and $u_{\\text{exact}}(x)$.\n  4. Provide the final expression for $u_h(x)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the required criteria.\n- **Scientifically Grounded**: The problem is rooted in one-dimensional linear elasticity, a cornerstone of solid mechanics. The governing differential equation is the standard equilibrium equation for an axial bar subjected to a body force.\n- **Well-Posed**: The problem is a second-order boundary value problem with one essential and one natural boundary condition, which constitutes a well-posed formulation. The Galerkin method is a standard and robust numerical technique for such problems.\n- **Objective**: The problem is stated using precise, unambiguous scientific language.\n- **Completeness and Consistency**: All necessary data, including the governing equation, boundary conditions, material properties, loading, and the specific numerical method, are provided. There are no internal contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, and completely specified. It is therefore deemed **valid**. The solution process will now proceed.\n\nThe solution begins with the formulation of the weak form of the governing equation. We multiply the strong form by a suitable weighting function $w(x)$ and integrate over the domain $[0, L]$:\n$$ \\int_0^L -w(x) \\frac{d}{dx}\\left(EA\\,\\frac{du}{dx}\\right) dx = \\int_0^L w(x) p \\,dx $$\nIntegration by parts is applied to the left-hand side:\n$$ \\int_0^L \\frac{dw}{dx} EA \\frac{du}{dx} dx - \\left[ w(x) EA \\frac{du}{dx} \\right]_0^L = \\int_0^L w(x) p \\,dx $$\nThe boundary term is $\\left[ w EA u' \\right]_0^L = w(L) (EA u'(L)) - w(0) (EA u'(0))$. The natural boundary condition is $EA u'(L)=0$. For the essential boundary condition $u(0)=0$ to be satisfied, the weighting functions $w(x)$ must be chosen from a space of functions where $w(0)=0$. Consequently, the boundary term vanishes entirely. The weak form is thus: Find $u(x)$ such that $u(0)=0$ and for all admissible weighting functions $w(x)$,\n$$ \\int_0^L EA u'(x) w'(x) dx = \\int_0^L p w(x) dx $$\nFor the Bubnov-Galerkin method, the approximate solution $u_h(x)$ and the weighting functions $w(x)$ are drawn from the same finite-dimensional function space. We use a single quadratic element with nodes at $x_1=0$, $x_2=L/2$, and $x_3=L$. The approximate displacement is given by\n$$ u_h(x) = \\sum_{j=1}^3 N_j(x) u_j $$\nwhere $u_j$ is the nodal displacement at $x_j$ and $N_j(x)$ are the quadratic Lagrange shape functions. These are:\n$$ N_1(x) = \\frac{(x-L/2)(x-L)}{(0-L/2)(0-L)} = \\frac{2(x-L/2)(x-L)}{L^2} = \\frac{(2x-L)(x-L)}{L^2} $$\n$$ N_2(x) = \\frac{(x-0)(x-L)}{(L/2-0)(L/2-L)} = \\frac{x(x-L)}{-L^2/4} = \\frac{4x(L-x)}{L^2} $$\n$$ N_3(x) = \\frac{(x-0)(x-L/2)}{(L-0)(L-L/2)} = \\frac{x(x-L/2)}{L^2/2} = \\frac{2x(x-L/2)}{L^2} = \\frac{x(2x-L)}{L^2} $$\nThe essential boundary condition $u(0)=0$ implies $u_1=0$. The approximation for displacement simplifies to:\n$$ u_h(x) = N_2(x) u_2 + N_3(x) u_3 $$\nThe weighting functions are the basis functions associated with the unconstrained degrees of freedom, so we take $w(x)$ to be $N_2(x)$ and $N_3(x)$ in turn. This yields a $2 \\times 2$ system of linear algebraic equations $\\mathbf{K} \\mathbf{d} = \\mathbf{f}$, where $\\mathbf{d} = \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix}$. The components of the stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{f}$ are:\n$$ K_{ij} = \\int_0^L EA N_i'(x) N_j'(x) dx \\quad \\text{and} \\quad f_i = \\int_0^L p N_i(x) dx \\quad \\text{for } i,j \\in \\{2,3\\} $$\nThe derivatives of the relevant shape functions are:\n$$ N_2'(x) = \\frac{d}{dx}\\left(\\frac{4x}{L} - \\frac{4x^2}{L^2}\\right) = \\frac{4}{L} - \\frac{8x}{L^2} $$\n$$ N_3'(x) = \\frac{d}{dx}\\left(\\frac{2x^2}{L^2} - \\frac{x}{L}\\right) = \\frac{4x}{L^2} - \\frac{1}{L} $$\nWe now compute the matrix and vector components. For constants $E$ and $A$:\n$$ K_{22} = EA \\int_0^L \\left(\\frac{4}{L} - \\frac{8x}{L^2}\\right)^2 dx = \\frac{16EA}{L^2} \\int_0^L \\left(1 - \\frac{2x}{L}\\right)^2 dx = \\frac{16EA}{L^2} \\left[\\frac{L}{3}\\right] = \\frac{16EA}{3L} $$\n$$ K_{33} = EA \\int_0^L \\left(\\frac{4x}{L^2} - \\frac{1}{L}\\right)^2 dx = \\frac{EA}{L^2} \\int_0^L \\left(\\frac{4x}{L} - 1\\right)^2 dx = \\frac{EA}{L^2} \\left[\\frac{7L}{3}\\right] = \\frac{7EA}{3L} $$\n$$ K_{23} = K_{32} = EA \\int_0^L \\left(\\frac{4}{L} - \\frac{8x}{L^2}\\right)\\left(\\frac{4x}{L^2} - \\frac{1}{L}\\right) dx = \\frac{EA}{L^3}\\int_0^L (4L-8x)(4x-L) dx = -\\frac{8EA}{3L} $$\nThe force vector components are:\n$$ f_2 = p \\int_0^L N_2(x) dx = p \\int_0^L \\frac{4x(L-x)}{L^2} dx = p \\frac{4}{L^2} \\left[\\frac{Lx^2}{2} - \\frac{x^3}{3}\\right]_0^L = \\frac{2pL}{3} $$\n$$ f_3 = p \\int_0^L N_3(x) dx = p \\int_0^L \\frac{x(2x-L)}{L^2} dx = p \\frac{1}{L^2} \\left[\\frac{2x^3}{3} - \\frac{Lx^2}{2}\\right]_0^L = \\frac{pL}{6} $$\nThe algebraic system is:\n$$ \\frac{EA}{3L} \\begin{pmatrix} 16 & -8 \\\\ -8 & 7 \\end{pmatrix} \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 2pL/3 \\\\ pL/6 \\end{pmatrix} $$\nSolving for the nodal displacements:\n$$ \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\frac{3L}{EA} \\begin{pmatrix} 16 & -8 \\\\ -8 & 7 \\end{pmatrix}^{-1} \\begin{pmatrix} 2pL/3 \\\\ pL/6 \\end{pmatrix} $$\nThe inverse of the matrix is $\\frac{1}{16(7) - (-8)^2} \\begin{pmatrix} 7 & 8 \\\\ 8 & 16 \\end{pmatrix} = \\frac{1}{48} \\begin{pmatrix} 7 & 8 \\\\ 8 & 16 \\end{pmatrix}$.\n$$ \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\frac{3L}{EA} \\frac{1}{48} \\begin{pmatrix} 7 & 8 \\\\ 8 & 16 \\end{pmatrix} \\begin{pmatrix} 2pL/3 \\\\ pL/6 \\end{pmatrix} = \\frac{L}{16EA} \\begin{pmatrix} 7(2pL/3) + 8(pL/6) \\\\ 8(2pL/3) + 16(pL/6) \\end{pmatrix} $$\n$$ \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\frac{L}{16EA} \\begin{pmatrix} 14pL/3 + 4pL/3 \\\\ 16pL/3 + 8pL/3 \\end{pmatrix} = \\frac{L}{16EA} \\begin{pmatrix} 6pL \\\\ 8pL \\end{pmatrix} = \\frac{pL^2}{16EA} \\begin{pmatrix} 6 \\\\ 8 \\end{pmatrix} = \\frac{pL^2}{EA} \\begin{pmatrix} 3/8 \\\\ 1/2 \\end{pmatrix} $$\nThus, $u_2 = \\frac{3pL^2}{8EA}$ and $u_3 = \\frac{pL^2}{2EA}$.\nThe approximate displacement field is constructed by substituting these values back into the expression for $u_h(x)$:\n$$ u_h(x) = \\left(\\frac{3pL^2}{8EA}\\right) N_2(x) + \\left(\\frac{pL^2}{2EA}\\right) N_3(x) $$\n$$ u_h(x) = \\frac{3pL^2}{8EA} \\frac{4x(L-x)}{L^2} + \\frac{pL^2}{2EA} \\frac{x(2x-L)}{L^2} $$\n$$ u_h(x) = \\frac{p}{EA} \\left[ \\frac{3}{2}x(L-x) + \\frac{1}{2}x(2x-L) \\right] $$\n$$ u_h(x) = \\frac{p}{2EA} \\left[ 3(Lx-x^2) + (2x^2-Lx) \\right] = \\frac{p}{2EA} [3Lx - 3x^2 + 2x^2 - Lx] $$\n$$ u_h(x) = \\frac{p}{2EA} (2Lx - x^2) = \\frac{px(2L-x)}{2EA} $$\nFor comparison, the exact solution $u_{\\text{exact}}(x)$ is found by direct integration of $-EAu''=p$.\n$$ u''(x) = -\\frac{p}{EA} $$\n$$ u'(x) = -\\frac{px}{EA} + C_1 $$\n$$ u(x) = -\\frac{px^2}{2EA} + C_1 x + C_2 $$\nApplying boundary conditions:\n- $u(0)=0 \\implies C_2=0$.\n- $EAu'(L)=0 \\implies EA(-\\frac{pL}{EA} + C_1)=0 \\implies C_1 = \\frac{pL}{EA}$.\nThe exact solution is:\n$$ u_{\\text{exact}}(x) = -\\frac{px^2}{2EA} + \\frac{pLx}{EA} = \\frac{p}{2EA}(2Lx - x^2) = \\frac{px(2L-x)}{2EA} $$\nThe approximate solution $u_h(x)$ is identical to the exact solution $u_{\\text{exact}}(x)$. This occurs because the exact solution is a quadratic polynomial, which lies within the space of trial functions chosen for the approximation. The Galerkin method guarantees the best approximation in the energy norm, and when the exact solution is available in the trial space, the method will recover it exactly.\nThe final answer is the expression for $u_h(x)$.", "answer": "$$\n\\boxed{\\frac{p x (2L-x)}{2 E A}}\n$$", "id": "2698887"}, {"introduction": "Real-world problems in solid mechanics are often nonlinear, requiring more advanced solution schemes. This exercise extends the method of weighted residuals into the nonlinear regime by analyzing a hyperelastic bar. You will derive the nonlinear residual vector and, critically, the tangent stiffness matrix which arises from consistent linearization, both of which are cornerstone components for implementing the robust Newton-Raphson method [@problem_id:2698927].", "problem": "Consider a slender hyperelastic bar of undeformed length $L$ and constant cross-sectional area $A$ occupying the reference interval $X \\in [0,L]$. The bar is fixed at $X = 0$ and subjected to a concentrated axial load $P_{\\mathrm{ext}}$ at $X = L$. Assume a Saint Venant–Kirchhoff material with Lamé parameters $\\lambda$ and $\\mu$, and adopt a total Lagrangian description. Let the motion be $\\varphi(X) = X + u(X)$, where $u(X)$ is the axial displacement field in the reference configuration. The Green–Lagrange strain is defined by $E = \\frac{1}{2}\\left(F^{2} - 1\\right)$ with the deformation gradient $F = \\frac{d\\varphi}{dX} = 1 + \\frac{du}{dX}$. The Second Piola–Kirchhoff stress is given by $S = \\mathbb{C} : E$ where $\\mathbb{C}$ is the fourth-order elasticity tensor. In one dimension for Saint Venant–Kirchhoff, $S = (\\lambda + 2\\mu)\\,E$. The First Piola–Kirchhoff stress is $P = F\\,S$.\n\nUsing the method of weighted residuals with the Galerkin choice of weight equal to the trial shape function, approximate the displacement by a single two-node linear finite element with one free degree of freedom $a$ at $X = L$: $u_{h}(X) = a\\,N_{2}(X)$, where $N_{2}(X) = X/L$, and $u_{h}(0) = 0$. Let the weighting function be $w(X) = N_{2}(X)$.\n\nStarting from the weak form of balance of linear momentum in the reference configuration and the definitions given above, perform the following:\n\n1. Derive the scalar residual $r(a)$ associated with the single degree of freedom $a$ by applying the method of weighted residuals in the total Lagrangian form, clearly identifying the internal and external virtual work contributions.\n2. By consistent linearization, derive the exact Jacobian (tangent) $K(a) = \\frac{dr}{da}$.\n3. Briefly explain, using Newton–Kantorovich theory, how using the exact tangent from item $2$ versus an approximate tangent (e.g., taking a constant small-strain tangent evaluated at $a = 0$) affects the local convergence rate of Newton iterations for this problem.\n\nProvide the final answer as the exact closed-form analytic expression for $K(a)$ in terms of $A$, $L$, $\\lambda$, $\\mu$, and $a$. Do not substitute numerical values. Do not include units in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. All necessary information for a unique solution is provided. It represents a standard application of nonlinear finite element methods to a problem in hyperelasticity. Therefore, I will proceed with its solution.\n\nThe problem requires the analysis of a hyperelastic bar using the method of weighted residuals, specifically the Galerkin method, with a single degree of freedom.\n\n1. Derivation of the scalar residual $r(a)$\n\nThe governing equation is the balance of linear momentum in the reference configuration. Its weak form, also known as the principle of virtual work, states that the internal virtual work must equal the external virtual work for any kinematically admissible virtual displacement. For a one-dimensional body, this is expressed as:\n$$ \\delta \\mathcal{W} = \\delta \\mathcal{W}_{\\text{int}} - \\delta \\mathcal{W}_{\\text{ext}} = 0 $$\nwhere $\\delta \\mathcal{W}_{\\text{int}}$ is the internal virtual work and $\\delta \\mathcal{W}_{\\text{ext}}$ is the external virtual work.\n\nThe internal virtual work is given by the integral of the Second Piola–Kirchhoff stress $S$ contracted with the variation of the Green–Lagrange strain $\\delta E$ over the reference volume $V_0$:\n$$ \\delta \\mathcal{W}_{\\text{int}} = \\int_{V_0} S : \\delta E \\, dV_0 = \\int_0^L S \\, \\delta E \\, A \\, dX $$\nThe external virtual work is done by the applied load $P_{\\text{ext}}$ at the point of application, corresponding to the virtual displacement at that point:\n$$ \\delta \\mathcal{W}_{\\text{ext}} = P_{\\text{ext}} \\delta u(L) $$\nThe displacement field is approximated by $u_h(X) = a\\,N_2(X) = a \\frac{X}{L}$. The single degree of freedom is $a$, which represents the displacement at the end of the bar, $u_h(L) = a$.\nThe virtual displacement is a variation of $u_h$ with respect to $a$:\n$$ \\delta u(X) = \\frac{\\partial u_h}{\\partial a} \\delta a = \\frac{X}{L} \\delta a $$\nThe weighting function for the Galerkin method is chosen as $w(X) = \\frac{\\partial u_h}{\\partial a} = \\frac{X}{L}$.\nThe deformation gradient $F$ is:\n$$ F = 1 + \\frac{du_h}{dX} = 1 + \\frac{a}{L} $$\nSince $F$ is constant throughout the bar, the Green–Lagrange strain $E$ is also constant:\n$$ E = \\frac{1}{2}(F^2 - 1) = \\frac{1}{2}\\left(\\left(1 + \\frac{a}{L}\\right)^2 - 1\\right) = \\frac{a}{L} + \\frac{a^2}{2L^2} $$\nThe variation of the strain, $\\delta E$, is:\n$$ \\delta E = \\frac{\\partial E}{\\partial a} \\delta a = \\left(\\frac{1}{L} + \\frac{a}{L^2}\\right)\\delta a = \\frac{1}{L}\\left(1 + \\frac{a}{L}\\right)\\delta a = \\frac{F}{L}\\delta a $$\nThe Second Piola–Kirchhoff stress $S$ for the Saint Venant–Kirchhoff material is:\n$$ S = (\\lambda + 2\\mu)E = (\\lambda + 2\\mu)\\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) $$\nNow, we formulate the internal virtual work contribution:\n$$ \\delta \\mathcal{W}_{\\text{int}} = \\int_0^L S \\, \\delta E \\, A \\, dX = \\int_0^L (\\lambda + 2\\mu)\\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\left(\\frac{F}{L}\\delta a\\right) A \\, dX $$\nSince all terms involving $a$ are constant with respect to $X$, we can move them outside the integral:\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\frac{F}{L} \\delta a \\int_0^L dX $$\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{2L^2}\\right) \\left(1 + \\frac{a}{L}\\right) \\frac{1}{L} L \\delta a $$\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L}+\\frac{a^2}{2L^2}\\right)\\left(1+\\frac{a}{L}\\right) \\delta a $$\nExpanding the expression:\n$$ \\delta \\mathcal{W}_{\\text{int}} = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{a^2}{L^2} + \\frac{a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\delta a = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\delta a $$\nThe external virtual work is:\n$$ \\delta \\mathcal{W}_{\\text{ext}} = P_{\\text{ext}} \\delta u(L) = P_{\\text{ext}} \\delta a $$\nThe residual equation is obtained by setting $\\delta \\mathcal{W} = 0$:\n$$ (\\delta \\mathcal{W}_{\\text{int}} - \\delta \\mathcal{W}_{\\text{ext}}) = \\left[ A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) - P_{\\text{ext}} \\right] \\delta a = 0 $$\nSince this must hold for any arbitrary non-zero $\\delta a$, the scalar residual $r(a)$ is the term in the brackets.\nThe internal force vector (a scalar in this case) is $F_{\\text{int}}(a) = A (\\lambda + 2\\mu) (\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3})$, and the external force vector is $F_{\\text{ext}} = P_{\\text{ext}}$.\nThus, the residual is $r(a) = F_{\\text{int}}(a) - F_{\\text{ext}}$:\n$$ r(a) = A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) - P_{\\text{ext}} $$\n\n2. Derivation of the exact Jacobian (tangent) $K(a)$\n\nThe exact Jacobian, or tangent stiffness, is obtained by taking the derivative of the residual $r(a)$ with respect to the degree of freedom $a$. This procedure is known as consistent linearization.\n$$ K(a) = \\frac{dr(a)}{da} $$\nDifferentiating the expression for $r(a)$ with respect to $a$, and noting that $P_{\\text{ext}}$ is a constant load:\n$$ K(a) = \\frac{d}{da} \\left[ A (\\lambda + 2\\mu) \\left(\\frac{a}{L} + \\frac{3a^2}{2L^2} + \\frac{a^3}{2L^3}\\right) \\right] $$\n$$ K(a) = A (\\lambda + 2\\mu) \\left(\\frac{1}{L} + \\frac{3(2a)}{2L^2} + \\frac{3a^2}{2L^3}\\right) $$\n$$ K(a) = A (\\lambda + 2\\mu) \\left(\\frac{1}{L} + \\frac{3a}{L^2} + \\frac{3a^2}{2L^3}\\right) $$\nThis expression represents the exact tangent stiffness for the single-element approximation of the bar. It is composed of the initial linear stiffness $A(\\lambda+2\\mu)/L$ plus nonlinear terms that depend on the displacement $a$, accounting for geometric nonlinearity.\n\n3. Explanation of convergence rate\n\nThe solution to the nonlinear equation $r(a) = 0$ is found using an iterative scheme. The standard Newton-Raphson method for this problem is:\n$$ a_{k+1} = a_k - [K(a_k)]^{-1} r(a_k) $$\nwhere $k$ is the iteration index and $K(a_k)$ is the exact tangent stiffness evaluated at the current estimate $a_k$.\n\nAccording to Newton–Kantorovich theory, if the initial guess $a_0$ is sufficiently close to the true solution $a^*$, and the Jacobian at the solution $K(a^*)$ is nonsingular, the Newton-Raphson method converges **quadratically**. Quadratic convergence implies that the error $\\epsilon_k = |a_k - a^*|$ decreases according to the relation $\\epsilon_{k+1} \\leq C \\epsilon_k^2$ for some constant $C>0$. This means the number of correct digits in the solution approximately doubles with each iteration, which is a very fast rate of convergence.\n\nIf, instead of the exact tangent $K(a_k)$, an approximate tangent is used, the convergence behavior changes. The problem suggests using a constant tangent evaluated at $a=0$, which is the linear elastic (small-strain) stiffness:\n$$ K_0 = K(a=0) = A (\\lambda + 2\\mu) \\frac{1}{L} $$\nThe iterative scheme becomes a modified Newton method (or constant stiffness method):\n$$ a_{k+1} = a_k - [K_0]^{-1} r(a_k) $$\nThis method's convergence rate is determined by the derivative of its iteration map $g(a) = a - [K_0]^{-1}r(a)$ at the solution $a^*$. The derivative is $g'(a) = 1 - [K_0]^{-1}K(a)$. At the solution, $g'(a^*) = 1 - [K_0]^{-1}K(a^*)$. Unless the problem is linear or the solution happens to be $a^*=0$, $K(a^*) \\neq K_0$, and thus $g'(a^*) \\neq 0$. If $|g'(a^*)| < 1$, the method converges, but the rate of convergence is only **linear**. Linear convergence means the error decreases by a roughly constant factor at each step: $\\epsilon_{k+1} \\leq c \\epsilon_k$, where the convergence factor is $c = |g'(a^*)|$.\n\nIn summary, using the exact tangent $K(a)$ yields quadratic convergence, which is significantly faster than the linear convergence obtained when using an approximate, constant tangent like $K_0$. The computational advantage of the modified Newton method is that the tangent stiffness is computed and factorized only once, which can be beneficial for large systems, but this comes at the cost of a much slower convergence rate.", "answer": "$$\\boxed{A(\\lambda+2\\mu) \\left(\\frac{1}{L} + \\frac{3a}{L^2} + \\frac{3a^2}{2L^3}\\right)}$$", "id": "2698927"}]}