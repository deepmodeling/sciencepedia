{"hands_on_practices": [{"introduction": "Transitioning from the continuous theory of weak formulations to the discrete world of the Finite Element Method is a foundational step in computational mechanics. This first exercise provides a direct, hands-on opportunity to bridge this gap by discretizing the weak form of a simple one-dimensional boundary value problem [@problem_id:2440325]. By manually assembling the stiffness matrix and force vector, you will reveal the fundamental connection between the integral-based weak form and the familiar linear algebraic system $[K]\\{u\\}=\\{F\\}$ that forms the heart of computational analysis.", "problem": "Consider the steady one-dimensional boundary value problem (BVP) for diffusion on the interval $\\left(0,1\\right)$:\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) \\;=\\; f_0 \\quad \\text{in } \\left(0,1\\right),\n$$\nwith the essential boundary condition $u(0)=0$ and the natural boundary condition $k\\,u'(1)=t_0$, where $k>0$, $f_0$ and $t_0$ are given constants. Discretize the weak form of this problem using the standard Galerkin Finite Element Method (FEM) with two uniform linear elements on $\\left[0,1\\right]$ (nodes at $x_0=0$, $x_1=\\tfrac{1}{2}$, $x_2=1$). After imposing the essential boundary condition $u(0)=0$, manually construct the assembled reduced $2\\times 2$ global stiffness matrix and the corresponding right-hand side force vector associated with the unknown nodal values $u_1$ and $u_2$. \n\nProvide your final answer as the determinant of this assembled reduced $2\\times 2$ stiffness matrix, expressed as a simplified analytical expression in terms of $k$ only. Do not include units. No rounding is required.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n- Differential Equation: $- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) = f_0$\n- Domain: $x \\in (0,1)$\n- Boundary Conditions: $u(0)=0$ (essential) and $k\\,u'(1)=t_0$ (natural)\n- Constants: $k>0$, $f_0$, $t_0$ are given constants.\n- Discretization: Standard Galerkin Finite Element Method (FEM) with two uniform linear elements.\n- Nodes: $x_0=0$, $x_1=\\tfrac{1}{2}$, $x_2=1$.\n- Goal: Construct the reduced $2\\times 2$ global stiffness matrix and force vector for unknown nodal values $u_1$ and $u_2$, then find the determinant of this stiffness matrix.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard, second-order, one-dimensional boundary value problem for diffusion.\n- **Scientifically Grounded:** The problem is a canonical representation of steady-state heat conduction or diffusion, a fundamental concept in physics and engineering. It is scientifically sound.\n- **Well-Posed:** The combination of an essential boundary condition at one end and a natural (Neumann) boundary condition at the other for a second-order elliptic equation ensures a unique and stable solution exists. The problem is well-posed.\n- **Objective:** The problem is stated using precise mathematical language, with no subjective or ambiguous terms.\n- **Completeness:** All necessary information, including the differential equation, domain, boundary conditions, discretization scheme, and required output, is explicitly provided. The problem is self-contained.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be developed.\n\nThe starting point is the strong form of the boundary value problem:\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) = f_0 \\quad \\text{for } x \\in (0,1)\n$$\nwith boundary conditions $u(0)=0$ and $k \\frac{du}{dx}(1) = t_0$.\n\nTo derive the weak form, we multiply the differential equation by a suitable test function $v(x)$ and integrate over the domain $\\Omega = (0,1)$:\n$$\n-\\int_{0}^{1} v \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) dx = \\int_{0}^{1} v f_0 dx\n$$\nApplying integration by parts to the left-hand side term gives:\n$$\n\\int_{0}^{1} \\frac{dv}{dx} k \\frac{du}{dx} dx - \\left[ v k \\frac{du}{dx} \\right]_{0}^{1} = \\int_{0}^{1} v f_0 dx\n$$\nRearranging and substituting the boundary conditions:\n$$\n\\int_{0}^{1} k \\frac{du}{dx} \\frac{dv}{dx} dx = \\int_{0}^{1} f_0 v dx + v(1) \\left(k \\frac{du}{dx}(1)\\right) - v(0) \\left(k \\frac{du}{dx}(0)\\right)\n$$\nThe essential boundary condition is $u(0)=0$. The test function $v$ must belong to a space of functions where this condition is met in its homogeneous form, i.e., $v(0)=0$. This causes the term involving $v(0)$ to vanish. The natural boundary condition is $k \\frac{du}{dx}(1) = t_0$. This value is substituted directly.\n\nThe weak form is: Find $u(x) \\in V = \\{ w \\in H^1(0,1) | w(0)=0 \\}$ such that for all $v(x) \\in V$:\n$$\n\\int_{0}^{1} k u'(x) v'(x) dx = \\int_{0}^{1} f_0 v(x) dx + t_0 v(1)\n$$\nThe domain $[0,1]$ is discretized into two uniform elements, denoted $\\Omega_1 = [0, \\tfrac{1}{2}]$ and $\\Omega_2 = [\\tfrac{1}{2}, 1]$. The nodes are at $x_0=0$, $x_1=\\tfrac{1}{2}$, and $x_2=1$. The element length is $h = \\tfrac{1}{2}$.\n\nWe approximate the solution $u(x)$ using linear basis (shape) functions $N_i(x)$:\n$$\nu(x) \\approx u^h(x) = \\sum_{j=0}^{2} u_j N_j(x) = u_0 N_0(x) + u_1 N_1(x) + u_2 N_2(x)\n$$\nwhere $u_j = u(x_j)$ are the nodal values. The Galerkin method uses the basis functions as test functions, $v(x) = N_i(x)$.\n\nThe elemental stiffness matrix for a linear element of length $h$ is given by $K^{(e)}_{ij} = \\int_{\\Omega_e} k \\frac{dN_j}{dx} \\frac{dN_i}{dx} dx$. For a constant $k$ and element length $h$, this is:\n$$\nK^{(e)} = \\frac{k}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nSince $h=\\tfrac{1}{2}$, the stiffness matrix for both elements is:\n$$\nK^{(1)} = K^{(2)} = \\frac{k}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\nThe elemental force vector from the source term $f_0$ is $F^{(e)}_{f,i} = \\int_{\\Omega_e} f_0 N_i dx$. For a constant $f_0$ and linear element, this is:\n$$\nF^{(e)}_f = \\frac{f_0 h}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nSince $h=\\tfrac{1}{2}$, the force vector for both elements is:\n$$\nF^{(1)}_f = F^{(2)}_f = \\frac{f_0 (1/2)}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/4 \\end{pmatrix}\n$$\nNow, we assemble the $3 \\times 3$ global system $K \\mathbf{u} = F$.\nThe global stiffness matrix $K$ is assembled by summing the contributions from each element:\n$$\nK_{00} = K^{(1)}_{11} = 2k\n$$\n$$\nK_{11} = K^{(1)}_{22} + K^{(2)}_{11} = 2k + 2k = 4k\n$$\n$$\nK_{22} = K^{(2)}_{22} = 2k\n$$\n$$\nK_{01} = K_{10} = K^{(1)}_{12} = -2k\n$$\n$$\nK_{12} = K_{21} = K^{(2)}_{12} = -2k\n$$\nSo, the global stiffness matrix is:\n$$\nK = \\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix}\n$$\nThe global force vector $F$ has contributions from the source term $f_0$ and the natural boundary condition $t_0$. The total force vector is $F_i = \\int_0^1 f_0 N_i dx + t_0 N_i(1)$.\n$$\nF_0 = \\int_{\\Omega_1} f_0 N_0 dx + t_0 N_0(1) = f_0/4 + t_0(0) = f_0/4\n$$\n$$\nF_1 = \\int_{\\Omega_1} f_0 N_1 dx + \\int_{\\Omega_2} f_0 N_1 dx + t_0 N_1(1) = f_0/4 + f_0/4 + t_0(0) = f_0/2\n$$\n$$\nF_2 = \\int_{\\Omega_2} f_0 N_2 dx + t_0 N_2(1) = f_0/4 + t_0(1) = f_0/4 + t_0\n$$\nThe assembled system is:\n$$\n\\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\nNext, we impose the essential boundary condition $u(0)=u_0=0$. This reduces the system to a $2 \\times 2$ system for the unknown nodal values $u_1$ and $u_2$. We consider the second and third rows of the full system and substitute $u_0=0$:\n$$\n-2k(u_0) + 4k u_1 - 2k u_2 = f_0/2 \\implies 4k u_1 - 2k u_2 = f_0/2\n$$\n$$\n0(u_0) - 2k u_1 + 2k u_2 = f_0/4 + t_0 \\implies -2k u_1 + 2k u_2 = f_0/4 + t_0\n$$\nThe resulting reduced $2 \\times 2$ system is:\n$$\n\\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\nThe problem asks for the determinant of the assembled reduced $2 \\times 2$ global stiffness matrix, which is:\n$$\nK_{reduced} = \\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\nThe determinant is calculated as:\n$$\n\\det(K_{reduced}) = (4k)(2k) - (-2k)(-2k) = 8k^2 - 4k^2 = 4k^2\n$$\nThis is the required expression.", "answer": "$$\\boxed{4k^{2}}$$", "id": "2440325"}, {"introduction": "Real-world engineering problems often involve non-zero prescribed displacements, known as non-homogeneous essential boundary conditions. This practice introduces the powerful technique of \"lifting,\" where the solution field is decomposed to transform the problem back into a familiar setting with homogeneous boundary conditions [@problem_id:2711090]. By performing this decomposition and calculating the resulting terms, you will understand how the non-homogeneous boundary data is systematically incorporated into the linear functional of the weak form, effectively treating it as a type of applied load.", "problem": "Consider a $1$-dimensional axially loaded bar occupying the open interval $\\Omega = (0,L)$ with $L&gt;0$. Let the axial stiffness field be $k(x)$ and the distributed axial load be $f(x)$, both sufficiently smooth on $\\Omega$. Under small strains, static equilibrium, and no inertial effects, the displacement field $u(x)$ satisfies the strong form boundary value problem with essential (Dirichlet) boundary conditions $u(0)=0$ and $u(L)=\\delta$, where $\\delta$ is a prescribed nonzero displacement. In this setting, your tasks are:\n- Starting from the principle of virtual work for axial deformation and the definitions of strain and axial force, derive the weak (variational) form over the Sobolev space $H^{1}(0,L)$ with homogeneous essential data by introducing a lifting $w(x)$ that satisfies $w(0)=0$ and $w(L)=\\delta$, and then setting $v(x) \\coloneqq u(x)-w(x) \\in H_{0}^{1}(0,L)$. Clearly identify the bilinear form and the linear functional in your weak form for $v$.\n- Specialize to the data $k(x) = k_{0}\\left(1+\\alpha x\\right)$ with $k_{0}&gt;0$ and real $\\alpha$, and $f(x)= f_{0}\\, x$ with real $f_{0}$. Choose the linear lifting $w(x)=\\delta\\, x/L$, so that $w(0)=0$ and $w(L)=\\delta$. For the specific test function $\\varphi(x) = \\dfrac{x\\,(L-x)}{L} \\in H_{0}^{1}(0,L)$, compute in closed form the resulting linear functional $\\ell(\\varphi)$ that appears on the right-hand side of your weak form for $v$.\n\nProvide your final answer as a single closed-form analytic expression in terms of the symbols $k_{0}$, $\\alpha$, $f_{0}$, $L$, and $\\delta$. Do not include units in your final expression. No numerical rounding is required.", "solution": "The problem requires the derivation of the weak form for an axially loaded bar with non-homogeneous Dirichlet boundary conditions, and then a specific calculation based on this form. The procedure begins with validating the problem statement. The problem is found to be scientifically grounded, well-posed, objective, and internally consistent, containing all necessary information for its resolution. It represents a standard application of variational principles in solid mechanics. Therefore, I will proceed with the solution.\n\nThe strong form of the static equilibrium for a one-dimensional bar is given by the differential equation:\n$$\n\\frac{d}{dx}\\left( N(x) \\right) + f(x) = 0 \\quad \\text{for } x \\in \\Omega = (0,L)\n$$\nwhere $N(x)$ is the internal axial force and $f(x)$ is the distributed axial load. The constitutive law for linear elasticity under small strains relates the axial force to the displacement gradient (strain, $\\varepsilon$) via the axial stiffness $k(x) = E(x)A(x)$, where $E(x)$ is Young's modulus and $A(x)$ is the cross-sectional area. The strain is $\\varepsilon(x) = \\frac{du}{dx}$. Thus, $N(x) = k(x) \\frac{du}{dx}$. Substituting this into the equilibrium equation yields the strong form boundary value problem for the displacement $u(x)$:\n$$\n\\frac{d}{dx}\\left( k(x) \\frac{du}{dx} \\right) + f(x) = 0, \\quad u(0)=0, \\quad u(L)=\\delta\n$$\n\nTo derive the weak form, we employ the principle of virtual work. This principle states that for any kinematically admissible virtual displacement $\\varphi(x)$, the internal virtual work equals the external virtual work. For this problem, the essential boundary conditions are specified at $x=0$ and $x=L$. Therefore, any admissible virtual displacement must vanish at these points, i.e., $\\varphi(0)=0$ and $\\varphi(L)=0$. The space of such test functions is the Sobolev space $H_{0}^{1}(0,L)$.\n\nThe internal virtual work is the work done by the stress against the virtual strain:\n$$\n\\delta W_{\\text{int}} = \\int_{0}^{L} N(x) \\delta \\varepsilon(x) \\, dx = \\int_{0}^{L} \\left( k(x) \\frac{du}{dx} \\right) \\left( \\frac{d\\varphi}{dx} \\right) \\, dx\n$$\nThe external virtual work is the work done by the applied body forces:\n$$\n\\delta W_{\\text{ext}} = \\int_{0}^{L} f(x) \\varphi(x) \\, dx\n$$\nEquating the internal and external virtual work, we obtain the weak form for the displacement $u(x)$: Find $u \\in H^{1}(0,L)$ such that $u(0)=0$ and $u(L)=\\delta$, satisfying\n$$\n\\int_{0}^{L} k(x) \\frac{du}{dx} \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx \\quad \\forall \\varphi \\in H_{0}^{1}(0,L)\n$$\n\nThe problem specifies handling the non-homogeneous boundary condition $u(L)=\\delta$ by decomposing the solution $u(x)$ into $u(x) = v(x) + w(x)$. Here, $w(x)$ is a known \"lifting\" function in $H^{1}(0,L)$ that satisfies the non-homogeneous boundary conditions, $w(0)=0$ and $w(L)=\\delta$. The new unknown, $v(x)$, must then satisfy homogeneous boundary conditions, $v(0)=u(0)-w(0)=0-0=0$ and $v(L)=u(L)-w(L)=\\delta-\\delta=0$. This implies that the new unknown function $v(x)$ belongs to the same space as the test functions, i.e., $v \\in H_{0}^{1}(0,L)$.\n\nWe substitute the decomposition $u(x) = v(x) + w(x)$ into the weak form. The derivative is $\\frac{du}{dx} = \\frac{dv}{dx} + \\frac{dw}{dx}$. This gives:\n$$\n\\int_{0}^{L} k(x) \\left( \\frac{dv}{dx} + \\frac{dw}{dx} \\right) \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx\n$$\nUsing the linearity of the integral, we expand the left-hand side:\n$$\n\\int_{0}^{L} k(x) \\frac{dv}{dx} \\frac{d\\varphi}{dx} \\, dx + \\int_{0}^{L} k(x) \\frac{dw}{dx} \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx\n$$\nTo obtain the standard variational problem for $v$, we move all terms involving the known functions $w(x)$ and $f(x)$ to the right-hand side. The unknown $v(x)$ remains on the left.\n$$\n\\int_{0}^{L} k(x) \\frac{dv}{dx} \\frac{d\\varphi}{dx} \\, dx = \\int_{0}^{L} f(x) \\varphi(x) \\, dx - \\int_{0}^{L} k(x) \\frac{dw}{dx} \\frac{d\\varphi}{dx} \\, dx\n$$\nThis is the weak form for $v(x)$. It is of the form $a(v, \\varphi) = \\ell(\\varphi)$, where:\n- The bilinear form is $a(v, \\varphi) = \\int_{0}^{L} k(x) v'(x) \\varphi'(x) \\, dx$.\n- The linear functional is $\\ell(\\varphi) = \\int_{0}^{L} f(x) \\varphi(x) \\, dx - \\int_{0}^{L} k(x) w'(x) \\varphi'(x) \\, dx$.\n\nNow, we specialize to the given data and compute $\\ell(\\varphi)$ for the specified test function.\nThe given functions are:\n- Stiffness: $k(x) = k_{0}(1+\\alpha x)$\n- Load: $f(x)= f_{0}x$\n- Lifting function: $w(x)=\\delta x/L$, so its derivative is $w'(x) = \\delta/L$.\n- Test function: $\\varphi(x) = \\frac{x(L-x)}{L} = x - \\frac{x^2}{L}$, so its derivative is $\\varphi'(x) = 1 - \\frac{2x}{L}$.\n\nThe linear functional $\\ell(\\varphi)$ is the sum of two integrals, which we compute separately.\n$$\n\\ell(\\varphi) = \\underbrace{\\int_{0}^{L} f_{0}x \\left( \\frac{x(L-x)}{L} \\right) \\, dx}_{I_1} - \\underbrace{\\int_{0}^{L} k_{0}(1+\\alpha x) \\left(\\frac{\\delta}{L}\\right) \\left(1 - \\frac{2x}{L}\\right) \\, dx}_{I_2}\n$$\nThe first integral $I_1$ is:\n$$\nI_1 = \\frac{f_{0}}{L} \\int_{0}^{L} (Lx^2 - x^3) \\, dx = \\frac{f_{0}}{L} \\left[ L\\frac{x^3}{3} - \\frac{x^4}{4} \\right]_{0}^{L} = \\frac{f_{0}}{L} \\left( \\frac{L^4}{3} - \\frac{L^4}{4} \\right) = \\frac{f_{0}}{L} \\left( \\frac{L^4}{12} \\right) = \\frac{f_{0}L^3}{12}\n$$\nThe second integral $I_2$ is:\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\int_{0}^{L} (1+\\alpha x)\\left(1 - \\frac{2x}{L}\\right) \\, dx = \\frac{k_{0}\\delta}{L} \\int_{0}^{L} \\left(1 - \\frac{2x}{L} + \\alpha x - \\frac{2\\alpha x^2}{L}\\right) \\, dx\n$$\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\left[ x - \\frac{x^2}{L} + \\frac{\\alpha x^2}{2} - \\frac{2\\alpha x^3}{3L} \\right]_{0}^{L}\n$$\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\left( (L - \\frac{L^2}{L} + \\frac{\\alpha L^2}{2} - \\frac{2\\alpha L^3}{3L}) - (0) \\right) = \\frac{k_{0}\\delta}{L} \\left( L - L + \\frac{\\alpha L^2}{2} - \\frac{2\\alpha L^2}{3} \\right)\n$$\n$$\nI_2 = \\frac{k_{0}\\delta}{L} \\left( \\frac{3\\alpha L^2 - 4\\alpha L^2}{6} \\right) = \\frac{k_{0}\\delta}{L} \\left( -\\frac{\\alpha L^2}{6} \\right) = -\\frac{k_{0}\\alpha\\delta L}{6}\n$$\nFinally, we compute $\\ell(\\varphi) = I_1 - I_2$:\n$$\n\\ell(\\varphi) = \\frac{f_{0}L^3}{12} - \\left(-\\frac{k_{0}\\alpha\\delta L}{6}\\right) = \\frac{f_{0}L^3}{12} + \\frac{k_{0}\\alpha\\delta L}{6}\n$$\nThis is the closed-form expression for the linear functional evaluated at the given test function $\\varphi(x)$.", "answer": "$$\n\\boxed{\\frac{f_{0}L^{3}}{12} + \\frac{k_{0}\\alpha\\delta L}{6}}\n$$", "id": "2711090"}, {"introduction": "While enforcing essential boundary conditions by directly constraining the function space is standard, it has limitations in advanced applications like contact mechanics or unfitted meshes. This exercise explores the modern concept of imposing Dirichlet conditions *weakly*, as an integral part of the variational statement itself [@problem_id:2711092]. By deriving the formulation for Nitsche's method, you will learn how boundary constraints can be treated more flexibly and gain insight into the crucial role of stabilization parameters in ensuring the well-posedness and stability of these advanced numerical schemes.", "problem": "A prismatic, linearly elastic bar of length $L$, constant cross-sectional area $A$, and Young’s modulus $E$ occupies the interval $\\Omega = (0,L)$. Let $u(x)$ denote the axial displacement. The governing strong form under quasi-static, small-strain assumptions with no body force is\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)=0\\quad\\text{in}\\ \\Omega,\n$$\nwith a homogeneous Dirichlet boundary condition $u(0)=0$ at the left end and a homogeneous Neumann boundary condition $\\sigma(L)n(L)=0$ at the right end, where $\\sigma=E\\varepsilon$ with $\\varepsilon=u'$ and $n$ is the outward unit normal ($n(0)=-1$, $n(L)=+1$). You will treat the Dirichlet boundary condition $u(0)=0$ by three weak imposition strategies and then specialize to a single linear finite element to extract a stability threshold.\n\nTasks:\n1) Starting from the strong form and the definitions $\\varepsilon=u'$ and $\\sigma=E\\varepsilon$, derive the standard weak form by multiplying the equilibrium equation by an admissible test function $v$ and integrating by parts. State clearly the boundary terms that arise and how they are treated when $u(0)=0$ is not imposed strongly.\n\n2) For the boundary $\\Gamma_D=\\{0\\}$, write down the modified weak forms that weakly enforce $u(0)=0$ using each of the following:\n- Penalty method with penalty parameter $\\alpha>0$ scaled as $(\\alpha EA/h)\\int_{\\Gamma_D}uv$, where $h$ is a characteristic mesh size associated with $\\Gamma_D$.\n- Symmetric Nitsche method with stabilization parameter $\\gamma>0$ scaled as $(\\gamma EA/h)\\int_{\\Gamma_D}uv$.\n- Lagrange multiplier method introducing an auxiliary unknown $\\lambda$ on $\\Gamma_D$.\n\nTake the prescribed displacement to be homogeneous, $u_D=0$, so that all load-like contributions from the boundary condition vanish.\n\n3) Consider a single two-node linear Finite Element Method (FEM) discretization over the entire bar, with nodal unknowns $u_1=u(0)$ and $u_2=u(L)$, and shape functions $N_1(x)=1-x/L$ and $N_2(x)=x/L$. Using the symmetric Nitsche formulation from part $2$, assemble the element stiffness contributions from the domain integral and the boundary terms at $x=0$. Express the resulting $2\\times 2$ element stiffness matrix as a function of $E$, $A$, $L$, $h$, and $\\gamma$.\n\n4) Determine the smallest value of the Nitsche stabilization parameter $\\gamma$ that guarantees the resulting $2\\times 2$ element stiffness matrix is positive definite. Express your final answer as a single closed-form analytic expression in terms of $h$ and $L$ only. Do not include units. No numerical rounding is required.", "solution": "The problem will be validated against the required criteria before a solution is attempted.\n\n### Step 1: Extract Givens\n- Governing Equation: $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)=0$ in the domain $\\Omega = (0,L)$.\n- Material and Geometric Properties: Linearly elastic bar with constant cross-sectional area $A$, Young’s modulus $E$, and length $L$.\n- Kinematics: $u(x)$ is the axial displacement, $\\varepsilon=u'$ is the strain.\n- Constitutive Law: $\\sigma=E\\varepsilon$.\n- Boundary Conditions (Strong Form): Homogeneous Dirichlet $u(0)=0$ at $x=0$. Homogeneous Neumann $\\sigma(L)n(L)=0$ at $x=L$.\n- Outward Unit Normal: $n(0)=-1$, $n(L)=+1$.\n- Weak Imposition Methods for $u(0)=u_D=0$:\n  - Penalty method: Modified weak form includes the term $(\\alpha EA/h)\\int_{\\Gamma_D}uv$ with penalty parameter $\\alpha>0$ and characteristic length $h$.\n  - Symmetric Nitsche method: Modified weak form uses a stabilization parameter $\\gamma>0$ and a term scaled as $(\\gamma EA/h)\\int_{\\Gamma_D}uv$.\n  - Lagrange multiplier method: Introduces an auxiliary unknown $\\lambda$ on $\\Gamma_D=\\{0\\}$.\n- Finite Element Discretization: A single two-node linear element is used.\n  - Nodal displacements: $u_1 = u(0)$, $u_2 = u(L)$.\n  - Shape functions: $N_1(x) = 1-x/L$, $N_2(x) = x/L$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the standard theory of linear elasticity and computational solid mechanics (Finite Element Method). The concepts of strong and weak forms, integration by parts, and boundary condition imposition techniques (Penalty, Nitsche, Lagrange multiplier) are fundamental and well-established in this field. The problem is well-posed, providing all necessary information for a sequence of logical derivations. The language is objective and precise. The problem does not violate any of the invalidity criteria. It is a standard, albeit non-trivial, exercise in applied mechanics and numerical analysis.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n***\n\nThe solution proceeds by addressing each of the four specified tasks.\n\n### Task 1: Derivation of the Standard Weak Form\nThe strong form of the equilibrium equation is given as:\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) = 0, \\quad x \\in \\Omega=(0,L)\n$$\nTo derive the weak form, we multiply this equation by an arbitrary, admissible test function $v(x)$ and integrate over the domain $\\Omega$:\n$$\n-\\int_{0}^{L} v(x) \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) \\mathrm{d}x = 0\n$$\nApplying integration by parts, $\\int_a^b f'g \\, dx = [fg]_a^b - \\int_a^b fg' \\, dx$, with $g=v$ and $f' = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)$, yields:\n$$\n\\int_{0}^{L} \\frac{\\mathrm{d}v}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) \\mathrm{d}x - \\left[v(x) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\right]_{0}^{L} = 0\n$$\nExpanding the boundary term, we obtain:\n$$\n\\int_{0}^{L} EA \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\mathrm{d}x = v(L) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\bigg|_{x=L} - v(0) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\bigg|_{x=0}\n$$\nThe terms on the right-hand side are the boundary terms. They represent the work done by the boundary tractions. The traction is defined as $t = \\sigma n = (E\\varepsilon)n$. The force is $A t$.\nAt the right end, $x=L$, the outward normal is $n(L)=+1$. The problem states a homogeneous Neumann condition $\\sigma(L)n(L)=0$, which implies $E u'(L)=0$. Consequently, the boundary term at $x=L$ vanishes: $v(L) \\left(EA\\,u'(L)\\right) = 0$.\nAt the left end, $x=0$, the boundary term is $-v(0) (EA u'(0))$. This term involves the unknown flux (reaction force) at the Dirichlet boundary.\n\nWhen the Dirichlet condition $u(0)=0$ is not imposed strongly on the function spaces for $u$ and $v$, this boundary term at $x=0$ persists. The resulting weak form is:\nFind $u(x)$ such that for all admissible $v(x)$:\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x = -v(0) \\left(EA\\,u'(0)\\right)\n$$\nThe term at $x=0$ must be handled by the weak imposition methods.\n\n### Task 2: Modified Weak Forms\nThe goal is to weakly enforce the condition $u(0)=u_D=0$.\n\n**Penalty Method:** This method adds a penalty term to the weak form that penalizes deviations from the Dirichlet condition. The unknown flux term is discarded. The specified penalty term is $\\frac{\\alpha EA}{h} \\int_{\\Gamma_D} uv \\,d\\Gamma$. For $\\Gamma_D=\\{0\\}$, this integral becomes a point evaluation at $x=0$. The modified weak form is:\nFind $u(x)$ such that for all $v(x)$:\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + \\frac{\\alpha EA}{h} u(0) v(0) = 0\n$$\n\n**Symmetric Nitsche Method:** This method modifies the weak form by replacing the unknown reaction flux at the Dirichlet boundary with three new terms: a consistency term, a symmetry term, and a stabilization term. One common symmetric formulation for this problem is:\nFind $u(x)$ such that for all $v(x)$:\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x \\underbrace{- v(0) E A u'(0)}_{\\text{Consistency}} \\underbrace{- u(0) E A v'(0)}_{\\text{Symmetry}} + \\underbrace{\\frac{\\gamma EA}{h} u(0)v(0)}_{\\text{Stabilization}} = 0\n$$\nThis form is derived by starting with the strong form, integrating by parts, and then strategically adding terms that are zero for the exact solution. The consistency term ensures that if the solution is sufficiently smooth, the original differential equation is recovered. The symmetry term ensures the resulting stiffness matrix is symmetric. The stabilization term, with a sufficiently large parameter $\\gamma$, guarantees the problem is well-posed. For our case with no body force ($f=0$) and a homogeneous Neumann condition at $x=L$, this is the complete weak form.\n\n**Lagrange Multiplier Method:** This method introduces a Lagrange multiplier $\\lambda$ to enforce the constraint $u(0)=u_D=0$. $\\lambda$ acts as the reaction force at $x=0$. We form a mixed system. The modified weak formulation is a system of two equations:\nFind $(u, \\lambda) \\in H^1(\\Omega) \\times \\mathbb{R}$ such that for all test functions $(v, \\mu) \\in H^1(\\Omega) \\times \\mathbb{R}$:\n$$\n\\begin{cases}\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + \\lambda v(0) = 0 \\\\\n\\mu u(0) = 0\n\\end{cases}\n$$\n\n### Task 3: FEM Discretization with Symmetric Nitsche\nWe discretize the fields $u(x)$ and $v(x)$ using the given linear shape functions:\n$u(x) = N_1(x)u_1 + N_2(x)u_2$ and $v(x) = N_1(x)v_1 + N_2(x)v_2$.\nThe derivatives are constant: $u'(x) = N_1'u_1 + N_2'u_2 = -\\frac{1}{L}u_1 + \\frac{1}{L}u_2 = \\frac{u_2-u_1}{L}$. Similarly, $v'(x) = \\frac{v_2-v_1}{L}$.\nThe values at the boundary $x=0$ are $u(0)=u_1$ and $v(0)=v_1$.\nWe assemble the element stiffness matrix $\\mathbf{K}$ from the symmetric Nitsche weak form $B_N(u,v)=0$, which is represented as $\\mathbf{v}^T \\mathbf{K} \\mathbf{u} = 0$. We evaluate each term.\n\n1.  **Domain Term**:\n    $$\n    \\int_0^L EA u' v' \\, \\mathrm{d}x = \\int_0^L EA \\left(\\frac{u_2-u_1}{L}\\right) \\left(\\frac{v_2-v_1}{L}\\right) \\mathrm{d}x = \\frac{EA}{L^2}(u_2-u_1)(v_2-v_1) \\int_0^L \\mathrm{d}x = \\frac{EA}{L}(u_2-u_1)(v_2-v_1)\n    $$\n    This corresponds to the standard bar element stiffness matrix: $\\mathbf{K}_{domain} = \\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\n2.  **Nitsche Boundary Terms at $x=0$**:\n    We assemble the contributions from the Nitsche terms: $-v(0)EAu'(0) - u(0)EAv'(0) + \\frac{\\gamma EA}{h}u(0)v(0)$.\n    Consistency term contribution: $-v(0)EAu'(0) = -v_1 EA \\frac{u_2-u_1}{L} = \\frac{EA}{L}(v_1u_1 - v_1u_2)$. The matrix contribution is $\\mathbf{K}_{N1} = \\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ 0 & 0 \\end{pmatrix}$.\n    Symmetry term contribution: $-u(0)EAv'(0) = -u_1 EA \\frac{v_2-v_1}{L} = \\frac{EA}{L}(u_1v_1 - u_1v_2)$. The matrix contribution is $\\mathbf{K}_{N2} = \\frac{EA}{L}\\begin{pmatrix} 1 & 0 \\\\ -1 & 0 \\end{pmatrix}$.\n    Stabilization term contribution: $+\\frac{\\gamma EA}{h} u(0)v(0) = \\frac{\\gamma EA}{h} u_1v_1$. The matrix contribution is $\\mathbf{K}_{N3} = \\frac{\\gamma EA}{h}\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$.\n\n3.  **Total Element Stiffness Matrix**:\n    The total stiffness matrix $\\mathbf{K}$ is the sum $\\mathbf{K}_{domain} + \\mathbf{K}_{N1} + \\mathbf{K}_{N2} + \\mathbf{K}_{N3}$.\n    $$\n    \\mathbf{K} = \\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} + \\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ 0 & 0 \\end{pmatrix} + \\frac{EA}{L}\\begin{pmatrix} 1 & 0 \\\\ -1 & 0 \\end{pmatrix} + \\frac{\\gamma EA}{h}\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n    $$\n    Summing the components:\n    $K_{11} = \\frac{EA}{L} + \\frac{EA}{L} + \\frac{EA}{L} + \\frac{\\gamma EA}{h} = \\frac{3EA}{L} + \\frac{\\gamma EA}{h}$\n    $K_{12} = -\\frac{EA}{L} - \\frac{EA}{L} + 0 + 0 = -\\frac{2EA}{L}$\n    $K_{21} = -\\frac{EA}{L} - \\frac{EA}{L} + 0 + 0 = -\\frac{2EA}{L}$\n    $K_{22} = \\frac{EA}{L} + 0 + 0 + 0 = \\frac{EA}{L}$\n    The resulting $2\\times 2$ element stiffness matrix is:\n    $$\n    \\mathbf{K} = \\begin{pmatrix} \\frac{3EA}{L} + \\frac{\\gamma EA}{h} & -\\frac{2EA}{L} \\\\ -\\frac{2EA}{L} & \\frac{EA}{L} \\end{pmatrix}\n    $$\n\n### Task 4: Stability Threshold for $\\gamma$\nFor the matrix $\\mathbf{K}$ to be positive definite, its leading principal minors must be strictly positive. For a symmetric $2 \\times 2$ matrix, this requires $K_{11} > 0$ and $\\det(\\mathbf{K}) > 0$.\n\n1.  **First Condition ($K_{11} > 0$)**:\n    $$\n    K_{11} = \\frac{3EA}{L} + \\frac{\\gamma EA}{h} > 0\n    $$\n    Given that $E, A, L, h$ are positive physical quantities and the problem states $\\gamma > 0$, this condition is always satisfied.\n\n2.  **Second Condition ($\\det(\\mathbf{K}) > 0$)**:\n    $$\n    \\det(\\mathbf{K}) = K_{11}K_{22} - K_{12}K_{21} > 0\n    $$\n    $$\n    \\left(\\frac{3EA}{L} + \\frac{\\gamma EA}{h}\\right)\\left(\\frac{EA}{L}\\right) - \\left(-\\frac{2EA}{L}\\right)^2 > 0\n    $$\n    We can factor out $(EA)^2$, which is positive:\n    $$\n    \\left(\\frac{3}{L} + \\frac{\\gamma}{h}\\right)\\frac{1}{L} - \\frac{4}{L^2} > 0\n    $$\n    $$\n    \\frac{3}{L^2} + \\frac{\\gamma}{hL} - \\frac{4}{L^2} > 0\n    $$\n    $$\n    \\frac{\\gamma}{hL} - \\frac{1}{L^2} > 0\n    $$\n    $$\n    \\frac{\\gamma}{hL} > \\frac{1}{L^2}\n    $$\n    Multiplying by $hL^2$ (which is positive) gives:\n    $$\n    \\gamma L > h \\implies \\gamma > \\frac{h}{L}\n    $$\n    The matrix is strictly positive definite for any value of $\\gamma$ greater than $\\frac{h}{L}$. The smallest value of $\\gamma$ that guarantees this is the lower bound of this interval.\n\nThe required smallest value is therefore $\\frac{h}{L}$.", "answer": "$$\n\\boxed{\\frac{h}{L}}\n$$", "id": "2711092"}]}