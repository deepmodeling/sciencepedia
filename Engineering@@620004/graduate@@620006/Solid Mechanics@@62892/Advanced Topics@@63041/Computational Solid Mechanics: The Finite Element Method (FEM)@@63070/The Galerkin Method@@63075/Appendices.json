{"hands_on_practices": [{"introduction": "This first exercise is a cornerstone of the finite element method. It guides you through the process of translating the abstract bilinear form from the Galerkin weak formulation into a concrete element stiffness matrix, the building block of the entire analysis. By working through the specific case of a linear elastic element, you will gain hands-on experience with the roles of shape functions, the strain-displacement operator, and the material constitutive law in forming the discrete system [@problem_id:2697408].", "problem": "Consider a two-dimensional, static, small-strain, linear elastic body occupying a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{2}$ with outward unit normal $\\boldsymbol{n}$. Let the displacement field be $\\boldsymbol{u}:\\Omega \\rightarrow \\mathbb{R}^{2}$, the body force density be $\\boldsymbol{b}:\\Omega \\rightarrow \\mathbb{R}^{2}$, and the prescribed traction be $\\boldsymbol{t}:\\Gamma_{t} \\rightarrow \\mathbb{R}^{2}$ on the Neumann boundary $\\Gamma_{t}\\subset \\partial \\Omega$. The constitutive law is linear elasticity with a fourth-order elasticity tensor $\\mathbb{C}$ (assumed homogeneous and isotropic), and the small-strain tensor is $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})=\\nabla^{s}\\boldsymbol{u}=\\tfrac{1}{2}(\\nabla \\boldsymbol{u}+\\nabla \\boldsymbol{u}^{T})$. Starting from the weak form $a(\\boldsymbol{u},\\boldsymbol{v})=\\ell(\\boldsymbol{v})$ for all virtual displacements $\\boldsymbol{v}\\in [H^{1}(\\Omega)]^{2}$ that vanish on the Dirichlet boundary, derive the finite element Galerkin discretization using `$C^0$`-continuous, piecewise linear shape functions over a triangulation of $\\Omega$. In particular:\n- Derive the explicit expression for the entries of the element stiffness matrix in terms of derivatives of the scalar shape functions and the components of the elasticity tensor, beginning from the bilinear form $a(\\boldsymbol{u},\\boldsymbol{v})$ and the Galerkin ansatz for $\\boldsymbol{u}$ and $\\boldsymbol{v}$.\n- Clearly state the role of the symmetric gradient operator and the constitutive tensor in the derivation.\n- Define the element degrees of freedom ordering and present the element strain-displacement operator that connects shape function gradients to strains.\n- Explain precisely how the resulting element matrices are assembled into the global stiffness matrix using the element-to-global degree-of-freedom mapping.\n\nThen, to make the derivation concrete, specialize to plane strain in two dimensions with isotropic elasticity characterized by Young’s modulus $E$ and Poisson’s ratio $\\nu$, and consider a single constant-thickness triangular element with nodes\n- node $1$ at $(x_{1},y_{1})=(0,0)$,\n- node $2$ at $(x_{2},y_{2})=(0.3,0)$,\n- node $3$ at $(x_{3},y_{3})=(0,0.2)$,\nand uniform out-of-plane thickness $t$. Use the canonical element degree-of-freedom ordering $[u_{1},v_{1},u_{2},v_{2},u_{3},v_{3}]^{T}$, where $u_{i}$ and $v_{i}$ are the horizontal and vertical displacement components at node $i$, respectively.\n\nCompute the specific scalar entry of the element stiffness matrix that couples the horizontal displacement at node $1$ to the horizontal displacement at node $2$ (that is, the $(1,3)$ entry under the stated ordering), and express your final result as a closed-form analytic expression in terms of $E$, $\\nu$, and $t$. Your final expression carries units of $\\mathrm{N}/\\mathrm{m}$; do not include units in your final boxed answer. Do not substitute numerical values; provide the symbolic expression only.", "solution": "The problem statement is validated as a correct and self-contained formulation within the field of computational solid mechanics. It is scientifically grounded, well-posed, and provides all necessary data and definitions for a unique solution. We proceed with the derivation and calculation.\n\nThe starting point is the principle of virtual work, which for a static elastic body leads to the weak form of the equilibrium equations. This form states that for any kinematically admissible virtual displacement field $\\boldsymbol{v}$ (which vanishes on the Dirichlet boundary), the following equality must hold:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma}(\\boldsymbol{u}) : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, dV = \\int_{\\Omega} \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, dV + \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS\n$$\nHere, $\\boldsymbol{u}$ is the true displacement field, $\\boldsymbol{\\sigma}(\\boldsymbol{u})$ is the Cauchy stress tensor corresponding to $\\boldsymbol{u}$, and $\\boldsymbol{\\varepsilon}(\\boldsymbol{v})$ is the small-strain tensor of the virtual displacement field. The terms on the right-hand side represent the virtual work done by body forces $\\boldsymbol{b}$ and surface tractions $\\boldsymbol{t}$.\nThe stress and strain tensors are related by the linear constitutive law $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}$, where $\\mathbb{C}$ is the fourth-order elasticity tensor. The strain is given by the symmetric gradient of the displacement, $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\nabla^s \\boldsymbol{u} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^T)$.\nSubstituting the constitutive law into the weak form gives:\n$$\n\\underbrace{\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, dV}_{a(\\boldsymbol{u},\\boldsymbol{v})} = \\underbrace{\\int_{\\Omega} \\boldsymbol{b} \\cdot \\boldsymbol{v} \\, dV + \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS}_{\\ell(\\boldsymbol{v})}\n$$\nThe left side defines a symmetric bilinear form $a(\\boldsymbol{u},\\boldsymbol{v})$ and the right side defines a linear functional $\\ell(\\boldsymbol{v})$.\n\nIn the finite element Galerkin method, the domain $\\Omega$ is discretized into a mesh of elements $\\Omega_e$. Within each element, the displacement field $\\boldsymbol{u}$ is approximated by a function $\\boldsymbol{u}^h$ constructed from a finite set of basis functions, known as shape functions. For `$C^0$`-continuous, piecewise linear elements, the displacement at a point $\\boldsymbol{x}$ within an element is interpolated from the nodal displacements $\\boldsymbol{d}_i^e$:\n$$\n\\boldsymbol{u}^h(\\boldsymbol{x}) = \\sum_{i=1}^{n_{nodes}} N_i(\\boldsymbol{x}) \\boldsymbol{d}_i^e\n$$\nHere, $n_{nodes}$ is the number of nodes in the element, $N_i(\\boldsymbol{x})$ are scalar shape functions, and $\\boldsymbol{d}_i^e = [u_i, v_i]^T$ are the displacement components at node $i$. The same approximation is used for the virtual displacement field, $\\boldsymbol{v}^h = \\sum_{j=1}^{n_{nodes}} N_j(\\boldsymbol{x}) \\boldsymbol{c}_j^e$, where $\\boldsymbol{c}_j^e$ are arbitrary virtual nodal displacements.\n\nTo facilitate computation, we adopt a matrix-vector notation (Voigt notation). The strain tensor components are arranged into a vector $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^T$, where $\\gamma_{xy}=2\\epsilon_{xy}$. The constitutive law becomes $\\boldsymbol{\\sigma}=\\boldsymbol{D}\\boldsymbol{\\epsilon}$, where $\\boldsymbol{D}$ is the $3 \\times 3$ constitutive matrix for 2D problems. The bilinear form becomes $a(\\boldsymbol{u}, \\boldsymbol{v}) = \\int_{\\Omega} \\boldsymbol{\\epsilon}(\\boldsymbol{v})^T \\boldsymbol{D} \\boldsymbol{\\epsilon}(\\boldsymbol{u}) \\, dV$.\n\nThe strain vector is obtained by applying a matrix differential operator to the displacement vector: $\\boldsymbol{\\epsilon} = \\boldsymbol{\\mathcal{L}}\\boldsymbol{u}$, where $\\boldsymbol{\\mathcal{L}} = \\begin{pmatrix} \\partial/\\partial x & 0 \\\\ 0 & \\partial/\\partial y \\\\ \\partial/\\partial y & \\partial/\\partial x \\end{pmatrix}$.\nApplying this to the finite element approximation $\\boldsymbol{u}^h$, we obtain a relationship between the strain vector and the vector of all element nodal degrees of freedom $\\boldsymbol{d}^e = [u_1,v_1,u_2,v_2,\\dots]^T$:\n$$\n\\boldsymbol{\\epsilon}(\\boldsymbol{x}) = \\boldsymbol{B}(\\boldsymbol{x}) \\boldsymbol{d}^e\n$$\nThe matrix $\\boldsymbol{B}$ is the strain-displacement matrix. For a 3-node triangle with the specified DOF ordering $\\boldsymbol{d}^e=[u_1, v_1, u_2, v_2, u_3, v_3]^T$, it is a $3 \\times 6$ matrix defined as:\n$$\n\\boldsymbol{B} = \\begin{pmatrix}\n\\frac{\\partial N_1}{\\partial x} & 0 & \\frac{\\partial N_2}{\\partial x} & 0 & \\frac{\\partial N_3}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_1}{\\partial y} & 0 & \\frac{\\partial N_2}{\\partial y} & 0 & \\frac{\\partial N_3}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_1}{\\partial x} & \\frac{\\partial N_2}{\\partial y} & \\frac{\\partial N_2}{\\partial x} & \\frac{\\partial N_3}{\\partial y} & \\frac{\\partial N_3}{\\partial x}\n\\end{pmatrix}\n$$\nSubstituting the Galerkin approximation into the bilinear form for a single element yields:\n$$\na(\\boldsymbol{u}^h, \\boldsymbol{v}^h)_{\\Omega_e} = \\int_{\\Omega_e} (\\boldsymbol{B}\\boldsymbol{c}^e)^T \\boldsymbol{D} (\\boldsymbol{B}\\boldsymbol{d}^e) \\, dV = (\\boldsymbol{c}^e)^T \\left( \\int_{\\Omega_e} \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B} \\, dV \\right) \\boldsymbol{d}^e\n$$\nFrom this, we identify the element stiffness matrix $\\boldsymbol{K}^e$:\n$$\n\\boldsymbol{K}^e = \\int_{\\Omega_e} \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B} \\, dV\n$$\nThe role of the symmetric gradient operator $\\nabla^s \\boldsymbol{u}$ is fundamental as it defines strain from displacement. Its structure is encoded within the operator $\\boldsymbol{\\mathcal{L}}$ and is directly responsible for the content and structure of the strain-displacement matrix $\\boldsymbol{B}$, which connects nodal displacements to element strains. The role of the constitutive tensor $\\mathbb{C}$ (or its matrix form $\\boldsymbol{D}$) is to provide the material-specific linear relationship between stress and strain. It acts as the kernel in the energy bilinear form and determines the numerical values of the stiffness matrix.\n\nThe global stiffness matrix $\\boldsymbol{K}$ is constructed by assembling the contributions from all element matrices $\\boldsymbol{K}^e$. This assembly process involves summing the entries of element matrices into the appropriate locations in the global matrix, governed by an element-to-global degree-of-freedom mapping.\n\nNow, we specialize to the given triangular element under plane strain conditions. For a linear triangular element (a Constant Strain Triangle or CST), the gradients of the shape functions are constant throughout the element. Consequently, the matrix $\\boldsymbol{B}$ is constant. The integral for $\\boldsymbol{K}^e$ simplifies to:\n$$\n\\boldsymbol{K}^e = (\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}) \\int_{\\Omega_e} dV = A_e t \\, \\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}\n$$\nwhere $A_e$ is the area of the element and $t$ is its constant thickness.\n\nThe nodal coordinates are given as $1: (x_1, y_1)=(0,0)$, $2: (x_2, y_2)=(0.3,0)$, and $3: (x_3, y_3)=(0,0.2)$. The area of this right triangle is $A_e = \\frac{1}{2} \\times 0.3 \\times 0.2 = 0.03$.\nThe derivatives of the linear shape functions are given by standard formulae. For $i_1, i_2, i_3$ in cyclic permutation of $1,2,3$:\n$\\frac{\\partial N_{i_1}}{\\partial x} = \\frac{y_{i_2}-y_{i_3}}{2A_e}$, and $\\frac{\\partial N_{i_1}}{\\partial y} = \\frac{x_{i_3}-x_{i_2}}{2A_e}$.\nCalculation for $2A_e = 0.06$:\n$\\frac{\\partial N_1}{\\partial x} = \\frac{0-0.2}{0.06} = -\\frac{10}{3}$; $\\frac{\\partial N_1}{\\partial y} = \\frac{0-0.3}{0.06} = -5$.\n$\\frac{\\partial N_2}{\\partial x} = \\frac{0.2-0}{0.06} = \\frac{10}{3}$; $\\frac{\\partial N_2}{\\partial y} = \\frac{0-0}{0.06} = 0$.\n$\\frac{\\partial N_3}{\\partial x} = \\frac{0-0}{0.06} = 0$; $\\frac{\\partial N_3}{\\partial y} = \\frac{0.3-0}{0.06} = 5$.\nThe $\\boldsymbol{B}$ matrix is therefore:\n$$\n\\boldsymbol{B} = \\begin{pmatrix}\n-\\frac{10}{3} & 0 & \\frac{10}{3} & 0 & 0 & 0 \\\\\n0 & -5 & 0 & 0 & 0 & 5 \\\\\n-5 & -\\frac{10}{3} & 0 & \\frac{10}{3} & 5 & 0\n\\end{pmatrix}\n$$\nFor isotropic linear elasticity under plane strain, the constitutive matrix $\\boldsymbol{D}$ is:\n$$\n\\boldsymbol{D} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n1-\\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & 0 \\\\\n0 & 0 & \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n$$\nWe need to compute the $(1,3)$ entry of the element stiffness matrix, $K^e_{13}$. This entry couples the horizontal displacement at node $1$ ($u_1$, DOF 1) with the horizontal displacement at node $2$ ($u_2$, DOF 3). It is given by $K^e_{13} = A_e t (\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B})_{13}$. The $(i,j)$ entry of $\\boldsymbol{B}^T \\boldsymbol{D} \\boldsymbol{B}$ is $(\\boldsymbol{B}_{col,i})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,j})$, where $\\boldsymbol{B}_{col,k}$ is the $k$-th column of $\\boldsymbol{B}$.\nSo, $K^e_{13} = A_e t (\\boldsymbol{B}_{col,1})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,3})$.\nThe required columns of $\\boldsymbol{B}$ are:\n$$\n\\boldsymbol{B}_{col,1} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ -5 \\end{pmatrix}, \\quad \\boldsymbol{B}_{col,3} = \\begin{pmatrix} \\frac{10}{3} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nWe compute the product $(\\boldsymbol{B}_{col,1})^T \\boldsymbol{D} (\\boldsymbol{B}_{col,3})$:\n$$\n\\begin{pmatrix} -\\frac{10}{3} & 0 & -5 \\end{pmatrix} \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n1-\\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & 0 \\\\\n0 & 0 & \\frac{1-2\\nu}{2}\n\\end{pmatrix} \\begin{pmatrix} \\frac{10}{3} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nFirst, the product of $\\boldsymbol{D}$ and $\\boldsymbol{B}_{col,3}$:\n$$\n\\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix}\n(1-\\nu)\\frac{10}{3} \\\\\n\\nu\\frac{10}{3} \\\\\n0\n\\end{pmatrix}\n$$\nThen, the dot product with $(\\boldsymbol{B}_{col,1})^T$:\n$$\n\\frac{E}{(1+\\nu)(1-2\\nu)} \\left[ \\left(-\\frac{10}{3}\\right)(1-\\nu)\\frac{10}{3} + (0)(\\nu)\\frac{10}{3} + (-5)(0) \\right] = -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9}\n$$\nFinally, we multiply by $A_e t$:\n$$\nK^e_{13} = (0.03) t \\left( -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9} \\right) = \\left(\\frac{3}{100}\\right) t \\left( -\\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} \\frac{100}{9} \\right)\n$$\n$$\nK^e_{13} = -\\frac{3 \\cdot 100}{100 \\cdot 9} \\frac{t E (1-\\nu)}{(1+\\nu)(1-2\\nu)} = -\\frac{1}{3} \\frac{t E (1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\nThis is the final symbolic expression for the requested stiffness matrix entry.", "answer": "$$\n\\boxed{-\\frac{t E (1-\\nu)}{3 (1+\\nu) (1-2\\nu)}}\n$$", "id": "2697408"}, {"introduction": "After constructing the stiffness matrix, the next logical step is to account for the external forces acting on the system. This practice focuses on deriving the 'consistent' nodal force vector, which represents the work done by body forces and tractions in a manner consistent with the chosen shape functions. You will see how the principle of virtual work and isoparametric mapping are used to transform distributed loads into a set of discrete nodal forces that complete the global system of equations [@problem_id:2697388].", "problem": "Consider a plane stress continuum of constant thickness $h$ modeled by a single four-node bilinear isoparametric quadrilateral finite element. The nodes are located at $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(L_x,0)$, $(x_3,y_3)=(L_x,L_y)$, and $(x_4,y_4)=(0,L_y)$, with the usual local node ordering $1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 4$ around the perimeter. The body force per unit volume is uniform and given by the vector $\\mathbf{b}=[\\,b_x,\\;b_y\\,]^{\\mathsf{T}}$. The right edge at $x=L_x$ (the edge connecting nodes $2$ and $3$) is subjected to a uniform traction vector $\\bar{\\mathbf{t}}=[\\,\\bar{t}_x,\\;\\bar{t}_y\\,]^{\\mathsf{T}}$. Assume small deformations and linear kinematics, and use the standard bilinear isoparametric shape functions defined on the parent square $\\{(\\xi,\\eta):\\,-1\\le \\xi,\\eta \\le 1\\}$.\n\nStarting only from the Principle of Virtual Work and the Galerkin method (in which the virtual displacement field is interpolated by the same shape functions as the displacement field), derive the consistent element nodal force contributions associated with the body force and the boundary traction. Explicitly show how the volume and boundary integrals transform under the isoparametric mapping, including the determinant of the Jacobian for the area measure and the one-dimensional edge Jacobian for the boundary measure. Then, carrying out these transformed integrals for this specific rectangular element and the given uniform data, obtain a closed-form expression for the assembled eight-component element nodal force vector ordered as $[\\,F_{1x},\\,F_{1y},\\,F_{2x},\\,F_{2y},\\,F_{3x},\\,F_{3y},\\,F_{4x},\\,F_{4y}\\,]$.\n\nExpress your final answer symbolically as a function of $L_x$, $L_y$, $h$, $b_x$, $b_y$, $\\bar{t}_x$, and $\\bar{t}_y$. No numerical evaluation is required. Do not include units in the final boxed answer.", "solution": "The problem is a standard application of the Galerkin Finite Element Method to determine the consistent nodal forces arising from external loads in linear elasticity. It is scientifically sound, well-posed, and contains all necessary information for a unique solution. We proceed with the derivation.\n\nThe Principle of Virtual Work states that for a body in equilibrium, the virtual work done by external forces, $\\delta W_{ext}$, is equal to the virtual work done by internal stresses (virtual strain energy), $\\delta W_{int}$. The external virtual work is given by the sum of work done by body forces $\\mathbf{b}$ over the volume $V$ and prescribed surface tractions $\\bar{\\mathbf{t}}$ over the traction boundary $\\Gamma_t$.\n$$ \\delta W_{ext} = \\int_V \\delta\\mathbf{u}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\delta\\mathbf{u}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\nHere, $\\delta\\mathbf{u}$ is an arbitrary, kinematically admissible virtual displacement field.\n\nIn the Galerkin finite element formulation, the displacement field $\\mathbf{u}$ and the virtual displacement field $\\delta\\mathbf{u}$ within an element are interpolated from the nodal displacements $\\mathbf{d}$ and virtual nodal displacements $\\delta\\mathbf{d}$ using the same shape functions.\n$$ \\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\mathbf{d} $$\n$$ \\delta\\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\delta\\mathbf{d} $$\nThe shape function matrix $\\mathbf{N}$ for a four-node two-dimensional element is\n$$ \\mathbf{N} = \\begin{bmatrix} N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 & 0 \\\\ 0 & N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 \\end{bmatrix} $$\nand the element nodal displacement vectors are $\\mathbf{d} = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathsf{T}}$ and $\\delta\\mathbf{d} = [\\delta u_1, \\delta v_1, \\dots, \\delta v_4]^{\\mathsf{T}}$.\n\nSubstituting the interpolated virtual displacement into the expression for $\\delta W_{ext}$ gives:\n$$ \\delta W_{ext} = \\int_V (\\mathbf{N} \\delta\\mathbf{d})^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} (\\mathbf{N} \\delta\\mathbf{d})^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\n$$ \\delta W_{ext} = \\delta\\mathbf{d}^{\\mathsf{T}} \\left( \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma \\right) $$\nBy definition, $\\delta W_{ext} = \\delta\\mathbf{d}^{\\mathsf{T}} \\mathbf{F}_{ext}$, where $\\mathbf{F}_{ext}$ is the consistent element nodal force vector. Since $\\delta\\mathbf{d}$ is arbitrary, we identify $\\mathbf{F}_{ext}$ as:\n$$ \\mathbf{F}_{ext} = \\mathbf{F}_b + \\mathbf{F}_t = \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV + \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma $$\nwhere $\\mathbf{F}_b$ is the body force contribution and $\\mathbf{F}_t$ is the surface traction contribution.\n\nThe problem uses a four-node bilinear isoparametric element. This implies the geometry is mapped from a parent square domain $\\{(\\xi,\\eta) : -1 \\le \\xi,\\eta \\le 1\\}$ using the same shape functions used for the displacement field.\nThe shape functions are:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe coordinate mapping is given by $x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$ and $y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$. The Jacobian matrix of this transformation is\n$$ \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum \\frac{\\partial N_i}{\\partial \\xi} y_i \\\\ \\sum \\frac{\\partial N_i}{\\partial \\eta} x_i & \\sum \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{bmatrix} $$\nUsing the given nodal coordinates $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(L_x,0)$, $(x_3,y_3)=(L_x,L_y)$, $(x_4,y_4)=(0,L_y)$:\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\left[ -(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4 \\right] = \\frac{1}{4} \\left[ 0 + (1-\\eta)L_x + (1+\\eta)L_x - 0 \\right] = \\frac{L_x}{2}$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} \\left[ -(1-\\eta)y_1 + (1-\\eta)y_2 + (1+\\eta)y_3 - (1+\\eta)y_4 \\right] = \\frac{1}{4} \\left[ 0 + 0 + (1+\\eta)L_y - (1+\\eta)L_y \\right] = 0$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} \\left[ -(1-\\xi)x_1 - (1+\\xi)x_2 + (1+\\xi)x_3 + (1-\\xi)x_4 \\right] = \\frac{1}{4} \\left[ 0 - (1+\\xi)L_x + (1+\\xi)L_x + 0 \\right] = 0$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} \\left[ -(1-\\xi)y_1 - (1+\\xi)y_2 + (1+\\xi)y_3 + (1-\\xi)y_4 \\right] = \\frac{1}{4} \\left[ 0 - 0 + (1+\\xi)L_y + (1-\\xi)L_y \\right] = \\frac{L_y}{2}$\nThus, the Jacobian matrix is constant for this rectangular element:\n$$ \\mathbf{J} = \\begin{bmatrix} L_x/2 & 0 \\\\ 0 & L_y/2 \\end{bmatrix} $$\nThe determinant is $\\det(\\mathbf{J}) = \\frac{L_x L_y}{4}$. The differential volume element transforms as $dV = h \\, dA = h \\det(\\mathbf{J}) d\\xi d\\eta = \\frac{h L_x L_y}{4} d\\xi d\\eta$.\n\nFirst, we compute the body force vector $\\mathbf{F}_b$:\n$$ \\mathbf{F}_b = \\int_V \\mathbf{N}^{\\mathsf{T}} \\mathbf{b} \\, dV = \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{N}(\\xi, \\eta)^{\\mathsf{T}} \\mathbf{b} \\, h \\det(\\mathbf{J}) d\\xi d\\eta $$\nSince $\\mathbf{b}$, $h$, and $\\det(\\mathbf{J})$ are constant, this simplifies. The force component for node $i$ is:\n$$ \\mathbf{F}_{ib} = \\begin{bmatrix} F_{ibx} \\\\ F_{iby} \\end{bmatrix} = \\left( \\int_V N_i dV \\right) \\mathbf{b} = h \\det(\\mathbf{J}) \\left( \\int_{-1}^{1} \\int_{-1}^{1} N_i(\\xi, \\eta) d\\xi d\\eta \\right) \\mathbf{b} $$\nFor any of the bilinear shape functions, the integral over the parent element is $1$. For example, for $N_1$:\n$$ \\int_{-1}^{1} \\int_{-1}^{1} N_1 d\\xi d\\eta = \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{4}(1-\\xi)(1-\\eta) d\\xi d\\eta = \\frac{1}{4} \\left( \\int_{-1}^{1} (1-\\xi) d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta) d\\eta \\right) = \\frac{1}{4}(2)(2) = 1 $$\nTherefore, $\\int_V N_i dV = h \\frac{L_x L_y}{4} (1) = \\frac{h L_x L_y}{4}$. This means the total body force on the element, $\\mathbf{b} (h L_x L_y)$, is distributed equally among the four nodes.\n$$ \\mathbf{F}_{ib} = \\frac{h L_x L_y}{4} \\begin{bmatrix} b_x \\\\ b_y \\end{bmatrix} \\quad \\text{for } i=1, 2, 3, 4 $$\n\nNext, we compute the traction force vector $\\mathbf{F}_t$. The traction $\\bar{\\mathbf{t}}$ is applied on the edge $x=L_x$, which connects nodes $2$ and $3$. In the parent domain, this corresponds to the edge $\\xi=1$ for $-1 \\le \\eta \\le 1$.\nThe integral is over the surface area $\\Gamma_t$ where the traction is applied. The differential surface element $d\\Gamma$ is $h\\,ds$, where $ds$ is the differential arc length. The transformation is $ds = \\sqrt{(\\frac{dx}{d\\eta})^2 + (\\frac{dy}{d\\eta})^2} \\, d\\eta$. We term the square root factor the one-dimensional edge Jacobian, $J_{1D}$.\nOn the edge $\\xi=1$, the mapping is $x(\\eta) = L_x$ and $y(\\eta) = \\frac{L_y}{2}(1+\\eta)$.\nDerivatives with respect to $\\eta$ are $\\frac{dx}{d\\eta}=0$ and $\\frac{dy}{d\\eta}=\\frac{L_y}{2}$.\nThe edge Jacobian is $J_{1D} = \\sqrt{0^2 + (L_y/2)^2} = \\frac{L_y}{2}$.\nSo, $d\\Gamma = h J_{1D} d\\eta = \\frac{h L_y}{2} d\\eta$.\nThe traction force vector is:\n$$ \\mathbf{F}_t = \\int_{\\Gamma_t} \\mathbf{N}^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, d\\Gamma = \\int_{-1}^{1} \\mathbf{N}(\\xi=1, \\eta)^{\\mathsf{T}} \\bar{\\mathbf{t}} \\, \\frac{h L_y}{2} d\\eta $$\nOn the edge $\\xi=1$, the shape functions $N_1$ and $N_4$ are identically zero. Only $N_2$ and $N_3$ contribute.\n$N_2(1, \\eta) = \\frac{1}{2}(1-\\eta)$ and $N_3(1, \\eta) = \\frac{1}{2}(1+\\eta)$.\nThe force contribution to node $2$ is:\n$$ \\mathbf{F}_{2t} = \\left( \\int_{-1}^{1} N_2(1, \\eta) \\frac{h L_y}{2} d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\left( \\int_{-1}^{1} \\frac{1}{2}(1-\\eta) d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{4} [\\eta - \\frac{\\eta^2}{2}]_{-1}^{1} \\bar{\\mathbf{t}} = \\frac{h L_y}{4} (2) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\bar{\\mathbf{t}} $$\nThe force contribution to node $3$ is:\n$$ \\mathbf{F}_{3t} = \\left( \\int_{-1}^{1} N_3(1, \\eta) \\frac{h L_y}{2} d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\left( \\int_{-1}^{1} \\frac{1}{2}(1+\\eta) d\\eta \\right) \\bar{\\mathbf{t}} = \\frac{h L_y}{4} [\\eta + \\frac{\\eta^2}{2}]_{-1}^{1} \\bar{\\mathbf{t}} = \\frac{h L_y}{4} (2) \\bar{\\mathbf{t}} = \\frac{h L_y}{2} \\bar{\\mathbf{t}} $$\nNodes $1$ and $4$ receive no force from the traction on this edge. This physically means the total traction force, $\\bar{\\mathbf{t}} (h L_y)$, is distributed equally between the two nodes on the edge.\n\nFinally, we assemble the total nodal force vector $\\mathbf{F} = [F_{1x}, F_{1y}, \\dots, F_{4y}]^{\\mathsf{T}}$ by summing the body force and traction contributions for each component.\n\n$F_{1x} = F_{1bx} + F_{1tx} = \\frac{h L_x L_y}{4} b_x + 0 = \\frac{h L_x L_y}{4} b_x$\n$F_{1y} = F_{1by} + F_{1ty} = \\frac{h L_x L_y}{4} b_y + 0 = \\frac{h L_x L_y}{4} b_y$\n\n$F_{2x} = F_{2bx} + F_{2tx} = \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x$\n$F_{2y} = F_{2by} + F_{2ty} = \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y$\n\n$F_{3x} = F_{3bx} + F_{3tx} = \\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x$\n$F_{3y} = F_{3by} + F_{3ty} = \\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y$\n\n$F_{4x} = F_{4bx} + F_{4tx} = \\frac{h L_x L_y}{4} b_x + 0 = \\frac{h L_x L_y}{4} b_x$\n$F_{4y} = F_{4by} + F_{4ty} = \\frac{h L_x L_y}{4} b_y + 0 = \\frac{h L_x L_y}{4} b_y$\n\nThis constitutes the complete eight-component element nodal force vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{h L_x L_y}{4} b_x \\\\\n\\frac{h L_x L_y}{4} b_y \\\\\n\\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x \\\\\n\\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y \\\\\n\\frac{h L_x L_y}{4} b_x + \\frac{h L_y}{2} \\bar{t}_x \\\\\n\\frac{h L_x L_y}{4} b_y + \\frac{h L_y}{2} \\bar{t}_y \\\\\n\\frac{h L_x L_y}{4} b_x \\\\\n\\frac{h L_x L_y}{4} b_y\n\\end{pmatrix}\n}\n$$", "id": "2697388"}, {"introduction": "The Galerkin method's power is matched by its subtleties, and numerical implementation choices can lead to non-physical instabilities. This advanced exercise explores 'hourglassing,' a zero-energy mode that arises from under-integration of low-order elements, rendering them uselessly flexible for certain deformations. By analyzing the cause of this instability, you will learn to identify and suppress it using a variationally consistent stabilization technique, a crucial skill for developing robust finite element models [@problem_id:2697340].", "problem": "Consider small-strain, static, linear elasticity on a bounded domain $\\Omega \\subset \\mathbb{R}^{2}$ with body force $\\mathbf{b}$, traction $\\bar{\\mathbf{t}}$ on $\\Gamma_{t}$, and displacement $\\bar{\\mathbf{u}}$ on $\\Gamma_{u}$, where $\\Gamma_{u} \\cup \\Gamma_{t} = \\partial \\Omega$ and $\\Gamma_{u} \\cap \\Gamma_{t} = \\emptyset$. The strong form is $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ in $\\Omega$ with $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u})$, $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{T}\\right)$, where $\\mathbb{C}$ is the fourth-order elasticity tensor with Lamé parameters $\\lambda$ and $\\mu$. The corresponding Galerkin weak form seeks $\\mathbf{u} \\in \\mathcal{V}$ such that for all $\\mathbf{v} \\in \\mathcal{V}_{0}$,\n$$\na(\\mathbf{u},\\mathbf{v}) = \\ell(\\mathbf{v}), \\quad a(\\mathbf{u},\\mathbf{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}\\Omega, \\quad \\ell(\\mathbf{v}) = \\int_{\\Omega} \\mathbf{v} \\cdot \\mathbf{b} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_{t}} \\mathbf{v} \\cdot \\bar{\\mathbf{t}} \\, \\mathrm{d}\\Gamma.\n$$\nDiscretize $\\Omega$ with bilinear quadrilateral `$Q1$` elements and approximate $\\mathbf{u}$ and $\\mathbf{v}$ in the usual finite-dimensional subspaces built from the `$Q1$` shape functions. Consider a single, axis-aligned, square element of side length $h$, with nodes numbered counterclockwise starting at the lower-left corner as $1,2,3,4$. Assume a one-point Gauss rule (under-integration) at the element center for the internal virtual work.\n\nUsing only the foregoing fundamental laws and definitions:\n\n- Explain how the one-point Gauss rule changes the element bilinear form to a rank-deficient algebraic form and thereby admits zero-energy modes (hourglass modes) in the $Q1$ element. Determine the dimension of the element-level zero-energy subspace and identify how many of those modes are non-rigid hourglass modes.\n- Exhibit at least one explicit nodal displacement pattern $\\mathbf{u}_{e}$ (in terms of nodal values at nodes $1,2,3,4$) that yields zero strain at the element’s Gauss point under the one-point rule, and briefly justify why it is a zero-energy mode for the under-integrated element.\n- Select from the options below the stabilization that both suppresses these hourglass modes and preserves variational correctness in the sense that it derives from a symmetric, consistent modification of the bilinear form that does not pollute the constant-strain patch test.\n\nOptions:\nA. Add to the discrete bilinear form the element-wise fluctuation penalty\n$$\na_{s}(\\mathbf{u}_{h},\\mathbf{v}_{h}) = \\sum_{e} \\alpha_{e} \\int_{\\Omega_{e}} \\left(\\boldsymbol{\\varepsilon}(\\mathbf{v}_{h}) - \\Pi_{0}\\boldsymbol{\\varepsilon}(\\mathbf{v}_{h})\\right) : \\mathbb{C} : \\left(\\boldsymbol{\\varepsilon}(\\mathbf{u}_{h}) - \\Pi_{0}\\boldsymbol{\\varepsilon}(\\mathbf{u}_{h})\\right) \\, \\mathrm{d}\\Omega,\n$$\nwhere $\\Pi_{0}$ is the $L^{2}$-orthogonal projection onto elementwise constant strains (e.g., the value at the one Gauss point), and $\\alpha_{e} > 0$ is a mesh- and material-scaled parameter.\n\nB. Replace the one-point rule by a full $2 \\times 2$ Gauss rule for $a(\\cdot,\\cdot)$ on each $Q1$ element.\n\nC. Add an ad hoc hourglass penalty in terms of nodal differences along the diagonals,\n$$\nE_{\\mathrm{hg}} = \\sum_{e} \\beta \\left[\\left\\|\\mathbf{u}_{1} - \\mathbf{u}_{3}\\right\\|^{2} + \\left\\|\\mathbf{u}_{2} - \\mathbf{u}_{4}\\right\\|^{2}\\right],\n$$\nwith a user-chosen $\\beta > 0$, and take the consistent linearization to obtain additional stiffness.\n\nD. Add a residual-based equilibrium stabilization\n$$\na_{s}^{\\mathrm{res}}(\\mathbf{u}_{h},\\mathbf{v}_{h}) = \\sum_{e} \\tau_{e} \\int_{\\Omega_{e}} \\left(\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{v}_{h})\\right) \\cdot \\left(\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_{h})\\right) \\, \\mathrm{d}\\Omega,\n$$\nwith $\\tau_{e} > 0$.\n\nChoose the single best option that satisfies the stated stabilization requirements.", "solution": "The validity of the problem statement must first be established.\n\n### Step 1: Extract Givens\n- **Problem Type**: Small-strain, static, linear elasticity.\n- **Domain**: Bounded domain $\\Omega \\subset \\mathbb{R}^{2}$ with boundary $\\partial \\Omega = \\Gamma_u \\cup \\Gamma_t$ and $\\Gamma_u \\cap \\Gamma_t = \\emptyset$.\n- **Governing Equation (Strong Form)**: $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ in $\\Omega$.\n- **Constitutive Law**: $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u})$, where $\\mathbb{C}$ is the fourth-order elasticity tensor (Lamé parameters $\\lambda, \\mu$).\n- **Strain-Displacement Relation**: $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{T}\\right)$.\n- **Boundary Conditions**: Prescribed displacement $\\mathbf{u} = \\bar{\\mathbf{u}}$ on $\\Gamma_u$; prescribed traction $\\boldsymbol{\\sigma} \\cdot \\mathbf{n} = \\bar{\\mathbf{t}}$ on $\\Gamma_t$.\n- **Galerkin Weak Form**: Find $\\mathbf{u} \\in \\mathcal{V}$ such that $a(\\mathbf{u},\\mathbf{v}) = \\ell(\\mathbf{v})$ for all $\\mathbf{v} \\in \\mathcal{V}_{0}$.\n- **Bilinear Form**: $a(\\mathbf{u},\\mathbf{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}\\Omega$.\n- **Linear Functional**: $\\ell(\\mathbf{v}) = \\int_{\\Omega} \\mathbf{v} \\cdot \\mathbf{b} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_{t}} \\mathbf{v} \\cdot \\bar{\\mathbf{t}} \\, \\mathrm{d}\\Gamma$.\n- **Discretization**: Bilinear quadrilateral ($Q1$) elements.\n- **Numerical Integration**: One-point Gauss quadrature at the element center for the internal virtual work (i.e., the bilinear form $a(\\cdot,\\cdot)$).\n- **Element Geometry**: A single, axis-aligned, square element of side length $h$, with nodes $1,2,3,4$ numbered counterclockwise from the lower-left corner.\n- **Required Tasks**:\n    1.  Explain the rank deficiency and emergence of zero-energy modes from one-point integration.\n    2.  Determine the dimension of the zero-energy subspace and the number of non-rigid hourglass modes.\n    3.  Exhibit an explicit nodal displacement pattern for a non-rigid zero-energy mode.\n    4.  Select a stabilization method from the given options that suppresses hourglass modes, is symmetric, consistent, and passes the constant-strain patch test.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a standard, canonical problem in the theory of the Finite Element Method (FEM) as applied to solid mechanics. All concepts—linear elasticity, Galerkin method, Q1 elements, numerical quadrature, and hourglass instability—are fundamental and well-established in computational mechanics.\n- **Well-Posed**: The problem is clearly stated and asks for an analysis of a known numerical artifact and an evaluation of standard remedies. The tasks are specific and lead to a definite, derivable conclusion.\n- **Objective**: The problem is formulated in precise mathematical and engineering language, free from subjectivity or ambiguity.\n\nThe problem statement contains no scientific or factual unsoundness, is formalizable and relevant, is complete and consistent, is realistic in the context of numerical analysis, is well-posed, and is a non-trivial test of fundamental FEM concepts.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n---\n\n### Derivation and Analysis\n\nWe first address the analytical tasks required by the problem statement before evaluating the options.\n\n**1. Rank Deficiency and Zero-Energy Modes**\n\nA 2D bilinear quadrilateral ($Q1$) element has $4$ nodes, each with $2$ degrees of freedom (DOF), for a total of $8$ DOFs. The element stiffness matrix $\\mathbf{k}_e$ is an $8 \\times 8$ matrix. Its entries are computed from the bilinear form, which, after discretization, becomes $\\mathbf{d}_v^T \\mathbf{k}_e \\mathbf{d}_u$ where $\\mathbf{d}$ are vectors of nodal displacements. The stiffness matrix is given by $\\mathbf{k}_e = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, \\mathrm{d}\\Omega$, where $\\mathbf{B}$ is the $3 \\times 8$ strain-displacement matrix in 2D plane strain/stress, and $\\mathbf{D}$ is the $3 \\times 3$ material matrix.\n\nUsing a one-point Gauss rule approximates this integral as:\n$$ \\mathbf{k}_{e}^{1pt} = \\left(\\mathbf{B}(\\boldsymbol{\\xi}_c)\\right)^T \\mathbf{D} \\mathbf{B}(\\boldsymbol{\\xi}_c) \\cdot \\text{Area}(\\Omega_e) $$\nwhere $\\boldsymbol{\\xi}_c$ is the center of the element in the reference coordinate system, and $\\mathbf{D}$ is assumed constant over the element. The rank of $\\mathbf{k}_{e}^{1pt}$ is determined by the rank of the matrix $\\mathbf{B}(\\boldsymbol{\\xi}_c)$, since $\\mathbf{D}$ is full rank ($3$).\n\nThe matrix $\\mathbf{B}$ relates the strain vector $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^T$ to the nodal displacement vector $\\mathbf{d}_e$. The entries of $\\mathbf{B}$ depend on the spatial derivatives of the shape functions. For a $Q1$ element, the displacement field components are bilinear, e.g., $u_x(x,y) = c_1 + c_2 x + c_3 y + c_4 xy$. The strain components are therefore linear, e.g., $\\varepsilon_{xx} = \\partial u_x / \\partial x = c_2 + c_4 y$.\n\nWhen $\\mathbf{B}$ is evaluated at a single point $\\boldsymbol{\\xi}_c = (0,0)$ for an axis-aligned element, it becomes a constant matrix. The rank of $\\mathbf{B}(\\boldsymbol{\\xi}_c)$ is found to be $3$. Consequently, the rank of the $8 \\times 8$ matrix $\\mathbf{k}_{e}^{1pt}$ is also $3$.\n\nA full-rank $8 \\times 8$ matrix has a rank of $8$. The rank deficiency is $\\text{dim}(\\text{ker}(\\mathbf{k}_{e}^{1pt})) = 8 - \\text{rank}(\\mathbf{k}_{e}^{1pt}) = 8 - 3 = 5$. This means there is a $5$-dimensional subspace of nodal displacement vectors $\\mathbf{d}_e$ for which the strain energy, as computed by the one-point rule, is zero: $\\frac{1}{2} \\mathbf{d}_e^T \\mathbf{k}_{e}^{1pt} \\mathbf{d}_e = 0$. These are the **zero-energy modes**.\n\nIn 2D, any element must admit $3$ rigid-body modes (two translations, one rotation) which produce no strain and thus no strain energy. These are physical and must be present. The remaining $5 - 3 = 2$ zero-energy modes are spurious, non-physical deformation modes called **hourglass modes**. They correspond to deformations that produce zero strain at the element center but non-zero strain elsewhere.\n\n**2. Explicit Hourglass Mode**\n\nWe seek a nodal displacement vector $\\mathbf{d}_e = (u_{x1}, u_{y1}, u_{x2}, u_{y2}, u_{x3}, u_{y3}, u_{x4}, u_{y4})^T$ which is a non-rigid mode and for which $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)|_{\\boldsymbol{\\xi}_c} = \\mathbf{0}$. The nodes are at coordinates (for $h=2$, in reference space): $1(-1,-1)$, $2(1,-1)$, $3(1,1)$, $4(-1,1)$. A characteristic hourglass displacement pattern is proportional to the product of local coordinates, $\\xi\\eta$. Let us define a displacement field $\\mathbf{u}_h$ from the nodal displacement pattern:\n$$ \\mathbf{u}_1 = (c, 0), \\quad \\mathbf{u}_2 = (-c, 0), \\quad \\mathbf{u}_3 = (c, 0), \\quad \\mathbf{u}_4 = (-c, 0) $$\nfor some constant $c \\ne 0$. This corresponds to the nodal vector $\\mathbf{d}_e = (c, 0, -c, 0, c, 0, -c, 0)^T$. The interpolated displacement field is $u_x(x,y) \\propto xy$ and $u_y(x,y) = 0$. The strain components are:\n$$ \\varepsilon_{xx}(\\mathbf{u}_h) = \\frac{\\partial u_x}{\\partial x} \\propto y, \\quad \\varepsilon_{yy}(\\mathbf{u}_h) = \\frac{\\partial u_y}{\\partial y} = 0, \\quad \\gamma_{xy}(\\mathbf{u}_h) = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\propto x $$\nAt the element center $(x,y)=(0,0)$, all strain components are zero. Thus, $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)|_{\\boldsymbol{\\xi}_c} = \\mathbf{0}$, and the mode has zero energy under the one-point rule. This mode is a non-rigid deformation (a \"bow-tie\" shape), as the distances between nodes change. This is a classic hourglass mode.\n\n**3. Evaluation of Stabilization Options**\n\nThe stabilization must suppress these modes, be derived from a symmetric and consistent modification, and pass the constant-strain patch test.\n\n**Option A:** This method adds a penalty term based on the fluctuation of the strain from its element-wise constant part, $\\boldsymbol{\\varepsilon}_h - \\Pi_0\\boldsymbol{\\varepsilon}_h$. The constant part $\\Pi_0\\boldsymbol{\\varepsilon}_h$ is the strain's $L^2$-orthogonal projection onto the space of constant tensors over the element, which for a Q1 element on a rectangular domain corresponds to the strain evaluated at the center, $\\boldsymbol{\\varepsilon}_h(\\boldsymbol{\\xi}_c)$.\n- **Suppression of Hourglass Modes**: For an hourglass mode $\\mathbf{u}_{hg}$, we have $\\boldsymbol{\\varepsilon}_h(\\boldsymbol{\\xi}_c) = \\mathbf{0}$ by definition. The fluctuation $\\boldsymbol{\\varepsilon}_h - \\Pi_0\\boldsymbol{\\varepsilon}_h$ becomes simply $\\boldsymbol{\\varepsilon}_h$. Since the hourglass mode is a true deformation, its strain field $\\boldsymbol{\\varepsilon}_h$ is not identically zero over the element. The stabilization term $\\int_{\\Omega_e} \\boldsymbol{\\varepsilon}_h : \\mathbb{C} : \\boldsymbol{\\varepsilon}_h \\mathrm{d}\\Omega$ is therefore positive, adding the necessary stiffness to penalize the mode. **This works.**\n- **Variational Correctness**: The added bilinear form is symmetric by construction.\n- **Patch Test**: For a constant strain state, the displacement field $\\mathbf{u}_h$ is linear. The resulting strain field $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)$ is constant over the element. For a constant field, its projection $\\Pi_0\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)$ is the field itself. Therefore, the fluctuation term $\\boldsymbol{\\varepsilon}(\\mathbf{u}_h) - \\Pi_0\\boldsymbol{\\varepsilon}(\\mathbf{u}_h)$ is identically zero, and the stabilization term vanishes. **The method passes the constant-strain patch test.**\nThis option represents a well-established, theoretically sound approach from Variational Multiscale (VMS) methods. It is designed to be consistent and to specifically target the instabilities arising from under-integration.\n\n**Option B:** This option replaces the one-point rule with a full $2 \\times 2$ Gauss quadrature.\n- **Suppression of Hourglass Modes**: A $2 \\times 2$ quadrature is sufficient to integrate the stiffness matrix of a rectangular Q1 element exactly. The resulting stiffness matrix $\\mathbf{k}_e$ has the correct rank of $8 - 3 = 5$, possessing only the $3$ physical rigid-body modes as its null space. The hourglass modes are no longer zero-energy modes. **This works.**\n- **Variational Correctness**: Full integration is the \"exact\" evaluation of the defined weak form for this element, so it is variationally correct.\n- **Patch Test**: Fully integrated Q1 elements are known to pass the patch test. **This works.**\nWhile this method is effective, it is often viewed as a change in the primary integration scheme rather than a \"stabilization\" of an under-integrated one. Under-integration is often chosen for computational efficiency or to avoid locking phenomena; stabilization methods like A aim to retain these benefits while curing the instability. For the specific case of Q1, the stabilization in A with $\\alpha_e=1$ is mathematically equivalent to this full integration scheme. However, A represents a more general principle of stabilization.\n\n**Option C:** This proposes an *ad hoc* penalty on the lengths of the element diagonals.\n- **Suppression of Hourglass Modes**: Let's test the hourglass mode found earlier: $\\mathbf{u}_1=(c,0), \\mathbf{u}_3=(c,0) \\implies \\mathbf{u}_1-\\mathbf{u}_3 = \\mathbf{0}$. Also $\\mathbf{u}_2=(-c,0), \\mathbf{u}_4=(-c,0) \\implies \\mathbf{u}_2-\\mathbf{u}_4 = \\mathbf{0}$. The proposed penalty energy $E_{\\mathrm{hg}}$ is zero for this hourglass mode. It fails to suppress it. **This does not work.**\n- **Variational Correctness**: The term \"ad hoc\" and the use of a user-chosen parameter $\\beta$ without clear scaling rules suggest this method may lack formal consistency and may not reliably pass the patch test for general quadrilateral shapes.\n\n**Option D:** This proposes a residual-based stabilization term, $a_{s}^{\\mathrm{res}} = \\sum \\tau_e \\int_{\\Omega_e} (\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{v}_h)) \\cdot (\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)) \\mathrm{d}\\Omega$.\n- **Suppression of Hourglass Modes**: For an hourglass mode, the term $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)$ is generally non-zero within the element, so this penalty would add stiffness. **This works in principle.**\n- **Variational Correctness & Patch Test**: For any constant-strain state, the displacement is linear, the strain is constant, the stress $\\boldsymbol{\\sigma}$ is constant, and thus $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$. The stabilization term is zero, so the **patch test is passed**. The term is also symmetric.\n- **Flaw**: A critical flaw exists. The term $\\nabla \\cdot \\boldsymbol{\\sigma}$ involves second derivatives of the displacement field $\\mathbf{u}_h$. For standard `$C^0$`-continuous finite elements like Q1, second derivatives are not defined across element boundaries. While the integral is evaluable within each element, the formulation lacks the required continuity for a standard conforming Galerkin framework. Properly formulated residual-based methods (like GLS/SUPG) are more complex and typically involve test functions as well, or are defined on element interiors and boundaries separately. As stated, this formulation is theoretically problematic for `$C^0$` elements.\n\n**Conclusion**\n\nOption B is a valid solution but is a brute-force approach. Option C is flawed. Option D is conceptually related to valid methods but is formulated in a way that is problematic for Q1 elements. Option A describes a sophisticated, general, and theoretically sound stabilization method that correctly identifies the source of instability (high-frequency part of the strain field not \"seen\" by the quadrature) and penalizes it. It satisfies all the criteria of correctness, consistency (in the essential patch-test sense), and symmetry. It represents the \"best\" and most principled stabilization strategy among the choices.", "answer": "$$\\boxed{A}$$", "id": "2697340"}]}