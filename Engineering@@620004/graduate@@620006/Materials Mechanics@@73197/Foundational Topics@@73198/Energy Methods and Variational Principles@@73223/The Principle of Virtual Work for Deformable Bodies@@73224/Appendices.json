{"hands_on_practices": [{"introduction": "The Principle of Virtual Work (PVW) provides a statement of equilibrium in an integral, or \"weak\", form. A foundational skill is to understand its equivalence to the more familiar differential equations of equilibrium, or the \"strong\" form. This exercise [@problem_id:2676315] guides you through this process for an elastic bar, demonstrating how the governing differential equation and natural boundary conditions emerge directly from the weak form via integration by parts.", "problem": "A straight, slender, linearly elastic bar occupies the interval $x \\in [0, L]$ along its axis. The Young’s modulus is constant and equal to $E$. The cross-sectional area varies linearly as $A(x) = A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)$ with $\\alpha > -1$ so that $A(x) > 0$ on the entire bar. The bar is subjected to an axially distributed load $q(x) = q_{0}\\left(1 + \\frac{x}{L}\\right)$ acting in the positive $x$-direction, and a terminal axial force $P$ applied at the free end $x=L$ in the positive $x$-direction. The left end at $x=0$ is fixed, so the axial displacement satisfies $u(0) = 0$.\n\nUsing the Principle of Virtual Work (PVW) for deformable bodies, do the following:\n- Specify a class of admissible virtual displacement fields for this boundary value problem and invoke the PVW to obtain the weak statement.\n- From the weak statement, deduce the governing equilibrium relation and the natural boundary condition at $x=L$.\n- Solve for the exact axial displacement field $u(x)$ by direct integration, starting from the relation you obtained from PVW.\n\nExpress the final displacement field as a single closed-form analytic expression in terms of $x$, $E$, $A_{0}$, $\\alpha$, $L$, $q_{0}$, and $P$. Express the displacement in meters. Provide the exact expression; do not round.", "solution": "We begin from the Principle of Virtual Work (PVW) for deformable bodies: the internal virtual work equals the external virtual work for all admissible virtual displacements. For a one-dimensional bar in axial deformation, the axial strain is $\\varepsilon(x) = u'(x)$ and the axial stress is $\\sigma(x) = E\\,\\varepsilon(x) = E\\,u'(x)$. The internal virtual work is\n$$\n\\delta W_{\\text{int}} = \\int_{0}^{L} \\sigma(x)\\,\\delta \\varepsilon(x)\\,A(x)\\,dx = \\int_{0}^{L} E\\,u'(x)\\,\\delta u'(x)\\,A(x)\\,dx.\n$$\nThe external virtual work arises from the distributed axial load $q(x)$ and the terminal force $P$ at $x=L$:\n$$\n\\delta W_{\\text{ext}} = \\int_{0}^{L} q(x)\\,\\delta u(x)\\,dx + P\\,\\delta u(L).\n$$\n\nAdmissible virtual displacement fields are those that are kinematically admissible, that is, they satisfy the essential boundary condition associated with the fixed end. Since the displacement is prescribed as $u(0)=0$, the admissible virtual field must satisfy $\\delta u(0)=0$. We require $\\delta u$ to be sufficiently smooth for the integrals to be well-defined, for example $\\delta u \\in C^{1}[0,L]$ with $\\delta u(0)=0$ and $\\delta u$ otherwise arbitrary.\n\nInvoking PVW,\n$$\n\\int_{0}^{L} E\\,A(x)\\,u'(x)\\,\\delta u'(x)\\,dx \\;=\\; \\int_{0}^{L} q(x)\\,\\delta u(x)\\,dx \\;+\\; P\\,\\delta u(L),\n$$\nfor all admissible $\\delta u$.\n\nWe integrate the left-hand side by parts:\n$$\n\\int_{0}^{L} E\\,A(x)\\,u'(x)\\,\\delta u'(x)\\,dx\n= \\left[E\\,A(x)\\,u'(x)\\,\\delta u(x)\\right]_{0}^{L} - \\int_{0}^{L} \\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right)\\,\\delta u(x)\\,dx.\n$$\nUsing $\\delta u(0) = 0$, this becomes\n$$\n\\left[E\\,A(L)\\,u'(L)\\,\\delta u(L)\\right] - \\int_{0}^{L} \\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right)\\,\\delta u(x)\\,dx.\n$$\nHence the PVW reads\n$$\n- \\int_{0}^{L} \\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right)\\,\\delta u(x)\\,dx + E\\,A(L)\\,u'(L)\\,\\delta u(L)\n= \\int_{0}^{L} q(x)\\,\\delta u(x)\\,dx + P\\,\\delta u(L).\n$$\nBecause $\\delta u(x)$ is arbitrary in the interior and $\\delta u(L)$ is arbitrary at $x=L$, we obtain the strong form and natural boundary condition:\n- Governing equilibrium equation:\n$$\n\\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right) + q(x) = 0 \\quad \\text{in } (0,L).\n$$\n- Natural boundary condition at $x=L$:\n$$\nE\\,A(L)\\,u'(L) = P.\n$$\nThe essential boundary condition is $u(0)=0$.\n\nLet the axial force be $N(x) = E\\,A(x)\\,u'(x)$. The equilibrium equation gives\n$$\nN'(x) + q(x) = 0 \\;\\;\\Rightarrow\\;\\; N(x) = C_{1} - \\int_{0}^{x} q(s)\\,ds,\n$$\nfor some constant $C_{1}$. The natural boundary condition at $x=L$ gives\n$$\nN(L) = E\\,A(L)\\,u'(L) = P \\;\\;\\Rightarrow\\;\\; C_{1} - \\int_{0}^{L} q(s)\\,ds = P \\;\\;\\Rightarrow\\;\\; C_{1} = P + \\int_{0}^{L} q(s)\\,ds.\n$$\nWith $q(x) = q_{0}\\left(1 + \\frac{x}{L}\\right)$, we compute\n$$\n\\int_{0}^{x} q(s)\\,ds = q_{0}\\left(x + \\frac{x^{2}}{2L}\\right), \\qquad \\int_{0}^{L} q(s)\\,ds = q_{0}\\left(L + \\frac{L}{2}\\right) = \\frac{3}{2}\\,q_{0}\\,L.\n$$\nThus\n$$\nC_{1} = P + \\frac{3}{2}\\,q_{0}\\,L,\n$$\nand\n$$\nu'(x) = \\frac{N(x)}{E\\,A(x)} = \\frac{C_{1} - q_{0}\\left(x + \\frac{x^{2}}{2L}\\right)}{E\\,A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)}.\n$$\nImposing $u(0)=0$, we integrate $u'$ from $0$ to $x$ to obtain $u(x)$:\n$$\nu(x) = \\int_{0}^{x} u'(\\xi)\\,d\\xi\n= \\frac{1}{E\\,A_{0}} \\int_{0}^{x} \\frac{C_{1} - q_{0}\\left(\\xi + \\frac{\\xi^{2}}{2L}\\right)}{1 + \\alpha \\frac{\\xi}{L}}\\,d\\xi.\n$$\nIntroduce $a = \\alpha/L$ for compactness. Then\n$$\nu(x) = \\frac{1}{E\\,A_{0}} \\left[\nC_{1} \\int_{0}^{x} \\frac{d\\xi}{1 + a \\xi}\n- q_{0} \\int_{0}^{x} \\frac{\\xi}{1 + a \\xi}\\,d\\xi\n- \\frac{q_{0}}{2L} \\int_{0}^{x} \\frac{\\xi^{2}}{1 + a \\xi}\\,d\\xi\n\\right].\n$$\nThe required integrals are\n$$\n\\int \\frac{d\\xi}{1 + a \\xi} = \\frac{1}{a}\\ln(1 + a \\xi),\n$$\n$$\n\\int \\frac{\\xi}{1 + a \\xi}\\,d\\xi = \\frac{1}{a}\\left(\\xi - \\frac{1}{a}\\ln(1 + a \\xi)\\right),\n$$\n$$\n\\int \\frac{\\xi^{2}}{1 + a \\xi}\\,d\\xi = \\frac{1}{2a}\\,\\xi^{2} - \\frac{1}{a^{2}}\\,\\xi + \\frac{1}{a^{3}} \\ln(1 + a \\xi),\n$$\nwhose lower-limit values at $\\xi=0$ vanish because $\\ln(1)=0$ and the polynomials are zero. Therefore,\n$$\nu(x) = \\frac{1}{E\\,A_{0}} \\left[\n\\frac{C_{1}}{a}\\ln(1 + a x)\n- \\frac{q_{0}}{a}\\left(x - \\frac{1}{a}\\ln(1 + a x)\\right)\n- \\frac{q_{0}}{2L}\\left(\\frac{1}{2a}x^{2} - \\frac{1}{a^{2}}x + \\frac{1}{a^{3}}\\ln(1 + a x)\\right)\n\\right].\n$$\nRe-expressing in terms of $\\alpha$ and $L$ using $a=\\alpha/L$ so that $\\frac{1}{a}=\\frac{L}{\\alpha}$, $\\frac{1}{a^{2}}=\\frac{L^{2}}{\\alpha^{2}}$, and $\\frac{1}{a^{3}}=\\frac{L^{3}}{\\alpha^{3}}$, and substituting $C_{1} = P + \\frac{3}{2} q_{0} L$, we obtain the closed-form displacement field\n$$\nu(x) = \\frac{1}{E\\,A_{0}} \\Bigg\\{\n\\left[\n\\frac{L}{\\alpha}\\,P\n+ \\frac{3}{2}\\,\\frac{q_{0}\\,L^{2}}{\\alpha}\n+ \\frac{q_{0}\\,L^{2}}{\\alpha^{2}}\n- \\frac{q_{0}\\,L^{2}}{2\\,\\alpha^{3}}\n\\right] \\ln\\!\\left(1 + \\frac{\\alpha x}{L}\\right)\n+ \\left[\n- \\frac{q_{0}\\,L}{\\alpha} + \\frac{q_{0}\\,L}{2\\,\\alpha^{2}}\n\\right] x\n- \\frac{q_{0}}{4\\,\\alpha}\\,x^{2}\n\\Bigg\\}.\n$$\nThis expression is in meters when $E$ is in Pascals, $A_{0}$ in square meters, $q_{0}$ and $P$ in Newtons and Newtons per meter as specified, and $x$ and $L$ in meters. It is exact and requires no rounding.", "answer": "$$\\boxed{\\frac{1}{E\\,A_{0}}\\left\\{\\left[\\frac{L}{\\alpha}\\,P+\\frac{3}{2}\\,\\frac{q_{0}L^{2}}{\\alpha}+\\frac{q_{0}L^{2}}{\\alpha^{2}}-\\frac{q_{0}L^{2}}{2\\alpha^{3}}\\right]\\ln\\!\\left(1+\\frac{\\alpha x}{L}\\right)+\\left[-\\frac{q_{0}L}{\\alpha}+\\frac{q_{0}L}{2\\alpha^{2}}\\right]x-\\frac{q_{0}}{4\\alpha}x^{2}\\right\\}}$$", "id": "2676315"}, {"introduction": "While the PVW can yield exact solutions for simple problems, its true power lies in its application to finding approximate solutions for complex systems. This practice [@problem_id:2676301] introduces the Galerkin method for an Euler–Bernoulli beam, where the weak form is used to find the best possible solution within a chosen family of functions. This technique forms the mathematical basis of the Finite Element Method and is an essential tool for engineering analysis.", "problem": "An Euler–Bernoulli beam of length $L$ with constant flexural rigidity $EI$ is simply supported at $x=0$ and $x=L$. The beam is subjected to a spatially uniform transverse load of intensity $q_0$ over the entire span. Let the transverse deflection be $w(x)$. Starting from first principles of the Principle of Virtual Work for Deformable Bodies, derive the weak form appropriate for this beam problem, identifying the essential and natural boundary conditions. Then, approximate the deflection $w(x)$ using an admissible two-parameter cubic polynomial subspace that satisfies all essential boundary conditions:\n$$\nw(x) = \\alpha\\,x(L-x) + \\beta\\,x^2(L-x),\n$$\nand use the same space for virtual displacements. Determine the coefficients $\\alpha$ and $\\beta$ by enforcing the weak form for all virtual fields in the chosen subspace. From your approximate field $w(x)$, compute the midspan deflection $w(L/2)$ as a symbolic expression in terms of $q_0$, $L$, and $EI$.\n\nProvide the final answer as a single exact symbolic expression for $w(L/2)$ in terms of $q_0$, $L$, and $EI$. Do not substitute numerical values. Do not include units in your final boxed answer. If you were to assign units to $w(L/2)$, they would be meters if $q_0$ is in newtons per meter and $EI$ is in newton-meters squared.", "solution": "The Principle of Virtual Work for a deformable body states that the virtual work done by external forces, $\\delta W_{ext}$, is equal to the change in internal strain energy, $\\delta U$.\n$$ \\delta W_{ext} = \\delta U $$\nFor the given beam, the external virtual work is done by the distributed load $q_0$.\n$$ \\delta W_{ext} = \\int_{0}^{L} q_0 \\delta w(x) \\, dx $$\nwhere $\\delta w(x)$ is an arbitrary, kinematically admissible virtual displacement.\n\nThe strain energy $U$ for an Euler-Bernoulli beam is given by:\n$$ U = \\frac{1}{2} \\int_{0}^{L} M(x) \\kappa(x) \\, dx = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^2 \\, dx $$\nHere, $M(x)$ is the bending moment and $\\kappa(x) \\approx w''(x)$ is the curvature. The first variation of the strain energy, $\\delta U$, is:\n$$ \\delta U = \\delta \\left( \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^2 \\, dx \\right) = \\int_{0}^{L} EI w''(x) \\delta(w''(x)) \\, dx = \\int_{0}^{L} EI w''(x) (\\delta w(x))'' \\, dx $$\nEquating $\\delta U$ and $\\delta W_{ext}$ gives the weak form of the equilibrium equation:\n$$ \\int_{0}^{L} EI w''(x) (\\delta w)''(x) \\, dx = \\int_{0}^{L} q_0 \\delta w(x) \\, dx $$\nThis equation must hold for all admissible virtual displacements $\\delta w(x)$.\n\nThe boundary conditions must be identified as essential (kinematic) or natural (static). For a simple support at $x=0$ and $x=L$:\n1.  The deflection is zero: $w(0)=0$ and $w(L)=0$. These are constraints on the displacement field and are therefore **essential** boundary conditions. An admissible virtual displacement must also satisfy these conditions, i.e., $\\delta w(0)=0$ and $\\delta w(L)=0$.\n2.  The bending moment is zero: $M(0) = EI w''(0) = 0$ and $M(L) = EI w''(L) = 0$. These are constraints on forces (moments) and are **natural** boundary conditions. They are satisfied implicitly by the weak form, not imposed on the trial functions beforehand.\n\nThe problem specifies an approximate solution subspace:\n$$ w(x) = \\alpha \\phi_1(x) + \\beta \\phi_2(x) $$\nwith basis functions $\\phi_1(x) = x(L-x)$ and $\\phi_2(x) = x^2(L-x)$. The virtual displacement lies in the same space:\n$$ \\delta w(x) = \\delta \\alpha \\phi_1(x) + \\delta \\beta \\phi_2(x) $$\nSince $\\delta \\alpha$ and $\\delta \\beta$ are arbitrary, the Galerkin method requires the weak form to hold for $\\delta w = \\phi_1(x)$ and $\\delta w = \\phi_2(x)$ independently. This yields a system of two linear equations for the two unknowns, $\\alpha$ and $\\beta$.\n\nWe compute the necessary second derivatives of the basis functions:\n$\\phi_1(x) = Lx - x^2 \\implies \\phi_1'(x) = L-2x \\implies \\phi_1''(x) = -2$\n$\\phi_2(x) = Lx^2 - x^3 \\implies \\phi_2'(x) = 2Lx - 3x^2 \\implies \\phi_2''(x) = 2L-6x$\nThe second derivative of $w(x)$ is:\n$w''(x) = \\alpha \\phi_1''(x) + \\beta \\phi_2''(x) = -2\\alpha + \\beta(2L-6x)$\n\nThe system of equations is $$ [K] \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\{F\\}, $$ where:\n$K_{ij} = \\int_{0}^{L} EI \\phi_i''(x) \\phi_j''(x) \\, dx$\n$F_i = \\int_{0}^{L} q_0 \\phi_i(x) \\, dx$\n\nLet us compute the components of the matrix $[K]$ and vector $\\{F\\}$.\n$K_{11} = \\int_{0}^{L} EI (\\phi_1''(x))^2 \\, dx = EI \\int_{0}^{L} (-2)^2 \\, dx = 4EI \\int_{0}^{L} dx = 4EIL$\n\n$K_{12} = K_{21} = \\int_{0}^{L} EI \\phi_1''(x) \\phi_2''(x) \\, dx = EI \\int_{0}^{L} (-2)(2L-6x) \\, dx = -2EI [2Lx-3x^2]_0^L = -2EI(2L^2-3L^2) = 2EIL^2$\n\n$K_{22} = \\int_{0}^{L} EI (\\phi_2''(x))^2 \\, dx = EI \\int_{0}^{L} (2L-6x)^2 \\, dx = EI \\int_{0}^{L} (4L^2 - 24Lx + 36x^2) \\, dx = EI [4L^2x - 12Lx^2 + 12x^3]_0^L = EI(4L^3 - 12L^3 + 12L^3) = 4EIL^3$\n\n$F_1 = \\int_{0}^{L} q_0 \\phi_1(x) \\, dx = q_0 \\int_{0}^{L} (Lx - x^2) \\, dx = q_0 \\left[ \\frac{Lx^2}{2} - \\frac{x^3}{3} \\right]_0^L = q_0 \\left( \\frac{L^3}{2} - \\frac{L^3}{3} \\right) = \\frac{q_0 L^3}{6}$\n\n$F_2 = \\int_{0}^{L} q_0 \\phi_2(x) \\, dx = q_0 \\int_{0}^{L} (Lx^2 - x^3) \\, dx = q_0 \\left[ \\frac{Lx^3}{3} - \\frac{x^4}{4} \\right]_0^L = q_0 \\left( \\frac{L^4}{3} - \\frac{L^4}{4} \\right) = \\frac{q_0 L^4}{12}$\n\nThe linear system is:\n$$ \\begin{pmatrix} 4EIL & 2EIL^2 \\\\ 2EIL^2 & 4EIL^3 \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} \\frac{q_0L^3}{6} \\\\ \\frac{q_0L^4}{12} \\end{pmatrix} $$\nWe solve this system. Divide the first equation by $2EIL$ and the second by $2EIL^2$:\n1. $2\\alpha + L\\beta = \\frac{q_0L^2}{12EI}$\n2. $\\alpha + 2L\\beta = \\frac{q_0L^2}{24EI}$\nMultiply the second equation by $2$:\n$2\\alpha + 4L\\beta = \\frac{q_0L^2}{12EI}$\nSubtract the first equation from this result:\n$(2\\alpha + 4L\\beta) - (2\\alpha + L\\beta) = \\frac{q_0L^2}{12EI} - \\frac{q_0L^2}{12EI}$\n$3L\\beta = 0 \\implies \\beta = 0$\nThe result $\\beta=0$ is correct and is a consequence of the symmetry of the problem. The load and boundary conditions are symmetric about $x=L/2$, so the exact deflection must also be symmetric. The basis function $\\phi_1(x)$ is symmetric, while $\\phi_2(x)$ is not. The Galerkin method correctly identifies that the best approximation in the given subspace requires eliminating the anti-symmetric component, which in this basis corresponds to setting $\\beta=0$.\n\nSubstituting $\\beta=0$ into the first equation:\n$2\\alpha = \\frac{q_0L^2}{12EI} \\implies \\alpha = \\frac{q_0L^2}{24EI}$\n\nThe approximate deflection field is therefore:\n$$ w(x) = \\frac{q_0L^2}{24EI} x(L-x) $$\nThe problem asks for the midspan deflection, $w(L/2)$:\n$$ w\\left(\\frac{L}{2}\\right) = \\frac{q_0L^2}{24EI} \\left(\\frac{L}{2}\\right) \\left(L - \\frac{L}{2}\\right) = \\frac{q_0L^2}{24EI} \\left(\\frac{L}{2}\\right) \\left(\\frac{L}{2}\\right) = \\frac{q_0L^2}{24EI} \\frac{L^2}{4} $$\n$$ w\\left(\\frac{L}{2}\\right) = \\frac{q_0L^4}{96EI} $$\nThis is the final symbolic expression for the approximate midspan deflection.", "answer": "$$ \\boxed{\\frac{q_0 L^4}{96EI}} $$", "id": "2676301"}, {"introduction": "In computational methods like the Finite Element Method, distributed loads must be converted into discrete forces at element nodes. This exercise [@problem_id:2676357] demonstrates how the PVW provides the rigorous framework for this conversion to derive \"consistent\" nodal loads. By ensuring the work done by the nodal forces is equivalent to the work of the original traction for any kinematically admissible virtual displacement, this method preserves the energy principles of the system, which is crucial for the accuracy and convergence of numerical solutions.", "problem": "Consider a two-dimensional, isoparametric, bilinear quadrilateral finite element in plane stress with unit thickness. The element is a rectangle in the physical $(x,y)$-plane with nodes labeled counterclockwise: node $1$ at $(0,0)$, node $2$ at $(L,0)$, node $3$ at $(L,H)$, and node $4$ at $(0,H)$, where $L>0$ and $H>0$. Let $H=2$ while $L$ is arbitrary and does not enter the computation below. The right edge at $x=L$ (connecting node $2$ to node $3$) is subjected to a prescribed line traction (force per unit length) $\\bar{\\boldsymbol{t}}(y)$ with Cartesian components\n$$\n\\bar{t}_x(y)=1000+500\\,y, \\quad \\bar{t}_y(y)=200-100\\,y,\n$$\nfor $y\\in[0,H]$, measured in Newtons per meter.\n\nUsing only the principle of virtual work for deformable bodies and the standard finite element displacement interpolation for a bilinear quadrilateral, derive from first principles the expression for the consistent equivalent nodal load subvector associated with this boundary traction and evaluate it exactly for nodes $2$ and $3$. Clearly define the interpolation along the loaded edge, the geometric measure for the line integral, and the mapping of the traction field along the edge. Then, compute the consistent equivalent nodal load subvector in the order $[f_{2x}, f_{2y}, f_{3x}, f_{3y}]$.\n\nAdditionally, briefly explain conceptually (no formulas required) the distinction between consistent and lumped load vectors in this context and the implications for patch test satisfaction and convergence.\n\nProvide exact values (do not round). Express the final answer in Newtons. Do not include units inside your final boxed answer. The angle unit is not applicable to this problem.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It is a standard application of fundamental principles in finite element analysis. We will proceed with the derivation.\n\nThe derivation of the consistent equivalent nodal load vector originates from the principle of virtual work. The external virtual work, $\\delta W_{ext}$, done by a prescribed surface traction $\\bar{\\boldsymbol{t}}$ acting over a boundary $\\Gamma_t$ is given by the integral of the traction dotted with the virtual displacement $\\delta\\boldsymbol{u}$:\n$$\n\\delta W_{ext} = \\int_{\\Gamma_t} (\\delta\\boldsymbol{u})^T \\bar{\\boldsymbol{t}} \\, d\\Gamma\n$$\nWithin the finite element framework, the displacement field $\\boldsymbol{u}$ at any point inside an element is interpolated from the nodal displacements $\\boldsymbol{d}$ using a matrix of shape functions, $\\boldsymbol{N}$. For a $2$D problem, $\\boldsymbol{u}(x,y) = \\boldsymbol{N}(x,y) \\boldsymbol{d}$. Consequently, the virtual displacement is given by $\\delta\\boldsymbol{u} = \\boldsymbol{N} \\delta\\boldsymbol{d}$, where $\\delta\\boldsymbol{d}$ is the vector of virtual nodal displacements.\n\nSubstituting the interpolated virtual displacement into the virtual work expression, we have:\n$$\n\\delta W_{ext} = \\int_{\\Gamma_t} (\\boldsymbol{N} \\delta\\boldsymbol{d})^T \\bar{\\boldsymbol{t}} \\, d\\Gamma = (\\delta\\boldsymbol{d})^T \\int_{\\Gamma_t} \\boldsymbol{N}^T \\bar{\\boldsymbol{t}} \\, d\\Gamma\n$$\nThe external virtual work can also be expressed as the product of the virtual nodal displacements and the equivalent nodal force vector, $\\boldsymbol{f}_{ext}$: $\\delta W_{ext} = (\\delta\\boldsymbol{d})^T \\boldsymbol{f}_{ext}$. By comparing the two expressions for $\\delta W_{ext}$, we identify the consistent nodal load vector as:\n$$\n\\boldsymbol{f}_{ext} = \\int_{\\Gamma_t} \\boldsymbol{N}^T \\bar{\\boldsymbol{t}} \\, d\\Gamma\n$$\nThis problem concerns a bilinear quadrilateral element, for which the geometry and displacements are interpolated using shape functions in the natural coordinate system $(\\xi, \\eta)$, where $\\xi, \\eta \\in [-1, 1]$. The shape functions are:\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n\nThe traction is applied to the edge connecting node $2$ (at $(L,0)$) and node $3$ (at $(L,H)$). In the natural coordinate system, this edge corresponds to $\\xi = 1$, with $\\eta$ varying from $-1$ to $1$. Along this edge, the shape functions for nodes $1$ and $4$ are zero, while the shape functions for nodes $2$ and $3$ are:\n$$\nN_2(1, \\eta) = \\frac{1}{2}(1-\\eta), \\quad N_3(1, \\eta) = \\frac{1}{2}(1+\\eta)\n$$\nThe shape function matrix restricted to this edge and its active nodes ($2$ and $3$) is:\n$$\n\\boldsymbol{N}_{edge}^T = \\begin{bmatrix} N_2 & 0 \\\\ 0 & N_2 \\\\ N_3 & 0 \\\\ 0 & N_3 \\end{bmatrix}\n$$\nThe integral must be performed with respect to the physical arc length $d\\Gamma$. For an isoparametric element, we map $d\\Gamma$ into the natural coordinate system. The differential arc length along an edge of constant $\\xi$ is $d\\Gamma = \\sqrt{(\\frac{\\partial x}{\\partial \\eta})^2 + (\\frac{\\partial y}{\\partial \\eta})^2} \\, d\\eta$.\nThe physical coordinates $(x,y)$ are mapped from $(\\xi, \\eta)$ using the element shape functions and nodal coordinates: $x = \\sum_i N_i x_i$ and $y = \\sum_i N_i y_i$. On the edge $\\xi=1$:\n$x = N_2(1,\\eta)x_2 + N_3(1,\\eta)x_3 = \\frac{1}{2}(1-\\eta)L + \\frac{1}{2}(1+\\eta)L = L$.\n$y = N_2(1,\\eta)y_2 + N_3(1,\\eta)y_3 = \\frac{1}{2}(1-\\eta)(0) + \\frac{1}{2}(1+\\eta)H = \\frac{H}{2}(1+\\eta)$.\nWith $H=2$, this simplifies to $y = 1+\\eta$.\nThe derivatives with respect to $\\eta$ are $\\frac{\\partial x}{\\partial \\eta} = 0$ and $\\frac{\\partial y}{\\partial \\eta} = \\frac{H}{2} = \\frac{2}{2} = 1$.\nThe differential arc length is thus $d\\Gamma = \\sqrt{0^2 + 1^2} \\, d\\eta = d\\eta$. The integral will be over $\\eta \\in [-1, 1]$.\n\nNext, we express the traction components in terms of $\\eta$ using the relation $y = 1+\\eta$:\n$\\bar{t}_x(y) = 1000 + 500y \\implies \\bar{t}_x(\\eta) = 1000 + 500(1+\\eta) = 1500 + 500\\eta$.\n$\\bar{t}_y(y) = 200 - 100y \\implies \\bar{t}_y(\\eta) = 200 - 100(1+\\eta) = 100 - 100\\eta$.\nThe traction vector is $$ \\bar{\\boldsymbol{t}}(\\eta) = \\begin{Bmatrix} 1500 + 500\\eta \\\\ 100 - 100\\eta \\end{Bmatrix}. $$\n\nThe subvector of consistent nodal loads for nodes $2$ and $3$, $[f_{2x}, f_{2y}, f_{3x}, f_{3y}]^T$, is computed as:\n$$\n\\begin{Bmatrix} f_{2x} \\\\ f_{2y} \\\\ f_{3x} \\\\ f_{3y} \\end{Bmatrix} = \\int_{-1}^{1} \\begin{bmatrix} N_2 & 0 \\\\ 0 & N_2 \\\\ N_3 & 0 \\\\ 0 & N_3 \\end{bmatrix} \\begin{Bmatrix} \\bar{t}_x \\\\ \\bar{t}_y \\end{Bmatrix} \\, d\\eta\n$$\nWe evaluate each component:\n$f_{2x} = \\int_{-1}^{1} N_2(\\eta) \\bar{t}_x(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1-\\eta)(1500 + 500\\eta) \\, d\\eta = \\frac{1}{2} \\int_{-1}^{1} (1500 - 1000\\eta - 500\\eta^2) \\, d\\eta$\n$$\nf_{2x} = \\frac{1}{2} \\left[ 1500\\eta - 500\\eta^2 - \\frac{500}{3}\\eta^3 \\right]_{-1}^{1} = \\frac{1}{2} \\left[ (1500 - 500 - \\frac{500}{3}) - (-1500 - 500 + \\frac{500}{3}) \\right] = \\frac{1}{2} \\left( 3000 - \\frac{1000}{3} \\right) = \\frac{4000}{3}\n$$\n$f_{2y} = \\int_{-1}^{1} N_2(\\eta) \\bar{t}_y(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1-\\eta)(100 - 100\\eta) \\, d\\eta = \\frac{100}{2} \\int_{-1}^{1} (1-2\\eta+\\eta^2) \\, d\\eta$\n$$\nf_{2y} = 50 \\left[ \\eta - \\eta^2 + \\frac{\\eta^3}{3} \\right]_{-1}^{1} = 50 \\left[ (1 - 1 + \\frac{1}{3}) - (-1 - 1 - \\frac{1}{3}) \\right] = 50 \\left( \\frac{1}{3} - (-\\frac{7}{3}) \\right) = 50 \\left( \\frac{8}{3} \\right) = \\frac{400}{3}\n$$\n$f_{3x} = \\int_{-1}^{1} N_3(\\eta) \\bar{t}_x(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1+\\eta)(1500 + 500\\eta) \\, d\\eta = \\frac{1}{2} \\int_{-1}^{1} (1500 + 2000\\eta + 500\\eta^2) \\, d\\eta$\n$$\nf_{3x} = \\frac{1}{2} \\left[ 1500\\eta + 1000\\eta^2 + \\frac{500}{3}\\eta^3 \\right]_{-1}^{1} = \\frac{1}{2} \\left[ (1500 + 1000 + \\frac{500}{3}) - (-1500 + 1000 - \\frac{500}{3}) \\right] = \\frac{1}{2} \\left( 3000 + \\frac{1000}{3} \\right) = \\frac{5000}{3}\n$$\n$f_{3y} = \\int_{-1}^{1} N_3(\\eta) \\bar{t}_y(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1+\\eta)(100 - 100\\eta) \\, d\\eta = \\frac{100}{2} \\int_{-1}^{1} (1-\\eta^2) \\, d\\eta$\n$$\nf_{3y} = 50 \\left[ \\eta - \\frac{\\eta^3}{3} \\right]_{-1}^{1} = 50 \\left[ (1 - \\frac{1}{3}) - (-1 + \\frac{1}{3}) \\right] = 50 \\left( \\frac{2}{3} - (-\\frac{2}{3}) \\right) = 50 \\left( \\frac{4}{3} \\right) = \\frac{200}{3}\n$$\nThe computed subvector is $[f_{2x}, f_{2y}, f_{3x}, f_{3y}] = [\\frac{4000}{3}, \\frac{400}{3}, \\frac{5000}{3}, \\frac{200}{3}]$.\n\nConceptually, the **consistent load vector** is derived from the principle of virtual work, ensuring that the work done by the equivalent nodal loads under the interpolated virtual displacements is identical to the work done by the actual distributed traction. This method is \"consistent\" with the element's displacement field assumptions. In contrast, a **lumped load vector** is an approximation where the total force from the distributed traction is distributed (\"lumped\") among the nodes on the loaded boundary according to some simpler rule, such as equal division. This approach ignores the variation of the displacement field between the nodes.\nThe use of consistent load vectors is theoretically superior and is a necessary condition for an element formulation to pass the **patch test**. Satisfying the patch test guarantees that the element can exactly reproduce a constant stress state, which is a fundamental requirement for convergence. Lumped load vectors generally cause a formulation to fail the patch test, as the nodal loads are not energetically conjugate to the assumed displacement functions. Consequently, using consistent loads ensures the optimal rate of **convergence** of the finite element solution towards the exact solution as the mesh is refined. Lumping can degrade this rate and introduce errors, although it may be computationally simpler and yield acceptable results for very fine meshes.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4000}{3} & \\frac{400}{3} & \\frac{5000}{3} & \\frac{200}{3} \\end{pmatrix}}\n$$", "id": "2676357"}]}