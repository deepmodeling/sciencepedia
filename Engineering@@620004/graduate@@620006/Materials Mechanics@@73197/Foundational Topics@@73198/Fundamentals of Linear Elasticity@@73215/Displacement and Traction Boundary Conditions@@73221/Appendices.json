{"hands_on_practices": [{"introduction": "To begin, let's ground our understanding of boundary conditions with a classic one-dimensional problem. This exercise [@problem_id:2879033] involves determining the displacement field in a simple bar subjected to a body force and prescribed displacement values at its ends. By working through this problem, you will practice the fundamental skill of deriving the governing differential equation and applying displacement (or Dirichlet) boundary conditions to obtain a unique, physically meaningful solution.", "problem": "A straight, prismatic bar of length $L$ occupies the interval $x \\in [0,L]$ along the axial direction. The bar has constant cross-sectional area $A$ and Young's modulus $E$, so that $EA$ is constant. Small-strain, linear elasticity applies. A uniform body force per unit volume acts in the axial direction, with magnitude $b(x)=\\beta$, where $\\beta$ is a constant. The bar is subjected to essential (displacement) boundary conditions at both ends: $u(0)=0$ and $u(L)=\\delta$, where $u(x)$ is the axial displacement field and $\\delta$ is a prescribed constant.\n\nStarting from the three-dimensional static balance of linear momentum and appropriate kinematic and constitutive relations, reduce the problem to a one-dimensional strong form and solve for the axial displacement field $u(x)$ on $[0,L]$. Verify explicitly that the resulting $u(x)$ satisfies the given displacement boundary conditions. You may assume that plane cross-sections remain plane and that the stress is uniform across each section.\n\nReport only the final closed-form analytic expression for the displacement field $u(x)$. No numerical evaluation or rounding is required. Do not include units in the final expression.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed problem in one-dimensional linear elasticity, free of scientific or logical flaws, and provides all necessary information for a unique solution.\n\nThe problem requires deriving the one-dimensional governing equation from the three-dimensional static balance of linear momentum. In a static condition, with no acceleration, the balance of linear momentum is stated as:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0} $$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\mathbf{b}$ is the body force vector per unit volume.\n\nLet the axial direction of the bar be along the $x$-axis. The body force is given as a uniform field in the axial direction, so $\\mathbf{b} = (\\beta, 0, 0)$, where $\\beta$ is a constant. The assumptions that plane cross-sections remain plane and that stress is uniform across any given cross-section at a position $x$ reduce the stress state to a uniaxial one. The only non-zero component of the stress tensor is the axial normal stress, $\\sigma_{xx}$, which depends only on the axial coordinate $x$. We denote this as $\\sigma_x(x)$. All other stress components are zero: $\\sigma_{yy} = \\sigma_{zz} = \\sigma_{xy} = \\sigma_{xz} = \\sigma_{yz} = 0$.\n\nThe divergence of the stress tensor, $\\nabla \\cdot \\boldsymbol{\\sigma}$, in Cartesian coordinates expands into three equations for each component $i \\in \\{1, 2, 3\\}$:\n$$ \\frac{\\partial \\sigma_{ix}}{\\partial x} + \\frac{\\partial \\sigma_{iy}}{\\partial y} + \\frac{\\partial \\sigma_{iz}}{\\partial z} + b_i = 0 $$\nFor the $x$-direction ($i=1$):\n$$ \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} + \\frac{\\partial \\sigma_{xz}}{\\partial z} + b_x = 0 $$\nSubstituting the assumed stress state and body force, this simplifies to:\n$$ \\frac{d\\sigma_x(x)}{dx} + \\beta = 0 $$\nFor the $y$- and $z$-directions, the equations are identically satisfied ($0=0$). Thus, the three-dimensional theory correctly reduces to a single differential equation for the axial stress.\n\nNext, we introduce the kinematic and constitutive relations. For small strains, the axial strain $\\epsilon_x$ is related to the axial displacement field $u(x)$ by:\n$$ \\epsilon_x = \\frac{du}{dx} $$\nThe material behavior is linear elastic (Hooke's Law), relating stress and strain via the Young's modulus $E$:\n$$ \\sigma_x = E \\epsilon_x $$\nCombining these two relations, we express the stress in terms of the displacement:\n$$ \\sigma_x = E \\frac{du}{dx} $$\nSubstituting this expression for $\\sigma_x$ into the one-dimensional equilibrium equation yields the governing ordinary differential equation (ODE) for the displacement $u(x)$:\n$$ \\frac{d}{dx}\\left(E \\frac{du}{dx}\\right) + \\beta = 0 $$\nSince Young's modulus $E$ is given as constant, the equation becomes:\n$$ E \\frac{d^2u}{dx^2} + \\beta = 0 $$\n$$ \\frac{d^2u}{dx^2} = -\\frac{\\beta}{E} $$\nThis is the second-order ODE representing the strong form of the boundary value problem. We solve this equation by integrating twice with respect to $x$. The first integration gives the gradient of the displacement:\n$$ \\frac{du}{dx} = \\int \\left(-\\frac{\\beta}{E}\\right) dx = -\\frac{\\beta}{E}x + C_1 $$\nwhere $C_1$ is the first constant of integration. A second integration yields the general solution for the displacement field $u(x)$:\n$$ u(x) = \\int \\left(-\\frac{\\beta}{E}x + C_1\\right) dx = -\\frac{\\beta}{2E}x^2 + C_1 x + C_2 $$\nwhere $C_2$ is the second constant of integration.\n\nThe constants $C_1$ and $C_2$ are determined by applying the prescribed essential (displacement) boundary conditions: $u(0)=0$ and $u(L)=\\delta$.\n\nApplying the first boundary condition at $x=0$:\n$$ u(0) = -\\frac{\\beta}{2E}(0)^2 + C_1(0) + C_2 = 0 $$\nThis immediately gives $C_2=0$. The solution simplifies to:\n$$ u(x) = -\\frac{\\beta}{2E}x^2 + C_1 x $$\nApplying the second boundary condition at $x=L$:\n$$ u(L) = -\\frac{\\beta}{2E}L^2 + C_1 L = \\delta $$\nWe solve this algebraic equation for $C_1$:\n$$ C_1 L = \\delta + \\frac{\\beta L^2}{2E} $$\n$$ C_1 = \\frac{\\delta}{L} + \\frac{\\beta L}{2E} $$\nSubstituting the expressions for $C_1$ and $C_2$ back into the general solution for $u(x)$ gives the final, particular solution:\n$$ u(x) = -\\frac{\\beta}{2E}x^2 + \\left(\\frac{\\delta}{L} + \\frac{\\beta L}{2E}\\right)x $$\nThis expression can be rearranged for better physical interpretation by grouping terms related to the boundary displacement and terms related to the body force:\n$$ u(x) = \\frac{\\delta x}{L} + \\frac{\\beta L x}{2E} - \\frac{\\beta x^2}{2E} $$\n$$ u(x) = \\frac{\\delta x}{L} + \\frac{\\beta x}{2E}(L - x) $$\nThe first term, $\\frac{\\delta x}{L}$, represents the linear displacement field in the absence of body forces. The second term, $\\frac{\\beta x}{2E}(L-x)$, is the additional parabolic displacement profile caused by the uniform body force, which is zero at both ends $x=0$ and $x=L$.\n\nFinally, we explicitly verify that this solution satisfies the given boundary conditions.\nFor $x=0$:\n$$ u(0) = \\frac{\\delta (0)}{L} + \\frac{\\beta (0)}{2E}(L - 0) = 0 + 0 = 0 $$\nThe condition $u(0)=0$ is satisfied.\nFor $x=L$:\n$$ u(L) = \\frac{\\delta (L)}{L} + \\frac{\\beta (L)}{2E}(L - L) = \\delta + \\frac{\\beta L}{2E}(0) = \\delta $$\nThe condition $u(L)=\\delta$ is satisfied. The derived expression is correct.", "answer": "$$\n\\boxed{\\frac{\\delta x}{L} + \\frac{\\beta x}{2E}(L - x)}\n$$", "id": "2879033"}, {"introduction": "Having explored problems with prescribed displacements, we now turn to scenarios governed entirely by prescribed tractions, or Neumann boundary conditions. For a body to be in static equilibrium under such loading, the applied surface tractions and body forces must sum to zero resultant force and zero resultant moment. This exercise [@problem_id:2879010] provides a concrete \"hands-on\" check of this crucial compatibility condition, requiring you to integrate given traction and body force fields to verify that the system is indeed balanced.", "problem": "A homogeneous, linearly elastic, planar body of unit thickness occupies the rectangular domain $\\Omega=\\{(x,y)\\in\\mathbb{R}^{2}: 0\\le x \\le L,\\; 0\\le y \\le H\\}$. The body is subject to pure Neumann boundary conditions on its entire boundary $\\partial\\Omega$, with a prescribed traction field $\\bar{\\boldsymbol{t}}(x,y)$ and a body force density $\\boldsymbol{b}(x,y)$ acting throughout $\\Omega$. There are no displacement boundary conditions. Assume quasi-static conditions and neglect inertia.\n\nThe traction field is prescribed separately on each straight edge as follows:\n- On the left edge $\\Gamma_{L}=\\{(0,y): 0\\le y\\le H\\}$, $\\bar{\\boldsymbol{t}}(0,y)=\\big(\\alpha\\, y(H-y),\\, 0\\big)$.\n- On the right edge $\\Gamma_{R}=\\{(L,y): 0\\le y\\le H\\}$, $\\bar{\\boldsymbol{t}}(L,y)=\\big(-\\alpha\\, y(H-y),\\, 0\\big)$.\n- On the bottom edge $\\Gamma_{B}=\\{(x,0): 0\\le x\\le L\\}$, $\\bar{\\boldsymbol{t}}(x,0)=\\big(0,\\, \\beta\\, x(L-x)\\big)$.\n- On the top edge $\\Gamma_{T}=\\{(x,H): 0\\le x\\le L\\}$, $\\bar{\\boldsymbol{t}}(x,H)=\\big(0,\\,-\\beta\\, x(L-x)\\big)$.\n\nThe body force density is given by $\\boldsymbol{b}(x,y)=\\big(\\gamma\\,(2x-L),\\, \\delta\\,(2y-H)\\big)$ throughout $\\Omega$.\n\nHere, $L>0$ and $H>0$ are the domain dimensions in meters, while $\\alpha>0$ and $\\beta>0$ have units $\\mathrm{N}\\,\\mathrm{m}^{-3}$, and $\\gamma>0$ and $\\delta>0$ have units $\\mathrm{N}\\,\\mathrm{m}^{-3}$, consistent with unit thickness.\n\nStarting from the global balance of linear momentum and the global balance of angular momentum about the origin $(0,0)$, compute:\n- the total resultant force vector $\\boldsymbol{R}=\\displaystyle\\int_{\\partial\\Omega} \\bar{\\boldsymbol{t}}\\,\\mathrm{d}s+\\int_{\\Omega}\\boldsymbol{b}\\,\\mathrm{d}A$, with components $(R_{x},R_{y})$, and\n- the total out-of-plane scalar moment $M=\\displaystyle\\int_{\\partial\\Omega} (x\\,\\bar t_{y}-y\\,\\bar t_{x})\\,\\mathrm{d}s+\\int_{\\Omega} (x\\,b_{y}-y\\,b_{x})\\,\\mathrm{d}A$.\n\nState, based on your calculation, whether the pure Neumann compatibility conditions (zero resultant and zero moment) are satisfied.\n\nExpress your final answer as a single row matrix $\\big[R_{x}\\;\\;R_{y}\\;\\;M\\big]$, where $R_{x}$ and $R_{y}$ are in newtons and $M$ is in newton-meters. Provide exact values; no rounding is required.", "solution": "The problem requires the calculation of the total resultant force vector $\\boldsymbol{R}$ and the total resultant moment $M$ about the origin for a planar body subjected to specified surface tractions and body forces. These calculations are performed to verify the global equilibrium conditions, which are the necessary compatibility conditions for the existence of a solution to a pure Neumann boundary value problem in elastostatics.\n\nThe total resultant force vector $\\boldsymbol{R}$ is the sum of the integral of the prescribed traction vector $\\bar{\\boldsymbol{t}}$ over the boundary $\\partial\\Omega$ and the integral of the body force density $\\boldsymbol{b}$ over the domain $\\Omega$:\n$$ \\boldsymbol{R} = \\int_{\\partial\\Omega} \\bar{\\boldsymbol{t}}\\,\\mathrm{d}s+\\int_{\\Omega}\\boldsymbol{b}\\,\\mathrm{d}A $$\nThe components of $\\boldsymbol{R}$, denoted $R_{x}$ and $R_{y}$, are computed individually.\n\nFirst, we compute the $x$-component, $R_x$:\n$$ R_{x} = \\int_{\\partial\\Omega} \\bar{t}_{x}\\,\\mathrm{d}s+\\int_{\\Omega}b_{x}\\,\\mathrm{d}A $$\nThe boundary integral is evaluated over the four edges of the rectangle: $\\Gamma_{L}$, $\\Gamma_{R}$, $\\Gamma_{B}$, and $\\Gamma_{T}$.\n\nThe contribution from the left edge $\\Gamma_{L}$ (where $x=0$, $\\mathrm{d}s=\\mathrm{d}y$):\n$$ \\int_{\\Gamma_{L}} \\bar{t}_{x}\\,\\mathrm{d}s = \\int_{0}^{H} \\alpha y(H-y)\\,\\mathrm{d}y = \\alpha \\left[ \\frac{Hy^2}{2} - \\frac{y^3}{3} \\right]_0^H = \\alpha \\left( \\frac{H^3}{2} - \\frac{H^3}{3} \\right) = \\frac{\\alpha H^3}{6} $$\nThe contribution from the right edge $\\Gamma_{R}$ (where $x=L$, $\\mathrm{d}s=\\mathrm{d}y$):\n$$ \\int_{\\Gamma_{R}} \\bar{t}_{x}\\,\\mathrm{d}s = \\int_{0}^{H} -\\alpha y(H-y)\\,\\mathrm{d}y = -\\alpha \\left[ \\frac{Hy^2}{2} - \\frac{y^3}{3} \\right]_0^H = -\\frac{\\alpha H^3}{6} $$\nOn the bottom edge $\\Gamma_B$ and top edge $\\Gamma_T$, the prescribed traction component $\\bar{t}_x$ is zero, thus their contributions to the integral are zero. The total force from all tractions in the $x$-direction is $\\frac{\\alpha H^3}{6} - \\frac{\\alpha H^3}{6} + 0 + 0 = 0$.\n\nThe contribution from the body force component $b_x = \\gamma(2x-L)$ is:\n$$ \\int_{\\Omega} b_x\\,\\mathrm{d}A = \\int_0^L \\int_0^H \\gamma(2x-L)\\,\\mathrm{d}y\\,\\mathrm{d}x = \\gamma H \\int_0^L (2x-L)\\,\\mathrm{d}x = \\gamma H \\left[ x^2 - Lx \\right]_0^L = \\gamma H (L^2 - L^2) = 0 $$\nTherefore, the total resultant force component is $R_x = 0+0=0$.\n\nNext, we compute the $y$-component, $R_y$:\n$$ R_y = \\int_{\\partial\\Omega} \\bar{t}_y\\,\\mathrm{d}s+\\int_{\\Omega} b_y\\,\\mathrm{d}A $$\nOn the left edge $\\Gamma_L$ and right edge $\\Gamma_R$, $\\bar{t}_y=0$, so their contributions are zero.\nThe contribution from the bottom edge $\\Gamma_B$ (where $y=0$, $\\mathrm{d}s=\\mathrm{d}x$):\n$$ \\int_{\\Gamma_B} \\bar{t}_y\\,\\mathrm{d}s = \\int_{0}^{L} \\beta x(L-x)\\,\\mathrm{d}x = \\beta \\left[ \\frac{Lx^2}{2} - \\frac{x^3}{3} \\right]_0^L = \\beta \\left( \\frac{L^3}{2} - \\frac{L^3}{3} \\right) = \\frac{\\beta L^3}{6} $$\nThe contribution from the top edge $\\Gamma_T$ (where $y=H$, $\\mathrm{d}s=\\mathrm{d}x$):\n$$ \\int_{\\Gamma_T} \\bar{t}_y\\,\\mathrm{d}s = \\int_{0}^{L} -\\beta x(L-x)\\,\\mathrm{d}x = -\\beta \\left[ \\frac{Lx^2}{2} - \\frac{x^3}{3} \\right]_0^L = -\\frac{\\beta L^3}{6} $$\nThe total force from all tractions in the $y$-direction is $0 + 0 + \\frac{\\beta L^3}{6} - \\frac{\\beta L^3}{6} = 0$.\n\nThe contribution from the body force component $b_y = \\delta(2y-H)$ is:\n$$ \\int_{\\Omega} b_y\\,\\mathrm{d}A = \\int_0^L \\int_0^H \\delta(2y-H)\\,\\mathrm{d}y\\,\\mathrm{d}x = \\delta L \\int_0^H (2y-H)\\,\\mathrm{d}y = \\delta L \\left[ y^2 - Hy \\right]_0^H = \\delta L (H^2 - H^2) = 0 $$\nTherefore, the total resultant force component is $R_y = 0+0=0$. The resultant force vector is $\\boldsymbol{R} = (0,0)$.\n\nFinally, we compute the total out-of-plane scalar moment $M$ about the origin $(0,0)$:\n$$ M = \\int_{\\partial\\Omega} (x\\,\\bar{t}_{y}-y\\,\\bar{t}_{x})\\,\\mathrm{d}s+\\int_{\\Omega} (x\\,b_{y}-y\\,b_{x})\\,\\mathrm{d}A $$\nThe boundary integral's contributions are:\nFrom $\\Gamma_L$ (where $x=0$, $\\bar{t}_y=0$, $\\mathrm{d}s=\\mathrm{d}y$):\n$$ \\int_0^H (0\\cdot 0 - y\\cdot \\alpha y(H-y))\\,\\mathrm{d}y = -\\alpha \\int_0^H (Hy^2-y^3)\\,\\mathrm{d}y = -\\alpha \\left[ \\frac{Hy^3}{3}-\\frac{y^4}{4} \\right]_0^H = -\\frac{\\alpha H^4}{12} $$\nFrom $\\Gamma_R$ (where $x=L$, $\\bar{t}_y=0$, $\\mathrm{d}s=\\mathrm{d}y$):\n$$ \\int_0^H (L\\cdot 0 - y\\cdot (-\\alpha y(H-y)))\\,\\mathrm{d}y = \\alpha \\int_0^H (Hy^2-y^3)\\,\\mathrm{d}y = \\alpha \\left[ \\frac{Hy^3}{3}-\\frac{y^4}{4} \\right]_0^H = \\frac{\\alpha H^4}{12} $$\nFrom $\\Gamma_B$ (where $y=0$, $\\bar{t}_x=0$, $\\mathrm{d}s=\\mathrm{d}x$):\n$$ \\int_0^L (x\\cdot\\beta x(L-x) - 0)\\,\\mathrm{d}x = \\beta \\int_0^L (Lx^2-x^3)\\,\\mathrm{d}x = \\beta \\left[ \\frac{Lx^3}{3}-\\frac{x^4}{4} \\right]_0^L = \\frac{\\beta L^4}{12} $$\nFrom $\\Gamma_T$ (where $y=H$, $\\bar{t}_x=0$, $\\mathrm{d}s=\\mathrm{d}x$):\n$$ \\int_0^L (x\\cdot(-\\beta x(L-x)) - H\\cdot 0)\\,\\mathrm{d}x = -\\beta \\int_0^L (Lx^2-x^3)\\,\\mathrm{d}x = -\\beta \\left[ \\frac{Lx^3}{3}-\\frac{x^4}{4} \\right]_0^L = -\\frac{\\beta L^4}{12} $$\nThe total moment from tractions is the sum $-\\frac{\\alpha H^4}{12} + \\frac{\\alpha H^4}{12} + \\frac{\\beta L^4}{12} - \\frac{\\beta L^4}{12} = 0$.\n\nThe contribution to the moment from the body force is:\n$$ \\int_{\\Omega} (x b_y - y b_x)\\,\\mathrm{d}A = \\int_0^L \\int_0^H \\left[ x \\delta(2y-H) - y \\gamma(2x-L) \\right] \\,\\mathrm{d}y\\,\\mathrm{d}x $$\nThis integral is separable and evaluates to zero:\n$$ \\int_0^L \\int_0^H x \\delta(2y-H)\\,\\mathrm{d}y\\,\\mathrm{d}x = \\delta \\left( \\int_0^L x\\,\\mathrm{d}x \\right) \\left( \\int_0^H (2y-H)\\,\\mathrm{d}y \\right) = \\delta \\left( \\frac{L^2}{2} \\right) \\left( [y^2 - Hy]_0^H \\right) = 0 $$\n$$ -\\int_0^L \\int_0^H y \\gamma(2x-L)\\,\\mathrm{d}y\\,\\mathrm{d}x = -\\gamma \\left( \\int_0^L (2x-L)\\,\\mathrm{d}x \\right) \\left( \\int_0^H y\\,\\mathrm{d}y \\right) = -\\gamma \\left( [x^2 - Lx]_0^L \\right) \\left( \\frac{H^2}{2} \\right) = 0 $$\nThe total moment from body forces is $0$. Therefore, the total resultant moment is $M = 0+0=0$.\n\nSince the total resultant force $\\boldsymbol{R} = (0,0)$ and the total resultant moment $M=0$, the applied loads are in global static equilibrium. The pure Neumann compatibility conditions are satisfied. The final answer is the row matrix $[R_x\\; R_y\\; M]$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2879010"}, {"introduction": "We culminate our practice by bridging theory with modern computational techniques to explore one of elasticity's most elegant principles: Betti's reciprocity theorem. This theorem establishes a profound relationship between two different loading states on the same elastic body. This hands-on coding exercise [@problem_id:2879005] guides you to build a finite difference solver to find displacement fields under different traction boundary conditions and then use these numerical solutions to verify that the work done by the first set of tractions acting through the second set of displacements is equal to the work done by the second set of tractions acting through the first set of displacements.", "problem": "Consider antiplane shear of a homogeneous, isotropic, linear elastic body occupying the rectangle $\\Omega = [0,L]\\times[0,H]$ with unit thickness out of plane. Let $w(x,y)$ denote the out-of-plane displacement, and let the shear modulus be the constant $\\mu&gt;0$. In the absence of body forces, $w$ satisfies the equilibrium equation $\\nabla\\cdot(\\mu\\nabla w)=0$ in $\\Omega$. Let the boundary be decomposed as $\\partial\\Omega=\\Gamma_u\\cup\\Gamma_t$, where $\\Gamma_u$ denotes the displacement (Dirichlet) boundary and $\\Gamma_t$ denotes the traction (Neumann) boundary. For this problem, take $\\Gamma_u=\\{(x,0):0\\le x\\le L\\}\\cup\\{(0,y):0\\le y\\le H\\}\\cup\\{(L,y):0\\le y\\le H\\}$ and $\\Gamma_t=\\{(x,H):0\\le x\\le L\\}$. On $\\Gamma_u$, impose $w=0$. On $\\Gamma_t$, impose the boundary traction condition $\\mu\\,\\partial w/\\partial n=\\bar t(x)$, where $\\partial/\\partial n$ is the outward normal derivative and the traction $\\bar t(x)$ acts only on $\\Gamma_t$. Consider $2$ distinct load cases $k\\in\\{1,2\\}$ with tractions $\\bar t^{(k)}(x)$ on $\\Gamma_t$ that produce solutions $w^{(k)}(x,y)$.\n\nYour task is to verify reciprocity numerically by computing the two boundary work functionals\n$$\nI_{12}=\\int_{\\Gamma_t}\\bar t^{(1)}(x)\\,w^{(2)}(x,H)\\,da,\\qquad\nI_{21}=\\int_{\\Gamma_t}\\bar t^{(2)}(x)\\,w^{(1)}(x,H)\\,da,\n$$\nand comparing $I_{12}$ and $I_{21}$ for several test cases. For antiplane shear, the traction and displacement are scalar fields on $\\Gamma_t$, and $da=dx$ on the top edge. All answers must be expressed in Joules per unit thickness, that is, in $\\mathrm{N\\cdot m}$ per unit thickness, and reported as decimal numbers.\n\nYou must construct a consistent numerical approximation that starts from the governing equation $\\nabla\\cdot(\\mu\\nabla w)=0$ with the specified boundary conditions, without introducing any auxiliary shortcut formulas. Discretize $\\Omega$ with a uniform Cartesian grid of $N_x$ points along $x$ and $N_y$ points along $y$, with $N_x=N_y=101$ and spacings $\\Delta x=L/(N_x-1)$, $\\Delta y=H/(N_y-1)$. Enforce the Dirichlet boundary condition $w=0$ on $\\Gamma_u$ strongly, and enforce the Neumann traction on $\\Gamma_t$ through a first-order consistent ghost-point treatment that is compatible with the interior $5$-point finite difference discretization of the Laplacian for constant $\\mu$. After solving for $w^{(1)}$ and $w^{(2)}$ for each test case, reconstruct the displacement trace on $\\Gamma_t$ consistently with the same ghost-point relation used to apply the traction, and approximate the boundary integrals $I_{12}$ and $I_{21}$ using the composite trapezoidal rule along $\\Gamma_t$.\n\nTest suite. Use the following three parameter sets, each defining $(L,H,\\mu,\\bar t^{(1)}(x),\\bar t^{(2)}(x))$:\n\n- Case $1$: $L=1\\,\\mathrm{m}$, $H=0.5\\,\\mathrm{m}$, $\\mu=30\\times 10^{9}\\,\\mathrm{Pa}$, $\\bar t^{(1)}(x)=q_0\\sin\\!\\big(\\pi x/L\\big)$, $\\bar t^{(2)}(x)=q_0\\,(x/L)$ with $q_0=1\\times 10^{6}\\,\\mathrm{Pa}$.\n\n- Case $2$: $L=1\\,\\mathrm{m}$, $H=0.25\\,\\mathrm{m}$, $\\mu=50\\times 10^{9}\\,\\mathrm{Pa}$, $\\bar t^{(1)}(x)=q_0$ (constant), $\\bar t^{(2)}(x)=q_0\\cos\\!\\big(2\\pi x/L\\big)$ with $q_0=2\\times 10^{6}\\,\\mathrm{Pa}$.\n\n- Case $3$: $L=1\\,\\mathrm{m}$, $H=1\\,\\mathrm{m}$, $\\mu=10\\times 10^{9}\\,\\mathrm{Pa}$, $\\bar t^{(1)}(x)=q_0\\,(x/L)\\,(1-x/L)$, $\\bar t^{(2)}(x)=q_0\\sin\\!\\big(3\\pi x/L\\big)$ with $q_0=1\\times 10^{6}\\,\\mathrm{Pa}$.\n\nFor each case, compute $I_{12}$ and $I_{21}$ as described, then report the absolute discrepancy $\\Delta=\\lvert I_{12}-I_{21}\\rvert$.\n\nFinal output format. Your program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, in the order of the cases listed above, with each number printed in scientific notation with $10$ significant digits (for example, $[1.2345678900e{-}03,5.0000000000e{+}00,7.8900000000e{-}01]$). These numbers represent the absolute discrepancies $\\Delta$ for Cases $1$, $2$, and $3$, respectively, in $\\mathrm{J}$ per unit thickness (that is, $\\mathrm{N\\cdot m}$ per unit thickness).", "solution": "The user has requested a numerical verification of the reciprocity theorem for antiplane shear on a rectangular domain. The problem requires solving the governing partial differential equation (PDE) for two different loading cases and then computing work-like boundary integrals to check for equality. The problem is well-defined, scientifically sound, and contains all necessary parameters for a numerical solution. We shall proceed with the derivation and implementation of the specified numerical method.\n\nThe physical problem is the antiplane shear of a linear elastic body occupying the domain $\\Omega = [0,L]\\times[0,H]$. The out-of-plane displacement, $w(x,y)$, is governed by the equilibrium equation which, for a constant shear modulus $\\mu > 0$ and in the absence of body forces, simplifies to Laplace's equation:\n$$\n\\nabla^2 w(x,y) = \\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2} = 0\n$$\nThe boundary conditions are of a mixed type. On three sides of the rectangle, a zero-displacement (Dirichlet) condition is imposed:\n$$\nw(x,0) = 0 \\quad \\text{for } 0 \\le x \\le L\n$$\n$$\nw(0,y) = 0 \\quad \\text{for } 0 \\le y \\le H\n$$\n$$\nw(L,y) = 0 \\quad \\text{for } 0 \\le y \\le H\n$$\nOn the top edge, a traction (Neumann) boundary condition is specified:\n$$\n\\mu \\frac{\\partial w}{\\partial n} = \\mu \\frac{\\partial w}{\\partial y} = \\bar t(x) \\quad \\text{for } y=H, 0 \\le x \\le L\n$$\nwhere $\\bar t(x)$ is the applied traction.\n\nWe discretize the domain $\\Omega$ using a uniform Cartesian grid with $N_x=101$ points in the $x$-direction and $N_y=101$ points in the $y$-direction. The grid points are $(x_i, y_j)$, where $x_i = i \\Delta x$ for $i=0, ..., N_x-1$ and $y_j = j \\Delta y$ for $j=0, ..., N_y-1$. The grid spacings are $\\Delta x = L/(N_x-1)$ and $\\Delta y = H/(N_y-1)$. Let $w_{i,j}$ be the numerical approximation of $w(x_i, y_j)$.\n\nThe Laplace operator is approximated using a standard $5$-point central difference stencil at interior points $(x_i, y_j)$:\n$$\n\\frac{w_{i+1,j} - 2w_{i,j} + w_{i-1,j}}{(\\Delta x)^2} + \\frac{w_{i,j+1} - 2w_{i,j} + w_{i,j-1}}{(\\Delta y)^2} = 0\n$$\nThe set of unknown displacements are $w_{i,j}$ for $i \\in [1, N_x-2]$ and $j \\in [1, N_y-2]$. The Dirichlet boundary conditions $w=0$ on $\\Gamma_u$ are enforced strongly by setting the values on the boundaries to zero and not including them as unknowns.\n\nFor the Neumann condition on the top boundary $y=H$ (at grid index $j=N_y-1$), we use a first-order accurate method as specified. We write the finite difference equation for the nodes on the row just below the top boundary, i.e., at $j=N_y-2$. The stencil for such a point $(i, N_y-2)$ involves the value $w_{i, N_y-1}$ from the top boundary. We eliminate this term using a first-order accurate backward finite difference approximation of the Neumann condition:\n$$\n\\mu \\frac{w_{i,N_y-1} - w_{i,N_y-2}}{\\Delta y} = \\bar t(x_i)\n$$\nThis gives an expression for the displacement on the top boundary to be used for \"reconstruction\" after the main system is solved:\n$$\nw_{i,N_y-1} = w_{i,N_y-2} + \\frac{\\Delta y}{\\mu} \\bar t(x_i)\n$$\nSubstituting this into the standard stencil equation at point $(i, N_y-2)$ yields a modified equation for the top row of unknowns:\n$$\n\\frac{w_{i+1,N_y-2} - 2w_{i,N_y-2} + w_{i-1,N_y-2}}{(\\Delta x)^2} + \\frac{(w_{i,N_y-2} + \\frac{\\Delta y}{\\mu} \\bar t(x_i)) - 2w_{i,N_y-2} + w_{i,N_y-3}}{(\\Delta y)^2} = 0\n$$\nRearranging terms, we obtain:\n$$\n\\frac{1}{(\\Delta x)^2}(w_{i+1,N_y-2} + w_{i-1,N_y-2}) + \\frac{1}{(\\Delta y)^2}w_{i,N_y-3} - \\left(\\frac{2}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)w_{i,N_y-2} = -\\frac{\\bar t(x_i)}{\\mu \\Delta y}\n$$\nThis procedure results in a system of $(N_x-2) \\times (N_y-2)$ linear algebraic equations of the form $A\\mathbf{w}=\\mathbf{b}$, where $\\mathbf{w}$ is a vector of the unknown displacements $w_{i,j}$. The matrix $A$ is sparse and is determined by the geometry and discretization scheme, while the vector $\\mathbf{b}$ contains the contributions from the Neumann boundary condition.\n\nTo verify reciprocity, we solve this system for two traction distributions, $\\bar t^{(1)}(x)$ and $\\bar t^{(2)}(x)$, to obtain the corresponding displacement fields $w^{(1)}(x,y)$ and $w^{(2)}(x,y)$. After solving for the internal displacements $w^{(k)}_{i,j}$ for $j=1,...,N_y-2$, we reconstruct the displacement on the top boundary $w^{(k)}_{i, N_y-1}$ using the relation derived from the backward difference. The boundary work functionals are then computed using the composite trapezoidal rule:\n$$\nI_{12}=\\int_{0}^{L}\\bar t^{(1)}(x)\\,w^{(2)}(x,H)\\,dx \\approx \\sum_{i=0}^{N_x-2} \\frac{\\bar t^{(1)}_i w^{(2)}_{i,N_y-1} + \\bar t^{(1)}_{i+1} w^{(2)}_{i+1,N_y-1}}{2} \\Delta x\n$$\n$$\nI_{21}=\\int_{0}^{L}\\bar t^{(2)}(x)\\,w^{(1)}(x,H)\\,dx \\approx \\sum_{i=0}^{N_x-2} \\frac{\\bar t^{(2)}_i w^{(1)}_{i,N_y-1} + \\bar t^{(2)}_{i+1} w^{(1)}_{i+1,N_y-1}}{2} \\Delta x\n$$\nBetti's reciprocity theorem states that $I_{12}=I_{21}$ for the exact solution. Due to discretization errors, the numerical results will show a small discrepancy. The final step is to compute this absolute discrepancy $\\Delta = |I_{12}-I_{21}|$ for each supplied test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'L': 1.0, 'H': 0.5, 'mu': 30e9, 'q0': 1e6,\n         't1_func': lambda x, L, q0: q0 * np.sin(np.pi * x / L),\n         't2_func': lambda x, L, q0: q0 * (x / L)},\n        # Case 2\n        {'L': 1.0, 'H': 0.25, 'mu': 50e9, 'q0': 2e6,\n         't1_func': lambda x, L, q0: q0 * np.ones_like(x),\n         't2_func': lambda x, L, q0: q0 * np.cos(2 * np.pi * x / L)},\n        # Case 3\n        {'L': 1.0, 'H': 1.0, 'mu': 10e9, 'q0': 1e6,\n         't1_func': lambda x, L, q0: q0 * (x / L) * (1 - x / L),\n         't2_func': lambda x, L, q0: q0 * np.sin(3 * np.pi * x / L)},\n    ]\n\n    results = []\n    for case in test_cases:\n        discrepancy = compute_discrepancy(case)\n        results.append(discrepancy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\ndef compute_discrepancy(case_params):\n    \"\"\"\n    Solves the antiplane shear problem and computes the reciprocity discrepancy.\n    \"\"\"\n    L = case_params['L']\n    H = case_params['H']\n    mu = case_params['mu']\n    q0 = case_params['q0']\n    t1_func = case_params['t1_func']\n    t2_func = case_params['t2_func']\n\n    # Grid parameters\n    Nx = 101\n    Ny = 101\n    dx = L / (Nx - 1)\n    dy = H / (Ny - 1)\n    \n    x_coords = np.linspace(0, L, Nx)\n\n    # The unknowns are w_{i,j} for i in [1, Nx-2] and j in [1, Ny-2].\n    num_unknowns_x = Nx - 2\n    num_unknowns_y = Ny - 2\n    M = num_unknowns_x * num_unknowns_y\n\n    Cx = 1 / dx**2\n    Cy = 1 / dy**2\n\n    # Assemble the sparse matrix A, which is the same for both load cases.\n    # We use a column-major ordering for the unknowns: k = (i - 1) * num_unknowns_y + (j - 1)\n    A = lil_matrix((M, M))\n    \n    for i in range(1, Nx - 1): # Physical x-index from 1 to Nx-2\n        for j in range(1, Ny - 1): # Physical y-index from 1 to Ny-2\n            # Map (i,j) to linear index k\n            k = (i - 1) * num_unknowns_y + (j - 1)\n\n            # Terms related to x-derivatives\n            if i > 1:\n                A[k, k - num_unknowns_y] = Cx  # w_{i-1,j}\n            if i  Nx - 2:\n                A[k, k + num_unknowns_y] = Cx  # w_{i+1,j}\n            \n            # Terms related to y-derivatives\n            if j > 1:\n                A[k, k - 1] = Cy # w_{i,j-1}\n            \n            if j  num_unknowns_y: # (j  Ny-2) Standard interior point row\n                A[k, k] = -2 * (Cx + Cy)\n                A[k, k + 1] = Cy # w_{i,j+1}\n            else: # (j == Ny-2) Top row of unknowns, modified for Neumann BC\n                A[k, k] = -2 * Cx - Cy\n\n    # Convert A to CSR format for efficient solving\n    A_csr = csr_matrix(A)\n\n    def solve_for_traction(t_func):\n        # Assemble the RHS vector b\n        b = np.zeros(M)\n        t_values_on_grid = t_func(x_coords, L, q0)\n        \n        for i in range(1, Nx - 1): # Iterate over internal x-nodes\n            k = (i - 1) * num_unknowns_y + (num_unknowns_y - 1)\n            b[k] = -t_values_on_grid[i] / (mu * dy)\n            \n        # Solve the linear system Au = b\n        w_internal_flat = spsolve(A_csr, b)\n        \n        # Reshape solution to 2D grid based on column-major ordering\n        # Transpose to get (j,i) indexing convention\n        w_internal = w_internal_flat.reshape((num_unknowns_x, num_unknowns_y)).T\n\n        # Reconstruct displacement on the top boundary (y=H, j=Ny-1)\n        w_on_H = np.zeros(Nx) # w(x_i, H)\n\n        # Values w_{i, Ny-2} are the top row of the solved system.\n        w_at_j_Ny_minus_2 = w_internal[-1, :]\n        \n        # Reconstruct using the first-order backward difference relation\n        # w_{i, Ny-1} = w_{i, Ny-2} + (dy/mu) * t_i\n        w_on_H[1:Nx-1] = w_at_j_Ny_minus_2 + (dy / mu) * t_values_on_grid[1:Nx-1]\n        \n        return w_on_H\n\n    # Solve for both load cases to get displacements on the top boundary\n    wH_1 = solve_for_traction(t1_func)\n    wH_2 = solve_for_traction(t2_func)\n    \n    # Get traction values on the grid for integration\n    t1_grid = t1_func(x_coords, L, q0)\n    t2_grid = t2_func(x_coords, L, q0)\n    \n    # Compute the work-like integrals using the composite trapezoidal rule\n    I12 = np.trapz(t1_grid * wH_2, x_coords)\n    I21 = np.trapz(t2_grid * wH_1, x_coords)\n    \n    # Compute the absolute discrepancy\n    discrepancy = np.abs(I12 - I21)\n    \n    return discrepancy\n\nsolve()\n```", "id": "2879005"}]}