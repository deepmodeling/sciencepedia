{"hands_on_practices": [{"introduction": "The components of a tensor, like stress, depend on the coordinate system you choose; however, the physical reality they describe does not. This practice guides you through the foundational exercise of rotating a stress tensor to see how its components change, while also demonstrating that a special quantity, the second deviatoric invariant $J_2$, remains constant regardless of the orientation [@problem_id:2922615]. This hands-on derivation solidifies the crucial distinction between frame-dependent components and objective physical invariants.", "problem": "Consider a homogeneous, linearly elastic body in a plane stress state described in a Cartesian basis $\\{\\mathbf{e}_x,\\mathbf{e}_y,\\mathbf{e}_z\\}$ by the Cauchy stress tensor\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} & 0\\\\[4pt]\n\\tau_{xy} & \\sigma_y & 0\\\\[4pt]\n0 & 0 & 0\n\\end{pmatrix},\n$$\nwhere $\\sigma_x$, $\\sigma_y$, and $\\tau_{xy}$ are real constants. Let $\\mathbf{Q}(\\theta)$ denote an orthogonal rotation by an angle $\\theta$ about the $\\mathbf{e}_z$-axis, and let $\\boldsymbol{\\sigma}'(\\theta)$ be the stress tensor expressed in the rotated basis obtained by the standard second-order tensor transformation rule $\\boldsymbol{\\sigma}'=\\mathbf{Q}\\,\\boldsymbol{\\sigma}\\,\\mathbf{Q}^{\\mathsf{T}}$. \n\nStarting only from the definitions of orthogonal transformations for second-order tensors, the rotational invariance of the trace, and the deviatoric decomposition $\\boldsymbol{s}=\\boldsymbol{\\sigma} - \\tfrac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}$, perform the following:\n\n- Derive the expressions for the transformed in-plane components $\\sigma'_{x'x'}(\\theta)$, $\\sigma'_{y'y'}(\\theta)$, and $\\tau_{x'y'}(\\theta)$ as functions of $\\sigma_x$, $\\sigma_y$, $\\tau_{xy}$, and $\\theta$.\n- Using only invariant arguments grounded in orthogonal similarity and the deviatoric split, eliminate the explicit dependence on $\\theta$ and obtain a closed-form expression for the second invariant of the deviatoric stress, defined by $J_2=\\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$, purely in terms of $\\sigma_x$, $\\sigma_y$, and $\\tau_{xy}$.\n\nProvide as your final answer the simplified analytic expression for $J_2$. Do not provide intermediate steps or multiple expressions as your final answer. No numerical values are required, and no rounding is needed. Express your final answer as a single analytic expression with no units.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard problem in continuum mechanics that is based on fundamental principles of tensor analysis and is free of any logical contradictions, factual errors, or ambiguities. All necessary information is provided. Thus, we proceed to the solution.\n\nThe problem is divided into two parts. First, we derive the transformation rules for the in-plane components of the stress tensor. Second, we derive an expression for the second invariant of the deviatoric stress, $J_2$, using an argument based on its invariance properties.\n\nPart 1: Derivation of Transformed Stress Components\n\nThe transformation of a second-order tensor $\\boldsymbol{\\sigma}$ under a change of basis is given by $\\boldsymbol{\\sigma}' = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}$, where $\\mathbf{Q}$ is the orthogonal transformation matrix. For a rotation of the coordinate system by an angle $\\theta$ about the $\\mathbf{e}_z$-axis, the transformation matrix $\\mathbf{Q}(\\theta)$ and its transpose $\\mathbf{Q}^{\\mathsf{T}}(\\theta)$ are:\n$$\n\\mathbf{Q}(\\theta) = \\begin{pmatrix}\n\\cos\\theta & \\sin\\theta & 0 \\\\\n-\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}, \\quad \\mathbf{Q}^{\\mathsf{T}}(\\theta) = \\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta & 0 \\\\\n\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nThe given stress tensor for a plane stress state is:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n\\sigma_x & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_y & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nWe perform the matrix multiplication $\\boldsymbol{\\sigma}'(\\theta) = \\mathbf{Q}(\\theta)\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}(\\theta)$. Due to the structure of the matrices, we need only consider the upper-left $2 \\times 2$ block. Let $c = \\cos\\theta$ and $s = \\sin\\theta$.\n$$\n\\boldsymbol{\\sigma}'_{2D} = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix} \\begin{pmatrix} \\sigma_x & \\tau_{xy} \\\\ \\tau_{xy} & \\sigma_y \\end{pmatrix} \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} c\\sigma_x + s\\tau_{xy} & c\\tau_{xy} + s\\sigma_y \\\\ -s\\sigma_x + c\\tau_{xy} & -s\\tau_{xy} + c\\sigma_y \\end{pmatrix} \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix}\nc(c\\sigma_x + s\\tau_{xy}) + s(c\\tau_{xy} + s\\sigma_y) & -s(c\\sigma_x + s\\tau_{xy}) + c(c\\tau_{xy} + s\\sigma_y) \\\\\nc(-s\\sigma_x + c\\tau_{xy}) + s(-s\\tau_{xy} + c\\sigma_y) & -s(-s\\sigma_x + c\\tau_{xy}) + c(-s\\tau_{xy} + c\\sigma_y)\n\\end{pmatrix}\n$$\nThe components of the transformed tensor $\\boldsymbol{\\sigma}'$ are:\n$\\sigma'_{x'x'} = \\sigma'_{11} = c^2\\sigma_x + s^2\\sigma_y + 2sc\\tau_{xy}$\n$\\sigma'_{y'y'} = \\sigma'_{22} = s^2\\sigma_x + c^2\\sigma_y - 2sc\\tau_{xy}$\n$\\tau'_{x'y'} = \\sigma'_{12} = (c^2-s^2)\\tau_{xy} - sc(\\sigma_x - \\sigma_y)$\n\nUsing the trigonometric identities $\\cos^2\\theta = \\frac{1}{2}(1+\\cos(2\\theta))$, $\\sin^2\\theta = \\frac{1}{2}(1-\\cos(2\\theta))$, $2\\sin\\theta\\cos\\theta = \\sin(2\\theta)$, and $\\cos^2\\theta - \\sin^2\\theta = \\cos(2\\theta)$, we simplify these expressions:\n$$\n\\sigma'_{x'x'}(\\theta) = \\sigma_x\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) + \\sigma_y\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) + \\tau_{xy}\\sin(2\\theta) = \\frac{\\sigma_x+\\sigma_y}{2} + \\frac{\\sigma_x-\\sigma_y}{2}\\cos(2\\theta) + \\tau_{xy}\\sin(2\\theta)\n$$\n$$\n\\sigma'_{y'y'}(\\theta) = \\sigma_x\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) + \\sigma_y\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) - \\tau_{xy}\\sin(2\\theta) = \\frac{\\sigma_x+\\sigma_y}{2} - \\frac{\\sigma_x-\\sigma_y}{2}\\cos(2\\theta) - \\tau_{xy}\\sin(2\\theta)\n$$\n$$\n\\tau'_{x'y'}(\\theta) = -\\left(\\frac{\\sigma_x-\\sigma_y}{2}\\right)\\sin(2\\theta) + \\tau_{xy}\\cos(2\\theta)\n$$\n\nPart 2: Derivation of the Invariant $J_2$\n\nThe problem requires a derivation based on invariant arguments. The quantity $J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ is, by its construction as a scalar product of a tensor with itself, a scalar invariant under orthogonal transformations. We demonstrate this formally.\n\nThe deviatoric stress tensor $\\boldsymbol{s}$ is defined as $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}$.\nIn a rotated coordinate system, the transformed deviatoric stress is $\\boldsymbol{s}' = \\boldsymbol{\\sigma}' - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma}')\\mathbf{I}$.\nThe trace is invariant under an orthogonal similarity transformation: $\\mathrm{tr}\\,\\boldsymbol{\\sigma}' = \\mathrm{tr}(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\mathrm{tr}(\\boldsymbol{\\sigma})$.\nThus, we can write $\\boldsymbol{s}'$ as:\n$$\n\\boldsymbol{s}' = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}\n$$\nSince the identity tensor $\\mathbf{I}$ is isotropic, $\\mathbf{I} = \\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}$. Substituting this gives:\n$$\n\\boldsymbol{s}' = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\left(\\boldsymbol{\\sigma} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}\\right)\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\boldsymbol{s}\\mathbf{Q}^{\\mathsf{T}}\n$$\nThis shows that the deviatoric stress tensor $\\boldsymbol{s}$ transforms according to the same rule as the stress tensor $\\boldsymbol{\\sigma}$.\nThe second invariant $J_2$ in the rotated frame is $J'_2 = \\frac{1}{2}\\boldsymbol{s}':\\boldsymbol{s}'$. The double dot product is defined as $\\mathbf{A}:\\mathbf{B} = \\mathrm{tr}(\\mathbf{A}^{\\mathsf{T}}\\mathbf{B})$. For symmetric tensors $\\boldsymbol{s}'$:\n$$\nJ'_2 = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}'\\boldsymbol{s}') = \\frac{1}{2}\\mathrm{tr}\\left((\\mathbf{Q}\\boldsymbol{s}\\mathbf{Q}^{\\mathsf{T}})(\\mathbf{Q}\\boldsymbol{s}\\mathbf{Q}^{\\mathsf{T}})\\right) = \\frac{1}{2}\\mathrm{tr}(\\mathbf{Q}\\boldsymbol{s}^2\\mathbf{Q}^{\\mathsf{T}})\n$$\nUsing the cyclic property of the trace:\n$$\nJ'_2 = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}^2\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}) = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}^2\\mathbf{I}) = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}^2) = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s} = J_2\n$$\nThis confirms that $J_2$ is a rotational invariant. Its value is independent of the coordinate system orientation, and therefore independent of $\\theta$.\n\nTo find its expression in terms of the given stress components, we can calculate it in the original, un-rotated basis $\\{\\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z\\}$.\nFirst, we find the trace of $\\boldsymbol{\\sigma}$:\n$$\n\\mathrm{tr}\\,\\boldsymbol{\\sigma} = \\sigma_x + \\sigma_y + 0 = \\sigma_x + \\sigma_y\n$$\nNext, we construct the deviatoric stress tensor $\\boldsymbol{s}$:\n$$\n\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}(\\sigma_x+\\sigma_y)\\mathbf{I} = \\begin{pmatrix} \\sigma_x & \\tau_{xy} & 0 \\\\ \\tau_{xy} & \\sigma_y & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\frac{\\sigma_x+\\sigma_y}{3}\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{s} = \\begin{pmatrix} \\sigma_x - \\frac{\\sigma_x+\\sigma_y}{3} & \\tau_{xy} & 0 \\\\ \\tau_{xy} & \\sigma_y - \\frac{\\sigma_x+\\sigma_y}{3} & 0 \\\\ 0 & 0 & -\\frac{\\sigma_x+\\sigma_y}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2\\sigma_x-\\sigma_y}{3} & \\tau_{xy} & 0 \\\\ \\tau_{xy} & \\frac{2\\sigma_y-\\sigma_x}{3} & 0 \\\\ 0 & 0 & -\\frac{\\sigma_x+\\sigma_y}{3} \\end{pmatrix}\n$$\nThe invariant $J_2$ is computed from the sum of squares of the components of $\\boldsymbol{s}$: $J_2 = \\frac{1}{2}s_{ij}s_{ij} = \\frac{1}{2}(s_{xx}^2 + s_{yy}^2 + s_{zz}^2 + 2s_{xy}^2)$.\n$$\ns_{xx}^2 = \\left(\\frac{2\\sigma_x-\\sigma_y}{3}\\right)^2 = \\frac{1}{9}(4\\sigma_x^2 - 4\\sigma_x\\sigma_y + \\sigma_y^2)\n$$\n$$\ns_{yy}^2 = \\left(\\frac{2\\sigma_y-\\sigma_x}{3}\\right)^2 = \\frac{1}{9}(4\\sigma_y^2 - 4\\sigma_x\\sigma_y + \\sigma_x^2)\n$$\n$$\ns_{zz}^2 = \\left(-\\frac{\\sigma_x+\\sigma_y}{3}\\right)^2 = \\frac{1}{9}(\\sigma_x^2 + 2\\sigma_x\\sigma_y + \\sigma_y^2)\n$$\n$$\n2s_{xy}^2 = 2\\tau_{xy}^2\n$$\nSumming the diagonal component squares:\n$$\ns_{xx}^2 + s_{yy}^2 + s_{zz}^2 = \\frac{1}{9}\\left[ (4\\sigma_x^2 + \\sigma_x^2 + \\sigma_x^2) + (\\sigma_y^2 + 4\\sigma_y^2 + \\sigma_y^2) + (-4\\sigma_x\\sigma_y - 4\\sigma_x\\sigma_y + 2\\sigma_x\\sigma_y) \\right]\n$$\n$$\n= \\frac{1}{9}\\left[ 6\\sigma_x^2 + 6\\sigma_y^2 - 6\\sigma_x\\sigma_y \\right] = \\frac{2}{3}(\\sigma_x^2 + \\sigma_y^2 - \\sigma_x\\sigma_y)\n$$\nFinally, we assemble the expression for $J_2$:\n$$\nJ_2 = \\frac{1}{2} \\left[ \\frac{2}{3}(\\sigma_x^2 + \\sigma_y^2 - \\sigma_x\\sigma_y) + 2\\tau_{xy}^2 \\right] = \\frac{1}{3}(\\sigma_x^2 + \\sigma_y^2 - \\sigma_x\\sigma_y) + \\tau_{xy}^2\n$$\nThis is the required closed-form expression for the second invariant of the deviatoric stress.", "answer": "$$\\boxed{\\frac{1}{3}(\\sigma_x^{2} + \\sigma_y^{2} - \\sigma_x\\sigma_y) + \\tau_{xy}^{2}}$$", "id": "2922615"}, {"introduction": "Building upon the concept of invariance, we now ask: how are these special quantities used in practice? Physical laws for isotropic materials must be independent of the observer's coordinate system, which means they can only depend on the invariants of state tensors like stress or strain. This exercise allows you to apply this powerful idea, known as the representation theorem, by calculating the principal invariants of a stress tensor and using them to predict a material's response [@problem_id:2699547]. It provides a clear, quantitative link between abstract mathematical invariants and concrete constitutive modeling.", "problem": "Consider a planar stress state at a point in a homogeneous solid, represented in a fixed Cartesian basis by the symmetric second-order tensor $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{2\\times 2}$ given by\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix} 30 & 12 \\\\ 12 & 50 \\end{pmatrix}\\ \\text{(entries in megapascal (MPa))}.\n$$\nA scalar response $f(\\boldsymbol{\\sigma})$ is called isotropic if it is invariant under any proper orthogonal change of basis, that is, $f(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}})=f(\\boldsymbol{\\sigma})$ for every $\\mathbf{Q}$ in the Special Orthogonal group (SO(2)). By the representation theorem for isotropic tensor functions in two dimensions, any isotropic scalar function of $\\boldsymbol{\\sigma}$ depends only on a complete set of scalar invariants of $\\boldsymbol{\\sigma}$. Using only this invariance principle and the invariance of the characteristic polynomial under proper orthogonal transformations, first derive expressions for the first two independent invariants $I_{1}$ and $I_{2}$ of a general $2\\times 2$ symmetric tensor in terms of $\\boldsymbol{\\sigma}$, and then evaluate them for the above $\\boldsymbol{\\sigma}$. \n\nNext, consider the isotropic scalar function defined through its two-dimensional invariant representation\n$$\nf(\\boldsymbol{\\sigma}) \\equiv \\Phi\\!\\left(I_{1}(\\boldsymbol{\\sigma}), I_{2}(\\boldsymbol{\\sigma})\\right),\\quad \\Phi(I_{1},I_{2}) = \\alpha\\, I_{1} + \\beta\\, I_{2} + \\gamma\\, I_{1}^{2},\n$$\nwith material constants $\\alpha=1$ (dimensionless), $\\beta=-\\dfrac{1}{339}\\ \\text{MPa}^{-1}$, and $\\gamma=-\\dfrac{1}{6400}\\ \\text{MPa}^{-1}$. Evaluate $f(\\boldsymbol{\\sigma})$ for the given $\\boldsymbol{\\sigma}$. Express the final value of $f$ in MPa. No rounding is required.", "solution": "The problem as stated is subjected to validation.\n\nGivens extracted verbatim from the problem statement:\n- A planar stress state is represented by the symmetric second-order tensor $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{2\\times 2}$ given by $\\boldsymbol{\\sigma}=\\begin{pmatrix} 30 & 12 \\\\ 12 & 50 \\end{pmatrix}$ in MPa.\n- An isotropic scalar response $f(\\boldsymbol{\\sigma})$ satisfies $f(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}})=f(\\boldsymbol{\\sigma})$ for every $\\mathbf{Q} \\in \\text{SO}(2)$.\n- The representation theorem states that any isotropic scalar function of $\\boldsymbol{\\sigma}$ depends only on a complete set of scalar invariants of $\\boldsymbol{\\sigma}$.\n- The task is to first derive expressions for the first two independent invariants $I_{1}$ and $I_{2}$ of a general $2\\times 2$ symmetric tensor using the invariance of the characteristic polynomial, then evaluate them for the given $\\boldsymbol{\\sigma}$.\n- The task is to then evaluate the specific isotropic scalar function $f(\\boldsymbol{\\sigma}) \\equiv \\Phi(I_{1}(\\boldsymbol{\\sigma}), I_{2}(\\boldsymbol{\\sigma}))$ where $\\Phi(I_{1},I_{2}) = \\alpha\\, I_{1} + \\beta\\, I_{2} + \\gamma\\, I_{1}^{2}$.\n- The constants are given as $\\alpha=1$ (dimensionless), $\\beta=-\\frac{1}{339}\\ \\text{MPa}^{-1}$, and $\\gamma=-\\frac{1}{6400}\\ \\text{MPa}^{-1}$.\n- The final value of $f$ must be expressed in MPa.\n\nValidation verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental principles of linear algebra and continuum mechanics, specifically the representation theory of isotropic tensor functions. All required data and definitions are provided, and there are no internal contradictions or ambiguities. The problem is a standard exercise in the application of tensor analysis to mechanics. Therefore, the problem is deemed valid and a solution will be provided.\n\nThe solution proceeds in three parts as requested. First, the derivation of the scalar invariants. Second, their evaluation for the given stress tensor. Third, the evaluation of the specified function $f(\\boldsymbol{\\sigma})$.\n\nPart 1: Derivation of Scalar Invariants\nLet $\\boldsymbol{\\sigma}$ be a general symmetric second-order tensor in two dimensions, with components in a given Cartesian basis:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{12} & \\sigma_{22} \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $\\boldsymbol{\\sigma}$ are the roots of the characteristic equation $\\det(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the $2 \\times 2$ identity tensor. The characteristic polynomial $P(\\lambda)$ is given by:\n$$\nP(\\lambda) = \\det \\begin{pmatrix} \\sigma_{11} - \\lambda & \\sigma_{12} \\\\ \\sigma_{12} & \\sigma_{22} - \\lambda \\end{pmatrix}\n$$\nExpanding the determinant gives:\n$$\nP(\\lambda) = (\\sigma_{11} - \\lambda)(\\sigma_{22} - \\lambda) - \\sigma_{12}^2 = \\lambda^2 - (\\sigma_{11} + \\sigma_{22})\\lambda + (\\sigma_{11}\\sigma_{22} - \\sigma_{12}^2)\n$$\nThe problem states that any isotropic scalar function is invariant under a proper orthogonal change of basis. The eigenvalues of a tensor are such invariant quantities. Consequently, the characteristic polynomial, whose roots are the eigenvalues, must also be invariant. This implies that the coefficients of the polynomial must themselves be scalar invariants of the tensor $\\boldsymbol{\\sigma}$.\nWe define the principal invariants of the $2 \\times 2$ tensor $\\boldsymbol{\\sigma}$ from the coefficients of its characteristic polynomial $P(\\lambda) = \\lambda^2 - I_1(\\boldsymbol{\\sigma})\\lambda + I_2(\\boldsymbol{\\sigma})$:\nThe first invariant, $I_1(\\boldsymbol{\\sigma})$, is the coefficient of the linear term in $\\lambda$:\n$$\nI_1(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} = \\text{tr}(\\boldsymbol{\\sigma})\n$$\nThe second invariant, $I_2(\\boldsymbol{\\sigma})$, is the constant term:\n$$\nI_2(\\boldsymbol{\\sigma}) = \\sigma_{11}\\sigma_{22} - \\sigma_{12}^2 = \\det(\\boldsymbol{\\sigma})\n$$\nThese are the two independent scalar invariants for a second-order tensor in two dimensions.\n\nPart 2: Evaluation of Invariants for the Given $\\boldsymbol{\\sigma}$\nThe given stress tensor is:\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix} 30 & 12 \\\\ 12 & 50 \\end{pmatrix}\\ \\text{MPa}\n$$\nWe evaluate the two invariants using the expressions derived above. The components are $\\sigma_{11} = 30\\ \\text{MPa}$, $\\sigma_{22} = 50\\ \\text{MPa}$, and $\\sigma_{12} = 12\\ \\text{MPa}$.\n\nThe first invariant is the trace of $\\boldsymbol{\\sigma}$:\n$$\nI_1(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} = 30\\ \\text{MPa} + 50\\ \\text{MPa} = 80\\ \\text{MPa}\n$$\nThe second invariant is the determinant of $\\boldsymbol{\\sigma}$:\n$$\nI_2(\\boldsymbol{\\sigma}) = \\sigma_{11}\\sigma_{22} - \\sigma_{12}^2 = (30\\ \\text{MPa})(50\\ \\text{MPa}) - (12\\ \\text{MPa})^2 = 1500\\ \\text{MPa}^2 - 144\\ \\text{MPa}^2 = 1356\\ \\text{MPa}^2\n$$\n\nPart 3: Evaluation of the Isotropic Scalar Function $f(\\boldsymbol{\\sigma})$\nThe isotropic scalar function is given by $f(\\boldsymbol{\\sigma}) = \\Phi(I_1(\\boldsymbol{\\sigma}), I_2(\\boldsymbol{\\sigma}))$, where:\n$$\n\\Phi(I_{1},I_{2}) = \\alpha\\, I_{1} + \\beta\\, I_{2} + \\gamma\\, I_{1}^{2}\n$$\nThe provided constants are $\\alpha=1$, $\\beta=-\\frac{1}{339}\\ \\text{MPa}^{-1}$, and $\\gamma=-\\frac{1}{6400}\\ \\text{MPa}^{-1}$. We substitute the evaluated invariants and constants into this expression.\n\nLet us analyze the units for each term to ensure correctness.\nThe first term: $\\alpha I_1$. Units: (dimensionless) $\\times$ (MPa) = MPa.\nThe second term: $\\beta I_2$. Units: ($\\text{MPa}^{-1}$) $\\times$ ($\\text{MPa}^2$) = MPa.\nThe third term: $\\gamma I_1^2$. Units: ($\\text{MPa}^{-1}$) $\\times$ ($\\text{MPa}$)$^2$ = MPa.\nAll terms have units of MPa, as required for the final result.\n\nNow, we perform the numerical calculation:\n$$\nf(\\boldsymbol{\\sigma}) = (1)(80\\ \\text{MPa}) + \\left(-\\frac{1}{339}\\ \\text{MPa}^{-1}\\right)(1356\\ \\text{MPa}^2) + \\left(-\\frac{1}{6400}\\ \\text{MPa}^{-1}\\right)(80\\ \\text{MPa})^2\n$$\n$$\nf(\\boldsymbol{\\sigma}) = 80\\ \\text{MPa} - \\frac{1356}{339}\\ \\text{MPa} - \\frac{80^2}{6400}\\ \\text{MPa}\n$$\nWe simplify the fractions:\n$$\n\\frac{1356}{339} = 4\n$$\n$$\n\\frac{80^2}{6400} = \\frac{6400}{6400} = 1\n$$\nSubstituting these values back into the expression for $f(\\boldsymbol{\\sigma})$:\n$$\nf(\\boldsymbol{\\sigma}) = 80\\ \\text{MPa} - 4\\ \\text{MPa} - 1\\ \\text{MPa} = 75\\ \\text{MPa}\n$$\nThe final value of the isotropic scalar function $f(\\boldsymbol{\\sigma})$ is $75\\ \\text{MPa}$.", "answer": "$$\n\\boxed{75}\n$$", "id": "2699547"}, {"introduction": "The principles of tensor transformation and invariance culminate in a core axiom of continuum mechanics: the principle of material frame-indifference, or objectivity. This principle demands that a material's constitutive law must be independent of any rigid-body motion of the observer, ensuring that physical predictions are objective. This problem challenges you to implement a numerical patch test to verify this axiom for a hyperelastic material model, confirming that the stress tensor transforms correctly under a superposed rotation [@problem_id:2922635]. This practice bridges the gap between abstract theory and the practical validation required in computational mechanics, demonstrating how to ensure a model's physical admissibility.", "problem": "Construct and implement a numerical patch test for frame-indifference (also called objectivity) of the Cauchy stress in a hyperelastic material model by superposing a rigid-body motion on a homogeneous deformation, and verify that the computed stress transforms by rotation while its scalar invariants remain unchanged.\n\nYou must base your derivations on the following fundamental definitions and well-tested formulas. A rigid-body superposed motion is defined by a proper orthogonal rotation tensor $\\mathbf{Q} \\in \\mathrm{SO}(3)$ with $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}=\\mathbf{I}$ and $\\det \\mathbf{Q}=1$, and an arbitrary translation vector $\\mathbf{c}$, acting on a placement $\\mathbf{x}$ as $\\mathbf{x}^{\\prime}=\\mathbf{Q}\\mathbf{x}+\\mathbf{c}$. For a homogeneous deformation with deformation gradient $\\mathbf{F}$, the superposed rigid rotation sends $\\mathbf{F}$ to $\\mathbf{F}^{\\prime}=\\mathbf{Q}\\mathbf{F}$, while the translation $\\mathbf{c}$ does not affect any gradient and thus does not affect stress. Consider the compressible neo-Hookean material with shear modulus $\\mu$ and bulk modulus $\\kappa$, where the Cauchy stress $\\boldsymbol{\\sigma}$ is given by\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F})=\\frac{\\mu}{J}\\left(\\mathbf{b}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I},\n$$\nwith $J=\\det \\mathbf{F}$ and $\\mathbf{b}=\\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$. All angles used must be in radians.\n\nYour program must:\n- For each specified test case below, compute $\\boldsymbol{\\sigma}(\\mathbf{F})$ and $\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})$ with $\\mathbf{F}^{\\prime}=\\mathbf{Q}\\mathbf{F}$.\n- Verify the rotational covariance of stress, namely that\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) \\stackrel{?}{=} \\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}.\n$$\n- Verify the invariance of the principal invariants of the Cauchy stress under rotation. Define the first, second, and third principal invariants of a second-order tensor $\\mathbf{A}$ as\n$$\nI_{1}(\\mathbf{A})=\\operatorname{tr}(\\mathbf{A}),\\quad\nI_{2}(\\mathbf{A})=\\tfrac{1}{2}\\big(\\operatorname{tr}(\\mathbf{A})^{2}-\\operatorname{tr}(\\mathbf{A}^{2})\\big),\\quad\nI_{3}(\\mathbf{A})=\\det(\\mathbf{A}).\n$$\nCheck that $I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F})\\big)$ and $I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\big)$ agree for $k\\in\\{1,2,3\\}$ up to numerical tolerance.\n\nUse the following rotation parameterizations. Let\n$$\n\\mathbf{R}_{x}(\\alpha)=\n\\begin{bmatrix}\n1 & 0 & 0\\\\\n0 & \\cos\\alpha & -\\sin\\alpha\\\\\n0 & \\sin\\alpha & \\cos\\alpha\n\\end{bmatrix},\\quad\n\\mathbf{R}_{y}(\\beta)=\n\\begin{bmatrix}\n\\cos\\beta & 0 & \\sin\\beta\\\\\n0 & 1 & 0\\\\\n-\\sin\\beta & 0 & \\cos\\beta\n\\end{bmatrix},\\quad\n\\mathbf{R}_{z}(\\gamma)=\n\\begin{bmatrix}\n\\cos\\gamma & -\\sin\\gamma & 0\\\\\n\\sin\\gamma & \\cos\\gamma & 0\\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\n\nTest suite (angles are in radians; all matrices are dimensionless; the translation vector is irrelevant to gradients and may be ignored):\n- Case $1$:\n  - $\\mu=12.0$, $\\kappa=120.0$,\n  - $\\mathbf{F}=\\begin{bmatrix}1.2 & 0.3 & 0.0\\\\ 0.1 & 0.9 & 0.2\\\\ 0.0 & -0.1 & 1.1\\end{bmatrix}$,\n  - $\\mathbf{Q}=\\mathbf{R}_{z}(0.7)$.\n- Case $2$:\n  - $\\mu=5.0$, $\\kappa=250.0$,\n  - $\\mathbf{F}=\\begin{bmatrix}1.0 & 0.5 & 0.0\\\\ 0.0 & 1.0 & 0.0\\\\ 0.0 & 0.0 & 1.0\\end{bmatrix}$,\n  - $\\mathbf{Q}=\\mathbf{R}_{z}(1.1)\\,\\mathbf{R}_{y}(-0.4)\\,\\mathbf{R}_{x}(0.3)$.\n- Case $3$:\n  - $\\mu=50.0$, $\\kappa=1500.0$,\n  - $\\mathbf{F}=\\begin{bmatrix}0.95 & 0.05 & 0.0\\\\ 0.0 & 1.10 & 0.02\\\\ 0.0 & -0.01 & 1.00\\end{bmatrix}$,\n  - $\\mathbf{Q}=\\mathbf{R}_{y}(0.6)$.\n- Case $4$:\n  - $\\mu=40.0$, $\\kappa=200.0$,\n  - $\\mathbf{F}=\\mathbf{R}_{x}(1.2)$,\n  - $\\mathbf{Q}=\\mathbf{R}_{y}(0.8)$.\n- Case $5$:\n  - $\\mu=30.0$, $\\kappa=90.0$,\n  - $\\mathbf{F}=\\begin{bmatrix}0.8 & 0.25 & 0.0\\\\ -0.15 & 1.05 & 0.1\\\\ 0.0 & -0.05 & 1.2\\end{bmatrix}$,\n  - $\\mathbf{Q}=\\mathbf{R}_{z}(-0.9)\\,\\mathbf{R}_{x}(0.4)$.\n\nNumerical verification criteria:\n- Define the Frobenius norm error for rotational covariance as\n$$\ne_{\\mathrm{cov}}=\\frac{\\left\\|\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})-\\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}\\right\\|_{F}}{1+\\left\\|\\boldsymbol{\\sigma}(\\mathbf{F})\\right\\|_{F}+\\left\\|\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\right\\|_{F}}.\n$$\n- Define the invariant errors for $k\\in\\{1,2,3\\}$ as\n$$\ne_{I_{k}}=\\frac{\\left|I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\big)-I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F})\\big)\\right|}{1+\\left|I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F})\\big)\\right|+\\left|I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\big)\\right|}.\n$$\n- Use a scalar tolerance $\\varepsilon=10^{-10}$. A case passes if $e_{\\mathrm{cov}}\\le \\varepsilon$ and $e_{I_{k}}\\le \\varepsilon$ for all $k\\in\\{1,2,3\\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the pass or fail results for all five cases, as a comma-separated Python-style list of booleans enclosed in square brackets, for example $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{False}]$.", "solution": "The problem requires the construction and implementation of a numerical patch test to verify the principle of material frame-indifference, also known as objectivity, for a given compressible neo-Hookean hyperelastic material model. This principle is a fundamental axiom in continuum mechanics, stating that the constitutive equations describing a material's behavior must be independent of the observer's frame of reference.\n\nA change in the observer's frame of reference is represented by a time-dependent rigid-body motion. When superposed on a deformed configuration described by the placement field $\\mathbf{x}(\\mathbf{X}, t)$, the new placement is given by $\\mathbf{x}^{\\prime}(\\mathbf{X}, t) = \\mathbf{Q}(t)\\mathbf{x}(\\mathbf{X}, t) + \\mathbf{c}(t)$, where $\\mathbf{Q}(t)$ is a proper orthogonal rotation tensor (i.e., $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}=\\mathbf{I}$ and $\\det\\mathbf{Q}=1$) and $\\mathbf{c}(t)$ is a translation vector.\n\nThe deformation gradient, which is the gradient of the placement field with respect to the reference configuration coordinates $\\mathbf{X}$, transforms under this superposed motion. Since the translation $\\mathbf{c}$ is spatially constant, it does not affect the gradient. The transformation rule for the deformation gradient $\\mathbf{F}$ is:\n$$\n\\mathbf{F}^{\\prime} = \\frac{\\partial \\mathbf{x}^{\\prime}}{\\partial \\mathbf{X}} = \\mathbf{Q} \\frac{\\partial \\mathbf{x}}{\\partial \\mathbf{X}} = \\mathbf{Q}\\mathbf{F}\n$$\nThe principle of frame-indifference demands that the Cauchy stress tensor $\\boldsymbol{\\sigma}$, which is a physical quantity measured in the current configuration, must transform as an objective second-order tensor. This means its components in the new (rotated) frame are related to its components in the old frame via the rotation tensor $\\mathbf{Q}$:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}\n$$\nWe must now verify if the given compressible neo-Hookean stress-strain relationship satisfies this requirement. The constitutive equation for the Cauchy stress $\\boldsymbol{\\sigma}$ is given as:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F})=\\frac{\\mu}{J}\\left(\\mathbf{b}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I}\n$$\nwhere $\\mu$ is the shear modulus, $\\kappa$ is the bulk modulus, $\\mathbf{I}$ is the second-order identity tensor, $J = \\det \\mathbf{F}$ is the volumetric part of the deformation, and $\\mathbf{b} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$ is the left Cauchy-Green deformation tensor.\n\nLet us analyze how the terms in this equation transform under $\\mathbf{F} \\to \\mathbf{F}^{\\prime} = \\mathbf{Q}\\mathbf{F}$.\nFirst, we examine the transformation of the determinant $J$:\n$$\nJ^{\\prime} = \\det(\\mathbf{F}^{\\prime}) = \\det(\\mathbf{Q}\\mathbf{F}) = (\\det\\mathbf{Q})(\\det\\mathbf{F})\n$$\nSince $\\mathbf{Q}$ is a proper rotation, $\\det\\mathbf{Q} = 1$. Therefore, $J^{\\prime} = J$. The determinant of the deformation gradient is invariant under superposed rigid rotations.\n\nNext, we examine the transformation of the left Cauchy-Green tensor $\\mathbf{b}$:\n$$\n\\mathbf{b}^{\\prime} = \\mathbf{F}^{\\prime}(\\mathbf{F}^{\\prime})^{\\mathsf{T}} = (\\mathbf{Q}\\mathbf{F})(\\mathbf{Q}\\mathbf{F})^{\\mathsf{T}} = (\\mathbf{Q}\\mathbf{F})(\\mathbf{F}^{\\mathsf{T}}\\mathbf{Q}^{\\mathsf{T}}) = \\mathbf{Q}(\\mathbf{F}\\mathbf{F}^{\\mathsf{T}})\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}\n$$\nNow, we can write the expression for the stress in the new frame, $\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})$:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\frac{\\mu}{J^{\\prime}}\\left(\\mathbf{b}^{\\prime}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J^{\\prime}}{J^{\\prime}}\\,\\mathbf{I}\n$$\nSubstituting the transformed quantities $J^{\\prime}=J$ and $\\mathbf{b}^{\\prime}=\\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}$:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\frac{\\mu}{J}\\left(\\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I}\n$$\nUsing the property that the identity tensor $\\mathbf{I}$ is isotropic, i.e., $\\mathbf{I} = \\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}$, we can rewrite the equation as:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\frac{\\mu}{J}\\left(\\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}-\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}\n$$\nBy factoring out $\\mathbf{Q}$ on the left and $\\mathbf{Q}^{\\mathsf{T}}$ on the right, we obtain:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\mathbf{Q} \\left[ \\frac{\\mu}{J}\\left(\\mathbf{b}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I} \\right] \\mathbf{Q}^{\\mathsf{T}}\n$$\nThe expression in the brackets is precisely the original stress tensor $\\boldsymbol{\\sigma}(\\mathbf{F})$. Therefore, we have demonstrated that:\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}\n$$\nThis analytical result confirms that the compressible neo-Hookean material model is frame-indifferent.\n\nThe second part of the problem is to verify the invariance of the principal scalar invariants of the Cauchy stress tensor. The principal invariants of a tensor are scalar quantities that are independent of the coordinate system used to represent the tensor. For a second-order tensor $\\mathbf{A}$, the transformation $\\mathbf{A}^{\\prime} = \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^{\\mathsf{T}}$ corresponds to a change of basis. The invariants must remain unchanged under such a transformation.\nThe three principal invariants are given by:\n$$\nI_{1}(\\mathbf{A})=\\operatorname{tr}(\\mathbf{A}),\\quad\nI_{2}(\\mathbf{A})=\\tfrac{1}{2}\\big(\\operatorname{tr}(\\mathbf{A})^{2}-\\operatorname{tr}(\\mathbf{A}^{2})\\big),\\quad\nI_{3}(\\mathbf{A})=\\det(\\mathbf{A}).\n$$\nLet's verify their invariance for $\\boldsymbol{\\sigma}^{\\prime} = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}$.\n- First invariant: Using the cyclic property of the trace, $\\operatorname{tr}(\\mathbf{ABC}) = \\operatorname{tr}(\\mathbf{BCA})$.\n$$\nI_{1}(\\boldsymbol{\\sigma}^{\\prime}) = \\operatorname{tr}(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}) = \\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{I}) = \\operatorname{tr}(\\boldsymbol{\\sigma}) = I_{1}(\\boldsymbol{\\sigma})\n$$\n- Third invariant: Using the property $\\det(\\mathbf{ABC}) = \\det(\\mathbf{A})\\det(\\mathbf{B})\\det(\\mathbf{C})$.\n$$\nI_{3}(\\boldsymbol{\\sigma}^{\\prime}) = \\det(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\det(\\mathbf{Q})\\det(\\boldsymbol{\\sigma})\\det(\\mathbf{Q}^{\\mathsf{T}}) = (1)\\det(\\boldsymbol{\\sigma})(1) = \\det(\\boldsymbol{\\sigma}) = I_{3}(\\boldsymbol{\\sigma})\n$$\n- Second invariant: We first need to evaluate $\\operatorname{tr}((\\boldsymbol{\\sigma}^{\\prime})^2)$.\n$$\n(\\boldsymbol{\\sigma}^{\\prime})^2 = (\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}})(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\mathbf{Q}\\boldsymbol{\\sigma}(\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q})\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{I}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\boldsymbol{\\sigma}^2\\mathbf{Q}^{\\mathsf{T}}\n$$\nThen, $\\operatorname{tr}((\\boldsymbol{\\sigma}^{\\prime})^2) = \\operatorname{tr}(\\mathbf{Q}\\boldsymbol{\\sigma}^2\\mathbf{Q}^{\\mathsf{T}}) = \\operatorname{tr}(\\boldsymbol{\\sigma}^2\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}) = \\operatorname{tr}(\\boldsymbol{\\sigma}^2)$.\nSince $I_{1}(\\boldsymbol{\\sigma}^{\\prime}) = I_{1}(\\boldsymbol{\\sigma})$ and $\\operatorname{tr}((\\boldsymbol{\\sigma}^{\\prime})^2) = \\operatorname{tr}(\\boldsymbol{\\sigma}^2)$, it follows directly from the definition that $I_{2}(\\boldsymbol{\\sigma}^{\\prime}) = I_{2}(\\boldsymbol{\\sigma})$.\n\nThe numerical implementation will proceed by calculating these quantities for each test case and comparing them using the provided error metrics and tolerance.\nFor each test case $(\\mu, \\kappa, \\mathbf{F}, \\mathbf{Q})$:\n1.  Compute $\\boldsymbol{\\sigma}_{orig} = \\boldsymbol{\\sigma}(\\mathbf{F})$.\n2.  Compute $\\mathbf{F}^{\\prime} = \\mathbf{Q}\\mathbf{F}$.\n3.  Compute $\\boldsymbol{\\sigma}_{trans} = \\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})$.\n4.  Compute the expected transformed stress $\\boldsymbol{\\sigma}_{exp} = \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{orig}\\,\\mathbf{Q}^{\\mathsf{T}}$.\n5.  Evaluate the covariance error $e_{\\mathrm{cov}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{trans}-\\boldsymbol{\\sigma}_{exp}\\right\\|_{F}}{1+\\left\\|\\boldsymbol{\\sigma}_{orig}\\right\\|_{F}+\\left\\|\\boldsymbol{\\sigma}_{trans}\\right\\|_{F}}$.\n6.  Compute the invariants $I_k(\\boldsymbol{\\sigma}_{orig})$ and $I_k(\\boldsymbol{\\sigma}_{trans})$ for $k \\in \\{1, 2, 3\\}$.\n7.  Evaluate the invariant errors $e_{I_{k}} = \\frac{|I_{k}(\\boldsymbol{\\sigma}_{trans}) - I_{k}(\\boldsymbol{\\sigma}_{orig})|}{1+|I_{k}(\\boldsymbol{\\sigma}_{orig})|+|I_{k}(\\boldsymbol{\\sigma}_{trans})|}$.\n8.  A test case passes if $e_{\\mathrm{cov}} \\le 10^{-10}$ and $e_{I_k} \\le 10^{-10}$ for all $k$.\nThe final output will be a list of booleans indicating the pass/fail status for each case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a numerical patch test for frame-indifference of Cauchy stress\n    in a compressible neo-Hookean material model.\n    \"\"\"\n    TOLERANCE = 1e-10\n\n    test_cases = [\n        {\n            \"mu\": 12.0, \"kappa\": 120.0,\n            \"F\": np.array([[1.2, 0.3, 0.0], [0.1, 0.9, 0.2], [0.0, -0.1, 1.1]]),\n            \"Q_params\": {\"z\": 0.7}\n        },\n        {\n            \"mu\": 5.0, \"kappa\": 250.0,\n            \"F\": np.array([[1.0, 0.5, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n            \"Q_params\": {\"z\": 1.1, \"y\": -0.4, \"x\": 0.3}\n        },\n        {\n            \"mu\": 50.0, \"kappa\": 1500.0,\n            \"F\": np.array([[0.95, 0.05, 0.0], [0.0, 1.10, 0.02], [0.0, -0.01, 1.00]]),\n            \"Q_params\": {\"y\": 0.6}\n        },\n        {\n            \"mu\": 40.0, \"kappa\": 200.0,\n            \"F\": _build_rotation_matrix(x=1.2),\n            \"Q_params\": {\"y\": 0.8}\n        },\n        {\n            \"mu\": 30.0, \"kappa\": 90.0,\n            \"F\": np.array([[0.8, 0.25, 0.0], [-0.15, 1.05, 0.1], [0.0, -0.05, 1.2]]),\n            \"Q_params\": {\"z\": -0.9, \"x\": 0.4}\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        mu = case[\"mu\"]\n        kappa = case[\"kappa\"]\n        F = case[\"F\"]\n        Q = _build_rotation_matrix(**case[\"Q_params\"])\n\n        # Compute stresses\n        sigma_orig = _compute_cauchy_stress(F, mu, kappa)\n        F_prime = Q @ F\n        sigma_trans = _compute_cauchy_stress(F_prime, mu, kappa)\n\n        # Check rotational covariance\n        sigma_exp = Q @ sigma_orig @ Q.T\n        \n        # Calculate covariance error\n        cov_num = np.linalg.norm(sigma_trans - sigma_exp, 'fro')\n        cov_den = 1.0 + np.linalg.norm(sigma_orig, 'fro') + np.linalg.norm(sigma_trans, 'fro')\n        e_cov = cov_num / cov_den\n        \n        # Check invariance of principal invariants\n        I_orig = _compute_invariants(sigma_orig)\n        I_trans = _compute_invariants(sigma_trans)\n        \n        e_I = []\n        for k in range(3):\n            inv_num = abs(I_trans[k] - I_orig[k])\n            inv_den = 1.0 + abs(I_orig[k]) + abs(I_trans[k])\n            e_I.append(inv_num / inv_den)\n\n        # Verify against tolerance\n        passed = e_cov <= TOLERANCE and all(err <= TOLERANCE for err in e_I)\n        results.append(passed)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _build_rotation_matrix(x=0.0, y=0.0, z=0.0):\n    \"\"\"\n    Constructs a 3D rotation matrix from Euler angles (Z-Y-X convention).\n    The input Q_params order of keys does not matter, the composition order is fixed.\n    For Case 2: Q = Rz Ry Rx\n    For Case 5: Q = Rz Rx\n    \"\"\"\n    c_x, s_x = np.cos(x), np.sin(x)\n    c_y, s_y = np.cos(y), np.sin(y)\n    c_z, s_z = np.cos(z), np.sin(z)\n\n    Rx = np.array([[1, 0, 0], [0, c_x, -s_x], [0, s_x, c_x]])\n    Ry = np.array([[c_y, 0, s_y], [0, 1, 0], [-s_y, 0, c_y]])\n    Rz = np.array([[c_z, -s_z, 0], [s_z, c_z, 0], [0, 0, 1]])\n    \n    # Composition order: a vector is first rotated about x, then y, then z.\n    # The composite rotation matrix is Q = Rz * Ry * Rx.\n    return Rz @ Ry @ Rx\n\ndef _compute_cauchy_stress(F, mu, kappa):\n    \"\"\"\n    Computes Cauchy stress for a compressible neo-Hookean material.\n    sigma = (mu/J)*(b - I) + (kappa*ln(J)/J)*I\n    \"\"\"\n    J = np.linalg.det(F)\n    if J <= 0:\n        raise ValueError(\"Deformation gradient must have a positive determinant.\")\n        \n    b = F @ F.T\n    I = np.identity(3)\n    \n    # deviatoric part + volumetric part\n    sigma = (mu / J) * (b - I) + (kappa * np.log(J) / J) * I\n    return sigma\n\ndef _compute_invariants(A):\n    \"\"\"\n    Computes the three principal invariants of a 3x3 matrix A.\n    I1 = tr(A)\n    I2 = 1/2 * (tr(A)^2 - tr(A^2))\n    I3 = det(A)\n    \"\"\"\n    I1 = np.trace(A)\n    I2 = 0.5 * (np.trace(A)**2 - np.trace(A @ A))\n    I3 = np.linalg.det(A)\n    return I1, I2, I3\n\nsolve()\n```", "id": "2922635"}]}