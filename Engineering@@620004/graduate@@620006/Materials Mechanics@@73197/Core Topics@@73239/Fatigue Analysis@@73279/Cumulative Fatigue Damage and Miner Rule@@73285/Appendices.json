{"hands_on_practices": [{"introduction": "Mastering the principles of cumulative fatigue damage begins with the direct application of the Palmgren-Miner linear damage rule. This exercise provides a foundational scenario involving a simple two-level block loading, a common simplification of variable amplitude service histories. By calculating the damage contribution from each block and determining the remaining life, you will solidify your understanding of the core mechanics of linear damage summation, a crucial first step before tackling more complex loading scenarios. [@problem_id:2628832]", "problem": "A metallic specimen made of a high-strength steel is subjected to a two-step block loading under fully reversed stress ratio $R=-1$. The stress-life ($S$–$N$) behavior in the high-cycle regime is characterized by the empirical Basquin-type relation in common logarithmic form\n$$\n\\log_{10} N = a - b \\log_{10} S_a,\n$$\nvalid for stress amplitude $S_a$ expressed in $\\mathrm{MPa}$ and fatigue life $N$ in cycles. For this steel, the constants are $a=12$ and $b=3$. The specimen experiences the following block loading history:\n- First block: $n_1=1.0\\times 10^4$ cycles at stress amplitude $S_{a1}=300\\,\\mathrm{MPa}$.\n- Second block: $n_2=5.0\\times 10^4$ cycles at stress amplitude $S_{a2}=150\\,\\mathrm{MPa}$.\n\nAssuming linear cumulative fatigue damage under constant-amplitude segments and that failure is defined by the attainment of a critical damage value, compute the cumulative damage $D$ after the two blocks. Then, continuing at the second stress amplitude $S_{a2}$, determine the additional number of cycles $\\Delta n$ required to reach the failure criterion. Round both $D$ and $\\Delta n$ to three significant figures. Express the additional cycles in cycles. The final answer must be a single row matrix containing $D$ and $\\Delta n$ in that order.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Material Behavior**: The stress-life ($S$–$N$) relationship is given by the Basquin-type relation: $\\log_{10} N = a - b \\log_{10} S_a$.\n- **Material Constants**: $a=12$, $b=3$.\n- **Units**: Stress amplitude $S_a$ is in $\\mathrm{MPa}$, and fatigue life $N$ is in cycles.\n- **Loading Conditions**: Fully reversed stress ratio, $R=-1$.\n- **Loading History**:\n    - Block 1: $n_1=1.0\\times 10^4$ cycles at a stress amplitude of $S_{a1}=300\\,\\mathrm{MPa}$.\n    - Block 2: $n_2=5.0\\times 10^4$ cycles at a stress amplitude of $S_{a2}=150\\,\\mathrm{MPa}$.\n- **Damage Model**: Linear cumulative fatigue damage is assumed (Palmgren-Miner rule).\n- **Failure Criterion**: Failure occurs when the cumulative damage $D$ reaches a critical value, which is implicitly $1$ for the standard Palmgren-Miner rule.\n- **Required Outputs**:\n    1.  The cumulative damage $D$ after the two loading blocks.\n    2.  The additional number of cycles $\\Delta n$ at stress amplitude $S_{a2}$ required to cause failure.\n- **Formatting**: Both results must be rounded to three significant figures. The final answer must be a row matrix.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing the standard Basquin relation and the Palmgren-Miner rule, which are fundamental concepts in the engineering analysis of metal fatigue. The problem is well-posed, as all necessary data and relationships are provided to calculate a unique solution. The language is objective and precise. The numerical values provided for the material constants and stress levels are physically realistic for a high-strength steel. The problem does not violate any principles of mechanics or mathematics, is not incomplete or contradictory, and is directly formalizable.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived.\n\nThe analysis proceeds based on the Palmgren-Miner linear damage accumulation rule. The cumulative damage, $D$, is the sum of the cycle ratios for each distinct loading condition:\n$$\nD = \\sum_{i} \\frac{n_i}{N_{fi}}\n$$\nwhere $n_i$ is the number of cycles applied at a stress amplitude $S_{ai}$, and $N_{fi}$ is the number of cycles to failure at that same stress amplitude. Failure is predicted to occur when $D=1$.\n\nThe number of cycles to failure, $N_f$, for a given stress amplitude, $S_a$, is determined from the provided Basquin relation:\n$$\n\\log_{10} N_f = a - b \\log_{10} S_a\n$$\nGiven the constants $a=12$ and $b=3$, the equation is:\n$$\n\\log_{10} N_f = 12 - 3 \\log_{10} S_a\n$$\nThis can be expressed in the power-law form:\n$$\nN_f S_a^b = 10^a \\implies N_f = \\frac{10^a}{S_a^b} = \\frac{10^{12}}{S_a^3}\n$$\n\nFirst, we calculate the fatigue life $N_{f1}$ corresponding to the first stress amplitude, $S_{a1} = 300\\,\\mathrm{MPa}$:\n$$\nN_{f1} = \\frac{10^{12}}{(300)^3} = \\frac{10^{12}}{(3 \\times 10^2)^3} = \\frac{10^{12}}{27 \\times 10^6} = \\frac{10^6}{27} \\text{ cycles}\n$$\n$N_{f1} \\approx 37037.037...$ cycles.\n\nNext, we calculate the fatigue life $N_{f2}$ corresponding to the second stress amplitude, $S_{a2} = 150\\,\\mathrm{MPa}$:\n$$\nN_{f2} = \\frac{10^{12}}{(150)^3} = \\frac{10^{12}}{(1.5 \\times 10^2)^3} = \\frac{10^{12}}{3.375 \\times 10^6} = \\frac{10^6}{3.375} = \\frac{8 \\times 10^6}{27} \\text{ cycles}\n$$\n$N_{f2} \\approx 296296.296...$ cycles. Note that $N_{f2} = 8 N_{f1}$, as expected since $S_{a1} = 2 S_{a2}$ and the exponent $b=3$.\n\nNow, we compute the damage incurred during each loading block.\nFor the first block, with $n_1=1.0\\times 10^4$ cycles at $S_{a1}=300\\,\\mathrm{MPa}$:\n$$\nD_1 = \\frac{n_1}{N_{f1}} = \\frac{1.0 \\times 10^4}{10^6 / 27} = \\frac{10^4 \\times 27}{10^6} = \\frac{27}{100} = 0.27\n$$\n\nFor the second block, with $n_2=5.0\\times 10^4$ cycles at $S_{a2}=150\\,\\mathrm{MPa}$:\n$$\nD_2 = \\frac{n_2}{N_{f2}} = \\frac{5.0 \\times 10^4}{8 \\times 10^6 / 27} = \\frac{5 \\times 10^4 \\times 27}{8 \\times 10^6} = \\frac{5 \\times 27}{800} = \\frac{135}{800} = 0.16875\n$$\n\nThe total cumulative damage $D$ after the two blocks is the sum of the individual damage contributions:\n$$\nD = D_1 + D_2 = 0.27 + 0.16875 = 0.43875\n$$\nRounding to three significant figures, the cumulative damage is $D \\approx 0.439$.\n\nAccording to the Palmgren-Miner rule, failure occurs when $D=1$. The remaining damage capacity is:\n$$\nD_{\\text{rem}} = 1 - D = 1 - 0.43875 = 0.56125\n$$\nThe problem asks for the additional number of cycles, $\\Delta n$, at the second stress amplitude, $S_{a2}=150\\,\\mathrm{MPa}$, required to reach failure. This corresponds to consuming the remaining damage capacity $D_{\\text{rem}}$:\n$$\nD_{\\text{rem}} = \\frac{\\Delta n}{N_{f2}}\n$$\nSolving for $\\Delta n$:\n$$\n\\Delta n = D_{\\text{rem}} \\times N_{f2} = 0.56125 \\times \\left(\\frac{8 \\times 10^6}{27}\\right)\n$$\n$$\n\\Delta n = \\frac{4490000}{27} \\approx 166296.296... \\text{ cycles}\n$$\nRounding to three significant figures, the additional number of cycles is $\\Delta n \\approx 1.66 \\times 10^5$ cycles.\n\nThe required outputs are the cumulative damage $D$ and the additional cycles to failure $\\Delta n$, both rounded to three significant figures.\n$D \\approx 0.439$\n$\\Delta n \\approx 1.66 \\times 10^5$ cycles.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.439 & 1.66 \\times 10^5\n\\end{pmatrix}\n}\n$$", "id": "2628832"}, {"introduction": "While the Palmgren-Miner rule is invaluable for its simplicity, it famously neglects the influence of load sequence. This practice explores one of the rule's most significant limitations: its inability to account for the crack growth retardation that often follows a high-load cycle (overload). By contrasting the prediction of Miner's linear rule with a Wheeler-type retardation model, you will quantify the potential error and gain a deeper appreciation for the physical mechanisms, like plasticity-induced crack closure, that govern real-world fatigue behavior. [@problem_id:2875922]", "problem": "A compact tension-like geometry with a single through crack is subjected to a two-block constant-amplitude loading history: a high-amplitude block of $(\\sigma_{H}, n_{H})$ followed immediately by a low-amplitude block of $(\\sigma_{L}, n_{L})$, with stress ratio $R=0$. Assume Mode I conditions with a constant geometry factor $Y$ and that crack growth is governed in the long-crack regime by Paris’ law, a well-tested empirical relation, $da/dN = C \\left(\\Delta K\\right)^{m}$, where $\\Delta K = Y\\,\\sigma\\,\\sqrt{\\pi a}$ for $R=0$ under constant-amplitude nominal stress $\\sigma$.\n\nConsider two life-consumption models applied to this single two-block history:\n1) Miner’s linear cumulative damage rule, which estimates the consumed life fraction after the two blocks as $D_{M} = n_{H}/N(\\sigma_{H}) + n_{L}/N(\\sigma_{L})$, where $N(\\sigma)$ denotes the constant-amplitude life from an initial crack size $a_{0}$ to a final crack size $a_{f}$ at stress amplitude $\\sigma$ predicted by Paris’ law integration (assume $a_{0}$ and $a_{f}$ are the same for both amplitudes).\n2) A Wheeler-type retardation model calibrated by an overload factor in which the crack growth rate during the low-amplitude block is reduced by a multiplicative factor $\\phi$ due to the preceding high-amplitude overload. In the Wheeler formulation, the retardation factor is $\\phi = \\left(r_{p}/r_{p,\\mathrm{OL}}\\right)^{m_{w}}$, where $m_{w}$ is the Wheeler exponent, $r_{p}$ is a representative plastic zone size during the low-amplitude block, and $r_{p,\\mathrm{OL}}$ is the plastic zone size under the high-amplitude overload at the start of the low-amplitude block. Take the small-scale yielding scaling $r_{p} \\propto K_{\\max}^{2}/\\sigma_{y}^{2}$ with $K_{\\max} = Y\\,\\sigma\\,\\sqrt{\\pi a}$ for $R=0$, and assume that during the entire low-amplitude block the crack remains within the overload-affected zone so that a single constant $\\phi$ applies over $n_{L}$ cycles. Under these assumptions, the retardation model’s consumed life fraction is $D_{W} = n_{H}/N(\\sigma_{H}) + \\phi\\,n_{L}/N(\\sigma_{L})$.\n\nDefine the relative error of Miner’s prediction with respect to the retardation model as\n$$\\varepsilon \\equiv \\frac{D_{M} - D_{W}}{D_{W}}.$$\nUsing only the above bases, derive $\\phi$ in terms of the stress “overload factor” $F_{\\mathrm{OL}} \\equiv \\sigma_{H}/\\sigma_{L}$ and $m_{w}$, show how $N(\\sigma)$ scales with $\\sigma$ under Paris’ law, and then compute $\\varepsilon$ for\n$m = 3.0$, $m_{w} = 1.0$, $Y = 1.0$, $n_{H} = 5.0 \\times 10^{3}$, $n_{L} = 2.0 \\times 10^{5}$, $\\sigma_{H} = 300$ MPa, and $\\sigma_{L} = 150$ MPa. You may assume $a_{0} > 0$ and $a_{f} > a_{0}$ are such that Paris’ law is valid throughout, but you must not assume numerical values for $a_{0}$, $a_{f}$, $C$, or $\\sigma_{y}$. Express your final result for $\\varepsilon$ as a decimal, rounded to four significant figures.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Crack Growth Law:** Paris' Law, $\\frac{da}{dN} = C (\\Delta K)^{m}$, governs crack growth in the long-crack regime.\n- **Stress Ratio:** $R=0$.\n- **Stress Intensity Factor Range:** For $R=0$, $\\Delta K = Y\\,\\sigma\\,\\sqrt{\\pi a}$, where $Y$ is a constant geometry factor.\n- **Loading History:** A two-block sequence: $(\\sigma_{H}, n_{H})$ followed by $(\\sigma_{L}, n_{L})$.\n- **Miner's Rule Damage:** $D_{M} = \\frac{n_{H}}{N(\\sigma_{H})} + \\frac{n_{L}}{N(\\sigma_{L})}$.\n- **Fatigue Life:** $N(\\sigma)$ is the life from an initial crack size $a_{0}$ to a final crack size $a_{f}$ under constant amplitude stress $\\sigma$. $a_{0}$ and $a_{f}$ are fixed for all cases.\n- **Wheeler Model Damage:** $D_{W} = \\frac{n_{H}}{N(\\sigma_{H})} + \\phi\\,\\frac{n_{L}}{N(\\sigma_{L})}$.\n- **Retardation Factor:** $\\phi = \\left(\\frac{r_{p}}{r_{p,\\mathrm{OL}}}\\right)^{m_{w}}$, where $m_{w}$ is the Wheeler exponent. $r_{p}$ is the representative plastic zone size during the low-amplitude block, and $r_{p,\\mathrm{OL}}$ is the plastic zone size from the high-amplitude overload at the start of the low-amplitude block. It is assumed $\\phi$ is constant for all $n_{L}$ cycles.\n- **Plastic Zone Size Scaling:** $r_{p} \\propto \\frac{K_{\\max}^{2}}{\\sigma_{y}^{2}}$. For $R=0$, $K_{\\max} = \\Delta K = Y\\,\\sigma\\,\\sqrt{\\pi a}$.\n- **Overload Factor:** $F_{\\mathrm{OL}} \\equiv \\frac{\\sigma_{H}}{\\sigma_{L}}$.\n- **Relative Error:** $\\varepsilon \\equiv \\frac{D_{M} - D_{W}}{D_{W}}$.\n- **Numerical Values:** $m = 3.0$, $m_{w} = 1.0$, $Y = 1.0$, $n_{H} = 5.0 \\times 10^{3}$, $n_{L} = 2.0 \\times 10^{5}$, $\\sigma_{H} = 300 \\, \\text{MPa}$, $\\sigma_{L} = 150 \\, \\text{MPa}$.\n- **Constraints:** Do not assume numerical values for $a_{0}$, $a_{f}$, $C$, or $\\sigma_{y}$. It is given that $a_{0} > 0$ and $a_{f} > a_{0}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on established, albeit empirical, models in engineering fracture mechanics (Paris' law, Miner's rule, Wheeler model). The problem is self-contained and provides all necessary information and simplifying assumptions (constant $Y$, constant $\\phi$) to arrive at a unique solution. The required cancellation of unknown physical constants ($C$, $a_{0}$, $a_{f}$, $\\sigma_{y}$) is a common feature of well-designed physics and engineering problems and does not constitute a flaw. The provided numerical values are physically reasonable. No inconsistencies or contradictions are present.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\nThe solution proceeds in three parts as requested: derivation of the retardation factor $\\phi$, determination of the life scaling $N(\\sigma)$, and computation of the relative error $\\varepsilon$.\n\nFirst, we derive the retardation factor $\\phi$. The definition is $\\phi = \\left(\\frac{r_{p}}{r_{p,\\mathrm{OL}}}\\right)^{m_{w}}$. The plastic zone size, $r_p$, scales with $K_{\\max}^2$. For the low-amplitude block under stress $\\sigma_L$, the plastic zone size at a given crack length $a$ is proportional to $K_{\\max,L}^2 = (Y \\sigma_L \\sqrt{\\pi a})^2$. The overload plastic zone, $r_{p,\\mathrm{OL}}$, is that created by the high-amplitude stress $\\sigma_H$ at the transition point. At this same crack length $a$, its size is proportional to $K_{\\max,H}^2 = (Y \\sigma_H \\sqrt{\\pi a})^2$. The constant of proportionality, which depends on the yield strength $\\sigma_y$, is the same in both cases. The ratio of plastic zone sizes is therefore:\n$$\n\\frac{r_{p}}{r_{p,\\mathrm{OL}}} = \\frac{K_{\\max,L}^{2}}{K_{\\max,H}^{2}} = \\frac{(Y \\sigma_{L} \\sqrt{\\pi a})^{2}}{(Y \\sigma_{H} \\sqrt{\\pi a})^{2}} = \\frac{Y^{2} \\sigma_{L}^{2} \\pi a}{Y^{2} \\sigma_{H}^{2} \\pi a} = \\left(\\frac{\\sigma_{L}}{\\sigma_{H}}\\right)^{2}\n$$\nThe retardation factor $\\phi$ is then:\n$$\n\\phi = \\left[ \\left(\\frac{\\sigma_{L}}{\\sigma_{H}}\\right)^{2} \\right]^{m_{w}} = \\left(\\frac{\\sigma_{L}}{\\sigma_{H}}\\right)^{2m_{w}}\n$$\nUsing the definition of the overload factor, $F_{\\mathrm{OL}} = \\frac{\\sigma_{H}}{\\sigma_{L}}$, we express $\\phi$ as:\n$$\n\\phi = \\left(\\frac{1}{F_{\\mathrm{OL}}}\\right)^{2m_{w}} = F_{\\mathrm{OL}}^{-2m_{w}}\n$$\n\nSecond, we determine how the fatigue life $N(\\sigma)$ scales with the stress amplitude $\\sigma$. We start with Paris' law:\n$$\n\\frac{da}{dN} = C (\\Delta K)^{m} = C (Y \\sigma \\sqrt{\\pi a})^{m} = C Y^{m} \\sigma^{m} (\\pi a)^{m/2}\n$$\nTo find the total number of cycles $N$ to grow a crack from $a_{0}$ to $a_{f}$, we separate variables and integrate:\n$$\ndN = \\frac{da}{C Y^{m} \\pi^{m/2} \\sigma^{m} a^{m/2}}\n$$\n$$\nN(\\sigma) = \\int_{0}^{N(\\sigma)} dN = \\int_{a_{0}}^{a_{f}} \\frac{a^{-m/2}}{C Y^{m} \\pi^{m/2} \\sigma^{m}} da\n$$\nSince $\\sigma$, $C$, $Y$, and $\\pi$ are constant with respect to the integration variable $a$, they can be factored out:\n$$\nN(\\sigma) = \\frac{1}{C Y^{m} \\pi^{m/2} \\sigma^{m}} \\int_{a_{0}}^{a_{f}} a^{-m/2} da\n$$\nThe integral $\\int_{a_{0}}^{a_{f}} a^{-m/2} da$ evaluates to a constant value that depends only on $a_0$, $a_f$, and $m$. All other terms in the pre-factor, except for $\\sigma^m$, are also constant. Therefore, we can write the scaling relationship:\n$$\nN(\\sigma) \\propto \\frac{1}{\\sigma^{m}} \\quad \\text{or} \\quad N(\\sigma) = \\frac{A}{\\sigma^{m}}\n$$\nwhere $A$ is a constant incorporating all other parameters.\n\nThird, we compute the relative error $\\varepsilon = \\frac{D_{M} - D_{W}}{D_{W}}$. We substitute the expressions for $D_M$ and $D_W$:\n$$\n\\varepsilon = \\frac{\\left(\\frac{n_{H}}{N(\\sigma_{H})} + \\frac{n_{L}}{N(\\sigma_{L})}\\right) - \\left(\\frac{n_{H}}{N(\\sigma_{H})} + \\phi\\frac{n_{L}}{N(\\sigma_{L})}\\right)}{\\frac{n_{H}}{N(\\sigma_{H})} + \\phi\\frac{n_{L}}{N(\\sigma_{L})}} = \\frac{(1 - \\phi) \\frac{n_{L}}{N(\\sigma_{L})}}{\\frac{n_{H}}{N(\\sigma_{H})} + \\phi\\frac{n_{L}}{N(\\sigma_{L})}}\n$$\nTo simplify this expression, we use the scaling law for $N(\\sigma)$. The ratio of lives at the two stress levels is:\n$$\n\\frac{N(\\sigma_{L})}{N(\\sigma_{H})} = \\frac{A/\\sigma_{L}^{m}}{A/\\sigma_{H}^{m}} = \\left(\\frac{\\sigma_{H}}{\\sigma_{L}}\\right)^{m} = F_{\\mathrm{OL}}^{m}\n$$\nWe can divide the numerator and denominator of the expression for $\\varepsilon$ by $\\frac{n_{L}}{N(\\sigma_{L})}$:\n$$\n\\varepsilon = \\frac{1 - \\phi}{\\frac{n_{H}}{n_{L}} \\frac{N(\\sigma_{L})}{N(\\sigma_{H})} + \\phi}\n$$\nSubstituting the life ratio, we obtain an expression that depends only on known quantities:\n$$\n\\varepsilon = \\frac{1 - \\phi}{\\frac{n_{H}}{n_{L}} F_{\\mathrm{OL}}^{m} + \\phi}\n$$\nWe now substitute the numerical values:\n- $m = 3.0$\n- $m_{w} = 1.0$\n- $n_{H} = 5.0 \\times 10^{3}$\n- $n_{L} = 2.0 \\times 10^{5}$\n- $\\sigma_{H} = 300 \\, \\text{MPa}$\n- $\\sigma_{L} = 150 \\, \\text{MPa}$\n\nFirst, calculate the intermediate parameters:\nThe overload factor is $F_{\\mathrm{OL}} = \\frac{\\sigma_{H}}{\\sigma_{L}} = \\frac{300}{150} = 2.0$.\nThe retardation factor is $\\phi = F_{\\mathrm{OL}}^{-2m_{w}} = (2.0)^{-2(1.0)} = (2.0)^{-2} = \\frac{1}{4} = 0.25$.\nThe cycle ratio is $\\frac{n_{H}}{n_{L}} = \\frac{5.0 \\times 10^{3}}{2.0 \\times 10^{5}} = \\frac{5}{200} = \\frac{1}{40} = 0.025$.\n\nNow, substitute these into the expression for $\\varepsilon$:\n$$\n\\varepsilon = \\frac{1 - 0.25}{ (0.025) (2.0)^{3.0} + 0.25}\n$$\nCalculate the terms:\n- Numerator: $1 - 0.25 = 0.75$.\n- Denominator: $(0.025) \\times (8.0) + 0.25 = 0.20 + 0.25 = 0.45$.\n\nFinally, compute the value of $\\varepsilon$:\n$$\n\\varepsilon = \\frac{0.75}{0.45} = \\frac{75}{45} = \\frac{5 \\times 15}{3 \\times 15} = \\frac{5}{3}\n$$\nAs a decimal, $\\frac{5}{3} \\approx 1.6666...$.\nRounding to four significant figures as required gives $1.667$.", "answer": "$$\\boxed{1.667}$$", "id": "2875922"}, {"introduction": "Moving from idealized block loading to realistic engineering applications requires analyzing complex, non-repeating stress time series. This comprehensive computational exercise guides you through building an end-to-end fatigue analysis pipeline from scratch, a process central to modern structural integrity assessment. By implementing rainflow counting to extract cycles, applying mean stress corrections, and summing damage with Miner's rule, you will transform theoretical concepts into a powerful, practical tool for predicting fatigue life from raw service data. [@problem_id:2875935]", "problem": "You must write a complete, runnable program that transforms a discrete stress time series into cumulative fatigue damage $D$ by implementing a principled pipeline consisting of: rainflow cycle counting on reversal points, linear mean-stress correction, and mapping to cycles-to-failure via an $S$-$N$ relation, followed by linear damage accumulation. The derivation should proceed from core definitions: cycle extraction by reversals and closure, amplitude and mean stress per cycle, a linear mean-stress correction referenced to ultimate tensile strength, an $S$-$N$ relation consistent with high-cycle fatigue, and linear cumulative damage. The program must produce numeric results only, as specified below.\n\nRequired conceptual pipeline:\n- Starting from a discrete stress series $s(t_i)$, first extract reversal points (local maxima and minima), preserving the first and last point of the series.\n- Perform rainflow counting on the reversals to produce cycles with range $\\Delta S$ and mean $S_m$, counting both closed cycles and residual half cycles at the ends.\n- For each cycle, compute stress amplitude $S_a$ and mean $S_m$; apply a linear mean stress correction (Goodman type) referenced to ultimate tensile strength $S_u$ to obtain an equivalent fully reversed amplitude.\n- Map the equivalent amplitudes to cycles-to-failure using a power-law $S$-$N$ relation with a defined endurance limit $S_e$ below which damage is taken as zero.\n- Accumulate damage by linear summation across cycles to obtain $D$.\n\nScientific and numerical requirements:\n- All stresses must be treated in megapascals (MPa).\n- Cumulative damage $D$ is unitless. Express $D$ as a decimal rounded to $6$ digits after the decimal point.\n- Treat cycles with equivalent amplitude less than or equal to the endurance limit $S_e$ as causing zero damage.\n- Treat residual half cycles consistently with the rainflow standard as contributing a weight of $0.5$ of a full cycle.\n- Use a linear mean-stress correction referenced to $S_u$.\n- Use a power-law $S$-$N$ relation characterized by constants $C$ and $m$.\n\nTest suite:\n- For all test cases, use the same material parameters:\n  - Ultimate tensile strength $S_u = 700$ MPa.\n  - Endurance limit $S_e = 160$ MPa.\n  - $S$-$N$ constants: $C = 4.9 \\times 10^{12}$, $m = 3.0$.\n- Time series are given as discrete stress values $s_i$ in MPa. Your implementation must first reduce each series to reversal points and then perform rainflow counting.\n\nTest cases to evaluate:\n- Case 1 (happy path, fully reversed cycles above $S_e$): $[0, 200, -200, 200, -200, 0]$.\n- Case 2 (boundary, fully reversed cycles below $S_e$): $[0, 80, -80, 80, -80, 0]$.\n- Case 3 (significant nonzero mean stress, above $S_e$ after correction): $[100, 280, -80, 280, -80, 100]$.\n- Case 4 (edge case with mixed small cycles and an unclosed large excursion producing half cycles): $[0, 50, 0, -50, 0, 220, 0]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the cases, for example $[d_1,d_2,d_3,d_4]$, where each $d_i$ is the cumulative damage rounded to $6$ digits after the decimal point.\n\nDeliverables:\n- A single Python program that:\n  - Implements reversal extraction, rainflow counting, mean-stress correction (linear relative to $S_u$), and $S$-$N$ mapping with the provided $C$, $m$, $S_e$.\n  - Computes $D$ for each test case by linear accumulation.\n  - Prints exactly one line of the form $[d_1,d_2,d_3,d_4]$ with each $d_i$ rounded to $6$ digits after the decimal point.\n\nIn your written solution, clearly identify and justify each approximation or modeling choice involved in this pipeline, including but not limited to discretization of $s(t)$, reversal extraction, rainflow closure criteria, linear mean-stress correction, $S$-$N$ extrapolation and thresholding by $S_e$, and linear damage accumulation. The code output must remain purely numeric as specified above.", "solution": "The problem as stated is a well-defined exercise in computational materials mechanics, specifically pertaining to the estimation of cumulative fatigue damage. It is scientifically grounded, internally consistent, and contains all necessary parameters and data for a unique solution to be computed. It is therefore deemed a valid problem.\n\nThe solution requires the implementation of a standard fatigue analysis pipeline. Each step is based on established principles and models, which involve certain idealizations and approximations that must be clearly stated. The process begins with a stress-time history, $s(t)$, and concludes with a single dimensionless damage value, $D$.\n\n**Step 1: Reversal Point Extraction**\nFatigue damage is driven by stress reversals, not the entire time history. The first step is to distill the discrete stress series $s_i$ into a sequence of its local extrema (peaks and valleys). A point $s_i$ is considered a reversal if it is a local maximum or minimum, which can be checked by the condition $(s_i - s_{i-1})(s_{i+1} - s_i) < 0$. As per the problem specification, the first and last points of the series are always retained in the reversal sequence.\n\n**Step 2: Rainflow Cycle Counting**\nFrom the sequence of reversal points, individual stress cycles must be identified. The rainflow counting algorithm is the standard method for this task, as it correctly pairs stress peaks and valleys to form cycles that correspond to closed hysteresis loops in the stress-strain behavior of the material. We will employ a stack-based implementation compliant with the ASTM E1049-85 standard.\n\nThe algorithm proceeds as follows:\n1. Initialize an empty stack, $S$, to store reversal points.\n2. Iterate through the sequence of reversal points, $P$. For each point $p_i \\in P$:\n   a. Push $p_i$ onto the stack $S$.\n   b. While the stack contains three or more points (let the top three be $p_k, p_{k-1}, p_{k-2}$ from top to bottom), check the following condition: Let the stress ranges be $\\Delta S_1 = |p_k - p_{k-1}|$ and $\\Delta S_2 = |p_{k-1} - p_{k-2}|$. If $\\Delta S_1 \\ge \\Delta S_2$, a closed cycle is identified.\n   c. This cycle is defined by the points $p_{k-1}$ and $p_{k-2}$. It is counted as one full cycle ($n_i = 1$). We extract it for damage calculation and remove the point $p_{k-1}$ from the stack. The check is then repeated with the new stack configuration.\n   d. If $\\Delta S_1 < \\Delta S_2$, the inner loop terminates, and we proceed to the next point in the reversal sequence.\n3. After iterating through all points in $P$, any adjacent pairs of points $(s_j, s_{j+1})$ remaining on the stack form unclosed half-cycles ($n_i = 0.5$).\n\nFor each identified cycle (full or half), we compute its stress amplitude $S_a$ and mean stress $S_m$:\n$$ S_a = \\frac{|S_{\\text{max}} - S_{\\text{min}}|}{2} $$\n$$ S_m = \\frac{S_{\\text{max}} + S_{\\text{min}}}{2} $$\nThis method correctly accounts for the interruption of smaller stress cycles by larger ones.\n\n**Step 3: Mean Stress Correction**\nThe damaging effect of a stress cycle depends on both its amplitude and its mean stress. A tensile mean stress ($S_m > 0$) typically reduces fatigue life. The problem specifies a linear mean-stress correction referenced to the ultimate tensile strength, $S_u$. This corresponds to the Goodman relation. We use it to calculate an equivalent, fully reversed stress amplitude, $S_{a,eq}$.\n\nThe Goodman relation is given by:\n$$ \\frac{S_a}{S_{a,eq}} + \\frac{S_m}{S_u} = 1 $$\nSolving for the equivalent amplitude $S_{a,eq}$:\n$$ S_{a,eq} = \\frac{S_a}{1 - \\frac{S_m}{S_u}} $$\nThis equation is applied for tensile mean stresses ($S_m > 0$). For compressive mean stresses ($S_m \\le 0$), we conservatively take $S_{a,eq} = S_a$. The Goodman relation is a simplified linear model, primarily used for high-cycle fatigue analysis.\n\n**Step 4: Cycles-to-Failure ($S$-$N$ Relation)**\nThe relationship between a stress amplitude and the number of cycles to failure, $N_f$, is described by an $S$-$N$ curve. The problem specifies a power-law relationship (Basquin equation):\n$$ S_{a,eq}^m \\cdot N_f = C \\implies N_f = \\frac{C}{S_{a,eq}^m} $$\nA critical feature is the endurance limit, $S_e$. Any stress cycle with an equivalent amplitude $S_{a,eq} \\le S_e$ is assumed to cause zero damage ($N_f \\to \\infty$). This is a common design idealization.\n\n**Step 5: Linear Damage Accumulation (Miner's Rule)**\nThe total damage, $D$, is the linear sum of the damage fractions from each cycle. The damage fraction for the $i$-th cycle is the ratio of its applied count, $n_i$ ($1$ for a full cycle, $0.5$ for a half-cycle), to its cycles-to-failure, $N_{f,i}$.\n$$ D = \\sum_{i} \\frac{n_i}{N_{f,i}} $$\nThe sum is taken over all cycles for which $S_{a,eq,i} > S_e$. Miner's rule is widely used despite its neglect of load sequence effects.\n\n**Calculation Summary**\nUsing a correct implementation of the specified pipeline, we obtain the following results:\n- **Case 1**: `[0, 200, -200, 200, -200, 0]`. Rainflow counting yields two full cycles with $S_a=200$ MPa, $S_m=0$ MPa. Since $S_m=0$, $S_{a,eq} = 200 > S_e$.\n$N_f = (4.9 \\times 10^{12}) / 200^3 = 612500$.\n$D = 2 \\times (1 / 612500) \\approx 0.000003265$.\n\n- **Case 2**: `[0, 80, -80, 80, -80, 0]`. Rainflow counting yields two full cycles with $S_a=80$ MPa, $S_m=0$ MPa. $S_{a,eq} = 80 \\le S_e$.\n$D = 0$.\n\n- **Case 3**: `[100, 280, -80, 280, -80, 100]`. Rainflow counting yields:\n    - One full cycle: Range 360 (from 280 to -80), so $S_a=180$, $S_m=100$.\n    - One half cycle: Range 360 (from -80 to 280), so $S_a=180$, $S_m=100$.\n    - Two smaller half cycles which have an $S_{a,eq} \\le S_e$.\nFor the damaging cycles: $S_{a,eq} = 180 / (1 - 100/700) = 210$ MPa. Since $S_{a,eq} > S_e$, they cause damage.\n$N_f = (4.9 \\times 10^{12}) / 210^3 \\approx 529099.45$.\nThe total count for this damaging cycle is $1.0 + 0.5 = 1.5$.\n$D = 1.5 / N_f \\approx 0.000002835$.\n\n- **Case 4**: `[0, 50, 0, -50, 0, 220, 0]` reduces to reversals `[0, 50, -50, 220, 0]`. Rainflow counting yields four residual half-cycles. The most severe is a half-cycle with range 270 (from -50 to 220), giving $S_a=135$, $S_m=85$.\n$S_{a,eq} = 135 / (1 - 85/700) \\approx 153.7$ MPa.\nSince $153.7 \\le S_e$, this cycle and all smaller cycles cause zero damage.\n$D = 0$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes cumulative fatigue damage for a set of stress time series\n    using a standard pipeline: reversal extraction, rainflow counting,\n    Goodman mean stress correction, and Miner's linear damage rule.\n    \"\"\"\n\n    # Material parameters (all stresses in MPa)\n    S_u = 700.0   # Ultimate tensile strength\n    S_e = 160.0   # Endurance limit\n    C = 4.9e12    # S-N constant\n    m = 3.0       # S-N exponent\n\n    test_cases = [\n        [0.0, 200.0, -200.0, 200.0, -200.0, 0.0],\n        [0.0, 80.0, -80.0, 80.0, -80.0, 0.0],\n        [100.0, 280.0, -80.0, 280.0, -80.0, 100.0],\n        [0.0, 50.0, 0.0, -50.0, 0.0, 220.0, 0.0],\n    ]\n\n    def extract_reversals(series):\n        \"\"\"\n        Extracts reversal points (peaks and valleys) from a time series.\n        Keeps the first and last points.\n        \"\"\"\n        if len(series)  3:\n            return series\n\n        reversals = [series[0]]\n        for i in range(1, len(series) - 1):\n            p_prev, p_curr, p_next = series[i - 1], series[i], series[i + 1]\n            if (p_curr > p_prev and p_curr > p_next) or \\\n               (p_curr  p_prev and p_curr  p_next):\n                reversals.append(p_curr)\n        reversals.append(series[-1])\n        return reversals\n\n    def rainflow_count(reversals):\n        \"\"\"\n        Performs rainflow cycle counting using a stack-based algorithm\n        compliant with ASTM E1049-85.\n        Returns a list of tuples (amplitude, mean, count).\n        \"\"\"\n        stack = []\n        cycles = []\n        \n        # Process reversals to find closed cycles\n        for point in reversals:\n            stack.append(point)\n            while len(stack) >= 3:\n                p_k, p_k_minus_1, p_k_minus_2 = stack[-1], stack[-2], stack[-3]\n                range1 = abs(p_k - p_k_minus_1)\n                range2 = abs(p_k_minus_1 - p_k_minus_2)\n\n                if range1 >= range2:\n                    # A closed cycle is found from p_k_minus_1 and p_k_minus_2\n                    amplitude = range2 / 2.0\n                    mean_stress = (p_k_minus_1 + p_k_minus_2) / 2.0\n                    cycles.append((amplitude, mean_stress, 1.0))\n                    \n                    # Pop the middle point p_k_minus_1 from the stack\n                    stack.pop(-2)\n                else:\n                    break\n\n        # Process residual half-cycles remaining in the stack by pairing adjacent points\n        for i in range(len(stack) - 1):\n            p1 = stack[i]\n            p2 = stack[i+1]\n            amplitude = abs(p2 - p1) / 2.0\n            mean_stress = (p1 + p2) / 2.0\n            cycles.append((amplitude, mean_stress, 0.5))\n\n        return cycles\n\n    results = []\n    for case_series in test_cases:\n        reversals = extract_reversals(case_series)\n        cycles = rainflow_count(reversals)\n\n        total_damage = 0.0\n        for Sa, Sm, count in cycles:\n            if Sa == 0:\n                continue\n\n            # Apply Goodman mean stress correction\n            Sa_eq = Sa\n            if Sm > 0:\n                if Sm  S_u:\n                    Sa_eq = Sa / (1.0 - Sm / S_u)\n                else: # Tensile mean stress exceeds ultimate strength\n                    Sa_eq = float('inf')\n\n            # Accumulate damage only if equivalent amplitude is above endurance limit\n            if Sa_eq > S_e:\n                Nf = C / (Sa_eq ** m)\n                total_damage += count / Nf\n\n        results.append(round(total_damage, 6))\n\n    # Print the final output in the exact required format\n    print(f\"[{','.join(map(lambda x: f'{x:.6f}', results))}]\")\n\nsolve()\n```", "id": "2875935"}]}