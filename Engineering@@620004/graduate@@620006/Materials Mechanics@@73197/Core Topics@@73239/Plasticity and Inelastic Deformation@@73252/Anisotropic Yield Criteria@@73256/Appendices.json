{"hands_on_practices": [{"introduction": "Before an anisotropic yield criterion can be used in engineering analysis, its parameters must be determined from experimental data. This exercise provides hands-on practice in this crucial calibration step for the foundational Hill 1948 model. By deriving and solving for the coefficients $(F, G, H, N)$ from measured yield stresses, you will solidify your understanding of how the model mathematically captures orthotropic material behavior [@problem_id:2866890].", "problem": "A rolled sheet metal exhibits orthotropic yielding under plane stress. Let the material axes be aligned with the rolling direction, transverse direction, and thickness direction, denoted by axes $1$, $2$, and $3$, respectively. The measured initial yield stresses at room temperature are as follows: uniaxial tension along the rolling direction $0^{\\circ}$ gives $\\sigma_{Y}^{0} = 180\\,\\text{MPa}$, uniaxial tension along $45^{\\circ}$ to the rolling direction gives $\\sigma_{Y}^{45} = 190\\,\\text{MPa}$, uniaxial tension along the transverse direction $90^{\\circ}$ gives $\\sigma_{Y}^{90} = 200\\,\\text{MPa}$, and in-plane pure shear gives $\\tau_{Y} = 100\\,\\text{MPa}$ (angles are in degrees).\n\nStarting from the definition that Hill’s 1948 quadratic orthotropic yield function under plane stress is a homogeneous quadratic form in the stress components consistent with material orthotropy and convexity, and that measured yield points in prescribed loading states must lie on the yield surface, derive a system of equations linking the anisotropy coefficients $(F,G,H,N)$ to $(\\sigma_{Y}^{0},\\sigma_{Y}^{45},\\sigma_{Y}^{90},\\tau_{Y})$. Solve this system to compute the numerical values of $(F,G,H,N)$ for this sheet and verify the convexity condition $F>0$, $G>0$, $H>0$, $N>0$.\n\nExpress $F$, $G$, $H$, and $N$ in $\\text{MPa}^{-2}$ and round each to six significant figures. The final answer must be reported as a single row vector containing $(F,G,H,N)$, with no units inside the vector.", "solution": "The fundamental base is that yield in metals can be characterized by a convex yield function that is homogeneous of degree two in stress for quadratic criteria. For orthotropic sheet metals under plane stress, Hill’s 1948 yield criterion postulates a quadratic form in stress that respects the material’s orthotropic symmetry. Denoting the Cauchy stress in the material axes by $(\\sigma_{1},\\sigma_{2},\\sigma_{3},\\tau_{23},\\tau_{31},\\tau_{12})$ and restricting to plane stress $(\\sigma_{3}=\\tau_{23}=\\tau_{31}=0)$, the quadratic form specializes to\n$$\n\\Phi(\\sigma_{1},\\sigma_{2},\\tau_{12}) \\equiv F(\\sigma_{2}-\\sigma_{3})^{2} + G(\\sigma_{3}-\\sigma_{1})^{2} + H(\\sigma_{1}-\\sigma_{2})^{2} + 2N\\tau_{12}^{2}\n= F\\sigma_{2}^{2} + G\\sigma_{1}^{2} + H(\\sigma_{1}-\\sigma_{2})^{2} + 2N\\tau_{12}^{2}.\n$$\nYielding occurs when $\\Phi=1$ after an implicit normalization; equivalently, the measured stress states at first yield must satisfy $\\Phi=1$. We identify four calibration states:\n\n1. Uniaxial tension along axis $1$ (rolling direction $0^{\\circ}$): $\\sigma_{1}=\\sigma_{Y}^{0}$, $\\sigma_{2}=0$, $\\tau_{12}=0$. Substituting gives\n$$\n\\Phi = G(\\sigma_{Y}^{0})^{2} + H(\\sigma_{Y}^{0})^{2} = (G+H)(\\sigma_{Y}^{0})^{2} = 1,\n$$\nhence\n$$\nG+H = \\frac{1}{(\\sigma_{Y}^{0})^{2}}.\n$$\n\n2. Uniaxial tension along axis $2$ (transverse direction $90^{\\circ}$): $\\sigma_{2}=\\sigma_{Y}^{90}$, $\\sigma_{1}=0$, $\\tau_{12}=0$. Substituting gives\n$$\n\\Phi = F(\\sigma_{Y}^{90})^{2} + H(\\sigma_{Y}^{90})^{2} = (F+H)(\\sigma_{Y}^{90})^{2} = 1,\n$$\nhence\n$$\nF+H = \\frac{1}{(\\sigma_{Y}^{90})^{2}}.\n$$\n\n3. Uniaxial tension at $45^{\\circ}$ to axis $1$: for a uniaxial stress $\\sigma$ applied along an axis rotated by $\\theta$ relative to axis $1$, the in-plane components in the material axes are $\\sigma_{1}=\\sigma\\cos^{2}\\theta$, $\\sigma_{2}=\\sigma\\sin^{2}\\theta$, and $\\tau_{12}=\\sigma\\sin\\theta\\cos\\theta$. At $\\theta=45^{\\circ}$, one has $\\sigma_{1}=\\sigma_{2}=\\sigma/2$ and $\\tau_{12}=\\sigma/2$. Setting $\\sigma=\\sigma_{Y}^{45}$ and substituting yields\n$$\n\\Phi = F\\left(\\frac{\\sigma_{Y}^{45}}{2}\\right)^{2} + G\\left(\\frac{\\sigma_{Y}^{45}}{2}\\right)^{2} + H(0)^{2} + 2N\\left(\\frac{\\sigma_{Y}^{45}}{2}\\right)^{2}\n= \\frac{(\\sigma_{Y}^{45})^{2}}{4}\\,(F+G+2N) = 1,\n$$\nhence\n$$\nF+G+2N = \\frac{4}{(\\sigma_{Y}^{45})^{2}}.\n$$\n\n4. In-plane pure shear: $\\sigma_{1}=\\sigma_{2}=0$, $\\tau_{12}=\\tau_{Y}$. Substituting gives\n$\n\\Phi = 2N\\tau_{Y}^{2} = 1,\n$\nhence\n$\nN = \\frac{1}{2\\tau_{Y}^{2}}.\n$\n\nThese four equations determine $(F,G,H,N)$. First, compute $N$ from the shear test:\n$$\nN = \\frac{1}{2\\tau_{Y}^{2}}.\n$$\nWith $N$ known, the $45^{\\circ}$ test gives\n$$\nF+G = \\frac{4}{(\\sigma_{Y}^{45})^{2}} - 2N.\n$$\nFrom the two uniaxial tests,\n$$\nG+H = \\frac{1}{(\\sigma_{Y}^{0})^{2}},\\qquad F+H = \\frac{1}{(\\sigma_{Y}^{90})^{2}}.\n$$\nSubtracting these two equations yields\n$$\nF - G = \\frac{1}{(\\sigma_{Y}^{90})^{2}} - \\frac{1}{(\\sigma_{Y}^{0})^{2}}.\n$$\nHence\n$$\nF = \\frac{1}{2}\\Big[(F+G) + (F-G)\\Big],\\qquad G = \\frac{1}{2}\\Big[(F+G) - (F-G)\\Big],\n$$\nand then $H$ follows from $G+H=1/(\\sigma_{Y}^{0})^{2}$ or $F+H=1/(\\sigma_{Y}^{90})^{2}$.\n\nNow substitute the given numerical values, maintaining symbols until the last step:\n\nGiven $\\sigma_{Y}^{0}=180\\,\\text{MPa}$, $\\sigma_{Y}^{45}=190\\,\\text{MPa}$, $\\sigma_{Y}^{90}=200\\,\\text{MPa}$, and $\\tau_{Y}=100\\,\\text{MPa}$,\n$$\nN = \\frac{1}{2(100)^{2}} = \\frac{1}{20000} = 5.00000\\times 10^{-5}\\ \\text{MPa}^{-2}.\n$$\nThen\n$$\nF+G = \\frac{4}{(190)^{2}} - 2N = \\frac{4}{36100} - \\frac{1}{10000}\n= 1.10803324099723\\times 10^{-4} - 1.00000000000000\\times 10^{-4}\n= 1.08033240997230\\times 10^{-5}\\ \\text{MPa}^{-2}.\n$$\nNext,\n$$\nF - G = \\frac{1}{(200)^{2}} - \\frac{1}{(180)^{2}}\n= 2.50000000000000\\times 10^{-5} - 3.08641975308642\\times 10^{-5}\n= -5.86419753086420\\times 10^{-6}\\ \\text{MPa}^{-2}.\n$$\nTherefore,\n$$\nF = \\frac{(F+G)+(F-G)}{2}\n= \\frac{1.08033240997230\\times 10^{-5} - 5.86419753086420\\times 10^{-6}}{2}\n= 2.46956328442940\\times 10^{-6}\\ \\text{MPa}^{-2},\n$$\n$$\nG = \\frac{(F+G)-(F-G)}{2}\n= \\frac{1.08033240997230\\times 10^{-5} + 5.86419753086420\\times 10^{-6}}{2}\n= 8.33376081529360\\times 10^{-6}\\ \\text{MPa}^{-2}.\n$$\nFinally, from $G+H=1/(\\sigma_{Y}^{0})^{2}$,\n$$\nH = \\frac{1}{(180)^{2}} - G\n= 3.08641975308642\\times 10^{-5} - 8.33376081529360\\times 10^{-6}\n= 2.25304367155706\\times 10^{-5}\\ \\text{MPa}^{-2}.\n$$\n\nRounded to six significant figures in $\\text{MPa}^{-2}$,\n$$\nF = 2.46956\\times 10^{-6},\\quad\nG = 8.33376\\times 10^{-6},\\quad\nH = 2.25304\\times 10^{-5},\\quad\nN = 5.00000\\times 10^{-5}.\n$$\n\nConvexity verification for this quadratic form (under plane stress) requires $F>0$, $G>0$, $H>0$, $N>0$. The computed values satisfy\n$$\nF=2.46956\\times 10^{-6}>0,\\quad\nG=8.33376\\times 10^{-6}>0,\\quad\nH=2.25304\\times 10^{-5}>0,\\quad\nN=5.00000\\times 10^{-5}>0,\n$$\nso the convexity condition is satisfied.", "answer": "$$\\boxed{\\begin{pmatrix}2.46956\\times 10^{-6} & 8.33376\\times 10^{-6} & 2.25304\\times 10^{-5} & 5.00000\\times 10^{-5}\\end{pmatrix}}$$", "id": "2866890"}, {"introduction": "Once a model is calibrated, it is vital to understand its predictive capabilities and limitations, which are closely tied to the geometry of its yield surface. This practice explores the concept of yield locus curvature by comparing the classic quadratic Hill model with a more advanced non-quadratic criterion. This analysis reveals why different models predict different outcomes in complex forming simulations, a key concept for accurately modeling sheet metal formability [@problem_id:2866847].", "problem": "A rolled sheet metal is approximately isotropic in its initial yield response. A uniaxial tensile test provides a measured yield stress of $500\\,\\text{MPa}$ in the rolling direction, and equibiaxial bulge testing confirms that the initial yield stress under balanced biaxial tension is also $500\\,\\text{MPa}$ (consistent with isotropy). Consider two yield criteria calibrated to this single measured initial yield stress: the standard isotropic quadratic Hill $1948$ model (which reduces to the isotropic von Mises form) and an isotropic non-quadratic Hosford model with exponent $m=6$. Assume plane stress and consider the yield locus in principal stress space $\\sigma_1$–$\\sigma_2$ in the first quadrant (tension–tension).\n\nUsing first principles (definition of a yield locus as a level set in stress space and differential geometry of plane curves), determine the local radius of curvature of the yield locus at the equibiaxial tension point $\\sigma_1=\\sigma_2$ for each model, and use this to assess which model exhibits the sharper corner at equibiaxial tension. Then infer the qualitative consequence for sheet forming simulations under balanced biaxial stretching (for example, punch bulge or hemispherical dome tests) with return-mapping plasticity and associated flow, in terms of predicted strain-path sensitivity and formability.\n\nWhich of the following statements is most consistent with a correct derivation and scientifically sound consequence?\n\nA. When both criteria are calibrated to $500\\,\\text{MPa}$, the local radius of curvature at equibiaxial tension is approximately $\\rho_{m=2}\\approx 2.36\\times 10^2\\,\\text{MPa}$ for the quadratic Hill $1948$ (von Mises) and $\\rho_{m=6}\\approx 1.41\\times 10^2\\,\\text{MPa}$ for the non-quadratic Hosford ($m=6$), so the non-quadratic locus is sharper. Consequently, using Hill $1948$ in forming simulations under balanced biaxial stretching tends to overpredict stretch formability (non-conservative) by smoothing the corner, delaying localization and underestimating strain-path sensitivity near equibiaxial tension.\n\nB. When both criteria are calibrated to $500\\,\\text{MPa}$, the local radius of curvature at equibiaxial tension is approximately $\\rho_{m=2}\\approx 1.41\\times 10^2\\,\\text{MPa}$ for Hill $1948$ and $\\rho_{m=6}\\approx 2.36\\times 10^2\\,\\text{MPa}$ for Hosford ($m=6$), so Hill $1948$ is sharper. Consequently, Hill $1948$ underpredicts formability (conservative) and triggers premature localization in biaxial stretching simulations.\n\nC. For any exponent $m$ in Hosford, if both criteria are calibrated to the same uniaxial and equibiaxial yield stresses, the local curvature at equibiaxial tension is identical. Consequently, the choice between quadratic Hill $1948$ and non-quadratic criteria has negligible impact on biaxial forming predictions.\n\nD. Non-quadratic criteria such as Hosford ($m=6$) always smooth yield locus corners relative to quadratic forms, leading to larger local curvature radii at equibiaxial tension. Consequently, non-quadratic models systematically overpredict formability in biaxial stretching relative to Hill $1948$.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It is based on established principles of continuum mechanics and plasticity theory, specifically the comparison of quadratic and non-quadratic yield criteria. The provided data are self-consistent and realistic. The problem is therefore deemed valid for a rigorous solution.\n\nThe core of the problem is to determine the local radius of curvature, $\\rho$, of a yield locus at the equibiaxial tension point. The yield locus is a plane curve in the principal stress space ($\\sigma_1, \\sigma_2$) defined by an implicit function of the form $F(\\sigma_1, \\sigma_2) = 0$. The radius of curvature for such a curve is given by the formula from differential geometry:\n$$ \\rho = \\frac{(F_1^2 + F_2^2)^{3/2}}{|F_{11}F_2^2 - 2F_{12}F_1 F_2 + F_{22}F_1^2|} $$\nwhere $F_i = \\frac{\\partial F}{\\partial \\sigma_i}$ and $F_{ij} = \\frac{\\partial^2 F}{\\partial \\sigma_i \\partial \\sigma_j}$. We will evaluate this at the equibiaxial tension point, where $\\sigma_1 = \\sigma_2 = \\sigma_b$. The problem states that the equibiaxial yield stress is $\\sigma_b = 500\\,\\text{MPa}$.\n\n**Analysis of the Isotropic Quadratic Hill 1948 (von Mises) Criterion**\n\nFor an isotropic material under plane stress ($\\sigma_3=0$), the Hill 1948 criterion simplifies to the von Mises criterion. The yield function is commonly expressed as $\\bar{\\sigma}_{vM} = Y$, where $Y$ is the uniaxial yield stress, given as $Y=500\\,\\text{MPa}$.\nLet us define the yield locus function $F(\\sigma_1, \\sigma_2) = \\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2 - Y^2 = 0$.\nAt the equibiaxial point $\\sigma_1 = \\sigma_2 = \\sigma_b$, the yield condition gives $\\sigma_b^2 - \\sigma_b^2 + \\sigma_b^2 = Y^2$, so $\\sigma_b = Y = 500\\,\\text{MPa}$, which is consistent with the problem statement.\n\nWe calculate the necessary partial derivatives of $F$:\n$F_1 = 2\\sigma_1 - \\sigma_2$\n$F_2 = 2\\sigma_2 - \\sigma_1$\n$F_{11} = 2$\n$F_{22} = 2$\n$F_{12} = -1$\n\nAt the equibiaxial point ($\\sigma_1 = \\sigma_2 = \\sigma_b = Y$):\n$F_1 = 2Y - Y = Y$\n$F_2 = 2Y - Y = Y$\nThe second derivatives are constant.\n\nNow, we substitute these into the formula for the radius of curvature, denoted $\\rho_{m=2}$:\nNumerator: $(F_1^2 + F_2^2)^{3/2} = (Y^2 + Y^2)^{3/2} = (2Y^2)^{3/2} = 2\\sqrt{2}Y^3$.\nDenominator: $|F_{11}F_2^2 - 2F_{12}F_1 F_2 + F_{22}F_1^2| = |2(Y^2) - 2(-1)(Y)(Y) + 2(Y^2)| = |2Y^2 + 2Y^2 + 2Y^2| = 6Y^2$.\n\nThe radius of curvature is:\n$$ \\rho_{m=2} = \\frac{2\\sqrt{2}Y^3}{6Y^2} = \\frac{\\sqrt{2}}{3}Y $$\nSubstituting $Y = 500\\,\\text{MPa}$:\n$$ \\rho_{m=2} = \\frac{\\sqrt{2}}{3}(500\\,\\text{MPa}) \\approx \\frac{1.41421}{3}(500\\,\\text{MPa}) \\approx 235.70\\,\\text{MPa} $$\nThis value is approximately $2.36 \\times 10^2\\,\\text{MPa}$.\n\n**Analysis of the Isotropic Non-Quadratic Hosford Criterion ($m=6$)**\n\nThe isotropic Hosford yield function for plane stress ($\\sigma_3=0$) is given by:\n$$ \\Phi = \\frac{1}{2}(|\\sigma_1 - \\sigma_2|^m + |\\sigma_1|^m + |\\sigma_2|^m) = Y^m $$\nWe define the yield locus function $F(\\sigma_1, \\sigma_2) = \\frac{1}{2}(|\\sigma_1 - \\sigma_2|^m + \\sigma_1^m + \\sigma_2^m) - Y^m = 0$, considering the first quadrant where $\\sigma_1, \\sigma_2 > 0$.\nAt the equibiaxial point $\\sigma_1 = \\sigma_2 = \\sigma_b$, this gives $\\frac{1}{2}(0^m + \\sigma_b^m + \\sigma_b^m) = Y^m$, which simplifies to $\\sigma_b^m = Y^m$, so $\\sigma_b = Y = 500\\,\\text{MPa}$.\n\nTo calculate the derivatives, we must be careful with the absolute value term $|\\sigma_1 - \\sigma_2|^m$ at the point where its argument is zero. For $m=6$, the function $|\\sigma_1 - \\sigma_2|^6$ is smooth (differentiable multiple times) at $\\sigma_1 = \\sigma_2$, and its derivatives up to the 5th order are zero at this point. The second derivatives of this term are zero.\n\nThe partial derivatives of $F$ are:\n$F_1 = \\frac{m}{2} \\left[ |\\sigma_1 - \\sigma_2|^{m-1}\\text{sgn}(\\sigma_1-\\sigma_2) + \\sigma_1^{m-1} \\right]$\n$F_2 = \\frac{m}{2} \\left[ -|\\sigma_1 - \\sigma_2|^{m-1}\\text{sgn}(\\sigma_1-\\sigma_2) + \\sigma_2^{m-1} \\right]$\n$F_{11} = \\frac{m(m-1)}{2} \\left[ |\\sigma_1 - \\sigma_2|^{m-2} + \\sigma_1^{m-2} \\right]$\n$F_{22} = \\frac{m(m-1)}{2} \\left[ |\\sigma_1 - \\sigma_2|^{m-2} + \\sigma_2^{m-2} \\right]$\n$F_{12} = -\\frac{m(m-1)}{2} |\\sigma_1 - \\sigma_2|^{m-2}$\n\nAt the equibiaxial point ($\\sigma_1 = \\sigma_2 = Y$) and for $m=6$:\n$F_1 = \\frac{m}{2} (0 + Y^{m-1}) = \\frac{m}{2}Y^{m-1}$\n$F_2 = \\frac{m}{2} (0 + Y^{m-1}) = \\frac{m}{2}Y^{m-1}$\nSince $m-2 = 4 > 0$:\n$F_{11} = \\frac{m(m-1)}{2} (0 + Y^{m-2}) = \\frac{m(m-1)}{2}Y^{m-2}$\n$F_{22} = \\frac{m(m-1)}{2} (0 + Y^{m-2}) = \\frac{m(m-1)}{2}Y^{m-2}$\n$F_{12} = 0$\n\nWe substitute these into the curvature formula for $\\rho_{m=6}$:\nNumerator: $(F_1^2 + F_2^2)^{3/2} = \\left[ 2 \\left( \\frac{m}{2}Y^{m-1} \\right)^2 \\right]^{3/2} = 2\\sqrt{2} \\left( \\frac{m}{2}Y^{m-1} \\right)^3 = \\frac{\\sqrt{2}m^3}{4}Y^{3m-3}$.\nDenominator: $|F_{11}F_2^2 - 2F_{12}F_1 F_2 + F_{22}F_1^2| = | 2 \\left( \\frac{m(m-1)}{2}Y^{m-2} \\right) \\left( \\frac{m}{2}Y^{m-1} \\right)^2 | = \\frac{m^3(m-1)}{4}Y^{3m-4}$.\n\nThe radius of curvature is:\n$$ \\rho_{m} = \\frac{\\frac{\\sqrt{2}m^3}{4}Y^{3m-3}}{\\frac{m^3(m-1)}{4}Y^{3m-4}} = \\frac{\\sqrt{2}}{m-1}Y $$\nThis formula is valid for $m>2$. For $m=6$:\n$$ \\rho_{m=6} = \\frac{\\sqrt{2}}{6-1}Y = \\frac{\\sqrt{2}}{5}Y $$\nSubstituting $Y = 500\\,\\text{MPa}$:\n$$ \\rho_{m=6} = \\frac{\\sqrt{2}}{5}(500\\,\\text{MPa}) = 100\\sqrt{2}\\,\\text{MPa} \\approx 141.42\\,\\text{MPa} $$\nThis value is approximately $1.41 \\times 10^2\\,\\text{MPa}$.\n\n**Comparison and Consequences**\n\nWe have calculated $\\rho_{m=2} \\approx 236\\,\\text{MPa}$ and $\\rho_{m=6} \\approx 141\\,\\text{MPa}$. Since $\\rho_{m=6} < \\rho_{m=2}$, the yield locus for the Hosford criterion with $m=6$ has a smaller radius of curvature, meaning it is significantly sharper at the equibiaxial tension point than the von Mises yield locus.\n\nIn the context of plasticity with an associated flow rule, the plastic strain increment vector is normal to the yield surface. A sharper corner (smaller $\\rho$) implies that the direction of the normal vector changes more rapidly for small changes in the stress state along the locus. This leads to higher strain-path sensitivity. For forming processes near balanced biaxial stretching, a model with a sharper corner (like Hosford $m=6$) will predict an earlier onset of flow localization (necking) compared to a smoother model (like von Mises).\nConsequently, using the von Mises (or quadratic Hill) criterion, which has a larger radius of curvature, smooths out this corner effect. This leads to an underestimation of strain-path sensitivity and a delayed prediction of plastic instability, resulting in an overprediction of the material's formability (stretchability). This is a non-conservative prediction from an engineering design standpoint.\n\n**Option-by-Option Analysis**\n\nA. The calculated values $\\rho_{m=2} \\approx 2.36\\times 10^2\\,\\text{MPa}$ and $\\rho_{m=6} \\approx 1.41\\times 10^2\\,\\text{MPa}$ are correct. The conclusion that the non-quadratic locus ($m=6$) is sharper is correct. The stated consequence, that using Hill 1948 (von Mises) leads to an overprediction of formability and is non-conservative due to smoothing the yield locus corner, is a correct and standard interpretation in the field of sheet metal forming. **Correct**.\n\nB. The numerical values for the radii of curvature are swapped between the two models. This is incorrect. The resulting conclusion that Hill 1948 is sharper and underpredicts formability is therefore also incorrect. **Incorrect**.\n\nC. The statement that the local curvature is identical for any exponent $m$ is demonstrably false. Our derivation shows $\\rho_{m=2} = \\frac{\\sqrt{2}}{3}Y$ and $\\rho_{m=6} = \\frac{\\sqrt{2}}{5}Y$, which are not equal. The conclusion that the choice of model has negligible impact is a direct contradiction to established findings in material modeling for forming applications. **Incorrect**.\n\nD. The statement claims that non-quadratic criteria like Hosford ($m=6$) smooth the corners relative to quadratic forms. Our calculation shows the opposite: $\\rho_{m=6} < \\rho_{m=2}$, meaning the Hosford locus is sharper, not smoother. The subsequent conclusion is based on this false premise. **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2866847"}, {"introduction": "The ultimate test of understanding a constitutive model is to implement it within a computational framework, as is done in finite element software. This exercise guides you through the development of a return-mapping algorithm, the cornerstone of modern computational plasticity. You will implement the robust backward-Euler integration scheme to update stress and internal variables for the Hill 1948 model, bridging the gap between continuum mechanics theory and its practical numerical application [@problem_id:2866860].", "problem": "You are to implement a single-step stress update for a small-strain, rate-independent, associated elastoplastic model with Hill 1948 anisotropic yield criterion using backward-Euler integration. The goal is to compute the updated Cauchy stress tensor and internal variables given a prescribed strain increment, starting from a stress-free, plastic-strain-free state. All computations must be performed in the standard Voigt vector representation with tensorial shear components in the order $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12}]$ and $[\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},\\varepsilon_{23},\\varepsilon_{13},\\varepsilon_{12}]$. Use the following fundamental base and assumptions.\n\n1. Kinematics and elasticity. Assume small strain kinematics, where the total strain increment is additively decomposed into elastic and plastic parts as $\\Delta \\boldsymbol{\\varepsilon} = \\Delta \\boldsymbol{\\varepsilon}^{e} + \\Delta \\boldsymbol{\\varepsilon}^{p}$. Linear isotropic elasticity relates the stress and elastic strain by Hooke’s law in tensorial form, $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}^{e} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e}) \\mathbf{I}$, where $\\mu$ and $\\lambda$ are Lamé parameters. In Voigt notation with tensorial shear components, the elastic stiffness matrix $\\mathbf{C}$ is symmetric with the $3\\times3$ normal block having $\\lambda + 2\\mu$ on the diagonal and $\\lambda$ off-diagonal, and with the three shear diagonal entries equal to $2\\mu$.\n\n2. Yield function. Use the Hill 1948 anisotropic quadratic yield function written as a convex quadratic form in stress,\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}^{T}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma} - \\tfrac{1}{2}\\,R(\\kappa)^{2} \\le 0,\n$$\nwhere $\\kappa$ is a scalar hardening variable, $R(\\kappa)=\\sigma_{0}+H^{\\mathrm{iso}}\\kappa$ is the current radius with initial yield stress $\\sigma_{0}$ and linear isotropic hardening modulus $H^{\\mathrm{iso}}$, and $\\mathbf{P}$ is the $6\\times 6$ symmetric positive-definite matrix encoding the Hill anisotropy. Let the Hill coefficients be $F_{a}$, $G_{a}$, $H_{a}$, $L_{a}$, $M_{a}$, $N_{a}$, and define $\\mathbf{P}$ in the stated Voigt order by\n$$\n\\mathbf{P} =\n\\begin{bmatrix}\nG_{a}+H_{a} & -H_{a} & -G_{a} & 0 & 0 & 0\\\\\n-H_{a} & F_{a}+H_{a} & -F_{a} & 0 & 0 & 0\\\\\n-G_{a} & -F_{a} & F_{a}+G_{a} & 0 & 0 & 0\\\\\n0 & 0 & 0 & 2L_{a} & 0 & 0\\\\\n0 & 0 & 0 & 0 & 2M_{a} & 0\\\\\n0 & 0 & 0 & 0 & 0 & 2N_{a}\n\\end{bmatrix}.\n$$\n\n3. Flow rule and hardening. Use an associated flow rule $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\partial f/\\partial \\boldsymbol{\\sigma}$ with plastic multiplier $\\Delta\\gamma \\ge 0$, so that $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}$ under backward-Euler time discretization. The internal hardening variable updates as $\\kappa_{n+1} = \\kappa_{n} + \\Delta\\gamma$.\n\n4. Return-mapping. Given a previous state $(\\boldsymbol{\\sigma}_{n},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$ and a strain increment $\\Delta \\boldsymbol{\\varepsilon}$, define the elastic trial stress as $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}$. If $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}},\\kappa_{n}) \\le 0$, the step is elastic and $(\\boldsymbol{\\sigma}_{n+1},\\boldsymbol{\\varepsilon}^{p}_{n+1},\\kappa_{n+1}) = (\\boldsymbol{\\sigma}^{\\mathrm{tr}},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$. Otherwise, enforce consistency $f(\\boldsymbol{\\sigma}_{n+1},\\kappa_{n+1})=0$ and backward-Euler flow to obtain\n$$\n\\left(\\mathbf{I} + \\Delta\\gamma\\,\\mathbf{C}\\,\\mathbf{P}\\right)\\,\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}.\n}\n$$\nThis yields $\\boldsymbol{\\sigma}_{n+1}$ as a function of $\\Delta\\gamma$ by solving a linear system, and reduces the plastic correction to a scalar nonlinear equation for $\\Delta\\gamma$:\n$$\ng(\\Delta\\gamma) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) - \\tfrac{1}{2}\\left(\\sigma_{0} + H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right)^{2} = 0.\n$$\nSolve for $\\Delta\\gamma$ using a robust Newton-type method with line search, using that $g'( \\Delta\\gamma )$ can be derived from implicit differentiation of the linear system. Then set $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta\\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}$, update $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\boldsymbol{\\varepsilon}^{p}$, and $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$.\n\nParameter values and units. Use the following numerical parameters and units consistently:\n- Young’s modulus $E = 210000$ in megapascals (MPa), Poisson’s ratio $\\nu = 0.30$, so that $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$.\n- Initial yield stress $\\sigma_{0} = 250$ in MPa, isotropic hardening modulus $H^{\\mathrm{iso}} = 1000$ in MPa.\n- Hill anisotropy coefficients $F_{a}=0.6$, $G_{a}=0.4$, $H_{a}=0.8$, $L_{a}=1.0$, $M_{a}=0.9$, $N_{a}=1.1$ (dimensionless).\n- All strains are dimensionless; all stresses must be reported in MPa.\n\nInitialization. For all test cases, assume the previous step state is $\\boldsymbol{\\sigma}_{n}=\\mathbf{0}$, $\\boldsymbol{\\varepsilon}^{p}_{n}=\\mathbf{0}$, and $\\kappa_{n}=0$.\n\nTest suite. Implement your program to process the following five strain increments (in the stated Voigt order, tensorial shear components), each producing one result:\n- Case A (elastic small mixed normal increment): $\\Delta \\boldsymbol{\\varepsilon} = [1.0\\times 10^{-6},\\,-2.0\\times 10^{-7},\\,4.0\\times 10^{-7},\\,0,\\,0,\\,0]$.\n- Case B (dominant uniaxial normal increment along $11$): $\\Delta \\boldsymbol{\\varepsilon} = [1.0\\times 10^{-3},\\,0,\\,0,\\,0,\\,0,\\,0]$.\n- Case C (pure shear in $12$): $\\Delta \\boldsymbol{\\varepsilon} = [0,\\,0,\\,0,\\,0,\\,0,\\,5.0\\times 10^{-3}]$.\n- Case D (zero increment, boundary): $\\Delta \\boldsymbol{\\varepsilon} = [0,\\,0,\\,0,\\,0,\\,0,\\,0]$.\n- Case E (large hydrostatic increment): $\\Delta \\boldsymbol{\\varepsilon} = [1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,0,\\,0,\\,0]$.\n\nRequired outputs and units. For each case, compute and return a list of eight floats:\n- The updated Cauchy stress components $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12}]$ in MPa,\n- The updated hardening variable $\\kappa_{n+1}$ (dimensionless),\n- The plastic multiplier increment $\\Delta\\gamma$ (dimensionless).\nAll eight values are to be reported in the order $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12},\\kappa_{n+1},\\Delta\\gamma]$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case contributes its own sub-list of eight decimal numbers. For example, the output must look like\n$[\\,[\\dots 8\\ \\text{floats for Case A}\\dots],\\,[\\dots 8\\ \\text{floats for Case B}\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$\nwith no spaces. Express all stresses in MPa, and return decimal numbers. Angles are not involved in this problem.", "solution": "We derive a backward-Euler return-mapping algorithm for the Hill 1948 anisotropic yield function using only fundamental continuum mechanics and convex analysis for rate-independent plasticity.\n\n1. Fundamental base and constitutive structure. Under small strain, the additivity of strains states $\\Delta \\boldsymbol{\\varepsilon} = \\Delta \\boldsymbol{\\varepsilon}^{e} + \\Delta \\boldsymbol{\\varepsilon}^{p}$. Linear isotropic elasticity relates Cauchy stress and elastic strain as $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}^{e} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e}) \\mathbf{I}$. In Voigt notation with tensorial shear components and ordering $[11,22,33,23,13,12]$, the elastic stiffness matrix $\\mathbf{C}$ has the normal block with $\\lambda + 2\\mu$ on the diagonal and $\\lambda$ off-diagonal and the shear diagonal entries equal to $2\\mu$.\n\n2. Hill’s quadratic yield and its gradient. Hill 1948 proposes a quadratic anisotropic form in the principal stress differences and shear stresses. Introducing a symmetric positive-definite matrix $\\mathbf{P}$ encoding anisotropy, the yield function is\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}^{T}\\mathbf{P}\\boldsymbol{\\sigma} - \\tfrac{1}{2}R(\\kappa)^{2} \\le 0,\n$$\nwith $R(\\kappa)=\\sigma_{0}+H^{\\mathrm{iso}}\\kappa$. The gradient with respect to stress is\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\mathbf{P}\\,\\boldsymbol{\\sigma},\n$$\nbecause the derivative of a quadratic form $\\tfrac{1}{2}\\boldsymbol{\\sigma}^{T}\\mathbf{P}\\boldsymbol{\\sigma}$ is $\\mathbf{P}\\boldsymbol{\\sigma}$. For the canonical Hill coefficients $F_{a},G_{a},H_{a},L_{a},M_{a},N_{a}$, the $\\mathbf{P}$ matrix explicitly reads\n$$\n\\mathbf{P} =\n\\begin{bmatrix}\nG_{a}+H_{a} & -H_{a} & -G_{a} & 0 & 0 & 0\\\\\n-H_{a} & F_{a}+H_{a} & -F_{a} & 0 & 0 & 0\\\\\n-G_{a} & -F_{a} & F_{a}+G_{a} & 0 & 0 & 0\\\\\n0 & 0 & 0 & 2L_{a} & 0 & 0\\\\\n0 & 0 & 0 & 0 & 2M_{a} & 0\\\\\n0 & 0 & 0 & 0 & 0 & 2N_{a}\n\\end{bmatrix}.\n$$\n\n3. Associated flow and hardening. Rate-independent plasticity with associated flow posits $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\partial f/\\partial \\boldsymbol{\\sigma}$, so with Hill’s form,\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}.\n$$\nThe internal scalar hardening variable is taken as $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$, and the radius is $R_{n+1}=\\sigma_{0}+H^{\\mathrm{iso}}\\kappa_{n+1}$.\n\n4. Backward-Euler stress update. Consider a step from $(\\boldsymbol{\\sigma}_{n},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$ under a given total strain increment $\\Delta \\boldsymbol{\\varepsilon}$. First form the elastic predictor\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}.\n$$\nEvaluate the trial yield $f^{\\mathrm{tr}}=f(\\boldsymbol{\\sigma}^{\\mathrm{tr}},\\kappa_{n})$. If $f^{\\mathrm{tr}}\\le 0$, the step is elastic and $\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{\\mathrm{tr}}$, $\\boldsymbol{\\varepsilon}^{p}_{n+1}=\\boldsymbol{\\varepsilon}^{p}_{n}$, and $\\kappa_{n+1}=\\kappa_{n}$.\n\nIf $f^{\\mathrm{tr}}>0$, plastic flow occurs and the plastic corrector must enforce the flow rule and consistency at the end of the step. Discretizing the flow with backward-Euler gives\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1},\\quad \\text{so}\\quad\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}^{p}\n= \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta \\gamma\\,\\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}.\n$$\nRearranging yields the linear system\n$$\n\\left(\\mathbf{I} + \\Delta\\gamma\\,\\mathbf{C}\\,\\mathbf{P}\\right)\\,\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}},\n$$\nwhich, for any fixed $\\Delta\\gamma\\ge 0$, determines $\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)$ by solving a symmetric positive-definite linear system since $\\mathbf{C}$ and $\\mathbf{P}$ are positive-definite.\n\n5. Consistency condition as scalar equation. Enforce the yield condition at the end of the step,\n$$\ng(\\Delta\\gamma) \\equiv f\\left(\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma),\\,\\kappa_{n}+\\Delta\\gamma\\right) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) - \\tfrac{1}{2}\\left(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right)^{2} = 0.\n$$\nThis is a scalar nonlinear equation in $\\Delta\\gamma$. To solve it robustly by Newton’s method, compute its derivative by implicit differentiation. Denote $\\mathbf{A}(\\Delta\\gamma) = \\mathbf{I} + \\Delta\\gamma\\,\\mathbf{C}\\,\\mathbf{P}$ and note that\n$$\n\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) = \\mathbf{A}(\\Delta\\gamma)^{-1}\\,\\boldsymbol{\\sigma}^{\\mathrm{tr}}.\n$$\nDifferentiate $\\mathbf{A}\\,\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ with respect to $\\Delta\\gamma$ to obtain\n$$\n\\frac{d\\boldsymbol{\\sigma}_{n+1}}{d\\Delta\\gamma} = -\\mathbf{A}(\\Delta\\gamma)^{-1}\\,\\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma).\n$$\nThen\n$$\ng'(\\Delta\\gamma) = \\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\mathbf{P}\\,\\frac{d\\boldsymbol{\\sigma}_{n+1}}{d\\Delta\\gamma} - H^{\\mathrm{iso}}\\left(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right),\n$$\nwhich, substituting the expression for $d\\boldsymbol{\\sigma}_{n+1}/d\\Delta\\gamma$, yields\n$$\ng'(\\Delta\\gamma) = -\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\,\\mathbf{P}\\,\\mathbf{A}(\\Delta\\gamma)^{-1}\\,\\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) - H^{\\mathrm{iso}}\\left(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right).\n$$\nThis derivative can be computed by solving the auxiliary linear system $\\mathbf{A}(\\Delta\\gamma)\\,\\mathbf{w} = \\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)$ and then evaluating $g'(\\Delta\\gamma) = -\\,\\boldsymbol{\\sigma}_{n+1}^{T}\\mathbf{P}\\,\\mathbf{w} - H^{\\mathrm{iso}}(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma))$.\n\n6. Algorithmic steps. The complete algorithm for one increment is:\n- Given $(\\boldsymbol{\\sigma}_{n},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$ and $\\Delta \\boldsymbol{\\varepsilon}$, compute $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}$ and $f^{\\mathrm{tr}} = \\tfrac{1}{2}\\boldsymbol{\\sigma}^{\\mathrm{tr}T}\\mathbf{P}\\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\tfrac{1}{2}(\\sigma_{0}+H^{\\mathrm{iso}}\\kappa_{n})^{2}$.\n- If $f^{\\mathrm{tr}} \\le 0$, set $\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{\\mathrm{tr}}$, $\\boldsymbol{\\varepsilon}^{p}_{n+1}=\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\kappa_{n+1}=\\kappa_{n}$.\n- Else, initialize $\\Delta\\gamma^{(0)}=0$. For $k=0,1,2,\\dots$ until convergence:\n  1. Form $\\mathbf{A}^{(k)}=\\mathbf{I}+\\Delta\\gamma^{(k)}\\mathbf{C}\\mathbf{P}$.\n  2. Solve $\\mathbf{A}^{(k)}\\boldsymbol{\\sigma}^{(k)} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$.\n  3. Evaluate $g^{(k)} = \\tfrac{1}{2}\\boldsymbol{\\sigma}^{(k)T}\\mathbf{P}\\boldsymbol{\\sigma}^{(k)} - \\tfrac{1}{2}(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma^{(k)}))^{2}$.\n  4. Solve $\\mathbf{A}^{(k)}\\mathbf{w}^{(k)} = \\mathbf{C}\\mathbf{P}\\boldsymbol{\\sigma}^{(k)}$ and compute $g'^{(k)} = -\\,\\boldsymbol{\\sigma}^{(k)T}\\mathbf{P}\\mathbf{w}^{(k)} - H^{\\mathrm{iso}}(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma^{(k)}))$.\n  5. Update by a safeguarded Newton step with line search: propose $\\Delta\\gamma^{\\mathrm{trial}}=\\Delta\\gamma^{(k)} - g^{(k)}/g'^{(k)}$. If $\\Delta\\gamma^{\\mathrm{trial}}<0$ or does not reduce $|g|$, backtrack along the Newton step until $|g|$ decreases and $\\Delta\\gamma\\ge 0$.\n  6. Check convergence $|g^{(k)}|$ below a tolerance relative to stress scale; if converged, set $\\Delta\\gamma=\\Delta\\gamma^{(k)}$, $\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{(k)}$.\n- Finally, compute the plastic strain increment $\\Delta \\boldsymbol{\\varepsilon}^{p}=\\Delta\\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}$, and update $\\boldsymbol{\\varepsilon}^{p}_{n+1}=\\boldsymbol{\\varepsilon}^{p}_{n}+\\Delta \\boldsymbol{\\varepsilon}^{p}$ and $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$.\n\n7. Units and mapping. With $E$ in megapascals (MPa) and strains dimensionless, the computed stresses are in MPa. The tensorial shear convention is essential: with this choice, the shear entries of $\\mathbf{C}$ are $2\\mu$ and those of $\\mathbf{P}$ are $2L_{a},2M_{a},2N_{a}$, consistent with $\\sigma_{12}=2\\mu\\,\\varepsilon_{12}$ and $\\partial f/\\partial \\sigma_{12}=2N_{a}\\sigma_{12}$.\n\n8. Test suite rationale. The five cases probe:\n- A: small mixed normal increment, expected elastic ($f^{\\mathrm{tr}}<0$).\n- B: large normal increment along $11$, expected plastic ($f^{\\mathrm{tr}}>0$).\n- C: large pure shear in $12$, expected plastic with anisotropy influence via $N_{a}$.\n- D: zero increment, boundary case ($\\Delta\\gamma=0$).\n- E: large hydrostatic increment, expected elastic because Hill’s function depends only on deviatoric-like combinations.\n\n9. Program output. For each case, report $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12},\\kappa_{n+1},\\Delta\\gamma]$ as decimal floats in a single-line aggregated list, with stresses in MPa.\n\nThis procedure satisfies the backward-Euler integration requirements, enforces anisotropic yielding via Hill’s quadratic, and uses only fundamental, well-tested relations to derive the algorithm without shortcuts. The Newton iteration exploits the convexity and monotonicity of the consistency function to ensure robust convergence.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef hill_P(Fa, Ga, Ha, La, Ma, Na):\n    \"\"\"\n    Build the 6x6 Hill anisotropy matrix P in Voigt order [11,22,33,23,13,12]\n    with tensorial shear components.\n    \"\"\"\n    P = np.zeros((6, 6), dtype=float)\n    # Normal-normal block\n    P[0, 0] = Ga + Ha\n    P[0, 1] = -Ha\n    P[0, 2] = -Ga\n\n    P[1, 0] = -Ha\n    P[1, 1] = Fa + Ha\n    P[1, 2] = -Fa\n\n    P[2, 0] = -Ga\n    P[2, 1] = -Fa\n    P[2, 2] = Fa + Ga\n\n    # Shear components (tensorial shear)\n    P[3, 3] = 2.0 * La\n    P[4, 4] = 2.0 * Ma\n    P[5, 5] = 2.0 * Na\n\n    return P\n\ndef isotropic_C(E, nu):\n    \"\"\"\n    Build the 6x6 isotropic elasticity matrix C in Voigt order [11,22,33,23,13,12]\n    for tensorial shear components (sigma_12 = 2 mu * eps_12).\n    \"\"\"\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    mu = E / (2.0 * (1.0 + nu))\n    C = np.zeros((6, 6), dtype=float)\n    # Normal-normal block\n    for i in range(3):\n        for j in range(3):\n            C[i, j] = lam\n        C[i, i] += 2.0 * mu\n    # Shear block\n    C[3, 3] = 2.0 * mu\n    C[4, 4] = 2.0 * mu\n    C[5, 5] = 2.0 * mu\n    return C\n\ndef yield_radius(sig0, Hiso, kappa):\n    return sig0 + Hiso * kappa\n\ndef yield_function(sig, P, sig0, Hiso, kappa):\n    \"\"\"Hill yield function f = 0.5 sig^T P sig - 0.5 R(kappa)^2.\"\"\"\n    R = yield_radius(sig0, Hiso, kappa)\n    return 0.5 * float(sig.T @ P @ sig) - 0.5 * (R * R)\n\ndef plastic_update_be(sig_n, epsp_n, kappa_n, De, P, sig0, Hiso, deps,\n                      newton_tol=1e-10, max_iter=50):\n    \"\"\"\n    Backward-Euler update for one increment:\n    Inputs:\n      sig_n: previous stress (6,)\n      epsp_n: previous plastic strain (6,)\n      kappa_n: previous hardening variable (scalar)\n      De: elastic stiffness 6x6\n      P: Hill anisotropy 6x6\n      sig0: initial yield stress\n      Hiso: isotropic hardening modulus\n      deps: total strain increment (6,)\n    Returns:\n      sig_np1, epsp_np1, kappa_np1, dgamma\n    \"\"\"\n    # Elastic predictor\n    sig_tr = sig_n + De @ deps\n    f_tr = yield_function(sig_tr, P, sig0, Hiso, kappa_n)\n    if f_tr <= 0.0:\n        # Elastic step\n        return sig_tr, epsp_n.copy(), float(kappa_n), 0.0\n\n    # Plastic step: solve for dgamma >= 0\n    dgamma = 0.0  # initial guess\n    # Newton with simple backtracking\n    I6 = np.eye(6)\n    Rn = yield_radius(sig0, Hiso, kappa_n)\n    # Use a better initial guess based on local linearization at gamma=0\n    # g(0) = f_tr; g'(0) = - sig_tr^T P (De P sig_tr) - Hiso * Rn\n    DeP_sigtr = De @ (P @ sig_tr)\n    g0 = f_tr\n    gp0 = - float(sig_tr.T @ (P @ DeP_sigtr)) - Hiso * Rn\n    if gp0 < 0.0:\n        dgamma = max(0.0, -g0 / gp0)\n    else:\n        dgamma = 0.0\n\n    def solve_A(gamma, rhs):\n        A = I6 + gamma * (De @ P)\n        return np.linalg.solve(A, rhs)\n\n    # Newton iterations\n    for _ in range(max_iter):\n        # Solve for sigma(gamma)\n        sig = solve_A(dgamma, sig_tr)\n        Rk = yield_radius(sig0, Hiso, kappa_n + dgamma)\n        g = 0.5 * float(sig.T @ (P @ sig)) - 0.5 * (Rk * Rk)\n        if abs(g) < newton_tol * max(Rn * Rn, 1.0):\n            # Converged\n            break\n        # Compute derivative: need w = A^{-1} (De P sig)\n        w_rhs = De @ (P @ sig)\n        w = solve_A(dgamma, w_rhs)\n        gp = - float(sig.T @ (P @ w)) - Hiso * (yield_radius(sig0, Hiso, kappa_n + dgamma))\n        # Safeguarded step\n        if gp == 0.0:\n            step = 0.0\n        else:\n            step = - g / gp\n        # Backtracking line search to keep gamma >= 0 and reduce |g|\n        alpha = 1.0\n        success = False\n        for _ls in range(20):\n            dgamma_trial = dgamma + alpha * step\n            if dgamma_trial < 0.0:\n                alpha *= 0.5\n                continue\n            sig_trial = solve_A(dgamma_trial, sig_tr)\n            Rk_trial = yield_radius(sig0, Hiso, kappa_n + dgamma_trial)\n            g_trial = 0.5 * float(sig_trial.T @ (P @ sig_trial)) - 0.5 * (Rk_trial * Rk_trial)\n            if abs(g_trial) < abs(g) * (1.0 - 1e-4 * alpha):\n                dgamma = dgamma_trial\n                success = True\n                break\n            alpha *= 0.5\n        if not success:\n            # Fallback: take small positive step if possible\n            dgamma = max(0.0, dgamma + max(min(step, 1.0), -0.5))\n    # Final state\n    sig_np1 = solve_A(dgamma, sig_tr)\n    depsp = dgamma * (P @ sig_np1)\n    epsp_np1 = epsp_n + depsp\n    kappa_np1 = kappa_n + dgamma\n    return sig_np1, epsp_np1, float(kappa_np1), float(dgamma)\n\ndef solve():\n    # Material parameters (MPa, dimensionless)\n    E = 210000.0\n    nu = 0.30\n    sig0 = 250.0\n    Hiso = 1000.0\n\n    # Hill 1948 anisotropy coefficients (dimensionless)\n    Fa = 0.6\n    Ga = 0.4\n    Ha = 0.8  # Hill's H coefficient\n    La = 1.0\n    Ma = 0.9\n    Na = 1.1\n\n    # Build matrices\n    C = isotropic_C(E, nu)\n    P = hill_P(Fa, Ga, Ha, La, Ma, Na)\n\n    # Initial state\n    sig_n = np.zeros(6, dtype=float)\n    epsp_n = np.zeros(6, dtype=float)\n    kappa_n = 0.0\n\n    # Define the test cases (tensorial shear Voigt components)\n    test_cases = [\n        # Case A: elastic small mixed normal increment\n        np.array([1.0e-6, -2.0e-7, 4.0e-7, 0.0, 0.0, 0.0], dtype=float),\n        # Case B: dominant uniaxial normal increment along 11\n        np.array([1.0e-3, 0.0, 0.0, 0.0, 0.0, 0.0], dtype=float),\n        # Case C: pure shear in 12\n        np.array([0.0, 0.0, 0.0, 0.0, 0.0, 5.0e-3], dtype=float),\n        # Case D: zero increment\n        np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0], dtype=float),\n        # Case E: large hydrostatic increment\n        np.array([1.0e-3, 1.0e-3, 1.0e-3, 0.0, 0.0, 0.0], dtype=float),\n    ]\n\n    results_str = []\n    # Process each test case independently from the initial state\n    for deps in test_cases:\n        sig_np1, epsp_np1, kappa_np1, dgamma = plastic_update_be(\n            sig_n, epsp_n, kappa_n, C, P, sig0, Hiso, deps\n        )\n        # Prepare output: [sig11, sig22, sig33, sig23, sig13, sig12, kappa, dgamma]\n        out_vals = [\n            sig_np1[0], sig_np1[1], sig_np1[2], sig_np1[3], sig_np1[4], sig_np1[5],\n            kappa_np1, dgamma\n        ]\n        # Format with a reasonable number of decimals to ensure concise output\n        formatted = [\"{:.6f}\".format(v) for v in out_vals]\n        results_str.append(\"[\" + \",\".join(formatted) + \"]\")\n\n    # Final print statement in the exact required format (single line, no spaces)\n    print(\"[\" + \",\".join(results_str) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2866860"}]}