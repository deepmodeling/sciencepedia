{"hands_on_practices": [{"introduction": "Understanding how a structure can 'adapt' to a cyclic load is the essence of shakedown theory. The most direct way to grasp this concept is through a simple one-dimensional model. This first practice explores a classic scenario: a fully restrained bar subjected to a cyclic temperature change, represented by a fluctuation of $\\pm \\Delta T$. By following the logic of Melan's static shakedown theorem, you will derive the critical temperature range the bar can withstand without recurring plastic deformation, demonstrating how a beneficial time-independent residual stress state, $\\sigma^{r}$, allows the structure to achieve a purely elastic response after an initial plastic event [@problem_id:2916218].", "problem": "A prismatic, homogeneous, isotropic bar of length $L$ and constant cross-sectional area is fully restrained against axial displacement at both ends. The material obeys small-strain, rate-independent, linear elasticity with Young’s modulus $E$ until yielding in uniaxial tension/compression at a yield stress $\\sigma_{y}$, beyond which it is perfectly plastic. The bar has a constant linear coefficient of thermal expansion $\\alpha$. It is subjected to a spatially uniform, quasi-static temperature history $T(t)$ that cycles repeatedly and symmetrically between $-\\Delta T$ and $+\\Delta T$ about a reference temperature at which there are no initial stresses.\n\nUsing the static shakedown theorem of Melan and the idea of superposing a time-independent residual stress field, proceed as follows:\n\n- Let $\\sigma^{e}(t)$ denote the elastic stress field that would arise under the given thermal loading if plastic strain were constrained to be zero at all times, subject to axial compatibility with fully fixed ends. Let $\\sigma^{r}$ be a time-independent residual stress, assumed uniform over the bar cross-section and constant along the bar’s length. Require that the stress field $\\sigma^{e}(t)+\\sigma^{r}$ remains within the elastic domain for all times during the cycle by enforcing $|\\sigma^{e}(t)+\\sigma^{r}|\\le \\sigma_{y}$ at every time.\n\n- Derive the largest temperature amplitude $\\Delta T_{\\text{crit}}$ such that there exists at least one constant $\\sigma^{r}$ for which the above condition holds for the entire symmetric cycle $T(t)\\in[-\\Delta T,\\,+\\Delta T]$. Your derivation must start from basic kinematics and constitutive relations and must not assume any specialized formula beyond the statement of the shakedown condition.\n\nExpress your final answer for $\\Delta T_{\\text{crit}}$ as a single closed-form analytic expression in terms of $E$, $\\sigma_{y}$, and $\\alpha$. The final result must be written without units, but for interpretation, $\\Delta T_{\\text{crit}}$ is to be expressed in Kelvin.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in the field of thermo-elasto-plasticity and structural mechanics, specifically concerning the application of Melan's static shakedown theorem. All necessary information is provided, and the objective is clear and formalizable. We shall proceed with the derivation.\n\nThe problem requires finding the largest temperature amplitude $\\Delta T_{\\text{crit}}$ for which a uniaxially loaded bar, fully restrained at its ends, will shakedown. Shakedown implies that after a finite period of initial plastic deformation, the structure's response becomes purely elastic, and plastic strain accumulation ceases. Melan's static shakedown theorem provides the condition for this to occur. The theorem states that shakedown occurs if it is possible to find a time-independent, self-equilibrating residual stress field, $\\sigma^{r}$, such that the sum of this residual stress and the purely elastic stress solution, $\\sigma^{e}(t)$, everywhere satisfies the yield criterion for all variations of the applied load.\n\nFirst, we must determine the purely elastic stress field, $\\sigma^{e}(t)$. The bar is fully restrained, which means the total axial strain, $\\epsilon_{\\text{total}}$, must be zero at all times.\nThe total strain is the sum of the elastic strain ($\\epsilon^{e}$), plastic strain ($\\epsilon^{p}$), and thermal strain ($\\epsilon^{th}$):\n$$ \\epsilon_{\\text{total}} = \\epsilon^{e} + \\epsilon^{p} + \\epsilon^{th} $$\nSince the bar is fixed at both ends, the total elongation is zero, and thus $\\epsilon_{\\text{total}} = 0$.\nThe problem asks for the purely elastic stress response, which is a hypothetical stress field computed by assuming the material behavior is purely elastic, i.e., by constraining the plastic strain to be zero ($\\epsilon^{p}=0$) for the purpose of this calculation.\nTherefore, the compatibility condition for the elastic analysis becomes:\n$$ \\epsilon^{e} + \\epsilon^{th} = 0 $$\nThe thermal strain is given by $\\epsilon^{th}(t) = \\alpha T(t)$, where $\\alpha$ is the coefficient of thermal expansion and $T(t)$ is the temperature change from the stress-free reference state.\nThe elastic strain is related to the elastic stress $\\sigma^{e}$ via Hooke's law for uniaxial stress: $\\epsilon^{e}(t) = \\frac{\\sigma^{e}(t)}{E}$, where $E$ is Young's modulus.\nSubstituting these constitutive relations into the compatibility equation yields:\n$$ \\frac{\\sigma^{e}(t)}{E} + \\alpha T(t) = 0 $$\nFrom this, we solve for the purely elastic stress as a function of temperature:\n$$ \\sigma^{e}(t) = -E \\alpha T(t) $$\nThe temperature $T(t)$ cycles symmetrically between $-\\Delta T$ and $+\\Delta T$. We can therefore determine the minimum and maximum values of the elastic stress during a cycle.\nThe maximum elastic stress, $\\sigma^{e}_{\\text{max}}$, occurs at the minimum temperature, $T = -\\Delta T$:\n$$ \\sigma^{e}_{\\text{max}} = -E \\alpha (-\\Delta T) = E \\alpha \\Delta T $$\nThis corresponds to a tensile stress.\nThe minimum elastic stress, $\\sigma^{e}_{\\text{min}}$, occurs at the maximum temperature, $T = +\\Delta T$:\n$$ \\sigma^{e}_{\\text{min}} = -E \\alpha (+\\Delta T) = -E \\alpha \\Delta T $$\nThis corresponds to a compressive stress.\n\nNow, we apply Melan's shakedown theorem. We superpose a time-independent, spatially uniform residual stress $\\sigma^{r}$ onto the elastic stress field. The total stress at any time is $\\sigma(t) = \\sigma^{e}(t) + \\sigma^{r}$. For shakedown to occur, this total stress must remain within the elastic domain for all time $t$. The yield criterion for the perfectly plastic material is $|\\sigma| \\le \\sigma_{y}$, where $\\sigma_{y}$ is the yield stress.\nThus, the shakedown condition is:\n$$ |\\sigma^{e}(t) + \\sigma^{r}| \\le \\sigma_{y} \\quad \\text{for all } t $$\nThis single inequality is equivalent to two conditions that must be satisfied simultaneously for all time:\n$$ -\\sigma_{y} \\le \\sigma^{e}(t) + \\sigma^{r} \\le \\sigma_{y} $$\nFor these inequalities to hold for the entire cycle, they must hold at the most critical points, which are the points of maximum and minimum elastic stress.\nThe first inequality, $\\sigma^{e}(t) + \\sigma^{r} \\le \\sigma_{y}$, is most stringent when $\\sigma^{e}(t)$ is maximum. So, we must satisfy:\n$$ \\sigma^{e}_{\\text{max}} + \\sigma^{r} \\le \\sigma_{y} \\quad (1) $$\nThe second inequality, $\\sigma^{e}(t) + \\sigma^{r} \\ge -\\sigma_{y}$, is most stringent when $\\sigma^{e}(t)$ is minimum. So, we must satisfy:\n$$ \\sigma^{e}_{\\text{min}} + \\sigma^{r} \\ge -\\sigma_{y} \\quad (2) $$\nThese two inequalities define a range for the possible values of the residual stress $\\sigma^{r}$:\nFrom $(1)$:\n$$ \\sigma^{r} \\le \\sigma_{y} - \\sigma^{e}_{\\text{max}} $$\nFrom $(2)$:\n$$ \\sigma^{r} \\ge -\\sigma_{y} - \\sigma^{e}_{\\text{min}} $$\nA valid residual stress $\\sigma^{r}$ exists if and only if the lower bound for $\\sigma^{r}$ is less than or equal to its upper bound:\n$$ -\\sigma_{y} - \\sigma^{e}_{\\text{min}} \\le \\sigma_{y} - \\sigma^{e}_{\\text{max}} $$\nRearranging this inequality to group the elastic and yield stresses, we get:\n$$ \\sigma^{e}_{\\text{max}} - \\sigma^{e}_{\\text{min}} \\le 2\\sigma_{y} $$\nThis is the fundamental condition for shakedown in a symmetric loading cycle. It states that the total range of the purely elastic stress, $\\Delta\\sigma^{e} = \\sigma^{e}_{\\text{max}} - \\sigma^{e}_{\\text{min}}$, must not exceed twice the yield stress.\nLet us now substitute our expressions for $\\sigma^{e}_{\\text{max}}$ and $\\sigma^{e}_{\\text{min}}$:\n$$ (E \\alpha \\Delta T) - (-E \\alpha \\Delta T) \\le 2\\sigma_{y} $$\n$$ 2 E \\alpha \\Delta T \\le 2\\sigma_{y} $$\nSimplifying this inequality gives the condition on the temperature amplitude $\\Delta T$ for shakedown to be possible:\n$$ E \\alpha \\Delta T \\le \\sigma_{y} $$\n$$ \\Delta T \\le \\frac{\\sigma_{y}}{E \\alpha} $$\nThe problem asks for the largest temperature amplitude, $\\Delta T_{\\text{crit}}$, for which shakedown can occur. This corresponds to the boundary case where the inequality becomes an equality.\nTherefore, the critical temperature amplitude is:\n$$ \\Delta T_{\\text{crit}} = \\frac{\\sigma_{y}}{E \\alpha} $$\nIf $\\Delta T > \\Delta T_{\\text{crit}}$, the range of elastic stress $2 E \\alpha \\Delta T$ will be greater than $2\\sigma_{y}$, and it becomes impossible to find a residual stress $\\sigma^r$ that keeps the total stress within the yield limits throughout the cycle. In this case, the structure will exhibit ratcheting or alternating plasticity, meaning plastic deformation will occur in every cycle, and shakedown will not be achieved.", "answer": "$$\\boxed{\\frac{\\sigma_{y}}{E \\alpha}}$$", "id": "2916218"}, {"introduction": "Having explored the role of residual stresses in a simple bar, we now advance to a more complex structural system and a deeper theoretical insight. The shakedown theorems offer two complementary viewpoints: the static (lower-bound) theorem of Melan, which guarantees safety, and the kinematic (upper-bound) theorem of Koiter, which predicts failure. This exercise on a portal frame demonstrates a powerful result where these two bounds precisely coincide, yielding the exact shakedown load multiplier $\\lambda_{\\mathrm{sh}}$ and revealing the inherent duality of the theory [@problem_id:2684276].", "problem": "Consider a single-bay, single-story rigid-jointed portal frame composed of two identical, prismatic columns of height $h$ connected by a rigid beam that has effectively infinite flexural strength. The material behaves as elastic–ideally plastic with a uniform fully plastic bending moment capacity $M_p$ at the potential plastic hinge locations at the tops and bases of both columns. Small displacement kinematics apply, and geometric nonlinearity can be neglected. There is no vertical gravity load.\n\nThe structure is subjected to a quasi-static, zero-mean, repeated horizontal point load applied at the beam level of the form $H(t)=\\lambda\\,H_0\\,s(t)$, where $H_0>0$ is a given reference load, $\\lambda>0$ is an unknown scalar load multiplier, and $s(t)$ is any bounded scalar function satisfying $-1\\le s(t)\\le 1$ for all time $t$ and taking all extreme values in that interval over repeated cycles. Assume associative, rate-independent plasticity with no hardening, and that plastic deformation localizes only as ideal plastic hinges at the column tops and bases.\n\nUsing only the fundamental kinematics of rigid-plastic mechanisms, the principle of virtual work, and the definitions of the Melan static shakedown theorem (lower bound) and the Koiter kinematic shakedown theorem (upper bound), do the following:\n\n- Construct a statically admissible, time-independent residual bending moment field that certifies shakedown by the Melan static shakedown theorem for some maximal $\\lambda$, and derive the corresponding lower bound on $\\lambda$.\n\n- Construct a kinematically admissible, single-parameter plastic mechanism with time-independent shape that is compatible with the frame and the loading set, and use the Koiter kinematic shakedown theorem to derive the corresponding upper bound on $\\lambda$.\n\nShow that the two bounds coincide for this frame and loading, and conclude the exact shakedown multiplier $\\lambda_{\\mathrm{sh}}$ as a closed-form expression in terms of $M_p$, $h$, and $H_0$.\n\nYour final answer must be the single analytic expression for $\\lambda_{\\mathrm{sh}}$. Express your final answer symbolically in terms of $M_p$, $h$, and $H_0$. Do not include units in the final boxed answer.", "solution": "To find the exact shakedown load multiplier $\\lambda_{\\mathrm{sh}}$, we will derive the lower and upper bounds using Melan's static theorem and Koiter's kinematic theorem, respectively, and show that they coincide.\n\nFirst, we perform an elastic analysis of the frame. The portal frame is symmetric, and the connecting beam is rigid. Therefore, the total horizontal load $H(t)$ is distributed equally as shear to the two columns, with each column carrying a shear force $V(t) = H(t)/2$. Since the columns are fixed at the base and their tops translate horizontally without rotation (due to the rigid beam), each column behaves as a beam fixed at both ends under a shear load. The bending moment at the top and base of such a column is identical, given by $M^E = Vh/2$. Substituting $V(t) = H(t)/2 = \\lambda H_0 s(t) / 2$, the elastic bending moment $M^E(t)$ at all four potential hinge locations is:\n$$ M^E(t) = \\frac{1}{2} \\left( \\frac{\\lambda H_0 s(t)}{2} \\right) h = \\frac{\\lambda H_0 h}{4} s(t) $$\nAs $s(t)$ cycles between -1 and 1, the elastic moment at each location ranges between a maximum $M^E_{\\max} = \\frac{\\lambda H_0 h}{4}$ and a minimum $M^E_{\\min} = -\\frac{\\lambda H_0 h}{4}$. The total range of the elastic moment is $\\Delta M^E = M^E_{\\max} - M^E_{\\min} = \\frac{\\lambda H_0 h}{2}$.\n\nNext, we apply Melan's static (lower-bound) theorem. It states that shakedown is guaranteed if a time-independent, self-equilibrated residual moment field $M^r$ exists such that the total moment $M(t) = M^E(t) + M^r$ remains within the plastic limit, $|M(t)| \\le M_p$, at all times. For this to hold over the entire cycle, it must hold at the extremes:\n$$ M^E_{\\max} + M^r \\le M_p \\quad \\text{and} \\quad M^E_{\\min} + M^r \\ge -M_p $$\nFor a valid $M^r$ to exist, the lower bound for $M^r$ must be less than or equal to its upper bound: $-M_p - M^E_{\\min} \\le M_p - M^E_{\\max}$. Rearranging gives the shakedown condition on the elastic moment range:\n$$ M^E_{\\max} - M^E_{\\min} \\le 2M_p \\implies \\Delta M^E \\le 2M_p $$\nSubstituting our expression for $\\Delta M^E$:\n$$ \\frac{\\lambda H_0 h}{2} \\le 2M_p \\implies \\lambda \\le \\frac{4 M_p}{H_0 h} $$\nThis shows that for any $\\lambda$ satisfying this condition, a suitable $M^r$ can be found (in this case, $M^r=0$). Therefore, the shakedown limit must be at least this large, giving the lower bound:\n$$ \\lambda_{\\mathrm{sh}} \\ge \\frac{4 M_p}{H_0 h} $$\n\nNow, we apply Koiter's kinematic (upper-bound) theorem. It states that shakedown is impossible if, for any kinematically admissible plastic mechanism, the work done by the elastic stresses over a plastic strain cycle exceeds the internal energy dissipated. For a zero-mean load, the critical failure mode is often alternating plasticity. Consider a mechanism involving a plastic rotation cycle $(\\Delta\\theta_p, -\\Delta\\theta_p)$ at any one of the four potential hinges. The energy dissipated in one cycle is $D = M_p |\\Delta\\theta_p| + M_p |-\\Delta\\theta_p| = 2M_p \\Delta\\theta_p$. The maximum work done by the elastic moment on this cycle occurs when the plastic rotations are synchronized with the peak moments: $W_{\\max} = M^E_{\\max}(\\Delta\\theta_p) + M^E_{\\min}(-\\Delta\\theta_p) = (M^E_{\\max} - M^E_{\\min})\\Delta\\theta_p = \\Delta M^E \\Delta\\theta_p$. Failure is guaranteed if $W_{\\max} \\ge D$:\n$$ \\Delta M^E \\Delta\\theta_p \\ge 2M_p \\Delta\\theta_p \\implies \\Delta M^E \\ge 2M_p $$\nSubstituting the expression for $\\Delta M^E$:\n$$ \\frac{\\lambda H_0 h}{2} \\ge 2M_p \\implies \\lambda \\ge \\frac{4 M_p}{H_0 h} $$\nThis gives an upper bound on the shakedown limit; failure is certain if $\\lambda$ meets or exceeds this value:\n$$ \\lambda_{\\mathrm{sh}} \\le \\frac{4 M_p}{H_0 h} $$\n\nThe lower bound from Melan's theorem and the upper bound from Koiter's theorem coincide. Therefore, the exact shakedown multiplier is:\n$$ \\lambda_{\\mathrm{sh}} = \\frac{4 M_p}{H_0 h} $$\nThis value corresponds to the elastic limit of the structure, where the maximum elastic moment equals the plastic moment capacity. For this particular problem with zero-mean cyclic loading, there is no domain of load multipliers where limited plasticity can lead to a favorable residual stress state and subsequent elastic shakedown. Failure occurs by alternating plasticity as soon as the elastic limit is reached.", "answer": "$$\\boxed{\\frac{4 M_p}{H_0 h}}$$", "id": "2684276"}, {"introduction": "While analytical solutions are invaluable for understanding fundamental principles, real-world engineering structures are often too complex for manual calculation. This final practice bridges the gap between theory and modern computational practice by formulating a shakedown problem with a load factor $\\lambda$. You will learn to formulate the static shakedown problem as a mathematical optimization problem, in this case, a Linear Program (LP). This powerful technique, which involves discretizing a structure's residual stress $r$ and its loads, allows for the automatic computation of shakedown limits and is a cornerstone of advanced structural integrity assessment [@problem_id:2916223].", "problem": "Consider the static (lower-bound) shakedown verification based on the Melan theorem formulated on a discretized stress space. Let a structure be represented by a vector of stress resultants $s \\in \\mathbb{R}^n$ and a time-independent residual stress $r \\in \\mathbb{R}^n$. Let the admissible stress domain be the polyhedral set $\\{s \\in \\mathbb{R}^n : \\lvert s_i \\rvert \\le \\sigma_y, \\, i = 1,\\dots,n\\}$ for a given yield limit $\\sigma_y \\gt 0$ (this is the infinity-norm Tresca-type approximation). Let the equilibrium of the residual stress be represented by a full-rank linear operator $E \\in \\mathbb{R}^{q \\times n}$ such that admissible residual stresses satisfy $E r = 0$. Let the load vary in a convex, compact set whose extreme points are represented by $m$ elastic stress influence vectors $\\{p^{(k)} \\in \\mathbb{R}^n\\}_{k=1}^m$. For a load factor $\\lambda \\ge 0$, the Melan static shakedown condition requires the existence of a residual stress $r$ such that for every extreme load $k \\in \\{1,\\dots,m\\}$,\n$$\nr + \\lambda \\, p^{(k)} \\in \\{s \\in \\mathbb{R}^n : \\lvert s_i \\rvert \\le \\sigma_y, \\, i=1,\\dots,n\\},\n\\quad \\text{and} \\quad E r = 0.\n$$\nBy linearity and convexity, it suffices to check the inequalities at the finite set of extremes.\n\nTask:\n- Derive, from first principles, a linear programming formulation that computes the maximum shakedown load factor $\\lambda^\\star$ and, among all residual stresses that achieve $\\lambda^\\star$, selects a residual stress of minimum $\\ell_1$-norm. You must do so by:\n  1. Formulating a linear program in variables $(r,\\lambda)$ that maximizes $\\lambda$ under equilibrium and yield constraints at the $m$ given load extremes.\n  2. Formulating a second linear program in variables $(r,t)$ that, with $\\lambda$ fixed at the optimal value $\\lambda^\\star$, minimizes $\\sum_{i=1}^n t_i$ subject to $t_i \\ge \\lvert r_i \\rvert$, the same equilibrium constraint, and the same yield constraints evaluated at $\\lambda^\\star$.\n- Your program must implement both linear programs using only the data $(\\sigma_y, E, \\{p^{(k)}\\}_{k=1}^m)$.\n\nMathematical formulation requirements to be encoded by your program:\n- Use residual stress $r \\in \\mathbb{R}^n$ and load factor $\\lambda \\in \\mathbb{R}$ as decision variables for the first linear program. Impose $\\lambda \\ge 0$. For each extreme $k \\in \\{1,\\dots,m\\}$ and component $i \\in \\{1,\\dots,n\\}$, enforce the yield admissibility by the pair of linear inequalities\n$$\nr_i + \\lambda \\, p^{(k)}_i \\le \\sigma_y, \\qquad -r_i - \\lambda \\, p^{(k)}_i \\le \\sigma_y,\n$$\nand impose equilibrium by $E r = 0$. Maximize $\\lambda$.\n- For the second linear program, fix $\\lambda = \\lambda^\\star$ and introduce auxiliary variables $t \\in \\mathbb{R}^n$ with $t_i \\ge 0$ and\n$$\nr_i - t_i \\le 0, \\qquad -r_i - t_i \\le 0,\n$$\nwhich together imply $t_i \\ge \\lvert r_i \\rvert$. Minimize $\\sum_{i=1}^n t_i$ subject to these constraints, $E r = 0$, and the same yield constraints with $\\lambda$ replaced by $\\lambda^\\star$.\n\nImplementation and output:\n- Implement a program that, for each test case below, returns the pair $[\\lambda^\\star, \\|r^\\star\\|_1]$, where $\\lambda^\\star$ is the optimal load factor of the first linear program and $\\|r^\\star\\|_1$ is the optimal value of $\\sum_{i=1}^n t_i$ from the second linear program at $\\lambda^\\star$.\n- Your program must output a single line containing the results as a comma-separated list of lists, one per test case, with each floating-point number rounded to $6$ decimal places, for example, $\\big[\\,[\\lambda_1^\\star,\\|r_1^\\star\\|_1],[\\lambda_2^\\star,\\|r_2^\\star\\|_1]\\,\\big]$.\n\nTest suite:\n- Use three cases, each specified by $(n,m,\\sigma_y,E,\\{p^{(k)}\\}_{k=1}^m)$:\n  1. Case A (happy path, symmetric extremes): $n = 2$, $m = 2$, $\\sigma_y = 1$, $E = \\begin{bmatrix} 1 & 1 \\end{bmatrix}$, $p^{(1)} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$, $p^{(2)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$.\n  2. Case B (scaling and coupling via equilibrium): $n = 2$, $m = 2$, $\\sigma_y = \\tfrac{3}{2}$, $E = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$, $p^{(1)} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$, $p^{(2)} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$.\n  3. Case C (asymmetric extremes requiring nontrivial residual stress): $n = 2$, $m = 2$, $\\sigma_y = 1$, $E = \\begin{bmatrix} 1 & 1 \\end{bmatrix}$, $p^{(1)} = \\begin{bmatrix} 2 \\\\ -1 \\end{bmatrix}$, $p^{(2)} = \\begin{bmatrix} -1 \\\\ 2 \\end{bmatrix}$.\n\nFinal output format:\n- The program must print exactly one line: a single list of three entries, each entry being the list $[\\lambda^\\star,\\|r^\\star\\|_1]$ for a case, with no spaces, and each number rounded to $6$ decimals, i.e., $\\big[\\,[\\lambda_A^\\star,\\|r_A^\\star\\|_1],[\\lambda_B^\\star,\\|r_B^\\star\\|_1],[\\lambda_C^\\star,\\|r_C^\\star\\|_1]\\,\\big]$.", "solution": "The Melan static shakedown theorem provides the basis for a direct computational method to find the maximum shakedown load factor, $\\lambda^\\star$. The theorem requires the existence of a time-independent, self-equilibrated residual stress field, $r$, such that the total stress, $r + \\lambda p$, remains within the yield domain for all load variations. For a discretized structure with a polyhedral yield surface, this can be formulated as a mathematical optimization problem.\n\nWe are given that the load varies within a convex set defined by $m$ extreme elastic stress vectors, $\\{p^{(k)}\\}$. The yield domain is given by the infinity-norm (Tresca-type) condition $|s_i| \\le \\sigma_y$ for each stress component $s_i$. The equilibrium for the residual stress is given by the linear system $Er=0$. The shakedown condition, $r + \\lambda p^{(k)} \\in Y$, must hold for all $k=1,\\dots,m$. This translates to the following set of linear inequalities for each component $i$ and each extreme load $k$:\n$$ |r_i + \\lambda p_i^{(k)}| \\le \\sigma_y \\iff \\begin{cases} r_i + \\lambda p_i^{(k)} \\le \\sigma_y \\\\ -r_i - \\lambda p_i^{(k)} \\le \\sigma_y \\end{cases} $$\n\n**Part 1: Maximizing the Load Factor $\\lambda$**\nTo find the maximum load factor $\\lambda^\\star$, we formulate a linear program (LP) with decision variables $r \\in \\mathbb{R}^n$ and $\\lambda \\in \\mathbb{R}$. The objective is to maximize $\\lambda$. The constraints are the equilibrium condition for $r$ and the yield conditions for all extreme loads.\n$$\n\\begin{aligned}\n\\lambda^\\star = \\max_{r, \\lambda} \\quad & \\lambda \\\\\n\\text{subject to} \\quad & E r = 0, \\\\\n& r_i + \\lambda p^{(k)}_i \\le \\sigma_y, \\quad \\forall i \\in \\{1,\\dots,n\\}, \\forall k \\in \\{1,\\dots,m\\}, \\\\\n& -r_i - \\lambda p^{(k)}_i \\le \\sigma_y, \\quad \\forall i \\in \\{1,\\dots,n\\}, \\forall k \\in \\{1,\\dots,m\\}, \\\\\n& \\lambda \\ge 0.\n\\end{aligned}\n$$\nSolving this LP yields the shakedown limit $\\lambda^\\star$.\n\n**Part 2: Finding the Minimum-Norm Residual Stress**\nAt the shakedown limit $\\lambda^\\star$, there may be a non-unique residual stress field $r$ that satisfies the constraints. The problem asks for the one with the minimum $\\ell_1$-norm, $\\|r\\|_1 = \\sum_{i=1}^n |r_i|$. The minimization of the $\\ell_1$-norm can be cast as an LP by introducing auxiliary variables $t \\in \\mathbb{R}^n$ such that $t_i \\ge |r_i|$ for all $i$. This is enforced by the linear inequalities $r_i \\le t_i$ and $-r_i \\le t_i$, along with $t_i \\ge 0$.\n\nWith $\\lambda^\\star$ fixed from the first LP, we solve a second LP to minimize $\\sum t_i$:\n$$\n\\begin{aligned}\n\\min_{r, t} \\quad & \\sum_{i=1}^n t_i \\\\\n\\text{subject to} \\quad & E r = 0, \\\\\n& r_i + \\lambda^\\star p^{(k)}_i \\le \\sigma_y, \\quad \\forall i \\in \\{1,\\dots,n\\}, \\forall k \\in \\{1,\\dots,m\\}, \\\\\n& -r_i - \\lambda^\\star p^{(k)}_i \\le \\sigma_y, \\quad \\forall i \\in \\{1,\\dots,n\\}, \\forall k \\in \\{1,\\dots,m\\}, \\\\\n& r_i - t_i \\le 0, \\quad \\forall i \\in \\{1,\\dots,n\\}, \\\\\n& -r_i - t_i \\le 0, \\quad \\forall i \\in \\{1,\\dots,n\\}, \\\\\n& t_i \\ge 0, \\quad \\forall i \\in \\{1,\\dots,n\\}.\n\\end{aligned}\n$$\nThe optimal value of this program is the minimum $\\ell_1$-norm of the residual stress, $\\|r^\\star\\|_1$, that achieves the shakedown limit $\\lambda^\\star$. The provided code implements these two sequential linear programs to compute the required values $[\\lambda^\\star, \\|r^\\star\\|_1]$ for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_case_sigma_E_P(sigma_y, E, P_list):\n    \"\"\"\n    Solve the two-stage shakedown LP:\n    Stage 1: maximize lambda subject to yield constraints at extremes and equilibrium E r = 0\n    Stage 2: with lambda* fixed, minimize ||r||_1 using standard LP linearization with t >= |r|\n    Inputs:\n        sigma_y: float > 0\n        E: (q, n) numpy array\n        P_list: list of m numpy arrays of shape (n,) representing elastic stress influence at extremes\n    Returns:\n        lambda_star: float\n        l1_min: float (sum of t_i at optimum, equals minimal ||r||_1)\n    \"\"\"\n    # Dimensions\n    n = P_list[0].shape[0]\n    m = len(P_list)\n    q = E.shape[0] if E is not None and E.size > 0 else 0\n\n    # Stage 1: LP in variables x = [r (n), lambda (1)]\n    # Build inequality constraints A_ub x <= b_ub for yield at each extreme\n    A_ub = []\n    b_ub = []\n    for k in range(m):\n        p_k = P_list[k].reshape(-1)\n        for i in range(n):\n            # r_i + lambda * p_k[i] <= sigma_y\n            row = np.zeros(n + 1)\n            row[i] = 1.0\n            row[-1] = p_k[i]\n            A_ub.append(row)\n            b_ub.append(sigma_y)\n            # -r_i - lambda * p_k[i] <= sigma_y\n            row = np.zeros(n + 1)\n            row[i] = -1.0\n            row[-1] = -p_k[i]\n            A_ub.append(row)\n            b_ub.append(sigma_y)\n    A_ub = np.array(A_ub) if A_ub else None\n    b_ub = np.array(b_ub) if b_ub else None\n\n    # Equality constraints: E r = 0\n    if q > 0:\n        A_eq = np.zeros((q, n + 1))\n        A_eq[:, :n] = E\n        b_eq = np.zeros(q)\n    else:\n        A_eq = None\n        b_eq = None\n\n    # Variable bounds: r free, lambda >= 0\n    bounds = [(None, None)] * n + [(0.0, None)]\n\n    # Objective: minimize -lambda\n    c = np.zeros(n + 1)\n    c[-1] = -1.0\n\n    res1 = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method=\"highs\")\n    if not res1.success:\n        # In unexpected failure cases, return NaNs to signal an issue.\n        return float(\"nan\"), float(\"nan\")\n\n    x_star = res1.x\n    lambda_star = x_star[-1]\n\n    # Stage 2: LP in variables y = [r (n), t (n)]\n    # Fix lambda = lambda_star in the yield constraints (becomes a constant RHS shift)\n    A_ub2 = []\n    b_ub2 = []\n\n    for k in range(m):\n        p_k = P_list[k].reshape(-1)\n        for i in range(n):\n            # r_i + lambda_star * p_k[i] <= sigma_y\n            row = np.zeros(2 * n)\n            row[i] = 1.0  # r_i\n            # no coefficient on t here\n            A_ub2.append(row)\n            b_ub2.append(sigma_y - lambda_star * p_k[i])\n            # -r_i - lambda_star * p_k[i] <= sigma_y  ->  -r_i <= sigma_y + lambda_star * p_k[i]\n            row = np.zeros(2 * n)\n            row[i] = -1.0  # -r_i\n            A_ub2.append(row)\n            b_ub2.append(sigma_y + lambda_star * p_k[i])\n\n    # Absolute value linearization: r_i - t_i <= 0 and -r_i - t_i <= 0, and t_i >= 0\n    for i in range(n):\n        row = np.zeros(2 * n)\n        row[i] = 1.0      # r_i\n        row[n + i] = -1.0 # -t_i\n        A_ub2.append(row)\n        b_ub2.append(0.0)\n\n        row = np.zeros(2 * n)\n        row[i] = -1.0     # -r_i\n        row[n + i] = -1.0 # -t_i\n        A_ub2.append(row)\n        b_ub2.append(0.0)\n\n    A_ub2 = np.array(A_ub2) if A_ub2 else None\n    b_ub2 = np.array(b_ub2) if b_ub2 else None\n\n    # Equality constraints: E r = 0\n    if q > 0:\n        A_eq2 = np.zeros((q, 2 * n))\n        A_eq2[:, :n] = E\n        b_eq2 = np.zeros(q)\n    else:\n        A_eq2 = None\n        b_eq2 = None\n\n    # Bounds: r free, t >= 0\n    bounds2 = [(None, None)] * n + [(0.0, None)] * n\n\n    # Objective: minimize sum t_i\n    c2 = np.zeros(2 * n)\n    c2[n:] = 1.0\n\n    res2 = linprog(c2, A_ub=A_ub2, b_ub=b_ub2, A_eq=A_eq2, b_eq=b_eq2, bounds=bounds2, method=\"highs\")\n    if not res2.success:\n        return float(lambda_star), float(\"nan\")\n\n    y_star = res2.x\n    t_star = y_star[n:]\n    l1_min = float(np.sum(t_star))\n\n    return float(lambda_star), float(l1_min)\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case A\n    sigma_A = 1.0\n    E_A = np.array([[1.0, 1.0]])\n    P_A = [np.array([1.0, 0.0]), np.array([0.0, 1.0])]\n\n    # Case B\n    sigma_B = 1.5\n    E_B = np.array([[1.0, -1.0]])\n    P_B = [np.array([1.0, 1.0]), np.array([1.0, -1.0])]\n\n    # Case C\n    sigma_C = 1.0\n    E_C = np.array([[1.0, 1.0]])\n    P_C = [np.array([2.0, -1.0]), np.array([-1.0, 2.0])]\n\n    test_cases = [\n        (sigma_A, E_A, P_A),\n        (sigma_B, E_B, P_B),\n        (sigma_C, E_C, P_C),\n    ]\n\n    results = []\n    for sigma_y, E, P_list in test_cases:\n        lam_star, l1_norm = solve_case_sigma_E_P(sigma_y, E, P_list)\n        # Round to 6 decimals for output\n        lam_star = float(np.round(lam_star, 6)) if np.isfinite(lam_star) else lam_star\n        l1_norm = float(np.round(l1_norm, 6)) if np.isfinite(l1_norm) else l1_norm\n        results.append((lam_star, l1_norm))\n\n    # Final print statement in the exact required format: no spaces, numbers with 6 decimals.\n    formatted = []\n    for lam, nrm in results:\n        if np.isnan(lam) or np.isnan(nrm):\n            # Represent NaNs in a consistent float format with 6 decimals\n            lam_str = \"nan\"\n            nrm_str = \"nan\"\n        else:\n            lam_str = f\"{lam:.6f}\"\n            nrm_str = f\"{nrm:.6f}\"\n        formatted.append(f\"[{lam_str},{nrm_str}]\")\n    print(f\"[[{formatted[0][1:-1]}],[{formatted[1][1:-1]}],[{formatted[2][1:-1]}]]\")\n\nsolve()\n```", "id": "2916223"}]}