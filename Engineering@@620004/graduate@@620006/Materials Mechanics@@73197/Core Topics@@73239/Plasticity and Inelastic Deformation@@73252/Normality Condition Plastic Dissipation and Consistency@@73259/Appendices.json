{"hands_on_practices": [{"introduction": "The consistency condition, $\\dot{f}=0$, is a mathematical statement that the stress state must remain on the yield surface during plastic flow. This exercise provides hands-on practice in applying this fundamental principle to a classic von Mises material model undergoing plastic deformation. By systematically combining the consistency condition with the flow rule and elastic law, you will derive the rate of the plastic multiplier, $\\dot{\\lambda}$, which governs the magnitude of plastic straining [@problem_id:2905738].", "problem": "A homogeneous, isotropic metal is modeled under small strains by linear elasticity combined with associated von Mises plasticity with linear isotropic hardening. The elastic moduli are given by Young’s modulus $E = 210$ GPa and Poisson’s ratio $\\nu = 0.30$. The hardening modulus is $H = 1.5$ GPa. The yield function is\n$$\nf(\\boldsymbol{\\sigma},\\alpha) = \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s}\\| - \\big(\\sigma_{y0} + H\\,\\alpha\\big),\n$$\nwhere $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\text{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ is the deviatoric Cauchy stress and $\\alpha$ is the equivalent plastic strain. The flow rule is associated, i.e.,\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}},\n$$\nand the hardening variable follows the von Mises definition\n$$\n\\dot{\\alpha} = \\sqrt{\\frac{2}{3}}\\,\\|\\dot{\\boldsymbol{\\varepsilon}}^{p}\\|.\n$$\n\nAt the current instant, the stress state is on the yield surface under homogeneous uniaxial tension, and plastic loading is continuing. A total strain rate is imposed as\n$$\n\\dot{\\boldsymbol{\\varepsilon}} = \n\\begin{pmatrix}\n\\dot{\\varepsilon} & 0 & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix},\n\\quad \\text{with } \\dot{\\varepsilon} = 1.0\\times 10^{-4}\\ \\text{s}^{-1}.\n$$\n\nUsing only the definitions above, the elastic law $\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C}:\\big(\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^{p}\\big)$ with isotropic linear elasticity, the normality condition, and the consistency condition $\\dot{f}=0$ during plastic loading, construct the flow direction and compute the plastic multiplier rate $\\dot{\\lambda}$ at this instant.\n\nExpress your final answer for $\\dot{\\lambda}$ in $\\text{s}^{-1}$ and round to four significant figures.", "solution": "The problem is well-posed and scientifically grounded in the theory of continuum plasticity. All necessary data and constitutive relations are provided and are consistent with established models. I will proceed with the solution.\n\nThe objective is to find the plastic multiplier rate, $\\dot{\\lambda}$, using the consistency condition, which states that during plastic loading, the stress state must remain on the yield surface. Mathematically, this is expressed as the time derivative of the yield function being zero:\n$$\n\\dot{f}(\\boldsymbol{\\sigma}, \\alpha) = 0\n$$\nUsing the chain rule, we can expand this condition as:\n$$\n\\dot{f} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} : \\dot{\\boldsymbol{\\sigma}} + \\frac{\\partial f}{\\partial \\alpha} \\dot{\\alpha} = 0\n$$\n\nLet us analyze each term in this equation.\n\nFirst, the term $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ represents the normal to the yield surface in stress space. Let us denote this tensor by $\\boldsymbol{N}$. From the given yield function, $f(\\boldsymbol{\\sigma},\\alpha) = \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s}\\| - \\big(\\sigma_{y0} + H\\,\\alpha\\big) = \\sqrt{\\frac{3}{2}} (\\boldsymbol{s}:\\boldsymbol{s})^{1/2} - \\big(\\sigma_{y0} + H\\,\\alpha\\big)$, we compute its derivative with respect to $\\boldsymbol{\\sigma}$:\n$$\n\\boldsymbol{N} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{\\frac{3}{2}} \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} (\\boldsymbol{s}:\\boldsymbol{s})^{1/2}\n$$\nGiven $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}$, its derivative with respect to $\\boldsymbol{\\sigma}$ is the fourth-order deviatoric projection tensor. The derivative of $\\boldsymbol{s}:\\boldsymbol{s}$ with respect to $\\boldsymbol{\\sigma}$ is $2\\boldsymbol{s}$. Thus:\n$$\n\\boldsymbol{N} = \\sqrt{\\frac{3}{2}} \\frac{1}{2\\|\\boldsymbol{s}\\|} (2\\boldsymbol{s}) = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\nThe problem states the metal is under homogeneous uniaxial tension. The stress tensor is of the form:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{11} & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe trace is $\\text{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11}$. The deviatoric stress $\\boldsymbol{s}$ is:\n$$\n\\boldsymbol{s} = \\begin{pmatrix} \\sigma_{11} & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\frac{1}{3}\\sigma_{11} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\sigma_{11} \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & -1/3 & 0 \\\\ 0 & 0 & -1/3 \\end{pmatrix}\n$$\nThe Frobenius norm of the deviatoric stress is $\\|\\boldsymbol{s}\\| = \\sqrt{s_{ij}s_{ij}} = \\sqrt{(\\frac{2}{3}\\sigma_{11})^2 + (-\\frac{1}{3}\\sigma_{11})^2 + (-\\frac{1}{3}\\sigma_{11})^2} = \\sqrt{\\frac{6}{9}\\sigma_{11}^2} = \\sqrt{\\frac{2}{3}}\\sigma_{11}$ (assuming tension, $\\sigma_{11} > 0$).\nSubstituting this into the expression for $\\boldsymbol{N}$, we find the flow direction:\n$$\n\\boldsymbol{N} = \\sqrt{\\frac{3}{2}} \\frac{\\sigma_{11} \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & -1/3 & 0 \\\\ 0 & 0 & -1/3 \\end{pmatrix}}{\\sqrt{2/3}\\sigma_{11}} = \\frac{3}{2} \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & -1/3 & 0 \\\\ 0 & 0 & -1/3 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1/2 & 0 \\\\ 0 & 0 & -1/2 \\end{pmatrix}\n$$\nThis tensor $\\boldsymbol{N}$ is the flow direction requested by the problem. Note that it is deviatoric, $\\text{tr}(\\boldsymbol{N}) = 1 - 1/2 - 1/2 = 0$.\n\nSecond, we evaluate the term $\\frac{\\partial f}{\\partial \\alpha}$. From the yield function, this is simply:\n$$\n\\frac{\\partial f}{\\partial \\alpha} = -H\n$$\n\nThird, we relate the rate of the hardening variable, $\\dot{\\alpha}$, to the plastic multiplier $\\dot{\\lambda}$. The associated flow rule is $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\dot{\\lambda}\\boldsymbol{N}$. Using the given hardening law:\n$$\n\\dot{\\alpha} = \\sqrt{\\frac{2}{3}} \\|\\dot{\\boldsymbol{\\varepsilon}}^{p}\\| = \\sqrt{\\frac{2}{3}} \\|\\dot{\\lambda}\\boldsymbol{N}\\|\n$$\nSince plastic loading is occurring, $\\dot{\\lambda} > 0$. The norm of $\\boldsymbol{N}$ is $\\|\\boldsymbol{N}\\| = \\sqrt{1^2 + (-\\frac{1}{2})^2 + (-\\frac{1}{2})^2} = \\sqrt{1 + \\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{3}{2}}$.\nTherefore,\n$$\n\\dot{\\alpha} = \\dot{\\lambda} \\sqrt{\\frac{2}{3}} \\sqrt{\\frac{3}{2}} = \\dot{\\lambda}\n$$\n\nFinally, the stress rate $\\dot{\\boldsymbol{\\sigma}}$ is given by the hypoelastic law, which relates it to the total strain rate $\\dot{\\boldsymbol{\\varepsilon}}$ and the plastic strain rate $\\dot{\\boldsymbol{\\varepsilon}}^{p}$:\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^{p}) = \\mathbb{C} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}\\boldsymbol{N})\n$$\nwhere $\\mathbb{C}$ is the fourth-order isotropic elastic stiffness tensor.\n\nSubstituting all these components back into the consistency condition:\n$$\n\\boldsymbol{N} : [\\mathbb{C} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}\\boldsymbol{N})] - H \\dot{\\lambda} = 0\n$$\nExpanding this equation gives:\n$$\n\\boldsymbol{N} : \\mathbb{C} : \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda} (\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N}) - H \\dot{\\lambda} = 0\n$$\nWe can solve for $\\dot{\\lambda}$:\n$$\n\\dot{\\lambda} = \\frac{\\boldsymbol{N} : \\mathbb{C} : \\dot{\\boldsymbol{\\varepsilon}}}{\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N} + H}\n$$\nFor an isotropic elastic material, the action of the stiffness tensor on a symmetric second-order tensor $\\boldsymbol{A}$ is $\\mathbb{C}:\\boldsymbol{A} = 2G\\,\\boldsymbol{A}_{dev} + K\\,\\text{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}$, where $G$ is the shear modulus, $K$ is the bulk modulus, $\\boldsymbol{A}_{dev}$ is the deviatoric part of $\\boldsymbol{A}$, and $\\boldsymbol{I}$ is the second-order identity tensor.\nThe numerator becomes:\n$\\boldsymbol{N} : \\mathbb{C} : \\dot{\\boldsymbol{\\varepsilon}} = \\boldsymbol{N} : (2G\\,\\dot{\\boldsymbol{e}} + K\\,\\text{tr}(\\dot{\\boldsymbol{\\varepsilon}})\\,\\boldsymbol{I})$, where $\\dot{\\boldsymbol{e}}$ is the deviatoric part of $\\dot{\\boldsymbol{\\varepsilon}}$. Since $\\boldsymbol{N}$ is deviatoric, $\\text{tr}(\\boldsymbol{N})=0$, so $\\boldsymbol{N}:\\boldsymbol{I}=0$. Also, $\\boldsymbol{N}:\\dot{\\boldsymbol{e}} = \\boldsymbol{N}:\\dot{\\boldsymbol{\\varepsilon}}$. Thus, the numerator simplifies to $2G\\,(\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}})$.\nThe denominator term $\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N}$ becomes:\n$\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N} = \\boldsymbol{N} : (2G\\,\\boldsymbol{N}_{dev} + K\\,\\text{tr}(\\boldsymbol{N})\\,\\boldsymbol{I})$. As $\\boldsymbol{N}$ is deviatoric, $\\boldsymbol{N}_{dev}=\\boldsymbol{N}$ and $\\text{tr}(\\boldsymbol{N}) = 0$. This simplifies to $2G\\,(\\boldsymbol{N} : \\boldsymbol{N}) = 2G\\,\\|\\boldsymbol{N}\\|^2$. Since $\\|\\boldsymbol{N}\\|^2 = \\frac{3}{2}$, this term is $2G(\\frac{3}{2}) = 3G$.\nThe expression for the plastic multiplier is therefore:\n$$\n\\dot{\\lambda} = \\frac{2G\\,(\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}})}{3G + H}\n$$\nNow we compute the numerical values. The given elastic moduli are Young's modulus $E = 210$ GPa and Poisson's ratio $\\nu = 0.30$. The shear modulus $G$ is:\n$$\nG = \\frac{E}{2(1+\\nu)} = \\frac{210\\,\\text{GPa}}{2(1+0.30)} = \\frac{210}{2.6}\\,\\text{GPa}\n$$\nThe imposed total strain rate is $\\dot{\\boldsymbol{\\varepsilon}} = \\begin{pmatrix} \\dot{\\varepsilon} & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0 \\end{pmatrix}$ with $\\dot{\\varepsilon} = 1.0\\times 10^{-4}\\ \\text{s}^{-1}$.\nThe scalar product $\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}}$ is:\n$$\n\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}} = (1)(\\dot{\\varepsilon}) + (-\\frac{1}{2})(0) + (-\\frac{1}{2})(0) = \\dot{\\varepsilon}\n$$\nSubstituting this into the expression for $\\dot{\\lambda}$:\n$$\n\\dot{\\lambda} = \\frac{2G\\dot{\\varepsilon}}{3G + H}\n$$\nThe hardening modulus is $H = 1.5$ GPa. Plugging in all values:\n$$\n\\dot{\\lambda} = \\frac{2 \\left(\\frac{210}{2.6}\\right) (1.0 \\times 10^{-4})}{3 \\left(\\frac{210}{2.6}\\right) + 1.5}\n$$\n$$\n\\dot{\\lambda} = \\frac{\\frac{420}{2.6} \\times 10^{-4}}{\\frac{630}{2.6} + 1.5} = \\frac{161.538... \\times 10^{-4}}{242.307... + 1.5} = \\frac{161.538... \\times 10^{-4}}{243.807...} \\ \\text{s}^{-1}\n$$\n$$\n\\dot{\\lambda} \\approx 0.66257 \\times 10^{-4}\\ \\text{s}^{-1} = 6.6257 \\times 10^{-5}\\ \\text{s}^{-1}\n$$\nRounding to four significant figures, the final result is $6.626 \\times 10^{-5}\\ \\text{s}^{-1}$.", "answer": "$$\n\\boxed{6.626 \\times 10^{-5}}\n$$", "id": "2905738"}, {"introduction": "The mechanical postulates of plasticity, including the normality condition, are deeply rooted in the principles of thermodynamics. This practice explores the Clausius-Duhem inequality, which mandates that the internal dissipation, $\\mathcal{D}$, must be non-negative. You will derive the expression for plastic dissipation and discover how this fundamental requirement constrains the mathematical form of material hardening laws, ensuring thermodynamic stability [@problem_id:2893874].", "problem": "Consider a small-strain, isothermal elasto-plastic material with free energy density given by\n$$\n\\psi(\\epsilon,\\epsilon^{p},q)=\\tfrac{1}{2}\\,(\\epsilon-\\epsilon^{p}):\\mathbb{C}:(\\epsilon-\\epsilon^{p})+g(q),\n$$\nwhere $\\epsilon$ is the total strain, $\\epsilon^{p}$ is the plastic strain, $\\mathbb{C}$ is a fourth-order positive-definite elastic stiffness tensor, $q$ is a scalar internal hardening variable, and $g(q)$ is a twice continuously differentiable stored hardening potential. The thermodynamic force conjugate to $q$ is defined by $A=\\partial g/\\partial q$. The Cauchy stress is $\\sigma=\\mathbb{C}:(\\epsilon-\\epsilon^{p})$. The Clausius–Duhem inequality for isothermal processes requires the dissipation\n$$\n\\mathcal{D}=\\sigma_{ij}\\,\\dot{\\epsilon}^{p}_{ij}-A\\,\\dot{q}\n$$\nto be non-negative for all admissible processes.\n\nAdopt an associative, rate-independent plasticity model with the yield function\n$$\nf(\\sigma,A)=\\sqrt{\\tfrac{3}{2}}\\left\\| \\operatorname{dev}\\sigma \\right\\| - \\big(\\sigma_{y0}+A\\big),\n$$\nwhere $\\operatorname{dev}\\sigma=\\sigma-\\tfrac{1}{3}\\,(\\operatorname{tr}\\sigma)\\,\\mathbf{I}$, and $\\sigma_{y0}>0$ is the initial yield stress (a positive constant). Assume the Karush–Kuhn–Tucker conditions for plastic loading hold and use the normality postulate with generalized thermodynamic forces $(\\sigma,-A)$, namely\n$$\n\\dot{\\epsilon}^{p}=\\lambda\\,\\frac{\\partial f}{\\partial \\sigma},\\qquad \\dot{q}=\\lambda\\,\\frac{\\partial f}{\\partial(-A)}=-\\lambda\\,\\frac{\\partial f}{\\partial A},\\qquad \\lambda\\ge 0,\n$$\nwith consistency enforced when $\\lambda>0$.\n\nLet the hardening potential be $g(q)=\\tfrac{1}{2}H\\,q^{2}$ with a constant hardening modulus $H>0$, so that $A=\\partial g/\\partial q=H\\,q$.\n\nUsing only the fundamental thermodynamic inequality, the above constitutive structure, and basic tensor calculus, derive the plastic dissipation rate $\\mathcal{D}$ during plastic loading and simplify it to a single closed-form expression in terms of the plastic multiplier $\\lambda$ and the material parameter $\\sigma_{y0}$. Explain briefly why the conditions you used guarantee non-negative dissipation and how the requirement $\\mathcal{D}\\ge 0$ constrains the admissible evolution law $A=\\partial g/\\partial q$ through convexity of $g(q)$.\n\nReport the final expression for the dissipation rate in SI base units (Pa·s). Do not include units in your final boxed answer. No numerical evaluation or rounding is required; give your result as a symbolic expression.", "solution": "The problem requires the derivation of the plastic dissipation rate for a given elasto-plastic constitutive model and an explanation of the thermodynamic consistency of the formulation.\n\nFirst, the validity of the problem statement is confirmed. The problem is scientifically grounded in the principles of continuum thermodynamics and plasticity theory. It is well-posed, objective, and provides a complete and consistent set of constitutive equations. Therefore, a solution can be formulated.\n\nThe plastic dissipation rate $\\mathcal{D}$ is defined by the Clausius-Duhem inequality for isothermal processes as\n$$\n\\mathcal{D} = \\sigma : \\dot{\\epsilon}^{p} - A \\dot{q}\n$$\nwhere $\\sigma$ is the Cauchy stress tensor, $\\dot{\\epsilon}^{p}$ is the rate of plastic strain, $A$ is the thermodynamic force conjugate to the hardening variable $q$, and $\\dot{q}$ is its rate. The colon operator denotes the double-dot product, i.e., $\\sigma : \\dot{\\epsilon}^{p} = \\sigma_{ij}\\,\\dot{\\epsilon}^{p}_{ij}$.\n\nThe problem specifies an associative flow rule based on a yield function $f(\\sigma, A)$. The rates of the internal variables are given by\n$$\n\\dot{\\epsilon}^{p} = \\lambda\\,\\frac{\\partial f}{\\partial \\sigma}\n$$\n$$\n\\dot{q} = \\lambda\\,\\frac{\\partial f}{\\partial(-A)} = -\\lambda\\,\\frac{\\partial f}{\\partial A}\n$$\nwhere $\\lambda \\ge 0$ is the plastic multiplier. Substituting these flow rules into the expression for dissipation yields\n$$\n\\mathcal{D} = \\sigma : \\left(\\lambda\\,\\frac{\\partial f}{\\partial \\sigma}\\right) - A \\left(-\\lambda\\,\\frac{\\partial f}{\\partial A}\\right) = \\lambda \\left( \\sigma : \\frac{\\partial f}{\\partial \\sigma} + A \\frac{\\partial f}{\\partial A} \\right)\n$$\nTo proceed, the partial derivatives of the yield function must be calculated. The yield function is\n$$\nf(\\sigma,A)=\\sqrt{\\tfrac{3}{2}}\\left\\| \\operatorname{dev}\\sigma \\right\\| - \\big(\\sigma_{y0}+A\\big)\n$$\nwhere $s = \\operatorname{dev}\\sigma = \\sigma-\\tfrac{1}{3}\\,(\\operatorname{tr}\\sigma)\\,\\mathbf{I}$ is the deviatoric stress tensor, and $\\|s\\| = \\sqrt{s:s}$.\n\nThe partial derivative of $f$ with respect to $\\sigma$ is found using the chain rule:\n$$\n\\frac{\\partial f}{\\partial \\sigma} = \\sqrt{\\frac{3}{2}} \\frac{\\partial}{\\partial \\sigma} (\\sqrt{s:s}) = \\sqrt{\\frac{3}{2}} \\frac{1}{2\\sqrt{s:s}} \\frac{\\partial (s:s)}{\\partial \\sigma} = \\sqrt{\\frac{3}{2}} \\frac{s}{\\|s\\|}\n$$\nThe identity $\\frac{\\partial (s:s)}{\\partial \\sigma} = 2s$ is used, which follows from $\\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{kl}\\delta_{ij}$ and the fact that $\\operatorname{tr}(s)=0$.\n\nThe partial derivative of $f$ with respect to $A$ is straightforward:\n$$\n\\frac{\\partial f}{\\partial A} = -1\n$$\nSubstituting these derivatives into the expression for $\\mathcal{D}$:\n$$\n\\mathcal{D} = \\lambda \\left( \\sigma : \\left( \\sqrt{\\frac{3}{2}} \\frac{s}{\\|s\\|} \\right) + A (-1) \\right) = \\lambda \\left( \\sqrt{\\frac{3}{2}} \\frac{\\sigma:s}{\\|s\\|} - A \\right)\n$$\nA property of the deviatoric stress tensor $s$ is that it is orthogonal to the spherical tensor part of any stress tensor. The stress tensor $\\sigma$ can be decomposed as $\\sigma = s + \\frac{1}{3}(\\operatorname{tr}\\sigma)\\mathbf{I}$. Therefore, the double-dot product $\\sigma:s$ simplifies as follows:\n$$\n\\sigma:s = \\left(s + \\frac{1}{3}(\\operatorname{tr}\\sigma)\\mathbf{I}\\right):s = s:s + \\frac{1}{3}(\\operatorname{tr}\\sigma)(\\mathbf{I}:s)\n$$\nSince $\\mathbf{I}:s = \\operatorname{tr}(s) = 0$, we have $\\sigma:s = s:s = \\|s\\|^2$. The dissipation expression becomes\n$$\n\\mathcal{D} = \\lambda \\left( \\sqrt{\\frac{3}{2}} \\frac{\\|s\\|^2}{\\|s\\|} - A \\right) = \\lambda \\left( \\sqrt{\\frac{3}{2}} \\|s\\| - A \\right)\n$$\nThe problem states we are in a state of plastic loading, which implies the Karush-Kuhn-Tucker (KKT) consistency condition is active, i.e., $\\lambda > 0$ and $f(\\sigma, A) = 0$. The yield condition is\n$$\nf(\\sigma, A) = \\sqrt{\\tfrac{3}{2}}\\|\\operatorname{dev}\\sigma\\| - (\\sigma_{y0}+A) = 0\n$$\nFrom this, we can express the equivalent stress as $\\sqrt{\\frac{3}{2}}\\|\\operatorname{dev}\\sigma\\| = \\sigma_{y0}+A$. Substituting this into the simplified expression for $\\mathcal{D}$:\n$$\n\\mathcal{D} = \\lambda \\left( (\\sigma_{y0}+A) - A \\right) = \\lambda \\sigma_{y0}\n$$\nThis is the closed-form expression for the plastic dissipation rate in terms of the plastic multiplier $\\lambda$ and the initial yield stress $\\sigma_{y0}$.\n\nThe condition of non-negative dissipation, $\\mathcal{D} \\ge 0$, is guaranteed by the fundamental assumptions of the model. The plastic multiplier $\\lambda$ is non-negative by definition ($\\lambda \\ge 0$), and the initial yield stress $\\sigma_{y0}$ is given as a positive material constant ($\\sigma_{y0} > 0$). Therefore, their product $\\mathcal{D} = \\lambda \\sigma_{y0}$ must be non-negative. For plastic loading ($\\lambda > 0$), the dissipation is strictly positive.\n\nThe requirement $\\mathcal{D}\\ge 0$ for any admissible thermodynamic process imposes stability constraints on the constitutive model, which in turn leads to the requirement of convexity for the stored hardening potential $g(q)$. A fundamental condition for thermodynamic stability is that the free energy potential, $\\psi$, must be a convex function of its internal state variables, here $(\\epsilon^p, q)$. If $\\psi$ were not convex, there could exist spontaneous internal rearrangements of the state that would lead to a decrease in free energy, which could be harnessed to produce work, violating the second law of thermodynamics. The part of the free energy dependent on the internal variables is $\\psi_{\\text{int}}(\\epsilon^e, q) = \\frac{1}{2}(\\epsilon-\\epsilon^p):\\mathbb{C}:(\\epsilon-\\epsilon^p) + g(q)$, where $\\epsilon^e = \\epsilon - \\epsilon^p$. The stability condition requires the Hessian matrix of $\\psi$ with respect to the internal state variables to be positive semi-definite. Treating $\\epsilon^e$ and $q$ as the state variables, the Hessian is:\n$$\n\\text{Hess}(\\psi) = \\begin{pmatrix} \\frac{\\partial^2 \\psi}{\\partial \\epsilon^e \\otimes \\partial \\epsilon^e} & \\frac{\\partial^2 \\psi}{\\partial \\epsilon^e \\partial q} \\\\ \\frac{\\partial^2 \\psi}{\\partial q \\partial \\epsilon^e} & \\frac{\\partial^2 \\psi}{\\partial q^2} \\end{pmatrix} = \\begin{pmatrix} \\mathbb{C} & \\mathbf{0} \\\\ \\mathbf{0} & g''(q) \\end{pmatrix}\n$$\nFor this matrix to be positive semi-definite, its diagonal blocks must be positive semi-definite. The elastic stiffness tensor $\\mathbb{C}$ is given as positive-definite. Thus, we must have $g''(q) \\ge 0$. This is precisely the mathematical definition of a convex function $g(q)$. For the specific case $g(q)=\\frac{1}{2}Hq^2$, this requires the hardening modulus $H \\ge 0$. The problem states $H>0$, which corresponds to a strictly convex potential and ensures thermodynamic stability.\n\nFinally, we address the units. The parameter $\\lambda$ is a rate, derived from $\\dot{\\epsilon}^p$ (unit $s^{-1}$) and $\\partial f/\\partial \\sigma$ (dimensionless), so $\\lambda$ has units of $s^{-1}$. The yield stress $\\sigma_{y0}$ has units of pressure, Pascals ($Pa$). Therefore, the dissipation rate $\\mathcal{D} = \\lambda \\sigma_{y0}$ has units of $Pa \\cdot s^{-1}$, or $Pa/s$. This corresponds to power density ($W/m^3$). The problem statement's request for units of $Pa \\cdot s$ is noted as a likely typographical error for $Pa/s$. The symbolic result is independent of this notational issue.", "answer": "$$\n\\boxed{\\lambda \\sigma_{y0}}\n$$", "id": "2893874"}, {"introduction": "Bridging the gap from analytical derivation to computational implementation is a crucial skill for the modern engineer and scientist. This comprehensive exercise guides you through building a return-mapping algorithm for a pressure-dependent Drucker-Prager material, a model widely used for soils and rocks. You will apply the principles of consistency and flow to a non-associated framework, solidifying your ability to translate complex constitutive theory into a working numerical tool [@problem_id:2905729].", "problem": "Implement a single-increment small-strain algorithm for isotropic elastoplasticity with a Drucker–Prager (DP) pressure-dependent yield condition and a possibly non-associated flow rule, and use it to compute the plastic multiplier, plastic dissipation, and an elastic/plastic flag for a prescribed test suite. The formulation must be framed from the fundamental base of small-strain kinematics, linear isotropic elasticity, convex yield functions, the normality condition for associated flow, the non-associated flow rule for generality, and the consistency condition.\n\nYou are given the following fundamental ingredients:\n\n- Small-strain kinematics with the additive split $d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$, where $d\\boldsymbol{\\varepsilon}$ is the total infinitesimal strain increment, $d\\boldsymbol{\\varepsilon}^{e}$ is the elastic strain increment, and $d\\boldsymbol{\\varepsilon}^{p}$ is the plastic strain increment. The strain tensor is symmetric and uses tensorial shear components.\n\n- Linear isotropic elasticity with fourth-order elasticity tensor $\\mathbb{C}$ defined by the bulk modulus $K$ and the shear modulus $G$, such that $d\\boldsymbol{\\sigma} = \\mathbb{C} : (d\\boldsymbol{\\varepsilon} - d\\boldsymbol{\\varepsilon}^{p})$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor. Use $K = \\dfrac{E}{3(1-2\\nu)}$ and $G = \\dfrac{E}{2(1+\\nu)}$, with $E$ the Young’s modulus and $\\nu$ the Poisson’s ratio.\n\n- Drucker–Prager (DP) yield function $F(\\boldsymbol{\\sigma}) \\le 0$ with\n$$\nF(\\boldsymbol{\\sigma}) = q + \\alpha\\, p - k,\n$$\nwhere $p = -\\dfrac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})$ is the mean (compressive-positive) stress, $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\dfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}$ is the deviatoric stress, $q = \\sqrt{\\dfrac{3}{2}}\\,\\|\\boldsymbol{s}\\|$ is the von Mises equivalent stress, $\\alpha \\ge 0$ is a material parameter controlling pressure sensitivity, $k > 0$ is a cohesion-like parameter, and $\\boldsymbol{I}$ is the second-order identity tensor.\n\n- Non-associated plastic flow rule $d\\boldsymbol{\\varepsilon}^{p} = d\\lambda\\,\\dfrac{\\partial G}{\\partial \\boldsymbol{\\sigma}}$ with plastic potential\n$$\nG(\\boldsymbol{\\sigma}) = q + \\alpha_{\\psi}\\, p,\n$$\nwhere $\\alpha_{\\psi} \\ge 0$ is the dilation parameter. Associated flow is the special case $\\alpha_{\\psi} = \\alpha$. The scalar $d\\lambda \\ge 0$ is the plastic multiplier.\n\n- Consistency condition (Kuhn–Tucker conditions): $F \\le 0$, $d\\lambda \\ge 0$, and $d\\lambda\\,F = 0$.\n\n- Perfect plasticity for this problem, meaning $k$ is constant within the increment (no hardening or softening).\n\nWithin a single time increment from a stress-free and plastic-strain-free state, you will:\n1) Compute the elastic trial stress increment $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C} : d\\boldsymbol{\\varepsilon}$.\n2) Evaluate the trial yield function $F^{\\mathrm{tr}} = F(\\boldsymbol{\\sigma}^{\\mathrm{tr}})$.\n3) If $F^{\\mathrm{tr}} \\le 0$, the response is elastic: set $d\\lambda = 0$, $d\\boldsymbol{\\varepsilon}^{p} = \\boldsymbol{0}$, updated stress $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$, and plastic dissipation $D = 0$.\n4) If $F^{\\mathrm{tr}} > 0$, enforce the consistency condition to compute the plastic multiplier $d\\lambda > 0$ and return to the yield surface with the non-associated flow rule, updating $\\boldsymbol{\\sigma}$ and $d\\boldsymbol{\\varepsilon}^{p}$. Then compute the plastic dissipation for the increment as\n$$\nD = \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}^{p}.\n$$\n\nAll results in this problem must be expressed in coherent International System of Units (SI). Specifically:\n- Use $E$ and $k$ in $\\mathrm{Pa}$, $d\\boldsymbol{\\varepsilon}$ is dimensionless, and report plastic dissipation $D$ in $\\mathrm{Pa}$. The plastic multiplier $d\\lambda$ is dimensionless. No angle units are used because $\\alpha$ and $\\alpha_{\\psi}$ are provided directly as dimensionless pressure-sensitivity and dilation parameters, respectively.\n\nYour program must implement the above algorithm and apply it to the following test suite. Each test case provides $(E,\\nu,\\alpha,\\alpha_{\\psi},k,d\\boldsymbol{\\varepsilon})$, with $d\\boldsymbol{\\varepsilon}$ specified in the order $[d\\varepsilon_{11}, d\\varepsilon_{22}, d\\varepsilon_{33}, d\\varepsilon_{12}, d\\varepsilon_{23}, d\\varepsilon_{31}]$ using tensorial shear components. The initial state is $\\boldsymbol{\\sigma}=\\boldsymbol{0}$ and $\\boldsymbol{\\varepsilon}^{p}=\\boldsymbol{0}$ for all test cases.\n\nTest Suite:\n- Case A (happy path, elastic): $E = 210\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.3$, $\\alpha = 0.1$, $\\alpha_{\\psi} = 0.05$, $k = 400\\times 10^{6}\\ \\mathrm{Pa}$, $d\\boldsymbol{\\varepsilon} = [1\\times 10^{-6}, 0, 0, 0, 0, 0]$.\n- Case B (plastic, non-associated, combined deviatoric and volumetric from uniaxial-like loading): $E = 210\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.3$, $\\alpha = 0.1$, $\\alpha_{\\psi} = 0.05$, $k = 400\\times 10^{6}\\ \\mathrm{Pa}$, $d\\boldsymbol{\\varepsilon} = [4\\times 10^{-3}, 0, 0, 0, 0, 0]$.\n- Case C (plastic, non-associated, pure shear trial loading): $E = 210\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.3$, $\\alpha = 0.1$, $\\alpha_{\\psi} = 0.05$, $k = 400\\times 10^{6}\\ \\mathrm{Pa}$, $d\\boldsymbol{\\varepsilon} = [0, 0, 0, 5\\times 10^{-3}, 0, 0]$.\n- Case D (plastic, non-associated, hydrostatic compression trial loading): $E = 210\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.3$, $\\alpha = 0.1$, $\\alpha_{\\psi} = 0.05$, $k = 400\\times 10^{6}\\ \\mathrm{Pa}$, $d\\boldsymbol{\\varepsilon} = [-2\\times 10^{-2}, -2\\times 10^{-2}, -2\\times 10^{-2}, 0, 0, 0]$.\n- Case E (plastic, associated flow limit check): $E = 210\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.3$, $\\alpha = 0.1$, $\\alpha_{\\psi} = 0.1$, $k = 400\\times 10^{6}\\ \\mathrm{Pa}$, $d\\boldsymbol{\\varepsilon} = [1\\times 10^{-3}, -2\\times 10^{-4}, -2\\times 10^{-4}, 3\\times 10^{-3}, 0, 0]$.\n\nYour program should compute for each case:\n- The boolean flag $\\text{is\\_elastic}$ indicating whether $F^{\\mathrm{tr}} \\le 0$.\n- The plastic multiplier increment $d\\lambda$ (dimensionless).\n- The plastic dissipation $D$ in $\\mathrm{Pa}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets, where each element is itself a list of the form $[\\text{is\\_elastic}, d\\lambda, D]$. For example, the output must look like\n$[[\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}], [\\dots], [\\dots], [\\dots]]$\nwith no additional text. All floating-point results must be printed in standard decimal form as produced by the programming language defaults, and $D$ must be in $\\mathrm{Pa}$.", "solution": "The problem presented is a standard exercise in computational plasticity. It is scientifically grounded, well-posed, objective, and complete. All necessary physical laws, material parameters, and initial conditions are provided. The formulation—based on small-strain kinematics, isotropic elasticity, a Drucker-Prager yield criterion, and a non-associated flow rule—is a cornerstone of modern solid mechanics. The problem is therefore valid and permits a rigorous solution. We shall proceed with the derivation of the single-increment return mapping algorithm.\n\nThe core of the problem is to determine the state of stress $\\boldsymbol{\\sigma}$ and the internal plastic variables for a given total strain increment $d\\boldsymbol{\\varepsilon}$, starting from a stress-free state. The algorithm consists of two main stages: an elastic predictor and a plastic corrector.\n\nFirst, we define the material elastic constants, the bulk modulus $K$ and the shear modulus $G$, from the given Young's modulus $E$ and Poisson's ratio $\\nu$:\n$$ K = \\frac{E}{3(1-2\\nu)} $$\n$$ G = \\frac{E}{2(1+\\nu)} $$\nThe stress-strain relationship in linear elasticity can be decomposed into volumetric and deviatoric parts. The mean stress $p = - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ is related to the volumetric strain $\\varepsilon_v = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$ by $dp = -K\\,d\\varepsilon_v$. The deviatoric stress $\\boldsymbol{s}$ is related to the deviatoric strain $\\boldsymbol{e} = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\varepsilon_v\\boldsymbol{I}$ by $d\\boldsymbol{s} = 2G\\,d\\boldsymbol{e}$.\n\nThe computational increment proceeds as follows:\n\n1.  Elastic Predictor:\n    We first assume the entire strain increment $d\\boldsymbol{\\varepsilon}$ is elastic. This gives a trial stress state, denoted by the superscript 'tr'. Since the initial state is stress-free, the trial stress is computed directly from the strain increment:\n    $$ \\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C} : d\\boldsymbol{\\varepsilon} $$\n    In terms of invariants, the trial mean stress $p^{\\mathrm{tr}}$ and trial deviatoric stress $\\boldsymbol{s}^{\\mathrm{tr}}$ are:\n    $$ p^{\\mathrm{tr}} = -K\\,\\mathrm{tr}(d\\boldsymbol{\\varepsilon}) $$\n    $$ \\boldsymbol{s}^{\\mathrm{tr}} = 2G\\,\\left(d\\boldsymbol{\\varepsilon} - \\frac{1}{3}\\mathrm{tr}(d\\boldsymbol{\\varepsilon})\\boldsymbol{I}\\right) $$\n    From these, we compute the trial von Mises equivalent stress $q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}$.\n\n2.  Yield Condition Check:\n    We evaluate the Drucker-Prager yield function $F$ at the trial stress state:\n    $$ F^{\\mathrm{tr}} = F(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k $$\n    If $F^{\\mathrm{tr}} \\le 0$, the trial stress is within or on the yield surface. The assumption was correct; the step is purely elastic. The final stress is $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$, the plastic multiplier increment is $d\\lambda = 0$, and the plastic dissipation is $D = 0$.\n\n3.  Plastic Corrector:\n    If $F^{\\mathrm{tr}} > 0$, the trial state is outside the yield surface, which is physically inadmissible. Plastic deformation must occur. The final stress state $\\boldsymbol{\\sigma}$ must lie on the yield surface, satisfying the consistency condition $F(\\boldsymbol{\\sigma}) = 0$. The stress is updated from the trial state by subtracting the stress relaxation due to plastic strain $d\\boldsymbol{\\varepsilon}^p$:\n    $$ \\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C} : d\\boldsymbol{\\varepsilon}^{p} $$\n    The plastic strain increment is given by the non-associated flow rule:\n    $$ d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}} $$\n    where $d\\lambda > 0$ is the plastic multiplier and $G(\\boldsymbol{\\sigma})=q + \\alpha_{\\psi}p$ is the plastic potential. The gradient of the potential, representing the direction of plastic flow, is:\n    $$ \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\alpha_{\\psi} \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2}\\frac{\\boldsymbol{s}}{q} - \\frac{\\alpha_{\\psi}}{3}\\boldsymbol{I} $$\n    A key result for $J_2$-type plasticity models (like von Mises and Drucker-Prager) is that the deviatoric stress direction remains constant during plastic return; that is, the direction of $\\boldsymbol{s}$ is the same as that of $\\boldsymbol{s}^{\\mathrm{tr}}$. This simplifies the return mapping equations.\n    By substituting the flow rule into the stress update and separating into volumetric and deviatoric parts, we obtain update equations for the invariants $p$ and $q$:\n    $$ p = p^{\\mathrm{tr}} - K \\alpha_{\\psi} d\\lambda $$\n    $$ q = q^{\\mathrm{tr}} - 3G d\\lambda $$\n    This expression for $q$ is valid for $q^{\\mathrm{tr}} > 0$. If $q^{\\mathrm{tr}}=0$ (a hydrostatic trial state), the updated deviatoric stress must also be zero, so $q=0$.\n\n    To find the unknown plastic multiplier $d\\lambda$, we enforce the consistency condition $F(\\boldsymbol{\\sigma}) = 0$:\n    $$ q + \\alpha p - k = 0 $$\n    Substituting the update equations for $p$ and $q$ gives an equation for $d\\lambda$. We must distinguish between two cases:\n    -   Case $q^{\\mathrm{tr}} > 0$ (Non-apex return):\n        $$ (q^{\\mathrm{tr}} - 3G d\\lambda) + \\alpha (p^{\\mathrm{tr}} - K \\alpha_{\\psi} d\\lambda) - k = 0 $$\n        Recognizing $F^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k$, we solve for $d\\lambda$:\n        $$ d\\lambda = \\frac{F^{\\mathrm{tr}}}{3G + \\alpha K \\alpha_{\\psi}} $$\n    -   Case $q^{\\mathrm{tr}} = 0$ (Apex return):\n        Here, $q=0$. The consistency condition becomes $\\alpha p - k = 0$.\n        $$ \\alpha (p^{\\mathrm{tr}} - K \\alpha_{\\psi} d\\lambda) - k = 0 $$\n        Recognizing $F^{\\mathrm{tr}} = \\alpha p^{\\mathrm{tr}} - k$, we solve for $d\\lambda$:\n        $$ d\\lambda = \\frac{F^{\\mathrm{tr}}}{\\alpha K \\alpha_{\\psi}} $$\n        This case is only physically meaningful if both $\\alpha > 0$ and $\\alpha_{\\psi} > 0$.\n\n4.  Plastic Dissipation Calculation:\n    Once $d\\lambda$ is found, the final state invariants $p$ and $q$ are computed. The plastic dissipation per unit volume for the increment is defined as $D = \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}^{p}$. Substituting the expressions for $\\boldsymbol{\\sigma}$ and $d\\boldsymbol{\\varepsilon}^{p}$ and simplifying yields a general formula:\n    $$ D = d\\lambda (q + \\alpha_{\\psi} p) $$\n    where $p$ and $q$ are the final, updated values. Dissipation must be non-negative, which is guaranteed if the flow potential $G$ is convex and the stress state is on or inside the region $G \\ge 0$.\n\nThe algorithm is thus fully defined. We will implement this procedure for each test case provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a single-increment small-strain algorithm for Drucker-Prager elastoplasticity\n    and applies it to a predefined test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (E, nu, alpha, alpha_psi, k, deps_vec)\n    test_cases = [\n        # Case A: Elastic\n        (210e9, 0.3, 0.1, 0.05, 400e6, [1e-6, 0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case B: Plastic, non-associated, uniaxial-like loading\n        (210e9, 0.3, 0.1, 0.05, 400e6, [4e-3, 0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case C: Plastic, non-associated, pure shear loading\n        (210e9, 0.3, 0.1, 0.05, 400e6, [0.0, 0.0, 0.0, 5e-3, 0.0, 0.0]),\n        # Case D: Plastic, non-associated, hydrostatic loading (apex return)\n        (210e9, 0.3, 0.1, 0.05, 400e6, [-2e-2, -2e-2, -2e-2, 0.0, 0.0, 0.0]),\n        # Case E: Plastic, associated flow\n        (210e9, 0.3, 0.1, 0.1, 400e6, [1e-3, -2e-4, -2e-4, 3e-3, 0.0, 0.0])\n    ]\n\n    results = []\n    for case in test_cases:\n        E, nu, alpha, alpha_psi, k, deps_vec = case\n        \n        # 1. Compute elastic constants\n        G = E / (2 * (1 + nu))\n        K = E / (3 * (1 - 2 * nu))\n\n        # 2. Construct strain tensor from Voigt-like vector (with tensorial shear)\n        deps_mat = np.array([\n            [deps_vec[0], deps_vec[3], deps_vec[5]],\n            [deps_vec[3], deps_vec[1], deps_vec[4]],\n            [deps_vec[5], deps_vec[4], deps_vec[2]]\n        ])\n\n        # 3. Elastic predictor step\n        deps_vol = np.trace(deps_mat)\n        deps_dev = deps_mat - (deps_vol / 3.0) * np.identity(3)\n\n        p_tr = -K * deps_vol\n        s_tr = 2 * G * deps_dev\n\n        s_tr_dot_s_tr = np.sum(s_tr * s_tr)\n        q_tr = np.sqrt(3.0 / 2.0 * s_tr_dot_s_tr)\n        \n        # Use a small relative tolerance to check for the apex condition\n        q_tr_is_zero = (q_tr  1e-12 * k) \n        \n        F_tr = q_tr + alpha * p_tr - k\n\n        # 4. Yield check and corrector step\n        if F_tr = 0:\n            is_elastic = True\n            d_lambda = 0.0\n            D = 0.0\n        else:\n            is_elastic = False\n            \n            if q_tr_is_zero:\n                # Apex return: d_lambda = F_tr / (alpha * K * alpha_psi)\n                denom = alpha * K * alpha_psi\n                if abs(denom)  1e-12: # Physically, yielding should not occur here if denom is zero\n                    d_lambda = 0.0 \n                    is_elastic = True\n                else:\n                    d_lambda = F_tr / denom\n            else:\n                # Non-apex return: d_lambda = F_tr / (3*G + alpha * K * alpha_psi)\n                denom = 3 * G + alpha * K * alpha_psi\n                d_lambda = F_tr / denom\n\n            if is_elastic:\n                D = 0.0\n            else:\n                # Update invariants and compute plastic dissipation\n                p_final = p_tr - K * alpha_psi * d_lambda\n                \n                if q_tr_is_zero:\n                    q_final = 0.0\n                else:\n                    q_final = q_tr - 3 * G * d_lambda\n                \n                # Ensure q_final is non-negative due to potential floating point inaccuracies\n                q_final = max(0.0, q_final)\n                \n                D = d_lambda * (q_final + alpha_psi * p_final)\n                # Ensure dissipation is non-negative\n                D = max(0.0, D)\n\n        result = [is_elastic, d_lambda, D]\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a Python list is acceptable here.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2905729"}]}