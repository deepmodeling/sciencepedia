{"hands_on_practices": [{"introduction": "To truly understand the incremental theory of plasticity, we must begin with its computational heart: the return-mapping algorithm. This first exercise breaks the process down into its most fundamental steps. By manually applying the elastic-predictor, plastic-corrector method to a simple one-dimensional bar with perfect plasticity under monotonic loading, you will build a concrete understanding of how stress and strain states are updated incrementally when a material yields [@problem_id:2893807].", "problem": "A small-strain, one-dimensional bar made of a rate-independent, perfectly plastic material with linear elasticity is subjected to monotonic tensile strain-controlled loading. The material obeys the additive decomposition of strain, the linear elastic law, and an associative flow with a tension-compression symmetric yield function. Specifically, the fundamental bases to be used are:\n- Additive decomposition of total strain into elastic and plastic parts: $\\epsilon = \\epsilon^{e} + \\epsilon^{p}$.\n- Linear elasticity: $\\sigma = E\\,\\epsilon^{e}$.\n- Yield function for perfect plasticity: $f(\\sigma) = |\\sigma| - \\sigma_{y} \\le 0$.\n- Associative flow and Kuhn-Tucker conditions: $\\dot{\\epsilon}^{p} = \\dot{\\lambda}\\,\\partial f/\\partial \\sigma$, $\\dot{\\lambda} \\ge 0$, $f \\le 0$, and $\\dot{\\lambda}\\,f = 0$.\n\nStarting from the above bases, derive the consistent incremental update for a single time step under monotonic tension such that, given a strain increment $\\Delta \\epsilon$, one can decide whether the step is elastic or plastic and update $(\\epsilon,\\epsilon^{e},\\epsilon^{p},\\sigma)$ accordingly. Then apply your update to the following data:\n\n- Elastic modulus: $E = 210\\,\\mathrm{GPa}$.\n- Yield stress: $\\sigma_{y} = 250\\,\\mathrm{MPa}$.\n- Initial state at step $n=0$: $\\epsilon_{0} = 0$, $\\epsilon^{p}_{0} = 0$, and $\\sigma_{0} = 0$.\n- Strain increments (monotonic tension): $\\Delta \\epsilon_{1} = 6.0 \\times 10^{-4}$, $\\Delta \\epsilon_{2} = 7.0 \\times 10^{-4}$, $\\Delta \\epsilon_{3} = 4.0 \\times 10^{-4}$, $\\Delta \\epsilon_{4} = 2.5 \\times 10^{-4}$.\n\nCarry out the step-by-step updates for steps $1$ through $4$, explicitly computing $\\epsilon_{k}$, $\\epsilon^{e}_{k}$, $\\epsilon^{p}_{k}$, and $\\sigma_{k}$ at the end of each step $k$. Finally, report the value of the plastic strain after step $4$, namely $\\epsilon^{p}_{4}$, as a single number. Strain is dimensionless; express the final result as a decimal and round your answer to six significant figures.", "solution": "The problem presented is a standard exercise in computational plasticity and requires the derivation and application of a one-dimensional return mapping algorithm. Before proceeding to the solution, a validation of the problem statement is mandatory.\n\nFirst, I extract the given information verbatim.\n- Additive strain decomposition: $\\epsilon = \\epsilon^{e} + \\epsilon^{p}$.\n- Linear elasticity: $\\sigma = E\\,\\epsilon^{e}$.\n- Yield function: $f(\\sigma) = |\\sigma| - \\sigma_{y} \\le 0$.\n- Associative flow rule: $\\dot{\\epsilon}^{p} = \\dot{\\lambda}\\,\\partial f/\\partial \\sigma$.\n- Kuhn-Tucker conditions: $\\dot{\\lambda} \\ge 0$, $f \\le 0$, $\\dot{\\lambda}\\,f = 0$.\n- Material parameters: Young's modulus $E = 210\\,\\mathrm{GPa}$, yield stress $\\sigma_{y} = 250\\,\\mathrm{MPa}$.\n- Initial conditions ($n=0$): $\\epsilon_{0} = 0$, $\\epsilon^{p}_{0} = 0$, $\\sigma_{0} = 0$.\n- Strain increments: $\\Delta \\epsilon_{1} = 6.0 \\times 10^{-4}$, $\\Delta \\epsilon_{2} = 7.0 \\times 10^{-4}$, $\\Delta \\epsilon_{3} = 4.0 \\times 10^{-4}$, $\\Delta \\epsilon_{4} = 2.5 \\times 10^{-4}$.\n- Loading is monotonic tension, implying $\\sigma \\ge 0$.\n\nThe problem is scientifically grounded, well-posed, and objective. It is a fundamental problem in elasto-plasticity, free of contradictions, ambiguities, or factual errors. All necessary data is provided. The problem is therefore valid, and I will proceed with the solution.\n\nThe solution requires two parts: first, the derivation of the incremental update algorithm, and second, its application to the given data.\n\nDerivation of the Incremental Update Algorithm:\nThe procedure, known as an elastic-predictor, plastic-corrector algorithm, determines the state at the end of a time step $n+1$ given the state at step $n$ and the total strain increment $\\Delta \\epsilon$. The state at any step $k$ is defined by the variables $(\\epsilon_{k}, \\epsilon^{e}_{k}, \\epsilon^{p}_{k}, \\sigma_{k})$. The total strain is updated first: $\\epsilon_{n+1} = \\epsilon_{n} + \\Delta \\epsilon$.\n\nSince the loading is monotonic tension, the stress $\\sigma$ is always non-negative. The yield function simplifies to $f(\\sigma) = \\sigma - \\sigma_{y} \\le 0$. The flow rule becomes $\\dot{\\epsilon}^{p} = \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\sigma} = \\dot{\\lambda}\\,(1) = \\dot{\\lambda}$. The incremental plastic strain is $\\Delta\\epsilon^{p} = \\Delta\\lambda$. The Kuhn-Tucker conditions in incremental form are $\\Delta\\epsilon^{p} \\ge 0$, $\\sigma_{n+1} - \\sigma_{y} \\le 0$, and $\\Delta\\epsilon^{p}(\\sigma_{n+1} - \\sigma_{y}) = 0$.\n\n1.  Elastic Predictor: Assume the entire strain increment $\\Delta\\epsilon$ is elastic.\n    The trial plastic strain is assumed unchanged: $\\epsilon^{p, \\text{trial}}_{n+1} = \\epsilon^{p}_{n}$.\n    The trial elastic strain is $\\epsilon^{e, \\text{trial}}_{n+1} = \\epsilon_{n+1} - \\epsilon^{p, \\text{trial}}_{n+1} = (\\epsilon_{n} + \\Delta\\epsilon) - \\epsilon^{p}_{n} = (\\epsilon_{n} - \\epsilon^{p}_{n}) + \\Delta\\epsilon = \\epsilon^{e}_{n} + \\Delta\\epsilon$.\n    The trial stress is computed from the trial elastic strain: $\\sigma^{\\text{trial}}_{n+1} = E\\,\\epsilon^{e, \\text{trial}}_{n+1} = E(\\epsilon^{e}_{n} + \\Delta\\epsilon) = \\sigma_{n} + E\\,\\Delta\\epsilon$.\n\n2.  Yield Check: Evaluate the yield function at the trial stress.\n    $f^{\\text{trial}}_{n+1} = \\sigma^{\\text{trial}}_{n+1} - \\sigma_{y}$.\n\n3.  Decision and State Update:\n    Case A) $f^{\\text{trial}}_{n+1} \\le 0$: The trial stress is within or on the yield surface. The elastic assumption is correct. The step is elastic.\n    The updated state variables are the trial values:\n    - $\\sigma_{n+1} = \\sigma^{\\text{trial}}_{n+1}$\n    - $\\epsilon^{e}_{n+1} = \\epsilon^{e, \\text{trial}}_{n+1}$\n    - $\\epsilon^{p}_{n+1} = \\epsilon^{p}_{n}$ (no plastic flow)\n\n    Case B) $f^{\\text{trial}}_{n+1} > 0$: The trial stress is outside the yield surface, which is physically inadmissible. The step involves plastic deformation. A plastic corrector is needed.\n    The final stress state must lie on the yield surface. For perfect plasticity and tensile loading, this means $\\sigma_{n+1} = \\sigma_{y}$.\n    The updated state variables are:\n    - $\\sigma_{n+1} = \\sigma_{y}$\n    - The final elastic strain is determined by Hooke's law: $\\epsilon^{e}_{n+1} = \\sigma_{n+1}/E = \\sigma_{y}/E$.\n    - The final plastic strain is found from the additive decomposition: $\\epsilon^{p}_{n+1} = \\epsilon_{n+1} - \\epsilon^{e}_{n+1}$.\n\nNow, I apply this algorithm to the given data.\nMaterial parameters: $E = 210\\,\\mathrm{GPa} = 210 \\times 10^{9}\\,\\mathrm{Pa}$, $\\sigma_{y} = 250\\,\\mathrm{MPa} = 250 \\times 10^{6}\\,\\mathrm{Pa}$.\nThe elastic strain at yield is $\\epsilon_{y} = \\sigma_{y} / E = (250 \\times 10^{6}) / (210 \\times 10^{9}) = \\frac{250}{210000} \\approx 1.190476 \\times 10^{-3}$.\n\nInitial State ($k=0$):\n$\\epsilon_{0} = 0$, $\\epsilon^{p}_{0} = 0$, $\\epsilon^{e}_{0} = 0$, $\\sigma_{0} = 0$.\n\nStep $k=1$: $\\Delta \\epsilon_{1} = 6.0 \\times 10^{-4}$\n- Total strain: $\\epsilon_{1} = \\epsilon_{0} + \\Delta \\epsilon_{1} = 0 + 6.0 \\times 10^{-4} = 6.0 \\times 10^{-4}$.\n- Elastic predictor: $\\sigma^{\\text{trial}}_{1} = \\sigma_{0} + E\\,\\Delta\\epsilon_{1} = 0 + (210 \\times 10^{9}\\,\\mathrm{Pa})(6.0 \\times 10^{-4}) = 126 \\times 10^{6}\\,\\mathrm{Pa} = 126\\,\\mathrm{MPa}$.\n- Yield check: $f^{\\text{trial}}_{1} = 126\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = -124\\,\\mathrm{MPa} \\le 0$. The step is elastic.\n- State update:\n  - $\\sigma_{1} = 126\\,\\mathrm{MPa}$\n  - $\\epsilon^{p}_{1} = \\epsilon^{p}_{0} = 0$\n  - $\\epsilon^{e}_{1} = \\sigma_{1}/E = (126 \\times 10^{6}) / (210 \\times 10^{9}) = 6.0 \\times 10^{-4}$\n  - $\\epsilon_{1} = 6.0 \\times 10^{-4}$\n\nStep $k=2$: $\\Delta \\epsilon_{2} = 7.0 \\times 10^{-4}$\n- Total strain: $\\epsilon_{2} = \\epsilon_{1} + \\Delta \\epsilon_{2} = 6.0 \\times 10^{-4} + 7.0 \\times 10^{-4} = 1.3 \\times 10^{-3}$.\n- Elastic predictor: $\\sigma^{\\text{trial}}_{2} = \\sigma_{1} + E\\,\\Delta\\epsilon_{2} = 126\\,\\mathrm{MPa} + (210 \\times 10^{9}\\,\\mathrm{Pa})(7.0 \\times 10^{-4}) = 126\\,\\mathrm{MPa} + 147\\,\\mathrm{MPa} = 273\\,\\mathrm{MPa}$.\n- Yield check: $f^{\\text{trial}}_{2} = 273\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = 23\\,\\mathrm{MPa} > 0$. The step is elasto-plastic.\n- State update (plastic corrector):\n  - $\\sigma_{2} = \\sigma_{y} = 250\\,\\mathrm{MPa}$\n  - $\\epsilon^{e}_{2} = \\sigma_{y}/E = 1.190476... \\times 10^{-3}$\n  - $\\epsilon^{p}_{2} = \\epsilon_{2} - \\epsilon^{e}_{2} = 1.3 \\times 10^{-3} - 1.190476... \\times 10^{-3} = 0.1095238... \\times 10^{-3}$\n  - $\\epsilon_{2} = 1.3 \\times 10^{-3}$\n\nStep $k=3$: $\\Delta \\epsilon_{3} = 4.0 \\times 10^{-4}$\n- Total strain: $\\epsilon_{3} = \\epsilon_{2} + \\Delta \\epsilon_{3} = 1.3 \\times 10^{-3} + 4.0 \\times 10^{-4} = 1.7 \\times 10^{-3}$.\n- Elastic predictor: Since the state is already on the yield surface and we apply more tensile strain, it is obvious the material will continue to yield. However, for rigor, we apply the algorithm.\n  $\\sigma^{\\text{trial}}_{3} = \\sigma_{2} + E\\,\\Delta\\epsilon_{3} = 250\\,\\mathrm{MPa} + (210 \\times 10^{9}\\,\\mathrm{Pa})(4.0 \\times 10^{-4}) = 250\\,\\mathrm{MPa} + 84\\,\\mathrm{MPa} = 334\\,\\mathrm{MPa}$.\n- Yield check: $f^{\\text{trial}}_{3} = 334\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = 84\\,\\mathrm{MPa} > 0$. The step is elasto-plastic.\n- State update:\n  - $\\sigma_{3} = \\sigma_{y} = 250\\,\\mathrm{MPa}$\n  - $\\epsilon^{e}_{3} = \\sigma_{y}/E = 1.190476... \\times 10^{-3}$\n  - $\\epsilon^{p}_{3} = \\epsilon_{3} - \\epsilon^{e}_{3} = 1.7 \\times 10^{-3} - 1.190476... \\times 10^{-3} = 0.5095238... \\times 10^{-3}$\n  - $\\epsilon_{3} = 1.7 \\times 10^{-3}$\n\nStep $k=4$: $\\Delta \\epsilon_{4} = 2.5 \\times 10^{-4}$\n- Total strain: $\\epsilon_{4} = \\epsilon_{3} + \\Delta \\epsilon_{4} = 1.7 \\times 10^{-3} + 2.5 \\times 10^{-4} = 1.95 \\times 10^{-3}$.\n- Elastic predictor: $\\sigma^{\\text{trial}}_{4} = \\sigma_{3} + E\\,\\Delta\\epsilon_{4} = 250\\,\\mathrm{MPa} + (210 \\times 10^{9}\\,\\mathrm{Pa})(2.5 \\times 10^{-4}) = 250\\,\\mathrm{MPa} + 52.5\\,\\mathrm{MPa} = 302.5\\,\\mathrm{MPa}$.\n- Yield check: $f^{\\text{trial}}_{4} = 302.5\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = 52.5\\,\\mathrm{MPa} > 0$. The step is elasto-plastic.\n- State update:\n  - $\\sigma_{4} = \\sigma_{y} = 250\\,\\mathrm{MPa}$\n  - $\\epsilon^{e}_{4} = \\sigma_{y}/E = 1.190476... \\times 10^{-3}$\n  - $\\epsilon^{p}_{4} = \\epsilon_{4} - \\epsilon^{e}_{4} = 1.95 \\times 10^{-3} - 1.19047619... \\times 10^{-3} = 0.75952380... \\times 10^{-3}$\n  - $\\epsilon_{4} = 1.95 \\times 10^{-3}$\n\nThe final plastic strain at the end of step $4$ is $\\epsilon^{p}_{4} = 0.75952380... \\times 10^{-3}$. The problem requires this value as a decimal rounded to six significant figures.\n$\\epsilon^{p}_{4} \\approx 0.000759524$.", "answer": "$$\n\\boxed{0.000759524}\n$$", "id": "2893807"}, {"introduction": "Real-world stress states are multi-axial, requiring us to move from a single stress component to the concept of stress space. This practice explores the behavior of a standard $J_{2}$ plasticity model, common for metals, under a non-proportional loading path in the deviatoric stress plane. By deriving the direction of the plastic strain increment, $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$, and analyzing its evolution, you will gain a crucial geometric intuition for the associated flow rule and how it dictates the material's response far from simple monotonic tension [@problem_id:2893825].", "problem": "Consider a rate-independent, small-strain, isotropically hardening elastoplastic solid obeying the second invariant of deviatoric stress ($J_{2}$) plasticity with an associated flow rule. Let the Cauchy stress be $\\boldsymbol{\\sigma}$, the deviatoric stress be $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})\\boldsymbol{I}$, and the second invariant be $J_{2} = \\tfrac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$. The yield function is of the form $f(\\boldsymbol{\\sigma},\\kappa) = \\sqrt{\\tfrac{3}{2}}\\|\\boldsymbol{s}\\| - \\sigma_{y}(\\kappa)$, where $\\kappa$ is a scalar hardening variable and $\\sigma_{y}(\\kappa)$ is the current yield stress. The plastic potential equals the yield function (associated flow), and plastic strain increments satisfy $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} \\propto \\partial f/\\partial \\boldsymbol{\\sigma}$. Assume the loading is such that once yielding starts, the state remains on the yield surface.\n\nDesign the following non-proportional loading path in the deviatoric ($\\pi$-) plane, where each point represents the projection of $\\boldsymbol{s}$:\nStep 1 (radial): Starting from the origin, increase the deviatoric stress $\\boldsymbol{s}$ along a fixed direction until the yield surface is reached at point $A$, which lies at polar angle $\\varphi_{A}$ (measured in the $\\pi$-plane) and at radius equal to the current yield radius.\nStep 2 (circumferential): With the magnitude $\\|\\boldsymbol{s}\\|$ held equal to the current yield radius (i.e., remaining on the yield surface), rotate $\\boldsymbol{s}$ in the $\\pi$-plane by an angle $\\Delta\\varphi = 37$ degrees to reach point $B$.\n\nStarting from the fundamental definitions given above, derive the direction of the plastic strain increment $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ relative to $\\boldsymbol{s}$ for this associated $J_{2}$ plasticity model, and determine the angle in radians between the directions of $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ at points $A$ and $B$ for the loading path described. Express your final answer in radians and round your answer to four significant figures.", "solution": "The problem requires us to analyze the direction of the plastic strain increment for an associated $J_2$ plasticity model and then calculate the angle between the plastic flow directions at two different points on a specified non-proportional loading path.\n\nFirst, we must determine the direction of the plastic strain increment, $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$. The problem states that the material obeys an associated flow rule, which means the plastic potential is the same as the yield function, $f(\\boldsymbol{\\sigma},\\kappa)$. The plastic strain increment is given by the flow rule:\n$$\n\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda \\, \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\n$$\nwhere $\\mathrm{d}\\lambda \\ge 0$ is the plastic multiplier, a scalar representing the magnitude of the plastic flow. The direction of $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ is therefore determined by the gradient of the yield function with respect to the Cauchy stress, $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$.\n\nThe yield function is given as:\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\| - \\sigma_{y}(\\kappa)\n$$\nwhere $\\boldsymbol{s}$ is the deviatoric stress tensor. We can express the norm of the deviatoric stress, $\\|\\boldsymbol{s}\\|$, using the Frobenius norm, which is defined as $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$. The yield function can be rewritten as:\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\sqrt{\\frac{3}{2}}(\\boldsymbol{s}:\\boldsymbol{s})^{\\frac{1}{2}} - \\sigma_{y}(\\kappa)\n$$\nTo find the direction of plastic flow, we calculate the partial derivative of $f$ with respect to $\\boldsymbol{\\sigma}$. The hardening parameter $\\kappa$ is a function of the plastic strain path, but for calculating the gradient of $f$ with respect to stress at a fixed state, $\\kappa$ is held constant. Thus, the term $\\sigma_{y}(\\kappa)$ does not contribute to the gradient with respect to $\\boldsymbol{\\sigma}$.\nUsing the chain rule for tensor calculus, the gradient is:\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{\\frac{3}{2}} \\cdot \\frac{1}{2} (\\boldsymbol{s}:\\boldsymbol{s})^{-\\frac{1}{2}} \\cdot \\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\sqrt{3}}{2\\sqrt{2}\\|\\boldsymbol{s}\\|} \\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}}\n$$\nWe need to compute $\\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}}$. In component form, this is $\\frac{\\partial(s_{kl}s_{kl})}{\\partial \\sigma_{ij}}$.\n$$\n\\frac{\\partial(s_{kl}s_{kl})}{\\partial \\sigma_{ij}} = 2 s_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}}\n$$\nThe deviatoric stress $\\boldsymbol{s}$ is defined as $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})\\boldsymbol{I}$. In components, $s_{kl} = \\sigma_{kl} - \\frac{1}{3}\\sigma_{mm}\\delta_{kl}$. Its derivative with respect to $\\sigma_{ij}$ is:\n$$\n\\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = \\frac{\\partial}{\\partial \\sigma_{ij}} \\left(\\sigma_{kl} - \\frac{1}{3}\\sigma_{mm}\\delta_{kl}\\right) = \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{mi}\\delta_{mj}\\delta_{kl} = \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n$$\nSubstituting this back into the expression for the gradient of the squared norm:\n$$\ns_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = s_{kl} \\left( \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl} \\right) = s_{ij} - \\frac{1}{3}\\delta_{ij}s_{kk}\n$$\nSince $\\boldsymbol{s}$ is a deviatoric tensor, its trace is zero, i.e., $s_{kk} = \\operatorname{tr}(\\boldsymbol{s}) = 0$. Therefore:\n$$\ns_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = s_{ij}\n$$\nIn index-free notation, this is $\\frac{1}{2}\\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}} = \\boldsymbol{s}$.\nSubstituting this result back into the expression for $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$:\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\sqrt{3}}{2\\sqrt{2}\\|\\boldsymbol{s}\\|} (2\\boldsymbol{s}) = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\nThe flow rule thus becomes:\n$$\n\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\nThis result demonstrates that for an associated $J_2$ plasticity model, the plastic strain increment tensor $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ is always coaxial with (i.e., has the same direction as) the deviatoric stress tensor $\\boldsymbol{s}$. This is the Prandtl-Reuss flow rule. The direction of $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ is entirely determined by the direction of $\\boldsymbol{s}$.\n\nNow, we address the second part of the problem. We need to find the angle between the directions of the plastic strain increment at points $A$ and $B$ on the loading path. Let the deviatoric stress tensors at these points be $\\boldsymbol{s}_A$ and $\\boldsymbol{s}_B$, respectively.\nThe direction of the plastic strain increment at point $A$, denoted $\\boldsymbol{N}_A$, is:\n$$\n\\boldsymbol{N}_A = \\frac{\\boldsymbol{s}_A}{\\|\\boldsymbol{s}_A\\|}\n$$\nSimilarly, the direction of the plastic strain increment at point $B$, denoted $\\boldsymbol{N}_B$, is:\n$$\n\\boldsymbol{N}_B = \\frac{\\boldsymbol{s}_B}{\\|\\boldsymbol{s}_B\\|}\n$$\nThe angle $\\psi$ between these two direction tensors $\\boldsymbol{N}_A$ and $\\boldsymbol{N}_B$ is defined via their inner product:\n$$\n\\cos \\psi = \\boldsymbol{N}_A : \\boldsymbol{N}_B = \\frac{\\boldsymbol{s}_A}{\\|\\boldsymbol{s}_A\\|} : \\frac{\\boldsymbol{s}_B}{\\|\\boldsymbol{s}_B\\|} = \\frac{\\boldsymbol{s}_A : \\boldsymbol{s}_B}{\\|\\boldsymbol{s}_A\\| \\|\\boldsymbol{s}_B\\|}\n$$\nThe term on the right-hand side is precisely the cosine of the angle between the deviatoric stress tensors $\\boldsymbol{s}_A$ and $\\boldsymbol{s}_B$ in the $5$-dimensional space of deviatoric tensors.\n\nThe problem describes the loading path in the deviatoric ($\\pi$-) plane. A point in this plane represents a deviatoric stress state, with its distance from the origin corresponding to $\\sqrt{2J_2} = \\|\\boldsymbol{s}\\|$ and its angular position describing the nature of the stress state (e.g., uniaxial tension, pure shear). The problem states that from point $A$ to point $B$, the deviatoric stress $\\boldsymbol{s}$ is rotated by an angle $\\Delta\\varphi = 37$ degrees in the $\\pi$-plane. This geometric rotation in the $\\pi$-plane corresponds to the angle between the tensors $\\boldsymbol{s}_A$ and $\\boldsymbol{s}_B$ in their abstract vector space. Let the angle between $\\boldsymbol{s}_A$ and $\\boldsymbol{s}_B$ be $\\theta$. Then $\\cos\\theta = \\frac{\\boldsymbol{s}_A : \\boldsymbol{s}_B}{\\|\\boldsymbol{s}_A\\| \\|\\boldsymbol{s}_B\\|}$. The description of the loading path implies that this angle $\\theta$ is equal to $\\Delta\\varphi$.\nTherefore, $\\cos \\psi = \\cos(\\Delta\\varphi)$, which implies $\\psi = \\Delta\\varphi$.\n\nThe angle between the directions of the plastic strain increments at points $A$ and $B$ is equal to the angle of rotation of the deviatoric stress tensor in the $\\pi$-plane.\nGiven $\\Delta\\varphi = 37$ degrees. We must express this angle in radians.\n$$\n\\psi = 37^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} \\text{ radians}\n$$\nCalculating the numerical value:\n$$\n\\psi = \\frac{37\\pi}{180} \\approx 0.6457718... \\text{ radians}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\psi \\approx 0.6458 \\text{ radians}\n$$", "answer": "$$\n\\boxed{0.6458}\n$$", "id": "2893825"}, {"introduction": "Not all materials behave like metals; many, such as soils, rocks, and concrete, exhibit responses that depend heavily on hydrostatic pressure. This final practice challenges you to derive and implement return-mapping algorithms for both the pressure-insensitive von Mises ($J_{2}$) model and the pressure-sensitive Drucker-Prager model. By directly comparing the resulting update equations and numerical results, you will uncover the profound effect of pressure-sensitivity on plastic flow, particularly the emergence of plastic volume change, often referred to as dilatancy or compaction [@problem_id:2893781].", "problem": "You are asked to develop, from first principles, an implicit backward-Euler return-mapping algorithm for an associated Drucker–Prager (DP) plasticity model and to contrast it with the classical von Mises (also known as second deviatoric invariant, or $J_{2}$) radial return. Your derivation and implementation must consistently use small-strain isotropic linear elasticity and the standard stress invariants. Specifically, proceed from the following fundamental bases and core definitions, without invoking any pre-derived update formulas.\n\nAssumptions and definitions:\n- Use small-strain kinematics and isotropic linear elasticity with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The Lamé constants are $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$, and the bulk modulus is $K = \\lambda + \\dfrac{2}{3}\\mu$.\n- Adopt a tension-positive sign convention for Cauchy stress $\\boldsymbol{\\sigma}$. Define the mean (pressure) stress $p$ by $p = -\\dfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$ so that $p$ is positive in compression. Define the deviatoric stress $\\mathbf{s} = \\boldsymbol{\\sigma} - \\dfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\mathbf{I}$. Define the equivalent stress $q = \\sqrt{\\dfrac{3}{2}} \\lVert \\mathbf{s} \\rVert$ where $\\lVert \\cdot \\rVert$ denotes the Frobenius norm.\n- The Drucker–Prager yield function is $f_{\\mathrm{DP}}(\\boldsymbol{\\sigma}, \\bar{\\varepsilon}^{p}) = q + \\alpha p - \\left(k_{0} + H \\bar{\\varepsilon}^{p}\\right)$, with friction parameter $\\alpha$, initial cohesion-like parameter $k_{0}$, isotropic hardening modulus $H$, and equivalent plastic strain $\\bar{\\varepsilon}^{p}$.\n- The von Mises ($J_{2}$) yield function is $f_{J_{2}}(\\boldsymbol{\\sigma}, \\bar{\\varepsilon}^{p}) = q - \\left(k_{0} + H \\bar{\\varepsilon}^{p}\\right)$.\n- Use associated plastic flow for both models; that is, the plastic flow direction equals the gradient of the corresponding yield function with respect to $\\boldsymbol{\\sigma}$. Use an implicit backward-Euler time discretization for the plastic corrector step.\n- The elastic trial state is obtained by $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon}$ with $\\mathbb{C}$ the elastic stiffness tensor and $\\Delta \\boldsymbol{\\varepsilon}$ the total strain increment. Plastic correction is required only if the trial yield function value is positive.\n\nTasks:\n1. Starting from the above definitions and the principle of maximum plastic dissipation for associated flow, derive the return-mapping equations for the Drucker–Prager model using an implicit backward-Euler scheme. Your derivation must explicitly track the coupling between $p$ and $q$ introduced by the parameter $\\alpha$, and it must be expressed in terms of the scalar plastic multiplier increment $\\Delta \\gamma$.\n2. Derive, from the same base, the return-mapping equations for the von Mises ($J_{2}$) model, emphasizing the structure of the radial return in deviatoric stress space and explaining why the hydrostatic stress $p$ remains unchanged in the plastic corrector for $J_{2}$.\n3. Explain, at the level of the governing update equations, how and why the coupling between $p$ and $q$ in Drucker–Prager produces a nonzero volumetric plastic strain increment and a shift in $p$ during the corrector, in contrast to the $J_{2}$ case.\n\nImplementation requirements:\n- Implement a program that, for each test case below, computes the updated Drucker–Prager and von Mises states after a single strain increment $\\Delta \\boldsymbol{\\varepsilon}$. Assume the initial stress is zero and the initial equivalent plastic strain $\\bar{\\varepsilon}^{p}_{n}$ is given per test. Use a $3 \\times 3$ symmetric strain tensor with tensorial shear components (not engineering shear). From the updated stresses, report the invariants $p$ and $q$, the updated equivalent plastic strain $\\bar{\\varepsilon}^{p}$, and the plastic multiplier increment $\\Delta \\gamma$. If the step is elastic, report $\\Delta \\gamma = 0$.\n- Physical units: use megapascals (MPa) for all stresses ($E$, $k_{0}$, $H$, $p$, $q$). Strains and $\\bar{\\varepsilon}^{p}$ are dimensionless. Report all floating-point outputs rounded to exactly six decimals.\n- Angle unit is not applicable in this problem.\n\nTest suite:\nProvide results for the following four test cases. For each case, the input tuple is $(E,\\nu,k_{0},H,\\alpha,\\bar{\\varepsilon}^{p}_{n},\\Delta \\boldsymbol{\\varepsilon})$ with $\\Delta \\boldsymbol{\\varepsilon}$ given as $(\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},\\varepsilon_{12},\\varepsilon_{23},\\varepsilon_{13})$ in tensorial shear components:\n- Case 1: $(E,\\nu,k_{0},H,\\alpha,\\bar{\\varepsilon}^{p}_{n},\\Delta \\boldsymbol{\\varepsilon}) = (210000, 0.3, 200, 1000, 0.1, 0, (1e-6, 1e-6, 1e-6, 0, 0, 0))$\n- Case 2: $(E,\\nu,k_{0},H,\\alpha,\\bar{\\varepsilon}^{p}_{n},\\Delta \\boldsymbol{\\varepsilon}) = (210000, 0.3, 200, 1000, 0.1, 0, (0, 0, 0, 1e-3, 0, 0))$\n- Case 3: $(E,\\nu,k_{0},H,\\alpha,\\bar{\\varepsilon}^{p}_{n},\\Delta \\boldsymbol{\\varepsilon}) = (210000, 0.29, 20, 100, 0.3, 0, (-5e-3, -5e-3, -5e-3, 0, 0, 0))$\n- Case 4: $(E,\\nu,k_{0},H,\\alpha,\\bar{\\varepsilon}^{p}_{n},\\Delta \\boldsymbol{\\varepsilon}) = (70000, 0.25, 100, 500, 0.2, 0.05, (4e-4, -1e-4, 0, 3e-4, 0, 0))$\n\nFor each case, compute both:\n- Drucker–Prager updated invariants and plastic quantities: $(p_{\\mathrm{DP}}, q_{\\mathrm{DP}}, \\bar{\\varepsilon}^{p}_{\\mathrm{DP}}, \\Delta \\gamma_{\\mathrm{DP}})$\n- von Mises ($J_{2}$) updated invariants and plastic quantities: $(p_{J_{2}}, q_{J_{2}}, \\bar{\\varepsilon}^{p}_{J_{2}}, \\Delta \\gamma_{J_{2}})$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes one inner list of exactly eight floats in the following order:\n$[\\,p_{\\mathrm{DP}}, q_{\\mathrm{DP}}, \\bar{\\varepsilon}^{p}_{\\mathrm{DP}}, \\Delta \\gamma_{\\mathrm{DP}}, p_{J_{2}}, q_{J_{2}}, \\bar{\\varepsilon}^{p}_{J_{2}}, \\Delta \\gamma_{J_{2}}\\,]$.\nThus the full output is a list of four such inner lists: $[\\,[\\cdot],\\,[\\cdot],\\,[\\cdot],\\,[\\cdot]\\,]$. All stresses must be in MPa and all numbers rounded to exactly six decimals, with no additional text.", "solution": "The problem requires the derivation and implementation of return-mapping algorithms for Drucker-Prager and von Mises plasticity models. The analysis must begin from first principles, assuming small-strain isotropic linear elasticity and an implicit backward-Euler integration scheme.\n\nThe foundation of the incremental elasto-plastic framework is the additive decomposition of the total strain increment $\\Delta\\boldsymbol{\\varepsilon}$ into an elastic part $\\Delta\\boldsymbol{\\varepsilon}^e$ and a plastic part $\\Delta\\boldsymbol{\\varepsilon}^p$:\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^e + \\Delta\\boldsymbol{\\varepsilon}^p\n$$\nThe stress at the end of the increment, $\\boldsymbol{\\sigma}_{n+1}$, is related to the elastic strain $\\boldsymbol{\\varepsilon}^e_{n+1}$ by the isotropic linear elastic law:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\mathbb{C} : \\boldsymbol{\\varepsilon}^e_{n+1} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}^e_n + \\Delta\\boldsymbol{\\varepsilon}^e)\n$$\nwhere $\\mathbb{C}$ is the fourth-order elastic stiffness tensor. Substituting $\\Delta\\boldsymbol{\\varepsilon}^e = \\Delta\\boldsymbol{\\varepsilon} - \\Delta\\boldsymbol{\\varepsilon}^p$ and recognizing that $\\boldsymbol{\\sigma}_n = \\mathbb{C}:\\boldsymbol{\\varepsilon}^e_n$, we obtain the stress update relation:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_n + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p\n$$\nThis relation is central to the return-mapping algorithm. The procedure begins by calculating a trial elastic stress, $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$, assuming the entire strain increment is elastic ($\\Delta\\boldsymbol{\\varepsilon}^p = \\mathbf{0}$):\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}\n$$\nThe stress update then becomes:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}^p\n$$\nPlastic deformation occurs only if the trial state violates the yield condition. For a generic yield function $f(\\boldsymbol{\\sigma}, \\bar{\\varepsilon}^p)$, plasticity is initiated if $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}, \\bar{\\varepsilon}^p_n) > 0$. If this holds, a plastic correction is applied.\n\nThe plastic strain increment is determined by an associated flow rule, discretized using the implicit backward-Euler scheme:\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\mathbf{N}_{n+1} \\quad \\text{where} \\quad \\mathbf{N}_{n+1} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\bigg|_{\\boldsymbol{\\sigma}_{n+1}}\n$$\nHere, $\\Delta\\gamma \\ge 0$ is the scalar plastic multiplier increment. The evolution of the isotropic hardening variable, the equivalent plastic strain $\\bar{\\varepsilon}^p$, is given by $\\Delta\\bar{\\varepsilon}^p = \\Delta\\gamma$. This follows from the principle of maximum plastic dissipation for the chosen form of the yield functions.\n\nThe final state $(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1})$ must satisfy the Karush-Kuhn-Tucker (KKT) conditions:\n$f(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1}) \\le 0$, $\\Delta\\gamma \\ge 0$, and $\\Delta\\gamma f(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1}) = 0$. For a plastic step, this means the final state must lie on the updated yield surface: $f_{n+1}=0$.\n\nFor isotropic elasticity, the stiffness tensor acts as $\\mathbb{C} : \\mathbf{A} = \\lambda \\operatorname{tr}(\\mathbf{A})\\mathbf{I} + 2\\mu\\mathbf{A}$ for any second-order tensor $\\mathbf{A}$. The stress update can be decomposed into volumetric and deviatoric parts. The mean pressure $p = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ and deviatoric stress $\\mathbf{s}$ update as:\n$$\np_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)\n$$\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu \\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{dev}}\n$$\nwhere $K$ is the bulk modulus, $\\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{dev}}$ is the deviatoric part of the plastic strain increment, and the trial state quantities are calculated from $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$.\n\n### Task 1: Drucker–Prager Return Mapping\n\nThe DP yield function is $f_{\\mathrm{DP}} = q + \\alpha p - k(\\bar{\\varepsilon}^p)$, with $k(\\bar{\\varepsilon}^p) = k_0 + H\\bar{\\varepsilon}^p$.\nThe gradient of $f_{\\mathrm{DP}}$ with respect to $\\boldsymbol{\\sigma}$ defines the plastic flow direction $\\mathbf{N}$:\n$$\n\\mathbf{N} = \\frac{\\partial f_{\\mathrm{DP}}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\alpha \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\mathbf{s} - \\frac{\\alpha}{3}\\mathbf{I}\n$$\nThe plastic strain increment is $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\mathbf{N}_{n+1} = \\Delta\\gamma \\left( \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1} - \\frac{\\alpha}{3}\\mathbf{I} \\right)$.\nThe trace of the plastic strain increment is $\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = \\Delta\\gamma \\operatorname{tr}(\\mathbf{N}_{n+1}) = \\Delta\\gamma (-\\alpha) = -\\alpha \\Delta\\gamma$.\nThe deviatoric part is $\\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{dev}} = \\Delta\\gamma \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1}$.\n\nSubstituting these into the decomposed stress update equations:\n1.  Pressure update: $p_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma$.\n2.  Deviatoric stress update: $\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu \\left( \\Delta\\gamma \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1} \\right) = \\mathbf{s}^{\\mathrm{tr}} - \\frac{3\\mu\\Delta\\gamma}{q_{n+1}}\\mathbf{s}_{n+1}$.\nThis second relation implies that $\\mathbf{s}_{n+1}$ is coaxial with $\\mathbf{s}^{\\mathrm{tr}}$, i.e., $\\mathbf{s}_{n+1} \\left(1 + \\frac{3\\mu\\Delta\\gamma}{q_{n+1}}\\right) = \\mathbf{s}^{\\mathrm{tr}}$. Taking the norm and converting to $q = \\sqrt{3/2}\\|\\mathbf{s}\\|$:\n$q_{n+1} \\left(1 + \\frac{3\\mu\\Delta\\gamma}{q_{n+1}}\\right) = q^{\\mathrm{tr}}$, which simplifies to $q_{n+1} + 3\\mu\\Delta\\gamma = q^{\\mathrm{tr}}$, or $q_{n+1} = q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma$.\n\nWe now have a system of two algebraic equations for $p_{n+1}$ and $q_{n+1}$ in terms of $\\Delta\\gamma$, plus the consistency condition $f_{\\mathrm{DP}}(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1}) = 0$:\n$$\n\\begin{cases}\np_{n+1} = p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma \\\\\nq_{n+1} = q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma \\\\\nq_{n+1} + \\alpha p_{n+1} - \\left(k_0 + H(\\bar{\\varepsilon}^p_n + \\Delta\\gamma)\\right) = 0\n\\end{cases}\n$$\nSubstituting the first two equations into the third yields a single equation for $\\Delta\\gamma$:\n$$\n(q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma) + \\alpha(p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma) - \\left(k_0 + H\\bar{\\varepsilon}^p_n + H\\Delta\\gamma\\right) = 0\n$$\nRearranging to solve for $\\Delta\\gamma$:\n$$\n(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - (k_0 + H\\bar{\\varepsilon}^p_n)) - \\Delta\\gamma(3\\mu + K\\alpha^2 + H) = 0\n$$\nThe first term is the trial yield function value, $f^{\\mathrm{tr}}_{\\mathrm{DP}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k_n$, where $k_n = k_0 + H\\bar{\\varepsilon}^p_n$. Thus, the plastic multiplier is:\n$$\n\\Delta\\gamma = \\frac{f^{\\mathrm{tr}}_{\\mathrm{DP}}}{3\\mu + K\\alpha^2 + H}\n$$\nThis expression is valid for $f^{\\mathrm{tr}}_{\\mathrm{DP}} > 0$. If $f^{\\mathrm{tr}}_{\\mathrm{DP}} \\le 0$, the step is elastic and $\\Delta\\gamma = 0$.\n\n### Task 2: von Mises ($J_{2}$) Return Mapping\n\nThe von Mises yield function is a special case of Drucker-Prager with $\\alpha = 0$:\n$$\nf_{J_2} = q - k(\\bar{\\varepsilon}^p)\n$$\nThe derivation is identical, simply setting $\\alpha=0$ in the DP equations.\nThe plastic flow direction $\\mathbf{N}$ becomes purely deviatoric:\n$$\n\\mathbf{N} = \\frac{\\partial f_{J_2}}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\mathbf{s}\n$$\nThe trace is $\\operatorname{tr}(\\mathbf{N}) = 0$. Consequently, the volumetric plastic strain increment is zero: $\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = 0$.\nThe update equations for the invariants become:\n1.  Pressure update: $p_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = p^{\\mathrm{tr}}$. The pressure does not change during the plastic correction.\n2.  Equivalent stress update: $q_{n+1} = q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma$. This form is identical to that for DP.\n\nThe consistency condition is $q_{n+1} - (k_n + H\\Delta\\gamma) = 0$. Substituting the update for $q_{n+1}$:\n$$\n(q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma) - (k_n + H\\Delta\\gamma) = 0\n$$\nSolving for $\\Delta\\gamma$:\n$$\nq^{\\mathrm{tr}} - k_n = \\Delta\\gamma(3\\mu + H)\n$$\nThe term $q^{\\mathrm{tr}} - k_n$ is the trial yield function value, $f^{\\mathrm{tr}}_{J_2}$. Thus:\n$$\n\\Delta\\gamma = \\frac{f^{\\mathrm{tr}}_{J_2}}{3\\mu + H}\n$$\nThe update algorithm for $\\mathbf{s}_{n+1}$ is $\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} \\left(1 - \\frac{3\\mu\\Delta\\gamma}{q^{\\mathrm{tr}}}\\right)$. This shows that the corrected deviatoric stress $\\mathbf{s}_{n+1}$ is obtained by scaling the trial deviatoric stress $\\mathbf{s}^{\\mathrm{tr}}$ along the same direction back to the yield surface. This geometric operation is known as a \"radial return\" in the deviatoric stress space.\n\n### Task 3: Comparison of Drucker-Prager and von Mises Models\n\nThe fundamental difference between the two models lies in their dependence on the hydrostatic stress component.\n\nFor the von Mises ($J_2$) model, the yield function $f_{J_2} = q - k(\\bar{\\varepsilon}^p)$ depends only on the second invariant of the deviatoric stress (represented by $q$). It is independent of the mean pressure $p$. Consequently, the gradient $\\mathbf{N}_{J_2} = \\partial f_{J_2} / \\partial\\boldsymbol{\\sigma}$ is a purely deviatoric tensor, meaning $\\operatorname{tr}(\\mathbf{N}_{J_2}) = 0$. According to the associated flow rule, the plastic strain increment $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\mathbf{N}_{J_2}$ is also purely deviatoric, i.e., $\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = 0$. This implies plastic incompressibility. The pressure update equation $p_{n+1} = p^{\\mathrm{tr}} + K\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)$ simplifies to $p_{n+1} = p^{\\mathrm{tr}}$, confirming that pressure is unaffected by the plastic corrector.\n\nFor the Drucker-Prager model, the yield function $f_{\\mathrm{DP}} = q + \\alpha p - k(\\bar{\\varepsilon}^p)$ includes the mean pressure $p$. This coupling, introduced by the friction parameter $\\alpha \\ne 0$, has profound consequences. The gradient $\\mathbf{N}_{\\mathrm{DP}} = \\partial f_{\\mathrm{DP}} / \\partial\\boldsymbol{\\sigma}$ now contains a volumetric part:\n$$\n\\mathbf{N}_{\\mathrm{DP}} = \\frac{3}{2q}\\mathbf{s} - \\frac{\\alpha}{3}\\mathbf{I}\n$$\nIts trace is non-zero: $\\operatorname{tr}(\\mathbf{N}_{\\mathrm{DP}}) = -\\alpha$. This leads to a non-zero volumetric plastic strain increment: $\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = -\\alpha \\Delta\\gamma$. For typical geotechnical materials, $\\alpha > 0$, so yielding results in plastic compaction ($\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) < 0$) under compressive states, or dilation under tensile states, depending on the sign of $p$. The pressure update equation, $p_{n+1} = p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma$, explicitly shows that the mean pressure changes during the plastic correction step. This coupling between deviatoric and volumetric responses is a key feature of pressure-sensitive materials like soils, rocks, and concrete, which the Drucker-Prager model is designed to represent. The von Mises model, in contrast, is suited for metals where plastic flow is largely independent of pressure.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the updated stress state for Drucker-Prager and von Mises models\n    for a suite of test cases.\n    \"\"\"\n    \n    # Test cases: (E, nu, k0, H, alpha, ep_n, (e11, e22, e33, e12, e23, e13))\n    test_cases = [\n        (210000.0, 0.3, 200.0, 1000.0, 0.1, 0.0, (1e-6, 1e-6, 1e-6, 0.0, 0.0, 0.0)),\n        (210000.0, 0.3, 200.0, 1000.0, 0.1, 0.0, (0.0, 0.0, 0.0, 1e-3, 0.0, 0.0)),\n        (210000.0, 0.29, 20.0, 100.0, 0.3, 0.0, (-5e-3, -5e-3, -5e-3, 0.0, 0.0, 0.0)),\n        (70000.0, 0.25, 100.0, 500.0, 0.2, 0.05, (4e-4, -1e-4, 0.0, 3e-4, 0.0, 0.0)),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E, nu, k0, H, alpha, ep_n, delta_eps_vec = case\n\n        # --- 1. Pre-computation and Trial State ---\n\n        # Elastic constants\n        lame_lambda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n        mu = E / (2 * (1 + nu))\n        K = lame_lambda + (2 / 3) * mu\n\n        # Construct strain increment tensor (tensorial shear)\n        delta_eps = np.zeros((3, 3))\n        delta_eps[0, 0], delta_eps[1, 1], delta_eps[2, 2] = delta_eps_vec[0], delta_eps_vec[1], delta_eps_vec[2]\n        delta_eps[0, 1] = delta_eps[1, 0] = delta_eps_vec[3]\n        delta_eps[1, 2] = delta_eps[2, 1] = delta_eps_vec[4]\n        delta_eps[0, 2] = delta_eps[2, 0] = delta_eps_vec[5]\n        \n        # Initial state (stress is zero)\n        sigma_n = np.zeros((3, 3))\n\n        # Trial stress (sigma_n is zero)\n        tr_delta_eps = np.trace(delta_eps)\n        sigma_tr = lame_lambda * tr_delta_eps * np.identity(3) + 2 * mu * delta_eps\n\n        # Trial invariants\n        tr_sigma_tr = np.trace(sigma_tr)\n        p_tr = -tr_sigma_tr / 3.0\n        s_tr = sigma_tr - (tr_sigma_tr / 3.0) * np.identity(3)\n        # Frobenius norm squared: np.sum(s_tr*s_tr)\n        q_tr = np.sqrt(3.0 / 2.0 * np.sum(s_tr * s_tr))\n        \n        # Initial yield strength\n        k_n = k0 + H * ep_n\n\n        # --- 2. Drucker-Prager Model ---\n\n        # Check trial yield condition\n        f_tr_dp = q_tr + alpha * p_tr - k_n\n        \n        if f_tr_dp <= 0:  # Elastic step\n            p_dp = p_tr\n            q_dp = q_tr\n            ep_dp = ep_n\n            dgamma_dp = 0.0\n        else:  # Plastic step\n            denominator_dp = 3 * mu + K * alpha**2 + H\n            dgamma_dp = f_tr_dp / denominator_dp\n            \n            p_dp = p_tr - K * alpha * dgamma_dp\n            q_dp = q_tr - 3 * mu * dgamma_dp\n            ep_dp = ep_n + dgamma_dp\n\n        # --- 3. von Mises (J2) Model ---\n\n        # Check trial yield condition\n        f_tr_j2 = q_tr - k_n\n\n        if f_tr_j2 <= 0: # Elastic step\n            p_j2 = p_tr\n            q_j2 = q_tr\n            ep_j2 = ep_n\n            dgamma_j2 = 0.0\n        else: # Plastic step\n            denominator_j2 = 3 * mu + H\n            dgamma_j2 = f_tr_j2 / denominator_j2\n            \n            p_j2 = p_tr # Pressure is unchanged\n            # q can be updated in two consistent ways:\n            # q_j2 = q_tr - 3 * mu * dgamma_j2\n            q_j2 = k_n + H * dgamma_j2 # Enforces return to updated surface\n            ep_j2 = ep_n + dgamma_j2\n\n        # --- 4. Collect and format results ---\n        \n        case_results = [\n            round(p_dp, 6), round(q_dp, 6), round(ep_dp, 6), round(dgamma_dp, 6),\n            round(p_j2, 6), round(q_j2, 6), round(ep_j2, 6), round(dgamma_j2, 6),\n        ]\n        all_results.append(case_results)\n\n    # Format output as a string representing a list of lists\n    # Each inner list is converted to a string, then joined by commas\n    # Example: \"[-0.525000,0.000000,...]\"\n    inner_lists_str = [f\"[{','.join(f'{x:.6f}' for x in res)}]\" for res in all_results]\n    print(f\"[{','.join(inner_lists_str)}]\")\n\n\nsolve()\n```", "id": "2893781"}]}