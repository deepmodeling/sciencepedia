{"hands_on_practices": [{"introduction": "To understand the behavior of beams beyond their elastic limit, we must first establish the foundational concepts of plastic analysis. This practice guides you through the process of deriving the yield moment ($M_y$), the fully plastic moment ($M_p$), and the shape factor for a simple rectangular cross-section from first principles. By working through this fundamental example [@problem_id:2908840], you will build a solid understanding of a section's plastic reserve capacity, which is the basis for a more advanced plastic design and collapse analysis.", "problem": "A straight, prismatic beam of homogeneous, isotropic, elastic-perfectly plastic material with uniaxial yield stress $\\sigma_{y}$ (tension-compression symmetric) has a rectangular cross-section of width $b$ and height $h$. The beam is subjected to a monotonically increasing, statically applied bending moment $M$ about its strong centroidal axis so that the top fibers are in compression and the bottom fibers are in tension. Assume small strains, plane sections remain plane, no axial force, and neglect shear deformation and strain hardening.\n\nStarting only from the fundamentals of elastic bending and the definition of the fully plastic state in an elastic-perfectly plastic material, perform the following:\n\n- Using the linear elastic bending relation and the second moment of area of a rectangle, determine the elastic section modulus $S$ of the cross-section about the bending axis in terms of $b$ and $h$.\n- Using the definition of first yielding (the extreme fiber reaches $\\sigma_{y}$), determine the elastic yield moment $M_{y}$ in terms of $\\sigma_{y}$, $b$, and $h$.\n- At the onset of the fully plastic state (no elastic core remaining), enforce internal force equilibrium and compute the fully plastic moment $M_{p}$ by integrating the elastic-perfectly plastic stress distribution over the cross-section. Express $M_{p}$ in terms of $\\sigma_{y}$, $b$, and $h$.\n- Finally, set up the comparison of $M_{y}$ and $M_{p}$ and provide the shape factor defined as $M_{p}/M_{y}$.\n\nProvide your final answer as the exact value of $M_{p}/M_{y}$ (dimensionless). Do not round. Express the final answer as a reduced fraction.", "solution": "The problem as stated is a standard, fundamental exercise in the mechanics of materials. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is therefore deemed valid. We proceed with the derivation.\n\nThe analysis begins with the principles of linear elastic bending. For a beam subjected to a pure bending moment $M$ about its strong centroidal axis, the normal stress $\\sigma_x$ at a distance $y$ from the neutral axis is given by the flexure formula:\n$$\n\\sigma_x(y) = -\\frac{M y}{I}\n$$\nwhere $I$ is the second moment of area of the cross-section about the neutral axis. The sign convention assumes that a positive bending moment $M$ induces tension (positive stress) for negative $y$ values (bottom fibers) and compression (negative stress) for positive $y$ values (top fibers), consistent with the problem statement.\n\nThe maximum magnitude of the stress, $\\sigma_{max}$, occurs at the extreme fibers, where $y = \\pm \\frac{h}{2}$. Let $c$ denote the distance to the extreme fiber, so $c = \\frac{h}{2}$.\n$$\n\\sigma_{max} = \\frac{M c}{I} = \\frac{M}{I/c}\n$$\n\nThe first task is to determine the elastic section modulus, $S$. This is defined as $S = \\frac{I}{c}$. For a rectangular cross-section of width $b$ and height $h$, the second moment of area about the centroidal axis is:\n$$\nI = \\int_A y^2 dA = \\int_{-h/2}^{h/2} y^2 (b \\, dy) = b \\left[ \\frac{y^3}{3} \\right]_{-h/2}^{h/2} = b \\left( \\frac{(h/2)^3}{3} - \\frac{(-h/2)^3}{3} \\right) = b \\left( \\frac{h^3}{24} + \\frac{h^3}{24} \\right) = \\frac{bh^3}{12}\n$$\nWith $c = \\frac{h}{2}$, the elastic section modulus $S$ is:\n$$\nS = \\frac{I}{c} = \\frac{bh^3/12}{h/2} = \\frac{bh^2}{6}\n$$\n\nThe second task is to determine the elastic yield moment, $M_y$. This is the bending moment at which the stress at the extreme fiber first reaches the material's yield stress, $\\sigma_y$.\n$$\n\\sigma_{max} = \\sigma_y\n$$\nSubstituting this into the flexure formula relates $M_y$ to $\\sigma_y$ and $S$:\n$$\n\\sigma_y = \\frac{M_y}{S}\n$$\nTherefore, the yield moment is:\n$$\nM_y = S \\sigma_y = \\frac{bh^2}{6} \\sigma_y\n$$\n\nThe third task is to compute the fully plastic moment, $M_p$. At this stage, the bending moment has increased sufficiently such that every fiber in the cross-section has yielded. In this idealized elastic-perfectly plastic material model, the stress magnitude throughout the entire cross-section is equal to the yield stress, $\\sigma_y$. The neutral axis remains at the geometric centroid due to the symmetry of the cross-section and the tension-compression symmetry of the material.\n\nThe stress distribution is discontinuous:\n$$\n\\sigma_x(y) = \n\\begin{cases} \n      -\\sigma_y & \\text{for } 0 < y \\le \\frac{h}{2} \\quad \\text{(Compression)} \\\\\n      \\sigma_y & \\text{for } -\\frac{h}{2} \\le y < 0 \\quad \\text{(Tension)}\n\\end{cases}\n$$\nThe fully plastic moment $M_p$ is the internal resisting moment generated by this stress distribution. It is calculated by integrating the moment contribution from the differential force $dF = \\sigma_x dA$ over the area $A$ of the cross-section.\n$$\nM_p = -\\int_A y \\, \\sigma_x(y) \\, dA\n$$\nWe separate the integral over the compression (top half, $A_c$) and tension (bottom half, $A_t$) regions. The differential area is $dA = b \\, dy$.\n$$\nM_p = - \\left( \\int_{0}^{h/2} y (-\\sigma_y) (b \\, dy) + \\int_{-h/2}^{0} y (\\sigma_y) (b \\, dy) \\right)\n$$\n$$\nM_p = b \\sigma_y \\int_{0}^{h/2} y \\, dy - b \\sigma_y \\int_{-h/2}^{0} y \\, dy\n$$\n$$\nM_p = b \\sigma_y \\left[ \\frac{y^2}{2} \\right]_{0}^{h/2} - b \\sigma_y \\left[ \\frac{y^2}{2} \\right]_{-h/2}^{0}\n$$\n$$\nM_p = b \\sigma_y \\left( \\frac{(h/2)^2}{2} - 0 \\right) - b \\sigma_y \\left( 0 - \\frac{(-h/2)^2}{2} \\right)\n$$\n$$\nM_p = b \\sigma_y \\left( \\frac{h^2}{8} \\right) - b \\sigma_y \\left( -\\frac{h^2}{8} \\right) = \\frac{b h^2 \\sigma_y}{8} + \\frac{b h^2 \\sigma_y}{8}\n$$\n$$\nM_p = \\frac{b h^2 \\sigma_y}{4}\n$$\n\nThe final task is to compute the shape factor, which is the ratio of the fully plastic moment $M_p$ to the yield moment $M_y$. This dimensionless factor quantifies the additional bending capacity of the section beyond initial yielding due to plastic redistribution of stress.\n$$\n\\text{Shape Factor} = \\frac{M_p}{M_y}\n$$\nSubstituting the derived expressions for $M_p$ and $M_y$:\n$$\n\\frac{M_p}{M_y} = \\frac{\\frac{b h^2 \\sigma_y}{4}}{\\frac{b h^2 \\sigma_y}{6}}\n$$\nThe terms $\\sigma_y$, $b$, and $h^2$ are common to both the numerator and the denominator and thus cancel out.\n$$\n\\frac{M_p}{M_y} = \\frac{1/4}{1/6} = \\frac{1}{4} \\times 6 = \\frac{6}{4} = \\frac{3}{2}\n$$\nThe shape factor for a rectangular cross-section is $\\frac{3}{2}$.", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "2908840"}, {"introduction": "Plastic deformation is not a fully reversible process, and its history can leave a permanent mark on a material in the form of residual stresses. This exercise [@problem_id:2215767] delves into this crucial phenomenon by asking you to calculate the residual stress distribution in a beam after it has been partially yielded and then unloaded. The use of a hypothetical material with different yield strengths in tension and compression introduces an asymmetric response, forcing a careful application of equilibrium principles to track the neutral axis and providing deeper insight into how \"locked-in\" stresses are created.", "problem": "A straight beam of rectangular cross-section with width $b$ and height $h$ is subjected to a pure bending moment. The beam is made from a special elastic-perfectly plastic material. This material has a Young's modulus $E$ and exhibits different yield strengths in tension and compression. The yield strength in tension is $\\sigma_{YT}$, and the yield strength in compression is $\\sigma_{YC} = 2\\sigma_{YT}$.\n\nA positive bending moment $M$ is applied about the horizontal axis through the centroid of the cross-section, inducing compression in the top fibers ($y>0$) and tension in the bottom fibers ($y<0$), where $y$ is the vertical coordinate measured from the centroidal axis. The moment is gradually increased until the plastic yielding, which begins at the bottom surface ($y=-h/2$), has propagated inwards to a distance of $h/4$ from that surface. After reaching this state, the bending moment is completely removed.\n\nDue to the plastic deformation, residual stresses remain in the beam. Determine the vertical position $y$, expressed in terms of $h$, of the point of zero residual stress that is located closest to the bottom surface of the beam.", "solution": "The solution involves a three-stage process: 1) analyzing the stress distribution during the application of the bending moment, 2) determining the elastic stress distribution associated with unloading the moment, and 3) superimposing these to find the residual stress distribution.\n\n**1. Stress Distribution during Loading**\n\nLet $y$ be the vertical coordinate measured from the geometric centroid of the rectangular cross-section. The beam height spans from $y=-h/2$ to $y=h/2$. A positive bending moment causes tension ($\\sigma > 0$) for $y<0$ and compression ($\\sigma < 0$) for $y>0$.\n\nThe material is elastic-perfectly plastic. Yielding begins on the tensile side first because $\\sigma_{YT} < \\sigma_{YC}$. The problem states that the plastic zone has propagated from the bottom surface ($y=-h/2$) to a distance of $h/4$. This means the elastic-plastic interface on the tensile side is at $y_T = -h/2 + h/4 = -h/4$.\nSo, for $-h/2 \\le y \\le -h/4$, the beam is in a state of plastic tension, and the stress is constant: $\\sigma(y) = \\sigma_{YT}$.\n\nIn the region $-h/4 < y \\le h/2$, the material is still elastic (we will verify this assumption for the compression side later). The strain distribution across the beam cross-section is linear, even with plastic zones. However, due to the asymmetric yielding, the neutral axis (where strain is zero) will shift from the geometric centroid. Let the position of the neutral axis be $y_{NA}$. The strain is given by $\\epsilon(y) = -\\kappa(y - y_{NA})$, where $\\kappa$ is the curvature.\n\nThe stress in the elastic region is $\\sigma(y) = E\\epsilon(y) = -E\\kappa(y - y_{NA})$.\nAt the elastic-plastic boundary $y_T = -h/4$, the stress is precisely the tensile yield strength, $\\sigma(y_T) = \\sigma_{YT}$.\nSo, $\\sigma_{YT} = -E\\kappa(-h/4 - y_{NA}) = E\\kappa(h/4 + y_{NA})$. This gives a relationship for the curvature term: $E\\kappa = \\frac{\\sigma_{YT}}{h/4 + y_{NA}}$.\nThe stress in the elastic region can be written as: $\\sigma(y) = -\\frac{\\sigma_{YT}}{h/4 + y_{NA}}(y - y_{NA})$.\n\nTo find $y_{NA}$, we enforce the condition that there is no net axial force on the cross-section: $\\int_A \\sigma(y) dA = 0$. Since the width $b$ is constant, this simplifies to $\\int_{-h/2}^{h/2} \\sigma(y) dy = 0$.\nWe split the integral into the plastic and elastic zones:\n$$ \\int_{-h/2}^{-h/4} \\sigma_{YT} dy + \\int_{-h/4}^{h/2} \\left(-\\frac{\\sigma_{YT}}{h/4 + y_{NA}}(y - y_{NA})\\right) dy = 0 $$\nDividing by $\\sigma_{YT}$ (which is non-zero):\n$$ \\int_{-h/2}^{-h/4} 1 \\, dy - \\frac{1}{h/4 + y_{NA}} \\int_{-h/4}^{h/2} (y - y_{NA}) dy = 0 $$\n$$ [y]_{-h/2}^{-h/4} = \\frac{1}{h/4 + y_{NA}} \\left[\\frac{y^2}{2} - y_{NA}y \\right]_{-h/4}^{h/2} $$\n$$ (-h/4) - (-h/2) = \\frac{1}{h/4 + y_{NA}} \\left[ \\left(\\frac{h^2}{8} - \\frac{y_{NA}h}{2}\\right) - \\left(\\frac{h^2}{32} + \\frac{y_{NA}h}{4}\\right) \\right] $$\n$$ \\frac{h}{4} = \\frac{1}{h/4 + y_{NA}} \\left( \\frac{3h^2}{32} - \\frac{3y_{NA}h}{4} \\right) $$\n$$ \\frac{h}{4}\\left(\\frac{h}{4} + y_{NA}\\right) = \\frac{3h^2}{32} - \\frac{3y_{NA}h}{4} $$\n$$ \\frac{h^2}{16} + \\frac{hy_{NA}}{4} = \\frac{3h^2}{32} - \\frac{3hy_{NA}}{4} $$\n$$ \\frac{hy_{NA}}{4} + \\frac{3hy_{NA}}{4} = \\frac{3h^2}{32} - \\frac{2h^2}{32} \\implies hy_{NA} = \\frac{h^2}{32} \\implies y_{NA} = \\frac{h}{32} $$\nThe neutral axis shifts upwards, which is expected. Now, we verify that the top fiber at $y=h/2$ has not yielded in compression. The stress at the top fiber is:\n$$ \\sigma(h/2) = -\\frac{\\sigma_{YT}}{h/4 + h/32}(h/2 - h/32) = -\\frac{\\sigma_{YT}}{9h/32}(15h/32) = -\\frac{15}{9}\\sigma_{YT} = -\\frac{5}{3}\\sigma_{YT} $$\nThe magnitude of this stress is $|\\sigma(h/2)| = \\frac{5}{3}\\sigma_{YT} \\approx 1.67\\sigma_{YT}$. Since the compressive yield strength is $\\sigma_{YC} = 2\\sigma_{YT}$, the top fiber remains elastic. Our assumed stress distribution is correct.\n\nThe loading stress distribution $\\sigma(y)$ is:\n$$ \\sigma(y) = \\begin{cases} \\sigma_{YT} & -h/2 \\le y \\le -h/4 \\\\ -\\frac{32\\sigma_{YT}}{9h}(y - \\frac{h}{32}) & -h/4 < y \\le h/2 \\end{cases} $$\n\nNext, we calculate the applied moment $M = -\\int_A y\\sigma(y)dA = -b\\int_{-h/2}^{h/2} y\\sigma(y)dy$.\n$$ M = -b\\left[ \\int_{-h/2}^{-h/4} y\\sigma_{YT} dy + \\int_{-h/4}^{h/2} y\\left(-\\frac{32\\sigma_{YT}}{9h}(y - \\frac{h}{32})\\right) dy \\right] $$\n$$ \\int_{-h/2}^{-h/4} y\\sigma_{YT} dy = \\sigma_{YT}\\left[\\frac{y^2}{2}\\right]_{-h/2}^{-h/4} = \\sigma_{YT}\\left(\\frac{h^2/16}{2} - \\frac{h^2/4}{2}\\right) = -\\frac{3\\sigma_{YT}h^2}{32} $$\n$$ \\int_{-h/4}^{h/2} -y\\frac{32\\sigma_{YT}}{9h}(y - \\frac{h}{32}) dy = -\\frac{32\\sigma_{YT}}{9h} \\int_{-h/4}^{h/2} (y^2 - \\frac{h}{32}y) dy $$\n$$ = -\\frac{32\\sigma_{YT}}{9h} \\left[\\frac{y^3}{3} - \\frac{h}{64}y^2\\right]_{-h/4}^{h/2} = -\\frac{32\\sigma_{YT}}{9h}\\left[ \\left(\\frac{h^3}{24}-\\frac{h^3}{256}\\right) - \\left(-\\frac{h^3}{192}-\\frac{h^3}{1024}\\right) \\right] $$\n$$ = -\\frac{32\\sigma_{YT}}{9h}\\left[ \\frac{29h^3}{768} - (-\\frac{19h^3}{3072}) \\right] = -\\frac{32\\sigma_{YT}}{9h}\\left[ \\frac{116h^3+19h^3}{3072} \\right] = -\\frac{32\\sigma_{YT}}{9h}\\frac{135h^3}{3072} $$\nSimplifying the fraction: $\\frac{32 \\times 135}{9 \\times 3072} = \\frac{2^5 \\times 5 \\times 3^3}{3^2 \\times 3 \\times 2^{10}} = \\frac{5}{2^5} = \\frac{5}{32}$. The integral is $-\\frac{5\\sigma_{YT}h^2}{32}$.\n$$ M = -b\\left[ -\\frac{3\\sigma_{YT}h^2}{32} - \\frac{5\\sigma_{YT}h^2}{32} \\right] = -b\\left[ -\\frac{8\\sigma_{YT}h^2}{32} \\right] = \\frac{b\\sigma_{YT}h^2}{4} $$\n\n**2. Elastic Unloading Stress**\n\nWhen the moment $M$ is removed, the beam responds elastically. This is equivalent to applying an opposing moment $-M$ to the beam. The resulting unloading stress distribution $\\sigma_{unload}(y)$ is linear and given by the standard flexure formula, where a positive moment causes compression at the top ($y>0$) and tension at the bottom ($y<0$). The formula is $\\sigma = -My/I$. The unloading stress is therefore $\\sigma_{unload}(y) = -(-M)y/I = My/I$.\n$$ \\sigma_{unload}(y) = \\frac{My}{I_{xx}} $$\nwhere $I_{xx} = \\frac{bh^3}{12}$ is the second moment of area for the rectangular cross-section.\n$$ \\sigma_{unload}(y) = \\frac{(b\\sigma_{YT}h^2/4)y}{bh^3/12} = \\frac{12b\\sigma_{YT}h^2y}{4bh^3} = \\frac{3\\sigma_{YT}y}{h} $$\nThis unloading stress is compressive (negative) at the bottom ($y<0$) and tensile (positive) at the top ($y>0$), as expected to counteract the loading.\n\n**3. Residual Stress**\n\nThe residual stress $\\sigma_{res}(y)$ is the sum of the loading and unloading stresses: $\\sigma_{res}(y) = \\sigma(y) + \\sigma_{unload}(y)$.\n\nWe analyze the two regions:\na) Former plastic zone: $-h/2 \\le y \\le -h/4$\nIn this region, $\\sigma(y) = \\sigma_{YT}$.\n$$ \\sigma_{res}(y) = \\sigma_{YT} + \\frac{3\\sigma_{YT}y}{h} = \\sigma_{YT}\\left(1 + \\frac{3y}{h}\\right) $$\nTo find where the residual stress is zero, we set $\\sigma_{res}(y)=0$:\n$$ 1 + \\frac{3y}{h} = 0 \\implies y = -\\frac{h}{3} $$\nThis value is in the range $[-0.5h, -0.25h]$, since $-1/3 \\approx -0.333$. So, $y = -h/3$ is one solution.\n\nb) Former elastic zone: $-h/4 < y \\le h/2$\n$\\sigma(y) = -\\frac{32\\sigma_{YT}}{9h}(y - \\frac{h}{32})$.\n$$ \\sigma_{res}(y) = -\\frac{32\\sigma_{YT}}{9h}\\left(y - \\frac{h}{32}\\right) + \\frac{3\\sigma_{YT}y}{h} $$\nDivide by $\\sigma_{YT}$ and set to zero:\n$$ -\\frac{32}{9h}\\left(y - \\frac{h}{32}\\right) + \\frac{3y}{h} = 0 $$\n$$ -\\frac{32y}{9h} + \\frac{32h}{9h \\cdot 32} + \\frac{3y}{h} = 0 $$\n$$ -\\frac{32y}{9h} + \\frac{1}{9} + \\frac{27y}{9h} = 0 $$\n$$ \\frac{1}{9} - \\frac{5y}{9h} = 0 \\implies 1 = \\frac{5y}{h} \\implies y = \\frac{h}{5} $$\nThis value is in the range $(-0.25h, 0.5h]$, since $1/5 = 0.2$. So $y=h/5$ is another solution.\n\n**4. Final Answer**\n\nWe have found two locations where the residual stress is zero: $y_1 = -h/3$ and $y_2 = h/5$.\nThe problem asks for the location closest to the bottom surface of the beam, which is at $y=-h/2$.\nThe distance of $y_1$ from the bottom is $|y_1 - (-h/2)| = |-h/3 + h/2| = |h/6| = h/6$.\nThe distance of $y_2$ from the bottom is $|y_2 - (-h/2)| = |h/5 + h/2| = |7h/10| = 7h/10$.\nSince $h/6 < 7h/10$, the point closest to the bottom surface is $y_1 = -h/3$.", "answer": "$$\\boxed{-\\frac{h}{3}}$$", "id": "2215767"}, {"introduction": "While analytical solutions are powerful for basic shapes, modern engineering relies on numerical approaches to handle complex geometries and material behaviors. This capstone practice [@problem_id:2908874] challenges you to implement a numerical \"fiber model,\" a cornerstone of modern structural analysis software, to compute the moment-curvature relationship for any given cross-section. By benchmarking your code against an analytical solution and applying it to a more complex shape, you will bridge the gap between fundamental theory and advanced computational practice.", "problem": "Consider small-strain, rate-independent, isothermal bending of a prismatic beam made of an isotropic, homogeneous material with an elastic-perfectly-plastic uniaxial constitutive law. Adopt the classical Euler–Bernoulli kinematics (plane sections remain plane and normal to the neutral axis) and pure bending with zero resultant axial force. Let the curvature about the strong axis be denoted by $\\kappa$ (in $\\mathrm{m}^{-1}$). For a cross-section $\\mathcal{A}$ described in the $xy$-plane (with $y$ measured along the thickness), the longitudinal strain field is $\\varepsilon(y)=\\varepsilon_{0}+\\kappa\\,(y-y_{\\mathrm{ref}})$, where $\\varepsilon_{0}$ is an unknown uniform axial strain chosen to enforce zero axial force, and $y_{\\mathrm{ref}}$ is a fixed reference ordinate. The uniaxial stress is given by the elastic-perfectly-plastic law $\\sigma(\\varepsilon)=\\mathrm{clip}\\big(E\\,\\varepsilon,-\\sigma_{y},\\sigma_{y}\\big)$, where $E$ is Young’s modulus and $\\sigma_{y}$ is the yield stress in both tension and compression. The internal bending moment about the neutral axis is \n$$\nM(\\kappa)=\\int_{\\mathcal{A}} \\sigma\\big(\\varepsilon(y)\\big)\\,(y-y_{\\mathrm{ref}})\\,\\mathrm{d}A.\n$$\nYou must implement a fiber discretization scheme that approximates the integral by horizontal fibers. For a given polygonal cross-section, discretize the section into $N_{y}$ horizontal fibers at ordinates $y_{i}$ with widths $w_{i}$ and uniform fiber thickness $\\Delta y$, so that $\\Delta A_{i}=w_{i}\\,\\Delta y$, and approximate\n$$\nN(\\varepsilon_{0};\\kappa)=\\sum_{i=1}^{N_{y}} \\sigma\\big(\\varepsilon_{0}+\\kappa\\,(y_{i}-y_{\\mathrm{ref}})\\big)\\,\\Delta A_{i},\\qquad \nM(\\kappa)\\approx \\sum_{i=1}^{N_{y}} \\sigma\\big(\\varepsilon_{0}^{\\star}+\\kappa\\,(y_{i}-y_{\\mathrm{ref}})\\big)\\,(y_{i}-y_{\\mathrm{ref}})\\,\\Delta A_{i},\n$$\nwhere $\\varepsilon_{0}^{\\star}$ is the unique root of $N(\\varepsilon_{0};\\kappa)=0$. Solve for $\\varepsilon_{0}^{\\star}$ by a robust one-dimensional root-finding method.\n\nFor a rectangular cross-section of width $b$ and height $h$, there exists a closed-form analytical expression for $M(\\kappa)$ under the same assumptions, derived from first principles (force equilibrium, compatibility, and the elastic-perfectly-plastic law) by considering the elastic core and fully yielded outer zones. Use that analytical solution to benchmark your numerical fiber integration.\n\nYour program must:\n- Implement the fiber discretization for an arbitrary simple polygonal cross-section by horizontal scanline slicing to obtain $\\{(y_{i},w_{i})\\}$.\n- Enforce zero axial force by solving $N(\\varepsilon_{0};\\kappa)=0$ for each test case.\n- Compute $M(\\kappa)$ numerically for each test case.\n- For the rectangle, independently compute the analytical $M(\\kappa)$ and report relative errors of the numerical method versus the analytical result.\n- For a non-rectangular polygon, compute the plastic section modulus $Z_{p}=\\int_{\\mathcal{A}} |y-y_{c}|\\,\\mathrm{d}A$ numerically by fibers (with $y_{c}$ the centroid ordinate of $\\mathcal{A}$) and verify the large-curvature limit by reporting the deviation of $M(\\kappa)$ from $\\sigma_{y}\\,Z_{p}$ at high curvature.\n\nUse the following parameters (all in the International System of Units):\n- Material: $E=210\\times 10^{9}\\,\\mathrm{Pa}$, $\\sigma_{y}=250\\times 10^{6}\\,\\mathrm{Pa}$.\n- Rectangle: width $b=0.1\\,\\mathrm{m}$, height $h=0.2\\,\\mathrm{m}$, with $y$ measured from the bottom edge ($y=0$) to the top edge ($y=h$). Use $y_{\\mathrm{ref}}=y_{c}$, the centroid ordinate.\n- Define the rectangular yield curvature $\\kappa_{y}=\\dfrac{\\sigma_{y}}{E\\,c}$ with $c=h/2$.\n- Non-rectangular polygon (isosceles trapezoid, symmetric in $x$): vertices ordered counterclockwise as $(-0.03,0)$, $(0.03,0)$, $(0.09,0.2)$, $(-0.09,0.2)$ (in $\\mathrm{m}$). Use $y_{\\mathrm{ref}}=y_{c}$, the centroid ordinate of the polygon.\n\nTest suite (use the same $E$ and $\\sigma_{y}$ in all cases, and an appropriate sufficiently fine $N_{y}$ to ensure convergence of the fiber method):\n- Case $\\mathbf{1}$ (rectangle, elastic): $\\kappa=0.1\\,\\kappa_{y}$. Output the relative error $\\big|M_{\\mathrm{num}}-M_{\\mathrm{ana}}\\big|/M_{\\mathrm{ana}}$ as a dimensionless floating-point number.\n- Case $\\mathbf{2}$ (rectangle, onset of yielding): $\\kappa=1.0\\,\\kappa_{y}$. Output the relative error as above.\n- Case $\\mathbf{3}$ (rectangle, partially plastic): $\\kappa=5.0\\,\\kappa_{y}$. Output the relative error as above.\n- Case $\\mathbf{4}$ (rectangle, near fully plastic): $\\kappa=200.0\\,\\kappa_{y}$. Output the relative error as above.\n- Case $\\mathbf{5}$ (trapezoid, axial equilibrium check): $\\kappa=50.0\\,\\kappa_{y}$. Output the dimensionless ratio $\\big|N(\\varepsilon_{0}^{\\star};\\kappa)\\big|/(\\sigma_{y}\\,A)$, where $A$ is the polygonal area, as a floating-point number.\n- Case $\\mathbf{6}$ (trapezoid, large-curvature plastic limit): $\\kappa=200.0\\,\\kappa_{y}$. Output $\\left| \\dfrac{M_{\\mathrm{num}}}{\\sigma_{y}\\,Z_{p}} - 1 \\right|$ as a floating-point number.\n\nAngle units are not applicable. All intermediate calculations are to be performed consistently in $\\mathrm{SI}$ units. The outputs in the test suite are dimensionless, so no unit annotation is required in the output.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[r1,r2,r3,r4,r5,r6]\"). Each entry must correspond, in order, to Cases $\\mathbf{1}$ through $\\mathbf{6}$ and be printed as a standard decimal representation.", "solution": "We start from the following foundational principles and definitions: (i) Euler–Bernoulli kinematics for pure bending, stating that plane sections remain plane and the longitudinal strain varies linearly with the transverse coordinate, $\\varepsilon(y)=\\varepsilon_{0}+\\kappa\\,(y-y_{\\mathrm{ref}})$; (ii) the elastic-perfectly-plastic uniaxial constitutive law $\\sigma(\\varepsilon)=\\mathrm{clip}(E\\,\\varepsilon,-\\sigma_{y},\\sigma_{y})$; (iii) static equilibrium requiring zero axial force for pure bending, $N(\\varepsilon_{0};\\kappa)=\\int_{\\mathcal{A}}\\sigma\\big(\\varepsilon(y)\\big)\\,\\mathrm{d}A=0$; and (iv) the moment resultant about $y_{\\mathrm{ref}}$, $M(\\kappa)=\\int_{\\mathcal{A}}\\sigma\\big(\\varepsilon(y)\\big)\\,(y-y_{\\mathrm{ref}})\\,\\mathrm{d}A$.\n\nAlgorithmic design for fiber discretization:\n1. Geometry discretization by horizontal fibers. Let the polygonal cross-section be represented by ordered vertices. For a chosen number of slices $N_{y}$, define uniformly spaced scanlines at ordinates $y_{i}$ between $y_{\\min}$ and $y_{\\max}$ with spacing $\\Delta y=(y_{\\max}-y_{\\min})/N_{y}$. For each $y_{i}$, intersect the scanline with the polygon edges using a standard parity rule: for each non-horizontal edge crossing $y_{i}$, compute the intersection abscissa $x$ and collect all such $x$. Sorting them in ascending order, the union of interior segments is obtained by pairing consecutive abscissae $(x_{2k},x_{2k+1})$. The fiber width is $w_{i}=\\sum_{k}(x_{2k+1}-x_{2k})$, and the fiber area is $\\Delta A_{i}=w_{i}\\,\\Delta y$. The fiber centroid ordinate is taken as the scanline ordinate $y_{i}$ (midpoint convention).\n2. Reference axis and centroid. Compute the discretized centroid ordinate $y_{c}=\\left(\\sum_{i} y_{i}\\,\\Delta A_{i}\\right)\\big/\\left(\\sum_{i}\\Delta A_{i}\\right)$ and use $y_{\\mathrm{ref}}=y_{c}$ so that the bending moment is about the centroidal axis.\n3. Enforcing zero axial force. Define the axial force functional\n$$\nN(\\varepsilon_{0};\\kappa)=\\sum_{i=1}^{N_{y}} \\sigma\\!\\left(\\varepsilon_{0}+\\kappa\\,(y_{i}-y_{c})\\right)\\,\\Delta A_{i},\\quad \n\\sigma(\\cdot)=\\max\\!\\left(-\\sigma_{y},\\min\\!\\left(\\sigma_{y},E\\,(\\cdot)\\right)\\right).\n$$\nBecause $\\sigma(\\cdot)$ is a monotonically nondecreasing function of its argument, $N(\\varepsilon_{0};\\kappa)$ is a continuous, strictly increasing function of $\\varepsilon_{0}$, guaranteeing a unique root. Use a robust bisection method: bracket $\\varepsilon_{0}$ by choosing sufficiently negative and positive bounds (for example, $\\varepsilon_{0}^{-}=-\\alpha-\\kappa\\,Y$ and $\\varepsilon_{0}^{+}=+\\alpha+\\kappa\\,Y$ with $Y=\\max_{i}|y_{i}-y_{c}|$ and $\\alpha>0$ scaled to exceed the elastic limit, e.g., $\\alpha=2\\,\\sigma_{y}/E$), expand the bracket if needed, and bisect to a tight tolerance until $|N|$ is negligible.\n4. Moment evaluation. With the root $\\varepsilon_{0}^{\\star}$, compute\n$$\nM_{\\mathrm{num}}(\\kappa)=\\sum_{i=1}^{N_{y}} \\sigma\\!\\left(\\varepsilon_{0}^{\\star}+\\kappa\\,(y_{i}-y_{c})\\right)\\,(y_{i}-y_{c})\\,\\Delta A_{i}.\n$$\n5. Analytical solution for a rectangle. Consider a rectangle of width $b$ (in the $x$ direction) and height $h$ (in the $y$ direction), with centroidal axis at $y_{c}=h/2$. Under curvature $\\kappa$ and zero axial force, symmetry implies a stress field that is odd in $(y-y_{c})$. Let $c=h/2$ and the yield curvature be $\\kappa_{y}=\\sigma_{y}/(E\\,c)$. If $|\\kappa|\\le \\kappa_{y}$, the section is fully elastic and the moment is\n$$\nM_{\\mathrm{ana}}(\\kappa)=E\\,I\\,\\kappa,\\qquad I=\\frac{b\\,h^{3}}{12}.\n$$\nIf $|\\kappa|>\\kappa_{y}$, an elastic core of half-thickness $e=\\sigma_{y}/(E\\,|\\kappa|)$ remains around $y_{c}$ while the outer layers are fully yielded. Taking the positive $\\kappa$ case without loss of generality, the stress is $\\sigma=E\\,\\kappa\\,(y-y_{c})$ for $|y-y_{c}|\\le e$ and $\\sigma=\\mathrm{sign}(y-y_{c})\\,\\sigma_{y}$ for $e<|y-y_{c}|\\le c$, yielding\n$$\nM_{\\mathrm{ana}}(\\kappa)=2\\,b\\left[\\int_{0}^{e} E\\,\\kappa\\,y^{2}\\,\\mathrm{d}y+\\int_{e}^{c} \\sigma_{y}\\,y\\,\\mathrm{d}y\\right]\n=2\\,b\\left(\\frac{E\\,\\kappa\\,e^{3}}{3}+\\frac{\\sigma_{y}}{2}\\left(c^{2}-e^{2}\\right)\\right),\n$$\nwith $e=\\sigma_{y}/(E\\,\\kappa)$ and $c=h/2$. This expression reduces continuously to $E\\,I\\,\\kappa$ at $\\kappa=\\kappa_{y}$ and approaches the fully plastic moment $M_{p}=\\sigma_{y}\\,Z_{p}$ as $\\kappa\\to\\infty$, where the plastic section modulus for a rectangle is $Z_{p}=b\\,h^{2}/4$.\n6. Plastic section modulus by fibers. For a general section, approximate\n$$\nZ_{p}\\approx \\sum_{i=1}^{N_{y}} |y_{i}-y_{c}|\\,\\Delta A_{i},\n$$\nso that the fully plastic limit is $M\\approx \\sigma_{y}\\,Z_{p}$ for sufficiently large $|\\kappa|$.\n\nNumerical and physical consistency:\n- The bisection root-finding for $\\varepsilon_{0}$ ensures exact axial equilibrium in floating-point up to the prescribed tolerance, making $N(\\varepsilon_{0}^{\\star};\\kappa)$ negligibly small relative to $\\sigma_{y}\\,A$.\n- The scanline fiber discretization converges as $N_{y}\\to\\infty$. A sufficiently large $N_{y}$ is chosen to make discretization errors small relative to the analytical benchmarks.\n- For the rectangle, the numerical $M_{\\mathrm{num}}(\\kappa)$ converges to the analytical $M_{\\mathrm{ana}}(\\kappa)$ uniformly over elastic and plastic regimes, with maximal deviations occurring near the elastic–plastic transition due to piecewise affine stress saturation; refining $N_{y}$ reduces these deviations.\n- For the trapezoid, the large-curvature ratio $M_{\\mathrm{num}}/(\\sigma_{y}\\,Z_{p})$ approaches $1$ as expected from the definition of the plastic section modulus.\n\nThe program implements:\n- A polygon scanline slicer to obtain fiber widths $w_{i}$.\n- A discretized centroid computation $y_{c}$ from fibers.\n- A robust bisection method for $\\varepsilon_{0}$ enforcing $N=0$.\n- Numerical evaluation of $M(\\kappa)$ and $Z_{p}$.\n- The analytical rectangle formula from the derived expressions above.\n- The test suite specified, with outputs:\n  1. Rectangle, $\\kappa=0.1\\,\\kappa_{y}$: report $\\big|M_{\\mathrm{num}}-M_{\\mathrm{ana}}\\big|/M_{\\mathrm{ana}}$.\n  2. Rectangle, $\\kappa=1.0\\,\\kappa_{y}$: same relative error.\n  3. Rectangle, $\\kappa=5.0\\,\\kappa_{y}$: same relative error.\n  4. Rectangle, $\\kappa=200.0\\,\\kappa_{y}$: same relative error.\n  5. Trapezoid, $\\kappa=50.0\\,\\kappa_{y}$: report $\\big|N(\\varepsilon_{0}^{\\star};\\kappa)\\big|/(\\sigma_{y}\\,A)$.\n  6. Trapezoid, $\\kappa=200.0\\,\\kappa_{y}$: report $\\left| \\dfrac{M_{\\mathrm{num}}}{\\sigma_{y}\\,Z_{p}} - 1 \\right|$.\n\nAll outputs are dimensionless floating-point numbers printed in a single list as instructed.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef polygon_area_centroid(vertices):\n    \"\"\"\n    Compute polygon area and centroid (x_c, y_c) using the shoelace formula.\n    vertices: array-like of shape (n, 2), ordered counterclockwise, non-self-intersecting.\n    Returns: area (positive), x_c, y_c\n    \"\"\"\n    verts = np.asarray(vertices, dtype=float)\n    x = verts[:, 0]\n    y = verts[:, 1]\n    # Close the polygon\n    x_shift = np.roll(x, -1)\n    y_shift = np.roll(y, -1)\n    cross = x * y_shift - x_shift * y\n    area = 0.5 * np.sum(cross)\n    if area == 0.0:\n        return 0.0, np.nan, np.nan\n    cx = (1.0 / (6.0 * area)) * np.sum((x + x_shift) * cross)\n    cy = (1.0 / (6.0 * area)) * np.sum((y + y_shift) * cross)\n    return abs(area), cx, cy\n\ndef scanline_fibers(vertices, Ny):\n    \"\"\"\n    Discretize a simple polygon by horizontal scanlines into Ny fibers.\n    Returns:\n      y_centers: (Ny,) array of y ordinates (midpoints of slices)\n      widths: (Ny,) array of total width inside polygon at each y\n      dy: scalar fiber thickness\n    \"\"\"\n    verts = np.asarray(vertices, dtype=float)\n    # Bounding box in y\n    y_min = np.min(verts[:, 1])\n    y_max = np.max(verts[:, 1])\n    # Avoid degenerate dy\n    Ny = int(Ny)\n    if Ny < 1:\n        raise ValueError(\"Ny must be >= 1\")\n    dy = (y_max - y_min) / Ny\n    # Place y-centers at midpoints of each slice\n    y_centers = y_min + (np.arange(Ny) + 0.5) * dy\n\n    # Precompute edges\n    n = len(verts)\n    x1 = verts[:, 0]\n    y1 = verts[:, 1]\n    x2 = np.roll(x1, -1)\n    y2 = np.roll(y1, -1)\n\n    widths = np.zeros_like(y_centers)\n    # For each scanline, compute intersections\n    for i, y in enumerate(y_centers):\n        xs = []\n        for j in range(n):\n            yj1 = y1[j]\n            yj2 = y2[j]\n            xj1 = x1[j]\n            xj2 = x2[j]\n            # Skip horizontal edges to avoid double counting\n            if yj1 == yj2:\n                continue\n            # Check if scanline intersects edge with standard rule:\n            # Include lower endpoint, exclude upper to avoid double counting at vertices\n            ymin = min(yj1, yj2)\n            ymax = max(yj1, yj2)\n            if (y >= ymin) and (y < ymax):\n                # Linear interpolation for intersection x\n                t = (y - yj1) / (yj2 - yj1)\n                x_int = xj1 + t * (xj2 - xj1)\n                xs.append(x_int)\n        if len(xs) == 0:\n            widths[i] = 0.0\n        else:\n            xs.sort()\n            # Pair up consecutive intersections\n            total_width = 0.0\n            for k in range(0, len(xs) - 1, 2):\n                total_width += xs[k + 1] - xs[k]\n            widths[i] = total_width\n    return y_centers, widths, dy\n\ndef fibers_from_polygon(vertices, Ny):\n    \"\"\"\n    Build fiber discretization arrays from polygon.\n    Returns:\n      y: (m,) array of y positions\n      dA: (m,) array of fiber areas\n      y_centroid: scalar centroid ordinate computed from fibers\n      area: total area from fibers\n    \"\"\"\n    y, widths, dy = scanline_fibers(vertices, Ny)\n    dA = widths * dy\n    area = dA.sum()\n    if area <= 0.0:\n        return y, dA, np.nan, 0.0\n    y_centroid = (y * dA).sum() / area\n    return y, dA, y_centroid, area\n\ndef elastoplastic_stress(E, sigy, strain):\n    \"\"\"\n    Elastic-perfectly-plastic stress.\n    \"\"\"\n    sig = E * strain\n    sig = np.clip(sig, -sigy, sigy)\n    return sig\n\ndef solve_epsilon0_for_N_zero(E, sigy, kappa, y, dA, y_ref, tol=1e-14, max_iter=200):\n    \"\"\"\n    Solve for epsilon0 such that sum sigma(epsilon0 + kappa*(y - y_ref)) * dA = 0.\n    Use bisection with automatic bracketing.\n    \"\"\"\n    y_diff = y - y_ref\n    Y = np.max(np.abs(y_diff)) if y.size > 0 else 0.0\n    # Initial bracket based on saturating beyond yield plus kappa*Y\n    alpha = 2.0 * sigy / E if E > 0 else 1.0\n    lo = -alpha - abs(kappa) * (Y + 1.0)\n    hi = alpha + abs(kappa) * (Y + 1.0)\n\n    def N_of_eps0(eps0):\n        strain = eps0 + kappa * y_diff\n        sig = elastoplastic_stress(E, sigy, strain)\n        return float(np.dot(sig, dA))\n\n    f_lo = N_of_eps0(lo)\n    f_hi = N_of_eps0(hi)\n    # Expand bracket if no sign change\n    expand = 0\n    while f_lo * f_hi > 0 and expand < 50:\n        lo -= alpha + abs(kappa) * (Y + 1.0) * (2 ** (expand + 1))\n        hi += alpha + abs(kappa) * (Y + 1.0) * (2 ** (expand + 1))\n        f_lo = N_of_eps0(lo)\n        f_hi = N_of_eps0(hi)\n        expand += 1\n    # If still no sign change (degenerate cross-section), return zero\n    if f_lo == 0.0:\n        return lo\n    if f_hi == 0.0:\n        return hi\n    if f_lo * f_hi > 0:\n        # Fallback: return mid (should not happen for valid sections)\n        return 0.0\n    # Bisection\n    for _ in range(max_iter):\n        mid = 0.5 * (lo + hi)\n        f_mid = N_of_eps0(mid)\n        if abs(f_mid) <= tol:\n            return mid\n        if f_lo * f_mid < 0.0:\n            hi = mid\n            f_hi = f_mid\n        else:\n            lo = mid\n            f_lo = f_mid\n        if abs(hi - lo) <= max(1e-16, 0.5 * tol * (abs(lo) + abs(hi) + 1.0)):\n            return 0.5 * (lo + hi)\n    return 0.5 * (lo + hi)\n\ndef numerical_M_of_kappa(vertices, E, sigy, kappa, Ny):\n    \"\"\"\n    Compute numerical bending moment M for a polygon at curvature kappa via fiber method.\n    Returns:\n      M_num: numerical moment about centroidal axis\n      N_res: residual axial force (should be ~ 0)\n      A: area\n      y_c: centroid ordinate\n      y: fiber y positions\n      dA: fiber areas\n    \"\"\"\n    y, dA, y_c, A = fibers_from_polygon(vertices, Ny)\n    if A <= 0.0 or not np.isfinite(y_c):\n        return 0.0, 0.0, 0.0, np.nan, y, dA\n    eps0 = solve_epsilon0_for_N_zero(E, sigy, kappa, y, dA, y_c)\n    strain = eps0 + kappa * (y - y_c)\n    sig = elastoplastic_stress(E, sigy, strain)\n    N_res = float(np.dot(sig, dA))\n    M_num = float(np.dot(sig * (y - y_c), dA))\n    return M_num, N_res, A, y_c, y, dA\n\ndef analytic_M_rect(b, h, E, sigy, kappa):\n    \"\"\"\n    Analytical M(kappa) for a rectangular cross-section under elastic-perfectly-plastic law.\n    \"\"\"\n    c = 0.5 * h\n    I = b * h**3 / 12.0\n    ky = sigy / (E * c) if E > 0 and c > 0 else np.inf\n    kappa_abs = abs(kappa)\n    if kappa_abs <= ky:\n        M = E * I * kappa\n        return M\n    # Partially plastic or near fully plastic\n    e = sigy / (E * kappa_abs)\n    # Ensure e does not exceed c due to floating error\n    e = min(e, c)\n    term1 = 2.0 * b * (E * kappa_abs * e**3 / 3.0)\n    term2 = 2.0 * b * (sigy * (c**2 - e**2) / 2.0)\n    M_abs = term1 + term2\n    # Sign follow kappa\n    return np.sign(kappa) * M_abs\n\ndef rectangle_vertices(b, h, y0=0.0, x0=0.0):\n    \"\"\"\n    Build rectangle polygon with bottom at y0 and top at y0+h, centered at x0, width b.\n    Returns CCW vertices.\n    \"\"\"\n    half_b = 0.5 * b\n    return np.array([\n        [x0 - half_b, y0],\n        [x0 + half_b, y0],\n        [x0 + half_b, y0 + h],\n        [x0 - half_b, y0 + h]\n    ], dtype=float)\n\ndef compute_Zp_from_fibers(y, dA, y_c):\n    \"\"\"\n    Compute plastic section modulus Zp = integral |y - y_c| dA using fibers.\n    \"\"\"\n    return float(np.dot(np.abs(y - y_c), dA))\n\ndef solve():\n    # Material properties\n    E = 210.0e9  # Pa\n    sigy = 250.0e6  # Pa\n\n    # Rectangle parameters\n    b = 0.1   # m\n    h = 0.2   # m\n    rect_poly = rectangle_vertices(b, h, y0=0.0, x0=0.0)\n\n    # Yield curvature for the rectangle\n    c = 0.5 * h\n    ky = sigy / (E * c)\n\n    # Trapezoid polygon (isosceles), vertices CCW\n    trapezoid = np.array([\n        [-0.03, 0.0],\n        [ 0.03, 0.0],\n        [ 0.09, 0.2],\n        [-0.09, 0.2]\n    ], dtype=float)\n\n    # Discretization resolution\n    Ny_rect = 8000  # high resolution for rectangle\n    Ny_trap = 8000  # high resolution for trapezoid\n\n    # Test suite curvatures\n    kappas_rect = [0.1 * ky, 1.0 * ky, 5.0 * ky, 200.0 * ky]\n    kappas_trap = [50.0 * ky, 200.0 * ky]\n\n    results = []\n\n    # Rectangle cases: relative errors\n    for kappa in kappas_rect:\n        M_num, N_res, A_rect_num, yc_rect, y_rect, dA_rect = numerical_M_of_kappa(rect_poly, E, sigy, kappa, Ny_rect)\n        M_ana = analytic_M_rect(b, h, E, sigy, kappa)\n        # Avoid division by zero (kappa=0 not used in suite)\n        rel_err = abs(M_num - M_ana) / (abs(M_ana) if abs(M_ana) > 0 else 1.0)\n        results.append(rel_err)\n\n    # Trapezoid axial equilibrium check\n    kappa_trap_1 = kappas_trap[0]\n    M_num_tr1, N_res_tr1, A_trap1, yc_trap1, y_trap1, dA_trap1 = numerical_M_of_kappa(trapezoid, E, sigy, kappa_trap_1, Ny_trap)\n    axial_ratio = abs(N_res_tr1) / (sigy * A_trap1 if A_trap1 > 0 else 1.0)\n    results.append(axial_ratio)\n\n    # Trapezoid plastic limit check\n    kappa_trap_2 = kappas_trap[1]\n    M_num_tr2, N_res_tr2, A_trap2, yc_trap2, y_trap2, dA_trap2 = numerical_M_of_kappa(trapezoid, E, sigy, kappa_trap_2, Ny_trap)\n    Zp_trap = compute_Zp_from_fibers(y_trap2, dA_trap2, yc_trap2)\n    ratio_err = abs(M_num_tr2 / (sigy * Zp_trap) - 1.0) if Zp_trap > 0 else 0.0\n    results.append(ratio_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\n# Ensure deterministic run\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2908874"}]}