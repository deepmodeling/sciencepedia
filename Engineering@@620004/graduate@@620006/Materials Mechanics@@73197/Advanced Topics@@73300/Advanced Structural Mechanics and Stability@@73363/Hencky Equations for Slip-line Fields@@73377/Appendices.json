{"hands_on_practices": [{"introduction": "The Hencky equations form the bedrock of slip-line field theory, providing a direct link between the mean stress $p$ and the orientation $\\theta$ of the slip-lines. This exercise allows you to apply one of these fundamental relationships in a direct and tangible way. By calculating the change in mean stress across a centered fan region, you will practice using the characteristic relation that governs stress evolution along an $\\alpha$-slip-line, a foundational skill for analyzing more complex plasticity problems. [@problem_id:2685849]", "problem": "A rigid, perfectly plastic metal in plane strain obeys the von Mises yield condition. In slip-line field theory, define the mean stress as $p = (\\sigma_{1} + \\sigma_{2})/2$, where $\\sigma_{1}$ and $\\sigma_{2}$ are the in-plane principal stresses, and let $k$ denote the constant shear yield stress (so that under pure shear at yielding, the shear stress equals $k$). Consider a centered slip-line fan composed of $\\alpha$-family slip lines radiating from a point $O$. Two straight boundaries bound the fan, labeled boundary $\\mathcal{A}$ and boundary $\\mathcal{B}$, and an $\\alpha$-slip line connects $\\mathcal{A}$ to $\\mathcal{B}$ through the fan. The local slip-line angle $\\theta$ (measured from the $x$-axis to the $\\alpha$-family direction) on boundary $\\mathcal{A}$ is $\\theta_{1} = 15^\\circ$, and on boundary $\\mathcal{B}$ is $\\theta_{2} = 65^\\circ$. The mean stress on boundary $\\mathcal{A}$ is $p_{1} = 210\\,\\mathrm{MPa}$. The material parameter is $k = 95\\,\\mathrm{MPa}$.\n\nStarting from the fundamental equilibrium equations in the plane, the definition of $p$ and $\\theta$, and the rigid, perfectly plastic von Mises response with $k$ constant, use the Hencky characteristic relations to determine the mean stress on boundary $\\mathcal{B}$ along the connecting $\\alpha$-slip line. All angles in the given data are in degrees; ensure that any calculus with $\\theta$ treats it in radians. Express the final mean stress $p_{2}$ in $\\mathrm{MPa}$ and round your answer to four significant figures.", "solution": "The problem requires the determination of the mean stress on boundary $\\mathcal{B}$ of a centered slip-line fan, given the state on boundary $\\mathcal{A}$ and the geometry of the fan. The material is rigid, perfectly plastic, in a state of plane strain, and obeys the von Mises yield condition. The solution proceeds by applying the Hencky characteristic relations, which are fundamental to slip-line field theory.\n\nFirst, we establish the theoretical framework. For a rigid, perfectly plastic material satisfying the von Mises yield criterion under plane strain conditions, the state of stress at any point undergoing plastic deformation can be specified by two quantities: the mean stress, $p$, and the orientation of the slip lines. The problem defines the mean stress as $p = \\frac{\\sigma_{1} + \\sigma_{2}}{2}$, where $\\sigma_{1}$ and $\\sigma_{2}$ are the in-plane principal stresses. The yield criterion in plane strain can be expressed in terms of the constant shear yield stress, $k$, as $\\frac{|\\sigma_{1} - \\sigma_{2}|}{2} = k$. The principal stresses can therefore be expressed in terms of $p$ and $k$ as $\\sigma_{1} = p+k$ and $\\sigma_{2} = p-k$, assuming a convention where $\\sigma_{1} > \\sigma_{2}$.\n\nThe governing equations of equilibrium, when combined with the yield criterion and expressed in terms of $p$ and the slip-line angle $\\theta$, form a system of hyperbolic partial differential equations. The characteristics of this system are the slip lines themselves, denoted as $\\alpha$-lines and $\\beta$-lines. Along these characteristic lines, specific relationships, known as the Hencky relations, must hold. These are:\nAlong an $\\alpha$-slip line:\n$$ p - 2k\\theta = \\text{constant} $$\nAlong a $\\beta$-slip line:\n$$ p + 2k\\theta = \\text{constant} $$\nIn these relations, the angle $\\theta$, which denotes the orientation of the $\\alpha$-slip line with respect to a fixed reference axis (e.g., the $x$-axis), must be measured in radians.\n\nThe problem states that a single $\\alpha$-family slip line connects a point on boundary $\\mathcal{A}$ to a point on boundary $\\mathcal{B}$. Let us denote the point on boundary $\\mathcal{A}$ as point $1$ and the point on boundary $\\mathcal{B}$ as point $2$. We are given the following information:\nAt point $1$: mean stress $p_{1} = 210\\,\\mathrm{MPa}$ and slip-line angle $\\theta_{1} = 15^\\circ$.\nAt point $2$: the slip-line angle is $\\theta_{2} = 65^\\circ$, and we need to find the mean stress $p_{2}$.\nThe material parameter is given as the shear yield stress $k = 95\\,\\mathrm{MPa}$.\n\nSince both points lie on the same $\\alpha$-slip line, the Hencky relation $p - 2k\\theta = \\text{constant}$ must be satisfied for both points. Therefore, we can write:\n$$ p_{1} - 2k\\theta_{1} = p_{2} - 2k\\theta_{2} $$\nOur objective is to determine $p_{2}$. Rearranging the equation to solve for $p_{2}$ gives:\n$$ p_{2} = p_{1} + 2k\\theta_{2} - 2k\\theta_{1} $$\n$$ p_{2} = p_{1} + 2k(\\theta_{2} - \\theta_{1}) $$\n\nBefore substituting the numerical values, we must convert the angles from degrees to radians, as required for the Hencky relations.\nThe change in angle is $\\Delta\\theta = \\theta_{2} - \\theta_{1}$.\n$$ \\Delta\\theta = 65^\\circ - 15^\\circ = 50^\\circ $$\nTo convert this to radians, we use the conversion factor $\\pi\\,\\mathrm{radians} = 180^\\circ$:\n$$ \\Delta\\theta_{\\text{rad}} = 50^\\circ \\times \\frac{\\pi}{180^\\circ} = \\frac{5\\pi}{18}\\,\\mathrm{radians} $$\n\nNow, we substitute the given values for $p_{1}$, $k$, and the angular difference $\\Delta\\theta$ into the equation for $p_{2}$:\n$$ p_{2} = 210\\,\\mathrm{MPa} + 2 \\times (95\\,\\mathrm{MPa}) \\times \\left(\\frac{5\\pi}{18}\\right) $$\n$$ p_{2} = 210 + 190 \\times \\left(\\frac{5\\pi}{18}\\right) $$\n$$ p_{2} = 210 + \\frac{950\\pi}{18} $$\nSimplifying the fraction gives:\n$$ p_{2} = 210 + \\frac{475\\pi}{9} $$\n\nTo obtain the final numerical answer, we compute the value of this expression and round it to four significant figures as requested.\n$$ p_{2} \\approx 210 + \\frac{475 \\times 3.14159265}{9} $$\n$$ p_{2} \\approx 210 + 165.806278... $$\n$$ p_{2} \\approx 375.806278... \\,\\mathrm{MPa} $$\nRounding to four significant figures, we get:\n$$ p_{2} = 375.8\\,\\mathrm{MPa} $$\nThis value represents the mean stress on boundary $\\mathcal{B}$ along the specified $\\alpha$-slip line.", "answer": "$$\n\\boxed{375.8}\n$$", "id": "2685849"}, {"introduction": "While different yield criteria like Tresca and von Mises are often calibrated to the same uniaxial tensile strength $\\sigma_{y}$, their predictions for material behavior under multi-axial stress can differ significantly. This exercise guides you through a powerful thought experiment that explores the practical consequences of this divergence for the classic Prandtl compression problem. Using a non-dimensional argument, you will deduce the ratio of predicted forming pressures without solving the full field, gaining valuable insight into how the choice of constitutive model impacts engineering load calculations. [@problem_id:2685824]", "problem": "Consider the classical Prandtl plane-strain compression of a very long, perfectly plastic, incompressible strip of height $H$ between two rigid, perfectly rough platens. The strip is homogeneous and isotropic, with associated flow, and has the same uniaxial tensile yield stress $\\sigma_{y}$ under both the Tresca and the von Mises (J$_{2}$) yield assumptions. Let $\\bar{p}$ denote the average compressive pressure transmitted to a platen (equivalently, the total load per unit out-of-plane thickness divided by the platen contact length). \n\nUsing slip-line field theory for two-dimensional rigid-perfectly-plastic flow:\n- Start from the two-dimensional equilibrium equations, plastic incompressibility, and the respective yield conditions (Tresca or von Mises), and formulate the characteristic (slip-line) equations in terms of the mean compressive stress $p$ and the slip-line angle $\\varphi$.\n- By a non-dimensionalization argument, establish whether the field solution for the normalized pressure $p/(2k)$, where $k$ is the shear yield stress in simple shear for the chosen yield criterion, depends on the magnitude of $k$.\n- Carefully explain how the mapping from uniaxial yield stress $\\sigma_{y}$ to the shear yield stress $k$ differs between the Tresca and the von Mises assumptions.\n\nThen, without invoking any problem-specific numerical constant from a pre-tabulated slip-line solution, deduce the exact ratio of the average platen pressures,\n$$\n\\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}},\n$$\nfor the same $\\sigma_{y}$, and briefly discuss the physical origin of any discrepancy between the two predictions. Express your final answer as a single exact number (no units). No rounding is required.", "solution": "The solution requires a sequential deduction based on the fundamental principles of slip-line field theory.\n\nFirst, we formulate the characteristic equations. In a rigid-perfectly-plastic material at yield under plane strain conditions, the state of stress is described by the mean compressive stress, $p = -\\frac{1}{2}(\\sigma_{xx} + \\sigma_{yy})$, and the constant shear yield stress, $k$. The stress components can be expressed in terms of $p$ and the angle $\\varphi$, which the first principal slip-line ($\\alpha$-line) makes with the $x$-axis:\n$$ \\sigma_{xx} = -p - k \\sin(2\\varphi) $$\n$$ \\sigma_{yy} = -p + k \\sin(2\\varphi) $$\n$$ \\sigma_{xy} =  k \\cos(2\\varphi) $$\nThese must satisfy the two-dimensional equilibrium equations without body forces, $\\frac{\\partial \\sigma_{ij}}{\\partial x_j} = 0$.\nSubstituting the stress expressions into the equilibrium equations and assuming $k$ is constant (homogeneous material), we obtain:\n1. $\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} = 0 \\implies -\\frac{\\partial p}{\\partial x} - 2k\\cos(2\\varphi)\\frac{\\partial\\varphi}{\\partial x} - 2k\\sin(2\\varphi)\\frac{\\partial\\varphi}{\\partial y} = 0$\n2. $\\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} = 0 \\implies -2k\\sin(2\\varphi)\\frac{\\partial\\varphi}{\\partial x} - \\frac{\\partial p}{\\partial y} + 2k\\cos(2\\varphi)\\frac{\\partial\\varphi}{\\partial y} = 0$\nThis is a system of two first-order partial differential equations for $p(x,y)$ and $\\varphi(x,y)$.\n$$ \\frac{\\partial p}{\\partial x} + 2k\\left(\\cos(2\\varphi)\\frac{\\partial \\varphi}{\\partial x} + \\sin(2\\varphi)\\frac{\\partial \\varphi}{\\partial y}\\right) = 0 $$\n$$ \\frac{\\partial p}{\\partial y} + 2k\\left(\\sin(2\\varphi)\\frac{\\partial \\varphi}{\\partial x} - \\cos(2\\varphi)\\frac{\\partial \\varphi}{\\partial y}\\right) = 0 $$\nThis hyperbolic system has real characteristics, which are the slip-lines. To find them, we seek directions $m = dy/dx$ along which the PDEs reduce to ordinary differential equations (the compatibility relations). This condition leads to a quadratic equation for the characteristic slopes $m$:\n$$ m^{2}\\sin(2\\varphi) + 2m\\cos(2\\varphi) - \\sin(2\\varphi) = 0 $$\nThe roots of this equation are:\n$m_1 = \\tan(\\varphi)$, corresponding to the $\\alpha$-lines.\n$m_2 = -\\cot(\\varphi) = \\tan(\\varphi + \\pi/2)$, corresponding to the $\\beta$-lines.\nAlong these characteristic lines, the compatibility relations, known as Hencky's equations, are found. Along an $\\alpha$-line ($dy/dx = \\tan(\\varphi)$), we find $dp = -2k d\\varphi$, which integrates to:\n$$ p + 2k\\varphi = C_1 \\quad (\\text{along an } \\alpha \\text{-line}) $$\nAlong a $\\beta$-line ($dy/dx = -\\cot(\\varphi)$), we find $dp = 2k d\\varphi$, which integrates to:\n$$ p - 2k\\varphi = C_2 \\quad (\\text{along a } \\beta \\text{-line}) $$\nThese are the required characteristic equations.\n\nSecond, we use a non-dimensionalization argument. Let us define a normalized pressure $P = p/(2k)$. Hencky's equations become:\n$$ P + \\varphi = C_1 / (2k) = C_1^* \\quad (\\text{along an } \\alpha \\text{-line}) $$\n$$ P - \\varphi = C_2 / (2k) = C_2^* \\quad (\\text{along a } \\beta \\text{-line}) $$\nThe geometry of the slip-line field is governed by the angles $\\varphi$ and the boundary conditions. For Prandtl compression between perfectly rough platens, the slip-lines must meet the platens at $\\pm \\pi/4$. Any stress boundary conditions on free surfaces, for example $p=k$, become $P=1/2$ in normalized form. The entire boundary value problem for the dimensionless fields $P(x/H, y/H)$ and $\\varphi(x/H, y/H)$ is independent of the specific values of $H$ and $k$. Consequently, the solution field for the normalized pressure $p/(2k)$ is a universal function of normalized coordinates and does not depend on the magnitude of $k$.\n\nThird, we explain the mapping from uniaxial yield stress $\\sigma_y$ to the shear yield stress $k$. This mapping depends on the chosen yield criterion.\nFor the Tresca criterion, yielding occurs when the maximum shear stress equals $k_T$. In a uniaxial tensile test, the principal stresses are $(\\sigma_y, 0, 0)$, so the maximum shear stress is $\\tau_{\\max} = (\\sigma_y - 0)/2 = \\sigma_y/2$. Therefore, for Tresca:\n$$ k_T = \\frac{\\sigma_y}{2} $$\nFor the von Mises criterion, yielding occurs when the second invariant of the deviatoric stress tensor, $J_2$, reaches a critical value. From a uniaxial test, this value is $J_2 = \\sigma_y^2/3$. The slip-line field theory for a von Mises material under plane strain requires an effective shear yield stress, $k_{VM}$. For plane strain ($\\epsilon_z=0$) with the associated flow rule, one finds $\\sigma_z = (\\sigma_x+\\sigma_y)/2$, where $\\sigma_z$ is the out-of-plane stress. The von Mises criterion $J_2 = \\sigma_y^2/3$ then reduces to $\\frac{1}{4}(\\sigma_1-\\sigma_2)^2 = \\sigma_y^2/3$, where $\\sigma_1, \\sigma_2$ are the in-plane principal stresses. Since the maximum in-plane shear stress is defined as $k = (\\sigma_1-\\sigma_2)/2$, we have $(2k_{VM})^2/4 = \\sigma_y^2/3$, which gives:\n$$ k_{VM} = \\frac{\\sigma_y}{\\sqrt{3}} $$\n\nFinally, we deduce the ratio of the average platen pressures, $\\bar{p}_{\\text{Mises}}/\\bar{p}_{\\text{Tresca}}$.\nThe average pressure $\\bar{p}$ is the total load per unit thickness divided by the contact length. From our non-dimensionalization argument, the normalized average pressure $\\bar{p}/(2k)$ must be a constant, let us call it $C$, that depends only on the geometry of the problem (e.g., aspect ratio of the compressed region) and the boundary conditions (perfectly rough platens). The problem statement specifies the same geometry and boundary conditions for both cases.\n$$ \\frac{\\bar{p}}{2k} = C \\implies \\bar{p} = 2kC $$\nThe constant $C$ is identical for both Tresca and von Mises analyses. Therefore, the average pressures are:\n$$ \\bar{p}_{\\text{Tresca}} = 2k_T C $$\n$$ \\bar{p}_{\\text{Mises}} = 2k_{VM} C $$\nThe ratio is simply the ratio of the respective shear yield stresses:\n$$ \\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}} = \\frac{2k_{VM}C}{2k_T C} = \\frac{k_{VM}}{k_T} $$\nSubstituting the expressions for $k_T$ and $k_{VM}$ for the same $\\sigma_y$:\n$$ \\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}} = \\frac{\\sigma_y/\\sqrt{3}}{\\sigma_y/2} = \\frac{2}{\\sqrt{3}} $$\n\nThe physical origin of this discrepancy is that the von Mises and Tresca yield criteria are not identical. In principal stress space, the von Mises cylinder circumscribes the Tresca hexagonal prism. They coincide only for specific stress states like uniaxial or equi-biaxial stress. For general multi-axial stress states, such as those present in plane-strain compression, the von Mises criterion predicts a higher elastic limit. The material is effectively stronger under the von Mises assumption, as reflected by $k_{VM} \\approx 0.577\\sigma_y$ being greater than $k_T = 0.5\\sigma_y$. Consequently, a higher pressure is required to induce and sustain plastic flow throughout the strip.", "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}}}\n$$", "id": "2685824"}, {"introduction": "While analytical slip-line solutions are elegant, they are only available for a limited set of idealized problems; for most real-world applications, numerical methods are indispensable. This exercise takes you from the theoretical differential equations to a practical computational tool for solving them. You will implement a numerical marching algorithm to integrate the Hencky and Geiringer relations, allowing you to trace the geometry and stress state along a slip-line, a core capability of any advanced plasticity solver. [@problem_id:2646134]", "problem": "You are asked to design and implement a numerical marching algorithm, consistent with the theory of plane, ideal plastic flow in solid mechanics, to integrate the mean pressure field along an $\\alpha$-slip-line from given initial data. The algorithm must follow the classical Hencky and Geiringer slip-line relations for an ideally plastic, incompressible, plane strain material with constant shear yield stress.\n\nStart from the following fundamental base:\n\n- Constitutive and yield assumptions: Ideal plasticity with constant shear yield stress $k$; plane strain, incompressible flow; slip-line field theory applies.\n- Characteristic directions: At each point, there are two orthogonal slip-line families, $\\alpha$ and $\\beta$, which are at angles $\\pm \\pi/4$ to the principal stress directions (equivalently, at angles $\\theta \\pm \\pi/4$ with respect to a fixed $x$-axis, where $\\theta$ is the angle of the major principal stress direction).\n- Hencky equations (characteristic stress relations): Along an $\\alpha$-line, the mean pressure $p$ and the stress orientation $\\theta$ satisfy $dp = 2 k\\, d\\theta$.\n- Geometric relations for motion along a curve: If $s$ denotes the arc length along an $\\alpha$-line, then the local tangent makes angle $\\theta + \\pi/4$ with the $x$-axis, so $dx/ds = \\cos(\\theta + \\pi/4)$ and $dy/ds = \\sin(\\theta + \\pi/4)$, where $x$ and $y$ are Cartesian coordinates.\n- Curvature definition: The curvature $\\kappa_{\\alpha}$ of the $\\alpha$-line satisfies $d\\theta/ds = \\kappa_{\\alpha}$, because the tangent angle of the $\\alpha$-line is $\\theta + \\pi/4$ and the derivative of the tangent angle with respect to arc length equals curvature. In this problem, you are given $\\kappa_{\\alpha}$ as a prescribed function of $\\theta$ along the $\\alpha$-line, denoted $\\kappa(\\theta)$.\n\nFrom these, derive a system of ordinary differential equations with the stress orientation $\\theta$ as the independent variable. Use $d\\theta/ds = \\kappa(\\theta)$ to obtain $ds/d\\theta = 1/\\kappa(\\theta)$, and combine with the geometric relations to get\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dp}{d\\theta} = 2 k.\n$$\nAngles must be handled in radians. Positions must be in meters, and pressure in Pascals.\n\nYour task is to implement a fourth-order Runge–Kutta marching algorithm that integrates the above system along an $\\alpha$-line from an initial state $\\{x_0,y_0,p_0,\\theta_0\\}$ to a terminal orientation $\\theta_f$, given a constant yield parameter $k$ and a prescribed curvature function $\\kappa(\\theta)$. You must ensure that $\\kappa(\\theta)$ does not vanish on the integration interval $\\left[\\theta_0,\\theta_f\\right]$ to avoid singularities. The algorithm should be robust to both positive and negative curvature and to either increasing or decreasing $\\theta$.\n\nTest suite specification:\nImplement your program to solve the following three cases. Use radians for angles, meters for $x$ and $y$, and Pascals for $p$ and $k$.\n\n- Case $1$ (constant positive curvature, analytic benchmark):\n  - $k = 1.0 \\times 10^{6}$,\n  - $\\kappa(\\theta) = 0.5$,\n  - $\\theta_0 = 0.0$, $\\theta_f = 0.5$,\n  - $x_0 = 0.0$, $y_0 = 0.0$, $p_0 = 5.0 \\times 10^{6}$.\n- Case $2$ (nonuniform positive curvature):\n  - $k = 2.5 \\times 10^{6}$,\n  - $\\kappa(\\theta) = 0.2 + 0.1 \\cos(\\theta)$,\n  - $\\theta_0 = 0.2$, $\\theta_f = 1.0$,\n  - $x_0 = 1.0$, $y_0 = -0.5$, $p_0 = 1.0 \\times 10^{6}$.\n- Case $3$ (constant negative curvature, decreasing $\\theta$):\n  - $k = 1.5 \\times 10^{6}$,\n  - $\\kappa(\\theta) = -0.3$,\n  - $\\theta_0 = 1.2$, $\\theta_f = 0.7$,\n  - $x_0 = -2.0$, $y_0 = 2.0$, $p_0 = 0.0$.\n\nNumerical and output requirements:\n\n- Implement a fourth-order Runge–Kutta integrator in $\\theta$ for the coupled system for $x(\\theta)$, $y(\\theta)$, and $p(\\theta)$.\n- Use radians for all trigonometric evaluations.\n- Ensure that the step size is chosen to resolve the interval $\\left[\\theta_0,\\theta_f\\right]$ adequately in each case; you may choose a uniform partition in $\\theta$.\n- For each case, return the final state $\\{x(\\theta_f), y(\\theta_f), p(\\theta_f)\\}$.\n- Round each reported $x$, $y$, and $p$ to six decimal places.\n- Final output format: Your program should produce a single line of output containing a Python-style list of lists with the three triplets corresponding to the three cases, in the order given above, with no extra whitespace or text. For example:\n`[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]`.\n\nNote: You must not assume any \"shortcut\" formula beyond the stated fundamentals; the derivation and implementation must proceed from the given relations. Ensure scientific realism by checking that $\\kappa(\\theta)$ does not vanish on the integration intervals provided in the test suite.", "solution": "The problem statement is validated as scientifically sound, well-posed, and complete. It presents a standard initial value problem derived from the fundamental principles of slip-line field theory in solid mechanics. The task is to numerically integrate a system of ordinary differential equations (ODEs) using the fourth-order Runge-Kutta method.\n\nThe physical system is an ideally plastic, incompressible material under plane strain conditions. The state of the material along an $\\alpha$-slip-line is described by the Cartesian coordinates $(x, y)$, the mean pressure $p$, and the orientation of the principal stresses $\\theta$. The evolution of these variables is governed by the Hencky and Geiringer relations. By choosing $\\theta$ as the independent variable, we are given the following system of first-order ODEs:\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dp}{d\\theta} = 2k\n$$\nwhere $k$ is the constant shear yield stress and $\\kappa(\\theta)$ is the prescribed curvature of the $\\alpha$-slip-line as a function of $\\theta$.\n\nWe can write this system in vector form. Let the state vector be $\\mathbf{y}(\\theta) = [x(\\theta), y(\\theta), p(\\theta)]^T$. The system is then expressed as:\n$$\n\\frac{d\\mathbf{y}}{d\\theta} = \\mathbf{F}(\\theta)\n$$\nwhere the vector function $\\mathbf{F}(\\theta)$ is given by:\n$$\n\\mathbf{F}(\\theta) = \\begin{pmatrix} \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)} \\\\ \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)} \\\\ 2k \\end{pmatrix}\n$$\nThis is an initial value problem, where we are given the initial state $\\mathbf{y}_0 = [x_0, y_0, p_0]^T$ at $\\theta = \\theta_0$, and we seek the final state $\\mathbf{y}_f$ at $\\theta = \\theta_f$.\n\nTo solve this system numerically, we implement the fourth-order Runge-Kutta (RK4) method. The integration interval $[\\theta_0, \\theta_f]$ is discretized into $N$ steps of size $h = (\\theta_f - \\theta_0) / N$. For each step, starting from the state $\\mathbf{y}_n$ at $\\theta_n$, the state $\\mathbf{y}_{n+1}$ at $\\theta_{n+1} = \\theta_n + h$ is calculated as:\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nThe intermediate vectors $\\mathbf{k}_i$ for a general ODE system $\\frac{d\\mathbf{y}}{d\\theta} = \\mathbf{F}(\\theta, \\mathbf{y})$ are defined as:\n$$\n\\mathbf{k}_1 = h \\cdot \\mathbf{F}(\\theta_n, \\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = h \\cdot \\mathbf{F}(\\theta_n + h/2, \\mathbf{y}_n + \\mathbf{k}_1/2) \\\\\n\\mathbf{k}_3 = h \\cdot \\mathbf{F}(\\theta_n + h/2, \\mathbf{y}_n + \\mathbf{k}_2/2) \\\\\n\\mathbf{k}_4 = h \\cdot \\mathbf{F}(\\theta_n + h, \\mathbf{y}_n + \\mathbf{k}_3)\n$$\nA crucial observation for this specific problem is that the function $\\mathbf{F}$ depends only on $\\theta$ and not on the state vector $\\mathbf{y}$. This simplifies the expressions for the intermediate vectors to:\n$$\n\\mathbf{k}_1 = h \\cdot \\mathbf{F}(\\theta_n) \\\\\n\\mathbf{k}_2 = h \\cdot \\mathbf{F}(\\theta_n + h/2) \\\\\n\\mathbf{k}_3 = h \\cdot \\mathbf{F}(\\theta_n + h/2) \\\\\n\\mathbf{k}_4 = h \\cdot \\mathbf{F}(\\theta_n + h)\n$$\nSubstituting these into the update formula, we get:\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{6} \\left( \\mathbf{F}(\\theta_n) + 4\\mathbf{F}(\\theta_n + h/2) + \\mathbf{F}(\\theta_n + h) \\right)\n$$\nThis is equivalent to applying Simpson's $1/3$ rule for numerical integration to each component of the vector function $\\mathbf{F}(\\theta)$ over the interval $[\\theta_n, \\theta_{n+1}]$.\n\nThe implementation will consist of a general function that performs this RK4 integration for a given function $\\mathbf{F}(\\theta)$, initial conditions, integration range, and number of steps $N$. To ensure high accuracy and meet the requirement of rounding to $6$ decimal places, a large number of steps, such as $N=10000$, will be used. This choice of $N$ makes the step size $h$ small, and since the global error of the RK4 method is of order $O(h^4)$, the numerical solution will be very close to the true solution.\n\nThe algorithm is applied to each of the three test cases provided. For each case, the specific parameters $k$, $x_0$, $y_0$, $p_0$, $\\theta_0$, $\\theta_f$, and the function $\\kappa(\\theta)$ are used to define the corresponding $\\mathbf{F}(\\theta)$. The algorithm accommodates both increasing ($\\theta_f > \\theta_0$) and decreasing ($\\theta_f < \\theta_0$) integration paths, as the step size $h$ will simply be positive or negative accordingly. The validity check confirmed that $\\kappa(\\theta)$ is non-zero over the integration intervals for all test cases, ensuring the right-hand side function $\\mathbf{F}(\\theta)$ is well-defined. The final computed values of $x(\\theta_f)$, $y(\\theta_f)$, and $p(\\theta_f)$ for each case are rounded to $6$ decimal places and formatted as specified.", "answer": "```python\nimport numpy as np\n\ndef rk4_integrator(F_theta, y0, theta0, theta_f, N):\n    \"\"\"\n    Integrates the ODE system dy/d(theta) = F(theta) using a fourth-order Runge-Kutta method.\n    The method simplifies to Simpson's rule because F is independent of y.\n\n    Args:\n        F_theta (callable): The vector function F(theta) = [dx/dtheta, dy/dtheta, dp/dtheta].\n        y0 (list or np.ndarray): Initial state vector [x0, y0, p0].\n        theta0 (float): Initial value of the independent variable theta.\n        theta_f (float): Final value of the independent variable theta.\n        N (int): Number of integration steps.\n\n    Returns:\n        np.ndarray: The final state vector y(theta_f).\n    \"\"\"\n    h = (theta_f - theta0) / N\n    theta = theta0\n    y = np.array(y0, dtype=float)\n\n    for _ in range(N):\n        F1 = F_theta(theta)\n        F2 = F_theta(theta + h / 2.0)\n        # F3 = F_theta(theta + h / 2.0) is the same as F2\n        F4 = F_theta(theta + h)\n        \n        # The update formula simplifies from (F1 + 2*F2 + 2*F3 + F4) to (F1 + 4*F2 + F4)\n        y += (h / 6.0) * (F1 + 4.0 * F2 + F4)\n        theta += h\n        \n    return y\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the three specified test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"k\": 1.0e6,\n            \"kappa_func\": lambda theta: 0.5,\n            \"theta0\": 0.0,\n            \"theta_f\": 0.5,\n            \"initial_state\": [0.0, 0.0, 5.0e6]\n        },\n        {\n            \"k\": 2.5e6,\n            \"kappa_func\": lambda theta: 0.2 + 0.1 * np.cos(theta),\n            \"theta0\": 0.2,\n            \"theta_f\": 1.0,\n            \"initial_state\": [1.0, -0.5, 1.0e6]\n        },\n        {\n            \"k\": 1.5e6,\n            \"kappa_func\": lambda theta: -0.3,\n            \"theta0\": 1.2,\n            \"theta_f\": 0.7,\n            \"initial_state\": [-2.0, 2.0, 0.0]\n        }\n    ]\n\n    all_results = []\n    \n    # Use a large number of steps for high accuracy\n    num_steps = 10000\n\n    for case in test_cases:\n        k = case[\"k\"]\n        kappa_func = case[\"kappa_func\"]\n\n        # Define the derivative function F(theta) for the current case\n        def F_theta(theta):\n            kappa_val = kappa_func(theta)\n            # The problem guarantees kappa_val is non-zero on the interval\n            cos_term = np.cos(theta + np.pi / 4.0)\n            sin_term = np.sin(theta + np.pi / 4.0)\n            return np.array([\n                cos_term / kappa_val,\n                sin_term / kappa_val,\n                2.0 * k\n            ])\n\n        # Integrate the system of ODEs\n        y_final = rk4_integrator(\n            F_theta,\n            case[\"initial_state\"],\n            case[\"theta0\"],\n            case[\"theta_f\"],\n            num_steps\n        )\n\n        # Round the final results to six decimal places as required\n        x_f_rounded = round(y_final[0], 6)\n        y_f_rounded = round(y_final[1], 6)\n        p_f_rounded = round(y_final[2], 6)\n        \n        all_results.append([x_f_rounded, y_f_rounded, p_f_rounded])\n        \n    # Format the final output string to match the required format: \"[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]\"\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "2646134"}]}