{"hands_on_practices": [{"introduction": "The cornerstone of any damage model is the thermodynamic force that drives material degradation, known as the damage energy release rate $Y$. This practice provides fundamental training in deriving this crucial quantity directly from the Helmholtz free energy for a given multiaxial loading condition. Successfully completing this exercise ([@problem_id:2876618]) reinforces the direct link between thermodynamic potentials and the mechanics of damage.", "problem": "A linear elastic, isotropic solid is modeled using an isotropic scalar damage variable $d \\in [0,1)$ within the effective stress concept of Continuum Damage Mechanics (CDM). Under small strains, assume the Helmholtz free energy per unit reference volume has the separable form\n$$\n\\psi(\\boldsymbol{\\varepsilon},d) = (1-d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon}), \\quad \\text{with} \\quad \\psi_{0}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon},\n$$\nwhere $\\lambda$ and $\\mu$ are the Lamé parameters of the undamaged solid, related to Young’s modulus $E$ and Poisson’s ratio $\\nu$ by $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$. Unilateral effects are neglected, and all fields are homogeneous.\n\nThe thermodynamic force (damage energy release rate) conjugate to $d$ is defined by $Y = -\\dfrac{\\partial \\psi}{\\partial d}\\big|_{\\boldsymbol{\\varepsilon}}$. The material is subjected to a proportional biaxial tension path whose principal strain components are $\\left(\\varepsilon_{1},\\varepsilon_{2},\\varepsilon_{3}\\right) = \\left(\\varepsilon, \\beta\\,\\varepsilon, 0\\right)$ with fixed $\\beta \\ge 0$ and scalar amplitude $\\varepsilon \\ge 0$. Damage initiates when $Y$ reaches a given positive threshold $Y_{0}$ (with the dimensions of energy density).\n\nStarting solely from the stated definitions and relations, do the following:\n- Derive the explicit expression of $Y(\\varepsilon)$ in terms of $E$, $\\nu$, $\\beta$, and $\\varepsilon$.\n- Determine the closed-form analytic expression of the strain amplitude at damage onset, $\\varepsilon_{\\text{onset}}$, defined by the condition $Y(\\varepsilon_{\\text{onset}}) = Y_{0}$.\n\nProvide your final answer as a single closed-form expression for $\\varepsilon_{\\text{onset}}$ in terms of $E$, $\\nu$, $\\beta$, and $Y_{0}$. Do not include units in the final answer. No numerical evaluation is required.", "solution": "The problem presented is a standard exercise in Continuum Damage Mechanics and is found to be scientifically grounded, well-posed, and self-contained. It contains no logical contradictions, ambiguities, or factual inaccuracies. Therefore, the problem is valid, and a rigorous solution can be derived.\n\nThe objective is to find the strain amplitude at the onset of damage, $\\varepsilon_{\\text{onset}}$, under a specific biaxial loading condition. This requires two main steps: first, to derive the expression for the damage energy release rate $Y$ as a function of the strain amplitude $\\varepsilon$; second, to solve for the strain at which $Y$ reaches a critical threshold $Y_0$.\n\nThe Helmholtz free energy per unit volume is given as\n$$ \\psi(\\boldsymbol{\\varepsilon},d) = (1-d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon}) $$\nwhere $d$ is the scalar damage variable and $\\psi_{0}(\\boldsymbol{\\varepsilon})$ is the strain energy density of the undamaged material, defined as\n$$ \\psi_{0}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} $$\nThe thermodynamic force conjugate to the damage variable $d$, known as the damage energy release rate, is defined by\n$$ Y = -\\frac{\\partial \\psi}{\\partial d}\\bigg|_{\\boldsymbol{\\varepsilon}} $$\nSubstituting the expression for $\\psi(\\boldsymbol{\\varepsilon},d)$ into this definition, we perform the partial differentiation with respect to $d$ while holding the strain tensor $\\boldsymbol{\\varepsilon}$ constant:\n$$ Y = -\\frac{\\partial}{\\partial d} \\left[ (1-d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon}) \\right] = -(-\\psi_{0}(\\boldsymbol{\\varepsilon})) = \\psi_{0}(\\boldsymbol{\\varepsilon}) $$\nThis fundamental result shows that for this model, the damage energy release rate is precisely equal to the strain energy density of the fictitious undamaged material.\n\nThe next step is to evaluate $\\psi_{0}$ for the specified loading path. The principal components of the strain tensor $\\boldsymbol{\\varepsilon}$ are given as $(\\varepsilon_{1},\\varepsilon_{2},\\varepsilon_{3}) = (\\varepsilon, \\beta\\varepsilon, 0)$. In its principal coordinate system, the strain tensor is represented by the matrix:\n$$ \\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon & 0 & 0 \\\\ 0 & \\beta\\varepsilon & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nWe must now compute the two strain invariants required for $\\psi_{0}$: the trace of $\\boldsymbol{\\varepsilon}$, $\\operatorname{tr}\\boldsymbol{\\varepsilon}$, and the double-dot product $\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$.\n\nThe trace is the sum of the principal strains:\n$$ \\operatorname{tr}\\boldsymbol{\\varepsilon} = \\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3 = \\varepsilon + \\beta\\varepsilon + 0 = (1+\\beta)\\varepsilon $$\nThe double-dot product, which is the sum of the squares of all tensor components, simplifies to the sum of the squares of the principal strains for a diagonal tensor:\n$$ \\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} = \\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2 = \\varepsilon^2 + (\\beta\\varepsilon)^2 + 0^2 = (1+\\beta^2)\\varepsilon^2 $$\n\nNow, we substitute these invariants into the expression for $Y = \\psi_{0}$:\n$$ Y(\\varepsilon) = \\frac{1}{2}\\lambda \\left((1+\\beta)\\varepsilon\\right)^{2} + \\mu\\left((1+\\beta^2)\\varepsilon^2\\right) $$\n$$ Y(\\varepsilon) = \\left[ \\frac{1}{2}\\lambda (1+\\beta)^2 + \\mu (1+\\beta^2) \\right] \\varepsilon^2 $$\nTo obtain the expression in terms of the engineering constants $E$ and $\\nu$, we substitute the provided relations for the Lamé parameters $\\lambda$ and $\\mu$:\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}, \\quad \\mu = \\frac{E}{2(1+\\nu)} $$\nSubstituting these into the expression for $Y(\\varepsilon)$:\n$$ Y(\\varepsilon) = \\left[ \\frac{1}{2} \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} (1+\\beta)^2 + \\frac{E}{2(1+\\nu)} (1+\\beta^2) \\right] \\varepsilon^2 $$\nWe factor out the common term $\\frac{E}{2(1+\\nu)(1-2\\nu)}$:\n$$ Y(\\varepsilon) = \\frac{E\\varepsilon^2}{2(1+\\nu)(1-2\\nu)} \\left[ \\nu(1+\\beta)^2 + (1-2\\nu)(1+\\beta^2) \\right] $$\nNow, we simplify the expression within the brackets:\n$$ \\nu(1+\\beta)^2 + (1-2\\nu)(1+\\beta^2) = \\nu(1+2\\beta+\\beta^2) + (1+\\beta^2 - 2\\nu - 2\\nu\\beta^2) $$\n$$ = \\nu + 2\\nu\\beta + \\nu\\beta^2 + 1 + \\beta^2 - 2\\nu - 2\\nu\\beta^2 $$\nGrouping the terms, we find a more compact form:\n$$ = 1 + \\beta^2 - \\nu - \\nu\\beta^2 + 2\\nu\\beta = 1 + \\beta^2 - \\nu(1 + \\beta^2 - 2\\beta) = 1 + \\beta^2 - \\nu(1-\\beta)^2 $$\nThus, the explicit expression for the damage energy release rate as a function of $\\varepsilon$ is:\n$$ Y(\\varepsilon) = \\frac{E\\varepsilon^2}{2(1+\\nu)(1-2\\nu)} \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right] $$\nThis completes the first part of the task.\n\nFinally, we determine the strain at damage onset, $\\varepsilon_{\\text{onset}}$. Damage initiation occurs when $Y$ reaches the threshold value $Y_{0}$. We set $Y(\\varepsilon_{\\text{onset}}) = Y_0$:\n$$ Y_0 = \\frac{E\\varepsilon_{\\text{onset}}^2}{2(1+\\nu)(1-2\\nu)} \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right] $$\nTo find $\\varepsilon_{\\text{onset}}$, we solve for it by isolating $\\varepsilon_{\\text{onset}}^2$:\n$$ \\varepsilon_{\\text{onset}}^2 = \\frac{2(1+\\nu)(1-2\\nu)Y_0}{E \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right]} $$\nSince the strain amplitude $\\varepsilon$ is defined as non-negative ($\\varepsilon \\ge 0$), we take the principal (positive) square root to obtain the final expression for $\\varepsilon_{\\text{onset}}$:\n$$ \\varepsilon_{\\text{onset}} = \\sqrt{\\frac{2(1+\\nu)(1-2\\nu)Y_0}{E \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right]}} $$\nThis expression is physically valid, as the term under the square root is positive for all physically reasonable material properties ($E > 0$, $0 \\le \\nu < 0.5$) and loading conditions ($\\beta \\ge 0$, $Y_{0} > 0$).", "answer": "$$\\boxed{\\sqrt{\\frac{2(1+\\nu)(1-2\\nu)Y_{0}}{E\\left[1 + \\beta^{2} - \\nu(1-\\beta)^{2}\\right]}}}$$", "id": "2876618"}, {"introduction": "The formulation of a damage model is not unique; different physically-motivated hypotheses can lead to different predictions. This exercise ([@problem_id:2876594]) challenges you to explore this by comparing an \"energy-based\" and a \"strain-based\" equivalence principle for a non-linear material. By constructing a counterexample, you will see how modeling choices directly impact the damage driving force $Y$ and, consequently, the predicted material behavior.", "problem": "Consider a one-dimensional hyperelastic bar with a scalar isotropic damage variable $D \\in [0,1)$ and total small strain $\\varepsilon \\in \\mathbb{R}$. Let the undamaged Helmholtz free energy be a nonlinear function of the strain,\n$$\n\\psi_{0}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3},\n$$\nwhere $E>0$ is a constant modulus and $a \\neq 0$ is a constant controlling nonlinearity. The thermodynamic damage driving force is defined as the negative partial derivative of the Helmholtz free energy with respect to $D$ at fixed $\\varepsilon$, namely $Y := -\\frac{\\partial \\psi}{\\partial D}$.\n\nTwo common equivalence hypotheses are invoked to embed damage:\n(i) an energy-based equivalence in which the damaged free energy is a scalar multiple of the undamaged free energy by a degradation function $g(D)$ satisfying $g(0)=1$ and $g(1)=0$; and\n(ii) a strain-based equivalence in which the damaged free energy is computed from the undamaged free energy evaluated at an effective strain $h(D)\\,\\varepsilon$, where $h(0)=1$ and $h(1)=0$.\n\nAssume the simplest linear choices $g(D) = 1 - D$ and $h(D) = 1 - D$, and regard these as two distinct modeling routes for the same undamaged nonlinear law $\\psi_{0}(\\varepsilon)$. Using only the definitions of Helmholtz free energy and the thermodynamic driving force, construct an explicit counterexample showing that the two routes produce different damaged free energies, and then compute the resulting difference in the damage driving force between the strain-based and energy-based constructions,\n$$\n\\Delta Y(\\varepsilon,D,E,a) := Y_{\\mathrm{strain}}(\\varepsilon,D,E,a) - Y_{\\mathrm{energy}}(\\varepsilon,D,E,a).\n$$\n\nProvide your final result as a single closed-form analytical expression in terms of $\\varepsilon$, $D$, $E$, and $a$. Do not perform any numerical evaluation and do not attach units to the final expression.", "solution": "The starting point is the definition of Helmholtz free energy and the thermodynamic driving force for damage. For a free energy $\\psi(\\varepsilon,D)$, the damage driving force is defined by the standard thermodynamic relation\n$$\nY(\\varepsilon,D) := -\\frac{\\partial \\psi(\\varepsilon,D)}{\\partial D}\\bigg|_{\\varepsilon}.\n$$\nWe are given an undamaged hyperelastic law\n$$\n\\psi_{0}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3},\n$$\nwith $E>0$ and $a \\neq 0$ so that the material is nonlinear in strain.\n\nTwo distinct equivalence hypotheses are to be imposed:\n\n1) Energy-based equivalence: The damaged free energy is a scalar multiple of the undamaged free energy by a degradation function $g(D)$. With the given linear choice $g(D) = 1 - D$, the damaged free energy reads\n$$\n\\psi_{\\mathrm{energy}}(\\varepsilon,D) = g(D)\\,\\psi_{0}(\\varepsilon) = (1 - D)\\left(\\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}\\right).\n$$\nBy the definition of the damage driving force,\n$$\nY_{\\mathrm{energy}}(\\varepsilon,D) = -\\frac{\\partial \\psi_{\\mathrm{energy}}}{\\partial D} = \\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}.\n$$\nFor this construction, the driving force is independent of $D$.\n\n2) Strain-based equivalence: The damaged free energy equals the undamaged free energy evaluated at an effective strain $h(D)\\,\\varepsilon$. With the given linear choice $h(D) = 1 - D$, we have\n$$\n\\psi_{\\mathrm{strain}}(\\varepsilon,D) = \\psi_{0}\\big((1 - D)\\,\\varepsilon\\big) = \\frac{1}{2} E \\big((1 - D)\\varepsilon\\big)^{2} + \\frac{1}{3} a \\big((1 - D)\\varepsilon\\big)^{3}.\n$$\nExpanding the powers of $(1 - D)$,\n$$\n\\psi_{\\mathrm{strain}}(\\varepsilon,D) = \\frac{1}{2} E (1 - D)^{2} \\varepsilon^{2} + \\frac{1}{3} a (1 - D)^{3} \\varepsilon^{3}.\n$$\nThe corresponding damage driving force is obtained by differentiating with respect to $D$ at fixed $\\varepsilon$:\n\n$$\n\\frac{\\partial \\psi_{\\mathrm{strain}}}{\\partial D}\n= \\frac{1}{2} E \\cdot 2(1 - D)(-1)\\,\\varepsilon^{2} + \\frac{1}{3} a \\cdot 3(1 - D)^{2}(-1)\\,\\varepsilon^{3}\n= - E (1 - D)\\varepsilon^{2} - a (1 - D)^{2}\\varepsilon^{3}.\n$$\n\nHence,\n$$\nY_{\\mathrm{strain}}(\\varepsilon,D) = -\\frac{\\partial \\psi_{\\mathrm{strain}}}{\\partial D} = E (1 - D)\\varepsilon^{2} + a (1 - D)^{2}\\varepsilon^{3}.\n$$\n\nConstruction of a counterexample. Because $a \\neq 0$ and the mapping $h(D) = 1 - D$ is nonlinear in $D$ when carried into $\\psi_{0}$, the two damaged free energies are distinct for generic $\\varepsilon \\neq 0$ and $D \\in (0,1)$:\n\n$$\n\\psi_{\\mathrm{strain}}(\\varepsilon,D) = \\frac{1}{2} E (1 - D)^{2} \\varepsilon^{2} + \\frac{1}{3} a (1 - D)^{3} \\varepsilon^{3}\n\\neq (1 - D)\\left(\\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}\\right) = \\psi_{\\mathrm{energy}}(\\varepsilon,D),\n$$\n\nsince $(1 - D)^{2} \\neq (1 - D)$ and $(1 - D)^{3} \\neq (1 - D)$ for $D \\in (0,1)$.\n\nThe requested quantitative implication for the damage driving force is the difference\n\n$$\n\\Delta Y(\\varepsilon,D,E,a) := Y_{\\mathrm{strain}}(\\varepsilon,D) - Y_{\\mathrm{energy}}(\\varepsilon,D).\n$$\n\nSubstituting the expressions derived above gives\n\n$$\n\\Delta Y(\\varepsilon,D,E,a) = \\left[E (1 - D)\\varepsilon^{2} + a (1 - D)^{2}\\varepsilon^{3}\\right] - \\left[\\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}\\right].\n$$\n\nOne convenient simplified closed form is\n\n$$\n\\Delta Y(\\varepsilon,D,E,a) = E \\varepsilon^{2}\\left(\\frac{1}{2} - D\\right) + a \\varepsilon^{3}\\left(D^{2} - 2D + \\frac{2}{3}\\right).\n$$\n\n\nInterpretation. For nonlinear elasticity with $a \\neq 0$, the strain-based and energy-based constructions lead to different damage driving forces, even though both satisfy the same normalization at $D=0$. Consequently, predicted dissipation and damage evolution laws that depend on $Y$ will differ across these modeling choices, which is the essence of the counterexample.", "answer": "$$\\boxed{E\\,\\varepsilon^{2}\\left(\\frac{1}{2}-D\\right)+a\\,\\varepsilon^{3}\\left(D^{2}-2D+\\frac{2}{3}\\right)}$$", "id": "2876594"}, {"introduction": "To be practically useful, continuum damage theories must be translated into robust numerical algorithms for use in finite element simulations. This hands-on coding practice ([@problem_id:2876552]) guides you through the derivation and implementation of a 'return-mapping' algorithm, a standard procedure for rate-independent inelasticity. This exercise bridges the gap between the abstract Kuhn-Tucker conditions of damage evolution and a concrete, functional computational update.", "problem": "Consider a small-strain, one-dimensional, isotropic, scalar, rate-independent damage model formulated with the effective stress concept. Let the Cauchy stress be given by the effective stress relation\n$$\n\\sigma = \\left(1 - D\\right) E \\,\\varepsilon,\n$$\nwhere $E$ is the Young's modulus, $\\varepsilon$ is the axial strain, and $D \\in [0,1]$ is the scalar damage variable ($D=0$ undamaged, $D=1$ fully damaged). Adopt the free energy density\n$$\n\\psi(\\varepsilon,D) = \\left(1 - D\\right)\\,\\psi_0(\\varepsilon),\n\\quad\n\\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2,\n$$\nwhere $\\langle \\varepsilon \\rangle_+ := \\max(\\varepsilon,0)$ is the tensile part of strain. The thermodynamic damage driving force is the energy release rate\n$$\nY := -\\frac{\\partial \\psi}{\\partial D} = \\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2.\n$$\nIntroduce a monotonically non-decreasing history variable $\\kappa \\ge 0$ that governs damage growth via a monotone function $D = g(\\kappa)$ with $g(0)=0$ and $g(\\kappa) \\in [0,1)$. Damage initiates once a threshold is exceeded and grows under a rate-independent loading-unloading condition defined by the loading function\n$$\n\\Phi(Y,\\kappa) := Y - R(\\kappa) \\le 0,\n$$\nwith the Kuhn–Tucker conditions\n$$\n\\dot{\\kappa} \\ge 0,\\quad \\Phi \\le 0,\\quad \\dot{\\kappa}\\,\\Phi = 0,\n$$\nwhere $R(\\kappa)$ is an increasing resistance (threshold) function. In an implicit time-stepping scheme from step $n$ to $n+1$, the strain $\\varepsilon_{n+1}$ is prescribed. The objective is to compute $(\\kappa_{n+1},D_{n+1},\\sigma_{n+1})$ given $(\\kappa_n,D_n)$ and the material parameters.\n\nUse the following specific, but generalizable, choices to ensure a well-posed return-mapping-like update:\n- Resistance function: $R(\\kappa) = Y_0 + H\\,\\kappa$, with $Y_0 > 0$ and $H > 0$.\n- Damage law: $D = g(\\kappa) = 1 - \\exp\\!\\left(-\\beta\\,\\kappa\\right)$ with $\\beta > 0$.\n\nStarting only from the definitions above and the rate-independent complementarity, derive a consistent implicit algorithmic update for $(\\kappa_{n+1},D_{n+1},\\sigma_{n+1})$ that is return-mapping-like in the sense of an elastic predictor followed by a corrector that enforces the discrete loading-unloading conditions. Your derivation must start from the free energy, the effective stress concept, and the Kuhn–Tucker conditions, and proceed to an algorithm that is unconditionally stable for the given linear resistance function. Do not assume any explicit formula for the final update a priori; instead, derive it as a consequence of the stated principles.\n\nThen, implement the derived algorithm as a complete, runnable program that processes the test suite below. In all computations, use:\n- Stress-like quantities $Y$, $Y_0$, and $H\\kappa$ in megapascals (MPa).\n- Strain $\\varepsilon$ as dimensionless.\n- Young’s modulus $E$ in MPa.\n- The final outputs to be the updated damage values $D_{n+1}$ (dimensionless).\n\nTest suite (each case is a tuple $(E, Y_0, H, \\beta, \\varepsilon_{n+1}, \\kappa_n)$ with $D_n = g(\\kappa_n)$ implicitly defined):\n1. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.0005,\\; 0.0)$\n2. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.0015,\\; 0.0)$\n3. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.01,\\; 0.0)$\n4. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; -0.002,\\; 0.5)$\n5. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.001380131118684709,\\; 0.2)$\n\nFor each test case, compute the updated $D_{n+1}$ using your algorithm. Your program should produce a single line of output containing the results as a comma-separated list of decimal numbers with six digits after the decimal point, enclosed in square brackets (e.g., \"[0.123456,0.000000,1.000000]\").", "solution": "The problem statement is first subjected to validation.\n\nGivens are extracted verbatim:\n- The Cauchy stress $\\sigma$ is related to the strain $\\varepsilon$ and damage $D$ by the effective stress concept: $\\sigma = \\left(1 - D\\right) E \\,\\varepsilon$, where $E$ is Young's modulus.\n- The damage variable $D$ is in the range $[0,1]$.\n- The Helmholtz free energy density is $\\psi(\\varepsilon,D) = \\left(1 - D\\right)\\,\\psi_0(\\varepsilon)$, with the elastic energy part $\\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2$. The operator $\\langle \\varepsilon \\rangle_+ := \\max(\\varepsilon,0)$ isolates the tensile strain component.\n- The thermodynamic force conjugate to damage, the energy release rate $Y$, is $Y := -\\frac{\\partial \\psi}{\\partial D} = \\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2$.\n- A non-decreasing history variable $\\kappa \\ge 0$ governs damage evolution.\n- The damage law is a monotone function $D = g(\\kappa)$.\n- The rate-independent evolution is defined by a loading function $\\Phi(Y,\\kappa) := Y - R(\\kappa) \\le 0$ and the Kuhn–Tucker conditions: $\\dot{\\kappa} \\ge 0, \\Phi \\le 0, \\dot{\\kappa}\\,\\Phi = 0$.\n- The resistance function is $R(\\kappa) = Y_0 + H\\,\\kappa$, with material parameters $Y_0 > 0$ and $H > 0$.\n- The specific damage law is $D = g(\\kappa) = 1 - \\exp\\!\\left(-\\beta\\,\\kappa\\right)$, with parameter $\\beta > 0$.\n- The problem is an implicit time step from step $n$ to $n+1$, where $\\varepsilon_{n+1}$ is prescribed, and $(\\kappa_n, D_n)$ are known. The objective is to compute $(\\kappa_{n+1}, D_{n+1}, \\sigma_{n+1})$.\n\nThe validation proceeds:\n1.  **Scientific Grounding**: The formulation is based on established principles of continuum damage mechanics. The use of a free energy potential to derive thermodynamic forces and the application of rate-independent evolution laws with Kuhn-Tucker conditions are standard and rigorous methodologies in this field. The model is scientifically sound.\n2.  **Well-Posedness and Completeness**: The problem provides all necessary constitutive functions ($g(\\kappa)$, $R(\\kappa)$), material parameters ($E, Y_0, H, \\beta$), and state variables ($\\kappa_n, \\varepsilon_{n+1}$) required to perform a single-step update. The task is to derive and implement a standard return-mapping algorithm, which is the correct procedure for this class of problems, ensuring a unique solution exists for the update.\n3.  **Objectivity**: The problem is defined with precise mathematical formulations and objective language.\n\nThe problem is deemed valid and a formal derivation of the solution algorithm is warranted.\n\nThe objective is to formulate a computational algorithm for the state update $(\\kappa_n) \\to (\\kappa_{n+1})$ given the prescribed strain $\\varepsilon_{n+1}$. The evolution is governed by the time-discrete form of the Kuhn-Tucker conditions for the step from $t_n$ to $t_{n+1}$:\n$$ \\kappa_{n+1} \\ge \\kappa_n $$\n$$ \\Phi_{n+1} := Y_{n+1} - R(\\kappa_{n+1}) \\le 0 $$\n$$ (\\kappa_{n+1} - \\kappa_n)\\Phi_{n+1} = 0 $$\nwhere $Y_{n+1}$ is the damage driving force evaluated at the known strain $\\varepsilon_{n+1}$. This set of conditions is solved using an elastic predictor-corrector algorithm, also known as a return map.\n\n**Step 1: Elastic Predictor**\nFirst, we assume the step is elastic, meaning no change in the internal damage history variable. The trial value of $\\kappa$ at step $n+1$ is set to its value at step $n$:\n$$ \\kappa_{n+1}^{\\text{trial}} = \\kappa_n $$\nThe damage driving force $Y_{n+1}$ is determined entirely by the given strain $\\varepsilon_{n+1}$:\n$$ Y_{n+1} = \\frac{1}{2} E \\langle \\varepsilon_{n+1} \\rangle_+^2 $$\nNote that if $\\varepsilon_{n+1} \\le 0$, then $Y_{n+1}=0$.\nWith these trial values, we evaluate the loading function to check if the assumption of elastic evolution is correct. The current damage threshold is $R(\\kappa_n)$.\n$$ \\Phi_{n+1}^{\\text{trial}} = Y_{n+1} - R(\\kappa_n) = Y_{n+1} - (Y_0 + H\\kappa_n) $$\n\n**Step 2: Corrector (Return Map)**\nThe value of $\\Phi_{n+1}^{\\text{trial}}$ determines the nature of the step.\n\n**Case A: Elastic Step ($\\Phi_{n+1}^{\\text{trial}} \\le 0$)**\nIf the trial loading function is non-positive, the elastic prediction is correct. The system is either elastically unloading or neutrally loaded. No further damage occurs. The new state is the trial state:\n$$ \\kappa_{n+1} = \\kappa_n $$\nThis trivially satisfies the discrete Kuhn-Tucker conditions: $\\kappa_{n+1} \\ge \\kappa_n$ is met, $\\Phi_{n+1} = \\Phi_{n+1}^{\\text{trial}} \\le 0$ is met by the case definition, and $(\\kappa_{n+1} - \\kappa_n)\\Phi_{n+1} = 0 \\cdot \\Phi_{n+1} = 0$.\n\n**Case B: Damage Step ($\\Phi_{n+1}^{\\text{trial}} > 0$)**\nIf the trial loading function is positive, the elastic prediction is invalid. Damage must evolve to bring the state back to the admissible domain, defined by $\\Phi_{n+1} \\le 0$. The rate-independent consistency condition demands that for plastic loading, the final state must lie on the boundary of the admissible domain:\n$$ \\Phi_{n+1} = 0 $$\nThis implies $Y_{n+1} - R(\\kappa_{n+1}) = 0$. We must solve for the unknown $\\kappa_{n+1}$ that satisfies this condition. Substituting the given material functions:\n$$ Y_{n+1} - (Y_0 + H\\kappa_{n+1}) = 0 $$\nThis equation is linear in $\\kappa_{n+1}$ and yields an analytic solution:\n$$ \\kappa_{n+1} = \\frac{Y_{n+1} - Y_0}{H} $$\nThis update is termed the \"return map\" as it \"returns\" the state to the yield surface $\\Phi = 0$. We must verify that $\\kappa_{n+1} > \\kappa_n$. The condition for entering this case was $\\Phi_{n+1}^{\\text{trial}} = Y_{n+1} - (Y_0 + H\\kappa_n) > 0$. Rearranging this inequality gives $Y_{n+1} - Y_0 > H\\kappa_n$. Since $H > 0$ is given, it follows that $\\frac{Y_{n+1} - Y_0}{H} > \\kappa_n$, confirming that $\\kappa_{n+1} > \\kappa_n$ as required for damage evolution.\n\n**Step 3: Final State Update**\nAfter determining the correct value of $\\kappa_{n+1}$ from either Case A or B, the final values for damage $D_{n+1}$ and stress $\\sigma_{n+1}$ are computed directly from their definitions:\n$$ D_{n+1} = g(\\kappa_{n+1}) = 1 - \\exp(-\\beta\\kappa_{n+1}) $$\n$$ \\sigma_{n+1} = (1-D_{n+1})E\\varepsilon_{n+1} $$\nThe problem requires reporting $D_{n+1}$.\n\n**Algorithmic Summary:**\n1.  **Inputs**: Material parameters $E, Y_0, H, \\beta$; state from step $n$: $\\kappa_n$; prescribed strain for step $n+1$: $\\varepsilon_{n+1}$.\n2.  **Compute Driving Force**: Calculate $Y_{n+1} = \\frac{1}{2} E \\langle \\varepsilon_{n+1} \\rangle_+^2$.\n3.  **Check Loading Condition**: Evaluate $\\Phi_{n+1}^{\\text{trial}} = Y_{n+1} - (Y_0 + H \\kappa_n)$.\n4.  **Update History Variable**:\n    - If $\\Phi_{n+1}^{\\text{trial}} \\le 0$, then set $\\kappa_{n+1} = \\kappa_n$.\n    - If $\\Phi_{n+1}^{\\text{trial}} > 0$, then set $\\kappa_{n+1} = (Y_{n+1} - Y_0) / H$.\n5.  **Compute Final Damage**: Calculate $D_{n+1} = 1 - \\exp(-\\beta \\kappa_{n+1})$.\n6.  **Return**: The value $D_{n+1}$.\n\nThis algorithm is robust, unconditionally stable for any step size (given the specified linear resistance and exponential damage functions), and directly derived from the fundamental principles of the provided model.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the damage mechanics problem for a suite of test cases.\n    \"\"\"\n\n    # Test suite provided in the problem statement.\n    # Each case is a tuple: (E, Y0, H, beta, eps_np1, kappa_n)\n    test_cases = [\n        (210000.0, 0.1, 0.5, 1.5, 0.0005, 0.0),\n        (210000.0, 0.1, 0.5, 1.5, 0.0015, 0.0),\n        (210000.0, 0.1, 0.5, 1.5, 0.01, 0.0),\n        (210000.0, 0.1, 0.5, 1.5, -0.002, 0.5),\n        (210000.0, 0.1, 0.5, 1.5, 0.001380131118684709, 0.2),\n    ]\n\n    def compute_damage_update(E, Y0, H, beta, eps_np1, kappa_n):\n        \"\"\"\n        Computes the updated damage variable D_np1 using a return-mapping algorithm.\n\n        Args:\n            E (float): Young's modulus (MPa)\n            Y0 (float): Initial damage threshold (MPa)\n            H (float): Damage hardening modulus (MPa)\n            beta (float): Damage evolution parameter (dimensionless)\n            eps_np1 (float): Prescribed strain at step n+1 (dimensionless)\n            kappa_n (float): History variable at step n (dimensionless)\n\n        Returns:\n            float: Updated damage variable D_np1 (dimensionless)\n        \"\"\"\n        # Step 1: Compute the damage driving force Y_np1.\n        # The Macaulay bracket <eps>_+ is applied.\n        eps_pos = np.maximum(eps_np1, 0.0)\n        Y_np1 = 0.5 * E * eps_pos**2\n\n        # Step 2: Evaluate the trial loading function Phi_trial.\n        # This checks if the elastic trial state is outside the admissible region.\n        # R(kappa_n) is the resistance at the start of the step.\n        R_kappa_n = Y0 + H * kappa_n\n        trial_phi = Y_np1 - R_kappa_n\n\n        # Step 3: Update the history variable kappa_np1 based on the\n        # discrete Kuhn-Tucker conditions (loading/unloading).\n        if trial_phi <= 0:\n            # Case A: Elastic step (or unloading/neutral loading). No damage evolution.\n            kappa_np1 = kappa_n\n        else:\n            # Case B: Damage step. The state is returned to the yield surface.\n            # The consistency condition Phi_np1 = 0 is enforced.\n            kappa_np1 = (Y_np1 - Y0) / H\n            \n        # Step 4: Compute the final damage D_np1 using the updated history variable.\n        D_np1 = 1.0 - np.exp(-beta * kappa_np1)\n\n        return D_np1\n\n    results = []\n    for case in test_cases:\n        D_np1 = compute_damage_update(*case)\n        results.append(D_np1)\n\n    # Format the output as a comma-separated list of numbers with 6 decimal places,\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2876552"}]}