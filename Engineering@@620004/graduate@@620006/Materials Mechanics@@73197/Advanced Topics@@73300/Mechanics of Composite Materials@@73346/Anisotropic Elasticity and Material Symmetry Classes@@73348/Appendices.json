{"hands_on_practices": [{"introduction": "Before classifying a material's symmetry, we must first ensure our mathematical description is physically sound. This practice explores the fundamental requirement that the stiffness tensor must possess major symmetry, a direct consequence of the existence of a strain energy density function $W$. By working through this exercise, you will learn how this translates to the symmetry of the Voigt matrix, $\\mathbf{C} = \\mathbf{C}^{\\top}$, and how to test a candidate matrix for this non-negotiable property of hyperelastic materials [@problem_id:2866512].", "problem": "Consider a linearly elastic anisotropic solid described at small strain by a quadratic strain energy density $W(\\boldsymbol{\\varepsilon})$, where $\\boldsymbol{\\varepsilon}$ is the infinitesimal strain tensor. A necessary and sufficient condition for the existence of such a scalar energy is that the fourth-order stiffness tensor $\\mathsf{c}$ satisfies the minor and major symmetries implied by interchangeability of work conjugate pairs. In contracted Voigt notation with engineering shear strains, the constitutive equation is written as $\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\mathbf{e}$, where $\\boldsymbol{\\sigma}$ is the stress vector, $\\mathbf{e}$ is the strain vector containing the normal strains and engineering shear strains, and $\\mathbf{C}$ is a $6\\times 6$ stiffness matrix. \n\nYou are given the following candidate stiffness matrix $\\mathbf{C}$ in $\\mathrm{GPa}$:\n$$\n\\mathbf{C}=\n\\begin{pmatrix}\n160 & 65 & 70 & 4 & -6 & 10\\\\\n60 & 150 & 68 & -5 & 8 & -2\\\\\n72 & 66 & 140 & 7 & -9 & 5\\\\\n6 & -4 & 3 & 50 & 12 & -8\\\\\n-7 & 9 & -10 & 15 & 60 & 6\\\\\n12 & -3 & 6 & -9 & 4 & 55\n\\end{pmatrix}.\n$$\n\nStarting from the principle that $W(\\boldsymbol{\\varepsilon})=\\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}:\\mathsf{c}:\\boldsymbol{\\varepsilon}$, and using only the standard definitions that connect the fourth-order tensor $\\mathsf{c}$ to the Voigt matrix $\\mathbf{C}$ built with engineering shear strains, do the following:\n\n- Derive the symmetry conditions on $\\mathsf{c}$ (minor and major) implied by the existence of $W(\\boldsymbol{\\varepsilon})$.\n- State the corresponding conditions these imply on $\\mathbf{C}$ in Voigt notation with engineering shear components.\n- Test the given $\\mathbf{C}$ for these implied conditions.\n- Construct a symmetrized stiffness $\\mathbf{C}^{S}$ that enforces the symmetries implied by the energy principle (by appropriate symmetrization at the fourth-order tensor level consistent with the engineering shear convention), and then map back to Voigt form.\n- Let $\\Delta \\mathbf{C}=\\mathbf{C}^{S}-\\mathbf{C}$. Compute the Frobenius norm $\\|\\Delta \\mathbf{C}\\|_{F}$.\n\nRound your final numerical result for $\\|\\Delta \\mathbf{C}\\|_{F}$ to four significant figures. Express your answer in $\\mathrm{GPa}$.", "solution": "The problem requires an analysis of a candidate stiffness matrix for a linearly elastic material, based on the fundamental requirement that its behavior must be derivable from a scalar strain energy potential. This analysis proceeds from first principles.\n\nFirst, we establish the necessary symmetry properties of the fourth-order stiffness tensor $\\mathsf{c}$. The strain energy density is given as a quadratic form of the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$:\n$$\nW(\\boldsymbol{\\varepsilon}) = \\frac{1}{2} \\boldsymbol{\\varepsilon} : \\mathsf{c} : \\boldsymbol{\\varepsilon} = \\frac{1}{2} c_{ijkl} \\varepsilon_{ij} \\varepsilon_{kl}\n$$\nThe stress tensor $\\boldsymbol{\\sigma}$ is the work conjugate to the strain tensor $\\boldsymbol{\\varepsilon}$, and for a hyperelastic material, it is derived from the strain energy potential as:\n$$\n\\sigma_{ij} = \\frac{\\partial W}{\\partial \\varepsilon_{ij}}\n$$\nSubstituting the expression for $W$, and accounting for the index symmetries of the summation, we have:\n$$\n\\sigma_{ij} = \\frac{1}{2} \\left( c_{ijkl} \\frac{\\partial \\varepsilon_{kl}}{\\partial \\varepsilon_{ij}} + c_{klmn} \\varepsilon_{kl} \\frac{\\partial \\varepsilon_{mn}}{\\partial \\varepsilon_{ij}} \\right)\n$$\nRecognizing that $\\frac{\\partial \\varepsilon_{kl}}{\\partial \\varepsilon_{ij}} = \\delta_{ik} \\delta_{jl}$ and that the strain tensor $\\boldsymbol{\\varepsilon}$ is symmetric ($\\varepsilon_{ij}=\\varepsilon_{ji}$), the stress-strain relation becomes:\n$$\n\\sigma_{ij} = \\frac{1}{2} (c_{ijkl} + c_{jikl}) \\varepsilon_{kl}\n$$\nWithout loss of generality, the stiffness tensor $\\mathsf{c}$ can be considered to possess minor symmetries, $c_{ijkl} = c_{jikl}$ and $c_{ijkl} = c_{ijlk}$, because any part of $\\mathsf{c}$ lacking these symmetries would not contribute to the stress for a symmetric strain tensor. Under this assumption, the constitutive relation simplifies to:\n$$\n\\sigma_{ij} = c_{ijkl} \\varepsilon_{kl}\n$$\nThe existence of the potential $W$ requires that the Hessian of $W$ be symmetric. This means the order of differentiation does not matter:\n$$\n\\frac{\\partial^2 W}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}} = \\frac{\\partial^2 W}{\\partial \\varepsilon_{kl} \\partial \\varepsilon_{ij}}\n$$\nThis implies that the coefficients of the quadratic form must satisfy:\n$$\n\\frac{\\partial \\sigma_{ij}}{\\partial \\varepsilon_{kl}} = \\frac{\\partial \\sigma_{kl}}{\\partial \\varepsilon_{ij}} \\implies c_{ijkl} = c_{klij}\n$$\nThis is the major symmetry of the stiffness tensor. Therefore, the existence of a strain energy potential requires $\\mathsf{c}$ to possess both minor ($c_{ijkl}=c_{jikl}=c_{ijlk}$) and major ($c_{ijkl}=c_{klij}$) symmetries.\n\nNext, we establish the corresponding symmetry conditions on the $6 \\times 6$ Voigt matrix $\\mathbf{C}$. The problem states the constitutive law in Voigt notation as $\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\mathbf{e}$, where the stress vector $\\boldsymbol{\\sigma}$ and engineering strain vector $\\mathbf{e}$ are defined by:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sigma_{23} \\\\ \\sigma_{13} \\\\ \\sigma_{12} \\end{pmatrix}, \\quad\n\\mathbf{e} = \\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ 2\\varepsilon_{23} \\\\ 2\\varepsilon_{13} \\\\ 2\\varepsilon_{12} \\end{pmatrix}\n$$\nWe equate the tensor form $\\sigma_{ij} = c_{ijkl} \\varepsilon_{kl}$ with the Voigt form $\\sigma_I = C_{IJ} e_J$ component by component. For a normal stress component, e.g., $\\sigma_{11}$:\n$$\n\\sigma_1 = \\sigma_{11} = c_{11kl}\\varepsilon_{kl} = c_{1111}\\varepsilon_{11} + c_{1122}\\varepsilon_{22} + c_{1133}\\varepsilon_{33} + 2c_{1123}\\varepsilon_{23} + 2c_{1113}\\varepsilon_{13} + 2c_{1112}\\varepsilon_{12}\n$$\n$$\n\\sigma_1 = C_{1J}e_J = C_{11}e_1 + C_{12}e_2 + C_{13}e_3 + C_{14}e_4 + C_{15}e_5 + C_{16}e_6\n$$\nBy substituting $e_1=\\varepsilon_{11}$, $e_4=2\\varepsilon_{23}$, etc., and comparing coefficients, we find, for example, $C_{11}=c_{1111}$ and $C_{14}=c_{1123}$.\nFor a shear stress component, e.g., $\\sigma_{23}$:\n$$\n\\sigma_4 = \\sigma_{23} = c_{23kl}\\varepsilon_{kl} = c_{2311}\\varepsilon_{11} + c_{2322}\\varepsilon_{22} + c_{2333}\\varepsilon_{33} + 2c_{2323}\\varepsilon_{23} + 2c_{2313}\\varepsilon_{13} + 2c_{2312}\\varepsilon_{12}\n$$\n$$\n\\sigma_4 = C_{4J}e_J = C_{41}e_1 + C_{42}e_2 + C_{43}e_3 + C_{44}e_4 + C_{45}e_5 + C_{46}e_6\n$$\nThis gives, for example, $C_{41}=c_{2311}$ and $C_{44}=c_{2323}$. The general mapping between $c_{ijkl}$ and $C_{IJ}$ does not involve any factors, provided the indices are mapped according to the standard convention ($11 \\to 1$, $22 \\to 2$, $33 \\to 3$, $23 \\to 4$, $13 \\to 5$, $12 \\to 6$).\nThe major symmetry $c_{ijkl}=c_{klij}$ thus translates directly to the Voigt matrix. For example, $c_{1122}=c_{2211}$ implies $C_{12}=C_{21}$, and $c_{1123}=c_{2311}$ implies $C_{14}=C_{41}$. In general, for any pair of indices $I$ and $J$:\n$$\nC_{IJ} = C_{JI}\n$$\nThis means that the Voigt stiffness matrix $\\mathbf{C}$ must be symmetric.\n\nNow, we test the given candidate matrix $\\mathbf{C}$ for this symmetry condition.\n$$\n\\mathbf{C}=\n\\begin{pmatrix}\n160 & 65 & 70 & 4 & -6 & 10\\\\\n60 & 150 & 68 & -5 & 8 & -2\\\\\n72 & 66 & 140 & 7 & -9 & 5\\\\\n6 & -4 & 3 & 50 & 12 & -8\\\\\n-7 & 9 & -10 & 15 & 60 & 6\\\\\n12 & -3 & 6 & -9 & 4 & 55\n\\end{pmatrix}\n$$\nWe check a few components: $C_{12} = 65$, but $C_{21} = 60$. $C_{13} = 70$, but $C_{31} = 72$. The matrix is clearly not symmetric. Therefore, the provided matrix $\\mathbf{C}$ does not correspond to a material with a well-defined strain energy potential under the standard Voigt convention.\n\nThe next step is to construct a physically valid symmetrized stiffness matrix, $\\mathbf{C}^S$. This is achieved by symmetrizing the underlying fourth-order tensor, $\\mathsf{c}^S = \\frac{1}{2}(\\mathsf{c} + \\mathsf{c}^{T})$, where the transpose refers to the major index exchange: $(\\mathsf{c}^{T})_{ijkl} = c_{klij}$. Mapping this symmetrization to the Voigt notation directly yields the symmetric part of the matrix $\\mathbf{C}$:\n$$\n\\mathbf{C}^S = \\frac{1}{2}(\\mathbf{C} + \\mathbf{C}^T)\n$$\nThe calculation proceeds as follows:\n$C^S_{12} = \\frac{1}{2}(C_{12} + C_{21}) = \\frac{1}{2}(65 + 60) = 62.5$.\n$C^S_{13} = \\frac{1}{2}(C_{13} + C_{31}) = \\frac{1}{2}(70 + 72) = 71$.\n...and so on for all off-diagonal elements. The diagonal elements remain unchanged.\n\nFinally, we compute the Frobenius norm of the deviation, $\\Delta \\mathbf{C} = \\mathbf{C}^S - \\mathbf{C}$.\n$$\n\\Delta \\mathbf{C} = \\frac{1}{2}(\\mathbf{C} + \\mathbf{C}^T) - \\mathbf{C} = \\frac{1}{2}(\\mathbf{C}^T - \\mathbf{C})\n$$\nThis matrix, $\\Delta \\mathbf{C}$, is the skew-symmetric part of $\\mathbf{C}$. Its components are $\\Delta C_{IJ} = \\frac{1}{2}(C_{JI} - C_{IJ})$.\n$$\n\\Delta\\mathbf{C} = \\begin{pmatrix}\n0 & -2.5 & 1 & 1 & -0.5 & 1 \\\\\n2.5 & 0 & -1 & 0.5 & 0.5 & -0.5 \\\\\n-1 & 1 & 0 & -2 & -0.5 & 0.5 \\\\\n-1 & -0.5 & 2 & 0 & 1.5 & -0.5 \\\\\n0.5 & -0.5 & 0.5 & -1.5 & 0 & -1 \\\\\n-1 & 0.5 & -0.5 & 0.5 & 1 & 0\n\\end{pmatrix}\n$$\nThe squared Frobenius norm is the sum of the squares of all its elements: $\\|\\Delta \\mathbf{C}\\|_{F}^2 = \\sum_{I,J} (\\Delta C_{IJ})^2$.\n$$\n\\begin{aligned}\n\\|\\Delta \\mathbf{C}\\|_{F}^2 = & \\ 2 \\times [ (-2.5)^2 + 1^2 + 1^2 + (-0.5)^2 + 1^2 \\\\\n& + (-1)^2 + (0.5)^2 + (0.5)^2 + (-0.5)^2 \\\\\n& + (-2)^2 + (-0.5)^2 + (0.5)^2 \\\\\n& + (1.5)^2 + (-0.5)^2 \\\\\n& + (-1)^2 ] \\\\\n= & \\ 2 \\times [ 6.25 + 1 + 1 + 0.25 + 1 \\\\\n& + 1 + 0.25 + 0.25 + 0.25 \\\\\n& + 4 + 0.25 + 0.25 \\\\\n& + 2.25 + 0.25 \\\\\n& + 1 ] \\\\\n= & \\ 2 \\times [19.25] = 38.5\n\\end{aligned}\n$$\nThe Frobenius norm is therefore:\n$$\n\\|\\Delta \\mathbf{C}\\|_{F} = \\sqrt{38.5} \\approx 6.2048368 \\ \\mathrm{GPa}\n$$\nRounding to four significant figures, we obtain the final result.", "answer": "$$\\boxed{6.205}$$", "id": "2866512"}, {"introduction": "Material symmetry drastically simplifies the description of anisotropic behavior by reducing the number of independent elastic constants. This exercise guides you through the rigorous process of deriving these constraints from first principles using the tensor transformation law, $C'_{ijkl} = a_{ip}a_{jq}a_{kr}a_{ls}C_{pqrs}$. By applying the symmetry operations for a tetragonal crystal to a general stiffness tensor, you will gain a deep understanding of how the familiar, simplified forms of stiffness matrices are obtained [@problem_id:2866515].", "problem": "Consider a linearly elastic, homogeneous solid described by generalized Hooke’s law in tensor form, $\\sigma_{ij} = C_{ijkl}\\,\\epsilon_{kl}$, where $C_{ijkl}$ is the fourth-order stiffness tensor with minor symmetries $C_{ijkl} = C_{jikl} = C_{ijlk}$ and the major symmetry $C_{ijkl} = C_{klij}$ implied by the existence of a strain energy density. Let the stiffness be represented in the Voigt $6\\times 6$ form $C_{IJ}$ via the mapping $11 \\to 1$, $22 \\to 2$, $33 \\to 3$, $23 \\to 4$, $13 \\to 5$, $12 \\to 6$. Start from a fully populated symmetric $6\\times 6$ stiffness matrix $C_{IJ}$ (i.e., $C_{IJ} = C_{JI}$ with no further restrictions).\n\nA material belongs to the tetragonal class $4/mmm$ when its elastic response is invariant under the point-group operations that include a rotation by $\\pi/2$ radians about the $x_{3}$-axis and reflections in the planes $x_{1}=0$, $x_{2}=0$, and $x_{3}=0$. For a symmetry operation with orthogonal rotation matrix $a_{ip}$, tensor components transform as $C'_{ijkl} = a_{ip}\\,a_{jq}\\,a_{kr}\\,a_{ls}\\,C_{pqrs}$. Tetragonal symmetry requires $C'_{ijkl} = C_{ijkl}$ for each of the listed operations.\n\nUsing only these invariance requirements and the tensor transformation law above (do not use any pretabulated symmetry-specific stiffness forms), derive the complete set of algebraic constraints on the entries of the Voigt matrix $C_{IJ}$ that are necessary and sufficient for tetragonal $4/mmm$ symmetry. Then, starting from the initial $21$ independent constants of a general anisotropic stiffness (due to the minor and major symmetries), count how many independent constants remain after imposing all tetragonal constraints.\n\nProvide as your final answer only the number of remaining independent constants (a single real-valued number). No rounding is required and no units are needed. State all intermediate constraints explicitly in your derivation, but do not include them in your final answer box.", "solution": "The problem requires the derivation of the constraints on the elastic stiffness tensor $C_{ijkl}$ for a material to possess tetragonal $4/mmm$ symmetry, and to determine the number of independent elastic constants.\n\nWe begin with the generalized Hooke's law, $\\sigma_{ij} = C_{ijkl}\\,\\epsilon_{kl}$. The fourth-order stiffness tensor, $C_{ijkl}$, is assumed to possess minor symmetries ($C_{ijkl} = C_{jikl} = C_{ijlk}$) and major symmetry ($C_{ijkl} = C_{klij}$). These symmetries reduce the number of independent components from $3^4=81$ to $21$. In Voigt notation, this corresponds to a symmetric $6 \\times 6$ matrix $C_{IJ}$ with $21$ independent components:\n$$\nC_{IJ} = \\begin{pmatrix}\nC_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \\\\\nC_{12} & C_{22} & C_{23} & C_{24} & C_{25} & C_{26} \\\\\nC_{13} & C_{23} & C_{33} & C_{34} & C_{35} & C_{36} \\\\\nC_{14} & C_{24} & C_{34} & C_{44} & C_{45} & C_{46} \\\\\nC_{15} & C_{25} & C_{35} & C_{45} & C_{55} & C_{56} \\\\\nC_{16} & C_{26} & C_{36} & C_{46} & C_{56} & C_{66}\n\\end{pmatrix}\n$$\n\nA material has a certain symmetry if its stiffness tensor remains unchanged under the corresponding coordinate transformation. For a transformation described by the orthogonal matrix $\\mathbf{a}$ with components $a_{ip}$, the transformed stiffness tensor $C'_{ijkl}$ is given by $C'_{ijkl} = a_{ip}\\,a_{jq}\\,a_{kr}\\,a_{ls}\\,C_{pqrs}$. The material symmetry requires $C'_{ijkl} = C_{ijkl}$.\n\nThe tetragonal class $4/mmm$ includes several symmetry operations. We will apply them sequentially to find the constraints they impose.\n\n**1. Rotation by $\\theta = \\pi/2$ about the $x_3$-axis ($C_4(z)$)**\nThe coordinate transformation is $x'_1 = x_2$, $x'_2 = -x_1$, $x'_3 = x_3$. The transformation matrix $\\mathbf{a}$ has components $a_{12}=1$, $a_{21}=-1$, $a_{33}=1$, with all other components being zero. We apply the invariance condition $C_{ijkl} = a_{ip}\\,a_{jq}\\,a_{kr}\\,a_{ls}\\,C_{pqrs}$.\n\nLet us evaluate the effect on several components:\n- $C_{1111} = C'_{1111} = a_{12}a_{12}a_{12}a_{12}C_{2222} = C_{2222}$. In Voigt notation, $C_{11} = C_{22}$.\n- $C_{1133} = C'_{1133} = a_{12}a_{12}a_{33}a_{33}C_{2233} = C_{2233}$. In Voigt notation, $C_{13} = C_{23}$.\n- $C_{1313} = C'_{1313} = a_{12}a_{33}a_{12}a_{33}C_{2323} = C_{2323}$. In Voigt notation, $C_{55} = C_{44}$.\n\nNow consider components that must be zero. Let's analyze $C_{1113}$, which corresponds to $C_{15}$:\n$C_{1113} = C'_{1113} = a_{12}a_{12}a_{12}a_{33}C_{2223} = C_{2223}$.\nAlso, consider $C_{2223}$:\n$C_{2223} = C'_{2223} = a_{21}a_{21}a_{21}a_{33}C_{1113} = -C_{1113}$.\nCombining these two results gives $C_{1113} = -C_{1113}$, which implies $C_{1113} = 0$. Consequently, $C_{2223}=0$.\nIn Voigt notation, this means $C_{15} = 0$ and $C_{24} = 0$.\n\nA systematic application of the $C_4(z)$ symmetry yields the following constraints:\n- Equalities: $C_{11}=C_{22}$, $C_{13}=C_{23}$, $C_{44}=C_{55}$, $C_{16}=-C_{26}$.\n- Zeros: $C_{14}=0$, $C_{15}=0$, $C_{24}=0$, $C_{25}=0$, $C_{34}=0$, $C_{35}=0$, $C_{36}=0$, $C_{45}=0$, $C_{46}=0$, $C_{56}=0$.\n\nAfter imposing these constraints, the stiffness matrix becomes:\n$$\nC_{IJ} = \\begin{pmatrix}\nC_{11} & C_{12} & C_{13} & 0 & 0 & C_{16} \\\\\nC_{12} & C_{11} & C_{13} & 0 & 0 & -C_{16} \\\\\nC_{13} & C_{13} & C_{33} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & C_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & C_{44} & 0 \\\\\nC_{16} & -C_{16} & 0 & 0 & 0 & C_{66}\n\\end{pmatrix}\n$$\nThe number of independent constants is reduced to $7$: $C_{11}$, $C_{12}$, $C_{13}$, $C_{33}$, $C_{44}$, $C_{66}$, and $C_{16}$. This is the form for tetragonal classes $4$, $\\bar{4}$, and $4/m$.\n\n**2. Reflection in the $x_1=0$ plane ($\\sigma_v$)**\nThe group $4/mmm$ contains additional symmetries. We consider reflection across the $x_1=0$ plane. The transformation is $x'_1 = -x_1$, $x'_2 = x_2$, $x'_3 = x_3$. The matrix $\\mathbf{a}$ has components $a_{11}=-1$, $a_{22}=1$, $a_{33}=1$.\nThe transformation rule $C'_{ijkl} = a_{ip}a_{jq}a_{kr}a_{ls}C_{pqrs}$ implies that any component $C_{ijkl}$ reverses its sign if the index `1` appears an odd number of times. For invariance, such components must be zero. Let's check the $7$ remaining non-zero constants:\n\n- $C_{11}=C_{1111}$: Four '1's (even), no change.\n- $C_{12}=C_{1122}$: Two '1's (even), no change.\n- $C_{13}=C_{1133}$: Two '1's (even), no change.\n- $C_{33}=C_{3333}$: Zero '1's (even), no change.\n- $C_{44}=C_{2323}$: Zero '1's (even), no change.\n- $C_{66}=C_{1212}$: Two '1's (even), no change.\n- $C_{16}=C_{1112}$: Three '1's (odd), must be zero. $C'_{1112} = a_{11}^3 a_{22}^1 C_{1112} = (-1)^3(1)C_{1112} = -C_{1112}$. Invariance implies $C_{1112}=0$, so $C_{16}=0$.\n\nThe constraint $C_{16}=0$, combined with the previous result $C_{16}=-C_{26}$, immediately gives $C_{26}=0$.\nThis new constraint reduces the number of independent constants from $7$ to $6$. The stiffness matrix for the $4/mmm$ class takes the final form:\n$$\nC_{IJ} = \\begin{pmatrix}\nC_{11} & C_{12} & C_{13} & 0 & 0 & 0 \\\\\nC_{12} & C_{11} & C_{13} & 0 & 0 & 0 \\\\\nC_{13} & C_{13} & C_{33} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & C_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & C_{44} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & C_{66}\n\\end{pmatrix}\n$$\nThe other symmetry operations mentioned in the problem statement (reflections in $x_2=0$ and $x_3=0$) do not impose any further constraints. For instance, invariance under reflection in the $x_3=0$ plane (where $a_{33}=-1$) requires components with an odd number of '3' indices to be zero. All remaining non-zero components in the 6-constant matrix ($C_{1111}, C_{1122}, C_{1133}, C_{3333}, C_{2323}, C_{1212}$) have an even number of '3' indices, so this symmetry is already satisfied. Reflection in $x_2=0$ can be shown to be a composition of the symmetries already applied ($ \\sigma(x_2=0) = \\sigma(x_1=0) \\circ C_2(z)$, where $C_2(z)=(C_4(z))^2$), and thus adds no new constraints either.\n\nThe complete set of algebraic constraints that reduce the $21$ constants of a general anisotropic solid to the form for tetragonal $4/mmm$ symmetry are:\n1. $C_{11} = C_{22}$\n2. $C_{13} = C_{23}$\n3. $C_{44} = C_{55}$\n4. The following $15$ components are zero: $C_{14}, C_{15}, C_{16}, C_{24}, C_{25}, C_{26}, C_{34}, C_{35}, C_{36}, C_{45}, C_{46}, C_{56}$, and due to symmetry $C_{IJ}=C_{JI}$, also $C_{54}, C_{64}, C_{65}$.\n\nThe number of remaining independent constants is found by counting the unique non-zero entries in the upper triangle of the final matrix: $C_{11}$, $C_{12}$, $C_{13}$, $C_{33}$, $C_{44}$, and $C_{66}$.\n\nTherefore, there are $6$ independent elastic constants for a material with tetragonal $4/mmm$ symmetry.", "answer": "$$\\boxed{6}$$", "id": "2866515"}, {"introduction": "In the real world, experimental data is imperfect and rarely aligns perfectly with a theoretical model. This capstone practice bridges the gap between abstract theory and practical application by asking you to classify a material based on noisy stiffness data. You will use least-squares projection to determine which symmetry class—isotropic, cubic, transverse isotropic, or orthotropic—provides the most plausible description, a common and essential task in modern computational and experimental materials characterization [@problem_id:2866513].", "problem": "You are given noisy measurements of the stiffness tensor of linearly elastic solids expressed in Voigt notation as a real symmetric $6 \\times 6$ matrix $C \\in \\mathbb{R}^{6 \\times 6}$ with the standard major and minor symmetries implied by linear elasticity. The fundamental base is Hooke’s law of linear elasticity and the definition of material symmetry classes:\n- Hooke’s law in index notation is $ \\sigma_{ij} = C_{ijkl} \\, \\varepsilon_{kl} $, where $ \\sigma_{ij} $ is the stress tensor, $ \\varepsilon_{kl} $ is the strain tensor, and $ C_{ijkl} $ is the fourth-order stiffness tensor with minor symmetries $ C_{ijkl} = C_{jikl} = C_{ijlk} $ and major symmetry $ C_{ijkl} = C_{klij} $. In Voigt notation, this becomes $ \\sigma_\\alpha = C_{\\alpha \\beta} \\, \\varepsilon_\\beta $ with $ \\alpha, \\beta \\in \\{1,\\dots,6\\} $ and $ C \\in \\mathbb{R}^{6 \\times 6} $ symmetric.\n- A material symmetry class is defined by the set of tensors invariant under the class’s symmetry group; in a fixed orthonormal basis aligned with the symmetry axes, each class corresponds to linear equality constraints among entries of $ C $, reducing the number of independent parameters.\n\nThe task is to project each measured matrix $ C $ onto the linear subspace for each of the following symmetry classes (assumed aligned with the measurement basis) and to select the class that minimizes the Frobenius norm of the residual:\n- Isotropic (class index $0$): parameters $ \\lambda, \\mu $. In Voigt form, $ C_{11} = C_{22} = C_{33} = \\lambda + 2 \\mu $, $ C_{12} = C_{13} = C_{23} = \\lambda $, $ C_{44} = C_{55} = C_{66} = \\mu $, and all other entries are $0$.\n- Cubic (class index $1$): parameters $ a, b, c $. In Voigt form, $ C_{11} = C_{22} = C_{33} = a $, $ C_{12} = C_{13} = C_{23} = b $, $ C_{44} = C_{55} = C_{66} = c $, and all other entries are $0$.\n- Transverse isotropy (TI) with symmetry axis aligned with basis direction $3$ (class index $2$): parameters $ a, c, f, l, n $. In Voigt form, $ C_{11} = C_{22} = a $, $ C_{33} = c $, $ C_{12} = a - 2 n $, $ C_{13} = C_{23} = f $, $ C_{44} = C_{55} = l $, $ C_{66} = n $, and all other entries are $0$.\n- Orthotropic with orthotropy axes aligned with basis directions $1,2,3$ (class index $3$): parameters $ C_{11}, C_{22}, C_{33}, C_{12}, C_{13}, C_{23}, C_{44}, C_{55}, C_{66} $, with all other entries $0$.\n\nFor a given class with parameter vector $ p \\in \\mathbb{R}^m $ and its affine-linear mapping to a $6 \\times 6$ stiffness matrix $ C(p) $, define the least-squares projection of the measured $ C $ onto the class as the minimizer\n$$\np^\\star = \\arg\\min_{p \\in \\mathbb{R}^m} \\, \\| C - C(p) \\|_F^2,\n$$\nwhere $ \\| \\cdot \\|_F $ denotes the Frobenius norm. The residual norm is then $ r = \\| C - C(p^\\star) \\|_F $. Use the convention that all stiffness entries and $ r $ are in gigapascals (GPa). In case two or more classes produce residuals within an absolute tolerance of $10^{-9}$ GPa of the minimum, break ties by choosing the class with the smallest class index (isotropic $0$, cubic $1$, TI $2$, orthotropic $3$).\n\nImplement a program that, for each test matrix below, computes the residual-minimizing projection for each class, evaluates the residual norm in GPa, selects the class index that minimizes the residual, and outputs for all tests a single line in the required format.\n\nRepresent each test matrix explicitly (entries in GPa) as follows. Each matrix is symmetric; only full $6 \\times 6$ form is written for clarity.\n\nTest case $1$ (near isotropic):\n$$\nC^{(1)} =\n\\begin{bmatrix}\n80.8 & 40.3 & 39.6 & 0.2 & -0.1 & 0.6 \\\\\n40.3 & 79.5 & 40.1 & -0.3 & 0.0 & -0.3 \\\\\n39.6 & 40.1 & 80.2 & 0.0 & 0.2 & 0.1 \\\\\n0.2 & -0.3 & 0.0 & 20.5 & 0.1 & 0.0 \\\\\n-0.1 & 0.0 & 0.2 & 0.1 & 19.8 & 0.0 \\\\\n0.6 & -0.3 & 0.1 & 0.0 & 0.0 & 20.4\n\\end{bmatrix}.\n$$\n\nTest case $2$ (near cubic):\n$$\nC^{(2)} =\n\\begin{bmatrix}\n148.8 & 80.9 & 79.3 & 1.0 & -0.6 & 0.3 \\\\\n80.9 & 150.5 & 80.2 & -0.5 & 0.7 & -0.2 \\\\\n79.3 & 80.2 & 149.7 & 0.4 & -0.3 & 0.1 \\\\\n1.0 & -0.5 & 0.4 & 60.6 & 0.2 & -0.1 \\\\\n-0.6 & 0.7 & -0.3 & 0.2 & 59.6 & 0.0 \\\\\n0.3 & -0.2 & 0.1 & -0.1 & 0.0 & 60.1\n\\end{bmatrix}.\n$$\n\nTest case $3$ (near transverse isotropy with axis $3$):\n$$\nC^{(3)} =\n\\begin{bmatrix}\n159.2 & 70.4 & 69.4 & -0.2 & 0.0 & 0.4 \\\\\n70.4 & 161.1 & 70.3 & 0.0 & 0.1 & -0.3 \\\\\n69.4 & 70.3 & 140.5 & 0.0 & 0.0 & -0.2 \\\\\n-0.2 & 0.0 & 0.0 & 50.2 & 0.2 & 0.0 \\\\\n0.0 & 0.1 & 0.0 & 0.2 & 49.9 & 0.0 \\\\\n0.4 & -0.3 & -0.2 & 0.0 & 0.0 & 45.5\n\\end{bmatrix}.\n$$\n\nTest case $4$ (general anisotropy with orthotropic features):\n$$\nC^{(4)} =\n\\begin{bmatrix}\n139.5 & 59.2 & 54.8 & 1.2 & -0.8 & 0.5 \\\\\n59.2 & 120.7 & 49.5 & -0.6 & 0.9 & -0.4 \\\\\n54.8 & 49.5 & 100.9 & 0.7 & -0.5 & 0.2 \\\\\n1.2 & -0.6 & 0.7 & 39.4 & 0.3 & -0.2 \\\\\n-0.8 & 0.9 & -0.5 & 0.3 & 35.6 & 0.1 \\\\\n0.5 & -0.4 & 0.2 & -0.2 & 0.1 & 29.7\n\\end{bmatrix}.\n$$\n\nRequirements:\n- For each test case $k \\in \\{1,2,3,4\\}$, compute the least-squares projection $C_{\\text{iso}}^{(k)}$, $C_{\\text{cub}}^{(k)}$, $C_{\\text{ti}}^{(k)}$, $C_{\\text{ortho}}^{(k)}$ and their residuals $ r_{\\text{iso}}^{(k)}, r_{\\text{cub}}^{(k)}, r_{\\text{ti}}^{(k)}, r_{\\text{ortho}}^{(k)} $ in GPa using the Frobenius norm.\n- Select the class index $ i^{(k)} \\in \\{0,1,2,3\\} $ that minimizes $ r^{(k)} $ with the specified tie-breaking.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain, in order, for each test case $k$, the chosen class index followed by the corresponding residual $ r^{(k)} $ in GPa, rounded to six decimal places, i.e.,\n$$\n[ \\, i^{(1)}, \\, r^{(1)}, \\, i^{(2)}, \\, r^{(2)}, \\, i^{(3)}, \\, r^{(3)}, \\, i^{(4)}, \\, r^{(4)} \\, ].\n$$\n\nNotes and clarifications:\n- Assume the measurement basis is aligned with the symmetry axes for each class as stated, so no rotational optimization is performed.\n- The projection problem for each class is linear least squares in the class parameters and must be solved exactly, not by heuristic averaging.\n- All stiffnesses and residuals are in gigapascals (GPa). Report residuals in GPa, rounded to six decimal places.", "solution": "The problem requires the classification of a given measured stiffness matrix, $C^{\\text{meas}}$, into one of four symmetry classes: isotropic, cubic, transverse isotropic, or orthotropic. The classification is to be performed by finding the symmetry class that allows for the closest approximation of $C^{\\text{meas}}$ in the sense of the Frobenius norm. This is a projection problem, where for each symmetry class, we project the $6 \\times 6$ symmetric matrix $C^{\\text{meas}}$ onto the linear subspace of matrices corresponding to that class.\n\nThe objective is to find the projected matrix $C^{\\text{proj}}$ within a given symmetry subspace that minimizes the squared Frobenius norm of the residual, $J = \\| C^{\\text{meas}} - C^{\\text{proj}} \\|_F^2$. The mapping from the independent elastic parameters $p$ of a given symmetry class to the corresponding stiffness matrix $C(p)$ is linear. Therefore, for each class, we must solve a linear least-squares problem.\n\nLet $p = (p_1, \\dots, p_m)$ be the vector of $m$ independent parameters for a given symmetry class. The stiffness matrix for this class, $C(p)$, has entries that are linear functions of these parameters. The squared Frobenius norm of the residual is given by\n$$\nJ(p) = \\| C^{\\text{meas}} - C(p) \\|_F^2 = \\sum_{\\alpha=1}^6 \\sum_{\\beta=1}^6 (C_{\\alpha\\beta}^{\\text{meas}} - C_{\\alpha\\beta}(p))^2.\n$$\nTo find the optimal parameters $p^\\star$ that minimize $J(p)$, we set the partial derivatives with respect to each parameter $p_k$ to zero, which yields the system of normal equations:\n$$\n\\frac{\\partial J}{\\partial p_k} = -2 \\sum_{\\alpha=1}^6 \\sum_{\\beta=1}^6 (C_{\\alpha\\beta}^{\\text{meas}} - C_{\\alpha\\beta}(p)) \\frac{\\partial C_{\\alpha\\beta}(p)}{\\partial p_k} = 0, \\quad \\text{for } k=1, \\dots, m.\n$$\nThis simplifies to a system of $m$ linear equations in $m$ variables:\n$$\n\\sum_{\\alpha,\\beta} C_{\\alpha\\beta}(p) \\frac{\\partial C_{\\alpha\\beta}(p)}{\\partial p_k} = \\sum_{\\alpha,\\beta} C_{\\alpha\\beta}^{\\text{meas}} \\frac{\\partial C_{\\alpha\\beta}(p)}{\\partial p_k}.\n$$\nWe now apply this general procedure to each of the four specified symmetry classes. Throughout the derivation, we utilize the symmetry of the stiffness matrix, $C_{\\alpha\\beta} = C_{\\beta\\alpha}$.\n\n**1. Isotropic Projection (Class Index $0$)**\nAn isotropic material is described by two parameters, $p = (\\lambda, \\mu)$. The non-zero entries of the stiffness matrix $C_{\\text{iso}}(\\lambda, \\mu)$ are:\n$C_{11} = C_{22} = C_{33} = \\lambda + 2\\mu$\n$C_{12} = C_{23} = C_{13} = \\lambda$\n$C_{44} = C_{55} = C_{66} = \\mu$\nThe derivatives of the matrix components with respect to the parameters are constants. Applying the normal equations leads to a $2 \\times 2$ linear system for $\\lambda$ and $\\mu$.\nFor $\\partial/\\partial\\lambda$:\n$\\sum_{\\alpha,\\beta} C_{\\alpha\\beta}(\\lambda,\\mu) \\frac{\\partial C_{\\alpha\\beta}}{\\partial\\lambda} = \\sum_{i=1}^3 (\\lambda+2\\mu) \\cdot 1 + 2\\sum_{i<j\\le 3} \\lambda \\cdot 1 = 3(\\lambda+2\\mu) + 6\\lambda = 9\\lambda+6\\mu$.\nThe right hand side is $\\sum_{i=1}^3 C_{ii}^{\\text{meas}} \\cdot 1 + 2\\sum_{i<j\\le 3} C_{ij}^{\\text{meas}} \\cdot 1$.\nFor $\\partial/\\partial\\mu$:\n$\\sum_{\\alpha,\\beta} C_{\\alpha\\beta}(\\lambda,\\mu) \\frac{\\partial C_{\\alpha\\beta}}{\\partial\\mu} = \\sum_{i=1}^3 (\\lambda+2\\mu) \\cdot 2 + \\sum_{i=4}^6 \\mu \\cdot 1 = 6(\\lambda+2\\mu)+3\\mu = 6\\lambda+15\\mu$.\nThe right hand side is $\\sum_{i=1}^3 C_{ii}^{\\text{meas}} \\cdot 2 + \\sum_{i=4}^6 C_{ii}^{\\text{meas}} \\cdot 1$.\nThis yields the system:\n$$\n\\begin{pmatrix} 9 & 6 \\\\ 6 & 15 \\end{pmatrix}\n\\begin{pmatrix} \\lambda \\\\ \\mu \\end{pmatrix}\n=\n\\begin{pmatrix}\n(C_{11}^{\\text{meas}} + C_{22}^{\\text{meas}} + C_{33}^{\\text{meas}}) + 2(C_{12}^{\\text{meas}} + C_{13}^{\\text{meas}} + C_{23}^{\\text{meas}}) \\\\\n2(C_{11}^{\\text{meas}} + C_{22}^{\\text{meas}} + C_{33}^{\\text{meas}}) + (C_{44}^{\\text{meas}} + C_{55}^{\\text{meas}} + C_{66}^{\\text{meas}})\n\\end{pmatrix}\n$$\nSolving this system gives the optimal parameters $\\lambda^\\star$ and $\\mu^\\star$.\n\n**2. Cubic Projection (Class Index $1$)**\nA cubic material is described by three parameters, $p = (a, b, c)$. The non-zero entries are:\n$C_{11} = C_{22} = C_{33} = a$\n$C_{12} = C_{23} = C_{13} = b$\n$C_{44} = C_{55} = C_{66} = c$\nIn this case, the parameters are independent of each other in the cost function. The minimization problem decouples.\nFor $a$, we minimize $\\sum_{i=1}^3 (C_{ii}^{\\text{meas}} - a)^2$. The solution is the average:\n$a^\\star = \\frac{1}{3}(C_{11}^{\\text{meas}} + C_{22}^{\\text{meas}} + C_{33}^{\\text{meas}})$\nFor $b$, we minimize $2\\sum_{1\\le i<j\\le 3} (C_{ij}^{\\text{meas}} - b)^2$. The solution is the average:\n$b^\\star = \\frac{1}{3}(C_{12}^{\\text{meas}} + C_{13}^{\\text{meas}} + C_{23}^{\\text{meas}})$\nFor $c$, we minimize $\\sum_{i=4}^6 (C_{ii}^{\\text{meas}} - c)^2$. The solution is the average:\n$c^\\star = \\frac{1}{3}(C_{44}^{\\text{meas}} + C_{55}^{\\text{meas}} + C_{66}^{\\text{meas}})$\n\n**3. Transverse Isotropy Projection (Class Index $2$)**\nFor transverse isotropy with symmetry axis along direction $3$, there are five parameters, $p = (a, c, f, l, n)$.\n$C_{11} = C_{22} = a$\n$C_{33} = c$\n$C_{12} = a-2n$\n$C_{13} = C_{23} = f$\n$C_{44} = C_{55} = l$\n$C_{66} = n$\nThe parameters $c$, $f$, and $l$ are decoupled and can be found by averaging:\n$c^\\star = C_{33}^{\\text{meas}}$\n$f^\\star = \\frac{1}{2}(C_{13}^{\\text{meas}} + C_{23}^{\\text{meas}})$\n$l^\\star = \\frac{1}{2}(C_{44}^{\\text{meas}} + C_{55}^{\\text{meas}})$\nThe parameters $a$ and $n$ are coupled. We minimize $J(a,n) = (C_{11}^{\\text{meas}}-a)^2 + (C_{22}^{\\text{meas}}-a)^2 + 2(C_{12}^{\\text{meas}}-(a-2n))^2 + (C_{66}^{\\text{meas}}-n)^2$. The normal equations yield a $2 \\times 2$ system for $a$ and $n$:\n$$\n\\begin{pmatrix} 4 & -4 \\\\ -4 & 9 \\end{pmatrix}\n\\begin{pmatrix} a \\\\ n \\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{11}^{\\text{meas}} + C_{22}^{\\text{meas}} + 2C_{12}^{\\text{meas}} \\\\\n-4C_{12}^{\\text{meas}} + C_{66}^{\\text{meas}}\n\\end{pmatrix}\n$$\nSolving this system gives $a^\\star$ and $n^\\star$.\n\n**4. Orthotropic Projection (Class Index $3$)**\nAn orthotropic material has nine independent parameters, which are the non-zero entries of the matrix: $C_{11}, C_{22}, C_{33}, C_{12}, C_{13}, C_{23}, C_{44}, C_{55}, C_{66}$. The projection involves minimizing the residual, which for this class structure means setting the other components to zero.\nThe terms in the cost function involving these nine parameters are of the form $(C_{ii}^{\\text{meas}} - C_{ii}^{\\text{proj}})^2$ for the diagonal elements and $2(C_{ij}^{\\text{meas}} - C_{ij}^{\\text{proj}})^2$ for the off-diagonal elements in the upper-left $3 \\times 3$ block. The minimum is achieved by simply setting the projected components equal to the measured components, assuming a symmetric input matrix where $C_{ij}^{\\text{meas}} = C_{ji}^{\\text{meas}}$.\n$C_{\\alpha\\beta}^{\\text{proj}} = C_{\\alpha\\beta}^{\\text{meas}}$ for $\\alpha, \\beta \\in \\{1,2,3\\}$ and for $\\alpha=\\beta \\in \\{4,5,6\\}$.\n$C_{\\alpha\\beta}^{\\text{proj}} = 0$ for all other entries.\nThe residual is then the Frobenius norm of the matrix containing only the components of $C^{\\text{meas}}$ that are required to be zero for an orthotropic material.\n\n**Procedure Summary**\nFor each given test matrix $C^{(k)}$:\n1. For each of the four symmetry classes (isotropic, cubic, TI, orthotropic):\n   a. Solve for the optimal parameters $p^\\star$ using the methods derived above.\n   b. Construct the projected matrix $C^{\\text{proj}}(p^\\star)$.\n   c. Calculate the residual matrix $R = C^{(k)} - C^{\\text{proj}}(p^\\star)$.\n   d. Compute the residual norm $r = \\|R\\|_F = \\sqrt{\\sum_{\\alpha, \\beta} R_{\\alpha\\beta}^2}$.\n2. Collect the four residual norms: $r_{\\text{iso}}^{(k)}, r_{\\text{cub}}^{(k)}, r_{\\text{ti}}^{(k)}, r_{\\text{ortho}}^{(k)}$.\n3. Find the minimum residual, $r_{\\min}^{(k)} = \\min(r_{\\text{iso}}^{(k)}, r_{\\text{cub}}^{(k)}, r_{\\text{ti}}^{(k)}, r_{\\text{ortho}}^{(k)})$.\n4. Identify the set of candidate class indices $S = \\{ j \\mid |r_j^{(k)} - r_{\\min}^{(k)}| \\le 10^{-9} \\}$.\n5. Select the final class index as $i^{(k)} = \\min(S)$, and the corresponding residual is $r^{(k)} = r_{i^{(k)}}^{(k)}$.\n\nThis procedure is implemented for each of the four test matrices provided.", "answer": "```\n[0,1.216552,1,2.580698,2,2.019901,3,2.469818]\n```", "id": "2866513"}]}