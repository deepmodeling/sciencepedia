{"hands_on_practices": [{"introduction": "To truly grasp the implications of a nonlocal theory like peridynamics, we must first understand how it diverges from classical mechanics in its most fundamental physical predictions. One of the most revealing aspects is wave propagation. This exercise invites you to explore the dynamics of a peridynamic bar by deriving its dispersion relation, which connects the temporal frequency $\\omega$ of a wave to its spatial wavenumber $k$. By completing this analysis [@problem_id:2905383], you will discover how the inherent length scale $\\delta$ in peridynamics gives rise to wave dispersion, a key phenomenon where waves of different lengths travel at different speeds, a stark contrast to the behavior in a classical elastic continuum.", "problem": "Consider an infinitely long, homogeneous, one-dimensional elastic bar modeled by the bond-based linear peridynamics (PD). Let the mass density be $\\,\\rho\\,$ and the horizon be $\\,\\delta>0\\,$. The micromodulus function is prescribed as\n$$\nc(|\\xi|)=\n\\begin{cases}\nc_{0}, & |\\xi|\\le \\delta,\\\\\n0, & |\\xi|>\\delta,\n\\end{cases}\n$$\nwith $\\,c_{0}>0\\,$ constant. The peridynamic internal force density at point $\\,x\\,$ and time $\\,t\\,$ is defined by\n$$\nf_{\\text{int}}(x,t)=\\int_{-\\delta}^{\\delta} c(|\\xi|)\\,\\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi,\n$$\nand the equation of motion (with zero body force) is\n$$\n\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t)=f_{\\text{int}}(x,t).\n$$\nAssume a spatially harmonic displacement field\n$$\nu(x,t)=u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t),\n$$\nwith amplitude $\\,u_{0}\\in\\mathbb{R}\\,$, wavenumber $\\,k>0\\,$, and angular frequency $\\,\\omega>0\\,$. Here $\\,k\\,$ is to be expressed in radians per meter and $\\,\\omega\\,$ in radians per second.\n\nUsing only the definitions and laws stated above, first compute the peridynamic internal force density $\\,f_{\\text{int}}(x,t)\\,$ at an arbitrary $\\,x\\,$, and then deduce the dispersion relation linking $\\,\\omega\\,$ and $\\,k\\,$ by enforcing the equation of motion. Provide your final answer as a single closed-form analytical expression for $\\,\\omega^{2}(k)\\,$ in terms of $\\,\\rho\\,$, $\\,c_{0}\\,$, $\\,\\delta\\,$, and $\\,k\\,$. Do not include units in your final boxed answer. No rounding is required.", "solution": "The problem statement has been validated and found to be self-contained, scientifically grounded, and well-posed. It presents a standard exercise in the mechanics of nonlocal media. We shall now proceed with the derivation.\n\nThe objective is to find the dispersion relation $\\omega^{2}(k)$ by substituting the assumed harmonic displacement field into the peridynamic equation of motion.\n\nThe equation of motion is given as:\n$$\n\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t)=f_{\\text{int}}(x,t)\n$$\nwhere $\\rho$ is the mass density.\n\nThe assumed displacement field is:\n$$\nu(x,t)=u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t)\n$$\nwith amplitude $u_{0}\\in\\mathbb{R}$, wavenumber $k>0$, and angular frequency $\\omega>0$.\n\nFirst, we compute the left-hand side (LHS) of the equation of motion. This requires the second partial derivative of $u(x,t)$ with respect to time $t$:\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = u_{0}\\,\\sin(k x)\\,\\frac{\\partial}{\\partial t}\\exp(-\\mathrm{i}\\,\\omega t) = u_{0}\\,\\sin(k x)\\,(-\\mathrm{i}\\,\\omega)\\,\\exp(-\\mathrm{i}\\,\\omega t) = -\\mathrm{i}\\,\\omega\\,u(x,t)\n$$\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t) = \\frac{\\partial}{\\partial t}(-\\mathrm{i}\\,\\omega\\,u(x,t)) = (-\\mathrm{i}\\,\\omega)^{2}\\,u(x,t) = -\\omega^{2}\\,u(x,t)\n$$\nThus, the LHS of the equation of motion becomes:\n$$\n\\text{LHS} = \\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t) = -\\rho\\,\\omega^{2}\\,u(x,t)\n$$\n\nNext, we compute the right-hand side (RHS), which is the peridynamic internal force density $f_{\\text{int}}(x,t)$:\n$$\nf_{\\text{int}}(x,t)=\\int_{-\\delta}^{\\delta} c(|\\xi|)\\,\\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi\n$$\nGiven the micromodulus function $c(|\\xi|) = c_{0}$ for $|\\xi| \\le \\delta$, the expression simplifies to:\n$$\nf_{\\text{int}}(x,t)=c_{0}\\int_{-\\delta}^{\\delta} \\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi\n$$\nWe substitute the harmonic displacement field into the integrand:\n$$\nu(x+\\xi,t)-u(x,t) = u_{0}\\,\\sin(k(x+\\xi))\\,\\exp(-\\mathrm{i}\\,\\omega t) - u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n$$\n= u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t)\\,\\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\n$$\nNow, we substitute this back into the integral for $f_{\\text{int}}(x,t)$:\n$$\nf_{\\text{int}}(x,t) = c_{0}\\,u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t) \\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi\n$$\nTo evaluate the integral, we can separate it into two parts:\n$$\n\\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi = \\int_{-\\delta}^{\\delta} \\sin(k x+k \\xi)\\,d\\xi - \\int_{-\\delta}^{\\delta} \\sin(k x)\\,d\\xi\n$$\nThe first integral is evaluated as:\n$$\n\\int_{-\\delta}^{\\delta} \\sin(k x+k \\xi)\\,d\\xi = \\left[-\\frac{\\cos(k x+k \\xi)}{k}\\right]_{-\\delta}^{\\delta} = -\\frac{1}{k}\\big(\\cos(k x+k \\delta) - \\cos(k x-k \\delta)\\big)\n$$\nUsing the trigonometric identity $\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$, where $A=kx+k\\delta$ and $B=kx-k\\delta$, we get:\n$$\n\\cos(k x+k \\delta) - \\cos(k x-k \\delta) = -2\\sin(k x)\\sin(k \\delta)\n$$\nSo, the first integral is:\n$$\n-\\frac{1}{k}\\big(-2\\sin(k x)\\sin(k \\delta)\\big) = \\frac{2}{k}\\sin(k x)\\sin(k \\delta)\n$$\nThe second integral is:\n$$\n\\int_{-\\delta}^{\\delta} \\sin(k x)\\,d\\xi = \\sin(k x) \\int_{-\\delta}^{\\delta} 1\\,d\\xi = \\sin(k x) [\\xi]_{-\\delta}^{\\delta} = 2\\delta\\sin(k x)\n$$\nCombining the results for the two integrals:\n$$\n\\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi = \\frac{2}{k}\\sin(k x)\\sin(k \\delta) - 2\\delta\\sin(k x) = 2\\sin(k x)\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\nSubstituting this back into the expression for $f_{\\text{int}}(x,t)$:\n$$\nf_{\\text{int}}(x,t) = c_{0}\\,u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t) \\left[ 2\\sin(k x)\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right) \\right]\n$$\nRecognizing that $u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t) = u(x,t)$, we can write the RHS as:\n$$\n\\text{RHS} = f_{\\text{int}}(x,t) = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)u(x,t)\n$$\nNow we enforce the equation of motion by equating the LHS and RHS:\n$$\n-\\rho\\,\\omega^{2}\\,u(x,t) = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)u(x,t)\n$$\nSince $u(x,t)$ is not identically zero, we can divide both sides by it to obtain the dispersion relation:\n$$\n-\\rho\\,\\omega^{2} = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\nFinally, solving for $\\omega^{2}$ as a function of $k$:\n$$\n\\omega^{2}(k) = -\\frac{2c_{0}}{\\rho}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\n$$\n\\omega^{2}(k) = \\frac{2c_{0}}{\\rho}\\left(\\delta - \\frac{\\sin(k \\delta)}{k}\\right)\n$$\nThis is the required closed-form analytical expression for the dispersion relation. For any physically meaningful wave with $k>0$, the term $\\delta - \\frac{\\sin(k \\delta)}{k}$ is positive, ensuring that $\\omega^{2} > 0$ and $\\omega$ is real, as required.", "answer": "$$\n\\boxed{\\frac{2c_{0}}{\\rho}\\left(\\delta - \\frac{\\sin(k\\delta)}{k}\\right)}\n$$", "id": "2905383"}, {"introduction": "Having explored the physical signature of nonlocality, we now turn to a crucial practical question: how do we translate the continuous peridynamic model into a system that can be solved on a computer? This practice bridges the gap between abstract theory and computational implementation. You will discretize the one-dimensional peridynamic equation of motion onto a uniform grid and derive the entries of the corresponding stiffness matrix $\\mathbf{K}$ [@problem_id:2905429]. This process is a foundational skill in computational mechanics and will deepen your understanding of how nonlocal interactions are captured in a numerical framework.", "problem": "Consider a one-dimensional nonlocal, bond-based, linear microelastic peridynamic model for a bar discretized on a uniform grid. Let the material occupy a periodic domain so that aliasing at the horizon boundary does not occur, and let the nodes be located at positions $x_i = i\\,h$ for integers $i$, where $h$ is the uniform grid spacing. The peridynamic horizon is $\\delta = m\\,h$ with integer $m \\ge 1$. The micromodulus function is taken to be\n$$\nc(|\\xi|) = \\begin{cases}\nc_0\\left(1 - \\dfrac{|\\xi|}{\\delta}\\right), & 0 \\le |\\xi| \\le \\delta, \\\\\n0, & |\\xi| > \\delta,\n\\end{cases}\n$$\nwhere $c_0 > 0$ is a constant. Assume small deformations and a quasi-static setting with body force density $b(x)$ so that balance of linear momentum holds.\n\nStarting from the fundamental microelastic peridynamic internal force expression and the balance of linear momentum, derive the discrete linear system for the nodal displacement vector $\\mathbf{u}$ obtained by collocation and the midpoint rule quadrature of the peridynamic integral at each node. Define the discrete stiffness matrix $\\mathbf{K}$ by writing the assembled equations in the form $\\mathbf{K}\\,\\mathbf{u} = \\mathbf{f}_b$, where $\\mathbf{f}_b$ is the discrete body force vector. Provide explicit closed-form expressions for the entries $K_{ij}$, in terms of $i$, $j$, $h$, $m$, and $c_0$, that result from this discretization. Then, based on first principles and the construction of $\\mathbf{K}$, discuss whether $\\mathbf{K}$ is symmetric, and characterize its sparsity pattern.\n\nYour final reported answer should be a single closed-form analytic expression for $K_{ij}$ as a function of $i$ and $j$ (it may be piecewise in $|i-j|$). Do not include units in the final expression. No numerical rounding is required.", "solution": "The most fundamental approach to derive the stiffness matrix for a conservative mechanical system is from the potential energy. The state of equilibrium corresponds to a stationary point of the total potential energy of the system.\n\nThe total potential energy $\\Pi$ is the sum of the internal strain energy $\\mathcal{E}$ and the potential of the external forces, which for a body force density $b(x)$ is $W_{ext} = - \\int b(x) u(x) dx$. Thus, $\\Pi = \\mathcal{E} - W_{ext}$.\n\nFor a bond-based peridynamic material, the strain energy $\\mathcal{E}$ is the sum of the energies stored in all bonds. The total strain energy is obtained by integrating the strain energy density $W(x) = \\frac{1}{2}\\int_{\\mathcal{H}_x} w(x',x) dx'$ over the domain. To avoid double-counting bonds, this is expressed as:\n$$ \\mathcal{E} = \\frac{1}{4} \\int \\int_{\\mathcal{H}_x} c(|x'-x|) \\left( \\frac{u(x')-u(x)}{x'-x} \\right)^2 dx' dx $$\n\nWe discretize this expression for the specified grid. The nodes are at $x_i = i h$. The integrals over the domain and horizon become sums over nodes, with each node having a volume (length) $h$. Let $u_i = u(x_i)$.\nThe discrete strain energy is:\n$$ \\mathcal{E}_{discrete} = \\frac{1}{4} \\sum_i h \\sum_{j \\neq i, |j-i|\\le m} h \\, c(|x_j-x_i|) \\frac{(u_j-u_i)^2}{(x_j-x_i)^2} $$\nSubstituting $x_j - x_i = (j-i)h$ and simplifying, the factors of $h^2$ cancel:\n$$ \\mathcal{E}_{discrete} = \\frac{1}{4} \\sum_{i} \\sum_{j \\neq i, |j-i|\\le m} \\frac{c(|(j-i)h|)}{(j-i)^2} (u_j-u_i)^2 $$\nThe discrete form of the potential of the external forces is $W_{ext, discrete} = \\sum_i b(x_i) u_i h$. The equilibrium equations are found by setting the derivative of the total potential energy $\\Pi_{discrete} = \\mathcal{E}_{discrete} - W_{ext, discrete}$ with respect to each nodal displacement $u_k$ to zero:\n$$ \\frac{\\partial \\Pi_{discrete}}{\\partial u_k} = \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} - b_k h = 0 $$\nThe discrete system is $\\mathbf{K}\\mathbf{u} = \\mathbf{f}_b$, where the stiffness matrix entries are given by the Hessian of the strain energy, $K_{kj} = \\frac{\\partial^2 \\mathcal{E}_{discrete}}{\\partial u_k \\partial u_j}$, and the body force vector has entries $f_{b,k} = b_k h$.\n\nWe compute the entries of $\\mathbf{K}$ by taking the second partial derivatives of $\\mathcal{E}_{discrete}$.\nFor the off-diagonal entries ($j \\neq k$):\n$$ K_{kj} = \\frac{\\partial^2 \\mathcal{E}_{discrete}}{\\partial u_k \\partial u_j} = - \\frac{c(|(k-j)h|)}{(k-j)^2} $$\nThis applies for $1 \\le |k-j| \\le m$. If $|k-j| > m$, the interaction is zero, so $K_{kj}=0$.\n\nFor the diagonal entries ($j = k$):\n$$ K_{kk} = \\frac{\\partial^2 \\mathcal{E}_{discrete}}{\\partial u_k^2} = \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} $$\n\nNow, we substitute the given micromodulus function:\n$$ c(|\\xi|) = c_0 \\left(1 - \\frac{|\\xi|}{\\delta}\\right) \\quad \\text{for } |\\xi| \\le \\delta $$\nWith $\\xi = (j-i)h$ and $\\delta=mh$, we have, for $|j-i| \\le m$:\n$$ c(|(j-i)h|) = c_0 \\left(1 - \\frac{|j-i|h}{mh}\\right) = c_0 \\left(1 - \\frac{|j-i|}{m}\\right) $$\nThe stiffness matrix entries become:\nFor $i \\neq j$ and $|i-j| \\le m$:\n$$ K_{ij} = - \\frac{c_0 \\left(1 - \\frac{|i-j|}{m}\\right)}{(i-j)^2} $$\nFor $i=j$:\n$$ K_{ii} = \\sum_{p \\neq i, |p-i| \\le m} \\frac{c_0 \\left(1 - \\frac{|p-i|}{m}\\right)}{(p-i)^2} $$\nThe summation index $p$ ranges from $i-m$ to $i+m$, excluding $i$. Let $k=p-i$.\n$$ K_{ii} = \\sum_{k=-m, k \\neq 0}^{m} \\frac{c_0 \\left(1 - \\frac{|k|}{m}\\right)}{k^2} $$\nSince the summand is an even function of $k$, we can write this as:\n$$ K_{ii} = 2c_0 \\sum_{k=1}^{m} \\frac{1 - \\frac{k}{m}}{k^2} = 2c_0 \\sum_{k=1}^{m} \\left( \\frac{1}{k^2} - \\frac{1}{mk} \\right) $$\nThis is the closed-form expression for the diagonal entries.\n\nThe properties of the matrix $\\mathbf{K}$ are now evident:\n1.  **Symmetry**: The off-diagonal terms $K_{ij}$ depend on $(i-j)^2$ and $|i-j|$, which are symmetric with respect to swapping $i$ and $j$. Thus, $K_{ij}=K_{ji}$. The matrix is symmetric. This is guaranteed by its definition as the Hessian of a scalar potential energy function.\n2.  **Sparsity**: The entries $K_{ij}$ are non-zero only if the distance between nodes $i$ and $j$ is within the peridynamic horizon, i.e., $|i-j| \\le m$. This results in a banded matrix structure with a bandwidth of $2m+1$. For a large number of nodes $N \\gg m$, the matrix is sparse.\n3.  **Singularity**: The sum of any row is $\\sum_j K_{ij} = K_{ii} + \\sum_{j \\neq i, |j-i|\\le m} K_{ij}$.\n    $$ \\sum_j K_{ij} = \\left(\\sum_{p \\neq i, |p-i|\\le m} \\frac{c_0 \\left(1 - \\frac{|p-i|}{m}\\right)}{(p-i)^2}\\right) + \\left(\\sum_{j \\neq i, |j-i|\\le m} - \\frac{c_0 \\left(1 - \\frac{|j-i|}{m}\\right)}{(j-i)^2}\\right) = 0 $$\n    The zero row-sum property indicates that the matrix is singular. The vector of ones, $\\mathbf{1}$, corresponding to a rigid-body translation, is in the null space of $\\mathbf{K}$ ($\\mathbf{K}\\mathbf{1} = \\mathbf{0}$). This is physically correct as rigid motion induces no strain and therefore no internal forces.", "answer": "$$\n\\boxed{\nK_{ij} = \n\\begin{cases}\n2c_0 \\sum_{p=1}^{m} \\left( \\frac{1}{p^2} - \\frac{1}{mp} \\right) & \\text{if } i=j \\\\\n- \\frac{c_0}{(i-j)^2} \\left(1 - \\frac{|i-j|}{m}\\right) & \\text{if } 1 \\le |i-j| \\le m \\\\\n0 & \\text{if } |i-j| > m\n\\end{cases}\n}\n$$", "id": "2905429"}, {"introduction": "We culminate our hands-on study by tackling one of the primary motivations for developing nonlocal theories: the prediction of material failure. Classical elasticity theory often predicts unphysical infinite stresses at geometric singularities like notch roots or crack tips, making it difficult to establish a clear failure criterion. Peridynamics naturally regularizes these singularities by averaging interactions over a finite horizon. In this final practice [@problem_id:2905433], you will develop and implement a computational procedure to predict fracture initiation in a notched bar, demonstrating how the nonlocal bond-stretch concept provides a robust criterion for material failure where classical approaches fall short.", "problem": "Consider a one-dimensional tensile bar of length $L$ with a symmetric notch centered at $x = L/2$. The cross-sectional area is piecewise constant, defined by\n- $A(x) = A_{\\min}$ for $|x - L/2| \\le a$,\n- $A(x) = A_0$ for $|x - L/2| &gt; a$,\nwith parameters satisfying $0 &lt; A_{\\min} \\le A_0$, $0 &lt; a \\ll L/2$, and $0 &lt; \\delta \\le L/2$, where $\\delta$ is the nonlocal horizon. The bar is subjected to an axial tensile load $P$ applied at its ends, under small strain conditions and quasi-static equilibrium. The material is linearly elastic with Young’s modulus $E$. Define the nonlocal bond-stretch measure at a point $x$ as the normalized weighted average of bond-wise axial stretch over the horizon using a triangular influence function,\n$$w(r) = \\begin{cases}\n1 - \\dfrac{r}{\\delta}, & 0 \\le r \\le \\delta, \\\\\n0, & r &gt; \\delta,\n\\end{cases}$$\nand its symmetric extension for negative $r$. For monotone tensile deformation with displacement $u(x)$ and local axial strain $\\varepsilon(x) = \\dfrac{du}{dx}$, approximate the nonlocal bond-stretch at $x$ by\n$$s(x) = \\dfrac{1}{M(\\delta)} \\int_{x-\\delta}^{x+\\delta} w(|y-x|)\\,\\dfrac{|u(y)-u(x)|}{|y-x|}\\,dy \\approx \\dfrac{1}{M(\\delta)} \\int_{x-\\delta}^{x+\\delta} w(|y-x|)\\,\\varepsilon(y)\\,dy,$$\nwhere the normalization is $M(\\delta) = \\int_{-\\delta}^{\\delta} w(|r|)\\,dr$. Assume quasi-static force equilibrium implies a constant axial force $P$ along the bar, so that the local strain satisfies $\\varepsilon(x) = \\dfrac{P}{E\\,A(x)}$. Let $s_c$ denote the critical stretch. Fracture initiation at the notch root is predicted to occur when $s(x_0) = s_c$ at $x_0 = L/2$.\n\nTask: Starting from the above fundamental definitions and assumptions, derive an explicit computational procedure to predict the initiation load $P_c$ as a function of $E$, $A_0$, $A_{\\min}$, $a$, and $\\delta$, by enforcing $s(L/2) = s_c$. Implement this procedure in a program that evaluates $P_c$ for the following test suite of parameter sets (each tuple ordered as $(E, A_0, A_{\\min}, a, \\delta, s_c, L)$):\n- Case 1 (general case with $\\delta &gt; a$): $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-2}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$.\n- Case 2 (boundary where $\\delta \\lt a$): $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 3.0 \\times 10^{-3}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$.\n- Case 3 (large horizon): $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-1}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$.\n- Case 4 (no notch, $A_{\\min} = A_0$): $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 2.0 \\times 10^{-2}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$.\n- Case 5 (very small horizon): $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-6}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$.\n\nYour program must:\n- Use the above nonlocal definition with the triangular influence function to obtain a closed-form or numerically accurate evaluation of $s(L/2)$, and solve for $P_c$ from $s(L/2) = s_c$.\n- For each case, output the predicted initiation load $P_c$ in $\\mathrm{N}$, rounded to the nearest integer.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above (for example, the format is [$p_1,p_2,p_3,p_4,p_5$]).\n\nAll inputs are in International System of Units (SI). Express the final loads in $\\mathrm{N}$, rounded to the nearest integer, and ensure $0 &lt; \\delta \\le L/2$ in all computations. Your algorithm should be general and not rely on any unphysical assumptions.", "solution": "The problem statement poses a well-defined question in the field of nonlocal continuum mechanics, specifically concerning fracture initiation in a one-dimensional bar with a geometric discontinuity. The model is based on a peridynamic-like bond-stretch measure. The problem is scientifically grounded, self-contained, and formalizable. It is therefore deemed valid. We proceed with the derivation of the computational procedure for the critical load $P_c$.\n\nThe objective is to determine the critical tensile load $P_c$ that initiates fracture at the center of the notch, $x_0 = L/2$. The fracture criterion is given by the condition that the nonlocal bond-stretch $s(x)$ at this point reaches a critical value $s_c$.\n$$s(L/2) = s_c$$\nFor convenience, we shift the spatial coordinate such that the center of the notch is at the origin, $x' = x - L/2 = 0$. The analysis is performed at $x'=0$. The nonlocal bond-stretch at this point is defined as:\n$$s(0) = \\dfrac{1}{M(\\delta)} \\int_{-\\delta}^{\\delta} w(|y|)\\,\\varepsilon(y)\\,dy$$\nwhere $\\delta$ is the nonlocal horizon, $w(|y|)$ is the influence function, and $\\varepsilon(y)$ is the local axial strain.\n\nFirst, we must determine the normalization factor $M(\\delta)$. The influence function is given as a symmetric triangular function:\n$$w(r) = 1 - \\dfrac{|r|}{\\delta} \\quad \\text{for } |r| \\le \\delta, \\text{ and } 0 \\text{ otherwise.}$$\nThe normalization factor is the integral of the influence function over the horizon:\n$$M(\\delta) = \\int_{-\\delta}^{\\delta} w(|r|)\\,dr = 2 \\int_{0}^{\\delta} \\left(1 - \\dfrac{r}{\\delta}\\right) dr = 2 \\left[ r - \\dfrac{r^2}{2\\delta} \\right]_0^\\delta = 2 \\left( \\delta - \\dfrac{\\delta^2}{2\\delta} \\right) = \\delta$$\nThus, the normalization factor is simply the horizon, $M(\\delta) = \\delta$.\n\nThe local strain $\\varepsilon(y)$ is derived from the quasi-static equilibrium condition, which implies a constant axial force $P$ throughout the bar. The strain is inversely proportional to the local cross-sectional area $A(y)$:\n$$\\varepsilon(y) = \\dfrac{P}{E\\,A(y)}$$\nThe area $A(y)$ is a piecewise constant function, symmetric about the origin:\n$$A(y) = \\begin{cases} A_{\\min} & \\text{for } |y| \\le a \\\\ A_0 & \\text{for } |y| > a \\end{cases}$$\nwhere $a$ is the half-width of the notch.\n\nSubstituting these expressions into the formula for $s(0)$, we get:\n$$s(0) = \\dfrac{1}{\\delta} \\int_{-\\delta}^{\\delta} \\left(1 - \\dfrac{|y|}{\\delta}\\right) \\dfrac{P}{E\\,A(y)} dy$$\nSince $P$ and $E$ are constants, we can factor them out. Also, the integrand is an even function of $y$, so we can simplify the integral:\n$$s(0) = \\dfrac{2P}{E\\delta} \\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) \\dfrac{1}{A(y)} dy$$\nThe evaluation of this integral depends on the relative magnitudes of the horizon $\\delta$ and the notch half-width $a$. We must consider two distinct cases.\n\nCase 1: The horizon is smaller than or equal to the notch half-width ($\\delta \\le a$).\nIn this case, for the entire integration domain $y \\in [0, \\delta]$, the condition $y \\le \\delta \\le a$ holds. Therefore, the cross-sectional area is constant, $A(y) = A_{\\min}$. The integral becomes:\n$$\\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) \\dfrac{1}{A_{\\min}} dy = \\dfrac{1}{A_{\\min}} \\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) dy = \\dfrac{1}{A_{\\min}} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_0^\\delta = \\dfrac{1}{A_{\\min}} \\left( \\delta - \\dfrac{\\delta}{2} \\right) = \\dfrac{\\delta}{2A_{\\min}}$$\nSubstituting this result into the expression for $s(0)$:\n$$s(0) = \\dfrac{2P}{E\\delta} \\left( \\dfrac{\\delta}{2A_{\\min}} \\right) = \\dfrac{P}{E A_{\\min}}$$\nThis is simply the local strain at the notch root. For $\\delta \\le a$, the nonlocal model's prediction at the point of maximum strain coincides with the local theory. Applying the fracture criterion $s(0) = s_c$ for the critical load $P_c$:\n$$s_c = \\dfrac{P_c}{E A_{\\min}} \\implies P_c = s_c E A_{\\min}$$\n\nCase 2: The horizon is larger than the notch half-width ($\\delta > a$).\nIn this case, the integral must be split into two parts, corresponding to the two regions of the cross-sectional area within the horizon:\n$$\\int_{0}^{\\delta} \\dfrac{1 - y/\\delta}{A(y)} dy = \\int_{0}^{a} \\dfrac{1 - y/\\delta}{A_{\\min}} dy + \\int_{a}^{\\delta} \\dfrac{1 - y/\\delta}{A_0} dy$$\nEvaluating the first integral:\n$$\\int_{0}^{a} \\dfrac{1 - y/\\delta}{A_{\\min}} dy = \\dfrac{1}{A_{\\min}} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_0^a = \\dfrac{1}{A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right)$$\nEvaluating the second integral:\n$$\\int_{a}^{\\delta} \\dfrac{1 - y/\\delta}{A_0} dy = \\dfrac{1}{A_0} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_a^\\delta = \\dfrac{1}{A_0} \\left[ \\left(\\delta - \\dfrac{\\delta^2}{2\\delta}\\right) - \\left(a - \\dfrac{a^2}{2\\delta}\\right) \\right] = \\dfrac{1}{A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right)$$\nCombining these results, the total integral is:\n$$I = \\dfrac{1}{A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right) + \\dfrac{1}{A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right)$$\nNow we find $s(0)$ by substituting this integral $I$:\n$$s(0) = \\dfrac{2P}{E\\delta} I = \\dfrac{P}{E} \\left[ \\dfrac{2}{\\delta A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right) + \\dfrac{2}{\\delta A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right) \\right]$$\n$$s(0) = \\dfrac{P}{E} \\left[ \\left( \\dfrac{2a}{\\delta} - \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_{\\min}} + \\left( 1 - \\dfrac{2a}{\\delta} + \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_0} \\right]$$\nFactoring the terms gives a more compact expression:\n$$s(0) = \\dfrac{P}{E} \\left[ \\left(\\dfrac{a}{\\delta}\\left(2 - \\dfrac{a}{\\delta}\\right)\\right) \\dfrac{1}{A_{\\min}} + \\left(1 - \\dfrac{a}{\\delta}\\right)^2 \\dfrac{1}{A_0} \\right]$$\nApplying the fracture criterion $s(0) = s_c$ and solving for the critical load $P_c$:\n$$P_c = \\dfrac{s_c E}{\\left( \\dfrac{2a}{\\delta} - \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_{\\min}} + \\left( 1 - \\dfrac{a}{\\delta} \\right)^2 \\dfrac{1}{A_0}}$$\nThis formula is valid for $\\delta > a$. It can be verified that as $\\delta \\to a^+$, this expression smoothly converges to the result from Case 1, ensuring continuity.\n\nThe computational procedure is therefore to use the input parameters for each test case to determine whether $\\delta \\le a$ or $\\delta > a$, apply the corresponding formula for $P_c$, and compute the numerical result.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the critical fracture initiation load Pc for a notched bar\n    using a one-dimensional nonlocal bond-stretch model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is ordered as (E, A_0, A_min, a, delta, s_c, L) in SI units.\n    test_cases = [\n        # Case 1 (general case with delta > a)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-2, 2.0e-3, 1.0),\n        # Case 2 (boundary where delta < a)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 3.0e-3, 2.0e-3, 1.0),\n        # Case 3 (large horizon)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-1, 2.0e-3, 1.0),\n        # Case 4 (no notch, A_min = A_0)\n        (200e9, 1.0e-4, 1.0e-4, 5.0e-3, 2.0e-2, 2.0e-3, 1.0),\n        # Case 5 (very small horizon)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-6, 2.0e-3, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_mod, A_0, A_min, a_notch, delta_horizon, s_crit, _ = case\n\n        # The calculation depends on the relationship between the horizon (delta)\n        # and the notch half-width (a).\n        if delta_horizon <= a_notch:\n            # Case 1: Horizon is within the notch region.\n            # The nonlocal stretch equals the local strain at the notch root.\n            # This recovers the local theory prediction.\n            # Formula: Pc = s_c * E * A_min\n            P_c = s_crit * E_mod * A_min\n        else:\n            # Case 2: Horizon extends beyond the notch region.\n            # The nonlocal stretch is a weighted average of strains from both\n            # the notched and un-notched regions.\n            # Formula: Pc = s_c * E / [ (2a/d - (a/d)^2)/A_min + (1-a/d)^2/A_0 ]\n            \n            # Ratio of notch half-width to horizon\n            ratio_a_delta = a_notch / delta_horizon\n            \n            # Geometric factor in the denominator of the Pc expression\n            geom_factor = ( (2 * ratio_a_delta - ratio_a_delta**2) / A_min \n                           + (1 - ratio_a_delta)**2 / A_0 )\n            \n            P_c = (s_crit * E_mod) / geom_factor\n        \n        # Round the result to the nearest integer as required.\n        results.append(int(np.round(P_c)))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2905433"}]}