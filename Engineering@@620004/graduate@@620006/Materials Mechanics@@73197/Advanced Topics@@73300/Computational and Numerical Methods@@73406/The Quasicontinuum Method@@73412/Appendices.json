{"hands_on_practices": [{"introduction": "This first practice provides a direct, hands-on calculation of the core components of the Quasicontinuum (QC) method. By working through a one-dimensional chain, you will apply the local Cauchy-Born approximation and a linear interpolation scheme to compute the total potential energy of a coarse-grained system. This exercise solidifies the fundamental connection between nodal displacements, continuum deformation, and the resulting energy and internal forces, which are derived by direct differentiation [@problem_id:2923438].", "problem": "Consider a one-dimensional chain of $9$ atoms indexed by $i=0,1,\\ldots,8$ with reference positions $X_i=i\\,a_0$, where $a_0>0$ is the reference nearest-neighbor spacing. The atomic interactions are restricted to nearest neighbors via a pair potential $\\phi(r)$ that depends only on the current bond length $r$. The chain is coarse-grained by the Quasicontinuum (QC) method using a two-element mesh with representative atoms (also called repatoms) at $i=0,4,8$, thereby defining two elements: element $1$ spanning $[X_0,X_4]$ and element $2$ spanning $[X_4,X_8]$. Assume the local Cauchy–Born approximation in each element with linear interpolation of displacements between repatoms, and use the uniform-weight summation rule that counts all nearest-neighbor bonds in each element.\n\nThe pair potential is harmonic about $a_0$, i.e., $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$, with stiffness $k>0$. Let the repatom displacements be prescribed as $u_0=0$, $u_4=\\bar{u}$, and $u_8=2\\bar{u}$, where $\\bar{u}>0$ is a given constant. With these data, the QC total potential energy is defined as the sum of the element contributions obtained by counting the $4$ bonds in each element, each deformed consistently with the element’s linear displacement field.\n\nStarting from the definitions of the bond-length change induced by a linear displacement field and the Cauchy–Born relation, derive the QC total energy $E_{\\mathrm{QC}}(u)$ as a function of the repatom displacements. Then, compute $E_{\\mathrm{QC}}(u)$ for the specific values $k=100~\\mathrm{N/m}$, $a_0=2.5\\times 10^{-10}~\\mathrm{m}$, and $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$. Finally, obtain the internal nodal forces at the repatoms by differentiation, $\\mathbf{F}=-\\nabla E_{\\mathrm{QC}}(u)$ evaluated at the given displacements, and report the three components $F_0$, $F_4$, and $F_8$.\n\nAnswer specification:\n- Express the energy in $\\mathrm{J}$ and the forces in $\\mathrm{N}$.\n- Round all reported quantities to three significant figures.\n- Provide your final answer as a single row matrix containing first $E_{\\mathrm{QC}}(u)$, followed by $F_0$, $F_4$, and $F_8$, in that order.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extracted Givens.\n- A one-dimensional chain of $9$ atoms, indexed $i=0,1,\\ldots,8$.\n- Reference positions: $X_i=i\\,a_0$, with lattice parameter $a_0>0$.\n- Interaction potential: Nearest-neighbor harmonic pair potential $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$, with stiffness $k>0$.\n- Coarse-graining: Quasicontinuum (QC) method with representative atoms (repatoms) at indices $0$, $4$, and $8$.\n- Mesh: Two elements, element $1$ over $[X_0,X_4]$ and element $2$ over $[X_4,X_8]$.\n- Approximations: Local Cauchy–Born rule with linear interpolation of displacements.\n- Summation rule: Uniform-weight summation, counting $4$ bonds in each element.\n- Prescribed displacements: $u_0=0$, $u_4=\\bar{u}$, $u_8=2\\bar{u}$.\n- Constants: $k=100~\\mathrm{N/m}$, $a_0=2.5\\times 10^{-10}~\\mathrm{m}$, $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$.\n- Required outputs: Total QC energy $E_{\\mathrm{QC}}(u)$ and nodal forces $F_0$, $F_4$, $F_8$, with numerical values rounded to three significant figures.\n\nStep 2: Validation Using Extracted Givens.\nThe problem is scientifically grounded, as it describes a standard application of the Quasicontinuum method, a well-established multiscale technique in computational materials science. The use of a harmonic potential corresponds to the linear elastic limit, and the Cauchy-Born approximation is a fundamental tenet of the method. The problem is well-posed; it provides all necessary data, parameters, and boundary conditions to arrive at a unique, meaningful solution. The definitions are clear, self-contained, and consistent. For instance, the domain of element $1$, $[X_0, X_4]$, contains atoms $0, 1, 2, 3, 4$ and thus the four nearest-neighbor bonds $(0,1), (1,2), (2,3), (3,4)$, which is consistent with the specified count of $4$ bonds. The same holds for element $2$. The numerical values are physically plausible for an atomic system. The problem does not violate any of the invalidity criteria.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be derived.\n\nDerivation of the QC Total Energy $E_{\\mathrm{QC}}(u)$.\nThe total energy is the sum of the energies of the two elements, $E_{\\mathrm{QC}} = E^{(1)} + E^{(2)}$.\n\nFor element $1$, spanning repatoms $0$ and $4$, the reference length is $L_1 = X_4 - X_0 = 4a_0$. The displacement field $u(X)$ for $X \\in [X_0, X_4]$ is assumed to be linear:\n$$u(X) = u_0 \\left(1 - \\frac{X-X_0}{L_1}\\right) + u_4 \\left(\\frac{X-X_0}{L_1}\\right)$$\nThe macroscopic deformation gradient $F$ is constant within the element and is given by $F = 1 + du/dX$.\n$$F^{(1)} = 1 + \\frac{u_4 - u_0}{X_4 - X_0} = 1 + \\frac{u_4 - u_0}{4a_0}$$\nAccording to the local Cauchy–Born approximation, every bond in the element deforms according to this macroscopic gradient. The deformed bond length $r^{(1)}$ is:\n$$r^{(1)} = F^{(1)} a_0 = \\left(1 + \\frac{u_4 - u_0}{4a_0}\\right) a_0 = a_0 + \\frac{u_4 - u_0}{4}$$\nThe energy stored in a single such bond is:\n$$\\phi(r^{(1)}) = \\frac{1}{2}k(r^{(1)} - a_0)^2 = \\frac{1}{2}k\\left(\\frac{u_4 - u_0}{4}\\right)^2$$\nElement $1$ contains $4$ bonds. Using the uniform-weight summation rule, the energy of element $1$ is:\n$$E^{(1)} = 4 \\times \\phi(r^{(1)}) = 4 \\times \\frac{1}{2}k\\frac{(u_4 - u_0)^2}{16} = \\frac{k}{8}(u_4 - u_0)^2$$\nSimilarly, for element $2$, spanning repatoms $4$ and $8$ over a reference length $L_2 = X_8 - X_4 = 4a_0$:\n$$F^{(2)} = 1 + \\frac{u_8 - u_4}{X_8 - X_4} = 1 + \\frac{u_8 - u_4}{4a_0}$$\n$$r^{(2)} = F^{(2)} a_0 = a_0 + \\frac{u_8 - u_4}{4}$$\nThe energy of element $2$, which also contains $4$ bonds, is:\n$$E^{(2)} = 4 \\times \\frac{1}{2}k(r^{(2)} - a_0)^2 = \\frac{k}{8}(u_8 - u_4)^2$$\nThe total QC energy is the sum of the element energies:\n$$E_{\\mathrm{QC}}(u_0, u_4, u_8) = E^{(1)} + E^{(2)} = \\frac{k}{8}(u_4 - u_0)^2 + \\frac{k}{8}(u_8 - u_4)^2$$\n\nNumerical Calculation of Energy.\nSubstituting the prescribed displacements $u_0=0$, $u_4=\\bar{u}$, and $u_8=2\\bar{u}$:\n$$E_{\\mathrm{QC}} = \\frac{k}{8}(\\bar{u} - 0)^2 + \\frac{k}{8}(2\\bar{u} - \\bar{u})^2 = \\frac{k}{8}\\bar{u}^2 + \\frac{k}{8}\\bar{u}^2 = \\frac{k}{4}\\bar{u}^2$$\nUsing the given values $k=100~\\mathrm{N/m}$ and $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$:\n$$E_{\\mathrm{QC}} = \\frac{100~\\mathrm{N/m}}{4} (4.0\\times 10^{-11}~\\mathrm{m})^2 = (25~\\mathrm{N/m}) \\times (16.0 \\times 10^{-22}~\\mathrm{m}^2) = 400 \\times 10^{-22}~\\mathrm{J} = 4.0 \\times 10^{-20}~\\mathrm{J}$$\nRounded to three significant figures, the energy is $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$.\n\nDerivation and Calculation of Nodal Forces.\nThe internal forces on the repatoms are given by the negative gradient of the total potential energy, $\\mathbf{F} = -\\nabla E_{\\mathrm{QC}}(u)$. The components are $F_i = -\\partial E_{\\mathrm{QC}} / \\partial u_i$.\n$$F_0 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_0} = -\\frac{k}{8} \\cdot 2(u_4-u_0)(-1) = \\frac{k}{4}(u_4 - u_0)$$\n$$F_8 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_8} = -\\frac{k}{8} \\cdot 2(u_8-u_4)(1) = -\\frac{k}{4}(u_8 - u_4)$$\n$$F_4 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_4} = -\\left[ \\frac{k}{8} \\cdot 2(u_4-u_0)(1) + \\frac{k}{8} \\cdot 2(u_8-u_4)(-1) \\right] = -\\frac{k}{4}\\left[ (u_4-u_0) - (u_8-u_4) \\right] = -\\frac{k}{4}(2u_4 - u_0 - u_8)$$\nSubstituting the prescribed displacements ($u_0=0, u_4=\\bar{u}, u_8=2\\bar{u}$) and numerical values:\n$$F_0 = \\frac{k}{4}(\\bar{u} - 0) = \\frac{k}{4}\\bar{u} = \\frac{100}{4}(4.0\\times 10^{-11}) = 25 \\times 4.0\\times 10^{-11} = 100 \\times 10^{-11}~\\mathrm{N} = 1.0 \\times 10^{-9}~\\mathrm{N}$$\nTo three significant figures, $F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$.\n\n$$F_8 = -\\frac{k}{4}(2\\bar{u} - \\bar{u}) = -\\frac{k}{4}\\bar{u} = -1.0 \\times 10^{-9}~\\mathrm{N}$$\nTo three significant figures, $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$.\n\n$$F_4 = -\\frac{k}{4}(2\\bar{u} - 0 - 2\\bar{u}) = -\\frac{k}{4}(0) = 0~\\mathrm{N}$$\nThe force $F_4$ is exactly zero because the strain is uniform across the two elements. Uniform strain implies the force exerted by element $1$ on repatom $4$ is equal and opposite to the force exerted by element $2$ on repatom $4$. The value is exactly $0$.\n\nThe final results are $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$, $F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$, $F_4 = 0~\\mathrm{N}$, and $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$.", "answer": "$$\\boxed{\\begin{pmatrix} 4.00 \\times 10^{-20} & 1.00 \\times 10^{-9} & 0 & -1.00 \\times 10^{-9} \\end{pmatrix}}$$", "id": "2923438"}, {"introduction": "After mastering the basic mechanics of QC, this practice challenges you to explore its fundamental limitations. The Cauchy-Born rule, which equates atomistic and continuum deformation, is the heart of the method but fails under certain conditions, such as near a material instability. This exercise guides you to construct a rigorous counterexample, comparing the stress predicted by the Cauchy-Born rule against a more accurate atomistic calculation that allows for the formation of microstructure, thereby highlighting the critical concept of energetic non-convexity [@problem_id:2923419].", "problem": "You will construct and quantify a rigorous counterexample to the Cauchy–Born rule in the setting of the quasicontinuum method, by comparing the stress predicted by a homogeneous deformation to that obtained from a minimal atomistic microstructure under the same macroscopic strain. Consider a one-dimensional infinite chain of identical atoms with nearest-neighbor interactions governed by the Lennard–Jones potential\n$$\n\\phi(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\nwhere $r$ is the bond length, $\\varepsilon$ is the energy scale, and $\\sigma$ is the length scale. The reference lattice spacing $a_0$ is the minimizer of $\\phi$, i.e., $a_0 = \\operatorname{argmin}_r \\phi(r)$, which occurs at $a_0 = 2^{1/6}\\sigma$. You will impose a macroscopic stretch $F$ so that the average bond length equals $F a_0$. The Cauchy–Born rule (CB) assumes a homogeneous deformation, whereas an atomistic calculation may realize a non-homogeneous period-doubled microstructure with two alternating bond lengths $l_1$ and $l_2$ satisfying the average constraint $l_1 + l_2 = 2 F a_0$. \n\nStarting only from Newton’s laws, energy minimization principles, and the definition of the First Piola–Kirchhoff (PK1) stress as the derivative of energy with respect to deformation, you must derive:\n- The PK1 stress predicted by the Cauchy–Born rule under the homogeneous deformation assumption.\n- The PK1 stress from an atomistic two-atom periodic cell that minimizes the total potential energy under the average constraint $l_1 + l_2 = 2 F a_0$ (which can lead to $l_1 \\neq l_2$ in nonconvex regions of $\\phi$).\n- The absolute error between these two stress predictions, given by $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$.\n\nAssume reduced units with $\\varepsilon = 1$ and $\\sigma = 1$ so that stresses are expressed in units of $\\varepsilon/\\sigma$. Your program must:\n- Compute $a_0 = 2^{1/6}\\sigma$ using $\\sigma = 1$.\n- For each prescribed macroscopic stretch $F$, compute the Cauchy–Born PK1 stress and the atomistic PK1 stress as described above.\n- Output the absolute error in PK1 stress $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$ for each test case.\n\nTest suite:\n- Use the following macroscopic stretches $F$: $[1.00, 1.10, 1.12, 1.20, 1.30]$.\n- These values are chosen to probe: a stable homogeneous regime (near $F=1.00$), a regime just below the onset of nonconvexity ($F=1.10$), a regime just above the onset of nonconvexity ($F=1.12$), and deeper into the nonconvex regime ($F=1.20$ and $F=1.30$), where the Cauchy–Born rule may fail.\n\nRequired output:\n- Express the absolute errors in units of $\\varepsilon/\\sigma$.\n- Round each result to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[0.000000,0.123456,0.000001,0.500000,0.750000]$). There should be no extra whitespace or text.\n\nNotes:\n- Angles are not involved in this problem.\n- All computations are to be performed in reduced units with $\\varepsilon = 1$ and $\\sigma = 1$.\n- No input should be read; the specified test suite must be hard-coded and executed automatically when the program runs.", "solution": "The problem requires the construction and analysis of a counterexample to the Cauchy–Born rule for a one-dimensional atomic chain. The validation of the problem statement has been performed. The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a rigorous solution. We may proceed.\n\nThe analysis is conducted in reduced units where $\\varepsilon = 1$ and $\\sigma = 1$.\n\n**1. Interatomic Potential and Reference State**\n\nThe interaction between nearest-neighbor atoms is described by the Lennard-Jones potential:\n$$\n\\phi(r) = 4\\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] = 4 \\left( r^{-12} - r^{-6} \\right)\n$$\nwhere $r$ is the interatomic distance.\n\nThe reference lattice spacing, $a_0$, is the bond length that minimizes the potential energy $\\phi(r)$. This is found by setting the first derivative of the potential to zero:\n$$\n\\frac{d\\phi}{dr} = \\phi'(r) = 4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\nThis yields $6r^{-7} = 12r^{-13}$, which simplifies to $r^6 = 2$. Thus, the reference lattice spacing is:\n$$\na_0 = 2^{1/6}\\sigma = 2^{1/6}\n$$\nAt this spacing, the force between atoms is zero, as $\\phi'(a_0)=0$.\n\n**2. Definition of First Piola-Kirchhoff (PK1) Stress**\n\nThe PK1 stress, $P$, in one dimension is defined as the derivative of the energy density with respect to the macroscopic deformation gradient, $F$. The energy density, $\\mathcal{E}$, is the energy per unit reference length. For a system of bonds, this is the energy per bond divided by the reference length per bond, $a_0$.\n$$\nP = \\frac{\\partial \\mathcal{E}}{\\partial F} = \\frac{1}{a_0} \\frac{\\partial E_{\\text{bond}}}{\\partial F}\n$$\n\n**3. Cauchy–Born (CB) Stress Prediction**\n\nThe Cauchy–Born rule assumes that the macroscopic deformation $F$ applies uniformly at the atomic scale. This implies a homogeneous deformation where every bond has the same length, $r_{\\mathrm{CB}}$:\n$$\nr_{\\mathrm{CB}} = F a_0\n$$\nThe energy per bond is simply the potential evaluated at this length, $E_{\\mathrm{CB}}(F) = \\phi(r_{\\mathrm{CB}}) = \\phi(F a_0)$.\n\nThe PK1 stress under the CB assumption, $P_{\\mathrm{CB}}$, is then:\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\frac{d}{dF} \\left[ \\phi(F a_0) \\right]\n$$\nApplying the chain rule, $\\frac{d}{dF} = \\frac{dr_{\\mathrm{CB}}}{dF} \\frac{d}{dr_{\\mathrm{CB}}} = a_0 \\frac{d}{dr_{\\mathrm{CB}}}$, we find:\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\left( a_0 \\cdot \\phi'(F a_0) \\right) = \\phi'(F a_0)\n$$\nSubstituting the expression for $\\phi'(r)$:\n$$\nP_{\\mathrm{CB}}(F) = 24(F a_0)^{-7} - 48(F a_0)^{-13}\n$$\n\n**4. Atomistic Stress Prediction**\n\nThe atomistic model considers a minimal microstructure: a period-doubled unit cell with two alternating bond lengths, $l_1$ and $l_2$. The macroscopic stretch $F$ is imposed as a constraint on the average bond length:\n$$\n\\frac{l_1 + l_2}{2} = F a_0 \\implies l_1 + l_2 = 2F a_0\n$$\nThe energy of this two-bond cell is $E_{\\mathrm{cell}} = \\phi(l_1) + \\phi(l_2)$. The actual bond lengths are those that minimize $E_{\\mathrm{cell}}$ subject to the constraint. We can express the energy as a function of $l_1$ alone:\n$$\nE_{\\mathrm{cell}}(l_1) = \\phi(l_1) + \\phi(2F a_0 - l_1)\n$$\nThe condition for a stationary point is $\\frac{dE_{\\mathrm{cell}}}{dl_1} = 0$:\n$$\n\\frac{dE_{\\mathrm{cell}}}{dl_1} = \\phi'(l_1) - \\phi'(2F a_0 - l_1) = 0 \\implies \\phi'(l_1) = \\phi'(l_2)\n$$\nThis equilibrium condition means the internal forces in the two bonds must be equal.\n\nThe stability of the homogeneous solution, where $l_1 = l_2 = F a_0$, depends on the second derivative of the cell energy, which corresponds to the convexity of the potential $\\phi(r)$.\n$$\n\\frac{d^2 E_{\\mathrm{cell}}}{dl_1^2} \\bigg|_{l_1 = F a_0} = \\phi''(F a_0) + \\phi''(F a_0) = 2\\phi''(F a_0)\n$$\nThe homogeneous solution is stable only if $2\\phi''(F a_0) > 0$. The potential becomes non-convex where $\\phi''(r) < 0$. Let us find the inflection point $r_c$ where $\\phi''(r_c) = 0$.\n$$\n\\phi''(r) = 4 \\left( 156 r^{-14} - 42 r^{-8} \\right) = 0\n$$\nThis gives $r_c^6 = \\frac{156}{42} = \\frac{26}{7}$. So, $r_c = (26/7)^{1/6}$. The homogeneous deformation is unstable if the bond length $F a_0$ exceeds $r_c$. This defines a critical stretch $F_c$:\n$$\nF_c = \\frac{r_c}{a_0} = \\frac{(26/7)^{1/6}}{(2)^{1/6}} = \\left(\\frac{13}{7}\\right)^{1/6} \\approx 1.1086\n$$\nFor $F \\le F_c$, the stable solution is homogeneous, $l_1 = l_2 = F a_0$.\nFor $F > F_c$, the homogeneous solution is unstable, and the system bifurcates to a non-homogeneous state with $l_1 \\neq l_2$.\n\nThe atomistic stress $P_{\\mathrm{atom}}$ is derived from the energy of the two-bond cell. The energy density is $\\mathcal{E}_{\\mathrm{atom}} = \\frac{E_{\\mathrm{cell}}}{2a_0} = \\frac{\\phi(l_1(F)) + \\phi(l_2(F))}{2a_0}$.\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\partial \\mathcal{E}_{\\mathrm{atom}}}{\\partial F} = \\frac{1}{2a_0} \\left( \\phi'(l_1) \\frac{dl_1}{dF} + \\phi'(l_2) \\frac{dl_2}{dF} \\right)\n$$\nUsing the equilibrium condition $\\phi'(l_1) = \\phi'(l_2) \\equiv \\phi'_{\\min}$ and the derivative of the constraint, $\\frac{dl_1}{dF} + \\frac{dl_2}{dF} = 2a_0$, we obtain:\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\phi'_{\\min}}{2a_0} \\left( \\frac{dl_1}{dF} + \\frac{dl_2}{dF} \\right) = \\frac{\\phi'_{\\min}}{2a_0} (2a_0) = \\phi'_{\\min}\n$$\nThus, $P_{\\mathrm{atom}}(F) = \\phi'(l_1)$, where $l_1$ is the energy-minimizing bond length.\n\n**5. Computational Algorithm**\n\nFor each given macroscopic stretch $F$:\n1.  Calculate $a_0 = 2^{1/6}$ and $F_c = (13/7)^{1/6}$.\n2.  Calculate the Cauchy-Born stress: $P_{\\mathrm{CB}} = \\phi'(F a_0)$.\n3.  Compare $F$ with $F_c$:\n    *   If $F \\le F_c$, the system remains homogeneous. The atomistic model gives $l_1 = l_2 = F a_0$, and thus $P_{\\mathrm{atom}} = \\phi'(F a_0) = P_{\\mathrm{CB}}$. The error is $0$.\n    *   If $F > F_c$, the system bifurcates. We must find the non-homogeneous solution by numerically solving the system of equations for $l_1, l_2$:\n        $$\n        \\begin{cases}\n        \\phi'(l_1) = \\phi'(l_2) \\\\\n        l_1 + l_2 = 2F a_0\n        \\end{cases}\n        $$\n        This is equivalent to finding a root $l_1^*$ of the function $f(x) = \\phi'(x) - \\phi'(2F a_0 - x)$ for $x \\neq F a_0$. Based on analysis of $\\phi'(r)$, the physically meaningful solution for the shorter bond length $l_1^*$ lies in the interval $(a_0, r_c)$. A numerical root-finding algorithm is used on this interval.\n4.  Once $l_1^*$ is found, the atomistic stress is $P_{\\mathrm{atom}} = \\phi'(l_1^*)$.\n5.  The absolute error is $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$. This difference quantifies the failure of the Cauchy-Born rule.\n\nThis procedure provides a rigorous method to compute the required stress error.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the Cauchy-Born and atomistic PK1 stress\n    for a 1D atomic chain with Lennard-Jones interactions.\n    \"\"\"\n\n    # Reduced units are used, with epsilon = 1 and sigma = 1.\n    SIGMA = 1.0\n    EPSILON = 1.0\n\n    # Test cases for macroscopic stretch F\n    test_cases = [1.00, 1.10, 1.12, 1.20, 1.30]\n\n    # Pre-calculated constants based on the problem statement\n    # Reference lattice spacing a0 minimizes the potential, a0 = 2^(1/6) * sigma\n    a0 = np.power(2.0, 1.0/6.0) * SIGMA\n    \n    # Critical bond length rc is the inflection point of the potential, rc^6 = 26/7\n    rc = np.power(26.0/7.0, 1.0/6.0) * SIGMA\n    \n    # Critical stretch Fc corresponds to the onset of instability, Fc = rc / a0\n    Fc = rc / a0\n\n    def phi_prime(r):\n        \"\"\"\n        First derivative of the Lennard-Jones potential (proportional to force).\n        phi'(r) = 4 * epsilon * (-12 * sigma^12 / r^13 + 6 * sigma^6 / r^7)\n        In reduced units, this simplifies to:\n        phi'(r) = 24 / r^7 - 48 / r^13\n        \"\"\"\n        r_inv = SIGMA / r\n        r_inv6 = np.power(r_inv, 6)\n        r_inv12 = r_inv6 * r_inv6\n        \n        # The true phi'(r) is below. The simplified form 24r^-7 - 48r^-13 works fine.\n        return 4.0 * EPSILON * (-12.0 * r_inv12 / r + 6.0 * r_inv6 / r)\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate the bond length under homogeneous (Cauchy-Born) deformation\n        r_cb = F * a0\n        \n        # Calculate the Cauchy-Born PK1 stress\n        # P_CB = phi'(r_cb)\n        P_cb = phi_prime(r_cb)\n        \n        P_atom = 0.0\n        \n        # Check for stability. The CB rule holds if F <= Fc.\n        if F <= Fc:\n            # In the stable regime, the atomistic solution is homogeneous.\n            P_atom = P_cb\n        else:\n            # In the unstable regime (F > Fc), the system bifurcates.\n            # We need to find the non-homogeneous solution {l1, l2} that minimizes energy.\n            # This requires solving phi'(l1) = phi'(l2) with l1 + l2 = 2 * F * a0.\n            \n            # Define the function whose root we need to find.\n            def root_func(l1):\n                l2 = 2 * r_cb - l1\n                return phi_prime(l1) - phi_prime(l2)\n            \n            # The smaller bond length l1 must be in the interval (a0, rc).\n            # This bracket is guaranteed to contain the root for F > Fc.\n            bracket = [a0, rc]\n\n            # Use SciPy's root finder to find the energy-minimizing l1.\n            # Trivial solution is l1 = r_cb, we search for the other one.\n            sol = root_scalar(root_func, bracket=bracket, method='brentq')\n            \n            if sol.converged:\n                l1_sol = sol.root\n                # The atomistic stress is phi'(l1_sol)\n                P_atom = phi_prime(l1_sol)\n            else:\n                # Should not happen with the correct bracket and problem setup.\n                # In case of failure, treat as error.\n                P_atom = np.nan\n\n        # Calculate the absolute error between atomistic and CB stress predictions.\n        error = np.abs(P_atom - P_cb)\n        results.append(error)\n\n    # Format the output as a comma-separated list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2923419"}, {"introduction": "A central challenge in any multiscale method is the seamless coupling between atomistic and continuum regions. This practice exposes a common artifact in simple QC formulations known as \"ghost forces\"—spurious forces that arise at the interface even under uniform deformation, violating mechanical equilibrium. By constructing a simple one-dimensional model with non-local interactions, you will analytically derive this ghost force, gaining crucial insight into the need for more sophisticated, consistent coupling schemes in multiscale simulations [@problem_id:2678008].", "problem": "Consider a one-dimensional ($1$D) infinite atomic chain with reference lattice parameter $a>0$ and atoms labeled by indices $i \\in \\mathbb{Z}$ with reference positions $x_i = i a$. The deformed positions are denoted by $y_i \\in \\mathbb{R}$. The total atomistic energy is a sum of pairwise interactions up to second neighbors,\n$$\nE^{\\mathrm{atom}}(y) \\;=\\; \\sum_{i \\in \\mathbb{Z}} \\Big[ \\phi_1\\!\\big(|y_{i+1}-y_i|\\big) + \\phi_2\\!\\big(|y_{i+2}-y_i|\\big) \\Big],\n$$\nwhere $\\phi_1$ and $\\phi_2$ are smooth pair potentials for the nearest and next-nearest neighbor interactions, respectively. Forces are defined by energy gradients, i.e., the force on atom $i$ is $f_i(y) = -\\partial E/\\partial y_i$.\n\nA uniform macroscopic deformation is given by $y_i = F x_i = F i a$ for a fixed stretch $F>0$. In the fully atomistic model, symmetry implies $f_i(y)=0$ for all $i$ under this uniform deformation.\n\nDefine ghost forces in the quasicontinuum (QC) method as nonzero forces predicted under a uniform deformation. Construct the following energy-based atomistic/continuum (a/c) coupling in $1$D with an interface between an atomistic region $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$ and a continuum region $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$:\n\n- All nearest-neighbor bonds are retained exactly everywhere, i.e., every pair $\\{i,i+1\\}$ contributes $\\phi_1(|y_{i+1}-y_i|)$ to the QC energy.\n\n- Next-nearest-neighbor bonds entirely contained in $\\mathcal{A}$ contribute exactly, i.e., every pair $\\{i,i+2\\}$ with $i+2 \\le 0$ contributes $\\phi_2(|y_{i+2}-y_i|)$.\n\n- Next-nearest-neighbor bonds entirely contained in $\\mathcal{C}$ are approximated by a Cauchy–Born continuum energy that is a function of the constant deformation gradient $F$ in $\\mathcal{C}$; in particular, each such bond contributes $\\phi_2(2Fa)$, and this continuum energy depends only on degrees of freedom in $\\mathcal{C}$ (so its variation with respect to $y_0$ is zero).\n\n- Next-nearest-neighbor bonds that cross the interface (i.e., with one endpoint in $\\mathcal{A}$ and the other in $\\mathcal{C}$) are not explicitly represented in the QC energy.\n\nUnder the uniform deformation $y_i = F i a$, compute the net QC force on the interfacial atom $i=0$. This nonzero force is the ghost force at the a/c interface in this energy-based QC coupling. Provide your final answer as a single closed-form analytic expression in terms of $F$, $a$, and derivatives of the potentials evaluated at the relevant bond lengths. Do not include units in the final answer. If simplification is possible, provide the simplest expression consistent with the stated assumptions.", "solution": "The problem asks for the net quasicontinuum (QC) force on the interfacial atom $i=0$ under a uniform deformation. This force is known as a ghost force, as it should be zero in a perfectly consistent coarse-grained model.\n\nFirst, the problem statement is validated.\nGivens are extracted verbatim:\n- System: $1$D infinite atomic chain, reference positions $x_i = i a$ for $i \\in \\mathbb{Z}$ and $a>0$. Deformed positions are $y_i$.\n- Atomistic Energy: $E^{\\mathrm{atom}}(y) = \\sum_{i \\in \\mathbb{Z}} [ \\phi_1(|y_{i+1}-y_i|) + \\phi_2(|y_{i+2}-y_i|) ]$.\n- Force: $f_i(y) = -\\partial E/\\partial y_i$.\n- Uniform Deformation: $y_i = F x_i = F i a$ for $F>0$.\n- QC partitioning: Atomistic region $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$, continuum region $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$.\n- QC Energy Construction:\n    1. All nearest-neighbor (NN) bonds $\\{i,i+1\\}$ contribute $\\phi_1(|y_{i+1}-y_i|)$.\n    2. Next-nearest-neighbor (NNN) bonds $\\{i,i+2\\}$ with $i \\le -2$ contribute $\\phi_2(|y_{i+2}-y_i|)$.\n    3. NNN bonds $\\{i,i+2\\}$ with $i \\ge 1$ are approximated, and their energy contribution has zero variation with respect to $y_0$.\n    4. NNN bonds crossing the interface, $\\{ -1, 1 \\}$ and $\\{ 0, 2 \\}$, are not represented in the QC energy.\n\nThe problem is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard problem in the study of the quasicontinuum method. Therefore, the problem is valid.\n\nThe force on atom $k$ is defined as the negative gradient of the total energy with respect to its position $y_k$: $f_k^{\\mathrm{qc}} = -\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_k}$. We are asked to compute this force for the interfacial atom $k=0$.\nThe total QC energy, $E^{\\mathrm{qc}}$, is constructed according to the rules provided:\n$$\nE^{\\mathrm{qc}}(y) = \\sum_{i \\in \\mathbb{Z}} \\phi_1(|y_{i+1}-y_i|) + \\sum_{i \\in \\mathbb{Z}, i \\le -2} \\phi_2(|y_{i+2}-y_i|) + E_{\\mathcal{C}}^{\\mathrm{NNN}}(y_j | j \\ge 1)\n$$\nwhere $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ is the energy from NNN bonds in the continuum region $\\mathcal{C}$, which by definition does not depend on $y_0$. Note that the NNN bonds across the interface, corresponding to $i=-1$ and $i=0$ in the full atomistic sum, are omitted from this energy expression.\n\nTo find the force on atom $0$, $f_0^{\\mathrm{qc}}$, we must differentiate $E^{\\mathrm{qc}}$ with respect to $y_0$. We only need to consider terms in $E^{\\mathrm{qc}}$ that are functions of $y_0$.\n1. From the sum of NN interactions, $\\sum_i \\phi_1(|y_{i+1}-y_i|)$, the terms involving $y_0$ are for $i=0$ and $i=-1$: $\\phi_1(|y_1 - y_0|)$ and $\\phi_1(|y_0 - y_{-1}|)$.\n2. From the sum of NNN interactions in $\\mathcal{A}$, $\\sum_{i \\le -2} \\phi_2(|y_{i+2}-y_i|)$, the term involving $y_0$ is when $i+2=0$, which means $i=-2$. This satisfies the condition $i \\le -2$. So, the term is $\\phi_2(|y_0 - y_{-2}|)$. The term for $i=0$ is not in this sum.\n3. The continuum energy $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ has $\\frac{\\partial E_{\\mathcal{C}}^{\\mathrm{NNN}}}{\\partial y_0} = 0$ by definition.\n4. The NNN interaction between atom $0$ and atom $2$ is explicitly excluded.\n\nThus, the part of the QC energy that depends on $y_0$ is:\n$$\nE_{y_0-\\text{dep}}^{\\mathrm{qc}} = \\phi_1(|y_1 - y_0|) + \\phi_1(|y_0 - y_{-1}|) + \\phi_2(|y_0 - y_{-2}|)\n$$\nThe force on atom $0$ is $f_0^{\\mathrm{qc}} = -\\frac{\\partial}{\\partial y_0} E_{y_0-\\text{dep}}^{\\mathrm{qc}}$. Let us compute the derivatives of each term using the chain rule, where $\\phi'(r) = \\frac{d\\phi}{dr}(r)$.\n$$\n\\frac{\\partial}{\\partial y_k} \\phi(|y_j - y_i|) = \\phi'(|y_j - y_i|) \\cdot \\mathrm{sgn}(y_j - y_i) \\cdot (\\delta_{kj} - \\delta_{ki})\n$$\nApplying this to our terms:\n- For $\\phi_1(|y_1-y_0|)$: $i=0, j=1, k=0$. The derivative is $\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0) (-1) = -\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0)$.\n- For $\\phi_1(|y_0-y_{-1}|)$: $i=-1, j=0, k=0$. The derivative is $\\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1}) (1) = \\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1})$.\n- For $\\phi_2(|y_0-y_{-2}|)$: $i=-2, j=0, k=0$. The derivative is $\\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2}) (1) = \\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2})$.\n\nSumming these derivatives gives $\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_0}$. The force is the negative of this sum:\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(|y_1-y_0|)\\mathrm{sgn}(y_1-y_0) + \\phi_1'(|y_0-y_{-1}|)\\mathrm{sgn}(y_0-y_{-1}) + \\phi_2'(|y_0-y_{-2}|)\\mathrm{sgn}(y_0-y_{-2}) \\right]\n$$\nNow, we evaluate this expression for the uniform deformation $y_i = F i a$, where $F>0$ and $a>0$.\n- Bond length $y_1 - y_0 = F(1)a - F(0)a = Fa$. Since $Fa>0$, $|y_1-y_0| = Fa$ and $\\mathrm{sgn}(y_1-y_0)=1$.\n- Bond length $y_0 - y_{-1} = F(0)a - F(-1)a = Fa$. Since $Fa>0$, $|y_0-y_{-1}| = Fa$ and $\\mathrm{sgn}(y_0-y_{-1})=1$.\n- Bond length $y_0 - y_{-2} = F(0)a - F(-2)a = 2Fa$. Since $2Fa>0$, $|y_0-y_{-2}| = 2Fa$ and $\\mathrm{sgn}(y_0-y_{-2})=1$.\n\nSubstituting these into the force expression:\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) \\cdot (1) + \\phi_1'(Fa) \\cdot (1) + \\phi_2'(2Fa) \\cdot (1) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) + \\phi_1'(Fa) + \\phi_2'(2Fa) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = - [ 0 + \\phi_2'(2Fa) ] = -\\phi_2'(2Fa)\n$$\nThis nonzero force is the ghost force at the interface. It arises because the force contribution on atom $0$ from atom $2$ is missing in the QC energy formulation, breaking the force balance that exists in the full atomistic system. In the atomistic system, the force on atom $0$ from atom $2$ would be $\\phi_2'(|y_2-y_0|)\\mathrm{sgn}(y_2-y_0) = \\phi_2'(2Fa)$, which is precisely the negative of the sum of all other forces acting on atom $0$ under uniform deformation, thus ensuring the total force is zero. The QC method's omission of this single interaction term leads to the calculated residual force.\nThe final expression is in terms of $F$, $a$, and the derivative of the potential $\\phi_2$ evaluated at the NNN bond length $2Fa$.", "answer": "$$\n\\boxed{-\\phi_2'(2Fa)}\n$$", "id": "2678008"}]}