{"hands_on_practices": [{"introduction": "The first step in understanding a new physical theory is often to explore its most fundamental solutions. This exercise guides you through the process of deriving the classic one-dimensional analytical solution for a phase-field crack profile. By applying the principles of the calculus of variations to the Ambrosio-Tortorelli energy functional, you will find the stationary path that describes the shape of a regularized crack [@problem_id:2929068]. This foundational practice is crucial for building intuition about how phase-field models smoothly represent sharp discontinuities and for appreciating the concept of $\\Gamma$-convergence.", "problem": "Consider a one-dimensional stationary phase-field representation of a single, sharp crack located at the origin in an infinite elastic body under vanishing elastic driving. Let the crack phase-field be denoted by $d(x)$, where $x \\in \\mathbb{R}$, with $d(x) \\in [0,1]$, $d(x)=1$ indicating fully broken and $d(x)=0$ indicating intact material. The regularized crack surface density in the so-called Ambrosio–Tortorelli (AT2) model is taken, in normalized form, as the functional\n$$\n\\Gamma_{\\ell}^{+}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\nwhere $\\ell>0$ is the internal length scale parameter that controls the width of the diffused crack zone. Assume the physically motivated boundary conditions $d(0)=1$ (crack peak at the origin) and $\\lim_{x\\to\\infty} d(x)=0$ (intact far field). The total crack surface measure corresponding to the two faces of the crack is modeled by $S_\\ell[d] \\coloneqq 2\\,\\Gamma_{\\ell}^{+}[d]$.\n\nUsing only first principles of the calculus of variations (Euler–Lagrange equation and admissible boundary conditions), perform the following:\n\n- Derive the stationarity condition for $d(x)$ associated with $\\Gamma_{\\ell}^{+}[d]$ on $x\\in(0,\\infty)$ and solve the resulting ordinary differential equation subject to $d(0)=1$ and $\\lim_{x\\to\\infty} d(x)=0$.\n- Evaluate the exact value of\n$$\nS_\\ell[d^{\\star}] \\;=\\; 2\\,\\Gamma_{\\ell}^{+}[d^{\\star}] \\;=\\; 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d^{\\star}(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d^{\\star}{}'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\nwhere $d^{\\star}$ denotes the stationary (minimizing) profile you obtained.\n\nExpress the final answer as a single exact number. No rounding is required. The quantity $S_\\ell[d^{\\star}]$ is dimensionless by construction, so no units are needed.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- The functional for the regularized crack surface density for $x>0$ is given by:\n$$\n\\Gamma_{\\ell}^{+}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x\n$$\n- The phase-field variable is $d(x)$, where $d(x) \\in [0,1]$.\n- The internal length scale is $\\ell > 0$.\n- The domain of integration is $x \\in [0, \\infty)$.\n- The boundary conditions are $d(0)=1$ and $\\lim_{x\\to\\infty} d(x)=0$.\n- The total crack surface measure is $S_\\ell[d] \\coloneqq 2\\,\\Gamma_{\\ell}^{+}[d]$.\n- The objective is to find the stationary profile $d^{\\star}(x)$ and evaluate $S_\\ell[d^{\\star}]$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses the Ambrosio–Tortorelli (AT2) model, a fundamental and widely accepted framework in the phase-field theory of fracture. It is a standard regularization of a sharp-interface crack problem. The functional is mathematically and physically sound.\n- **Well-Posed:** The problem is well-posed. It is a classic problem in the calculus of variations: minimizing a convex functional subject to well-defined boundary conditions. Such problems typically admit a unique and stable solution.\n- **Objective:** The problem is stated using precise mathematical language, with all terms explicitly defined.\n- **Verdict:** The problem is scientifically valid, well-posed, objective, and complete. It is a standard exercise in variational mechanics and contains no flaws.\n\n**Step 3: Proceed to Solution**\nThe problem requires finding the stationary path $d^{\\star}(x)$ that minimizes the functional $\\Gamma_{\\ell}^{+}[d]$ and then evaluating the total crack surface measure $S_\\ell[d^{\\star}]$. This is accomplished by using the Euler–Lagrange equation.\n\nThe integrand of the functional is\n$$\nL(d, d') = \\frac{1}{2\\,\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}\n$$\nwhere $d' \\equiv \\frac{\\mathrm{d}d}{\\mathrm{d}x}$. The Euler–Lagrange equation, which provides the stationarity condition, is\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0\n$$\nWe compute the necessary partial derivatives of $L$:\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{1}{2\\,\\ell}\\,(2d) = \\frac{d}{\\ell}\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\frac{\\ell}{2}\\,(2d') = \\ell\\,d'\n$$\nSubstituting these expressions into the Euler–Lagrange equation gives:\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\ell\\,d'\\right) = 0\n$$\n$$\n\\frac{d}{\\ell} - \\ell\\,d'' = 0\n$$\nRearranging this yields a second-order linear homogeneous ordinary differential equation with constant coefficients:\n$$\nd'' - \\frac{1}{\\ell^2}\\,d = 0\n$$\nThe characteristic equation for this ODE is $r^2 - \\frac{1}{\\ell^2} = 0$. The roots are $r_{1,2} = \\pm\\frac{1}{\\ell}$. The general solution is therefore\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nwhere $C_1$ and $C_2$ are constants to be determined from the boundary conditions.\n\nThe first boundary condition is $\\lim_{x\\to\\infty} d(x) = 0$. As $x \\to \\infty$, the term $\\exp\\left(\\frac{x}{\\ell}\\right)$ grows without bound. For the limit of $d(x)$ to be zero, its coefficient must be zero. Thus, we must have $C_1 = 0$. The solution simplifies to\n$$\nd(x) = C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nThe second boundary condition is $d(0)=1$. Applying this condition gives:\n$$\nd(0) = C_2 \\exp(0) = C_2 \\cdot 1 = C_2\n$$\nTherefore, $C_2 = 1$. The unique stationary profile $d^{\\star}(x)$ that satisfies the boundary conditions is\n$$\nd^{\\star}(x) = \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nNow, we must evaluate the total crack surface measure $S_\\ell[d^{\\star}]$:\n$$\nS_\\ell[d^{\\star}] = 2\\,\\Gamma_{\\ell}^{+}[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,(d^{\\star}(x))^{2} + \\frac{\\ell}{2}\\,\\big(d^{\\star}{}'(x)\\big)^{2} \\right)\\,\\mathrm{d}x\n$$\nWe need the terms $(d^{\\star}(x))^2$ and $(d^{\\star}{}'(x))^2$. First, we compute the derivative $d^{\\star}{}'(x)$:\n$$\nd^{\\star}{}'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right) = -\\frac{1}{\\ell}\\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nNow we square both $d^{\\star}(x)$ and $d^{\\star}{}'(x)$:\n$$\n(d^{\\star}(x))^2 = \\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right)^2 = \\exp\\left(-\\frac{2x}{\\ell}\\right)\n$$\n$$\n(d^{\\star}{}'(x))^2 = \\left(-\\frac{1}{\\ell}\\exp\\left(-\\frac{x}{\\ell}\\right)\\right)^2 = \\frac{1}{\\ell^2}\\exp\\left(-\\frac{2x}{\\ell}\\right)\n$$\nSubstitute these into the integral for $S_\\ell[d^{\\star}]$:\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) + \\frac{\\ell}{2}\\,\\frac{1}{\\ell^2}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right)\\,\\mathrm{d}x\n$$\nSimplify the integrand:\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) + \\frac{1}{2\\,\\ell}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right)\\,\\mathrm{d}x\n$$\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x\n$$\nWe can move the constant factor $\\frac{2}{\\ell}$ outside the integral:\n$$\nS_\\ell[d^{\\star}] = \\frac{2}{\\ell} \\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x\n$$\nNow we evaluate the definite integral:\n$$\n\\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x = \\left[ -\\frac{\\ell}{2}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right]_{0}^{\\infty}\n$$\n$$\n= \\lim_{x\\to\\infty}\\left(-\\frac{\\ell}{2}\\exp\\left(-\\frac{2x}{\\ell}\\right)\\right) - \\left(-\\frac{\\ell}{2}\\exp(0)\\right)\n$$\n$$\n= 0 - \\left(-\\frac{\\ell}{2}\\right) = \\frac{\\ell}{2}\n$$\nFinally, substitute this result back into the expression for $S_\\ell[d^{\\star}]$:\n$$\nS_\\ell[d^{\\star}] = \\frac{2}{\\ell} \\cdot \\left(\\frac{\\ell}{2}\\right) = 1\n$$\nThe value of the regularized surface energy for the optimal profile is exactly $1$, which is independent of the length scale parameter $\\ell$. This is a fundamental result demonstrating that the Ambrosio–Tortorelli functional correctly approximates the surface energy of a sharp crack, which is normalized to $1$ in this problem setup (corresponding to a single crack face of unit energy). The total measure $S_\\ell[d^\\star]$ accounts for two faces, but the integral was taken over $x \\in (0,\\infty)$, representing one side of a symmetric crack. The formulation $S_\\ell[d] = 2\\,\\Gamma_{\\ell}^{+}[d]$ correctly captures the energy of one half-crack of surface $1$. Had the integral been over $(-\\infty, \\infty)$ with $d(x)=\\exp(-|x|/\\ell)$, the result for the full crack would be $2$. The question as posed results in $1$. Wait, let me re-read the setup. $S_\\ell[d] = 2\\,\\Gamma_{\\ell}^{+}[d]$ models the *two* faces. $\\Gamma_{\\ell}^{+}[d]$ is on the half-domain. So the calculation represents the total energy.\nSo, $\\Gamma_{\\ell}^{+}[d^{\\star}] = \\frac{1}{2}$. Then $S_\\ell[d^{\\star}] = 2 \\times \\frac{1}{2} = 1$. The calculation is correct. My interpretation is correct. The result is $1$.", "answer": "$$\\boxed{1}$$", "id": "2929068"}, {"introduction": "Beyond describing existing cracks, a powerful feature of phase-field fracture models is their ability to predict crack nucleation without an ad-hoc criterion. This problem delves into the material's failure threshold by examining the stability of an undamaged state under loading. You will use principles of variational stability to determine the critical stress at which it becomes energetically favorable for damage to initiate [@problem_id:2929086]. This exercise demonstrates how the model's internal parameters, such as the fracture toughness $G_{c}$ and length scale $\\ell$, directly govern a macroscopic and measurable engineering property: the material's strength.", "problem": "Consider a one-dimensional slender bar of length $L$ and unit cross-sectional area made of a linear elastic brittle material, loaded in uniform tension so that the axial Green-Lagrange strain can be identified with the engineering strain $ \\varepsilon $ in the small-strain limit. The elastic energy density is $ \\psi_{e}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2} $, where $E$ is Young’s modulus. The material is modeled by a variational phase-field formulation of brittle fracture of the Ambrosio–Tortorelli type (AT1), with damage variable $ d \\in [0,1] $, degradation function $ g(d) = (1-d)^{2} $, and crack surface density functional characterized by the Griffith critical energy release rate $ G_{c} $ and the regularization length $ \\ell $. The total energy per unit cross-sectional area is\n$$\n\\Psi[d;\\varepsilon] \\,=\\, \\int_{0}^{L} \\left[ g(d)\\,\\psi_{e}(\\varepsilon) \\;+\\; G_{c}\\left( \\frac{d}{\\ell} \\;+\\; \\frac{\\ell}{2}\\,(d')^{2} \\right) \\right] \\,\\mathrm{d}x.\n$$\nAssume $ L \\gg \\ell $ so that boundary layers are negligible and analyze homogeneous perturbations of the undamaged state. Using first principles of variational stability under the unilateral damage irreversibility constraint $ d \\ge 0 $, determine the explicit expression for the critical axial Cauchy stress $ \\sigma_{c} $ at which the undamaged state $ d=0 $ loses local minimality to an infinitesimal homogeneous damage perturbation. For one-dimensional small-strain elasticity, you may use $ \\sigma = E \\varepsilon $.\n\nThen, evaluate $ \\sigma_{c} $ numerically for $ E = 50\\ \\mathrm{GPa} $, $ G_{c} = 2.4\\ \\mathrm{kJ/m^{2}} $, and $ \\ell = 0.30\\ \\mathrm{mm} $. Express your final stress in $ \\mathrm{MPa} $ and round your answer to four significant figures.", "solution": "The problem requires the determination of the critical stress for the initiation of damage in a one-dimensional bar, modeled using a phase-field approach to brittle fracture. The analysis is to be performed under the assumption of homogeneous damage perturbations.\n\nThe total energy of the system per unit cross-sectional area is given by the functional:\n$$\n\\Psi[d;\\varepsilon] \\,=\\, \\int_{0}^{L} \\left[ g(d)\\,\\psi_{e}(\\varepsilon) \\;+\\; G_{c}\\left( \\frac{d}{\\ell} \\;+\\; \\frac{\\ell}{2}\\,(d')^{2} \\right) \\right] \\,\\mathrm{d}x\n$$\nThe provided constitutive laws are the elastic energy density $\\psi_{e}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2}$ and the degradation function $g(d) = (1-d)^{2}$. The problem specifies an analysis of homogeneous perturbations of the undamaged state, $d=0$. A homogeneous field $d(x)$ is spatially constant, i.e., $d(x) = \\delta$ for some constant $\\delta$. Consequently, the derivative term vanishes, $d'(x) = 0$.\n\nUnder this simplification, the integrand becomes constant along the length $L$ of the bar. We can define an effective energy density $\\Phi$ (energy per unit volume) for a state of homogeneous strain $\\varepsilon$ and homogeneous damage $\\delta$:\n$$\n\\Phi(\\delta; \\varepsilon) = g(\\delta)\\psi_e(\\varepsilon) + G_c \\frac{\\delta}{\\ell}\n$$\nSubstituting the given forms for $g(d)$ and $\\psi_e(\\varepsilon)$ yields:\n$$\n\\Phi(\\delta; \\varepsilon) = (1-\\delta)^{2} \\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + G_c \\frac{\\delta}{\\ell}\n$$\nThe undamaged state corresponds to $\\delta=0$. We must investigate the stability of this state. In the calculus of variations, a state is a local minimum if the energy increases for any admissible infinitesimal perturbation. Here, the damage variable is subject to the unilateral irreversibility constraint $d \\ge 0$, which for our homogeneous analysis means $\\delta \\ge 0$.\n\nFor the state $\\delta=0$ to be a local minimum, the first variation of the energy with respect to an admissible perturbation must be non-negative. Admissible perturbations are of the form $\\delta > 0$. This requires the directional derivative of $\\Phi$ with respect to $\\delta$ at $\\delta=0$ to be non-negative. We compute the first derivative of $\\Phi$ with respect to $\\delta$:\n$$\n\\frac{\\partial \\Phi}{\\partial \\delta} = -2(1-\\delta) \\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + \\frac{G_c}{\\ell} = -2(1-\\delta)\\psi_e(\\varepsilon) + \\frac{G_c}{\\ell}\n$$\nEvaluating this at the undamaged state, $\\delta=0$:\n$$\n\\left. \\frac{\\partial \\Phi}{\\partial \\delta} \\right|_{\\delta=0} = -2\\psi_e(\\varepsilon) + \\frac{G_c}{\\ell}\n$$\nThe condition for local stability of the state $\\delta=0$ is therefore:\n$$\n\\left. \\frac{\\partial \\Phi}{\\partial \\delta} \\right|_{\\delta=0} \\ge 0 \\quad \\implies \\quad -2\\psi_e(\\varepsilon) + \\frac{G_c}{\\ell} \\ge 0\n$$\nThis simplifies to:\n$$\n\\psi_e(\\varepsilon) \\le \\frac{G_c}{2\\ell}\n$$\nThe undamaged state $d=0$ loses its local minimality when this condition is first violated. The critical point is therefore defined by the equality, which represents the threshold at which the driving force for damage exactly balances the resistance.\n$$\n\\psi_{e,c} = \\frac{G_c}{2\\ell}\n$$\nwhere $\\psi_{e,c}$ is the critical elastic energy density stored in the material at the onset of damage.\n\nTo find the critical stress $\\sigma_c$, we relate the elastic energy density $\\psi_e$ to the Cauchy stress $\\sigma$. For one-dimensional linear elasticity, $\\sigma = E\\varepsilon$, which implies $\\varepsilon = \\sigma/E$. Substituting this into the expression for $\\psi_e$:\n$$\n\\psi_e(\\sigma) = \\frac{1}{2}E \\left(\\frac{\\sigma}{E}\\right)^2 = \\frac{\\sigma^2}{2E}\n$$\nAt the critical condition, we have $\\psi_e(\\sigma_c) = \\psi_{e,c}$:\n$$\n\\frac{\\sigma_c^2}{2E} = \\frac{G_c}{2\\ell}\n$$\nSolving for the critical stress $\\sigma_c$ gives the analytical expression:\n$$\n\\sigma_c^2 = \\frac{E G_c}{\\ell} \\quad \\implies \\quad \\sigma_c = \\sqrt{\\frac{E G_c}{\\ell}}\n$$\nThis is the required explicit expression for the critical stress.\n\nNow, we evaluate this expression numerically with the provided data. The parameters must first be converted to base SI units.\nYoung's modulus: $E = 50\\ \\mathrm{GPa} = 50 \\times 10^9\\ \\mathrm{Pa}$.\nGriffith critical energy release rate: $G_c = 2.4\\ \\mathrm{kJ/m^2} = 2.4 \\times 10^3\\ \\mathrm{J/m^2}$.\nRegularization length: $\\ell = 0.30\\ \\mathrm{mm} = 0.30 \\times 10^{-3}\\ \\mathrm{m}$.\n\nSubstituting these values into the expression for $\\sigma_c$:\n$$\n\\sigma_c = \\sqrt{\\frac{(50 \\times 10^9\\ \\mathrm{Pa}) \\cdot (2.4 \\times 10^3\\ \\mathrm{J/m^2})}{0.30 \\times 10^{-3}\\ \\mathrm{m}}}\n$$\nThe units are consistent, as $(\\mathrm{Pa} \\cdot \\mathrm{J/m^2}) / \\mathrm{m} = (\\mathrm{N/m^2} \\cdot \\mathrm{N\\cdot m/m^2}) / \\mathrm{m} = (\\mathrm{N/m^2} \\cdot \\mathrm{N/m}) / \\mathrm{m} = \\mathrm{N^2/m^4} = \\mathrm{Pa^2}$.\n$$\n\\sigma_c = \\sqrt{\\frac{120 \\times 10^{12}}{0.30 \\times 10^{-3}}} \\ \\mathrm{Pa} = \\sqrt{400 \\times 10^{15}}\\ \\mathrm{Pa} = \\sqrt{4 \\times 10^{17}}\\ \\mathrm{Pa}\n$$\n$$\n\\sigma_c = 2 \\sqrt{10^{17}}\\ \\mathrm{Pa} = 2 \\sqrt{10 \\times 10^{16}}\\ \\mathrm{Pa} = 2 \\sqrt{10} \\times 10^8\\ \\mathrm{Pa}\n$$\nUsing the value $\\sqrt{10} \\approx 3.16227766$:\n$$\n\\sigma_c \\approx 2 \\times 3.16227766 \\times 10^8\\ \\mathrm{Pa} \\approx 6.32455532 \\times 10^8\\ \\mathrm{Pa}\n$$\nThe problem requires the answer in Megapascals ($\\mathrm{MPa}$), where $1\\ \\mathrm{MPa} = 10^6\\ \\mathrm{Pa}$.\n$$\n\\sigma_c \\approx 632.455532\\ \\mathrm{MPa}\n$$\nRounding to four significant figures, we obtain:\n$$\n\\sigma_c = 632.5\\ \\mathrm{MPa}\n$$", "answer": "$$\n\\boxed{632.5}\n$$", "id": "2929086"}, {"introduction": "Bridging the gap between analytical theory and computational practice is a vital skill for the modern engineer and scientist. While analytical solutions provide deep insight, most real-world scenarios demand numerical methods. This exercise tasks you with implementing a numerical approximation for the one-dimensional crack profile and its associated energy [@problem_id:2929057]. By discretizing the domain and using finite differences, you will explore how numerical parameters like mesh spacing and domain size affect the accuracy of the solution, providing a practical understanding of discretization error and mesh convergence.", "problem": "Consider a one-dimensional stationary crack represented by a scalar phase-field variable $d(x)$ on the domain $x \\in [-L,L]$. In the variational phase-field framework for brittle fracture using the Ambrosio-Tortorelli of second order (AT2) regularization, the fracture surface energy associated with a phase-field profile $d(x)$ is modeled by the functional\n$$\n\\Psi[d] \\;=\\; G_c \\int_{-L}^{L} \\left( \\frac{1}{2\\ell}\\, d(x)^2 \\;+\\; \\frac{\\ell}{2}\\, \\left(\\frac{d\\,d}{dx}\\right)^{\\!2} \\right)\\,dx,\n$$\nwhere $G_c$ is the critical energy release rate (mode I fracture toughness), and $\\ell$ is the internal length scale controlling the width of the diffuse crack. Assume a fully developed stationary crack centered at $x=0$, with the phase field satisfying $d(0)=1$ and $d(\\pm L)\\approx 0$, and $d(x)$ is nonnegative and symmetric about $x=0$.\n\nStarting from the calculus of variations, the stationary crack profile minimizes $\\Psi[d]$ subject to the stated symmetry and boundary conditions. Your task is to:\n- Derive the governing Euler-Lagrange equation for $d(x)$ and the corresponding minimizing profile on $(-\\infty,\\infty)$.\n- Use this minimizing profile to compute a discrete approximation of the normalized fracture energy,\n$$\n\\mathcal{E}_\\text{norm} \\;=\\; \\frac{1}{G_c}\\,\\Psi[d],\n$$\nover the finite interval $[-L,L]$.\n\nNumerical requirements for the program:\n- Use a uniform mesh on $[-L,L]$ with spacing $h$ such that the number of intervals is an integer, i.e., $N = \\frac{2L}{h} \\in \\mathbb{N}$. If necessary, adjust $h$ to $h_\\text{eff}=\\frac{2L}{N}$ with $N=\\text{round}\\!\\left(\\frac{2L}{h}\\right)$ to ensure exact coverage of the interval.\n- Evaluate the minimizing profile $d(x)$ at the mesh nodes.\n- Approximate the spatial derivative $\\frac{d\\,d}{dx}$ at the nodes using finite differences: use a central difference for interior nodes and one-sided differences for boundary nodes.\n- Approximate the integral in $\\Psi[d]$ using the composite trapezoidal rule over the mesh.\n- Report the normalized energy $\\mathcal{E}_\\text{norm}$ for each test case below.\n\nPhysical units:\n- Use $G_c$ in $\\mathrm{J/m}$, $\\ell$ and $L$ in $\\mathrm{m}$, and $h$ in $\\mathrm{m}$. Because you must report the normalized energy $\\mathcal{E}_\\text{norm}=\\Psi[d]/G_c$, the final answers are unitless.\n\nAngle units are not involved in this problem.\n\nTest suite:\n- Case A: $G_c = 2.7$, $\\ell = 0.01$, $L = 0.10$, $h = 0.001$.\n- Case B: $G_c = 2.7$, $\\ell = 0.01$, $L = 0.005$, $h = 0.0005$.\n- Case C: $G_c = 2.7$, $\\ell = 0.02$, $L = 0.20$, $h = 0.02$.\n- Case D: $G_c = 2.7$, $\\ell = 0.005$, $L = 0.05$, $h = 0.001$.\n\nDesign for coverage:\n- Case A probes a well-resolved crack with a large domain relative to $\\ell$.\n- Case B tests truncation effects due to a small domain relative to $\\ell$.\n- Case C tests coarse mesh resolution where $h$ is comparable to $\\ell$.\n- Case D tests a moderate resolution with a large domain relative to $\\ell$.\n\nYour program must produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, with each number rounded to six decimal places, for example:\n\"[1.000000,0.950000,0.990000,1.000000]\"\n\nYour program must be fully self-contained and must not require any user input or external files. The results are unitless floats.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in the principles of variational fracture mechanics, is mathematically well-posed, and provides a complete and unambiguous set of data and instructions for its solution. The task is to derive the stationary crack profile for the given Ambrosio-Tortorelli energy functional and then to numerically compute the normalized energy for specified parameters. The procedure is non-trivial and requires both analytical derivation and numerical implementation, making it a substantive problem.\n\nThe analysis proceeds in two stages: first, the analytical derivation of the optimal phase-field profile, and second, the description of the numerical scheme for its approximation.\n\nThe fracture surface energy is given by the functional:\n$$\n\\Psi[d] \\;=\\; G_c \\int_{-L}^{L} \\left( \\frac{1}{2\\ell}\\, d(x)^2 \\;+\\; \\frac{\\ell}{2}\\, \\left(\\frac{d\\,d}{dx}\\right)^{\\!2} \\right)\\,dx\n$$\nWe seek to find the function $d(x)$ that minimizes this functional. The integrand, $\\mathcal{L}(d, d') = G_c \\left( \\frac{1}{2\\ell}\\, d(x)^2 + \\frac{\\ell}{2}\\, (d'(x))^2 \\right)$, where $d' = \\frac{d\\,d}{dx}$, is the Lagrangian density. The minimizing function must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} - \\frac{d}{dx} \\left( \\frac{\\partial \\mathcal{L}}{\\partial d'} \\right) = 0\n$$\nFirst, we compute the partial derivatives of the Lagrangian $\\mathcal{L}$:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} = G_c \\left( \\frac{1}{2\\ell} \\cdot 2d \\right) = G_c \\frac{d}{\\ell}\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d'} = G_c \\left( \\frac{\\ell}{2} \\cdot 2d' \\right) = G_c \\ell d'\n$$\nSubstituting these into the Euler-Lagrange equation yields:\n$$\nG_c \\frac{d}{\\ell} - \\frac{d}{dx} \\left( G_c \\ell d' \\right) = 0\n$$\nSince $G_c$ and $\\ell$ are non-zero constants, we can simplify the equation by dividing by $G_c$:\n$$\n\\frac{d}{\\ell} - \\ell d'' = 0\n$$\nRearranging gives the second-order homogeneous linear ordinary differential equation:\n$$\nd''(x) - \\frac{1}{\\ell^2} d(x) = 0\n$$\nThe problem asks for the profile on the infinite domain $(-\\infty, \\infty)$ that is symmetric, satisfies $d(0)=1$, and vanishes at infinity, $d(x) \\to 0$ as $|x| \\to \\infty$. To find such a solution, we consider the domain $x \\ge 0$ due to symmetry. The general solution to the ODE is $d(x) = C_1 e^{x/\\ell} + C_2 e^{-x/\\ell}$.\nThe boundary conditions on $[0, \\infty)$ are:\n1. $d(0) = 1$\n2. $\\lim_{x\\to\\infty} d(x) = 0$\n\nFrom the second condition, as $x \\to \\infty$, the term $e^{x/\\ell}$ grows without bound. To ensure the limit is zero, its coefficient $C_1$ must be zero. The solution form thus reduces to $d(x) = C_2 e^{-x/\\ell}$.\nApplying the first condition at $x=0$:\n$$\nd(0) = C_2 e^0 = C_2 = 1\n$$\nSo, for $x \\ge 0$, the solution is $d(x) = e^{-x/\\ell}$. By the symmetry requirement, $d(x) = d(-x)$, the solution for all $x \\in (-\\infty, \\infty)$ is:\n$$\nd(x) = e^{-|x|/\\ell}\n$$\nThis is the optimal one-dimensional crack profile. Note that this function has a discontinuous first derivative at $x=0$, and as such, it is a weak solution to the Euler-Lagrange equation.\n\nFor completeness, we can verify that this ideal profile on an infinite domain yields a total fracture energy of $G_c$, meaning the normalized energy is $1$. The derivative for $x \\neq 0$ is $d'(x) = -\\frac{1}{\\ell} \\text{sgn}(x) e^{-|x|/\\ell}$. Its square is $(d'(x))^2 = \\frac{1}{\\ell^2} e^{-2|x|/\\ell}$.\nThe normalized energy on $(-\\infty, \\infty)$ is:\n$$\n\\mathcal{E}_\\text{norm} = \\frac{1}{G_c} \\Psi[d] = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2\\ell} (e^{-|x|/\\ell})^2 + \\frac{\\ell}{2} \\left(-\\frac{\\text{sgn}(x)}{\\ell} e^{-|x|/\\ell}\\right)^2 \\right) dx\n$$\n$$\n\\mathcal{E}_\\text{norm} = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2\\ell} e^{-2|x|/\\ell} + \\frac{\\ell}{2\\ell^2} e^{-2|x|/\\ell} \\right) dx = \\int_{-\\infty}^{\\infty} \\frac{1}{\\ell} e^{-2|x|/\\ell} dx\n$$\nUsing symmetry, this becomes:\n$$\n\\mathcal{E}_\\text{norm} = 2 \\int_{0}^{\\infty} \\frac{1}{\\ell} e^{-2x/\\ell} dx = 2 \\left[ -\\frac{1}{2} e^{-2x/\\ell} \\right]_{0}^{\\infty} = 2 \\left( 0 - \\left(-\\frac{1}{2}\\right) \\right) = 1\n$$\nThis confirms the analytical solution is correct. The numerical task is to evaluate this energy on a finite domain $[-L, L]$ using numerical approximations.\n\nThe numerical implementation follows these steps for each test case:\n1.  **Discretize the Domain**: The interval $[-L, L]$ is discretized into $N$ subintervals, where $N = \\text{round}(2L/h)$. The effective mesh spacing is $h_\\text{eff} = \\frac{2L}{N}$. The grid points are $x_i = -L + i \\cdot h_\\text{eff}$ for $i=0, 1, \\dots, N$.\n2.  **Evaluate the Profile**: The analytical solution $d(x) = e^{-|x|/\\ell}$ is evaluated at each grid point $x_i$ to obtain the discrete values $d_i = d(x_i)$.\n3.  **Approximate the Derivative**: The derivative $d'(x)$ is approximated at each node $x_i$ to get values $d'_i$.\n    -   At the left boundary ($i=0$): a first-order forward difference is used: $d'_0 = \\frac{d_1 - d_0}{h_\\text{eff}}$.\n    -   At the interior nodes ($i=1, \\dots, N-1$): a second-order central difference is used: $d'_i = \\frac{d_{i+1} - d_{i-1}}{2 h_\\text{eff}}$.\n    -   At the right boundary ($i=N$): a first-order backward difference is used: $d'_N = \\frac{d_N - d_{N-1}}{h_\\text{eff}}$.\n4.  **Compute the Integral**: The normalized energy $\\mathcal{E}_\\text{norm}$ is computed by approximating the integral using the composite trapezoidal rule. The integrand function is $f(x) = \\frac{1}{2\\ell} d(x)^2 + \\frac{\\ell}{2} (d'(x))^2$. The discrete values of the integrand, $f_i = \\frac{1}{2\\ell} d_i^2 + \\frac{\\ell}{2} (d'_i)^2$, are calculated at each node. The integral is then approximated as:\n$$\n\\mathcal{E}_\\text{norm} = \\int_{-L}^{L} f(x) dx \\approx \\sum_{i=0}^{N-1} \\frac{f_i + f_{i+1}}{2} h_\\text{eff}\n$$\nThis procedure will be implemented for each test case to produce the required results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_normalized_energy(l: float, L: float, h: float) -> float:\n    \"\"\"\n    Computes the discrete approximation of the normalized fracture energy.\n\n    Args:\n        l: The internal length scale.\n        L: The half-width of the domain [-L, L].\n        h: The initial mesh spacing.\n\n    Returns:\n        The computed normalized energy, a unitless float.\n    \"\"\"\n    # Step 1: Mesh Generation\n    # Adjust h to ensure the number of intervals is an integer and covers the domain exactly.\n    if 2 * L == 0:\n        return 0.0\n    num_intervals = round(2 * L / h)\n    \n    # Handle edge case where num_intervals could be zero for very coarse h.\n    if num_intervals == 0:\n        num_intervals = 1\n        \n    h_eff = 2 * L / num_intervals\n    num_points = num_intervals + 1\n    x = np.linspace(-L, L, num_points)\n\n    # Step 2: Evaluate the minimizing profile d(x) = exp(-|x|/l)\n    d = np.exp(-np.abs(x) / l)\n\n    # Step 3: Approximate the spatial derivative d'(x) using finite differences\n    dd_dx = np.zeros_like(x)\n\n    if num_points > 1:\n        # Central difference for interior nodes\n        if num_points > 2:\n            dd_dx[1:-1] = (d[2:] - d[:-2]) / (2 * h_eff)\n        \n        # One-sided forward difference for the left boundary node\n        dd_dx[0] = (d[1] - d[0]) / h_eff\n        \n        # One-sided backward difference for the right boundary node\n        dd_dx[-1] = (d[-1] - d[-2]) / h_eff\n    \n    # Step 4: Evaluate the integrand of the normalized energy functional\n    # Integrand = (1/(2l)) * d^2 + (l/2) * (d')^2\n    integrand = (d**2 / (2 * l)) + (l / 2) * (dd_dx**2)\n\n    # Step 5: Approximate the integral using the composite trapezoidal rule\n    E_norm = np.trapz(integrand, x)\n\n    return E_norm\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test cases: (Gc, l, L, h)\n    # Gc is not needed for the normalized energy calculation.\n    test_cases = [\n        # Case A: Gc = 2.7, l = 0.01, L = 0.10, h = 0.001\n        (0.01, 0.10, 0.001), \n        # Case B: Gc = 2.7, l = 0.01, L = 0.005, h = 0.0005\n        (0.01, 0.005, 0.0005),\n        # Case C: Gc = 2.7, l = 0.02, L = 0.20, h = 0.02\n        (0.02, 0.20, 0.02),\n        # Case D: Gc = 2.7, l = 0.005, L = 0.05, h = 0.001\n        (0.005, 0.05, 0.001)\n    ]\n\n    results = []\n    for case in test_cases:\n        l, L, h = case\n        result = calculate_normalized_energy(l, L, h)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format string \"{:.6f}\" handles rounding to six decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2929057"}]}