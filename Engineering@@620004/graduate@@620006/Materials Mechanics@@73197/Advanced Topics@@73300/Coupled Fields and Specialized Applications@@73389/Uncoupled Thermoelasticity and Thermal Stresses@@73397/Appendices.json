{"hands_on_practices": [{"introduction": "Understanding how thermal stresses arise in constrained structures is a cornerstone of thermoelastic analysis. This first practice provides a foundational exercise in this area by examining a statically indeterminate composite bar. By applying the fundamental principles of equilibrium, kinematic compatibility, and the linear thermoelastic constitutive law, you will calculate the compressive force generated in a constrained assembly due to a uniform temperature change. Mastering this type of problem [@problem_id:2928446] is essential for developing the intuition and analytical skills needed to tackle more complex engineering systems where thermal expansion cannot be ignored.", "problem": "A straight prismatic composite bar consists of two coaxial segments joined end-to-end between two perfectly rigid, immovable supports that are a fixed distance apart. Segment 1 has length $L_{1}$, cross-sectional area $A_{1}$, Young’s modulus $E_{1}$, and coefficient of linear thermal expansion $\\alpha_{1}$. Segment 2 has length $L_{2}$, cross-sectional area $A_{2}$, Young’s modulus $E_{2}$, and coefficient of linear thermal expansion $\\alpha_{2}$. At a reference temperature $T_{0}$ the assembly is stress-free and exactly fits between the supports. Then the entire bar is subjected to a uniform temperature increase $\\Delta T$ while the supports remain fixed and do not thermally expand. Assume the uncoupled, linear thermoelastic regime: the temperature field is prescribed (no feedback from stress), thermal strain is $\\alpha \\,\\Delta T$, and total small strain equals the sum of mechanical and thermal contributions. Neglect body forces and any slip or clearance at the joints.\n\nUsing only equilibrium, kinematic compatibility, and the linear thermoelastic constitutive law, write down the governing equations and solve for the common axial force that develops in the bar. Report the magnitude of the reaction force at the left support, noting that the two support reactions are equal in magnitude. Use the following data, which correspond to a scientifically plausible dissimilar-material assembly:\n- $L_{1} = 0.60\\,\\mathrm{m}$, $A_{1} = 3.0\\times 10^{-4}\\,\\mathrm{m}^{2}$, $E_{1} = 70\\times 10^{9}\\,\\mathrm{Pa}$, $\\alpha_{1} = 23\\times 10^{-6}\\,\\mathrm{K}^{-1}$.\n- $L_{2} = 0.40\\,\\mathrm{m}$, $A_{2} = 2.0\\times 10^{-4}\\,\\mathrm{m}^{2}$, $E_{2} = 200\\times 10^{9}\\,\\mathrm{Pa}$, $\\alpha_{2} = 12\\times 10^{-6}\\,\\mathrm{K}^{-1}$.\n- $\\Delta T = 60\\,\\mathrm{K}$.\n\nExpress your final answer in kilonewtons (kN) and round to four significant figures.", "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\nThe following data and conditions are provided:\n- For segment 1:\n  - Length: $L_{1} = 0.60\\,\\mathrm{m}$\n  - Cross-sectional area: $A_{1} = 3.0 \\times 10^{-4}\\,\\mathrm{m}^{2}$\n  - Young’s modulus: $E_{1} = 70 \\times 10^{9}\\,\\mathrm{Pa}$\n  - Coefficient of linear thermal expansion: $\\alpha_{1} = 23 \\times 10^{-6}\\,\\mathrm{K}^{-1}$\n- For segment 2:\n  - Length: $L_{2} = 0.40\\,\\mathrm{m}$\n  - Cross-sectional area: $A_{2} = 2.0 \\times 10^{-4}\\,\\mathrm{m}^{2}$\n  - Young’s modulus: $E_{2} = 200 \\times 10^{9}\\,\\mathrm{Pa}$\n  - Coefficient of linear thermal expansion: $\\alpha_{2} = 12 \\times 10^{-6}\\,\\mathrm{K}^{-1}$\n- Temperature change: $\\Delta T = 60\\,\\mathrm{K}$\n- Initial condition: The assembly is stress-free at the reference temperature $T_{0}$.\n- Boundary conditions: The bar is held between perfectly rigid, immovable supports.\n- Assumptions: Uncoupled, linear thermoelasticity is assumed. Body forces are neglected. The joint is perfect.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated for validity:\n- **Scientifically Grounded:** The problem is a standard exercise in one-dimensional linear thermoelasticity, a core topic within continuum mechanics and materials science. The concepts of thermal stress, strain compatibility, and constitutive laws are fundamental principles. The material properties provided are realistic (segment $1$ behaves like an aluminum alloy, segment $2$ like steel).\n- **Well-Posed:** The problem is a statically indeterminate system. However, the combination of equilibrium equations, kinematic compatibility conditions (zero total displacement), and constitutive relations provides a sufficient number of equations to determine a unique solution for the unknown internal force. All necessary data are provided.\n- **Objective:** The problem statement is written in precise, quantitative, and unambiguous technical language. It is free of subjective or non-scientific claims.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\nThe solution to this problem requires the application of three fundamental principles of mechanics of materials: static equilibrium, kinematic compatibility, and the constitutive law for a thermoelastic material.\n\n1.  **Equilibrium:** The composite bar is in static equilibrium under the action of the support reactions. For a one-dimensional problem with no external forces along the length, the internal axial force, which we denote as $P$, must be constant throughout the entire bar. Let us adopt the convention that a positive force $P$ is tensile and a negative force is compressive. The reaction forces at the supports are equal in magnitude to this internal force.\n\n2.  **Kinematic Compatibility:** The supports are defined as perfectly rigid and immovable. This imposes a kinematic constraint on the system: the total change in length (elongation) of the composite bar must be zero. The total elongation, $\\delta_{total}$, is the sum of the elongations of segment $1$ ($\\delta_1$) and segment $2$ ($\\delta_2$).\n    $$ \\delta_{total} = \\delta_1 + \\delta_2 = 0 $$\n\n3.  **Constitutive Law:** For a linear thermoelastic material, the total strain $\\epsilon$ is the sum of the mechanical strain $\\epsilon_m$ and the thermal strain $\\epsilon_T$. The mechanical strain is governed by Hooke's Law, $\\epsilon_m = \\sigma / E$, where $\\sigma$ is the axial stress and $E$ is Young's modulus. The stress is $\\sigma = P / A$, with $A$ being the cross-sectional area. The thermal strain is given by $\\epsilon_T = \\alpha \\Delta T$, where $\\alpha$ is the coefficient of linear thermal expansion and $\\Delta T$ is the uniform temperature change. The total elongation $\\delta$ of a segment of length $L$ is $\\delta = \\epsilon L$. Combining these gives the expression for the total elongation of a segment:\n    $$ \\delta = \\left( \\frac{\\sigma}{E} + \\alpha \\Delta T \\right) L = \\left( \\frac{P}{AE} + \\alpha \\Delta T \\right) L = \\frac{PL}{AE} + \\alpha L \\Delta T $$\n\nBy applying this constitutive relation to each segment of the bar, we obtain:\n$$ \\delta_1 = \\frac{P L_1}{A_1 E_1} + \\alpha_1 L_1 \\Delta T $$\n$$ \\delta_2 = \\frac{P L_2}{A_2 E_2} + \\alpha_2 L_2 \\Delta T $$\n\nSubstituting these expressions into the compatibility equation $\\delta_1 + \\delta_2 = 0$ yields the governing equation for the system:\n$$ \\left( \\frac{P L_1}{A_1 E_1} + \\alpha_1 L_1 \\Delta T \\right) + \\left( \\frac{P L_2}{A_2 E_2} + \\alpha_2 L_2 \\Delta T \\right) = 0 $$\nWe can now solve for the internal force $P$:\n$$ P \\left( \\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2} \\right) = - (\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T $$\n$$ P = - \\frac{(\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T}{\\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2}} $$\nThe negative sign confirms that the internal force is compressive, as the temperature increase causes the bar to push against the fixed supports. The problem asks for the magnitude of the reaction force at the left support, $R$, which is equal to the magnitude of the internal force, $R = |P|$.\n$$ R = \\frac{(\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T}{\\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2}} $$\n\nNow, substitute the provided numerical values. It is methodical to compute the numerator and denominator separately.\nThe numerator represents the total unconstrained thermal expansion:\n$$ \\text{Numerator} = (\\alpha_1 L_1 + \\alpha_2 L_2) \\Delta T = \\left( (23 \\times 10^{-6}\\,\\mathrm{K}^{-1})(0.60\\,\\mathrm{m}) + (12 \\times 10^{-6}\\,\\mathrm{K}^{-1})(0.40\\,\\mathrm{m}) \\right) (60\\,\\mathrm{K}) $$\n$$ = (1.38 \\times 10^{-5}\\,\\mathrm{m} + 0.48 \\times 10^{-5}\\,\\mathrm{m}) (60) = (1.86 \\times 10^{-5}\\,\\mathrm{m})(60) = 1.116 \\times 10^{-3}\\,\\mathrm{m} $$\nThe denominator represents the sum of the mechanical compliances of the two segments:\n$$ \\frac{L_1}{A_1 E_1} = \\frac{0.60\\,\\mathrm{m}}{(3.0 \\times 10^{-4}\\,\\mathrm{m}^2)(70 \\times 10^9\\,\\mathrm{Pa})} = \\frac{0.60}{2.1 \\times 10^7}\\,\\mathrm{m/N} \\approx 2.85714 \\times 10^{-8}\\,\\mathrm{m/N} $$\n$$ \\frac{L_2}{A_2 E_2} = \\frac{0.40\\,\\mathrm{m}}{(2.0 \\times 10^{-4}\\,\\mathrm{m}^2)(200 \\times 10^9\\,\\mathrm{Pa})} = \\frac{0.40}{4.0 \\times 10^7}\\,\\mathrm{m/N} = 1.0 \\times 10^{-8}\\,\\mathrm{m/N} $$\n$$ \\text{Denominator} = \\frac{L_1}{A_1 E_1} + \\frac{L_2}{A_2 E_2} \\approx (2.85714 + 1.0) \\times 10^{-8}\\,\\mathrm{m/N} = 3.85714 \\times 10^{-8}\\,\\mathrm{m/N} $$\nThe magnitude of the reaction force $R$ is the ratio of these two quantities:\n$$ R = \\frac{1.116 \\times 10^{-3}\\,\\mathrm{m}}{3.85714 \\times 10^{-8}\\,\\mathrm{m/N}} \\approx 28933.3\\,\\mathrm{N} $$\nThe problem requires the answer in kilonewtons (kN), rounded to $4$ significant figures.\n$$ R = 28.9333\\,\\mathrm{kN} \\approx 28.93\\,\\mathrm{kN} $$", "answer": "$$\\boxed{28.93}$$", "id": "2928446"}, {"introduction": "Building upon the analysis of discrete components, this practice advances to the study of continuous systems, which are central to the design of functionally graded materials (FGMs). Here, you will derive the stress field in a bar where both material stiffness $E(x)$ and thermal expansion coefficient $\\alpha(x)$ vary continuously along the length, subjected to a non-uniform temperature field. This exercise [@problem_id:2928462] requires formulating the compatibility condition in an integral form, providing a powerful analytical framework for predicting the behavior of materials with tailored, spatially-dependent properties.", "problem": "A straight, slender bar of length $L$ occupies the interval $x \\in [0,L]$ along its axis. The bar is nonuniform: its Young’s modulus $E(x)$ and cross-sectional area $A(x)$ are smooth, positive functions of $x$. The bar is constrained by perfectly rigid supports at both ends so that the axial displacement satisfies $u(0)=0$ and $u(L)=0$. There are no external mechanical tractions or axial body forces. Under the uncoupled thermoelasticity assumption, the temperature field is prescribed and unaffected by mechanical response. The bar is subjected to a linear temperature distribution $T(x) = T_{0} + \\beta x$, where $T_{0}$ and $\\beta$ are constants, and the stress-free reference temperature is $T_{\\mathrm{ref}} = T_{0}$. The coefficient of linear thermal expansion is constant and equal to $\\alpha_{0}$. Assume small strains and the one-dimensional (1D) kinematics and constitutive response appropriate to a slender axially loaded member.\n\nStarting from the fundamentals of one-dimensional thermoelasticity—namely, mechanical equilibrium in the absence of body forces, the strain–displacement relation, and the linear thermoelastic constitutive relation—derive a closed-form expression for the axial Cauchy stress field $\\sigma(x)$ in terms of $x$, $L$, $\\beta$, $\\alpha_{0}$, $E(x)$, and $A(x)$. Express your final answer for $\\sigma(x)$ in Pascals. Do not substitute any numerical values; provide a symbolic expression only. The final answer must be a single analytic expression for $\\sigma(x)$.", "solution": "The problem is to determine the axial stress field $\\sigma(x)$ in a non-uniform bar fixed at both ends and subjected to a linear temperature distribution. The problem is approached using the fundamental principles of one-dimensional (1D) thermoelasticity for a slender bar.\n\nFirst, we establish the governing equations.\n1.  **Mechanical Equilibrium**: In the absence of axial body forces, the 1D equilibrium equation is given by\n    $$ \\frac{dP(x)}{dx} = 0 $$\n    where $P(x)$ is the internal axial force at a cross-section at position $x$. This equation implies that the axial force $P(x)$ must be constant along the entire length of the bar. Let us denote this constant force by $F$, so $P(x) = F$. The axial force is related to the axial Cauchy stress $\\sigma(x)$ and the cross-sectional area $A(x)$ by $P(x) = \\sigma(x) A(x)$. Therefore, we have\n    $$ \\sigma(x) A(x) = F $$\n    This is a statically indeterminate problem, and the constant reaction force $F$ must be determined from compatibility and boundary conditions. From this relation, we can express the stress as\n    $$ \\sigma(x) = \\frac{F}{A(x)} $$\n\n2.  **Strain-Displacement Relation**: For small deformations, the axial strain $\\epsilon(x)$ is related to the axial displacement $u(x)$ by\n    $$ \\epsilon(x) = \\frac{du(x)}{dx} $$\n\n3.  **Constitutive Relation**: The 1D linear thermoelastic constitutive relation states that the total strain $\\epsilon(x)$ is the sum of the mechanical strain $\\epsilon_{\\text{mech}}(x)$ and the thermal strain $\\epsilon_{\\text{th}}(x)$.\n    $$ \\epsilon(x) = \\epsilon_{\\text{mech}}(x) + \\epsilon_{\\text{th}}(x) $$\n    The mechanical strain is given by Hooke's law, $\\epsilon_{\\text{mech}}(x) = \\sigma(x) / E(x)$, where $E(x)$ is the Young's modulus. The thermal strain is given by $\\epsilon_{\\text{th}}(x) = \\alpha_{0} \\Delta T(x)$, where $\\alpha_{0}$ is the coefficient of linear thermal expansion and $\\Delta T(x)$ is the change in temperature from the stress-free reference temperature $T_{\\text{ref}}$.\n    Given the temperature field $T(x) = T_{0} + \\beta x$ and the reference temperature $T_{\\text{ref}} = T_{0}$, the temperature change is\n    $$ \\Delta T(x) = T(x) - T_{\\text{ref}} = (T_{0} + \\beta x) - T_{0} = \\beta x $$\n    Combining these, the total strain is\n    $$ \\epsilon(x) = \\frac{\\sigma(x)}{E(x)} + \\alpha_{0} \\beta x $$\n\nNow, we use the boundary conditions to find the unknown force $F$. The bar is constrained by rigid supports at both ends, so the displacement $u(x)$ satisfies $u(0)=0$ and $u(L)=0$. The total change in length of the bar is the integral of the axial strain over its length:\n$$ \\Delta L = u(L) - u(0) = \\int_{0}^{L} \\epsilon(x) dx $$\nGiven the boundary conditions, the total change in length is zero:\n$$ u(L) - u(0) = 0 - 0 = 0 $$\nThis provides the compatibility equation for this problem:\n$$ \\int_{0}^{L} \\epsilon(x) dx = 0 $$\nWe substitute the expression for the total strain into this compatibility equation:\n$$ \\int_{0}^{L} \\left( \\frac{\\sigma(x)}{E(x)} + \\alpha_{0} \\beta x \\right) dx = 0 $$\nNext, we substitute the expression for stress, $\\sigma(x) = F/A(x)$:\n$$ \\int_{0}^{L} \\left( \\frac{F}{A(x)E(x)} + \\alpha_{0} \\beta x \\right) dx = 0 $$\nWe can separate the integral into two parts:\n$$ \\int_{0}^{L} \\frac{F}{A(x)E(x)} dx + \\int_{0}^{L} \\alpha_{0} \\beta x dx = 0 $$\nSince $F$, $\\alpha_{0}$, and $\\beta$ are constants, we can move them outside the integrals:\n$$ F \\int_{0}^{L} \\frac{1}{A(x)E(x)} dx + \\alpha_{0} \\beta \\int_{0}^{L} x dx = 0 $$\nEvaluating the second integral gives:\n$$ \\int_{0}^{L} x dx = \\left[ \\frac{x^{2}}{2} \\right]_{0}^{L} = \\frac{L^{2}}{2} $$\nSubstituting this back into the equation for $F$:\n$$ F \\int_{0}^{L} \\frac{dx}{A(x)E(x)} + \\alpha_{0} \\beta \\frac{L^{2}}{2} = 0 $$\nNow, we can solve for the constant reaction force $F$:\n$$ F = - \\frac{\\alpha_{0} \\beta \\frac{L^{2}}{2}}{\\int_{0}^{L} \\frac{dx}{A(x)E(x)}} $$\nFinally, to find the stress field $\\sigma(x)$, we substitute this expression for $F$ back into the relation $\\sigma(x) = F/A(x)$. To avoid confusion between the variable of integration and the position variable $x$, we use a dummy variable $\\xi$ for integration:\n$$ \\sigma(x) = \\frac{1}{A(x)} \\left( - \\frac{\\alpha_{0} \\beta L^{2}}{2 \\int_{0}^{L} \\frac{d\\xi}{A(\\xi)E(\\xi)}} \\right) $$\nThis gives the final expression for the axial stress distribution in the bar:\n$$ \\sigma(x) = - \\frac{\\alpha_{0} \\beta L^{2}}{2 A(x) \\int_{0}^{L} \\frac{d\\xi}{A(\\xi)E(\\xi)}} $$\nThis expression represents the compressive stress developed in the constrained bar due to the thermal expansion. The negative sign indicates compression, which is physically expected since the bar is heated (for $\\beta > 0$) and prevented from elongating.", "answer": "$$\n\\boxed{-\\frac{\\alpha_{0} \\beta L^{2}}{2 A(x) \\int_{0}^{L} \\frac{d\\xi}{A(\\xi)E(\\xi)}}}\n$$", "id": "2928462"}, {"introduction": "While analytical solutions offer deep insight, most real-world thermoelastic problems involving complex geometries and material distributions require computational methods. This final practice guides you through the development of a one-dimensional finite element method (FEM) solver, the preeminent tool in modern structural analysis. You will begin from the principle of virtual work to derive the weak form and implement a code capable of handling functionally graded materials under thermal loading [@problem_id:2928435]. This hands-on implementation bridges the gap between abstract theory and practical problem-solving, equipping you with a versatile and powerful skill for engineering design and research.", "problem": "Implement a one-dimensional finite element method for uncoupled thermoelasticity in a functionally graded material where both the Young’s modulus $E(x)$ and the coefficient of thermal expansion $\\alpha(x)$ vary in space. The goal is to demonstrate, from first principles, how spatially varying coefficients are consistently incorporated at the element level and assembled into the global system under thermal loading. Start from the following fundamental bases only: kinematics $ \\varepsilon(x) = du/dx $, linear momentum balance in one dimension with no body forces, and linear thermoelastic constitutive behavior $ \\sigma(x) = E(x)\\left(\\varepsilon(x) - \\alpha(x)\\Delta T\\right) $, where $ \\Delta T $ is a prescribed temperature change field that is independent of the mechanical solution (uncoupled thermoelasticity). Use the principle of virtual work to derive the weak form and the corresponding finite element discretization with linear shape functions. Do not use any shortcut formulas that skip the derivation path from these bases.\n\nImplement the element stiffness and thermal load using numerical quadrature that evaluates $E(x)$ and $\\alpha(x)$ at quadrature points inside each element. Assemble the global stiffness and thermal load, impose the specified boundary conditions, solve for the nodal displacements, and post-process the axial stress field. In all cases, the cross-sectional area $A$ is constant and the bar is prismatic.\n\nYour program must compute the following three test cases and report the requested quantities. Use linear two-node elements, uniform mesh with $N = 400$ elements over the length, and Gaussian quadrature with $3$ points per element for all integrals. The spatial coordinate $x$ runs from $x=0$ to $x=L$.\n\nCommon parameters for all tests:\n- Length $L = 1.0$ m, area $A = 1.0\\times 10^{-4}$ m$^2$, base modulus $E_0 = 2.10\\times 10^{11}$ Pa, base thermal expansion coefficient $\\alpha_0 = 12.0\\times 10^{-6}$ K$^{-1}$.\n\nTest case 1 (free thermal expansion under graded properties):\n- Material gradation: $E(x) = E_0\\left(1 + 0.5\\,x/L\\right)$, $\\alpha(x) = \\alpha_0\\left(1 + 0.5\\,x/L\\right)$.\n- Temperature change: $\\Delta T = 100.0$ K.\n- Boundary conditions: $u(0)=0$ at $x=0$ (clamped), traction-free at $x=L$.\n- Quantity to validate: the free-end displacement $u(L)$ obtained from the finite element solution must be compared to the exact value implied by zero stress everywhere under traction-free conditions at $x=L$. Report the absolute relative error, a dimensionless float.\n\nTest case 2 (both ends fixed, no external traction):\n- Material gradation: $E(x) = E_0\\left(1 + 0.8\\,x/L\\right)^2$, $\\alpha(x) = \\alpha_0\\left(1 + 0.3\\,x/L\\right)$.\n- Temperature change: $\\Delta T = 40.0$ K.\n- Boundary conditions: $u(0)=0$ at $x=0$ and $u(L)=0$ at $x=L$.\n- Quantity to validate: the spatial mean axial stress $\\bar{\\sigma} = \\frac{1}{L}\\int_{0}^{L}\\sigma(x)\\,dx$ from the finite element solution must be compared to the exact constant stress implied by equilibrium and compatibility. Report the absolute relative error, a dimensionless float.\n\nTest case 3 (clamped left end, applied end traction at right):\n- Material gradation: $E(x) = E_0\\exp\\!\\left(1.2\\,x/L\\right)$, $\\alpha(x) = \\alpha_0\\left(1 + 0.4\\,x/L\\right)$.\n- Temperature change: $\\Delta T = 50.0$ K.\n- Boundary conditions and loading: $u(0)=0$ at $x=0$, and a prescribed axial traction $t = 50.0\\times 10^{6}$ Pa applied at $x=L$.\n- Quantity to validate: the free-end displacement $u(L)$ from the finite element solution must be compared to the exact value implied by equilibrium with constant axial stress equal to $t$. Report the absolute relative error, a dimensionless float.\n\nPrecise outputs to produce:\n- For Test case $1$: output a single float equal to the absolute relative error between the computed $u(L)$ (in m) and the exact reference $u(L)$ (in m).\n- For Test case $2$: output a single float equal to the absolute relative error between the computed $\\bar{\\sigma}$ (in Pa) and the exact reference $\\sigma$ (in Pa).\n- For Test case $3$: output a single float equal to the absolute relative error between the computed $u(L)$ (in m) and the exact reference $u(L)$ (in m).\n\nFinal output format:\n- Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3]\"). The three floats must be the results for Test cases $1$, $2$, and $3$ respectively, in that order. Each reported float must be dimensionless (absolute relative error). No other text should be printed.\n\nNotes:\n- All physical quantities in the implementation must be handled in International System of Units (SI units). Displacements must be in m, stress in Pa, temperature in K, and length in m. The reported errors are dimensionless.\n- Angles are not used in this problem.\n- The implementation must not read any user input and must run as-is.", "solution": "The problem statement is valid. It is scientifically grounded in the principles of linear thermoelasticity, is well-posed with sufficient data and boundary conditions for each case, and is formulated with objective, unambiguous language. We will proceed with a full solution.\n\nThe solution requires the implementation of a one-dimensional finite element method (FEM) for uncoupled thermoelasticity in a functionally graded bar. This will be developed from the principle of virtual work.\n\nThe fundamental governing relations are:\n$1$. Kinematic relation (strain-displacement): $\\varepsilon(x) = \\frac{du}{dx}$\n$2$. Static equilibrium (from linear momentum balance with no body forces): $\\frac{d\\sigma}{dx} = 0$\n$3$. Constitutive relation (linear thermoelastic): $\\sigma(x) = E(x)(\\varepsilon(x) - \\varepsilon_{th}(x)) = E(x)(\\frac{du}{dx} - \\alpha(x)\\Delta T)$\n\nHere, $u(x)$ is the axial displacement, $\\varepsilon(x)$ is the total axial strain, $\\sigma(x)$ is the axial stress, $E(x)$ is the spatially varying Young's modulus, $\\alpha(x)$ is the spatially varying coefficient of thermal expansion, and $\\Delta T$ is the prescribed uniform temperature change.\n\nThe principle of virtual work states that for a body in equilibrium, the internal virtual work ($\\delta W_{int}$) done by the stresses over a virtual strain field equals the external virtual work ($\\delta W_{ext}$) done by external forces over the corresponding virtual displacement field.\n$$ \\delta W_{int} = \\delta W_{ext} $$\nFor the one-dimensional bar of cross-sectional area $A$ and length $L$, this is expressed as:\n$$ \\int_0^L \\sigma(x) \\delta\\varepsilon(x) A \\, dx = (P_L \\delta u(L) + P_0 \\delta u(0)) $$\nwhere $\\delta\\varepsilon$ is the virtual strain corresponding to the kinematically admissible virtual displacement $\\delta u$, and $P_0$ and $P_L$ are external point forces at $x=0$ and $x=L$.\n\nWe substitute the constitutive relation into the internal virtual work term:\n$$ \\delta W_{int} = \\int_0^L E(x) \\left( \\frac{du}{dx} - \\alpha(x)\\Delta T \\right) \\frac{d(\\delta u)}{dx} A \\, dx $$\nRearranging the terms, we arrive at the weak form of the problem. Find $u(x)$ that satisfies the essential boundary conditions such that for all admissible virtual displacements $\\delta u$:\n$$ \\int_0^L A E(x) \\frac{du}{dx} \\frac{d(\\delta u)}{dx} \\, dx = \\int_0^L A E(x)\\alpha(x)\\Delta T \\frac{d(\\delta u)}{dx} \\, dx + \\delta W_{ext} $$\n\nTo discretize this equation, we divide the domain $[0, L]$ into $N$ finite elements. Within each element $(e)$ of length $L^{(e)}$, connecting nodes $i$ and $j$, the displacement field $u(x)$ is approximated using linear shape functions $\\mathbf{N}(x) = [N_i(x), N_j(x)]$:\n$$ u^{(e)}(x) \\approx \\mathbf{N}(x) \\mathbf{d}^{(e)} = N_i(x) d_i + N_j(x) d_j $$\nwhere $\\mathbf{d}^{(e)} = [d_i, d_j]^T$ is the vector of nodal displacements. The strain is then:\n$$ \\varepsilon^{(e)}(x) = \\frac{du^{(e)}}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{d}^{(e)} = \\mathbf{B}^{(e)} \\mathbf{d}^{(e)} $$\nFor a linear two-node element, the strain-displacement matrix $\\mathbf{B}^{(e)}$ is constant:\n$$ \\mathbf{B}^{(e)} = \\frac{1}{L^{(e)}} [-1, 1] $$\nThe virtual displacement and strain are approximated analogously: $\\delta u^{(e)} = \\mathbf{N}\\delta\\mathbf{d}^{(e)}$ and $\\delta\\varepsilon^{(e)} = \\mathbf{B}^{(e)}\\delta\\mathbf{d}^{(e)}$.\n\nSubstituting the discretized fields into the weak form for a single element yields:\n$$ (\\delta\\mathbf{d}^{(e)})^T \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x) \\mathbf{B}^{(e)} \\mathbf{d}^{(e)} \\, dx = (\\delta\\mathbf{d}^{(e)})^T \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x)\\alpha(x)\\Delta T \\, dx $$\nAs this must hold for any arbitrary $(\\delta\\mathbf{d}^{(e)})^T$, we obtain the element-level matrix equation:\n$$ \\mathbf{k}^{(e)} \\mathbf{d}^{(e)} = \\mathbf{f}_{th}^{(e)} $$\nwhere $\\mathbf{k}^{(e)}$ is the element stiffness matrix and $\\mathbf{f}_{th}^{(e)}$ is the element thermal load vector.\n\nThe components are defined as:\n$$ \\mathbf{k}^{(e)} = \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x) \\mathbf{B}^{(e)} \\, dx = \\frac{A}{(L^{(e)})^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} \\int_{L^{(e)}} E(x) \\, dx $$\n$$ \\mathbf{f}_{th}^{(e)} = \\int_{L^{(e)}} A (\\mathbf{B}^{(e)})^T E(x)\\alpha(x)\\Delta T \\, dx = \\frac{A \\Delta T}{L^{(e)}} \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} \\int_{L^{(e)}} E(x)\\alpha(x) \\, dx $$\nSince $E(x)$ and $\\alpha(x)$ are spatially variable, the integrals are computed numerically using Gaussian quadrature. For an integral over an element, we map the domain $x \\in [x_i, x_j]$ to a canonical domain $\\xi \\in [-1, 1]$ using $x(\\xi) = \\frac{x_i+x_j}{2} + \\frac{L^{(e)}}{2}\\xi$. The differential element is $dx = \\frac{L^{(e)}}{2}d\\xi$. The integrals become sums over the $n_p$ quadrature points:\n$$ \\int_{L^{(e)}} g(x) dx = \\int_{-1}^1 g(x(\\xi)) \\frac{L^{(e)}}{2} d\\xi \\approx \\frac{L^{(e)}}{2} \\sum_{k=1}^{n_p} w_k g(x(\\xi_k)) $$\nwhere $w_k$ and $\\xi_k$ are the quadrature weights and points. The problem specifies $n_p=3$.\n\nAfter computing $\\mathbf{k}^{(e)}$ and $\\mathbf{f}_{th}^{(e)}$ for each element, they are assembled into a global system of equations $\\mathbf{K}\\mathbf{d} = \\mathbf{F}_{th} + \\mathbf{F}_{ext}$, where $\\mathbf{K}$ is the global stiffness matrix, $\\mathbf{d}$ is the global nodal displacement vector, $\\mathbf{F}_{th}$ is the global thermal load vector, and $\\mathbf{F}_{ext}$ contains external mechanical loads.\n\nBoundary conditions are then applied. For a prescribed displacement $u_i = 0$, the corresponding row and column of $\\mathbf{K}$ are modified (e.g., via elimination) and the force vector is adjusted. After solving for $\\mathbf{d}$, the stress in each element can be post-processed. Since strain is constant per element, the stress varies only with the material properties:\n$$ \\sigma^{(e)}(x) = E(x) \\left( \\frac{d_j - d_i}{L^{(e)}} - \\alpha(x)\\Delta T \\right) $$\n\nFor validation, we derive the exact solutions for each test case from the equilibrium equation $\\frac{d\\sigma}{dx}=0$, which implies $\\sigma(x) = \\sigma_c$ (a constant). The displacement is found by integrating the constitutive law:\n$$ u(x) = u(0) + \\int_0^x \\left(\\frac{\\sigma_c}{E(x')} + \\alpha(x')\\Delta T\\right) dx' $$\nCase 1: $u(0)=0$ and $\\sigma(L)=0$ (traction-free). This implies $\\sigma_c=0$.\n$$ u_{exact}(L) = \\Delta T \\int_0^L \\alpha_0(1 + 0.5x/L) dx = \\alpha_0 \\Delta T [x + 0.25x^2/L]_0^L = 1.25 \\alpha_0 \\Delta T L $$\nCase 2: $u(0)=0$ and $u(L)=0$. The condition $u(L)=0$ is used to find $\\sigma_c$.\n$$ 0 = \\sigma_c \\int_0^L \\frac{dx}{E(x)} + \\Delta T \\int_0^L \\alpha(x) dx \\implies \\bar{\\sigma}_{exact} = \\sigma_c = -\\Delta T \\frac{\\int_0^L \\alpha(x)dx}{\\int_0^L E(x)^{-1}dx} $$\nThe integrals evaluate to $\\int_0^L \\alpha_0(1+0.3x/L)dx = 1.15\\alpha_0 L$ and $\\int_0^L E_0^{-1}(1+0.8x/L)^{-2}dx = L/(1.8E_0)$.\n$$ \\bar{\\sigma}_{exact} = -\\Delta T \\frac{1.15\\alpha_0 L}{L/(1.8E_0)} = -2.07\\alpha_0 E_0 \\Delta T $$\nCase 3: $u(0)=0$ and $\\sigma(L)=t$. This implies $\\sigma_c=t$.\n$$ u_{exact}(L) = \\int_0^L \\left(\\frac{t}{E(x)} + \\alpha(x)\\Delta T\\right) dx = t \\int_0^L E_0^{-1}e^{-1.2x/L}dx + \\Delta T \\int_0^L \\alpha_0(1+0.4x/L)dx $$\n$$ u_{exact}(L) = \\frac{tL}{1.2E_0}(1-e^{-1.2}) + 1.2 \\alpha_0 \\Delta T L $$\nThese exact solutions will be used as the reference to compute the required absolute relative errors of the FEM implementation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a 1D FEM for uncoupled thermoelasticity in FGMs.\n    \"\"\"\n    # Common parameters from problem statement\n    L = 1.0  # m\n    A = 1.0e-4  # m^2\n    E0 = 2.10e11  # Pa\n    alpha0 = 12.0e-6  # K^-1\n    N = 400  # Number of elements\n    num_gauss_points = 3\n\n    # Define material property functions for each test case\n    def E_func_1(x, L_bar, E_base):\n        return E_base * (1.0 + 0.5 * x / L_bar)\n    \n    def alpha_func_1(x, L_bar, alpha_base):\n        return alpha_base * (1.0 + 0.5 * x / L_bar)\n\n    def E_func_2(x, L_bar, E_base):\n        return E_base * (1.0 + 0.8 * x / L_bar)**2\n    \n    def alpha_func_2(x, L_bar, alpha_base):\n        return alpha_base * (1.0 + 0.3 * x / L_bar)\n\n    def E_func_3(x, L_bar, E_base):\n        return E_base * np.exp(1.2 * x / L_bar)\n    \n    def alpha_func_3(x, L_bar, alpha_base):\n        return alpha_base * (1.0 + 0.4 * x / L_bar)\n\n    test_cases = [\n        {\n            \"E_func\": E_func_1, \"alpha_func\": alpha_func_1, \"delta_T\": 100.0,\n            \"bcs\": {\"u0\": 0.0, \"uL\": None}, \"traction_L\": 0.0, \"case_id\": 1\n        },\n        {\n            \"E_func\": E_func_2, \"alpha_func\": alpha_func_2, \"delta_T\": 40.0,\n            \"bcs\": {\"u0\": 0.0, \"uL\": 0.0}, \"traction_L\": 0.0, \"case_id\": 2\n        },\n        {\n            \"E_func\": E_func_3, \"alpha_func\": alpha_func_3, \"delta_T\": 50.0,\n            \"bcs\": {\"u0\": 0.0, \"uL\": None}, \"traction_L\": 50.0e6, \"case_id\": 3\n        }\n    ]\n\n    results = []\n\n    # Get Gaussian quadrature points and weights for the canonical interval [-1, 1]\n    # For num_gauss_points = 3\n    gauss_points = np.array([-np.sqrt(3.0/5.0), 0.0, np.sqrt(3.0/5.0)])\n    gauss_weights = np.array([5.0/9.0, 8.0/9.0, 5.0/9.0])\n    \n    # Generate mesh\n    nodes = np.linspace(0, L, N + 1)\n    num_nodes = N + 1\n    elem_length = L / N\n\n    for case in test_cases:\n        E_func = case[\"E_func\"]\n        alpha_func = case[\"alpha_func\"]\n        delta_T = case[\"delta_T\"]\n\n        # Initialize global matrices\n        K_global = np.zeros((num_nodes, num_nodes))\n        F_global = np.zeros(num_nodes)\n\n        # Assemble global stiffness matrix and thermal load vector\n        for e in range(N):\n            node_i, node_j = e, e + 1\n            x1, x2 = nodes[node_i], nodes[node_j]\n            \n            # Numerical integration for element stiffness and thermal load\n            k_integral = 0.0\n            f_integral = 0.0\n            \n            for i in range(num_gauss_points):\n                xi = gauss_points[i]\n                w = gauss_weights[i]\n                \n                # Map from canonical to physical coordinates\n                x_phys = (x1 + x2) / 2.0 + (elem_length / 2.0) * xi\n                \n                E_val = E_func(x_phys, L, E0)\n                alpha_val = alpha_func(x_phys, L, alpha0)\n                \n                jacobian = elem_length / 2.0\n                \n                k_integral += w * E_val * jacobian\n                f_integral += w * E_val * alpha_val * jacobian\n                \n            k_elem_scalar = (A / elem_length**2) * k_integral\n            k_elem = k_elem_scalar * np.array([[1, -1], [-1, 1]])\n\n            f_th_elem_scalar = (A * delta_T / elem_length) * f_integral\n            f_th_elem = f_th_elem_scalar * np.array([-1, 1])\n\n            # Assembly\n            K_global[node_i:node_i+2, node_i:node_i+2] += k_elem\n            F_global[node_i:node_i+2] += f_th_elem\n        \n        # Add external traction\n        if case[\"traction_L\"] != 0.0:\n            F_global[-1] += case[\"traction_L\"] * A\n\n        # Apply boundary conditions using elimination\n        if case[\"bcs\"][\"u0\"] is not None:\n            K_global[0, :] = 0\n            K_global[:, 0] = 0\n            K_global[0, 0] = 1.0\n            F_global[0] = case[\"bcs\"][\"u0\"]\n\n        if case[\"bcs\"][\"uL\"] is not None:\n            K_global[-1, :] = 0\n            K_global[:, -1] = 0\n            K_global[-1, -1] = 1.0\n            F_global[-1] = case[\"bcs\"][\"uL\"]\n        \n        # Solve for nodal displacements\n        displacements = np.linalg.solve(K_global, F_global)\n\n        # Post-process and calculate error for each case\n        if case[\"case_id\"] == 1:\n            u_fem_L = displacements[-1]\n            u_exact_L = 1.25 * alpha0 * delta_T * L\n            error = abs((u_fem_L - u_exact_L) / u_exact_L)\n            results.append(error)\n\n        elif case[\"case_id\"] == 2:\n            total_sigma_integral = 0.0\n            for e in range(N):\n                node_i, node_j = e, e + 1\n                x1, x2 = nodes[node_i], nodes[node_j]\n                \n                u_i, u_j = displacements[node_i], displacements[node_j]\n                strain = (u_j - u_i) / elem_length\n                \n                sigma_integral_elem = 0.0\n                for i in range(num_gauss_points):\n                    xi, w = gauss_points[i], gauss_weights[i]\n                    x_phys = (x1 + x2) / 2.0 + (elem_length / 2.0) * xi\n                    \n                    E_val = E_func(x_phys, L, E0)\n                    alpha_val = alpha_func(x_phys, L, alpha0)\n                    \n                    sigma_val = E_val * (strain - alpha_val * delta_T)\n                    sigma_integral_elem += w * sigma_val * (elem_length / 2.0)\n                \n                total_sigma_integral += sigma_integral_elem\n            \n            sigma_bar_fem = total_sigma_integral / L\n            sigma_bar_exact = -2.07 * alpha0 * E0 * delta_T\n            error = abs((sigma_bar_fem - sigma_bar_exact) / sigma_bar_exact)\n            results.append(error)\n\n        elif case[\"case_id\"] == 3:\n            u_fem_L = displacements[-1]\n            traction = case[\"traction_L\"]\n            \n            # Integral part 1: Mechanical displacement\n            term1 = (traction * L / (1.2 * E0)) * (1.0 - np.exp(-1.2))\n            # Integral part 2: Thermal displacement\n            term2 = 1.2 * alpha0 * delta_T * L\n            u_exact_L = term1 + term2\n            \n            error = abs((u_fem_L - u_exact_L) / u_exact_L)\n            results.append(error)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```", "id": "2928435"}]}