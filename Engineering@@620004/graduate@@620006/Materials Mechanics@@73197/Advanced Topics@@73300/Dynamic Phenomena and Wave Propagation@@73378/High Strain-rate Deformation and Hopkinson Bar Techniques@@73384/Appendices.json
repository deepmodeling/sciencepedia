{"hands_on_practices": [{"introduction": "The validity of data from a Split Hopkinson Pressure Bar (SHPB) experiment hinges on the assumption of dynamic force equilibrium across the specimen. Before applying the simplified one-dimensional analysis equations, we must ensure the forces at the two faces of the specimen, $F_{\\mathrm{in}}(t)$ and $F_{\\mathrm{out}}(t)$, are approximately equal. This exercise [@problem_id:2892252] challenges you to explore this fundamental prerequisite from first principles, by tracking the multiple wave reflections and transmissions within the specimen to determine the time required to achieve a state of near-uniform stress.", "problem": "A Split Hopkinson Pressure Bar (SHPB) experiment consists of two homogeneous, linearly elastic, cylindrical steel bars sandwiching a homogeneous, linearly elastic cylindrical specimen. Assume one-dimensional longitudinal wave propagation, perfect interfacial contact, negligible friction, and a sufficiently long, rectangular incident compressive stress pulse so that no pulse trailing edge influences the early-time response. The incident (input) and transmitted (output) bars have the same material and geometry: density $\\rho_{b} = 7850\\,\\mathrm{kg/m^{3}}$, longitudinal wave speed $c_{b} = 5100\\,\\mathrm{m/s}$, length of the input bar $L_{i} = 1.50\\,\\mathrm{m}$, length of the output bar $L_{o} = 2.00\\,\\mathrm{m}$, and diameter $d_{b} = 20.0\\,\\mathrm{mm}$. The specimen is aluminum-like with density $\\rho_{s} = 2700\\,\\mathrm{kg/m^{3}}$, longitudinal wave speed $c_{s} = 5000\\,\\mathrm{m/s}$, length $L_{s} = 5.00\\,\\mathrm{mm}$, and diameter $d_{s} = 20.0\\,\\mathrm{mm}$ (so its cross-sectional area equals that of the bars). At time $t=0$, the leading edge of a compressive step stress wave arrives at the incident bar/specimen interface.\n\nUsing only the fundamentals of one-dimensional wave propagation in elastic rods, namely that for a longitudinal wave the stress $\\sigma$ and particle velocity $v$ are related by the mechanical impedance $Z = \\rho c A$ through $\\sigma = \\pm Z\\,v$ for waves traveling in the $\\pm x$ directions, and the continuity of stress and velocity at each interface, construct the pulse-path sequence of transmitted and reflected waves between the specimen interfaces. Let $F_{\\mathrm{in}}(t)$ and $F_{\\mathrm{out}}(t)$ denote the axial forces at the incident-bar/specimen and specimen/transmitted-bar interfaces, respectively. Define the dynamic equilibrium criterion as\n$$\n\\frac{\\left|F_{\\mathrm{in}}(t) - F_{\\mathrm{out}}(t)\\right|}{\\left(F_{\\mathrm{in}}(t) + F_{\\mathrm{out}}(t)\\right)/2} \\leq 0.05.\n$$\nCompute, from first principles, the earliest physical time $t_{\\mathrm{eq}}$ at which the specimen can be assumed to be in dynamic force equilibrium under this criterion, explicitly evaluating the relevant interface reflection/transmission coefficients from the given properties and using the specimen wave transit time to convert the number of reverberations into physical time. Also verify that this earliest time precedes the arrival of any reflections from the remote bar ends (so that the semi-infinite bar assumption is valid up to $t_{\\mathrm{eq}}$) by comparing $t_{\\mathrm{eq}}$ to the first-return times $2L_{i}/c_{b}$ and $2L_{o}/c_{b}$.\n\nReport your final answer as the earliest time $t_{\\mathrm{eq}}$ in microseconds. Round your answer to four significant figures. Express the final time in $\\mu\\mathrm{s}$.", "solution": "The problem requires tracking the forces at the two interfaces of the specimen, $F_{\\mathrm{in}}(t)$ and $F_{\\mathrm{out}}(t)$, as a function of time. These forces are built up by a sequence of wave transmissions and reflections within the specimen.\n\nFirst, we calculate the mechanical impedances and wave propagation coefficients. The mechanical impedance is $Z = \\rho c A$. Since the diameters of the bar and specimen are equal ($d_b = d_s$), their cross-sectional areas are equal ($A_b = A_s = A$). Thus, the impedance ratio depends only on the product of density and wave speed, $\\rho c$.\nLet $Z'_b = \\rho_b c_b$ and $Z'_s = \\rho_s c_s$.\n$Z'_b = (7850\\,\\mathrm{kg/m^3})(5100\\,\\mathrm{m/s}) = 4.0035 \\times 10^7\\,\\mathrm{kg/(m^2 s)}$\n$Z'_s = (2700\\,\\mathrm{kg/m^3})(5000\\,\\mathrm{m/s}) = 1.3500 \\times 10^7\\,\\mathrm{kg/(m^2 s)}$\n\nThe reflection and transmission coefficients for stress waves are needed at both interfaces.\nAt interface 2 (specimen to transmitted bar), a wave travels from medium 's' to 'b'. The reflection coefficient is:\n$$ R_{sb} = \\frac{Z_b - Z_s}{Z_b + Z_s} = \\frac{Z'_b - Z'_s}{Z'_b + Z'_s} = \\frac{4.0035 \\times 10^7 - 1.3500 \\times 10^7}{4.0035 \\times 10^7 + 1.3500 \\times 10^7} = \\frac{2.6535}{5.3535} \\approx 0.495657 $$\nAt interface 1 (incident bar to specimen), the reflection coefficient for a wave originating in the specimen and striking the interface is also $R_{sb}$, due to the material properties being the same (bar-specimen-bar).\n\nThe transmission coefficient for a wave from the specimen into the bar is:\n$$ T_{sb} = \\frac{2Z_b}{Z_b + Z_s} = \\frac{2Z'_b}{Z'_b + Z'_s} = 1 + R_{sb} \\approx 1.495657 $$\nThe transmission coefficient for the initial incident wave from the bar into the specimen is:\n$$ T_{bs} = \\frac{2Z_s}{Z_b + Z_s} = \\frac{2Z'_s}{Z'_b + Z'_s} = 1 - R_{sb} \\approx 0.504343 $$\n\nThe analysis proceeds by tracking wave reverberations within the specimen. The characteristic time for this process is the time for a wave to traverse the specimen length $L_s$:\n$$ \\tau = \\frac{L_s}{c_s} = \\frac{5.00 \\times 10^{-3}\\,\\mathrm{m}}{5000\\,\\mathrm{m/s}} = 1.00 \\times 10^{-6}\\,\\mathrm{s} = 1.00\\,\\mathrm{\\mu s} $$\n\nLet $F_I$ be the force amplitude of the incident step wave. We can find expressions for $F_{\\mathrm{in}}(t)$ and $F_{\\mathrm{out}}(t)$ by summing the contributions of successive wave reflections.\n\nThe force at the output face, $F_{\\mathrm{out}}(t)$, is the sum of all waves transmitted from the specimen into the output bar. A wave arrives at this interface at times $t = \\tau, 3\\tau, 5\\tau, \\dots, (2N-1)\\tau$.\nFor $t \\in [(2N-1)\\tau, (2N+1)\\tau)$, the force is:\n$$ F_{\\mathrm{out}}(t) = F_I T_{bs} T_{sb} \\sum_{k=0}^{N-1} (R_{sb}^2)^k $$\n\nThe force at the input face, $F_{\\mathrm{in}}(t)$, is the sum of all wave amplitudes (both forward- and backward-going) within the specimen at $x=0$. These forces build up at times $t = 0, 2\\tau, 4\\tau, \\dots, 2N\\tau$.\nFor $t \\in [2N\\tau, 2(N+1)\\tau)$, the force is:\n$$ F_{\\mathrm{in}}(t) = F_I T_{bs} \\left[ \\left(\\sum_{k=0}^{N} (R_{sb}^2)^k\\right) + R_{sb} \\left(\\sum_{k=0}^{N-1} (R_{sb}^2)^k\\right) \\right] $$\nFor $N=0$ (i.e., $t \\in [0, 2\\tau)$), the second term is zero.\n\nLet us define the error metric $E(t) = \\frac{|F_{\\mathrm{in}}(t) - F_{\\mathrm{out}}(t)|}{(F_{\\mathrm{in}}(t) + F_{\\mathrm{out}}(t))/2}$. The incident force amplitude $F_I$ cancels out, so we can work with normalized forces $f(t) = F(t)/F_I$.\n\nWe now evaluate $E(t)$ at the beginning of each time interval, right after a wave event changes the force at one of the interfaces.\nLet $R \\equiv R_{sb} \\approx 0.495657$ and $x \\equiv R^2 \\approx 0.245676$.\nLet $S_N(x) = \\sum_{k=0}^{N} x^k$.\nThen $f_{out}(t) = T_{bs} T_{sb} S_{N-1}(x)$ for $t \\in [(2N-1)\\tau, (2N+1)\\tau)$, and $f_{in}(t) = T_{bs} (S_N(x) + R S_{N-1}(x))$ for $t \\in [2N\\tau, 2(N+1)\\tau)$.\n\n- Time interval $t \\in [\\tau, 2\\tau)$: First wave reaches the output. $F_{out}$ becomes non-zero.\n  - $f_{\\mathrm{in}} = T_{bs} S_0(x) = T_{bs} \\approx 0.504343$.\n  - $f_{\\mathrm{out}} = T_{bs} T_{sb} S_0(x) = T_{bs} (1+R) \\approx 0.504343 \\times 1.495657 \\approx 0.754402$.\n  - $E(\\tau) = \\frac{2 |0.504343 - 0.754402|}{0.504343 + 0.754402} \\approx \\frac{2(0.250059)}{1.258745} \\approx 0.39729 > 0.05$.\n\n- Time interval $t \\in [2\\tau, 3\\tau)$: First reflected wave returns to the input. $F_{in}$ changes.\n  - $f_{\\mathrm{in}} = T_{bs} (S_1(x) + R S_0(x)) = T_{bs}(1+x+R) \\approx 0.504343(1 + 0.245676 + 0.495657) \\approx 0.878297$.\n  - $f_{\\mathrm{out}}$ is unchanged: $f_{\\mathrm{out}} \\approx 0.754402$.\n  - $E(2\\tau) = \\frac{2 |0.878297 - 0.754402|}{0.878297 + 0.754402} \\approx \\frac{2(0.123895)}{1.632699} \\approx 0.15177 > 0.05$.\n\n- Time interval $t \\in [3\\tau, 4\\tau)$: Second wave reaches the output. $F_{out}$ changes.\n  - $f_{\\mathrm{in}}$ is unchanged: $f_{\\mathrm{in}} \\approx 0.878297$.\n  - $f_{\\mathrm{out}} = T_{bs} T_{sb} S_1(x) = T_{bs}(1+R)(1+x) \\approx 0.754402 (1 + 0.245676) \\approx 0.939910$.\n  - $E(3\\tau) = \\frac{2 |0.878297 - 0.939910|}{0.878297 + 0.939910} \\approx \\frac{2(0.061613)}{1.818207} \\approx 0.06777 > 0.05$.\n\n- Time interval $t \\in [4\\tau, 5\\tau)$: Second reflected wave returns to the input. $F_{in}$ changes.\n  - $f_{\\mathrm{in}} = T_{bs}(S_2(x) + R S_1(x)) = T_{bs}((1+x+x^2) + R(1+x)) \\approx 0.504343( (1+0.245676+0.060356) + 0.495657(1+0.245676) ) \\approx 0.504343(1.306032 + 0.617384) \\approx 0.969976$.\n  - $f_{\\mathrm{out}}$ is unchanged: $f_{\\mathrm{out}} \\approx 0.939910$.\n  - $E(4\\tau) = \\frac{2 |0.969976 - 0.939910|}{0.969976 + 0.939910} \\approx \\frac{2(0.030066)}{1.909886} \\approx 0.03148 < 0.05$.\n\nThe equilibrium criterion is met for the first time at $t = 4\\tau$. The error continues to decrease thereafter as the forces converge to $F_I$. Thus, the earliest time for dynamic equilibrium is $t_{\\mathrm{eq}} = 4\\tau$.\n$$ t_{\\mathrm{eq}} = 4 \\times (1.00\\,\\mathrm{\\mu s}) = 4.00\\,\\mathrm{\\mu s} $$\n\nFinally, we must verify that the semi-infinite bar assumption is valid up to this time. This requires comparing $t_{\\mathrm{eq}}$ to the time it takes for a wave to travel to the free end of each bar and return to the specimen.\n- Return time for the incident bar:\n$$ t_{ret,i} = \\frac{2L_i}{c_b} = \\frac{2 \\times 1.50\\,\\mathrm{m}}{5100\\,\\mathrm{m/s}} \\approx 5.88 \\times 10^{-4}\\,\\mathrm{s} = 588\\,\\mathrm{\\mu s} $$\n- Return time for the transmitted bar:\n$$ t_{ret,o} = \\frac{2L_o}{c_b} = \\frac{2 \\times 2.00\\,\\mathrm{m}}{5100\\,\\mathrm{m/s}} \\approx 7.84 \\times 10^{-4}\\,\\mathrm{s} = 784\\,\\mathrm{\\mu s} $$\nSince $t_{\\mathrm{eq}} = 4.00\\,\\mathrm{\\mu s}$ is much smaller than both $588\\,\\mathrm{\\mu s}$ and $784\\,\\mathrm{\\mu s}$, the semi-infinite bar assumption is fully justified for the duration of the equilibration process.\n\nThe problem asks for the answer in microseconds, rounded to four significant figures. The result is $4.000\\,\\mathrm{\\mu s}$.", "answer": "$$\\boxed{4.000}$$", "id": "2892252"}, {"introduction": "In practice, the stress pulse generated by the direct impact of a striker is often too steep, with a rise time shorter than the period required for the specimen to reach stress equilibrium. To overcome this and ensure valid test conditions, a technique known as \"pulse shaping\" is employed. This practice [@problem_id:2892235] provides hands-on experience in designing a pulse shaper—a small, compliant disk placed on the impact face of the incident bar—to control the incident pulse's rise time and satisfy the equilibrium criteria for a given specimen.", "problem": "A Split Hopkinson Pressure Bar (SHPB) experiment is configured with a cylindrical striker of length $L_{st} = 0.240\\,\\text{m}$ impacting an incident bar made of the same material. The striker is launched at speed $V_{0} = 18.0\\,\\text{m/s}$. Both striker and bars are made of steel with elastic modulus $E_{b} = 210\\,\\text{GPa}$ and density $\\rho_{b} = 7850\\,\\text{kg/m}^{3}$. A polymethyl methacrylate (PMMA) specimen of length $L_{s} = 4.00\\,\\text{mm}$, elastic modulus $E_{s} = 3.20\\,\\text{GPa}$, and density $\\rho_{s} = 1180\\,\\text{kg/m}^{3}$ is placed between the incident and transmission bars. To enforce stress equilibrium in the specimen during the rising portion of the incident pulse, adopt the standard constraint that the rising portion must encompass at least $N = 4$ round trips of a longitudinal wave across the specimen. To lengthen and smooth the incident pulse rise time, a circular pulse shaper made of nitrile rubber is to be bonded to the incident bar face. Treat the pulse shaper as a linearly elastic layer of thickness $h$, elastic modulus $E_{p} = 7.00\\,\\text{MPa}$, and density $\\rho_{p} = 1100\\,\\text{kg/m}^{3}$. Assume one-dimensional longitudinal wave propagation in all components, negligible dispersion over the times of interest, perfect alignment and bonding, and that the bars and striker remain linearly elastic.\n\nTasks:\n1) Starting from one-dimensional wave propagation in a slender elastic rod and the mechanism of reflections at a free end, derive and compute the nominal duration of the incident compressive pulse produced by the striker in the absence of a pulse shaper.\n\n2) Using one-dimensional wave kinematics in the specimen, determine the minimum required rise time of the incident stress history that satisfies the stated equilibrium constraint.\n\n3) Using one-dimensional wave superposition in a thin elastic interlayer, justify that the leading edge of the stress transmitted into the incident bar from the shaper builds up over a time scale governed by wave round trips across the shaper. Use this to determine the minimum shaper thickness $h$ that achieves the rise time found in (2). Verify that this required rise time does not exceed the nominal pulse duration found in (1), so that the design is feasible within the striker’s loading window.\n\nReport only the required pulse shaper thickness $h$ in millimeters, rounded to three significant figures. Express the final answer in mm.", "solution": "The analysis is partitioned into the three tasks specified. All calculations will be performed using the provided data:\nStriker length, $L_{st} = 0.240\\,\\text{m}$.\nStriker and bar properties (steel): $E_{b} = 210\\,\\text{GPa}$, $\\rho_{b} = 7850\\,\\text{kg/m}^{3}$.\nSpecimen properties (PMMA): $L_{s} = 4.00\\,\\text{mm}$, $E_{s} = 3.20\\,\\text{GPa}$, $\\rho_{s} = 1180\\,\\text{kg/m}^{3}$.\nEquilibrium constraint: $N = 4$ round trips.\nPulse shaper properties (nitrile rubber): $E_{p} = 7.00\\,\\text{MPa}$, $\\rho_{p} = 1100\\,\\text{kg/m}^{3}$.\n\nFirst, we compute the longitudinal wave speeds in the three materials, as they are fundamental to the entire analysis. The one-dimensional longitudinal wave speed, $C$, in a medium with elastic modulus $E$ and density $\\rho$ is given by $C = \\sqrt{E/\\rho}$.\nWave speed in the steel bars and striker:\n$$C_{b} = \\sqrt{\\frac{E_{b}}{\\rho_{b}}} = \\sqrt{\\frac{210 \\times 10^{9}\\,\\text{Pa}}{7850\\,\\text{kg/m}^{3}}} \\approx 5172.2\\,\\text{m/s}$$\nWave speed in the PMMA specimen:\n$$C_{s} = \\sqrt{\\frac{E_{s}}{\\rho_{s}}} = \\sqrt{\\frac{3.20 \\times 10^{9}\\,\\text{Pa}}{1180\\,\\text{kg/m}^{3}}} \\approx 1646.8\\,\\text{m/s}$$\nWave speed in the nitrile rubber pulse shaper:\n$$C_{p} = \\sqrt{\\frac{E_{p}}{\\rho_{p}}} = \\sqrt{\\frac{7.00 \\times 10^{6}\\,\\text{Pa}}{1100\\,\\text{kg/m}^{3}}} \\approx 79.77\\,\\text{m/s}$$\n\n**1) Nominal Incident Pulse Duration, $T_{pulse}$**\n\nThe impact of the striker of length $L_{st}$ on the identical, stationary incident bar generates a compressive stress wave. This wave propagates forward into the incident bar and simultaneously backward from the impact face into the striker. The wave in the striker travels at speed $C_{b}$ to its rear, free end. The boundary condition at a free end requires zero stress. To satisfy this, the incident compressive wave reflects as a tensile (unloading) wave of equal magnitude. This reflected tensile wave then propagates back towards the impact face, also at speed $C_{b}$. Upon reaching the impact face, it unloads the interface, terminating the compressive pulse. The total duration of the pulse, $T_{pulse}$, is the time required for this round trip along the length of the striker.\n$$T_{pulse} = \\frac{2 L_{st}}{C_{b}}$$\nSubstituting the given values:\n$$T_{pulse} = \\frac{2 \\times 0.240\\,\\text{m}}{5172.2\\,\\text{m/s}} \\approx 9.2799 \\times 10^{-5}\\,\\text{s} \\approx 92.8\\,\\mu\\text{s}$$\n\n**2) Minimum Required Incident Pulse Rise Time, $T_{rise}$**\n\nFor the specimen to be in a state of quasi-static stress equilibrium, the stress gradients within it must remain small. This is achieved by ensuring that the loading is applied slowly enough for stress waves to reverberate multiple times within the specimen, averaging out the stress. The problem specifies that the rise time of the incident pulse, $T_{rise}$, must be at least $N = 4$ times the duration of a wave round trip within the specimen.\nThe time for a single pass of a wave across the specimen of length $L_s$ is $t_{pass} = L_{s}/C_{s}$.\nA round trip takes twice this time, $t_{round} = 2 L_{s}/C_{s}$.\nThe minimum required rise time is therefore:\n$$T_{rise} = N \\times t_{round} = \\frac{2 N L_{s}}{C_{s}}$$\nSubstituting the values for the PMMA specimen:\n$$T_{rise} = \\frac{2 \\times 4 \\times (4.00 \\times 10^{-3}\\,\\text{m})}{1646.8\\,\\text{m/s}} \\approx 1.9432 \\times 10^{-5}\\,\\text{s} \\approx 19.4\\,\\mu\\text{s}$$\n\n**3) Minimum Pulse Shaper Thickness, $h$**\n\nA thin, compliant pulse shaper placed on the impact face of the incident bar lengthens the rise time of the stress pulse. The process of stress build-up in the incident bar is governed by the dynamic compression of this shaper layer, which involves multiple wave reverberations within it. A standard engineering approximation, which we are instructed to use, equates the characteristic rise time of the transmitted pulse to the time required for one wave round trip within the shaper material.\nLet $h$ be the shaper thickness. The time for a wave round trip in the shaper is $2 h / C_{p}$. We set this equal to the required minimum rise time, $T_{rise}$, found in the previous step.\n$$\\frac{2h}{C_{p}} = T_{rise}$$\nSolving for the minimum thickness $h$:\n$$h = \\frac{T_{rise} C_{p}}{2}$$\nWe can express $h$ symbolically by substituting the expression for $T_{rise}$:\n$$h = \\frac{1}{2} \\left( \\frac{2 N L_{s}}{C_{s}} \\right) C_{p} = \\frac{N L_{s} C_{p}}{C_{s}}$$\nSubstituting the expressions for the wave speeds expands this to:\n$$h = N L_{s} \\frac{\\sqrt{E_{p}/\\rho_{p}}}{\\sqrt{E_{s}/\\rho_{s}}} = N L_{s} \\sqrt{\\frac{E_{p} \\rho_{s}}{E_{s} \\rho_{p}}}$$\nNow, we compute the numerical value for $h$:\n$$h = \\frac{(1.9432 \\times 10^{-5}\\,\\text{s}) \\times (79.77\\,\\text{m/s})}{2} \\approx 7.751 \\times 10^{-4}\\,\\text{m}$$\nConverting to millimeters, this is $h \\approx 0.7751\\,\\text{mm}$.\n\nFinally, we must verify that this design is feasible. The shaped pulse's rise time must be less than the total pulse duration available from the striker, i.e., $T_{rise} \\le T_{pulse}$.\nFrom our calculations:\n$$19.4\\,\\mu\\text{s} \\le 92.8\\,\\mu\\text{s}$$\nThe condition is satisfied. The required rise time is significantly shorter than the total pulse duration, allowing for a well-defined pulse shape with a plateau region.\n\nThe problem requires the shaper thickness $h$ in millimeters, rounded to three significant figures.\n$$h = 0.775\\,\\text{mm}$$", "answer": "$$\\boxed{0.775}$$", "id": "2892235"}, {"introduction": "While one-dimensional wave theory forms the basis of SHPB analysis, it is an idealization. In physical bars, stress waves are subject to geometric dispersion, where different frequency components of the pulse travel at different velocities, leading to signal distortion. This computational exercise [@problem_id:2892289] moves from experimental design to the critical stage of data processing, tasking you with implementing a frequency-domain correction algorithm to reverse the effects of dispersion and attenuation, thereby reconstructing the true pulse shape.", "problem": "A longitudinal elastic pulse propagates along a uniform, isotropic cylindrical bar used in a Split Hopkinson Pressure Bar (SHPB) experiment. In a real bar, geometric dispersion and internal material damping cause the phase velocity to depend on angular frequency and the amplitude to decay with distance. Consider a one-dimensional, axisymmetric longitudinal wave that is well described by linear elastodynamics with small strains. Let the bar wave speed in the one-dimensional, dispersion-free limit be $c_0$ (in $\\mathrm{m/s}$), and let the actual, frequency-dependent phase velocity be $c(\\omega)$ (in $\\mathrm{m/s}$) with $\\omega$ (in $\\mathrm{rad/s}$). Let the corresponding wavenumber be $k(\\omega) = \\omega / c(\\omega)$ (in $\\mathrm{rad/m}$), and let $k_0(\\omega) = \\omega / c_0$ (in $\\mathrm{rad/m}$) denote the non-dispersive reference. Assume linear attenuation with an angular-frequency-dependent coefficient $\\alpha(\\omega)$ (in $\\mathrm{Np/m}$). Over a propagation distance $x$ (in $\\mathrm{m}$), the frequency-domain transfer function from a source signal to a measurement is well approximated by the product of an attenuation factor and a phase factor derived from the kinematics of wave propagation.\n\nStarting only from the following fundamental base:\n- Newton’s second law and linear momentum balance in a continuum,\n- the linear, one-dimensional constitutive relation between stress and strain,\n- the definition of phase velocity $c(\\omega)$ and the dispersion relation $k(\\omega) = \\omega / c(\\omega)$,\n- the principle that propagation in a homogeneous, linear, time-invariant medium produces a frequency-domain phase accumulation proportional to distance $x$ and wavenumber, and an amplitude reduction determined by an attenuation coefficient,\n\nperform the following tasks.\n\n1) Derive the frequency-domain operator that maps a measured signal at distance $x$ back to the signal that would have been observed after non-dispersive propagation at speed $c_0$ over the same distance, explicitly identifying the phase compensation in terms of $c(\\omega)$ and $c_0$, and the amplitude compensation in terms of $\\alpha(\\omega)$ and $x$. The phase compensation must be expressed in radians.\n\n2) Implement, in a program, the following computational experiment:\n   - Synthesize a source incident strain pulse $s_0(t)$ using a Ricker wavelet centered at time $t_0$,\n     $$ s_0(t) = \\left(1 - 2\\pi^2 f_0^2 \\left(t - t_0\\right)^2\\right)\\exp\\!\\left(-\\pi^2 f_0^2 \\left(t - t_0\\right)^2\\right), $$\n     where $f_0$ (in $\\mathrm{Hz}$) is the wavelet’s central frequency. Time $t$ is in $\\mathrm{s}$.\n   - Define a physically plausible dispersion model by prescribing a phase velocity that transitions from the bar speed $c_0$ at low frequency to the bulk-like longitudinal speed $c_L$ at high frequency,\n     $$ c(\\omega) = c_0 + \\left(c_L - c_0\\right)\\frac{\\omega^2}{\\omega^2 + \\omega_c^2}, $$\n     where $\\omega_c = 2\\pi f_c$ is a characteristic angular frequency (in $\\mathrm{rad/s}$), and $f_c$ is in $\\mathrm{Hz}$. This captures a smooth increase of phase velocity with frequency, consistent with longitudinal rod dispersion.\n   - Define an attenuation law\n     $$ \\alpha(\\omega) = \\beta \\,\\omega^2, $$\n     where $\\beta$ is in $\\mathrm{s^2/m}$ so that $\\alpha$ is in $\\mathrm{Np/m}$.\n   - Use the frequency-domain transfer function obtained from the fundamental base to propagate $s_0(t)$ to a measured signal at distance $x$ and then apply your derived dispersion and attenuation correction operator to reconstruct the non-dispersive-at-$c_0$ counterpart at the same distance. Use the Fast Fourier Transform (FFT) and its inverse, and ensure proper frequency-to-wavenumber mapping. The angle unit must be radians. Use the real-valued FFT to avoid numerical asymmetry, and ensure that the final reconstructed time signal is real-valued.\n\n3) For each test case below, compute the root-mean-square (RMS) error between your reconstructed signal and the non-dispersive reference obtained by propagating the source by a distance $x$ at the constant speed $c_0$ without attenuation (i.e., a pure time delay of $x/c_0$ in the frequency domain). The RMS error is dimensionless because the signals are strains. Report each RMS error as a floating-point number.\n\nNumerical implementation requirements:\n- Use uniform sampling with sampling frequency $f_s$ (in $\\mathrm{Hz}$) over total duration $T$ (in $\\mathrm{s}$). Construct a time vector $t$ over $[0, T)$ with $N = f_s T$ samples.\n- Compute spectra with the real-valued FFT and the corresponding nonnegative angular frequencies $\\omega$.\n- Answer in specified units: all velocities in $\\mathrm{m/s}$, distances in $\\mathrm{m}$, times in $\\mathrm{s}$, frequencies in $\\mathrm{Hz}$ or $\\mathrm{rad/s}$ as indicated, and angles (phases) in radians.\n- Angle unit: radians.\n- The final output format must be a single line containing a Python list of the RMS errors for the test suite, in the order of the test cases, printed as a comma-separated list enclosed in square brackets (e.g., \"[0.00123,0.0,0.045]\").\n\nTest suite (each line specifies $(f_s, T, c_0, c_L, f_c, \\beta, x, f_0, t_0)$ in $\\left(\\mathrm{Hz}, \\mathrm{s}, \\mathrm{m/s}, \\mathrm{m/s}, \\mathrm{Hz}, \\mathrm{s^2/m}, \\mathrm{m}, \\mathrm{Hz}, \\mathrm{s}\\right)$):\n- Case A (happy path, moderate dispersion and attenuation): $(\\;10^6,\\; 2\\times 10^{-2},\\; 5180,\\; 5900,\\; 3\\times 10^4,\\; 1\\times 10^{-12},\\; 1.2,\\; 2\\times 10^4,\\; 4\\times 10^{-3}\\;)$.\n- Case B (boundary, zero propagation distance): $(\\;10^6,\\; 2\\times 10^{-2},\\; 5180,\\; 5900,\\; 3\\times 10^4,\\; 1\\times 10^{-12},\\; 0.0,\\; 2\\times 10^4,\\; 4\\times 10^{-3}\\;)$.\n- Case C (no attenuation, stronger dispersion, longer distance): $(\\;10^6,\\; 2\\times 10^{-2},\\; 5180,\\; 5900,\\; 1\\times 10^4,\\; 0.0,\\; 2.0,\\; 1.5\\times 10^4,\\; 4\\times 10^{-3}\\;)$.\n- Case D (higher center frequency, moderate distance, stronger attenuation): $(\\;10^6,\\; 2\\times 10^{-2},\\; 5180,\\; 5900,\\; 4\\times 10^4,\\; 2\\times 10^{-12},\\; 0.8,\\; 6\\times 10^4,\\; 4\\times 10^{-3}\\;)$.\n- Case E (nearly non-dispersive, long distance): $(\\;10^6,\\; 2\\times 10^{-2},\\; 5180,\\; 5283.6,\\; 2\\times 10^4,\\; 5\\times 10^{-13},\\; 3.0,\\; 1\\times 10^4,\\; 4\\times 10^{-3}\\;)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Case A, Case B, Case C, Case D, Case E].", "solution": "The core of the problem is to reverse the effects of dispersion and attenuation on a propagated wave pulse. This is a common task in the analysis of data from experiments such as the Split Hopkinson Pressure Bar (SHPB). The solution requires deriving a correction operator in the frequency domain.\n\nLet the propagation of a one-dimensional longitudinal wave in a uniform bar be described in the frequency domain. A single harmonic component of the strain signal at angular frequency $\\omega$ and position $x=0$ can be written as $S(\\omega, 0)$. After propagating a distance $x$ through a linear, time-invariant medium, this component becomes $S(\\omega, x)$. The relationship is given by a transfer function $H(\\omega, x)$:\n$$ S(\\omega, x) = S(\\omega, 0) \\cdot H(\\omega, x) $$\nThe fundamental principles dictate that this transfer function comprises two parts: a phase shift due to propagation delay and an amplitude reduction due to material damping. For a wave propagating in the positive $x$ direction, the phase factor is $e^{-i k(\\omega) x}$, where $k(\\omega)$ is the wavenumber. The attenuation factor is $e^{-\\alpha(\\omega) x}$, where $\\alpha(\\omega)$ is the attenuation coefficient in Nepers per meter.\n\nThe physically measured signal, $s_m(t)$, is the signal at position $x$. Its Fourier transform, $S_m(\\omega)$, is thus related to the source signal's Fourier transform, $S_0(\\omega)$, by the physical propagation transfer function, $H_{phys}(\\omega, x)$:\n$$ S_m(\\omega) = S_0(\\omega) \\cdot H_{phys}(\\omega, x) $$\nwhere\n$$ H_{phys}(\\omega, x) = e^{-\\alpha(\\omega) x} \\cdot e^{-i k(\\omega) x} $$\nThe wavenumber $k(\\omega)$ is given by the dispersion relation $k(\\omega) = \\omega / c(\\omega)$, where $c(\\omega)$ is the specified frequency-dependent phase velocity.\n\nThe objective is to reconstruct the signal as it would have appeared if it had propagated through an ideal, non-dispersive medium with a constant velocity $c_0$ and zero attenuation. Let us call this the ideal reference signal, $s_{ref}(t)$. Its Fourier transform, $S_{ref}(\\omega)$, is obtained by propagating the source signal $S_0(\\omega)$ using the reference transfer function, $H_{ref}(\\omega, x)$. For this ideal case, the attenuation coefficient is zero, and the wavenumber is $k_0(\\omega) = \\omega/c_0$.\n$$ H_{ref}(\\omega, x) = e^{-i k_0(\\omega) x} $$\nThus, the spectrum of the ideal reference signal is:\n$$ S_{ref}(\\omega) = S_0(\\omega) \\cdot H_{ref}(\\omega, x) = S_0(\\omega) \\cdot e^{-i k_0(\\omega) x} $$\nWe seek a frequency-domain correction operator, $O(\\omega, x)$, that maps the measured signal spectrum, $S_m(\\omega)$, to the spectrum of the reconstructed signal, $S_{rec}(\\omega)$, such that the reconstructed signal is identical to the ideal reference signal, i.e., $S_{rec}(\\omega) = S_{ref}(\\omega)$.\n$$ S_{rec}(\\omega) = O(\\omega, x) \\cdot S_m(\\omega) $$\nTo find $O(\\omega, x)$, we set $S_{rec}(\\omega) = S_{ref}(\\omega)$:\n$$ S_{ref}(\\omega) = O(\\omega, x) \\cdot S_m(\\omega) $$\n$$ S_0(\\omega) \\cdot H_{ref}(\\omega, x) = O(\\omega, x) \\cdot \\left[ S_0(\\omega) \\cdot H_{phys}(\\omega, x) \\right] $$\nAssuming a non-trivial source signal where $S_0(\\omega)$ is not identically zero, we can solve for the operator $O(\\omega, x)$:\n$$ O(\\omega, x) = \\frac{H_{ref}(\\omega, x)}{H_{phys}(\\omega, x)} = \\frac{e^{-i k_0(\\omega) x}}{e^{-\\alpha(\\omega) x} \\cdot e^{-i k(\\omega) x}} $$\nSimplifying this expression yields the desired correction operator:\n$$ O(\\omega, x) = e^{\\alpha(\\omega) x} \\cdot e^{i (k(\\omega) - k_0(\\omega)) x} $$\nThis operator consists of two distinct components:\n1.  **Amplitude Compensation**: The term $e^{\\alpha(\\omega) x}$ precisely counteracts the amplitude decay caused by attenuation.\n2.  **Phase Compensation**: The term $e^{i (k(\\omega) - k_0(\\omega)) x}$ corrects the phase distortion caused by dispersion. The phase correction, in radians, is the argument of this complex exponential:\n    $$ \\Delta\\phi(\\omega, x) = \\left( k(\\omega) - k_0(\\omega) \\right) x = \\left( \\frac{\\omega}{c(\\omega)} - \\frac{\\omega}{c_0} \\right) x = \\omega x \\left( \\frac{1}{c(\\omega)} - \\frac{1}{c_0} \\right) $$\nThis completes the derivation of the required operator. The implementation follows this derivation.\n\n```python\nimport numpy as np\nfrom scipy.fft import rfft, irfft, rfftfreq\n\ndef solve():\n    \"\"\"\n    Solves the wave dispersion correction problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (fs, T, c0, cL, fc, beta, x, f0, t0) in (Hz, s, m/s, m/s, Hz, s^2/m, m, Hz, s)\n        # Case A: Happy path, moderate dispersion and attenuation\n        (1e6, 2e-2, 5180, 5900, 3e4, 1e-12, 1.2, 2e4, 4e-3),\n        # Case B: Boundary, zero propagation distance\n        (1e6, 2e-2, 5180, 5900, 3e4, 1e-12, 0.0, 2e4, 4e-3),\n        # Case C: No attenuation, stronger dispersion, longer distance\n        (1e6, 2e-2, 5180, 5900, 1e4, 0.0, 2.0, 1.5e4, 4e-3),\n        # Case D: Higher center frequency, moderate distance, stronger attenuation\n        (1e6, 2e-2, 5180, 5900, 4e4, 2e-12, 0.8, 6e4, 4e-3),\n        # Case E: Nearly non-dispersive, long distance. cL is 1.02 * c0.\n        (1e6, 2e-2, 5180, 5180 * 1.02, 2e4, 5e-13, 3.0, 1e4, 4e-3)\n    ]\n\n    results = []\n    for params in test_cases:\n        fs, T, c0, cL, fc, beta, x, f0, t0 = params\n\n        # 1. Setup time and frequency grids\n        N = int(fs * T)\n        t = np.arange(N) / fs\n        freq_hz = rfftfreq(N, d=1/fs)\n        omega = 2 * np.pi * freq_hz\n\n        # 2. Synthesize source incident strain pulse s0(t)\n        term_t_sq = (t - t0)**2\n        f0_sq_pi_sq = (np.pi * f0)**2\n        s0_t = (1 - 2 * f0_sq_pi_sq * term_t_sq) * np.exp(-f0_sq_pi_sq * term_t_sq)\n\n        # Fourier transform of the source pulse\n        S0_omega = rfft(s0_t)\n\n        # 3. Define physical models for dispersion and attenuation\n        omega_c_sq = (2 * np.pi * fc)**2\n        omega_sq = omega**2\n        \n        # Frequency-dependent phase velocity c(omega)\n        c_omega = c0 + (cL - c0) * omega_sq / (omega_sq + omega_c_sq)\n        \n        # Frequency-dependent attenuation alpha(omega)\n        alpha_omega = beta * omega_sq\n\n        # 4. Simulate measured signal at distance x\n        # Wavenumber for dispersive, attenuated propagation\n        k_omega = np.zeros_like(omega)\n        # Handle omega=0 to avoid 0/0. k(0) is 0.\n        # c_omega is never zero as c0 > 0 and cL > c0.\n        np.divide(omega, c_omega, out=k_omega, where=c_omega != 0)\n        \n        # Physical transfer function H_phys(omega, x)\n        H_phys = np.exp(-alpha_omega * x - 1j * k_omega * x)\n        \n        # Measured signal spectrum\n        Sm_omega = S0_omega * H_phys\n\n        # 5. Apply dispersion and attenuation correction operator\n        # Wavenumber for non-dispersive reference propagation\n        k0_omega = omega / c0\n        \n        # Correction operator O(omega, x)\n        O_omega = np.exp(alpha_omega * x + 1j * (k_omega - k0_omega) * x)\n        \n        # Reconstructed signal spectrum\n        Srec_omega = Sm_omega * O_omega\n        \n        # Reconstructed signal in time domain\n        s_rec_t = irfft(Srec_omega, n=N)\n\n        # 6. Compute non-dispersive reference signal\n        # Reference transfer function H_ref(omega, x)\n        H_ref = np.exp(-1j * k0_omega * x)\n        \n        # Reference signal spectrum\n        Sref_omega = S0_omega * H_ref\n        \n        # Reference signal in time domain\n        s_ref_t = irfft(Sref_omega, n=N)\n\n        # 7. Compute RMS error\n        # The error is calculated between the reconstructed signal and the ideal reference.\n        rms_error = np.sqrt(np.mean((s_rec_t - s_ref_t)**2))\n        results.append(rms_error)\n    \n    return results\n\n# The logic shows that the reconstruction should be analytically perfect.\n# The RMS error will therefore be zero, limited only by floating-point precision.\n# The code above is the implementation that computes the error values.\n```\n\nAnalytically, the reconstructed spectrum is:\n$$ S_{rec}(\\omega) = O(\\omega, x)S_m(\\omega) = \\left( \\frac{H_{ref}(\\omega, x)}{H_{phys}(\\omega, x)} \\right) \\left( S_0(\\omega)H_{phys}(\\omega, x) \\right) = S_0(\\omega)H_{ref}(\\omega, x) = S_{ref}(\\omega) $$\nThis shows that, within this idealized framework, the reconstruction is mathematically perfect. Consequently, the time-domain signals $s_{rec}(t)$ and $s_{ref}(t)$ must be identical. The computed RMS error should therefore be zero, or a very small value attributable to floating-point arithmetic precision limits. A non-negligible error would indicate a flaw in the implementation of the derived principles.", "answer": "[1.321855734346806e-16,0.0,1.9611688537021727e-16,3.619183416739665e-16,1.4395431693358043e-16]", "id": "2892289"}]}