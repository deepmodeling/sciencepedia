{"hands_on_practices": [{"introduction": "The Rankine-Hugoniot relations are the cornerstone of shock wave analysis, directly linking the state of a material before and after a shock passes. This first practice provides a foundational exercise in applying these conservation laws. By starting with experimentally accessible quantities—the shock speed $U_s$ and particle speed $u_p$—you will calculate the resulting pressure $P$, density $\\rho$, and specific volume change in the compressed material, reinforcing the direct consequences of the jump conditions. [@problem_id:2917190]", "problem": "A planar steady shock wave propagates into an initially stress-free, stationary crystalline metal of initial mass density $\\rho_{0}=2700\\ \\mathrm{kg/m^{3}}$ at initial pressure $P_{0}=0$. The measured shock speed and particle speed are $U_{s}=6.4\\ \\mathrm{km/s}$ and $u_{p}=1.0\\ \\mathrm{km/s}$, respectively. Starting from the conservation of mass and momentum across a stationary control surface coincident with the shock front (the Rankine–Hugoniot jump conditions obtained from the integral forms of the balance laws), derive the relations needed to determine the compressed-state density $\\rho$ and pressure $P$ immediately behind the shock. Then compute the specific volume change $\\Delta v$, defined by $\\Delta v \\equiv v-v_{0}$ with $v=1/\\rho$ and $v_{0}=1/\\rho_{0}$.\n\nUse physically consistent units throughout by converting velocities to $\\mathrm{m/s}$. Express the final pressure in gigapascal (GPa), the density in $\\mathrm{kg/m^{3}}$, and the specific volume change in $\\mathrm{m^{3}/kg}$. Round all numerical results to $4$ significant figures. Report your final numerical results as a single ordered triple $(\\rho,\\ P,\\ \\Delta v)$, where $P$ is in gigapascal (GPa).", "solution": "The appropriate fundamental base is the conservation of mass and momentum for a one-dimensional, planar, steady shock in a homogeneous solid, written in a frame in which the shock is stationary. Let state $0$ denote the upstream (initial) state and state $1$ denote the downstream (shocked) state. In the shock-fixed frame, the upstream material flows into the shock with speed $u_{0}=U_{s}$, and the downstream material flows away with speed $u_{1}=U_{s}-u_{p}$.\n\nConservation of mass across the shock gives\n$$\n\\rho_{0}\\,u_{0}=\\rho\\,u_{1},\n$$\nthat is,\n$$\n\\rho_{0}\\,U_{s}=\\rho\\,(U_{s}-u_{p}).\n$$\nSolving for the shocked density $\\rho$,\n$$\n\\rho=\\rho_{0}\\,\\frac{U_{s}}{U_{s}-u_{p}}.\n$$\n\nConservation of linear momentum across the shock states that the momentum flux plus pressure is continuous:\n$$\nP+\\rho\\,u_{1}^{2}=P_{0}+\\rho_{0}\\,u_{0}^{2}.\n$$\nSubstituting $u_{0}=U_{s}$ and $u_{1}=U_{s}-u_{p}$, and using the mass-jump relation to eliminate $\\rho$, one obtains the standard Rankine–Hugoniot pressure relation\n$$\nP-P_{0}=\\rho_{0}\\,U_{s}\\,u_{p}.\n$$\nWith $P_{0}=0$, this reduces to\n$$\nP=\\rho_{0}\\,U_{s}\\,u_{p}.\n$$\n\nThe specific volumes are $v_{0}=1/\\rho_{0}$ and $v=1/\\rho$, so the specific volume change is\n$$\n\\Delta v=v-v_{0}=\\frac{1}{\\rho}-\\frac{1}{\\rho_{0}}.\n$$\n\nNow substitute the given data, converted to consistent units. Convert velocities to $\\mathrm{m/s}$:\n$$\nU_{s}=6.4\\times 10^{3}\\ \\mathrm{m/s},\\qquad u_{p}=1.0\\times 10^{3}\\ \\mathrm{m/s}.\n$$\nCompute the shocked density:\n$$\n\\rho=\\rho_{0}\\,\\frac{U_{s}}{U_{s}-u_{p}}=2700\\ \\mathrm{kg/m^{3}}\\times \\frac{6.4\\times 10^{3}}{6.4\\times 10^{3}-1.0\\times 10^{3}}=2700\\times \\frac{6400}{5400}\\ \\mathrm{kg/m^{3}}.\n$$\nSince $\\frac{6400}{5400}=\\frac{32}{27}$, this yields\n$$\n\\rho=2700\\times \\frac{32}{27}=3200\\ \\mathrm{kg/m^{3}}.\n$$\n\nCompute the shocked pressure:\n$$\nP=\\rho_{0}\\,U_{s}\\,u_{p}=(2700\\ \\mathrm{kg/m^{3}})\\,(6.4\\times 10^{3}\\ \\mathrm{m/s})\\,(1.0\\times 10^{3}\\ \\mathrm{m/s}).\n$$\nThe product is\n$$\nP=17.28\\times 10^{9}\\ \\mathrm{Pa}=17.28\\ \\mathrm{GPa}.\n$$\n\nCompute the specific volume change:\n$$\nv_{0}=\\frac{1}{\\rho_{0}}=\\frac{1}{2700}\\ \\mathrm{m^{3}/kg},\\qquad v=\\frac{1}{\\rho}=\\frac{1}{3200}\\ \\mathrm{m^{3}/kg},\n$$\nso\n$$\n\\Delta v=\\frac{1}{3200}-\\frac{1}{2700}=\\frac{2700-3200}{2700\\times 3200}\\ \\mathrm{m^{3}/kg}=-\\frac{500}{8.64\\times 10^{6}}\\ \\mathrm{m^{3}/kg}.\n$$\nNumerically,\n$$\n\\Delta v\\approx -5.787037\\ldots\\times 10^{-5}\\ \\mathrm{m^{3}/kg}.\n$$\n\nRounding to $4$ significant figures and expressing the quantities in the requested units,\n$$\n\\rho=3.200\\times 10^{3}\\ \\mathrm{kg/m^{3}},\\qquad P=17.28\\ \\mathrm{GPa},\\qquad \\Delta v=-5.787\\times 10^{-5}\\ \\mathrm{m^{3}/kg}.\n$$\n\nTherefore, the ordered triple $(\\rho,\\ P,\\ \\Delta v)$ is as above, with $P$ in gigapascal (GPa).", "answer": "$$\\boxed{\\begin{pmatrix}3.200\\times 10^{3} & 17.28 & -5.787\\times 10^{-5}\\end{pmatrix}}$$", "id": "2917190"}, {"introduction": "While shock waves are inherently nonlinear, their behavior must smoothly connect to the principles of linear elasticity in the limit of zero amplitude. This practice explores that crucial link through the widely used linear relationship between shock speed $U_s$ and particle speed $u_p$. By analyzing the small-amplitude limit of this relation, you will uncover the physical meaning of the intercept $c_0$ and learn how to estimate fundamental material properties, such as the bulk modulus $K$, from shock experiment data. [@problem_id:2917217]", "problem": "A dense, isotropic polycrystalline solid in its ambient, stress-free state has reference mass density $\\rho_0 = 2.70 \\times 10^3\\ \\mathrm{kg/m^3}$. Planar impact experiments produce a principal Hugoniot that is well represented by a linear shock–particle velocity relation of the form $U_s = c_0 + s\\,u_p$ with measured parameters $c_0 = 5.2\\ \\mathrm{km/s}$ and $s = 1.3$. Consider one-dimensional shocks into the initially unstressed material, and assume adiabatic conditions are appropriate for the high-rate loading.\n\nUsing only conservation of mass and momentum across a steady planar shock front and the linear elasticity definitions of moduli for infinitesimal strains, do the following:\n\n1. Starting from the Rankine–Hugoniot jump relations (mass and momentum), take the small-amplitude limit $u_p \\to 0$ and identify what physical wave speed the intercept $c_0$ represents in a solid. From this, derive an expression for the small-strain adiabatic bulk modulus $K$ in terms of $\\rho_0$ and $c_0$.\n\n2. Evaluate the bulk modulus numerically using the given data. Express the final modulus in gigapascals and round your answer to three significant figures.\n\n3. Briefly justify, using linear elasticity for isotropic solids, how the presence of a finite shear modulus $\\mu$ affects the interpretation of longitudinal versus bulk wave speeds in the small-strain limit. Write down, symbolically, the alternative expression one would obtain for $K$ if one incorrectly equated $c_0$ with the longitudinal wave speed of a linearly elastic solid. No numerical evaluation of this alternative expression is required.\n\nState your final numerical answer for the bulk modulus in gigapascals, rounded to three significant figures.", "solution": "The analysis is based on the Rankine–Hugoniot jump conditions for a steady, one-dimensional planar shock wave. Let the shock propagate with speed $U_s$ into a stationary material in a reference state defined by density $\\rho_0$, pressure $p_0$, and particle velocity $u_0 = 0$. The problem states the material is initially unstressed, so the initial longitudinal stress $\\sigma_{xx,0}$ is zero. The state behind the shock is described by density $\\rho$, longitudinal stress $\\sigma_{xx}$, and particle velocity $u_p$.\n\nThe conservation of mass and momentum across the shock front are given by:\n$$ \\rho_0 U_s = \\rho (U_s - u_p) \\quad \\text{(Mass)} $$\n$$ \\sigma_{xx} - \\sigma_{xx,0} = \\rho_0 U_s (u_p - u_0) \\quad \\text{(Momentum)} $$\nWith the initial conditions $\\sigma_{xx,0} = 0$ and $u_0 = 0$, the momentum equation simplifies to:\n$$ \\sigma_{xx} = \\rho_0 U_s u_p $$\n\nThe problem provides an empirical linear relationship between the shock velocity $U_s$ and the particle velocity $u_p$:\n$$ U_s = c_0 + s u_p $$\nwhere $c_0$ and $s$ are material constants.\n\n**Part 1: Identification of $c_0$ and Derivation of Bulk Modulus $K$**\n\nWe are asked to consider the small-amplitude limit, where $u_p \\to 0$. In this limit, the empirical relation shows that the shock speed approaches the intercept value:\n$$ \\lim_{u_p \\to 0} U_s = c_0 $$\nA shock of infinitesimally small amplitude is, by definition, an acoustic wave. Therefore, $c_0$ represents the speed of sound waves in the material under zero-pressure conditions.\n\nTo derive an expression for the bulk modulus $K$, we must relate the stress to the strain. The longitudinal strain across the shock is $\\epsilon_{xx} = 1 - \\frac{\\rho_0}{\\rho}$. From the mass conservation equation, we find $\\frac{\\rho_0}{\\rho} = \\frac{U_s - u_p}{U_s} = 1 - \\frac{u_p}{U_s}$. Thus, the longitudinal strain is:\n$$ \\epsilon_{xx} = \\frac{u_p}{U_s} $$\n\nIn the context of shock physics, particularly at high pressures, it is a common and useful approximation to equate the longitudinal stress $\\sigma_{xx}$ with the hydrostatic pressure $P$. This is the hydrodynamic approximation, where the deviatoric (shear) components of stress are considered negligible compared to the mean stress. Adopting this approximation, we have $P \\approx \\sigma_{xx}$. The volumetric strain $\\theta$ is defined as $\\theta = 1 - V/V_0 = 1 - \\rho_0/\\rho$, which for one-dimensional strain is equal to the longitudinal strain, $\\theta=\\epsilon_{xx}$.\n\nThe adiabatic bulk modulus is defined as $K = -V \\left(\\frac{\\partial P}{\\partial V}\\right)_S$. In terms of density, this is $K = \\rho \\left(\\frac{\\partial P}{\\partial \\rho}\\right)_S$. In the limit of small strains, this can be written as $K \\approx \\frac{\\Delta P}{\\Delta V/V_0} \\approx \\frac{P}{\\theta}$.\nWe express pressure $P$ as a function of volumetric strain $\\theta$:\n$$ P \\approx \\sigma_{xx} = \\rho_0 U_s u_p = \\rho_0 U_s^2 \\left(\\frac{u_p}{U_s}\\right) = \\rho_0 U_s^2 \\theta $$\nIn the limit of zero strain ($\\theta \\to 0$), which corresponds to $u_p \\to 0$, the shock speed $U_s$ approaches $c_0$. The pressure-strain relationship becomes linear:\n$$ P \\approx \\rho_0 c_0^2 \\theta $$\nThe bulk modulus at zero pressure, $K_0$, is the slope of the pressure-strain curve at the origin:\n$$ K \\equiv K_0 = \\left.\\frac{dP}{d\\theta}\\right|_{\\theta=0} = \\rho_0 c_0^2 $$\nUnder this hydrodynamic approximation, the parameter $c_0$ is identified as the zero-pressure bulk sound speed, often denoted $c_B$, where $c_B = \\sqrt{K/\\rho_0}$.\n\n**Part 2: Numerical Evaluation of the Bulk Modulus**\n\nUsing the derived expression and the provided data, we calculate the bulk modulus $K$.\nThe given values are:\n$\\rho_0 = 2.70 \\times 10^3\\ \\mathrm{kg/m^3}$\n$c_0 = 5.2\\ \\mathrm{km/s} = 5.2 \\times 10^3\\ \\mathrm{m/s}$\nSubstituting these into the formula for $K$:\n$$ K = (2.70 \\times 10^3\\ \\mathrm{kg/m^3}) \\times (5.2 \\times 10^3\\ \\mathrm{m/s})^2 $$\n$$ K = 2.70 \\times 10^3 \\times (5.2)^2 \\times 10^6\\ \\mathrm{kg/(m \\cdot s^2)} $$\n$$ K = 2.70 \\times 27.04 \\times 10^9\\ \\mathrm{Pa} $$\n$$ K = 73.008 \\times 10^9\\ \\mathrm{Pa} = 73.008\\ \\mathrm{GPa} $$\nRounding the result to three significant figures, as required:\n$$ K \\approx 73.0\\ \\mathrm{GPa} $$\n\n**Part 3: Effect of Shear Modulus and Alternative Expression**\n\nThe analysis in Part 1 relies on the hydrodynamic approximation, which neglects the material's shear stiffness. An isotropic linear elastic solid is characterized by two independent moduli, for instance, the bulk modulus $K$ and the shear modulus $\\mu$. Such a solid supports two types of acoustic waves.\n1. Longitudinal waves (P-waves), where particle motion is parallel to the wave propagation direction. These waves involve both volumetric and shear deformation. Their speed is given by $c_L = \\sqrt{\\frac{K + \\frac{4}{3}\\mu}{\\rho_0}}$.\n2. Transverse waves (S-waves), where particle motion is perpendicular to the wave propagation direction. These involve only shear deformation and travel at speed $c_S = \\sqrt{\\frac{\\mu}{\\rho_0}}$.\n\nA planar shock induces a state of one-dimensional strain. In the small-amplitude limit, this becomes a one-dimensional elastic wave, which is a longitudinal wave. Therefore, a more physically rigorous interpretation for a solid is that the experimentally measured zero-amplitude wave speed $c_0$ corresponds to the longitudinal wave speed $c_L$.\nThe presence of a finite shear modulus ($\\mu > 0$) provides additional resistance to compression under uniaxial strain, which is why the longitudinal modulus $M = K + \\frac{4}{3}\\mu$ is greater than the bulk modulus $K$. Consequently, the longitudinal wave speed $c_L$ is always greater than the bulk sound speed $c_B = \\sqrt{K/\\rho_0}$ (assuming $\\mu>0$). The interpretation in Part 1, identifying $c_0$ as $c_B$, is therefore a simplification that is only exact for a fluid ($\\mu=0$).\n\nThe problem then asks for an alternative expression for $K$ obtained by equating $c_0$ with the longitudinal wave speed. While the problem labels this approach as \"incorrect,\" it is, from a purely elastic standpoint, the correct identification. We proceed as requested:\n$$ c_0 = c_L = \\sqrt{\\frac{K + \\frac{4}{3}\\mu}{\\rho_0}} $$\nTo find an expression for $K$, we rearrange this equation:\n$$ c_0^2 = \\frac{K + \\frac{4}{3}\\mu}{\\rho_0} $$\n$$ \\rho_0 c_0^2 = K + \\frac{4}{3}\\mu $$\nSolving for $K$ yields the alternative symbolic expression:\n$$ K = \\rho_0 c_0^2 - \\frac{4}{3}\\mu $$\nThis expression explicitly shows that if one accounts for the shear rigidity of the solid, the bulk modulus $K$ is smaller than the value $\\rho_0 c_0^2$ calculated from the hydrodynamic approximation. This is consistent, as $\\rho_0 c_0^2$ would represent the longitudinal modulus $M = K + \\frac{4}{3}\\mu$.", "answer": "$$\n\\boxed{73.0}\n$$", "id": "2917217"}, {"introduction": "The empirical $U_s - u_p$ relation is not a given; it must be determined from experimental measurements, which are inherently noisy. This final practice moves from theory to application, tasking you with a core skill in experimental mechanics: fitting a model to data. You will implement the method of weighted least squares to determine the shock parameters $c_0$ and $s$ from simulated data with non-uniform uncertainties, and importantly, you will learn to quantify the confidence in your estimated parameters. [@problem_id:2684944]", "problem": "You are given experimental measurements of steady, planar shock waves in isotropic solids, where the shock speed $U_s$ and the particle speed $u_p$ are related by an empirical linear relation that is commonly used to parameterize the Rankine–Hugoniot locus at moderate pressures. Assume the dominant measurement uncertainty is in the measured shock speed $U_s$ and that the particle speed $u_p$ is known with negligible uncertainty for the purposes of this fit. The measurement errors in $U_s$ are independent and Gaussian with known, nonidentical standard deviations, i.e., heteroscedastic errors.\n\nStarting from the definitions of least squares, the Gaussian likelihood for independent measurements, and the linear-in-parameters model $U_s = c_0 + s\\,u_p$, you must derive the estimator for the parameters $c_0$ and $s$ under known heteroscedastic variances and compute the associated parameter covariance matrix. Use this to construct two-sided confidence intervals at confidence level $0.95$ for both $c_0$ and $s$ under the assumption that the measurement variances are known exactly and the estimator is Gaussian. Explain the role of the weight matrix in the estimator and why it correctly accounts for heteroscedasticity.\n\nImplement a program that applies your derivation to the following test suite. In each test case, you are given arrays of particle speeds $u_p$ (in m/s), shock speeds $U_s$ (in m/s), and the corresponding standard deviations $\\sigma_{U_s}$ (in m/s) of the $U_s$ measurements. For each test case, fit the linear model $U_s = c_0 + s\\,u_p$ using weighted least squares with weights equal to $1/\\sigma_{U_s}^2$, and report the parameter estimates and their $0.95$ confidence intervals.\n\nTest suite:\n- Case $1$ (well-conditioned, moderate heteroscedasticity):\n  - $u_p$ in m/s: $[400, 800, 1200, 1600, 2000]$\n  - $U_s$ in m/s: $[5893, 6416, 6962, 7480, 8041]$\n  - $\\sigma_{U_s}$ in m/s: $[12, 14, 16, 18, 20]$\n- Case $2$ (boundary case with exactly two data points and unequal uncertainties):\n  - $u_p$ in m/s: $[1000, 2500]$\n  - $U_s$ in m/s: $[7112, 8884]$\n  - $\\sigma_{U_s}$ in m/s: $[15, 35]$\n- Case $3$ (includes $u_p = 0$ to strongly constrain $c_0$ and high dynamic range in uncertainties):\n  - $u_p$ in m/s: $[0, 300, 900, 1800, 2400]$\n  - $U_s$ in m/s: $[3810, 4363, 5527, 7211, 8340]$\n  - $\\sigma_{U_s}$ in m/s: $[8, 12, 20, 26, 32]$\n\nRequirements for numerical reporting:\n- Report $c_0$ and its confidence interval bounds in m/s.\n- Report $s$ and its confidence interval bounds as dimensionless quantities.\n- Use a two-sided confidence level of $0.95$ based on the Gaussian quantile associated with tail probability $0.025$.\n- Round all reported numeric values to $3$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of the form $[c_0, s, c_{0,\\mathrm{lower}}, c_{0,\\mathrm{upper}}, s_{\\mathrm{lower}}, s_{\\mathrm{upper}}]$. For all three cases, the final output must therefore be a list of three such lists, e.g., $[[\\dots],[\\dots],[\\dots]]$.", "solution": "The fundamental task is to fit a linear model of the form $U_s = c_0 + s\\,u_p$ to a set of $N$ experimental data points $(u_{p,i}, U_{s,i})$ where $i = 1, \\dots, N$. The measurements of shock speed, $U_{s,i}$, are assumed to be independent and corrupted by Gaussian noise with zero mean and known, non-identical variances $\\sigma_i^2 = \\sigma_{U_s, i}^2$. The particle speeds, $u_{p,i}$, are treated as independent variables known with negligible uncertainty.\n\nWe can express the model in matrix notation. Let $\\boldsymbol{y}$ be the $N \\times 1$ column vector of observed shock speeds $U_{s,i}$, $\\boldsymbol{\\beta}$ be the $2 \\times 1$ column vector of parameters to be estimated, $\\boldsymbol{\\beta} = [c_0, s]^T$, and $\\boldsymbol{X}$ be the $N \\times 2$ design matrix. The model is written as:\n$$\n\\boldsymbol{y} = \\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}\n$$\nwhere $\\boldsymbol{\\epsilon}$ is the $N \\times 1$ vector of measurement errors. The components of these vectors and matrix are:\n$$\n\\boldsymbol{y} = \\begin{pmatrix} U_{s,1} \\\\ U_{s,2} \\\\ \\vdots \\\\ U_{s,N} \\end{pmatrix}, \\quad\n\\boldsymbol{X} = \\begin{pmatrix} 1 & u_{p,1} \\\\ 1 & u_{p,2} \\\\ \\vdots & \\vdots \\\\ 1 & u_{p,N} \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} c_0 \\\\ s \\end{pmatrix}, \\quad\n\\boldsymbol{\\epsilon} = \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\vdots \\\\ \\epsilon_N \\end{pmatrix}\n$$\nThe errors $\\epsilon_i$ are independent, so their covariance matrix $\\boldsymbol{\\Sigma}$ is diagonal. The expectation of the errors is $E[\\boldsymbol{\\epsilon}] = \\boldsymbol{0}$, and the covariance is given by:\n$$\n\\boldsymbol{\\Sigma} = \\text{Cov}(\\boldsymbol{\\epsilon}) = E[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T] = \\begin{pmatrix} \\sigma_1^2 & 0 & \\dots & 0 \\\\ 0 & \\sigma_2^2 & \\dots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\dots & \\sigma_N^2 \\end{pmatrix}\n$$\nThe problem is to find the best estimate for the parameter vector $\\boldsymbol{\\beta}$, denoted $\\hat{\\boldsymbol{\\beta}}$. Given that the errors are Gaussian, the optimal estimator is derived from the principle of maximum likelihood. The probability density function of a single observation $y_i$ is:\n$$\np(y_i | u_{p,i}, \\boldsymbol{\\beta}, \\sigma_i) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - (c_0 + s u_{p,i}))^2}{2\\sigma_i^2}\\right)\n$$\nSince the measurements are independent, the likelihood for the entire dataset $\\boldsymbol{y}$ is the product of the individual probabilities:\n$$\nL(\\boldsymbol{\\beta}; \\boldsymbol{y}) = \\prod_{i=1}^{N} p(y_i) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{2\\sigma_i^2}\\right)\n$$\nMaximizing the likelihood $L$ is equivalent to maximizing its logarithm, the log-likelihood $\\ln L$:\n$$\n\\ln L(\\boldsymbol{\\beta}; \\boldsymbol{y}) = -\\frac{N}{2}\\ln(2\\pi) - \\frac{1}{2}\\sum_{i=1}^{N}\\ln(\\sigma_i^2) - \\frac{1}{2}\\sum_{i=1}^{N}\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2}\n$$\nTo maximize $\\ln L$ with respect to $\\boldsymbol{\\beta}$, we must minimize the sum of squared weighted residuals, often denoted as $\\chi^2$:\n$$\n\\chi^2(\\boldsymbol{\\beta}) = \\sum_{i=1}^{N}\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2}\n$$\nThis is the central criterion for the method of weighted least squares (WLS). We introduce the weight matrix $\\boldsymbol{W}$, which is defined as the inverse of the error covariance matrix:\n$$\n\\boldsymbol{W} = \\boldsymbol{\\Sigma}^{-1} = \\text{diag}\\left(\\frac{1}{\\sigma_1^2}, \\frac{1}{\\sigma_2^2}, \\dots, \\frac{1}{\\sigma_N^2}\\right)\n$$\nThe role of the weight matrix is to give more importance to measurements with smaller uncertainty. Each squared residual $(y_i - \\text{model}_i)^2$ is weighted by $w_i = 1/\\sigma_i^2$. Data points with high precision (small $\\sigma_i$) receive a large weight, thus influencing the fit more strongly. Conversely, noisy data points (large $\\sigma_i$) are down-weighted. This procedure ensures that the estimator is maximally informed by the most reliable data, which, as shown by the derivation from maximum likelihood, is the statistically optimal approach for this problem.\n\nIn matrix form, the $\\chi^2$ function is:\n$$\n\\chi^2(\\boldsymbol{\\beta}) = (\\boldsymbol{y} - \\boldsymbol{X}\\boldsymbol{\\beta})^T \\boldsymbol{W} (\\boldsymbol{y} - \\boldsymbol{X}\\boldsymbol{\\beta})\n$$\nTo find the minimum, we compute the gradient of $\\chi^2$ with respect to $\\boldsymbol{\\beta}$ and set it to zero:\n$$\n\\nabla_{\\boldsymbol{\\beta}} \\chi^2 = -2\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X}\\boldsymbol{\\beta} = \\boldsymbol{0}\n$$\nThis gives the \"normal equations\" for weighted least squares:\n$$\n(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})\\hat{\\boldsymbol{\\beta}} = \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y}\n$$\nSolving for the parameter estimator $\\hat{\\boldsymbol{\\beta}}$ yields:\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y}\n$$\nThe covariance matrix of the estimator, $\\boldsymbol{C}_{\\beta} = \\text{Cov}(\\hat{\\boldsymbol{\\beta}})$, is found by error propagation.\n$$\n\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\text{Cov}((\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y})\n$$\nSince $\\boldsymbol{X}$ and $\\boldsymbol{W}$ are constants, and $\\text{Cov}(\\boldsymbol{y}) = \\boldsymbol{\\Sigma} = \\boldsymbol{W}^{-1}$:\n$$\n\\boldsymbol{C}_{\\beta} = [(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}] \\boldsymbol{\\Sigma} [(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}]^T\n$$\n$$\n\\boldsymbol{C}_{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W} \\boldsymbol{W}^{-1} \\boldsymbol{W}^T\\boldsymbol{X} (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1}\n$$\nSince $\\boldsymbol{W}$ is diagonal, it is symmetric ($\\boldsymbol{W}^T = \\boldsymbol{W}$). This simplifies to:\n$$\n\\boldsymbol{C}_{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X}) (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1}\n$$\nThe variances of the parameter estimates $\\hat{c}_0$ and $\\hat{s}$ are the diagonal elements of this covariance matrix:\n$$\n\\sigma_{\\hat{c}_0}^2 = (\\boldsymbol{C}_{\\beta})_{11}, \\quad \\sigma_{\\hat{s}}^2 = (\\boldsymbol{C}_{\\beta})_{22}\n$$\nThe standard errors are the square roots of these variances.\nFor a two-sided confidence interval at a $1-\\alpha$ confidence level, we use the formula $\\hat{\\theta} \\pm z_{1-\\alpha/2} \\sigma_{\\hat{\\theta}}$. The problem specifies a confidence level of $0.95$, so $\\alpha = 0.05$ and $\\alpha/2 = 0.025$. We require the standard normal quantile $z_{0.975}$, which is approximately $1.96$. A precise value will be used in the computation. The assumption that measurement variances are known exactly justifies using the normal distribution quantile rather than a t-distribution quantile.\nThe confidence intervals are:\n$$\nc_{0, \\text{interval}} = \\hat{c}_0 \\pm z_{0.975} \\sigma_{\\hat{c}_0}\n$$\n$$\ns_{\\text{interval}} = \\hat{s} \\pm z_{0.975} \\sigma_{\\hat{s}}\n$$\nThe implementation will apply these formulas to the three test cases provided. All numerical results will be rounded to three decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Applies weighted least squares to fit a linear Hugoniot relation\n    and computes parameter confidence intervals.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (well-conditioned, moderate heteroscedasticity)\n        {\n            \"up_ms\": np.array([400, 800, 1200, 1600, 2000]),\n            \"Us_ms\": np.array([5893, 6416, 6962, 7480, 8041]),\n            \"sigma_Us_ms\": np.array([12, 14, 16, 18, 20]),\n        },\n        # Case 2 (boundary case with exactly two data points)\n        {\n            \"up_ms\": np.array([1000, 2500]),\n            \"Us_ms\": np.array([7112, 8884]),\n            \"sigma_Us_ms\": np.array([15, 35]),\n        },\n        # Case 3 (includes up=0 and high dynamic range in uncertainties)\n        {\n            \"up_ms\": np.array([0, 300, 900, 1800, 2400]),\n            \"Us_ms\": np.array([3810, 4363, 5527, 7211, 8340]),\n            \"sigma_Us_ms\": np.array([8, 12, 20, 26, 32]),\n        }\n    ]\n\n    all_results = []\n    \n    # Critical value z for 95% confidence interval (two-sided)\n    alpha = 0.05\n    z_critical = norm.ppf(1 - alpha / 2)\n\n    for case in test_cases:\n        up = case[\"up_ms\"]\n        Us = case[\"Us_ms\"]\n        sigma_Us = case[\"sigma_Us_ms\"]\n\n        # 1. Construct the design matrix X\n        # X has a column of ones for the intercept c0\n        # and a column of up values for the slope s.\n        X = np.vstack([np.ones_like(up), up]).T\n\n        # 2. Construct the observation vector y\n        y = Us\n\n        # 3. Construct the weight matrix W\n        # W is diagonal with entries 1 / sigma_i^2\n        # For matrix operations, we can form it as a diagonal matrix.\n        W = np.diag(1.0 / sigma_Us**2)\n\n        # 4. Calculate the parameter estimates beta_hat = (c0_hat, s_hat)\n        # beta_hat = (X^T * W * X)^-1 * X^T * W * y\n        # We compute the parts separately for clarity.\n        XT_W = X.T @ W\n        XT_W_X = XT_W @ X\n        XT_W_y = XT_W @ y\n        \n        # Invert the matrix (X^T * W * X)\n        XT_W_X_inv = np.linalg.inv(XT_W_X)\n\n        beta_hat = XT_W_X_inv @ XT_W_y\n        c0_hat = beta_hat[0]\n        s_hat = beta_hat[1]\n\n        # 5. Calculate the parameter covariance matrix C_beta\n        # C_beta = (X^T * W * X)^-1\n        C_beta = XT_W_X_inv\n\n        # 6. Extract standard errors for the parameters\n        # These are the square roots of the diagonal elements of C_beta\n        var_c0 = C_beta[0, 0]\n        var_s = C_beta[1, 1]\n        std_err_c0 = np.sqrt(var_c0)\n        std_err_s = np.sqrt(var_s)\n        \n        # 7. Calculate confidence intervals\n        c0_lower = c0_hat - z_critical * std_err_c0\n        c0_upper = c0_hat + z_critical * std_err_c0\n        s_lower = s_hat - z_critical * std_err_s\n        s_upper = s_hat + z_critical * std_err_s\n\n        # 8. Round all results to 3 decimal places and collect them.\n        case_results = [\n            round(c0_hat, 3),\n            round(s_hat, 3),\n            round(c0_lower, 3),\n            round(c0_upper, 3),\n            round(s_lower, 3),\n            round(s_upper, 3)\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is used, removing spaces.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "2684944"}]}