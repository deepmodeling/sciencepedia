{"hands_on_practices": [{"introduction": "The origin of a material's stiffness lies at the atomic scale, specifically in the curvature of the potential energy landscape that governs interatomic interactions. This exercise provides a foundational, first-principles derivation connecting the macroscopic bulk modulus, $B$, to the second derivative of a pair potential, $U''(r)$. By comparing two classic models, the Lennard-Jones and Morse potentials, you will gain a concrete understanding of how the shape of the potential well directly dictates a material's resistance to compression. [@problem_id:2765203]", "problem": "A monatomic face-centered cubic (fcc) crystal is modeled by a central pair potential with only nearest-neighbor interactions contributing to the cohesive energy. Two alternative interatomic potentials are considered:\n\n1) The Lennard–Jones potential, given by $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$.\n\n2) The Morse potential, given by $U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$.\n\nAssume the following modeling choices:\n- The cohesive well depths are matched: $D = \\epsilon$.\n- The equilibrium nearest-neighbor distance is matched by choosing the Morse parameter $r_{0}$ equal to the Lennard–Jones equilibrium separation.\n- Zero temperature and hydrostatic loading are assumed. The fcc coordination number is $z=12$, the nearest-neighbor distance is related to the cubic lattice parameter by $r = a/\\sqrt{2}$, and the per-atom volume is $\\Omega = a^{3}/4$.\n\nStarting from first principles, use the following standard bases only: Newtonian mechanics, the definition of strain, pairwise additivity of energy, and the thermodynamic definition of the bulk modulus $B$ as the second derivative of the energy with respect to volume at equilibrium. Proceed as follows:\n- Determine the equilibrium separation $r_{\\mathrm{LJ}}$ that minimizes $U_{\\mathrm{LJ}}(r)$.\n- Compute the curvatures $U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ and $U_{\\mathrm{M}}''(r_{0})$ at their respective minima.\n- Derive the bulk modulus $B$ of the fcc crystal in terms of the pair potential curvature at the equilibrium nearest-neighbor distance and the lattice geometry, under the stated nearest-neighbor approximation.\n- Using the matched-depth and matched-distance conditions, determine the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ as a closed-form analytic expression in terms of the parameters $\\alpha$ and $\\sigma$ only.\n\nProvide your final answer as a single closed-form analytic expression for the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$. Do not include units in the final boxed answer.", "solution": "The problem requires the determination of the ratio of the bulk moduli, $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$, for a face-centered cubic (fcc) crystal modeled with Lennard-Jones (LJ) and Morse (M) pair potentials, respectively. The analysis will proceed from first principles, under a nearest-neighbor interaction approximation.\n\nFirst, the given interatomic potentials are:\nThe Lennard-Jones potential: $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$.\nThe Morse potential: $U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$.\n\nThe problem specifies the following matching conditions: the potential well depths are equal, $D = \\epsilon$, and the equilibrium separation for the Morse potential, $r_{0}$, is set to the equilibrium separation of the LJ potential, which we denote $r_{\\mathrm{LJ}}$.\n\nThe solution proceeds in four stages as mandated:\n1.  Determine the equilibrium separation $r_{\\mathrm{LJ}}$ for the Lennard-Jones potential.\n2.  Calculate the second derivatives (curvatures) of both potentials, $U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ and $U_{\\mathrm{M}}''(r_{0})$, at their respective equilibrium separations.\n3.  Derive a general expression for the bulk modulus $B$ of an fcc crystal within the nearest-neighbor approximation.\n4.  Combine these results to find the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$.\n\n**Step 1: Equilibrium Separation of the Lennard-Jones Potential**\n\nThe equilibrium separation $r_{\\mathrm{LJ}}$ is the interatomic distance that minimizes the potential energy $U_{\\mathrm{LJ}}(r)$. This is found by setting the first derivative of the potential with respect to $r$ to zero.\n$$ \\frac{dU_{\\mathrm{LJ}}}{dr} = 4 \\epsilon \\left[ \\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7} \\right] $$\nSetting $\\frac{dU_{\\mathrm{LJ}}}{dr} = 0$:\n$$ 4 \\epsilon \\left[ -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^{6}}{r^{7}} \\right] = 0 $$\n$$ 6 \\frac{\\sigma^{6}}{r^{7}} = 12 \\frac{\\sigma^{12}}{r^{13}} $$\nThis simplifies to $r^{6} = 2\\sigma^{6}$, which yields the equilibrium separation:\n$$ r_{\\mathrm{LJ}} = 2^{1/6} \\sigma $$\n\n**Step 2: Curvature of the Potentials at Equilibrium**\n\nFirst, we find the second derivative of the Lennard-Jones potential, $U_{\\mathrm{LJ}}''(r)$.\n$$ U_{\\mathrm{LJ}}''(r) = \\frac{d^2 U_{\\mathrm{LJ}}}{dr^2} = 4 \\epsilon \\left[ (-12)(-13)\\sigma^{12}r^{-14} - (6)(-7)\\sigma^{6}r^{-8} \\right] $$\n$$ U_{\\mathrm{LJ}}''(r) = 4 \\epsilon \\left[ 156 \\frac{\\sigma^{12}}{r^{14}} - 42 \\frac{\\sigma^{6}}{r^{8}} \\right] $$\nWe evaluate this at $r = r_{\\mathrm{LJ}} = 2^{1/6} \\sigma$. At this distance, we have the relations $r_{\\mathrm{LJ}}^{6} = 2\\sigma^{6}$ and $r_{\\mathrm{LJ}}^{12} = 4\\sigma^{12}$.\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{r_{\\mathrm{LJ}}^{2}} \\left[ 156 \\frac{\\sigma^{12}}{r_{\\mathrm{LJ}}^{12}} - 42 \\frac{\\sigma^{6}}{r_{\\mathrm{LJ}}^{6}} \\right] = \\frac{4\\epsilon}{(2^{1/6}\\sigma)^{2}} \\left[ 156 \\left(\\frac{1}{4}\\right) - 42 \\left(\\frac{1}{2}\\right) \\right] $$\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{2^{1/3}\\sigma^{2}} \\left[ 39 - 21 \\right] = \\frac{4\\epsilon(18)}{2^{1/3}\\sigma^{2}} = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n\nNext, we find the second derivative of the Morse potential, $U_{\\mathrm{M}}''(r)$. The first derivative is:\n$$ U_{\\mathrm{M}}'(r) = D \\cdot 2\\left[1 - \\exp\\left(-\\alpha(r-r_0)\\right)\\right] \\cdot \\left( \\alpha \\exp\\left(-\\alpha(r-r_0)\\right) \\right) $$\n$$ U_{\\mathrm{M}}'(r) = 2D\\alpha \\left[ \\exp\\left(-\\alpha(r-r_0)\\right) - \\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\nThe second derivative is:\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha \\left[ -\\alpha\\exp\\left(-\\alpha(r-r_0)\\right) - (-2\\alpha)\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha^{2} \\left[ -\\exp\\left(-\\alpha(r-r_0)\\right) + 2\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\nThe equilibrium separation for the Morse potential is at $r=r_0$. Evaluating the curvature at this point:\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^{2} \\left[ -\\exp(0) + 2\\exp(0) \\right] = 2D\\alpha^{2} \\left[ -1 + 2 \\right] = 2D\\alpha^{2} $$\n\n**Step 3: Derivation of the Bulk Modulus**\n\nThe total energy per atom, $E$, in a nearest-neighbor model is $E = \\frac{1}{2}z U(r)$, where $z$ is the coordination number. For an fcc lattice, $z=12$, so $E(r) = 6U(r)$. The bulk modulus at zero temperature is defined as $B = \\Omega_0 \\left( \\frac{d^2 E}{d\\Omega^2} \\right)_{\\Omega=\\Omega_0}$, where $\\Omega$ is the volume per atom and $\\Omega_0$ is the equilibrium volume per atom.\n\nFor an fcc lattice, the nearest-neighbor distance $r$ is related to the cubic lattice parameter $a$ by $r=a/\\sqrt{2}$. The volume per atom is $\\Omega = a^3/4$. We express $\\Omega$ in terms of $r$:\n$$ a = r\\sqrt{2} \\implies \\Omega(r) = \\frac{(r\\sqrt{2})^3}{4} = \\frac{2\\sqrt{2}r^3}{4} = \\frac{r^3}{\\sqrt{2}} $$\nWe now compute the derivatives using the chain rule.\n$$ \\frac{dE}{d\\Omega} = \\frac{dE/dr}{d\\Omega/dr} = \\frac{6 U'(r)}{3r^2/\\sqrt{2}} = \\frac{2\\sqrt{2}U'(r)}{r^2} $$\nThe second derivative is:\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{d}{d\\Omega}\\left( \\frac{dE}{d\\Omega} \\right) = \\frac{d/dr(dE/d\\Omega)}{d\\Omega/dr} = \\frac{\\frac{d}{dr}\\left(\\frac{2\\sqrt{2}U'(r)}{r^2}\\right)}{3r^2/\\sqrt{2}} $$\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{2\\sqrt{2} \\left( \\frac{U''(r)r^2 - 2rU'(r)}{r^4} \\right)}{3r^2/\\sqrt{2}} = \\frac{4}{3r^5} \\left( rU''(r) - 2U'(r) \\right) $$\nAt equilibrium, $r=r_e$, the first derivative of the potential is zero, $U'(r_e)=0$. Thus, the expression simplifies to:\n$$ \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{4}{3r_e^5} \\left( r_e U''(r_e) \\right) = \\frac{4U''(r_e)}{3r_e^4} $$\nThe equilibrium volume is $\\Omega_0 = r_e^3/\\sqrt{2}$. Substituting into the definition of $B$:\n$$ B = \\Omega_0 \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{r_e^3}{\\sqrt{2}} \\cdot \\frac{4U''(r_e)}{3r_e^4} = \\frac{4U''(r_e)}{3\\sqrt{2}r_e} = \\frac{2\\sqrt{2}U''(r_e)}{3r_e} $$\n\n**Step 4: Ratio of Bulk Moduli**\n\nUsing the derived expression for $B$, the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ is:\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{2\\sqrt{2}U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{3r_{\\mathrm{LJ}}} }{ \\frac{2\\sqrt{2}U_{\\mathrm{M}}''(r_{0})}{3r_{0}} } $$\nGiven the condition $r_{\\mathrm{LJ}} = r_{0}$, the geometric factors cancel, and the ratio simplifies to the ratio of the potential curvatures:\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{U_{\\mathrm{M}}''(r_{0})} $$\nSubstituting the calculated curvatures and using the condition $D = \\epsilon$:\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^2 = 2\\epsilon\\alpha^2 $$\nThe ratio is therefore:\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} }{ 2\\epsilon\\alpha^2 } = \\frac{72}{2 \\cdot 2^{1/3} \\alpha^2 \\sigma^2} = \\frac{36}{2^{1/3} \\alpha^2 \\sigma^2} $$\nThis is the final analytical expression for the ratio in terms of the specified parameters $\\alpha$ and $\\sigma$.", "answer": "$$\\boxed{\\frac{36}{2^{1/3} \\alpha^{2} \\sigma^{2}}}$$", "id": "2765203"}, {"introduction": "Building on the static, zero-temperature picture, this practice delves into the more realistic scenario of elasticity at finite temperatures, as encountered in molecular dynamics (MD) simulations. You will explore how elastic constants are computed in a statistical mechanics framework, distinguishing between the static \"Born term\" and contributions from thermal fluctuations. This exercise clarifies the critical thermodynamic distinction between isothermal ($C^T_{ijkl}$) and adiabatic ($C^S_{ijkl}$) elastic constants, providing the theoretical tools necessary to correctly interpret and analyze results from atomistic simulations. [@problem_id:2765170]", "problem": "A crystalline solid is simulated with classical Molecular Dynamics (MD) in the canonical ensemble at fixed simulation cell (homogeneous strain held fixed) and fixed number of particles. The microscopic Cauchy stress is sampled and averaged in equilibrium at temperature $T$. In linear elasticity, the isothermal elastic stiffness tensor is defined as $C^{T}_{ijkl} \\equiv \\left(\\partial \\sigma_{ij}/\\partial \\epsilon_{kl}\\right)_{T}$, whereas the adiabatic elastic stiffness tensor is $C^{S}_{ijkl} \\equiv \\left(\\partial \\sigma_{ij}/\\partial \\epsilon_{kl}\\right)_{S}$, where $S$ is the total entropy. From an atomistic perspective, the isothermal elastic constants have a static contribution from the second derivatives of the potential energy with respect to strain (often called the Born term), as well as contributions originating from thermal fluctuations. High-frequency elastic response in solids is closer to adiabatic, while low-frequency static loading is closer to isothermal. In equilibrium MD at fixed cell, one can also access the derivative $\\left(\\partial \\sigma_{ij}/\\partial T\\right)_{\\epsilon}$ and the heat capacity at fixed strain, either as a total $C_{\\epsilon}$ or as a volumetric quantity $c_{\\epsilon} \\equiv C_{\\epsilon}/V$.\n\nWhich option correctly states, in a form suitable for practical MD evaluation, both the decomposition of $C^{T}_{ijkl}$ into atomistic contributions in the canonical ensemble and the exact thermodynamic transformation that yields $C^{S}_{ijkl}$ from $C^{T}_{ijkl}$ using the heat capacity and stress–temperature derivatives, including the correct specification of the conditions under which each quantity is measured?\n\nA. In the canonical ensemble at fixed homogeneous strain, the isothermal tensor admits a decomposition $C^{T}_{ijkl} = C^{\\mathrm{Born}}_{ijkl} + C^{\\mathrm{kin}}_{ijkl} - \\dfrac{V}{k_{\\mathrm{B}}\\,T}\\left(\\langle \\delta \\sigma_{ij}\\,\\delta \\sigma_{kl}\\rangle\\right)$, where $C^{\\mathrm{Born}}_{ijkl}$ is the ensemble average of the second strain derivatives of the potential energy, $C^{\\mathrm{kin}}_{ijkl}$ is the kinetic contribution, and $\\langle \\delta \\sigma_{ij}\\,\\delta \\sigma_{kl}\\rangle$ is the stress covariance; the adiabatic tensor is obtained from\n$$\nC^{S}_{ijkl} \\;=\\; C^{T}_{ijkl} \\;+\\; \\frac{T}{c_{\\epsilon}}\\,\n\\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\n\\left(\\frac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon}\n\\;=\\; C^{T}_{ijkl} \\;+\\; \\frac{T\\,V}{C_{\\epsilon}}\\,\n\\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\n\\left(\\frac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon}.\n$$\nIn MD, $C^{T}_{ijkl}$ follows from the stress fluctuation formula at fixed strain, $c_{\\epsilon}$ follows from energy fluctuations at fixed strain via $C_{\\epsilon} = \\langle \\delta E^{2}\\rangle/(k_{\\mathrm{B}}\\,T^{2})$, and $\\left(\\partial \\sigma_{ij}/\\partial T\\right)_{\\epsilon}$ is obtained by regressing the mean stress versus $T$ with the cell held fixed.\n\nB. The adiabatic and isothermal tensors differ by subtracting stress fluctuations, $C^{S}_{ijkl} = C^{T}_{ijkl} - \\dfrac{V}{k_{\\mathrm{B}}\\,T}\\left(\\langle \\delta \\sigma_{ij}\\,\\delta \\sigma_{kl}\\rangle\\right)$, so that adiabatic constants are “Born only.” The needed heat capacity does not enter, and $\\left(\\partial \\sigma_{ij}/\\partial T\\right)_{\\epsilon}$ is unnecessary.\n\nC. The correct link is $C^{S}_{ijkl} = C^{T}_{ijkl} + \\dfrac{T}{c_{\\sigma}}\\,\\alpha_{ij}\\,\\alpha_{kl}$, where $\\alpha_{ij} \\equiv \\left(\\partial \\epsilon_{ij}/\\partial T\\right)_{\\sigma}$ is the thermal expansion tensor and $c_{\\sigma}$ is the heat capacity per volume at constant stress; practically, one should run isothermal–isobaric MD to obtain $c_{\\sigma}$ from enthalpy fluctuations and $\\alpha_{ij}$ from the slope of mean strain versus $T$ at fixed stress.\n\nD. The transformation is $C^{S}_{ijkl} = C^{T}_{ijkl} + \\dfrac{V}{C_{\\epsilon}}\\,\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\\left(\\dfrac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon}$, without any additional temperature factor; to obtain $C_{\\epsilon}$ one should use kinetic energy fluctuations only, since potential energy fluctuations do not contribute at fixed strain.\n\nE. In the thermodynamic limit, $C^{S}_{ijkl} = C^{T}_{ijkl}$ for any crystal at nonzero temperature $T$, so no correction is needed; the Born term alone suffices if the system is large.", "solution": "The problem asks for the correct theoretical expressions for the isothermal elastic stiffness tensor ($C^{T}_{ijkl}$) in the canonical ensemble and the thermodynamic transformation to the adiabatic stiffness tensor ($C^{S}_{ijkl}$), along with the methods for their evaluation in molecular dynamics (MD).\n\n### Problem Validation Verdict\nThe problem statement is valid. It is scientifically grounded in the principles of statistical mechanics and thermodynamics as applied to condensed matter physics. The definitions are standard, the setup is well-posed, and the question is objective and unambiguous. It poses a non-trivial question relevant to the field of computational materials science.\n\n### Principle-Based Derivation\nThe solution requires addressing two main parts: the statistical mechanical expression for $C^{T}_{ijkl}$ and the thermodynamic relation between $C^{S}_{ijkl}$ and $C^{T}_{ijkl}$.\n\n**1. Isothermal Elastic Stiffness Tensor, $C^{T}_{ijkl}$, in the Canonical Ensemble**\n\nThe isothermal elastic stiffness is defined as the derivative of stress with respect to strain at constant temperature: $C^{T}_{ijkl} \\equiv \\left(\\partial \\sigma_{ij}/\\partial \\epsilon_{kl}\\right)_{T}$. In the canonical ensemble (fixed number of particles $N$, volume $V$, and temperature $T$), the ensemble average of a quantity $A$ is denoted $\\langle A \\rangle$. The stiffness tensor is therefore $C^{T}_{ijkl} = \\left(\\partial \\langle\\sigma_{ij}\\rangle/\\partial \\epsilon_{kl}\\right)_{T}$.\n\nUsing linear response theory and fluctuation formulas from statistical mechanics, the isothermal elastic constants in the canonical ensemble (or more precisely, the constant strain, constant temperature ensemble) can be expressed as a sum of several contributions. The general expression, known as the stress-fluctuation formula, is:\n$$ C^{T}_{ijkl} = C^{\\mathrm{direct}}_{ijkl} - \\frac{V}{k_{\\mathrm{B}}T} \\left( \\langle \\sigma_{ij} \\sigma_{kl} \\rangle - \\langle \\sigma_{ij} \\rangle \\langle \\sigma_{kl} \\rangle \\right) = C^{\\mathrm{direct}}_{ijkl} - \\frac{V}{k_{\\mathrm{B}}T} \\langle \\delta\\sigma_{ij} \\delta\\sigma_{kl} \\rangle $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the temperature, $V$ is the volume, and $\\delta\\sigma_{ij} = \\sigma_{ij} - \\langle\\sigma_{ij}\\rangle$ is the instantaneous fluctuation of the microscopic stress tensor. The term $C^{\\mathrm{direct}}_{ijkl}$ arises from the explicit strain dependence of the microscopic stress operator and can be further decomposed into a potential energy part (the Born term) and a kinetic energy part.\n$$ C^{\\mathrm{direct}}_{ijkl} = \\left\\langle \\frac{\\partial \\sigma_{ij}}{\\partial \\epsilon_{kl}} \\right\\rangle = C^{\\mathrm{Born}}_{ijkl} + C^{\\mathrm{kin}}_{ijkl} $$\nThe Born term is the ensemble average of the second derivative of the potential energy $U$ with respect to strain:\n$$ C^{\\mathrm{Born}}_{ijkl} = \\left\\langle \\frac{1}{V} \\frac{\\partial^2 U}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}} \\right\\rangle $$\nThe kinetic term $C^{\\mathrm{kin}}_{ijkl}$ arises from the strain dependence of the kinetic part of the stress tensor. Its exact form can be complex but represents a genuine contribution.\n\nThus, the full expression can be written as:\n$$ C^{T}_{ijkl} = C^{\\mathrm{Born}}_{ijkl} + C^{\\mathrm{kin}}_{ijkl} - \\frac{V}{k_{\\mathrm{B}}T} \\langle \\delta\\sigma_{ij} \\delta\\sigma_{kl} \\rangle $$\nThis decomposition is a standard result in the literature on atomistic calculations of elastic constants.\n\n**2. Thermodynamic Transformation from $C^{T}_{ijkl}$ to $C^{S}_{ijkl}$**\n\nThe adiabatic elastic stiffness is defined as $C^{S}_{ijkl} \\equiv \\left(\\partial \\sigma_{ij}/\\partial \\epsilon_{kl}\\right)_{S}$, where $S$ is entropy. To relate this to the isothermal stiffness $C^{T}_{ijkl}$, we employ standard thermodynamic transformations for partial derivatives.\nWe wish to express $\\left(\\frac{\\partial \\sigma_{ij}}{\\partial \\epsilon_{kl}}\\right)_S$ in terms of derivatives at constant $T$. The appropriate identity is:\n$$ \\left(\\frac{\\partial y}{\\partial x}\\right)_z = \\left(\\frac{\\partial y}{\\partial x}\\right)_w + \\left(\\frac{\\partial y}{\\partial w}\\right)_x \\left(\\frac{\\partial w}{\\partial x}\\right)_z $$\nLetting $y=\\sigma_{ij}$, $x=\\epsilon_{kl}$, $z=S$, and $w=T$, we have:\n$$ \\left(\\frac{\\partial \\sigma_{ij}}{\\partial \\epsilon_{kl}}\\right)_S = \\left(\\frac{\\partial \\sigma_{ij}}{\\partial \\epsilon_{kl}}\\right)_T + \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} \\left(\\frac{\\partial T}{\\partial \\epsilon_{kl}}\\right)_S $$\nThis gives the preliminary relation:\n$$ C^{S}_{ijkl} = C^{T}_{ijkl} + \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} \\left(\\frac{\\partial T}{\\partial \\epsilon_{kl}}\\right)_S $$\nThe term $\\left(\\frac{\\partial T}{\\partial \\epsilon_{kl}}\\right)_S$ can be rewritten using a Maxwell relation derived from the fundamental thermodynamic relation for internal energy $U$ of a solid, $dU = TdS + V_0 \\sigma_{ab} d\\epsilon_{ab}$ (where $V_0$ is the reference volume, hereafter written as $V$):\n$$ \\left(\\frac{\\partial T}{\\partial \\epsilon_{kl}}\\right)_S = V \\left(\\frac{\\partial \\sigma_{kl}}{\\partial S}\\right)_{\\epsilon} $$\nNext, we use the chain rule to change the variable from $S$ to $T$:\n$$ \\left(\\frac{\\partial \\sigma_{kl}}{\\partial S}\\right)_{\\epsilon} = \\left(\\frac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon} \\left(\\frac{\\partial T}{\\partial S}\\right)_{\\epsilon} $$\nThe heat capacity at constant strain is defined as $C_{\\epsilon} = T\\left(\\frac{\\partial S}{\\partial T}\\right)_{\\epsilon}$, which implies $\\left(\\frac{\\partial T}{\\partial S}\\right)_{\\epsilon} = \\frac{T}{C_{\\epsilon}}$.\nSubstituting this back, we get:\n$$ \\left(\\frac{\\partial T}{\\partial \\epsilon_{kl}}\\right)_S = V \\left(\\frac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon} \\frac{T}{C_{\\epsilon}} $$\nFinally, substituting this expression into the equation for $C^{S}_{ijkl}$:\n$$ C^{S}_{ijkl} = C^{T}_{ijkl} + \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} \\left( \\frac{TV}{C_{\\epsilon}} \\left(\\frac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon} \\right) $$\nIntroducing the volumetric heat capacity $c_{\\epsilon} = C_{\\epsilon}/V$, the relation becomes:\n$$ C^{S}_{ijkl} = C^{T}_{ijkl} + \\frac{T}{c_{\\epsilon}} \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} \\left(\\frac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon} = C^{T}_{ijkl} + \\frac{TV}{C_{\\epsilon}} \\left(\\frac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon} \\left(\\frac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon} $$\nThis is the exact thermodynamic transformation.\n\n### Option-by-Option Analysis\n\n**A. In the canonical ensemble at fixed homogeneous strain...**\nThis option presents two key formulas.\nFirst, the decomposition of the isothermal tensor: $C^{T}_{ijkl} = C^{\\mathrm{Born}}_{ijkl} + C^{\\mathrm{kin}}_{ijkl} - \\dfrac{V}{k_{\\mathrm{B}}\\,T}\\left(\\langle \\delta \\sigma_{ij}\\,\\delta \\sigma_{kl}\\rangle\\right)$. As shown in the derivation above, this is the correct structure of the stress-fluctuation formula for $C^{T}_{ijkl}$ in the canonical ensemble.\nSecond, the thermodynamic transformation: $C^{S}_{ijkl} = C^{T}_{ijkl} + \\dfrac{T}{c_{\\epsilon}}\\,\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\\left(\\dfrac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon}$. This exactly matches our derived result.\nThe option also correctly describes the practical evaluation in MD: $C^{T}_{ijkl}$ can be computed via the fluctuation formula; $C_{\\epsilon}$ is found from total energy fluctuations in the canonical ensemble ($C_{\\epsilon} = \\langle \\delta E^{2}\\rangle/(k_{\\mathrm{B}}\\,T^{2})$); and $(\\partial \\sigma_{ij}/\\partial T)_{\\epsilon}$ is found by running simulations at several temperatures at fixed strain and determining the slope of $\\langle\\sigma_{ij}\\rangle$ versus $T$. All parts of this option are correct.\nVerdict: **Correct**.\n\n**B. The adiabatic and isothermal tensors differ by subtracting stress fluctuations...**\nThis option states $C^{S}_{ijkl} = C^{T}_{ijkl} - \\dfrac{V}{k_{\\mathrm{B}}\\,T}\\left(\\langle \\delta \\sigma_{ij}\\,\\delta \\sigma_{kl}\\rangle\\right)$. This is incorrect. It confuses the statistical fluctuation contribution to $C^{T}_{ijkl}$ with the thermodynamic difference $C^{S}_{ijkl} - C^{T}_{ijkl}$. The correct difference involves heat capacity and stress-temperature derivatives, as derived above. The claim that adiabatic constants are \"Born only\" is also false; adiabatic constants include thermal effects.\nVerdict: **Incorrect**.\n\n**C. The correct link is $C^{S}_{ijkl} = C^{T}_{ijkl} + \\dfrac{T}{c_{\\sigma}}\\,\\alpha_{ij}\\,\\alpha_{kl}$...**\nThis formula is an incorrect adaptation of the relation between isothermal and adiabatic *compliances*, $S^{T}_{ijkl} - S^{S}_{ijkl} = T V_0 \\alpha_{ij} \\alpha_{kl} / C_p$. The stiffness tensor relation involves different quantities, specifically those measured at constant strain/volume ($\\left(\\partial \\sigma_{ij}/\\partial T\\right)_{\\epsilon}$, $C_\\epsilon$) rather than constant stress ($\\alpha_{ij} = (\\partial \\epsilon_{ij}/\\partial T)_{\\sigma}$, $C_p=c_\\sigma V$). The suggested use of isothermal-isobaric MD is therefore inappropriate for this specific transformation.\nVerdict: **Incorrect**.\n\n**D. The transformation is $C^{S}_{ijkl} = C^{T}_{ijkl} + \\dfrac{V}{C_{\\epsilon}}\\,\\left(\\dfrac{\\partial \\sigma_{ij}}{\\partial T}\\right)_{\\epsilon}\\left(\\dfrac{\\partial \\sigma_{kl}}{\\partial T}\\right)_{\\epsilon}$, without any additional temperature factor...**\nThis is incorrect. As shown in the derivation, the correction term must contain a factor of temperature $T$. The formula presented is missing this factor. Furthermore, the claim that $C_{\\epsilon}$ should be calculated from kinetic energy fluctuations only is false. In the canonical ensemble, the potential energy is not constant and its fluctuations contribute significantly to the heat capacity $C_{\\epsilon}$.\nVerdict: **Incorrect**.\n\n**E. In the thermodynamic limit, $C^{S}_{ijkl} = C^{T}_{ijkl}$ for any crystal at nonzero temperature $T$...**\nThis statement is fundamentally incorrect. The difference $C^{S}_{ijkl} - C^{T}_{ijkl}$ is a well-defined thermodynamic quantity which is generally non-zero for any material at $T > 0$ that exhibits thermal pressure (i.e., $(\\partial\\sigma/\\partial T)_{\\epsilon} \\neq 0$). This difference does not vanish in the thermodynamic limit. The suggestion that the Born term alone suffices is also wrong, as this ignores all thermal contributions (kinetic and potential fluctuations) which are essential at any non-zero temperature.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2765170"}, {"introduction": "A central challenge in materials science is bridging the gap between discrete atomic-level details and predictive continuum mechanics models. This practice provides hands-on experience in this multiscale approach by tackling the classic Eshelby inclusion problem from an atomistic perspective. By fitting the far-field displacement data from a simulated nanoprecipitate to the continuum solution, you will extract the effective eigenstrain, $\\varepsilon^\\star$, and use it to predict the total elastic energy, thereby learning how to use continuum theory as a powerful lens for interpreting complex atomistic simulation results. [@problem_id:2765161]", "problem": "You must write a complete, runnable program that, given synthetic atomistic observations of far-field radial displacements around a coherent, spherical nanoprecipitate in an infinite, linear elastic, isotropic matrix, extracts an effective uniform hydrostatic eigenstrain and compares the predicted elastic energy from continuum Eshelby theory with a provided measured elastic energy. Your derivation and algorithm must begin from the fundamental basis of linear elasticity: small-strain kinematics, Hooke’s law for isotropic media, mechanical equilibrium, and spherical symmetry. No additional shortcut formulas are provided in the problem statement.\n\nAssumptions and physical setting:\n- The medium is infinite, homogeneous, linear elastic, isotropic, with bulk modulus $K$ and shear modulus $\\mu$.\n- There is a coherent, spherical inclusion of radius $a$ that tends to undergo a uniform hydrostatic eigenstrain $\\varepsilon^\\star$.\n- Under small strains, the displacement field is spherically symmetric about the inclusion center. Outside the inclusion, the far-field displacement is radial and decays with distance.\n- The atomistic simulation provides radial displacement observations sufficiently far from the inclusion to be in the elastic far-field regime.\n- Use the standard small-strain tensor definition $\\varepsilon_{ij} = \\tfrac{1}{2}\\left(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i\\right)$ and the isotropic Hooke’s law with Lamé moduli $(\\lambda, \\mu)$, where $K = \\lambda + \\tfrac{2}{3}\\mu$, and static equilibrium with no body forces.\n\nYour tasks:\n1) From the fundamental basis, deduce the functional form of the far-field radial displacement $u_r(r)$ outside a spherical inclusion under uniform hydrostatic eigenstrain $\\varepsilon^\\star$. Then design a linear least-squares fit that uses the supplied far-field atomistic radial displacement observations to estimate an effective uniform constrained strain inside the inclusion, and from it extract an estimate of the eigenstrain $\\widehat{\\varepsilon}^\\star$.\n2) Using the same first-principles framework, derive a closed-form expression for the total elastic energy $E_{\\text{pred}}$ stored in the matrix-plus-inclusion system as a function of the inclusion radius $a$, the elastic constants $K$ and $\\mu$, and the eigenstrain $\\varepsilon^\\star$.\n3) Implement an algorithm that:\n   - Converts all inputs to consistent physical units.\n   - Performs a linear least-squares fit of the far-field displacement observations to extract $\\widehat{\\varepsilon}^\\star$.\n   - Computes the predicted elastic energy $E_{\\text{pred}}$ from $\\widehat{\\varepsilon}^\\star$.\n   - Compares $E_{\\text{pred}}$ to a provided measured (atomistic) elastic energy $E_{\\text{meas}}$ by reporting a relative error $(E_{\\text{pred}} - E_{\\text{meas}})/E_{\\text{meas}}$ when $E_{\\text{meas}} > 0$. If $E_{\\text{meas}} = 0$, report the absolute error $E_{\\text{pred}}$ in place of the relative error.\n\nUnits and numerical requirements:\n- Length inputs $a$ and $r$ are given in nanometers (nm). Convert to meters (m) in your calculations.\n- Displacements $u$ are given in nanometers (nm). Convert to meters (m) in your calculations.\n- Elastic moduli $K$ and $\\mu$ are given in gigapascals (GPa). Convert to pascals (Pa) in your calculations.\n- The predicted and measured energies must be expressed in joules (J).\n- Angles do not appear in this problem.\n- All final numerical outputs must be floating-point numbers.\n\nTest suite:\nProvide results for the following four test cases. In each case, the inputs are:\n- Bulk modulus $K$ in GPa.\n- Shear modulus $\\mu$ in GPa.\n- Inclusion radius $a$ in nm.\n- A list of sampling radii $[r_1, r_2, \\dots]$ in nm.\n- A corresponding list of far-field radial displacements $[u_1, u_2, \\dots]$ in nm obtained from an atomistic simulation.\n- A measured atomistic elastic energy $E_{\\text{meas}}$ in J.\n\nCase A (general):\n- $K = 160$ GPa, $\\mu = 60$ GPa, $a = 2$ nm.\n- Radii (nm): $[5, 6, 8, 10, 12]$.\n- Displacements (nm): $[0.0043166667, 0.0029229630, 0.0016966667, 0.0010466667, 0.0007507407]$.\n- $E_{\\text{meas}} = 3.24816\\times 10^{-18}$ J.\n\nCase B (smaller inclusion and eigenstrain):\n- $K = 100$ GPa, $\\mu = 40$ GPa, $a = 1$ nm.\n- Radii (nm): $[3, 4, 5, 6, 8]$.\n- Displacements (nm): $[0.00037231884, 0.00019380435, 0.00013043478, 0.00008557916, 0.00005595109]$.\n- $E_{\\text{meas}} = 1.606\\times 10^{-20}$ J.\n\nCase C (edge case, near-zero misfit):\n- $K = 150$ GPa, $\\mu = 50$ GPa, $a = 2.5$ nm.\n- Radii (nm): $[7, 9, 12, 15, 18]$.\n- Displacements (nm): $[0.00001, -0.000005, 0.000002, -0.000001, 0.0000005]$.\n- $E_{\\text{meas}} = 0$ J. For this case, report the absolute error $E_{\\text{pred}}$ in place of the relative error.\n\nCase D (high bulk-to-shear contrast):\n- $K = 200$ GPa, $\\mu = 5$ GPa, $a = 3$ nm.\n- Radii (nm): $[6, 9, 12, 15, 20]$.\n- Displacements (nm): $[0.00735806, 0.00317580, 0.00183312, 0.00115129, 0.000658226]$.\n- $E_{\\text{meas}} = 3.349\\times 10^{-19}$ J.\n\nComputational details and output specification:\n- Implement the least-squares fit for the scalar constrained strain parameter by regressing the observed $u_r(r)$ against the appropriate radial kernel for spherical symmetry derived from first principles. Then map the constrained strain to the eigenstrain estimate $\\widehat{\\varepsilon}^\\star$ using the relationship you derive from the fundamental base.\n- Compute $E_{\\text{pred}}$ using the closed-form energy formula you derive.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists:\n  - For each case, output $[\\widehat{\\varepsilon}^\\star, E_{\\text{pred}}, E_{\\text{meas}}, \\text{err}]$, where $\\text{err}$ is the relative error $(E_{\\text{pred}} - E_{\\text{meas}})/E_{\\text{meas}}$ for $E_{\\text{meas}} > 0$, and $\\text{err} = E_{\\text{pred}}$ for $E_{\\text{meas}} = 0$.\n  - Example format: $[[x_1,y_1,z_1,e_1],[x_2,y_2,z_2,e_2],[x_3,y_3,z_3,e_3],[x_4,y_4,z_4,e_4]]$ with no spaces.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a complete solution. It is a standard problem in continuum micromechanics, specifically the Eshelby inclusion problem for a spherical geometry. The problem is valid, and I will proceed with its solution.\n\nThe solution requires two main derivations from the fundamental principles of linear elasticity, followed by the design of a computational algorithm to process the given data.\n\n**1. Derivation of the Far-Field Radial Displacement**\n\nThe problem involves a spherical inclusion in an infinite isotropic elastic matrix. Due to the spherical symmetry of the geometry and the hydrostatic nature of the eigenstrain, the resulting displacement field $\\mathbf{u}$ must be purely radial and dependent only on the distance $r$ from the center, i.e., $\\mathbf{u} = u_r(r)\\mathbf{e}_r$.\n\nIn spherical coordinates $(r, \\theta, \\phi)$, the non-zero components of the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ are the radial strain $\\varepsilon_{rr}$ and the two equal hoop strains $\\varepsilon_{\\theta\\theta}$ and $\\varepsilon_{\\phi\\phi}$:\n$$\n\\varepsilon_{rr} = \\frac{d u_r}{d r} \\quad , \\quad \\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = \\frac{u_r}{r}\n$$\n\nFor an isotropic linear elastic material, the constitutive relation (Hooke's Law) relates the stress tensor $\\boldsymbol{\\sigma}$ to the elastic strain tensor $\\boldsymbol{\\varepsilon}^e$. Using Lamé moduli $(\\lambda, \\mu)$:\n$$\n\\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon^e_{kk} + 2\\mu \\varepsilon^e_{ij}\n$$\nwhere $\\varepsilon^e_{kk}$ is the trace of the elastic strain tensor and $\\delta_{ij}$ is the Kronecker delta. The total strain $\\boldsymbol{\\varepsilon}$ is the sum of the elastic strain and the eigenstrain, $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^\\star$. In the matrix ($r > a$), the eigenstrain is zero, so $\\boldsymbol{\\varepsilon}^e = \\boldsymbol{\\varepsilon}$.\n\nThe equation of mechanical equilibrium, in the absence of body forces, is $\\nabla \\cdot \\boldsymbol{\\sigma} = 0$. For spherical symmetry, this simplifies to a single ordinary differential equation:\n$$\n\\frac{d\\sigma_{rr}}{dr} + \\frac{2}{r}(\\sigma_{rr} - \\sigma_{\\theta\\theta}) = 0\n$$\nThe stress components in the matrix are:\n$$\n\\sigma_{rr} = \\lambda(\\varepsilon_{rr} + 2\\varepsilon_{\\theta\\theta}) + 2\\mu\\varepsilon_{rr} = (\\lambda + 2\\mu)\\frac{du_r}{dr} + 2\\lambda\\frac{u_r}{r}\n$$\n$$\n\\sigma_{\\theta\\theta} = \\lambda(\\varepsilon_{rr} + 2\\varepsilon_{\\theta\\theta}) + 2\\mu\\varepsilon_{\\theta\\theta} = \\lambda\\frac{du_r}{dr} + 2(\\lambda + \\mu)\\frac{u_r}{r}\n$$\nSubstituting these into the equilibrium equation yields the Navier-Cauchy equation for spherical symmetry:\n$$\n\\frac{d^2u_r}{dr^2} + \\frac{2}{r}\\frac{du_r}{dr} - \\frac{2u_r}{r^2} = 0\n$$\nThis is a Cauchy-Euler equation with a general solution of the form:\n$$\nu_r(r) = C_1 r + C_2 r^{-2}\n$$\nwhere $C_1$ and $C_2$ are constants.\n\nThe boundary conditions for the matrix are:\n1.  The displacement must vanish at infinity: $u_r(r \\to \\infty) \\to 0$. This requires $C_1 = 0$.\nThus, the displacement field in the matrix has the form:\n$$\nu_r^{\\text{out}}(r) = C r^{-2}\n$$\nwhere $C$ is a constant to be determined. This is the functional form for the far-field displacement.\n\nTo determine $C$, we must consider the inclusion and the interface conditions at $r=a$.\n- **Inside the inclusion ($r \\le a$)**: The strain is uniform and hydrostatic, dictated by symmetry. Let this constrained strain be $\\varepsilon^C$. The displacement field producing this is $u_r^{\\text{in}}(r) = \\varepsilon^C r$.\n- **At the interface ($r=a$)**:\n    1.  Displacement must be continuous: $u_r^{\\text{in}}(a) = u_r^{\\text{out}}(a)$.\n        $$\n        \\varepsilon^C a = C a^{-2} \\implies C = \\varepsilon^C a^3\n        $$\n    2.  Radial stress must be continuous: $\\sigma_{rr}^{\\text{in}}(a) = \\sigma_{rr}^{\\text{out}}(a)$.\n        -   The stress inside is related to the elastic strain $\\boldsymbol{\\varepsilon}^{e, \\text{in}} = \\boldsymbol{\\varepsilon}^C - \\boldsymbol{\\varepsilon}^\\star = (\\varepsilon^C - \\varepsilon^\\star)\\mathbf{I}$. Using the bulk modulus $K = \\lambda + \\frac{2}{3}\\mu$, the hydrostatic stress is $\\sigma_{rr}^{\\text{in}} = 3K(\\varepsilon^C - \\varepsilon^\\star)$.\n        -   The stress outside is found from $u_r^{\\text{out}}(r) = C r^{-2}$: $\\sigma_{rr}^{\\text{out}}(r) = -4\\mu C r^{-3}$.\n        -   Equating at $r=a$: $3K(\\varepsilon^C - \\varepsilon^\\star) = -4\\mu C a^{-3}$. Substituting $C = \\varepsilon^C a^3$:\n        $$\n        3K(\\varepsilon^C - \\varepsilon^\\star) = -4\\mu \\varepsilon^C \\implies (3K + 4\\mu)\\varepsilon^C = 3K\\varepsilon^\\star\n        $$\n        This gives the relationship between the measurable constrained strain $\\varepsilon^C$ and the underlying eigenstrain $\\varepsilon^\\star$:\n        $$\n        \\varepsilon^C = \\frac{3K}{3K + 4\\mu} \\varepsilon^\\star \\quad \\text{or} \\quad \\varepsilon^\\star = \\frac{3K + 4\\mu}{3K} \\varepsilon^C\n        $$\n\nThe algorithm to find the eigenstrain $\\widehat{\\varepsilon}^\\star$ from displacement data $(r_i, u_i)$ is as follows:\nThe displacement model is $u_r(r) = (\\varepsilon^C a^3) r^{-2}$. This is a linear model $y = m x$ with $y = u_r$, $x = r^{-2}$, and slope $m = \\varepsilon^C a^3$. A linear least-squares fit without an intercept gives the best-fit slope $\\hat{m}$:\n$$\n\\hat{m} = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2} = \\frac{\\sum_i u_i r_i^{-2}}{\\sum_i r_i^{-4}}\n$$\nFrom this, we estimate the constrained strain $\\widehat{\\varepsilon^C} = \\hat{m} / a^3$ and subsequently the eigenstrain:\n$$\n\\widehat{\\varepsilon}^\\star = \\frac{3K + 4\\mu}{3K} \\widehat{\\varepsilon^C}\n$$\n\n**2. Derivation of the Total Elastic Energy**\n\nThe total elastic energy $E_{\\text{pred}}$ is the volume integral of the elastic strain energy density, $w = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}^e$. The energy is the sum of the energy stored inside the inclusion ($E_{\\text{in}}$) and in the matrix ($E_{\\text{out}}$).\n\n- **Energy inside the inclusion ($E_{\\text{in}}$)**:\nThe stress and elastic strain are uniform: $\\sigma_{ij}^{\\text{in}} = 3K(\\varepsilon^C - \\varepsilon^\\star)\\delta_{ij}$ and $\\varepsilon_{ij}^{e, \\text{in}} = (\\varepsilon^C - \\varepsilon^\\star)\\delta_{ij}$.\nThe energy density is $w_{\\text{in}} = \\frac{1}{2}\\sum_{i,j} \\sigma_{ij}^{\\text{in}}\\varepsilon_{ij}^{e, \\text{in}} = \\frac{1}{2} \\cdot 3 \\cdot [3K(\\varepsilon^C - \\varepsilon^\\star)](\\varepsilon^C - \\varepsilon^\\star) = \\frac{9}{2}K(\\varepsilon^C - \\varepsilon^\\star)^2$.\n$E_{\\text{in}} = V_{\\text{in}} w_{\\text{in}} = (\\frac{4}{3}\\pi a^3) \\frac{9}{2}K(\\varepsilon^C - \\varepsilon^\\star)^2 = 6\\pi a^3 K(\\varepsilon^C - \\varepsilon^\\star)^2$.\n\n- **Energy outside in the matrix ($E_{\\text{out}}$)**:\nThe displacement is $u_r(r) = C r^{-2}$ with $C=\\varepsilon^C a^3$. The strains are $\\varepsilon_{rr} = -2Cr^{-3}$ and $\\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = Cr^{-3}$.\nThe stresses are $\\sigma_{rr} = -4\\mu C r^{-3}$ and $\\sigma_{\\theta\\theta} = \\sigma_{\\phi\\phi} = 2\\mu C r^{-3}$.\nThe energy density is $w_{\\text{out}}(r) = \\frac{1}{2}(\\sigma_{rr}\\varepsilon_{rr} + 2\\sigma_{\\theta\\theta}\\varepsilon_{\\theta\\theta}) = \\frac{1}{2}[(-4\\mu C r^{-3})(-2Cr^{-3}) + 2(2\\mu C r^{-3})(Cr^{-3})] = 6\\mu C^2 r^{-6}$.\n$E_{\\text{out}} = \\int_a^\\infty w_{\\text{out}}(r) 4\\pi r^2 dr = \\int_a^\\infty 24\\pi \\mu C^2 r^{-4} dr = 24\\pi \\mu C^2 [-\\frac{r^{-3}}{3}]_a^\\infty = 8\\pi \\mu C^2 a^{-3}$.\nSubstituting $C=\\varepsilon^C a^3$, we get $E_{\\text{out}} = 8\\pi\\mu a^3 (\\varepsilon^C)^2$.\n\n- **Total Energy ($E_{\\text{pred}}$)**:\n$E_{\\text{pred}} = E_{\\text{in}} + E_{\\text{out}} = 6\\pi a^3 K(\\varepsilon^C - \\varepsilon^\\star)^2 + 8\\pi\\mu a^3 (\\varepsilon^C)^2$.\nUsing the relations $\\varepsilon^C = \\frac{3K}{3K+4\\mu}\\varepsilon^\\star$ and $\\varepsilon^C - \\varepsilon^\\star = \\frac{-4\\mu}{3K+4\\mu}\\varepsilon^\\star$:\n$$\nE_{\\text{pred}} = 6\\pi a^3 K \\left(\\frac{-4\\mu}{3K+4\\mu}\\varepsilon^\\star\\right)^2 + 8\\pi\\mu a^3 \\left(\\frac{3K}{3K+4\\mu}\\varepsilon^\\star\\right)^2\n$$\n$$\nE_{\\text{pred}} = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [6K(16\\mu^2) + 8\\mu(9K^2)] = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [96K\\mu^2 + 72K^2\\mu]\n$$\nFactoring out $24K\\mu(4\\mu+3K)$:\n$$\nE_{\\text{pred}} = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [24K\\mu(4\\mu+3K)] = \\frac{24\\pi K \\mu a^3}{3K+4\\mu}(\\varepsilon^\\star)^2\n$$\nThis is the final expression for the predicted total elastic energy, to be computed using the estimated eigenstrain $\\widehat{\\varepsilon}^\\star$.\n\n**3. Computational Algorithm**\n\nThe complete algorithm is as follows:\n1.  For each test case, parse the inputs: $K$ [GPa], $\\mu$ [GPa], $a$ [nm], radii $r_i$ [nm], displacements $u_i$ [nm], and measured energy $E_{\\text{meas}}$ [J].\n2.  Convert all inputs to base SI units:\n    -   $K' = K \\times 10^9$ Pa\n    -   $\\mu' = \\mu \\times 10^9$ Pa\n    -   $a' = a \\times 10^{-9}$ m\n    -   $r'_i = r_i \\times 10^{-9}$ m\n    -   $u'_i = u_i \\times 10^{-9}$ m\n3.  Perform the linear least-squares fit. Construct the variables for regression: $y_i = u'_i$ and $x_i = (r'_i)^{-2}$.\n4.  Calculate the slope $\\hat{m} = (\\sum x_i y_i) / (\\sum x_i^2)$.\n5.  Estimate the constrained strain: $\\widehat{\\varepsilon^C} = \\hat{m} / (a')^3$.\n6.  Estimate the eigenstrain: $\\widehat{\\varepsilon}^\\star = \\frac{3K' + 4\\mu'}{3K'} \\widehat{\\varepsilon^C}$.\n7.  Calculate the predicted elastic energy $E_{\\text{pred}}$ using the derived formula and the estimated eigenstrain $\\widehat{\\varepsilon}^\\star$:\n    $$\n    E_{\\text{pred}} = \\frac{24\\pi K' \\mu' (a')^3}{3K' + 4\\mu'}(\\widehat{\\varepsilon}^\\star)^2\n    $$\n8.  Calculate the error, $\\text{err}$. If $E_{\\text{meas}} > 0$, $\\text{err} = (E_{\\text{pred}} - E_{\\text{meas}}) / E_{\\text{meas}}$. If $E_{\\text{meas}} = 0$, $\\text{err} = E_{\\text{pred}}$.\n9.  Collect the four output values $[\\widehat{\\varepsilon}^\\star, E_{\\text{pred}}, E_{\\text{meas}}, \\text{err}]$ for each case and format them as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It processes each case, computes the required values, and prints the final result.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"K\": 160, \"mu\": 60, \"a\": 2,\n            \"radii\": [5, 6, 8, 10, 12],\n            \"displacements\": [0.0043166667, 0.0029229630, 0.0016966667, 0.0010466667, 0.0007507407],\n            \"E_meas\": 3.24816e-18,\n        },\n        {\n            \"K\": 100, \"mu\": 40, \"a\": 1,\n            \"radii\": [3, 4, 5, 6, 8],\n            \"displacements\": [0.00037231884, 0.00019380435, 0.00013043478, 0.00008557916, 0.00005595109],\n            \"E_meas\": 1.606e-20,\n        },\n        {\n            \"K\": 150, \"mu\": 50, \"a\": 2.5,\n            \"radii\": [7, 9, 12, 15, 18],\n            \"displacements\": [0.00001, -0.000005, 0.000002, -0.000001, 0.0000005],\n            \"E_meas\": 0.0,\n        },\n        {\n            \"K\": 200, \"mu\": 5, \"a\": 3,\n            \"radii\": [6, 9, 12, 15, 20],\n            \"displacements\": [0.00735806, 0.00317580, 0.00183312, 0.00115129, 0.000658226],\n            \"E_meas\": 3.349e-19,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(case)\n        all_results.append(result)\n    \n    # Format the final output string as specified\n    inner_strs = [f\"[{','.join(f'{v:.6e}' for v in res)}]\" for res in all_results]\n    print(f\"[{','.join(inner_strs)}]\")\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case to find eigenstrain, predicted energy, and error.\n    \n    The derivation is based on linear elasticity for a spherical inclusion:\n    1. Far-field displacement u_r(r) = C / r^2.\n    2. The constant C is related to the constrained strain ε_C and inclusion radius a by C = ε_C * a^3.\n    3. A linear least-squares fit of u_r vs 1/r^2 yields an estimate for C.\n    4. The constrained strain ε_C is related to the eigenstrain ε* by ε* = ((3K + 4μ) / 3K) * ε_C.\n    5. The total elastic energy is E_pred = (24 * π * K * μ * a^3 / (3K + 4μ)) * (ε*)^2.\n    \"\"\"\n    \n    # Unpack and convert inputs to SI units\n    K_si = case_data[\"K\"] * 1e9  # GPa to Pa\n    mu_si = case_data[\"mu\"] * 1e9  # GPa to Pa\n    a_si = case_data[\"a\"] * 1e-9    # nm to m\n    radii_si = np.array(case_data[\"radii\"]) * 1e-9  # nm to m\n    displacements_si = np.array(case_data[\"displacements\"]) * 1e-9  # nm to m\n    E_meas = case_data[\"E_meas\"] # J\n\n    # Perform linear least-squares fit for y = m*x where y=u, x=1/r^2\n    # The slope m is an estimate for C = ε_C * a^3\n    x_fit = 1 / (radii_si**2)\n    y_fit = displacements_si\n    \n    m_hat = np.dot(x_fit, y_fit) / np.dot(x_fit, x_fit)\n\n    # Estimate constrained strain and then eigenstrain\n    eps_C_hat = m_hat / (a_si**3)\n    eps_star_hat = ((3 * K_si + 4 * mu_si) / (3 * K_si)) * eps_C_hat\n\n    # Predict total elastic energy\n    numerator = 24 * np.pi * K_si * mu_si * (a_si**3)\n    denominator = 3 * K_si + 4 * mu_si\n    E_pred = (numerator / denominator) * (eps_star_hat**2)\n\n    # Calculate error\n    if E_meas > 0:\n        error = (E_pred - E_meas) / E_meas\n    else:\n        error = E_pred\n\n    return [eps_star_hat, E_pred, E_meas, error]\n\nsolve()\n```", "id": "2765161"}]}