{"hands_on_practices": [{"introduction": "The cornerstone of phase-field modeling is the concept of a diffuse interface, whose structure and energy are determined by a balance between bulk and gradient energy contributions. This first practice invites you to perform the foundational calculation of deriving the equilibrium profile and interfacial energy for a one-dimensional interface [@problem_id:2782605]. Successfully completing this exercise will solidify your understanding of how the parameters of the Ginzburg-Landau free energy functional directly dictate a system's fundamental interfacial properties.", "problem": "A binary solid solution at the nanoscale is modeled by a scalar order parameter $\\,\\phi(x)\\,$ that distinguishes two phases with bulk equilibrium values $\\,\\phi=0\\,$ and $\\,\\phi=1\\,$. Consider a flat, stationary interface normal to the $\\,x\\,$-axis, so that $\\,\\phi=\\phi(x)\\,$ depends only on $\\,x\\,$. The Helmholtz free energy per unit interfacial area is postulated, following the Ginzburgâ€“Landau paradigm for diffuse interfaces, to be the functional\n$$\\mathcal{F}[\\phi] \\;=\\; \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; W\\,\\phi^{2}\\left(1-\\phi\\right)^{2} \\right] \\, dx,$$\nwhere $\\,\\kappa0\\,$ is the gradient energy coefficient and $\\,W0\\,$ sets the barrier height of the symmetric double-well bulk free-energy density. Assume thermodynamic equilibrium with boundary conditions $\\,\\phi(-\\infty)=0\\,$ and $\\,\\phi(+\\infty)=1\\,$.\n\nStarting only from the calculus of variations and equilibrium conditions for minimizers of $\\,\\mathcal{F}[\\phi]\\,$, and without invoking any shortcut formulas, derive the stationary interface profile $\\,\\phi(x)\\,$ and use it to determine the interfacial free energy per unit area (surface energy)\n$$\\gamma \\;=\\; \\min_{\\phi}\\,\\mathcal{F}[\\phi],$$\nnoting that the homogeneous bulk free-energy density vanishes at $\\,\\phi=0\\,$ and $\\,\\phi=1\\,$ for the given potential. Provide $\\,\\gamma\\,$ as a single closed-form analytic expression in terms of $\\,\\kappa\\,$ and $\\,W\\,$. Do not substitute any numerical values, and do not append units to your final expression.", "solution": "The problem as stated is subjected to validation before a solution is attempted.\n\nStep 1: Extract Givens\n-   A scalar order parameter $\\phi(x)$ describes a binary solid solution.\n-   The domain is one-dimensional, $x \\in (-\\infty, \\infty)$.\n-   The Helmholtz free energy functional per unit area is given by $\\mathcal{F}[\\phi] = \\int_{-\\infty}^{\\infty} L(\\phi, \\phi') \\, dx$, where the Lagrangian density is $L(\\phi, \\phi') = \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + W\\,\\phi^{2}\\left(1-\\phi\\right)^{2}$.\n-   The gradient energy coefficient is $\\kappa > 0$.\n-   The potential energy barrier height parameter is $W > 0$.\n-   The system is in thermodynamic equilibrium, which corresponds to a configuration $\\phi(x)$ that minimizes the functional $\\mathcal{F}[\\phi]$.\n-   The boundary conditions for the interface profile are $\\phi(x \\to -\\infty) = 0$ and $\\phi(x \\to +\\infty) = 1$.\n-   The objective is to derive the stationary interface profile $\\phi(x)$ and compute the interfacial free energy $\\gamma = \\min_{\\phi}\\,\\mathcal{F}[\\phi]$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It presents a classic Ginzburg-Landau-type model for a one-dimensional interface, a cornerstone of phase-field theory used in materials science and condensed matter physics. The functional form is standard for a symmetric double-well potential. The problem is well-posed; it is a standard problem in the calculus of variations with specified boundary conditions and positive definite parameters ($\\kappa, W > 0$), which ensures the existence of a stable, non-trivial solution. The problem statement is objective, using precise mathematical language without ambiguity or subjective claims. The problem is self-contained and provides all necessary information for its solution. It does not violate any of the specified invalidity criteria.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be formulated based on the principles of the calculus of variations.\n\nThe equilibrium interface profile $\\phi(x)$ is the function that minimizes the free energy functional $\\mathcal{F}[\\phi]$. Such a minimizer must satisfy the Euler-Lagrange equation:\n$$ \\frac{\\partial L}{\\partial \\phi} - \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) = 0 $$\nwhere $\\phi' \\equiv \\frac{d\\phi}{dx}$ and the Lagrangian density is $L(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^{2} + W\\,\\phi^{2}(1-\\phi)^{2}$.\n\nFirst, we compute the required partial derivatives of $L$:\n$$ \\frac{\\partial L}{\\partial \\phi'} = \\kappa \\phi' $$\n$$ \\frac{\\partial L}{\\partial \\phi} = W \\frac{d}{d\\phi}\\left[\\phi^2(1-\\phi)^2\\right] = W \\left[ 2\\phi(1-\\phi)^2 + \\phi^2 \\cdot 2(1-\\phi)(-1) \\right] = 2W\\phi(1-\\phi)\\left[ (1-\\phi) - \\phi \\right] = 2W\\phi(1-\\phi)(1-2\\phi) $$\nSubstituting these into the Euler-Lagrange equation gives the governing ordinary differential equation for the stationary profile $\\phi(x)$:\n$$ 2W\\phi(1-\\phi)(1-2\\phi) - \\frac{d}{dx}(\\kappa \\phi') = 0 $$\n$$ \\kappa \\frac{d^2\\phi}{dx^2} = 2W\\phi(1-\\phi)(1-2\\phi) $$\nThis is a second-order, nonlinear, autonomous differential equation. Since the Lagrangian $L$ does not depend explicitly on $x$, there exists a first integral of motion given by the Beltrami identity:\n$$ L - \\phi' \\frac{\\partial L}{\\partial \\phi'} = C $$\nwhere $C$ is a constant of integration. Substituting the expressions for $L$ and $\\frac{\\partial L}{\\partial \\phi'}$:\n$$ \\left( \\frac{\\kappa}{2}(\\phi')^2 + W\\phi^2(1-\\phi)^2 \\right) - \\phi' (\\kappa \\phi') = C $$\n$$ -\\frac{\\kappa}{2}(\\phi')^2 + W\\phi^2(1-\\phi)^2 = C $$\nThe constant $C$ is determined by the boundary conditions. At $x \\to \\pm \\infty$, the interface profile must approach the bulk equilibrium states where the profile is flat. Thus, $\\phi' \\to 0$.\nAt $x \\to -\\infty$, $\\phi \\to 0$ and $\\phi' \\to 0$. The equation becomes $W(0)^2(1-0)^2 = C$, which gives $C=0$.\nAt $x \\to +\\infty$, $\\phi \\to 1$ and $\\phi' \\to 0$. The equation becomes $W(1)^2(1-1)^2 = C$, which also gives $C=0$.\nWith $C=0$, we obtain a key relation valid for the equilibrium profile:\n$$ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 = W\\phi^2(1-\\phi)^2 $$\nThis equation signifies the equipartition of energy at equilibrium: the gradient energy density is equal to the potential energy density at every point $x$ along the profile.\n\nWe can now solve for $\\frac{d\\phi}{dx}$:\n$$ \\left(\\frac{d\\phi}{dx}\\right)^2 = \\frac{2W}{\\kappa} \\phi^2(1-\\phi)^2 $$\n$$ \\frac{d\\phi}{dx} = \\pm \\sqrt{\\frac{2W}{\\kappa}} \\phi(1-\\phi) $$\nGiven the boundary conditions $\\phi(-\\infty)=0$ and $\\phi(+\\infty)=1$, the order parameter $\\phi$ must be a monotonically increasing function of $x$. Therefore, $\\frac{d\\phi}{dx} > 0$. For $\\phi \\in (0,1)$, the term $\\phi(1-\\phi)$ is positive. We thus select the positive root:\n$$ \\frac{d\\phi}{dx} = \\sqrt{\\frac{2W}{\\kappa}} \\phi(1-\\phi) $$\nThis is a first-order separable differential equation. We rearrange to separate the variables:\n$$ \\frac{d\\phi}{\\phi(1-\\phi)} = \\sqrt{\\frac{2W}{\\kappa}} \\, dx $$\nIntegrating both sides requires the use of partial fraction decomposition for the left-hand side: $\\frac{1}{\\phi(1-\\phi)} = \\frac{1}{\\phi} + \\frac{1}{1-\\phi}$.\n$$ \\int \\left(\\frac{1}{\\phi} + \\frac{1}{1-\\phi}\\right) d\\phi = \\int \\sqrt{\\frac{2W}{\\kappa}} \\, dx $$\n$$ \\ln(\\phi) - \\ln(1-\\phi) = x\\sqrt{\\frac{2W}{\\kappa}} + C_1 $$\nwhere the absolute values are dropped as $\\phi \\in (0,1)$. Let us define the center of the interface at $x=0$, where $\\phi(0) = 1/2$ by symmetry. This condition determines the integration constant $C_1$:\n$$ \\ln\\left(\\frac{1/2}{1-1/2}\\right) = \\ln(1) = 0 = 0 \\cdot \\sqrt{\\frac{2W}{\\kappa}} + C_1 \\implies C_1 = 0 $$\nSo, we have:\n$$ \\ln\\left(\\frac{\\phi}{1-\\phi}\\right) = x\\sqrt{\\frac{2W}{\\kappa}} $$\nSolving for $\\phi(x)$:\n$$ \\frac{\\phi}{1-\\phi} = \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) \\implies \\phi = (1-\\phi)\\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) \\implies \\phi\\left(1 + \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)\\right) = \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right) $$\n$$ \\phi(x) = \\frac{\\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)}{1 + \\exp\\left(x\\sqrt{\\frac{2W}{\\kappa}}\\right)} = \\frac{1}{1 + \\exp\\left(-x\\sqrt{\\frac{2W}{\\kappa}}\\right)} $$\nThis profile can be expressed using the hyperbolic tangent function as:\n$$ \\phi(x) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{x}{2}\\sqrt{\\frac{2W}{\\kappa}}\\right)\\right] = \\frac{1}{2}\\left[1 + \\tanh\\left(x\\sqrt{\\frac{W}{2\\kappa}}\\right)\\right] $$\nThis is the stationary interface profile $\\phi(x)$.\n\nNext, we calculate the interfacial free energy $\\gamma$, which is the value of the functional $\\mathcal{F}[\\phi]$ evaluated for this equilibrium profile:\n$$ \\gamma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + W\\,\\phi^{2}(1-\\phi)^{2} \\right] \\, dx $$\nUsing the equipartition relation $\\frac{\\kappa}{2}(\\phi')^2 = W\\phi^2(1-\\phi)^2$ derived earlier, we can simplify the integrand:\n$$ \\gamma = \\int_{-\\infty}^{\\infty} 2 \\cdot \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 \\right] dx = \\int_{-\\infty}^{\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right)^2 dx $$\nTo evaluate this integral, it is most efficient to change the integration variable from $x$ to $\\phi$. Since $\\frac{d\\phi}{dx} dx = d\\phi$, we can rewrite one factor of $\\frac{d\\phi}{dx}$ and perform the change of limits from $x \\in (-\\infty, \\infty)$ to $\\phi \\in (0, 1)$:\n$$ \\gamma = \\int_{0}^{1} \\kappa \\left(\\frac{d\\phi}{dx}\\right) d\\phi $$\nNow substitute the expression for $\\frac{d\\phi}{dx} = \\sqrt{\\frac{2W}{\\kappa}}\\phi(1-\\phi)$:\n$$ \\gamma = \\int_{0}^{1} \\kappa \\left( \\sqrt{\\frac{2W}{\\kappa}}\\phi(1-\\phi) \\right) d\\phi = \\kappa \\sqrt{\\frac{2W}{\\kappa}} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi $$\n$$ \\gamma = \\sqrt{\\kappa^2 \\frac{2W}{\\kappa}} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi = \\sqrt{2\\kappa W} \\int_{0}^{1} (\\phi-\\phi^2) d\\phi $$\nThe definite integral is elementary:\n$$ \\int_{0}^{1} (\\phi-\\phi^2) d\\phi = \\left[\\frac{\\phi^2}{2} - \\frac{\\phi^3}{3}\\right]_{0}^{1} = \\left(\\frac{1}{2} - \\frac{1}{3}\\right) - (0) = \\frac{1}{6} $$\nFinally, substituting this result, we obtain the interfacial free energy:\n$$ \\gamma = \\sqrt{2\\kappa W} \\cdot \\frac{1}{6} = \\frac{\\sqrt{2\\kappa W}}{6} $$\nThis is the final closed-form expression for the surface energy in terms of the given parameters $\\kappa$ and $W$.", "answer": "$$\\boxed{\\frac{\\sqrt{2\\kappa W}}{6}}$$", "id": "2782605"}, {"introduction": "Having established how to calculate the interfacial energy for a flat interface, we now explore its physical consequences for curved geometries. This exercise guides you through the derivation of the celebrated Young-Laplace equation, which describes the pressure jump $\\Delta p$ across a spherical droplet due to surface tension [@problem_id:2782607]. This practice is crucial for connecting the microscopic parameters of the phase-field model to macroscopic capillary phenomena, demonstrating how continuum-level physics emerges naturally from the underlying variational framework.", "problem": "Consider an isothermal binary mixture described by a scalar phase-field order parameter $\\phi(\\mathbf{x})$ taking equilibrium bulk values $\\pm \\phi_{0}$ in the two phases. The Helmholtz free energy functional in a domain $\\Omega \\subset \\mathbb{R}^{3}$ is\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left[ \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} \\;+\\; f(\\phi) \\right] \\,\\mathrm{d}V,\n$$\nwhere $\\kappa0$ is the gradient-energy coefficient and the homogeneous free-energy density is the symmetric double-well\n$$\nf(\\phi) \\;=\\; \\frac{A}{4}\\,\\left(\\phi^{2}-\\phi_{0}^{2}\\right)^{2},\n$$\nwith $A0$. Assume that a single spherical droplet of the $+\\phi_{0}$ phase of radius $R$ is embedded in the $-\\phi_{0}$ phase, that the interface is at mechanical and chemical equilibrium, and that the droplet radius satisfies $R \\gg \\ell$, where $\\ell$ is the intrinsic diffuse-interface thickness set by $(\\kappa,A,\\phi_{0})$.\n\nStarting from the free-energy functional $\\mathcal{F}$ and the definition of interfacial free energy (surface tension) as the excess free energy per unit area associated with a stationary one-dimensional interface profile, perform the following steps grounded in variational mechanics:\n\n1. For a flat interface with order parameter varying only in the normal coordinate $z$, use the stationarity of $\\mathcal{F}$ to reduce the Eulerâ€“Lagrange equation to a first integral that relates $\\partial_{z}\\phi$ to $f(\\phi)$. Then, express the surface tension $\\gamma$ as a one-dimensional integral over $\\phi$ and evaluate it in closed form in terms of $\\kappa$, $A$, and $\\phi_{0}$.\n\n2. Model the curved interface of the nearly spherical droplet as locally flat to leading order in $\\ell/R$ so that the interfacial free energy is $F_{\\text{int}} \\approx \\gamma A$, where $A=4\\pi R^{2}$ is the droplet area. Using a virtual isothermal shape variation at fixed composition and the principle that the reversible work of the pressure difference $\\Delta p$ across the interface equals the change in interfacial free energy under a small change in volume, derive the leading-order expression for the Laplace pressure jump $\\Delta p$ across the spherical interface.\n\nProvide your final result as a single closed-form analytic expression for $\\Delta p$ in terms of $\\kappa$, $A$, $\\phi_{0}$, and $R$. Do not introduce any additional parameters. No numerical evaluation is required, and no rounding is needed. Your final answer must be a single expression, not an equation or inequality.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Helmholtz free energy functional: $\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left[ \\frac{\\kappa}{2}\\,|\\nabla \\phi|^{2} + f(\\phi) \\right] \\,\\mathrm{d}V$\n- Phase-field order parameter: $\\phi(\\mathbf{x})$\n- Equilibrium bulk values: $\\pm \\phi_{0}$\n- Gradient-energy coefficient: $\\kappa > 0$\n- Homogeneous free-energy density: $f(\\phi) = \\frac{A}{4}\\,\\left(\\phi^{2}-\\phi_{0}^{2}\\right)^{2}$\n- Constant: $A > 0$\n- System geometry: A spherical droplet of radius $R$ in a surrounding matrix.\n- System condition: Mechanical and chemical equilibrium.\n- Assumption: $R \\gg \\ell$, where $\\ell$ is the interface thickness.\n- Task 1: Find the surface tension $\\gamma$ for a flat interface in terms of $\\kappa$, $A$, and $\\phi_{0}$.\n- Task 2: Derive the Laplace pressure $\\Delta p$ for the spherical droplet.\n- Ambiguity noted: The symbol $A$ is used for two different quantities: a constant in the potential $f(\\phi)$ and the surface area of the droplet $A = 4\\pi R^{2}$. This is poor notation. However, the final answer is requested in terms of $\\kappa$, $A$, $\\phi_{0}$, and $R$, which implies that the symbol $A$ in the final expression must refer to the potential constant, as the droplet area is a function of $R$. The problem remains solvable despite this ambiguity.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the Ginzburg-Landau (or Cahn-Hilliard/Allen-Cahn) theory of phase transitions, a cornerstone of continuum mechanics and materials science. The derivation of surface tension and Laplace pressure from a free-energy functional is a standard and fundamental procedure.\n- **Well-Posed:** The problem is mathematically well-posed. It provides a clear objective and sufficient information to derive a unique solution using variational principles.\n- **Objective:** The language is formal and devoid of subjective content.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. The notational ambiguity is a minor flaw but does not prevent a rigorous and unique solution. I will proceed with the derivation.\n\nThe overall goal is to derive the Laplace pressure $\\Delta p$ across a spherical interface. This is accomplished in two steps as requested.\n\n**Step 1: Derivation of Surface Tension $\\gamma$**\n\nWe consider a planar interface where the order parameter $\\phi$ varies only along the coordinate $z$, normal to the interface. The free energy functional per unit area of the interface is\n$$\n\\frac{\\mathcal{F}}{A_{xy}} = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dz} \\right)^2 + f(\\phi) \\right] dz\n$$\nThe integrand, $\\mathcal{L}(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi)$, is the Lagrangian density, where $\\phi' = d\\phi/dz$. The equilibrium profile $\\phi(z)$ must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} - \\frac{d}{dz}\\left( \\frac{\\partial \\mathcal{L}}{\\partial \\phi'} \\right) = 0\n$$\nThis gives $f'(\\phi) - \\frac{d}{dz}(\\kappa \\phi') = 0$, or $\\kappa \\phi'' = f'(\\phi)$.\n\nSince the Lagrangian $\\mathcal{L}$ does not depend explicitly on the independent variable $z$, we can use the Beltrami identity to find a first integral of motion:\n$$\n\\mathcal{L} - \\phi' \\frac{\\partial \\mathcal{L}}{\\partial \\phi'} = \\text{constant}\n$$\n$$\n\\left( \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) \\right) - \\phi'(\\kappa \\phi') = -\\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) = C\n$$\nTo determine the constant $C$, we apply the boundary conditions far from the interface, where the system is in a homogeneous bulk phase. As $z \\to \\pm \\infty$, $\\phi \\to \\pm \\phi_0$ and the profile becomes flat, so $\\phi' \\to 0$. In the bulk, the free energy density is at its minimum, $f(\\pm\\phi_0) = \\frac{A}{4}(\\phi_0^2-\\phi_0^2)^2 = 0$. Substituting these conditions into the first integral gives $C = 0$.\nTherefore, we obtain the first integral relating $\\phi'$ to $f(\\phi)$:\n$$\n\\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dz} \\right)^2 = f(\\phi)\n$$\nThis is the required relation from the first part of the task.\n\nThe surface tension, $\\gamma$, is defined as the excess free energy per unit area of the interface. Since the bulk free energy density is $f(\\pm\\phi_0) = 0$, this is simply the integral of the Lagrangian density:\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2}(\\phi')^2 + f(\\phi) \\right] dz\n$$\nUsing the first integral, we can write this as $\\gamma = \\int_{-\\infty}^{\\infty} 2f(\\phi) dz$ or, more conveniently for calculation, as $\\gamma = \\int_{-\\infty}^{\\infty} \\kappa(\\phi')^2 dz$. We will proceed by changing the variable of integration from $z$ to $\\phi$. From the first integral, we have $\\phi' = \\frac{d\\phi}{dz} = \\sqrt{\\frac{2f(\\phi)}{\\kappa}}$. The integration is taken across the interface from $\\phi = -\\phi_0$ to $\\phi = +\\phi_0$.\n$$\n\\gamma = \\int_{-\\infty}^{\\infty} \\sqrt{2\\kappa f(\\phi)} \\frac{d\\phi}{dz} dz = \\int_{-\\phi_0}^{\\phi_0} \\sqrt{2\\kappa f(\\phi)} d\\phi\n$$\nNow, we substitute the given form of $f(\\phi) = \\frac{A}{4}(\\phi^2-\\phi_0^2)^2$:\n$$\n\\gamma = \\int_{-\\phi_0}^{\\phi_0} \\sqrt{2\\kappa \\frac{A}{4} (\\phi^2 - \\phi_0^2)^2} d\\phi = \\sqrt{\\frac{\\kappa A}{2}} \\int_{-\\phi_0}^{\\phi_0} |\\phi^2 - \\phi_0^2| d\\phi\n$$\nInside the integration range $(-\\phi_0, \\phi_0)$, the term $\\phi^2 - \\phi_0^2$ is non-positive, so $|\\phi^2 - \\phi_0^2| = \\phi_0^2 - \\phi^2$.\n$$\n\\gamma = \\sqrt{\\frac{\\kappa A}{2}} \\int_{-\\phi_0}^{\\phi_0} (\\phi_0^2 - \\phi^2) d\\phi\n$$\nThe integral is evaluated directly:\n$$\n\\int_{-\\phi_0}^{\\phi_0} (\\phi_0^2 - \\phi^2) d\\phi = \\left[ \\phi_0^2 \\phi - \\frac{\\phi^3}{3} \\right]_{-\\phi_0}^{\\phi_0} = \\left(\\phi_0^3 - \\frac{\\phi_0^3}{3}\\right) - \\left(-\\phi_0^3 + \\frac{\\phi_0^3}{3}\\right) = \\frac{2}{3}\\phi_0^3 - \\left(-\\frac{2}{3}\\phi_0^3\\right) = \\frac{4}{3}\\phi_0^3\n$$\nSubstituting this result back into the expression for $\\gamma$:\n$$\n\\gamma = \\sqrt{\\frac{\\kappa A}{2}} \\left( \\frac{4}{3}\\phi_0^3 \\right) = \\frac{4\\phi_0^3}{3\\sqrt{2}} \\sqrt{\\kappa A} = \\frac{2\\sqrt{2}}{3} \\phi_0^3 \\sqrt{\\kappa A}\n$$\n\n**Step 2: Derivation of the Laplace Pressure $\\Delta p$**\n\nFor a spherical droplet of radius $R$, where $R$ is much larger than the interface thickness $\\ell$, we can approximate the interfacial free energy as the product of the flat-interface surface tension $\\gamma$ and the droplet's surface area, $A_{surf} = 4\\pi R^2$.\n$$\nF_{\\text{int}} \\approx \\gamma A_{surf} = \\gamma (4\\pi R^2)\n$$\nThe principle of virtual work states that at mechanical equilibrium, the work $dW$ done by the pressure difference $\\Delta p$ during an infinitesimal change in volume $dV$ is equal to the corresponding change in the interfacial free energy $dF_{\\text{int}}$. We consider an isothermal process at fixed total composition.\n$$\ndW = dF_{\\text{int}}\n$$\nThe work done by the pressure difference is $dW = \\Delta p \\, dV$. The change in free energy is $dF_{\\text{int}} = d(\\gamma A_{surf})$. Since $\\gamma$ is a material property independent of $R$, we have $dF_{\\text{int}} = \\gamma \\, dA_{surf}$.\nEquating the two gives:\n$$\n\\Delta p \\, dV = \\gamma \\, dA_{surf} \\implies \\Delta p = \\gamma \\frac{dA_{surf}}{dV}\n$$\nFor a sphere, the volume is $V = \\frac{4}{3}\\pi R^3$ and the surface area is $A_{surf} = 4\\pi R^2$. We compute the derivative using the chain rule with respect to the radius $R$:\n$$\n\\frac{dA_{surf}}{dV} = \\frac{dA_{surf}/dR}{dV/dR} = \\frac{\\frac{d}{dR}(4\\pi R^2)}{\\frac{d}{dR}(\\frac{4}{3}\\pi R^3)} = \\frac{8\\pi R}{4\\pi R^2} = \\frac{2}{R}\n$$\nThis leads to the well-known Young-Laplace equation for a spherical interface:\n$$\n\\Delta p = \\frac{2\\gamma}{R}\n$$\nFinally, we substitute the expression for $\\gamma$ derived in Step 1 to obtain the final result for $\\Delta p$ in terms of the fundamental model parameters.\n$$\n\\Delta p = \\frac{2}{R} \\left( \\frac{2\\sqrt{2}}{3} \\phi_0^3 \\sqrt{\\kappa A} \\right) = \\frac{4\\sqrt{2}}{3R} \\phi_0^3 \\sqrt{\\kappa A}\n$$\nThe dimensional consistency of this result can be verified. As established during validation, if $\\phi$ is dimensionless, then $[\\kappa] = \\text{Energy}/\\text{Length}$ and $[A] = \\text{Energy}/\\text{Volume}$. The product $\\kappa A$ has units of $(\\text{Energy})^2/(\\text{Length})^4$, and $\\sqrt{\\kappa A}$ has units of $\\text{Energy}/(\\text{Length})^2$, which are the units of surface tension. Dividing by length $R$ gives units of $\\text{Energy}/(\\text{Length})^3$, which is pressure ($\\text{Force}/\\text{Area}$).", "answer": "$$\n\\boxed{\\frac{4\\sqrt{2}}{3R}\\phi_{0}^{3}\\sqrt{\\kappa A}}\n$$", "id": "2782607"}, {"introduction": "Theoretical models gain their full power when they are implemented in numerical simulations to study complex systems. This final practice shifts our focus to the crucial topic of boundary interactions, specifically how to model wetting and contact angles at a solid wall [@problem_id:2782614]. By deriving and implementing a discrete boundary condition for the contact angle $\\theta$, you will gain hands-on experience in translating variational principles into a robust numerical scheme, a vital skill for computational materials science.", "problem": "Consider a binary phase-field model for a diffuse interface at a solid wall. Let the order parameter be denoted by $\\,\\phi\\,\\in[-1,1]\\,$, with the two bulk phases at $\\,\\phi=\\pm 1\\,$. The total free energy functional in a domain $\\,\\Omega\\,$ with boundary $\\,\\partial\\Omega\\,$ is given by\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{\\Omega} \\left( \\lambda\\, W(\\phi) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla \\phi|^2 \\right)\\, \\mathrm{d}V \\;+\\; \\int_{\\partial\\Omega} g_s(\\phi)\\, \\mathrm{d}S,\n$$\nwhere $\\,W(\\phi)\\,$ is a symmetric double-well potential, $\\,\\kappa0\\,$ is the gradient energy coefficient, $\\,\\lambda0\\,$ sets the bulk energy scale, and $\\,g_s(\\phi)\\,$ is a wall free-energy density. In this problem, assume the standard double-well\n$$\nW(\\phi) \\;=\\; \\frac{(\\phi^2 - 1)^2}{4},\n$$\nand adopt the common choice $\\,\\lambda=1\\,$ and $\\,\\kappa=\\varepsilon^2\\,$, where $\\,\\varepsilon0\\,$ sets the diffuse interface thickness.\n\nAt equilibrium, in the bulk, the Eulerâ€“Lagrange equation holds:\n$$\n-\\,\\kappa\\, \\nabla^2 \\phi \\;+\\; \\lambda\\, W'(\\phi) \\;=\\; \\mu,\n$$\nwith $\\,\\mu\\,$ a constant chemical potential. For a stationary planar interface with $\\,\\mu=0\\,$, there is an equipartition relation between bulk and gradient energies along the coordinate $\\,s\\,$ normal to the interface:\n$$\n\\frac{\\kappa}{2}\\,\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}s}\\right)^2 \\;=\\; \\lambda\\, W(\\phi).\n$$\nAssume the contact-angle condition at a smooth solid wall is enforced by the geometric balance between the wall-normal derivative and the magnitude of the equilibrium gradient, namely\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi \\;=\\; -\\,\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}},\n$$\nwhere $\\,\\mathbf{n}_w\\,$ is the unit normal pointing from the wall into the fluid, and $\\,\\theta\\,$ is the Youngâ€™s contact angle between the interface and the wall. With $\\,\\lambda=1\\,$ and $\\,\\kappa=\\varepsilon^2\\,$, this reduces to\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi \\;=\\; -\\,\\cos(\\theta)\\,\\frac{\\sqrt{2\\, W(\\phi)}}{\\varepsilon}.\n$$\n\nYou are to implement a second-order accurate boundary discretization for this wall condition in one spatial dimension along the wall-normal coordinate $\\,x\\ge 0\\,$ with the wall at $\\,x=0\\,$ and $\\,\\mathbf{n}_w = \\mathbf{e}_x\\,$. Let $\\,\\Delta x0\\,$ be a uniform grid spacing, and denote by $\\,\\phi_1\\,$ the known value of $\\,\\phi\\,$ at the first interior node located at $\\,x=\\Delta x\\,$. Introduce one geometric ghost unknown $\\,\\phi_{-1}\\,$ located at $\\,x=-\\Delta x\\,$ for a second-order approximation:\n- Approximate the wall-normal derivative by the centered difference\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} \\;\\approx\\; \\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x}.\n$$\n- Approximate the wall value by the centered average\n$$\n\\phi_w \\;\\approx\\; \\frac{\\phi_1 + \\phi_{-1}}{2}.\n$$\n\nUsing the above, enforce the geometric contact-angle condition to determine $\\,\\phi_{-1}\\,$ from $\\,\\phi_1\\,$, $\\,\\varepsilon\\,$, $\\,\\Delta x\\,$, and $\\,\\theta\\,$. To robustly solve the resulting nonlinear equation, it is advantageous to reparameterize by the average $\\,\\phi_{\\text{avg}} := \\phi_w = (\\phi_1+\\phi_{-1})/2\\,$ and eliminate $\\,\\phi_{-1}\\,$ via $\\,\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1\\,$, yielding the scalar equation\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} \\;+\\; \\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon} \\;=\\; 0,\n$$\nto be solved for $\\,\\phi_{\\text{avg}} \\in [-1,1]\\,$. The physically relevant branch satisfies $\\,\\phi_{\\text{avg}} \\in [-1,1]\\,$ so that $\\,\\sqrt{2\\,W(\\phi_{\\text{avg}})} = \\frac{|1-\\phi_{\\text{avg}}^2|}{\\sqrt{2}} = \\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}}\\,$.\n\nYour task:\n1. From the fundamental definitions and the equipartition relation, derive the above geometric boundary condition and its second-order discrete form as stated.\n2. Implement a program that, for given $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta)\\,$, computes $\\,\\phi_{-1}\\,$ by solving for $\\,\\phi_{\\text{avg}}\\,$ in the interval $\\,[-1,1]\\,$ and then mapping back $\\,\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1\\,$.\n3. Angles must be interpreted in radians. All quantities are dimensionless. For numerical robustness, solve the scalar equation using a root-finding method guaranteed to find a root in the closed interval $\\,[-1,1]\\,$ whenever $\\,\\phi_1 \\in [-1,1]\\,$.\n\nTest suite:\nProvide outputs for the following four test cases, each specified as a tuple $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta)\\,$:\n- Case A (happy path): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,0.0,\\,\\pi/3\\,)\\,$.\n- Case B (right angle): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,-0.8,\\,\\pi/2\\,)\\,$.\n- Case C (complete wetting): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.02,\\,0.01,\\,0.5,\\,0\\,)\\,$.\n- Case D (non-wetting): $\\,(\\varepsilon,\\Delta x,\\phi_1,\\theta) = (\\,0.05,\\,0.02,\\,-0.3,\\,\\pi\\,)\\,$.\n\nFinal output format:\nYour program should produce a single line of output containing the four computed ghost values $\\,\\phi_{-1}\\,$, in the order of Cases Aâ€“D, as a comma-separated list enclosed in square brackets, for example $\\,\\left[\\phi_{-1}^{(A)},\\phi_{-1}^{(B)},\\phi_{-1}^{(C)},\\phi_{-1}^{(D)}\\right]\\,$. The entries must be plain decimal numbers. Angles are in radians; no physical units are involved.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It describes a standard method for implementing contact angle boundary conditions in a phase-field model. The provided equations and parameters are consistent with established literature in computational materials science and nanomechanics. Therefore, a solution will be provided.\n\nThe task is partitioned into two parts: first, a derivation of the specified boundary condition and its discrete form; second, the implementation of a numerical solver for the resulting equation.\n\n**Part 1: Derivation of the Boundary Condition and its Discretization**\n\nThe total free energy of the system is given by the functional\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} f_{bulk}(\\phi, \\nabla\\phi) \\, \\mathrm{d}V + \\int_{\\partial\\Omega} g_s(\\phi) \\, \\mathrm{d}S,\n$$\nwhere the bulk free energy density is $f_{bulk} = \\lambda W(\\phi) + \\frac{\\kappa}{2} |\\nabla \\phi|^2$. At equilibrium, the state of the system locally minimizes this energy functional. The first variation of $\\mathcal{F}$ must vanish, $\\delta \\mathcal{F} = 0$.\n\nThe variation is computed as:\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\frac{\\partial f_{bulk}}{\\partial \\phi} \\delta\\phi + \\frac{\\partial f_{bulk}}{\\partial \\nabla\\phi} \\cdot \\delta(\\nabla\\phi) \\right) \\mathrm{d}V + \\int_{\\partial\\Omega} g_s'(\\phi) \\delta\\phi \\, \\mathrm{d}S.\n$$\nWith $f_{bulk}$ as defined, this gives:\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\lambda W'(\\phi) \\delta\\phi + \\kappa \\nabla\\phi \\cdot \\nabla(\\delta\\phi) \\right) \\mathrm{d}V + \\int_{\\partial\\Omega} g_s'(\\phi) \\delta\\phi \\, \\mathrm{d}S.\n$$\nApplying the divergence theorem to the gradient term, $\\int_{\\Omega} \\mathbf{A} \\cdot \\nabla u \\, \\mathrm{d}V = \\int_{\\partial\\Omega} u (\\mathbf{A} \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} u (\\nabla \\cdot \\mathbf{A}) \\, \\mathrm{d}V$, with $u = \\delta\\phi$ and $\\mathbf{A} = \\kappa \\nabla\\phi$, we get:\n$$\n\\int_{\\Omega} \\kappa \\nabla\\phi \\cdot \\nabla(\\delta\\phi) \\, \\mathrm{d}V = \\int_{\\partial\\Omega} \\kappa \\delta\\phi (\\nabla\\phi \\cdot \\mathbf{n}) \\, \\mathrm{d}S - \\int_{\\Omega} \\kappa \\delta\\phi (\\nabla^2\\phi) \\, \\mathrm{d}V.\n$$\nHere, $\\mathbf{n}$ is the outward-pointing unit normal of the domain $\\Omega$. Substituting this back into the variation $\\delta \\mathcal{F}$ yields:\n$$\n\\delta \\mathcal{F} = \\int_{\\Omega} \\left( \\lambda W'(\\phi) - \\kappa \\nabla^2\\phi \\right) \\delta\\phi \\, \\mathrm{d}V + \\int_{\\partial\\Omega} \\left( g_s'(\\phi) + \\kappa (\\nabla\\phi \\cdot \\mathbf{n}) \\right) \\delta\\phi \\, \\mathrm{d}S.\n$$\nSince $\\delta\\phi$ is arbitrary in the bulk $\\Omega$ and on the boundary $\\partial\\Omega$, both integrands must be zero for $\\delta \\mathcal{F}=0$. This yields the Euler-Lagrange equation for the bulk (with chemical potential $\\mu=0$),\n$$\n-\\kappa \\nabla^2\\phi + \\lambda W'(\\phi) = 0,\n$$\nand the natural boundary condition on $\\partial\\Omega$,\n$$\n\\kappa (\\mathbf{n} \\cdot \\nabla\\phi) + g_s'(\\phi) = 0.\n$$\nThe problem defines $\\mathbf{n}_w$ as the unit normal pointing from the wall *into* the fluid domain, thus $\\mathbf{n} = -\\mathbf{n}_w$. The boundary condition becomes:\n$$\n\\kappa (\\mathbf{n}_w \\cdot \\nabla\\phi) = g_s'(\\phi).\n$$\nThis is the generalized boundary condition derived from variational principles. The problem specifies a particular \"geometric\" form of this condition:\n$$\n\\mathbf{n}_w \\cdot \\nabla \\phi = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}}.\n$$\nThis form is a modeling choice that directly enforces Young's contact angle $\\theta$. It is obtained by postulating that the derivative of the surface energy density, $g_s'(\\phi)$, is proportional to the gradient magnitude of a one-dimensional equilibrium interface profile. The equipartition relation for a stationary planar interface, $\\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}s}\\right)^2 = \\lambda W(\\phi)$, gives the magnitude of this equilibrium gradient as $|\\nabla \\phi|_{eq} = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}s} = \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}}$.\nBy substituting this into the geometric condition, we see it can be written as $\\mathbf{n}_w \\cdot \\nabla \\phi = -\\cos(\\theta) |\\nabla \\phi|_{eq}$. Comparing this to the variational condition gives the specific functional form for the derivative of the wall energy that this model implies:\n$$\ng_s'(\\phi) = \\kappa \\left( -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi)}}{\\sqrt{\\kappa}} \\right) = -\\cos(\\theta) \\sqrt{2\\lambda\\kappa W(\\phi)}.\n$$\nThis completes the derivation and justification of the continuous boundary condition.\n\nNext, we derive the second-order accurate discrete form. The setup is one-dimensional with coordinate $x \\ge 0$, a wall at $x=0$, and $\\mathbf{n}_w = \\mathbf{e}_x$. The condition becomes:\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,\\lambda\\, W(\\phi(0))}}{\\sqrt{\\kappa}}.\n$$\nWe use the given second-order centered approximations for the derivative and the wall value $\\phi_w = \\phi(0)$:\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=0} \\approx \\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x} \\quad \\text{and} \\quad \\phi_w \\approx \\frac{\\phi_1 + \\phi_{-1}}{2}.\n$$\nSubstituting these into the continuous condition, and with $\\lambda=1$ and $\\kappa=\\varepsilon^2$, we obtain the discrete equation:\n$$\n\\frac{\\phi_1 - \\phi_{-1}}{2\\,\\Delta x} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_w)}}{\\varepsilon}.\n$$\nTo obtain the scalar equation to be solved, we reparameterize using $\\phi_{\\text{avg}} = \\phi_w = (\\phi_1 + \\phi_{-1})/2$. This implies $\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1$. Substituting this expression for $\\phi_{-1}$ into the left side of the discrete equation gives:\n$$\n\\frac{\\phi_1 - (2\\,\\phi_{\\text{avg}} - \\phi_1)}{2\\,\\Delta x} = \\frac{2\\phi_1 - 2\\phi_{\\text{avg}}}{2\\,\\Delta x} = \\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x}.\n$$\nEquating this with the right-hand side yields:\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} = -\\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon}.\n$$\nRearranging terms gives the final scalar equation to be solved for $\\phi_{\\text{avg}}$:\n$$\n\\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} + \\cos(\\theta)\\,\\frac{\\sqrt{2\\,W(\\phi_{\\text{avg}})}}{\\varepsilon} = 0.\n$$\nThis completes the derivation of the discrete form as required.\n\n**Part 2: Numerical Solution**\n\nThe task is to solve the derived scalar equation for $\\phi_{\\text{avg}} \\in [-1, 1]$. In this interval, the double-well potential $W(\\phi) = (\\phi^2-1)^2/4$ simplifies the term $\\sqrt{2W(\\phi)}$:\n$$\n\\sqrt{2W(\\phi_{\\text{avg}})} = \\sqrt{2 \\frac{(\\phi_{\\text{avg}}^2-1)^2}{4}} = \\frac{|\\phi_{\\text{avg}}^2 - 1|}{\\sqrt{2}} = \\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}},\n$$\nsince $\\phi_{\\text{avg}}^2 \\le 1$. The equation to solve is therefore:\n$$\nf(\\phi_{\\text{avg}}) = \\frac{\\phi_1 - \\phi_{\\text{avg}}}{\\Delta x} + \\cos(\\theta)\\frac{1-\\phi_{\\text{avg}}^2}{\\sqrt{2}\\varepsilon} = 0.\n$$\nThis is a quadratic equation in $\\phi_{\\text{avg}}$. A robust approach to find the physically relevant root is to use a bracketing root-finding algorithm, such as Brent's method. We need to find an interval $[a, b]$ where $f(a)$ and $f(b)$ have opposite signs. The problem suggests the solution lies in $[-1, 1]$. Let us check the function values at the endpoints of this interval, for a given $\\phi_1 \\in [-1, 1]$:\n$$\nf(-1) = \\frac{\\phi_1 - (-1)}{\\Delta x} + \\cos(\\theta)\\frac{1-(-1)^2}{\\sqrt{2}\\varepsilon} = \\frac{\\phi_1+1}{\\Delta x}.\n$$\n$$\nf(1) = \\frac{\\phi_1 - 1}{\\Delta x} + \\cos(\\theta)\\frac{1-1^2}{\\sqrt{2}\\varepsilon} = \\frac{\\phi_1-1}{\\Delta x}.\n$$\nGiven $\\Delta x  0$, and that the test cases use $\\phi_1 \\in [-1, 1]$, we have $\\phi_1+1 \\ge 0$ and $\\phi_1-1 \\le 0$. Thus, $f(-1) \\ge 0$ and $f(1) \\le 0$. This guarantees that $f(-1) \\cdot f(1) \\le 0$, so there is always at least one root within the interval $[-1, 1]$. We can therefore safely use a bracketing solver like `scipy.optimize.brentq` on the interval $[-1, 1]$.\n\nOnce $\\phi_{\\text{avg}}$ is found, the value of the ghost point $\\phi_{-1}$ is computed from the relation $\\phi_{-1} = 2\\,\\phi_{\\text{avg}} - \\phi_1$. The following program implements this procedure for the given test cases.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the ghost point value phi_{-1} for four test cases\n    of a phase-field contact angle boundary condition.\n    \"\"\"\n    \n    # Test suite: (epsilon, delta_x, phi_1, theta in radians)\n    test_cases = [\n        (0.02, 0.01, 0.0, np.pi / 3),  # Case A\n        (0.02, 0.01, -0.8, np.pi / 2), # Case B\n        (0.02, 0.01, 0.5, 0.0),       # Case C\n        (0.05, 0.02, -0.3, np.pi),     # Case D\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        eps, dx, phi1, theta = case\n\n        # Define the scalar function f(phi_avg) = 0 to be solved.\n        # The equation is:\n        # (phi1 - phi_avg)/dx + cos(theta) * (1 - phi_avg^2) / (sqrt(2)*eps) = 0\n        def f(phi_avg):\n            term1 = (phi1 - phi_avg) / dx\n            term2 = np.cos(theta) * (1 - phi_avg**2) / (np.sqrt(2) * eps)\n            return term1 + term2\n\n        # As derived in the solution, for phi1 in [-1, 1], a root is guaranteed\n        # to exist in the interval [-1, 1]. We use Brent's method for robust\n        # root-finding in this bracket.\n        try:\n            phi_avg = brentq(f, -1.0, 1.0)\n        except ValueError:\n            # This case can happen if f(-1) and f(1) have the same sign, which\n            # occurs if phi1 is exactly -1 or 1, making one boundary value zero.\n            # brentq handles a zero at a boundary, so this is mainly for robustness.\n            # If f(-1) is zero, phi1=-1, so phi_avg=-1 is a root.\n            if np.isclose(f(-1.0), 0):\n                phi_avg = -1.0\n            elif np.isclose(f(1.0), 0):\n                phi_avg = 1.0\n            else:\n                # Should not be reached given the analysis.\n                raise\n    \n        # Calculate the ghost point value phi_{-1}\n        phi_m1 = 2 * phi_avg - phi1\n        \n        results.append(phi_m1)\n\n    # Format the results as specified.\n    print(f\"[{','.join(f'{r:.16f}'.rstrip('0').rstrip('.') for r in results)}]\")\n\nsolve()\n```", "id": "2782614"}]}