{"hands_on_practices": [{"introduction": "To begin our exploration of atomic friction, we first address a fundamental question: under what conditions does the smooth, continuous sliding we experience at the macroscale give way to the jerky, stick-slip motion characteristic of the nanoscale? This exercise [@problem_id:2780043] uses the foundational Tomlinson model to derive the critical stiffness, $k_c$, a parameter that elegantly delineates these two regimes. By comparing the stiffness of the probing system (like an AFM cantilever) to the curvature of the atomic potential, you will develop a powerful intuition for predicting the frictional behavior of a system.", "problem": "Consider the one-dimensional Tomlinson model of atomic friction: a point mass representing a tip is attached to a rigid support by a linear spring of stiffness $k$ and moves over a rigid crystalline substrate that exerts a periodic potential $V(x)$. In the quasistatic limit at zero temperature ($T=0$), the system evolves through local minima of the total potential\n$$\nU(x;X) = \\tfrac{1}{2} k \\bigl(x - X\\bigr)^{2} + V(x),\n$$\nwhere $X$ is the externally controlled support position. Assume a sinusoidal substrate potential\n$$\nV(x) = U_{0} \\cos\\!\\left(\\tfrac{2\\pi}{a}\\,x\\right),\n$$\nwith amplitude $U_{0}$ and lattice period $a$. Use only mechanical stability of equilibria and the definitions above as your starting point.\n\nTasks:\n1) Starting from the equilibrium condition $\\partial U/\\partial x = 0$ and the stability condition $\\partial^{2} U/\\partial x^{2} > 0$, derive an expression for the critical stiffness $k_{c}$ that separates smooth sliding from stick-slip at $T=0$, expressed solely in terms of $U_{0}$ and $a$.\n2) Using your result, evaluate $k_{c}$ numerically for $U_{0} = 0.3\\,\\mathrm{eV}$ and $a = 0.25\\,\\mathrm{nm}$. Express $k_{c}$ in $\\mathrm{N/m}$ and round your result to four significant figures.\n3) Decide whether a cantilever with stiffness $k = 10\\,\\mathrm{N/m}$ will exhibit stick-slip at $T=0$ under these conditions. Represent your decision by a binary indicator $S$, where $S = 1$ if stick-slip occurs and $S = 0$ otherwise.\n\nAnswer specification:\n- Report your final answer as a row matrix $\\begin{pmatrix} k_c  S \\end{pmatrix}$.\n- The first entry $k_c$ must be the numerical value in $\\mathrm{N/m}$ rounded to four significant figures. The second entry $S$ must be either $0$ or $1$.\n- Do not include units in the final boxed answer.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It concerns the Tomlinson model, a fundamental concept in the study of atomic-scale friction. All parameters and conditions required for a rigorous analysis are provided. The problem is free of factual errors, contradictions, and ambiguities. A unique solution is attainable through standard methods of stability analysis. Thus, the problem is deemed valid and a solution will be provided.\n\nThe total potential energy of the system, $U(x;X)$, is given as the sum of the elastic energy of the spring and the interaction potential with the substrate:\n$$\nU(x;X) = \\frac{1}{2} k (x - X)^{2} + V(x)\n$$\nwhere the substrate potential is specified as:\n$$\nV(x) = U_{0} \\cos\\left(\\frac{2\\pi}{a}x\\right)\n$$\nHere, $x$ is the position of the tip, $X$ is the position of the support, $k$ is the spring stiffness, $U_0$ is the corrugation amplitude, and $a$ is the lattice period of the substrate. The system operates in the quasistatic limit at zero temperature, $T=0$, meaning the tip always resides in a local minimum of the total potential $U(x;X)$.\n\n**Part 1: Derivation of the critical stiffness $k_c$**\n\nFor the tip to be in a state of mechanical equilibrium, the net force on it must be zero. This corresponds to an extremum of the total potential energy with respect to the tip's position $x$:\n$$\n\\frac{\\partial U}{\\partial x} = 0\n$$\nCalculating this derivative, we obtain the equilibrium condition:\n$$\n\\frac{\\partial U}{\\partial x} = k(x - X) - U_{0} \\frac{2\\pi}{a} \\sin\\left(\\frac{2\\pi}{a}x\\right) = 0\n$$\nThis equation relates the equilibrium position $x$ of the tip to the support position $X$.\n\nFor an equilibrium to be stable, it must correspond to a local minimum of the potential energy, not a maximum or a saddle point. This requires the second derivative of the potential energy with respect to $x$ to be positive:\n$$\n\\frac{\\partial^2 U}{\\partial x^2} > 0\n$$\nCalculating the second derivative yields:\n$$\n\\frac{\\partial^2 U}{\\partial x^2} = k - U_{0} \\left(\\frac{2\\pi}{a}\\right)^2 \\cos\\left(\\frac{2\\pi}{a}x\\right)\n$$\nThus, the condition for a stable equilibrium is:\n$$\nk - U_{0} \\left(\\frac{2\\pi}{a}\\right)^2 \\cos\\left(\\frac{2\\pi}{a}x\\right) > 0\n$$\nThe system exhibits smooth sliding if, for any given support position $X$, there is always one and only one stable equilibrium position $x$. This requires the stability condition, $\\frac{\\partial^2 U}{\\partial x^2} > 0$, to be satisfied for all possible equilibrium positions $x$ that the tip might occupy as $X$ is varied.\n\nStick-slip motion arises when this condition is violated. The system loses stability when the potential minimum in which the tip resides vanishes. The transition point between the smooth sliding regime and the stick-slip regime is defined by the critical stiffness, $k_c$, at which the stability can first be lost. This occurs when the second derivative can become zero for some position $x$:\n$$\n\\frac{\\partial^2 U}{\\partial x^2} = 0\n$$\nThe stability is most challenged (i.e., $\\frac{\\partial^2 U}{\\partial x^2}$ is at its minimum) at the points where the term subtracted from $k$ is maximal. The function $\\cos\\left(\\frac{2\\pi}{a}x\\right)$ has a maximum value of $1$. The condition is most stringent when $\\cos\\left(\\frac{2\\pi}{a}x\\right) = 1$. This corresponds to tip positions $x=na$ for integer $n$, which are the maxima of the substrate potential $V(x)$. At these points, the curvature of the substrate potential is most negative, making the system most susceptible to instability.\n\nThe critical stiffness $k_c$ is the value of $k$ for which the stability condition is marginally met at these most unstable points. Setting $\\frac{\\partial^2 U}{\\partial x^2} = 0$ with $\\cos\\left(\\frac{2\\pi}{a}x\\right) = 1$:\n$$\nk_c - U_{0} \\left(\\frac{2\\pi}{a}\\right)^2 (1) = 0\n$$\nSolving for $k_c$, we obtain the expression for the critical stiffness:\n$$\nk_c = U_{0} \\left(\\frac{2\\pi}{a}\\right)^2 = \\frac{4\\pi^2 U_0}{a^2}\n$$\nIf $k > k_c$, the total potential has a single minimum for all $X$, and sliding is smooth. If $k  k_c$, there are ranges of $X$ for which the potential has multiple minima, leading to hysteretic jumps, i.e., stick-slip motion.\n\n**Part 2: Numerical evaluation of $k_c$**\n\nWe are given the parameters $U_0 = 0.3\\,\\mathrm{eV}$ and $a = 0.25\\,\\mathrm{nm}$. We must convert these to SI units.\nThe energy unit conversion is $1\\,\\mathrm{eV} \\approx 1.6021766 \\times 10^{-19}\\,\\mathrm{J}$.\nThe length unit is $1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m}$.\nSo, we have:\n$$\nU_0 = 0.3 \\times (1.6021766 \\times 10^{-19})\\,\\mathrm{J} = 4.8065298 \\times 10^{-20}\\,\\mathrm{J}\n$$\n$$\na = 0.25 \\times 10^{-9}\\,\\mathrm{m}\n$$\nSubstituting these values into the expression for $k_c$:\n$$\nk_c = \\frac{4\\pi^2 (4.8065298 \\times 10^{-20}\\,\\mathrm{J})}{(0.25 \\times 10^{-9}\\,\\mathrm{m})^2} = \\frac{4\\pi^2 (4.8065298 \\times 10^{-20})}{0.0625 \\times 10^{-18}}\\,\\mathrm{N/m}\n$$\n$$\nk_c = \\frac{4\\pi^2 (4.8065298)}{0.0625} \\times 10^{-2}\\,\\mathrm{N/m} \\approx 30.3592\\,\\mathrm{N/m}\n$$\nRounding the result to four significant figures gives:\n$$\nk_c \\approx 30.36\\,\\mathrm{N/m}\n$$\n\n**Part 3: Assessment of stick-slip for $k = 10\\,\\mathrm{N/m}$**\n\nTo determine the sliding regime, we compare the given cantilever stiffness, $k = 10\\,\\mathrm{N/m}$, with the calculated critical stiffness, $k_c \\approx 30.36\\,\\mathrm{N/m}$.\nThe condition for stick-slip is $k  k_c$.\nIn this case, we have:\n$$\n10\\,\\mathrm{N/m}  30.36\\,\\mathrm{N/m}\n$$\nSince the inequality holds, the cantilever is \"soft\" relative to the potential corrugation, and the system will exhibit stick-slip motion. The binary indicator for stick-slip ($S=1$) is therefore $S=1$.\n\nThe final answer is presented as a row matrix $\\begin{pmatrix} k_c  S \\end{pmatrix}$, where $k_c$ is the numerical value $30.36$ and $S$ is the indicator $1$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.36  1\n\\end{pmatrix}\n}\n$$", "id": "2780043"}, {"introduction": "Having established the conditions for stick-slip, we now investigate what happens when the external driving force is strong enough to overcome static pinning. This practice [@problem_id:2779995] moves from statics to dynamics by examining a commensurate Frenkel-Kontorova chain in the overdamped limit. You will derive the steady-state velocity-force characteristic, $v(F)$, which reveals the non-linear relationship between sliding speed and applied force, and precisely identify the depinning threshold, $F_s$, where the system transitions from a pinned state to continuous motion.", "problem": "Consider a one-dimensional Frenkel–Kontorova (FK) model: a chain of $N \\gg 1$ identical particles of mass $m$ connected by nearest-neighbor linear springs of stiffness $K$ and natural spacing $a$, moving over a rigid crystalline substrate with potential $U(x) = U_{0}\\bigl[1 - \\cos(2\\pi x/a)\\bigr]$. The chain is $1{:}1$ commensurate with the substrate, the temperature is zero, and periodic boundary conditions are imposed. A uniform static driving force $F$ is applied to each particle. The dynamics are overdamped with viscous drag coefficient $\\eta$, so that inertial effects are negligible.\n\nStarting from Newton’s second law in the overdamped limit and the definition of the substrate force as the negative gradient of $U(x)$, derive the steady-state velocity–force characteristic $v(F)$ for this commensurate chain, and identify the depinning threshold $F_{s}$. Express your final result as a single closed-form analytic expression for $v(F)$ in terms of $F$, $U_{0}$, $a$, and $\\eta$. You may use the Heaviside step function $\\Theta(\\cdot)$ to compactly represent the pinned and sliding regimes in a single formula. Do not include units in your final boxed answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard theoretical exercise in the study of the Frenkel-Kontorova model, a cornerstone of nanomechanics. All necessary parameters and conditions are provided for a unique solution to be derived. Therefore, we proceed with the derivation.\n\nThe system consists of a chain of particles, and the motion of the $i$-th particle at position $x_{i}$ is governed by Newton's second law. The total force on this particle is the sum of the force from the neighboring springs, the force from the substrate potential, the external driving force, and the viscous drag force. The equation of motion is:\n$$m \\ddot{x}_{i} = F_{\\text{spring}, i} + F_{\\text{substrate}, i} + F_{\\text{drive}, i} + F_{\\text{drag}, i}$$\n\nThe problem specifies that the dynamics are overdamped, meaning inertial effects are negligible. We thus take the limit $m \\to 0$, which sets the left-hand side to zero:\n$$0 = F_{\\text{spring}, i} + F_{\\text{substrate}, i} + F_{\\text{drive}, i} + F_{\\text{drag}, i}$$\n\nWe now define each force term for the $i$-th particle:\n1.  The spring force, from the two nearest neighbors ($i-1$ and $i+1$) with spring constant $K$ and natural spacing $a$, is:\n    $$F_{\\text{spring}, i} = K(x_{i+1} - x_{i} - a) - K(x_{i} - x_{i-1} - a) = K(x_{i+1} - 2x_{i} + x_{i-1})$$\n2.  The substrate force is the negative gradient of the potential $U(x) = U_{0}\\bigl[1 - \\cos(2\\pi x/a)\\bigr]$:\n    $$F_{\\text{substrate}, i} = -\\frac{dU}{dx}\\bigg|_{x=x_{i}} = -U_{0} \\frac{d}{dx_{i}}\\left(1 - \\cos\\left(\\frac{2\\pi x_{i}}{a}\\right)\\right) = -U_{0} \\left(\\frac{2\\pi}{a}\\right) \\sin\\left(\\frac{2\\pi x_{i}}{a}\\right)$$\n3.  The uniform driving force is simply $F$.\n4.  The viscous drag force is proportional to the velocity $\\dot{x}_{i}$ with drag coefficient $\\eta$:\n    $$F_{\\text{drag}, i} = -\\eta \\dot{x}_{i}$$\n\nSubstituting these terms into the overdamped equation of motion gives:\n$$\\eta \\dot{x}_{i} = K(x_{i+1} - 2x_{i} + x_{i-1}) - \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi x_{i}}{a}\\right) + F$$\n\nA critical condition is that the chain is $1{:}1$ commensurate with the substrate, meaning the chain's natural spacing $a$ equals the substrate potential's period $a$. Also, the driving force $F$ is uniform across all particles. Due to this symmetry, the configuration of lowest energy for the moving chain is one of rigid, collective motion. All particles move together, maintaining their relative spacing. We can describe the position of the $i$-th particle by a single collective coordinate $X(t)$ as:\n$$x_{i}(t) = X(t) + (i-1)a$$\nThis ansatz implies that the distance between any two adjacent particles is always $a$, i.e., $x_{i+1} - x_{i} = a$.\n\nSubstituting this into the spring force term yields:\n$$F_{\\text{spring}, i} = K((x_{i+1}-x_i) - (x_i-x_{i-1})) = K(a - a) = 0$$\nThe springs remain at their natural length and thus exert no force.\nThe substrate force on particle $i$ becomes:\n$$F_{\\text{substrate}, i} = - \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi (X(t) + (i-1)a)}{a}\\right) = - \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi X(t)}{a} + 2\\pi(i-1)\\right) = - \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi X(t)}{a}\\right)$$\nThis term is now independent of the particle index $i$. All particles experience the same substrate force simultaneously. The velocity of each particle is $\\dot{x}_{i} = \\dot{X}(t)$.\n\nThe equation of motion for the entire chain simplifies to a single equation for the collective coordinate $X(t)$:\n$$\\eta \\frac{dX}{dt} = F - \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi X}{a}\\right)$$\n\nFirst, we identify the depinning threshold, $F_{s}$. This is the maximum static force from the substrate that the driving force must overcome. If the chain is to remain pinned, its velocity must be zero, $\\frac{dX}{dt}=0$. This requires a static equilibrium position $X_{0}$ such that:\n$$F = \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi X_{0}}{a}\\right)$$\nA real solution for $X_{0}$ exists only if the magnitude of the driving force $F$ is less than or equal to the amplitude of the sinusoidal substrate force. The maximum value of the substrate's resistive force is:\n$$F_{s} = \\max\\left| \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi X}{a}\\right) \\right| = \\frac{2\\pi U_{0}}{a}$$\nFor any driving force $F \\le F_{s}$, the chain can find an equilibrium position where it remains pinned. Thus, the steady-state velocity is $v=0$ for $F \\le F_{s}$.\n\nSecond, for $F  F_{s}$, no static equilibrium is possible. The net force on the right-hand side is always positive, and the chain slides with a non-zero steady-state velocity $v$. This velocity is the average velocity, $v = \\langle \\dot{X}(t) \\rangle$. We can calculate this by finding the time $T$ required for the system to traverse one period of the potential, which is a distance $a$.\n$$v = \\frac{a}{T}$$\nThe time $T$ is found by integrating $dt$ over one period of motion in $X$:\n$$T = \\int_{0}^{a} dt = \\int_{0}^{a} \\frac{dX}{\\dot{X}(t)} = \\int_{0}^{a} \\frac{\\eta}{F - \\frac{2\\pi U_{0}}{a} \\sin\\left(\\frac{2\\pi X}{a}\\right)} dX$$\nLet us perform a change of variables with $\\theta = \\frac{2\\pi X}{a}$, so $dX = \\frac{a}{2\\pi} d\\theta$. The integration limits for $X$ from $0$ to $a$ correspond to $\\theta$ from $0$ to $2\\pi$:\n$$T = \\int_{0}^{2\\pi} \\frac{\\eta}{F - F_{s} \\sin(\\theta)} \\frac{a}{2\\pi} d\\theta = \\frac{\\eta a}{2\\pi} \\int_{0}^{2\\pi} \\frac{d\\theta}{F - F_{s} \\sin(\\theta)}$$\nThis is a standard definite integral. For $F  F_{s}$, its value is known to be:\n$$\\int_{0}^{2\\pi} \\frac{d\\theta}{A - B \\sin(\\theta)} = \\frac{2\\pi}{\\sqrt{A^{2} - B^{2}}} \\quad (\\text{for } A  |B|)$$\nIn our case, $A=F$ and $B=F_{s}$, and we are in the regime $F  F_{s}  0$. Therefore:\n$$\\int_{0}^{2\\pi} \\frac{d\\theta}{F - F_{s} \\sin(\\theta)} = \\frac{2\\pi}{\\sqrt{F^{2} - F_{s}^{2}}}$$\nSubstituting this result back into the expression for $T$:\n$$T = \\frac{\\eta a}{2\\pi} \\left( \\frac{2\\pi}{\\sqrt{F^{2} - F_{s}^{2}}} \\right) = \\frac{\\eta a}{\\sqrt{F^{2} - F_{s}^{2}}}$$\nThe steady-state velocity for $F  F_{s}$ is then:\n$$v = \\frac{a}{T} = \\frac{a \\sqrt{F^{2} - F_{s}^{2}}}{\\eta a} = \\frac{\\sqrt{F^{2} - F_{s}^{2}}}{\\eta}$$\nSubstituting the expression for $F_{s}$:\n$$v(F) = \\frac{\\sqrt{F^{2} - \\left(\\frac{2\\pi U_{0}}{a}\\right)^{2}}}{\\eta} \\quad \\text{for } F  F_s$$\n\nWe can write a single expression for $v(F)$ covering both the pinned ($F \\le F_{s}$) and sliding ($F  F_{s}$) regimes using the Heaviside step function, $\\Theta(z)$, defined as $\\Theta(z) = 0$ for $z \\le 0$ and $\\Theta(z) = 1$ for $z  0$. Some definitions vary at $z=0$, but for representing distinct physical regimes, this choice is appropriate. Using $\\Theta(F - F_{s})$ ensures the expression is zero for $F \\le F_{s}$.\nThe complete velocity-force characteristic is:\n$$v(F) = \\frac{\\sqrt{F^{2} - \\left(\\frac{2\\pi U_{0}}{a}\\right)^{2}}}{\\eta} \\Theta\\left(F - \\frac{2\\pi U_{0}}{a}\\right)$$\nThis is the final closed-form analytical expression for the steady-state velocity.", "answer": "$$\n\\boxed{\n\\frac{\\sqrt{F^{2} - \\left(\\frac{2\\pi U_{0}}{a}\\right)^{2}}}{\\eta} \\Theta\\left(F - \\frac{2\\pi U_{0}}{a}\\right)\n}\n$$", "id": "2779995"}, {"introduction": "While analytical models like Tomlinson and Frenkel-Kontorova provide invaluable physical insights, computer simulations are indispensable for studying more complex, realistic scenarios. This final practice [@problem_id:2780006] is a hands-on exercise in computational nanomechanics, focusing on the crucial first step of any molecular dynamics simulation: setting up a stable numerical integrator. By performing a linear stability analysis, you will determine the maximum permissible timestep, $h_{\\mathrm{crit}}$, for simulating these systems, a limit dictated by the fastest intrinsic vibrations of the atomic model.", "problem": "Design a stable time integrator for the underdamped Prandtl-Tomlinson (PT) and Frenkel-Kontorova (FK) dynamics using a velocity-Verlet-like scheme with a Langevin thermostat via B-A-O-A-B (BAOAB) splitting. Starting only from Newton's second law, the definitions of the model potentials, and linear small-oscillation analysis, derive a mathematically justified upper bound on the timestep in terms of the highest angular frequency. Then compute this bound numerically for specified parameter sets.\n\nAssume the following models and basic facts as the starting point.\n\n- Fundamental dynamics: For a degree of freedom with mass $m$, position $x$, and force $F(x)$, Newton's second law gives $m\\,\\ddot{x}=F(x)$. In the presence of a Langevin thermostat with friction coefficient $\\gamma$ and Gaussian white noise $\\eta(t)$, one has $m\\,\\ddot{x} = F(x) - m\\,\\gamma\\,\\dot{x} + \\sqrt{2 m \\gamma k_{\\mathrm{B}} T}\\,\\eta(t)$, where $k_{\\mathrm{B}}$ is Boltzmann's constant and $T$ is temperature. Consider the underdamped regime where the dimensionless damping ratio $\\zeta=\\gamma/(2\\omega)$ satisfies $\\zeta1$ for the frequencies of interest.\n\n- Prandtl-Tomlinson (PT) model: A particle of mass $m$ is attached to a support by a spring of stiffness $k_{\\mathrm{c}}$ and moves over a periodic substrate potential of amplitude $U_{0}$ and period $a$, with potential energy $V(x,t) = \\tfrac{1}{2} k_{\\mathrm{c}} (x - v t)^{2} + U_{0} \\cos\\!\\left( \\tfrac{2\\pi}{a} x \\right)$. For small oscillations about a substrate minimum, the substrate contribution is harmonic with curvature $k_{\\mathrm{sub}} = \\left(\\tfrac{2\\pi}{a}\\right)^{2} U_{0}$, and the effective small-oscillation stiffness is $k_{\\mathrm{eff}} = k_{\\mathrm{c}} + k_{\\mathrm{sub}}$.\n\n- Frenkel-Kontorova (FK) model: A one-dimensional chain of identical masses $m$ connected by nearest-neighbor springs of stiffness $k$ is placed on the same periodic substrate $U_{0}\\cos\\!\\left( \\tfrac{2\\pi}{a} x \\right)$. Linearizing about a commensurate minimum gives equations $m \\ddot{u}_{i} = -k_{\\mathrm{sub}} u_{i} - k(2 u_{i} - u_{i-1} - u_{i+1})$ with $k_{\\mathrm{sub}} = \\left(\\tfrac{2\\pi}{a}\\right)^{2} U_{0}$. For an infinite or sufficiently long chain, the phonon dispersion is $\\omega^{2}(q) = \\tfrac{k_{\\mathrm{sub}}}{m} + \\tfrac{2k}{m}\\left(1-\\cos q\\right)$, whose maximum over $q \\in [0,\\pi]$ is $\\omega_{\\max} = \\sqrt{\\tfrac{k_{\\mathrm{sub}}}{m} + \\tfrac{4k}{m}}$ attained at $q=\\pi$.\n\n- Velocity Verlet stability fact: For the linear oscillator $m \\ddot{x} + k x = 0$ with angular frequency $\\omega=\\sqrt{k/m}$, the explicit central-difference update (equivalently, velocity Verlet on the harmonic force) is linearly stable if and only if $h \\omega \\le 2$, where $h$ is the timestep. The BAOAB splitting uses an exact Ornstein-Uhlenbeck (OU) step for the Langevin part, which does not further reduce the linear stability limit inherited from the deterministic velocity Verlet substep.\n\nTask 1 (Derivation): From the above foundations, without using any pre-derived target formulas, perform the linear small-oscillation analysis to identify the highest angular frequency $\\omega_{\\max}$ for each model (PT and FK). Deduce a rigorous linear-stability upper bound $h_{\\mathrm{crit}} = 2/\\omega_{\\max}$ on the timestep for velocity-Verlet-type updates of the conservative part. Explain why the OU thermostat step in BAOAB does not tighten this bound for stability and how one may optionally choose a safety factor to accommodate nonlinearity.\n\nTask 2 (Implementation): Implement a program that, for each test case below, computes the critical timestep bound $h_{\\mathrm{crit}}$ in seconds using the following rules:\n- For PT: $\\omega_{\\max}^{\\mathrm{(PT)}} = \\sqrt{(k_{\\mathrm{c}} + k_{\\mathrm{sub}})/m}$ with $k_{\\mathrm{sub}} = \\left(\\tfrac{2\\pi}{a}\\right)^{2} U_{0}$.\n- For FK: $\\omega_{\\max}^{\\mathrm{(FK)}} = \\sqrt{(4k + k_{\\mathrm{sub}})/m}$ with $k_{\\mathrm{sub}} = \\left(\\tfrac{2\\pi}{a}\\right)^{2} U_{0}$.\n- Use the conversion $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ and express $a$ in meters, $m$ in kilograms, $k_{\\mathrm{c}}$ and $k$ in newtons per meter, and $h_{\\mathrm{crit}}$ in seconds.\n- The friction coefficient $\\gamma$ is provided to confirm the underdamped regime but should not enter the linear stability bound $h_{\\mathrm{crit}}$ since the OU step in BAOAB is exact in time; you may optionally discuss accuracy considerations in your derivation, but the numerical output must be the stability bound $h_{\\mathrm{crit}}$.\n\nTest suite (each line defines one case). All answers must be expressed in seconds, as floating-point numbers.\n\n- Case $1$ (PT baseline): $m=1.0\\times 10^{-26}\\,\\mathrm{kg}$, $k_{\\mathrm{c}}=1.0\\,\\mathrm{N/m}$, $U_{0}=0.2\\,\\mathrm{eV}$, $a=0.3\\,\\mathrm{nm}$, $\\gamma=1.0\\times 10^{12}\\,\\mathrm{s^{-1}}$.\n- Case $2$ (PT stiff substrate): $m=1.0\\times 10^{-25}\\,\\mathrm{kg}$, $k_{\\mathrm{c}}=0.5\\,\\mathrm{N/m}$, $U_{0}=1.0\\,\\mathrm{eV}$, $a=0.25\\,\\mathrm{nm}$, $\\gamma=5.0\\times 10^{12}\\,\\mathrm{s^{-1}}$.\n- Case $3$ (FK typical): $m=1.0\\times 10^{-26}\\,\\mathrm{kg}$, $k=10.0\\,\\mathrm{N/m}$, $U_{0}=0.2\\,\\mathrm{eV}$, $a=0.3\\,\\mathrm{nm}$, $\\gamma=1.0\\times 10^{12}\\,\\mathrm{s^{-1}}$.\n- Case $4$ (FK chain-only): $m=1.0\\times 10^{-26}\\,\\mathrm{kg}$, $k=1.0\\,\\mathrm{N/m}$, $U_{0}=0.0\\,\\mathrm{eV}$, $a=0.3\\,\\mathrm{nm}$, $\\gamma=1.0\\times 10^{12}\\,\\mathrm{s^{-1}}$.\n- Case $5$ (FK stiff and light): $m=5.0\\times 10^{-27}\\,\\mathrm{kg}$, $k=100.0\\,\\mathrm{N/m}$, $U_{0}=0.5\\,\\mathrm{eV}$, $a=0.25\\,\\mathrm{nm}$, $\\gamma=2.0\\times 10^{12}\\,\\mathrm{s^{-1}}$.\n\nRequired final output format: Your program should produce a single line of output containing the five results $[h_{\\mathrm{crit},1},h_{\\mathrm{crit},2},h_{\\mathrm{crit},3},h_{\\mathrm{crit},4},h_{\\mathrm{crit},5}]$ as a comma-separated list enclosed in square brackets, in seconds, with no additional text.", "solution": "The problem posed is to derive and compute the linear stability bound for a velocity-Verlet-type time integration scheme applied to the Prandtl-Tomlinson (PT) and Frenkel-Kontorova (FK) models of atomic friction. The problem is scientifically sound, well-posed, and provides all necessary information for its resolution. We will proceed with the derivation from fundamental principles, followed by the numerical implementation.\n\nThe foundation of the analysis is Newton's second law for a conservative system, which can be expressed in terms of the potential energy $V(\\mathbf{x})$ as $m_i \\ddot{x}_i = -\\frac{\\partial V}{\\partial x_i}$ for each degree of freedom $i$. For a system near a stable equilibrium configuration $\\mathbf{x}_0$, the potential energy can be approximated by a Taylor series expansion to second order:\n$$\nV(\\mathbf{x}) \\approx V(\\mathbf{x}_0) + (\\mathbf{x} - \\mathbf{x}_0) \\cdot \\nabla V|_{\\mathbf{x}_0} + \\frac{1}{2} (\\mathbf{x} - \\mathbf{x}_0)^T \\mathbf{K} (\\mathbf{x} - \\mathbf{x}_0)\n$$\nwhere $\\mathbf{K}$ is the Hessian matrix of second derivatives, $K_{ij} = \\frac{\\partial^2 V}{\\partial x_i \\partial x_j}|_{\\mathbf{x}_0}$. Since $\\mathbf{x}_0$ is an equilibrium point, the force $\\mathbf{F} = -\\nabla V$ is zero, so $\\nabla V|_{\\mathbf{x}_0} = 0$. Defining the displacement vector $\\mathbf{u} = \\mathbf{x} - \\mathbf{x}_0$, the linearized equations of motion for small oscillations become a set of coupled harmonic oscillator equations:\n$$\n\\mathbf{M} \\ddot{\\mathbf{u}} = -\\mathbf{K} \\mathbf{u}\n$$\nwhere $\\mathbf{M}$ is the mass matrix (a diagonal matrix with masses $m_i$).\n\nThis system can be decoupled by a change of basis to its normal modes. The eigenfrequencies $\\omega_k$ of these modes are determined by the generalized eigenvalue problem $(\\mathbf{K} - \\omega_k^2 \\mathbf{M})\\mathbf{v}_k = 0$. The stability of a numerical integrator for this multi-dimensional system is dictated by its stability for the fastest normal mode, which corresponds to the largest eigenfrequency, $\\omega_{\\max} = \\max_k\\{\\omega_k\\}$.\n\nThe problem specifies that the velocity Verlet algorithm, when applied to a single one-dimensional harmonic oscillator $m\\ddot{x} = -kx$ with angular frequency $\\omega = \\sqrt{k/m}$, is stable if and only if the timestep $h$ satisfies the condition $h\\omega \\leq 2$. For a system of coupled oscillators, this condition must hold for all modes. The most restrictive constraint is therefore imposed by the highest frequency mode:\n$$\nh \\omega_{\\max} \\le 2\n$$\nThis gives the critical timestep for linear stability as $h_{\\mathrm{crit}} = 2 / \\omega_{\\max}$. We will now derive $\\omega_{\\max}$ for the PT and FK models.\n\n**Prandtl-Tomlinson (PT) Model**\n\nThe PT model describes a single particle of mass $m$ with position $x$. The potential energy is given as $V(x,t) = \\tfrac{1}{2} k_{\\mathrm{c}} (x - v t)^{2} + U_{0} \\cos\\!\\left( \\tfrac{2\\pi}{a} x \\right)$. To analyze the intrinsic oscillatory behavior, we consider the static case where the support is held fixed, $v=0$. We can set the support equilibrium position to an arbitrary origin. The potential becomes $V(x) = \\tfrac{1}{2} k_{\\mathrm{c}} (x - x_s)^{2} + V_{\\mathrm{sub}}(x)$, where $V_{\\mathrm{sub}}(x) = U_{0} \\cos\\!\\left( \\tfrac{2\\pi}{a} x \\right)$ and $x_s$ is the support position.\n\nThe problem asks for an analysis of small oscillations about a minimum of the *substrate* potential. The minima of $V_{\\mathrm{sub}}(x)$ occur where $\\frac{2\\pi}{a}x = (2n+1)\\pi$ for integer $n$, because the second derivative must be positive. Let us verify this. The first derivative is $V'_{\\mathrm{sub}}(x) = -U_{0} \\frac{2\\pi}{a} \\sin(\\frac{2\\pi}{a}x)$, which is zero at $\\frac{2\\pi}{a}x = n\\pi$. The second derivative is $V''_{\\mathrm{sub}}(x) = -U_{0} (\\frac{2\\pi}{a})^2 \\cos(\\frac{2\\pi}{a}x)$. For a stable minimum, we require $V''_{\\mathrm{sub}}  0$. This occurs when $\\cos(\\frac{2\\pi}{a}x) = -1$, i.e., at $\\frac{2\\pi}{a}x = (2n+1)\\pi$. At these minima, the curvature of the substrate potential is indeed $k_{\\mathrm{sub}} = V''_{\\mathrm{sub}} = -U_{0} (\\frac{2\\pi}{a})^2 (-1) = (\\frac{2\\pi}{a})^2 U_{0}$, as stated in the problem.\n\nLet us linearize the total potential $V(x)$ around such a substrate minimum, say at $x_0$. Let us also assume the support is positioned such that the spring is unstretched, $x_s=x_0$. The effective stiffness constant is then the second derivative of the total potential at $x_0$:\n$$\nk_{\\mathrm{eff}} = \\frac{d^2 V}{dx^2}\\bigg|_{x_0} = \\frac{d^2}{dx^2}\\left( \\tfrac{1}{2} k_{\\mathrm{c}} (x - x_0)^{2} \\right)\\bigg|_{x_0} + \\frac{d^2 V_{\\mathrm{sub}}}{dx^2}\\bigg|_{x_0} = k_{\\mathrm{c}} + k_{\\mathrm{sub}}\n$$\nThis matches the expression provided. The linearized equation of motion for a displacement $u=x-x_0$ is $m\\ddot{u} = -k_{\\mathrm{eff}} u$. As this is a single-degree-of-freedom system, its only angular frequency is the highest frequency:\n$$\n\\omega_{\\max}^{\\mathrm{(PT)}} = \\sqrt{\\frac{k_{\\mathrm{eff}}}{m}} = \\sqrt{\\frac{k_{\\mathrm{c}} + k_{\\mathrm{sub}}}{m}}\n$$\n\n**Frenkel-Kontorova (FK) Model**\n\nThe FK model describes a chain of particles of mass $m$ coupled by springs of stiffness $k$ on a periodic substrate. The linearized equations of motion for the displacement $u_i$ of the $i$-th particle are given as:\n$$\nm \\ddot{u}_{i} = -k_{\\mathrm{sub}} u_{i} - k(2 u_{i} - u_{i-1} - u_{i+1})\n$$\nWe seek traveling wave solutions (normal modes) of the form $u_i(t) = A e^{\\mathrm{i}(qai - \\omega t)}$, where $q$ is the wavevector and the lattice spacing is here denoted by $a$ (not to be confused with substrate period, although often they are related). For simplicity, we can set the lattice spacing to $1$ in the index, leading to $u_i(t) = A e^{\\mathrm{i}(qi - \\omega t)}$. Substituting this ansatz into the equation of motion:\n$$\nm (-\\omega^2) e^{\\mathrm{i}(qi - \\omega t)} = -k_{\\mathrm{sub}} e^{\\mathrm{i}(qi - \\omega t)} - k(2 e^{\\mathrm{i}(qi - \\omega t)} - e^{\\mathrm{i}(q(i-1) - \\omega t)} - e^{\\mathrm{i}(q(i+1) - \\omega t)})\n$$\nDividing by the common factor $A e^{\\mathrm{i}(qi - \\omega t)}$ yields:\n$$\n-m\\omega^2 = -k_{\\mathrm{sub}} - k(2 - e^{-\\mathrm{i}q} - e^{\\mathrm{i}q})\n$$\nUsing the identity $e^{\\mathrm{i}q} + e^{-\\mathrm{i}q} = 2\\cos q$, we get:\n$$\nm\\omega^2 = k_{\\mathrm{sub}} + k(2 - 2\\cos q) = k_{\\mathrm{sub}} + 2k(1 - \\cos q)\n$$\nThis gives the phonon dispersion relation for the FK chain:\n$$\n\\omega^2(q) = \\frac{k_{\\mathrm{sub}}}{m} + \\frac{2k}{m}(1 - \\cos q)\n$$\nTo find the maximum frequency $\\omega_{\\max}^{\\mathrm{(FK)}}$, we must maximize this function of $q$. The term $(1 - \\cos q)$ is maximal when $\\cos q = -1$, which occurs for $q = \\pi$ (at the edge of the first Brillouin zone). The maximum value of $(1 - \\cos q)$ is $1 - (-1) = 2$. Substituting this into the dispersion relation, we find the maximum squared frequency:\n$$\n(\\omega_{\\max}^{\\mathrm{(FK)}})^2 = \\frac{k_{\\mathrm{sub}}}{m} + \\frac{2k}{m}(2) = \\frac{k_{\\mathrm{sub}} + 4k}{m}\n$$\nTaking the square root gives the maximum angular frequency:\n$$\n\\omega_{\\max}^{\\mathrm{(FK)}} = \\sqrt{\\frac{k_{\\mathrm{sub}} + 4k}{m}}\n$$\nThis confirms the expression provided in the problem statement.\n\n**Stability Bound and the Role of the BAOAB Integrator**\n\nHaving derived $\\omega_{\\max}$ for both models, the critical timestep for linear stability is $h_{\\mathrm{crit}} = 2/\\omega_{\\max}$.\n\nThe BAOAB integrator is a specific splitting scheme for the Langevin equation $m\\ddot{\\mathbf{x}} = \\mathbf{F}(\\mathbf{x}) - m\\gamma\\dot{\\mathbf{x}} + \\mathbf{R}(t)$. The evolution is split into three parts:\nA: Position update (drift): $\\dot{\\mathbf{x}} = \\mathbf{p}/m$\nB: Conservative force update (kick): $\\dot{\\mathbf{p}} = \\mathbf{F}(\\mathbf{x})$\nO: Ornstein-Uhlenbeck (OU) process for momentum: $\\dot{\\mathbf{p}} = -m\\gamma\\dot{\\mathbf{x}} + \\mathbf{R}(t)$, which is $\\dot{\\mathbf{p}} = -\\gamma \\mathbf{p} + \\mathbf{R}(t)$.\n\nThe BAOAB sequence for a timestep $h$ is:\n1.  (B) Update momentum $\\mathbf{p}$ with force $\\mathbf{F}$ for a half step $h/2$.\n2.  (A) Update position $\\mathbf{x}$ with momentum $\\mathbf{p}$ for a half step $h/2$.\n3.  (O) Update momentum $\\mathbf{p}$ according to the exact analytical solution of the OU process over a full step $h$.\n4.  (A) Update position $\\mathbf{x}$ with the new momentum $\\mathbf{p}$ for a half step $h/2$.\n5.  (B) Update momentum $\\mathbf{p}$ with force $\\mathbf{F}$ for a final half step $h/2$.\n\nThe crucial observation is that the conservative part of the motion (steps B-A-A-B) is equivalent to a single Velocity Verlet step over the timestep $h$. The stability of this part is thus governed by the standard Verlet condition, $h \\omega_{\\max} \\le 2$. The thermal part (step O) is integrated *exactly* using the known analytical solution for the OU process. As the OU step introduces no numerical error or instability of its own, it does not impose any further restriction on the timestep $h$. Consequently, the linear stability of the entire BAOAB algorithm is determined solely by the stability of its underlying Velocity Verlet integrator for the conservative forces. The damping coefficient $\\gamma$ and temperature $T$ do not appear in the linear stability condition, although they are critical for accuracy and for correct sampling of the canonical ensemble.\n\nThe derived stability condition is a strict requirement for a *linearized* system. For the full nonlinear models, nonlinear resonances can lead to instability even if $h  h_{\\mathrm{crit}}$. Therefore, in practical simulations, a safety factor is universally applied, and a timestep $h  h_{\\mathrm{crit}}/5$ or $h  h_{\\mathrm{crit}}/10$ is commonly chosen to ensure not only stability but also accuracy in resolving the fastest oscillatory dynamics. For the numerical task, we will compute precisely the theoretical bound $h_{\\mathrm{crit}} = 2/\\omega_{\\max}$.\n\nWe provided the derivation as required. Now we proceed to the calculation.", "answer": "[1.34149952877993077e-15,1.25883832881075677e-15,4.72147366361819381e-16,3.16227766016837923e-15,1.38531122659357497e-16]", "id": "2780006"}]}