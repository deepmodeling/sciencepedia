{"hands_on_practices": [{"introduction": "The Kelvin equation is a cornerstone of surface science, but true mastery requires understanding its thermodynamic and mechanical origins. This practice guides you through the fundamental derivation for a simple, symmetric geometry—a spherical cavity. By starting from the equality of chemical potentials and the Young-Laplace pressure relation, you will build the equation from the ground up, solidifying your grasp of the interplay between phase equilibrium and interfacial curvature [@problem_id:2794221].", "problem": "A spherical nanocavity of internal radius $r$ is embedded in an otherwise rigid solid and exposed to a reservoir of its own vapor at temperature $T$ and pressure $p$. The liquid perfectly wets the solid (zero Young contact angle), and a static meniscus forms at capillary condensation. Assume the vapor behaves as an ideal gas, the liquid is incompressible over the relevant pressure range with molar volume $v_{\\ell}$, and the liquid-vapor interfacial tension is $\\gamma$. The universal gas constant is $R$.\n\nStarting only from the equality of chemical potentials at phase equilibrium and mechanical equilibrium across a static curved interface, and adopting the sign convention that a principal radius of curvature is positive when its center of curvature lies on the vapor side, do the following:\n\n1) By symmetry and the perfect-wetting condition, determine the signed sum of the principal curvatures $1/R_{1} + 1/R_{2}$ of the meniscus inside the spherical cavity.\n\n2) Use this curvature to derive a closed-form expression for $\\ln\\!\\big(p/p_{\\mathrm{sat}}\\big)$, where $p_{\\mathrm{sat}}$ is the saturation pressure of the flat interface at the same temperature $T$.\n\nExpress your final answer as a single analytic expression in terms of $r$, $\\gamma$, $v_{\\ell}$, $R$, and $T$. Do not include units in the final answer box.", "solution": "The problem requires the derivation of the Kelvin equation for capillary condensation inside a spherical cavity, starting from fundamental principles. The validation of the problem statement confirms that it is scientifically grounded, well-posed, and contains sufficient information for a unique solution under a standard physical approximation.\n\nThe solution proceeds in two parts as requested. First, we determine the curvature of the liquid-vapor meniscus. Second, we use this result along with principles of thermodynamic and mechanical equilibrium to derive the expression for $\\ln(p/p_{\\text{sat}})$.\n\nPart 1: Determination of the Meniscus Curvature\n\nThe equilibrium state is governed by two conditions: mechanical equilibrium across the liquid-vapor interface and phase equilibrium between the liquid and vapor.\n\nBy the spherical symmetry of the cavity of radius $r$, any stable, static meniscus formed inside must also be spherical to minimize surface energy for a given volume. A spherical surface is characterized by two equal principal radii of curvature, $R_{1}$ and $R_{2}$. Let $R_{1} = R_{2} = R_{m}$, where $R_{m}$ is the radius of the meniscus.\n\nThe problem describes capillary condensation, where vapor condenses into a liquid that wets the cavity walls. The liquid therefore forms a film lining the solid surface, and the vapor occupies the central core. The meniscus is the interface between the liquid and the vapor.\n\nThe condition of perfect wetting (zero Young contact angle) implies that the liquid spreads completely over the solid surface. In the context of pore condensation, this is conventionally interpreted to mean that the characteristic radius of curvature of the meniscus is dictated by the pore geometry itself. For a spherical cavity of radius $r$, the meniscus is thus a concentric sphere of radius $r$. Therefore, we have $R_{m} = r$.\n\nNext, we must establish the sign of the radii of curvature. The problem provides the sign convention: a radius of curvature is positive if its center of curvature lies on the vapor side. In our system, the liquid lines the cavity wall, and the vapor forms a core at the center. The center of the spherical meniscus, which is also the center of the cavity, is located within the vapor phase. Consequently, according to the given convention, the principal radii are positive: $R_{1} = +r$ and $R_{2} = +r$.\n\nThe signed sum of the principal curvatures is therefore:\n$$\n\\frac{1}{R_{1}} + \\frac{1}{R_{2}} = \\frac{1}{r} + \\frac{1}{r} = \\frac{2}{r}\n$$\n\nPart 2: Derivation of the expression for $\\ln(p/p_{\\mathrm{sat}})$\n\nWe begin with the condition for thermodynamic equilibrium between the liquid and vapor phases at temperature $T$: the chemical potentials must be equal.\n$$\n\\mu_{\\ell}(p_{\\ell}, T) = \\mu_{v}(p, T)\n$$\nwhere $p_{\\ell}$ is the pressure within the liquid phase and $p$ is the pressure of the vapor.\n\nFor a flat interface, equilibrium occurs at the saturation pressure $p_{\\mathrm{sat}}(T)$, where $\\mu_{\\ell}(p_{\\mathrm{sat}}, T) = \\mu_{v}(p_{\\mathrm{sat}}, T)$. We can express the chemical potentials at arbitrary pressures relative to this saturation state.\n\nFor the liquid, assumed to be incompressible with molar volume $v_{\\ell}$, the change in chemical potential with pressure is given by $d\\mu_{\\ell} = v_{\\ell} dP$. Integrating from $p_{\\mathrm{sat}}$ to $p_{\\ell}$ yields:\n$$\n\\mu_{\\ell}(p_{\\ell}, T) - \\mu_{\\ell}(p_{\\mathrm{sat}}, T) = \\int_{p_{\\mathrm{sat}}}^{p_{\\ell}} v_{\\ell} dP = v_{\\ell} (p_{\\ell} - p_{\\mathrm{sat}})\n$$\n\nFor the vapor, assumed to behave as an ideal gas, the chemical potential is $\\mu_{v}(p, T) = \\mu_{v}^{\\circ}(T) + RT \\ln(p)$. The change from the saturation state is:\n$$\n\\mu_{v}(p, T) - \\mu_{v}(p_{\\mathrm{sat}}, T) = RT \\ln(p) - RT \\ln(p_{\\mathrm{sat}}) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\nSubstituting these expressions into the equilibrium condition $\\mu_{\\ell}(p_{\\ell}, T) = \\mu_{v}(p, T)$ and using the flat-interface equilibrium condition $\\mu_{\\ell}(p_{\\mathrm{sat}}, T) = \\mu_{v}(p_{\\mathrm{sat}}, T)$ to cancel terms, we obtain:\n$$\nv_{\\ell} (p_{\\ell} - p_{\\mathrm{sat}}) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\nThis equation connects the thermodynamic state of the system. We now introduce the condition of mechanical equilibrium. The pressure difference across the curved liquid-vapor interface is given by the Young-Laplace equation:\n$$\n\\Delta p = p - p_{\\ell} = \\gamma \\left(\\frac{1}{R_{1}} + \\frac{1}{R_{2}}\\right)\n$$\nThe pressure is higher on the concave side of the meniscus. Since the meniscus is concave toward the vapor core, the vapor pressure $p$ is higher than the liquid pressure $p_{\\ell}$. From Part 1, the sum of curvatures is $2/r$. Thus:\n$$\np - p_{\\ell} = \\gamma \\left(\\frac{2}{r}\\right) \\implies p_{\\ell} = p - \\frac{2\\gamma}{r}\n$$\nSubstituting this expression for $p_{\\ell}$ into the thermodynamic equilibrium equation gives:\n$$\nv_{\\ell} \\left( \\left(p - \\frac{2\\gamma}{r}\\right) - p_{\\mathrm{sat}} \\right) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\nThis equation is exact under the stated assumptions but is an implicit equation for the equilibrium pressure $p$. To obtain the requested closed-form expression for $\\ln(p/p_{\\text{sat}})$, a standard and physically justified approximation is necessary. For significant capillary effects in small pores, the pressure drop across the interface, $p-p_{\\ell}$, is typically much larger than the deviation of the vapor pressure from saturation, $p-p_{\\mathrm{sat}}$. We thus make the approximation $p \\approx p_{\\mathrm{sat}}$. With this, the term $p_{\\ell} - p_{\\mathrm{sat}}$ becomes:\n$$\np_{\\ell} - p_{\\mathrm{sat}} \\approx p_{\\ell} - p = -\\frac{2\\gamma}{r}\n$$\nSubstituting this approximation into the thermodynamic equilibrium relation $v_{\\ell} (p_{\\ell} - p_{\\mathrm{sat}}) = RT \\ln(p/p_{\\mathrm{sat}})$:\n$$\nv_{\\ell} \\left(-\\frac{2\\gamma}{r}\\right) = RT \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\nRearranging to solve for the desired quantity, we arrive at the Kelvin equation for a spherical cavity:\n$$\n\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right) = -\\frac{2\\gamma v_{\\ell}}{rRT}\n$$\nThis expression depends only on the given parameters $r$, $\\gamma$, $v_{\\ell}$, $R$, and $T$, as required. The negative sign correctly indicates that condensation occurs at a pressure $p$ below the bulk saturation pressure $p_{\\mathrm{sat}}$.", "answer": "$$\\boxed{-\\frac{2\\gamma v_{\\ell}}{rRT}}$$", "id": "2794221"}, {"introduction": "Beyond its fundamental form, the power of the Kelvin equation lies in its application to real materials and its ability to predict how system properties can be tuned. This exercise shifts focus to a cylindrical nanopore, a common model for porous materials, and asks you to quantify the system's sensitivity to surface wettability via the contact angle, $\\theta$. By deriving the sensitivity $\\frac{\\partial}{\\partial(\\cos\\theta)} \\ln(p/p_{\\mathrm{sat}})$, you will gain direct insight into how surface engineering strategies can be used to control capillary condensation [@problem_id:2794187].", "problem": "A cylindrical nanopore of radius $r_{p}$ is exposed to a condensable vapor at temperature $T$. A concave liquid meniscus spans the pore at equilibrium with a static contact angle $\\theta$ (measured through the liquid). Assume the following physically justified idealizations: (i) the vapor behaves as an ideal gas, (ii) the liquid is incompressible with molar volume $V_{m}$, (iii) gravity is negligible so the meniscus is a spherical surface with principal radii $R_{1}$ and $R_{2}$ determined by the pore geometry and $\\theta$, (iv) the pressure jump across the interface obeys the Young–Laplace relation $\\Delta p = \\gamma \\left( \\frac{1}{R_{1}} + \\frac{1}{R_{2}} \\right)$ with surface tension $\\gamma$, and (v) adsorbed film thickness and disjoining pressure effects can be neglected so that the meniscus meets the pore wall at $\\theta$ and its geometry is controlled solely by $r_{p}$ and $\\theta$.\n\nStarting only from equality of chemical potentials at isothermal phase equilibrium and the Young–Laplace relation, derive an explicit closed-form expression for the sensitivity\n$$\n\\frac{\\partial}{\\partial(\\cos\\theta)} \\ln\\!\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right),\n$$\nwhere $p$ is the equilibrium vapor pressure over the curved meniscus inside the pore and $p_{\\mathrm{sat}}$ is the saturation pressure over a planar interface at the same $T$. Express your result entirely in terms of $\\gamma$, $V_{m}$, $r_{p}$, $R$, and $T$, where $R$ is the universal gas constant. Then, briefly interpret the sign and parametric scaling of the sensitivity in the context of how surface functionalization that changes $\\theta$ can be used to tune capillary condensation in nanoporous solids.\n\nYour final reported answer must be a single closed-form analytic expression for the sensitivity. Do not provide any numerical evaluation. Do not include units in your final boxed answer.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim:\n- A cylindrical nanopore of radius $r_{p}$.\n- A condensable vapor at temperature $T$.\n- A concave liquid meniscus with a static contact angle $\\theta$.\n- Idealization (i): Vapor is an ideal gas.\n- Idealization (ii): Liquid is incompressible with molar volume $V_{m}$.\n- Idealization (iii): Gravity is negligible; meniscus is a spherical surface with radii $R_{1}$ and $R_{2}$.\n- Idealization (iv): Young–Laplace relation: $\\Delta p = \\gamma \\left( \\frac{1}{R_{1}} + \\frac{1}{R_{2}} \\right)$, where $\\gamma$ is surface tension.\n- Idealization (v): Adsorbed films and disjoining pressure are neglected.\n- The objective is to derive an expression for the sensitivity $\\frac{\\partial}{\\partial(\\cos\\theta)} \\ln\\!\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)$.\n- $p$ is the equilibrium vapor pressure over the curved meniscus.\n- $p_{\\mathrm{sat}}$ is the saturation pressure over a planar interface.\n- The result must be in terms of $\\gamma$, $V_{m}$, $r_{p}$, $R$ (universal gas constant), and $T$.\n\nValidation verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in physical chemistry and surface science, based on fundamental principles of thermodynamics (equality of chemical potentials) and fluid mechanics (Young-Laplace equation). The provided idealizations are standard and appropriate for deriving the Kelvin equation in this context. The problem is self-contained and free of contradictions, vagueness, or pseudoscientific claims. Therefore, the problem is declared **valid**. A solution will be provided.\n\nThe fundamental condition for phase equilibrium between the liquid and vapor phases at constant temperature $T$ is the equality of their chemical potentials, $\\mu$:\n$$\n\\mu_{l}(T, p_{l}) = \\mu_{v}(T, p)\n$$\nwhere $p_{l}$ is the pressure within the liquid phase and $p$ is the pressure of the vapor phase in the nanopore.\n\nThe reference state for both phases is the state of saturation over a planar interface, where the pressure is $p_{\\mathrm{sat}}$ in both phases (by definition) and the chemical potentials are equal: $\\mu_{l}(T, p_{\\mathrm{sat}}) = \\mu_{v}(T, p_{\\mathrm{sat}})$.\n\nFor an incompressible liquid (idealization ii), the change in chemical potential with pressure is given by the differential relation $\\mathrm{d}\\mu_{l} = V_{m}\\mathrm{d}p_{l}$. Integrating from the reference pressure $p_{\\mathrm{sat}}$ to the liquid pressure $p_{l}$ yields:\n$$\n\\mu_{l}(T, p_{l}) - \\mu_{l}(T, p_{\\mathrm{sat}}) = \\int_{p_{\\mathrm{sat}}}^{p_{l}} V_{m} \\mathrm{d}p' = V_{m}(p_{l} - p_{\\mathrm{sat}})\n$$\n\nFor the vapor, behaving as an ideal gas (idealization i), the molar volume is $V_{m,v} = \\frac{RT}{p}$, where $R$ is the universal gas constant. The change in chemical potential with pressure is $\\mathrm{d}\\mu_{v} = V_{m,v}\\mathrm{d}p = \\frac{RT}{p}\\mathrm{d}p$. Integrating from the reference pressure $p_{\\mathrm{sat}}$ to the vapor pressure $p$ gives:\n$$\n\\mu_{v}(T, p) - \\mu_{v}(T, p_{\\mathrm{sat}}) = \\int_{p_{\\mathrm{sat}}}^{p} \\frac{RT}{p'} \\mathrm{d}p' = RT\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\n\nBy substituting these expressions into the equilibrium condition $\\mu_{l}(T, p_{l}) - \\mu_{l}(T, p_{\\mathrm{sat}}) = \\mu_{v}(T, p) - \\mu_{v}(T, p_{\\mathrm{sat}})$, we obtain the general thermodynamic relationship:\n$$\nV_{m}(p_{l} - p_{\\mathrm{sat}}) = RT\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\nThe pressure difference across the curved liquid-vapor interface, $p - p_{l}$, is given by the Young-Laplace equation (idealization iv). For a concave meniscus, the center of curvature is in the vapor phase, meaning the vapor pressure $p$ is higher than the liquid pressure $p_{l}$. The pressure jump is $\\Delta p = p - p_{l}$.\nThe problem states the meniscus is a spherical surface, so its principal radii of curvature are equal, $R_{1} = R_{2} = r_{m}$, where $r_{m}$ is the radius of the meniscus. The Young-Laplace equation becomes:\n$$\n\\Delta p = p - p_{l} = \\gamma \\left(\\frac{1}{r_{m}} + \\frac{1}{r_{m}}\\right) = \\frac{2\\gamma}{r_{m}}\n$$\nFrom this, we express the liquid pressure as $p_{l} = p - \\frac{2\\gamma}{r_{m}}$. Substituting this into the thermodynamic relation:\n$$\nV_{m}\\left(p - \\frac{2\\gamma}{r_{m}} - p_{\\mathrm{sat}}\\right) = RT\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right)\n$$\nThis is an implicit equation. For capillary condensation, the deviation of the vapor pressure $p$ from $p_{\\mathrm{sat}}$ is small, while the pressure drop in the liquid, $\\Delta p$, can be large. Thus, we can make the standard and accurate approximation $p_{l} - p_{\\mathrm{sat}} \\approx p_{l} - p = -\\Delta p = -\\frac{2\\gamma}{r_{m}}$. This simplifies the thermodynamic relation to the Kelvin equation:\n$$\nRT\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right) = -V_{m} \\frac{2\\gamma}{r_{m}}\n$$\nNext, we relate the meniscus radius $r_{m}$ to the pore geometry. For a cylindrical pore of radius $r_{p}$ and a meniscus with contact angle $\\theta$ (measured through the liquid), simple geometric construction shows that $r_{p} = r_{m} \\cos\\theta$. Therefore, the radius of the meniscus is $r_{m} = \\frac{r_{p}}{\\cos\\theta}$. This is valid for a wetting liquid where $\\theta < \\frac{\\pi}{2}$ and the meniscus is concave.\n\nSubstituting this expression for $r_{m}$ into the Kelvin equation gives:\n$$\n\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right) = -\\frac{2 \\gamma V_{m}}{RT} \\frac{1}{r_{m}} = -\\frac{2 \\gamma V_{m}}{RT} \\frac{\\cos\\theta}{r_{p}}\n$$\nWe are asked to find the sensitivity, which is the partial derivative of this expression with respect to $\\cos\\theta$. We treat all other parameters ($\\gamma$, $V_{m}$, $r_{p}$, $R$, $T$) as constants for this differentiation.\nLet $x = \\cos\\theta$. The expression is:\n$$\n\\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right) = -\\left(\\frac{2 \\gamma V_{m}}{r_{p} R T}\\right) x\n$$\nThe derivative is:\n$$\n\\frac{\\partial}{\\partial(\\cos\\theta)} \\ln\\left(\\frac{p}{p_{\\mathrm{sat}}}\\right) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[ -\\left(\\frac{2 \\gamma V_{m}}{r_{p} R T}\\right) x \\right] = -\\frac{2 \\gamma V_{m}}{r_{p} R T}\n$$\nThis is the final expression for the sensitivity.\n\nInterpretation:\nThe sensitivity, $-\\frac{2 \\gamma V_{m}}{r_{p} R T}$, is negative, as all quantities ($\\gamma, V_{m}, r_{p}, R, T$) are intrinsically positive.\n- A negative sign implies that as $\\cos\\theta$ increases (i.e., as the contact angle $\\theta$ decreases, making the surface more wetting), the value of $\\ln(p/p_{\\mathrm{sat}})$ decreases. This means capillary condensation occurs at a lower relative pressure $p/p_{\\mathrm{sat}}$. Therefore, functionalizing a surface to be more hydrophilic (more wetting to water) enhances its ability to induce condensation.\n- The magnitude of the sensitivity scales as $\\frac{\\gamma V_{m}}{r_{p} T}$. This shows that the ability to tune condensation pressure by altering surface wettability is most pronounced for fluids with high surface tension $\\gamma$ and large molar volume $V_{m}$ (though $V_{m}$ is typically for the incompressible liquid phase and does not vary much), in smaller pores (small $r_{p}$), and at lower temperatures (small $T$). The inverse dependence on $r_{p}$ highlights that this tuning mechanism is particularly effective at the nanoscale.", "answer": "$$\\boxed{-\\frac{2 \\gamma V_{m}}{r_{p} R T}}$$", "id": "2794187"}, {"introduction": "Real-world porous materials are complex networks of interconnected pores and throats, where collective phenomena emerge from local rules. This capstone exercise challenges you to scale up your understanding from a single pore to a full pore network model. You will first derive the local condensation condition from fundamental principles and then translate this physics into a graph-based algorithm to simulate adsorption, providing a powerful example of how theoretical concepts are transformed into predictive computational tools [@problem_id:2794160].", "problem": "You are given a physical modeling task in the domain of nanomechanics and surface and interface science. The task is to derive and implement a graph-based adsorption simulation that determines which pores in a porous network will be filled with liquid at a given vapor activity based on fundamental thermodynamic and capillarity principles. In your implementation, pores are represented as nodes, pore throats as edges, and condensation is controlled by local curvature conditions at both nodes and edges. Your program must compute the number of liquid-filled nodes for each provided test case and return the results in the specified output format.\n\nYour derivation must start only from fundamental bases suitable to this topic:\n- Equality of chemical potentials at equilibrium between phases.\n- Ideal gas behavior for the vapor phase.\n- Incompressible liquid approximation with constant molar volume.\n- The Young–Laplace relation connecting pressure jump to mean curvature at a curved interface.\n\nYou must not use or quote any target formulas. Your derivation should logically connect the above base principles to a practical condition for capillary condensation set by interfacial curvature and geometry. From that, you must design a graph algorithm that enforces local filling constraints at both edges and nodes and allows global propagation from a reservoir.\n\nAlgorithmic requirements:\n- Model the porous medium as an undirected graph with node set $\\mathcal{V}$ and edge set $\\mathcal{E}$.\n- Each node $i \\in \\mathcal{V}$ has a spherical-cavity radius $r_i$ and a contact angle $\\theta_i$ (angles must be handled in degrees in the input and converted to radians for any trigonometric function).\n- Each edge $e = (i,j) \\in \\mathcal{E}$ has a cylindrical-throat radius $r_e$ and a contact angle $\\theta_e$ (also given in degrees).\n- Thermophysical inputs are surface tension $\\gamma$ in $\\mathrm{N/m}$, liquid molar volume $V_m$ in $\\mathrm{m^3/mol}$, absolute temperature $T$ in $\\mathrm{K}$, and the universal gas constant $R$ in $\\mathrm{J/(mol\\cdot K)}$.\n- The vapor activity is $a \\in (0,1]$ (dimensionless), equal to the ratio of vapor pressure to saturation pressure. Treat angles in degrees, vapor activity as dimensionless, and all radii in meters.\n\nFrom the fundamental bases, you must derive a local condensation threshold condition expressible via interfacial curvature for:\n- Nodes: a node $i$ can hold a liquid meniscus only when a derived node-specific threshold condition is met at the given $a$, $\\gamma$, $V_m$, $T$, $R$, $r_i$, and $\\theta_i$.\n- Edges: an edge $e$ can transmit liquid between two nodes only when a derived edge-specific threshold condition is met at the given $a$, $\\gamma$, $V_m$, $T$, $R$, $r_e$, and $\\theta_e$.\n\nGraph-based filling rule:\n- A designated set of reservoir nodes $\\mathcal{V}_\\mathrm{res} \\subseteq \\mathcal{V}$ is assumed to be in contact with bulk liquid and is considered liquid-filled regardless of their local node threshold.\n- Liquid filling can propagate from filled nodes to neighboring nodes only through edges that satisfy the edge threshold at the given $a$.\n- A node $j$ can become filled only if both the connecting edge from a currently filled neighbor satisfies its edge threshold and the node $j$ itself satisfies its node threshold at the given $a$.\n- This propagation repeats until no further nodes can be filled.\n\nUnits and angle convention:\n- All radii must be used in meters.\n- $\\gamma$ must be in $\\mathrm{N/m}$, $V_m$ in $\\mathrm{m^3/mol}$, $T$ in $\\mathrm{K}$, $R$ in $\\mathrm{J/(mol\\cdot K)}$, angles in degrees (converted to radians for trigonometric functions), and $a$ is dimensionless.\n- Your outputs must be integer counts of filled nodes for each test case.\n\nYour program must not read any input and must print the result for all test cases in one line. The final output format must be a single line containing a Python list with the results for each test case in order, for example: \"[2,3,1]\".\n\nTest Suite:\nUse the following three test cases. For each, all numerical values are provided in SI units where applicable, and angles are in degrees. The universal gas constant is $R = 8.314462618$.\n\n1) Happy-path chain network:\n- Thermophysical parameters: $\\gamma = 0.0728$ in $\\mathrm{N/m}$, $V_m = 1.8 \\times 10^{-5}$ in $\\mathrm{m^3/mol}$, $T = 298.15$ in $\\mathrm{K}$, $R = 8.314462618$ in $\\mathrm{J/(mol\\cdot K)}$, vapor activity $a = 0.95$ (dimensionless).\n- Graph: nodes $\\{0,1,2\\}$, reservoir nodes $\\{0\\}$.\n- Node properties: radii $[1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}]$ in $\\mathrm{m}$, contact angles $[0.0, 0.0, 0.0]$ in degrees.\n- Edge list with properties: edges $(0,1)$ and $(1,2)$, each with radius $1.0 \\times 10^{-8}$ in $\\mathrm{m}$ and contact angle $0.0$ in degrees.\n\n2) Hydrophobic blockage (edge and node thresholds exceed saturation):\n- Thermophysical parameters: $\\gamma = 0.0728$ in $\\mathrm{N/m}$, $V_m = 1.8 \\times 10^{-5}$ in $\\mathrm{m^3/mol}$, $T = 298.15$ in $\\mathrm{K}$, $R = 8.314462618$ in $\\mathrm{J/(mol\\cdot K)}$, vapor activity $a = 0.999$ (dimensionless).\n- Graph: nodes $\\{0,1,2\\}$, reservoir nodes $\\{0\\}$.\n- Node properties: radii $[1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}, 1.0 \\times 10^{-8}]$ in $\\mathrm{m}$, contact angles $[120.0, 120.0, 120.0]$ in degrees.\n- Edge list with properties: edges $(0,1)$ and $(1,2)$, each with radius $1.0 \\times 10^{-8}$ in $\\mathrm{m}$ and contact angle $120.0$ in degrees.\n\n3) Heterogeneous star network (ink-bottle-like contrast):\n- Thermophysical parameters: $\\gamma = 0.0728$ in $\\mathrm{N/m}$, $V_m = 1.8 \\times 10^{-5}$ in $\\mathrm{m^3/mol}$, $T = 298.15$ in $\\mathrm{K}$, $R = 8.314462618$ in $\\mathrm{J/(mol\\cdot K)}$, vapor activity $a = 0.93$ (dimensionless).\n- Graph: nodes $\\{0,1,2,3\\}$, reservoir nodes $\\{0\\}$.\n- Node properties: radii $[1.0 \\times 10^{-8}, 5.0 \\times 10^{-9}, 2.0 \\times 10^{-8}, 5.0 \\times 10^{-8}]$ in $\\mathrm{m}$, contact angles $[0.0, 0.0, 0.0, 0.0]$ in degrees.\n- Edge list with properties: edges $(0,1)$ with radius $5.0 \\times 10^{-9}$ in $\\mathrm{m}$ and contact angle $0.0$ in degrees, $(0,2)$ with radius $2.0 \\times 10^{-8}$ in $\\mathrm{m}$ and contact angle $0.0$ in degrees, $(0,3)$ with radius $5.0 \\times 10^{-8}$ in $\\mathrm{m}$ and contact angle $0.0$ in degrees.\n\nYour program should compute the integer number of filled nodes after applying the propagation rule starting from the reservoir nodes for each test case. The final output must be a single line containing the three results as a comma-separated list enclosed in square brackets, e.g., \"[x,y,z]\". All computations must respect the units and angle convention stated above, and trigonometric functions must use radians internally.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It presents a standard but non-trivial exercise in the field of physical chemistry and computational materials science, specifically concerning capillary condensation in porous media. The requirement to derive the governing equations from fundamental principles before implementation is a valid pedagogical approach. I will now proceed with the formal derivation and the design of the required algorithm.\n\nThe core of the problem lies in determining the thermodynamic equilibrium condition for a liquid condensate inside a nanopore, which is in contact with its vapor phase at a given temperature $T$ and pressure $P_v$.\n\n**1. Derivation of the Thermodynamic Equilibrium Condition**\n\nWe begin from the statement of thermodynamic equilibrium between the liquid phase (subscript $l$) and the vapor phase (subscript $v$), where their chemical potentials must be equal:\n$$ \\mu_l(P_l, T) = \\mu_v(P_v, T) $$\nHere, $P_l$ is the pressure within the liquid phase, which is under a curved meniscus, and $P_v$ is the pressure of the surrounding vapor.\n\nThe reference state for both phases is the bulk equilibrium over a flat interface at the same temperature $T$. At this saturation condition, the pressure is the saturation pressure $P_{sat}(T)$, and the chemical potentials are equal: $\\mu_{l,sat}(P_{sat}, T) = \\mu_{v,sat}(P_{sat}, T)$.\n\nThe change in chemical potential for an incompressible liquid with molar volume $V_m$ upon a change in pressure from $P_{sat}$ to $P_l$ is given by the integration of the Gibbs-Duhem equation at constant temperature ($d\\mu = V_m dP$):\n$$ \\mu_l(P_l, T) - \\mu_{l,sat}(P_{sat}, T) = \\int_{P_{sat}}^{P_l} V_m dP = V_m (P_l - P_{sat}) $$\n\nFor the vapor, which is assumed to be an ideal gas, the chemical potential change from $P_{sat}$ to $P_v$ is:\n$$ \\mu_v(P_v, T) - \\mu_{v,sat}(P_{sat}, T) = \\int_{P_{sat}}^{P_v} \\frac{RT}{P} dP = RT \\ln\\left(\\frac{P_v}{P_{sat}}\\right) $$\nwhere $R$ is the universal gas constant.\n\nAt equilibrium ($\\mu_l = \\mu_v$), and knowing that the reference chemical potentials are equal ($\\mu_{l,sat} = \\mu_{v,sat}$), we can equate the expressions for the change in chemical potential:\n$$ V_m (P_l - P_{sat}) = RT \\ln\\left(\\frac{P_v}{P_{sat}}\\right) $$\n\nThe pressure difference across the curved liquid-vapor interface is described by the Young-Laplace equation:\n$$ P_v - P_l = \\Delta P = \\gamma \\kappa $$\nwhere $\\gamma$ is the surface tension and $\\kappa$ is the mean curvature of the interface. Conventionally, $\\kappa$ is positive for a meniscus that is concave from the vapor side (as in a wetting fluid).\n\nA standard and valid approximation in this context is to assume that the pressure difference in the liquid, $P_l - P_{sat}$, is dominated by the capillary pressure, i.e., $P_l - P_{sat} \\approx P_l - P_v$. This is reasonable because the deviation of the vapor pressure $P_v$ from the saturation pressure $P_{sat}$ is typically small compared to the large capillary pressures in nanopores. Thus, we substitute $P_l - P_v = -\\gamma \\kappa$ into the left side of our thermodynamic relation:\n$$ V_m (-\\gamma \\kappa) \\approx RT \\ln\\left(\\frac{P_v}{P_{sat}}\\right) $$\n\nDefining the vapor activity as $a = P_v / P_{sat}$, we arrive at the Kelvin equation:\n$$ \\ln(a) = -\\frac{\\gamma V_m \\kappa}{RT} $$\nThis equation relates the thermodynamic state (vapor activity $a$) to the geometry of the system (mean curvature $\\kappa$). Condensation is thermodynamically favorable when the free energy of the liquid state is lower than or equal to that of the vapor state, which corresponds to the condition:\n$$ \\ln(a) \\ge -\\frac{\\gamma V_m \\kappa}{RT} $$\nSince $a < 1$ for condensation below saturation, $\\ln(a)$ is negative. This inequality can be rearranged to define a critical curvature, $K_{crit}$, required for condensation at a given activity $a$:\n$$ \\kappa \\ge -\\frac{RT \\ln(a)}{\\gamma V_m} \\equiv K_{crit}(a) $$\n\n**2. Curvature Models for Pore Geometries**\n\nThe problem specifies two types of pore elements: spherical cavities (nodes) and cylindrical throats (edges). We must define the characteristic mean curvature $\\kappa$ for each.\n\nA consistent and widely used model for the mean curvature of a meniscus that is critical for fluid invasion into a pore is given by:\n$$ \\kappa = \\frac{2 \\cos\\theta}{r_{pore}} $$\nThis applies to a spherical meniscus pinned inside a cylindrical pore of radius $r_{pore}$, and can be reasonably extended to a spherical pore of radius $r_{pore}$. The term $\\cos\\theta$ correctly accounts for wettability: for a wetting fluid ($\\theta < 90^\\circ$), $\\cos\\theta > 0$ and $\\kappa > 0$, favoring condensation. For a non-wetting fluid ($\\theta > 90^\\circ$), $\\cos\\theta < 0$ and $\\kappa < 0$, which means condensation is not possible at $a < 1$ as the condition $\\kappa \\ge K_{crit} > 0$ can never be met.\n\nApplying this model to our system:\n-   For a **node** $i$ (spherical cavity) with radius $r_i$ and contact angle $\\theta_i$, the characteristic curvature is $\\kappa_i = \\frac{2\\cos\\theta_i}{r_i}$.\n-   For an **edge** $e$ (cylindrical throat) with radius $r_e$ and contact angle $\\theta_e$, the characteristic curvature is $\\kappa_e = \\frac{2\\cos\\theta_e}{r_e}$.\n\n**3. Condensation Thresholds and Simulation Algorithm**\n\nWith these definitions, we establish the specific conditions for filling:\n-   A non-reservoir node $i$ is considered \"fillable\" if its geometry supports the required curvature: $\\kappa_i \\ge K_{crit}(a)$.\n-   An edge $e$ is considered \"passable\" for liquid transport if its geometry supports the required curvature: $\\kappa_e \\ge K_{crit}(a)$.\n\nThe simulation proceeds according to the specified graph-based filling rule. The problem describes a propagation process starting from a set of reservoir nodes $\\mathcal{V}_\\mathrm{res}$, which are filled by definition. The process can be implemented using a breadth-first search (BFS) algorithm, which naturally models the layer-by-layer propagation of the liquid front.\n\nThe algorithm is as follows:\n1.  Compute the critical curvature $K_{crit} = -\\frac{RT \\ln(a)}{\\gamma V_m}$ from the given thermophysical parameters.\n2.  For each node $i$ not in $\\mathcal{V}_\\mathrm{res}$, determine if it is fillable by checking if $\\frac{2\\cos\\theta_i}{r_i} \\ge K_{crit}$. Angles $\\theta_i$ must be converted from degrees to radians.\n3.  For each edge $e$, determine if it is passable by checking if $\\frac{2\\cos\\theta_e}{r_e} \\ge K_{crit}$. Angles $\\theta_e$ must be converted from degrees to radians.\n4.  Initialize a set of filled nodes, `filled_nodes`, with the elements of $\\mathcal{V}_\\mathrm{res}$.\n5.  Initialize a queue, `frontier`, with the elements of $\\mathcal{V}_\\mathrm{res}$.\n6.  While the `frontier` is not empty:\n    a. Dequeue a node $u$.\n    b. For each neighbor $v$ of $u$:\n        i. If $v$ is not already in `filled_nodes`:\n        ii. Check if the edge $(u,v)$ is passable and node $v$ is fillable.\n        iii. If both conditions are met, add $v$ to `filled_nodes` and enqueue $v$ into the `frontier`.\n7.  The process terminates when the `frontier` becomes empty. The total number of filled nodes is the size of the final `filled_nodes` set.\nThis procedure correctly models the cooperative filling behavior of the pore network, where liquid invades accessible regions constrained by both local geometry and connectivity.", "answer": "```python\nimport numpy as np\nfrom collections import deque\n\ndef solve():\n    \"\"\"\n    Solves the capillary condensation problem for the three specified test cases.\n    \"\"\"\n    R = 8.314462618  # Universal gas constant in J/(mol·K)\n\n    # Define the three test cases as a list of dictionaries.\n    test_cases = [\n        {\n            # Case 1: Happy-path chain network\n            \"params\": {\"gamma\": 0.0728, \"Vm\": 1.8e-5, \"T\": 298.15, \"a\": 0.95},\n            \"graph\": {\n                \"num_nodes\": 3,\n                \"reservoir_nodes\": {0},\n                \"node_props\": { # (radius in m, contact angle in degrees)\n                    0: (1.0e-8, 0.0),\n                    1: (1.0e-8, 0.0),\n                    2: (1.0e-8, 0.0),\n                },\n                \"edge_props\": { # (u, v): (radius in m, contact angle in degrees)\n                    (0, 1): (1.0e-8, 0.0),\n                    (1, 2): (1.0e-8, 0.0),\n                }\n            }\n        },\n        {\n            # Case 2: Hydrophobic blockage\n            \"params\": {\"gamma\": 0.0728, \"Vm\": 1.8e-5, \"T\": 298.15, \"a\": 0.999},\n            \"graph\": {\n                \"num_nodes\": 3,\n                \"reservoir_nodes\": {0},\n                \"node_props\": {\n                    0: (1.0e-8, 120.0),\n                    1: (1.0e-8, 120.0),\n                    2: (1.0e-8, 120.0),\n                },\n                \"edge_props\": {\n                    (0, 1): (1.0e-8, 120.0),\n                    (1, 2): (1.0e-8, 120.0),\n                }\n            }\n        },\n        {\n            # Case 3: Heterogeneous star network\n            \"params\": {\"gamma\": 0.0728, \"Vm\": 1.8e-5, \"T\": 298.15, \"a\": 0.93},\n            \"graph\": {\n                \"num_nodes\": 4,\n                \"reservoir_nodes\": {0},\n                \"node_props\": {\n                    0: (1.0e-8, 0.0),\n                    1: (5.0e-9, 0.0),\n                    2: (2.0e-8, 0.0),\n                    3: (5.0e-8, 0.0),\n                },\n                \"edge_props\": {\n                    (0, 1): (5.0e-9, 0.0),\n                    (0, 2): (2.0e-8, 0.0),\n                    (0, 3): (5.0e-8, 0.0),\n                }\n            }\n        }\n    ]\n\n    def run_simulation(case_data, R_const):\n        \"\"\"\n        Runs the graph-based filling simulation for a single test case.\n        \"\"\"\n        params = case_data[\"params\"]\n        graph_data = case_data[\"graph\"]\n\n        # 1. Calculate critical curvature K_crit\n        gamma, Vm, T, a = params[\"gamma\"], params[\"Vm\"], params[\"T\"], params[\"a\"]\n        if a >= 1.0 or a <= 0.0:  # Avoid log(a) domain errors\n            K_crit = -np.inf if a >= 1.0 else np.inf\n        else:\n            K_crit = -(R_const * T * np.log(a)) / (gamma * Vm)\n\n        # 2. Build adjacency list and check thresholds for nodes and edges\n        num_nodes = graph_data[\"num_nodes\"]\n        adj = [[] for _ in range(num_nodes)]\n        is_node_fillable = {}\n        is_edge_passable = {}\n\n        # Check nodes\n        for i in range(num_nodes):\n            r_i, theta_i_deg = graph_data[\"node_props\"][i]\n            theta_i_rad = np.deg2rad(theta_i_deg)\n            # Handle potential division by zero and non-positive radii\n            if r_i <= 0 or np.cos(theta_i_rad) <= 0:\n                 kappa_i = -np.inf\n            else:\n                 kappa_i = (2 * np.cos(theta_i_rad)) / r_i\n            is_node_fillable[i] = (kappa_i >= K_crit)\n\n        # Check edges and build adjacency list\n        for (u, v), (r_e, theta_e_deg) in graph_data[\"edge_props\"].items():\n            adj[u].append(v)\n            adj[v].append(u)\n            theta_e_rad = np.deg2rad(theta_e_deg)\n            if r_e <= 0 or np.cos(theta_e_rad) <= 0:\n                kappa_e = -np.inf\n            else:\n                kappa_e = (2 * np.cos(theta_e_rad)) / r_e\n            \n            # Store passability for both directions\n            is_edge_passable[(u, v)] = (kappa_e >= K_crit)\n            is_edge_passable[(v, u)] = (kappa_e >= K_crit)\n\n        # 3. Run propagation algorithm (BFS)\n        reservoir_nodes = graph_data[\"reservoir_nodes\"]\n        filled_nodes = set(reservoir_nodes)\n        frontier = deque(reservoir_nodes)\n\n        while frontier:\n            u = frontier.popleft()\n            for v in adj[u]:\n                if v not in filled_nodes:\n                    # Check propagation conditions\n                    edge_passable = is_edge_passable.get((u, v), False)\n                    node_fillable = is_node_fillable.get(v, False)\n\n                    if edge_passable and node_fillable:\n                        filled_nodes.add(v)\n                        frontier.append(v)\n        \n        return len(filled_nodes)\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(case, R)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2794160"}]}