{"hands_on_practices": [{"introduction": "In surface science, a compact nomenclature known as Wood notation is used to classify the vast array of observed surface reconstructions. To move from this descriptive label to a quantitative physical model, one must be able to translate the notation into a precise mathematical description. This practice [@problem_id:2792154] guides you through the process of deriving the transformation matrix for a common reconstruction, allowing you to calculate fundamental geometric properties like the unit cell area and the number of atoms involved.", "problem": "An ideal face-centered cubic (fcc) crystal with cubic lattice parameter $a$ is cleaved to expose the $(111)$ surface. The $(111)$ surface of an fcc crystal forms a two-dimensional hexagonal (triangular) Bravais lattice with primitive vectors $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$ of equal length and mutual angle $60^{\\circ}$. A surface reconstruction is observed and indexed in Wood notation as $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ with respect to the $(1\\times 1)$ termination of the fcc$(111)$ surface.\n\nStarting only from core definitions of two-dimensional Bravais lattices, the meaning of Wood notation, and the fact that the area of a two-dimensional primitive cell transforms by the absolute value of the determinant under a linear change of basis, derive the following quantities:\n\n1. The ratio of the primitive-cell areas $A_{\\mathrm{recon}}/A_{1\\times 1}$ between the reconstructed $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ surface and the unreconstructed $(1\\times 1)$ surface.\n\n2. Assuming no creation or destruction of atoms in the topmost layer during reconstruction (no adatoms or vacancies and no intermixing with subsurface layers), the number $N_{\\mathrm{recon}}$ of substrate surface atoms contained within one primitive reconstructed unit cell.\n\nExpress your final answer as a two-component row vector $\\big(A_{\\mathrm{recon}}/A_{1\\times 1},\\,N_{\\mathrm{recon}}\\big)$ with no units. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution. It is a standard problem in surface crystallography. I will proceed with a rigorous derivation.\n\nThe problem requires the derivation of two quantities for a $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ reconstruction on an fcc$(111)$ surface: the ratio of primitive-cell areas, $A_{\\mathrm{recon}}/A_{1\\times 1}$, and the number of substrate atoms in the reconstructed primitive cell, $N_{\\mathrm{recon}}$.\n\nFirst, we establish the properties of the unreconstructed, or $(1\\times 1)$, surface. The problem states that the fcc$(111)$ surface forms a two-dimensional hexagonal Bravais lattice. Let the primitive vectors of this lattice be $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$. We are given that they have equal length, which we denote as $s = |\\mathbf{a}_{1}| = |\\mathbf{a}_{2}|$, and the angle between them is $\\theta = 60^{\\circ}$. The area of the primitive cell of this $(1\\times 1)$ surface, $A_{1\\times 1}$, is given by the magnitude of the cross product of its primitive vectors:\n$$A_{1\\times 1} = |\\mathbf{a}_{1} \\times \\mathbf{a}_{2}| = |\\mathbf{a}_{1}| |\\mathbf{a}_{2}| \\sin(\\theta) = s^2 \\sin(60^{\\circ}) = \\frac{\\sqrt{3}}{2}s^2$$\n\nNext, we analyze the reconstructed surface. The notation $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ specifies the relationship between the primitive vectors of the reconstructed lattice, $\\mathbf{b}_{1}$ and $\\mathbf{b}_{2}$, and the substrate lattice vectors, $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$. The relationship is a linear transformation, which can be expressed in matrix form:\n$$\n\\begin{pmatrix} \\mathbf{b}_{1} \\\\ \\mathbf{b}_{2} \\end{pmatrix} = M \\begin{pmatrix} \\mathbf{a}_{1} \\\\ \\mathbf{a}_{2} \\end{pmatrix} = \\begin{pmatrix} M_{11} & M_{12} \\\\ M_{21} & M_{22} \\end{pmatrix} \\begin{pmatrix} \\mathbf{a}_{1} \\\\ \\mathbf{a}_{2} \\end{pmatrix}\n$$\nwhere $M_{ij}$ are integers. The problem correctly states that the ratio of the areas of the primitive cells is given by the absolute value of the determinant of the transformation matrix $M$:\n$$ \\frac{A_{\\mathrm{recon}}}{A_{1\\times 1}} = |\\det(M)| $$\nOur task is to find the matrix $M$. We can accomplish this by establishing a Cartesian coordinate system. Let $\\mathbf{a}_{1}$ be aligned with the x-axis.\n$$ \\mathbf{a}_{1} = s(1, 0) $$\n$$ \\mathbf{a}_{2} = s(\\cos(60^{\\circ}), \\sin(60^{\\circ})) = s\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right) $$\n\nThe Wood notation $(\\sqrt{3}\\times\\sqrt{3})R30^{\\circ}$ implies that the new lattice vectors have lengths $|\\mathbf{b}_{i}| = \\sqrt{3}s$ and the lattice is rotated by $30^{\\circ}$. Let us find a vector in the new lattice by applying the scaling and rotation to one of the substrate vectors, for instance $\\mathbf{a}_{1}$. A vector $\\mathbf{v}$ in the reconstructed lattice is given by scaling $\\mathbf{a}_1$ by $\\sqrt{3}$ and rotating by $30^{\\circ}$:\n$$ \\mathbf{v} = R(30^{\\circ}) (\\sqrt{3}\\mathbf{a}_{1}) $$\nwhere $R(30^{\\circ})$ is the rotation matrix:\n$$ R(30^{\\circ}) = \\begin{pmatrix} \\cos(30^{\\circ}) & -\\sin(30^{\\circ}) \\\\ \\sin(30^{\\circ}) & \\cos(30^{\\circ}) \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix} $$\nApplying this transformation to $\\sqrt{3}\\mathbf{a}_{1} = (\\sqrt{3}s, 0)$:\n$$ \\mathbf{v} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\end{pmatrix} \\begin{pmatrix} \\sqrt{3}s \\\\ 0 \\end{pmatrix} = s \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix} $$\nSince $\\mathbf{v}$ is a vector of the reconstructed lattice, it must be an integer linear combination of the substrate primitive vectors, $\\mathbf{v} = M_{11}\\mathbf{a}_{1} + M_{12}\\mathbf{a}_{2}$. We solve for the integers $M_{11}$ and $M_{12}$:\n$$ s\\left(\\frac{3}{2}, \\frac{\\sqrt{3}}{2}\\right) = M_{11} s(1, 0) + M_{12} s\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right) = s\\left(M_{11} + \\frac{M_{12}}{2}, \\frac{M_{12}\\sqrt{3}}{2}\\right) $$\nEquating the components gives:\n- y-component: $\\frac{\\sqrt{3}}{2} = \\frac{M_{12}\\sqrt{3}}{2} \\implies M_{12} = 1$.\n- x-component: $\\frac{3}{2} = M_{11} + \\frac{1}{2} \\implies M_{11} = 1$.\nSo, one primitive vector of the reconstructed lattice can be chosen as $\\mathbf{b}_{1} = 1\\cdot\\mathbf{a}_{1} + 1\\cdot\\mathbf{a}_{2} = \\mathbf{a}_{1} + \\mathbf{a}_{2}$.\n\nTo find the second primitive vector $\\mathbf{b}_{2}$, we note that the reconstructed lattice also has hexagonal symmetry. Therefore, we can obtain $\\mathbf{b}_{2}$ by rotating $\\mathbf{b}_{1}$ by $60^{\\circ}$.\n$$ \\mathbf{b}_{2} = R(60^{\\circ})\\mathbf{b}_{1} = \\begin{pmatrix} \\cos(60^{\\circ}) & -\\sin(60^{\\circ}) \\\\ \\sin(60^{\\circ}) & \\cos(60^{\\circ}) \\end{pmatrix} \\begin{pmatrix} s\\frac{3}{2} \\\\ s\\frac{\\sqrt{3}}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} & -\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\frac{3s}{2} \\\\ \\frac{\\sqrt{3}s}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{3s}{4} - \\frac{3s}{4} \\\\ \\frac{3\\sqrt{3}s}{4} + \\frac{\\sqrt{3}s}{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\sqrt{3}s \\end{pmatrix} $$\nNow we express $\\mathbf{b}_{2}$ as a linear combination of $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$: $\\mathbf{b}_{2} = M_{21}\\mathbf{a}_{1} + M_{22}\\mathbf{a}_{2}$.\n$$ (0, \\sqrt{3}s) = M_{21} s(1, 0) + M_{22} s\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right) = s\\left(M_{21} + \\frac{M_{22}}{2}, \\frac{M_{22}\\sqrt{3}}{2}\\right) $$\nEquating components:\n- y-component: $\\sqrt{3} = \\frac{M_{22}\\sqrt{3}}{2} \\implies M_{22} = 2$.\n- x-component: $0 = M_{21} + \\frac{2}{2} \\implies M_{21} = -1$.\nSo, the second primitive vector is $\\mathbf{b}_{2} = -1\\cdot\\mathbf{a}_{1} + 2\\cdot\\mathbf{a}_{2} = -\\mathbf{a}_{1} + 2\\mathbf{a}_{2}$.\n\nThe transformation matrix $M$ is thus:\n$$ M = \\begin{pmatrix} 1 & 1 \\\\ -1 & 2 \\end{pmatrix} $$\nThe ratio of the primitive-cell areas is the absolute value of the determinant of $M$:\n$$ \\frac{A_{\\mathrm{recon}}}{A_{1\\times 1}} = |\\det(M)| = |(1)(2) - (1)(-1)| = |2+1| = 3 $$\nThis is the answer to the first part of the problem.\n\nFor the second part, we must find the number of substrate atoms, $N_{\\mathrm{recon}}$, within one primitive reconstructed unit cell. The problem specifies the condition of atom conservation in the surface layer (no adatoms, vacancies, or intermixing). This means the number density of atoms, $\\sigma$, is constant across the surface.\nThe $(1\\times 1)$ unit cell is primitive by definition, and its corresponding lattice is a Bravais lattice of substrate atoms. Therefore, the $(1\\times 1)$ primitive cell contains exactly one atom, $N_{1\\times 1} = 1$.\nThe atom number density is $\\sigma = \\frac{N_{1\\times 1}}{A_{1\\times 1}} = \\frac{1}{A_{1\\times 1}}$.\nThe number of atoms in the reconstructed cell is its area multiplied by this density:\n$$ N_{\\mathrm{recon}} = \\sigma \\times A_{\\mathrm{recon}} = \\left(\\frac{1}{A_{1\\times 1}}\\right) A_{\\mathrm{recon}} = \\frac{A_{\\mathrm{recon}}}{A_{1\\times 1}} $$\nFrom our previous result, this ratio is $3$.\n$$ N_{\\mathrm{recon}} = 3 $$\nTherefore, the reconstructed primitive cell contains $3$ substrate atoms.\n\nThe final answer is a two-component row vector comprising the area ratio and the number of atoms.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 3\n\\end{pmatrix}\n}\n$$", "id": "2792154"}, {"introduction": "While knowing the size and shape of a reconstructed unit cell is a crucial first step, the arrangement of atoms within that cell—the basis—determines the intensities of diffraction spots in an experiment like Low Energy Electron Diffraction (LEED). This exercise [@problem_id:2864379] delves into the kinematic theory of diffraction, challenging you to calculate the structure factor for a specific 'missing-row' reconstruction model. By doing so, you will learn to predict which diffraction features will appear, disappear, or change in intensity, a key skill for interpreting experimental data and validating structural models.", "problem": "A Low Energy Electron Diffraction (LEED) experiment is performed on a metal surface that undergoes a $(1\\times 2)$ missing-row reconstruction. Model the surface as a two-dimensional rectangular Bravais lattice with direct-lattice vectors $\\mathbf{a}_1=a_x\\,\\hat{\\mathbf{x}}$ and $\\mathbf{a}_2=a_y\\,\\hat{\\mathbf{y}}$ in the unreconstructed state. The reconstruction doubles the real-space periodicity along $\\hat{\\mathbf{y}}$, so the reconstructed direct-lattice vectors are $\\mathbf{a}_1'=a_x\\,\\hat{\\mathbf{x}}$ and $\\mathbf{a}_2'=2a_y\\,\\hat{\\mathbf{y}}$, with corresponding reconstructed reciprocal-lattice vectors $\\mathbf{b}_1'=(2\\pi/a_x)\\,\\hat{\\mathbf{x}}$ and $\\mathbf{b}_2'=(\\pi/a_y)\\,\\hat{\\mathbf{y}}$. In the simplest kinematic approximation (single scattering), the diffracted amplitude for an in-plane reciprocal vector $\\mathbf{G}=H\\,\\mathbf{b}_1'+K\\,\\mathbf{b}_2'$ is proportional to the in-plane structure factor\n$$\nF(H,K)=\\sum_{j} f_j\\,\\exp\\!\\big(i\\,\\mathbf{G}\\cdot\\mathbf{r}_j\\big),\n$$\nwhere $H$ and $K$ are integers indexing the reconstructed reciprocal lattice, $f_j$ is the effective scattering amplitude of site $j$, and $\\mathbf{r}_j$ are the in-plane atomic positions of the motif inside the reconstructed unit cell.\n\nAssume the following physically motivated motif for a $(1\\times 2)$ missing-row reconstruction: within the reconstructed unit cell there is one top-layer atom at $\\mathbf{r}_1=(0,0)$ with amplitude $f$, and one second-layer atom exposed in the missing-row trough at $\\mathbf{r}_2=(a_x/2,\\,a_y)$ with amplitude $\\alpha f\\,e^{i\\phi}$, where $0<\\alpha\\le 1$ accounts for attenuation and $\\phi$ is an energy-dependent phase shift. At the chosen electron energy, take $\\phi\\simeq 0$ and $\\alpha\\simeq 1$.\n\nUsing only the kinematic diffraction relation above and the geometry specified, predict the qualitative change in the LEED pattern upon reconstruction and determine which subset of half-order spots (i.e., spots with $K$ odd in the reconstructed indexing, located halfway between the integer-order spots along $\\mathbf{b}_2'$) will be systematically strong versus weak due to the structure factor interference.\n\nWhich option best describes the expected LEED changes and the relative strengths of half-order spots?\n\nA. New half-order spots appear along the doubling direction; among these, spots with $K$ odd and $H$ even are strong, while those with $K$ odd and $H$ odd are weak.\n\nB. New half-order spots appear along the doubling direction; among these, spots with $K$ odd and $H$ odd are strong, while those with $K$ odd and $H$ even are weak.\n\nC. No half-order spots appear; only the intensities of integer-order spots change due to surface relaxation.\n\nD. Half-order spots appear along the doubling direction and have comparable intensities irrespective of $H$ parity when $K$ is odd.", "solution": "The user wants me to validate the problem statement and, if it is valid, to solve it.\n\n### Step 1: Extract Givens\n- **System**: A metal surface undergoing a $(1\\times 2)$ missing-row reconstruction.\n- **Unreconstructed Lattice**: A two-dimensional rectangular Bravais lattice with direct-lattice vectors $\\mathbf{a}_1=a_x\\,\\hat{\\mathbf{x}}$ and $\\mathbf{a}_2=a_y\\,\\hat{\\mathbf{y}}$.\n- **Reconstructed Lattice**: Direct-lattice vectors $\\mathbf{a}_1'=a_x\\,\\hat{\\mathbf{x}}$ and $\\mathbf{a}_2'=2a_y\\,\\hat{\\mathbf{y}}$. Reciprocal-lattice vectors $\\mathbf{b}_1'=(2\\pi/a_x)\\,\\hat{\\mathbf{x}}$ and $\\mathbf{b}_2'=(\\pi/a_y)\\,\\hat{\\mathbf{y}}$.\n- **Reciprocal Vector for Diffraction**: $\\mathbf{G}=H\\,\\mathbf{b}_1'+K\\,\\mathbf{b}_2'$, where $H$ and $K$ are integers.\n- **Diffraction Model**: Kinematic approximation. Diffracted amplitude is proportional to the in-plane structure factor $F(H,K)$.\n- **Structure Factor Formula**: $F(H,K)=\\sum_{j} f_j\\,\\exp\\!\\big(i\\,\\mathbf{G}\\cdot\\mathbf{r}_j\\big)$.\n- **Motif in Reconstructed Unit Cell**:\n    - Atom 1: position $\\mathbf{r}_1=(0,0)$, scattering amplitude $f_1=f$.\n    - Atom 2: position $\\mathbf{r}_2=(a_x/2,\\,a_y)$, scattering amplitude $f_2=\\alpha f\\,e^{i\\phi}$.\n- **Approximations**: For the chosen electron energy, $\\phi\\simeq 0$ and $\\alpha\\simeq 1$.\n- **Question**: Predict the qualitative change in the Low Energy Electron Diffraction (LEED) pattern and determine which subset of half-order spots ($K$ is odd) will be systematically strong versus weak.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes a $(1\\times 2)$ reconstruction, a well-established phenomenon in surface science. It employs the kinematic theory of diffraction to calculate the LEED pattern, which is a standard, albeit simplified, theoretical framework. The relation between direct and reciprocal lattices for the specified reconstruction is correct. The given motif is a physically plausible model for a missing-row reconstruction on surfaces like fcc(110). The problem is scientifically sound.\n2.  **Well-Posed**: The problem provides all necessary information: the lattice vectors, the atomic positions within the unit cell, the scattering amplitudes, and the formula for the structure factor. The simplifying assumptions ($\\phi\\simeq 0$, $\\alpha\\simeq 1$) are explicitly stated, ensuring that a unique and unambiguous solution can be derived. The question is specific and answerable within the provided framework.\n3.  **Objective**: The problem is stated using precise, objective scientific language. There are no subjective or ambiguous terms.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and objective. It is a valid problem in condensed matter physics. I will proceed with the solution.\n\n### Derivation\nThe problem requires the calculation of the structure factor, $F(H,K)$, for the given reconstructed surface. The intensity of a diffracted beam corresponding to the reciprocal lattice vector $\\mathbf{G}=H\\,\\mathbf{b}_1'+K\\,\\mathbf{b}_2'$ is proportional to $|F(H,K)|^2$.\n\nThe structure factor is given by the sum over the atoms in the unit cell basis:\n$$\nF(H,K)=\\sum_{j} f_j\\,\\exp\\!\\big(i\\,\\mathbf{G}\\cdot\\mathbf{r}_j\\big)\n$$\nThe basis consists of two atoms:\n1.  Atom 1 at $\\mathbf{r}_1 = (0,0)$ with scattering amplitude $f_1=f$.\n2.  Atom 2 at $\\mathbf{r}_2 = (a_x/2, a_y)$ with scattering amplitude $f_2=\\alpha f e^{i\\phi}$.\n\nThe problem states to use the approximations $\\alpha\\simeq 1$ and $\\phi\\simeq 0$, so $f_2 \\simeq f$. The structure factor becomes:\n$$\nF(H,K) \\simeq f\\exp(i\\,\\mathbf{G}\\cdot\\mathbf{r}_1) + f\\exp(i\\,\\mathbf{G}\\cdot\\mathbf{r}_2)\n$$\nLet us compute the dot products $\\mathbf{G}\\cdot\\mathbf{r}_j$.\nThe reciprocal lattice vector is $\\mathbf{G} = H(2\\pi/a_x)\\hat{\\mathbf{x}} + K(\\pi/a_y)\\hat{\\mathbf{y}}$.\n\nFor atom 1, at $\\mathbf{r}_1=(0,0)$:\n$$\n\\mathbf{G}\\cdot\\mathbf{r}_1 = \\left( H\\frac{2\\pi}{a_x}\\hat{\\mathbf{x}} + K\\frac{\\pi}{a_y}\\hat{\\mathbf{y}} \\right) \\cdot (0\\hat{\\mathbf{x}}+0\\hat{\\mathbf{y}}) = 0\n$$\n\nFor atom 2, at $\\mathbf{r}_2=(a_x/2, a_y)$:\n$$\n\\mathbf{G}\\cdot\\mathbf{r}_2 = \\left( H\\frac{2\\pi}{a_x}\\hat{\\mathbf{x}} + K\\frac{\\pi}{a_y}\\hat{\\mathbf{y}} \\right) \\cdot \\left( \\frac{a_x}{2}\\hat{\\mathbf{x}} + a_y\\hat{\\mathbf{y}} \\right) = \\left(H\\frac{2\\pi}{a_x}\\right)\\left(\\frac{a_x}{2}\\right) + \\left(K\\frac{\\pi}{a_y}\\right)(a_y) = H\\pi + K\\pi = \\pi(H+K)\n$$\n\nSubstituting these into the structure factor expression:\n$$\nF(H,K) \\simeq f(1 + e^{i\\pi(H+K)})\n$$\nSince $H$ and $K$ are integers, the sum $H+K$ is also an integer. We analyze the value of $e^{i\\pi(H+K)}$:\n- If $H+K$ is an even integer, $H+K=2n$, then $e^{i\\pi(2n)} = \\cos(2n\\pi) + i\\sin(2n\\pi) = 1$.\n- If $H+K$ is an odd integer, $H+K=2n+1$, then $e^{i\\pi(2n+1)} = \\cos((2n+1)\\pi) + i\\sin((2n+1)\\pi) = -1$.\n\nThis leads to two cases for the structure factor and the corresponding intensity $I(H,K) \\propto |F(H,K)|^2$:\n\n1.  **$H+K$ is even**:\n    $F(H,K) \\simeq f(1+1) = 2f$.\n    $I(H,K) \\propto |2f|^2 = 4|f|^2$. These spots are **strong**. This occurs when $H$ and $K$ are both even, or when $H$ and $K$ are both odd.\n\n2.  **$H+K$ is odd**:\n    $F(H,K) \\simeq f(1-1) = 0$.\n    $I(H,K) \\propto 0$. These spots are systematically absent, or **weak**. This occurs when one of $H, K$ is even and the other is odd.\n\nThe question specifically asks about the \"half-order spots\". The reconstruction from a $(1\\times 1)$ to a $(1\\times 2)$ surface doubles the periodicity along the $\\mathbf{a}_2$ direction. In reciprocal space, this creates new diffraction spots located halfway between the original spots along the corresponding reciprocal direction. The original spots correspond to integer indices in the unreconstructed reciprocal lattice, which means they correspond to even integer values of $K$ in the reconstructed indexing scheme (since $\\mathbf{b}_2=2\\mathbf{b}_2'$). The new \"half-order\" spots are therefore those with an odd integer value for $K$.\n\nWe must analyze the intensity of spots for $K$ odd:\n- If $H$ is **odd**, then $H+K$ is (odd + odd) = even. In this case, $I(H,K)$ is **strong**.\n- If $H$ is **even**, then $H+K$ is (even + odd) = odd. In this case, $I(H,K)$ is **weak** (zero in this model).\n\nTherefore, for the half-order spots ($K$ is odd), those with an odd index $H$ are strong, while those with an even index $H$ are weak.\n\n### Option-by-Option Analysis\n\n**A. New half-order spots appear along the doubling direction; among these, spots with $K$ odd and $H$ even are strong, while those with $K$ odd and $H$ odd are weak.**\nThis statement is incorrect. Our derivation shows the opposite: for $K$ odd, spots with $H$ odd are strong and spots with $H$ even are weak.\n\n**B. New half-order spots appear along the doubling direction; among these, spots with $K$ odd and $H$ odd are strong, while those with $K$ odd and $H$ even are weak.**\nThis statement is correct. The $(1\\times 2)$ reconstruction introduces new half-order spots. Our analysis of the structure factor confirms that for $K$ odd, the spots with $H$ odd are strong, and those with $H$ even are weak due to destructive interference.\n\n**C. No half-order spots appear; only the intensities of integer-order spots change due to surface relaxation.**\nThis statement is incorrect. Any reconstruction that increases the size of the real-space unit cell must, by the principles of Fourier analysis, introduce new, more closely spaced spots in the diffraction pattern (reciprocal space). A $(1\\times 2)$ reconstruction necessarily creates half-order spots.\n\n**D. Half-order spots appear along the doubling direction and have comparable intensities irrespective of $H$ parity when $K$ is odd.**\nThis statement is incorrect. The presence of a basis of more than one atom within the unit cell introduces a structure factor that modulates the intensities of the diffraction spots. Our calculation shows a systematic dependence on the parity of $H$ (for odd $K$), leading to a clear \"strong vs. weak\" pattern, not comparable intensities.", "answer": "$$\\boxed{B}$$", "id": "2864379"}, {"introduction": "Modern computational methods, particularly Density Functional Theory (DFT), are indispensable for calculating the energetic and mechanical properties of surfaces. This practice [@problem_id:2792189] simulates a common research workflow where you will analyze DFT-generated data to extract the fundamental surface free energy $\\gamma$ and surface stress $\\Upsilon$. You will apply the Shuttleworth equation and confront the practical challenge of extrapolating results from finite-sized slab models to the macroscopic limit, a critical skill in computational surface science.", "problem": "You are given discrete datasets that emulate the output of a Density Functional Theory (DFT) calculation for a symmetric slab with two identical free surfaces under small imposed in-plane biaxial strain. The goal is to extract the surface free energy per surface $\\gamma$ and the surface stress per surface $\\Upsilon$ from the total excess energy per area versus strain data, while accounting for finite-size corrections due to slab thickness and two-surface coupling.\n\nFundamental base:\n- Consider a symmetric slab of thickness $t$ containing two identical surfaces, each with surface free energy $\\gamma(\\varepsilon)$ that depends on the in-plane strain $\\varepsilon$ (dimensionless). The total excess energy per area of the slab, denoted $\\mathcal{F}(\\varepsilon,t)$, is the slab total energy minus the bulk contribution, divided by the surface area. For small $\\varepsilon$, a well-tested assumption is that $\\mathcal{F}(\\varepsilon,t)$ admits a Taylor expansion in $\\varepsilon$,\n  $$\\mathcal{F}(\\varepsilon,t) \\approx \\alpha_0(t) + \\alpha_1 \\varepsilon + \\alpha_2(t)\\varepsilon^2,$$\n  where $\\alpha_0(t)$ is the zero-strain excess energy per area and $\\alpha_1$ is the linear coefficient in strain.\n- The Shuttleworth equation for surface mechanics states that surface stress $\\Upsilon$ is related to the strain dependence of the surface free energy. For a symmetric slab with two identical surfaces, the derivative of the total excess energy per area with respect to $\\varepsilon$ at $\\varepsilon=0$ equals $2\\Upsilon$,\n  $$\\left.\\frac{\\partial \\mathcal{F}}{\\partial \\varepsilon}\\right|_{\\varepsilon=0} = 2\\Upsilon.$$\n- For finite slab thickness $t$, two-surface coupling and other size effects modify the zero-strain intercept. A widely used leading-order continuum-elasticity correction assumes that the thickness dependence of $\\alpha_0(t)$ is dominated by a term proportional to $1/t$,\n  $$\\alpha_0(t) \\approx 2\\gamma + \\frac{c_0}{t},$$\n  where $c_0$ is a thickness-coupling coefficient. This scaling emerges when the interaction between the two surfaces is mediated by long-ranged elastic fields or incomplete bulk subtraction, and it decays as $t \\to \\infty$.\n\nData:\n- You are given four datasets, each at a specified thickness $t$ (in nanometers). In each dataset, the in-plane strain $\\varepsilon$ (dimensionless) and the total excess energy per area $\\mathcal{F}$ (in $\\mathrm{J/m^2}$) are listed as ordered pairs $(\\varepsilon,\\mathcal{F})$:\n  - Thickness $t = $ $1.5$ nm:\n    - $(-0.02, 2.878)$, $(-0.01, 2.8735)$, $(0.0, 2.9)$, $(0.01, 2.9575)$, $(0.02, 3.046)$.\n  - Thickness $t = $ $2.5$ nm:\n    - $(-0.02, 2.758)$, $(-0.01, 2.7235)$, $(0.0, 2.74)$, $(0.01, 2.8075)$, $(0.02, 2.926)$.\n  - Thickness $t = $ $5.0$ nm:\n    - $(-0.02, 2.738)$, $(-0.01, 2.6285)$, $(0.0, 2.62)$, $(0.01, 2.7125)$, $(0.02, 2.906)$.\n  - Thickness $t = $ $20.0$ nm:\n    - $(-0.02, 3.248)$, $(-0.01, 2.6885)$, $(0.0, 2.53)$, $(0.01, 2.7725)$, $(0.02, 3.416)$.\n\nTasks:\n- For each thickness $t$, fit the dataset $\\{(\\varepsilon_i,\\mathcal{F}_i)\\}$ to a quadratic function in $\\varepsilon$ of the form $\\mathcal{F}(\\varepsilon,t)\\approx \\alpha_0(t)+\\alpha_1 \\varepsilon + \\alpha_2(t)\\varepsilon^2$ using least squares. Extract $\\alpha_0(t)$ and $\\alpha_1$ from these fits. All symbols and numbers must be treated as mathematical quantities; strain is dimensionless, and energy per area is in $\\mathrm{J/m^2}$.\n- Using the set of $\\alpha_0(t)$ values, perform a linear regression of $\\alpha_0(t)$ versus $1/t$ to estimate the intercept and slope in the model $\\alpha_0(t) \\approx 2\\gamma + c_0/t$. From this regression, extract:\n  - $\\gamma$ in $\\mathrm{J/m^2}$ (equivalently $\\mathrm{N/m}$), obtained as half the intercept.\n  - $c_0$ in $\\mathrm{J/m^2\\cdot nm}$, obtained as the slope of $\\alpha_0$ versus $1/t$ when $t$ is expressed in nanometers.\n- Using the set of $\\alpha_1$ values from all thicknesses, estimate the surface stress $\\Upsilon$ (in $\\mathrm{N/m}$) as half the mean of the fitted $\\alpha_1$ values.\n- Provide a finite-size and two-surface coupling consistency check by computing the maximum absolute residual between the observed $\\alpha_0(t)$ and the fitted model $2\\gamma + c_0/t$ over all provided thicknesses. Output a boolean that is true if this maximum absolute residual is less than or equal to $10^{-10}$ $\\mathrm{J/m^2}$ and false otherwise.\n\nPhysical units and angle units:\n- Strain $\\varepsilon$ is dimensionless. Energy per area $\\mathcal{F}$ must be treated in $\\mathrm{J/m^2}$. Surface free energy $\\gamma$ must be expressed in $\\mathrm{J/m^2}$ (equivalently $\\mathrm{N/m}$). Surface stress $\\Upsilon$ must be expressed in $\\mathrm{N/m}$. The coefficient $c_0$ must be expressed in $\\mathrm{J/m^2 \\cdot nm}$. No angles appear in this problem.\n\nTest suite and required outputs:\n- Use the four datasets exactly as provided above. Your program must compute and output the following four results:\n  1. The extracted $\\gamma$ in $\\mathrm{J/m^2}$ as a float.\n  2. The extracted $\\Upsilon$ in $\\mathrm{N/m}$ as a float.\n  3. The extracted $c_0$ in $\\mathrm{J/m^2 \\cdot nm}$ as a float.\n  4. The boolean consistency check described above.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). The first three entries must be floats and the last entry must be a boolean. Do not print any additional text.\n\nScientific realism:\n- The derivation must rely only on the general small-strain expansion, the Shuttleworth relation for surface stress, and the leading-order $1/t$ finite-size correction for symmetric slabs. No other shortcut formulas or external data are permitted. All regressions must be performed from the provided datasets only, and all outputs must be expressed in the units specified above.", "solution": "The problem has been validated and is deemed valid. It is a well-posed, scientifically grounded problem in computational surface science that requires standard numerical analysis techniques. All data and conditions are provided, and there are no internal contradictions.\n\nThe objective is to determine the surface free energy $\\gamma$, the surface stress $\\Upsilon$, and a finite-size correction coefficient $c_0$ from provided datasets of total excess energy per area $\\mathcal{F}$ versus in-plane biaxial strain $\\varepsilon$ for a symmetric slab of varying thickness $t$. The analysis will proceed in a series of logical steps based on the physical models provided.\n\nThe theoretical foundation is comprised of three key relations:\n1.  A quadratic expansion of the total excess energy per area $\\mathcal{F}$ as a function of strain $\\varepsilon$ for a given thickness $t$:\n    $$ \\mathcal{F}(\\varepsilon,t) \\approx \\alpha_0(t) + \\alpha_1(t)\\varepsilon + \\alpha_2(t)\\varepsilon^2 $$\n    Here, the problem statement notation, $\\mathcal{F}(\\varepsilon,t) \\approx \\alpha_0(t) + \\alpha_1 \\varepsilon + \\alpha_2(t)\\varepsilon^2$, suggests $\\alpha_1$ may be constant. The problem's instruction to average the fitted $\\alpha_1$ values confirms this. Therefore, we fit for an $\\alpha_1(t)$ for each thickness and then compute their mean as the best estimate of the true, thickness-independent value. This is a standard procedure to improve statistical reliability.\n\n2.  The Shuttleworth equation, which relates the surface stress $\\Upsilon$ to the strain derivative of the surface energy. For a symmetric slab with two surfaces, this is given by:\n    $$ \\left.\\frac{\\partial \\mathcal{F}}{\\partial \\varepsilon}\\right|_{\\varepsilon=0} = 2\\Upsilon $$\n    From our quadratic model, the derivative at $\\varepsilon=0$ is $\\alpha_1(t)$. We will therefore estimate $2\\Upsilon$ as the mean of the fitted $\\alpha_1(t)$ values.\n\n3.  A leading-order finite-size correction model for the zero-strain excess energy per area $\\alpha_0(t)$:\n    $$ \\alpha_0(t) \\approx 2\\gamma + \\frac{c_0}{t} $$\n    This equation describes a linear relationship between $\\alpha_0(t)$ and the inverse thickness $1/t$. The intercept yields the energy of two independent surfaces, $2\\gamma$, and the slope yields the coupling coefficient $c_0$.\n\nThe methodical procedure is as follows:\n\n**Step 1: Quadratic Fitting of $\\mathcal{F}(\\varepsilon,t)$ Data**\nFor each of the four provided thicknesses $t$, we perform a least-squares polynomial regression to fit the data $\\{(\\varepsilon_i, \\mathcal{F}_i)\\}$ to the quadratic model $\\mathcal{F}(\\varepsilon) = p_2 \\varepsilon^2 + p_1 \\varepsilon + p_0$. This determines the coefficients $\\alpha_0(t) = p_0$, $\\alpha_1(t) = p_1$, and $\\alpha_2(t) = p_2$. The set of given data points $(x_i, y_i)$ are fitted by minimizing the sum of squared residuals $S = \\sum_{i} (y_i - (p_2 x_i^2 + p_1 x_i + p_0))^2$.\n\nThe data is provided for $t \\in \\{1.5, 2.5, 5.0, 20.0\\}$ nm.\nApplying a degree-$2$ polynomial least-squares fit for each thickness yields the following coefficients:\n\n-   For $t = 1.5$ nm: $\\alpha_0(1.5) = 2.89025$, $\\alpha_1(1.5) = 4.2$.\n-   For $t = 2.5$ nm: $\\alpha_0(2.5) = 2.73025$, $\\alpha_1(2.5) = 4.2$.\n-   For $t = 5.0$ nm: $\\alpha_0(5.0) = 2.61025$, $\\alpha_1(5.0) = 4.2$.\n-   For $t = 20.0$ nm: $\\alpha_0(20.0) = 2.52025$, $\\alpha_1(20.0) = 4.2$.\n\nAll units for $\\alpha_0(t)$ and $\\alpha_1(t)$ are $\\mathrm{J/m^2}$.\n\n**Step 2: Determination of Surface Stress $\\Upsilon$**\nThe coefficient $\\alpha_1$ is related to the surface stress per surface $\\Upsilon$ by $\\alpha_1 \\approx 2\\Upsilon$. We have a set of fitted values $\\{\\alpha_1(t)\\}$. The best estimate for the constant $\\alpha_1$ is the mean of these values.\n$$ \\bar{\\alpha}_1 = \\frac{1}{4} \\sum_{j=1}^{4} \\alpha_1(t_j) = \\frac{4.2 + 4.2 + 4.2 + 4.2}{4} = 4.2 \\, \\mathrm{J/m^2} $$\nThe surface stress is therefore:\n$$ \\Upsilon = \\frac{\\bar{\\alpha}_1}{2} = \\frac{4.2}{2} = 2.1 \\, \\mathrm{N/m} $$\nNote that the unit $\\mathrm{J/m^2}$ is equivalent to $\\mathrm{N/m}$.\n\n**Step 3: Linear Fitting for $\\gamma$ and $c_0$**\nWe now analyze the extracted zero-strain excess energies $\\alpha_0(t)$ as a function of inverse thickness $1/t$. The model is $\\alpha_0(t) = c_0 (1/t) + 2\\gamma$. This is a linear regression problem where the independent variable is $x = 1/t$ and the dependent variable is $y = \\alpha_0(t)$. We fit the model $y = mx+i$, where the slope is $m=c_0$ and the intercept is $i=2\\gamma$.\n\nThe data points for this linear fit are $(1/t_j, \\alpha_0(t_j))$:\n-   $(1/1.5, 2.89025) \\approx (0.6667, 2.89025)$\n-   $(1/2.5, 2.73025) = (0.4, 2.73025)$\n-   $(1/5.0, 2.61025) = (0.2, 2.61025)$\n-   $(1/20.0, 2.52025) = (0.05, 2.52025)$\n\nPerforming a linear least-squares fit on these points yields the slope $m$ and intercept $i$:\n-   Slope: $c_0 = 0.6 \\, \\mathrm{J/m^2 \\cdot nm}$\n-   Intercept: $2\\gamma = 2.49025 \\, \\mathrm{J/m^2}$\n\nFrom the intercept, we extract the surface free energy per surface $\\gamma$:\n$$ \\gamma = \\frac{2.49025}{2} = 1.245125 \\, \\mathrm{J/m^2} $$\n\n**Step 4: Consistency Check**\nThe final step is to verify the consistency of the finite-size correction model. We compute the maximum absolute residual between the observed $\\alpha_0(t)$ values from Step 1 and the values predicted by the linear fit from Step 3, $\\alpha_{0, \\text{fit}}(t) = 0.6/t + 2.49025$.\n\nThe residuals $R(t) = \\alpha_0(t) - \\alpha_{0, \\text{fit}}(t)$ are calculated:\n-   For $t=1.5$: $R(1.5) = 2.89025 - (0.6/1.5 + 2.49025) = 2.89025 - (0.4 + 2.49025) = 0.0$\n-   For $t=2.5$: $R(2.5) = 2.73025 - (0.6/2.5 + 2.49025) = 2.73025 - (0.24 + 2.49025) = 0.0$\n-   For $t=5.0$: $R(5.0) = 2.61025 - (0.6/5.0 + 2.49025) = 2.61025 - (0.12 + 2.49025) = 0.0$\n-   For $t=20.0$: $R(20.0) = 2.52025 - (0.6/20.0 + 2.49025) = 2.52025 - (0.03 + 2.49025) = 0.0$\n\nThe residuals are zero to within machine precision. The maximum absolute residual is effectively $0$, which is $\\le 10^{-10} \\, \\mathrm{J/m^2}$. The consistency check is satisfied.\n\n**Summary of Results:**\n-   Surface free energy: $\\gamma = 1.245125 \\, \\mathrm{J/m^2}$\n-   Surface stress: $\\Upsilon = 2.1 \\, \\mathrm{N/m}$\n-   Coupling coefficient: $c_0 = 0.6 \\, \\mathrm{J/m^2 \\cdot nm}$\n-   Consistency check: The maximum absolute residual is approximately $0.0$, which is $\\le 10^{-10}$. The boolean result is True.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of extracting surface properties from simulated slab data.\n    The method involves a two-stage least-squares fitting procedure.\n    \"\"\"\n\n    # Define the datasets from the problem statement.\n    # Each key is thickness t in nm, and the value is a list of (strain, energy) tuples.\n    # Strain is dimensionless, and energy per area is in J/m^2.\n    datasets = {\n        1.5: [(-0.02, 2.878), (-0.01, 2.8735), (0.0, 2.9), (0.01, 2.9575), (0.02, 3.046)],\n        2.5: [(-0.02, 2.758), (-0.01, 2.7235), (0.0, 2.74), (0.01, 2.8075), (0.02, 2.926)],\n        5.0: [(-0.02, 2.738), (-0.01, 2.6285), (0.0, 2.62), (0.01, 2.7125), (0.02, 2.906)],\n        20.0: [(-0.02, 3.248), (-0.01, 2.6885), (0.0, 2.53), (0.01, 2.7725), (0.02, 3.416)],\n    }\n\n    thicknesses = sorted(datasets.keys())\n    \n    alpha0_values = []\n    alpha1_values = []\n\n    # Step 1: For each thickness, perform a quadratic fit to get alpha_0(t) and alpha_1(t).\n    for t in thicknesses:\n        data = datasets[t]\n        # Unpack strain (epsilon) and energy (F) values\n        eps = np.array([point[0] for point in data])\n        F = np.array([point[1] for point in data])\n        \n        # Perform a least-squares fit to a quadratic polynomial: F = p2*eps^2 + p1*eps + p0\n        # coeffs[0] = p2 = alpha_2(t), coeffs[1] = p1 = alpha_1(t), coeffs[2] = p0 = alpha_0(t)\n        coeffs = np.polyfit(eps, F, 2)\n        \n        alpha0_values.append(coeffs[2]) # p0\n        alpha1_values.append(coeffs[1]) # p1\n\n    # Step 2: Estimate surface stress Upsilon from the mean of alpha_1 values.\n    # According to the Shuttleworth equation, 2*Upsilon = dF/deps|e=0 = alpha_1.\n    alpha1_mean = np.mean(alpha1_values)\n    Upsilon = alpha1_mean / 2.0\n\n    # Step 3: Perform linear regression of alpha_0(t) vs 1/t to get gamma and c_0.\n    # The model is alpha_0(t) = 2*gamma + c_0/t.\n    # This is a linear model y = m*x + i, with y=alpha_0, x=1/t, slope m=c_0, and intercept i=2*gamma.\n    inv_t = 1.0 / np.array(thicknesses)\n    alpha0_array = np.array(alpha0_values)\n    \n    # Perform linear fit\n    lin_coeffs = np.polyfit(inv_t, alpha0_array, 1)\n    \n    c0 = lin_coeffs[0]  # Slope\n    two_gamma = lin_coeffs[1] # Intercept\n    \n    gamma = two_gamma / 2.0\n\n    # Step 4: Perform the consistency check.\n    # Calculate the maximum absolute residual between observed alpha_0(t) and the fitted model.\n    predicted_alpha0 = np.polyval(lin_coeffs, inv_t)\n    residuals = alpha0_array - predicted_alpha0\n    max_abs_residual = np.max(np.abs(residuals))\n    \n    # Check if the residual is within the tolerance.\n    consistency_check = max_abs_residual <= 1e-10\n\n    # Collect results\n    results = [gamma, Upsilon, c0, consistency_check]\n\n    # Final print statement in the exact required format.\n    print(f\"[{results[0]},{results[1]},{results[2]},{str(results[3]).lower()}]\")\n\nsolve()\n```", "id": "2792189"}]}