{"hands_on_practices": [{"introduction": "Understanding the behavior of liquids on solid surfaces is fundamental to fields ranging from materials science to biology. This exercise bridges the gap between abstract thermodynamic concepts and measurable macroscopic properties by exploring the equilibrium of a sessile droplet. By applying a variational argument to the system's Gibbs free energy, you will derive the cornerstone relationship known as Young's equation, which elegantly connects the interfacial free energies, such as $\\gamma_{sl}$, to the observable contact angle $\\theta$ [@problem_id:2766395]. This practice is essential for mastering how to translate thermodynamic principles into practical mechanical equilibrium conditions at interfaces.", "problem": "A sessile droplet of a pure liquid rests on a rigid, chemically homogeneous solid in an inert, dry vapor at temperature $T$ and ambient pressure. The three coexisting interfaces are solid–vapor, solid–liquid, and liquid–vapor. Assume the system is isothermal and the droplet volume is fixed. Interfacial free energies are defined as reversible excess Gibbs free energies per unit area.\n\nStarting from fundamental definitions and the principle of minimum Gibbs free energy at fixed $T$ and droplet volume, consider a reversible, infinitesimal advance of the three-phase contact line that converts an area $dA$ of solid–vapor into solid–liquid while changing the liquid–vapor area accordingly. Use this variational argument to obtain the mechanical equilibrium condition at the contact line. Then, using a reversible thermodynamic cycle that separates a unit area of the solid–liquid interface into solid–vapor plus liquid–vapor interfaces, express the work of adhesion in terms of interfacial free energies, and combine your results to obtain an explicit expression for the solid–liquid interfacial free energy in terms of the solid–vapor interfacial free energy, the liquid–vapor interfacial free energy, and the equilibrium contact angle.\n\nFor a particular solid–liquid–vapor system at $T=298\\ \\mathrm{K}$, independent measurements give the following values:\n- solid–vapor interfacial free energy: $\\gamma_{sv} = 0.500\\ \\mathrm{J\\,m^{-2}}$,\n- liquid–vapor interfacial free energy: $\\gamma_{lv} = 0.07280\\ \\mathrm{J\\,m^{-2}}$,\n- equilibrium contact angle of the sessile droplet: $\\theta = 60.00^{\\circ}$ (angle in degrees).\n\nUsing your derived expression, compute the solid–liquid interfacial free energy $\\gamma_{sl}$ for this system. Express the final value in $\\mathrm{mJ\\,m^{-2}}$ and round your answer to four significant figures.", "solution": "The problem presented is a standard exercise in the thermodynamics of interfaces. It is scientifically grounded, well-posed, and contains all necessary information for a complete solution. We shall proceed with the derivation and calculation as requested.\n\nThe fundamental principle governing the equilibrium state of the system at constant temperature $T$, pressure $P$, and fixed droplet volume $V$ is the minimization of the total Gibbs free energy, $G$. For this three-phase system, the total Gibbs free energy includes contributions from the bulk phases and the interfaces. As the bulk properties are fixed, the equilibrium shape of the droplet is determined by the minimization of the total interfacial free energy, which is the sum of the free energies of the three interfaces: solid–liquid (sl), solid–vapor (sv), and liquid–vapor (lv).\n\nLet $A_{sl}$, $A_{sv}$, and $A_{lv}$ be the areas of the solid–liquid, solid–vapor, and liquid–vapor interfaces, respectively. Let $\\gamma_{sl}$, $\\gamma_{sv}$, and $\\gamma_{lv}$ be the corresponding interfacial free energies per unit area. The total interfacial Gibbs free energy is:\n$$G_{interface} = \\gamma_{sl} A_{sl} + \\gamma_{sv} A_{sv} + \\gamma_{lv} A_{lv}$$\nWe consider a reversible, infinitesimal advance of the three-phase contact line along the rigid solid substrate. Let this displacement be parameterized by a distance $d\\xi$. Let the total length of the contact line be $L$. This displacement converts an area $dA = Ld\\xi$ of the solid–vapor interface into a solid–liquid interface.\nThe change in the solid–liquid interface area is $dA_{sl} = Ld\\xi$.\nThe change in the solid–vapor interface area is $dA_{sv} = -Ld\\xi$.\nThe liquid is in contact with the solid at an angle $\\theta$, the equilibrium contact angle. The displacement of the contact line by $d\\xi$ results in a change in the liquid–vapor interface area. From the geometry of the contact line, this change is $dA_{lv} = (L \\cos\\theta) d\\xi$.\n\nThe differential change in the total interfacial Gibbs free energy, $dG_{interface}$, for this virtual displacement is:\n$$dG_{interface} = \\gamma_{sl} dA_{sl} + \\gamma_{sv} dA_{sv} + \\gamma_{lv} dA_{lv}$$\nSubstituting the expressions for the differential areas, we obtain:\n$$dG_{interface} = \\gamma_{sl} (Ld\\xi) + \\gamma_{sv} (-Ld\\xi) + \\gamma_{lv} (L d\\xi \\cos\\theta)$$\n$$dG_{interface} = (\\gamma_{sl} - \\gamma_{sv} + \\gamma_{lv} \\cos\\theta) Ld\\xi$$\nAt equilibrium, the total interfacial free energy must be at a minimum with respect to such variations. Therefore, $dG_{interface} = 0$ for any arbitrary non-zero displacement $d\\xi$. This requires the term in the parenthesis to be zero:\n$$\\gamma_{sl} - \\gamma_{sv} + \\gamma_{lv} \\cos\\theta = 0$$\nThis can be rearranged to give the mechanical equilibrium condition at the contact line, known as Young's equation:\n$$\\gamma_{sv} = \\gamma_{sl} + \\gamma_{lv} \\cos\\theta$$\nThis equation represents the balance of interfacial tensions projected onto the solid surface.\n\nNext, we define the work of adhesion, $W_{ad}$, which is the reversible work required per unit area to separate a solid–liquid interface, creating a solid–vapor and a liquid–vapor interface in its place. Consider a thermodynamic cycle for a unit area of interface.\nThe initial state is a solid–liquid interface of unit area. Its contribution to the Gibbs free energy is $G_{initial} = \\gamma_{sl} \\times 1$.\nThe final state consists of a solid–vapor interface of unit area and a liquid–vapor interface of unit area. The Gibbs free energy is $G_{final} = (\\gamma_{sv} \\times 1) + (\\gamma_{lv} \\times 1)$.\nThe work done on the system, which is the work of adhesion, is equal to the change in Gibbs free energy, $W_{ad} = \\Delta G = G_{final} - G_{initial}$.\nTherefore, the work of adhesion is given by the Dupré equation:\n$$W_{ad} = \\gamma_{sv} + \\gamma_{lv} - \\gamma_{sl}$$\nThe problem requires an explicit expression for the solid–liquid interfacial free energy, $\\gamma_{sl}$, in terms of $\\gamma_{sv}$, $\\gamma_{lv}$, and $\\theta$. Young's equation, which we derived as the first result, already provides this relationship directly upon rearrangement. The instruction to \"combine your results\" is somewhat superfluous, as Young's equation is the direct consequence of the variational argument and contains all the necessary terms. Simple algebraic manipulation of Young's equation yields the required expression:\n$$\\gamma_{sl} = \\gamma_{sv} - \\gamma_{lv} \\cos\\theta$$\nFor completeness, combining this with the Dupré equation yields the Young-Dupré equation for the work of adhesion: $W_{ad} = (\\gamma_{sl} + \\gamma_{lv} \\cos\\theta) + \\gamma_{lv} - \\gamma_{sl} = \\gamma_{lv}(1 + \\cos\\theta)$. This is a useful relation, but the expression for $\\gamma_{sl}$ itself is derived solely from Young's equation.\n\nFinally, we compute the numerical value for $\\gamma_{sl}$ using the provided data:\n- Solid–vapor interfacial free energy: $\\gamma_{sv} = 0.500\\ \\mathrm{J\\,m^{-2}}$\n- Liquid–vapor interfacial free energy: $\\gamma_{lv} = 0.07280\\ \\mathrm{J\\,m^{-2}}$\n- Equilibrium contact angle: $\\theta = 60.00^{\\circ}$\n\nFirst, we calculate the cosine of the angle. For $\\theta = 60.00^{\\circ}$, the cosine is $\\cos(60.00^{\\circ})$. The angle $60^{\\circ}$ is a fundamental angle whose cosine is exactly $0.5$. Given the precision, we will take $\\cos(60.00^{\\circ})$ as $0.5$ for the primary calculation.\n$$\\cos(60.00^{\\circ}) = 0.5$$\nNow, substitute the values into the derived expression for $\\gamma_{sl}$:\n$$\\gamma_{sl} = 0.500\\ \\mathrm{J\\,m^{-2}} - (0.07280\\ \\mathrm{J\\,m^{-2}}) \\times 0.5$$\n$$\\gamma_{sl} = 0.500\\ \\mathrm{J\\,m^{-2}} - 0.03640\\ \\mathrm{J\\,m^{-2}}$$\n$$\\gamma_{sl} = 0.4636\\ \\mathrm{J\\,m^{-2}}$$\nThe problem requires the final answer to be expressed in units of $\\mathrm{mJ\\,m^{-2}}$. The conversion is $1\\ \\mathrm{J} = 1000\\ \\mathrm{mJ}$.\n$$\\gamma_{sl} = 0.4636 \\times 1000\\ \\mathrm{mJ\\,m^{-2}} = 463.6\\ \\mathrm{mJ\\,m^{-2}}$$\nThe problem also mandates that the answer be rounded to four significant figures. The calculated value of $463.6$ already possesses exactly four significant figures. Therefore, no further rounding is required.", "answer": "$$\\boxed{463.6}$$", "id": "2766395"}, {"introduction": "While the sharp-interface model is a powerful starting point, a more refined physical picture describes an interface as a continuous transition region of finite width. This practice delves into the foundational Cahn-Hilliard phase-field theory, a cornerstone for modeling the mesoscopic structure of interfaces and phase transitions [@problem_id:2766408]. By minimizing a Landau-type free energy functional, you will not only derive the characteristic profile $\\phi(x)$ of an interface but also predict how its width $\\xi$ scales near a critical point, a key result in the theory of critical phenomena. This exercise provides invaluable experience with variational methods and the statistical mechanical origins of interfacial structure.", "problem": "Consider a one-component fluid that exhibits a liquid-vapor interface near its critical point, modeled by a single scalar order parameter $\\,\\phi(\\mathbf{r})\\,$ that distinguishes the coexisting bulk phases (e.g., the deviation of number density from its critical value). In a phase-field description, assume the Helmholtz free energy functional is of the square-gradient (Cahn–Hilliard) type\n$$\n\\mathcal{F}[\\phi]=\\int_{\\Omega}\\left[f(\\phi;T)+\\frac{\\kappa}{2}|\\nabla \\phi|^{2}\\right]\\mathrm{d}V,\n$$\nwith a Landau expansion of the homogeneous free energy density\n$$\nf(\\phi;T)=\\frac{a(T)}{2}\\phi^{2}+\\frac{b}{4}\\phi^{4},\n$$\nwhere $\\,b0\\,$ is temperature independent, $\\,a(T)=a_{0}(T-T_{c})\\,$ with $\\,a_{0}0\\,$, and $\\,T_{c}\\,$ is the critical temperature. Consider a one-dimensional planar equilibrium interface normal to $\\,x\\,$, at two-phase coexistence for $\\,TT_{c}\\,$, with boundary conditions $\\,\\phi(x\\to-\\infty)=-\\phi_{0}\\,$ and $\\,\\phi(x\\to+\\infty)=+\\phi_{0}\\,$, where $\\,\\phi_{0}\\,$ is the magnitude of the bulk order parameter minimizing $\\,f(\\phi;T)\\,$.\n\nStarting only from the variational principle applied to $\\,\\mathcal{F}[\\phi]\\,$ and the definitions above (do not assume any particular interface profile a priori), perform the following:\n\n1. Derive the differential equation satisfied by the stationary interfacial profile $\\,\\phi(x)\\,$ and reduce it to a first integral using conservation arguments appropriate to translation invariance in $\\,x\\,$.\n2. Solve for $\\,\\phi(x)\\,$ explicitly and compute the interfacial width $\\,\\xi\\,$ defined by\n$$\n\\xi \\equiv \\frac{\\phi_{0}}{\\left|\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right|_{x=0}},\n$$\nthat is, the inverse slope at the midplane scaled by the bulk order parameter.\n3. Express $\\,\\xi\\,$ in two equivalent ways: (i) in terms of $\\,\\kappa\\,$ and $\\,a(T)\\,$, and (ii) in terms of $\\,\\kappa\\,$ and the curvature of the homogeneous free energy density at the bulk minima, $\\,f''(\\phi_{\\min};T)\\,$.\n4. Using only the assumptions given, determine the asymptotic scaling of $\\,\\xi\\,$ as $\\,T\\to T_{c}^{-}\\,$ and state the corresponding mean-field critical exponent.\n\nYour final answer must be the closed-form analytic expression for $\\,\\xi(T)\\,$ obtained in step 3(i). Do not include units in your final boxed answer. If you choose to include any numerical constants, retain them exactly rather than approximating them.", "solution": "The problem posed is a standard exercise in the Landau-Ginzburg-Cahn-Hilliard theory of phase interfaces. It is well-posed and scientifically sound. I will solve it by following the sequence of tasks requested.\n\nThe system is described by the Helmholtz free energy functional for a one-dimensional profile $\\phi(x)$:\n$$\n\\mathcal{F}_{1D}[\\phi] = \\int_{-\\infty}^{\\infty} \\left[ f(\\phi(x);T) + \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 \\right] \\mathrm{d}x\n$$\nwhere the integrand is the Lagrangian density $L(\\phi, \\phi') = f(\\phi) + \\frac{\\kappa}{2}(\\phi')^2$, with $\\phi' \\equiv \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$. The homogeneous free energy density is given by $f(\\phi;T) = \\frac{a(T)}{2}\\phi^2 + \\frac{b}{4}\\phi^4$, with $a(T) = a_0(T-T_c)  0$ for $TT_c$.\n\nFirst, we determine the magnitude of the bulk order parameter $\\phi_0$, which corresponds to the minima of $f(\\phi)$. We solve $\\frac{\\mathrm{d}f}{\\mathrm{d}\\phi} = 0$:\n$$\n\\frac{\\mathrm{d}f}{\\mathrm{d}\\phi} = a(T)\\phi + b\\phi^3 = \\phi(a(T) + b\\phi^2) = 0\n$$\nFor $TT_c$, $a(T)0$, so there are three real solutions: $\\phi=0$ and $\\phi = \\pm\\sqrt{-a(T)/b}$. The second derivative, $f''(\\phi) = a(T) + 3b\\phi^2$, is negative at $\\phi=0$ (a maximum) and positive at $\\phi = \\pm\\sqrt{-a(T)/b}$ (minima). Thus, the equilibrium bulk order parameter magnitude is:\n$$\n\\phi_0 = \\sqrt{-\\frac{a(T)}{b}}\n$$\n\n**1. Governing Equation and First Integral**\n\nThe stationary interfacial profile $\\phi(x)$ must extremize the functional $\\mathcal{F}_{1D}[\\phi]$. This is achieved by solving the Euler-Lagrange equation:\n$$\n\\frac{\\partial L}{\\partial \\phi} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial \\phi'}\\right) = 0\n$$\nComputing the partial derivatives:\n$$\n\\frac{\\partial L}{\\partial \\phi} = \\frac{\\mathrm{d}f}{\\mathrm{d}\\phi} = a(T)\\phi + b\\phi^3\n$$\n$$\n\\frac{\\partial L}{\\partial \\phi'} = \\kappa\\phi' = \\kappa\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\n$$\nSubstituting these into the Euler-Lagrange equation yields the second-order ordinary differential equation for $\\phi(x)$:\n$$\na(T)\\phi + b\\phi^3 - \\kappa \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} = 0 \\quad \\implies \\quad \\kappa \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} = a(T)\\phi + b\\phi^3\n$$\nSince the Lagrangian $L$ does not depend explicitly on $x$, there exists a conserved quantity given by the Beltrami identity:\n$$\nC = \\phi' \\frac{\\partial L}{\\partial \\phi'} - L = \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) \\left(\\kappa \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) - \\left[ f(\\phi) + \\frac{\\kappa}{2}\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 \\right] = \\frac{\\kappa}{2}\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 - f(\\phi)\n$$\nThe constant $C$ is determined from the boundary conditions. As $x \\to \\pm\\infty$, the profile approaches the bulk states, so $\\phi \\to \\pm\\phi_0$ and $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} \\to 0$. At these points, the system is in a homogeneous bulk phase, so the conserved quantity must be $C = \\frac{\\kappa}{2}(0)^2 - f(\\phi_0) = -f(\\phi_0)$. The value of the free energy density at the minimum is $f(\\phi_0) = \\frac{a}{2}\\phi_0^2 + \\frac{b}{4}\\phi_0^4 = \\frac{a}{2}(-\\frac{a}{b}) + \\frac{b}{4}(-\\frac{a}{b})^2 = -\\frac{a^2}{4b}$.\nTherefore, the first integral of the equation of motion is:\n$$\n\\frac{\\kappa}{2}\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 - f(\\phi) = -f(\\phi_0) \\quad \\implies \\quad \\frac{\\kappa}{2}\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 = f(\\phi) - f(\\phi_0)\n$$\nThe right-hand side can be written as a perfect square:\n$$\nf(\\phi) - f(\\phi_0) = \\left(\\frac{a}{2}\\phi^2 + \\frac{b}{4}\\phi^4\\right) - \\left(-\\frac{a^2}{4b}\\right) = \\frac{b}{4}\\left(\\frac{2a}{b}\\phi^2 + \\phi^4 + \\frac{a^2}{b^2}\\right) = \\frac{b}{4}\\left(-2\\phi_0^2\\phi^2 + \\phi^4 + \\phi_0^4\\right) = \\frac{b}{4}(\\phi^2-\\phi_0^2)^2\n$$\nSo, the first integral simplifies to:\n$$\n\\frac{\\kappa}{2}\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 = \\frac{b}{4}(\\phi^2-\\phi_0^2)^2\n$$\n\n**2. Interfacial Profile and Width**\n\nTaking the square root, we obtain a first-order differential equation. We select the positive root to describe a profile increasing from $\\phi(-\\infty)=-\\phi_0$ to $\\phi(+\\infty)=+\\phi_0$:\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\sqrt{\\frac{b}{2\\kappa}} (\\phi_0^2 - \\phi^2)\n$$\nThis equation is separable. We integrate it with the condition $\\phi(0)=0$:\n$$\n\\int_0^\\phi \\frac{\\mathrm{d}\\tilde{\\phi}}{\\phi_0^2 - \\tilde{\\phi}^2} = \\int_0^x \\sqrt{\\frac{b}{2\\kappa}} \\mathrm{d}\\tilde{x}\n$$\nThe integral on the left is $\\frac{1}{\\phi_0}\\arctanh(\\frac{\\phi}{\\phi_0})$. The integration yields:\n$$\n\\frac{1}{\\phi_0} \\arctanh\\left(\\frac{\\phi}{\\phi_0}\\right) = x \\sqrt{\\frac{b}{2\\kappa}}\n$$\nSolving for $\\phi(x)$ gives the explicit interfacial profile:\n$$\n\\phi(x) = \\phi_0 \\tanh\\left( \\phi_0 \\sqrt{\\frac{b}{2\\kappa}} x \\right)\n$$\nThe interfacial width is defined as $\\xi \\equiv \\frac{\\phi_{0}}{|\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}|_{x=0}}$. We evaluate the derivative at $x=0$. From the first-order ODE, with $\\phi(0)=0$:\n$$\n\\left.\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right|_{x=0} = \\sqrt{\\frac{b}{2\\kappa}} (\\phi_0^2 - 0^2) = \\phi_0^2 \\sqrt{\\frac{b}{2\\kappa}}\n$$\nThis quantity is positive. Thus, the width is:\n$$\n\\xi = \\frac{\\phi_0}{\\phi_0^2 \\sqrt{\\frac{b}{2\\kappa}}} = \\frac{1}{\\phi_0 \\sqrt{\\frac{b}{2\\kappa}}} = \\sqrt{\\frac{2\\kappa}{b\\phi_0^2}}\n$$\n\n**3. Alternative Expressions for the Interfacial Width**\n\n(i) To express $\\xi$ in terms of $\\kappa$ and $a(T)$, we substitute $\\phi_0^2 = -a(T)/b$ into our result for $\\xi$:\n$$\n\\xi = \\sqrt{\\frac{2\\kappa}{b\\left(-\\frac{a(T)}{b}\\right)}} = \\sqrt{\\frac{2\\kappa}{-a(T)}}\n$$\n(ii) To express $\\xi$ in terms of $\\kappa$ and $f''(\\phi_{\\min};T)$, we first compute the second derivative of $f(\\phi)$ and evaluate it at the minima $\\phi_{\\min} = \\pm\\phi_0$:\n$$\nf''(\\phi) = a(T) + 3b\\phi^2\n$$\n$$\nf''(\\phi_{\\min};T) = a(T) + 3b\\phi_0^2 = a(T) + 3b\\left(-\\frac{a(T)}{b}\\right) = -2a(T)\n$$\nFrom this, we have $-a(T) = \\frac{1}{2}f''(\\phi_{\\min};T)$. Substituting into the expression from part (i):\n$$\n\\xi = \\sqrt{\\frac{2\\kappa}{\\frac{1}{2}f''(\\phi_{\\min};T)}} = \\sqrt{\\frac{4\\kappa}{f''(\\phi_{\\min};T)}} = 2\\sqrt{\\frac{\\kappa}{f''(\\phi_{\\min};T)}}\n$$\nThe two expressions are equivalent as required.\n\n**4. Asymptotic Scaling near the Critical Point**\n\nWe analyze the behavior of $\\xi$ as the temperature $T$ approaches the critical temperature $T_c$ from below ($T \\to T_c^-$). Using the expression from part 3(i) and the given form of $a(T)$:\n$$\n\\xi(T) = \\sqrt{\\frac{2\\kappa}{-a(T)}} = \\sqrt{\\frac{2\\kappa}{-a_0(T-T_c)}} = \\sqrt{\\frac{2\\kappa}{a_0(T_c-T)}}\n$$\nThis expression shows that as $T \\to T_c^-$, the term $(T_c-T) \\to 0^+$, and therefore $\\xi(T)$ diverges. The asymptotic scaling is:\n$$\n\\xi(T) \\propto (T_c - T)^{-1/2}\n$$\nThe correlation length critical exponent, $\\nu$, is defined by the relation $\\xi \\propto |T-T_c|^{-\\nu}$. By comparison, we identify the mean-field critical exponent for the correlation length:\n$$\n\\nu = \\frac{1}{2}\n$$\nThis concludes the required analysis. The final answer required is the expression for $\\xi(T)$ from step 3(i).", "answer": "$$\n\\boxed{\\sqrt{\\frac{2\\kappa}{a_0(T_c-T)}}}\n$$", "id": "2766408"}, {"introduction": "Analytical theories provide profound insight, but quantitatively determining interfacial energies for real materials often requires direct simulation. This hands-on exercise introduces a powerful computational technique, Thermodynamic Integration (TI), used to calculate free energy differences from atomistic Molecular Dynamics (MD) simulations [@problem_id:2766414]. You will act as a computational scientist, processing pre-computed simulation data to determine the reversible work needed to create an interface and thereby calculate its free energy $\\gamma$. This practice solidifies the connection between the formalisms of statistical mechanics and their practical implementation in modern research, equipping you with the skills to interpret and analyze data from advanced computational experiments.", "problem": "You are asked to formalize a reversible protocol to compute the interfacial free energy between a solid and a liquid using Molecular Dynamics (MD) and to implement the corresponding numerical evaluation given synthetic but physically plausible data. You must rely on first principles of equilibrium statistical mechanics. The central principle is that for a reversible transformation between two equilibrium states, the reversible work equals the Helmholtz free-energy difference when temperature and system size are fixed. In an MD-based Thermodynamic Integration (TI) approach, one introduces a scalar coupling parameter $\\,\\lambda\\,\\in[0,1]$ that continuously morphs the system Hamiltonian along a chosen reversible path while maintaining the intended thermodynamic ensemble, and one collects the generalized force conjugate to $\\,\\lambda\\,$ along the path. When a slab geometry is created with two identical, planar interfaces of area $\\,A\\,$, the interfacial free energy $\\,\\gamma\\,$ is obtained by normalizing the reversible work by the total newly created interfacial area $\\,2A\\,$. Your program must carry out this computation strictly from the data provided below.\n\nYour tasks are as follows:\n- For each test case, compute the reversible work by numerically integrating the tabulated generalized force $\\,X(\\lambda)\\,$ with respect to $\\,\\lambda\\,$ along the given transformation path. The tabulated $\\,X(\\lambda)\\,$ values represent the ensemble average of the generalized force for the chosen path, in units of Joules (J) per simulation cell (the whole system).\n- Normalize the reversible work by the total interfacial area $\\,2A\\,$ to obtain the interfacial free energy $\\,\\gamma\\,$, and express the final result in milli-Joules per square meter (mJ/m$^2$), rounded to three significant figures.\n- Classify the interface type based on local structural and density indicators on the two sides of the interface. For each side, you are given a mass density $\\,\\rho\\,$ in g/cm$^3$ and a local bond-orientational order parameter $\\,Q_6\\,$ (dimensionless). Use the following deterministic classification rule:\n  - A side is vapor if $\\,\\rho  0.1\\,$.\n  - Otherwise, a side is solid if $\\,Q_6 \\ge 0.3\\,$ and $\\,\\rho \\ge 0.8\\,$.\n  - Otherwise, a side is liquid.\n  - The interface type code is determined by the two sides as:\n    - $\\,0\\,$ for solid–liquid (in either order),\n    - $\\,1\\,$ for liquid–vapor (in either order),\n    - $\\,2\\,$ for solid–vapor (in either order).\n- Verify thermodynamic consistency of the specified ensemble schedule for the TI protocol. A schedule is a sequence of segments; each segment has a type and an ensemble and carries an area value. A schedule is deemed consistent if and only if:\n  - every segment with type equal to the string \"lambda_evolution\" is performed in the Canonical ensemble (NVT),\n  - every segment with type equal to the string \"equilibration\" is performed in the Isothermal–Isobaric ensemble (NPT),\n  - the interfacial area remains constant across all segments (within an absolute tolerance of $\\,10^{-12}\\,$ m$^2$ after unit conversion).\n  Output $\\,1\\,$ if the schedule is consistent and $\\,0\\,$ otherwise.\n- Numerical integration rule: if the $\\,\\lambda\\,$ grid is uniformly spaced and contains an odd number of points greater than or equal to $\\,3\\,$, use composite Simpson’s rule; otherwise, use the composite trapezoidal rule. Angles do not appear in this problem. All physical constants required for unit conversion are provided implicitly by units specified for the input.\n\nUnit conventions and conversion requirements:\n- $\\,X(\\lambda)\\,$ is given in Joules (J) per simulation cell.\n- The interfacial area $\\,A\\,$ is given in nm$^2$ and must be converted to m$^2$ using $\\,1\\,\\mathrm{nm}^2 = 10^{-18}\\,\\mathrm{m}^2\\,$.\n- The interfacial free energy $\\,\\gamma\\,$ must be reported in mJ/m$^2$.\n\nTest suite (three test cases):\n- Case 1 (intended solid–liquid):\n  - Temperature $\\,T = 270\\,$ K; Pressure $\\,P = 1.0\\times 10^{5}\\,$ Pa; Interfacial area $\\,A = 400.0\\,$ nm$^2$.\n  - $\\,\\lambda\\,$ grid: $[0.0,\\,0.25,\\,0.5,\\,0.75,\\,1.0]$.\n  - $\\,X(\\lambda)\\,$ in J: $[0.0,\\,1.728\\times 10^{-16},\\,2.112\\times 10^{-16},\\,1.536\\times 10^{-16},\\,0.0]$.\n  - Left side: $\\,\\rho = 0.92\\,$ g/cm$^3$, $\\,Q_6 = 0.40\\,$. Right side: $\\,\\rho = 1.00\\,$ g/cm$^3$, $\\,Q_6 = 0.05\\,$.\n  - Schedule segments (area values reported in nm$^2$):\n    - {\"type\":\"equilibration\",\"ensemble\":\"NPT\",\"area_nm2\":400.0}\n    - {\"type\":\"equilibration\",\"ensemble\":\"NPT\",\"area_nm2\":400.0}\n    - {\"type\":\"lambda_evolution\",\"ensemble\":\"NVT\",\"area_nm2\":400.0}\n    - {\"type\":\"lambda_evolution\",\"ensemble\":\"NVT\",\"area_nm2\":400.0}\n    - {\"type\":\"lambda_evolution\",\"ensemble\":\"NVT\",\"area_nm2\":400.0}\n- Case 2 (intended liquid–vapor):\n  - Temperature $\\,T = 350\\,$ K; Pressure $\\,P = 1.0\\times 10^{5}\\,$ Pa; Interfacial area $\\,A = 300.0\\,$ nm$^2$.\n  - $\\,\\lambda\\,$ grid: $[0.0,\\,0.2,\\,0.5,\\,0.9,\\,1.0]$.\n  - $\\,X(\\lambda)\\,$ in J: $[0.0,\\,5.316923\\times 10^{-17},\\,6.646154\\times 10^{-17},\\,2.658462\\times 10^{-17},\\,0.0]$.\n  - Left side: $\\,\\rho = 0.90\\,$ g/cm$^3$, $\\,Q_6 = 0.05\\,$. Right side: $\\,\\rho = 0.01\\,$ g/cm$^3$, $\\,Q_6 = 0.02\\,$.\n  - Schedule segments (area values reported in nm$^2$):\n    - {\"type\":\"equilibration\",\"ensemble\":\"NPT\",\"area_nm2\":300.0}\n    - {\"type\":\"lambda_evolution\",\"ensemble\":\"NPT\",\"area_nm2\":300.0}\n    - {\"type\":\"lambda_evolution\",\"ensemble\":\"NVT\",\"area_nm2\":300.0}\n- Case 3 (intended solid–vapor):\n  - Temperature $\\,T = 900\\,$ K; Pressure $\\,P = 1.0\\times 10^{-2}\\,$ Pa; Interfacial area $\\,A = 200.0\\,$ nm$^2$.\n  - $\\,\\lambda\\,$ grid: $[0.0,\\,1.0]$.\n  - $\\,X(\\lambda)\\,$ in J: $[0.0,\\,2.0\\times 10^{-16}]$.\n  - Left side: $\\,\\rho = 2.70\\,$ g/cm$^3$, $\\,Q_6 = 0.35\\,$. Right side: $\\,\\rho = 0.001\\,$ g/cm$^3$, $\\,Q_6 = 0.01\\,$.\n  - Schedule segments (area values reported in nm$^2$):\n    - {\"type\":\"equilibration\",\"ensemble\":\"NPT\",\"area_nm2\":200.0}\n    - {\"type\":\"lambda_evolution\",\"ensemble\":\"NVT\",\"area_nm2\":200.0}\n\nFinal output format:\n- Your program should produce a single line of output containing a list of results, one entry per test case, where each entry is itself a list of three numbers: $[\\gamma_{\\mathrm{mJ/m^2}},\\,\\text{class\\_code},\\,\\text{schedule\\_ok}]$ with $\\,\\gamma_{\\mathrm{mJ/m^2}}\\,$ a float rounded to three significant figures, $\\,\\text{class\\_code}\\,$ an integer in $\\{0,1,2\\}$, and $\\,\\text{schedule\\_ok}\\,$ either $\\,1\\,$ or $\\,0\\,$. For example: [[g1,c1,s1],[g2,c2,s2],[g3,c3,s3]].", "solution": "The problem statement has been subjected to rigorous validation against the criteria of scientific grounding, well-posedness, and objectivity. It is found to be a valid, self-contained problem rooted in the fundamental principles of statistical mechanics and computational physics. It poses a clear, formalizable task with unambiguous data and evaluation criteria. Therefore, a complete solution is provided below.\n\nThe central principle for this problem is the relationship between the Helmholtz free energy difference, $\\Delta F$, and the reversible work, $W_{\\text{rev}}$, for a process conducted at constant temperature $T$, volume $V$, and number of particles $N$:\n$$ \\Delta F = W_{\\text{rev}} $$\nIn the context of Thermodynamic Integration (TI), the reversible work is calculated by integrating the ensemble-averaged generalized force, $\\langle \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\rangle_{\\lambda} = X(\\lambda)$, conjugate to a coupling parameter $\\lambda$ that continuously transforms the system's Hamiltonian $H$ along a reversible path from $\\lambda=0$ to $\\lambda=1$.\n$$ W_{\\text{rev}} = \\int_{0}^{1} X(\\lambda) \\, d\\lambda $$\nFor a slab geometry containing two identical planar interfaces of area $A$, the interfacial free energy, $\\gamma$, is the excess free energy per unit area. It is obtained by normalizing the reversible work required to create the interfaces by the total interfacial area, $2A$.\n$$ \\gamma = \\frac{W_{\\text{rev}}}{2A} = \\frac{1}{2A} \\int_{0}^{1} X(\\lambda) \\, d\\lambda $$\nThe calculation proceeds through three distinct tasks for each test case: computation of $\\gamma$, classification of the interface type, and validation of the thermodynamic schedule.\n\n**1. Interfacial Free Energy Calculation**\nThe integral for $W_{\\text{rev}}$ is computed numerically from the tabulated data of $X(\\lambda)$ versus $\\lambda$. The choice of numerical integration rule is dictated by the problem's explicit instructions:\n- If the $\\lambda$ grid is uniformly spaced and contains an odd number of points greater than or equal to $3$, the composite Simpson's rule is used for its higher-order accuracy.\n- Otherwise, the more general composite trapezoidal rule is applied, which accommodates non-uniform grids.\nThe computed work $W_{\\text{rev}}$ is given in Joules ($J$). The area $A$ is given in square nanometers ($\\text{nm}^2$) and must be converted to square meters ($\\text{m}^2$) using the conversion factor $1 \\, \\text{nm}^2 = 10^{-18} \\, \\text{m}^2$. The final interfacial free energy $\\gamma$ is expressed in milli-Joules per square meter ($\\text{mJ/m}^2$), requiring a final conversion factor of $1 \\, \\text{J} = 10^3 \\, \\text{mJ}$. The complete conversion is:\n$$ \\gamma \\, [\\text{mJ/m}^2] = \\frac{W_{\\text{rev}} \\, [\\text{J}]}{2 \\cdot A \\, [\\text{nm}^2] \\cdot 10^{-18} \\, [\\text{m}^2/\\text{nm}^2]} \\cdot 10^3 \\, [\\text{mJ/J}] = \\frac{W_{\\text{rev}}}{2A} \\times 10^{21} $$\nThe result is then rounded to three significant figures.\n\n**2. Interface Classification**\nThe interface type is determined by classifying the phase on each side based on the provided local mass density $\\rho$ (in $\\text{g/cm}^3$) and the Steinhardt bond-orientational order parameter $Q_6$ (dimensionless). The deterministic rules are as follows: a region is classified as vapor if $\\rho  0.1$; otherwise, it is solid if $Q_6 \\ge 0.3$ and $\\rho \\ge 0.8$; otherwise, it is liquid. The resulting interface type is assigned an integer code: $0$ for solid–liquid, $1$ for liquid–vapor, and $2$ for solid–vapor.\n\n**3. Schedule Consistency Validation**\nThe simulation schedule's thermodynamic consistency is verified against three strict conditions:\n- All `lambda_evolution` segments must be performed in the Canonical (NVT) ensemble to ensure that the work done corresponds to a change in Helmholtz free energy.\n- All `equilibration` segments must be performed in the Isothermal-Isobaric (NPT) ensemble to allow the system to relax to the correct density under the specified temperature and pressure.\n- The interfacial area $A$ must remain constant throughout all segments of the protocol, as the TI path is defined for a fixed system geometry. A tolerance of $10^{-12} \\, \\text{m}^2$ is given, but the provided data are exactly constant.\n\nThe analysis for each test case is as follows:\n\n**Case 1:**\n- **Integration**: The $\\lambda$ grid $[0.0, 0.25, 0.5, 0.75, 1.0]$ is uniform with step $h=0.25$ and contains $5$ points. Simpson's rule is applicable.\n  $$ W_{\\text{rev},1} = \\frac{0.25}{3} [X(0) + 4X(0.25) + 2X(0.5) + 4X(0.75) + X(1)] $$\n  $$ W_{\\text{rev},1} = \\frac{0.25}{3} [0 + 4(1.728 \\times 10^{-16}) + 2(2.112 \\times 10^{-16}) + 4(1.536 \\times 10^{-16}) + 0] \\, \\text{J} = 1.44 \\times 10^{-16} \\, \\text{J} $$\n- **Energy Calculation**: With $A = 400.0 \\, \\text{nm}^2$:\n  $$ \\gamma_1 = \\frac{1.44 \\times 10^{-16}}{2 \\cdot 400.0} \\times 10^{21} = 180.0 \\, \\text{mJ/m}^2 $$\n- **Classification**: Left side ($\\rho=0.92, Q_6=0.40$) is solid. Right side ($\\rho=1.00, Q_6=0.05$) is liquid. The interface is solid–liquid, code $0$.\n- **Schedule Check**: All `equilibration` segments are NPT, all `lambda_evolution` segments are NVT, and area is constant at $400.0 \\, \\text{nm}^2$. The schedule is consistent, code $1$.\n- **Result**: $[\\gamma=180.0, \\text{class\\_code}=0, \\text{schedule\\_ok}=1]$.\n\n**Case 2:**\n- **Integration**: The $\\lambda$ grid $[0.0, 0.2, 0.5, 0.9, 1.0]$ is non-uniform. The trapezoidal rule must be used.\n  $$ W_{\\text{rev},2} = \\frac{1}{2}(X(0.0)+X(0.2))(0.2) + \\dots + \\frac{1}{2}(X(0.9)+X(1.0))(0.1) = 4.320 \\times 10^{-17} \\, \\text{J} $$\n- **Energy Calculation**: With $A = 300.0 \\, \\text{nm}^2$:\n  $$ \\gamma_2 = \\frac{4.320 \\times 10^{-17}}{2 \\cdot 300.0} \\times 10^{21} = 72.0 \\, \\text{mJ/m}^2 $$\n- **Classification**: Left side ($\\rho=0.90, Q_6=0.05$) is liquid. Right side ($\\rho=0.01, Q_6=0.02$) is vapor. The interface is liquid–vapor, code $1$.\n- **Schedule Check**: A segment with `type: \"lambda_evolution\"` is incorrectly specified with `ensemble: \"NPT\"`. The schedule is inconsistent, code $0$.\n- **Result**: $[\\gamma=72.0, \\text{class\\_code}=1, \\text{schedule\\_ok}=0]$.\n\n**Case 3:**\n- **Integration**: The $\\lambda$ grid $[0.0, 1.0]$ has only $2$ points. The trapezoidal rule is used.\n  $$ W_{\\text{rev},3} = \\frac{1}{2}(X(0.0)+X(1.0))(1.0 - 0.0) = \\frac{1}{2}(0.0 + 2.0 \\times 10^{-16})(1.0) = 1.0 \\times 10^{-16} \\, \\text{J} $$\n- **Energy Calculation**: With $A = 200.0 \\, \\text{nm}^2$:\n  $$ \\gamma_3 = \\frac{1.0 \\times 10^{-16}}{2 \\cdot 200.0} \\times 10^{21} = 250.0 \\, \\text{mJ/m}^2 $$\n- **Classification**: Left side ($\\rho=2.70, Q_6=0.35$) is solid. Right side ($\\rho=0.001, Q_6=0.01$) is vapor. The interface is solid–vapor, code $2$.\n- **Schedule Check**: All segments correctly follow the rules for ensemble type, and area is constant at $200.0 \\, \\text{nm}^2$. The schedule is consistent, code $1$.\n- **Result**: $[\\gamma=250.0, \\text{class\\_code}=2, \\text{schedule\\_ok}=1]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases as specified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A_nm2\": 400.0,\n            \"lambdas\": np.array([0.0, 0.25, 0.5, 0.75, 1.0]),\n            \"X_lambda_J\": np.array([0.0, 1.728e-16, 2.112e-16, 1.536e-16, 0.0]),\n            \"sides\": [\n                {\"rho_g_cm3\": 0.92, \"Q6\": 0.40}, \n                {\"rho_g_cm3\": 1.00, \"Q6\": 0.05}\n            ],\n            \"schedule\": [\n                {\"type\": \"equilibration\", \"ensemble\": \"NPT\", \"area_nm2\": 400.0},\n                {\"type\": \"equilibration\", \"ensemble\": \"NPT\", \"area_nm2\": 400.0},\n                {\"type\": \"lambda_evolution\", \"ensemble\": \"NVT\", \"area_nm2\": 400.0},\n                {\"type\": \"lambda_evolution\", \"ensemble\": \"NVT\", \"area_nm2\": 400.0},\n                {\"type\": \"lambda_evolution\", \"ensemble\": \"NVT\", \"area_nm2\": 400.0}\n            ]\n        },\n        {\n            \"A_nm2\": 300.0,\n            \"lambdas\": np.array([0.0, 0.2, 0.5, 0.9, 1.0]),\n            \"X_lambda_J\": np.array([0.0, 5.316923e-17, 6.646154e-17, 2.658462e-17, 0.0]),\n            \"sides\": [\n                {\"rho_g_cm3\": 0.90, \"Q6\": 0.05},\n                {\"rho_g_cm3\": 0.01, \"Q6\": 0.02}\n            ],\n            \"schedule\": [\n                {\"type\": \"equilibration\", \"ensemble\": \"NPT\", \"area_nm2\": 300.0},\n                {\"type\": \"lambda_evolution\", \"ensemble\": \"NPT\", \"area_nm2\": 300.0},\n                {\"type\": \"lambda_evolution\", \"ensemble\": \"NVT\", \"area_nm2\": 300.0}\n            ]\n        },\n        {\n            \"A_nm2\": 200.0,\n            \"lambdas\": np.array([0.0, 1.0]),\n            \"X_lambda_J\": np.array([0.0, 2.0e-16]),\n            \"sides\": [\n                {\"rho_g_cm3\": 2.70, \"Q6\": 0.35},\n                {\"rho_g_cm3\": 0.001, \"Q6\": 0.01}\n            ],\n            \"schedule\": [\n                {\"type\": \"equilibration\", \"ensemble\": \"NPT\", \"area_nm2\": 200.0},\n                {\"type\": \"lambda_evolution\", \"ensemble\": \"NVT\", \"area_nm2\": 200.0}\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Task 1: Compute interfacial free energy gamma\n        lambdas = case[\"lambdas\"]\n        X_lambda = case[\"X_lambda_J\"]\n        \n        # Determine integration rule\n        is_uniform = np.allclose(np.diff(lambdas), np.diff(lambdas)[0]) if len(lambdas) > 1 else True\n        use_simpson = is_uniform and len(lambdas) >= 3 and len(lambdas) % 2 != 0\n\n        if use_simpson:\n            # SciPy's simpson handles uniform grids via dx parameter\n            W_rev = integrate.simpson(X_lambda, dx=lambdas[1] - lambdas[0])\n        else:\n            # NumPy's trapz handles non-uniform grids via x parameter\n            W_rev = np.trapz(X_lambda, lambdas)\n        \n        A_nm2 = case[\"A_nm2\"]\n        # gamma (mJ/m^2) = (W_rev [J] / (2 * A [nm^2] * 1e-18 m^2/nm^2)) * 1e3 mJ/J\n        gamma = (W_rev / (2 * A_nm2)) * 1e21\n\n        def round_to_3_sig_figs(x):\n            if x == 0:\n                return 0.0\n            power = 3 - int(math.floor(math.log10(abs(x)))) - 1\n            return round(x, power)\n\n        gamma_rounded = round_to_3_sig_figs(gamma)\n\n        # Task 2: Classify the interface\n        def classify_side(rho, q6):\n            if rho  0.1:\n                return \"vapor\"\n            elif q6 >= 0.3 and rho >= 0.8:\n                return \"solid\"\n            else:\n                return \"liquid\"\n\n        side1_phase = classify_side(case[\"sides\"][0][\"rho_g_cm3\"], case[\"sides\"][0][\"Q6\"])\n        side2_phase = classify_side(case[\"sides\"][1][\"rho_g_cm3\"], case[\"sides\"][1][\"Q6\"])\n        \n        phases = {side1_phase, side2_phase}\n        class_code = -1\n        if phases == {\"solid\", \"liquid\"}:\n            class_code = 0\n        elif phases == {\"liquid\", \"vapor\"}:\n            class_code = 1\n        elif phases == {\"solid\", \"vapor\"}:\n            class_code = 2\n\n        # Task 3: Verify thermodynamic consistency\n        schedule = case[\"schedule\"]\n        schedule_ok = 1\n        first_area = schedule[0][\"area_nm2\"]\n        # Area constancy check (using a small tolerance for float comparison)\n        if not all(np.isclose(seg[\"area_nm2\"], first_area) for seg in schedule):\n            schedule_ok = 0\n        \n        if schedule_ok == 1:\n            for seg in schedule:\n                seg_type = seg[\"type\"]\n                seg_ensemble = seg[\"ensemble\"]\n                if seg_type == \"lambda_evolution\" and seg_ensemble != \"NVT\":\n                    schedule_ok = 0\n                    break\n                if seg_type == \"equilibration\" and seg_ensemble != \"NPT\":\n                    schedule_ok = 0\n                    break\n        \n        results.append([gamma_rounded, class_code, schedule_ok])\n\n    # Final print statement in the exact required format\n    list_of_strs = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    final_str = f\"[{','.join(list_of_strs)}]\"\n    print(final_str)\n\nsolve()\n```", "id": "2766414"}]}