{"hands_on_practices": [{"introduction": "The Lennard-Jones (LJ) potential is a simple yet profoundly insightful model, and its characteristic shape captures the essential physics of van der Waals interactions. The most fundamental property of this potential is its minimum, which corresponds to the equilibrium separation distance, $r_{0}$, where the attractive and repulsive forces between two atoms perfectly balance. This exercise provides foundational practice in analyzing potential energy surfaces by finding this minimum, allowing you to determine the natural \"bond length\" of an LJ dimer, a key parameter that underpins the structure of condensed matter. [@problem_id:2775095]", "problem": "In nanoscale contact between two neutral, closed-shell atoms typical of rare-gas adsorption on surfaces, the interaction can be modeled by the Lennard–Jones (LJ) $12$–$6$ potential. The Lennard–Jones (LJ) potential for the pair interaction as a function of separation $r$ is\n$$\n\\phi_{\\mathrm{LJ}}(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\nwhere $\\varepsilon>0$ sets the interaction energy scale and $\\sigma>0$ sets the characteristic length at which the potential crosses zero. In a conservative central potential, mechanical equilibrium for the relative coordinate requires the force to vanish, which occurs when $d\\phi_{\\mathrm{LJ}}/dr=0$ at a stationary point $r=r_{0}$. Starting from this equilibrium condition and the given potential, determine the equilibrium separation $r_{0}$ and express it as a multiple of $\\sigma$, namely the dimensionless ratio $r_{0}/\\sigma$. Provide your final result as a closed-form expression. No numerical approximation or rounding is required.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\nStep 1: Extract Givens\n- The interaction is modeled by the Lennard–Jones (LJ) $12$–$6$ potential.\n- The potential function is $\\phi_{\\mathrm{LJ}}(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$.\n- The parameter $\\varepsilon > 0$ is the interaction energy scale.\n- The parameter $\\sigma > 0$ is the characteristic length at which the potential crosses zero.\n- The system is described by a conservative central potential.\n- The mechanical equilibrium condition is given by the force vanishing, which corresponds to the stationary point of the potential: $d\\phi_{\\mathrm{LJ}}/dr=0$ at $r=r_{0}$.\n- The objective is to determine the equilibrium separation $r_{0}$ and express it as the dimensionless ratio $r_{0}/\\sigma$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The Lennard-Jones potential is a fundamentally important and standard model in physics and chemistry for describing van der Waals interactions between neutral atoms. The condition for mechanical equilibrium in a conservative one-dimensional system, $F(r) = -d\\phi/dr = 0$, is a cornerstone of classical mechanics. The problem is well-posed, providing a clearly defined function and asking for the location of its stationary point, which corresponds to a physical observable. The parameters $\\varepsilon$ and $\\sigma$ are properly defined with positive constraints, consistent with their physical meaning. The problem is objective, self-contained, and free of any logical contradictions, ambiguities, or unsound premises.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nThe force $F(r)$ corresponding to the central potential $\\phi_{\\mathrm{LJ}}(r)$ is given by the negative gradient of the potential, which in one dimension is $F(r) = -\\frac{d\\phi_{\\mathrm{LJ}}}{dr}$. The condition for mechanical equilibrium is that the net force is zero, $F(r_0) = 0$, which implies that the potential is at a stationary point, $\\frac{d\\phi_{\\mathrm{LJ}}}{dr}\\bigg|_{r=r_{0}} = 0$.\n\nThe Lennard-Jones potential is given as:\n$$\n\\phi_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\nFor ease of differentiation, we rewrite the potential as:\n$$\n\\phi_{\\mathrm{LJ}}(r) = 4\\varepsilon[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}]\n$$\nNow, we compute the derivative of $\\phi_{\\mathrm{LJ}}(r)$ with respect to $r$ using the power rule for differentiation, $\\frac{d}{dx}(x^n) = nx^{n-1}$:\n$$\n\\frac{d\\phi_{\\mathrm{LJ}}}{dr} = 4\\varepsilon \\frac{d}{dr}[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}]\n$$\n$$\n\\frac{d\\phi_{\\mathrm{LJ}}}{dr} = 4\\varepsilon[\\sigma^{12}(-12r^{-13}) - \\sigma^{6}(-6r^{-7})]\n$$\n$$\n\\frac{d\\phi_{\\mathrm{LJ}}}{dr} = 4\\varepsilon[-12\\sigma^{12}r^{-13} + 6\\sigma^{6}r^{-7}]\n$$\nWe set this derivative to zero to find the equilibrium separation $r=r_{0}$:\n$$\n4\\varepsilon[-12\\sigma^{12}r_{0}^{-13} + 6\\sigma^{6}r_{0}^{-7}] = 0\n$$\nSince $\\varepsilon > 0$, the quantity in the brackets must be zero:\n$$\n-12\\sigma^{12}r_{0}^{-13} + 6\\sigma^{6}r_{0}^{-7} = 0\n$$\n$$\n6\\sigma^{6}r_{0}^{-7} = 12\\sigma^{12}r_{0}^{-13}\n$$\nWe are looking for a solution where $r_{0} > 0$ and $\\sigma > 0$. We can therefore divide both sides by $6\\sigma^{6}$:\n$$\nr_{0}^{-7} = 2\\sigma^{6}r_{0}^{-13}\n$$\nTo solve for $r_{0}$, we rearrange the equation to group terms involving $r_{0}$:\n$$\n\\frac{r_{0}^{13}}{r_{0}^{7}} = 2\\sigma^{6}\n$$\n$$\nr_{0}^{13-7} = 2\\sigma^{6}\n$$\n$$\nr_{0}^{6} = 2\\sigma^{6}\n$$\nTaking the sixth root of both sides, and noting that both $r_0$ and $\\sigma$ are positive physical distances, we obtain the unique positive real solution:\n$$\nr_{0} = (2\\sigma^{6})^{1/6} = 2^{1/6}(\\sigma^{6})^{1/6} = 2^{1/6}\\sigma\n$$\nThis result gives the equilibrium separation $r_0$. The problem asks for the dimensionless ratio $r_{0}/\\sigma$. Dividing our result by $\\sigma$:\n$$\n\\frac{r_{0}}{\\sigma} = 2^{1/6}\n$$\nTo confirm that this stationary point corresponds to a stable equilibrium (a potential minimum), we must check the sign of the second derivative, $\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2}$, at $r = r_0$. A positive sign indicates a minimum.\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2} = \\frac{d}{dr} \\left( 4\\varepsilon[-12\\sigma^{12}r^{-13} + 6\\sigma^{6}r^{-7}] \\right)\n$$\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2} = 4\\varepsilon[-12\\sigma^{12}(-13r^{-14}) + 6\\sigma^{6}(-7r^{-8})]\n$$\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2} = 4\\varepsilon[156\\sigma^{12}r^{-14} - 42\\sigma^{6}r^{-8}]\n$$\nEvaluating at $r=r_0$, where $r_0^6=2\\sigma^6$:\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2}\\bigg|_{r=r_{0}} = 4\\varepsilon\\left[ \\frac{156\\sigma^{12}}{r_{0}^{14}} - \\frac{42\\sigma^{6}}{r_{0}^{8}} \\right] = \\frac{4\\varepsilon}{r_{0}^{8}} \\left[ \\frac{156\\sigma^{12}}{r_{0}^{6}} - 42\\sigma^{6} \\right]\n$$\nSubstitute $r_0^6=2\\sigma^6$:\n$$\n\\frac{d^2\\phi_{\\mathrm{LJ}}}{dr^2}\\bigg|_{r=r_{0}} = \\frac{4\\varepsilon}{r_{0}^{8}} \\left[ \\frac{156\\sigma^{12}}{2\\sigma^{6}} - 42\\sigma^{6} \\right] = \\frac{4\\varepsilon}{r_{0}^{8}} [78\\sigma^{6} - 42\\sigma^{6}] = \\frac{4\\varepsilon}{r_{0}^{8}} [36\\sigma^{6}] = \\frac{144\\varepsilon\\sigma^6}{r_0^8}\n$$\nSince $\\varepsilon > 0$, $\\sigma > 0$, and $r_0 > 0$, the second derivative is positive. Thus, $r_0 = 2^{1/6}\\sigma$ corresponds to a point of stable equilibrium.", "answer": "$$\n\\boxed{2^{1/6}}\n$$", "id": "2775095"}, {"introduction": "While the Lennard-Jones potential describes a single pair of atoms, its true power lies in predicting the collective behavior of a macroscopic system. Statistical mechanics provides the direct link, allowing us to calculate thermodynamic properties like the second virial coefficient, $B_{2}(T)$, which measures the initial deviation of a real gas from ideal gas behavior. This practice guides you through the process of deriving and numerically computing this key thermodynamic quantity, offering hands-on experience in bridging the microscopic and macroscopic scales through computation. [@problem_id:2775099]", "problem": "You are to derive and implement a numerical program that computes the second virial coefficient for a monatomic gas interacting via the Lennard–Jones (LJ) pair potential in reduced units, and then identifies the reduced Boyle temperature where the second virial coefficient changes sign. Your derivation must begin from fundamental statistical mechanics definitions and must not assume any pre-simplified target expressions.\n\nStarting point and fundamental definitions:\n- The classical canonical ensemble for a dilute monatomic gas with pairwise-additive, spherically symmetric interactions implies that the second virial coefficient $B_{2}(T)$ is obtained from the Mayer $f$-function $f(\\mathbf{r})$ defined by $f(\\mathbf{r}) = \\exp\\!\\left(-\\beta u(r)\\right) - 1$, with $\\beta = 1/\\left(k_{\\mathrm{B}} T\\right)$ and $u(r)$ the pair potential. The exact definition is\n$$\nB_{2}(T) = -\\frac{1}{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{r}) \\, d^{3}\\mathbf{r}.\n$$\n- The Lennard–Jones (LJ) potential is\n$$\nu(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\nwhere $\\varepsilon$ sets the energy scale and $\\sigma$ sets the length scale.\n\nTasks to be performed:\n1. From the above starting point, derive an explicit one-dimensional integral for $B_{2}(T)$ that exploits spherical symmetry, and then nondimensionalize the result using the reduced variables $r^{\\star} = r / \\sigma$ and $T^{\\star} = k_{\\mathrm{B}} T / \\varepsilon$. Define a reduced, dimensionless second virial coefficient $B_{2}^{\\star}(T^{\\star}) = B_{2}(T)/\\sigma^{3}$ so that your final integral is fully dimensionless.\n2. Explain why the resulting improper integral over $r^{\\star} \\in [0,\\infty)$ is convergent at both limits, and outline a robust numerical quadrature strategy to evaluate it to a prescribed accuracy.\n3. Implement a program that:\n   - Numerically evaluates $B_{2}^{\\star}(T^{\\star})$ for the Lennard–Jones potential using a reliable quadrature method suitable for an integral from $0$ to $\\infty$ with an integrand defined by the above derivation.\n   - Uses a bracketing root-finding method grounded in the Intermediate Value Theorem to locate the reduced Boyle temperature $T_{\\mathrm{B}}^{\\star}$ such that $B_{2}^{\\star}\\!\\left(T_{\\mathrm{B}}^{\\star}\\right) = 0$ within a specified numerical tolerance.\n\nNumerical accuracy requirements:\n- For each numerical integral, achieve an absolute numerical error no larger than $10^{-8}$ in $B_{2}^{\\star}$.\n- For locating $T_{\\mathrm{B}}^{\\star}$, achieve an absolute error no larger than $10^{-6}$ in $T^{\\star}$.\n\nTest suite:\n- Compute $B_{2}^{\\star}(T^{\\star})$ for the following reduced temperatures:\n  - $T^{\\star} = 0.8$ (strongly attractive regime),\n  - $T^{\\star} = 2.0$ (moderately attractive regime),\n  - $T^{\\star} = 6.0$ (repulsion-dominated regime),\n  - $T^{\\star} = 100.0$ (asymptotically high-temperature regime).\n- Identify the reduced Boyle temperature $T_{\\mathrm{B}}^{\\star}$ as the unique root of $B_{2}^{\\star}(T^{\\star})$ in the bracket $[2.5, 5.0]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\left[ B_{2}^{\\star}(0.8), \\; B_{2}^{\\star}(2.0), \\; B_{2}^{\\star}(6.0), \\; B_{2}^{\\star}(100.0), \\; T_{\\mathrm{B}}^{\\star} \\right],\n$$\n- Each number must be rounded to $8$ decimal places.\n- There are no physical units in the final output because all quantities are dimensionless by construction.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard problem in statistical mechanics requiring both theoretical derivation and numerical implementation. All necessary information is provided, and the problem is free of contradictions or ambiguities. It is therefore deemed valid, and a solution will be provided.\n\nThe solution is structured into three parts as requested: derivation of the working integral, analysis of its properties, and a description of the numerical implementation.\n\n### 1. Derivation of the Reduced Second Virial Coefficient Integral\n\nThe starting point is the formal definition of the second virial coefficient, $B_{2}(T)$, in the classical canonical ensemble for a system with pairwise additive interactions:\n$$\nB_{2}(T) = -\\frac{1}{2} \\int_{\\mathbb{R}^{3}} f(\\mathbf{r}) \\, d^{3}\\mathbf{r}\n$$\nwhere $f(\\mathbf{r})$ is the Mayer function, defined in terms of the pair potential $u(r)$ and inverse thermal energy $\\beta = 1/(k_{\\mathrm{B}} T)$:\n$$\nf(\\mathbf{r}) = \\exp(-\\beta u(r)) - 1\n$$\nThe Lennard-Jones (LJ) potential, $u(r)$, is spherically symmetric:\n$$\nu(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\nDue to this symmetry, the Mayer function depends only on the radial distance $r = |\\mathbf{r}|$. It is therefore advantageous to express the volume integral in spherical coordinates, where the volume element is $d^{3}\\mathbf{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$. The integration over the angular coordinates $(\\theta, \\phi)$ can be performed immediately:\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta \\, d\\phi = 4\\pi\n$$\nSubstituting this into the expression for $B_{2}(T)$ yields a one-dimensional integral over the radial coordinate $r$:\n$$\nB_{2}(T) = -\\frac{1}{2} (4\\pi) \\int_{0}^{\\infty} [\\exp(-\\beta u(r)) - 1] r^2 \\, dr = -2\\pi \\int_{0}^{\\infty} [\\exp(-\\beta u(r)) - 1] r^2 \\, dr\n$$\nTo make this expression dimensionless, we introduce the reduced variables $r^{\\star} = r / \\sigma$ and $T^{\\star} = k_{\\mathrm{B}} T / \\varepsilon$. The argument of the exponential, $\\beta u(r)$, can be rewritten in terms of these variables:\n$$\n\\beta u(r) = \\frac{1}{k_{\\mathrm{B}} T} \\left( 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right] \\right) = \\frac{\\varepsilon}{k_{\\mathrm{B}} T} \\left( 4 \\left[\\left(\\frac{\\sigma}{r^{\\star}\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{r^{\\star}\\sigma}\\right)^{6}\\right] \\right)\n$$\n$$\n\\beta u(r) = \\frac{1}{T^{\\star}} \\left( 4 \\left[(r^{\\star})^{-12} - (r^{\\star})^{-6}\\right] \\right) = \\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\n$$\nwhere $u^{\\star}(r^{\\star}) = u(r)/\\varepsilon$ is the reduced LJ potential.\nWe now substitute $r = r^{\\star}\\sigma$ and $dr = \\sigma \\, dr^{\\star}$ into the integral for $B_{2}(T)$:\n$$\nB_{2}(T) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left(-\\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\\right) - 1 \\right] (r^{\\star}\\sigma)^2 (\\sigma \\, dr^{\\star})\n$$\n$$\nB_{2}(T) = -2\\pi\\sigma^3 \\int_{0}^{\\infty} \\left[ \\exp\\left(-\\frac{4}{T^{\\star}}\\left((r^{\\star})^{-12} - (r^{\\star})^{-6}\\right)\\right) - 1 \\right] (r^{\\star})^2 \\, dr^{\\star}\n$$\nThe problem requires the reduced second virial coefficient $B_{2}^{\\star}(T^{\\star}) = B_{2}(T)/\\sigma^{3}$. Dividing the above equation by $\\sigma^3$ gives the final, dimensionless expression:\n$$\nB_{2}^{\\star}(T^{\\star}) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left(-\\frac{4}{T^{\\star}}\\left((r^{\\star})^{-12} - (r^{\\star})^{-6}\\right)\\right) - 1 \\right] (r^{\\star})^2 \\, dr^{\\star}\n$$\nThis completes the derivation.\n\n### 2. Convergence Analysis and Numerical Strategy\n\nThe evaluation of $B_{2}^{\\star}(T^{\\star})$ requires computing an improper integral over the domain $r^{\\star} \\in [0, \\infty)$. We must verify its convergence at both limits.\n\n**Convergence at $r^{\\star} \\to 0^{+}$:**\nAs $r^{\\star} \\to 0^{+}$, the repulsive term $(r^{\\star})^{-12}$ dominates the potential, causing $u^{\\star}(r^{\\star}) \\to +\\infty$. Consequently, the argument of the exponential, $-u^{\\star}(r^{\\star})/T^{\\star}$, tends to $-\\infty$. This leads to $\\exp(-u^{\\star}(r^{\\star})/T^{\\star}) \\to 0$. The integrand, which we denote $I(r^{\\star}, T^{\\star})$, behaves as:\n$$\nI(r^{\\star}, T^{\\star}) = \\left[ \\exp\\left(-\\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\\right) - 1 \\right] (r^{\\star})^2 \\approx (0 - 1)(r^{\\star})^2 = -(r^{\\star})^2\n$$\nSince $\\int_{0}^{\\delta} -(r^{\\star})^2 \\, dr^{\\star}$ is finite for any $\\delta > 0$, the integral is convergent at the lower limit. The integrand is not singular; its value at $r^{\\star}=0$ is exactly $0$.\n\n**Convergence at $r^{\\star} \\to \\infty$:**\nAs $r^{\\star} \\to \\infty$, both $(r^{\\star})^{-12}$ and $(r^{\\star})^{-6}$ approach $0$, so $u^{\\star}(r^{\\star}) \\to 0$. The argument of the exponential $-u^{\\star}(r^{\\star})/T^{\\star}$ also approaches $0$. We can use the Taylor expansion $e^x - 1 \\approx x$ for small $x$. The integrand behaves as:\n$$\nI(r^{\\star}, T^{\\star}) \\approx \\left(-\\frac{u^{\\star}(r^{\\star})}{T^{\\star}}\\right) (r^{\\star})^2 = -\\frac{4}{T^{\\star}}\\left((r^{\\star})^{-12} - (r^{\\star})^{-6}\\right) (r^{\\star})^2 \\approx \\frac{4}{T^{\\star}}(r^{\\star})^{-4}\n$$\nThe integral at large $r^{\\star}$ behaves as $\\int_{M}^{\\infty} (r^{\\star})^{-4} \\, dr^{\\star}$, which is proportional to $[-(r^{\\star})^{-3}]_{M}^{\\infty}$ and is finite. The integrand decays sufficiently fast, as $(r^{\\star})^{-4}$, ensuring convergence at the upper limit.\n\n**Numerical Quadrature Strategy:**\nThe integral is well-behaved and suitable for standard numerical quadrature routines designed for infinite intervals. We will employ the `scipy.integrate.quad` function, which is a robust, adaptive quadrature routine from the QUADPACK library.\nTo maintain numerical accuracy, especially for large $r^{\\star}$ where the argument of the exponential is close to zero, it is critical to use a function that accurately computes $e^x - 1$. The `scipy.special.expm1` function is designed for this purpose, avoiding the loss of precision that occurs when subtracting two nearly equal numbers. The absolute error tolerance for the quadrature will be set to a value smaller than $10^{-9}$ to ensure the final error in $B_2^{\\star}$ is below the required threshold of $10^{-8}$.\n\n### 3. Implementation of the Numerical Solution\n\nThe implementation involves two main tasks: computing $B_{2}^{\\star}(T^{\\star})$ for given temperatures and finding the reduced Boyle temperature $T_{\\mathrm{B}}^{\\star}$.\n\n**Calculation of $B_{2}^{\\star}(T^{\\star})$:**\nA Python function will be created to represent $B_{2}^{\\star}(T^{\\star})$. This function will define the integrand $I(r^{\\star}, T^{\\star})$ as derived above, using `scipy.special.expm1` for numerical stability. It will then call `scipy.integrate.quad` to perform the integration from $0$ to $\\infty$, passing the integrand and the temperature $T^{\\star}$ as an argument. The result from `quad` is then multiplied by $-2\\pi$ to obtain $B_{2}^{\\star}(T^{\\star})$.\n\n**Finding the Reduced Boyle Temperature $T_{\\mathrm{B}}^{\\star}$:**\nThe reduced Boyle temperature $T_{\\mathrm{B}}^{\\star}$ is the temperature at which the second virial coefficient is zero, i.e., $B_{2}^{\\star}(T_{\\mathrm{B}}^{\\star}) = 0$. This is a root-finding problem. As requested, we must use a bracketing method. The `scipy.optimize.root_scalar` function with `method='brentq'` is an excellent choice. Brent's method is a hybrid algorithm that combines the guaranteed convergence of the bisection method with the speed of interpolation methods.\nThe given bracket $[2.5, 5.0]$ must be validated. At low temperatures (e.g., $T^{\\star}=2.5$), intermolecular attraction dominates, leading to $B_{2}^{\\star} < 0$. At high temperatures (e.g., $T^{\\star}=5.0$), repulsion dominates, leading to $B_{2}^{\\star} > 0$. Since $B_{2}^{\\star}(T^{\\star})$ is a continuous function of $T^{\\star}$, the Intermediate Value Theorem guarantees that a root exists within this bracket. The tolerance `xtol` of the root-finding routine will be set to $10^{-6}$ to meet the specified accuracy for $T_{\\mathrm{B}}^{\\star}$.\n\nThe final program will compute $B_2^{\\star}$ for the four specified temperatures, find $T_B^{\\star}$, and print the results in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import root_scalar\nfrom scipy.special import expm1\n\ndef solve():\n    \"\"\"\n    Derives and implements the computation of the second virial coefficient for a\n    Lennard-Jones fluid and finds the reduced Boyle temperature.\n    \"\"\"\n\n    def compute_B2_star(T_star):\n        \"\"\"\n        Computes the reduced second virial coefficient B2*(T*) for a given\n        reduced temperature T*.\n\n        Args:\n            T_star (float): The reduced temperature, k_B*T / epsilon.\n\n        Returns:\n            float: The reduced second virial coefficient, B2 / sigma**3.\n        \"\"\"\n\n        # The integrand is derived from the formal definition of B2:\n        # Integrand(r*) = [exp(-u*(r*)/T*) - 1] * (r*)**2\n        # where u*(r*) = 4 * ((r*)**-12 - (r*)**-6)\n        def integrand(r_star, T_star_arg):\n            \"\"\"\n            Integrand for the B2* calculation.\n            \"\"\"\n            # At r_star = 0, the integrand is zero. While quad is unlikely to\n            # sample at exactly 0, handling this case explicitly is robust.\n            if r_star == 0.0:\n                return 0.0\n            \n            # Pre-calculate expensive powers for efficiency.\n            r_star_inv6 = r_star**(-6)\n            r_star_inv12 = r_star_inv6**2\n\n            # The dimensionless potential energy term in the exponential.\n            u_star_over_T_star = (4.0 / T_star_arg) * (r_star_inv12 - r_star_inv6)\n\n            # Use expm1(x) = exp(x) - 1 for numerical stability when the\n            # argument is close to zero (at large r_star).\n            return expm1(-u_star_over_T_star) * r_star**2\n\n        # Perform the numerical integration from r*=0 to infinity.\n        # The absolute error tolerance for the integral is set to a small\n        # value (1e-12) to ensure the final absolute error in B2* is below\n        # the required 1e-8. The error in B2* is 2*pi times the error from quad.\n        integral_val, _ = quad(\n            integrand, 0, np.inf, args=(T_star,),\n            epsabs=1e-12, epsrel=1e-12, limit=200\n        )\n\n        # The full expression for B2_star includes the prefactor -2*pi.\n        B2_star = -2.0 * np.pi * integral_val\n        return B2_star\n\n    # Test suite: defined reduced temperatures for calculation.\n    test_cases_T_star = [0.8, 2.0, 6.0, 100.0]\n\n    results = []\n    # Calculate B2* for each specified temperature.\n    for T_s in test_cases_T_star:\n        b2_val = compute_B2_star(T_s)\n        results.append(b2_val)\n\n    # Find the reduced Boyle Temperature where B2*(T*) = 0.\n    # The problem provides a valid bracket [2.5, 5.0].\n    # At T*<T_B*, B2*<0. At T*>T_B*, B2*>0.\n    bracket = [2.5, 5.0]\n\n    # Use a robust bracketing root-finder (Brent's method).\n    # The absolute tolerance for the root (xtol) is set to 1e-6 as required.\n    boyle_temp_result = root_scalar(\n        compute_B2_star,\n        bracket=bracket,\n        method='brentq',\n        xtol=1e-6\n    )\n\n    T_B_star = boyle_temp_result.root\n    results.append(T_B_star)\n\n    # Format the results to 8 decimal places as required.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2775099"}, {"introduction": "Interatomic potentials are the engine of molecular dynamics (MD) simulations, but for these large-scale computations to be feasible, long-range interactions must often be truncated at a cutoff distance, $r_{c}$. A naive truncation introduces unphysical discontinuities in energy and forces, leading to severe numerical artifacts and violating energy conservation. This exercise explores the crucial techniques of potential- and force-shifting used in modern simulation packages to ensure that the potential and forces are continuous at the cutoff, a critical skill for maintaining physical realism and numerical stability in any computational study. [@problem_id:2775234]", "problem": "A system of identical atoms interacts via a central pair potential in a Molecular Dynamics (MD) simulation of a condensed phase. Suppose the untruncated pair potential is the Lennard–Jones potential\n$$\n\\phi(r)=4\\varepsilon\\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12}-\\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right],\n$$\nwith pair separation $r$, energy scale $\\varepsilon$, and length scale $\\sigma$. To reduce computational cost, interactions are truncated at a cutoff $r_{c}$, beyond which the pairwise interaction is taken to be zero. You are asked to construct two modified potentials:\n\n(i) a potential-shifted form $\\phi_{s}(r)$ that removes the discontinuity of the potential at $r_{c}$, and\n\n(ii) a force-shifted form $\\phi_{fs}(r)$ that additionally removes the discontinuity of the force at $r_{c}$.\n\nYou must reason from the following principles: (a) the potential energy of a pair at separation $r$ is $\\phi(r)$, (b) the pair force magnitude is $F(r)=-\\dfrac{d\\phi}{dr}$ acting along the line of centers, and (c) in Hamiltonian dynamics with smooth forces, the total energy is conserved in the continuous-time limit, whereas discontinuities in the force can introduce impulsive errors in discrete-time integration.\n\nWhich of the following options gives correct expressions for $\\phi_{s}(r)$ and $\\phi_{fs}(r)$, specifies the correct continuity properties at $r_{c}$, and correctly states the qualitative impact on long-time energy conservation in microcanonical MD (constant total energy) with a finite time step?\n\nA. \n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nwith $\\phi_{s}(r)$ continuous but $F_{s}(r)$ discontinuous at $r_{c}$, and $\\phi_{fs}(r)$ and $F_{fs}(r)$ both continuous at $r_{c}$. In practice, the force-shifted form reduces long-time energy drift relative to the potential-shifted form, but does not guarantee exact energy conservation unless the time step tends to $0$ or a smoother switching function is used.\n\nB.\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\dfrac{r_{c}}{r}\\,\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nand both constructions make the force continuous and therefore guarantee exact total energy conservation for any finite time step.\n\nC.\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c})-\\dfrac{1}{2}(r-r_{c})^{2}\\,\\phi''(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nand because $\\phi_{fs}(r)$ is twice continuously differentiable at $r_{c}$, microcanonical MD exhibits exact total energy conservation at any finite time step.\n\nD.\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})+(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nand the unshifted truncation $\\phi_{s}(r)$ minimizes energy drift because it leaves the force unaltered for $r<r_{c}$, whereas the linear correction in $\\phi_{fs}(r)$ increases energy drift.", "solution": "The problem statement is scientifically valid and well-posed. We shall proceed with a rigorous derivation. The objective is to construct two modified forms of the Lennard-Jones potential, $\\phi(r)$, for use in a Molecular Dynamics simulation where interactions are truncated at a cutoff distance $r_c$. The potential is set to zero for $r \\ge r_c$.\n\nLet the original potential be\n$$\n\\phi(r)=4\\varepsilon\\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12}-\\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right]\n$$\nThe corresponding force magnitude is\n$$\nF(r) = -\\dfrac{d\\phi}{dr} = -4\\varepsilon\\left[-12\\dfrac{\\sigma^{12}}{r^{13}} + 6\\dfrac{\\sigma^6}{r^7}\\right] = 24\\dfrac{\\varepsilon}{\\sigma}\\left[2\\left(\\dfrac{\\sigma}{r}\\right)^{13}-\\left(\\dfrac{\\sigma}{r}\\right)^{7}\\right]\n$$\nA simple truncation sets the potential $\\phi_{trunc}(r) = \\phi(r)$ for $r < r_c$ and $\\phi_{trunc}(r) = 0$ for $r \\ge r_c$. This introduces a discontinuity in the potential at $r_c$ of magnitude $\\phi(r_c)$, unless $\\phi(r_c)=0$ (which is generally not true for a typical $r_c$). This discontinuity in potential energy is physically unsound and leads to infinite forces. In a numerical simulation, particles crossing the cutoff sphere would experience a non-physical impulse, catastrophically violating energy conservation.\n\nOur task is to construct potentials that remedy these issues to varying degrees.\n\n**Construction of the Potential-Shifted Form, $\\phi_s(r)$**\n\nThe first requirement is to construct a potential, $\\phi_s(r)$, that is continuous at $r_c$. For $r \\ge r_c$, the potential is defined as $0$. Thus, we must enforce the condition $\\lim_{r \\to r_c^-} \\phi_s(r) = 0$.\n\nA potential is defined only up to an additive constant, as this does not affect the physical forces derived from it. Therefore, for $r < r_c$, we can define $\\phi_s(r) = \\phi(r) + C$, where $C$ is a constant. Applying the continuity condition:\n$$\n\\lim_{r \\to r_c^-} (\\phi(r) + C) = \\phi(r_c) + C = 0\n$$\nThis requires $C = -\\phi(r_c)$. The potential-shifted form is therefore:\n$$\n\\phi_s(r) =\n\\begin{cases}\n\\phi(r) - \\phi(r_c), & r < r_c \\\\\n0, & r \\ge r_c\n\\end{cases}\n$$\nBy construction, $\\phi_s(r)$ is continuous at $r=r_c$. Let us examine the corresponding force, $F_s(r) = -d\\phi_s/dr$.\nFor $r < r_c$:\n$$\nF_s(r) = -\\dfrac{d}{dr}(\\phi(r) - \\phi(r_c)) = -\\dfrac{d\\phi}{dr} = F(r)\n$$\nFor $r > r_c$, $F_s(r) = 0$.\nAt the cutoff, there is a discontinuity in the force:\n$$\n\\lim_{r \\to r_c^-} F_s(r) = F(r_c) = -\\phi'(r_c)\n$$\nwhile for $r > r_c$, the force is $0$. As long as $\\phi'(r_c) \\neq 0$ (which is true for any typical $r_c$ not at the potential minimum), the force $F_s(r)$ is discontinuous at $r_c$. This force discontinuity leads to impulsive errors in numerical integration algorithms (like Verlet), causing a systematic drift in the total energy over long simulation times.\n\n**Construction of the Force-Shifted Form, $\\phi_{fs}(r)$**\n\nThe second requirement is to construct a potential, $\\phi_{fs}(r)$, such that both the potential itself and the derived force, $F_{fs}(r)$, are continuous at $r_c$. This means we must satisfy two conditions as $r \\to r_c^-$:\n1.  $\\phi_{fs}(r_c) = 0$ (Potential continuity)\n2.  $F_{fs}(r_c) = -\\phi'_{fs}(r_c) = 0$ (Force continuity)\n\nWe are modifying the potential for $r<r_c$. The standard method to achieve this is to subtract a function from $\\phi(r)$ that matches the value and the derivative of $\\phi(r)$ at $r_c$. This is equivalent to subtracting the first-order Taylor expansion of $\\phi(r)$ around $r_c$. Let the correction term be a linear function of $r$, $g(r) = A + B(r-r_c)$. We define $\\phi_{fs}(r) = \\phi(r) - g(r)$ for $r < r_c$.\n\nThe conditions are:\n1.  $\\phi_{fs}(r_c) = \\phi(r_c) - g(r_c) = \\phi(r_c) - A = 0 \\implies A = \\phi(r_c)$.\n2.  $\\phi'_{fs}(r_c) = \\phi'(r_c) - g'(r_c) = \\phi'(r_c) - B = 0 \\implies B = \\phi'(r_c)$.\n\nSo, the function to subtract is $g(r) = \\phi(r_c) + (r-r_c)\\phi'(r_c)$.\nThe resulting force-shifted potential for $r < r_c$ is:\n$$\n\\phi_{fs}(r) = \\phi(r) - [\\phi(r_c) + (r-r_c)\\phi'(r_c)] = \\phi(r) - \\phi(r_c) - (r-r_c)\\phi'(r_c)\n$$\nAnd for $r \\ge r_c$, $\\phi_{fs}(r) = 0$.\nLet us verify the properties.\n- **Potential**: $\\lim_{r \\to r_c^-} \\phi_{fs}(r) = \\phi(r_c) - \\phi(r_c) - (r_c-r_c)\\phi'(r_c) = 0$. Continuous.\n- **Force**: The force for $r < r_c$ is $F_{fs}(r) = -d\\phi_{fs}/dr$.\n$$\nF_{fs}(r) = -\\dfrac{d}{dr} \\left[\\phi(r) - \\phi(r_c) - (r-r_c)\\phi'(r_c)\\right] = -\\left[\\phi'(r) - \\phi'(r_c)\\right] = F(r) - F(r_c)\n$$\nAs $r \\to r_c^-$, $F_{fs}(r) \\to F(r_c) - F(r_c) = 0$. Since $F_{fs}(r)=0$ for $r > r_c$, the force is continuous.\n\n**Impact on Energy Conservation**\n\nIn microcanonical (NVE) simulations with a finite time step $\\Delta t$, total energy is conserved only if the numerical integrator is exact, which is never the case for a general potential. The quality of energy conservation depends on the smoothness of the potential.\n-  **Potential-shifted potential ($\\phi_s$)**: The discontinuity in the force $F_s$ at $r_c$ causes a \"kick\" to particles crossing the cutoff. This introduces a first-order error in energy conservation, leading to significant long-term energy drift.\n-  **Force-shifted potential ($\\phi_{fs}$)**: The force $F_{fs}$ is continuous everywhere ($C^0$). This eliminates the impulsive errors at $r_c$. However, the second derivative of the potential, $\\phi_{fs}''(r) = \\phi''(r)$, is generally discontinuous at $r_c$ because $\\phi_{fs}''(r)=0$ for $r>r_c$. This discontinuity in $\\phi''$ (and thus in higher derivatives) still introduces errors into the numerical integration (e.g., the local truncation error of the Velocity Verlet algorithm depends on $\\phi'''$). Consequently, while the energy conservation is vastly improved compared to the potential-shifted case, it is not exact for a finite $\\Delta t$. A slow drift will remain. Exact conservation is only recovered in the limit $\\Delta t \\to 0$.\n\nNow we evaluate the provided options.\n\n**A.**\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nThis option presents the correct expressions for both $\\phi_s(r)$ and $\\phi_{fs}(r)$ as derived above. It correctly states that $\\phi_s(r)$ is continuous while $F_s(r)$ is not, and that both $\\phi_{fs}(r)$ and $F_{fs}(r)$ are continuous. The statement on energy conservation is also correct: the force-shifted form improves (reduces) energy drift compared to the potential-shifted form, but does not achieve exact conservation for finite $\\Delta t$.\nVerdict: **Correct**.\n\n**B.**\n$$\n\\phi_{s}(r)=\\dots \\quad \\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\dfrac{r_{c}}{r}\\,\\phi(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nThe expression for $\\phi_{fs}(r)$ is incorrect. We calculate its corresponding force for $r < r_c$:\n$F_{fs}(r) = -d/dr [\\phi(r) - r_c\\phi(r_c)r^{-1}] = -\\phi'(r) - r_c\\phi(r_c)r^{-2}$.\nAt $r_c$, this gives $\\lim_{r \\to r_c^-} F_{fs}(r) = -\\phi'(r_c) - \\phi(r_c)/r_c$, which is not zero in general. Thus, this form does not make the force continuous. The concluding statement that both constructions make the force continuous and guarantee exact energy conservation is false on multiple counts.\nVerdict: **Incorrect**.\n\n**C.**\n$$\n\\phi_{s}(r)=\\dots \\quad \\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})-(r-r_{c})\\,\\phi'(r_{c})-\\dfrac{1}{2}(r-r_{c})^{2}\\,\\phi''(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nThis expression for $\\phi_{fs}(r)$ subtracts the second-order Taylor expansion of $\\phi(r)$ at $r_c$. This procedure makes the potential, the force, and the second derivative of the potential continuous at $r_c$. While this is a valid method for creating an even smoother potential (a $C^2$ potential), it is not what is standardly defined as \"force-shifted\" ($C^1$ potential), which is what the problem asks for. More importantly, the claim that this leads to \"exact total energy conservation at any finite time step\" is false. Symplectic integrators are not exact for arbitrary potentials, regardless of the degree of smoothness. Discontinuities in higher-order derivatives still contribute to numerical error.\nVerdict: **Incorrect**.\n\n**D.**\n$$\n\\phi_{s}(r)=\n\\begin{cases}\n\\phi(r), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n\\qquad\n\\phi_{fs}(r)=\n\\begin{cases}\n\\phi(r)-\\phi(r_{c})+(r-r_{c})\\,\\phi'(r_{c}), & r<r_{c},\\\\\n0, & r\\ge r_{c},\n\\end{cases}\n$$\nThe expression given for $\\phi_s(r)$ is the simple, unshifted truncation, which is discontinuous at $r_c$. This fails to satisfy the condition of removing the potential discontinuity. The expression for $\\phi_{fs}(r)$ has a sign error in the linear term; the plus sign should be a minus sign. This incorrect form does not result in a continuous force. The physical reasoning provided is fundamentally flawed: the unshifted truncation has the worst energy conservation due to the potential discontinuity (infinite force), not the best.\nVerdict: **Incorrect**.\n\nTherefore, only option A provides the correct mathematical forms, correctly identifies their continuity properties, and accurately describes the physical consequences for energy conservation in a numerical simulation.", "answer": "$$\\boxed{A}$$", "id": "2775234"}]}