{"hands_on_practices": [{"introduction": "Our exploration begins with the fundamental potential energy landscape of a hydrogen bond. While the Lennard-Jones potential effectively describes general van der Waals interactions, it falls short of capturing the unique strength and directionality of hydrogen bonds. This exercise [@problem_id:123489] introduces a more refined model by augmenting the Lennard-Jones potential with a specific electrostatic term, allowing you to derive the bond's dissociation energy ($D_e$) from first principles and appreciate how competing attractive and repulsive forces establish a stable equilibrium.", "problem": "A simplified one-dimensional model for a hydrogen bond, such as an $\\mathrm{N{-}H\\cdots O}$ bond, describes the interaction potential energy as a function of the distance $r$ between the two heavy atoms (N and O). This potential energy, $U(r)$, is a sum of a van der Waals term and an electrostatic term.\n\n1.  The van der Waals interaction is described by the standard Lennard-Jones (LJ) potential:\n    $$\n    U_{LJ}(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n    $$\n    Here, $\\epsilon$ is the depth of the LJ potential well and $\\sigma$ is the distance at which the LJ potential is zero.\n\n2.  The directional, strong electrostatic character of the hydrogen bond is modeled by an effective attractive potential given by:\n    $$\n    U_{elec}(r) = -\\frac{A}{r^6}\n    $$\n    where $A$ is a positive constant that represents the strength of this specific electrostatic interaction.\n\nThe total potential energy of the N-O interaction is the sum of these two contributions:\n$$\nU(r) = U_{LJ}(r) + U_{elec}(r)\n$$\n\nThe dissociation energy, $D_e$, is defined as the energy required to separate the two heavy atoms from their equilibrium distance, $r_e$, to an infinite distance. Given that the potential energy at infinite separation is zero, the dissociation energy is equal to the negative of the potential energy at the equilibrium distance, i.e., $D_e = -U(r_e)$.\n\nCalculate the dissociation energy $D_e$ for this hydrogen bond model. Express your answer as a closed-form analytical expression in terms of the parameters $\\epsilon$, $\\sigma$, and $A$.", "solution": "The dissociation energy is given by $ D_e = -U(r_e) $, where $ r_e $ is the equilibrium distance satisfying $ \\frac{dU}{dr} \\big|_{r=r_e} = 0 $. The total potential energy is:\n\n$$\nU(r) = 4\\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] - \\frac{A}{r^6}\n$$\n\nRewriting $ U(r) $ in terms of $ r^{-6} $:\n\n$$\nU(r) = 4\\epsilon \\sigma^{12} r^{-12} - 4\\epsilon \\sigma^6 r^{-6} - A r^{-6} = 4\\epsilon \\sigma^{12} (r^{-6})^2 - (4\\epsilon \\sigma^6 + A) r^{-6}\n$$\n\nSet $ x = r^{-6} $, so:\n\n$$\nU = 4\\epsilon \\sigma^{12} x^2 - (4\\epsilon \\sigma^6 + A) x\n$$\n\nThe derivative with respect to $ r $ is:\n\n$$\n\\frac{dU}{dr} = \\frac{dU}{dx} \\frac{dx}{dr} = \\left[ 8\\epsilon \\sigma^{12} x - (4\\epsilon \\sigma^6 + A) \\right] \\cdot (-6 r^{-7})\n$$\n\nAt equilibrium, $ \\frac{dU}{dr} = 0 $, which implies:\n\n$$\n8\\epsilon \\sigma^{12} x_e - (4\\epsilon \\sigma^6 + A) = 0\n$$\n\nwhere $ x_e = r_e^{-6} $. Solving for $ x_e $:\n\n$$\nx_e = \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}}\n$$\n\nNow, evaluate $ U(r_e) $:\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} x_e^2 - (4\\epsilon \\sigma^6 + A) x_e\n$$\n\nSubstitute $ x_e $:\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} \\left( \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}} \\right)^2 - (4\\epsilon \\sigma^6 + A) \\left( \\frac{4\\epsilon \\sigma^6 + A}{8\\epsilon \\sigma^{12}} \\right)\n$$\n\nSimplify:\n\n$$\nU(r_e) = 4\\epsilon \\sigma^{12} \\cdot \\frac{(4\\epsilon \\sigma^6 + A)^2}{64 \\epsilon^2 \\sigma^{24}} - \\frac{(4\\epsilon \\sigma^6 + A)^2}{8\\epsilon \\sigma^{12}} = \\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}} - \\frac{(4\\epsilon \\sigma^6 + A)^2}{8\\epsilon \\sigma^{12}}\n$$\n\n\n$$\nU(r_e) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{\\sigma^{12}} \\left( \\frac{1}{16\\epsilon} - \\frac{1}{8\\epsilon} \\right) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{\\sigma^{12}} \\left( -\\frac{1}{16\\epsilon} \\right) = -\\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}}\n$$\n\nThus, the dissociation energy is:\n\n$$\nD_e = -U(r_e) = \\frac{(4\\epsilon \\sigma^6 + A)^2}{16\\epsilon \\sigma^{12}}\n$$\n\nExpanding the numerator:\n\n$$\n(4\\epsilon \\sigma^6 + A)^2 = 16\\epsilon^2 \\sigma^{12} + 8\\epsilon \\sigma^6 A + A^2\n$$\n\nSo:\n\n$$\nD_e = \\frac{16\\epsilon^2 \\sigma^{12} + 8\\epsilon \\sigma^6 A + A^2}{16\\epsilon \\sigma^{12}} = \\epsilon + \\frac{A}{2\\sigma^6} + \\frac{A^2}{16\\epsilon \\sigma^{12}}\n$$", "answer": "$$\n\\boxed{\\epsilon + \\frac{A}{2\\sigma^{6}} + \\frac{A^{2}}{16\\epsilon \\sigma^{12}}}\n$$", "id": "123489"}, {"introduction": "Having established a model for the bond's static energy, we now investigate its quantum mechanical consequences, which are directly observable in spectroscopy. The formation of a hydrogen bond subtly weakens the covalent bond of the donor group, causing a characteristic \"red-shift\" in its vibrational frequency. In this practice [@problem_id:174548], you will use first-order perturbation theory to model this phenomenon, connecting the abstract concept of a potential energy perturbation to a tangible experimental signature and solidifying your understanding of how quantum mechanics governs molecular vibrations.", "problem": "An isolated $\\mathrm{O{-}H}$ covalent bond is modeled as a one-dimensional quantum harmonic oscillator for the stretching mode. The system has a reduced mass $m$ and a classical angular frequency $\\omega_0$. The potential for this unperturbed system is $V_0(x) = \\frac{1}{2}m\\omega_0^2 x^2$, where $x$ is the displacement of the bond length from its equilibrium value.\n\nWhen this $\\mathrm{O{-}H}$ group participates in a linear hydrogen bond (e.g., $\\mathrm{O{-}H\\cdots A}$, where A is a hydrogen bond acceptor), the potential energy governing the proton's motion along the bond axis is altered. This change is modeled as a perturbation, $V_{pert}(x)$, added to the original potential. The perturbation is given by:\n$$\nV_{pert}(x) = -\\frac{1}{2}\\delta k\\, x^2 + \\beta x^4\n$$\nHere, $\\delta k$ and $\\beta$ are small positive real constants. The $-\\frac{1}{2}\\delta k\\, x^2$ term represents a weakening of the O-H bond (a decrease in its force constant), and the $\\beta x^4$ term is a positive anharmonicity correction that ensures the potential remains bound for large displacements.\n\nUsing first-order time-independent perturbation theory, calculate the shift, $\\Delta\\omega$, in the angular frequency of the fundamental vibrational transition (i.e., the transition from the ground state $n=0$ to the first excited state $n=1$) caused by this perturbation.", "solution": "The unperturbed Hamiltonian is \n$$H_0=\\frac{p^2}{2m}+\\frac12m\\omega_0^2x^2\\,, $$\nwith eigenenergies \n$$E_n^{(0)}=\\hbar\\omega_0\\Bigl(n+\\tfrac12\\Bigr)\\,. $$\n\nThe perturbation is \n$$V_{\\rm pert}(x)=-\\tfrac12\\,\\delta k\\,x^2+\\beta\\,x^4\\,. $$\n\nBy first‐order perturbation theory, the energy shift for level $n$ is\n$$\\Delta E_n=\\langle n|V_{\\rm pert}|n\\rangle\n=-\\tfrac12\\,\\delta k\\,\\langle n|x^2|n\\rangle\n+\\beta\\,\\langle n|x^4|n\\rangle\\,. $$\n\nWe use the standard oscillator matrix elements:\n$$\\langle n|x^2|n\\rangle\n=\\frac{\\hbar}{2m\\omega_0}(2n+1)\\,, $$\n$$\\langle n|x^4|n\\rangle\n=\\Bigl(\\frac{\\hbar}{2m\\omega_0}\\Bigr)^2\\,(3+6n+6n^2)\\,. $$\n\nThus\n$$\\Delta E_0\n=-\\tfrac12\\,\\delta k\\,\\frac{\\hbar}{2m\\omega_0}\n+\\beta\\Bigl(\\frac{\\hbar}{2m\\omega_0}\\Bigr)^2\\,3, $$\n$$\\Delta E_1\n=-\\tfrac12\\,\\delta k\\,\\frac{3\\hbar}{2m\\omega_0}\n+\\beta\\Bigl(\\frac{\\hbar}{2m\\omega_0}\\Bigr)^2\\,15. $$\n\nThe shift in transition energy $E_1-E_0$ is\n$$\\Delta(E_1-E_0)=\\Delta E_1-\\Delta E_0\n=-\\frac{\\hbar\\,\\delta k}{2m\\omega_0}\n+12\\,\\beta\\Bigl(\\frac{\\hbar}{2m\\omega_0}\\Bigr)^2\\,. $$\n\nFinally, the shift in angular frequency of the $0\\to1$ transition is\n$$\n\\Delta\\omega=\\frac{\\Delta(E_1-E_0)}{\\hbar}\n=-\\frac{\\delta k}{2m\\omega_0}\n+12\\,\\beta\\,\\frac{1}{\\hbar}\\Bigl(\\frac{\\hbar}{2m\\omega_0}\\Bigr)^2\n=-\\frac{\\delta k}{2m\\omega_0}\n+\\frac{3\\beta\\hbar}{m^2\\omega_0^2}\\,. $$", "answer": "$$\\boxed{-\\frac{\\delta k}{2m\\omega_0}+\\frac{3\\beta\\hbar}{m^2\\omega_0^2}}$$", "id": "174548"}, {"introduction": "We now transition from the properties of a single bond to the collective dynamics of hydrogen bonds within a fluctuating environment, such as at a liquid-solid interface. The concept of a bond \"lifetime\" is crucial in these systems, but its definition requires careful statistical treatment. This computational practice [@problem_id:2773802] guides you through calculating bond lifetimes from simulated molecular trajectory data using time correlation functions, a cornerstone of statistical mechanics. You will implement both \"continuous\" and \"intermittent\" lifetime definitions, gaining practical data analysis skills and a nuanced appreciation for the dynamic nature of hydrogen bonding.", "problem": "You are given a discrete-time representation of Hydrogen Bond (HB) existence at a liquid–solid interface. For an ensemble of donor–acceptor pairs indexed by $\\alpha$, define the binary indicator function $h_{\\alpha}(t)$ to be $1$ if the specific HB between pair $\\alpha$ exists at time $t$, and $0$ otherwise. Consider a uniformly sampled trajectory of duration $N$ time steps, with sampling period $\\Delta t$, so that $t_n = n\\,\\Delta t$ for $n \\in \\{0,1,\\dots,N-1\\}$. All arrays provided below are already filtered to include only interfacial HBs.\n\nUsing only the following foundations:\n- The definition of a two-time correlation as an average over an ensemble conditioned on the initial state.\n- The Riemann sum approximation of a time integral by a discrete sum with spacing $\\Delta t$.\n\nDefine the intermittent and continuous hydrogen bond time correlation functions for lag index $k \\in \\{0,1,\\dots,N-1\\}$ as conditional expectations over all valid time origins and pairs:\n- Intermittent correlation $C_{\\mathrm{i}}(k\\,\\Delta t)$ is the conditional probability that a HB exists at $t_{n+k}$ given that it existed at $t_n$, averaged over all pairs and over all valid time origins $n$ with $n+k \\le N-1$. Formally,\n$$\nC_{\\mathrm{i}}(k\\,\\Delta t) \\equiv \\left\\langle \\frac{h_{\\alpha}(t_{n+k})}{1} \\,\\middle|\\, h_{\\alpha}(t_n)=1 \\right\\rangle_{\\alpha,n}.\n$$\n- Continuous survival correlation $C_{\\mathrm{c}}(k\\,\\Delta t)$ is the conditional probability that a HB remains unbroken over the entire interval $[t_n,t_{n+k}]$ given that it existed at $t_n$, averaged over all pairs and valid time origins. Using the product to enforce uninterrupted bonding,\n$$\nC_{\\mathrm{c}}(k\\,\\Delta t) \\equiv \\left\\langle \\prod_{s=0}^{k} h_{\\alpha}(t_{n+s}) \\,\\middle|\\, h_{\\alpha}(t_n)=1 \\right\\rangle_{\\alpha,n}.\n$$\nIf there are no valid time origins for a given $k$ (i.e., no $\\alpha,n$ such that $h_{\\alpha}(t_n)=1$ and $n+k \\le N-1$), define $C_{\\mathrm{i}}(k\\,\\Delta t)=0$ and $C_{\\mathrm{c}}(k\\,\\Delta t)=0$.\n\nDefine the average HB lifetime as the time integral of the correlation function,\n$$\n\\tau \\equiv \\int_{0}^{\\infty} C(t)\\,dt,\n$$\nand estimate it from the discrete trajectory as the Riemann sum\n$$\n\\tau \\approx \\sum_{k=0}^{N-1} C(k\\,\\Delta t)\\,\\Delta t,\n$$\ncomputed separately for the intermittent and continuous definitions.\n\nImplement a program that, for each provided test case, computes the intermittent and continuous lifetimes using the definitions above. Express all final lifetimes in picoseconds (ps), rounded to six decimal places.\n\nInput is embedded directly in the program as a set of test cases. Each test case specifies $\\Delta t$ (in ps) and a list of HB indicator sequences, one per pair, each of length $N$. Use exactly the following test suite:\n\n- Test case A (happy path, intermittent rebonding):\n  - $\\Delta t = 0.5\\,\\mathrm{ps}$\n  - Pairs $M=2$\n  - Trajectories:\n    - Pair $1$: $\\{1,1,0,1,1,0\\}$\n    - Pair $2$: $\\{0,1,0,1,0,1\\}$\n- Test case B (boundary, always bonded):\n  - $\\Delta t = 0.2\\,\\mathrm{ps}$\n  - Pairs $M=2$\n  - Trajectories:\n    - Pair $1$: $\\{1,1,1,1,1\\}$\n    - Pair $2$: $\\{1,1,1,1,1\\}$\n- Test case C (boundary, never bonded):\n  - $\\Delta t = 0.5\\,\\mathrm{ps}$\n  - Pairs $M=3$\n  - Trajectories:\n    - Pair $1$: $\\{0,0,0,0\\}$\n    - Pair $2$: $\\{0,0,0,0\\}$\n    - Pair $3$: $\\{0,0,0,0\\}$\n- Test case D (edge, immediate break without rebonding):\n  - $\\Delta t = 1.0\\,\\mathrm{ps}$\n  - Pairs $M=1$\n  - Trajectory:\n    - Pair $1$: $\\{1,0,0,0\\}$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with values ordered as follows:\n- For each test case in the order A, B, C, D, append first the continuous lifetime $\\tau_{\\mathrm{c}}$ and then the intermittent lifetime $\\tau_{\\mathrm{i}}$, both in ps and each rounded to six decimal places.\n- Thus the output has the flat structure $[\\tau_{\\mathrm{c}}^{\\mathrm{A}},\\tau_{\\mathrm{i}}^{\\mathrm{A}},\\tau_{\\mathrm{c}}^{\\mathrm{B}},\\tau_{\\mathrm{i}}^{\\mathrm{B}},\\tau_{\\mathrm{c}}^{\\mathrm{C}},\\tau_{\\mathrm{i}}^{\\mathrm{C}},\\tau_{\\mathrm{c}}^{\\mathrm{D}},\\tau_{\\mathrm{i}}^{\\mathrm{D}}]$ with no spaces.", "solution": "```python\nimport numpy as np\n\ndef calculate_lifetimes(trajectories: list[list[int]], delta_t: float) -> tuple[float, float]:\n    \"\"\"\n    Computes the continuous and intermittent HB lifetimes from trajectory data.\n\n    Args:\n        trajectories: A list of lists, where each inner list is a binary\n                      indicator sequence h_alpha(t) for a donor-acceptor pair.\n        delta_t: The time step between trajectory frames, in picoseconds.\n\n    Returns:\n        A tuple containing (tau_c, tau_i), the continuous and intermittent\n        lifetimes in picoseconds.\n    \"\"\"\n    if not trajectories or not trajectories[0]:\n        return 0.0, 0.0\n\n    h = np.array(trajectories, dtype=np.int8)\n    num_pairs, num_steps = h.shape\n\n    C_intermittent = np.zeros(num_steps, dtype=np.float64)\n    C_continuous = np.zeros(num_steps, dtype=np.float64)\n\n    for k in range(num_steps):\n        numerator_i = 0\n        numerator_c = 0\n        denominator = 0\n        \n        # The maximum valid time origin index 'n' for a given lag 'k'\n        max_n = num_steps - 1 - k\n        if max_n < 0:\n            continue\n\n        for alpha in range(num_pairs):\n            for n in range(max_n + 1):\n                # Condition: HB exists at the time origin t_n\n                if h[alpha, n] == 1:\n                    denominator += 1\n                    \n                    # Intermittent case: check for HB existence at t_{n+k}\n                    if h[alpha, n + k] == 1:\n                        numerator_i += 1\n                        \n                    # Continuous case: check for uninterrupted HB from t_n to t_{n+k}\n                    # The product is 1 if and only if all elements are 1.\n                    if np.all(h[alpha, n : n + k + 1] == 1):\n                        numerator_c += 1\n                        \n        if denominator > 0:\n            C_intermittent[k] = numerator_i / denominator\n            C_continuous[k] = numerator_c / denominator\n        # If denominator is 0, correlation is defined as 0. Arrays are pre-filled with 0.\n\n    # Calculate lifetimes using Riemann sum approximation\n    tau_i = np.sum(C_intermittent) * delta_t\n    tau_c = np.sum(C_continuous) * delta_t\n    \n    return tau_c, tau_i\n\ndef solve():\n    \"\"\"\n    Runs the predefined test suite and prints the results in the specified format.\n    \"\"\"\n    test_cases = {\n        'A': {\n            'delta_t': 0.5,\n            'trajectories': [\n                [1, 1, 0, 1, 1, 0],\n                [0, 1, 0, 1, 0, 1]\n            ]\n        },\n        'B': {\n            'delta_t': 0.2,\n            'trajectories': [\n                [1, 1, 1, 1, 1],\n                [1, 1, 1, 1, 1]\n            ]\n        },\n        'C': {\n            'delta_t': 0.5,\n            'trajectories': [\n                [0, 0, 0, 0],\n                [0, 0, 0, 0],\n                [0, 0, 0, 0]\n            ]\n        },\n        'D': {\n            'delta_t': 1.0,\n            'trajectories': [\n                [1, 0, 0, 0]\n            ]\n        }\n    }\n\n    results = []\n    case_order = ['A', 'B', 'C', 'D']\n\n    for case_id in case_order:\n        case = test_cases[case_id]\n        tau_c, tau_i = calculate_lifetimes(case['trajectories'], case['delta_t'])\n        \n        # Append results formatted to six decimal places\n        results.append(f\"{tau_c:.6f}\")\n        results.append(f\"{tau_i:.6f}\")\n        \n    # Print the final output in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "answer": "[0.690476,1.345238,1.000000,1.000000,0.000000,0.000000,1.000000,1.000000]", "id": "2773802"}]}