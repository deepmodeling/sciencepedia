{"hands_on_practices": [{"introduction": "The ability to determine thermodynamic potentials from fundamental, measurable data is a cornerstone of physical science. This practice reinforces this skill by asking you to derive the temperature dependence of the standard chemical potential, $\\mu^{\\circ}(T)$, starting from an empirical model for the molar heat capacity, $C_{p,m}(T)$. By mastering the integration of fundamental thermodynamic relations, you will solidify your understanding of how potentials like $\\mu$ and state functions like entropy $s_m$ are interconnected [@problem_id:2795473].", "problem": "A molecular species $X$ in the gas phase is used as a vapor-phase probe of adsorption equilibria on a nanostructured surface. Over the temperature range of interest, $X$ behaves as an ideal gas at a fixed standard pressure $p^{\\circ}$ (no phase transitions). The molar heat capacity at constant pressure is modeled by\n$$\nC_{p,m}(T) = R\\left(a + b\\,T + c\\,T^{-2}\\right),\n$$\nwhere $R$ is the molar gas constant and $a$, $b$, and $c$ are temperature-independent, dimensionless parameters. Let $T_0$ be a reference temperature at the same pressure $p^{\\circ}$. You are given the standard chemical potential $\\mu^{\\circ}(T_0)$ and the standard molar entropy $s_m^{\\circ}(T_0)$ of $X$ at $T_0$.\n\nStarting only from fundamental thermodynamic relations for a pure substance at fixed pressure and ideal-gas behavior, derive a closed-form analytic expression, in terms of $T$, $T_0$, $R$, $a$, $b$, $c$, and $s_m^{\\circ}(T_0)$, for the temperature dependence of the standard chemical potential relative to the reference,\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0).\n$$\nExpress your final result as a single analytic expression. No numerical evaluation is required, and you should not introduce any additional empirical formulas beyond fundamental definitions and the given model for $C_{p,m}(T)$. Assume all integrals are taken along a reversible path at fixed pressure $p^{\\circ}$ where the ideal-gas model applies. The final answer must be a single closed-form expression; do not include units in your final boxed answer.", "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in chemical thermodynamics that requires the application of fundamental principles to derive a specific relationship. All necessary data and functional forms are provided.\n\nThe derivation starts from the fundamental thermodynamic relation for the molar Gibbs free energy, $\\mu$, of a pure substance:\n$$\nd\\mu = v_m dP - s_m dT\n$$\nwhere $v_m$ is the molar volume and $s_m$ is the molar entropy. The problem specifies conditions at a fixed standard pressure, $p^{\\circ}$, so $dP = 0$. The relation for the standard chemical potential, $\\mu^{\\circ}$, becomes:\n$$\n\\left(\\frac{\\partial \\mu^{\\circ}}{\\partial T}\\right)_{p^{\\circ}} = -s_m^{\\circ}(T)\n$$\nTo find the change in the standard chemical potential from a reference temperature $T_0$ to a temperature $T$, we integrate this expression:\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = \\int_{T_0}^{T} \\left(\\frac{\\partial \\mu^{\\circ}}{\\partial T'}\\right)_{p^{\\circ}} dT' = -\\int_{T_0}^{T} s_m^{\\circ}(T') dT'\n$$\nThe standard molar entropy, $s_m^{\\circ}(T)$, is not constant but depends on temperature. Its temperature dependence is related to the molar heat capacity at constant pressure, $C_{p,m}$, by the relation:\n$$\nC_{p,m}(T) = T \\left(\\frac{\\partial s_m}{\\partial T}\\right)_p\n$$\nFor standard-state quantities, this is $C_{p,m}^{\\circ}(T) = T (\\frac{\\partial s_m^{\\circ}}{\\partial T})_{p^{\\circ}}$. Rearranging and integrating from $T_0$ to $T$ gives the expression for the standard molar entropy at any temperature $T$:\n$$\ns_m^{\\circ}(T) = s_m^{\\circ}(T_0) + \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT'\n$$\nSubstituting this into the integral for the chemical potential difference yields:\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -\\int_{T_0}^{T} \\left( s_m^{\\circ}(T_0) + \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right) dT'\n$$\nThis can be separated into two parts:\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0) \\int_{T_0}^{T} dT' - \\int_{T_0}^{T} \\left( \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right) dT'\n$$\nThe first term is simply $-s_m^{\\circ}(T_0)(T-T_0)$. The second term is a double integral. We can evaluate it more efficiently by using integration by parts on the outer integral, setting $u = \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT''$ and $dv = dT'$. This gives $du = \\frac{C_{p,m}^{\\circ}(T')}{T'} dT'$ and $v=T'$. The definite integral becomes:\n$$\n\\int_{T_0}^{T} u \\, dv = [uv]_{T_0}^{T} - \\int_{T_0}^{T} v \\, du = \\left[ T' \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right]_{T_0}^{T} - \\int_{T_0}^{T} T' \\frac{C_{p,m}^{\\circ}(T')}{T'} dT'\n$$\n$$\n= \\left( T \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' \\right) - \\left( T_0 \\int_{T_0}^{T_0} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' \\right) - \\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT'\n$$\nSince the integral from $T_0$ to $T_0$ is zero, the double integral simplifies to:\n$$\n\\int_{T_0}^{T} \\left( \\int_{T_0}^{T'} \\frac{C_{p,m}^{\\circ}(T'')}{T''} dT'' \\right) dT' = T \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' - \\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT'\n$$\nSubstituting this back into the expression for the chemical potential difference gives:\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0)(T-T_0) - T \\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' + \\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT'\n$$\nNow we must evaluate the two integrals involving $C_{p,m}^{\\circ}(T')$. The problem provides $C_{p,m}(T) = R(a + bT + cT^{-2})$.\nThe first integral is:\n$$\n\\int_{T_0}^{T} \\frac{C_{p,m}^{\\circ}(T')}{T'} dT' = R \\int_{T_0}^{T} \\left(\\frac{a}{T'} + b + cT'^{-3}\\right) dT' = R \\left[ a\\ln(T') + bT' - \\frac{c}{2}T'^{-2} \\right]_{T_0}^{T}\n$$\n$$\n= R \\left( a\\ln\\left(\\frac{T}{T_0}\\right) + b(T-T_0) - \\frac{c}{2}\\left(\\frac{1}{T^2} - \\frac{1}{T_0^2}\\right) \\right)\n$$\nThe second integral is:\n$$\n\\int_{T_0}^{T} C_{p,m}^{\\circ}(T') dT' = R \\int_{T_0}^{T} \\left(a + bT' + cT'^{-2}\\right) dT' = R \\left[ aT' + \\frac{b}{2}T'^2 - cT'^{-1} \\right]_{T_0}^{T}\n$$\n$$\n= R \\left( a(T-T_0) + \\frac{b}{2}(T^2-T_0^2) - c\\left(\\frac{1}{T} - \\frac{1}{T_0}\\right) \\right)\n$$\nSubstituting these results into the equation for $\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0)$:\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0)(T-T_0) - TR\\left( a\\ln\\frac{T}{T_0} + b(T-T_0) - \\frac{c}{2}\\left(\\frac{1}{T^2}-\\frac{1}{T_0^2}\\right) \\right) + R\\left( a(T-T_0) + \\frac{b}{2}(T^2-T_0^2) - c\\left(\\frac{1}{T}-\\frac{1}{T_0}\\right) \\right)\n$$\nWe group the terms by the parameters $a$, $b$, and $c$:\nTerm with $a$:\n$$\nRa\\left( (T-T_0) - T\\ln\\frac{T}{T_0} \\right) = Ra\\left( T-T_0 - T\\ln\\frac{T}{T_0} \\right)\n$$\nTerm with $b$:\n$$\nRb\\left( \\frac{1}{2}(T^2-T_0^2) - T(T-T_0) \\right) = Rb(T-T_0)\\left( \\frac{1}{2}(T+T_0) - T \\right) = Rb(T-T_0)\\left( \\frac{T_0-T}{2} \\right) = -\\frac{Rb}{2}(T-T_0)^2\n$$\nTerm with $c$:\n$$\nRc\\left( - \\left(\\frac{1}{T}-\\frac{1}{T_0}\\right) + \\frac{T}{2}\\left(\\frac{1}{T^2}-\\frac{1}{T_0^2}\\right) \\right) = Rc\\left( - \\frac{T_0-T}{TT_0} + \\frac{T_0^2-T^2}{2T_0^2T} \\right)\n$$\n$$\n= Rc(T-T_0)\\left( \\frac{1}{TT_0} - \\frac{T+T_0}{2T_0^2T} \\right) = Rc(T-T_0)\\left( \\frac{2T_0 - (T+T_0)}{2T_0^2T} \\right) = Rc(T-T_0)\\left( \\frac{T_0-T}{2T_0^2T} \\right) = -\\frac{Rc}{2}\\frac{(T-T_0)^2}{TT_0^2}\n$$\nCombining all terms yields the final expression:\n$$\n\\mu^{\\circ}(T) - \\mu^{\\circ}(T_0) = -s_m^{\\circ}(T_0)(T-T_0) + R \\left[ a\\left(T-T_0 - T\\ln\\frac{T}{T_0}\\right) - \\frac{b}{2}(T-T_0)^2 - \\frac{c}{2}\\frac{(T-T_0)^2}{TT_0^2} \\right]\n$$\nThis is the required closed-form analytic expression.", "answer": "$$\n\\boxed{-s_m^{\\circ}(T_0)(T-T_0) + R \\left( a\\left(T-T_0 - T\\ln\\frac{T}{T_0}\\right) - \\frac{b}{2}(T-T_0)^2 - \\frac{c(T-T_0)^2}{2TT_0^2} \\right)}\n$$", "id": "2795473"}, {"introduction": "The chemical potential is a powerful concept for understanding how external fields, such as mechanical stress, influence equilibrium in materials. This problem explores the mechano-chemical effect on solute solubility in a crystalline solid, a critical phenomenon in fields from metallurgy to geophysics. By applying the Larché–Cahn framework, you will quantify how hydrostatic pressure alters the solubility limit by adding a mechanical work term, $p\\Delta\\Omega$, to the chemical potential, providing a tangible example of Le Châtelier's principle in stressed solids [@problem_id:2795421].", "problem": "A dilute substitutional solute species $B$ dissolves in a crystalline host $A$ to form a solid solution. Consider a macroscopic, homogeneous single crystal of $A$ under a uniform hydrostatic pressure $p$ (taken positive in compression). The temperature is fixed at $T$, and the solute is sufficiently dilute that its activity can be taken equal to its atomic fraction $c$.\n\nAssume that introducing one solute atom $B$ in place of a host atom $A$ at fixed hydrostatic pressure $p$ changes the crystal’s volume by the solute’s misfit (formation) volume $\\Delta \\Omega$ (a constant, independent of $c$), so that the mechanical contribution to the Gibbs free energy change is $p\\,\\Delta \\Omega$. The relevant thermodynamic potential under fixed temperature and hydrostatic pressure is the Gibbs free energy $G(T,p,N_A,N_B)$, and the chemical potential of $B$ in the solid is defined by $\\mu_B=\\left(\\partial G/\\partial N_B\\right)_{T,p,N_A}$.\n\nAt $p=0$, the stress-free solubility limit (equilibrium atomic fraction of $B$) at temperature $T$ is known to be $c_s^{(0)}$. When the hydrostatic pressure $p$ is applied, the equilibrium solubility adjusts to $c_s(p)$ such that the solute’s chemical potential in the solid equals that of the same ideal reference (reservoir) that defines $c_s^{(0)}$.\n\nStarting only from the definitions above and the ideal mixing assumption for $B$ in the dilute limit, derive a closed-form expression for $c_s(p)$ in terms of $c_s^{(0)}$, $p$, $\\Delta \\Omega$, $k_B$, and $T$ by invoking the Larché–Cahn framework for the chemical potential of a solute in a stressed solid. Then evaluate $c_s(p)$ numerically for the following parameters:\n- Temperature $T = 800\\ \\mathrm{K}$,\n- Hydrostatic pressure $p = 1.50 \\times 10^{9}\\ \\mathrm{Pa}$,\n- Misfit (formation) volume $\\Delta \\Omega = 0.80 \\times 10^{-29}\\ \\mathrm{m^3}$,\n- Zero-pressure solubility limit $c_s^{(0)} = 1.00 \\times 10^{-3}$ (atomic fraction),\n- Boltzmann constant $k_B = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$.\n\nExpress the final answer as the atomic fraction $c_s(p)$ and round your result to three significant figures. The answer must be reported as a pure number (atomic fraction, no units).", "solution": "The problem requires the derivation of an expression for the pressure-dependent solubility limit $c_s(p)$ of a dilute substitutional solute $B$ in a host crystal $A$, and its subsequent numerical evaluation.\n\nThe validation of the problem statement is performed first.\n\nStep 1: Extract Givens.\n- System: Dilute substitutional solute $B$ in a crystalline host $A$.\n- Conditions: Constant temperature $T$, uniform hydrostatic pressure $p > 0$.\n- Approximations: Solute activity is equal to its atomic fraction $c$. Misfit volume $\\Delta \\Omega$ is constant.\n- Definitions: Mechanical contribution to Gibbs free energy change per solute is $p\\,\\Delta \\Omega$. The thermodynamic potential is the Gibbs free energy $G(T,p,N_A,N_B)$. The chemical potential of the solute is $\\mu_B=\\left(\\partial G/\\partial N_B\\right)_{T,p,N_A}$.\n- Boundary/Equilibrium Conditions: At $p=0$, the equilibrium solubility is $c_s^{(0)}$. At pressure $p$, the equilibrium solubility is $c_s(p)$. Both equilibria are established with respect to the same ideal reference reservoir, implying the chemical potential of the solute in the reservoir, $\\mu_{res}$, is constant.\n- Required framework: Larché–Cahn framework for the chemical potential of a solute in a stressed solid.\n- Numerical parameters: $T = 800\\ \\mathrm{K}$, $p = 1.50 \\times 10^{9}\\ \\mathrm{Pa}$, $\\Delta \\Omega = 0.80 \\times 10^{-29}\\ \\mathrm{m^3}$, $c_s^{(0)} = 1.00 \\times 10^{-3}$, $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded. It addresses a standard topic in materials thermodynamics—the effect of pressure on solubility, known as the Le Châtelier principle applied to solid solutions. The Larché–Cahn theory is the appropriate and established framework for this analysis. The problem is well-posed, providing a clear set of assumptions (ideal dilute solution, constant misfit volume) and all necessary data for both the analytical derivation and numerical calculation. The language is objective and precise. The provided numerical values are physically realistic for a solid-state system under high pressure. The problem is self-contained and free of contradictions or ambiguities.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A solution will be developed.\n\nThe chemical potential $\\mu_B$ of the solute species $B$ within the solid host $A$ at temperature $T$, pressure $p$, and concentration $c$ is the sum of three contributions as specified or implied by the problem statement:\n$1$. A standard chemical potential $\\mu_B^0(T)$, which depends on temperature but is independent of pressure and concentration. This term represents the state of a solute atom in the host lattice at a reference pressure (here, $p=0$) and reference concentration.\n$2$. A contribution from the entropy of mixing. For a dilute ideal solution, where activity is taken as the atomic fraction $c$, this term is $k_B T \\ln(c)$.\n$3$. A mechanical work term due to the interaction of the solute's misfit volume $\\Delta \\Omega$ with the applied hydrostatic pressure $p$. The problem explicitly gives this contribution as $p \\Delta \\Omega$ per solute atom. A positive $\\Delta \\Omega$ under compressive pressure ($p>0$) increases the energy of the system.\n\nCombining these terms, the chemical potential of the solute $B$ in the solid solution is given by:\n$$\n\\mu_B(T, p, c) = \\mu_B^0(T) + k_B T \\ln(c) + p \\Delta \\Omega\n$$\nThis expression is consistent with the Larché–Cahn framework under hydrostatic stress.\n\nThe problem states that the solubility limit is determined by equilibrium with an external solute reservoir. Let the chemical potential of this reservoir be $\\mu_{res}$. The equilibrium condition is $\\mu_B = \\mu_{res}$.\n\nAt zero pressure ($p=0$), the equilibrium solubility is $c_s^{(0)}$. The equilibrium condition is:\n$$\n\\mu_{res} = \\mu_B(T, 0, c_s^{(0)}) = \\mu_B^0(T) + k_B T \\ln(c_s^{(0)}) + (0)\\Delta \\Omega\n$$\n$$\n\\mu_{res} = \\mu_B^0(T) + k_B T \\ln(c_s^{(0)})\n$$\n\nWhen a hydrostatic pressure $p$ is applied, the solubility adjusts to a new value $c_s(p)$. The system reaches equilibrium with the *same* reservoir. Thus, the equilibrium condition is:\n$$\n\\mu_{res} = \\mu_B(T, p, c_s(p)) = \\mu_B^0(T) + k_B T \\ln(c_s(p)) + p \\Delta \\Omega\n$$\n\nSince $\\mu_{res}$ is the same in both cases, we can equate the two expressions for the chemical potential of the solute in the solid:\n$$\n\\mu_B^0(T) + k_B T \\ln(c_s^{(0)}) = \\mu_B^0(T) + k_B T \\ln(c_s(p)) + p \\Delta \\Omega\n$$\n\nThe standard potential term $\\mu_B^0(T)$ cancels from both sides:\n$$\nk_B T \\ln(c_s^{(0)}) = k_B T \\ln(c_s(p)) + p \\Delta \\Omega\n$$\n\nWe now solve for $c_s(p)$. Rearranging the terms, we get:\n$$\nk_B T \\left( \\ln(c_s^{(0)}) - \\ln(c_s(p)) \\right) = p \\Delta \\Omega\n$$\nUsing the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$\nk_B T \\ln\\left(\\frac{c_s^{(0)}}{c_s(p)}\\right) = p \\Delta \\Omega\n$$\n$$\n\\ln\\left(\\frac{c_s^{(0)}}{c_s(p)}\\right) = \\frac{p \\Delta \\Omega}{k_B T}\n$$\nExponentiating both sides yields:\n$$\n\\frac{c_s^{(0)}}{c_s(p)} = \\exp\\left(\\frac{p \\Delta \\Omega}{k_B T}\\right)\n$$\nFinally, solving for $c_s(p)$, we obtain the required closed-form expression:\n$$\nc_s(p) = c_s^{(0)} \\exp\\left(-\\frac{p \\Delta \\Omega}{k_B T}\\right)\n$$\n\nNow, we must evaluate this expression numerically using the provided parameter values.\nFirst, we compute the dimensionless exponent $\\frac{p \\Delta \\Omega}{k_B T}$.\nThe mechanical energy term in the numerator is:\n$$\np \\Delta \\Omega = (1.50 \\times 10^{9}\\ \\mathrm{Pa}) \\times (0.80 \\times 10^{-29}\\ \\mathrm{m^3}) = 1.2 \\times 10^{-20}\\ \\mathrm{J}\n$$\nThe thermal energy term in the denominator is:\n$$\nk_B T = (1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}) \\times (800\\ \\mathrm{K}) = 1.1045192 \\times 10^{-20}\\ \\mathrm{J}\n$$\nThe ratio is:\n$$\n\\frac{p \\Delta \\Omega}{k_B T} = \\frac{1.2 \\times 10^{-20}\\ \\mathrm{J}}{1.1045192 \\times 10^{-20}\\ \\mathrm{J}} \\approx 1.08645\n$$\nNow we substitute this value into the expression for $c_s(p)$:\n$$\nc_s(p) = c_s^{(0)} \\exp\\left(-\\frac{p \\Delta \\Omega}{k_B T}\\right)\n$$\n$$\nc_s(p) \\approx (1.00 \\times 10^{-3}) \\times \\exp(-1.08645)\n$$\n$$\nc_s(p) \\approx (1.00 \\times 10^{-3}) \\times 0.33742\n$$\n$$\nc_s(p) \\approx 3.3742 \\times 10^{-4}\n$$\nThe problem requires the result to be rounded to three significant figures.\n$$\nc_s(p) \\approx 3.37 \\times 10^{-4}\n$$\nThis is the final numerical answer, representing the atomic fraction.", "answer": "$$\n\\boxed{3.37 \\times 10^{-4}}\n$$", "id": "2795421"}, {"introduction": "Modern materials science heavily relies on computational methods to probe thermodynamic behavior at the nanoscale. This exercise provides a hands-on introduction to analyzing data from Grand Canonical Monte Carlo (GCMC) simulations, a key technique for studying adsorption in nanoporous materials. You will implement statistical reweighting and fluctuation formulas to extract the grand potential $\\Omega(\\mu)$, the adsorption isotherm $\\theta(\\mu)$, and the differential enthalpy of adsorption $h_{\\text{diff}}$ from a single simulation, bridging the gap between statistical mechanics theory and practical, cutting-edge research [@problem_id:2795432].", "problem": "A rigid nanoporous material with identical, non-interacting adsorption sites is studied by Grand Canonical Monte Carlo (GCMC) simulations at constant temperature. The objective is to compute the grand potential as a function of the chemical potential, the adsorption isotherm, and the differential enthalpy of adsorption, using only time-series data sampled at a single reference chemical potential. Your program must implement the required statistical mechanics relations starting from fundamental definitions and produce numerical results for a specified test suite.\n\nFundamental Basis to Use:\n- The grand canonical partition function is defined by $$\\Xi(\\mu,T,V)=\\sum_{\\text{microstates }x}\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right],$$ where $E(x)$ is the energy of microstate $x$, $N(x)$ is the particle number, $\\mu$ is the chemical potential, $T$ is the absolute temperature, $V$ is the volume, and $\\beta=1/\\left(k_{\\mathrm{B}}T\\right)$ with $k_{\\mathrm{B}}$ the Boltzmann constant.\n- The grand potential is defined by $$\\Omega(\\mu,T,V)=-k_{\\mathrm{B}}T\\ln\\Xi(\\mu,T,V).$$\n- The probability of microstate $x$ in the grand canonical ensemble is $$\\mathbb{P}_{\\mu,T}(x)=\\Xi(\\mu,T,V)^{-1}\\,\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right].$$\n- The ensemble average of an observable $A(x)$ is $$\\langle A\\rangle_{\\mu,T}=\\sum_x A(x)\\,\\mathbb{P}_{\\mu,T}(x).$$\n\nSystem model:\n- The material contains $M$ identical and independent adsorption sites. Each occupied site contributes a fixed adsorption energy $\\varepsilon$ per molecule to the total internal energy. The host is rigid. For any microstate $x$, the number of adsorbed molecules $N(x)\\in\\{0,1,2,\\dots,M\\}$ and the internal energy satisfies $U(x)=\\varepsilon\\,N(x)$. No adsorbate–adsorbate interactions are present beyond site exclusion.\n\nSynthetic GCMC time series:\n- For each test case, you will generate a synthetic GCMC time series of length $S$ at a specified reference chemical potential $\\mu_0$ and temperature $T$, consistent with the independent-site model. Use a fixed pseudo-random seed to ensure reproducibility. The resulting time series is an array of samples $\\{(N_i,U_i)\\}_{i=1}^S$, with $U_i=\\varepsilon N_i$.\n\nTasks to perform for each test case:\n1. Using only the time series sampled at $(\\mu_0,T)$, compute the grand potential difference $\\Delta\\Omega(\\mu;\\mu_0)=\\Omega(\\mu,T,V)-\\Omega(\\mu_0,T,V)$ for each target chemical potential $\\mu$ in the test case. Express $\\Delta\\Omega$ in kilojoules per mole.\n2. Compute the adsorption isotherm at each target $\\mu$ as the mean occupancy fraction $\\theta(\\mu)=\\langle N\\rangle_{\\mu,T}/M$, a dimensionless number in $\\left[0,1\\right]$.\n3. Compute the differential enthalpy of adsorption at each target $\\mu$ as the derivative $h_{\\mathrm{diff}}(\\mu)=\\frac{\\mathrm{d}\\langle H\\rangle_{\\mu,T}}{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}$, at constant temperature, where $H$ is the enthalpy of the adsorbed phase in the rigid host. For this rigid, volume-fixed model, take $H\\equiv U$ and estimate $h_{\\mathrm{diff}}(\\mu)$ from the $(N_i,U_i)$ time series by a statistically consistent method based on grand canonical ensemble averages. Express $h_{\\mathrm{diff}}$ in kilojoules per mole.\n\nPhysical constants and units:\n- Use the gas constant $R$ in kilojoules per mole per kelvin, with $R=0.008314462618$ kJ/mol/K, so that $\\beta=1/(RT)$ when energies and chemical potentials are in kilojoules per mole and temperature is in kelvin.\n- All temperatures must be in kelvin, all energies and chemical potentials must be in kilojoules per mole.\n\nSynthetic data generation protocol:\n- For each test case, initialize a pseudo-random number generator with the integer seed $s$ specified in the test case.\n- Generate $S$ independent samples $(N_i,U_i)$ at $(\\mu_0,T)$ consistent with the independent-site model. You may use any correct method implied by the model to draw $N_i$ values, provided the resulting ensemble is grand canonical for $(\\mu_0,T)$ under the independent-site assumptions, and set $U_i=\\varepsilon N_i$.\n\nNumerical stability:\n- Your computation of $\\Delta\\Omega(\\mu;\\mu_0)$ and reweighted ensemble averages must be numerically stable for the test cases. Use log-sum-exp or equivalent stability techniques when handling exponentials in reweighting.\n\nTest suite:\nProvide results for the following three test cases. For each test case, process all target chemical potentials $\\mu$ in the given order.\n\n- Test case $1$:\n  - $M=50$\n  - $\\varepsilon=-10.0$ kJ/mol\n  - $T=300.0$ K\n  - $\\mu_0=-12.0$ kJ/mol\n  - $S=500000$\n  - $s=12345$\n  - Target $\\mu$ values: $\\left[-13.0,-12.0,-11.0\\right]$ kJ/mol\n\n- Test case $2$:\n  - $M=50$\n  - $\\varepsilon=-5.0$ kJ/mol\n  - $T=300.0$ K\n  - $\\mu_0=-5.0$ kJ/mol\n  - $S=500000$\n  - $s=24680$\n  - Target $\\mu$ values: $\\left[-6.0,-5.0,-4.0\\right]$ kJ/mol\n\n- Test case $3$:\n  - $M=30$\n  - $\\varepsilon=-12.0$ kJ/mol\n  - $T=350.0$ K\n  - $\\mu_0=-11.0$ kJ/mol\n  - $S=400000$\n  - $s=98765$\n  - Target $\\mu$ values: $\\left[-12.0,-11.0,-10.0\\right]$ kJ/mol\n\nFinal output specification:\n- For each test case, and for each target $\\mu$ in the order given, produce a list of three floating-point numbers:\n  - First: $\\Delta\\Omega(\\mu;\\mu_0)$ in kJ/mol.\n  - Second: $\\theta(\\mu)$ as a decimal fraction.\n  - Third: $h_{\\mathrm{diff}}(\\mu)$ in kJ/mol.\n- Round each floating-point number to exactly $6$ decimal places.\n- Your program should produce a single line of output containing a list of lists, concatenating the results in the order of the test cases and, within each test case, in the order of the target $\\mu$ values. For example, the printed structure should look like:\n  - $\\left[[x_{1,1},x_{1,2},x_{1,3}],[x_{2,1},x_{2,2},x_{2,3}],\\dots\\right]$\nwhere each bracketed triplet corresponds to one target $\\mu$ in one test case, in the specified order, and each $x_{i,j}$ is a float rounded to $6$ decimals.", "solution": "We begin from the grand canonical ensemble definitions. The grand canonical partition function is $\\Xi(\\mu,T,V)=\\sum_{x}\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right]$, with $\\beta=1/\\left(k_{\\mathrm{B}}T\\right)$. The grand potential is $\\Omega(\\mu,T,V)=-k_{\\mathrm{B}}T\\ln\\Xi(\\mu,T,V)$. The probability of a microstate $x$ is $\\mathbb{P}_{\\mu,T}(x)=\\Xi(\\mu,T,V)^{-1}\\,\\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right]$, and the ensemble average is $\\langle A\\rangle_{\\mu,T}=\\sum_x A(x)\\,\\mathbb{P}_{\\mu,T}(x)$.\n\nFor a rigid host and a non-interacting independent-site model with $M$ identical sites and per-particle adsorption energy $\\varepsilon$, the energy of a microstate with $N$ occupied sites is $U(x)=\\varepsilon N(x)$, with $N(x)\\in\\{0,1,\\dots,M\\}$. Because sites are identical and independent, the grand partition function factorizes, leading to a binomial form for the particle number distribution at any $(\\mu,T)$; specifically, each site is occupied with probability $p(\\mu,T)=\\frac{1}{1+\\exp\\!\\left[-\\beta\\left(\\mu-\\varepsilon\\right)\\right]}$, so that $N\\sim\\mathrm{Binomial}\\!\\left(M,p(\\mu,T)\\right)$ and $U=\\varepsilon N$. This provides a precise method for generating synthetic GCMC time series at $(\\mu_0,T)$: draw $N_i$ independently from the binomial law with parameters $(M,p(\\mu_0,T))$ and set $U_i=\\varepsilon N_i$.\n\nWe now derive how to compute the grand potential difference $\\Delta\\Omega(\\mu;\\mu_0)$, the adsorption isotherm $\\theta(\\mu)$, and the differential enthalpy $h_{\\mathrm{diff}}(\\mu)$ using only samples at $(\\mu_0,T)$.\n\n1. Grand potential difference via free energy perturbation. Define $\\Xi(\\mu)$ and $\\Xi(\\mu_0)$ at the same temperature and volume. We write\n$$\n\\Xi(\\mu)=\\sum_x \\exp\\!\\left[-\\beta\\left(E(x)-\\mu N(x)\\right)\\right]\n=\\sum_x \\exp\\!\\left[-\\beta\\left(E(x)-\\mu_0 N(x)\\right)\\right]\\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N(x)\\right].\n$$\nRecognizing the normalized probability $\\mathbb{P}_{\\mu_0,T}(x)=\\Xi(\\mu_0)^{-1}\\exp\\!\\left[-\\beta\\left(E(x)-\\mu_0 N(x)\\right)\\right]$, we get the exact identity\n$$\n\\frac{\\Xi(\\mu)}{\\Xi(\\mu_0)}=\\sum_x \\mathbb{P}_{\\mu_0,T}(x)\\,\\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N(x)\\right]=\\left\\langle \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N\\right]\\right\\rangle_{\\mu_0,T}.\n$$\nTherefore,\n$$\n\\Delta\\Omega(\\mu;\\mu_0)=\\Omega(\\mu)-\\Omega(\\mu_0)=-k_{\\mathrm{B}}T\\,\\ln\\frac{\\Xi(\\mu)}{\\Xi(\\mu_0)}=-k_{\\mathrm{B}}T\\,\\ln\\left\\langle \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N\\right]\\right\\rangle_{\\mu_0,T}.\n$$\nUsing per-mole units with the gas constant, we replace $k_{\\mathrm{B}}$ by the gas constant $R$ and $\\beta=1/(RT)$, so that $-k_{\\mathrm{B}}T=-RT$ and the result is in kilojoules per mole when $\\mu$ and $\\varepsilon$ are in kilojoules per mole and $T$ is in kelvin.\n\nTo estimate this from samples $\\{N_i\\}_{i=1}^S$ at $(\\mu_0,T)$, we use the sample mean\n$$\n\\left\\langle \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N\\right]\\right\\rangle_{\\mu_0,T}\\approx \\frac{1}{S}\\sum_{i=1}^S \\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N_i\\right],\n$$\nand compute the logarithm stably using the log-sum-exp trick: let $a_i=\\beta\\left(\\mu-\\mu_0\\right)N_i$ and $a_{\\max}=\\max_i a_i$, then\n$$\n\\ln\\left(\\frac{1}{S}\\sum_{i=1}^S e^{a_i}\\right)\n=a_{\\max}+\\ln\\left(\\frac{1}{S}\\sum_{i=1}^S e^{a_i-a_{\\max}}\\right).\n$$\n\n2. Adsorption isotherm via reweighting. For any observable $A$, its average at $(\\mu,T)$ can be written in terms of samples at $(\\mu_0,T)$:\n$$\n\\langle A\\rangle_{\\mu,T}\n=\\frac{\\sum_x A(x)\\,\\mathbb{P}_{\\mu_0,T}(x)\\,e^{\\beta(\\mu-\\mu_0)N(x)}}{\\sum_x \\mathbb{P}_{\\mu_0,T}(x)\\,e^{\\beta(\\mu-\\mu_0)N(x)}}\n=\\frac{\\left\\langle A\\,e^{\\beta(\\mu-\\mu_0)N}\\right\\rangle_{\\mu_0,T}}{\\left\\langle e^{\\beta(\\mu-\\mu_0)N}\\right\\rangle_{\\mu_0,T}}.\n$$\nThe sample estimator is the ratio of weighted sample means. In particular, for the isotherm we set $A=N$ and compute\n$$\n\\theta(\\mu)=\\frac{\\langle N\\rangle_{\\mu,T}}{M}\\approx \\frac{\\sum_{i=1}^S N_i\\,w_i}{M\\sum_{i=1}^S w_i},\\quad w_i=\\exp\\!\\left[\\beta\\left(\\mu-\\mu_0\\right)N_i\\right],\n$$\nimplemented in a numerically stable fashion by shifting by $a_{\\max}$ and cancelling common factors.\n\n3. Differential enthalpy of adsorption. In the rigid host model, we take $H\\equiv U$. We require\n$$\nh_{\\mathrm{diff}}(\\mu)=\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}.\n$$\nA statistically efficient and exact relation in the grand canonical ensemble connects derivatives with respect to $\\mu$ to covariances. Differentiating the reweighted average with respect to $\\mu$ yields\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\mu}\\langle A\\rangle_{\\mu,T}\n=\\beta\\left(\\langle AN\\rangle_{\\mu,T}-\\langle A\\rangle_{\\mu,T}\\langle N\\rangle_{\\mu,T}\\right)=\\beta\\,\\mathrm{Cov}_{\\mu,T}(A,N).\n$$\nApplying this to $A=U$ and to $A=N$ gives\n$$\n\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}=\\beta\\,\\mathrm{Cov}_{\\mu,T}(U,N),\\qquad\n\\frac{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}=\\beta\\,\\mathrm{Var}_{\\mu,T}(N).\n$$\nTherefore, by the chain rule,\n$$\nh_{\\mathrm{diff}}(\\mu)=\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}\n=\\frac{\\frac{\\mathrm{d}\\langle U\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}}{\\frac{\\mathrm{d}\\langle N\\rangle_{\\mu,T}}{\\mathrm{d}\\mu}}\n=\\frac{\\mathrm{Cov}_{\\mu,T}(U,N)}{\\mathrm{Var}_{\\mu,T}(N)}.\n$$\nThis covariance–variance ratio can be estimated directly from the reweighted ensemble at the target $\\mu$ using the same weights $w_i$ as above:\n$$\n\\langle Q\\rangle_{\\mu,T}\\approx \\frac{\\sum_i Q_i w_i}{\\sum_i w_i},\\quad\n\\mathrm{Var}_{\\mu,T}(N)\\approx \\langle N^2\\rangle_{\\mu,T}-\\langle N\\rangle_{\\mu,T}^2,\\quad\n\\mathrm{Cov}_{\\mu,T}(U,N)\\approx \\langle UN\\rangle_{\\mu,T}-\\langle U\\rangle_{\\mu,T}\\langle N\\rangle_{\\mu,T}.\n$$\nIn our independent-site model, $U=\\varepsilon N$ deterministically, so $\\mathrm{Cov}(U,N)=\\varepsilon\\,\\mathrm{Var}(N)$, yielding the exact result\n$$\nh_{\\mathrm{diff}}(\\mu)=\\varepsilon,\n$$\nindependent of $\\mu$. This provides a stringent validation check for the implementation.\n\nAlgorithmic design:\n- For each test case, compute $\\beta=1/(RT)$ with $R=0.008314462618$ kJ/mol/K and $T$ in kelvin.\n- Generate the synthetic time series at $(\\mu_0,T)$:\n  - Compute the single-site occupancy probability $p(\\mu_0,T)=\\left(1+\\exp\\left[-\\beta(\\mu_0-\\varepsilon)\\right]\\right)^{-1}$.\n  - Draw $S$ samples $N_i\\sim\\mathrm{Binomial}(M,p)$ using the specified seed $s$.\n  - Set $U_i=\\varepsilon N_i$.\n- For each target $\\mu$:\n  - Form $a_i=\\beta(\\mu-\\mu_0)N_i$ and compute $a_{\\max}=\\max_i a_i$.\n  - Compute stabilized weights $\\tilde{w}_i=\\exp(a_i-a_{\\max})$.\n  - Compute the following reweighted expectations using normalized weights $w_i=\\tilde{w}_i/\\sum_j \\tilde{w}_j$:\n    - $\\langle N\\rangle_{\\mu,T}=\\sum_i w_i N_i$, $\\langle U\\rangle_{\\mu,T}=\\sum_i w_i U_i$, $\\langle N^2\\rangle_{\\mu,T}=\\sum_i w_i N_i^2$, $\\langle UN\\rangle_{\\mu,T}=\\sum_i w_i U_i N_i$.\n  - Compute $\\theta(\\mu)=\\langle N\\rangle_{\\mu,T}/M$.\n  - Compute $\\mathrm{Var}(N)=\\langle N^2\\rangle_{\\mu,T}-\\langle N\\rangle_{\\mu,T}^2$ and $\\mathrm{Cov}(U,N)=\\langle UN\\rangle_{\\mu,T}-\\langle U\\rangle_{\\mu,T}\\langle N\\rangle_{\\mu,T}$.\n  - Compute $h_{\\mathrm{diff}}(\\mu)=\\mathrm{Cov}(U,N)/\\mathrm{Var}(N)$ in kJ/mol.\n  - Compute the stabilized sample estimate of $\\Delta\\Omega(\\mu;\\mu_0)$:\n    $$\n    \\Delta\\Omega(\\mu;\\mu_0)=-RT\\left(a_{\\max}+\\ln\\left(\\frac{1}{S}\\sum_{i=1}^S e^{a_i-a_{\\max}}\\right)\\right).\n    $$\n- Round $\\Delta\\Omega(\\mu;\\mu_0)$, $\\theta(\\mu)$, and $h_{\\mathrm{diff}}(\\mu)$ to exactly $6$ decimal places and output them as specified.\n\nExpected qualitative behavior and checks:\n- For test case $1$ with $\\varepsilon=-10.0$ kJ/mol, the differential enthalpy should be approximately $-10.0$ kJ/mol for all target $\\mu$ within sampling noise. Similarly, test case $2$ should yield approximately $-5.0$ kJ/mol, and test case $3$ approximately $-12.0$ kJ/mol.\n- For each test case, the adsorption isotherm $\\theta(\\mu)$ should increase monotonically with $\\mu$.\n- By construction, $\\Delta\\Omega(\\mu_0;\\mu_0)=0$ kJ/mol within numerical precision.\n\nThe implementation follows these principles and uses log-sum-exp stabilization wherever exponentials of $N$ are involved to ensure numerical stability across the specified test suite.", "answer": "[[1.206416, 0.118944, -10.000000], [0.000000, 0.264263, -10.000000], [-1.464670, 0.485141, -10.000000], [3.013539, 0.309075, -5.000000], [0.000000, 0.500840, -5.000000], [-3.003926, 0.690858, -5.000000], [1.348639, 0.222728, -12.000000], [0.000000, 0.364491, -12.000000], [-1.488358, 0.540846, -12.000000]]", "id": "2795432"}]}