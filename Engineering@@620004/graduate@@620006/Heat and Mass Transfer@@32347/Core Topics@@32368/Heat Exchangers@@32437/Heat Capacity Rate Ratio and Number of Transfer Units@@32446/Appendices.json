{"hands_on_practices": [{"introduction": "A common and practical task for an engineer is to characterize the performance of an existing heat exchanger using operational data. This exercise places you in that role, where you will analyze a set of temperature measurements from a counterflow exchanger to determine its intrinsic design parameters. By working backward from process data to find the overall heat transfer conductance ($UA$) and the heat capacity rate ratio ($C_r$), you will solidify your understanding of how effectiveness ($\\varepsilon$) links measured performance to the fundamental characteristics of the equipment [@problem_id:2492772].", "problem": "A steady-state counterflow heat exchanger transfers energy from a hot oil stream to a colder aqueous stream. The following one-pass measurements are taken during operation: hot-stream inlet temperature $T_{h,\\mathrm{in}} = 150\\,^{\\circ}\\mathrm{C}$, hot-stream outlet temperature $T_{h,\\mathrm{out}} = 100\\,^{\\circ}\\mathrm{C}$, cold-stream inlet temperature $T_{c,\\mathrm{in}} = 20\\,^{\\circ}\\mathrm{C}$, and cold-stream outlet temperature $T_{c,\\mathrm{out}} = 80\\,^{\\circ}\\mathrm{C}$. The mass flow rates and constant-pressure specific heats are known: hot stream $\\dot{m}_{h} = 2.0\\,\\mathrm{kg/s}$, $c_{p,h} = 2.4\\,\\mathrm{kJ/(kg\\cdot K)}$; cold stream $\\dot{m}_{c} = 1.0\\,\\mathrm{kg/s}$, $c_{p,c} = 4.0\\,\\mathrm{kJ/(kg\\cdot K)}$. Assume single-phase operation with constant properties, negligible axial conduction, and no heat loss to the surroundings.\n\nUsing only fundamental definitions (overall energy balance, heat capacity rate, and heat exchanger effectiveness) and the standard effectiveness–Number of Transfer Units (NTU) relation appropriate to a counterflow heat exchanger, pose and solve the inverse parameter estimation problem to determine:\n- the overall heat transfer conductance $(UA)$, and\n- the heat capacity rate ratio $C_{r}$, defined as $C_{r} = C_{\\min}/C_{\\max}$, where $C = \\dot{m} c_{p}$.\n\nExpress $UA$ in $\\mathrm{kW/K}$ and $C_{r}$ as a pure number. Report the two values in the order $(UA,\\,C_{r})$. Round both to $4$ significant figures.", "solution": "The problem statement has been subjected to a rigorous validation process. All provided data, conditions, and assumptions have been extracted and scrutinized for scientific soundness, consistency, and completeness.\n\n**Validation:**\nFirst, the heat capacity rates for the hot fluid ($C_h$) and the cold fluid ($C_c$) must be computed from the given data.\nThe heat capacity rate is defined as $C = \\dot{m} c_p$.\nFor the hot stream:\n$$C_h = \\dot{m}_h c_{p,h} = (2.0\\,\\mathrm{kg/s}) \\times (2.4\\,\\mathrm{kJ/(kg\\cdot K)}) = 4.8\\,\\mathrm{kW/K}$$\nFor the cold stream:\n$$C_c = \\dot{m}_c c_{p,c} = (1.0\\,\\mathrm{kg/s}) \\times (4.0\\,\\mathrm{kJ/(kg\\cdot K)}) = 4.0\\,\\mathrm{kW/K}$$\n\nNext, an energy balance is performed to verify the consistency of the provided temperature measurements, given the assumption of no heat loss to the surroundings. The heat transfer rate from the hot stream, $q_h$, must equal the heat transfer rate to the cold stream, $q_c$. Note that a temperature difference in degrees Celsius is equal to a temperature difference in Kelvin ($\\Delta T\\,[^\\circ\\mathrm{C}] = \\Delta T\\,[\\mathrm{K}]$).\n$$q_h = C_h (T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}}) = (4.8\\,\\mathrm{kW/K}) \\times (150 - 100)\\,\\mathrm{K} = (4.8)(50)\\,\\mathrm{kW} = 240\\,\\mathrm{kW}$$\n$$q_c = C_c (T_{c,\\mathrm{out}} - T_{c,\\mathrm{in}}) = (4.0\\,\\mathrm{kW/K}) \\times (80 - 20)\\,\\mathrm{K} = (4.0)(60)\\,\\mathrm{kW} = 240\\,\\mathrm{kW}$$\nSince $q_h = q_c$, the measurements are consistent with the First Law of Thermodynamics under the specified conditions. The problem is therefore scientifically sound, self-contained, and well-posed. We may proceed to the solution.\n\n**Solution:**\nThe problem constitutes an inverse parameter estimation task. We will use the given operational data to determine the intrinsic parameters of the heat exchanger, specifically the heat capacity rate ratio $C_r$ and the overall heat transfer conductance $UA$.\n\n1.  **Determine $C_{\\min}$, $C_{\\max}$, and $C_r$:**\n    From the calculated heat capacity rates, we identify the minimum and maximum values:\n    $$C_c = 4.0\\,\\mathrm{kW/K} = C_{\\min}$$\n    $$C_h = 4.8\\,\\mathrm{kW/K} = C_{\\max}$$\n    The heat capacity rate ratio, $C_r$, is defined as the ratio of the minimum to the maximum heat capacity rate:\n    $$C_r = \\frac{C_{\\min}}{C_{\\max}} = \\frac{4.0}{4.8} = \\frac{5}{6}$$\n    This is the first required value.\n\n2.  **Calculate Heat Exchanger Effectiveness ($\\varepsilon$):**\n    The effectiveness, $\\varepsilon$, is the ratio of the actual heat transfer rate, $q$, to the maximum possible heat transfer rate, $q_{\\max}$.\n    The actual heat transfer rate, $q$, is $240\\,\\mathrm{kW}$, as determined from the energy balance.\n    The maximum possible heat transfer rate occurs in a hypothetical infinitely long counterflow heat exchanger where the fluid with the minimum heat capacity rate undergoes the maximum possible temperature change, which is the difference between the inlet temperatures of the hot and cold streams.\n    $$q_{\\max} = C_{\\min} (T_{h,\\mathrm{in}} - T_{c,\\mathrm{in}}) = (4.0\\,\\mathrm{kW/K}) \\times (150 - 20)\\,\\mathrm{K} = (4.0)(130)\\,\\mathrm{kW} = 520\\,\\mathrm{kW}$$\n    The effectiveness is therefore:\n    $$\\varepsilon = \\frac{q}{q_{\\max}} = \\frac{240\\,\\mathrm{kW}}{520\\,\\mathrm{kW}} = \\frac{24}{52} = \\frac{6}{13}$$\n\n3.  **Determine the Number of Transfer Units (NTU):**\n    The problem specifies a counterflow heat exchanger. The relationship between effectiveness ($\\varepsilon$), NTU, and the heat capacity rate ratio ($C_r$) for a counterflow heat exchanger where $C_r \\neq 1$ is:\n    $$\\varepsilon = \\frac{1 - \\exp[-\\mathrm{NTU}(1 - C_r)]}{1 - C_r \\exp[-\\mathrm{NTU}(1 - C_r)]}$$\n    We must rearrange this expression to solve for NTU.\n    $$\\epsilon (1 - C_r \\exp[-\\mathrm{NTU}(1 - C_r)]) = 1 - \\exp[-\\mathrm{NTU}(1 - C_r)]$$\n    $$\\epsilon - 1 = \\epsilon C_r \\exp[-\\mathrm{NTU}(1 - C_r)] - \\exp[-\\mathrm{NTU}(1 - C_r)]$$\n    $$\\epsilon - 1 = (\\epsilon C_r - 1) \\exp[-\\mathrm{NTU}(1 - C_r)]$$\n    $$\\exp[-\\mathrm{NTU}(1 - C_r)] = \\frac{\\epsilon - 1}{\\epsilon C_r - 1}$$\n    Taking the natural logarithm of both sides:\n    $$-\\mathrm{NTU}(1 - C_r) = \\ln\\left(\\frac{\\epsilon - 1}{\\epsilon C_r - 1}\\right)$$\n    $$\\mathrm{NTU} = \\frac{1}{C_r - 1} \\ln\\left(\\frac{\\epsilon - 1}{\\epsilon C_r - 1}\\right)$$\n    Substituting the exact fractional values for $\\varepsilon = 6/13$ and $C_r = 5/6$:\n    $$\\mathrm{NTU} = \\frac{1}{\\frac{5}{6} - 1} \\ln\\left(\\frac{\\frac{6}{13} - 1}{\\frac{6}{13} \\cdot \\frac{5}{6} - 1}\\right) = \\frac{1}{-1/6} \\ln\\left(\\frac{-7/13}{5/13 - 1}\\right)$$\n    $$\\mathrm{NTU} = -6 \\ln\\left(\\frac{-7/13}{-8/13}\\right) = -6 \\ln\\left(\\frac{7}{8}\\right)$$\n    Using the property of logarithms $\\ln(a/b) = -\\ln(b/a)$:\n    $$\\mathrm{NTU} = 6 \\ln\\left(\\frac{8}{7}\\right)$$\n\n4.  **Calculate the Overall Heat Transfer Conductance ($UA$):**\n    The Number of Transfer Units is defined as $\\mathrm{NTU} = UA / C_{\\min}$. Therefore, the overall heat transfer conductance is:\n    $$UA = \\mathrm{NTU} \\times C_{\\min}$$\n    Substituting the expressions for NTU and the value of $C_{\\min}$:\n    $$UA = \\left[6 \\ln\\left(\\frac{8}{7}\\right)\\right] \\times (4.0\\,\\mathrm{kW/K})$$\n    Now, we compute the numerical values and round to $4$ significant figures as required.\n    $$C_r = \\frac{5}{6} \\approx 0.8333$$\n    $$UA = 6 \\ln\\left(\\frac{8}{7}\\right) \\times 4.0 \\approx 6 \\times (0.13353) \\times 4.0 \\approx 3.2047\\,\\mathrm{kW/K}$$\n    Rounding to $4$ significant figures, we get:\n    $$UA \\approx 3.205\\,\\mathrm{kW/K}$$\n    The final answer comprises these two values in the specified order.", "answer": "$$\\boxed{\\begin{pmatrix} 3.205 & 0.8333 \\end{pmatrix}}$$", "id": "2492772"}, {"introduction": "Understanding the theoretical basis of the $\\varepsilon-\\mathrm{NTU}$ method is crucial for both designing new heat exchangers and interpreting their performance. This practice guides you through the derivation of the effectiveness relationship for a parallel-flow configuration, starting from first-principles energy balances. More importantly, it challenges you to invert this relationship and analyze its numerical stability, providing critical insight into how the required size of a heat exchanger (represented by $\\mathrm{NTU}$) becomes extremely sensitive as the desired performance ($\\varepsilon$) approaches its thermodynamic limit [@problem_id:2492771].", "problem": "A steady-state parallel-flow heat exchanger operates with two single-phase fluids of constant properties, negligible axial conduction and heat loss, and a spatially uniform overall heat transfer coefficient $U$ over a total heat transfer area $A$. Let the hot and cold streams have heat capacity rates $C_{h}$ and $C_{c}$, respectively, where $C_{h} \\equiv \\dot{m}_{h} c_{p,h}$ and $C_{c} \\equiv \\dot{m}_{c} c_{p,c}$. Define $C_{\\min} \\equiv \\min(C_{h}, C_{c})$ and $C_{\\max} \\equiv \\max(C_{h}, C_{c})$, and the heat capacity rate ratio $C_{r} \\equiv C_{\\min} / C_{\\max}$ with $0 \\leq C_{r} \\leq 1$. The Number of Transfer Units (NTU) is defined by $\\mathrm{NTU} \\equiv U A / C_{\\min}$. The heat exchanger effectiveness $\\varepsilon$ is defined by $\\varepsilon \\equiv Q_{\\text{actual}} / Q_{\\max}$, where $Q_{\\max} \\equiv C_{\\min} (T_{h,i} - T_{c,i})$ is the maximum possible heat transfer based on the inlet temperature difference.\n\nStarting only from the definitions above and first-principles differential energy balances applied along the heat exchanger in parallel flow, derive the standard effectiveness relation for parallel flow, and then analytically invert it to obtain $\\mathrm{NTU}$ as an explicit function of the capacity rate ratio $C_{r}$ and target effectiveness $\\varepsilon$. Clearly state the domain of $(\\varepsilon, C_{r})$ for which the inversion is mathematically valid. Finally, discuss the numerical stability of evaluating the inverted expression in the limit $C_{r} \\to 1$, including the sensitivity of $\\mathrm{NTU}$ to small perturbations in $\\varepsilon$ and any recommended numerically stable computational forms or series expansions.\n\nExpress the final $\\mathrm{NTU}$ result as a single closed-form symbolic expression in terms of $C_{r}$ and $\\varepsilon$. $\\mathrm{NTU}$ is dimensionless. No numerical rounding is required.", "solution": "The problem as stated will first be subjected to a rigorous validation process.\n\nStep 1: Extract Givens\nThe explicit givens are:\n-   Heat exchanger type: Steady-state, parallel-flow.\n-   Fluid properties: Two single-phase fluids, constant properties.\n-   Idealizations: Negligible axial conduction, negligible heat loss.\n-   Heat transfer coefficient: Spatially uniform overall coefficient, $U$.\n-   Total heat transfer area: $A$.\n-   Heat capacity rates: $C_{h} \\equiv \\dot{m}_{h} c_{p,h}$ and $C_{c} \\equiv \\dot{m}_{c} c_{p,c}$.\n-   Heat capacity rate definitions: $C_{\\min} \\equiv \\min(C_{h}, C_{c})$, $C_{\\max} \\equiv \\max(C_{h}, C_{c})$.\n-   Heat capacity rate ratio: $C_{r} \\equiv C_{\\min} / C_{\\max}$, with domain $0 \\leq C_{r} \\leq 1$.\n-   Number of Transfer Units (NTU): $\\mathrm{NTU} \\equiv U A / C_{\\min}$.\n-   Effectiveness: $\\varepsilon \\equiv Q_{\\text{actual}} / Q_{\\max}$.\n-   Maximum heat transfer: $Q_{\\max} \\equiv C_{\\min} (T_{h,i} - T_{c,i})$, where $T_{h,i}$ and $T_{c,i}$ are inlet temperatures.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a classic derivation in the field of convective heat transfer. It is well-posed, asking for a specific analytical derivation, inversion, and stability analysis based on a complete set of standard definitions and idealizations. The language is objective and precise. The problem does not violate any fundamental principles; the assumptions are standard for introductory analysis of heat exchangers. The setup is self-contained and internally consistent.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe derivation begins from first principles. Consider a differential area element $dA$ of the heat exchanger. The differential rate of heat transfer $dQ$ between the hot and cold fluids is given by three relations:\n$$dQ = U(T_h - T_c)dA$$\n$$dQ = -C_h dT_h$$\n$$dQ = C_c dT_c$$\nHere, $T_h(A)$ and $T_c(A)$ are the local temperatures of the hot and cold fluids, respectively. The negative sign in the second equation indicates that the hot fluid temperature decreases as it transfers heat.\n\nLet $\\Delta T \\equiv T_h - T_c$. The differential of this temperature difference is $d(\\Delta T) = dT_h - dT_c$. Substituting the expressions for $dT_h$ and $dT_c$ from the energy balances:\n$$dT_h = -\\frac{dQ}{C_h} \\quad \\text{and} \\quad dT_c = \\frac{dQ}{C_c}$$\n$$d(\\Delta T) = -\\frac{dQ}{C_h} - \\frac{dQ}{C_c} = -dQ \\left(\\frac{1}{C_h} + \\frac{1}{C_c}\\right)$$\nNow, substitute $dQ = U (\\Delta T) dA$:\n$$d(\\Delta T) = -U (\\Delta T) dA \\left(\\frac{1}{C_h} + \\frac{1}{C_c}\\right)$$\nThis is a separable first-order ordinary differential equation. We rearrange and integrate it over the entire heat exchanger area from inlet ($A=0$) to outlet ($A=A_{total}$):\n$$\\int_{\\Delta T_i}^{\\Delta T_o} \\frac{d(\\Delta T)}{\\Delta T} = -U \\left(\\frac{1}{C_h} + \\frac{1}{C_c}\\right) \\int_0^A dA$$\nwhere $\\Delta T_i = T_{h,i} - T_{c,i}$ is the temperature difference at the inlet and $\\Delta T_o = T_{h,o} - T_{c,o}$ is the temperature difference at the outlet. Integration yields:\n$$\\ln\\left(\\frac{\\Delta T_o}{\\Delta T_i}\\right) = -UA \\left(\\frac{1}{C_h} + \\frac{1}{C_c}\\right)$$\nThe exponent can be rewritten using the definitions of $\\mathrm{NTU}$ and $C_r$:\n$$UA \\left(\\frac{1}{C_h} + \\frac{1}{C_c}\\right) = \\frac{UA}{C_{\\min}} C_{\\min} \\left(\\frac{1}{C_h} + \\frac{1}{C_c}\\right) = \\mathrm{NTU} \\left(\\frac{C_{\\min}}{C_h} + \\frac{C_{\\min}}{C_c}\\right)$$\nBy definition, one of $\\{C_h, C_c\\}$ is $C_{\\min}$ and the other is $C_{\\max}$. The sum is thus $\\frac{C_{\\min}}{C_{\\min}} + \\frac{C_{\\min}}{C_{\\max}} = 1 + C_r$ or $\\frac{C_{\\min}}{C_{\\max}} + \\frac{C_{\\min}}{C_{\\min}} = C_r + 1$. In either case, the term is $(1+C_r)$.\nThus, we have:\n$$\\frac{\\Delta T_o}{\\Delta T_i} = \\exp[-\\mathrm{NTU}(1+C_r)]$$\nNext, we relate $\\Delta T_o / \\Delta T_i$ to the effectiveness $\\varepsilon$. The total heat transfer is $Q_{actual} = \\varepsilon Q_{\\max} = \\varepsilon C_{\\min} (T_{h,i} - T_{c,i})$. From the overall energy balances:\n$$Q_{actual} = C_h(T_{h,i} - T_{h,o}) \\implies T_{h,o} = T_{h,i} - \\frac{Q_{actual}}{C_h} = T_{h,i} - \\varepsilon \\frac{C_{\\min}}{C_h}(T_{h,i} - T_{c,i})$$\n$$Q_{actual} = C_c(T_{c,o} - T_{c,i}) \\implies T_{c,o} = T_{c,i} + \\frac{Q_{actual}}{C_c} = T_{c,i} + \\varepsilon \\frac{C_{\\min}}{C_c}(T_{h,i} - T_{c,i})$$\nThe outlet temperature difference is:\n$$\\Delta T_o = T_{h,o} - T_{c,o} = (T_{h,i} - T_{c,i}) - \\varepsilon(T_{h,i} - T_{c,i})\\left(\\frac{C_{\\min}}{C_h} + \\frac{C_{\\min}}{C_c}\\right)$$\nDividing by $\\Delta T_i = T_{h,i} - T_{c,i}$ and using the same identity as before:\n$$\\frac{\\Delta T_o}{\\Delta T_i} = 1 - \\varepsilon \\left(\\frac{C_{\\min}}{C_h} + \\frac{C_{\\min}}{C_c}\\right) = 1 - \\varepsilon(1+C_r)$$\nEquating the two expressions for $\\Delta T_o / \\Delta T_i$:\n$$1 - \\varepsilon(1+C_r) = \\exp[-\\mathrm{NTU}(1+C_r)]$$\nSolving for effectiveness $\\varepsilon$ gives the required relation for parallel flow:\n$$\\varepsilon = \\frac{1 - \\exp[-\\mathrm{NTU}(1+C_r)]}{1+C_r}$$\nTo invert this relation for $\\mathrm{NTU}$, we perform algebraic manipulation:\n$$\\varepsilon(1+C_r) = 1 - \\exp[-\\mathrm{NTU}(1+C_r)]$$\n$$\\exp[-\\mathrm{NTU}(1+C_r)] = 1 - \\varepsilon(1+C_r)$$\nTaking the natural logarithm of both sides:\n$$-\\mathrm{NTU}(1+C_r) = \\ln[1 - \\varepsilon(1+C_r)]$$\nFinally, solving for $\\mathrm{NTU}$:\n$$\\mathrm{NTU} = -\\frac{\\ln[1 - \\varepsilon(1+C_r)]}{1+C_r}$$\nThis is the inverted expression.\n\nFor this inversion to be mathematically valid, the argument of the natural logarithm must be strictly positive:\n$$1 - \\varepsilon(1+C_r) > 0 \\implies \\varepsilon(1+C_r) < 1 \\implies \\varepsilon < \\frac{1}{1+C_r}$$\nPhysically, effectiveness $\\varepsilon$ must be non-negative, and $\\mathrm{NTU}$ must be non-negative, which requires $\\ln[1 - \\varepsilon(1+C_r)] \\le 0$, which is satisfied if the argument is between $0$ and $1$. The condition $\\varepsilon \\ge 0$ ensures this. The capacity rate ratio is given as $0 \\le C_r \\le 1$. Therefore, the valid domain for the inversion is:\n$$\\{(\\varepsilon, C_r) | 0 \\le C_r \\le 1, \\, 0 \\le \\varepsilon < \\frac{1}{1+C_r}\\}$$\nThe strict inequality for $\\varepsilon$ corresponds to finite $\\mathrm{NTU}$; the case $\\varepsilon = 1/(1+C_r)$ corresponds to the limit $\\mathrm{NTU} \\to \\infty$.\n\nFinally, we analyze the numerical stability. The expression is $\\mathrm{NTU} = -\\frac{\\ln[1 - \\varepsilon(1+C_r)]}{1+C_r}$.\nIn the limit $C_r \\to 1$, the expression becomes $\\mathrm{NTU} \\to -\\frac{\\ln(1-2\\varepsilon)}{2}$. This form itself does not present an indeterminate form like $0/0$ that would suggest catastrophic cancellation. The potential instability arises from the sensitivity of the output, $\\mathrm{NTU}$, to small perturbations in the input, $\\varepsilon$.\nThe sensitivity is given by the partial derivative $\\frac{\\partial \\mathrm{NTU}}{\\partial \\varepsilon}$:\n$$\\frac{\\partial \\mathrm{NTU}}{\\partial \\varepsilon} = -\\frac{1}{1+C_r} \\cdot \\frac{-(1+C_r)}{1 - \\varepsilon(1+C_r)} = \\frac{1}{1 - \\varepsilon(1+C_r)}$$\nAs the effectiveness $\\varepsilon$ approaches its maximum possible value for a given $C_r$, $\\varepsilon \\to \\left(\\frac{1}{1+C_r}\\right)^{-}$, the denominator of the sensitivity approaches zero:\n$$1 - \\varepsilon(1+C_r) \\to 0^{+}$$\nConsequently, the sensitivity $\\frac{\\partial \\mathrm{NTU}}{\\partial \\varepsilon} \\to +\\infty$.\nThis is true for any $C_r$, including the specified limit $C_r \\to 1$. In this limit, the maximum effectiveness is $\\varepsilon_{max} = 1/2$, and as $\\varepsilon \\to (1/2)^{-}$, the sensitivity $\\frac{\\partial \\mathrm{NTU}}{\\partial \\varepsilon} = \\frac{1}{1-2\\varepsilon} \\to +\\infty$.\nThis indicates that the problem of determining $\\mathrm{NTU}$ from $\\varepsilon$ is inherently ill-conditioned when $\\varepsilon$ is close to its theoretical maximum. A very small uncertainty or error in the measurement or specification of $\\varepsilon$ leads to a very large uncertainty in the calculated $\\mathrm{NTU}$. This is a physical characteristic of the system: when the heat exchanger is already very effective (large $\\mathrm{NTU}$), a significant further increase in size (area $A$) yields only a minuscule improvement in effectiveness.\nThere is no \"more stable\" computational form to resolve this, as the instability is not an artifact of floating-point arithmetic (like catastrophic cancellation, which would occur for the counter-flow case as $C_r \\to 1$) but a fundamental property of the inverse function. The logarithmic expression is the correct and direct way to compute $\\mathrm{NTU}$, with the caveat that its application for designing to an effectiveness near the maximum is highly susceptible to input errors. No series expansion is required or would be beneficial for the parallel-flow formula itself, as it does not involve the subtraction of nearly equal numbers.", "answer": "$$\n\\boxed{-\\frac{\\ln[1 - \\varepsilon(1+C_{r})]}{1+C_{r}}}\n$$", "id": "2492771"}, {"introduction": "To achieve high-fidelity predictions of heat exchanger performance, especially in gas-to-gas applications, we must account for the temperature dependence of fluid properties. This advanced computational practice moves beyond idealized assumptions and guides you in building an iterative numerical solver. You will couple the $\\varepsilon-\\mathrm{NTU}$ framework with sophisticated physical models for fluid properties and convective heat transfer, learning to handle the non-linear interdependencies that characterize real-world systems and converge on a physically accurate operating point [@problem_id:2492821].", "problem": "A counterflow gas-to-gas single-pass heat exchanger operates with both streams flowing in compact ducts of known hydraulic diameters and known bulk flow areas on each side of a separating flat wall of uniform thickness and thermal conductivity. The thermo-physical properties of the gases are temperature-dependent and must be modeled explicitly. The convective heat transfer coefficients on both sides are to be obtained from dimensionless turbulent internal-flow correlations evaluated at appropriate mean bulk temperatures that depend on the unknown outlet temperatures. Your task is to design an algorithm and implement a complete program that couples the convective correlations with the effectiveness–number of transfer units method iteratively until convergence of the outlet temperatures and the overall heat exchanger performance.\n\nThe program must use only the following physically justified base and models.\n\n- Energy conservation and definitions:\n  - Define the heat capacity rates $C_{\\mathrm{h}} = \\dot{m}_{\\mathrm{h}}\\,c_{p,\\mathrm{h}}$ and $C_{\\mathrm{c}} = \\dot{m}_{\\mathrm{c}}\\,c_{p,\\mathrm{c}}$, where $\\dot{m}$ is mass flow rate and $c_p$ is specific heat at constant pressure.\n  - Define $C_{\\min} = \\min\\{C_{\\mathrm{h}}, C_{\\mathrm{c}}\\}$ and $C_{\\max} = \\max\\{C_{\\mathrm{h}}, C_{\\mathrm{c}}\\}$ and the capacity rate ratio $C_r = C_{\\min}/C_{\\max}$.\n  - Define the overall heat transfer coefficient $U$ from series thermal resistances of convection on both sides and conduction through the wall.\n\n- Internal forced convection on each side:\n  - Reynolds number: $\\mathrm{Re} = \\dfrac{\\rho\\,V\\,D_{\\mathrm{h}}}{\\mu}$, with bulk velocity $V = \\dfrac{\\dot{m}}{\\rho A_{\\mathrm{flow}}}$, density $\\rho$, dynamic viscosity $\\mu$, and hydraulic diameter $D_{\\mathrm{h}}$.\n  - Prandtl number given as a temperature-dependent function (see below).\n  - Friction factor (smooth-duct Petukhov correlation for turbulent flow): $f = \\left(0.790\\ln \\mathrm{Re} - 1.64\\right)^{-2}$ for $\\mathrm{Re} \\gtrsim 3000$.\n  - Nusselt number (Gnielinski correlation for turbulent flow): $\\mathrm{Nu} = \\dfrac{f/8\\,(\\mathrm{Re}-1000)\\,\\mathrm{Pr}}{1 + 12.7\\,(f/8)^{1/2}\\,(\\mathrm{Pr}^{2/3}-1)}$, applicable for $3000 \\lesssim \\mathrm{Re} \\lesssim 5\\times 10^6$ and $0.5 \\lesssim \\mathrm{Pr} \\lesssim 2000$.\n  - For laminar fully developed constant-wall-temperature flow, use $\\mathrm{Nu} = 3.66$. In the transitional regime $2300 \\le \\mathrm{Re} \\le 3000$, blend linearly between laminar and turbulent predictions.\n\n- Property models for gases (evaluate at the mean bulk temperature $T_{\\mathrm{mean}} = \\tfrac{1}{2}(T_{\\mathrm{in}} + T_{\\mathrm{out}})$ on each side in each iteration):\n  - Ideal gas density: $\\rho = \\dfrac{p}{R T_{\\mathrm{mean}}}$, where $p$ is the absolute pressure and $R = \\dfrac{R_{\\mathrm{u}}}{M}$ is the specific gas constant, with universal gas constant $R_{\\mathrm{u}} = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$ and molar mass $M$.\n  - Dynamic viscosity (Sutherland’s law): $\\mu(T) = \\mu_{\\mathrm{ref}}\\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right)^{3/2}\\dfrac{T_{\\mathrm{ref}} + S}{T + S}$.\n  - Heat capacity at constant pressure using Shomate polynomials, in terms of $t = T/1000$: $c_{p,\\mathrm{molar}}(T) = A + B t + C t^2 + D t^3 + \\dfrac{E}{t^2}$, giving $\\mathrm{J/(mol\\cdot K)}$. Convert to mass-specific $c_p$ via $c_p = \\dfrac{c_{p,\\mathrm{molar}}}{M}$.\n  - Prandtl number (temperature-dependent empirical approximation, bounded to a physically reasonable interval): $\\mathrm{Pr}(T)$ given per species below.\n  - Thermal conductivity from the Eucken relation: $k(T) = \\dfrac{\\mu(T)\\,c_p(T)}{\\mathrm{Pr}(T)}$.\n\n- Species data (use the indicated valid temperature ranges; if $T$ falls outside, clamp to the nearest bound for evaluating $c_p$):\n  - Nitrogen ($\\text{N}_2$): $M = 0.0280134\\,\\mathrm{kg/mol}$, Sutherland parameters $T_{\\mathrm{ref}} = 300\\,\\mathrm{K}$, $\\mu_{\\mathrm{ref}} = 1.663\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$, $S = 107\\,\\mathrm{K}$. Shomate coefficients for $200 \\le T \\le 1000\\,\\mathrm{K}$: $A=28.98641$, $B=1.853978$, $C=-9.647459$, $D=16.63537$, $E=0.000117$. Prandtl number approximation $\\mathrm{Pr}_{\\mathrm{N_2}}(T) = \\max\\{0.64, \\min\\{0.82, 0.72 - 1.0\\times 10^{-4}(T - 300)\\}\\}$ with $T$ in $\\mathrm{K}$.\n  - Carbon dioxide ($\\text{CO}_2$): $M = 0.0440095\\,\\mathrm{kg/mol}$, Sutherland parameters $T_{\\mathrm{ref}} = 300\\,\\mathrm{K}$, $\\mu_{\\mathrm{ref}} = 1.480\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$, $S = 240\\,\\mathrm{K}$. Shomate coefficients for $298 \\le T \\le 1200\\,\\mathrm{K}$: $A=24.99735$, $B=55.18696$, $C=-33.69137$, $D=7.948387$, $E=-0.136638$. Prandtl number approximation $\\mathrm{Pr}_{\\mathrm{CO_2}}(T) = \\max\\{0.66, \\min\\{0.85, 0.77 - 1.5\\times 10^{-4}(T - 300)\\}\\}$.\n\n- Overall resistance on the common heat transfer area $A$: use a flat-wall series model with uniform area on both sides,\n  $\n  \\dfrac{1}{U} = \\dfrac{1}{h_{\\mathrm{h}}} + \\dfrac{\\delta}{k_{\\mathrm{w}}} + \\dfrac{1}{h_{\\mathrm{c}}}\n  $,\n  where $h_{\\mathrm{h}}$ and $h_{\\mathrm{c}}$ are the side-specific convection coefficients, $\\delta$ is the wall thickness, and $k_{\\mathrm{w}}$ is the wall thermal conductivity. Neglect fouling.\n\nAlgorithmic requirements:\n\n- Implement a fixed-point iteration on the pair of outlet temperatures $(T_{\\mathrm{h,out}}, T_{\\mathrm{c,out}})$, where each iteration does:\n  - Evaluate properties at side-specific $T_{\\mathrm{mean}}$.\n  - Compute $\\mathrm{Re}$, $\\mathrm{Pr}$, $\\mathrm{Nu}$, and $h$ on each side, and then $U$.\n  - Form $\\mathrm{NTU} = \\dfrac{U A}{C_{\\min}}$ and the effectiveness $\\varepsilon$ for counterflow from the standard relationship between $\\varepsilon$, $\\mathrm{NTU}$, and $C_r$.\n  - Compute the heat duty $q = \\varepsilon\\,C_{\\min}\\,(T_{\\mathrm{h,in}} - T_{\\mathrm{c,in}})$ and update outlet temperatures from energy balances: $T_{\\mathrm{h,out}} \\leftarrow T_{\\mathrm{h,in}} - q/C_{\\mathrm{h}}$, $T_{\\mathrm{c,out}} \\leftarrow T_{\\mathrm{c,in}} + q/C_{\\mathrm{c}}$.\n  - Apply relaxation with a constant damping factor $\\theta \\in (0,1]$ to enhance robustness: $T_{\\mathrm{out}}^{\\mathrm{new}} \\leftarrow \\theta\\,T_{\\mathrm{out}}^{\\mathrm{new}} + (1-\\theta)\\,T_{\\mathrm{out}}^{\\mathrm{old}}$ on both sides.\n- Stop when the maximum absolute change in outlet temperatures is below a tolerance of $10^{-6}\\,\\mathrm{K}$ or after at most $200$ iterations. Use $\\theta = 0.6$.\n- Use the counterflow relation between effectiveness, number of transfer units, and capacity rate ratio derived from steady one-dimensional energy balances with constant $U$ and sidewise-constant $C$.\n\nTest suite:\n\nProvide a program that computes for each of the following three cases the quadruple of outputs $[T_{\\mathrm{h,out}}, T_{\\mathrm{c,out}}, \\varepsilon, \\mathrm{NTU}]$ as floats, with temperatures expressed in $\\mathrm{K}$ and rounded to six digits after the decimal point. The final output must be a single line containing a Python-style list of these three quadruples, e.g., $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot]]$.\n\n- Case $1$ (general “happy path”):\n  - Hot side: species $\\text{N}_2$, $\\dot{m}_{\\mathrm{h}} = 1.5\\,\\mathrm{kg/s}$, $T_{\\mathrm{h,in}} = 700\\,\\mathrm{K}$, $p_{\\mathrm{h}} = 200\\,\\mathrm{kPa}$, $A_{\\mathrm{flow,h}} = 0.025\\,\\mathrm{m^2}$, $D_{\\mathrm{h,h}} = 0.020\\,\\mathrm{m}$.\n  - Cold side: species $\\text{CO}_2$, $\\dot{m}_{\\mathrm{c}} = 2.0\\,\\mathrm{kg/s}$, $T_{\\mathrm{c,in}} = 300\\,\\mathrm{K}$, $p_{\\mathrm{c}} = 200\\,\\mathrm{kPa}$, $A_{\\mathrm{flow,c}} = 0.020\\,\\mathrm{m^2}$, $D_{\\mathrm{h,c}} = 0.015\\,\\mathrm{m}$.\n  - Wall and area: $A = 60.0\\,\\mathrm{m^2}$, $\\delta = 0.002\\,\\mathrm{m}$, $k_{\\mathrm{w}} = 16.0\\,\\mathrm{W/(m\\cdot K)}$.\n\n- Case $2$ (capacity rate ratio $C_r$ near unity and smaller area):\n  - Hot side: species $\\text{N}_2$, $\\dot{m}_{\\mathrm{h}} = 1.0\\,\\mathrm{kg/s}$, $T_{\\mathrm{h,in}} = 800\\,\\mathrm{K}$, $p_{\\mathrm{h}} = 300\\,\\mathrm{kPa}$, $A_{\\mathrm{flow,h}} = 0.015\\,\\mathrm{m^2}$, $D_{\\mathrm{h,h}} = 0.018\\,\\mathrm{m}$.\n  - Cold side: species $\\text{N}_2$, $\\dot{m}_{\\mathrm{c}} = 1.2\\,\\mathrm{kg/s}$, $T_{\\mathrm{c,in}} = 600\\,\\mathrm{K}$, $p_{\\mathrm{c}} = 300\\,\\mathrm{kPa}$, $A_{\\mathrm{flow,c}} = 0.018\\,\\mathrm{m^2}$, $D_{\\mathrm{h,c}} = 0.018\\,\\mathrm{m}$.\n  - Wall and area: $A = 25.0\\,\\mathrm{m^2}$, $\\delta = 0.0015\\,\\mathrm{m}$, $k_{\\mathrm{w}} = 20.0\\,\\mathrm{W/(m\\cdot K)}$.\n\n- Case $3$ (small $C_r$ edge case with large cold-side capacity):\n  - Hot side: species $\\text{CO}_2$, $\\dot{m}_{\\mathrm{h}} = 0.2\\,\\mathrm{kg/s}$, $T_{\\mathrm{h,in}} = 600\\,\\mathrm{K}$, $p_{\\mathrm{h}} = 250\\,\\mathrm{kPa}$, $A_{\\mathrm{flow,h}} = 0.004\\,\\mathrm{m^2}$, $D_{\\mathrm{h,h}} = 0.010\\,\\mathrm{m}$.\n  - Cold side: species $\\text{N}_2$, $\\dot{m}_{\\mathrm{c}} = 5.0\\,\\mathrm{kg/s}$, $T_{\\mathrm{c,in}} = 300\\,\\mathrm{K}$, $p_{\\mathrm{c}} = 300\\,\\mathrm{kPa}$, $A_{\\mathrm{flow,c}} = 0.050\\,\\mathrm{m^2}$, $D_{\\mathrm{h,c}} = 0.030\\,\\mathrm{m}$.\n  - Wall and area: $A = 12.0\\,\\mathrm{m^2}$, $\\delta = 0.0010\\,\\mathrm{m}$, $k_{\\mathrm{w}} = 15.0\\,\\mathrm{W/(m\\cdot K)}$.\n\nAngle units are not applicable. All temperatures must be expressed in $\\mathrm{K}$. The effectiveness $\\varepsilon$ and the number of transfer units $\\mathrm{NTU}$ are dimensionless. Your program must produce a single line of output containing the three case results as a comma-separated list enclosed in square brackets, where each case result is the four-element list $[T_{\\mathrm{h,out}}, T_{\\mathrm{c,out}}, \\varepsilon, \\mathrm{NTU}]$ with each float rounded to six digits after the decimal point, e.g., $[[700.000000,300.000000,0.000000,0.000000],[\\dots],[\\dots]]$.", "solution": "The problem as stated is a scientifically grounded and well-posed problem in computational heat transfer. It describes the analysis of a counterflow gas-to-gas heat exchanger where the thermophysical properties of the fluids are strongly dependent on temperature. This coupling between the fluid mechanics, heat transfer, and thermodynamics necessitates a numerical, iterative solution. The problem provides a complete set of physical models, geometric data, and operational parameters, along with a specified iterative algorithm to find the steady-state performance. The supplied information is self-contained, consistent, and free of scientific or logical flaws. Therefore, a valid solution can be constructed.\n\nThe method employed is a fixed-point iteration scheme acting on the outlet temperatures of the hot and cold fluid streams, $T_{\\mathrm{h,out}}$ and $T_{\\mathrm{c,out}}$. The core principle is to repeatedly solve the system of equations until the outlet temperatures converge to a stable solution. An under-relaxation factor, $\\theta$, is used to dampen oscillations and improve the stability of the iterative process.\n\nThe algorithmic procedure for each test case is as follows:\n\n1.  **Initialization**:\n    The iteration starts with an initial guess for the outlet temperatures. A robust choice is to set the initial outlet temperatures equal to their respective inlet temperatures: $T_{\\mathrm{h,out}}^{(k=0)} = T_{\\mathrm{h,in}}$ and $T_{\\mathrm{c,out}}^{(k=0)} = T_{\\mathrm{c,in}}$, where $k$ is the iteration index. The iteration counter is set to $k=0$.\n\n2.  **Iterative Loop**:\n    The loop continues until convergence is achieved or a maximum number of iterations, specified as $200$, is reached. Convergence is defined as the maximum absolute change in either outlet temperature between successive iterations falling below a tolerance of $10^{-6}\\,\\mathrm{K}$. Within each iteration $k$:\n\n    a.  **Property Evaluation**: The mean bulk temperature for each stream is calculated using the temperatures from the previous iteration, $T_{\\mathrm{out}}^{(k-1)}$:\n        $$ T_{\\mathrm{h,mean}} = \\frac{1}{2}(T_{\\mathrm{h,in}} + T_{\\mathrm{h,out}}^{(k-1)}) $$\n        $$ T_{\\mathrm{c,mean}} = \\frac{1}{2}(T_{\\mathrm{c,in}} + T_{\\mathrm{c,out}}^{(k-1)}) $$\n        All temperature-dependent properties—density ($\\rho$), dynamic viscosity ($\\mu$), specific heat capacity ($c_p$), and Prandtl number ($\\mathrm{Pr}$)—are evaluated at these mean temperatures using the provided physical models: Ideal Gas Law for $\\rho$, Sutherland's Law for $\\mu$, Shomate polynomials for $c_p$ (converted to a mass basis from the given molar basis), and an empirical function for $\\mathrm{Pr}$. The thermal conductivity $k$ is then derived from the Eucken relation: $k = \\mu c_p / \\mathrm{Pr}$.\n\n    b.  **Convective Heat Transfer Coefficients**: For each side of the exchanger, the Reynolds number ($\\mathrm{Re}$) is calculated to determine the flow regime:\n        $$ \\mathrm{Re} = \\frac{\\rho V D_{\\mathrm{h}}}{\\mu} = \\frac{\\dot{m} D_{\\mathrm{h}}}{A_{\\mathrm{flow}} \\mu} $$\n        The Nusselt number ($\\mathrm{Nu}$) is then determined based on the flow regime:\n        - For laminar flow ($\\mathrm{Re} < 2300$), a constant value is used: $\\mathrm{Nu} = 3.66$.\n        - For turbulent flow ($\\mathrm{Re} > 3000$), the Gnielinski correlation is used, which depends on the friction factor $f$ from the Petukhov correlation:\n          $$ f = \\left(0.790\\ln \\mathrm{Re} - 1.64\\right)^{-2} $$\n          $$ \\mathrm{Nu} = \\frac{(f/8)(\\mathrm{Re}-1000)\\mathrm{Pr}}{1 + 12.7(f/8)^{1/2}(\\mathrm{Pr}^{2/3}-1)} $$\n        - For transitional flow ($2300 \\le \\mathrm{Re} \\le 3000$), $\\mathrm{Nu}$ is found by linear interpolation with respect to $\\mathrm{Re}$ between the laminar value at $\\mathrm{Re}=2300$ and the turbulent value calculated from the Gnielinski correlation at $\\mathrm{Re}=3000$.\n        Finally, the convective heat transfer coefficient $h$ is computed:\n        $$ h = \\frac{\\mathrm{Nu} \\cdot k}{D_{\\mathrm{h}}} $$\n\n    c.  **Overall Heat Transfer Coefficient ($U$)**: The overall coefficient is calculated based on a series thermal resistance model for a flat wall, accounting for convection on both sides and conduction through the wall:\n        $$ \\frac{1}{U} = \\frac{1}{h_{\\mathrm{h}}} + \\frac{\\delta}{k_{\\mathrm{w}}} + \\frac{1}{h_{\\mathrm{c}}} $$\n\n    d.  **Effectiveness-NTU Calculation**: The heat capacity rates for the hot and cold streams are $C_{\\mathrm{h}} = \\dot{m}_{\\mathrm{h}} c_{p,\\mathrm{h}}$ and $C_{\\mathrm{c}} = \\dot{m}_{\\mathrm{c}} c_{p,\\mathrm{c}}$. From these, $C_{\\min}$ and $C_{\\max}$ are identified, and the capacity rate ratio is found: $C_r = C_{\\min}/C_{\\max}$. The number of transfer units ($\\mathrm{NTU}$) is then calculated:\n        $$ \\mathrm{NTU} = \\frac{U A}{C_{\\min}} $$\n        The heat exchanger effectiveness $\\varepsilon$ for a counterflow configuration is computed. For the case where $C_r \\neq 1$:\n        $$ \\varepsilon = \\frac{1 - \\exp[-\\mathrm{NTU}(1 - C_r)]}{1 - C_r \\exp[-\\mathrm{NTU}(1 - C_r)]} $$\n        For the balanced case where $C_r = 1$:\n        $$ \\varepsilon = \\frac{\\mathrm{NTU}}{1 + \\mathrm{NTU}} $$\n\n    e.  **Outlet Temperature Update**: The rate of heat transfer $q$ is calculated from the effectiveness:\n        $$ q = \\varepsilon C_{\\min} (T_{\\mathrm{h,in}} - T_{\\mathrm{c,in}}) $$\n        New candidate outlet temperatures, $T_{\\mathrm{out}}^{\\mathrm{new}}$, are determined from the energy balance on each stream:\n        $$ T_{\\mathrm{h,out}}^{\\mathrm{new}} = T_{\\mathrm{h,in}} - \\frac{q}{C_{\\mathrm{h}}} $$\n        $$ T_{\\mathrm{c,out}}^{\\mathrm{new}} = T_{\\mathrm{c,in}} + \\frac{q}{C_{\\mathrm{c}}} $$\n\n    f.  **Relaxation**: To ensure stable convergence, the newly computed temperatures are combined with the values from the previous iteration using the specified relaxation factor $\\theta = 0.6$:\n        $$ T_{\\mathrm{h,out}}^{(k)} = \\theta T_{\\mathrm{h,out}}^{\\mathrm{new}} + (1-\\theta) T_{\\mathrm{h,out}}^{(k-1)} $$\n        $$ T_{\\mathrm{c,out}}^{(k)} = \\theta T_{\\mathrm{c,out}}^{\\mathrm{new}} + (1-\\theta) T_{\\mathrm{c,out}}^{(k-1)} $$\n        These values, $T_{\\mathrm{out}}^{(k)}$, become the input for the next iteration.\n\n3.  **Termination**:\n    The loop terminates when $|\\Delta T_{\\mathrm{h,out}}|$ and $|\\Delta T_{\\mathrm{c,out}}|$ are both less than $10^{-6}\\,\\mathrm{K}$. The final converged outlet temperatures, along with the corresponding effectiveness $\\varepsilon$ and $\\mathrm{NTU}$ from the final iteration, constitute the solution for the given case.\n\nThis structured, iterative procedure correctly models the physical interdependencies and robustly converges to the heat exchanger's operating point. The implementation will encapsulate these steps within a program that processes each specified test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the heat exchanger problem for all test cases.\n    \"\"\"\n    R_u = 8.314462618  # J/(mol.K)\n    \n    SPECIES_DATA = {\n        \"N2\": {\n            \"M\": 0.0280134,  # kg/mol\n            \"sutherland\": {\"T_ref\": 300, \"mu_ref\": 1.663e-5, \"S\": 107},\n            \"shomate\": {\n                \"T_range\": (200, 1000),\n                \"coeffs\": [28.98641, 1.853978, -9.647459, 16.63537, 0.000117]\n            },\n            \"prandtl_func\": lambda T: np.clip(0.72 - 1.0e-4 * (T - 300), 0.64, 0.82)\n        },\n        \"CO2\": {\n            \"M\": 0.0440095,  # kg/mol\n            \"sutherland\": {\"T_ref\": 300, \"mu_ref\": 1.480e-5, \"S\": 240},\n            \"shomate\": {\n                \"T_range\": (298, 1200),\n                \"coeffs\": [24.99735, 55.18696, -33.69137, 7.948387, -0.136638]\n            },\n            \"prandtl_func\": lambda T: np.clip(0.77 - 1.5e-4 * (T - 300), 0.66, 0.85)\n        }\n    }\n\n    test_cases = [\n        {  # Case 1\n            \"hot\": {\"species\": \"N2\", \"mdot\": 1.5, \"T_in\": 700.0, \"p\": 200e3, \"A_flow\": 0.025, \"D_h\": 0.020},\n            \"cold\": {\"species\": \"CO2\", \"mdot\": 2.0, \"T_in\": 300.0, \"p\": 200e3, \"A_flow\": 0.020, \"D_h\": 0.015},\n            \"geom\": {\"A\": 60.0, \"delta\": 0.002, \"k_w\": 16.0}\n        },\n        {  # Case 2\n            \"hot\": {\"species\": \"N2\", \"mdot\": 1.0, \"T_in\": 800.0, \"p\": 300e3, \"A_flow\": 0.015, \"D_h\": 0.018},\n            \"cold\": {\"species\": \"N2\", \"mdot\": 1.2, \"T_in\": 600.0, \"p\": 300e3, \"A_flow\": 0.018, \"D_h\": 0.018},\n            \"geom\": {\"A\": 25.0, \"delta\": 0.0015, \"k_w\": 20.0}\n        },\n        {  # Case 3\n            \"hot\": {\"species\": \"CO2\", \"mdot\": 0.2, \"T_in\": 600.0, \"p\": 250e3, \"A_flow\": 0.004, \"D_h\": 0.010},\n            \"cold\": {\"species\": \"N2\", \"mdot\": 5.0, \"T_in\": 300.0, \"p\": 300e3, \"A_flow\": 0.050, \"D_h\": 0.030},\n            \"geom\": {\"A\": 12.0, \"delta\": 0.001, \"k_w\": 15.0}\n        }\n    ]\n\n    def get_fluid_properties(species_name, T_mean, p):\n        s_data = SPECIES_DATA[species_name]\n        M = s_data[\"M\"]\n        R_spec = R_u / M\n\n        # Viscosity (Sutherland's Law)\n        suth = s_data[\"sutherland\"]\n        mu = suth[\"mu_ref\"] * (T_mean / suth[\"T_ref\"])**1.5 * (suth[\"T_ref\"] + suth[\"S\"]) / (T_mean + suth[\"S\"])\n\n        # Specific heat (Shomate equation)\n        shom = s_data[\"shomate\"]\n        T_clamped = np.clip(T_mean, shom[\"T_range\"][0], shom[\"T_range\"][1])\n        t = T_clamped / 1000.0\n        A, B, C, D, E = shom[\"coeffs\"]\n        cp_molar = A + B*t + C*t**2 + D*t**3 + E/t**2\n        cp = cp_molar / M\n\n        # Prandtl number\n        Pr = s_data[\"prandtl_func\"](T_mean)\n\n        # Density (Ideal Gas Law)\n        rho = p / (R_spec * T_mean)\n        \n        # Thermal conductivity (Eucken relation)\n        k = mu * cp / Pr\n        \n        return rho, mu, cp, Pr, k\n\n    def get_nusselt(Re, Pr):\n        def petukhov_friction(Re_val):\n            return (0.790 * np.log(Re_val) - 1.64)**-2\n\n        def gnielinski_nusselt(Re_val, Pr_val):\n            f = petukhov_friction(Re_val)\n            num = (f / 8) * (Re_val - 1000) * Pr_val\n            den = 1 + 12.7 * (f / 8)**0.5 * (Pr_val**(2/3) - 1)\n            return num / den\n\n        if Re < 2300:\n            return 3.66\n        elif Re <= 3000:\n            Nu_lam_at_2300 = 3.66\n            Nu_turb_at_3000 = gnielinski_nusselt(3000.0, Pr)\n            return np.interp(Re, [2300.0, 3000.0], [Nu_lam_at_2300, Nu_turb_at_3000])\n        else:\n            return gnielinski_nusselt(Re, Pr)\n\n    def compute_case(case_params):\n        hot, cold, geom = case_params[\"hot\"], case_params[\"cold\"], case_params[\"geom\"]\n        \n        T_h_out, T_c_out = hot[\"T_in\"], cold[\"T_in\"] # Initial guess\n\n        max_iter = 200\n        tolerance = 1e-6\n        theta = 0.6  # Relaxation factor\n\n        for _ in range(max_iter):\n            T_h_out_old, T_c_out_old = T_h_out, T_c_out\n            \n            # 1. Property Evaluation\n            T_h_mean = (hot[\"T_in\"] + T_h_out_old) / 2\n            T_c_mean = (cold[\"T_in\"] + T_c_out_old) / 2\n            \n            rho_h, mu_h, cp_h, Pr_h, k_h = get_fluid_properties(hot[\"species\"], T_h_mean, hot[\"p\"])\n            rho_c, mu_c, cp_c, Pr_c, k_c = get_fluid_properties(cold[\"species\"], T_c_mean, cold[\"p\"])\n            \n            # 2. Convective Coefficients\n            Re_h = (hot[\"mdot\"] * hot[\"D_h\"]) / (hot[\"A_flow\"] * mu_h)\n            Re_c = (cold[\"mdot\"] * cold[\"D_h\"]) / (cold[\"A_flow\"] * mu_c)\n            \n            Nu_h = get_nusselt(Re_h, Pr_h)\n            Nu_c = get_nusselt(Re_c, Pr_c)\n            \n            h_h = Nu_h * k_h / hot[\"D_h\"]\n            h_c = Nu_c * k_c / cold[\"D_h\"]\n\n            # 3. Overall Coefficient\n            U = 1.0 / (1.0/h_h + geom[\"delta\"]/geom[\"k_w\"] + 1.0/h_c)\n            \n            # 4. Effectiveness-NTU\n            C_h = hot[\"mdot\"] * cp_h\n            C_c = cold[\"mdot\"] * cp_c\n            \n            C_min = min(C_h, C_c)\n            C_max = max(C_h, C_c)\n            \n            if C_max == 0: continue # Avoid division by zero\n            C_r = C_min / C_max if C_max != 0 else 0\n            \n            NTU = U * geom[\"A\"] / C_min if C_min != 0 else np.inf\n            \n            if abs(C_r - 1.0) < 1e-9:\n                eps = NTU / (1.0 + NTU)\n            else:\n                exp_term = np.exp(-NTU * (1.0 - C_r))\n                eps = (1.0 - exp_term) / (1.0 - C_r * exp_term)\n\n            # 5. Update Temperatures\n            q = eps * C_min * (hot[\"T_in\"] - cold[\"T_in\"])\n            \n            if C_h == 0 or C_c == 0: continue\n            T_h_out_new = hot[\"T_in\"] - q / C_h\n            T_c_out_new = cold[\"T_in\"] + q / C_c\n            \n            # 6. Relaxation\n            T_h_out = theta * T_h_out_new + (1 - theta) * T_h_out_old\n            T_c_out = theta * T_c_out_new + (1 - theta) * T_c_out_old\n\n            # 7. Check Convergence\n            if max(abs(T_h_out - T_h_out_old), abs(T_c_out - T_c_out_old)) < tolerance:\n                break\n        \n        return [T_h_out, T_c_out, eps, NTU]\n\n    results = []\n    for case in test_cases:\n        result = compute_case(case)\n        results.append(result)\n\n    # Format output string\n    formatted_cases = []\n    for res in results:\n        formatted_cases.append(f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f}]\")\n    \n    final_output_str = f\"[{','.join(formatted_cases)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2492821"}]}