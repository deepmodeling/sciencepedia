{"hands_on_practices": [{"introduction": "Before diving into calculations, it's essential to grasp precisely what a view factor represents and, just as importantly, what it does not. This exercise [@problem_id:2518540] challenges you to distinguish the purely geometric view factor, $F_{ij}$, from related concepts like the fraction of energy absorbed, which also depends on surface material properties like absorptivity $\\alpha$. Mastering this distinction is the first step toward correctly modeling radiative heat exchange and is fundamental to all subsequent analysis.", "problem": "An isothermal, evacuated, convex enclosure is formed by $N \\ge 3$ opaque, diffuse-gray surfaces $\\{1,2,\\dots,N\\}$ with areas $\\{A_1,\\dots,A_N\\}$ and diffuse hemispherical absorptivities $\\{\\alpha_1,\\dots,\\alpha_N\\}$ (with $\\rho_i = 1 - \\alpha_i$ the diffuse reflectivities). Surfaces are perfectly diffuse in emission and reflection, the medium is non-participating, and all optical properties are gray (independent of wavelength). Consider a notional experiment in which an amount of radiant energy $Q$ is emitted uniformly and diffusely from surface $i$ into the enclosure, while the remaining surfaces behave according to their stated properties. Define:\n- The configuration (view) factor $F_{ij}$ as the fraction of the diffusely emitted energy leaving $i$ that is incident directly on $j$ without any reflection.\n- The first-pass absorbed fraction $p_{ij}^{(1)}$ as the fraction of $Q$ absorbed by surface $j$ upon its first incidence on $j$ (i.e., before any reflections occur anywhere).\n- The eventual absorbed fraction $p_{ij}^{(\\infty)}$ as the fraction of $Q$ ultimately absorbed by surface $j$ after allowing arbitrarily many diffuse reflections among all enclosure surfaces.\n\nUsing only fundamental definitions of diffuse emission and reflection, geometric exchange, and conservation of energy, determine which of the following statements are correct for arbitrary enclosure geometries and properties as specified.\n\nA. For any enclosure geometry and diffuse-gray surfaces, $p_{ij}^{(1)} = \\alpha_j F_{ij}$.\n\nB. For any enclosure geometry and diffuse-gray surfaces, $p_{ij}^{(\\infty)} = F_{ij}$ regardless of $\\{\\alpha_k\\}$.\n\nC. If every surface in the enclosure is black (i.e., $\\alpha_k = 1$ for all $k$), then $p_{ij}^{(\\infty)} = F_{ij}$.\n\nD. The configuration factor $F_{ij}$ depends on the surface properties $\\{\\alpha_k\\}$ and $\\{\\varepsilon_k\\}$ but not on the geometry.\n\nE. The reciprocity relation $A_i F_{ij} = A_j F_{ji}$ follows from energy conservation and holds independently of surface emissivities and absorptivities.\n\nF. In a two-surface enclosure consisting only of surfaces $1$ and $2$, the eventual absorbed fraction $p_{12}^{(\\infty)}$ does not depend on $\\alpha_1$.\n\nSelect all that apply.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Enclosure type: Isothermal, evacuated, convex.\n- Number of surfaces: $N \\ge 3$.\n- Surface properties: Opaque, diffuse-gray.\n- Surface areas: $\\{A_1, A_2, \\dots, A_N\\}$.\n- Diffuse hemispherical absorptivities: $\\{\\alpha_1, \\alpha_2, \\dots, \\alpha_N\\}$.\n- Diffuse reflectivities: $\\rho_i = 1 - \\alpha_i$.\n- Emission/Reflection behavior: Perfectly diffuse.\n- Medium: Non-participating.\n- Optical properties: Gray (wavelength-independent).\n- Experimental condition: A quantity of radiant energy $Q$ is emitted uniformly and diffusely from surface $i$.\n- Definition of configuration factor, $F_{ij}$: Fraction of diffusely emitted energy leaving surface $i$ that is incident directly on surface $j$ without any reflection.\n- Definition of first-pass absorbed fraction, $p_{ij}^{(1)}$: Fraction of $Q$ absorbed by surface $j$ upon its first incidence.\n- Definition of eventual absorbed fraction, $p_{ij}^{(\\infty)}$: Fraction of $Q$ ultimately absorbed by surface $j$ after arbitrarily many diffuse reflections.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is based on fundamental and well-established principles of radiative heat transfer in enclosures. The concepts of diffuse-gray surfaces, view factors, radiosity, and energy conservation are standard in the field.\n- **Well-Posedness**: The problem is well-posed. It provides clear and standard definitions and asks for an evaluation of several statements based on these definitions and first principles. A unique set of correct and incorrect statements can be determined.\n- **Objectivity**: The language is technical, precise, and objective.\n- **Analysis of Potential Flaws**:\n  - The problem states the enclosure is \"convex\". In standard terminology, this implies that no surface can see itself, meaning $F_{ii}=0$ for all $i$. This is a common simplifying assumption and does not invalidate the problem, as the fundamental principles to be tested are general.\n  - The problem also states the enclosure is \"isothermal\". This typically implies all surfaces are at the same temperature, leading to zero net heat transfer at equilibrium. However, the problem introduces a thought experiment injecting energy $Q$ from one surface. This is a standard method for calculating radiation exchange factors and is not contradictory. It analyzes the fate of a specific quantity of energy, not the net exchange in thermal equilibrium.\n  - The constraint $N \\ge 3$ is noted. One of the options (F) considers the case $N=2$, which is technically outside the specified domain. However, this oversight does not invalidate the core problem setup. We will evaluate the statement's physical validity while noting the discrepancy.\n\n**Step 3: Verdict and Action**\nThe problem statement is deemed **valid**. It presents a standard and rigorous question in the field of radiative heat transfer. We proceed to the solution.\n\n***\n\n**Analysis of Statements**\n\n**A. For any enclosure geometry and diffuse-gray surfaces, $p_{ij}^{(1)} = \\alpha_j F_{ij}$.**\nBy definition, $F_{ij}$ is the fraction of energy leaving surface $i$ which is directly incident on surface $j$.\nGiven that a total amount of energy $Q$ is emitted from surface $i$, the amount of energy directly incident on surface $j$ is $Q_{i\\to j, direct} = Q \\cdot F_{ij}$.\nSurface $j$ is a diffuse-gray surface with absorptivity $\\alpha_j$. The fraction of incident radiation that it absorbs is $\\alpha_j$.\nThe energy absorbed by surface $j$ upon this first incidence is $Q_{abs, j}^{(1)} = Q_{i\\to j, direct} \\cdot \\alpha_j = (Q \\cdot F_{ij}) \\cdot \\alpha_j$.\nThe first-pass absorbed fraction $p_{ij}^{(1)}$ is defined as the ratio of this absorbed energy to the total energy emitted from $i$:\n$$p_{ij}^{(1)} = \\frac{Q_{abs, j}^{(1)}}{Q} = \\frac{Q F_{ij} \\alpha_j}{Q} = \\alpha_j F_{ij}$$\nThis derivation relies only on the provided definitions.\nThe statement is **Correct**.\n\n**B. For any enclosure geometry and diffuse-gray surfaces, $p_{ij}^{(\\infty)} = F_{ij}$ regardless of $\\{\\alpha_k\\}$.**\nThe eventual absorbed fraction $p_{ij}^{(\\infty)}$ accounts for energy absorbed after multiple reflections. The process of reflection involves the surface property of reflectivity, $\\rho_k = 1 - \\alpha_k$. Therefore, the eventual distribution of energy must depend on the absorptivities $\\{\\alpha_k\\}$ of all surfaces in the enclosure.\nTo disprove the statement, we need only one counterexample. Consider a case where surface $j$ is a perfect reflector, i.e., $\\alpha_j=0$. In this case, surface $j$ cannot absorb any energy, so the energy absorbed by it must be zero. Thus, $p_{ij}^{(\\infty)} = 0$. However, the view factor $F_{ij}$, being a purely geometric quantity, can be non-zero for a general enclosure. For such a case, $p_{ij}^{(\\infty)} = 0 \\ne F_{ij}$.\nThis demonstrates that $p_{ij}^{(\\infty)}$ is not independent of $\\{\\alpha_k\\}$.\nThe statement is **Incorrect**.\n\n**C. If every surface in the enclosure is black (i.e., $\\alpha_k = 1$ for all $k$), then $p_{ij}^{(\\infty)} = F_{ij}$.**\nIf every surface $k$ is black, its absorptivity is $\\alpha_k=1$. Consequently, its reflectivity is $\\rho_k = 1 - \\alpha_k = 0$.\nWhen $\\rho_k=0$ for all surfaces, there are no reflections anywhere in the enclosure. Any radiation incident on any surface is completely absorbed.\nThe energy $Q$ emitted by surface $i$ travels through the enclosure. A fraction $F_{ij}$ strikes surface $j$ directly. Any other fraction $F_{ik}$ (where $k \\ne j$) strikes surface $k$ and is absorbed completely. None of this energy is reflected to subsequently reach surface $j$.\nTherefore, the only energy from $i$ that is absorbed by $j$ is the energy absorbed upon first incidence. The \"eventual\" absorbed fraction is identical to the \"first-pass\" absorbed fraction: $p_{ij}^{(\\infty)} = p_{ij}^{(1)}$.\nFrom the analysis of statement A, $p_{ij}^{(1)} = \\alpha_j F_{ij}$.\nGiven that surface $j$ is black, $\\alpha_j=1$.\nThus, $p_{ij}^{(\\infty)} = 1 \\cdot F_{ij} = F_{ij}$.\nThe statement is **Correct**.\n\n**D. The configuration factor $F_{ij}$ depends on the surface properties $\\{\\alpha_k\\}$ and $\\{\\varepsilon_k\\}$ but not on the geometry.**\nThe configuration factor, or view factor, $F_{ij}$, is defined by the geometry of the system. For two diffuse surfaces $A_i$ and $A_j$, its defining integral is:\n$$F_{ij} = \\frac{1}{A_i} \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} \\mathrm{d}A_j \\mathrm{d}A_i$$\nwhere $r$ is the distance between the differential areas $\\mathrm{d}A_i$ and $\\mathrm{d}A_j$, and $\\theta_i$ and $\\theta_j$ are the angles between the line connecting them and the respective surface normals. This formula contains only geometric quantities. It is fundamentally independent of surface properties such as absorptivity $\\alpha$, emissivity $\\varepsilon$, or temperature.\nThe statement claims the exact opposite.\nThe statement is **Incorrect**.\n\n**E. The reciprocity relation $A_i F_{ij} = A_j F_{ji}$ follows from energy conservation and holds independently of surface emissivities and absorptivities.**\nThe reciprocity relation is a direct mathematical consequence of the geometric definition of the view factor. The expression for $A_i F_{ij}$ derived from the defining integral is\n$$A_i F_{ij} = \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} \\mathrm{d}A_j \\mathrm{d}A_i$$\nThe kernel of the integral is symmetric with respect to indices $i$ and $j$. By swapping the order of integration, we get the expression for $A_j F_{ji}$. This establishes that $A_i F_{ij} = A_j F_{ji}$ based on geometry alone, proving its independence from surface properties.\nThe claim that it \"follows from energy conservation\" is also valid. One can prove the relation by considering an isothermal enclosure of blackbody surfaces at temperature $T$. By the Second Law of Thermodynamics, there can be no net transfer of heat between any two surfaces at the same temperature. The energy leaving $i$ and reaching $j$ is $(A_i E_b)F_{ij}$, and the energy leaving $j$ and reaching $i$ is $(A_j E_b)F_{ji}$. Equating these gives $A_i E_b F_{ij} = A_j E_b F_{ji}$, which simplifies to $A_i F_{ij} = A_j F_{ji}$. Since we have shown the relation holds for this specific physical scenario, and since $F_{ij}$ is purely geometric, the relation must hold for all scenarios.\nThe statement is **Correct**.\n\n**F. In a two-surface enclosure consisting only of surfaces $1$ and $2$, the eventual absorbed fraction $p_{12}^{(\\infty)}$ does not depend on $\\alpha_1$.**\nThis statement proposes a system with $N=2$ surfaces, which contradicts the problem's premise of $N \\ge 3$. While this is a flaw in the question's consistency, we analyze the physical claim.\nLet energy $Q$ be emitted by surface $1$. This energy undergoes multiple reflections between surfaces $1$ and $2$. The amount of energy reflected by surface $1$ depends on its reflectivity $\\rho_1 = 1 - \\alpha_1$. This reflected energy then contributes to the irradiation of surface $2$.\nTo be formal, we can calculate $p_{12}^{(\\infty)}$ for a simple geometry like two infinite parallel plates, where $A_1=A_2$, $F_{12}=1$, and $F_{21}=1$. Following the path of energy $Q$ from surface $1$:\n- Amount absorbed by $2$ on 1st pass: $Q \\alpha_2$.\n- Amount reflected by $2$, then by $1$, then absorbed by $2$: $(Q \\rho_2) (\\rho_1) (\\alpha_2)$.\n- Amount reflected by $2$, then $1$, then $2$, then $1$, then absorbed by $2$: $(Q \\rho_2) (\\rho_1) (\\rho_2) (\\rho_1) (\\alpha_2)$.\nThe total fraction absorbed by $2$ is the sum of a geometric series:\n$$p_{12}^{(\\infty)} = \\frac{1}{Q} \\sum_{k=0}^{\\infty} Q \\alpha_2 (\\rho_1 \\rho_2)^k = \\alpha_2 \\sum_{k=0}^{\\infty} (\\rho_1 \\rho_2)^k = \\frac{\\alpha_2}{1 - \\rho_1 \\rho_2} = \\frac{\\alpha_2}{1 - (1-\\alpha_1)(1-\\alpha_2)}$$\nThis expression for $p_{12}^{(\\infty)}$ clearly contains $\\alpha_1$. The fraction depends on $\\alpha_1$ unless $\\alpha_2=1$ (in which case $p_{12}^{(\\infty)}=1$) or $\\alpha_2=0$ (in which case $p_{12}^{(\\infty)}=0$). Since the statement must hold for arbitrary properties, it is false.\nThe statement is **Incorrect**.", "answer": "$$\\boxed{ACE}$$", "id": "2518540"}, {"introduction": "Having established the purely geometric nature of view factors [@problem_id:2518540], we can now tackle their calculation from first principles. This practice [@problem_id:2518531] requires a full analytical derivation of the view factor matrix for a multi-surface channel, starting from the fundamental integral definition and leveraging view factor algebra. Working through this problem builds the mathematical skills to handle complex geometries and provides a deep appreciation for the interplay between integration, symmetry, and the reciprocity rule.", "problem": "Consider a long, open, U-shaped diffuse-gray enclosure whose cross-section is a rectangle of width $W$ and height $H$. The enclosure is extruded a distance $L$ in the out-of-plane direction, with $L \\gg \\max\\{W,H\\}$ so that end effects are negligible. The three interior planar faces are:\n- Surface $1$: the left vertical wall, of area $A_1 = H L$, outward normal pointing into the cavity along $+x$.\n- Surface $2$: the bottom horizontal wall, of area $A_2 = W L$, outward normal pointing into the cavity along $+y$.\n- Surface $3$: the right vertical wall, of area $A_3 = H L$, outward normal pointing into the cavity along $-x$.\n\nThe enclosure is open at the top to a fourth “opening” surface (denote it $4$) which you may use for closure relations but you are not required to report its view factors. Assume all surfaces are planar, diffuse, and opaque; all edges are sharp; and all view factors are to be computed ignoring end effects (i.e., in the limit $L \\to \\infty$).\n\nStarting only from the surface-to-surface view factor definition and the reciprocity and summation rules for enclosures, derive closed-form expressions for all nine view factors $F_{ij}$ among the three interior faces $i,j \\in \\{1,2,3\\}$, including the self-view factors. Your derivation must reduce the three-dimensional formulation to a two-dimensional one in the $L \\to \\infty$ limit by explicit integration over the extrusion direction.\n\nReport your final result as the nine-tuple of entries of the $3 \\times 3$ view-factor matrix in row-major order,\n$\n\\left(F_{11}, F_{12}, F_{13};\\; F_{21}, F_{22}, F_{23};\\; F_{31}, F_{32}, F_{33}\\right),\n$\nexpressed solely in terms of $W$ and $H$. Do not approximate or round; provide exact closed-form expressions with no numerical substitution.", "solution": "We begin with the fundamental definition of a surface-to-surface configuration factor (view factor). For two diffuse surfaces $i$ and $j$,\n$$\nF_{ij} \\;=\\; \\frac{1}{A_i} \\iint_{A_i} \\iint_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi R^2} \\, \\mathrm{d}A_j \\, \\mathrm{d}A_i,\n$$\nwhere $R$ is the distance between differential elements, and $\\theta_i$ and $\\theta_j$ are the angles between the local outward normals and the line joining the two differential elements, taken in the appropriate direction.\n\nTwo additional enclosure identities will be used:\n- Reciprocity: $A_i F_{ij} = A_j F_{ji}$.\n- Summation: $\\sum_{j} F_{ij} = 1$ for each surface $i$, where the sum includes the opening.\n\nBecause all three interior faces are planar, each self-view factor vanishes: any line of sight connecting two differential elements on the same plane is tangent to the plane so that at least one of the cosine factors vanishes. Therefore,\n$$\nF_{11} = F_{22} = F_{33} = 0.\n$$\n\nWe now compute the nontrivial mutual view factors by direct evaluation and then complete the set via symmetry and reciprocity. Introduce a Cartesian frame with the bottom surface occupying $\\{(x,0,z): 0 \\le x \\le W,\\, 0 \\le z \\le L\\}$, the left wall $\\{(0,y,z): 0 \\le y \\le H,\\, 0 \\le z \\le L\\}$, and the right wall $\\{(W,y,z): 0 \\le y \\le H,\\, 0 \\le z \\le L\\}$.\n\n1) View factor $F_{2\\to 1}$ (bottom to left wall).\n\nPick differential elements $\\mathrm{d}A_2$ at $(x,0,z_2)$ on the bottom and $\\mathrm{d}A_1$ at $(0,y,z_1)$ on the left wall. The vector from $\\mathrm{d}A_2$ to $\\mathrm{d}A_1$ is $\\mathbf{r} = (-x,\\, y,\\, z_1 - z_2)$ with $R^2 = x^2 + y^2 + (z_1 - z_2)^2$. The outward normal for the bottom is $\\mathbf{n}_2 = (0,1,0)$, and for the left wall $\\mathbf{n}_1 = (1,0,0)$. Hence\n$$\n\\cos\\theta_2 = \\frac{\\mathbf{n}_2 \\cdot \\mathbf{r}}{R} = \\frac{y}{R}, \\qquad\n\\cos\\theta_1 = \\frac{\\mathbf{n}_1 \\cdot (-\\mathbf{r})}{R} = \\frac{x}{R}.\n$$\nSubstituting into the definition gives\n$$\nF_{21} = \\frac{1}{A_2} \\int_{0}^{W}\\int_{0}^{L}\\int_{0}^{H}\\int_{0}^{L} \\frac{x\\,y}{\\pi\\left[x^2 + y^2 + (z_1 - z_2)^2\\right]^2} \\,\\mathrm{d}z_1\\,\\mathrm{d}y\\,\\mathrm{d}z_2\\,\\mathrm{d}x.\n$$\nPerform the integrals over $z_1$ and $z_2$ first. With $\\Delta z = z_1 - z_2$ and using the standard convolution in the limit $L \\to \\infty$,\n$$\n\\int_{0}^{L}\\int_{0}^{L} \\frac{\\mathrm{d}z_1\\,\\mathrm{d}z_2}{\\left[x^2 + y^2 + (z_1 - z_2)^2\\right]^2}\n\\;\\xrightarrow[L\\to\\infty]{}\\;\nL \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}\\Delta z}{\\left[x^2 + y^2 + \\Delta z^2\\right]^2}\n\\;=\\; L \\,\\frac{\\pi}{2\\left(x^2 + y^2\\right)^{3/2}},\n$$\nwhere we used the standard integral $\\int_{-\\infty}^{\\infty} \\mathrm{d}s/(s^2 + a^2)^2 = \\pi/(2 a^3)$ with $a^2 = x^2 + y^2$. Thus,\n$$\nF_{21} = \\frac{1}{W L} \\int_{0}^{W}\\int_{0}^{H} \\frac{x\\,y}{\\pi} \\left[ L \\frac{\\pi}{2\\left(x^2 + y^2\\right)^{3/2}} \\right] \\mathrm{d}y\\,\\mathrm{d}x\n= \\frac{1}{2 W} \\int_{0}^{W}\\int_{0}^{H} \\frac{x\\,y}{\\left(x^2 + y^2\\right)^{3/2}} \\,\\mathrm{d}y\\,\\mathrm{d}x.\n$$\nEvaluate the inner integral with respect to $y$:\n$$\n\\int_{0}^{H} \\frac{y}{\\left(x^2 + y^2\\right)^{3/2}} \\,\\mathrm{d}y\n= \\left[ -\\frac{1}{\\sqrt{x^2 + y^2}} \\right]_{0}^{H}\n= \\frac{1}{x} - \\frac{1}{\\sqrt{x^2 + H^2}}.\n$$\nMultiplying by $x$ and integrating over $x$,\n$$\nF_{21} = \\frac{1}{2 W} \\int_{0}^{W} \\left( 1 - \\frac{x}{\\sqrt{x^2 + H^2}} \\right) \\mathrm{d}x\n= \\frac{1}{2 W} \\left[ x - \\sqrt{x^2 + H^2} \\,\\bigg|_{0}^{W} + H \\right]\n= \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W}.\n$$\nBy left-right symmetry, $F_{23} = F_{21}$.\n\n2) View factors $F_{1\\to 2}$ and $F_{3\\to 2}$ by reciprocity.\n\nUsing $A_2 F_{21} = A_1 F_{12}$ with $A_2 = W L$ and $A_1 = H L$,\n$$\nF_{12} = \\frac{A_2}{A_1} F_{21} = \\frac{W}{H} \\cdot \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W}\n= \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H}.\n$$\nBy symmetry, $F_{32} = F_{12}$.\n\n3) View factor $F_{1\\to 3}$ (left wall to right wall).\n\nPick $\\mathrm{d}A_1$ at $(0,y_1,z_1)$ and $\\mathrm{d}A_3$ at $(W,y_3,z_3)$. The vector from $\\mathrm{d}A_1$ to $\\mathrm{d}A_3$ is $\\mathbf{r} = (W,\\, y_3 - y_1,\\, z_3 - z_1)$ with $R^2 = W^2 + (y_3 - y_1)^2 + (z_3 - z_1)^2$. The outward normals are $\\mathbf{n}_1 = (1,0,0)$ and $\\mathbf{n}_3 = (-1,0,0)$. Therefore\n$$\n\\cos\\theta_1 = \\frac{\\mathbf{n}_1 \\cdot \\mathbf{r}}{R} = \\frac{W}{R}, \\qquad\n\\cos\\theta_3 = \\frac{\\mathbf{n}_3 \\cdot (-\\mathbf{r})}{R} = \\frac{W}{R}.\n$$\nHence\n$$\nF_{13} = \\frac{1}{A_1} \\int_{0}^{H}\\int_{0}^{L}\\int_{0}^{H}\\int_{0}^{L} \\frac{W^2}{\\pi\\left[W^2 + (y_3 - y_1)^2 + (z_3 - z_1)^2\\right]^2} \\,\\mathrm{d}z_3\\,\\mathrm{d}y_3\\,\\mathrm{d}z_1\\,\\mathrm{d}y_1.\n$$\nAs before, integrate over $z_1,z_3$ in the limit $L \\to \\infty$:\n$$\n\\int_{0}^{L}\\int_{0}^{L} \\frac{\\mathrm{d}z_1\\,\\mathrm{d}z_3}{\\left[W^2 + (y_3 - y_1)^2 + (z_3 - z_1)^2\\right]^2}\n\\;\\xrightarrow[L\\to\\infty]{}\\;\nL \\frac{\\pi}{2 \\left[ W^2 + (y_3 - y_1)^2 \\right]^{3/2}}.\n$$\nTherefore\n$$\nF_{13} = \\frac{1}{H L} \\int_{0}^{H}\\int_{0}^{H} \\frac{W^2}{\\pi} \\left[ L \\frac{\\pi}{2 \\left( W^2 + (y_3 - y_1)^2 \\right)^{3/2}} \\right] \\mathrm{d}y_3\\,\\mathrm{d}y_1\n= \\frac{1}{H} \\int_{0}^{H}\\int_{0}^{H} \\frac{W^2}{2 \\left( W^2 + (y_3 - y_1)^2 \\right)^{3/2}} \\,\\mathrm{d}y_3\\,\\mathrm{d}y_1.\n$$\nUse the standard identity for functions of the difference,\n$$\n\\int_{0}^{H}\\int_{0}^{H} f(|y_3 - y_1|)\\,\\mathrm{d}y_3\\,\\mathrm{d}y_1 \\;=\\; 2 \\int_{0}^{H} (H - u) f(u)\\,\\mathrm{d}u.\n$$\nThus,\n$$\nF_{13} = \\frac{1}{H} \\int_{0}^{H} (H - u)\\, \\frac{W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u.\n$$\nSplit the integral:\n$$\nF_{13} = \\frac{1}{H} \\left[ H \\int_{0}^{H} \\frac{W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u \\;-\\; \\int_{0}^{H} \\frac{u\\, W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u \\right].\n$$\nCompute the two elementary integrals:\n- With the substitution $u = W \\tan t$, one finds\n$$\n\\int_{0}^{H} \\frac{W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u\n= \\left[ \\frac{u}{\\sqrt{W^2 + u^2}} \\right]_{0}^{H}\n= \\frac{H}{\\sqrt{W^2 + H^2}}.\n$$\n- With $s = W^2 + u^2$, $\\mathrm{d}s = 2 u\\,\\mathrm{d}u$, one finds\n$$\n\\int_{0}^{H} \\frac{u\\, W^2}{\\left( W^2 + u^2 \\right)^{3/2}} \\,\\mathrm{d}u\n= \\left[ - \\frac{W^2}{\\sqrt{W^2 + u^2}} \\right]_{0}^{H}\n= W - \\frac{W^2}{\\sqrt{W^2 + H^2}}.\n$$\nTherefore,\n$$\nF_{13} = \\frac{1}{H} \\left[ H \\cdot \\frac{H}{\\sqrt{W^2 + H^2}} - \\left( W - \\frac{W^2}{\\sqrt{W^2 + H^2}} \\right) \\right]\n= \\frac{1}{H} \\left[ \\frac{H^2 + W^2}{\\sqrt{W^2 + H^2}} - W \\right]\n= \\frac{\\sqrt{W^2 + H^2} - W}{H}.\n$$\nBy symmetry, $F_{31} = F_{13}$.\n\n4) Completion and consistency checks.\n\nWe have obtained\n$$\nF_{11} = F_{22} = F_{33} = 0,\\quad\nF_{21} = F_{23} = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W},\\quad\nF_{12} = F_{32} = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H},\\quad\nF_{13} = F_{31} = \\frac{\\sqrt{W^2 + H^2} - W}{H}.\n$$\nThese satisfy reciprocity by construction. As a further check, apply summation on each emitting surface $i$ including the opening $4$:\n- For $i=2$,\n$$\nF_{21} + F_{22} + F_{23} + F_{24} = 2 \\cdot \\frac{H + W - \\sqrt{W^2 + H^2}}{2 W} + 0 + F_{24} = 1\n\\;\\Rightarrow\\;\nF_{24} = \\frac{\\sqrt{W^2 + H^2} - H}{W}.\n$$\n- For $i=1$,\n$$\nF_{12} + F_{13} + F_{14} = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H} + \\frac{\\sqrt{W^2 + H^2} - W}{H} + F_{14} = 1\n$$\nimplying\n$$\nF_{14} = \\frac{H + W - \\sqrt{W^2 + H^2}}{2 H}.\n$$\nBoth $F_{24}$ and $F_{14}$ are nonnegative and less than $1$, confirming consistency. No further entries among $\\{1,2,3\\}$ remain.\n\nCollecting the nine entries in row-major order yields the requested closed-form result in terms of $W$ and $H$ only.", "answer": "$$\\boxed{\\left(0, \\dfrac{H + W - \\sqrt{W^{2} + H^{2}}}{2 H}, \\dfrac{\\sqrt{W^{2} + H^{2}} - W}{H};\\; \\dfrac{H + W - \\sqrt{W^{2} + H^{2}}}{2 W}, 0, \\dfrac{H + W - \\sqrt{W^{2} + H^{2}}}{2 W};\\; \\dfrac{\\sqrt{W^{2} + H^{2}} - W}{H}, \\dfrac{H + W - \\sqrt{W^{2} + H^{2}}}{2 H}, 0\\right)}$$", "id": "2518531"}, {"introduction": "Analytical derivations, such as the one in [@problem_id:2518531], are foundational, but most engineering problems require numerical solutions for complex geometries. This final practice [@problem_id:2518472] transitions from pure analysis to computational methods, guiding you to implement a numerical quadrature scheme to approximate the view factor integral. The core lesson is learning to assess the accuracy of your numerical result using both grid refinement and the reciprocity theorem as a physical consistency check, a vital skill in modern computational heat transfer.", "problem": "Consider the diffuse–gray radiation view factor between two finite, planar, rectangular surfaces in vacuum, with unobstructed line-of-sight. The surfaces are rectangles centered on the Cartesian origin, one in the plane $z=0$ with outward unit normal $\\mathbf{n}_1=(0,0,1)$ and area $A_1=L_{1x}L_{1y}$, and the other in the parallel plane $z=H$ with outward unit normal $\\mathbf{n}_2=(0,0,-1)$ and area $A_2=L_{2x}L_{2y}$. Each rectangle’s edges are aligned with the coordinate axes. Let a point on surface $1$ be parameterized as $(x_1,y_1,0)$ with $x_1\\in[-L_{1x}/2,L_{1x}/2]$ and $y_1\\in[-L_{1y}/2,L_{1y}/2]$, and a point on surface $2$ be $(x_2,y_2,H)$ with $x_2\\in[-L_{2x}/2,L_{2x}/2]$ and $y_2\\in[-L_{2y}/2,L_{2y}/2]$. The separation vector is $\\mathbf{r}=(x_2-x_1,y_2-y_1,H)$ with magnitude $r=\\|\\mathbf{r}\\|$. For unobstructed view (visibility $V=1$), the configuration factor $F_{1\\to 2}$ is defined by the fundamental surface-to-surface exchange integral\n$$\nF_{1\\to 2}=\\frac{1}{A_1}\\iint_{A_1}\\iint_{A_2}\\frac{\\cos\\theta_1\\,\\cos\\theta_2}{\\pi\\,r^2}\\,\\mathrm{d}A_2\\,\\mathrm{d}A_1,\n$$\nwhere $\\cos\\theta_1=\\mathbf{n}_1\\cdot\\frac{\\mathbf{r}}{r}$ and $\\cos\\theta_2=\\mathbf{n}_2\\cdot\\frac{-\\mathbf{r}}{r}$. For the present geometry, $\\cos\\theta_1=\\cos\\theta_2=\\frac{H}{r}$, and thus the integrand reduces to $\\frac{H^2}{\\pi r^4}$. The reciprocity identity (a well-tested fact for diffuse exchange) states $A_1F_{1\\to 2}=A_2F_{2\\to 1}$.\n\nYour task is to compute a posteriori error estimates for numerical quadrature of $F_{1\\to 2}$ and $F_{2\\to 1}$ by:\n- Approximating the four-dimensional integral with tensor-product Gauss–Legendre quadrature on each rectangle.\n- Comparing successive refinement levels (with the number of points doubled in each rectangle dimension) to form an a posteriori estimate of the quadrature error for each direction.\n- Computing two independent approximations $G_{12}$ and $G_{21}$ at their respective refined levels, and then enforcing reciprocity by replacing $\\big(G_{12},G_{21}\\big)$ with the least-squares pair $\\big(F_{12}^\\star,F_{21}^\\star\\big)$ that satisfies the linear constraint $A_1F_{12}^\\star=A_2F_{21}^\\star$.\n- Reporting an a posteriori error indicator for each direction that aggregates the successive-refinement discrepancy and the reciprocity-correction displacement.\n\nImplement the following for each test case:\n1. Use tensor-product Gauss–Legendre nodes of orders $(n_{1},n_{1})$ on $A_1$ and $(n_{2},n_{2})$ on $A_2$ to obtain a coarse approximation $F_{1\\to 2}^{(c)}$. Refine both orders to $(2n_{1},2n_{1})$ and $(2n_{2},2n_{2})$ to obtain $F_{1\\to 2}^{(f)}$ and define the a posteriori error estimate $E_{12}^{\\text{ref}}=\\left|F_{1\\to 2}^{(f)}-F_{1\\to 2}^{(c)}\\right|$. Take $G_{12}=F_{1\\to 2}^{(f)}$.\n2. Independently, compute $F_{2\\to 1}^{(c)}$ using $(m_{2},m_{2})$ on $A_2$ and $(m_{1},m_{1})$ on $A_1$, then refine to $(2m_{2},2m_{2})$ and $(2m_{1},2m_{1})$ to get $F_{2\\to 1}^{(f)}$ and $E_{21}^{\\text{ref}}=\\left|F_{2\\to 1}^{(f)}-F_{2\\to 1}^{(c)}\\right|$. Take $G_{21}=F_{2\\to 1}^{(f)}$.\n3. Compute the reciprocity-corrected pair $\\big(F_{12}^\\star,F_{21}^\\star\\big)$ as the least-squares solution that minimizes $\\left(F_{12}-G_{12}\\right)^2+\\left(F_{21}-G_{21}\\right)^2$ subject to $A_1F_{12}=A_2F_{21}$. Define the displacement magnitudes $\\Delta_{12}=\\left|F_{12}^\\star-G_{12}\\right|$ and $\\Delta_{21}=\\left|F_{21}^\\star-G_{21}\\right|$. Finally report the error indicators $E_{12}=\\max\\left(E_{12}^{\\text{ref}},\\Delta_{12}\\right)$ and $E_{21}=\\max\\left(E_{21}^{\\text{ref}},\\Delta_{21}\\right)$.\n4. All view factors and error indicators are dimensionless. Express all reported numbers as decimals rounded to six decimal places.\n\nUse the following test suite, in which all lengths are in meters:\n- Case $1$: $L_{1x}=1$, $L_{1y}=1$, $L_{2x}=1$, $L_{2y}=1$, $H=1$, with $(n_{1},n_{2})=(8,8)$ and $(m_{2},m_{1})=(10,10)$.\n- Case $2$: $L_{1x}=1$, $L_{1y}=2$, $L_{2x}=2$, $L_{2y}=3$, $H=0.2$, with $(n_{1},n_{2})=(8,8)$ and $(m_{2},m_{1})=(10,10)$.\n- Case $3$: $L_{1x}=1$, $L_{1y}=1$, $L_{2x}=3$, $L_{2y}=1$, $H=4$, with $(n_{1},n_{2})=(8,8)$ and $(m_{2},m_{1})=(10,10)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a list for one case: $\\big[F_{12}^\\star,F_{21}^\\star,E_{12},E_{21}\\big]$ with each value rounded to six decimal places. For example, the output format is\n\"[ [x11,x12,x13,x14], [x21,x22,x23,x24], [x31,x32,x33,x34] ]\"\nwith all $x_{ij}$ given as decimals with six places and no units. Angles, if any, are not used here. Percentages are not used; all quantities are pure numbers without a percentage sign.", "solution": "The problem statement has been rigorously validated. It is scientifically grounded in the principles of radiative heat transfer, mathematically and algorithmically well-posed, and objectively stated. It requests the implementation of a standard numerical integration technique (Gauss-Legendre quadrature) combined with a posteriori error estimation and a physically-motivated correction procedure to enforce the reciprocity theorem. All data and parameters are provided, and the task is unambiguous. The problem is therefore deemed valid and a solution will be provided.\n\nThe core task is the numerical evaluation of the diffuse radiation view factor $F_{1\\to 2}$ between two parallel, centered, axis-aligned rectangles, $A_1$ and $A_2$, separated by a distance $H$. The governing equation is the four-dimensional integral:\n$$\nF_{1\\to 2} = \\frac{1}{A_1} \\iint_{A_1} \\iint_{A_2} \\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi r^2} \\, \\mathrm{d}A_2 \\, \\mathrm{d}A_1\n$$\nFor the specified geometry, with surface normals $\\mathbf{n}_1=(0,0,1)$ and $\\mathbf{n}_2=(0,0,-1)$, the angle terms are $\\cos\\theta_1 = \\cos\\theta_2 = H/r$. The integrand simplifies to $H^2 / (\\pi r^4)$. The distance squared $r^2$ is given by $r^2 = (x_2-x_1)^2 + (y_2-y_1)^2 + H^2$. The integral becomes:\n$$\nF_{1\\to 2} = \\frac{H^2}{A_1 \\pi} \\int_{-L_{1y}/2}^{L_{1y}/2} \\int_{-L_{1x}/2}^{L_{1x}/2} \\int_{-L_{2y}/2}^{L_{2y}/2} \\int_{-L_{2x}/2}^{L_{2x}/2} \\frac{1}{((x_2-x_1)^2 + (y_2-y_1)^2 + H^2)^2} \\, \\mathrm{d}x_2 \\, \\mathrm{d}y_2 \\, \\mathrm{d}x_1 \\, \\mathrm{d}y_1\n$$\nwhere $A_1 = L_{1x}L_{1y}$.\n\nTo facilitate numerical quadrature, we perform a change of variables to transform the integration domain from $[-L_{1x}/2, L_{1x}/2] \\times \\dots \\times [-L_{2y}/2, L_{2y}/2]$ to the canonical hypercube $[-1, 1]^4$. Let $x_1 = \\frac{L_{1x}}{2}u_1$, $y_1 = \\frac{L_{1y}}{2}u_2$, $x_2 = \\frac{L_{2x}}{2}u_3$, $y_2 = \\frac{L_{2y}}{2}u_4$. The differentials transform as $\\mathrm{d}x_1 = \\frac{L_{1x}}{2}\\mathrm{d}u_1$, and so on. The total Jacobian determinant of this transformation is $\\frac{L_{1x}L_{1y}L_{2x}L_{2y}}{16} = \\frac{A_1 A_2}{16}$. Substituting this into the integral expression for $F_{1\\to 2}$:\n$$\nF_{1\\to 2} = \\frac{H^2}{A_1 \\pi} \\frac{A_1 A_2}{16} \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\frac{1}{r^4(u_1, u_2, u_3, u_4)} \\, \\mathrm{d}u_4 \\, \\mathrm{d}u_3 \\, \\mathrm{d}u_2 \\, \\mathrm{d}u_1 = \\frac{A_2 H^2}{16\\pi} \\int_{[-1,1]^4} \\frac{1}{r^4} \\, \\mathrm{d}\\mathbf{u}\n$$\nThe integral is approximated using a tensor-product Gauss-Legendre quadrature rule. For orders $N_{1x}, N_{1y}, N_{2x}, N_{2y}$, let $\\{(u_{1,i}, w_{1,i})\\}_{i=1}^{N_{1x}}$, ..., $\\{(u_{4,l}, w_{4,l})\\}_{l=1}^{N_{2y}}$ be the respective quadrature nodes and weights. The view factor is approximated as:\n$$\nF_{1\\to 2} \\approx \\frac{A_2 H^2}{16\\pi} \\sum_{i=1}^{N_{1x}} \\sum_{j=1}^{N_{1y}} \\sum_{k=1}^{N_{2x}} \\sum_{l=1}^{N_{2y}} w_{1,i}w_{2,j}w_{3,k}w_{4,l} \\frac{1}{r_{ijkl}^4}\n$$\nwhere $r_{ijkl}^2$ is evaluated at the physical coordinates corresponding to the nodes $(u_{1,i}, u_{2,j}, u_{3,k}, u_{4,l})$. The computation of $F_{2\\to 1}$ is analogous, with the roles of surfaces $1$ and $2$ interchanged.\n\nThe a posteriori error estimation involves two distinct metrics. First, a refinement-based estimate $E^{\\text{ref}}$ is computed by comparing a coarse quadrature result with a more refined one. For example, for $F_{1\\to 2}$, we compute $F_{1\\to 2}^{(c)}$ using orders $(n_{1}, n_{1})$ and $(n_{2}, n_{2})$, and $F_{1\\to 2}^{(f)}$ using refined orders $(2n_{1}, 2n_{1})$ and $(2n_{2}, 2n_{2})$. The estimate is $E_{12}^{\\text{ref}}=\\left|F_{1\\to 2}^{(f)}-F_{1\\to 2}^{(c)}\\right|$. The more accurate value $G_{12} = F_{1\\to 2}^{(f)}$ is retained. An independent calculation provides $G_{21} = F_{2\\to 1}^{(f)}$ and $E_{21}^{\\text{ref}}$.\n\nSecond, the numerical results $G_{12}$ and $G_{21}$ do not in general exactly satisfy the reciprocity theorem, $A_1 F_{1\\to 2} = A_2 F_{2\\to 1}$, due to quadrature error. We enforce this physical law by finding a corrected pair $(F_{12}^\\star, F_{21}^\\star)$ that minimizes the least-squares functional $S = (F_{12} - G_{12})^2 + (F_{21} - G_{21})^2$ subject to the linear constraint $A_1 F_{12} - A_2 F_{21} = 0$. The method of Lagrange multipliers is employed. The Lagrangian is $\\mathcal{L} = S - \\lambda (A_1 F_{12} - A_2 F_{21})$. The system of equations $\\nabla \\mathcal{L} = 0$ yields the solution:\n$$\n\\lambda = \\frac{2(A_2 G_{21} - A_1 G_{12})}{A_1^2 + A_2^2}\n$$\nThe reciprocity-enforced view factors are:\n$$\nF_{12}^\\star = G_{12} + \\frac{\\lambda}{2}A_1 = \\frac{A_2(A_2 G_{12} + A_1 G_{21})}{A_1^2 + A_2^2}\n$$\n$$\nF_{21}^\\star = G_{21} - \\frac{\\lambda}{2}A_2 = \\frac{A_1(A_1 G_{21} + A_2 G_{12})}{A_1^2 + A_2^2}\n$$\nThe displacement due to this correction, $\\Delta_{12} = |F_{12}^\\star - G_{12}|$ and $\\Delta_{21} = |F_{21}^\\star - G_{21}|$, serves as another indicator of numerical error. The magnitude of the reciprocity residual $R = |A_1 G_{12} - A_2 G_{21}|$ gives $\\Delta_{12} = \\frac{A_2 R}{A_1^2 + A_2^2}$ and $\\Delta_{21} = \\frac{A_1 R}{A_1^2 + A_2^2}$.\n\nThe final reported error indicator for each direction aggregates these two error sources: $E_{12} = \\max(E_{12}^{\\text{ref}}, \\Delta_{12})$ and $E_{21} = \\max(E_{21}^{\\text{ref}}, \\Delta_{21})$. This provides a conservative estimate of the total uncertainty in the computed view factors.\n\nThe algorithmic procedure is thus:\n1.  For given geometry $(L_{1x}, L_{1y}, L_{2x}, L_{2y}, H)$ and quadrature orders, compute $F_{1\\to 2}^{(c)}$ and $F_{1\\to 2}^{(f)}$ to find $G_{12}$ and $E_{12}^{\\text{ref}}$.\n2.  Independently compute $F_{2\\to 1}^{(c)}$ and $F_{2\\to 1}^{(f)}$ to find $G_{21}$ and $E_{21}^{\\text{ref}}$.\n3.  Using $G_{12}$, $G_{21}$, $A_1$, and $A_2$, calculate the corrected pair $(F_{12}^\\star, F_{21}^\\star)$ and displacements $(\\Delta_{12}, \\Delta_{21})$.\n4.  Combine the error metrics to report the final indicators $(E_{12}, E_{21})$.\nThis process is repeated for each test case.", "answer": "```python\nimport numpy as np\n\ndef calculate_view_factor(L1x, L1y, L2x, L2y, H, N1x, N1y, N2x, N2y):\n    \"\"\"\n    Computes the view factor F_{1->2} using tensor-product Gauss-Legendre quadrature.\n    \"\"\"\n    try:\n        # Get Gauss-Legendre nodes and weights for each dimension\n        u1_pts, u1_w = np.polynomial.legendre.leggauss(N1x)\n        u2_pts, u2_w = np.polynomial.legendre.leggauss(N1y)\n        u3_pts, u3_w = np.polynomial.legendre.leggauss(N2x)\n        u4_pts, u4_w = np.polynomial.legendre.leggauss(N2y)\n    except (TypeError, ValueError):\n        # Handle cases where numpy can't generate nodes (e.g., non-integer N)\n        return 0.0\n\n    # Scale nodes from [-1, 1] to physical coordinates\n    x1_nodes = (L1x / 2.0) * u1_pts\n    y1_nodes = (L1y / 2.0) * u2_pts\n    x2_nodes = (L2x / 2.0) * u3_pts\n    y2_nodes = (L2y / 2.0) * u4_pts\n\n    # Reshape coordinate and weight arrays for 4D broadcasting\n    x1_r = x1_nodes.reshape(N1x, 1, 1, 1)\n    y1_r = y1_nodes.reshape(1, N1y, 1, 1)\n    x2_r = x2_nodes.reshape(1, 1, N2x, 1)\n    y2_r = y2_nodes.reshape(1, 1, 1, N2y)\n\n    w1_r = u1_w.reshape(N1x, 1, 1, 1)\n    w2_r = u2_w.reshape(1, N1y, 1, 1)\n    w3_r = u3_w.reshape(1, 1, N2x, 1)\n    w4_r = u4_w.reshape(1, 1, 1, N2y)\n\n    # Compute distance squared and integrand at all quadrature points\n    r_sq = (x2_r - x1_r)**2 + (y2_r - y1_r)**2 + H**2\n    \n    # Avoid division by zero if H=0 and points coincide, although H>0 for these cases\n    r_sq[r_sq == 0] = 1e-12 \n    \n    integrand = H**2 / r_sq**2\n\n    # Perform the 4D summation by element-wise multiplication and a single sum\n    quad_sum = np.sum(integrand * w1_r * w2_r * w3_r * w4_r)\n\n    # Apply the pre-factor from the change of variables\n    A2 = L2x * L2y\n    F12 = (A2 / (16.0 * np.pi)) * quad_sum\n\n    return F12\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: (L1x, L1y, L2x, L2y, H), (n1, n2), (m2, m1)\n        ((1.0, 1.0, 1.0, 1.0, 1.0), (8, 8), (10, 10)),\n        # Case 2:\n        ((1.0, 2.0, 2.0, 3.0, 0.2), (8, 8), (10, 10)),\n        # Case 3:\n        ((1.0, 1.0, 3.0, 1.0, 4.0), (8, 8), (10, 10)),\n    ]\n\n    results = []\n    for case in test_cases:\n        geom, n_orders, m_orders = case\n        L1x, L1y, L2x, L2y, H = geom\n        n1, n2 = n_orders\n        m2, m1 = m_orders\n\n        A1 = L1x * L1y\n        A2 = L2x * L2y\n\n        # Step 1: Calculate G_12 and refinement error E_12_ref\n        F12_c = calculate_view_factor(L1x, L1y, L2x, L2y, H, n1, n1, n2, n2)\n        F12_f = calculate_view_factor(L1x, L1y, L2x, L2y, H, 2 * n1, 2 * n1, 2 * n2, 2 * n2)\n        E12_ref = abs(F12_f - F12_c)\n        G12 = F12_f\n\n        # Step 2: Independently calculate G_21 and E_21_ref\n        # Note the swapped arguments for F_2->1\n        F21_c = calculate_view_factor(L2x, L2y, L1x, L1y, H, m2, m2, m1, m1)\n        F21_f = calculate_view_factor(L2x, L2y, L1x, L1y, H, 2 * m2, 2 * m2, 2 * m1, 2 * m1)\n        E21_ref = abs(F21_f - F21_c)\n        G21 = F21_f\n\n        # Step 3: Compute reciprocity-corrected pair and displacements\n        A1_sq, A2_sq = A1**2, A2**2\n        denominator = A1_sq + A2_sq\n        \n        # Avoid division by zero if both areas are zero\n        if denominator == 0:\n            F12_star, F21_star = G12, G21\n        else:\n            term = A2 * G12 + A1 * G21\n            F12_star = A2 * term / denominator\n            F21_star = A1 * term / denominator\n        \n        Delta12 = abs(F12_star - G12)\n        Delta21 = abs(F21_star - G21)\n\n        # Step 4: Report final error indicators\n        E12 = max(E12_ref, Delta12)\n        E21 = max(E21_ref, Delta21)\n\n        # Format results to 6 decimal places\n        case_results = [\n            f\"{F12_star:.6f}\",\n            f\"{F21_star:.6f}\",\n            f\"{E12:.6f}\",\n            f\"{E21:.6f}\"\n        ]\n        results.append(f\"[{','.join(case_results)}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2518472"}]}