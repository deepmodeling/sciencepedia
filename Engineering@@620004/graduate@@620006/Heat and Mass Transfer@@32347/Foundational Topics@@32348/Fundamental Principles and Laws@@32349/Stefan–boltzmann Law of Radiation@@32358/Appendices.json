{"hands_on_practices": [{"introduction": "The Stefan–Boltzmann law, $E_b = \\sigma T^4$, is fundamental to radiative heat transfer, but its fourth-power dependence on temperature has profound implications for experimental accuracy. This exercise will guide you through a first-order uncertainty analysis to quantify how a small error in temperature measurement is amplified in the calculated radiative power. Mastering this concept is essential for designing robust thermal measurement systems and correctly interpreting their results. [@problem_id:2526915]", "problem": "A laboratory determines the total hemispherical blackbody emissive power of a calibration cavity from its measured absolute temperature. The cavity behaves as an ideal black surface, and the total hemispherical blackbody emissive power is given by the Stefan–Boltzmann relation $E_{b}(T)=\\sigma T^{4}$, where $\\sigma$ is the Stefan–Boltzmann constant. The measurement system reports a relative uncertainty in the absolute temperature of $\\Delta T/T=0.010$ (that is, $\\pm 0.010$), attributable solely to the thermometer. Assume $\\sigma$ is exact for the purposes of this analysis, the blackbody assumption is valid, and the temperature uncertainty is sufficiently small that a first-order linearization is justified.\n\nStarting from the definition of a first-order Taylor linearization, namely that for a function $f(x)$ and a small increment $\\Delta x$, $f(x+\\Delta x)\\approx f(x)+f'(x)\\,\\Delta x$, derive the first-order propagated relative uncertainty in $E_{b}$ due to the temperature uncertainty. Then, evaluate it for the given temperature uncertainty.\n\nExpress the final propagated relative uncertainty in $E_{b}$ as a decimal fraction and round your answer to three significant figures. Additionally, briefly interpret what this result implies for designing radiative measurements that infer radiant heat flux from temperature measurements. The interpretation is not part of the numerical answer.", "solution": "The problem requires the derivation and evaluation of the propagated relative uncertainty in the blackbody emissive power, $E_b$, resulting from a known relative uncertainty in the measured absolute temperature, $T$. The relationship between these quantities is given by the Stefan–Boltzmann law, $E_b(T) = \\sigma T^4$.\n\nThe analysis begins with the principles of first-order uncertainty propagation. For a general function $y = f(x)$, the uncertainty in $y$, denoted as $\\Delta y$, can be approximated from the uncertainty in $x$, denoted as $\\Delta x$, using a first-order Taylor series expansion, provided that $\\Delta x$ is sufficiently small. This approximation is given by:\n$$ \\Delta y \\approx \\left| \\frac{df}{dx} \\right| \\Delta x $$\nTo find the relative uncertainty, $\\frac{\\Delta y}{y}$, we divide by the function value $y = f(x)$:\n$$ \\frac{\\Delta y}{y} \\approx \\frac{1}{|f(x)|} \\left| \\frac{df}{dx} \\right| \\Delta x = \\left| \\frac{f'(x)}{f(x)} \\right| \\Delta x $$\nThis can be expressed in terms of the relative uncertainty in $x$, $\\frac{\\Delta x}{x}$, as:\n$$ \\frac{\\Delta y}{y} \\approx \\left| \\frac{x f'(x)}{f(x)} \\right| \\frac{\\Delta x}{x} $$\n\nWe apply this general formalism to the specific function at hand, the Stefan–Boltzmann law for blackbody emissive power:\n$$ E_b(T) = \\sigma T^4 $$\nHere, the emissive power $E_b$ is analogous to $y$, and the absolute temperature $T$ is analogous to $x$. The function is $f(T) = \\sigma T^4$. The Stefan–Boltzmann constant $\\sigma$ is given as an exact constant, meaning it has zero uncertainty ($\\Delta \\sigma = 0$). The uncertainty therefore propagates only from the temperature measurement.\n\nFirst, we must compute the derivative of $E_b$ with respect to $T$:\n$$ \\frac{dE_b}{dT} = \\frac{d}{dT}(\\sigma T^4) $$\nSince $\\sigma$ is a constant, we have:\n$$ \\frac{dE_b}{dT} = 4 \\sigma T^3 $$\n\nNow, we can express the absolute uncertainty in emissive power, $\\Delta E_b$, using the first-order approximation:\n$$ \\Delta E_b \\approx \\left| \\frac{dE_b}{dT} \\right| \\Delta T = (4 \\sigma T^3) \\Delta T $$\nWe use absolute values for generality, but since power and temperature are non-negative, the absolute value signs can be dropped.\n\nThe problem asks for the *relative* uncertainty in $E_b$, which is $\\frac{\\Delta E_b}{E_b}$. To find this, we divide the expression for $\\Delta E_b$ by the original function $E_b(T) = \\sigma T^4$:\n$$ \\frac{\\Delta E_b}{E_b} \\approx \\frac{4 \\sigma T^3 \\Delta T}{\\sigma T^4} $$\n\nSimplifying this expression by canceling common terms ($\\sigma$ and $T^3$) yields the symbolic relationship between the relative uncertainties:\n$$ \\frac{\\Delta E_b}{E_b} \\approx 4 \\frac{\\Delta T}{T} $$\nThis is the derived first-order propagated relative uncertainty. It shows that the relative uncertainty in the emissive power is precisely four times the relative uncertainty in the absolute temperature. This factor of $4$ originates directly from the exponent in the Stefan-Boltzmann law.\n\nThe problem provides the numerical value for the relative uncertainty in temperature:\n$$ \\frac{\\Delta T}{T} = 0.010 $$\n\nWe substitute this value into our derived expression to find the numerical value of the relative uncertainty in the emissive power:\n$$ \\frac{\\Delta E_b}{E_b} \\approx 4 \\times 0.010 = 0.040 $$\nThe problem requires the answer to be rounded to three significant figures. The calculated value is $0.040$. To express it with three significant figures, we write it as $0.0400$.\n\nThe interpretation of this result is direct and fundamentally important in the field of radiometry and pyrometry. The fact that $\\frac{\\Delta E_b}{E_b} \\approx 4 \\frac{\\Delta T}{T}$ demonstrates a significant amplification of measurement uncertainty. A modest $1\\%$ uncertainty in temperature measurement leads to a $4\\%$ uncertainty in the inferred radiant power. This high sensitivity implies that for applications relying on the Stefan-Boltzmann law to determine radiative heat flux from temperature (for example, non-contact temperature sensing or furnace analysis), extremely high-precision temperature measurement is a critical design requirement. Any error in the thermometer is amplified by a factor of 4 in the final calculated radiative quantity, making temperature the dominant source of uncertainty in such systems.", "answer": "$$\\boxed{0.0400}$$", "id": "2526915"}, {"introduction": "While the Stefan–Boltzmann law provides the total emissive power, many applications in optics, astrophysics, and remote sensing depend on the energy within a specific wavelength band. This practice delves into Planck's distribution to show that the fraction of energy in any band is a universal function of the product $\\lambda T$. By implementing a numerical integration, you will gain hands-on experience in solving real-world problems that are analytically intractable and appreciate the connection between a body's temperature and its spectral signature. [@problem_id:2526932]", "problem": "A blackbody at absolute temperature $T$ radiates energy across all wavelengths. The hemispherical spectral emissive power per unit wavelength, $E_{b,\\lambda}(T)$, is given by Planck's law, and the total hemispherical emissive power is described by the Stefan–Boltzmann law. Using only these two fundamental laws, derive an expression for the fraction of total blackbody power emitted in a finite wavelength band $\\left[\\lambda_1,\\lambda_2\\right]$ as a dimensionless ratio of integrals that begin from first principles. Then implement a numerical algorithm to evaluate this fraction for specific test cases and interpret its temperature dependence.\n\nFundamental base:\n- Planck's law (hemispherical spectral emissive power per unit wavelength): $E_{b,\\lambda}(T)$ as a function of $\\lambda$ and $T$.\n- Stefan–Boltzmann law for the total emissive power: $E_b(T)$.\n- Physical constants to be used (in the International System of Units): Planck constant $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$, speed of light in vacuum $c = 2.99792458\\times 10^{8}\\ \\mathrm{m/s}$, Boltzmann constant $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$, Stefan–Boltzmann constant $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$.\n\nRequirements:\n1. Starting from Planck's law for $E_{b,\\lambda}(T)$ and the Stefan–Boltzmann law for $E_b(T)$, derive a dimensionless expression that shows the fraction of blackbody power in $\\left[\\lambda_1,\\lambda_2\\right]$ depends only on the products $\\lambda_1 T$ and $\\lambda_2 T$. Do not assume any pre-tabulated fraction functions; show the necessary change of variables explicitly from first principles.\n2. Implement a program that, for each test case below, computes the fraction\n$$F_{(\\lambda_1,\\lambda_2)}(T) = \\frac{1}{\\sigma T^4}\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(T)\\,\\mathrm{d}\\lambda,$$\nusing numerically stable quadrature. Use $\\lambda$ in meters and $T$ in kelvins. If the provided $\\lambda$ values are given in micrometers, convert to meters using $1\\ \\mu\\mathrm{m} = 10^{-6}\\ \\mathrm{m}$. Treat an upper bound of $+\\infty$ as an unbounded integral limit. Your algorithm must be robust for limits at $\\lambda=0$ and $\\lambda=+\\infty$.\n3. Scientific realism: Adopt Planck's law for hemispherical spectral emissive power and the Stefan–Boltzmann law as your only physical assumptions. Keep all quantities in the International System of Units. The computed fraction $F_{(\\lambda_1,\\lambda_2)}(T)$ must be dimensionless.\n4. Output specification: For each test case, output the numerical value of $F_{(\\lambda_1,\\lambda_2)}(T)$ as a floating-point number rounded to $8$ decimal places. Aggregate all results into a single line as a comma-separated list enclosed in square brackets. There must be no spaces within the list (e.g., around commas). For example, `[0.12345678,0.87654321]` is the correct format.\n\nTest suite:\n- Use the following parameter sets, where wavelengths are provided in micrometers and temperatures in kelvins. Convert micrometers to meters internally. The symbol $+\\infty$ denotes an unbounded upper wavelength limit.\n    1. $\\lambda_1 = 0\\ \\mu\\mathrm{m}$, $\\lambda_2 = +\\infty$, $T = 300\\ \\mathrm{K}$.\n    2. $\\lambda_1 = 0.38\\ \\mu\\mathrm{m}$, $\\lambda_2 = 0.78\\ \\mu\\mathrm{m}$, $T = 5800\\ \\mathrm{K}$.\n    3. $\\lambda_1 = 0.38\\ \\mu\\mathrm{m}$, $\\lambda_2 = 0.78\\ \\mu\\mathrm{m}$, $T = 3000\\ \\mathrm{K}$.\n    4. $\\lambda_1 = 8\\ \\mu\\mathrm{m}$, $\\lambda_2 = 14\\ \\mu\\mathrm{m}$, $T = 300\\ \\mathrm{K}$.\n    5. $\\lambda_1 = 0.1\\ \\mu\\mathrm{m}$, $\\lambda_2 = 0.4\\ \\mu\\mathrm{m}$, $T = 5800\\ \\mathrm{K}$.\n    6. $\\lambda_1 = 2.0\\ \\mu\\mathrm{m}$, $\\lambda_2 = 4.0\\ \\mu\\mathrm{m}$, $T = 1000\\ \\mathrm{K}$.\n    7. $\\lambda_1 = 1.0\\ \\mu\\mathrm{m}$, $\\lambda_2 = 2.0\\ \\mu\\mathrm{m}$, $T = 2000\\ \\mathrm{K}$.\n\nInterpretation prompt:\n- Based on the derived dimensionless expression, explain why the fraction for test cases $6$ and $7$ should be (to numerical precision) equal. Explain qualitatively how $F_{(0.38\\ \\mu\\mathrm{m},0.78\\ \\mu\\mathrm{m})}(T)$ changes between $T=3000\\ \\mathrm{K}$ and $T=5800\\ \\mathrm{K}$ in terms of the relative placement of the Wien peak with respect to the visible band.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces and with each float rounded to $8$ decimal places, for the test cases listed in the order above, for example, `[r_1,r_2,r_3,r_4,r_5,r_6,r_7]` where $r_i$ are the computed fractions as specified.", "solution": "The problem presented is a standard, well-posed exercise in the field of thermal radiation and heat transfer. It is scientifically grounded, requires derivation from first principles, and provides sufficient information for a unique solution. The problem is valid.\n\nThe objective is to derive an expression for the fraction of total blackbody emissive power within a specified wavelength band $[\\lambda_1, \\lambda_2]$ and then to compute this fraction for several test cases.\n\nLet us begin from first principles.\n\nThe hemispherical spectral emissive power of a blackbody at absolute temperature $T$ is given by Planck's law:\n$$E_{b,\\lambda}(\\lambda, T) = \\frac{C_1}{\\lambda^5 \\left( \\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1 \\right)}$$\nwhere $\\lambda$ is the wavelength. The constants $C_1$ and $C_2$ are the first and second radiation constants, respectively. They are defined in terms of fundamental physical constants:\n$C_1 = 2\\pi h c^2$\n$C_2 = \\frac{h c}{k_B}$\nHere, $h$ is the Planck constant, $c$ is the speed of light in vacuum, and $k_B$ is the Boltzmann constant.\n\nThe total hemispherical emissive power, $E_b(T)$, is the integral of the spectral emissive power over all wavelengths, from $\\lambda=0$ to $\\lambda=\\infty$:\n$$E_b(T) = \\int_{0}^{\\infty} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda$$\nThis integration leads to the Stefan–Boltzmann law, $E_b(T) = \\sigma T^4$, where $\\sigma$ is the Stefan–Boltzmann constant.\n\nThe fraction of total emissive power in the wavelength band $[\\lambda_1, \\lambda_2]$, denoted as $F_{(\\lambda_1, \\lambda_2)}(T)$, is the ratio of the power emitted in that band to the total power emitted:\n$$F_{(\\lambda_1, \\lambda_2)}(T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda}{\\int_{0}^{\\infty} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda} = \\frac{\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda}{\\sigma T^4}$$\nThe problem asks for this to be expressed in a form that depends only on the products $\\lambda_1 T$ and $\\lambda_2 T$. To achieve this, we perform a change of variables in the integral. Let us define a dimensionless variable $x$ as:\n$$x = \\frac{C_2}{\\lambda T} = \\frac{hc}{\\lambda k_B T}$$\nFrom this substitution, we can express $\\lambda$ and its differential $d\\lambda$ in terms of $x$:\n$$\\lambda = \\frac{C_2}{x T} \\implies d\\lambda = -\\frac{C_2}{x^2 T} \\, dx$$\nNow, substitute these into the expression for $E_{b,\\lambda}(\\lambda, T)$:\n$$E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = \\frac{C_1}{\\left(\\frac{C_2}{xT}\\right)^5 (\\exp(x) - 1)} \\left(-\\frac{C_2}{x^2 T} \\, dx\\right)$$\nSimplifying this expression:\n$$E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = -C_1 \\frac{(xT)^5}{C_2^5 (\\exp(x) - 1)} \\frac{C_2}{x^2 T} \\, dx = -\\frac{C_1 T^4}{C_2^4} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\nThe power emitted in the band $[\\lambda_1, \\lambda_2]$ is the integral:\n$$\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = \\int_{x_1}^{x_2} \\left(-\\frac{C_1 T^4}{C_2^4} \\frac{x^3}{\\exp(x) - 1} \\, dx\\right) = \\frac{C_1 T^4}{C_2^4} \\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\nwhere the integration limits in terms of $x$ are $x_1 = \\frac{C_2}{\\lambda_1 T}$ and $x_2 = \\frac{C_2}{\\lambda_2 T}$. Note that the inversion of integration limits cancels the negative sign.\n\nThe total emissive power is the integral over all wavelengths, which corresponds to $x$ from $\\infty$ (for $\\lambda=0$) to $0$ (for $\\lambda=\\infty$):\n$$\\sigma T^4 = \\int_{0}^{\\infty} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = \\frac{C_1 T^4}{C_2^4} \\int_{0}^{\\infty} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\nThe definite integral $\\int_{0}^{\\infty} \\frac{x^3}{e^x - 1} \\, dx$ is a standard form related to the Bose-Einstein integral and Riemann zeta function, and its value is known to be $\\frac{\\pi^4}{15}$.\nThus, we can express the Stefan-Boltzmann constant as:\n$$\\sigma = \\frac{C_1}{C_2^4} \\frac{\\pi^4}{15} = \\frac{2\\pi h c^2}{\\left(\\frac{hc}{k_B}\\right)^4} \\frac{\\pi^4}{15} = \\frac{2\\pi^5 k_B^4}{15 h^3 c^2}$$\nThis confirms the relationship between the fundamental constants.\n\nNow, we can write the fraction $F_{(\\lambda_1, \\lambda_2)}(T)$ as a ratio of dimensionless integrals:\n$$F_{(\\lambda_1, \\lambda_2)}(T) = \\frac{\\frac{C_1 T^4}{C_2^4} \\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x) - 1} \\, dx}{\\frac{C_1 T^4}{C_2^4} \\int_{0}^{\\infty} \\frac{x^3}{\\exp(x) - 1} \\, dx} = \\frac{\\int_{C_2/(\\lambda_2 T)}^{C_2/(\\lambda_1 T)} \\frac{x^3}{\\exp(x) - 1} \\, dx}{\\int_{0}^{\\infty} \\frac{x^3}{\\exp(x) - 1} \\, dx}$$\nSubstituting the value of the denominator integral:\n$$F_{(\\lambda_1, \\lambda_2)}(T) = \\frac{15}{\\pi^4} \\int_{C_2/(\\lambda_2 T)}^{C_2/(\\lambda_1 T)} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\nThis expression demonstrates explicitly that the fraction $F_{(\\lambda_1, \\lambda_2)}(T)$ is a function only of the products $\\lambda_1 T$ and $\\lambda_2 T$, as required. This framework is ideal for numerical evaluation due to the well-behaved nature of the dimensionless integrand.\n\nNow, for the interpretation prompt:\n1.  **Equality of fractions for test cases 6 and 7**:\n    For case 6: $\\lambda_1 = 2.0 \\times 10^{-6}\\ \\mathrm{m}$, $\\lambda_2 = 4.0 \\times 10^{-6}\\ \\mathrm{m}$, $T = 1000\\ \\mathrm{K}$.\n    The products are $\\lambda_1 T = 2000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$ and $\\lambda_2 T = 4000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$.\n    For case 7: $\\lambda_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}$, $\\lambda_2 = 2.0 \\times 10^{-6}\\ \\mathrm{m}$, $T = 2000\\ \\mathrm{K}$.\n    The products are $\\lambda_1 T = 2000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$ and $\\lambda_2 T = 4000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$.\n    As derived, the fraction $F_{(\\lambda_1, \\lambda_2)}(T)$ depends only on the products $\\lambda_1 T$ and $\\lambda_2 T$, which determine the integration limits for the dimensionless variable $x$. Since these products are identical for both cases, the value of the fraction must also be identical, up to the precision of the numerical calculation.\n\n2.  **Change in fraction for the visible band ($0.38 - 0.78\\ \\mu\\mathrm{m}$) with temperature**:\n    This analysis involves Wien's displacement law, which is a direct consequence of Planck's law. The law states that the wavelength of maximum spectral emission, $\\lambda_{\\max}$, is inversely proportional to the temperature: $\\lambda_{\\max} T = b$, where $b \\approx 2898\\ \\mu\\mathrm{m} \\cdot \\mathrm{K}$.\n    For $T = 3000\\ \\mathrm{K}$ (case 3), the peak emission occurs at $\\lambda_{\\max} \\approx \\frac{2898}{3000} \\approx 0.97\\ \\mu\\mathrm{m}$. This wavelength is in the near-infrared, just beyond the red end of the visible band ($0.78\\ \\mu\\mathrm{m}$). Therefore, at $3000\\ \\mathrm{K}$, the bulk of the radiated energy is at wavelengths longer than visible light, and only a fraction falls within the visible spectrum.\n    For $T = 5800\\ \\mathrm{K}$ (case 2), which is approximately the sun's surface temperature, the peak emission is at $\\lambda_{\\max} \\approx \\frac{2898}{5800} \\approx 0.50\\ \\mu\\mathrm{m}$. This wavelength lies in the green-yellow part of the spectrum, squarely in the middle of the visible band ($0.38-0.78\\ \\mu\\mathrm{m}$).\n    As the temperature increases from $3000\\ \\mathrm{K}$ to $5800\\ \\mathrm{K}$, the peak of the Planck distribution shifts from the infrared into the visible range. Consequently, a much larger proportion of the total radiated energy is emitted within the visible wavelengths. Therefore, $F_{(0.38\\ \\mu\\mathrm{m},0.78\\ \\mu\\mathrm{m})}(5800\\ \\mathrm{K})$ will be significantly larger than $F_{(0.38\\ \\mu\\mathrm{m},0.78\\ \\mu\\mathrm{m})}(3000\\ \\mathrm{K})$. The body appears to glow more brightly and shift in color from reddish to yellowish-white.\n\nThe numerical implementation will use the derived dimensionless integral formulation for superior stability and accuracy.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the fraction of blackbody radiation in a wavelength band for given test cases.\n    \"\"\"\n    # Define physical constants from the problem statement.\n    H = 6.62607015e-34  # Planck constant (J.s)\n    C = 2.99792458e8    # Speed of light in vacuum (m/s)\n    KB = 1.380649e-23     # Boltzmann constant (J/K)\n    # The Stefan-Boltzmann constant SIGMA is not needed due to the dimensionless integral formulation.\n\n    # Calculate the second radiation constant.\n    C2 = H * C / KB  # (m.K)\n\n    # Test suite: (lambda1_um, lambda2_um, T_K)\n    # Wavelengths are in micrometers and will be converted to meters.\n    test_cases = [\n        (0, np.inf, 300),        # Case 1: Full spectrum, should be 1.0\n        (0.38, 0.78, 5800),     # Case 2: Visible light at sun's temperature\n        (0.38, 0.78, 3000),     # Case 3: Visible light at lower temperature\n        (8, 14, 300),           # Case 4: Thermal infrared at room temperature\n        (0.1, 0.4, 5800),       # Case 5: Ultraviolet at sun's temperature\n        (2.0, 4.0, 1000),       # Case 6: Test for lambda*T scaling\n        (1.0, 2.0, 2000),       # Case 7: Test for lambda*T scaling\n    ]\n\n    results = []\n\n    # The dimensionless integrand from the derivation.\n    def integrand(x):\n        \"\"\"\n        Dimensionless integrand x^3 / (exp(x) - 1).\n        This form is numerically stable.\n        \"\"\"\n        # For very large x, exp(x) overflows, but the integrand approaches 0.\n        # np.exp(709.78) is the approximate float limit.\n        if x > 700:\n            return 0.0\n        # For very small x, the denominator approaches 0, but can be approximated.\n        # However, `quad` handles this endpoint singularity correctly.\n        if x == 0:\n            return 0.0 # Mathematically the limit is 0 as x^3 dominates.\n        return x**3 / (np.exp(x) - 1)\n\n    # The value of the total integral from 0 to infinity is known analytically.\n    # integral_0^inf [x^3 / (exp(x) - 1)] dx = pi^4 / 15\n    total_integral_val = np.pi**4 / 15\n\n    for l1_um, l2_um, T in test_cases:\n        # Convert wavelengths from micrometers to meters.\n        l1_m = l1_um * 1e-6\n        l2_m = l2_um * 1e-6\n\n        # Calculate the integration limits for the dimensionless variable x.\n        # x = C2 / (lambda * T)\n        # Handle boundary cases for lambda = 0 and lambda = +inf.\n        if l1_m == 0:\n            x1 = np.inf\n        else:\n            x1 = C2 / (l1_m * T)\n\n        if np.isinf(l2_m):\n            x2 = 0\n        else:\n            x2 = C2 / (l2_m * T)\n\n        # The integral is from x2 to x1, as d(lambda) introduces a negative sign.\n        # quad(func, a, b) integrates from a to b.\n        integral_val, _ = quad(integrand, x2, x1)\n\n        # The fraction is the ratio of the band integral to the total integral.\n        fraction = integral_val / total_integral_val\n        results.append(f\"{fraction:.8f}\")\n\n    # Final print statement must be a single-line, comma-separated list\n    # enclosed in square brackets with no spaces.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2526932"}, {"introduction": "Real-world engineering systems rarely consist of a single surface in a simple environment; they are typically enclosures with multiple interacting surfaces. This problem extends the Stefan–Boltzmann law to analyze such systems by introducing the concepts of radiosity and view factors to set up a linear system describing the radiative exchange. Solving this problem will equip you with the foundational \"net radiation method\" used to predict heat loads in complex geometries like furnaces and spacecraft. [@problem_id:2526903]", "problem": "You are given a closed, three-surface, isothermal, diffuse-gray enclosure. For each surface $i \\in \\{1,2,3\\}$, the radiosity $J_i$ and irradiation $G_i$ satisfy energy conservation and the diffuse-gray property under opaque conditions. Use the Stefan–Boltzmann law of radiation to derive a linear system that determines $J_i$ for given surface absolute temperatures $T_i$ and surface emissivities $\\varepsilon_i$. Then, compute the net radiative heat rate leaving each surface, $q_i$, using the enclosure view factors $F_{ij}$ and the surface areas $A_i$.\n\nYour derivation must start from the following fundamental base and core definitions:\n- The Stefan–Boltzmann law: the blackbody emissive power of surface $i$ is $E_{b,i} = \\sigma T_i^4$, where $\\sigma$ is the Stefan–Boltzmann constant.\n- For an opaque, diffuse-gray surface, the emissivity equals the absorptivity by Kirchhoff’s law, and the hemispherical reflectivity is $\\rho_i = 1 - \\varepsilon_i$.\n- The definition of radiosity $J_i$ (total energy leaving surface $i$ per unit area by radiation, including both emitted and reflected components) and irradiation $G_i$ (total energy incident on surface $i$ by radiation).\n- Shape factor properties for enclosures: $F_{ij} \\ge 0$, $\\sum_{j=1}^{3} F_{ij} = 1$ for each $i$, and the reciprocity relation $A_i F_{ij} = A_j F_{ji}$.\n\nTasks:\n1. Derive a linear system for the radiosities $J_1, J_2, J_3$ by combining the conservation definition of radiosity with the diffuse-gray property and the enclosure irradiation written in terms of view factors and radiosities. The system must be explicitly stated in the form $\\sum_{j=1}^{3} M_{ij} J_j = b_i$, with $M_{ij}$ and $b_i$ defined in terms of $\\varepsilon_i$, $F_{ij}$, and $T_i$.\n2. Describe, in a logically sound sequence, how to compute $q_i$ once $J_i$ are known. Your steps must begin from first principles and end with an implementable algorithm.\n\nNumerical data for the enclosure geometry:\n- Surface areas: $A_1 = 2\\,\\mathrm{m}^2$, $A_2 = 3\\,\\mathrm{m}^2$, $A_3 = 5\\,\\mathrm{m}^2$.\n- View-factor matrix $F = [F_{ij}]$ with rows summing to $1$ and satisfying reciprocity:\n  - Row $1$: $F_{11} = 0.1$, $F_{12} = 0.3$, $F_{13} = 0.6$.\n  - Row $2$: $F_{21} = 0.2$, $F_{22} = 0.3$, $F_{23} = 0.5$.\n  - Row $3$: $F_{31} = 0.24$, $F_{32} = 0.3$, $F_{33} = 0.46$.\n\nPhysical constants and units:\n- Use $\\sigma = 5.670374419 \\times 10^{-8}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$.\n- Temperatures must be in kelvins ($\\mathrm{K}$).\n- Heat rates must be reported in watts ($\\mathrm{W}$).\n\nThe program you will write must implement your derived linear system and computation steps, and produce numerical answers for the following test suite. For each case, compute the vector of net radiative heat rates leaving the surfaces, $\\left[q_1, q_2, q_3\\right]$ in $\\mathrm{W}$.\n\nTest suite:\n- Case $1$ (general mixed emissivities and temperatures):\n  - $\\varepsilon = [0.7, 0.9, 0.5]$, $T = [1000, 800, 600]\\,\\mathrm{K}$.\n- Case $2$ (boundary case: black enclosure at equal temperature):\n  - $\\varepsilon = [1.0, 1.0, 1.0]$, $T = [800, 800, 800]\\,\\mathrm{K}$.\n- Case $3$ (edge case: two nearly specular-like low-emissivity surfaces, one high-emissivity):\n  - $\\varepsilon = [0.05, 0.05, 0.9]$, $T = [1200, 500, 500]\\,\\mathrm{K}$.\n\nOutput specification:\n- Express each $q_i$ in $\\mathrm{W}$, rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a list of lists, each inner list being the three heat rates for one case, in the same order as the test suite. The format must be exactly:\n  - `[[q_{1,1},q_{1,2},q_{1,3}],[q_{2,1},q_{2,2},q_{2,3}],[q_{3,1},q_{3,2},q_{3,3}]]`\n  where $q_{k,i}$ denotes the heat rate for surface $i$ in case $k$.\n\nNotes:\n- Assume all surfaces are opaque and isothermal, only surface-to-surface radiation inside the enclosure, and no participating medium.\n- Ensure numerical consistency by verifying that $\\sum_{i=1}^{3} q_i$ is approximately $0$ in each case (energy conservation inside a closed enclosure), acknowledging minor numerical round-off.\n\nAnswer all values in watts ($\\mathrm{W}$), rounded to six decimal places, and adhere strictly to the required output format.", "solution": "The problem statement is validated as scientifically sound, self-contained, consistent, and well-posed. The provided data for surface areas and view factors correctly satisfies the geometric constraints of a closed enclosure, specifically the summation and reciprocity rules. The problem is a standard, non-trivial application of radiative heat transfer principles. The solution is derived from first principles as follows.\n\nThe analysis is for a closed, three-surface enclosure where all surfaces are opaque, isothermal, and diffuse-gray emitters and reflectors.\n\n**Task 1: Derivation of the Linear System for Radiosities**\n\nThe derivation proceeds by establishing a system of equations for the radiosity $J_i$ of each surface $i \\in \\{1, 2, 3\\}$.\n\n1.  **Definition of Radiosity**: The radiosity ($J_i$, in $\\mathrm{W}\\,\\mathrm{m}^{-2}$) is the total radiant energy leaving surface $i$ per unit area. It is the sum of emitted and reflected energy:\n    $$J_i = E_i + \\rho_i G_i$$\n    where $E_i$ is the emissive power of surface $i$, $\\rho_i$ is its reflectivity, and $G_i$ is the irradiation (incident energy per unit area) on surface $i$. For a gray surface, the emissive power is $E_i = \\varepsilon_i E_{b,i}$, where $\\varepsilon_i$ is the emissivity and $E_{b,i}$ is the blackbody emissive power given by the Stefan-Boltzmann law:\n    $$E_{b,i} = \\sigma T_i^4$$\n    Here, $\\sigma$ is the Stefan–Boltzmann constant ($5.670374419 \\times 10^{-8}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$) and $T_i$ is the absolute temperature of surface $i$.\n\n2.  **Surface Properties**: For an opaque, diffuse-gray surface, Kirchhoff's law of thermal radiation states that the absorptivity $\\alpha_i$ equals the emissivity $\\varepsilon_i$. Since the surface is opaque, the sum of its reflectivity, absorptivity, and transmissivity is unity, with transmissivity being zero. This yields $\\rho_i + \\alpha_i = 1$, which implies:\n    $$\\rho_i = 1 - \\varepsilon_i$$\n    Substituting these relations into the radiosity definition gives:\n    $$J_i = \\varepsilon_i E_{b,i} + (1 - \\varepsilon_i) G_i$$\n\n3.  **Definition of Irradiation**: The irradiation $G_i$ on surface $i$ is the sum of radiative energy arriving from all surfaces (including itself) in the enclosure. For a diffuse enclosure with $N=3$ surfaces, the energy leaving surface $j$ is $A_j J_j$. The fraction of this energy that reaches surface $i$ is the view factor $F_{ji}$. The total energy incident on surface $i$ is $\\sum_{j=1}^{3} (A_j J_j) F_{ji}$. The irradiation per unit area is therefore:\n    $$G_i = \\frac{1}{A_i} \\sum_{j=1}^{3} A_j F_{ji} J_j$$\n    Using the reciprocity relation for view factors, $A_j F_{ji} = A_i F_{ij}$, this simplifies to a key result for enclosure analysis:\n    $$G_i = \\frac{1}{A_i} \\sum_{j=1}^{3} A_i F_{ij} J_j = \\sum_{j=1}^{3} F_{ij} J_j$$\n\n4.  **Formulation of the Linear System**: To create a system of equations for the radiosities $J_j$, we substitute the expression for $G_i$ into the radiosity equation:\n    $$J_i = \\varepsilon_i E_{b,i} + (1 - \\varepsilon_i) \\sum_{j=1}^{3} F_{ij} J_j$$\n    This equation must hold for each surface $i = 1, 2, 3$. To formulate a standard linear system of the form $\\sum_{j=1}^{3} M_{ij} J_j = b_i$, we rearrange the equation to group all terms involving the unknown radiosities $J_j$ on one side:\n    $$J_i - (1 - \\varepsilon_i) \\sum_{j=1}^{3} F_{ij} J_j = \\varepsilon_i E_{b,i}$$\n    This can be written more formally using the Kronecker delta, $\\delta_{ij}$ (where $\\delta_{ij} = 1$ if $i=j$ and $0$ otherwise), by noting that $J_i = \\sum_{j=1}^{3} \\delta_{ij} J_j$:\n    $$\\sum_{j=1}^{3} \\delta_{ij} J_j - \\sum_{j=1}^{3} (1 - \\varepsilon_i) F_{ij} J_j = \\varepsilon_i E_{b,i}$$\n    Combining the summations gives the final form of the linear system:\n    $$\\sum_{j=1}^{3} \\left[ \\delta_{ij} - (1 - \\varepsilon_i) F_{ij} \\right] J_j = \\varepsilon_i E_{b,i}$$\n    This system is of the form $\\mathbf{M}\\mathbf{J} = \\mathbf{b}$, where $\\mathbf{J}$ is the vector of unknown radiosities $[J_1, J_2, J_3]^T$. The coefficients of the matrix $\\mathbf{M}$ and the vector $\\mathbf{b}$ are:\n    $$M_{ij} = \\delta_{ij} - (1 - \\varepsilon_i) F_{ij}$$\n    $$b_i = \\varepsilon_i E_{b,i} = \\varepsilon_i \\sigma T_i^4$$\n    Solving this $3 \\times 3$ linear system yields the required radiosities.\n\n**Task 2: Computation of Net Radiative Heat Rates**\n\nOnce the radiosities are known, the net radiative heat rate $q_i$ (in $\\mathrm{W}$) leaving each surface can be computed.\n\n1.  **Definition of Net Heat Rate**: The net heat rate $q_i$ leaving surface $i$ is the difference between the total energy leaving the surface ($A_i J_i$) and the total energy incident upon it ($A_i G_i$):\n    $$q_i = A_i (J_i - G_i)$$\n\n2.  **Derivation of the Computational Formula**: We substitute the expression for irradiation $G_i = \\sum_{j=1}^{3} F_{ij} J_j$ into the definition of $q_i$:\n    $$q_i = A_i \\left( J_i - \\sum_{j=1}^{3} F_{ij} J_j \\right)$$\n    For a closed enclosure, the summation rule for view factors states that $\\sum_{j=1}^{3} F_{ij} = 1$. This allows us to express $J_i$ as $J_i \\times 1 = J_i \\sum_{j=1}^{3} F_{ij} = \\sum_{j=1}^{3} F_{ij} J_i$. Substituting this into the equation for $q_i$:\n    $$q_i = A_i \\left( \\sum_{j=1}^{3} F_{ij} J_i - \\sum_{j=1}^{3} F_{ij} J_j \\right)$$\n    Combining the summations gives the final expression used for computation:\n    $$q_i = A_i \\sum_{j=1}^{3} F_{ij} (J_i - J_j)$$\n    This formulation is robust and valid for all values of emissivity, including the limiting case of a blackbody ($\\varepsilon_i = 1$). An alternative form, $q_i = \\frac{A_i \\varepsilon_i}{1-\\varepsilon_i} (E_{b,i} - J_i)$, becomes indeterminate for a blackbody and is thus not used for general implementation.\n\n**Computational Algorithm**\n\nThe overall procedure to solve the problem for a given test case is:\n1.  For each surface $i$, calculate the blackbody emissive power $E_{b,i} = \\sigma T_i^4$.\n2.  Construct the $3 \\times 3$ matrix $\\mathbf{M}$ and the $3 \\times 1$ vector $\\mathbf{b}$ using the derived coefficients $M_{ij}$ and $b_i$.\n3.  Solve the linear system $\\mathbf{M}\\mathbf{J} = \\mathbf{b}$ for the radiosity vector $\\mathbf{J} = [J_1, J_2, J_3]^T$.\n4.  Calculate the net heat rate $q_i$ for each surface using the computed radiosities $\\mathbf{J}$ and the formula $q_i = A_i \\sum_{j=1}^{3} F_{ij} (J_i - J_j)$.\n5.  Verify that $\\sum_{i=1}^{3} q_i \\approx 0$, which must hold due to energy conservation in a closed system.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the net radiative heat rates in a three-surface enclosure\n    for a given set of test cases.\n    \"\"\"\n\n    # Physical constants and geometry\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant, W m^-2 K^-4\n    AREAS = np.array([2.0, 3.0, 5.0])  # Surface areas A_i, m^2\n    F_MATRIX = np.array([\n        [0.1, 0.3, 0.6],\n        [0.2, 0.3, 0.5],\n        [0.24, 0.3, 0.46]\n    ])  # View factor matrix F_ij\n\n    # Test suite\n    test_cases = [\n        {\n            \"emissivity\": np.array([0.7, 0.9, 0.5]),\n            \"temperature\": np.array([1000.0, 800.0, 600.0])\n        },\n        {\n            \"emissivity\": np.array([1.0, 1.0, 1.0]),\n            \"temperature\": np.array([800.0, 800.0, 800.0])\n        },\n        {\n            \"emissivity\": np.array([0.05, 0.05, 0.9]),\n            \"temperature\": np.array([1200.0, 500.0, 500.0])\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        epsilons = case[\"emissivity\"]\n        temps = case[\"temperature\"]\n        \n        # 1. Calculate blackbody emissive powers (E_b,i = sigma * T_i^4)\n        e_b = SIGMA * (temps ** 4)\n\n        # 2. Construct the linear system MJ = b\n        # M_ij = delta_ij - (1 - epsilon_i) * F_ij\n        # b_i = epsilon_i * E_b,i\n        num_surfaces = 3\n        m_matrix = np.zeros((num_surfaces, num_surfaces))\n        b_vector = np.zeros(num_surfaces)\n\n        for i in range(num_surfaces):\n            b_vector[i] = epsilons[i] * e_b[i]\n            for j in range(num_surfaces):\n                delta_ij = 1.0 if i == j else 0.0\n                m_matrix[i, j] = delta_ij - (1.0 - epsilons[i]) * F_MATRIX[i, j]\n\n        # 3. Solve for radiosities J\n        radiosities = np.linalg.solve(m_matrix, b_vector)\n\n        # 4. Calculate net heat rates q_i\n        # q_i = A_i * sum_j(F_ij * (J_i - J_j))\n        # This can be computed as: q_i = A_i * (J_i * sum_j(F_ij) - sum_j(F_ij * J_j))\n        # Since sum_j(F_ij) = 1, this simplifies to: q_i = A_i * (J_i - sum_j(F_ij * J_j))\n        q_rates = np.zeros(num_surfaces)\n        for i in range(num_surfaces):\n            sum_fj = np.dot(F_MATRIX[i, :], radiosities)\n            q_rates[i] = AREAS[i] * (radiosities[i] - sum_fj)\n\n        # Store rounded results for the current case\n        rounded_q = [round(q, 6) for q in q_rates]\n        all_results.append(rounded_q)\n\n    # Format the final output string as specified\n    # Format: [[q11,q12,q13],[q21,q22,q23],[q31,q32,q33]]\n    output_parts = []\n    for result_list in all_results:\n        # Using f-string format specifier for consistent 6 decimal places\n        inner_str = ','.join([f\"{val:.6f}\" for val in result_list])\n        output_parts.append(f\"[{inner_str}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2526903"}]}