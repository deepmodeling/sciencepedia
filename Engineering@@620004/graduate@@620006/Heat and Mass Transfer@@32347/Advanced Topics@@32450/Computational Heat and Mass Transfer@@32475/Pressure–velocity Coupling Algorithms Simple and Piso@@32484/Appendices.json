{"hands_on_practices": [{"introduction": "To truly understand a numerical algorithm, we must build it from its foundations. This first exercise guides you through the conceptual derivation of the pressure correction equation, which is the heart of the SIMPLE algorithm. By starting from the discretized momentum and continuity equations for a simplified one-dimensional flow, you will see precisely how and why the pressure and velocity fields are coupled and how the key approximations of SIMPLE lead to a solvable system for the pressure correction field [@problem_id:2516621].", "problem": "Consider one-dimensional, steady, incompressible, laminar flow of a Newtonian fluid through a straight duct of constant rectangular cross-section area $A$. The flow is aligned with the $x$-direction, properties are uniform, and the Reynolds number is sufficiently low that convection can be neglected relative to viscous diffusion. The computational arrangement is a uniform staggered grid: pressure is stored at cell centers and velocity at cell faces. Let the pressure control volumes have uniform spacing $\\Delta x$. \n\nYou are to conceptually derive the pressure–velocity coupling step used in the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE). Use the following assumptions:\n\n- The $x$-momentum equation is the only momentum balance, written for each staggered velocity control volume and discretized by central differencing of the viscous term and a pressure-gradient source integrated over the control volume length $\\Delta x$.\n- Body forces, transients, and convection are neglected.\n- Let $u^{*}$ denote the guessed (predicted) velocity, and let the pressure and velocity corrections be $p'$ and $u'$, so that the corrected fields are $p = p^{*} + p'$ and $u = u^{*} + u'$.\n\nTasks:\n\n1. Starting from the steady, incompressible mass conservation in integral form for a pressure control volume and the $x$-momentum balance in integral form for a staggered velocity control volume, and using linearization about the guessed fields, derive the local linear relation between a face velocity correction and adjacent pressure corrections of the form\n   $$u'_{f} = d_{f}\\,\\big(p'_{L} - p'_{R}\\big),$$\n   where $f$ denotes a face, and $L$ and $R$ are the left and right neighboring pressure nodes adjacent to face $f$. Express $d_{f}$ in terms of the momentum discretization coefficient at the face and the geometric quantities.\n\n2. Enforce discrete mass conservation on an interior pressure control volume $P$ by requiring that the net volumetric flux through its faces is zero after correction. Using the relation from Task 1 at the west face $W$ and east face $E$ of $P$, derive the three-point pressure-correction equation\n   $$a_{P}^{p'}\\,p'_{P} \\;=\\; a_{W}^{p'}\\,p'_{W} \\;+\\; a_{E}^{p'}\\,p'_{E} \\;+\\; b_{P},$$\n   and obtain a closed-form expression for the diagonal coefficient $a_{P}^{p'}$ in terms of $A$ and the momentum coefficients at faces $W$ and $E$.\n\n3. For constant properties on a uniform grid with central differencing of the viscous term, the face momentum coefficient for diffusion-only balance takes the form $a_{u} = 2\\,\\mu\\,A/\\Delta x$ at each interior face, where $\\mu$ is the dynamic viscosity. Use this to simplify your expression for $a_{P}^{p'}$ to a closed form that depends only on $A$, $\\mu$, and $\\Delta x$.\n\n4. Evaluate the resulting expression for $a_{P}^{p'}$ for $A = 1.0 \\times 10^{-2}\\,\\mathrm{m^{2}}$, $\\mu = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, and $\\Delta x = 5.0 \\times 10^{-2}\\,\\mathrm{m}$. Express the final value of $a_{P}^{p'}$ in $\\mathrm{m^{3}/(s\\cdot Pa)}$ and round your answer to four significant figures.", "solution": "The problem requires the derivation of the core equations for the pressure-correction step in the SIMPLE algorithm for a simplified one-dimensional, steady, incompressible flow, followed by a numerical evaluation. The derivation will proceed step-by-step as requested.\n\nFirst, we derive the relationship between the velocity correction at a cell face and the pressure corrections in the adjacent control volumes. The discretized $x$-momentum equation for the velocity $u_f$ at a generic face $f$, under the given assumptions of negligible convection, transients, and body forces, relates the viscous forces to the pressure gradient. In the standard finite-volume form, this is written as:\n$$a_f u_f = \\sum_{nb} a_{nb} u_{nb} + (p_L - p_R)A$$\nwhere $a_f$ is the primary momentum discretization coefficient for $u_f$, $\\sum_{nb} a_{nb} u_{nb}$ represents the contribution from neighboring velocities due to viscous diffusion, $A$ is the cross-sectional area, and $p_L$ and $p_R$ are the pressures at the nodes to the left and right of face $f$. The SIMPLE algorithm uses a predictor-corrector approach. A guessed pressure field $p^*$ is used to solve the momentum equation for a predicted velocity field $u^*$:\n$$a_f u_f^* = \\left(\\sum_{nb} a_{nb} u_{nb}\\right)^* + (p_L^* - p_R^*)A$$\nHere, the term involving neighboring velocities is evaluated using the best available values, typically from the previous iteration. The corrected fields, $p = p^*+p'$ and $u = u^*+u'$, must satisfy the full momentum equation:\n$$a_f (u_f^*+u_f') = \\sum_{nb} a_{nb} (u_{nb}^*+u_{nb}') + (p_L^*+p_L' - (p_R^*+p_R'))A$$\nSubtracting the predictor equation from the full equation yields an equation for the corrections:\n$$a_f u_f' = \\sum_{nb} a_{nb} u_{nb}' + (p_L' - p_R')A$$\nA central approximation of the SIMPLE algorithm is to neglect the term $\\sum_{nb} a_{nb} u_{nb}'$, which contains the corrections of neighboring velocities. This omission decouples the velocity correction equations, yielding a simple, explicit relation for each velocity correction:\n$$a_f u_f' \\approx (p_L' - p_R')A$$\nRearranging this gives the desired linear relation between the velocity correction $u_f'$ and the adjacent pressure corrections $p_L'$ and $p_R'$:\n$$u_f' = \\frac{A}{a_f} (p_L' - p_R')$$\nComparing this to the requested form $u'_{f} = d_{f}\\,\\big(p'_{L} - p'_{R}\\big)$, we identify the coefficient $d_f$ as:\n$$d_f = \\frac{A}{a_f}$$\nThis coefficient links the velocity correction to the pressure correction gradient, with its magnitude determined by the area $A$ and the momentum coefficient $a_f$.\n\nNext, we enforce mass conservation to derive the pressure-correction equation. For a pressure control volume centered at node $P$, with west face $w$ and east face $e$, the steady, incompressible mass conservation requires the net volumetric flux to be zero: $(uA)_e - (uA)_w = 0$. Since the area $A$ is constant, this simplifies to $A(u_e - u_w) = 0$. The corrected velocity field must satisfy this condition:\n$$A\\left( (u_e^* + u_e') - (u_w^* + u_w') \\right) = 0$$\nThis implies that the corrections must balance the mass imbalance from the predicted field:\n$$A(u_e' - u_w') = -A(u_e^* - u_w^*) = A(u_w^* - u_e^*)$$\nWe now substitute the velocity correction formula. The east face $e$ is between nodes $P$ and $E$, so $u_e' = d_e(p_P' - p_E')$. The west face $w$ is between nodes $W$ and $P$, so $u_w' = d_w(p_W' - p_P')$. Substituting these into the continuity equation gives:\n$$A \\left[ d_e(p_P' - p_E') - d_w(p_W' - p_P') \\right] = A(u_w^* - u_e^*)$$\nGrouping terms for the unknown pressure corrections $p_W'$, $p_P'$, and $p_E'$ yields:\n$$A(d_e + d_w)p_P' - A d_w p_W' - A d_e p_E' = A(u_w^* - u_e^*)$$\nRearranging this into the standard linear system form $a_{P}^{p'}\\,p'_{P} = a_{W}^{p'}\\,p'_{W} + a_{E}^{p'}\\,p'_{E} + b_{P}$ gives:\n$$A(d_e + d_w)p_P' = A d_w p_W' + A d_e p_E' + A(u_w^* - u_e^*)$$\nBy comparing the two forms, we identify the coefficients: $a_W^{p'} = Ad_w$, $a_E^{p'} = Ad_e$, $b_P = A(u_w^* - u_e^*)$, and the diagonal coefficient:\n$$a_P^{p'} = a_W^{p'} + a_E^{p'} = A(d_e + d_w)$$\nUsing the expression $d_f = A/a_f$ derived previously, we express $a_P^{p'}$ in terms of the area $A$ and the momentum coefficients $a_w$ and $a_e$ at the west and east faces, respectively:\n$$a_P^{p'} = A \\left( \\frac{A}{a_e} + \\frac{A}{a_w} \\right) = A^2 \\left( \\frac{1}{a_e} + \\frac{1}{a_w} \\right)$$\n\nFor the third task, we simplify this expression using the provided formula for the momentum coefficient on a uniform grid with central differencing for diffusion only: $a_u = 2\\,\\mu\\,A/\\Delta x$. Since the grid is uniform and properties are constant, we have $a_w = a_e = a_u = 2\\,\\mu\\,A/\\Delta x$. Substituting this into our expression for $a_P^{p'}$:\n$$a_P^{p'} = A^2 \\left( \\frac{1}{2\\mu A/\\Delta x} + \\frac{1}{2\\mu A/\\Delta x} \\right) = A^2 \\left( \\frac{\\Delta x}{2\\mu A} + \\frac{\\Delta x}{2\\mu A} \\right)$$\n$$a_P^{p'} = A^2 \\left( \\frac{2\\Delta x}{2\\mu A} \\right) = A^2 \\left( \\frac{\\Delta x}{\\mu A} \\right)$$\nThis simplifies to a remarkably concise form:\n$$a_P^{p'} = \\frac{A \\Delta x}{\\mu}$$\nThe units of this expression are $(m^2 \\cdot m) / (Pa \\cdot s)$, which is $m^3/(Pa \\cdot s)$, confirming consistency with the pressure correction equation where $b_P$ has units of volumetric flow rate ($m^3/s$).\n\nFinally, we evaluate this expression for the given numerical values: $A = 1.0 \\times 10^{-2}\\,\\mathrm{m^{2}}$, $\\mu = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, and $\\Delta x = 5.0 \\times 10^{-2}\\,\\mathrm{m}$.\n$$a_P^{p'} = \\frac{(1.0 \\times 10^{-2}) \\cdot (5.0 \\times 10^{-2})}{1.0 \\times 10^{-3}} = \\frac{5.0 \\times 10^{-4}}{1.0 \\times 10^{-3}} = 0.5$$\nThe resulting value for the diagonal coefficient of the pressure-correction equation is $0.5\\,\\mathrm{m^3/(s \\cdot Pa)}$. Expressed to four significant figures as requested, the value is $0.5000$.", "answer": "$$\n\\boxed{0.5000}\n$$", "id": "2516621"}, {"introduction": "While staggered grids offer a robust way to couple pressure and velocity, a common alternative in many codes is to use a collocated grid, where all variables are stored at the same location. This choice, however, risks creating non-physical pressure oscillations unless a specialized method is used to calculate mass fluxes at cell faces. This practice introduces the essential Rhie-Chow interpolation technique, a powerful method for constructing face velocities that prevent this numerical instability and ensure a physically realistic pressure field [@problem_id:2516559].", "problem": "A one-dimensional, steady, incompressible flow of a Newtonian fluid through a straight duct is discretized using a collocated finite-volume grid to couple pressure and velocity in the spirit of the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) and Pressure Implicit with Splitting of Operators (PISO) algorithms. To prevent pressure–velocity decoupling on a collocated grid, the Rhie–Chow interpolation is used to construct the mass flux through cell faces consistently with the discretized momentum equations.\n\nConsider two adjacent control volumes with centers at locations $P$ and $E$, sharing the common face $e$. Let the cross-sectional area be $A$, the fluid density be constant and equal to $\\rho$, and the mesh be uniform. The $x$-momentum equation written in finite-volume form over a generic control volume yields a linear algebraic equation of the form\n$$\na_{i}\\,u_{i} \\;=\\; H_{i} \\;-\\; \\mathcal{P}_{i},\n$$\nwhere $i \\in \\{P,E\\}$, $u_{i}$ is the cell-center velocity in the $x$-direction, $a_{i}$ is the diagonal momentum coefficient (arising from convection, diffusion, and any linearized temporal terms), $H_{i}$ lumps all non-pressure contributions evaluated at the current iteration, and $\\mathcal{P}_{i}$ represents the discrete pressure-force contribution on the control volume surfaces. In the Rhie–Chow approach, the face-normal velocity $u_{e}$ used to form the face mass flux is constructed from the non-pressure part of the momentum balance and a pressure-difference term that is consistent with the momentum operator, eliminating spurious pressure oscillations.\n\nData for the two adjacent cells and the shared face are:\n- $a_{P} = 5.00\\ \\mathrm{kg/s}$, $H_{P} = 12.00\\ \\mathrm{N}$,\n- $a_{E} = 4.00\\ \\mathrm{kg/s}$, $H_{E} = 8.00\\ \\mathrm{N}$,\n- $p_{P} = 101325\\ \\mathrm{Pa}$, $p_{E} = 101305\\ \\mathrm{Pa}$,\n- $A = 0.0200\\ \\mathrm{m^{2}}$, $\\rho = 1.20\\ \\mathrm{kg/m^{3}}$.\n\nStarting from the integral $x$-momentum balance for a control volume and the definition that $H_{i}$ excludes pressure forces, derive the Rhie–Chow-consistent linear expression for the face-normal velocity $u_{e}$ at face $e$ in terms of $H_{P}$, $H_{E}$, $a_{P}$, $a_{E}$, $A$, $p_{P}$, and $p_{E}$, by:\n- first expressing the pressure-free velocities $u_{i}^{H} = H_{i}/a_{i}$ at $P$ and $E$,\n- then constructing $u_{e}$ by combining an interpolation of $u_{i}^{H}$ with a face pressure-difference contribution that uses an arithmetic average of the inverse diagonal momentum coefficients times $A$.\n\nUsing your derived expression, compute the mass flow rate through face $e$, namely $\\dot{m}_{e} = \\rho\\,A\\,u_{e}$. Express your final answer in $\\mathrm{kg/s}$ and round your result to four significant figures.", "solution": "The task is to derive the Rhie-Chow-consistent expression for the face-normal velocity $u_e$ and then compute the mass flow rate $\\dot{m}_e$.\n\nWe start from the discretized momentum equation for a generic control volume $i$:\n$$a_{i}\\,u_{i} \\;=\\; H_{i} \\;-\\; \\mathcal{P}_{i}$$\nwhere $u_i$ is the cell-center velocity, $a_i$ is the diagonal coefficient of the momentum equation matrix, $H_i$ comprises all source and neighbor-cell contributions except the explicit pressure gradient term, and $\\mathcal{P}_{i}$ is the pressure-force term for control volume $i$.\n\nTo avoid the pressure-velocity decoupling that occurs on collocated grids with naive interpolation, the Rhie-Chow method constructs the face velocity $u_e$ not by directly interpolating cell-center velocities, but by interpolating the components of the momentum equation itself.\n\nFollowing the problem's instructions, we first define the \"pressure-free\" velocity at the cell centers $i \\in \\{P,E\\}$ as $u_{i}^{H} = H_{i}/a_{i}$. This pseudo-velocity represents the velocity field that would exist in the absence of the explicit pressure gradient term. For the face $e$ between cells $P$ and $E$, the contribution from these non-pressure terms is found by linear interpolation (arithmetic mean for a uniform grid) of $u_{P}^{H}$ and $u_{E}^{H}$:\n$$\n\\overline{u^{H}}_{e} = \\frac{u_{P}^{H} + u_{E}^{H}}{2} = \\frac{1}{2}\\left(\\frac{H_{P}}{a_{P}} + \\frac{H_{E}}{a_{E}}\\right)\n$$\nNext, we add a pressure contribution. This term must be consistent with the momentum discretization and use the local pressure gradient at the face, which is best represented by the difference between the adjacent cell-center pressures, $p_E - p_P$. The problem specifies that this pressure difference is scaled by a factor constructed from the \"arithmetic average of the inverse diagonal momentum coefficients times $A$\". The inverse diagonal coefficients are $1/a_{P}$ and $1/a_{E}$. Their arithmetic average is:\n$$\n\\overline{\\left(\\frac{1}{a}\\right)}_{e} = \\frac{1}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right)\n$$\nThe pressure-driven velocity correction at the face is thus proportional to the pressure difference $(p_{E} - p_{P})$, with the constant of proportionality involving the area $A$ and the averaged inverse coefficient. A positive pressure gradient (i.e., $p_E > p_P$) must drive flow in the negative direction, hence the negative sign in the following expression:\n$$\nu_{e, p} = - A \\cdot \\overline{\\left(\\frac{1}{a}\\right)}_{e} \\cdot (p_{E} - p_{P}) = - \\frac{A}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right)(p_{E} - p_{P})\n$$\nCombining the two parts, the final Rhie-Chow expression for the face velocity $u_e$ is:\n$$\nu_{e} = \\overline{u^{H}}_{e} + u_{e, p} = \\frac{1}{2}\\left(\\frac{H_{P}}{a_{P}} + \\frac{H_{E}}{a_{E}}\\right) - \\frac{A}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right)(p_{E} - p_{P})\n$$\nWe now substitute the given numerical data:\n- $a_{P} = 5.00\\ \\mathrm{kg/s}$\n- $H_{P} = 12.00\\ \\mathrm{N}$\n- $a_{E} = 4.00\\ \\mathrm{kg/s}$\n- $H_{E} = 8.00\\ \\mathrm{N}$\n- $p_{P} = 101325\\ \\mathrm{Pa}$\n- $p_{E} = 101305\\ \\mathrm{Pa}$\n- $A = 0.0200\\ \\mathrm{m^{2}}$\n- $\\rho = 1.20\\ \\mathrm{kg/m^{3}}$\n\nFirst, we calculate the interpolated pressure-free velocity term:\n$$\n\\overline{u^{H}}_{e} = \\frac{1}{2}\\left(\\frac{12.00}{5.00} + \\frac{8.00}{4.00}\\right) = \\frac{1}{2}(2.40 + 2.00) = 2.20\\ \\mathrm{m/s}\n$$\nNext, we calculate the pressure correction term. The pressure difference is $p_{E} - p_{P} = 101305 - 101325 = -20.0\\ \\mathrm{Pa}$.\nThe pressure correction coefficient is:\n$$\n\\frac{A}{2}\\left(\\frac{1}{a_{P}} + \\frac{1}{a_{E}}\\right) = \\frac{0.0200}{2}\\left(\\frac{1}{5.00} + \\frac{1}{4.00}\\right) = 0.0100 \\cdot (0.200 + 0.250) = 0.0100 \\cdot 0.450 = 0.00450\\ \\frac{\\mathrm{m^2 \\cdot s}}{\\mathrm{kg}}\n$$\nThe velocity correction is:\n$$\nu_{e, p} = - \\left(0.00450\\ \\frac{\\mathrm{m^2 \\cdot s}}{\\mathrm{kg}}\\right) \\cdot (-20.0\\ \\mathrm{Pa}) = 0.0900\\ \\frac{\\mathrm{m^2 \\cdot s \\cdot N}}{\\mathrm{kg \\cdot m^2}} = 0.0900\\ \\frac{\\mathrm{kg \\cdot m \\cdot s}}{\\mathrm{s^2 \\cdot kg}} = 0.0900\\ \\mathrm{m/s}\n$$\nThus, the total face velocity is:\n$$\nu_{e} = 2.20\\ \\mathrm{m/s} + 0.0900\\ \\mathrm{m/s} = 2.290\\ \\mathrm{m/s}\n$$\nThe final step is to compute the mass flow rate through face $e$, $\\dot{m}_{e} = \\rho\\,A\\,u_{e}$:\n$$\n\\dot{m}_{e} = (1.20\\ \\mathrm{kg/m^3}) \\cdot (0.0200\\ \\mathrm{m^2}) \\cdot (2.290\\ \\mathrm{m/s}) = 0.05496\\ \\mathrm{kg/s}\n$$\nThe problem requires the result to be rounded to four significant figures. The computed value, $0.05496$, has exactly four significant figures ($5$, $4$, $9$, $6$). Therefore, no rounding is required.", "answer": "$$\\boxed{0.05496}$$", "id": "2516559"}, {"introduction": "A solver's equations are only useful when applied to a domain with well-defined physical boundaries. This exercise bridges the gap between the abstract algebraic equations and a practical problem by focusing on the implementation of boundary conditions for the pressure correction equation. You will derive and apply the appropriate conditions for two of the most common boundary types in incompressible flow—a specified-velocity inlet and a specified-pressure outlet—learning how they are incorporated into the algebraic system to ensure a physically meaningful solution [@problem_id:2516603].", "problem": "Consider steady, one-dimensional, incompressible flow in a straight channel of constant cross-section, discretized by the finite volume method into two equal control volumes along the streamwise direction. Pressure–velocity coupling is to be performed using either the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) or the Pressure-Implicit with Splitting of Operators (PISO). The inlet at $x=0$ prescribes the uniform normal velocity, and the outlet at $x=L$ prescribes the static pressure. Let $p$ denote the static pressure, $p^{*}$ the predicted pressure, and $p^{\\prime}$ the pressure correction, so that $p = p^{*} + p^{\\prime}$. Introduce the dimensionless pressure correction $\\hat{p}^{\\prime} = p^{\\prime}/p_{\\mathrm{ref}}$, where $p_{\\mathrm{ref}}$ is a constant reference pressure.\n\nYou are given the assembled, interior-face contributions to the algebraic pressure-correction operator (prior to applying boundary conditions) for the two interior cells, labeled $1$ and $2$. In canonical algebraic form, for a generic interior cell $P$ with west neighbor $W$ and east neighbor $E$,\n$$\n\\hat{a}_{P}\\,\\hat{p}^{\\prime}_{P} \\;=\\; \\hat{a}_{W}\\,\\hat{p}^{\\prime}_{W} \\;+\\; \\hat{a}_{E}\\,\\hat{p}^{\\prime}_{E} \\;+\\; \\hat{b}_{P},\n$$\nwhere $\\hat{a}_{W}$ and $\\hat{a}_{E}$ are the west and east neighbor coupling coefficients, $\\hat{a}_{P}$ is the diagonal coefficient, and $\\hat{b}_{P}$ is the source term that arises from the local mass-flux imbalance of the predicted velocity field. The non-dimensionalized geometric spacing is uniform with $\\Delta \\hat{x} = 1$.\n\nThe numerical values (already non-dimensionalized) are:\n- Inlet-face coupling coefficient: $\\hat{a}_{w} = 0.63$.\n- Interior-face coupling coefficient between cells $1$ and $2$: $\\hat{a}_{12} = 1.37$.\n- Outlet-face coupling coefficient: $\\hat{a}_{e} = 0.81$.\n- Sources from the predicted flux imbalance: $\\hat{b}_{1} = 0.071$ and $\\hat{b}_{2} = 0.023$.\n- Interior diagonal coefficients (before boundary conditions): $\\hat{a}_{P,1} = \\hat{a}_{w} + \\hat{a}_{12}$ and $\\hat{a}_{P,2} = \\hat{a}_{12} + \\hat{a}_{e}$.\n\nStarting only from the fundamental mass conservation law $\\nabla \\cdot \\mathbf{u} = 0$, the finite-volume statement of continuity, and the predictor–corrector form of the momentum equation that links velocity correction to pressure correction, do the following:\n\n1. Derive the physically consistent boundary conditions for the pressure $p$ and the pressure correction $p^{\\prime}$ at the inlet (velocity prescribed) and outlet (static pressure prescribed) for SIMPLE/PISO, explaining why those conditions preserve the imposed physical boundary data during the correction step.\n2. Convert these boundary conditions into algebraic conditions for $\\hat{p}^{\\prime}$ at the inlet and outlet faces, and eliminate any ghost values to obtain a closed $2\\times 2$ linear system for the unknown cell-centered corrections $\\hat{p}^{\\prime}_{1}$ and $\\hat{p}^{\\prime}_{2}$.\n3. Solve this linear system to obtain the value of $\\hat{p}^{\\prime}_{1}$.\n\nReport the final value of $\\hat{p}^{\\prime}_{1}$ as a pure number (dimensionless) rounded to five significant figures.", "solution": "The problem requires the determination of a dimensionless pressure correction, $\\hat{p}^{\\prime}_{1}$, in a discretized one-dimensional channel flow. This will be accomplished in three stages as stipulated: first, by deriving the appropriate boundary conditions for the pressure correction equation; second, by formulating the resulting algebraic system; and third, by solving this system.\n\nThe foundation of pressure-correction methods such as SIMPLE and PISO is the enforcement of mass conservation on a velocity field that has been updated from a predictor-corrector sequence. The corrected velocity field, $\\mathbf{u}$, is related to the predicted field, $\\mathbf{u}^*$, by $\\mathbf{u} = \\mathbf{u}^* + \\mathbf{u}'$. The predicted field $\\mathbf{u}^*$ is obtained from the momentum equation using a predicted pressure field $p^*$, but it does not in general satisfy the continuity equation, $\\nabla \\cdot \\mathbf{u} = 0$. The role of the pressure correction, $p'$, is to produce a velocity correction, $\\mathbf{u}'$, such that the final field $\\mathbf{u}$ is divergence-free.\n\nThe link between the velocity correction and the pressure correction is derived from the momentum equation. In its simplified form for a face $f$ normal to the $x$-direction, the velocity correction is proportional to the gradient of the pressure correction:\n$$\nu'_f \\approx -d_f \\left(\\frac{\\partial p'}{\\partial x}\\right)_f\n$$\nwhere $d_f$ is a term containing geometric factors and the diagonal coefficient of the discretized momentum matrix. The pressure correction equation itself is a discretized form of the continuity equation applied to the corrected velocity field: $\\nabla \\cdot (\\mathbf{u}^* + \\mathbf{u}') = 0$, which becomes $\\nabla \\cdot \\mathbf{u}' = -\\nabla \\cdot \\mathbf{u}^*$. The term on the right-hand side represents the local mass imbalance of the predicted field and serves as the source term for the pressure correction equation.\n\n**Part 1: Derivation of Boundary Conditions**\n\nWe must derive the boundary conditions for the pressure correction $p'$ at the inlet and outlet. These conditions must ensure that the final, corrected flow variables respect the physical boundary conditions imposed on the domain.\n\n*   **Inlet ($x=0$): Prescribed Velocity**\n    The velocity at the inlet, $u_{inlet}$, is a specified, constant value. The correction procedure must not alter this prescribed value. Therefore, the velocity correction at the inlet face must be identically zero: $u'_{inlet} = 0$. Given the relationship $u' \\propto -\\frac{\\partial p'}{\\partial x}$, a zero velocity correction implies a zero gradient for the pressure correction normal to the boundary.\n    $$\n    u'_{inlet} = 0 \\quad \\implies \\quad \\frac{\\partial p'}{\\partial x} \\bigg|_{x=0} = 0\n    $$\n    This is a homogeneous Neumann boundary condition for $p'$.\n\n*   **Outlet ($x=L$): Prescribed Static Pressure**\n    The static pressure at the outlet, $p_{outlet}$, is specified. The final, corrected pressure at this boundary, $p_{outlet}$, must equal this value. The corrected pressure is the sum of the predicted pressure and the pressure correction: $p = p^* + p'$. At the outlet, this means $p_{outlet} = p^*_{outlet} + p'_{outlet}$.\n    In standard practice, the predicted pressure field is extrapolated to the boundary. A common and simple choice is to set the predicted boundary pressure equal to the known final boundary pressure: $p^*_{outlet} = p_{outlet}$. Substituting this into the relation gives:\n    $$\n    p_{outlet} = p_{outlet} + p'_{outlet} \\quad \\implies \\quad p'_{outlet} = 0\n    $$\n    This is a homogeneous Dirichlet boundary condition for $p'$.\n\n**Part 2: Formulation of the Algebraic System**\n\nWe now apply these boundary conditions to the algebraic pressure-correction equations for the two control volumes (CVs), labeled $1$ and $2$. The problem provides the generic form of the equation for an interior cell $P$ with neighbors $W$ and $E$:\n$$\n\\hat{a}_{P}\\,\\hat{p}^{\\prime}_{P} = \\hat{a}_{W}\\,\\hat{p}^{\\prime}_{W} + \\hat{a}_{E}\\,\\hat{p}^{\\prime}_{E} + \\hat{b}_{P}\n$$\nwhere $\\hat{a}_{P} = \\hat{a}_{W} + \\hat{a}_{E}$ for an interior cell.\n\n*   **Equation for CV1:**\n    This cell is adjacent to the inlet. Its west neighbor is the inlet boundary face, and its east neighbor is cell $2$. The equation, before applying the boundary condition, is:\n    $$\n    \\hat{a}_{P,1}\\,\\hat{p}^{\\prime}_{1} = \\hat{a}_{w}\\,\\hat{p}^{\\prime}_{ghost} + \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} + \\hat{b}_{1}\n    $$\n    Here, $\\hat{p}^{\\prime}_{ghost}$ is the value in a hypothetical ghost cell west of the inlet, used to implement the Neumann condition. The condition $\\frac{\\partial \\hat{p}'}{\\partial x} = 0$ at the inlet face is discretized as $(\\hat{p}^{\\prime}_1 - \\hat{p}^{\\prime}_{ghost})/\\Delta \\hat{x} = 0$, which yields $\\hat{p}^{\\prime}_{ghost} = \\hat{p}^{\\prime}_{1}$. Substituting this into the equation for CV1:\n    $$\n    \\hat{a}_{P,1}\\,\\hat{p}^{\\prime}_{1} = \\hat{a}_{w}\\,\\hat{p}^{\\prime}_{1} + \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} + \\hat{b}_{1}\n    $$\n    Using the provided definition $\\hat{a}_{P,1} = \\hat{a}_{w} + \\hat{a}_{12}$:\n    $$\n    (\\hat{a}_{w} + \\hat{a}_{12})\\,\\hat{p}^{\\prime}_{1} = \\hat{a}_{w}\\,\\hat{p}^{\\prime}_{1} + \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} + \\hat{b}_{1}\n    $$\n    The $\\hat{a}_{w}\\,\\hat{p}^{\\prime}_{1}$ terms cancel, leaving the first equation of our system:\n    $$\n    \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} - \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} = \\hat{b}_{1}\n    $$\n\n*   **Equation for CV2:**\n    This cell is adjacent to the outlet. Its west neighbor is cell $1$, and its east neighbor is the outlet boundary face. The equation is:\n    $$\n    \\hat{a}_{P,2}\\,\\hat{p}^{\\prime}_{2} = \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} + \\hat{a}_{e}\\,\\hat{p}^{\\prime}_{outlet} + \\hat{b}_{2}\n    $$\n    The Dirichlet condition at the outlet is $\\hat{p}'_{outlet}=0$. Substituting this gives:\n    $$\n    \\hat{a}_{P,2}\\,\\hat{p}^{\\prime}_{2} = \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} + \\hat{b}_{2}\n    $$\n    Using the definition $\\hat{a}_{P,2} = \\hat{a}_{12} + \\hat{a}_{e}$ and rearranging, we get the second equation of our system:\n    $$\n    -\\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} + (\\hat{a}_{12} + \\hat{a}_{e})\\,\\hat{p}^{\\prime}_{2} = \\hat{b}_{2}\n    $$\n\nThe resulting $2 \\times 2$ linear system for $(\\hat{p}^{\\prime}_{1}, \\hat{p}^{\\prime}_{2})$ is:\n$$\n\\begin{pmatrix}\n\\hat{a}_{12} & -\\hat{a}_{12} \\\\\n-\\hat{a}_{12} & \\hat{a}_{12} + \\hat{a}_{e}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\hat{p}^{\\prime}_{1} \\\\\n\\hat{p}^{\\prime}_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\hat{b}_{1} \\\\\n\\hat{b}_{2}\n\\end{pmatrix}\n$$\n\n**Part 3: Solution of the Linear System**\n\nWe now solve this system for $\\hat{p}^{\\prime}_{1}$. A simple path to the solution is to add the two equations together:\n$$\n(\\hat{a}_{12} - \\hat{a}_{12})\\hat{p}^{\\prime}_{1} + (-\\hat{a}_{12} + \\hat{a}_{12} + \\hat{a}_{e})\\hat{p}^{\\prime}_{2} = \\hat{b}_{1} + \\hat{b}_{2}\n$$\nThis simplifies to:\n$$\n\\hat{a}_{e}\\hat{p}^{\\prime}_{2} = \\hat{b}_{1} + \\hat{b}_{2} \\quad \\implies \\quad \\hat{p}^{\\prime}_{2} = \\frac{\\hat{b}_{1} + \\hat{b}_{2}}{\\hat{a}_{e}}\n$$\nPhysically, this shows that the total mass imbalance from both cells, $\\hat{b}_{1} + \\hat{b}_{2}$, must be expelled through the outlet, driven by the pressure correction in the final cell, $\\hat{p}^{\\prime}_{2}$.\n\nNow, we substitute this expression for $\\hat{p}^{\\prime}_{2}$ back into the first equation, $\\hat{a}_{12}\\,\\hat{p}^{\\prime}_{1} - \\hat{a}_{12}\\,\\hat{p}^{\\prime}_{2} = \\hat{b}_{1}$, to solve for $\\hat{p}^{\\prime}_{1}$:\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{\\hat{b}_{1}}{\\hat{a}_{12}} + \\hat{p}^{\\prime}_{2}\n$$\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{\\hat{b}_{1}}{\\hat{a}_{12}} + \\frac{\\hat{b}_{1} + \\hat{b}_{2}}{\\hat{a}_{e}}\n$$\nThis is the symbolic solution for $\\hat{p}^{\\prime}_{1}$.\n\nFinally, we substitute the given numerical values:\n$\\hat{a}_{12} = 1.37$\n$\\hat{a}_{e} = 0.81$\n$\\hat{b}_{1} = 0.071$\n$\\hat{b}_{2} = 0.023$\n\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{0.071}{1.37} + \\frac{0.071 + 0.023}{0.81}\n$$\n$$\n\\hat{p}^{\\prime}_{1} = \\frac{0.071}{1.37} + \\frac{0.094}{0.81}\n$$\n$$\n\\hat{p}^{\\prime}_{1} \\approx 0.051824817... + 0.116049382...\n$$\n$$\n\\hat{p}^{\\prime}_{1} \\approx 0.1678742...\n$$\nRounding to five significant figures, the result is $0.16787$.", "answer": "$$\n\\boxed{0.16787}\n$$", "id": "2516603"}]}