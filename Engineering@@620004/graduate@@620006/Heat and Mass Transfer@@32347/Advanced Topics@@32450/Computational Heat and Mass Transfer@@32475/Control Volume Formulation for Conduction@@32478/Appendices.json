{"hands_on_practices": [{"introduction": "In the control volume formulation, the conservation of energy is ensured by balancing the heat fluxes across the faces of each volume. A critical step in this process is accurately calculating the conductive heat flux, especially at interfaces where material properties change abruptly. This exercise guides you through the first-principles derivation of the effective thermal conductivity at such an interface, revealing why a specific form of averaging is required to correctly represent the underlying physics of series thermal resistance. Mastering this concept [@problem_id:2472545] is fundamental to building robust and accurate conduction models for composite materials or on non-uniform grids.", "problem": "A one-dimensional ($1$D) steady conduction problem is discretized by the Finite Volume Method (FVM). Two adjacent control volumes share a common planar face of area $A$ that coincides with a perfect-contact interface between two homogeneous, isotropic solids. The west cell has constant thermal conductivity $k_1$ and its centroid lies a distance $\\delta_1$ from the face; the east cell has constant thermal conductivity $k_2$ and its centroid lies a distance $\\delta_2$ from the same face. There is no volumetric heat generation and the cross-sectional area $A$ is uniform. Let the centroid temperatures be $T_W$ (west) and $T_E$ (east). An effective face conductivity $k_f$ is to be defined so that the intercell diffusive heat flux between the two centroids is identical to that of a single homogeneous slab of thickness $(\\delta_1+\\delta_2)$ and conductivity $k_f$, while exactly respecting Fourier’s law in each material and continuity of heat flux at the interface.\n\nWhich of the following expressions for $k_f$ is consistent with these first-principles requirements for arbitrary positive $k_1$, $k_2$, $\\delta_1$, and $\\delta_2$?\n\nA. $k_f=\\dfrac{\\delta_1+\\delta_2}{\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}}$\n\nB. $k_f=\\dfrac{\\delta_1 k_1+\\delta_2 k_2}{\\delta_1+\\delta_2}$\n\nC. $k_f=\\sqrt{k_1 k_2}$\n\nD. $k_f=\\left(\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}\\right)^{-1}$", "solution": "The problem statement will first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\nThe following information is provided in the problem statement:\n- The system involves a one-dimensional ($1$D) steady conduction problem.\n- It is discretized using the Finite Volume Method (FVM).\n- Two adjacent control volumes share a common planar face of area $A$.\n- The face is a perfect-contact interface between two homogeneous, isotropic solids.\n- West cell (indexed $1$): constant thermal conductivity $k_1$, centroid distance from face is $\\delta_1$.\n- East cell (indexed $2$): constant thermal conductivity $k_2$, centroid distance from face is $\\delta_2$.\n- There is no volumetric heat generation.\n- The cross-sectional area $A$ is uniform.\n- The centroid temperatures are $T_W$ for the west cell and $T_E$ for the east cell.\n- An effective face conductivity, $k_f$, is to be defined for a single homogeneous slab of thickness $(\\delta_1 + \\delta_2)$.\n- The definition must ensure the intercell heat flux is identical to that calculated using $k_f$.\n- The derivation must respect Fourier’s law in each material and the continuity of heat flux at the interface.\n- The expression for $k_f$ must be valid for arbitrary positive $k_1$, $k_2$, $\\delta_1$, and $\\delta_2$.\n\n### Step 2: Validate Using Extracted Givens\nThis problem is a standard, fundamental exercise in the derivation of interface properties for the Finite Volume Method when dealing with composite materials.\n\n- **Scientifically Grounded:** The problem is based on Fourier's law of heat conduction and the principle of energy conservation (continuity of heat flux), which are cornerstones of heat transfer theory. The setup is a standard model for analyzing heat flow through a composite slab. It is scientifically sound.\n- **Well-Posed:** The problem provides all necessary physical parameters ($k_1$, $k_2$, $\\delta_1$, $\\delta_2$) and constraints (steady-state, $1$D, no generation, continuity conditions) to derive a unique expression for the effective conductivity $k_f$. The question is unambiguous.\n- **Objective:** The language is technical, precise, and free of any subjective or non-scientific content.\n\nThe problem statement has no identifiable flaws. It is not scientifically unsound, non-formalizable, incomplete, contradictory, unrealistic, or ill-posed. It represents a valid and well-defined problem in computational heat transfer.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived based on the provided first principles.\n\n### Derivation of the Solution\nThe objective is to find an expression for an effective thermal conductivity $k_f$ such that the heat flow through an equivalent homogeneous medium matches the heat flow through the actual composite medium.\n\nLet $\\dot{Q}$ be the rate of heat transfer from the west centroid ($W$) to the east centroid ($E$). The system can be modeled as two thermal resistors in series. The first resistance, $R_1$, is for the material between the west centroid and the interface, and the second, $R_2$, is for the material between the interface and the east centroid.\n\nAccording to Fourier's law for one-dimensional conduction, the thermal resistance $R$ of a slab of thickness $L$, conductivity $k$, and area $A$ is given by $R = \\frac{L}{kA}$.\n\nFor the west part of the control volume arrangement:\n- Thickness = $\\delta_1$\n- Conductivity = $k_1$\n- Area = $A$\nThe thermal resistance is:\n$$R_1 = \\frac{\\delta_1}{k_1 A}$$\n\nFor the east part:\n- Thickness = $\\delta_2$\n- Conductivity = $k_2$\n- Area = $A$\nThe thermal resistance is:\n$$R_2 = \\frac{\\delta_2}{k_2 A}$$\n\nSince the heat must flow through the west part and then the east part, these resistances are in series. The total thermal resistance, $R_{total}$, between the centroids at $T_W$ and $T_E$ is the sum of the individual resistances:\n$$R_{total} = R_1 + R_2 = \\frac{\\delta_1}{k_1 A} + \\frac{\\delta_2}{k_2 A} = \\frac{1}{A} \\left( \\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2} \\right)$$\n\nThe rate of heat transfer, $\\dot{Q}$, across this total resistance due to the temperature difference $(T_W - T_E)$ is:\n$$\\dot{Q} = \\frac{T_W - T_E}{R_{total}} = \\frac{T_W - T_E}{\\frac{1}{A} \\left( \\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2} \\right)} = A \\frac{T_W - T_E}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}}$$\n\nThe problem requires that this heat rate be identical to that through a single homogeneous slab of thickness $(\\delta_1 + \\delta_2)$, area $A$, and an effective conductivity $k_f$. The heat rate for this equivalent slab, $\\dot{Q}_{eff}$, is given by Fourier's law:\n$$\\dot{Q}_{eff} = k_f A \\frac{T_W - T_E}{\\delta_1 + \\delta_2}$$\n\nEquating the two expressions for the heat rate, $\\dot{Q} = \\dot{Q}_{eff}$:\n$$A \\frac{T_W - T_E}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}} = k_f A \\frac{T_W - T_E}{\\delta_1 + \\delta_2}$$\n\nAssuming a non-trivial temperature gradient, $(T_W - T_E) \\neq 0$, and since $A > 0$, we can cancel the term $A(T_W - T_E)$ from both sides:\n$$\\frac{1}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}} = \\frac{k_f}{\\delta_1 + \\delta_2}$$\n\nSolving for the effective conductivity $k_f$:\n$$k_f = \\frac{\\delta_1 + \\delta_2}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}}$$\nThis is the weighted harmonic mean of the thermal conductivities.\n\n### Option-by-Option Analysis\n\n**A. $k_f=\\dfrac{\\delta_1+\\delta_2}{\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}}$**\nThis expression is identical to the one derived from first principles. It correctly represents the effective conductivity for one-dimensional heat conduction through two materials in series.\nVerdict: **Correct**\n\n**B. $k_f=\\dfrac{\\delta_1 k_1+\\delta_2 k_2}{\\delta_1+\\delta_2}$**\nThis expression represents the weighted arithmetic mean. This formula is applicable for heat flow parallel to the layers of a composite material, where the thermal paths are in parallel, not in series. The problem describes heat flow perpendicular to the interface, which is a series conduction problem.\nVerdict: **Incorrect**\n\n**C. $k_f=\\sqrt{k_1 k_2}$**\nThis is the geometric mean of the conductivities. This expression does not arise from the fundamental principles of series conduction in one dimension. While it might appear as an approximation in some specific multi-dimensional scenarios, it is not the exact solution for the well-defined $1$D problem stated.\nVerdict: **Incorrect**\n\n**D. $k_f=\\left(\\dfrac{\\delta_1}{k_1}+\\dfrac{\\delta_2}{k_2}\\right)^{-1}$**\nThis expression can be written as $k_f = \\frac{1}{\\frac{\\delta_1}{k_1} + \\frac{\\delta_2}{k_2}}$. Let us examine its physical dimensions. The units of thermal conductivity $k$ are $\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1}$. The units of distance $\\delta$ are $\\mathrm{m}$. The term $\\frac{\\delta}{k}$ has units of $\\frac{\\mathrm{m}}{\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1}} = \\mathrm{m}^2 \\cdot \\mathrm{K} \\cdot \\mathrm{W}^{-1}$. The inverse of this term, as given in the option, would have units of $\\mathrm{m}^{-2} \\cdot \\mathrm{K}^{-1} \\cdot \\mathrm{W}$, which are not the units of thermal conductivity. The expression is dimensionally inconsistent and therefore physically incorrect. It is also mathematically different from the derived result, as it is missing the $(\\delta_1 + \\delta_2)$ term in the numerator.\nVerdict: **Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2472545"}, {"introduction": "With a solid understanding of how to model fluxes at interfaces, we can now construct the complete energy balance equation for any control volume in a domain. This practice involves applying the integral form of the energy conservation law to a generic one-dimensional grid with non-uniform spacing, a common scenario in practical engineering problems. You will derive the semi-discrete equations for transient conduction, learning how to systematically handle interior cells, Dirichlet (prescribed temperature), and Neumann (prescribed flux) boundary conditions to form a complete system of equations [@problem_id:2472571]. This is the core skill in translating physical principles into a solvable computational model.", "problem": "You are asked to derive and implement a one-dimensional control volume formulation for transient heat conduction on a nonuniform grid. Begin from first principles: enforce conservation of energy over a generic control volume and use the law of heat conduction (Fourier’s law) to express the conductive heat rates at the control volume faces. Assume a piecewise linear temperature distribution between adjacent cell centers and enforce continuity of heat flux at interior faces. Your derivation must explicitly show how the semi-discrete Ordinary Differential Equation (ODE) for the temperature at a generic cell center emerges, including how the face conductances depend on the adjacent cell sizes and thermal conductivities.\n\nDefinitions and conventions:\n- The spatial domain is one-dimensional with cell-centered control volumes of nonuniform size. For a generic interior cell, denote the west neighbor by $W$, the center by $P$, and the east neighbor by $E$. Let the control volume of $P$ have length $ \\Delta x_P $ and cross-sectional area $ A $. The neighboring control volumes have lengths $ \\Delta x_W $ and $ \\Delta x_E $.\n- Material properties are treated as cell-centered constants: density $ \\rho $, specific heat capacity $ c_p $, and thermal conductivity $ k $. Denote them by $ \\rho_P, c_{p,P}, k_P $ for the center, and $ k_W, k_E $ for the neighbors. The volumetric heat generation in $P$ is $ \\dot{s}_P $ with units watts per cubic meter.\n- Let the conductive heat rate at a face be defined positive when it is directed into the control volume. Denote the west-face and east-face conductive heat rates into cell $P$ by $ q_w $ and $ q_e $, respectively.\n- For interior faces, assume a piecewise linear temperature profile between adjacent cell centers and impose flux continuity across the face, yielding a two-point flux relation between neighboring cell-center temperatures. This should determine conductances that depend on $ A $, the distances from the centers to the face, and the adjacent conductivities.\n- For a left boundary with a prescribed temperature (Dirichlet condition) $ T_L $ at the wall located at the west face of cell $P$, use the same definitions and one-sided face gradient consistent with the assumed piecewise linearity in $P$. Treat the boundary so that its effect can be incorporated as a linear contribution to the semi-discrete balance for $T_P$.\n- For a right boundary with a prescribed outward heat flux (Neumann condition) $ q''_R $ at the east face of cell $P$, interpret a positive $ q''_R $ as heat leaving the domain. Convert this to the corresponding heat rate into the control volume using the sign convention defined above.\n\nYour derived semi-discrete balance for a generic cell $P$ must be cast in the canonical linear form\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; C_W \\, T_W \\;+\\; C_P \\, T_P \\;+\\; C_E \\, T_E \\;+\\; B,\n$$\nwhere $ M_P $ is the heat capacity of the control volume $P$ (with units joules per kelvin), $ C_W, C_P, C_E $ are the linear coefficients multiplying the neighboring and self temperatures, and $ B $ is the net source term collecting contributions from volumetric heat generation and any boundary conditions. All quantities must be expressed in International System of Units (SI units).\n\nProgramming task:\n- Implement a program that evaluates $ [C_W, C_P, C_E, B, M_P] $ for each of the following test cases, using the control volume formulation you have derived. Use the sign conventions and modeling assumptions stated above. Your implementation must use SI units throughout and must output floating-point numbers rounded to six decimal places.\n\nTest suite (all quantities given in SI units):\n1. Interior cell (three-cell stencil):\n   - Cross-sectional area $ A = 0.008 $ square meters\n   - Cell lengths $ \\Delta x_W = 0.012 $ meters, $ \\Delta x_P = 0.015 $ meters, $ \\Delta x_E = 0.020 $ meters\n   - Conductivities $ k_W = 150 $ watts per meter-kelvin, $ k_P = 180 $ watts per meter-kelvin, $ k_E = 210 $ watts per meter-kelvin\n   - Density and specific heat for $P$: $ \\rho_P = 7800 $ kilograms per cubic meter, $ c_{p,P} = 500 $ joules per kilogram-kelvin\n   - Volumetric heat generation $ \\dot{s}_P = 2.0 \\times 10^5 $ watts per cubic meter\n\n2. Left boundary cell with a prescribed temperature (Dirichlet at the west face):\n   - Cross-sectional area $ A = 0.005 $ square meters\n   - Cell lengths $ \\Delta x_P = 0.010 $ meters, $ \\Delta x_E = 0.020 $ meters\n   - Conductivities $ k_P = 200 $ watts per meter-kelvin, $ k_E = 180 $ watts per meter-kelvin\n   - Density and specific heat for $P$: $ \\rho_P = 8900 $ kilograms per cubic meter, $ c_{p,P} = 385 $ joules per kilogram-kelvin\n   - Volumetric heat generation $ \\dot{s}_P = 0 $\n   - Boundary temperature at the west face $ T_L = 400 $ kelvin\n\n3. Right boundary cell with a prescribed outward heat flux (Neumann at the east face):\n   - Cross-sectional area $ A = 0.010 $ square meters\n   - Cell lengths $ \\Delta x_W = 0.020 $ meters, $ \\Delta x_P = 0.010 $ meters\n   - Conductivities $ k_W = 30 $ watts per meter-kelvin, $ k_P = 15 $ watts per meter-kelvin\n   - Density and specific heat for $P$: $ \\rho_P = 1200 $ kilograms per cubic meter, $ c_{p,P} = 1800 $ joules per kilogram-kelvin\n   - Volumetric heat generation $ \\dot{s}_P = 5.0 \\times 10^4 $ watts per cubic meter\n   - Prescribed outward heat flux at the east face $ q''_R = 1.0 \\times 10^4 $ watts per square meter\n\nFinal output format:\n- Your program should produce a single line of output containing a list of lists, one per test case, in the order given above. Each inner list must be $ [C_W, C_P, C_E, B, M_P] $, with each entry rounded to six decimal places. The output must be exactly one line and must look like\n\"[ [case1_values], [case2_values], [case3_values] ]\"\nwith no additional text. For example: \"[[1.234000,-5.678000,0.000000,9.000000,2.500000],[...],[...]]\".", "solution": "We derive the one-dimensional control volume formulation for transient conduction on a nonuniform grid using conservation of energy and Fourier’s law of heat conduction.\n\nStart from conservation of energy for a control volume around cell center $P$:\n$$\n\\frac{d}{dt} \\int_{\\text{CV}_P} \\rho \\, c_p \\, T \\, dV \\;=\\; q_w \\;+\\; q_e \\;+\\; \\dot{s}_P \\, V_P,\n$$\nwhere $ q_w $ and $ q_e $ are the conductive heat rates into the control volume through the west and east faces, respectively, $ \\dot{s}_P $ is the volumetric heat generation evaluated at $P$, and $ V_P $ is the control volume. The sign convention here is that heat rates are positive when directed into the control volume. The left-hand side is the time rate of change of thermal energy. Assuming piecewise constant $ \\rho $ and $ c_p $ over $ \\text{CV}_P $, define the heat capacity (thermal mass) of the control volume:\n$$\nM_P \\;\\equiv\\; \\rho_P \\, c_{p,P} \\, V_P \\;=\\; \\rho_P \\, c_{p,P} \\, A \\, \\Delta x_P,\n$$\nso that\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; q_w \\;+\\; q_e \\;+\\; \\dot{s}_P \\, V_P.\n$$\n\nTo close the problem, use Fourier’s law of heat conduction in one dimension:\n$$\nq = - k \\, A \\, \\frac{d T}{d x}.\n$$\nWe approximate the face fluxes using a two-point flux approximation consistent with a piecewise linear temperature between adjacent cell centers and with continuity of heat flux at interior faces.\n\nFor the west interior face (between cells $W$ and $P$), let the distance from the west face to the centers be $ \\delta x_{Ww} = \\Delta x_W / 2 $ and $ \\delta x_{Pw} = \\Delta x_P / 2 $, respectively. Under the assumption of linear temperature in each half-cell and flux continuity, the conductive heat rate into $P$ through the west face can be written\n$$\nq_w \\;=\\; A \\, \\frac{T_W - T_P}{\\dfrac{\\delta x_{Pw}}{k_P} + \\dfrac{\\delta x_{Ww}}{k_W}}\n\\;=\\;\nA \\, \\frac{T_W - T_P}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_W}{2 k_W}}.\n$$\nDefine the west-face conductance\n$$\na_W \\;\\equiv\\; \\frac{A}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_W}{2 k_W}},\n$$\nso that $ q_w = a_W \\, (T_W - T_P) $.\n\nSimilarly, for the east interior face (between $P$ and $E$), with $ \\delta x_{Pe} = \\Delta x_P / 2 $ and $ \\delta x_{Ee} = \\Delta x_E / 2 $, flux continuity and piecewise linear temperature imply\n$$\nq_e \\;=\\; A \\, \\frac{T_E - T_P}{\\dfrac{\\delta x_{Pe}}{k_P} + \\dfrac{\\delta x_{Ee}}{k_E}}\n\\;=\\;\nA \\, \\frac{T_E - T_P}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_E}{2 k_E}}\n\\;\\equiv\\; a_E \\, (T_E - T_P),\n$$\nwith\n$$\na_E \\;\\equiv\\; \\frac{A}{\\dfrac{\\Delta x_P}{2 k_P} + \\dfrac{\\Delta x_E}{2 k_E}}.\n$$\n\nSubstituting these into the conservation statement yields, for an interior cell,\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; a_W \\, (T_W - T_P) \\;+\\; a_E \\, (T_E - T_P) \\;+\\; \\dot{s}_P \\, V_P.\n$$\nRearranging into a canonical linear form,\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; C_W \\, T_W \\;+\\; C_P \\, T_P \\;+\\; C_E \\, T_E \\;+\\; B,\n$$\nwe identify\n$$\nC_W \\;=\\; a_W,\\qquad\nC_E \\;=\\; a_E,\\qquad\nC_P \\;=\\; -\\,(a_W + a_E),\\qquad\nB \\;=\\; \\dot{s}_P \\, V_P.\n$$\n\nLeft Dirichlet boundary (prescribed temperature at the west face):\nLet the boundary temperature be $ T_L $ at the west boundary face of cell $P$. The one-sided linear approximation for the face gradient across the half-cell gives the heat rate into the control volume\n$$\nq_w \\;=\\; A \\, \\frac{T_L - T_P}{\\dfrac{\\Delta x_P}{2 k_P}} \\;=\\; a_b \\, (T_L - T_P),\n$$\nwith the boundary conductance\n$$\na_b \\;\\equiv\\; \\frac{A \\, k_P}{\\Delta x_P/2}.\n$$\nThere is no west neighbor, so the semi-discrete balance becomes\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; a_b \\, (T_L - T_P) \\;+\\; a_E \\, (T_E - T_P) \\;+\\; \\dot{s}_P \\, V_P,\n$$\nwhich is put in canonical form by setting\n$$\nC_W \\;=\\; 0,\\qquad\nC_E \\;=\\; a_E,\\qquad\nC_P \\;=\\; -\\,(a_b + a_E),\\qquad\nB \\;=\\; \\dot{s}_P \\, V_P \\;+\\; a_b \\, T_L.\n$$\n\nRight Neumann boundary (prescribed outward heat flux at the east face):\nLet $ q''_R $ denote the prescribed outward heat flux at the east face of cell $P$, positive when leaving the domain. The corresponding heat rate into $P$ through the east face is $ q_e = - \\, q''_R \\, A $ by the sign convention (into the cell positive). The west interior face contributes $ q_w = a_W \\, (T_W - T_P) $. The semi-discrete balance is\n$$\nM_P \\, \\frac{d T_P}{d t} \\;=\\; a_W \\, (T_W - T_P) \\;-\\; q''_R \\, A \\;+\\; \\dot{s}_P \\, V_P,\n$$\nso that\n$$\nC_W \\;=\\; a_W,\\qquad\nC_E \\;=\\; 0,\\qquad\nC_P \\;=\\; -\\,a_W,\\qquad\nB \\;=\\; \\dot{s}_P \\, V_P \\;-\\; q''_R \\, A.\n$$\n\nAlgorithm to compute coefficients:\n- Compute $ V_P = A \\, \\Delta x_P $ and $ M_P = \\rho_P \\, c_{p,P} \\, V_P $.\n- For any interior face between cells with conductivities $ k_i $ over distances $ \\delta x_i $ to the face, use the flux continuity/two-point flux approximation to compute the conductance as\n$$\n\\frac{A}{\\sum_i \\delta x_i / k_i}.\n$$\nFor the west interior face $ (W,P) $ use $ \\delta x_{Ww} = \\Delta x_W/2 $ and $ \\delta x_{Pw} = \\Delta x_P/2 $. For the east interior face $ (P,E) $ use $ \\delta x_{Pe} = \\Delta x_P/2 $ and $ \\delta x_{Ee} = \\Delta x_E/2 $.\n- For the left Dirichlet boundary, compute $ a_b = A \\, k_P / (\\Delta x_P/2) $. For the right Neumann boundary, compute the boundary heat rate into the cell as $ -\\, q''_R \\, A $.\n- Assemble $ C_W, C_P, C_E, B $ according to the cases above.\n- Use SI units consistently.\n\nNumerical evaluation for the test suite:\n\n1. Interior cell:\n- $ A = 0.008 $, $ \\Delta x_W = 0.012 $, $ \\Delta x_P = 0.015 $, $ \\Delta x_E = 0.020 $, $ k_W = 150 $, $ k_P = 180 $, $ k_E = 210 $, $ \\rho_P = 7800 $, $ c_{p,P} = 500 $, $ \\dot{s}_P = 2.0 \\times 10^5 $.\n- $ V_P = 0.008 \\times 0.015 = 0.00012 $ cubic meters, $ M_P = 7800 \\times 500 \\times 0.00012 = 468.0 $ joules per kelvin.\n- $ a_W = \\dfrac{0.008}{\\dfrac{0.015}{2 \\times 180} + \\dfrac{0.012}{2 \\times 150}} \\approx 97.959183673 $ watts per kelvin.\n- $ a_E = \\dfrac{0.008}{\\dfrac{0.015}{2 \\times 180} + \\dfrac{0.020}{2 \\times 210}} = 89.6 $ watts per kelvin.\n- $ C_W = 97.959183673 $, $ C_E = 89.6 $, $ C_P = - (97.959183673 + 89.6) = -187.559183673 $.\n- $ B = \\dot{s}_P \\, V_P = 200000 \\times 0.00012 = 24.0 $.\n\n2. Left Dirichlet boundary:\n- $ A = 0.005 $, $ \\Delta x_P = 0.010 $, $ \\Delta x_E = 0.020 $, $ k_P = 200 $, $ k_E = 180 $, $ \\rho_P = 8900 $, $ c_{p,P} = 385 $, $ \\dot{s}_P = 0 $, $ T_L = 400 $.\n- $ V_P = 0.005 \\times 0.010 = 0.00005 $, $ M_P = 8900 \\times 385 \\times 0.00005 = 171.325 $.\n- $ a_E = \\dfrac{0.005}{\\dfrac{0.010}{2 \\times 200} + \\dfrac{0.020}{2 \\times 180}} \\approx 62.068965517 $.\n- $ a_b = \\dfrac{0.005 \\times 200}{0.010/2} = 200.0 $.\n- $ C_W = 0 $, $ C_E = 62.068965517 $, $ C_P = - (200.0 + 62.068965517) = -262.068965517 $.\n- $ B = 0 + 200.0 \\times 400 = 80000.0 $.\n\n3. Right Neumann boundary:\n- $ A = 0.010 $, $ \\Delta x_W = 0.020 $, $ \\Delta x_P = 0.010 $, $ k_W = 30 $, $ k_P = 15 $, $ \\rho_P = 1200 $, $ c_{p,P} = 1800 $, $ \\dot{s}_P = 5.0 \\times 10^4 $, $ q''_R = 1.0 \\times 10^4 $.\n- $ V_P = 0.010 \\times 0.010 = 0.0001 $, $ M_P = 1200 \\times 1800 \\times 0.0001 = 216.0 $.\n- $ a_W = \\dfrac{0.010}{\\dfrac{0.010}{2 \\times 15} + \\dfrac{0.020}{2 \\times 30}} = \\dfrac{0.010}{\\dfrac{0.010}{30} + \\dfrac{0.020}{60}} = 15.0 $.\n- $ C_W = 15.0 $, $ C_E = 0.0 $, $ C_P = -15.0 $.\n- $ B = \\dot{s}_P \\, V_P - q''_R \\, A = 50000 \\times 0.0001 - 10000 \\times 0.010 = 5.0 - 100.0 = -95.0 $.\n\nTherefore, the required outputs $ [C_W, C_P, C_E, B, M_P] $ for the three cases, rounded to six decimal places, are:\n- Case $1$: $ [97.959184, -187.559184, 89.600000, 24.000000, 468.000000] $.\n- Case $2$: $ [0.000000, -262.068966, 62.068966, 80000.000000, 171.325000] $.\n- Case $3$: $ [15.000000, -15.000000, 0.000000, -95.000000, 216.000000] $.\n\nThe program below computes these values from the given inputs following the derivation and prints them in the exact required single-line format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_interior_coeffs(A, dxW, dxP, dxE, kW, kP, kE, rhoP, cpP, sdot):\n    # Volume and capacity\n    V = A * dxP\n    MP = rhoP * cpP * V\n    # Conductances via two-point flux approximation (harmonic resistance sum)\n    denom_W = dxP / (2.0 * kP) + dxW / (2.0 * kW)\n    denom_E = dxP / (2.0 * kP) + dxE / (2.0 * kE)\n    aW = A / denom_W\n    aE = A / denom_E\n    # Canonical coefficients\n    CW = aW\n    CE = aE\n    CP = -(aW + aE)\n    B = sdot * V\n    return CW, CP, CE, B, MP\n\ndef compute_left_dirichlet_coeffs(A, dxP, dxE, kP, kE, rhoP, cpP, sdot, TL):\n    V = A * dxP\n    MP = rhoP * cpP * V\n    # East interior face conductance\n    denom_E = dxP / (2.0 * kP) + dxE / (2.0 * kE)\n    aE = A / denom_E\n    # Boundary conductance at west face\n    ab = A * kP / (dxP / 2.0)\n    CW = 0.0\n    CE = aE\n    CP = -(ab + aE)\n    B = sdot * V + ab * TL\n    return CW, CP, CE, B, MP\n\ndef compute_right_neumann_coeffs(A, dxW, dxP, kW, kP, rhoP, cpP, sdot, qR_out):\n    V = A * dxP\n    MP = rhoP * cpP * V\n    # West interior face conductance\n    denom_W = dxP / (2.0 * kP) + dxW / (2.0 * kW)\n    aW = A / denom_W\n    # Boundary heat rate into the control volume is -qR_out * A\n    CW = aW\n    CE = 0.0\n    CP = -aW\n    B = sdot * V - qR_out * A\n    return CW, CP, CE, B, MP\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case returns [C_W, C_P, C_E, B, M_P]\n    results = []\n\n    # Case 1: Interior cell\n    case1 = compute_interior_coeffs(\n        A=0.008, dxW=0.012, dxP=0.015, dxE=0.020,\n        kW=150.0, kP=180.0, kE=210.0,\n        rhoP=7800.0, cpP=500.0, sdot=2.0e5\n    )\n    results.append(case1)\n\n    # Case 2: Left boundary with Dirichlet temperature\n    case2 = compute_left_dirichlet_coeffs(\n        A=0.005, dxP=0.010, dxE=0.020,\n        kP=200.0, kE=180.0,\n        rhoP=8900.0, cpP=385.0, sdot=0.0, TL=400.0\n    )\n    results.append(case2)\n\n    # Case 3: Right boundary with Neumann flux (outward positive)\n    case3 = compute_right_neumann_coeffs(\n        A=0.010, dxW=0.020, dxP=0.010,\n        kW=30.0, kP=15.0,\n        rhoP=1200.0, cpP=1800.0, sdot=5.0e4, qR_out=1.0e4\n    )\n    results.append(case3)\n\n    # Round to six decimals and format the output\n    def fmt(x):\n        return f\"{x:.6f}\"\n\n    rounded = [[fmt(val) for val in res] for res in results]\n    # Final print statement in the exact required format.\n    # Convert inner lists to numeric-looking strings (no quotes)\n    out = \"[\" + \",\".join([\"[\" + \",\".join(vals) + \"]\" for vals in rounded]) + \"]\"\n    print(out)\n\nsolve()\n```", "id": "2472571"}, {"introduction": "After discretizing in space to obtain a system of ordinary differential equations, a time integration scheme is needed for transient problems. While the explicit forward Euler method is straightforward to implement, its use is governed by a strict stability constraint on the time step, $\\Delta t$. This final practice explores the stability of the numerical scheme using von Neumann analysis, a powerful tool for analyzing linear difference equations. By performing this analysis [@problem_id:2472555], you will derive the critical stability limit and see how it relates directly to a key dimensionless parameter in heat transfer, the Fourier number, $\\mathrm{Fo} = \\alpha \\Delta t / \\Delta x^2$.", "problem": "A homogeneous, isotropic solid rod with constant thermal conductivity $k$, mass density $\\rho$, and specific heat capacity $c_p$ is modeled in one spatial dimension using a control volume discretization on a uniform mesh of spacing $\\Delta x$ and constant cross-sectional area $A$. There are no internal volumetric heat sources. Consider an explicit time integration in which all diffusive fluxes are evaluated at the previous time level, and assume either an infinite domain or periodic boundary conditions so that a spatial Fourier-mode analysis is admissible.\n\nStarting from the integral energy balance for a single control volume and Fourier’s law of heat conduction, derive the fully discrete explicit update equation for the nodal temperature $T_i^{n}$ at control volume center $i$ and time level $n$. Then perform a linear von Neumann stability analysis to determine, in terms of the dimensionless Fourier number $\\mathrm{Fo}$ defined by\n$$\n\\mathrm{Fo} \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}, \\quad \\alpha \\equiv \\frac{k}{\\rho c_p},\n$$\nthe largest value of $\\mathrm{Fo}$ such that the explicit scheme is stable for all spatial Fourier modes.\n\nReport as your final answer the single maximum permissible value of the Fourier number as a pure number. No rounding is required, and no units should be included in your final numerical value because the Fourier number is dimensionless.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\nStep 1: Extract Givens.\n- A homogeneous, isotropic solid rod.\n- Constant thermal conductivity $k$.\n- Constant mass density $\\rho$.\n- Constant specific heat capacity $c_p$.\n- One spatial dimension ($1D$).\n- Control volume discretization on a uniform mesh with spacing $\\Delta x$.\n- Constant cross-sectional area $A$.\n- No internal volumetric heat sources ($ \\dot{q}'''=0 $).\n- Explicit time integration scheme.\n- Infinite domain or periodic boundary conditions, allowing for Fourier-mode analysis.\n- The task is to derive the fully discrete explicit update equation for the nodal temperature $T_i^n$.\n- The subsequent task is to perform a von Neumann stability analysis to find the stability criterion.\n- The Fourier number is defined as $\\mathrm{Fo} \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}$.\n- The thermal diffusivity is defined as $\\alpha \\equiv \\frac{k}{\\rho c_p}$.\n- The final output must be the largest permissible value of $\\mathrm{Fo}$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is a classic, well-posed problem in the field of computational heat transfer. It asks for the derivation of the finite-volume discretization of the $1D$ heat conduction equation using an explicit time-marching scheme, followed by a standard von Neumann stability analysis to determine the stability limit.\n\n- **Scientific Grounding**: The problem is based on fundamental principles of heat transfer (Fourier's law) and numerical methods (finite volume method, von Neumann stability analysis). It is scientifically sound.\n- **Well-Posedness**: The problem provides sufficient information to derive a unique and meaningful result for the stability criterion. The use of an infinite domain or periodic boundary conditions is the standard assumption required for von Neumann analysis to be applicable.\n- **Objectivity**: The problem is stated using precise, objective, and standard terminology from engineering and applied mathematics.\n\nThe problem contains no scientific unsoundness, no missing information, no contradictions, and no subjective claims. It is a formalizable and relevant problem in its stated topic.\n\nStep 3: Verdict and Action.\nThe problem is valid. A complete solution will be provided.\n\nThe first step is to derive the discrete update equation from the integral energy balance on a control volume. The energy balance for a control volume $CV_i$ centered at node $i$ with volume $V = A \\Delta x$ is given by:\n$$\n\\frac{dE_{stored}}{dt} = \\dot{E}_{in} - \\dot{E}_{out} + \\dot{E}_{gen}\n$$\nThe rate of change of stored energy is $\\frac{dE_{stored}}{dt} = \\frac{d}{dt} (\\rho c_p T_i V) = \\rho c_p A \\Delta x \\frac{dT_i}{dt}$. The problem states there are no internal heat sources, so $\\dot{E}_{gen} = 0$. The net energy transfer is due to conduction at the control volume faces, located at $x_{i-1/2}$ and $x_{i+1/2}$.\n$$\n\\dot{E}_{in} - \\dot{E}_{out} = \\dot{Q}_{x, i-1/2} - \\dot{Q}_{x, i+1/2}\n$$\nAccording to Fourier's law of heat conduction, the heat rate is $\\dot{Q}_x = -kA \\frac{\\partial T}{\\partial x}$. We approximate the gradients at the control volume faces using central differences between adjacent nodes:\n$$\n\\dot{Q}_{x, i-1/2} \\approx -kA \\frac{T_i - T_{i-1}}{\\Delta x}\n$$\n$$\n\\dot{Q}_{x, i+1/2} \\approx -kA \\frac{T_{i+1} - T_i}{\\Delta x}\n$$\nSubstituting these into the energy balance equation:\n$$\n\\rho c_p A \\Delta x \\frac{dT_i}{dt} = \\left( -kA \\frac{T_i - T_{i-1}}{\\Delta x} \\right) - \\left( -kA \\frac{T_{i+1} - T_i}{\\Delta x} \\right)\n$$\nSimplifying the right-hand side:\n$$\n\\rho c_p A \\Delta x \\frac{dT_i}{dt} = kA \\left( \\frac{T_{i-1} - T_i}{\\Delta x} + \\frac{T_{i+1} - T_i}{\\Delta x} \\right) = \\frac{kA}{\\Delta x} (T_{i-1} - 2T_i + T_{i+1})\n$$\nDividing by $\\rho c_p A \\Delta x$ yields the semi-discrete equation:\n$$\n\\frac{dT_i}{dt} = \\frac{k}{\\rho c_p} \\frac{T_{i-1} - 2T_i + T_{i+1}}{\\Delta x^2} = \\alpha \\frac{T_{i-1} - 2T_i + T_{i+1}}{\\Delta x^2}\n$$\nFor an explicit time integration scheme, we use a forward difference for the time derivative and evaluate the spatial derivatives at the known time level $n$. The time derivative is approximated as $\\frac{dT_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$.\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i-1}^n - 2T_i^n + T_{i+1}^n}{\\Delta x^2}\n$$\nSolving for the temperature at the next time level, $T_i^{n+1}$:\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{\\Delta x^2} (T_{i-1}^n - 2T_i^n + T_{i+1}^n)\n$$\nUsing the definition of the Fourier number, $\\mathrm{Fo} \\equiv \\frac{\\alpha \\Delta t}{\\Delta x^2}$, the fully discrete explicit update equation is:\n$$\nT_i^{n+1} = T_i^n + \\mathrm{Fo} (T_{i-1}^n - 2T_i^n + T_{i+1}^n)\n$$\n$$\nT_i^{n+1} = \\mathrm{Fo} T_{i-1}^n + (1 - 2\\mathrm{Fo}) T_i^n + \\mathrm{Fo} T_{i+1}^n\n$$\nThis is the required discrete update equation. Now, we perform the von Neumann stability analysis. We assume the solution can be represented by a Fourier series. Due to the linearity of the equation, we need only consider a single generic mode of the form:\n$$\nT_i^n = \\hat{T}^n e^{j K x_i}\n$$\nwhere $j = \\sqrt{-1}$ is the imaginary unit, $K$ is the wave number, $x_i = i \\Delta x$ is the spatial coordinate of node $i$, and $\\hat{T}^n$ is the amplitude of the mode at time level $n$. The temperature at the next time step is given by $T_i^{n+1} = G T_i^n$, where $G = \\frac{\\hat{T}^{n+1}}{\\hat{T}^n}$ is the amplification factor. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity, i.e., $|G| \\leq 1$.\n\nWe substitute the Fourier mode representation into the discrete update equation. The neighboring nodal temperatures are:\n$$\nT_{i-1}^n = \\hat{T}^n e^{j K (i-1)\\Delta x} = \\hat{T}^n e^{j K i \\Delta x} e^{-j K \\Delta x} = T_i^n e^{-j K \\Delta x}\n$$\n$$\nT_{i+1}^n = \\hat{T}^n e^{j K (i+1)\\Delta x} = \\hat{T}^n e^{j K i \\Delta x} e^{j K \\Delta x} = T_i^n e^{j K \\Delta x}\n$$\nSubstituting these into the update equation:\n$$\nG T_i^n = \\mathrm{Fo} (T_i^n e^{-j K \\Delta x}) + (1 - 2\\mathrm{Fo}) T_i^n + \\mathrm{Fo} (T_i^n e^{j K \\Delta x})\n$$\nDividing by $T_i^n$ (which is non-zero) gives the expression for the amplification factor $G$:\n$$\nG = \\mathrm{Fo} (e^{-j K \\Delta x} + e^{j K \\Delta x}) + 1 - 2\\mathrm{Fo}\n$$\nUsing Euler's identity, $e^{j\\theta} + e^{-j\\theta} = 2\\cos(\\theta)$, with $\\theta = K \\Delta x$:\n$$\nG = 2\\mathrm{Fo}\\cos(K \\Delta x) + 1 - 2\\mathrm{Fo} = 1 + 2\\mathrm{Fo}(\\cos(K \\Delta x) - 1)\n$$\nUsing the trigonometric identity $\\cos(\\theta) - 1 = -2\\sin^2(\\frac{\\theta}{2})$:\n$$\nG = 1 + 2\\mathrm{Fo}(-2\\sin^2(\\frac{K \\Delta x}{2})) = 1 - 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2})\n$$\nThe amplification factor $G$ is a real number. The stability condition $|G| \\leq 1$ becomes $-1 \\leq G \\leq 1$.\nThe first inequality, $G \\leq 1$, is:\n$$\n1 - 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2}) \\leq 1 \\implies -4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2}) \\leq 0\n$$\nSince $\\mathrm{Fo} \\geq 0$ and $\\sin^2(\\cdot) \\geq 0$, this condition is always satisfied. This indicates the scheme is dissipative, not ampliative.\n\nThe second inequality, $G \\geq -1$, imposes the critical constraint:\n$$\n1 - 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2}) \\geq -1\n$$\n$$\n2 \\geq 4\\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2})\n$$\n$$\n\\frac{1}{2} \\geq \\mathrm{Fo}\\sin^2(\\frac{K \\Delta x}{2})\n$$\nThis must hold for all possible wave numbers $K$. The stability is most challenged when the term $\\sin^2(\\frac{K \\Delta x}{2})$ is at its maximum. The maximum value of $\\sin^2(\\cdot)$ is $1$. This maximum occurs for the highest frequency (shortest wavelength) mode supported by the grid, where the temperature profile alternates sign between adjacent nodes. This corresponds to a wavelength of $\\lambda = 2\\Delta x$, and a wave number $K = \\frac{2\\pi}{\\lambda} = \\frac{\\pi}{\\Delta x}$. For this mode, $\\frac{K \\Delta x}{2} = \\frac{\\pi}{2}$, and $\\sin^2(\\frac{\\pi}{2}) = 1$.\n\nSubstituting this maximum value into the inequality gives the most restrictive condition on $\\mathrm{Fo}$:\n$$\n\\frac{1}{2} \\geq \\mathrm{Fo} \\cdot 1\n$$\n$$\n\\mathrm{Fo} \\leq \\frac{1}{2}\n$$\nTherefore, the largest value of the Fourier number for which the explicit scheme is stable for all Fourier modes is $\\frac{1}{2}$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2472555"}]}