{"hands_on_practices": [{"introduction": "Before applying any model, a skilled engineer must first determine its suitability for the problem at hand. Thermal wall functions are a powerful computational shortcut, but their validity is strictly limited to certain flow regimes. This exercise [@problem_id:2537357] challenges you to think critically about these limits, focusing on the physical and numerical criteria, such as the local friction Reynolds number $Re_{\\tau}$ and the placement of the first computational cell $y_P^{+}$, that dictate when a wall function is an appropriate choice versus when the boundary layer must be resolved directly.", "problem": "A computational thermal-fluid analysis of a turbulent boundary layer over a heated flat plate is performed using Reynolds-Averaged Navier–Stokes (RANS) equations with a two-equation turbulence closure. The wall heat flux is nonzero. The near-wall treatment for the temperature field can be either a thermal wall function or a low-Reynolds-number integration resolving the viscous and thermal sublayers to the wall. Let the local friction velocity be defined as $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$, the kinematic viscosity be $\\nu$, the boundary layer thickness be $\\delta_{99}$, and the local friction Reynolds number be $Re_{\\tau} = u_{\\tau}\\,\\delta_{99}/\\nu$. The wall-normal distance of the centroid of the first off-wall cell is $y_{P}$, and the corresponding inner-scaled wall distance is $y_P^{+} = u_{\\tau}\\,y_{P}/\\nu$. The Prandtl number is $\\mathrm{Pr} = \\nu/\\alpha$ with $\\alpha$ the thermal diffusivity. The dimensionless temperature is based on the friction temperature $T_{\\tau} = q_{w}/(\\rho c_{p} u_{\\tau})$ so that $T^+ = (T_{w} - T)/T_{\\tau}$. \n\nThermal wall functions assume an overlap region wherein turbulent transport dominates molecular transport for both momentum and heat, allowing a similarity form for $U^{+}$ and $T^{+}$, whereas resolving to the wall requires $y_P^{+} \\lesssim \\mathcal{O}(1)$ and no reliance on a log-law overlap. Which of the following criteria best identifies when thermal wall functions should be disabled in favor of resolving down to the wall?\n\nA. Disable thermal wall functions when the local overlap region is not sufficiently developed or the first cell is inside the thermal sublayer; specifically, if $Re_{\\tau} \\lesssim 200$ or $y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$, where $y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-1}$ for $\\mathrm{Pr} \\gtrsim 1$ and $y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-2/3}$ for $\\mathrm{Pr} \\lesssim 1$. In those cases, target $y_{P}^{+} \\lesssim 1$ and integrate to the wall.\n\nB. Disable thermal wall functions only if $y_{P}^{+} \\gtrsim 200$ (the wall-adjacent cell is far from the wall), because otherwise the wall-function log-law is the most accurate representation of $T^{+}$.\n\nC. Disable thermal wall functions only if $Re_{\\tau} \\gtrsim 1000$ (very high friction Reynolds number), because at very high $Re_{\\tau}$ the thermal log-layer breaks down and low-Reynolds-number integration is required.\n\nD. Do not disable thermal wall functions, because modern $T^{+}(y^{+},\\mathrm{Pr})$ correlations are valid for all $y^{+}$ and all $\\mathrm{Pr}$, including $y^{+} \\rightarrow 0$.\n\nE. Disable thermal wall functions whenever $y_{P}^{+} < 30$, irrespective of $Re_{\\tau}$ and $\\mathrm{Pr}$, because the buffer layer invalidates similarity; otherwise, wall functions are always safe.", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n- **System:** Turbulent boundary layer over a heated flat plate.\n- **Governing Equations:** Reynolds-Averaged Navier–Stokes (RANS) with a two-equation turbulence closure.\n- **Boundary Condition:** Nonzero wall heat flux, $q_{w}$.\n- **Modeling Approaches:** Thermal wall function vs. low-Reynolds-number integration to the wall.\n- **Definitions:**\n    - Friction velocity: $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$\n    - Kinematic viscosity: $\\nu$\n    - Boundary layer thickness: $\\delta_{99}$\n    - Friction Reynolds number: $Re_{\\tau} = u_{\\tau}\\,\\delta_{99}/\\nu$\n    - First cell center wall-normal distance: $y_{P}$\n    - Inner-scaled wall distance: $y_{P}^{+} = u_{\\tau}\\,y_{P}/\\nu$\n    - Prandtl number: $\\mathrm{Pr} = \\nu/\\alpha$\n    - Friction temperature: $T_{\\tau} = q_{w}/(\\rho c_{p} u_{\\tau})$\n    - Dimensionless temperature: $T^{+} = (T_{w} - T)/T_{\\tau}$\n- **Premises:**\n    - Thermal wall functions assume an overlap region with similarity laws for dimensionless velocity $U^{+}$ and temperature $T^{+}$.\n    - Resolving to the wall requires a mesh with $y_{P}^{+} \\lesssim \\mathcal{O}(1)$.\n- **Question:** What criteria determine when thermal wall functions should be disabled in favor of resolving the flow down to the wall?\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded in the established theory and practice of Computational Fluid Dynamics (CFD) for turbulent heat transfer. All terminology ($u_{\\tau}$, $y^{+}$, $T^{+}$, $Re_{\\tau}$, $\\mathrm{Pr}$) and concepts (RANS, wall functions, low-Reynolds-number modeling) are standard and correctly defined. The problem poses a clear, objective, and well-posed question regarding the application criteria for two distinct near-wall modeling strategies. The premises are accurate representations of the assumptions underlying these methods. The problem is self-contained, consistent, and scientifically sound. It does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation of Principles\nThermal wall functions are a computational shortcut in RANS modeling. They circumvent the need for a highly resolved mesh in the near-wall region by applying a semi-empirical law to bridge the gap between the wall surface and the centroid of the first off-wall computational cell. This approach is founded on the \"law of the wall,\" which posits a universal structure for the mean velocity and temperature profiles in the inner part of a turbulent boundary layer when scaled with inner variables ($u_{\\tau}$, $\\nu$).\n\nThe validity of this approach rests on two critical assumptions:\n1.  **Existence of a Logarithmic Overlap Region:** The boundary layer must be turbulent enough (i.e., have a sufficiently high Reynolds number) to develop a distinct logarithmic region where both velocity and temperature profiles follow a logarithmic law. This region typically requires the friction Reynolds number, $Re_{\\tau} = u_{\\tau}\\delta_{99}/\\nu$, to be at least a few hundred. If $Re_{\\tau}$ is too low (e.g., $Re_{\\tau} \\lesssim 200 - 300$), this logarithmic region is either nascent or non-existent, invalidating the basis of the wall function.\n2.  **Proper Cell Placement:** The centroid of the first off-wall cell, denoted by its dimensionless distance $y_{P}^{+}$, must be located within this logarithmic region. The log-law for momentum is generally considered valid for $y^{+} \\gtrsim 30$. If $y_{P}^{+}$ is too small (e.g., $y_{P}^{+} \\lesssim 30$), the cell center falls into the viscous sublayer ($y^{+} \\lesssim 5$) or the buffer layer ($5 \\lesssim y^{+} \\lesssim 30$), where the logarithmic law is not applicable.\n\nFor thermal wall functions, the situation is complicated by the Prandtl number, $\\mathrm{Pr} = \\nu/\\alpha$. The thickness of the thermal (conductive) sublayer relative to the viscous sublayer depends strongly on $\\mathrm{Pr}$.\n-   For $\\mathrm{Pr} \\approx 1$ (gases), the thermal and viscous sublayers have comparable thicknesses. The edge of both is roughly at $y^{+} \\approx 10-12$.\n-   For $\\mathrm{Pr} \\gg 1$ (oils, water), the thermal sublayer is much thinner than the viscous sublayer. Molecular conduction is confined to a very thin layer near the wall.\n-   For $\\mathrm{Pr} \\ll 1$ (liquid metals), the thermal sublayer is much thicker than the viscous sublayer. Molecular conduction can be significant even far into the region that is fully turbulent for momentum.\n\nA thermal wall function is invalid if the first cell center at $y_{P}^{+}$ lies within the thermal sublayer, as the physics is dominated by molecular conduction ($T^{+} \\approx \\mathrm{Pr}\\,y^{+}$), not the turbulent transport assumed by the thermal log-law. The edge of this thermal sublayer, $y_{t}^{+}$, is therefore a function of $\\mathrm{Pr}$.\n\nTherefore, thermal wall functions must be disabled and one must resort to resolving the boundary layer (low-Reynolds-number modeling, which requires $y_{P}^{+} \\lesssim 1$) if either:\n(a) The overall flow Reynolds number ($Re_{\\tau}$) is too low for a log-law region to exist.\n(b) The first cell is placed inside the thermal sublayer, i.e., $y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$.\n\n### Option-by-Option Analysis\n\n**A. Disable thermal wall functions when the local overlap region is not sufficiently developed or the first cell is inside the thermal sublayer; specifically, if $Re_{\\tau} \\lesssim 200$ or $y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$, where $y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-1}$ for $\\mathrm{Pr} \\gtrsim 1$ and $y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-2/3}$ for $\\mathrm{Pr} \\lesssim 1$. In those cases, target $y_{P}^{+} \\lesssim 1$ and integrate to the wall.**\n\nThis option correctly identifies the two primary conditions for abandoning wall functions. First, a low friction Reynolds number ($Re_{\\tau} \\lesssim 200$) indicates an underdeveloped logarithmic region, making the wall function's premise faulty. Second, it recognizes that if the first cell center is within the thermal sublayer ($y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$), the log-law assumption is violated locally. The provided scalings for $y_{t}^{+}$ with $\\mathrm{Pr}$ correctly capture the physical trends: the thermal sublayer becomes very thin for high $\\mathrm{Pr}$ and very thick for low $\\mathrm{Pr}$. Finally, the prescribed action—targeting $y_{P}^{+} \\lesssim 1$ for direct integration—is the correct procedure for low-Reynolds-number modeling. This option is comprehensive and physically sound.\n\n**Verdict: Correct**\n\n**B. Disable thermal wall functions only if $y_{P}^{+} \\gtrsim 200$ (the wall-adjacent cell is far from the wall), because otherwise the wall-function log-law is the most accurate representation of $T^{+}$.**\n\nThis statement is fundamentally incorrect. The primary violation of the wall function assumption occurs when $y_{P}^{+}$ is *too low* (i.e., in the buffer or viscous/thermal sublayers, $y_{P}^{+} \\lesssim 30$), not when it is too high. The log-law is explicitly *not* valid for small $y^{+}$. Claiming it is the \"most accurate representation\" for $y_{P}^{+} \\lesssim 200$ is false, as it ignores the sublayer and buffer layer physics.\n\n**Verdict: Incorrect**\n\n**C. Disable thermal wall functions only if $Re_{\\tau} \\gtrsim 1000$ (very high friction Reynolds number), because at very high $Re_{\\tau}$ the thermal log-layer breaks down and low-Reynolds-number integration is required.**\n\nThis reasoning is inverted. High Reynolds numbers ($Re_{\\tau} \\gg 1$) are precisely the regime where the logarithmic overlap region is most extensive and well-defined. Consequently, wall functions are most suitable and accurate at high $Re_{\\tau}$, not the other way around. The log-layer does not \"break down\" at high $Re_{\\tau}$; it becomes more prominent.\n\n**Verdict: Incorrect**\n\n**D. Do not disable thermal wall functions, because modern $T^{+}(y^{+},\\mathrm{Pr})$ correlations are valid for all $y^{+}$ and all $\\mathrm{Pr}$, including $y^{+} \\rightarrow 0$.**\n\nThis refers to so-called \"all-$y^{+}$\" or \"blended\" wall functions. While these advanced models provide a single correlation that attempts to smoothly bridge the sublayer and log-law regions, they are still a form of *model* for the near-wall behavior, not a direct resolution of the governing transport equations. The problem distinguishes between using a \"thermal wall function\" and \"resolving the...sublayers to the wall\". The latter implies using a turbulence model that is itself valid down to the wall (a low-Re model) and solving the equations on a fine mesh ($y_{P}^{+} \\lesssim 1$), which is fundamentally different from any type of wall function. The assertion that one should \"not disable\" them is an overstatement of their universal applicability and accuracy, especially in complex flows or at low Reynolds numbers.\n\n**Verdict: Incorrect**\n\n**E. Disable thermal wall functions whenever $y_{P}^{+} < 30$, irrespective of $Re_{\\tau}$ and $\\mathrm{Pr}$, because the buffer layer invalidates similarity; otherwise, wall functions are always safe.**\n\nThis option presents a common but overly simplistic rule of thumb. The condition $y_{P}^{+} < 30$ is indeed a primary reason to disable wall functions. However, the qualifiers \"irrespective of $Re_{\\tau}$ and $\\mathrm{Pr}$\" and \"otherwise...always safe\" are incorrect. As explained, a low $Re_{\\tau}$ can invalidate wall functions even if $y_{P}^{+} > 30$. Moreover, for low-$\\mathrm{Pr}$ fluids, the thermal sublayer can extend beyond $y^{+} = 30$, meaning a cell at, for example, $y_{P}^{+} = 40$ could still be in the conductive region, invalidating the thermal log-law. This option lacks the necessary nuance provided in option A.\n\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2537357"}, {"introduction": "Moving from theory to practice often introduces complexities, and for thermal wall functions, one of the most significant is the variation of fluid properties with temperature. In many engineering applications, large temperature gradients across the boundary layer mean that properties like viscosity $\\mu$ and conductivity $k$ cannot be treated as constant. This practice [@problem_id:2537356] guides you through the development of a robust iterative procedure to ensure thermodynamic consistency, where the properties used in the wall function are themselves dependent on the thermal solution, leading to a more physically accurate prediction of the wall heat flux $q_w$.", "problem": "Consider a fully developed, steady, turbulent boundary layer over an isothermal flat wall with a near-wall computational cell whose center is located at a normal distance $y_P$ from the wall. Let the cell-center temperature be $T_P$ and the wall temperature be $T_w$. Assume low-Mach-number flow of air so that thermophysical properties may be treated as functions of temperature only. The objective is to compute a thermodynamically consistent wall heat flux $q_w$ using a thermal wall function while iteratively updating the properties evaluated between $T_P$ and $T_w$.\n\nStart from the following foundational principles and well-tested formulas:\n\n- Ideal gas law for air at constant static pressure $p$: $\\rho(T) = \\dfrac{p}{R T}$, where $R = 287.058\\ \\mathrm{J/(kg\\cdot K)}$.\n- Dynamic viscosity via Sutherland’s law:\n$$\n\\mu(T) = \\mu_0 \\left(\\dfrac{T}{T_0}\\right)^{3/2} \\dfrac{T_0 + S}{T + S},\\quad \\mu_0 = 1.716\\times 10^{-5}\\ \\mathrm{Pa\\cdot s},\\ T_0 = 273.15\\ \\mathrm{K},\\ S = 110.4\\ \\mathrm{K}.\n$$\n- Thermal conductivity (empirical linear fit for air over a moderate temperature range):\n$$\nk(T) = k_0 + a_k\\,(T - T_0),\\quad k_0 = 0.0241\\ \\mathrm{W/(m\\cdot K)},\\ a_k = 7.2\\times 10^{-5}\\ \\mathrm{W/(m\\cdot K^2)},\\ T_0 = 273.15\\ \\mathrm{K}.\n$$\n- Specific heat at constant pressure (empirical linear fit):\n$$\nc_p(T) = c_{p0} + a_{cp}\\,(T - 300\\ \\mathrm{K}),\\quad c_{p0} = 1006.43\\ \\mathrm{J/(kg\\cdot K)},\\ a_{cp} = 0.1\\ \\mathrm{J/(kg\\cdot K^2)}.\n$$\n- Molecular Prandtl number:\n$$\n\\Pr(T) = \\dfrac{\\mu(T)\\,c_p(T)}{k(T)}.\n$$\n- Turbulent Prandtl number treated as constant: $\\Pr_t = 0.85$.\n- Define the friction velocity $u_\\tau$ and the dimensionless wall distance\n$$\ny^+ = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}.\n$$\n- Define the temperature scale and wall heat flux by\n$$\nT_\\tau = \\dfrac{q_w}{\\rho\\,c_p\\,u_\\tau},\\qquad q_w = \\rho\\,c_p\\,u_\\tau\\,T_\\tau,\n$$\nand the inner-scaled temperature at the cell center\n$$\nT^+ = \\dfrac{T_P - T_w}{T_\\tau}.\n$$\n\nAdopt a standard, piecewise thermal wall-function profile that bridges the viscous sublayer and the logarithmic region with continuity at a matching point. Let $\\kappa = 0.41$, $E = 9.8$, and $y_0^+ = 11.81$. Define the effective logarithmic slope as $\\kappa_t = \\kappa\\,\\Pr_t$. Then, for a given $y^+$ and molecular Prandtl number $\\Pr$,\n$$\nT^+(y^+;\\Pr) =\n\\begin{cases}\n\\Pr\\,y^+, & y^+ \\le y_0^+ \\\\[4pt]\n\\dfrac{1}{\\kappa_t}\\ln\\!\\big(E\\,y^+\\big) + B_t(\\Pr), & y^+ > y_0^+\n\\end{cases}\n$$\nwhere the additive constant ensures continuity at $y_0^+$:\n$$\nB_t(\\Pr) = \\Pr\\,y_0^+ - \\dfrac{1}{\\kappa_t}\\ln\\!\\big(E\\,y_0^+\\big).\n$$\n\nTask A (derivation). Using the definitions above and the energy balance at the wall, derive a fixed-point iteration that enforces thermodynamic consistency for property evaluation between $T_P$ and $T_w$ within the wall-function loop. Your iteration must:\n- Use a reference temperature $T_{\\mathrm{ref}}$ to evaluate $\\rho(T_{\\mathrm{ref}})$, $\\mu(T_{\\mathrm{ref}})$, $k(T_{\\mathrm{ref}})$, $c_p(T_{\\mathrm{ref}})$, and $\\Pr(T_{\\mathrm{ref}})$.\n- Compute $y^+ = \\rho(T_{\\mathrm{ref}})\\,u_\\tau\\,y_P/\\mu(T_{\\mathrm{ref}})$, then $T^+(y^+;\\Pr(T_{\\mathrm{ref}}))$, followed by $T_\\tau = (T_P - T_w)/T^+(y^+;\\Pr(T_{\\mathrm{ref}}))$ and $q_w = \\rho(T_{\\mathrm{ref}})\\,c_p(T_{\\mathrm{ref}})\\,u_\\tau\\,T_\\tau$.\n- Update $T_{\\mathrm{ref}}$ from the wall-function temperature distribution to better represent the thermodynamic state between $T_P$ and $T_w$. One principled choice is to take the profile-based midpoint temperature: let $y_m^+ = y^+/2$ and set\n$$\nT_{\\mathrm{mid}} = T_w + T_\\tau\\,T^+(y_m^+;\\Pr(T_{\\mathrm{ref}})).\n$$\nForm a relaxed fixed-point update $T_{\\mathrm{ref}} \\leftarrow (1-\\beta)\\,T_{\\mathrm{ref}} + \\beta\\,T_{\\mathrm{mid}}$ with a relaxation parameter $\\beta \\in (0,1]$, and iterate until convergence in $T_{\\mathrm{ref}}$.\n\nProvide a clear stopping criterion in terms of $|T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}|$ and discuss how to guard against divergence and ensure the updated $T_{\\mathrm{ref}}$ remains within the physically admissible interval between $T_w$ and $T_P$.\n\nTask B (implementation). Implement the derived iteration in code that, for each test case, returns:\n- the converged wall heat flux $q_w$ in $\\mathrm{W/m^2}$, rounded to $3$ decimal places,\n- the converged $y^+$, rounded to $3$ decimal places,\n- the number of iterations (an integer),\n- a convergence flag as an integer, where $1$ denotes convergence and $0$ denotes failure to converge within the iteration limit.\n\nUse the following test suite, which spans a typical case, a viscous-sublayer-dominated case, a high-$y^+$ case with strong property variation, and a small temperature difference case:\n\n- Case $1$: $p = 101325\\ \\mathrm{Pa}$, $T_w = 300\\ \\mathrm{K}$, $T_P = 600\\ \\mathrm{K}$, $u_\\tau = 0.5\\ \\mathrm{m/s}$, $y_P = 5.0\\times 10^{-4}\\ \\mathrm{m}$.\n- Case $2$: $p = 101325\\ \\mathrm{Pa}$, $T_w = 350\\ \\mathrm{K}$, $T_P = 400\\ \\mathrm{K}$, $u_\\tau = 0.3\\ \\mathrm{m/s}$, $y_P = 1.0\\times 10^{-4}\\ \\mathrm{m}$.\n- Case $3$: $p = 101325\\ \\mathrm{Pa}$, $T_w = 300\\ \\mathrm{K}$, $T_P = 1200\\ \\mathrm{K}$, $u_\\tau = 1.0\\ \\mathrm{m/s}$, $y_P = 3.0\\times 10^{-3}\\ \\mathrm{m}$.\n- Case $4$: $p = 101325\\ \\mathrm{Pa}$, $T_w = 320\\ \\mathrm{K}$, $T_P = 321\\ \\mathrm{K}$, $u_\\tau = 0.2\\ \\mathrm{m/s}$, $y_P = 1.0\\times 10^{-3}\\ \\mathrm{m}$.\n\nNumerical and implementation requirements:\n\n- Use a convergence tolerance of $|T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}| < 10^{-6}\\ \\mathrm{K}$, a maximum of $100$ iterations, and choose a relaxation factor $\\beta = 0.5$.\n- Clamp the updated $T_{\\mathrm{ref}}$ to the closed interval with endpoints $\\min(T_w,T_P)$ and $\\max(T_w,T_P)$ at each iteration.\n- All constants and coefficients must be exactly as specified above.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list of lists with no spaces, in the order of the test cases. The format must be:\n\"[ [q1,yplus1,it1,conv1], [q2,yplus2,it2,conv2], [q3,yplus3,it3,conv3], [q4,yplus4,it4,conv4] ]\"\nbut without spaces, i.e.,\n\"[[q1,yplus1,it1,conv1],[q2,yplus2,it2,conv2],[q3,yplus3,it3,conv3],[q4,yplus4,it4,conv4]]\"\nwhere each $q_i$ is in $\\mathrm{W/m^2}$ rounded to $3$ decimal places, each $y^+_i$ is rounded to $3$ decimal places, and $it_i$ and $conv_i$ are integers.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and complete. It describes a standard and relevant problem in computational heat transfer: the use of a thermal wall function to compute wall heat flux in a turbulent boundary layer, with the additional complexity of handling temperature-dependent fluid properties. All necessary physical models, constants, and numerical parameters for a unique solution are provided. The task is to derive and implement a fixed-point iteration to ensure that the fluid properties are evaluated at a thermodynamically consistent reference temperature.\n\nThe derivation and implementation follow.\n\nThe objective is to compute the wall heat flux, $q_w$, given the wall temperature $T_w$, the near-wall cell-center temperature $T_P$ at a distance $y_P$, the static pressure $p$, and the friction velocity $u_\\tau$. Because the fluid properties ($\\rho$, $\\mu$, $k$, $c_p$) are strong functions of temperature, they must be evaluated at a representative temperature, $T_{\\mathrm{ref}}$, that correctly reflects the thermal state of the near-wall layer. An iterative procedure is required to find a self-consistent $T_{\\mathrm{ref}}$ and the corresponding $q_w$. A fixed-point iteration scheme is constructed for this purpose.\n\nLet the iteration be indexed by $n$. The process begins with an initial guess for the reference temperature, $T_{\\mathrm{ref}}^{(0)}$. A robust initial guess is the arithmetic mean of the wall and cell-center temperatures:\n$$\nT_{\\mathrm{ref}}^{(0)} = \\frac{T_w + T_P}{2}\n$$\n\nThe iterative procedure for $n = 0, 1, 2, \\dots$ is as follows:\n\n1.  **Evaluate Thermophysical Properties**: At the current reference temperature $T_{\\mathrm{ref}}^{(n)}$, all temperature-dependent properties are computed:\n    *   Density from the ideal gas law: $\\rho^{(n)} = \\rho(T_{\\mathrm{ref}}^{(n)}) = \\dfrac{p}{R T_{\\mathrm{ref}}^{(n)}}$.\n    *   Dynamic viscosity from Sutherland's law: $\\mu^{(n)} = \\mu(T_{\\mathrm{ref}}^{(n)})$.\n    *   Thermal conductivity from the linear fit: $k^{(n)} = k(T_{\\mathrm{ref}}^{(n)})$.\n    *   Specific heat at constant pressure from the linear fit: $c_p^{(n)} = c_p(T_{\\mathrm{ref}}^{(n)})$.\n    *   Molecular Prandtl number: $\\Pr^{(n)} = \\Pr(T_{\\mathrm{ref}}^{(n)}) = \\dfrac{\\mu^{(n)} c_p^{(n)}}{k^{(n)}}$.\n\n2.  **Compute Dimensionless Parameters**: The dimensionless wall distance for the cell center at $y_P$ is calculated:\n    $$\n    y^{+(n)} = \\frac{\\rho^{(n)} u_\\tau y_P}{\\mu^{(n)}}\n    $$\n\n3.  **Evaluate Dimensionless Temperature $T^+$**: Using the provided piecewise thermal law of the wall, the dimensionless temperature at the cell center, $T_P^{+(n)} = T^+(y^{+(n)}; \\Pr^{(n)})$, is computed. The effective logarithmic slope is $\\kappa_t = \\kappa \\Pr_t = 0.41 \\times 0.85 = 0.3485$. The additive constant $B_t$ is first determined to ensure continuity at the matching point $y_0^+ = 11.81$:\n    $$\n    B_t^{(n)} = \\Pr^{(n)} y_0^+ - \\frac{1}{\\kappa_t}\\ln(E y_0^+)\n    $$\n    Then, $T_P^{+(n)}$ is found from:\n    $$\n    T_P^{+(n)} =\n    \\begin{cases}\n    \\Pr^{(n)} y^{+(n)}, & \\text{if } y^{+(n)} \\le y_0^+ \\\\\n    \\dfrac{1}{\\kappa_t}\\ln(E y^{+(n)}) + B_t^{(n)}, & \\text{if } y^{+(n)} > y_0^+\n    \\end{cases}\n    $$\n\n4.  **Compute Heat Flux**: The temperature scale $T_\\tau^{(n)}$ is calculated from its definition:\n    $$\n    T_\\tau^{(n)} = \\frac{T_P - T_w}{T_P^{+(n)}}\n    $$\n    The wall heat flux at this iteration is then:\n    $$\n    q_w^{(n)} = \\rho^{(n)} c_p^{(n)} u_\\tau T_\\tau^{(n)}\n    $$\n\n5.  **Update the Reference Temperature**: A new, more accurate reference temperature is computed based on the current solution. A new temperature, $T_{\\mathrm{mid}}^{(n)}$, is calculated, representing the physical temperature at the midpoint of the near-wall layer, $y_m = y_P/2$. First, the dimensionless midpoint distance is $y_m^{+(n)} = y^{+(n)}/2$. The dimensionless temperature at this point, $T_m^{+(n)} = T^+(y_m^{+(n)}; \\Pr^{(n)})$, is computed using the same piecewise function as in Step 3. The physical midpoint temperature is then:\n    $$\n    T_{\\mathrm{mid}}^{(n)} = T_w + T_\\tau^{(n)} T_m^{+(n)}\n    $$\n    The reference temperature for the next iteration, $T_{\\mathrm{ref}}^{(n+1)}$, is obtained via a relaxed update using the a relaxation factor $\\beta = 0.5$:\n    $$\n    T_{\\mathrm{ref, cand}}^{(n+1)} = (1-\\beta)T_{\\mathrm{ref}}^{(n)} + \\beta T_{\\mathrm{mid}}^{(n)}\n    $$\n\n6.  **Stabilization and Convergence Check**:\n    *   **Guarding Against Divergence**: To ensure numerical stability and physical admissibility, the updated reference temperature must remain within the bounds set by the wall and cell-center temperatures. Thus, $T_{\\mathrm{ref, cand}}^{(n+1)}$ is clamped:\n      $$\n      T_{\\mathrm{ref}}^{(n+1)} = \\max(\\min(T_w, T_P), \\min(\\max(T_w, T_P), T_{\\mathrm{ref, cand}}^{(n+1)}))\n      $$\n      This step prevents the iteration from producing unphysical temperatures, especially in cases with large temperature differences or during initial transient iterations.\n    *   **Stopping Criterion**: The iteration is considered converged when the absolute difference between successive reference temperatures falls below a specified tolerance $\\epsilon_T = 10^{-6}\\ \\mathrm{K}$:\n      $$\n      |T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}| < \\epsilon_T\n      $$\n    *   **Iteration Limit**: A maximum number of iterations, $N_{\\max} = 100$, is imposed. If the convergence criterion is not met within this limit, the process is terminated and flagged as non-converged.\n\nUpon convergence or reaching the iteration limit, the final values of $q_w$, $y^+$, the number of iterations, and a convergence flag are reported. This completes the logic for the required algorithm, which is implemented in the provided Python code.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for wall heat flux using a thermal wall function with iterative property updates.\n    \"\"\"\n    # Constants\n    R = 287.058  # J/(kg.K), specific gas constant for air\n    # Sutherland's law for viscosity\n    MU0 = 1.716e-5  # Pa.s\n    T0_MU = 273.15  # K\n    S_MU = 110.4  # K\n    # Linear fit for thermal conductivity\n    K0 = 0.0241  # W/(m.K)\n    AK = 7.2e-5  # W/(m.K^2)\n    T0_K = 273.15 # K\n    # Linear fit for specific heat\n    CP0 = 1006.43  # J/(kg.K)\n    ACP = 0.1  # J/(kg.K^2)\n    T0_CP = 300.0 # K\n    # Turbulence model constants\n    PR_T = 0.85\n    KAPPA = 0.41\n    E = 9.8\n    Y0_PLUS = 11.81\n    KAPPA_T = KAPPA * PR_T\n\n    # Numerical parameters\n    BETA = 0.5  # Relaxation factor\n    TOL = 1e-6  # Convergence tolerance for T_ref\n    MAX_ITER = 100  # Maximum number of iterations\n\n    # Test cases\n    test_cases = [\n        # (p, Tw, Tp, u_tau, yP)\n        (101325.0, 300.0, 600.0, 0.5, 5.0e-4),\n        (101325.0, 350.0, 400.0, 0.3, 1.0e-4),\n        (101325.0, 300.0, 1200.0, 1.0, 3.0e-3),\n        (101325.0, 320.0, 321.0, 0.2, 1.0e-3),\n    ]\n\n    # --- Helper functions for thermophysical properties ---\n    def get_rho(T, p):\n        return p / (R * T)\n\n    def get_mu(T):\n        return MU0 * (T / T0_MU)**1.5 * (T0_MU + S_MU) / (T + S_MU)\n\n    def get_k(T):\n        return K0 + AK * (T - T0_K)\n\n    def get_cp(T):\n        return CP0 + ACP * (T - T0_CP)\n\n    def get_Pr(mu_val, cp_val, k_val):\n        return mu_val * cp_val / k_val\n\n    # --- Helper function for the piecewise wall function T+ ---\n    def get_T_plus(y_plus, pr_val):\n        # Calculate B_t, the additive constant for the log-law part\n        Bt_val = pr_val * Y0_PLUS - (1.0 / KAPPA_T) * np.log(E * Y0_PLUS)\n        if y_plus = Y0_PLUS:\n            return pr_val * y_plus\n        else:\n            return (1.0 / KAPPA_T) * np.log(E * y_plus) + Bt_val\n\n    results = []\n    for p, Tw, Tp, u_tau, yP in test_cases:\n        \n        # Initial guess for reference temperature\n        T_ref = (Tw + Tp) / 2.0\n        T_min = min(Tw, Tp)\n        T_max = max(Tw, Tp)\n        \n        converged = 0\n        iter_count = 0\n        q_w = 0.0\n        y_plus = 0.0\n        \n        for i in range(MAX_ITER):\n            iter_count = i + 1\n            T_ref_old = T_ref\n\n            # 1. Evaluate properties at T_ref\n            rho_val = get_rho(T_ref, p)\n            mu_val = get_mu(T_ref)\n            k_val = get_k(T_ref)\n            cp_val = get_cp(T_ref)\n            pr_val = get_Pr(mu_val, cp_val, k_val)\n            \n            # 2. Compute dimensionless parameters\n            y_plus = (rho_val * u_tau * yP) / mu_val\n\n            # 3. Evaluate dimensionless temperature at cell center\n            T_plus_P = get_T_plus(y_plus, pr_val)\n\n            # 4. Compute heat flux\n            delta_T = Tp - Tw\n            if abs(delta_T)  1e-9 or T_plus_P  1e-9:\n                T_tau = 0.0\n            else:\n                T_tau = delta_T / T_plus_P\n\n            q_w = rho_val * cp_val * u_tau * T_tau\n            \n            # 5. Update reference temperature\n            y_m_plus = y_plus / 2.0\n            T_plus_m = get_T_plus(y_m_plus, pr_val)\n            T_mid = Tw + T_tau * T_plus_m\n            \n            T_ref_cand = (1.0 - BETA) * T_ref + BETA * T_mid\n            \n            # 6. Clamp and check for convergence\n            T_ref = max(T_min, min(T_max, T_ref_cand))\n            \n            if abs(T_ref - T_ref_old)  TOL:\n                converged = 1\n                break\n\n        # Append results for this case\n        results.append([round(q_w, 3), round(y_plus, 3), iter_count, converged])\n    \n    # Format final output string as per requirement\n    # \"[[q1,yplus1,it1,conv1],[q2,yplus2,it2,conv2],...]\"\n    string_results = [f\"[{','.join(map(str, r))}]\" for r in results]\n    final_output = f\"[{','.join(string_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2537356"}, {"introduction": "The predictions of any semi-empirical model are only as reliable as the constants they are built upon. Thermal wall functions depend on parameters like the von Kármán constant $\\kappa$ and the turbulent Prandtl number $Pr_t$, which are determined from experiments and carry inherent uncertainty. This advanced exercise [@problem_id:2537406] introduces you to the principles of sensitivity analysis, a method for quantifying how these uncertainties propagate to key engineering outputs like wall heat flux $q_w$ and Stanton number $St$. By completing this practice, you will learn to assess the confidence in your model's predictions, a critical skill in modern engineering analysis.", "problem": "A turbulent boundary layer over an isothermal, smooth flat wall is modeled in the equilibrium overlap region using a near-wall thermal wall function. Consider a near-wall computational node $P$ located at a normal distance $y_P$ from the wall. Assume a steady, fully turbulent, high Reynolds number flow with negligible pressure-gradient effects and negligible molecular heat conduction compared to turbulent heat transport in the overlap region. Use the gradient-transport hypothesis with an eddy diffusivity closure and the classical overlap scaling for turbulent momentum and heat transport.\n\nDefinitions and data:\n- Fluid properties at $P$: density $\\,\\rho\\,$, specific heat $\\,c_p\\,$, and kinematic viscosity $\\,\\nu\\,$.\n- Friction velocity $\\,u_{\\tau}\\,$, local mean velocity at $P$, $\\,U_P\\,$, and wall-node temperature difference $\\,T_w - T_P\\,$ are known.\n- Dimensionless wall distance $\\,y^+ \\equiv y_P u_{\\tau}/\\nu\\,$ and dimensionless temperature $\\,\\theta^+ \\equiv (T_w - T)\\,\\rho c_p u_{\\tau}/q_w\\,$, where $\\,q_w\\,$ is the wall heat flux directed from the wall into the fluid.\n- The thermal wall function in the overlap region is characterized by the von Kármán constant $\\,\\kappa\\,$, a thermal additive constant $\\,B_t\\,$ that captures inner-outer matching, and a turbulent Prandtl number $\\,Pr_t\\,$.\n- The local Stanton number is defined from magnitudes as $\\,St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)\\,$.\n\nTasks:\n1) Starting from the near-wall heat flux closure $\\,q_w = -\\rho c_p(\\alpha + \\alpha_t)\\,\\partial T/\\partial y\\,$, with molecular thermal diffusivity $\\,\\alpha\\,$ and turbulent thermal diffusivity $\\,\\alpha_t\\,$, the equilibrium overlap form $\\,\\nu_t = \\kappa y u_{\\tau}\\,$ and $\\,\\alpha_t = \\nu_t/Pr_t\\,$, and the above definitions of $\\,\\theta^+\\,$ and $\\,y^+\\,$, derive a logarithmic wall-function relation between $\\,\\theta^+\\,$ and $\\,y^+\\,$ in the form $\\,\\theta^+(y^+) = \\text{(slope)}\\times \\ln y^+ + \\text{(constant)}\\,$. Then, evaluate it at node $P$ and solve for $\\,q_w\\,$ explicitly as a function of $\\,\\kappa\\,$, $\\,B_t\\,$, and $\\,Pr_t\\,$, treating $\\,y_P^+ \\equiv y_P u_{\\tau}/\\nu\\,$ and all other listed quantities as known.\n2) Using your expression for $\\,q_w\\,$, write $\\,St\\,$ in terms of $\\,\\kappa\\,$, $\\,B_t\\,$, and $\\,Pr_t\\,$.\n3) Perform a first-order variance-based local sensitivity analysis of $\\,q_w\\,$ and $\\,St\\,$ with respect to $\\,\\kappa\\,$, $\\,B_t\\,$, and $\\,Pr_t\\,$. Assume the three inputs are independent, Gaussian, and uncertain only through the following nominal values and one-standard-deviation uncertainties:\n   - $\\,\\kappa = 0.41\\,$ with $\\,\\sigma_{\\kappa} = 0.02\\,$,\n   - $\\,B_t = 3.40\\,$ with $\\,\\sigma_{B_t} = 0.50\\,$,\n   - $\\,Pr_t = 0.85\\,$ with $\\,\\sigma_{Pr_t} = 0.05\\,$.\n   All other quantities are deterministic (no uncertainty).\n4) Quantify the fractional contributions of $\\,\\kappa\\,$, $\\,B_t\\,$, and $\\,Pr_t\\,$ to the output variances $\\,\\operatorname{Var}(q_w)\\,$ and $\\,\\operatorname{Var}(St)\\,$ using first-order Taylor expansion about the nominal point, i.e., for an output $\\,f\\,$,\n$$\n\\operatorname{Var}(f)\\,\\approx\\,\\left(\\frac{\\partial f}{\\partial \\kappa}\\right)^{\\!2}\\sigma_{\\kappa}^{2} \\;+\\; \\left(\\frac{\\partial f}{\\partial B_t}\\right)^{\\!2}\\sigma_{B_t}^{2} \\;+\\; \\left(\\frac{\\partial f}{\\partial Pr_t}\\right)^{\\!2}\\sigma_{Pr_t}^{2},\n$$\nand the fractional contribution from input $\\,x_i\\,$ equals its term divided by $\\,\\operatorname{Var}(f)\\,$. Treat $\\,y_P^+\\,$ as constant when differentiating with respect to $\\,\\kappa\\,$, $\\,B_t\\,$, and $\\,Pr_t\\,$.\n5) Use the following numerical data for evaluation:\n   - $\\,\\rho = 1.20\\,\\text{kg}\\,\\text{m}^{-3}\\,$, $\\,c_p = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}\\,$,\n   - $\\,\\nu = 1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}\\,$,\n   - $\\,y_P = 1.00 \\times 10^{-3}\\,\\text{m}\\,$,\n   - $\\,u_{\\tau} = 0.50\\,\\text{m}\\,\\text{s}^{-1}\\,$,\n   - $\\,U_P = 10.0\\,\\text{m}\\,\\text{s}^{-1}\\,$,\n   - $\\,T_w - T_P = 20.0\\,\\text{K}\\,$.\nReport the six variance contribution fractions in the order\n$$\n\\kappa \\text{ in } q_w,\\; B_t \\text{ in } q_w,\\; Pr_t \\text{ in } q_w,\\; \\kappa \\text{ in } St,\\; B_t \\text{ in } St,\\; Pr_t \\text{ in } St.\n$$\nExpress each as a decimal (no units) and round your answers to four significant figures. Present the six numbers as a single row matrix.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nStep 1: Extracted Givens\n- **Flow conditions**: Steady, fully turbulent, high Reynolds number flow over an isothermal, smooth flat wall. Negligible pressure-gradient effects.\n- **Region of interest**: Equilibrium overlap region.\n- **Heat transfer model**: Gradient-transport hypothesis with eddy diffusivity closure. Molecular heat conduction $\\,\\alpha\\,$ is negligible compared to turbulent heat transport $\\,\\alpha_t\\,$ in the overlap region.\n- **Constitutive relations**: $\\,q_w = -\\rho c_p(\\alpha + \\alpha_t)\\,\\partial T/\\partial y\\,$, $\\,\\nu_t = \\kappa y u_{\\tau}\\,$, $\\,\\alpha_t = \\nu_t/Pr_t\\,$.\n- **Fluid properties**: Density $\\,\\rho\\,$, specific heat $\\,c_p\\,$, kinematic viscosity $\\,\\nu\\,$.\n- **Known variables**: Friction velocity $\\,u_{\\tau}\\,$, mean velocity at node $P$ $\\,U_P\\,$, temperature difference $\\,T_w - T_P\\,$, distance of node $P$ from wall $\\,y_P\\,$.\n- **Definitions**:\n  - Dimensionless wall distance: $\\,y^+ \\equiv y u_{\\tau}/\\nu\\,$.\n  - Dimensionless temperature: $\\,\\theta^+ \\equiv (T_w - T)\\,\\rho c_p u_{\\tau}/q_w\\,$.\n  - Wall heat flux $\\,q_w\\,$ is directed from the wall into the fluid.\n  - Local Stanton number: $\\,St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)\\,$.\n- **Model parameters**: von Kármán constant $\\,\\kappa\\,$, thermal additive constant $\\,\\B_t\\,$, turbulent Prandtl number $\\,\\Pr_t\\,$.\n- **Sensitivity analysis inputs**:\n  - $\\,\\kappa = 0.41\\,$ with $\\,\\sigma_{\\kappa} = 0.02\\,$.\n  - $\\,B_t = 3.40\\,$ with $\\,\\sigma_{B_t} = 0.50\\,$.\n  - $\\,Pr_t = 0.85\\,$ with $\\,\\sigma_{Pr_t} = 0.05\\,$.\n  - These inputs are independent and Gaussian.\n- **Sensitivity analysis formula**: $\\,\\operatorname{Var}(f)\\,\\approx\\,\\sum_i \\left(\\frac{\\partial f}{\\partial x_i}\\right)^{\\!2}\\sigma_{x_i}^{2}\\,$.\n- **Sensitivity analysis constraint**: Treat $\\,y_P^+\\,$ as constant when differentiating with respect to $\\,\\kappa\\,$, $\\,B_t\\,$, and $\\,Pr_t\\,$.\n- **Numerical data for evaluation**:\n  - $\\,\\rho = 1.20\\,\\text{kg}\\,\\text{m}^{-3}\\,$, $\\,c_p = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}\\,$, $\\,\\nu = 1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}\\,$.\n  - $\\,y_P = 1.00 \\times 10^{-3}\\,\\text{m}\\,$, $\\,u_{\\tau} = 0.50\\,\\text{m}\\,\\text{s}^{-1}\\,$, $\\,U_P = 10.0\\,\\text{m}\\,\\text{s}^{-1}\\,$, $\\,T_w - T_P = 20.0\\,\\text{K}\\,$.\n\nStep 2: Validation Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in turbulent heat transfer and computational fluid dynamics (CFD) concerning wall functions. It is well-posed, with sufficient information and consistent definitions to derive a unique solution. The language is objective and precise. The physical parameters are realistic. The problem does not violate any fundamental principles and is fully formalizable.\n\nStep 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n**Task 1: Derivation of the thermal wall function and expression for $\\,q_w\\,$**\n\nThe starting point is the near-wall heat flux closure in the normal direction $\\,y\\,$:\n$$\nq_w = -\\rho c_p(\\alpha + \\alpha_t)\\frac{dT}{dy}\n$$\nIn the turbulent overlap region, molecular diffusivity is negligible compared to turbulent diffusivity, $\\,\\alpha \\ll \\alpha_t\\,$. Thus, the equation simplifies to:\n$$\nq_w \\approx -\\rho c_p \\alpha_t \\frac{dT}{dy}\n$$\nUsing the provided relations for the turbulent diffusivity, $\\,\\alpha_t = \\nu_t/Pr_t\\,$, and the eddy viscosity, $\\,\\nu_t = \\kappa y u_{\\tau}\\,$:\n$$\nq_w \\approx -\\rho c_p \\left( \\frac{\\kappa y u_{\\tau}}{Pr_t} \\right) \\frac{dT}{dy}\n$$\nWe rearrange to solve for the temperature gradient:\n$$\n\\frac{dT}{dy} \\approx -\\frac{q_w Pr_t}{\\rho c_p \\kappa y u_{\\tau}}\n$$\nNext, we use the definitions of dimensionless temperature $\\,\\theta^+\\,$ and wall distance $\\,y^+\\,$. Differentiating $\\,\\theta^+ = (T_w - T)\\rho c_p u_{\\tau}/q_w\\,$ with respect to $\\,y\\,$ gives:\n$$\n\\frac{d\\theta^+}{dy} = -\\frac{\\rho c_p u_{\\tau}}{q_w} \\frac{dT}{dy}\n$$\nSubstituting the expression for $\\,dT/dy\\,$:\n$$\n\\frac{d\\theta^+}{dy} = -\\frac{\\rho c_p u_{\\tau}}{q_w} \\left( -\\frac{q_w Pr_t}{\\rho c_p \\kappa y u_{\\tau}} \\right) = \\frac{Pr_t}{\\kappa y}\n$$\nTo express this in wall units, we use the chain rule with $\\,y^+ = y u_{\\tau}/\\nu\\,$:\n$$\n\\frac{d\\theta^+}{dy^+} = \\frac{d\\theta^+}{dy} \\frac{dy}{dy^+} = \\left( \\frac{Pr_t}{\\kappa y} \\right) \\left( \\frac{\\nu}{u_{\\tau}} \\right)\n$$\nSubstituting $\\,y = y^+ \\nu / u_{\\tau}\\,$:\n$$\n\\frac{d\\theta^+}{dy^+} = \\frac{Pr_t}{\\kappa (y^+ \\nu / u_{\\tau})} \\frac{\\nu}{u_{\\tau}} = \\frac{Pr_t}{\\kappa y^+}\n$$\nIntegrating this ordinary differential equation yields the logarithmic law for temperature:\n$$\n\\theta^+(y^+) = \\int \\frac{Pr_t}{\\kappa y^+} dy^+ = \\frac{Pr_t}{\\kappa} \\ln(y^+) + C\n$$\nThe integration constant $\\,C\\,$ is the thermal additive constant, denoted here as $\\,B_t\\,$. Thus, the wall function is:\n$$\n\\theta^+(y^+) = \\frac{Pr_t}{\\kappa} \\ln(y^+) + B_t\n$$\nThis matches the requested form $\\,\\theta^+(y^+) = \\text{(slope)}\\times \\ln y^+ + \\text{(constant)}\\,$, with slope $\\,Pr_t/\\kappa\\,$ and constant $\\,B_t\\,$.\nTo solve for $\\,q_w\\,$, we evaluate this relation at the near-wall node $\\,P\\,$ (where $\\,y=y_P\\,$ and $\\,T=T_P\\,$):\n$$\n\\theta^+_P = \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{q_w} = \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t\n$$\nSolving for $\\,q_w\\,$ explicitly:\n$$\nq_w = \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{\\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t}\n$$\n\n**Task 2: Expression for Stanton Number $\\,St\\,$**\n\nThe Stanton number is defined as $\\,St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)\\,$. Given $\\,T_w - T_P  0\\,$, it follows that heat flux $\\,q_w\\,$ from the wall to the fluid is positive. Thus, $\\,|q_w| = q_w\\,$ and $\\,|T_P - T_w| = T_w - T_P\\,$. The definition simplifies to:\n$$\nSt = \\frac{q_w}{\\rho c_p U_P (T_w - T_P)}\n$$\nSubstitute the expression for $\\,q_w\\,$ from Task 1:\n$$\nSt = \\frac{1}{\\rho c_p U_P (T_w - T_P)} \\left( \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{\\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t} \\right)\n$$\nCanceling common terms $\\,\\rho\\,$, $\\,c_p\\,$, and $\\,(T_w - T_P)\\,$ gives the expression for $\\,St\\,$:\n$$\nSt = \\frac{u_{\\tau}}{U_P \\left( \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t \\right)}\n$$\n\n**Tasks 3  4: Sensitivity Analysis and Variance Contributions**\n\nLet the denominator term be $\\,D(\\kappa, B_t, Pr_t) = \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t\\,$. Then we have:\n$$\nq_w = \\frac{C_1}{D} \\quad \\text{where} \\quad C_1 = (T_w - T_P)\\rho c_p u_{\\tau}\n$$\n$$\nSt = \\frac{C_2}{D} \\quad \\text{where} \\quad C_2 = \\frac{u_{\\tau}}{U_P}\n$$\nThe problem states to treat $\\,y_P^+\\,$ as constant for differentiation with respect to $\\,\\kappa\\,$, $\\,B_t\\,$, and $\\,Pr_t\\,$. Therefore, $\\,C_1\\,$ and $\\,C_2\\,$ are also treated as constants.\nFor a general function $\\,f = C/D\\,$, the partial derivative with respect to a parameter $\\,x_i\\,$ of $\\,D\\,$ is $\\,\\frac{\\partial f}{\\partial x_i} = -\\frac{C}{D^2} \\frac{\\partial D}{\\partial x_i} = -\\frac{f}{D} \\frac{\\partial D}{\\partial x_i}\\,$.\nThe variance term for input $\\,x_i\\,$ is $\\,\\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\left(-\\frac{f}{D}\\right)^2 \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2\\,$.\nThe total first-order variance is $\\,\\operatorname{Var}(f) \\approx \\sum_i \\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\frac{f^2}{D^2} \\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2\\,$.\nThe fractional contribution of input $\\,x_k\\,$ to the variance of $\\,f\\,$ is:\n$$\nF_{f, x_k} = \\frac{\\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_k}\\right)^2 \\sigma_{x_k}^2}{\\frac{f^2}{D^2} \\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2} = \\frac{\\left(\\frac{\\partial D}{\\partial x_k}\\right)^2 \\sigma_{x_k}^2}{\\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2}\n$$\nThis fraction is independent of the function $\\,f\\,$ ($\\,q_w\\,$ or $\\,St\\,$), as long as $\\,f\\,$ has the form $\\,C/D\\,$. Therefore, the fractional variance contributions for $\\,q_w\\,$ and $\\,St\\,$ are identical. We need only compute them once.\n\nLet $\\,L = \\ln(y^+_P)\\,$. The required partial derivatives of $\\,D = \\frac{Pr_t}{\\kappa}L + B_t\\,$ are:\n$$\n\\frac{\\partial D}{\\partial \\kappa} = -\\frac{Pr_t}{\\kappa^2}L\n$$\n$$\n\\frac{\\partial D}{\\partial B_t} = 1\n$$\n$$\n\\frac{\\partial D}{\\partial Pr_t} = \\frac{L}{\\kappa}\n$$\nThe three terms composing the total variance factor $\\,\\sum_i (\\partial D/\\partial x_i)^2 \\sigma_{x_i}^2\\,$ are:\n- Term for $\\,\\kappa\\,$: $\\,V_\\kappa = \\left(-\\frac{Pr_t L}{\\kappa^2}\\right)^2 \\sigma_\\kappa^2 = \\frac{Pr_t^2 L^2}{\\kappa^4} \\sigma_\\kappa^2\\,$\n- Term for $\\,B_t\\,$: $\\,V_{B_t} = (1)^2 \\sigma_{B_t}^2 = \\sigma_{B_t}^2\\,$\n- Term for $\\,Pr_t\\,$: $\\,V_{Pr_t} = \\left(\\frac{L}{\\kappa}\\right)^2 \\sigma_{Pr_t}^2 = \\frac{L^2}{\\kappa^2} \\sigma_{Pr_t}^2\\,$\n\nThe total variance factor is $\\,V_{tot} = V_\\kappa + V_{B_t} + V_{Pr_t}\\,$. The fractional contributions are $\\,F_\\kappa = V_\\kappa/V_{tot}\\,$, $\\,F_{B_t} = V_{B_t}/V_{tot}\\,$, and $\\,F_{Pr_t} = V_{Pr_t}/V_{tot}\\,$.\n\n**Task 5: Numerical Evaluation**\n\nFirst, calculate the dimensionless wall distance $\\,y^+_P\\,$:\n$$\ny^+_P = \\frac{y_P u_{\\tau}}{\\nu} = \\frac{(1.00 \\times 10^{-3}\\,\\text{m}) (0.50\\,\\text{m}\\,\\text{s}^{-1})}{1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}} = \\frac{0.5 \\times 10^{-3}}{1.5 \\times 10^{-5}} = \\frac{1}{3} \\times 10^2 = \\frac{100}{3}\n$$\nNow, calculate $\\,L = \\ln(y^+_P)\\,$:\n$$\nL = \\ln\\left(\\frac{100}{3}\\right) \\approx 3.5065579\n$$\nWe use the nominal values for the parameters: $\\,\\kappa = 0.41\\,$, $\\,B_t = 3.40\\,$, $\\,Pr_t = 0.85\\,$. The standard deviations are $\\,\\sigma_\\kappa=0.02\\,$, $\\,\\sigma_{B_t}=0.50\\,$, $\\,\\sigma_{Pr_t}=0.05\\,$.\n\nNow, calculate the variance components:\n$$\nV_\\kappa = \\frac{0.85^2 \\times (\\ln(100/3))^2}{0.41^4} \\times 0.02^2\n= \\frac{0.7225 \\times 12.295946}{0.02825761} \\times 0.0004 \\approx 314.390 \\times 0.0004 \\approx 0.125756\n$$\n$$\nV_{B_t} = 0.50^2 = 0.25\n$$\n$$\nV_{Pr_t} = \\frac{(\\ln(100/3))^2}{0.41^2} \\times 0.05^2\n= \\frac{12.295946}{0.1681} \\times 0.0025 \\approx 73.1466 \\times 0.0025 \\approx 0.182867\n$$\nThe total variance component is:\n$$\nV_{tot} = V_\\kappa + V_{B_t} + V_{Pr_t} \\approx 0.125756 + 0.25 + 0.182867 = 0.558623\n$$\nThe fractional contributions are:\n$$\nF_\\kappa = \\frac{V_\\kappa}{V_{tot}} \\approx \\frac{0.125756}{0.558623} \\approx 0.22514\n$$\n$$\nF_{B_t} = \\frac{V_{B_t}}{V_{tot}} \\approx \\frac{0.25}{0.558623} \\approx 0.44755\n$$\n$$\nF_{Pr_t} = \\frac{V_{Pr_t}}{V_{tot}} \\approx \\frac{0.182867}{0.558623} \\approx 0.32731\n$$\nRounding to four significant figures:\n- Contribution from $\\,\\kappa\\,$: $\\,0.2251\\,$\n- Contribution from $\\,B_t\\,$: $\\,0.4476\\,$\n- Contribution from $\\,Pr_t\\,$: $\\,0.3273\\,$\nThe sum is $\\,0.2251 + 0.4476 + 0.3273 = 1.0000\\,$.\n\nAs established, the fractional contributions to the variance of $\\,q_w\\,$ are identical to those for $\\,St\\,$. The six required values are these three numbers, repeated.\nFinal values:\n- $\\,F_{q_w,\\kappa} = F_{St,\\kappa} \\approx 0.2251\\,$\n- $\\,F_{q_w,B_t} = F_{St,B_t} \\approx 0.4476\\,$\n- $\\,F_{q_w,Pr_t} = F_{St,Pr_t} \\approx 0.3273\\,$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2251  0.4476  0.3273  0.2251  0.4476  0.3273\n\\end{pmatrix}\n}\n$$", "id": "2537406"}]}