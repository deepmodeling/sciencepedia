{"hands_on_practices": [{"introduction": "Before embarking on a complex Computational Fluid Dynamics (CFD) simulation, a crucial first step is to establish the appropriate mathematical model. This exercise guides you through the process of using dimensional analysis to determine which physical phenomena are dominant and must be included in your simulation [@problem_id:2497439]. By nondimensionalizing the energy equation, you will identify key dimensionless parameters and use them to perform an order-of-magnitude analysis, helping you decide whether the effects of viscous dissipation are significant enough to warrant their inclusion in a model for microchannel flow.", "problem": "A heat exchanger designer considers simulating a steady, incompressible, constant-property, Newtonian liquid flowing through a rectangular microchannel in a Computational Fluid Dynamics (CFD) model. The liquid is glycerol at a bulk temperature near $40\\,^{\\circ}\\mathrm{C}$ with the following properties (assumed constant): density $\\rho = 1260\\,\\mathrm{kg/m^3}$, dynamic viscosity $\\mu = 0.200\\,\\mathrm{Pa\\cdot s}$, thermal conductivity $k = 0.285\\,\\mathrm{W/(m\\cdot K)}$, and specific heat at constant pressure $c_p = 2400\\,\\mathrm{J/(kg\\cdot K)}$. The flow has bulk speed $U = 2.00\\,\\mathrm{m/s}$ and characteristic length $L = 4.00\\,\\mathrm{mm}$ (use the hydraulic diameter as the characteristic length). The representative temperature difference between the wall and the incoming fluid is $\\Delta T = 5.00\\,\\mathrm{K}$.\n\nStarting from the conservation of mass, momentum, and energy, and using nondimensionalization with the characteristic scales $L$ for length, $U$ for velocity, and $\\Delta T$ for temperature, identify the relevant dimensionless groups and compute their values: the Reynolds number $Re$, the Prandtl number $Pr$, the Péclet number $Pe$, and the Eckert number $Ec$ for this case. Then, using order-of-magnitude reasoning based on the nondimensional energy equation, argue whether viscous dissipation must be included in the energy equation for a CFD simulation of this flow.\n\nReport your final decision as a single number: write $1$ if viscous dissipation must be included and $0$ if it may be neglected. Do not report any intermediate quantities as your final answer.", "solution": "The problem requires an assessment of the necessity of including the viscous dissipation term in the energy equation for a specified flow scenario, based on an order-of-magnitude analysis of the nondimensional governing equations. This is a critical step in the formulation of any computational fluid dynamics (CFD) model for heat transfer, as it determines which physical phenomena must be resolved.\n\nThe starting point is the conservation of energy for a steady, incompressible, Newtonian fluid with constant properties. The thermal energy equation is:\n$$ \\rho c_p (\\mathbf{u} \\cdot \\nabla) T = k \\nabla^2 T + \\Phi_v $$\nHere, $\\rho$ is the density, $c_p$ is the specific heat at constant pressure, $\\mathbf{u}$ is the velocity vector, $T$ is the temperature, $k$ is the thermal conductivity, and $\\Phi_v$ is the viscous dissipation function, which represents the rate of irreversible work done by viscous stresses, converting kinetic energy into internal energy. For a Newtonian fluid, $\\Phi_v$ is given by a quadratic form of the velocity gradients.\n\nTo perform an order-of-magnitude analysis, we nondimensionalize the equation. We introduce the following dimensionless variables, denoted by an asterisk ($*$), based on the characteristic scales provided: length scale $L$, velocity scale $U$, and temperature scale $\\Delta T$.\n$$ x_i^* = \\frac{x_i}{L}, \\quad u_i^* = \\frac{u_i}{U}, \\quad T^* = \\frac{T - T_{ref}}{\\Delta T} $$\nwhere $T_{ref}$ is a reference temperature, such as the inlet temperature. The differential operators transform as $\\nabla = \\frac{1}{L}\\nabla^*$ and $\\nabla^2 = \\frac{1}{L^2}\\nabla^{*2}$. The viscous dissipation function scales as $\\Phi_v \\sim \\mu (U/L)^2$. Substituting these into the energy equation yields:\n$$ \\rho c_p \\left( (U \\mathbf{u}^*) \\cdot \\frac{1}{L}\\nabla^* \\right) (\\Delta T \\cdot T^*) = k \\frac{\\Delta T}{L^2} \\nabla^{*2} T^* + \\mathcal{O}\\left(\\frac{\\mu U^2}{L^2}\\right) $$\nRearranging the terms:\n$$ \\left( \\frac{\\rho c_p U \\Delta T}{L} \\right) (\\mathbf{u}^* \\cdot \\nabla^*) T^* = \\left( \\frac{k \\Delta T}{L^2} \\right) \\nabla^{*2} T^* + \\left( \\frac{\\mu U^2}{L^2} \\right) \\Phi_v^* $$\nwhere $\\Phi_v^*$ is the dimensionless viscous dissipation function of order one.\n\nTo compare the relative magnitudes of the terms, we normalize the equation. A physically insightful normalization is achieved by dividing by the coefficient of the conduction term, $\\frac{k \\Delta T}{L^2}$:\n$$ \\left( \\frac{\\rho c_p U L}{k} \\right) (\\mathbf{u}^* \\cdot \\nabla^*) T^* = \\nabla^{*2} T^* + \\left( \\frac{\\mu U^2}{k \\Delta T} \\right) \\Phi_v^* $$\nFrom this equation, we identify the relevant dimensionless groups. The coefficient of the advection term is the Péclet number, $Pe$. The coefficient of the viscous dissipation term is the Brinkman number, $Br$.\n$$ Pe = \\frac{\\rho c_p U L}{k} = \\frac{\\rho U L}{\\mu} \\cdot \\frac{\\mu c_p}{k} = Re \\cdot Pr $$\n$$ Br = \\frac{\\mu U^2}{k \\Delta T} = \\frac{U^2}{c_p \\Delta T} \\cdot \\frac{\\mu c_p}{k} = Ec \\cdot Pr $$\nThe nondimensional energy equation is thus:\n$$ Pe \\, (\\mathbf{u}^* \\cdot \\nabla^*) T^* = \\nabla^{*2} T^* + Br \\, \\Phi_v^* $$\nViscous dissipation is negligible only if the term $Br \\, \\Phi_v^*$ is significantly smaller than the other terms, particularly the conduction term $\\nabla^{*2} T^*$, which is always present and defines the thermal boundary condition response. Therefore, the criterion for neglecting viscous dissipation is $Br \\ll 1$.\n\nWe now compute the dimensionless numbers using the given data:\n- Density: $\\rho = 1260\\,\\mathrm{kg/m^3}$\n- Dynamic viscosity: $\\mu = 0.200\\,\\mathrm{Pa\\cdot s}$\n- Thermal conductivity: $k = 0.285\\,\\mathrm{W/(m\\cdot K)}$\n- Specific heat: $c_p = 2400\\,\\mathrm{J/(kg\\cdot K)}$\n- Bulk speed: $U = 2.00\\,\\mathrm{m/s}$\n- Characteristic length: $L = 4.00\\,\\mathrm{mm} = 4.00 \\times 10^{-3}\\,\\mathrm{m}$\n- Temperature difference: $\\Delta T = 5.00\\,\\mathrm{K}$\n\nThe Reynolds number, $Re$, is:\n$$ Re = \\frac{\\rho U L}{\\mu} = \\frac{(1260\\,\\mathrm{kg/m^3}) (2.00\\,\\mathrm{m/s}) (4.00 \\times 10^{-3}\\,\\mathrm{m})}{0.200\\,\\mathrm{Pa\\cdot s}} = 50.4 $$\nThe Prandtl number, $Pr$, is:\n$$ Pr = \\frac{\\mu c_p}{k} = \\frac{(0.200\\,\\mathrm{Pa\\cdot s}) (2400\\,\\mathrm{J/(kg\\cdot K)})}{0.285\\,\\mathrm{W/(m\\cdot K)}} = \\frac{480}{0.285} \\approx 1684.2 $$\nThe Eckert number, $Ec$, is:\n$$ Ec = \\frac{U^2}{c_p \\Delta T} = \\frac{(2.00\\,\\mathrm{m/s})^2}{(2400\\,\\mathrm{J/(kg\\cdot K)}) (5.00\\,\\mathrm{K})} = \\frac{4}{12000} = \\frac{1}{3000} \\approx 3.33 \\times 10^{-4} $$\nThe Péclet number, $Pe$, is:\n$$ Pe = Re \\cdot Pr = 50.4 \\times \\frac{480}{0.285} \\approx 84884 $$\nThe high Péclet number indicates that heat transfer is dominated by advection in the bulk flow. However, the balance of terms near solid surfaces, which determines wall heat flux, requires examining the Brinkman number.\n\nThe Brinkman number, $Br$, is:\n$$ Br = Ec \\cdot Pr = \\left(\\frac{1}{3000}\\right) \\left(\\frac{480}{0.285}\\right) = \\frac{480}{855} = \\frac{32}{57} \\approx 0.5614 $$\nThe value of the Brinkman number is $Br \\approx 0.56$. This value is not much smaller than $1$. It signifies that the heat generated by viscous forces is of the same order of magnitude as the heat transported by molecular conduction (approximately $56\\%$). In a CFD simulation aimed at accurately predicting the temperature field and heat transfer rates, particularly in high-shear regions near walls where velocity gradients are large, a source term of this relative magnitude cannot be neglected without introducing significant error.\n\nTherefore, for a physically sound simulation of this microchannel flow, the viscous dissipation term must be included in the energy equation. The final decision is to include the term, which corresponds to the numerical value $1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "2497439"}, {"introduction": "Once the governing equations are set, the next step is to translate them from the continuous language of calculus into a system of algebraic equations that a computer can solve—a process known as discretization. This practice delves into this core CFD task by having you solve the classic one-dimensional convection-diffusion problem using two different finite-difference schemes [@problem_id:2497371]. By comparing your numerical results against an exact analytical solution, you will gain firsthand insight into the critical trade-off between the accuracy of central-differencing and the stability of upwinding, and discover the pivotal role of the cell Péclet number, $Pe_{\\Delta x}$, in predicting numerical behavior.", "problem": "Consider a one-dimensional, steady convection–diffusion problem for a scalar temperature field $T(x)$ on the domain $x \\in [0,L]$ with constant properties and Dirichlet boundary conditions. The governing differential equation for steady, one-dimensional heat convection and conduction is: $$\\frac{d}{dx}\\left(\\Gamma \\frac{dT}{dx}\\right) - \\rho u \\frac{dT}{dx} = 0,$$ where $\\Gamma$ is the diffusion coefficient, $\\rho$ is the density, and $u$ is the uniform flow speed in the positive $x$ direction. The Dirichlet boundary conditions are $T(0)=T_L$ and $T(L)=T_R$. Assume $\\Gamma > 0$, $\\rho \\ge 0$, and $u \\ge 0$. Starting from this fundamental equation, derive a consistent finite-difference discretization for the interior grid points using a uniform mesh of $N$ intervals (so that $\\Delta x = L/N$) and the following two approximations for the convective derivative term: (a) first-order upwind (for $u \\ge 0$) and (b) second-order central differencing. Use central differencing for the diffusive term in both cases. Treat the boundaries using the Dirichlet data without introducing additional unknowns. Construct and solve the resulting linear systems for the interior unknowns for each scheme.\n\nYour program must also derive and implement the exact continuous solution of the differential equation by solving the associated ordinary differential equation analytically, apply the boundary conditions, and evaluate it at the grid nodes $x_j = j \\Delta x$ for $j = 0,1,\\dots,N$.\n\nDefine the cell Peclet number as $$\\mathrm{Pe}_{\\Delta x} = \\frac{\\rho u \\Delta x}{\\Gamma}.$$ For each test case below, compute and report the following quantities:\n- The value of $\\mathrm{Pe}_{\\Delta x}$ as a nonnegative real number.\n- The maximum-norm error (in absolute value) between the discrete nodal solution of the central-differencing scheme and the exact solution, evaluated at all grid nodes, expressed as a real number.\n- The maximum-norm error (in absolute value) between the discrete nodal solution of the first-order upwind scheme and the exact solution, evaluated at all grid nodes, expressed as a real number.\n- A boolean indicating whether the central-differencing discrete solution is bounded between $\\min(T_L,T_R)$ and $\\max(T_L,T_R)$ at all grid nodes including the boundaries.\n\nThe test suite consists of the following parameter sets, designed to probe different regimes of $\\mathrm{Pe}_{\\Delta x}$ (with $L$, $T_L$, and $T_R$ held fixed):\n- Case A (diffusion-dominated, general case): $L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=0.2$, $\\Gamma=1$, $N=50$.\n- Case B (near the central-differencing monotonicity limit): $L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=4$, $\\Gamma=0.2$, $N=10$.\n- Case C (convection-dominated, potential oscillations for central differencing): $L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=10$, $\\Gamma=0.1$, $N=10$.\n- Case D (pure diffusion edge case): $L=1$, $T_L=0$, $T_R=1$, $\\rho=1$, $u=0$, $\\Gamma=1$, $N=20$.\n\nAll quantities are dimensionless due to the normalization implied by the governing equation; therefore no physical units are required or to be reported. Angles are not involved, and no percentages are to be used.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, one sublist per test case in the same order as listed above. Each sublist must be of the form $[\\mathrm{Pe}_{\\Delta x}, e_\\infty^{\\mathrm{central}}, e_\\infty^{\\mathrm{upwind}}, \\text{bounded}_{\\mathrm{central}}]$, where $e_\\infty$ denotes the maximum-norm error and $\\text{bounded}_{\\mathrm{central}}$ is a boolean. For example, the output format must look like $[[a,b,c,\\mathrm{True}],[d,e,f,\\mathrm{False}],\\dots]$ with the appropriate numeric values substituted, printed on a single line.", "solution": "The problem presented is a standard, well-posed exercise in the field of computational fluid dynamics, specifically concerning the numerical solution of the one-dimensional steady-state convection-diffusion equation. It is scientifically sound and its parameters are clearly defined. Therefore, a solution is possible and will be constructed.\n\nThe task is to analyze and compare two finite-difference schemes against the exact analytical solution for the governing equation:\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{dT}{dx}\\right) - \\rho u \\frac{dT}{dx} = 0\n$$\nGiven that the thermal diffusivity $\\Gamma$, density $\\rho$, and velocity $u$ are constant, this simplifies to a second-order linear ordinary differential equation (ODE) with constant coefficients:\n$$\n\\Gamma \\frac{d^2T}{dx^2} - \\rho u \\frac{dT}{dx} = 0\n$$\nThe domain is $x \\in [0, L]$ with Dirichlet boundary conditions $T(0) = T_L$ and $T(L) = T_R$.\n\nFirst, we derive the exact analytical solution. The characteristic equation corresponding to the ODE is:\n$$\n\\Gamma r^2 - \\rho u r = 0 \\implies r(\\Gamma r - \\rho u) = 0\n$$\nThe roots are $r_1 = 0$ and $r_2 = \\frac{\\rho u}{\\Gamma}$.\n\nCase 1: $\\rho u \\neq 0$.\nThe general solution is of the form $T(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x}$, which is:\n$$\nT(x) = C_1 + C_2 e^{(\\rho u / \\Gamma) x}\n$$\nThe constants $C_1$ and $C_2$ are determined by applying the boundary conditions:\n$T(0) = T_L \\implies C_1 + C_2 = T_L$\n$T(L) = T_R \\implies C_1 + C_2 e^{(\\rho u L / \\Gamma)} = T_R$\n\nSolving this system of two linear equations yields:\n$C_2 = \\frac{T_R - T_L}{e^{(\\rho u L / \\Gamma)} - 1}$\n$C_1 = T_L - C_2 = T_L - \\frac{T_R - T_L}{e^{(\\rho u L / \\Gamma)} - 1}$\n\nSubstituting these back into the general solution gives the exact solution:\n$$\nT(x) = T_L + (T_R - T_L) \\frac{e^{(\\rho u x / \\Gamma)} - 1}{e^{(\\rho u L / \\Gamma)} - 1}\n$$\n\nCase 2: $\\rho u = 0$.\nThe governing equation simplifies to $\\Gamma \\frac{d^2T}{dx^2} = 0$, which implies $\\frac{d^2T}{dx^2} = 0$ since $\\Gamma > 0$. The general solution is a linear function:\n$$\nT(x) = C_1 x + C_2\n$$\nApplying the boundary conditions:\n$T(0) = T_L \\implies C_2 = T_L$\n$T(L) = T_R \\implies C_1 L + C_2 = T_R \\implies C_1 = \\frac{T_R - T_L}{L}$\n\nThe exact solution for the pure diffusion case is:\n$$\nT(x) = T_L + (T_R - T_L) \\frac{x}{L}\n$$\nThis result is also the limit of the Case 1 solution as $\\rho u \\to 0$, which can be verified using L'Hôpital's rule.\n\nNext, we formulate the finite-difference schemes. The domain is discretized into $N$ uniform intervals of size $\\Delta x = L/N$. The grid points are $x_j = j \\Delta x$ for $j = 0, 1, \\dots, N$. The temperatures at these points are denoted $T_j = T(x_j)$. The values $T_0 = T_L$ and $T_N = T_R$ are known. We seek the solution for the $N-1$ interior points $T_1, \\dots, T_{N-1}$.\n\nAt any interior node $j \\in \\{1, \\dots, N-1\\}$, we discretize the governing equation. The diffusive term is approximated using a second-order central difference scheme:\n$$\n\\Gamma \\frac{d^2T}{dx^2}\\bigg|_j \\approx \\Gamma \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^2}\n$$\nThe convective term, $-\\rho u \\frac{dT}{dx}$, is approximated in two ways.\n\n(a) First-Order Upwind (FOU) Scheme:\nFor $u \\ge 0$, the flow is in the positive $x$-direction, so \"upwind\" information comes from node $j-1$.\n$$\n-\\rho u \\frac{dT}{dx}\\bigg|_j \\approx -\\rho u \\frac{T_j - T_{j-1}}{\\Delta x}\n$$\nCombining terms, the discretized equation is:\n$$\n\\Gamma \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^2} - \\rho u \\frac{T_j - T_{j-1}}{\\Delta x} = 0\n$$\nMultiplying by $(\\Delta x)^2 / \\Gamma$ and introducing the cell Peclet number, $\\mathrm{Pe}_{\\Delta x} = \\frac{\\rho u \\Delta x}{\\Gamma}$:\n$$\n(T_{j+1} - 2T_j + T_{j-1}) - \\mathrm{Pe}_{\\Delta x} (T_j - T_{j-1}) = 0\n$$\nGrouping by nodal temperatures, we obtain the algebraic equation for node $j$:\n$$\n(1 + \\mathrm{Pe}_{\\Delta x}) T_{j-1} - (2 + \\mathrm{Pe}_{\\Delta x}) T_j + T_{j+1} = 0\n$$\n\n(b) Second-Order Central-Differencing (CD) Scheme:\nThe convective term is approximated using a second-order central difference:\n$$\n-\\rho u \\frac{dT}{dx}\\bigg|_j \\approx -\\rho u \\frac{T_{j+1} - T_{j-1}}{2 \\Delta x}\n$$\nThe discretized equation becomes:\n$$\n\\Gamma \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^2} - \\rho u \\frac{T_{j+1} - T_{j-1}}{2 \\Delta x} = 0\n$$\nMultiplying by $(\\Delta x)^2 / \\Gamma$:\n$$\n(T_{j+1} - 2T_j + T_{j-1}) - \\frac{\\mathrm{Pe}_{\\Delta x}}{2} (T_{j+1} - T_{j-1}) = 0\n$$\nGrouping by nodal temperatures:\n$$\n\\left(1 + \\frac{\\mathrm{Pe}_{\\Delta x}}{2}\\right) T_{j-1} - 2 T_j + \\left(1 - \\frac{\\mathrm{Pe}_{\\Delta x}}{2}\\right) T_{j+1} = 0\n$$\nThis scheme is known to produce non-physical oscillations if $|\\mathrm{Pe}_{\\Delta x}| > 2$, as the coefficient of $T_{j+1}$ becomes negative, violating the conditions for a discrete maximum principle.\n\nFor both schemes, we assemble a system of $N-1$ linear equations for the $N-1$ unknown interior temperatures. This system is tridiagonal and can be written as $A \\mathbf{T} = \\mathbf{b}$, where $\\mathbf{T} = [T_1, T_2, \\dots, T_{N-1}]^T$.\n\nFor the FOU scheme, the coefficients for the equation at node $j$ are:\n- Lower diagonal ($T_{j-1}$): $l = 1 + \\mathrm{Pe}_{\\Delta x}$\n- Main diagonal ($T_j$): $d = -(2 + \\mathrm{Pe}_{\\Delta x})$\n- Upper diagonal ($T_{j+1}$): $u = 1$\n\nFor the CD scheme, the coefficients are:\n- Lower diagonal ($T_{j-1}$): $l = 1 + \\frac{\\mathrm{Pe}_{\\Delta x}}{2}$\n- Main diagonal ($T_j$): $d = -2$\n- Upper diagonal ($T_{j+1}$): $u = 1 - \\frac{\\mathrm{Pe}_{\\Delta x}}{2}$\n\nThe right-hand side vector $\\mathbf{b}$ is formed by moving the known boundary terms, $T_0=T_L$ and $T_N=T_R$, to the right side of the equations for nodes $j=1$ and $j=N-1$.\nFor $j=1$: $d T_1 + u T_2 = -l T_0 = -l T_L$\nFor $j=N-1$: $l T_{N-2} + d T_{N-1} = -u T_N = -u T_R$\n\nThe program will implement this logic, construct and solve the tridiagonal systems for both schemes, evaluate the exact solution at grid nodes, and compute the required error norms and boundedness property for each test case.\nThe maximum-norm error is defined as $e_{\\infty} = \\max_{j=0, \\dots, N} |T_j^{\\text{numerical}} - T_j^{\\text{exact}}|$.\nThe boundedness check for the central-differencing scheme verifies if $T_j$ remains within the range of the boundary values $[\\min(T_L, T_R), \\max(T_L, T_R)]$ for all $j$.\n\nThe implementation will utilize `scipy.linalg.solve_banded` for efficient solution of the tridiagonal systems.", "answer": "[[0.004000000000000001, 1.6653345369377348e-07, 0.0003998720814421161, True],[2.0, 0.0016736413210300405, 0.04561026049216799, True],[10.0, 0.36787944117144233, 0.009090909090909094, False],[0.0, 4.440892098500626e-16, 4.440892098500626e-16, True]]", "id": "2497371"}, {"introduction": "Writing a CFD solver is a complex task, and a fundamental question always arises: \"Is my code working correctly?\" This exercise introduces you to the Method of Manufactured Solutions (MMS), a powerful and standard technique for code verification that provides a definitive answer. You will learn to work backward: starting with a chosen \"manufactured\" analytical solution, you will derive the corresponding source term that must be added to the governing PDE to make your chosen function an exact solution [@problem_id:2497372]. This creates a benchmark problem with a known solution, enabling rigorous testing of a code's implementation and its order of accuracy.", "problem": "A two-dimensional, steady, incompressible flow of a Newtonian fluid with constant properties occupies a square domain of side length $L$, with Cartesian coordinates $(x,y)\\in[0,L]\\times[0,L]$. The density is $\\rho$, the specific heat at constant pressure is $c_p$, and the thermal conductivity is $k$. Viscous dissipation and pressure work are negligible. The velocity field is prescribed and divergence-free. In the context of introduction to Computational Fluid Dynamics (CFD), you are asked to use the Method of Manufactured Solutions for the energy equation.\n\nFirst, briefly articulate the logical steps of the Method of Manufactured Solutions (MMS) as applied to the energy equation for this setting by starting from the conservation of energy principle.\n\nThen, consider the following manufactured temperature field and divergence-free velocity field:\n- Manufactured temperature: $T(x,y)=T_0+\\Theta \\sin\\!\\big(\\tfrac{\\pi x}{L}\\big)\\cos\\!\\big(\\tfrac{\\pi y}{L}\\big)$, where $T_0$ and $\\Theta$ are constants.\n- Velocity field: $u(x,y)=U_0 \\cos\\!\\big(\\tfrac{\\pi y}{L}\\big)$ and $v(x,y)=U_0 \\sin\\!\\big(\\tfrac{\\pi x}{L}\\big)$, where $U_0$ is a constant.\n\nStarting from conservation of energy for a steady, incompressible, constant-property flow (with the stated modeling assumptions), derive the strong-form temperature equation and construct the manufactured volumetric heat source term $S(x,y)$ such that the given $T(x,y)$ is an exact solution of that equation throughout the domain. Express your final manufactured source term $S(x,y)$ as a single, closed-form analytic expression in terms of $x$, $y$, $L$, $\\rho$, $c_p$, $k$, $U_0$, $T_0$, and $\\Theta$. Do not approximate or round; leave the answer in exact form. The trigonometric arguments must be interpreted in radians. Express the final $S(x,y)$ in International System of Units (SI) as $\\text{W}\\,\\text{m}^{-3}$.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Domain**: Two-dimensional square domain, $(x,y) \\in [0,L] \\times [0,L]$.\n- **Fluid**: Newtonian, steady, incompressible flow with constant properties.\n- **Properties**: Density $\\rho$, specific heat at constant pressure $c_p$, thermal conductivity $k$.\n- **Assumptions**: Viscous dissipation and pressure work are negligible.\n- **Velocity field**: Prescribed and divergence-free, with components $u(x,y)=U_0 \\cos(\\frac{\\pi y}{L})$ and $v(x,y)=U_0 \\sin(\\frac{\\pi x}{L})$. $U_0$ is a constant.\n- **Manufactured temperature field**: $T(x,y)=T_0+\\Theta \\sin(\\frac{\\pi x}{L})\\cos(\\frac{\\pi y}{L})$, where $T_0$ and $\\Theta$ are constants.\n- **Task**: Articulate the Method of Manufactured Solutions (MMS), derive the strong-form temperature equation, and construct the manufactured volumetric heat source term $S(x,y)$ that makes the given $T(x,y)$ an exact solution.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being based on the fundamental principle of conservation of energy and a standard code verification technique (MMS). The language is objective and precise. The problem is self-contained. A necessary condition for consistency is that the provided velocity field must be divergence-free, as stated. We verify this:\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\n$$\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ U_0 \\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = 0\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ U_0 \\sin\\left(\\frac{\\pi x}{L}\\right) \\right] = 0\n$$\nTherefore, $\\nabla \\cdot \\mathbf{v} = 0 + 0 = 0$. The velocity field is indeed divergence-free, confirming the internal consistency of the problem statement. The problem asks to construct a source term for a given solution, which is a well-posed procedure. No scientific, logical, or structural flaws are detected.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\nFirst, the logical steps of the Method of Manufactured Solutions (MMS) as applied to the energy equation are as follows:\n$1$. Select the governing partial differential equation (PDE), which is the conservation of energy equation for this problem.\n$2$. Postulate or \"manufacture\" a smooth, analytical function for the solution variable, in this case, the temperature field $T(x,y)$.\n$3$. Substitute this manufactured solution and its derivatives into the governing PDE. Since this function is not an exact solution to the original homogeneous equation, its insertion will produce a non-zero residual.\n$4$. Define a source term, $S(x,y)$, to be equal to this residual. This redefines the original PDE into a new non-homogeneous equation.\n$5$. By construction, the manufactured function $T(x,y)$ is now an exact analytical solution to this new non-homogeneous PDE. This new problem, with a known analytical solution, can be used to rigorously verify the accuracy and implementation of a numerical code.\n\nNext, we derive the strong-form temperature equation. The general form of the conservation of energy equation for an incompressible fluid with constant properties is:\n$$\n\\rho c_p \\left( \\frac{\\partial T}{\\partial t} + \\mathbf{v} \\cdot \\nabla T \\right) = \\nabla \\cdot (k \\nabla T) + S_{visc} + \\beta T \\frac{Dp}{Dt} + \\dot{q}\n$$\nApplying the problem's stated assumptions:\n- Steady state: $\\frac{\\partial T}{\\partial t} = 0$.\n- Constant properties: $\\rho$, $c_p$, and $k$ are constants. The diffusion term becomes $k \\nabla^2 T$.\n- Negligible viscous dissipation ($S_{visc}$) and pressure work ($\\beta T \\frac{Dp}{Dt}$): These terms are zero.\n- The term $\\dot{q}$ is the volumetric heat source, which we denote as $S(x,y)$.\n\nThe resulting strong-form temperature equation is:\n$$\n\\rho c_p (\\mathbf{v} \\cdot \\nabla T) = k \\nabla^2 T + S(x,y)\n$$\nIn two-dimensional Cartesian coordinates, this expands to:\n$$\n\\rho c_p \\left( u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} \\right) = k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + S(x,y)\n$$\nTo construct the manufactured source term, we rearrange this equation to solve for $S(x,y)$:\n$$\nS(x,y) = \\rho c_p \\left( u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} \\right) - k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right)\n$$\nNow, we compute the necessary derivatives of the manufactured temperature field $T(x,y)=T_0+\\Theta \\sin(\\frac{\\pi x}{L})\\cos(\\frac{\\pi y}{L})$.\nThe first-order partial derivatives are:\n$$\n\\frac{\\partial T}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ T_0+\\Theta \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = \\Theta \\left(\\frac{\\pi}{L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n$$\n\\frac{\\partial T}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ T_0+\\Theta \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = -\\Theta \\left(\\frac{\\pi}{L}\\right) \\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right)\n$$\nThe second-order partial derivatives are:\n$$\n\\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ \\Theta \\left(\\frac{\\pi}{L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = -\\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\n$$\n\\frac{\\partial^2 T}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left[ -\\Theta \\left(\\frac{\\pi}{L}\\right) \\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right] = -\\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\nWe now assemble the advection term, $\\rho c_p (u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y})$, using the velocity components $u(x,y)=U_0 \\cos(\\frac{\\pi y}{L})$ and $v(x,y)=U_0 \\sin(\\frac{\\pi x}{L})$.\n$$\nu \\frac{\\partial T}{\\partial x} = \\left( U_0 \\cos\\left(\\frac{\\pi y}{L}\\right) \\right) \\left( \\Theta \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right) = \\frac{\\pi U_0 \\Theta}{L} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi y}{L}\\right)\n$$\n$$\nv \\frac{\\partial T}{\\partial y} = \\left( U_0 \\sin\\left(\\frac{\\pi x}{L}\\right) \\right) \\left( -\\Theta \\frac{\\pi}{L} \\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right) = -\\frac{\\pi U_0 \\Theta}{L} \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right)\n$$\nThe full advection term is:\n$$\n\\rho c_p \\left( u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} \\right) = \\frac{\\pi \\rho c_p U_0 \\Theta}{L} \\left[ \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi y}{L}\\right) - \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right]\n$$\nNext, we assemble the diffusion term, $-k (\\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2})$.\n$$\n\\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = -\\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) - \\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) = -2 \\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\nThe diffusion contribution to be subtracted is:\n$$\n-k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) = -k \\left[ -2 \\Theta \\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right) \\right] = \\frac{2 \\pi^2 k \\Theta}{L^2} \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\nFinally, we combine the advection and diffusion terms to obtain the manufactured source term $S(x,y)$:\n$$\nS(x,y) = \\frac{\\pi \\rho c_p U_0 \\Theta}{L} \\left[ \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^2\\left(\\frac{\\pi y}{L}\\right) - \\sin^2\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right] + \\frac{2 \\pi^2 k \\Theta}{L^2} \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)\n$$\nThis expression is the required closed-form analytic function for the manufactured source term $S(x,y)$.", "answer": "$$\n\\boxed{\\frac{\\pi \\rho c_p U_0 \\Theta}{L} \\left[ \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos^{2}\\left(\\frac{\\pi y}{L}\\right) - \\sin^{2}\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right) \\right] + \\frac{2 \\pi^2 k \\Theta}{L^2} \\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{L}\\right)}\n$$", "id": "2497372"}]}