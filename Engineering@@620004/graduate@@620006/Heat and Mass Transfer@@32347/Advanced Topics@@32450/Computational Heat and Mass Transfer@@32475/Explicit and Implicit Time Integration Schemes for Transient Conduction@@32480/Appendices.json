{"hands_on_practices": [{"introduction": "The Forward-Time Central-Space (FTCS) scheme is often the first method taught for solving transient conduction problems due to its simplicity and directness. However, its explicit nature imposes a strict limitation on the size of the time step to ensure the numerical solution remains stable and does not diverge into unphysical values. This foundational exercise [@problem_id:2483538] will guide you through a formal von Neumann stability analysis to derive the famous stability criterion for the 1D FTCS scheme, then apply it to calculate the maximum allowable time step for a given set of physical and numerical parameters, solidifying the link between theory and practical computational constraints.", "problem": "A homogeneous, isotropic one-dimensional solid of constant thermal diffusivity is governed by the transient heat equation derived from conservation of energy and Fourier’s law, which yields $\\frac{\\partial T}{\\partial t}=\\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}$, where $T$ is temperature, $t$ is time, $x$ is the spatial coordinate along the rod, and $\\alpha$ is the thermal diffusivity. Consider a uniform grid with spacing $\\Delta x$ and apply the Forward-Time Central-Space (FTCS) explicit time integration scheme, which advances $T$ in time using a forward Euler step and approximates the second spatial derivative by a second-order central difference. Using a von Neumann (Fourier) stability analysis, determine the maximum time step $\\Delta t_{\\max}$ such that the scheme is marginally stable for all spatial Fourier modes.\n\nUse the data $\\alpha=1.4\\times 10^{-5}\\,\\mathrm{m^{2}/s}$ and $\\Delta x=0.5\\,\\mathrm{mm}$, and compute the corresponding $\\Delta t_{\\max}$ for this one-dimensional FTCS discretization. Round your answer to four significant figures and express the time in seconds.", "solution": "The governing equation for one-dimensional transient heat conduction is given as:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nHere, $T(x, t)$ is the temperature, $x$ is the spatial coordinate, $t$ is time, and $\\alpha$ is the thermal diffusivity. We are to analyze the stability of the Forward-Time Central-Space (FTCS) discretization scheme for this equation.\n\nLet us define a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. The temperature at a grid node $j$ and time level $n$ is denoted by $T_j^n \\equiv T(j\\Delta x, n\\Delta t)$.\n\nThe FTCS scheme approximates the partial derivatives as follows:\nThe time derivative is approximated using a first-order forward difference:\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{j,n} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\nThe spatial second derivative is approximated using a second-order central difference:\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the governing equation gives the discretized form of the FTCS scheme:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\alpha \\left( \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\nWe can rearrange this equation to solve explicitly for the temperature at the next time step, $T_j^{n+1}$:\n$$\nT_j^{n+1} = T_j^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\nLet us define the dimensionless Fourier number, $Fo$, also known as the diffusion number, as:\n$$\nFo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\nThe discretized equation simplifies to:\n$$\nT_j^{n+1} = T_j^n + Fo (T_{j+1}^n - 2T_j^n + T_{j-1}^n) = Fo \\, T_{j+1}^n + (1 - 2Fo)T_j^n + Fo \\, T_{j-1}^n\n$$\nTo determine the stability of this numerical scheme, we perform a von Neumann stability analysis. We consider the behavior of a single Fourier mode of the solution. Let the temperature distribution at time level $n$ be represented by a Fourier component:\n$$\nT_j^n = \\hat{T}^n(k) e^{i k x_j}\n$$\nwhere $k$ is the wavenumber, $x_j = j\\Delta x$ is the spatial position of node $j$, and $i = \\sqrt{-1}$ is the imaginary unit. The amplitude of this mode at time $n$ is $\\hat{T}^n(k)$. After one time step, this mode will be amplified by a factor $G(k)$, the amplification factor:\n$$\nT_j^{n+1} = \\hat{T}^{n+1}(k) e^{i k x_j} = G(k) \\hat{T}^n(k) e^{i k x_j}\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber $k$. The stability condition is:\n$$\n|G(k)| \\le 1\n$$\nWe substitute the Fourier mode representation into the discretized equation:\n$$\nG(k) \\hat{T}^n(k) e^{i k (j\\Delta x)} = Fo \\, \\hat{T}^n(k) e^{i k ((j+1)\\Delta x)} + (1 - 2Fo) \\hat{T}^n(k) e^{i k (j\\Delta x)} + Fo \\, \\hat{T}^n(k) e^{i k ((j-1)\\Delta x)}\n$$\nDividing by $\\hat{T}^n(k) e^{i k (j\\Delta x)}$ yields the expression for the amplification factor $G(k)$:\n$$\nG(k) = Fo \\, e^{i k \\Delta x} + (1 - 2Fo) + Fo \\, e^{-i k \\Delta x}\n$$\nUsing Euler's identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we can simplify this expression:\n$$\nG(k) = 1 - 2Fo + Fo (e^{i k \\Delta x} + e^{-i k \\Delta x}) = 1 - 2Fo + 2Fo \\cos(k \\Delta x)\n$$\n$$\nG(k) = 1 - 2Fo(1 - \\cos(k \\Delta x))\n$$\nUsing the trigonometric half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we obtain:\n$$\nG(k) = 1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nNow we apply the stability condition $|G(k)| \\le 1$. Since $Fo > 0$, the term $4Fo \\sin^2(k\\Delta x/2)$ is non-negative. Therefore, $G(k)$ is always less than or equal to $1$. The stability is thus governed by the lower bound:\n$$\nG(k) \\ge -1\n$$\n$$\n1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThis inequality must hold for all possible wavenumbers $k$. The most restrictive condition occurs when the term $\\sin^2(k\\Delta x/2)$ reaches its maximum value. The maximum value of $\\sin^2(\\theta)$ is $1$. This corresponds to the highest frequency (most rapidly oscillating) mode representable on the grid, where $k \\Delta x = \\pi$.\nThus, the condition for stability becomes:\n$$\nFo \\le \\frac{1}{2}\n$$\nMarginal stability is achieved at the limit of this condition, where $Fo = 1/2$. The maximum allowable time step, $\\Delta t_{\\max}$, corresponds to this limit:\n$$\n\\frac{\\alpha \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\nSolving for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\nWe are given the following data:\n$\\alpha = 1.4 \\times 10^{-5} \\, \\mathrm{m^2/s}$\n$\\Delta x = 0.5 \\, \\mathrm{mm} = 0.5 \\times 10^{-3} \\, \\mathrm{m}$\n\nSubstituting these values into the expression for $\\Delta t_{\\max}$:\n$$\n(\\Delta x)^2 = (0.5 \\times 10^{-3} \\, \\mathrm{m})^2 = 0.25 \\times 10^{-6} \\, \\mathrm{m^2}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25 \\times 10^{-6} \\, \\mathrm{m^2}}{2 \\times (1.4 \\times 10^{-5} \\, \\mathrm{m^2/s})} = \\frac{0.25 \\times 10^{-6}}{2.8 \\times 10^{-5}} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25}{2.8} \\times 10^{-1} \\, \\mathrm{s} \\approx 0.0892857 \\times 10^{-1} \\, \\mathrm{s} = 0.00892857 \\, \\mathrm{s}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta t_{\\max} \\approx 0.008929 \\, \\mathrm{s}\n$$", "answer": "$$\n\\boxed{0.008929}\n$$", "id": "2483538"}, {"introduction": "To overcome the restrictive time step limitation of explicit schemes, we turn to implicit methods like the Crank-Nicolson scheme, which is prized for its second-order accuracy and unconditional stability. This stability comes at a price: instead of solving for each nodal temperature directly, we must solve a coupled system of linear equations at every time step. This practice [@problem_id:2483452] offers a concrete, step-by-step walkthrough of this process, asking you to construct and solve the resulting tridiagonal system for a simple rod, thereby building an intuitive understanding of the mechanics and computational cost of an implicit update.", "problem": "Consider one-dimensional transient heat conduction in a slender homogeneous rod of length $L$ with constant thermal diffusivity $\\alpha$, governed by the heat equation $\\partial T/\\partial t=\\alpha\\,\\partial^{2}T/\\partial x^{2}$, subject to Dirichlet boundary conditions. The rod has left end at $x=0$ held at a constant temperature $T(0,t)=T_{\\text{L}}$ and right end at $x=L$ held at a constant temperature $T(L,t)=T_{\\text{R}}$, for all $t\\ge 0$. The rod is discretized on a uniform five-node grid that includes both ends, with nodes at $x_{i}=i\\,\\Delta x$ for $i=0,1,2,3,4$, where $\\Delta x=L/4$. A single time step is to be taken from $t^{n}$ to $t^{n+1}=t^{n}+\\Delta t$.\n\nGiven the physical and numerical parameters $L=0.4\\,\\mathrm{m}$, $\\alpha=1.00\\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$, and $\\Delta t=50\\,\\mathrm{s}$, the Dirichlet boundary temperatures $T_{\\text{L}}=400\\,\\mathrm{K}$ and $T_{\\text{R}}=300\\,\\mathrm{K}$, and the nodal values at time $t^{n}$,\n$$\nT_{0}^{n}=400\\,\\mathrm{K},\\quad T_{1}^{n}=400\\,\\mathrm{K},\\quad T_{2}^{n}=400\\,\\mathrm{K},\\quad T_{3}^{n}=300\\,\\mathrm{K},\\quad T_{4}^{n}=300\\,\\mathrm{K},\n$$\nuse the Crank–Nicolson time integration (the trapezoidal rule in time combined with a second-order central finite difference in space) applied to the heat equation to derive the linear algebraic equations for the interior nodes and perform one implicit update to compute $T^{n+1}$ at all five nodes.\n\nState clearly the discrete equations you obtain for the interior nodes, incorporate the Dirichlet boundary conditions at $x=0$ and $x=L$ consistently in your linear system, and solve the tridiagonal system exactly or to within roundoff. Express your final numerical result as the row vector\n$$\n\\bigl[T_{0}^{n+1},\\,T_{1}^{n+1},\\,T_{2}^{n+1},\\,T_{3}^{n+1},\\,T_{4}^{n+1}\\bigr],\n$$\nrounded to six significant figures. Express temperatures in kelvin (K).", "solution": "The one-dimensional heat equation is given by\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nThe Crank-Nicolson method is a finite difference method that is second-order in both time and space. It is derived by applying the trapezoidal rule to the time derivative and a central difference approximation to the spatial derivative, averaging the spatial derivative at time levels $n$ and $n+1$. The resulting discretization for an interior node $i$ is:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2} + \\frac{T_{i-1}^{n} - 2T_i^{n} + T_{i+1}^{n}}{(\\Delta x)^2} \\right)\n$$\nLet us define the non-dimensional Fourier number, $r$, as $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$. We rearrange the equation to group terms at time level $n+1$ on the left-hand side (LHS) and terms at time level $n$ on the right-hand side (RHS):\n$$\nT_i^{n+1} - T_i^n = \\frac{r}{2} \\left( (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}) + (T_{i-1}^{n} - 2T_i^{n} + T_{i+1}^{n}) \\right)\n$$\n$$\n-\\frac{r}{2} T_{i-1}^{n+1} + (1+r)T_i^{n+1} - \\frac{r}{2} T_{i+1}^{n+1} = \\frac{r}{2} T_{i-1}^{n} + (1-r)T_i^{n} + \\frac{r}{2} T_{i+1}^{n}\n$$\nFirst, we compute the values of $\\Delta x$ and $r$ from the given parameters:\n$$\n\\Delta x = \\frac{L}{4} = \\frac{0.4\\,\\mathrm{m}}{4} = 0.1\\,\\mathrm{m}\n$$\n$$\nr = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = \\frac{(1.00 \\times 10^{-4}\\,\\mathrm{m^2\\,s^{-1}})(50\\,\\mathrm{s})}{(0.1\\,\\mathrm{m})^2} = \\frac{5 \\times 10^{-3}}{10^{-2}} = 0.5\n$$\nSubstituting $r=0.5$ into the general discrete equation gives:\n$$\n-\\frac{0.5}{2} T_{i-1}^{n+1} + (1+0.5)T_i^{n+1} - \\frac{0.5}{2} T_{i+1}^{n+1} = \\frac{0.5}{2} T_{i-1}^{n} + (1-0.5)T_i^{n} + \\frac{0.5}{2} T_{i+1}^{n}\n$$\n$$\n-0.25 T_{i-1}^{n+1} + 1.5 T_i^{n+1} - 0.25 T_{i+1}^{n+1} = 0.25 T_{i-1}^{n} + 0.5 T_i^{n} + 0.25 T_{i+1}^{n}\n$$\nThis equation applies to the interior nodes of the grid, which are $i=1, 2, 3$. The temperatures at the boundary nodes $i=0$ and $i=4$ are given by the Dirichlet boundary conditions:\n$T(0,t) = T_0^{n+1} = T_{\\text{L}} = 400\\,\\mathrm{K}$\n$T(L,t) = T_4^{n+1} = T_{\\text{R}} = 300\\,\\mathrm{K}$\n\nWe form a linear system for the unknown interior nodal temperatures $\\{T_1^{n+1}, T_2^{n+1}, T_3^{n+1}\\}$.\nFor each interior node $i$, the RHS of the equation depends only on known values at time $t^n$. Let us denote the RHS for node $i$ as $d_i$:\n$d_i = 0.25 T_{i-1}^{n} + 0.5 T_i^{n} + 0.25 T_{i+1}^{n}$\nUsing the given initial data $T^{n} = [400, 400, 400, 300, 300]\\,\\mathrm{K}$:\nFor $i=1$: $d_1 = 0.25 T_0^n + 0.5 T_1^n + 0.25 T_2^n = 0.25(400) + 0.5(400) + 0.25(400) = 100 + 200 + 100 = 400$.\nFor $i=2$: $d_2 = 0.25 T_1^n + 0.5 T_2^n + 0.25 T_3^n = 0.25(400) + 0.5(400) + 0.25(300) = 100 + 200 + 75 = 375$.\nFor $i=3$: $d_3 = 0.25 T_2^n + 0.5 T_3^n + 0.25 T_4^n = 0.25(400) + 0.5(300) + 0.25(300) = 100 + 150 + 75 = 325$.\n\nNow we write the equations for the LHS, incorporating the known boundary temperatures at $t^{n+1}$:\nFor $i=1$: $-0.25 T_0^{n+1} + 1.5 T_1^{n+1} - 0.25 T_2^{n+1} = d_1 = 400$.\nSince $T_0^{n+1} = 400$, we have $1.5 T_1^{n+1} - 0.25 T_2^{n+1} = 400 + 0.25(400) = 500$.\n\nFor $i=2$: $-0.25 T_1^{n+1} + 1.5 T_2^{n+1} - 0.25 T_3^{n+1} = d_2 = 375$.\n\nFor $i=3$: $-0.25 T_2^{n+1} + 1.5 T_3^{n+1} - 0.25 T_4^{n+1} = d_3 = 325$.\nSince $T_4^{n+1} = 300$, we have $-0.25 T_2^{n+1} + 1.5 T_3^{n+1} = 325 + 0.25(300) = 400$.\n\nThe resulting linear system for the interior temperature vector $[T_1^{n+1}, T_2^{n+1}, T_3^{n+1}]^T$ is a tridiagonal system:\n$$\n\\begin{pmatrix}\n1.5 & -0.25 & 0 \\\\\n-0.25 & 1.5 & -0.25 \\\\\n0 & -0.25 & 1.5\n\\end{pmatrix}\n\\begin{pmatrix}\nT_1^{n+1} \\\\\nT_2^{n+1} \\\\\nT_3^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n500 \\\\\n375 \\\\\n400\n\\end{pmatrix}\n$$\nTo solve this $3 \\times 3$ system, we can use substitution. From the first equation:\n$T_1^{n+1} = \\frac{500 + 0.25 T_2^{n+1}}{1.5} = \\frac{1000}{3} + \\frac{1}{6} T_2^{n+1}$.\nFrom the third equation:\n$T_3^{n+1} = \\frac{400 + 0.25 T_2^{n+1}}{1.5} = \\frac{800}{3} + \\frac{1}{6} T_2^{n+1}$.\nSubstitute these expressions for $T_1^{n+1}$ and $T_3^{n+1}$ into the second equation:\n$-0.25 \\left(\\frac{1000}{3} + \\frac{1}{6} T_2^{n+1}\\right) + 1.5 T_2^{n+1} - 0.25 \\left(\\frac{800}{3} + \\frac{1}{6} T_2^{n+1}\\right) = 375$.\n$-\\frac{250}{3} - \\frac{1}{24} T_2^{n+1} + \\frac{3}{2} T_2^{n+1} - \\frac{200}{3} - \\frac{1}{24} T_2^{n+1} = 375$.\nCombine terms:\n$\\left(\\frac{3}{2} - \\frac{2}{24}\\right) T_2^{n+1} - \\frac{450}{3} = 375$.\n$\\frac{17}{12} T_2^{n+1} - 150 = 375$.\n$\\frac{17}{12} T_2^{n+1} = 525$.\n$T_2^{n+1} = \\frac{525 \\times 12}{17} = \\frac{6300}{17}\\,\\mathrm{K}$.\n\nNow we back-substitute to find $T_1^{n+1}$ and $T_3^{n+1}$:\n$T_1^{n+1} = \\frac{1000}{3} + \\frac{1}{6} \\left(\\frac{6300}{17}\\right) = \\frac{1000}{3} + \\frac{1050}{17} = \\frac{17000 + 3150}{51} = \\frac{20150}{51}\\,\\mathrm{K}$.\n$T_3^{n+1} = \\frac{800}{3} + \\frac{1}{6} \\left(\\frac{6300}{17}\\right) = \\frac{800}{3} + \\frac{1050}{17} = \\frac{13600 + 3150}{51} = \\frac{16750}{51}\\,\\mathrm{K}$.\n\nThe temperatures at the interior nodes are:\n$T_1^{n+1} = \\frac{20150}{51} \\approx 395.098039... \\,\\mathrm{K}$\n$T_2^{n+1} = \\frac{6300}{17} \\approx 370.588235... \\,\\mathrm{K}$\n$T_3^{n+1} = \\frac{16750}{51} \\approx 328.431372... \\,\\mathrm{K}$\n\nRounding these values to six significant figures:\n$T_1^{n+1} = 395.098\\,\\mathrm{K}$\n$T_2^{n+1} = 370.588\\,\\mathrm{K}$\n$T_3^{n+1} = 328.431\\,\\mathrm{K}$\n\nThe complete temperature vector at time $t^{n+1}$, including the boundary nodes, is:\n$T_0^{n+1} = 400.000\\,\\mathrm{K}$\n$T_1^{n+1} = 395.098\\,\\mathrm{K}$\n$T_2^{n+1} = 370.588\\,\\mathrm{K}$\n$T_3^{n+1} = 328.431\\,\\mathrm{K}$\n$T_4^{n+1} = 300.000\\,\\mathrm{K}$\n\nThis result represents the temperature distribution after one time step of $\\Delta t=50\\,\\mathrm{s}$, showing the evolution from the initial sharp-front profile towards the final linear steady-state profile.", "answer": "$$\n\\boxed{\\begin{pmatrix} 400.000 & 395.098 & 370.588 & 328.431 & 300.000 \\end{pmatrix}}\n$$", "id": "2483452"}, {"introduction": "While the unconditional stability of the Crank-Nicolson scheme is a powerful advantage, it is not a guarantee of a physically realistic solution for any choice of time step, $\\Delta t$. For large values of the non-dimensional diffusion number, $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$, the scheme can introduce spurious, non-physical oscillations, even as the solution remains numerically bounded. This advanced practice [@problem_id:2483557] delves into this crucial subtlety, using Fourier analysis to determine the critical value of $r$ beyond which these oscillations manifest, teaching a vital lesson about the difference between numerical stability and physical fidelity.", "problem": "Consider one-dimensional transient heat conduction in a homogeneous medium with thermal diffusivity $\\alpha$ on a periodic domain $[0,L]$, governed by the partial differential equation $\\frac{\\partial T}{\\partial t}=\\alpha \\frac{\\partial^{2}T}{\\partial x^{2}}$. On a uniform grid with spacing $\\Delta x$, discretize the spatial operator by the standard second-order centered difference and integrate in time by the Crank–Nicolson (CN) scheme (trapezoidal rule in time). Using a von Neumann Fourier mode analysis on the fully discrete scheme, derive a necessary and sufficient condition under which the Crank–Nicolson update is non-monotone in time (that is, the amplitude of at least one Fourier mode changes sign between steps) even though the scheme is unconditionally stable in the sense of bounded amplification magnitude. Define the nondimensional time-step parameter $r=\\alpha \\Delta t/\\Delta x^{2}$ and, by optimizing over all spatial Fourier modes admitted by the periodic grid, determine the largest value $r_{\\text{crit}}$ such that for all $0 \\le r \\le r_{\\text{crit}}$ the one-step amplification factor of every Fourier mode is nonnegative. Your final answer must be the single closed-form value of $r_{\\text{crit}}$. Do not substitute numerical values. Provide $r_{\\text{crit}}$ as a single number without units.", "solution": "The governing equation for one-dimensional transient heat conduction is given by:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^{2}T}{\\partial x^{2}} $$\nwhere $T$ is the temperature, $t$ is time, $x$ is the spatial coordinate, and $\\alpha$ is the thermal diffusivity.\n\nWe are instructed to discretize this equation on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. Let $T_j^n$ be the numerical approximation of $T(j\\Delta x, n\\Delta t)$. The spatial second derivative is approximated using a second-order centered difference:\n$$ \\frac{\\partial^{2}T}{\\partial x^{2}} \\bigg|_{x_j} \\approx \\frac{T_{j+1} - 2T_j + T_{j-1}}{(\\Delta x)^{2}} $$\nThe time integration is performed using the Crank–Nicolson scheme, which is equivalent to the trapezoidal rule. This scheme averages the spatial derivative operator at time levels $n$ and $n+1$:\n$$ \\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left[ \\left( \\frac{T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1}}{(\\Delta x)^{2}} \\right) + \\left( \\frac{T_{j+1}^{n} - 2T_j^{n} + T_{j-1}^{n}}{(\\Delta x)^{2}} \\right) \\right] $$\nIntroducing the nondimensional time-step parameter $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$, we can rearrange the equation as:\n$$ T_j^{n+1} - T_j^n = \\frac{r}{2} \\left[ (T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1}) + (T_{j+1}^{n} - 2T_j^{n} + T_{j-1}^{n}) \\right] $$\nTo analyze the properties of this scheme, we use von Neumann Fourier analysis. We consider a single Fourier mode for the temperature field:\n$$ T_j^n = \\hat{T}^n(k) \\exp(i k x_j) $$\nwhere $k$ is the wavenumber and $i = \\sqrt{-1}$. The evolution of the mode's amplitude from one time step to the next is described by the amplification factor $G(k)$, defined such that $\\hat{T}^{n+1}(k) = G(k) \\hat{T}^n(k)$. Consequently, $T_j^{n+1} = G(k) T_j^n$.\nSubstituting the Fourier mode into the discretized equation gives:\n$$ G(k)T_j^n - T_j^n = \\frac{r}{2} \\left[ G(k)(T_{j+1}^n - 2T_j^n + T_{j-1}^n) + (T_{j+1}^n - 2T_j^n + T_{j-1}^n) \\right] $$\nWe use the relations $T_{j\\pm 1}^n = T_j^n \\exp(\\pm i k \\Delta x)$. Dividing the entire equation by $T_j^n$ (which is non-zero) yields:\n$$ G(k) - 1 = \\frac{r}{2} (G(k) + 1) \\left[ \\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x) \\right] $$\nLet the nondimensional wavenumber, or phase angle, be $\\theta = k \\Delta x$. Using the identity $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, the term in brackets becomes:\n$$ 2\\cos(\\theta) - 2 = -2(1-\\cos(\\theta)) $$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, this simplifies further to:\n$$ -4\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\nSubstituting this back into the equation for $G(k)$ (now written as $G(\\theta)$):\n$$ G(\\theta) - 1 = \\frac{r}{2} (G(\\theta) + 1) \\left[ -4\\sin^2\\left(\\frac{\\theta}{2}\\right) \\right] $$\n$$ G(\\theta) - 1 = -2r(G(\\theta) + 1)\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\nWe now solve for $G(\\theta)$:\n$$ G(\\theta) \\left(1 + 2r\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = 1 - 2r\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\n$$ G(\\theta) = \\frac{1 - 2r\\sin^2\\left(\\frac{\\theta}{2}\\right)}{1 + 2r\\sin^2\\left(\\frac{\\theta}{2}\\right)} $$\nThe problem asks for the condition under which the scheme is non-monotone, which occurs if the amplification factor $G(\\theta)$ can be negative. This is non-physical for a diffusion process, where all modes should decay monotonically. We seek the largest value of $r$, denoted $r_{\\text{crit}}$, for which the amplification factor is non-negative for all possible Fourier modes, i.e., $G(\\theta) \\ge 0$ for all $\\theta$.\n\nGiven that $r \\ge 0$, the denominator $1 + 2r\\sin^2(\\theta/2)$ is always greater than or equal to $1$. Therefore, the sign of $G(\\theta)$ is determined by its numerator. The condition $G(\\theta) \\ge 0$ becomes:\n$$ 1 - 2r\\sin^2\\left(\\frac{\\theta}{2}\\right) \\ge 0 $$\nThis inequality must hold for all Fourier modes that can be resolved by the grid. The phase angle $\\theta=k\\Delta x$ spans the range $[-\\pi, \\pi]$, with the highest frequency (Nyquist) mode corresponding to $\\theta = \\pm \\pi$. To ensure the inequality holds for all $\\theta$, we must satisfy it for the most restrictive case. The inequality can be written as:\n$$ r \\le \\frac{1}{2\\sin^2\\left(\\frac{\\theta}{2}\\right)} $$\nTo satisfy this for all $\\theta$, $r$ must be less than or equal to the minimum value of the right-hand side. The minimum of this expression occurs when its denominator, $\\sin^2(\\theta/2)$, is maximized. The maximum value of $\\sin^2(\\theta/2)$ over the range $\\theta \\in [-\\pi, \\pi]$ occurs at $\\theta = \\pm \\pi$:\n$$ \\max_{\\theta \\in [-\\pi, \\pi]} \\left(\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 = 1 $$\nSubstituting this maximum value into the inequality provides the most stringent condition on $r$:\n$$ r \\le \\frac{1}{2(1)} \\implies r \\le \\frac{1}{2} $$\nTherefore, for the Crank–Nicolson scheme to guarantee a non-negative amplification factor for all Fourier modes, the parameter $r$ must not exceed $1/2$. The largest value of $r$ for which this condition holds is $r_{\\text{crit}}$.\nIf $r > 1/2$, the highest frequency mode exhibits spurious oscillations, as its amplitude factor $G(\\pi) = (1-2r)/(1+2r)$ becomes negative.\nThe critical value is thus:\n$$ r_{\\text{crit}} = \\frac{1}{2} $$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2483557"}]}