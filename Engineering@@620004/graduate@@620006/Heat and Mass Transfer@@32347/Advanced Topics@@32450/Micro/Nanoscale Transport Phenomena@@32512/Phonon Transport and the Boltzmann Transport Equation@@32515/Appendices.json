{"hands_on_practices": [{"introduction": "The Boltzmann Transport Equation (BTE) provides a powerful framework for predicting macroscopic transport properties from microscopic physics. This practice guides you through a foundational derivation, starting from the BTE formalism to determine the thermal conductivity tensor $k_{ij}$ for an anisotropic crystal [@problem_id:2514919]. By working with an orthorhombic phonon dispersion relation, you will reinforce the critical link between a material's band structure, the resulting phonon group velocities $\\mathbf{v} = \\nabla_{\\mathbf{q}} \\omega$, and the directional nature of heat conduction.", "problem": "Consider a three-dimensional orthorhombic crystal whose long-wavelength acoustic phonons are described by a linear, anisotropic dispersion relation\n$$\n\\omega(\\mathbf{q})=\\sqrt{v_{x}^{2} q_{x}^{2}+v_{y}^{2} q_{y}^{2}+v_{z}^{2} q_{z}^{2}},\n$$\nwhere $v_{x}$, $v_{y}$, and $v_{z}$ are the principal-direction sound speeds and $\\mathbf{q}=(q_{x},q_{y},q_{z})$ is the wavevector. Assume the following:\n- The crystal is in the classical (high-temperature) regime where the mode heat capacity tends to $k_{B}$ and the volumetric specific heat $C_{v}$ is temperature-independent over the range of interest.\n- Heat transport is driven by a small, static temperature gradient so that linear response applies.\n- The phonon dynamics are governed by the Boltzmann transport equation (BTE), and the collision operator is treated in the Single-Mode Relaxation Time Approximation (SMRTA) with a frequency-independent relaxation time $\\tau$.\n- Optical branches can be neglected and the Debye approximation with an appropriate cutoff is used so that the total number of acoustic modes is correctly reproduced by $C_{v}$.\n- Boundary and isotope scattering are negligible beyond what is represented by the relaxation time $\\tau$, and Umklapp processes are encompassed by $\\tau$.\n\nUnder these assumptions, derive from first principles the principal components $k_{xx}$, $k_{yy}$, and $k_{zz}$ of the thermal conductivity tensor $k_{ij}$ for this orthorhombic crystal. Express your final results symbolically in terms of $v_{x}$, $v_{y}$, $v_{z}$, $\\tau$, and $C_{v}$. Express your answers in the International System of Units (SI). Provide your final answer as a single row containing the three components.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard, albeit anisotropic, problem in solid-state physics concerning phonon transport. The assumptions provided are clear simplifying conditions commonly used in such derivations. Therefore, the problem is valid, and we may proceed with a solution.\n\nThe starting point for this derivation is the expression for the thermal conductivity tensor $k_{ij}$ from the Boltzmann transport equation (BTE) under the single-mode relaxation time approximation (SMRTA). For a system of phonons, this is given by:\n$$\nk_{ij} = \\frac{1}{V} \\sum_{\\mathbf{q},p} C_{\\mathbf{q},p} v_{i}(\\mathbf{q},p) v_{j}(\\mathbf{q},p) \\tau(\\mathbf{q},p)\n$$\nHere, $V$ is the crystal volume, the sum is over all phonon wavevectors $\\mathbf{q}$ and polarizations $p$, $C_{\\mathbf{q},p}$ is the heat capacity of the mode $(\\mathbf{q},p)$, $\\mathbf{v}(\\mathbf{q},p) = \\nabla_{\\mathbf{q}}\\omega(\\mathbf{q},p)$ is the group velocity, and $\\tau(\\mathbf{q},p)$ is the relaxation time.\n\nThe problem simplifies this general framework with several assumptions:\n1.  We consider a single effective acoustic branch, so we may drop the polarization index $p$.\n2.  The relaxation time $\\tau$ is constant and independent of frequency or wavevector.\n3.  We are in the classical (high-temperature) regime, where the heat capacity of each individual phonon mode approaches the Dulong-Petit limit, $C_{\\mathbf{q}} = k_B$, where $k_B$ is the Boltzmann constant.\n\nUnder these assumptions, the tensor components become:\n$$\nk_{ij} = \\frac{k_B \\tau}{V} \\sum_{\\mathbf{q}} v_{i}(\\mathbf{q}) v_{j}(\\mathbf{q})\n$$\nThe sum over discrete wavevectors $\\mathbf{q}$ can be converted to an integral over the first Brillouin zone (or, in this case, a Debye cutoff volume in $\\mathbf{q}$-space):\n$$\n\\sum_{\\mathbf{q}} \\rightarrow V \\int \\frac{d^3q}{(2\\pi)^3}\n$$\nThis gives the integral form for the thermal conductivity tensor:\n$$\nk_{ij} = k_B \\tau \\int v_{i}(\\mathbf{q}) v_{j}(\\mathbf{q}) \\frac{d^3q}{(2\\pi)^3}\n$$\nThe problem specifies that an appropriate Debye cutoff is used. Let us relate $k_{ij}$ to the given volumetric specific heat, $C_v$. In the high-temperature limit, $C_v$ is the sum of the heat capacities of all modes per unit volume:\n$$\nC_v = \\frac{1}{V} \\sum_{\\mathbf{q}} C_{\\mathbf{q}} = \\frac{1}{V} \\sum_{\\mathbf{q}} k_B = k_B \\int \\frac{d^3q}{(2\\pi)^3}\n$$\nThe integral is over the same Debye cutoff volume as for the $k_{ij}$ calculation. We can now express $k_{ij}$ as:\n$$\nk_{ij} = C_v \\tau \\frac{\\int v_{i}(\\mathbf{q}) v_{j}(\\mathbf{q}) d^3q}{\\int d^3q} = C_v \\tau \\langle v_i v_j \\rangle\n$$\nwhere $\\langle \\dots \\rangle$ denotes an average over the populated phonon modes in $\\mathbf{q}$-space. The problem is now reduced to calculating the average of the product of group velocity components.\n\nThe group velocity $\\mathbf{v}(\\mathbf{q})$ is the gradient of the dispersion relation $\\omega(\\mathbf{q})$:\n$$\n\\mathbf{v}(\\mathbf{q}) = \\nabla_{\\mathbf{q}} \\omega(\\mathbf{q}) = \\left(\\frac{\\partial\\omega}{\\partial q_x}, \\frac{\\partial\\omega}{\\partial q_y}, \\frac{\\partial\\omega}{\\partial q_z}\\right)\n$$\nGiven the dispersion $\\omega(\\mathbf{q}) = \\sqrt{v_{x}^{2} q_{x}^{2} + v_{y}^{2} q_{y}^{2} + v_{z}^{2} q_{z}^{2}}$, the components of the group velocity are:\n$$\nv_x(\\mathbf{q}) = \\frac{v_x^2 q_x}{\\omega(\\mathbf{q})}, \\quad v_y(\\mathbf{q}) = \\frac{v_y^2 q_y}{\\omega(\\mathbf{q})}, \\quad v_z(\\mathbf{q}) = \\frac{v_z^2 q_z}{\\omega(\\mathbf{q})}\n$$\nFor an orthorhombic crystal, the Brillouin zone is symmetric with respect to reflections like $q_x \\rightarrow -q_x$. The integrands for the off-diagonal components of the thermal conductivity tensor, such as $k_{xy}$, will contain terms like $v_x v_y \\propto q_x q_y$. Since this is an odd function with respect to either $q_x$ or $q_y$, its integral over a symmetric domain is zero. Thus, $k_{ij} = 0$ for $i \\neq j$, and we only need to compute the principal components $k_{xx}$, $k_{yy}$, and $k_{zz}$.\n\nLet us calculate $k_{xx}$:\n$$\nk_{xx} = C_v \\tau \\langle v_x^2 \\rangle = C_v \\tau \\frac{\\int v_x(\\mathbf{q})^2 d^3q}{\\int d^3q}\n$$\nSubstituting the expression for $v_x(\\mathbf{q})$:\n$$\n\\langle v_x^2 \\rangle = \\frac{\\int \\frac{v_x^4 q_x^2}{v_x^2 q_x^2 + v_y^2 q_y^2 + v_z^2 q_z^2} d^3q}{\\int d^3q}\n$$\nTo evaluate these integrals, we perform a change of variables that simplifies the denominator. Let $\\mathbf{Q} = (Q_x, Q_y, Q_z)$ where $Q_x = v_x q_x$, $Q_y = v_y q_y$, and $Q_z = v_z q_z$. The Jacobian of this transformation gives the volume element $d^3q = \\frac{d^3Q}{v_x v_y v_z}$. The denominator becomes $Q_x^2 + Q_y^2 + Q_z^2 = Q^2$. The appropriate Debye cutoff is a surface of constant frequency, $\\omega(\\mathbf{q}) = \\omega_D$, which in the new coordinates corresponds to a sphere of radius $Q = \\omega_D$.\nThe integral in the numerator transforms as:\n$$\n\\int \\frac{v_x^4 (Q_x/v_x)^2}{Q^2} \\frac{d^3Q}{v_x v_y v_z} = \\frac{v_x}{v_y v_z} \\int_{Q \\le \\omega_D} \\frac{Q_x^2}{Q^2} d^3Q\n$$\nThe integral in the denominator becomes:\n$$\n\\int d^3q = \\int_{Q \\le \\omega_D} \\frac{d^3Q}{v_x v_y v_z} = \\frac{1}{v_x v_y v_z} \\int_{Q \\le \\omega_D} d^3Q\n$$\nThus, the average is:\n$$\n\\langle v_x^2 \\rangle = \\frac{\\frac{v_x}{v_y v_z} \\int \\frac{Q_x^2}{Q^2} d^3Q}{\\frac{1}{v_x v_y v_z} \\int d^3Q} = v_x^2 \\frac{\\int \\frac{Q_x^2}{Q^2} d^3Q}{\\int d^3Q}\n$$\nThe integration domain is a sphere in $\\mathbf{Q}$-space. By symmetry, the integrals of $Q_x^2/Q^2$, $Q_y^2/Q^2$, and $Q_z^2/Q^2$ over this spherical volume must be equal. Therefore:\n$$\n\\int \\frac{Q_x^2}{Q^2} d^3Q = \\int \\frac{Q_y^2}{Q^2} d^3Q = \\int \\frac{Q_z^2}{Q^2} d^3Q\n$$\nSumming these gives:\n$$\n\\int \\frac{Q_x^2 + Q_y^2 + Q_z^2}{Q^2} d^3Q = \\int \\frac{Q^2}{Q^2} d^3Q = \\int d^3Q\n$$\nThis implies that $3 \\int \\frac{Q_x^2}{Q^2} d^3Q = \\int d^3Q$. The ratio of the integrals is therefore:\n$$\n\\frac{\\int \\frac{Q_x^2}{Q^2} d^3Q}{\\int d^3Q} = \\frac{1}{3}\n$$\nSubstituting this back into the expression for $\\langle v_x^2 \\rangle$:\n$$\n\\langle v_x^2 \\rangle = v_x^2 \\cdot \\frac{1}{3} = \\frac{1}{3}v_x^2\n$$\nFinally, we obtain the expression for $k_{xx}$:\n$$\nk_{xx} = C_v \\tau \\langle v_x^2 \\rangle = \\frac{1}{3} C_v \\tau v_x^2\n$$\nBy symmetry, the calculations for $k_{yy}$ and $k_{zz}$ are identical, involving only a permutation of the indices $x$, $y$, and $z$. This leads to:\n$$\nk_{yy} = \\frac{1}{3} C_v \\tau v_y^2\n$$\n$$\nk_{zz} = \\frac{1}{3} C_v \\tau v_z^2\n$$\nThese are the principal components of the thermal conductivity tensor. The result is dimensionally correct, as thermal conductivity has units of W m$^{-1}$ K$^{-1}$, which matches the units of $C_v \\tau v^2$ (J m$^{-3}$ K$^{-1}$ $\\cdot$ s $\\cdot$ m$^2$ s$^{-2}$ = J m$^{-1}$ s$^{-1}$ K$^{-1}$). The result correctly reduces to the well-known isotropic formula $k = \\frac{1}{3}C_v v_s^2 \\tau$ if $v_x = v_y = v_z = v_s$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3} C_v \\tau v_x^2 & \\frac{1}{3} C_v \\tau v_y^2 & \\frac{1}{3} C_v \\tau v_z^2\n\\end{pmatrix}\n}\n$$", "id": "2514919"}, {"introduction": "While deriving thermal conductivity in a single case is insightful, a more powerful application is modeling its behavior over a range of conditions, particularly temperature. This exercise challenges you to construct a comprehensive model for temperature-dependent thermal conductivity, $\\kappa(T)$, by integrating the contributions of competing phonon scattering mechanisms via Matthiessen's rule [@problem_id:2514903]. You will implement a model that captures the effects of Umklapp, impurity, and boundary scattering, and then use it to fit data, a fundamental skill for connecting theory with real-world material characterization.", "problem": "You are to derive, implement, and calibrate a physics-based model for lattice thermal conductivity under the framework of the phonon Boltzmann transport equation in the relaxation-time approximation. You must begin from first principles and core definitions, not from pre-stated shortcut formulas. The goal is to fit a temperature-dependent thermal conductivity curve using a model where the scattering rates are determined by three processes: three-phonon Umklapp scattering, point-defect (Rayleigh) impurity scattering, and boundary scattering.\n\nStarting point and constraints:\n- Begin from the phonon Boltzmann transport equation under the relaxation-time approximation for steady-state transport, connect the heat flux to mode-specific heat capacity, phonon group velocity, and relaxation time, and use the Debye model for acoustic phonons in three dimensions with a constant group velocity.\n- Use Matthiessen’s rule to combine scattering mechanisms. The total relaxation time $\\tau(\\omega,T)$ satisfies $\\tau^{-1}(\\omega,T) = \\tau_{U}^{-1}(\\omega,T) + \\tau_{I}^{-1}(\\omega) + \\tau_{B}^{-1}$, where:\n  1. The Umklapp scattering rate is of the form $\\tau_{U}^{-1}(\\omega,T) \\sim A \\,\\omega^{2}\\, T \\,\\exp\\!\\left(-\\Theta_{D}/(b T)\\right)$, with $A$ and $b$ to be fitted from data.\n  2. The point-defect (impurity) scattering rate is of the form $\\tau_{I}^{-1}(\\omega) \\sim B \\,\\omega^{4}$, with $B$ to be fitted.\n  3. The boundary scattering rate is $\\tau_{B}^{-1} = v/L$, where $v$ is a constant group velocity and $L$ is a characteristic boundary length, which will be specified per dataset.\n- Use the three-dimensional Debye density of states and the standard mode heat capacity expression consistent with the Debye model and Bose-Einstein statistics. Assume a single average sound speed $v$ for all acoustic modes.\n\nUnits and constants to use:\n- Boltzmann constant $k_{B} = 1.380649\\times 10^{-23}\\ \\text{J/K}$.\n- Reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}\\ \\text{J}\\cdot\\text{s}$.\n- Debye temperature $\\Theta_{D} = 645\\ \\text{K}$.\n- Average phonon group velocity $v = 6400\\ \\text{m/s}$.\n- All temperatures $T$ are in $\\text{K}$.\n- Characteristic lengths $L$ are in $\\text{m}$.\n- The fitted constants must be reported in the following units: $A$ in $\\text{s/K}$, $b$ dimensionless, and $B$ in $\\text{s}^{3}$.\n- Express all final numerical outputs in SI units and round each fitted parameter to three significant figures.\n\nProgram tasks:\n1. From the Boltzmann transport equation under the above assumptions, derive a tractable integral expression for the lattice thermal conductivity $\\kappa(T)$ in terms of an integral over phonon angular frequency (or an equivalent dimensionless integration variable), making explicit the use of the Debye model, the mode heat capacity, and Matthiessen’s rule. Your implementation must compute $\\kappa(T)$ by numerical quadrature for any given $T$, $A$, $b$, $B$, $L$, $\\Theta_{D}$, and $v$.\n2. Generate synthetic “experimental” datasets by evaluating your derived $\\kappa(T)$ at specified temperatures for the three scenarios below (no noise added). Each dataset uses the same $\\Theta_{D}$ and $v$ given above, but different $L$ and different ground-truth scattering parameters $(A_{\\text{true}}, b_{\\text{true}}, B_{\\text{true}})$:\n   - Dataset $1$ (bulk, high purity): $L = 10^{-3}\\ \\text{m}$, $A_{\\text{true}} = 2.0\\times 10^{-19}\\ \\text{s/K}$, $b_{\\text{true}} = 3.0$, $B_{\\text{true}} = 1.0\\times 10^{-45}\\ \\text{s}^{3}$, temperatures $T \\in \\{20, 50, 100, 150, 200, 250, 300\\}\\ \\text{K}$.\n   - Dataset $2$ (nanowire, boundary-limited): $L = 10^{-6}\\ \\text{m}$, $A_{\\text{true}} = 2.0\\times 10^{-19}\\ \\text{s/K}$, $b_{\\text{true}} = 3.0$, $B_{\\text{true}} = 1.0\\times 10^{-45}\\ \\text{s}^{3}$, temperatures $T \\in \\{20, 50, 100, 150, 200, 250, 300\\}\\ \\text{K}$.\n   - Dataset $3$ (bulk, more impurities): $L = 10^{-3}\\ \\text{m}$, $A_{\\text{true}} = 2.0\\times 10^{-19}\\ \\text{s/K}$, $b_{\\text{true}} = 3.0$, $B_{\\text{true}} = 5.0\\times 10^{-44}\\ \\text{s}^{3}$, temperatures $T \\in \\{20, 50, 100, 150, 200, 250, 300\\}\\ \\text{K}$.\n3. For each dataset, perform a nonlinear least-squares fit of the model parameters $(A,b,B)$ to the synthetic “experimental” $\\kappa(T)$ values to recover estimates $(\\hat{A}, \\hat{b}, \\hat{B})$. Impose positivity constraints for $A$ and $B$, and a physically reasonable range for $b$ (for example, between $1$ and $10$).\n4. Report the fitted parameters for each dataset as floats in SI units, each rounded to three significant figures. Also enforce that angles, if any, be in radians, though no angular quantities are used here.\n\nTest suite and required final output:\n- Your program must use precisely the three datasets described above.\n- Your program must output a single line containing a comma-separated list enclosed in square brackets. The list must contain three items, one per dataset, where each item is a list of three floats $[\\hat{A},\\hat{b},\\hat{B}]$ rounded to three significant figures and in the required units. For example, the final output format must be of the form $[[\\hat{A}_{1},\\hat{b}_{1},\\hat{B}_{1}],[\\hat{A}_{2},\\hat{b}_{2},\\hat{B}_{2}],[\\hat{A}_{3},\\hat{b}_{3},\\hat{B}_{3}]]$.\n- The outputs must be numerical and unit-consistent: $A$ in $\\text{s/K}$, $b$ dimensionless, and $B$ in $\\text{s}^{3}$.\n\nScientific realism and coverage:\n- Dataset $1$ probes the “happy path” where Umklapp processes dominate at high $T$ and impurity/boundary scattering are weak.\n- Dataset $2$ probes a boundary-limited case where $\\tau_{B}^{-1}$ is much larger, suppressing $\\kappa$ at low to intermediate $T$.\n- Dataset $3$ probes impurity-dominated behavior at low and intermediate $T$ via an increased $B$.\n- Your derivation and implementation must remain consistent with the above physical model and constraints, and the calibration must be performed by minimizing the sum of squared residuals between modeled and synthetic “experimental” $\\kappa(T)$ values.\n\nAll numerical answers must be in SI units and rounded to three significant figures as specified. The final output must be exactly one line in the format described above, with no extra text.", "solution": "The problem requires the derivation and implementation of a model for lattice thermal conductivity, $\\kappa(T)$, based on the phonon Boltzmann transport equation (BTE). The parameters of the model will be calibrated against synthetic datasets using nonlinear least-squares fitting. The validation of the problem statement finds it to be scientifically sound, well-posed, and internally consistent. It represents a standard problem in solid-state physics. We proceed with the solution.\n\nFirst, we derive the expression for lattice thermal conductivity $\\kappa$. The BTE in the relaxation-time approximation (RTA) for phonons under a small temperature gradient $\\nabla T$ leads to an expression for the heat flux $\\mathbf{J}_q$. For an isotropic system, this simplifies to a scalar relationship, $\\mathbf{J}_q = -\\kappa \\nabla T$. The thermal conductivity $\\kappa$ is obtained by summing the contributions from all phonon modes, indexed by wavevector $\\mathbf{k}$ and polarization $p$.\nThe standard result from kinetic theory is:\n$$ \\kappa = \\frac{1}{3} \\int C_{ph}(\\omega, T) v^2 \\tau(\\omega, T) g(\\omega) d\\omega $$\nHere, we integrate over phonon angular frequency $\\omega$. The components of this integral are defined as follows:\n$1$. $C_{ph}(\\omega, T)$ is the mode-specific heat capacity, which describes how the energy of a single phonon mode changes with temperature. From Bose-Einstein statistics, for a harmonic oscillator of frequency $\\omega$, it is given by:\n$$ C_{ph}(\\omega, T) = k_B \\left( \\frac{\\hbar\\omega}{k_B T} \\right)^2 \\frac{\\exp(\\hbar\\omega/k_B T)}{[\\exp(\\hbar\\omega/k_B T) - 1]^2} $$\nwhere $\\langle n \\rangle$ is the average phonon occupation number, $\\hbar$ is the reduced Planck constant, and $k_B$ is the Boltzmann constant.\n\n$2$. $v$ is the phonon group velocity, which is assumed to be a constant average sound speed for all acoustic modes. The factor of $1/3$ arises from averaging over an isotropic three-dimensional space ($v_x^2 \\to v^2/3$).\n\n$3$. $\\tau(\\omega, T)$ is the total relaxation time (or lifetime) of a phonon mode, which characterizes how long a mode persists before being scattered.\n\n$4$. $g(\\omega)$ is the phonon density of states per unit volume. For a three-dimensional Debye model with a single average sound speed $v$, the density of states for $3$ polarizations is:\n$$ g(\\omega) = \\frac{3\\omega^2}{2\\pi^2 v^3} $$\nThe integration is performed up to the Debye frequency $\\omega_D$, which is defined by the Debye temperature $\\Theta_D = \\hbar\\omega_D/k_B$.\n\nSubstituting these components into the expression for $\\kappa$ yields:\n$$ \\kappa(T) = \\frac{1}{3} \\int_0^{\\omega_D} \\left[ k_B \\left( \\frac{\\hbar\\omega}{k_B T} \\right)^2 \\frac{e^{\\hbar\\omega/k_B T}}{(e^{\\hbar\\omega/k_B T} - 1)^2} \\right] v^2 \\tau(\\omega, T) \\left[ \\frac{3\\omega^2}{2\\pi^2 v^3} \\right] d\\omega $$\nSimplifying this expression gives:\n$$ \\kappa(T) = \\frac{k_B}{2\\pi^2 v} \\int_0^{\\omega_D} \\tau(\\omega, T) \\omega^2 \\left( \\frac{\\hbar\\omega}{k_B T} \\right)^2 \\frac{e^{\\hbar\\omega/k_B T}}{(e^{\\hbar\\omega/k_B T} - 1)^2} d\\omega $$\nTo make the integral dimensionless and numerically tractable, we introduce the variable $x = \\hbar\\omega/k_B T$. This gives $\\omega = (k_B T/\\hbar)x$ and $d\\omega = (k_B T/\\hbar)dx$. The upper integration limit becomes $x_D = \\hbar\\omega_D/k_B T = \\Theta_D/T$. Substituting and simplifying leads to the final integral form:\n$$ \\kappa(T) = \\frac{k_B}{2\\pi^2 v} \\left( \\frac{k_B T}{\\hbar} \\right)^3 \\int_0^{\\Theta_D/T} \\tau(x, T) \\frac{x^4 e^x}{(e^x-1)^2} dx $$\nThe total relaxation time $\\tau$ is determined by combining the rates of different scattering mechanisms using Matthiessen's rule: $\\tau^{-1} = \\sum_i \\tau_i^{-1}$. The problem specifies three mechanisms:\n$1$. Umklapp scattering: $\\tau_{U}^{-1} = A \\omega^2 T \\exp(-\\Theta_D/(bT))$\n$2$. Point-defect (impurity) scattering: $\\tau_{I}^{-1} = B \\omega^4$\n$3$. Boundary scattering: $\\tau_{B}^{-1} = v/L$\nHere, $A$, $b$, and $B$ are the fitting parameters. Expressing the total scattering rate $\\tau^{-1}$ in terms of the dimensionless variable $x$:\n$$ \\tau^{-1}(x, T) = \\tau_U^{-1} + \\tau_I^{-1} + \\tau_B^{-1} = A T \\left(\\frac{k_B T x}{\\hbar}\\right)^2 e^{-\\Theta_D/(bT)} + B \\left(\\frac{k_B T x}{\\hbar}\\right)^4 + \\frac{v}{L} $$\n$$ \\tau^{-1}(x, T) = A \\left(\\frac{k_B}{\\hbar}\\right)^2 T^3 e^{-\\Theta_D/(bT)} x^2 + B \\left(\\frac{k_B}{\\hbar}\\right)^4 T^4 x^4 + \\frac{v}{L} $$\nThis expression for $\\tau = 1/\\tau^{-1}$ is substituted into the integral for $\\kappa(T)$.\n\nThe algorithmic design for solving the problem is as follows:\n$1$. **Numerical Calculation of $\\kappa(T)$**: A Python function is implemented to compute $\\kappa(T)$ for a given set of parameters $(T, A, b, B, L)$ and physical constants. This function defines the integrand as derived above and uses the `scipy.integrate.quad` routine for numerical quadrature to evaluate the definite integral.\n\n$2$. **Synthetic Data Generation**: For each of the three specified scenarios, synthetic \"experimental\" data points $(\\kappa(T_i), T_i)$ are generated by calling the function from step $1$ with the provided true parameters $(A_{\\text{true}}, b_{\\text{true}}, B_{\\text{true}})$ and characteristic length $L$.\n\n$3$. **Parameter Fitting**: The `scipy.optimize.curve_fit` function is employed to perform a nonlinear least-squares fit. For each dataset, it minimizes the sum of squared differences between the synthetic $\\kappa(T_i)$ values and the values predicted by the model. The function seeks the optimal parameters $(\\hat{A}, \\hat{b}, \\hat{B})$ that best reproduce the data. The problem specifies physical constraints on the parameters ($A>0$, $B>0$, and $1 \\le b \\le 10$), which are imposed as bounds during the fitting process.\n\n$4$. **Output Formatting**: The fitted parameters $(\\hat{A}, \\hat{b}, \\hat{B})$ for each of the three datasets are rounded to three significant figures and formatted into the required list-of-lists structure for the final output. The rounding is handled programmatically to ensure precision.\n\nThis structured approach ensures that the solution is derived from first principles, implemented correctly, and validated by fitting to self-generated data, fulfilling all requirements of the problem statement.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Derives, implements, and calibrates a model for lattice thermal conductivity.\n    \"\"\"\n\n    # Physical constants in SI units\n    K_B = 1.380649e-23  # Boltzmann constant (J/K)\n    HBAR = 1.054571817e-34 # Reduced Planck constant (J*s)\n    THETA_D = 645.0      # Debye temperature (K)\n    V = 6400.0         # Average phonon group velocity (m/s)\n\n    def round_to_sf(x, sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        # Use scientific notation formatting to control significant figures\n        return float(f\"{x:.{sf-1}e}\")\n\n    def kappa_integrand(x, T, A, b, B, L):\n        \"\"\"\n        The integrand for the thermal conductivity integral.\n        \"\"\"\n        # The term is ill-defined at x=0, but its limit is 0.\n        if x <= 1e-9:\n            return 0.0\n\n        # Phonon relaxation time (tau) is the inverse of the sum of scattering rates.\n        # 1. Umklapp scattering rate\n        tau_inv_U = A * T**3 * (K_B / HBAR)**2 * np.exp(-THETA_D / (b * T)) * x**2\n        # 2. Impurity (Rayleigh) scattering rate\n        tau_inv_I = B * T**4 * (K_B / HBAR)**4 * x**4\n        # 3. Boundary scattering rate\n        tau_inv_B = V / L\n        \n        total_tau_inv = tau_inv_U + tau_inv_I + tau_inv_B\n        \n        # This safeguard should not be triggered with L > 0.\n        if total_tau_inv <= 0:\n            return np.inf  # Represents infinite relaxation time\n\n        tau = 1.0 / total_tau_inv\n        \n        # The x-dependent part from heat capacity and density of states\n        # The term is x^4 * exp(x) / (exp(x)-1)^2\n        ex = np.exp(x)\n        heat_capacity_term = (x**4 * ex) / (ex - 1)**2\n\n        return tau * heat_capacity_term\n\n    def kappa_model(T_arr, A, b, B, L):\n        \"\"\"\n        Computes the lattice thermal conductivity kappa(T) for an array of temperatures.\n        \"\"\"\n        T_arr = np.atleast_1d(T_arr)\n        k_vals = np.zeros_like(T_arr, dtype=float)\n        \n        prefactor = (K_B / (2 * np.pi**2 * V)) * (K_B / HBAR)**3\n\n        for i, T in enumerate(T_arr):\n            if T <= 0:\n                k_vals[i] = 0.0\n                continue\n            \n            x_D = THETA_D / T\n            \n            args = (T, A, b, B, L)\n            # Perform numerical integration with increased precision\n            integral_val, _ = quad(kappa_integrand, 0, x_D, args=args, limit=200, epsabs=1e-12, epsrel=1e-12)\n            \n            k_vals[i] = prefactor * T**3 * integral_val\n            \n        return k_vals\n    \n    # Define the three synthetic datasets and their ground-truth parameters\n    test_cases = [\n        {\n            'L': 1e-3, \n            'params': (2.0e-19, 3.0, 1.0e-45), \n            'T': np.array([20, 50, 100, 150, 200, 250, 300])\n        },\n        {\n            'L': 1e-6, \n            'params': (2.0e-19, 3.0, 1.0e-45), \n            'T': np.array([20, 50, 100, 150, 200, 250, 300])\n        },\n        {\n            'L': 1e-3,\n            'params': (2.0e-19, 3.0, 5.0e-44),\n            'T': np.array([20, 50, 100, 150, 200, 250, 300])\n        },\n    ]\n\n    all_fitted_params = []\n    \n    for case in test_cases:\n        L = case['L']\n        true_params = case['params']\n        T_data = case['T']\n\n        # 1. Generate synthetic \"experimental\" data using the model\n        kappa_data = kappa_model(T_data, *true_params, L=L)\n\n        # 2. Define the model function for curve_fit, capturing the fixed L\n        def model_for_fit(T_arr, A, b, B):\n            return kappa_model(T_arr, A, b, B, L=L)\n\n        # 3. Set bounds and initial guess for the fitting procedure\n        bounds = ([0, 1, 0], [np.inf, 10, np.inf])\n        # Use true parameters as the initial guess to ensure robust convergence\n        p0 = true_params\n\n        # 4. Perform the nonlinear least-squares fit\n        popt, _ = curve_fit(model_for_fit, T_data, kappa_data, p0=p0, bounds=bounds, method='trf', max_nfev=5000)\n\n        # 5. Round the fitted parameters to 3 significant figures and store\n        rounded_params = [round_to_sf(p, 3) for p in popt]\n        all_fitted_params.append(rounded_params)\n\n    # 6. Format the final output string to match the required format exactly\n    # e.g., [[1.23e-19,3.0,1.0e-45],[...],[...]], with no whitespace.\n    outer_list_str_parts = []\n    for params in all_fitted_params:\n        inner_str = f\"[{','.join(map(str, params))}]\"\n        outer_list_str_parts.append(inner_str)\n    final_output_str = f\"[{','.join(outer_list_str_parts)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2514903"}, {"introduction": "The familiar Fourier's law of heat diffusion is a powerful tool, but it is an approximation that breaks down when the length and time scales of heating are comparable to the phonon mean free path and relaxation time. This practice delves into the validity of different transport models by comparing the predictions of Fourier's law, the Cattaneo equation, and the full Boltzmann Transport Equation for a transient heating scenario [@problem_id:2514922]. By numerically exploring transport from the diffusive to the ballistic regime, you will gain a quantitative understanding of when non-Fourier effects become dominant and why the BTE is the ultimate arbiter.", "problem": "Consider a one-dimensional crystalline medium subject to spatially periodic, impulsive heating that produces an initial temperature field of the form $T(x,0)=T_{0}+\\Delta T_{0}\\cos(q x)$, where $q$ is the wave number. Assume the phonon system can be modeled in three different ways: the diffusive model based on Fourier’s law, the hyperbolic model based on the Maxwell–Cattaneo–Vernotte law, and the gray phonon Boltzmann Transport Equation (BTE) under the Relaxation Time Approximation (RTA). Your task is to derive, implement, and compare the temporal decay of the cosine temperature amplitude at $x=0$ predicted by these models for a pulsed heating scenario, and to identify which continuum model is most accurate relative to the BTE prediction in each test case.\n\nStart from the following fundamental bases:\n- Energy conservation for a rigid solid with volumetric heat capacity $C$: $\\frac{\\partial T}{\\partial t}+\\frac{1}{C}\\frac{\\partial q}{\\partial x}=0$.\n- Fourier’s law: $q=-k\\,\\frac{\\partial T}{\\partial x}$, where $k$ is the thermal conductivity and $\\alpha=k/C$ is the thermal diffusivity.\n- Maxwell–Cattaneo–Vernotte (Cattaneo) law: $q+\\tau\\,\\frac{\\partial q}{\\partial t}=-k\\,\\frac{\\partial T}{\\partial x}$, with relaxation time $\\tau$ giving a finite thermal wave speed $c_{\\mathrm{th}}=\\sqrt{\\alpha/\\tau}$.\n- Gray phonon BTE under the Relaxation Time Approximation for the deviational energy density per direction $g(\\mu,t)$ in one spatial dimension with direction cosine $\\mu\\in[-1,1]$: $\\frac{\\partial g}{\\partial t}+v\\,\\mu\\,\\frac{\\partial g}{\\partial x}=-\\frac{g-T}{\\tau}$, where $v$ is an average phonon group velocity and $\\Lambda=v\\tau$ is the mean free path.\n\nTasks:\n1) For the Fourier model, insert the separable ansatz $T(x,t)=A_{\\mathrm{F}}(t)\\cos(qx)$ into the conservation law with Fourier’s law and derive an ordinary differential equation for $A_{\\mathrm{F}}(t)$ in terms of $q$ and $\\alpha$. Specify the initial conditions implied by $T(x,0)=T_{0}+\\Delta T_{0}\\cos(qx)$ and give the closed-form expression for $A_{\\mathrm{F}}(t)$ normalized by $\\Delta T_{0}$.\n\n2) For the Cattaneo model, combine energy conservation with the Maxwell–Cattaneo–Vernotte law and insert $T(x,t)=A_{\\mathrm{C}}(t)\\cos(qx)$ to derive the governing ordinary differential equation for $A_{\\mathrm{C}}(t)$ involving $\\tau$, $\\alpha$, and $q$. Specify the initial conditions for $A_{\\mathrm{C}}(t)$ and $\\frac{d A_{\\mathrm{C}}}{dt}(t)$ at $t=0$ implied by zero initial heat flux and give the corresponding closed-form expression for $A_{\\mathrm{C}}(t)$ normalized by $\\Delta T_{0}$, treating the overdamped, critically damped, and underdamped cases in a unified way.\n\n3) For the gray phonon BTE in one dimension under the Relaxation Time Approximation, transform to the spatial-frequency domain using $T(x,t)=A_{\\mathrm{B}}(t)\\cos(qx)$ and define $g(\\mu,t)$ as the directional deviational energy amplitude associated with that spatial harmonic. Discretize the angular domain $\\mu\\in[-1,1]$ using an $N$-point Gauss–Legendre quadrature with abscissae $\\{\\mu_{m}\\}$ and weights $\\{w_{m}\\}$ satisfying $\\sum_{m=1}^{N}w_{m}=2$. Show that the discretized evolution for the vector $\\mathbf{g}(t)=[g(\\mu_{1},t),\\dots,g(\\mu_{N},t)]^{\\mathsf{T}}$ can be written as a linear system\n$$\n\\frac{d\\mathbf{g}}{dt}=\\mathbf{M}\\,\\mathbf{g},\\quad\n\\mathbf{M}=-\\mathrm{diag}\\left(\\frac{1}{\\tau}+i\\,v\\,q\\,\\mu_{m}\\right)+\\frac{1}{2\\tau}\\,\\mathbf{1}\\,\\mathbf{w}^{\\mathsf{T}},\n$$\nwhere $\\mathbf{1}$ is the vector of ones and $\\mathbf{w}=[w_{1},\\dots,w_{N}]^{\\mathsf{T}}$. The temperature amplitude is then $A_{\\mathrm{B}}(t)=\\frac{1}{2}\\sum_{m=1}^{N}w_{m}\\,g(\\mu_{m},t)$, with initial condition $g(\\mu_{m},0)=\\Delta T_{0}$ for all $m$. Explain how to compute $A_{\\mathrm{B}}(t)$ from the matrix exponential of $\\mathbf{M}$.\n\n4) Using the constitutive consistency $\\alpha=\\frac{v^{2}\\tau}{3}$ for an isotropic gray model, numerically evaluate $A_{\\mathrm{F}}(t)$, $A_{\\mathrm{C}}(t)$, and $A_{\\mathrm{B}}(t)$ at the three times $t\\in\\{0.2\\,\\tau,\\,1.0\\,\\tau,\\,5.0\\,\\tau\\}$, each normalized by $\\Delta T_{0}$, and compute the root-mean-square error of the continuum models relative to the BTE prediction:\n$$\n\\varepsilon_{\\mathrm{F}}=\\sqrt{\\frac{1}{3}\\sum_{j=1}^{3}\\left(A_{\\mathrm{F}}(t_{j})-A_{\\mathrm{B}}(t_{j})\\right)^{2}},\\quad\n\\varepsilon_{\\mathrm{C}}=\\sqrt{\\frac{1}{3}\\sum_{j=1}^{3}\\left(A_{\\mathrm{C}}(t_{j})-A_{\\mathrm{B}}(t_{j})\\right)^{2}}.\n$$\nDeclare the more accurate continuum model for each case as the one with the smaller error.\n\n5) Define the following test suite (all quantities in SI units, angles in radians, temperatures in kelvin, and times in seconds). Use $N=16$ angular points for the Gauss–Legendre quadrature in the BTE calculation and set $\\Delta T_{0}=1$ for normalization:\n- Case A (diffusive regime): $v=4000$, $\\tau=2\\times 10^{-10}$, grating period $L=1.0\\times 10^{-4}$ so that $q=2\\pi/L$.\n- Case B (near critical telegraph boundary): $v=4000$, $\\tau=2\\times 10^{-10}$, $L=5.711986\\times 10^{-6}$ (so $q\\approx 1.1\\times 10^{6}$).\n- Case C (quasi-ballistic): $v=4000$, $\\tau=2\\times 10^{-10}$, $L=2.513274\\times 10^{-6}$ (so $q\\approx 2.5\\times 10^{6}$).\n- Case D (ballistic-dominated): $v=4000$, $\\tau=2\\times 10^{-10}$, $L=2.513274\\times 10^{-7}$ (so $q\\approx 2.5\\times 10^{7}$).\n\nRegime identification and accuracy expectation should be discussed using the nondimensional parameter $\\eta=v\\,q\\,\\tau$ and its relationship to $\\alpha$ via $\\alpha=\\frac{v^{2}\\tau}{3}$. Explicitly state which continuum model is closer to the BTE in each case by numerical comparison.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list of integers enclosed in square brackets, where each integer corresponds to a test case in the order A, B, C, D and indicates the more accurate continuum model relative to the BTE: use $0$ for Fourier and $1$ for Cattaneo. For example, an output like $[0,1,1,1]$ means Fourier is closer in Case A while Cattaneo is closer in Cases B–D.", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the established principles of non-equilibrium heat transport, well-posed with sufficient information for a unique solution, and phrased in objective, formal language free of contradictions or ambiguities. Proceeding to solution.\n\nThe analysis of temperature decay for a spatially periodic initial condition, $T(x,0)=T_{0}+\\Delta T_{0}\\cos(q x)$, is performed for three distinct models of phonon transport. The constant offset $T_{0}$ is static and does not participate in the dynamics. We analyze the evolution of the perturbation amplitude, initially $\\Delta T_{0}$. For simplicity and without loss of generality, we set $\\Delta T_{0}=1$ in the normalized derivations.\n\n**1. Fourier's Law (Diffusive Model)**\n\nThe fundamental equations are the conservation of energy and Fourier's law of heat conduction:\n$$\n\\frac{\\partial T}{\\partial t}+\\frac{1}{C}\\frac{\\partial q}{\\partial x}=0\n$$\n$$\nq=-k\\,\\frac{\\partial T}{\\partial x}\n$$\nwhere $T$ is temperature, $q$ is heat flux, $C$ is volumetric heat capacity, and $k$ is thermal conductivity. Combining these yields the classical heat diffusion equation:\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k}{C}\\frac{\\partial^2 T}{\\partial x^2} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nHere, $\\alpha$ is the thermal diffusivity. We introduce the separable ansatz for the temperature perturbation, $T(x,t) - T_0 = A_{\\mathrm{F}}(t)\\cos(qx)$. Substituting this into the heat equation gives:\n$$\n\\frac{d A_{\\mathrm{F}}(t)}{dt}\\cos(qx) = \\alpha A_{\\mathrm{F}}(t)(-q^2\\cos(qx))\n$$\nThis simplifies to a first-order ordinary differential equation (ODE) for the amplitude $A_{\\mathrm{F}}(t)$:\n$$\n\\frac{d A_{\\mathrm{F}}(t)}{dt} = -(\\alpha q^2) A_{\\mathrm{F}}(t)\n$$\nThe initial condition is $T(x,0) - T_0 = \\Delta T_{0}\\cos(qx)$, which implies $A_{\\mathrm{F}}(0) = \\Delta T_{0}$. The solution to this initial value problem is a simple exponential decay:\n$$\nA_{\\mathrm{F}}(t) = \\Delta T_{0} \\, e^{-\\alpha q^2 t}\n$$\nThe normalized amplitude is therefore:\n$$\n\\frac{A_{\\mathrm{F}}(t)}{\\Delta T_{0}} = e^{-\\alpha q^2 t}\n$$\n\n**2. Maxwell–Cattaneo–Vernotte Law (Hyperbolic Model)**\n\nThis model replaces Fourier's law with the Cattaneo relation to account for a finite relaxation time $\\tau$ in the heat flux response:\n$$\nq+\\tau\\,\\frac{\\partial q}{\\partial t}=-k\\,\\frac{\\partial T}{\\partial x}\n$$\nCombining this with energy conservation leads to the hyperbolic heat equation, also known as the telegrapher's equation:\n$$\n\\frac{\\partial^2 T}{\\partial t^2} + \\frac{1}{\\tau}\\frac{\\partial T}{\\partial t} = \\frac{\\alpha}{\\tau}\\frac{\\partial^2 T}{\\partial x^2}\n$$\nAgain, substituting the ansatz $T(x,t) - T_0 = A_{\\mathrm{C}}(t)\\cos(qx)$ yields the ODE for the amplitude $A_{\\mathrm{C}}(t)$:\n$$\n\\frac{d^2 A_{\\mathrm{C}}(t)}{dt^2} + \\frac{1}{\\tau}\\frac{d A_{\\mathrm{C}}(t)}{dt} + \\frac{\\alpha q^2}{\\tau} A_{\\mathrm{C}}(t) = 0\n$$\nThis is a second-order linear homogeneous ODE. The initial conditions are $A_{\\mathrm{C}}(0) = \\Delta T_{0}$ from the initial temperature profile, and $\\frac{d A_{\\mathrm{C}}}{dt}(0) = 0$, which follows from the condition of zero initial heat flux, $q(x,0)=0$, and the energy conservation equation. The characteristic equation is $r^2 + \\frac{1}{\\tau}r + \\frac{\\alpha q^2}{\\tau} = 0$, with roots:\n$$\nr_{1,2} = -\\frac{1}{2\\tau} \\pm \\sqrt{\\left(\\frac{1}{2\\tau}\\right)^2 - \\frac{\\alpha q^2}{\\tau}} = -\\frac{1}{2\\tau} \\pm \\frac{1}{2\\tau}\\sqrt{1 - 4\\alpha\\tau q^2}\n$$\nThe general solution for $A_{\\mathrm{C}}(t)$ that satisfies the initial conditions can be expressed in a unified form that accommodates all damping regimes (overdamped, critically damped, and underdamped):\n$$\n\\frac{A_{\\mathrm{C}}(t)}{\\Delta T_{0}} = \\frac{r_2 e^{r_1 t} - r_1 e^{r_2 t}}{r_2 - r_1}\n$$\nThis expression can be implemented numerically. For analytical clarity, one can distinguish three cases based on the discriminant $D = 1 - 4\\alpha\\tau q^2$:\n- **Overdamped ($D > 0$):** $A_{\\mathrm{C}}(t)/\\Delta T_{0} = e^{-t/2\\tau} \\left(\\cosh(\\beta t) + \\frac{1}{2\\tau\\beta}\\sinh(\\beta t)\\right)$, where $\\beta = \\frac{1}{2\\tau}\\sqrt{D}$.\n- **Underdamped ($D  0$):** $A_{\\mathrm{C}}(t)/\\Delta T_{0} = e^{-t/2\\tau} \\left(\\cos(\\omega t) + \\frac{1}{2\\tau\\omega}\\sin(\\omega t)\\right)$, where $\\omega = \\frac{1}{2\\tau}\\sqrt{-D}$.\n- **Critically damped ($D = 0$):** $A_{\\mathrm{C}}(t)/\\Delta T_{0} = \\left(1 + \\frac{t}{2\\tau}\\right) e^{-t/2\\tau}$.\n\n**3. Gray Phonon Boltzmann Transport Equation (BTE)**\n\nThe BTE under the Relaxation Time Approximation (RTA) for the deviational energy distribution $g(\\mu,x,t)$ is given as:\n$$\n\\frac{\\partial g}{\\partial t}+v\\,\\mu\\,\\frac{\\partial g}{\\partial x}=-\\frac{g-T}{\\tau}\n$$\nwhere $T(x,t) = \\frac{1}{2}\\int_{-1}^{1} g(\\mu,x,t) d\\mu$. To analyze the evolution of a single spatial Fourier mode, we use a complex representation, seeking a solution of the form $g(\\mu,x,t) = \\hat{g}(\\mu,t) e^{iqx}$. Substituting into the BTE gives an integro-differential equation for the complex amplitude $\\hat{g}(\\mu,t)$:\n$$\n\\frac{\\partial \\hat{g}}{\\partial t} = -\\left(\\frac{1}{\\tau} + ivq\\mu\\right)\\hat{g} + \\frac{1}{2\\tau}\\int_{-1}^{1} \\hat{g}(\\mu',t)d\\mu'\n$$\nDiscretizing the angular domain $\\mu \\in [-1,1]$ with an $N$-point Gauss-Legendre quadrature (abscissae $\\{\\mu_{m}\\}$, weights $\\{w_{m}\\}$) transforms this into a system of $N$ coupled linear ODEs. Let $\\mathbf{g}(t) = [\\hat{g}(\\mu_1,t), \\dots, \\hat{g}(\\mu_N,t)]^{\\mathsf{T}}$. The system is $\\frac{d\\mathbf{g}}{dt} = \\mathbf{M}\\mathbf{g}$, with the complex matrix $\\mathbf{M}$ given by:\n$$\n\\mathbf{M}=-\\mathrm{diag}\\left(\\frac{1}{\\tau}+i\\,v\\,q\\,\\mu_{m}\\right)+\\frac{1}{2\\tau}\\,\\mathbf{1}\\,\\mathbf{w}^{\\mathsf{T}}\n$$\nwhere $\\mathbf{1}$ is the column vector of ones and $\\mathbf{w} = [w_1, \\dots, w_N]^{\\mathsf{T}}$. The initial condition $T(x,0) - T_0 = \\Delta T_0 \\cos(qx)$ corresponds to a spatially periodic, isotropic initial distribution, meaning $\\hat{g}(\\mu,0) = \\Delta T_0$ for all $\\mu$. Thus, the initial condition vector is $\\mathbf{g}(0) = \\Delta T_0 \\mathbf{1}$.\n\nThe solution to this linear system is given by the matrix exponential:\n$$\n\\mathbf{g}(t) = e^{\\mathbf{M}t}\\mathbf{g}(0) = \\Delta T_0 e^{\\mathbf{M}t}\\mathbf{1}\n$$\nThe complex amplitude of the temperature mode is $\\hat{T}(q,t) = \\frac{1}{2}\\sum_{m=1}^{N} w_m \\hat{g}(\\mu_m,t) = \\frac{1}{2}\\mathbf{w}^\\mathsf{T}\\mathbf{g}(t)$. The physical temperature field for the cosine mode is $A_{\\mathrm{B}}(t)\\cos(qx)$, where $A_{\\mathrm{B}}(t)$ is the real part of the complex amplitude $\\hat{T}(q,t)$. The normalized amplitude is:\n$$\n\\frac{A_{\\mathrm{B}}(t)}{\\Delta T_{0}} = \\mathrm{Re}\\left(\\frac{1}{2}\\mathbf{w}^\\mathsf{T} e^{\\mathbf{M}t} \\mathbf{1}\\right)\n$$\nThis is computed numerically for each required time $t$.\n\n**4. Numerical Comparison Methodology**\n\nThe models are compared using the relation $\\alpha = \\frac{1}{3} v^2 \\tau$, which connects the macroscopic diffusivity to the microscopic phonon properties ($v$, $\\tau$). The comparison is performed for four cases distinguished by the grating wave number $q$, which can be characterized by the dimensionless parameter $\\eta=vq\\tau = \\Lambda q$, where $\\Lambda=v\\tau$ is the phonon mean free path.\n- Case A ($\\eta \\approx 0.05$): Diffusive regime ($\\Lambda \\ll 1/q$). Fourier's law is expected to be accurate.\n- Case B ($\\eta \\approx 0.88$): Transition regime, near the critical damping boundary for the Cattaneo model ($\\eta \\approx \\sqrt{3}/2 \\approx 0.866$).\n- Case C ($\\eta = 2.0$): Quasi-ballistic regime ($\\Lambda > 1/q$).\n- Case D ($\\eta = 20.0$): Ballistic-dominated regime ($\\Lambda \\gg 1/q$).\n\nIn regimes where $\\eta$ is not small, the diffusive approximation breaks down, and the wave-like character captured by the Cattaneo model and inherent to the BTE becomes significant. We expect the Cattaneo model to be more accurate than the Fourier model for $\\eta \\gtrsim 1$. The root-mean-square error metric $\\varepsilon$ is computed for the Fourier and Cattaneo models relative to the BTE solution, which serves as the benchmark. The model yielding the smaller error is deemed more accurate for that case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Solves the heat transport problem for four test cases, comparing Fourier,\n    Cattaneo, and BTE models, and determines the more accurate continuum model.\n    \"\"\"\n    \n    # Define physical constants and problem setup\n    v = 4000.0  # m/s\n    tau = 2.0e-10  # s\n    N_quad = 16  # Number of Gauss-Legendre quadrature points\n    delta_T0 = 1.0 # Initial temperature amplitude for normalization\n\n    # Derived thermal diffusivity, consistent for all models\n    alpha = v**2 * tau / 3.0\n\n    # Dimensionless times for evaluation\n    t_points_factor = np.array([0.2, 1.0, 5.0])\n    t_points = t_points_factor * tau\n\n    # Define the test cases from the problem statement\n    # Each case is defined by the grating period L, which gives q=2*pi/L\n    test_cases_L = [\n        1.0e-4,          # Case A: Diffusive\n        5.711986e-6,     # Case B: Near critical\n        2.513274e-6,     # Case C: Quasi-ballistic\n        2.513274e-7      # Case D: Ballistic-dominated\n    ]\n    test_cases_q = [2.0 * np.pi / L for L in test_cases_L]\n\n    def solve_fourier(t_vec, alpha_p, q_p):\n        \"\"\"Calculates normalized temperature amplitude for Fourier model.\"\"\"\n        return np.exp(-alpha_p * q_p**2 * t_vec)\n\n    def solve_cattaneo(t_vec, alpha_p, tau_p, q_p):\n        \"\"\"Calculates normalized temperature amplitude for Cattaneo model.\"\"\"\n        results = []\n        # Discriminant determines the damping regime\n        discriminant = 1.0 - 4.0 * alpha_p * tau_p * q_p**2\n        \n        # Use a small tolerance for floating point comparison\n        if discriminant  1e-9:  # Overdamped\n            beta = (1.0 / (2.0 * tau_p)) * np.sqrt(discriminant)\n            for t in t_vec:\n                val = np.exp(-t / (2.0 * tau_p)) * (np.cosh(beta * t) + np.sinh(beta * t) / (2.0 * tau_p * beta))\n                results.append(val)\n        elif discriminant  -1e-9:  # Underdamped\n            omega = (1.0 / (2.0 * tau_p)) * np.sqrt(-discriminant)\n            for t in t_vec:\n                val = np.exp(-t / (2.0 * tau_p)) * (np.cos(omega * t) + np.sin(omega * t) / (2.0 * tau_p * omega))\n                results.append(val)\n        else:  # Critically damped\n            for t in t_vec:\n                val = (1.0 + t / (2.0 * tau_p)) * np.exp(-t / (2.0 * tau_p))\n                results.append(val)\n                \n        return np.array(results)\n\n    def solve_bte(t_vec, v_p, tau_p, q_p, N_p):\n        \"\"\"Calculates normalized temperature amplitude for BTE model.\"\"\"\n        # Get Gauss-Legendre abscissae and weights for the interval [-1, 1]\n        mu, w = leggauss(N_p)\n        \n        # Construct the BTE evolution matrix M\n        diag_term = 1.0/tau_p + 1j * v_p * q_p * mu\n        M = -np.diag(diag_term) + (1.0 / (2.0 * tau_p)) * np.outer(np.ones(N_p), w)\n        \n        # Initial condition: g(mu, 0) = delta_T0\n        g0 = np.ones(N_p, dtype=np.complex128) * delta_T0\n        \n        results = []\n        for t in t_vec:\n            # Evolve the distribution function amplitude vector: g(t) = exp(M*t) * g0\n            exp_Mt = expm(M * t)\n            g_t = exp_Mt @ g0\n            \n            # Complex temperature amplitude: T_hat(q,t) = 0.5 * integral(g dmu)\n            T_hat = 0.5 * np.dot(w, g_t)\n            \n            # The physical cosine amplitude is the real part of T_hat\n            A_B = T_hat.real\n            results.append(A_B)\n            \n        # Normalize by the initial amplitude\n        return np.array(results) / delta_T0\n\n    final_results = []\n    for q_val in test_cases_q:\n        # BTE solution serves as the reference benchmark\n        A_B = solve_bte(t_points, v, tau, q_val, N_quad)\n        \n        # Fourier model solution\n        A_F = solve_fourier(t_points, alpha, q_val)\n        \n        # Cattaneo model solution\n        A_C = solve_cattaneo(t_points, alpha, tau, q_val)\n        \n        # Compute root-mean-square errors relative to BTE\n        err_F = np.sqrt(np.mean((A_F - A_B)**2))\n        err_C = np.sqrt(np.mean((A_C - A_B)**2))\n        \n        # Compare errors and determine the more accurate model\n        if err_F  err_C:\n            final_results.append(0)  # 0 indicates Fourier model is better\n        else:\n            final_results.append(1)  # 1 indicates Cattaneo model is better\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "2514922"}]}