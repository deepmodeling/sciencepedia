{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with a foundational problem in reaction-diffusion theory. This exercise involves deriving the steady-state concentration profile of a species that both diffuses and reacts within a simple planar geometry. By solving the governing differential equation, you will develop a concrete understanding of how the interplay between molecular diffusion and a first-order chemical reaction shapes the concentration landscape and gives rise to a characteristic penetration depth [@problem_id:2503815].", "problem": "A reactive solute species $A$ undergoes steady diffusion and a first-order homogeneous reaction $A \\to P$ within a planar slab occupying $0 \\le y \\le L$. The system is isothermal, properties are constant, there is no bulk flow, and transport is one-dimensional in $y$. The effective diffusivity is $D$ and the homogeneous reaction rate is $r_A = -k\\,c_A$ with $k>0$. The interface at $y=0$ is maintained at concentration $c_A(0)=c_{A0}$, and the opposite face at $y=L$ is perfectly depleting, so $c_A(L)=0$. Starting from the steady species balance with Fick’s law, derive the governing ordinary differential equation and solve for the closed-form concentration profile $c_A(y)$ that satisfies the boundary conditions. Using a dominant-balance argument, define and interpret a characteristic penetration depth in terms of $D$ and $k$, and explain its physical meaning in the context of the profile you obtained. Express your final concentration profile $c_A(y)$ as a single closed-form analytic expression in terms of $y$, $L$, $D$, $k$, and $c_{A0}$. No numerical rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard problem in reaction-diffusion theory and is fully specified with consistent data and boundary conditions. Therefore, we may proceed with the derivation and solution.\n\nThe starting point is the general differential equation for species conservation. For a species $A$, this is expressed as:\n$$\n\\frac{\\partial c_A}{\\partial t} + \\nabla \\cdot \\mathbf{N}_A = R_A\n$$\nwhere $c_A$ is the molar concentration of species $A$, $t$ is time, $\\mathbf{N}_A$ is the molar flux of $A$, and $R_A$ is the volumetric rate of production of $A$.\n\nWe apply the conditions given in the problem statement:\n1.  The system is at steady state, so all time derivatives are zero: $\\frac{\\partial c_A}{\\partial t} = 0$.\n2.  Transport is one-dimensional in the $y$ direction, so the divergence operator simplifies to $\\nabla \\cdot \\mathbf{N}_A = \\frac{dN_{A,y}}{dy}$.\n3.  There is no bulk flow, so the molar flux $\\mathbf{N}_A$ is described solely by Fick's law of diffusion: $\\mathbf{N}_A = -D \\nabla c_A$. In one dimension, this becomes $N_{A,y} = -D \\frac{dc_A}{dy}$. The diffusivity $D$ is constant.\n4.  The homogeneous reaction is $A \\to P$ with a rate $r_A = -k c_A$. This is the rate of formation of species $A$, which is negative because $A$ is consumed. The production term $R_A$ in the species balance is therefore $R_A = -k c_A$.\n\nSubstituting these conditions into the general conservation equation yields:\n$$\n\\frac{d}{dy}\\left(-D \\frac{dc_A}{dy}\\right) = -k c_A\n$$\nSince the diffusivity $D$ is constant, we can write the equation as:\n$$\n-D \\frac{d^2c_A}{dy^2} = -k c_A\n$$\nRearranging this gives the governing ordinary differential equation (ODE) for the concentration profile $c_A(y)$:\n$$\n\\frac{d^2c_A}{dy^2} - \\frac{k}{D} c_A = 0\n$$\nThis is a second-order linear homogeneous ODE with constant coefficients. The characteristic equation is $m^2 - \\frac{k}{D} = 0$, which has roots $m_{1,2} = \\pm\\sqrt{\\frac{k}{D}}$. The general solution can be written in terms of exponential functions or, more conveniently for this problem, hyperbolic functions:\n$$\nc_A(y) = C_1 \\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) + C_2 \\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right)\n$$\nThe constants of integration, $C_1$ and $C_2$, are determined by the boundary conditions:\n1.  At $y=0$, the concentration is $c_A(0) = c_{A0}$.\n2.  At $y=L$, the concentration is $c_A(L) = 0$.\n\nApplying the first boundary condition at $y=0$:\n$$\nc_{A0} = C_1 \\cosh(0) + C_2 \\sinh(0) = C_1 \\cdot 1 + C_2 \\cdot 0 \\implies C_1 = c_{A0}\n$$\nThe solution thus becomes:\n$$\nc_A(y) = c_{A0} \\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) + C_2 \\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right)\n$$\nApplying the second boundary condition at $y=L$:\n$$\n0 = c_{A0} \\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right) + C_2 \\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)\n$$\nSolving for $C_2$:\n$$\nC_2 = -c_{A0} \\frac{\\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)}\n$$\nSubstituting $C_1$ and $C_2$ back into the solution gives:\n$$\nc_A(y) = c_{A0} \\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) - c_{A0} \\frac{\\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)} \\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right)\n$$\nThis expression can be simplified by combining the terms over a common denominator:\n$$\nc_A(y) = \\frac{c_{A0}}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)} \\left[ \\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)\\cosh\\left(\\sqrt{\\frac{k}{D}} y\\right) - \\cosh\\left(\\sqrt{\\frac{k}{D}} L\\right)\\sinh\\left(\\sqrt{\\frac{k}{D}} y\\right) \\right]\n$$\nUsing the hyperbolic identity $\\sinh(a-b) = \\sinh(a)\\cosh(b) - \\cosh(a)\\sinh(b)$, with $a = \\sqrt{\\frac{k}{D}}L$ and $b = \\sqrt{\\frac{k}{D}}y$, we obtain the final closed-form solution for the concentration profile:\n$$\nc_A(y) = c_{A0} \\frac{\\sinh\\left(\\sqrt{\\frac{k}{D}}(L-y)\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}}L\\right)}\n$$\nNext, we define and interpret the characteristic penetration depth using a dominant-balance argument. The governing ODE is $D \\frac{d^2c_A}{dy^2} - k c_A = 0$. The two terms represent diffusion ($D \\frac{d^2c_A}{dy^2}$) and reaction ($-k c_A$). A characteristic length scale emerges where these two processes are of comparable magnitude. Let $\\delta$ be this characteristic length scale. We can approximate the second derivative as $\\frac{d^2c_A}{dy^2} \\sim \\frac{c_{A0}}{\\delta^2}$ and the concentration as $c_A \\sim c_{A0}$. The balance of the two terms is then:\n$$\nD \\frac{c_{A0}}{\\delta^2} \\sim k c_{A0}\n$$\nSolving for $\\delta$ gives the characteristic penetration depth:\n$$\n\\delta = \\sqrt{\\frac{D}{k}}\n$$\nThe physical meaning of this penetration depth is the characteristic distance over which the diffusing species $A$ can penetrate into the slab before it is significantly consumed by the chemical reaction. It is a measure of the competition between diffusion (which transports the species) and reaction (which consumes it).\n\nThis interpretation is evident from the analytical solution obtained. The arguments of the hyperbolic sine functions are of the form $\\frac{y}{\\delta}$ and $\\frac{L}{\\delta}$. The dimensionless group $\\frac{L}{\\delta} = L\\sqrt{\\frac{k}{D}}$ is known as the Thiele modulus, which compares the rate of reaction to the rate of diffusion.\nIf $L \\ll \\delta$ (reaction is slow or diffusion is fast), then for small $x$, $\\sinh(x) \\approx x$. The concentration profile approaches:\n$$\nc_A(y) \\approx c_{A0} \\frac{\\sqrt{k/D}(L-y)}{\\sqrt{k/D}L} = c_{A0}\\left(1 - \\frac{y}{L}\\right)\n$$\nThis is a linear profile, which is the solution for pure diffusion with no reaction.\nIf $L \\gg \\delta$ (reaction is fast or diffusion is slow), then the reactant is consumed long before it reaches the end of the slab at $y=L$. For large $x$, $\\sinh(x) \\approx \\frac{1}{2}\\exp(x)$. The profile becomes:\n$$\nc_A(y) \\approx c_{A0} \\frac{\\frac{1}{2}\\exp\\left(\\frac{L-y}{\\delta}\\right)}{\\frac{1}{2}\\exp\\left(\\frac{L}{\\delta}\\right)} = c_{A0} \\exp\\left(-\\frac{y}{\\delta}\\right) = c_{A0} \\exp\\left(-y\\sqrt{\\frac{k}{D}}\\right)\n$$\nIn this regime, the concentration decays exponentially from the surface $y=0$ with a characteristic length $\\delta$. The boundary condition at $y=L$ has no influence on the concentration near $y=0$. Thus, $\\delta = \\sqrt{D/k}$ is precisely the length scale that dictates the decay of the concentration profile due to the reaction.", "answer": "$$\n\\boxed{c_{A0} \\frac{\\sinh\\left(\\sqrt{\\frac{k}{D}} (L-y)\\right)}{\\sinh\\left(\\sqrt{\\frac{k}{D}} L\\right)}}\n$$", "id": "2503815"}, {"introduction": "Building on the fundamental principles of reaction-diffusion, we now turn to a more practical scenario common in chemical engineering: gas absorption enhanced by a chemical reaction. This exercise uses the elegant framework of film theory to connect an experimentally measurable quantity—the enhancement factor—to the intrinsic kinetics of the reaction. By back-calculating the rate constant from transport data, you will practice a key skill in process characterization and also explore the limits of model identifiability [@problem_id:2503840].", "problem": "A sparingly soluble gaseous species $A$ is absorbed from a dilute gas into a liquid where it undergoes a homogeneous, irreversible, first-order reaction $A \\rightarrow \\text{products}$ with an intrinsic first-order rate constant $k$. Consider the liquid-side two-film description under steady state and isothermal conditions. Assume the liquid film has constant properties and that the solution is sufficiently lean so that the bulk liquid concentration at the edge of the film can be taken as $C_{A,b} \\approx 0$. An experiment measures an enhancement of the absorption flux due to reaction relative to purely physical absorption (reaction suppressed by an inhibitor under otherwise identical hydrodynamics). The measured enhancement factor is $E = 7.50$. The independently measured physical liquid-side mass transfer coefficient is $k_L = 2.00 \\times 10^{-5}$ m s$^{-1}$, and the molecular diffusivity of $A$ in the liquid is $D = 1.50 \\times 10^{-9}$ m$^{2}$ s$^{-1}$. For the back-calculation of the intrinsic rate constant, you may neglect gas-side resistance.\n\nUsing only fundamental conservation of mass in the liquid film with first-order reaction and Fickian diffusion, derive the relation connecting the enhancement factor $E$ to the intrinsic rate constant $k$ and the measured transport properties, and then invert it to compute the intrinsic rate constant $k$. Express the final intrinsic rate constant in s$^{-1}$ and round your answer to three significant figures.\n\nFinally, discuss, based on the two-film framework, whether $k$ remains uniquely identifiable from a measured $E$ if gas-side resistance is not negligible (qualitative reasoning is sufficient, but any symbols you use must be defined).", "solution": "The problem statement must first be rigorously validated.\n\nStep 1: Extracted Givens.\n- A sparingly soluble gaseous species $A$ is absorbed into a liquid.\n- A homogeneous, irreversible, first-order reaction $A \\rightarrow \\text{products}$ occurs in the liquid.\n- The intrinsic first-order reaction rate constant is $k$.\n- The analysis is based on the liquid-side two-film description at steady state and isothermal conditions.\n- The liquid film has constant properties.\n- The solution is sufficiently lean, and the bulk liquid concentration at the edge of the film is $C_{A,b} \\approx 0$.\n- The measured enhancement factor is $E = 7.50$.\n- The physical liquid-side mass transfer coefficient is $k_L = 2.00 \\times 10^{-5}$ m s$^{-1}$.\n- The molecular diffusivity of $A$ in the liquid is $D = 1.50 \\times 10^{-9}$ m$^{2}$ s$^{-1}$.\n- For the calculation, gas-side resistance is to be neglected.\n- The final answer for the intrinsic rate constant $k$ must be in s$^{-1}$ and rounded to three significant figures.\n- A qualitative discussion is required on the identifiability of $k$ if gas-side resistance is not negligible.\n\nStep 2: Validation of Problem Statement.\nThe problem is scientifically grounded, rooted in the fundamental principles of chemical reaction engineering and mass transfer. The two-film theory is a standard, well-established model for analyzing mass transfer across a phase boundary. The governing equation, a second-order ordinary differential equation representing diffusion with reaction, is a direct consequence of the conservation of mass. The problem is well-posed: it provides a sufficient set of data ($E$, $k_L$, $D$) and boundary conditions ($C_A(\\delta) = 0$) to permit the calculation of a unique value for the rate constant $k$. The problem is objective and uses precise terminology. There are no scientific or factual unsoundness, no contradictions, and no reliance on subjective claims. The given numerical values are physically plausible. The problem is a standard, non-trivial exercise in applying fundamental theory.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A full, reasoned solution will now be developed.\n\nThe starting point is the differential mass balance for species $A$ across the liquid film. Under steady-state conditions, the balance between Fickian diffusion and a first-order chemical reaction (with rate of consumption $k C_A$) within a one-dimensional film is:\n$$ D \\frac{d^2 C_A}{dz^2} - k C_A = 0 $$\nwhere $z$ is the spatial coordinate perpendicular to the interface ($z=0$ at the interface, $z=\\delta$ at the film edge), $C_A$ is the concentration of $A$, $D$ is its diffusivity, and $k$ is the first-order rate constant. The boundary conditions are:\n$1$. At the interface, $z=0$: $C_A(0) = C_{A,i}$.\n$2$. At the film edge, $z=\\delta$: $C_A(\\delta) = C_{A,b} \\approx 0$.\n\nThe general solution to this differential equation can be written using hyperbolic functions:\n$$ C_A(z) = C_1 \\sinh\\left(z\\sqrt{\\frac{k}{D}}\\right) + C_2 \\cosh\\left(z\\sqrt{\\frac{k}{D}}\\right) $$\nApplying the boundary conditions to determine the constants $C_1$ and $C_2$ yields the concentration profile:\n$$ C_A(z) = C_{A,i} \\frac{\\sinh\\left((\\delta - z) \\sqrt{k/D}\\right)}{\\sinh\\left(\\delta \\sqrt{k/D}\\right)} $$\nThe flux of species $A$ into the liquid at the interface is given by Fick's first law:\n$$ N_A = -D \\left. \\frac{dC_A}{dz} \\right|_{z=0} $$\nDifferentiating the concentration profile and evaluating at $z=0$ gives:\n$$ \\left. \\frac{dC_A}{dz} \\right|_{z=0} = - C_{A,i} \\sqrt{\\frac{k}{D}} \\coth\\left(\\delta \\sqrt{\\frac{k}{D}}\\right) $$\nThus, the absorption flux with reaction is:\n$$ N_A = C_{A,i} \\sqrt{kD} \\coth\\left(\\delta \\sqrt{\\frac{k}{D}}\\right) $$\nThe enhancement factor, $E$, is the ratio of this flux to the flux that would occur under purely physical absorption ($k=0$), denoted $N_A^*$. For physical absorption, the flux is $N_A^* = k_L C_{A,i}$, where $k_L$ is the physical mass transfer coefficient, defined within film theory as $k_L = D/\\delta$.\n$$ E = \\frac{N_A}{N_A^*} = \\frac{C_{A,i} \\sqrt{kD} \\coth\\left(\\delta \\sqrt{k/D}\\right)}{k_L C_{A,i}} = \\frac{\\sqrt{kD}}{k_L} \\coth\\left(\\frac{D}{k_L} \\sqrt{\\frac{k}{D}}\\right) $$\nThis relation is simplified by introducing the dimensionless Hatta number, $Ha$:\n$$ Ha = \\frac{\\sqrt{kD}}{k_L} $$\nThe Hatta number compares the rate of reaction to the rate of mass transfer. In terms of $Ha$, the enhancement factor becomes:\n$$ E = Ha \\coth(Ha) $$\nThis is the fundamental relationship connecting the enhancement factor to the system properties. The problem provides $E = 7.50$. We must solve the transcendental equation $Ha \\coth(Ha) = 7.50$ for $Ha$. For $Ha \\gtrsim 3$, the reaction is considered fast, and $\\coth(Ha) \\rightarrow 1$. In this limit, $E \\approx Ha$. Given $E=7.50$, this approximation is excellent. A precise calculation shows that if $Ha=7.50$, then $Ha \\coth(7.50) \\approx 7.50 \\times (1.0000006) \\approx 7.5000045$. The difference is negligible. We therefore take $Ha = 7.50$.\n\nWe can now solve for the intrinsic rate constant $k$ from the definition of the Hatta number:\n$$ k = \\frac{Ha^2 k_L^2}{D} $$\nSubstituting the given values:\n$$ k = \\frac{(7.50)^2 (2.00 \\times 10^{-5} \\text{ m s}^{-1})^2}{1.50 \\times 10^{-9} \\text{ m}^2 \\text{ s}^{-1}} $$\n$$ k = \\frac{56.25 \\times (4.00 \\times 10^{-10} \\text{ m}^2 \\text{ s}^{-2})}{1.50 \\times 10^{-9} \\text{ m}^2 \\text{ s}^{-1}} = \\frac{2.25 \\times 10^{-8} \\text{ m}^2 \\text{ s}^{-2}}{1.50 \\times 10^{-9} \\text{ m}^2 \\text{ s}^{-1}} $$\n$$ k = 15.0 \\text{ s}^{-1} $$\nThe calculated value is already at three significant figures.\n\nFinally, we address the identifiability of $k$ when gas-side resistance is not negligible. With both gas- and liquid-side resistances, the flux is given by an overall mass transfer expression:\n$$ N_A = \\frac{p_{A,G} - H C_{A,b}}{\\frac{1}{k_g} + \\frac{H}{E k_L}} $$\nwhere $p_{A,G}$ is the bulk gas partial pressure, $k_g$ is the gas-side mass transfer coefficient, and $H$ is Henry's constant. For physical absorption ($k=0 \\implies E=1$), the flux is $N_A^* = (p_{A,G} - H C_{A,b}) / (1/k_g + H/k_L)$. An experiment measures the *observed* enhancement factor $E_{obs} = N_A/N_A^*$.\n$$ E_{obs} = \\frac{\\frac{1}{k_g} + \\frac{H}{k_L}}{\\frac{1}{k_g} + \\frac{H}{E k_L}} $$\nTo determine the intrinsic rate constant $k$, one must first find the intrinsic enhancement factor $E$ from the measured $E_{obs}$. The equation shows that $E$ depends not only on $E_{obs}$ but also on the relative contributions of the gas- and liquid-side resistances, which are functions of $k_g$, $k_L$, and $H$. If only $E_{obs}$ is measured, and the parameters $k_g$ and $H$ are unknown, it is impossible to uniquely solve for the intrinsic factor $E$. A single measurement of $E_{obs}$ is insufficient to deconvolve the coupled effects of gas-side resistance, liquid-side resistance, and intrinsic reaction kinetics. Therefore, without independent knowledge or measurement of $k_g$ and $H$, the intrinsic rate constant $k$ is not uniquely identifiable from a measured overall enhancement factor.", "answer": "$$\n\\boxed{15.0}\n$$", "id": "2503840"}, {"introduction": "Our final practice problem takes a significant step towards real-world complexity by addressing multicomponent diffusion coupled with a homogeneous reaction. Simple Fickian models often fail in concentrated mixtures, necessitating the more rigorous Maxwell-Stefan equations, which explicitly account for interactions between all species. This exercise challenges you to formulate and numerically solve the resulting system of coupled, nonlinear boundary-value problems, providing hands-on experience with the computational methods that are indispensable for modern process simulation and design [@problem_id:2503863].", "problem": "Consider isothermal, isobaric, one-dimensional diffusion and homogeneous reaction in a nonporous, stagnant gas film of thickness $L$ containing three ideal-gas species: reactant $A$, reactant $B$, and inert $I$. The irreversible reaction is $A + B \\rightarrow 2 I$ and proceeds homogeneously throughout the film with second-order kinetics $r = k \\, c_A \\, c_B$, where $c_A$ and $c_B$ are molar concentrations. Assume the gas mixture is ideal with total molar concentration $c = p/(R T)$, where $p$ is pressure, $T$ is temperature, and $R$ is the universal gas constant. Let $x_i$ and $N_i$ denote, respectively, the mole fraction and molar flux of species $i \\in \\{A,B,I\\}$ in the $z$-direction (normal to the film). The film is bounded by two well-stirred reservoirs imposing fixed compositions at $z=0$ and $z=L$: $x_A(0)=x_{A,0}$, $x_B(0)=x_{B,0}$, $x_A(L)=x_{A,L}$, and $x_B(L)=x_{B,L}$; the inert mole fraction follows from $x_I = 1 - x_A - x_B$. The binary Maxwell–Stefan diffusivities $D_{AB}$, $D_{AI}$, and $D_{BI}$ are constant and symmetric (for example, $D_{AB}=D_{BA}$).\n\nYou are to derive, from first principles, a numerical scheme to solve the Maxwell–Stefan diffusion–reaction problem with second-order kinetics in this film, and then implement it to compute the molar flux of $A$ at $z=0$ for a small test suite. Your derivation and implementation must start from:\n\n- Species balances in steady state in one dimension with homogeneous reaction: $\\dfrac{d N_i}{d z} = \\nu_i \\, r$, where $\\nu_A=-1$, $\\nu_B=-1$, $\\nu_I=+2$.\n- Maxwell–Stefan flux–gradient relations for an ideal multicomponent mixture in one dimension: $-\\dfrac{d x_i}{d z} = \\dfrac{1}{c}\\sum_{j\\neq i}\\dfrac{x_j N_i - x_i N_j}{D_{ij}}$, subject to $x_A + x_B + x_I = 1$.\n- The total concentration $c = p/(R T)$ and reaction rate $r = k \\, c_A \\, c_B = k \\, c^2 x_A x_B$.\n\nYour scheme must:\n- Explicitly enforce the flux-sum constraint $\\sum_i N_i = 0$ that follows from the stoichiometry and isothermal, isobaric conditions, and explain how it is used to eliminate one flux variable.\n- Handle the algebraic coupling of the Maxwell–Stefan equations by constructing and solving the appropriate linear system at each spatial location, or by rearranging the relations into ordinary differential equations for a subset of variables in a way that remains faithful to the original Maxwell–Stefan structure.\n- Formulate a boundary-value problem with sufficient boundary conditions and an algorithm to solve it numerically with guaranteed convergence for the test parameters provided below.\n\nRequired outputs:\n- For each test case, compute the interfacial molar flux of species $A$ at $z=0$, denoted $N_A(0)$, and report it in $\\mathrm{mol\\, m^{-2}\\, s^{-1}}$.\n\nPhysical units to use:\n- $L$ in $\\mathrm{m}$, $p$ in $\\mathrm{Pa}$, $T$ in $\\mathrm{K}$, $D_{ij}$ in $\\mathrm{m^2\\, s^{-1}}$, $k$ in $\\mathrm{m^3\\, mol^{-1}\\, s^{-1}}$, $N_i$ in $\\mathrm{mol\\, m^{-2}\\, s^{-1}}$.\n- Use $R = 8.314462618\\, \\mathrm{J\\, mol^{-1}\\, K^{-1}}$.\n\nTest suite (each test is a tuple $\\{L, p, T, D_{AB}, D_{AI}, D_{BI}, k, x_{A,0}, x_{B,0}, x_{A,L}, x_{B,L}\\}$):\n- Test $1$: $\\{L = 1.0\\times 10^{-3},\\, p = 1.01325\\times 10^{5},\\, T = 3.30\\times 10^{2},\\, D_{AB} = 1.6\\times 10^{-5},\\, D_{AI} = 1.2\\times 10^{-5},\\, D_{BI} = 1.3\\times 10^{-5},\\, k = 5.0\\times 10^{-2},\\, x_{A,0} = 3.0\\times 10^{-1},\\, x_{B,0} = 2.0\\times 10^{-1},\\, x_{A,L} = 1.0\\times 10^{-1},\\, x_{B,L} = 4.0\\times 10^{-1}\\}$.\n- Test $2$ (boundary and no-reaction edge case): $\\{L = 1.0\\times 10^{-3},\\, p = 1.01325\\times 10^{5},\\, T = 3.30\\times 10^{2},\\, D_{AB} = 1.6\\times 10^{-5},\\, D_{AI} = 1.2\\times 10^{-5},\\, D_{BI} = 1.3\\times 10^{-5},\\, k = 0.0,\\, x_{A,0} = 2.0\\times 10^{-1},\\, x_{B,0} = 3.0\\times 10^{-1},\\, x_{A,L} = 2.0\\times 10^{-1},\\, x_{B,L} = 3.0\\times 10^{-1}\\}$.\n- Test $3$ (asymmetric diffusivities): $\\{L = 5.0\\times 10^{-4},\\, p = 1.01325\\times 10^{5},\\, T = 3.40\\times 10^{2},\\, D_{AB} = 1.0\\times 10^{-5},\\, D_{AI} = 8.0\\times 10^{-6},\\, D_{BI} = 2.0\\times 10^{-5},\\, k = 2.0\\times 10^{-2},\\, x_{A,0} = 3.5\\times 10^{-1},\\, x_{B,0} = 1.5\\times 10^{-1},\\, x_{A,L} = 5.0\\times 10^{-2},\\, x_{B,L} = 4.5\\times 10^{-1}\\}$.\n- Test $4$ (thin film, faster reaction): $\\{L = 2.0\\times 10^{-4},\\, p = 1.01325\\times 10^{5},\\, T = 3.50\\times 10^{2},\\, D_{AB} = 1.6\\times 10^{-5},\\, D_{AI} = 1.2\\times 10^{-5},\\, D_{BI} = 1.3\\times 10^{-5},\\, k = 5.0\\times 10^{-1},\\, x_{A,0} = 2.5\\times 10^{-1},\\, x_{B,0} = 2.5\\times 10^{-1},\\, x_{A,L} = 1.0\\times 10^{-1},\\, x_{B,L} = 4.5\\times 10^{-1}\\}$.\n\nImplementation requirement:\n- Your program must solve the boundary-value problem implied by the above relations and test data, and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[N_A^{(1)}(0), N_A^{(2)}(0), N_A^{(3)}(0), N_A^{(4)}(0)]$, where each $N_A^{(i)}(0)$ is a floating-point number in $\\mathrm{mol\\, m^{-2}\\, s^{-1}}$.\n\nYour task:\n- Derive the mathematical model and a robust numerical scheme that meets the above requirements.\n- Implement it in a single, self-contained program as specified in the final answer section.", "solution": "The problem statement presented is chemically and mathematically sound, representing a canonical problem in reaction engineering. It is well-posed, providing sufficient governing equations and boundary conditions for a unique solution to be determined. All physical parameters are provided within realistic ranges. We will, therefore, proceed with the derivation and solution.\n\nThe problem requires the solution of a system of coupled, nonlinear ordinary differential equations (ODEs) describing simultaneous mass transfer and chemical reaction. We begin by deriving the complete mathematical model from the first principles provided.\n\nThe system involves three species: reactant $A$, reactant $B$, and inert $I$. The film exists from $z=0$ to $z=L$.\n\nFirst, we establish the governing ODE system. The state of the system at any position $z$ is described by the mole fractions $x_A(z)$, $x_B(z)$ and the molar fluxes $N_A(z)$, $N_B(z)$. The mole fraction of the inert species is determined by the summation constraint $x_I(z) = 1 - x_A(z) - x_B(z)$.\n\nThe species continuity equation for each species $i$ in steady state is given as:\n$$ \\frac{d N_i}{d z} = \\nu_i r $$\nwhere $\\nu_i$ is the stoichiometric coefficient of species $i$ and $r$ is the volumetric rate of reaction. For the reaction $A + B \\rightarrow 2 I$, the stoichiometric coefficients are $\\nu_A = -1$, $\\nu_B = -1$, and $\\nu_I = +2$. The reaction rate is given as $r = k c_A c_B = k c^2 x_A x_B$, where $c$ is the constant total molar concentration, $c = p/(RT)$.\n\nThe species balance equations for reactants $A$ and $B$ are thus:\n$$ \\frac{d N_A}{d z} = -k c^2 x_A x_B $$\n$$ \\frac{d N_B}{d z} = -k c^2 x_A x_B $$\n\nA crucial constraint on the fluxes arises from the stoichiometry. Summing the species continuity equations over all species $i \\in \\{A, B, I\\}$ yields:\n$$ \\frac{d}{dz} \\left( \\sum_{i} N_i \\right) = r \\left( \\sum_{i} \\nu_i \\right) $$\nFor the given reaction, $\\sum_i \\nu_i = (-1) + (-1) + (+2) = 0$. This implies that $\\frac{d}{dz}(\\sum_i N_i) = 0$, so the total molar flux $\\sum_i N_i$ is constant throughout the film. For a stagnant film bounded by impermeable walls or interfaces where no net convective flow is induced, this constant must be zero. Therefore, we enforce the condition:\n$$ N_A(z) + N_B(z) + N_I(z) = 0 \\quad \\text{for all } z \\in [0, L] $$\nThis allows us to eliminate the inert flux, $N_I$, from the Maxwell-Stefan equations: $N_I(z) = -N_A(z) - N_B(z)$.\n\nNext, we formulate the ODEs for the mole fractions using the Maxwell-Stefan relations. For a ternary system, we have two independent mole fraction gradient equations. For species $A$ and $B$:\n$$ -\\frac{d x_A}{d z} = \\frac{1}{c}\\left(\\frac{x_B N_A - x_A N_B}{D_{AB}} + \\frac{x_I N_A - x_A N_I}{D_{AI}}\\right) $$\n$$ -\\frac{d x_B}{d z} = \\frac{1}{c}\\left(\\frac{x_A N_B - x_B N_A}{D_{AB}} + \\frac{x_I N_B - x_B N_I}{D_{BI}}\\right) $$\nSubstituting $x_I = 1 - x_A - x_B$ and $N_I = -N_A - N_B$ into these equations, we obtain explicit expressions for the mole fraction gradients in terms of the mole fractions and the fluxes of species $A$ and $B$ only.\nFor $x_A$:\n$$ -\\frac{d x_A}{d z} = \\frac{1}{c}\\left[ \\frac{x_B N_A - x_A N_B}{D_{AB}} + \\frac{(1 - x_A - x_B) N_A - x_A (-N_A - N_B)}{D_{AI}} \\right] $$\n$$ \\frac{d x_A}{d z} = -\\frac{1}{c} \\left[ N_A \\left( \\frac{x_B}{D_{AB}} + \\frac{1 - x_B}{D_{AI}} \\right) + N_B \\left( \\frac{x_A}{D_{AI}} - \\frac{x_A}{D_{AB}} \\right) \\right] $$\nFor $x_B$:\n$$ -\\frac{d x_B}{d z} = \\frac{1}{c}\\left[ \\frac{x_A N_B - x_B N_A}{D_{AB}} + \\frac{(1 - x_A - x_B) N_B - x_B (-N_A - N_B)}{D_{BI}} \\right] $$\n$$ \\frac{d x_B}{d z} = -\\frac{1}{c} \\left[ N_A \\left( \\frac{x_B}{D_{BI}} - \\frac{x_B}{D_{AB}} \\right) + N_B \\left( \\frac{x_A}{D_{AB}} + \\frac{1 - x_A}{D_{BI}} \\right) \\right] $$\n\nWe have now constructed a system of four first-order ODEs. Let the state vector be $\\mathbf{y}(z) = [y_0(z), y_1(z), y_2(z), y_3(z)]^T = [x_A(z), x_B(z), N_A(z), N_B(z)]^T$. The system is $\\frac{d\\mathbf{y}}{dz} = \\mathbf{f}(z, \\mathbf{y})$ where:\n$$ \\frac{dy_0}{dz} = -\\frac{1}{c} \\left[ y_2 \\left( \\frac{y_1}{D_{AB}} + \\frac{1 - y_1}{D_{AI}} \\right) + y_3 \\left( \\frac{y_0}{D_{AI}} - \\frac{y_0}{D_{AB}} \\right) \\right] $$\n$$ \\frac{dy_1}{dz} = -\\frac{1}{c} \\left[ y_2 \\left( \\frac{y_1}{D_{BI}} - \\frac{y_1}{D_{AB}} \\right) + y_3 \\left( \\frac{y_0}{D_{AB}} + \\frac{1 - y_0}{D_{BI}} \\right) \\right] $$\n$$ \\frac{dy_2}{dz} = -k c^2 y_0 y_1 $$\n$$ \\frac{dy_3}{dz} = -k c^2 y_0 y_1 $$\n\nThis system must be solved subject to the boundary conditions given in the problem statement:\n- At $z=0$: $x_A(0)=x_{A,0}$ and $x_B(0)=x_{B,0}$.\n- At $z=L$: $x_A(L)=x_{A,L}$ and $x_B(L)=x_{B,L}$.\n\nThis constitutes a two-point boundary-value problem (BVP). We will solve this BVP using the shooting method. The core idea is to convert the BVP into an initial-value problem (IVP). The unknown initial conditions are the fluxes at $z=0$, namely $N_A(0)$ and $N_B(0)$. Let us denote these unknown values as $u_A = N_A(0)$ and $u_B = N_B(0)$.\n\nThe algorithm proceeds as follows:\n1.  Make an initial guess for the unknown fluxes $\\mathbf{u} = [u_A, u_B]^T$.\n2.  With the complete set of initial conditions $\\mathbf{y}(0) = [x_{A,0}, x_{B,0}, u_A, u_B]^T$, solve the IVP by integrating the system of four ODEs from $z=0$ to $z=L$ using a numerical solver, such as a Runge-Kutta method.\n3.  The integration yields the state vector at $z=L$, including the computed mole fractions $x_A(L)$ and $x_B(L)$.\n4.  Define a residual vector $\\mathbf{F}(\\mathbf{u})$ representing the discrepancy between the computed and target boundary conditions at $z=L$:\n    $$ \\mathbf{F}(\\mathbf{u}) = \\begin{pmatrix} x_A(L; u_A, u_B) - x_{A,L} \\\\ x_B(L; u_A, u_B) - x_{B,L} \\end{pmatrix} $$\n5.  Use a numerical root-finding algorithm, such as a quasi-Newton method, to find the vector $\\mathbf{u}$ that drives the residual $\\mathbf{F}(\\mathbf{u})$ to zero. The values of $u_A$ and $u_B$ in the solution to $\\mathbf{F}(\\mathbf{u})=\\mathbf{0}$ are the correct initial fluxes $N_A(0)$ and $N_B(0)$.\n\nThe convergence of this iterative procedure depends critically on a good initial guess for $[N_A(0), N_B(0)]$. A robust guess can be derived by considering the simplified case with no reaction ($k=0$). In this limit, the fluxes $N_A$ and $N_B$ are constant. Integrating the Maxwell-Stefan equations from $z=0$ to $z=L$ and approximating the composition-dependent terms with their average values ($\\bar{x}_i = (x_{i,0} + x_{i,L})/2$) yields a $2 \\times 2$ linear system for the fluxes $N_A$ and $N_B$. Solving this system provides a physically-motivated initial guess for the root-finding algorithm.\n\nThis numerical scheme is implemented in the following program. It uses `scipy.integrate.solve_ivp` for the ODE integration and `scipy.optimize.root` to solve the nonlinear algebraic equations for the shooting method. The final output is the computed molar flux of species $A$ at the boundary $z=0$, $N_A(0)$.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the multicomponent diffusion-reaction problem using a shooting method.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R = 8.314462618\n\n    # Test suite from the problem statement\n    test_cases = [\n        # {L, p, T, D_AB, D_AI, D_BI, k, x_A,0, x_B,0, x_A,L, x_B,L}\n        # Test 1\n        (1.0e-3, 1.01325e5, 3.30e2, 1.6e-5, 1.2e-5, 1.3e-5, 5.0e-2, 3.0e-1, 2.0e-1, 1.0e-1, 4.0e-1),\n        # Test 2\n        (1.0e-3, 1.01325e5, 3.30e2, 1.6e-5, 1.2e-5, 1.3e-5, 0.0, 2.0e-1, 3.0e-1, 2.0e-1, 3.0e-1),\n        # Test 3\n        (5.0e-4, 1.01325e5, 3.40e2, 1.0e-5, 8.0e-6, 2.0e-5, 2.0e-2, 3.5e-1, 1.5e-1, 5.0e-2, 4.5e-1),\n        # Test 4\n        (2.0e-4, 1.01325e5, 3.50e2, 1.6e-5, 1.2e-5, 1.3e-5, 5.0e-1, 2.5e-1, 2.5e-1, 1.0e-1, 4.5e-1),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        L, p, T, D_AB, D_AI, D_BI, k, xA0, xB0, xAL, xBL = case\n        \n        # Total molar concentration in mol m^-3\n        c = p / (R * T)\n\n        def ode_system(z, y):\n            \"\"\"Defines the system of 4 first-order ODEs.\"\"\"\n            xA, xB, NA, NB = y\n\n            # Prevent solver from exploring non-physical regions. If mole fractions\n            # go out of the [0, 1] range, return large gradients to penalize the step.\n            if not (0 = xA = 1 and 0 = xB = 1 and 0 = xA + xB = 1):\n                return [1e6, 1e6, 1e6, 1e6]\n\n            # Reaction rate in mol m^-3 s^-1\n            rate = k * c**2 * xA * xB\n            \n            # Mole fraction gradients from Maxwell-Stefan equations (dx_i/dz)\n            dxAdz = -1/c * (NA * (xB/D_AB + (1-xB)/D_AI) + NB * (xA/D_AI - xA/D_AB))\n            dxBdz = -1/c * (NA * (xB/D_BI - xB/D_AB) + NB * (xA/D_AB + (1-xA)/D_BI))\n            \n            # Flux gradients from species balances (dN_i/dz)\n            dNAdz = -rate\n            dNBdz = -rate\n            \n            return [dxAdz, dxBdz, dNAdz, dNBdz]\n\n        def get_residuals(u):\n            \"\"\"\n            Calculates the residuals at z=L for given initial fluxes at z=0.\n            The input u is a vector [NA(0), NB(0)].\n            \"\"\"\n            NA0, NB0 = u\n            y0 = [xA0, xB0, NA0, NB0]\n            \n            # Solve the initial value problem\n            sol = solve_ivp(ode_system, [0, L], y0, method='RK45', atol=1e-9, rtol=1e-9)\n            \n            if sol.status != 0:\n                # If integration fails, return large residuals to guide the root finder away\n                return [1e6, 1e6]\n            \n            # Solution at z=L\n            yL = sol.y[:, -1]\n            xAL_calc, xBL_calc = yL[0], yL[1]\n            \n            # Residuals are the differences between calculated and target boundary values\n            return [xAL_calc - xAL, xBL_calc - xBL]\n\n        # Calculate a good initial guess for the shooting method\n        # This is based on a linearized, no-reaction model\n        xA_avg = (xA0 + xAL) / 2\n        xB_avg = (xB0 + xBL) / 2\n        \n        M_guess = np.zeros((2, 2))\n        M_guess[0, 0] = (xB_avg/D_AB + (1-xB_avg)/D_AI)\n        M_guess[0, 1] = (xA_avg/D_AI - xA_avg/D_AB)\n        M_guess[1, 0] = (xB_avg/D_BI - xB_avg/D_AB)\n        M_guess[1, 1] = (xA_avg/D_AB + (1-xA_avg)/D_BI)\n\n        b_guess = np.array([c/L * (xA0 - xAL), c/L * (xB0 - xBL)])\n\n        try:\n            if abs(np.linalg.det(M_guess)) > 1e-12:\n                u_guess = np.linalg.solve(M_guess, b_guess)\n            else:\n                # If determinant is zero, guess is likely zero (e.g., Test 2)\n                u_guess = np.array([0.0, 0.0])\n        except np.linalg.LinAlgError:\n            # Fallback for any linear algebra errors\n            u_guess = np.array([0.0, 0.0])\n\n        # Solve the BVP using the shooting method with scipy.optimize.root\n        solution = root(get_residuals, u_guess, method='hybr', options={'xtol': 1e-9})\n        \n        if not solution.success:\n            # If the calculated guess fails, try a zero guess as a fallback\n            solution = root(get_residuals, [0.0, 0.0], method='hybr', options={'xtol': 1e-9})\n            if not solution.success:\n                # This should not happen for the given test cases, but indicates a convergence problem\n                results.append(np.nan) \n                continue\n\n        # The result is the flux of A at z=0, which is the first component of the solution vector\n        NA0_sol = solution.x[0]\n        results.append(NA0_sol)\n        \n    # Print results in the required format\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```", "id": "2503863"}]}