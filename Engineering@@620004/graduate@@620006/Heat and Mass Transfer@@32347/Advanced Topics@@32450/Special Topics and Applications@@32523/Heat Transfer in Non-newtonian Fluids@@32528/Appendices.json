{"hands_on_practices": [{"introduction": "Many industrial fluids, like slurries and gels, exhibit a yield stress, meaning they behave as a solid until a certain stress threshold is met. Understanding the flow of these Herschel-Bulkley fluids is crucial, as the formation of a central, un-sheared 'plug' region dramatically alters the velocity profile. This practice guides you through deriving this unique flow profile and then qualitatively analyzing how this plug flow impacts convective heat transfer, providing crucial intuition for designing thermal systems involving such materials [@problem_id:2494582].", "problem": "A steady, incompressible, laminar flow of a Herschel–Bulkley fluid is driven through a long, horizontal, circular pipe of radius $R$ by a constant, uniform axial pressure gradient $-\\mathrm{d}p/\\mathrm{d}z \\equiv G$, with $G0$. The Herschel–Bulkley constitutive relation is\n$$\n\\tau_{rz}=\\tau_0 + K \\left|\\frac{\\partial v_z}{\\partial r}\\right|^{n}\\quad \\text{for}\\quad |\\tau_{rz}|\\ge \\tau_0,\\qquad \\frac{\\partial v_z}{\\partial r}=0\\quad \\text{for}\\quad |\\tau_{rz}|\\tau_0,\n$$\nwhere $\\tau_0$ is the yield stress, $K$ is the consistency index, and $n$ is the flow behavior index. The flow is fully developed hydrodynamically, axisymmetric, and satisfies no-slip at the wall, $v_z(R)=0$. The pipe wall is subjected to a uniform heat flux $\\dot{q}''$; properties $\\rho$, $c_p$, and $k$ are constant, viscous dissipation is negligible, and axial conduction is negligible.\n\nStarting from the cylindrical, steady, axisymmetric conservation of linear momentum and energy, and the Herschel–Bulkley model given above, perform the following:\n\n1) Derive the radial distribution of shear stress $\\tau_{rz}(r)$ for fully developed flow, and from it, determine the plug radius $r_p$ as the smallest radius at which $|\\tau_{rz}(r_p)|=\\tau_0$.\n\n2) Derive the velocity profile $v_z(r)$ in the sheared annulus $r_pr\\le R$ and the uniform plug velocity $v_p$ for $0\\le r\\le r_p$, expressed in terms of $G$, $\\tau_0$, $K$, $n$, and $R$.\n\n3) Using the steady energy equation in cylindrical coordinates for thermally developing laminar flow with constant wall heat flux, discuss qualitatively how the presence of a finite plug region ($r_p0$) modifies convective heat transfer relative to the case of a purely shear flow ($\\tau_0=0$) under the same imposed $G$ and $\\dot{q}''$. In particular, identify how the plug region affects the near-wall thermal gradients, the fully developed Nusselt number (defined as the ratio of convective to conductive heat transfer, denoted as the Nusselt number (Nu)), and the thermal entrance length.\n\nExpress your final answer as a single closed-form analytic expression for the nondimensional plug radius $r_p/R$ in terms of $G$, $\\tau_0$, and $R$. No numerical evaluation is required and no units should be reported in the final answer.", "solution": "The problem statement has been subjected to rigorous validation. All provided information, including the constitutive model, flow geometry, boundary conditions, and thermal assumptions, has been extracted and analyzed.\n\n**Validation Verdict:** The problem is deemed **valid**. It is scientifically grounded in the principles of continuum mechanics and heat transfer, an objective and well-posed problem concerning the flow of a non-Newtonian fluid. The assumptions provided are standard for creating a tractable model of a physically realistic situation. Therefore, the derivation of a solution is warranted.\n\nThe solution will be developed in three parts as requested.\n\n**1) Shear Stress Distribution and Plug Radius**\n\nThe analysis begins with the conservation of linear momentum for a steady, fully developed, incompressible, axisymmetric laminar flow in a cylindrical coordinate system ($r, \\theta, z$). Under these conditions, the axial component of the momentum equation simplifies to a balance between pressure and shear forces:\n$$ \\frac{1}{r}\\frac{\\mathrm{d}}{\\mathrm{d}r}(r\\tau_{rz}) + \\left(-\\frac{\\mathrm{d}p}{\\mathrm{d}z}\\right) = 0 $$\nThe problem defines the constant axial pressure gradient as $G = -\\frac{\\mathrm{d}p}{\\mathrm{d}z}$, where $G0$ for flow to occur in the positive $z$-direction. The momentum equation becomes:\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}r}(r\\tau_{rz}) = -Gr $$\nThis ordinary differential equation is integrated with respect to $r$:\n$$ r\\tau_{rz} = -\\frac{Gr^2}{2} + C_1 $$\nwhere $C_1$ is a constant of integration. For a physical solution, the shear stress $\\tau_{rz}$ must be finite at the centerline of the pipe, $r=0$. This requires that $C_1=0$. Thus, the shear stress distribution across the pipe radius is linear:\n$$ \\tau_{rz}(r) = -\\frac{Gr}{2} $$\nThe negative sign indicates the direction of the stress vector. The magnitude of the shear stress is $|\\tau_{rz}| = Gr/2$.\n\nThe Herschel-Bulkley model specifies that the fluid flows as a solid plug when the magnitude of the shear stress is less than the yield stress, $\\tau_0$. The plug region is defined by the condition $|\\tau_{rz}|  \\tau_0$. The fluid is sheared where $|\\tau_{rz}| \\ge \\tau_0$. The plug radius, $r_p$, is the radius at which the shear stress magnitude equals the yield stress.\n$$ |\\tau_{rz}(r_p)| = \\frac{Gr_p}{2} = \\tau_0 $$\nSolving for the plug radius $r_p$ yields:\n$$ r_p = \\frac{2\\tau_0}{G} $$\nThis result indicates that a plug region exists ($r_p  0$) only if the yield stress $\\tau_0$ is non-zero. If the pressure gradient $G$ is insufficient such that $GR/2  \\tau_0$, the plug radius would be larger than the pipe radius, meaning the entire fluid body remains a solid plug and no flow occurs.\n\n**2) Velocity Profile**\n\nThe velocity profile $v_z(r)$ is determined by integrating the appropriate form of the constitutive relation. The profile is piecewise.\n\nFor the plug region, $0 \\le r \\le r_p$, the shear stress is below the yield stress, $|\\tau_{rz}|  \\tau_0$. The constitutive relation dictates that the shear rate is zero:\n$$ \\frac{\\partial v_z}{\\partial r} = 0 $$\nThis implies that the velocity is uniform across the plug region, equal to a constant plug velocity, $v_p$:\n$$ v_z(r) = v_p \\quad \\text{for} \\quad 0 \\le r \\le r_p $$\n\nFor the sheared annulus, $r_p  r \\le R$, the shear stress magnitude exceeds the yield stress, $|\\tau_{rz}| \\ge \\tau_0$. The constitutive relation is:\n$$ |\\tau_{rz}| = \\tau_0 + K \\left| \\frac{\\mathrm{d} v_z}{\\mathrm{d} r} \\right|^n $$\nFrom the momentum balance, $|\\tau_{rz}| = Gr/2$. Since velocity must decrease from the center to the wall for a pressure-driven flow, $\\mathrm{d}v_z/\\mathrm{d}r  0$, so $|\\mathrm{d}v_z/\\mathrm{d}r| = -\\mathrm{d}v_z/\\mathrm{d}r$. Substituting these into the constitutive equation gives:\n$$ \\frac{Gr}{2} = \\tau_0 + K \\left( -\\frac{\\mathrm{d} v_z}{\\mathrm{d} r} \\right)^n $$\nSolving for the velocity gradient:\n$$ -\\frac{\\mathrm{d} v_z}{\\mathrm{d} r} = \\left( \\frac{1}{K} \\left( \\frac{Gr}{2} - \\tau_0 \\right) \\right)^{1/n} $$\nTo find the velocity profile $v_z(r)$ in the sheared region, we integrate this expression from a radial position $r$ to the pipe wall at $R$, applying the no-slip boundary condition $v_z(R)=0$:\n$$ \\int_{v_z(r)}^{v_z(R)=0} \\mathrm{d}v_z = \\int_r^R -\\left( \\frac{1}{K} \\left( \\frac{G r'}{2} - \\tau_0 \\right) \\right)^{1/n} \\mathrm{d}r' $$\n$$ -v_z(r) = -\\left(\\frac{1}{K}\\right)^{1/n} \\int_r^R \\left( \\frac{G r'}{2} - \\tau_0 \\right)^{1/n} \\mathrm{d}r' $$\nThe integration is performed:\n$$ v_z(r) = \\left(\\frac{1}{K}\\right)^{1/n} \\left[ \\frac{(\\frac{G r'}{2} - \\tau_0)^{1/n+1}}{(\\frac{1}{n}+1)(\\frac{G}{2})} \\right]_r^R $$\n$$ v_z(r) = \\left(\\frac{1}{K}\\right)^{1/n} \\frac{2n}{G(n+1)} \\left[ \\left( \\frac{GR}{2} - \\tau_0 \\right)^{(n+1)/n} - \\left( \\frac{Gr}{2} - \\tau_0 \\right)^{(n+1)/n} \\right] $$\nThis expression gives the velocity profile for $r_p \\le r \\le R$.\n\nThe uniform plug velocity, $v_p$, is the velocity at the boundary of the plug, $r=r_p$. We evaluate $v_z(r_p)$ using the derived profile:\n$$ v_p = v_z(r_p) = \\left(\\frac{1}{K}\\right)^{1/n} \\frac{2n}{G(n+1)} \\left[ \\left( \\frac{GR}{2} - \\tau_0 \\right)^{(n+1)/n} - \\left( \\frac{Gr_p}{2} - \\tau_0 \\right)^{(n+1)/n} \\right] $$\nSince $r_p = 2\\tau_0/G$, the term $(Gr_p/2 - \\tau_0)$ is equal to zero. Therefore, the plug velocity simplifies to:\n$$ v_p = \\left(\\frac{1}{K}\\right)^{1/n} \\frac{2n}{G(n+1)} \\left( \\frac{GR}{2} - \\tau_0 \\right)^{(n+1)/n} $$\n\n**3) Qualitative Discussion of Convective Heat Transfer**\n\nThe analysis considers the implications of the plug region ($r_p  0$) on heat transfer, compared to a purely shear-thinning power-law fluid ($\\tau_0 = 0$) under the same pressure gradient $G$ and wall heat flux $\\dot{q}''$. The steady-state energy equation for axisymmetric flow with negligible axial conduction and viscous dissipation is:\n$$ \\rho c_p v_z(r) \\frac{\\partial T}{\\partial z} = \\frac{k}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial T}{\\partial r} \\right) $$\nFor a thermally fully developed flow with constant wall heat flux, $\\partial T/\\partial z$ is constant.\n\n- **Effect on Near-Wall Gradients and Velocity Profile:** The velocity profile for a Herschel-Bulkley fluid is blunter than for a power-law fluid. The presence of a yield stress $\\tau_0$ adds resistance to flow, so for a fixed pressure gradient $G$, the mean velocity and total flow rate are lower than in the $\\tau_0=0$ case. The velocity gradient at the wall ($r=R$) is given by $-\\frac{\\mathrm{d} v_z}{\\mathrm{d} r}|_R = \\left( \\frac{1}{K} ( \\frac{GR}{2} - \\tau_0 ) \\right)^{1/n}$. This is smaller than the gradient for a power-law fluid, which is $\\left( \\frac{1}{K} \\frac{GR}{2} \\right)^{1/n}$. The constant wall heat flux condition, $\\dot{q}'' = -k(\\partial T/\\partial r)|_{r=R}$, fixes the thermal gradient at the wall, irrespective of the fluid type.\n\n- **Effect on Fully Developed Nusselt Number ($Nu$):** The Nusselt number is defined as $Nu = hD/k$, where the heat transfer coefficient is $h = \\dot{q}'' / (T_w - T_b)$, with $T_w$ being the wall temperature and $T_b$ the bulk mean temperature. For fixed $\\dot{q}''$, $D$, and $k$, the Nusselt number is inversely proportional to the temperature difference $T_w - T_b$. The central plug region ($0 \\le r \\le r_p$) is characterized by a uniform velocity and zero shear rate. In this region, there is no relative motion between adjacent fluid layers, so radial heat transfer occurs purely by conduction. This lack of convective mixing in the core impedes the transport of heat away from the wall region toward the centerline. Consequently, to transfer the same amount of heat $\\dot{q}''$, a larger temperature difference between the wall and the bulk fluid is required. A larger $(T_w - T_b)$ signifies a lower heat transfer coefficient $h$ and therefore a lower fully developed Nusselt number. The presence of a finite plug region degrades the overall heat transfer performance compared to a purely shearing flow.\n\n- **Effect on Thermal Entrance Length ($L_{th}$):** The thermal entrance length is the axial distance required for the thermal boundary layer to develop fully, at which point the Nusselt number becomes constant. This length is proportional to the fluid's capacity to transport energy axially relative to its ability to diffuse it radially. A common scaling is $L_{th} \\propto \\bar{v} D^2 / \\alpha$, where $\\bar{v}$ is the mean velocity and $\\alpha = k/(\\rho c_p)$ is the thermal diffusivity. This can be expressed as $L_{th}/D \\propto Re \\cdot Pr$. For a given pressure gradient $G$, the presence of yield stress $\\tau_0$ increases the resistance to flow, resulting in a lower mean velocity $\\bar{v}$ compared to the case where $\\tau_0=0$. A lower mean velocity translates to a lower Reynolds number ($Re$). Since the thermal entrance length is approximately proportional to the Reynolds number in laminar flow, the presence of a plug region leads to a shorter thermal entrance length.", "answer": "$$\n\\boxed{\\frac{2\\tau_0}{GR}}\n$$", "id": "2494582"}, {"introduction": "Beyond yield-stress fluids, power-law fluids effectively model the shear-thinning or shear-thickening behavior of polymer solutions and melts. This exercise introduces a further layer of complexity by considering a Navier slip boundary condition, which is more realistic than the no-slip assumption in applications like microfluidics or flows over coated surfaces. By deriving the Nusselt number $Nu$ from first principles, you will gain a deeper understanding of how both fluid rheology and boundary phenomena govern heat transfer rates [@problem_id:2494533].", "problem": "A steady, incompressible, laminar flow of a generalized power-law fluid with consistency index $K$ and flow-behavior index $n0$ occurs through a long circular tube of radius $R$. The flow is driven by a constant axial pressure gradient $\\mathrm{d}p/\\mathrm{d}z0$ and is hydrodynamically fully developed. The tube wall imposes a Navier slip boundary condition for the tangential velocity: $u(R)=-L_s\\,\\left.\\frac{\\partial u}{\\partial r}\\right|_{r=R}$, where $u(r)$ is the axial velocity, $r$ is the radial coordinate, and $L_s$ is the slip length. The fluid obeys the Ostwald–de Waele power-law rheology $\\tau_{rz}=K\\left|\\frac{\\partial u}{\\partial r}\\right|^{n-1}\\frac{\\partial u}{\\partial r}$, where $\\tau_{rz}$ is the shear stress.\n\nThe tube is subjected to a uniform wall heat flux that transfers heat into the fluid. Take the thermal conductivity $k$, density $\\rho$, and specific heat $c_p$ to be constant, neglect viscous dissipation and axial conduction, and assume the thermal field is fully developed under constant wall heat flux. Define the wall heat flux $q''0$ as positive into the fluid, with boundary condition $k\\,\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=R}=q''$. Let the Nusselt number (Nu) be defined as $Nu=\\dfrac{hD}{k}$ with $h=\\dfrac{q''}{T_w-T_m}$ and $D=2R$, where $T_w$ is the wall temperature and $T_m$ is the bulk mean temperature.\n\nTasks:\n- Starting from the steady, axisymmetric, fully developed axial momentum balance and the power-law constitutive equation, derive the axial velocity profile $u(r)$ subject to the Navier slip boundary condition, and express the profile in normalized form $f(\\eta)=u(r)/U_m$ with $\\eta=r/R$ and $U_m$ the mean velocity. Introduce the dimensionless slip length $\\sigma=L_s/R$.\n- Starting from the steady energy equation and the definition of thermal fully developed flow under constant wall heat flux, derive a closed-form expression for the fully developed Nusselt number $Nu$ as an explicit function of the power-law index $n$ and the slip ratio $\\sigma$. All steps must proceed from first principles and core definitions; do not invoke memorized correlations.\n\nExpress your final result as a single closed-form analytic expression for $Nu(n,\\sigma)$ involving only $n$ and $\\sigma$ (no other parameters). No numerical evaluation is required.", "solution": "Begin with the steady, axisymmetric, fully developed axial momentum equation with no body force,\n$$\n0=-\\frac{\\mathrm{d}p}{\\mathrm{d}z}+\\frac{1}{r}\\frac{\\mathrm{d}}{\\mathrm{d}r}\\!\\left(r\\,\\tau_{rz}\\right),\n$$\nand integrate radially. Regularity at $r=0$ gives\n$$\n\\tau_{rz}=\\frac{r}{2}\\frac{\\mathrm{d}p}{\\mathrm{d}z}.\n$$\nIntroduce $G_p=-\\frac{\\mathrm{d}p}{\\mathrm{d}z}0$ so that $|\\tau_{rz}|=\\frac{G_p r}{2}$. The power-law rheology is\n$$\n\\tau_{rz}=K\\left|\\frac{\\partial u}{\\partial r}\\right|^{n-1}\\frac{\\partial u}{\\partial r}.\n$$\nBecause $\\frac{\\partial u}{\\partial r}0$ for internal flow, the shear-rate magnitude is\n$$\n-\\frac{\\partial u}{\\partial r}=\\left(\\frac{|\\tau_{rz}|}{K}\\right)^{1/n}=\\left(\\frac{G_p}{2K}\\right)^{1/n} r^{1/n}.\n$$\nIntegrate from $R$ to $r$ and impose the Navier slip boundary condition $u(R)=-L_s\\,u'(R)$:\n$$\nu(r)=u(R)-\\int_r^R\\left(\\frac{G_p}{2K}\\right)^{1/n} \\xi^{1/n}\\,\\mathrm{d}\\xi\n= u(R)+\\left(\\frac{G_p}{2K}\\right)^{1/n}\\frac{n}{n+1}\\left(R^{\\frac{n+1}{n}}-r^{\\frac{n+1}{n}}\\right),\n$$\nand\n$$\nu(R)=-L_s\\,u'(R)=L_s\\left(\\frac{G_p}{2K}\\right)^{1/n}R^{1/n}.\n$$\nTherefore\n$$\nu(r)=\\left(\\frac{G_p}{2K}\\right)^{1/n}\\left[L_s R^{1/n}+\\frac{n}{n+1}\\left(R^{\\frac{n+1}{n}}-r^{\\frac{n+1}{n}}\\right)\\right].\n$$\nIntroduce $\\eta=r/R$ and $\\sigma=L_s/R$ to write\n$$\nu(\\eta)=\\left(\\frac{G_p}{2K}\\right)^{1/n} R^{\\frac{n+1}{n}}\\left[\\sigma+\\frac{n}{n+1}\\left(1-\\eta^{\\frac{n+1}{n}}\\right)\\right].\n$$\nThe mean velocity is\n$$\nU_m=\\frac{2}{R^2}\\int_0^R u(r)\\,r\\,\\mathrm{d}r\n=2\\int_0^1 u(\\eta)\\,\\eta\\,\\mathrm{d}\\eta\n=\\left(\\frac{G_p}{2K}\\right)^{1/n} R^{\\frac{n+1}{n}}\n\\left[\\sigma+\\frac{n}{3n+1}\\right].\n$$\nThus the normalized velocity profile is\n$$\nf(\\eta)\\equiv\\frac{u(\\eta)}{U_m}\n=\\frac{\\sigma+\\frac{n}{n+1}\\left(1-\\eta^{\\frac{n+1}{n}}\\right)}{\\sigma+\\frac{n}{3n+1}}.\n$$\n\nNext, derive the fully developed thermal field under constant wall heat flux. The steady energy equation with negligible axial conduction and viscous dissipation is\n$$\n\\rho c_p\\,u(r)\\,\\frac{\\partial T}{\\partial z}=\\frac{1}{r}\\frac{\\partial}{\\partial r}\\!\\left(k\\,r\\,\\frac{\\partial T}{\\partial r}\\right).\n$$\nIn the thermally fully developed regime with constant properties, write $T(r,z)=T_m(z)+\\theta(r)$ so that $\\partial T/\\partial z=\\mathrm{d}T_m/\\mathrm{d}z$, and $k\\,\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=R}=q''$ with $q''0$ defined positive into the fluid. The radial ordinary differential equation becomes\n$$\n\\frac{1}{r}\\frac{\\mathrm{d}}{\\mathrm{d}r}\\!\\left(r\\,\\frac{\\mathrm{d}\\theta}{\\mathrm{d}r}\\right)=\\frac{\\rho c_p}{k}\\,u(r)\\,\\frac{\\mathrm{d}T_m}{\\mathrm{d}z}.\n$$\nMultiply by $r$ and integrate from $0$ to $R$:\n$$\n\\left.r\\frac{\\mathrm{d}\\theta}{\\mathrm{d}r}\\right|_{0}^{R}=\\frac{\\rho c_p}{k}\\,\\frac{\\mathrm{d}T_m}{\\mathrm{d}z}\\int_0^R u(r)\\,r\\,\\mathrm{d}r.\n$$\nSymmetry gives $\\left.r\\frac{\\mathrm{d}\\theta}{\\mathrm{d}r}\\right|_{r=0}=0$; at the wall $k\\,\\left.\\frac{\\mathrm{d}\\theta}{\\mathrm{d}r}\\right|_{R}=q''$, hence\n$$\n\\frac{q''R}{k}=\\frac{\\rho c_p}{k}\\,\\frac{\\mathrm{d}T_m}{\\mathrm{d}z}\\left(\\frac{U_m R^2}{2}\\right)\n\\;\\Rightarrow\\;\n\\frac{\\mathrm{d}T_m}{\\mathrm{d}z}=\\frac{2 q''}{\\rho c_p U_m R}.\n$$\nNon-dimensionalize the energy equation using $\\eta=r/R$ and define $B=\\dfrac{2 q'' R}{k}$. Then\n$$\n\\frac{1}{\\eta}\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}\\!\\left(\\eta\\,\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\eta}\\right)=B\\,f(\\eta),\n\\qquad\n\\left.\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\eta}\\right|_{\\eta=1}=\\frac{q''R}{k}=\\frac{B}{2},\n\\qquad\n\\left.\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\eta}\\right|_{\\eta=0}=0.\n$$\nIntegrate once from $0$ to $\\eta$:\n$$\n\\eta\\,\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\eta}=B\\int_0^{\\eta} \\xi\\,f(\\xi)\\,\\mathrm{d}\\xi\n\\;\\Rightarrow\\;\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\eta}=\\frac{B}{\\eta}\\int_0^{\\eta} \\xi\\,f(\\xi)\\,\\mathrm{d}\\xi.\n$$\nDefine the cumulative flow function\n$$\nF(\\eta)\\equiv 2\\int_0^{\\eta} \\xi\\,f(\\xi)\\,\\mathrm{d}\\xi,\n$$\nwhich satisfies $F(0)=0$ and $F(1)=1$ by the definition of $U_m$. Then\n$$\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\eta}=\\frac{B}{2}\\,\\frac{F(\\eta)}{\\eta}.\n$$\nIntegrating again gives, for any $\\eta\\in[0,1]$,\n$$\n\\theta(\\eta)=\\theta(0)+\\frac{B}{2}\\int_0^{\\eta}\\frac{F(s)}{s}\\,\\mathrm{d}s.\n$$\nImpose the fully developed constraint that the cross-sectionally mass-flow-weighted average of $\\theta$ vanishes: $\\int_0^1 f(\\eta)\\,\\eta\\,\\theta(\\eta)\\,\\mathrm{d}\\eta=0$. Using $\\int_0^1 f(\\eta)\\,\\eta\\,\\mathrm{d}\\eta=\\tfrac{1}{2}$ and Fubini’s theorem,\n$$\n0=\\frac{1}{2}\\theta(0)+\\frac{B}{2}\\int_0^1 f(\\eta)\\,\\eta\\left[\\int_0^{\\eta}\\frac{F(s)}{s}\\,\\mathrm{d}s\\right]\\mathrm{d}\\eta\n\\;\\Rightarrow\\;\n\\theta(0)=-B\\int_0^1 f(\\eta)\\,\\eta\\left[\\int_0^{\\eta}\\frac{F(s)}{s}\\,\\mathrm{d}s\\right]\\mathrm{d}\\eta.\n$$\nThe wall-to-mean temperature difference is $\\theta_w=\\theta(1)=\\theta(0)+\\dfrac{B}{2}\\int_0^{1}\\dfrac{F(s)}{s}\\,\\mathrm{d}s$. Eliminating $\\theta(0)$ yields the classic fully developed constant-flux identity\n$$\n\\theta_w=\\frac{B}{2}\\int_0^1 \\frac{F(s)^2}{s}\\,\\mathrm{d}s,\n\\qquad\nNu=\\frac{2Rq''}{k\\,\\theta_w}=\\frac{2}{\\displaystyle \\int_0^1 \\frac{F(s)^2}{s}\\,\\mathrm{d}s}.\n$$\n\nIt remains to evaluate $F(\\eta)$ for the slip-modified power-law velocity. With\n$$\nf(\\eta)=\\frac{\\sigma+\\frac{n}{n+1}\\left(1-\\eta^{\\frac{n+1}{n}}\\right)}{\\sigma+\\frac{n}{3n+1}},\n$$\none finds\n$$\nF(s)=\\frac{2}{\\sigma+\\frac{n}{3n+1}}\\int_0^s \\xi\\left[\\sigma+\\frac{n}{n+1}\\left(1-\\xi^{\\frac{n+1}{n}}\\right)\\right]\\mathrm{d}\\xi\n=\\frac{\\left(\\sigma+\\frac{n}{n+1}\\right)s^2-\\dfrac{2 n^2}{(n+1)(3n+1)}\\,s^{2+\\frac{n+1}{n}}}{\\sigma+\\frac{n}{3n+1}}.\n$$\nTherefore\n$$\n\\int_0^1 \\frac{F(s)^2}{s}\\,\\mathrm{d}s\n=\\frac{1}{\\left(\\sigma+\\frac{n}{3n+1}\\right)^2}\n\\left[\n\\frac{\\left(\\sigma+\\frac{n}{n+1}\\right)^2}{4}\n-\\frac{4 n^3}{(n+1)(3n+1)(5n+1)}\\left(\\sigma+\\frac{n}{n+1}\\right)\n+\\frac{2 n^5}{(n+1)^2(3n+1)^3}\n\\right],\n$$\nwhere the exponents have been integrated using\n$$\n\\int_0^1 s^{3}\\,\\mathrm{d}s=\\frac{1}{4},\\quad\n\\int_0^1 s^{3+\\frac{n+1}{n}}\\,\\mathrm{d}s=\\frac{n}{5n+1},\\quad\n\\int_0^1 s^{3+2\\frac{n+1}{n}}\\,\\mathrm{d}s=\\frac{n}{2(3n+1)}.\n$$\nFinally, substituting into $Nu=2/\\int_0^1 F^2/s\\,\\mathrm{d}s$ gives the fully developed Nusselt number under Navier slip for laminar power-law pipe flow (constant wall heat flux),\n$$\nNu(n,\\sigma)=\\frac{2\\left(\\sigma+\\frac{n}{3n+1}\\right)^2}{\n\\frac{\\left(\\sigma+\\frac{n}{n+1}\\right)^2}{4}\n-\\frac{4 n^3}{(n+1)(3n+1)(5n+1)}\\left(\\sigma+\\frac{n}{n+1}\\right)\n+\\frac{2 n^5}{(n+1)^2(3n+1)^3}\n}.\n$$\n\nRemarks on limiting behavior:\n- For no slip, $\\sigma\\to 0$, this expression reduces to the classical fully developed constant-flux result for power-law fluids, and for $n=1$ gives $Nu\\approx 4.364$.\n- For very large slip, $\\sigma\\to\\infty$, the velocity profile approaches plug flow, $f(\\eta)\\to 1$, and $Nu\\to 8$, consistent with the fully developed constant-flux slug-flow limit.\nThese trends reflect the progressive flattening of the velocity and temperature profiles with increasing slip, which enhances convective heat transfer toward the plug-flow limit.", "answer": "$$\\boxed{\\displaystyle Nu(n,\\sigma)=\\frac{2\\left(\\sigma+\\frac{n}{3n+1}\\right)^{2}}{\\frac{\\left(\\sigma+\\frac{n}{n+1}\\right)^{2}}{4}-\\frac{4 n^{3}}{(n+1)(3 n+1)(5 n+1)}\\left(\\sigma+\\frac{n}{n+1}\\right)+\\frac{2 n^{5}}{(n+1)^{2}(3 n+1)^{3}}}}$$", "id": "2494533"}, {"introduction": "While analytical solutions are invaluable for understanding laminar flows, most industrial applications involve turbulence, necessitating the use of computational fluid dynamics ($CFD$). This practical exercise bridges theory and computation by tasking you with developing a consistent wall function for a turbulent flow of a Carreau fluid, a generalized model that captures viscosity at both very low and very high shear rates. You will learn how to adapt standard turbulence models like the $k$-$\\epsilon$ model for non-Newtonian rheology, a critical skill for accurately simulating real-world engineering systems [@problem_id:2494565].", "problem": "Consider turbulent heat transfer over a smooth, isothermal wall in a steady, incompressible, single-phase flow of a generalized Newtonian fluid modeled by the Carreau constitutive equation. The near-wall modeling is to be performed within the context of a two-equation turbulence model of turbulent kinetic energy and turbulent dissipation rate (the $k$-$\\epsilon$ model). The objective is to construct velocity and thermal wall functions that are consistent with generalized-Newtonian viscosity, and to compute the non-dimensional wall-normal coordinate $y^+$ and select an appropriate turbulent Prandtl number $Pr_t$ in shear-thinning flows. Your program must implement the following physically based modeling elements and produce numerical results for the specified test suite.\n\nFundamental bases and constitutive modeling to be used:\n- Momentum balance near a smooth wall motivates the definition of the friction velocity $u_\\tau$, where the mean wall shear stress is $\\tau_w = \\rho u_\\tau^2$, with $\\rho$ the fluid density.\n- For a generalized Newtonian fluid, the apparent viscosity is given by the Carreau model\n$$\n\\mu(\\dot{\\gamma}) = \\mu_\\infty + \\left(\\mu_0 - \\mu_\\infty\\right)\\left[1 + \\left(\\lambda \\dot{\\gamma}\\right)^2\\right]^{\\frac{n-1}{2}},\n$$\nwhere $\\dot{\\gamma}$ is the scalar shear rate, $\\mu_0$ is the zero-shear viscosity, $\\mu_\\infty$ is the infinite-shear viscosity, $\\lambda$ is a time constant, and $n$ is the power-law index. At the wall, simple shear implies $\\tau_w = \\mu_w \\dot{\\gamma}_w$, where $\\mu_w = \\mu(\\dot{\\gamma}_w)$ is the wall viscosity and $\\dot{\\gamma}_w$ is the wall shear rate. Combining with $\\tau_w = \\rho u_\\tau^2$ yields the implicit relation\n$$\n\\dot{\\gamma}_w = \\frac{\\rho u_\\tau^2}{\\mu_w}, \\quad \\mu_w = \\mu\\!\\left(\\dot{\\gamma}_w\\right).\n$$\n- The non-dimensional wall-normal coordinate is defined by\n$$\ny^+ = \\frac{\\rho u_\\tau y_P}{\\mu_w},\n$$\nwhere $y_P$ is the distance from the wall to the center of the first off-wall computational cell.\n- The velocity wall function is assumed to satisfy the standard equilibrium form for smooth walls,\n$$\nU^+ = \\frac{U_P}{u_\\tau} =\n\\begin{cases}\ny^+,  y^+ \\le y_c \\\\\n\\frac{1}{\\kappa}\\ln\\left(E y^+\\right),  y^+ > y_c\n\\end{cases}\n$$\nwith von Kármán constant $\\kappa = 0.41$, empirical constant $E = 9.8$, cut-off $y_c = 11$, and $U_P$ the tangential mean velocity magnitude at the first off-wall point. This relation is to be enforced implicitly via $u_\\tau$ because $y^+$ depends on $\\mu_w$ which itself depends on $u_\\tau$.\n- The equilibrium $k$-$\\epsilon$ wall boundary condition in the logarithmic region relates the model variables to $u_\\tau$ by\n$$\nk = \\frac{u_\\tau^2}{\\sqrt{C_\\mu}}, \\qquad \\epsilon = \\frac{u_\\tau^3}{\\kappa\\, y_P},\n$$\nwith $C_\\mu = 0.09$. These relations are widely used under the assumption of local equilibrium between production and dissipation in the logarithmic layer and serve as wall-function closures for $k$ and $\\epsilon$ at the wall-adjacent cell center.\n- The thermal subgrid modeling adopts the simple gradient-diffusion hypothesis with a turbulent Prandtl number $Pr_t$. In shear-thinning fluids, $Pr_t$ should transition from a molecular value near the wall to an asymptotic turbulent value away from the wall. Use a near-wall molecular Prandtl number based on the wall viscosity,\n$$\nPr_w = \\frac{\\mu_w c_p}{k_{cond}},\n$$\nwhere $c_p$ is the specific heat at constant pressure and $k_{cond}$ is the thermal conductivity. Then define a smooth blending from $Pr_w$ in the viscous sublayer to an asymptotic turbulent value $Pr_{t,\\infty} = 0.85$ via\n$$\nS(y^+) = 1 - \\exp\\!\\left[-\\left(\\frac{y^+}{A}\\right)^2\\right], \\qquad A = 11.4,\n$$\nand\n$$\nPr_t(y^+) = Pr_w + \\left(Pr_{t,\\infty} - Pr_w\\right) S(y^+).\n$$\nFor numerical robustness, bound the final $Pr_t$ to the interval $[0.3, 2.0]$.\n\nComputational tasks:\n- For each test case, solve the coupled nonlinear wall-function system to determine $u_\\tau$ that satisfies the velocity wall function, while consistently computing $\\mu_w$ from the Carreau law using the wall shear rate implied by $u_\\tau$. Use the resulting $\\mu_w$ to compute $y^+$, $Pr_w$, and the blended $Pr_t$. Then compute $k$ and $\\epsilon$ from the equilibrium relations above.\n- All physical constants and inputs are provided per test case below. Use the values exactly as given. All quantities are in the International System of Units (SI).\n- Express outputs as follows:\n  - $y^+$ is dimensionless.\n  - $Pr_t$ is dimensionless.\n  - $k$ must be expressed in $\\mathrm{m^2/s^2}$.\n  - $\\epsilon$ must be expressed in $\\mathrm{m^2/s^3}$.\n\nTest suite:\nProvide results for the following three cases. In each case, the fluid is modeled by the Carreau law with the parameters specified.\n\n- Case A (shear-thinning, moderate Reynolds number):\n  - $\\rho = 1000\\,\\mathrm{kg/m^3}$,\n  - $\\mu_0 = 0.02\\,\\mathrm{Pa\\,s}$,\n  - $\\mu_\\infty = 0.001\\,\\mathrm{Pa\\,s}$,\n  - $\\lambda = 2.0\\,\\mathrm{s}$,\n  - $n = 0.5$,\n  - $y_P = 2.0\\times 10^{-4}\\,\\mathrm{m}$,\n  - $U_P = 1.5\\,\\mathrm{m/s}$,\n  - $k_{cond} = 0.6\\,\\mathrm{W/(m\\,K)}$,\n  - $c_p = 4184\\,\\mathrm{J/(kg\\,K)}$.\n\n- Case B (shear-thinning, viscous-sublayer bias):\n  - $\\rho = 1000\\,\\mathrm{kg/m^3}$,\n  - $\\mu_0 = 0.02\\,\\mathrm{Pa\\,s}$,\n  - $\\mu_\\infty = 0.001\\,\\mathrm{Pa\\,s}$,\n  - $\\lambda = 2.0\\,\\mathrm{s}$,\n  - $n = 0.5$,\n  - $y_P = 2.0\\times 10^{-5}\\,\\mathrm{m}$,\n  - $U_P = 0.05\\,\\mathrm{m/s}$,\n  - $k_{cond} = 0.6\\,\\mathrm{W/(m\\,K)}$,\n  - $c_p = 4184\\,\\mathrm{J/(kg\\,K)}$.\n\n- Case C (nearly Newtonian, higher Reynolds number):\n  - $\\rho = 1000\\,\\mathrm{kg/m^3}$,\n  - $\\mu_0 = 0.001\\,\\mathrm{Pa\\,s}$,\n  - $\\mu_\\infty = 0.001\\,\\mathrm{Pa\\,s}$,\n  - $\\lambda = 1.0\\,\\mathrm{s}$,\n  - $n = 1.0$,\n  - $y_P = 5.0\\times 10^{-4}\\,\\mathrm{m}$,\n  - $U_P = 8.0\\,\\mathrm{m/s}$,\n  - $k_{cond} = 0.6\\,\\mathrm{W/(m\\,K)}$,\n  - $c_p = 4184\\,\\mathrm{J/(kg\\,K)}$.\n\nRequired final output format:\nYour program should produce a single line of output containing a list of results, one per test case, where each result is the list [`y^+`, `Pr_t`, `k`, `\\epsilon`] in that order. The overall output must therefore be a single list of three lists, printed as a single line, for example\n$$\n\\texttt{[[yplus\\_A,Prt\\_A,k\\_A,epsilon\\_A],[yplus\\_B,Prt\\_B,k\\_B,epsilon\\_B],[yplus\\_C,Prt\\_C,k\\_C,epsilon\\_C]]}\n$$\nwith each placeholder replaced by the computed floating-point numbers. No other text must be printed.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to proceed with a numerical solution. The problem represents a standard, albeit complex, task in the field of computational fluid dynamics, specifically concerning the modeling of turbulent boundary layers for non-Newtonian fluids.\n\nThe objective is to compute a set of wall-function-derived quantities for three distinct flow cases. The core of the problem lies in solving a coupled, nonlinear system of equations for the friction velocity, $u_\\tau$. All other required quantities, namely the non-dimensional wall distance $y^+$, the turbulent Prandtl number $Pr_t$, the turbulent kinetic energy $k$, and the turbulent dissipation rate $\\epsilon$, are functions of $u_\\tau$.\n\nThe governing system of equations is as follows:\n$1$. The Carreau model for apparent viscosity $\\mu$ as a function of shear rate $\\dot{\\gamma}$:\n$$\n\\mu(\\dot{\\gamma}) = \\mu_\\infty + \\left(\\mu_0 - \\mu_\\infty\\right)\\left[1 + \\left(\\lambda \\dot{\\gamma}\\right)^2\\right]^{\\frac{n-1}{2}}\n$$\n$2$. The relationship between wall shear stress $\\tau_w$, friction velocity $u_\\tau$, wall shear rate $\\dot{\\gamma}_w$, and wall viscosity $\\mu_w$:\n$$\n\\tau_w = \\rho u_\\tau^2 = \\mu_w \\dot{\\gamma}_w\n$$\nwhere $\\mu_w = \\mu(\\dot{\\gamma}_w)$. This constitutes a nonlinear implicit equation for $\\mu_w$ (or $\\dot{\\gamma}_w$) for a given $u_\\tau$.\n$3$. The definition of the non-dimensional wall distance $y^+$:\n$$\ny^+ = \\frac{\\rho u_\\tau y_P}{\\mu_w}\n$$\n$4$. The law of the wall, which relates the non-dimensional velocity $U^+ = U_P/u_\\tau$ to $y^+$:\n$$\nU^+ = \\frac{U_P}{u_\\tau} =\n\\begin{cases}\ny^+,  y^+ \\le y_c \\\\\n\\frac{1}{\\kappa}\\ln\\left(E y^+\\right),  y^+ > y_c\n\\end{cases}\n$$\nwith given constants $\\kappa = 0.41$, $E = 9.8$, and $y_c = 11$.\n\nThis system must be solved for $u_\\tau$. A robust numerical strategy involves defining a single residual function $R(u_\\tau) = 0$ and employing a root-finding algorithm. Let us define the residual as:\n$$\nR(u_\\tau) = \\frac{U_P}{u_\\tau} - f(y^+(u_\\tau))\n$$\nwhere $f(y^+)$ represents the piecewise velocity wall function. The evaluation of this residual for a given trial value of $u_\\tau$ is a multi-step process:\n\nFirst, for a given $u_\\tau$, the wall viscosity $\\mu_w$ must be determined. This itself requires solving a nonlinear equation for the wall shear rate $\\dot{\\gamma}_w$:\n$$\nH(\\dot{\\gamma}_w) = \\dot{\\gamma}_w \\cdot \\mu(\\dot{\\gamma}_w) - \\rho u_\\tau^2 = 0\n$$\nFor the specified cases where the power-law index $n \\le 1$, the function $\\dot{\\gamma}_w \\mu(\\dot{\\gamma}_w)$ is monotonically increasing, which guarantees a unique solution for $\\dot{\\gamma}_w$. This can be efficiently found using a numerical root-finder like the Brent-Dekker method. Once $\\dot{\\gamma}_w$ is found, $\\mu_w$ is computed from the Carreau model.\n\nSecond, with $\\mu_w$ known, $y^+$ is calculated directly from its definition.\n\nThird, the model velocity $U^+_{model} = f(y^+)$ is evaluated using the appropriate branch of the wall function.\n\nFinally, the residual $R(u_\\tau)$ is computed. A root-finding algorithm is then applied to this residual function over a physically reasonable interval for $u_\\tau$, for instance $[10^{-4}, 1.5 U_P]$, to find the correct value of $u_\\tau$.\n\nOnce the converged solution for $u_\\tau$ is obtained, the final output quantities are calculated as follows:\n- The wall viscosity $\\mu_w$ and non-dimensional distance $y^+$ are re-computed using the final $u_\\tau$.\n- The molecular Prandtl number at the wall is $Pr_w = \\frac{\\mu_w c_p}{k_{cond}}$.\n- The turbulent Prandtl number $Pr_t$ is computed using the provided blending function:\n  $$\n  S(y^+) = 1 - \\exp\\!\\left[-\\left(\\frac{y^+}{A}\\right)^2\\right], \\quad A = 11.4\n  $$\n  $$\n  Pr_t(y^+) = Pr_w + \\left(Pr_{t,\\infty} - Pr_w\\right) S(y^+)\n  $$\n  where $Pr_{t,\\infty} = 0.85$. The result is then clamped to the specified interval $[0.3, 2.0]$.\n- The turbulent kinetic energy $k$ and its dissipation rate $\\epsilon$ are found from the standard equilibrium relations:\n  $$\n  k = \\frac{u_\\tau^2}{\\sqrt{C_\\mu}}, \\qquad \\epsilon = \\frac{u_\\tau^3}{\\kappa\\, y_P}\n  $$\n  where $C_\\mu = 0.09$ and $\\kappa = 0.41$.\n\nThis computational procedure is implemented for each of the three test cases provided in the problem statement. The numerical solution utilizes the `brentq` function from the `scipy.optimize` library for both nested root-finding tasks due to its robustness and efficiency for one-dimensional problems where the root can be bracketed. The final implementation is encapsulated within a self-contained Python script.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the coupled wall-function system for generalized Newtonian fluids\n    for a suite of test cases and prints the results in the specified format.\n    \"\"\"\n\n    # Define the test cases from the problem statement. All values in SI units.\n    test_cases = [\n        # Case A: shear-thinning, moderate Reynolds number\n        {'rho': 1000.0, 'mu0': 0.02, 'mu_inf': 0.001, 'lam': 2.0, 'n': 0.5,\n         'yP': 2.0e-4, 'UP': 1.5, 'k_cond': 0.6, 'cp': 4184.0},\n        # Case B: shear-thinning, viscous-sublayer bias\n        {'rho': 1000.0, 'mu0': 0.02, 'mu_inf': 0.001, 'lam': 2.0, 'n': 0.5,\n         'yP': 2.0e-5, 'UP': 0.05, 'k_cond': 0.6, 'cp': 4184.0},\n        # Case C: nearly Newtonian, higher Reynolds number\n        {'rho': 1000.0, 'mu0': 0.001, 'mu_inf': 0.001, 'lam': 1.0, 'n': 1.0,\n         'yP': 5.0e-4, 'UP': 8.0, 'k_cond': 0.6, 'cp': 4184.0}\n    ]\n\n    # Physical and model constants\n    KAPPA = 0.41\n    E = 9.8\n    Y_C = 11.0\n    C_MU = 0.09\n    A = 11.4\n    PR_T_INF = 0.85\n    PR_T_MIN = 0.3\n    PR_T_MAX = 2.0\n\n    def solve_case(params):\n        \"\"\"\n        Solves the system for a single test case.\n        \"\"\"\n        rho = params['rho']\n        mu0 = params['mu0']\n        mu_inf = params['mu_inf']\n        lam = params['lam']\n        n = params['n']\n        yP = params['yP']\n        UP = params['UP']\n        k_cond = params['k_cond']\n        cp = params['cp']\n\n        def get_mu_from_gamma_dot(gamma_dot):\n            \"\"\"Computes viscosity from shear rate using Carreau model.\"\"\"\n            if np.isclose(mu0, mu_inf) or np.isclose(n, 1.0):\n                return mu0\n            return mu_inf + (mu0 - mu_inf) * (1 + (lam * gamma_dot)**2)**((n - 1) / 2.0)\n\n        def get_mu_w(u_tau):\n            \"\"\"Solves for wall viscosity mu_w for a given friction velocity u_tau.\"\"\"\n            tau_w = rho * u_tau**2\n            if tau_w  1e-12:\n                return mu0\n\n            # Residual for solving gamma_dot_w: H(gd) = gd * mu(gd) - tau_w = 0\n            def gamma_dot_residual(gamma_dot_w):\n                return gamma_dot_w * get_mu_from_gamma_dot(gamma_dot_w) - tau_w\n            \n            # The function is monotonic. Bracket can be determined.\n            # Lower bound: H(0) = -tau_w  0.\n            # Upper bound: H(large_number)  0.\n            # An estimate for a safe upper bound: tau_w / mu_inf\n            gd_max_est = tau_w / mu_inf if mu_inf > 0 else 1e9\n            gamma_dot_w = brentq(gamma_dot_residual, 1e-9, gd_max_est * 10 + 1)\n            \n            return get_mu_from_gamma_dot(gamma_dot_w)\n\n        # Main residual for solving u_tau: R(u_tau) = U_P/u_tau - U_plus_model(y_plus) = 0\n        def utau_residual(u_tau):\n            if u_tau = 1e-8:\n                return UP\n            \n            mu_w = get_mu_w(u_tau)\n            y_plus = rho * u_tau * yP / mu_w\n            \n            if y_plus = Y_C:\n                U_plus_model = y_plus\n            else:\n                U_plus_model = (1.0 / KAPPA) * np.log(E * y_plus)\n            \n            U_plus_data = UP / u_tau\n            return U_plus_data - U_plus_model\n\n        # Bracket for u_tau: (0, large_number). \n        # residual(utau-0) is positive. residual(utau=UP) is likely negative.\n        u_tau_solution = brentq(utau_residual, 1e-6, UP * 2.0)\n\n        # --- Post-processing: Calculate final quantities ---\n        mu_w_final = get_mu_w(u_tau_solution)\n        y_plus_final = rho * u_tau_solution * yP / mu_w_final\n        \n        Pr_w = mu_w_final * cp / k_cond\n        \n        S_yplus = 1.0 - np.exp(-(y_plus_final / A)**2)\n        \n        Pr_t_unbounded = Pr_w + (PR_T_INF - Pr_w) * S_yplus\n        Pr_t_final = np.clip(Pr_t_unbounded, PR_T_MIN, PR_T_MAX)\n        \n        k_final = u_tau_solution**2 / np.sqrt(C_MU)\n        epsilon_final = u_tau_solution**3 / (KAPPA * yP)\n        \n        return [y_plus_final, Pr_t_final, k_final, epsilon_final]\n\n    results = []\n    for case in test_cases:\n        result_list = solve_case(case)\n        results.append(result_list)\n    \n    # Format the final output string exactly as required.\n    # e.g., [[yplus_A,Prt_A,k_A,epsilon_A],[yplus_B,...],...]\n    output_str = \"[\" + \",\".join([str(res) for res in results]) + \"]\"\n    print(output_str.replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "2494565"}]}