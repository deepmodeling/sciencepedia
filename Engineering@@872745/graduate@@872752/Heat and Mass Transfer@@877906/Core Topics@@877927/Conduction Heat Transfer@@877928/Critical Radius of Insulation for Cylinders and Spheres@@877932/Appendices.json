{"hands_on_practices": [{"introduction": "Before applying any physical formula, a crucial first step is to ensure its dimensional consistency. This practice grounds the concept of the critical radius by returning to first principles. By performing a dimensional analysis on the thermal conductivity, $k$, and the convective heat transfer coefficient, $h$, you will verify that their ratio indeed yields a unit of length, confirming the physical plausibility of the critical radius formula for a cylinder, $r_{c} = k/h$. [@problem_id:2476226]", "problem": "A long cylindrical rod is exposed to a fluid environment where heat is removed by external convection, and its surface is covered by an insulating layer characterized by thermal conductivity $k$. In analyzing whether a \"critical radius\" exists for such a cylindrical geometry, engineers commonly form a characteristic radius from the material property $k$ and the external convection heat transfer coefficient $h$. Before invoking any specific formula, verify that a radius constructed from $k$ and $h$ is dimensionally consistent by determining the base units of the ratio $k/h$ using first principles.\n\nStarting only from the fundamental constitutive statements for heat transfer,\n- Fourier’s law of heat conduction relating heat flux to temperature gradient, and\n- Newton’s law of cooling relating heat flux to a temperature difference,\nderive the International System of Units (SI) base units of $k$, the SI base units of $h$, and then the SI base units of the ratio $k/h$. Express your final result as the ordered quadruple of exponents corresponding to the SI base units $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s}, \\mathrm{K})$ for the ratio $k/h$.\n\nAnswer format requirements:\n- Provide the ordered quadruple of exponents as a single row matrix in the order $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s}, \\mathrm{K})$.\n- Do not include units or any additional text in your final boxed answer.\n- No rounding is necessary because the exponents are exact integers.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It requests a dimensional analysis of a ratio of two physical coefficients, derived from fundamental principles of heat transfer. The premises are the established laws of Fourier and Newton, and the objective is clearly defined. The problem is therefore valid, and a solution will be provided.\n\nThe objective is to determine the base units in the International System of Units (SI) for the ratio of thermal conductivity, $k$, to the convective heat transfer coefficient, $h$. This will be accomplished by first deriving the base units for $k$ and $h$ individually, starting from their defining constitutive relations. The fundamental dimensions are mass ($\\mathrm{M}$), length ($\\mathrm{L}$), time ($\\mathrm{T}$), and thermodynamic temperature ($\\Theta$). The corresponding SI base units are kilograms ($\\mathrm{kg}$), meters ($\\mathrm{m}$), seconds ($\\mathrm{s}$), and kelvins ($\\mathrm{K}$).\n\nFirst, we determine the dimensions of thermal conductivity, $k$. Fourier’s law of heat conduction, in one dimension, relates the heat flux, $q''$ (heat transfer rate per unit area), to the temperature gradient, $\\frac{dT}{dx}$. The law is expressed as:\n$$\nq'' = -k \\frac{dT}{dx}\n$$\nThe negative sign indicates that heat flows from higher to lower temperature, which has no bearing on the dimensional analysis. We rearrange the equation to isolate $k$:\n$$\nk = \\frac{|q''|}{|\\frac{dT}{dx}|}\n$$\nTo find the dimensions of $k$, denoted as $[k]$, we must determine the dimensions of $q''$ and $\\frac{dT}{dx}$. Heat flux $q''$ is power per unit area. Power is energy per unit time.\n$$\n[q''] = \\frac{[\\text{Power}]}{[\\text{Area}]} = \\frac{[\\text{Energy}]}{[\\text{Time}] \\cdot [\\text{Area}]}\n$$\nEnergy has dimensions of force times distance, and force has dimensions of mass times acceleration.\n$$\n[\\text{Energy}] = [\\text{Force}] \\cdot [\\text{Length}] = ([\\text{Mass}] \\cdot [\\text{Acceleration}]) \\cdot [\\text{Length}] = (\\mathrm{M} \\cdot \\mathrm{L}\\mathrm{T}^{-2}) \\cdot \\mathrm{L} = \\mathrm{M}\\mathrm{L}^2\\mathrm{T}^{-2}\n$$\nSubstituting this into the expression for the dimensions of heat flux:\n$$\n[q''] = \\frac{\\mathrm{M}\\mathrm{L}^2\\mathrm{T}^{-2}}{\\mathrm{T} \\cdot \\mathrm{L}^2} = \\mathrm{M}\\mathrm{T}^{-3}\n$$\nThe temperature gradient, $\\frac{dT}{dx}$, is the change in temperature over a distance. Its dimensions are:\n$$\n\\left[\\frac{dT}{dx}\\right] = \\frac{[\\text{Temperature}]}{[\\text{Length}]} = \\frac{\\Theta}{\\mathrm{L}} = \\Theta\\mathrm{L}^{-1}\n$$\nNow, we can find the dimensions of the thermal conductivity $k$:\n$$\n[k] = \\frac{[q'']}{\\left[\\frac{dT}{dx}\\right]} = \\frac{\\mathrm{M}\\mathrm{T}^{-3}}{\\Theta\\mathrm{L}^{-1}} = \\mathrm{M}\\mathrm{L}\\mathrm{T}^{-3}\\Theta^{-1}\n$$\nIn terms of SI base units, the unit of $k$ is $\\mathrm{kg} \\cdot \\mathrm{m} \\cdot \\mathrm{s}^{-3} \\cdot \\mathrm{K}^{-1}$. This corresponds to the typical unit $\\mathrm{W} \\cdot \\mathrm{m}^{-1} \\cdot \\mathrm{K}^{-1}$. The ordered quadruple of exponents for $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s}, \\mathrm{K})$ for $k$ is $(1, 1, -3, -1)$.\n\nNext, we determine the dimensions of the convective heat transfer coefficient, $h$. Newton’s law of cooling states that the heat flux from a surface is proportional to the difference in temperature, $\\Delta T$, between the surface and the surrounding fluid.\n$$\nq'' = h \\Delta T\n$$\nWe rearrange this equation to isolate $h$:\n$$\nh = \\frac{q''}{\\Delta T}\n$$\nThe dimensions of $h$, denoted as $[h]$, are given by the ratio of the dimensions of heat flux $[q'']$ and temperature difference $[\\Delta T]$. We have already established that $[q''] = \\mathrm{M}\\mathrm{T}^{-3}$. The temperature difference $\\Delta T$ has dimensions of temperature, $\\Theta$.\n$$\n[\\Delta T] = \\Theta\n$$\nTherefore, the dimensions of $h$ are:\n$$\n[h] = \\frac{[q'']}{[\\Delta T]} = \\frac{\\mathrm{M}\\mathrm{T}^{-3}}{\\Theta} = \\mathrm{M}\\mathrm{T}^{-3}\\Theta^{-1}\n$$\nIn terms of SI base units, the unit of $h$ is $\\mathrm{kg} \\cdot \\mathrm{s}^{-3} \\cdot \\mathrm{K}^{-1}$. This corresponds to the typical unit $\\mathrm{W} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{K}^{-1}$. The ordered quadruple of exponents for $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s}, \\mathrm{K})$ for $h$ is $(1, 0, -3, -1)$.\n\nFinally, we determine the dimensions of the ratio $k/h$.\n$$\n\\left[\\frac{k}{h}\\right] = \\frac{[k]}{[h]} = \\frac{\\mathrm{M}\\mathrm{L}\\mathrm{T}^{-3}\\Theta^{-1}}{\\mathrm{M}\\mathrm{T}^{-3}\\Theta^{-1}}\n$$\nCanceling the common terms ($\\mathrm{M}$, $\\mathrm{T}^{-3}$, and $\\Theta^{-1}$), we are left with:\n$$\n\\left[\\frac{k}{h}\\right] = \\mathrm{L}\n$$\nThe ratio $k/h$ has dimensions of length. This confirms that the quantity is dimensionally consistent with a radius, specifically, the critical radius of insulation for a cylinder. The corresponding SI base unit is the meter, $\\mathrm{m}$.\n\nThe problem requires the answer as an ordered quadruple of exponents for the SI base units $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s}, \\mathrm{K})$. Since the dimension of $k/h$ is length ($\\mathrm{L}$), the dimensional representation is $\\mathrm{M}^0\\mathrm{L}^1\\mathrm{T}^0\\Theta^0$. In terms of SI base units, this is $\\mathrm{kg}^0 \\cdot \\mathrm{m}^1 \\cdot \\mathrm{s}^0 \\cdot \\mathrm{K}^0$. The corresponding tuple of exponents is $(0, 1, 0, 0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  0  0\n\\end{pmatrix}\n}\n$$", "id": "2476226"}, {"introduction": "The existence of a critical radius leads to the counter-intuitive phenomenon where adding insulation can increase heat loss. This practice transitions from theoretical derivation to a concrete application for a spherical geometry. You will determine the specific range of insulation thicknesses where the decrease in convective resistance from a larger surface area outweighs the increase in conductive resistance, causing this paradoxical effect. [@problem_id:2476213]", "problem": "A solid sphere of radius $r_i=0.02$ m is covered by a concentric layer of thermal insulation of thermal conductivity $k=0.03$ W/m·K, producing an outer radius $r_o$. The external surface at $r=r_o$ exchanges heat with a surrounding fluid via convection with a uniform heat transfer coefficient $h$ that may vary in the interval $h \\in [2,50]$ W/m²·K. Assume steady, one-dimensional, spherically symmetric heat transfer, with a fixed temperature difference between the sphere surface at $r=r_i$ and the ambient fluid. Neglect radiation and any contact resistances.\n\nStarting only from conservation of energy and standard series addition of thermal resistances for conduction and convection, derive the condition under which an incremental increase in the insulation thickness (i.e., an increase in $r_o$ at fixed $r_i$, $k$, and $h$) increases the total heat loss from the sphere. Then, over the specified sweep of $h \\in [2,50]$ W/m²·K, determine the range of $r_o$ values (in meters) for which adding insulation increases the heat loss. Express your final result as two numbers giving the minimum and maximum admissible values of $r_o$ in meters, and round each to three significant figures. State your answer in meters.", "solution": "The problem statement is evaluated as valid. It is a scientifically grounded, well-posed problem in heat transfer that is objective and contains sufficient information for a unique solution.\n\nThe problem asks for the condition under which adding insulation to a sphere increases heat loss, and to determine the range of outer radii, $r_o$, for which this effect is possible given a range of convection coefficients, $h$.\n\nLet $r_i$ be the inner radius of the insulation (the radius of the solid sphere), $r_o$ be the outer radius of the insulation, $k$ be the thermal conductivity of the insulation, and $h$ be the convective heat transfer coefficient at the outer surface. The surrounding fluid is at a temperature $T_\\infty$, and the surface of the inner sphere is at a fixed temperature $T_i$. We assume $T_i > T_\\infty$.\n\nThe total heat transfer rate, $q$, from the sphere to the ambient fluid is governed by the total thermal resistance, $R_{total}$, and the overall temperature difference, $\\Delta T = T_i - T_\\infty$.\nThe total thermal resistance is the sum of the resistance due to conduction through the spherical insulation layer, $R_{cond}$, and the resistance due to convection from the outer surface, $R_{conv}$.\n\nThe conduction resistance for a spherical shell of inner radius $r_i$ and outer radius $r_o$ is given by:\n$$R_{cond} = \\frac{r_o - r_i}{4 \\pi k r_i r_o} = \\frac{1}{4 \\pi k} \\left(\\frac{1}{r_i} - \\frac{1}{r_o}\\right)$$\n\nThe convection resistance at the outer surface of area $A_o = 4 \\pi r_o^2$ is:\n$$R_{conv} = \\frac{1}{h A_o} = \\frac{1}{h (4 \\pi r_o^2)}$$\n\nThe total thermal resistance is the sum of these two resistances in series:\n$$R_{total} = R_{cond} + R_{conv} = \\frac{1}{4 \\pi k} \\left(\\frac{1}{r_i} - \\frac{1}{r_o}\\right) + \\frac{1}{4 \\pi h r_o^2}$$\nThis can be written as:\n$$R_{total} = \\frac{1}{4 \\pi} \\left[ \\frac{1}{k} \\left(\\frac{1}{r_i} - \\frac{1}{r_o}\\right) + \\frac{1}{h r_o^2} \\right]$$\n\nThe rate of heat transfer is given by Fourier's law, which in this context is analogous to Ohm's law:\n$$q = \\frac{\\Delta T}{R_{total}} = \\frac{T_i - T_\\infty}{R_{total}}$$\n\nAdding insulation means increasing the outer radius $r_o$. The problem asks for the condition under which this action increases the total heat loss, $q$. Since $q$ is inversely proportional to $R_{total}$ for a fixed $\\Delta T$, an increase in $q$ corresponds to a decrease in $R_{total}$. Therefore, we must find the condition for which $\\frac{d R_{total}}{d r_o}  0$.\n\nWe differentiate the expression for $R_{total}$ with respect to $r_o$, treating $r_i$, $k$, and $h$ as constants:\n$$\\frac{d R_{total}}{d r_o} = \\frac{d}{d r_o} \\left\\{ \\frac{1}{4 \\pi} \\left[ \\frac{1}{k r_i} - \\frac{1}{k r_o} + \\frac{1}{h r_o^2} \\right] \\right\\}$$\nThe first term, $\\frac{1}{4 \\pi k r_i}$, is a constant with respect to $r_o$, so its derivative is zero.\n$$\\frac{d R_{total}}{d r_o} = \\frac{1}{4 \\pi} \\left[ \\frac{d}{d r_o} \\left(-\\frac{1}{k r_o}\\right) + \\frac{d}{d r_o} \\left(\\frac{1}{h r_o^2}\\right) \\right]$$\n$$\\frac{d R_{total}}{d r_o} = \\frac{1}{4 \\pi} \\left[ - \\frac{1}{k} \\left(-\\frac{1}{r_o^2}\\right) + \\frac{1}{h} \\left(-\\frac{2}{r_o^3}\\right) \\right]$$\n$$\\frac{d R_{total}}{d r_o} = \\frac{1}{4 \\pi} \\left[ \\frac{1}{k r_o^2} - \\frac{2}{h r_o^3} \\right]$$\n\nThe condition for increasing heat loss is $\\frac{d R_{total}}{d r_o}  0$:\n$$\\frac{1}{4 \\pi} \\left[ \\frac{1}{k r_o^2} - \\frac{2}{h r_o^3} \\right]  0$$\nSince the leading factor $\\frac{1}{4 \\pi}$ is positive, we can simplify the inequality to:\n$$\\frac{1}{k r_o^2} - \\frac{2}{h r_o^3}  0$$\n$$\\frac{1}{k r_o^2}  \\frac{2}{h r_o^3}$$\nMultiplying both sides by the positive quantity $h k r_o^3$ yields:\n$$h r_o  2k$$\n$$r_o  \\frac{2k}{h}$$\nThis is the first part of the required answer: the general condition under which adding insulation increases heat loss. The expression $r_{c,s} = \\frac{2k}{h}$ is known as the critical radius of insulation for a sphere. Heat loss increases with added insulation thickness as long as the outer radius $r_o$ is less than this critical radius.\n\nFor the second part, we must determine the range of $r_o$ values for which this phenomenon can occur, given the specified range of the heat transfer coefficient, $h \\in [2, 50]$ W/m²·K. The other parameters are fixed: $r_i = 0.02$ m and $k = 0.03$ W/m·K.\n\nThe condition for increasing heat loss for a given $h$ is $r_i  r_o  \\frac{2k}{h}$. The problem asks for the range of $r_o$ values for which there exists at least one value of $h$ in the interval $[2, 50]$ that satisfies this condition.\n\nWe are looking for the set of all $r_o > r_i$ such that there exists an $h \\in [2, 50]$ for which $r_o  \\frac{2k}{h}$.\nThis is equivalent to finding the range of $r_o$ values such that $r_o  \\max_{h \\in [2, 50]} \\left(\\frac{2k}{h}\\right)$.\nThe function $f(h) = \\frac{2k}{h}$ is a monotonically decreasing function of $h$. Its maximum value on the interval $[2, 50]$ will occur at the minimum value of $h$, which is $h_{min} = 2$ W/m²·K.\n\nThe maximum possible critical radius is:\n$$r_{c,max} = \\frac{2k}{h_{min}} = \\frac{2(0.03 \\text{ W/m·K})}{2 \\text{ W/m}²\\text{·K}} = 0.03 \\text{ m}$$\nThe condition $r_o  r_{c,max}$ must be satisfied. Also, for insulation to exist, its outer radius $r_o$ must be greater than its inner radius $r_i$.\nSo, the full range of possible $r_o$ values is $r_i  r_o  r_{c,max}$.\n\nSubstituting the given and calculated values:\n$$0.02 \\text{ m}  r_o  0.03 \\text{ m}$$\nAny outer radius $r_o$ within this interval will have a corresponding range of $h$ values within $[2, 50]$ for which adding more insulation will increase heat loss.\nFor example, if we have a layer of insulation with $r_o = 0.025$ m, heat loss will increase with added insulation if $0.025  \\frac{2(0.03)}{h}$, which implies $h  \\frac{0.06}{0.025} = 2.4$ W/m²·K. Since the interval $[2, 2.4)$ is a non-empty subset of the allowed range for $h$, an outer radius of $r_o = 0.025$ m is part of the solution range.\n\nThe problem asks for the minimum and maximum admissible values of $r_o$ for which this phenomenon is possible. These are the bounds of the derived interval $(0.02, 0.03)$ m.\nMinimum admissible value of $r_o = r_i = 0.02$ m.\nMaximum admissible value of $r_o = r_{c,max} = 0.03$ m.\n\nRounding these values to three significant figures, we get $0.0200$ m and $0.0300$ m.", "answer": "$$\\boxed{\\begin{pmatrix} 0.0200  0.0300 \\end{pmatrix}}$$", "id": "2476213"}, {"introduction": "In practical engineering scenarios, material properties and boundary conditions are often unknown and must be inferred from experimental data, which inevitably contains noise. This advanced practice bridges theory and experiment by framing parameter estimation as an inverse problem. You will use noisy measurements of heat flow and surface temperature to estimate the thermal conductivity $k$ and convection coefficient $h$, and then propagate the experimental uncertainty to determine a confidence interval for the calculated critical radius. [@problem_id:2476238]", "problem": "You are given a steady-state, spherically symmetric heat transfer scenario: a solid sphere of known inner radius with a concentric, homogeneous insulating layer is exposed to a surrounding fluid at a known, uniform ambient temperature. The sphere’s core is maintained at a known, uniform temperature by an internal heater. Heat escapes radially through the insulation to the outer surface, where it is convected to the fluid. The outer surface temperature and the heater input rate are measured with small but nonzero noise. Your task is to formulate and solve an inverse problem to estimate the convective heat transfer coefficient and the thermal conductivity of the insulation, and then infer the critical radius of insulation for a sphere, together with an approximate confidence interval.\n\nUse the following fundamental base:\n- The total steady heat rate for one-dimensional, radial conduction through a spherical shell from inner radius $r_i$ to outer radius $r_o$ with thermal conductivity $k$ is given by the concept of thermal resistance: the conduction resistance is $R_{\\text{cond}} = \\dfrac{1}{4 \\pi k} \\left(\\dfrac{1}{r_i} - \\dfrac{1}{r_o}\\right)$.\n- The convective boundary at the outer surface has a convective resistance $R_{\\text{conv}} = \\dfrac{1}{h A_o}$, where $A_o = 4 \\pi r_o^2$ is the outer surface area and $h$ is the convective heat transfer coefficient.\n- The total resistance is $R_{\\text{tot}} = R_{\\text{cond}} + R_{\\text{conv}}$. The steady heat rate and the temperature drop across the network obey $Q = \\dfrac{\\Delta T}{R_{\\text{tot}}}$ with $\\Delta T = T_i - T_\\infty$. The outer surface temperature satisfies $T_s = T_\\infty + Q R_{\\text{conv}}$.\n\nStarting from these bases only, you must:\n- Derive the model equations that relate the measurements $\\{Q_j, T_{s,j}\\}$ at various outer radii $r_{o,j}$ to the unknown parameters $h$ and $k$.\n- Formulate a weighted nonlinear least-squares inverse problem to estimate $h$ and $k$ from the data, explicitly defining the residual vector and its weighting using known measurement standard deviations.\n- Compute the approximate covariance matrix of the estimated parameters using a linearized (Gauss–Newton) approximation based on the Jacobian of the residuals at the solution.\n- Derive the expression for the spherical critical radius of insulation $r_c$ in terms of $h$ and $k$ by minimizing the total thermal resistance with respect to the outer radius $r_o$, and then compute $r_c$ from your estimates.\n- Propagate the parameter uncertainty to obtain an approximate $95\\%$ confidence interval for $r_c$ using first-order uncertainty propagation (the delta method).\n\nYou must solve the following test suite of three cases. For each case, all quantities in the following lists are given in SI units. When a quantity is a number, it must be treated as the exact value shown.\n\nFor each case, you are provided:\n- Inner radius $r_i$ (in $\\text{m}$), ambient temperature $T_\\infty$ (in $\\text{K}$), and inner surface/core temperature $T_i$ (in $\\text{K}$).\n- A list of outer radii $\\{r_{o,j}\\}_{j=1}^N$ (in $\\text{m}$), with $N \\ge 3$ distinct radii.\n- Measured heater input rates $\\{Q_j\\}_{j=1}^N$ (in $\\text{W}$) and measured outer surface temperatures $\\{T_{s,j}\\}_{j=1}^N$ (in $\\text{K}$) at those radii.\n- Known measurement standard deviations $\\sigma_Q$ (in $\\text{W}$) for all $Q_j$ and $\\sigma_T$ (in $\\text{K}$) for all $T_{s,j}$.\n\nCase $1$:\n- $r_i = 0.05\\,\\text{m}$, $T_\\infty = 293\\,\\text{K}$, $T_i = 373\\,\\text{K}$.\n- $\\{r_{o,j}\\} = [\\,0.055,\\,0.06,\\,0.07\\,]\\,\\text{m}$.\n- $\\{Q_j\\}\\,(\\text{W}) = [\\,17.537,\\,12.684,\\,9.008\\,]$.\n- $\\{T_{s,j}\\}\\,(\\text{K}) = [\\,330.999,\\,316.640,\\,305.068\\,]$.\n- $\\sigma_Q = 0.2\\,\\text{W}$, $\\sigma_T = 0.2\\,\\text{K}$.\n\nCase $2$:\n- $r_i = 0.02\\,\\text{m}$, $T_\\infty = 300\\,\\text{K}$, $T_i = 350\\,\\text{K}$.\n- $\\{r_{o,j}\\} = [\\,0.03,\\,0.04,\\,0.06\\,]\\,\\text{m}$.\n- $\\{Q_j\\}\\,(\\text{W}) = [\\,1.0034,\\,0.8225,\\,0.7170\\,]$.\n- $\\{T_{s,j}\\}\\,(\\text{K}) = [\\,317.337,\\,308.365,\\,303.096\\,]$.\n- $\\sigma_Q = 0.02\\,\\text{W}$, $\\sigma_T = 0.05\\,\\text{K}$.\n\nCase $3$:\n- $r_i = 0.01\\,\\text{m}$, $T_\\infty = 300\\,\\text{K}$, $T_i = 360\\,\\text{K}$.\n- $\\{r_{o,j}\\} = [\\,0.015,\\,0.02,\\,0.03\\,]\\,\\text{m}$.\n- $\\{Q_j\\}\\,(\\text{W}) = [\\,0.7655,\\,0.8246,\\,0.7605\\,]$.\n- $\\{T_{s,j}\\}\\,(\\text{K}) = [\\,334.200,\\,319.974,\\,308.615\\,]$.\n- $\\sigma_Q = 0.02\\,\\text{W}$, $\\sigma_T = 0.05\\,\\text{K}$.\n\nImplementation requirements:\n- Formulate a single program that, for each case, solves for the estimates $\\hat{h}$ and $\\hat{k}$ by minimizing the weighted sum of squared residuals that stack the heat rate and surface temperature equations at each provided $r_{o,j}$.\n- Use bound constraints to enforce $h > 0$ and $k > 0$.\n- Use the linearized covariance approximation $C_{\\theta} \\approx (J^\\top J)^{-1}$, where $J$ is the Jacobian of the weighted residual vector with respect to $\\theta = [\\,h,\\,k\\,]^\\top$ evaluated at the solution.\n- Using your derived expression for the spherical critical radius $r_c$ as a function of $h$ and $k$, compute $\\hat{r}_c$ and an approximate $95\\%$ confidence interval via first-order propagation: $\\text{Var}(r_c) \\approx \\nabla r_c^\\top C_{\\theta} \\nabla r_c$ and the interval $\\hat{r}_c \\pm z_{0.975}\\sqrt{\\text{Var}(r_c)}$ with $z_{0.975} = 1.96$.\n\nAnswer specification and output format:\n- For each case, return a list of three floating-point numbers in meters: $[\\,\\hat{r}_c,\\,r_{c,\\text{lo}},\\,r_{c,\\text{hi}}\\,]$, where the bounds correspond to the $95\\%$ confidence interval based on the linearized propagation.\n- Express all three numbers in meters, each rounded to exactly six digits after the decimal point.\n- Your program should produce a single line of output containing the results for all three cases as a comma-separated list of lists, enclosed in square brackets; for example: \"[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33]]\", where each \"xij\" is the required float with six digits after the decimal point and no units or additional text.", "solution": "We start from steady, one-dimensional radial conduction in a spherical shell. Fourier’s law for steady radial conduction with constant thermal conductivity $k$ and spherically symmetric temperature field $T(r)$ gives the heat rate\n$$\nQ = - k A(r) \\frac{dT}{dr}, \\quad A(r) = 4 \\pi r^2,\n$$\nwhich is constant with respect to $r$ under steady conditions. Integrating between $r_i$ and $r_o$ and eliminating the temperature gradient yields the well-known conduction thermal resistance of a spherical shell,\n$$\nR_{\\text{cond}} = \\frac{T(r_i) - T(r_o)}{Q} = \\frac{1}{4 \\pi k} \\left(\\frac{1}{r_i} - \\frac{1}{r_o}\\right).\n$$\nAt the outer surface, the convective boundary condition with a uniform ambient temperature $T_\\infty$ and a constant convective heat transfer coefficient $h$ gives a convective resistance\n$$\nR_{\\text{conv}} = \\frac{T(r_o) - T_\\infty}{Q} = \\frac{1}{h A_o} = \\frac{1}{4 \\pi h r_o^2}.\n$$\nThese resistances in series sum to the total resistance,\n$$\nR_{\\text{tot}} = R_{\\text{cond}} + R_{\\text{conv}} = \\frac{1}{4 \\pi k} \\left(\\frac{1}{r_i} - \\frac{1}{r_o}\\right) + \\frac{1}{4 \\pi h r_o^2}.\n$$\nLet $\\Delta T = T_i - T_\\infty$, where $T_i$ is the inner surface/core temperature and $T_\\infty$ is the ambient temperature. The steady heat rate from the core to the ambient is\n$$\nQ(h,k;r_o) = \\frac{\\Delta T}{R_{\\text{tot}}(h,k;r_o)}.\n$$\nThe outer surface temperature is\n$$\nT_s(h,k;r_o) = T_\\infty + Q(h,k;r_o)\\,R_{\\text{conv}}(h;r_o) = T_\\infty + Q(h,k;r_o)\\,\\frac{1}{4 \\pi h r_o^2}.\n$$\n\nInverse problem formulation:\nWe are given $N$ measurement pairs $\\{(Q_j^{\\text{meas}}, T_{s,j}^{\\text{meas}})\\}_{j=1}^N$ at outer radii $\\{r_{o,j}\\}_{j=1}^N$, together with known standard deviations $\\sigma_Q$ for heat rate measurements and $\\sigma_T$ for surface temperature measurements. Define the residual vector by stacking weighted residuals from both equations:\n$$\n\\mathbf{r}(h,k) =\n\\begin{bmatrix}\n\\left(Q(h,k;r_{o,1}) - Q_1^{\\text{meas}}\\right)/\\sigma_Q\\\\\n\\vdots\\\\\n\\left(Q(h,k;r_{o,N}) - Q_N^{\\text{meas}}\\right)/\\sigma_Q\\\\\n\\left(T_s(h,k;r_{o,1}) - T_{s,1}^{\\text{meas}}\\right)/\\sigma_T\\\\\n\\vdots\\\\\n\\left(T_s(h,k;r_{o,N}) - T_{s,N}^{\\text{meas}}\\right)/\\sigma_T\\\\\n\\end{bmatrix}.\n$$\nWe estimate $\\theta = [\\,h,\\,k\\,]^\\top$ by solving the weighted nonlinear least-squares problem\n$$\n\\min_{h>0,\\,k>0} \\; \\|\\mathbf{r}(h,k)\\|_2^2.\n$$\nThis is solved numerically with bound constraints $h>0$, $k>0$.\n\nModel reparameterization and Jacobian:\nFor numerical stability and analytic derivatives, define for each measurement $j$,\n$$\nA_j = \\frac{1}{4 \\pi}\\left(\\frac{1}{r_i} - \\frac{1}{r_{o,j}}\\right), \\qquad B_j = \\frac{1}{4 \\pi r_{o,j}^2}, \\qquad D_j(h,k) = \\frac{A_j}{k} + \\frac{B_j}{h}.\n$$\nThen\n$$\nQ_j(h,k) = \\frac{\\Delta T}{D_j(h,k)}, \\qquad T_{s,j}(h,k) = T_\\infty + Q_j(h,k)\\,\\frac{B_j}{h}.\n$$\nThe partial derivatives needed for the Gauss–Newton Jacobian are\n$$\n\\frac{\\partial Q_j}{\\partial k} = \\frac{\\Delta T\\,A_j}{D_j(h,k)^2\\,k^2}, \\qquad\n\\frac{\\partial Q_j}{\\partial h} = \\frac{\\Delta T\\,B_j}{D_j(h,k)^2\\,h^2},\n$$\nand\n$$\n\\frac{\\partial T_{s,j}}{\\partial k} = \\frac{\\partial Q_j}{\\partial k}\\,\\frac{B_j}{h}, \\qquad\n\\frac{\\partial T_{s,j}}{\\partial h} = \\frac{\\partial Q_j}{\\partial h}\\,\\frac{B_j}{h} - Q_j(h,k)\\,\\frac{B_j}{h^2}.\n$$\nStacking these and applying the measurement weights yields the Jacobian $J = \\partial \\mathbf{r} / \\partial \\theta$.\n\nParameter covariance and uncertainty propagation:\nAt the minimizing solution $\\hat{\\theta} = [\\,\\hat{h},\\,\\hat{k}\\,]^\\top$, the linearized covariance of the estimator is approximated by\n$$\nC_{\\theta} \\approx \\left(J(\\hat{\\theta})^\\top J(\\hat{\\theta})\\right)^{-1}.\n$$\n\nCritical radius of insulation for a sphere:\nTo obtain the spherical critical radius, minimize the total resistance with respect to the outer radius $r_o$ while holding $h$ and $k$ fixed. Since $Q = \\Delta T / R_{\\text{tot}}$, maximizing $Q$ is equivalent to minimizing $R_{\\text{tot}}$:\n$$\nR_{\\text{tot}}(r_o) = \\frac{1}{4 \\pi k}\\left(\\frac{1}{r_i} - \\frac{1}{r_o}\\right) + \\frac{1}{4 \\pi h r_o^2}.\n$$\nDifferentiating with respect to $r_o$ and setting the derivative to zero,\n$$\n\\frac{d R_{\\text{tot}}}{d r_o} = \\frac{1}{4\\pi}\\left(\\frac{1}{k r_o^2} - \\frac{2}{h r_o^3}\\right) = 0\n\\quad \\Longrightarrow \\quad \\frac{1}{k r_o^2} = \\frac{2}{h r_o^3}\n\\quad \\Longrightarrow \\quad r_o = \\frac{2k}{h}.\n$$\nThus the spherical critical radius of insulation is\n$$\nr_c(h,k) = \\frac{2k}{h}.\n$$\n\nUncertainty propagation to $r_c$ uses the delta method. With $\\theta = [\\,h,\\,k\\,]^\\top$ and\n$$\ng(\\theta) = r_c(\\theta) = \\frac{2k}{h}, \\qquad \\nabla g(\\theta) = \\begin{bmatrix} \\dfrac{\\partial g}{\\partial h} \\\\ \\dfrac{\\partial g}{\\partial k}\\end{bmatrix} = \\begin{bmatrix} -\\dfrac{2k}{h^2} \\\\ \\dfrac{2}{h} \\end{bmatrix},\n$$\nthe variance of $r_c$ is approximated by\n$$\n\\text{Var}(r_c) \\approx \\nabla g(\\hat{\\theta})^\\top C_{\\theta} \\nabla g(\\hat{\\theta}),\n$$\nand the approximate $95\\%$ confidence interval is\n$$\n\\hat{r}_c \\pm z_{0.975}\\,\\sqrt{\\text{Var}(r_c)}, \\quad z_{0.975} = 1.96.\n$$\n\nAlgorithmic procedure for each case:\n- Assemble $r_i$, $T_\\infty$, $T_i$, lists $\\{r_{o,j}\\}$, $\\{Q_j^{\\text{meas}}\\}$, $\\{T_{s,j}^{\\text{meas}}\\}$, and $\\sigma_Q$, $\\sigma_T$.\n- Define the residual function $\\mathbf{r}(h,k)$ and its Jacobian using the formulas above.\n- Solve the bound-constrained nonlinear least-squares problem with an initial guess $h>0$, $k>0$.\n- Compute $C_{\\theta}$ from the Jacobian at the solution.\n- Compute $\\hat{r}_c = 2 \\hat{k} / \\hat{h}$, its gradient at $\\hat{\\theta}$, the propagated variance, and the $95\\%$ bounds.\n- Report $[\\,\\hat{r}_c,\\,r_{c,\\text{lo}},\\,r_{c,\\text{hi}}\\,]$ in meters, each rounded to six decimals.\n\nNumerical execution:\nApplying the above to the provided test suite with the specified measurement data and weights produces, for each case, an estimate $\\hat{r}_c$ and an approximate $95\\%$ confidence interval obtained from the linearized covariance. The final program aggregates the three case outputs into a single line formatted as a list of lists as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve_case(case):\n    # Unpack case\n    r_i = case[\"r_i\"]\n    T_inf = case[\"T_inf\"]\n    T_i = case[\"T_i\"]\n    r_o = np.array(case[\"r_o\"], dtype=float)\n    Q_meas = np.array(case[\"Q_meas\"], dtype=float)\n    Ts_meas = np.array(case[\"Ts_meas\"], dtype=float)\n    sigma_Q = float(case[\"sigma_Q\"])\n    sigma_T = float(case[\"sigma_T\"])\n\n    dT = T_i - T_inf\n    # Precompute A_j and B_j terms for efficiency\n    A = (1.0 / (4.0 * np.pi)) * (1.0 / r_i - 1.0 / r_o)\n    B = 1.0 / (4.0 * np.pi * r_o**2)\n\n    def model_Q_Ts(params):\n        h, k = params\n        # Avoid division by zero in intermediate computations\n        D = A / k + B / h\n        Q = dT / D\n        Ts = T_inf + Q * (B / h)\n        return Q, Ts\n\n    def residuals(params):\n        Q, Ts = model_Q_Ts(params)\n        res_Q = (Q - Q_meas) / sigma_Q\n        res_Ts = (Ts - Ts_meas) / sigma_T\n        return np.concatenate([res_Q, res_Ts])\n\n    def jacobian(params):\n        h, k = params\n        D = A / k + B / h\n        Q = dT / D\n        # Derivatives of Q\n        dQ_dk = (dT * A) / (D**2 * k**2)\n        dQ_dh = (dT * B) / (D**2 * h**2)\n        # Derivatives of Ts\n        dTs_dk = dQ_dk * (B / h)\n        dTs_dh = dQ_dh * (B / h) - Q * (B / h**2)\n\n        # Weighted Jacobian blocks\n        # For residuals defined as (model - data)/sigma, Jacobian is (d model / d theta)/sigma\n        J_top = np.stack([dQ_dh / sigma_Q, dQ_dk / sigma_Q], axis=1)\n        J_bottom = np.stack([dTs_dh / sigma_T, dTs_dk / sigma_T], axis=1)\n        J = np.vstack([J_top, J_bottom])\n        return J\n\n    # Initial guess and bounds (h, k)\n    x0 = np.array([10.0, 0.1])  # reasonable generic start\n    lb = np.array([1e-6, 1e-6])\n    ub = np.array([1e6, 1e3])   # wide upper bounds\n\n    res = least_squares(residuals, x0, jac=jacobian, bounds=(lb, ub), method='trf', xtol=1e-12, ftol=1e-12, gtol=1e-12, max_nfev=10000)\n    h_hat, k_hat = res.x\n\n    # Compute Jacobian at solution and covariance approximation\n    J_hat = jacobian(res.x)\n    # Covariance of parameters for weighted least squares with known variances: (J^T J)^{-1}\n    JTJ = J_hat.T @ J_hat\n    # Use pseudo-inverse safeguard if ill-conditioned\n    try:\n        Cov = np.linalg.inv(JTJ)\n    except np.linalg.LinAlgError:\n        Cov = np.linalg.pinv(JTJ)\n\n    # Critical radius for sphere and its uncertainty\n    rc_hat = 2.0 * k_hat / h_hat\n    # Gradient wrt [h, k]: [-2k/h^2, 2/h]\n    grad = np.array([-2.0 * k_hat / (h_hat**2), 2.0 / h_hat])\n    var_rc = float(grad.T @ Cov @ grad)\n    # Numerical safety: variance must be non-negative\n    var_rc = max(var_rc, 0.0)\n    se_rc = np.sqrt(var_rc)\n    z = 1.96\n    lo = rc_hat - z * se_rc\n    hi = rc_hat + z * se_rc\n    return rc_hat, lo, hi\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"r_i\": 0.05,\n            \"T_inf\": 293.0,\n            \"T_i\": 373.0,\n            \"r_o\": [0.055, 0.06, 0.07],\n            \"Q_meas\": [17.537, 12.684, 9.008],\n            \"Ts_meas\": [330.999, 316.640, 305.068],\n            \"sigma_Q\": 0.2,\n            \"sigma_T\": 0.2,\n        },\n        {\n            \"r_i\": 0.02,\n            \"T_inf\": 300.0,\n            \"T_i\": 350.0,\n            \"r_o\": [0.03, 0.04, 0.06],\n            \"Q_meas\": [1.0034, 0.8225, 0.7170],\n            \"Ts_meas\": [317.337, 308.365, 303.096],\n            \"sigma_Q\": 0.02,\n            \"sigma_T\": 0.05,\n        },\n        {\n            \"r_i\": 0.01,\n            \"T_inf\": 300.0,\n            \"T_i\": 360.0,\n            \"r_o\": [0.015, 0.02, 0.03],\n            \"Q_meas\": [0.7655, 0.8246, 0.7605],\n            \"Ts_meas\": [334.200, 319.974, 308.615],\n            \"sigma_Q\": 0.02,\n            \"sigma_T\": 0.05,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        rc_hat, lo, hi = solve_case(case)\n        results.append([rc_hat, lo, hi])\n\n    # Format with exactly six digits after the decimal point and no spaces\n    def fmt(x):\n        return f\"{x:.6f}\"\n    line = \"[\" + \",\".join(\"[\" + \",\".join(fmt(v) for v in row) + \"]\" for row in results) + \"]\"\n    print(line)\n\nsolve()\n```", "id": "2476238"}]}