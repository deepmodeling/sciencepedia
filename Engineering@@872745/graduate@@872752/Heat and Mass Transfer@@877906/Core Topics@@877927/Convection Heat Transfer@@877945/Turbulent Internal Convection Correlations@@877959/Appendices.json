{"hands_on_practices": [{"introduction": "The study of turbulent convection is built upon the relationships between dimensionless groups that govern the physics of fluid flow and heat transfer. The Chilton-Colburn analogy, for instance, provides a powerful, albeit approximate, link between momentum transfer (friction factor $f$) and heat transfer (Stanton number $St$). This practice will challenge you to manipulate the fundamental definitions of the Nusselt ($Nu$), Reynolds ($Re$), Prandtl ($Pr$), and Stanton numbers to quantitatively evaluate the accuracy of this famous analogy for a given flow condition ([@problem_id:2535768]). Mastering these relationships is essential for both conceptual understanding and practical estimation.", "problem": "A fully developed turbulent flow of a single-phase, Newtonian fluid in a hydraulically smooth, straight circular tube is operated under uniform wall heat flux and steady conditions. Measurements at a fixed axial location yield the following dimensionless data based on bulk-fluid properties: the Nusselt number $Nu=505$, the Reynolds number $Re=8.00\\times 10^{4}$, the Prandtl number $Pr=6.20$, and the Darcy–Weisbach friction factor $f=0.0210$. Using only fundamental definitions of the Nusselt number, Reynolds number, Prandtl number, Stanton number, and the Chilton–Colburn heat-transfer factor, compute the heat-transfer $j$-factor and then quantitatively assess the turbulent smooth-tube analogy by forming the ratio\n$$\nR \\equiv \\frac{j_H}{f/2}.\n$$\nFor the purpose of this assessment, adopt the definition of the Chilton–Colburn heat-transfer factor as $j_H \\equiv St\\,Pr^{2/3}$, where the Stanton number is defined as $St \\equiv \\dfrac{h}{\\rho u c_p}$, and use the standard dimensionless definitions $Nu \\equiv \\dfrac{h D}{k}$, $Re \\equiv \\dfrac{\\rho u D}{\\mu}$, and $Pr \\equiv \\dfrac{\\mu c_p}{k}$. Express your final answer as the single number $R$, rounded to four significant figures. Report the answer as a pure number (dimensionless).", "solution": "The problem requires the computation of the ratio $R$, defined as:\n$$R \\equiv \\dfrac{j_H}{f/2}$$\nThe analysis will proceed by first deriving an expression for the Chilton-Colburn heat-transfer factor, $j_H$, in terms of the given dimensionless parameters $Nu$, $Re$, and $Pr$.\n\nThe problem provides the definition for $j_H$ as:\n$$j_H \\equiv St \\cdot Pr^{2/3}$$\nwhere $St$ is the Stanton number, defined as $St \\equiv \\dfrac{h}{\\rho u c_p}$. To proceed, we must establish a relationship between the Stanton number and the given dimensionless groups $Nu$, $Re$, and $Pr$.\n\nWe use the provided definitions: $Nu \\equiv \\dfrac{hD}{k}$, $Re \\equiv \\dfrac{\\rho u D}{\\mu}$, and $Pr \\equiv \\dfrac{\\mu c_p}{k}$. Let us form the product of the Reynolds and Prandtl numbers:\n$$Re \\cdot Pr = \\left(\\dfrac{\\rho u D}{\\mu}\\right) \\left(\\dfrac{\\mu c_p}{k}\\right) = \\dfrac{\\rho u D c_p}{k}$$\nNow, we form the ratio of the Nusselt number to this product:\n$$\\dfrac{Nu}{Re \\cdot Pr} = \\dfrac{\\dfrac{hD}{k}}{\\dfrac{\\rho u D c_p}{k}} = \\dfrac{hD}{k} \\cdot \\dfrac{k}{\\rho u D c_p} = \\dfrac{h}{\\rho u c_p}$$\nBy definition, the right-hand side is the Stanton number, $St$. This establishes the fundamental identity:\n$$St = \\dfrac{Nu}{Re \\cdot Pr}$$\nWe substitute this identity into the definition of the Chilton-Colburn factor:\n$$j_H = St \\cdot Pr^{2/3} = \\left(\\dfrac{Nu}{Re \\cdot Pr}\\right) Pr^{2/3} = \\dfrac{Nu}{Re \\cdot Pr^{1-2/3}} = \\dfrac{Nu}{Re \\cdot Pr^{1/3}}$$\nNow we can write the final expression for the ratio $R$ purely in terms of the provided data:\n$$R = \\dfrac{j_H}{f/2} = \\dfrac{\\dfrac{Nu}{Re \\cdot Pr^{1/3}}}{\\dfrac{f}{2}} = \\dfrac{2 \\cdot Nu}{f \\cdot Re \\cdot Pr^{1/3}}$$\nThe problem provides the following numerical values: $Nu = 505$, $Re = 8.00\\times 10^{4}$, $Pr = 6.20$, and $f = 0.0210$. Substituting these values into the derived expression for $R$:\n$$R = \\dfrac{2 \\cdot 505}{(0.0210) \\cdot (8.00 \\times 10^{4}) \\cdot (6.20)^{1/3}}$$\nFirst, we compute the denominator:\n$$(0.0210) \\cdot (8.00 \\times 10^{4}) = 1680$$\nThe expression becomes:\n$$R = \\dfrac{1010}{1680 \\cdot (6.20)^{1/3}}$$\nThe cube root of the Prandtl number is approximately $(6.20)^{1/3} \\approx 1.837302$.\n$$R \\approx \\dfrac{1010}{1680 \\cdot 1.837302} \\approx \\dfrac{1010}{3086.6675}$$\n$$R \\approx 0.327218$$\nThe problem requires the answer to be rounded to four significant figures.\n$$R \\approx 0.3272$$\nThis result provides a quantitative assessment of the Chilton-Colburn analogy in the form $j_H \\approx f/2$. A value of $R=1$ would indicate perfect agreement. The computed value, which is derived directly from the provided experimental data and fundamental definitions, demonstrates that for these specific operating conditions, the analogy in this particular form does not hold well.", "answer": "$$\\boxed{0.3272}$$", "id": "2535768"}, {"introduction": "While many correlations are derived for \"fully developed\" conditions where heat transfer coefficients are constant, real engineering systems often involve thermal entrance regions where local coefficients are significantly higher. The average heat transfer coefficient over a finite length is found by integrating this local coefficient along the flow direction. This practice guides you through the process of deriving the length-averaged Nusselt number, $Nu_{\\text{m}}$, from a model for the local Nusselt number, $Nu_x$ ([@problem_id:2535758]). This exercise highlights the importance of entrance effects and demonstrates how to quantify the resulting enhancement in heat transfer.", "problem": "A hydrodynamically fully developed turbulent flow of liquid water in a smooth, circular tube encounters a uniformly heated section. Upstream of the heated section the tube wall is adiabatic and sufficiently long to ensure hydrodynamic development. The heated length is $L = 0.50\\,\\text{m}$, the inner diameter is $D = 0.050\\,\\text{m}$, and the mass flow rate is $\\dot{m} = 1.50\\,\\text{kg}\\,\\text{s}^{-1}$. At the inlet temperature, take the fluid properties to be constant and equal to $\\rho = 997\\,\\text{kg}\\,\\text{m}^{-3}$, $\\mu = 6.00\\times 10^{-4}\\,\\text{Pa}\\cdot\\text{s}$, $k = 0.650\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$, and $c_p = 4180\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$. Axial conduction in the fluid and wall may be neglected.\n\nStarting from Newton’s law of cooling and the definition of the average heat transfer coefficient over a uniformly heated length, formulate the length-mean Nusselt number $Nu_{\\text{m}}$ as an integral of the local Nusselt number $Nu_x$ over the heated length $0 \\le x \\le L$. Then, for a thermally developing turbulent flow with uniform wall heat flux and hydrodynamically developed conditions, use a literature-consistent thermal-entrance model in which the local Nusselt number is represented as\n$$\nNu_x \\;=\\; Nu_{\\infty}\\!\\left[\\,1 \\;+\\; \\frac{1}{3}\\left(\\frac{D}{x}\\right)^{2/3}\\right],\n$$\nwhere $Nu_{\\infty}$ is the fully developed turbulent Nusselt number at the same Reynolds number (Re) and Prandtl number (Pr). Perform the $x$-integration to obtain a closed-form expression for $Nu_{\\text{m}}$ in terms of $Nu_{\\infty}$, $D$, and $L$.\n\nCompute the Reynolds number $Re$ and Prandtl number $Pr$ for the flow. Evaluate the fully developed turbulent Nusselt number $Nu_{\\infty}$ using the Gnielinski correlation together with the Petukhov explicit relation for the smooth-tube Darcy friction factor $f$, and then report the ratio\n$$\nR \\;=\\; \\frac{Nu_{\\text{m}}}{Nu_{\\infty}}.\n$$\nRound your final answer $R$ to four significant figures. Express the final result as a pure number (no units).", "solution": "**Part 1: Derivation of the Mean Nusselt Number**\nThe problem specifies the formulation of the length-mean Nusselt number, $Nu_{\\text{m}}$, as an integral of the local Nusselt number, $Nu_x$. This corresponds to defining the mean heat transfer coefficient, $h_m$, as the spatial average of the local coefficient, $h_x$, over the heated length $L$:\n$$h_m = \\frac{1}{L}\\int_0^L h_x \\,dx$$\nBy definition, the Nusselt number is $Nu = hD/k$. Applying this definition to both the mean and local coefficients, we obtain the relationship between their corresponding Nusselt numbers:\n$$\\frac{Nu_{\\text{m}} k}{D} = \\frac{1}{L}\\int_0^L \\frac{Nu_x k}{D} \\,dx$$\nThis simplifies to the required integral formulation for the length-mean Nusselt number:\n$$Nu_{\\text{m}} = \\frac{1}{L}\\int_0^L Nu_x \\,dx$$\nNow, we substitute the given literature-consistent model for the local Nusselt number in a thermally developing turbulent flow:\n$$Nu_x = Nu_{\\infty}\\left[1 + \\frac{1}{3}\\left(\\frac{D}{x}\\right)^{2/3}\\right]$$\nThe integration is performed over the heated length from $x=0$ to $x=L$:\n$$Nu_{\\text{m}} = \\frac{1}{L}\\int_0^L Nu_{\\infty}\\left[1 + \\frac{1}{3} D^{2/3} x^{-2/3}\\right] \\,dx$$\nFactoring out the constant terms:\n$$Nu_{\\text{m}} = \\frac{Nu_{\\infty}}{L} \\left[ \\int_0^L 1 \\,dx + \\frac{D^{2/3}}{3} \\int_0^L x^{-2/3} \\,dx \\right]$$\nPerforming the integrations:\n$$\\int_0^L 1 \\,dx = [x]_0^L = L$$\n$$\\int_0^L x^{-2/3} \\,dx = \\left[\\frac{x^{(-2/3)+1}}{(-2/3)+1}\\right]_0^L = \\left[\\frac{x^{1/3}}{1/3}\\right]_0^L = [3x^{1/3}]_0^L = 3L^{1/3}$$\nSubstituting these results back into the expression for $Nu_{\\text{m}}$:\n$$Nu_{\\text{m}} = \\frac{Nu_{\\infty}}{L} \\left[ L + \\frac{D^{2/3}}{3} (3L^{1/3}) \\right] = \\frac{Nu_{\\infty}}{L} \\left[ L + D^{2/3}L^{1/3} \\right]$$\nSimplifying the expression by dividing through by $L$:\n$$Nu_{\\text{m}} = Nu_{\\infty} \\left[ 1 + \\frac{D^{2/3}L^{1/3}}{L} \\right] = Nu_{\\infty} \\left[ 1 + D^{2/3}L^{-2/3} \\right]$$\nThis yields the closed-form expression for $Nu_{\\text{m}}$ in terms of $Nu_{\\infty}$, $D$, and $L$:\n$$Nu_{\\text{m}} = Nu_{\\infty} \\left[ 1 + \\left(\\frac{D}{L}\\right)^{2/3} \\right]$$\n\n**Part 2: Calculation of Dimensionless Parameters and Nusselt Number**\nAs per the problem statement, we compute the Reynolds and Prandtl numbers. The Reynolds number, $Re_D$, is calculated without intermediate rounding by using the mass flow rate directly:\n$$Re_D = \\frac{\\rho u_m D}{\\mu} = \\frac{\\rho \\left(\\frac{\\dot{m}}{\\rho A_c}\\right) D}{\\mu} = \\frac{\\dot{m} D}{A_c \\mu} = \\frac{\\dot{m} D}{\\left(\\frac{\\pi D^2}{4}\\right) \\mu} = \\frac{4\\dot{m}}{\\pi D \\mu}$$\nSubstituting the given values:\n$$Re_D = \\frac{4(1.50)}{\\pi(0.050)(6.00 \\times 10^{-4})} = \\frac{6}{3\\pi \\times 10^{-5}} = \\frac{2 \\times 10^5}{\\pi} \\approx 63662$$\nThe Prandtl number, $Pr$, is given by:\n$$Pr = \\frac{c_p \\mu}{k}$$\nSubstituting the given values:\n$$Pr = \\frac{(4180)(6.00 \\times 10^{-4})}{0.650} = \\frac{2.508}{0.650} \\approx 3.8585$$\nThe flow is turbulent ($Re_D > 10000$) and the Prandtl number is in the applicable range ($0.5  Pr  2000$), so the Gnielinski correlation is appropriate. First, we must calculate the Darcy friction factor, $f$, for a smooth tube using the Petukhov explicit relation:\n$$f = (0.790 \\ln(Re_D) - 1.64)^{-2}$$\n$$f = (0.790 \\ln(63662) - 1.64)^{-2} = (0.790(11.061) - 1.64)^{-2} = (8.738 - 1.64)^{-2} = (7.098)^{-2} \\approx 0.01985$$\nNow, we evaluate the fully developed Nusselt number, $Nu_{\\infty}$, using the Gnielinski correlation:\n$$Nu_{\\infty} = \\frac{(f/8)(Re_D - 1000)Pr}{1 + 12.7(f/8)^{1/2}(Pr^{2/3}-1)}$$\nSubstituting the calculated values:\n$$f/8 \\approx 0.01985 / 8 \\approx 0.002481$$\n$$(f/8)^{1/2} \\approx (0.002481)^{1/2} \\approx 0.04981$$\n$$Pr^{2/3} \\approx (3.8585)^{2/3} \\approx 2.459$$\n$$Nu_{\\infty} = \\frac{(0.002481)(63662 - 1000)(3.8585)}{1 + 12.7(0.04981)(2.459 - 1)} = \\frac{(0.002481)(62662)(3.8585)}{1 + 12.7(0.04981)(1.459)} = \\frac{600.1}{1 + 0.9234} \\approx \\frac{600.1}{1.9234} \\approx 312.0$$\nWhile these calculations were explicitly requested, we observe that the final required ratio, $R$, is independent of these computed values.\n\n**Part 3: Computation of the Ratio R**\nThe ratio $R$ is defined as $R = Nu_{\\text{m}}/Nu_{\\infty}$. Using the expression derived in Part 1:\n$$R = \\frac{Nu_{\\text{m}}}{Nu_{\\infty}} = \\frac{Nu_{\\infty} \\left[ 1 + \\left(\\frac{D}{L}\\right)^{2/3} \\right]}{Nu_{\\infty}} = 1 + \\left(\\frac{D}{L}\\right)^{2/3}$$\nThis result shows that the enhancement in the mean Nusselt number due to the thermal entrance effect depends only on the aspect ratio $D/L$. Substituting the given geometric values:\n$$R = 1 + \\left(\\frac{0.050\\,\\text{m}}{0.50\\,\\text{m}}\\right)^{2/3} = 1 + (0.1)^{2/3}$$\nCalculating the numerical value:\n$$R = 1 + (0.01)^{1/3} = 1 + \\frac{1}{\\sqrt[3]{100}} \\approx 1 + 0.215443$$\n$$R \\approx 1.215443$$\nRounding to four significant figures as required by the problem statement:\n$$R = 1.215$$", "answer": "$$\\boxed{1.215}$$", "id": "2535758"}, {"introduction": "For applications involving large temperature differences, the simplifying assumption of constant fluid properties breaks down, requiring a more sophisticated approach than a single-point correlation calculation. By combining the fundamental energy balance with local heat transfer correlations, we can develop a numerical marching algorithm to accurately predict system performance with temperature-dependent properties. This capstone problem challenges you to design a computational algorithm that simulates the heating of a fluid along a tube, accounting for property variations ([@problem_id:2535809]). This task bridges the gap between textbook formulas and practical engineering design, where numerical methods are indispensable tools.", "problem": "A circular tube of inner diameter $D$ and length $L$ carries a steady, single-phase liquid or gas with inlet bulk temperature $T_{\\text{in}}$. A uniform heat input rate $Q$ is supplied along the tube length (so the axial heat flux is spatially uniform), and the mass flow rate is $\\dot{m}$. Assume no external heat loss and fully developed turbulence with a smooth tube. You are to design and implement an iterative algorithm that, starting from first principles, computes the outlet bulk temperature $T_{\\text{out}}$ and the length-averaged Nusselt number $\\overline{Nu}$ using the Gnielinski correlation with temperature-dependent thermophysical properties. The algorithm must be applicable to both liquids and gases with property models as specified below.\n\nYour derivation must start from the conservation of energy and the definition of convective heat transfer coefficient, then incorporate:\n- The axial energy balance for a differential control volume of fluid,\n- The definition of the Nusselt number $Nu = h D / k$,\n- The use of the Gnielinski correlation for turbulent internal convection (use its standard form, without stating it explicitly here),\n- The friction factor for smooth tubes from Petukhov (use its standard form, without stating it explicitly here),\n- A viscosity correction exponent $0.11$ applied multiplicatively to $Nu$ via the local viscosity ratio $\\left(\\mu_b / \\mu_w\\right)^{0.11}$, where $\\mu_b$ is evaluated at the local bulk temperature and $\\mu_w$ at the local inner-wall temperature.\n\nPhysical modeling requirements and algorithmic design constraints:\n1. Use a marching solution along the tube length by discretizing the tube into $N$ equal axial segments of length $\\Delta x = L/N$. At each segment $i$ with local bulk temperature $T_{b,i}$, apply the differential energy balance\n   $$\\mathrm{d}Q = \\dot{m}\\, c_p(T_b)\\, \\mathrm{d}T_b,$$\n   with the local segment heat input $\\Delta Q = q^{\\prime\\prime} P \\Delta x$, where $q^{\\prime\\prime} = Q/(\\pi D L)$ and $P = \\pi D$ is the inner perimeter. Advance $T_{b,i}$ to $T_{b,i+1}$ by solving\n   $$\\int_{T_{b,i}}^{T_{b,i+1}} c_p(T)\\, \\mathrm{d}T = \\frac{\\Delta Q}{\\dot{m}}.$$\n   You must implement a stable numerical update for $T_{b,i+1}$ using an enthalpy-consistent step (e.g., a fixed-point or Newton iteration based on $c_p(T)$). State your choice and justify it.\n\n2. At each segment, compute the local Reynolds number\n   $$Re = \\frac{\\rho(T_b) u D}{\\mu(T_b)}, \\quad u = \\frac{4\\dot{m}}{\\pi D^2 \\rho(T_b)},$$\n   and the local Prandtl number\n   $$Pr = \\frac{c_p(T_b)\\, \\mu(T_b)}{k(T_b)}.$$\n\n3. Use the Gnielinski correlation with the Petukhov friction factor for a smooth tube to compute a base local Nusselt number $Nu_{\\text{base}}(Re,Pr)$ evaluated with properties at the local bulk temperature $T_b$. Apply a viscosity correction by multiplying the base value by $\\phi = \\left(\\mu_b/\\mu_w\\right)^{0.11}$:\n   $$Nu = \\phi\\, Nu_{\\text{base}}, \\quad \\phi = \\left(\\frac{\\mu(T_b)}{\\mu(T_w)}\\right)^{0.11}.$$\n   Because $\\phi$ depends on the wall temperature $T_w$ and $T_w$ depends on $Nu$, iterate locally to a fixed point using\n   $$q^{\\prime\\prime} = h\\,(T_w - T_b), \\quad h = \\frac{Nu\\, k(T_b)}{D},$$\n   until the change in $T_w$ or $Nu$ is below a small tolerance.\n\n4. Compute the length-averaged Nusselt number as the arithmetic mean of the local Nusselt numbers over the $N$ segments:\n   $$\\overline{Nu} = \\frac{1}{N} \\sum_{i=1}^{N} Nu_i.$$\n\nProperty models to be used for the fluids in the test suite:\n- Liquid water (valid for $T$ between $290\\,\\mathrm{K}$ and $370\\,\\mathrm{K}$):\n  - Dynamic viscosity (Pa·s): $$\\mu(T) = 2.414\\times 10^{-5}\\, 10^{\\frac{247.8}{T - 140}}.$$\n  - Thermal conductivity (W/m·K) with $T_C = T - 273.15$ in ${}^{\\circ}\\mathrm{C}$:\n    $$k(T) = 0.561 + 0.0019\\,T_C - 3.0\\times 10^{-6}\\,T_C^2.$$\n  - Specific heat (J/kg·K) with $T_C = T - 273.15$:\n    $$c_p(T) = 4179.0 + 0.1\\,(T_C - 20.0) - 0.001\\,(T_C - 20.0)^2.$$\n  - Density (kg/m$^3$) with $T_C = T - 273.15$:\n    $$\\rho(T) = 1000.0 - 0.3\\,(T_C - 4.0).$$\n\n- Dry air at pressure $p$ (ideal gas, valid for $280\\,\\mathrm{K} \\le T \\le 500\\,\\mathrm{K}$):\n  - Dynamic viscosity (Pa·s) via Sutherland’s law with $T_0 = 273.15\\,\\mathrm{K}$, $\\mu_0 = 1.716\\times 10^{-5}\\,\\mathrm{Pa\\,s}$, $S = 110.4\\,\\mathrm{K}$:\n    $$\\mu(T) = \\mu_0 \\left(\\frac{T}{T_0}\\right)^{3/2}\\frac{T_0 + S}{T + S}.$$\n  - Specific heat (J/kg·K):\n    $$c_p(T) = 1006.0 + 0.1\\,(T - 300.0).$$\n  - Prandtl number (dimensionless) assumed mildly varying and set to $Pr = 0.71$; from this, thermal conductivity is\n    $$k(T) = \\frac{c_p(T)\\, \\mu(T)}{Pr}.$$\n  - Density (kg/m$^3$) using the ideal gas law with gas constant $R=287.05\\,\\mathrm{J/(kg\\,K)}$:\n    $$\\rho(T) = \\frac{p}{R\\,T}.$$\n\n- Light lubricating oil (valid for $320\\,\\mathrm{K} \\le T \\le 420\\,\\mathrm{K}$):\n  - Dynamic viscosity (Pa·s) with $T_C = T - 273.15$:\n    $$\\mu(T) = 0.2\\, \\exp\\big(-0.035\\,(T_C - 40.0)\\big).$$\n  - Thermal conductivity (W/m·K): $$k(T) = 0.13.$$\n  - Specific heat (J/kg·K): $$c_p(T) = 2000.0.$$\n  - Density (kg/m$^3$): $$\\rho(T) = 860.0.$$\n\nProgram requirements:\n- Implement the above algorithm for each test case, using $N = 400$ segments and a local wall-temperature iteration tolerance of $10^{-8}$ in temperature or relative Nusselt number change, whichever is more convenient.\n- Report $T_{\\text{out}}$ in $\\mathrm{K}$ and $\\overline{Nu}$ as dimensionless. Round both to three decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list $[T_{\\text{out}}, \\overline{Nu}]$. For example: $[[300.000,123.456],[\\dots],[\\dots]]$.\n\nTest suite (three cases to exercise different regimes and property variations):\n- Case 1 (liquid water, moderate Reynolds number and significant heating):\n  - $D = 0.02\\,\\mathrm{m}$, $L = 10.0\\,\\mathrm{m}$, $\\dot{m} = 0.20\\,\\mathrm{kg/s}$, $Q = 30000.0\\,\\mathrm{W}$, $T_{\\text{in}} = 300.0\\,\\mathrm{K}$.\n- Case 2 (dry air at $p = 101325\\,\\mathrm{Pa}$, high Reynolds number, mild property variation):\n  - $D = 0.05\\,\\mathrm{m}$, $L = 5.0\\,\\mathrm{m}$, $\\dot{m} = 0.10\\,\\mathrm{kg/s}$, $Q = 2000.0\\,\\mathrm{W}$, $T_{\\text{in}} = 300.0\\,\\mathrm{K}$, $p = 101325.0\\,\\mathrm{Pa}$.\n- Case 3 (light oil, high Prandtl number close to the lower validity bound of turbulent correlations):\n  - $D = 0.02\\,\\mathrm{m}$, $L = 6.0\\,\\mathrm{m}$, $\\dot{m} = 3.00\\,\\mathrm{kg/s}$, $Q = 20000.0\\,\\mathrm{W}$, $T_{\\text{in}} = 360.0\\,\\mathrm{K}$.\n\nFinal output format:\n- A single line with the list $[[T_{\\text{out},1}, \\overline{Nu}_1],[T_{\\text{out},2}, \\overline{Nu}_2],[T_{\\text{out},3}, \\overline{Nu}_3]]$, all values rounded to three decimals, with no additional text.", "solution": "The solution is derived from the fundamental principle of conservation of energy and the empirical framework of convective heat transfer. We construct a numerical algorithm to solve the governing equations.\n\n**1. Governing Equations and Discretization**\n\nThe first law of thermodynamics applied to a differential control volume of fluid flowing through the tube of length $\\mathrm{d}x$ is:\n$$ \\mathrm{d}Q = \\dot{m} \\,\\mathrm{d}h_b $$\nwhere $\\mathrm{d}Q$ is the differential heat added, $\\dot{m}$ is the mass flow rate, and $\\mathrm{d}h_b$ is the differential change in specific bulk enthalpy. Using the definition of specific heat at constant pressure, $c_p(T_b) = (\\partial h_b / \\partial T_b)_p$, the energy balance becomes:\n$$ \\mathrm{d}Q = \\dot{m} \\, c_p(T_b) \\, \\mathrm{d}T_b $$\nThe heat input is uniform along the length $L$, resulting in a constant axial heat flux $q^{\\prime\\prime} = Q / (\\pi D L)$. The heat added over a differential length $\\mathrm{d}x$ is $\\mathrm{d}Q = q^{\\prime\\prime} P \\mathrm{d}x$, where $P = \\pi D$ is the wetted perimeter.\n\nTo solve for the outlet temperature $T_{\\text{out}}$, we discretize the tube of length $L$ into $N$ equal segments, each of length $\\Delta x = L/N$. The total heat input to each segment is $\\Delta Q = Q/N$. We then march from the inlet ($i=0$) to the outlet ($i=N$), computing the bulk temperature $T_{b,i+1}$ at the exit of segment $i$ from the known temperature $T_{b,i}$ at its entrance. The energy balance for segment $i$ is obtained by integrating the differential form:\n$$ \\int_{T_{b,i}}^{T_{b,i+1}} \\dot{m} \\, c_p(T) \\, \\mathrm{d}T = \\Delta Q $$\nRearranging yields the integral equation for the temperature update:\n$$ \\int_{T_{b,i}}^{T_{b,i+1}} c_p(T) \\, \\mathrm{d}T = \\frac{\\Delta Q}{\\dot{m}} $$\nThe solution begins with the known inlet condition $T_{b,0} = T_{\\text{in}}$, and the final outlet temperature is $T_{\\text{out}} = T_{b,N}$.\n\n**2. Numerical Scheme for Temperature Update**\n\nSince $c_p$ is a function of temperature, the above integral equation for $T_{b,i+1}$ is implicit. We solve it numerically. Let the specific enthalpy relative to a reference temperature $T_{\\text{ref}}$ be $H(T) = \\int_{T_{\\text{ref}}}^T c_p(\\tau)\\,\\mathrm{d}\\tau$. The equation becomes $H(T_{b,i+1}) - H(T_{b,i}) = \\Delta Q / \\dot{m}$. We must find the temperature $T_{b,i+1}$ corresponding to the target enthalpy $H_{\\text{target}} = H(T_{b,i}) + \\Delta Q / \\dot{m}$.\n\nA Newton-Raphson method is selected for this task due to its rapid (quadratic) convergence and stability for monotonic functions. We seek the root of the function $g(T) = H(T) - H_{\\text{target}} = 0$. The iterative update is:\n$$ T_{k+1} = T_k - \\frac{g(T_k)}{g'(T_k)} $$\nSince $g'(T) = \\mathrm{d}H/\\mathrm{d}T = c_p(T)$, the update rule is:\n$$ T_{k+1} = T_k - \\frac{\\int_{T_{\\text{ref}}}^{T_k} c_p(\\tau)\\,\\mathrm{d}\\tau - H_{\\text{target}}}{c_p(T_k)} $$\nThe integrals of the given polynomial forms for $c_p(T)$ are computed analytically. For the special case of constant $c_p$ (as for the oil model), the update is explicit: $T_{b,i+1} = T_{b,i} + \\Delta Q / (\\dot{m} c_p)$. For the other fluids, the Newton iteration starts with an initial guess $T_0 = T_{b,i}$ and proceeds until convergence.\n\n**3. Local Heat Transfer Analysis**\n\nWithin each segment $i$, we compute the local Nusselt number, $Nu_i$. This requires an iterative procedure because the viscosity correction factor depends on the wall temperature $T_{w,i}$, which in turn depends on the Nusselt number. For each segment, properties are evaluated at the bulk temperature at the segment inlet, $T_{b,i}$.\n\nThe procedure for segment $i$ with bulk temperature $T_b = T_{b,i}$ is as follows:\na. Calculate fluid properties at $T_b$: density $\\rho(T_b)$, dynamic viscosity $\\mu_b = \\mu(T_b)$, specific heat $c_p(T_b)$, and thermal conductivity $k(T_b)$.\nb. Compute the Reynolds and Prandtl numbers:\n$$ Re_D = \\frac{4\\dot{m}}{\\pi D \\mu_b} \\quad \\text{and} \\quad Pr = \\frac{c_p(T_b) \\mu_b}{k(T_b)} $$\nc. The flow is turbulent. We use the Petukhov correlation for the Darcy friction factor $f$ in a smooth tube, valid for $3000 \\le Re_D \\le 5 \\times 10^6$:\n$$ f = \\left( 0.790 \\ln(Re_D) - 1.64 \\right)^{-2} $$\nd. The base Nusselt number, $Nu_{\\text{base}}$, is computed using the Gnielinski correlation, valid for $0.5 \\le Pr \\le 2000$ and $2300 \\le Re_D \\le 5 \\times 10^6$:\n$$ Nu_{\\text{base}} = \\frac{(f/8)(Re_D - 1000)Pr}{1 + 12.7(f/8)^{1/2}(Pr^{2/3}-1)} $$\ne. An inner fixed-point iteration is performed to account for the viscosity variation near the wall.\n   i. Initialize $Nu_i^{(k)} = Nu_{\\text{base}}$.\n   ii. In iteration $k+1$:\n      - Compute the heat transfer coefficient: $h_i^{(k)} = Nu_i^{(k)} k(T_b) / D$.\n      - Determine the local wall temperature: $T_{w,i}^{(k)} = T_b + q^{\\prime\\prime} / h_i^{(k)}$.\n      - Evaluate viscosity at the wall: $\\mu_w^{(k)} = \\mu(T_{w,i}^{(k)})$.\n      - Calculate the viscosity correction factor: $\\phi^{(k)} = (\\mu_b / \\mu_w^{(k)})^{0.11}$.\n      - Update the Nusselt number: $Nu_i^{(k+1)} = \\phi^{(k)} Nu_{\\text{base}}$.\n   iii. The iteration continues until the relative change $|(Nu_i^{(k+1)} - Nu_i^{(k)}) / Nu_i^{(k+1)}|$ is less than a specified tolerance of $10^{-8}$.\nf. The converged value $Nu_i^{(k+1)}$ is stored as the local Nusselt number $Nu_i$.\n\n**4. Overall Algorithm and Final Quantities**\n\nThe complete algorithm is as follows:\n1. Initialize parameters: $D, L, \\dot{m}, Q, T_{\\text{in}}$, fluid type, and numerical constants $N=400$, tolerance $= 10^{-8}$.\n2. Calculate segment length $\\Delta x = L/N$, segment heat input $\\Delta Q = Q/N$, and surface heat flux $q^{\\prime\\prime}=Q/(\\pi DL)$.\n3. Initialize bulk temperature $T_b = T_{\\text{in}}$ and an empty list for local Nusselt numbers, `Nu_values`.\n4. Loop for $i$ from $0$ to $N-1$:\n   a. Follow the procedure in Section 3 to compute the converged local Nusselt number $Nu_i$ at the current bulk temperature $T_b$. Append $Nu_i$ to `Nu_values`.\n   b. Follow the procedure in Section 2 to compute the bulk temperature $T_{b, i+1}$ at the exit of the segment. Update $T_b \\leftarrow T_{b, i+1}$.\n5. After the loop completes, the final bulk temperature is the tube outlet temperature, $T_{\\text{out}} = T_b$.\n6. The length-averaged Nusselt number is the arithmetic mean of the local values:\n$$ \\overline{Nu} = \\frac{1}{N} \\sum_{i=0}^{N-1} Nu_i $$\nThe calculated $T_{\\text{out}}$ and $\\overline{Nu}$ are then reported to the specified precision. This marching scheme correctly accounts for the cumulative effect of temperature changes on fluid properties along the tube.", "answer": "```python\nimport numpy as np\n\n# A strict Russian professor does not tolerate magic numbers. All constants are defined.\nR_AIR = 287.05  # J/(kg K)\nT_ABS_ZERO_C = -273.15  # Celsius\n\nclass FluidProperties:\n    \"\"\"Base class for fluid properties.\"\"\"\n    def rho(self, T_k): raise NotImplementedError\n    def mu(self, T_k): raise NotImplementedError\n    def cp(self, T_k): raise NotImplementedError\n    def k(self, T_k): raise NotImplementedError\n    def enthalpy_integral(self, T1_k, T2_k): raise NotImplementedError\n\nclass WaterProperties(FluidProperties):\n    \"\"\"Properties for liquid water.\"\"\"\n    def _T_to_TC(self, T_k):\n        return T_k + T_ABS_ZERO_C\n\n    def rho(self, T_k):\n        T_c = self._T_to_TC(T_k)\n        return 1000.0 - 0.3 * (T_c - 4.0)\n\n    def mu(self, T_k):\n        return 2.414e-5 * 10**(247.8 / (T_k - 140.0))\n\n    def cp(self, T_k):\n        T_c = self._T_to_TC(T_k)\n        t_prime = T_c - 20.0\n        return 4179.0 + 0.1 * t_prime - 0.001 * t_prime**2\n\n    def k(self, T_k):\n        T_c = self._T_to_TC(T_k)\n        return 0.561 + 0.0019 * T_c - 3.0e-6 * T_c**2\n\n    def enthalpy_integral(self, T1_k, T2_k):\n        # H(T) = integral of cp(T) dT from T1 to T2\n        # Let t = T - 293.15 (since T_C - 20 = T - 273.15 - 20)\n        # cp(t) = 4179.0 + 0.1*t - 0.001*t^2\n        # integral(cp) dt = 4179.0*t + 0.05*t^2 - (0.001/3)*t^3\n        t1 = T1_k - 293.15\n        t2 = T2_k - 293.15\n        \n        H2 = 4179.0 * t2 + 0.05 * t2**2 - (0.001 / 3.0) * t2**3\n        H1 = 4179.0 * t1 + 0.05 * t1**2 - (0.001 / 3.0) * t1**3\n        return H2 - H1\n\nclass AirProperties(FluidProperties):\n    \"\"\"Properties for dry air (ideal gas).\"\"\"\n    def __init__(self, p_pa):\n        self.p_pa = p_pa\n        self.pr = 0.71\n        self.mu0 = 1.716e-5\n        self.T0 = 273.15\n        self.S = 110.4\n\n    def rho(self, T_k):\n        return self.p_pa / (R_AIR * T_k)\n\n    def mu(self, T_k):\n        return self.mu0 * (T_k / self.T0)**1.5 * (self.T0 + self.S) / (T_k + self.S)\n\n    def cp(self, T_k):\n        return 1006.0 + 0.1 * (T_k - 300.0)\n\n    def k(self, T_k):\n        return self.cp(T_k) * self.mu(T_k) / self.pr\n\n    def enthalpy_integral(self, T1_k, T2_k):\n        # cp(T) = 1006 + 0.1*(T - 300) = 976 + 0.1*T\n        # integral(cp) dT = 976*T + 0.05*T^2\n        H2 = 976.0 * T2_k + 0.05 * T2_k**2\n        H1 = 976.0 * T1_k + 0.05 * T1_k**2\n        return H2 - H1\n\nclass OilProperties(FluidProperties):\n    \"\"\"Properties for light lubricating oil.\"\"\"\n    def _T_to_TC(self, T_k):\n        return T_k + T_ABS_ZERO_C\n\n    def rho(self, T_k):\n        return 860.0\n\n    def mu(self, T_k):\n        T_c = self._T_to_TC(T_k)\n        return 0.2 * np.exp(-0.035 * (T_c - 40.0))\n\n    def cp(self, T_k):\n        return 2000.0\n\n    def k(self, T_k):\n        return 0.13\n\n    def enthalpy_integral(self, T1_k, T2_k):\n        return self.cp(T1_k) * (T2_k - T1_k)\n\ndef get_fluid_properties(name, p_pa=None):\n    \"\"\"Factory function for fluid properties.\"\"\"\n    if name.lower() == 'water':\n        return WaterProperties()\n    elif name.lower() == 'air':\n        if p_pa is None:\n            raise ValueError(\"Pressure must be provided for air.\")\n        return AirProperties(p_pa)\n    elif name.lower() == 'oil':\n        return OilProperties()\n    else:\n        raise ValueError(f\"Unknown fluid: {name}\")\n\ndef calculate_outlet_conditions(case):\n    \"\"\"Main solver for a single test case.\"\"\"\n    D, L, mdot, Q, T_in, fluid_name, p_pa = case\n    fluid = get_fluid_properties(fluid_name, p_pa)\n\n    N = 400\n    TOL = 1e-8\n    MAX_ITER_NEWTON = 20\n    MAX_ITER_WALL_T = 20\n    \n    delta_x = L / N\n    delta_Q = Q / N\n    q_prime_prime = Q / (np.pi * D * L)\n\n    T_b = T_in\n    nu_list = []\n\n    for i in range(N):\n        # --- Local Heat Transfer Calculation at segment inlet T_b ---\n        mu_b = fluid.mu(T_b)\n        cp_b = fluid.cp(T_b)\n        k_b = fluid.k(T_b)\n\n        Re = (4 * mdot) / (np.pi * D * mu_b)\n        Pr = cp_b * mu_b / k_b\n\n        # Petukhov friction factor\n        f = (0.790 * np.log(Re) - 1.64)**-2 if Re = 3000 else 0. # Added check for validity\n        \n        # Gnielinski correlation\n        if Re > 2300 and 0.5 = Pr = 2000:\n            numerator = (f / 8) * (Re - 1000) * Pr\n            denominator = 1 + 12.7 * (f / 8)**0.5 * (Pr**(2/3) - 1)\n            Nu_base = numerator / denominator\n        else: # Fallback or error, for this problem specifies turbulent\n            # Could use a laminar correlation, but problem specifies turbulent\n            Nu_base = 3.66 \n\n        # --- Inner iteration for wall temperature and viscosity correction ---\n        Nu_curr = Nu_base\n        for _ in range(MAX_ITER_WALL_T):\n            h = Nu_curr * k_b / D\n            T_w = T_b + q_prime_prime / h\n            \n            # Check if wall temperature is within property validity range\n            # A more robust implementation would handle this, but for these cases it's fine.\n            mu_w = fluid.mu(T_w)\n            \n            phi = (mu_b / mu_w)**0.11\n            Nu_new = phi * Nu_base\n\n            if abs(Nu_new - Nu_curr) / Nu_curr  TOL:\n                break\n            Nu_curr = Nu_new\n        \n        nu_list.append(Nu_curr)\n\n        # --- Temperature Update to next segment ---\n        energy_added_per_mass = delta_Q / mdot\n\n        # For constant cp (Oil), direct update\n        if isinstance(fluid, OilProperties):\n            T_b += energy_added_per_mass / fluid.cp(T_b)\n        else:\n            # Newton-Raphson to find T_b_next\n            T_b_next = T_b  # Initial guess\n            for _ in range(MAX_ITER_NEWTON):\n                H_integral = fluid.enthalpy_integral(T_b, T_b_next)\n                g = H_integral - energy_added_per_mass\n                if abs(g)  TOL * energy_added_per_mass:\n                    break\n                \n                # Check for zero derivative\n                cp_next = fluid.cp(T_b_next)\n                if abs(cp_next)  1e-6:\n                    T_b_next += 0.001 # Perturb if derivative is zero\n                    continue\n                \n                T_b_next -= g / cp_next\n            T_b = T_b_next\n            \n    T_out = T_b\n    Nu_bar = np.mean(nu_list)\n    \n    return T_out, Nu_bar\n\n\ndef solve():\n    test_cases = [\n        # D(m), L(m), mdot(kg/s), Q(W), Tin(K), fluid, pressure(Pa)\n        (0.02, 10.0, 0.20, 30000.0, 300.0, 'water', None),\n        (0.05, 5.0, 0.10, 2000.0, 300.0, 'air', 101325.0),\n        (0.02, 6.0, 3.00, 20000.0, 360.0, 'oil', None),\n    ]\n\n    results = []\n    for case in test_cases:\n        T_out, Nu_bar = calculate_outlet_conditions(case)\n        # Format results as strings with three decimal places\n        results.append(f\"[{T_out:.3f},{Nu_bar:.3f}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[[{','.join(results)}]]\")\n\nsolve()\n```", "id": "2535809"}]}