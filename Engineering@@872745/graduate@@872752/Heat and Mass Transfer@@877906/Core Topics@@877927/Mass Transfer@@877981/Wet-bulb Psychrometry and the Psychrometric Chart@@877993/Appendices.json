{"hands_on_practices": [{"introduction": "A solid grasp of psychrometry begins with understanding the fundamental properties of moist air as a gas mixture. This exercise challenges you to derive the density of moist air from first principles, using the ideal gas law and the definition of humidity ratio $w$. By working through this derivation [@problem_id:2538457], you will uncover and prove the somewhat counter-intuitive fact that, at a given temperature and pressure, humid air is less dense than dry air.", "problem": "A moist air mixture is modeled as an ideal mixture of ideal gases consisting of dry air and water vapor. The humidity ratio is defined as $w \\equiv m_{v}/m_{a}$, where $m_{v}$ is the mass of water vapor and $m_{a}$ is the mass of dry air. At fixed dry-bulb temperature $T$ and total pressure $p$, the density of the moist air $\\rho$ varies with $w$. Starting from the ideal gas law for mixtures and the definition of $w$, and without invoking any pre-tabulated psychrometric relations, derive an explicit expression for $\\rho$ as a function $\\rho(w;T,p)$, expressed only in terms of $w$, $T$, $p$, the universal gas constant $R_{u}$, and the molar masses of dry air and water, $M_{a}$ and $M_{w}$. Use this expression to demonstrate analytically how the sign of $\\mathrm{d}\\rho/\\mathrm{d}w$ depends on the ratio $M_{a}/M_{w}$ when $T$ and $p$ are fixed, and state the physical implication for how density changes as humidity increases on a psychrometric chart at fixed $T$ and $p$.\n\nThen, for a representative change in humidity at standard barometric pressure, estimate the fractional density change when the humidity ratio increases from $w_{1} = 0.005$ to $w_{2} = 0.020$ at fixed $T$ and $p$. Use $T = 300\\,\\mathrm{K}$ and $p = 101.325\\,\\mathrm{kPa}$. Take $R_{u} = 8.314462618\\times 10^{3}\\,\\mathrm{J}\\, \\mathrm{kmol}^{-1}\\, \\mathrm{K}^{-1}$, $M_{a} = 28.965\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$, and $M_{w} = 18.01528\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$. Express your final numerical result as the fractional change $\\left(\\rho_{2}-\\rho_{1}\\right)/\\rho_{1}$ in decimal form (do not use a percent sign), and round your answer to four significant figures.", "solution": "The problem is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted verbatim from the problem statement.\n- Model: Moist air is an ideal mixture of ideal gases (dry air and water vapor).\n- Definition: Humidity ratio $w \\equiv m_{v}/m_{a}$, where $m_{v}$ is the mass of water vapor and $m_{a}$ is the mass of dry air.\n- Parameters and Conditions: The analysis is performed at fixed dry-bulb temperature $T$ and total pressure $p$.\n- Task 1: Derive an explicit expression for the density of moist air, $\\rho$, as a function $\\rho(w;T,p)$, in terms of $w$, $T$, $p$, the universal gas constant $R_{u}$, and the molar masses $M_{a}$ and $M_{w}$.\n- Task 2: Use the derived expression to demonstrate analytically how the sign of the derivative $\\mathrm{d}\\rho/\\mathrm{d}w$ depends on the ratio $M_{a}/M_{w}$ at fixed $T$ and $p$.\n- Task 3: State the physical implication of the result from Task 2.\n- Task 4: Numerically estimate the fractional density change $(\\rho_{2}-\\rho_{1})/\\rho_{1}$ for a specific case.\n- Numerical Data:\n  - Initial humidity ratio, $w_{1} = 0.005$.\n  - Final humidity ratio, $w_{2} = 0.020$.\n  - Temperature, $T = 300\\,\\mathrm{K}$.\n  - Pressure, $p = 101.325\\,\\mathrm{kPa} = 101325\\,\\mathrm{Pa}$.\n  - Universal gas constant, $R_{u} = 8.314462618\\times 10^{3}\\,\\mathrm{J}\\, \\mathrm{kmol}^{-1}\\, \\mathrm{K}^{-1}$.\n  - Molar mass of dry air, $M_{a} = 28.965\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$.\n  - Molar mass of water, $M_{w} = 18.01528\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$.\n\nNext, the problem is validated against the specified criteria.\n- **Scientifically Grounded**: The problem is based on the fundamental principles of thermodynamics, specifically the ideal gas law applied to mixtures, which is a standard and valid approach in psychrometry for many engineering applications. All concepts are well-established.\n- **Well-Posed**: The problem is clearly stated, provides all necessary definitions and data, and requests a specific derivation and calculation. A unique and stable solution exists.\n- **Objective**: The problem is expressed in precise, quantitative, and unbiased language.\n\nThe problem is found to be self-contained, consistent, and scientifically sound. It does not violate any of the invalidity criteria. Therefore, the problem is deemed **valid**, and I will proceed with the solution.\n\nThe density of the moist air mixture, $\\rho$, is the total mass $m$ per unit volume $V$:\n$$\n\\rho = \\frac{m}{V} = \\frac{m_{a} + m_{v}}{V}\n$$\nUsing the definition of the humidity ratio, $w = m_{v}/m_{a}$, we express the mass of water vapor as $m_{v} = w m_{a}$. Substituting this into the density equation gives:\n$$\n\\rho = \\frac{m_{a} + w m_{a}}{V} = \\frac{m_{a}(1+w)}{V}\n$$\nThe moist air mixture and its components, dry air and water vapor, are treated as ideal gases. According to Dalton's law of partial pressures, the total pressure $p$ is the sum of the partial pressures of dry air, $p_{a}$, and water vapor, $p_{v}$:\n$$\np = p_{a} + p_{v}\n$$\nApplying the ideal gas law to each component:\n$$\np_{a}V = n_{a}R_{u}T \\quad \\text{and} \\quad p_{v}V = n_{v}R_{u}T\n$$\nwhere $n_{a} = m_{a}/M_{a}$ and $n_{v} = m_{v}/M_{w}$ are the number of moles of dry air and water vapor, respectively.\n\nWe can express the volume $V$ from the ideal gas law for dry air:\n$$\nV = \\frac{n_{a}R_{u}T}{p_{a}} = \\frac{m_{a}R_{u}T}{p_{a}M_{a}}\n$$\nSubstituting this expression for $V$ into our equation for density $\\rho$:\n$$\n\\rho = \\frac{m_{a}(1+w)}{m_{a}R_{u}T / (p_{a}M_{a})} = \\frac{p_{a}M_{a}(1+w)}{R_{u}T}\n$$\nTo obtain the final expression in terms of the total pressure $p$, we must eliminate the partial pressure $p_{a}$. We take the ratio of the ideal gas law equations for the two components:\n$$\n\\frac{p_{v}}{p_{a}} = \\frac{n_{v}R_{u}T/V}{n_{a}R_{u}T/V} = \\frac{n_{v}}{n_{a}} = \\frac{m_{v}/M_{w}}{m_{a}/M_{a}} = \\frac{m_{v}}{m_{a}} \\frac{M_{a}}{M_{w}}\n$$\nRecognizing that $w = m_{v}/m_{a}$, we have:\n$$\n\\frac{p_{v}}{p_{a}} = w \\frac{M_{a}}{M_{w}} \\implies p_{v} = p_{a} w \\frac{M_{a}}{M_{w}}\n$$\nNow, substitute this into Dalton's law, $p = p_{a} + p_{v}$:\n$$\np = p_{a} + p_{a} w \\frac{M_{a}}{M_{w}} = p_{a}\\left(1 + w \\frac{M_{a}}{M_{w}}\\right)\n$$\nSolving for $p_{a}$ gives:\n$$\np_{a} = \\frac{p}{1 + w \\frac{M_{a}}{M_{w}}}\n$$\nFinally, substituting this expression for $p_{a}$ into our equation for density $\\rho$ yields the desired function $\\rho(w;T,p)$:\n$$\n\\rho(w;T,p) = \\frac{p}{1 + w \\frac{M_{a}}{M_{w}}} \\frac{M_{a}(1+w)}{R_{u}T} = \\frac{p M_{a}}{R_{u}T} \\frac{1+w}{1 + w \\frac{M_{a}}{M_{w}}}\n$$\nThis completes the first task.\n\nFor the second task, we analyze the sign of the derivative $\\mathrm{d}\\rho/\\mathrm{d}w$ at constant $T$ and $p$. We differentiate the derived expression for $\\rho$ with respect to $w$:\n$$\n\\frac{\\mathrm{d}\\rho}{\\mathrm{d}w} = \\frac{\\mathrm{d}}{\\mathrm{d}w} \\left[ \\frac{p M_{a}}{R_{u}T} \\frac{1+w}{1 + w \\frac{M_{a}}{M_{w}}} \\right]\n$$\nThe term $\\frac{p M_{a}}{R_{u}T}$ is constant with respect to $w$. Using the quotient rule for differentiation on the remaining fraction:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}w} \\left( \\frac{1+w}{1 + w \\frac{M_{a}}{M_{w}}} \\right) = \\frac{(1)\\left(1 + w \\frac{M_{a}}{M_{w}}\\right) - (1+w)\\left(\\frac{M_{a}}{M_{w}}\\right)}{\\left(1 + w \\frac{M_{a}}{M_{w}}\\right)^{2}}\n$$\nSimplifying the numerator:\n$$\n1 + w \\frac{M_{a}}{M_{w}} - \\frac{M_{a}}{M_{w}} - w \\frac{M_{a}}{M_{w}} = 1 - \\frac{M_{a}}{M_{w}}\n$$\nThus, the derivative is:\n$$\n\\frac{\\mathrm{d}\\rho}{\\mathrm{d}w} = \\frac{p M_{a}}{R_{u}T} \\frac{1 - \\frac{M_{a}}{M_{w}}}{\\left(1 + w \\frac{M_{a}}{M_{w}}\\right)^{2}}\n$$\nThe sign of this derivative is determined by the sign of its constituent terms. The pressure $p$, temperature $T$, molar mass $M_{a}$, and universal gas constant $R_{u}$ are all positive physical quantities. The denominator term $\\left(1 + w \\frac{M_{a}}{M_{w}}\\right)^{2}$ is a square and is therefore always positive (since $w \\geq 0$).\nConsequently, the sign of $\\mathrm{d}\\rho/\\mathrm{d}w$ is determined exclusively by the sign of the term $\\left(1 - \\frac{M_{a}}{M_{w}}\\right)$.\nThe molar mass of dry air is $M_{a} \\approx 28.97\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$, and the molar mass of water is $M_{w} \\approx 18.02\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$. The ratio is $\\frac{M_{a}}{M_{w}} \\approx \\frac{28.97}{18.02} \\approx 1.6 > 1$.\nSince $\\frac{M_{a}}{M_{w}} > 1$, the term $\\left(1 - \\frac{M_{a}}{M_{w}}\\right)$ is negative. Therefore, $\\frac{\\mathrm{d}\\rho}{\\mathrm{d}w}  0$.\n\nFor the third task, the physical implication of $\\frac{\\mathrm{d}\\rho}{\\mathrm{d}w}  0$ is that at a constant temperature and total pressure, the density of moist air decreases as its humidity ratio increases. This is because adding water vapor, which consists of molecules ($\\text{H}_2\\text{O}$) that are lighter than the average molecules of dry air (primarily $\\text{N}_2$ and $\\text{O}_2$), displaces some of the heavier dry air molecules to maintain constant total pressure. This results in a mixture with a lower average molar mass and, consequently, a lower density. On a psychrometric chart, moving vertically upward along a constant dry-bulb temperature line signifies an increase in humidity, which corresponds to a decrease in air density. Humid air is less dense than dry air at the same temperature and pressure.\n\nFor the fourth task, we calculate the fractional change in density, $\\frac{\\rho_{2}-\\rho_{1}}{\\rho_{1}} = \\frac{\\rho_{2}}{\\rho_{1}} - 1$.\nUsing the expression for $\\rho(w)$, we form the ratio $\\rho_{2}/\\rho_{1}$ for $w_{1} = 0.005$ and $w_{2} = 0.020$ at constant $T$ and $p$:\n$$\n\\frac{\\rho_{2}}{\\rho_{1}} = \\frac{\\frac{p M_{a}}{R_{u}T} \\frac{1+w_{2}}{1 + w_{2} \\frac{M_{a}}{M_{w}}}}{\\frac{p M_{a}}{R_{u}T} \\frac{1+w_{1}}{1 + w_{1} \\frac{M_{a}}{M_{w}}}} = \\frac{1+w_{2}}{1+w_{1}} \\cdot \\frac{1 + w_{1} \\frac{M_{a}}{M_{w}}}{1 + w_{2} \\frac{M_{a}}{M_{w}}}\n$$\nWe use the provided values: $M_{a} = 28.965\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$ and $M_{w} = 18.01528\\,\\mathrm{kg}\\,\\mathrm{kmol}^{-1}$.\nFirst, calculate the ratio of molar masses:\n$$\n\\frac{M_{a}}{M_{w}} = \\frac{28.965}{18.01528} \\approx 1.607797087\n$$\nNow, substitute the values into the expression for the density ratio:\n$$\n\\frac{\\rho_{2}}{\\rho_{1}} = \\frac{1+0.020}{1+0.005} \\cdot \\frac{1 + (0.005) \\left(\\frac{28.965}{18.01528}\\right)}{1 + (0.020) \\left(\\frac{28.965}{18.01528}\\right)}\n$$\n$$\n\\frac{\\rho_{2}}{\\rho_{1}} = \\frac{1.020}{1.005} \\cdot \\frac{1 + 0.008038985}{1 + 0.032155942} = \\frac{1.020}{1.005} \\cdot \\frac{1.008038985}{1.032155942}\n$$\n$$\n\\frac{\\rho_{2}}{\\rho_{1}} \\approx (1.014925373) \\cdot (0.976634630) \\approx 0.991209935\n$$\nThe fractional change is $\\frac{\\rho_{2}}{\\rho_{1}} - 1$:\n$$\n\\frac{\\rho_{2}-\\rho_{1}}{\\rho_{1}} \\approx 0.991209935 - 1 = -0.008790065\n$$\nRounding the result to four significant figures gives $-0.008790$.", "answer": "$$\n\\boxed{-0.008790}\n$$", "id": "2538457"}, {"introduction": "While standard psychrometric charts are invaluable, they are typically constructed for sea-level pressure. This practice guides you to explore how the chart's fundamental structure changes with barometric pressure, a critical consideration for applications at varying altitudes. By deriving the pressure dependence of the saturation curve and lines of constant specific volume [@problem_id:2538497], you will gain a deeper, more flexible understanding of psychrometric state relationships.", "problem": "An ideal-gas mixture model of moist air is to be used to analyze how barometric pressure affects psychrometric-chart features. Consider a binary mixture of dry air and water vapor at total pressure $P$ and temperature $T$, obeying Dalton’s law of partial pressures and the ideal gas law for each constituent. Define the humidity ratio $w$ as the mass of water vapor per unit mass of dry air. The saturation humidity ratio $w_{s}(T,P)$ is the value of $w$ when the vapor partial pressure equals the saturation vapor pressure $p_{\\mathrm{sat}}(T)$ at the same temperature. The specific volume per unit mass of dry air, $v(T,P,w)$, is the total mixture volume associated with $1$ kilogram of dry air.\n\nTasks:\n1. Starting only from the ideal gas law for each constituent, Dalton’s law of partial pressures, and the definition of $w$, derive analytic expressions for:\n   (i) the saturation humidity ratio $w_{s}(T,P)$ in terms of $p_{\\mathrm{sat}}(T)$ and $P$, and\n   (ii) the specific volume per kilogram of dry air, $v(T,P,w)$, in terms of $T$, $P$, and $w$.\n   Use the universal gas constant $R_{u}$ and the molar masses $M_{\\mathrm{da}}$ (dry air) and $M_{\\mathrm{w}}$ (water). Assume ideal-gas behavior and neglect any dissolved liquid water.\n\n2. Using the expressions you derived, provide a physically reasoned explanation for how decreasing $P$ shifts:\n   (a) the saturation curve $w_{s}(T,P)$ on a psychrometric chart of humidity ratio versus temperature, and\n   (b) the family of lines of constant specific volume $v$ on the same chart.\n   Your explanation must explicitly identify the sign of the pressure dependence at fixed $T$.\n\n3. Quantify the barometric-pressure effect on the saturation humidity ratio at fixed temperature by evaluating the dimensionless ratio\n   $$R \\equiv \\frac{w_{s}(T,P_{2})}{w_{s}(T,P_{1})}$$\n   at $T = 303.15\\ \\mathrm{K}$, $P_{1} = 101325\\ \\mathrm{Pa}$, and $P_{2} = 80000\\ \\mathrm{Pa}$, using $p_{\\mathrm{sat}}(303.15\\ \\mathrm{K}) = 4.241 \\times 10^{3}\\ \\mathrm{Pa}$, $M_{\\mathrm{da}} = 28.965\\ \\mathrm{kg}\\ \\mathrm{kmol}^{-1}$, and $M_{\\mathrm{w}} = 18.01528\\ \\mathrm{kg}\\ \\mathrm{kmol}^{-1}$. Express your final answer for $R$ as a pure number (no units), rounded to four significant figures.", "solution": "We model moist air as an ideal binary gas mixture of dry air and water vapor. Let $p_{\\mathrm{da}}$ and $p_{v}$ denote the partial pressures of dry air and water vapor. By Dalton’s law of partial pressures,\n$$\nP = p_{\\mathrm{da}} + p_{v}.\n$$\nLet $n_{\\mathrm{da}}$ and $n_{v}$ be the numbers of kilomoles of dry air and water vapor in a control volume $V$ at temperature $T$. The ideal gas law applied to each constituent gives\n$$\np_{\\mathrm{da}} V = n_{\\mathrm{da}} R_{u} T, \\qquad p_{v} V = n_{v} R_{u} T,\n$$\nwhere $R_{u}$ is the universal gas constant. The masses are $m_{\\mathrm{da}} = n_{\\mathrm{da}} M_{\\mathrm{da}}$ and $m_{v} = n_{v} M_{\\mathrm{w}}$, with $M_{\\mathrm{da}}$ and $M_{\\mathrm{w}}$ the molar masses of dry air and water, respectively.\n\nBy definition, the humidity ratio $w$ is\n$$\nw \\equiv \\frac{m_{v}}{m_{\\mathrm{da}}} = \\frac{n_{v} M_{\\mathrm{w}}}{n_{\\mathrm{da}} M_{\\mathrm{da}}}.\n$$\nUsing the ideal-gas relations to eliminate the mole numbers,\n$$\n\\frac{n_{v}}{n_{\\mathrm{da}}} = \\frac{p_{v} V/(R_{u} T)}{p_{\\mathrm{da}} V/(R_{u} T)} = \\frac{p_{v}}{p_{\\mathrm{da}}}.\n$$\nTherefore,\n$$\nw = \\frac{M_{\\mathrm{w}}}{M_{\\mathrm{da}}} \\frac{p_{v}}{p_{\\mathrm{da}}} = \\frac{M_{\\mathrm{w}}}{M_{\\mathrm{da}}} \\frac{p_{v}}{P - p_{v}}.\n$$\nAt saturation, $p_{v} = p_{\\mathrm{sat}}(T)$, so the saturation humidity ratio is\n$$\nw_{s}(T,P) = \\frac{M_{\\mathrm{w}}}{M_{\\mathrm{da}}} \\frac{p_{\\mathrm{sat}}(T)}{P - p_{\\mathrm{sat}}(T)}.\n$$\nThis completes item (i).\n\nFor the specific volume per kilogram of dry air, take a basis of $1$ kilogram of dry air. The kilomoles of dry air on this basis are $n_{\\mathrm{da}} = 1/M_{\\mathrm{da}}$. The mass of vapor per kilogram of dry air is $w$, so the kilomoles of vapor are $n_{v} = w/M_{\\mathrm{w}}$. The total kilomoles in the mixture are\n$$\nn_{\\mathrm{tot}} = n_{\\mathrm{da}} + n_{v} = \\frac{1}{M_{\\mathrm{da}}} + \\frac{w}{M_{\\mathrm{w}}}.\n$$\nBy the ideal gas law for the mixture, the total volume associated with $1$ kilogram of dry air is\n$$\nv(T,P,w) = \\frac{n_{\\mathrm{tot}} R_{u} T}{P} = \\frac{R_{u} T}{P} \\left( \\frac{1}{M_{\\mathrm{da}}} + \\frac{w}{M_{\\mathrm{w}}} \\right).\n$$\nThis completes item (ii).\n\nFor item (2a), examine the pressure dependence of $w_{s}(T,P)$ at fixed $T$. From the expression above,\n$$\nw_{s}(T,P) = \\left( \\frac{M_{\\mathrm{w}}}{M_{\\mathrm{da}}} p_{\\mathrm{sat}}(T) \\right) \\frac{1}{P - p_{\\mathrm{sat}}(T)}.\n$$\nAt fixed $T$, $p_{\\mathrm{sat}}(T)$ is a constant independent of the barometric pressure. Differentiating with respect to $P$,\n$$\n\\frac{\\partial w_{s}}{\\partial P}\\bigg|_{T} = - \\left( \\frac{M_{\\mathrm{w}}}{M_{\\mathrm{da}}} p_{\\mathrm{sat}}(T) \\right) \\frac{1}{\\left[P - p_{\\mathrm{sat}}(T)\\right]^{2}}  0,\n$$\nfor $P > p_{\\mathrm{sat}}(T)$. Thus, decreasing $P$ increases $w_{s}(T,P)$. On a chart of humidity ratio versus temperature, the saturation curve $w_{s}(T,P)$ shifts upward (to higher humidity ratio at the same temperature) as barometric pressure decreases.\n\nFor item (2b), consider lines of constant specific volume. At fixed $T$ and $v$, solve the expression for $w$:\n$$\nv = \\frac{R_{u} T}{P} \\left( \\frac{1}{M_{\\mathrm{da}}} + \\frac{w}{M_{\\mathrm{w}}} \\right) \\;\\;\\Longrightarrow\\;\\; \\frac{v P}{R_{u} T} = \\frac{1}{M_{\\mathrm{da}}} + \\frac{w}{M_{\\mathrm{w}}}\n$$\nand therefore\n$$\nw(T,P;v) = M_{\\mathrm{w}} \\left( \\frac{v P}{R_{u} T} - \\frac{1}{M_{\\mathrm{da}}} \\right).\n$$\nFor fixed $T$ and $v$, the derivative with respect to $P$ is\n$$\n\\frac{\\partial w}{\\partial P}\\bigg|_{T,v} = M_{\\mathrm{w}} \\frac{v}{R_{u} T} > 0.\n$$\nHence, decreasing $P$ at fixed $T$ and fixed $v$ decreases $w$. On a humidity ratio versus temperature chart, the family of lines of constant specific volume shifts downward (to lower humidity ratio at the same temperature) as barometric pressure decreases.\n\nFor item (3), evaluate the ratio\n$$\nR \\equiv \\frac{w_{s}(T,P_{2})}{w_{s}(T,P_{1})}.\n$$\nUsing the expression for $w_{s}(T,P)$,\n$$\nR = \\frac{\\dfrac{M_{\\mathrm{w}}}{M_{\\mathrm{da}}} \\dfrac{p_{\\mathrm{sat}}(T)}{P_{2} - p_{\\mathrm{sat}}(T)}}{\\dfrac{M_{\\mathrm{w}}}{M_{\\mathrm{da}}} \\dfrac{p_{\\mathrm{sat}}(T)}{P_{1} - p_{\\mathrm{sat}}(T)}} = \\frac{P_{1} - p_{\\mathrm{sat}}(T)}{P_{2} - p_{\\mathrm{sat}}(T)}.\n$$\nInsert the given values $T = 303.15\\ \\mathrm{K}$, $p_{\\mathrm{sat}}(T) = 4.241 \\times 10^{3}\\ \\mathrm{Pa}$, $P_{1} = 101325\\ \\mathrm{Pa}$, and $P_{2} = 80000\\ \\mathrm{Pa}$:\n$$\nP_{1} - p_{\\mathrm{sat}}(T) = 101325 - 4241 = 97084\\ \\mathrm{Pa},\n$$\n$$\nP_{2} - p_{\\mathrm{sat}}(T) = 80000 - 4241 = 75759\\ \\mathrm{Pa},\n$$\nso\n$$\nR = \\frac{97084}{75759}.\n$$\nNumerically, $R \\approx 1.2814\\ldots$. Rounding to four significant figures gives $R = 1.281$ as a pure number.", "answer": "$$\\boxed{1.281}$$", "id": "2538497"}, {"introduction": "Translating raw instrument readings into meaningful psychrometric properties is a core engineering task. This computational exercise puts theory into practice by having you implement an algorithm to determine humidity ratio $w$ and relative humidity $\\phi$ from measured dry-bulb temperature $T$, wet-bulb temperature $T_w$, and pressure $p$. Beyond the calculation itself, this problem [@problem_id:2538505] introduces you to sensitivity analysis, a powerful technique for quantifying how uncertainties in model parameters affect your final results.", "problem": "You are to implement a robust algorithm to compute the humidity ratio and the relative humidity of a moist air stream from dry-bulb and wet-bulb psychrometer measurements under the following assumptions and requirements.\n\nStart from the following physically grounded base:\n- The moist air mixture is modeled as an ideal mixture of a non-condensable gas (dry air) and water vapor at total pressure $p$ (in $\\mathrm{Pa}$). The water vapor partial pressure is denoted $p_v$ (in $\\mathrm{Pa}$).\n- The humidity ratio $w$ (in $\\mathrm{kg_{vapor}/kg_{dry\\_air}}$) is defined by $w = m_v/m_a$ and, under the ideal-gas approximation, relates to $p_v$ by $w = \\varepsilon \\, p_v / (p - p_v)$, where $\\varepsilon = M_v/M_a$ is the molar mass ratio of water vapor to dry air.\n- A ventilated wet-bulb psychrometer operates at steady state such that the convective sensible heat transfer from the bulk air at dry-bulb temperature $T$ (in $\\mathrm{^{\\circ}C}$) to the wetted wick at wet-bulb temperature $T_w$ (in $\\mathrm{^{\\circ}C}$) balances the latent heat required to evaporate water into the stream. Under the Lewis relation near unity and using a prescribed psychrometric constant $\\gamma(p)$ (with units $\\mathrm{Pa/K}$), this balance yields a single scalar relation that couples $T$, $T_w$, $p$, and $p_v$. Your algorithm must derive and solve this scalar relation for $p_v$ and then compute $w$ and the relative humidity $\\phi$.\n- The interfacial vapor at the wetted wick is saturated at $T_w$, and the bulk relative humidity satisfies $\\phi = p_v / p_{ws}(T)$ with $p_{ws}(T)$ the saturation vapor pressure of pure water at temperature $T$.\n\nYou must adopt the following well-tested correlation for the saturation vapor pressure (valid for liquid water for $T \\gtrsim 0\\,\\mathrm{^{\\circ}C}$) expressed in $\\mathrm{Pa}$ as a function of temperature in $\\mathrm{^{\\circ}C}$:\n$$\np_{ws}(T) = 611.21 \\,\\exp\\!\\left(\\left(18.678 - \\frac{T}{234.5}\\right)\\frac{T}{257.14 + T}\\right).\n$$\n\nUse the molar mass ratio $\\varepsilon = 0.62198$ (dimensionless). For the psychrometric constant, use the baseline function\n$$\n\\gamma_b(p) = \\frac{c_{p,a}\\,p}{\\varepsilon \\, L_{v0}},\n$$\nwith $c_{p,a} = 1006\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ and $L_{v0} = 2.5\\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$. The function $\\gamma_b(p)$ returns $\\mathrm{Pa/K}$ when $p$ is provided in $\\mathrm{Pa}$.\n\nAlgorithmic requirements:\n- Formulate and solve the scalar equation implied by the steady heat and mass transfer coupling to recover $p_v$ from the measured triple $(T, T_w, p)$ and the assumed $\\gamma(p)$. Your implementation must enforce the physical bounds $0 \\le p_v \\le \\min\\{p,\\,p_{ws}(T)\\}$.\n- Compute $w$ in $\\mathrm{kg_{vapor}/kg_{dry\\_air}}$ and $\\phi$ as a decimal fraction (dimensionless).\n- Quantify the sensitivity of $w$ and $\\phi$ to the assumed $\\gamma$ at fixed $(T, T_w, p)$ by evaluating the normalized sensitivities\n$$\nS_w \\equiv \\frac{\\gamma}{w}\\,\\frac{\\partial w}{\\partial \\gamma}, \\qquad S_{\\phi} \\equiv \\frac{\\gamma}{\\phi}\\,\\frac{\\partial \\phi}{\\partial \\gamma},\n$$\nevaluated at $\\gamma_b(p)$. You may obtain these by principled differentiation of your governing equation for $p_v$ and the definitions of $w$ and $\\phi$.\n- Numerical robustness: your implementation must be stable for all test cases below, including near-saturation cases where $T \\approx T_w$ and cases with large wet-bulb depression where $T - T_w$ is large. If the implied $p_v$ by your model violates the physical bounds, enforce the bounds and set the corresponding local sensitivity contribution to zero consistently with an active constraint.\n\nUnits and formatting:\n- Input temperatures $T$ and $T_w$ are in $\\mathrm{^{\\circ}C}$, pressure $p$ is in $\\mathrm{Pa}$.\n- Output $w$ in $\\mathrm{kg_{vapor}/kg_{dry\\_air}}$ and $\\phi$ and the sensitivities $S_w$, $S_{\\phi}$ as decimal fractions (dimensionless). Round each reported value to exactly $6$ decimal places.\n\nTest suite:\nProvide results for the following parameter sets $(T, T_w, p)$:\n- Case $1$: $T = 30.0\\,\\mathrm{^{\\circ}C}$, $T_w = 20.0\\,\\mathrm{^{\\circ}C}$, $p = 101325\\,\\mathrm{Pa}$.\n- Case $2$: $T = 25.0\\,\\mathrm{^{\\circ}C}$, $T_w = 24.5\\,\\mathrm{^{\\circ}C}$, $p = 101325\\,\\mathrm{Pa}$.\n- Case $3$: $T = 20.0\\,\\mathrm{^{\\circ}C}$, $T_w = 10.0\\,\\mathrm{^{\\circ}C}$, $p = 80000\\,\\mathrm{Pa}$.\n- Case $4$: $T = 40.0\\,\\mathrm{^{\\circ}C}$, $T_w = 10.0\\,\\mathrm{^{\\circ}C}$, $p = 101325\\,\\mathrm{Pa}$.\n\nRequired final output format:\nYour program should produce a single line of output containing the concatenated results for all test cases as a comma-separated list enclosed in square brackets. For each case, output the four floats in the order $[w, \\phi, S_w, S_{\\phi}]$ with each value rounded to exactly $6$ decimal places. Thus the final line must look like\n[$w_1, \\phi_1, S_{w,1}, S_{\\phi,1}, \\dots, S_{\\phi,4}$] with no extra text.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It presents a standard problem in psychrometry, grounded in the fundamental principles of heat and mass transfer and thermodynamics. All required constants, correlations, and definitions are provided. The task is to derive and implement a computational model based on these principles. We shall proceed with the solution.\n\nThe core of the problem lies in the steady-state energy balance on the wetted wick of a psychrometer. Convective sensible heat transfer from the warmer bulk air at dry-bulb temperature $T$ to the cooler liquid-vapor interface at the wet-bulb temperature $T_w$ is balanced by the latent heat absorbed during the evaporation of water from the wick into the air stream.\n\nThe sensible heat flux per unit area is given by $q''_{sensible} = h_c (T - T_w)$, where $h_c$ is the convective heat transfer coefficient. The latent heat flux is $q''_{latent} = \\dot{m}''_{v} L_v$, where $\\dot{m}''_{v}$ is the mass flux of evaporated water and $L_v$ is the latent heat of vaporization. The mass flux is driven by the difference in water vapor concentration between the saturated interface and the bulk air, $\\dot{m}''_{v} = h_m (w_{ws}(T_w) - w)$, where $h_m$ is the mass transfer coefficient, $w$ is the humidity ratio of the bulk air, and $w_{ws}(T_w)$ is the humidity ratio of saturated air at the wet-bulb temperature.\n\nThe energy balance is thus $h_c (T - T_w) = h_m L_v (w_{ws}(T_w) - w)$. The Lewis relation, which for the air-water system is approximately unity, states that $\\frac{h_c}{h_m c_p} \\approx 1$. Using the specific heat of moist air, which we approximate as that of dry air, $c_{p,a}$, we obtain $h_c \\approx h_m c_{p,a}$. Substituting this into the balance equation and simplifying yields the psychrometric relation:\n$$\nc_{p,a} (T - T_w) = L_v (w_{ws}(T_w) - w)\n$$\nThis equation is often expressed in terms of pressures. Using the approximate relations $w \\approx \\frac{\\varepsilon}{p} p_v$ and $w_{ws}(T_w) \\approx \\frac{\\varepsilon}{p} p_{ws}(T_w)$, which are valid when the partial pressures of vapor are small compared to the total pressure $p$, and substituting into the balance gives:\n$$\nc_{p,a} (T - T_w) \\approx L_v \\left( \\frac{\\varepsilon}{p} p_{ws}(T_w) - \\frac{\\varepsilon}{p} p_v \\right)\n$$\nRearranging to solve for the unknown partial pressure of water vapor, $p_v$, we find:\n$$\np_v \\approx p_{ws}(T_w) - \\frac{c_{p,a} p}{\\varepsilon L_v} (T - T_w)\n$$\nThe term multiplying the temperature difference is the psychrometric constant, $\\gamma(p)$. The problem provides the expression for this constant, using a reference latent heat $L_{v0}$:\n$$\n\\gamma_b(p) = \\frac{c_{p,a}\\,p}{\\varepsilon \\, L_{v0}}\n$$\nwhere $c_{p,a} = 1006\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $L_{v0} = 2.5\\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$, and the molar mass ratio $\\varepsilon = M_v/M_a = 0.62198$. The temperatures $T$ and $T_w$ are in $^{\\circ}\\mathrm{C}$, but their difference $(T-T_w)$ is numerically identical in Kelvin, matching the units $\\mathrm{Pa/K}$ of $\\gamma$. Thus, the governing equation to be solved for $p_v$ is:\n$$\np_v = p_{ws}(T_w) - \\gamma_b(p) (T - T_w)\n$$\nThe saturation pressure of water vapor, $p_{ws}$, as a function of temperature $T$ in $^{\\circ}\\mathrm{C}$, is given by the correlation:\n$$\np_{ws}(T) = 611.21 \\,\\exp\\!\\left(\\left(18.678 - \\frac{T}{234.5}\\right)\\frac{T}{257.14 + T}\\right)\n$$\nThe calculated $p_v$ must be physically realistic. It cannot be negative, nor can it exceed the total pressure $p$, nor can it imply supersaturation at the dry-bulb temperature $T$. This imposes the bounds $0 \\le p_v \\le \\min\\{p, p_{ws}(T)\\}$. We first calculate an unconstrained value $p_{v,\\text{calc}} = p_{ws}(T_w) - \\gamma_b(p) (T-T_w)$ and then apply the bounds:\n$$\np_v = \\max(0, \\min(p_{v,\\text{calc}}, p, p_{ws}(T)))\n$$\nOnce $p_v$ is determined, the humidity ratio $w$ and relative humidity $\\phi$ are computed from their definitions:\n$$\nw = \\frac{\\varepsilon p_v}{p - p_v} \\quad (\\mathrm{kg_{vapor}/kg_{dry\\_air}})\n$$\n$$\n\\phi = \\frac{p_v}{p_{ws}(T)} \\quad (\\text{dimensionless})\n$$\nThe problem requires the evaluation of normalized sensitivities of $w$ and $\\phi$ to the psychrometric constant $\\gamma = \\gamma_b(p)$, defined as:\n$$\nS_w \\equiv \\frac{\\gamma}{w}\\,\\frac{\\partial w}{\\partial \\gamma}, \\qquad S_{\\phi} \\equiv \\frac{\\gamma}{\\phi}\\,\\frac{\\partial \\phi}{\\partial \\gamma}\n$$\nThese sensitivities quantify the fractional change in the output variable for a fractional change in $\\gamma$. To compute them, we must find the derivatives $\\frac{\\partial w}{\\partial \\gamma}$ and $\\frac{\\partial \\phi}{\\partial \\gamma}$, holding $(T, T_w, p)$ constant. First, we find the derivative of $p_v$ with respect to $\\gamma$:\n$$\n\\frac{\\partial p_v}{\\partial \\gamma} = \\frac{\\partial}{\\partial \\gamma} \\left( p_{ws}(T_w) - \\gamma (T - T_w) \\right) = -(T - T_w)\n$$\nThis derivative is non-zero only if the calculated $p_v$ is not limited by an active physical constraint. If $p_{v,\\text{calc}}$ falls outside the allowed range $[0, \\min\\{p, p_{ws}(T)\\}]$ and is clipped, $p_v$ becomes constant at the boundary value, and its derivative with respect to $\\gamma$ is zero. Therefore:\n$$\n\\frac{\\partial p_v}{\\partial \\gamma} = \\begin{cases} -(T-T_w)  \\text{if } 0  p_{v,\\text{calc}}  \\min\\{p, p_{ws}(T)\\} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nUsing the chain rule, we find the derivatives for $\\phi$ and $w$:\n$$\n\\frac{\\partial \\phi}{\\partial \\gamma} = \\frac{\\partial \\phi}{\\partial p_v} \\frac{\\partial p_v}{\\partial \\gamma} = \\frac{1}{p_{ws}(T)} \\frac{\\partial p_v}{\\partial \\gamma}\n$$\n$$\n\\frac{\\partial w}{\\partial \\gamma} = \\frac{\\partial w}{\\partial p_v} \\frac{\\partial p_v}{\\partial \\gamma} = \\frac{\\varepsilon p}{(p - p_v)^2} \\frac{\\partial p_v}{\\partial \\gamma}\n$$\nSubstituting these into the sensitivity definitions yields:\n$$\nS_{\\phi} = \\frac{\\gamma}{\\phi} \\frac{1}{p_{ws}(T)} \\frac{\\partial p_v}{\\partial \\gamma} = \\frac{\\gamma}{p_v/p_{ws}(T)} \\frac{1}{p_{ws}(T)} \\frac{\\partial p_v}{\\partial \\gamma} = \\frac{\\gamma}{p_v} \\frac{\\partial p_v}{\\partial \\gamma}\n$$\n$$\nS_w = \\frac{\\gamma}{w} \\frac{\\varepsilon p}{(p-p_v)^2} \\frac{\\partial p_v}{\\partial \\gamma} = \\frac{\\gamma}{\\varepsilon p_v/(p-p_v)} \\frac{\\varepsilon p}{(p-p_v)^2} \\frac{\\partial p_v}{\\partial \\gamma} = \\frac{\\gamma p}{p_v(p-p_v)} \\frac{\\partial p_v}{\\partial \\gamma}\n$$\nIf $p_v=0$, the denominators are zero. However, in this case, $p_v$ is at an active constraint, so $\\frac{\\partial p_v}{\\partial \\gamma}=0$, which implies $\\frac{\\partial \\phi}{\\partial \\gamma}=0$ and $\\frac{\\partial w}{\\partial \\gamma}=0$. Consequently, we must define $S_{\\phi}=0$ and $S_w=0$ when $p_v=0$.\n\nThe overall algorithm is as follows:\n1.  For a given set of inputs $(T, T_w, p)$, calculate the required saturation pressures $p_{ws}(T)$ and $p_{ws}(T_w)$.\n2.  Calculate the psychrometric constant $\\gamma_b(p)$.\n3.  Calculate the unconstrained vapor pressure $p_{v,\\text{calc}} = p_{ws}(T_w) - \\gamma_b(p) (T-T_w)$.\n4.  Determine if $p_{v,\\text{calc}}$ is within the physical bounds. If not, set $\\frac{\\partial p_v}{\\partial \\gamma} = 0$; otherwise, set $\\frac{\\partial p_v}{\\partial \\gamma} = -(T-T_w)$.\n5.  Apply the physical bounds to obtain the final $p_v = \\max(0, \\min(p_{v,\\text{calc}}, p, p_{ws}(T)))$.\n6.  If $p_v = 0$, set $w=0$, $\\phi=0$, $S_w=0$, and $S_\\phi=0$.\n7.  Otherwise, calculate $w$ and $\\phi$ using the final $p_v$.\n8.  Calculate the sensitivities $S_w$ and $S_\\phi$ using the value of $\\frac{\\partial p_v}{\\partial \\gamma}$ determined in step 4.\n9.  Report all four resulting quantities, rounded to the specified precision. This procedure is applied to all test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes test cases and prints the final result.\n    \"\"\"\n\n    # Define constants based on the problem statement.\n    EPSILON = 0.62198  # Molar mass ratio M_v/M_a (dimensionless)\n    C_PA = 1006.0      # Specific heat of dry air (J/kg/K)\n    L_V0 = 2.5e6       # Latent heat of vaporization of water (J/kg)\n\n    def p_ws(T_celsius):\n        \"\"\"\n        Calculates saturation vapor pressure of water using the provided correlation.\n        Args:\n            T_celsius (float): Temperature in degrees Celsius.\n        Returns:\n            float: Saturation pressure in Pascals.\n        \"\"\"\n        return 611.21 * np.exp((18.678 - T_celsius / 234.5) * (T_celsius / (257.14 + T_celsius)))\n\n    def gamma_b(p_pascal):\n        \"\"\"\n        Calculates the psychrometric constant.\n        Args:\n            p_pascal (float): Total pressure in Pascals.\n        Returns:\n            float: Psychrometric constant in Pa/K.\n        \"\"\"\n        return (C_PA * p_pascal) / (EPSILON * L_V0)\n\n    def calculate_properties(T, T_w, p):\n        \"\"\"\n        Calculates humidity ratio, relative humidity, and their sensitivities.\n        Args:\n            T (float): Dry-bulb temperature in degrees Celsius.\n            T_w (float): Wet-bulb temperature in degrees Celsius.\n            p (float): Total pressure in Pascals.\n        Returns:\n            tuple: A tuple containing (w, phi, S_w, S_phi) rounded to 6 decimal places.\n        \"\"\"\n        # Step 1: Calculate saturation pressures and psychrometric constant\n        p_ws_T = p_ws(T)\n        p_ws_Tw = p_ws(T_w)\n        gamma = gamma_b(p)\n\n        # Step 2: Calculate unconstrained vapor pressure\n        p_v_calc = p_ws_Tw - gamma * (T - T_w)\n\n        # Step 3: Determine if an active constraint exists for sensitivity calculation\n        upper_bound = min(p, p_ws_T)\n        if 0.0  p_v_calc  upper_bound:\n            dpv_dgamma = -(T - T_w)\n        else:\n            dpv_dgamma = 0.0\n\n        # Step 4: Apply physical bounds to get the final vapor pressure\n        p_v = max(0.0, min(p_v_calc, upper_bound))\n        \n        # Step 5: Handle the special case of perfectly dry air (p_v = 0)\n        if p_v = 0.0:\n            w, phi, S_w, S_phi = 0.0, 0.0, 0.0, 0.0\n        else:\n            # Step 6: Calculate humidity ratio and relative humidity\n            w = (EPSILON * p_v) / (p - p_v)\n            phi = p_v / p_ws_T\n\n            # Step 7: Calculate sensitivities\n            S_phi = (gamma / p_v) * dpv_dgamma\n            S_w = (gamma * p) / (p_v * (p - p_v)) * dpv_dgamma\n        \n        # Step 8: Round all results to 6 decimal places\n        return (\n            round(w, 6),\n            round(phi, 6),\n            round(S_w, 6),\n            round(S_phi, 6)\n        )\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (30.0, 20.0, 101325.0), # Case 1\n        (25.0, 24.5, 101325.0), # Case 2\n        (20.0, 10.0, 80000.0),  # Case 3\n        (40.0, 10.0, 101325.0), # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        T_case, Tw_case, p_case = case\n        result_tuple = calculate_properties(T_case, Tw_case, p_case)\n        results.extend(map(str, result_tuple))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2538505"}]}