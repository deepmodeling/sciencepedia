{"hands_on_practices": [{"introduction": "Before embarking on a computationally intensive Direct Numerical Simulation, a crucial first step is to estimate the resources required. This cost is dictated by the need to resolve the smallest active scales in the flow, which for heat transfer problems can be much smaller than the velocity scales, especially at high Prandtl numbers. This exercise explores the fundamental relationship between the fluid's Prandtl number ($Pr$), the smallest thermal scale (the Batchelor scale, $\\eta_B$), and the overall computational cost, connecting turbulence theory directly to practical simulation planning [@problem_id:2477540].", "problem": "A turbulent plane channel flow of an incompressible Newtonian fluid is simulated by Direct Numerical Simulation (DNS) to resolve both the velocity and temperature fields at fixed friction Reynolds number $Re_{\\tau} = u_{\\tau}\\delta/\\nu$, where $u_{\\tau}$ is the friction velocity, $\\delta$ is the channel half-height, and $\\nu$ is the kinematic viscosity. The objective is to assess how the computational cost changes when the Prandtl number $Pr = \\nu/\\alpha$ is increased from $Pr = 0.7$ to $Pr = 7.0$, where $\\alpha$ is the thermal diffusivity. The computational cost is modeled as proportional to the product of the total number of grid points and the total number of time steps over a fixed physical time interval, i.e., $C \\propto N_{x}N_{y}N_{z}N_{t}$.\n\nAssume the following modeling assumptions, grounded in standard turbulence theory:\n- The smallest dynamically relevant velocity scale is the Kolmogorov length $\\eta_{K}$, and the corresponding Kolmogorov time scale $\\tau_{\\eta}$ satisfies $\\tau_{\\eta} \\sim \\eta_{K}^{2}/\\nu$.\n- The smallest dynamically relevant thermal scale is the Batchelor scale $\\eta_{B}$, obtained by balancing the thermal diffusion time at scale $r$, $t_{d}(r) \\sim r^{2}/\\alpha$, with the smallest eddy turnover or strain time $t_{s} \\sim \\tau_{\\eta}$ in the viscous-convective range.\n- For $Pr  1$, the thermal dissipative scale exceeds $\\eta_{K}$ and thus the velocity field resolution controls; for $Pr  1$, the thermal dissipative scale is smaller than $\\eta_{K}$ and thus the temperature field resolution controls.\n- The grid is chosen such that the smallest spacing in each direction satisfies $\\Delta x \\sim \\Delta y \\sim \\Delta z \\sim c\\,\\eta_{\\min}$ with a fixed constant $c$, where $\\eta_{\\min}$ is the smallest of the dynamically relevant physical scales that must be resolved.\n- The time step for an explicit scheme is limited by advection through a Courant–Friedrichs–Lewy (CFL) stability condition associated with the momentum equations, with $\\Delta t \\propto \\Delta x/U$, where $U$ is a characteristic velocity scale that does not change with $Pr$ at fixed $Re_{\\tau}$.\n- You may assume that changes in $Pr$ only alter the thermal diffusivity $\\alpha$ while $\\nu$ and $Re_{\\tau}$ remain fixed, and that $\\eta_{K}$ is unaffected to leading order at fixed $Re_{\\tau}$.\n\nStarting from the definitions above and the balance $r^{2}/\\alpha \\sim \\tau_{\\eta}$ for the thermal smallest scale, derive how the smallest thermal scale $\\eta_{B}$ depends on $\\eta_{K}$ and $Pr$. Then, using the cost model $C \\propto N_{x}N_{y}N_{z}N_{t}$ together with the grid and time-step scalings stated, determine the multiplicative factor by which the computational cost increases when $Pr$ is raised from $Pr = 0.7$ to $Pr = 7.0$ at fixed $Re_{\\tau}$, solely due to the need to resolve the thermal smallest scale. Express your final answer as an exact dimensionless factor (no units, no rounding).", "solution": "The problem will first be subjected to a rigorous validation procedure before any attempt at a solution is made.\n\n**Step 1: Extract Givens**\n\n- **System**: A turbulent plane channel flow of an incompressible Newtonian fluid.\n- **Simulation Method**: Direct Numerical Simulation (DNS).\n- **Fixed Parameter**: Friction Reynolds number $Re_{\\tau} = u_{\\tau}\\delta/\\nu$.\n- **Variables**: $u_{\\tau}$ is the friction velocity, $\\delta$ is the channel half-height, $\\nu$ is the kinematic viscosity, $\\alpha$ is the thermal diffusivity.\n- **Prandtl Numbers**: The problem compares the cases $Pr = \\nu/\\alpha = 0.7$ and $Pr = 7.0$.\n- **Cost Model**: Computational cost $C \\propto N_{x}N_{y}N_{z}N_{t}$, where $N_x, N_y, N_z$ are grid points and $N_t$ is the number of time steps.\n- **Assumptions**:\n    1.  The smallest velocity scale is the Kolmogorov length $\\eta_{K}$; the Kolmogorov time scale is $\\tau_{\\eta} \\sim \\eta_{K}^{2}/\\nu$.\n    2.  The smallest thermal scale, the Batchelor scale $\\eta_{B}$, is found by balancing thermal diffusion time $t_{d}(r) \\sim r^{2}/\\alpha$ with the smallest eddy turnover time $t_{s} \\sim \\tau_{\\eta}$.\n    3.  For $Pr  1$, the controlling scale is $\\eta_{K}$. For $Pr  1$, the controlling scale is $\\eta_{B}$.\n    4.  Grid spacing scales as $\\Delta x \\sim \\Delta y \\sim \\Delta z \\sim c\\,\\eta_{\\min}$, where $\\eta_{\\min}$ is the smallest relevant scale to be resolved and $c$ is a constant.\n    5.  Time step $\\Delta t \\propto \\Delta x/U$, where the characteristic velocity $U$ is constant.\n    6.  Changes in $Pr$ only affect $\\alpha$, while $\\nu$, $Re_{\\tau}$, and $\\eta_{K}$ remain fixed.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is analyzed against the required criteria.\n\n- **Scientifically Grounded**: The problem is rooted in the established theory of turbulence and heat transfer, specifically the Kolmogorov and Batchelor scaling laws for dissipative scales. These concepts are fundamental to the field and are not speculative. The DNS context is standard for high-fidelity studies of such phenomena.\n- **Well-Posed**: The problem provides a clear objective and a complete set of scaling assumptions necessary to derive a unique solution. The inputs ($Pr_1 = 0.7$, $Pr_2 = 7.0$) and the question (the multiplicative factor for cost) are unambiguous.\n- **Objective**: The language is technical and free of subjective or opinion-based claims. The assumptions, while being models, are explicitly stated and represent standard practice in the field of turbulence simulation.\n- **Formalizable and Relevant**: The problem is directly relevant to the topic of DNS of heat transfer. The scaling analogies are standard and can be formalized mathematically, as required for the solution.\n- **Complete and Consistent**: The problem provides all necessary definitions and relations. There are no missing data or internal contradictions. The assumption that $\\eta_{K}$ is fixed at constant $Re_{\\tau}$ is a standard and valid simplification in this context.\n- **Feasible and Realistic**: The Prandtl numbers chosen are realistic for common fluids (e.g., air has $Pr \\approx 0.7$, water has $Pr \\approx 7.0$). The scaling assumptions are standard approximations used in cost estimation for DNS.\n- **Not Trivial or Ill-Posed**: The problem requires a multi-step derivation involving the synthesis of several scaling laws, which is a non-trivial reasoning task. It is not tautological or circular.\n\n**Step 3: Verdict and Action**\n\nThe problem is scientifically grounded, well-posed, objective, and complete. It is therefore deemed **valid**. A solution will be derived.\n\nThe solution proceeds in four stages. First, we establish the relationship between the Batchelor scale $\\eta_B$ and the Kolmogorov scale $\\eta_K$. Second, we determine the smallest resolution scale, $\\eta_{\\min}$, for the two given Prandtl numbers. Third, we derive the scaling of computational cost $C$ with respect to $\\eta_{\\min}$. Finally, we compute the ratio of costs.\n\n**1. Derivation of the Batchelor Scale**\n\nAccording to the provided assumptions, the Batchelor scale $\\eta_B$ is the length scale at which the thermal diffusion time, $t_d(r) \\sim r^2/\\alpha$, equals the smallest eddy strain time, which is the Kolmogorov time scale, $t_s \\sim \\tau_\\eta$. Thus, we set $r = \\eta_B$ and equate the time scales:\n$$\n\\frac{\\eta_B^2}{\\alpha} \\sim \\tau_\\eta\n$$\nThe problem also provides the scaling for the Kolmogorov time scale:\n$$\n\\tau_\\eta \\sim \\frac{\\eta_K^2}{\\nu}\n$$\nSubstituting this into the previous relation yields:\n$$\n\\frac{\\eta_B^2}{\\alpha} \\sim \\frac{\\eta_K^2}{\\nu}\n$$\nWe can rearrange this expression to solve for $\\eta_B$ in terms of $\\eta_K$:\n$$\n\\eta_B^2 \\sim \\eta_K^2 \\left(\\frac{\\alpha}{\\nu}\\right)\n$$\nBy definition, the Prandtl number is $Pr = \\nu/\\alpha$. Therefore, $\\alpha/\\nu = 1/Pr$. Substituting this into the expression for $\\eta_B^2$ gives:\n$$\n\\eta_B^2 \\sim \\frac{\\eta_K^2}{Pr} \\implies \\eta_B \\sim \\frac{\\eta_K}{Pr^{1/2}}\n$$\nThis relation connects the smallest thermal scale to the smallest velocity scale and the Prandtl number.\n\n**2. Determination of the Resolution Scale, $\\eta_{\\min}$**\n\nThe problem specifies how to determine the controlling minimal scale, $\\eta_{\\min}$, that the DNS grid must resolve.\n- Let $Pr_1 = 0.7$. Since $Pr_1  1$, the thermal scale $\\eta_B \\sim \\eta_K / (0.7)^{1/2}  \\eta_K$. The controlling (smallest) scale is the Kolmogorov scale. Thus, for the first case, $\\eta_{\\min, 1} = \\eta_K$.\n- Let $Pr_2 = 7.0$. Since $Pr_2  1$, the thermal scale $\\eta_B \\sim \\eta_K / (7.0)^{1/2}  \\eta_K$. The controlling (smallest) scale is the Batchelor scale. Thus, for the second case, $\\eta_{\\min, 2} = \\eta_{B,2}$, where $\\eta_{B,2} \\sim \\eta_K / Pr_2^{1/2}$.\n\n**3. Scaling of Computational Cost, $C$**\n\nThe computational cost is given by $C \\propto N_x N_y N_z N_t$.\nThe number of grid points in each spatial direction, $N_i$ for $i \\in \\{x, y, z\\}$, is the domain length $L_i$ in that direction divided by the grid spacing $\\Delta i$. Assuming fixed domain dimensions $L_x, L_y, L_z$, we have $N_i \\propto 1/\\Delta i$.\nThe grid spacing in all directions must be fine enough to resolve the smallest scale, $\\eta_{\\min}$. The problem states $\\Delta x \\sim \\Delta y \\sim \\Delta z \\sim c\\,\\eta_{\\min}$. Therefore:\n$$\nN_x \\propto \\frac{1}{\\eta_{\\min}}, \\quad N_y \\propto \\frac{1}{\\eta_{\\min}}, \\quad N_z \\propto \\frac{1}{\\eta_{\\min}}\n$$\nThe total number of grid points $N_{grid} = N_x N_y N_z$ thus scales as:\n$$\nN_{grid} \\propto \\frac{1}{\\eta_{\\min}^3} = \\eta_{\\min}^{-3}\n$$\nNext, we determine the scaling for the number of time steps, $N_t$. The simulation runs for a fixed physical time interval $T_{phys}$, so $N_t = T_{phys} / \\Delta t \\propto 1/\\Delta t$.\nThe time step size $\\Delta t$ is limited by a CFL condition, given as $\\Delta t \\propto \\Delta x/U$. Since $\\Delta x \\sim \\eta_{\\min}$ and the characteristic velocity $U$ is assumed constant, we have:\n$$\n\\Delta t \\propto \\eta_{\\min} \\implies N_t \\propto \\frac{1}{\\Delta t} \\propto \\eta_{\\min}^{-1}\n$$\nCombining these scalings, the total computational cost $C$ scales as:\n$$\nC \\propto N_{grid} \\cdot N_t \\propto (\\eta_{\\min}^{-3}) \\cdot (\\eta_{\\min}^{-1}) = \\eta_{\\min}^{-4}\n$$\n\n**4. Calculation of the Cost Ratio**\n\nWe are asked to find the multiplicative factor by which the cost increases when $Pr$ goes from $Pr_1 = 0.7$ to $Pr_2 = 7.0$. This is the ratio $C_2 / C_1$, where $C_1$ is the cost for $Pr_1$ and $C_2$ is the cost for $Pr_2$.\nUsing the cost scaling $C \\propto \\eta_{\\min}^{-4}$, the ratio is:\n$$\n\\frac{C_2}{C_1} = \\left(\\frac{\\eta_{\\min, 2}}{\\eta_{\\min, 1}}\\right)^{-4}\n$$\nFrom Step 2, we have $\\eta_{\\min, 1} = \\eta_K$ and $\\eta_{\\min, 2} = \\eta_{B,2} = \\eta_K / Pr_2^{1/2}$ with $Pr_2 = 7.0$.\nSubstituting these into the ratio:\n$$\n\\frac{C_2}{C_1} = \\left(\\frac{\\eta_K / Pr_2^{1/2}}{\\eta_K}\\right)^{-4} = \\left(\\frac{1}{Pr_2^{1/2}}\\right)^{-4} = (Pr_2^{1/2})^4\n$$\nEvaluating this expression with $Pr_2 = 7.0$:\n$$\n\\frac{C_2}{C_1} = ( (7.0)^{1/2} )^4 = (7.0)^{4/2} = (7.0)^2 = 49\n$$\nThe computational cost increases by a factor of $49$. It is important to note that the cost for the $Pr_1 = 0.7$ case is dictated by the Kolmogorov scale of the velocity field, while the significantly higher cost for the $Pr_2 = 7.0$ case is dictated by the much smaller Batchelor scale of the temperature field. The problem assumptions correctly guide this analysis.", "answer": "$$\\boxed{49}$$", "id": "2477540"}, {"introduction": "After developing a DNS code, you must rigorously verify that it correctly solves the governing equations to its designed order of accuracy. The Method of Manufactured Solutions (MMS) is a powerful and standard technique for this purpose, where a chosen analytical solution is substituted into the governing PDE to derive a corresponding source term. This analytical exercise walks you through the derivation of such a source term, an indispensable procedure for building confidence in a numerical solver before using it for scientific discovery [@problem_id:2477527].", "problem": "In a triply periodic box, the temperature field of an incompressible fluid is governed by the advection–diffusion equation. Consider Direct Numerical Simulation (DNS) for verifying the discrete accuracy of a scalar transport solver using the Method of Manufactured Solutions (MMS). Begin from the local conservation of thermal energy and Fourier’s law of heat conduction for a passive scalar in an incompressible flow. Use these fundamentals to obtain the governing partial differential equation for a nondimensional temperature field $T(x,y,z,t)$ with a constant thermal diffusivity $\\alpha$ and a divergence-free velocity field $\\boldsymbol{u}(x,y,z)$. The domain is $\\Omega=[0,2\\pi]^{3}$ with periodic boundary conditions on all faces.\n\nLet the incompressible velocity be\n$$\n\\boldsymbol{u}(x,y,z)=\\bigl(2\\sin x\\,\\cos y\\,\\cos z,\\,-2\\cos x\\,\\sin y\\,\\cos z,\\,0\\bigr),\n$$\nand let the manufactured temperature be\n$$\nT(x,y,z,t)=\\cos(3x)\\,\\cos(2y)\\,\\cos(z)\\,\\exp(\\sigma t),\n$$\nwhere $\\sigma$ is a nonzero constant and $\\alpha0$ is constant. Using the Method of Manufactured Solutions (MMS), derive the spatiotemporal source term $S(x,y,z,t)$ that must be added to the right-hand side of the advection–diffusion equation so that $T(x,y,z,t)$ is an exact solution in $\\Omega$ for all $t\\ge 0$. State the corresponding initial condition and boundary conditions implied by this construction, and justify each modeling step from the conservation law and constitutive relation. Your final reported result must be the explicit closed-form analytic expression for $S(x,y,z,t)$. No numerical rounding is required. Express your final answer as a single analytic expression.", "solution": "The problem is subjected to validation and is found to be scientifically sound, well-posed, objective, and self-contained. The provided velocity field is verifiably divergence-free, confirming the incompressibility condition. The problem is a standard application of the Method of Manufactured Solutions (MMS) in computational fluid dynamics and is therefore valid.\n\nThe solution proceeds by first principles. The conservation of thermal energy for a passive scalar in an incompressible fluid is governed by the advection-diffusion equation. We derive this equation from the integral conservation law for thermal energy in an arbitrary control volume $V$ with surface $\\partial V$:\n$$ \\frac{d}{dt}\\int_{V} \\rho c_p T \\,dV = -\\oint_{\\partial V} \\boldsymbol{q} \\cdot d\\boldsymbol{A} - \\oint_{\\partial V} \\rho c_p T \\boldsymbol{u} \\cdot d\\boldsymbol{A} + \\int_{V} S_{v} \\,dV $$\nHere, $\\rho$ is the fluid density, $c_p$ is the specific heat capacity at constant pressure, $T$ is the temperature, $\\boldsymbol{q}$ is the heat flux vector, $\\boldsymbol{u}$ is the velocity field, and $S_v$ is a volumetric heat source. Using the divergence theorem and recognizing that the resulting equation must hold for any arbitrary $V$, we obtain the local differential form:\n$$ \\frac{\\partial}{\\partial t}(\\rho c_p T) + \\nabla \\cdot (\\rho c_p T \\boldsymbol{u}) = -\\nabla \\cdot \\boldsymbol{q} + S_v $$\nFor constant $\\rho$ and $c_p$, this simplifies to:\n$$ \\rho c_p \\left( \\frac{\\partial T}{\\partial t} + \\nabla \\cdot (T \\boldsymbol{u}) \\right) = -\\nabla \\cdot \\boldsymbol{q} + S_v $$\nUsing the vector identity $\\nabla \\cdot (T \\boldsymbol{u}) = T(\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{u} \\cdot \\nabla T$ and the incompressibility condition $\\nabla \\cdot \\boldsymbol{u} = 0$, the advection term becomes $\\boldsymbol{u} \\cdot \\nabla T$.\nThe constitutive relation for heat conduction is Fourier's law, $\\boldsymbol{q} = -k \\nabla T$, where $k$ is the thermal conductivity. Assuming $k$ is constant, we have $-\\nabla \\cdot \\boldsymbol{q} = \\nabla \\cdot (k \\nabla T) = k \\nabla^2 T$.\nSubstituting these into the conservation equation gives:\n$$ \\rho c_p \\left( \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T \\right) = k \\nabla^2 T + S_v $$\nDividing by $\\rho c_p$ and defining the thermal diffusivity $\\alpha = k/(\\rho c_p)$ and the normalized source term $S(x,y,z,t) = S_v/(\\rho c_p)$ yields the standard advection-diffusion equation:\n$$ \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T = \\alpha \\nabla^2 T + S $$\nFor the Method of Manufactured Solutions, we rearrange this equation to define the source term $S$ that must be added to force the manufactured temperature field to be an exact solution:\n$$ S(x,y,z,t) = \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T - \\alpha \\nabla^2 T $$\nWe are given the manufactured solution $T(x,y,z,t) = \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t)$ and the velocity field $\\boldsymbol{u}(x,y,z)=\\bigl(2\\sin x\\,\\cos y\\,\\cos z,\\,-2\\cos x\\,\\sin y\\,\\cos z,\\,0\\bigr)$. We now compute each term in the expression for $S$.\n\n$1$. Temporal derivative, $\\frac{\\partial T}{\\partial t}$:\n$$ \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = \\sigma \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) = \\sigma T $$\n\n$2$. Laplacian, $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} + \\frac{\\partial^2 T}{\\partial z^2}$:\n$$ \\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = -3^2 T = -9T $$\n$$ \\frac{\\partial^2 T}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = -2^2 T = -4T $$\n$$ \\frac{\\partial^2 T}{\\partial z^2} = \\frac{\\partial^2}{\\partial z^2} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = -1^2 T = -T $$\nThus, the Laplacian is:\n$$ \\nabla^2 T = (-9 - 4 - 1)T = -14T = -14\\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) $$\n\n$3$. Advection term, $\\boldsymbol{u} \\cdot \\nabla T$:\nFirst, we find the gradient of $T$, $\\nabla T = \\left(\\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y}, \\frac{\\partial T}{\\partial z}\\right)$:\n$$ \\frac{\\partial T}{\\partial x} = -3\\sin(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) $$\n$$ \\frac{\\partial T}{\\partial y} = -2\\cos(3x)\\sin(2y)\\cos(z)\\exp(\\sigma t) $$\n$$ \\frac{\\partial T}{\\partial z} = -\\cos(3x)\\cos(2y)\\sin(z)\\exp(\\sigma t) $$\nNow, we compute the dot product $\\boldsymbol{u} \\cdot \\nabla T = u_x \\frac{\\partial T}{\\partial x} + u_y \\frac{\\partial T}{\\partial y} + u_z \\frac{\\partial T}{\\partial z}$:\n$$ u_x \\frac{\\partial T}{\\partial x} = (2\\sin x\\,\\cos y\\,\\cos z) \\cdot (-3\\sin(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t)) \\\\ = -6 \\exp(\\sigma t) \\sin x \\sin(3x) \\cos y \\cos(2y) \\cos^2(z) $$\n$$ u_y \\frac{\\partial T}{\\partial y} = (-2\\cos x\\,\\sin y\\,\\cos z) \\cdot (-2\\cos(3x)\\sin(2y)\\cos(z)\\exp(\\sigma t)) \\\\ = 4 \\exp(\\sigma t) \\cos x \\cos(3x) \\sin y \\sin(2y) \\cos^2(z) $$\n$$ u_z \\frac{\\partial T}{\\partial z} = 0 $$\nSumming these gives the advection term:\n$$ \\boldsymbol{u} \\cdot \\nabla T = \\exp(\\sigma t) \\cos^2(z) \\left[ -6 \\sin x \\sin(3x) \\cos y \\cos(2y) + 4 \\cos x \\cos(3x) \\sin y \\sin(2y) \\right] $$\n\n$4$. Assemble the source term $S(x,y,z,t)$:\nSubstituting the computed terms into the expression for $S$:\n$$ S = \\sigma T + \\boldsymbol{u} \\cdot \\nabla T - \\alpha(-14T) = (\\sigma + 14\\alpha)T + \\boldsymbol{u} \\cdot \\nabla T $$\n$$ S(x,y,z,t) = (\\sigma + 14\\alpha)\\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) + \\exp(\\sigma t) \\cos^2(z) \\left[ -6 \\sin x \\sin(3x) \\cos y \\cos(2y) + 4 \\cos x \\cos(3x) \\sin y \\sin(2y) \\right] $$\nFactoring out $\\exp(\\sigma t)$ yields the final expression for the source term:\n$$ S(x,y,z,t) = \\exp(\\sigma t) \\left( (\\sigma + 14\\alpha)\\cos(3x)\\cos(2y)\\cos(z) + \\cos^2(z) \\left[ 4 \\cos x \\cos(3x) \\sin y \\sin(2y) - 6 \\sin x \\sin(3x) \\cos y \\cos(2y) \\right] \\right) $$\n\nThe initial condition, evaluated at $t=0$, is derived directly from the manufactured solution:\n$$ T(x,y,z,0) = \\cos(3x)\\cos(2y)\\cos(z) $$\nThe boundary conditions for the domain $\\Omega=[0,2\\pi]^{3}$ are periodic. The manufactured solution $T(x,y,z,t)$ and the velocity field $\\boldsymbol{u}(x,y,z)$ are composed of trigonometric functions whose arguments are integer multiples of the spatial coordinates. These functions are inherently periodic on the domain $[0,2\\pi]^{3}$ (e.g., $\\cos(3(x+2\\pi)) = \\cos(3x+6\\pi) = \\cos(3x)$). Therefore, the manufactured solution inherently satisfies the periodic boundary conditions.\nAll modeling steps are justified, starting from the fundamental conservation law and leading to the required source term. The final result for $S(x,y,z,t)$ is the explicit analytic expression derived above.", "answer": "$$ \\boxed{\\exp(\\sigma t) \\left( (\\sigma + 14\\alpha)\\cos(3x)\\cos(2y)\\cos(z) + \\cos^2(z) \\left[ 4 \\cos(x) \\cos(3x) \\sin(y) \\sin(2y) - 6 \\sin(x) \\sin(3x) \\cos(y) \\cos(2y) \\right] \\right)} $$", "id": "2477527"}, {"introduction": "The choice of numerical scheme is critical for obtaining physically meaningful results, especially when simulating phenomena with sharp gradients like thermal fronts or shocks. This hands-on coding exercise contrasts a classic second-order linear scheme (Lax-Wendroff) with a modern high-resolution, non-linear scheme (MUSCL with a TVD limiter). By implementing and comparing these methods, you will gain a practical understanding of how different numerical philosophies handle discontinuities and why specialized methods are essential for preventing the spurious, non-physical oscillations that can corrupt a simulation [@problem_id:2477612].", "problem": "Write a program that performs a Direct Numerical Simulation (DNS) of one-dimensional, constant-velocity thermal advection to compare the behavior of a central scheme versus a flux-limited scheme in the presence of a sharp thermal front. The governing conservation law is the linear advection equation\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = 0,\n$$\non a periodic domain of length $L$, with $x \\in [0,L)$, advecting a nondimensional temperature field $T(x,t)$. The advection speed $a$ is constant and positive, and the initial condition is a Riemann problem (sharp front) given by\n$$\nT(x,0) = \\begin{cases}\nT_{\\mathrm{L}},  0 \\le x  x_0,\\\\\nT_{\\mathrm{R}},  x_0 \\le x  L,\n\\end{cases}\n$$\nwith $T_{\\mathrm{L}}=1$, $T_{\\mathrm{R}}=0$, $L=1$, $x_0 = 0.5$, and $a=1$. Simulate up to a final time $t_{\\mathrm{end}}=0.2$.\n\nUse a finite-volume semi-discrete update,\n$$\nT_i^{n+1} = T_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right),\n$$\nfor two different numerical fluxes:\n- Central scheme: Use the Lax–Wendroff flux for linear advection,\n$$\nF_{i+1/2}^n = a\\left[\\frac{T_i^n + T_{i+1}^n}{2} - \\frac{a \\Delta t}{2 \\Delta x}\\left(T_{i+1}^n - T_i^n\\right)\\right].\n$$\n- Flux-limited scheme: Use a Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) reconstruction with the van Leer Total Variation Diminishing (TVD) limiter. For positive $a$, compute limited slopes via\n$$\nr_i = \\frac{T_i - T_{i-1}}{T_{i+1} - T_i}, \\quad\n\\phi(r) = \\frac{r + |r|}{1 + |r|},\n$$\nwith the convention that if the denominator is $0$ then $r=0$. Reconstruct the left state at face $i+\\tfrac{1}{2}$ as\n$$\nT_{i+1/2}^{L} = T_i + \\frac{1}{2}\\,\\phi(r_i)\\,(T_{i+1} - T_i),\n$$\nand take the upwind Godunov flux\n$$\nF_{i+1/2} = a\\,T_{i+1/2}^{L}.\n$$\nAdvance this flux with the second-order Strong Stability Preserving Runge–Kutta (SSP-RK2) method:\n$$\nT^{(1)} = T^n - \\frac{\\Delta t}{\\Delta x}\\nabla\\cdot F(T^n), \\quad\nT^{n+1} = \\frac{1}{2} T^n + \\frac{1}{2}\\left[T^{(1)} - \\frac{\\Delta t}{\\Delta x}\\nabla\\cdot F(T^{(1)})\\right].\n$$\n\nDiscretize the domain using $N$ uniform finite volumes with centers at $x_i$ and width $\\Delta x = L/N$. Impose periodic boundary conditions. Choose the time step by the Courant–Friedrichs–Lewy (CFL) condition with a Courant number $\\mathrm{CFL}=0.8$, i.e.,\n$$\n\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{a},\n$$\nand use a constant $\\Delta t$ set by rounding up the number of steps to reach $t_{\\mathrm{end}}$ and then resetting $\\Delta t = t_{\\mathrm{end}}/N_t$ to hit $t_{\\mathrm{end}}$ exactly.\n\nDefine the $L_\\infty$ norm of the overshoot at time $t_{\\mathrm{end}}$ as the maximum violation of the physical bounds $[T_{\\min},T_{\\max}] = [0,1]$:\n$$\n\\| \\text{overshoot} \\|_\\infty = \\max\\left(0, \\max_i(T_i - T_{\\max}), \\max_i(T_{\\min} - T_i)\\right).\n$$\nThis quantity is dimensionless.\n\nTest Suite:\n- Use $N \\in \\{32, 64, 128, 256\\}$ with $L=1$, $a=1$, $x_0=0.5$, $T_{\\mathrm{L}}=1$, $T_{\\mathrm{R}}=0$, $\\mathrm{CFL}=0.8$, and $t_{\\mathrm{end}}=0.2$.\n- For each $N$, compute two floats: the $L_\\infty$ overshoot for the central Lax–Wendroff scheme and the $L_\\infty$ overshoot for the flux-limited MUSCL–van Leer scheme at $t_{\\mathrm{end}}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\text{LW}(32), \\text{MUSCL}(32), \\text{LW}(64), \\text{MUSCL}(64), \\text{LW}(128), \\text{MUSCL}(128), \\text{LW}(256), \\text{MUSCL}(256)],\n$$\nwhere each entry is a float rounded to six decimal places. No other text should be printed.", "solution": "The problem presented is a valid and well-posed numerical exercise in the field of computational heat and mass transfer. It requires the implementation and comparison of two distinct numerical schemes for solving the one-dimensional linear advection equation, a cornerstone of transport phenomena. The task is to simulate the advection of a sharp thermal front, or Riemann problem, and to quantify the non-physical oscillations (overshoots) generated by each scheme. The problem is scientifically grounded, internally consistent, and all parameters are provided for a complete and unambiguous implementation.\n\nThe governing partial differential equation (PDE) for this system is the linear advection equation for a nondimensional temperature field $T(x,t)$:\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = 0\n$$\nwhere $a$ is the constant, positive advection speed. The spatial domain is $x \\in [0,L)$ with periodic boundary conditions. The initial condition is a step function, which presents a significant challenge for numerical schemes due to its infinite gradient.\n\nWe will use a finite-volume method, which discretizes the domain into $N$ cells of width $\\Delta x = L/N$. The temperature in each cell $i$, denoted $T_i$, represents the cell-averaged value. The semi-discrete form of the governing equation is an ordinary differential equation (ODE) for each cell average:\n$$\n\\frac{dT_i}{dt} = -\\frac{1}{\\Delta x}\\left(F_{i+1/2} - F_{i-1/2}\\right)\n$$\nHere, $F_{i+1/2}$ is the numerical flux of $T$ across the interface between cell $i$ and cell $i+1$. The core of the problem lies in the definition of this flux for two different schemes.\n\n**1. Central Scheme: Lax–Wendroff**\n\nThe Lax–Wendroff scheme is a classic method that is second-order accurate in both space and time. It achieves this by including terms from a Taylor series expansion in time. For linear advection, this results in a single-step time update using a specially constructed flux. The problem provides this flux directly:\n$$\nF_{i+1/2}^n = a\\left[\\frac{T_i^n + T_{i+1}^n}{2} - \\frac{a \\Delta t}{2 \\Delta x}\\left(T_{i+1}^n - T_i^n\\right)\\right]\n$$\nThe first term, $a(T_i^n + T_{i+1}^n)/2$, is a simple central-differencing flux, which is second-order in space but is known to be unstable. The second term, proportional to the Courant number $\\nu = a \\Delta t / \\Delta x$, is a numerical diffusion term that stabilizes the scheme and elevates the temporal accuracy to second order. While accurate for smooth solutions, the Lax–Wendroff scheme is known to produce spurious, non-physical oscillations (Gibbs phenomenon) near sharp gradients or discontinuities, which we expect to observe as a significant overshoot.\n\n**2. Flux-Limited Scheme: MUSCL with van Leer Limiter**\n\nTo overcome the oscillatory behavior of high-order linear schemes like Lax–Wendroff, non-linear Total Variation Diminishing (TVD) schemes were developed. The Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) is a prominent example. The key idea is to use a high-order reconstruction of the solution within each cell and then \"limit\" the gradients of this reconstruction near discontinuities to prevent oscillations. This procedure involves three main steps:\n\n*   **Reconstruction**: A piecewise-linear representation of the data is reconstructed within each cell $i$, using a slope derived from neighboring cell averages. The quality of this reconstruction determines the accuracy.\n*   **Limiting**: The reconstructed slope is multiplied by a limiter function $\\phi(r)$, which depends on the ratio $r_i$ of consecutive gradients: $r_i = (T_i - T_{i-1}) / (T_{i+1} - T_i)$. The limiter reduces the slope (and thus the order of the scheme, locally to first-order) in regions of high variation to prevent the formation of new extrema. The problem specifies the van Leer limiter:\n    $$\n    \\phi(r) = \\frac{r + |r|}{1 + |r|}\n    $$\n    This limiter is smooth and provides second-order accuracy in smooth regions of the flow while ensuring monotonicity. The reconstructed temperature value at the left side of the interface $i+1/2$ is then:\n    $$\n    T_{i+1/2}^{L} = T_i + \\frac{1}{2}\\,\\phi(r_i)\\,(T_{i+1} - T_i)\n    $$\n*   **Flux-Update**: The flux at the interface is calculated using the reconstructed values. For positive advection speed $a  0$, the information flows from left to right, so an upwind or Godunov flux is simply:\n    $$\n    F_{i+1/2} = a\\,T_{i+1/2}^{L}\n    $$\n*   **Time Integration**: To maintain the TVD property and achieve second-order accuracy in time, a suitable multi-stage time-stepping method is required. The problem specifies the second-order Strong Stability Preserving Runge–Kutta (SSP-RK2) method:\n    $$\n    \\begin{align*}\n    T^{(1)} = T^n - \\frac{\\Delta t}{\\Delta x}\\left( F(T^n)_{i+1/2} - F(T^n)_{i-1/2} \\right) \\\\\n    T^{n+1} = \\frac{1}{2} T^n + \\frac{1}{2}\\left[T^{(1)} - \\frac{\\Delta t}{\\Delta x}\\left( F(T^{(1)})_{i+1/2} - F(T^{(1)})_{i-1/2} \\right) \\right]\n    \\end{align*}\n    $$\nThis combination of MUSCL reconstruction, van Leer limiting, and SSP-RK2 integration is designed to produce a sharp, non-oscillatory resolution of the advected front.\n\n**Implementation and Analysis**\n\nThe simulation will be carried out on a uniform grid with periodic boundary conditions, which are handled computationally by wrapping array indices (e.g., using `numpy.roll`). The initial condition, a step function, is discretized by computing the cell-average over each finite volume, which provides a more accurate representation than simple point-wise sampling. The time step $\\Delta t$ is determined from the Courant–Friedrichs–Lewy (CFL) condition with a Courant number of $0.8$ and adjusted to ensure the simulation concludes precisely at $t_{\\mathrm{end}}$.\n\nThe primary metric for comparison is the $L_\\infty$ norm of the overshoot, which measures the maximum deviation of the numerical solution outside the physically expected range $[T_{\\min}, T_{\\max}] = [0, 1]$. We anticipate that the Lax–Wendroff scheme will exhibit significant overshoot that decreases with grid refinement, while the MUSCL/van Leer scheme will show little to no overshoot, demonstrating its TVD property.", "answer": "```python\nimport numpy as np\nimport math\n\ndef setup_grid_and_ic(N, L, x0, TL, TR):\n    \"\"\"\n    Sets up the grid and initial condition using cell-averaging.\n    \"\"\"\n    dx = L / N\n    # Cell centers\n    x = np.linspace(dx / 2, L - dx / 2, N)\n    \n    T0 = np.zeros(N)\n    \n    # Cell boundaries\n    x_faces = np.linspace(0, L, N + 1)\n    \n    for i in range(N):\n        x_left = x_faces[i]\n        x_right = x_faces[i+1]\n        \n        # Portion of the cell to the left of x0\n        overlap_left = max(0, min(x_right, x0) - x_left)\n        # Portion of the cell to the right of or at x0\n        overlap_right = max(0, x_right - max(x_left, x0))\n        \n        T0[i] = (overlap_left * TL + overlap_right * TR) / dx\n        \n    return x, dx, T0\n\ndef calculate_overshoot(T, T_min, T_max):\n    \"\"\"\n    Calculates the L-infinity norm of the overshoot.\n    \"\"\"\n    overshoot = np.max([0.0, np.max(T) - T_max, T_min - np.min(T)])\n    return overshoot\n\ndef run_lax_wendroff(T0, N, L, a, cfl, t_end):\n    \"\"\"\n    Solves the 1D linear advection equation using the Lax-Wendroff scheme.\n    \"\"\"\n    dx = L / N\n    \n    # Calculate stable time step\n    dt_cfl = cfl * dx / a\n    num_steps = math.ceil(t_end / dt_cfl)\n    dt = t_end / num_steps\n    \n    T = T0.copy()\n    nu = a * dt / dx # Courant number\n\n    for _ in range(num_steps):\n        T_ip1 = np.roll(T, -1)\n        \n        # Lax-Wendroff flux F_{i+1/2}\n        flux_face = a * (0.5 * (T + T_ip1) - 0.5 * nu * (T_ip1 - T))\n        \n        flux_face_im1 = np.roll(flux_face, 1)\n        \n        # Finite volume update\n        T = T - (dt / dx) * (flux_face - flux_face_im1)\n        \n    return T\n\ndef calculate_rhs_muscl(T, dx, a):\n    \"\"\"Calculates the right-hand-side for the MUSCL scheme.\"\"\"\n    # Periodic boundary conditions via numpy.roll\n    T_im1 = np.roll(T, 1)\n    T_ip1 = np.roll(T, -1)\n    \n    # Slope ratio r_i = (T_i - T_{i-1}) / (T_{i+1} - T_i)\n    numerator = T - T_im1\n    denominator = T_ip1 - T\n    \n    r = np.zeros_like(T)\n    # Avoid division by zero\n    mask = np.abs(denominator)  1e-12\n    r[mask] = numerator[mask] / denominator[mask]\n    \n    # van Leer limiter: phi(r) = (r + |r|) / (1 + |r|)\n    phi = (r + np.abs(r)) / (1.0 + np.abs(r))\n    \n    # Reconstructed left state at face i+1/2\n    T_L_face = T + 0.5 * phi * (T_ip1 - T)\n    \n    # Godunov flux for a  0\n    F_face = a * T_L_face\n    \n    # Flux at face i-1/2\n    F_face_im1 = np.roll(F_face, 1)\n    \n    # RHS = -1/dx * (F_{i+1/2} - F_{i-1/2})\n    rhs = -(F_face - F_face_im1) / dx\n    return rhs\n\ndef run_muscl_vanleer(T0, N, L, a, cfl, t_end):\n    \"\"\"\n    Solves the 1D linear advection equation using the MUSCL-vanLeer TVD scheme\n    with SSP-RK2 time integration.\n    \"\"\"\n    dx = L / N\n\n    # Calculate stable time step\n    dt_cfl = cfl * dx / a\n    num_steps = math.ceil(t_end / dt_cfl)\n    dt = t_end / num_steps\n\n    T = T0.copy()\n\n    for _ in range(num_steps):\n        # SSP-RK2 Stage 1\n        rhs1 = calculate_rhs_muscl(T, dx, a)\n        T1 = T + dt * rhs1\n        \n        # SSP-RK2 Stage 2\n        rhs2 = calculate_rhs_muscl(T1, dx, a)\n        T = 0.5 * T + 0.5 * (T1 + dt * rhs2)\n        \n    return T\n\ndef solve():\n    \"\"\"\n    Main solver function to run simulations and print results.\n    \"\"\"\n    # Problem parameters\n    L = 1.0\n    a = 1.0\n    x0 = 0.5\n    TL = 1.0\n    TR = 0.0\n    cfl = 0.8\n    t_end = 0.2\n    T_min, T_max = 0.0, 1.0\n\n    # Test cases for N\n    N_values = [32, 64, 128, 256]\n    \n    results = []\n\n    for N in N_values:\n        _x, dx, T0 = setup_grid_and_ic(N, L, x0, TL, TR)\n        \n        # Run Lax-Wendroff simulation\n        T_lw = run_lax_wendroff(T0, N, L, a, cfl, t_end)\n        overshoot_lw = calculate_overshoot(T_lw, T_min, T_max)\n        results.append(round(overshoot_lw, 6))\n        \n        # Run MUSCL-vanLeer simulation\n        T_muscl = run_muscl_vanleer(T0, N, L, a, cfl, t_end)\n        overshoot_muscl = calculate_overshoot(T_muscl, T_min, T_max)\n        results.append(round(overshoot_muscl, 6))\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2477612"}]}