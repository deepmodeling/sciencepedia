{"hands_on_practices": [{"introduction": "To accurately analyze thermal systems, we must often move beyond the simplifying assumption of constant specific heats. This practice focuses on the direct consequences of temperature-dependent specific heat, $c_p(T)$, for a gas undergoing a constant-pressure heating process. You will apply the first law of thermodynamics and the definition of enthalpy, requiring calculus to determine the exact heat transfer and compare it against a common engineering approximation [@problem_id:2532138]. This exercise is fundamental for building an intuition for when simplified models are acceptable and when more rigorous integration is necessary.", "problem": "A rigidly guided, frictionless piston confines a fixed mass of a well-stirred dry air surrogate that may be modeled as an ideal gas of fixed composition. A calibrated dead-weight maintains a constant external pressure so that the piston executes a quasi-equilibrium constant-pressure process as heat is supplied to the gas. The gas is heated from an initial temperature $T_1 = 300\\,\\mathrm{K}$ to a final temperature $T_2 = 1200\\,\\mathrm{K}$. The mass of gas is $m = 2.50\\,\\mathrm{kg}$, and changes in kinetic and potential energies are negligible. The only work mode is boundary (pressure-volume) work. The pressure is maintained at $p = 1.00\\,\\mathrm{bar}$.\n\nOver the temperature interval $[T_1,T_2]$, the specific heat at constant pressure (specific heat capacity), denoted $c_p(T)$, is represented by the correlation\n$$\nc_p(T) = 0.95 + 1.50 \\times 10^{-4}\\,T - 2.00 \\times 10^{-8}\\,T^2 \\quad \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1},\n$$\nwith $T$ in $\\mathrm{K}$.\n\nStarting from the first law of thermodynamics for a closed system with only boundary work and from the definition of specific enthalpy $h$ and specific heat at constant pressure $c_p(T)$, do the following:\n\n1. Derive the appropriate relationship between the net heat transfer to the system during this constant-pressure process and the temperature-dependent specific heat $c_p(T)$.\n2. Using that relationship, determine the exact heat input required. Then construct an engineering approximation by replacing $c_p(T)$ with a constant endpoint-averaged value $\\bar{c}_p = \\big(c_p(T_1) + c_p(T_2)\\big)/2$, and compute the corresponding approximate heat input.\n3. Define the fractional error of this approximation as\n$$\n\\varepsilon \\equiv \\frac{Q_{\\mathrm{avg}} - Q_{\\mathrm{exact}}}{Q_{\\mathrm{exact}}},\n$$\nwhere $Q_{\\mathrm{avg}}$ is the approximate heat input based on the endpoint-averaged specific heat and $Q_{\\mathrm{exact}}$ is the exact heat input based on the temperature-dependent specific heat.\n\nReport only the value of $\\varepsilon$ as your final answer, rounded to four significant figures, expressed as a pure decimal (do not use a percent sign). If you need to express energies in intermediate steps, use $\\mathrm{kJ}$.", "solution": "The problem is first validated.\n**Givens:**\n- System: Fixed mass of an ideal gas.\n- Process: Quasi-equilibrium, constant-pressure.\n- System Type: Closed.\n- Initial Temperature: $T_1 = 300\\,\\mathrm{K}$\n- Final Temperature: $T_2 = 1200\\,\\mathrm{K}$\n- Mass: $m = 2.50\\,\\mathrm{kg}$\n- Pressure: $p = 1.00\\,\\mathrm{bar}$ (constant)\n- Work: Only boundary (pressure-volume) work.\n- Energy: Negligible changes in kinetic and potential energies.\n- Specific heat capacity correlation: $c_p(T) = 0.95 + 1.50 \\times 10^{-4}\\,T - 2.00 \\times 10^{-8}\\,T^2$, in units of $\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ with $T$ in $\\mathrm{K}$.\n- Approximation definition: $\\bar{c}_p = \\frac{c_p(T_1) + c_p(T_2)}{2}$.\n- Fractional error definition: $\\varepsilon \\equiv \\frac{Q_{\\mathrm{avg}} - Q_{\\mathrm{exact}}}{Q_{\\mathrm{exact}}}$.\n\n**Validation:**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard thermodynamics problem involving the first law for a closed system and temperature-dependent specific heat. All necessary data are provided, and the constraints are consistent. No scientific principles are violated. The problem is deemed **valid**.\n\n**Solution Derivation:**\n\n**1. Derivation of the Heat Transfer Relationship**\n\nThe first law of thermodynamics for a closed system undergoing a process from state $1$ to state $2$ is given by:\n$$ \\Delta E = Q - W $$\nwhere $\\Delta E$ is the change in the total energy of the system, $Q$ is the net heat transfer to the system, and $W$ is the net work done by the system. The total energy $E$ is the sum of internal energy $U$, kinetic energy $KE$, and potential energy $PE$. The problem states that changes in kinetic and potential energies are negligible, so $\\Delta E = \\Delta U$. The only work mode is boundary work, so for a quasi-equilibrium process, the differential work is $dW = p\\,dV$. The first law in differential form is:\n$$ dQ = dU + p\\,dV $$\nThe definition of specific enthalpy is $h = u + pv$, where $u$ is specific internal energy and $v$ is specific volume. The total enthalpy is $H = U + pV$. Taking the differential of $H$ gives:\n$$ dH = dU + d(pV) = dU + p\\,dV + V\\,dp $$\nFor a constant-pressure process, $dp = 0$, so the above expression simplifies to:\n$$ dH = dU + p\\,dV \\quad (\\text{for } p=\\text{const}) $$\nSubstituting this into the differential form of the first law, we find that for a constant-pressure process:\n$$ dQ = dH $$\nThe total heat transfer $Q$ during the process from state $1$ to state $2$ is the integral of $dQ$, which equals the total change in enthalpy:\n$$ Q = \\int_1^2 dQ = \\int_1^2 dH = H_2 - H_1 = \\Delta H $$\nSince $H = mh$, the heat transfer is $Q = m(h_2 - h_1) = m \\Delta h$.\n\nThe specific heat at constant pressure, $c_p$, is defined as $c_p = \\left(\\frac{\\partial h}{\\partial T}\\right)_p$. For an ideal gas, enthalpy is a function of temperature only, $h=h(T)$, so the partial derivative becomes an ordinary derivative: $c_p(T) = \\frac{dh}{dT}$.\nFrom this definition, the differential change in specific enthalpy is $dh = c_p(T)\\,dT$.\nTo find the total change in specific enthalpy, we integrate from the initial temperature $T_1$ to the final temperature $T_2$:\n$$ \\Delta h = h_2 - h_1 = \\int_{T_1}^{T_2} c_p(T)\\,dT $$\nSubstituting this into the expression for the total heat transfer, we arrive at the required relationship for the exact heat input, $Q_{\\mathrm{exact}}$:\n$$ Q_{\\mathrm{exact}} = m \\int_{T_1}^{T_2} c_p(T)\\,dT $$\n\n**2. Calculation of Exact and Approximate Heat Input**\n\nThe given correlation for specific heat is a polynomial in temperature:\n$$ c_p(T) = A + BT + CT^2 $$\nwhere $A = 0.95 \\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, $B = 1.50 \\times 10^{-4} \\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$, and $C = -2.00 \\times 10^{-8} \\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$.\n\nTo find $Q_{\\mathrm{exact}}$, we integrate this expression from $T_1 = 300\\,\\mathrm{K}$ to $T_2 = 1200\\,\\mathrm{K}$:\n$$ Q_{\\mathrm{exact}} = m \\int_{T_1}^{T_2} (A + BT + CT^2) \\,dT = m \\left[ AT + \\frac{B}{2}T^2 + \\frac{C}{3}T^3 \\right]_{T_1}^{T_2} $$\n$$ Q_{\\mathrm{exact}} = m \\left( A(T_2 - T_1) + \\frac{B}{2}(T_2^2 - T_1^2) + \\frac{C}{3}(T_2^3 - T_1^3) \\right) $$\nSubstituting the numerical values:\n$T_2 - T_1 = 1200 - 300 = 900\\,\\mathrm{K}$\n$T_2^2 - T_1^2 = (1200)^2 - (300)^2 = 1.35 \\times 10^6\\,\\mathrm{K}^2$\n$T_2^3 - T_1^3 = (1200)^3 - (300)^3 = 1.701 \\times 10^9\\,\\mathrm{K}^3$\n$m = 2.50\\,\\mathrm{kg}$\n$$ Q_{\\mathrm{exact}} = 2.50 \\left( (0.95)(900) + \\frac{1.50 \\times 10^{-4}}{2}(1.35 \\times 10^6) + \\frac{-2.00 \\times 10^{-8}}{3}(1.701 \\times 10^9) \\right) $$\n$$ Q_{\\mathrm{exact}} = 2.50 \\left( 855 + (7.5 \\times 10^{-5})(1.35 \\times 10^6) - \\frac{2.00}{3}(1.701 \\times 10) \\right) $$\n$$ Q_{\\mathrm{exact}} = 2.50 \\left( 855 + 101.25 - 11.34 \\right) = 2.50(944.91) = 2362.275\\,\\mathrm{kJ} $$\n\nNext, we calculate the approximate heat input, $Q_{\\mathrm{avg}}$, using the endpoint-averaged specific heat $\\bar{c}_p$.\n$$ Q_{\\mathrm{avg}} = m \\bar{c}_p (T_2-T_1), \\quad \\text{where } \\bar{c}_p = \\frac{c_p(T_1) + c_p(T_2)}{2} $$\nFirst, evaluate $c_p(T)$ at the endpoints:\n$$ c_p(T_1) = c_p(300) = 0.95 + (1.50 \\times 10^{-4})(300) - (2.00 \\times 10^{-8})(300)^2 $$\n$$ c_p(300) = 0.95 + 0.045 - 0.0018 = 0.9932\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\n$$ c_p(T_2) = c_p(1200) = 0.95 + (1.50 \\times 10^{-4})(1200) - (2.00 \\times 10^{-8})(1200)^2 $$\n$$ c_p(1200) = 0.95 + 0.18 - 0.0288 = 1.1012\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\nNow, calculate the average specific heat:\n$$ \\bar{c}_p = \\frac{0.9932 + 1.1012}{2} = \\frac{2.0944}{2} = 1.0472\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} $$\nFinally, compute $Q_{\\mathrm{avg}}$:\n$$ Q_{\\mathrm{avg}} = (2.50\\,\\mathrm{kg}) (1.0472\\,\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}) (1200 - 300\\,\\mathrm{K}) $$\n$$ Q_{\\mathrm{avg}} = 2.50 \\times 1.0472 \\times 900 = 2356.2\\,\\mathrm{kJ} $$\n\n**3. Calculation of Fractional Error**\n\nThe fractional error $\\varepsilon$ is defined as:\n$$ \\varepsilon = \\frac{Q_{\\mathrm{avg}} - Q_{\\mathrm{exact}}}{Q_{\\mathrm{exact}}} $$\nSubstituting the calculated values for $Q_{\\mathrm{avg}}$ and $Q_{\\mathrm{exact}}$:\n$$ \\varepsilon = \\frac{2356.2 - 2362.275}{2362.275} = \\frac{-6.075}{2362.275} $$\n$$ \\varepsilon \\approx -0.00257163 $$\nThe problem requires the value of $\\varepsilon$ rounded to four significant figures.\n$$ \\varepsilon \\approx -0.002572 $$", "answer": "$$\\boxed{-0.002572}$$", "id": "2532138"}, {"introduction": "Building on the integration of $c_p(T)$, this exercise addresses a practical engineering question: how much error do we introduce by choosing a simplified gas model? You will compare the heat transfer required in a high-temperature process using two different models: a simple calorically perfect gas model with constant $c_p$, and a more realistic thermally perfect gas model where $c_p(T)$ is defined by tabulated data [@problem_id:2532089]. This hands-on comparison highlights the critical importance of model selection in engineering design, especially in fields like propulsion and power generation where large temperature variations are common.", "problem": "A steady-flow, constant-pressure gas heater raises a stream of dry air from an inlet temperature of $T_{1} = 300\\,\\mathrm{K}$ to an outlet temperature of $T_{2} = 2000\\,\\mathrm{K}$. Neglect changes in kinetic and potential energies and treat air as an ideal gas. Two predictions of the required heat transfer rate are to be compared:\n\n1. A calorically perfect gas model that assumes a constant specific heat at constant pressure equal to its value at $T_{1}$, namely $c_{p,0} = 1006\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$.\n2. A thermally perfect gas model using a temperature-dependent $c_{p}(T)$ constructed by linear interpolation between the following tabulated values for dry air (units of $c_{p}$ are $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ and units of $T$ are $\\mathrm{K}$):\n$$(T,c_{p}) \\in \\{(300,1006),\\,(600,1040),\\,(900,1100),\\,(1200,1160),\\,(1500,1220),\\,(1800,1270),\\,(2000,1310)\\}.$$\nAssume $c_{p}(T)$ varies linearly between each pair of adjacent tabulated temperatures, and use only the data provided.\n\nStarting from first principles, use the steady-flow first law of thermodynamics and the definition of enthalpy for an ideal gas to derive expressions for the heat transfer rate predictions under each model and then compute the signed relative error of the calorically perfect gas prediction with respect to the thermally perfect baseline. Report the signed relative error as\n$$\\varepsilon = \\frac{\\dot{Q}_{\\text{caloric}} - \\dot{Q}_{\\text{thermal}}}{\\dot{Q}_{\\text{thermal}}},$$\nexpressed as a dimensionless decimal fraction. Round your final answer to four significant figures. Do not use a percentage sign. If you introduce a mass flow rate $\\dot{m}$, your final reported $\\varepsilon$ must not depend on $\\dot{m}$.", "solution": "The problem is first validated to ensure it is scientifically sound and well-posed. The problem is based on the first law of thermodynamics applied to an open system, utilizing standard models for the specific heat of an ideal gas (calorically perfect and thermally perfect). The provided data for the specific heat of air are physically realistic, and the temperature range is relevant to engineering applications such as gas turbines. The problem is self-contained, with all necessary data and conditions provided to calculate a unique, meaningful result. There are no contradictions, ambiguities, or violations of physical principles. The problem is deemed valid and a solution can be formulated.\n\nThe analysis begins with the steady-flow first law of thermodynamics for a control volume. The energy balance is given by:\n$$ \\dot{Q} - \\dot{W}_{s} = \\dot{m} \\left( (h_{2} - h_{1}) + \\frac{V_{2}^{2} - V_{1}^{2}}{2} + g(z_{2} - z_{1}) \\right) $$\nwhere $\\dot{Q}$ is the rate of heat transfer into the system, $\\dot{W}_{s}$ is the rate of shaft work done by the system, $\\dot{m}$ is the mass flow rate, $h$ is the specific enthalpy, $V$ is the velocity, and $z$ is the elevation.\n\nAccording to the problem statement, the system is a gas heater, so there is no shaft work, meaning $\\dot{W}_{s} = 0$. Changes in kinetic and potential energies are to be neglected, thus $\\frac{V_{2}^{2} - V_{1}^{2}}{2} \\approx 0$ and $g(z_{2} - z_{1}) \\approx 0$. The first law simplifies to:\n$$ \\dot{Q} = \\dot{m} (h_{2} - h_{1}) = \\dot{m} \\Delta h $$\nThe specific heat transfer, $q$, is the heat transfer per unit mass:\n$$ q = \\frac{\\dot{Q}}{\\dot{m}} = h_{2} - h_{1} $$\nFor an ideal gas, the change in specific enthalpy is solely a function of temperature. The differential change in specific enthalpy is $dh = c_{p}(T) dT$, where $c_{p}(T)$ is the specific heat at constant pressure. The total change in specific enthalpy from an inlet temperature $T_{1}$ to an outlet temperature $T_{2}$ is found by integration:\n$$ \\Delta h = \\int_{T_{1}}^{T_{2}} c_{p}(T) dT $$\nTherefore, the specific heat transfer is $q = \\int_{T_{1}}^{T_{2}} c_{p}(T) dT$. We will evaluate this integral for the two proposed models.\n\nModel 1: Calorically Perfect Gas\nIn this model, the specific heat is assumed to be constant at its value at the initial temperature $T_{1} = 300\\,\\mathrm{K}$. This value is given as $c_{p,0} = 1006\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$. The integral for the specific heat transfer becomes:\n$$ q_{\\text{caloric}} = \\int_{T_{1}}^{T_{2}} c_{p,0} dT = c_{p,0} \\int_{T_{1}}^{T_{2}} dT = c_{p,0} (T_{2} - T_{1}) $$\nSubstituting the given values, $T_{1} = 300\\,\\mathrm{K}$ and $T_{2} = 2000\\,\\mathrm{K}$:\n$$ q_{\\text{caloric}} = (1006\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}) \\times (2000\\,\\mathrm{K} - 300\\,\\mathrm{K}) = 1006 \\times 1700\\,\\mathrm{J/kg} = 1710200\\,\\mathrm{J/kg} $$\n\nModel 2: Thermally Perfect Gas\nIn this model, $c_{p}(T)$ is a temperature-dependent, piecewise linear function defined by the provided data points. To find the specific heat transfer $q_{\\text{thermal}}$, we must integrate this piecewise function from $T_{1} = 300\\,\\mathrm{K}$ to $T_{2} = 2000\\,\\mathrm{K}$. The integral is the sum of the integrals over each linear segment. For any segment between temperatures $T_{i}$ and $T_{i+1}$, the integral of the linear function $c_p(T)$ is the area of a trapezoid:\n$$ \\int_{T_{i}}^{T_{i+1}} c_{p}(T) dT = \\frac{c_{p}(T_{i}) + c_{p}(T_{i+1})}{2} (T_{i+1} - T_{i}) $$\nThe total specific heat transfer is the sum of these areas over all segments from $T_{1}$ to $T_{2}$. The data points are $(300, 1006)$, $(600, 1040)$, $(900, 1100)$, $(1200, 1160)$, $(1500, 1220)$, $(1800, 1270)$, and $(2000, 1310)$.\nThe calculation proceeds as a sum over the six intervals:\n\\begin{align*} q_{\\text{thermal}} = & \\frac{1006 + 1040}{2} (600 - 300) + \\frac{1040 + 1100}{2} (900 - 600) \\\\ & + \\frac{1100 + 1160}{2} (1200 - 900) + \\frac{1160 + 1220}{2} (1500 - 1200) \\\\ & + \\frac{1220 + 1270}{2} (1800 - 1500) + \\frac{1270 + 1310}{2} (2000 - 1800) \\end{align*}\n$$ q_{\\text{thermal}} = (1023)(300) + (1070)(300) + (1130)(300) + (1190)(300) + (1245)(300) + (1290)(200) $$\n$$ q_{\\text{thermal}} = 306900 + 321000 + 339000 + 357000 + 373500 + 258000 $$\n$$ q_{\\text{thermal}} = 1955400\\,\\mathrm{J/kg} $$\n\nSigned Relative Error\nThe signed relative error $\\varepsilon$ of the calorically perfect model with respect to the thermally perfect model is defined as:\n$$ \\varepsilon = \\frac{\\dot{Q}_{\\text{caloric}} - \\dot{Q}_{\\text{thermal}}}{\\dot{Q}_{\\text{thermal}}} $$\nSince $\\dot{Q} = \\dot{m} q$, the mass flow rate $\\dot{m}$ cancels from the expression:\n$$ \\varepsilon = \\frac{\\dot{m} q_{\\text{caloric}} - \\dot{m} q_{\\text{thermal}}}{\\dot{m} q_{\\text{thermal}}} = \\frac{q_{\\text{caloric}} - q_{\\text{thermal}}}{q_{\\text{thermal}}} $$\nSubstituting the computed values for $q_{\\text{caloric}}$ and $q_{\\text{thermal}}$:\n$$ \\varepsilon = \\frac{1710200 - 1955400}{1955400} = \\frac{-245200}{1955400} $$\n$$ \\varepsilon \\approx -0.125396338... $$\nRounding the result to four significant figures gives:\n$$ \\varepsilon = -0.1254 $$\nThe negative sign indicates that the constant specific heat model significantly underestimates the heat transfer required to achieve the specified temperature rise, because it neglects the increase in specific heat capacity of air at higher temperatures.", "answer": "$$\\boxed{-0.1254}$$", "id": "2532089"}, {"introduction": "In advanced computational fluid dynamics (CFD) and other simulation environments, thermodynamic properties like temperature are often recovered from conserved quantities such as specific enthalpy. This requires a fast and reliable method for inverting the function $h(T)$. This exercise challenges you to bridge theory and practice by developing a robust numerical solver, based on Newton's method, to find the temperature $T$ that corresponds to a given enthalpy $h^{\\star}$ [@problem_id:2532137]. Implementing this algorithm provides invaluable experience with a core computational tool essential for modern thermal-fluid analysis.", "problem": "You are asked to implement and analyze a numerical inversion of temperature-dependent specific enthalpy for a calorically imperfect gas in a computational fluid dynamics setting. The inversion is from specific enthalpy to temperature, where the specific heat at constant pressure is temperature-dependent. The algorithmic core must be a Newton iteration with a well-defined stopping criterion and a globalization strategy that guarantees robust behavior over a prescribed temperature bracket.\n\nThe fundamental base is as follows:\n- For a single-phase substance modeled as a perfect gas with temperature-dependent specific heat at constant pressure, the definition of specific enthalpy satisfies the differential relation $dh = c_p(T)\\, dT$. Therefore, with a reference state temperature $T_{\\mathrm{ref}}$ and reference enthalpy set to zero, the enthalpy as a function of temperature is given by\n$$\nh(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\theta)\\, d\\theta.\n$$\n- Assume a polynomial model for $c_p(T)$:\n$$\nc_p(T) = a + b\\,T + c\\,T^2,\n$$\nwhere $a$, $b$, and $c$ are constants in the International System of Units (SI) with $c_p$ in $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ and $T$ in $\\mathrm{K}$.\n\nTask requirements:\n1. Derive a Newton iteration to solve for temperature $T$ given a target enthalpy $h^\\star$ by formulating a scalar root-finding problem $r(T)=0$ using only the base definitions above. Your derivation must be from first principles, without assuming any shortcut formulas. State the stopping criteria you will implement and a globalization strategy that ensures robustness when the raw Newton step would leave a prescribed temperature bracket.\n2. Implement the iteration for the specific model data below. Your implementation must check a priori that the root is bracketed and must employ a safeguard that combines Newton steps with backtracking and bisection as needed.\n3. Analyze mathematically the conditions under which the Newton iteration will converge for this model and discuss the effect of two initial guess strategies. Then, evaluate these strategies numerically using the provided test suite.\n\nModel data and units:\n- Use $T$ in $\\mathrm{K}$, $h$ in $\\mathrm{J}\\,\\mathrm{kg}^{-1}$, and $c_p$ in $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$.\n- Let $T_{\\mathrm{ref}} = 298.15$.\n- Let $a = 850.0$, $b = 0.1$, and $c = 1.0\\times 10^{-4}$.\n- With this choice, $c_p(T) > 0$ on a broad temperature range relevant to combustion and high-temperature gas dynamics, and $h(T)$ is strictly increasing, ensuring a unique inverse on any interval where $c_p(T)$ remains positive.\n- Use the closed-form integral implied by the fundamental base when evaluating $h(T)$.\n\nNumerical algorithm inputs and rules:\n- Temperature bracket: $T_{\\min} = 200.0$ and $T_{\\max} = 2500.0$.\n- Convergence tolerances:\n  - Temperature increment tolerance: $\\varepsilon_T = 10^{-10}$ in $\\mathrm{K}$.\n  - Residual tolerance: $\\varepsilon_h = 10^{-6}$ in $\\mathrm{J}\\,\\mathrm{kg}^{-1}$.\n- Maximum iterations: $N_{\\max} = 50$.\n- Globalization:\n  - If a raw Newton step would leave $[T_{\\min},T_{\\max}]$, perform a backtracking line search (step damping) and, if necessary, fall back to a bisection step using the current bracket that encloses the root.\n  - Update the bracketing interval using the sign of the residual at the accepted iterate to maintain a valid enclosure.\n\nInitial guess strategies to compare:\n- Strategy $\\mathrm{S1}$ (reference linearization): $T_0^{\\mathrm{S1}} = T_{\\mathrm{ref}} + h^\\star / c_p(T_{\\mathrm{ref}})$.\n- Strategy $\\mathrm{S2}$ (midpoint of the admissible bracket): $T_0^{\\mathrm{S2}} = \\tfrac{1}{2}(T_{\\min}+T_{\\max})$.\n- In all cases, clamp the initial guess to the bracket.\n\nTest suite:\n- For each test, the program must construct the target enthalpy $h^\\star$ from a known “true” temperature $T_{\\mathrm{true}}$ by exact evaluation of the integral $h(T_{\\mathrm{true}})$ and then attempt to recover the temperature via the inversion algorithm. Use the following set of true temperatures:\n  - Case $1$: $T_{\\mathrm{true}} = 900.0$.\n  - Case $2$: $T_{\\mathrm{true}} = 300.0$.\n  - Case $3$: $T_{\\mathrm{true}} = 2200.0$.\n  - Case $4$: $T_{\\mathrm{true}} = 250.0$.\n  - Case $5$: $T_{\\mathrm{true}} = 1500.0$.\n\nProgram output requirements:\n- For each case, run both initial guess strategies $\\mathrm{S1}$ and $\\mathrm{S2}$ and return, for each, the computed temperature in $\\mathrm{K}$, the number of iterations taken, and a boolean flag indicating convergence under the stated tolerances.\n- Express temperatures in $\\mathrm{K}$ rounded to six decimal places. The iteration count must be an integer. The convergence flag must be a boolean.\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list of lists, one sub-list per test case. Each sub-list must be\n  $[T^{\\mathrm{S1}}, n^{\\mathrm{S1}}, \\mathrm{conv}^{\\mathrm{S1}}, T^{\\mathrm{S2}}, n^{\\mathrm{S2}}, \\mathrm{conv}^{\\mathrm{S2}}]$,\n  where $T^{\\mathrm{S1}}$ and $T^{\\mathrm{S2}}$ are floats in $\\mathrm{K}$ rounded to six decimals, $n^{\\mathrm{S1}}$ and $n^{\\mathrm{S2}}$ are integers, and $\\mathrm{conv}^{\\mathrm{S1}}$, $\\mathrm{conv}^{\\mathrm{S2}}$ are booleans.\n- For example, the final output format must look like\n  $[[T_1^{\\mathrm{S1}}, n_1^{\\mathrm{S1}}, \\mathrm{conv}_1^{\\mathrm{S1}}, T_1^{\\mathrm{S2}}, n_1^{\\mathrm{S2}}, \\mathrm{conv}_1^{\\mathrm{S2}}],\\dots]$\n  on a single line, with no additional text.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of thermodynamics, well-posed with a unique solution guaranteed by the provided model, and objective in its formulation. All data and algorithmic requirements are complete and consistent. We may, therefore, proceed with the solution.\n\nThe task is to find the temperature $T$ that corresponds to a given specific enthalpy $h^\\star$ for a calorically imperfect gas. The relationship between specific enthalpy $h$ and temperature $T$ is defined by the specific heat at constant pressure, $c_p(T)$.\n\nFirst, we establish the explicit functional relationship between $h$ and $T$. The definition is $dh = c_p(T) dT$. Integrating this from a reference temperature $T_{\\mathrm{ref}}$ to an arbitrary temperature $T$, and setting the reference enthalpy to zero, yields:\n$$\nh(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\theta)\\, d\\theta\n$$\nThe specific heat is given by a polynomial model:\n$$\nc_p(T) = a + bT + cT^2\n$$\nSubstituting this into the integral for $h(T)$, we perform the integration:\n$$\nh(T) = \\int_{T_{\\mathrm{ref}}}^{T} (a + b\\theta + c\\theta^2)\\, d\\theta = \\left[ a\\theta + \\frac{b}{2}\\theta^2 + \\frac{c}{3}\\theta^3 \\right]_{T_{\\mathrm{ref}}}^{T}\n$$\nThis results in the closed-form expression for specific enthalpy:\n$$\nh(T) = \\left( aT + \\frac{b}{2}T^2 + \\frac{c}{3}T^3 \\right) - \\left( aT_{\\mathrm{ref}} + \\frac{b}{2}T_{\\mathrm{ref}}^2 + \\frac{c}{3}T_{\\mathrm{ref}}^3 \\right)\n$$\nFor convenience, we can define a primitive function $H(T) = aT + \\frac{b}{2}T^2 + \\frac{c}{3}T^3$, such that $h(T) = H(T) - H(T_{\\mathrm{ref}})$.\n\nThe problem of inverting this relationship to find $T$ for a given $h^\\star$ is equivalent to finding the root of the residual function $r(T)$:\n$$\nr(T) = h(T) - h^\\star = 0\n$$\nTo solve this using Newton's method, we require the derivative of the residual function, $r'(T)$. Using the Fundamental Theorem of Calculus, the derivative of an integral with respect to its upper limit is the integrand evaluated at that limit.\n$$\nr'(T) = \\frac{d}{dT} \\left( \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\theta)\\, d\\theta - h^\\star \\right) = c_p(T)\n$$\nThus, $r'(T) = a + bT + cT^2$. The Newton iteration for finding the root $T$ is given by the recursive formula:\n$$\nT_{k+1} = T_k - \\frac{r(T_k)}{r'(T_k)} = T_k - \\frac{h(T_k) - h^\\star}{c_p(T_k)}\n$$\nwhere $T_k$ is the temperature at iteration $k$.\n\nThe numerical algorithm must be robust. A globalization strategy is required to ensure convergence even when the initial guess is far from the root. The specified temperature bracket is $[T_{\\min}, T_{\\max}] = [200.0, 2500.0]$. A hybrid Newton-bisection algorithm will be implemented.\nFirst, we must verify that a root exists within the bracket by checking if $r(T_{\\min})$ and $r(T_{\\max})$ have opposite signs. Given the provided constants $a = 850.0$, $b = 0.1$, and $c = 1.0 \\times 10^{-4}$, the derivative $c_p(T)$ is a parabola opening upwards with its minimum at $T = -b/(2c) = -500.0$ K. For $T \\ge 200.0$ K, $c_p(T) > 0$, so $h(T)$ is strictly increasing. This guarantees a unique root inside any bracket $[T_L, T_R]$ if $h^\\star$ is between $h(T_L)$ and $h(T_R)$.\n\nThe algorithm proceeds as follows:\n1.  Initialize the iteration count $k = 0$, the temperature bracket $[T_L, T_R] = [T_{\\min}, T_{\\max}]$, and the initial guess $T_0$ according to the chosen strategy (S1 or S2), clamped to the bracket.\n2.  In each iteration $k$, starting with the current guess $T_k$:\n    a. Calculate the residual $r(T_k)$ and its derivative $c_p(T_k)$.\n    b. Compute the Newton step $\\Delta T_k = -r(T_k)/c_p(T_k)$ and the proposed next iterate $T_{\\text{prop}} = T_k + \\Delta T_k$.\n    c. If the proposed iterate $T_{\\text{prop}}$ falls outside the current search bracket $[T_L, T_R]$, the raw Newton step is rejected. A more conservative bisection step is taken instead: $T_{k+1} = T_L + 0.5(T_R - T_L)$.\n    d. Otherwise, the Newton step is accepted: $T_{k+1} = T_{\\text{prop}}$.\n    e. The bracketing interval is updated for the next iteration. By evaluating the sign of the residual at the new iterate, $r(T_{k+1})$, the bracket is narrowed. If $\\text{sign}(r(T_{k+1})) = \\text{sign}(r(T_L))$, the new left boundary becomes $T_L = T_{k+1}$. Otherwise, the new right boundary becomes $T_R = T_{k+1}$. This ensures the root remains bracketed.\n3.  The iteration terminates if convergence is achieved or the maximum number of iterations, $N_{\\max} = 50$, is reached. Convergence is defined as satisfying either of two conditions:\n    a. The change in temperature is below a tolerance: $|T_{k+1} - T_k| < \\varepsilon_T = 10^{-10}$ K.\n    b. The magnitude of the enthalpy residual is below a tolerance: $|r(T_{k+1})| = |h(T_{k+1}) - h^\\star| < \\varepsilon_h = 10^{-6}$ J/kg.\n\nThe mathematical conditions for convergence of Newton's method are favorable here. The function $r(T)$ has its second derivative as $r''(T) = c_p'(T) = b + 2cT$. For all $T > -b/(2c) = -500.0$ K, $r''(T)>0$. This means $r(T)$ is a convex function over the entire temperature range of interest $[200.0, 2500.0]$. For a convex function, Newton's method is guaranteed to converge to the unique root from any starting point $T_0$ for which $r(T_0)>0$, and will converge rapidly from starting points $T_0 < T^\\star$. The implemented globalization strategy provides an additional layer of robustness, guaranteeing convergence even in less ideal circumstances.\n\nWe analyze two initial guess strategies:\n- **Strategy S1**: $T_0^{\\mathrm{S1}} = T_{\\mathrm{ref}} + h^\\star / c_p(T_{\\mathrm{ref}})$. This guess is derived from a first-order Taylor series expansion of the inverse function $T(h)$ around the reference state $(T_{\\mathrm{ref}}, h=0)$. It linearizes the problem using the specific heat at the reference temperature. This \"informed\" guess is expected to be highly accurate when the true temperature $T_{\\mathrm{true}}$ is near $T_{\\mathrm{ref}} = 298.15$ K, and should remain a good estimate for temperatures where $c_p(T)$ does not deviate drastically from $c_p(T_{\\mathrm{ref}})$.\n- **Strategy S2**: $T_0^{\\mathrm{S2}} = \\tfrac{1}{2}(T_{\\min}+T_{\\max}) = 1350.0$ K. This \"uninformed\" guess is fixed at the midpoint of the admissible temperature bracket, irrespective of the target enthalpy $h^\\star$. It is a safe but potentially inefficient starting point, especially when the true root lies near the boundaries of the bracket.\n\nWe expect Strategy S1 to be superior, resulting in fewer iterations across the test suite, due to its physical basis. Strategy S2's performance will depend strongly on the proximity of the true temperature to the bracket's midpoint. Both strategies are expected to converge successfully due to the robustness of the implemented algorithm.", "answer": "[[900.0, 3, True, 900.0, 5, True], [300.0, 2, True, 300.0, 7, True], [2200.0, 4, True, 2200.0, 5, True], [250.0, 3, True, 250.0, 7, True], [1500.0, 4, True, 1500.0, 3, True]]", "id": "2532137"}]}