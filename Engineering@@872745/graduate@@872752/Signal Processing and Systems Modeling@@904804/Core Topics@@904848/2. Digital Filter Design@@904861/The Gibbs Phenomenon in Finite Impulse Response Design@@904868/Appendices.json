{"hands_on_practices": [{"introduction": "To understand the Gibbs phenomenon, we must first go back to its mathematical roots. This practice guides you through the analytical derivation of the frequency response for an FIR filter created by directly truncating the ideal sinc impulse response. By expressing this response as a finite Fourier series, you will see precisely how the truncation introduces oscillatory errors (ripples) in both the passband and stopband, providing a foundational view of the phenomenon. [@problem_id:2912668]", "problem": "Consider the ideal discrete-time lowpass filter of unit gain and cutoff frequency $\\,\\omega_c \\in (0,\\pi)\\,$ with impulse response $\\,h_d[n] = \\frac{\\sin(\\omega_c n)}{\\pi n}\\,$ for $\\,n \\neq 0\\,$ and $\\,h_d[0] = \\frac{\\omega_c}{\\pi}\\,$. Form a symmetric, length-$N$ ($N$ odd) finite impulse response by rectangular truncation about the origin:\n- Let $\\,N = 2M+1\\,$ with $\\,M \\in \\mathbb{N}\\,$.\n- Define $\\,h_N[n] = h_d[n]\\,$ for $\\,n \\in \\{-M,-M+1,\\dots,0,\\dots,M-1,M\\}\\,$ and $\\,h_N[n] = 0\\,$ otherwise.\n\nUsing only the definitions of the discrete-time Fourier transform (DTFT), the ideal lowpass frequency response, and the rectangular window, derive the DTFT $\\,H_N(\\omega)\\,$ of $\\,h_N[n]\\,$ and simplify it to a real cosine series in $\\,\\omega\\,$ and $\\,N\\,$. Then, by interpreting $\\,H_N(\\omega)\\,$ as a finite Fourier-series approximation to the ideal rectangular frequency response, express:\n- the passband deviation $\\,\\Delta_p(\\omega;N) := H_N(\\omega) - 1\\,$ for $\\,|\\omega|  \\omega_c\\,$, and\n- the stopband magnitude $\\,E_s(\\omega;N) := |H_N(\\omega)|\\,$ for $\\,|\\omega|  \\omega_c\\,$,\n\nexplicitly in terms of $\\,N\\,$ and $\\,\\omega\\,$, and state their leading-order dependence on $\\,N\\,$ and $\\,\\omega\\,$ away from the transition edges $\\,\\pm \\omega_c\\,$, commenting on the Gibbs phenomenon at $\\,\\omega = \\pm \\omega_c\\,$. Angles must be in radians. Report your final answer as the single closed-form expression of $\\,H_N(\\omega)\\,$ you derived. No numerical rounding is required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- Ideal discrete-time lowpass filter impulse response: $h_d[n] = \\frac{\\sin(\\omega_c n)}{\\pi n}$ for $n \\neq 0$, and $h_d[0] = \\frac{\\omega_c}{\\pi}$.\n- Cutoff frequency: $\\omega_c \\in (0,\\pi)$.\n- Filter gain: Unit ($1$).\n- Finite Impulse Response (FIR) filter length: $N$, where $N$ is an odd integer.\n- Relation between $N$ and $M$: $N = 2M+1$, where $M \\in \\mathbb{N}$.\n- FIR impulse response definition: $h_N[n] = h_d[n]$ for $n \\in \\{-M, \\dots, M\\}$ and $h_N[n]=0$ otherwise.\n\nStep 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard exercise in digital signal processing concerning the design of FIR filters using the window method. The definitions of the ideal lowpass filter, its impulse response (a sinc function), and the process of truncation by a rectangular window are all fundamental and correct concepts in the field. The requested analysis pertains to the Gibbs phenomenon, a well-established mathematical and physical effect. The problem is scientifically sound.\n- **Well-Posed:** The problem is clearly stated. It asks for the derivation of the frequency response of the truncated filter, an analysis of its deviation from the ideal, and a commentary on the Gibbs phenomenon. All required information is provided to derive a unique and meaningful solution.\n- **Objective:** The problem is formulated with precise mathematical language, free from any subjectivity or ambiguity.\n\nStep 3: Verdict and Action\nThe problem is valid. A rigorous solution will be constructed.\n\nThe frequency response $H_N(\\omega)$ of the finite impulse response filter $h_N[n]$ is given by its discrete-time Fourier transform (DTFT):\n$$H_N(\\omega) = \\sum_{n=-\\infty}^{\\infty} h_N[n] \\exp(-j\\omega n)$$\nBy definition, $h_N[n]$ is non-zero only for $|n| \\le M$, where $N=2M+1$. Thus, the summation is over a finite range:\n$$H_N(\\omega) = \\sum_{n=-M}^{M} h_N[n] \\exp(-j\\omega n)$$\nSubstituting the definition $h_N[n] = h_d[n]$ for this range, we have:\n$$H_N(\\omega) = \\sum_{n=-M}^{M} h_d[n] \\exp(-j\\omega n)$$\nWe separate the $n=0$ term from the sum:\n$$H_N(\\omega) = h_d[0] + \\sum_{n=-M, n \\neq 0}^{M} h_d[n] \\exp(-j\\omega n)$$\nSubstituting the given expressions for $h_d[n]$:\n$$H_N(\\omega) = \\frac{\\omega_c}{\\pi} + \\sum_{n=-M, n \\neq 0}^{M} \\frac{\\sin(\\omega_c n)}{\\pi n} \\exp(-j\\omega n)$$\nWe can split the summation into positive and negative indices:\n$$H_N(\\omega) = \\frac{\\omega_c}{\\pi} + \\sum_{n=1}^{M} \\frac{\\sin(\\omega_c n)}{\\pi n} \\exp(-j\\omega n) + \\sum_{n=-M}^{-1} \\frac{\\sin(\\omega_c n)}{\\pi n} \\exp(-j\\omega n)$$\nIn the second summation, let $k = -n$. As $n$ goes from $-M$ to $-1$, $k$ goes from $M$ to $1$:\n$$\\sum_{k=1}^{M} \\frac{\\sin(\\omega_c (-k))}{\\pi (-k)} \\exp(-j\\omega (-k)) = \\sum_{k=1}^{M} \\frac{-\\sin(\\omega_c k)}{-\\pi k} \\exp(j\\omega k) = \\sum_{k=1}^{M} \\frac{\\sin(\\omega_c k)}{\\pi k} \\exp(j\\omega k)$$\nReplacing $k$ with $n$ as the dummy index and substituting back:\n$$H_N(\\omega) = \\frac{\\omega_c}{\\pi} + \\sum_{n=1}^{M} \\frac{\\sin(\\omega_c n)}{\\pi n} \\exp(-j\\omega n) + \\sum_{n=1}^{M} \\frac{\\sin(\\omega_c n)}{\\pi n} \\exp(j\\omega n)$$\nFactoring out the common terms:\n$$H_N(\\omega) = \\frac{\\omega_c}{\\pi} + \\sum_{n=1}^{M} \\frac{\\sin(\\omega_c n)}{\\pi n} (\\exp(-j\\omega n) + \\exp(j\\omega n))$$\nUsing Euler's identity, $\\exp(j\\theta) + \\exp(-j\\theta) = 2\\cos(\\theta)$, we obtain the simplified real cosine series expression for $H_N(\\omega)$:\n$$H_N(\\omega) = \\frac{\\omega_c}{\\pi} + \\frac{2}{\\pi} \\sum_{n=1}^{M} \\frac{\\sin(\\omega_c n) \\cos(\\omega n)}{n}$$\nSince $M = (N-1)/2$, the expression in terms of $N$ is:\n$$H_N(\\omega) = \\frac{\\omega_c}{\\pi} + \\frac{2}{\\pi} \\sum_{n=1}^{(N-1)/2} \\frac{\\sin(\\omega_c n) \\cos(\\omega n)}{n}$$\nThis function is the truncated Fourier series of the ideal frequency response $H_d(\\omega)$, which is a periodic rectangular wave.\n\nNext, we analyze the filter's performance. The ideal response is $H_d(\\omega)=1$ for $|\\omega|  \\omega_c$ and $H_d(\\omega)=0$ for $\\omega_c  |\\omega| \\le \\pi$.\n\nThe passband deviation for $|\\omega|  \\omega_c$ is $\\Delta_p(\\omega;N) = H_N(\\omega) - 1$.\n$$\\Delta_p(\\omega;N) = \\left( \\frac{\\omega_c}{\\pi} + \\frac{2}{\\pi} \\sum_{n=1}^{M} \\frac{\\sin(\\omega_c n) \\cos(\\omega n)}{n} \\right) - 1$$\nThis deviation represents the error from truncating the infinite Fourier series of the ideal response. The infinite series converges to $1$ in this region. The error term is thus the tail of the series:\n$$\\Delta_p(\\omega;N) = - \\frac{2}{\\pi} \\sum_{n=M+1}^{\\infty} \\frac{\\sin(\\omega_c n) \\cos(\\omega n)}{n}$$\nAway from the transition edges (i.e., for $|\\omega_c - |\\omega|| \\gg 2\\pi/N$), the magnitude of this deviation decays as $O(1/N)$.\n\nThe stopband magnitude for $|\\omega|  \\omega_c$ is $E_s(\\omega;N) = |H_N(\\omega)|$.\n$$E_s(\\omega;N) = \\left| \\frac{\\omega_c}{\\pi} + \\frac{2}{\\pi} \\sum_{n=1}^{M} \\frac{\\sin(\\omega_c n) \\cos(\\omega n)}{n} \\right|$$\nThis represents the leakage into the stopband. The infinite series converges to $0$ in this region. Thus, $H_N(\\omega)$ is the error itself. Away from the transition edges, the magnitude of these stopband ripples also decays as $O(1/N)$.\n\nFinally, we address the Gibbs phenomenon. The truncation of the Fourier series at $n=M$ causes characteristic oscillations, particularly near the points of discontinuity at $\\omega = \\pm \\omega_c$. The convolution of the ideal rectangular frequency response with the sinc-like spectrum of the rectangular window results in these oscillations. As $N$ increases, the transition band of the filter becomes narrower, and the ripples become more compressed towards the discontinuities. However, the amplitude of the first ripple adjacent to the discontinuity does not decrease. This is the Gibbs phenomenon. In the passband, the frequency response overshoots the target value of $1$ to a peak value of approximately $1.09$. In the stopband, it undershoots the target value of $0$ to a minimum of approximately $-0.09$. The magnitude of this overshoot/undershoot, about $9\\%$ of the jump height at the discontinuity, is a constant independent of the filter length $N$. The phenomenon illustrates the non-uniform convergence of a Fourier series at a jump discontinuity.", "answer": "$$\\boxed{\\frac{\\omega_c}{\\pi} + \\frac{2}{\\pi} \\sum_{n=1}^{(N-1)/2} \\frac{\\sin(\\omega_c n) \\cos(\\omega n)}{n}}$$", "id": "2912668"}, {"introduction": "Theory comes to life when we see its effects in a practical simulation. This hands-on coding exercise demonstrates the time-domain manifestation of the Gibbs phenomenon by observing the response of an FIR filter to a sharp step input. You will quantify the resulting overshoot and undershoot and directly compare the performance of a simple rectangular window with a more effective Hamming window, illustrating the first line of defense against unwanted ringing. [@problem_id:2436691]", "problem": "Design a family of linear-phase Finite Impulse Response (FIR) low-pass filters, apply each to a discrete-time unit-step input, and quantify the ripples that appear near the step discontinuity. The task is to formalize and measure the Gibbs phenomenon using well-defined metrics computed directly from first principles. Use the following definitions and requirements.\n\nLet the sampling frequency be $f_s$ in hertz, the filter length (number of taps) be $N$ in samples, and the cutoff frequency be $f_c$ in hertz. Consider a discrete-time unit step input $u[n]$ of amplitude $A=1$ defined by $u[n]=0$ for $n0$ and $u[n]=1$ for $n\\ge 0$. Implement a finite-length sequence of length $L$ samples that approximates $u[n]$ by placing a single step at index $n_0=\\lfloor L/2 \\rfloor$ so that $x[n]=0$ for $0\\le nn_0$ and $x[n]=1$ for $n_0\\le n\\le L-1$. Use $L=32768$ samples and $A=1$ (dimensionless). Angles are not involved.\n\nFor each test case below, design a causal, real, linear-phase FIR low-pass filter $h[n]$ of length $N$ that approximates the ideal low-pass response with cutoff $f_c$ using the standard windowed-sinc method with the specified window. Denote the discrete-time convolution by $y[n]=(x*h)[n]$. Let the steady-state value be $y_{\\mathrm{ss}}=\\sum_{k=0}^{N-1} h[k]\\cdot A$, which is the output value after transients for a unit-step input.\n\nDefine the following quantitative measures computed directly from $y[n]$:\n- Overshoot ratio $r_{\\mathrm{over}}=\\max\\left(0,\\dfrac{\\max_{n\\in\\mathcal{I}} y[n]-y_{\\mathrm{ss}}}{y_{\\mathrm{ss}}}\\right)$, where the analysis index set is $\\mathcal{I}=\\{n_0,n_0+1,\\dots,n_0+4N-1\\}$ truncated to the valid output index range.\n- Undershoot ratio $r_{\\mathrm{under}}=\\max\\left(0,\\dfrac{y_{\\mathrm{ss}}-\\min_{n\\in\\mathcal{I}} y[n]}{y_{\\mathrm{ss}}}\\right)$.\n- Ripple zero-crossing count $Z$, defined as the number of sign changes in the sequence $w[n]=y[n]-y_{\\mathrm{ss}}$ for $n\\in\\mathcal{I}$ when scanning in increasing $n$ and ignoring any indices where $w[n]=0$ exactly; that is, $Z$ is the count of indices where the sign of $w[n]$ differs from the immediately preceding nonzero-sign sample in $\\mathcal{I}$.\n\nAll frequencies must be interpreted and used in hertz. The output metrics $r_{\\mathrm{over}}$ and $r_{\\mathrm{under}}$ must be reported as decimals (no percent sign), and $Z$ as an integer.\n\nTest suite (each item is one independent case):\n- Case $1$: $N=129$, $f_s=1000$ hertz, $f_c=100$ hertz, window type \"hamming\".\n- Case $2$: $N=129$, $f_s=1000$ hertz, $f_c=100$ hertz, window type \"boxcar\" (rectangular).\n- Case $3$: $N=513$, $f_s=1000$ hertz, $f_c=100$ hertz, window type \"boxcar\" (rectangular).\n- Case $4$: $N=129$, $f_s=1000$ hertz, $f_c=225$ hertz, window type \"boxcar\" (rectangular).\n- Case $5$: $N=31$, $f_s=1000$ hertz, $f_c=100$ hertz, window type \"boxcar\" (rectangular).\n\nProgram input: none. Program operation: implement the definitions as stated for each case, with $x[n]$ defined using $L=32768$ and $n_0=\\lfloor L/2 \\rfloor$, compute $y[n]=(x*h)[n]$ by discrete-time convolution, and then compute $r_{\\mathrm{over}}$, $r_{\\mathrm{under}}$, and $Z$ as defined.\n\nFinal output format: your program should produce a single line containing a top-level list with one sub-list per test case, ordered as given above. Each sub-list must be of the form $[r_{\\mathrm{over}},r_{\\mathrm{under}},Z]$. The two ratios must be rounded to exactly $6$ decimal places, and $Z$ must be an integer. The line must contain no extra characters or spaces beyond commas, brackets, digits, and decimal points. For example, a syntactically valid output with two cases would look like $[[0.012345,0.006789,42],[0.000000,0.000000,0]]$.", "solution": "The problem as stated is subjected to rigorous validation and is found to be valid. It is scientifically grounded in the established principles of digital signal processing, specifically the design of Finite Impulse Response (FIR) filters and the analysis of their transient behavior. It is well-posed, providing all necessary definitions, parameters, and constraints to compute a unique and meaningful solution for each test case. The language is objective and precise, leaving no room for ambiguity. All definitions for signals, filters, and metrics are formal and computationally implementable.\n\nThe task is to design a set of linear-phase FIR low-pass filters using the windowed-sinc method and to quantify the Gibbs phenomenon observed in their step response. The Gibbs phenomenon manifests as persistent overshoot and undershoot (ripples) near a step discontinuity when a signal is reconstructed from a truncated set of its frequency components. This is precisely what occurs when an ideal step input is passed through a practical, non-ideal low-pass filter.\n\nThe design and analysis will proceed in three stages: $1$) FIR filter design, $2$) system response computation, and $3$) metric evaluation.\n\n**1. Linear-Phase FIR Filter Design via the Windowed-Sinc Method**\n\nAn ideal low-pass filter has a rectangular frequency response, which is unity for frequencies below the cutoff frequency $f_c$ and zero above it. The corresponding impulse response $h_{ideal}[n]$ in the discrete-time domain is obtained via the inverse Discrete-Time Fourier Transform (DTFT). For a normalized cutoff frequency $\\omega_c = 2\\pi f_c / f_s$, the ideal impulse response is a sinc function:\n$$h_{ideal}[n] = \\frac{\\sin(\\omega_c n)}{\\pi n} \\quad \\text{for } n \\neq 0$$\nAt $n=0$, the limit of this expression is $h_{ideal}[0] = \\omega_c / \\pi = 2 f_c / f_s$. This impulse response is non-causal (it exists for $n  0$) and has infinite length, making it physically unrealizable.\n\nTo create a practical FIR filter of length $N$, we must truncate $h_{ideal}[n]$. A simple truncation is equivalent to multiplying $h_{ideal}[n]$ by a rectangular window (specified as \"boxcar\"). This abrupt truncation in the time domain leads to significant ripples in the frequency domain (the Gibbs phenomenon's spectral manifestation). To mitigate this, a smoother window function $w[n]$, such as the Hamming window, is applied. The windowed impulse response is:\n$$h_{w}[n] = h_{ideal}[n] \\cdot w[n]$$\nFor a length-$N$ filter, where $N$ is specified as an odd integer in all test cases, this operation is performed over a symmetric interval around zero, typically $n \\in \\{-(N-1)/2, \\dots, (N-1)/2\\}$. The resulting filter $h_w[n]$ is non-causal but has zero phase.\n\nTo make the filter causal, its impulse response is shifted by $M = (N-1)/2$ samples. The final, causal, linear-phase FIR filter $h[n]$ has coefficients:\n$$h[n] = h_{w}[n - M] \\quad \\text{for } n \\in \\{0, 1, \\dots, N-1\\}$$\nThis delay of $M$ samples ensures the filter is physically realizable, and because the original unshifted impulse response was symmetric, the phase response of the causal filter is linear.\n\nFinally, the filter coefficients are normalized to ensure unity gain at DC (zero frequency), meaning $\\sum_{k=0}^{N-1} h[k] = 1$. This guarantees that the steady-state response to a unit-amplitude step input is unity, i.e., $y_{\\mathrm{ss}} = A \\sum_{k=0}^{N-1} h[k] = 1 \\cdot 1 = 1$. This normalization provides a stable baseline for quantifying overshoot and undershoot. The `scipy.signal.firwin` function provides a canonical implementation of this entire windowed-sinc design process.\n\n**2. System Response to a Step Input**\n\nThe input signal $x[n]$ is a finite-length approximation of a discrete-time unit step, defined over $L = 32768$ samples. The step occurs at index $n_0 = \\lfloor L/2 \\rfloor = 16384$. Thus, $x[n] = 0$ for $n  n_0$ and $x[n] = 1$ for $n \\ge n_0$.\n\nThe output signal $y[n]$ is the result of the discrete-time convolution of the input signal $x[n]$ with the filter's impulse response $h[n]$:\n$$y[n] = (x * h)[n] = \\sum_{k=0}^{N-1} h[k] x[n-k]$$\nThe length of the resulting output sequence $y[n]$ is $L + N - 1$. The convolution operation effectively applies the filter to the input signal.\n\n**3. Quantitative Analysis of Ripples**\n\nThe problem requires the computation of three metrics to quantify the Gibbs phenomenon in the filter's step response. These are computed over an analysis index set $\\mathcal{I}=\\{n_0, n_0+1, \\dots, n_0+4N-1\\}$, which focuses on the region immediately following the step discontinuity where transients are most prominent.\n\n- **Steady-State Value ($y_{\\mathrm{ss}}$)**: As per the definition and our filter normalization, $y_{\\mathrm{ss}} = \\sum_{k=0}^{N-1} h[k] \\cdot A = 1.0$, where $A=1$.\n\n- **Overshoot Ratio ($r_{\\mathrm{over}}$)**: This metric measures the maximum positive deviation from the steady-state value, normalized by the steady-state value itself.\n$$r_{\\mathrm{over}} = \\max\\left(0, \\frac{\\max_{n \\in \\mathcal{I}} y[n] - y_{\\mathrm{ss}}}{y_{\\mathrm{ss}}}\\right)$$\n\n- **Undershoot Ratio ($r_{\\mathrm{under}}$)**: This metric measures the maximum negative deviation (dip below the baseline before the step or initial ripple trough after the step), also normalized.\n$$r_{\\mathrm{under}} = \\max\\left(0, \\frac{y_{\\mathrm{ss}} - \\min_{n \\in \\mathcal{I}} y[n]}{y_{\\mathrm{ss}}}\\right)$$\n\n- **Ripple Zero-Crossing Count ($Z$)**: This metric counts how many times the ripple waveform $w[n] = y[n] - y_{\\mathrm{ss}}$ crosses the steady-state value within the analysis interval $\\mathcal{I}$. It is calculated by counting the sign changes in the sequence $w[n]$ after removing any samples where $w[n]$ is exactly zero. This gives an indication of the ripple frequency.\n\nThe implementation will systematically execute these steps for each test case, providing a quantitative comparison of filter performance and a clear demonstration of the Gibbs phenomenon. For example, comparing Case $1$ (Hamming) and Case $2$ (boxcar) will demonstrate the superior ripple suppression of the Hamming window. Comparing Cases $2$, $3$, and $5$ (all boxcar) will show how filter length $N$ affects the transition sharpness and ripple characteristics. Specifically, the overshoot for the boxcar window is expected to be approximately $9\\%$ of the step height, regardless of $N$, illustrating a fundamental property of the Gibbs phenomenon.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import firwin, get_window\n\ndef solve():\n    \"\"\"\n    Designs FIR filters, computes their step response, and quantifies Gibbs phenomenon.\n    \"\"\"\n    # Define problem constants\n    L = 32768\n    A = 1.0\n    n_0 = L // 2\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, fs, fc, window_type)\n        (129, 1000, 100, \"hamming\"),\n        (129, 1000, 100, \"boxcar\"),\n        (513, 1000, 100, \"boxcar\"),\n        (129, 1000, 225, \"boxcar\"),\n        (31, 1000, 100, \"boxcar\"),\n    ]\n\n    results = []\n    \n    # Generate the discrete-time step input signal x[n]\n    x = np.zeros(L)\n    x[n_0:] = A\n\n    for case in test_cases:\n        N, fs, fc, window_type = case\n\n        # --- 1. FIR Filter Design (Windowed-Sinc Method) ---\n        # The firwin function implements the windowed-sinc method.\n        # It requires the cutoff frequency to be normalized by the Nyquist frequency.\n        nyquist_freq = fs / 2.0\n        normalized_cutoff = fc / nyquist_freq\n        \n        # Design the causal, linear-phase FIR filter.\n        # firwin automatically normalizes the filter for unity gain at DC.\n        h = firwin(N, normalized_cutoff, window=window_type, pass_zero='lowpass')\n\n        # --- 2. System Response Computation ---\n        # Convolve the input signal x[n] with the filter impulse response h[n]\n        y = np.convolve(x, h, mode='full')\n\n        # --- 3. Metric Computation ---\n        # The analysis index set is I = {n_0, n_0+1, ..., n_0 + 4N - 1}\n        # The problem statement guarantees this is within the valid output range.\n        analysis_start = n_0\n        analysis_end = n_0 + 4 * N\n        y_analysis = y[analysis_start:analysis_end]\n        \n        # Calculate the steady-state value. Since A=1 and firwin normalizes\n        # the filter, y_ss = sum(h), which is approximately 1.0.\n        y_ss = np.sum(h) * A\n\n        # Calculate overshoot ratio\n        y_max = np.max(y_analysis)\n        r_over = np.maximum(0.0, (y_max - y_ss) / y_ss)\n\n        # Calculate undershoot ratio\n        y_min = np.min(y_analysis)\n        r_under = np.maximum(0.0, (y_ss - y_min) / y_ss)\n        \n        # Calculate ripple zero-crossing count Z\n        # w[n] = y[n] - y_ss\n        w = y_analysis - y_ss\n        \n        # Ignore indices where w[n] is exactly zero, as per problem definition\n        w_nonzero = w[w != 0]\n        \n        # Count sign changes\n        signs = np.sign(w_nonzero)\n        sign_changes = signs[:-1] * signs[1:]\n        Z = np.sum(sign_changes  0)\n\n        # Append formatted results\n        results.append([\n            round(r_over, 6),\n            round(r_under, 6), \n            int(Z)\n        ])\n    \n    # Format the results into the required string format\n    # Example: [[0.012345,0.006789,42],[0.000000,0.000000,0]]\n    result_str = str(results).replace(\" \", \"\")\n\n    # Final print statement in the exact required format.\n    print(result_str)\n\nsolve()\n```", "id": "2436691"}, {"introduction": "While standard windows like Hamming improve performance, practical filter design often requires more precise control over the trade-offs inherent in the Gibbs phenomenon. This practice introduces the powerful Kaiser window, which uses a parameter $\\beta$ to continuously adjust the balance between stopband ripple attenuation and transition-band width. By working through the standard design equations, you will learn how to select the appropriate window parameters to meet specific frequency-domain specifications, a core skill in advanced FIR filter design. [@problem_id:2912694]", "problem": "You are tasked with connecting the edge behavior caused by the Gibbs phenomenon in finite impulse response window design to practical design parameters of the Kaiser window. Begin from fundamental definitions of the discrete-time Fourier transform of a windowed ideal response, the concept that truncation induces oscillatory behavior near discontinuities, and the fact that parametric windows alter the tradeoff between mainlobe width and sidelobe attenuation. Use the known structural properties of the Kaiser window, whose shape parameter controls the tradeoff between passband/stopband ripple and transition width, and standard asymptotic relations derived from the modified Bessel function of the first kind of order zero to obtain a computable mapping from a desired stopband attenuation to the Kaiser parameter, and an approximate relation between transition width and length.\n\nYour program must, for each provided test case, do the following:\n- Given a fixed finite impulse response length $N$ and target stopband attenuation $A_s$ in decibels, compute the Kaiser parameter $\\beta$ that achieves the specified stopband attenuation under the Kaiser window model.\n- Infer the approximate transition width $\\Delta \\omega$ in radians per sample, consistent with the Kaiser window design framework, taking into account that the filter order is $M = N - 1$.\n\nAngle units must be radians per sample. All results must be rounded to six decimal places.\n\nTest suite:\n- Case 1 (happy path, high attenuation): $(N, A_s) = (51, 60)$.\n- Case 2 (mid-range attenuation): $(N, A_s) = (101, 30)$.\n- Case 3 (low attenuation region): $(N, A_s) = (64, 15)$.\n- Case 4 (boundary condition at $A_s = 21$): $(N, A_s) = (256, 21)$.\n- Case 5 (boundary condition at $A_s = 50$): $(N, A_s) = (33, 50)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list $[\\beta, \\Delta \\omega]$ corresponding to a test case, and both $\\beta$ and $\\Delta \\omega$ are rounded to six decimal places. For example: $[[\\beta_1,\\Delta\\omega_1],[\\beta_2,\\Delta\\omega_2],\\ldots]$.\n\nNotes:\n- Treat $A_s$ as a nonnegative real number in decibels and $N$ as a positive integer with $N \\geq 2$ so that the filter order $M = N - 1$ is nonzero.\n- The inference for $\\Delta \\omega$ must reflect the standard Kaiser window design relation between filter order, stopband attenuation, and transition width in the normalized digital frequency domain.", "solution": "The problem as stated will first be subject to rigorous validation.\n\n**Step 1: Extract Givens**\n\nThe givens extracted verbatim from the problem statement are:\n-   **Task:** Connect the Gibbs phenomenon in finite impulse response (FIR) window design to the practical design parameters of the Kaiser window.\n-   **Input Parameters:** For each test case, a fixed FIR length $N$ and a target stopband attenuation $A_s$ in decibels.\n-   **Output Parameters:** For each test case, the Kaiser parameter $\\beta$ and the approximate transition width $\\Delta \\omega$ in radians per sample.\n-   **Constraint:** The filter order is $M = N - 1$.\n-   **Constraint:** $A_s$ is a non-negative real number. $N$ is a positive integer with $N \\ge 2$.\n-   **Constraint:** All results must be rounded to six decimal places.\n-   **Framework:** Use the known structural properties of the Kaiser window and standard asymptotic relations.\n-   **Test Suite:**\n    -   Case 1: $(N, A_s) = (51, 60)$\n    -   Case 2: $(N, A_s) = (101, 30)$\n    -   Case 3: $(N, A_s) = (64, 15)$\n    -   Case 4: $(N, A_s) = (256, 21)$\n    -   Case 5: $(N, A_s) = (33, 50)$\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is subjected to validation against the specified criteria.\n\n-   **Scientific Groundedness:** The problem is firmly rooted in the discipline of digital signal processing (DSP). The Gibbs phenomenon, FIR filter design using the window method, and the Kaiser window are all canonical topics in this field. The relationships between window parameters ($\\beta$, $N$) and filter performance metrics ($A_s$, $\\Delta \\omega$) are based on well-established empirical formulas derived by J.F. Kaiser from the analysis of the spectral properties of the window function, which involves the modified Bessel function $I_0(x)$. The problem is scientifically sound.\n-   **Well-Posedness:** The problem provides sufficient information to determine a unique solution for each test case. The inputs ($N$, $A_s$) are clearly defined, and the required outputs ($\\beta$, $\\Delta \\omega$) can be computed directly using standard, non-ambiguous formulas from the Kaiser window design methodology. A unique and stable solution exists for all provided test cases.\n-   **Objectivity:** The problem is stated in precise, objective language. Terms such as \"stopband attenuation\", \"transition width\", and \"Kaiser parameter\" have unambiguous definitions in the context of DSP. The problem is free from subjective claims or opinions.\n\nThe problem does not exhibit any of the listed flaws. It is not scientifically unsound, non-formalizable, incomplete, or unrealistic. It is well-posed and objective.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A complete, reasoned solution will now be provided.\n\n---\n\nThe objective is to compute the Kaiser window parameter $\\beta$ and the associated transition width $\\Delta \\omega$ for a given Finite Impulse Response (FIR) filter length $N$ and a desired stopband attenuation $A_s$. This task demonstrates the core trade-offs in FIR filter design, which are a direct consequence of the Gibbs phenomenon.\n\nWhen designing an FIR filter by the window method, one starts with an ideal, infinite-duration impulse response, such as the sinc function for a low-pass filter, $h_d[n]$. To make this practical, it must be truncated to a finite length $N$. This truncation is equivalent to multiplication by a rectangular window of length $N$. In the frequency domain, this corresponds to the convolution of the ideal frequency response $H_d(e^{j\\omega})$ with the Fourier transform of the rectangular window. The sharp discontinuities in the ideal frequency response (e.g., at the passband edge) convolved with the sinc-like spectrum of the rectangular window result in ripples in both the passband and stopband. This oscillatory artifact near discontinuities is known as the Gibbs phenomenon. A key property of this phenomenon is that the peak amplitude of the ripple does not decrease as the filter length $N$ increases; it merely compresses towards the discontinuity.\n\nTo control this behavior, non-rectangular windows are employed to taper the impulse response, reducing the abruptness of the truncation. The Kaiser window is a parametric window widely used for this purpose because it provides an adjustable shape parameter, $\\beta$, which controls the trade-off between the main-lobe width and the side-lobe attenuation of the window's spectrum. A larger $\\beta$ leads to higher sidelobe attenuation (i.e., lower stopband ripple, or higher $A_s$) at the cost of a wider main lobe (i.e., a wider transition band, $\\Delta \\omega$).\n\nThe Kaiser window of length $N$ is defined by the filter order $M=N-1$ and the parameter $\\beta$ as:\n$$ w[n] = \\frac{I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{2n - M}{M}\\right)^2}\\right)}{I_0(\\beta)}, \\quad 0 \\le n \\le M $$\nwhere $I_0(\\cdot)$ is the modified Bessel function of the first kind of order zero.\n\nJames Kaiser developed a set of highly accurate empirical formulas that connect the filter specifications ($A_s$, $\\Delta\\omega$) to the required window parameters ($N$, $\\beta$).\n\nFirst, the parameter $\\beta$ can be determined from the stopband attenuation $A_s$ (in positive decibels). The relationship is piecewise:\n$$ \\beta = \\begin{cases} 0  \\text{if } A_s  21 \\\\ 0.5842(A_s - 21)^{0.4} + 0.07886(A_s - 21)  \\text{if } 21 \\le A_s \\le 50 \\\\ 0.1102(A_s - 8.7)  \\text{if } A_s  50 \\end{cases} $$\nA value of $A_s  21$ dB corresponds to a rectangular window ($\\beta=0$), as this is the approximate attenuation provided by simple truncation.\n\nSecond, the filter order $M = N-1$ is related to $A_s$ and the normalized transition width $\\Delta\\omega$ (in radians/sample) by the formula:\n$$ M \\approx \\frac{A_s - 8}{2.285 \\Delta \\omega} $$\nThis formula is generally valid for $A_s  21$. The problem statement requires us to infer the transition width $\\Delta\\omega$ given $N$ and $A_s$. By rearranging this expression, we obtain the formula for $\\Delta \\omega$:\n$$ \\Delta \\omega \\approx \\frac{A_s - 8}{2.285 M} = \\frac{A_s - 8}{2.285 (N-1)} $$\nWe will apply this formula across all test cases as it reflects the properties of the Kaiser design framework, even in the region where $\\beta$ becomes zero. A negative result from the numerator, $A_s - 8  0$, would indicate that the provided specifications are unachievable, but the given test cases are physically meaningful. Note that the constant in the numerator is sometimes cited as $7.95$, but $8$ is a common and acceptable approximation.\n\nWe proceed to apply these formulas to the given test cases.\n\n**Case 1:** $(N, A_s) = (51, 60)$\nThe order is $M = 51 - 1 = 50$. The attenuation $A_s = 60$ dB is greater than $50$.\n$$ \\beta = 0.1102(60 - 8.7) = 0.1102(51.3) = 5.65326 $$\n$$ \\Delta \\omega = \\frac{60 - 8}{2.285(50)} = \\frac{52}{114.25} \\approx 0.455142232 \\ldots $$\nRounded to six decimal places, $\\beta = 5.653260$ and $\\Delta \\omega = 0.455142$.\n\n**Case 2:** $(N, A_s) = (101, 30)$\nThe order is $M = 101 - 1 = 100$. The attenuation $A_s = 30$ dB is between $21$ and $50$.\n$$ \\beta = 0.5842(30 - 21)^{0.4} + 0.07886(30 - 21) = 0.5842(9^{0.4}) + 0.07886(9) \\approx 2.1166934 \\ldots $$\n$$ \\Delta \\omega = \\frac{30 - 8}{2.285(100)} = \\frac{22}{228.5} \\approx 0.096280087 \\ldots $$\nRounded to six decimal places, $\\beta = 2.116693$ and $\\Delta \\omega = 0.096280$.\n\n**Case 3:** $(N, A_s) = (64, 15)$\nThe order is $M = 64 - 1 = 63$. The attenuation $A_s = 15$ dB is less than $21$.\n$$ \\beta = 0 $$\n$$ \\Delta \\omega = \\frac{15 - 8}{2.285(63)} = \\frac{7}{143.955} \\approx 0.048626237 \\ldots $$\nRounded to six decimal places, $\\beta = 0.000000$ and $\\Delta \\omega = 0.048626$.\n\n**Case 4:** $(N, A_s) = (256, 21)$\nThe order is $M = 256 - 1 = 255$. The attenuation $A_s = 21$ dB is at the boundary of the lower two regions. The formula for the range $21 \\le A_s \\le 50$ is applicable.\n$$ \\beta = 0.5842(21 - 21)^{0.4} + 0.07886(21 - 21) = 0 $$\n$$ \\Delta \\omega = \\frac{21 - 8}{2.285(255)} = \\frac{13}{582.675} \\approx 0.022310330 \\ldots $$\nRounded to six decimal places, $\\beta = 0.000000$ and $\\Delta \\omega = 0.022310$.\n\n**Case 5:** $(N, A_s) = (33, 50)$\nThe order is $M = 33 - 1 = 32$. The attenuation $A_s = 50$ dB is at the boundary of the upper two regions. The formula for the range $21 \\le A_s \\le 50$ is applicable.\n$$ \\beta = 0.5842(50 - 21)^{0.4} + 0.07886(50 - 21) = 0.5842(29^{0.4}) + 0.07886(29) \\approx 4.544837 $$\n$$ \\Delta \\omega = \\frac{50 - 8}{2.285(32)} = \\frac{42}{73.12} \\approx 0.574405087 \\ldots $$\nRounded to six decimal places, $\\beta = 4.544837$ and $\\Delta \\omega = 0.574405$.\n\nThe computations are now complete. The final results will be formatted into a program as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Kaiser window parameter beta and transition width delta_omega\n    for given FIR filter length N and stopband attenuation As.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (51, 60),   # Case 1 (happy path, high attenuation)\n        (101, 30),  # Case 2 (mid-range attenuation)\n        (64, 15),   # Case 3 (low attenuation region)\n        (256, 21),  # Case 4 (boundary condition at As = 21)\n        (33, 50),   # Case 5 (boundary condition at As = 50)\n    ]\n\n    results = []\n    for case in test_cases:\n        N, As = case\n        \n        # Ensure As is a float for calculations\n        As = float(As)\n\n        # 1. Compute the Kaiser parameter beta based on stopband attenuation As.\n        # The relationship is a piecewise empirical formula.\n        beta = 0.0\n        if As  50.0:\n            beta = 0.1102 * (As - 8.7)\n        elif As = 21.0: # This branch includes As = 50 and As = 21\n            beta = 0.5842 * np.power(As - 21.0, 0.4) + 0.07886 * (As - 21.0)\n        else: # As  21.0\n            beta = 0.0\n\n        # Filter order M is N - 1.\n        M = float(N - 1)\n\n        # 2. Infer the approximate transition width delta_omega.\n        # This relationship is derived from the formula relating M, As, and delta_omega.\n        # The formula is generally valid for As  21, but we apply it as per the\n        # general Kaiser design framework.\n        if M  0:\n            delta_omega_numerator = As - 8.0\n            # Handle cases where As  8, although not in the test suite.\n            # A negative transition width is not physical. We clamp to 0.\n            if delta_omega_numerator  0:\n                delta_omega_numerator = 0.0\n                \n            delta_omega = delta_omega_numerator / (2.285 * M)\n        else: # Should not happen with N = 2 as per problem statement.\n            delta_omega = 0.0\n\n        # Round results to six decimal places.\n        beta_rounded = np.round(beta, 6)\n        delta_omega_rounded = np.round(delta_omega, 6)\n        \n        results.append([beta_rounded, delta_omega_rounded])\n\n    # Format the final output string to match the required format without extra spaces.\n    # Correct format: [[beta1,delta_omega1],[beta2,delta_omega2],...]\n    result_strings = []\n    for res in results:\n        # Format each inner list to ensure no space after the comma\n        result_strings.append(f\"[{res[0]:.6f},{res[1]:.6f}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2912694"}]}