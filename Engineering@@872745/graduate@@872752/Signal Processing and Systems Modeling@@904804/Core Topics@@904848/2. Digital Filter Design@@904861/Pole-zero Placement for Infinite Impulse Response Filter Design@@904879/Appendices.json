{"hands_on_practices": [{"introduction": "The second-order IIR resonator is a fundamental building block in digital signal processing, used to create sharp peaks in the frequency response. By placing a pair of complex-conjugate poles close to the unit circle, we can selectively amplify a narrow band of frequencies. This first practice invites you to analytically derive the exact magnitude of this resonant peak, providing a direct and tangible link between a pole's radius $r$ and the filter's maximum gain [@problem_id:2891823].", "problem": "A discrete-time second-order Infinite Impulse Response (IIR) resonator is realized by placing a complex-conjugate pole pair at radius $r$ and angles $\\pm \\omega_0$ in the $z$-plane, where $0r1$ and $0\\omega_0\\pi$. The resulting transfer function is\n$$\nH(z)=\\frac{1}{1-2 r \\cos \\omega_0 \\, z^{-1}+r^2 z^{-2}}.\n$$\nUsing only foundational definitions, namely that the frequency response is obtained by evaluating $z$ on the unit circle via $z = \\exp(j \\omega)$ and that the magnitude response at angular frequency $\\omega$ is $|H(\\exp(j \\omega))|$, analytically derive the magnitude at the resonant frequency $\\omega=\\omega_0$. Then, consider the quadrature-centered design with $\\omega_0=\\pi/2$ (radians) and simplify the resonant magnitude so that it depends only on $r$.\n\nProvide your final answer as a single closed-form analytic expression in $r$ only. No numerical approximation is required. Angles are specified in radians. Do not include any units in your final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique analytical solution. It is a standard exercise in the analysis of discrete-time systems. Therefore, the problem is valid. We proceed to the derivation.\n\nThe transfer function of the second-order IIR resonator is given by\n$$\nH(z)=\\frac{1}{1-2 r \\cos \\omega_0 \\, z^{-1}+r^2 z^{-2}}\n$$\nThe denominator polynomial, $A(z) = 1-2 r \\cos \\omega_0 \\, z^{-1}+r^2 z^{-2}$, can be factored based on its roots. The roots are the poles of the system, given as a complex-conjugate pair $p_1 = r\\exp(j\\omega_0)$ and $p_2 = r\\exp(-j\\omega_0)$. The denominator can thus be written as\n$$\nA(z) = (1 - p_1 z^{-1})(1 - p_2 z^{-1}) = (1 - r \\exp(j\\omega_0) z^{-1})(1 - r \\exp(-j\\omega_0) z^{-1})\n$$\nThe transfer function in factored form is\n$$\nH(z) = \\frac{1}{(1 - r \\exp(j\\omega_0) z^{-1})(1 - r \\exp(-j\\omega_0) z^{-1})}\n$$\nThe frequency response is obtained by evaluating $H(z)$ on the unit circle, which is defined by $z = \\exp(j \\omega)$, where $\\omega$ is the normalized angular frequency.\n$$\nH(\\exp(j \\omega)) = \\frac{1}{(1 - r \\exp(j\\omega_0) \\exp(-j\\omega))(1 - r \\exp(-j\\omega_0) \\exp(-j\\omega))}\n$$\nThis can be rewritten as\n$$\nH(\\exp(j \\omega)) = \\frac{1}{(1 - r \\exp(j(\\omega_0 - \\omega)))(1 - r \\exp(-j(\\omega_0 + \\omega)))}\n$$\nThe magnitude of the frequency response, $|H(\\exp(j \\omega))|$, is the product of the reciprocals of the magnitudes of the two terms in the denominator:\n$$\n|H(\\exp(j \\omega))| = \\frac{1}{|1 - r \\exp(j(\\omega_0 - \\omega))| \\cdot |1 - r \\exp(-j(\\omega_0 + \\omega))|}\n$$\nWe use the identity for the magnitude of a complex number of the form $1-w$: $|1-w|^2 = (1-w)(1-w^*) = 1 - (w+w^*) + |w|^2$. For $w = r\\exp(j\\theta)$, this becomes $|1-r\\exp(j\\theta)|^2 = 1 - 2r\\cos\\theta + r^2$. Thus, $|1-r\\exp(j\\theta)| = \\sqrt{1 - 2r\\cos\\theta + r^2}$.\nApplying this to our expression:\n$$\n|1 - r \\exp(j(\\omega_0 - \\omega))| = \\sqrt{1 - 2r\\cos(\\omega_0 - \\omega) + r^2}\n$$\n$$\n|1 - r \\exp(-j(\\omega_0 + \\omega))| = \\sqrt{1 - 2r\\cos(-(\\omega_0 + \\omega)) + r^2} = \\sqrt{1 - 2r\\cos(\\omega_0 + \\omega) + r^2}\n$$\nThe problem asks for the magnitude at the resonant frequency, which is given as $\\omega = \\omega_0$. We substitute this value into the magnitude expressions.\nFor the first term:\n$$\n|1 - r \\exp(j(\\omega_0 - \\omega_0))| = |1 - r \\exp(j0)| = |1 - r|\n$$\nSince the problem specifies $0  r  1$, the term $1-r$ is positive, so $|1-r| = 1-r$.\nFor the second term:\n$$\n|1 - r \\exp(-j(\\omega_0 + \\omega_0))| = |1 - r \\exp(-j2\\omega_0)| = \\sqrt{1 - 2r\\cos(-2\\omega_0) + r^2} = \\sqrt{1 - 2r\\cos(2\\omega_0) + r^2}\n$$\nTherefore, the magnitude at resonance is\n$$\n|H(\\exp(j \\omega_0))| = \\frac{1}{(1-r)\\sqrt{1 - 2r\\cos(2\\omega_0) + r^2}}\n$$\nThis completes the first part of the derivation.\n\nNow, we consider the specified quadrature-centered design where $\\omega_0 = \\pi/2$. We substitute this value into the general expression for the resonant magnitude.\n$$\n|H(\\exp(j \\pi/2))| = \\frac{1}{(1-r)\\sqrt{1 - 2r\\cos(2 \\cdot \\pi/2) + r^2}}\n$$\nWe evaluate the cosine term: $\\cos(2 \\cdot \\pi/2) = \\cos(\\pi) = -1$.\nSubstituting this result back into the expression gives:\n$$\n|H(\\exp(j \\pi/2))| = \\frac{1}{(1-r)\\sqrt{1 - 2r(-1) + r^2}} = \\frac{1}{(1-r)\\sqrt{1 + 2r + r^2}}\n$$\nThe expression under the square root is a perfect square: $1 + 2r + r^2 = (1+r)^2$.\nThus, the magnitude simplifies to:\n$$\n|H(\\exp(j \\pi/2))| = \\frac{1}{(1-r)\\sqrt{(1+r)^2}}\n$$\nSince $0  r  1$, the term $1+r$ is positive. Therefore, $\\sqrt{(1+r)^2} = 1+r$.\nThe final expression becomes:\n$$\n|H(\\exp(j \\pi/2))| = \\frac{1}{(1-r)(1+r)}\n$$\nUsing the identity for the difference of squares, $(a-b)(a+b) = a^2 - b^2$, we arrive at the final simplified form which depends only on $r$:\n$$\n|H(\\exp(j \\pi/2))| = \\frac{1}{1 - r^2}\n$$", "answer": "$$\\boxed{\\frac{1}{1-r^2}}$$", "id": "2891823"}, {"introduction": "While the peak gain is important, the sharpness of the resonance is often a critical design parameter, quantified by the 3-dB bandwidth, $\\Delta\\omega$. This exercise guides you through a powerful approximation for narrow-band filters, revealing a simple and elegant relationship between the pole radius $r$ and the bandwidth [@problem_id:2891849]. Mastering this derivation provides a vital rule of thumb for designing filters with a specific frequency selectivity.", "problem": "Consider a causal, stable, discrete-time Infinite Impulse Response (IIR) second-order resonator with complex-conjugate poles at radius $r \\in (0,1)$ and angle $\\omega_{0} \\in (0,\\pi)$, with transfer function\n$$\nH(z) \\;=\\; \\frac{1}{1 - 2 r \\cos(\\omega_{0}) z^{-1} + r^{2} z^{-2}} \\, .\n$$\nLet $H(e^{j\\omega})$ denote its frequency response on the unit circle. The magnitude-squared response $|H(e^{j\\omega})|^{2}$ exhibits a resonance near $\\omega=\\omega_{0}$. Define the $3\\,\\mathrm{dB}$ bandwidth $\\Delta\\omega$ (in radians per sample) as the full width at half maximum of the peak, i.e., the difference between the two frequencies $\\omega_{\\pm}$ satisfying\n$$\n|H(e^{j\\omega_{\\pm}})|^{2} \\;=\\; \\frac{1}{2}\\,|H(e^{j\\omega_{0}})|^{2} \\, ,\n$$\nwith $\\omega_{+}  \\omega_{0}  \\omega_{-}$, and set $\\Delta\\omega \\triangleq \\omega_{+} - \\omega_{-}$. Assume $r$ is close to $1$ and $\\omega_{0}$ is not too close to $0$ or $\\pi$ so that any factors in $|H(e^{j\\omega})|^{2}$ that are smooth in $\\omega$ around $\\omega_{0}$ can be treated as approximately constant over the narrow resonance. Starting from first principles (the definition of $H(e^{j\\omega})$ and the small-angle approximation for the cosine), derive the leading-order asymptotic expression for $\\Delta\\omega$ as a function of $r$ only. Express your final result as a closed-form analytic expression in radians per sample, retaining only the lowest-order term in $(1-r)$ and discarding all higher-order corrections. Your final answer must be a single analytic expression.", "solution": "The problem requires the derivation of the leading-order asymptotic expression for the $3\\,\\mathrm{dB}$ bandwidth, $\\Delta\\omega$, of a second-order IIR resonator. The analysis will begin from the provided transfer function and proceed by applying stated approximations.\n\nThe transfer function of the resonator is given as:\n$$\nH(z) = \\frac{1}{1 - 2r \\cos(\\omega_{0}) z^{-1} + r^{2} z^{-2}}\n$$\nThis corresponds to a system with a pair of complex-conjugate poles at $p = r e^{j\\omega_0}$ and $p^* = r e^{-j\\omega_0}$. The denominator can be written in factored form as $D(z) = (1 - p z^{-1})(1 - p^* z^{-1})$.\n\nThe frequency response is found by substituting $z = e^{j\\omega}$:\n$$\nH(e^{j\\omega}) = \\frac{1}{(1 - r e^{j\\omega_0} e^{-j\\omega})(1 - r e^{-j\\omega_0} e^{-j\\omega})} = \\frac{1}{(1 - r e^{j(\\omega_0 - \\omega)})(1 - r e^{-j(\\omega_0 + \\omega)})}\n$$\nThe magnitude-squared response, $|H(e^{j\\omega})|^2$, is the reciprocal of the product of the squared magnitudes of the two terms in the denominator:\n$$\n|H(e^{j\\omega})|^2 = \\frac{1}{|1 - r e^{j(\\omega_0 - \\omega)}|^2 |1 - r e^{-j(\\omega_0 + \\omega)}|^2}\n$$\nUsing the identity $|1 - a e^{j\\theta}|^2 = (1 - a\\cos\\theta)^2 + (-a\\sin\\theta)^2 = 1 - 2a\\cos\\theta + a^2$, we obtain the exact expression for the magnitude-squared response:\n$$\n|H(e^{j\\omega})|^2 = \\frac{1}{(1 - 2r\\cos(\\omega - \\omega_0) + r^2)(1 - 2r\\cos(\\omega + \\omega_0) + r^2)}\n$$\nThe resonance peak occurs at $\\omega \\approx \\omega_0$. For $r$ close to $1$, the resonance is sharp, which implies that the bandwidth $\\Delta\\omega$ is small. For frequencies $\\omega$ within this narrow band, the term $(1 - 2r\\cos(\\omega + \\omega_0) + r^2)$ is slowly varying because its argument $\\omega + \\omega_0 \\approx 2\\omega_0$ is not near a minimum or maximum of the cosine function (since $\\omega_0$ is not close to $0$ or $\\pi$). Following the problem's directive, we can approximate this term as a constant by evaluating it at the center of the resonance, $\\omega = \\omega_0$:\n$$\n1 - 2r\\cos(\\omega + \\omega_0) + r^2 \\approx 1 - 2r\\cos(2\\omega_0) + r^2\n$$\nThe response near the resonance is therefore approximated by:\n$$\n|H(e^{j\\omega})|^2 \\approx \\frac{1}{(1 - 2r\\cos(\\omega - \\omega_0) + r^2)(1 - 2r\\cos(2\\omega_0) + r^2)}\n$$\nLet the frequency deviation from the resonance center be $\\delta\\omega = \\omega - \\omega_0$. For $\\omega$ near $\\omega_0$, $\\delta\\omega$ is small. We employ the small-angle approximation for the cosine function, $\\cos(\\delta\\omega) \\approx 1 - \\frac{(\\delta\\omega)^2}{2}$. The rapidly varying term in the denominator becomes:\n$$\n1 - 2r\\cos(\\delta\\omega) + r^2 \\approx 1 - 2r\\left(1 - \\frac{(\\delta\\omega)^2}{2}\\right) + r^2 = 1 - 2r + r^2 + r(\\delta\\omega)^2 = (1-r)^2 + r(\\delta\\omega)^2\n$$\nSubstituting this back into the approximate response gives:\n$$\n|H(e^{j\\omega})|^2 \\approx \\frac{1}{[(1-r)^2 + r(\\delta\\omega)^2](1 - 2r\\cos(2\\omega_0) + r^2)}\n$$\nThe peak magnitude-squared response occurs at $\\omega = \\omega_0$, or $\\delta\\omega = 0$:\n$$\n|H(e^{j\\omega_0})|^2 \\approx \\frac{1}{(1-r)^2 (1 - 2r\\cos(2\\omega_0) + r^2)}\n$$\nThe $3\\,\\mathrm{dB}$ frequencies, $\\omega_{\\pm}$, are defined by the condition $|H(e^{j\\omega_{\\pm}})|^2 = \\frac{1}{2}|H(e^{j\\omega_0})|^2$. Let $\\delta\\omega_{\\pm} = \\omega_{\\pm} - \\omega_0$ be the corresponding deviations. Applying our approximation, we get:\n$$\n\\frac{1}{[(1-r)^2 + r(\\delta\\omega_{\\pm})^2](1 - 2r\\cos(2\\omega_0) + r^2)} = \\frac{1}{2} \\left( \\frac{1}{(1-r)^2 (1 - 2r\\cos(2\\omega_0) + r^2)} \\right)\n$$\nThe slowly varying term $(1 - 2r\\cos(2\\omega_0) + r^2)$ cancels from both sides, yielding a simpler equation for $\\delta\\omega_{\\pm}$:\n$$\n(1-r)^2 + r(\\delta\\omega_{\\pm})^2 = 2(1-r)^2\n$$\n$$\nr(\\delta\\omega_{\\pm})^2 = (1-r)^2\n$$\n$$\n(\\delta\\omega_{\\pm})^2 = \\frac{(1-r)^2}{r} \\implies \\delta\\omega_{\\pm} = \\pm \\frac{1-r}{\\sqrt{r}}\n$$\nThe two half-power frequencies are $\\omega_+ = \\omega_0 + \\frac{1-r}{\\sqrt{r}}$ and $\\omega_- = \\omega_0 - \\frac{1-r}{\\sqrt{r}}$. The $3\\,\\mathrm{dB}$ bandwidth $\\Delta\\omega$ is the difference between these two frequencies:\n$$\n\\Delta\\omega = \\omega_+ - \\omega_- = \\left(\\omega_0 + \\frac{1-r}{\\sqrt{r}}\\right) - \\left(\\omega_0 - \\frac{1-r}{\\sqrt{r}}\\right) = \\frac{2(1-r)}{\\sqrt{r}}\n$$\nFinally, the problem asks for the leading-order asymptotic expression for $r$ close to $1$. As $r \\to 1$, the term $(1-r)$ becomes small. For the lowest-order term in $(1-r)$, we can approximate the term $\\sqrt{r}$ in the denominator by its value at $r=1$, which is $1$.\n$$\n\\Delta\\omega \\approx 2(1-r)\n$$\nThis is the required closed-form analytic expression for the bandwidth, valid for poles very close to the unit circle.", "answer": "$$\n\\boxed{2(1-r)}\n$$", "id": "2891849"}, {"introduction": "The counterpart to creating a resonant peak is creating a null, which is the function of a notch filter. By strategically placing a pair of zeros near a pair of poles, we can attenuate a specific frequency. This practice explores the design of a notch filter and investigates a practical scenario where the zeros are placed slightly inside the unit circle [@problem_id:2891873]. Your task is to derive how this placement affects the ultimate depth of the notch, illustrating a key trade-off in filter design.", "problem": "A second-order Infinite Impulse Response (IIR) notch filter is formed by placing a complex-conjugate pair of zeros at radius $\\rho$ and angle $\\pm \\omega_{0}$ and a complex-conjugate pair of poles at radius $r$ and the same angles $\\pm \\omega_{0}$, with $0\\rho1$ and $0r1$. Let the unnormalized transfer function be\n$$\nH_{0}(z)=\\frac{1-2\\rho \\cos(\\omega_{0}) z^{-1}+\\rho^{2} z^{-2}}{1-2 r \\cos(\\omega_{0}) z^{-1}+r^{2} z^{-2}},\n$$\nand define the implemented section as $H(z)=K\\,H_{0}(z)$, where the scalar $K0$ is chosen so that the direct current (DC) response is unity, that is, $|H(e^{j 0})|=1$. Consider the notch centered at $\\omega_{0}=\\pi/2$ (radians).\n\nStarting only from the definitions of the $z$-transform frequency response $H(e^{j\\omega})$ and polynomial factorization into first-order terms corresponding to zeros and poles, derive a closed-form analytic expression for the linear notch depth $D(\\rho,r)$ defined as the magnitude of the frequency response at the notch frequency,\n$$\nD(\\rho,r)\\equiv \\left|H\\!\\left(e^{j\\omega_{0}}\\right)\\right| \\quad \\text{with} \\quad \\omega_{0}=\\frac{\\pi}{2}.\n$$\nYour derivation must explicitly determine $K$ from the unity-DC constraint and then evaluate the magnitude at the notch frequency. Conclude by expressing $D(\\rho,r)$ purely as a function of $\\rho$ and $r$, and explain why $\\rho1$ limits the maximum notch depth. Express the final answer as a single closed-form analytic expression. No numerical rounding is required.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the analysis of digital Infinite Impulse Response (IIR) filters. All necessary parameters and constraints are provided for a unique analytical solution. Therefore, the problem is valid, and we proceed with the derivation.\n\nThe task is to derive an expression for the notch depth $D(\\rho,r)$ of a specific second-order IIR filter. The derivation will be conducted in three stages: first, determination of the normalization constant $K$; second, evaluation of the frequency response at the notch frequency $\\omega_0$; and third, combination of these results to find $D(\\rho,r)$.\n\nThe problem begins with the unnormalized transfer function $H_0(z)$. The instructions demand starting from the factorization into first-order terms. A complex-conjugate pair of zeros is located at $z = \\rho e^{\\pm j\\omega_0}$, and a pair of poles is at $p = r e^{\\pm j\\omega_0}$. The transfer function is constructed from these poles and zeros as:\n$$\nH_0(z) = \\frac{(1 - \\rho e^{j\\omega_0}z^{-1})(1 - \\rho e^{-j\\omega_0}z^{-1})}{(1 - r e^{j\\omega_0}z^{-1})(1 - r e^{-j\\omega_0}z^{-1})}\n$$\nExpanding the numerator gives $1 - \\rho(e^{j\\omega_0} + e^{-j\\omega_0})z^{-1} + \\rho^2 z^{-2} = 1 - 2\\rho\\cos(\\omega_0)z^{-1} + \\rho^2 z^{-2}$. A similar expansion of the denominator gives $1 - 2r\\cos(\\omega_0)z^{-1} + r^2 z^{-2}$. This confirms the given form of $H_0(z)$.\n\nThe problem specifies the notch frequency $\\omega_0 = \\pi/2$. For this value, $\\cos(\\omega_0) = \\cos(\\pi/2) = 0$. The unnormalized transfer function simplifies to:\n$$\nH_0(z) = \\frac{1 - 2\\rho(0)z^{-1} + \\rho^2 z^{-2}}{1 - 2r(0)z^{-1} + r^2 z^{-2}} = \\frac{1 + \\rho^2 z^{-2}}{1 + r^2 z^{-2}}\n$$\nThe implemented transfer function is $H(z) = K H_0(z)$, where $K$ is a positive scalar constant. $K$ is determined by the condition that the DC response has unity magnitude, i.e., $|H(e^{j0})|=1$. The DC response corresponds to evaluating the z-transform at $z=e^{j0}=1$.\n$$\nH(e^{j0}) = H(1) = K H_0(1) = K \\frac{1 + \\rho^2 (1)^{-2}}{1 + r^2 (1)^{-2}} = K \\frac{1 + \\rho^2}{1 + r^2}\n$$\nThe unity-DC constraint is thus $|H(1)| = 1$. Since $K0$ and the parameters $\\rho$ and $r$ are positive, the term $\\frac{1+\\rho^2}{1+r^2}$ is strictly positive. The absolute value is redundant.\n$$\nK \\frac{1 + \\rho^2}{1 + r^2} = 1\n$$\nFrom this, we solve for the normalization constant $K$:\n$$\nK = \\frac{1 + r^2}{1 + \\rho^2}\n$$\nNow we can write the full transfer function $H(z)$:\n$$\nH(z) = \\left( \\frac{1 + r^2}{1 + \\rho^2} \\right) \\frac{1 + \\rho^2 z^{-2}}{1 + r^2 z^{-2}}\n$$\nNext, we must find the linear notch depth, defined as $D(\\rho,r) \\equiv |H(e^{j\\omega_0})|$. With $\\omega_0 = \\pi/2$, we evaluate the frequency response at $z = e^{j\\pi/2} = j$.\nThe evaluation of $H(z)$ at $z=j$ requires the term $z^{-2}$.\n$$\nz^{-2} = (j)^{-2} = \\frac{1}{j^2} = \\frac{1}{-1} = -1\n$$\nSubstituting $z^{-2} = -1$ into the expression for $H(z)$:\n$$\nH(e^{j\\pi/2}) = H(j) = \\left( \\frac{1 + r^2}{1 + \\rho^2} \\right) \\frac{1 + \\rho^2 (-1)}{1 + r^2 (-1)} = \\left( \\frac{1 + r^2}{1 + \\rho^2} \\right) \\frac{1 - \\rho^2}{1 - r^2}\n$$\nThe notch depth $D(\\rho,r)$ is the magnitude of this complex number. However, the expression is entirely real. The constraints $0  \\rho  1$ and $0  r  1$ ensure that every factor in this expression is positive: $(1+r^2)0$, $(1+\\rho^2)0$, $(1-\\rho^2)0$, and $(1-r^2)0$. Therefore, the magnitude is equal to the expression itself.\n$$\nD(\\rho,r) = \\left|H(e^{j\\pi/2})\\right| = \\left| \\left( \\frac{1 + r^2}{1 + \\rho^2} \\right) \\frac{1 - \\rho^2}{1 - r^2} \\right| = \\frac{(1 + r^2)(1 - \\rho^2)}{(1 + \\rho^2)(1 - r^2)}\n$$\nThis is the final closed-form expression for the notch depth as a function of $\\rho$ and $r$.\n\nFinally, the problem asks why the condition $\\rho  1$ limits the maximum notch depth. A \"deeper\" notch corresponds to a smaller value of the transmission magnitude $D(\\rho,r)$. An ideal, infinitely deep notch would have a transmission of zero at the notch frequency, meaning $D(\\rho,r) = 0$.\nObserving the derived expression for $D(\\rho,r)$, for it to be zero, the numerator $(1+r^2)(1-\\rho^2)$ must be zero. Since $r0$, $(1+r^2)$ is always greater than $1$. Thus, we require:\n$$\n1 - \\rho^2 = 0 \\implies \\rho^2 = 1\n$$\nSince $\\rho  0$ is given, this implies $\\rho=1$. A value of $\\rho=1$ places the filter's zeros directly on the unit circle at $z = e^{\\pm j\\pi/2}$. This is the condition for perfect cancellation and zero transmission at frequency $\\omega_0 = \\pi/2$.\nThe problem, however, imposes the strict inequality $0  \\rho  1$. This constraint forces the zeros to be strictly inside the unit circle. Consequently, the numerator term $(1-\\rho^2)$ is always strictly positive. As all other terms are also positive, the notch depth $D(\\rho,r)$ is always strictly greater than zero. The condition $\\rho1$ thus prevents the achievement of a perfect null, limiting the \"depth\" of the notch. One can approach an infinitesimally small depth by choosing $\\rho$ arbitrarily close to $1$, but a depth of exactly zero is unattainable under this constraint.", "answer": "$$\n\\boxed{\\frac{(1-\\rho^2)(1+r^2)}{(1-r^2)(1+\\rho^2)}}\n$$", "id": "2891873"}]}