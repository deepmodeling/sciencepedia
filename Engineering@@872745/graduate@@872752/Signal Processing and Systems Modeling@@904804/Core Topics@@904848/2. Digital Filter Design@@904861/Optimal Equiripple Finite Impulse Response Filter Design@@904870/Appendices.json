{"hands_on_practices": [{"introduction": "Before designing an equiripple filter, you must translate the desired performance from the familiar language of decibels into the linear terms that the optimization algorithm understands. This practice guides you through the essential process of converting passband ripple ($A_p$) and stopband attenuation ($A_s$) specifications into linear deviation values ($\\delta_p$ and $\\delta_s$) and the corresponding weight ratio needed for the Remez algorithm [@problem_id:2888701]. Mastering this conversion is the first step in bridging filter specifications with their mathematical implementation.", "problem": "A linear-phase optimal equiripple Finite Impulse Response (FIR) lowpass filter is to be designed by weighted minimax (Chebyshev) approximation of the desired magnitude response, which equals unity in the passband and zero in the stopband. The specifications are given in decibels: the passband ripple is at most $A_p = 0.25$ dB, and the minimum stopband attenuation is $A_s = 60$ dB.\n\nStarting from fundamental definitions, proceed as follows:\n- Use the definition of decibels for amplitude ratios, namely that for an amplitude ratio $r$, the level in decibels is $20 \\log_{10}(r)$, to derive the linear passband ripple $\\delta_p$ implied by $A_p$ by modeling the passband deviation as lying between $1 - \\delta_p$ and $1 + \\delta_p$.\n- Use the same decibel definition to derive the linear stopband ripple $\\delta_s$ implied by $A_s$ by modeling the maximum stopband magnitude as $\\delta_s$ relative to unity.\n- Using the definition of the weighted minimax criterion for two disjoint bands with constant band-weights, deduce the weight ratio $w_s/w_p$ required to equalize the maximum weighted errors in the passband and stopband.\n\nCompute the numerical value of $w_s/w_p$ for the given $A_p$ and $A_s$, and round your answer to four significant figures. Express the final answer as a dimensionless number with no units.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It represents a standard problem in the field of digital signal processing. We may therefore proceed with a formal solution.\n\nThe problem requires the derivation and computation of the weight ratio $w_s/w_p$ for an optimal equiripple lowpass filter design based on given specifications in decibels. The solution is developed from fundamental principles as specified.\n\nFirst, we determine the linear passband ripple, $\\delta_p$, from the passband ripple specification in decibels, $A_p$. The problem states that the desired magnitude response in the passband is unity, and the actual filter's magnitude response, denoted $|H(\\omega)|$, deviates such that it is bounded between $1 - \\delta_p$ and $1 + \\delta_p$. The decibel level $A_p$ is defined for an amplitude ratio $r$ as $20 \\log_{10}(r)$. For passband ripple, this ratio is taken between the maximum and minimum amplitudes within the passband.\nTherefore, the passband ripple $A_p$ is given by:\n$$ A_p = 20 \\log_{10}\\left(\\frac{1 + \\delta_p}{1 - \\delta_p}\\right) $$\nWe are given $A_p = 0.25 \\, \\text{dB}$. We solve for $\\delta_p$:\n$$ \\frac{A_p}{20} = \\log_{10}\\left(\\frac{1 + \\delta_p}{1 - \\delta_p}\\right) $$\nExponentiating both sides with base $10$ yields:\n$$ 10^{A_p/20} = \\frac{1 + \\delta_p}{1 - \\delta_p} $$\nTo isolate $\\delta_p$, we can rearrange the equation. Let $K = 10^{A_p/20}$.\n$$ K(1 - \\delta_p) = 1 + \\delta_p $$\n$$ K - K\\delta_p = 1 + \\delta_p $$\n$$ K - 1 = \\delta_p (1 + K) $$\n$$ \\delta_p = \\frac{K - 1}{K + 1} = \\frac{10^{A_p/20} - 1}{10^{A_p/20} + 1} $$\n\nNext, we determine the linear stopband ripple, $\\delta_s$, from the minimum stopband attenuation, $A_s$. The desired response in the stopband is zero. The maximum magnitude of the filter in the stopband is denoted by $\\delta_s$. The stopband attenuation $A_s$ is the ratio of the unity reference level in the passband to this maximum stopband level, expressed in decibels.\n$$ A_s = 20 \\log_{10}\\left(\\frac{1}{\\delta_s}\\right) $$\nWe are given $A_s = 60 \\, \\text{dB}$. We solve for $\\delta_s$:\n$$ A_s = -20 \\log_{10}(\\delta_s) $$\n$$ \\frac{A_s}{-20} = \\log_{10}(\\delta_s) $$\nExponentiating both sides with base $10$ yields:\n$$ \\delta_s = 10^{-A_s/20} $$\n\nThe design is based on the weighted minimax criterion, which is the foundation of equiripple filters. The goal is to minimize the maximum weighted approximation error, $|E(\\omega)| = |W(\\omega)[H_d(\\omega) - H(\\omega)]|$, across all specified frequency bands. Here, $H_d(\\omega)$ is the ideal desired response and $W(\\omega)$ is a piecewise-constant weighting function. For an optimal filter, the maximum weighted error is equal in all bands.\nIn the passband, the desired response is $H_d(\\omega) = 1$ and the weighting is $w_p$. The maximum absolute error is $|1 - |H(\\omega)||_{\\max} = \\delta_p$. The maximum weighted error is $w_p \\delta_p$.\nIn the stopband, the desired response is $H_d(\\omega) = 0$ and the weighting is $w_s$. The maximum absolute error is $|0 - |H(\\omega)||_{\\max} = \\delta_s$. The maximum weighted error is $w_s \\delta_s$.\nThe equiripple condition requires these maximum weighted errors to be equal:\n$$ w_p \\delta_p = w_s \\delta_s $$\nFrom this equality, we deduce the required ratio of the stopband weight to the passband weight:\n$$ \\frac{w_s}{w_p} = \\frac{\\delta_p}{\\delta_s} $$\n\nNow, we substitute the expressions for $\\delta_p$ and $\\delta_s$ into this ratio:\n$$ \\frac{w_s}{w_p} = \\frac{1}{10^{-A_s/20}} \\left( \\frac{10^{A_p/20} - 1}{10^{A_p/20} + 1} \\right) $$\nWe are given the numerical values $A_p = 0.25$ and $A_s = 60$.\nFirst, we compute the linear ripples:\nFor the passband:\n$$ \\delta_p = \\frac{10^{0.25/20} - 1}{10^{0.25/20} + 1} = \\frac{10^{0.0125} - 1}{10^{0.0125} + 1} $$\n$10^{0.0125} \\approx 1.02919311$.\n$$ \\delta_p \\approx \\frac{1.02919311 - 1}{1.02919311 + 1} = \\frac{0.02919311}{2.02919311} \\approx 0.01438685 $$\nFor the stopband:\n$$ \\delta_s = 10^{-60/20} = 10^{-3} = 0.001 $$\nFinally, we compute the weight ratio:\n$$ \\frac{w_s}{w_p} = \\frac{\\delta_p}{\\delta_s} \\approx \\frac{0.01438685}{0.001} = 14.38685 $$\nThe problem requires the answer to be rounded to four significant figures. The fifth significant digit is $6$, so we round up the fourth digit.\n$$ \\frac{w_s}{w_p} \\approx 14.39 $$\nThis is a dimensionless quantity as it is a ratio of two weights.", "answer": "$$\n\\boxed{14.39}\n$$", "id": "2888701"}, {"introduction": "Optimal filter design is not just about meeting ripple specifications; it's also about choosing the correct filter structure for the task. This exercise explores how the fundamental symmetry of a linear-phase FIR filter pre-determines its behavior at the critical frequencies of $\\omega=0$ and $\\omega=\\pi$, allowing you to select a filter type that inherently provides required spectral nulls [@problem_id:2888730]. This knowledge is crucial for designing specialized filters like differentiators or Hilbert transformers where specific frequency points must be zero.", "problem": "You are designing an optimal equiripple Finite Impulse Response (FIR) filter with linear phase for use in a multi-band system model. The Discrete-Time Fourier Transform (DTFT) of the impulse response $h[n]$ is $H(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}\\omega n}$ for a filter of length $M$. In the linear-phase class, the impulse response satisfies a symmetry constraint of the form $h[n] = s\\,h[M-1-n]$ for all $n$, where $s \\in \\{+1,-1\\}$ denotes even symmetry ($s=+1$) or odd symmetry ($s=-1$), and $M$ can be even or odd.\n\nYou are given design constraints that the discrete-time frequency response must satisfy $H(\\mathrm{e}^{\\mathrm{j}0})=0$ and $H(\\mathrm{e}^{\\mathrm{j}\\pi})\\neq 0$. For use with an equiripple algorithm, you must select a linear-phase type whose structural symmetry guarantees $H(\\mathrm{e}^{\\mathrm{j}0})=0$ while not structurally forcing $H(\\mathrm{e}^{\\mathrm{j}\\pi})=0$. That is, the feasibility requirement is that the constraint at $\\omega=0$ must be an inherent consequence of the symmetry, whereas the nonzero requirement at $\\omega=\\pi$ must be compatible with, but not contradicted by, the same symmetry.\n\nStarting only from the DTFT definition and the linear-phase symmetry $h[n] = s\\,h[M-1-n]$, determine the feasible linear-phase type(s) under this structural requirement and construct the corresponding symmetry constraints on $h[n]$. Represent the selected type in terms of the pair $(s,r)$, where $s \\in \\{+1,-1\\}$ is the symmetry sign and $r \\in \\{0,1\\}$ is the parity indicator $r \\equiv M \\bmod 2$ ($r=0$ for even $M$, $r=1$ for odd $M$). As your final answer, return the $2$-entry row vector $[s\\;\\; r]$ written as a single row matrix. If more than one type satisfies the structural feasibility requirement, choose the one for which $H(\\mathrm{e}^{\\mathrm{j}\\pi})$ is generically nonzero (i.e., not identically zero for all impulses obeying the symmetry). No rounding is required. Do not include units. Angles are in radians.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and complete. It constitutes a standard analysis problem in the theory of digital filter design. It is therefore valid and a solution will be provided.\n\nThe objective is to identify which of the four types of linear-phase Finite Impulse Response (FIR) filters satisfies two specific structural requirements on its frequency response $H(\\mathrm{e}^{\\mathrm{j}\\omega})$ at the frequencies $\\omega=0$ and $\\omega=\\pi$. The frequency response is defined by the Discrete-Time Fourier Transform (DTFT) of the filter's impulse response $h[n]$ of length $M$:\n$$H(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}\\omega n}$$\nThe linear-phase property is enforced by the symmetry constraint on the impulse response coefficients:\n$$h[n] = s\\,h[M-1-n], \\quad \\text{for } n=0, 1, \\dots, M-1$$\nwhere $s \\in \\{+1, -1\\}$ determines the type of symmetry (even or odd). The filter length $M$ can be odd or even. These two parameters define the four distinct types of linear-phase FIR filters. The type is to be represented as a pair $(s, r)$, where $r = M \\pmod 2$.\n\nThe structural requirements are:\n1.  The condition $H(\\mathrm{e}^{\\mathrm{j}0}) = 0$ must be inherently guaranteed by the chosen symmetry type for any valid impulse response $h[n]$.\n2.  The condition $H(\\mathrm{e}^{\\mathrm{j}\\pi}) \\neq 0$ must be possible, meaning the symmetry type must not structurally force $H(\\mathrm{e}^{\\mathrm{j}\\pi})$ to be zero for every valid $h[n]$.\n\nWe evaluate the frequency response at $\\omega=0$ and $\\omega=\\pi$:\nAt $\\omega=0$, the response is the sum of the impulse response coefficients:\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}0 \\cdot n} = \\sum_{n=0}^{M-1} h[n]$$\nAt $\\omega=\\pi$, the response is the alternating sum of the impulse response coefficients:\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n]\\mathrm{e}^{-\\mathrm{j}\\pi n} = \\sum_{n=0}^{M-1} h[n](-1)^n$$\n\nWe now analyze each of the four filter types.\n\n**Type I: Even Symmetry ($s=+1$), Odd Length ($M$ odd)**\nLet $M=2L+1$ for some integer $L \\ge 0$. The symmetry is $h[n]=h[M-1-n]$. There is a central coefficient at $n=L=(M-1)/2$.\nThe sum of coefficients is:\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n] = \\sum_{n=0}^{2L} h[n] = h[L] + \\sum_{n=0}^{L-1}(h[n] + h[2L-n])$$\nUsing the symmetry $h[2L-n] = h[n]$, this becomes:\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = h[L] + 2\\sum_{n=0}^{L-1}h[n]$$\nThis expression is not structurally zero. Thus, Type I filters violate the first requirement.\n\n**Type II: Even Symmetry ($s=+1$), Even Length ($M$ even)**\nLet $M=2L$ for some integer $L \\ge 1$. The symmetry is $h[n]=h[M-1-n]$. There is no central coefficient.\nThe evaluation at $\\omega=\\pi$ gives:\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n](-1)^n = \\sum_{n=0}^{2L-1} h[n](-1)^n = \\sum_{n=0}^{L-1} \\left( h[n](-1)^n + h[2L-1-n](-1)^{2L-1-n} \\right)$$\nUsing the symmetry $h[2L-1-n] = h[n]$ and the property $(-1)^{2L-1-n} = -(-1)^{-n} = -(-1)^n$, each term in the sum becomes:\n$$h[n](-1)^n + h[n](-(-1)^n) = 0$$\nTherefore, $H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 0$ for any set of coefficients obeying Type II symmetry. This violates the second requirement that $H(\\mathrm{e}^{\\mathrm{j}\\pi})$ not be structurally zero.\n\n**Type III: Odd Symmetry ($s=-1$), Odd Length ($M$ odd)**\nLet $M=2L+1$. The symmetry is $h[n]=-h[M-1-n]$. For the central coefficient at $n=L$, we have $h[L]=-h[M-1-L] = -h[L]$, which implies $2h[L]=0$ and thus $h[L]=0$.\nThe sum of coefficients is:\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n] = h[L] + \\sum_{n=0}^{L-1}(h[n] + h[2L-n])$$\nSince $h[L]=0$ and $h[2L-n]=-h[n]$, this becomes:\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = 0 + \\sum_{n=0}^{L-1}(h[n] - h[n]) = 0$$\nThis is structurally zero, satisfying the first requirement.\nNow, we evaluate the response at $\\omega=\\pi$:\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n](-1)^n = h[L](-1)^L + \\sum_{n=0}^{L-1} \\left( h[n](-1)^n + h[2L-n](-1)^{2L-n} \\right)$$\nUsing $h[L]=0$, $h[2L-n]=-h[n]$ and $(-1)^{2L-n} = (-1)^{-n} = (-1)^n$, each term in the summation is:\n$$h[n](-1)^n + (-h[n])(-1)^n = 0$$\nTherefore, $H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 0$. This is structurally zero and violates the second requirement.\n\n**Type IV: Odd Symmetry ($s=-1$), Even Length ($M$ even)**\nLet $M=2L$. The symmetry is $h[n]=-h[M-1-n]$.\nThe sum of coefficients is:\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{M-1} h[n] = \\sum_{n=0}^{2L-1} h[n] = \\sum_{n=0}^{L-1}(h[n] + h[2L-1-n])$$\nUsing the symmetry $h[2L-1-n]=-h[n]$, this becomes:\n$$H(\\mathrm{e}^{\\mathrm{j}0}) = \\sum_{n=0}^{L-1}(h[n] - h[n]) = 0$$\nThis is structurally zero, satisfying the first requirement.\nNow, we evaluate the response at $\\omega=\\pi$:\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = \\sum_{n=0}^{M-1} h[n](-1)^n = \\sum_{n=0}^{2L-1} h[n](-1)^n = \\sum_{n=0}^{L-1} \\left( h[n](-1)^n + h[2L-1-n](-1)^{2L-1-n} \\right)$$\nUsing $h[2L-1-n]=-h[n]$ and $(-1)^{2L-1-n}=-(-1)^n$, each term becomes:\n$$h[n](-1)^n + (-h[n])(-(-1)^n) = h[n](-1)^n + h[n](-1)^n = 2h[n](-1)^n$$\nThe sum is therefore:\n$$H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 2\\sum_{n=0}^{L-1} h[n](-1)^n$$\nThis sum is not structurally zero. For example, if we choose $h[0]=1$ and all other independent coefficients to be zero, $H(\\mathrm{e}^{\\mathrm{j}\\pi}) = 2$. Thus, it is possible for $H(\\mathrm{e}^{\\mathrm{j}\\pi})$ to be non-zero. This satisfies the second requirement.\n\nOnly the Type IV filter meets both structural requirements. The symmetry constraint for this type is $h[n] = -h[M-1-n]$ for an even filter length $M$. This corresponds to:\n-   Symmetry sign $s = -1$.\n-   Length parity $r = M \\pmod 2 = 0$ since $M$ is even.\n\nThe required pair $(s,r)$ is $(-1, 0)$. The final answer is to be presented as a row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  0\n\\end{pmatrix}\n}\n$$", "id": "2888730"}, {"introduction": "While order estimation formulas provide a good starting point, the ultimate goal is to find the filter of the absolute minimum order that satisfies all design constraints. This advanced practice challenges you to construct an iterative algorithm that automates this search process, systematically using the Remez algorithm with increasing filter orders until the specifications are met [@problem_id:2888670]. Developing this kind of automated workflow represents a key skill in practical signal processing, ensuring the most computationally efficient filter is designed.", "problem": "Design and analyze an iterative procedure for optimal equiripple linear-phase finite impulse response (FIR) filter synthesis that uses the Remez exchange algorithm with increasing filter order to meet specified passband and stopband ripple constraints. The task has two parts: an algorithmic construction and a termination proof.\n\nLet the desired response be of single-transition type (either low-pass or high-pass), with a piecewise-constant ideal magnitude response. Work with Type I linear-phase FIR filters of odd length, so the filter order is given by $N = L - 1$ where $L$ is the number of taps and $L$ is odd. Let the normalized digital frequency be $f \\in [0, 1]$, where $1$ denotes the Nyquist frequency, and let the discrete-time Fourier transform amplitude of the FIR be $A(f) \\triangleq \\lvert H(\\mathrm{e}^{\\mathrm{j}\\omega}) \\rvert$ with $\\omega = \\pi f$ in radians. Define the passband ripple constraint as $\\delta_p  0$ such that\n$$\n\\sup_{f \\in \\mathcal{P}} \\lvert A(f) - 1 \\rvert \\le \\delta_p,\n$$\nand the stopband leakage constraint as $\\delta_s  0$ such that\n$$\n\\sup_{f \\in \\mathcal{S}} \\lvert A(f) \\rvert \\le \\delta_s,\n$$\nwhere $\\mathcal{P}$ and $\\mathcal{S}$ denote the passband and stopband frequency sets, respectively.\n\nPart 1 (Algorithm). Starting from a valid fundamental base of approximation theory and linear systems—namely, the Chebyshev (minimax) approximation paradigm on a compact set with piecewise-constant desired amplitude and nonnegative band weights—develop an algorithm that:\n- Fixes a filter type (low-pass or high-pass), passband edge $f_p \\in (0, 1)$, stopband edge $f_s \\in (0, 1)$ with $0  f_p  f_s  1$, and positive ripples $\\delta_p, \\delta_s$.\n- For odd lengths $L = 3, 5, 7, \\dots$, invokes a weighted equiripple Remez design to produce coefficients that minimize the maximum weighted error on $\\mathcal{P} \\cup \\mathcal{S}$ for the chosen $L$ and fixed band weights. For each $L$, evaluate whether the amplitude constraints in the definitions above are satisfied (interpret angles in radians via $\\omega = \\pi f$). If not satisfied, increase $L$ and repeat. If satisfied, return the minimal order $N = L - 1$ that meets both constraints.\n- Use a dense uniform frequency grid to verify the inequalities, with at least $M = 16384$ points over $f \\in [0, 1]$.\n\nPart 2 (Termination). Prove that if there exists a finite-order Type I linear-phase FIR filter that satisfies the given $(\\delta_p, \\delta_s)$ constraints for the specified $(f_p, f_s)$ and filter type, then the iterative procedure of Part 1 terminates after finitely many steps with the minimal order $N$ meeting the constraints.\n\nYour program should implement the algorithm from Part 1 and compute the minimal order $N$ (an integer) for each of the following test specifications. Frequencies are normalized ($1$ is Nyquist), and angles are to be interpreted in radians through $\\omega = \\pi f$. No physical units are involved; report only integers.\n\nTest suite:\n- Case A (low-pass): $f_p = 0.2$, $f_s = 0.3$, $\\delta_p = 0.01$, $\\delta_s = 0.0015$.\n- Case B (high-pass): $f_s = 0.35$, $f_p = 0.5$, $\\delta_p = 0.005$, $\\delta_s = 0.002$.\n- Case C (low-pass): $f_p = 0.25$, $f_s = 0.38$, $\\delta_p = 0.02$, $\\delta_s = 0.01$.\n- Case D (high-pass): $f_s = 0.25$, $f_p = 0.4$, $\\delta_p = 0.008$, $\\delta_s = 0.004$.\n\nAcceptance criterion for each case:\n- For low-pass: verify $\\sup_{f \\in [0, f_p]} \\lvert A(f) - 1 \\rvert \\le \\delta_p$ and $\\sup_{f \\in [f_s, 1]} \\lvert A(f) \\rvert \\le \\delta_s$.\n- For high-pass: verify $\\sup_{f \\in [f_p, 1]} \\lvert A(f) - 1 \\rvert \\le \\delta_p$ and $\\sup_{f \\in [0, f_s]} \\lvert A(f) \\rvert \\le \\delta_s$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order A, B, C, D, for example $[N_A,N_B,N_C,N_D]$, where each $N_\\cdot$ is the minimal order found for that case.\n- There must be no additional output and no external input.\n\nImportant: Do not use or assume any unproven formulae for the minimal order. The algorithm must be derived and justified from the fundamental base described above. Any angles are in radians; report only integers for $N$ for each case in the specified output format.", "solution": "The problem statement has been subjected to rigorous validation and is determined to be valid. It is scientifically grounded in the established theory of digital signal processing and Chebyshev approximation, is well-posed with clear and objective criteria, and is free of internal contradictions or debilitating ambiguity. The problem constitutes a standard, albeit non-trivial, exercise in optimal filter design. We may therefore proceed with a formal solution.\n\nThe solution is presented in two parts as requested: the algorithmic construction and the termination proof.\n\n**Part 1: Algorithmic Construction**\n\nThe task of designing an optimal equiripple linear-phase Finite Impulse Response (FIR) filter is fundamentally a problem of best uniform approximation. For a Type I FIR filter of odd length $L = N+1 = 2k+1$, the amplitude response $A(\\omega)$, where $\\omega = \\pi f$ is the normalized angular frequency in radians and $f \\in [0, 1]$ is the normalized frequency with $f=1$ as Nyquist, is a real-valued, even function. It can be expressed as a trigonometric polynomial:\n$$A(\\omega) = \\sum_{n=0}^{k} a_n \\cos(n\\omega)$$\nBy substituting $x = \\cos(\\omega)$, this expression becomes a standard polynomial of degree $k$ in the variable $x$. The design problem is thus transformed into finding the polynomial $P_k(x)$ that best approximates a desired response $D(x)$ on a set of disjoint intervals corresponding to the passbands and stopbands.\n\nThe notion of \"best\" approximation is in the Chebyshev (or minimax) sense, which seeks to minimize the maximum weighted error. The objective function is:\n$$ \\min_{P_k} \\left\\{ \\max_{x \\in \\text{Bands}} |W(x) [D(x) - P_k(x)]| \\right\\} $$\nHere, $D(x)$ is the desired piecewise-constant response ($1$ in the passband, $0$ in the stopband) and $W(x)$ is a positive weight function. The Parks-McClellan algorithm, which is an application of the Remez exchange algorithm to this specific problem, provides the unique polynomial solution.\n\nThe problem specifies separate constraints for the passband ripple, $\\delta_p$, and the stopband attenuation, $\\delta_s$. Let the achieved ripples for a given filter design be $\\delta'_p$ and $\\delta'_s$. The design is successful if $\\delta'_p \\le \\delta_p$ and $\\delta'_s \\le \\delta_s$. The Remez algorithm minimizes a single maximum weighted error, which we denote $\\delta_{minimax}$. The actual ripples are related to this error by $\\delta'_p = \\delta_{minimax}/W_p$ and $\\delta'_s = \\delta_{minimax}/W_s$, where $W_p$ and $W_s$ are the weights in the passband and stopband, respectively. To construct a filter that optimally balances the two constraints, the weights must be set to equalize the relative error with respect to the specifications. This is achieved by setting the ratio of weights to be the inverse of the ratio of the desired ripples:\n$$ \\frac{W_p}{W_s} = \\frac{\\delta_s}{\\delta_p} $$\nA convenient choice is $W_p = \\delta_s$ and $W_s = \\delta_p$, or any pair with this ratio, e.g., $W_p = \\delta_s/\\delta_p$ and $W_s = 1$. With such weights, the resulting equiripple filter will have actual ripples satisfying $\\delta'_p / \\delta'_s = \\delta_p / \\delta_s$. The acceptance check then simplifies to verifying if $\\delta'_p \\le \\delta_p$ (which automatically implies $\\delta'_s \\le \\delta_s$).\n\nThe core of the problem is to find the minimum filter order $N$ that satisfies the specifications. This is accomplished via a systematic, iterative search.\n\nThe algorithm proceeds as follows:\n1. Initialize filter order $N=2$ (corresponding to length $L=3$). Subsequent orders tested are $N=4, 6, 8, \\dots$, to maintain the Type I filter structure (odd length).\n2. For a given even order $N=2k$:\n   a. Define the frequency bands, desired response, and weights. For a low-pass filter with passband edge $f_p$ and stopband edge $f_s$, the bands are $[0, f_p]$ and $[f_s, 1]$. The desired response is $1$ and $0$ on these bands, respectively. The weights are set to $W_p = \\delta_s/\\delta_p$ and $W_s = 1$. For a high-pass filter, the bands are $[0, f_s]$ (stopband) and $[f_p, 1]$ (passband), with desired response $0$ and $1$, and weights $W_s=1$ and $W_p=\\delta_s/\\delta_p$.\n   b. Employ the Remez algorithm (e.g., as implemented in `scipy.signal.remez`) to compute the filter impulse response coefficients $h[n]$ for length $L = N+1$.\n   c. Compute the filter's amplitude response $A(f)$ on a dense frequency grid of $M=16384$ points over the normalized frequency range $f \\in [0, 1]$.\n   d. Verify the constraints by calculating the maximum achieved ripples:\n      i. Passband ripple: $\\delta_p' = \\sup_{f \\in \\mathcal{P}} \\lvert A(f) - 1 \\rvert$.\n      ii. Stopband ripple: $\\delta_s' = \\sup_{f \\in \\mathcal{S}} \\lvert A(f) \\rvert$.\n   e. If $\\delta_p' \\le \\delta_p$ and $\\delta_s' \\le \\delta_s$, the current order $N$ is the minimal order meeting the criteria, because the search is sequential from the smallest possible order. The algorithm terminates and returns this value of $N$.\n   f. If the constraints are not met, increment the order, $N \\to N+2$, and repeat the process from step 2a.\n\n**Part 2: Proof of Termination**\n\nThe proof that the iterative procedure is guaranteed to terminate after a finite number of steps is based on fundamental properties of best polynomial approximation.\n\n**Premise**: We are given that there exists at least one Type I linear-phase FIR filter of some finite order, say $N_{sol}$, which satisfies the given ripple constraints $(\\delta_p, \\delta_s)$ for the specified band edges $(f_p, f_s)$. Let $N_{min}^*$ be the minimal such even order for which a solution exists.\n\n**Monotonicity of Approximation Error**: For a fixed approximation problem (i.e., fixed bands, desired function, and weight function), the minimum achievable weighted approximation error, $\\delta_{minimax}$, is a monotonically non-increasing function of the polynomial degree $k$ (which corresponds to filter order $N=2k$). For approximation on disjoint intervals with a non-zero transition band ($f_s - f_p  0$), this relationship is strictly monotonic:\n$$ \\delta_{minimax}(k+1)  \\delta_{minimax}(k) $$\nThis property ensures that increasing the filter order always enables a better approximation, resulting in strictly smaller achievable ripples.\n\n**Termination Argument**:\n1. The algorithm tests a monotonically increasing sequence of even orders $N_i = 2i$ for $i=1, 2, 3, \\dots$.\n2. For each order $N_i$, the algorithm constructs the optimal filter in the minimax sense with the prescribed weight ratio. Let the resulting passband and stopband ripples be $\\delta_p'(N_i)$ and $\\delta_s'(N_i)$.\n3. Due to the strict monotonicity property, the sequences of achieved ripples $\\{\\delta_p'(N_i)\\}$ and $\\{\\delta_s'(N_i)\\}$ are strictly decreasing as $i$ increases. Furthermore, it is known that as $N_i \\to \\infty$, both $\\delta_p'(N_i) \\to 0$ and $\\delta_s'(N_i) \\to 0$.\n4. By our initial premise, a solution exists for the finite order $N_{min}^*$. The filter designed by our algorithm for order $N_{min}^*$ is, by definition, the optimal filter in the Parks-McClellan sense. It must perform at least as well as (and generally better than) any other arbitrary filter of the same order. Therefore, the filter designed by our algorithm for order $N_{min}^*$ is guaranteed to meet the specifications $(\\delta_p, \\delta_s)$.\n5. The algorithm's search begins at $N=2$ and proceeds sequentially through all even integers. The sequence of tested orders $\\{2, 4, 6, \\dots\\}$ is unbounded and will therefore eventually reach the order $N_{min}^*$.\n6. Upon testing order $N_{min}^*$, the algorithm will find that the constraints are satisfied and will terminate. Because the search is sequential and monotonic in order, the first order for which it terminates is guaranteed to be the minimal required even order.\n\nThus, under the given premise that a solution of finite order exists, the algorithm is guaranteed to find the minimal order solution in a finite number of steps.", "answer": "[42,32,24,28]", "id": "2888670"}]}