{"hands_on_practices": [{"introduction": "The first step in comparing window functions is to analyze their spectral shape, with the most prominent feature being the mainlobe. The width of this mainlobe determines the spectral resolution—the ability to distinguish between two closely spaced frequency components. This practice guides you through deriving the mainlobe width for different windows, revealing a direct link between a window's mathematical definition and its resolving power, a foundational concept in understanding windowing trade-offs. [@problem_id:2895210]", "problem": "Consider three finite-duration deterministic windows of length $N \\in \\mathbb{N}$, defined for $n \\in \\{0,1,\\dots,N-1\\}$ by:\n- Rectangular: $w_{\\mathrm{rect}}[n] = 1$.\n- Hann (also called Hanning): $w_{\\mathrm{Hann}}[n] = \\tfrac{1}{2} - \\tfrac{1}{2} \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$.\n- Hamming: $w_{\\mathrm{Hamming}}[n] = 0.54 - 0.46 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$.\n- Blackman: $w_{\\mathrm{Blackman}}[n] = 0.42 - 0.5 \\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\!\\left(\\tfrac{4\\pi n}{N-1}\\right)$.\n\nLet $W(\\omega)$ denote the Discrete-Time Fourier Transform (DTFT) of a window $w[n]$, defined by $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\, \\exp(-j \\omega n)$ for real radian frequency $\\omega$. Define the mainlobe width as the null-to-null distance in $\\omega$ (in radians) between the first negative and first positive zeros of $\\lvert W(\\omega) \\rvert$ closest to the origin.\n\nStarting only from the DTFT definition and the asymptotic Riemann-sum approximation for large $N$, model $w[n]$ as samples of a smooth function $g(t)$ on the unit interval via $t = n/(N-1)$, and use the large-$N$ scaling $W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp\\!\\big(-j \\omega (N-1) t\\big) \\, dt$. By evaluating the first spectral zeros of the integral kernel at harmonics of $2\\pi$, determine the scaling of the mainlobe width with $N$ for each window and extract the proportionality constants relative to the rectangular window baseline (that is, constants $\\kappa$ such that, for large $N$, $\\Delta \\omega_{\\mathrm{window}} \\approx \\kappa \\, \\Delta \\omega_{\\mathrm{rect}}$).\n\nYou must:\n1. Justify the scaling with $N$ from first principles using the integral approximation and properties of $\\int_{0}^{1} \\exp(-j 2\\pi k t) \\, dt$ for integer $k$.\n2. Determine, for each window, the location of the first positive null in $\\omega$ (in radians), and hence the null-to-null mainlobe width, in the large-$N$ limit.\n3. Report the three proportionality constants relative to the rectangular window in the order Hann, Hamming, Blackman.\n\nExpress the final answer as a row matrix containing the three proportionality constants in the order Hann, Hamming, Blackman, with no units. No numerical rounding is required. All angles are in radians.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. There are no contradictions, missing information, or violations of scientific principles. A solution will be derived.\n\nThe Discrete-Time Fourier Transform (DTFT) of a window $w[n]$ of length $N$ is given by $W(\\omega) = \\sum_{n=0}^{N-1} w[n] \\exp(-j \\omega n)$. For large $N$, this sum can be approximated by an integral. By defining a continuous variable $t = \\frac{n}{N-1}$ for $n \\in \\{0, 1, \\dots, N-1\\}$, the discrete window $w[n]$ is modeled as samples of a continuous function $g(t)$ on the interval $t \\in [0, 1]$. The DTFT is then approximated as a Riemann sum:\n$$ W(\\omega) \\approx \\sum_{n=0}^{N-1} g\\left(\\frac{n}{N-1}\\right) \\exp\\left(-j \\omega (N-1) \\frac{n}{N-1}\\right) \\Delta n $$\nWith $\\Delta n=1$, this becomes an integral over $t$:\n$$ W(\\omega) \\approx (N-1) \\int_{0}^{1} g(t) \\exp(-j \\omega (N-1) t) \\, dt $$\nLet us define a scaled frequency variable $\\Omega = \\omega(N-1)$. The integral kernel is the continuous Fourier transform of $g(t)$ with respect to this scaled frequency:\n$$ G(\\Omega) = \\int_{0}^{1} g(t) \\exp(-j \\Omega t) \\, dt $$\nThe DTFT is then $W(\\omega) \\approx (N-1) G(\\Omega)$. The zeros of $W(\\omega)$ for large $N$ correspond to the zeros of $G(\\Omega)$.\n\nThe analysis of each window function relies on the transform of a constant function over the interval $[0, 1]$, which we denote as $S(\\Omega)$:\n$$ S(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = \\left[ \\frac{\\exp(-j \\Omega t)}{-j \\Omega} \\right]_{0}^{1} = \\frac{1 - \\exp(-j \\Omega)}{j \\Omega} $$\nThis can be written as a phase-shifted sinc function:\n$$ S(\\Omega) = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\exp(j \\frac{\\Omega}{2}) - \\exp(-j \\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{2j \\sin(\\frac{\\Omega}{2})}{j \\Omega} = \\exp(-j \\frac{\\Omega}{2}) \\frac{\\sin(\\frac{\\Omega}{2})}{\\frac{\\Omega}{2}} $$\nThe zeros of $S(\\Omega)$ occur when $\\sin(\\Omega/2) = 0$ but $\\Omega \\ne 0$. This gives $\\frac{\\Omega}{2} = k\\pi$ for any non-zero integer $k$, so $\\Omega = 2k\\pi$ for $k \\in \\mathbb{Z} \\setminus \\{0\\}$. At $\\Omega=0$, we have $S(0) = \\int_0^1 1 \\, dt = 1$. Consequently, for integer $m$, $S(2\\pi m) = \\delta_{m,0}$, where $\\delta$ is the Kronecker delta.\n\nWe now analyze each window in turn.\n\n1.  **Rectangular Window**\n    The continuous model is $g_{\\mathrm{rect}}(t) = 1$ for $t \\in [0, 1]$.\n    The transform is $G_{\\mathrm{rect}}(\\Omega) = \\int_{0}^{1} 1 \\cdot \\exp(-j \\Omega t) \\, dt = S(\\Omega)$.\n    The first positive zero of $S(\\Omega)$ is at $\\Omega = 2\\pi$. Since $\\Omega = \\omega(N-1)$, the first positive null of $W(\\omega)$ is at $\\omega_1 = \\frac{2\\pi}{N-1}$. The mainlobe is symmetric, so the first negative null is at $\\omega_{-1} = -\\frac{2\\pi}{N-1}$.\n    The mainlobe width is defined as the null-to-null distance:\n    $$ \\Delta \\omega_{\\mathrm{rect}} = \\omega_1 - \\omega_{-1} = \\frac{2\\pi}{N-1} - \\left(-\\frac{2\\pi}{N-1}\\right) = \\frac{4\\pi}{N-1} $$\n    This establishes the base scaling with $N$ as $\\frac{1}{N-1}$ (or $\\frac{1}{N}$ for large $N$).\n\n2.  **Hann Window**\n    The continuous model is $g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{2} \\cos(2\\pi t)$. Using Euler's formula, $\\cos(x) = \\frac{1}{2}(\\exp(jx) + \\exp(-jx))$, we get:\n    $$ g_{\\mathrm{Hann}}(t) = \\frac{1}{2} - \\frac{1}{4} \\exp(j2\\pi t) - \\frac{1}{4} \\exp(-j2\\pi t) $$\n    By the linearity and frequency-shifting properties of the Fourier transform, its transform $G_{\\mathrm{Hann}}(\\Omega)$ is:\n    $$ G_{\\mathrm{Hann}}(\\Omega) = \\frac{1}{2} S(\\Omega) - \\frac{1}{4} S(\\Omega - 2\\pi) - \\frac{1}{4} S(\\Omega + 2\\pi) $$\n    We seek the first positive zero by evaluating at harmonics of $2\\pi$.\n    At $\\Omega=2\\pi$: $G_{\\mathrm{Hann}}(2\\pi) = \\frac{1}{2}S(2\\pi) - \\frac{1}{4}S(0) - \\frac{1}{4}S(4\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(1) - \\frac{1}{4}(0) = -\\frac{1}{4} \\ne 0$.\n    At $\\Omega=4\\pi$: $G_{\\mathrm{Hann}}(4\\pi) = \\frac{1}{2}S(4\\pi) - \\frac{1}{4}S(2\\pi) - \\frac{1}{4}S(6\\pi) = \\frac{1}{2}(0) - \\frac{1}{4}(0) - \\frac{1}{4}(0) = 0$.\n    The first positive zero is at $\\Omega = 4\\pi$. The first null of $W(\\omega)$ is at $\\omega_1 = \\frac{4\\pi}{N-1}$.\n    The mainlobe width is $\\Delta \\omega_{\\mathrm{Hann}} = 2 \\omega_1 = \\frac{8\\pi}{N-1}$.\n    The proportionality constant relative to the rectangular window is $\\kappa_{\\mathrm{Hann}} = \\frac{\\Delta \\omega_{\\mathrm{Hann}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$.\n\n3.  **Hamming Window**\n    The continuous model is $g_{\\mathrm{Hamming}}(t) = 0.54 - 0.46 \\cos(2\\pi t)$. This has the same functional form as the Hann window, $g(t) = a_0 - a_1 \\cos(2\\pi t)$.\n    The transform is $G_{\\mathrm{Hamming}}(\\Omega) = 0.54 S(\\Omega) - 0.23 (S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi))$.\n    The logic for finding zeros at harmonics of $2\\pi$ is identical.\n    At $\\Omega=2\\pi$: $G_{\\mathrm{Hamming}}(2\\pi) = 0.54 S(2\\pi) - 0.23 S(0) - 0.23 S(4\\pi) = -0.23 \\ne 0$.\n    At $\\Omega=4\\pi$: $G_{\\mathrm{Hamming}}(4\\pi) = 0.54 S(4\\pi) - 0.23 S(2\\pi) - 0.23 S(6\\pi) = 0$.\n    The first positive zero is also at $\\Omega = 4\\pi$. The mainlobe width is $\\Delta \\omega_{\\mathrm{Hamming}} = \\frac{8\\pi}{N-1}$.\n    The proportionality constant is $\\kappa_{\\mathrm{Hamming}} = \\frac{\\Delta \\omega_{\\mathrm{Hamming}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{8\\pi/(N-1)}{4\\pi/(N-1)} = 2$.\n\n4.  **Blackman Window**\n    The continuous model is $g_{\\mathrm{Blackman}}(t) = 0.42 - 0.5 \\cos(2\\pi t) + 0.08 \\cos(4\\pi t)$.\n    Using Euler's formula, the transform is composed of five shifted $S(\\Omega)$ functions:\n    $$ G_{\\mathrm{Blackman}}(\\Omega) = 0.42 S(\\Omega) - 0.25(S(\\Omega - 2\\pi) + S(\\Omega + 2\\pi)) + 0.04(S(\\Omega - 4\\pi) + S(\\Omega + 4\\pi)) $$\n    We check for zeros at harmonics of $2\\pi$:\n    At $\\Omega=2\\pi$: $G_{\\mathrm{Blackman}}(2\\pi) = 0.42 S(2\\pi) - 0.25(S(0)+S(4\\pi)) + 0.04(S(-2\\pi)+S(6\\pi)) = -0.25 \\ne 0$.\n    At $\\Omega=4\\pi$: $G_{\\mathrm{Blackman}}(4\\pi) = 0.42 S(4\\pi) - 0.25(S(2\\pi)+S(6\\pi)) + 0.04(S(0)+S(8\\pi)) = 0.04 \\ne 0$.\n    At $\\Omega=6\\pi$: $G_{\\mathrm{Blackman}}(6\\pi) = 0.42 S(6\\pi) - 0.25(S(4\\pi)+S(8\\pi)) + 0.04(S(2\\pi)+S(10\\pi)) = 0$.\n    The first positive zero is at $\\Omega = 6\\pi$. The first null is at $\\omega_1 = \\frac{6\\pi}{N-1}$.\n    The mainlobe width is $\\Delta \\omega_{\\mathrm{Blackman}} = 2 \\omega_1 = \\frac{12\\pi}{N-1}$.\n    The proportionality constant is $\\kappa_{\\mathrm{Blackman}} = \\frac{\\Delta \\omega_{\\mathrm{Blackman}}}{\\Delta \\omega_{\\mathrm{rect}}} = \\frac{12\\pi/(N-1)}{4\\pi/(N-1)} = 3$.\n\nIn summary, the mainlobe width for a window composed of cosines up to the $M$-th harmonic, $g(t) = \\sum_{k=0}^M a_k \\cos(2\\pi k t)$, has its first zero at $\\Omega=2\\pi(M+1)$ in this continuous approximation.\n- Rectangular: $M=0$, first null at $2\\pi$. Width factor $1$.\n- Hann/Hamming: $M=1$, first null at $4\\pi$. Width factor $2$.\n- Blackman: $M=2$, first null at $6\\pi$. Width factor $3$.\n\nThe proportionality constants for Hann, Hamming, and Blackman windows relative to the rectangular window are $2$, $2$, and $3$ respectively.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 2 & 3\n\\end{pmatrix}\n}\n$$", "id": "2895210"}, {"introduction": "While mainlobe width describes spectral resolution, the Equivalent Noise Bandwidth (ENBW) quantifies how a window affects the noise floor in a spectral estimate. The ENBW represents the bandwidth of an ideal rectangular filter that would pass the same amount of noise power as the window in question. By calculating the ENBW, you will connect the time-domain properties of a window to its performance in the presence of noise, a critical skill for designing robust signal detection systems. [@problem_id:2895221]", "problem": "An engineer uses three widely employed deterministic tapers—Hann (also called Hanning), Hamming, and Blackman—on a length-$N$ discrete-time record prior to computing a length-$N$ Discrete Fourier Transform (DFT). The cosine-sum windows are defined for $n \\in \\{0,1,\\dots,N-1\\}$ by\n- Hann: $w_{\\mathrm{Hann}}[n] = \\tfrac{1}{2} - \\tfrac{1}{2}\\cos\\!\\big(2\\pi n/(N-1)\\big)$,\n- Hamming: $w_{\\mathrm{Ham}}[n] = 0.54 - 0.46\\cos\\!\\big(2\\pi n/(N-1)\\big)$,\n- Blackman: $w_{\\mathrm{Blk}}[n] = 0.42 - 0.50\\cos\\!\\big(2\\pi n/(N-1)\\big) + 0.08\\cos\\!\\big(4\\pi n/(N-1)\\big)$,\n\nwhere all cosine arguments are in radians.\n\nConsider the Equivalent Noise Bandwidth (ENBW), defined as the bandwidth of an ideal rectangular filter that would pass the same mean noise power at the DFT output bin center as the actual windowed spectral response, when the input is discrete-time white noise with flat power spectral density. Work in the standard DFT frequency normalization where one bin corresponds to a frequency spacing of $1/N$ cycles per sample, so that the rectangular (no window) baseline ENBW is $1.0$ bin.\n\nStarting from the above definition of ENBW, Parseval’s theorem, and the Riemann-sum limit connecting sums to integrals as $N \\to \\infty$, derive an expression for the ENBW in units of DFT bins in the large-$N$ limit that depends only on window sample averages, and then evaluate it for the three windows given above. Report the three asymptotic ENBWs (in bins) in the order Hann, Hamming, Blackman. Round each value to four significant figures. Express the final answer as a single row vector.", "solution": "We begin from the definition of Equivalent Noise Bandwidth (ENBW) for a deterministic window $w[n]$ applied to white noise with flat power spectral density. The ENBW, in frequency units consistent with the discrete-time Fourier transform over normalized frequency $f \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$ (cycles per sample), is\n$$\nB_{\\mathrm{e}} \\equiv \\frac{\\displaystyle \\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df}{\\displaystyle \\big|W(0)\\big|^{2}},\n$$\nwhere $W(f) = \\sum_{n=0}^{N-1} w[n]\\exp(-j 2\\pi f n)$ is the window’s frequency response and $W(0) = \\sum_{n=0}^{N-1} w[n]$. To express ENBW in DFT “bins,” we divide by the bin spacing $\\Delta f = 1/N$, yielding\n$$\n\\mathrm{ENBW} \\, (\\text{bins}) \\;=\\; \\frac{B_{\\mathrm{e}}}{\\Delta f} \\;=\\; N \\,\\frac{\\displaystyle \\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df}{\\displaystyle \\big|W(0)\\big|^{2}}.\n$$\nBy Parseval’s theorem for the continuous-frequency Discrete-Time Fourier Transform (DTFT) convention used here,\n$$\n\\int_{-1/2}^{1/2} \\big|W(f)\\big|^{2}\\,df \\;=\\; \\sum_{n=0}^{N-1} w[n]^{2}.\n$$\nHence,\n$$\n\\mathrm{ENBW} \\, (\\text{bins}) \\;=\\; N \\,\\frac{\\displaystyle \\sum_{n=0}^{N-1} w[n]^{2}}{\\displaystyle \\Big(\\sum_{n=0}^{N-1} w[n]\\Big)^{2}}.\n$$\nWe now consider the large-$N$ limit for cosine-sum windows of the form $w[n] = g\\!\\big(\\tfrac{n}{N-1}\\big)$, where $g$ is smooth on $[0,1]$. Define the normalized index $x \\equiv n/(N-1) \\in [0,1]$. As $N \\to \\infty$, Riemann sums converge to integrals:\n$$\n\\sum_{n=0}^{N-1} w[n] \\;\\approx\\; N \\int_{0}^{1} g(x)\\,dx \\;\\equiv\\; N\\,\\mu,\n\\quad\n\\sum_{n=0}^{N-1} w[n]^{2} \\;\\approx\\; N \\int_{0}^{1} g(x)^{2}\\,dx \\;\\equiv\\; N\\,\\nu,\n$$\nwhere $\\mu$ and $\\nu$ are the first and second moment (means) of $w$ and $w^{2}$ over $x \\in [0,1]$, respectively. Therefore, the asymptotic ENBW in bins is\n$$\n\\lim_{N\\to\\infty} \\mathrm{ENBW} \\;=\\; \\lim_{N\\to\\infty} N \\,\\frac{N\\,\\nu}{(N\\,\\mu)^{2}} \\;=\\; \\frac{\\nu}{\\mu^{2}}.\n$$\nThus, it suffices to compute $\\mu$ and $\\nu$ for each window by averaging over $x \\in [0,1]$ using orthogonality of cosines:\n$$\n\\int_{0}^{1}\\cos(2\\pi k x)\\,dx = 0 \\;\\text{for}\\; k \\in \\mathbb{Z}\\setminus\\{0\\}, \n\\qquad\n\\int_{0}^{1}\\cos^{2}(2\\pi k x)\\,dx = \\frac{1}{2} \\;\\text{for}\\; k \\in \\mathbb{Z}\\setminus\\{0\\},\n$$\nand mixed products of different harmonics integrate to zero.\n\nHann window. Let $w(x) = \\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)$. Then\n$$\n\\mu_{\\mathrm{Hann}} = \\int_{0}^{1} \\Big(\\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)\\Big)\\,dx = \\tfrac{1}{2},\n$$\nand\n\\begin{align*}\n\\nu_{\\mathrm{Hann}} &= \\int_{0}^{1} \\Big(\\tfrac{1}{2} - \\tfrac{1}{2}\\cos(2\\pi x)\\Big)^{2} dx \\\\\n&= \\int_{0}^{1} \\Big(\\tfrac{1}{4} - \\tfrac{1}{2}\\cos(2\\pi x) + \\tfrac{1}{4}\\cos^{2}(2\\pi x)\\Big) dx \\\\\n&= \\tfrac{1}{4} + \\tfrac{1}{4}\\cdot \\tfrac{1}{2} \\;=\\; \\tfrac{3}{8}.\n\\end{align*}\nHence\n$$\n\\mathrm{ENBW}_{\\mathrm{Hann}} = \\frac{\\nu_{\\mathrm{Hann}}}{\\mu_{\\mathrm{Hann}}^{2}} = \\frac{\\tfrac{3}{8}}{(\\tfrac{1}{2})^{2}} = \\frac{3}{2} = 1.5 \\;\\text{bins}.\n$$\n\nHamming window. Let $w(x) = 0.54 - 0.46\\cos(2\\pi x)$. Then\n$$\n\\mu_{\\mathrm{Ham}} = 0.54,\n$$\nand\n\\begin{align*}\n\\nu_{\\mathrm{Ham}} &= \\int_{0}^{1} \\big(0.54 - 0.46\\cos(2\\pi x)\\big)^{2} dx \\\\\n&= 0.54^{2} + 0.46^{2}\\cdot \\tfrac{1}{2} \\\\\n&= \\frac{27^{2}}{50^{2}} + \\frac{1}{2}\\cdot \\frac{23^{2}}{50^{2}} \\\\\n&= \\frac{1987}{5000}.\n\\end{align*}\nThus\n$$\n\\mathrm{ENBW}_{\\mathrm{Ham}} = \\frac{\\nu_{\\mathrm{Ham}}}{\\mu_{\\mathrm{Ham}}^{2}} = \\frac{\\tfrac{1987}{5000}}{(\\tfrac{27}{50})^{2}} = \\frac{1987}{1458} \\approx 1.3628\\ \\text{bins}.\n$$\n\nBlackman window. Let $w(x) = 0.42 - 0.50\\cos(2\\pi x) + 0.08\\cos(4\\pi x)$. Then\n$$\n\\mu_{\\mathrm{Blk}} = 0.42,\n$$\nand, using orthogonality to eliminate cross terms,\n\\begin{align*}\n\\nu_{\\mathrm{Blk}} &= \\int_{0}^{1} \\Big(0.42 - 0.50\\cos(2\\pi x) + 0.08\\cos(4\\pi x)\\Big)^{2} dx \\\\\n&= 0.42^{2} + \\tfrac{1}{2}(0.50)^{2} + \\tfrac{1}{2}(0.08)^{2} \\\\\n&= \\frac{441}{2500} + \\frac{1}{8} + \\frac{2}{625} \\\\\n&= \\frac{1523}{5000}.\n\\end{align*}\nTherefore,\n$$\n\\mathrm{ENBW}_{\\mathrm{Blk}} = \\frac{\\nu_{\\mathrm{Blk}}}{\\mu_{\\mathrm{Blk}}^{2}} = \\frac{\\tfrac{1523}{5000}}{(\\tfrac{21}{50})^{2}} = \\frac{1523}{882} \\approx 1.7268\\ \\text{bins}.\n$$\n\nFor comparison, the rectangular window has $w[n] \\equiv 1$, so $\\mu = 1$ and $\\nu = 1$, giving $\\mathrm{ENBW} = 1.0$ bin, which is the baseline specified.\n\nRounding each asymptotic value to four significant figures and listing in the order Hann, Hamming, Blackman, we obtain the requested row vector in bin units.", "answer": "$$\\boxed{\\begin{pmatrix} 1.500 & 1.363 & 1.727 \\end{pmatrix}}$$", "id": "2895221"}, {"introduction": "Having explored spectral shape and noise performance, we now tackle a common practical challenge: accurately measuring a signal's amplitude from its DFT. When a signal's frequency does not fall exactly on a DFT bin, its energy spreads, and the measured peak is lower than the true value—a phenomenon known as scalloping loss. This final practice synthesizes these concepts into a complete measurement problem, where you will derive and apply a correction formula to estimate a signal's true amplitude from its DFT peak, turning theoretical knowledge into a tool for quantitative analysis. [@problem_id:2895177]", "problem": "Consider a single complex exponential observed through a finite-length cosine-sum window, and its spectrum estimated by the Discrete Fourier Transform (DFT). Let the signal be $x[n] = A \\exp\\!\\big(j(\\omega_0 n + \\phi)\\big)$, windowed as $y[n] = w[n]\\,x[n]$ for $n = 0,1,\\dots,N-1$, and define the DFT as $X[k] = \\sum_{n=0}^{N-1} y[n] \\exp\\!\\big(-j 2\\pi k n/N\\big)$. Suppose that the true frequency $\\omega_0$ lies between two DFT bins $k_0$ and $k_0+1$ with a fractional-bin offset $0<\\delta<1$, i.e., $\\omega_0 = \\tfrac{2\\pi}{N}(k_0+\\delta)$. Denote by $M$ the interpolated peak magnitude of the amplitude spectrum, where the amplitude spectrum is $|X[k]|/N$, obtained from three-bin interpolation about $k_0$ that also yields $\\delta$. Assume that the interpolation is sufficiently local so that the observed peak originates from the mainlobe of the window’s Discrete-Time Fourier Transform (DTFT) centered at $\\omega_0$.\n\n1) Starting from the definitions of the DFT and the Discrete-Time Fourier Transform (DTFT), and modeling the window as a cosine-sum,\n$$\nw[n] = a_0 - a_1 \\cos\\!\\Big(\\tfrac{2\\pi n}{N-1}\\Big) + a_2 \\cos\\!\\Big(\\tfrac{4\\pi n}{N-1}\\Big),\n$$\nderive a correction formula for the true amplitude $A$ in terms of the measured peak $M$, the window’s coherent gain $G_c = \\tfrac{1}{N}\\sum_{n=0}^{N-1} w[n]$, and a mainlobe shape factor $S(\\delta)$ defined as the ratio of the window’s DTFT magnitude at offset $\\tfrac{2\\pi}{N}\\delta$ to its zero-frequency magnitude. Show that under the large-$N$ approximation that replaces Dirichlet kernels by cardinal sines,\n$$\n\\operatorname{sinc}(x) \\triangleq \\frac{\\sin(\\pi x)}{\\pi x},\n$$\nthe shape factor for the cosine-sum window can be written as\n$$\nS(\\delta) \\approx \\frac{\\big|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\big(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)\\big) + \\tfrac{a_2}{2}\\big(\\operatorname{sinc}(\\delta-2) + \\operatorname{sinc}(\\delta+2)\\big)\\,\\big|}{a_0}.\n$$\nAlso obtain exact finite-$N$ expressions for $G_c$ for the Hann (often called Hanning), Hamming, and Blackman windows by evaluating the sum of $w[n]$.\n\n2) Apply your result to the following concrete case: $N=4096$, a Hamming window with coefficients $a_0=0.54$, $a_1=0.46$, $a_2=0$, an estimated fractional-bin offset $\\delta = \\tfrac{1}{4}$, and an interpolated amplitude-spectrum peak $M = 0.5$. Use the large-$N$ approximation consistently to evaluate $S(\\delta)$, and approximate $G_c$ by its large-$N$ value for numerical evaluation. Compute the corrected amplitude estimate $\\widehat{A}$ from your derived formula. Express your final numerical answer to four significant figures.", "solution": "The problem is well-posed, scientifically grounded, and internally consistent. We proceed with the solution.\n\nThe problem is divided into two parts. First, we derive the necessary analytical formulas. Second, we apply them to a specific numerical case.\n\n**Part 1: Analytical Derivations**\n\n**1) Correction Formula for Amplitude $A$**\n\nThe windowed signal is $y[n] = w[n]x[n] = w[n] A \\exp(j(\\omega_0 n + \\phi))$ for $n = 0, 1, \\dots, N-1$.\nThe Discrete Fourier Transform (DFT) is given by\n$$X[k] = \\sum_{n=0}^{N-1} y[n] \\exp\\left(-j \\frac{2\\pi k n}{N}\\right) = A e^{j\\phi} \\sum_{n=0}^{N-1} w[n] \\exp\\left(j\\left(\\omega_0 - \\frac{2\\pi k}{N}\\right)n\\right).$$\nThe sum on the right is the Discrete-Time Fourier Transform (DTFT) of the window $w[n]$, denoted $W(e^{j\\omega}) = \\sum_{n=0}^{N-1} w[n] e^{-j\\omega n}$.\nThus, the DFT can be expressed in terms of the window's DTFT:\n$$X[k] = A e^{j\\phi} W\\left(e^{j(\\omega_0 - \\frac{2\\pi k}{N})}\\right).$$\nThe magnitude of the DFT coefficients is $|X[k]| = A |W(e^{j(\\omega_0 - \\frac{2\\pi k}{N})})|$.\nGiven the true frequency $\\omega_0 = \\frac{2\\pi}{N}(k_0 + \\delta)$, the magnitude at DFT bin $k$ is\n$$|X[k]| = A \\left|W\\left(e^{j\\frac{2\\pi}{N}(k_0+\\delta-k)}\\right)\\right|.$$\nThe problem defines the amplitude spectrum as $|X[k]|/N$. The \"interpolated peak magnitude $M$\" is obtained from a three-bin interpolation. A reasonable interpretation, which leads to a consistent formula involving all specified terms, is that $M$ represents the magnitude of the largest DFT bin in the normalized amplitude spectrum. For $0 < \\delta < 1$, the largest bin is typically at $k=k_0$ or $k=k_0+1$. Let's assume $0 < \\delta \\le 0.5$, so the largest bin is at $k=k_0$.\nWe identify $M$ with the magnitude of this peak bin:\n$$M \\approx \\frac{|X[k_0]|}{N} = \\frac{A}{N} \\left|W\\left(e^{j\\frac{2\\pi}{N}(k_0+\\delta-k_0)}\\right)\\right| = \\frac{A}{N} \\left|W\\left(e^{j\\frac{2\\pi\\delta}{N}}\\right)\\right|.$$\nThe mainlobe shape factor $S(\\delta)$ is defined as the ratio of the window's DTFT magnitude at an offset frequency $\\frac{2\\pi\\delta}{N}$ to its DC value:\n$$S(\\delta) = \\frac{|W(e^{j\\frac{2\\pi\\delta}{N}})|}{|W(e^{j0})|}.$$\nFrom this, we have $|W(e^{j\\frac{2\\pi\\delta}{N}})| = S(\\delta) |W(e^{j0})|$.\nThe DC value of the DTFT is $|W(e^{j0})| = |\\sum_{n=0}^{N-1} w[n]|$. Since window functions are real and generally non-negative, this is simply $\\sum_{n=0}^{N-1} w[n]$.\nThe coherent gain $G_c$ is defined as $G_c = \\frac{1}{N} \\sum_{n=0}^{N-1} w[n]$, so $\\sum_{n=0}^{N-1} w[n] = N G_c$.\nTherefore, $|W(e^{j0})| = N G_c$.\nSubstituting these relations back into the expression for $M$:\n$$M = \\frac{A}{N} |W(e^{j\\frac{2\\pi\\delta}{N}})| = \\frac{A}{N} \\left(S(\\delta) |W(e^{j0})|\\right) = \\frac{A}{N} (S(\\delta) \\cdot N G_c) = A \\cdot G_c \\cdot S(\\delta).$$\nSolving for the true amplitude $A$, we obtain the desired correction formula:\n$$A = \\frac{M}{G_c S(\\delta)}.$$\n\n**2) Large-$N$ Approximation for $S(\\delta)$**\n\nThe window is given by $w[n] = a_0 - a_1 \\cos(\\frac{2\\pi n}{N-1}) + a_2 \\cos(\\frac{4\\pi n}{N-1})$. Using Euler's formula,\n$$w[n] = a_0 - \\frac{a_1}{2}\\left(e^{j\\frac{2\\pi n}{N-1}} + e^{-j\\frac{2\\pi n}{N-1}}\\right) + \\frac{a_2}{2}\\left(e^{j\\frac{4\\pi n}{N-1}} + e^{-j\\frac{4\\pi n}{N-1}}\\right).$$\nFor large $N$, we can make the approximation $\\frac{1}{N-1} \\approx \\frac{1}{N}$. This simplifies the frequency terms and allows us to relate the DTFT to that of a rectangular window. The DTFT of $w[n]$ is a sum of shifted versions of the DTFT of the underlying rectangular window of length $N$.\nThe DTFT of a rectangular window of length $N$ is the Dirichlet kernel, $D(\\omega) = \\sum_{n=0}^{N-1} e^{-j\\omega n}$. For large $N$ and for frequencies near DC, its magnitude can be approximated by a scaled cardinal sine (sinc) function: $|D(e^{j\\frac{2\\pi f}{N}})| \\approx N|\\operatorname{sinc}(f)|$, where $\\operatorname{sinc}(f) = \\frac{\\sin(\\pi f)}{\\pi f}$.\nApplying this approximation to the DTFT of $w[n]$:\n$$W(e^{j\\omega}) \\approx a_0 D(\\omega) - \\frac{a_1}{2}\\left(D(\\omega-\\frac{2\\pi}{N}) + D(\\omega+\\frac{2\\pi}{N})\\right) + \\frac{a_2}{2}\\left(D(\\omega-\\frac{4\\pi}{N}) + D(\\omega+\\frac{4\\pi}{N})\\right).$$\nWe need to evaluate its magnitude at $\\omega = \\frac{2\\pi\\delta}{N}$. This corresponds to $f=\\delta$ for the central term, $f=\\delta \\mp 1$ for the $a_1$ terms, and $f=\\delta \\mp 2$ for the $a_2$ terms. Taking the magnitude, we get:\n$$|W(e^{j\\frac{2\\pi\\delta}{N}})| \\approx N \\left| a_0\\operatorname{sinc}(\\delta) - \\frac{a_1}{2}(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)) + \\frac{a_2}{2}(\\operatorname{sinc}(\\delta-2) + \\operatorname{sinc}(\\delta+2)) \\right|.$$\nThe denominator for $S(\\delta)$ is $|W(e^{j0})|$. For large $N$, the coherent gain $G_c \\approx a_0$, so $|W(e^{j0})| = N G_c \\approx N a_0$.\nThus, the shape factor is:\n$$S(\\delta) = \\frac{|W(e^{j\\frac{2\\pi\\delta}{N}})|}{|W(e^{j0})|} \\approx \\frac{N \\left| \\dots \\right|}{N a_0} = \\frac{\\left|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\big(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)\\big) + \\tfrac{a_2}{2}\\big(\\operatorname{sinc}(\\delta-2) + \\operatorname{sinc}(\\delta+2)\\big)\\,\\right|}{a_0}.$$\nThis confirms the expression given in the problem statement.\n\n**3) Exact Finite-$N$ Expression for $G_c$**\n\nThe coherent gain is $G_c = \\frac{1}{N} \\sum_{n=0}^{N-1} w[n]$.\n$$G_c = \\frac{1}{N} \\sum_{n=0}^{N-1} \\left[ a_0 - a_1 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + a_2 \\cos\\left(\\frac{4\\pi n}{N-1}\\right) \\right].$$\n$$G_c = \\frac{1}{N} \\left[ \\sum_{n=0}^{N-1} a_0 - a_1 \\sum_{n=0}^{N-1} \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + a_2 \\sum_{n=0}^{N-1} \\cos\\left(\\frac{4\\pi n}{N-1}\\right) \\right].$$\nThe first sum is $\\sum_{n=0}^{N-1} a_0 = N a_0$. For the cosine sums, consider the geometric series $\\sum_{n=0}^{N-1} r^n$ with $r = \\exp(j\\frac{2\\pi k}{N-1})$ for integer $k \\ge 1$.\n$$ \\sum_{n=0}^{N-1} r^n = \\frac{r^N - 1}{r-1} = \\frac{\\exp\\left(j\\frac{2\\pi k N}{N-1}\\right) - 1}{\\exp\\left(j\\frac{2\\pi k}{N-1}\\right) - 1}. $$\nSince $\\exp(j\\frac{2\\pi k N}{N-1}) = \\exp(j\\frac{2\\pi k (N-1+1)}{N-1}) = \\exp(j(2\\pi k + \\frac{2\\pi k}{N-1})) = \\exp(j\\frac{2\\pi k}{N-1}) = r$, the sum is $\\frac{r-1}{r-1} = 1$.\nThe sum of cosines is the real part of this result: $\\sum_{n=0}^{N-1} \\cos(\\frac{2\\pi k n}{N-1}) = \\operatorname{Re}(1) = 1$. This holds for both $k=1$ and $k=2$.\nSubstituting this into the expression for $G_c$:\n$$G_c = \\frac{1}{N} \\left[ N a_0 - a_1(1) + a_2(1) \\right] = a_0 - \\frac{a_1 - a_2}{N}.$$\nFor the specific windows (using common coefficient definitions):\n- **Hann window**: $a_0=0.5, a_1=0.5, a_2=0$.\n  $G_c = 0.5 - \\frac{0.5-0}{N} = 0.5 - \\frac{0.5}{N}$.\n- **Hamming window**: $a_0=0.54, a_1=0.46, a_2=0$.\n  $G_c = 0.54 - \\frac{0.46-0}{N} = 0.54 - \\frac{0.46}{N}$.\n- **Blackman window**: $a_0=0.42, a_1=0.5, a_2=0.08$.\n  $G_c = 0.42 - \\frac{0.5-0.08}{N} = 0.42 - \\frac{0.42}{N}$.\n\n**Part 2: Numerical Application**\n\nWe are given:\n- $N=4096$\n- Hamming window: $a_0=0.54, a_1=0.46, a_2=0$\n- Fractional-bin offset: $\\delta = \\frac{1}{4} = 0.25$\n- Interpolated amplitude-spectrum peak: $M = 0.5$\n\nWe are to compute the corrected amplitude estimate $\\widehat{A}$ using the formula $\\widehat{A} = \\frac{M}{G_c S(\\delta)}$, with large-$N$ approximations for $G_c$ and $S(\\delta)$.\n\nFirst, we calculate the coherent gain $G_c$. As instructed, we use its large-$N$ value:\n$$G_c \\approx a_0 = 0.54.$$\nNext, we calculate the mainlobe shape factor $S(\\delta)$. For the Hamming window, $a_2=0$, so the formula simplifies to:\n$$S(\\delta) \\approx \\frac{\\left|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\big(\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1)\\big)\\,\\right|}{a_0}.$$\nWe use the identity $\\operatorname{sinc}(x \\pm 1) = -\\frac{\\sin(\\pi x)}{\\pi(x \\pm 1)} = \\frac{x}{x\\pm 1} \\frac{-\\sin(\\pi x)}{\\pi x} = \\frac{-x}{x \\pm 1} \\operatorname{sinc}(x)$.\nSumming the two terms: $\\operatorname{sinc}(\\delta-1) + \\operatorname{sinc}(\\delta+1) = \\left(-\\frac{\\delta}{\\delta-1} - \\frac{\\delta}{\\delta+1}\\right)\\operatorname{sinc}(\\delta) = -\\delta\\left(\\frac{\\delta+1+\\delta-1}{\\delta^2-1}\\right)\\operatorname{sinc}(\\delta) = \\frac{-2\\delta^2}{\\delta^2-1}\\operatorname{sinc}(\\delta)$.\nThe expression for $S(\\delta)$ becomes:\n$$ S(\\delta) \\approx \\frac{\\left|\\, a_0\\,\\operatorname{sinc}(\\delta) - \\tfrac{a_1}{2}\\left(\\frac{-2\\delta^2}{\\delta^2-1}\\operatorname{sinc}(\\delta)\\right)\\,\\right|}{a_0} = \\frac{|\\operatorname{sinc}(\\delta)| \\left| a_0 + a_1\\frac{\\delta^2}{\\delta^2-1} \\right|}{a_0}.$$\nWe evaluate this for $\\delta = 0.25$:\n$$ \\operatorname{sinc}(0.25) = \\frac{\\sin(\\pi/4)}{\\pi/4} = \\frac{\\sqrt{2}/2}{\\pi/4} = \\frac{2\\sqrt{2}}{\\pi} \\approx 0.900316.$$\n$$ \\frac{\\delta^2}{\\delta^2-1} = \\frac{(0.25)^2}{(0.25)^2-1} = \\frac{1/16}{1/16-1} = \\frac{1/16}{-15/16} = -\\frac{1}{15}.$$\n$$ S(0.25) \\approx \\frac{|\\operatorname{sinc}(0.25)| \\left| 0.54 + 0.46\\left(-\\frac{1}{15}\\right) \\right|}{0.54} = \\frac{|\\frac{2\\sqrt{2}}{\\pi}| \\left| 0.54 - \\frac{0.46}{15} \\right|}{0.54}. $$\n$$ S(0.25) \\approx \\frac{0.900316 \\times |0.54 - 0.030666...|}{0.54} = \\frac{0.900316 \\times 0.509333...}{0.54} = \\frac{0.458564}{0.54} \\approx 0.849193.$$\nFinally, we compute the corrected amplitude estimate $\\widehat{A}$:\n$$ \\widehat{A} = \\frac{M}{G_c S(\\delta)} \\approx \\frac{0.5}{0.54 \\times 0.849193} = \\frac{0.5}{0.458564} \\approx 1.09035. $$\nRounding to four significant figures, the result is $1.090$.", "answer": "$$\\boxed{1.090}$$", "id": "2895177"}]}