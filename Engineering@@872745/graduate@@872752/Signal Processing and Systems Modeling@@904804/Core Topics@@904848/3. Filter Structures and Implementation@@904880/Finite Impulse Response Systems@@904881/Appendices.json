{"hands_on_practices": [{"introduction": "One of the most important properties of FIR filters is their ability to exhibit perfectly linear phase, which ensures that all frequency components of a signal are delayed by the same amount. This practice connects the time-domain symmetry of the impulse response directly to this frequency-domain characteristic. By starting from first principles, you will derive the real-valued amplitude function and constant group delay for a Type I FIR filter, reinforcing the fundamental theory that underpins linear-phase filter design [@problem_id:2881290].", "problem": "Consider a real-valued, finite impulse response (FIR) filter of length $N=7$ with even symmetry $h[n]=h[6-n]$ for all integer $n$, and with the following specified coefficients:\n- $h[0]=\\frac{1}{16}$, $h[1]=-\\frac{1}{8}$, $h[2]=\\frac{3}{16}$, $h[3]=\\frac{1}{4}$, and by symmetry $h[4]=\\frac{3}{16}$, $h[5]=-\\frac{1}{8}$, $h[6]=\\frac{1}{16}$.\n\nStarting only from the definition of the discrete-time Fourier transform (DTFT) of the impulse response and the given symmetry, derive an explicit expression of the frequency response in the linear-phase decomposition form $H(\\omega)=\\exp(-j \\omega M)\\,A(\\omega)$, identifying the real amplitude function $A(\\omega)$ as a sum of cosine terms. Then, using the definition of group delay in terms of phase, identify the constant group delay of this filter.\n\nUse radians for all angular quantities, and express the group delay in samples. Provide your final answer as two entries in a single row matrix, where the first entry is the explicit $A(\\omega)$ and the second entry is the group delay. No rounding is required.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted as follows:\n1.  The filter is a real-valued, finite impulse response (FIR) filter.\n2.  The length of the filter is $N=7$.\n3.  The impulse response exhibits even symmetry: $h[n]=h[6-n]$ for all integer $n$.\n4.  The coefficients are specified as: $h[0]=\\frac{1}{16}$, $h[1]=-\\frac{1}{8}$, $h[2]=\\frac{3}{16}$, $h[3]=\\frac{1}{4}$. The remaining coefficients are determined by symmetry: $h[4]=h[6-4]=h[2]=\\frac{3}{16}$, $h[5]=h[6-5]=h[1]=-\\frac{1}{8}$, and $h[6]=h[6-6]=h[0]=\\frac{1}{16}$.\n\nThe problem is scientifically grounded, well-posed, and objective. It concerns standard concepts in digital signal processing, specifically the analysis of a Type I linear-phase FIR filter. All provided data is consistent and sufficient for a unique solution. The problem is therefore deemed valid. The solution will proceed.\n\nThe frequency response $H(\\omega)$ of a discrete-time filter with impulse response $h[n]$ is given by its discrete-time Fourier transform (DTFT). For a filter of length $N$, the definition is:\n$$H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-j \\omega n)$$\nGiven a filter length of $N=7$, the summation is from $n=0$ to $n=6$:\n$$H(\\omega) = \\sum_{n=0}^{6} h[n] \\exp(-j \\omega n)$$\nExpanding this summation yields:\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[4]\\exp(-j4\\omega) + h[5]\\exp(-j5\\omega) + h[6]\\exp(-j6\\omega)$$\nThe problem states that the impulse response has even symmetry, $h[n]=h[6-n]$. We apply this property to the coefficients:\n$h[6] = h[0]$, $h[5] = h[1]$, and $h[4] = h[2]$.\nSubstituting these into the expression for $H(\\omega)$:\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[2]\\exp(-j4\\omega) + h[1]\\exp(-j5\\omega) + h[0]\\exp(-j6\\omega)$$\nTo reveal the linear-phase structure, we must group terms symmetrically around the center of the impulse response. The center of symmetry for a filter of length $N=7$ is at index $n=\\frac{N-1}{2} = \\frac{7-1}{2}=3$.\n$$H(\\omega) = h[3]\\exp(-j3\\omega) + \\left( h[0] + h[0]\\exp(-j6\\omega) \\right) + \\left( h[1]\\exp(-j\\omega) + h[1]\\exp(-j5\\omega) \\right) + \\left( h[2]\\exp(-j2\\omega) + h[2]\\exp(-j4\\omega) \\right)$$\nWe factor out the phase term corresponding to the center of symmetry, $\\exp(-j3\\omega)$:\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + h[0]\\left(\\exp(j3\\omega) + \\exp(-j3\\omega)\\right) + h[1]\\left(\\exp(j2\\omega) + \\exp(-j2\\omega)\\right) + h[2]\\left(\\exp(j\\omega) + \\exp(-j\\omega)\\right) \\right]$$\nUsing Euler's identity, $2\\cos(\\theta) = \\exp(j\\theta) + \\exp(-j\\theta)$, we can express the terms in parentheses as cosines:\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + 2h[0]\\cos(3\\omega) + 2h[1]\\cos(2\\omega) + 2h[2]\\cos(\\omega) \\right]$$\nThis expression is in the desired linear-phase form $H(\\omega)=\\exp(-j \\omega M)A(\\omega)$, where $M=3$ and $A(\\omega)$ is the real-valued amplitude function:\n$$A(\\omega) = h[3] + 2h[2]\\cos(\\omega) + 2h[1]\\cos(2\\omega) + 2h[0]\\cos(3\\omega)$$\nNow, we substitute the given numerical values for the coefficients: $h[0]=\\frac{1}{16}$, $h[1]=-\\frac{1}{8}$, $h[2]=\\frac{3}{16}$, $h[3]=\\frac{1}{4}$.\n$$A(\\omega) = \\frac{1}{4} + 2\\left(\\frac{3}{16}\\right)\\cos(\\omega) + 2\\left(-\\frac{1}{8}\\right)\\cos(2\\omega) + 2\\left(\\frac{1}{16}\\right)\\cos(3\\omega)$$\n$$A(\\omega) = \\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega)$$\nThis is the explicit expression for the real amplitude function $A(\\omega)$.\n\nNext, we identify the group delay, $\\tau_g(\\omega)$. The group delay is defined as the negative derivative of the phase of the frequency response with respect to angular frequency $\\omega$:\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega} \\arg\\{H(\\omega)\\}$$\nThe frequency response is $H(\\omega) = A(\\omega)\\exp(-j3\\omega)$. The function $A(\\omega)$ is real, so its phase, $\\arg\\{A(\\omega)\\}$, is either $0$ (if $A(\\omega)  0$) or $\\pi$ (if $A(\\omega)  0$).\nThe total phase of $H(\\omega)$, denoted $\\phi(\\omega)$, is:\n$$\\phi(\\omega) = \\arg\\{H(\\omega)\\} = \\arg\\{A(\\omega)\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} + \\arg\\{\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} - 3\\omega$$\nFor a linear-phase filter, the group delay is conventionally defined by the linear component of the phase. In regions of $\\omega$ where $A(\\omega)$ does not change sign, $\\arg\\{A(\\omega)\\}$ is a constant ($0$ or $\\pi$), and its derivative is zero. Thus, the derivative of the phase is:\n$$\\frac{d\\phi(\\omega)}{d\\omega} = \\frac{d}{d\\omega}(-3\\omega) = -3$$\nThe group delay is therefore constant:\n$$\\tau_g(\\omega) = -(-3) = 3$$\nThe group delay is $3$ samples. This is consistent with the general theory of Type I linear-phase FIR filters, for which the group delay is constant and equal to $(N-1)/2$.\n\nThe final answer consists of the expression for $A(\\omega)$ and the constant value for the group delay.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega)  3\n\\end{pmatrix}\n}\n$$", "id": "2881290"}, {"introduction": "This exercise flips the perspective from analysis to synthesis, demonstrating how an FIR filter's frequency response can be shaped by strategically placing zeros in the z-plane. This hands-on construction builds a crucial intuition for filter design, showing how to nullify specific frequencies and ensure the resulting impulse response is real-valued, a requirement for most practical systems. The practice reinforces the deep connection between the z-transform, zero locations, and the filter's time-domain behavior [@problem_id:2872240].", "problem": "Consider a causal finite impulse response (FIR) linear time-invariant discrete-time system with a real-coefficient system function. You are given the set of complex zeros (specified in polar form) $$\\{z_{1},z_{2},z_{3}\\}=\\left\\{r\\,\\exp(j\\pi/3),\\;r\\,\\exp(-j\\pi/3),\\;-\\,\\frac{1}{4}\\right\\},$$ where $$r=\\frac{4}{5}$$ and all angles are in radians. Using only the definition of a zero of a system function and the definition of the bilateral $z$-transform, construct a real-coefficient FIR system function $$H(z)$$ that is causal and has exactly these zeros. Choose the overall real gain so that the discrete-time frequency response at zero frequency is unity, that is, $$H(1)=1$$ under the standard substitution $$z=\\exp(j\\omega).$$ From your constructed $$H(z),$$ determine the corresponding impulse response $$h[n]$$ via the inverse $z$-transform.\n\nWork from first principles and basic definitions; do not invoke any pre-stated factorization templates or cookbook formulas. Justify why the coefficients are real based on the zero set, and make clear how causality and finiteness of the impulse response are enforced in your construction.\n\nFinally, report the value of $$h[2]$$ as your final answer, in exact rational form with no rounding.", "solution": "The problem as stated is subjected to validation.\n\nGivens extracted verbatim are:\n1.  A causal finite impulse response (FIR) linear time-invariant (LTI) discrete-time system.\n2.  The system function has real coefficients.\n3.  The set of complex zeros is $\\{z_{1},z_{2},z_{3}\\}=\\left\\{r\\,\\exp(j\\pi/3),\\;r\\,\\exp(-j\\pi/3),\\;-\\,\\frac{1}{4}\\right\\}$.\n4.  The parameter $r$ is given as $r=\\frac{4}{5}$.\n5.  All angles are in radians.\n6.  The methodology must use only the definition of a zero and the bilateral $z$-transform.\n7.  A normalization condition is imposed: the discrete-time frequency response at zero frequency is unity, which translates to $H(1)=1$ via the substitution $z=\\exp(j\\omega)$.\n8.  The task is to find the impulse response $h[n]$ and report the value of $h[2]$.\n\nValidation Verdict:\nThe problem is valid. It is scientifically grounded in the established theory of digital signal processing. It is well-posed, providing sufficient information (zeros and a gain normalization condition) to uniquely determine the system function of an FIR filter. The constraints are self-consistent and objective. The problem avoids ambiguity and adheres to standard definitions within the discipline.\n\nProceeding to solution.\n\nThe bilateral $z$-transform of an impulse response $h[n]$ is defined as $H(z) = \\sum_{n=-\\infty}^{\\infty} h[n] z^{-n}$. For a causal, finite impulse response (FIR) system, the impulse response is non-zero only for $n \\in [0, N-1]$ for some finite integer $N$. The definition thus simplifies to:\n$$H(z) = \\sum_{n=0}^{N-1} h[n] z^{-n} = h[0] + h[1]z^{-1} + h[2]z^{-2} + \\dots + h[N-1]z^{-(N-1)}$$\nThis form is a polynomial in the variable $z^{-1}$. Causality is enforced by the summation starting at $n=0$, and the finite duration is enforced by the finite upper limit $N-1$.\n\nA zero of a system function $H(z)$ is a complex number $z_k$ for which $H(z_k)=0$. For a polynomial, this implies that $(z-z_k)$ is a factor of the polynomial. When expressed as a polynomial in $z^{-1}$, a zero at $z=z_k$ implies a factor of $(1 - z_k z^{-1})$, because substitution of $z=z_k$ yields $1 - z_k (z_k)^{-1} = 1-1=0$.\n\nThe problem provides three zeros. The system function must therefore be of the form:\n$$H(z) = K \\left(1 - z_1 z^{-1}\\right)\\left(1 - z_2 z^{-1}\\right)\\left(1 - z_3 z^{-1}\\right)$$\nwhere $K$ is a real gain constant and the presence of three zero factors implies $N-1=3$, so $N=4$. The impulse response will be of length $4$. This polynomial structure in $z^{-1}$ inherently satisfies the FIR and causality requirements.\n\nThe given zeros are:\n$$z_1 = r\\,\\exp(j\\pi/3) = \\frac{4}{5}\\left(\\cos(\\pi/3) + j\\sin(\\pi/3)\\right) = \\frac{4}{5}\\left(\\frac{1}{2} + j\\frac{\\sqrt{3}}{2}\\right) = \\frac{2}{5} + j\\frac{2\\sqrt{3}}{5}$$\n$$z_2 = r\\,\\exp(-j\\pi/3) = \\frac{4}{5}\\left(\\cos(-\\pi/3) + j\\sin(-\\pi/3)\\right) = \\frac{4}{5}\\left(\\frac{1}{2} - j\\frac{\\sqrt{3}}{2}\\right) = \\frac{2}{5} - j\\frac{2\\sqrt{3}}{5}$$\n$$z_3 = -\\frac{1}{4}$$\nThe system function must have real coefficients. For a polynomial, this is true if and only if its complex roots appear in conjugate pairs. We verify that $z_1^* = \\left(\\frac{2}{5} + j\\frac{2\\sqrt{3}}{5}\\right)^* = \\frac{2}{5} - j\\frac{2\\sqrt{3}}{5} = z_2$. The third zero $z_3$ is real. The set of zeros is closed under complex conjugation, so the resulting polynomial for $H(z)$ will have real coefficients.\n\nLet us construct the polynomial by first combining the factors corresponding to the complex conjugate pair of zeros:\n$$\\left(1 - z_1 z^{-1}\\right)\\left(1 - z_2 z^{-1}\\right) = \\left(1 - z_1 z^{-1}\\right)\\left(1 - z_1^* z^{-1}\\right) = 1 - (z_1 + z_1^*)z^{-1} + (z_1 z_1^*)z^{-2}$$\nThe coefficients of this quadratic are real, as required. We compute them:\n$$z_1 + z_1^* = 2\\,\\text{Re}\\{z_1\\} = 2\\left(\\frac{2}{5}\\right) = \\frac{4}{5}$$\n$$z_1 z_1^* = |z_1|^2 = r^2 = \\left(\\frac{4}{5}\\right)^2 = \\frac{16}{25}$$\nThe quadratic factor is therefore $\\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)$.\n\nNow, we include the factor for the real zero $z_3 = -\\frac{1}{4}$:\n$$H(z) = K \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)\\left(1 - z_3 z^{-1}\\right) = K \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right)\\left(1 + \\frac{1}{4}z^{-1}\\right)$$\nExpanding this product:\n$$H(z) = K \\left[ \\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right) + \\frac{1}{4}z^{-1}\\left(1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2}\\right) \\right]$$\n$$H(z) = K \\left[ 1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2} + \\frac{1}{4}z^{-1} - \\frac{4}{20}z^{-2} + \\frac{16}{100}z^{-3} \\right]$$\n$$H(z) = K \\left[ 1 - \\frac{4}{5}z^{-1} + \\frac{16}{25}z^{-2} + \\frac{1}{4}z^{-1} - \\frac{1}{5}z^{-2} + \\frac{4}{25}z^{-3} \\right]$$\nGroup terms by powers of $z^{-1}$:\n$$H(z) = K \\left[ 1 + \\left(-\\frac{4}{5} + \\frac{1}{4}\\right)z^{-1} + \\left(\\frac{16}{25} - \\frac{1}{5}\\right)z^{-2} + \\frac{4}{25}z^{-3} \\right]$$\nThe coefficients are:\n$$-\\frac{4}{5} + \\frac{1}{4} = \\frac{-16+5}{20} = -\\frac{11}{20}$$\n$$\\frac{16}{25} - \\frac{1}{5} = \\frac{16-5}{25} = \\frac{11}{25}$$\nSo, the system function is:\n$$H(z) = K \\left( 1 - \\frac{11}{20}z^{-1} + \\frac{11}{25}z^{-2} + \\frac{4}{25}z^{-3} \\right)$$\nThe gain $K$ is determined by the condition $H(1)=1$. The discrete-time frequency response is $H(e^{j\\omega})$, and zero frequency corresponds to $\\omega=0$, which means $z=e^{j0}=1$.\n$$H(1) = K \\left( 1 - \\frac{11}{20}(1)^{-1} + \\frac{11}{25}(1)^{-2} + \\frac{4}{25}(1)^{-3} \\right) = K \\left( 1 - \\frac{11}{20} + \\frac{11}{25} + \\frac{4}{25} \\right)$$\n$$H(1) = K \\left( 1 - \\frac{11}{20} + \\frac{15}{25} \\right) = K \\left( 1 - \\frac{11}{20} + \\frac{3}{5} \\right)$$\nUsing a common denominator of $20$:\n$$H(1) = K \\left( \\frac{20}{20} - \\frac{11}{20} + \\frac{12}{20} \\right) = K \\left( \\frac{20 - 11 + 12}{20} \\right) = K \\left( \\frac{21}{20} \\right)$$\nGiven $H(1)=1$, we have $K \\left( \\frac{21}{20} \\right) = 1$, which implies $K = \\frac{20}{21}$.\n\nSubstituting $K$ back into the expression for $H(z)$:\n$$H(z) = \\frac{20}{21} \\left( 1 - \\frac{11}{20}z^{-1} + \\frac{11}{25}z^{-2} + \\frac{4}{25}z^{-3} \\right)$$\n$$H(z) = \\frac{20}{21} - \\frac{20}{21}\\frac{11}{20}z^{-1} + \\frac{20}{21}\\frac{11}{25}z^{-2} + \\frac{20}{21}\\frac{4}{25}z^{-3}$$\n$$H(z) = \\frac{20}{21} - \\frac{11}{21}z^{-1} + \\frac{4 \\cdot 5}{21}\\frac{11}{5 \\cdot 5}z^{-2} + \\frac{4 \\cdot 5}{21}\\frac{4}{5 \\cdot 5}z^{-3}$$\n$$H(z) = \\frac{20}{21} - \\frac{11}{21}z^{-1} + \\frac{44}{105}z^{-2} + \\frac{16}{105}z^{-3}$$\nThe impulse response $h[n]$ is obtained by identifying the coefficients of the powers of $z^{-n}$ in the polynomial form of $H(z)$, according to the definition $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$.\nBy direct inspection:\n$$h[0] = \\frac{20}{21}$$\n$$h[1] = -\\frac{11}{21}$$\n$$h[2] = \\frac{44}{105}$$\n$$h[3] = \\frac{16}{105}$$\nAnd $h[n]=0$ for all other $n$.\n\nThe problem requires the value of $h[2]$. This value is $\\frac{44}{105}$.\nThis is an exact rational form with no rounding, as required.", "answer": "$$\\boxed{\\frac{44}{105}}$$", "id": "2872240"}, {"introduction": "Real-world filter design often involves trade-offs and meeting hard constraints simultaneously, which simple placement of zeros cannot always resolve. This practice introduces a powerful, systematic approach using constrained optimization to find the \"best\" filter that satisfies multiple, sometimes conflicting, objectives. By setting up and solving the Karush–Kuhn–Tucker (KKT) system, you will gain insight into modern numerical methods that balance desired performance in some frequency bands while enforcing exact nulls in others [@problem_id:2872198].", "problem": "Consider a discrete-time, real-coefficient Finite Impulse Response (FIR) filter of length $3$ with impulse response coefficients $\\mathbf{h} = [h[0], h[1], h[2]]^{\\top} \\in \\mathbb{R}^{3}$. The frequency response is defined by the fundamental relation $H(\\omega) = \\sum_{n=0}^{2} h[n] \\exp(-j \\omega n)$ for angular frequency $\\omega$ in radians per sample. You are asked to design $\\mathbf{h}$ by minimizing a least-squares (LS) error at two frequencies while enforcing exact spectral zeros at two other frequencies through equality constraints.\n\n- Desired response: $D(\\omega) = 1$ at the two frequencies $\\omega_{1} = \\pi/2$ and $\\omega_{2} = \\pi/3$.\n- Hard equality constraints (exact zeros): $H(0) = 0$ and $H(\\pi) = 0$.\n- The least-squares objective is the unweighted sum of squared complex errors at $\\omega_{1}$ and $\\omega_{2}$, namely $J(\\mathbf{h}) = \\sum_{m=1}^{2} |H(\\omega_{m}) - 1|^{2}$.\n\nStarting only from the definitions above and the method of Lagrange multipliers leading to the Karush–Kuhn–Tucker (KKT) optimality conditions, set up and solve the KKT linear system symbolically to obtain the optimal $\\mathbf{h}$. Express the final answer as a single row matrix using the $\\LaTeX$ $\\texttt{pmatrix}$ environment in the order $[h[0], h[1], h[2]]$. No rounding is required. All angles are in radians per sample.", "solution": "The problem is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Filter type: Finite Impulse Response (FIR)\n- Filter length: $L=3$\n- Impulse response coefficients: $\\mathbf{h} = [h[0], h[1], h[2]]^{\\top} \\in \\mathbb{R}^{3}$\n- Frequency response: $H(\\omega) = \\sum_{n=0}^{2} h[n] \\exp(-j \\omega n)$\n- Least-squares frequencies: $\\omega_{1} = \\pi/2$, $\\omega_{2} = \\pi/3$\n- Desired response at LS frequencies: $D(\\omega) = 1$\n- Least-squares objective function: $J(\\mathbf{h}) = \\sum_{m=1}^{2} |H(\\omega_{m}) - 1|^{2}$\n- Equality constraints (spectral zeros): $H(0) = 0$ and $H(\\pi) = 0$\n- Required method: Lagrange multipliers / Karush–Kuhn–Tucker (KKT) conditions.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard exercise in constrained optimization for digital filter design.\n- **Scientifically Grounded**: The problem is based on fundamental principles of digital signal processing, linear algebra, and optimization theory. All concepts are well-established.\n- **Well-Posed**: The problem is a quadratic program with linear equality constraints. The objective function is convex, and the constraints define a convex set, which guarantees a unique global minimum exists. The problem is well-posed.\n- **Objective**: The problem is stated using precise mathematical definitions and objective criteria. There is no ambiguity.\n- **Completeness**: All necessary data and conditions for a unique solution are provided.\nThe problem is found to be valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be derived.\n\nThe optimization problem is to minimize the objective function $J(\\mathbf{h})$ subject to two linear equality constraints.\nThe objective function is:\n$$J(\\mathbf{h}) = |H(\\omega_1) - 1|^2 + |H(\\omega_2) - 1|^2$$\nThe frequency response can be written as a vector product $H(\\omega) = \\mathbf{s}(\\omega)^T \\mathbf{h}$, where $\\mathbf{s}(\\omega) = [1, \\exp(-j\\omega), \\exp(-j2\\omega)]^T$. Since $\\mathbf{h}$ is real, the complex conjugate is $H(\\omega)^* = \\mathbf{s}(\\omega)^H \\mathbf{h}$.\nThe objective function can be expanded into a quadratic form:\n$$J(\\mathbf{h}) = \\sum_{m=1,2} (H(\\omega_m) - 1)(H(\\omega_m)^* - 1) = \\sum_{m=1,2} (\\mathbf{s}_m^T \\mathbf{h} - 1)(\\mathbf{s}_m^H \\mathbf{h} - 1)$$\n$$J(\\mathbf{h}) = \\mathbf{h}^T \\left( \\sum_{m=1,2} \\mathbf{s}_m^* \\mathbf{s}_m^T \\right) \\mathbf{h} - \\mathbf{h}^T \\left( \\sum_{m=1,2} \\mathbf{s}_m^* \\right) - \\left( \\sum_{m=1,2} \\mathbf{s}_m^T \\right) \\mathbf{h} + 2$$\nThe gradient with respect to the real vector $\\mathbf{h}$ is $\\nabla_{\\mathbf{h}}J(\\mathbf{h}) = 2\\Re(\\mathbf{A})\\mathbf{h} - 2\\Re(\\mathbf{b})$, where $\\mathbf{A} = \\sum_{m=1,2} \\mathbf{s}_m \\mathbf{s}_m^H$ and $\\mathbf{b} = \\sum_{m=1,2} \\mathbf{s}_m$.\n\nThe constraints are:\n1. $H(0) = h[0] + h[1] + h[2] = \\mathbf{c}_1^T \\mathbf{h} = 0$, with $\\mathbf{c}_1 = [1, 1, 1]^T$.\n2. $H(\\pi) = h[0] - h[1] + h[2] = \\mathbf{c}_2^T \\mathbf{h} = 0$, with $\\mathbf{c}_2 = [1, -1, 1]^T$.\n\nThe method of Lagrange multipliers is used. The Lagrangian is:\n$$\\mathcal{L}(\\mathbf{h}, \\lambda_1, \\lambda_2) = J(\\mathbf{h}) + \\lambda_1 \\mathbf{c}_1^T \\mathbf{h} + \\lambda_2 \\mathbf{c}_2^T \\mathbf{h}$$\nThe KKT conditions require the gradient of the Lagrangian with respect to $\\mathbf{h}$ to be zero:\n$$\\nabla_{\\mathbf{h}} \\mathcal{L} = \\nabla_{\\mathbf{h}} J(\\mathbf{h}) + \\lambda_1 \\mathbf{c}_1 + \\lambda_2 \\mathbf{c}_2 = \\mathbf{0}$$\n$$2\\Re(\\mathbf{A})\\mathbf{h} - 2\\Re(\\mathbf{b}) + \\lambda_1 \\mathbf{c}_1 + \\lambda_2 \\mathbf{c}_2 = \\mathbf{0}$$\nThis, along with the two constraints, forms a KKT linear system. Let $\\mathbf{R} = \\Re(\\mathbf{A})$ and $\\mathbf{r} = \\Re(\\mathbf{b})$. The system is:\n$$\n\\begin{pmatrix} 2\\mathbf{R}  \\mathbf{c}_1  \\mathbf{c}_2 \\\\ \\mathbf{c}_1^T  0  0 \\\\ \\mathbf{c}_2^T  0  0 \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{h} \\\\ \\lambda_1 \\\\ \\lambda_2 \\end{pmatrix}\n=\n\\begin{pmatrix} 2\\mathbf{r} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nWe now compute the necessary matrices and vectors. The frequencies are $\\omega_1 = \\pi/2$ and $\\omega_2 = \\pi/3$.\nThe steering vectors are:\n$\\mathbf{s}_1 = \\mathbf{s}(\\pi/2) = [1, \\exp(-j\\pi/2), \\exp(-j\\pi)]^T = [1, -j, -1]^T$.\n$\\mathbf{s}_2 = \\mathbf{s}(\\pi/3) = [1, \\exp(-j\\pi/3), \\exp(-j2\\pi/3)]^T = [1, \\frac{1}{2}-j\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}-j\\frac{\\sqrt{3}}{2}]^T$.\n\nThe vector $\\mathbf{b}$ and its real part $\\mathbf{r}$:\n$\\mathbf{b} = \\mathbf{s}_1 + \\mathbf{s}_2 = [2, \\frac{1}{2}-j(1+\\frac{\\sqrt{3}}{2}), -\\frac{3}{2}-j\\frac{\\sqrt{3}}{2}]^T$.\n$\\mathbf{r} = \\Re(\\mathbf{b}) = [2, 1/2, -3/2]^T$.\n\nThe matrix $\\mathbf{A}$ and its real part $\\mathbf{R}$:\n$\\mathbf{A} = \\mathbf{s}_1 \\mathbf{s}_1^H + \\mathbf{s}_2 \\mathbf{s}_2^H = \\begin{pmatrix} 1  j  -1 \\\\ -j  1  j \\\\ -1  -j  1 \\end{pmatrix} + \\begin{pmatrix} 1  e^{j\\pi/3}  e^{j2\\pi/3} \\\\ e^{-j\\pi/3}  1  e^{-j\\pi/3} \\\\ e^{-j2\\pi/3}  e^{j\\pi/3}  1 \\end{pmatrix}$.\n$\\mathbf{R} = \\Re(\\mathbf{A}) = \\begin{pmatrix} 1+\\Re(1)  \\Re(j+e^{j\\pi/3})  \\Re(-1+e^{j2\\pi/3}) \\\\ \\Re(-j+e^{-j\\pi/3})  1+\\Re(1)  \\Re(j+e^{-j\\pi/3}) \\\\ \\Re(-1+e^{-j2\\pi/3})  \\Re(-j+e^{j\\pi/3})  1+\\Re(1) \\end{pmatrix}$.\n$\\Re(j+e^{j\\pi/3}) = \\Re(j+\\frac{1}{2}+j\\frac{\\sqrt{3}}{2}) = \\frac{1}{2}$.\n$\\Re(-1+e^{j2\\pi/3}) = \\Re(-1-\\frac{1}{2}+j\\frac{\\sqrt{3}}{2}) = -\\frac{3}{2}$.\nBy symmetry of $\\mathbf{R}$, we get:\n$\\mathbf{R} = \\begin{pmatrix} 2  1/2  -3/2 \\\\ 1/2  2  1/2 \\\\ -3/2  1/2  2 \\end{pmatrix}$.\n\nThe full KKT system is thus:\n$$\n\\begin{pmatrix}\n4  1  -3  1  1 \\\\\n1  4  1  1  -1 \\\\\n-3  1  4  1  1 \\\\\n1  1  1  0  0 \\\\\n1  -1  1  0  0\n\\end{pmatrix}\n\\begin{pmatrix}\nh[0] \\\\ h[1] \\\\ h[2] \\\\ \\lambda_1 \\\\ \\lambda_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4 \\\\ 1 \\\\ -3 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\nFrom the last two rows (constraints):\n$h[0] + h[1] + h[2] = 0$\n$h[0] - h[1] + h[2] = 0$\nSubtracting the second equation from the first yields $2h[1] = 0$, so $h[1]=0$.\nSubstituting $h[1]=0$ into either equation gives $h[0]+h[2]=0$, so $h[2]=-h[0]$.\nNow substitute $h[1]=0$ and $h[2]=-h[0]$ into the first three rows of the system:\n1. $4h[0] + 0 - 3(-h[0]) + \\lambda_1 + \\lambda_2 = 4 \\implies 7h[0] + \\lambda_1 + \\lambda_2 = 4$\n2. $h[0] + 0 + (-h[0]) + \\lambda_1 - \\lambda_2 = 1 \\implies \\lambda_1 - \\lambda_2 = 1$\n3. $-3h[0] + 0 + 4(-h[0]) + \\lambda_1 + \\lambda_2 = -3 \\implies -7h[0] + \\lambda_1 + \\lambda_2 = -3$\nWe have a system for $h[0], \\lambda_1, \\lambda_2$.\nAdding equations (1) and (3):\n$(7h[0] + \\lambda_1 + \\lambda_2) + (-7h[0] + \\lambda_1 + \\lambda_2) = 4 - 3 \\implies 2(\\lambda_1 + \\lambda_2) = 1 \\implies \\lambda_1 + \\lambda_2 = 1/2$.\nWe now solve for the Lagrange multipliers:\n$\\lambda_1 + \\lambda_2 = 1/2$\n$\\lambda_1 - \\lambda_2 = 1$\nAdding these two equations gives $2\\lambda_1 = 3/2 \\implies \\lambda_1 = 3/4$.\nSubstituting back gives $\\lambda_2 = \\lambda_1 - 1 = 3/4 - 1 = -1/4$.\nFinally, substitute the multipliers back into equation (1):\n$7h[0] + (3/4) + (-1/4) = 4 \\implies 7h[0] + 1/2 = 4$.\n$7h[0] = 7/2 \\implies h[0] = 1/2$.\nThe coefficients are: $h[0]=1/2$, $h[1]=0$, and $h[2]=-h[0]=-1/2$.\nThe optimal impulse response vector is $\\mathbf{h} = [1/2, 0, -1/2]^T$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  0  -\\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "2872198"}]}