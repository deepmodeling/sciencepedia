{"hands_on_practices": [{"introduction": "This exercise challenges your intuition about resonant systems. We will use the geometric interpretation of the frequency response to analyze a simple second-order system and discover why the frequency of maximum response, $\\omega_{peak}$, does not necessarily align with the pole's angle, $\\theta_0$. This practice [@problem_id:1722830] is crucial for accurately predicting the behavior of filters and oscillators directly from their pole-zero plots.", "problem": "A stable, causal, second-order discrete-time linear time-invariant (LTI) system is characterized by the transfer function $H(z)$. The system has a pair of complex-conjugate poles located at $p_1 = re^{j\\theta_0}$ and $p_2 = re^{-j\\theta_0}$, and two zeros at the origin, $z=0$. The transfer function can be written as:\n$$\nH(z) = \\frac{K z^2}{(z - re^{j\\theta_0})(z - re^{-j\\theta_0})}\n$$\nwhere $K$ is a positive real constant. The pole radius $r$ is constrained by $0  r  1$, and the pole angle $\\theta_0$ is constrained by $0  \\theta_0  \\pi/2$.\n\nThe frequency response of this system is given by the Discrete-Time Fourier Transform (DTFT), $H(e^{j\\omega})$, for a real frequency variable $\\omega$. Let $\\omega_{peak}$ be the frequency in the range $0 \\le \\omega \\le \\pi$ at which the magnitude of the frequency response, $|H(e^{j\\omega})|$, is maximized.\n\nBased on a geometric evaluation of the DTFT from the system's pole-zero plot, determine the relationship between the peak frequency $\\omega_{peak}$ and the pole angle $\\theta_0$.\n\nA. $\\omega_{peak}  \\theta_0$\n\nB. $\\omega_{peak} = \\theta_0$\n\nC. $\\omega_{peak}  \\theta_0$\n\nD. The relationship depends on the value of the gain $K$.\n\nE. The relationship cannot be determined without specific numerical values for $r$ and $\\theta_0$.", "solution": "For the frequency response, substitute $z=e^{j\\omega}$ into $H(z)$ to obtain\n$$\nH(e^{j\\omega})=\\frac{K e^{j2\\omega}}{\\left(e^{j\\omega}-r e^{j\\theta_{0}}\\right)\\left(e^{j\\omega}-r e^{-j\\theta_{0}}\\right)}.\n$$\nOn the unit circle $|e^{j2\\omega}|=1$, so the magnitude is\n$$\n|H(e^{j\\omega})|=\\frac{K}{\\left|e^{j\\omega}-r e^{j\\theta_{0}}\\right|\\left|e^{j\\omega}-r e^{-j\\theta_{0}}\\right|}.\n$$\nTherefore the peak of $|H(e^{j\\omega})|$ occurs where the product of the distances to the two poles is minimized. Define\n$$\nA(\\omega)=\\left|e^{j\\omega}-r e^{j\\theta_{0}}\\right|^{2}=1+r^{2}-2r\\cos(\\omega-\\theta_{0}),\n$$\n$$\nB(\\omega)=\\left|e^{j\\omega}-r e^{-j\\theta_{0}}\\right|^{2}=1+r^{2}-2r\\cos(\\omega+\\theta_{0}),\n$$\nand set\n$$\nP(\\omega)=A(\\omega)B(\\omega).\n$$\nMaximizing $|H(e^{j\\omega})|$ is equivalent to minimizing $P(\\omega)$ on $0\\leq\\omega\\leq\\pi$. Use the product form with $\\cos(\\omega\\pm\\theta_{0})$ expanded:\n$$\nA(\\omega)=1+r^{2}-2r\\left(\\cos\\omega\\cos\\theta_{0}+\\sin\\omega\\sin\\theta_{0}\\right),\n$$\n$$\nB(\\omega)=1+r^{2}-2r\\left(\\cos\\omega\\cos\\theta_{0}-\\sin\\omega\\sin\\theta_{0}\\right).\n$$\nThen\n$$\nP(\\omega)=\\left(1+r^{2}-2r\\cos\\omega\\cos\\theta_{0}\\right)^{2}-4r^{2}\\sin^{2}\\omega\\,\\sin^{2}\\theta_{0}.\n$$\nUsing $\\sin^{2}\\omega=1-\\cos^{2}\\omega$ and simplifying,\n$$\nP(\\omega)=4r^{2}\\cos^{2}\\omega-4r(1+r^{2})\\cos\\theta_{0}\\cos\\omega+\\left[(1+r^{2})^{2}-4r^{2}\\sin^{2}\\theta_{0}\\right].\n$$\nLet $X=\\cos\\omega\\in[-1,1]$. This is a convex quadratic in $X$:\n$$\nP(X)=4r^{2}X^{2}-4r(1+r^{2})\\cos\\theta_{0}\\,X+\\text{const}.\n$$\nThe unconstrained minimizer is at\n$$\nX^{\\ast}=\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}.\n$$\nSince $0r1$, the factor $(1+r^{2})/(2r)=(r+1/r)/21$, and with $0\\theta_{0}\\pi/2$ we have $\\cos\\theta_{0}\\in(0,1)$, hence $X^{\\ast}\\cos\\theta_{0}0$. The constrained minimizer over $X\\in[-1,1]$ is therefore\n$$\n\\cos\\omega_{\\text{peak}}=\\min\\left\\{1,\\; \\frac{(1+r^{2})\\cos\\theta_{0}}{2r}\\right\\}.\n$$\nIn either case,\n- if $\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}\\leq 1$, then $\\cos\\omega_{\\text{peak}}=\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}\\cos\\theta_{0}$, hence $\\omega_{\\text{peak}}\\theta_{0}$ since $\\cos$ is strictly decreasing on $[0,\\pi]$,\n- if $\\frac{(1+r^{2})\\cos\\theta_{0}}{2r}1$, then $\\omega_{\\text{peak}}=0\\theta_{0}$.\n\nThus for all $0r1$ and $0\\theta_{0}\\pi/2$,\n$$\n\\omega_{\\text{peak}}\\theta_{0}.\n$$\nMoreover, the positive gain $K$ only scales the magnitude and does not affect the maximizing frequency. Therefore the correct relationship is $\\omega_{\\text{peak}}\\theta_{0}$.", "answer": "$$\\boxed{A}$$", "id": "1722830"}, {"introduction": "Having explored the effect of poles, we now turn our attention to zeros and their role in creating frequency-selective nulls. This problem guides you through the analysis of a notch filter, starting with the ideal case of a zero on the unit circle and then moving to a more practical scenario. You will derive a key geometric identity and analyze the notch's characteristics, such as its Full Width at Half Maximum (FWHM), providing a quantitative link between a zero's location and the filter's performance [@problem_id:2874556].", "problem": "Consider a discrete-time, linear time-invariant system with rational transfer function evaluated on the unit circle in the complex plane via the Discrete-Time Fourier Transform (DTFT). The geometric evaluation principle states that the magnitude of the frequency response at angular frequency $\\omega$ is given by the ratio of products of Euclidean distances in the complex plane from the point $e^{j\\omega}$ to the zeros and poles of the transfer function.\n\n1) Start from this geometric principle and the angle addition formulas from trigonometry. For a system having a single zero located on the unit circle at $z_{0}=e^{j\\omega_{0}}$, use the geometry of the complex plane to derive the identity\n$$\n\\left|e^{j\\omega}-e^{j\\omega_{0}}\\right| \\;=\\; 2\\left|\\sin\\!\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\nBriefly interpret this identity in terms of how a unit-circle zero creates a notch in the magnitude of the frequency response at $\\omega=\\omega_{0}$.\n\n2) Now move the zero radially to $z_{0}=r\\,e^{j\\omega_{0}}$ with $0r\\leq 1$, and consider the one-zero transfer function\n$$\nH(z)\\;=\\;K\\,\\bigl(1 - z_{0}\\,z^{-1}\\bigr),\n$$\nwith real gain $K0$ chosen to normalize the far-from-notch magnitude so that\n$$\n\\bigl|H\\!\\left(e^{j(\\omega_{0}+\\pi)}\\right)\\bigr| \\;=\\; 1.\n$$\nUsing the same geometric distance interpretation, express $\\bigl|H(e^{j\\omega})\\bigr|$ as a function of the frequency offset $\\Delta\\!\\omega=\\omega-\\omega_{0}$ and the radius $r$, and use this to define and compute the full width at half maximum (FWHM) of the notch. Here, the FWHM is defined as the total width in radians between the two frequencies symmetric about $\\omega_{0}$ at which $\\bigl|H(e^{j\\omega})\\bigr|$ equals the half-power level $2^{-1/2}$ relative to the normalized far-from-notch magnitude. State any condition(s) on $r$ under which such half-power crossings exist, and determine the FWHM in closed form as a function of $r$.\n\nYour final answer must be the FWHM in radians as a single closed-form analytic expression in terms of $r$. No numerical approximation is required, and no rounding should be applied.", "solution": "The problem as stated is logically consistent, scientifically grounded in the principles of digital signal processing, and well-posed. All provided information is sufficient for a unique solution. We will therefore proceed with a rigorous derivation.\n\nFirst, we address the derivation of the identity in Part 1. We are asked to prove that for a single zero on the unit circle at $z_{0}=e^{j\\omega_{0}}$, the Euclidean distance from a point $e^{j\\omega}$ on the unit circle to this zero is given by $|e^{j\\omega}-e^{j\\omega_{0}}| = 2|\\sin(\\frac{\\omega-\\omega_{0}}{2})|$.\nWe begin with the expression $|e^{j\\omega}-e^{j\\omega_{0}}|$. A direct geometric approach is most efficient. We factor out a complex exponential term corresponding to the average of the two angles:\n$$\ne^{j\\omega}-e^{j\\omega_{0}} = e^{j\\frac{\\omega+\\omega_{0}}{2}} \\left( e^{j\\frac{\\omega-\\omega_{0}}{2}} - e^{-j\\frac{\\omega-\\omega_{0}}{2}} \\right).\n$$\nUsing Euler's formula, we recall the identity $\\sin(\\theta) = \\frac{e^{j\\theta} - e^{-j\\theta}}{2j}$, which implies $e^{j\\theta} - e^{-j\\theta} = 2j\\sin(\\theta)$. Applying this to our expression gives:\n$$\ne^{j\\omega}-e^{j\\omega_{0}} = e^{j\\frac{\\omega+\\omega_{0}}{2}} \\left( 2j\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right) \\right).\n$$\nWe now compute the magnitude of both sides. The magnitude of a product is the product of the magnitudes:\n$$\n|e^{j\\omega}-e^{j\\omega_{0}}| = \\left|e^{j\\frac{\\omega+\\omega_{0}}{2}}\\right| \\left|2j\\right| \\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\nThe magnitude of any complex exponential $e^{j\\phi}$ is always $1$, and the magnitude of $2j$ is $|2j| = \\sqrt{0^2 + 2^2} = 2$. Therefore, we arrive at the required identity:\n$$\n|e^{j\\omega}-e^{j\\omega_{0}}| = 1 \\cdot 2 \\cdot \\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right| = 2\\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\nThe interpretation of this identity is straightforward. The magnitude of a system's frequency response $|H(e^{j\\omega})|$ is proportional to the distance from the point $e^{j\\omega}$ to the system's zeros. For a single zero at $e^{j\\omega_0}$, the magnitude response is proportional to $2|\\sin(\\frac{\\omega-\\omega_0}{2})|$. When the frequency $\\omega$ is equal to $\\omega_0$, this distance is zero because $\\sin(0) = 0$. This creates a perfect null, or \"notch,\" in the frequency response, completely attenuating the signal component at frequency $\\omega_0$. As $\\omega$ moves away from $\\omega_0$, the magnitude increases, characteristic of a notch filter.\n\nNext, for Part 2, we analyze the system with the transfer function $H(z) = K(1 - z_0 z^{-1})$, where the zero is $z_0 = r e^{j\\omega_0}$ with $0  r \\le 1$ and $K  0$. The frequency response is $H(e^{j\\omega}) = K(1 - r e^{j\\omega_0} e^{-j\\omega})$. The magnitude of the frequency response is given by the geometric principle as the gain $K$ multiplied by the distance from the point $e^{j\\omega}$ to the zero $z_0$.\n$$\n|H(e^{j\\omega})| = K |e^{j\\omega} - z_0| = K |e^{j\\omega} - r e^{j\\omega_0}|.\n$$\nTo calculate this magnitude, we find its square:\n$$\n|e^{j\\omega} - r e^{j\\omega_0}|^2 = (e^{j\\omega} - r e^{j\\omega_0})(e^{-j\\omega} - r e^{-j\\omega_0}) = 1 - r e^{j(\\omega-\\omega_0)} - r e^{-j(\\omega-\\omega_0)} + r^2 = 1 + r^2 - 2r \\cos(\\omega - \\omega_0).\n$$\nLetting $\\Delta\\omega = \\omega - \\omega_0$, the squared magnitude of the frequency response is $|H(e^{j\\omega})|^2 = K^2 (1 + r^2 - 2r \\cos(\\Delta\\omega))$.\nThe gain $K$ is determined by the normalization condition $|H(e^{j(\\omega_0+\\pi)})| = 1$. At this frequency, $\\Delta\\omega = (\\omega_0+\\pi) - \\omega_0 = \\pi$, and $\\cos(\\pi) = -1$.\n$$\n|H(e^{j(\\omega_0+\\pi)})|^2 = 1^2 = K^2 (1 + r^2 - 2r(-1)) = K^2 (1 + 2r + r^2) = K^2(1+r)^2.\n$$\nTaking the square root and using $K0, r0$, we find $1 = K(1+r)$, which gives $K = \\frac{1}{1+r}$.\nThe normalized magnitude response is thus:\n$$\n|H(e^{j\\omega})| = \\frac{\\sqrt{1 + r^2 - 2r \\cos(\\Delta\\omega)}}{1+r}.\n$$\nThe Full Width at Half Maximum (FWHM) is the width $2\\Delta\\omega_{1/2}$ between frequencies where the magnitude is at the half-power level relative to the normalized maximum. The reference magnitude is $1$, so the half-power level is $1/\\sqrt{2}$. We set $|H(e^{j\\omega})| = \\frac{1}{\\sqrt{2}}$ and solve for the corresponding frequency offset, which we denote $\\Delta\\omega_{1/2}$.\n$$\n\\frac{\\sqrt{1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})}}{1+r} = \\frac{1}{\\sqrt{2}}.\n$$\nSquaring both sides yields:\n$$\n\\frac{1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})}{(1+r)^2} = \\frac{1}{2}.\n$$\nWe solve for $\\cos(\\Delta\\omega_{1/2})$:\n$$\n2(1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})) = (1+r)^2 = 1 + 2r + r^2\n$$\n$$\n2 + 2r^2 - 4r \\cos(\\Delta\\omega_{1/2}) = 1 + 2r + r^2\n$$\n$$\n4r \\cos(\\Delta\\omega_{1/2}) = (2 + 2r^2) - (1 + 2r + r^2) = 1 - 2r + r^2 = (1-r)^2\n$$\n$$\n\\cos(\\Delta\\omega_{1/2}) = \\frac{(1-r)^2}{4r}.\n$$\nFor a real solution for $\\Delta\\omega_{1/2}$ to exist, we must have $|\\cos(\\Delta\\omega_{1/2})| \\le 1$. Since $r  0$ and $(1-r)^2 \\ge 0$, the expression is non-negative. We only need to check the condition:\n$$\n\\frac{(1-r)^2}{4r} \\le 1 \\implies (1-r)^2 \\le 4r \\implies 1 - 2r + r^2 \\le 4r \\implies r^2 - 6r + 1 \\le 0.\n$$\nThe roots of the quadratic equation $x^2 - 6x + 1 = 0$ are $x = 3 \\pm 2\\sqrt{2}$. Since the parabola opens upward, the inequality holds for $r$ between the roots: $3 - 2\\sqrt{2} \\le r \\le 3 + 2\\sqrt{2}$. Given the problem constraint $0  r \\le 1$, the condition for the existence of half-power crossings is the intersection of these ranges, which is $3 - 2\\sqrt{2} \\le r \\le 1$.\n\nUnder this condition, the half-width $\\Delta\\omega_{1/2}$ is found by taking the inverse cosine. By symmetry of the cosine function, there are two solutions, $\\pm \\Delta\\omega_{1/2}$, symmetrically placed around $\\Delta\\omega=0$.\n$$\n\\Delta\\omega_{1/2} = \\arccos\\left(\\frac{(1-r)^2}{4r}\\right).\n$$\nThe Full Width at Half Maximum (FWHM) is the total width, which is the difference between these two solutions: $\\Delta\\omega_{1/2} - (-\\Delta\\omega_{1/2}) = 2\\Delta\\omega_{1/2}$.\nTherefore, the FWHM is:\n$$\n\\text{FWHM} = 2 \\arccos\\left(\\frac{(1-r)^2}{4r}\\right).\n$$\nThis is the final closed-form expression for the FWHM of the notch as a function of the zero's radial position $r$.", "answer": "$$\\boxed{2\\arccos\\left(\\frac{(1-r)^{2}}{4r}\\right)}$$", "id": "2874556"}, {"introduction": "Real-world filter design often involves placing poles and zeros very close to each other to create sharp spectral features. This exercise [@problem_id:2874530] delves into the subtle but important effects of near-cancellation between a pole-zero pair. By applying first-order approximations to the geometric distance model, you will determine how a small mismatch in their positions governs the depth of the resulting notch, a key skill for designing and tolerancing high-performance filters.", "problem": "Consider a stable, causal, minimum-phase discrete-time linear time-invariant system with transfer function\n$$\nH(z) \\;=\\; R(z)\\,\\frac{1 - \\rho\\,e^{j\\theta_z}\\,z^{-1}}{1 - r\\,e^{j\\theta_p}\\,z^{-1}},\n$$\nwhere $0r,\\rho1$, the near-canceling pole and zero satisfy $r \\approx \\rho$ and $\\theta_p \\approx \\theta_z$, and the residual factor $R(z)$ has magnitude $|R(e^{j\\omega})|$ that is approximately flat and equal to $1$ in a narrow band around $\\omega \\approx \\theta_p \\approx \\theta_z$. Let the small mismatches be $\\Delta r \\triangleq \\rho - r$ and $\\Delta\\theta \\triangleq \\theta_z - \\theta_p$, with $|\\Delta r|\\ll 1$ and $|\\Delta\\theta|\\ll 1$. In terms of the geometric interpretation of the discrete-time Fourier transform on the unit circle, the magnitude $|H(e^{j\\omega})|$ is governed locally by the ratio of the distance from the point $e^{j\\omega}$ to the zero at $\\rho e^{j\\theta_z}$ and the distance to the pole at $r e^{j\\theta_p}$.\n\nFocus attention on the residual notch or peak produced by this near-canceling pair. Suppose $\\rhor$ so the zero is closer to the unit circle and a local notch occurs near $\\omega \\approx \\theta_z$. Using only fundamental definitions and the geometric interpretation (i.e., distances in the complex plane from $e^{j\\omega}$ to the pole and zero), determine a first-order accurate expression in $|\\Delta r|$ and $|\\Delta\\theta|$ for the residual notch magnitude, $|H(e^{j\\theta_z})|$. Which option correctly captures how the residual depth is controlled by the distance ratio?\n\nA) $|H(e^{j\\theta_z})| \\approx \\dfrac{\\bigl|1 - \\rho\\bigr|}{\\bigl|1 - r\\,e^{j(\\theta_p - \\theta_z)}\\bigr|} \\approx \\dfrac{\\bigl|1 - \\rho\\bigr|}{\\bigl|1 - r\\bigr|}$ to first order in $|\\Delta\\theta|$, i.e., the residual depth is set by the ratio of the distances from $e^{j\\theta_z}$ to the near-canceling zero and pole.\n\nB) $|H(e^{j\\theta_z})| \\approx \\bigl|\\Delta r + j\\,r\\,\\Delta\\theta\\bigr|$, i.e., the residual depends only on a small complex mismatch between locations and not on the distances to the unit circle.\n\nC) $|H(e^{j\\theta_z})| \\approx \\bigl|\\rho - r\\bigr|$, i.e., the residual depends only on the radial mismatch and not on the angular mismatch or unit-circle proximity.\n\nD) $|H(e^{j\\theta_z})| \\approx \\dfrac{\\bigl|1 - \\rho\\,e^{j\\Delta\\theta}\\bigr|}{\\bigl|1 - r\\,e^{j\\Delta\\theta}\\bigr|} \\approx 1 + \\mathcal{O}(\\Delta\\theta)$ regardless of $r$ and $\\rho$, i.e., an angular near-match alone implies an approximately unity residual.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- System Type: Stable, causal, minimum-phase discrete-time linear time-invariant (LTI).\n- Transfer Function: $H(z) = R(z)\\,\\frac{1 - \\rho\\,e^{j\\theta_z}\\,z^{-1}}{1 - r\\,e^{j\\theta_p}\\,z^{-1}}$.\n- Parameters: $0  r  1$, $0  \\rho  1$.\n- Conditions on Pole-Zero Pair: They are \"near-canceling,\" implying $r \\approx \\rho$ and $\\theta_p \\approx \\theta_z$.\n- Residual Factor: The magnitude $|R(e^{j\\omega})|$ is approximately flat and equal to $1$ in a narrow band around $\\omega \\approx \\theta_p \\approx \\theta_z$.\n- Small Mismatches: $\\Delta r \\triangleq \\rho - r$ and $\\Delta\\theta \\triangleq \\theta_z - \\theta_p$, with $|\\Delta r| \\ll 1$ and $|\\Delta\\theta| \\ll 1$.\n- Specific Condition: $\\rho  r$, which means the zero at $z_0 = \\rho e^{j\\theta_z}$ is closer to the unit circle than the pole at $p_0 = r e^{j\\theta_p}$. This is stated to produce a local notch.\n- Task: Determine a first-order accurate expression in $|\\Delta r|$ and $|\\Delta\\theta|$ for the notch magnitude $|H(e^{j\\theta_z})|$ using the geometric interpretation (distances in the complex plane).\n\n### Step 2: Validate Using Extracted Givens\nThe problem presented is a standard exercise in the analysis of digital filters in the field of signal processing.\n- **Scientifically Grounded**: The problem is based on the fundamental principles of Z-transforms, discrete-time systems, and the geometric interpretation of the discrete-time Fourier transform (DTFT) from pole-zero plots. All concepts are standard and well-established.\n- **Well-Posed**: The problem is clearly defined. It provides a specific transfer function, constraining conditions on the parameters, and asks for a specific quantity (the magnitude of the frequency response at a particular frequency) using a specified method of approximation (first-order accuracy). A unique mathematical expression can be derived.\n- **Objective**: The language is formal, precise, and free of any subjective or non-scientific statements.\n- **Completeness and Consistency**: The problem provides all necessary information. The assumption that $|R(e^{j\\omega})| \\approx 1$ is a standard simplification to isolate the effect of the pole-zero pair under study. There are no contradictions.\n- **Realism**: The scenario of a near-canceling pole-zero pair is a common design pattern for creating sharp features like notches or peaks in a filter's frequency response. The parameters are physically realistic for a stable, minimum-phase system.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a well-posed, scientifically sound problem from the domain of signals and systems. I will proceed with the derivation of the solution.\n\n### Derivation\nThe transfer function of the system is given by\n$$ H(z) \\;=\\; R(z)\\,\\frac{1 - \\rho\\,e^{j\\theta_z}\\,z^{-1}}{1 - r\\,e^{j\\theta_p}\\,z^{-1}} $$\nThis form corresponds to a system with a zero at $z_0 = \\rho e^{j\\theta_z}$ and a pole at $p_0 = r e^{j\\theta_p}$. The frequency response is obtained by evaluating $H(z)$ on the unit circle, $z = e^{j\\omega}$.\n$$ H(e^{j\\omega}) \\;=\\; R(e^{j\\omega})\\,\\frac{1 - \\rho\\,e^{j\\theta_z}\\,e^{-j\\omega}}{1 - r\\,e^{j\\theta_p}\\,e^{-j\\omega}} $$\nThe magnitude of the frequency response can be expressed using the geometric interpretation. By factoring out $e^{-j\\omega}$ from the numerator and denominator, we have:\n$$ H(e^{j\\omega}) \\;=\\; R(e^{j\\omega})\\,\\frac{e^{-j\\omega}(e^{j\\omega} - \\rho e^{j\\theta_z})}{e^{-j\\omega}(e^{j\\omega} - r e^{j\\theta_p})} \\;=\\; R(e^{j\\omega})\\,\\frac{e^{j\\omega} - z_0}{e^{j\\omega} - p_0} $$\nThe magnitude is therefore the product of the magnitude of the residual factor and the ratio of the distance from the point $e^{j\\omega}$ on the unit circle to the zero $z_0$, and the distance from $e^{j\\omega}$ to the pole $p_0$.\n$$ |H(e^{j\\omega})| \\;=\\; |R(e^{j\\omega})|\\,\\frac{|e^{j\\omega} - z_0|}{|e^{j\\omega} - p_0|} $$\nWe are asked to find the magnitude at the nominal notch frequency, $\\omega = \\theta_z$. At this frequency, we use the given approximation $|R(e^{j\\theta_z})| \\approx 1$:\n$$ |H(e^{j\\theta_z})| \\;\\approx\\; \\frac{|e^{j\\theta_z} - \\rho e^{j\\theta_z}|}{|e^{j\\theta_z} - r e^{j\\theta_p}|} $$\nLet us analyze the numerator and the denominator separately.\n\nThe numerator is the distance between the point $e^{j\\theta_z}$ on the unit circle and the zero $\\rho e^{j\\theta_z}$. Since both points lie on the same radial line from the origin at angle $\\theta_z$, their distance is simply the difference in their radii:\n$$ |e^{j\\theta_z} - \\rho e^{j\\theta_z}| \\;=\\; |(1-\\rho)e^{j\\theta_z}| \\;=\\; |1-\\rho|\\,|e^{j\\theta_z}| \\;=\\; 1-\\rho $$\nsince it is given that $0  \\rho  1$.\n\nThe denominator is the distance between the point $e^{j\\theta_z}$ on the unit circle and the pole $r e^{j\\theta_p}$.\n$$ |e^{j\\theta_z} - r e^{j\\theta_p}| $$\nTo simplify this expression, we factor out $e^{j\\theta_z}$ and use the definition $\\Delta\\theta = \\theta_z - \\theta_p$:\n$$ |e^{j\\theta_z} - r e^{j\\theta_p}| \\;=\\; |e^{j\\theta_z}(1 - r e^{j(\\theta_p - \\theta_z)})| \\;=\\; |e^{j\\theta_z}|\\,|1 - r e^{-j\\Delta\\theta}| \\;=\\; |1 - r e^{-j\\Delta\\theta}| $$\nSo, the exact expression for the magnitude (assuming $|R|=1$) is:\n$$ |H(e^{j\\theta_z})| \\;\\approx\\; \\frac{1-\\rho}{|1 - r e^{-j\\Delta\\theta}|} $$\nThe problem asks for a first-order accurate expression in $|\\Delta\\theta|$. Let us analyze the denominator term $f(\\Delta\\theta) = |1 - r e^{-j\\Delta\\theta}|$. We can write its square as:\n$$ f(\\Delta\\theta)^2 = |1 - r(\\cos(\\Delta\\theta) + j\\sin(\\Delta\\theta))|^2 = (1-r\\cos(\\Delta\\theta))^2 + (r\\sin(\\Delta\\theta))^2 $$\n$$ = 1 - 2r\\cos(\\Delta\\theta) + r^2\\cos^2(\\Delta\\theta) + r^2\\sin^2(\\Delta\\theta) = 1 + r^2 - 2r\\cos(\\Delta\\theta) $$\nTo find a first-order approximation, we perform a Taylor expansion of $f(\\Delta\\theta)$ around $\\Delta\\theta=0$.\n$$ f(0) = \\sqrt{1 + r^2 - 2r} = \\sqrt{(1-r)^2} = 1-r $$\nThe first derivative is:\n$$ f'(\\Delta\\theta) = \\frac{d}{d(\\Delta\\theta)} \\left( (1 + r^2 - 2r\\cos(\\Delta\\theta))^{1/2} \\right) = \\frac{1}{2f(\\Delta\\theta)} (2r\\sin(\\Delta\\theta)) = \\frac{r\\sin(\\Delta\\theta)}{f(\\Delta\\theta)} $$\nAt $\\Delta\\theta=0$, the derivative is $f'(0) = \\frac{r\\sin(0)}{f(0)} = 0$.\nThe Taylor expansion is $f(\\Delta\\theta) \\approx f(0) + f'(0)\\Delta\\theta + \\mathcal{O}((\\Delta\\theta)^2)$. Since $f'(0)=0$, the first-order approximation is simply the constant term:\n$$ |1 - r e^{-j\\Delta\\theta}| \\approx f(0) = 1-r $$\nThis approximation is accurate to first order in $|\\Delta\\theta|$, as the first correction term is of second order.\nSubstituting this approximation into our expression for the magnitude gives:\n$$ |H(e^{j\\theta_z})| \\;\\approx\\; \\frac{1-\\rho}{1-r} $$\nThis expression is first-order accurate in both $|\\Delta r|$ and $|\\Delta\\theta|$. It is explicitly linear in $\\rho$ (and thus $\\Delta r = \\rho-r$) and zeroth-order in $\\Delta\\theta$ (since the first-order term in $\\Delta\\theta$ is zero).\n\n### Option-by-Option Analysis\n\nA) $|H(e^{j\\theta_z})| \\approx \\dfrac{\\bigl|1 - \\rho\\bigr|}{\\bigl|1 - r\\,e^{j(\\theta_p - \\theta_z)}\\bigr|} \\approx \\dfrac{\\bigl|1 - \\rho\\bigr|}{\\bigl|1 - r\\bigr|}$ to first order in $|\\Delta\\theta|$, i.e., the residual depth is set by the ratio of the distances from $e^{j\\theta_z}$ to the near-canceling zero and pole.\n\nThe first part of the expression, $\\dfrac{|1 - \\rho|}{|1 - r e^{j(\\theta_p - \\theta_z)}|} = \\dfrac{1 - \\rho}{|1 - r e^{-j\\Delta\\theta}|}$, is the exact magnitude derived above (assuming $|R|=1$). The second part, $\\dfrac{|1 - \\rho|}{|1 - r|} = \\dfrac{1 - \\rho}{1 - r}$, is the correct first-order approximation in $|\\Delta\\theta|$ as demonstrated in the derivation. The concluding sentence, while potentially ambiguous, can be interpreted as a correct description of the geometric origin of the exact expression that precedes the approximation. The entire statement is mathematically sound.\n**Verdict: Correct**\n\nB) $|H(e^{j\\theta_z})| \\approx \\bigl|\\Delta r + j\\,r\\,\\Delta\\theta\\bigr|$, i.e., the residual depends only on a small complex mismatch between locations and not on the distances to the unit circle.\n\nThe expression $|\\Delta r + j r \\Delta\\theta|$ is an approximation for the magnitude of the vector separating the zero and the pole, i.e., $|z_0 - p_0|$. The frequency response magnitude is a ratio of distances from a point on the unit circle to the zero and pole, not the distance between the pole and zero themselves. The result should depend on the proximity of the pole and zero to the unit circle (i.e., on $1-r$ and $1-\\rho$), which this option incorrectly claims it does not.\n**Verdict: Incorrect**\n\nC) $|H(e^{j\\theta_z})| \\approx \\bigl|\\rho - r\\bigr|$, i.e., the residual depends only on the radial mismatch and not on the angular mismatch or unit-circle proximity.\n\nThis option suggests the magnitude is approximately $|\\Delta r| = \\rho-r$. Our derivation yields $\\frac{1-\\rho}{1-r} = \\frac{1-(r+\\Delta r)}{1-r} = 1 - \\frac{\\Delta r}{1-r}$. Equating this to $\\Delta r$ is not valid in general. For poles and zeros close to the unit circle ($r \\approx 1$), the term $1-r$ is small, making the factor $\\frac{1}{1-r}$ significant. For instance, if $r=0.95$ and $\\rho=0.97$, then $\\Delta r=0.02$. The expression in this option yields $0.02$. Our derived expression gives $\\frac{1-0.97}{1-0.95} = \\frac{0.03}{0.05} = 0.6$. The two results are vastly different.\n**Verdict: Incorrect**\n\nD) $|H(e^{j\\theta_z})| \\approx \\dfrac{\\bigl|1 - \\rho\\,e^{j\\Delta\\theta}\\bigr|}{\\bigl|1 - r\\,e^{j\\Delta\\theta}\\bigr|} \\approx 1 + \\mathcal{O}(\\Delta\\theta)$ regardless of $r$ and $\\rho$, i.e., an angular near-match alone implies an approximately unity residual.\n\nThe formula $\\frac{|1 - \\rho e^{j\\Delta\\theta}|}{|1 - r e^{j\\Delta\\theta}|}$ does not correspond to the evaluation of $|H(e^{j\\omega})|$ at $\\omega=\\theta_z$. The correct expression for the magnitude is $\\frac{1-\\rho}{|1-re^{-j\\Delta\\theta}|}$. Furthermore, the claim that the result is near $1$ regardless of $r$ and $\\rho$ just because $\\Delta\\theta$ is small is false. As shown in the derivation, the magnitude is $\\approx \\frac{1-\\rho}{1-r}$. If $r$ is close to $1$, even a small difference between $\\rho$ and $r$ can lead to a magnitude significantly different from $1$. For example if $r=0.99$ and $\\rho=0.995$, the magnitude is $\\approx \\frac{1-0.995}{1-0.99} = \\frac{0.005}{0.01} = 0.5$.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2874530"}]}