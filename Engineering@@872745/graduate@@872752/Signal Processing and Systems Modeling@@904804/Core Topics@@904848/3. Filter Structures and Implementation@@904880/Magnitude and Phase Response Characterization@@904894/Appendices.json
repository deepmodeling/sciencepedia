{"hands_on_practices": [{"introduction": "This exercise serves as a fundamental workout, guiding you from a system's most basic representation—its impulse response—to a full characterization of its frequency-domain behavior. By analyzing a simple yet illustrative system consisting of a direct path and a single echo, you will derive the magnitude and phase response from first principles. This practice reinforces the direct link between time-domain features and their spectral consequences, such as the periodic ripples characteristic of a comb filter [@problem_id:2882292].", "problem": "Consider a continuous-time, Linear Time-Invariant (LTI) system with impulse response $h(t)=\\delta(t)+\\alpha\\,\\delta(t-\\tau)$, where $\\delta(t)$ is the Dirac delta function, $\\alpha\\in\\mathbb{R}$, and $\\tau0$. Use only the definition of the Continuous-Time Fourier Transform (CTFT), $H(j\\omega)=\\int_{-\\infty}^{\\infty}h(t)\\,\\exp(-j\\omega t)\\,dt$, and core trigonometric identities (such as the Euler identity) to analyze this system.\n\nTasks:\n1) Derive the frequency response $H(j\\omega)$ from the CTFT definition.\n\n2) From first principles, derive closed-form expressions for the magnitude $|H(j\\omega)|$ and the principal-value phase $\\angle H(j\\omega)$ as functions of $\\omega$. All angles must be in radians.\n\n3) Characterize the magnitude ripple:\n- Determine the period in $\\omega$ of the magnitude response.\n- Determine the global maxima and minima of $|H(j\\omega)|$ over $\\omega\\in\\mathbb{R}$, and the full sets of frequencies where they occur, in terms of $\\alpha$ and $\\tau$.\n- Give a necessary and sufficient condition on $\\alpha$ for which $|H(j\\omega)|$ has exact spectral nulls (zeros), and specify the corresponding frequencies.\n\n4) Characterize the phase behavior:\n- Provide an explicit analytic expression for the principal-value phase $\\angle H(j\\omega)$ using the two-argument arctangent function $\\arctan2(\\cdot,\\cdot)$.\n- Identify the frequencies at which the principal-value phase exhibits jumps (discontinuities), and explain how these depend on $\\alpha$ and $\\tau$.\n\nProvide your reasoning steps clearly and justify each conclusion from the definitions and identities you use. Report as your final answer the single closed-form analytic expression for the magnitude $|H(j\\omega)|$ as a function of $\\omega$, $\\alpha$, and $\\tau$. No numerical evaluation or rounding is required.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extract Givens**\n- System type: Continuous-time, Linear Time-Invariant (LTI).\n- Impulse response: $h(t)=\\delta(t)+\\alpha\\,\\delta(t-\\tau)$.\n- Parameters: $\\alpha\\in\\mathbb{R}$ and $\\tau0$.\n- Definition of CTFT: $H(j\\omega)=\\int_{-\\infty}^{\\infty}h(t)\\,\\exp(-j\\omega t)\\,dt$.\n- Required tools: CTFT definition and core trigonometric identities.\n- Tasks:\n    1. Derive the frequency response $H(j\\omega)$.\n    2. Derive expressions for magnitude $|H(j\\omega)|$ and phase $\\angle H(j\\omega)$.\n    3. Characterize the magnitude response: period, global maxima/minima, and conditions for spectral nulls.\n    4. Characterize the phase response: provide the $\\arctan2$ form and identify frequencies of discontinuities.\n- Final Answer Requirement: A single closed-form analytic expression for $|H(j\\omega)|$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard FIR filter structure (a direct path plus a single echo), a fundamental model in signal processing known as a comb filter. The problem is self-contained, with all necessary parameters and definitions provided ($\\alpha$, $\\tau$, CTFT definition). The tasks are specific, logically structured, and solvable using standard mathematical techniques in system analysis. The problem is free of scientific flaws, ambiguities, or contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived.\n\nThe derivation proceeds by addressing each task in sequence.\n\n**1) Derivation of the Frequency Response $H(j\\omega)$**\n\nThe frequency response $H(j\\omega)$ is the Continuous-Time Fourier Transform (CTFT) of the impulse response $h(t)$. Using the provided definition:\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} h(t) \\exp(-j\\omega t) dt$$\nSubstitute the given impulse response $h(t) = \\delta(t) + \\alpha\\delta(t-\\tau)$:\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} (\\delta(t) + \\alpha\\delta(t-\\tau)) \\exp(-j\\omega t) dt$$\nBy the linearity of integration, this can be split into two integrals:\n$$H(j\\omega) = \\int_{-\\infty}^{\\infty} \\delta(t) \\exp(-j\\omega t) dt + \\alpha \\int_{-\\infty}^{\\infty} \\delta(t-\\tau) \\exp(-j\\omega t) dt$$\nWe apply the sifting property of the Dirac delta function, which states that $\\int_{-\\infty}^{\\infty} f(t)\\delta(t-t_0)dt = f(t_0)$.\nFor the first integral, the function is $\\exp(-j\\omega t)$ and the delta function is at $t_0=0$. This yields:\n$$\\int_{-\\infty}^{\\infty} \\delta(t) \\exp(-j\\omega t) dt = \\exp(-j\\omega \\cdot 0) = \\exp(0) = 1$$\nFor the second integral, the function is $\\exp(-j\\omega t)$ and the delta function is at $t_0=\\tau$. This yields:\n$$\\alpha \\int_{-\\infty}^{\\infty} \\delta(t-\\tau) \\exp(-j\\omega t) dt = \\alpha \\exp(-j\\omega\\tau)$$\nCombining these two results gives the frequency response:\n$$H(j\\omega) = 1 + \\alpha\\exp(-j\\omega\\tau)$$\n\n**2) Derivation of Magnitude $|H(j\\omega)|$ and Phase $\\angle H(j\\omega)$**\n\nTo find the magnitude and phase, we first express $H(j\\omega)$ in rectangular form $X(\\omega) + jY(\\omega)$. Using Euler's identity, $\\exp(-j\\theta) = \\cos(\\theta) - j\\sin(\\theta)$, we have:\n$$H(j\\omega) = 1 + \\alpha(\\cos(\\omega\\tau) - j\\sin(\\omega\\tau))$$\n$$H(j\\omega) = (1 + \\alpha\\cos(\\omega\\tau)) - j(\\alpha\\sin(\\omega\\tau))$$\nThe real part is $X(\\omega) = 1 + \\alpha\\cos(\\omega\\tau)$ and the imaginary part is $Y(\\omega) = -\\alpha\\sin(\\omega\\tau)$.\n\nThe magnitude $|H(j\\omega)|$ is given by $\\sqrt{X(\\omega)^2 + Y(\\omega)^2}$:\n$$|H(j\\omega)| = \\sqrt{(1 + \\alpha\\cos(\\omega\\tau))^2 + (-\\alpha\\sin(\\omega\\tau))^2}$$\nExpanding the terms inside the square root:\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2\\cos^2(\\omega\\tau) + \\alpha^2\\sin^2(\\omega\\tau)}$$\nUsing the fundamental trigonometric identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2(\\cos^2(\\omega\\tau) + \\sin^2(\\omega\\tau))}$$\n$$|H(j\\omega)| = \\sqrt{1 + 2\\alpha\\cos(\\omega\\tau) + \\alpha^2}$$\nThis is the closed-form expression for the magnitude.\n\nThe principal-value phase $\\angle H(j\\omega)$ is given by the two-argument arctangent function, $\\arctan2(Y(\\omega), X(\\omega))$:\n$$\\angle H(j\\omega) = \\arctan2(-\\alpha\\sin(\\omega\\tau), 1 + \\alpha\\cos(\\omega\\tau))$$\n\n**3) Characterization of Magnitude Ripple**\n\n- **Period of the Magnitude Response:**\nThe magnitude $|H(j\\omega)| = \\sqrt{1 + \\alpha^2 + 2\\alpha\\cos(\\omega\\tau)}$ is a function of $\\cos(\\omega\\tau)$. The function $\\cos(\\theta)$ has a period of $2\\pi$. Thus, the magnitude response is periodic in $\\omega$. The period $T_\\omega$ must satisfy $\\omega\\tau + T_\\omega\\tau = \\omega\\tau + 2\\pi k$ for some integer $k$. The fundamental period (for $k=1$) is given by $T_\\omega\\tau = 2\\pi$, which means:\n$$T_\\omega = \\frac{2\\pi}{\\tau}$$\n\n- **Global Maxima and Minima:**\nThe extrema of $|H(j\\omega)|$ correspond to the extrema of its square, $|H(j\\omega)|^2 = 1 + \\alpha^2 + 2\\alpha\\cos(\\omega\\tau)$, since the square root function is monotonically increasing for non-negative arguments. The extrema are determined by the term $2\\alpha\\cos(\\omega\\tau)$.\nThe maximum value of $|H(j\\omega)|^2$ is $1 + \\alpha^2 + 2|\\alpha|$, which equals $(1+|\\alpha|)^2$. The global maximum of the magnitude is therefore $1+|\\alpha|$. This occurs when $\\alpha\\cos(\\omega\\tau) = |\\alpha|$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=1$, so $\\omega\\tau=2n\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{2n\\pi}{\\tau}$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=-1$, so $\\omega\\tau=(2n+1)\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{(2n+1)\\pi}{\\tau}$.\nThe minimum value of $|H(j\\omega)|^2$ is $1 + \\alpha^2 - 2|\\alpha|$, which equals $(1-|\\alpha|)^2$. The global minimum of the magnitude is therefore $|1-|\\alpha||$. This occurs when $\\alpha\\cos(\\omega\\tau) = -|\\alpha|$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=-1$, so $\\omega\\tau=(2n+1)\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{(2n+1)\\pi}{\\tau}$.\n    - If $\\alpha0$, this is when $\\cos(\\omega\\tau)=1$, so $\\omega\\tau=2n\\pi$ for $n\\in\\mathbb{Z}$. Frequencies: $\\omega = \\frac{2n\\pi}{\\tau}$.\n\n- **Spectral Nulls:**\nExact spectral nulls occur when $|H(j\\omega)| = 0$. This requires the global minimum to be zero: $|1-|\\alpha|| = 0$. This implies $|\\alpha|=1$.\nThe necessary and sufficient condition for spectral nulls is $\\alpha=1$ or $\\alpha=-1$.\n    - If $\\alpha=1$, the nulls occur at frequencies where the minimum is reached: $\\omega = \\frac{(2n+1)\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n    - If $\\alpha=-1$, the nulls occur at frequencies where the minimum is reached: $\\omega = \\frac{2n\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n\n**4) Characterization of Phase Behavior**\n\n- **Analytic Expression for Phase:**\nAs derived in part 2, the explicit analytic expression for the principal-value phase is:\n$$\\angle H(j\\omega) = \\arctan2(-\\alpha\\sin(\\omega\\tau), 1 + \\alpha\\cos(\\omega\\tau))$$\n\n- **Phase Discontinuities (Jumps):**\nDiscontinuities in the principal-value phase occur when the complex number $H(j\\omega)$ crosses the negative real axis. This happens when the imaginary part is zero and the real part is negative.\n1. Imaginary part is zero: $Y(\\omega) = -\\alpha\\sin(\\omega\\tau) = 0$. Assuming $\\alpha \\neq 0$, this implies $\\sin(\\omega\\tau)=0$, which occurs when $\\omega\\tau = k\\pi$ for any integer $k \\in \\mathbb{Z}$. The frequencies are $\\omega_k = \\frac{k\\pi}{\\tau}$.\n2. Real part is negative: $X(\\omega_k) = 1+\\alpha\\cos(\\omega_k\\tau) = 1+\\alpha\\cos(k\\pi)  0$. Since $\\cos(k\\pi) = (-1)^k$, the condition is $1+\\alpha(-1)^k  0$.\n\nWe analyze this condition for even and odd $k$:\n- If $k$ is an even integer ($k=2n$), the condition becomes $1 + \\alpha  0$, which is $\\alpha  -1$. The phase jumps occur at frequencies $\\omega = \\frac{2n\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n- If $k$ is an odd integer ($k=2n+1$), the condition becomes $1 - \\alpha  0$, which is $\\alpha  1$. The phase jumps occur at frequencies $\\omega = \\frac{(2n+1)\\pi}{\\tau}$ for $n\\in\\mathbb{Z}$.\n\nIn the edge cases where $|\\alpha|=1$, the real part becomes zero at these frequencies, which corresponds to the spectral nulls. At these points of zero magnitude, the phase is undefined, which manifests as a discontinuity of size $\\pi$ radians.\nIn summary, phase jumps occur if and only if $|\\alpha| \\ge 1$.\n- For $\\alpha \\ge 1$: Jumps are at $\\omega = \\frac{(2n+1)\\pi}{\\tau}$, for $n\\in\\mathbb{Z}$.\n- For $\\alpha \\le -1$: Jumps are at $\\omega = \\frac{2n\\pi}{\\tau}$, for $n\\in\\mathbb{Z}$.\n- For $|\\alpha|  1$: There are no phase discontinuities.", "answer": "$$\\boxed{\\sqrt{1 + \\alpha^{2} + 2\\alpha \\cos(\\omega \\tau)}}$$", "id": "2882292"}, {"introduction": "While the magnitude response often receives primary attention, the phase response is critical in determining a system's transient behavior and signal distortion. This problem explores the powerful concept of all-pass systems, which allow for the modification of phase and group delay without altering the magnitude response. By analyzing the effect of reflecting a system zero across the unit circle, you will quantify the exact change in group delay, gaining a deeper appreciation for the distinction between minimum-phase and non-minimum-phase systems [@problem_id:2882304].", "problem": "Consider a linear time-invariant (LTI) discrete-time system with transfer function $H_{1}(z)$ whose zeros and poles are all strictly off the unit circle except possibly at the origin, and let $z_{0} \\in \\mathbb{C}$ be a single zero of $H_{1}(z)$ with $|z_{0}| \\neq 1$. Suppose $H_{1}(z)$ factors as $H_{1}(z) = C \\left(1 - z_{0} z^{-1}\\right) G(z)$, where $C \\in \\mathbb{C}$ is a nonzero constant and $G(z)$ contains all the remaining factors (zeros and poles) of $H_{1}(z)$ and has no zeros or poles on the unit circle. Construct a second system $H_{2}(z)$ by replacing the factor $\\left(1 - z_{0} z^{-1}\\right)$ with $\\left(1 - z_{0}^{- \\ast} z^{-1}\\right)$, where $z_{0}^{- \\ast} \\triangleq 1/z_{0}^{\\ast}$ is the reflection of $z_{0}$ across the unit circle, and scale $H_{2}(z)$ by a complex constant $\\tilde{C}$ chosen so that $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$ for all real $\\omega$ (in radians). That is,\n$$\nH_{2}(z) \\triangleq \\tilde{C} \\left(1 - z_{0}^{- \\ast} z^{-1}\\right) G(z).\n$$\nWork from first principles using only the definitions of the discrete-time frequency response, magnitude, phase, and group delay, namely $H(\\exp(j \\omega)) \\triangleq H(z)\\big|_{z=\\exp(j\\omega)}$, $|H(\\exp(j\\omega))| \\triangleq \\sqrt{H(\\exp(j\\omega)) H^{\\ast}(\\exp(j\\omega))}$, $\\angle H(\\exp(j\\omega)) \\triangleq \\arg H(\\exp(j\\omega))$, and the group delay $\\tau_{g}(\\omega) \\triangleq - \\frac{d}{d \\omega} \\angle H(\\exp(j \\omega))$. Starting from these definitions and without invoking any pre-memorized “shortcut” formulas:\n\n1) Prove that there exists a choice of $\\tilde{C}$ that ensures $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$ for all real $\\omega$, and identify such a choice.\n\n2) Show that, with this choice, the ratio\n$$\nQ(\\exp(j \\omega)) \\triangleq \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))}\n$$\nhas unit magnitude for all real $\\omega$ and therefore can be interpreted as an all-pass factor on the unit circle that accounts for the phase change introduced by the zero reflection.\n\n3) Derive a closed-form expression for the group delay difference\n$$\n\\Delta \\tau_{g}(\\omega) \\triangleq \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega) \\, ,\n$$\nentirely in terms of $z_{0}$ and $\\omega$, where $\\tau_{g,i}(\\omega)$ denotes the group delay of $H_{i}$ for $i \\in \\{1,2\\}$. Express your final result using $|z_{0}|$ and $\\arg(z_{0})$, as an explicit function of $\\omega$ (in radians). Express the group delay difference in samples.\n\nYour final answer must be a single closed-form analytic expression for $\\Delta \\tau_{g}(\\omega)$ in terms of $|z_{0}|$, $\\arg(z_{0})$, and $\\omega$; no numerical evaluation is required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- System 1 transfer function: $H_{1}(z) = C \\left(1 - z_{0} z^{-1}\\right) G(z)$.\n- $z_{0} \\in \\mathbb{C}$ is a single zero of $H_1(z)$ with $|z_{0}| \\neq 1$.\n- $C \\in \\mathbb{C}$ is a nonzero constant.\n- $G(z)$ contains all other poles and zeros of $H_1(z)$ and has no poles or zeros on the unit circle.\n- System 2 transfer function: $H_{2}(z) = \\tilde{C} \\left(1 - z_{0}^{- \\ast} z^{-1}\\right) G(z)$.\n- Definition of reflected zero: $z_{0}^{- \\ast} \\triangleq 1/z_{0}^{\\ast}$.\n- Condition: The scaling constant $\\tilde{C}$ is chosen such that $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$ for all real $\\omega$.\n- Frequency response: $H(\\exp(j \\omega)) \\triangleq H(z)\\big|_{z=\\exp(j\\omega)}$.\n- Magnitude: $|H(\\exp(j\\omega))| \\triangleq \\sqrt{H(\\exp(j\\omega)) H^{\\ast}(\\exp(j\\omega))}$.\n- Phase: $\\angle H(\\exp(j\\omega)) \\triangleq \\arg H(\\exp(j\\omega))$.\n- Group delay: $\\tau_{g}(\\omega) \\triangleq - \\frac{d}{d \\omega} \\angle H(\\exp(j \\omega))$, in samples.\n- Ratio: $Q(\\exp(j \\omega)) \\triangleq \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))}$.\n- Group delay difference: $\\Delta \\tau_{g}(\\omega) \\triangleq \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega)$.\n\nStep 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a standard exercise in digital signal processing, concerning the properties of all-pass filters and the relationship between minimum-phase and non-minimum-phase systems. All concepts and definitions are fundamental to the field.\n- **Well-Posed**: The problem is structured as a sequence of three related tasks. Each task is clearly defined, and the necessary information to proceed from one to the next is provided or derivable. A unique solution for the group delay difference is expected.\n- **Objective**: The problem is stated using precise mathematical language, free from any subjectivity or ambiguity.\n\nStep 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and objective. It is a standard, non-trivial problem in signal processing theory. I will proceed with the solution.\n\nThe solution is structured in three parts as requested by the problem.\n\n1) Existence and identification of $\\tilde{C}$\n\nThe condition to be satisfied is $|H_{1}(\\exp(j \\omega))| = |H_{2}(\\exp(j \\omega))|$. We evaluate the magnitudes of the transfer functions on the unit circle, where $z = \\exp(j \\omega)$.\n$$|H_{1}(\\exp(j \\omega))| = |C| |1 - z_{0} \\exp(-j \\omega)| |G(\\exp(j \\omega))|$$\n$$|H_{2}(\\exp(j \\omega))| = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)| |G(\\exp(j \\omega))|$$\nEquating these two expressions and noting that $|G(\\exp(j \\omega))|$ is finite and nonzero, we can cancel this term to obtain:\n$$|C| |1 - z_{0} \\exp(-j \\omega)| = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\nWe must now relate the terms $|1 - z_{0} \\exp(-j \\omega)|$ and $|1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$. Let us analyze the second term, using the definition $z_{0}^{- \\ast} = 1/z_{0}^{\\ast}$.\n$$|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\left|1 - \\frac{1}{z_{0}^{\\ast}} \\exp(-j \\omega)\\right| = \\left|\\frac{z_{0}^{\\ast} - \\exp(-j \\omega)}{z_{0}^{\\ast}}\\right| = \\frac{|z_{0}^{\\ast} - \\exp(-j \\omega)|}{|z_{0}^{\\ast}|}$$\nUsing the property that $|w^{\\ast}| = |w|$ for any complex number $w$, we have $|z_{0}^{\\ast}| = |z_{0}|$ and $|z_{0}^{\\ast} - \\exp(-j \\omega)| = |(z_{0} - \\exp(j \\omega))^{\\ast}| = |z_{0} - \\exp(j \\omega)|$.\n$$|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\frac{|z_{0} - \\exp(j \\omega)|}{|z_{0}|}$$\nNow, for the first term:\n$$|1 - z_{0} \\exp(-j \\omega)| = |\\exp(-j \\omega) (\\exp(j \\omega) - z_{0})| = |\\exp(-j \\omega)| |\\exp(j \\omega) - z_{0}|$$\nSince $|\\exp(-j \\omega)| = 1$, we have $|1 - z_{0} \\exp(-j \\omega)| = |z_{0} - \\exp(j \\omega)|$.\nBy combining these results, we find the relationship between the two factors:\n$$|1 - z_{0} \\exp(-j \\omega)| = |z_{0}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\nSubstituting this back into the condition on the magnitudes:\n$$|C| \\left(|z_{0}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|\\right) = |\\tilde{C}| |1 - z_{0}^{- \\ast} \\exp(-j \\omega)|$$\nSince $z_0$ is not on the unit circle, its reflection $z_0^{-*}$ is also not on the unit circle. Therefore, the term $1 - z_{0}^{- \\ast} \\exp(-j \\omega)$ is never zero for any $\\omega$, and its magnitude can be cancelled. This yields:\n$$|C| |z_{0}| = |\\tilde{C}|$$\nThis proves that a constant $\\tilde{C}$ satisfying the magnitude condition exists. Its magnitude is determined, but its phase is arbitrary. A valid choice for $\\tilde{C}$ is one that satisfies this magnitude relation, for example, by scaling $C$ by the positive real number $|z_0|$. A simple choice is $\\tilde{C} = C |z_{0}|$.\n\n2) Verification of the all-pass property of $Q(\\exp(j \\omega))$\n\nThe ratio $Q(\\exp(j \\omega))$ is defined as:\n$$Q(\\exp(j \\omega)) = \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))} = \\frac{\\tilde{C} \\left(1 - z_{0}^{- \\ast} \\exp(-j \\omega)\\right) G(\\exp(j \\omega))}{C \\left(1 - z_{0} \\exp(-j \\omega)\\right) G(\\exp(j \\omega))}$$\nThe factor $G(\\exp(j \\omega))$ cancels out:\n$$Q(\\exp(j \\omega)) = \\frac{\\tilde{C}}{C} \\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}$$\nTo show it has unit magnitude, we compute $|Q(\\exp(j \\omega))|$:\n$$|Q(\\exp(j \\omega))| = \\left|\\frac{\\tilde{C}}{C}\\right| \\left|\\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}\\right|$$\nFrom Part 1, we established that any valid choice of $\\tilde{C}$ must satisfy $|\\tilde{C}| = |C||z_{0}|$, which implies $|\\tilde{C}/C| = |z_{0}|$. We also established that $|1 - z_{0}^{- \\ast} \\exp(-j \\omega)| = \\frac{1}{|z_{0}|} |1 - z_{0} \\exp(-j \\omega)|$, which implies $\\left|\\frac{1 - z_{0}^{- \\ast} \\exp(-j \\omega)}{1 - z_{0} \\exp(-j \\omega)}\\right| = \\frac{1}{|z_{0}|}$.\nSubstituting these two results into the expression for $|Q(\\exp(j \\omega))|$:\n$$|Q(\\exp(j \\omega))| = |z_{0}| \\cdot \\frac{1}{|z_{0}|} = 1$$\nThis holds for all real $\\omega$. Thus, $Q(\\exp(j \\omega))$ is an all-pass factor that alters the phase response while maintaining a constant magnitude of $1$.\n\n3) Derivation of the group delay difference $\\Delta \\tau_{g}(\\omega)$\n\nThe group delay difference is $\\Delta \\tau_{g}(\\omega) = \\tau_{g,2}(\\omega) - \\tau_{g,1}(\\omega)$. Using the definition of group delay:\n$$\\Delta \\tau_{g}(\\omega) = \\left(-\\frac{d}{d \\omega} \\angle H_{2}(\\exp(j \\omega))\\right) - \\left(-\\frac{d}{d \\omega} \\angle H_{1}(\\exp(j \\omega))\\right) = -\\frac{d}{d \\omega} \\left( \\angle H_{2}(\\exp(j \\omega)) - \\angle H_{1}(\\exp(j \\omega)) \\right)$$\nThe difference in phase angles is the phase angle of the ratio:\n$$\\angle H_{2}(\\exp(j \\omega)) - \\angle H_{1}(\\exp(j \\omega)) = \\angle \\frac{H_{2}(\\exp(j \\omega))}{H_{1}(\\exp(j \\omega))} = \\angle Q(\\exp(j \\omega))$$\nSo, $\\Delta \\tau_{g}(\\omega) = -\\frac{d}{d \\omega} \\angle Q(\\exp(j \\omega))$.\nTo compute this derivative, we use the identity $\\frac{d}{d\\omega} \\arg(f(\\omega)) = \\Im\\left(\\frac{1}{f(\\omega)} \\frac{df(\\omega)}{d\\omega}\\right) = \\Im\\left(\\frac{d}{d\\omega} \\ln(f(\\omega))\\right)$.\nLet's find the logarithmic derivative of $Q(z)$ at $z=\\exp(j\\omega)$.\n$$Q(z) = \\frac{\\tilde{C}}{C} \\frac{1 - z_{0}^{- \\ast} z^{-1}}{1 - z_{0} z^{-1}}$$\n$$\\ln(Q(z)) = \\ln\\left(\\frac{\\tilde{C}}{C}\\right) + \\ln(1 - z_{0}^{- \\ast} z^{-1}) - \\ln(1 - z_{0} z^{-1})$$\nDifferentiating with respect to $\\omega$ (with $z=\\exp(j\\omega)$, so $dz/d\\omega = j\\exp(j\\omega) = jz$):\n$$\\frac{d}{d\\omega} \\ln(Q(\\exp(j\\omega))) = \\frac{d}{dz}[\\ln(Q(z))] \\frac{dz}{d\\omega} = \\left( \\frac{-z_{0}^{- \\ast} (-z^{-2})}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{-z_{0} (-z^{-2})}{1 - z_{0} z^{-1}} \\right) (jz)$$\n$$= \\left( \\frac{z_{0}^{- \\ast} z^{-2}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-2}}{1 - z_{0} z^{-1}} \\right) (jz) = j \\left( \\frac{z_{0}^{- \\ast} z^{-1}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-1}}{1 - z_{0} z^{-1}} \\right)$$\nThe phase derivative is the imaginary part of this expression. Since the entire expression is multiplied by $j$, we need the real part of the term in the parenthesis.\n$$\\frac{d}{d\\omega} \\angle Q(\\exp(j\\omega)) = \\Re\\left(\\frac{z_{0}^{- \\ast} z^{-1}}{1 - z_{0}^{- \\ast} z^{-1}} - \\frac{z_{0} z^{-1}}{1 - z_{0} z^{-1}}\\right)\\bigg|_{z=\\exp(j\\omega)}$$\nLet $a = z_0$ and $b = z_0^{-*}$. The group delay contribution from a factor $(1 - p z^{-1})$ is $-\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right)$. Thus, the expression we have is $-(\\tau_{g, \\text{zero } z_0^{-*}} - \\tau_{g, \\text{zero } z_0})$.\nLet's compute $\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right)$ for a generic complex number $p$ and $z=\\exp(j\\omega)$.\n$$\\frac{p z^{-1}}{1 - p z^{-1}} = \\frac{p z^{-1}(1 - p^{\\ast} z)}{|1 - p z^{-1}|^2} = \\frac{p z^{-1} - |p|^2}{|1 - p z^{-1}|^2}$$\nLet $p = r \\exp(j\\theta)$. Then $p z^{-1} = r \\exp(j\\theta) \\exp(-j\\omega) = r \\exp(j(\\theta-\\omega))$.\n$$\\Re(p z^{-1} - |p|^2) = \\Re(r(\\cos(\\theta-\\omega) + j\\sin(\\theta-\\omega)) - r^2) = r\\cos(\\theta-\\omega) - r^2$$\nThe denominator is $|1 - p z^{-1}|^2 = (1-pz^{-1})(1-p^*z) = 1 - pz^{-1} - p^*z + |p|^2 = 1 - 2\\Re(pz^{-1}) + |p|^2 = 1 - 2r\\cos(\\theta-\\omega) + r^2$.\nSo, $\\Re\\left(\\frac{p z^{-1}}{1 - p z^{-1}}\\right) = \\frac{r\\cos(\\theta-\\omega) - r^2}{1 - 2r\\cos(\\theta-\\omega) + r^2}$.\nLet $r_0 = |z_0|$ and $\\theta_0 = \\arg(z_0)$.\nFor the term with $p = z_0$, we have $r=r_0$ and $\\theta=\\theta_0$.\nFor the term with $p = z_0^{-*} = 1/z_0^*$, we have $p = (1/r_0)\\exp(j\\theta_0)$. So $r=1/r_0$ and $\\theta=\\theta_0$.\nLet's compute the difference:\n$$\\frac{d}{d\\omega} \\angle Q = \\frac{\\frac{1}{r_0}\\cos(\\theta_0-\\omega) - (\\frac{1}{r_0})^2}{1 - \\frac{2}{r_0}\\cos(\\theta_0-\\omega) + (\\frac{1}{r_0})^2} - \\frac{r_0\\cos(\\theta_0-\\omega) - r_0^2}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2}$$\nSimplifying the first term by multiplying numerator and denominator by $r_0^2$:\n$$\\frac{r_0\\cos(\\theta_0-\\omega) - 1}{r_0^2 - 2r_0\\cos(\\theta_0-\\omega) + 1}$$\nThe denominators are now identical. Let $D = 1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2$.\n$$\\frac{d}{d\\omega} \\angle Q = \\frac{(r_0\\cos(\\theta_0-\\omega) - 1) - (r_0\\cos(\\theta_0-\\omega) - r_0^2)}{D} = \\frac{r_0^2 - 1}{D}$$\nThe group delay difference is the negative of this quantity:\n$$\\Delta \\tau_{g}(\\omega) = -\\frac{r_0^2 - 1}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2} = \\frac{1 - r_0^2}{1 - 2r_0\\cos(\\theta_0-\\omega) + r_0^2}$$\nFinally, substituting $r_0 = |z_0|$ and $\\theta_0 = \\arg(z_0)$:\n$$\\Delta \\tau_{g}(\\omega) = \\frac{1 - |z_{0}|^2}{1 - 2|z_{0}|\\cos(\\arg(z_{0}) - \\omega) + |z_{0}|^2}$$\nThis expression gives the group delay difference in samples.", "answer": "$$ \\boxed{ \\frac{1 - |z_{0}|^2}{1 - 2|z_{0}|\\cos(\\arg(z_{0}) - \\omega) + |z_{0}|^2} } $$", "id": "2882304"}, {"introduction": "Having seen that magnitude and phase can be decoupled, we now explore the profound condition under which they are uniquely linked: the minimum-phase constraint. This exercise presents a classic phase-retrieval problem, where you must reconstruct a system's unique phase response from its magnitude response alone. Success requires synthesizing your knowledge of causality, stability, and the properties of analytic functions to build the one-and-only transfer function that meets the specified criteria [@problem_id:2882259].", "problem": "Let $H(z)$ be a discrete-time, causal, stable, linear time-invariant (LTI) transfer function with real coefficients whose discrete-time Fourier transform on the unit circle is $H(e^{j\\omega})$, where $\\omega \\in [-\\pi,\\pi]$. You are given only the magnitude response\n$$\n|H(e^{j\\omega})| \\;=\\; \\sqrt{\\frac{1-2a\\cos\\omega + a^{2}}{1-2b\\cos\\omega + b^{2}}}\n\\quad\\text{for all } \\omega \\in [-\\pi,\\pi],\n$$\nwhere $a$ and $b$ are fixed constants satisfying $0a1$ and $0b1$.\n\nAssume the following:\n- $H(z)$ is minimum-phase (all zeros strictly inside the unit circle), with no all-pass factor.\n- There is no pure delay, and the direct-current (DC) value is chosen such that $H(e^{j0})0$.\n\nStarting only from fundamental properties of minimum-phase systems, namely that for such systems the unwrapped phase is the harmonic conjugate of the logarithmic magnitude on the unit circle (equivalently, the phase is obtained from the Hilbert transform of the logarithmic magnitude), derive the unique unwrapped phase $\\phi(\\omega)$ of $H(e^{j\\omega})$ associated with the given $|H(e^{j\\omega})|$. Provide a closed-form analytic expression for $\\phi(\\omega)$ valid for all $\\omega \\in [-\\pi,\\pi]$, in radians, consistent with $H(e^{j0})0$ and the absence of pure delay.\n\nBriefly explain, in your derivation, what fails or becomes non-unique if the minimum-phase assumption is violated, but do not include that discussion in the final answer.\n\nYour final answer must be a single closed-form expression for $\\phi(\\omega)$ in radians. Do not round.", "solution": "The problem requires the derivation of the phase response $\\phi(\\omega)$ for a linear time-invariant (LTI) system, given its magnitude response $|H(e^{j\\omega})|$ and several key properties: causality, stability, and minimum-phase. The foundation of the solution lies in the relationship between the logarithm of the magnitude response and the phase response for minimum-phase systems.\n\nFor a causal, stable, and minimum-phase LTI system with transfer function $H(z)$, both $H(z)$ and its inverse $1/H(z)$ are causal and stable. This means that $H(z)$ and all its poles and zeros are located strictly inside the unit circle $|z|1$. Consequently, the function $\\ln(H(z))$ is analytic for all $|z| \\geq 1$. On the unit circle $z=e^{j\\omega}$, the function $\\ln(H(e^{j\\omega}))$ can be written as:\n$$\n\\ln(H(e^{j\\omega})) = \\ln(|H(e^{j\\omega})| e^{j\\phi(\\omega)}) = \\ln|H(e^{j\\omega})| + j\\phi(\\omega)\n$$\nwhere $\\phi(\\omega)$ is the unwrapped phase. Since $\\ln(H(z))$ is analytic on and outside the unit circle, its real part, $\\ln|H(e^{j\\omega})|$, and its imaginary part, $\\phi(\\omega)$, form a Hilbert transform pair. Specifically, the phase is the Hilbert transform of the log-magnitude. While one could compute the phase via the Hilbert transform integral, a more direct algebraic method rooted in the same analyticity principle is to reconstruct the transfer function $H(z)$ from the magnitude-squared response $|H(e^{j\\omega})|^2$.\n\nThe magnitude-squared response is given by:\n$$\n|H(e^{j\\omega})|^2 = \\frac{1-2a\\cos\\omega + a^{2}}{1-2b\\cos\\omega + b^{2}}\n$$\nFor a system with real coefficients, the magnitude-squared response is related to the transfer function $H(z)$ by the property $|H(e^{j\\omega})|^2 = H(z)H(z^{-1})|_{z=e^{j\\omega}}$. We express the numerator and denominator in the $z$-domain using the substitution $\\cos\\omega = \\frac{1}{2}(z+z^{-1})$ for $z=e^{j\\omega}$:\n$$\n1 - 2c\\cos\\omega + c^2 = 1 - c(z+z^{-1}) + c^2 = (1-cz^{-1})(1-cz)\n$$\nApplying this to the given expression for $|H(e^{j\\omega})|^2$, we obtain:\n$$\nH(z)H(z^{-1}) = \\frac{(1-az^{-1})(1-az)}{(1-bz^{-1})(1-bz)}\n$$\nThis expression reveals the poles and zeros of the composite system $H(z)H(z^{-1})$. The zeros are at $z=a$ and $z=1/a$. The poles are at $z=b$ and $z=1/b$.\n\nTo construct the unique $H(z)$, we apply the given constraints:\n$1$. **Causality and Stability**: A causal and stable LTI system must have all its poles strictly inside the unit circle. Given $0b1$, the pole at $z=b$ is inside the unit circle, while the pole at $z=1/b$ is outside. Therefore, $H(z)$ must contain the pole at $z=b$, which corresponds to the factor $(1-bz^{-1})$ in the denominator.\n$2$. **Minimum-Phase**: A minimum-phase system must have all its zeros strictly inside the unit circle. Given $0a1$, the zero at $z=a$ is inside the unit circle, while the zero at $z=1/a$ is outside. Therefore, $H(z)$ must contain the zero at $z=a$, corresponding to the factor $(1-az^{-1})$ in the numerator.\n\nCombining these findings, the transfer function $H(z)$ must be of the form:\n$$\nH(z) = G \\frac{1-az^{-1}}{1-bz^{-1}}\n$$\nwhere $G$ is a constant. We determine $G$ using the remaining constraints. The squared magnitude of this $H(z)$ is $|G|^2 |H_{MP}(z)|^2$, which must match the original expression. This implies $|G|^2=1$. Since the system has real coefficients, $G$ must be a real constant, so $G = \\pm 1$.\n$3$. **Positive DC Value**: The DC response is $H(e^{j0}) = H(z)|_{z=1}$. We are given $H(e^{j0})  0$.\n$$\nH(1) = G \\frac{1-a(1)^{-1}}{1-b(1)^{-1}} = G \\frac{1-a}{1-b}\n$$\nSince $0a1$ and $0b1$, both $(1-a)$ and $(1-b)$ are positive, so their ratio is positive. To satisfy $H(1)  0$, we must choose $G=1$.\n\nThe unique transfer function that satisfies all the given conditions is:\n$$\nH(z) = \\frac{1-az^{-1}}{1-bz^{-1}}\n$$\nThe problem statement also confirms the absence of pure delay factors (like $z^{-k}$) and all-pass factors, which is consistent with our construction.\n\nNow, we find the phase response $\\phi(\\omega)$ by evaluating $H(z)$ on the unit circle, $z=e^{j\\omega}$:\n$$\nH(e^{j\\omega}) = \\frac{1-ae^{-j\\omega}}{1-be^{-j\\omega}} = \\frac{1-a(\\cos\\omega - j\\sin\\omega)}{1-b(\\cos\\omega - j\\sin\\omega)} = \\frac{(1-a\\cos\\omega) + j(a\\sin\\omega)}{(1-b\\cos\\omega) + j(b\\sin\\omega)}\n$$\nThe phase of $H(e^{j\\omega})$ is the phase of the numerator minus the phase of the denominator:\n$$\n\\phi(\\omega) = \\arg\\{(1-a\\cos\\omega) + j(a\\sin\\omega)\\} - \\arg\\{(1-b\\cos\\omega) + j(b\\sin\\omega)\\}\n$$\nFor a complex number $X+jY$, the argument is given by $\\arctan(Y/X)$ when $X0$. For the numerator term, the real part is $1-a\\cos\\omega$. Since $0a1$, we have $1-a \\le 1-a\\cos\\omega \\le 1+a$, which is strictly positive. Similarly, for the denominator term, $1-b\\cos\\omega$ is strictly positive. Therefore, the standard $\\arctan$ function can be used to find the phase of each term, which also corresponds to the unwrapped phase as the argument never crosses the negative real axis.\n$$\n\\phi(\\omega) = \\arctan\\left(\\frac{a\\sin\\omega}{1-a\\cos\\omega}\\right) - \\arctan\\left(\\frac{b\\sin\\omega}{1-b\\cos\\omega}\\right)\n$$\nThis expression provides the unique unwrapped phase response for the specified system.\n\nIf the minimum-phase assumption were violated, the solution for $H(z)$ would not be unique. For the same magnitude response, one could construct alternative stable systems by including all-pass factors. For instance, the zero at $z=a$ could be \"flipped\" to its reciprocal location $z=1/a$ by multiplying the minimum-phase transfer function $H_{MP}(z)$ by a first-order all-pass filter $H_{AP}(z) = \\frac{z^{-1}-a}{1-az^{-1}}$. The resulting non-minimum-phase system $H_{NMP}(z) = H_{MP}(z)H_{AP}(z)$ would have the same magnitude response $|H_{NMP}(e^{j\\omega})| = |H_{MP}(e^{j\\omega})|$ but a different phase response $\\phi_{NMP}(\\omega) = \\phi_{MP}(\\omega) + \\phi_{AP}(\\omega)$. This non-uniqueness arises because the Hilbert transform relationship between log-magnitude and phase is exclusive to minimum-phase systems.", "answer": "$$\n\\boxed{\\arctan\\left(\\frac{a\\sin\\omega}{1-a\\cos\\omega}\\right) - \\arctan\\left(\\frac{b\\sin\\omega}{1-b\\cos\\omega}\\right)}\n$$", "id": "2882259"}]}