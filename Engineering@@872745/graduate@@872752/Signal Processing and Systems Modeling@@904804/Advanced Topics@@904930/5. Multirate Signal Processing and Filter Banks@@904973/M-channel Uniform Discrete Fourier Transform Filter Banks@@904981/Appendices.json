{"hands_on_practices": [{"introduction": "The frequency-sampling method provides one of the most direct approaches to designing a Finite Impulse Response (FIR) filter. By specifying the desired response at a discrete set of frequency points, we can generate a filter prototype. This exercise guides you through the derivation of the continuous frequency response from these discrete samples, revealing the fundamental interpolation process at play and quantifying the resulting filter's transition width [@problem_id:2881785].", "problem": "Consider a critically decimated, $M$-channel uniform Discrete Fourier Transform (DFT) analysis filter bank, where each analysis channel $k \\in \\{0,1,\\dots,M-1\\}$ is obtained by complex modulation of a single low-pass prototype, that is, $H_k(e^{j\\omega}) \\triangleq H\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right)$. The target is to approximate ideal brick-wall bandpass channel responses of width approximately $2\\pi/M$, each centered at $2\\pi k/M$.\n\nUsing only first principles of the frequency-sampling method for finite impulse response (FIR) design and the modulation property of the Discrete-Time Fourier Transform (DTFT), do the following:\n\n1) Starting from the definition that frequency-sampling design specifies $M$ equally spaced desired samples $H_{d}[r] \\triangleq H\\!\\left(e^{j\\omega_r}\\right)$ at $\\omega_r \\triangleq 2\\pi r/M$ for $r \\in \\{0,1,\\dots,M-1\\}$, derive the continuous-frequency prototype response $H(e^{j\\omega})$ obtained when the time-domain prototype $h[n]$ is chosen as the inverse DFT of $\\{H_{d}[r]\\}_{r=0}^{M-1}$. Your expression for $H(e^{j\\omega})$ must be in closed form and must explicitly expose the interpolation kernel that arises from summing a finite geometric series.\n\n2) Interpreting the interpolation kernel you derived in part (1), and assuming a standard choice of $H_{d}[r]$ that equals one on a contiguous set of DFT indices corresponding to a low-pass band around $\\omega=0$ and zero elsewhere (so that $H_k(e^{j\\omega})$ approximates a brick-wall band centered at $2\\pi k/M$), determine the minimum achievable transition width $\\Delta\\omega_{\\min}$ separating the nominally flat passband region (near unity) from the first zero of the stopband, as a function of $M$. Here, define the transition width as the frequency separation between the peak of the passband lobe and the first zero crossing on one side of that lobe. Your answer must be a single, closed-form analytic expression in terms of $M$ only.\n\nNo numerical substitution is required. The final answer must be the analytic expression for $\\Delta\\omega_{\\min}$ only, with no units.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard problem in digital signal processing concerning the design of FIR filters using the frequency-sampling method. I will proceed with the derivation.\n\nThe problem is divided into two parts. First, we must derive the continuous-frequency response $H(e^{j\\omega})$ of a prototype filter designed via the frequency-sampling method. Second, we must determine the minimum achievable transition width for this prototype.\n\nPart 1: Derivation of the Prototype Filter Frequency Response\n\nThe problem states that the prototype filter's impulse response, $h[n]$, is of finite length, and is obtained as the inverse Discrete Fourier Transform (IDFT) of a set of $M$ desired frequency samples, $\\{H_d[r]\\}_{r=0}^{M-1}$. The length of the FIR filter is thus implicitly $M$. The definition of the $M$-point IDFT gives $h[n]$ for $n \\in \\{0, 1, \\dots, M-1\\}$ as:\n$$\nh[n] = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] e^{j \\frac{2\\pi r n}{M}}\n$$\nOutside of this interval, $h[n]$ is zero. The continuous-frequency response, $H(e^{j\\omega})$, is the Discrete-Time Fourier Transform (DTFT) of this finite-length sequence $h[n]$. The DTFT is defined as:\n$$\nH(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} h[n] e^{-j\\omega n}\n$$\nSubstituting the expression for $h[n]$ and noting its support is from $n=0$ to $n=M-1$:\n$$\nH(e^{j\\omega}) = \\sum_{n=0}^{M-1} \\left( \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] e^{j \\frac{2\\pi r n}{M}} \\right) e^{-j\\omega n}\n$$\nWe can interchange the order of the finite summations:\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] \\left( \\sum_{n=0}^{M-1} e^{j \\frac{2\\pi r n}{M}} e^{-j\\omega n} \\right)\n$$\nLet us combine the exponential terms inside the second summation:\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] \\left( \\sum_{n=0}^{M-1} \\left( e^{j(\\frac{2\\pi r}{M} - \\omega)} \\right)^n \\right)\n$$\nThe inner summation is a finite geometric series of the form $\\sum_{n=0}^{N-1} a^n$, with $N=M$ and $a = e^{j(\\frac{2\\pi r}{M} - \\omega)}$. The sum of such a series has the closed-form expression $\\frac{1-a^N}{1-a}$, provided $a \\neq 1$.\nThe interpolation kernel requested in the problem statement is precisely this sum, which we denote $K_r(\\omega)$:\n$$\nK_r(\\omega) \\triangleq \\sum_{n=0}^{M-1} \\left( e^{j(\\frac{2\\pi r}{M} - \\omega)} \\right)^n = \\frac{1 - \\left(e^{j(\\frac{2\\pi r}{M} - \\omega)}\\right)^M}{1 - e^{j(\\frac{2\\pi r}{M} - \\omega)}}\n$$\nSimplifying the term in the numerator:\n$$\n\\left(e^{j(\\frac{2\\pi r}{M} - \\omega)}\\right)^M = e^{j(2\\pi r - M\\omega)} = e^{j2\\pi r} e^{-jM\\omega}\n$$\nSince $r$ is an integer, $e^{j2\\pi r} = 1$. The numerator becomes $1 - e^{-jM\\omega}$. The kernel is therefore:\n$$\nK_r(\\omega) = \\frac{1 - e^{-jM\\omega}}{1 - e^{j(\\frac{2\\pi r}{M} - \\omega)}} = \\frac{1 - e^{-jM\\omega}}{1 - e^{-j(\\omega - \\frac{2\\pi r}{M})}}\n$$\nSubstituting this kernel back into the expression for $H(e^{j\\omega})$, we arrive at the closed-form expression for the continuous-frequency prototype response. This expression explicitly shows the interpolation of the frequency samples $H_d[r]$ via the kernel $K_r(\\omega)$.\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] \\frac{1 - e^{-jM\\omega}}{1 - e^{-j(\\omega - \\frac{2\\pi r}{M})}}\n$$\nThis completes the first part of the problem. This expression shows that the resulting frequency response is a superposition of interpolation functions, each centered at a frequency sample point $\\omega_r = 2\\pi r / M$ and weighted by the desired response $H_d[r]$ at that point.\n\nPart 2: Minimum Achievable Transition Width\n\nThe second part requires us to find the minimum achievable transition width, $\\Delta\\omega_{\\min}$. The transition width is defined as the frequency separation between the peak of the passband lobe and the first zero of the stopband. This minimum is to be found by considering the \"standard choice of $H_d[r]$ that equals one on a contiguous set of DFT indices corresponding to a low-pass band around $\\omega=0$ and zero elsewhere\".\n\nThe structure of the frequency response $H(e^{j\\omega})$ is a linear combination of frequency-shifted versions of a fundamental interpolation function. To achieve the narrowest possible features, specifically the narrowest transition width, one must select the most concentrated possible specification for $H_d[r]$. Broadening the support of $H_d[r]$ (i.e., using a larger \"contiguous set of ones\") corresponds to summing multiple shifted interpolation kernels. This action \"fills in\" the nulls of the individual kernels, thereby broadening the overall passband and pushing the first stopband zero to a higher frequency. This increases the transition width.\n\nTherefore, the minimum transition width is achieved for the narrowest possible non-trivial passband specification for $H_d[r]$. For a low-pass filter centered at $\\omega=0$, the most concentrated, or minimal, \"contiguous set\" of non-zero samples is a single sample at $r=0$. This choice corresponds to:\n$$\nH_d[r] = \\delta[r] = \\begin{cases} 1 & r=0 \\\\ 0 & r \\in \\{1, 2, \\dots, M-1\\} \\end{cases}\n$$\nWith this choice, the summation for $H(e^{j\\omega})$ collapses to a single term for $r=0$:\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\cdot (1) \\cdot \\frac{1 - e^{-jM\\omega}}{1 - e^{-j\\omega}}\n$$\nThis is the DTFT of a rectangular window of length $M$ and amplitude $1/M$. To analyze its properties, we express it in terms of trigonometric functions.\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\frac{e^{-j\\frac{M\\omega}{2}}(e^{j\\frac{M\\omega}{2}} - e^{-j\\frac{M\\omega}{2}})}{e^{-j\\frac{\\omega}{2}}(e^{j\\frac{\\omega}{2}} - e^{-j\\frac{\\omega}{2}})} = \\frac{1}{M} e^{-j(M-1)\\frac{\\omega}{2}} \\frac{\\sin(M\\omega/2)}{\\sin(\\omega/2)}\n$$\nThe magnitude of this response is:\n$$\n|H(e^{j\\omega})| = \\frac{1}{M} \\left| \\frac{\\sin(M\\omega/2)}{\\sin(\\omega/2)} \\right|\n$$\nThis function is the scaled periodic sinc function, also known as the Dirichlet kernel.\nThe peak of the passband lobe occurs at $\\omega = 0$. Using L'HÃ´pital's rule or small-angle approximations, the peak value is:\n$$\n\\lim_{\\omega \\to 0} |H(e^{j\\omega})| = \\frac{1}{M} \\left| \\frac{M/2}{1/2} \\right| = 1\n$$\nSo, the peak is located at $\\omega_p = 0$.\n\nThe first zero of the stopband occurs at the smallest non-zero frequency $\\omega_z$ for which the numerator $\\sin(M\\omega/2)$ is zero, while the denominator $\\sin(\\omega/2)$ is non-zero. The numerator is zero when:\n$$\n\\frac{M\\omega}{2} = k\\pi \\quad \\text{for any non-zero integer } k\n$$\n$$\n\\omega = \\frac{2\\pi k}{M}\n$$\nThe first zero on one side of the main lobe at $\\omega=0$ corresponds to $k=1$. At this frequency, the denominator is $\\sin(\\pi/M)$, which is non-zero for $M > 1$. Thus, the first zero crossing is at:\n$$\n\\omega_z = \\frac{2\\pi}{M}\n$$\nThe transition width $\\Delta\\omega_{\\min}$ is the separation between the peak and this first zero:\n$$\n\\Delta\\omega_{\\min} = |\\omega_z - \\omega_p| = \\left|\\frac{2\\pi}{M} - 0\\right| = \\frac{2\\pi}{M}\n$$\nAny other standard choice for $H_d[r]$ would involve a wider passband specification (more non-zero samples), which would result in a larger transition width. Hence, this is the minimum achievable value under the given design constraints.", "answer": "$$\\boxed{\\frac{2\\pi}{M}}$$", "id": "2881785"}, {"introduction": "While theoretical designs offer insight, practical filter bank implementation requires concrete methods and verification. This exercise moves from theory to practice, tasking you with designing a prototype filter using the widely-used Kaiser window method to meet a specific performance target for adjacent-channel leakage [@problem_id:2881712]. You will translate design equations into code and evaluate your filter's performance, a core workflow in signal processing engineering.", "problem": "You are asked to design and verify a uniform Discrete Fourier Transform (DFT) analysis filter bank with $M=32$ channels using a modulated low-pass prototype. The design objective is to target an adjacent-channel leakage of approximately $60$ decibels (dB), quantified via a clearly defined isolation metric computed from the analysis filters. You must implement a self-contained program that designs the prototype using a Kaiser-windowed ideal low-pass filter and computes the specified channel isolation metrics for a given test suite of prototype lengths.\n\nDefinitions and fundamental base:\n- Consider a uniform $M$-channel DFT analysis filter bank with analysis filters $\\{H_k(e^{j\\omega})\\}_{k=0}^{M-1}$ obtained by complex modulation of a real low-pass prototype $H_0(e^{j\\omega})$:\n  $$H_k(e^{j\\omega}) = H_0\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right),\\quad k=0,1,\\dots,M-1.$$\n- The channel center frequencies are $\\omega_k = \\frac{2\\pi k}{M}$ (radians).\n- The prototype $h[n]$ is a finite impulse response (FIR) filter with length $L=K M$, where $K$ is a positive integer, designed as a Kaiser-windowed ideal low-pass filter with cutoff\n  $$\\omega_c = \\frac{\\pi}{M},$$\n  and with a transition design intent guided by the passband edge $\\omega_p = \\frac{3\\pi}{4M}$ and stopband edge $\\omega_s = \\frac{5\\pi}{4M}$ (radians), so that the notional transition width is\n  $$\\Delta\\omega = \\omega_s - \\omega_p = \\frac{\\pi}{2M}.$$\n  The Kaiser window parameter $\\beta$ for a desired sidelobe attenuation $A$ (in dB) satisfies the widely used empirical relation\n  $$\\beta =\n  \\begin{cases}\n  0, & A \\le 21,\\\\\n  0.5842\\,(A-21)^{0.4} + 0.07886\\,(A-21), & 21 < A \\le 50,\\\\\n  0.1102\\,(A-8.7), & A > 50,\n  \\end{cases}$$\n  which for $A=60$ dB yields a fixed $\\beta$.\n- The ideal low-pass prototype (before windowing) of length $L$ and cutoff $\\omega_c$ has discrete-time impulse response\n  $$h_d[n] = \\frac{\\omega_c}{\\pi}\\,\\mathrm{sinc}\\!\\left(\\frac{\\omega_c}{\\pi}\\left(n - \\frac{L-1}{2}\\right)\\right),\\quad n=0,1,\\dots,L-1,$$\n  where $\\mathrm{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$ with $\\mathrm{sinc}(0)=1$. The windowed prototype is $h[n] = h_d[n]\\,w[n]$, where $w[n]$ is the Kaiser window of length $L$. Normalize $h[n]$ so that\n  $$H_0(e^{j0}) = \\sum_{n=0}^{L-1} h[n] = 1,$$\n  ensuring unit gain at the center of each modulated passband.\n\nIsolation metric to compute:\n- Define the adjacent-channel leakage (ACL) for the analysis bank as the maximum, over channels, of the ratio between the magnitude response at an adjacent channel center and the in-channel center:\n  $$\\mathrm{ACL} = 20\\log_{10}\\Bigg(\\max_{k\\in\\{0,\\dots,M-1\\}} \\frac{\\left|H_k\\!\\left(e^{j\\omega_{k\\pm 1}}\\right)\\right|}{\\left|H_k\\!\\left(e^{j\\omega_k}\\right)\\right|}\\Bigg).$$\n- For a uniform modulated bank, this reduces to a prototype-based evaluation:\n  $$\\mathrm{ACL} = 20\\log_{10}\\left(\\frac{\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|}{\\left|H_0\\!\\left(e^{j0}\\right)\\right|}\\right),$$\n  since $H_k(e^{j\\omega_{k\\pm1}})=H_0(e^{\\pm j\\frac{2\\pi}{M}})$ and $H_k(e^{j\\omega_k})=H_0(e^{j0})$.\n\nYour tasks:\n1. Implement the above prototype design for fixed $M=32$ with Kaiser window parameter derived from a target attenuation of $A=60$ dB.\n2. For each given $K$, construct $h[n]$ with $L=K\\,M$, normalize to unit gain at $\\omega=0$, and compute the adjacent-channel leakage in dB using the above prototype-based identity, with all angles in radians.\n3. Aggregate the results for the specified test suite and print them in the exact required format.\n\nTest suite:\n- Use $M=32$ and the following three values of $K$:\n  - $K=6$ (short prototype; significant edge case),\n  - $K=10$ (moderate length; boundary-like case),\n  - $K=18$ (longer prototype; happy path).\n- For each $K$, compute and return the scalar $\\mathrm{ACL}$ value in dB as a float rounded to two decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the three results, in order of the test suite cases $[K=6, K=10, K=18]$, as a comma-separated list enclosed in square brackets (e.g., \"[a,b,c]\"). Use radians for all internal angle calculations and do not include any additional text.", "solution": "We begin from the fundamental definition of a uniform Discrete Fourier Transform (DFT) modulated analysis filter bank. Let there be $M$ analysis filters $\\{H_k(e^{j\\omega})\\}$ generated by complex modulation of a single low-pass prototype $H_0(e^{j\\omega})$:\n$$H_k(e^{j\\omega}) = H_0\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right),\\quad k=0,1,\\dots,M-1.$$\nThe channel center frequencies are $\\omega_k = \\frac{2\\pi k}{M}$ in radians per sample. By design, the prototype $H_0(e^{j\\omega})$ is concentrated around $\\omega=0$, and modulation shifts this low-pass to be centered around each $\\omega_k$.\n\nAdjacent-channel leakage quantifies the suppression of an adjacent channel's center frequency by a filter intended for channel $k$. A natural definition, considering analysis filters alone, is\n$$\\mathrm{ACL} = 20\\log_{10}\\Bigg(\\max_{k} \\frac{\\left|H_k\\!\\left(e^{j\\omega_{k\\pm 1}}\\right)\\right|}{\\left|H_k\\!\\left(e^{j\\omega_k}\\right)\\right|}\\Bigg),$$\nwhere $k\\pm 1$ denotes either of the immediate neighbors of $k$ on the frequency circle. Using the modulation identity,\n$$H_k(e^{j\\omega_{k}}) = H_0(e^{j0}),\\quad H_k(e^{j\\omega_{k\\pm 1}}) = H_0\\!\\left(e^{\\pm j\\frac{2\\pi}{M}}\\right).$$\nHence the worst-case ratio for a uniform bank is independent of $k$ and reduces to\n$$\\mathrm{ACL} = 20\\log_{10}\\left(\\frac{\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|}{\\left|H_0\\!\\left(e^{j0}\\right)\\right|}\\right).$$\nTherefore, it suffices to design $H_0$ and evaluate the above ratio.\n\nWe design $H_0$ by windowing an ideal discrete-time low-pass filter. Let $L=K M$ be the length with an integer $K\\ge 1$. Choose cutoff $\\omega_c = \\frac{\\pi}{M}$ to place the ideal passband inside the channel bandwidth. To accommodate transition and reduce leakage at the adjacent center $\\omega=\\frac{2\\pi}{M}$, we adopt passband and stopband markers $\\omega_p=\\frac{3\\pi}{4M}$ and $\\omega_s=\\frac{5\\pi}{4M}$, giving a notional transition width $\\Delta\\omega=\\frac{\\pi}{2M}$. While the ideal low-pass set at $\\omega_c = \\frac{\\pi}{M}$ has a brick-wall transition, the actual finite-length windowed response will exhibit a transition whose width and sidelobes are governed by $L$ and the window.\n\nThe ideal impulse response of a low-pass filter of length $L$ with cutoff $\\omega_c$ is\n$$h_d[n] = \\frac{\\omega_c}{\\pi}\\,\\mathrm{sinc}\\!\\left(\\frac{\\omega_c}{\\pi}\\left(n - \\frac{L-1}{2}\\right)\\right),\\quad n=0,1,\\dots,L-1,$$\nwhere $\\mathrm{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$ with $\\mathrm{sinc}(0)=1$. We apply a Kaiser window $w[n]$, which is defined in terms of the zero-order modified Bessel function of the first kind $I_0(\\cdot)$ as\n$$w[n] = \\frac{I_0\\!\\left(\\beta\\,\\sqrt{1 - \\left(\\frac{2n}{L-1}-1\\right)^2}\\right)}{I_0(\\beta)},\\quad n=0,1,\\dots,L-1.$$\nThe Kaiser parameter $\\beta$ is chosen based on the desired sidelobe attenuation $A$ in decibels via well-tested empirical formulas:\n$$\\beta =\n\\begin{cases}\n0, & A \\le 21,\\\\\n0.5842\\,(A-21)^{0.4} + 0.07886\\,(A-21), & 21 < A \\le 50,\\\\\n0.1102\\,(A-8.7), & A > 50.\n\\end{cases}$$\nFor $A=60$ dB, we are in the $A>50$ regime, yielding $\\beta = 0.1102\\,(60-8.7)$, which numerically sets the sidelobe decay typical of a $60$ dB Kaiser design.\n\nThe windowed prototype is then\n$$h[n] = h_d[n]\\cdot w[n],$$\nwhich we normalize so that\n$$\\sum_{n=0}^{L-1} h[n] = 1,$$\nimplying $H_0(e^{j0})=1$ and thus unit gain at each modulated channel center. This normalization renders the adjacent-channel leakage simply\n$$\\mathrm{ACL} = 20\\log_{10}\\left(\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|\\right).$$\n\nAlgorithmic plan:\n1. Fix $M=32$, target attenuation $A=60$ dB, and compute $\\beta$ accordingly.\n2. For each test case with a given $K$, set $L=K M$ and generate $h_d[n]$ with $\\omega_c=\\frac{\\pi}{M}$.\n3. Multiply by the Kaiser window $w[n]$ with parameter $\\beta$; then normalize $h[n]$ to unit DC gain.\n4. Compute the discrete-time frequency response samples $H_0(e^{j\\omega})$ at $\\omega=0$ and $\\omega=\\frac{2\\pi}{M}$ using a numerically stable routine for the frequency response of FIR filters.\n5. Evaluate $\\mathrm{ACL}$ in decibels via the logarithmic ratio defined above. Use radians for all angles.\n6. Repeat for all $K$ values in the test suite, round each result to two decimal places, and print as a single list on one line in the specified format.\n\nTest suite rationale:\n- $K=6$ yields a relatively short prototype ($L=192$), stressing the transition width and typically producing higher leakage (edge case).\n- $K=10$ yields a moderate length ($L=320$), often near the target boundary for $60$ dB (boundary-like).\n- $K=18$ yields a longer prototype ($L=576$), which should provide improved isolation (happy path).\n\nThe final program adheres to these principles, computes the metrics directly from first principles using the uniform modulation identity, and outputs the three adjacent-channel leakage values in dB for the specified $K$ values in a single line list.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import freqz\n\ndef kaiser_beta(A):\n    # Kaiser window beta from attenuation A (dB)\n    if A = 21:\n        return 0.0\n    elif A = 50:\n        return 0.5842 * (A - 21) ** 0.4 + 0.07886 * (A - 21)\n    else:\n        return 0.1102 * (A - 8.7)\n\ndef design_prototype_kaiser(M, K, A_dB=60.0):\n    \"\"\"\n    Design a low-pass prototype h[n] of length L=K*M using a Kaiser-windowed ideal low-pass\n    with cutoff wc = pi/M. Normalize to unit DC gain.\n    \"\"\"\n    L = K * M\n    wc = np.pi / M  # cutoff in radians/sample\n    n = np.arange(L, dtype=float)\n    m = n - (L - 1) / 2.0\n    # Ideal low-pass impulse response: hd[n] = (wc/pi) * sinc((wc/pi) * m)\n    # np.sinc(x) = sin(pi x)/(pi x)\n    hd = (wc / np.pi) * np.sinc((wc / np.pi) * m)\n    beta = kaiser_beta(A_dB)\n    w = np.kaiser(L, beta)\n    h = hd * w\n    # Normalize to unit DC gain\n    s = np.sum(h)\n    if s == 0.0:\n        # Avoid division by zero; fallback to tiny normalization to keep numerical stability\n        s = 1e-16\n    h /= s\n    return h\n\ndef adjacent_channel_leakage_dB(h, M):\n    \"\"\"\n    Compute ACL in dB: 20*log10(|H0(exp(j*2*pi/M))| / |H0(exp(j*0))|)\n    After normalization, H0(0) ~ 1, but we compute both for robustness.\n    \"\"\"\n    # Evaluate frequency response at omega=0 and omega=2*pi/M\n    omegas = np.array([0.0, 2.0 * np.pi / M], dtype=float)\n    w, H = freqz(h, worN=omegas)\n    H0 = H[0]\n    H_adj = H[1]\n    denom = np.abs(H0)\n    num = np.abs(H_adj)\n    # Guard against numerical zeros\n    eps = 1e-20\n    ratio = (num + eps) / (denom + eps)\n    acl_db = 20.0 * np.log10(ratio)\n    return float(acl_db)\n\ndef solve():\n    # Define the test cases from the problem statement: M=32, K in [6, 10, 18]\n    M = 32\n    test_cases = [6, 10, 18]  # K values\n\n    results = []\n    for K in test_cases:\n        h = design_prototype_kaiser(M=M, K=K, A_dB=60.0)\n        acl_db = adjacent_channel_leakage_dB(h, M)\n        # Round to two decimals for final reporting\n        results.append(f\"{acl_db:.2f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2881712"}, {"introduction": "Perfect reconstruction properties are often derived assuming infinite-length signals, a convenience not afforded in practice. When processing finite data blocks, the handling of signal boundaries becomes critical to avoiding reconstruction artifacts. This exercise explores the impact of boundary effects by comparing two common signal extension techniques, demonstrating how a careful choice of method can preserve signal integrity at the edges [@problem_id:2881797].", "problem": "Consider a critically sampled, $M$-channel uniform Discrete Fourier Transform (DFT) modulated filter bank with a real, linear-phase finite impulse response prototype $h[n]$ of even length $L$. The bank is paraunitary, so that the analysis-synthesis cascade achieves Perfect Reconstruction (PR) for doubly-infinite signals, and aliasing cancels when there is no subband modification. Now suppose a diagonal subband operator applies constant real gains $\\{G_{k}\\}_{k=0}^{M-1}$ to the $M$ subband sequences between analysis and synthesis. For infinite-length signals, the cascade is then equivalent to a linear time-invariant (LTI) system with some real, even overall impulse response $t[n]$ determined by $h[n]$ and $\\{G_{k}\\}$.\n\nIn this problem, assume that the subband gains and prototype are chosen so that the overall impulse response is the symmetric three-tap smoother\n$$\nt[-1] \\;=\\; \\alpha,\\qquad t[0] \\;=\\; 1 - 2\\alpha,\\qquad t[1] \\;=\\; \\alpha,\n$$\nwith $0  \\alpha  \\tfrac{1}{2}$, and $t[n] = 0$ for $|n| \\ge 2$. You are given a finite signal $x[n]$ for $n=0,1,\\dots,N-1$, and you process exactly this one frame through the analysis-DFT/gain/synthesis chain. Outside $[0,N-1]$, the unknown samples of $x[n]$ are handled via one of the following two boundary-extension rules prior to analysis:\n- Zero padding: $x_{\\mathrm{zp}}[n] = 0$ for $n0$ and $n \\ge N$.\n- Even-symmetric extension at the edges: $x_{\\mathrm{sym}}[-1] = x[0]$, $x_{\\mathrm{sym}}[-2] = x[1]$, and similarly at the right edge (which you may ignore for this question, as the derivation below concerns only the left boundary).\n\nLet $y[n]$ denote the synthesis output after compensating the known group delay so that $y[n]$ is aligned in time with $x[n]$. Because the analysis-synthesis cascade is equivalent to convolution by $t[n]$, the output at any index $n$ is given by $y[n] = \\sum_{m} t[m]\\,x_{\\star}[n-m]$ where $x_{\\star}[\\cdot]$ is the chosen extension ($\\mathrm{zp}$ or $\\mathrm{sym}$).\n\nAssume a local affine model for the signal near the left boundary,\n$$\nx[n] \\;\\approx\\; A + S\\,n \\quad \\text{for $n$ near $0$},\n$$\nwith real constants $A$ and $S$. Let $y_{\\infty}[n]$ denote the hypothetical infinite-length output that would result if the true signal outside $[0,N-1]$ obeyed the affine model for all $n\\in\\mathbb{Z}$, i.e., $x_{\\infty}[n] = A + S n$ for every $n$. Define the boundary reconstruction error at the first sample for each method as $e_{\\mathrm{zp}} \\triangleq y_{\\mathrm{zp}}[0] - y_{\\infty}[0]$ and $e_{\\mathrm{sym}} \\triangleq y_{\\mathrm{sym}}[0] - y_{\\infty}[0]$.\n\nStarting only from the convolution description of LTI systems, the even symmetry of $t[n]$, and the local affine signal model, derive the expressions for $e_{\\mathrm{zp}}$ and $e_{\\mathrm{sym}}$ in terms of $A$, $S$, and $\\alpha$, and then simplify the ratio of squared errors\n$$\nR \\;\\triangleq\\; \\frac{|e_{\\mathrm{zp}}|^{2}}{|e_{\\mathrm{sym}}|^{2}}\n$$\nto a closed-form analytic expression that depends only on $A$ and $S$ (i.e., $\\alpha$ must cancel out). Provide $R$ as your final answer in its simplest form. No numerical evaluation is required.", "solution": "The problem is subjected to validation.\n\n**Step 1: Extract Givens**\n- **System**: A critically sampled, $M$-channel uniform Discrete Fourier Transform (DFT) modulated filter bank.\n- **Prototype Filter**: $h[n]$ is a real, linear-phase finite impulse response (FIR) prototype of even length $L$.\n- **System Property**: The filter bank is paraunitary, achieving Perfect Reconstruction (PR).\n- **Subband Processing**: Constant real gains $\\{G_{k}\\}_{k=0}^{M-1}$ are applied to the subbands.\n- **Overall System**: The analysis-synthesis cascade is equivalent to a linear time-invariant (LTI) system with a real, even overall impulse response $t[n]$.\n- **Impulse Response $t[n]$**:\n  - $t[-1] = \\alpha$\n  - $t[0] = 1 - 2\\alpha$\n  - $t[1] = \\alpha$\n  - $t[n] = 0$ for $|n| \\ge 2$.\n- **Parameter Constraint**: $0  \\alpha  \\tfrac{1}{2}$.\n- **Input Signal**: A finite signal $x[n]$ for $n=0, 1, \\dots, N-1$.\n- **Boundary Extension Rules**:\n  - Zero padding: $x_{\\mathrm{zp}}[n] = 0$ for $n0$.\n  - Even-symmetric extension: $x_{\\mathrm{sym}}[-1] = x[0]$.\n- **Output Definition**: $y[n] = \\sum_{m} t[m]\\,x_{\\star}[n-m]$, where $x_{\\star}[\\cdot]$ is the extended signal. The output $y[n]$ is time-aligned with the input $x[n]$.\n- **Local Signal Model**: For $n$ near $0$, $x[n] \\approx A + S\\,n$ where $A$ and $S$ are real constants.\n- **Ideal Infinite-Length Signal and Output**: $x_{\\infty}[n] = A + Sn$ for all $n \\in \\mathbb{Z}$, and $y_{\\infty}[n]$ is the corresponding output.\n- **Error Definitions**:\n  - $e_{\\mathrm{zp}} \\triangleq y_{\\mathrm{zp}}[0] - y_{\\infty}[0]$.\n  - $e_{\\mathrm{sym}} \\triangleq y_{\\mathrm{sym}}[0] - y_{\\infty}[0]$.\n- **Objective**: Derive expressions for $e_{\\mathrm{zp}}$ and $e_{\\mathrm{sym}}$, and simplify the ratio $R \\triangleq \\frac{|e_{\\mathrm{zp}}|^{2}}{|e_{\\mathrm{sym}}|^{2}}$ to a form dependent only on $A$ and $S$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the theory of digital signal processing, particularly multirate systems and filter banks. The concepts of LTI systems, convolution, boundary effects, and signal modeling are standard and correctly applied.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary definitions and constraints to derive a unique analytical expression for the target quantity $R$. The objective is clear and achievable.\n- **Objectivity**: The problem is stated in precise, objective, and formal language, free of any subjective or ambiguous terms.\n- **Conclusion**: The problem is scientifically sound, self-contained, and formally structured. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be provided.\n\nThe problem requires the derivation of boundary reconstruction errors for two different signal extension methods. The overall system is LTI, described by convolution with the impulse response $t[n]$. The output $y[n]$ at any index is given by the convolution sum:\n$$\ny[n] = \\sum_{m=-\\infty}^{\\infty} t[m] x_{\\star}[n-m]\n$$\nwhere $x_{\\star}$ denotes the extended input signal. Given the specified impulse response $t[n]$, which is non-zero only for $n \\in \\{-1, 0, 1\\}$, the convolution sum for the output at $n=0$ simplifies to:\n$$\ny[0] = t[-1]x_{\\star}[1] + t[0]x_{\\star}[0] + t[1]x_{\\star}[-1]\n$$\nSubstituting the given values for $t[n]$:\n$$\ny[0] = \\alpha x_{\\star}[1] + (1 - 2\\alpha)x_{\\star}[0] + \\alpha x_{\\star}[-1]\n$$\n\nWe must compute this expression for three cases: the ideal infinite-length signal $x_{\\infty}$, the zero-padded signal $x_{\\mathrm{zp}}$, and the symmetrically extended signal $x_{\\mathrm{sym}}$. The local affine model $x[n] = A + Sn$ is used to define the signal values near the boundary.\n\nFirst, we calculate the ideal output $y_{\\infty}[0]$. The corresponding input is $x_{\\infty}[n] = A + Sn$ for all integers $n$. The required input samples are:\n- $x_{\\infty}[-1] = A + S(-1) = A - S$\n- $x_{\\infty}[0] = A + S(0) = A$\n- $x_{\\infty}[1] = A + S(1) = A + S$\n\nSubstituting these into the expression for $y[0]$ yields $y_{\\infty}[0]$:\n$$\ny_{\\infty}[0] = \\alpha(A+S) + (1-2\\alpha)A + \\alpha(A-S)\n$$\n$$\ny_{\\infty}[0] = \\alpha A + \\alpha S + A - 2\\alpha A + \\alpha A - \\alpha S\n$$\n$$\ny_{\\infty}[0] = (\\alpha - 2\\alpha + \\alpha)A + (\\alpha - \\alpha)S + A = A\n$$\nThis result is expected, as the filter $t[n]$ preserves affine signals. The filter's DC gain is $\\sum_{n} t[n] = \\alpha + (1-2\\alpha) + \\alpha = 1$, and its first moment is $\\sum_{n} n t[n] = (-1)\\alpha + (0)(1-2\\alpha) + (1)\\alpha = 0$. For any affine input $x[n]=A+Sn$, the output is $y[n] = \\sum_{m} t[m](A+S(n-m)) = (A+Sn)\\sum_{m} t[m] - S\\sum_{m} m t[m] = A+Sn = x[n]$. Thus, $y_{\\infty}[0] = x_{\\infty}[0] = A$.\n\nNext, we calculate the output $y_{\\mathrm{zp}}[0]$ for the zero-padding case. The extended signal $x_{\\mathrm{zp}}[n]$ is defined by $x[n]$ for $n \\ge 0$ and is zero for $n  0$. The required samples are:\n- $x_{\\mathrm{zp}}[-1] = 0$ (from the zero-padding rule)\n- $x_{\\mathrm{zp}}[0] = x[0] = A + S(0) = A$\n- $x_{\\mathrm{zp}}[1] = x[1] = A + S(1) = A + S$\n\nSubstituting these into the output expression:\n$$\ny_{\\mathrm{zp}}[0] = \\alpha(A+S) + (1-2\\alpha)A + \\alpha(0)\n$$\n$$\ny_{\\mathrm{zp}}[0] = \\alpha A + \\alpha S + A - 2\\alpha A = A - \\alpha A + \\alpha S\n$$\nThe boundary reconstruction error for zero padding, $e_{\\mathrm{zp}}$, is:\n$$\ne_{\\mathrm{zp}} = y_{\\mathrm{zp}}[0] - y_{\\infty}[0] = (A - \\alpha A + \\alpha S) - A = \\alpha S - \\alpha A = \\alpha(S-A)\n$$\n\nNow, we calculate the output $y_{\\mathrm{sym}}[0]$ for the symmetric-extension case. The extended signal $x_{\\mathrm{sym}}[n]$ uses the rule $x_{\\mathrm{sym}}[-1] = x[0]$. The required samples are:\n- $x_{\\mathrm{sym}}[-1] = x[0] = A + S(0) = A$\n- $x_{\\mathrm{sym}}[0] = x[0] = A$\n- $x_{\\mathrm{sym}}[1] = x[1] = A + S(1) = A + S$\n\nSubstituting these into the output expression:\n$$\ny_{\\mathrm{sym}}[0] = \\alpha(A+S) + (1-2\\alpha)A + \\alpha(A)\n$$\n$$\ny_{\\mathrm{sym}}[0] = \\alpha A + \\alpha S + A - 2\\alpha A + \\alpha A = A + \\alpha S\n$$\nThe boundary reconstruction error for symmetric extension, $e_{\\mathrm{sym}}$, is:\n$$\ne_{\\mathrm{sym}} = y_{\\mathrm{sym}}[0] - y_{\\infty}[0] = (A + \\alpha S) - A = \\alpha S\n$$\n\nFinally, we compute the ratio of the squared errors, $R$:\n$$\nR = \\frac{|e_{\\mathrm{zp}}|^{2}}{|e_{\\mathrm{sym}}|^{2}}\n$$\nSubstituting the derived expressions for the errors:\n$$\nR = \\frac{|\\alpha(S-A)|^{2}}{|\\alpha S|^{2}}\n$$\nSince $\\alpha$, $A$, and $S$ are real numbers, the absolute value squared is simply the square of the expression. Also, since $0  \\alpha  \\frac{1}{2}$, $\\alpha$ is non-zero.\n$$\nR = \\frac{\\alpha^{2}(S-A)^{2}}{\\alpha^{2}S^{2}}\n$$\nThe term $\\alpha^2$ cancels from the numerator and denominator, as required. This leaves an expression dependent only on $A$ and $S$.\n$$\nR = \\frac{(S-A)^{2}}{S^{2}}\n$$\nThis expression is the simplest form as a ratio of polynomials. It can also be written as $\\left(1 - \\frac{A}{S}\\right)^2$. We present the answer in the first form.", "answer": "$$\n\\boxed{\\frac{(S-A)^2}{S^2}}\n$$", "id": "2881797"}]}