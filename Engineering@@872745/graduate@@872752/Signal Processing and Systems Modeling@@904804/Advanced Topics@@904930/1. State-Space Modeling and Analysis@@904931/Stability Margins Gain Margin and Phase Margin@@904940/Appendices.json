{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin with a classic second-order system. This practice will guide you through the fundamental process of deriving stability margins directly from the open-loop transfer function's frequency response. By working from first principles, you will calculate the gain and phase margins and then apply this knowledge to determine how the controller gain $k$ must be constrained to meet a specific performance requirement, in this case, a desired phase margin [@problem_id:2906907].", "problem": "Consider a continuous-time, single-loop unity-feedback system whose open-loop transfer function is\n$$\nL(s) \\;=\\; \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)} \\,,\n$$\nwhere $k0$ and $\\omega_{p}0$. The loop has a single real pole at the origin and a single real pole at $s=-\\omega_{p}$. Use the foundational definitions that the gain crossover frequency is the frequency $\\omega_{gc}0$ such that $\\lvert L(j\\omega_{gc})\\rvert = 1$, the phase margin (PM) is the additional phase lag (measured in degrees) required to reach $-180^\\circ$ at $\\omega_{gc}$, the phase crossover frequency is the frequency $\\omega_{pc}0$ such that the open-loop phase equals $-180^\\circ$, and the gain margin (GM) is the reciprocal of the open-loop magnitude at $\\omega_{pc}$. Work from these definitions, along with fundamental properties of complex numbers and rational transfer functions, to:\n\n- Derive closed-form expressions for the magnitude $\\lvert L(j\\omega)\\rvert$ and phase $\\angle L(j\\omega)$ as functions of $\\omega$, $k$, and $\\omega_{p}$.\n- From the gain crossover condition, derive $\\omega_{gc}$ in terms of $k$ and $\\omega_{p}$, and then obtain the phase margin $\\mathrm{PM}(k,\\omega_{p})$ in degrees.\n- Determine the phase crossover behavior of this loop and deduce the gain margin $\\mathrm{GM}(k,\\omega_{p})$.\n- Finally, determine the largest admissible value of $k$ (expressed as a function of $\\omega_{p}$) such that the phase margin satisfies $\\mathrm{PM}\\geq 60^\\circ$.\n\nExpress any angle in degrees. Your final reported answer must be the single closed-form expression for the largest admissible $k$ that guarantees $\\mathrm{PM}\\geq 60^\\circ$. No rounding is required. Do not report intermediate results or inequalities as your final answer.", "solution": "The problem requires a systematic derivation of stability margins for a given second-order system and subsequent determination of a gain parameter constraint. We proceed by following the specified tasks.\n\nFirst, we must establish the frequency response of the open-loop transfer function $L(s)$. The given transfer function is\n$$\nL(s) = \\frac{k}{\\,s\\bigl(1 + s/\\omega_{p}\\bigr)}\n$$\nwhere the parameters $k$ and $\\omega_{p}$ are positive real numbers, $k0$ and $\\omega_{p}0$. The frequency response is obtained by making the substitution $s = j\\omega$, where $\\omega$ is the angular frequency.\n$$\nL(j\\omega) = \\frac{k}{j\\omega(1 + j\\omega/\\omega_{p})}\n$$\nThe magnitude of $L(j\\omega)$, denoted $|L(j\\omega)|$, is the ratio of the magnitudes of the numerator and denominator:\n$$\n|L(j\\omega)| = \\frac{|k|}{|j\\omega| \\cdot |1 + j\\omega/\\omega_{p}|}\n$$\nGiven $k  0$, we have $|k|=k$. For $\\omega \\ge 0$, the magnitude $|j\\omega|$ is $\\omega$. The magnitude of the complex number $1 + j\\omega/\\omega_{p}$ is $\\sqrt{1^2 + (\\omega/\\omega_{p})^2}$. Therefore, the expression for the magnitude is:\n$$\n|L(j\\omega)| = \\frac{k}{\\omega \\sqrt{1 + \\frac{\\omega^2}{\\omega_{p}^2}}}\n$$\nThe phase of $L(j\\omega)$, denoted $\\angle L(j\\omega)$, is computed as the sum of the phases of the terms, where terms in the denominator contribute with a negative sign:\n$$\n\\angle L(j\\omega) = \\angle k - \\angle(j\\omega) - \\angle(1 + j\\omega/\\omega_{p})\n$$\nSince $k$ is a positive real number, its phase is $0^\\circ$. The phase of $j\\omega$ is precisely $90^\\circ$. The phase of $1 + j\\omega/\\omega_{p}$ is given by $\\arctan((\\omega/\\omega_{p})/1) = \\arctan(\\omega/\\omega_{p})$. Thus, the phase expression in degrees is:\n$$\n\\angle L(j\\omega) = 0^\\circ - 90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right) = -90^\\circ - \\arctan\\left(\\frac{\\omega}{\\omega_{p}}\\right)\n$$\nNext, we derive the gain crossover frequency, $\\omega_{gc}$, and the phase margin, $\\mathrm{PM}$. By definition, $\\omega_{gc}$ is the frequency at which $|L(j\\omega_{gc})| = 1$.\n$$\n1 = \\frac{k}{\\omega_{gc} \\sqrt{1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}}}\n$$\nSquaring both sides and rearranging the terms leads to a polynomial equation for $\\omega_{gc}^2$:\n$$\n1 = \\frac{k^2}{\\omega_{gc}^2 (1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2})} \\implies \\omega_{gc}^2 \\left(1 + \\frac{\\omega_{gc}^2}{\\omega_{p}^2}\\right) = k^2\n$$\n$$\n\\frac{1}{\\omega_{p}^2}\\omega_{gc}^4 + \\omega_{gc}^2 - k^2 = 0\n$$\nThis is a quadratic equation in the variable $\\omega_{gc}^2$. We solve for $\\omega_{gc}^2$ using the quadratic formula, with coefficients $a=1/\\omega_{p}^2$, $b=1$, and $c=-k^2$:\n$$\n\\omega_{gc}^2 = \\frac{-1 \\pm \\sqrt{1^2 - 4(1/\\omega_{p}^2)(-k^2)}}{2(1/\\omega_{p}^2)} = \\frac{\\omega_{p}^2}{2} \\left(-1 \\pm \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\\right)\n$$\nSince $\\omega_{gc}^2$ must be a positive real number (as $\\omega_{gc}  0$ by definition), we must select the solution with the plus sign:\n$$\n\\omega_{gc}^2 = \\frac{\\omega_{p}^2}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\nThe phase margin, $\\mathrm{PM}$, is defined as $\\mathrm{PM} = 180^\\circ + \\angle L(j\\omega_{gc})$.\n$$\n\\mathrm{PM} = 180^\\circ + \\left(-90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\\right) = 90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\n\nNow, we analyze the phase crossover behavior and the gain margin, $\\mathrm{GM}$. The phase crossover frequency, $\\omega_{pc}$, is the frequency where $\\angle L(j\\omega_{pc}) = -180^\\circ$.\n$$\n-180^\\circ = -90^\\circ - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right)\n$$\n$$\n-90^\\circ = - \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) \\implies \\arctan\\left(\\frac{\\omega_{pc}}{\\omega_{p}}\\right) = 90^\\circ\n$$\nThe arctangent function approaches $90^\\circ$ only as its argument approaches infinity. This implies $\\omega_{pc}/\\omega_{p} \\to \\infty$, and thus $\\omega_{pc} \\to \\infty$. There is no finite positive frequency $\\omega_{pc}$ at which the phase reaches $-180^\\circ$. The gain margin is defined as $\\mathrm{GM} = 1/|L(j\\omega_{pc})|$. In this case, we must consider the limit as $\\omega \\to \\infty$:\n$$\n\\lim_{\\omega \\to \\infty} |L(j\\omega)| = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega \\sqrt{1 + \\omega^2/\\omega_{p}^2}} = \\lim_{\\omega \\to \\infty} \\frac{k}{\\omega (\\omega/\\omega_{p})} = \\lim_{\\omega \\to \\infty} \\frac{k \\omega_{p}}{\\omega^2} = 0\n$$\nThe magnitude at the frequency where the phase would be $-180^\\circ$ is zero. Therefore, the gain margin $\\mathrm{GM} = 1/0$ is infinite. This indicates that the closed-loop system is stable for all positive values of $k$.\n\nFinally, we determine the largest admissible value of $k$ such that the phase margin satisfies the condition $\\mathrm{PM} \\ge 60^\\circ$.\n$$\n90^\\circ - \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right) \\ge 60^\\circ\n$$\n$$\n30^\\circ \\ge \\arctan\\left(\\frac{\\omega_{gc}}{\\omega_{p}}\\right)\n$$\nSince $\\arctan(x)$ is a monotonically increasing function, we can apply the tangent function to both sides of the inequality. The value of $\\tan(30^\\circ)$ is $1/\\sqrt{3}$.\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\frac{\\omega_{gc}}{\\omega_{p}}\n$$\nWe substitute the expression for $\\omega_{gc}/\\omega_p$:\n$$\n\\frac{1}{\\sqrt{3}} \\ge \\sqrt{\\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)}\n$$\nSquaring both sides of the inequality:\n$$\n\\frac{1}{3} \\ge \\frac{1}{2} \\left(\\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\\right)\n$$\nWe now solve for $k$:\n$$\n\\frac{2}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} - 1\n$$\n$$\n\\frac{2}{3} + 1 \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}} \\implies \\frac{5}{3} \\ge \\sqrt{1 + \\frac{4k^2}{\\omega_{p}^2}}\n$$\nSquaring both sides again:\n$$\n\\left(\\frac{5}{3}\\right)^2 \\ge 1 + \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{25}{9} \\ge 1 + \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{25}{9} - 1 \\ge \\frac{4k^2}{\\omega_{p}^2} \\implies \\frac{16}{9} \\ge \\frac{4k^2}{\\omega_{p}^2}\n$$\n$$\n\\frac{16}{9}\\omega_{p}^2 \\ge 4k^2 \\implies \\frac{4}{9}\\omega_{p}^2 \\ge k^2\n$$\nSince $k  0$ and $\\omega_{p}  0$, taking the positive square root of both sides, we find the constraint on $k$:\n$$\n\\frac{2}{3}\\omega_{p} \\ge k\n$$\nThe problem requires the largest admissible value of $k$. This corresponds to the equality condition. Therefore, the largest value of $k$ is $\\frac{2}{3}\\omega_{p}$.", "answer": "$$\n\\boxed{\\frac{2}{3}\\omega_{p}}\n$$", "id": "2906907"}, {"introduction": "Having mastered the basic calculations, we now turn to a critical scenario where intuition from simple cases can be misleading. This exercise presents a system that is unstable in open-loop, a common challenge in fields like aerospace and chemical process control. You will discover that a positive phase margin, often seen as a guarantee of stability, does not tell the whole story, compelling the use of the full Nyquist stability criterion, $Z = N + P$, to correctly predict the closed-loop behavior [@problem_id:2906959].", "problem": "A continuous-time, single-input single-output, unity negative-feedback loop is formed around a strictly proper loop transfer function $L(s)$ with real coefficients. The loop transfer function is\n$$\nL(s) \\;=\\; K \\,\\frac{s+z}{(s-1)(s+1)(s+2)}\\,,\n$$\nwhere $K=\\dfrac{10\\sqrt{5}}{\\sqrt{29}}$ and $z=\\dfrac{2}{5}$. Note that $L(s)$ has one pole in the Right Half-Plane (RHP) at $s=1$.\n\nStarting only from core definitions (Bode magnitude and phase, and the Nyquist stability criterion derived from Cauchy’s argument principle), do the following:\n\n1) Define the gain crossover frequency $\\omega_{\\mathrm{gc}}$ as the positive real solution of $|L(\\mathrm{j}\\omega)|=1$. Compute $\\omega_{\\mathrm{gc}}$ and the corresponding loop phase $\\angle L(\\mathrm{j}\\omega_{\\mathrm{gc}})$. Then, using the standard definition of Phase Margin (PM) for Bode analysis, compute the “apparent” PM that one would report from the Bode plot if one were to (incorrectly) ignore the presence of RHP poles in $L(s)$. Express angles in degrees. You may leave intermediate symbolic expressions exact; if you present any decimal angles, round to four significant figures.\n\n2) Using the Nyquist stability criterion (based on Cauchy’s argument principle), determine the number $Z$ of zeros of $1+L(s)$ in the RHP, which equals the number of closed-loop poles in the RHP for the unity-feedback system. Justify your determination of the encirclement count by reasoning directly from the qualitative geometry of the Nyquist plot implied by your answer in part 1 and the low-frequency value $L(0)$.\n\n3) Provide a diagnostic explanation that reconciles a positive “apparent” PM from step 1 with an unstable closed loop from step 2, explicitly identifying which standard assumption behind interpreting gain margin (GM) and phase margin (PM) as stability guarantees has been violated and how to detect this situation a priori.\n\nReport as your final answer only the integer value of $Z$ (no units and no additional text). No rounding is needed for $Z$.", "solution": "The problem statement is first validated.\nGivens:\n- Loop transfer function: $L(s) = K \\frac{s+z}{(s-1)(s+1)(s+2)}$\n- Constants: $K = \\frac{10\\sqrt{5}}{\\sqrt{29}}$ and $z = \\frac{2}{5}$\n- System has a unity negative-feedback configuration.\n- $L(s)$ has an unstable pole at $s=1$.\n\nValidation:\nThe problem is scientifically grounded in classical control theory, specifically concerning frequency-domain stability analysis. It is well-posed, with all necessary information provided for a unique solution. The language is objective and precise. The setup, involving an open-loop unstable system, is a standard and important case study for understanding the full scope of the Nyquist stability criterion, and it is not trivial or ill-posed. The problem is deemed valid.\n\nPart 1: Computation of \"Apparent\" Phase Margin\n\nThe frequency response of the loop transfer function is $L(j\\omega)$. The magnitude squared of $L(j\\omega)$ is given by:\n$$\n|L(j\\omega)|^2 = \\left| K \\frac{j\\omega+z}{(j\\omega-1)(j\\omega+1)(j\\omega+2)} \\right|^2 = K^2 \\frac{|j\\omega+z|^2}{|(j\\omega)^2-1|^2 |j\\omega+2|^2} = K^2 \\frac{\\omega^2+z^2}{(-\\omega^2-1)^2 (\\omega^2+4)} = K^2 \\frac{\\omega^2+z^2}{(\\omega^2+1)^2 (\\omega^2+4)}\n$$\nThe gain crossover frequency, $\\omega_{\\mathrm{gc}}$, is the positive frequency where $|L(j\\omega_{\\mathrm{gc}})| = 1$, which is equivalent to $|L(j\\omega_{\\mathrm{gc}})|^2 = 1$.\nThe given constants are $K=\\frac{10\\sqrt{5}}{\\sqrt{29}}$ and $z=\\frac{2}{5}$.\nThus, $K^2 = \\frac{100 \\times 5}{29} = \\frac{500}{29}$ and $z^2 = \\frac{4}{25}$.\nWe need to solve for $\\omega_{\\mathrm{gc}}$ from the equation:\n$$\n1 = \\frac{500}{29} \\frac{\\omega_{\\mathrm{gc}}^2 + \\frac{4}{25}}{(\\omega_{\\mathrm{gc}}^2+1)^2 (\\omega_{\\mathrm{gc}}^2+4)}\n$$\nLet us test the solution $\\omega_{\\mathrm{gc}}=1$ rad/s, which means $\\omega_{\\mathrm{gc}}^2=1$.\n$$\n\\frac{500}{29} \\frac{1 + \\frac{4}{25}}{(1+1)^2 (1+4)} = \\frac{500}{29} \\frac{\\frac{29}{25}}{(2^2)(5)} = \\frac{500}{29} \\frac{29/25}{20} = \\frac{500}{29} \\frac{29}{500} = 1\n$$\nThe equation holds. Therefore, the gain crossover frequency is $\\omega_{\\mathrm{gc}} = 1$ rad/s.\n\nNext, we compute the phase of $L(j\\omega)$ at $\\omega = \\omega_{\\mathrm{gc}} = 1$. The phase is given by:\n$$\n\\angle L(j\\omega) = \\angle(j\\omega+z) - \\angle(j\\omega-1) - \\angle(jomega+1) - \\angle(j\\omega+2)\n$$\nExpressing the angles in degrees:\n$$\n\\angle(j\\omega+z) = \\arctan\\left(\\frac{\\omega}{z}\\right)\n$$\n$$\n\\angle(j\\omega-1) = \\angle(-1+j\\omega) = 180^\\circ - \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+1) = \\arctan(\\omega)\n$$\n$$\n\\angle(j\\omega+2) = \\arctan\\left(\\frac{\\omega}{2}\\right)\n$$\nSo, the total phase is:\n$$\n\\angle L(j\\omega) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\left(180^\\circ - \\arctan(\\omega)\\right) - \\arctan(\\omega) - \\arctan\\left(\\frac{\\omega}{2}\\right) = \\arctan\\left(\\frac{\\omega}{z}\\right) - \\arctan\\left(\\frac{\\omega}{2}\\right) - 180^\\circ\n$$\nAt $\\omega = \\omega_{\\mathrm{gc}}=1$ and with $z=\\frac{2}{5}$:\n$$\n\\angle L(j1) = \\arctan\\left(\\frac{1}{2/5}\\right) - \\arctan\\left(\\frac{1}{2}\\right) - 180^\\circ = \\arctan(2.5) - \\arctan(0.5) - 180^\\circ\n$$\nUsing the identity $\\arctan(a) - \\arctan(b) = \\arctan\\left(\\frac{a-b}{1+ab}\\right)$, we get:\n$$\n\\arctan(2.5) - \\arctan(0.5) = \\arctan\\left(\\frac{2.5 - 0.5}{1 + 2.5 \\times 0.5}\\right) = \\arctan\\left(\\frac{2}{1 + 1.25}\\right) = \\arctan\\left(\\frac{2}{2.25}\\right) = \\arctan\\left(\\frac{8}{9}\\right)\n$$\nSo, the phase at the gain crossover frequency is:\n$$\n\\angle L(j\\omega_{\\mathrm{gc}}) = \\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ \\approx 41.6339^\\circ - 180^\\circ = -138.3661^\\circ\n$$\nRounding to four significant figures, $\\angle L(j\\omega_{\\mathrm{gc}}) \\approx -138.4^\\circ$.\n\nThe standard definition of Phase Margin (PM) is $PM = 180^\\circ + \\angle L(j\\omega_{\\mathrm{gc}})$. The \"apparent\" PM, ignoring the RHP pole, is:\n$$\nPM_{\\mathrm{apparent}} = 180^\\circ + \\left(\\arctan\\left(\\frac{8}{9}\\right) - 180^\\circ\\right) = \\arctan\\left(\\frac{8}{9}\\right) \\approx 41.63^\\circ\n$$\nThis is a positive phase margin.\n\nPart 2: Nyquist Stability Analysis\n\nThe Nyquist stability criterion states that $Z = N + P$, where:\n- $Z$ is the number of zeros of $1+L(s)$ in the RHP, which corresponds to the number of unstable closed-loop poles.\n- $P$ is the number of poles of the open-loop transfer function $L(s)$ in the RHP.\n- $N$ is the number of clockwise encirclements of the critical point $-1+j0$ by the Nyquist plot of $L(s)$.\n\nFrom the definition of $L(s) = K \\frac{s+z}{(s-1)(s+1)(s+2)}$, we can identify the poles at $s=1$, $s=-1$, and $s=-2$. The pole at $s=1$ is in the RHP. Thus, $P=1$.\n\nTo determine $N$, we analyze the Nyquist plot, which is the image of the standard Nyquist D-contour. We need to ascertain if the plot encircles the point $-1$.\n1.  For $\\omega \\to 0^+$, $L(j\\omega) \\to L(0) = K \\frac{z}{(-1)(1)(2)} = -\\frac{Kz}{2}$.\n    $L(0) = -\\frac{1}{2} \\left(\\frac{10\\sqrt{5}}{\\sqrt{29}}\\right) \\left(\\frac{2}{5}\\right) = -\\frac{2\\sqrt{5}}{\\sqrt{29}} \\approx -0.8318$.\n    The plot starts on the negative real axis at approximately $-0.8318$, which is to the right of $-1$.\n2.  The phase of $L(j\\omega)$ is $\\angle L(j\\omega) = \\arctan(2.5\\omega) - \\arctan(0.5\\omega) - 180^\\circ$. For $\\omega \\in (0, \\infty)$, both $\\arctan(2.5\\omega)$ and $\\arctan(0.5\\omega)$ are in $(0, 90^\\circ)$, and $\\arctan(2.5\\omega)  \\arctan(0.5\\omega)$. Thus, $\\arctan(2.5\\omega) - \\arctan(0.5\\omega)$ is in $(0, 90^\\circ)$. This implies $\\angle L(j\\omega)$ is always in $(-180^\\circ, -90^\\circ)$. The plot for $\\omega  0$ remains entirely in the third quadrant. It never crosses the negative real axis.\n3.  As $\\omega \\to \\infty$, $L(j\\omega) \\to 0$ since the system is strictly proper. The phase approaches $\\lim_{\\omega\\to\\infty} (\\arctan(2.5\\omega) - \\arctan(0.5\\omega) - 180^\\circ) = 90^\\circ - 90^\\circ - 180^\\circ = -180^\\circ$. The plot approaches the origin along the negative real axis.\n4.  The large semicircle closure of the D-contour in the s-plane maps to a path at the origin in the L(s)-plane since $L(s)$ is strictly proper.\n\nThe Nyquist plot for $\\omega \\in (-\\infty, \\infty)$ starts at the origin for $\\omega \\to -\\infty$, moves to $L(0) \\approx -0.8318$, makes a loop in the second and third quadrants that passes through the point $L(j1)$ on the unit circle but never crosses the real axis to the left of $-1$, and returns to the origin for $\\omega \\to \\infty$. The critical point $-1+j0$ is never enclosed by the plot.\nTherefore, the number of encirclements is $N=0$.\n\nUsing the Nyquist criterion, the number of unstable closed-loop poles is:\n$$\nZ = N + P = 0 + 1 = 1\n$$\nThe closed-loop system has one pole in the RHP and is therefore unstable.\n\nPart 3: Reconciliation and Diagnostic Explanation\n\nThe analysis reveals an \"apparent\" contradiction: a positive phase margin ($PM \\approx 41.63^\\circ$), which is often associated with stability, yet the system is unstable ($Z=1$). This discrepancy is resolved by understanding the limitations of the Bode plot stability margins.\n\nThe standard interpretation that a positive phase margin and a gain margin greater than $1$ guarantee closed-loop stability is valid **only if the open-loop system $L(s)$ is stable**, meaning P = 0.\n\nIn this problem, this fundamental assumption is violated. The open-loop transfer function $L(s)$ has a pole at $s=1$, so it is unstable, and $P=1$. For an open-loop unstable system, the Nyquist criterion $Z=N+P$ must be used directly. For stability, we require $Z=0$. With $P=1$, this would necessitate $N = Z-P = 0-1 = -1$, meaning the Nyquist plot must encircle the critical point $-1$ one time in the counter-clockwise direction.\n\nA positive phase margin merely indicates that at the gain crossover frequency, the phase is less negative than $-180^\\circ$. It provides no information about the encirclement count $N$ without the additional context of the open-loop pole locations. In this case, the positive PM occurs in a system where the Nyquist plot does not encircle $-1$ at all ($N=0$), failing to provide the required stabilizing counter-clockwise encirclement.\n\nThe a priori detection of this situation is straightforward: one must always first determine the poles of the open-loop transfer function $L(s)$. The presence of any pole with a positive real part (in this case, $s=1$) immediately invalidates the simple stability rules of thumb associated with Bode plots and mandates the use of the full Nyquist stability criterion (or an equivalent method like root locus).", "answer": "$$\n\\boxed{1}\n$$", "id": "2906959"}, {"introduction": "Finally, we connect phase margin to a crucial real-world specification: a system's tolerance to time delay, known as the delay margin. This computational practice challenges the common engineering approximation that relates phase margin, $\\mathrm{PM}$, directly to delay margin, $\\tau_{\\max}$, via the formula $\\tau_{\\max} \\approx \\mathrm{PM}/\\omega_{gc}$. By analyzing a system with a resonant frequency response, you will see precisely when and why this approximation breaks down, reinforcing that stability is determined by the system's behavior across all relevant frequencies [@problem_id:2906975].", "problem": "Consider a family of continuous-time, linear time-invariant, strictly proper open-loop transfer functions $L(s)$ with no time delay. Appending a pure time delay $e^{-s \\tau}$ to $L(s)$ does not change the open-loop magnitude but contributes an additional phase lag $-\\omega \\tau$ at frequency $\\omega$ (in radians per second). The closed-loop configuration uses unity feedback. The delay margin is the largest nonnegative delay value $\\tau_{\\max}$ (in seconds) such that the closed-loop system remains stable for all $\\tau \\in [0,\\tau_{\\max})$. You are to compare the exact delay margin computed from the Nyquist stability criterion with the approximation $\\tau_{\\max}^{\\text{approx}}=\\mathrm{PM}/\\omega_{gc}$, where $\\mathrm{PM}$ is the Phase Margin (PM) in radians and $\\omega_{gc}$ is the gain-crossover frequency (in radians per second), and quantify the error.\n\nYour program must do the following for each specified test case:\n- Using only the fundamental definitions of the Nyquist stability criterion and frequency response of $L(j\\omega)$, compute the exact delay margin $\\tau_{\\max}^{\\text{exact}}$ by enforcing the marginal stability condition implied by the Nyquist criterion at some frequency $\\omega0$.\n- Compute the approximate delay margin $\\tau_{\\max}^{\\text{approx}}=\\mathrm{PM}/\\omega_{gc}$ using the smallest positive gain-crossover frequency $\\omega_{gc}$ (the smallest $\\omega0$ such that $\\lvert L(j\\omega)\\rvert=1$) and the phase margin $\\mathrm{PM}=\\pi+\\arg L(j\\omega_{gc})$ in radians, where $\\arg L(j\\omega)$ is the principal value of the argument in $(-\\pi,\\pi]$.\n- Report the absolute error $\\lvert \\tau_{\\max}^{\\text{exact}}-\\tau_{\\max}^{\\text{approx}}\\rvert$ and the relative error $\\lvert \\tau_{\\max}^{\\text{exact}}-\\tau_{\\max}^{\\text{approx}}\\rvert/\\tau_{\\max}^{\\text{exact}}$ as decimals (no percentage sign).\n\nAll angles must be in radians, frequencies in radians per second, and delays in seconds. Round all reported floating-point outputs to $6$ decimals.\n\nTest suite. For each loop, the scalar gain $K$ is chosen so that a designated target frequency $\\omega_{0}$ is a gain-crossover, i.e., $\\lvert L(j\\omega_{0})\\rvert=1$. Concretely, $K$ is defined by $K=1/\\lvert L_{0}(j\\omega_{0})\\rvert$, where $L_{0}(s)$ is the loop with $K=1$.\n\n- Case A (baseline with moderate phase slope): \n  $$\n  L_{A}(s)=\\frac{K_{A}}{s\\left(1+\\frac{s}{1}\\right)\\left(1+\\frac{s}{4}\\right)}, \\quad \\text{with } \\omega_{0}=2.\n  $$\n- Case B (pronounced phase slope via multiple real poles): \n  $$\n  L_{B}(s)=\\frac{K_{B}}{s\\left(1+\\frac{s}{0.5}\\right)\\left(1+\\frac{s}{1}\\right)\\left(1+\\frac{s}{2}\\right)\\left(1+\\frac{s}{4}\\right)}, \\quad \\text{with } \\omega_{0}=2.\n  $$\n- Case C (resonant pair creating multiple unity-magnitude crossings):\n  $$\n  L_{C}(s)=K_{C}\\cdot \\frac{\\omega_{n}^{2}}{s\\left(s^{2}+2\\zeta\\omega_{n}s+\\omega_{n}^{2}\\right)\\left(1+\\frac{s}{p}\\right)}, \\quad \\omega_{n}=3,\\ \\zeta=0.1,\\ p=8,\\ \\omega_{0}=3.\n  $$\n\nFor each case, your program must:\n- Construct $L_{0}(s)$ with $K=1$, then compute $K=1/\\lvert L_{0}(j\\omega_{0})\\rvert$ so that $\\lvert L(j\\omega_{0})\\rvert=1$.\n- Compute $\\tau_{\\max}^{\\text{exact}}$ using only the Nyquist marginal-stability condition and the fact that pure delay contributes phase $-\\omega \\tau$ without changing magnitude.\n- Compute $\\tau_{\\max}^{\\text{approx}}=\\mathrm{PM}/\\omega_{gc}$ at the smallest $\\omega_{gc}0$ satisfying $\\lvert L(j\\omega_{gc})\\rvert=1$.\n- Compute the absolute and relative errors as specified.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list of lists:\n- The outer list has length $3$, corresponding to the three cases in the order A, B, C.\n- Each inner list has four floating-point numbers rounded to $6$ decimals and ordered as $[\\tau_{\\max}^{\\text{exact}},\\ \\tau_{\\max}^{\\text{approx}},\\ \\lvert \\text{abs error}\\rvert,\\ \\text{rel error}]$.\n- The printed line must be exactly of the form \n$[ [\\tau_{A}^{\\text{exact}},\\tau_{A}^{\\text{approx}},e_{A}^{\\text{abs}},e_{A}^{\\text{rel}}], [\\tau_{B}^{\\text{exact}},\\tau_{B}^{\\text{approx}},e_{B}^{\\text{abs}},e_{B}^{\\text{rel}}], [\\tau_{C}^{\\text{exact}},\\tau_{C}^{\\text{approx}},e_{C}^{\\text{abs}},e_{C}^{\\text{rel}}] ]$\nwith no extra text.\n\nAll computations must be performed in pure mathematics; no physical units other than those specified are required. Angles must be in radians, frequencies in radians per second, delays in seconds, and the relative error must be a decimal (not a percentage). Your program must not read any input.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It presents a standard, albeit advanced, problem in classical control theory concerning the stability of systems with time delays. All provided data and definitions are consistent with established principles of frequency-domain analysis and the Nyquist stability criterion. The problem is valid for solution.\n\nThe core of the problem lies in determining the delay margin, $\\tau_{\\max}$, for a unity feedback system with an open-loop transfer function $L(s)e^{-s\\tau}$. The system is stable for $\\tau \\in [0, \\tau_{\\max})$ and becomes marginally stable at $\\tau = \\tau_{\\max}$. According to the Nyquist stability criterion, for an open-loop stable system, marginal stability occurs when the Nyquist plot of the open-loop transfer function passes through the critical point $-1+j0$.\n\nThe open-loop transfer function with delay is $L_{d}(s) = L(s)e^{-s\\tau}$. Its frequency response is $L_{d}(j\\omega) = L(j\\omega)e^{-j\\omega\\tau}$. The condition for marginal stability is:\n$$\nL(j\\omega)e^{-j\\omega\\tau} = -1\n$$\nThis complex equation can be separated into two real equations for magnitude and phase:\n1.  Magnitude condition: $|L(j\\omega)| = 1$. The frequencies $\\omega  0$ that satisfy this condition are called gain-crossover frequencies. Let the set of these frequencies be $\\{\\omega_{gc,i}\\}$.\n2.  Phase condition: $\\arg(L(j\\omega)e^{-j\\omega\\tau}) = -\\pi$. This expands to $\\arg(L(j\\omega)) - \\omega\\tau = -(2k+1)\\pi$ for some integer $k$. For the smallest positive delay $\\tau$, we take $k=0$, so $\\arg(L(j\\omega)) - \\omega\\tau = -\\pi$.\n\nCombining these conditions, for each gain-crossover frequency $\\omega_{gc,i}$, we can find a delay $\\tau_i$ that would cause marginal stability at that frequency:\n$$\n\\tau_i = \\frac{\\pi + \\arg(L(j\\omega_{gc,i}))}{\\omega_{gc,i}}\n$$\nThe term $\\pi + \\arg(L(j\\omega_{gc,i}))$ is the phase margin at the frequency $\\omega_{gc,i}$. Since the delay $\\tau$ must be non-negative, we only consider solutions where the phase margin is non-negative.\nThe overall system becomes unstable as soon as the delay $\\tau$ reaches the smallest of these possible values. Therefore, the exact delay margin is the minimum of all such valid calculated delays:\n$$\n\\tau_{\\max}^{\\text{exact}} = \\min_{i} \\left\\{ \\tau_i \\mid \\tau_i \\ge 0 \\right\\}\n$$\nThe problem asks to compare this exact value with a common approximation:\n$$\n\\tau_{\\max}^{\\text{approx}} = \\frac{\\mathrm{PM}}{\\omega_{gc}}\n$$\nwhere $\\omega_{gc}$ is the *smallest* positive gain-crossover frequency, and $\\mathrm{PM}$ is the phase margin calculated at this specific frequency, $\\mathrm{PM} = \\pi + \\arg(L(j\\omega_{gc}))$.\n\nThe procedure for each test case is as follows:\n1.  Define the base open-loop transfer function $L_0(s)$ with gain $K=1$.\n2.  For the given frequency $\\omega_0$, calculate the required gain $K = 1/|L_0(j\\omega_0)|$ to ensure $|K L_0(j\\omega_0)|=1$. The full transfer function is then $L(s) = K \\cdot L_0(s)$.\n3.  Numerically find all positive frequencies $\\omega_{gc,i}$ where $|L(j\\omega)|=1$. This is achieved by finding the roots of the function $g(\\omega) = |L(j\\omega)|-1$. A numerical root-finding algorithm is employed by scanning a wide frequency range to identify intervals where roots exist.\n4.  The smallest positive root is designated as $\\omega_{gc}$. Using this, we compute $\\tau_{\\max}^{\\text{approx}} = (\\pi + \\arg(L(j\\omega_{gc})))/\\omega_{gc}$.\n5.  Using the full set of found gain-crossover frequencies $\\{\\omega_{gc,i}\\}$, we compute the set of potential delays $\\{\\tau_i\\}$. The minimum non-negative value in this set gives $\\tau_{\\max}^{\\text{exact}}$.\n6.  For Cases A and B, the magnitude responses $|L(j\\omega)|$ are found to be monotonically decreasing for $\\omega  0$. Consequently, there is only one gain-crossover frequency. In this scenario, the smallest (and only) crossover frequency is used for both calculations, resulting in $\\tau_{\\max}^{\\text{exact}} = \\tau_{\\max}^{\\text{approx}}$ and zero error.\n7.  For Case C, the presence of a resonant pair $(\\zeta=0.1)$ creates a non-monotonic magnitude response $|L(j\\omega)|$, which peaks near the natural frequency $\\omega_n=3$. This leads to multiple gain-crossover frequencies. The approximation uses only the lowest of these, while the exact calculation considers all of them. The higher-frequency crossovers typically yield smaller delay values, thus revealing a discrepancy between the exact and approximate delay margins. This discrepancy is the primary subject of investigation in this problem.\n8.  Finally, the absolute and relative errors are calculated and all results are rounded to $6$ decimal places as required. If $\\tau_{\\max}^{\\text{exact}} = 0$, the relative error is taken to be $0$.\n\nThe implementation will utilize `numpy` for complex arithmetic and `scipy.optimize.root_scalar` for robust numerical root finding.", "answer": "[[0.258756,0.258756,0.0,0.0],[0.282928,0.282928,0.0,0.0],[0.158309,0.345388,0.187079,1.181734]]", "id": "2906975"}]}