{"hands_on_practices": [{"introduction": "Before diving into general formulations, it is invaluable to ground our understanding in a concrete physical scenario. This first practice explores the material response under a simple uniaxial stretch, a common deformation mode. By starting with a defined stored-energy function, you will directly derive the corresponding Hencky strain $E$, Kirchhoff stress $\\tau$, and the axial tangent modulus, solidifying the fundamental relationships between energy, strain, and stress in deformation theory [@problem_id:2876930].", "problem": "An isotropic, compressible material is modeled by the quadratic Hencky (logarithmic) energy in the Eulerian description. Let the Kirchhoff stress $\\,\\tau\\,$ be work-conjugate to the Eulerian Hencky strain $\\,E\\,$, so that the differential internal work per unit current volume is $\\,\\mathrm{tr}(\\tau\\,\\mathrm{d}E)\\,$. The body undergoes the volume-preserving uniaxial stretch with deformation gradient\n$$F=\\mathrm{diag}(\\lambda,\\ \\lambda^{-1/2},\\ \\lambda^{-1/2}),\\qquad \\lambda>0,$$\nso that $\\det F=1$. The Eulerian Hencky strain is defined by $\\,E=\\ln V\\,$, where $\\,V\\,$ is the left stretch from the polar decomposition $\\,F=VR\\,$ with $\\,R\\,$ a rotation. The material stored-energy density per unit current volume is\n$$\\psi_H(E)=\\mu\\,\\| \\mathrm{dev}\\,E\\|^2+\\frac{\\kappa}{2}\\big(\\mathrm{tr}\\,E\\big)^2,$$\nwith shear modulus $\\,\\mu>0\\,$ and bulk modulus $\\,\\kappa>0\\,$, and where $\\,\\mathrm{dev}\\,E=E-\\tfrac{1}{3}(\\mathrm{tr}\\,E)\\,I\\,$ and $\\,\\|A\\|^2=\\mathrm{tr}(A^T A)\\,$.\n\nStarting from these definitions and principles, and without assuming any additional constitutive shortcuts, do the following:\n\n1) Compute the Hencky strain $\\,E(\\lambda)\\,$ induced by $\\,F\\,$ and use it to obtain the stored-energy density $\\,\\psi_H(\\lambda)\\,$.\n\n2) Identify the Kirchhoff stress response $\\,\\tau(\\lambda)\\,$ by using energetic conjugacy.\n\n3) Along this uniaxial loading path, let $\\,E_{11}=\\ln\\lambda\\,$ denote the axial logarithmic strain and $\\,\\tau_{11}\\,$ the axial Kirchhoff stress component. Compute the axial tangent modulus $\\,\\mathrm{d}\\tau_{11}/\\mathrm{d}E_{11}\\,$.\n\nProvide your final expressions in closed form in terms of $\\,\\lambda\\,$, $\\,\\mu\\,$, and $\\,\\kappa\\,$. No numerical approximation is required, and no units need to be reported in the final answer.", "solution": "The problem statement has been examined and is found to be scientifically grounded, self-contained, and well-posed. It presents a standard problem in finite strain elasticity based on the Hencky model. All definitions, variables, and conditions are provided, and no contradictions or ambiguities are present. The problem is valid for solution.\n\nThe solution proceeds in three parts as requested.\n\nPart 1: Computation of the Hencky strain $E(\\lambda)$ and the stored-energy density $\\psi_H(\\lambda)$.\n\nThe deformation gradient is given as a diagonal matrix:\n$$F = \\mathrm{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})$$\nSince $F$ is a symmetric and positive-definite matrix (as $\\lambda > 0$), its left polar decomposition $F = VR$ is trivial. The rotational part $R$ is the identity matrix, $R=I$, and the left stretch tensor $V$ is equal to the deformation gradient itself, $V=F$.\n$$V = \\mathrm{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})$$\nThe Eulerian Hencky strain $E$ is defined as the natural logarithm of the left stretch tensor $V$:\n$$E = \\ln V$$\nFor a diagonal matrix, the logarithm is computed element-wise:\n$$E(\\lambda) = \\ln(\\mathrm{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})) = \\mathrm{diag}(\\ln(\\lambda), \\ln(\\lambda^{-1/2}), \\ln(\\lambda^{-1/2}))$$\n$$E(\\lambda) = \\mathrm{diag}(\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda)$$\nNext, we compute the quantities required for the stored-energy density $\\psi_H$. The trace of the Hencky strain is:\n$$\\mathrm{tr}\\,E = \\ln\\lambda + (-\\tfrac{1}{2}\\ln\\lambda) + (-\\tfrac{1}{2}\\ln\\lambda) = 0$$\nThis result is consistent with the fact that the deformation is volume-preserving, $\\det F = \\lambda \\cdot \\lambda^{-1/2} \\cdot \\lambda^{-1/2} = 1$, which implies $\\mathrm{tr}\\,E = \\ln(\\det V) = \\ln(\\det F) = \\ln(1) = 0$.\n\nThe deviatoric part of the Hencky strain is defined as $\\mathrm{dev}\\,E = E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I$. Since $\\mathrm{tr}\\,E = 0$, the deviatoric strain is simply the strain itself:\n$$\\mathrm{dev}\\,E = E$$\nThe squared Frobenius norm of the deviatoric strain is $\\|\\mathrm{dev}\\,E\\|^2 = \\mathrm{tr}((\\mathrm{dev}\\,E)^T(\\mathrm{dev}\\,E)) = \\mathrm{tr}(E^T E)$. Since $E$ is symmetric, this is $\\mathrm{tr}(E^2)$.\n$$E^2 = \\mathrm{diag}((\\ln\\lambda)^2, (-\\tfrac{1}{2}\\ln\\lambda)^2, (-\\tfrac{1}{2}\\ln\\lambda)^2) = \\mathrm{diag}((\\ln\\lambda)^2, \\tfrac{1}{4}(\\ln\\lambda)^2, \\tfrac{1}{4}(\\ln\\lambda)^2)$$\n$$\\|\\mathrm{dev}\\,E\\|^2 = \\mathrm{tr}(E^2) = (\\ln\\lambda)^2 + \\tfrac{1}{4}(\\ln\\lambda)^2 + \\tfrac{1}{4}(\\ln\\lambda)^2 = (1 + \\tfrac{1}{2})(\\ln\\lambda)^2 = \\tfrac{3}{2}(\\ln\\lambda)^2$$\nThe stored-energy density per unit current volume is given by $\\psi_H(E) = \\mu\\,\\| \\mathrm{dev}\\,E\\|^2 + \\frac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$. Substituting the derived quantities:\n$$\\psi_H(\\lambda) = \\mu \\left(\\tfrac{3}{2}(\\ln\\lambda)^2\\right) + \\tfrac{\\kappa}{2}(0)^2 = \\tfrac{3}{2}\\mu(\\ln\\lambda)^2$$\nThis is the first required result.\n\nPart 2: Identification of the Kirchhoff stress response $\\tau(\\lambda)$.\n\nThe Kirchhoff stress $\\tau$ is work-conjugate to the Hencky strain $E$, which implies the constitutive relation $\\tau = \\frac{\\partial \\psi_H}{\\partial E}$. We must differentiate the stored-energy function with respect to the tensor $E$.\n$$\\psi_H(E) = \\mu\\,\\mathrm{tr}((E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I)^T(E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I)) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\n$$\\psi_H(E) = \\mu\\,\\mathrm{tr}(E^2 - \\tfrac{2}{3}(\\mathrm{tr}\\,E)E + \\tfrac{1}{9}(\\mathrm{tr}\\,E)^2 I) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\n$$\\psi_H(E) = \\mu(\\mathrm{tr}(E^2) - \\tfrac{2}{3}(\\mathrm{tr}\\,E)^2 + \\tfrac{1}{3}(\\mathrm{tr}\\,E)^2) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\n$$\\psi_H(E) = \\mu(\\mathrm{tr}(E^2) - \\tfrac{1}{3}(\\mathrm{tr}\\,E)^2) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\nUsing the standard tensor calculus identities $\\frac{\\partial(\\mathrm{tr}(E^2))}{\\partial E} = 2E$ and $\\frac{\\partial((\\mathrm{tr}\\,E)^2)}{\\partial E} = 2(\\mathrm{tr}\\,E)I$, we obtain:\n$$\\tau = \\frac{\\partial \\psi_H}{\\partial E} = \\mu(2E - \\tfrac{2}{3}(\\mathrm{tr}\\,E)I) + \\tfrac{\\kappa}{2}(2(\\mathrm{tr}\\,E)I)$$\n$$\\tau = 2\\mu(E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I) + \\kappa(\\mathrm{tr}\\,E)I$$\nRecognizing the deviatoric strain tensor, the general constitutive law is:\n$$\\tau = 2\\mu\\,\\mathrm{dev}\\,E + \\kappa(\\mathrm{tr}\\,E)I$$\nFor the specific uniaxial deformation path, we have already established that $\\mathrm{tr}\\,E = 0$ and $\\mathrm{dev}\\,E = E$. The constitutive equation therefore simplifies to:\n$$\\tau = 2\\mu E$$\nSubstituting the expression for $E(\\lambda)$:\n$$\\tau(\\lambda) = 2\\mu\\,\\mathrm{diag}(\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda)$$\n$$\\tau(\\lambda) = \\mathrm{diag}(2\\mu\\ln\\lambda, -\\mu\\ln\\lambda, -\\mu\\ln\\lambda)$$\nThis is the second required result.\n\nPart 3: Computation of the axial tangent modulus $\\mathrm{d}\\tau_{11}/\\mathrm{d}E_{11}$.\n\nFrom the results of the previous parts, we identify the axial components of the Kirchhoff stress and Hencky strain.\nThe axial Kirchhoff stress is:\n$$\\tau_{11} = 2\\mu\\ln\\lambda$$\nThe axial logarithmic strain is:\n$$E_{11} = \\ln\\lambda$$\nWe are asked to compute the derivative $\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}}$. By direct substitution, we observe a linear relationship between the axial stress and axial strain components:\n$$\\tau_{11} = 2\\mu E_{11}$$\nDifferentiating $\\tau_{11}$ with respect to $E_{11}$ yields a constant:\n$$\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}} = \\frac{\\mathrm{d}}{\\mathrm{d}E_{11}}(2\\mu E_{11}) = 2\\mu$$\nAlternatively, using the chain rule with respect to $\\lambda$:\n$$\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}}{\\mathrm{d}\\lambda}(2\\mu\\ln\\lambda) = \\frac{2\\mu}{\\lambda}$$\n$$\\frac{\\mathrm{d}E_{11}}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}}{\\mathrm{d}\\lambda}(\\ln\\lambda) = \\frac{1}{\\lambda}$$\n$$\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}} = \\frac{\\mathrm{d}\\tau_{11}/\\mathrm{d}\\lambda}{\\mathrm{d}E_{11}/\\mathrm{d}\\lambda} = \\frac{2\\mu / \\lambda}{1 / \\lambda} = 2\\mu$$\nBoth methods confirm that the axial tangent modulus along this loading path is $2\\mu$. This is the third and final result.\n\nThe three requested expressions are:\n1) $\\psi_H(\\lambda) = \\tfrac{3}{2}\\mu(\\ln\\lambda)^2$\n2) $\\tau(\\lambda) = \\mathrm{diag}(2\\mu\\ln\\lambda, -\\mu\\ln\\lambda, -\\mu\\ln\\lambda)$\n3) $\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}} = 2\\mu$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3}{2}\\mu(\\ln\\lambda)^{2} & \\mathrm{diag}(2\\mu\\ln\\lambda, -\\mu\\ln\\lambda, -\\mu\\ln\\lambda) & 2\\mu \\end{pmatrix}}$$", "id": "2876930"}, {"introduction": "Moving from a specific deformation to a general constitutive framework, this exercise tackles a central task in computational mechanics: the derivation of the consistent tangent operator $\\mathbb{C}_t$. This fourth-order tensor represents the local linearization of the nonlinear stress-strain relationship and is fundamental for developing robust numerical solvers. This practice will sharpen your tensor calculus skills and reveal the mathematical structure underlying modern simulation software [@problem_id:2876868].", "problem": "Consider an isotropic deformation theory of plasticity in the sense of Hencky, where the Kirchhoff stress tensor $\\tau$ is taken as a function of the Hencky (logarithmic) strain tensor $E$ via\n$$\n\\tau(E) = 2\\,G_s\\!\\left(\\bar{E}\\right)\\,\\operatorname{dev}E \\;+\\; 3\\,K_s\\!\\left(\\operatorname{tr}E\\right)\\,\\operatorname{tr}(E)\\,I,\n$$\nwith $E$ symmetric. Here $I$ is the second-order identity, $\\operatorname{tr}(\\cdot)$ is the trace, and $\\operatorname{dev}E := E - \\tfrac{1}{3}\\operatorname{tr}(E)\\,I$ is the deviatoric part. The equivalent Hencky strain is defined by\n$$\n\\bar{E} := \\sqrt{\\tfrac{2}{3}}\\,\\|\\operatorname{dev}E\\|, \\quad \\|\\cdot\\| := \\sqrt{(\\cdot):(\\cdot)},\n$$\nand the scalar functions $G_s(\\cdot)$ and $K_s(\\cdot)$ are differentiable in their arguments. Define the fourth-order consistent tangent operator $\\mathbb{C}_t$ as the Fréchet derivative of $\\tau$ with respect to $E$, namely $\\mathbb{C}_t := \\dfrac{\\partial \\tau}{\\partial E}$ such that $d\\tau = \\mathbb{C}_t : dE$ for any symmetric variation $dE$.\n\nStarting from the above constitutive assumption, the definitions of $\\operatorname{tr}(\\cdot)$, $\\operatorname{dev}(\\cdot)$, and $\\bar{E}$, and using only basic tensor calculus (double contraction and outer products), compute the closed-form expression for $\\mathbb{C}_t$ in terms of $E$, $I$, the fourth-order deviatoric projector, and the derivatives $\\dfrac{dG_s}{d\\bar{E}}$ and $\\dfrac{dK_s}{d(\\operatorname{tr}E)}$. Assume $\\operatorname{dev}E \\neq 0$ so that $\\bar{E} > 0$.\n\nNotation and conventions:\n- The double contraction is $A:B := \\operatorname{tr}(A^{\\mathsf{T}}B)$.\n- For second-order tensors $A$ and $B$, the fourth-order tensor $A \\otimes B$ acts on a second-order tensor $X$ as $(A \\otimes B):X = A\\,(B:X)$.\n- The fourth-order identity $\\mathbb{I}$ is defined by $\\mathbb{I}:X = X$ for any second-order $X$.\n- The fourth-order deviatoric projector is $\\mathbb{I}^{\\operatorname{dev}} := \\mathbb{I} - \\tfrac{1}{3}\\,I \\otimes I$.\n\nYour final answer must be a single closed-form analytic expression for $\\mathbb{C}_t$. No numerical evaluation is required, and no units are needed. Express your final result as a single expression and do not include any inequalities or equations other than the requested expression.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\nGivens are extracted verbatim as follows:\n- Constitutive law: $\\tau(E) = 2\\,G_s\\!\\left(\\bar{E}\\right)\\,\\operatorname{dev}E \\;+\\; 3\\,K_s\\!\\left(\\operatorname{tr}E\\right)\\,\\operatorname{tr}(E)\\,I$.\n- Strain tensor $E$ is symmetric.\n- $I$ is the second-order identity tensor.\n- $\\operatorname{tr}(\\cdot)$ is the trace operator.\n- $\\operatorname{dev}E := E - \\tfrac{1}{3}\\operatorname{tr}(E)\\,I$.\n- Equivalent Hencky strain: $\\bar{E} := \\sqrt{\\tfrac{2}{3}}\\,\\|\\operatorname{dev}E\\|, \\quad \\|\\cdot\\| := \\sqrt{(\\cdot):(\\cdot)}$.\n- The scalar functions $G_s(\\cdot)$ and $K_s(\\cdot)$ are differentiable.\n- The fourth-order consistent tangent operator is $\\mathbb{C}_t := \\dfrac{\\partial \\tau}{\\partial E}$, defined by $d\\tau = \\mathbb{C}_t : dE$.\n- An assumption is made that $\\operatorname{dev}E \\neq 0$, which implies $\\bar{E} > 0$.\n- Notation: $A:B := \\operatorname{tr}(A^{\\mathsf{T}}B)$, $(A \\otimes B):X = A\\,(B:X)$, $\\mathbb{I}:X = X$, $\\mathbb{I}^{\\operatorname{dev}} := \\mathbb{I} - \\tfrac{1}{3}\\,I \\otimes I$.\n\nThe problem is assessed for validity.\n1.  **Scientifically Grounded**: The problem is a standard derivation in nonlinear solid mechanics, specifically concerning hyperelastic or deformation-theory plasticity models (Hencky-type models). All concepts and definitions are well-established in continuum mechanics and tensor calculus. It is scientifically sound.\n2.  **Well-Posed**: The problem asks for the Fréchet derivative of a well-defined, differentiable function. All necessary quantities are defined, and the assumption $\\bar{E} > 0$ ensures that the function $G_s(\\bar{E})$ is evaluated away from a potential point of non-differentiability of $\\bar{E}$ itself (at $\\operatorname{dev}E=0$). A unique solution exists.\n3.  **Objective**: The problem is stated in precise mathematical language, free from ambiguity or subjective content.\n\nThe problem is deemed valid. A solution will be furnished.\n\nThe objective is to compute the fourth-order tangent operator $\\mathbb{C}_t = \\dfrac{\\partial \\tau}{\\partial E}$. The stress tensor $\\tau$ is composed of a deviatoric part, $\\tau_{\\text{dev}}$, and a volumetric part, $\\tau_{\\text{vol}}$:\n$$\n\\tau(E) = \\tau_{\\text{dev}}(E) + \\tau_{\\text{vol}}(E)\n$$\nwhere\n$$\n\\tau_{\\text{dev}}(E) = 2\\,G_s(\\bar{E})\\,\\operatorname{dev}E\n$$\n$$\n\\tau_{\\text{vol}}(E) = 3\\,K_s(\\operatorname{tr}E)\\,\\operatorname{tr}(E)\\,I\n$$\nBy linearity of differentiation, the tangent operator is the sum of the derivatives of these two parts:\n$$\n\\mathbb{C}_t = \\frac{\\partial \\tau}{\\partial E} = \\frac{\\partial \\tau_{\\text{dev}}}{\\partial E} + \\frac{\\partial \\tau_{\\text{vol}}}{\\partial E}\n$$\nWe shall compute each derivative separately.\n\nFirst, we address the derivative of the volumetric part, $\\tau_{\\text{vol}}$. Let $\\theta := \\operatorname{tr}(E)$. The volumetric stress is $\\tau_{\\text{vol}} = 3\\,K_s(\\theta)\\,\\theta\\,I$. We find its differential, $d\\tau_{\\text{vol}}$:\n$$\nd\\tau_{\\text{vol}} = d(3\\,K_s(\\theta)\\,\\theta\\,I) = 3\\,I\\,d(K_s(\\theta)\\,\\theta)\n$$\nUsing the product rule for scalar differentiation:\n$$\nd(K_s(\\theta)\\,\\theta) = \\left( \\frac{d(K_s\\theta)}{d\\theta} \\right) d\\theta = \\left( \\frac{dK_s}{d\\theta}\\theta + K_s(\\theta) \\right) d\\theta\n$$\nThe differential of the trace is $d\\theta = d(\\operatorname{tr}(E)) = \\operatorname{tr}(dE) = I:dE$. Substituting this into the expression for $d\\tau_{\\text{vol}}$ yields:\n$$\nd\\tau_{\\text{vol}} = 3\\,I \\left( \\frac{dK_s}{d\\theta}\\theta + K_s(\\theta) \\right) (I:dE)\n$$\nRecalling the definition of the outer product $(A \\otimes B):X = A(B:X)$, we can identify the fourth-order tensor representing the derivative of the volumetric part:\n$$\n\\frac{\\partial \\tau_{\\text{vol}}}{\\partial E} = 3\\left(K_s(\\operatorname{tr}E) + \\operatorname{tr}(E)\\frac{dK_s}{d(\\operatorname{tr}E)}\\right) I \\otimes I\n$$\n\nNext, we address the derivative of the deviatoric part, $\\tau_{\\text{dev}} = 2\\,G_s(\\bar{E})\\,\\operatorname{dev}E$. We apply the product rule for differentiation with respect to a tensor:\n$$\nd\\tau_{\\text{dev}} = d(2\\,G_s(\\bar{E})\\,\\operatorname{dev}E) = 2\\,(dG_s(\\bar{E}))\\,\\operatorname{dev}E + 2\\,G_s(\\bar{E})\\,d(\\operatorname{dev}E)\n$$\nWe analyze each term in the sum. The differential of the deviatoric part of $E$ is:\n$$\nd(\\operatorname{dev}E) = d\\left(E - \\frac{1}{3}\\operatorname{tr}(E)I\\right) = dE - \\frac{1}{3}d(\\operatorname{tr}(E))I = dE - \\frac{1}{3}(I:dE)I\n$$\nThis expression can be written using the fourth-order deviatoric projection operator $\\mathbb{I}^{\\operatorname{dev}} = \\mathbb{I} - \\frac{1}{3}I \\otimes I$:\n$$\nd(\\operatorname{dev}E) = \\mathbb{I}^{\\operatorname{dev}}:dE\n$$\nThus, the second term of $d\\tau_{\\text{dev}}$ is $2\\,G_s(\\bar{E})\\,(\\mathbb{I}^{\\operatorname{dev}}:dE)$, which corresponds to the tensor $2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}}$.\n\nFor the first term, $2\\,(dG_s(\\bar{E}))\\,\\operatorname{dev}E$, we use the chain rule: $dG_s(\\bar{E}) = \\frac{dG_s}{d\\bar{E}}d\\bar{E}$. We must find the differential of the equivalent strain, $d\\bar{E}$.\n$$\n\\bar{E} = \\sqrt{\\frac{2}{3}}\\|\\operatorname{dev}E\\| = \\sqrt{\\frac{2}{3}} \\left(\\operatorname{dev}E:\\operatorname{dev}E\\right)^{1/2}\n$$\nThe differential is:\n$$\nd\\bar{E} = \\sqrt{\\frac{2}{3}} \\cdot \\frac{1}{2\\|\\operatorname{dev}E\\|} \\cdot d(\\operatorname{dev}E:\\operatorname{dev}E) = \\sqrt{\\frac{2}{3}} \\frac{1}{\\|\\operatorname{dev}E\\|} (\\operatorname{dev}E : d(\\operatorname{dev}E))\n$$\nSince $\\operatorname{dev}E$ is a deviatoric tensor, it is orthogonal to the identity tensor $I$ in the Frobenius inner product space. Also, $d(\\operatorname{dev}E) = \\mathbb{I}^{\\operatorname{dev}}:dE$ is deviatoric. The contraction of a deviatoric tensor with the result of a deviatoric projection is simplified: $\\operatorname{dev}E : d(\\operatorname{dev}E) = \\operatorname{dev}E : (\\mathbb{I}^{\\operatorname{dev}}:dE) = (\\operatorname{dev}E:\\mathbb{I}^{\\operatorname{dev}}):dE = \\operatorname{dev}E:dE$. Therefore:\n$$\nd\\bar{E} = \\sqrt{\\frac{2}{3}} \\frac{\\operatorname{dev}E}{\\|\\operatorname{dev}E\\|} : dE\n$$\nWe define the normalized deviatoric strain tensor $N := \\frac{\\operatorname{dev}E}{\\|\\operatorname{dev}E\\|}$. Then $d\\bar{E} = \\sqrt{\\frac{2}{3}}(N:dE)$.\nSubstituting this into the first term of $d\\tau_{\\text{dev}}$ gives:\n$$\n2\\,(dG_s(\\bar{E}))\\,\\operatorname{dev}E = 2\\,\\frac{dG_s}{d\\bar{E}} \\left( \\sqrt{\\frac{2}{3}}(N:dE) \\right) \\operatorname{dev}E = \\left( 2\\sqrt{\\frac{2}{3}}\\frac{dG_s}{d\\bar{E}} (\\operatorname{dev}E \\otimes N) \\right) : dE\n$$\nTo simplify the pre-factor, we use the relations $\\operatorname{dev}E = \\|\\operatorname{dev}E\\|N$ and $\\bar{E} = \\sqrt{\\frac{2}{3}}\\|\\operatorname{dev}E\\|$:\n$$\n2\\sqrt{\\frac{2}{3}}\\frac{dG_s}{d\\bar{E}} (\\operatorname{dev}E \\otimes N) = 2\\sqrt{\\frac{2}{3}}\\frac{dG_s}{d\\bar{E}} (\\|\\operatorname{dev}E\\|N \\otimes N) = 2\\frac{dG_s}{d\\bar{E}} \\left( \\sqrt{\\frac{2}{3}}\\|\\operatorname{dev}E\\| \\right) (N \\otimes N) = 2\\bar{E}\\frac{dG_s}{d\\bar{E}} (N \\otimes N)\n$$\nUsing $N \\otimes N = \\frac{\\operatorname{dev}E \\otimes \\operatorname{dev}E}{\\|\\operatorname{dev}E\\|^2}$ and $\\|\\operatorname{dev}E\\|^2 = \\frac{3}{2}\\bar{E}^2$, this becomes:\n$$\n2\\bar{E}\\frac{dG_s}{d\\bar{E}} \\left( \\frac{\\operatorname{dev}E \\otimes \\operatorname{dev}E}{(3/2)\\bar{E}^2} \\right) = \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E)\n$$\nCombining the two parts of the derivative of the deviatoric stress, we find:\n$$\n\\frac{\\partial \\tau_{\\text{dev}}}{\\partial E} = 2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}} + \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E)\n$$\n\nFinally, we sum the volumetric and deviatoric contributions to obtain the full tangent operator $\\mathbb{C}_t$:\n$$\n\\mathbb{C}_t = 2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}} + \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E) + 3\\left(K_s(\\operatorname{tr}E) + \\operatorname{tr}(E)\\frac{dK_s}{d(\\operatorname{tr}E)}\\right) I \\otimes I\n$$\nThis is the closed-form expression for the consistent tangent operator.", "answer": "$$\n\\boxed{2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}} + \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E) + 3\\left(K_s(\\operatorname{tr}E) + \\operatorname{tr}(E)\\frac{dK_s}{d(\\operatorname{tr}E)}\\right) I \\otimes I}\n$$", "id": "2876868"}, {"introduction": "Our final practice brings theory into the realm of practical application by tackling the plane stress condition within the Hencky framework. Since the out-of-plane strain is not zero, it must be computed iteratively to enforce the constraint that the out-of-plane stress vanishes, i.e., $\\tau_{33}=0$. You will derive the necessary residual and tangent for a Newton-Raphson solver and implement the algorithm, demonstrating how theoretical constitutive models are integrated into robust computational procedures for engineering analysis [@problem_id:2876883].", "problem": "Consider a three-dimensional isotropic material discretized by a two-dimensional plane-stress finite element at finite strains. The constitutive assumption follows the deformation theory of plasticity in Hencky (logarithmic) measures. The in-plane logarithmic strain components $E_{11}$, $E_{22}$, and $E_{12}$ are known from the element kinematics, while the out-of-plane logarithmic strain component $E_{33}$ is unknown and must be determined to satisfy the plane-stress condition. The task is to formulate and implement an iterative update for $E_{33}$ that enforces the plane-stress constraint by solving for $E_{33}$ such that the out-of-plane component of the Kirchhoff stress $ \\tau_{33}$ vanishes, i.e., $ \\tau_{33} = 0$, while using Hencky measures for the in-plane components.\n\nAssume the following fundamental definitions and modeling choices:\n- The Kirchhoff stress $ \\boldsymbol{\\tau}$ is related to the logarithmic strain $ \\mathbf{E}$ by an isotropic relation consistent with the deformation theory of plasticity in Hencky measures:\n$$\n\\boldsymbol{\\tau} = K\\!\\left(\\bar{E}\\right) \\, \\mathrm{tr}(\\mathbf{E}) \\, \\mathbf{I} + 2 \\, G\\!\\left(\\bar{E}\\right) \\, \\mathbf{E}^{\\mathrm{dev}},\n$$\nwhere $ \\mathrm{tr}(\\cdot)$ is the trace, $ \\mathbf{I}$ is the second-order identity tensor, and $ \\mathbf{E}^{\\mathrm{dev}} = \\mathbf{E} - \\tfrac{1}{3}\\mathrm{tr}(\\mathbf{E}) \\mathbf{I}$ is the deviatoric part of the logarithmic strain.\n- The equivalent Hencky strain $ \\bar{E}$ is defined as the second invariant measure of $ \\mathbf{E}^{\\mathrm{dev}}$:\n$$\n\\bar{E} = \\sqrt{\\tfrac{2}{3} \\, \\mathbf{E}^{\\mathrm{dev}} : \\mathbf{E}^{\\mathrm{dev}} }.\n$$\n- The bulk modulus is taken as constant $ K(\\bar{E}) = K_0$ and the shear modulus softens with the equivalent strain according to\n$$\nG(\\bar{E}) = G_\\infty + \\frac{G_0 - G_\\infty}{1 + \\left(\\frac{\\bar{E}}{E_p}\\right)^{n}},\n$$\nwith material parameters $ K_0 > 0$, $ G_0 > 0$, $ 0 < G_\\infty < G_0$, $ E_p > 0$, and $ n \\ge 1$.\n- Plane stress is enforced at the Kirchhoff stress level, which is equivalent to $ \\sigma_{33} = 0$ because $ \\boldsymbol{\\tau} = J \\boldsymbol{\\sigma}$ with $ J > 0$.\n\nYou must:\n- Derive from first principles the scalar residual equation $ r(E_{33}) = \\tau_{33}(E_{33})$ and its derivative $ r'(E_{33}) = \\mathrm{d}\\tau_{33}/\\mathrm{d}E_{33}$ needed for a robust Newton iteration. Explicitly state how $ \\mathrm{tr}(\\mathbf{E})$, $ \\mathbf{E}^{\\mathrm{dev}}$, $ \\bar{E}$, and $ \\mathrm{d}G/\\mathrm{d}E_{33}$ are computed, making no assumptions beyond the fundamental isotropy of the constitutive response and the definitions above.\n- Propose and implement a damped Newton method with backtracking that solves $ r(E_{33}) = 0$ for $ E_{33}$ for each test case below. The iteration must terminate when the absolute residual $ |r(E_{33})|$ is less than $ 10^{-12}$ in Pascals or when the absolute update $ |\\Delta E_{33}|$ is less than $ 10^{-14}$, or after at most $ 50$ iterations if convergence is not achieved. Use a physically motivated initial guess derived by freezing $ G(\\bar{E})$ at $ G_0$ and solving the linearized plane-stress condition.\n- Treat the in-plane shear-logarithmic strain $ E_{12}$ as the tensorial component (not engineering shear), and assume $ E_{13} = 0$ and $ E_{23} = 0$.\n\nMaterial parameters for all test cases:\n- $ K_0 = 1.60 \\times 10^{11}$ Pascals.\n- $ G_0 = 8.00 \\times 10^{10}$ Pascals.\n- $ G_\\infty = 0.20 \\, G_0$.\n- $ E_p = 5.0 \\times 10^{-2}$ (dimensionless).\n- $ n = 2$.\n\nTest suite (provide $ E_{11}$, $ E_{22}$, $ E_{12}$; all strains dimensionless):\n1. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(2.0 \\times 10^{-2}, -1.0 \\times 10^{-2}, 3.0 \\times 10^{-2}\\right)$.\n2. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(5.0 \\times 10^{-2}, 5.0 \\times 10^{-2}, 0.0\\right)$.\n3. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(0.0, 0.0, 0.0\\right)$.\n4. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(0.0, 0.0, 2.0 \\times 10^{-1}\\right)$.\n5. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(1.5 \\times 10^{-1}, -2.0 \\times 10^{-2}, 1.0 \\times 10^{-2}\\right)$.\n\nYour program must:\n- Implement the Newton solver for $ E_{33}$ using the derived residual and its derivative.\n- For each test case, compute and return the converged value of $ E_{33}$ (dimensionless).\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [x_1,x_2,x_3,x_4,x_5]$). Each entry must be a floating-point number.\n\nNo user input should be read. All computations must be performed with the constants and test cases provided above. The output has no units because $ E_{33}$ is dimensionless.", "solution": "The problem presented is a well-posed problem in computational solid mechanics. It is scientifically grounded, self-contained, and requires the derivation and implementation of a numerical algorithm to solve a non-linear scalar equation. The definitions for stress, strain, and the constitutive model are standard within the framework of deformation theory of plasticity using logarithmic strain measures. All necessary material parameters and boundary conditions, in the form of prescribed in-plane strains and the plane-stress constraint, are provided. Therefore, I will proceed with the derivation and solution.\n\nThe objective is to find the out-of-plane logarithmic strain component, $E_{33}$, that satisfies the plane-stress condition $\\tau_{33} = 0$, given the in-plane components $E_{11}$, $E_{22}$, and $E_{12}$. The logarithmic strain tensor $\\mathbf{E}$ is given by:\n$$\n\\mathbf{E} = \\begin{pmatrix} E_{11} & E_{12} & 0 \\\\ E_{12} & E_{22} & 0 \\\\ 0 & 0 & E_{33} \\end{pmatrix}\n$$\nThe solution requires a Newton-Raphson iterative scheme, for which we must derive the residual function $r(E_{33}) = \\tau_{33}(E_{33})$ and its derivative with respect to $E_{33}$.\n\nFirst, we express the fundamental kinematic quantities as functions of the unknown $E_{33}$. The trace of the strain tensor is:\n$$\n\\mathrm{tr}(\\mathbf{E}) = E_{11} + E_{22} + E_{33}\n$$\nThe deviatoric part of the logarithmic strain, $\\mathbf{E}^{\\mathrm{dev}} = \\mathbf{E} - \\frac{1}{3}\\mathrm{tr}(\\mathbf{E})\\mathbf{I}$, has the following out-of-plane normal component:\n$$\nE_{33}^{\\mathrm{dev}} = E_{33} - \\frac{1}{3}\\mathrm{tr}(\\mathbf{E}) = E_{33} - \\frac{1}{3}(E_{11} + E_{22} + E_{33}) = \\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22})\n$$\nThe constitutive relation for the Kirchhoff stress $\\boldsymbol{\\tau}$ is given as:\n$$\n\\boldsymbol{\\tau} = K_0 \\mathrm{tr}(\\mathbf{E}) \\mathbf{I} + 2 G(\\bar{E}) \\mathbf{E}^{\\mathrm{dev}}\n$$\nwhere $K_0$ is the constant bulk modulus and $G(\\bar{E})$ is the strain-dependent shear modulus. The plane-stress condition $\\tau_{33} = 0$ yields the scalar residual equation:\n$$\nr(E_{33}) = \\tau_{33}(E_{33}) = K_0 \\mathrm{tr}(\\mathbf{E}) + 2 G(\\bar{E}) E_{33}^{\\mathrm{dev}} = 0\n$$\nSubstituting the expressions for $\\mathrm{tr}(\\mathbf{E})$ and $E_{33}^{\\mathrm{dev}}$, we obtain the explicit form of the residual function:\n$$\nr(E_{33}) = K_0 (E_{11} + E_{22} + E_{33}) + 2 G(\\bar{E}) \\left( \\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22}) \\right)\n$$\nThis is a non-linear equation in $E_{33}$ because the shear modulus $G$ depends on the equivalent strain $\\bar{E}$, which in turn depends on $E_{33}$. The equivalent strain $\\bar{E}$ is defined as:\n$$\n\\bar{E} = \\sqrt{\\frac{2}{3} \\mathbf{E}^{\\mathrm{dev}} : \\mathbf{E}^{\\mathrm{dev}}} = \\sqrt{\\frac{2}{3} \\left[ (E_{11}^{\\mathrm{dev}})^2 + (E_{22}^{\\mathrm{dev}})^2 + (E_{33}^{\\mathrm{dev}})^2 + 2(E_{12}^{\\mathrm{dev}})^2 \\right]}\n$$\nSince $E_{13}=E_{23}=0$, we have $E_{13}^{\\mathrm{dev}}=E_{23}^{\\mathrm{dev}}=0$. Note that $E_{12}^{\\mathrm{dev}} = E_{12}$.\n\nFor the Newton-Raphson method, we require the derivative of the residual, $r'(E_{33}) = \\mathrm{d}r/\\mathrm{d}E_{33}$. Applying the chain rule:\n$$\nr'(E_{33}) = \\frac{\\mathrm{d}}{\\mathrm{d}E_{33}} \\left[ K_0 \\mathrm{tr}(\\mathbf{E}) + 2 G(\\bar{E}) E_{33}^{\\mathrm{dev}} \\right] = K_0 \\frac{\\mathrm{d}(\\mathrm{tr}(\\mathbf{E}))}{\\mathrm{d}E_{33}} + 2 \\frac{\\mathrm{d}G}{\\mathrm{d}E_{33}} E_{33}^{\\mathrm{dev}} + 2 G(\\bar{E}) \\frac{\\mathrm{d}(E_{33}^{\\mathrm{dev}})}{\\mathrm{d}E_{33}}\n$$\nThe derivatives of the kinematic terms are straightforward:\n$$\n\\frac{\\mathrm{d}(\\mathrm{tr}(\\mathbf{E}))}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}}{\\mathrm{d}E_{33}}(E_{11} + E_{22} + E_{33}) = 1\n$$\n$$\n\\frac{\\mathrm{d}(E_{33}^{\\mathrm{dev}})}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}}{\\mathrm{d}E_{33}}\\left(\\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22})\\right) = \\frac{2}{3}\n$$\nThe derivative of the shear modulus with respect to $E_{33}$ is found using the chain rule:\n$$\n\\frac{\\mathrm{d}G}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}G}{\\mathrm{d}(\\bar{E}^2)} \\frac{\\mathrm{d}(\\bar{E}^2)}{\\mathrm{d}E_{33}}\n$$\nFirst, let us find $\\mathrm{d}(\\bar{E}^2)/\\mathrm{d}E_{33}$. We have $\\bar{E}^2 = \\frac{2}{3}\\mathbf{E}^{\\mathrm{dev}}:\\mathbf{E}^{\\mathrm{dev}}$.\n$$\n\\frac{\\mathrm{d}(\\bar{E}^2)}{\\mathrm{d}E_{33}} = \\frac{2}{3} \\left( 2 \\frac{\\mathrm{d}\\mathbf{E}^{\\mathrm{dev}}}{\\mathrm{d}E_{33}} : \\mathbf{E}^{\\mathrm{dev}} \\right)\n$$\nThe derivative of the deviatoric strain tensor is $\\frac{\\mathrm{d}\\mathbf{E}^{\\mathrm{dev}}}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}\\mathbf{E}}{\\mathrm{d}E_{33}} - \\frac{1}{3} \\frac{\\mathrm{d}(\\mathrm{tr}(\\mathbf{E}))}{\\mathrm{d}E_{33}} \\mathbf{I}$. Let $\\mathbf{N}$ be a tensor with component $N_{33}=1$ and all others zero. Then $\\frac{\\mathrm{d}\\mathbf{E}}{\\mathrm{d}E_{33}} = \\mathbf{N}$. Thus, $\\frac{\\mathrm{d}\\mathbf{E}^{\\mathrm{dev}}}{\\mathrm{d}E_{33}} = \\mathbf{N} - \\frac{1}{3}\\mathbf{I} = \\text{diag}(-\\frac{1}{3}, -\\frac{1}{3}, \\frac{2}{3})$.\nThe tensor contraction yields $(\\mathbf{N} - \\frac{1}{3}\\mathbf{I}) : \\mathbf{E}^{\\mathrm{dev}} = -\\frac{1}{3}E_{11}^{\\mathrm{dev}} -\\frac{1}{3}E_{22}^{\\mathrm{dev}} + \\frac{2}{3}E_{33}^{\\mathrm{dev}}$. Using the property $\\mathrm{tr}(\\mathbf{E}^{\\mathrm{dev}})=0$, we get $E_{11}^{\\mathrm{dev}}+E_{22}^{\\mathrm{dev}} = -E_{33}^{\\mathrm{dev}}$, so the contraction simplifies to $E_{33}^{\\mathrm{dev}}$.\nTherefore, $\\frac{\\mathrm{d}(\\bar{E}^2)}{\\mathrm{d}E_{33}} = \\frac{4}{3}E_{33}^{\\mathrm{dev}}$.\nNext, we find $\\mathrm{d}G/\\mathrm{d}(\\bar{E}^2)$. With $n=2$, the shear modulus is $G(\\bar{E}) = G_\\infty + \\frac{G_0 - G_\\infty}{1 + (\\bar{E}/E_p)^2} = G_\\infty + \\frac{G_0 - G_\\infty}{1 + \\bar{E}^2/E_p^2}$.\nLet $y = \\bar{E}^2$ and $\\Delta G = G_0 - G_\\infty$.\n$$\n\\frac{\\mathrm{d}G}{\\mathrm{d}y} = \\Delta G \\cdot (-1) \\left(1 + \\frac{y}{E_p^2}\\right)^{-2} \\cdot \\frac{1}{E_p^2} = -\\frac{\\Delta G / E_p^2}{(1 + \\bar{E}^2/E_p^2)^2}\n$$\nCombining these results, we get $\\frac{\\mathrm{d}G}{\\mathrm{d}E_{33}} = -\\frac{\\Delta G / E_p^2}{(1 + \\bar{E}^2/E_p^2)^2} \\frac{4}{3}E_{33}^{\\mathrm{dev}}$.\nSubstituting all derivatives back into the expression for $r'(E_{33})$:\n$$\nr'(E_{33}) = K_0(1) + 2 \\left( -\\frac{\\Delta G / E_p^2}{(1 + \\bar{E}^2/E_p^2)^2} \\frac{4}{3}E_{33}^{\\mathrm{dev}} \\right) E_{33}^{\\mathrm{dev}} + 2 G(\\bar{E}) \\left( \\frac{2}{3} \\right)\n$$\n$$\nr'(E_{33}) = K_0 + \\frac{4}{3}G(\\bar{E}) - \\frac{8}{3} \\frac{\\Delta G}{E_p^2} \\frac{(E_{33}^{\\mathrm{dev}})^2}{(1+\\bar{E}^2/E_p^2)^2}\n$$\nThis expression is numerically robust and well-defined for all values of $\\bar{E}$, including $\\bar{E}=0$.\n\nAn initial guess, $E_{33}^{(0)}$, for the Newton iteration is derived by linearizing the problem, i.e., assuming $G(\\bar{E}) = G_0$. The residual equation $r(E_{33})=0$ becomes linear:\n$$\nK_0 (E_{11} + E_{22} + E_{33}) + 2 G_0 \\left( \\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22}) \\right) = 0\n$$\nSolving for $E_{33}$ gives the initial guess:\n$$\nE_{33}^{(0)} = \\frac{\\frac{2}{3}G_0 - K_0}{K_0 + \\frac{4}{3}G_0} (E_{11} + E_{22})\n$$\n\nThe iterative algorithm is a damped Newton-Raphson method. Starting with $k=0$ and $E_{33}^{(0)}$:\n1. Compute the residual $r(E_{33}^{(k)})$ and the tangent $r'(E_{33}^{(k)})$.\n2. Check for convergence: if $|r(E_{33}^{(k)})| < 10^{-12}$, the solution is found.\n3. Compute the Newton update: $\\Delta E_{33} = -r(E_{33}^{(k)}) / r'(E_{33}^{(k)})$.\n4. Perform a backtracking line search to find a damping factor $\\alpha \\in (0, 1]$ such that $|r(E_{33}^{(k)} + \\alpha \\Delta E_{33})| < |r(E_{33}^{(k)})|$. Start with $\\alpha=1$ and halve it until the condition is met.\n5. Update the solution: $E_{33}^{(k+1)} = E_{33}^{(k)} + \\alpha \\Delta E_{33}$.\n6. Check for convergence on the increment: if $|\\alpha \\Delta E_{33}| < 10^{-14}$, the solution is found.\n7. Repeat until convergence or until a maximum of $50$ iterations is reached.\nThis procedure is implemented for each test case provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the out-of-plane logarithmic strain E33 to enforce the\n    plane-stress condition tau_33 = 0 for a Hencky plasticity model.\n    \"\"\"\n\n    # Material parameters\n    K0 = 1.60e11  # Bulk modulus (Pascals)\n    G0 = 8.00e10  # Initial shear modulus (Pascals)\n    G_inf_ratio = 0.20\n    G_inf = G_inf_ratio * G0 # Asymptotic shear modulus\n    E_p = 5.0e-2  # Plasticity parameter (dimensionless)\n    n = 2.0       # Softening exponent\n\n    # Newton solver parameters\n    TOL_RESIDUAL = 1e-12  # Tolerance on the residual |tau_33|\n    TOL_UPDATE = 1e-14    # Tolerance on the strain update |dE33|\n    MAX_ITER = 50         # Maximum number of iterations\n\n    # Test suite: (E11, E22, E12)\n    test_cases = [\n        (2.0e-2, -1.0e-2, 3.0e-2),\n        (5.0e-2, 5.0e-2, 0.0),\n        (0.0, 0.0, 0.0),\n        (0.0, 0.0, 2.0e-1),\n        (1.5e-1, -2.0e-2, 1.0e-2),\n    ]\n\n    results = []\n    for e11, e22, e12 in test_cases:\n        e33 = _solve_for_e33(e11, e22, e12, K0, G0, G_inf, E_p, n, \n                             TOL_RESIDUAL, TOL_UPDATE, MAX_ITER)\n        results.append(e33)\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\ndef _solve_for_e33(e11, e22, e12, K0, G0, G_inf, E_p, n, \n                     tol_r, tol_du, max_iter):\n    \"\"\"\n    Helper function to perform the Newton iteration for a single test case.\n    \"\"\"\n    delta_G = G0 - G_inf\n    e11_plus_e22 = e11 + e22\n\n    # Initial guess from linearized elastic solution\n    e33 = ((2./3. * G0 - K0) / (K0 + 4./3. * G0)) * e11_plus_e22\n\n    for _ in range(max_iter):\n        # --- Calculate residual and tangent for current e33 ---\n        # Kinematic quantities\n        tr_E = e11_plus_e22 + e33\n        \n        # Deviatoric strains\n        e11_dev = e11 - tr_E / 3.0\n        e22_dev = e22 - tr_E / 3.0\n        e33_dev = e33 - tr_E / 3.0 # This is (2/3)*e33 - (1/3)*e11_plus_e22\n        \n        e_bar_sq = (2./3.) * (e11_dev**2 + e22_dev**2 + e33_dev**2 + 2 * e12**2)\n        e_bar = np.sqrt(max(0.0, e_bar_sq))\n\n        # Material properties G(e_bar)\n        e_bar_over_Ep_sq = (e_bar / E_p)**2\n        G = G_inf + delta_G / (1.0 + e_bar_over_Ep_sq) # Since n=2\n\n        # Residual r(e33) = tau_33\n        residual = K0 * tr_E + 2 * G * e33_dev\n\n        # Check for convergence on residual\n        if abs(residual) < tol_r:\n            return e33\n        \n        # Tangent r'(e33)\n        # Term for G derivative calculation, stable for e_bar -> 0\n        dG_term = -(8.0 / 3.0) * (delta_G / E_p**2) * (e33_dev**2) / (1.0 + e_bar_over_Ep_sq)**2\n        tangent = K0 + (4.0 / 3.0) * G + dG_term\n        \n        # Newton update\n        de33 = -residual / tangent\n\n        # --- Damped update with backtracking line search ---\n        alpha = 1.0\n        current_res_norm = abs(residual)\n\n        for _ in range(10): # Max 10 backtracking steps\n            e33_trial = e33 + alpha * de33\n            \n            # Recalculate residual at trial point\n            tr_E_trial = e11_plus_e22 + e33_trial\n            e33_dev_trial = e33_trial - tr_E_trial / 3.0\n            e11_dev_trial = e11 - tr_E_trial / 3.0\n            e22_dev_trial = e22 - tr_E_trial / 3.0\n\n            e_bar_sq_trial = (2./3.) * (e11_dev_trial**2 + e22_dev_trial**2 + \n                                       e33_dev_trial**2 + 2 * e12**2)\n            e_bar_trial = np.sqrt(max(0.0, e_bar_sq_trial))\n            \n            G_trial = G_inf + delta_G / (1.0 + (e_bar_trial / E_p)**2)\n            \n            res_trial = K0 * tr_E_trial + 2 * G_trial * e33_dev_trial\n            \n            if abs(res_trial) < current_res_norm:\n                break\n            alpha /= 2.0\n        \n        update = alpha * de33\n        e33 += update\n        \n        # Check for convergence on update\n        if abs(update) < tol_du:\n            return e33\n\n    # If max iterations are reached without convergence, return the last value.\n    # In a real application, an error should be raised.\n    return e33\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2876883"}]}