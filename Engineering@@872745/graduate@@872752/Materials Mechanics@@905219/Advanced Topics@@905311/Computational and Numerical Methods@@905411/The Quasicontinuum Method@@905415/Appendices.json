{"hands_on_practices": [{"introduction": "This first exercise serves as a foundational entry point into the mechanics of the Quasicontinuum (QC) method. By considering a simple one-dimensional harmonic chain, you will directly apply the core tenets of QC: defining representative atoms, interpolating displacements, and using the local Cauchy-Born approximation to compute the total energy and nodal forces [@problem_id:2923438]. This practice is essential for building a concrete understanding of how a coarse-grained description links to the underlying atomistic potential energy.", "problem": "Consider a one-dimensional chain of $9$ atoms indexed by $i=0,1,\\ldots,8$ with reference positions $X_i=i\\,a_0$, where $a_0>0$ is the reference nearest-neighbor spacing. The atomic interactions are restricted to nearest neighbors via a pair potential $\\phi(r)$ that depends only on the current bond length $r$. The chain is coarse-grained by the QuasiContinuum (QC) method using a two-element mesh with representative atoms (also called repatoms) at $i=0,4,8$, thereby defining two elements: element $1$ spanning $[X_0,X_4]$ and element $2$ spanning $[X_4,X_8]$. Assume the local Cauchy–Born approximation in each element with linear interpolation of displacements between repatoms, and use the uniform-weight summation rule that counts all nearest-neighbor bonds in each element.\n\nThe pair potential is harmonic about $a_0$, i.e., $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$, with stiffness $k>0$. Let the repatom displacements be prescribed as $u_0=0$, $u_4=\\bar{u}$, and $u_8=2\\bar{u}$, where $\\bar{u}>0$ is a given constant. With these data, the QC total potential energy is defined as the sum of the element contributions obtained by counting the $4$ bonds in each element, each deformed consistently with the element’s linear displacement field.\n\nStarting from the definitions of the bond-length change induced by a linear displacement field and the Cauchy–Born relation, derive the QC total energy $E_{\\mathrm{QC}}(u)$ as a function of the repatom displacements. Then, compute $E_{\\mathrm{QC}}(u)$ for the specific values $k=100~\\mathrm{N/m}$, $a_0=2.5\\times 10^{-10}~\\mathrm{m}$, and $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$. Finally, obtain the internal nodal forces at the repatoms by differentiation, $\\mathbf{F}=-\\nabla E_{\\mathrm{QC}}(u)$ evaluated at the given displacements, and report the three components $F_0$, $F_4$, and $F_8$.\n\nAnswer specification:\n- Express the energy in $\\mathrm{J}$ and the forces in $\\mathrm{N}$.\n- Round all reported quantities to three significant figures.\n- Provide your final answer as a single row matrix containing first $E_{\\mathrm{QC}}(u)$, followed by $F_0$, $F_4$, and $F_8$, in that order.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extracted Givens.\n- A one-dimensional chain of $9$ atoms, indexed $i=0,1,\\ldots,8$.\n- Reference positions: $X_i=i\\,a_0$, with lattice parameter $a_0>0$.\n- Interaction potential: Nearest-neighbor harmonic pair potential $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$, with stiffness $k>0$.\n- Coarse-graining: QuasiContinuum (QC) method with representative atoms (repatoms) at indices $0$, $4$, and $8$.\n- Mesh: Two elements, element $1$ over $[X_0,X_4]$ and element $2$ over $[X_4,X_8]$.\n- Approximations: Local Cauchy–Born rule with linear interpolation of displacements.\n- Summation rule: Uniform-weight summation, counting $4$ bonds in each element.\n- Prescribed displacements: $u_0=0$, $u_4=\\bar{u}$, $u_8=2\\bar{u}$.\n- Constants: $k=100~\\mathrm{N/m}$, $a_0=2.5\\times 10^{-10}~\\mathrm{m}$, $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$.\n- Required outputs: Total QC energy $E_{\\mathrm{QC}}(u)$ and nodal forces $F_0$, $F_4$, $F_8$, with numerical values rounded to three significant figures.\n\nStep 2: Validation Using Extracted Givens.\nThe problem is scientifically grounded, as it describes a standard application of the QuasiContinuum method, a well-established multiscale technique in computational materials science. The use of a harmonic potential corresponds to the linear elastic limit, and the Cauchy-Born approximation is a fundamental tenet of the method. The problem is well-posed; it provides all necessary data, parameters, and boundary conditions to arrive at a unique, meaningful solution. The definitions are clear, self-contained, and consistent. For instance, the domain of element $1$, $[X_0, X_4]$, contains atoms $0, 1, 2, 3, 4$ and thus the four nearest-neighbor bonds $(0,1), (1,2), (2,3), (3,4)$, which is consistent with the specified count of $4$ bonds. The same holds for element $2$. The numerical values are physically plausible for an atomic system. The problem does not violate any of the invalidity criteria.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be derived.\n\nDerivation of the QC Total Energy $E_{\\mathrm{QC}}(u)$.\nThe total energy is the sum of the energies of the two elements, $E_{\\mathrm{QC}} = E^{(1)} + E^{(2)}$.\n\nFor element $1$, spanning repatoms $0$ and $4$, the reference length is $L_1 = X_4 - X_0 = 4a_0$. The displacement field $u(X)$ for $X \\in [X_0, X_4]$ is assumed to be linear:\n$$u(X) = u_0 \\left(1 - \\frac{X-X_0}{L_1}\\right) + u_4 \\left(\\frac{X-X_0}{L_1}\\right)$$\nThe macroscopic deformation gradient $F$ is constant within the element and is given by $F = 1 + du/dX$.\n$$F^{(1)} = 1 + \\frac{u_4 - u_0}{X_4 - X_0} = 1 + \\frac{u_4 - u_0}{4a_0}$$\nAccording to the local Cauchy–Born approximation, every bond in the element deforms according to this macroscopic gradient. The deformed bond length $r^{(1)}$ is:\n$$r^{(1)} = F^{(1)} a_0 = \\left(1 + \\frac{u_4 - u_0}{4a_0}\\right) a_0 = a_0 + \\frac{u_4 - u_0}{4}$$\nThe energy stored in a single such bond is:\n$$\\phi(r^{(1)}) = \\frac{1}{2}k(r^{(1)} - a_0)^2 = \\frac{1}{2}k\\left(\\frac{u_4 - u_0}{4}\\right)^2$$\nElement $1$ contains $4$ bonds. Using the uniform-weight summation rule, the energy of element $1$ is:\n$$E^{(1)} = 4 \\times \\phi(r^{(1)}) = 4 \\times \\frac{1}{2}k\\frac{(u_4 - u_0)^2}{16} = \\frac{k}{8}(u_4 - u_0)^2$$\nSimilarly, for element $2$, spanning repatoms $4$ and $8$ over a reference length $L_2 = X_8 - X_4 = 4a_0$:\n$$F^{(2)} = 1 + \\frac{u_8 - u_4}{X_8 - X_4} = 1 + \\frac{u_8 - u_4}{4a_0}$$\n$$r^{(2)} = F^{(2)} a_0 = a_0 + \\frac{u_8 - u_4}{4}$$\nThe energy of element $2$, which also contains $4$ bonds, is:\n$$E^{(2)} = 4 \\times \\frac{1}{2}k(r^{(2)} - a_0)^2 = \\frac{k}{8}(u_8 - u_4)^2$$\nThe total QC energy is the sum of the element energies:\n$$E_{\\mathrm{QC}}(u_0, u_4, u_8) = E^{(1)} + E^{(2)} = \\frac{k}{8}(u_4 - u_0)^2 + \\frac{k}{8}(u_8 - u_4)^2$$\n\nNumerical Calculation of Energy.\nSubstituting the prescribed displacements $u_0=0$, $u_4=\\bar{u}$, and $u_8=2\\bar{u}$:\n$$E_{\\mathrm{QC}} = \\frac{k}{8}(\\bar{u} - 0)^2 + \\frac{k}{8}(2\\bar{u} - \\bar{u})^2 = \\frac{k}{8}\\bar{u}^2 + \\frac{k}{8}\\bar{u}^2 = \\frac{k}{4}\\bar{u}^2$$\nUsing the given values $k=100~\\mathrm{N/m}$ and $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$:\n$$E_{\\mathrm{QC}} = \\frac{100~\\mathrm{N/m}}{4} (4.0\\times 10^{-11}~\\mathrm{m})^2 = (25~\\mathrm{N/m}) \\times (16.0 \\times 10^{-22}~\\mathrm{m}^2) = 400 \\times 10^{-22}~\\mathrm{J} = 4.0 \\times 10^{-20}~\\mathrm{J}$$\nRounded to three significant figures, the energy is $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$.\n\nDerivation and Calculation of Nodal Forces.\nThe internal forces on the repatoms are given by the negative gradient of the total potential energy, $\\mathbf{F} = -\\nabla E_{\\mathrm{QC}}(u)$. The components are $F_i = -\\partial E_{\\mathrm{QC}} / \\partial u_i$.\n$$F_0 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_0} = -\\frac{k}{8} \\cdot 2(u_4-u_0)(-1) = \\frac{k}{4}(u_4 - u_0)$$\n$$F_8 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_8} = -\\frac{k}{8} \\cdot 2(u_8-u_4)(1) = -\\frac{k}{4}(u_8 - u_4)$$\n$$F_4 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_4} = -\\left[ \\frac{k}{8} \\cdot 2(u_4-u_0)(1) + \\frac{k}{8} \\cdot 2(u_8-u_4)(-1) \\right] = -\\frac{k}{4}\\left[ (u_4-u_0) - (u_8-u_4) \\right] = -\\frac{k}{4}(2u_4 - u_0 - u_8)$$\nSubstituting the prescribed displacements ($u_0=0, u_4=\\bar{u}, u_8=2\\bar{u}$) and numerical values:\n$$F_0 = \\frac{k}{4}(\\bar{u} - 0) = \\frac{k}{4}\\bar{u} = \\frac{100}{4}(4.0\\times 10^{-11}) = 25 \\times 4.0\\times 10^{-11} = 100 \\times 10^{-11}~\\mathrm{N} = 1.0 \\times 10^{-9}~\\mathrm{N}$$\nTo three significant figures, $F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$.\n\n$$F_8 = -\\frac{k}{4}(2\\bar{u} - \\bar{u}) = -\\frac{k}{4}\\bar{u} = -1.0 \\times 10^{-9}~\\mathrm{N}$$\nTo three significant figures, $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$.\n\n$$F_4 = -\\frac{k}{4}(2\\bar{u} - 0 - 2\\bar{u}) = -\\frac{k}{4}(0) = 0~\\mathrm{N}$$\nThe force $F_4$ is exactly zero because the strain is uniform across the two elements. Uniform strain implies the force exerted by element $1$ on repatom $4$ is equal and opposite to the force exerted by element $2$ on repatom $4$. The value is exactly $0$.\n\nThe final results are $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$, $F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$, $F_4 = 0~\\mathrm{N}$, and $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$.", "answer": "$$\\boxed{\\begin{pmatrix} 4.00 \\times 10^{-20} & 1.00 \\times 10^{-9} & 0 & -1.00 \\times 10^{-9} \\end{pmatrix}}$$", "id": "2923438"}, {"introduction": "While the Cauchy-Born rule is a cornerstone of the QC method, it is crucial to understand its limitations. This exercise challenges you to find its breaking point by exploring a regime where the atomistic system prefers a non-homogeneous deformation over the uniform one assumed by the local theory [@problem_id:2923419]. By quantifying the error in the predicted stress for a material undergoing large strain, you will gain critical insight into why multiscale models must incorporate fully atomistic regions to accurately capture phenomena governed by lattice instabilities.", "problem": "You will construct and quantify a rigorous counterexample to the Cauchy–Born rule in the setting of the quasicontinuum method, by comparing the stress predicted by a homogeneous deformation to that obtained from a minimal atomistic microstructure under the same macroscopic strain. Consider a one-dimensional infinite chain of identical atoms with nearest-neighbor interactions governed by the Lennard–Jones potential\n$$\n\\phi(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\nwhere $r$ is the bond length, $\\varepsilon$ is the energy scale, and $\\sigma$ is the length scale. The reference lattice spacing $a_0$ is the minimizer of $\\phi$, i.e., $a_0 = \\operatorname{argmin}_r \\phi(r)$, which occurs at $a_0 = 2^{1/6}\\sigma$. You will impose a macroscopic stretch $F$ so that the average bond length equals $F a_0$. The Cauchy–Born rule (CB) assumes a homogeneous deformation, whereas an atomistic calculation may realize a non-homogeneous period-doubled microstructure with two alternating bond lengths $l_1$ and $l_2$ satisfying the average constraint $l_1 + l_2 = 2 F a_0$. \n\nStarting only from Newton’s laws, energy minimization principles, and the definition of the First Piola–Kirchhoff (PK1) stress as the derivative of energy with respect to deformation, you must derive:\n- The PK1 stress predicted by the Cauchy–Born rule under the homogeneous deformation assumption.\n- The PK1 stress from an atomistic two-atom periodic cell that minimizes the total potential energy under the average constraint $l_1 + l_2 = 2 F a_0$ (which can lead to $l_1 \\neq l_2$ in nonconvex regions of $\\phi$).\n- The absolute error between these two stress predictions, given by $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$.\n\nAssume reduced units with $\\varepsilon = 1$ and $\\sigma = 1$ so that stresses are expressed in units of $\\varepsilon/\\sigma$. Your program must:\n- Compute $a_0 = 2^{1/6}\\sigma$ using $\\sigma = 1$.\n- For each prescribed macroscopic stretch $F$, compute the Cauchy–Born PK1 stress and the atomistic PK1 stress as described above.\n- Output the absolute error in PK1 stress $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$ for each test case.\n\nTest suite:\n- Use the following macroscopic stretches $F$: $[1.00, 1.10, 1.12, 1.20, 1.30]$.\n- These values are chosen to probe: a stable homogeneous regime (near $F=1.00$), a regime just below the onset of nonconvexity ($F=1.10$), a regime just above the onset of nonconvexity ($F=1.12$), and deeper into the nonconvex regime ($F=1.20$ and $F=1.30$), where the Cauchy–Born rule may fail.\n\nRequired output:\n- Express the absolute errors in units of $\\varepsilon/\\sigma$.\n- Round each result to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[0.000000,0.123456,0.000001,0.500000,0.750000]$). There should be no extra whitespace or text.\n\nNotes:\n- Angles are not involved in this problem.\n- All computations are to be performed in reduced units with $\\varepsilon = 1$ and $\\sigma = 1$.\n- No input should be read; the specified test suite must be hard-coded and executed automatically when the program runs.", "solution": "The problem requires the construction and analysis of a counterexample to the Cauchy–Born rule for a one-dimensional atomic chain. The validation of the problem statement has been performed. The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a rigorous solution. We may proceed.\n\nThe analysis is conducted in reduced units where $\\varepsilon = 1$ and $\\sigma = 1$.\n\n**1. Interatomic Potential and Reference State**\n\nThe interaction between nearest-neighbor atoms is described by the Lennard-Jones potential:\n$$\n\\phi(r) = 4\\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] = 4 \\left( r^{-12} - r^{-6} \\right)\n$$\nwhere $r$ is the interatomic distance.\n\nThe reference lattice spacing, $a_0$, is the bond length that minimizes the potential energy $\\phi(r)$. This is found by setting the first derivative of the potential to zero:\n$$\n\\frac{d\\phi}{dr} = \\phi'(r) = 4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\nThis yields $6r^{-7} = 12r^{-13}$, which simplifies to $r^6 = 2$. Thus, the reference lattice spacing is:\n$$\na_0 = 2^{1/6}\\sigma = 2^{1/6}\n$$\nAt this spacing, the force between atoms is zero, as $\\phi'(a_0)=0$.\n\n**2. Definition of First Piola-Kirchhoff (PK1) Stress**\n\nThe PK1 stress, $P$, in one dimension is defined as the derivative of the energy density with respect to the macroscopic deformation gradient, $F$. The energy density, $\\mathcal{E}$, is the energy per unit reference length. For a system of bonds, this is the energy per bond divided by the reference length per bond, $a_0$.\n$$\nP = \\frac{\\partial \\mathcal{E}}{\\partial F} = \\frac{1}{a_0} \\frac{\\partial E_{\\text{bond}}}{\\partial F}\n$$\n\n**3. Cauchy–Born (CB) Stress Prediction**\n\nThe Cauchy–Born rule assumes that the macroscopic deformation $F$ applies uniformly at the atomic scale. This implies a homogeneous deformation where every bond has the same length, $r_{\\mathrm{CB}}$:\n$$\nr_{\\mathrm{CB}} = F a_0\n$$\nThe energy per bond is simply the potential evaluated at this length, $E_{\\mathrm{CB}}(F) = \\phi(r_{\\mathrm{CB}}) = \\phi(F a_0)$.\n\nThe PK1 stress under the CB assumption, $P_{\\mathrm{CB}}$, is then:\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\frac{d}{dF} \\left[ \\phi(F a_0) \\right]\n$$\nApplying the chain rule, $\\frac{d}{dF} = \\frac{dr_{\\mathrm{CB}}}{dF} \\frac{d}{dr_{\\mathrm{CB}}} = a_0 \\frac{d}{dr_{\\mathrm{CB}}}$, we find:\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\left( a_0 \\cdot \\phi'(F a_0) \\right) = \\phi'(F a_0)\n$$\nSubstituting the expression for $\\phi'(r)$:\n$$\nP_{\\mathrm{CB}}(F) = 24(F a_0)^{-7} - 48(F a_0)^{-13}\n$$\n\n**4. Atomistic Stress Prediction**\n\nThe atomistic model considers a minimal microstructure: a period-doubled unit cell with two alternating bond lengths, $l_1$ and $l_2$. The macroscopic stretch $F$ is imposed as a constraint on the average bond length:\n$$\n\\frac{l_1 + l_2}{2} = F a_0 \\implies l_1 + l_2 = 2F a_0\n$$\nThe energy of this two-bond cell is $E_{\\mathrm{cell}} = \\phi(l_1) + \\phi(l_2)$. The actual bond lengths are those that minimize $E_{\\mathrm{cell}}$ subject to the constraint. We can express the energy as a function of $l_1$ alone:\n$$\nE_{\\mathrm{cell}}(l_1) = \\phi(l_1) + \\phi(2F a_0 - l_1)\n$$\nThe condition for a stationary point is $\\frac{dE_{\\mathrm{cell}}}{dl_1} = 0$:\n$$\n\\frac{dE_{\\mathrm{cell}}}{dl_1} = \\phi'(l_1) - \\phi'(2F a_0 - l_1) = 0 \\implies \\phi'(l_1) = \\phi'(l_2)\n$$\nThis equilibrium condition means the internal forces in the two bonds must be equal.\n\nThe stability of the homogeneous solution, where $l_1 = l_2 = F a_0$, depends on the second derivative of the cell energy, which corresponds to the convexity of the potential $\\phi(r)$.\n$$\n\\frac{d^2 E_{\\mathrm{cell}}}{dl_1^2} \\bigg|_{l_1 = F a_0} = \\phi''(F a_0) + \\phi''(F a_0) = 2\\phi''(F a_0)\n$$\nThe homogeneous solution is stable only if $2\\phi''(F a_0) > 0$. The potential becomes non-convex where $\\phi''(r)  0$. Let us find the inflection point $r_c$ where $\\phi''(r_c) = 0$.\n$$\n\\phi''(r) = 4 \\left( 156 r^{-14} - 42 r^{-8} \\right) = 0\n$$\nThis gives $r_c^6 = \\frac{156}{42} = \\frac{26}{7}$. So, $r_c = (26/7)^{1/6}$. The homogeneous deformation is unstable if the bond length $F a_0$ exceeds $r_c$. This defines a critical stretch $F_c$:\n$$\nF_c = \\frac{r_c}{a_0} = \\frac{(26/7)^{1/6}}{(2)^{1/6}} = \\left(\\frac{13}{7}\\right)^{1/6} \\approx 1.1086\n$$\nFor $F \\le F_c$, the stable solution is homogeneous, $l_1 = l_2 = F a_0$.\nFor $F > F_c$, the homogeneous solution is unstable, and the system bifurcates to a non-homogeneous state with $l_1 \\neq l_2$.\n\nThe atomistic stress $P_{\\mathrm{atom}}$ is derived from the energy of the two-bond cell. The energy density is $\\mathcal{E}_{\\mathrm{atom}} = \\frac{E_{\\mathrm{cell}}}{2a_0} = \\frac{\\phi(l_1(F)) + \\phi(l_2(F))}{2a_0}$.\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\partial \\mathcal{E}_{\\mathrm{atom}}}{\\partial F} = \\frac{1}{2a_0} \\left( \\phi'(l_1) \\frac{dl_1}{dF} + \\phi'(l_2) \\frac{dl_2}{dF} \\right)\n$$\nUsing the equilibrium condition $\\phi'(l_1) = \\phi'(l_2) \\equiv \\phi'_{\\min}$ and the derivative of the constraint, $\\frac{dl_1}{dF} + \\frac{dl_2}{dF} = 2a_0$, we obtain:\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\phi'_{\\min}}{2a_0} \\left( \\frac{dl_1}{dF} + \\frac{dl_2}{dF} \\right) = \\frac{\\phi'_{\\min}}{2a_0} (2a_0) = \\phi'_{\\min}\n$$\nThus, $P_{\\mathrm{atom}}(F) = \\phi'(l_1)$, where $l_1$ is the energy-minimizing bond length.\n\n**5. Computational Algorithm**\n\nFor each given macroscopic stretch $F$:\n1.  Calculate $a_0 = 2^{1/6}$ and $F_c = (13/7)^{1/6}$.\n2.  Calculate the Cauchy-Born stress: $P_{\\mathrm{CB}} = \\phi'(F a_0)$.\n3.  Compare $F$ with $F_c$:\n    *   If $F \\le F_c$, the system remains homogeneous. The atomistic model gives $l_1 = l_2 = F a_0$, and thus $P_{\\mathrm{atom}} = \\phi'(F a_0) = P_{\\mathrm{CB}}$. The error is $0$.\n    *   If $F > F_c$, the system bifurcates. We must find the non-homogeneous solution by numerically solving the system of equations for $l_1, l_2$:\n        $$\n        \\begin{cases}\n        \\phi'(l_1) = \\phi'(l_2) \\\\\n        l_1 + l_2 = 2F a_0\n        \\end{cases}\n        $$\n        This is equivalent to finding a root $l_1^*$ of the function $f(x) = \\phi'(x) - \\phi'(2F a_0 - x)$ for $x \\neq F a_0$. Based on analysis of $\\phi'(r)$, the physically meaningful solution for the shorter bond length $l_1^*$ lies in the interval $(a_0, r_c)$. A numerical root-finding algorithm is used on this interval.\n4.  Once $l_1^*$ is found, the atomistic stress is $P_{\\mathrm{atom}} = \\phi'(l_1^*)$.\n5.  The absolute error is $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$. This difference quantifies the failure of the Cauchy-Born rule.\n\nThis procedure provides a rigorous method to compute the required stress error.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the Cauchy-Born and atomistic PK1 stress\n    for a 1D atomic chain with Lennard-Jones interactions.\n    \"\"\"\n\n    # Reduced units are used, with epsilon = 1 and sigma = 1.\n    SIGMA = 1.0\n    EPSILON = 1.0\n\n    # Test cases for macroscopic stretch F\n    test_cases = [1.00, 1.10, 1.12, 1.20, 1.30]\n\n    # Pre-calculated constants based on the problem statement\n    # Reference lattice spacing a0 minimizes the potential, a0 = 2^(1/6) * sigma\n    a0 = np.power(2.0, 1.0/6.0) * SIGMA\n    \n    # Critical bond length rc is the inflection point of the potential, rc^6 = 26/7\n    rc = np.power(26.0/7.0, 1.0/6.0) * SIGMA\n    \n    # Critical stretch Fc corresponds to the onset of instability, Fc = rc / a0\n    Fc = rc / a0\n\n    def phi_prime(r):\n        \"\"\"\n        First derivative of the Lennard-Jones potential (proportional to force).\n        phi'(r) = 4 * epsilon * (-12 * sigma^12 / r^13 + 6 * sigma^6 / r^7)\n        In reduced units, this simplifies to:\n        phi'(r) = 24 / r^7 - 48 / r^13\n        \"\"\"\n        r_inv = SIGMA / r\n        r_inv6 = np.power(r_inv, 6)\n        r_inv12 = r_inv6 * r_inv6\n        \n        # The true phi'(r) is below. The simplified form 24r^-7 - 48r^-13 works fine.\n        return 4.0 * EPSILON * (-12.0 * r_inv12 / r + 6.0 * r_inv6 / r)\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate the bond length under homogeneous (Cauchy-Born) deformation\n        r_cb = F * a0\n        \n        # Calculate the Cauchy-Born PK1 stress\n        # P_CB = phi'(r_cb)\n        P_cb = phi_prime(r_cb)\n        \n        P_atom = 0.0\n        \n        # Check for stability. The CB rule holds if F = Fc.\n        if F = Fc:\n            # In the stable regime, the atomistic solution is homogeneous.\n            P_atom = P_cb\n        else:\n            # In the unstable regime (F  Fc), the system bifurcates.\n            # We need to find the non-homogeneous solution {l1, l2} that minimizes energy.\n            # This requires solving phi'(l1) = phi'(l2) with l1 + l2 = 2 * F * a0.\n            \n            # Define the function whose root we need to find.\n            def root_func(l1):\n                l2 = 2 * r_cb - l1\n                return phi_prime(l1) - phi_prime(l2)\n            \n            # The smaller bond length l1 must be in the interval (a0, rc).\n            # This bracket is guaranteed to contain the root for F  Fc.\n            bracket = [a0, rc]\n\n            # Use SciPy's root finder to find the energy-minimizing l1.\n            # Trivial solution is l1 = r_cb, we search for the other one.\n            sol = root_scalar(root_func, bracket=bracket, method='brentq')\n            \n            if sol.converged:\n                l1_sol = sol.root\n                # The atomistic stress is phi'(l1_sol)\n                P_atom = phi_prime(l1_sol)\n            else:\n                # Should not happen with the correct bracket and problem setup.\n                # In case of failure, treat as error.\n                P_atom = np.nan\n\n        # Calculate the absolute error between atomistic and CB stress predictions.\n        error = np.abs(P_atom - P_cb)\n        results.append(error)\n\n    # Format the output as a comma-separated list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2923419"}, {"introduction": "Building on the understanding that local continuum approximations can fail, this practice guides you through the implementation of a powerful solution: adaptive refinement. You will design an intelligent algorithm that automatically identifies regions of high error—where the continuum hypothesis is invalid—and dynamically enriches the model with atomistic detail [@problem_id:2923446]. This exercise demonstrates how to create a computationally efficient and accurate model that focuses its resources on the critical areas, such as the vicinity of a defect, embodying the true spirit of multiscale modeling.", "problem": "You must design and implement, from first principles, an adaptive quasicontinuum algorithm that expands the atomistic region based on a defect activity indicator and demonstrate its effectiveness on a one-dimensional harmonic chain with a single defective bond. Your program must be a complete, runnable implementation that takes no input and produces a single line of output as specified below.\n\nThe physical system is a one-dimensional chain of $N$ atoms at reference positions $x_i = i a$, where $i \\in \\{0,1,\\dots,N-1\\}$ and the lattice spacing $a$ is taken as $a=1$ (dimensionless). The chain is connected by nearest-neighbor harmonic springs. The energy of a bond between atoms $i$ and $i+1$ is given by $\\frac{1}{2} k_i \\left( u_{i+1} - u_i \\right)^2$, where $u_i$ is the displacement of atom $i$ and $k_i$ is the bond stiffness. All bonds have stiffness $k$ except for a single defective bond at index $d$, which has stiffness $\\alpha k$ with $0 lt; \\alpha \\le 1$. A Dirichlet boundary condition is applied: the left boundary displacement is $u_0 = 0$ and the right boundary displacement is $u_{N-1} = U$, with $U$ prescribed (dimensionless). The full atomistic equilibrium is defined as the minimizer of the total energy $\\mathcal{E}(u) = \\frac{1}{2}\\sum_{i=0}^{N-2} k_i \\left( u_{i+1} - u_i \\right)^2$ subject to these boundary conditions.\n\nIn the quasicontinuum (QC) approximation, you must represent displacements using a reduced set of degrees of freedom (DOF). Define an initial atomistic core as a contiguous set of atoms around the defective bond, parameterized by an initial radius $r_0$ such that the initial atomistic set includes atoms $j$ with $j \\in [\\max(1, d-r_0), \\min(N-2, d+1+r_0)]$. Outside the atomistic set, define a coarse representation using representative atoms (repatoms) spaced by an integer stride $m \\ge 1$ measured in atomic indices. All atoms not included in the active DOF set (which consists of atomistic atoms and repatoms, excluding the fixed boundary atoms) must have their displacements given by linear interpolation between their nearest neighbors in the support set consisting of active DOFs and boundary atoms. This induces an affine mapping from the reduced DOF vector to the full displacement vector, which, when substituted into the total energy, yields a reduced quadratic energy to be minimized to obtain the QC equilibrium.\n\nDefine the defect activity indicator using the full atomistic internal force residual at constrained atoms (i.e., atoms that are not active DOFs and are not boundary atoms). Let the global stiffness matrix associated with the atomistic chain be $K \\in \\mathbb{R}^{N \\times N}$, assembled from the bond stiffnesses $k_i$ in the standard way via the discrete gradient operator. Given a QC displacement vector $u^{\\mathrm{QC}} \\in \\mathbb{R}^N$ consistent with the boundary conditions, define the internal force residual at atom $j$ by $f_j = - \\left( K u^{\\mathrm{QC}} \\right)_j$. For a coarse segment, a larger magnitude $|f_j|$ indicates stronger nonlocal disequilibrium and therefore a stronger need for refinement. Your adaptive algorithm must iteratively:\n- compute $u^{\\mathrm{QC}}$ by minimizing the reduced QC energy (with boundary conditions $u_0 = 0$ and $u_{N-1} = U$),\n- compute the residual vector $f$,\n- identify the constrained atom $j^\\star$ with maximal indicator value $\\max_{j \\in \\mathcal{C}} |f_j|$, where $\\mathcal{C}$ is the set of constrained atoms,\n- if $\\max_{j \\in \\mathcal{C}} |f_j| \\le \\tau$ (the tolerance), terminate; otherwise, grow the atomistic region by including $j^\\star$ into the atomistic set, and repeat.\n\nThe fundamental bases you must use are: energy minimization in conservative systems, the definition of internal forces as negative gradients of the energy with respect to displacements, and linear interpolation constraints in the reduced QC approximation. You must not assume or use any specialized quasicontinuum formulas beyond these bases; all steps must be derived from these principles.\n\nYour program must:\n- Assemble the full atomistic stiffness matrix $K$ from the bond stiffnesses $k_i$.\n- Compute the full atomistic reference solution $u^{\\mathrm{ref}}$ by minimizing the total energy with boundary constraints (equivalently solving the associated linear system).\n- Implement the QC mapping by constructing a linear operator $T \\in \\mathbb{R}^{N \\times n_{\\mathrm{act}}}$ and an offset vector $c \\in \\mathbb{R}^N$ such that $u = T q + c$, where $q \\in \\mathbb{R}^{n_{\\mathrm{act}}}$ are the active DOFs (excluding fixed boundary DOFs). The interpolation must be strictly linear between neighboring support indices for constrained atoms.\n- Formulate and solve the reduced linear system for $q$ obtained by substituting $u = T q + c$ into the total energy, namely, solve $T^\\top K T \\, q = - T^\\top K c$.\n- Implement the adaptive growth strategy described above until the stopping criterion is met or until the atomistic region covers all interior atoms.\n- Quantify the effectiveness of the adaptive algorithm by computing the relative displacement error $e = \\| u^{\\mathrm{QC}} - u^{\\mathrm{ref}} \\|_2 / \\| u^{\\mathrm{ref}} \\|_2$ at termination.\n\nUse the following test suite of parameter sets, each specified as a tuple $(N, d, \\alpha, k, U, r_0, m, \\tau)$:\n- Case A (happy path): $(101, 50, 0.2, 1.0, 0.1, 1, 10, 10^{-3})$.\n- Case B (loose tolerance edge case): $(101, 50, 0.2, 1.0, 0.1, 1, 10, 10^{2})$.\n- Case C (tight tolerance boundary case): $(101, 50, 0.2, 1.0, 0.1, 1, 10, 10^{-12})$.\n\nFor each case, run the adaptive QC algorithm described above and compute the relative error $e$ at termination. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order [Case A result, Case B result, Case C result]. Each result must be a floating-point number formatted in scientific notation with exactly six significant digits.\n\nThere are no physical units in this problem; all quantities are dimensionless. Angles do not appear. The final outputs are plain floating-point numbers, not percentages. The entire implementation and calculation must be self-contained and require no input files or user interaction.", "solution": "The problem proposed is a well-posed and scientifically sound exercise in computational mechanics, specifically in the implementation of an adaptive quasicontinuum (QC) method. It is based on established first principles of energy minimization in a conservative system and the Galerkin projection of governing equations onto a reduced basis. All definitions and parameters are provided unambiguously, permitting a direct and verifiable computational solution. The problem is therefore deemed valid.\n\nThe solution is developed in three stages: first, the formulation of the full atomistic problem, providing a reference solution; second, the formulation of the quasicontinuum approximation with its reduced system of equations; and third, the specification of the adaptive algorithm that iteratively refines the QC model.\n\n### 1. Full Atomistic Formulation\n\nThe physical system is a one-dimensional chain of $N$ atoms. The total potential energy $\\mathcal{E}$ is the sum of energies stored in nearest-neighbor harmonic bonds:\n$$\n\\mathcal{E}(u) = \\frac{1}{2}\\sum_{i=0}^{N-2} k_i (u_{i+1} - u_i)^2\n$$\nwhere $u_i$ is the displacement of atom $i$ and $k_i$ is the stiffness of the bond between atoms $i$ and $i+1$. This expression is a quadratic form in the displacement vector $u \\in \\mathbb{R}^N$. We can write this energy using the discrete gradient operator $B \\in \\mathbb{R}^{(N-1) \\times N}$, which maps a vector of nodal displacements to a vector of bond elongations. The energy is then:\n$$\n\\mathcal{E}(u) = \\frac{1}{2} (Bu)^\\top K_b (Bu) = \\frac{1}{2} u^\\top (B^\\top K_b B) u\n$$\nwhere $K_b = \\mathrm{diag}(k_0, k_1, \\dots, k_{N-2})$ is the diagonal matrix of bond stiffnesses. This identifies the global atomistic stiffness matrix as $K = B^\\top K_b B \\in \\mathbb{R}^{N \\times N}$. The entries of this tridiagonal matrix are given by:\n$$\nK_{j,j} = k_{j-1} + k_j \\quad (\\text{for } 1 \\le j \\le N-2)\n$$\n$$\nK_{j, j+1} = K_{j+1, j} = -k_j \\quad (\\text{for } 0 \\le j \\le N-2)\n$$\nwith special forms for boundary atoms $j=0$ and $j=N-1$.\n\nEquilibrium is found by minimizing $\\mathcal{E}(u)$ subject to the Dirichlet boundary conditions $u_0=0$ and $u_{N-1}=U$. This is equivalent to solving the linear system of equations $\\nabla_u \\mathcal{E} = 0$ for the unknown interior displacements $u_j$ where $j \\in \\{1, \\dots, N-2\\}$. Partitioning the degrees of freedom into interior $u_I = [u_1, \\dots, u_{N-2}]^\\top$ and boundary $u_B = [u_0, u_{N-1}]^\\top = [0, U]^\\top$, the equilibrium equations for the interior nodes are:\n$$\nK_{II} u_I = - K_{IB} u_B\n$$\nwhere $K_{II}$ is the submatrix of $K$ corresponding to interior-interior interactions, and $K_{IB}$ corresponds to interior-boundary interactions. Solving this $(N-2) \\times (N-2)$ linear system yields the reference displacement vector $u^{\\mathrm{ref}} = [0, u_I^\\top, U]^\\top$. The matrix $K_{II}$ is positive definite, guaranteeing a unique solution.\n\n### 2. Quasicontinuum (QC) Formulation\n\nThe QC method reduces the computational cost by describing the system with a smaller number of active degrees of freedom (DOFs), $q \\in \\mathbb{R}^{n_{\\mathrm{act}}}$. These DOFs correspond to the displacements of a selected subset of atoms, $\\mathcal{I}_{\\mathrm{act}} \\subset \\{1, \\dots, N-2\\}$, called active atoms. The remaining interior atoms are designated as constrained atoms.\n\nThe displacements of all atoms are determined by the active DOFs $q$ and the prescribed boundary conditions. The displacement of any constrained atom is obtained via piecewise linear interpolation between its nearest neighbors in the support set $\\mathcal{I}_{\\mathrm{supp}} = \\mathcal{I}_{\\mathrm{act}} \\cup \\{0, N-1\\}$. This defines a linear kinematic constraint, which can be expressed in matrix form as:\n$$\nu = Tq + c\n$$\nwhere $T \\in \\mathbb{R}^{N \\times n_{\\mathrm{act}}}$ is the interpolation matrix and $c \\in \\mathbb{R}^N$ is a vector that imposes the boundary conditions. For an active atom $j_k \\in \\mathcal{I}_{\\mathrm{act}}$ corresponding to the $k$-th DOF in $q$, the mapping is trivial: $u_{j_k} = q_k$. For a constrained atom $j$, its displacement is $u_j = (1-\\lambda)u_{j_L} + \\lambda u_{j_R}$, where $j_L$ and $j_R$ are the indices of the nearest support atoms bracketing $j$, and $\\lambda = (j - j_L) / (j_R - j_L)$ since lattice spacing $a=1$. The matrix $T$ and vector $c$ are constructed to encode these relationships for all atoms.\n\nSubstituting the ansatz $u=Tq+c$ into the full atomistic energy functional gives the reduced energy $\\mathcal{E}_{\\mathrm{QC}}(q)$:\n$$\n\\mathcal{E}_{\\mathrm{QC}}(q) = \\frac{1}{2} (Tq+c)^\\top K (Tq+c)\n$$\nMinimizing this quadratic energy with respect to $q$ by setting $\\nabla_q \\mathcal{E}_{\\mathrm{QC}}(q) = 0$ yields the reduced system of linear equations for the QC approximation:\n$$\n(T^\\top K T) q = - (T^\\top K c)\n$$\nSolving this system provides the vector of active displacements $q$, from which the full displacement field is reconstructed as $u^{\\mathrm{QC}} = Tq + c$.\n\n### 3. Adaptive Refinement Algorithm\n\nThe accuracy of the QC approximation depends on the choice of active atoms. An adaptive strategy is employed to enrich the active set in regions where the approximation is poor. The quality of the approximation is assessed using the full atomistic force residuals at the constrained nodes.\n\nThe internal force on atom $j$ is $f_j = -\\frac{\\partial \\mathcal{E}}{\\partial u_j} = -(Ku)_j$. For a system in perfect equilibrium, all internal forces are zero (in the absence of external point forces). In the QC approximation, the force balance is only enforced in a weighted-residual sense over the active DOFs. Consequently, non-zero force residuals $f_j = -(K u^{\\mathrm{QC}})_j$ may exist at constrained atoms $j \\in \\mathcal{C}$. The magnitude $|f_j|$ serves as an error indicator. A large residual indicates that the linear interpolation constraint is inadequate at that location.\n\nThe adaptive algorithm proceeds as follows:\n1.  Initialize the model with a set of active atoms $\\mathcal{I}_{\\mathrm{act}}$, comprising an atomistic region around the defect and a coarse set of repatoms.\n2.  In an iterative loop:\n    a. Construct the interpolation matrix $T$ and boundary condition vector $c$ for the current active set.\n    b. Assemble and solve the reduced system $(T^\\top K T) q = - (T^\\top K c)$ for $q$.\n    c. Reconstruct the full displacement field $u^{\\mathrm{QC}} = Tq + c$.\n    d. Calculate the force residual vector $f = -K u^{\\mathrm{QC}}$.\n    e. Identify the constrained atom $j^\\star$ with the maximum residual magnitude: $\\max_{j \\in \\mathcal{C}} |f_j|$.\n    f. If this maximum residual is less than or equal to a prescribed tolerance $\\tau$, or if there are no more constrained atoms, the simulation terminates.\n    g. Otherwise, the atom $j^\\star$ is added to the atomistic set (and thus to $\\mathcal{I}_{\\mathrm{act}}$), and the loop repeats from step (a).\n\nUpon termination, the quality of the final adaptive solution $u^{\\mathrm{QC}}$ is quantified by computing its relative error with respect to the exact atomistic solution $u^{\\mathrm{ref}}$:\n$$\ne = \\frac{\\| u^{\\mathrm{QC}} - u^{\\mathrm{ref}} \\|_2}{\\| u^{\\mathrm{ref}} \\|_2}\n$$\nThis protocol provides a systematic means to achieve a desired level of accuracy by concentrating computational effort only where necessary.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve\n\ndef solve_problem():\n    \"\"\"\n    Main function to run the adaptive quasicontinuum simulation for the given test cases.\n    \"\"\"\n    \n    test_cases = [\n        # (N, d, alpha, k, U, r0, m, tau)\n        (101, 50, 0.2, 1.0, 0.1, 1, 10, 1e-3),   # Case A\n        (101, 50, 0.2, 1.0, 0.1, 1, 10, 1e2),    # Case B\n        (101, 50, 0.2, 1.0, 0.1, 1, 10, 1e-12),  # Case C\n    ]\n\n    results = []\n    for params in test_cases:\n        N, d, alpha, k, U, r0, m, tau = params\n        \n        # 1. Assemble bond stiffnesses and full atomistic stiffness matrix K\n        k_vals = np.full(N - 1, k)\n        k_vals[d] = alpha * k\n\n        K = np.zeros((N, N))\n        for i in range(N - 1):\n            ki = k_vals[i]\n            K[i, i] += ki\n            K[i + 1, i + 1] += ki\n            K[i, i + 1] -= ki\n            K[i + 1, i] -= ki\n\n        # 2. Compute the full atomistic reference solution u_ref\n        K_int = K[1:N-1, 1:N-1]\n        b_int = np.zeros(N - 2)\n        b_int[-1] = k_vals[N - 2] * U\n        u_int = solve(K_int, b_int, assume_a='sym')\n        u_ref = np.zeros(N)\n        u_ref[1:N-1] = u_int\n        u_ref[N-1] = U\n        \n        norm_u_ref = np.linalg.norm(u_ref)\n\n        # 3. Adaptive QC loop\n        atom_indices = set(range(max(1, d - r0), min(N - 2, d + 1 + r0) + 1))\n        \n        u_qc = np.zeros(N) # Initialize u_qc\n\n        while True:\n            # Define active and constrained sets for the current iteration\n            rep_indices = set(range(m, N - 1, m))\n            active_indices = sorted(list(atom_indices.union(rep_indices)))\n            \n            all_interior_indices = set(range(1, N - 1))\n            constrained_indices = sorted(list(all_interior_indices - set(active_indices)))\n            \n            # Check for loop termination based on full refinement\n            if not constrained_indices:\n                # All interior nodes are active, QC solution is the full solution\n                u_qc = np.copy(u_ref)\n                break\n\n            n_act = len(active_indices)\n            act_map = {idx: i for i, idx in enumerate(active_indices)}\n            \n            support_indices = np.array([0] + active_indices + [N - 1])\n\n            # Construct T and c matrices\n            T = np.zeros((N, n_act))\n            c = np.zeros(N)\n            c[N-1] = U\n\n            for j in range(1, N - 1):\n                if j in act_map:\n                    T[j, act_map[j]] = 1.0\n                else: # j is constrained\n                    # Find bracketing support nodes using searchsorted\n                    # This is efficient for sorted support_indices\n                    idx_right = np.searchsorted(support_indices, j)\n                    jR = support_indices[idx_right]\n                    jL = support_indices[idx_right - 1]\n                    \n                    lam = (j - jL) / (jR - jL)\n\n                    if jL in act_map:\n                        T[j, act_map[jL]] = 1.0 - lam\n                    # if jL is 0, u0=0, so no contribution to T or c\n                    \n                    if jR in act_map:\n                        T[j, act_map[jR]] = lam\n                    elif jR == N - 1:\n                        c[j] = lam * U\n\n            # Solve reduced QC system\n            K_qc = T.T @ K @ T\n            f_qc = -T.T @ K @ c\n            q = solve(K_qc, f_qc, assume_a='sym')\n            \n            # Reconstruct full QC displacement vector\n            u_qc = T @ q + c\n            \n            # Compute force residuals and check termination criterion\n            residuals = -(K @ u_qc)\n            \n            constrained_residuals = np.abs(residuals[constrained_indices])\n            max_residual = np.max(constrained_residuals)\n\n            if max_residual = tau:\n                break\n\n            # Find atom with max residual and add to atomistic set for refinement\n            j_star_local_idx = np.argmax(constrained_residuals)\n            j_star = constrained_indices[j_star_local_idx]\n            atom_indices.add(j_star)\n        \n        # 4. Calculate final relative error\n        if norm_u_ref > 0:\n            error = np.linalg.norm(u_qc - u_ref) / norm_u_ref\n        else:\n            error = np.linalg.norm(u_qc - u_ref)\n\n        results.append(f\"{error:.5e}\")\n\n    print(f\"[{','.join(results)}]\")\n\n\nsolve_problem()\n```", "id": "2923446"}]}