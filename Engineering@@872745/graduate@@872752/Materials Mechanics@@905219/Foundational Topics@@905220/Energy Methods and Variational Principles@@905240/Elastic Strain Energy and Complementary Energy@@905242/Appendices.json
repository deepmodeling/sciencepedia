{"hands_on_practices": [{"introduction": "This exercise provides a foundational workout in calculating elastic strain energy directly from its definition. By analyzing a bar with varying material and geometric properties, you will reinforce your understanding of how to derive stress and strain fields from first principles and integrate the strain energy density over the volume [@problem_id:2881874]. This practice is crucial for building a solid grasp of how energy is stored in a deformable body.", "problem": "A straight, prismatic bar of length $L$ is aligned along the $x$-axis with $x \\in [0,L]$. The bar has spatially varying cross-sectional area $A(x)$ and spatially varying Young's modulus $E(x)$ given by\n$A(x) = A_{0}\\left(1 + a \\frac{x}{L}\\right)$ and $E(x) = E_{0}\\left(1 + b \\frac{x}{L}\\right)$,\nwhere $A_{0} = 8.00 \\times 10^{-4}\\ \\text{m}^{2}$, $E_{0} = 70 \\times 10^{9}\\ \\text{Pa}$, $a = 0.4$, $b = -0.2$, and $L = 1.2\\ \\text{m}$. The bar is subjected to a static, tensile end load $P = 1.20 \\times 10^{5}\\ \\text{N}$ applied at $x=L$ and equilibrated by an equal and opposite axial force at $x=0$. Assume small strains, linear elasticity, and no body forces.\n\nStarting only from one-dimensional axial equilibrium, the linear elastic constitutive relation, and kinematic compatibility, determine the total elastic strain energy stored in the bar under the load $P$. Use the definition of strain energy density for a linearly elastic material to connect stress and strain fields to energy. Express your final answer in Joules using the International System of Units (SI), and round your answer to four significant figures.", "solution": "The problem requires a derivation starting from fundamental principles. These are:\n1.  One-dimensional axial equilibrium.\n2.  The linear elastic constitutive relation (Hooke's Law).\n3.  The definition of elastic strain energy.\n\nStep 1: Axial Equilibrium\nConsider a free-body diagram of a segment of the bar from an arbitrary position $x$ to the end at $x=L$. The bar is subjected to an external tensile force $P$ at $x=L$. As per the problem statement, there are no body forces acting on the bar. For the segment to be in static equilibrium, the internal axial force $N(x)$ at the cross-section at position $x$ must balance the external force $P$.\n$$N(x) - P = 0$$\nTherefore, the internal axial force is constant along the length of the bar:\n$$N(x) = P$$\n\nStep 2: Stress and Strain Fields\nThe axial stress $\\sigma(x)$ is defined as the internal force per unit area. Since the cross-sectional area $A(x)$ varies with position, the stress will also be a function of $x$.\n$$\\sigma(x) = \\frac{N(x)}{A(x)} = \\frac{P}{A(x)}$$\nSubstituting the given expression for $A(x) = A_{0}(1 + a \\frac{x}{L})$:\n$$\\sigma(x) = \\frac{P}{A_{0}\\left(1 + a \\frac{x}{L}\\right)}$$\nThe problem states that the material is linearly elastic. The constitutive relation is given by Hooke's Law, $\\sigma(x) = E(x)\\epsilon(x)$, where $\\epsilon(x)$ is the axial strain and $E(x)$ is the spatially varying Young's modulus.\nThe axial strain is therefore:\n$$\\epsilon(x) = \\frac{\\sigma(x)}{E(x)} = \\frac{P}{A(x)E(x)}$$\nSubstituting the given expressions for $A(x)$ and $E(x) = E_{0}(1 + b \\frac{x}{L})$:\n$$\\epsilon(x) = \\frac{P}{A_{0}\\left(1 + a \\frac{x}{L}\\right) E_{0}\\left(1 + b \\frac{x}{L}\\right)}$$\n\nStep 3: Elastic Strain Energy\nThe elastic strain energy density, $u(x)$, which is the strain energy per unit volume, for a linearly elastic material is given by:\n$$u(x) = \\frac{1}{2}\\sigma(x)\\epsilon(x)$$\nThe total elastic strain energy $U$ stored in the bar is the integral of the strain energy density over the total volume $V$ of the bar. A differential volume element is $dV = A(x)\\,dx$.\n$$U = \\int_{V} u(x)\\,dV = \\int_{0}^{L} u(x) A(x)\\,dx$$\nSubstituting the expressions for $u(x)$, $\\sigma(x)$, and $\\epsilon(x)$:\n$$U = \\int_{0}^{L} \\frac{1}{2} \\sigma(x) \\epsilon(x) A(x)\\,dx = \\int_{0}^{L} \\frac{1}{2} \\left(\\frac{P}{A(x)}\\right) \\left(\\frac{P}{A(x)E(x)}\\right) A(x)\\,dx$$\nThis simplifies to the well-known expression for axial strain energy:\n$$U = \\int_{0}^{L} \\frac{P^2}{2 A(x) E(x)}\\,dx$$\nNow, we substitute the given functions for $A(x)$ and $E(x)$:\n$$U = \\int_{0}^{L} \\frac{P^2}{2 \\left[A_{0}\\left(1 + a \\frac{x}{L}\\right)\\right] \\left[E_{0}\\left(1 + b \\frac{x}{L}\\right)\\right]}\\,dx$$\nWe can factor out the constants:\n$$U = \\frac{P^2}{2 A_{0} E_{0}} \\int_{0}^{L} \\frac{1}{\\left(1 + a \\frac{x}{L}\\right)\\left(1 + b \\frac{x}{L}\\right)}\\,dx$$\nTo evaluate the integral, we perform a change of variables. Let a dimensionless variable $\\xi = \\frac{x}{L}$. Then $d\\xi = \\frac{dx}{L}$, so $dx = L\\,d\\xi$. The limits of integration change from $x \\in [0, L]$ to $\\xi \\in [0, 1]$.\n$$U = \\frac{P^2 L}{2 A_{0} E_{0}} \\int_{0}^{1} \\frac{1}{(1 + a\\xi)(1 + b\\xi)}\\,d\\xi$$\nThe integrand is a rational function that can be solved using partial fraction decomposition, assuming $a \\neq b$, which is true for this problem ($a=0.4, b=-0.2$).\n$$\\frac{1}{(1 + a\\xi)(1 + b\\xi)} = \\frac{C}{1 + a\\xi} + \\frac{D}{1 + b\\xi}$$\nSolving for the coefficients $C$ and $D$ yields $C = \\frac{a}{a-b}$ and $D = \\frac{-b}{a-b}$.\nThe integral becomes:\n$$ \\int_{0}^{1} \\left(\\frac{a/(a-b)}{1 + a\\xi} + \\frac{-b/(a-b)}{1 + b\\xi}\\right)\\,d\\xi = \\frac{1}{a-b} \\int_{0}^{1} \\left(\\frac{a}{1 + a\\xi} - \\frac{b}{1 + b\\xi}\\right)\\,d\\xi $$\n$$= \\frac{1}{a-b} \\left[ \\ln(1 + a\\xi) - \\ln(1 + b\\xi) \\right]_{0}^{1}$$\n$$= \\frac{1}{a-b} \\left[ (\\ln(1+a) - \\ln(1+b)) - (\\ln(1) - \\ln(1)) \\right]$$\n$$= \\frac{1}{a-b} \\ln\\left(\\frac{1+a}{1+b}\\right)$$\nSubstituting this result back into the expression for $U$:\n$$U = \\frac{P^2 L}{2 A_{0} E_{0}} \\left[ \\frac{1}{a-b} \\ln\\left(\\frac{1+a}{1+b}\\right) \\right]$$\n\nStep 4: Numerical Calculation\nWe are given the following values:\n$P = 1.20 \\times 10^{5}\\ \\text{N}$\n$L = 1.2\\ \\text{m}$\n$A_{0} = 8.00 \\times 10^{-4}\\ \\text{m}^{2}$\n$E_{0} = 70 \\times 10^{9}\\ \\text{Pa}$\n$a = 0.4$\n$b = -0.2$\n\nFirst, let us calculate the components of the formula:\n$P^2 = (1.20 \\times 10^{5})^{2} = 1.44 \\times 10^{10}\\ \\text{N}^2$\n$A_{0} E_{0} = (8.00 \\times 10^{-4}\\ \\text{m}^2)(70 \\times 10^{9}\\ \\text{Pa}) = 56 \\times 10^{6}\\ \\text{N} = 5.6 \\times 10^{7}\\ \\text{N}$\n$a-b = 0.4 - (-0.2) = 0.6$\n$\\frac{1+a}{1+b} = \\frac{1+0.4}{1-0.2} = \\frac{1.4}{0.8} = 1.75$\n\nNow substitute these values into the expression for $U$:\n$$U = \\frac{(1.44 \\times 10^{10}) (1.2)}{2 (5.6 \\times 10^{7})} \\left[ \\frac{1}{0.6} \\ln(1.75) \\right]$$\n$$U = \\frac{1.728 \\times 10^{10}}{1.12 \\times 10^{8}} \\left[ \\frac{\\ln(1.75)}{0.6} \\right]$$\n$$U \\approx 154.2857 \\left[ \\frac{0.559616}{0.6} \\right]$$\n$$U \\approx 154.2857 \\times 0.932693$$\n$$U \\approx 143.9116\\ \\text{J}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$U \\approx 143.9\\ \\text{J}$$", "answer": "$$\\boxed{143.9}$$", "id": "2881874"}, {"introduction": "Energy methods often provide elegant shortcuts and deeper insights into structural behavior that are not obvious from force-based analysis. This practice guides you to derive Maxwell's reciprocity theorem from the principles of complementary energy, a cornerstone of linear elastic theory [@problem_id:2881882]. Applying the theorem demonstrates how a seemingly complex displacement calculation can be simplified by cleverly relating two different load cases.", "problem": "A prismatic, slender beam of length $L$ is simply supported at $x=0$ and $x=L$. The beam has constant bending stiffness $E I$ with $E=210\\,\\mathrm{GPa}$ and $I=1.0\\times 10^{-4}\\,\\mathrm{m}^4$. Small-deflection, linear-elastic behavior is assumed; shear deformation and rotary inertia are negligible. Consider two distinct static load cases:\n\n- Case $\\mathcal{A}$: a single downward point load $P_{1}=12\\,\\mathrm{kN}$ applied at $x=a=2.0\\,\\mathrm{m}$.\n- Case $\\mathcal{B}$: a single downward point load $P_{2}=9.0\\,\\mathrm{kN}$ applied at $x=b=4.5\\,\\mathrm{m}$.\n\nAn experimental measurement under Case $\\mathcal{B}$ reports the vertical displacement at $x=a$ to be $\\Delta_{a|\\mathcal{B}}=1.37\\,\\mathrm{mm}$ (downward taken as positive).\n\nUsing only first principles of elastic strain energy and complementary energy for linear elastic bending, derive any reciprocity relation that applies to this beam with the two point loads, and then use it to compute the vertical displacement at $x=b$ under Case $\\mathcal{A}$, denoted $\\Delta_{b|\\mathcal{A}}$. Express the final displacement in $\\mathrm{mm}$ (downward taken as positive) and round your answer to three significant figures.", "solution": "We begin from the first principles of complementary energy for a linear elastic system. For such a system subjected to a set of point loads $P_i$, the complementary energy $\\Pi^*$ is a state function of these loads. The displacement $\\Delta_j$ at the point of application of a load $P_j$ and in the direction of $P_j$ is given by the Crotti-Engesser theorem:\n$$ \\Delta_j = \\frac{\\partial \\Pi^*}{\\partial P_j} $$\nFor a slender beam where bending is the dominant mode of deformation, the complementary energy is stored as bending strain energy and is calculated by integrating the complementary energy density over the volume of the beam. This results in the expression:\n$$ \\Pi^* = \\int_0^L \\frac{M(x)^2}{2 EI} dx $$\nwhere $M(x)$ is the bending moment at position $x$, $E$ is the Young's modulus, $I$ is the second moment of area of the cross-section, and $L$ is the length of the beam.\n\nLet us consider a general loading scenario where two independent vertical point loads, $P_a$ and $P_b$, are applied at locations $x=a$ and $x=b$, respectively. Due to the principle of superposition for a linear elastic system, the total bending moment $M(x)$ at any point $x$ along the beam is the sum of the moments caused by each load acting separately. We can write this as:\n$$ M(x; P_a, P_b) = M_a(x) + M_b(x) $$\nwhere $M_a(x)$ is the moment due to $P_a$ and $M_b(x)$ is the moment due to $P_b$. These moments are linearly proportional to the loads that cause them. Thus, we can define influence functions for the bending moment, $m_a(x)$ and $m_b(x)$, such that:\n$$ M_a(x) = P_a m_a(x) \\quad \\text{and} \\quad M_b(x) = P_b m_b(x) $$\nwhere $m_a(x)$ is the bending moment due to a unit load at $x=a$, and $m_b(x)$ is the bending moment due to a unit load at $x=b$.\n\nThe total complementary energy of the system as a function of the two loads is:\n$$ \\Pi^*(P_a, P_b) = \\int_0^L \\frac{[P_a m_a(x) + P_b m_b(x)]^2}{2 EI} dx $$\n$$ \\Pi^*(P_a, P_b) = \\frac{1}{2 EI} \\int_0^L [P_a^2 m_a(x)^2 + 2 P_a P_b m_a(x) m_b(x) + P_b^2 m_b(x)^2] dx $$\nThe vertical displacement at $x=a$, denoted $\\Delta_a$, is found by taking the partial derivative of $\\Pi^*$ with respect to $P_a$:\n$$ \\Delta_a(P_a, P_b) = \\frac{\\partial \\Pi^*}{\\partial P_a} = \\frac{1}{EI} \\int_0^L [P_a m_a(x)^2 + P_b m_a(x) m_b(x)] dx $$\nSimilarly, the vertical displacement at $x=b$, denoted $\\Delta_b$, is:\n$$ \\Delta_b(P_a, P_b) = \\frac{\\partial \\Pi^*}{\\partial P_b} = \\frac{1}{EI} \\int_0^L [P_a m_a(x) m_b(x) + P_b m_b(x)^2] dx $$\nSince $\\Pi^*$ is a continuous state function with continuous second derivatives, the order of differentiation does not matter (Clairaut's theorem on equality of mixed partials). We can compute the mixed second partial derivatives:\n$$ \\frac{\\partial \\Delta_a}{\\partial P_b} = \\frac{\\partial}{\\partial P_b} \\left( \\frac{\\partial \\Pi^*}{\\partial P_a} \\right) = \\frac{\\partial^2 \\Pi^*}{\\partial P_b \\partial P_a} = \\frac{1}{EI} \\int_0^L m_a(x) m_b(x) dx $$\n$$ \\frac{\\partial \\Delta_b}{\\partial P_a} = \\frac{\\partial}{\\partial P_a} \\left( \\frac{\\partial \\Pi^*}{\\partial P_b} \\right) = \\frac{\\partial^2 \\Pi^*}{\\partial P_a \\partial P_b} = \\frac{1}{EI} \\int_0^L m_a(x) m_b(x) dx $$\nEquating the two expressions, we obtain a general reciprocity relation:\n$$ \\frac{\\partial \\Delta_a}{\\partial P_b} = \\frac{\\partial \\Delta_b}{\\partial P_a} $$\nThe term $\\frac{\\partial \\Delta_a}{\\partial P_b}$ represents the displacement at $a$ per unit load at $b$, which is a flexibility influence coefficient $f_{ab}$. For a linear system, the displacement at $a$ due to only a load $P_b$ is $\\Delta_{a|P_b} = f_{ab} P_b$. Thus, $f_{ab} = \\Delta_{a|P_b} / P_b$.\nSimilarly, $\\frac{\\partial \\Delta_b}{\\partial P_a} = f_{ba}$, and $\\Delta_{b|P_a} = f_{ba} P_a$, so $f_{ba} = \\Delta_{b|P_a} / P_a$.\nThe equality $f_{ab} = f_{ba}$ implies:\n$$ \\frac{\\Delta_{a|P_b}}{P_b} = \\frac{\\Delta_{b|P_a}}{P_a} \\implies P_a \\Delta_{a|P_b} = P_b \\Delta_{b|P_a} $$\nThis is Maxwell's reciprocal theorem, which we have derived from the first principles of complementary energy. It states that the work done by a first load $P_a$ acting through the displacement caused by a second load $P_b$ is equal to the work done by the second load $P_b$ acting through the displacement caused by the first load $P_a$.\n\nWe now apply this theorem to the specific cases given in the problem.\nCase $\\mathcal{A}$: A single load $P_1$ is applied at $x=a$. The displacement at $x=b$ is $\\Delta_{b|\\mathcal{A}}$. Here, $P_a = P_1$ and $\\Delta_{b|P_a} = \\Delta_{b|\\mathcal{A}}$.\nCase $\\mathcal{B}$: A single load $P_2$ is applied at $x=b$. The displacement at $x=a$ is $\\Delta_{a|\\mathcal{B}}$. Here, $P_b = P_2$ and $\\Delta_{a|P_b} = \\Delta_{a|\\mathcal{B}}$.\n\nSubstituting these into the derived reciprocity relation $P_a \\Delta_{a|P_b} = P_b \\Delta_{b|P_a}$:\n$$ P_1 \\Delta_{a|\\mathcal{B}} = P_2 \\Delta_{b|\\mathcal{A}} $$\nWe are asked to compute $\\Delta_{b|\\mathcal{A}}$. Rearranging the equation:\n$$ \\Delta_{b|\\mathcal{A}} = \\frac{P_1}{P_2} \\Delta_{a|\\mathcal{B}} $$\nThe problem provides the following numerical values:\n$P_1 = 12\\,\\mathrm{kN}$\n$P_2 = 9.0\\,\\mathrm{kN}$\n$\\Delta_{a|\\mathcal{B}} = 1.37\\,\\mathrm{mm}$\n\nSubstituting these values into the expression for $\\Delta_{b|\\mathcal{A}}$:\n$$ \\Delta_{b|\\mathcal{A}} = \\frac{12\\,\\mathrm{kN}}{9.0\\,\\mathrm{kN}} \\times 1.37\\,\\mathrm{mm} = \\frac{4}{3} \\times 1.37\\,\\mathrm{mm} $$\nThe calculation yields:\n$$ \\Delta_{b|\\mathcal{A}} \\approx 1.3333... \\times 1.37\\,\\mathrm{mm} \\approx 1.82666...\\,\\mathrm{mm} $$\nThe problem requires the answer to be rounded to three significant figures.\n$$ \\Delta_{b|\\mathcal{A}} \\approx 1.83\\,\\mathrm{mm} $$\nThe positive sign indicates that the displacement is downward, consistent with the convention established in the problem statement. The extraneous data ($E$, $I$, $a$, $b$, and implicitly $L$) is not required for this calculation, as is expected from the application of the reciprocity theorem.", "answer": "$$\\boxed{1.83}$$", "id": "2881882"}, {"introduction": "The principles of strain and complementary energy are not just theoretical constructs; they are the foundation for powerful tools in computational mechanics. In this practice, you will bridge theory and application by implementing an a posteriori error estimator for a finite element analysis [@problem_id:2881876]. By computing the gap between the strain energy of a displacement-based solution and the complementary energy of an equilibrated stress field, you will see firsthand how energy principles are used to assess the accuracy of numerical simulations.", "problem": "You are given several small, independent test instances of a two-dimensional, linear, isotropic elastic body modeled under plane stress, discretized by constant-strain finite elements. For each instance, you are provided with material parameters and, per element, a constant engineering strain vector and a recovered, statically admissible (equilibrated) engineering stress vector. Using only fundamental definitions, derive a computable, programmatic a posteriori error estimator based on the energy gap between the computed total strain energy and the recovered total complementary energy. Then implement a program that carries out this computation for the specified test suite and outputs the estimators in the prescribed format.\n\nFundamental base and modeling assumptions:\n- The setting is two-dimensional linear elasticity under plane stress. The displacement field is kinematically admissible and the recovered stress field is statically admissible (equilibrated with the same loads). Small-strain kinematics and Hooke’s law apply.\n- Engineering shear strain is used, so the strain vector is $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\left[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}\\right]^{\\mathsf{T}}$ and the stress vector is $\\boldsymbol{\\sigma}_{\\text{eng}} = \\left[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}\\right]^{\\mathsf{T}}$.\n- For a homogeneous, isotropic material under plane stress with Young’s modulus $E$ and Poisson’s ratio $\\nu$, the constitutive (stiffness) matrix $\\mathbf{D}$ and its inverse, the compliance matrix $\\mathbf{S}$, relate stress and strain as $\\boldsymbol{\\sigma}_{\\text{eng}} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}$ and $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng}}$, respectively. These are well tested formulas and must be constructed consistently for engineering shear in plane stress.\n- Strain energy density is defined as $w = \\dfrac{1}{2}\\,\\boldsymbol{\\varepsilon} : \\boldsymbol{\\sigma}$ and complementary energy density is defined as $w^{\\ast} = \\dfrac{1}{2}\\,\\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}$, where “$:$” denotes the double contraction. With the above vector-matrix conventions, $w = \\dfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}$ and $w^{\\ast} = \\dfrac{1}{2}\\,\\boldsymbol{\\sigma}_{\\text{eng}}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng}}$.\n\nDiscretization and computable quantities:\n- Consider constant-strain triangular or quadrilateral elements of area $A_e$ and unit thickness. The element strain energy is $U_e = \\int_{\\Omega_e} w\\,\\mathrm{d}\\Omega = \\dfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}\\,A_e$, and the element complementary energy is $V_e = \\int_{\\Omega_e} w^{\\ast}\\,\\mathrm{d}\\Omega = \\dfrac{1}{2}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}\\,A_e$. The totals are $U = \\sum_e U_e$ and $V = \\sum_e V_e$.\n- Based on the Principle of Complementarity and the Prager–Synge type energy identity for linear elasticity, a robust computable error indicator for the energy norm is based on the energy gap between $V$ and $U$. In this task you must use the energy-gap estimator defined as the nonnegative part of the difference:\n  $$\\eta = \\max\\!\\left(0,\\, V - U\\right).$$\n  This estimator $\\eta$ has the unit of energy. You must express $\\eta$ in joules (J).\n\nImplementation requirements:\n- Construct $\\mathbf{D}$ and $\\mathbf{S}$ for plane stress with engineering shear consistently from $E$ and $\\nu$.\n- For each test instance, compute $U$ and $V$ by summing the element contributions and then compute $\\eta$ as defined above.\n- Numerical stability: if floating-point roundoff produces a tiny negative value for $V - U$, clamp it to zero using the $\\max$ above.\n\nPhysical units:\n- Use the International System of Units (SI). Take $E$ in pascals (Pa), $\\nu$ dimensionless, areas $A_e$ in square meters ($\\mathrm{m}^2$), strain and engineering shear strain dimensionless, and stresses in pascals (Pa). Report $\\eta$ in joules (J), rounded to exactly six decimal places.\n\nTest suite (four independent instances), each providing material parameters and per-element data $(A_e, \\boldsymbol{\\varepsilon}_{\\text{eng},e}, \\boldsymbol{\\sigma}_{\\text{eng},e})$:\n- Instance 1:\n  - Material: $E = 210\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.3$.\n  - Elements:\n    - $A_1 = 0.50$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[1.0\\times 10^{-4},\\ 0.5\\times 10^{-4},\\ 0.2\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[30.0\\times 10^{6},\\ 18.0\\times 10^{6},\\ 7.0\\times 10^{6}\\right]$.\n    - $A_2 = 0.75$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.8\\times 10^{-4},\\ 1.2\\times 10^{-4},\\ -0.1\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[28.0\\times 10^{6},\\ 32.0\\times 10^{6},\\ -5.0\\times 10^{6}\\right]$.\n    - $A_3 = 0.60$, $\\boldsymbol{\\varepsilon}_{\\text{eng},3} = \\left[0.6\\times 10^{-4},\\ 0.4\\times 10^{-4},\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},3} = \\left[20.0\\times 10^{6},\\ 15.0\\times 10^{6},\\ 0.0\\right]$.\n- Instance 2:\n  - Material: $E = 70\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.25$.\n  - Elements:\n    - $A_1 = 1.20$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$.\n    - $A_2 = 0.80$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$.\n- Instance 3:\n  - Material: $E = 100\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.30$.\n  - Elements:\n    - $A_1 = 1.00$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[1.0\\times 10^{-4},\\ 1.0\\times 10^{-4},\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[5.0\\times 10^{6},\\ 5.0\\times 10^{6},\\ 0.0\\right]$.\n    - $A_2 = 0.50$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.5\\times 10^{-4},\\ 0.5\\times 10^{-4},\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[2.5\\times 10^{6},\\ 2.5\\times 10^{6},\\ 0.0\\right]$.\n- Instance 4:\n  - Material: $E = 70\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.20$.\n  - Elements:\n    - $A_1 = 0.40$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[1.5\\times 10^{-4},\\ 0.5\\times 10^{-4},\\ 0.3\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[18.0\\times 10^{6},\\ 10.0\\times 10^{6},\\ 6.0\\times 10^{6}\\right]$.\n    - $A_2 = 0.60$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.9\\times 10^{-4},\\ 1.2\\times 10^{-4},\\ -0.2\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[14.0\\times 10^{6},\\ 16.0\\times 10^{6},\\ -4.0\\times 10^{6}\\right]$.\n\nFinal output format:\n- Your program must produce a single line containing a Python list literal of the four estimators, in joules (J), each rounded to exactly six decimal places, with no additional whitespace or text. For example: \"[$x_1,x_2,x_3,x_4$]\" where each $x_i$ is a decimal number with six digits after the decimal point.", "solution": "The objective is to compute an a posteriori error estimator, $\\eta$, for several instances of a two-dimensional elastic body under plane stress. This estimator is defined as the energy gap between the total complementary energy of a recovered, statically admissible stress field and the total strain energy of the kinematically admissible finite element displacement field. The definition is given as:\n$$ \\eta = \\max\\!\\left(0,\\, V - U\\right) $$\nwhere $U$ is the total strain energy and $V$ is the total complementary energy.\n\nFirst, we must establish the material constitutive matrices, $\\mathbf{D}$ (stiffness) and $\\mathbf{S}$ (compliance), for a linear, isotropic material under plane stress, using engineering strain conventions. The relationship between the engineering stress vector $\\boldsymbol{\\sigma}_{\\text{eng}} = \\left[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}\\right]^{\\mathsf{T}}$ and the engineering strain vector $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\left[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}\\right]^{\\mathsf{T}}$ is $\\boldsymbol{\\sigma}_{\\text{eng}} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}$.\n\nUnder the plane stress assumption ($\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$), the strain-stress relations for an isotropic material with Young's modulus $E$ and Poisson's ratio $\\nu$ are:\n$$ \\varepsilon_{xx} = \\frac{1}{E}(\\sigma_{xx} - \\nu \\sigma_{yy}) $$\n$$ \\varepsilon_{yy} = \\frac{1}{E}(\\sigma_{yy} - \\nu \\sigma_{xx}) $$\n$$ \\gamma_{xy} = \\frac{1}{G}\\tau_{xy} $$\nwhere $G = \\frac{E}{2(1+\\nu)}$ is the shear modulus. These equations can be written in matrix form $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng}}$, which defines the compliance matrix $\\mathbf{S}$:\n$$ \\mathbf{S} = \\begin{bmatrix} 1/E  -\\nu/E  0 \\\\ -\\nu/E  1/E  0 \\\\ 0  0  1/G \\end{bmatrix} = \\frac{1}{E} \\begin{bmatrix} 1  -\\nu  0 \\\\ -\\nu  1  0 \\\\ 0  0  2(1+\\nu) \\end{bmatrix} $$\nThe stiffness matrix $\\mathbf{D}$ is the inverse of the compliance matrix, $\\mathbf{D} = \\mathbf{S}^{-1}$. Inverting the above matrix yields:\n$$ \\mathbf{D} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} $$\nThese matrices are fundamental to calculating the energy densities.\n\nThe total strain energy $U$ and total complementary energy $V$ are obtained by summing the contributions from each finite element, labeled with index $e$. The body is assumed to have unit thickness. For an element with area $A_e$, the energies are:\n$$ U = \\sum_e U_e = \\sum_e \\left( \\frac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}\\,A_e \\right) $$\n$$ V = \\sum_e V_e = \\sum_e \\left( \\frac{1}{2}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}\\,A_e \\right) $$\nHere, $\\boldsymbol{\\varepsilon}_{\\text{eng},e}$ is the constant strain vector from the finite element solution for element $e$, and $\\boldsymbol{\\sigma}_{\\text{eng},e}$ is the corresponding recovered, statically admissible stress vector.\n\nThe computational procedure for each test instance is as follows:\n1.  Given the material parameters $E$ and $\\nu$, construct the matrices $\\mathbf{D}$ and $\\mathbf{S}$.\n2.  Initialize the total energies $U \\leftarrow 0$ and $V \\leftarrow 0$.\n3.  For each element $e$ provided in the test case:\n    a. Retrieve the element area $A_e$, strain vector $\\boldsymbol{\\varepsilon}_{\\text{eng},e}$, and stress vector $\\boldsymbol{\\sigma}_{\\text{eng},e}$.\n    b. Compute the element strain energy $U_e$ using the formula above and add it to the total: $U \\leftarrow U + U_e$.\n    c. Compute the element complementary energy $V_e$ using its formula and add it to the total: $V \\leftarrow V + V_e$.\n4.  After iterating through all elements, calculate the final error estimator $\\eta = \\max(0, V - U)$.\n5.  All calculations must be performed using SI units, resulting in $\\eta$ in joules (J).\n\nThis exact procedure is implemented in the accompanying Python program. The program processes the four specified test instances, computes $\\eta$ for each, rounds the results to six decimal places, and prints them in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the a posteriori error estimation problem for the given test suite.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"material\": {\"E\": 210e9, \"nu\": 0.3},\n            \"elements\": [\n                {\"A\": 0.50, \"eps\": [1.0e-4, 0.5e-4, 0.2e-4],  \"sigma\": [30.0e6, 18.0e6, 7.0e6]},\n                {\"A\": 0.75, \"eps\": [0.8e-4, 1.2e-4, -0.1e-4], \"sigma\": [28.0e6, 32.0e6, -5.0e6]},\n                {\"A\": 0.60, \"eps\": [0.6e-4, 0.4e-4, 0.0],     \"sigma\": [20.0e6, 15.0e6, 0.0]}\n            ]\n        },\n        {\n            \"material\": {\"E\": 70e9, \"nu\": 0.25},\n            \"elements\": [\n                {\"A\": 1.20, \"eps\": [0.0, 0.0, 0.0], \"sigma\": [0.0, 0.0, 0.0]},\n                {\"A\": 0.80, \"eps\": [0.0, 0.0, 0.0], \"sigma\": [0.0, 0.0, 0.0]}\n            ]\n        },\n        {\n            \"material\": {\"E\": 100e9, \"nu\": 0.30},\n            \"elements\": [\n                {\"A\": 1.00, \"eps\": [1.0e-4, 1.0e-4, 0.0], \"sigma\": [5.0e6, 5.0e6, 0.0]},\n                {\"A\": 0.50, \"eps\": [0.5e-4, 0.5e-4, 0.0], \"sigma\": [2.5e6, 2.5e6, 0.0]}\n            ]\n        },\n        {\n            \"material\": {\"E\": 70e9, \"nu\": 0.20},\n            \"elements\": [\n                {\"A\": 0.40, \"eps\": [1.5e-4, 0.5e-4, 0.3e-4],  \"sigma\": [18.0e6, 10.0e6, 6.0e6]},\n                {\"A\": 0.60, \"eps\": [0.9e-4, 1.2e-4, -0.2e-4], \"sigma\": [14.0e6, 16.0e6, -4.0e6]}\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"material\"][\"E\"]\n        nu = case[\"material\"][\"nu\"]\n\n        # Construct constitutive (stiffness) matrix D for plane stress\n        d_factor = E / (1.0 - nu**2)\n        D_matrix = d_factor * np.array([\n            [1.0, nu, 0.0],\n            [nu, 1.0, 0.0],\n            [0.0, 0.0, (1.0 - nu) / 2.0]\n        ])\n\n        # Construct compliance matrix S for plane stress\n        s_factor = 1.0 / E\n        S_matrix = s_factor * np.array([\n            [1.0, -nu, 0.0],\n            [-nu, 1.0, 0.0],\n            [0.0, 0.0, 2.0 * (1.0 + nu)]\n        ])\n        \n        U_total = 0.0\n        V_total = 0.0\n\n        for elem in case[\"elements\"]:\n            A_e = elem[\"A\"]\n            eps_eng_e = np.array(elem[\"eps\"])\n            sigma_eng_e = np.array(elem[\"sigma\"])\n\n            # Calculate element strain energy U_e\n            # U_e = (1/2) * eps^T * D * eps * A\n            U_e = 0.5 * (eps_eng_e.T @ D_matrix @ eps_eng_e) * A_e\n            U_total += U_e\n            \n            # Calculate element complementary energy V_e\n            # V_e = (1/2) * sigma^T * S * sigma * A\n            V_e = 0.5 * (sigma_eng_e.T @ S_matrix @ sigma_eng_e) * A_e\n            V_total += V_e\n            \n        # Calculate the energy gap error estimator\n        eta = max(0.0, V_total - U_total)\n        results.append(eta)\n\n    # Format output to exactly six decimal places as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2881876"}]}