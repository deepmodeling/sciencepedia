{"hands_on_practices": [{"introduction": "Understanding the motion of a rigid body often begins with analyzing the velocities of its constituent points. This foundational exercise ([@problem_id:2914505]) demonstrates how, by using only the defining property of rigidity, the instantaneous velocities of just two points are sufficient to completely determine the planar motion of a body. Working through this problem solidifies the fundamental relationship between relative position, relative velocity, and angular velocity, providing a crucial building block for more complex kinematic analyses.", "problem": "In a fixed inertial frame with an orthonormal basis in the plane, a uniform rigid bar lies in the plane at an instant with two labeled material points $P$ and $Q$ serving as its endpoints. The instantaneous position vectors (from the inertial origin) of these points at that instant are\n$$\n\\mathbf{r}_P=\\begin{pmatrix}1\\\\2\\end{pmatrix}\\,\\mathrm{m},\\qquad \\mathbf{r}_Q=\\begin{pmatrix}5\\\\-1\\end{pmatrix}\\,\\mathrm{m}.\n$$\nAt the same instant, their measured velocities in the inertial frame are\n$$\n\\mathbf{v}_P=\\begin{pmatrix}3\\\\7\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}},\\qquad \\mathbf{v}_Q=\\begin{pmatrix}9\\\\15\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}.\n$$\nTreat the motion as a general plane motion of a rigid body. Using only the defining property of rigidity that the distance between any two material points remains invariant in time, first derive the general instantaneous relationship between the velocities of two points on a rigid body moving in a plane and compute the instantaneous relative velocity of $Q$ with respect to $P$ at the given instant. Then deduce the scalar angular velocity $\\omega$ of the bar (take the out-of-plane unit vector $\\hat{\\mathbf{k}}$ as positive when angular velocity is counterclockwise) and the translational velocity of the center of mass (COM) of the bar at that instant.\n\nExpress the angular velocity in radians per second and the COM velocity in meters per second. Provide your final result as a single row matrix $\\begin{pmatrix}\\omega  v_{\\mathrm{COM},x}  v_{\\mathrm{COM},y}\\end{pmatrix}$. No rounding is required; provide exact values.", "solution": "The problem statement must first be validated.\n\n**Step 1: Extract Givens**\n- Frame of reference: Fixed inertial frame with an orthonormal basis.\n- Object: A uniform rigid bar in plane motion.\n- Points on the bar: Endpoints $P$ and $Q$.\n- Position vector of $P$: $\\mathbf{r}_P=\\begin{pmatrix}1\\\\2\\end{pmatrix}\\,\\mathrm{m}$.\n- Position vector of $Q$: $\\mathbf{r}_Q=\\begin{pmatrix}5\\\\-1\\end{pmatrix}\\,\\mathrm{m}$.\n- Velocity of $P$: $\\mathbf{v}_P=\\begin{pmatrix}3\\\\7\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}$.\n- Velocity of $Q$: $\\mathbf{v}_Q=\\begin{pmatrix}9\\\\15\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}$.\n- Constraint: Use only the defining property of rigidity, which is the invariance of distance between any two material points.\n- Objectives:\n    1. Derive the general instantaneous relationship between velocities of two points on a rigid body.\n    2. Compute the relative velocity $\\mathbf{v}_{Q/P}$.\n    3. Compute the scalar angular velocity $\\omega$.\n    4. Compute the velocity of the center of mass (COM), $\\mathbf{v}_{\\mathrm{COM}}$.\n- Output format: A row matrix $\\begin{pmatrix}\\omega  v_{\\mathrm{COM},x}  v_{\\mathrm{COM},y}\\end{pmatrix}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in classical kinematics of rigid bodies. It is well-posed, as the positions and velocities of two points on a rigid body in a plane are sufficient to determine its instantaneous state of motion. The language is objective and precise.\n\nA critical consistency check for rigid body motion is that the relative velocity vector of two points must be orthogonal to their relative position vector. Let $\\mathbf{r}_{QP} = \\mathbf{r}_Q - \\mathbf{r}_P$ and $\\mathbf{v}_{QP} = \\mathbf{v}_Q - \\mathbf{v}_P$. The condition of rigidity implies $\\frac{d}{dt}(|\\mathbf{r}_{QP}|^2)=0$, which leads to $\\mathbf{r}_{QP} \\cdot \\mathbf{v}_{QP} = 0$.\n\nFrom the given data:\n$\\mathbf{r}_{QP} = \\begin{pmatrix}5\\\\-1\\end{pmatrix} - \\begin{pmatrix}1\\\\2\\end{pmatrix} = \\begin{pmatrix}4\\\\-3\\end{pmatrix}\\,\\mathrm{m}$.\n$\\mathbf{v}_{QP} = \\begin{pmatrix}9\\\\15\\end{pmatrix} - \\begin{pmatrix}3\\\\7\\end{pmatrix} = \\begin{pmatrix}6\\\\8\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}}$.\n\nWe compute the dot product:\n$\\mathbf{r}_{QP} \\cdot \\mathbf{v}_{QP} = (4)(6) + (-3)(8) = 24 - 24 = 0$.\nThe condition is satisfied. The data is consistent and does not violate any physical principles.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\nThe solution proceeds by addressing each part of the problem statement in sequence.\n\nFirst, we derive the general velocity relationship for a rigid body. Let $P$ and $Q$ be two points on the body with position vectors $\\mathbf{r}_P$ and $\\mathbf{r}_Q$. The relative position vector is $\\mathbf{r}_{QP} = \\mathbf{r}_Q - \\mathbf{r}_P$. The defining property of rigidity is that the distance between $P$ and $Q$, $L = |\\mathbf{r}_{QP}|$, is constant. Thus, its square $L^2 = \\mathbf{r}_{QP} \\cdot \\mathbf{r}_{QP}$ is also constant. Differentiating with respect to time $t$:\n$$ \\frac{d}{dt} (L^2) = \\frac{d}{dt} (\\mathbf{r}_{QP} \\cdot \\mathbf{r}_{QP}) = 2 \\mathbf{r}_{QP} \\cdot \\frac{d\\mathbf{r}_{QP}}{dt} = 0 $$\nThe term $\\frac{d\\mathbf{r}_{QP}}{dt}$ is the relative velocity $\\mathbf{v}_{QP} = \\mathbf{v}_Q - \\mathbf{v}_P$. The relation $\\mathbf{r}_{QP} \\cdot \\mathbf{v}_{QP} = 0$ signifies that the relative velocity is always perpendicular to the vector connecting the two points. This motion is a pure rotation of point $Q$ about point $P$ (in a frame translating with $P$). Such motion is described by the cross product with an angular velocity vector $\\boldsymbol{\\omega}$:\n$$ \\mathbf{v}_{QP} = \\boldsymbol{\\omega} \\times \\mathbf{r}_{QP} $$\nThis yields the fundamental relationship for the velocities of two points on a rigid body:\n$$ \\mathbf{v}_Q = \\mathbf{v}_P + \\boldsymbol{\\omega} \\times (\\mathbf{r}_Q - \\mathbf{r}_P) $$\nFor plane motion in the $xy$-plane, $\\boldsymbol{\\omega} = \\omega \\hat{\\mathbf{k}}$, where $\\hat{\\mathbf{k}}$ is the unit vector normal to the plane. If $\\mathbf{r}_{QP} = \\Delta x \\hat{\\mathbf{i}} + \\Delta y \\hat{\\mathbf{j}}$, the cross product becomes:\n$$ \\boldsymbol{\\omega} \\times \\mathbf{r}_{QP} = (\\omega \\hat{\\mathbf{k}}) \\times (\\Delta x \\hat{\\mathbf{i}} + \\Delta y \\hat{\\mathbf{j}}) = \\omega \\Delta x (\\hat{\\mathbf{k}} \\times \\hat{\\mathbf{i}}) + \\omega \\Delta y (\\hat{\\mathbf{k}} \\times \\hat{\\mathbf{j}}) = \\omega \\Delta x \\hat{\\mathbf{j}} - \\omega \\Delta y \\hat{\\mathbf{i}} $$\nIn column vector form, this is $\\mathbf{v}_{QP} = \\begin{pmatrix} -\\omega \\Delta y \\\\ \\omega \\Delta x \\end{pmatrix}$.\n\nSecond, we compute the instantaneous relative velocity of $Q$ with respect to $P$, $\\mathbf{v}_{Q/P} = \\mathbf{v}_{QP}$. Using the provided data:\n$$ \\mathbf{v}_{QP} = \\mathbf{v}_Q - \\mathbf{v}_P = \\begin{pmatrix}9\\\\15\\end{pmatrix} - \\begin{pmatrix}3\\\\7\\end{pmatrix} = \\begin{pmatrix}6\\\\8\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}} $$\n\nThird, we deduce the scalar angular velocity $\\omega$. The relative position vector is:\n$$ \\mathbf{r}_{QP} = \\mathbf{r}_Q - \\mathbf{r}_P = \\begin{pmatrix}5\\\\-1\\end{pmatrix} - \\begin{pmatrix}1\\\\2\\end{pmatrix} = \\begin{pmatrix}4\\\\-3\\end{pmatrix}\\,\\mathrm{m} $$\nSo, $\\Delta x = 4$ and $\\Delta y = -3$. Substituting into the expression for $\\mathbf{v}_{QP}$:\n$$ \\begin{pmatrix}6\\\\8\\end{pmatrix} = \\begin{pmatrix} -\\omega (-3) \\\\ \\omega (4) \\end{pmatrix} = \\begin{pmatrix} 3\\omega \\\\ 4\\omega \\end{pmatrix} $$\nThis gives two consistent equations for $\\omega$:\nFrom the $x$-component: $6 = 3\\omega \\implies \\omega = 2\\,\\mathrm{rad/s}$.\nFrom the $y$-component: $8 = 4\\omega \\implies \\omega = 2\\,\\mathrm{rad/s}$.\nThe angular velocity is positive, which by convention corresponds to counter-clockwise rotation. Thus, $\\omega = 2$.\n\nFourth, we determine the velocity of the center of mass (COM). Since the bar is uniform, its COM is located at the midpoint of its endpoints $P$ and $Q$. The position of the COM is:\n$$ \\mathbf{r}_{\\mathrm{COM}} = \\frac{\\mathbf{r}_P + \\mathbf{r}_Q}{2} = \\frac{1}{2}\\left(\\begin{pmatrix}1\\\\2\\end{pmatrix} + \\begin{pmatrix}5\\\\-1\\end{pmatrix}\\right) = \\frac{1}{2}\\begin{pmatrix}6\\\\1\\end{pmatrix} = \\begin{pmatrix}3\\\\0.5\\end{pmatrix}\\,\\mathrm{m} $$\nThe velocity of the COM is obtained by differentiating its position with respect to time:\n$$ \\mathbf{v}_{\\mathrm{COM}} = \\frac{d\\mathbf{r}_{\\mathrm{COM}}}{dt} = \\frac{1}{2} \\left( \\frac{d\\mathbf{r}_P}{dt} + \\frac{d\\mathbf{r}_Q}{dt} \\right) = \\frac{\\mathbf{v}_P + \\mathbf{v}_Q}{2} $$\nThis simple averaging is valid specifically because the COM is the geometric midpoint. Substituting the given velocities:\n$$ \\mathbf{v}_{\\mathrm{COM}} = \\frac{1}{2} \\left( \\begin{pmatrix}3\\\\7\\end{pmatrix} + \\begin{pmatrix}9\\\\15\\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix}12\\\\22\\end{pmatrix} = \\begin{pmatrix}6\\\\11\\end{pmatrix}\\,\\mathrm{\\tfrac{m}{s}} $$\nSo, the components of the COM velocity are $v_{\\mathrm{COM},x} = 6\\,\\mathrm{\\tfrac{m}{s}}$ and $v_{\\mathrm{COM},y} = 11\\,\\mathrm{\\tfrac{m}{s}}$.\n\nFinally, the required result is the row matrix $\\begin{pmatrix}\\omega  v_{\\mathrm{COM},x}  v_{\\mathrm{COM},y}\\end{pmatrix}$:\n$$ \\begin{pmatrix}2  6  11\\end{pmatrix} $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  6  11\n\\end{pmatrix}\n}\n$$", "id": "2914505"}, {"introduction": "Real-world rigid body motion occurs in three dimensions and involves both angular velocity and angular acceleration. This problem ([@problem_id:2914495]) extends the principles of relative motion to a full 3D analysis, demonstrating how to determine the complete kinematic state, including the angular acceleration vector $\\dot{\\omega}$. By setting up and solving a linear system from the velocity and acceleration data of several points, you will practice a powerful technique used to analyze complex motion from experimental or simulation data.", "problem": "A rigid body moves in three-dimensional space. Three material points of the body, labeled $A$, $B$, and $C$, are attached at fixed locations relative to the body. In a body-fixed frame, their position vectors are constant and given by $A_{0} = [0,\\,0,\\,0]^{\\mathsf{T}}\\,\\mathrm{m}$, $B_{0} = [1,\\,2,\\,-1]^{\\mathsf{T}}\\,\\mathrm{m}$, and $C_{0} = [-2,\\,1,\\,3]^{\\mathsf{T}}\\,\\mathrm{m}$. The inertial-frame position of any body-fixed vector $r_{0}$ is described by\n$$\nr(t) \\;=\\; c(t) \\;+\\; R(t)\\,r_{0},\n$$\nwhere the translation is $c(t) = [\\,t^{2},\\ \\ln(1+t),\\ \\exp(-t)\\,]^{\\mathsf{T}}\\,\\mathrm{m}$ and the rotation is \n$$\nR(t) \\;=\\; R_{z}\\!\\big(\\theta(t)\\big)\\,R_{x}\\!\\big(\\varphi(t)\\big), \\quad \\theta(t) = t^{2}\\ \\text{(radians)}, \\quad \\varphi(t) = t\\ \\text{(radians)}.\n$$\nHere $R_{z}(\\cdot)$ and $R_{x}(\\cdot)$ denote proper rotations about the inertial $z$- and $x$-axes, respectively. Consider the instant $t_{0} = 1\\,\\mathrm{s}$.\n\nStarting from the fundamental definitions of rigid body velocity and acceleration fields, construct a linear system that relates the instantaneous angular velocity vector $\\omega(t_{0})$ and the instantaneous angular acceleration vector $\\dot{\\omega}(t_{0})$ to the measurable differences of point velocities and accelerations at $t_{0}$. Use point $A$ as the reference.\n\nFor convenience, the following quantities, obtained by differentiating the given trajectories and evaluating at $t_{0}=1\\,\\mathrm{s}$, are provided:\n- Relative position vectors:\n$$\nr_{BA}(t_{0}) \\;=\\; r_{B}(t_{0}) - r_{A}(t_{0}) \\;=\\; \\begin{bmatrix} -1.0770685392 \\\\ 1.8799728616 \\\\ 1.1426396637 \\end{bmatrix}\\,\\mathrm{m}, \n\\qquad\nr_{CA}(t_{0}) \\;=\\; r_{C}(t_{0}) - r_{A}(t_{0}) \\;=\\; \\begin{bmatrix} 0.5889669297 \\\\ -2.7549615281 \\\\ 2.4623779025 \\end{bmatrix}\\,\\mathrm{m}.\n$$\n- Velocities:\n$$\nv_{A}(t_{0}) \\;=\\; \\begin{bmatrix} 2 \\\\ 0.5 \\\\ -0.3678794412 \\end{bmatrix}\\,\\mathrm{m/s},\\quad\nv_{B}(t_{0}) \\;=\\; \\begin{bmatrix} -0.7984476 \\\\ -2.2715079235 \\\\ 1.554194559 \\end{bmatrix}\\,\\mathrm{m/s},\\quad\nv_{C}(t_{0}) \\;=\\; \\begin{bmatrix} 9.581942 \\\\ 0.347505401 \\\\ -2.351029441 \\end{bmatrix}\\,\\mathrm{m/s}.\n$$\n- Accelerations:\n$$\na_{A}(t_{0}) \\;=\\; \\begin{bmatrix} 2 \\\\ -0.25 \\\\ 0.3678794412 \\end{bmatrix}\\,\\mathrm{m/s^{2}},\\quad\na_{B}(t_{0}) \\;=\\; \\begin{bmatrix} 6.6352317 \\\\ -7.1160059 \\\\ -0.774760223 \\end{bmatrix}\\,\\mathrm{m/s^{2}},\\quad\na_{C}(t_{0}) \\;=\\; \\begin{bmatrix} 8.806197325 \\\\ 21.307876616 \\\\ -2.094498461 \\end{bmatrix}\\,\\mathrm{m/s^{2}}.\n$$\n\nUsing only the rigid body motion kinematics relations between differences of velocities/accelerations and the angular velocity/acceleration, determine the instantaneous angular velocity $\\omega(t_{0})$ and angular acceleration $\\dot{\\omega}(t_{0})$ vectors at $t_{0} = 1\\,\\mathrm{s}$. Express your final numerical components in the units radians per second for $\\omega(t_{0})$ and radians per second squared for $\\dot{\\omega}(t_{0})$, and round your answers to four significant figures. Report the six components in the order $\\big(\\omega_{x},\\,\\omega_{y},\\,\\omega_{z},\\,\\dot{\\omega}_{x},\\,\\dot{\\omega}_{y},\\,\\dot{\\omega}_{z}\\big)$.", "solution": "The problem statement must first be validated for scientific soundness, consistency, and completeness.\n\nStep 1: Extract Givens\nThe givens are:\n- A rigid body with three material points $A$, $B$, $C$.\n- Body-fixed position vectors: $A_{0} = [0,\\,0,\\,0]^{\\mathsf{T}}\\,\\mathrm{m}$, $B_{0} = [1,\\,2,\\,-1]^{\\mathsf{T}}\\,\\mathrm{m}$, and $C_{0} = [-2,\\,1,\\,3]^{\\mathsf{T}}\\,\\mathrm{m}$.\n- Kinematic transformation: $r(t) = c(t) + R(t)r_{0}$.\n- Translation vector: $c(t) = [t^{2}, \\ln(1+t), \\exp(-t)]^{\\mathsf{T}}\\,\\mathrm{m}$.\n- Rotation matrix: $R(t) = R_{z}(\\theta(t))R_{x}(\\varphi(t))$, with $\\theta(t) = t^{2}$ radians and $\\varphi(t) = t$ radians.\n- Instant of interest: $t_{0} = 1\\,\\mathrm{s}$.\n- Provided numerical data at $t_{0} = 1\\,\\mathrm{s}$:\n  - $r_{BA}(t_{0}) = [-1.0770685392, 1.8799728616, 1.1426396637]^{\\mathsf{T}}\\,\\mathrm{m}$\n  - $r_{CA}(t_{0}) = [0.5889669297, -2.7549615281, 2.4623779025]^{\\mathsf{T}}\\,\\mathrm{m}$\n  - $v_{A}(t_{0}) = [2, 0.5, -0.3678794412]^{\\mathsf{T}}\\,\\mathrm{m/s}$\n  - $v_{B}(t_{0}) = [-0.7984476, -2.2715079235, 1.554194559]^{\\mathsf{T}}\\,\\mathrm{m/s}$\n  - $v_{C}(t_{0}) = [9.581942, 0.347505401, -2.351029441]^{\\mathsf{T}}\\,\\mathrm{m/s}$\n  - $a_{A}(t_{0}) = [2, -0.25, 0.3678794412]^{\\mathsf{T}}\\,\\mathrm{m/s^{2}}$\n  - $a_{B}(t_{0}) = [6.6352317, -7.1160059, -0.774760223]^{\\mathsf{T}}\\,\\mathrm{m/s^{2}}$\n  - $a_{C}(t_{0}) = [8.806197325, 21.307876616, -2.094498461]^{\\mathsf{T}}\\,\\mathrm{m/s^{2}}$\n- The task is to determine the angular velocity $\\omega(t_{0})$ and angular acceleration $\\dot{\\omega}(t_{0})$ using only the kinematic relations for velocity and acceleration differences and the provided numerical data.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in standard rigid body kinematics. The main point of validation is to check if the provided numerical data is consistent with the analytical expressions for $c(t)$ and $R(t)$.\nThe angular velocity can be derived from $R(t) = R_z(\\theta(t))R_x(\\varphi(t))$. The total angular velocity is $\\omega(t) = \\dot{\\theta}(t)\\hat{k} + R_z(\\theta(t))(\\dot{\\varphi}(t)\\hat{i})$. In vector form, this is $\\omega(t) = [\\dot{\\varphi}(t)\\cos(\\theta(t)),\\, \\dot{\\varphi}(t)\\sin(\\theta(t)),\\, \\dot{\\theta}(t)]^{\\mathsf{T}}$.\nAt $t_0=1\\,\\mathrm{s}$: $\\theta(1)=1$, $\\dot{\\theta}(1)=2$, $\\ddot{\\theta}(1)=2$; $\\varphi(1)=1$, $\\dot{\\varphi}(1)=1$, $\\ddot{\\varphi}(1)=0$.\nThis yields $\\omega(1) = [\\cos(1), \\sin(1), 2]^{\\mathsf{T}} \\approx [0.540302, 0.841471, 2]^{\\mathsf{T}}\\,\\mathrm{rad/s}$.\nThe angular acceleration is $\\dot{\\omega}(t) = d/dt[\\dot{\\varphi}\\cos\\theta, \\dot{\\varphi}\\sin\\theta, \\dot{\\theta}]^{\\mathsf{T}} = [\\ddot{\\varphi}\\cos\\theta - \\dot{\\varphi}\\dot{\\theta}\\sin\\theta, \\ddot{\\varphi}\\sin\\theta + \\dot{\\varphi}\\dot{\\theta}\\cos\\theta, \\ddot{\\theta}]^{\\mathsf{T}}$.\nAt $t_0=1\\,\\mathrm{s}$, $\\dot{\\omega}(1) = [-2\\sin(1), 2\\cos(1), 2]^{\\mathsf{T}} \\approx [-1.68294, 1.08060, 2]^{\\mathsf{T}}\\,\\mathrm{rad/s^2}$.\nA thorough check confirms that all provided numerical values for positions, velocities, and accelerations at $t_0=1\\,\\mathrm{s}$ are consistent with these analytically derived $\\omega(1)$ and $\\dot{\\omega}(1)$ and the fundamental kinematic relations. The problem is self-contained, well-posed, and free of contradictions.\n\nStep 3: Verdict and Action\nThe problem is valid. The solution will proceed by constructing and solving the linear systems as requested, using only the provided numerical data.\n\nThe velocity of any point $P$ on a rigid body can be related to the velocity of another point $Q$ by the formula:\n$$\nv_P - v_Q = \\omega \\times (r_P - r_Q)\n$$\nwhere $\\omega$ is the instantaneous angular velocity of the body, and $r_P, r_Q$ are the position vectors of the points in an inertial frame.\n\nUsing point $A$ as the reference, we can write this for points $B$ and $C$:\n$$\nv_B - v_A = \\omega \\times (r_B - r_A) \\quad \\implies \\quad v_{BA} = \\omega \\times r_{BA}\n$$\n$$\nv_C - v_A = \\omega \\times (r_C - r_A) \\quad \\implies \\quad v_{CA} = \\omega \\times r_{CA}\n$$\nThe cross product operation can be represented by matrix multiplication. For vectors $u=[u_x, u_y, u_z]^{\\mathsf{T}}$ and $v=[v_x, v_y, v_z]^{\\mathsf{T}}$, $u \\times v = S(u)v$, where $S(u)$ is the skew-symmetric matrix:\n$$\nS(u) = \\begin{pmatrix} 0  -u_z  u_y \\\\ u_z  0  -u_x \\\\ -u_y  u_x  0 \\end{pmatrix}\n$$\nNote that $u \\times v = -v \\times u$, so $S(u)v = -S(v)u$. The velocity equations can be written as:\n$$\nv_{BA} = -S(r_{BA})\\omega\n$$\n$$\nv_{CA} = -S(r_{CA})\\omega\n$$\nThese two vector equations can be stacked to form a single linear system of $6$ equations for the $3$ components of $\\omega = [\\omega_x, \\omega_y, \\omega_z]^{\\mathsf{T}}$:\n$$\n\\begin{pmatrix} v_{BA} \\\\ v_{CA} \\end{pmatrix} = \\begin{pmatrix} -S(r_{BA}) \\\\ -S(r_{CA}) \\end{pmatrix} \\omega\n$$\nThis is an overdetermined system of the form $b = M\\omega$, which can be solved for $\\omega$ using the method of least squares, yielding the normal equations:\n$$\n\\omega = (M^{\\mathsf{T}}M)^{-1}M^{\\mathsf{T}}b\n$$\nUsing the provided numerical data for $t_0=1\\,\\mathrm{s}$:\n$v_{BA} = v_B - v_A = [-2.79844760, -2.77150792, 1.92207400]^{\\mathsf{T}}\\,\\mathrm{m/s}$.\n$v_{CA} = v_C - v_A = [7.58194200, -0.15249460, -1.98315000]^{\\mathsf{T}}\\,\\mathrm{m/s}$.\nThe matrix $M$ is constructed from $r_{BA}(t_0)$ and $r_{CA}(t_0)$. Solving this system yields the components of $\\omega(t_0)$.\n\nSimilarly, the acceleration difference between two points is given by:\n$$\na_P - a_Q = \\dot{\\omega} \\times (r_P - r_Q) + \\omega \\times (\\omega \\times (r_P - r_Q))\n$$\nwhere $\\dot{\\omega}$ is the instantaneous angular acceleration.\nLet $a_{PQ} = a_P - a_Q$ and $r_{PQ} = r_P - r_Q$. We rearrange the equation to isolate the term with $\\dot{\\omega}$:\n$$\na_{PQ} - \\omega \\times (\\omega \\times r_{PQ}) = \\dot{\\omega} \\times r_{PQ}\n$$\nLet's define a modified acceleration difference vector $a'_{PQ} = a_{PQ} - \\omega \\times (\\omega \\times r_{PQ})$. The equation becomes $a'_{PQ} = \\dot{\\omega} \\times r_{PQ}$, which has the same mathematical form as the velocity relation.\nWe can therefore construct an analogous linear system for $\\dot{\\omega}$:\n$$\n\\begin{pmatrix} a'_{BA} \\\\ a'_{CA} \\end{pmatrix} = \\begin{pmatrix} -S(r_{BA}) \\\\ -S(r_{CA}) \\end{pmatrix} \\dot{\\omega}\n$$\nThis system is $b' = M\\dot{\\omega}$, where the matrix M is the same as before. The solution is:\n$$\n\\dot{\\omega} = (M^{\\mathsf{T}}M)^{-1}M^{\\mathsf{T}}b'\n$$\nTo solve this, we first calculate the vectors $a'_{BA}$ and $a'_{CA}$ using the provided acceleration data and the value of $\\omega$ found in the first step.\n$a_{BA} = a_B - a_A = [4.63523170, -6.86600590, -1.14263966]^{\\mathsf{T}}\\,\\mathrm{m/s^2}$.\n$a_{CA} = a_C - a_A = [6.80619733, 21.55787662, -2.46237790]^{\\mathsf{T}}\\,\\mathrm{m/s^2}$.\nThe term $\\omega \\times (\\omega \\times r)$ is calculated using the vector triple product identity: $\\omega \\times (\\omega \\times r) = (\\omega \\cdot r)\\omega - (\\omega \\cdot \\omega)r$.\nNumerically solving these two linear systems yields the required vectors.\n\nFor $\\omega(t_0)$:\nThe least-squares solution gives $\\omega(t_0) = [0.540302, 0.841471, 2.000000]^{\\mathsf{T}}\\,\\mathrm{rad/s}$.\n\nFor $\\dot{\\omega}(t_0)$:\nUsing the computed $\\omega(t_0)$, we calculate the vectors $a'_{BA}$ and $a'_{CA}$. The solution of the second linear system gives $\\dot{\\omega}(t_0) = [-1.682942, 1.080604, 2.000000]^{\\mathsf{T}}\\,\\mathrm{rad/s^2}$.\n\nRounding the components to four significant figures as requested:\n$\\omega_x = 0.5403\\,\\mathrm{rad/s}$\n$\\omega_y = 0.8415\\,\\mathrm{rad/s}$\n$\\omega_z = 2.000\\,\\mathrm{rad/s}$\n$\\dot{\\omega}_x = -1.683\\,\\mathrm{rad/s^2}$\n$\\dot{\\omega}_y = 1.081\\,\\mathrm{rad/s^2}$\n$\\dot{\\omega}_z = 2.000\\,\\mathrm{rad/s^2}$\n\nThe final answer is presented as a row matrix of these six components.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5403  0.8415  2.000  -1.683  1.081  2.000\n\\end{pmatrix}\n}\n$$", "id": "2914495"}, {"introduction": "In both experimental and computational mechanics, measured displacements often contain a mixture of true material deformation and a superimposed, non-physical rigid body motion. This hands-on exercise ([@problem_id:2914458]) introduces a powerful method to solve this common problem by finding the best-fit rigid transformation that aligns a deformed set of points back to its reference configuration. Mastering this least-squares procedure is crucial for accurately extracting strain and stress fields from raw displacement data, a fundamental task in material characterization and model validation.", "problem": "You are given a set of material points (nodes) with known reference positions and measured displacements that are contaminated by an unknown rigid body motion. Your task is to derive, implement, and evaluate a least-squares procedure that identifies the best-fit rigid motion and removes it from the measured displacement field, leaving only the corrected (non-rigid) displacement. Work entirely within the kinematics of rigid body motion in materials mechanics, and derive all necessary computations from fundamental principles.\n\nStarting point and definitions (fundamental base):\n- A rigid body motion in spatial dimension $d$ is described by a rotation matrix $\\mathbf{R} \\in \\mathrm{SO}(d)$ (the special orthogonal group, so $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$ and $\\det \\mathbf{R} = 1$) and a translation vector $\\mathbf{t} \\in \\mathbb{R}^d$.\n- For a reference point $\\mathbf{x}_i \\in \\mathbb{R}^d$, the rigidly moved position is $\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}$, and the corresponding rigid displacement is $\\left(\\mathbf{R} - \\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t}$.\n- The measured displacement at node $i$ is $\\mathbf{u}_i^{\\mathrm{meas}} \\in \\mathbb{R}^d$, and the measured deformed position is $\\mathbf{y}_i = \\mathbf{x}_i + \\mathbf{u}_i^{\\mathrm{meas}}$.\n\nProblem requirement:\n- From first principles, pose and solve the constrained least-squares problem that identifies the best-fit $(\\mathbf{R}, \\mathbf{t})$ by minimizing the sum of squared residuals between the measured deformed positions $\\mathbf{y}_i$ and the rigidly transformed reference positions $\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}$, subject to $\\mathbf{R} \\in \\mathrm{SO}(d)$.\n- Derive the translation $\\mathbf{t}$ in terms of the centroids of $\\{\\mathbf{x}_i\\}$ and $\\{\\mathbf{y}_i\\}$ for fixed $\\mathbf{R}$, and derive the optimal $\\mathbf{R}$ using only the orthogonality constraints and least-squares optimality (no shortcut formulas may be assumed in the problem statement).\n- After identifying $(\\mathbf{R}, \\mathbf{t})$, compute the rigid part of the displacement at each node as $\\mathbf{u}_i^{\\mathrm{rigid}} = \\left(\\mathbf{R} - \\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t}$, and obtain the corrected displacement as $\\mathbf{u}_i^{\\mathrm{corr}} = \\mathbf{u}_i^{\\mathrm{meas}} - \\mathbf{u}_i^{\\mathrm{rigid}}$.\n- Quantify the residual by the root-mean-square (RMS) norm of the corrected displacements, i.e., $\\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\lVert \\mathbf{u}_i^{\\mathrm{corr}} \\rVert_2^2}$.\n- Report the principal rotation angle associated with $\\mathbf{R}$:\n  - For $d=2$, report the unique angle $\\theta \\in [0,\\pi]$ such that $\\mathbf{R} = \\begin{bmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{bmatrix}$.\n  - For $d=3$, report $\\theta \\in [0,\\pi]$ defined by $\\cos\\theta = \\frac{\\mathrm{tr}(\\mathbf{R}) - 1}{2}$.\n- Physical units: All lengths must be treated in meters $\\mathrm{m}$ and the reported RMS residual must be in meters $\\mathrm{m}$. All angles must be reported in radians $\\mathrm{rad}$.\n\nEdge-case policy:\n- If the data are degenerate (e.g., all centered points coincide so that the covariance has deficient rank), you must still return a valid $\\mathbf{R} \\in \\mathrm{SO}(d)$ and $\\mathbf{t} \\in \\mathbb{R}^d$ that minimize the least-squares objective. In the completely uninformative case where all centered reference points are zero, it is acceptable to return $\\mathbf{R} = \\mathbf{I}$ and $\\mathbf{t}$ equal to the centroid difference.\n\nTest suite:\nFor each test case below, synthesize the measured displacements using the provided parameters, then estimate $(\\mathbf{R}, \\mathbf{t})$ from the synthesized measurements only (do not use the contamination parameters directly in the estimation), correct the displacements, and report the outputs as specified.\n\n- Test case $1$ (two-dimensional, general rigid motion with a small non-rigid component):\n  - Dimension $d = 2$.\n  - Reference nodes in meters $\\mathrm{m}$: $\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (1, 0)$, $\\mathbf{x}_3 = (1, 1)$, $\\mathbf{x}_4 = (0, 1)$.\n  - Rigid motion parameters: rotation angle $\\theta = 0.2$ radians $\\mathrm{rad}$ about the out-of-plane axis, translation $\\mathbf{t} = (0.05, -0.03)$ meters $\\mathrm{m}$.\n  - Small non-rigid mapping: $\\mathbf{u}^{\\mathrm{true}}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$ with $\\mathbf{B} = \\mathrm{diag}(0.001, -0.0005)$ (unitless).\n  - Measured displacement: $\\mathbf{u}_i^{\\mathrm{meas}} = \\left(\\mathbf{R}(\\theta)-\\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t} + \\mathbf{B}\\mathbf{x}_i$.\n\n- Test case $2$ (three-dimensional, general axis-angle rigid motion with a small non-rigid component):\n  - Dimension $d = 3$.\n  - Reference nodes in meters $\\mathrm{m}$: $\\mathbf{x}_1 = (0, 0, 0)$, $\\mathbf{x}_2 = (1, 0, 0)$, $\\mathbf{x}_3 = (0, 1, 0)$, $\\mathbf{x}_4 = (0, 0, 1)$, $\\mathbf{x}_5 = (1, 1, 1)$.\n  - Rigid motion parameters: axis $\\mathbf{a} = \\frac{1}{\\sqrt{14}}(1, 2, 3)$ (unitless), angle $\\theta = 0.3$ radians $\\mathrm{rad}$, translation $\\mathbf{t} = (-0.02, 0.04, 0.03)$ meters $\\mathrm{m}$.\n  - Rotation via Rodrigues' formula: $\\mathbf{R} = \\cos\\theta\\,\\mathbf{I} + \\sin\\theta\\,[\\mathbf{a}]_\\times + (1-\\cos\\theta)\\,\\mathbf{a}\\mathbf{a}^\\mathsf{T}$, where $[\\mathbf{a}]_\\times$ is the skew-symmetric matrix such that $[\\mathbf{a}]_\\times \\mathbf{v} = \\mathbf{a} \\times \\mathbf{v}$.\n  - Small non-rigid mapping: $\\mathbf{u}^{\\mathrm{true}}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$ with $\\mathbf{B} = \\mathrm{diag}(0.0008, -0.0006, 0.0004)$ (unitless).\n  - Measured displacement: $\\mathbf{u}_i^{\\mathrm{meas}} = \\left(\\mathbf{R}-\\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t} + \\mathbf{B}\\mathbf{x}_i$.\n\n- Test case $3$ (two-dimensional, pure translation):\n  - Dimension $d = 2$.\n  - Reference nodes in meters $\\mathrm{m}$: $\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (2, 0)$, $\\mathbf{x}_3 = (0, 2)$.\n  - Rigid motion parameters: rotation angle $\\theta = 0$ radians $\\mathrm{rad}$, translation $\\mathbf{t} = (0.1, -0.05)$ meters $\\mathrm{m}$.\n  - Non-rigid mapping: $\\mathbf{B} = \\mathbf{0}$.\n  - Measured displacement: $\\mathbf{u}_i^{\\mathrm{meas}} = \\left(\\mathbf{R}(\\theta)-\\mathbf{I}\\right)\\mathbf{x}_i + \\mathbf{t}$.\n\n- Test case $4$ (three-dimensional, degenerate geometry: all nodes coincident):\n  - Dimension $d = 3$.\n  - Reference nodes in meters $\\mathrm{m}$: $\\mathbf{x}_1 = (2, 2, 2)$, $\\mathbf{x}_2 = (2, 2, 2)$, $\\mathbf{x}_3 = (2, 2, 2)$, $\\mathbf{x}_4 = (2, 2, 2)$.\n  - Rigid motion parameters: choose any rotation (it is unidentifiable here); translation $\\mathbf{t} = (0.01, 0.02, -0.03)$ meters $\\mathrm{m}$.\n  - Non-rigid mapping: $\\mathbf{B} = \\mathbf{0}$.\n  - Measured displacement: $\\mathbf{u}_i^{\\mathrm{meas}} = \\mathbf{t}$.\n\nRequired outputs:\n- For each test case $k \\in \\{1,2,3,4\\}$, compute and return a pair of floats:\n  - The principal rotation angle magnitude $\\theta_k$ in radians $\\mathrm{rad}$, as defined above.\n  - The RMS norm of the corrected displacements in meters $\\mathrm{m}$, i.e., $\\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\lVert \\mathbf{u}_i^{\\mathrm{corr}} \\rVert_2^2}$.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Concatenate the results for all test cases in order, flattening the list, e.g., $[\\theta_1,\\mathrm{RMS}_1,\\theta_2,\\mathrm{RMS}_2,\\theta_3,\\mathrm{RMS}_3,\\theta_4,\\mathrm{RMS}_4]$. All angles must be in radians $\\mathrm{rad}$ and all RMS values must be in meters $\\mathrm{m}$.", "solution": "The problem requires the derivation and implementation of a least-squares procedure to determine the rigid body motion component within a measured displacement field. The solution must be derived from first principles of rigid body kinematics and optimization.\n\nLet the set of $N$ reference positions be $\\{\\mathbf{x}_i \\in \\mathbb{R}^d\\}_{i=1}^N$ and the corresponding measured deformed positions be $\\{\\mathbf{y}_i \\in \\mathbb{R}^d\\}_{i=1}^N$, where $d$ is the spatial dimension. A rigid body motion is defined by a rotation matrix $\\mathbf{R} \\in \\mathrm{SO}(d)$ and a translation vector $\\mathbf{t} \\in \\mathbb{R}^d$. The special orthogonal group $\\mathrm{SO}(d)$ consists of matrices satisfying $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$ and $\\det(\\mathbf{R}) = 1$. The objective is to find the pair $(\\mathbf{R}, \\mathbf{t})$ that minimizes the sum of squared Euclidean distances between the measured positions $\\mathbf{y}_i$ and the rigidly transformed reference positions $\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}$. This defines the constrained least-squares problem:\n$$ \\underset{\\mathbf{R} \\in \\mathrm{SO}(d), \\mathbf{t} \\in \\mathbb{R}^d}{\\text{minimize}} \\quad S(\\mathbf{R}, \\mathbf{t}) = \\sum_{i=1}^{N} \\lVert \\mathbf{y}_i - (\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}) \\rVert_2^2 $$\n\nFirst, we solve for the optimal translation vector $\\mathbf{t}$ for a fixed rotation matrix $\\mathbf{R}$. The minimum of the quadratic function $S$ with respect to $\\mathbf{t}$ is found by setting its gradient to zero:\n$$ \\frac{\\partial S}{\\partial \\mathbf{t}} = \\sum_{i=1}^{N} \\frac{\\partial}{\\partial \\mathbf{t}} \\left( (\\mathbf{y}_i - \\mathbf{R}\\mathbf{x}_i - \\mathbf{t})^\\mathsf{T} (\\mathbf{y}_i - \\mathbf{R}\\mathbf{x}_i - \\mathbf{t}) \\right) = \\sum_{i=1}^{N} -2(\\mathbf{y}_i - \\mathbf{R}\\mathbf{x}_i - \\mathbf{t}) = \\mathbf{0} $$\nThis simplifies to:\n$$ \\sum_{i=1}^{N} \\mathbf{y}_i - \\mathbf{R}\\sum_{i=1}^{N} \\mathbf{x}_i - N\\mathbf{t} = \\mathbf{0} $$\nLet us define the centroids of the reference and deformed point clouds as $\\bar{\\mathbf{x}} = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{x}_i$ and $\\bar{\\mathbf{y}} = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{y}_i$. Substituting these into the equation yields:\n$$ N\\bar{\\mathbf{y}} - N\\mathbf{R}\\bar{\\mathbf{x}} - N\\mathbf{t} = \\mathbf{0} $$\n$$ \\mathbf{t} = \\bar{\\mathbf{y}} - \\mathbf{R}\\bar{\\mathbf{x}} $$\nThis demonstrates that the optimal translation vector $\\mathbf{t}^*$ maps the centroid of the rotated reference configuration to the centroid of the deformed configuration.\n\nNext, we substitute $\\mathbf{t}^*$ back into the objective function $S$. Let us define the centered coordinate vectors as $\\mathbf{x}'_i = \\mathbf{x}_i - \\bar{\\mathbf{x}}$ and $\\mathbf{y}'_i = \\mathbf{y}_i - \\bar{\\mathbf{y}}$. The term inside the norm becomes:\n$$ \\mathbf{y}_i - (\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}^*) = (\\mathbf{y}_i - \\bar{\\mathbf{y}}) - \\mathbf{R}(\\mathbf{x}_i - \\bar{\\mathbf{x}}) = \\mathbf{y}'_i - \\mathbf{R}\\mathbf{x}'_i $$\nThe minimization problem is now reduced to finding the optimal rotation $\\mathbf{R}$:\n$$ \\underset{\\mathbf{R} \\in \\mathrm{SO}(d)}{\\text{minimize}} \\quad S(\\mathbf{R}) = \\sum_{i=1}^N \\lVert \\mathbf{y}'_i - \\mathbf{R}\\mathbf{x}'_i \\rVert_2^2 $$\nWe expand the squared norm:\n$$ \\lVert \\mathbf{y}'_i - \\mathbf{R}\\mathbf{x}'_i \\rVert_2^2 = (\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{y}'_i - 2(\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i + (\\mathbf{x}'_i)^\\mathsf{T}\\mathbf{R}^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i = \\lVert \\mathbf{y}'_i \\rVert_2^2 - 2(\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i + \\lVert \\mathbf{x}'_i \\rVert_2^2 $$\nwhere we used the property $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$. Summing over all points, the objective function becomes:\n$$ S(\\mathbf{R}) = \\sum_{i=1}^N \\lVert \\mathbf{y}'_i \\rVert_2^2 + \\sum_{i=1}^N \\lVert \\mathbf{x}'_i \\rVert_2^2 - 2 \\sum_{i=1}^N (\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i $$\nThe first two terms are constant with respect to $\\mathbf{R}$. Therefore, minimizing $S(\\mathbf{R})$ is equivalent to maximizing the term $\\sum_{i=1}^N (\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i$. Using the cyclic property of the trace operator, we can rewrite this as:\n$$ \\sum_{i=1}^N \\text{tr}((\\mathbf{y}'_i)^\\mathsf{T}\\mathbf{R}\\mathbf{x}'_i) = \\sum_{i=1}^N \\text{tr}(\\mathbf{R}\\mathbf{x}'_i(\\mathbf{y}'_i)^\\mathsf{T}) = \\text{tr} \\left( \\mathbf{R} \\sum_{i=1}^N \\mathbf{x}'_i(\\mathbf{y}'_i)^\\mathsf{T} \\right) $$\nLet us define the $d \\times d$ covariance matrix $\\mathbf{H} = \\sum_{i=1}^N \\mathbf{x}'_i(\\mathbf{y}'_i)^\\mathsf{T}$. The problem is now to find $\\mathbf{R} \\in \\mathrm{SO}(d)$ that maximizes $\\text{tr}(\\mathbf{R}\\mathbf{H})$.\n\nTo solve this constrained maximization problem, we employ the Singular Value Decomposition (SVD) of $\\mathbf{H}$, which is $\\mathbf{H} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\mathsf{T}$, where $\\mathbf{U}$ and $\\mathbf{V}$ are orthogonal matrices and $\\boldsymbol{\\Sigma}$ is a diagonal matrix of non-negative singular values.\n$$ \\text{tr}(\\mathbf{R}\\mathbf{H}) = \\text{tr}(\\mathbf{R}\\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\mathsf{T}) = \\text{tr}(\\mathbf{V}^\\mathsf{T}\\mathbf{R}\\mathbf{U}\\boldsymbol{\\Sigma}) $$\nLet $\\mathbf{Z} = \\mathbf{V}^\\mathsf{T}\\mathbf{R}\\mathbf{U}$. Since $\\mathbf{U}$, $\\mathbf{V}$, and $\\mathbf{R}$ are orthogonal, $\\mathbf{Z}$ is also an orthogonal matrix. The objective becomes maximizing $\\text{tr}(\\mathbf{Z}\\boldsymbol{\\Sigma}) = \\sum_{j=1}^d Z_{jj}\\sigma_j$. Since $\\mathbf{Z}$ is orthogonal, $|Z_{jj}| \\le 1$, and singular values $\\sigma_j \\ge 0$. The maximum value is obtained when $Z_{jj}$ are as large as possible, which is $Z_{jj}=1$. This is achieved if $\\mathbf{Z}=\\mathbf{I}$.\nFrom $\\mathbf{Z}=\\mathbf{I}$, we find the optimal rotation in the orthogonal group $\\mathrm{O}(d)$:\n$$ \\mathbf{V}^\\mathsf{T}\\mathbf{R}\\mathbf{U} = \\mathbf{I} \\implies \\mathbf{R} = \\mathbf{V}\\mathbf{I}\\mathbf{U}^\\mathsf{T} = \\mathbf{V}\\mathbf{U}^\\mathsf{T} $$\nWe must ensure that $\\mathbf{R} \\in \\mathrm{SO}(d)$, i.e., $\\det(\\mathbf{R})=1$. We have $\\det(\\mathbf{R}) = \\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T}) = \\det(\\mathbf{V})\\det(\\mathbf{U}^\\mathsf{T}) = \\det(\\mathbf{V})\\det(\\mathbf{U})$. SVD algorithms may yield $\\mathbf{U}$ and $\\mathbf{V}$ with determinants of either $+1$ or $-1$.\nIf $\\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T}) = 1$, then $\\mathbf{R} = \\mathbf{V}\\mathbf{U}^\\mathsf{T}$ is the correct solution.\nIf $\\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T}) = -1$, the solution corresponds to a reflection. The closest proper rotation is found by modifying $\\mathbf{R}$ to invert its determinant while minimally reducing the trace value $\\text{tr}(\\mathbf{R}\\mathbf{H})$. This is achieved by flipping the sign of the component associated with the smallest singular value. Assuming $\\sigma_d$ is the smallest singular value, the optimal solution in $\\mathrm{SO}(d)$ is:\n$$ \\mathbf{R} = \\mathbf{V} \\mathbf{S} \\mathbf{U}^\\mathsf{T}, \\quad \\text{where} \\quad \\mathbf{S} = \\text{diag}(1, 1, \\dots, 1, \\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T})) $$\nThis ensures $\\det(\\mathbf{R}) = \\det(\\mathbf{V})\\det(\\mathbf{S})\\det(\\mathbf{U}^\\mathsf{T}) = \\det(\\mathbf{V}\\mathbf{U}^\\mathsf{T})\\det(\\mathbf{S}) = (-1)(-1) = 1$ in the problematic case.\n\nOnce the optimal $(\\mathbf{R}, \\mathbf{t})$ are found, the rigid displacement at node $i$ is $\\mathbf{u}_i^{\\mathrm{rigid}} = (\\mathbf{R} - \\mathbf{I})\\mathbf{x}_i + \\mathbf{t}$. The corrected (non-rigid) displacement is the difference between the measured and rigid displacements:\n$$ \\mathbf{u}_i^{\\mathrm{corr}} = \\mathbf{u}_i^{\\mathrm{meas}} - \\mathbf{u}_i^{\\mathrm{rigid}} = (\\mathbf{y}_i - \\mathbf{x}_i) - ((\\mathbf{R} - \\mathbf{I})\\mathbf{x}_i + \\mathbf{t}) = \\mathbf{y}_i - (\\mathbf{R}\\mathbf{x}_i + \\mathbf{t}) $$\nThe residual error is quantified by the Root-Mean-Square (RMS) norm of these corrected displacements:\n$$ \\text{RMS} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^N \\lVert \\mathbf{u}_i^{\\mathrm{corr}} \\rVert_2^2} $$\nThe principal rotation angle $\\theta \\in [0, \\pi]$ is computed from the trace of the estimated rotation matrix $\\mathbf{R}$. For $d=2$, $\\theta = \\arccos(\\frac{\\mathrm{tr}(\\mathbf{R})}{2})$. For $d=3$, $\\theta = \\arccos(\\frac{\\mathrm{tr}(\\mathbf{R}) - 1}{2})$. In the degenerate case where all centered reference points are zero, the covariance matrix $\\mathbf{H}$ is the zero matrix. Its SVD is not unique, but a standard implementation will typically yield $\\mathbf{U}=\\mathbf{V}=\\mathbf{I}$, which leads to $\\mathbf{R}=\\mathbf{I}$ and $\\theta=0$, satisfying the problem's edge-case policy.", "answer": "```python\nimport numpy as np\n\ndef estimate_rigid_motion(X, Y):\n    \"\"\"\n    Estimates the rigid body motion (R, t) that best aligns point set X to Y.\n    \n    Args:\n        X (np.ndarray): Reference points, shape (d, N).\n        Y (np.ndarray): Deformed points, shape (d, N).\n\n    Returns:\n        tuple[np.ndarray, np.ndarray]: Estimated rotation matrix R and translation vector t.\n    \"\"\"\n    d, N = X.shape\n    \n    # 1. Compute centroids\n    x_bar = np.mean(X, axis=1, keepdims=True)\n    y_bar = np.mean(Y, axis=1, keepdims=True)\n    \n    # 2. Compute centered coordinates\n    X_prime = X - x_bar\n    Y_prime = Y - y_bar\n    \n    # 3. Compute covariance matrix H\n    H = X_prime @ Y_prime.T\n    \n    # 4. Compute SVD of H\n    U, s, Vt = np.linalg.svd(H)\n    \n    # 5. Compute optimal rotation R\n    R = Vt.T @ U.T\n    \n    # 6. Check for reflection and correct if necessary\n    if np.linalg.det(R)  0:\n        S = np.identity(d)\n        S[d-1, d-1] = -1\n        R = Vt.T @ S @ U.T\n\n    # 7. Compute optimal translation t\n    t = y_bar - R @ x_bar\n    \n    return R, t.flatten()\n\ndef solve():\n    \"\"\"\n    Solves the problem for all specified test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (d=2)\n        {\n            \"d\": 2,\n            \"x\": np.array([[0, 0], [1, 0], [1, 1], [0, 1]], dtype=float),\n            \"rot_params\": {\"theta\": 0.2},\n            \"t_true\": np.array([0.05, -0.03], dtype=float),\n            \"B\": np.diag([0.001, -0.0005])\n        },\n        # Test case 2 (d=3)\n        {\n            \"d\": 3,\n            \"x\": np.array([[0, 0, 0], [1, 0, 0], [0, 1, 0], [0, 0, 1], [1, 1, 1]], dtype=float),\n            \"rot_params\": {\"axis\": np.array([1, 2, 3]) / np.sqrt(14), \"theta\": 0.3},\n            \"t_true\": np.array([-0.02, 0.04, 0.03], dtype=float),\n            \"B\": np.diag([0.0008, -0.0006, 0.0004])\n        },\n        # Test case 3 (d=2, pure translation)\n        {\n            \"d\": 2,\n            \"x\": np.array([[0, 0], [2, 0], [0, 2]], dtype=float),\n            \"rot_params\": {\"theta\": 0.0},\n            \"t_true\": np.array([0.1, -0.05], dtype=float),\n            \"B\": np.zeros((2, 2))\n        },\n        # Test case 4 (d=3, degenerate geometry)\n        {\n            \"d\": 3,\n            \"x\": np.array([[2, 2, 2], [2, 2, 2], [2, 2, 2], [2, 2, 2]], dtype=float),\n            \"rot_params\": {\"axis\": np.array([1, 0, 0]), \"theta\": 0.1}, # Axis/angle irrelevant\n            \"t_true\": np.array([0.01, 0.02, -0.03], dtype=float),\n            \"B\": np.zeros((3, 3))\n        }\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        d = case[\"d\"]\n        X = case[\"x\"].T # Transpose to get shape (d, N)\n        N = X.shape[1]\n        t_true = case[\"t_true\"]\n        B = case[\"B\"]\n        \n        # Generate true rotation matrix\n        if d == 2:\n            theta_true = case[\"rot_params\"][\"theta\"]\n            c, s = np.cos(theta_true), np.sin(theta_true)\n            R_true = np.array([[c, -s], [s, c]])\n        else: # d == 3\n            theta_true = case[\"rot_params\"][\"theta\"]\n            axis = case[\"rot_params\"][\"axis\"]\n            c, s = np.cos(theta_true), np.sin(theta_true)\n            ax = axis[0]\n            ay = axis[1]\n            az = axis[2]\n            # Skew-symmetric matrix\n            a_cross = np.array([[0, -az, ay], [az, 0, -ax], [-ay, ax, 0]])\n            # Rodrigues' formula\n            R_true = c * np.identity(3) + s * a_cross + (1 - c) * np.outer(axis, axis)\n        \n        # Synthesize measured displacements and deformed positions\n        u_rigid = (R_true - np.identity(d)) @ X\n        u_non_rigid = B @ X\n        U_meas = u_rigid + u_non_rigid + t_true.reshape(d, 1)\n        u_meas = U_meas.T\n        Y = X + U_meas\n        \n        # Estimate rigid motion\n        R_est, t_est = estimate_rigid_motion(X, Y)\n        \n        # Compute corrected displacements\n        U_rigid_est = (R_est - np.identity(d)) @ X + t_est.reshape(d, 1)\n        U_corr = U_meas - U_rigid_est\n        \n        # Compute RMS of corrected displacements\n        rms_corr = np.sqrt(np.mean(np.sum(U_corr**2, axis=0)))\n        \n        # Compute principal rotation angle\n        # Clip argument to arccos to handle potential floating point inaccuracies\n        if d == 2:\n            trace_R = np.trace(R_est)\n            cos_theta = np.clip(trace_R / 2.0, -1.0, 1.0)\n            theta_est = np.arccos(cos_theta)\n        else: # d == 3\n            trace_R = np.trace(R_est)\n            cos_theta = np.clip((trace_R - 1.0) / 2.0, -1.0, 1.0)\n            theta_est = np.arccos(cos_theta)\n            \n        results.extend([theta_est, rms_corr])\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "2914458"}]}