{"hands_on_practices": [{"introduction": "PID tuning rules, such as the Ziegler-Nichols methods, provide a direct link between an identified process model and the controller parameters. Since any model is an approximation of reality, it is crucial to understand how errors in model identification propagate to the final controller design. This practice [@problem_id:2731985] uses first-order sensitivity analysis to derive the analytical relationship between small errors in the identified process dynamics and the resulting fractional errors in the tuned PID parameters, offering fundamental insight into the robustness of the tuning procedure itself.", "problem": "A thermal process is well approximated by a First Order Plus Dead Time (FOPDT) model with transfer function $G_{p}(s)=\\dfrac{K \\exp(-L s)}{T s+1}$, where $K$ is the steady-state gain, $L$ is the apparent input-output dead-time, and $T$ is the dominant time constant. The controller is designed as a Proportional-Integral-Derivative (PID) controller using the classical Ziegler–Nichols (Z-N) reaction-curve tuning rules based on the FOPDT parameters. Assume that $K$ is known exactly from steady-state data, but the identified dynamics $(L,T)$ are affected by small biases $(\\Delta L,\\Delta T)$ due to measurement and fitting errors. Using first-order sensitivity analysis (i.e., total differentials and linearization), derive the first-order approximations of the fractional errors in the tuned parameters $(K_{p},T_{i},T_{d})$ induced by $(\\Delta L,\\Delta T)$ under the Z-N reaction-curve method for PID control. Express your final result as a single row vector containing $\\Delta K_{p}/K_{p}$, $\\Delta T_{i}/T_{i}$, and $\\Delta T_{d}/T_{d}$ in terms of $L$, $T$, $\\Delta L$, and $\\Delta T$. No numerical evaluation or rounding is required, and no units should be included in the final expression.", "solution": "The First Order Plus Dead Time (FOPDT) model is $G_{p}(s)=\\dfrac{K \\exp(-L s)}{T s+1}$ with process gain $K$, dead time $L$, and time constant $T$. Under the classical Ziegler–Nichols (Z-N) reaction-curve tuning rules for Proportional-Integral-Derivative (PID) control, the tuned controller parameters are deterministic functions of the identified FOPDT parameters. We take as foundational that these rules express $(K_{p},T_{i},T_{d})$ as smooth functions of $(K,L,T)$, and we assume the process gain $K$ is known exactly (so $\\Delta K=0$). The goal is to propagate small identification errors $(\\Delta L,\\Delta T)$ into the corresponding small changes $(\\Delta K_{p},\\Delta T_{i},\\Delta T_{d})$ using first-order sensitivity analysis, i.e., total differentials.\n\nFor a scalar function $f(L,T)$ that depends smoothly on $L$ and $T$, the first-order variation due to small changes $(\\Delta L,\\Delta T)$ is given by the total differential\n$$\n\\Delta f \\approx \\frac{\\partial f}{\\partial L}\\,\\Delta L+\\frac{\\partial f}{\\partial T}\\,\\Delta T,\n$$\nand the corresponding fractional variation is\n$$\n\\frac{\\Delta f}{f}\\approx \\frac{1}{f}\\frac{\\partial f}{\\partial L}\\,\\Delta L+\\frac{1}{f}\\frac{\\partial f}{\\partial T}\\,\\Delta T.\n$$\n\nThe classical Ziegler–Nichols reaction-curve rules for a PID controller on an FOPDT process can be written as\n$$\nK_{p}=\\alpha\\,\\frac{T}{K\\,L},\\qquad T_{i}=\\beta\\,L,\\qquad T_{d}=\\gamma\\,L,\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are positive constants. For the conventional Ziegler–Nichols PID settings, these constants are\n$$\n\\alpha=1.2,\\qquad \\beta=2,\\qquad \\gamma=0.5.\n$$\nWe proceed symbolically; the constants will cancel in the fractional sensitivities except where parameters depend on a single variable.\n\nConsider $K_{p}(L,T)=\\alpha\\,\\dfrac{T}{K\\,L}$. Its partial derivatives are\n$$\n\\frac{\\partial K_{p}}{\\partial T}=\\frac{\\alpha}{K\\,L}=\\frac{K_{p}}{T},\\qquad\n\\frac{\\partial K_{p}}{\\partial L}=-\\alpha\\,\\frac{T}{K\\,L^{2}}=-\\frac{K_{p}}{L}.\n$$\nThus the first-order change is\n$$\n\\Delta K_{p}\\approx \\frac{K_{p}}{T}\\,\\Delta T-\\frac{K_{p}}{L}\\,\\Delta L,\n$$\nand the fractional change is\n$$\n\\frac{\\Delta K_{p}}{K_{p}}\\approx \\frac{\\Delta T}{T}-\\frac{\\Delta L}{L}.\n$$\n\nNext, $T_{i}(L)=\\beta\\,L$ depends only on $L$, so\n$$\n\\frac{\\partial T_{i}}{\\partial L}=\\beta=\\frac{T_{i}}{L},\n$$\nand hence\n$$\n\\Delta T_{i}\\approx \\frac{T_{i}}{L}\\,\\Delta L\\quad\\Rightarrow\\quad \\frac{\\Delta T_{i}}{T_{i}}\\approx \\frac{\\Delta L}{L}.\n$$\n\nSimilarly, $T_{d}(L)=\\gamma\\,L$ yields\n$$\n\\frac{\\partial T_{d}}{\\partial L}=\\gamma=\\frac{T_{d}}{L},\n$$\nso\n$$\n\\Delta T_{d}\\approx \\frac{T_{d}}{L}\\,\\Delta L\\quad\\Rightarrow\\quad \\frac{\\Delta T_{d}}{T_{d}}\\approx \\frac{\\Delta L}{L}.\n$$\n\nCollecting these results, the first-order fractional error vector is\n$$\n\\begin{pmatrix}\n\\dfrac{\\Delta K_{p}}{K_{p}}  \\dfrac{\\Delta T_{i}}{T_{i}}  \\dfrac{\\Delta T_{d}}{T_{d}}\n\\end{pmatrix}\n\\approx\n\\begin{pmatrix}\n\\dfrac{\\Delta T}{T}-\\dfrac{\\Delta L}{L}  \\dfrac{\\Delta L}{L}  \\dfrac{\\Delta L}{L}\n\\end{pmatrix}.\n$$\nThis expression is independent of the particular numerical values of $\\alpha$, $\\beta$, and $\\gamma$ so long as the functional dependencies $K_{p}\\propto T/L$, $T_{i}\\propto L$, and $T_{d}\\propto L$ hold, which they do for the classical Ziegler–Nichols reaction-curve PID rules. The assumption $\\Delta K=0$ is critical to eliminate any additional contribution from uncertainty in $K$; if $\\Delta K\\neq 0$, one would add the term $-(\\Delta K/K)$ to $\\Delta K_{p}/K_{p}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{\\Delta K_{p}}{K_{p}}  \\dfrac{\\Delta T_{i}}{T_{i}}  \\dfrac{\\Delta T_{d}}{T_{d}}\\end{pmatrix}=\\begin{pmatrix}\\dfrac{\\Delta T}{T}-\\dfrac{\\Delta L}{L}  \\dfrac{\\Delta L}{L}  \\dfrac{\\Delta L}{L}\\end{pmatrix}}$$", "id": "2731985"}, {"introduction": "Building on the concept of model uncertainty, this exercise [@problem_id:2731986] addresses a common and critical scenario in process control: a change in the plant's steady-state gain after the controller has been commissioned. By applying Ziegler-Nichols open-loop tuning rules to a nominal model and then analyzing the system with the perturbed gain, you will calculate the resulting gain margin. This practice provides a concrete, quantitative measure of the system's stability robustness, bridging the gap between theoretical tuning and practical performance analysis.", "problem": "A single-input single-output process is well-approximated by a first-order-plus-dead-time (FOPDT) model with transfer function $P(s) = \\dfrac{K \\exp(-L s)}{T s + 1}$. The nominal reaction-curve identification provides $K = K_{0}$, $L = 1$, and $T = 4$, with $K_{0} = 2$. A Proportional-Integral (PI) controller is tuned using the Ziegler–Nichols (ZN) open-loop step-response method based on the nominal model. After the controller is implemented, the process gain increases by $20\\%$ (that is, $K$ becomes $1.2 K_{0}$), while $L$ and $T$ remain unchanged.\n\nStarting from the definitions of the loop transfer function, frequency response, and the gain margin (defined as the reciprocal of the open-loop magnitude at the phase-crossover frequency where the open-loop phase equals $-\\pi$), determine the resulting gain margin of the closed-loop with the fixed PI controller acting on the process with the increased gain. Assume angular frequency is measured in radians per second. Round your final numerical answer to four significant figures. Express the final answer as a pure number with no units.", "solution": "The problem statement is subjected to validation before any attempt at a solution is made.\n\nFirst, the givens are extracted verbatim from the problem statement:\n- Process model: First-order-plus-dead-time (FOPDT).\n- Process transfer function: $P(s) = \\dfrac{K \\exp(-L s)}{T s + 1}$.\n- Nominal model parameters: $K = K_{0} = 2$, $L = 1$, $T = 4$.\n- Controller type: Proportional-Integral (PI).\n- Tuning method: Ziegler–Nichols (ZN) open-loop step-response method.\n- Process parameter change: The process gain $K$ increases by $20\\%$ to $1.2 K_{0}$. The parameters $L$ and $T$ remain unchanged.\n- Objective: Determine the resulting gain margin ($GM$) of the closed-loop system.\n- Definition of Gain Margin: $GM$ is the reciprocal of the open-loop magnitude at the phase-crossover frequency, $\\omega_{pc}$, where the open-loop phase equals $-\\pi$.\n- Final answer requirement: Numerical value rounded to four significant figures.\n\nThe problem is scientifically grounded, using standard models (FOPDT), controllers (PI), and analysis techniques (frequency response, gain margin) from the field of control theory. It is well-posed, providing all necessary information to uniquely determine the controller parameters and analyze the stability of the modified system. The language is objective and precise. The task of evaluating the robustness of a control system to parameter variations is a standard and meaningful problem in engineering. Therefore, the problem is declared valid.\n\nThe solution proceeds as follows.\n\nStep 1: Determine the PI controller parameters.\nThe controller is tuned using the Ziegler-Nichols open-loop method based on the *nominal* FOPDT model parameters: $K_0=2$, $L=1$, and $T=4$.\nFor a PI controller, the ZN tuning rules are:\nProportional gain: $K_p = \\dfrac{0.9 T}{K_0 L}$\nIntegral time: $T_i = \\dfrac{L}{0.3} = \\dfrac{10}{3} L$\n\nSubstituting the nominal values:\n$K_p = \\dfrac{0.9 \\times 4}{2 \\times 1} = \\dfrac{3.6}{2} = 1.8$\n$T_i = \\dfrac{10}{3} \\times 1 = \\dfrac{10}{3}$\n\nThe transfer function of the PI controller is $C(s) = K_p \\left(1 + \\dfrac{1}{T_i s}\\right)$.\n$C(s) = 1.8 \\left(1 + \\dfrac{1}{(10/3) s}\\right) = 1.8 \\left(1 + \\dfrac{0.3}{s}\\right) = 1.8 \\dfrac{s + 0.3}{s}$\n\nStep 2: Define the new open-loop transfer function.\nAfter the controller is implemented, the process gain increases by $20\\%$. The new gain is $K' = 1.2 K_0 = 1.2 \\times 2 = 2.4$. The parameters $L=1$ and $T=4$ are unchanged.\nThe new process transfer function is $P'(s) = \\dfrac{2.4 \\exp(-s)}{4s + 1}$.\n\nThe open-loop transfer function of the system with the fixed controller and the modified process is $G_{OL}(s) = C(s) P'(s)$.\n$G_{OL}(s) = \\left(1.8 \\dfrac{s + 0.3}{s}\\right) \\left(\\dfrac{2.4 \\exp(-s)}{4s + 1}\\right) = \\dfrac{4.32 (s + 0.3) \\exp(-s)}{s(4s + 1)}$\n\nStep 3: Find the phase-crossover frequency, $\\omega_{pc}$.\nThe phase-crossover frequency $\\omega_{pc}$ is the frequency at which the phase of the open-loop frequency response is equal to $-\\pi$ radians.\nThe frequency response is obtained by setting $s = j\\omega$:\n$G_{OL}(j\\omega) = \\dfrac{4.32 (j\\omega + 0.3) \\exp(-j\\omega)}{j\\omega(4j\\omega + 1)}$\n\nThe phase angle of $G_{OL}(j\\omega)$ is the sum of the phases of the individual terms:\n$\\angle G_{OL}(j\\omega) = \\angle(4.32) + \\angle(j\\omega + 0.3) + \\angle(\\exp(-j\\omega)) - \\angle(j\\omega) - \\angle(4j\\omega + 1)$\n$\\angle G_{OL}(j\\omega) = 0 + \\arctan\\left(\\dfrac{\\omega}{0.3}\\right) - \\omega - \\dfrac{\\pi}{2} - \\arctan(4\\omega)$\n\nWe set this expression to $-\\pi$ to find $\\omega = \\omega_{pc}$:\n$\\arctan\\left(\\dfrac{\\omega_{pc}}{0.3}\\right) - \\omega_{pc} - \\dfrac{\\pi}{2} - \\arctan(4\\omega_{pc}) = -\\pi$\nRearranging the terms yields a transcendental equation for $\\omega_{pc}$:\n$\\dfrac{\\pi}{2} = \\omega_{pc} + \\arctan(4\\omega_{pc}) - \\arctan\\left(\\dfrac{\\omega_{pc}}{0.3}\\right)$\nThis equation must be solved numerically. Let $f(\\omega) = \\omega + \\arctan(4\\omega) - \\arctan(\\frac{10}{3}\\omega) - \\frac{\\pi}{2}$. We seek the root of $f(\\omega) = 0$.\nNumerical solution of this equation yields $\\omega_{pc} \\approx 1.5387$ rad/s.\n\nStep 4: Calculate the magnitude at the phase-crossover frequency.\nThe magnitude of the open-loop frequency response is:\n$|G_{OL}(j\\omega)| = \\dfrac{|4.32| |j\\omega + 0.3| |\\exp(-j\\omega)|}{|j\\omega| |4j\\omega + 1|} = \\dfrac{4.32 \\sqrt{\\omega^2 + 0.3^2}}{\\omega \\sqrt{(4\\omega)^2 + 1^2}}$\n$|G_{OL}(j\\omega)| = \\dfrac{4.32 \\sqrt{\\omega^2 + 0.09}}{\\omega \\sqrt{16\\omega^2 + 1}}$\n\nSubstitute $\\omega = \\omega_{pc} = 1.5387$:\n$|G_{OL}(j\\omega_{pc})| = \\dfrac{4.32 \\sqrt{(1.5387)^2 + 0.09}}{1.5387 \\sqrt{16(1.5387)^2 + 1}}$\n$|G_{OL}(j\\omega_{pc})| = \\dfrac{4.32 \\sqrt{2.3676 + 0.09}}{1.5387 \\sqrt{16(2.3676) + 1}} = \\dfrac{4.32 \\sqrt{2.4576}}{1.5387 \\sqrt{37.8816 + 1}}$\n$|G_{OL}(j\\omega_{pc})| = \\dfrac{4.32 \\times 1.5676}{1.5387 \\times \\sqrt{38.8816}} = \\dfrac{6.7721}{1.5387 \\times 6.2355} \\approx \\dfrac{6.7721}{9.5934}$\n$|G_{OL}(j\\omega_{pc})| \\approx 0.70591$\n\nStep 5: Calculate the Gain Margin.\nThe gain margin is defined as the reciprocal of this magnitude:\n$GM = \\dfrac{1}{|G_{OL}(j\\omega_{pc})|} = \\dfrac{1}{0.70591} \\approx 1.41662$\n\nFinally, rounding the result to four significant figures as required by the problem statement gives $1.417$.", "answer": "$$\\boxed{1.417}$$", "id": "2731986"}, {"introduction": "While gain and phase margins provide valuable point-wise measures of stability, the maximum sensitivity, $M_s$, offers a more comprehensive assessment of robustness by quantifying the peak amplification of disturbances over all frequencies. This computational exercise [@problem_id:2731936] tasks you with implementing a complete analysis pipeline: determining a plant's ultimate gain and period, applying the Ziegler-Nichols closed-loop tuning rules, and then numerically optimizing to find $M_s$. This practice develops essential skills in translating control theory concepts into a working algorithm for robust system evaluation.", "problem": "You are given a unity-feedback loop with open-loop transfer function $L(s)=C(s)G(s)$, where the plant is a First-Order Plus Dead Time (FOPDT) model $G(s)=K \\exp(-Ls)/( \\tau s + 1)$ and the controller is a Proportional-Integral-Derivative (PID) controller tuned by the Ziegler-Nichols (ZN) closed-loop ultimate method. The sensitivity function is $S(s)=1/(1+L(s))$, and the maximum sensitivity is defined as $M_s=\\max_{\\omega \\ge 0} \\lvert S(j\\omega)\\rvert$. Angles must be treated in radians.\n\nTask:\n- Starting from the definition of the frequency response and fundamental properties of the First-Order Plus Dead Time (FOPDT) model and the Proportional-Integral-Derivative (PID) controller, implement a program that:\n  - For each plant in the test suite, computes the ultimate frequency $\\omega_u$ by solving the phase-crossing condition for proportional-only feedback: $\\angle G(j\\omega_u) = -\\pi$.\n  - From $\\omega_u$, computes the ultimate period $P_u=2\\pi/\\omega_u$ and ultimate gain $K_u$ such that with proportional-only control $C(s)=K_u$, the loop gain magnitude at $\\omega_u$ is unity.\n  - Uses the Ziegler-Nichols (ZN) closed-loop ultimate tuning rules for a Proportional-Integral-Derivative (PID) controller to obtain the controller parameters from $K_u$ and $P_u$.\n  - Forms $L(j\\omega)=C(j\\omega)G(j\\omega)$ and computes $M_s=\\max_{\\omega \\ge 0}\\lvert S(j\\omega)\\rvert$ with $S(j\\omega)=1/(1+C(j\\omega)G(j\\omega))$ by numerical frequency-domain maximization over $\\omega \\in (0,\\infty)$.\n- Express all angles in radians, and all outputs as dimensionless real numbers.\n\nFundamental base you must use:\n- The frequency response of $G(s)$ on the imaginary axis, $G(j\\omega)=K \\exp(-j\\omega L)/(1+j\\omega \\tau)$.\n- The phase of $G(j\\omega)$, $\\angle G(j\\omega)=-\\omega L - \\arctan(\\omega \\tau)$, and its magnitude $\\lvert G(j\\omega)\\rvert = K/\\sqrt{1+(\\omega \\tau)^2}$.\n- The ultimate frequency $\\omega_u$ is the smallest positive solution of $\\angle G(j\\omega)=-\\pi$ for proportional-only feedback, that is, solve $\\omega L + \\arctan(\\omega \\tau)=\\pi$ for $\\omega0$.\n- The ultimate gain satisfies $K_u \\lvert G(j\\omega_u)\\rvert = 1$, hence $K_u=1/\\lvert G(j\\omega_u)\\rvert$.\n- The Ziegler-Nichols (ZN) closed-loop ultimate tuning rules for Proportional-Integral-Derivative (PID): $K_p = 0.6 K_u$, $T_i=P_u/2$, $T_d=P_u/8$, and $C(s)=K_p\\left(1 + \\frac{1}{T_i s} + T_d s\\right)$.\n- The sensitivity function $S(j\\omega)=1/(1+C(j\\omega)G(j\\omega))$ and $M_s=\\max_{\\omega \\ge 0} \\lvert S(j\\omega)\\rvert$.\n\nNumerical requirements:\n- For the maximization of $\\lvert S(j\\omega)\\rvert$ over $\\omega \\in (0,\\infty)$, perform a robust numerical search that covers multiple decades in frequency; a two-stage approach comprising a coarse logarithmic grid scan followed by local refinement is acceptable. Use radians for $\\omega$.\n- The final reported values of $M_s$ for each test case must be rounded to four decimal places.\n\nTest suite:\n- Use the following FOPDT parameter sets $(K,\\tau,L)$:\n  - Case $1$: $(K,\\tau,L)=(1.0,1.0,0.2)$\n  - Case $2$: $(K,\\tau,L)=(2.0,2.0,0.5)$\n  - Case $3$: $(K,\\tau,L)=(0.5,1.0,0.8)$\n  - Case $4$: $(K,\\tau,L)=(1.0,0.5,0.1)$\n  - Case $5$: $(K,\\tau,L)=(5.0,3.0,0.3)$\n  - Case $6$: $(K,\\tau,L)=(1.0,1.0,1.0)$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases listed above, for example, $\\left[\\text{ms}_1,\\text{ms}_2,\\dots,\\text{ms}_6\\right]$. Each $\\text{ms}_i$ must be a real number rounded to four decimal places.", "solution": "The problem statement has been validated and is deemed sound. It is a well-posed problem in classical control theory, providing all necessary definitions, parameters, and a clear objective. The methods and models specified, namely the First-Order Plus Dead Time (FOPDT) plant, the Proportional-Integral-Derivative (PID) controller, and the Ziegler-Nichols (ZN) ultimate gain tuning method, are standard and factually correct. The task is to compute the maximum sensitivity, $M_s$, for several FOPDT plants under ZN-tuned PID control. The procedure is non-trivial and requires a combination of analytical formulation and numerical computation.\n\nThe solution proceeds systematically for each given parameter set $(K, \\tau, L)$ of the FOPDT plant $G(s) = K \\exp(-Ls)/(\\tau s + 1)$.\n\nFirst, we determine the ultimate gain $K_u$ and ultimate period $P_u$ using the Ziegler-Nichols closed-loop method. This method involves finding the point of marginal stability for the system under proportional-only control, i.e., $C(s) = K_u$. The system becomes unstable when the phase of the open-loop transfer function $G(j\\omega)$ reaches $-\\pi$ radians while the magnitude is such that the closed-loop poles are on the imaginary axis.\n\nThe frequency response of the plant is given by $G(j\\omega) = K \\exp(-j\\omega L)/(1+j\\omega \\tau)$. Its phase is $\\angle G(j\\omega) = -\\omega L - \\arctan(\\omega \\tau)$. The ultimate frequency, $\\omega_u$, is the frequency at which the phase equals $-\\pi$. We must therefore find the smallest positive root of the transcendental equation:\n$$\n\\angle G(j\\omega_u) = -\\pi \\implies \\omega_u L + \\arctan(\\omega_u \\tau) = \\pi\n$$\nFor physically meaningful plants with $L > 0$ and $\\tau > 0$, the function $f(\\omega) = \\omega L + \\arctan(\\omega \\tau)$ is continuous and strictly monotonically increasing for $\\omega > 0$, starting from $f(0) = 0$ and approaching $\\infty$ as $\\omega \\to \\infty$. This guarantees the existence of a unique positive solution $\\omega_u$ for the equation $f(\\omega) = \\pi$. This equation is solved numerically using a robust root-finding algorithm, such as the Brent-Dekker method.\n\nOnce $\\omega_u$ is determined, the ultimate period is calculated by its definition:\n$$\nP_u = \\frac{2\\pi}{\\omega_u}\n$$\nThe ultimate gain $K_u$ is the gain required to make the loop gain magnitude unity at the ultimate frequency $\\omega_u$. That is, $|K_u G(j\\omega_u)| = 1$. The magnitude of the plant's frequency response is $|G(j\\omega)| = K / \\sqrt{1 + (\\omega\\tau)^2}$. Thus, $K_u$ is given by:\n$$\nK_u = \\frac{1}{|G(j\\omega_u)|} = \\frac{\\sqrt{1 + (\\omega_u \\tau)^2}}{K}\n$$\n\nNext, we use the classical Ziegler-Nichols tuning rules for a PID controller based on $K_u$ and $P_u$:\n- Proportional gain: $K_p = 0.6 K_u$\n- Integral time: $T_i = P_u / 2$\n- Derivative time: $T_d = P_u / 8$\n\nThe ideal PID controller's transfer function is $C(s) = K_p \\left(1 + \\frac{1}{T_i s} + T_d s\\right)$. Its frequency response is obtained by substituting $s = j\\omega$:\n$$\nC(j\\omega) = K_p \\left(1 + \\frac{1}{j T_i \\omega} + j T_d \\omega \\right) = K_p \\left(1 + j\\left(T_d \\omega - \\frac{1}{T_i \\omega}\\right)\\right)\n$$\n\nThe open-loop frequency response of the complete system is $L(j\\omega) = C(j\\omega)G(j\\omega)$. The sensitivity function $S(s)$ measures the effect of disturbances on the output. Its frequency response is $S(j\\omega) = 1/(1+L(j\\omega))$. The maximum sensitivity, $M_s$, is a key robustness indicator, defined as the peak magnitude of the sensitivity function over all frequencies:\n$$\nM_s = \\max_{\\omega \\ge 0} |S(j\\omega)| = \\max_{\\omega \\ge 0} \\frac{1}{|1 + C(j\\omega)G(j\\omega)|}\n$$\n\nThe computation of $M_s$ requires numerical optimization. For $\\omega=0$, the integral term in the PID controller causes $|C(j\\omega)| \\to \\infty$, which in turn drives $|L(j\\omega)| \\to \\infty$ and $|S(j\\omega)| \\to 0$. As $\\omega \\to \\infty$, $|L(j\\omega)| \\to 0$ and $|S(j\\omega)| \\to 1$. A maximum is therefore expected at some finite, non-zero frequency. To find this maximum robustly, a two-stage numerical procedure is implemented:\n1.  A coarse search is performed over a wide, logarithmically spaced frequency grid to identify the approximate location of the peak.\n2.  A local, more precise optimization algorithm (e.g., Brent's method) is then used to find the exact maximum value, $M_s$, using the result from the coarse search to define a search bracket.\n\nThis comprehensive procedure is applied to each of the six test cases specified in the problem statement. The final value of $M_s$ for each case is rounded to four decimal places.\n\nThe following Python code implements the described solution procedure.\n```python\nimport numpy as np\nfrom scipy.optimize import brentq, minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the main problem by iterating through test cases and computing Ms for each.\n    \"\"\"\n    # Test suite of FOPDT parameters (K, tau, L)\n    test_cases = [\n        (1.0, 1.0, 0.2),  # Case 1\n        (2.0, 2.0, 0.5),  # Case 2\n        (0.5, 1.0, 0.8),  # Case 3\n        (1.0, 0.5, 0.1),  # Case 4\n        (5.0, 3.0, 0.3),  # Case 5\n        (1.0, 1.0, 1.0),  # Case 6\n    ]\n\n    results = []\n    for K, tau, L in test_cases:\n        ms_value = calculate_ms(K, tau, L)\n        results.append(np.round(ms_value, 4))\n    \n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_ms(K, tau, L):\n    \"\"\"\n    Calculates the maximum sensitivity Ms for a given FOPDT plant.\n    \"\"\"\n    # Step 1: Find the ultimate frequency omega_u\n    # We need to solve the equation: omega * L + arctan(omega * tau) = pi\n    def phase_equation(omega):\n        return omega * L + np.arctan(omega * tau) - np.pi\n\n    # A robust bracket for the root finder. Since L > 0, the function is monotonic.\n    # Lower bound is close to zero. Upper bound can be estimated by omega*L  pi.\n    omega_u_lower_bound = 1e-9\n    omega_u_upper_bound = np.pi / L * 1.5 # Add a safety margin\n    omega_u = brentq(phase_equation, omega_u_lower_bound, omega_u_upper_bound)\n\n    # Step 2: Compute ultimate period Pu and ultimate gain Ku\n    Pu = 2 * np.pi / omega_u\n    G_mag_at_omega_u = K / np.sqrt(1 + (omega_u * tau)**2)\n    Ku = 1 / G_mag_at_omega_u\n\n    # Step 3: Compute PID parameters using Ziegler-Nichols rules\n    Kp = 0.6 * Ku\n    Ti = Pu / 2\n    Td = Pu / 8\n\n    # Step 4 and 5: Define sensitivity function magnitude and maximize it\n    def get_s_magnitude(omega):\n        # This function computes |S(j*omega)|\n        if omega = 1e-9:\n            return 0.0 # Analytically, |S(j_omega)| -> 0 as omega -> 0\n\n        # G(j*omega)\n        G_jw = K * np.exp(-1j * omega * L) / (1 + 1j * omega * tau)\n        \n        # C(j*omega)\n        C_jw = Kp * (1 + 1 / (1j * Ti * omega) + 1j * Td * omega)\n        \n        # L(j*omega)\n        L_jw = C_jw * G_jw\n        \n        # S(j*omega) magnitude\n        s_mag = np.abs(1 / (1 + L_jw))\n        return s_mag\n\n    # Numerical maximization of |S(j*omega)|\n    # Stage 1: Coarse grid search for an initial guess\n    # The peak is expected around omega_u. Search a couple of decades around it.\n    omega_grid = np.logspace(np.log10(omega_u) - 1.5, np.log10(omega_u) + 1.5, 1000)\n    s_mag_values = np.array([get_s_magnitude(w) for w in omega_grid])\n    \n    # Find the frequency corresponding to the coarse maximum\n    coarse_max_idx = np.argmax(s_mag_values)\n    \n    # Create a bracket for the fine search around the coarse maximum\n    if coarse_max_idx > 0 and coarse_max_idx  len(omega_grid) - 1:\n        bracket = (omega_grid[coarse_max_idx - 1], omega_grid[coarse_max_idx + 1])\n    else: # Fallback if max is at grid edge\n        bracket = (omega_grid[int(0.1*len(omega_grid))], omega_grid[int(0.9*len(omega_grid))])\n\n    # Stage 2: Fine optimization using minimize_scalar\n    # We minimize the negative of the magnitude to find the maximum\n    opt_result = minimize_scalar(\n        lambda w: -get_s_magnitude(w),\n        bracket=bracket,\n        method='brent'\n    )\n    \n    # The maximum sensitivity is the negative of the minimized value\n    Ms = -opt_result.fun\n    \n    return Ms\n```", "answer": "[2.0722,2.0227,2.1584,2.1158,2.052,2.3925]", "id": "2731936"}]}