{"hands_on_practices": [{"introduction": "The most direct method for determining the controllability of a linear time-invariant (LTI) system is the Kalman rank condition. This foundational exercise [@problem_id:2694383] provides practice in applying this test by constructing the controllability matrix, which is formed from the system's input matrix and its repeated interaction with the state dynamics matrix. Evaluating the rank of this matrix is the essential first step in analyzing the control properties of any linear system.", "problem": "Consider a continuous-time Linear Time-Invariant (LTI) state-space system defined by the differential equation $\\dot{x}(t)=A x(t)+B u(t)$, where $x(t) \\in \\mathbb{R}^{2}$ and $u(t) \\in \\mathbb{R}$. Let\n$$\nA=\\begin{bmatrix}1  0 \\\\ 0  2\\end{bmatrix}, \\quad B=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}.\n$$\nUse the definition of controllability as the property that every state can be reached from the origin in finite time by some admissible input, and standard linear algebra facts about subspaces generated by repeated actions of $A$ on $B$, to explicitly construct a basis for the reachable subspace. From this construction, assemble the controllability matrix $C$ that spans this subspace and determine whether the system is controllable by computing the rank of $C$. Report your final answer as the rank value $r$ of $C$. No rounding is required, and no units are involved. Your final answer must be a single real number.", "solution": "The problem provided is a standard exercise in linear control theory and is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We shall proceed with the analysis.\n\nThe system under consideration is a continuous-time Linear Time-Invariant (LTI) system described by the state-space equation $\\dot{x}(t) = A x(t) + B u(t)$. The state vector $x(t)$ is in $\\mathbb{R}^{2}$, which implies the dimension of the state space is $n=2$. The input $u(t)$ is a scalar, $u(t) \\in \\mathbb{R}$. The system matrices are given as:\n$$\nA = \\begin{bmatrix} 1  0 \\\\ 0  2 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThe problem requires us to determine the controllability of the system. A fundamental result in control theory, the Kalman rank condition, states that an LTI system is completely state controllable if and only if its controllability matrix has full rank, i.e., $\\text{rank}(C) = n$.\n\nThe problem directs us to first construct a basis for the reachable subspace. The reachable subspace, $\\mathcal{R}$, is the set of all states that can be reached from the origin in finite time. For an LTI system, this subspace is spanned by the columns of the controllability matrix. This subspace is also characterized as the smallest $A$-invariant subspace containing the image of $B$, denoted $\\text{Im}(B)$. It is given by the span of the vectors generated by repeated application of $A$ to the columns of $B$:\n$$\n\\mathcal{R} = \\text{span}\\{B, AB, A^2B, \\dots, A^{n-1}B\\}\n$$\nFor this problem, the dimension of the state space is $n=2$. Therefore, the reachable subspace is spanned by the column vectors of $B$ and $AB$. Let us compute these vectors.\n\nThe first vector is the column of the matrix $B$:\n$$\nv_1 = B = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThe second vector is obtained by applying the state matrix $A$ to the vector $v_1$:\n$$\nv_2 = AB = \\begin{bmatrix} 1  0 \\\\ 0  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} (1)(1) + (0)(1) \\\\ (0)(1) + (2)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\n$$\nThe reachable subspace $\\mathcal{R}$ is therefore $\\text{span}\\{v_1, v_2\\} = \\text{span}\\left\\{ \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}, \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} \\right\\}$.\n\nTo form a basis for this subspace, we must verify that the vectors $v_1$ and $v_2$ are linearly independent. We check if there exists a non-zero scalar $k$ such that $v_2 = k v_1$.\n$$\n\\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} = k \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThis vector equation yields a system of two linear equations:\n$1 = k \\cdot 1 \\implies k=1$\n$2 = k \\cdot 1 \\implies k=2$\nThe requirement that $k=1$ and $k=2$ simultaneously is a contradiction. Thus, the vectors $v_1$ and $v_2$ are linearly independent. Since we have a set of two linearly independent vectors in a $2$-dimensional space $\\mathbb{R}^2$, they form a basis for $\\mathbb{R}^2$. This means the reachable subspace is the entire state space, $\\mathcal{R} = \\mathbb{R}^2$.\n\nThe controllability matrix $C$ is constructed by concatenating these basis vectors:\n$$\nC = \\begin{bmatrix} B  AB \\end{bmatrix} = \\begin{bmatrix} v_1  v_2 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 1  2 \\end{bmatrix}\n$$\nThe final task is to determine the rank of $C$, which we denote by $r$. The rank of a matrix is the dimension of the space spanned by its columns. As we have already established that the two columns of the $2 \\times 2$ matrix $C$ are linearly independent, the rank of $C$ must be $2$.\n\nAn alternative method to determine the rank of a square matrix is to compute its determinant. A matrix has full rank if and only if its determinant is non-zero.\n$$\n\\det(C) = \\det\\left(\\begin{bmatrix} 1  1 \\\\ 1  2 \\end{bmatrix}\\right) = (1)(2) - (1)(1) = 2 - 1 = 1\n$$\nSince $\\det(C) = 1 \\neq 0$, the matrix $C$ is of full rank. The rank of $C$ is $r=2$. Because the rank of the controllability matrix ($r=2$) is equal to the dimension of the state space ($n=2$), the system is completely controllable. The problem asks for the rank value $r$.", "answer": "$$\n\\boxed{2}\n$$", "id": "2694383"}, {"introduction": "While the Kalman rank condition confirms *if* a system is controllable, the Popov–Belevitch–Hautus (PBH) test offers deeper insight into *why*. This practice [@problem_id:2694430] challenges you to analyze controllability from an eigenstructure perspective, which connects the system's modes (its eigenvalues) to its ability to be influenced by inputs. This modal viewpoint is crucial for understanding structural limitations on controllability that may not be obvious from the Kalman test alone.", "problem": "Consider the linear time-invariant state-space system defined by the pair $\\left(A,B\\right)$ with\n$$\nA=\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix},\\quad B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix}.\n$$\nStarting from the definition of controllability for a linear time-invariant system $\\dot{x}=Ax+Bu$ and using the eigenstructure-based criterion that underlies the Popov–Belevitch–Hautus (PBH) test, determine the dimension of the controllable subspace of the pair $\\left(A,B\\right)$. Express your final answer as a single integer with no units.", "solution": "The concept of controllability for an LTI system concerns the ability of an external input $u(t)$ to move the internal state $x(t)$ from any initial state to any final state within a finite time. The controllable subspace is the set of all states that can be reached from the origin. Its dimension quantifies the extent of this controllability.\n\nThe Popov–Belevitch–Hautus (PBH) test provides a criterion for controllability based on the eigenstructure of the system. A system is completely controllable if and only if for every eigenvalue $\\lambda$ of the matrix $A$, the rank of the matrix $[A - \\lambda I, B]$ is equal to the dimension of the state space, $n$.\n\nThe problem demands the use of the fundamental criterion that underlies this test. This criterion states that an LTI system is uncontrollable if and only if there exists a left eigenvector of the matrix $A$ that is orthogonal to the columns of the matrix $B$. A left eigenvector $v$ corresponding to an eigenvalue $\\lambda$ satisfies the relation $v^H A = \\lambda v^H$, where $v^H$ is the conjugate transpose of $v$. For real matrices, this simplifies to $v^T A = \\lambda v^T$, which is equivalent to $A^T v = \\lambda v$. An uncontrollable mode associated with $\\lambda$ exists if and only if there is a non-zero vector $v$ such that $A^T v = \\lambda v$ and $v^T B = 0$.\n\nThe dimension of the controllable subspace is $n - k$, where $n$ is the dimension of the state space and $k$ is the number of linearly independent left eigenvectors of $A$ that are orthogonal to the columns of $B$.\n\nFirst, we determine the dimension of the state space. The state matrix $A$ is a $2 \\times 2$ matrix, so the state dimension is $n=2$.\n\nNext, we find the eigenvalues of the matrix $A$. The characteristic equation is given by $\\det(A - \\lambda I) = 0$.\n$$\n\\det\\left(\\begin{bmatrix}0  1\\\\ -2  -3\\end{bmatrix} - \\lambda\\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}\\right) = \\det\\begin{bmatrix}-\\lambda  1\\\\ -2  -3-\\lambda\\end{bmatrix} = 0\n$$\n$$\n(-\\lambda)(-3-\\lambda) - (1)(-2) = 0\n$$\n$$\n\\lambda^2 + 3\\lambda + 2 = 0\n$$\nFactoring this quadratic equation yields:\n$$\n(\\lambda+1)(\\lambda+2) = 0\n$$\nThe eigenvalues of $A$ are $\\lambda_1 = -1$ and $\\lambda_2 = -2$.\n\nNow, we must find the left eigenvectors for each of these eigenvalues. A left eigenvector $v$ for an eigenvalue $\\lambda$ is an eigenvector of $A^T$ corresponding to the same eigenvalue $\\lambda$. The transpose of $A$ is:\n$$\nA^T = \\begin{bmatrix}0  -2\\\\ 1  -3\\end{bmatrix}\n$$\n\nFor $\\lambda_1 = -1$, we seek a vector $v_1$ such that $(A^T - \\lambda_1 I)v_1 = 0$:\n$$\n(A^T + 1 \\cdot I)v_1 = \\begin{bmatrix}0+1  -2\\\\ 1  -3+1\\end{bmatrix}\\begin{bmatrix}v_{11}\\\\ v_{12}\\end{bmatrix} = \\begin{bmatrix}1  -2\\\\ 1  -2\\end{bmatrix}\\begin{bmatrix}v_{11}\\\\ v_{12}\\end{bmatrix} = \\begin{bmatrix}0\\\\ 0\\end{bmatrix}\n$$\nThis gives the equation $v_{11} - 2v_{12} = 0$, or $v_{11} = 2v_{12}$. A representative left eigenvector is $v_1 = \\begin{bmatrix}2\\\\ 1\\end{bmatrix}$.\n\nFor $\\lambda_2 = -2$, we seek a vector $v_2$ such that $(A^T - \\lambda_2 I)v_2 = 0$:\n$$\n(A^T + 2 \\cdot I)v_2 = \\begin{bmatrix}0+2  -2\\\\ 1  -3+2\\end{bmatrix}\\begin{bmatrix}v_{21}\\\\ v_{22}\\end{bmatrix} = \\begin{bmatrix}2  -2\\\\ 1  -1\\end{bmatrix}\\begin{bmatrix}v_{21}\\\\ v_{22}\\end{bmatrix} = \\begin{bmatrix}0\\\\ 0\\end{bmatrix}\n$$\nThis gives the equation $v_{21} - v_{22} = 0$, or $v_{21} = v_{22}$. A representative left eigenvector is $v_2 = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$.\n\nThe next step is to test the orthogonality condition $v^T B = 0$ for each left eigenvector. The input matrix is $B=\\begin{bmatrix}1\\\\ 0\\end{bmatrix}$.\n\nFor $v_1 = \\begin{bmatrix}2\\\\ 1\\end{bmatrix}$:\n$$\nv_1^T B = \\begin{bmatrix}2  1\\end{bmatrix}\\begin{bmatrix}1\\\\ 0\\end{bmatrix} = (2)(1) + (1)(0) = 2\n$$\nSince $v_1^T B \\neq 0$, the mode associated with the eigenvalue $\\lambda_1 = -1$ is controllable.\n\nFor $v_2 = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$:\n$$\nv_2^T B = \\begin{bmatrix}1  1\\end{bmatrix}\\begin{bmatrix}1\\\\ 0\\end{bmatrix} = (1)(1) + (1)(0) = 1\n$$\nSince $v_2^T B \\neq 0$, the mode associated with the eigenvalue $\\lambda_2 = -2$ is controllable.\n\nNeither of the left eigenvectors of $A$ is orthogonal to the input matrix $B$. Therefore, there are no uncontrollable modes. The dimension of the uncontrollable subspace is $k=0$.\n\nThe dimension of the controllable subspace is $n - k = 2 - 0 = 2$. This means the system is completely controllable, and the controllable subspace spans the entire state space $\\mathbb{R}^2$.", "answer": "$$\\boxed{2}$$", "id": "2694430"}, {"introduction": "Controllability analysis becomes more nuanced for systems that are not diagonalizable, which occurs when they possess defective eigenvalues. This advanced problem [@problem_id:2694421] delves into such a scenario, requiring you to work from first principles with generalized eigenvectors and Jordan chains to diagnose an uncontrollable mode. Successfully completing this exercise demonstrates a sophisticated understanding of the structural foundations of controllability beyond the application of standard tests.", "problem": "Consider the linear time-invariant state-space system governed by $\\dot{x}(t) = A x(t) + B u(t)$ with\n$$\nA \\in \\mathbb{R}^{3 \\times 3}, \\quad B \\in \\mathbb{R}^{3 \\times 1}, \\quad\nA = \\begin{bmatrix} 0  1  0 \\\\[4pt] 0  0  0 \\\\[4pt] 0  0  2 \\end{bmatrix}, \\quad\nB = \\begin{bmatrix} 0 \\\\[4pt] 0 \\\\[4pt] 1 \\end{bmatrix}.\n$$\nThis example is designed so that $A$ has a defective eigenvalue. Work from first principles, using only core definitions of eigenvalues, eigenvectors, generalized eigenvectors, and controllability, and the basic linear-algebraic relationship between the rank of a matrix and the existence of nontrivial vectors in its left nullspace.\n\nPerform the following, without invoking any prepackaged controllability criteria as a black box. Begin by verifying directly that $A$ has an eigenvalue $\\lambda = 0$ with algebraic multiplicity strictly larger than geometric multiplicity. Then construct a left Jordan chain for $\\lambda = 0$ by finding a nonzero left eigenvector $v^{\\top}$ satisfying $v^{\\top}(A - 0 \\cdot I) = 0$ and a nonzero left generalized eigenvector $w^{\\top}$ satisfying $w^{\\top}(A - 0 \\cdot I) = v^{\\top}$. Analyze the left nullspace of the block matrix $\\begin{bmatrix} A - 0 \\cdot I  B \\end{bmatrix}$ to argue that the existence of a nonzero row vector $x^{\\top}$ with $x^{\\top}(A - 0 \\cdot I) = 0$ and $x^{\\top} B = 0$ certifies that the pair $(A,B)$ is not controllable. In this concrete construction, identify such an $x^{\\top}$ and use it to explain the loss of controllability at the defective eigenvalue. Finally, compute the scalar value of $w^{\\top} B$ for your constructed left generalized eigenvector $w^{\\top}$.\n\nProvide your final answer as the exact value of $w^{\\top} B$. No rounding is required. No physical units are involved. The final answer must be a single number.", "solution": "The system is described by $\\dot{x}(t) = A x(t) + B u(t)$, with matrices:\n$$\nA = \\begin{bmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  2 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\n\nFirst, we verify the properties of the eigenvalues of $A$. The characteristic equation is $\\det(A - \\lambda I) = 0$.\n$$\n\\det\\left(\\begin{bmatrix} 0 - \\lambda  1  0 \\\\ 0  0 - \\lambda  0 \\\\ 0  0  2 - \\lambda \\end{bmatrix}\\right) = (-\\lambda)(-\\lambda)(2 - \\lambda) = \\lambda^2(2 - \\lambda) = 0\n$$\nThe eigenvalues are $\\lambda_1 = 2$ with algebraic multiplicity $1$, and $\\lambda_2 = 0$ with algebraic multiplicity $2$.\n\nTo find the geometric multiplicity of the eigenvalue $\\lambda = 0$, we find the dimension of the nullspace of $(A - 0 \\cdot I)$, which is simply $A$. We seek the number of linearly independent vectors $v$ such that $Av = 0$.\n$$\nA v = \\begin{bmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  2 \\end{bmatrix} \\begin{bmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{bmatrix} = \\begin{bmatrix} v_2 \\\\ 0 \\\\ 2v_3 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\nThis system of equations requires $v_2 = 0$ and $v_3 = 0$. The vector $v$ must be of the form $\\begin{bmatrix} c \\\\ 0 \\\\ 0 \\end{bmatrix}$ for any scalar $c$. The nullspace is spanned by the single vector $\\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$. Therefore, the geometric multiplicity of the eigenvalue $\\lambda = 0$ is $1$. Since the algebraic multiplicity ($2$) is strictly greater than the geometric multiplicity ($1$), the eigenvalue $\\lambda = 0$ is defective, as stated in the problem.\n\nNext, we construct a left Jordan chain for $\\lambda = 0$. A left eigenvector $v^{\\top}$ is a non-zero row vector that satisfies $v^{\\top}(A - 0 \\cdot I) = v^{\\top}A = 0^{\\top}$. Let $v^{\\top} = \\begin{bmatrix} v_1  v_2  v_3 \\end{bmatrix}$.\n$$\nv^{\\top}A = \\begin{bmatrix} v_1  v_2  v_3 \\end{bmatrix} \\begin{bmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  2 \\end{bmatrix} = \\begin{bmatrix} 0  v_1  2v_3 \\end{bmatrix} = \\begin{bmatrix} 0  0  0 \\end{bmatrix}\n$$\nThis implies $v_1 = 0$ and $v_3 = 0$. The component $v_2$ is a free variable. We choose $v_2 = 1$ to define a specific, non-zero left eigenvector:\n$$\nv^{\\top} = \\begin{bmatrix} 0  1  0 \\end{bmatrix}\n$$\nNow, we find a left generalized eigenvector of rank $2$, denoted $w^{\\top}$, which satisfies $w^{\\top}(A - 0 \\cdot I) = w^{\\top}A = v^{\\top}$. Let $w^{\\top} = \\begin{bmatrix} w_1  w_2  w_3 \\end{bmatrix}$.\n$$\nw^{\\top}A = \\begin{bmatrix} w_1  w_2  w_3 \\end{bmatrix} \\begin{bmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  2 \\end{bmatrix} = \\begin{bmatrix} 0  w_1  2w_3 \\end{bmatrix}\n$$\nEquating this to $v^{\\top} = \\begin{bmatrix} 0  1  0 \\end{bmatrix}$ gives the conditions $w_1 = 1$ and $2w_3 = 0 \\implies w_3=0$. The component $w_2$ is a free variable. For simplicity, we choose $w_2 = 0$, which gives the generalized eigenvector:\n$$\nw^{\\top} = \\begin{bmatrix} 1  0  0 \\end{bmatrix}\n$$\n\nThe connection between left eigenvectors and controllability is fundamental. The pair $(A,B)$ is uncontrollable if and only if there exists a non-zero row vector $x^{\\top}$ and a scalar $\\lambda$ such that $x^{\\top}A = \\lambda x^{\\top}$ and $x^{\\top}B = 0$. This is the Popov-Belevitch-Hautus (PBH) test. Such a vector $x^{\\top}$ must be a left eigenvector of $A$. The condition $x^{\\top}B = 0$ means that the input $u(t)$ is orthogonal to the direction defined by $x^{\\top}$. If we project the state dynamics onto this direction by defining a scalar variable $y(t) = x^{\\top}x(t)$, its time evolution is $\\dot{y}(t) = x^{\\top}\\dot{x}(t) = x^{\\top}(Ax(t) + Bu(t)) = (x^{\\top}A)x(t) + (x^{\\top}B)u(t) = \\lambda x^{\\top}x(t) + 0 \\cdot u(t) = \\lambda y(t)$. The dynamics of $y(t)$ are $\\dot{y} = \\lambda y$, which are completely unaffected by the control input $u(t)$. Thus, any initial state component along the direction $x^{\\top}$ cannot be controlled, proving the system is not controllable.\n\nWe apply this principle to the given system. We seek a left eigenvector $x^{\\top}$ such that $x^{\\top}B=0$. From our previous work, the left eigenspace for $\\lambda=0$ is spanned by $v^{\\top} = \\begin{bmatrix} 0  1  0 \\end{bmatrix}$. Let us use this vector for $x^{\\top}$. We verify the condition $x^{\\top}B=0$:\n$$\nx^{\\top}B = \\begin{bmatrix} 0  1  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = (0)(0) + (1)(0) + (0)(1) = 0\n$$\nThe condition is satisfied. The existence of the non-zero left eigenvector $x^{\\top} = \\begin{bmatrix} 0  1  0 \\end{bmatrix}$ corresponding to the eigenvalue $\\lambda=0$ that is also orthogonal to $B$ certifies that the pair $(A,B)$ is not controllable. This specific vector $x^{\\top}$ picks out the second state variable, $x_2$. From the system equations, $\\dot{x}_2 = 0$, confirming that this state is not influenced by the input $u(t)$, which only enters the dynamics of $x_3$.\n\nFinally, we are required to compute the scalar value of $w^{\\top}B$. Using our constructed left generalized eigenvector $w^{\\top} = \\begin{bmatrix} 1  0  0 \\end{bmatrix}$ and the matrix $B$:\n$$\nw^{\\top}B = \\begin{bmatrix} 1  0  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} = (1)(0) + (0)(0) + (0)(1) = 0\n$$\nThe result is $0$. This indicates that not only is the mode associated with the eigenvector uncontrollable ($v^{\\top}B=0$), but the input also fails to directly actuate the state associated with the next level in the Jordan chain. This represents a structural failure of controllability for the entire Jordan block associated with $\\lambda=0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2694421"}]}