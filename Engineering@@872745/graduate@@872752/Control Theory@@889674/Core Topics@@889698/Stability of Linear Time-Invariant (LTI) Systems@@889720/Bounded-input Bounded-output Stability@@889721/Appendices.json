{"hands_on_practices": [{"introduction": "A cornerstone of LTI system analysis is the direct link between a system's poles and its time-domain behavior. This first practice guides you through the canonical process of certifying BIBO stability for a given transfer function [@problem_id:2691098]. By calculating the impulse response and its $L_1$ norm, you will derive from first principles the exact gain that bounds the output for any bounded input, reinforcing the fundamental stability condition.", "problem": "A single-input single-output (SISO) linear time-invariant (LTI) causal system has transfer function $G(s)=\\dfrac{s+4}{s^{2}+3s+2}$. Assume its impulse response $h(t)$ is the unique causal function whose bilateral Laplace transform equals $G(s)$ where defined. Starting only from the convolution representation $y(t)=(h*u)(t)=\\int_{-\\infty}^{\\infty}h(\\tau)u(t-\\tau)\\,d\\tau$, the definition of bounded-input, bounded-output (BIBO) stability (“every input $u$ with finite essential supremum norm $\\|u\\|_{\\infty}\\infty$ produces an output $y$ whose essential supremum norm $\\|y\\|_{\\infty}\\infty$”), and basic norm inequalities, do the following:\n\n- Compute the pole locations of $G(s)$ and relate their locations in the complex plane to the time-domain properties of $h(t)$ that you need in order to certify BIBO stability from first principles.\n- Derive from first principles an explicit input-output bound of the form $\\|y\\|_{\\infty}\\leq M\\,\\|u\\|_{\\infty}$ that is valid for all bounded inputs $u$, identifying the smallest such constant $M$ obtainable by this approach in terms of an integral involving $h(t)$.\n- Compute this constant explicitly for the given $G(s)$ by finding $h(t)$ and evaluating the required integral exactly.\n\nProvide as your final answer the exact value of the bound constant $M$ (no units). Do not round; report the exact value.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and complete. It is a standard problem in the analysis of linear time-invariant systems. We will proceed with the solution.\n\nThe system is a single-input single-output (SISO) linear time-invariant (LTI) causal system with transfer function $G(s)=\\dfrac{s+4}{s^{2}+3s+2}$. The output $y(t)$ is related to the input $u(t)$ via the convolution integral $y(t) = \\int_{-\\infty}^{\\infty}h(\\tau)u(t-\\tau)\\,d\\tau$, where $h(t)$ is the causal impulse response.\n\nFirst, we address the pole locations and their relation to BIBO stability. The poles of $G(s)$ are the roots of the denominator polynomial $s^{2}+3s+2=0$. Factoring the polynomial gives $(s+1)(s+2)=0$. Thus, the poles are located at $s_1 = -1$ and $s_2 = -2$. Both poles are real, distinct, and located in the open left-half of the complex plane, i.e., $\\text{Re}(s_k)  0$ for $k=1, 2$.\n\nFor a causal LTI system, the impulse response $h(t)$ is the inverse Laplace transform of $G(s)$ with a region of convergence being a right-half plane to the right of all poles. The structure of $h(t)$ for $t \\ge 0$ is determined by the poles. Simple poles $p_k$ contribute terms of the form $C_k \\exp(p_k t)$ to $h(t)$. Since both poles $s_1 = -1$ and $s_2 = -2$ have negative real parts, the corresponding terms in $h(t)$, which will be of the form $C_1 \\exp(-t)$ and $C_2 \\exp(-2t)$, decay exponentially to zero as $t \\to \\infty$. This exponential decay ensures that the impulse response is absolutely integrable, i.e., $\\int_{0}^{\\infty} |h(\\tau)| \\, d\\tau  \\infty$. As we shall derive next, this condition is precisely the requirement for BIBO stability.\n\nWe now derive the BIBO stability condition from first principles. The output is given by $y(t) = \\int_{-\\infty}^{\\infty} h(\\tau) u(t-\\tau) \\, d\\tau$. We take the absolute value of both sides:\n$$|y(t)| = \\left| \\int_{-\\infty}^{\\infty} h(\\tau) u(t-\\tau) \\, d\\tau \\right|$$\nUsing the triangle inequality for integrals, which states that $|\\int f(x) dx| \\le \\int |f(x)| dx$, we obtain:\n$$|y(t)| \\le \\int_{-\\infty}^{\\infty} |h(\\tau) u(t-\\tau)| \\, d\\tau = \\int_{-\\infty}^{\\infty} |h(\\tau)| |u(t-\\tau)| \\, d\\tau$$\nThe input $u(t)$ is bounded, meaning there exists a finite constant $\\|u\\|_{\\infty} = \\text{ess sup}_{t} |u(t)|  \\infty$. Therefore, for almost every value of its argument, $|u(t-\\tau)| \\le \\|u\\|_{\\infty}$. Substituting this into the inequality yields:\n$$|y(t)| \\le \\int_{-\\infty}^{\\infty} |h(\\tau)| \\|u\\|_{\\infty} \\, d\\tau$$\nSince $\\|u\\|_{\\infty}$ is a constant with respect to the integration variable $\\tau$, we can factor it out of the integral:\n$$|y(t)| \\le \\|u\\|_{\\infty} \\int_{-\\infty}^{\\infty} |h(\\tau)| \\, d\\tau$$\nThis inequality must hold for all $t$. The essential supremum of the left side, $\\|y\\|_{\\infty}$, must therefore also satisfy this bound:\n$$\\|y\\|_{\\infty} \\le \\|u\\|_{\\infty} \\int_{-\\infty}^{\\infty} |h(\\tau)| \\, d\\tau$$\nFor the output $y(t)$ to be bounded for any bounded input $u(t)$, the term multiplying $\\|u\\|_{\\infty}$ must be a finite constant. This means the system is BIBO stable if the impulse response is absolutely integrable:\n$$M = \\int_{-\\infty}^{\\infty} |h(\\tau)| \\, d\\tau  \\infty$$\nThis integral is the $L^1$-norm of $h(t)$. The bound is of the form $\\|y\\|_{\\infty} \\le M \\|u\\|_{\\infty}$. To show that this $M$ is the smallest possible constant, one must demonstrate there exists an input for which the bound is achieved. Consider the bounded input $u_0(t) = \\text{sgn}(h(-t))$, which has $\\|u_0\\|_{\\infty} = 1$. The output at $t=0$ for this input is:\n$$y(0) = \\int_{-\\infty}^{\\infty} h(\\tau) u_0(-\\tau) \\, d\\tau = \\int_{-\\infty}^{\\infty} h(\\tau) \\text{sgn}(h(\\tau)) \\, d\\tau = \\int_{-\\infty}^{\\infty} |h(\\tau)| \\, d\\tau = M$$\nSince $\\|y\\|_{\\infty} \\ge |y(0)|$, we have $\\|y\\|_{\\infty} \\ge M$. Combined with the derived inequality $\\|y\\|_{\\infty} \\le M \\|u_0\\|_{\\infty} = M$, it follows that for this particular input, $\\|y\\|_{\\infty} = M$. Thus, no constant smaller than $M = \\int_{-\\infty}^{\\infty} |h(\\tau)| d\\tau$ can serve as a universal bound.\n\nNext, we compute $h(t)$ for the given $G(s)$. We use partial fraction expansion:\n$$G(s) = \\frac{s+4}{(s+1)(s+2)} = \\frac{A}{s+1} + \\frac{B}{s+2}$$\nThe coefficients $A$ and $B$ are found using the residue method:\n$$A = \\left. (s+1)G(s) \\right|_{s=-1} = \\left. \\frac{s+4}{s+2} \\right|_{s=-1} = \\frac{-1+4}{-1+2} = 3$$\n$$B = \\left. (s+2)G(s) \\right|_{s=-2} = \\left. \\frac{s+4}{s+1} \\right|_{s=-2} = \\frac{-2+4}{-2+1} = -2$$\nSo, the transfer function is $G(s) = \\frac{3}{s+1} - \\frac{2}{s+2}$.\nThe system is causal, so the impulse response $h(t)$ is the inverse Laplace transform of $G(s)$ for $t \\ge 0$, and $h(t)=0$ for $t  0$. Using the standard transform pair $\\mathcal{L}^{-1}\\{\\frac{1}{s+a}\\} = \\exp(-at)u_{step}(t)$, where $u_{step}(t)$ is the Heaviside step function, we find:\n$$h(t) = (3\\exp(-t) - 2\\exp(-2t)) u_{step}(t)$$\n\nFinally, we compute the constant $M$. Since the system is causal, $h(\\tau)=0$ for $\\tau  0$. The integral becomes:\n$$M = \\int_{0}^{\\infty} |3\\exp(-\\tau) - 2\\exp(-2\\tau)| \\, d\\tau$$\nWe must determine the sign of the integrand $f(\\tau) = 3\\exp(-\\tau) - 2\\exp(-2\\tau)$ for $\\tau \\ge 0$. Let $x = \\exp(-\\tau)$. For $\\tau \\ge 0$, we have $0  x \\le 1$. The expression becomes $3x - 2x^2 = x(3-2x)$. Since $x > 0$, the sign is determined by $3-2x$. The condition $3-2x \\ge 0$ implies $x \\le \\frac{3}{2}$. As $x = \\exp(-\\tau) \\le 1$ for all $\\tau \\ge 0$, the condition $x \\le \\frac{3}{2}$ is always satisfied. Therefore, $h(\\tau) \\ge 0$ for all $\\tau \\ge 0$, and the absolute value can be removed.\nThe integral for $M$ simplifies to:\n$$M = \\int_{0}^{\\infty} (3\\exp(-\\tau) - 2\\exp(-2\\tau)) \\, d\\tau$$\nWe evaluate the integral:\n$$M = \\left[ \\frac{3\\exp(-\\tau)}{-1} - \\frac{2\\exp(-2\\tau)}{-2} \\right]_{0}^{\\infty} = \\left[ -3\\exp(-\\tau) + \\exp(-2\\tau) \\right]_{0}^{\\infty}$$\nEvaluating at the limits:\n$$M = \\lim_{\\tau \\to \\infty} (-3\\exp(-\\tau) + \\exp(-2\\tau)) - (-3\\exp(0) + \\exp(0))$$\n$$M = (0 + 0) - (-3 \\cdot 1 + 1) = 0 - (-2) = 2$$\nThe exact value of the constant is $2$.", "answer": "$$\\boxed{2}$$", "id": "2691098"}, {"introduction": "Understanding the precise boundaries of a stability definition is as important as understanding the definition itself. This exercise provides a crucial counterexample to demonstrate why BIBO stability requires all poles to lie in the open left-half of the complex plane [@problem_id:2691088]. You will construct a system with a pole at the origin—a marginal case—and show through direct convolution that even a simple, bounded input can drive the output to infinity, thus proving the system is not BIBO stable.", "problem": "Consider a continuous-time, linear time-invariant (LTI) system described by a rational transfer function. You are to construct an explicit example whose poles lie in the closed left-half complex plane, including a simple pole at the origin, and then use first principles to demonstrate that bounded inputs can produce unbounded outputs, thereby showing the system is not bounded-input, bounded-output (BIBO) stable. Work entirely from foundational definitions: the convolution representation of LTI systems and the inverse Laplace transform. Do not assume any stability tests beyond those definitions.\n\nCarry out the following steps:\n\n1. Define the transfer function as $G(s) = \\dfrac{s+2}{s(s+1)}$ and verify that all poles are in the closed left-half plane and that there is a simple pole at $s=0$.\n\n2. Compute the impulse response $h(t)$ by taking the inverse Laplace transform of $G(s)$, and write it explicitly for $t \\ge 0$ using the Heaviside step function $H(t)$, where $H(t)=1$ for $t \\ge 0$ and $H(t)=0$ for $t0$.\n\n3. Choose the bounded input $x(t) = H(t)$ and use the convolution integral to compute the corresponding output $y(t) = (h * x)(t)$ explicitly for $t \\ge 0$. Show directly from your expression that $y(t)$ is unbounded as $t \\to \\infty$.\n\nProvide your final answer as a single, closed-form expression for $y(t)$ valid for $t \\ge 0$. No numerical rounding is required, and no physical units are involved.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extracted Givens**\n- System description: Continuous-time, linear time-invariant (LTI).\n- Transfer function: $G(s) = \\dfrac{s+2}{s(s+1)}$.\n- Task 1: Verify that poles are in the closed left-half complex plane, including a simple pole at $s=0$.\n- Task 2: Compute the impulse response $h(t)$ for $t \\ge 0$ using the inverse Laplace transform of $G(s)$. The Heaviside step function is defined as $H(t)=1$ for $t \\ge 0$ and $H(t)=0$ for $t0$.\n- Task 3: Use the bounded input $x(t) = H(t)$ and the convolution integral $y(t) = (h * x)(t)$ to compute the output $y(t)$ for $t \\ge 0$.\n- Task 4: Show from the expression for $y(t)$ that the output is unbounded as $t \\to \\infty$.\n- Required final answer: A closed-form expression for $y(t)$ valid for $t \\ge 0$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard, fundamental exercise in the study of LTI systems and control theory, specifically concerning the concept of bounded-input, bounded-output (BIBO) stability. The transfer function, input, and methods of analysis are all clearly specified. The problem does not contain any scientific contradictions, ambiguities, or missing information. It asks for a demonstration from first principles, which is a legitimate and instructive pedagogical task.\n\n**Step 3: Verdict and Action**\nThe problem is determined to be **valid**. A rigorous solution will now be constructed.\n\nWe begin the analysis. The problem is a direct application of fundamental principles and requires no advanced theorems, only meticulous calculation.\n\nFirst, we analyze the poles of the given transfer function, $G(s) = \\dfrac{s+2}{s(s+1)}$. The poles are the roots of the denominator polynomial, $s(s+1) = 0$. This equation yields two poles: $s_1 = 0$ and $s_2 = -1$. The pole at $s_1 = 0$ is a simple pole located on the imaginary axis, at the origin. The pole at $s_2 = -1$ is a simple pole in the open left-half complex plane. Therefore, all poles of the system lie in the closed left-half plane, which includes the imaginary axis. The condition stated in the problem is satisfied.\n\nNext, we compute the impulse response, $h(t)$, which is the inverse Laplace transform of $G(s)$. To do this, we first perform a partial fraction expansion of $G(s)$:\n$$ G(s) = \\frac{s+2}{s(s+1)} = \\frac{A}{s} + \\frac{B}{s+1} $$\nThe coefficients $A$ and $B$ are found using the residue method.\nFor the coefficient $A$:\n$$ A = \\lim_{s \\to 0} s G(s) = \\lim_{s \\to 0} s \\frac{s+2}{s(s+1)} = \\lim_{s \\to 0} \\frac{s+2}{s+1} = \\frac{0+2}{0+1} = 2 $$\nFor the coefficient $B$:\n$$ B = \\lim_{s \\to -1} (s+1) G(s) = \\lim_{s \\to -1} (s+1) \\frac{s+2}{s(s+1)} = \\lim_{s \\to -1} \\frac{s+2}{s} = \\frac{-1+2}{-1} = -1 $$\nThus, the expanded transfer function is:\n$$ G(s) = \\frac{2}{s} - \\frac{1}{s+1} $$\nNow, we find the impulse response $h(t) = \\mathcal{L}^{-1}\\{G(s)\\}$. Using standard Laplace transform pairs and the linearity of the transform, and applying the given definition of the Heaviside function $H(t)$:\n$$ h(t) = \\mathcal{L}^{-1}\\left\\{\\frac{2}{s}\\right\\} - \\mathcal{L}^{-1}\\left\\{\\frac{1}{s+1}\\right\\} = 2 H(t) - \\exp(-t) H(t) $$\nFor $t \\ge 0$, this simplifies to:\n$$ h(t) = 2 - \\exp(-t) $$\n\nThe next step is to demonstrate that a bounded input can produce an unbounded output. We choose the bounded input $x(t) = H(t)$, which is the unit step function. The magnitude of this input is bounded by $|x(t)| \\le 1$ for all $t$. The output $y(t)$ is the convolution of the impulse response $h(t)$ with the input $x(t)$:\n$$ y(t) = (h * x)(t) = \\int_{-\\infty}^{\\infty} h(\\tau) x(t-\\tau) d\\tau $$\nSubstituting the expressions for $h(t)$ and $x(t)$:\n$$ y(t) = \\int_{-\\infty}^{\\infty} [ (2 - \\exp(-\\tau))H(\\tau) ] [ H(t-\\tau) ] d\\tau $$\nThe product of the Heaviside functions $H(\\tau)H(t-\\tau)$ is equal to $1$ only when $\\tau \\ge 0$ and $t-\\tau \\ge 0$, which is equivalent to the interval $0 \\le \\tau \\le t$. This is valid for $t \\ge 0$. For $t  0$, the integral is $0$. We are concerned with the system's behavior for $t \\ge 0$. The integral becomes:\n$$ y(t) = \\int_{0}^{t} (2 - \\exp(-\\tau)) d\\tau \\quad \\text{for } t \\ge 0 $$\nWe evaluate this elementary integral:\n$$ y(t) = \\left[ 2\\tau - (-\\exp(-\\tau)) \\right]_{0}^{t} = \\left[ 2\\tau + \\exp(-\\tau) \\right]_{0}^{t} $$\n$$ y(t) = (2t + \\exp(-t)) - (2(0) + \\exp(-0)) = (2t + \\exp(-t)) - (0 + 1) $$\n$$ y(t) = 2t + \\exp(-t) - 1 $$\nThis is the closed-form expression for the output $y(t)$ for $t \\ge 0$.\n\nFinally, we must show that this output is unbounded. We examine the limit of $y(t)$ as $t \\to \\infty$:\n$$ \\lim_{t \\to \\infty} y(t) = \\lim_{t \\to \\infty} (2t + \\exp(-t) - 1) $$\nAs $t \\to \\infty$, the term $2t$ grows without bound ($2t \\to \\infty$), and the term $\\exp(-t)$ decays to zero ($\\exp(-t) \\to 0$). Therefore:\n$$ \\lim_{t \\to \\infty} y(t) = \\infty $$\nThe output $y(t)$ is unbounded. We have taken a bounded input, $x(t) = H(t)$, and produced an unbounded output. This proves, by construction and from first principles, that the system is not bounded-input, bounded-output (BIBO) stable. This result is a direct consequence of the pole at the origin, which acts as an integrator. The step input provides a constant value that is integrated over time, resulting in a ramp function that grows linearly and is thus unbounded.\nThe final expression for the output $y(t)$ for $t \\ge 0$ is the answer required.", "answer": "$$\n\\boxed{2t + \\exp(-t) - 1}\n$$", "id": "2691088"}, {"introduction": "While analytical derivations provide foundational insight, real-world control engineering heavily relies on numerical computation. This practice bridges the gap by tasking you with developing a program to estimate two different, yet related, measures of system gain: the time-domain $L_1$ norm of the impulse response, $\\lVert g \\rVert_{1}$, and the frequency-domain $\\mathcal{H}_{\\infty}$ norm, $\\lVert G \\rVert_{\\infty}$ [@problem_id:2691131]. This exercise will not only sharpen your computational skills but also illuminate the practical relationship between time-domain and frequency-domain bounds on system performance.", "problem": "Given a continuous-time, stable, proper, Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) system with transfer function $G(s)$, design a program that estimates the Hardy space infinity norm (the $\\mathcal{H}_{\\infty}$ norm) of $G(s)$ by frequency gridding and then uses this estimate to bound the Bounded-Input, Bounded-Output (BIBO) gain for two classes of inputs: (i) bounded sinusoidal inputs of a specified frequency, and (ii) general bounded inputs with a specified essential supremum bound.\n\nYour design must start only from the following fundamental bases:\n- The convolution representation of the input-output map for LTI systems: if $g(t)$ is the impulse response of $G(s)$ and $u(t)$ is the input, then $y(t) = (g * u)(t) = \\int_{0}^{\\infty} g(\\tau) u(t - \\tau) \\, d\\tau$ for $t \\ge 0$ under standard causality assumptions.\n- The frequency response interpretation for steady-state sinusoidal inputs: for $u(t) = A \\sin(\\omega_0 t)$, the steady-state output is a sinusoid at the same frequency with amplitude $A \\lvert G(j \\omega_0) \\rvert$, where $G(j \\omega)$ is the Fourier transform of $g(t)$ understood in the distributional sense for stable, proper LTI systems.\n- The BIBO stability characterization via the impulse response absolute integrability: if $\\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt  \\infty$, then $\\lVert y \\rVert_{\\infty} \\le \\left( \\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt \\right) \\lVert u \\rVert_{\\infty}$, where $\\lVert \\cdot \\rVert_{\\infty}$ denotes the essential supremum norm on time-domain signals.\n\nFrom these bases, derive and implement:\n1) A frequency-gridding estimator for the $\\mathcal{H}_{\\infty}$ norm of $G(s)$, defined for SISO as the supremum of $\\lvert G(j \\omega) \\rvert$ over $\\omega \\in [0,\\infty)$, approximated on a prescribed grid of frequencies. The grid must include $\\omega = 0$ and a logarithmically spaced set of positive frequencies. Use $\\omega_{\\min} = 10^{-3}$ radians per second, $\\omega_{\\max} = 10^{3}$ radians per second, and $N_{\\omega} = 20000$ logarithmically spaced points in $[\\omega_{\\min}, \\omega_{\\max}]$, augmented with $\\omega = 0$.\n2) A numerical estimator of $\\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt$ using the impulse response $g(t)$ computed on a finite horizon $[0, T_{\\mathrm{end}}]$ and the trapezoidal rule. Determine $T_{\\mathrm{end}}$ from the pole locations $\\{ p_k \\}$ of $G(s)$ by first computing the largest time constant $\\tau_{\\max} = \\max_{k} \\left( 1 / \\lvert \\operatorname{Re}(p_k) \\rvert \\right)$ and then setting $T_{\\mathrm{end}} = \\alpha \\, \\tau_{\\max}$ with $\\alpha = 12$. Use a uniform time grid with step size $\\Delta t = \\tau_{\\max} / 200$ on $[0, T_{\\mathrm{end}}]$. State the angle unit for frequencies explicitly as radians per second.\n\nFor each test case, your program must compute and return the following six scalars:\n- The estimated $\\mathcal{H}_{\\infty}$ norm, $\\widehat{\\lVert G \\rVert_{\\infty}}$.\n- The frequency $\\widehat{\\omega}_{\\mathrm{pk}}$ (in radians per second) at which the maximum magnitude over the grid occurs.\n- The bound on the steady-state output amplitude for the specified sinusoidal input, computed as $\\widehat{\\lVert G \\rVert_{\\infty}} \\, A$, where $A$ is the input amplitude.\n- The exact steady-state output amplitude for the specified sinusoidal input at frequency $\\omega_0$, computed as $A \\lvert G(j \\omega_0) \\rvert$.\n- The estimated impulse-response $L^{1}$ norm $\\widehat{\\lVert g \\rVert_{1}} \\approx \\int_{0}^{T_{\\mathrm{end}}} \\lvert g(t) \\rvert \\, dt$.\n- The BIBO bound for general bounded inputs with $\\lVert u \\rVert_{\\infty} \\le U_{\\max}$, computed as $\\widehat{\\lVert g \\rVert_{1}} \\, U_{\\max}$.\n\nAngle units must be in radians per second. There are no physical units beyond this frequency unit.\n\nTest suite:\n- Case $1$:\n  - Numerator coefficients: $[20]$.\n  - Denominator coefficients: $[1, 12, 20]$.\n  - Sinusoidal input amplitude: $A = 1.0$.\n  - Sinusoidal frequency: $\\omega_0 = 1.0$ radians per second.\n  - General input bound: $U_{\\max} = 0.8$.\n- Case $2$:\n  - Numerator coefficients: $[1, -1]$ (i.e., $s - 1$).\n  - Denominator coefficients: $[1, 4, 3]$ (i.e., $(s + 1)(s + 3)$).\n  - Sinusoidal input amplitude: $A = 1.5$.\n  - Sinusoidal frequency: $\\omega_0 = 2.0$ radians per second.\n  - General input bound: $U_{\\max} = 1.2$.\n- Case $3$:\n  - Numerator coefficients: $[25]$ (i.e., $\\omega_n^2$ with $\\omega_n = 5$).\n  - Denominator coefficients: $[1, 0.5, 25]$ (i.e., $s^2 + 2 \\zeta \\omega_n s + \\omega_n^2$ with $\\zeta = 0.05$ and $\\omega_n = 5$).\n  - Sinusoidal input amplitude: $A = 0.5$.\n  - Sinusoidal frequency: $\\omega_0 = 5.0$ radians per second.\n  - General input bound: $U_{\\max} = 0.6$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all three test cases as a comma-separated list of lists, each inner list containing six floating-point numbers in the order specified above. The entire result must be enclosed in a single pair of square brackets, with no additional text. For example, the printed line must look like a single Python list literal of three inner lists.", "solution": "We begin from the convolution representation for Linear Time-Invariant (LTI) systems. If $g(t)$ denotes the impulse response of a stable, proper Single-Input Single-Output (SISO) system with transfer function $G(s)$, then for an input $u(t)$ the output is $y(t) = (g * u)(t) = \\int_{0}^{\\infty} g(\\tau) u(t - \\tau) \\, d\\tau$. The Bounded-Input, Bounded-Output (BIBO) stability condition follows by taking absolute values and using Hölder's inequality: if $\\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt  \\infty$, then $\\lVert y \\rVert_{\\infty} \\le \\left( \\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt \\right) \\lVert u \\rVert_{\\infty}$. This gives a conservative bound for general bounded inputs, expressed in terms of the $L^{1}$ norm of the impulse response.\n\nFor steady-state sinusoidal inputs, consider $u(t) = A \\sin(\\omega_0 t)$ with amplitude $A$ and frequency $\\omega_0$ in radians per second. The Fourier transform formalism for stable, proper LTI systems gives $Y(j \\omega) = G(j \\omega) U(j \\omega)$ in the distributional sense; in particular, the steady-state output for a sinusoidal input is a sinusoid at the same frequency with amplitude $A \\lvert G(j \\omega_0) \\rvert$. Denote the Hardy space infinity norm (the $\\mathcal{H}_{\\infty}$ norm) for SISO systems by $\\lVert G \\rVert_{\\infty} = \\sup_{\\omega \\in [0,\\infty)} \\lvert G(j \\omega) \\rvert$. It follows that $A \\lvert G(j \\omega_0) \\rvert \\le A \\lVert G \\rVert_{\\infty}$, providing a bound on the steady-state output amplitude of the sinusoid.\n\nThus, two complementary induced gains arise from first principles:\n- An $L^{\\infty} \\to L^{\\infty}$ bound using the impulse response absolute integrability: $\\lVert y \\rVert_{\\infty} \\le \\lVert g \\rVert_{1} \\lVert u \\rVert_{\\infty}$ with $\\lVert g \\rVert_{1} = \\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt$.\n- A sinusoidal (single-frequency) bound using the $\\mathcal{H}_{\\infty}$ norm: the steady-state output amplitude is $A \\lvert G(j \\omega_0) \\rvert \\le A \\lVert G \\rVert_{\\infty}$.\n\nAlgorithmic design:\n1) Estimating $\\lVert G \\rVert_{\\infty}$ by frequency gridding. For SISO systems, $\\lVert G \\rVert_{\\infty} = \\sup_{\\omega \\ge 0} \\lvert G(j \\omega) \\rvert$. We construct a frequency grid that includes $\\omega = 0$ and a logarithmically spaced set of $N_{\\omega}$ points between $\\omega_{\\min}$ and $\\omega_{\\max}$. Using the specified values, set $\\omega_{\\min} = 10^{-3}$, $\\omega_{\\max} = 10^{3}$, and $N_{\\omega} = 20000$. Evaluate $G(j \\omega)$ via the polynomial ratio $G(s) = N(s)/D(s)$ at $s = j \\omega$ over this grid, compute magnitudes $\\lvert G(j \\omega) \\rvert$, and take their maximum. Record also the grid frequency at which this maximum occurs as an estimate $\\widehat{\\omega}_{\\mathrm{pk}}$ of the peak location.\n2) Estimating $\\lVert g \\rVert_{1}$ by numerical quadrature. Extract the poles $\\{ p_k \\}$ of $G(s)$ from the denominator polynomial. For stable systems, all poles satisfy $\\operatorname{Re}(p_k)  0$. Set $\\tau_{\\max} = \\max_{k} 1 / \\lvert \\operatorname{Re}(p_k) \\rvert$, the slowest time constant that dominates the long tail of $g(t)$. Choose a final time $T_{\\mathrm{end}} = \\alpha \\tau_{\\max}$ with $\\alpha = 12$ so that the exponential tail $\\mathrm{e}^{-t/\\tau_{\\max}}$ is reduced to approximately $\\mathrm{e}^{-\\alpha}$. Construct a uniform time grid with step $\\Delta t = \\tau_{\\max} / 200$, which provides roughly $200$ samples per largest time constant and hence sufficient resolution of the transient and tail. Compute $g(t)$ on this grid using an impulse response solver and approximate the integral $\\int_{0}^{T_{\\mathrm{end}}} \\lvert g(t) \\rvert \\, dt$ via the trapezoidal rule. The residual integral from $T_{\\mathrm{end}}$ to $\\infty$ is negligible due to the exponential decay implied by stability, with a conservatively small relative error on the order of $\\mathrm{e}^{-\\alpha}$.\n3) Using these estimates in the bounds. For the specified sinusoidal input amplitude $A$ and frequency $\\omega_0$, compute the exact steady-state output amplitude $A \\lvert G(j \\omega_0) \\rvert$, and the bound $\\widehat{\\lVert G \\rVert_{\\infty}} \\, A$. For the general bounded input with $\\lVert u \\rVert_{\\infty} \\le U_{\\max}$, compute the bound $\\widehat{\\lVert g \\rVert_{1}} \\, U_{\\max}$.\n\nNumerical details for the test suite:\n- Case $1$: $G(s) = \\dfrac{20}{s^{2} + 12 s + 20}$; $A = 1.0$; $\\omega_0 = 1.0$ radians per second; $U_{\\max} = 0.8$.\n- Case $2$: $G(s) = \\dfrac{s - 1}{s^{2} + 4 s + 3}$; $A = 1.5$; $\\omega_0 = 2.0$ radians per second; $U_{\\max} = 1.2$.\n- Case $3$: $G(s) = \\dfrac{25}{s^{2} + 0.5 s + 25}$; $A = 0.5$; $\\omega_0 = 5.0$ radians per second; $U_{\\max} = 0.6$.\n\nThe program implements:\n- A function to evaluate $\\lvert G(j \\omega) \\rvert$ via polynomial evaluation at $s = j \\omega$.\n- A function to estimate $\\lVert G \\rVert_{\\infty}$ and $\\widehat{\\omega}_{\\mathrm{pk}}$ via the specified grid.\n- A function to estimate $\\lVert g \\rVert_{1}$ using $T_{\\mathrm{end}} = 12 \\tau_{\\max}$ and $\\Delta t = \\tau_{\\max} / 200$, where $\\tau_{\\max}$ is computed from the denominator roots.\n- For each case, computation of the six outputs: $\\widehat{\\lVert G \\rVert_{\\infty}}$, $\\widehat{\\omega}_{\\mathrm{pk}}$, $\\widehat{\\lVert G \\rVert_{\\infty}} \\, A$, $A \\lvert G(j \\omega_0) \\rvert$, $\\widehat{\\lVert g \\rVert_{1}}$, and $\\widehat{\\lVert g \\rVert_{1}} \\, U_{\\max}$.\n\nThe final output is a single line consisting of a list of three inner lists (one per case), each inner list containing the six floating-point values in the order described above, with angle units in radians per second. No additional text is printed.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef eval_Gjw_mag(num, den, w):\n    \"\"\"\n    Compute |G(jw)| for a SISO transfer function G(s) = N(s)/D(s)\n    at frequencies w (array), where s = j*w.\n    \"\"\"\n    s = 1j * w\n    num_eval = np.polyval(num, s)\n    den_eval = np.polyval(den, s)\n    H = num_eval / den_eval\n    return np.abs(H)\n\ndef hinf_estimate(num, den, wmin=1e-3, wmax=1e3, npts=20000):\n    \"\"\"\n    Estimate ||G||_inf = sup_w |G(jw)| by frequency gridding.\n    Includes w=0 and a log-spaced grid from wmin to wmax.\n    Returns (hinf_est, w_peak_est).\n    \"\"\"\n    # Construct frequency grid with w=0 and log-spaced positive frequencies\n    w_log = np.logspace(np.log10(wmin), np.log10(wmax), npts)\n    w_grid = np.concatenate(([0.0], w_log))\n    mags = eval_Gjw_mag(num, den, w_grid)\n    idx = int(np.argmax(mags))\n    return float(mags[idx]), float(w_grid[idx])\n\ndef impulse_l1_norm(num, den, alpha=12.0, samples_per_tau=200):\n    \"\"\"\n    Estimate ||g||_1 = ∫_0^∞ |g(t)| dt by computing the impulse response g(t)\n    on [0, T_end] with T_end = alpha * tau_max, where tau_max is the largest time constant\n    inferred from the real parts of the poles. Use a uniform grid with Δt = tau_max / samples_per_tau\n    and trapezoidal rule.\n    \"\"\"\n    # Compute poles from denominator polynomial\n    poles = np.roots(den)\n    re = np.real(poles)\n    # For stability, all real parts must be negative\n    if np.any(re >= 0):\n        # Not asymptotically stable; L1 norm diverges\n        return np.inf\n    tau_max = 1.0 / np.min(-re)  # largest time constant = 1 / min(|Re(p)|)\n    T_end = alpha * tau_max\n    dt = tau_max / samples_per_tau\n    # Number of points; ensure at least 2 points\n    n_points = max(int(np.ceil(T_end / dt)) + 1, 2)\n    t = np.linspace(0.0, T_end, n_points)\n    # Impulse response using scipy.signal.impulse for analog system\n    tout, g = signal.impulse((num, den), T=t)\n    # Numerical integration of |g(t)| over [0, T_end]\n    l1 = float(np.trapz(np.abs(g), tout))\n    return l1\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (num, den, A_sin, omega0, Umax)\n    test_cases = [\n        (np.array([20.0]),            np.array([1.0, 12.0, 20.0]), 1.0, 1.0, 0.8),\n        (np.array([1.0, -1.0]),       np.array([1.0, 4.0, 3.0]),   1.5, 2.0, 1.2),\n        (np.array([25.0]),            np.array([1.0, 0.5, 25.0]),  0.5, 5.0, 0.6),\n    ]\n\n    # Frequency grid parameters for H-infinity estimate\n    wmin = 1e-3\n    wmax = 1e3\n    npts = 20000\n\n    results = []\n    for num, den, A, w0, Umax in test_cases:\n        # Estimate H-infinity norm and peak frequency\n        hinf, wpk = hinf_estimate(num, den, wmin=wmin, wmax=wmax, npts=npts)\n        # Bound on sinusoidal output amplitude using H-infinity\n        bound_sinusoid = hinf * A\n        # Exact steady-state sinusoidal output amplitude at w0\n        exact_sinusoid = A * eval_Gjw_mag(num, den, np.array([w0]))[0]\n        # Estimate L1 norm of impulse response\n        l1 = impulse_l1_norm(num, den, alpha=12.0, samples_per_tau=200)\n        # BIBO bound for general bounded input\n        bound_general = l1 * Umax if np.isfinite(l1) else float('inf')\n\n        # Collect results per case: [hinf, wpk, bound_sinusoid, exact_sinusoid, l1, bound_general]\n        results.append([hinf, wpk, bound_sinusoid, exact_sinusoid, l1, bound_general])\n\n    # Format the output as a single line: list of lists, no extra text.\n    # Use fixed formatting to avoid spaces.\n    formatted_cases = []\n    for lst in results:\n        formatted = \"[\" + \",\".join(f\"{x:.6f}\" if np.isfinite(x) else \"inf\" for x in lst) + \"]\"\n        formatted_cases.append(formatted)\n    print(\"[\" + \",\".join(formatted_cases) + \"]\")\n\nsolve()\n```", "id": "2691131"}]}