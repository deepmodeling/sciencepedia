{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with the most fundamental task: constructing the graph Laplacian matrix from first principles. This exercise provides essential practice in translating a graph's topology into its core algebraic representations—the adjacency, degree, and Laplacian matrices. By then computing the full spectrum of the Laplacian for a simple yet representative network, you will build a concrete foundation for understanding its properties, which are central to analyzing multi-agent systems [@problem_id:2710595].", "problem": "In a continuous-time multi-agent consensus network with $N=4$ identical agents, the interaction topology is an undirected weighted graph with bidirectional couplings. The agents are labeled $1,2,3,4$, and the edges are $\\{(1,2),(2,3),(3,4),(4,1)\\}$, each with weight $1$. Using only the fundamental definitions of the adjacency matrix $A$, the degree matrix $D$, and the graph Laplacian $L$, proceed as follows:\n\n- Construct the adjacency matrix $A \\in \\mathbb{R}^{4 \\times 4}$, where $A_{ij}=A_{ji}$ equals the edge weight between nodes $i$ and $j$ for $i \\neq j$, and $A_{ii}=0$ for all $i$.\n- Construct the degree matrix $D \\in \\mathbb{R}^{4 \\times 4}$, where $D$ is diagonal with entries $D_{ii} = \\sum_{j=1}^{4} A_{ij}$.\n- Construct the Laplacian matrix $L \\in \\mathbb{R}^{4 \\times 4}$, defined by $L = D - A$.\n- Compute all eigenvalues of $L$ exactly and present them in nondecreasing order.\n\nExpress the final eigenvalues as exact numbers (no rounding). Your final answer must be a single row matrix containing the eigenvalues in nondecreasing order, with no units.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- Number of agents: $N=4$.\n- Agent labels: $1,2,3,4$.\n- Topology: Undirected weighted graph.\n- Edges: $\\{(1,2),(2,3),(3,4),(4,1)\\}$.\n- Edge weights: All equal to $1$.\n- Adjacency matrix definition: $A \\in \\mathbb{R}^{4 \\times 4}$, with $A_{ij}=A_{ji}$ being the weight of the edge between nodes $i$ and $j$ for $i \\neq j$, and $A_{ii}=0$.\n- Degree matrix definition: $D \\in \\mathbb{R}^{4 \\times 4}$, a diagonal matrix with $D_{ii} = \\sum_{j=1}^{4} A_{ij}$.\n- Graph Laplacian definition: $L \\in \\mathbb{R}^{4 \\times 4}$, given by $L = D - A$.\n- Objective: Compute all eigenvalues of $L$ exactly and present them in nondecreasing order.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in graph theory and linear algebra, which are foundational disciplines for the study of multi-agent systems and control theory. The definitions of the adjacency, degree, and Laplacian matrices are standard.\n- **Well-Posedness**: The problem is well-posed. The graph is completely specified by its nodes, edges, and weights. The task of computing eigenvalues for a given matrix is a standard, solvable problem in linear algebra. Since the graph is undirected, the resulting Laplacian matrix $L$ is real and symmetric, which guarantees the existence of real eigenvalues.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective content.\n\n**Step 3: Verdict and Action**\n- **Verdict**: The problem is valid. It is scientifically sound, well-posed, objective, and complete.\n- **Action**: Proceed with the solution.\n\nThe following steps construct the required matrices and compute the eigenvalues of the graph Laplacian.\n\n**Construction of the Adjacency Matrix $A$**\nThe graph consists of $N=4$ nodes labeled $1, 2, 3, 4$. The edges are given as $\\{(1,2),(2,3),(3,4),(4,1)\\}$. Since the graph is undirected and all edge weights are $1$, the non-zero off-diagonal entries of the adjacency matrix $A$ are determined as follows:\n- Edge $(1,2)$ implies $A_{12} = A_{21} = 1$.\n- Edge $(2,3)$ implies $A_{23} = A_{32} = 1$.\n- Edge $(3,4)$ implies $A_{34} = A_{43} = 1$.\n- Edge $(4,1)$ implies $A_{41} = A_{14} = 1$.\nAll other off-diagonal entries are $0$. The diagonal entries $A_{ii}$ are all $0$.\nThe resulting adjacency matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0\n\\end{pmatrix}\n$$\n\n**Construction of the Degree Matrix $D$**\nThe degree matrix $D$ is a diagonal matrix where each diagonal entry $D_{ii}$ is the degree of node $i$, calculated as the sum of the entries in the $i$-th row of $A$.\n- $D_{11} = \\sum_{j=1}^{4} A_{1j} = 0+1+0+1 = 2$.\n- $D_{22} = \\sum_{j=1}^{4} A_{2j} = 1+0+1+0 = 2$.\n- $D_{33} = \\sum_{j=1}^{4} A_{3j} = 0+1+0+1 = 2$.\n- $D_{44} = \\sum_{j=1}^{4} A_{4j} = 1+0+1+0 = 2$.\nThe graph is 2-regular. The degree matrix $D$ is:\n$$\nD = \\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 \\\\\n0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 2\n\\end{pmatrix}\n$$\n\n**Construction of the Laplacian Matrix $L$**\nThe graph Laplacian $L$ is defined as $L = D - A$.\n$$\nL = \\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 \\\\\n0 & 0 & 2 & 0 \\\\\n0 & 0 & 0 & 2\n\\end{pmatrix} - \\begin{pmatrix}\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1 \\\\\n1 & 0 & 1 & 0\n\\end{pmatrix} = \\begin{pmatrix}\n2 & -1 & 0 & -1 \\\\\n-1 & 2 & -1 & 0 \\\\\n0 & -1 & 2 & -1 \\\\\n-1 & 0 & -1 & 2\n\\end{pmatrix}\n$$\n\n**Computation of the Eigenvalues of $L$**\nThe eigenvalues $\\lambda$ of $L$ are the roots of the characteristic equation $\\det(L - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix}\n2-\\lambda & -1 & 0 & -1 \\\\\n-1 & 2-\\lambda & -1 & 0 \\\\\n0 & -1 & 2-\\lambda & -1 \\\\\n-1 & 0 & -1 & 2-\\lambda\n\\end{pmatrix} = 0\n$$\nLet $x = 2-\\lambda$. The characteristic determinant is:\n$$\n\\det \\begin{pmatrix}\nx & -1 & 0 & -1 \\\\\n-1 & x & -1 & 0 \\\\\n0 & -1 & x & -1 \\\\\n-1 & 0 & -1 & x\n\\end{pmatrix}\n$$\nWe compute the determinant using cofactor expansion along the first row:\n$$\n\\text{det} = x \\begin{vmatrix}\nx & -1 & 0 \\\\\n-1 & x & -1 \\\\\n0 & -1 & x\n\\end{vmatrix} - (-1) \\begin{vmatrix}\n-1 & -1 & 0 \\\\\n0 & x & -1 \\\\\n-1 & -1 & x\n\\end{vmatrix} + 0 - (-1) \\begin{vmatrix}\n-1 & x & -1 \\\\\n0 & -1 & x \\\\\n-1 & 0 & -1\n\\end{vmatrix}\n$$\nThe minors are evaluated as:\n- $\\begin{vmatrix}\nx & -1 & 0 \\\\\n-1 & x & -1 \\\\\n0 & -1 & x\n\\end{vmatrix} = x(x^2 - 1) - (-1)(-x) = x^3 - x - x = x^3 - 2x$.\n- $\\begin{vmatrix}\n-1 & -1 & 0 \\\\\n0 & x & -1 \\\\\n-1 & -1 & x\n\\end{vmatrix} = -1(x^2 - 1) - (-1)(0 - 1) = -x^2 + 1 - 1 = -x^2$.\n- $\\begin{vmatrix}\n-1 & x & -1 \\\\\n0 & -1 & x \\\\\n-1 & 0 & -1\n\\end{vmatrix} = -1(1 - 0) - x(0 - (-x)) + (-1)(0 - 1) = -1 - x^2 + 1 = -x^2$.\n\nSubstituting these back into the determinant expression:\n$$\n\\text{det} = x(x^3 - 2x) + (-x^2) + (-x^2) = x^4 - 2x^2 - 2x^2 = x^4 - 4x^2\n$$\nThe characteristic equation is $x^4 - 4x^2 = 0$, which can be factored as $x^2(x^2 - 4) = 0$, or $x^2(x-2)(x+2) = 0$.\nThe roots for $x$ are $x = 0$ (with multiplicity $2$), $x=2$, and $x=-2$.\n\nWe now find the eigenvalues $\\lambda$ by substituting back $x = 2-\\lambda$:\n- For $x=0$: $2-\\lambda = 0 \\implies \\lambda = 2$. This eigenvalue has a multiplicity of $2$.\n- For $x=2$: $2-\\lambda = 2 \\implies \\lambda = 0$.\n- For $x=-2$: $2-\\lambda = -2 \\implies \\lambda = 4$.\n\nThe eigenvalues of the Laplacian matrix $L$ are $\\{0, 2, 2, 4\\}$. Arranging them in nondecreasing order gives $0, 2, 2, 4$.\nThe smallest eigenvalue is $\\lambda_1 = 0$, which is expected for any connected undirected graph, and its multiplicity is equal to the number of connected components (here, one). The second smallest eigenvalue, $\\lambda_2=2$, is the algebraic connectivity of the graph.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 2 & 2 & 4\n\\end{pmatrix}\n}\n$$", "id": "2710595"}, {"introduction": "Having mastered the construction of the Laplacian, we now delve into one of its most elegant properties through the Matrix Tree Theorem. This powerful theorem reveals a deep connection between the algebraic structure of the Laplacian and the combinatorial topology of the network. This practice requires you to verify the theorem by performing two distinct calculations—one algebraic and one combinatorial—demonstrating that any cofactor of the Laplacian equals the sum of the weights of all spanning trees in the graph [@problem_id:2710624].", "problem": "Consider an undirected, connected, weighted communication graph for a four-agent network with node set $\\{1,2,3,4\\}$ and edge set with symmetric positive weights:\n- Edge $(1,2)$ with weight $2$,\n- Edge $(2,3)$ with weight $3$,\n- Edge $(3,4)$ with weight $4$,\n- Edge $(4,1)$ with weight $5$,\n- Edge $(2,4)$ with weight $6$.\n\nStart from first principles:\n- The weighted adjacency matrix $A$ has entries $a_{ij}$ equal to the weight on edge $(i,j)$ if nodes $i$ and $j$ are adjacent and $0$ otherwise.\n- The weighted degree of node $i$ is $d_i=\\sum_{j=1}^{4} a_{ij}$, and the degree matrix is $D=\\mathrm{diag}(d_1,d_2,d_3,d_4)$.\n- The (combinatorial) graph Laplacian is $L=D-A$.\n- The weight of a spanning tree is defined as the product of the weights of its edges, and the total spanning-tree weight $W$ is the sum of the weights of all spanning trees.\n\nTasks:\n1. Construct $L$ from the definitions above and compute a Laplacian cofactor by deleting row $4$ and column $4$, then taking the determinant of the resulting $3\\times 3$ principal minor.\n2. Independently enumerate all spanning trees of the given graph, compute their individual weights (product of edge weights in the tree), and sum them to obtain $W$.\n3. Verify numerically that the value from Task $1$ equals $W$, and report this common value.\n\nExpress the final answer as an exact integer with no units.", "solution": "The problem statement is found to be scientifically grounded, well-posed, objective, and internally consistent. It is a valid application of the Matrix Tree Theorem for weighted, undirected graphs. We proceed with the solution by executing the specified tasks.\n\nThe system is a network of $4$ agents, which can be modeled as a graph $\\mathcal{G} = (\\mathcal{V}, \\mathcal{E})$ with node set $\\mathcal{V} = \\{1, 2, 3, 4\\}$ and an edge set $\\mathcal{E}$ with corresponding positive weights. The graph is undirected, so for any edge $(i, j)$, the weights are symmetric, $w_{ij} = w_{ji}$. The specified non-zero weights are:\n- $w_{12} = w_{21} = 2$\n- $w_{23} = w_{32} = 3$\n- $w_{34} = w_{43} = 4$\n- $w_{41} = w_{14} = 5$\n- $w_{24} = w_{42} = 6$\n\n**Task 1: Construction of the Laplacian Matrix and Cofactor Calculation**\n\nFirst, we construct the weighted adjacency matrix $A$, where each entry $a_{ij}$ is the weight $w_{ij}$ of the edge $(i,j)$, or $0$ if no such edge exists.\n$$\nA = \\begin{pmatrix}\n0 & 2 & 0 & 5 \\\\\n2 & 0 & 3 & 6 \\\\\n0 & 3 & 0 & 4 \\\\\n5 & 6 & 4 & 0\n\\end{pmatrix}\n$$\nNext, we determine the weighted degree of each node $i$, defined as $d_i = \\sum_{j=1}^{4} a_{ij}$.\n- $d_1 = a_{12} + a_{14} = 2 + 5 = 7$\n- $d_2 = a_{21} + a_{23} + a_{24} = 2 + 3 + 6 = 11$\n- $d_3 = a_{32} + a_{34} = 3 + 4 = 7$\n- $d_4 = a_{41} + a_{42} + a_{43} = 5 + 6 + 4 = 15$\n\nThe degree matrix $D$ is the diagonal matrix of these degrees:\n$$\nD = \\begin{pmatrix}\n7 & 0 & 0 & 0 \\\\\n0 & 11 & 0 & 0 \\\\\n0 & 0 & 7 & 0 \\\\\n0 & 0 & 0 & 15\n\\end{pmatrix}\n$$\nThe graph Laplacian matrix $L$ is defined as $L = D - A$.\n$$\nL = \\begin{pmatrix}\n7 & -2 & 0 & -5 \\\\\n-2 & 11 & -3 & -6 \\\\\n0 & -3 & 7 & -4 \\\\\n-5 & -6 & -4 & 15\n\\end{pmatrix}\n$$\nWe must compute the determinant of the $3 \\times 3$ principal minor obtained by deleting row $4$ and column $4$ of $L$. Let us denote this submatrix as $L_{44}$.\n$$\nL_{44} = \\begin{pmatrix}\n7 & -2 & 0 \\\\\n-2 & 11 & -3 \\\\\n0 & -3 & 7\n\\end{pmatrix}\n$$\nThe determinant is calculated as follows:\n$$\n\\det(L_{44}) = 7 \\cdot \\det \\begin{pmatrix} 11 & -3 \\\\ -3 & 7 \\end{pmatrix} - (-2) \\cdot \\det \\begin{pmatrix} -2 & -3 \\\\ 0 & 7 \\end{pmatrix} + 0 \\cdot \\det \\begin{pmatrix} -2 & 11 \\\\ 0 & -3 \\end{pmatrix}\n$$\n$$\n\\det(L_{44}) = 7 \\cdot (11 \\cdot 7 - (-3) \\cdot (-3)) + 2 \\cdot (-2 \\cdot 7 - (-3) \\cdot 0)\n$$\n$$\n\\det(L_{44}) = 7 \\cdot (77 - 9) + 2 \\cdot (-14)\n$$\n$$\n\\det(L_{44}) = 7 \\cdot (68) - 28\n$$\n$$\n\\det(L_{44}) = 476 - 28 = 448\n$$\nThe value of the Laplacian cofactor is $448$.\n\n**Task 2: Enumeration of Spanning Trees and Sum of Weights**\n\nA spanning tree of a graph with $n$ nodes must contain exactly $n-1$ edges and be acyclic. For this graph with $n=4$ nodes, a spanning tree must have $3$ edges. The graph has a total of $m=5$ edges. The number of ways to choose $3$ edges from $5$ is given by the binomial coefficient $\\binom{5}{3} = \\frac{5!}{3!2!} = 10$.\n\nHowever, not all combinations of $3$ edges form a tree; any set of $3$ edges that forms a cycle must be excluded. The given graph has two cycles of length $3$ (triangles):\n1.  Cycle $1-2-4-1$ with edges $\\{(1,2), (2,4), (4,1)\\}$.\n2.  Cycle $2-3-4-2$ with edges $\\{(2,3), (3,4), (2,4)\\}$.\n\nTherefore, there are $10 - 2 = 8$ spanning trees. We enumerate them, calculate their individual weights (product of edge weights), and sum them to find the total spanning-tree weight $W$.\n\nThe edge weights are $w_{12}=2$, $w_{23}=3$, $w_{34}=4$, $w_{41}=5$, $w_{24}=6$.\n\n1.  Tree $T_1 = \\{(1,2), (2,3), (3,4)\\}$. This forms a path $1-2-3-4$. Weight $W_1 = w_{12} \\cdot w_{23} \\cdot w_{34} = 2 \\cdot 3 \\cdot 4 = 24$.\n2.  Tree $T_2 = \\{(1,2), (2,3), (4,1)\\}$. This forms a path $3-2-1-4$. Weight $W_2 = w_{12} \\cdot w_{23} \\cdot w_{41} = 2 \\cdot 3 \\cdot 5 = 30$.\n3.  Tree $T_3 = \\{(1,2), (2,3), (2,4)\\}$. This is a star graph centered at node $2$. Weight $W_3 = w_{12} \\cdot w_{23} \\cdot w_{24} = 2 \\cdot 3 \\cdot 6 = 36$.\n4.  Tree $T_4 = \\{(1,2), (3,4), (4,1)\\}$. This forms a path $2-1-4-3$. Weight $W_4 = w_{12} \\cdot w_{34} \\cdot w_{41} = 2 \\cdot 4 \\cdot 5 = 40$.\n5.  Tree $T_5 = \\{(1,2), (3,4), (2,4)\\}$. This forms a path $1-2-4-3$. Weight $W_5 = w_{12} \\cdot w_{34} \\cdot w_{24} = 2 \\cdot 4 \\cdot 6 = 48$.\n6.  Tree $T_6 = \\{(2,3), (3,4), (4,1)\\}$. This forms a path $2-3-4-1$. Weight $W_6 = w_{23} \\cdot w_{34} \\cdot w_{41} = 3 \\cdot 4 \\cdot 5 = 60$.\n7.  Tree $T_7 = \\{(2,3), (4,1), (2,4)\\}$. This forms a path $3-2-4-1$. Weight $W_7 = w_{23} \\cdot w_{41} \\cdot w_{24} = 3 \\cdot 5 \\cdot 6 = 90$.\n8.  Tree $T_8 = \\{(3,4), (4,1), (2,4)\\}$. This is a star graph centered at node $4$. Weight $W_8 = w_{34} \\cdot w_{41} \\cdot w_{24} = 4 \\cdot 5 \\cdot 6 = 120$.\n\nThe total spanning-tree weight $W$ is the sum of the weights of these $8$ trees:\n$$\nW = W_1 + W_2 + W_3 + W_4 + W_5 + W_6 + W_7 + W_8\n$$\n$$\nW = 24 + 30 + 36 + 40 + 48 + 60 + 90 + 120\n$$\n$$\nW = 448\n$$\n\n**Task 3: Verification and Final Answer**\n\nThe value obtained from Task $1$ is the Laplacian cofactor, which is $448$.\nThe value obtained from Task $2$ is the sum of the weights of all spanning trees, $W = 448$.\n\nThe two values are equal, which numerically verifies the weighted version of the Matrix Tree Theorem for this graph. The theorem states that any cofactor of the graph Laplacian matrix is equal to the sum of the weights of all spanning trees of the graph.\n\nThe common value is $448$.", "answer": "$$\\boxed{448}$$", "id": "2710624"}, {"introduction": "This final practice transitions from theoretical understanding to a cornerstone application: spectral graph partitioning. Here, you will use the Fiedler vector—the eigenvector associated with the algebraic connectivity $\\lambda_2$—to find meaningful clusters or communities within a network. By implementing this algorithm, you will gain hands-on experience with how the spectral properties of the Laplacian can be leveraged to solve practical problems in network analysis and design [@problem_id:2710619].", "problem": "You are given a set of small undirected weighted graphs. For each graph, do the following in order: construct its combinatorial graph Laplacian, compute a Fiedler vector numerically, use the entries of the Fiedler vector to propose a binary partition by a zero-threshold rule, and compute the resulting cut weight across that partition. The task must be solved from first principles of spectral graph theory.\n\nUse the following fundamental definitions as your base:\n- For an undirected weighted graph with $n$ vertices and symmetric, nonnegative adjacency matrix $A \\in \\mathbb{R}^{n \\times n}$, the degree matrix $D \\in \\mathbb{R}^{n \\times n}$ is the diagonal matrix with $D_{ii} = \\sum_{j=1}^{n} A_{ij}$. The combinatorial graph Laplacian is $L = D - A$.\n- The algebraic connectivity is the second-smallest eigenvalue of $L$. A corresponding eigenvector is called a Fiedler vector. Equivalently, a Fiedler vector is any minimizer of the Rayleigh quotient $x^\\top L x$ over all $x \\in \\mathbb{R}^n$ such that $x^\\top \\mathbf{1} = 0$ and $\\|x\\|_2 = 1$, where $\\mathbf{1}$ is the all-ones vector.\n- Given a Fiedler vector $v \\in \\mathbb{R}^n$, propose a partition $\\{S, \\bar S\\}$ of the node set by the zero-threshold rule: $S = \\{ i \\in \\{1,\\dots,n\\} \\mid v_i \\ge 0 \\}$ and $\\bar S = \\{ i \\in \\{1,\\dots,n\\} \\mid v_i < 0 \\}$.\n- The cut weight between $S$ and $\\bar S$ is $\\mathrm{cut}(S,\\bar S) = \\sum_{i \\in S} \\sum_{j \\in \\bar S} A_{ij}$.\n\nYour program must:\n- For each specified test graph, construct $L$, compute a Fiedler vector numerically, form $\\{S,\\bar S\\}$ using the zero-threshold rule, and output the resulting cut weight as a floating-point number rounded to $6$ decimal places.\n\nImportant implementation details:\n- All eigen-computations must be performed on the symmetric real Laplacian $L$.\n- Select the Fiedler vector as an eigenvector associated with the second-smallest eigenvalue of $L$.\n- The partition must strictly follow the rule $v_i \\ge 0$ goes to $S$ and $v_i < 0$ goes to $\\bar S$.\n- The cut weight for an undirected graph must count each undirected edge exactly once.\n\nTest suite:\n- Case $1$ ($n = 6$): Two unit-weight triangles weakly connected. Nonzero symmetric adjacency entries $A_{12} = A_{21} = 1$, $A_{23} = A_{32} = 1$, $A_{13} = A_{31} = 1$, $A_{45} = A_{54} = 1$, $A_{56} = A_{65} = 1$, $A_{46} = A_{64} = 1$, and a single weak inter-cluster edge $A_{34} = A_{43} = 0.2$. All other entries are $0$.\n- Case $2$ ($n = 4$): A weighted chain with a weak middle link. Nonzero symmetric adjacency entries $A_{12} = A_{21} = 2$, $A_{23} = A_{32} = 0.1$, $A_{34} = A_{43} = 2$. All other entries are $0$.\n- Case $3$ ($n = 5$): A lollipop-like graph. Nonzero symmetric adjacency entries $A_{12} = A_{21} = 1$, $A_{23} = A_{32} = 1$, $A_{13} = A_{31} = 1$, $A_{34} = A_{43} = 0.4$, $A_{45} = A_{54} = 0.4$. All other entries are $0$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above test cases, with each cut weight rounded to $6$ decimal places. For example: \"[x1,x2,x3]\". No spaces are permitted in the output string.\n\nNo physical quantities or angles are involved, so no unit specification is required. Ensure numerical stability and determinism by following the partition rule as stated and using a standard symmetric eigensolver.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded, well-posed, and objective. The problem is based entirely on established, formal definitions from spectral graph theory within the field of control theory and applied mathematics. It provides all necessary data for the construction of the adjacency matrices, and the subsequent computational tasks are unambiguous. The procedure specified is deterministic and leads to a unique, verifiable result for each test case, contingent on the output of a standard numerical eigensolver.\n\nWe shall now proceed with the solution, following the prescribed methodology from first principles.\n\nThe core task is to analyze a given undirected weighted graph $G = (V, E, w)$, where $V$ is the set of $n$ vertices, $E$ is the set of edges, and $w$ is the weight function. The graph is represented by its symmetric adjacency matrix $A$, where $A_{ij} = w(i, j) > 0$ if an edge exists between vertices $i$ and $j$, and $A_{ij} = 0$ otherwise.\n\nThe procedure for each graph is as follows:\n\n1.  **Construct the Graph Laplacian**:\n    The degree of a vertex $i$ is $d_i = \\sum_{j=1}^{n} A_{ij}$. The degree matrix $D$ is a diagonal matrix with $D_{ii} = d_i$. The combinatorial graph Laplacian, $L$, is defined as:\n    $$L = D - A$$\n    This matrix is real, symmetric, and positive semi-definite. For a connected graph with $n$ vertices, its eigenvalues $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_n$ have the property that $\\lambda_2 > 0$.\n\n2.  **Compute the Fiedler Vector**:\n    The second-smallest eigenvalue of $L$, denoted $\\lambda_2$, is the algebraic connectivity of the graph. Any eigenvector $v_2$ corresponding to $\\lambda_2$ is a Fiedler vector. We compute the complete eigenspectrum of the symmetric matrix $L$ numerically. Since $L$ is real and symmetric, its eigenvalues are real and its eigenvectors form an orthonormal basis. We use a numerical routine equivalent to `numpy.linalg.eigh`, which returns eigenvalues in ascending order. The Fiedler vector is the eigenvector corresponding to the second eigenvalue in this sorted list.\n\n3.  **Propose a Binary Partition**:\n    Given the Fiedler vector $v_2 \\in \\mathbb{R}^n$, we partition the vertex set $V$ into two disjoint subsets, $S$ and $\\bar{S}$, based on a zero-threshold rule applied to the components of $v_2$.\n    $$S = \\{ i \\in V \\mid (v_2)_i \\ge 0 \\}$$\n    $$\\bar{S} = \\{ i \\in V \\mid (v_2)_i < 0 \\}$$\n    The set of vertices is partitioned as $V = S \\cup \\bar{S}$.\n\n4.  **Compute the Cut Weight**:\n    The quality of this partition is assessed by the weight of the cut, which is the sum of weights of all edges connecting a vertex in $S$ to a vertex in $\\bar{S}$.\n    $$\\mathrm{cut}(S, \\bar{S}) = \\sum_{i \\in S} \\sum_{j \\in \\bar{S}} A_{ij}$$\n    For an undirected graph, this sum counts each inter-partition edge exactly once due to the structure of the summation over disjoint sets of vertices.\n\nWe now apply this four-step procedure to each test case provided. The vertices are indexed starting from $1$ in the problem description, which we map to $0$-based indices for matrix representation (i.e., vertex $k$ corresponds to index $k-1$).\n\n**Case 1: Two weakly connected triangles ($n=6$)**\nThe non-zero adjacency matrix entries are $A_{12}=1$, $A_{23}=1$, $A_{13}=1$, $A_{45}=1$, $A_{56}=1$, $A_{46}=1$, and $A_{34}=0.2$.\nUsing $0$-based indices, the adjacency matrix $A^{(1)}$ is:\n$$A^{(1)} = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 & 0 \\\\\n1 & 1 & 0 & 0.2 & 0 & 0 \\\\\n0 & 0 & 0.2 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 1 & 1 & 0\n\\end{pmatrix}$$\nThe degree matrix $D^{(1)}$ is the diagonal matrix of row sums of $A^{(1)}$:\n$$D^{(1)} = \\mathrm{diag}(2, 2, 2.2, 2.2, 2, 2)$$\nThe Laplacian is $L^{(1)} = D^{(1)} - A^{(1)}$. We compute a Fiedler vector $v_2^{(1)}$ of $L^{(1)}$. The signs of the components of $v_2^{(1)}$ are expected to separate the two triangular clusters. A numerical computation yields a Fiedler vector that partitions the vertices into sets $S=\\{1, 2, 3\\}$ and $\\bar{S}=\\{4, 5, 6\\}$ (or vice versa, which is equivalent for the cut weight). The cut weight is the sum of weights of edges between these two sets. The only such edge is $(3, 4)$ with weight $A_{34}=0.2$.\n$$\\mathrm{cut}(S, \\bar{S}) = A_{34}^{(1)} = 0.2$$\n\n**Case 2: Weighted chain with a weak link ($n=4$)**\nThe non-zero adjacency matrix entries are $A_{12}=2$, $A_{23}=0.1$, and $A_{34}=2$.\nThe adjacency matrix $A^{(2)}$ is:\n$$A^{(2)} = \\begin{pmatrix}\n0 & 2 & 0 & 0 \\\\\n2 & 0 & 0.1 & 0 \\\\\n0 & 0.1 & 0 & 2 \\\\\n0 & 0 & 2 & 0\n\\end{pmatrix}$$\nThe degree matrix $D^{(2)}$ is:\n$$D^{(2)} = \\mathrm{diag}(2, 2.1, 2.1, 2)$$\nThe Laplacian is $L^{(2)} = D^{(2)} - A^{(2)}$. The Fiedler vector for this chain-like graph with a weak central link is expected to partition the graph across this link. The partition will be $S=\\{1, 2\\}$ and $\\bar{S}=\\{3, 4\\}$. The cut weight is determined by the single edge $(2, 3)$ connecting these sets.\n$$\\mathrm{cut}(S, \\bar{S}) = A_{23}^{(2)} = 0.1$$\n\n**Case 3: Lollipop-like graph ($n=5$)**\nThe non-zero adjacency matrix entries are $A_{12}=1$, $A_{23}=1$, $A_{13}=1$, $A_{34}=0.4$, and $A_{45}=0.4$. This structure consists of a triangle $\\{1, 2, 3\\}$ and a path $\\{3, 4, 5\\}$ attached at vertex $3$.\nThe adjacency matrix $A^{(3)}$ is:\n$$A^{(3)} = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n1 & 1 & 0 & 0.4 & 0 \\\\\n0 & 0 & 0.4 & 0 & 0.4 \\\\\n0 & 0 & 0 & 0.4 & 0\n\\end{pmatrix}$$\nThe degree matrix $D^{(3)}$ is:\n$$D^{(3)} = \\mathrm{diag}(2, 2, 2.4, 0.8, 0.4)$$\nThe Laplacian is $L^{(3)} = D^{(3)} - A^{(3)}$. The weakest connection in this graph is the edge $(3, 4)$ which links the dense triangle subgraph to the sparser path subgraph. The Fiedler vector is expected to induce a partition separating these substructures. The most probable partition is $S=\\{1, 2, 3\\}$ and $\\bar{S}=\\{4, 5\\}$. The cut weight is determined by the single edge $(3, 4)$ connecting the two sets.\n$$\\mathrm{cut}(S, \\bar{S}) = A_{34}^{(3)} = 0.4$$\n\nThe numerical implementation will execute these steps precisely as described to obtain the final values.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the spectral graph partitioning problem for a given test suite.\n    For each graph, it computes the combinatorial Laplacian, finds a Fiedler\n    vector, partitions the graph using a zero-threshold rule, and calculates\n    the resulting cut weight.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Adjacency matrices are constructed using 0-based indexing from the\n    # 1-based problem description.\n\n    # Case 1 (n=6): Two unit-weight triangles weakly connected.\n    A1 = np.zeros((6, 6))\n    A1[0, 1] = A1[1, 0] = 1.0\n    A1[1, 2] = A1[2, 1] = 1.0\n    A1[0, 2] = A1[2, 0] = 1.0\n    A1[3, 4] = A1[4, 3] = 1.0\n    A1[4, 5] = A1[5, 4] = 1.0\n    A1[3, 5] = A1[5, 3] = 1.0\n    A1[2, 3] = A1[3, 2] = 0.2\n\n    # Case 2 (n=4): A weighted chain with a weak middle link.\n    A2 = np.zeros((4, 4))\n    A2[0, 1] = A2[1, 0] = 2.0\n    A2[1, 2] = A2[2, 1] = 0.1\n    A2[2, 3] = A2[3, 2] = 2.0\n\n    # Case 3 (n=5): A lollipop-like graph.\n    A3 = np.zeros((5, 5))\n    A3[0, 1] = A3[1, 0] = 1.0\n    A3[1, 2] = A3[2, 1] = 1.0\n    A3[0, 2] = A3[2, 0] = 1.0\n    A3[2, 3] = A3[3, 2] = 0.4\n    A3[3, 4] = A3[4, 3] = 0.4\n\n    test_cases = [A1, A2, A3]\n    results = []\n\n    for A in test_cases:\n        # Step 1: Construct the combinatorial graph Laplacian L = D - A.\n        # Degree matrix D\n        D = np.diag(np.sum(A, axis=1))\n        # Laplacian L\n        L = D - A\n\n        # Step 2: Compute a Fiedler vector numerically.\n        # np.linalg.eigh computes eigenvalues and eigenvectors for a symmetric matrix.\n        # It conveniently returns eigenvalues in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(L)\n        \n        # The Fiedler vector corresponds to the second-smallest eigenvalue.\n        # Eigenvalues are sorted, so the second one is at index 1.\n        fiedler_vector = eigenvectors[:, 1]\n\n        # Step 3: Propose a binary partition using the zero-threshold rule.\n        # S = {i | v_i >= 0}, S_bar = {i | v_i < 0}\n        n = A.shape[0]\n        S = {i for i in range(n) if fiedler_vector[i] >= 0}\n        S_bar = {i for i in range(n) if fiedler_vector[i] < 0}\n\n        # Step 4: Compute the resulting cut weight.\n        # cut(S, S_bar) = sum_{i in S, j in S_bar} A_ij\n        cut_weight = 0.0\n        for i in S:\n            for j in S_bar:\n                cut_weight += A[i, j]\n                \n        # Round the result to 6 decimal places.\n        results.append(f\"{cut_weight:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2710619"}]}