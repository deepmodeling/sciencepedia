{"hands_on_practices": [{"introduction": "The root locus method offers a powerful graphical representation of how a system's closed-loop poles move as a feedback gain is varied. This exercise reinforces a fundamental skill in classical control: calculating the breakaway points where paths depart from the real axis. By working through this problem ([@problem_id:2751323]), you will apply the core principles of the root locus construction and see how its inherent symmetry is a direct consequence of the system's real-valued nature, a property that forms a conceptual bridge to the guarantees of modern optimal control.", "problem": "Consider the unity-feedback Single-Input Single-Output (SISO) loop with open-loop transfer function $G(s)=\\dfrac{1}{s(s+2)(s+4)}$ and loop gain $K \\ge 0$. The closed-loop characteristic equation is $1+K G(s)=0$, and the root locus is defined as the set of roots of this characteristic equation as $K$ varies over the nonnegative reals. The root locus for real-rational data is symmetric with respect to the real axis because the characteristic polynomial has real coefficients for every real $K$. The real-axis segments of the locus satisfy the angle condition in parity form: a real point $s=\\sigma$ lies on the locus if and only if the number (counting multiplicity) of open-loop poles and zeros strictly to the right of $\\sigma$ on the real axis is odd.\n\nStarting from first principles of the root-locus construction as described above, perform the following:\n- Express $K$ as a function of $s$ along the real axis using the characteristic equation, and obtain the necessary condition for real-axis breakaway and reentry points by differentiating this $K(s)$ with respect to $s$ and setting $\\dfrac{dK}{ds}=0$.\n- Solve explicitly for all real solutions $s$ of $\\dfrac{dK}{ds}=0$.\n- Using only the angle-condition parity rule on the real axis (count of real open-loop poles and zeros to the right), determine which of these stationary points actually lies on the root locus.\n\nBriefly justify in words why the root locus is symmetric about the real axis and explain how this symmetry is consistent with the standard robustness guarantees of the Linear Quadratic Regulator (LQR) state-feedback design for strictly proper, real-rational plants (for example, complex-conjugate closed-loop pole symmetry and classical loop-at-input gain/phase margin guarantees). This explanatory part requires no computation and will not be graded for numerical content.\n\nProvide as your final result the exact real value(s) of the real-axis stationary point(s) that lie on the root locus, written in closed form. If there is more than one, list them in ascending order as a single row vector. No rounding is required.", "solution": "The problem given is valid as it is scientifically grounded in the principles of control theory, well-posed, objective, and internally consistent. We shall proceed with the solution.\n\nThe unity-feedback closed-loop characteristic equation is given by $1+K G(s)=0$, where the open-loop transfer function is $G(s)=\\dfrac{1}{s(s+2)(s+4)}$ and the loop gain is $K \\ge 0$.\nSubstituting $G(s)$ into the characteristic equation yields:\n$$1 + K \\frac{1}{s(s+2)(s+4)} = 0$$\nThis equation must hold for any point $s$ on the root locus. For a point $s$ on the real axis, we can express the gain $K$ as a function of $s$:\n$$K(s) = -s(s+2)(s+4)$$\nExpanding this expression, we obtain a polynomial representation for $K(s)$:\n$$K(s) = -(s(s^2 + 6s + 8)) = -s^3 - 6s^2 - 8s$$\nBreakaway and reentry points on the real axis are locations where multiple roots of the characteristic equation coincide. These points correspond to local maxima or minima of the gain $K$ along the real-axis segments of the root locus. A necessary condition for such a point is that the derivative of $K$ with respect to $s$ must be zero. We compute this derivative:\n$$\\frac{dK}{ds} = \\frac{d}{ds}(-s^3 - 6s^2 - 8s) = -3s^2 - 12s - 8$$\nSetting this derivative to zero gives the locations of all stationary points of $K(s)$:\n$$-3s^2 - 12s - 8 = 0$$\n$$3s^2 + 12s + 8 = 0$$\nWe solve this quadratic equation for $s$ using the quadratic formula, $s = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with coefficients $a=3$, $b=12$, and $c=8$.\n$$s = \\frac{-12 \\pm \\sqrt{12^2 - 4(3)(8)}}{2(3)}$$\n$$s = \\frac{-12 \\pm \\sqrt{144 - 96}}{6}$$\n$$s = \\frac{-12 \\pm \\sqrt{48}}{6}$$\nSimplifying the radical, $\\sqrt{48} = \\sqrt{16 \\times 3} = 4\\sqrt{3}$.\n$$s = \\frac{-12 \\pm 4\\sqrt{3}}{6} = \\frac{-6 \\pm 2\\sqrt{3}}{3}$$\nThe two real stationary points are:\n$$s_1 = \\frac{-6 - 2\\sqrt{3}}{3} \\approx -3.155$$\n$$s_2 = \\frac{-6 + 2\\sqrt{3}}{3} \\approx -0.845$$\n\nNext, we must determine which of these stationary points actually lie on the root locus for $K \\ge 0$. According to the provided angle condition parity rule, a point on the real axis belongs to the root locus if and only if the total number of real open-loop poles and zeros to its right is odd. The open-loop poles are at $s=0$, $s=-2$, and $s=-4$. There are no open-loop zeros.\nWe examine the segments of the real axis defined by these poles:\n1.  For $s$ in the interval $(-\\infty, -4)$, there are three poles ($p_1=0$, $p_2=-2$, $p_3=-4$) to the right. Three is an odd number, so the segment $(-\\infty, -4]$ is part of the root locus.\n2.  For $s$ in the interval $(-4, -2)$, there are two poles ($p_1=0$, $p_2=-2$) to the right. Two is an even number, so this segment is not on the root locus.\n3.  For $s$ in the interval $(-2, 0)$, there is one pole ($p_1=0$) to the right. One is an odd number, so the segment $[-2, 0]$ is part of the root locus.\n4.  For $s$ in the interval $(0, \\infty)$, there are zero poles to the right. Zero is an even number, so this segment is not on the root locus.\n\nNow we check the locations of the stationary points $s_1$ and $s_2$:\n-   The point $s_1 = \\frac{-6 - 2\\sqrt{3}}{3} \\approx -3.155$ lies in the interval $(-4, -2)$. Since this interval is not on the root locus, $s_1$ is not a valid breakaway or reentry point for $K \\ge 0$.\n-   The point $s_2 = \\frac{-6 + 2\\sqrt{3}}{3} \\approx -0.845$ lies in the interval $(-2, 0)$. Since this interval is on the root locus, $s_2$ is a valid breakaway point. The two branches of the locus originating at the poles $s=0$ and $s=-2$ meet at this point and then break away into the complex plane.\n\nTherefore, only one stationary point, $s_2$, lies on the root locus.\n\nFinally, we address the conceptual question. The root locus for a system with a real-rational transfer function is symmetric with respect to the real axis because the characteristic polynomial, $P(s) = s(s+2)(s+4) + K$, has real coefficients for any real gain $K$. A fundamental theorem of algebra dictates that if a polynomial has real coefficients, its non-real roots must occur in complex-conjugate pairs. If $s_0 = \\sigma + j\\omega$ with $\\omega \\neq 0$ is a root, then its conjugate $\\overline{s_0} = \\sigma - j\\omega$ must also be a root. This mathematical property mandates the symmetry of the locus about the real axis.\nThis pole symmetry is consistent with the properties of a Linear Quadratic Regulator (LQR) controller because the LQR design for a real-valued state-space model $(A, B)$ also results in a closed-loop system characteristic polynomial, $\\det(sI - (A-BK))$, with real coefficients. The resulting closed-loop poles are therefore also symmetric about the real axis. While this symmetry is a shared structural feature, the notable robustness guarantees of LQR (e.g., infinite gain margin and at least $60^\\circ$ phase margin for SISO systems) are a deeper consequence of the optimality inherent in the LQR formulation, specifically captured by the Kalman frequency-domain equality, which forces the Nyquist plot of the loop transfer function to remain outside a unit circle centered at the critical point $-1+j0$. Symmetry is a necessary condition for a physically-realizable real-coefficient linear system, whereas the LQR robustness margins are a sufficient condition for stability derived from minimizing a quadratic cost function.", "answer": "$$\\boxed{\\frac{-6 + 2\\sqrt{3}}{3}}$$", "id": "2751323"}, {"introduction": "Shifting from the geometric perspective of root locus to the algebraic framework of optimal control, this practice focuses on the heart of the Linear Quadratic Regulator (LQR) design process. You will derive the optimal feedback gain $K$ by solving the Algebraic Riccati Equation (ARE) from first principles. This hands-on calculation ([@problem_id:2751329]) demystifies the origin of the LQR controller, providing concrete insight into how this method guarantees closed-loop stability and enforces the same pole symmetry observed in classical methods.", "problem": "Consider the continuous-time linear time-invariant state-space system with state matrix $A=\\begin{bmatrix}0  1 \\\\ -4  -1\\end{bmatrix}$ and input matrix $B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}$. Design the Linear Quadratic Regulator (LQR) state-feedback $u=-Kx$ that minimizes the quadratic cost $J=\\int_{0}^{\\infty}\\left(x(t)^{\\top}Qx(t)+u(t)^{\\top}Ru(t)\\right)\\,dt$ with $Q=I$ and $R=1$. \n\nStarting from the algebraic Riccati equation $A^{\\top}P+PA-PBR^{-1}B^{\\top}P+Q=0$ with $P=P^{\\top}\\succ 0$, determine the unique stabilizing solution $P$ and the corresponding optimal gain $K=R^{-1}B^{\\top}P$. Then, using only first principles of second-order stability, verify that the closed-loop matrix $A-BK$ is Hurwitz and that, if its eigenvalues are complex, they occur as a conjugate-symmetric pair, explaining why this symmetry must hold. \n\nIn your final answer, report only the exact feedback gain row vector $K$ in closed form, without numerical approximation and without units. Do not round; no numerical approximation is required.", "solution": "The Linear Quadratic Regulator (LQR) problem with $Q=I$ and $R=1$ yields the algebraic Riccati equation\n$$\nA^{\\top}P+PA-PBR^{-1}B^{\\top}P+Q=0,\n$$\nwhere $P=P^{\\top}\\succ 0$ is the unique stabilizing solution and the optimal state-feedback gain is\n$$\nK=R^{-1}B^{\\top}P=B^{\\top}P.\n$$\nLet $P=\\begin{bmatrix}p  r \\\\ r  s\\end{bmatrix}$ with unknown real scalars $p$, $r$, and $s$. We compute each term in the Riccati equation.\n\nFirst, $A=\\begin{bmatrix}0  1 \\\\ -4  -1\\end{bmatrix}$ and $A^{\\top}=\\begin{bmatrix}0  -4 \\\\ 1  -1\\end{bmatrix}$. Then\n$$\nA^{\\top}P=\\begin{bmatrix}0  -4 \\\\ 1  -1\\end{bmatrix}\\begin{bmatrix}p  r \\\\ r  s\\end{bmatrix}\n=\\begin{bmatrix}-4r  -4s \\\\ p-r  r-s\\end{bmatrix},\n$$\nand\n$$\nPA=\\begin{bmatrix}p  r \\\\ r  s\\end{bmatrix}\\begin{bmatrix}0  1 \\\\ -4  -1\\end{bmatrix}\n=\\begin{bmatrix}-4r  p-r \\\\ -4s  r-s\\end{bmatrix}.\n$$\nHence\n$$\nA^{\\top}P+PA=\\begin{bmatrix}-8r  p-r-4s \\\\ p-r-4s  2(r-s)\\end{bmatrix}.\n$$\nNext, with $B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}$ and $R=1$, we have\n$$\nPBR^{-1}B^{\\top}P=PBB^{\\top}P=(PB)(B^{\\top}P).\n$$\nSince $PB=\\begin{bmatrix}r \\\\ s\\end{bmatrix}$ and $B^{\\top}P=\\begin{bmatrix}r  s\\end{bmatrix}$, it follows that\n$$\nPBR^{-1}B^{\\top}P=\\begin{bmatrix}r \\\\ s\\end{bmatrix}\\begin{bmatrix}r  s\\end{bmatrix}\n=\\begin{bmatrix}r^{2}  rs \\\\ rs  s^{2}\\end{bmatrix}.\n$$\nFinally, $Q=I=\\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix}$. Therefore, the Riccati equation becomes\n$$\n\\begin{bmatrix}-8r  p-r-4s \\\\ p-r-4s  2(r-s)\\end{bmatrix}\n-\n\\begin{bmatrix}r^{2}  rs \\\\ rs  s^{2}\\end{bmatrix}\n+\n\\begin{bmatrix}1  0 \\\\ 0  1\\end{bmatrix}\n=\n\\begin{bmatrix}0  0 \\\\ 0  0\\end{bmatrix}.\n$$\nEquating entries yields the system\n$$\n\\begin{aligned}\n-8r-r^{2}+1=0, \\\\\np-r-4s-rs=0, \\\\\n2(r-s)-s^{2}+1=0.\n\\end{aligned}\n$$\nThe first and third equations decouple $r$ and $s$ from $p$. From the $(1,1)$ equation,\n$$\nr^{2}+8r-1=0 \\quad \\Rightarrow \\quad r=-4\\pm\\sqrt{17}.\n$$\nTo obtain a real, stabilizing solution compatible with a positive definite $P$, we must also satisfy the $(2,2)$ equation, $s^2+2s-(2r+1)=0$, which gives\n$$\ns=-1\\pm\\sqrt{2(r+1)}.\n$$\nIf we choose $r=-4-\\sqrt{17}$, then $r+1=-3-\\sqrt{17}0$, so $\\sqrt{2(r+1)}$ is not real. Hence the only admissible real branch is\n$$\nr=-4+\\sqrt{17},\n$$\nwhich yields\n$$\ns=-1\\pm\\sqrt{2(r+1)}=-1\\pm\\sqrt{-6+2\\sqrt{17}}.\n$$\nTo obtain the stabilizing positive definite $P$, we select the branch with\n$$\ns=-1+\\sqrt{-6+2\\sqrt{17}},\n$$\nwhich is strictly positive because $-6+2\\sqrt{17}0$.\n\nWith $r$ and $s$ determined, the $(1,2)$ equation gives $p$:\n$$\np-r-4s-rs=0 \\quad \\Rightarrow \\quad p=r+4s+rs.\n$$\nThus the stabilizing Riccati solution is\n$$\nP=\\begin{bmatrix}p  r \\\\ r  s\\end{bmatrix}\n=\n\\begin{bmatrix}\nr+4s+rs  r \\\\\nr  s\n\\end{bmatrix},\n\\quad\nr=-4+\\sqrt{17},\\quad s=-1+\\sqrt{-6+2\\sqrt{17}}.\n$$\nThe optimal LQR feedback gain is\n$$\nK=R^{-1}B^{\\top}P=B^{\\top}P=\\begin{bmatrix}0  1\\end{bmatrix}\\begin{bmatrix}p  r \\\\ r  s\\end{bmatrix}\n=\\begin{bmatrix}r  s\\end{bmatrix}\n=\\begin{bmatrix}-4+\\sqrt{17}  -1+\\sqrt{-6+2\\sqrt{17}}\\end{bmatrix}.\n$$\n\nWe now verify closed-loop stability and conjugate symmetry. The closed-loop matrix under $u=-Kx$ is\n$$\nA-BK=\\begin{bmatrix}0  1 \\\\ -4  -1\\end{bmatrix}-\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\\begin{bmatrix}r  s\\end{bmatrix}\n=\\begin{bmatrix}0  1 \\\\ -4-r  -1-s\\end{bmatrix}.\n$$\nIts characteristic polynomial is\n$$\n\\chi(\\lambda)=\\det\\!\\left(\\lambda I-(A-BK)\\right)\n=\\det\\!\\begin{bmatrix}\\lambda  -1 \\\\ 4+r  \\lambda+1+s\\end{bmatrix}\n=\\lambda^{2}+(1+s)\\lambda+(4+r).\n$$\nFor a real second-order polynomial $\\lambda^{2}+a_{1}\\lambda+a_{0}$, Hurwitz stability is equivalent to $a_{1}0$ and $a_{0}0$. Here,\n$$\na_{1}=1+s=\\sqrt{-6+2\\sqrt{17}}0,\\quad a_{0}=4+r=4+(-4+\\sqrt{17})=\\sqrt{17}0,\n$$\nso $A-BK$ is Hurwitz.\n\nThe eigenvalues are roots of a real-coefficient polynomial, hence any complex eigenvalues occur in conjugate-symmetric pairs by the Fundamental Theorem of Algebra applied to polynomials with real coefficients. Indeed, the discriminant is\n$$\n\\Delta=(1+s)^{2}-4(4+r) = (-6+2\\sqrt{17}) - 4\\sqrt{17} = -6-2\\sqrt{17}0,\n$$\nwhich confirms a complex conjugate pair with negative real part. This conjugate symmetry aligns with the symmetric root locus property for real systems under real feedback gains.\n\nTherefore, the exact optimal feedback gain is the row vector\n$$\nK=\\begin{bmatrix}-4+\\sqrt{17}  -1+\\sqrt{-6+2\\sqrt{17}}\\end{bmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-4+\\sqrt{17}  -1+\\sqrt{-6+2\\sqrt{17}}\\end{pmatrix}}$$", "id": "2751329"}, {"introduction": "This final practice bridges LQR theory with modern robustness analysis, demonstrating how design choices translate into quantifiable performance and stability margins. While LQR is known for its excellent robustness properties, this computational exercise ([@problem_id:2751314]) allows you to explore *how* robust a design is by examining its sensitivity ($S$) and complementary sensitivity ($T$) functions. By comparing two designs with different tuning weights, you will gain practical insight into the trade-offs between aggressive performance and guaranteed stability margins against model uncertainty.", "problem": "Consider the single-input single-output linear time-invariant plant with transfer function given by the rational function $G(s) = \\dfrac{1}{s(s+1)}$. Use the following minimal continuous-time state-space realization with full-state measurement to uniquely define the interconnection for loop analysis:\n- State-space matrices: $A = \\begin{bmatrix} 0  1 \\\\ 0  -1 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$.\n- Measured output equals the full state: $y = x \\in \\mathbb{R}^2$.\n\nA full-state static feedback controller is implemented as $u = -K y$, where the state-feedback gain $K \\in \\mathbb{R}^{1 \\times 2}$ is designed via the Linear Quadratic Regulator (LQR) optimal control framework that minimizes the infinite-horizon quadratic cost\n$$\nJ = \\int_{0}^{\\infty} \\left( x(t)^{\\mathsf{T}} Q x(t) + u(t)^{\\mathsf{T}} R u(t) \\right) \\, dt,\n$$\nwith $Q \\succeq 0$ and $R \\succ 0$. The optimal gain $K$ is computed from the unique positive semidefinite stabilizing solution $P$ of the continuous-time algebraic Riccati equation\n$$\nA^{\\mathsf{T}} P + P A - P B R^{-1} B^{\\mathsf{T}} P + Q = 0,\n$$\nvia $K = R^{-1} B^{\\mathsf{T}} P$.\n\nDefine the loop transfer matrix from the measurement $y$ to itself, induced by the unity-feedback interconnection with the full-state controller, as\n$$\nL(s) = \\left( s I - A \\right)^{-1} B \\left( -K \\right) \\in \\mathbb{C}^{2 \\times 2}.\n$$\nDefine the sensitivity and complementary sensitivity matrices by\n$$\nS(s) = \\left( I + L(s) \\right)^{-1}, \\qquad T(s) = I - S(s),\n$$\nwhere $I$ denotes the $2 \\times 2$ identity matrix. For frequency-domain analysis, evaluate these matrices on the imaginary axis $s = \\mathrm{j} \\omega$ with angular frequency $\\omega$ expressed in radians per second.\n\nScientific base and objectives:\n- The Bode magnitude for a multiple-input multiple-output (MIMO) matrix transfer function at a given frequency is taken to be the induced $2$-norm, i.e., the largest singular value. For a matrix $M(\\mathrm{j}\\omega)$, denote this magnitude as $\\bar{\\sigma}\\left( M(\\mathrm{j}\\omega) \\right)$.\n- The robustness relevance is as follows. Under multiplicative output uncertainty bounded in induced norm by $\\rho_{\\text{out}}$, robust stability is certified by $\\sup_{\\omega} \\bar{\\sigma}\\big( T(\\mathrm{j}\\omega) \\big) \\cdot \\rho_{\\text{out}}  1$, hence the largest tolerable bound is $\\rho_{\\text{out}}^{\\star} = 1 / \\left\\| T \\right\\|_{\\infty}$ where $\\left\\| T \\right\\|_{\\infty} = \\sup_{\\omega} \\bar{\\sigma}\\big( T(\\mathrm{j}\\omega) \\big)$. Similarly, for multiplicative input uncertainty bounded by $\\rho_{\\text{in}}$, a sufficient condition is $\\left\\| S \\right\\|_{\\infty} \\cdot \\rho_{\\text{in}}  1$, giving $\\rho_{\\text{in}}^{\\star} = 1 / \\left\\| S \\right\\|_{\\infty}$. These are standard sufficient conditions derived from small-gain principles.\n- The root-locus symmetry about the real axis for closed-loop poles under real-valued gains follows from complex conjugation symmetry of polynomial coefficients; you will connect how LQR weight choices shift closed-loop poles and thereby affect the Bode magnitudes of $S$ and $T$ and the implied robustness margins.\n\nTasks:\n1. For each LQR weight set below, compute the optimal $K$, then compute $S(\\mathrm{j}\\omega)$ and $T(\\mathrm{j}\\omega)$ over a logarithmically spaced grid of $300$ angular frequencies $\\omega$ from $10^{-3}$ to $10^{3}$ radians per second (inclusive). For each matrix function, compute its approximate $\\mathcal{H}_{\\infty}$ norm as the maximum over the grid of its largest singular value:\n   $$\n   \\left\\| S \\right\\|_{\\infty} \\approx \\max_{\\omega} \\bar{\\sigma}\\left( S(\\mathrm{j}\\omega) \\right), \\qquad\n   \\left\\| T \\right\\|_{\\infty} \\approx \\max_{\\omega} \\bar{\\sigma}\\left( T(\\mathrm{j}\\omega) \\right).\n   $$\n   Then compute the inferred robustness margins $\\rho_{\\text{in}}^{\\star} = 1 / \\left\\| S \\right\\|_{\\infty}$ and $\\rho_{\\text{out}}^{\\star} = 1 / \\left\\| T \\right\\|_{\\infty}$.\n\n2. Use the following test suite of LQR weights:\n   - Case 1 (moderate control effort): $Q_1 = \\mathrm{diag}(1,\\,0.1)$, $R_1 = 0.5$.\n   - Case 2 (aggressive state regulation): $Q_2 = \\mathrm{diag}(10,\\,1)$, $R_2 = 0.05$.\n\n3. Report, for each case, the four floats in the order $\\left\\| S \\right\\|_{\\infty}$, $\\left\\| T \\right\\|_{\\infty}$, $\\rho_{\\text{in}}^{\\star}$, $\\rho_{\\text{out}}^{\\star}$, rounded to six decimal places.\n\n4. Final Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order\n   $$\n   \\big[ \\left\\| S \\right\\|_{\\infty}^{(1)}, \\left\\| T \\right\\|_{\\infty}^{(1)}, \\rho_{\\text{in}}^{\\star (1)}, \\rho_{\\text{out}}^{\\star (1)}, \\left\\| S \\right\\|_{\\infty}^{(2)}, \\left\\| T \\right\\|_{\\infty}^{(2)}, \\rho_{\\text{in}}^{\\star (2)}, \\rho_{\\text{out}}^{\\star (2)} \\big],\n   $$\n   where the superscripts $(1)$ and $(2)$ denote Case 1 and Case 2 respectively. No units are required for the magnitudes because they are dimensionless.\n\nNotes and interpretive requirement (to be addressed in your solution reasoning, not in the program output):\n- Explain, from first principles, why the root-locus of the closed-loop poles under real-valued gains is symmetric about the real axis and how the LQR weight choices shift the poles, thereby influencing the Bode magnitudes of $S$ and $T$.\n- Connect the computed differences in $\\left\\| S \\right\\|_{\\infty}$ and $\\left\\| T \\right\\|_{\\infty}$ between the two cases to the input and output multiplicative uncertainty robustness margins $\\rho_{\\text{in}}^{\\star}$ and $\\rho_{\\text{out}}^{\\star}$ as defined above.\n\nAngle units: All angular frequencies must be in radians per second. Numerical outputs must be rounded to six decimal places as specified above.", "solution": "We begin from the foundational definitions for linear time-invariant systems and their feedback interconnections. The given single-input single-output plant has transfer function $G(s) = \\dfrac{1}{s(s+1)}$. A minimal state-space realization with full-state measurement is specified by\n$$\nA = \\begin{bmatrix} 0  1 \\\\ 0  -1 \\end{bmatrix}, \\quad\nB = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad\ny = x \\in \\mathbb{R}^2.\n$$\nThe controller is full-state feedback $u = -K y$ with $K \\in \\mathbb{R}^{1 \\times 2}$ designed by the Linear Quadratic Regulator (LQR). The LQR design problem minimizes\n$$\nJ = \\int_{0}^{\\infty} \\left( x^{\\mathsf{T}} Q x + u^{\\mathsf{T}} R u \\right) dt,\n$$\nwhere $Q \\succeq 0$ and $R \\succ 0$. The well-tested result from optimal control theory is that the optimal $K$ is obtained by solving the continuous-time algebraic Riccati equation (CARE)\n$$\nA^{\\mathsf{T}} P + P A - P B R^{-1} B^{\\mathsf{T}} P + Q = 0\n$$\nfor the unique positive semidefinite stabilizing solution $P$, then\n$$\nK = R^{-1} B^{\\mathsf{T}} P.\n$$\n\nTo analyze loop properties, we explicitly form the unity-feedback interconnection between the measured output and the controller input. The transfer from control input to measured output is\n$$\nG_{yu}(s) = (s I - A)^{-1} B \\in \\mathbb{C}^{2 \\times 1}.\n$$\nThe loop transfer matrix from $y$ to $y$ induced by the controller $u = -K y$ is\n$$\nL(s) = G_{yu}(s) (-K) \\in \\mathbb{C}^{2 \\times 2}.\n$$\nThe sensitivity and complementary sensitivity matrices are\n$$\nS(s) = (I + L(s))^{-1}, \\qquad T(s) = I - S(s) = L(s) (I + L(s))^{-1}.\n$$\nFor multiple-input multiple-output systems, a standard Bode magnitude at a given frequency is the induced $2$-norm, the largest singular value. For a matrix $M(\\mathrm{j}\\omega)$, denote this as $\\bar{\\sigma}(M(\\mathrm{j}\\omega))$. The $\\mathcal{H}_{\\infty}$ norm of $M$ is $\\|M\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(M(\\mathrm{j}\\omega))$. We approximate this supremum on a logarithmic frequency grid $\\omega \\in [10^{-3}, 10^{3}]$ radians per second using $300$ points.\n\nRobustness margins from small-gain reasoning:\n- Consider multiplicative output uncertainty represented as $\\tilde{G}(s) = G(s) (I + \\Delta_{\\text{out}}(s))$ with $\\|\\Delta_{\\text{out}}\\|_{\\infty} \\le \\rho_{\\text{out}}$. In the standard interconnection, robust stability is ensured if $\\| T \\|_{\\infty} \\cdot \\rho_{\\text{out}}  1$, so the largest tolerable bound is\n$$\n\\rho_{\\text{out}}^{\\star} = \\frac{1}{\\|T\\|_{\\infty}}.\n$$\n- For multiplicative input uncertainty represented as $\\tilde{G}(s) = (I + \\Delta_{\\text{in}}(s)) G(s)$ with $\\|\\Delta_{\\text{in}}\\|_{\\infty} \\le \\rho_{\\text{in}}$, the sufficient small-gain condition is $\\| S \\|_{\\infty} \\cdot \\rho_{\\text{in}}  1$, leading to\n$$\n\\rho_{\\text{in}}^{\\star} = \\frac{1}{\\|S\\|_{\\infty}}.\n$$\nThese are well-tested sufficient conditions linking sensitivity functions to robustness margins.\n\nSymmetric root locus and LQR effects:\n- The closed-loop state matrix is $A_{\\text{cl}} = A - B K$. Because $A$, $B$, and $K$ are real, the characteristic polynomial of $A_{\\text{cl}}$ has real coefficients. It follows from fundamental properties of polynomials with real coefficients that complex eigenvalues occur in conjugate pairs, implying that the locus of closed-loop poles as gains vary is symmetric about the real axis in the complex plane. This is the symmetric root locus property.\n- Changing the LQR weights $(Q, R)$ modifies the solution $P$ and thereby $K = R^{-1} B^{\\mathsf{T}} P$. Increasing state penalties (entries of $Q$) or decreasing control penalty $R$ typically produces larger gain magnitudes and shifts closed-loop poles further left (higher bandwidth), which often reduces low-frequency sensitivity but can increase peaking in $\\bar{\\sigma}(T(\\mathrm{j}\\omega))$ near the crossover frequency due to reduced damping. Conversely, larger $R$ or smaller $Q$ reduce bandwidth, often increasing $\\|S\\|_{\\infty}$ (poorer disturbance attenuation) and sometimes reducing high-frequency peaking in $T$ (potentially improving tolerance to output multiplicative uncertainty at high frequencies). The computed $\\|S\\|_{\\infty}$ and $\\|T\\|_{\\infty}$ thus quantify these trade-offs and map directly to the robustness margins $\\rho_{\\text{in}}^{\\star}$ and $\\rho_{\\text{out}}^{\\star}$ as above.\n\nAlgorithmic steps for each case:\n1. Form $Q$ and $R$.\n2. Solve the CARE for $P$ and compute $K = R^{-1} B^{\\mathsf{T}} P$.\n3. Over the grid of $\\omega$ values, compute $G_{yu}(\\mathrm{j}\\omega) = (\\mathrm{j}\\omega I - A)^{-1} B$, then $L(\\mathrm{j}\\omega) = G_{yu}(\\mathrm{j}\\omega) (-K)$, $S(\\mathrm{j}\\omega) = (I + L(\\mathrm{j}\\omega))^{-1}$, and $T(\\mathrm{j}\\omega) = I - S(\\mathrm{j}\\omega)$.\n4. At each $\\omega$, compute the largest singular values $\\bar{\\sigma}(S(\\mathrm{j}\\omega))$ and $\\bar{\\sigma}(T(\\mathrm{j}\\omega))$.\n5. Approximate $\\|S\\|_{\\infty}$ and $\\|T\\|_{\\infty}$ by taking the maxima over the grid; then compute $\\rho_{\\text{in}}^{\\star} = 1/\\|S\\|_{\\infty}$ and $\\rho_{\\text{out}}^{\\star} = 1/\\|T\\|_{\\infty}$.\n6. Round the four outputs for each case to six decimal places and present them in the specified single-line list format.\n\nInterpretation of expected differences:\n- Case 2 uses larger state penalties and a smaller control penalty than Case 1, which typically yields a larger feedback gain $K$, increased closed-loop bandwidth, and thus smaller low-frequency sensitivity (potentially reducing $\\|S\\|_{\\infty}$) but possibly larger complementary sensitivity peaking near crossover (potentially increasing $\\|T\\|_{\\infty}$). Hence, one might expect $\\rho_{\\text{in}}^{\\star}$ to be larger and $\\rho_{\\text{out}}^{\\star}$ to be smaller in Case 2 relative to Case 1, although the exact values are determined by the computation.\n- The symmetric root locus property is reflected in the complex conjugate symmetry of the closed-loop poles $A - BK$ for both cases. The more aggressive weights in Case 2 shift these poles further left (higher natural frequencies and damping configurations), which reshapes the frequency response magnitudes of $S$ and $T$ and thus the computed robustness margins.\n\nAll computations use angular frequency in radians per second, and the final reported magnitudes are dimensionless.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_continuous_are\n\ndef lqr_gain(A, B, Q, R):\n    # Solve CARE: A^T P + P A - P B R^{-1} B^T P + Q = 0\n    P = solve_continuous_are(A, B, Q, R)\n    # K = R^{-1} B^T P\n    R_inv = 1.0 / R if np.ndim(R) == 0 else np.linalg.inv(R)\n    K = R_inv * (B.T @ P)\n    return K, P\n\ndef hinf_norms_S_T(A, B, K, w_grid):\n    I = np.eye(A.shape[0])\n    max_sv_S = 0.0\n    max_sv_T = 0.0\n    for w in w_grid:\n        sI_minus_A = 1j * w * I - A\n        # G_yu(jw) = (jw I - A)^(-1) B\n        Gyu = np.linalg.solve(sI_minus_A, B)  # shape (n,1)\n        # L(jw) = G_yu(jw) * (-K)\n        L = Gyu @ (-K)  # shape (n,n)\n        # S = (I + L)^(-1)\n        S = np.linalg.inv(I + L)\n        T = I - S\n        # Largest singular values\n        sv_S = np.linalg.svd(S, compute_uv=False)\n        sv_T = np.linalg.svd(T, compute_uv=False)\n        max_sv_S = max(max_sv_S, float(np.max(sv_S)))\n        max_sv_T = max(max_sv_T, float(np.max(sv_T)))\n    return max_sv_S, max_sv_T\n\ndef solve():\n    # Plant definition\n    A = np.array([[0.0, 1.0],\n                  [0.0, -1.0]])\n    B = np.array([[0.0],\n                  [1.0]])\n\n    # Frequency grid (rad/s)\n    w_grid = np.logspace(-3, 3, 300)\n\n    # Test cases: (Q, R)\n    test_cases = [\n        (np.diag([1.0, 0.1]), 0.5),   # Case 1: moderate control effort\n        (np.diag([10.0, 1.0]), 0.05), # Case 2: aggressive state regulation\n    ]\n\n    results = []\n    for Q, R in test_cases:\n        K, _ = lqr_gain(A, B, Q, R)\n        norm_S, norm_T = hinf_norms_S_T(A, B, K, w_grid)\n        # Robustness margins\n        rho_in = 1.0 / norm_S if norm_S > 0 else float('inf')\n        rho_out = 1.0 / norm_T if norm_T > 0 else float('inf')\n        # Round to six decimals for output stability\n        results.extend([\n            f\"{norm_S:.6f}\",\n            f\"{norm_T:.6f}\",\n            f\"{rho_in:.6f}\",\n            f\"{rho_out:.6f}\",\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2751314"}]}