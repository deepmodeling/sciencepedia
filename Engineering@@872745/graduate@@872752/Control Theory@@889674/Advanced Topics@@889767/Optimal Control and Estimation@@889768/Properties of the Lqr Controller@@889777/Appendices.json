{"hands_on_practices": [{"introduction": "Understanding the LQR controller begins with its mathematical roots in optimal control theory. This first exercise guides you through a derivation from first principles for a simple scalar system, starting with the Hamilton-Jacobi-Bellman (HJB) equation. By solving this foundational problem [@problem_id:2734387], you will make the direct connection between the HJB framework and the celebrated Algebraic Riccati Equation (ARE), yielding an explicit formula for the optimal gain $K$.", "problem": "Consider the scalar linear time-invariant system $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ with $b \\neq 0$, $q \\ge 0$, and $r  0$. The performance index is the infinite-horizon quadratic cost $J = \\int_{0}^{\\infty} \\big(q\\,x(t)^{2} + r\\,u(t)^{2}\\big)\\,dt$. Using first principles of dynamic programming via the Hamilton–Jacobi–Bellman equation, derive the optimal state-feedback law $u(t) = -K\\,x(t)$ that minimizes $J$ and the associated value function coefficient $P$ in the quadratic ansatz $V(x) = P\\,x^{2}$. Express both $P$ and $K$ exactly in closed form in terms of $a$, $b$, $q$, and $r$, and justify the choice of the stabilizing branch. Then, in the regime $|a| \\ll \\sqrt{q\\,r}/|b|$, determine the leading-order asymptotic scaling of $K$ and briefly explain why it holds. Provide your final answer as the exact closed-form expression for $K$ as a function of $a$, $b$, $q$, and $r$ (no numerical evaluation is required).", "solution": "We begin from the Hamilton–Jacobi–Bellman (HJB) equation for infinite-horizon optimal control. For the scalar system $\\dot{x} = a\\,x + b\\,u$ and cost density $\\ell(x,u) = q\\,x^{2} + r\\,u^{2}$ with $q \\ge 0$ and $r  0$, the value function $V(x)$ satisfies\n$$\n0 \\;=\\; \\min_{u} \\Big\\{ q\\,x^{2} + r\\,u^{2} + V_{x}(x)\\,\\big(a\\,x + b\\,u\\big) \\Big\\}.\n$$\nBy the structure of the system and the cost, it is natural to seek a quadratic value function $V(x) = P\\,x^{2}$ with an unknown constant $P \\ge 0$. Then $V_{x}(x) = 2\\,P\\,x$, and the HJB equation becomes\n$$\n0 \\;=\\; \\min_{u} \\Big\\{ q\\,x^{2} + r\\,u^{2} + 2\\,P\\,x\\,(a\\,x + b\\,u) \\Big\\}\n\\;=\\; \\min_{u} \\Big\\{ (q + 2\\,a\\,P)\\,x^{2} + r\\,u^{2} + 2\\,b\\,P\\,x\\,u \\Big\\}.\n$$\nFor each fixed $x$, the inner minimization is a convex quadratic in $u$. The minimizing input $u^{\\star}$ satisfies the first-order condition\n$$\n\\frac{\\partial}{\\partial u}\\Big( r\\,u^{2} + 2\\,b\\,P\\,x\\,u \\Big) \\;=\\; 2\\,r\\,u + 2\\,b\\,P\\,x \\;=\\; 0,\n$$\nwhich yields the optimal feedback\n$$\nu^{\\star} \\;=\\; -\\,\\frac{b\\,P}{r}\\,x.\n$$\nThis identifies the optimal static state-feedback gain as\n$$\nK \\;=\\; \\frac{b\\,P}{r}.\n$$\nSubstituting $u^{\\star}$ back into the HJB integrand yields the minimal value of the bracketed expression:\n$$\n(q + 2\\,a\\,P)\\,x^{2} + r\\,\\Big(-\\frac{b\\,P}{r}\\,x\\Big)^{2} + 2\\,b\\,P\\,x\\,\\Big(-\\frac{b\\,P}{r}\\,x\\Big)\n\\;=\\; \\Big(q + 2\\,a\\,P - \\frac{b^{2}\\,P^{2}}{r}\\Big)\\,x^{2}.\n$$\nTherefore the HJB equation reduces to the scalar algebraic Riccati equation\n$$\nq + 2\\,a\\,P - \\frac{b^{2}}{r}\\,P^{2} \\;=\\; 0,\n$$\nor, equivalently,\n$$\n\\frac{b^{2}}{r}\\,P^{2} - 2\\,a\\,P - q \\;=\\; 0.\n$$\nSolving this quadratic for $P$ gives\n$$\nP \\;=\\; \\frac{2\\,a \\pm \\sqrt{4\\,a^{2} + 4\\,\\frac{b^{2}}{r}\\,q}}{2\\,\\frac{b^{2}}{r}}\n\\;=\\; \\frac{a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{\\frac{b^{2}}{r}}\n\\;=\\; \\frac{r}{b^{2}}\\Big(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big).\n$$\nTo select the stabilizing solution, examine the closed-loop dynamics with $u=-K\\,x$:\n$$\n\\dot{x} \\;=\\; \\big(a - b\\,K\\big)\\,x \\;=\\; \\Big(a - \\frac{b^{2}}{r}\\,P\\Big)\\,x.\n$$\nUsing the expression for $P$,\n$$\na - \\frac{b^{2}}{r}\\,P \\;=\\; a - \\Big(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big) \\;=\\; \\mp\\,\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}.\n$$\nThe stabilizing branch requires $a - \\frac{b^{2}}{r}\\,P  0$, i.e., the negative root. Therefore we take the plus sign in $P$:\n$$\nP \\;=\\; \\frac{r}{b^{2}}\\Big(a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\\Big),\n$$\nwhich yields the exact optimal gain\n$$\nK \\;=\\; \\frac{b\\,P}{r} \\;=\\; \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{b}.\n$$\nThis $K$ produces the closed-loop eigenvalue $a - b\\,K = -\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q} \\le 0$, strictly negative unless $q = 0$ and $a \\le 0$, ensuring stability in the standard nondegenerate cases.\n\nFor the asymptotic scaling, consider the regime $|a| \\ll \\sqrt{q\\,r}/|b|$. Then\n$$\n\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\n\\;=\\;\n|b|\\,\\sqrt{\\frac{q}{r}}\\,\\sqrt{1 + \\frac{a^{2}\\,r}{b^{2}\\,q}}\n\\;=\\;\n|b|\\,\\sqrt{\\frac{q}{r}}\\Big(1 + \\mathcal{O}\\Big(\\frac{a^{2}\\,r}{b^{2}\\,q}\\Big)\\Big),\n$$\nso\n$$\nK \\;=\\; \\frac{a}{b} + \\frac{1}{b}\\,\\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}\n\\;=\\;\n\\frac{a}{b} + \\frac{|b|}{b}\\,\\sqrt{\\frac{q}{r}} + \\mathcal{O}\\Big(\\frac{|a|^{2}}{|b|}\\,\\sqrt{\\frac{r}{q}}\\Big).\n$$\nAt leading order, the $a/b$ term is negligible relative to the term proportional to $\\sqrt{q/r}$, hence\n$$\nK \\sim \\frac{|b|}{b}\\,\\sqrt{\\frac{q}{r}}.\n$$\nIn particular, when $b  0$, this simplifies to $K \\sim \\sqrt{q/r}$, which establishes the stated scaling behavior.\n\nThus the exact closed-form expression for the optimal gain is\n$$\nK \\;=\\; \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r}\\,q}}{b}.\n$$", "answer": "$$\\boxed{\\frac{a+\\sqrt{a^{2}+\\frac{b^{2}}{r}\\,q}}{b}}$$", "id": "2734387"}, {"introduction": "While the LQR formulation is mathematically elegant, its practical power depends on a physically meaningful choice of the weighting matrices $Q$ and $R$. This problem [@problem_id:2734404] challenges you to think like a control engineer, focusing on the critical and often overlooked step of non-dimensionalization and scaling. Properly addressing these issues ensures that your cost function reflects true performance objectives, rather than arbitrary choices of physical units.", "problem": "Consider a continuous-time linear time-invariant system with state $x \\in \\mathbb{R}^{n}$ and input $u \\in \\mathbb{R}^{m}$ governed by $\\dot{x} = A x + B u$. The Linear Quadratic Regulator (LQR) cost is\n$$\nJ = \\int_{0}^{\\infty} \\left( x^{\\top} Q x + u^{\\top} R u \\right) \\, dt,\n$$\nwhere $Q \\in \\mathbb{R}^{n \\times n}$ is symmetric positive semidefinite and $R \\in \\mathbb{R}^{m \\times m}$ is symmetric positive definite. Suppose the physical units of the state components $x_i$ and input components $u_j$ are, respectively, $\\mathsf{U}_{x_i}$ and $\\mathsf{U}_{u_j}$, and that the entries of $Q$ and $R$ are fixed numeric values. You want the cost $J$ to be physically meaningful in the sense that each term in the integrand has consistent and commensurate physical units, and that the relative weighting of state and input penalties is not an artifact of arbitrary measurement units of $x$ and $u$.\n\nWhich of the following statements correctly describe how the units and scaling of the state and input should be chosen or interpreted so that $J$ is physically meaningful and comparably weighted?\n\nA. Introduce invertible diagonal scaling matrices $D_x \\in \\mathbb{R}^{n \\times n}$ and $D_u \\in \\mathbb{R}^{m \\times m}$ to define dimensionless variables $z = D_x x$ and $v = D_u u$. Choose dimensionless weight matrices $W_x \\succeq 0$ and $W_u \\succ 0$, and set $Q = D_x^{\\top} W_x D_x$ and $R = D_u^{\\top} W_u D_u$. Then $x^{\\top} Q x = z^{\\top} W_x z$ and $u^{\\top} R u = v^{\\top} W_u v$ are dimensionless and directly comparable. Moreover, multiplying $(Q,R)$ by any common positive scalar leaves the optimal LQR feedback unchanged, so only the relative scaling between the state and input penalties matters.\n\nB. Choose units so that $x^{\\top} Q x$ has units of energy and $u^{\\top} R u$ has units of power. Since both are physically meaningful, their sum is physically meaningful as well.\n\nC. Normalize each state and input component by a characteristic magnitude or by its stationary standard deviation, i.e., $z_i = x_i / \\sigma_{x_i}$ and $v_j = u_j / \\sigma_{u_j}$ with $\\sigma_{x_i}, \\sigma_{u_j}  0$, and design the LQR in the scaled coordinates with weights $W_x = I$ and $W_u = \\rho I$ for a tradeoff parameter $\\rho  0$. Mapping back via $Q = D_x^{\\top} W_x D_x$ and $R = D_u^{\\top} W_u D_u$ (where $D_x = \\mathrm{diag}(1/\\sigma_{x_i})$ and $D_u = \\mathrm{diag}(1/\\sigma_{u_j})$) yields a cost whose state and input terms are dimensionless and comparably weighted, and the relative tradeoff is invariant to the choice of measurement units for $x$ and $u$.\n\nD. Under a change of measurement units $x = T_x \\tilde{x}$ and $u = T_u \\tilde{u}$ with invertible diagonal $T_x$ and $T_u$, one should transform $A$ and $B$ to $T_x A T_x^{-1}$ and $T_x B T_u^{-1}$ but keep $Q$ and $R$ numerically unchanged; the LQR controller is then physically equivalent and unit-consistent.\n\nE. If $Q$ and $R$ are diagonal and strictly positive, unit consistency and comparability are guaranteed, because the integrand contains only sums of squared components and there are no cross-terms to create unit mismatches.\n\nSelect all that apply.", "solution": "The problem asks to identify correct statements regarding the physical meaningfulness and comparable weighting of terms in the Linear Quadratic Regulator (LQR) cost function. The system dynamics are given by $\\dot{x} = A x + B u$, and the cost functional is $J = \\int_{0}^{\\infty} \\left( x^{\\top} Q x + u^{\\top} R u \\right) \\, dt$. The core of the problem lies in the physical units of the state $x$ and input $u$, and how the weighting matrices $Q$ and $R$ should be chosen or interpreted.\n\nThe fundamental principle of dimensional analysis dictates that one can only add or compare quantities that have the same physical units. The integrand of the cost function is a sum, $x^{\\top} Q x + u^{\\top} R u$. For this sum to be physically meaningful, the two terms, $x^{\\top} Q x$ and $u^{\\top} R u$, must possess the same physical units. Let us denote this common unit by $\\mathcal{U}$.\n$$\n[x^{\\top} Q x] = [u^{\\top} R u] = \\mathcal{U}\n$$\nwhere $[\\cdot]$ denotes the physical unit of a quantity.\n\nThe term $x^{\\top} Q x$ is a scalar given by the quadratic form $\\sum_{i=1}^{n} \\sum_{j=1}^{n} Q_{ij} x_i x_j$. For this sum to be dimensionally homogeneous, every term $Q_{ij} x_i x_j$ must have the same unit $\\mathcal{U}$. Let $\\mathsf{U}_{x_k}$ be the unit of the state component $x_k$. Then we must have:\n$$\n[Q_{ij}] \\cdot [\\mathsf{U}_{x_i}] \\cdot [\\mathsf{U}_{x_j}] = \\mathcal{U} \\quad \\forall i, j \\in \\{1, \\dots, n\\}\n$$\nSimilarly, for the input term $u^{\\top} R u = \\sum_{k=1}^{m} \\sum_{l=1}^{m} R_{kl} u_k u_l$, letting $\\mathsf{U}_{u_p}$ be the unit of the input component $u_p$, we must have:\n$$\n[R_{kl}] \\cdot [\\mathsf{U}_{u_k}] \\cdot [\\mathsf{U}_{u_l}] = \\mathcal{U} \\quad \\forall k, l \\in \\{1, \\dots, m\\}\n$$\nThe problem states that the entries of $Q$ and $R$ are \"fixed numeric values\". This is often interpreted as these entries being dimensionless. If $[Q_{ij}]=1$ and $[R_{kl}]=1$, then for dimensional consistency, we would need $[\\mathsf{U}_{x_i}] \\cdot [\\mathsf{U}_{x_j}]$ to be a constant unit for all $i,j$, and $[\\mathsf{U}_{u_k}] \\cdot [\\mathsf{U}_{u_l}]$ to be a constant unit for all $k,l$, and furthermore, these two constant units must be identical. This is an extremely restrictive condition that is almost never met in practice. For instance, a state vector for a mechanical system might contain position (meters, $\\text{m}$) and velocity (meters per second, $\\text{m/s}$). Then $[x_1^2] = \\text{m}^2$ while $[x_2^2] = (\\text{m/s})^2$, which are different units. Adding $Q_{11}x_1^2$ and $Q_{22}x_2^2$ would be physically nonsensical if $Q_{11}$ and $Q_{22}$ are dimensionless numbers.\n\nThe standard and correct engineering approach is to non-dimensionalize the problem. We now evaluate each option with this principle in mind.\n\n**Analysis of Option A:**\nThis option proposes a systematic procedure for non-dimensionalization.\n1.  Define dimensionless variables $z = D_x x$ and $v = D_u u$ using invertible diagonal scaling matrices $D_x$ and $D_u$. If the $i$-th component of $x$, $x_i$, has units $\\mathsf{U}_{x_i}$, then for the corresponding component $z_i$ to be dimensionless, the diagonal entry $(D_x)_{ii}$ must have units of $1/\\mathsf{U}_{x_i}$. Typically, $(D_x)_{ii} = 1/x_{i, \\text{char}}$, where $x_{i, \\text{char}}$ is a characteristic or maximum expected value of $x_i$.\n2.  The cost terms are rewritten in terms of these new variables. The statement claims $x^{\\top} Q x = z^{\\top} W_x z$ if $Q = D_x^{\\top} W_x D_x$. Let's verify: $x^{\\top} (D_x^{\\top} W_x D_x) x = (D_x x)^{\\top} W_x (D_x x) = z^{\\top} W_x z$. This is algebraically correct. A similar verification holds for $u^{\\top} R u = v^{\\top} W_u v$ with $R = D_u^{\\top} W_u D_u$.\n3.  The statement proposes using dimensionless weight matrices $W_x$ and $W_u$. Since $z$ and $v$ are dimensionless, the quadratic forms $z^{\\top} W_x z$ and $v^{\\top} W_u v$ are also dimensionless scalars. Therefore, their sum is well-defined and they are directly comparable. This correctly resolves the unit consistency problem.\n4.  The final part of the statement claims that scaling both $Q$ and $R$ by a common positive scalar does not change the optimal LQR feedback gain $K$. Let the new weights be $Q' = \\alpha Q$ and $R' = \\alpha R$ for some $\\alpha  0$. The optimal gain is $K = R^{-1} B^{\\top} P$, where $P$ is the stabilizing solution to the Algebraic Riccati Equation (ARE): $A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q = 0$. For the new weights, let the solution be $P'$. The ARE is $A^{\\top} P' + P' A - P' B (\\alpha R)^{-1} B^{\\top} P' + \\alpha Q = 0$. Let us test the hypothesis $P' = \\alpha P$. Substituting this into the new ARE gives $A^{\\top} (\\alpha P) + (\\alpha P) A - (\\alpha P) B (\\alpha R)^{-1} B^{\\top} (\\alpha P) + \\alpha Q = 0$. This simplifies to $\\alpha A^{\\top} P + \\alpha P A - (\\alpha^2/\\alpha) P B R^{-1} B^{\\top} P + \\alpha Q = 0$. Factoring out $\\alpha$, we get $\\alpha (A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q) = 0$. Since $\\alpha  0$, the expression in the parenthesis must be zero, which is the original ARE. Thus, $P' = \\alpha P$ is the correct solution. The new gain is $K' = (R')^{-1} B^{\\top} P' = (\\alpha R)^{-1} B^{\\top} (\\alpha P) = (\\alpha^{-1} R^{-1}) B^{\\top} (\\alpha P) = R^{-1} B^{\\top} P = K$. The gain is indeed invariant. This implies that only the relative magnitude of the penalties matters for the control law.\nEvery part of this statement is correct and represents best practices in control engineering.\nVerdict: **Correct**.\n\n**Analysis of Option B:**\nThis statement suggests that $x^{\\top} Q x$ should have units of energy and $u^{\\top} R u$ should have units of power. Energy has units of Joules ($\\text{J}$), while power has units of Joules per second ($\\text{J/s}$). These are different physical dimensions. The principle of dimensional homogeneity is violated when summing these two quantities. Adding energy to power is as meaningless as adding length to time. Therefore, the resulting sum is not physically meaningful.\nVerdict: **Incorrect**.\n\n**Analysis of Option C:**\nThis option presents a specific, practical implementation of the general method described in Option A.\n1.  It proposes a specific choice for the scaling factors: the inverse of characteristic magnitudes, specifically stationary standard deviations $\\sigma_{x_i}$ and $\\sigma_{u_j}$. This makes the scaled variables $z_i = x_i / \\sigma_{x_i}$ and $v_j = u_j / \\sigma_{u_j}$ dimensionless quantities representing deviations in units of standard deviation. This is a very common and effective choice.\n2.  It suggests a simple, clear choice for the dimensionless weight matrices: $W_x = I$ and $W_u = \\rho I$ for some scalar $\\rho  0$. This implies that a one-standard-deviation error in any state is penalized a-priori by the same amount, and similarly for inputs. The scalar $\\rho$ becomes the single knob to tune the tradeoff between state regulation and control effort. This is often called Bryson's rule.\n3.  It correctly states the mapping back to the physical coordinate weights: $Q = D_x^{\\top} W_x D_x$ and $R = D_u^{\\top} W_u D_u$, where $D_x=\\mathrm{diag}(1/\\sigma_{x_i})$ and $D_u=\\mathrm{diag}(1/\\sigma_{u_j})$. With $W_x=I$ and $W_u=\\rho I$, this yields $Q=\\mathrm{diag}(1/\\sigma_{x_i}^2)$ and $R=\\mathrm{diag}(\\rho/\\sigma_{u_j}^2)$.\n4.  It claims the relative tradeoff is invariant to the choice of measurement units. Let us verify. Suppose we change the unit of $x_i$ by a factor $c_i$, so the new numerical value is $\\tilde{x}_i = c_i x_i$. The standard deviation, having the same units as $x_i$, will also change its numerical value to $\\tilde{\\sigma}_{x_i} = c_i \\sigma_{x_i}$. The new scaled variable is $\\tilde{z}_i = \\tilde{x}_i / \\tilde{\\sigma}_{x_i} = (c_i x_i) / (c_i \\sigma_{x_i}) = x_i / \\sigma_{x_i} = z_i$. The scaled variables are invariant to changes in measurement units. Since the LQR problem is solved in the dimensionless $(z, v)$ space with fixed weights ($I, \\rho I$), the resulting dimensionless controller is also invariant. The physical interpretation of the tradeoff parameter $\\rho$ is therefore independent of the arbitrary choice of units for $x$ and $u$.\nThis statement is a correct and detailed description of a sound engineering methodology.\nVerdict: **Correct**.\n\n**Analysis of Option D:**\nThis statement describes the transformation under a change of units $x = T_x \\tilde{x}$ and $u = T_u \\tilde{u}$.\n1.  First, let's check the transformation of the system matrices $A$ and $B$. We have $\\dot{x} = A x + B u$. Substituting the new variables gives $d/dt(T_x \\tilde{x}) = A (T_x \\tilde{x}) + B (T_u \\tilde{u})$. Since $T_x$ is a constant matrix, this becomes $T_x \\dot{\\tilde{x}} = A T_x \\tilde{x} + B T_u \\tilde{u}$. To find the dynamics for $\\tilde{x}$, we multiply by $T_x^{-1}$: $\\dot{\\tilde{x}} = (T_x^{-1} A T_x) \\tilde{x} + (T_x^{-1} B T_u) \\tilde{u}$. The statement claims the new matrices are $T_x A T_x^{-1}$ and $T_x B T_u^{-1}$. This is incorrect. The transformation of the system matrices is stated incorrectly.\n2.  Second, let's examine the claim about the weighting matrices. The cost is $J = \\int (x^\\top Q x + u^\\top R u) dt$. Substituting the new variables: $J = \\int ( (T_x \\tilde{x})^\\top Q (T_x \\tilde{x}) + (T_u \\tilde{u})^\\top R (T_u \\tilde{u}) ) dt = \\int ( \\tilde{x}^\\top (T_x^\\top Q T_x) \\tilde{x} + \\tilde{u}^\\top (T_u^\\top R T_u) \\tilde{u} ) dt$. To preserve the physical meaning of the cost, the new weighting matrices in the $\\tilde{x}, \\tilde{u}$ coordinates must be $\\tilde{Q} = T_x^\\top Q T_x$ and $\\tilde{R} = T_u^\\top R T_u$. The statement claims that one should keep $Q$ and $R$ numerically unchanged. This is fundamentally incorrect. Keeping the numerical values of $Q$ and $R$ the same while changing the units of the variables would drastically alter the physical problem by implicitly changing the penalties. For example, if $x_1$ changes from meters to millimeters, its numerical value increases by $1000$. Keeping $Q_{11}$ the same means the penalty on a given physical deviation is now $1000^2$ times larger. This does not result in a physically equivalent controller.\nThe statement contains two major errors.\nVerdict: **Incorrect**.\n\n**Analysis of Option E:**\nThis statement claims that if $Q$ and $R$ are diagonal and strictly positive, unit consistency is guaranteed.\nIf $Q$ and $R$ are diagonal, the cost integrand becomes $\\sum_{i=1}^n Q_{ii} x_i^2 + \\sum_{j=1}^m R_{jj} u_j^2$. The absence of cross-terms (e.g., $Q_{ij} x_i x_j$ for $i \\neq j$) simplifies the expression, but it does not resolve the core dimensional issue. For the sum $\\sum_i Q_{ii} x_i^2$ to be meaningful, all terms $Q_{ii} x_i^2$ must have the same units. If we assume the $Q_{ii}$ are dimensionless numbers, this requires $[x_i^2]$ to be the same for all $i$. As established before (e.g., position vs. velocity), this is generally not true for a physical system with a heterogeneous state vector. Even if all state components somehow had the same units, their squares would still generally have different units from the squares of the input components (e.g., position $m$ vs. input force $N$). Thus, summing the state and input penalties $\\sum Q_{ii} x_i^2 + \\sum R_{jj} u_j^2$ would still be a sum of dimensionally inhomogeneous quantities. Making the matrices diagonal is not a sufficient condition to ensure dimensional correctness.\nVerdict: **Incorrect**.\n\nIn conclusion, only statements A and C correctly describe valid methods for ensuring the LQR cost function is physically meaningful and that the weightings are systematically chosen. Statement A gives the general theory, and C gives a specific, widely-used, and robust application of that theory.", "answer": "$$\\boxed{AC}$$", "id": "2734404"}, {"introduction": "A successful continuous-time design is only the first step; its implementation in a digital environment introduces new challenges, most notably those related to sampling. This exercise [@problem_id:2734403] explores the effects of a Zero-Order Hold (ZOH) implementation on the stability of an LQR-controlled system. By analyzing the exact discrete-time dynamics, you will determine the maximum sampling period $h_{\\max}$ that guarantees stability, providing a vital link between continuous-time design and discrete-time performance.", "problem": "Consider the scalar continuous-time linear time-invariant plant given by $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ with $a = 1$ and $b = 1$. A continuous-time Linear Quadratic Regulator (LQR) is designed for the infinite-horizon performance index $J = \\int_{0}^{\\infty} \\left(q\\,x(t)^{2} + r\\,u(t)^{2}\\right)\\,dt$ with $q = 1$ and $r = 1$, yielding a continuous-time state-feedback law $u(t) = -K\\,x(t)$ with fixed gain $K  0$. The controller is then implemented in sampled-data form using Zero-Order Hold (ZOH): the input is held constant between sampling instants as $u(t) \\equiv -K\\,x(kh)$ for $t \\in [kh,(k+1)h)$, where $h  0$ is the sampling period.\n\nStarting from fundamental definitions (state-transition matrix and the convolution integral), derive the exact discrete-time closed-loop scalar update $x_{k+1} = F(h)\\,x_{k}$ as a function of $a$, $b$, $K$, and $h$. Using the Schur-stability requirement (all eigenvalues strictly inside the unit disk), determine the largest sampling period $h_{\\max}$ such that the sampled-data closed loop remains Schur stable. Then, for the given numerical values $a = 1$, $b = 1$, $q = 1$, and $r = 1$, compute the continuous-time LQR gain $K$ and evaluate the resulting $h_{\\max}$.\n\nExpress the final sampling period in seconds. Give your final answer as an exact expression; no rounding is required.", "solution": "We begin with the scalar plant $\\dot{x}(t) = a\\,x(t) + b\\,u(t)$ and the continuous-time Linear Quadratic Regulator (LQR) design for the infinite-horizon cost $J = \\int_{0}^{\\infty} \\left(q\\,x(t)^{2} + r\\,u(t)^{2}\\right)\\,dt$. For a scalar system, the Algebraic Riccati Equation (ARE) for the optimal costate $p  0$ is\n$$\n2 a p - \\frac{b^{2}}{r}\\,p^{2} + q = 0,\n$$\na well-tested and fundamental result in optimal control theory. The optimal feedback gain is then $K = r^{-1} b\\,p$.\n\nSolving the scalar ARE for $p$ yields\n$$\n\\frac{b^{2}}{r} p^{2} - 2 a p - q = 0\n\\quad\\Longrightarrow\\quad\np = \\frac{2 a + \\sqrt{4 a^{2} + 4 \\frac{b^{2}}{r} q}}{2 \\frac{b^{2}}{r}}\n= \\frac{r\\left(a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right)}{b^{2}},\n$$\nwhere we choose the positive root to ensure $p  0$. Therefore,\n$$\nK = \\frac{b}{r}\\,p\n= \\frac{b}{r}\\,\\frac{r\\left(a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right)}{b^{2}}\n= \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{b}.\n$$\n\nNext, we derive the exact sampled-data closed loop under Zero-Order Hold (ZOH). Over one sampling interval $[kh,(k+1)h)$ with constant input $u(t) \\equiv u(kh)$, the state evolution is given by the state-transition formula\n$$\nx((k+1)h) = \\exp(A h)\\,x(kh) + \\int_{0}^{h} \\exp(A \\tau)\\,B\\,u(kh)\\,d\\tau,\n$$\nwhere in the scalar case $A = a$ and $B = b$, and $\\exp(A h) = \\exp(a h)$. With the sampled implementation of the continuous-time LQR gain, we apply $u(kh) = -K\\,x(kh)$. Therefore,\n$$\nx_{k+1} = \\exp(a h)\\,x_{k} - \\left(\\int_{0}^{h} \\exp(a \\tau)\\,b\\,d\\tau\\right) K\\,x_{k},\n$$\nso the exact discrete-time closed-loop scalar multiplier is\n$$\nF(h) \\equiv \\exp(a h) - \\Gamma(h)\\,K,\n\\qquad\n\\Gamma(h) \\equiv \\int_{0}^{h} \\exp(a \\tau)\\,b\\,d\\tau.\n$$\nEvaluating the integral for $a \\neq 0$,\n$$\n\\Gamma(h) = b \\int_{0}^{h} \\exp(a \\tau)\\,d\\tau\n= b\\,\\frac{\\exp(a h) - 1}{a}.\n$$\nHence,\n$$\nF(h) = \\exp(a h) - \\frac{b K}{a}\\,\\left(\\exp(a h) - 1\\right)\n= \\left(1 - \\frac{b K}{a}\\right)\\exp(a h) + \\frac{b K}{a}.\n$$\n\nSchur stability for the scalar discrete-time system requires $|F(h)|  1$. Because the continuous-time LQR design guarantees $a - b K  0$ (hence $b K  a$ for $a  0$, $b  0$), we have $\\frac{b K}{a}  1$, implying $1 - \\frac{b K}{a}  0$. Since $\\exp(a h)$ is strictly increasing in $h$ for $a  0$, $F(h)$ is strictly decreasing in $h$, with $F(0) = 1$ and $F(h) \\to -\\infty$ as $h \\to \\infty$. Therefore, the maximal sampling period $h_{\\max}$ for which $|F(h)|  1$ holds is attained when $F(h_{\\max}) = -1$.\n\nSet $F(h) = -1$ and solve for $h$. Let $z \\equiv \\exp(a h)  1$ for $h  0$ and define $r \\equiv \\frac{b K}{a}  1$. Then\n$$\nF(h) = (1 - r) z + r = -1\n\\quad\\Longrightarrow\\quad\n(1 - r) z = -1 - r\n\\quad\\Longrightarrow\\quad\nz = \\frac{-1 - r}{1 - r} = \\frac{1 + r}{r - 1}.\n$$\nThus,\n$$\nh_{\\max} = \\frac{1}{a}\\,\\ln\\!\\left(\\frac{1 + r}{r - 1}\\right),\n\\qquad r \\equiv \\frac{b K}{a}.\n$$\n\nNow specialize to the given numerical parameters $a = 1$, $b = 1$, $q = 1$, $r = 1$. The continuous-time LQR gain is\n$$\nK = \\frac{a + \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{b}\n= \\frac{1 + \\sqrt{1 + 1}}{1}\n= 1 + \\sqrt{2}.\n$$\nHence $r = \\frac{b K}{a} = 1 + \\sqrt{2}$. Substituting into the expression for $h_{\\max}$,\n$$\nh_{\\max}\n= \\frac{1}{1} \\ln\\!\\left(\\frac{1 + (1 + \\sqrt{2})}{(1 + \\sqrt{2}) - 1}\\right)\n= \\ln\\!\\left(\\frac{2 + \\sqrt{2}}{\\sqrt{2}}\\right)\n= \\ln\\!\\left(1 + \\sqrt{2}\\right).\n$$\nThis is an exact expression in seconds, as requested.", "answer": "$$\\boxed{\\ln\\!\\left(1+\\sqrt{2}\\right)}$$", "id": "2734403"}]}