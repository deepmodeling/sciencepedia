{"hands_on_practices": [{"introduction": "The cornerstone of the port-Hamiltonian approach is its explicit representation of energy flow. This first practice focuses on the fundamental power balance identity, which governs how the system's stored energy, the Hamiltonian $H(x)$, evolves over time. By deriving and computing the rate of change $\\dot{H}(x)$ for a nonlinear pendulum, you will gain a concrete understanding of how internal dissipation and external control action contribute to the system's energy dynamics [@problem_id:2733288].", "problem": "Consider a single-degree-of-freedom rigid pendulum modeled as a nonlinear port-Hamiltonian (pH) system. The state is $x = \\begin{bmatrix} q \\\\ p \\end{bmatrix}$, where $q$ is the angular position and $p$ is the angular momentum. The Hamiltonian (total stored energy) is $H(x) = \\dfrac{p^{2}}{2 m} + m g L \\left(1 - \\cos q\\right)$, where $m$ is the mass, $g$ is the gravitational acceleration, and $L$ is the length. The pH form is defined by the structural interconnection-dissipation-input mapping\n$$\n\\dot{x} = \\left(J(x) - R(x)\\right) \\nabla H(x) + G(x)\\, u, \\quad y = G(x)^{\\top} \\nabla H(x),\n$$\nwith $J(x) = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$ skew-symmetric, dissipation matrix $R(x) = \\mathrm{diag}\\!\\left(0,\\, d(q)\\right)$ where $d(q) = d_{0} + d_{1} \\sin^{2}(q)$ with $d_{0} \\ge 0$ and $d_{1} \\ge 0$, and input matrix $G(x) = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$. The output is the port variable $y$. Angles must be given in radians.\n\nStarting only from the port-Hamiltonian definition above and the basic energy-balance identity implied by skew-symmetry of $J(x)$ and positive semidefiniteness of $R(x)$, perform the following:\n\n1) Derive the expression for the time derivative $\\dot{H}(x)$ under the static output feedback $u = - K\\, y$, where $K$ is a real scalar. Your derivation must be based on the definitions of the Hamiltonian, its gradient, the port variables, and the dissipation and interconnection structure. Do not assume any pre-known closed-form of $\\dot{H}(x)$; derive it using the fundamental pH energy balance.\n\n2) Using your derived expression for $\\dot{H}(x)$, implement a program that evaluates $\\dot{H}(x)$ for the following test suite. For each case, also determine whether the closed-loop instantaneous energy dissipation is nonnegative for all momenta at the given angle, namely whether the condition $d(q) + K \\ge 0$ holds. Report:\n- the scalar value of $\\dot{H}(x)$ in joules per second (J/s), rounded to six decimal places, and\n- a boolean indicating whether $d(q) + K \\ge 0$ at the specified $q$.\n\nUse the parameter sets below, where $m$ is in kilograms, $L$ is in meters, $g$ is in meters per second squared, and $p$ is in kilogram-meter squared per second. All angles are in radians. The damping parameters $d_{0}$ and $d_{1}$ and the feedback gain $K$ are real scalars.\n\nTest suite (each tuple is $(m, L, g, d_{0}, d_{1}, K, q, p)$):\n- Case A (general nonlinear dissipative, positive feedback damping): $(1.0, 1.0, 9.81, 0.2, 0.3, 0.5, 1.0, 0.7)$.\n- Case B (zero momentum edge case): $(1.0, 1.0, 9.81, 0.1, 0.2, -0.05, 0.4, 0.0)$.\n- Case C (net negative damping at the port leading to energy increase): $(1.0, 1.0, 9.81, 0.05, 0.0, -0.2, 1.3, 0.4)$.\n- Case D (near boundary: small net damping): $(1.0, 1.0, 9.81, 0.05, 0.0, -0.04, 0.9, 0.9)$.\n- Case E (different mass and stronger nonlinear dissipation): $(2.0, 1.0, 9.81, 0.2, 0.5, 0.0, 2.0, 0.7)$.\n\nYour program should compute, for each case, the pair $[\\dot{H}(x), \\text{condition}]$, where $\\dot{H}(x)$ is the value rounded to six decimal places in $\\mathrm{J/s}$ and $\\text{condition}$ is the boolean for $d(q) + K \\ge 0$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list in the form $[\\text{float}, \\text{boolean}]$. For example: $[[\\text{float},\\text{boolean}],[\\text{float},\\text{boolean}],\\ldots]$.", "solution": "We begin from the definition of a port-Hamiltonian (pH) system with state $x \\in \\mathbb{R}^{n}$, Hamiltonian $H(x)$, interconnection matrix $J(x)$ with $J(x) = - J(x)^{\\top}$, dissipation matrix $R(x) = R(x)^{\\top} \\succeq 0$, input matrix $G(x)$, input $u$, and output $y = G(x)^{\\top} \\nabla H(x)$. The dynamics are\n$$\n\\dot{x} = \\left(J(x) - R(x)\\right) \\nabla H(x) + G(x)\\, u.\n$$\nThe energy-balance identity for such systems follows directly from the chain rule and the structure: the time derivative of the Hamiltonian along trajectories is\n$$\n\\dot{H}(x) = \\nabla H(x)^{\\top} \\dot{x} = \\nabla H(x)^{\\top} \\left(J(x) - R(x)\\right) \\nabla H(x) + \\nabla H(x)^{\\top} G(x)\\, u.\n$$\nBecause $J(x)$ is skew-symmetric, we have $\\nabla H(x)^{\\top} J(x) \\nabla H(x) = 0$, which yields\n$$\n\\dot{H}(x) = - \\nabla H(x)^{\\top} R(x) \\nabla H(x) + y^{\\top} u.\n$$\nThis identity encodes power conservation and dissipation: the first term is nonpositive when $R(x) \\succeq 0$, and the second term is the supplied power at the port.\n\nSpecialize to the pendulum with $x = \\begin{bmatrix} q \\\\ p \\end{bmatrix}$, Hamiltonian\n$$\nH(q,p) = \\frac{p^{2}}{2 m} + m g L \\left(1 - \\cos q\\right),\n$$\ninterconnection $J(x) = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$, dissipation $R(x) = \\mathrm{diag}\\!\\left(0, d(q)\\right)$ with $d(q) = d_{0} + d_{1} \\sin^{2}(q)$ and $d_{0} \\ge 0$, $d_{1} \\ge 0$, and input matrix $G(x) = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$. The gradient of $H$ is\n$$\n\\nabla H(x) = \\begin{bmatrix} \\dfrac{\\partial H}{\\partial q} \\\\[6pt] \\dfrac{\\partial H}{\\partial p} \\end{bmatrix}\n= \\begin{bmatrix} m g L \\sin q \\\\[6pt] \\dfrac{p}{m} \\end{bmatrix}.\n$$\nThe output is\n$$\ny = G(x)^{\\top} \\nabla H(x) = \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} m g L \\sin q \\\\[4pt] \\dfrac{p}{m} \\end{bmatrix} = \\frac{p}{m}.\n$$\nThe dissipation term becomes\n$$\n\\nabla H(x)^{\\top} R(x) \\nabla H(x) = \\begin{bmatrix} m g L \\sin q  \\dfrac{p}{m} \\end{bmatrix}\n\\begin{bmatrix} 0  0 \\\\ 0  d(q) \\end{bmatrix}\n\\begin{bmatrix} m g L \\sin q \\\\[4pt] \\dfrac{p}{m} \\end{bmatrix} = d(q)\\, \\left(\\frac{p}{m}\\right)^{2}.\n$$\nSubstitute into the energy balance to obtain\n$$\n\\dot{H}(x) = - d(q)\\, \\left(\\frac{p}{m}\\right)^{2} + y^{\\top} u.\n$$\nUnder static output feedback $u = - K\\, y$ with scalar $K \\in \\mathbb{R}$, we have $y^{\\top} u = - K\\, y^{2} = - K \\left(\\frac{p}{m}\\right)^{2}$. Therefore,\n$$\n\\dot{H}(x) = - \\left(d(q) + K\\right) \\left(\\frac{p}{m}\\right)^{2}.\n$$\nThis expression is derived purely from the pH structure and the feedback law, using the skew-symmetry of $J(x)$ and the definition of the port variables.\n\nFrom this formula, two conclusions follow:\n- For any fixed angle $q$, the closed-loop instantaneous energy rate satisfies $\\dot{H}(x) \\le 0$ for all $p$ if and only if $d(q) + K \\ge 0$. When $d(q) + K  0$, the energy strictly decreases for all $p \\ne 0$. When $d(q) + K = 0$, the energy is constant for all $p$. When $d(q) + K  0$, the energy increases for all $p \\ne 0$.\n- Independently of $q$ and $K$, if $p = 0$ then $y = 0$ and $\\dot{H}(x) = 0$.\n\nAlgorithmic design for computation:\n1) For each test case, read $(m, L, g, d_{0}, d_{1}, K, q, p)$.\n2) Compute $d(q) = d_{0} + d_{1} \\sin^{2}(q)$.\n3) Compute $y = p/m$.\n4) Compute $\\dot{H}(x) = - \\left(d(q) + K\\right) y^{2}$.\n5) Determine the boolean $\\mathrm{condition} = \\left(d(q) + K \\ge 0\\right)$ at the given $q$. This condition characterizes whether the closed-loop instantaneous energy dissipation is nonnegative for all $p$ at that angle.\n6) Round $\\dot{H}(x)$ to six decimal places and report the pair $[\\dot{H}(x), \\mathrm{condition}]$.\n\nNumerical output requirements:\n- Angles must be in radians.\n- Report $\\dot{H}(x)$ in joules per second, rounded to six decimal places.\n- The final output must be a single line that is a list of the five per-case results, each result being a two-element list $[\\text{float}, \\text{boolean}]$ formatted as $[[\\cdot,\\cdot],[\\cdot,\\cdot],\\ldots]$.\n\nThe provided program implements exactly this procedure for the specified test suite.", "answer": "```python\nimport numpy as np\n\ndef compute_dHdt_and_condition(m, L, g, d0, d1, K, q, p):\n    # d(q) = d0 + d1 * sin(q)^2\n    dq = d0 + d1 * (np.sin(q) ** 2)\n    # y = p / m\n    y = p / m\n    # dH/dt = - (d(q) + K) * y^2\n    dHdt = - (dq + K) * (y ** 2)\n    # Condition: nonnegative instantaneous dissipation for all p at this q\n    condition = (dq + K) >= 0.0\n    return dHdt, condition\n\ndef solve():\n    # Define the test cases as specified:\n    # Each tuple: (m, L, g, d0, d1, K, q, p)\n    test_cases = [\n        (1.0, 1.0, 9.81, 0.2, 0.3, 0.5, 1.0, 0.7),   # Case A\n        (1.0, 1.0, 9.81, 0.1, 0.2, -0.05, 0.4, 0.0), # Case B\n        (1.0, 1.0, 9.81, 0.05, 0.0, -0.2, 1.3, 0.4), # Case C\n        (1.0, 1.0, 9.81, 0.05, 0.0, -0.04, 0.9, 0.9),# Case D\n        (2.0, 1.0, 9.81, 0.2, 0.5, 0.0, 2.0, 0.7),   # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        m, L, g, d0, d1, K, q, p = case\n        dHdt, cond = compute_dHdt_and_condition(m, L, g, d0, d1, K, q, p)\n        # Round to six decimals for output\n        dHdt_rounded = float(f\"{dHdt:.6f}\")\n        results.append((dHdt_rounded, cond))\n\n    # Format as a single-line list of [float,boolean] pairs\n    formatted_items = []\n    for val, flag in results:\n        # Ensure six decimal places in string representation\n        formatted_items.append(f\"[{val:.6f},{str(flag).lower()}]\")\n    print(f\"[{','.join(formatted_items)}]\")\n\nsolve()\n```", "id": "2733288"}, {"introduction": "While energy is central to the pH framework, understanding what can be inferred from measurements is equally critical for control and estimation. This exercise bridges port-Hamiltonian theory with classical concepts of observability and detectability. You will analyze a linear pH system to identify its unobservable subspace, which contains dynamics that are invisible to the output ports, and determine the stability of these hidden modes [@problem_id:2733257].", "problem": "Consider the linear time-invariant port-Hamiltonian (pH) system in standard form\n$$\\dot{x} = \\left(J - R\\right) Q\\,x + G\\,u,\\quad y = G^{\\top} Q\\,x,$$\nwhere $x \\in \\mathbb{R}^{4}$ is the state, $u \\in \\mathbb{R}^{2}$ is the input, $y \\in \\mathbb{R}^{2}$ is the measured output, $Q \\in \\mathbb{R}^{4 \\times 4}$ is symmetric positive definite, $J \\in \\mathbb{R}^{4 \\times 4}$ is skew-symmetric, and $R \\in \\mathbb{R}^{4 \\times 4}$ is symmetric positive semidefinite. Let the Hamiltonian be $H(x) = \\frac{1}{2} x^{\\top} Q x$. Take\n$$Q = I_{4},\\quad J = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  0  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  0\n\\end{bmatrix},\\quad R = \\operatorname{diag}\\!\\left(0,\\,2,\\,0,\\,r_{4}\\right),\\quad r_{4}  0,$$\nand\n$$G = \\begin{bmatrix}\n1  0\\\\\n0  1\\\\\n0  0\\\\\n0  0\n\\end{bmatrix},\\quad \\text{so that}\\; y = \\begin{bmatrix} x_{1}\\\\ x_{2} \\end{bmatrix}.$$\nDefine $A := (J-R)Q$ and $C := G^{\\top} Q$ so that the unforced output is $y = C x$. Use only foundational definitions and properties to reason about observability and detectability: observability of $(A,C)$ via the classical observability matrix, the Hamiltonian energy balance $\\dot{H}(x) = -(\\nabla H(x))^{\\top} R\\, (\\nabla H(x))$ for $u \\equiv 0$, and detectability as the requirement that all unobservable modes are asymptotically stable.\n\nTask: Determine the dimension $d$ of the largest unobservable subspace of the pair $(A,C)$ and the asymptotic decay rate $\\alpha$ of trajectories confined to this unobservable subspace (defined as the positive number such that these trajectories decay proportionally to $\\exp(-\\alpha t)$). Express your final answer as two entries in a row matrix $\\begin{pmatrix} d  \\alpha \\end{pmatrix}$. No rounding is required.", "solution": "First, we construct the state-space matrices $A$ and $C$ based on the provided data.\nThe matrix $Q$ is the identity matrix $I_{4}$, so the Hamiltonian is $H(x) = \\frac{1}{2} x^{\\top} I_{4} x = \\frac{1}{2} x^{\\top} x$.\nThe system matrix $A$ is given by $A = (J-R)Q = (J-R)I_{4} = J-R$.\nSubstituting the given matrices for $J$ and $R$:\n$$A = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  0  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  0\n\\end{bmatrix} - \\begin{bmatrix}\n0  0  0  0\\\\\n0  2  0  0\\\\\n0  0  0  0\\\\\n0  0  0  r_{4}\n\\end{bmatrix} = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  -2  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  -r_{4}\n\\end{bmatrix}.$$\nThe output matrix $C$ is given by $C = G^{\\top}Q = G^{\\top}I_{4} = G^{\\top}$.\n$$C = \\begin{bmatrix}\n1  0\\\\\n0  1\\\\\n0  0\\\\\n0  0\n\\end{bmatrix}^{\\top} = \\begin{bmatrix}\n1  0  0  0\\\\\n0  1  0  0\n\\end{bmatrix}.$$\nThe unobservable subspace is the null space of the observability matrix $\\mathcal{O}$, defined as\n$$\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^{2} \\\\ CA^{3} \\end{bmatrix}.$$\nA state vector $x$ belongs to the unobservable subspace if and only if $x \\in \\ker(\\mathcal{O})$, which is equivalent to $CA^{k}x = 0$ for all integers $k \\ge 0$.\nLet $x = \\begin{pmatrix} x_{1}  x_{2}  x_{3}  x_{4} \\end{pmatrix}^{\\top}$ be an unobservable state.\nThe first condition is $Cx = 0$:\n$$Cx = \\begin{bmatrix}\n1  0  0  0\\\\\n0  1  0  0\n\\end{bmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\\\ x_{4} \\end{pmatrix} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\nThis implies that any unobservable state must have $x_{1}=0$ and $x_{2}=0$, so it must be of the form $x = \\begin{pmatrix} 0  0  x_{3}  x_{4} \\end{pmatrix}^{\\top}$.\n\nNow we consider the condition $CAx = 0$. First, we compute $Ax$:\n$$Ax = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  -2  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  -r_{4}\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ x_{3} \\\\ x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ x_{3} \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix}.$$\nThen, we apply $C$:\n$$CAx = \\begin{bmatrix}\n1  0  0  0\\\\\n0  1  0  0\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ x_{3} \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ x_{3} \\end{pmatrix}.$$\nFor $x$ to be unobservable, we require $CAx = 0$, which implies $x_{3} = 0$.\nThus, an unobservable state must be of the form $x = \\begin{pmatrix} 0  0  0  x_{4} \\end{pmatrix}^{\\top}$.\n\nWe must verify that any such state is indeed unobservable by checking that $CA^{k}x = 0$ for all $k \\ge 0$. Let $x = \\begin{pmatrix} 0  0  0  x_{4} \\end{pmatrix}^{\\top}$. We have already shown $Cx=0$ and $CAx=0$.\nLet us compute $A^{2}x$:\n$$A^{2}x = A(Ax) = A \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -r_{4}x_{4} \\end{pmatrix} = \\begin{bmatrix}\n0  1  0  0\\\\\n-1  -2  1  0\\\\\n0  -1  0  0\\\\\n0  0  0  -r_{4}\n\\end{bmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -r_{4} x_{4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ (-r_{4})^{2} x_{4} \\end{pmatrix}.$$\nThen $CA^{2}x = C \\begin{pmatrix} 0  0  0  (-r_{4})^{2} x_{4} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nBy induction, it is clear that for any $k \\ge 1$, $A^{k}x = \\begin{pmatrix} 0  0  0  (-r_{4})^{k} x_{4} \\end{pmatrix}^{\\top}$, and thus $CA^{k}x = 0$.\nThe unobservable subspace is therefore the set of all vectors of the form $\\begin{pmatrix} 0  0  0  x_{4} \\end{pmatrix}^{\\top}$. This subspace is spanned by the vector $\\begin{pmatrix} 0  0  0  1 \\end{pmatrix}^{\\top}$.\nThe dimension $d$ of this subspace is $1$. So, $d=1$.\n\nNext, we must determine the asymptotic decay rate $\\alpha$ of trajectories confined to this unobservable subspace. A trajectory $x(t)$ is confined to this subspace if its initial state $x(0)$ is in the subspace, i.e., $x(0) = \\begin{pmatrix} 0  0  0  x_{4,0} \\end{pmatrix}^{\\top}$ for some constant $x_{4,0}$.\nThe dynamics of the system with zero input ($u=0$) are $\\dot{x} = Ax$. For a state $x$ in the unobservable subspace, i.e., $x(t) = \\begin{pmatrix} 0  0  0  x_{4}(t) \\end{pmatrix}^{\\top}$, the dynamics reduce to the fourth component:\n$$\\dot{x}_{4}(t) = [A x(t)]_{4} = -r_{4} x_{4}(t).$$\nThis is a first-order linear ordinary differential equation. Its solution is:\n$$x_{4}(t) = x_{4}(0) \\exp(-r_{4} t).$$\nThe full state trajectory is $x(t) = \\begin{pmatrix} 0  0  0  x_{4}(0) \\exp(-r_{4}t) \\end{pmatrix}^{\\top}$.\nThe problem defines $\\alpha$ as the positive number such that these trajectories decay proportionally to $\\exp(-\\alpha t)$. By comparing $x_4(t)$ with this definition, we identify the decay rate.\nSince $r_{4}  0$, the trajectory indeed decays. The decay rate is $\\alpha = r_{4}$.\nThis confirms that the system is detectable, as the unobservable mode corresponding to the eigenvalue $\\lambda = -r_{4}$ is asymptotically stable.\n\nThe dimension of the unobservable subspace is $d=1$, and the asymptotic decay rate of its trajectories is $\\alpha = r_{4}$. The question asks for these two values in a row matrix.", "answer": "$$\\boxed{\\begin{pmatrix} 1  r_{4} \\end{pmatrix}}$$", "id": "2733257"}, {"introduction": "Building on the foundations of energy dynamics and system analysis, this final practice delves into a practical control design problem. You are tasked with allocating dissipative control action across multiple actuators while respecting physical amplitude limits, a common challenge in engineering applications. This problem demonstrates how the passivity principles of pH systems can be used to systematically design controllers that are both effective and mindful of real-world constraints [@problem_id:2733273].", "problem": "Consider a single-degree-of-freedom mechanical system modeled as a port-Hamiltonian system (PHS) with state $x = \\begin{pmatrix} q \\\\ p \\end{pmatrix}$, Hamiltonian energy $H(q,p) = \\frac{1}{2}k q^{2} + \\frac{1}{2m} p^{2}$, skew-symmetric interconnection matrix $J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$, and native dissipation matrix $R_{0} = \\begin{pmatrix} 0  0 \\\\ 0  r \\end{pmatrix}$ with $r \\ge 0$. The system is actuated through two collocated input-output ports with input vector $u = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ and output vector $y = \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix}$. The input matrix is \n$$\nG = \\begin{pmatrix} 0  0 \\\\ g_{1}  g_{2} \\end{pmatrix},\n$$\nwhere $g_{1}, g_{2} \\in \\mathbb{R}\\setminus\\{0\\}$ are given constants. The PHS dynamics and port outputs are\n$$\n\\dot{x} = (J - R_{0}) \\nabla H(x) + G u, \n\\quad \ny = G^{\\top} \\nabla H(x).\n$$\nRecall that for this mechanical PHS, the co-energy variable associated with momentum is the velocity $v = \\frac{\\partial H}{\\partial p} = \\frac{p}{m}$, so that $y_{i} = g_{i} v$ for $i \\in \\{1,2\\}$.\n\nYou are tasked with allocating damping injection across the two ports using a passivity-based control law of the form \n$$\nu_{i} = - K_{i} \\, y_{i}, \\quad K_{i} \\ge 0,\n$$ \nsubject to individual actuator amplitude limits $|u_{i}| \\le \\bar{u}_{i}$ whenever $|v| \\le V_{\\max}$, where $\\bar{u}_{1}, \\bar{u}_{2}, V_{\\max}  0$ are given constants. To encode a desired total damping level with tunable port allocation, define a total gain $\\kappa  0$ and an allocation parameter $\\alpha \\in (0,1)$ by\n$$\nK_{1} = \\alpha \\, \\kappa, \n\\qquad \nK_{2} = (1 - \\alpha) \\, \\kappa.\n$$\n\nStarting only from the port-Hamiltonian power balance and the passivity inequality, derive the closed-loop energy dissipation inequality under the above control and show how the actuator amplitude limits constrain $\\kappa$ as a function of $\\alpha$. Then, determine the choice of $\\alpha$ that maximizes the admissible $\\kappa$ subject to these constraints and passivity. \n\nProvide your final answer as a single closed-form analytic expression for the optimal allocation parameter $\\alpha^{\\star}$ in terms of $\\bar{u}_{1}$, $\\bar{u}_{2}$, $g_{1}$, and $g_{2}$. Do not substitute numerical values. Your final answer must be unitless and expressed in simplest exact form. No rounding is required.", "solution": "The fundamental power balance for a port-Hamiltonian system is derived from the time derivative of the Hamiltonian function, $H(x)$. The rate of change of energy is given by $\\dot{H} = (\\nabla H)^{\\top} \\dot{x}$. Substituting the system dynamics, $\\dot{x} = (J - R_{0}) \\nabla H(x) + G u$, yields:\n$$\n\\dot{H} = (\\nabla H)^{\\top} \\left( (J - R_{0}) \\nabla H + G u \\right) = (\\nabla H)^{\\top} (J - R_{0}) \\nabla H + (\\nabla H)^{\\top} G u\n$$\nGiven that the interconnection matrix $J$ is skew-symmetric ($J^{\\top} = -J$), the term $(\\nabla H)^{\\top} J \\nabla H$ is identically zero. The term $-(\\nabla H)^{\\top} R_{0} \\nabla H$ represents the power dissipated internally by the system. The term $(\\nabla H)^{\\top} G u$ can be rewritten using the definition of the output vector, $y = G^{\\top} \\nabla H$, which gives $y^{\\top} u = (G^{\\top} \\nabla H)^{\\top} u = (\\nabla H)^{\\top} G u$. Thus, the power balance equation is:\n$$\n\\dot{H}(x) = -(\\nabla H(x))^{\\top} R_{0} \\nabla H(x) + y^{\\top} u\n$$\nThis equation states that the rate of change of stored energy is equal to the supplied power $y^{\\top} u$ minus the natively dissipated power.\n\nThe control law is a static feedback $u_{i} = -K_{i} y_{i}$, with $K_{i} \\ge 0$. In vector form, this is $u = -K y$, where $K = \\text{diag}(K_{1}, K_{2})$ is a positive semi-definite diagonal matrix. Substituting this into the power balance gives the closed-loop energy dynamics:\n$$\n\\dot{H} = -(\\nabla H)^{\\top} R_{0} \\nabla H + y^{\\top} (-Ky) = -(\\nabla H)^{\\top} R_{0} \\nabla H - y^{\\top} K y\n$$\nBoth terms on the right-hand side are non-positive, confirming that the control action injects dissipation and the closed-loop system is passive.\n\nWe now express these terms using the problem's specific definitions. The gradient of the Hamiltonian is $\\nabla H = \\begin{pmatrix} kq  p/m \\end{pmatrix}^{\\top} = \\begin{pmatrix} kq  v \\end{pmatrix}^{\\top}$.\nThe native dissipation term becomes:\n$$\n-(\\nabla H)^{\\top} R_{0} \\nabla H = - \\begin{pmatrix} kq  v \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  r \\end{pmatrix} \\begin{pmatrix} kq \\\\ v \\end{pmatrix} = -r v^{2}\n$$\nThe output vector is $y = G^{\\top} \\nabla H = \\begin{pmatrix} 0  g_{1} \\\\ 0  g_{2} \\end{pmatrix} \\begin{pmatrix} kq \\\\ v \\end{pmatrix} = \\begin{pmatrix} g_{1}v \\\\ g_{2}v \\end{pmatrix}$.\nThe control-injected dissipation term is:\n$$\n-y^{\\top} K y = - \\begin{pmatrix} g_{1}v \\\\ g_{2}v \\end{pmatrix}^{\\top} \\begin{pmatrix} K_{1}  0 \\\\ 0  K_{2} \\end{pmatrix} \\begin{pmatrix} g_{1}v \\\\ g_{2}v \\end{pmatrix} = -(K_{1} (g_{1}v)^{2} + K_{2} (g_{2}v)^{2}) = -(K_{1}g_{1}^{2} + K_{2}g_{2}^{2}) v^{2}\n$$\nCombining these results, the closed-loop energy dissipation inequality is defined by the equality:\n$$\n\\dot{H} = -(r + K_{1}g_{1}^{2} + K_{2}g_{2}^{2}) v^{2} \\le 0\n$$\n\nNext, we establish the constraints on the control gains imposed by the actuator amplitude limits. The constraint is $|u_{i}| \\le \\bar{u}_{i}$ for all $|v| \\le V_{\\max}$. From the control law $u_{i} = -K_{i} y_{i}$ and the output relation $y_{i} = g_{i} v$, we have $u_{i} = -K_{i} g_{i} v$. The magnitude is $|u_{i}| = K_{i} |g_{i}| |v|$, since $K_{i} \\ge 0$. The constraint must hold for the worst case, which occurs at the maximum velocity magnitude, $|v| = V_{\\max}$. This leads to the conditions:\n$$\nK_{i} |g_{i}| V_{\\max} \\le \\bar{u}_{i} \\quad \\text{for } i \\in \\{1, 2\\}\n$$\nThis gives two upper bounds on the control gains:\n$$\nK_{1} \\le \\frac{\\bar{u}_{1}}{|g_{1}| V_{\\max}} \\qquad \\text{and} \\qquad K_{2} \\le \\frac{\\bar{u}_{2}}{|g_{2}| V_{\\max}}\n$$\nSubstituting the parameterization $K_{1} = \\alpha \\kappa$ and $K_{2} = (1 - \\alpha) \\kappa$, with $\\alpha \\in (0,1)$ and $\\kappa > 0$, we find the constraints on the total gain $\\kappa$:\n$$\n\\alpha \\kappa \\le \\frac{\\bar{u}_{1}}{|g_{1}| V_{\\max}} \\implies \\kappa \\le \\frac{\\bar{u}_{1}}{\\alpha |g_{1}| V_{\\max}}\n$$\n$$\n(1 - \\alpha) \\kappa \\le \\frac{\\bar{u}_{2}}{|g_{2}| V_{\\max}} \\implies \\kappa \\le \\frac{\\bar{u}_{2}}{(1 - \\alpha) |g_{2}| V_{\\max}}\n$$\nFor a given allocation $\\alpha$, $\\kappa$ must satisfy both inequalities. Thus, the maximum admissible $\\kappa$ is the minimum of these two upper bounds:\n$$\n\\kappa_{\\text{admissible}}(\\alpha) = \\min \\left( \\frac{\\bar{u}_{1}}{\\alpha |g_{1}| V_{\\max}}, \\frac{\\bar{u}_{2}}{(1 - \\alpha) |g_{2}| V_{\\max}} \\right)\n$$\nThe problem is to find the allocation $\\alpha^{\\star} \\in (0,1)$ that maximizes this admissible total gain $\\kappa$. Let us define two positive constants $C_{1} = \\frac{\\bar{u}_{1}}{|g_{1}| V_{\\max}}$ and $C_{2} = \\frac{\\bar{u}_{2}}{|g_{2}| V_{\\max}}$. The function to maximize is $\\kappa(\\alpha) = \\min \\left( \\frac{C_{1}}{\\alpha}, \\frac{C_{2}}{1-\\alpha} \\right)$. The function $f_{1}(\\alpha) = \\frac{C_{1}}{\\alpha}$ is strictly decreasing for $\\alpha > 0$, while the function $f_{2}(\\alpha) = \\frac{C_{2}}{1-\\alpha}$ is strictly increasing for $\\alpha  1$. The maximum of the minimum of these two functions occurs at their intersection point, where $f_{1}(\\alpha) = f_{2}(\\alpha)$.\nTherefore, we set the two bounds equal to find the optimal $\\alpha^{\\star}$:\n$$\n\\frac{\\bar{u}_{1}}{\\alpha^{\\star} |g_{1}| V_{\\max}} = \\frac{\\bar{u}_{2}}{(1 - \\alpha^{\\star}) |g_{2}| V_{\\max}}\n$$\nThe term $V_{\\max}$ is common to both denominators and cancels out:\n$$\n\\frac{\\bar{u}_{1}}{\\alpha^{\\star} |g_{1}|} = \\frac{\\bar{u}_{2}}{(1 - \\alpha^{\\star}) |g_{2}|}\n$$\nWe solve for $\\alpha^{\\star}$ by cross-multiplication:\n$$\n\\bar{u}_{1} |g_{2}| (1 - \\alpha^{\\star}) = \\bar{u}_{2} |g_{1}| \\alpha^{\\star}\n$$\n$$\n\\bar{u}_{1} |g_{2}| - \\bar{u}_{1} |g_{2}| \\alpha^{\\star} = \\bar{u}_{2} |g_{1}| \\alpha^{\\star}\n$$\n$$\n\\bar{u}_{1} |g_{2}| = (\\bar{u}_{1} |g_{2}| + \\bar{u}_{2} |g_{1}|) \\alpha^{\\star}\n$$\nIsolating $\\alpha^{\\star}$ gives the optimal allocation parameter:\n$$\n\\alpha^{\\star} = \\frac{\\bar{u}_{1} |g_{2}|}{\\bar{u}_{1} |g_{2}| + \\bar{u}_{2} |g_{1}|}\n$$\nThis expression is dimensionless and depends only on the required parameters $\\bar{u}_{1}, \\bar{u}_{2}, g_{1}, g_{2}$. Since $\\bar{u}_{1}, \\bar{u}_{2} > 0$ and $g_{1}, g_{2} \\neq 0$, the numerator and denominator are both positive, so $\\alpha^{\\star} > 0$. The denominator is strictly greater than the numerator, which ensures $\\alpha^{\\star}  1$. The result is consistent with the required domain $\\alpha \\in (0,1)$.", "answer": "$$\n\\boxed{\\frac{\\bar{u}_{1} |g_{2}|}{\\bar{u}_{1} |g_{2}| + \\bar{u}_{2} |g_{1}|}}\n$$", "id": "2733273"}]}