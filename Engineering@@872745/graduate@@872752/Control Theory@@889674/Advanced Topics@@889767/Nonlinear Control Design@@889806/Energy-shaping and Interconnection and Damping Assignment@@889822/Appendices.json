{"hands_on_practices": [{"introduction": "The port-Hamiltonian framework elegantly decomposes system dynamics into components that dissipate energy and those that merely transfer it internally. The skew-symmetric interconnection matrix $J_d(x)$ governs these internal energy flows through so-called gyroscopic forces. This exercise [@problem_id:2704637] offers a hands-on proof from first principles, demonstrating that these forces are inherently power-conservative, a cornerstone property that enables energy-shaping control.", "problem": "Consider the Interconnection and Damping Assignment–Passivity-Based Control (IDA-PBC) target closed-loop dynamics for a smooth system modeled on a state space of dimension $3$, with desired Hamiltonian $H_{d} : \\mathbb{R}^{3} \\to \\mathbb{R}$ given by\n$$\nH_{d}(x) \\triangleq \\frac{1}{2}\\,x^{\\top} x,\n$$\nwhere $x \\in \\mathbb{R}^{3}$. Assume the target closed-loop dynamics are of port-Hamiltonian form with an interconnection matrix $J_{d}(x)$ and a damping matrix $R_{d}(x)$,\n$$\n\\dot{x} = \\big(J_{d}(x) - R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\nwhere $J_{d}(x)$ is a $3 \\times 3$ matrix field, $R_{d}(x)$ is a symmetric positive semidefinite matrix field, and $\\nabla H_{d}(x)$ is the gradient of $H_{d}$. In this framework, the vector field\n$$\nf_{g}(x) \\triangleq J_{d}(x)\\,\\nabla H_{d}(x)\n$$\nis interpreted as a gyroscopic force field when $J_{d}(x)$ is skew-symmetric. \n\nYour tasks are:\n- Construct a smooth, state-dependent, skew-symmetric interconnection $J_{d}(x)$ that is nontrivial (i.e., not identically zero) and therefore introduces nonzero gyroscopic forces for generic $x$. To this end, use the cross-product (hat-map) parametrization:\n$$\nJ_{d}(x) \\triangleq \\widehat{\\omega(x)} \\quad \\text{with} \\quad \\omega(x) \\triangleq \\begin{pmatrix} x_{1}^{2} + \\exp\\!\\big(-x_{3}^{2}\\big) \\\\ x_{1} x_{2} \\\\ \\cos(x_{2}) \\end{pmatrix},\n$$\nand the standard hat-map $\\widehat{\\omega}$ defined by\n$$\n\\widehat{\\omega} \\triangleq \\begin{pmatrix}\n0 & -\\omega_{3} & \\omega_{2} \\\\\n\\omega_{3} & 0 & -\\omega_{1} \\\\\n-\\omega_{2} & \\omega_{1} & 0\n\\end{pmatrix}.\n$$\n- Starting from first principles (definitions of gradient, chain rule for time derivatives, and the property of skew-symmetric matrices), rigorously prove that the gyroscopic forces generated by this $J_{d}(x)$ do not alter the time derivative of the desired Hamiltonian $H_{d}$ along trajectories of the closed-loop system, i.e., they do not produce dissipation nor injection of energy.\n- Compute the net power supplied by the gyroscopic forces,\n$$\nP_{g}(x) \\triangleq \\nabla H_{d}(x)^{\\top}\\, J_{d}(x)\\, \\nabla H_{d}(x),\n$$\nand report it as a single simplified analytic expression.\n\nAnswer format requirement: Provide the final value of $P_{g}(x)$ as a single closed-form analytic expression. No units are required. Do not provide an inequality or an equation. If an approximation were needed it would be specified, but here no rounding is required.", "solution": "The problem statement has been validated and is deemed to be a well-posed, scientifically grounded problem in the field of nonlinear control theory. It is self-contained, consistent, and adheres to standard mathematical formalism. We may, therefore, proceed with the solution.\n\nThe problem requires a proof concerning the energy-preserving nature of gyroscopic forces in a port-Hamiltonian system and the computation of the power associated with these forces. Let us begin from first principles.\n\nThe state vector is $x \\in \\mathbb{R}^{3}$. The desired Hamiltonian function is given as\n$$\nH_{d}(x) = \\frac{1}{2} x^{\\top}x = \\frac{1}{2} (x_{1}^{2} + x_{2}^{2} + x_{3}^{2}).\n$$\nTo analyze the time evolution of this energy function, we must first compute its gradient. The gradient of $H_{d}(x)$ with respect to the state vector $x$ is\n$$\n\\nabla H_{d}(x) = \\frac{\\partial H_{d}}{\\partial x} = \\begin{pmatrix} \\frac{\\partial H_{d}}{\\partial x_{1}} \\\\ \\frac{\\partial H_{d}}{\\partial x_{2}} \\\\ \\frac{\\partial H_{d}}{\\partial x_{3}} \\end{pmatrix} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} = x.\n$$\nThe target closed-loop dynamics are given by\n$$\n\\dot{x} = \\big(J_{d}(x) - R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\nwhere $J_{d}(x)$ is the interconnection matrix and $R_{d}(x)$ is the damping matrix.\n\nThe time derivative of the Hamiltonian $H_{d}(x(t))$ along the trajectories of the system is found using the chain rule:\n$$\n\\frac{d}{dt} H_{d}(x(t)) = \\left(\\nabla H_{d}(x)\\right)^{\\top} \\dot{x}.\n$$\nSubstituting the expression for $\\dot{x}$ from the system dynamics, we obtain:\n$$\n\\frac{d}{dt} H_{d}(x) = \\left(\\nabla H_{d}(x)\\right)^{\\top} \\big(J_{d}(x) - R_{d}(x)\\big)\\,\\nabla H_{d}(x).\n$$\nBy distributing the terms, we can separate the contributions from the interconnection and damping matrices:\n$$\n\\frac{d}{dt} H_{d}(x) = \\left(\\nabla H_{d}(x)\\right)^{\\top} J_{d}(x) \\nabla H_{d}(x) - \\left(\\nabla H_{d}(x)\\right)^{\\top} R_{d}(x) \\nabla H_{d}(x).\n$$\nThe first task is to prove that the gyroscopic forces, which are associated with the term $J_{d}(x) \\nabla H_{d}(x)$, do not alter the energy $H_{d}$. This is equivalent to proving that their contribution to the time derivative of $H_{d}$ is zero. The power supplied by the gyroscopic forces is the term $P_{g}(x) \\triangleq \\left(\\nabla H_{d}(x)\\right)^{\\top} J_{d}(x) \\nabla H_{d}(x)$. We must prove that $P_{g}(x) = 0$.\n\nThe matrix $J_{d}(x)$ is constructed via the hat-map, $J_{d}(x) = \\widehat{\\omega(x)}$, where\n$$\n\\widehat{\\omega} = \\begin{pmatrix} 0 & -\\omega_{3} & \\omega_{2} \\\\ \\omega_{3} & 0 & -\\omega_{1} \\\\ -\\omega_{2} & \\omega_{1} & 0 \\end{pmatrix}.\n$$\nBy its very definition, the hat-map produces a skew-symmetric matrix. Let us verify this property. The transpose of $J_{d}(x)$ is:\n$$\nJ_{d}(x)^{\\top} = \\begin{pmatrix} 0 & \\omega_{3} & -\\omega_{2} \\\\ -\\omega_{3} & 0 & \\omega_{1} \\\\ \\omega_{2} & -\\omega_{1} & 0 \\end{pmatrix} = - \\begin{pmatrix} 0 & -\\omega_{3} & \\omega_{2} \\\\ \\omega_{3} & 0 & -\\omega_{1} \\\\ -\\omega_{2} & \\omega_{1} & 0 \\end{pmatrix} = -J_{d}(x).\n$$\nSince $J_{d}(x)^{\\top} = -J_{d}(x)$, the matrix $J_{d}(x)$ is indeed skew-symmetric for any vector field $\\omega(x)$, including the specific smooth function provided in the problem statement. The explicit form of $\\omega(x)$ is therefore irrelevant for this part of the proof.\n\nNow, let us analyze the quadratic form $P_{g}(x)$. Let $v(x) = \\nabla H_{d}(x) = x$. The expression for the gyroscopic power is $P_{g}(x) = v(x)^{\\top} J_{d}(x) v(x)$. Since $P_{g}(x)$ is a scalar quantity, it must be equal to its own transpose:\n$$\nP_{g}(x) = \\left(v(x)^{\\top} J_{d}(x) v(x)\\right)^{\\top}.\n$$\nUsing the property of the transpose of a product of matrices, $(ABC)^{\\top} = C^{\\top}B^{\\top}A^{\\top}$, we have:\n$$\n\\left(v(x)^{\\top} J_{d}(x) v(x)\\right)^{\\top} = v(x)^{\\top} J_{d}(x)^{\\top} \\left(v(x)^{\\top}\\right)^{\\top} = v(x)^{\\top} J_{d}(x)^{\\top} v(x).\n$$\nWe have already established that $J_{d}(x)$ is skew-symmetric, so $J_{d}(x)^{\\top} = -J_{d}(x)$. Substituting this into the expression gives:\n$$\nP_{g}(x) = v(x)^{\\top} \\left(-J_{d}(x)\\right) v(x) = - \\left(v(x)^{\\top} J_{d}(x) v(x)\\right) = -P_{g}(x).\n$$\nThe resulting equation is $P_{g}(x) = -P_{g}(x)$, which implies $2 P_{g}(x) = 0$. The only real number satisfying this condition is $0$. Therefore,\n$$\nP_{g}(x) = \\left(\\nabla H_{d}(x)\\right)^{\\top} J_{d}(x) \\nabla H_{d}(x) = 0.\n$$\nThis rigorous proof, based on the fundamental property of skew-symmetric matrices, demonstrates that the gyroscopic forces do no work. Consequently, they do not contribute to any change in the system's energy $H_{d}$. The time derivative of the Hamiltonian simplifies to:\n$$\n\\frac{d}{dt} H_{d}(x) = - \\left(\\nabla H_{d}(x)\\right)^{\\top} R_{d}(x) \\nabla H_{d}(x).\n$$\nSince $R_{d}(x)$ is given as positive semidefinite, the quadratic form $\\left(\\nabla H_{d}(x)\\right)^{\\top} R_{d}(x) \\nabla H_{d}(x) \\ge 0$, which ensures that $\\frac{d}{dt} H_{d}(x) \\le 0$. The system is passive, and a non-zero gyroscopic term does not alter this property.\n\nThe final task is to compute the net power supplied by the gyroscopic forces, which is precisely the quantity $P_{g}(x)$ we have just analyzed. The calculation above is general and does not depend on the specific components of $x$ or $\\omega(x)$. The result is a constant function.\n\nThe power is $P_{g}(x) = x^{\\top} J_{d}(x) x$. Because $J_{d}(x)$ is skew-symmetric for any $x$, this quadratic form is identically zero.\n\nThus, the requested analytic expression is simply $0$.", "answer": "$$\\boxed{0}$$", "id": "2704637"}, {"introduction": "Beyond simple stabilization, a key strength of IDA-PBC is the ability to shape the qualitative behavior of a system near an equilibrium. This is achieved by carefully designing the interconnection and damping matrices to manage energy flow and dissipation. This practice [@problem_id:2704607] guides you through the process of designing a $J_d$ matrix to create prescribed oscillations and then adding a damping term $R_d$ to achieve asymptotic stability, illustrating the distinct yet cooperative roles of these fundamental components.", "problem": "Consider a fully actuated two-dimensional system for which Interconnection and Damping Assignment–Passivity Based Control (IDA-PBC) has been applied to impose a closed-loop port-Hamiltonian (pH) form. The closed-loop dynamics are\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\nwhere $x \\in \\mathbb{R}^{2}$, $J_{d}(x)$ is a skew-symmetric interconnection matrix, $R_{d}(x)$ is a positive semidefinite damping matrix, and $H_{d}(x)$ is the desired Hamiltonian. Suppose the desired equilibrium is at $x^{\\star}=\\mathbf{0}$ and the desired Hamiltonian is quadratic with Hessian\n$$\n\\nabla^{2} H_{d}(0) = K = \\mathrm{diag}(k_{1},k_{2}), \\quad k_{1}>0,\\;k_{2}>0.\n$$\nAssume $J_{d}(x)$ is chosen to be constant in a neighborhood of $x^{\\star}$ and initially set $R_{d}(x) \\equiv 0$. You are tasked with shaping the interconnection so that the linearization at $x^{\\star}$ is a center with a prescribed small-amplitude oscillation frequency $\\omega_{0}>0$.\n\n1. Using only fundamental properties of Hamiltonian vector fields and linearization, construct an explicit constant skew-symmetric $J_{d}$ that makes the linearization at $x^{\\star}$ a center with purely imaginary eigenvalues $\\pm \\mathrm{j}\\,\\omega_{0}$ when $R_{d}\\equiv 0$.\n\n2. Then, add isotropic damping $R_{d}(x)\\equiv r I_{2}$ with $r>0$ and, by computing the linearization, determine the eigenvalues of the damped closed-loop. Explain under what condition on $r$ the equilibrium transitions from a center to an asymptotically stable focus.\n\nProvide your final answer as the explicit analytic expression you constructed for $J_{d}$ in item 1. No numerical substitution is required, and no rounding is needed. Do not include units in your final answer.", "solution": "The problem presented is a standard exercise in control theory, specifically within the framework of Interconnection and Damping Assignment Passivity-Based Control (IDA-PBC) for port-Hamiltonian systems. It is scientifically grounded, well-posed, and contains all necessary information. Therefore, we proceed to the solution.\n\nThe closed-loop dynamics are given by the equation:\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x)\n$$\nThe desired equilibrium is at $x^{\\star}=\\mathbf{0}$. For an equilibrium to exist at this point, it is necessary that $\\dot{x}|_{x=\\mathbf{0}} = \\mathbf{0}$. Since $H_d(x)$ is minimized at the stable equilibrium $x^{\\star}$, we must have $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$. The Taylor expansion of $H_d(x)$ around $x^{\\star}=\\mathbf{0}$ is thus $H_d(x) = H_d(\\mathbf{0}) + \\frac{1}{2}x^T \\nabla^2 H_d(\\mathbf{0}) x + \\mathcal{O}(\\|x\\|^3)$. Setting the potential energy datum $H_d(\\mathbf{0})=0$ and using the given Hessian $\\nabla^2 H_d(\\mathbf{0}) = K$, we have $H_d(x) = \\frac{1}{2}x^T K x$ for small $x$. The gradient is then $\\nabla H_d(x) = Kx + \\mathcal{O}(\\|x\\|^2)$.\n\nThe problem is divided into two parts.\n\nPart 1: Construction of the interconnection matrix $J_d$.\n\nWe are tasked to find a constant skew-symmetric matrix $J_d$ such that the linearization of the undamped system ($R_d(x) \\equiv 0$) at the origin is a center with oscillation frequency $\\omega_0$. The undamped system is:\n$$\n\\dot{x} = J_d(x) \\nabla H_d(x)\n$$\nTo analyze the local behavior around the equilibrium $x^{\\star} = \\mathbf{0}$, we linearize the system. Let $f(x) = J_d(x) \\nabla H_d(x)$. The matrix of the linearized system $\\dot{\\delta x} = A \\delta x$ is the Jacobian of $f(x)$ evaluated at $x = \\mathbf{0}$:\n$$\nA = \\frac{\\partial f}{\\partial x}\\bigg|_{x=\\mathbf{0}} = \\left. \\frac{\\partial}{\\partial x} \\big(J_d(x) \\nabla H_d(x)\\big) \\right|_{x=\\mathbf{0}}\n$$\nGiven that $J_d(x)$ is chosen to be a constant matrix $J_d$, and $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$, the product rule for differentiation yields:\n$$\nA = \\left( \\frac{\\partial J_d(x)}{\\partial x} \\nabla H_d(x) \\right)\\bigg|_{x=\\mathbf{0}} + J_d(\\mathbf{0}) \\left( \\frac{\\partial \\nabla H_d(x)}{\\partial x} \\right)\\bigg|_{x=\\mathbf{0}} = \\mathbf{0} + J_d \\nabla^2 H_d(\\mathbf{0})\n$$\nWe are given $\\nabla^2 H_d(\\mathbf{0}) = K = \\mathrm{diag}(k_1, k_2)$. Therefore, the state matrix of the linearized system is:\n$$\nA = J_d K\n$$\nFor a two-dimensional system, a constant skew-symmetric matrix $J_d$ must be of the form:\n$$\nJ_d = \\begin{pmatrix} 0 & \\alpha \\\\ -\\alpha & 0 \\end{pmatrix}\n$$\nfor some real scalar $\\alpha$. The matrix $K$ is given as:\n$$\nK = \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix}\n$$\nwhere $k_1 > 0$ and $k_2 > 0$. The product $A = J_d K$ is:\n$$\nA = \\begin{pmatrix} 0 & \\alpha \\\\ -\\alpha & 0 \\end{pmatrix} \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0 & \\alpha k_2 \\\\ -\\alpha k_1 & 0 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $A$ are found from the characteristic equation $\\det(A - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\lambda & \\alpha k_2 \\\\ -\\alpha k_1 & -\\lambda \\end{pmatrix} = (-\\lambda)^2 - (\\alpha k_2)(-\\alpha k_1) = \\lambda^2 + \\alpha^2 k_1 k_2 = 0\n$$\nThis gives $\\lambda^2 = -\\alpha^2 k_1 k_2$, so the eigenvalues are $\\lambda = \\pm i |\\alpha| \\sqrt{k_1 k_2}$, where $i$ is the imaginary unit. The problem requires the linearization to be a center with eigenvalues $\\pm i \\omega_0$, where $\\omega_0 > 0$. Equating the two expressions for the eigenvalues, we get:\n$$\n|\\alpha| \\sqrt{k_1 k_2} = \\omega_0\n$$\nSince $k_1, k_2, \\omega_0$ are positive, we can solve for $|\\alpha|$:\n$$\n|\\alpha| = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}\n$$\nWe have two choices for $\\alpha$. We select the positive root without loss of generality, $\\alpha = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}$. The desired interconnection matrix $J_d$ is then uniquely specified as:\n$$\nJ_d = \\begin{pmatrix} 0 & \\frac{\\omega_0}{\\sqrt{k_1 k_2}} \\\\ -\\frac{\\omega_0}{\\sqrt{k_1 k_2}} & 0 \\end{pmatrix}\n$$\n\nPart 2: Analysis of the damped system.\n\nNow, isotropic damping $R_d(x) \\equiv r I_2$ is added, with $r > 0$. The dynamics become:\n$$\n\\dot{x} = (J_d - rI_2) \\nabla H_d(x)\n$$\nThe new linearized system matrix, $A_d$, is:\n$$\nA_d = (J_d - rI_2) K = \\left( \\begin{pmatrix} 0 & \\alpha \\\\ -\\alpha & 0 \\end{pmatrix} - \\begin{pmatrix} r & 0 \\\\ 0 & r \\end{pmatrix} \\right) \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix}\n$$\n$$\nA_d = \\begin{pmatrix} -r & \\alpha \\\\ -\\alpha & -r \\end{pmatrix} \\begin{pmatrix} k_1 & 0 \\\\ 0 & k_2 \\end{pmatrix} = \\begin{pmatrix} -r k_1 & \\alpha k_2 \\\\ -\\alpha k_1 & -r k_2 \\end{pmatrix}\n$$\nThe characteristic equation for the eigenvalues $\\lambda$ of $A_d$ is $\\det(A_d - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -r k_1 - \\lambda & \\alpha k_2 \\\\ -\\alpha k_1 & -r k_2 - \\lambda \\end{pmatrix} = (-r k_1 - \\lambda)(-r k_2 - \\lambda) + \\alpha^2 k_1 k_2 = 0\n$$\n$$\n\\lambda^2 + (r k_1 + r k_2)\\lambda + r^2 k_1 k_2 + \\alpha^2 k_1 k_2 = 0\n$$\nSubstituting $\\alpha^2 = \\frac{\\omega_0^2}{k_1 k_2}$ from Part 1:\n$$\n\\lambda^2 + r(k_1+k_2)\\lambda + (r^2 k_1 k_2 + \\omega_0^2) = 0\n$$\nThe eigenvalues are given by the quadratic formula:\n$$\n\\lambda_{1,2} = \\frac{-r(k_1+k_2) \\pm \\sqrt{ (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) }}{2}\n$$\nThe equilibrium is an asymptotically stable focus if the eigenvalues are a complex conjugate pair with a negative real part. The real part of the eigenvalues is $\\mathrm{Re}(\\lambda) = -\\frac{r(k_1+k_2)}{2}$. Since $r > 0$, $k_1 > 0$, and $k_2 > 0$, the real part is always negative, guaranteeing asymptotic stability.\nThe eigenvalues are complex if the discriminant of the quadratic equation is negative. Let $\\Delta$ be the discriminant:\n$$\n\\Delta = (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) = r^2(k_1^2 + 2k_1 k_2 + k_2^2) - 4r^2 k_1 k_2 - 4\\omega_0^2\n$$\n$$\n\\Delta = r^2(k_1^2 - 2k_1 k_2 + k_2^2) - 4\\omega_0^2 = r^2(k_1-k_2)^2 - 4\\omega_0^2\n$$\nFor a focus, we require $\\Delta < 0$:\n$$\nr^2(k_1-k_2)^2 - 4\\omega_0^2 < 0 \\implies r^2(k_1-k_2)^2 < 4\\omega_0^2\n$$\nTaking the square root of both sides gives:\n$$\nr |k_1 - k_2| < 2\\omega_0\n$$\nThis is the condition on $r$ for the equilibrium to be an asymptotically stable focus. If $k_1 \\neq k_2$, this is equivalent to $0 < r < \\frac{2\\omega_0}{|k_1-k_2|}$. If $k_1=k_2$, the condition becomes $0 < 2\\omega_0$, which is always true for $\\omega_0 > 0$, meaning the system is a focus for any $r>0$.\nThe problem requires providing the explicit expression for $J_d$ as the final answer.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}} \\\\ -\\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}} & 0 \\end{pmatrix}}\n$$", "id": "2704607"}, {"introduction": "When applying energy-shaping to underactuated systems, stability is often confined to an attractive invariant submanifold of the state space. This can lead to subtleties in applying Lyapunov's direct method, as an energy function that appears suitable may not be a valid Lyapunov function on the full space. This advanced problem [@problem_id:2704653] presents a crucial counterexample where a candidate Hamiltonian $H_d$ has an indefinite Hessian, teaching the important lesson of rigorously verifying the conditions for stability and understanding its local nature.", "problem": "Consider a two-degree-of-freedom underactuated mechanical system written in the port-Hamiltonian form\n$$\\dot{x}=\\big(J(x)-R(x)\\big)\\nabla H_{d}(x),$$\nwhere $x=\\big(q_{1},q_{2},p_{1},p_{2}\\big)^{\\top}\\in\\mathbb{R}^{4}$ is the state, $J(x)=-J(x)^{\\top}$ is the interconnection matrix, $R(x)=R(x)^{\\top}\\succeq 0$ is the damping matrix, and $H_{d}(x)$ is a shaped energy obtained by Interconnection and Damping Assignment–Passivity-Based Control (IDA-PBC).\n\nSuppose the designer proposes the shaped energy candidate\n$$H_{d}(x)=\\frac{k}{2}q_{1}^{2}+\\frac{a}{2}p_{1}^{2}+\\frac{b}{2}q_{2}^{2}-\\frac{c}{2}p_{2}^{2}+\\lambda\\,q_{1}p_{2},$$\nwith constants $a>0$, $b>0$, $c>0$, $k>0$, and $\\lambda\\in\\mathbb{R}$. Assume that the closed-loop interconnection and damping assignment is such that the submanifold\n$$\\mathcal{S}=\\{x\\in\\mathbb{R}^{4}:q_{2}=0,\\;p_{2}=0\\}$$\nis forward invariant and attractive for the unactuated coordinates. The target equilibrium is $x^{\\star}=\\mathbf{0}$.\n\nWorking from first principles of Lyapunov stability, justify why $H_{d}$ restricted to $\\mathcal{S}$ has a strict minimum at $x^{\\star}$ but $H_{d}$ is not a valid Lyapunov function on the full space because its Hessian at $x^{\\star}$ is indefinite. Then, for the specific parameter choice $a=3$, $b=1$, $c=1$, $k=2$, and $\\lambda=1$, compute the smallest eigenvalue of the Hessian matrix $\\nabla^{2}H_{d}(x^{\\star})$ exactly. Provide your final answer as a single exact expression with no units. Do not round.", "solution": "We begin with the Lyapunov framework and the port-Hamiltonian representation. The closed-loop dynamics are given by\n$$\\dot{x}=\\big(J(x)-R(x)\\big)\\nabla H_{d}(x),$$\nwhere $J(x)$ is skew-symmetric and $R(x)$ is symmetric positive semidefinite. A standard Lyapunov candidate in energy-shaping is the shaped energy $H_{d}(x)$ itself. For $H_{d}$ to be a valid Lyapunov function on the full state space, it must satisfy $H_{d}(x)\\geq H_{d}(x^{\\star})$ in a neighborhood of $x^{\\star}$ with equality if and only if $x=x^{\\star}$, and its derivative along solutions must be nonpositive. A necessary condition for $x^{\\star}$ to be a strict local minimum of a twice continuously differentiable function on the full space is that the Hessian at $x^{\\star}$ be positive semidefinite.\n\nHowever, IDA-PBC often yields stability on invariant manifolds that arise from interconnection and damping assignment. If the submanifold $\\mathcal{S}=\\{q_{2}=0,p_{2}=0\\}$ is forward invariant, the restriction of $H_{d}$ to $\\mathcal{S}$ can serve as a Lyapunov function for the reduced dynamics on $\\mathcal{S}$. On $\\mathcal{S}$, the shaped energy reduces to\n$$H_{d}\\big|_{\\mathcal{S}}(q_{1},p_{1})=\\frac{k}{2}q_{1}^{2}+\\frac{a}{2}p_{1}^{2},$$\nbecause the terms involving $q_{2}$ and $p_{2}$ vanish when $q_{2}=0$ and $p_{2}=0$, and the bilinear term $\\lambda q_{1}p_{2}$ also vanishes when $p_{2}=0$. Since $a>0$ and $k>0$, the function $H_{d}\\big|_{\\mathcal{S}}$ is strictly positive definite in $(q_{1},p_{1})$ and has a strict minimum at $x^{\\star}=\\mathbf{0}$ when restricted to $\\mathcal{S}$.\n\nWe now analyze the Hessian on the full space to show that $H_{d}$ is not a valid Lyapunov function globally because its Hessian at $x^{\\star}$ is indefinite for the given parameters. First compute the gradient:\n$$\\nabla H_{d}(x)=\\begin{bmatrix}\n\\frac{\\partial H_{d}}{\\partial q_{1}}\\\\[4pt]\n\\frac{\\partial H_{d}}{\\partial q_{2}}\\\\[4pt]\n\\frac{\\partial H_{d}}{\\partial p_{1}}\\\\[4pt]\n\\frac{\\partial H_{d}}{\\partial p_{2}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk\\,q_{1}+\\lambda\\,p_{2}\\\\[4pt]\nb\\,q_{2}\\\\[4pt]\na\\,p_{1}\\\\[4pt]\n-c\\,p_{2}+\\lambda\\,q_{1}\n\\end{bmatrix}.$$\nTaking partial derivatives again yields the Hessian, which is constant (independent of $x$) because $H_{d}$ is quadratic:\n$$\\nabla^{2}H_{d}=\\begin{bmatrix}\n\\frac{\\partial^{2}H_{d}}{\\partial q_{1}^{2}} & \\frac{\\partial^{2}H_{d}}{\\partial q_{1}\\partial q_{2}} & \\frac{\\partial^{2}H_{d}}{\\partial q_{1}\\partial p_{1}} & \\frac{\\partial^{2}H_{d}}{\\partial q_{1}\\partial p_{2}}\\\\[4pt]\n\\frac{\\partial^{2}H_{d}}{\\partial q_{2}\\partial q_{1}} & \\frac{\\partial^{2}H_{d}}{\\partial q_{2}^{2}} & \\frac{\\partial^{2}H_{d}}{\\partial q_{2}\\partial p_{1}} & \\frac{\\partial^{2}H_{d}}{\\partial q_{2}\\partial p_{2}}\\\\[4pt]\n\\frac{\\partial^{2}H_{d}}{\\partial p_{1}\\partial q_{1}} & \\frac{\\partial^{2}H_{d}}{\\partial p_{1}\\partial q_{2}} & \\frac{\\partial^{2}H_{d}}{\\partial p_{1}^{2}} & \\frac{\\partial^{2}H_{d}}{\\partial p_{1}\\partial p_{2}}\\\\[4pt]\n\\frac{\\partial^{2}H_{d}}{\\partial p_{2}\\partial q_{1}} & \\frac{\\partial^{2}H_{d}}{\\partial p_{2}\\partial q_{2}} & \\frac{\\partial^{2}H_{d}}{\\partial p_{2}\\partial p_{1}} & \\frac{\\partial^{2}H_{d}}{\\partial p_{2}^{2}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk & 0 & 0 & \\lambda\\\\[4pt]\n0 & b & 0 & 0\\\\[4pt]\n0 & 0 & a & 0\\\\[4pt]\n\\lambda & 0 & 0 & -c\n\\end{bmatrix}.$$\n\nSpecializing to the given parameters $a=3$, $b=1$, $c=1$, $k=2$, and $\\lambda=1$, we obtain\n$$\\nabla^{2}H_{d}=\n\\begin{bmatrix}\n2 & 0 & 0 & 1\\\\[4pt]\n0 & 1 & 0 & 0\\\\[4pt]\n0 & 0 & 3 & 0\\\\[4pt]\n1 & 0 & 0 & -1\n\\end{bmatrix}.$$\nThis matrix is block diagonal up to a $2\\times 2$ coupling between $q_{1}$ and $p_{2}$, with decoupled diagonal entries for $q_{2}$ and $p_{1}$. The eigenvalues are therefore the union of $\\{1\\}$ (from the $q_{2}$ row/column), $\\{3\\}$ (from the $p_{1}$ row/column), and the eigenvalues of the $2\\times 2$ block\n$$B=\\begin{bmatrix}2 & 1\\\\[4pt]1 & -1\\end{bmatrix}.$$\nThe characteristic polynomial of $B$ is\n$$\\chi_{B}(\\mu)=\\det\\big(B-\\mu I_{2}\\big)=(2-\\mu)(-1-\\mu)-1=\\mu^{2}-\\mu-3.$$\nThe roots are\n$$\\mu=\\frac{1\\pm\\sqrt{1+12}}{2}=\\frac{1\\pm\\sqrt{13}}{2}.$$\nHence the full Hessian has eigenvalues $\\left\\{1,\\,3,\\,\\frac{1+\\sqrt{13}}{2},\\,\\frac{1-\\sqrt{13}}{2}\\right\\}$, and the smallest eigenvalue is\n$$\\frac{1-\\sqrt{13}}{2},$$\nwhich is strictly negative. Therefore, the Hessian is indefinite, and $H_{d}$ cannot serve as a Lyapunov function on the full state space. Nevertheless, restricted to the invariant submanifold $\\mathcal{S}$, $H_{d}$ reduces to $\\frac{k}{2}q_{1}^{2}+\\frac{a}{2}p_{1}^{2}$ with $a>0$ and $k>0$, exhibiting a strict minimum at $x^{\\star}$. This provides the requested counterexample in the Interconnection and Damping Assignment–Passivity-Based Control setting: $H_{d}$ is minimized at the target on $\\mathcal{S}$ but fails the Lyapunov test on the full space due to the indefinite Hessian.\n\nThe requested calculation is the smallest eigenvalue of $\\nabla^{2}H_{d}(x^{\\star})$, which is $\\frac{1-\\sqrt{13}}{2}$.", "answer": "$$\\boxed{\\frac{1-\\sqrt{13}}{2}}$$", "id": "2704653"}]}