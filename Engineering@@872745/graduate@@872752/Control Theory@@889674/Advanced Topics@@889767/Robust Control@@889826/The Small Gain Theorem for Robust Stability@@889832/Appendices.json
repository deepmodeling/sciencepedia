{"hands_on_practices": [{"introduction": "To build a solid understanding of the Small Gain Theorem, we begin with a foundational exercise. This practice focuses on computing the $\\mathcal{H}_{\\infty}$ norm for a simple yet representative second-order system directly from its definition as the peak magnitude of the frequency response. By applying the small-gain condition, you will then determine the explicit range of a plant gain that guarantees robust stability, connecting a theoretical norm to a practical design parameter [@problem_id:2754153].", "problem": "Consider a stable Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) plant with transfer function $G(s)=\\dfrac{k}{(s+a)(s+b)}$, where $a0$, $b0$, and $k \\in \\mathbb{R}$. The plant is interconnected in a standard negative-feedback loop with a stable, causal uncertainty $\\Delta(s)$ satisfying the Hardy space infinity norm ($\\mathcal{H}_{\\infty}$) bound $\\|\\Delta\\|_{\\infty} \\leq 1$. The small gain theorem asserts that the closed loop is robustly stable if the loop gain satisfies $\\|G\\|_{\\infty} \\|\\Delta\\|_{\\infty}  1$. Using only the fundamental definition of the $\\mathcal{H}_{\\infty}$ norm as the least upper bound of the maximum singular value of the frequency response over all frequencies, compute $\\|G\\|_{\\infty}$ in closed form as a function of $a$, $b$, and $k$. Then determine the supremum value $k_{\\max}$ of the magnitude of $k$ such that for every $|k|k_{\\max}$, the small-gain robust stability condition is guaranteed for all $\\Delta$ with $\\|\\Delta\\|_{\\infty}\\leq 1$. Provide your final answer as a two-entry row matrix $\\big[\\,\\|G\\|_{\\infty},\\;k_{\\max}\\,\\big]$. No numerical rounding is required. Do not include units.", "solution": "The problem is subjected to validation and is deemed to be valid. It is a well-posed, scientifically grounded problem in the field of robust control theory. All necessary data and definitions are provided, and there are no contradictions or ambiguities. I will proceed with the solution.\n\nThe problem is divided into two parts. First, we must compute the $\\mathcal{H}_{\\infty}$ norm of the given plant transfer function $G(s)$. Second, we must use this result to find the supremum value of the gain magnitude, $k_{\\max}$, that guarantees robust stability via the small gain theorem.\n\n**Part 1: Computation of $\\|G\\|_{\\infty}$**\n\nThe plant is a Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) system with the transfer function:\n$$G(s) = \\frac{k}{(s+a)(s+b)}$$\nwhere $a  0$, $b  0$, and $k \\in \\mathbb{R}$. The conditions on $a$ and $b$ ensure that the poles of the system, at $s=-a$ and $s=-b$, are in the open left-half of the complex plane, confirming the stated stability of the plant.\n\nThe $\\mathcal{H}_{\\infty}$ norm of a stable SISO LTI system is defined as the supremum of the magnitude of its frequency response. For a transfer function $G(s)$, this is:\n$$ \\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |G(j\\omega)| $$\nWe obtain the frequency response function $G(j\\omega)$ by substituting $s=j\\omega$ into $G(s)$:\n$$G(j\\omega) = \\frac{k}{(j\\omega+a)(j\\omega+b)}$$\nThe magnitude of the frequency response is:\n$$|G(j\\omega)| = \\frac{|k|}{|j\\omega+a| |j\\omega+b|}$$\nThe magnitudes of the complex numbers in the denominator are $|j\\omega+a| = \\sqrt{a^2+\\omega^2}$ and $|j\\omega+b| = \\sqrt{b^2+\\omega^2}$. Therefore:\n$$|G(j\\omega)| = \\frac{|k|}{\\sqrt{(a^2+\\omega^2)(b^2+\\omega^2)}}$$\nTo find the supremum of $|G(j\\omega)|$, we must find the minimum of the denominator term, $\\sqrt{(a^2+\\omega^2)(b^2+\\omega^2)}$, with respect to the frequency $\\omega$. Maximizing a positive function is equivalent to maximizing its square, which is often simpler. Let us define a function $M(\\omega)$ as the square of the magnitude:\n$$M(\\omega) = |G(j\\omega)|^2 = \\frac{k^2}{(a^2+\\omega^2)(b^2+\\omega^2)}$$\nMaximizing $M(\\omega)$ is equivalent to minimizing its denominator, which we denote as $D(\\omega)$:\n$$D(\\omega) = (a^2+\\omega^2)(b^2+\\omega^2) = \\omega^4 + (a^2+b^2)\\omega^2 + a^2b^2$$\nTo find the minimum of $D(\\omega)$ for $\\omega \\in \\mathbb{R}$, we compute its derivative with respect to $\\omega$ and set it to zero.\n$$\\frac{dD}{d\\omega} = 4\\omega^3 + 2(a^2+b^2)\\omega = 2\\omega(2\\omega^2 + a^2+b^2)$$\nWe set the derivative to zero to find the critical points:\n$$2\\omega(2\\omega^2 + a^2+b^2) = 0$$\nSince $a  0$ and $b  0$, it follows that $a^2  0$ and $b^2  0$. For any real $\\omega$, $\\omega^2 \\ge 0$. Thus, the term $(2\\omega^2 + a^2+b^2)$ is strictly positive. The only real solution to the equation is therefore $\\omega = 0$.\n\nTo confirm that this critical point corresponds to a minimum of $D(\\omega)$, we examine the second derivative:\n$$\\frac{d^2D}{d\\omega^2} = 12\\omega^2 + 2(a^2+b^2)$$\nAt $\\omega=0$, the second derivative is $\\left.\\frac{d^2D}{d\\omega^2}\\right|_{\\omega=0} = 2(a^2+b^2)$. Since $a^2  0$ and $b^2  0$, this value is strictly positive, confirming that $D(\\omega)$ has a local minimum at $\\omega=0$. As this is the only critical point for $\\omega \\ge 0$ and $D(\\omega) \\to \\infty$ as $\\omega \\to \\infty$, this is the global minimum.\n\nTherefore, the maximum of $|G(j\\omega)|$ occurs at $\\omega=0$. We evaluate $|G(j\\omega)|$ at this frequency:\n$$ \\|G\\|_{\\infty} = |G(j0)| = \\frac{|k|}{\\sqrt{(a^2+0)(b^2+0)}} = \\frac{|k|}{\\sqrt{a^2b^2}} $$\nSince $a  0$ and $b  0$, we have $ab  0$, and thus $\\sqrt{a^2b^2} = ab$. The $\\mathcal{H}_{\\infty}$ norm of the plant is:\n$$ \\|G\\|_{\\infty} = \\frac{|k|}{ab} $$\n\n**Part 2: Determination of $k_{\\max}$**\n\nThe small gain theorem states that the negative feedback interconnection of $G(s)$ and $\\Delta(s)$ is robustly stable if the loop gain is less than unity:\n$$ \\|G\\|_{\\infty} \\|\\Delta\\|_{\\infty}  1 $$\nWe are given that the stable, causal uncertainty $\\Delta(s)$ satisfies the bound $\\|\\Delta\\|_{\\infty} \\le 1$. To guarantee stability for all possible uncertainties satisfying this bound, we must satisfy the condition for the worst-case uncertainty, which is one where $\\|\\Delta\\|_{\\infty}$ is maximal, i.e., $\\|\\Delta\\|_{\\infty} = 1$. The condition for robust stability thus becomes:\n$$ \\|G\\|_{\\infty} \\cdot 1  1 \\implies \\|G\\|_{\\infty}  1 $$\nSubstituting the expression for $\\|G\\|_{\\infty}$ derived in Part 1:\n$$ \\frac{|k|}{ab}  1 $$\nSolving for $|k|$, we obtain:\n$$ |k|  ab $$\nThe problem asks for the supremum value $k_{\\max}$ of a positive number such that for every $|k|  k_{\\max}$, the robust stability condition $|k|  ab$ is guaranteed. This implies that the interval $(-k_{\\max}, k_{\\max})$ must be a subset of the interval $(-ab, ab)$. The largest such $k_{\\max}$ is therefore $ab$.\nIn other words, the set of values of $|k|$ for which the system is robustly stable is $[0, ab)$. The supremum (least upper bound) of this set is $ab$.\n$$k_{\\max} = ab$$\n\nThe final answer is to be provided as a two-entry row matrix containing $\\|G\\|_{\\infty}$ and $k_{\\max}$.\n\nFirst entry: $\\|G\\|_{\\infty} = \\frac{|k|}{ab}$\nSecond entry: $k_{\\max} = ab$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{|k|}{ab}  ab\n\\end{pmatrix}\n}\n$$", "id": "2754153"}, {"introduction": "While powerful, the Small Gain Theorem provides a *sufficient* condition for stability, which can sometimes be conservative. This exercise is designed to make this abstract concept concrete by comparing the stability bound derived from the theorem against the exact stability margin for an uncertainty with known structure—in this case, a real, static gain. By quantifying this \"conservatism gap,\" you will gain a crucial appreciation for the trade-offs between the generality of the small-gain condition and the precision of more specialized analysis methods [@problem_id:2754190].", "problem": "Consider the Single-Input Single-Output (SISO) stable plant\n$$\nG(s) \\;=\\; \\frac{1}{s^{2} + 0.4\\,s + 1}.\n$$\nForm the standard positive-feedback interconnection with an uncertain, real, static gain block $\\Delta = k$ in feedback so that the closed-loop characteristic equation is\n$$\n1 - k\\,G(s) \\;=\\; 0,\n$$\nand suppose the uncertainty satisfies $|k| \\le \\gamma$. You will compare the Small-Gain Theorem sufficient bound to the exact Nyquist-based robust stability bound and quantify the conservatism gap.\n\nTasks:\n1) Using the definition of the $\\mathcal{H}_{\\infty}$ (H-infinity) norm,\n$$\n\\|G\\|_{\\infty} \\;=\\; \\sup_{\\omega \\in \\mathbb{R}} |G(\\mathrm{j}\\,\\omega)|,\n$$\ncompute $\\|G\\|_{\\infty}$.\n\n2) Using the Small-Gain Theorem, determine the sufficient bound $\\gamma_{\\mathrm{SG}}$ such that the interconnection is internally stable for all $|k| \\le \\gamma_{\\mathrm{SG}}$.\n\n3) Using exact Nyquist-based reasoning (you may equivalently use the Routh–Hurwitz stability test), determine the largest real number $\\gamma_{\\mathrm{exact}}$ such that the closed loop is internally stable for all real $k$ with $|k| \\le \\gamma_{\\mathrm{exact}}$.\n\n4) Quantify the conservatism gap as the factor\n$$\nr \\;=\\; \\frac{\\gamma_{\\mathrm{exact}}}{\\gamma_{\\mathrm{SG}}}.\n$$\nReport the single number $r$, rounded to four significant figures. No units are required.", "solution": "We begin from the foundational definitions. The $\\mathcal{H}_{\\infty}$ norm is defined by $\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |G(\\mathrm{j}\\,\\omega)|$. The Small-Gain Theorem states that the positive-feedback interconnection of a stable linear time-invariant $G$ and a bounded operator $\\Delta$ is internally stable if $\\|G\\|_{\\infty}\\,\\|\\Delta\\|_{\\infty}  1$. For a real static gain $\\Delta = k$ with $|k| \\le \\gamma$, this yields the sufficient bound $\\gamma_{\\mathrm{SG}} = 1/\\|G\\|_{\\infty}$. To obtain the exact largest allowable $\\gamma$ for real $k$, we can use the Nyquist criterion specialized to real scalar feedback, or equivalently analyze the closed-loop characteristic polynomial via the Routh–Hurwitz test.\n\nStep 1: Compute $\\|G\\|_{\\infty}$.\n\nFor\n$$\nG(s) \\;=\\; \\frac{1}{s^{2} + 0.4\\,s + 1},\n$$\nthe frequency response at $s = \\mathrm{j}\\,\\omega$ is\n$$\nG(\\mathrm{j}\\,\\omega) \\;=\\; \\frac{1}{-\\omega^{2} + 1 + \\mathrm{j}\\,(0.4)\\,\\omega}.\n$$\nHence the squared magnitude is\n$$\n|G(\\mathrm{j}\\,\\omega)|^{2} \\;=\\; \\frac{1}{\\left(1 - \\omega^{2}\\right)^{2} + \\left(0.4\\,\\omega\\right)^{2}} \\;=\\; \\frac{1}{\\left(1 - \\omega^{2}\\right)^{2} + 0.16\\,\\omega^{2}}.\n$$\nTo find the supremum of $|G(\\mathrm{j}\\,\\omega)|$, it suffices to minimize the denominator\n$$\nD(\\omega) \\;=\\; \\left(1 - \\omega^{2}\\right)^{2} + 0.16\\,\\omega^{2}.\n$$\nLet $u = \\omega^{2} \\ge 0$. Then\n$$\nD(u) \\;=\\; (1 - u)^{2} + 0.16\\,u \\;=\\; u^{2} + u\\,(0.16 - 2) + 1 \\;=\\; u^{2} - 1.84\\,u + 1.\n$$\nDifferentiate with respect to $u$ and set to zero:\n$$\n\\frac{\\mathrm{d}D}{\\mathrm{d}u} \\;=\\; 2u - 1.84 \\;=\\; 0 \\;\\;\\Rightarrow\\;\\; u^{\\star} \\;=\\; 0.92.\n$$\nSince $u^{\\star} \\ge 0$ and $D(u)$ is convex in $u$, this is the global minimizer. Evaluate $D$ at $u^{\\star}$:\n$$\nD(u^{\\star}) \\;=\\; (1 - 0.92)^{2} + 0.16\\cdot 0.92 \\;=\\; (0.08)^{2} + 0.1472 \\;=\\; 0.0064 + 0.1472 \\;=\\; 0.1536.\n$$\nTherefore\n$$\n\\|G\\|_{\\infty} \\;=\\; \\sup_{\\omega} |G(\\mathrm{j}\\,\\omega)| \\;=\\; \\frac{1}{\\sqrt{D(u^{\\star})}} \\;=\\; \\frac{1}{\\sqrt{0.1536}}.\n$$\nCompute the square root: $\\sqrt{0.1536} = 0.4\\sqrt{0.96} \\approx 0.3919183588453085,$ so\n$$\n\\|G\\|_{\\infty} \\;=\\; \\frac{1}{0.4\\,\\sqrt{0.96}} \\;\\approx\\; 2.5515518526.\n$$\nFor completeness, observe that this aligns with the well-known peak gain of an underdamped second-order system with damping ratio $\\zeta = 0.2$, namely\n$$\n\\|G\\|_{\\infty} \\;=\\; \\frac{1}{2\\,\\zeta\\,\\sqrt{1 - \\zeta^{2}}} \\;=\\; \\frac{1}{0.4\\,\\sqrt{0.96}}.\n$$\n\nStep 2: Small-Gain sufficient bound.\n\nBy the Small-Gain Theorem, robust internal stability is guaranteed for all $|k| \\le \\gamma_{\\mathrm{SG}}$ provided that\n$$\n\\|G\\|_{\\infty}\\,\\gamma_{\\mathrm{SG}} \\;\\; 1.\n$$\nThus the sharp sufficient bound is\n$$\n\\gamma_{\\mathrm{SG}} \\;=\\; \\frac{1}{\\|G\\|_{\\infty}} \\;=\\; 0.4\\,\\sqrt{0.96} \\;\\approx\\; 0.3919183588.\n$$\n\nStep 3: Exact Nyquist-based bound for real $k$.\n\nThe positive-feedback interconnection has characteristic equation\n$$\n1 - k\\,G(s) \\;=\\; 0 \\;\\;\\Longleftrightarrow\\;\\; s^{2} + 0.4\\,s + 1 - k \\;=\\; 0.\n$$\nBy the Routh–Hurwitz stability test for a second-order polynomial $s^{2} + a_{1}\\,s + a_{0}$, internal stability requires $a_{1}  0$ and $a_{0}  0$. Here $a_{1} = 0.4  0$ and $a_{0} = 1 - k$. Therefore stability holds if and only if\n$$\n1 - k \\;\\; 0 \\;\\;\\Longleftrightarrow\\;\\; k \\;\\; 1.\n$$\nFor negative $k$, the constant term becomes $1 - k  1$, which cannot violate the Routh–Hurwitz conditions. Hence the largest symmetric interval in $k$ about the origin contained in the stability region is $|k| \\le 1$, and the exact robustness radius is\n$$\n\\gamma_{\\mathrm{exact}} \\;=\\; 1.\n$$\nThis exact result is consistent with the Nyquist viewpoint: the Nyquist of $G$ crosses the positive real axis at $\\omega = 0$ with value $G(0) = 1$, and there is no finite-frequency crossing of the negative real axis; thus the first loss of stability in positive feedback occurs at $k = 1$.\n\nStep 4: Conservatism factor.\n\nThe requested ratio is\n$$\nr \\;=\\; \\frac{\\gamma_{\\mathrm{exact}}}{\\gamma_{\\mathrm{SG}}} \\;=\\; \\gamma_{\\mathrm{exact}}\\,\\|G\\|_{\\infty} \\;=\\; 1 \\cdot \\frac{1}{0.4\\,\\sqrt{0.96}} \\;\\approx\\; 2.5515518526.\n$$\nRounded to four significant figures,\n$$\nr \\;\\approx\\; 2.552.\n$$\nThis quantifies the conservatism: the Small-Gain Theorem bound on $|k|$ is smaller than the exact Nyquist-based bound by a factor of approximately $2.552$ for this example.", "answer": "$$\\boxed{2.552}$$", "id": "2754190"}, {"introduction": "To address the conservatism highlighted in the previous exercise, robust control theory offers a more refined tool: the structured singular value, or $\\mu$. This practice transitions from analytical calculation to computational analysis, guiding you to implement a frequency-by-frequency comparison between the unstructured small-gain margin (based on the maximum singular value, $\\overline{\\sigma}$) and the structured margin (based on the spectral radius, $\\rho$). This hands-on coding exercise demonstrates how leveraging knowledge of the uncertainty structure through $\\mu$-analysis yields a more accurate and less conservative assessment of robust stability [@problem_id:2754167].", "problem": "You are given a Linear Time-Invariant (LTI) complex-valued transfer matrix function $M(s)$ and a structured uncertainty $\\Delta$ modeled as a single repeated complex scalar full block of size $n$, that is $\\Delta = \\delta I_n$ with $\\delta \\in \\mathbb{C}$ and $I_n$ the identity matrix of size $n \\times n$. The structured singular value (also called $\\mu$) associated with this structure is defined, for each fixed frequency $\\omega \\in \\mathbb{R}_{\\ge 0}$, by the standard definition\n$$\n\\mu_{\\Delta}\\big(M(j\\omega)\\big) \\triangleq \\left( \\inf \\left\\{ \\|\\Delta\\| : \\det\\big(I - M(j\\omega)\\Delta\\big) = 0 \\right\\} \\right)^{-1}.\n$$\nFor the specified structure $\\Delta = \\delta I_n$, the robust stability margin induced by $\\mu$ is\n$$\n\\gamma_{\\mu} \\triangleq \\left( \\sup_{\\omega \\in [0,\\infty)} \\mu_{\\Delta}\\big(M(j\\omega)\\big) \\right)^{-1}.\n$$\nThe unstructured small-gain margin is\n$$\n\\gamma_{\\mathrm{sg}} \\triangleq \\left\\| M \\right\\|_{\\infty}^{-1} = \\left( \\sup_{\\omega \\in [0,\\infty)} \\overline{\\sigma}\\big(M(j\\omega)\\big) \\right)^{-1},\n$$\nwhere $\\overline{\\sigma}(\\cdot)$ denotes the maximum singular value. Your task is to set up the frequency-by-frequency computation of $\\mu_{\\Delta}\\big(M(j\\omega)\\big)$ specialized to the given block structure, compute $\\gamma_{\\mu}$, and compare it against $\\gamma_{\\mathrm{sg}}$.\n\nFundamental base you may assume: the definition of the structured singular value $\\mu$, properties of eigenvalues and singular values of complex matrices, and the frequency response evaluation of rational transfer functions $G(s) = N(s)/D(s)$ by substitution $s = j\\omega$, where $j^2 = -1$. Do not use any pre-packaged $\\mu$-analysis routines.\n\nUse the following frequency grid for all computations: $\\omega$ logarithmically spaced over $\\omega \\in [10^{-2}, 10^{3}]$ in $\\mathrm{rad/s}$, with exactly $1000$ points. For each test case, compute\n- $\\gamma_{\\mu} = \\left( \\sup_{\\omega} \\rho\\big(M(j\\omega)\\big) \\right)^{-1}$, where $\\rho(\\cdot)$ denotes the spectral radius (maximum modulus of eigenvalues),\n- $\\gamma_{\\mathrm{sg}} = \\left( \\sup_{\\omega} \\overline{\\sigma}\\big(M(j\\omega)\\big) \\right)^{-1}$.\n\nIf the supremum in the denominator is $0$ for a given case, return $+\\infty$ for the corresponding margin.\n\nImplement a program that evaluates $M(j\\omega)$ entrywise by rational function evaluation using the provided numerator and denominator coefficient arrays for each transfer function entry, where each entry has the form $G_{ij}(s) = \\dfrac{N_{ij}(s)}{D_{ij}(s)}$ with real-coefficient polynomials $N_{ij}(s)$ and $D_{ij}(s)$. Coefficient arrays are ordered from highest to lowest degree. All answers must be expressed as dimensionless quantities (no physical units appear in the output). Angles are in $\\mathrm{rad/s}$.\n\nTest Suite:\nFor each case below, $M(s)$ is $2 \\times 2$ and the uncertainty structure is a single repeated scalar full block $\\Delta = \\delta I_2$.\n\n- Case A (coupled, non-normal):\n  - $M_{11}(s) = \\dfrac{1.2}{s + 1}$, numerator $[\\,1.2\\,]$, denominator $[\\,1,\\,1\\,]$.\n  - $M_{12}(s) = \\dfrac{0.4}{s + 0.5}$, numerator $[\\,0.4\\,]$, denominator $[\\,1,\\,0.5\\,]$.\n  - $M_{21}(s) = \\dfrac{-0.6}{s + 2}$, numerator $[\\,{-0.6}\\,]$, denominator $[\\,1,\\,2\\,]$.\n  - $M_{22}(s) = \\dfrac{0.9 s + 0.3}{(s + 1.5)(s + 3)}$, numerator $[\\,0.9,\\,0.3\\,]$, denominator $[\\,1,\\,4.5,\\,4.5\\,]$.\n\n- Case B (diagonal, normal):\n  - $M_{11}(s) = \\dfrac{0.7}{s + 0.7}$, numerator $[\\,0.7\\,]$, denominator $[\\,1,\\,0.7\\,]$.\n  - $M_{12}(s) = 0$, numerator $[\\,0\\,]$, denominator $[\\,1\\,]$.\n  - $M_{21}(s) = 0$, numerator $[\\,0\\,]$, denominator $[\\,1\\,]$.\n  - $M_{22}(s) = \\dfrac{0.5}{s + 2.0}$, numerator $[\\,0.5\\,]$, denominator $[\\,1,\\,2.0\\,]$.\n\n- Case C (weakly coupled):\n  - $M_{11}(s) = \\dfrac{0.2}{s + 0.2}$, numerator $[\\,0.2\\,]$, denominator $[\\,1,\\,0.2\\,]$.\n  - $M_{12}(s) = \\dfrac{0.05}{s + 5}$, numerator $[\\,0.05\\,]$, denominator $[\\,1,\\,5\\,]$.\n  - $M_{21}(s) = \\dfrac{0.1}{s + 5}$, numerator $[\\,0.1\\,]$, denominator $[\\,1,\\,5\\,]$.\n  - $M_{22}(s) = \\dfrac{0.3}{s + 0.3}$, numerator $[\\,0.3\\,]$, denominator $[\\,1,\\,0.3\\,]$.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list of results for the three cases, where each case is represented by a two-element list $[\\,\\gamma_{\\mu},\\,\\gamma_{\\mathrm{sg}}\\,]$, with each floating-point number rounded to six digits after the decimal point. The overall output must be a single list of the three case-results, for example, $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$, printed exactly on one line with no extra text.", "solution": "The problem statement presented is subjected to validation and is found to be scientifically grounded, well-posed, and self-contained. It describes a standard problem in robust control theory concerning the analysis of stability for a system with structured uncertainty. The definitions of the structured singular value $\\mu$, the structured stability margin $\\gamma_{\\mu}$, and the unstructured small-gain margin $\\gamma_{\\mathrm{sg}}$ are correct. The provided test cases are specified with sufficient detail to permit a unique computational solution. Thus, we proceed with the analysis.\n\nThe central task is to compare the stability margins derived from structured and unstructured uncertainty analyses. The unstructured margin, $\\gamma_{\\mathrm{sg}}$, is based on the small-gain theorem, which considers any stable perturbation $\\Delta$ with a bounded norm. The structured margin, $\\gamma_{\\mu}$, leverages knowledge of the specific structure of the uncertainty, in this case, a repeated complex scalar block $\\Delta = \\delta I_n$ with $\\delta \\in \\mathbb{C}$.\n\nFirst, we must formalize the computation of $\\mu_{\\Delta}(M(j\\omega))$ for the specified structure. By definition,\n$$\n\\mu_{\\Delta}(M) \\triangleq \\left( \\inf \\left\\{ \\|\\Delta\\| : \\det(I - M\\Delta) = 0 \\text{ for some } \\Delta \\text{ with the given structure} \\right\\} \\right)^{-1}.\n$$\nIf no such $\\Delta$ exists, the infimum is $\\infty$ and $\\mu_{\\Delta}(M) = 0$. For the structure $\\Delta = \\delta I_n$, the condition for instability becomes $\\det(I - M(\\delta I_n)) = \\det(I - \\delta M) = 0$. This equation holds if and only if $1$ is an eigenvalue of the matrix $\\delta M$, which is equivalent to stating that $\\frac{1}{\\delta}$ is a non-zero eigenvalue of $M$. Let the set of eigenvalues of $M$ be $\\{\\lambda_i(M)\\}$. Then, we must have $\\frac{1}{\\delta} = \\lambda_i(M)$ for some $i$. This implies $\\delta = \\frac{1}{\\lambda_i(M)}$ for any non-zero eigenvalue $\\lambda_i(M)$. The norm of the perturbation is $\\|\\Delta\\| = \\|\\delta I_n\\|_2 = |\\delta|$. To find the smallest destabilizing perturbation, we seek the infimum of $|\\delta|$:\n$$\n\\inf \\{|\\delta|\\} = \\inf_{i} \\left\\{ \\left| \\frac{1}{\\lambda_i(M)} \\right| \\text{ where } \\lambda_i(M) \\neq 0 \\right\\} = \\frac{1}{\\max_{i} |\\lambda_i(M)|}.\n$$\nThe quantity $\\max_i |\\lambda_i(M)|$ is, by definition, the spectral radius of the matrix $M$, denoted $\\rho(M)$. Therefore, the infimum of the perturbation norm is $(\\rho(M))^{-1}$. Substituting this into the definition of $\\mu$:\n$$\n\\mu_{\\Delta}(M) = \\left( (\\rho(M))^{-1} \\right)^{-1} = \\rho(M).\n$$\nThis fundamental result confirms that for a repeated scalar block uncertainty structure, the structured singular value is precisely the spectral radius of the matrix. The problem's instruction to compute $\\gamma_{\\mu} = \\left( \\sup_{\\omega} \\rho(M(j\\omega)) \\right)^{-1}$ is therefore correct.\n\nThe computational procedure is as follows:\n1.  Establish a frequency grid of $N=1000$ points, $\\omega_k$, logarithmically spaced on the interval $[10^{-2}, 10^{3}]\\,\\mathrm{rad/s}$.\n2.  For each test case, and for each frequency $\\omega_k$ in the grid:\n    a. Evaluate each element $M_{ij}(s)$ of the transfer matrix at $s = j\\omega_k$ to construct the complex matrix $M(j\\omega_k)$. The evaluation of a rational function $G(s) = N(s)/D(s)$ with polynomial coefficients given in descending order of powers of $s$ is performed by computing the ratio of the polynomial values $N(j\\omega_k)/D(j\\omega_k)$.\n    b. Compute the eigenvalues $\\lambda_i(M(j\\omega_k))$ of the resulting complex matrix $M(j\\omega_k)$.\n    c. The spectral radius is then $\\rho(M(j\\omega_k)) = \\max_i |\\lambda_i(M(j\\omega_k))|$.\n    d. Compute the singular values of $M(j\\omega_k)$. The maximum singular value is $\\overline{\\sigma}(M(j\\omega_k)) = \\|M(j\\omega_k)\\|_2$.\n3.  Determine the supremum of the spectral radius and maximum singular value over the frequency grid:\n    $$\n    \\rho_{\\text{sup}} = \\sup_{\\omega \\in [10^{-2}, 10^3]} \\rho(M(j\\omega)) \\approx \\max_{k \\in \\{1, \\dots, N\\}} \\rho(M(j\\omega_k))\n    $$\n    $$\n    \\overline{\\sigma}_{\\text{sup}} = \\sup_{\\omega \\in [10^{-2}, 10^3]} \\overline{\\sigma}(M(j\\omega)) \\approx \\max_{k \\in \\{1, \\dots, N\\}} \\overline{\\sigma}(M(j\\omega_k))\n    $$\n4.  Calculate the stability margins by taking the reciprocal of these suprema. If a supremum is zero, the corresponding margin is infinite.\n    $$\n    \\gamma_{\\mu} = (\\rho_{\\text{sup}})^{-1}\n    $$\n    $$\n    \\gamma_{\\mathrm{sg}} = (\\overline{\\sigma}_{\\text{sup}})^{-1}\n    $$\nIt is a known property of matrix norms that for any matrix $M$, its spectral radius is bounded by its induced $2$-norm (maximum singular value): $\\rho(M) \\le \\overline{\\sigma}(M)$. This implies that $\\rho_{\\text{sup}} \\le \\overline{\\sigma}_{\\text{sup}}$, and consequently, $\\gamma_{\\mu} \\ge \\gamma_{\\mathrm{sg}}$. This inequality shows that the structured analysis provides a stability margin that is generally less conservative (i.e., larger or equal) than the unstructured small-gain analysis. Equality $\\rho(M) = \\overline{\\sigma}(M)$ holds if and only if $M$ is a normal matrix (i.e., $M^*M = MM^*$). We expect to observe this relationship in the results of the test cases. Specifically, for the diagonal matrix in Case B, which is normal, we expect $\\gamma_{\\mu} = \\gamma_{\\mathrm{sg}}$. For the non-normal matrices in Cases A and C, we expect $\\gamma_{\\mu}  \\gamma_{\\mathrm{sg}}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the robust stability margin problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: coupled, non-normal\n        {\n            \"M11\": ([1.2], [1.0, 1.0]),\n            \"M12\": ([0.4], [1.0, 0.5]),\n            \"M21\": ([-0.6], [1.0, 2.0]),\n            \"M22\": ([0.9, 0.3], [1.0, 4.5, 4.5]),\n        },\n        # Case B: diagonal, normal\n        {\n            \"M11\": ([0.7], [1.0, 0.7]),\n            \"M12\": ([0.0], [1.0]),\n            \"M21\": ([0.0], [1.0]),\n            \"M22\": ([0.5], [1.0, 2.0]),\n        },\n        # Case C: weakly coupled\n        {\n            \"M11\": ([0.2], [1.0, 0.2]),\n            \"M12\": ([0.05], [1.0, 5.0]),\n            \"M21\": ([0.1], [1.0, 5.0]),\n            \"M22\": ([0.3], [1.0, 0.3]),\n        }\n    ]\n\n    # Frequency grid setup\n    omega_grid = np.logspace(-2, 3, 1000)\n    s_grid = 1j * omega_grid\n\n    results = []\n    \n    for case in test_cases:\n        # Extract numerator and denominator coefficients for each entry\n        M11_coeffs = case[\"M11\"]\n        M12_coeffs = case[\"M12\"]\n        M21_coeffs = case[\"M21\"]\n        M22_coeffs = case[\"M22\"]\n\n        # Evaluate transfer functions over the frequency grid\n        M11_freq = np.polyval(M11_coeffs[0], s_grid) / np.polyval(M11_coeffs[1], s_grid)\n        M12_freq = np.polyval(M12_coeffs[0], s_grid) / np.polyval(M12_coeffs[1], s_grid)\n        M21_freq = np.polyval(M21_coeffs[0], s_grid) / np.polyval(M21_coeffs[1], s_grid)\n        M22_freq = np.polyval(M22_coeffs[0], s_grid) / np.polyval(M22_coeffs[1], s_grid)\n        \n        rhos = []\n        sigmas = []\n\n        # Iterate through each frequency point to compute spectral radius and max singular value\n        for i in range(len(omega_grid)):\n            M_jw = np.array([\n                [M11_freq[i], M12_freq[i]],\n                [M21_freq[i], M22_freq[i]]\n            ])\n            \n            # Compute spectral radius (rho)\n            eigvals = np.linalg.eigvals(M_jw)\n            rho = np.max(np.abs(eigvals))\n            rhos.append(rho)\n            \n            # Compute maximum singular value (sigma_bar)\n            sigma_max = np.linalg.norm(M_jw, ord=2)\n            sigmas.append(sigma_max)\n\n        # Compute suprema over the frequency grid\n        sup_rho = np.max(rhos)\n        sup_sigma = np.max(sigmas)\n        \n        # Calculate margins, handling the case of a zero supremum\n        gamma_mu = np.inf if sup_rho == 0 else 1.0 / sup_rho\n        gamma_sg = np.inf if sup_sigma == 0 else 1.0 / sup_sigma\n        \n        results.append([gamma_mu, gamma_sg])\n\n    # Format the final output string as specified\n    result_strings = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2754167"}]}