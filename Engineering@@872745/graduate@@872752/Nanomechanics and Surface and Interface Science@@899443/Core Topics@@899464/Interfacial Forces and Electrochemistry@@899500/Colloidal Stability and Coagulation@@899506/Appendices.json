{"hands_on_practices": [{"introduction": "The stability of charged colloids is fundamentally governed by electrostatic repulsion, which counteracts attractive van der Waals forces. This repulsion, however, is moderated by ions in the surrounding electrolyte that form a screening cloud. This exercise [@problem_id:2766661] delves into the heart of this phenomenon by tasking you with calculating the inverse Debye length, $\\kappa$, which quantifies the screening effectiveness. By working through a scenario with a mixed electrolyte, you will gain a deeper appreciation for how different ions, especially those with higher valence, contribute disproportionately to screening, a key concept in understanding electrostatic interactions in colloidal systems.", "problem": "A charged colloidal silica dispersion in water at temperature $T = 298.15\\,\\mathrm{K}$ is prepared in a mixed electrolyte composed of sodium chloride $\\mathrm{NaCl}$ and calcium chloride $\\mathrm{CaCl}_{2}$. Assume complete dissociation and thermodynamic conditions under which the linear response of the diffuse layer is valid. The total analytical salt molarity (sum of the salt molarities of $\\mathrm{NaCl}$ and $\\mathrm{CaCl}_{2}$) is fixed at $M_{0} = 5.0\\,\\mathrm{mM}$. The partial molarity of $\\mathrm{NaCl}$ is $x = 2.0\\,\\mathrm{mM}$, so the partial molarity of $\\mathrm{CaCl}_{2}$ is $M_{0} - x = 3.0\\,\\mathrm{mM}$. The solvent relative permittivity is $\\varepsilon_{r} = 78.5$. Use the fundamental constants: elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, Avogadro’s number $N_{A} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}$, and vacuum permittivity $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$. Use the conversion $1\\,\\mathrm{L} = 10^{-3}\\,\\mathrm{m^{3}}$.\n\nStarting from electrostatics and ideal ionic number distributions at thermal equilibrium, derive an analytical expression for the Debye screening parameter $\\kappa$ in terms of $x$, $M_{0}$, $T$, $\\varepsilon_{r}$, $\\varepsilon_{0}$, $e$, $k_{B}$, and $N_{A}$. Then evaluate $\\kappa$ numerically for the given $M_{0}$ and $x$, and report the result in $\\mathrm{nm^{-1}}$. Round your numerical answer to three significant figures.\n\nAlthough only the numerical value of $\\kappa$ is to be provided as the final answer, your derivation must also quantitatively identify the relative contributions of the ionic species $\\mathrm{Na}^{+}$, $\\mathrm{Ca}^{2+}$, and $\\mathrm{Cl}^{-}$ to electrostatic screening at fixed $M_{0}$ via their weighted roles in the expression that determines $\\kappa$.", "solution": "The goal is to obtain $\\kappa$ from first principles of electrostatics coupled to ideal ionic distributions at thermal equilibrium. The electrostatic potential $\\psi(\\mathbf{r})$ in an electrolyte satisfies Poisson’s equation,\n$$\n\\nabla^{2}\\psi(\\mathbf{r}) \\;=\\; -\\frac{\\rho(\\mathbf{r})}{\\varepsilon_{r}\\varepsilon_{0}} \\,,\n$$\nwhere $\\rho(\\mathbf{r})$ is the local free charge density and $\\varepsilon_{r}\\varepsilon_{0}$ is the permittivity of the medium. For a multicomponent electrolyte with ionic species indexed by $i$ of valence $z_{i}$, the number density $n_{i}(\\mathbf{r})$ at thermal equilibrium follows the Boltzmann distribution,\n$$\nn_{i}(\\mathbf{r}) \\;=\\; n_{i}^{0}\\,\\exp\\!\\left(-\\frac{z_{i} e\\, \\psi(\\mathbf{r})}{k_{B}T}\\right),\n$$\nwhere $n_{i}^{0}$ is the bulk number density. The charge density is\n$$\n\\rho(\\mathbf{r}) \\;=\\; \\sum_{i} z_{i} e\\, n_{i}(\\mathbf{r}) \\,.\n$$\nFor sufficiently small potentials $\\psi$ such that $\\left|z_{i} e \\psi\\right|\\ll k_{B}T$, we linearize the Boltzmann factors:\n$$\nn_{i}(\\mathbf{r}) \\;\\approx\\; n_{i}^{0}\\left(1 - \\frac{z_{i} e\\, \\psi(\\mathbf{r})}{k_{B}T}\\right).\n$$\nThis gives\n$$\n\\rho(\\mathbf{r}) \\;\\approx\\; \\sum_{i} z_{i} e\\, n_{i}^{0} \\;-\\; \\left(\\frac{e^{2}}{k_{B}T}\\right)\\!\\left(\\sum_{i} z_{i}^{2} n_{i}^{0}\\right)\\psi(\\mathbf{r}).\n$$\nBulk electroneutrality implies $\\sum_{i} z_{i} n_{i}^{0} = 0$, so the first term vanishes, yielding\n$$\n\\rho(\\mathbf{r}) \\;\\approx\\; - \\left(\\frac{e^{2}}{k_{B}T}\\right)\\!\\left(\\sum_{i} z_{i}^{2} n_{i}^{0}\\right)\\psi(\\mathbf{r}).\n$$\nSubstituting into Poisson’s equation,\n$$\n\\nabla^{2}\\psi(\\mathbf{r}) \\;=\\; \\frac{e^{2}}{\\varepsilon_{r}\\varepsilon_{0} k_{B}T}\\left(\\sum_{i} z_{i}^{2} n_{i}^{0}\\right)\\psi(\\mathbf{r}).\n$$\nBy definition of the Debye screening parameter, the linearized equation is $\\nabla^{2}\\psi = \\kappa^{2}\\psi$, so\n$$\n\\kappa^{2} \\;=\\; \\frac{e^{2}}{\\varepsilon_{r}\\varepsilon_{0} k_{B}T}\\sum_{i} z_{i}^{2} n_{i}^{0}.\n$$\n\nWe now express the bulk number densities $n_{i}^{0}$ in terms of the analytical molar concentrations. If $c_{i}$ is the bulk molarity in $\\mathrm{mol\\,L^{-1}}$, then\n$$\nn_{i}^{0} \\;=\\; 1000\\, N_{A}\\, c_{i} \\quad \\text{in } \\mathrm{m^{-3}} \\quad \\text{since } 1\\,\\mathrm{L}=10^{-3}\\,\\mathrm{m^{3}}.\n$$\nThus,\n$$\n\\kappa^{2} \\;=\\; \\frac{e^{2}}{\\varepsilon_{r}\\varepsilon_{0} k_{B}T}\\, 1000\\, N_{A}\\,\\sum_{i} z_{i}^{2} c_{i}.\n$$\n\nFor the mixed electrolyte with salt molarities $x$ for $\\mathrm{NaCl}$ and $M_{0}-x$ for $\\mathrm{CaCl}_{2}$, assuming complete dissociation:\n- $\\mathrm{NaCl}\\to \\mathrm{Na}^{+} + \\mathrm{Cl}^{-}$ gives $c_{\\mathrm{Na}^{+}} = x$ and a contribution $z^{2}c = 1^{2}x = x$.\n- $\\mathrm{CaCl}_{2}\\to \\mathrm{Ca}^{2+} + 2\\,\\mathrm{Cl}^{-}$ gives $c_{\\mathrm{Ca}^{2+}} = M_{0}-x$ with contribution $z^{2}c = 2^{2}(M_{0}-x) = 4(M_{0}-x)$, and additional chloride $2(M_{0}-x)$.\n- The total chloride concentration is $c_{\\mathrm{Cl}^{-}} = x + 2(M_{0}-x) = 2M_{0}-x$ with contribution $z^{2}c = 1^{2}(2M_{0}-x) = 2M_{0}-x$.\n\nTherefore,\n$$\n\\sum_{i} z_{i}^{2} c_{i} \\;=\\; x \\;+\\; 4(M_{0}-x) \\;+\\; (2M_{0}-x) \\;=\\; 6M_{0} - 4x.\n$$\nIt follows that\n$$\n\\kappa^{2} \\;=\\; \\frac{e^{2}}{\\varepsilon_{r}\\varepsilon_{0} k_{B}T}\\, 1000\\, N_{A}\\,\\bigl(6M_{0} - 4x\\bigr).\n$$\nEquivalently, in terms of the ionic strength $I$, defined by $I = \\tfrac{1}{2}\\sum_{i} z_{i}^{2} c_{i}$, we have $I = 3M_{0} - 2x$ and\n$$\n\\kappa^{2} \\;=\\; \\frac{2 e^{2} N_{A} \\, 1000\\, I}{\\varepsilon_{r}\\varepsilon_{0} k_{B}T}.\n$$\nThis is the requested analytical expression in terms of $x$ and $M_{0}$.\n\nNext, we evaluate numerically for $M_{0} = 5.0\\,\\mathrm{mM} = 0.0050\\,\\mathrm{mol\\,L^{-1}}$ and $x = 2.0\\,\\mathrm{mM} = 0.0020\\,\\mathrm{mol\\,L^{-1}}$. The ionic strength is\n$$\nI \\;=\\; 3M_{0} - 2x \\;=\\; 3(0.0050) - 2(0.0020) \\;=\\; 0.0150 - 0.0040 \\;=\\; 0.0110\\,\\mathrm{mol\\,L^{-1}}.\n$$\nTherefore,\n$$\n\\kappa^{2} \\;=\\; \\frac{2\\, e^{2}\\, N_{A}\\, 1000\\, I}{\\varepsilon_{r}\\varepsilon_{0} k_{B}T}\n\\;=\\; \\frac{2\\,(1.602176634\\times 10^{-19})^{2}\\,(6.02214076\\times 10^{23})\\,(1000)\\,(0.0110)}{(78.5)\\,(8.8541878128\\times 10^{-12})\\,(1.380649\\times 10^{-23})\\,(298.15)}\\,\\mathrm{m^{-2}}.\n$$\nNumerically, this yields\n$$\n\\kappa^{2} \\;\\approx\\; 1.18865\\times 10^{17}\\,\\mathrm{m^{-2}}, \\quad \\text{so} \\quad \\kappa \\;\\approx\\; 3.4486\\times 10^{8}\\,\\mathrm{m^{-1}}.\n$$\nTo report in $\\mathrm{nm^{-1}}$, use $1\\,\\mathrm{nm^{-1}} = 10^{9}\\,\\mathrm{m^{-1}}$, hence\n$$\n\\kappa \\;\\approx\\; 0.34486\\,\\mathrm{nm^{-1}}.\n$$\nRounded to three significant figures, $\\kappa = 0.345\\,\\mathrm{nm^{-1}}$.\n\nFinally, we quantify the relative contributions of each ion species to screening at fixed $M_{0}$ via their weights in $\\sum_{i} z_{i}^{2} c_{i}$ (or equivalently in $I$). For $M_{0} = 5.0\\,\\mathrm{mM}$ and $x = 2.0\\,\\mathrm{mM}$:\n- $\\mathrm{Na}^{+}$: $z^{2} c = 1^{2}\\times 2.0\\,\\mathrm{mM} = 2.0\\,\\mathrm{mM}$.\n- $\\mathrm{Ca}^{2+}$: $z^{2} c = 4\\times 3.0\\,\\mathrm{mM} = 12.0\\,\\mathrm{mM}$.\n- $\\mathrm{Cl}^{-}$: $z^{2} c = 1^{2}\\times\\bigl(2.0 + 2\\times 3.0\\bigr)\\,\\mathrm{mM} = 8.0\\,\\mathrm{mM}$.\n\nThe total $\\sum_{i} z_{i}^{2} c_{i}$ is $22.0\\,\\mathrm{mM}$, so the fractional contributions to $\\kappa^{2}$ are:\n$$\n\\text{$\\mathrm{Na}^{+}$: } \\frac{2.0}{22.0} = 0.0909,\\qquad\n\\text{$\\mathrm{Ca}^{2+}$: } \\frac{12.0}{22.0} = 0.5455,\\qquad\n\\text{$\\mathrm{Cl}^{-}$: } \\frac{8.0}{22.0} = 0.3636.\n$$\nThus, at fixed total salt molarity $M_{0}$, the divalent cation $\\mathrm{Ca}^{2+}$ dominates the screening due to the $z_{i}^{2}$ weighting, with chloride also contributing substantially because $\\mathrm{CaCl}_{2}$ increases the anion concentration relative to a monovalent salt at the same $M_{0}$.", "answer": "$$\\boxed{0.345}$$", "id": "2766661"}, {"introduction": "Knowing the interaction energy between two particles is only half the story; the ultimate goal is to predict whether a dispersion will be stable over time. This practice [@problem_id:2766683] bridges the gap between the static interaction potential and the dynamic process of aggregation by focusing on the Fuchs stability ratio, $W$. This dimensionless number quantifies the reduction in the aggregation rate due to a repulsive energy barrier. By deriving and implementing a model for $W$, you will develop a concrete understanding of how the height and width of the energy barrier dictate the kinetic stability of a colloidal system.", "problem": "You must write a complete and runnable program that, for a model colloidal pair-interaction potential belonging to the Derjaguin–Landau–Verwey–Overbeek (DLVO) class, computes the Fuchs stability ratio and the corresponding perikinetic aggregation rate relative to the diffusion-controlled Smoluchowski limit. The intended model is an absorptive-contact, steady-state, central interaction between two identical spherical particles of radius $a$ diffusing in a viscous fluid at temperature $T$, where the pair-interaction potential $U(r)$ is approximated as a piecewise-constant energy barrier localized over a finite separation interval and zero elsewhere. Your derivation must start from the steady-state Smoluchowski description of pair diffusion with a central potential and absorbing boundary at contact, and proceed to an exact expression for the Fuchs stability ratio $W$ specialized to the given square-barrier potential. Do not assume or use any pre-quoted target formulae for $W$; instead, argue from first principles to the integral representation that determines the aggregation flux and identify $W$ from that representation.\n\nPhysical setting and modeling assumptions:\n- Two identical spheres of radius $a$ diffuse with the combined relative diffusivity $D_{\\mathrm{rel}}$ under a spherically symmetric potential $U(r)$.\n- The absorbing boundary is at the particle-particle center-to-center distance $r=2a$, corresponding to zero gap separation.\n- Far from contact, the pair distribution relaxes to its bulk value.\n- Hydrodynamic retardation is neglected beyond its contribution to $D_{\\mathrm{rel}}$, which is treated as constant with $r$.\n- The DLVO potential is approximated as a square barrier in the gap coordinate $h=r-2a$: there exists a barrier of constant height over a finite gap interval and zero elsewhere.\n\nDefinitions and tasks you must implement:\n- Define the dimensionless barrier height $\\beta U_{0}$ as $\\beta U_{0} \\equiv U_{0}/(k_{\\mathrm{B}}T)$, where $k_{\\mathrm{B}}$ is Boltzmann’s constant and $T$ is the absolute temperature. In this problem, the only needed quantity from $U_{0}$ is the ratio $\\beta U_{0}$.\n- Let the barrier occupy the gap interval $h\\in[h_{1},h_{2}]$ with $0 \\le h_{1}  h_{2}$, where $h$ and $a$ are specified in meters. Thus, $U(r)=U_{0}$ for $r\\in[2a+h_{1},2a+h_{2}]$ and $U(r)=0$ otherwise.\n- Starting from the steady-state Smoluchowski description for the pair distribution under a central potential, derive an expression for the Fuchs stability ratio $W$ in terms of an integral over the radial coordinate that involves $U(r)$. Then, specialize this to the given piecewise-constant barrier and produce a closed-form expression for $W$ in terms of $a$, $h_{1}$, $h_{2}$, and $\\beta U_{0}$.\n- Use your $W$ to predict the relative aggregation rate $k/k_{\\mathrm{Sm}}$, where $k_{\\mathrm{Sm}}$ is the diffusion-limited Smoluchowski rate constant for two identical spheres. Report $k/k_{\\mathrm{Sm}}$ as a dimensionless float.\n\nTest suite:\n- Your program must compute the pair $\\big(W,\\;k/k_{\\mathrm{Sm}}\\big)$ for each of the following parameter sets, with all lengths provided in meters and all barrier heights $\\beta U_{0}$ given as dimensionless quantities.\n- Use the particle radius $a=100\\times 10^{-9}\\,\\mathrm{m}$ for all cases.\n- Parameter sets:\n  - Case A (moderate barrier, moderate width near contact): $\\beta U_{0}=5$, $h_{1}=2\\times 10^{-9}\\,\\mathrm{m}$, $h_{2}=5\\times 10^{-9}\\,\\mathrm{m}$.\n  - Case B (no barrier): $\\beta U_{0}=0$, $h_{1}=1\\times 10^{-9}\\,\\mathrm{m}$, $h_{2}=10\\times 10^{-9}\\,\\mathrm{m}$.\n  - Case C (very narrow, tall barrier near contact): $\\beta U_{0}=20$, $h_{1}=2\\times 10^{-9}\\,\\mathrm{m}$, $h_{2}=2.1\\times 10^{-9}\\,\\mathrm{m}$.\n  - Case D (barrier far from contact): $\\beta U_{0}=10$, $h_{1}=20\\times 10^{-9}\\,\\mathrm{m}$, $h_{2}=30\\times 10^{-9}\\,\\mathrm{m}$.\n  - Case E (tall and wide barrier near contact): $\\beta U_{0}=15$, $h_{1}=1\\times 10^{-9}\\,\\mathrm{m}$, $h_{2}=10\\times 10^{-9}\\,\\mathrm{m}$.\n\nOutput requirements:\n- For each case, compute $W$ and $k/k_{\\mathrm{Sm}}$ as real-valued floats.\n- Your program should produce a single line of output containing a list of pairs, one pair per case, ordered as $\\left[\\left[W_{\\mathrm{A}},R_{\\mathrm{A}}\\right],\\left[W_{\\mathrm{B}},R_{\\mathrm{B}}\\right],\\left[W_{\\mathrm{C}},R_{\\mathrm{C}}\\right],\\left[W_{\\mathrm{D}},R_{\\mathrm{D}}\\right],\\left[W_{\\mathrm{E}},R_{\\mathrm{E}}\\right]\\right]$, where $R\\equiv k/k_{\\mathrm{Sm}}$.\n- Express all outputs as dimensionless floats rounded to $6$ significant figures.\n- No physical units should appear in the output, since the requested quantities are dimensionless.", "solution": "The problem statement is scientifically sound, self-contained, and well-posed. It presents a standard problem in colloidal aggregation kinetics that is solvable from first principles. We shall proceed with the derivation and solution.\n\nThe starting point is the Smoluchowski equation describing the evolution of the pair distribution function, $n(\\mathbf{r}, t)$, for particles interacting via a central potential $U(r)$. Assuming a steady state ($\\partial n/\\partial t = 0$), constant relative diffusivity $D_{\\mathrm{rel}}$, and spherical symmetry, the equation for the particle flux vector $\\mathbf{J}$ simplifies to $\\nabla \\cdot \\mathbf{J} = 0$. In spherical coordinates, this implies that the total flux through a sphere of radius $r$, let us call it $k$, is constant:\n$$ k = 4\\pi r^2 J_r(r) = \\text{constant} $$\nThe radial flux $J_r(r)$ is given by the Nernst-Planck equation:\n$$ J_r(r) = -D_{\\mathrm{rel}} \\left( \\frac{dn(r)}{dr} + \\frac{n(r)}{k_{\\mathrm{B}}T} \\frac{dU(r)}{dr} \\right) $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the absolute temperature. Let $\\beta = 1/(k_{\\mathrm{B}}T)$. The expression for the constant rate $k$ becomes:\n$$ k = -4\\pi r^2 D_{\\mathrm{rel}} \\left( \\frac{dn}{dr} + \\beta n \\frac{dU}{dr} \\right) $$\nThis ordinary differential equation can be solved by recognizing that the term in parentheses is related to the derivative of $n(r) e^{\\beta U(r)}$.\n$$ k = -4\\pi r^2 D_{\\mathrm{rel}} e^{-\\beta U(r)} \\frac{d}{dr} \\left( n(r) e^{\\beta U(r)} \\right) $$\nWe separate variables and prepare for integration:\n$$ -\\frac{k}{4\\pi D_{\\mathrm{rel}}} \\frac{e^{\\beta U(r)}}{r^2} dr = d\\left( n(r) e^{\\beta U(r)} \\right) $$\nWe integrate this expression from the surface of contact at $r=2a$ to a location far from the particle at $r \\to \\infty$. The boundary conditions are:\n$1.$ An absorbing boundary at contact, implying irreversible aggregation: $n(2a) = 0$.\n$2.$ At large separation, the pair distribution relaxes to the bulk concentration $n_0$, and the potential vanishes: $n(r \\to \\infty) \\to n_0$ and $U(r \\to \\infty) \\to 0$.\n\nApplying these boundary conditions to the integrated equation:\n$$ -\\frac{k}{4\\pi D_{\\mathrm{rel}}} \\int_{2a}^{\\infty} \\frac{e^{\\beta U(r)}}{r^2} dr = \\left[ n(r) e^{\\beta U(r)} \\right]_{2a}^{\\infty} $$\n$$ -\\frac{k}{4\\pi D_{\\mathrm{rel}}} \\int_{2a}^{\\infty} \\frac{e^{\\beta U(r)}}{r^2} dr = n_0e^0 - n(2a)e^{\\beta U(2a)} = n_0 - 0 = n_0 $$\nThe total aggregation rate is typically expressed as $k_{\\mathrm{agg}} n_0$. The flux $k$ we have defined represents this rate. Thus, we solve for the aggregation rate constant, $k_{\\mathrm{agg}} = k/n_0$:\n$$ k_{\\mathrm{agg}} = \\frac{4\\pi D_{\\mathrm{rel}}}{\\int_{2a}^{\\infty} \\frac{e^{\\beta U(r)}}{r^2} dr} $$\nThe diffusion-limited Smoluchowski rate constant, $k_{\\mathrm{Sm}}$, is the rate when there is no interaction potential, i.e., $U(r) = 0$ for all $r$.\n$$ k_{\\mathrm{Sm}} = \\frac{4\\pi D_{\\mathrm{rel}}}{\\int_{2a}^{\\infty} \\frac{e^0}{r^2} dr} = \\frac{4\\pi D_{\\mathrm{rel}}}{\\int_{2a}^{\\infty} \\frac{1}{r^2} dr} $$\nThe integral evaluates to $\\int_{2a}^{\\infty} r^{-2} dr = [-r^{-1}]_{2a}^{\\infty} = 1/(2a)$.\n$$ k_{\\mathrm{Sm}} = \\frac{4\\pi D_{\\mathrm{rel}}}{1/(2a)} = 8\\pi D_{\\mathrm{rel}} a $$\nThe Fuchs stability ratio, $W$, is defined as the ratio of the maximum possible aggregation rate (diffusion-limited) to the actual rate moderated by the potential barrier:\n$$ W = \\frac{k_{\\mathrm{Sm}}}{k_{\\mathrm{agg}}} $$\nSubstituting our expressions for $k_{\\mathrm{Sm}}$ and $k_{\\mathrm{agg}}$ yields the integral representation for $W$:\n$$ W = \\frac{8\\pi D_{\\mathrm{rel}} a}{\\frac{4\\pi D_{\\mathrm{rel}}}{\\int_{2a}^{\\infty} \\frac{e^{\\beta U(r)}}{r^2} dr}} = 2a \\int_{2a}^{\\infty} \\frac{e^{\\beta U(r)}}{r^2} dr $$\nThe relative aggregation rate is then simply $k/k_{\\mathrm{Sm}} = 1/W$.\n\nNow, we specialize this result for the given piecewise-constant (square barrier) potential:\n$$ U(r) = \\begin{cases} U_0  \\text{for } r \\in [2a+h_1, 2a+h_2] \\\\ 0  \\text{otherwise for } r \\ge 2a \\end{cases} $$\nThe integral for $W$ is split into three regions corresponding to the piecewise definition of $U(r)$:\n$$ W = 2a \\left( \\int_{2a}^{2a+h_1} \\frac{e^0}{r^2} dr + \\int_{2a+h_1}^{2a+h_2} \\frac{e^{\\beta U_0}}{r^2} dr + \\int_{2a+h_2}^{\\infty} \\frac{e^0}{r^2} dr \\right) $$\nEvaluating these definite integrals:\n$$ \\int_{2a}^{2a+h_1} \\frac{1}{r^2} dr = \\left[-\\frac{1}{r}\\right]_{2a}^{2a+h_1} = \\frac{1}{2a} - \\frac{1}{2a+h_1} $$\n$$ e^{\\beta U_0} \\int_{2a+h_1}^{2a+h_2} \\frac{1}{r^2} dr = e^{\\beta U_0} \\left[-\\frac{1}{r}\\right]_{2a+h_1}^{2a+h_2} = e^{\\beta U_0} \\left( \\frac{1}{2a+h_1} - \\frac{1}{2a+h_2} \\right) $$\n$$ \\int_{2a+h_2}^{\\infty} \\frac{1}{r^2} dr = \\left[-\\frac{1}{r}\\right]_{2a+h_2}^{\\infty} = \\frac{1}{2a+h_2} $$\nSubstituting these back into the expression for $W$:\n$$ W = 2a \\left[ \\left(\\frac{1}{2a} - \\frac{1}{2a+h_1}\\right) + e^{\\beta U_0} \\left(\\frac{1}{2a+h_1} - \\frac{1}{2a+h_2}\\right) + \\frac{1}{2a+h_2} \\right] $$\nRearranging the terms, we collect coefficients of the same denominator:\n$$ W = 2a \\left[ \\frac{1}{2a} + \\frac{e^{\\beta U_0}-1}{2a+h_1} - \\frac{e^{\\beta U_0}-1}{2a+h_2} \\right] $$\nDistributing the $2a$ prefactor and factoring out the common term $(e^{\\beta U_0}-1)$ gives the final closed-form expression:\n$$ W = 1 + 2a (e^{\\beta U_0}-1) \\left( \\frac{1}{2a+h_1} - \\frac{1}{2a+h_2} \\right) $$\nThis formula will be implemented to compute $W$ for each test case. The relative aggregation rate $k/k_{\\mathrm{Sm}}$ is then computed as $1/W$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Fuchs stability ratio (W) and relative aggregation rate (R)\n    for a square-barrier potential model in colloidal aggregation.\n    \"\"\"\n\n    # Particle radius for all test cases\n    a = 100e-9  # meters\n\n    # Test cases: (dimensionless barrier height, barrier start, barrier end)\n    # Barrier locations h1 and h2 are given in meters.\n    test_cases = [\n        # Case A: Moderate barrier, moderate width near contact\n        (5.0, 2e-9, 5e-9),\n        # Case B: No barrier\n        (0.0, 1e-9, 10e-9),\n        # Case C: Very narrow, tall barrier near contact\n        (20.0, 2e-9, 2.1e-9),\n        # Case D: Barrier far from contact\n        (10.0, 20e-9, 30e-9),\n        # Case E: Tall and wide barrier near contact\n        (15.0, 1e-9, 10e-9)\n    ]\n    \n    # Number of significant figures for output\n    sf = 6\n\n    def calculate_W_and_R(particle_radius, h1, h2, beta_U0):\n        \"\"\"\n        Calculates W and R based on the derived formula.\n        \n        W = 1 + 2a * (exp(beta*U0) - 1) * (1/(2a+h1) - 1/(2a+h2))\n        R = 1/W\n        \"\"\"\n        # The case of no barrier (beta_U0 = 0) is a special case.\n        # exp(0)-1 = 0, so the second term vanishes and W = 1.\n        if beta_U0 == 0.0:\n            W = 1.0\n        else:\n            # The problem definition ensures 0 = h1  h2, so no division by zero\n            # or negative barrier width.\n            term1 = 2 * particle_radius\n            term2 = np.exp(beta_U0) - 1\n            term3 = (1 / (2 * particle_radius + h1)) - (1 / (2 * particle_radius + h2))\n            W = 1 + term1 * term2 * term3\n        \n        R = 1 / W\n        return W, R\n\n    def round_to_sf(value, num_sf):\n        \"\"\"\n        Rounds a float to a specified number of significant figures.\n        \"\"\"\n        if value == 0:\n            return 0.0\n        # Use format specifier 'g' which handles significant figures correctly,\n        # then convert back to float.\n        return float(f'{value:.{num_sf}g}')\n\n    results = []\n    for beta_U0, h1, h2 in test_cases:\n        W, R = calculate_W_and_R(a, h1, h2, beta_U0)\n        \n        # Round the computed values to the required number of significant figures.\n        W_rounded = round_to_sf(W, sf)\n        R_rounded = round_to_sf(R, sf)\n        \n        results.append([W_rounded, R_rounded])\n\n    # Format the final output string to be exactly as specified in the problem,\n    # specifically ensuring no spaces inside the inner lists.\n    # Ex: [[W_A,R_A],[W_B,R_B],...]\n    output_string = str(results).replace(\" \", \"\")\n    print(output_string)\n\nsolve()\n```", "id": "2766683"}, {"introduction": "Aggregation is not a single event but a continuous process that transforms an entire population of particles, leading to the growth of clusters and changing the properties of the system. The Smoluchowski coagulation equation provides the premier theoretical framework for describing this evolution of the cluster size distribution. In this capstone exercise [@problem_id:2766714], you will build a numerical simulation based on these population balance equations. This will allow you to connect the microscopic collision kernel, $K_{ij}$, to the macroscopic, time-dependent behavior of an entire aggregating system, providing insight into phenomena like gelation and precipitate formation.", "problem": "You are tasked with formulating and numerically integrating a population balance for irreversible cluster–cluster aggregation under diffusion-limited conditions. The system consists of primary colloidal particles that aggregate to form clusters, where a cluster of size $i$ contains $i$ primary particles. The fundamental physical picture is that of Brownian motion in a viscous fluid: clusters diffuse and react upon encounter with unity sticking probability. Your program must compute the transient evolution of the cluster size distribution from specified initial conditions and physical parameters, and report scalar diagnostics at a specified final time.\n\nStarting from conservation of cluster number and binary collision kinetics, construct the set of ordinary differential equations governing the temporal evolution of the number concentration $n_i(t)$ of clusters of size $i$. The binary aggregation kernel $K_{ij}$ is the diffusion-limited collision frequency of two clusters of hydrodynamic radii $R_i$ and $R_j$ and diffusion coefficients $D_i$ and $D_j$. Use the Stokes–Einstein relation for Brownian diffusivity in a Newtonian fluid at absolute temperature $T$ and dynamic viscosity $\\mu$, and assume fractal scaling for the hydrodynamic radius of a cluster with aggregation number $i$ with a given fractal dimension $d_f$. Assume irreversible aggregation with unity sticking probability, and neglect all processes other than aggregation. Treat the system as spatially homogeneous.\n\nDiscretize cluster sizes as $i \\in \\{1,2,\\dots,N_{\\max}\\}$ and integrate the governing ordinary differential equations in time from $t=0$ to a specified final time $t=t_{\\mathrm{end}}$. You may assume that $N_{\\max}$ is sufficiently large that the effect of clusters larger than $N_{\\max}$ on the reported diagnostics at the chosen $t_{\\mathrm{end}}$ is negligible.\n\nYour program must, for each test case described below, compute and report at $t=t_{\\mathrm{end}}$:\n- the total number concentration $M_0(t_{\\mathrm{end}})=\\sum_{i=1}^{N_{\\max}} n_i(t_{\\mathrm{end}})$ in $\\mathrm{m}^{-3}$,\n- the mean aggregation number $\\langle i \\rangle (t_{\\mathrm{end}})=\\left(\\sum_{i=1}^{N_{\\max}} i\\,n_i(t_{\\mathrm{end}})\\right) \\Big/ \\left(\\sum_{i=1}^{N_{\\max}} n_i(t_{\\mathrm{end}})\\right)$ as a dimensionless float,\n- the monomer fraction $f_1(t_{\\mathrm{end}})=n_1(t_{\\mathrm{end}}) \\big/ \\left(\\sum_{i=1}^{N_{\\max}} n_i(t_{\\mathrm{end}})\\right)$ as a decimal,\n- the relative primary-particle conservation error $\\varepsilon=\\left|\\left(\\sum_{i=1}^{N_{\\max}} i\\,n_i(t_{\\mathrm{end}})\\right)-\\left(\\sum_{i=1}^{N_{\\max}} i\\,n_i(0)\\right)\\right| \\Big/ \\left(\\sum_{i=1}^{N_{\\max}} i\\,n_i(0)\\right)$ as a decimal.\n\nAll physical constants and parameters must be treated in the International System of Units (SI). The Boltzmann constant is $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$. The primary particle hydrodynamic radius is $a_1$ (in $\\mathrm{m}$). The hydrodynamic radius scales with aggregation number $i$ via a prescribed fractal dimension $d_f$. The diffusion coefficient of a cluster depends on its hydrodynamic radius and the fluid properties. Assume diffusion-limited cluster aggregation.\n\nNumerical output requirements:\n- For each test case, report the four diagnostics listed above as a list of four real numbers in the units specified. Each real number must be rounded to six significant figures.\n- Aggregate the results from all test cases into a single Python-style list of lists in the order the tests are given, and print exactly one line containing this list, with no additional text.\n\nTest suite:\n- Test case 1 (general monodisperse case):\n  - $T=298.15\\,\\mathrm{K}$, $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $a_1=5.0\\times 10^{-8}\\,\\mathrm{m}$, $d_f=1.8$, $N_{\\max}=64$.\n  - Initial condition at $t=0$: $n_1(0)=1.0\\times 10^{14}\\,\\mathrm{m}^{-3}$, and $n_i(0)=0\\,\\mathrm{m}^{-3}$ for all $i \\in \\{2,\\dots,N_{\\max}\\}$.\n  - Final time: $t_{\\mathrm{end}}=0.5\\,\\mathrm{s}$.\n- Test case 2 (dilute limit):\n  - $T=298.15\\,\\mathrm{K}$, $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $a_1=5.0\\times 10^{-8}\\,\\mathrm{m}$, $d_f=1.8$, $N_{\\max}=64$.\n  - Initial condition at $t=0$: $n_1(0)=1.0\\times 10^{10}\\,\\mathrm{m}^{-3}$, and $n_i(0)=0\\,\\mathrm{m}^{-3}$ for all $i \\in \\{2,\\dots,N_{\\max}\\}$.\n  - Final time: $t_{\\mathrm{end}}=1.0\\,\\mathrm{s}$.\n- Test case 3 (polydisperse start and different fractal dimension):\n  - $T=298.15\\,\\mathrm{K}$, $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $a_1=5.0\\times 10^{-8}\\,\\mathrm{m}$, $d_f=2.1$, $N_{\\max}=64$.\n  - Initial condition at $t=0$: $n_1(0)=0.6\\times 5.0\\times 10^{13}\\,\\mathrm{m}^{-3}$, $n_2(0)=0.4\\times 5.0\\times 10^{13}\\,\\mathrm{m}^{-3}$, and $n_i(0)=0\\,\\mathrm{m}^{-3}$ for all $i \\in \\{3,\\dots,N_{\\max}\\}$.\n  - Final time: $t_{\\mathrm{end}}=0.5\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the form\n[`[`$M_0^{(1)},\\langle i\\rangle^{(1)},f_1^{(1)},\\varepsilon^{(1)}$`],[`$M_0^{(2)},\\langle i\\rangle^{(2)},f_1^{(2)},\\varepsilon^{(2)}$`],[`$M_0^{(3)},\\langle i\\rangle^{(3)},f_1^{(3)},\\varepsilon^{(3)}$`]`],\nwith each real number rounded to six significant figures, where the superscript $^{(k)}$ denotes the test case index.", "solution": "We model irreversible cluster–cluster aggregation driven by Brownian motion in a viscous fluid. The objective is to derive the governing equations for the time evolution of the number concentration $n_i(t)$ of clusters containing $i$ primary particles, under diffusion-limited conditions with unity sticking probability.\n\nThe physical starting point is the kinetics of binary collisions due to diffusion. For two absorbing spheres in a continuum fluid, the steady-state diffusive flux to contact yields a collision frequency that depends on the sum of the diffusion coefficients and an effective capture distance. For clusters of hydrodynamic radii $R_i$ and $R_j$ with diffusion coefficients $D_i$ and $D_j$, the diffusion-limited collision frequency (aggregation kernel) $K_{ij}$ is obtained from solving the Laplace equation for concentration around two diffusing sinks when they are far apart and react on contact. The dependence on hydrodynamic properties follows from established diffusion theory and the Stokes–Einstein relation.\n\nThe Stokes–Einstein relation for a spherical particle of hydrodynamic radius $R$ in a Newtonian fluid of dynamic viscosity $\\mu$ at absolute temperature $T$ gives the Brownian diffusion coefficient\n$$\nD(R) = \\frac{k_{\\mathrm{B}}\\,T}{6\\pi \\,\\mu\\, R},\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant. A cluster of aggregation number $i$ is modeled as a fractal object with hydrodynamic radius scaling as\n$$\nR_i = a_1\\, i^{1/d_f},\n$$\nwhere $a_1$ is the primary particle hydrodynamic radius and $d_f$ is the fractal dimension. This empirical scaling is widely observed for diffusion-limited cluster aggregation.\n\nFor diffusion-limited aggregation of two clusters $i$ and $j$ that react upon encounter, the collision frequency (aggregation kernel) is given by the sum of diffusive fluxes to an absorbing boundary at contact. The resulting kernel is\n$$\nK_{ij} = 4\\pi\\,\\left(D_i + D_j\\right)\\,\\left(R_i + R_j\\right),\n$$\nwhich is symmetric in $i$ and $j$. Substituting the Stokes–Einstein relation for $D_i$ and $D_j$ and the fractal scaling for $R_i$ and $R_j$ fully specifies $K_{ij}$ in terms of $i$, $j$, $T$, $\\mu$, $a_1$, and $d_f$.\n\nThe population balance for aggregation assumes spatial homogeneity and binary collisions with number conservation in aggregation events. The discrete Smoluchowski coagulation equation gives the rate of change of $n_k(t)$ as a balance between formation of clusters of size $k$ by mergers of smaller clusters and loss of clusters of size $k$ due to their aggregation with clusters of any size:\n$$\n\\frac{d n_k}{dt} = \\frac{1}{2}\\sum_{i=1}^{k-1} K_{i,k-i}\\, n_i\\, n_{k-i} \\;-\\; n_k \\sum_{j=1}^{\\infty} K_{k j}\\, n_j, \\quad k=1,2,\\dots.\n$$\nThe first term accounts for all unordered pairs $\\{i,k-i\\}$ that produce size $k$; the factor of $1/2$ avoids double counting. The second term counts removal of size $k$ clusters via collisions with all sizes $j$. We truncate the system at a maximum size $N_{\\max}$, approximating the infinite sums by sums up to $N_{\\max}$. If $N_{\\max}$ is sufficiently large and the simulated time horizon is chosen appropriately, the effect of clusters larger than $N_{\\max}$ on the diagnostics of interest is negligible. We monitor the conservation of the primary particle count (the first moment) as a diagnostic:\n$$\nM_1(t) = \\sum_{i=1}^{N_{\\max}} i\\, n_i(t),\n$$\nwhich should remain constant in the absence of numerical truncation errors. The total number concentration is the zeroth moment\n$$\nM_0(t) = \\sum_{i=1}^{N_{\\max}} n_i(t).\n$$\nThe mean aggregation number is $\\langle i \\rangle = M_1/M_0$, and the monomer fraction is $f_1 = n_1/M_0$.\n\nAlgorithmic design:\n1. Precompute cluster hydrodynamic radii $R_i = a_1\\, i^{1/d_f}$ for $i \\in \\{1,\\dots,N_{\\max}\\}$ using the specified $a_1$ and $d_f$.\n2. Compute diffusion coefficients $D_i = k_{\\mathrm{B}} T / (6\\pi \\mu R_i)$ using the specified $T$ and $\\mu$.\n3. Assemble the symmetric aggregation kernel matrix $K_{ij} = 4\\pi (D_i + D_j)(R_i + R_j)$ for $i,j \\in \\{1,\\dots,N_{\\max}\\}$.\n4. Define the right-hand side of the ordinary differential equation system for $\\mathbf{n}(t) = [n_1(t),\\dots,n_{N_{\\max}}(t)]^\\top$ using the truncated Smoluchowski balance:\n   - For each $k$, compute the formation term as $\\frac{1}{2}\\sum_{i=1}^{k-1} K_{i,k-i}\\, n_i\\, n_{k-i}$.\n   - Compute the removal term as $n_k \\sum_{j=1}^{N_{\\max}} K_{k j}\\, n_j$.\n5. Integrate the stiff system from $t=0$ to $t=t_{\\mathrm{end}}$ using an appropriate implicit method for stiff ordinary differential equations such as the Backward Differentiation Formula (BDF), with tolerances chosen to balance accuracy and computational cost.\n6. At $t=t_{\\mathrm{end}}$, compute $M_0$, $M_1$, $\\langle i \\rangle = M_1/M_0$, $f_1 = n_1/M_0$, and the relative primary-particle conservation error $\\varepsilon = |M_1(t_{\\mathrm{end}})-M_1(0)|/M_1(0)$.\n7. Repeat for each test case, and print the results as a single list of lists. Round each reported value to six significant figures.\n\nScientific considerations:\n- The kernel expression follows from classical diffusion theory and is valid for diffusion-limited conditions in the dilute regime.\n- The Stokes–Einstein relation assumes stick boundary conditions and low Reynolds number, consistent with nanoscopic clusters in viscous media.\n- The fractal scaling encapsulates the effective hydrodynamic size of clusters formed by aggregation; values of $d_f$ in the range $1.7$–$2.1$ are typical for diffusion-limited cluster aggregation.\n- Truncation at $N_{\\max}$ can lead to a small loss of primary-particle mass into sizes larger than $N_{\\max}$. The conservation error diagnostic $\\varepsilon$ quantifies this, and parameters are chosen so $\\varepsilon$ remains small over the simulated times.\n\nImplementation details:\n- The kernel and radii are precomputed to avoid redundant calculations during the right-hand side evaluations.\n- The formation term can be computed in $\\mathcal{O}(N_{\\max}^2)$ by direct summation; for $N_{\\max}=64$ this is computationally inexpensive.\n- We use absolute and relative tolerances for the ODE solver to ensure that the small changes in number concentrations are captured accurately.\n- The output is rounded to six significant figures using a significant-figure rounding function, and printed as a single Python list literal to satisfy the required output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom math import log10, floor\nfrom scipy.integrate import solve_ivp\n\nkB = 1.380649e-23  # Boltzmann constant [J/K]\npi = np.pi\n\ndef cluster_radius(i, a1, df):\n    # i is integer aggregation number, return hydrodynamic radius [m]\n    return a1 * (i ** (1.0 / df))\n\ndef diffusion_coeff(R, T, mu):\n    # Stokes-Einstein diffusion coefficient [m^2/s]\n    return kB * T / (6.0 * pi * mu * R)\n\ndef build_kernel(Nmax, T, mu, a1, df):\n    # Precompute radii and diffusion coefficients for i=1..Nmax\n    i_vals = np.arange(1, Nmax + 1, dtype=float)\n    R = a1 * np.power(i_vals, 1.0 / df)  # shape (Nmax,)\n    D = kB * T / (6.0 * pi * mu * R)     # shape (Nmax,)\n    # Build symmetric kernel: K_ij = 4*pi*(D_i + D_j)*(R_i + R_j)\n    R_sum = R.reshape(-1, 1) + R.reshape(1, -1)\n    D_sum = D.reshape(-1, 1) + D.reshape(1, -1)\n    K = 4.0 * pi * D_sum * R_sum\n    return K\n\ndef smoluchowski_rhs(t, n, K):\n    # n: vector of size Nmax\n    # K: kernel matrix NxN\n    N = n.size\n    dn = np.zeros_like(n)\n    # Precompute S_k = sum_j K_kj n_j for destruction term\n    S = K @ n  # shape (N,)\n    # Formation term: for each k, sum over i=1..k-1 of K_{i,k-i} n_i n_{k-i} with 1/2 factor\n    # Note: indices in code are 0-based; aggregation numbers are 1-based\n    for k in range(N):\n        # destruction\n        dn[k] -= n[k] * S[k]\n        # formation: only if k = 1 in 0-based (i.e., size = 2)\n        kk = k + 1  # actual aggregation number\n        if kk = 2:\n            # sum i=1..kk-1 = i_idx=0..k-1; partner j_idx = k - 1 - i_idx\n            # We can loop i_idx from 0 to k-1\n            total = 0.0\n            for i_idx in range(0, k):\n                j_idx = k - 1 - i_idx\n                total += K[i_idx, j_idx] * n[i_idx] * n[j_idx]\n            dn[k] += 0.5 * total\n    return dn\n\ndef moments(n):\n    # Zeroth and first moments\n    N = n.size\n    i_vals = np.arange(1, N + 1, dtype=float)\n    M0 = float(np.sum(n))\n    M1 = float(np.dot(i_vals, n))\n    return M0, M1\n\ndef sigfig(x, s=6):\n    if x == 0 or not np.isfinite(x):\n        return float(x)\n    return round(x, s - int(floor(log10(abs(x)))) - 1)\n\ndef run_case(T, mu, a1, df, Nmax, init_counts, t_end):\n    # Build kernel\n    K = build_kernel(Nmax, T, mu, a1, df)\n    # Initial condition vector\n    n0 = np.zeros(Nmax, dtype=float)\n    for i, val in init_counts.items():\n        if 1 = i = Nmax:\n            n0[i - 1] = val\n    M0_0, M1_0 = moments(n0)\n    # Integrate ODE\n    # Use BDF for stiffness, with tolerances adapted to magnitude of n\n    atol = 1e-6 * max(1.0, np.max(n0)) if np.max(n0)  0 else 1e-12\n    rtol = 1e-6\n    sol = solve_ivp(\n        fun=lambda t, y: smoluchowski_rhs(t, y, K),\n        t_span=(0.0, t_end),\n        y0=n0,\n        method='BDF',\n        atol=atol,\n        rtol=rtol,\n        t_eval=[t_end],\n        vectorized=False,\n        jac=None,\n    )\n    n_end = sol.y[:, -1]\n    # Enforce non-negativity due to potential small numerical undershoots\n    n_end = np.maximum(n_end, 0.0)\n    M0, M1 = moments(n_end)\n    mean_i = M1 / M0 if M0  0 else float('nan')\n    f1 = n_end[0] / M0 if M0  0 else float('nan')\n    eps = abs(M1 - M1_0) / M1_0 if M1_0  0 else 0.0\n    # Round to six significant figures\n    return [sigfig(M0, 6), sigfig(mean_i, 6), sigfig(f1, 6), sigfig(eps, 6)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"T\": 298.15,\n            \"mu\": 1.0e-3,\n            \"a1\": 5.0e-8,\n            \"df\": 1.8,\n            \"Nmax\": 64,\n            \"init_counts\": {1: 1.0e14},\n            \"t_end\": 0.5,\n        },\n        # Test case 2\n        {\n            \"T\": 298.15,\n            \"mu\": 1.0e-3,\n            \"a1\": 5.0e-8,\n            \"df\": 1.8,\n            \"Nmax\": 64,\n            \"init_counts\": {1: 1.0e10},\n            \"t_end\": 1.0,\n        },\n        # Test case 3\n        {\n            \"T\": 298.15,\n            \"mu\": 1.0e-3,\n            \"a1\": 5.0e-8,\n            \"df\": 2.1,\n            \"Nmax\": 64,\n            \"init_counts\": {1: 0.6 * 5.0e13, 2: 0.4 * 5.0e13},\n            \"t_end\": 0.5,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        res = run_case(\n            T=case[\"T\"],\n            mu=case[\"mu\"],\n            a1=case[\"a1\"],\n            df=case[\"df\"],\n            Nmax=case[\"Nmax\"],\n            init_counts=case[\"init_counts\"],\n            t_end=case[\"t_end\"],\n        )\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2766714"}]}