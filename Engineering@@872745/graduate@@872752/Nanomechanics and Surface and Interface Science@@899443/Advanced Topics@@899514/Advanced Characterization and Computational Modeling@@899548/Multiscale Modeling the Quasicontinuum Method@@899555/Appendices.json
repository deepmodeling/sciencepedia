{"hands_on_practices": [{"introduction": "The continuum component of the Quasicontinuum (QC) method relies on the Cauchy-Born rule to link macroscopic deformation to the underlying atomic lattice. This foundational practice walks you through the derivation of a macroscopic elastic modulus directly from a microscopic interatomic potential for a simple 1D chain. Completing this exercise will solidify your understanding of this crucial theoretical bridge that makes multiscale modeling possible. [@problem_id:2780454]", "problem": "A one-dimensional Bravais lattice with nearest-neighbor interactions is modeled by a pair potential $\\phi(r)$, where $r$ is the bond length. Let the reference lattice spacing be $a_0$, which corresponds to the stress-free equilibrium bond length. Consider a uniform macroscopic deformation characterized by the deformation gradient $F$ in one dimension, so that the current spacing is $a = F a_0$. Under the Cauchy–Born assumption, as used in the QuasiContinuum (QC) method, the continuum stored energy density per unit reference length is defined by pulling back the atomistic energy of the chain under uniform deformation.\n\nStarting from first principles, namely (i) the definition of total potential energy of a one-dimensional nearest-neighbor chain, (ii) the Cauchy–Born kinematic relation $a = F a_0$, (iii) the definition of the first Piola–Kirchhoff stress as the derivative of the stored energy density with respect to $F$, and (iv) the definition of the Cauchy stress in one dimension, linearize the stress–strain relation about the equilibrium configuration $F = 1$ (i.e., about the equilibrium spacing $a_0$). Define the small-strain modulus $E$ as the slope $\\mathrm{d}\\sigma/\\mathrm{d}\\varepsilon$ of the Cauchy stress $\\sigma$ with respect to the engineering strain $\\varepsilon = F - 1$ at $\\varepsilon = 0$.\n\nExpress your final answer as a single closed-form analytic expression for $E$ in terms of $\\phi'(a_0)$ and $\\phi''(a_0)$. Provide your final answer as a symbolic expression; do not include units.", "solution": "The posed problem requests the derivation of the small-strain elastic modulus for a one-dimensional atomic chain, starting from first principles and applying the Cauchy–Born rule. This is a fundamental exercise in connecting atomistic descriptions to continuum mechanics, a central concept in multiscale modeling and the Quasicontinuum (QC) method.\n\nFirst, a rigorous validation of the problem statement is required.\n\n**Step 1: Extract Givens**\n-   System: A one-dimensional Bravais lattice.\n-   Interaction: Governed by a nearest-neighbor pair potential $\\phi(r)$, where $r$ is the bond length.\n-   Reference state: The lattice has a spacing $a_0$, which is the stress-free equilibrium bond length.\n-   Deformation kinematics: A uniform deformation gradient $F$ maps the reference spacing $a_0$ to the current spacing $a$ via the Cauchy–Born relation $a = F a_0$.\n-   Energy definition: The continuum stored energy density per unit reference length, $W(F)$, is derived from the atomistic potential energy.\n-   Stress definition 1: The first Piola–Kirchhoff stress is $P = \\frac{\\mathrm{d}W}{\\mathrm{d}F}$.\n-   Stress definition 2: The relation between first Piola-Kirchhoff stress $P$ and Cauchy stress $\\sigma$ in one dimension.\n-   Strain definition: Engineering strain is $\\varepsilon = F - 1$.\n-   Modulus definition: The small-strain modulus is $E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}$.\n-   Objective: Derive an expression for $E$ in terms of the potential derivatives $\\phi'(a_0)$ and $\\phi''(a_0)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard derivation in solid mechanics and materials science. It is well-posed, with clear definitions and a specific objective. The language is objective and formal. The problem is directly relevant to the topic of the QC method. All provided information is consistent and sufficient. The statement that $a_0$ corresponds to a \"stress-free equilibrium\" is a critical piece of information that implies a specific condition on the potential derivative at $a_0$. This is not an ambiguity but a physical constraint to be used in the derivation.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation**\n\n1.  **Stored Energy Density, $W(F)$**\n    We consider an infinitely long chain to neglect boundary effects. In the reference configuration, there is one atom per length $a_0$. The number density of atoms (or bonds) per unit reference length is $1/a_0$. Under a uniform deformation $F$, every bond has length $a = F a_0$ and stores energy $\\phi(a) = \\phi(F a_0)$. The stored energy per unit reference length is the energy per bond multiplied by the number of bonds per unit reference length.\n    Therefore, the stored energy density $W$ as a function of the deformation gradient $F$ is:\n    $$W(F) = \\frac{1}{a_0}\\phi(F a_0)$$\n\n2.  **First Piola–Kirchhoff Stress, $P(F)$**\n    According to the problem definition, the first Piola–Kirchhoff (P-K) stress $P$ (also known as nominal stress) is the derivative of the stored energy density $W$ with respect to the deformation gradient $F$.\n    $$P(F) = \\frac{\\mathrm{d}W}{\\mathrm{d}F} = \\frac{\\mathrm{d}}{\\mathrm{d}F}\\left(\\frac{1}{a_0}\\phi(F a_0)\\right)$$\n    Applying the chain rule, where the argument of $\\phi$ is $u(F) = F a_0$ such that $\\frac{\\mathrm{d}u}{\\mathrm{d}F} = a_0$:\n    $$P(F) = \\frac{1}{a_0} \\cdot \\phi'(F a_0) \\cdot \\frac{\\mathrm{d}(F a_0)}{\\mathrm{d}F} = \\frac{1}{a_0} \\cdot \\phi'(F a_0) \\cdot a_0$$\n    $$P(F) = \\phi'(F a_0)$$\n    This represents the force acting on a cross-section in the reference configuration.\n\n3.  **Cauchy Stress, $\\sigma(F)$**\n    In one-dimensional continuum mechanics, the Cauchy stress $\\sigma$ (true stress) and the first P-K stress $P$ are equivalent. This is because stress is force per unit area, and in a 1D model, the \"area\" is an invariant cross-section. Thus, the force acting on a current cross-section is the same as the force acting on a reference cross-section, and the areas are the same.\n    $$\\sigma(F) = P(F) = \\phi'(F a_0)$$\n    The problem statement specifies that the reference spacing $a_0$ is \"stress-free.\" This means the Cauchy stress at the reference state ($F=1$) is zero:\n    $$\\sigma(F=1) = \\phi'(a_0) = 0$$\n    This is the mathematical condition for equilibrium.\n\n4.  **Linearization and the Elastic Modulus, $E$**\n    The task is to find the modulus $E$ as the slope of the Cauchy stress $\\sigma$ with respect to the engineering strain $\\varepsilon = F-1$. We first express the stress as a function of strain by substituting $F = 1+\\varepsilon$:\n    $$\\sigma(\\varepsilon) = \\phi'((1+\\varepsilon) a_0)$$\n    Now, we compute the derivative with respect to $\\varepsilon$:\n    $$\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = \\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\left[\\phi'((1+\\varepsilon)a_0)\\right]$$\n    Using the chain rule:\n    $$\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = \\phi''((1+\\varepsilon)a_0) \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}((1+\\varepsilon)a_0) = \\phi''((1+\\varepsilon)a_0) \\cdot a_0$$\n    Finally, we evaluate this expression at zero strain ($\\varepsilon=0$), which corresponds to the equilibrium reference configuration:\n    $$E = \\left.\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = a_0 \\phi''(a_0)$$\n    This final expression represents the small-strain elastic modulus. It depends on the curvature of the potential energy well at the equilibrium separation, $\\phi''(a_0)$, which describes the stiffness of the interatomic bond, scaled by the spacing $a_0$. The equilibrium condition $\\phi'(a_0)=0$ was already used in identifying the reference state as being stress-free.", "answer": "$$\\boxed{a_0 \\phi''(a_0)}$$", "id": "2780454"}, {"introduction": "A primary challenge in concurrent multiscale modeling is the consistent coupling of atomistic and continuum regions, as improper energy summation at the interface creates spurious \"ghost forces\". This practice provides a direct, hands-on derivation of these forces for a 1D model system. By working through this calculation, you will gain a concrete understanding of why ghost forces arise and how enforcing the patch-test condition serves to eliminate them, ensuring a physically meaningful simulation. [@problem_id:2780470]", "problem": "Consider a one-dimensional ($1$D) Bravais chain with reference lattice spacing $a>0$ and pairwise interactions up to second neighbors. The atomistic total potential energy for a fully resolved system is\n$$\n\\mathcal{E}_{\\mathrm{at}}(\\{y_i\\}) \\;=\\; \\sum_{i\\in\\mathbb{Z}} \\Big[ \\phi_{1}\\big(|y_{i+1}-y_i|\\big) \\;+\\; \\phi_{2}\\big(|y_{i+2}-y_i|\\big) \\Big],\n$$\nwhere $\\phi_{1}$ and $\\phi_{2}$ are smooth pair potentials for nearest and next-nearest neighbors, respectively, and $\\{y_i\\}$ are the deformed positions of atoms initially at $X_i=ia$. Under a homogeneous deformation with stretch $F>0$, the deformation is $y_i = F X_i = F a i$.\n\nAdopt an energy-based quasicontinuum (QC) coupling between a fully atomistic patch and a coarse-grained region (using the Cauchy–Born rule). Let the atomistic set be $\\mathcal{A}=\\{i\\in\\mathbb{Z}: i \\le 0\\}$ and the coarse region be $\\mathcal{C}=\\{i\\in\\mathbb{Z}: i \\ge 1\\}$. The QC coupling is defined as follows:\n- All bonds entirely within $\\mathcal{A}$ are included atomistically with full weight.\n- Bonds crossing the interface and attached to the interface atom at $i=0$ are included with weights: the nearest-neighbor bond $(0,1)$ carries a weight $\\gamma_{1}\\in[0,1]$, and the next-nearest-neighbor bond $(0,2)$ carries a weight $\\gamma_{2}\\in[0,1]$.\n- The coarse region energy accounts for the remaining energy through a continuum Cauchy–Born energy density but depends only on $F$ (and not on $y_0$).\n\nDefine the ghost force on the interface atom as the residual internal force under the homogeneous deformation, namely $g(F):=f_0(F)$ with\n$$\nf_0(F) \\;=\\; -\\,\\frac{\\partial \\mathcal{E}_{\\mathrm{QC}}}{\\partial y_0}\\Big|_{y_i=Fa\\,i},\n$$\nwhere $\\mathcal{E}_{\\mathrm{QC}}$ is the QC coupling energy described above. Starting from the definition of force as the negative gradient of the potential energy and using only the homogeneity $y_i=Fai$ along with smoothness of $\\phi_1$ and $\\phi_2$, derive a closed-form expression for $g(F)$ in terms of $\\gamma_{1}$, $\\gamma_{2}$, $a$, and the derivatives $\\phi_1'$ and $\\phi_2'$ evaluated at the homogeneous bond lengths. Then, identify the condition on $(\\gamma_{1},\\gamma_{2})$ under which the patch test (vanishing ghost force for any homogeneous $F$) is satisfied, and show that $g(F)$ vanishes under that condition.\n\nReport your final answer as a single analytical expression for $g(F)$ in terms of $\\gamma_1$, $\\gamma_2$, $a$, $\\phi_1'$, and $\\phi_2'$. Do not include units in your final expression. No numerical rounding is required.", "solution": "We begin from the fundamental definition of internal force as the negative gradient of the potential energy with respect to the atomic coordinate. In static equilibrium, the internal force on atom $i$ is\n$$\nf_i \\;=\\; -\\,\\frac{\\partial \\mathcal{E}}{\\partial y_i}.\n$$\nFor a pair potential term $\\phi\\big(|y_j-y_i|\\big)$, the derivative with respect to $y_i$ is obtained via the chain rule:\n$$\n\\frac{\\partial}{\\partial y_i}\\,\\phi\\big(|y_j-y_i|\\big) \\;=\\; \\phi'\\big(|y_j-y_i|\\big)\\,\\frac{\\partial |y_j-y_i|}{\\partial y_i}.\n$$\nIn one dimension under tensile stretch $F>0$, we have $y_j-y_i>0$ whenever $j>i$, so $|y_j-y_i|=y_j-y_i$, and thus\n$$\n\\frac{\\partial}{\\partial y_i}\\,\\phi\\big(y_j-y_i\\big) \\;=\\; -\\,\\phi'\\big(y_j-y_i\\big),\\qquad\n\\frac{\\partial}{\\partial y_j}\\,\\phi\\big(y_j-y_i\\big) \\;=\\; \\phi'\\big(y_j-y_i\\big).\n$$\nHence, each bond $(i,j)$ exerts equal and opposite pair forces of magnitude $\\phi'(y_j-y_i)$ on atoms $i$ and $j$.\n\nWe now specify the quasicontinuum (QC) coupling energy. By construction, the total QC energy may be partitioned as\n$$\n\\mathcal{E}_{\\mathrm{QC}} \\;=\\; \\mathcal{E}_{\\mathcal{A}} \\;+\\; \\mathcal{E}_{\\mathrm{cross}} \\;+\\; \\mathcal{E}_{\\mathcal{C}}(F),\n$$\nwhere:\n- $\\mathcal{E}_{\\mathcal{A}}$ includes all pair interactions fully contained in the atomistic set $\\mathcal{A}=\\{i\\le 0\\}$,\n- $\\mathcal{E}_{\\mathrm{cross}}$ includes the cross-interface bonds with prescribed weights, and\n- $\\mathcal{E}_{\\mathcal{C}}(F)$ is the Cauchy–Born coarse region contribution that depends only on $F$ and not on $y_0$.\n\nOnly terms depending on $y_0$ contribute to $f_0=-\\partial \\mathcal{E}_{\\mathrm{QC}}/\\partial y_0$. Those arise from the bonds attached to $i=0$:\n- Within $\\mathcal{A}$, the bonds $(-1,0)$ and $(-2,0)$ are fully included.\n- Across the interface, the bonds $(0,1)$ and $(0,2)$ are included with weights $\\gamma_1$ and $\\gamma_2$, respectively.\nNo other pair term depends on $y_0$.\n\nThus, writing $r_1:=y_{i+1}-y_i$ and $r_2:=y_{i+2}-y_i$, the $y_0$-dependent part of $\\mathcal{E}_{\\mathrm{QC}}$ is\n$$\n\\mathcal{E}_{\\mathrm{QC}}(y_0;\\,F)\\;=\\;\\phi_1\\big(y_0-y_{-1}\\big)\\;+\\;\\phi_2\\big(y_0-y_{-2}\\big)\\;+\\;\\gamma_1\\,\\phi_1\\big(y_1-y_0\\big)\\;+\\;\\gamma_2\\,\\phi_2\\big(y_2-y_0\\big)\\;+\\;\\text{(terms independent of $y_0$)}.\n$$\nUnder a homogeneous deformation $y_i=F a i$, the relevant bond lengths are\n$$\ny_0-y_{-1}=F a,\\qquad y_0-y_{-2}=2F a,\\qquad y_1-y_0=F a,\\qquad y_2-y_0=2F a.\n$$\nDifferentiating with respect to $y_0$ and applying the negative sign for force, we obtain the contributions:\n- From $(-1,0)$:\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\phi_1\\big(y_0-y_{-1}\\big) \\;=\\; \\phi_1'\\big(F a\\big)\\cdot 1,\\qquad\n\\Rightarrow\\quad f_0^{(-1,0)} \\;=\\; -\\,\\phi_1'\\big(F a\\big).\n$$\n- From $(-2,0)$:\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\phi_2\\big(y_0-y_{-2}\\big) \\;=\\; \\phi_2'\\big(2F a\\big)\\cdot 1,\\qquad\n\\Rightarrow\\quad f_0^{(-2,0)} \\;=\\; -\\,\\phi_2'\\big(2F a\\big).\n$$\n- From $(0,1)$ with weight $\\gamma_1$:\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\gamma_1\\,\\phi_1\\big(y_1-y_0\\big) \\;=\\; \\gamma_1\\,\\phi_1'\\big(F a\\big)\\cdot(-1),\\qquad\n\\Rightarrow\\quad f_0^{(0,1)} \\;=\\; +\\,\\gamma_1\\,\\phi_1'\\big(F a\\big).\n$$\n- From $(0,2)$ with weight $\\gamma_2$:\n$$\n\\frac{\\partial}{\\partial y_0}\\,\\gamma_2\\,\\phi_2\\big(y_2-y_0\\big) \\;=\\; \\gamma_2\\,\\phi_2'\\big(2F a\\big)\\cdot(-1),\\qquad\n\\Rightarrow\\quad f_0^{(0,2)} \\;=\\; +\\,\\gamma_2\\,\\phi_2'\\big(2F a\\big).\n$$\nSumming these contributions and noting that $\\mathcal{E}_{\\mathcal{C}}(F)$ does not depend on $y_0$, we obtain the ghost force on the interface atom under the homogeneous deformation:\n$$\ng(F)\\;=\\;f_0(F)\\;=\\;\\big(\\gamma_1-1\\big)\\,\\phi_1'\\big(F a\\big)\\;+\\;\\big(\\gamma_2-1\\big)\\,\\phi_2'\\big(2F a\\big).\n$$\n\nPatch test condition and vanishing ghost force. The patch test requires that the residual internal force vanish for any homogeneous deformation $F>0$. Since $\\phi_1'$ and $\\phi_2'$ are arbitrary functions of their arguments (depending on material), the only way to have $g(F)=0$ for all $F$ is to enforce\n$$\n\\gamma_1=1,\\qquad \\gamma_2=1,\n$$\nwhich yields\n$$\ng(F)\\;=\\;0\\quad \\text{for all }F>0.\n$$\nThis corresponds to including the cross-interface bonds attached to the interface atom with full atomistic weight, while accounting consistently for the remaining energy in the coarse region so as not to double-count. Under these weights, the homogeneous deformation passes the patch test and ghost forces vanish.", "answer": "$$\\boxed{(\\gamma_{1}-1)\\,\\phi_{1}'(F a)\\;+\\;(\\gamma_{2}-1)\\,\\phi_{2}'(2 F a)}$$", "id": "2780470"}, {"introduction": "The practical power of the QC method comes from its ability to adaptively focus computational effort on regions with complex deformations, such as defects, while treating the rest of the material with an efficient continuum model. This requires a robust strategy for deciding where to refine or coarsen the model. This problem places you in the role of a method designer, tasking you with evaluating and selecting a complete adaptive refinement strategy that correctly identifies regions of high error while maintaining the overall consistency of the simulation. [@problem_id:2780409]", "problem": "An atomistic lattice is coarse-grained by the Quasicontinuum (QC) method to model nanomechanical response near surfaces and defects. Consider a one-dimensional chain of atoms with reference lattice spacing $a_0$, nearest and next-nearest neighbor interactions through a smooth pair potential $\\phi(r)$ truncated at a finite cutoff distance $r_c$, and stored energy\n$$\n\\Pi^{\\mathrm{a}}(y) \\;=\\; \\sum_{i \\in \\mathbb{Z}} \\sum_{j \\in \\mathcal{N}_i} \\tfrac{1}{2}\\,\\phi\\big(|y_j - y_i|\\big),\n$$\nwhere $y_i$ are current atom positions and $\\mathcal{N}_i$ denotes neighbors of atom $i$ within the cutoff $r_c$. In the energy-based Quasicontinuum method (QC), a subset of atoms, called representative atoms (repatoms), is selected, and the deformation is constrained to be piecewise affine between repatoms. The QC total energy is assembled by a summation rule that assigns integer weights $w_k$ to sampled site or bond energies to approximate the full atomistic sum. The Cauchy–Born rule defines a continuum stored energy density $W(F)$ such that, for a homogeneous deformation gradient $F$, the atomistic energy per reference volume equals $W(F)$.\n\nA crucial requirement, known as the patch test, is that under any homogeneous deformation $F$ the QC model must reproduce the atomistic energy and forces exactly (no ghost forces): if $y_i = F\\,x_i$ with $x_i = i a_0$, then the QC internal forces on the repatoms must vanish and the QC energy must equal the atomistic energy.\n\nYou are asked to identify an adaptive refinement strategy for selecting and updating the repatom set that (i) locally enriches resolution near steep deformation gradients or defects and (ii) maintains patch-test consistency at all times. The strategy should be justified from first principles, starting from energy equivalence under the Cauchy–Born rule and the definition of virial stress. Let the local virial stress $\\sigma^{\\mathrm{vir}}$ be defined from the atomistic forces in a control volume, and the Cauchy–Born stress $\\sigma^{\\mathrm{CB}}(F)$ be defined by $\\sigma^{\\mathrm{CB}}(F) = \\partial W(F)/\\partial F$.\n\nWhich of the following strategies satisfies both requirements?\n\nA. Use an energy-based QC with the exact summation rule that counts bonds crossing each coarse element so that the QC energy equals the atomistic energy for any piecewise affine deformation. Define a residual-type error indicator on each coarse element $T$ by\n$$\n\\eta_T^2 \\;=\\; \\big\\|\\sigma^{\\mathrm{vir}}(u_h)\\,-\\,\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|^2\\,|T| \\;+\\; c\\,h_T^2\\,\\|\\nabla(\\nabla u_h)\\|^2,\n$$\nwhere $u_h$ is the QC displacement field, $h_T$ is the element size, $|T|$ is the element measure, and $c>0$ is a constant. Refine elements with $\\eta_T > \\theta_{\\mathrm{ref}}\\max_{K}\\eta_K$ by inserting additional repatoms, coarsen where $\\eta_T < \\theta_{\\mathrm{crs}}\\max_{K}\\eta_K$, and enforce an interaction-aware interface by maintaining an atomistic buffer of thickness at least $r_c$ around defects and along atomistic–continuum boundaries. Retain piecewise affine kinematics and the exact summation rule after each mesh change.\n\nB. Use a force-based QC with linear blending between atomistic and continuum forces. Take the per-element indicator $\\eta_T = \\|\\nabla u_h\\|$ and refine wherever $\\eta_T > \\theta_{\\mathrm{ref}}\\max_K \\eta_K$. For summation, sample a single representative atom per element with weight equal to the element’s number of atoms (lumped quadrature). Do not enforce any special interface buffer; allow repatom spacing to change abruptly across the atomistic–continuum interface.\n\nC. Use an energy-based QC that employs the Cauchy–Born energy density everywhere with no atomistic region. Let the indicator be $\\eta_T = \\|\\nabla(\\nabla u_h)\\|$. Refine where $\\eta_T$ is large, otherwise keep a coarse mesh. Use standard Gauss quadrature for the continuum energy, without bond-based exact summation. No special treatment near defects is used.\n\nD. Use an energy-based QC with the exact summation rule and the indicator $\\eta_T = \\big\\|\\sigma^{\\mathrm{vir}}(u_h)-\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|$. Refine on large $\\eta_T$, but permit coarsening to eliminate the atomistic buffer down to zero thickness when $\\eta_T$ falls below a threshold, even if interactions of range $r_c$ span the interface. Keep kinematics piecewise affine and update weights by element volume only.\n\nSelect the option that is consistent with first principles and meets both goals. Provide reasoning based on the Cauchy–Born relation, virial stress, and the patch-test definition; and address how the chosen summation, kinematics, and interface treatment eliminate ghost forces and how the indicator triggers refinement near steep gradients or defects. Answer with the single best choice.", "solution": "The validity of the problem statement must first be established.\n\n### Step 1: Extract Givens\n- **System**: A one-dimensional chain of atoms.\n- **Lattice spacing (reference)**: $a_0$.\n- **Interactions**: Nearest and next-nearest neighbor interactions via a smooth pair potential $\\phi(r)$ with a finite cutoff distance $r_c$.\n- **Atomistic Stored Energy**: $\\Pi^{\\mathrm{a}}(y) = \\sum_{i \\in \\mathbb{Z}} \\sum_{j \\in \\mathcal{N}_i} \\frac{1}{2}\\,\\phi(|y_j - y_i|)$, where $y_i$ are current positions and $\\mathcal{N}_i$ are neighbors within $r_c$.\n- **QC Method**: Energy-based, selects representative atoms (repatoms), deformation is piecewise affine between repatoms.\n- **QC Energy Approximation**: A summation rule with integer weights $w_k$ approximates the full atomistic sum.\n- **Cauchy–Born (CB) Rule**: Defines a continuum stored energy density $W(F)$ such that for a homogeneous deformation gradient $F$, the atomistic energy per reference volume equals $W(F)$.\n- **Patch Test Requirement**: For any homogeneous deformation $y_i = F\\,x_i$ (with $x_i = i a_0$), the QC model must reproduce the atomistic energy and forces exactly, resulting in zero net internal forces on repatoms (no ghost forces).\n- **Task**: Identify an adaptive refinement strategy for selecting repatoms that (i) enriches resolution near steep deformation gradients or defects and (ii) maintains patch-test consistency.\n- **Definitions**:\n    - Local virial stress: $\\sigma^{\\mathrm{vir}}$, defined from atomistic forces.\n    - Cauchy–Born stress: $\\sigma^{\\mathrm{CB}}(F) = \\partial W(F)/\\partial F$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes a standard and well-established problem in the field of computational materials science, specifically in multiscale modeling using the Quasicontinuum (QC) method.\n- **Scientifically Grounded (Critical)**: The problem is firmly based on the principles of solid mechanics and statistical mechanics. The QC method, Cauchy–Born rule, virial stress, and patch test are all standard, rigorously defined concepts in this domain. The energy formulation is physically correct. The problem is scientifically realistic. It is not based on any pseudoscience or controversial claims.\n- **Well-Posed**: The problem is well-posed. It asks to identify a valid strategy among several options, based on a clear set of physical and mathematical requirements. A unique correct answer can be determined by analyzing the consistency of each option with the given principles.\n- **Objective (Critical)**: The language is precise, technical, and free of subjective or opinion-based statements. All terms ($\\Pi^{\\mathrm{a}}(y)$, $W(F)$, patch test, etc.) have precise mathematical or physical meanings in the context of the field.\n- The setup is self-contained and consistent. It provides all necessary definitions to evaluate the options. It is not trivial or tautological, as it requires a deep understanding of the subtleties of multiscale modeling, particularly the origin of \"ghost forces\" and the conditions for patch-test consistency. The problem is directly relevant to the topic of nanomechanics and the QC method.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically sound, well-posed, objective, and self-contained. I will proceed to solve the problem.\n\n### Solution Derivation\nThe core of the problem lies in satisfying two simultaneous requirements for an adaptive QC method: (i) accurate local resolution and (ii) patch-test consistency.\n\nFirst, let us analyze the patch test requirement. The patch test demands that for any homogeneous deformation, where the displacement field $u(x) = (F-1)x$ is linear and the deformation map $y(x) = Fx$ is affine, the QC model must be exact. This means two things: the QC energy must equal the full atomistic energy, and the force on every repatom must be zero (as they would be in a perfect, uniformly deformed lattice).\n\nIn an energy-based QC method where forces are derived from the potential energy, $f_k = -\\partial \\Pi^{\\mathrm{qc}} / \\partial y_k$, the zero-force condition is a direct consequence of the energy being exact. If $\\Pi^{\\mathrm{qc}}(y) = \\Pi^{\\mathrm{a}}(y)$ for a family of deformations including homogeneous ones, then the derivatives will also match. For a uniformly deformed infinite lattice, the force on any atom is zero by symmetry. Thus, the QC model must reproduce this. The non-zero forces that arise from an inconsistent formulation are known as \"ghost forces\".\n\nGhost forces typically appear at the interface between the atomistic region (where every atom is a repatom) and the continuum region (where repatoms are sparsely distributed). They are a result of an incorrect energy summation. Specifically, for potentials with a cutoff radius $r_c$, atoms near the interface in the continuum region may have neighbors in the atomistic region. If the energy calculation for these continuum atoms does not properly account for all interactions within the radius $r_c$, the total energy is wrong, and spurious forces arise. The standard remedy is two-fold:\n1.  **Exact Summation Rule**: Use a summation rule (like the cluster-based rule) that correctly counts all atomic bonds, including those that cross the boundaries of the finite elements defined by the repatoms.\n2.  **Interface Buffer**: Maintain a full atomistic region (a buffer) of thickness at least $r_c$ around any continuum region. This ensures that any atom treated by continuum assumptions has its full interaction neighborhood also treated explicitly, preventing \"broken\" bonds at the interface.\n\nNext, let us analyze the refinement criterion. The goal is to refine the mesh (i.e., add repatoms) where the continuum approximation is poor. The continuum approximation used in QC is the Cauchy–Born rule. The CB rule is exact only for homogeneous deformations. Therefore, a good error indicator should measure the local deviation from a state of homogeneous deformation.\n\nIn a state of homogeneous deformation with gradient $F$, the atomistic virial stress $\\sigma^{\\mathrm{vir}}$ is equal to the continuum Cauchy–Born stress $\\sigma^{\\mathrm{CB}}(F)$. That is, $\\sigma^{\\mathrm{vir}} - \\sigma^{\\mathrm{CB}}(F) = 0$. When the deformation is not homogeneous, as is the case near a defect or a crack tip, this equality no longer holds. The quantity $\\|\\sigma^{\\mathrm{vir}}(u_h) - \\sigma^{\\mathrm{CB}}(\\nabla u_h)\\|$ therefore serves as an excellent, physically-motivated local error indicator. It directly measures the failure of the underlying physical assumption of the continuum model. A large value indicates that the local deformation is highly non-uniform and cannot be accurately described by a single deformation gradient $F = \\nabla y_h$, so atomistic resolution is required. A term like $\\|\\nabla(\\nabla u_h)\\|$ (or $\\|\\nabla^2 y_h\\|$) which measures the curvature of the displacement field, is also a valid indicator, as high curvature implies a rapidly varying deformation gradient, but the stress-based indicator is more directly tied to the energetics and the CB hypothesis.\n\nWith these principles established, we can evaluate the options.\n\n### Option-by-Option Analysis\n\n**A. Use an energy-based QC with the exact summation rule that counts bonds crossing each coarse element so that the QC energy equals the atomistic energy for any piecewise affine deformation. Define a residual-type error indicator on each coarse element $T$ by $\\eta_T^2 = \\big\\|\\sigma^{\\mathrm{vir}}(u_h)\\,-\\,\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|^2\\,|T| \\;+\\; c\\,h_T^2\\,\\|\\nabla(\\nabla u_h)\\|^2$, where $u_h$ is the QC displacement field, $h_T$ is the element size, $|T|$ is the element measure, and $c>0$ is a constant. Refine elements with $\\eta_T > \\theta_{\\mathrm{ref}}\\max_{K}\\eta_K$ by inserting additional repatoms, coarsen where $\\eta_T < \\theta_{\\mathrm{crs}}\\max_{K}\\eta_K$, and enforce an interaction-aware interface by maintaining an atomistic buffer of thickness at least $r_c$ around defects and along atomistic–continuum boundaries. Retain piecewise affine kinematics and the exact summation rule after each mesh change.**\n\n-   **Patch-Test Consistency**: This strategy explicitly uses an \"exact summation rule\" and maintains an \"atomistic buffer of thickness at least $r_c$\". As derived above, this combination is precisely what is needed to eliminate ghost forces and ensure the patch test is passed at all times, even after adaptivity.\n-   **Refinement Criterion**: The indicator $\\eta_T$ has two components. The primary component, $\\big\\|\\sigma^{\\mathrm{vir}}(u_h)\\,-\\,\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|$, is a direct physical measure of the local failure of the Cauchy-Born approximation, which is the desired behavior for an indicator. It will be large near defects and steep gradients. The second term, $c\\,h_T^2\\,\\|\\nabla(\\nabla u_h)\\|^2$, is a standard term from numerical analysis that penalizes high curvature, also indicative of steep gradients. This dual-term indicator is robust and well-justified.\n-   **Conclusion**: This option presents a complete and correct framework for adaptive QC. It correctly addresses both patch-test consistency and the need for a physically-motivated refinement indicator.\n\n**Verdict: Correct**\n\n**B. Use a force-based QC with linear blending between atomistic and continuum forces. Take the per-element indicator $\\eta_T = \\|\\nabla u_h\\|$ and refine wherever $\\eta_T > \\theta_{\\mathrm{ref}}\\max_K \\eta_K$. For summation, sample a single representative atom per element with weight equal to the element’s number of atoms (lumped quadrature). Do not enforce any special interface buffer; allow repatom spacing to change abruptly across the atomistic–continuum interface.**\n\n-   **Patch-Test Consistency**: This strategy has two fatal flaws regarding the patch test. First, \"lumped quadrature\" (a single sample point per element) is known to fail the patch test for non-local interactions as it does not correctly compute the energy of a uniformly deformed state. Second, and more critically, it explicitly states \"Do not enforce any special interface buffer\". Without a buffer of size $r_c$, interactions across the A/C interface are not correctly computed, leading to large ghost forces. Force-blending schemes are also notoriously difficult to make patch-test consistent without careful construction, which is not described here.\n-   **Refinement Criterion**: The indicator $\\eta_T = \\|\\nabla u_h\\|$ is the local strain magnitude. While large strain often correlates with the need for refinement, it is not a direct measure of the *error* in the continuum model. The CB approximation can be valid even for large strains if the deformation is homogeneous. This indicator is less sophisticated and less reliable than the one in Option A.\n-   **Conclusion**: This option fails the crucial requirement of maintaining patch-test consistency.\n\n**Verdict: Incorrect**\n\n**C. Use an energy-based QC that employs the Cauchy–Born energy density everywhere with no atomistic region. Let the indicator be $\\eta_T = \\|\\nabla(\\nabla u_h)\\|$. Refine where $\\eta_T$ is large, otherwise keep a coarse mesh. Use standard Gauss quadrature for the continuum energy, without bond-based exact summation. No special treatment near defects is used.**\n\n-   **Methodology**: This describes a pure non-linear Finite Element Method (FEM) using a CB-derived constitutive model. It is not a multiscale QC method because it has \"no atomistic region\". The entire purpose of adaptive QC is to introduce atomistic resolution where the continuum model (i.e., the CB rule) fails, such as at the core of a defect. This method cannot do that; it assumes the CB rule is valid everywhere, which is false for problems with defects.\n-   **Patch-Test Consistency**: A pure FEM model using the CB energy density will pass the patch test by construction, but this is irrelevant as it is not the correct type of model for the stated problem.\n-   **Refinement Criterion**: The indicator $\\|\\nabla(\\nabla u_h)\\|$ would trigger mesh refinement (creating smaller finite elements), but not a switch to a more fundamental atomistic model.\n-   **Conclusion**: This is not an adaptive quasicontinuum method capable of modeling defects. It fails to meet the fundamental requirement of locally enriching resolution with an atomistic model.\n\n**Verdict: Incorrect**\n\n**D. Use an energy-based QC with the exact summation rule and the indicator $\\eta_T = \\big\\|\\sigma^{\\mathrm{vir}}(u_h)-\\sigma^{\\mathrm{CB}}(\\nabla u_h)\\big\\|$. Refine on large $\\eta_T$, but permit coarsening to eliminate the atomistic buffer down to zero thickness when $\\eta_T$ falls below a threshold, even if interactions of range $r_c$ span the interface. Keep kinematics piecewise affine and update weights by element volume only.**\n\n-   **Patch-Test Consistency**: This option proposes to \"eliminate the atomistic buffer down to zero thickness... even if interactions of range $r_c$ span the interface\". This is a direct violation of the conditions required for patch-test consistency. As soon as the buffer is removed, atoms at the newly formed sharp interface will have incomplete interaction neighborhoods, their energies will be computed incorrectly, and significant ghost forces will be generated. The patch test will fail. The statement about updating weights \"by element volume only\" also suggests a move away from the \"exact summation rule\" upon coarsening, which is another source of error.\n-   **Refinement Criterion**: The indicator $\\eta_T$ is the physically correct, stress-based one. However, a good indicator cannot salvage a method that is fundamentally inconsistent.\n-   **Conclusion**: Although the refinement indicator is well-chosen, the coarsening strategy and interface treatment are incorrect and would re-introduce the very ghost forces the method is supposed to eliminate, failing the patch-test consistency requirement.\n\n**Verdict: Incorrect**\n\nBased on this analysis, only option A describes a theoretically sound and complete adaptive quasicontinuum strategy that satisfies both stated requirements.", "answer": "$$\\boxed{A}$$", "id": "2780409"}]}