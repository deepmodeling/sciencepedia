{"hands_on_practices": [{"introduction": "The most fundamental principle connecting the atomistic and continuum worlds is that macroscopic stiffness arises directly from the curvature of the interatomic potential. This exercise guides you through a first-principles derivation to quantify this link for a simple crystal's bulk modulus, $B$. By comparing two common potential models, the Lennard-Jones and Morse potentials, you will gain a concrete understanding of how the shape of the potential well dictates the material's elastic response [@problem_id:2765203].", "problem": "A monatomic face-centered cubic (fcc) crystal is modeled by a central pair potential with only nearest-neighbor interactions contributing to the cohesive energy. Two alternative interatomic potentials are considered:\n\n1) The Lennard–Jones potential, given by $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$.\n\n2) The Morse potential, given by $U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$.\n\nAssume the following modeling choices:\n- The cohesive well depths are matched: $D = \\epsilon$.\n- The equilibrium nearest-neighbor distance is matched by choosing the Morse parameter $r_{0}$ equal to the Lennard–Jones equilibrium separation.\n- Zero temperature and hydrostatic loading are assumed. The fcc coordination number is $z=12$, the nearest-neighbor distance is related to the cubic lattice parameter by $r = a/\\sqrt{2}$, and the per-atom volume is $\\Omega = a^{3}/4$.\n\nStarting from first principles, use the following standard bases only: Newtonian mechanics, the definition of strain, pairwise additivity of energy, and the thermodynamic definition of the bulk modulus $B$ as the second derivative of the energy with respect to volume at equilibrium. Proceed as follows:\n- Determine the equilibrium separation $r_{\\mathrm{LJ}}$ that minimizes $U_{\\mathrm{LJ}}(r)$.\n- Compute the curvatures $U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ and $U_{\\mathrm{M}}''(r_{0})$ at their respective minima.\n- Derive the bulk modulus $B$ of the fcc crystal in terms of the pair potential curvature at the equilibrium nearest-neighbor distance and the lattice geometry, under the stated nearest-neighbor approximation.\n- Using the matched-depth and matched-distance conditions, determine the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ as a closed-form analytic expression in terms of the parameters $\\alpha$ and $\\sigma$ only.\n\nProvide your final answer as a single closed-form analytic expression for the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$. Do not include units in the final boxed answer.", "solution": "The problem requires the determination of the ratio of the bulk moduli, $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$, for a face-centered cubic (fcc) crystal modeled with Lennard-Jones (LJ) and Morse (M) pair potentials, respectively. The analysis will proceed from first principles, under a nearest-neighbor interaction approximation.\n\nFirst, the given interatomic potentials are:\nThe Lennard-Jones potential: $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$.\nThe Morse potential: $U_{\\mathrm{M}}(r) = D \\left\\{ \\left[ 1 - \\exp\\left( -\\alpha (r - r_{0}) \\right) \\right]^{2} - 1 \\right\\}$.\n\nThe problem specifies the following matching conditions: the potential well depths are equal, $D = \\epsilon$, and the equilibrium separation for the Morse potential, $r_{0}$, is set to the equilibrium separation of the LJ potential, which we denote $r_{\\mathrm{LJ}}$.\n\nThe solution proceeds in four stages as mandated:\n1.  Determine the equilibrium separation $r_{\\mathrm{LJ}}$ for the Lennard-Jones potential.\n2.  Calculate the second derivatives (curvatures) of both potentials, $U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})$ and $U_{\\mathrm{M}}''(r_{0})$, at their respective equilibrium separations.\n3.  Derive a general expression for the bulk modulus $B$ of an fcc crystal within the nearest-neighbor approximation.\n4.  Combine these results to find the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$.\n\n**Step 1: Equilibrium Separation of the Lennard-Jones Potential**\n\nThe equilibrium separation $r_{\\mathrm{LJ}}$ is the interatomic distance that minimizes the potential energy $U_{\\mathrm{LJ}}(r)$. This is found by setting the first derivative of the potential with respect to $r$ to zero.\n$$ \\frac{dU_{\\mathrm{LJ}}}{dr} = 4 \\epsilon \\left[ \\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7} \\right] $$\nSetting $\\frac{dU_{\\mathrm{LJ}}}{dr} = 0$:\n$$ 4 \\epsilon \\left[ -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^{6}}{r^{7}} \\right] = 0 $$\n$$ 6 \\frac{\\sigma^{6}}{r^{7}} = 12 \\frac{\\sigma^{12}}{r^{13}} $$\nThis simplifies to $r^{6} = 2\\sigma^{6}$, which yields the equilibrium separation:\n$$ r_{\\mathrm{LJ}} = 2^{1/6} \\sigma $$\n\n**Step 2: Curvature of the Potentials at Equilibrium**\n\nFirst, we find the second derivative of the Lennard-Jones potential, $U_{\\mathrm{LJ}}''(r)$.\n$$ U_{\\mathrm{LJ}}''(r) = \\frac{d^2 U_{\\mathrm{LJ}}}{dr^2} = 4 \\epsilon \\left[ (-12)(-13)\\sigma^{12}r^{-14} - (6)(-7)\\sigma^{6}r^{-8} \\right] $$\n$$ U_{\\mathrm{LJ}}''(r) = 4 \\epsilon \\left[ 156 \\frac{\\sigma^{12}}{r^{14}} - 42 \\frac{\\sigma^{6}}{r^{8}} \\right] $$\nWe evaluate this at $r = r_{\\mathrm{LJ}} = 2^{1/6} \\sigma$. At this distance, we have the relations $r_{\\mathrm{LJ}}^{6} = 2\\sigma^{6}$ and $r_{\\mathrm{LJ}}^{12} = 4\\sigma^{12}$.\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{r_{\\mathrm{LJ}}^{2}} \\left[ 156 \\frac{\\sigma^{12}}{r_{\\mathrm{LJ}}^{12}} - 42 \\frac{\\sigma^{6}}{r_{\\mathrm{LJ}}^{6}} \\right] = \\frac{4\\epsilon}{(2^{1/6}\\sigma)^{2}} \\left[ 156 \\left(\\frac{1}{4}\\right) - 42 \\left(\\frac{1}{2}\\right) \\right] $$\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{4\\epsilon}{2^{1/3}\\sigma^{2}} \\left[ 39 - 21 \\right] = \\frac{4\\epsilon(18)}{2^{1/3}\\sigma^{2}} = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n\nNext, we find the second derivative of the Morse potential, $U_{\\mathrm{M}}''(r)$. The first derivative is:\n$$ U_{\\mathrm{M}}'(r) = D \\cdot 2\\left[1 - \\exp\\left(-\\alpha(r-r_0)\\right)\\right] \\cdot \\left( \\alpha \\exp\\left(-\\alpha(r-r_0)\\right) \\right) $$\n$$ U_{\\mathrm{M}}'(r) = 2D\\alpha \\left[ \\exp\\left(-\\alpha(r-r_0)\\right) - \\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\nThe second derivative is:\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha \\left[ -\\alpha\\exp\\left(-\\alpha(r-r_0)\\right) - (-2\\alpha)\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\n$$ U_{\\mathrm{M}}''(r) = 2D\\alpha^{2} \\left[ -\\exp\\left(-\\alpha(r-r_0)\\right) + 2\\exp\\left(-2\\alpha(r-r_0)\\right) \\right] $$\nThe equilibrium separation for the Morse potential is at $r=r_0$. Evaluating the curvature at this point:\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^{2} \\left[ -\\exp(0) + 2\\exp(0) \\right] = 2D\\alpha^{2} \\left[ -1 + 2 \\right] = 2D\\alpha^{2} $$\n\n**Step 3: Derivation of the Bulk Modulus**\n\nThe total energy per atom, $E$, in a nearest-neighbor model is $E = \\frac{1}{2}z U(r)$, where $z$ is the coordination number. For an fcc lattice, $z=12$, so $E(r) = 6U(r)$. The bulk modulus at zero temperature is defined as $B = \\Omega_0 \\left( \\frac{d^2 E}{d\\Omega^2} \\right)_{\\Omega=\\Omega_0}$, where $\\Omega$ is the volume per atom and $\\Omega_0$ is the equilibrium volume per atom.\n\nFor an fcc lattice, the nearest-neighbor distance $r$ is related to the cubic lattice parameter $a$ by $r=a/\\sqrt{2}$. The volume per atom is $\\Omega = a^3/4$. We express $\\Omega$ in terms of $r$:\n$$ a = r\\sqrt{2} \\implies \\Omega(r) = \\frac{(r\\sqrt{2})^3}{4} = \\frac{2\\sqrt{2}r^3}{4} = \\frac{r^3}{\\sqrt{2}} $$\nWe now compute the derivatives using the chain rule.\n$$ \\frac{dE}{d\\Omega} = \\frac{dE/dr}{d\\Omega/dr} = \\frac{6 U'(r)}{3r^2/\\sqrt{2}} = \\frac{2\\sqrt{2}U'(r)}{r^2} $$\nThe second derivative is:\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{d}{d\\Omega}\\left( \\frac{dE}{d\\Omega} \\right) = \\frac{d/dr(dE/d\\Omega)}{d\\Omega/dr} = \\frac{\\frac{d}{dr}\\left(\\frac{2\\sqrt{2}U'(r)}{r^2}\\right)}{3r^2/\\sqrt{2}} $$\n$$ \\frac{d^2E}{d\\Omega^2} = \\frac{2\\sqrt{2} \\left( \\frac{U''(r)r^2 - 2rU'(r)}{r^4} \\right)}{3r^2/\\sqrt{2}} = \\frac{4}{3r^5} \\left( rU''(r) - 2U'(r) \\right) $$\nAt equilibrium, $r=r_e$, the first derivative of the potential is zero, $U'(r_e)=0$. Thus, the expression simplifies to:\n$$ \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{4}{3r_e^5} \\left( r_e U''(r_e) \\right) = \\frac{4U''(r_e)}{3r_e^4} $$\nThe equilibrium volume is $\\Omega_0 = r_e^3/\\sqrt{2}$. Substituting into the definition of $B$:\n$$ B = \\Omega_0 \\left( \\frac{d^2E}{d\\Omega^2} \\right)_{\\Omega_0} = \\frac{r_e^3}{\\sqrt{2}} \\cdot \\frac{4U''(r_e)}{3r_e^4} = \\frac{4U''(r_e)}{3\\sqrt{2}r_e} = \\frac{2\\sqrt{2}U''(r_e)}{3r_e} $$\n\n**Step 4: Ratio of Bulk Moduli**\n\nUsing the derived expression for $B$, the ratio $B_{\\mathrm{LJ}}/B_{\\mathrm{M}}$ is:\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{2\\sqrt{2}U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{3r_{\\mathrm{LJ}}} }{ \\frac{2\\sqrt{2}U_{\\mathrm{M}}''(r_{0})}{3r_{0}} } $$\nGiven the condition $r_{\\mathrm{LJ}} = r_{0}$, the geometric factors cancel, and the ratio simplifies to the ratio of the potential curvatures:\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}})}{U_{\\mathrm{M}}''(r_{0})} $$\nSubstituting the calculated curvatures and using the condition $D = \\epsilon$:\n$$ U_{\\mathrm{LJ}}''(r_{\\mathrm{LJ}}) = \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} $$\n$$ U_{\\mathrm{M}}''(r_0) = 2D\\alpha^2 = 2\\epsilon\\alpha^2 $$\nThe ratio is therefore:\n$$ \\frac{B_{\\mathrm{LJ}}}{B_{\\mathrm{M}}} = \\frac{ \\frac{72\\epsilon}{2^{1/3}\\sigma^{2}} }{ 2\\epsilon\\alpha^2 } = \\frac{72}{2 \\cdot 2^{1/3} \\alpha^2 \\sigma^2} = \\frac{36}{2^{1/3} \\alpha^2 \\sigma^2} $$\nThis is the final analytical expression for the ratio in terms of the specified parameters $\\alpha$ and $\\sigma$.", "answer": "$$\\boxed{\\frac{36}{2^{1/3} \\alpha^{2} \\sigma^{2}}}$$", "id": "2765203"}, {"introduction": "Real materials are rarely perfect crystals; their properties are often dominated by interfaces such as grain boundaries. This practice explores the elastic behavior of nanocrystalline materials, treating them as a composite of grain interiors and more compliant boundary regions. You will derive a model for the size-dependent effective compliance, $S_{eff}(d)$, and use it to analyze simulated data, a core skill in connecting atomistic simulations with mesoscale material models [@problem_id:2765142].", "problem": "A nanocrystalline metal can be modeled as a two-phase composite of grain interiors and grain boundary regions. At small strain, assume linear elasticity and uniaxial loading so that Hooke’s law applies. Under an isostress assumption appropriate to a polycrystal with load transmitted across many grains, the overall uniaxial strain is the volume-average of the local strains. Consider equiaxed grains approximated as spheres of diameter $d$ with a grain boundary shell of thickness $t$, such that the boundary volume fraction is $f_{gb}(d)$. The effective uniaxial compliance is $S_{eff}(d) \\equiv 1/E_{eff}(d)$, the grain interior (bulk) compliance is $S_{bulk} \\equiv 1/E_{bulk}$, and the grain boundary compliance is $S_{gb} \\equiv 1/E_{gb}$. The atomistically “direct” bicrystal boundary calculation provides $E_{gb}$ for a representative boundary, to be compared with the value inferred from size-dependent effective moduli of nanocrystals.\n\nStarting only from Hooke’s law, the isostress mixture definition (volume-average strain under uniform stress), and the geometric expression for the boundary shell volume fraction of a sphere of diameter $d$ and shell thickness $t$, derive the leading-order dependence of $S_{eff}(d)$ on $1/d$ in the limit $t/d \\ll 1$. Use this leading-order dependence to fit the grain boundary compliance $S_{gb}$ from simulated datasets of $E_{eff}(d)$.\n\nGeometric base: For a spherical grain of diameter $d$ with a concentric shell of thickness $t$, the exact boundary volume fraction is given by\n$$\nf_{gb}(d) \\;=\\; 1 - \\left(1 - \\frac{2t}{d}\\right)^3.\n$$\n\nData generation protocol (to emulate atomistic simulation outputs deterministically): For each test case, let $S_{bulk} = 1/E_{bulk}$ and $S_{gb}^{direct} = 1/E_{gb}^{direct}$. For each listed diameter $d_i$, compute the exact $f_{gb}(d_i)$ from the above geometry. Then compute the “true” effective compliance\n$$\nS_{eff}^{true}(d_i) \\;=\\; (1 - f_{gb}(d_i))\\, S_{bulk} + f_{gb}(d_i)\\, S_{gb}^{direct},\n$$\nand form the “measured” effective compliance by adding a small, fixed perturbation $\\varepsilon_i$ (provided below, in units of $1/\\mathrm{GPa}$) to emulate finite-sampling noise:\n$$\nS_{eff}^{meas}(d_i) \\;=\\; S_{eff}^{true}(d_i) + \\varepsilon_i.\n$$\nFinally, define the “measured” effective modulus via\n$$\nE_{eff}^{meas}(d_i) \\;=\\; \\frac{1}{S_{eff}^{meas}(d_i)}.\n$$\n\nFitting requirement: Assuming $t/d \\ll 1$, use only the leading-order dependence of $S_{eff}(d)$ on $1/d$ that follows from the above bases to build a linear model in $1/d$. Fit this linear model by ordinary least squares to the data $\\{(d_i, E_{eff}^{meas}(d_i))\\}$ after converting to compliance $S_{eff}^{meas}(d_i) = 1/E_{eff}^{meas}(d_i)$. From the fitted slope and the known thickness $t$, extract an estimate $\\widehat{S}_{gb}$ and convert it to an absolute difference from the direct bicrystal value $\\Delta = |\\widehat{S}_{gb} - S_{gb}^{direct}|$.\n\nUnits: All moduli $E$ must be treated in gigapascals (GPa), thicknesses and grain sizes in nanometers (nm), and compliances $S$ in $1/\\mathrm{GPa}$. All final reported differences $\\Delta$ must be in $1/\\mathrm{GPa}$.\n\nAngles are not used. Do not use percentages; any ratio should be expressed as a decimal.\n\nTest suite: Use the following three cases. In all cases, take $t = 0.1666666667 \\,\\mathrm{nm}$.\n\n- Case 1:\n    - $E_{bulk} = 200\\,\\mathrm{GPa}$, $E_{gb}^{direct} = 120\\,\\mathrm{GPa}$\n    - Diameters (nm): $[5.0,\\;7.5,\\;10.0,\\;15.0,\\;25.0,\\;50.0,\\;100.0]$\n    - Compliance perturbations $\\varepsilon_i$ ($1/\\mathrm{GPa}$): $[-1.0\\times 10^{-5},\\;2.0\\times 10^{-5},\\;0.0,\\;-2.0\\times 10^{-5},\\;1.0\\times 10^{-5},\\;0.0,\\;1.0\\times 10^{-5}]$\n\n- Case 2:\n    - $E_{bulk} = 200\\,\\mathrm{GPa}$, $E_{gb}^{direct} = 190\\,\\mathrm{GPa}$\n    - Diameters (nm): $[5.0,\\;6.0,\\;8.0,\\;12.0,\\;20.0,\\;40.0,\\;80.0]$\n    - Compliance perturbations $\\varepsilon_i$ ($1/\\mathrm{GPa}$): $[2.0\\times 10^{-6},\\;-3.0\\times 10^{-6},\\;0.0,\\;4.0\\times 10^{-6},\\;-2.0\\times 10^{-6},\\;0.0,\\;1.0\\times 10^{-6}]$\n\n- Case 3:\n    - $E_{bulk} = 70\\,\\mathrm{GPa}$, $E_{gb}^{direct} = 35\\,\\mathrm{GPa}$\n    - Diameters (nm): $[5.0,\\;7.0,\\;9.0,\\;12.0,\\;16.0,\\;30.0,\\;60.0]$\n    - Compliance perturbations $\\varepsilon_i$ ($1/\\mathrm{GPa}$): $[0.0,\\;5.0\\times 10^{-5},\\;-5.0\\times 10^{-5},\\;0.0,\\;2.0\\times 10^{-5},\\;-2.0\\times 10^{-5},\\;0.0]$\n\nTask: Implement a program that performs the above procedure for each case, fits the leading-order linear model in $1/d$, and returns, for each case, the absolute difference $\\Delta$ between the fitted $\\widehat{S}_{gb}$ and the direct $S_{gb}^{direct}$, in units of $1/\\mathrm{GPa}$, rounded to ten decimal places.\n\nFinal output format: Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3]\"), where each $x_k$ is the rounded float described above.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of continuum mechanics and materials science, specifically the theory of elasticity in composite materials as applied to nanocrystals. The problem is well-posed, with all necessary data, assumptions, and procedures clearly defined, leading to a unique and meaningful solution. It is stated objectively and is free from any scientific flaws, ambiguities, or contradictions.\n\nThe solution proceeds in two stages: first, the derivation of the theoretical model, and second, the application of this model to fit the provided data and extract the required parameter.\n\n**1. Theoretical Derivation of the Linear Model**\n\nThe problem is based on the isostress (or Reuss) model for a two-phase composite. Under a uniform uniaxial stress $\\sigma$, the total strain $\\varepsilon_{eff}$ is the volume-weighted average of the strains in the grain interior (bulk, subscript $b$) and the grain boundary (subscript $gb$).\n\nAccording to Hooke's law in one dimension, the strain $\\varepsilon$ is related to stress $\\sigma$ via the compliance $S$ as $\\varepsilon = S\\sigma$. Thus, the strains in the two phases are:\n$$\n\\varepsilon_b = S_{bulk} \\sigma\n$$\n$$\n\\varepsilon_{gb} = S_{gb} \\sigma\n$$\nThe volume fraction of the grain interiors is $f_b = 1 - f_{gb}(d)$, and the effective strain is:\n$$\n\\varepsilon_{eff} = (1 - f_{gb}(d))\\varepsilon_b + f_{gb}(d)\\varepsilon_{gb}\n$$\nSubstituting the expressions for the phase strains:\n$$\n\\varepsilon_{eff} = [(1 - f_{gb}(d))S_{bulk} + f_{gb}(d)S_{gb}] \\sigma\n$$\nThe effective compliance $S_{eff}(d)$ is defined by $\\varepsilon_{eff} = S_{eff}(d)\\sigma$. Therefore, we arrive at the rule of mixtures for compliance:\n$$\nS_{eff}(d) = (1 - f_{gb}(d))S_{bulk} + f_{gb}(d)S_{gb}\n$$\nThis can be rearranged to highlight the contribution of the grain boundaries:\n$$\nS_{eff}(d) = S_{bulk} + f_{gb}(d)(S_{gb} - S_{bulk})\n$$\nThe problem provides the geometric expression for the volume fraction of a spherical shell of thickness $t$ around a sphere of diameter $d$:\n$$\nf_{gb}(d) = 1 - \\left(1 - \\frac{2t}{d}\\right)^3\n$$\nWe are asked to find the leading-order dependence on $1/d$ in the limit $t/d \\ll 1$. Let $x = 2t/d$. We perform a Taylor expansion of $f_{gb} = 1 - (1-x)^3$ for small $x$:\n$$\n(1-x)^3 = 1 - 3x + 3x^2 - x^3 + \\dots\n$$\nSubstituting this into the expression for $f_{gb}$:\n$$\nf_{gb}(d) = 1 - \\left(1 - 3\\left(\\frac{2t}{d}\\right) + 3\\left(\\frac{2t}{d}\\right)^2 - \\left(\\frac{2t}{d}\\right)^3\\right) = \\frac{6t}{d} - \\frac{12t^2}{d^2} + \\frac{8t^3}{d^3}\n$$\nThe leading-order term in an expansion in powers of $1/d$ is the one with the lowest power of $d$ in the denominator. This is the term proportional to $1/d$.\n$$\nf_{gb}(d) \\approx \\frac{6t}{d}\n$$\nSubstituting this leading-order approximation into the equation for $S_{eff}(d)$:\n$$\nS_{eff}(d) \\approx S_{bulk} + \\frac{6t}{d}(S_{gb} - S_{bulk})\n$$\nThis equation represents a linear relationship between $S_{eff}(d)$ and the inverse grain size $1/d$. It can be written in the standard linear form $y = A + Bx$:\n$$\nS_{eff}(d) \\approx S_{bulk} + [6t(S_{gb} - S_{bulk})] \\cdot \\frac{1}{d}\n$$\nHere, the dependent variable is $y = S_{eff}(d)$, the independent variable is $x = 1/d$, the intercept is $A = S_{bulk}$, and the slope is $B = 6t(S_{gb} - S_{bulk})$.\n\n**2. Parameter Extraction Procedure**\n\nThe task is to fit this linear model to the \"measured\" data $(x_i, y_i) = (1/d_i, S_{eff}^{meas}(d_i))$ using ordinary least squares (OLS). The OLS procedure yields estimates for the slope, $\\widehat{B}$, and the intercept, $\\widehat{A}$.\n\nAccording to the derived model, the slope is related to the grain boundary compliance $S_{gb}$. We are asked to extract an estimate for $S_{gb}$, which we denote $\\widehat{S}_{gb}$, from the fitted slope $\\widehat{B}$.\n$$\n\\widehat{B} = 6t(\\widehat{S}_{gb} - S_{bulk})\n$$\nThe grain boundary thickness $t$ and the bulk compliance $S_{bulk}$ (from the given $E_{bulk}$) are known constants. We can rearrange the equation to solve for $\\widehat{S}_{gb}$:\n$$\n\\frac{\\widehat{B}}{6t} = \\widehat{S}_{gb} - S_{bulk}\n$$\n$$\n\\widehat{S}_{gb} = S_{bulk} + \\frac{\\widehat{B}}{6t}\n$$\nFinally, we must calculate the absolute difference $\\Delta$ between this fitted value and the \"direct\" value $S_{gb}^{direct}$ provided in each test case.\n$$\n\\Delta = |\\widehat{S}_{gb} - S_{gb}^{direct}|\n$$\n\n**3. Computational Algorithm**\n\nFor each test case, the following steps are executed:\n1.  Initialize the given constants for the case: $E_{bulk}$, $E_{gb}^{direct}$, the list of diameters $d_i$, and the list of perturbations $\\varepsilon_i$. The thickness is constant for all cases: $t = 0.1666666667 \\, \\mathrm{nm}$.\n2.  Calculate the base compliances: $S_{bulk} = 1/E_{bulk}$ and $S_{gb}^{direct} = 1/E_{gb}^{direct}$.\n3.  Generate the dataset for regression. Iterate through the provided diameters $d_i$ and perturbations $\\varepsilon_i$:\n    a. Calculate the exact grain boundary volume fraction: $f_{gb}(d_i) = 1 - (1 - 2t/d_i)^3$.\n    b. Calculate the \"true\" effective compliance: $S_{eff}^{true}(d_i) = (1 - f_{gb}(d_i))S_{bulk} + f_{gb}(d_i)S_{gb}^{direct}$.\n    c. Calculate the \"measured\" effective compliance: $S_{eff}^{meas}(d_i) = S_{eff}^{true}(d_i) + \\varepsilon_i$.\n    d. Store the pair $(1/d_i, S_{eff}^{meas}(d_i))$ as one data point for the linear fit.\n4.  Perform a linear regression on the generated dataset of $(x_i, y_i) = (1/d_i, S_{eff}^{meas}(d_i))$ to find the best-fit slope, $\\widehat{B}$. This is achieved using a standard numerical routine for OLS, such as `numpy.polyfit`.\n5.  Use the fitted slope $\\widehat{B}$ to calculate the estimated grain boundary compliance: $\\widehat{S}_{gb} = S_{bulk} + \\widehat{B} / (6t)$.\n6.  Compute the final result for the test case, the absolute difference: $\\Delta = |\\widehat{S}_{gb} - S_{gb}^{direct}|$.\n7.  The computed $\\Delta$ values for all test cases are collected and formatted as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nanomechanics problem for three test cases.\n    For each case, it generates simulated data, fits a linear model derived\n    from first principles, extracts the grain boundary compliance, and\n    calculates the error compared to the ground truth value.\n    \"\"\"\n    \n    # Constant grain boundary thickness for all cases (in nm).\n    t = 0.1666666667\n\n    test_cases = [\n        {\n            \"E_bulk\": 200.0,  # GPa\n            \"E_gb_direct\": 120.0,  # GPa\n            \"diameters\": np.array([5.0, 7.5, 10.0, 15.0, 25.0, 50.0, 100.0]), # nm\n            \"epsilons\": np.array([-1.0e-5, 2.0e-5, 0.0, -2.0e-5, 1.0e-5, 0.0, 1.0e-5]) # 1/GPa\n        },\n        {\n            \"E_bulk\": 200.0,\n            \"E_gb_direct\": 190.0,\n            \"diameters\": np.array([5.0, 6.0, 8.0, 12.0, 20.0, 40.0, 80.0]),\n            \"epsilons\": np.array([2.0e-6, -3.0e-6, 0.0, 4.0e-6, -2.0e-6, 0.0, 1.0e-6])\n        },\n        {\n            \"E_bulk\": 70.0,\n            \"E_gb_direct\": 35.0,\n            \"diameters\": np.array([5.0, 7.0, 9.0, 12.0, 16.0, 30.0, 60.0]),\n            \"epsilons\": np.array([0.0, 5.0e-5, -5.0e-5, 0.0, 2.0e-5, -2.0e-5, 0.0])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract case parameters\n        E_bulk = case[\"E_bulk\"]\n        E_gb_direct = case[\"E_gb_direct\"]\n        diameters = case[\"diameters\"]\n        epsilons = case[\"epsilons\"]\n\n        # Convert moduli (GPa) to compliances (1/GPa)\n        S_bulk = 1.0 / E_bulk\n        S_gb_direct = 1.0 / E_gb_direct\n\n        # --- Data Generation Step ---\n        # Generate the dataset for linear regression.\n        # x_data will be inverse diameters (1/nm)\n        # y_data will be measured effective compliances (1/GPa)\n        \n        # Calculate grain boundary volume fraction f_gb\n        # f_gb = 1 - (1 - 2t/d)^3\n        f_gb_vals = 1.0 - (1.0 - 2.0 * t / diameters)**3\n\n        # Calculate \"true\" effective compliance S_eff_true\n        # S_eff_true = (1 - f_gb) * S_bulk + f_gb * S_gb_direct\n        S_eff_true_vals = (1.0 - f_gb_vals) * S_bulk + f_gb_vals * S_gb_direct\n\n        # Calculate \"measured\" effective compliance S_eff_meas by adding noise\n        S_eff_meas_vals = S_eff_true_vals + epsilons\n        \n        y_data = S_eff_meas_vals\n        x_data = 1.0 / diameters\n        \n        # --- Fitting Step ---\n        # Perform ordinary least squares linear regression to find the slope.\n        # The model is y = slope * x + intercept.\n        # np.polyfit returns [slope, intercept] for degree 1.\n        slope, _ = np.polyfit(x_data, y_data, 1)\n\n        # --- Parameter Extraction Step ---\n        # From the derived model, slope = 6*t*(S_gb - S_bulk).\n        # We solve for the estimated grain boundary compliance, S_gb_hat.\n        S_gb_hat = S_bulk + slope / (6.0 * t)\n\n        # --- Final Calculation Step ---\n        # Calculate the absolute difference between the estimated and direct values.\n        delta = abs(S_gb_hat - S_gb_direct)\n        \n        # Round to ten decimal places as required.\n        results.append(round(delta, 10))\n\n    # Print the final result in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2765142"}, {"introduction": "Bridging the atomistic and continuum scales is a central challenge in materials science, and Eshelby's inclusion theory offers a powerful framework for this task. In this exercise, you will analyze the displacement field around a coherent nanoprecipitate—a common feature in advanced alloys—using Eshelby's model. By fitting atomistic data to the continuum solution, you will extract the precipitate's intrinsic misfit, or 'eigenstrain' $\\varepsilon^{\\star}$, and predict the associated elastic energy, linking a microscopic defect structure to macroscopic mechanical properties [@problem_id:2765161].", "problem": "You must write a complete, runnable program that, given synthetic atomistic observations of far-field radial displacements around a coherent, spherical nanoprecipitate in an infinite, linear elastic, isotropic matrix, extracts an effective uniform hydrostatic eigenstrain and compares the predicted elastic energy from continuum Eshelby theory with a provided measured elastic energy. Your derivation and algorithm must begin from the fundamental base of linear elasticity: small-strain kinematics, Hooke’s law for isotropic media, mechanical equilibrium, and spherical symmetry. No additional shortcut formulas are provided in the problem statement.\n\nAssumptions and physical setting:\n- The medium is infinite, homogeneous, linear elastic, isotropic, with bulk modulus $K$ and shear modulus $\\mu$.\n- There is a coherent, spherical inclusion of radius $a$ that tends to undergo a uniform hydrostatic eigenstrain $\\varepsilon^\\star$.\n- Under small strains, the displacement field is spherically symmetric about the inclusion center. Outside the inclusion, the far-field displacement is radial and decays with distance.\n- The atomistic simulation provides radial displacement observations sufficiently far from the inclusion to be in the elastic far-field regime.\n- Use the standard small-strain tensor definition $\\varepsilon_{ij} = \\tfrac{1}{2}\\left(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i\\right)$ and the isotropic Hooke’s law with Lamé moduli $(\\lambda, \\mu)$, where $K = \\lambda + \\tfrac{2}{3}\\mu$, and static equilibrium with no body forces.\n\nYour tasks:\n1) From the fundamental base, deduce the functional form of the far-field radial displacement $u_r(r)$ outside a spherical inclusion under uniform hydrostatic eigenstrain $\\varepsilon^\\star$. Then design a linear least-squares fit that uses the supplied far-field atomistic radial displacement observations to estimate an effective uniform constrained strain inside the inclusion, and from it extract an estimate of the eigenstrain $\\widehat{\\varepsilon}^\\star$.\n2) Using the same first-principles framework, derive a closed-form expression for the total elastic energy $E_{\\text{pred}}$ stored in the matrix-plus-inclusion system as a function of the inclusion radius $a$, the elastic constants $K$ and $\\mu$, and the eigenstrain $\\varepsilon^\\star$.\n3) Implement an algorithm that:\n   - Converts all inputs to consistent physical units.\n   - Performs a linear least-squares fit of the far-field displacement observations to extract $\\widehat{\\varepsilon}^\\star$.\n   - Computes the predicted elastic energy $E_{\\text{pred}}$ from $\\widehat{\\varepsilon}^\\star$.\n   - Compares $E_{\\text{pred}}$ to a provided measured (atomistic) elastic energy $E_{\\text{meas}}$ by reporting a relative error $(E_{\\text{pred}} - E_{\\text{meas}})/E_{\\text{meas}}$ when $E_{\\text{meas}}  0$. If $E_{\\text{meas}} = 0$, report the absolute error $E_{\\text{pred}}$ in place of the relative error.\n\nUnits and numerical requirements:\n- Length inputs $a$ and $r$ are given in nanometers (nm). Convert to meters (m) in your calculations.\n- Displacements $u$ are given in nanometers (nm). Convert to meters (m) in your calculations.\n- Elastic moduli $K$ and $\\mu$ are given in gigapascals (GPa). Convert to pascals (Pa) in your calculations.\n- The predicted and measured energies must be expressed in joules (J).\n- Angles do not appear in this problem.\n- All final numerical outputs must be floating-point numbers.\n\nTest suite:\nProvide results for the following four test cases. In each case, the inputs are:\n- Bulk modulus $K$ in GPa.\n- Shear modulus $\\mu$ in GPa.\n- Inclusion radius $a$ in nm.\n- A list of sampling radii $[r_1, r_2, \\dots]$ in nm.\n- A corresponding list of far-field radial displacements $[u_1, u_2, \\dots]$ in nm obtained from an atomistic simulation.\n- A measured atomistic elastic energy $E_{\\text{meas}}$ in J.\n\nCase A (general):\n- $K = 160$ GPa, $\\mu = 60$ GPa, $a = 2$ nm.\n- Radii (nm): $[5, 6, 8, 10, 12]$.\n- Displacements (nm): $[0.0043166667, 0.0029229630, 0.0016966667, 0.0010466667, 0.0007507407]$.\n- $E_{\\text{meas}} = 3.24816\\times 10^{-18}$ J.\n\nCase B (smaller inclusion and eigenstrain):\n- $K = 100$ GPa, $\\mu = 40$ GPa, $a = 1$ nm.\n- Radii (nm): $[3, 4, 5, 6, 8]$.\n- Displacements (nm): $[0.00037231884, 0.00019380435, 0.00013043478, 0.00008557916, 0.00005595109]$.\n- $E_{\\text{meas}} = 1.606\\times 10^{-20}$ J.\n\nCase C (edge case, near-zero misfit):\n- $K = 150$ GPa, $\\mu = 50$ GPa, $a = 2.5$ nm.\n- Radii (nm): $[7, 9, 12, 15, 18]$.\n- Displacements (nm): $[0.00001, -0.000005, 0.000002, -0.000001, 0.0000005]$.\n- $E_{\\text{meas}} = 0$ J. For this case, report the absolute error $E_{\\text{pred}}$ in place of the relative error.\n\nCase D (high bulk-to-shear contrast):\n- $K = 200$ GPa, $\\mu = 5$ GPa, $a = 3$ nm.\n- Radii (nm): $[6, 9, 12, 15, 20]$.\n- Displacements (nm): $[0.00735806, 0.00317580, 0.00183312, 0.00115129, 0.000658226]$.\n- $E_{\\text{meas}} = 3.349\\times 10^{-19}$ J.\n\nComputational details and output specification:\n- Implement the least-squares fit for the scalar constrained strain parameter by regressing the observed $u_r(r)$ against the appropriate radial kernel for spherical symmetry derived from first principles. Then map the constrained strain to the eigenstrain estimate $\\widehat{\\varepsilon}^\\star$ using the relationship you derive from the fundamental base.\n- Compute $E_{\\text{pred}}$ using the closed-form energy formula you derive.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists:\n  - For each case, output $[\\widehat{\\varepsilon}^\\star, E_{\\text{pred}}, E_{\\text{meas}}, \\text{err}]$, where $\\text{err}$ is the relative error $(E_{\\text{pred}} - E_{\\text{meas}})/E_{\\text{meas}}$ for $E_{\\text{meas}}  0$, and $\\text{err} = E_{\\text{pred}}$ for $E_{\\text{meas}} = 0$.\n  - Example format: $[[x_1,y_1,z_1,e_1],[x_2,y_2,z_2,e_2],[x_3,y_3,z_3,e_3],[x_4,y_4,z_4,e_4]]$ with no spaces.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a complete solution. It is a standard problem in continuum micromechanics, specifically the Eshelby inclusion problem for a spherical geometry. The problem is valid, and I will proceed with its solution.\n\nThe solution requires two main derivations from the fundamental principles of linear elasticity, followed by the design of a computational algorithm to process the given data.\n\n**1. Derivation of the Far-Field Radial Displacement**\n\nThe problem involves a spherical inclusion in an infinite isotropic elastic matrix. Due to the spherical symmetry of the geometry and the hydrostatic nature of the eigenstrain, the resulting displacement field $\\mathbf{u}$ must be purely radial and dependent only on the distance $r$ from the center, i.e., $\\mathbf{u} = u_r(r)\\mathbf{e}_r$.\n\nIn spherical coordinates $(r, \\theta, \\phi)$, the non-zero components of the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ are the radial strain $\\varepsilon_{rr}$ and the two equal hoop strains $\\varepsilon_{\\theta\\theta}$ and $\\varepsilon_{\\phi\\phi}$:\n$$\n\\varepsilon_{rr} = \\frac{d u_r}{d r} \\quad , \\quad \\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = \\frac{u_r}{r}\n$$\n\nFor an isotropic linear elastic material, the constitutive relation (Hooke's Law) relates the stress tensor $\\boldsymbol{\\sigma}$ to the elastic strain tensor $\\boldsymbol{\\varepsilon}^e$. Using Lamé moduli $(\\lambda, \\mu)$:\n$$\n\\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon^e_{kk} + 2\\mu \\varepsilon^e_{ij}\n$$\nwhere $\\varepsilon^e_{kk}$ is the trace of the elastic strain tensor and $\\delta_{ij}$ is the Kronecker delta. The total strain $\\boldsymbol{\\varepsilon}$ is the sum of the elastic strain and the eigenstrain, $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^\\star$. In the matrix ($r > a$), the eigenstrain is zero, so $\\boldsymbol{\\varepsilon}^e = \\boldsymbol{\\varepsilon}$.\n\nThe equation of mechanical equilibrium, in the absence of body forces, is $\\nabla \\cdot \\boldsymbol{\\sigma} = 0$. For spherical symmetry, this simplifies to a single ordinary differential equation:\n$$\n\\frac{d\\sigma_{rr}}{dr} + \\frac{2}{r}(\\sigma_{rr} - \\sigma_{\\theta\\theta}) = 0\n$$\nThe stress components in the matrix are:\n$$\n\\sigma_{rr} = \\lambda(\\varepsilon_{rr} + 2\\varepsilon_{\\theta\\theta}) + 2\\mu\\varepsilon_{rr} = (\\lambda + 2\\mu)\\frac{du_r}{dr} + 2\\lambda\\frac{u_r}{r}\n$$\n$$\n\\sigma_{\\theta\\theta} = \\lambda(\\varepsilon_{rr} + 2\\varepsilon_{\\theta\\theta}) + 2\\mu\\varepsilon_{\\theta\\theta} = \\lambda\\frac{du_r}{dr} + 2(\\lambda + \\mu)\\frac{u_r}{r}\n$$\nSubstituting these into the equilibrium equation yields the Navier-Cauchy equation for spherical symmetry:\n$$\n\\frac{d^2u_r}{dr^2} + \\frac{2}{r}\\frac{du_r}{dr} - \\frac{2u_r}{r^2} = 0\n$$\nThis is a Cauchy-Euler equation with a general solution of the form:\n$$\nu_r(r) = C_1 r + C_2 r^{-2}\n$$\nwhere $C_1$ and $C_2$ are constants.\n\nThe boundary conditions for the matrix are:\n1.  The displacement must vanish at infinity: $u_r(r \\to \\infty) \\to 0$. This requires $C_1 = 0$.\nThus, the displacement field in the matrix has the form:\n$$\nu_r^{\\text{out}}(r) = C r^{-2}\n$$\nwhere $C$ is a constant to be determined. This is the functional form for the far-field displacement.\n\nTo determine $C$, we must consider the inclusion and the interface conditions at $r=a$.\n- **Inside the inclusion ($r \\le a$)**: The strain is uniform and hydrostatic, dictated by symmetry. Let this constrained strain be $\\varepsilon^C$. The displacement field producing this is $u_r^{\\text{in}}(r) = \\varepsilon^C r$.\n- **At the interface ($r=a$)**:\n    1.  Displacement must be continuous: $u_r^{\\text{in}}(a) = u_r^{\\text{out}}(a)$.\n        $$\n        \\varepsilon^C a = C a^{-2} \\implies C = \\varepsilon^C a^3\n        $$\n    2.  Radial stress must be continuous: $\\sigma_{rr}^{\\text{in}}(a) = \\sigma_{rr}^{\\text{out}}(a)$.\n        -   The stress inside is related to the elastic strain $\\boldsymbol{\\varepsilon}^{e, \\text{in}} = \\boldsymbol{\\varepsilon}^C - \\boldsymbol{\\varepsilon}^\\star = (\\varepsilon^C - \\varepsilon^\\star)\\mathbf{I}$. Using the bulk modulus $K = \\lambda + \\frac{2}{3}\\mu$, the hydrostatic stress is $\\sigma_{rr}^{\\text{in}} = 3K(\\varepsilon^C - \\varepsilon^\\star)$.\n        -   The stress outside is found from $u_r^{\\text{out}}(r) = C r^{-2}$: $\\sigma_{rr}^{\\text{out}}(r) = -4\\mu C r^{-3}$.\n        -   Equating at $r=a$: $3K(\\varepsilon^C - \\varepsilon^\\star) = -4\\mu C a^{-3}$. Substituting $C = \\varepsilon^C a^3$:\n        $$\n        3K(\\varepsilon^C - \\varepsilon^\\star) = -4\\mu \\varepsilon^C \\implies (3K + 4\\mu)\\varepsilon^C = 3K\\varepsilon^\\star\n        $$\n        This gives the relationship between the measurable constrained strain $\\varepsilon^C$ and the underlying eigenstrain $\\varepsilon^\\star$:\n        $$\n        \\varepsilon^C = \\frac{3K}{3K + 4\\mu} \\varepsilon^\\star \\quad \\text{or} \\quad \\varepsilon^\\star = \\frac{3K + 4\\mu}{3K} \\varepsilon^C\n        $$\n\nThe algorithm to find the eigenstrain $\\widehat{\\varepsilon}^\\star$ from displacement data $(r_i, u_i)$ is as follows:\nThe displacement model is $u_r(r) = (\\varepsilon^C a^3) r^{-2}$. This is a linear model $y = m x$ with $y = u_r$, $x = r^{-2}$, and slope $m = \\varepsilon^C a^3$. A linear least-squares fit without an intercept gives the best-fit slope $\\hat{m}$:\n$$\n\\hat{m} = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2} = \\frac{\\sum_i u_i r_i^{-2}}{\\sum_i r_i^{-4}}\n$$\nFrom this, we estimate the constrained strain $\\widehat{\\varepsilon^C} = \\hat{m} / a^3$ and subsequently the eigenstrain:\n$$\n\\widehat{\\varepsilon}^\\star = \\frac{3K + 4\\mu}{3K} \\widehat{\\varepsilon^C}\n$$\n\n**2. Derivation of the Total Elastic Energy**\n\nThe total elastic energy $E_{\\text{pred}}$ is the volume integral of the elastic strain energy density, $w = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}^e$. The energy is the sum of the energy stored inside the inclusion ($E_{\\text{in}}$) and in the matrix ($E_{\\text{out}}$).\n\n- **Energy inside the inclusion ($E_{\\text{in}}$)**:\nThe stress and elastic strain are uniform: $\\sigma_{ij}^{\\text{in}} = 3K(\\varepsilon^C - \\varepsilon^\\star)\\delta_{ij}$ and $\\varepsilon_{ij}^{e, \\text{in}} = (\\varepsilon^C - \\varepsilon^\\star)\\delta_{ij}$.\nThe energy density is $w_{\\text{in}} = \\frac{1}{2}\\sum_{i,j} \\sigma_{ij}^{\\text{in}}\\varepsilon_{ij}^{e, \\text{in}} = \\frac{1}{2} \\cdot 3 \\cdot [3K(\\varepsilon^C - \\varepsilon^\\star)](\\varepsilon^C - \\varepsilon^\\star) = \\frac{9}{2}K(\\varepsilon^C - \\varepsilon^\\star)^2$.\n$E_{\\text{in}} = V_{\\text{in}} w_{\\text{in}} = (\\frac{4}{3}\\pi a^3) \\frac{9}{2}K(\\varepsilon^C - \\varepsilon^\\star)^2 = 6\\pi a^3 K(\\varepsilon^C - \\varepsilon^\\star)^2$.\n\n- **Energy outside in the matrix ($E_{\\text{out}}$)**:\nThe displacement is $u_r(r) = C r^{-2}$ with $C=\\varepsilon^C a^3$. The strains are $\\varepsilon_{rr} = -2Cr^{-3}$ and $\\varepsilon_{\\theta\\theta} = \\varepsilon_{\\phi\\phi} = Cr^{-3}$.\nThe stresses are $\\sigma_{rr} = -4\\mu C r^{-3}$ and $\\sigma_{\\theta\\theta} = \\sigma_{\\phi\\phi} = 2\\mu C r^{-3}$.\nThe energy density is $w_{\\text{out}}(r) = \\frac{1}{2}(\\sigma_{rr}\\varepsilon_{rr} + 2\\sigma_{\\theta\\theta}\\varepsilon_{\\theta\\theta}) = \\frac{1}{2}[(-4\\mu C r^{-3})(-2Cr^{-3}) + 2(2\\mu C r^{-3})(Cr^{-3})] = 6\\mu C^2 r^{-6}$.\n$E_{\\text{out}} = \\int_a^\\infty w_{\\text{out}}(r) 4\\pi r^2 dr = \\int_a^\\infty 24\\pi \\mu C^2 r^{-4} dr = 24\\pi \\mu C^2 [-\\frac{r^{-3}}{3}]_a^\\infty = 8\\pi \\mu C^2 a^{-3}$.\nSubstituting $C=\\varepsilon^C a^3$, we get $E_{\\text{out}} = 8\\pi\\mu a^3 (\\varepsilon^C)^2$.\n\n- **Total Energy ($E_{\\text{pred}}$)**:\n$E_{\\text{pred}} = E_{\\text{in}} + E_{\\text{out}} = 6\\pi a^3 K(\\varepsilon^C - \\varepsilon^\\star)^2 + 8\\pi\\mu a^3 (\\varepsilon^C)^2$.\nUsing the relations $\\varepsilon^C = \\frac{3K}{3K+4\\mu}\\varepsilon^\\star$ and $\\varepsilon^C - \\varepsilon^\\star = \\frac{-4\\mu}{3K+4\\mu}\\varepsilon^\\star$:\n$$\nE_{\\text{pred}} = 6\\pi a^3 K \\left(\\frac{-4\\mu}{3K+4\\mu}\\varepsilon^\\star\\right)^2 + 8\\pi\\mu a^3 \\left(\\frac{3K}{3K+4\\mu}\\varepsilon^\\star\\right)^2\n$$\n$$\nE_{\\text{pred}} = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [6K(16\\mu^2) + 8\\mu(9K^2)] = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [96K\\mu^2 + 72K^2\\mu]\n$$\nFactoring out $24K\\mu(4\\mu+3K)$:\n$$\nE_{\\text{pred}} = \\frac{\\pi a^3 (\\varepsilon^\\star)^2}{(3K+4\\mu)^2} [24K\\mu(4\\mu+3K)] = \\frac{24\\pi K \\mu a^3}{3K+4\\mu}(\\varepsilon^\\star)^2\n$$\nThis is the final expression for the predicted total elastic energy, to be computed using the estimated eigenstrain $\\widehat{\\varepsilon}^\\star$.\n\n**3. Computational Algorithm**\n\nThe complete algorithm is as follows:\n1.  For each test case, parse the inputs: $K$ [GPa], $\\mu$ [GPa], $a$ [nm], radii $r_i$ [nm], displacements $u_i$ [nm], and measured energy $E_{\\text{meas}}$ [J].\n2.  Convert all inputs to base SI units:\n    -   $K' = K \\times 10^9$ Pa\n    -   $\\mu' = \\mu \\times 10^9$ Pa\n    -   $a' = a \\times 10^{-9}$ m\n    -   $r'_i = r_i \\times 10^{-9}$ m\n    -   $u'_i = u_i \\times 10^{-9}$ m\n3.  Perform the linear least-squares fit. Construct the variables for regression: $y_i = u'_i$ and $x_i = (r'_i)^{-2}$.\n4.  Calculate the slope $\\hat{m} = (\\sum x_i y_i) / (\\sum x_i^2)$.\n5.  Estimate the constrained strain: $\\widehat{\\varepsilon^C} = \\hat{m} / (a')^3$.\n6.  Estimate the eigenstrain: $\\widehat{\\varepsilon}^\\star = \\frac{3K' + 4\\mu'}{3K'} \\widehat{\\varepsilon^C}$.\n7.  Calculate the predicted elastic energy $E_{\\text{pred}}$ using the derived formula and the estimated eigenstrain $\\widehat{\\varepsilon}^\\star$:\n    $$\n    E_{\\text{pred}} = \\frac{24\\pi K' \\mu' (a')^3}{3K' + 4\\mu'}(\\widehat{\\varepsilon}^\\star)^2\n    $$\n8.  Calculate the error, $\\text{err}$. If $E_{\\text{meas}}  0$, $\\text{err} = (E_{\\text{pred}} - E_{\\text{meas}}) / E_{\\text{meas}}$. If $E_{\\text{meas}} = 0$, $\\text{err} = E_{\\text{pred}}$.\n9.  Collect the four output values $[\\widehat{\\varepsilon}^\\star, E_{\\text{pred}}, E_{\\text{meas}}, \\text{err}]$ for each case and format them as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It processes each case, computes the required values, and prints the final result.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"K\": 160, \"mu\": 60, \"a\": 2,\n            \"radii\": [5, 6, 8, 10, 12],\n            \"displacements\": [0.0043166667, 0.0029229630, 0.0016966667, 0.0010466667, 0.0007507407],\n            \"E_meas\": 3.24816e-18,\n        },\n        {\n            \"K\": 100, \"mu\": 40, \"a\": 1,\n            \"radii\": [3, 4, 5, 6, 8],\n            \"displacements\": [0.00037231884, 0.00019380435, 0.00013043478, 0.00008557916, 0.00005595109],\n            \"E_meas\": 1.606e-20,\n        },\n        {\n            \"K\": 150, \"mu\": 50, \"a\": 2.5,\n            \"radii\": [7, 9, 12, 15, 18],\n            \"displacements\": [0.00001, -0.000005, 0.000002, -0.000001, 0.0000005],\n            \"E_meas\": 0.0,\n        },\n        {\n            \"K\": 200, \"mu\": 5, \"a\": 3,\n            \"radii\": [6, 9, 12, 15, 20],\n            \"displacements\": [0.00735806, 0.00317580, 0.00183312, 0.00115129, 0.000658226],\n            \"E_meas\": 3.349e-19,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(case)\n        all_results.append(result)\n    \n    # Format the final output string as specified\n    inner_strs = [f\"[{','.join(f'{v:.6e}' for v in res)}]\" for res in all_results]\n    print(f\"[{','.join(inner_strs)}]\")\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case to find eigenstrain, predicted energy, and error.\n    \n    The derivation is based on linear elasticity for a spherical inclusion:\n    1. Far-field displacement u_r(r) = C / r^2.\n    2. The constant C is related to the constrained strain ε_C and inclusion radius a by C = ε_C * a^3.\n    3. A linear least-squares fit of u_r vs 1/r^2 yields an estimate for C.\n    4. The constrained strain ε_C is related to the eigenstrain ε* by ε* = ((3K + 4μ) / 3K) * ε_C.\n    5. The total elastic energy is E_pred = (24 * π * K * μ * a^3 / (3K + 4μ)) * (ε*)^2.\n    \"\"\"\n    \n    # Unpack and convert inputs to SI units\n    K_si = case_data[\"K\"] * 1e9  # GPa to Pa\n    mu_si = case_data[\"mu\"] * 1e9  # GPa to Pa\n    a_si = case_data[\"a\"] * 1e-9    # nm to m\n    radii_si = np.array(case_data[\"radii\"]) * 1e-9  # nm to m\n    displacements_si = np.array(case_data[\"displacements\"]) * 1e-9  # nm to m\n    E_meas = case_data[\"E_meas\"] # J\n\n    # Perform linear least-squares fit for y = m*x where y=u, x=1/r^2\n    # The slope m is an estimate for C = ε_C * a^3\n    x_fit = 1 / (radii_si**2)\n    y_fit = displacements_si\n    \n    m_hat = np.dot(x_fit, y_fit) / np.dot(x_fit, x_fit)\n\n    # Estimate constrained strain and then eigenstrain\n    eps_C_hat = m_hat / (a_si**3)\n    eps_star_hat = ((3 * K_si + 4 * mu_si) / (3 * K_si)) * eps_C_hat\n\n    # Predict total elastic energy\n    numerator = 24 * np.pi * K_si * mu_si * (a_si**3)\n    denominator = 3 * K_si + 4 * mu_si\n    E_pred = (numerator / denominator) * (eps_star_hat**2)\n\n    # Calculate error\n    if E_meas > 0:\n        error = (E_pred - E_meas) / E_meas\n    else:\n        error = E_pred\n\n    return [eps_star_hat, E_pred, E_meas, error]\n\nsolve()\n```", "id": "2765161"}]}