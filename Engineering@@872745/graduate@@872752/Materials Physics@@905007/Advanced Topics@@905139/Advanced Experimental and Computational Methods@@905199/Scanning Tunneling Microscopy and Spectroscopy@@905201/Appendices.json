{"hands_on_practices": [{"introduction": "The exponential decay of tunneling current with tip-sample distance is the physical principle that grants Scanning Tunneling Microscopy its extraordinary vertical resolution. This decay rate is not arbitrary; it is fundamentally linked to the effective height of the potential barrier that electrons must tunnel through. This exercise provides hands-on practice in extracting this key physical parameter, the apparent barrier height $\\phi_{\\mathrm{app}}$, from a realistic experimental observable and applying a first-order correction for the finite bias voltage that is always present in a measurement [@problem_id:2856462].", "problem": "A Scanning Tunneling Microscopy (STM) experiment measures the distance dependence of the tunneling current between a metallic tip and a metallic sample at low temperature. The measured logarithmic slope of the current with respect to tip-sample separation is $\\partial_{z} \\ln I = -20\\,\\mathrm{nm}^{-1}$ at a sample bias of $V = 100\\,\\mathrm{mV}$. Assume an electron of free-electron mass $m_{e}$ tunnels through a vacuum barrier and neglect image-potential and density-of-states variations.\n\nStarting from the one-dimensional Wentzel–Kramers–Brillouin (WKB) approximation for tunneling through a classically forbidden region, use the exponential distance dependence of the tunneling transmission to derive the relation between the slope $\\partial_{z} \\ln I$ and an apparent barrier height $\\phi_{\\mathrm{app}}$ in the low-bias, rectangular-barrier limit. Then compute $\\phi_{\\mathrm{app}}$.\n\nNext, consider that a finite bias $V$ produces a trapezoidal vacuum barrier between two identical metals (symmetric electrodes). Using a first-order treatment in the small parameter $e|V|/\\phi$ that is consistent with the WKB picture, show how the finite bias modifies the effective barrier height inferred from $\\partial_{z}\\ln I$ and use this to estimate a corrected work-function-equivalent barrier height $\\phi_{\\mathrm{corr}}$ from the measured slope at $V = 100\\,\\mathrm{mV}$.\n\nExpress both $\\phi_{\\mathrm{app}}$ and $\\phi_{\\mathrm{corr}}$ in $\\mathrm{eV}$ and round your answers to four significant figures. Use $m_{e}$ for the electron mass, $\\hbar$ for the reduced Planck constant, and $e$ for the elementary charge. Treat $V$ as positive in the energy drop $e|V|$ across the vacuum.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It represents a standard analysis of scanning tunneling microscopy data within a simplified but instructive theoretical framework. We shall proceed with the derivation and computation as requested.\n\nThe foundation of our analysis is the one-dimensional Wentzel–Kramers–Brillouin (WKB) approximation for the transmission probability $T$ of a particle with mass $m_e$ and energy $E$ tunneling through a potential barrier $U(x)$ extending from $x=x_1$ to $x=x_2$:\n$$ T \\approx \\exp\\left( -2 \\int_{x_1}^{x_2} \\sqrt{\\frac{2m_e (U(x)-E)}{\\hbar^2}} \\, dx \\right) $$\nThe tunneling current $I$ is proportional to this transmission probability, $I \\propto T$. Therefore, the logarithm of the current is related to the WKB exponent:\n$$ \\ln I = C - 2 \\int_{x_1}^{x_2} \\sqrt{\\frac{2m_e (U(x)-E)}{\\hbar^2}} \\, dx $$\nwhere $C$ is a constant independent of the tip-sample separation $z$. The derivative of $\\ln I$ with respect to $z$ will thus depend on the derivative of this integral.\n\nFirst, we analyze the low-bias limit, where the applied voltage $V \\to 0$. In this limit, the potential barrier between the metallic tip and sample is a simple rectangular barrier of width $z$ (the tip-sample separation) and height $\\phi$. The electrons tunneling are those at the Fermi energy $E_F$. We can set $E=E_F=0$ as our energy reference. The potential barrier is then $U(x) = \\phi$ for $0 \\le x \\le z$. The problem defines the barrier height inferred in this limit as the \"apparent barrier height,\" $\\phi_{\\mathrm{app}}$.\n\nThe WKB integral becomes:\n$$ \\int_{0}^{z} \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\, dx = z \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\nSubstituting this into the expression for $\\ln I$:\n$$ \\ln I = C - 2z \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\nThe logarithmic slope of the current with respect to separation $z$ is the derivative:\n$$ \\frac{\\partial \\ln I}{\\partial z} = -2 \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\nThis is the requested relation between the slope and the apparent barrier height. The problem provides the measured value of this slope, which we denote as $S = \\partial_{z} \\ln I = -20\\,\\mathrm{nm}^{-1}$. We can now solve for $\\phi_{\\mathrm{app}}$:\n$$ S = -2 \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} $$\n$$ S^2 = 4 \\left( \\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2} \\right) = \\frac{8m_e \\phi_{\\mathrm{app}}}{\\hbar^2} $$\n$$ \\phi_{\\mathrm{app}} = \\frac{\\hbar^2 S^2}{8m_e} $$\nTo compute the numerical value, we use the given slope $S = -20\\,\\mathrm{nm}^{-1} = -2 \\times 10^{10}\\,\\mathrm{m}^{-1}$, along with the fundamental constants for the reduced Planck constant $\\hbar$ and the electron mass $m_e$:\n$$ \\phi_{\\mathrm{app}} = \\frac{(1.05457 \\times 10^{-34}\\,\\mathrm{J}\\cdot\\mathrm{s})^2 (-2 \\times 10^{10}\\,\\mathrm{m}^{-1})^2}{8 (9.10938 \\times 10^{-31}\\,\\mathrm{kg})} \\approx 6.1043 \\times 10^{-19}\\,\\mathrm{J} $$\nTo express this in electron-volts ($\\mathrm{eV}$), we divide by the elementary charge $e$:\n$$ \\phi_{\\mathrm{app}} (\\mathrm{eV}) = \\frac{6.1043 \\times 10^{-19}\\,\\mathrm{J}}{1.60218 \\times 10^{-19}\\,\\mathrm{C}} \\approx 3.8100\\,\\mathrm{eV} $$\nRounding to four significant figures, $\\phi_{\\mathrm{app}} = 3.810\\,\\mathrm{eV}$.\n\nNext, we consider the effect of a finite bias voltage $V$. For two identical metals with work function $\\phi_{\\mathrm{corr}}$, a bias $V$ applied to the sample creates a trapezoidal potential barrier. The potential energy of an electron in the gap is approximately linear:\n$$ U(x) = \\phi_{\\mathrm{corr}} - \\frac{eV}{z}x \\quad \\text{for } 0 \\le x \\le z $$\nHere, $\\phi_{\\mathrm{corr}}$ is the true, bias-independent work-function-equivalent barrier height we wish to find. We again evaluate the tunneling exponent for an electron at the tip's Fermi level ($E=0$). The WKB integral is now:\n$$ \\int_{0}^{z} \\sqrt{\\frac{2m_e}{\\hbar^2} \\left( \\phi_{\\mathrm{corr}} - \\frac{eV}{z}x \\right)} \\, dx = \\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\int_{0}^{z} \\sqrt{1 - \\frac{eV}{\\phi_{\\mathrm{corr}} z}x} \\, dx $$\nThe problem specifies a first-order treatment in the small parameter $e|V|/\\phi_{\\mathrm{corr}}$. We use the Taylor expansion $\\sqrt{1-u} \\approx 1 - u/2$ for small $u$:\n$$ \\sqrt{1 - \\frac{eV}{\\phi_{\\mathrm{corr}} z}x} \\approx 1 - \\frac{1}{2}\\frac{eV}{\\phi_{\\mathrm{corr}} z}x $$\nThe integral becomes:\n$$ \\int_{0}^{z} \\left(1 - \\frac{eV}{2\\phi_{\\mathrm{corr}} z}x\\right) \\, dx = \\left[ x - \\frac{eV}{4\\phi_{\\mathrm{corr}} z}x^2 \\right]_{0}^{z} = z - \\frac{eV z^2}{4\\phi_{\\mathrm{corr}} z} = z \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nSubstituting this back, the full tunneling exponent is modified. The logarithm of the current is:\n$$ \\ln I \\approx C - 2 \\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\cdot z \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nThe measured slope $S$ at finite bias $V$ is the derivative with respect to $z$, holding $V$ constant:\n$$ S = \\frac{\\partial \\ln I}{\\partial z} = -2\\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nThis expression shows how the finite bias modifies the slope. To relate this to the apparent barrier height $\\phi_{\\mathrm{app}}$, we equate the two expressions for $S$:\n$$ -2 \\sqrt{\\frac{2m_e\\phi_{\\mathrm{app}}}{\\hbar^2}} = -2\\sqrt{\\frac{2m_e\\phi_{\\mathrm{corr}}}{\\hbar^2}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\n$$ \\sqrt{\\phi_{\\mathrm{app}}} = \\sqrt{\\phi_{\\mathrm{corr}}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) $$\nSquaring both sides and keeping terms up to first order in $V$:\n$$ \\phi_{\\mathrm{app}} = \\phi_{\\mathrm{corr}} \\left(1 - \\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right)^2 \\approx \\phi_{\\mathrm{corr}} \\left(1 - 2\\frac{eV}{4\\phi_{\\mathrm{corr}}}\\right) = \\phi_{\\mathrm{corr}} \\left(1 - \\frac{eV}{2\\phi_{\\mathrm{corr}}}\\right) $$\n$$ \\phi_{\\mathrm{app}} \\approx \\phi_{\\mathrm{corr}} - \\frac{eV}{2} $$\nThis result shows that the apparent barrier height measured at a finite bias $V$ is lower than the true barrier height $\\phi_{\\mathrm{corr}}$ by approximately $eV/2$. We can now solve for the corrected barrier height:\n$$ \\phi_{\\mathrm{corr}} \\approx \\phi_{\\mathrm{app}} + \\frac{eV}{2} $$\nUsing the given bias $V=100\\,\\mathrm{mV} = 0.1\\,\\mathrm{V}$, the correction term is $\\frac{eV}{2} = \\frac{e(0.1\\,\\mathrm{V})}{2} = 0.05\\,\\mathrm{eV}$.\n$$ \\phi_{\\mathrm{corr}} \\approx 3.8100\\,\\mathrm{eV} + 0.05\\,\\mathrm{eV} = 3.8600\\,\\mathrm{eV} $$\nRounding to four significant figures, $\\phi_{\\mathrm{corr}} = 3.860\\,\\mathrm{eV}$.\nThe two requested values are $\\phi_{\\mathrm{app}}$ and $\\phi_{\\mathrm{corr}}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.810 & 3.860\n\\end{pmatrix}\n}\n$$", "id": "2856462"}, {"introduction": "A constant-current STM image is often interpreted as a direct map of surface topography, but this view is incomplete. The image is more accurately described as a contour of constant integrated local density of states (LDOS), meaning it inherently convolves the sample's geometric structure with its electronic properties. This computational practice [@problem_id:2856463] allows you to simulate this profound effect, quantitatively disentangling the true geometric height difference $\\Delta z_{\\mathrm{true}}$ from the purely electronic contribution $\\Delta z_{\\mathrm{el}}(V)$, and thereby developing a deeper intuition for interpreting STM contrast.", "problem": "Consider Scanning Tunneling Microscopy (STM) operated in constant-current mode over a sample with a local density of states (LDOS) feature at energy $E_0$. Under the Tersoff–Hamann approximation, the tunneling current at tip–sample separation $z$ and sample bias $V$ satisfies $I(z,V) \\propto \\exp(-2 \\kappa z) \\int_{0}^{e V} \\rho_s(E)\\, dE$, where $\\kappa = \\sqrt{2 m \\phi}/\\hbar$, $m$ is the electron mass, $\\phi$ is the effective tunnel barrier height, and $\\hbar$ is the reduced Planck constant. Assume a metallic tip with energy-independent density of states and transmission in the relevant bias window. In constant-current topography, the feedback loop adjusts $z$ so that $I(z,V)$ equals a fixed setpoint for each lateral position.\n\nTwo lateral positions, labeled $A$ and $B$, have identical geometric topography except for a known true height difference $\\Delta z_\\mathrm{true}$, and their electronic structures differ only in the sample LDOS. Specifically, model the LDOS (in units of $\\mathrm{eV}^{-1}$) as follows:\n- At position $A$: $\\rho_A(E) = \\rho_0$ for $E \\ge 0$.\n- At position $B$: $\\rho_B(E) = \\rho_0 + A_p \\exp\\!\\left( -\\dfrac{(E - E_0)^2}{2 \\sigma^2} \\right)$ for $E \\ge 0$.\n\nHere $E$ and $E_0$ are measured relative to the Fermi level, and $V > 0$ is the sample bias so that the integration runs from $E = 0$ to $E = e V$.\n\nTasks:\n1. Starting only from the exponential distance dependence of tunneling probability and the definition of the tunneling current in the Tersoff–Hamann approximation, derive an expression for the apparent height difference $\\Delta z_\\mathrm{app}(V)$ between positions $B$ and $A$ measured by constant-current imaging at bias $V$. Decompose $\\Delta z_\\mathrm{app}(V)$ into a sum of the true geometric height difference $\\Delta z_\\mathrm{true}$ and an electronic contribution $\\Delta z_\\mathrm{el}(V)$ that depends on the LDOS through energy integration.\n2. Implement this model to compute the bias dependence of $\\Delta z_\\mathrm{app}(V)$ as $V$ scans through the LDOS feature at $E_0$, and explicitly quantify $\\Delta z_\\mathrm{el}(V)$.\n3. Use the following physical constants in SI units: electron mass $m = 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}$, reduced Planck constant $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J \\cdot s}$, elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$. Convert the barrier height $\\phi$ from $\\mathrm{eV}$ to $\\mathrm{J}$ when computing $\\kappa = \\sqrt{2 m \\phi}/\\hbar$.\n4. For each test case below, compute and report two lists for the specified bias values: the apparent height list $\\left[\\Delta z_\\mathrm{app}(V_i)\\right]$ and the electronic-only list $\\left[\\Delta z_\\mathrm{el}(V_i)\\right]$. Express all heights in picometers and round each float to three decimal places.\n\nTest suite (each case specifies $\\rho_0$, $A_p$, $E_0$ in $\\mathrm{eV}$, $\\sigma$ in $\\mathrm{eV}$, $\\Delta z_\\mathrm{true}$ in $\\mathrm{pm}$, $\\phi$ in $\\mathrm{eV}$, and the list of $V_\\mathrm{set}$ values in $\\mathrm{V}$):\n- Case $1$ (happy path across the feature): $\\rho_0 = 1.0$, $A_p = 2.0$, $E_0 = 0.30$, $\\sigma = 0.05$, $\\Delta z_\\mathrm{true} = 50.0$, $\\phi = 4.5$, biases $V_\\mathrm{set} \\in \\{0.10, 0.30, 0.60\\}$.\n- Case $2$ (sharp, strong feature; pure electronic contrast): $\\rho_0 = 1.0$, $A_p = 5.0$, $E_0 = 0.20$, $\\sigma = 0.01$, $\\Delta z_\\mathrm{true} = 0.0$, $\\phi = 4.5$, biases $V_\\mathrm{set} \\in \\{0.15, 0.20, 0.25\\}$.\n- Case $3$ (no feature; purely topographic): $\\rho_0 = 1.0$, $A_p = 0.0$, $E_0 = 0.30$, $\\sigma = 0.05$, $\\Delta z_\\mathrm{true} = 200.0$, $\\phi = 4.5$, biases $V_\\mathrm{set} \\in \\{0.10, 0.40\\}$.\n\nYour program must:\n- Implement the physics described above without using any external input.\n- For each case, compute the two lists $\\left[\\Delta z_\\mathrm{app}(V_i)\\right]$ and $\\left[\\Delta z_\\mathrm{el}(V_i)\\right]$ in picometers, rounded to three decimal places.\n- Produce a single line of output containing a list of per-case results, where each per-case result is a two-element list of lists in the order $\\left[\\left[\\Delta z_\\mathrm{app}(V_i)\\right], \\left[\\Delta z_\\mathrm{el}(V_i)\\right]\\right]$. For example, a valid output structure has the form $\\left[ \\left[ [\\cdots], [\\cdots] \\right], \\left[ [\\cdots], [\\cdots] \\right], \\left[ [\\cdots], [\\cdots] \\right] \\right]$.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. It is a standard application of the Tersoff–Hamann model for scanning tunneling microscopy (STM), a cornerstone of theoretical surface science. We will proceed with a formal derivation and then implement the resulting model.\n\nThe foundation of this analysis is the expression for the tunneling current $I$ as a function of tip-sample separation $z$ and sample bias voltage $V$, within the Tersoff–Hamann approximation:\n$$\nI(z, V) = C \\exp(-2 \\kappa z) \\int_{0}^{e V} \\rho_s(E) dE\n$$\nHere, $C$ is a proportionality constant that depends on the tip's electronic structure (assumed constant) and other factors, $\\rho_s(E)$ is the sample's local density of states (LDOS), and $\\kappa = \\sqrt{2 m \\phi}/\\hbar$ is the vacuum decay constant determined by the electron mass $m$, the effective tunnel barrier height $\\phi$, and the reduced Planck constant $\\hbar$. All energies $E$ are measured from the sample's Fermi level.\n\nIn constant-current mode, a feedback loop maintains a fixed setpoint current, $I_{\\text{set}}$, by adjusting the tip height $z$ at each lateral position $(x, y)$. Consider two lateral positions, $A$ and $B$. Let their respective measured tip-sample separations be $z_A(V)$ and $z_B(V)$ at a bias $V$. The constant-current condition implies:\n$$\nI_{\\text{set}} = C \\exp(-2 \\kappa z_A(V)) \\int_{0}^{e V} \\rho_A(E) dE\n$$\n$$\nI_{\\text{set}} = C \\exp(-2 \\kappa z_B(V)) \\int_{0}^{e V} \\rho_B(E) dE\n$$\nEquating these two expressions and canceling the constant $C$ yields:\n$$\n\\exp(-2 \\kappa z_A(V)) \\int_{0}^{e V} \\rho_A(E) dE = \\exp(-2 \\kappa z_B(V)) \\int_{0}^{e V} \\rho_B(E) dE\n$$\nRearranging to isolate the term related to the height difference, we obtain:\n$$\n\\exp(2 \\kappa [z_B(V) - z_A(V)]) = \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE}\n$$\nTaking the natural logarithm of both sides and solving for the difference in tip-sample separation gives:\n$$\nz_B(V) - z_A(V) = \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE} \\right)\n$$\nThe apparent height of the surface measured by the STM, $z_{\\text{app}}$, is the vertical position of the tip. If the true geometric heights of the sample at positions $A$ and $B$ are $h_A$ and $h_B$, the tip's vertical position is given by $z_{\\text{tip}} = h_{\\text{surface}} + z_{\\text{separation}}$. The apparent height difference is therefore:\n$$\n\\Delta z_{\\text{app}}(V) = z_{\\text{tip}, B}(V) - z_{\\text{tip}, A}(V) = [h_B + z_B(V)] - [h_A + z_A(V)] = (h_B - h_A) + (z_B(V) - z_A(V))\n$$\nWe identify $(h_B - h_A)$ as the true geometric height difference, $\\Delta z_{\\text{true}}$. The expression for the apparent height difference becomes:\n$$\n\\Delta z_{\\text{app}}(V) = \\Delta z_{\\text{true}} + \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE} \\right)\n$$\nThis result is of the form $\\Delta z_{\\text{app}}(V) = \\Delta z_{\\text{true}} + \\Delta z_{\\text{el}}(V)$, where the electronic contribution to the apparent height is:\n$$\n\\Delta z_{\\text{el}}(V) = \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\int_{0}^{e V} \\rho_B(E) dE}{\\int_{0}^{e V} \\rho_A(E) dE} \\right)\n$$\nThis completes the first task of the derivation.\n\nNext, we evaluate the integrals for the specified LDOS models. The energy parameters and LDOS are given in units of $\\mathrm{eV}$ and $\\mathrm{eV}^{-1}$ respectively, so we interpret the integration variable $E$ to be energy in units of electron-volts ($\\mathrm{eV}$), and the upper integration limit $e V$ as the numerical value of the bias $V$ in volts.\nFor position $A$, $\\rho_A(E) = \\rho_0$:\n$$\n\\int_0^V \\rho_A(E) dE = \\int_0^V \\rho_0 dE = \\rho_0 V\n$$\nFor position $B$, $\\rho_B(E) = \\rho_0 + A_p \\exp\\left( -\\frac{(E - E_0)^2}{2 \\sigma^2} \\right)$:\n$$\n\\int_0^V \\rho_B(E) dE = \\int_0^V \\rho_0 dE + A_p \\int_0^V \\exp\\left( -\\frac{(E - E_0)^2}{2 \\sigma^2} \\right) dE\n$$\nThe second integral is related to the error function, $\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x e^{-t^2} dt$. Through a change of variables $t = (E - E_0)/(\\sigma\\sqrt{2})$, the integral becomes:\n$$\n\\int_0^V \\exp\\left( -\\frac{(E - E_0)^2}{2 \\sigma^2} \\right) dE = \\sigma\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{-E_0}{\\sigma\\sqrt{2}}\\right) \\right]\n$$\nUsing the property $\\mathrm{erf}(-x) = -\\mathrm{erf}(x)$, this simplifies to:\n$$\n\\sigma\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) + \\mathrm{erf}\\left(\\frac{E_0}{\\sigma\\sqrt{2}}\\right) \\right]\n$$\nSubstituting these integral evaluations into the expression for $\\Delta z_{\\mathrm{el}}(V)$:\n$$\n\\Delta z_{\\mathrm{el}}(V) = \\frac{1}{2 \\kappa} \\ln\\left( \\frac{\\rho_0 V + A_p \\sigma\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) + \\mathrm{erf}\\left(\\frac{E_0}{\\sigma\\sqrt{2}}\\right) \\right]}{\\rho_0 V} \\right)\n$$\n$$\n\\Delta z_{\\mathrm{el}}(V) = \\frac{1}{2 \\kappa} \\ln\\left( 1 + \\frac{A_p \\sigma}{\\rho_0 V} \\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{V - E_0}{\\sigma\\sqrt{2}}\\right) + \\mathrm{erf}\\left(\\frac{E_0}{\\sigma\\sqrt{2}}\\right) \\right] \\right)\n$$\nTo compute numerical values, all quantities in the formula for $\\kappa$ must be in SI units. The barrier height $\\phi$, given in $\\mathrm{eV}$, must be converted to Joules by multiplying by the elementary charge $e$. The resulting $\\kappa$ will have units of $\\mathrm{m}^{-1}$. The factor $1/(2\\kappa)$ will thus be in meters. To present the final heights in picometers ($\\mathrm{pm}$), this factor is multiplied by $10^{12}$. The quantities inside the logarithm ($V, E_0, \\sigma, A_p, \\rho_0$) are used with their given units, as they form a dimensionless group.\n\nThe computational implementation will proceed as follows:\n1. Define physical constants $m, \\hbar, e$ in SI units.\n2. For each test case, calculate the constant $\\kappa$ using the specified barrier height $\\phi$.\n3. Compute the pre-factor $1/(2\\kappa)$ and convert it to units of $\\mathrm{pm}$.\n4. For each specified bias voltage $V$ in a given test case:\n    a. Calculate $\\Delta z_{\\mathrm{el}}(V)$ using the derived formula, which requires evaluation of the $\\mathrm{erf}$ function.\n    b. Calculate $\\Delta z_{\\mathrm{app}}(V) = \\Delta z_{\\mathrm{true}} + \\Delta z_{\\mathrm{el}}(V)$, ensuring $\\Delta z_{\\mathrm{true}}$ is in pm.\n5. Collect the computed lists of $\\Delta z_{\\mathrm{app}}(V_i)$ and $\\Delta z_{\\mathrm{el}}(V_i)$, round the values to three decimal places, and format the output according to the specified structure.\n\nThis systematic procedure ensures a correct and reproducible solution based on fundamental principles of condensed matter physics.", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Main function to solve the STM problem for all test cases.\n    It orchestrates the calculation and formats the final output.\n    \"\"\"\n    # Physical constants in SI units\n    M_E = 9.10938356e-31  # Electron mass (kg)\n    HBAR = 1.054571817e-34  # Reduced Planck constant (J*s)\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C or J/eV)\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case 1: Happy path across the feature\n        # (rho0, Ap, E0_eV, sigma_eV, dz_true_pm, phi_eV, V_set_V)\n        (1.0, 2.0, 0.30, 0.05, 50.0, 4.5, [0.10, 0.30, 0.60]),\n        # Case 2: Sharp, strong feature; pure electronic contrast\n        (1.0, 5.0, 0.20, 0.01, 0.0, 4.5, [0.15, 0.20, 0.25]),\n        # Case 3: No feature; purely topographic\n        (1.0, 0.0, 0.30, 0.05, 200.0, 4.5, [0.10, 0.40]),\n    ]\n\n    all_results_str = []\n    for case in test_cases:\n        rho0, ap, e0, sigma, dz_true, phi, v_set = case\n        \n        # Calculate kappa in SI units (m^-1)\n        phi_joules = phi * E_CHARGE\n        kappa = np.sqrt(2 * M_E * phi_joules) / HBAR\n        \n        # Pre-factor for z_el calculation, converted to picometers\n        z_el_prefactor_pm = 1e12 / (2 * kappa)\n        \n        dz_app_list = []\n        dz_el_list = []\n        \n        for v_bias in v_set:\n            if v_bias == 0:\n                # Handle the case V=0, where electronic contribution is zero\n                dz_el = 0.0\n            elif ap == 0:\n                # If there is no electronic feature, a_p=0, contribution is zero\n                dz_el = 0.0\n            else:\n                # Calculate the argument of the logarithm\n                erf_arg1 = (v_bias - e0) / (sigma * np.sqrt(2))\n                erf_arg2 = e0 / (sigma * np.sqrt(2))\n                erf_term = erf(erf_arg1) + erf(erf_arg2)\n                \n                log_argument_term = (ap * sigma / (rho0 * v_bias)) * np.sqrt(np.pi / 2) * erf_term\n                \n                # Calculate the electronic contribution to height\n                dz_el = z_el_prefactor_pm * np.log(1 + log_argument_term)\n            \n            # Apparent height is the sum of true and electronic contributions\n            dz_app = dz_true + dz_el\n            \n            dz_app_list.append(dz_app)\n            dz_el_list.append(dz_el)\n\n        # Format the results for this case into the required string structure\n        str_dz_app = f\"[{','.join(f'{z:.3f}' for z in dz_app_list)}]\"\n        str_dz_el = f\"[{','.join(f'{z:.3f}' for z in dz_el_list)}]\"\n        case_result_str = f\"[{str_dz_app},{str_dz_el}]\"\n        all_results_str.append(case_result_str)\n\n    # Print the final output in the required single-line format\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "2856463"}, {"introduction": "While STS is an invaluable technique for mapping the local density of states, the raw measured spectrum is not a direct replica of the LDOS. The measurement process itself, specifically the choice of feedback setpoint parameters ($V_{s}$, $I_{s}$) used to stabilize the tip, introduces a normalization factor that can significantly alter the appearance of spectral features. This simulation exercise [@problem_id:2856453] makes this \"setpoint effect\" tangible by having you calculate how the apparent amplitude of a resonance peak changes under different measurement conditions, a crucial lesson for anyone aiming to perform quantitative spectroscopy.", "problem": "Write a complete program that simulates the setpoint-induced change in the peak amplitude of differential conductance in scanning tunneling spectroscopy (STS), using first-principles relations appropriate for scanning tunneling microscopy (STM). Start from the following fundamental base: in the Tersoff–Hamann approximation, the tunneling current at tip–sample separation $z$ and sample bias $V$ may be written as $I(V,z) \\propto e^{-2\\kappa z} \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E$ for positive $V$, where $\\rho_{s}(E)$ is the sample local density of states (LDOS), and the differential conductance satisfies $\\,\\mathrm{d}I/\\mathrm{d}V \\propto \\rho_{s}(V)\\,e^{-2\\kappa z}$. A spectroscopy setpoint is defined by a pair $(V_{s}, I_{s})$ imposing $I(V_{s}, z_{s}) = I_{s}$ through feedback adjustment of $z_{s}$. Assume a constant tip density of states and a fixed vacuum barrier such that $\\kappa$ is independent of $V$. The resonance is modeled as a narrow Lorentzian added to a flat background,\n$$\n\\rho_{s}(E) = \\rho_{0} + \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}},\n$$\nwith flat background $\\rho_{0} > 0$, center energy $E_{r} > 0$, half-width at half-maximum $\\Gamma > 0$, and Lorentzian peak height $A_{L} > 0$. Throughout, treat $E$ and $V$ in electronvolts ($\\mathrm{eV}$) and assume $V \\ge 0$. Your task is to simulate, for each given parameter set, the ratio of the peak amplitudes of $\\mathrm{d}I/\\mathrm{d}V$ at $V = E_{r}$ when measured under two different setpoints $(V_{s1}, I_{s1})$ and $(V_{s2}, I_{s2})$. The program must compute this ratio solely from the base definitions given above, without introducing any additional phenomenology.\n\nMathematically and algorithmically:\n- Derive from the stated base how the spectroscopy setpoint $(V_{s}, I_{s})$ normalizes the measured $\\mathrm{d}I/\\mathrm{d}V(V)$.\n- Use the stated LDOS model to evaluate all required energy integrals exactly, without numerical quadrature, so that results are unambiguous and robust for narrow $\\Gamma$.\n- Compute, for each case, the dimensionless ratio $R = \\left[\\left.\\mathrm{d}I/\\mathrm{d}V\\right|_{V=E_{r}}\\right]_{\\text{setpoint }2} \\big/ \\left[\\left.\\mathrm{d}I/\\mathrm{d}V\\right|_{V=E_{r}}\\right]_{\\text{setpoint }1}$.\n\nUse the following test suite. Each test case supplies $(\\rho_{0}, A_{L}, \\Gamma, E_{r}; V_{s1}, I_{s1}; V_{s2}, I_{s2})$ with energies in $\\mathrm{eV}$ and currents in amperes. The program must produce one result $R$ (a floating-point number) per test case.\n\n- Test case $1$ (general “happy path” with one setpoint below and one above the resonance):\n  - $\\rho_{0} = 1.0$, $A_{L} = 8.0$, $\\Gamma = 0.005$, $E_{r} = 0.200$.\n  - $(V_{s1}, I_{s1}) = (0.100, 1.0\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.300, 1.0\\times 10^{-9})$.\n\n- Test case $2$ (same bias setpoint, different currents isolates current scaling):\n  - $\\rho_{0} = 1.0$, $A_{L} = 10.0$, $\\Gamma = 0.010$, $E_{r} = 0.200$.\n  - $(V_{s1}, I_{s1}) = (0.250, 0.5\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.250, 1.0\\times 10^{-9})$.\n\n- Test case $3$ (setpoints exactly at the resonance energy, different currents):\n  - $\\rho_{0} = 0.8$, $A_{L} = 6.0$, $\\Gamma = 0.004$, $E_{r} = 0.200$.\n  - $(V_{s1}, I_{s1}) = (0.200, 1.0\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.200, 0.8\\times 10^{-9})$.\n\n- Test case $4$ (very narrow resonance, one setpoint below and one above to probe strong setpoint effect):\n  - $\\rho_{0} = 1.2$, $A_{L} = 12.0$, $\\Gamma = 0.001$, $E_{r} = 0.020$.\n  - $(V_{s1}, I_{s1}) = (0.050, 1.0\\times 10^{-9})$, $(V_{s2}, I_{s2}) = (0.015, 1.0\\times 10^{-9})$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list of the four ratios, in order of the test cases, enclosed in square brackets, for example $[r_{1},r_{2},r_{3},r_{4}]$. The entries must be floating-point numbers. Because the requested outputs are pure ratios, no physical units are required (dimensionless).", "solution": "The problem as stated is scientifically sound and mathematically well-posed. It is based on the standard Tersoff-Hamann approximation for scanning tunneling microscopy (STM), which is a cornerstone of the field. The local density of states (LDOS) is modeled by a physically reasonable function, a Lorentzian resonance on a constant background. All parameters are defined, and the objective is unambiguous. We may therefore proceed with a rigorous derivation.\n\nThe fundamental relationship for the tunneling current $I$ at a sample bias $V$ and tip-sample separation $z$ is given as:\n$$\nI(V,z) = C_{0} e^{-2\\kappa z} \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E\n$$\nwhere $\\rho_{s}(E)$ is the sample LDOS, $\\kappa$ is the inverse decay length of the electronic wavefunctions in the vacuum barrier, and $C_{0}$ is a proportionality constant incorporating instrumental factors and fundamental constants. We assume $V \\ge 0$.\n\nThe differential conductance, $\\mathrm{d}I/\\mathrm{d}V$, is obtained by applying the Leibniz integral rule to the expression for $I(V,z)$:\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}V}(V,z) = \\frac{\\mathrm{d}}{\\mathrm{d}V} \\left( C_{0} e^{-2\\kappa z} \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E \\right) = C_{0} e^{-2\\kappa z} \\rho_{s}(V)\n$$\nThis confirms the proportionality $\\mathrm{d}I/\\mathrm{d}V \\propto \\rho_{s}(V)\\,e^{-2\\kappa z}$ stated in the problem.\n\nIn scanning tunneling spectroscopy (STS), a spectrum is acquired at a fixed tip position. This position, $z_{s}$, is established by the feedback loop according to a setpoint condition $(V_{s}, I_{s})$, which requires $I(V_{s}, z_{s}) = I_{s}$. From the expression for the current, we can isolate the term $C_{0} e^{-2\\kappa z_{s}}$ which acts as a normalization prefactor for the entire subsequent spectroscopy measurement:\n$$\nI_{s} = C_{0} e^{-2\\kappa z_{s}} \\int_{0}^{V_{s}} \\rho_{s}(E)\\,\\mathrm{d}E\n$$\n$$\n\\implies C_{0} e^{-2\\kappa z_{s}} = \\frac{I_{s}}{\\int_{0}^{V_{s}} \\rho_{s}(E)\\,\\mathrm{d}E}\n$$\nThe measured differential conductance spectrum under this setpoint is therefore:\n$$\n\\left(\\frac{\\mathrm{d}I}{\\mathrm{d}V}\\right)_{\\text{meas}}(V) = \\left( C_{0} e^{-2\\kappa z_{s}} \\right) \\rho_{s}(V) = \\left( \\frac{I_{s}}{\\int_{0}^{V_{s}} \\rho_{s}(E)\\,\\mathrm{d}E} \\right) \\rho_{s}(V)\n$$\nNote that the unknown constants $C_{0}$ and $\\kappa$ have been eliminated. The measured conductance spectrum is the true sample LDOS, $\\rho_{s}(V)$, scaled by a normalization factor that depends entirely on the setpoint $(V_{s}, I_{s})$ and the integrated LDOS up to $V_{s}$.\n\nThe problem requires the calculation of the ratio, $R$, of the peak amplitudes of the differential conductance measured at the resonance energy, $V=E_{r}$, under two different setpoints: $(V_{s1}, I_{s1})$ and $(V_{s2}, I_{s2})$. Let the corresponding measured conductances at $V=E_{r}$ be denoted by $(\\mathrm{d}I/\\mathrm{d}V)_{1}$ and $(\\mathrm{d}I/\\mathrm{d}V)_{2}$.\n$$\nR = \\frac{\\left.\\left(\\mathrm{d}I/\\mathrm{d}V\\right)_{2}\\right|_{V=E_{r}}}{\\left.\\left(\\mathrm{d}I/\\mathrm{d}V\\right)_{1}\\right|_{V=E_{r}}} = \\frac{\\left( \\frac{I_{s2}}{\\int_{0}^{V_{s2}} \\rho_{s}(E)\\,\\mathrm{d}E} \\right) \\rho_{s}(E_{r})}{\\left( \\frac{I_{s1}}{\\int_{0}^{V_{s1}} \\rho_{s}(E)\\,\\mathrm{d}E} \\right) \\rho_{s}(E_{r})}\n$$\nThe term $\\rho_{s}(E_{r})$, which represents the peak value of the LDOS at the resonance, cancels out. This is a crucial simplification. The ratio $R$ becomes:\n$$\nR = \\frac{I_{s2}}{I_{s1}} \\cdot \\frac{\\int_{0}^{V_{s1}} \\rho_{s}(E)\\,\\mathrm{d}E}{\\int_{0}^{V_{s2}} \\rho_{s}(E)\\,\\mathrm{d}E}\n$$\nTo evaluate this expression, we must compute the definite integral of the provided LDOS model, $\\mathcal{I}(V) = \\int_{0}^{V} \\rho_{s}(E)\\,\\mathrm{d}E$. The LDOS is given as:\n$$\n\\rho_{s}(E) = \\rho_{0} + \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}}\n$$\nThe integral separates into two parts:\n$$\n\\mathcal{I}(V) = \\int_{0}^{V} \\rho_{0} \\,\\mathrm{d}E + \\int_{0}^{V} \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}} \\,\\mathrm{d}E\n$$\nThe first integral is trivial:\n$$\n\\int_{0}^{V} \\rho_{0} \\,\\mathrm{d}E = \\rho_{0}[E]_{0}^{V} = \\rho_{0}V\n$$\nThe second integral is of a standard Lorentzian form. Using the indefinite integral $\\int \\frac{a^{2}}{x^{2}+a^{2}} \\,\\mathrm{d}x = a \\arctan(x/a)$, we let $x = E - E_{r}$ and $a = \\Gamma$:\n$$\n\\int \\frac{\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}} \\,\\mathrm{d}E = \\Gamma \\arctan\\left(\\frac{E-E_{r}}{\\Gamma}\\right)\n$$\nEvaluating the definite integral:\n$$\n\\int_{0}^{V} \\frac{A_{L}\\,\\Gamma^{2}}{(E - E_{r})^{2} + \\Gamma^{2}} \\,\\mathrm{d}E = A_{L}\\Gamma \\left[ \\arctan\\left(\\frac{E-E_{r}}{\\Gamma}\\right) \\right]_{0}^{V} = A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V-E_{r}}{\\Gamma}\\right) - \\arctan\\left(\\frac{-E_{r}}{\\Gamma}\\right) \\right)\n$$\nUsing the identity $\\arctan(-x) = -\\arctan(x)$, this simplifies to:\n$$\n= A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)\n$$\nCombining the two parts, we obtain the exact analytical expression for the integrated LDOS:\n$$\n\\mathcal{I}(V) = \\rho_{0}V + A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)\n$$\nFinally, the ratio $R$ is expressed in terms of the given parameters by substituting this analytical form of the integral:\n$$\nR = \\frac{I_{s2}}{I_{s1}} \\cdot \\frac{\\rho_{0}V_{s1} + A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V_{s1}-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)}{\\rho_{0}V_{s2} + A_{L}\\Gamma \\left( \\arctan\\left(\\frac{V_{s2}-E_{r}}{\\Gamma}\\right) + \\arctan\\left(\\frac{E_{r}}{\\Gamma}\\right) \\right)}\n$$\nThis final equation is implemented directly to compute the required ratios for the given test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the ratio of STS peak amplitudes under different setpoints.\n    \"\"\"\n\n    # Each test case is defined as:\n    # (rho0, AL, Gamma, Er, Vs1, Is1, Vs2, Is2)\n    # where all energies are in eV and currents are in A.\n    test_cases = [\n        (1.0, 8.0, 0.005, 0.200, 0.100, 1.0e-9, 0.300, 1.0e-9),\n        (1.0, 10.0, 0.010, 0.200, 0.250, 0.5e-9, 0.250, 1.0e-9),\n        (0.8, 6.0, 0.004, 0.200, 0.200, 1.0e-9, 0.200, 0.8e-9),\n        (1.2, 12.0, 0.001, 0.020, 0.050, 1.0e-9, 0.015, 1.0e-9),\n    ]\n\n    def calculate_integrated_ldos(V_s, rho_0, A_L, Gamma, E_r):\n        \"\"\"\n        Calculates the integral of the LDOS from 0 to V_s analytically.\n        \n        The integral is I(V) = integral_0^V [rho_0 + A_L*Gamma^2/((E-E_r)^2 + Gamma^2)] dE\n        which evaluates to:\n        I(V) = rho_0*V + A_L*Gamma*[arctan((V-E_r)/Gamma) + arctan(E_r/Gamma)]\n        \"\"\"\n        if V_s  0:\n            # Per problem statement V >= 0. For completeness, we define this.\n            return 0.0\n\n        # Linear background contribution\n        integral_part1 = rho_0 * V_s\n        \n        # Lorentzian peak contribution\n        arg1_arctan = (V_s - E_r) / Gamma\n        arg2_arctan = E_r / Gamma\n        integral_part2 = A_L * Gamma * (np.arctan(arg1_arctan) + np.arctan(arg2_arctan))\n        \n        return integral_part1 + integral_part2\n\n    results = []\n    for case in test_cases:\n        rho_0, A_L, Gamma, E_r, V_s1, I_s1, V_s2, I_s2 = case\n        \n        # Calculate the integrated LDOS for each setpoint voltage\n        integral_1 = calculate_integrated_ldos(V_s1, rho_0, A_L, Gamma, E_r)\n        integral_2 = calculate_integrated_ldos(V_s2, rho_0, A_L, Gamma, E_r)\n        \n        # The ratio of the measured peak heights is given by:\n        # R = (I_s2 / I_s1) * (integral_1 / integral_2)\n        # This holds because the rho_s(E_r) term cancels out.\n        \n        # Problem constraints (rho_0 > 0, V_s >= 0) ensure integral_2 is not zero\n        # unless V_s2 is zero, which is not the case in the test suite.\n        # I_s is also non-zero.\n        \n        ratio = (I_s2 / I_s1) * (integral_1 / integral_2)\n        results.append(ratio)\n\n    # Format the final output as specified in the problem statement.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2856453"}]}