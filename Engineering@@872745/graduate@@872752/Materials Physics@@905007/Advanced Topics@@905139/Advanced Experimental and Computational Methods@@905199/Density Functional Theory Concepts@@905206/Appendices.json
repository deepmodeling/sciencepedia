{"hands_on_practices": [{"introduction": "The Local Density Approximation (LDA) is the historical cornerstone of practical Density Functional Theory, providing a powerful link between the complex many-body problem and a simple, computable model. This practice will guide you through the implementation of the LDA exchange functional, starting from the well-understood physics of the homogeneous electron gas. By deriving the exchange energy density and its corresponding potential, you will gain hands-on experience in how a core DFT functional is constructed and applied numerically to different electron density profiles [@problem_id:2813517].", "problem": "You are to implement a program that, for a given set of one-dimensional electron number density profiles, computes the exchange-only Local Density Approximation (LDA) energy and the corresponding Kohn–Sham exchange potential at the spatial midpoint. The goal is to start from a fundamental description of the homogeneous electron gas and derive the LDA exchange energy density and its functional derivative, then discretize the functional and apply it to the supplied profiles.\n\nStart from the following base principles and well-tested facts:\n- In Density Functional Theory (DFT), the Hohenberg–Kohn theorem guarantees a universal functional of the electron number density $n(\\mathbf{r})$. In the Kohn–Sham (KS) construction, the exchange-correlation contribution can be approximated using the uniform electron gas as a local reference.\n- For a spin-unpolarized homogeneous electron gas (uniform density $n$), the Fermi wave vector is $k_{\\mathrm{F}} = (3\\pi^{2} n)^{1/3}$, and the Hartree–Fock exchange energy can be computed exactly within that model.\n\nTasks:\n1) Derive the LDA exchange-only energy density for a spin-unpolarized electron gas as a function of the local density $n$, and then obtain the associated Kohn–Sham exchange potential as the functional derivative with respect to $n$.\n2) Construct a numerical quadrature in one spatial dimension $x \\in [0,L]$ with a uniform grid of $N$ points and spacing $\\Delta x = L/(N-1)$ to approximate the exchange energy functional from item 1 for inhomogeneous densities $n(x) \\ge 0$. Assume a unit cross-sectional area so that the one-dimensional integral has the correct volume dimension.\n3) Implement the computation in Hartree atomic units (a.u.), where the Bohr radius $a_0$ is the unit of length and the Hartree is the unit of energy. You must express energies in Hartree and potentials in Hartree. No angle quantities are involved.\n4) For each given test case, compute:\n   - The total exchange energy $E_{\\mathrm{x}}$ in Hartree.\n   - The exchange potential $v_{\\mathrm{x}}$ (in Hartree) evaluated at the spatial midpoint $x = L/2$.\n   Use a trapezoidal rule for the integral. If $n=0$ anywhere, handle it consistently and without singularities.\n\nTest suite (use exactly these parameter values):\n- Case 1 (Gaussian bump):\n  - Domain length $L = 20\\,a_0$ and grid size $N = 10001$.\n  - Density $n(x) = n_0 \\exp\\!\\left(-\\dfrac{(x - L/2)^2}{2\\sigma^2}\\right)$ with $n_0 = 0.020\\,a_0^{-3}$ and $\\sigma = 2.000\\,a_0$.\n- Case 2 (Top-hat slab):\n  - Domain length $L = 20\\,a_0$ and grid size $N = 10001$.\n  - Density $n(x) = n_{\\mathrm{c}}$ for $x \\in [0.4L,\\,0.6L]$ and $n(x) = 0$ otherwise, with $n_{\\mathrm{c}} = 0.030\\,a_0^{-3}$.\n- Case 3 (Exponential decay):\n  - Domain length $L = 20\\,a_0$ and grid size $N = 10001$.\n  - Density $n(x) = n_0 \\exp(-x/\\alpha)$ with $n_0 = 0.040\\,a_0^{-3}$ and $\\alpha = 3.000\\,a_0$.\n- Case 4 (Vacuum):\n  - Domain length $L = 20\\,a_0$ and grid size $N = 10001$.\n  - Density $n(x) = 0$ for all $x$.\n\nNumerical and output requirements:\n- Use Hartree atomic units throughout. Express $E_{\\mathrm{x}}$ in Hartree and $v_{\\mathrm{x}}$ in Hartree.\n- For each case, compute the pair $\\{E_{\\mathrm{x}}, v_{\\mathrm{x}}(L/2)\\}$ using the uniform-grid trapezoidal rule.\n- Your program must output a single line containing a flat list with the eight results in the order\n  $[E_{\\mathrm{x}}^{(1)}, v_{\\mathrm{x}}^{(1)}, E_{\\mathrm{x}}^{(2)}, v_{\\mathrm{x}}^{(2)}, E_{\\mathrm{x}}^{(3)}, v_{\\mathrm{x}}^{(3)}, E_{\\mathrm{x}}^{(4)}, v_{\\mathrm{x}}^{(4)}]$,\n  where the superscript indicates the case number. Each number must be rounded to exactly $10$ decimal places. The output must be a comma-separated list enclosed in square brackets, with no additional text.\n\nYour task is to produce a complete, runnable program that carries out this computation and prints the results in the exact format specified above. No user input is required, and no external data should be read. The implementation language and libraries are constrained in the final answer specification.", "solution": "The problem presented is a standard exercise in computational electronic structure theory, specifically concerning the Local Density Approximation (LDA) within the framework of Density Functional Theory (DFT). It is scientifically well-grounded, algorithmically well-defined, and contains all necessary information for a unique solution. The problem is therefore deemed valid and I shall proceed with its resolution.\n\nThe core task is to compute the exchange energy functional $E_{\\mathrm{x}}[n]$ and the corresponding exchange potential $v_{\\mathrm{x}}(\\mathbf{r})$ for several one-dimensional electron density profiles $n(x)$. We begin with the necessary theoretical derivation.\n\n**Step 1: Derivation of the LDA Exchange Energy Density and Potential**\n\nThe Local Density Approximation is founded on the properties of the homogeneous electron gas (HEG), a model system with a constant electron number density $n$. For a spin-unpolarized HEG, the exchange energy per particle, $\\epsilon_{\\mathrm{x}}$, can be calculated exactly using the Hartree-Fock method. In Hartree atomic units ($\\hbar = m_e = e = 4\\pi\\epsilon_0 = 1$), this energy is given by:\n$$\n\\epsilon_{\\mathrm{x}}(n) = -\\frac{3}{4\\pi} k_{\\mathrm{F}}(n)\n$$\nwhere $k_{\\mathrm{F}}$ is the Fermi wave vector. For a three-dimensional HEG, $k_{\\mathrm{F}}$ is related to the density $n$ by:\n$$\nk_{\\mathrm{F}}(n) = (3\\pi^2 n)^{1/3}\n$$\nThe exchange energy density, $\\varepsilon_{\\mathrm{x}}$, is the exchange energy per unit volume. It is obtained by multiplying the energy per particle by the number of particles per unit volume, which is the density $n$:\n$$\n\\varepsilon_{\\mathrm{x}}(n) = n \\cdot \\epsilon_{\\mathrm{x}}(n) = n \\left(-\\frac{3}{4\\pi} k_{\\mathrm{F}}(n)\\right)\n$$\nSubstituting the expression for $k_{\\mathrm{F}}(n)$, we find the exchange energy density for the HEG:\n$$\n\\varepsilon_{\\mathrm{x}}(n) = -\\frac{3n}{4\\pi} (3\\pi^2 n)^{1/3} = -\\frac{3}{4\\pi} (3\\pi^2)^{1/3} n^{1+1/3} = -\\frac{3}{4\\pi} (3\\pi^2)^{1/3} n^{4/3}\n$$\nThis expression can be simplified to the standard form $\\varepsilon_{\\mathrm{x}}(n) = C_{\\mathrm{x}} n^{4/3}$, where $C_{\\mathrm{x}}$ is the Slater exchange constant:\n$$\nC_{\\mathrm{x}} = -\\frac{3}{4\\pi} (3\\pi^2)^{1/3} = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\nIn the LDA, we approximate the total exchange energy of an inhomogeneous system with density $n(\\mathbf{r})$ by integrating the local energy density of a homogeneous system with that same density:\n$$\nE_{\\mathrm{x}}^{\\mathrm{LDA}}[n] = \\int \\varepsilon_{\\mathrm{x}}(n(\\mathbf{r})) \\, d^3\\mathbf{r} = \\int C_{\\mathrm{x}} [n(\\mathbf{r})]^{4/3} \\, d^3\\mathbf{r}\n$$\nThe corresponding Kohn-Sham exchange potential, $v_{\\mathrm{x}}(\\mathbf{r})$, is the functional derivative of the exchange energy functional with respect to the density:\n$$\nv_{\\mathrm{x}}(\\mathbf{r}) = \\frac{\\delta E_{\\mathrm{x}}^{\\mathrm{LDA}}[n]}{\\delta n(\\mathbf{r})}\n$$\nFor a local functional of the form $E[n] = \\int f(n(\\mathbf{r})) \\, d^3\\mathbf{r}$, the functional derivative is simply the ordinary derivative of the integrand with respect to its argument: $\\frac{df(n)}{dn}$. Therefore, the exchange potential is a local function of the density:\n$$\nv_{\\mathrm{x}}(n(\\mathbf{r})) = \\frac{d\\varepsilon_{\\mathrm{x}}(n)}{dn} \\bigg|_{n=n(\\mathbf{r})} = \\frac{d}{dn} (C_{\\mathrm{x}} n^{4/3}) \\bigg|_{n=n(\\mathbf{r})} = \\frac{4}{3} C_{\\mathrm{x}} [n(\\mathbf{r})]^{1/3}\n$$\nIt is noteworthy that for any density $n \\ge 0$, both $\\varepsilon_{\\mathrm{x}}(n)$ and $v_{\\mathrm{x}}(n)$ are well-defined. If $n=0$, then $\\varepsilon_{\\mathrm{x}}(0)=0$ and $v_{\\mathrm{x}}(0)=0$. This ensures no singularities arise in vacuum regions.\n\n**Step 2: Numerical Implementation**\n\nThe problem is defined in one spatial dimension, $x$, over the domain $[0, L]$. We are instructed to assume a unit cross-sectional area, so the volume element $d^3\\mathbf{r}$ becomes $dx$. The total exchange energy is:\n$$\nE_{\\mathrm{x}}[n] = \\int_0^L C_{\\mathrm{x}} [n(x)]^{4/3} \\, dx\n$$\nThis integral is to be computed numerically on a uniform grid of $N$ points, $x_i = i \\cdot \\Delta x$ for $i=0, 1, \\ldots, N-1$, where the grid spacing is $\\Delta x = L/(N-1)$. We will use the trapezoidal rule for numerical quadrature:\n$$\n\\int_0^L f(x) \\, dx \\approx \\Delta x \\left( \\frac{f(x_0) + f(x_{N-1})}{2} + \\sum_{i=1}^{N-2} f(x_i) \\right)\n$$\nThe function to be integrated is the exchange energy density along the grid, $f(x_i) = C_{\\mathrm{x}} [n(x_i)]^{4/3}$.\n\nThe exchange potential $v_{\\mathrm{x}}(x)$ is evaluated at the spatial midpoint, $x = L/2$. Given that $N=10001$ is an odd number, the midpoint of the domain coincides exactly with a grid point. The index for this midpoint is $i_{\\mathrm{mid}} = (N-1)/2 = 5000$. The potential is evaluated as:\n$$\nv_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} [n(x_{i_{\\mathrm{mid}}})]^{1/3}\n$$\n\n**Step 3: Application to Test Cases**\n\nWe will now apply these formulas to the four specified density profiles using the provided parameters. All calculations are performed in Hartree atomic units. The constant $C_{\\mathrm{x}}$ is computed once. The parameters are $L=20\\,a_0$ and $N=10001$.\n\n-   **Case 1 (Gaussian bump):**\n    -   Density: $n(x) = n_0 \\exp\\left(-\\frac{(x - L/2)^2}{2\\sigma^2}\\right)$ with $n_0 = 0.020\\,a_0^{-3}$ and $\\sigma = 2.000\\,a_0$.\n    -   The density profile is generated on the grid. The integrand $C_{\\mathrm{x}}[n(x_i)]^{4/3}$ is computed for each grid point $i$. $E_{\\mathrm{x}}$ is found using the trapezoidal rule.\n    -   The potential is evaluated at $x = L/2$, where $n(L/2) = n_0 = 0.020$. So, $v_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} (0.020)^{1/3}$.\n\n-   **Case 2 (Top-hat slab):**\n    -   Density: $n(x) = n_{\\mathrm{c}} = 0.030\\,a_0^{-3}$ for $x \\in [0.4L, 0.6L]$ (i.e., $[8, 12]$) and $n(x) = 0$ otherwise.\n    -   The piecewise density profile is constructed. The integrand is non-zero only in the region $[8, 12]$. $E_{\\mathrm{x}}$ is computed via the trapezoidal rule.\n    -   The midpoint $x=L/2=10$ lies within the slab, so $n(L/2) = n_{\\mathrm{c}} = 0.030$. The potential is $v_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} (0.030)^{1/3}$.\n\n-   **Case 3 (Exponential decay):**\n    -   Density: $n(x) = n_0 \\exp(-x/\\alpha)$ with $n_0 = 0.040\\,a_0^{-3}$ and $\\alpha = 3.000\\,a_0$.\n    -   The density profile is generated. $E_{\\mathrm{x}}$ is computed via numerical integration of $C_{\\mathrm{x}}[n(x_i)]^{4/3}$.\n    -   The potential is evaluated at the midpoint density $n(L/2) = n(10) = 0.040 \\exp(-10/3)$. Then, $v_{\\mathrm{x}}(L/2) = \\frac{4}{3} C_{\\mathrm{x}} [n(10)]^{1/3}$.\n\n-   **Case 4 (Vacuum):**\n    -   Density: $n(x) = 0$ for all $x$.\n    -   This is a trivial case. Since the density is zero everywhere, the integrand is also zero. Thus, the total exchange energy $E_{\\mathrm{x}}$ is exactly $0$.\n    -   The density at the midpoint is $n(L/2) = 0$, so the exchange potential $v_{\\mathrm{x}}(L/2)$ is also $0$.\n\nThe following program implements precisely this procedure.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the LDA exchange energy and potential for given 1D density profiles.\n    \"\"\"\n    # Define physical constants and simulation parameters in Hartree atomic units.\n    L = 20.0  # Domain length in a_0\n    N = 10001  # Number of grid points\n    \n    # Slater exchange constant C_x = -(3/4)*(3/pi)^(1/3)\n    C_x = -(3.0 / 4.0) * (3.0 / np.pi)**(1.0 / 3.0)\n\n    # Define the spatial grid\n    x_grid = np.linspace(0, L, N)\n    \n    # Midpoint index for potential evaluation\n    mid_idx = (N - 1) // 2\n    if x_grid[mid_idx] != L / 2.0:\n        # This should not happen for odd N\n        raise ValueError(\"Midpoint is not on the grid.\")\n\n    # Define test cases\n    test_cases = [\n        # Case 1: Gaussian bump\n        {'type': 'gaussian', 'n0': 0.020, 'sigma': 2.000},\n        # Case 2: Top-hat slab\n        {'type': 'tophat', 'nc': 0.030, 'xmin_frac': 0.4, 'xmax_frac': 0.6},\n        # Case 3: Exponential decay\n        {'type': 'exponential', 'n0': 0.040, 'alpha': 3.000},\n        # Case 4: Vacuum\n        {'type': 'vacuum'},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        case_type = params['type']\n        n_x = np.zeros_like(x_grid)\n\n        if case_type == 'gaussian':\n            n0 = params['n0']\n            sigma = params['sigma']\n            L_half = L / 2.0\n            n_x = n0 * np.exp(-((x_grid - L_half)**2) / (2 * sigma**2))\n        \n        elif case_type == 'tophat':\n            nc = params['nc']\n            xmin = params['xmin_frac'] * L\n            xmax = params['xmax_frac'] * L\n            mask = (x_grid >= xmin) & (x_grid <= xmax)\n            n_x[mask] = nc\n\n        elif case_type == 'exponential':\n            n0 = params['n0']\n            alpha = params['alpha']\n            n_x = n0 * np.exp(-x_grid / alpha)\n\n        elif case_type == 'vacuum':\n            # n_x is already an array of zeros\n            pass\n        \n        # Calculate total exchange energy E_x using the trapezoidal rule\n        # Integrand is C_x * n(x)^(4/3)\n        # We need to be careful with n=0 to avoid warnings, although n**(4/3) is 0.\n        # np.power handles this correctly.\n        integrand = C_x * np.power(n_x, 4.0 / 3.0)\n        E_x = np.trapz(integrand, x_grid)\n\n        # Calculate exchange potential v_x at the midpoint x = L/2\n        # v_x(n) = (4/3) * C_x * n^(1/3)\n        n_mid = n_x[mid_idx]\n        v_x_mid = (4.0 / 3.0) * C_x * np.power(n_mid, 1.0 / 3.0)\n\n        # Append results, rounded to 10 decimal places\n        results.append(round(E_x, 10))\n        results.append(round(v_x_mid, 10))\n\n    # Format output as a single comma-separated list in brackets\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2813517"}, {"introduction": "While approximations like the LDA are remarkably successful, they are not exact and possess known limitations. One of the most significant is the self-interaction error (SIE), where an electron spuriously interacts with itself. This hands-on derivation challenges you to quantify this error for a simple one-electron system, where the error should ideally be zero [@problem_id:2813500]. By analytically calculating the incomplete cancellation between the Hartree self-repulsion and the LDA self-exchange, you will develop a deep, quantitative understanding of this fundamental flaw in common density functionals.", "problem": "Consider a one-electron hydrogenic ion of nuclear charge $Z$ in atomic units (Hartree atomic unit system with $a_{0}=1$, $e=1$, $\\hbar=1$). The ground-state Kohn–Sham spin density is fully spin-polarized and given by $n(\\mathbf{r})=\\left|\\psi_{1s}(\\mathbf{r})\\right|^{2}$ with the normalized hydrogenic $1s$ orbital $\\psi_{1s}(\\mathbf{r})=\\left(Z^{3}/\\pi\\right)^{1/2}\\exp(-Z r)$. The self-interaction error (SIE) for a single electron in a given approximate functional is defined here as the sum of its Hartree electrostatic energy and its approximate exchange energy, $E_{\\mathrm{SIE}}[n]=E_{H}[n]+E_{x}^{\\mathrm{approx}}[n]$. Use the following foundational definitions:\n- The Hartree energy $E_{H}[n]=\\frac{1}{2}\\int d^{3}r\\int d^{3}r'\\,\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$.\n- The exchange energy is approximated using the spin-unpolarized Local Density Approximation (LDA) form: $E_{x}^{\\mathrm{LDA}}[n]=- \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int d^{3}r\\,n(\\mathbf{r})^{4/3}$.\nAssume exchange-only (neglect correlation). Starting from these definitions and the provided $n(\\mathbf{r})$, derive a closed-form analytic expression for $E_{\\mathrm{SIE}}(Z)=E_{H}[n]+E_{x}^{\\mathrm{LDA}}[n]$ as a function of $Z$. Express your final answer in atomic units and do not approximate or round; provide an exact expression in terms of $Z$, $\\pi$, and rational numbers. Your final answer must be a single analytical expression.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded within the framework of density functional theory, well-posed, and objective. It provides all necessary definitions and data to derive a unique analytical solution. The task is to compute the self-interaction error, defined as the sum of the Hartree energy and the approximate exchange energy, for a one-electron hydrogenic system. The calculation will proceed in two stages: first, the calculation of the Hartree energy $E_{H}[n]$, and second, the calculation of the Local Density Approximation (LDA) exchange energy $E_{x}^{\\mathrm{LDA}}[n]$.\n\nThe electron density for the ground state of the hydrogenic ion is given by:\n$$n(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^2 = \\left| \\left(\\frac{Z^3}{\\pi}\\right)^{1/2}\\exp(-Z r) \\right|^2 = \\frac{Z^3}{\\pi}\\exp(-2Zr)$$\nSince the density is spherically symmetric, we denote it as $n(r)$. The total number of electrons is $\\int n(r) d^3r = \\int_0^\\infty 4\\pi r^2 \\frac{Z^3}{\\pi} \\exp(-2Zr) dr = 1$, as expected.\n\nPart 1: Calculation of the Hartree Energy $E_{H}[n]$.\nThe Hartree energy is the classical electrostatic self-energy of the charge distribution $n(r)$:\n$$E_{H}[n]=\\frac{1}{2}\\int d^{3}r\\int d^{3}r'\\,\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$$\nThis can be expressed as $E_H[n] = \\frac{1}{2}\\int d^3r \\, n(r) \\phi(r)$, where $\\phi(r)$ is the electrostatic potential generated by the density $n(r)$. For a spherically symmetric density, the potential at radius $r$ is given by:\n$$\\phi(r) = \\frac{1}{r} \\int_0^r 4\\pi r'^2 n(r') dr' + \\int_r^\\infty 4\\pi r' n(r') dr'$$\nFirst, we compute the required integrals involving $n(r')$.\nThe enclosed charge up to radius $r$:\n$$Q(r) = \\int_0^r 4\\pi r'^2 n(r') dr' = 4\\pi \\int_0^r r'^2 \\frac{Z^3}{\\pi} \\exp(-2Zr') dr' = 4Z^3 \\int_0^r r'^2 \\exp(-2Zr') dr'$$\nUsing standard integral formulas, this yields:\n$$Q(r) = 4Z^3 \\left[ -\\frac{\\exp(-2Zr')}{2Z} \\left( r'^2 + \\frac{r'}{Z} + \\frac{1}{2Z^2} \\right) \\right]_0^r = 1 - (2Z^2r^2 + 2Zr + 1)\\exp(-2Zr)$$\nThe second part of the potential is:\n$$\\int_r^\\infty 4\\pi r' n(r') dr' = 4Z^3 \\int_r^\\infty r' \\exp(-2Zr') dr' = 4Z^3 \\left[ -\\frac{\\exp(-2Zr')}{2Z} \\left(r' + \\frac{1}{2Z}\\right) \\right]_r^\\infty = Z(2Zr+1)\\exp(-2Zr)$$\nCombining these terms, the potential is:\n$$\\phi(r) = \\frac{Q(r)}{r} + Z(2Zr+1)\\exp(-2Zr) = \\frac{1 - (2Z^2r^2 + 2Zr + 1)\\exp(-2Zr)}{r} + Z(2Zr+1)\\exp(-2Zr) = \\frac{1}{r} - \\left(\\frac{1}{r}+Z\\right)\\exp(-2Zr)$$\nNow we compute the Hartree energy:\n$$E_H[n] = \\frac{1}{2} \\int_0^\\infty 4\\pi r^2 n(r) \\phi(r) dr = 2\\pi \\int_0^\\infty r^2 \\left(\\frac{Z^3}{\\pi}\\exp(-2Zr)\\right) \\left(\\frac{1}{r} - \\left(\\frac{1}{r}+Z\\right)\\exp(-2Zr)\\right) dr$$\n$$E_H[n] = 2Z^3 \\int_0^\\infty \\left(r\\exp(-2Zr) - (r+Zr^2)\\exp(-4Zr)\\right) dr$$\nThe integral separates into three standard gamma-type integrals of the form $\\int_0^\\infty x^k e^{-ax} dx = k!/a^{k+1}$:\n$$ \\int_0^\\infty r\\exp(-2Zr) dr = \\frac{1!}{(2Z)^{2}} = \\frac{1}{4Z^2} $$\n$$ \\int_0^\\infty r\\exp(-4Zr) dr = \\frac{1!}{(4Z)^{2}} = \\frac{1}{16Z^2} $$\n$$ \\int_0^\\infty r^2\\exp(-4Zr) dr = \\frac{2!}{(4Z)^{3}} = \\frac{2}{64Z^3} = \\frac{1}{32Z^3} $$\nSubstituting these results back into the expression for $E_H[n]$:\n$$E_H[n] = 2Z^3 \\left( \\frac{1}{4Z^2} - \\frac{1}{16Z^2} - Z\\frac{1}{32Z^3} \\right) = 2Z^3 \\left( \\frac{1}{4Z^2} - \\frac{1}{16Z^2} - \\frac{1}{32Z^2} \\right)$$\n$$E_H[n] = 2Z \\left( \\frac{8}{32} - \\frac{2}{32} - \\frac{1}{32} \\right) = 2Z \\left( \\frac{5}{32} \\right) = \\frac{5}{16}Z$$\n\nPart 2: Calculation of the LDA Exchange Energy $E_{x}^{\\mathrm{LDA}}[n]$.\nThe problem specifies the use of the spin-unpolarized LDA exchange functional:\n$$E_{x}^{\\mathrm{LDA}}[n] = - C_x \\int n(\\mathbf{r})^{4/3} d^{3}r \\quad \\text{with} \\quad C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$$\nWe must compute the integral of $n(r)^{4/3}$:\n$$n(r)^{4/3} = \\left(\\frac{Z^3}{\\pi}\\exp(-2Zr)\\right)^{4/3} = \\frac{Z^4}{\\pi^{4/3}}\\exp\\left(-\\frac{8Zr}{3}\\right)$$\nThe spatial integral is:\n$$\\int n(r)^{4/3} d^3r = \\int_0^\\infty 4\\pi r^2 \\left(\\frac{Z^4}{\\pi^{4/3}}\\exp\\left(-\\frac{8Zr}{3}\\right)\\right) dr$$\n$$ = 4\\pi Z^4 \\pi^{-4/3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{8Zr}{3}\\right) dr = 4\\pi^{-1/3} Z^4 \\int_0^\\infty r^2 \\exp\\left(-\\frac{8Zr}{3}\\right) dr$$\nUsing the gamma-type integral again with $k=2$ and $a = 8Z/3$:\n$$\\int_0^\\infty r^2 \\exp\\left(-\\frac{8Zr}{3}\\right) dr = \\frac{2!}{\\left(\\frac{8Z}{3}\\right)^3} = \\frac{2 \\cdot 3^3}{8^3 Z^3} = \\frac{54}{512 Z^3} = \\frac{27}{256 Z^3}$$\nSubstituting this into the expression for the spatial integral:\n$$\\int n(r)^{4/3} d^3r = 4\\pi^{-1/3} Z^4 \\left(\\frac{27}{256 Z^3}\\right) = \\frac{108}{256} \\frac{Z}{\\pi^{1/3}} = \\frac{27}{64} \\frac{Z}{\\pi^{1/3}}$$\nNow, the LDA exchange energy is:\n$$E_{x}^{\\mathrm{LDA}}[n] = - \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64} \\frac{Z}{\\pi^{1/3}}\\right) = - \\frac{3 \\cdot 3^{1/3}}{4 \\cdot \\pi^{1/3}} \\frac{27 Z}{64 \\pi^{1/3}} = - \\frac{3 \\cdot 3^{1/3} \\cdot 3^3}{256 \\pi^{2/3}} Z = - \\frac{3^{4+1/3}}{256 \\pi^{2/3}} Z = - \\frac{3^{13/3}}{256 \\pi^{2/3}} Z$$\n\nPart 3: Total Self-Interaction Error $E_{\\mathrm{SIE}}(Z)$.\nThe self-interaction error is the sum of the two calculated components:\n$$E_{\\mathrm{SIE}}(Z) = E_{H}[n] + E_{x}^{\\mathrm{LDA}}[n] = \\frac{5}{16}Z - \\frac{3^{13/3}}{256 \\pi^{2/3}}Z$$\nFactoring out $Z$:\n$$E_{\\mathrm{SIE}}(Z) = \\left(\\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\\right)Z$$\nThis is the final closed-form analytical expression for the self-interaction error as a function of $Z$.", "answer": "$$\\boxed{Z \\left(\\frac{5}{16} - \\frac{3^{13/3}}{256 \\pi^{2/3}}\\right)}$$", "id": "2813500"}, {"introduction": "Standard local and semi-local DFT functionals famously fail to describe long-range van der Waals or dispersion forces, which are critical for the structure and stability of molecules and materials. This practice delves into the physics of these nonlocal correlation effects, starting from the powerful Adiabatic Connection Fluctuation-Dissipation Theorem. You will derive the classic London dispersion interaction law using a simple yet insightful Drude oscillator model for atomic polarizability, and then implement a damped energy model to see how these corrections are applied in practice [@problem_id:2813503]. This exercise provides a window into the methods used to make DFT a truly universal tool for materials modeling.", "problem": "Consider two well-separated, isotropic fragments embedded in vacuum, modeled within the framework of Density Functional Theory (DFT). The nonlocal correlation energy responsible for dispersion (van der Waals) interactions can be derived from the Adiabatic Connection Fluctuation-Dissipation Theorem (ACFDT). Starting from the ACFDT expression for the correlation energy and using a second-order expansion in the interfragment Coulomb coupling in the dipole-dipole approximation, derive the leading-order asymptotic form of the interaction energy between the fragments in terms of their frequency-dependent dipole polarizabilities evaluated on the imaginary frequency axis. Then, assume each fragment follows a single-oscillator (Drude) model for its isotropic polarizability, given by $\\alpha(i\\omega) = \\dfrac{\\alpha_0}{1 + (\\omega/\\omega_0)^2}$, where $\\alpha_0$ is the static polarizability and $\\omega_0$ is a characteristic excitation frequency. From first principles, obtain a closed-form expression for the asymptotic interaction coefficient in atomic units and hence the asymptotic interaction energy as a function of the center-to-center separation $R$.\n\nTo regularize the unphysical short-range divergence while preserving the correct long-range limit, adopt a sixth-order Tang-Toennies damping factor for the dispersion term, defined by\n$$\nf_6(x) = 1 - e^{-x} \\sum_{k=0}^{6} \\frac{x^k}{k!},\n$$\nwith $x = b R$, where $b$ is a positive damping parameter. The damped interaction energy should be constructed by multiplying the asymptotic dispersion term by $f_6(bR)$.\n\nUsing atomic units throughout, where distances are measured in Bohr radii ($a_0$) and energies in Hartree ($E_h$), implement a program that:\n- Derives the asymptotic interaction coefficient in closed form under the Drude model assumptions stated above.\n- Computes the damped nonlocal correlation (dispersion) energy for each of the following test cases, in Hartree ($E_h$).\n- Rounds each energy to $12$ decimal places.\n- Produces a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nTest suite (each case is an ordered sextuple $(\\alpha_{A0}, \\omega_A, \\alpha_{B0}, \\omega_B, R, b)$, with $\\alpha$ in $a_0^3$, $\\omega$ in $E_h$, $R$ in $a_0$, and $b$ in $a_0^{-1}$):\n- Case $1$: $(\\alpha_{A0} = 10.0, \\omega_A = 0.3, \\alpha_{B0} = 10.0, \\omega_B = 0.3, R = 10.0, b = 1.0)$.\n- Case $2$: $(\\alpha_{A0} = 5.0, \\omega_A = 0.5, \\alpha_{B0} = 12.0, \\omega_B = 0.2, R = 8.0, b = 1.5)$.\n- Case $3$: $(\\alpha_{A0} = 20.0, \\omega_A = 0.25, \\alpha_{B0} = 15.0, \\omega_B = 0.35, R = 30.0, b = 0.7)$.\n- Case $4$: $(\\alpha_{A0} = 40.0, \\omega_A = 0.2, \\alpha_{B0} = 30.0, \\omega_B = 0.25, R = 2.0, b = 2.0)$.\n- Case $5$: $(\\alpha_{A0} = 2.0, \\omega_A = 1.5, \\alpha_{B0} = 1.5, \\omega_B = 2.0, R = 12.0, b = 1.0)$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite, with each value rounded to $12$ decimal places, in $E_h$, for example, $[r_1,r_2,r_3,r_4,r_5]$.", "solution": "The problem statement is scientifically sound, well-posed, and provides all necessary information for a unique solution. The concepts invoked, such as the Adiabatic Connection Fluctuation-Dissipation Theorem (ACFDT), the Casimir-Polder formula for dispersion interactions, the Drude model for polarizability, and Tang-Toennies damping, are all standard and well-established in the field of materials physics and quantum chemistry. Therefore, the problem is valid, and a solution can be constructed.\n\nThe derivation of the interaction energy begins with the expression for the van der Waals dispersion energy between two fragments, $A$ and $B$, which arises at second order in perturbation theory from the ACFDT framework. For two well-separated, non-overlapping fragments, this interaction energy, $E_{\\text{disp}}^{(2)}$, is given by the integral over imaginary frequency $\\omega$:\n$$\nE_{\\text{disp}}^{(2)} = -\\frac{1}{2\\pi} \\int_0^\\infty d\\omega \\, \\text{Tr} \\left[ \\chi_A(i\\omega) v_{AB} \\chi_B(i\\omega) v_{BA} \\right]\n$$\nHere, $\\chi_A(i\\omega)$ and $\\chi_B(i\\omega)$ are the density-density response functions of the isolated fragments $A$ and $B$, respectively, evaluated at imaginary frequency $i\\omega$. The term $v_{AB}$ represents the Coulomb interaction operator between the electrons of fragment $A$ and fragment $B$.\n\nFor large center-to-center separation $R$, the Coulomb operator $v_{AB}$ can be expanded in a multipole series. The leading and dominant term is the dipole-dipole interaction. In this approximation, the interaction operator is replaced by the dipole-dipole interaction tensor $\\mathbf{T}_{AB}$. For fragments with isotropic frequency-dependent dipole polarizabilities, $\\alpha_A(i\\omega)$ and $\\alpha_B(i\\omega)$, the trace in the energy expression simplifies significantly. The polarizability tensor for an isotropic fragment is $\\boldsymbol{\\alpha}(i\\omega) = \\alpha(i\\omega)\\mathbf{I}$, where $\\mathbf{I}$ is the identity matrix. The trace becomes:\n$$\n\\text{Tr} \\left[ \\chi_A v_{AB} \\chi_B v_{BA} \\right] \\rightarrow \\text{Tr} \\left[ \\boldsymbol{\\alpha}_A(i\\omega) \\mathbf{T}_{AB} \\boldsymbol{\\alpha}_B(i\\omega) \\mathbf{T}_{BA} \\right] = \\alpha_A(i\\omega)\\alpha_B(i\\omega) \\text{Tr}\\left(\\mathbf{T}_{AB}^2\\right)\n$$\nThe square of the dipole-dipole interaction tensor, $\\mathbf{T}_{AB}$, has a trace that is independent of the orientation of the fragments and evaluates to $\\text{Tr}\\left(\\mathbf{T}_{AB}^2\\right) = 6/R^6$. Substituting this back into the energy expression yields the celebrated Casimir-Polder formula for the asymptotic dispersion energy:\n$$\nE_{\\text{disp}}^{asym}(R) = -\\frac{3}{\\pi R^6} \\int_0^\\infty d\\omega \\, \\alpha_A(i\\omega) \\alpha_B(i\\omega)\n$$\nThis expression is of the form $E_{\\text{disp}}^{asym}(R) = -C_6/R^6$, where the London dispersion coefficient $C_6$ is given by the integral:\n$$\nC_6 = \\frac{3}{\\pi} \\int_0^\\infty d\\omega \\, \\alpha_A(i\\omega) \\alpha_B(i\\omega)\n$$\nThe problem provides the single-oscillator (Drude) model for the isotropic polarizability of each fragment:\n$$\n\\alpha_A(i\\omega) = \\frac{\\alpha_{A0}}{1 + (\\omega/\\omega_A)^2}, \\quad \\alpha_B(i\\omega) = \\frac{\\alpha_{B0}}{1 + (\\omega/\\omega_B)^2}\n$$\nwhere $\\alpha_{A0}$ and $\\alpha_{B0}$ are the static polarizabilities and $\\omega_A$ and $\\omega_B$ are the characteristic excitation frequencies for fragments $A$ and $B$, respectively. All quantities are in atomic units.\n\nSubstituting these model polarizabilities into the expression for $C_6$ gives:\n$$\nC_6 = \\frac{3 \\alpha_{A0} \\alpha_{B0}}{\\pi} \\int_0^\\infty \\frac{d\\omega}{\\left(1 + (\\omega/\\omega_A)^2\\right)\\left(1 + (\\omega/\\omega_B)^2\\right)}\n$$\nThis integral can be solved analytically using partial fraction decomposition. The result of the definite integral is:\n$$\n\\int_0^\\infty \\frac{d\\omega}{\\left(1 + (\\omega/\\omega_A)^2\\right)\\left(1 + (\\omega/\\omega_B)^2\\right)} = \\frac{\\pi}{2} \\frac{\\omega_A \\omega_B}{\\omega_A + \\omega_B}\n$$\nPlugging this result back into the expression for $C_6$, we obtain the closed-form expression for the asymptotic interaction coefficient under the Drude model:\n$$\nC_6 = \\frac{3 \\alpha_{A0} \\alpha_{B0}}{\\pi} \\left( \\frac{\\pi}{2} \\frac{\\omega_A \\omega_B}{\\omega_A + \\omega_B} \\right) = \\frac{3}{2} \\frac{\\alpha_{A0} \\alpha_{B0} \\omega_A \\omega_B}{\\omega_A + \\omega_B}\n$$\nThe asymptotic interaction energy is therefore $E_{\\text{disp}}^{asym}(R) = -C_6/R^6$. This expression diverges unphysically as $R \\rightarrow 0$. To correct this behavior at short range while preserving the correct long-range asymptotic limit, a damping function is applied. The problem specifies a sixth-order Tang-Toennies damping factor $f_6(x)$:\n$$\nf_6(x) = 1 - e^{-x} \\sum_{k=0}^{6} \\frac{x^k}{k!}\n$$\nwhere the argument is $x = bR$, with $b$ being a damping parameter. The damped interaction energy is then constructed by multiplying the asymptotic energy by this damping factor:\n$$\nE_{\\text{disp}}^{damped}(R) = E_{\\text{disp}}^{asym}(R) \\cdot f_6(bR) = -\\frac{C_6}{R^6} f_6(bR)\n$$\nNote that the function $f_6(x)$ is equivalent to the regularized lower incomplete gamma function, $f_6(x) = P(7, x) = \\gamma(7, x)/\\Gamma(7)$.\n\nThe following python program implements this final formula to calculate the damped dispersion energy for the provided test cases. First, it calculates the $C_6$ coefficient. Then, it computes the damped energy using the Tang-Toennies function $f_6(bR)$ and rounds the result to $12$ decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.special\n\ndef solve():\n    \"\"\"\n    Derives and computes the damped nonlocal correlation (dispersion) energy between two fragments\n    using a Drude model for polarizability and a Tang-Toennies damping function, based on DFT principles.\n    \"\"\"\n    \n    # Test cases: (alpha_A0, omega_A, alpha_B0, omega_B, R, b)\n    # alpha in a_0^3, omega in E_h, R in a_0, b in a_0^-1\n    test_cases = [\n        (10.0, 0.3, 10.0, 0.3, 10.0, 1.0),\n        (5.0, 0.5, 12.0, 0.2, 8.0, 1.5),\n        (20.0, 0.25, 15.0, 0.35, 30.0, 0.7),\n        (40.0, 0.2, 30.0, 0.25, 2.0, 2.0),\n        (2.0, 1.5, 1.5, 2.0, 12.0, 1.0),\n    ]\n\n    results = []\n\n    def tang_toennies_f6(x):\n        \"\"\"\n        Calculates the sixth-order Tang-Toennies damping factor f_6(x).\n        f_6(x) = 1 - exp(-x) * sum_{k=0 to 6} (x^k / k!)\n        This is equivalent to the regularized lower incomplete gamma function P(7, x).\n        \"\"\"\n        # The sum is for k from 0 to n=6. The first argument to gammainc is n+1.\n        return scipy.special.gammainc(6 + 1, x)\n\n    for case in test_cases:\n        alpha_A0, omega_A, alpha_B0, omega_B, R, b = case\n\n        # Calculate the C6 coefficient in atomic units.\n        # C6 = (3/2) * (alpha_A0 * alpha_B0 * omega_A * omega_B) / (omega_A + omega_B)\n        c6 = 1.5 * (alpha_A0 * alpha_B0 * omega_A * omega_B) / (omega_A + omega_B)\n\n        # Calculate the asymptotic dispersion energy.\n        # E_asym = -C6 / R^6\n        e_asym = -c6 / (R**6)\n\n        # Calculate the argument for the damping function.\n        x = b * R\n\n        # Calculate the damping factor.\n        damping_factor = tang_toennies_f6(x)\n        \n        # Calculate the damped interaction energy.\n        e_damped = e_asym * damping_factor\n\n        # Round the result to 12 decimal places and store it.\n        results.append(round(e_damped, 12))\n\n    # Format and print the final output as a single-line string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2813503"}]}