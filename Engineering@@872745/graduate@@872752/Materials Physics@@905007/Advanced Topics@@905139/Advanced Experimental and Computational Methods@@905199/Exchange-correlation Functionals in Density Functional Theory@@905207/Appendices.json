{"hands_on_practices": [{"introduction": "The first step beyond the Local Density Approximation (LDA) is the Generalized Gradient Approximation (GGA), which incorporates information about the local gradient of the electron density. This allows the functional to better describe inhomogeneous systems. This exercise provides a concrete, analytical calculation that highlights the fundamental difference between LDA and a PBE-type GGA, focusing on the role of the dimensionless reduced density gradient, $s(\\mathbf{r})$, in creating the gradient correction [@problem_id:2821030].", "problem": "Consider a spin-unpolarized planar electron density relevant to a jellium surface model in materials physics. The electron density depends only on the coordinate $x$ normal to the surface and is uniform in the transverse directions over unit area. The model density is\n$$\nn(x) \\;=\\; n_{0}\\,\\exp\\!\\big(-\\alpha\\,|x|\\big), \\quad \\alpha>0,\\; n_{0}>0,\n$$\nwith the integral taken over $x \\in (-\\infty,\\infty)$. Work within the framework of Kohn–Sham density functional theory and focus on the exchange contribution only (neglect correlation). Start from the following foundational elements:\n\n- The Local Density Approximation (LDA) exchange energy density derived from the homogeneous electron gas, expressed per unit volume as $e_{x}^{\\mathrm{LDA}}(n) = -C_{x}\\,n^{4/3}$, where $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$.\n- The reduced density gradient for exchange, defined by $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$, with the local Fermi wavevector $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2}n(\\mathbf{r})\\big)^{1/3}$ for a spin-unpolarized system.\n- The small-$s$ second-order gradient expansion consistent with a Generalized Gradient Approximation (GGA) of the Perdew–Burke–Ernzerhof (PBE) type for exchange, in which the enhancement factor is $F_{x}(s) \\approx 1 + \\mu\\, s^{2}$, where $\\mu$ is the standard PBE exchange gradient coefficient. Assume that this second-order form is valid for the present model density.\n\nTasks:\n1) Using these definitions, write the exchange energy per unit area in LDA, $E_{x}^{\\mathrm{LDA}}$, and the second-order GGA correction implied by the PBE form, $E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}$, in terms of $n(x)$ and $s(x)$.\n2) For the given $n(x)$, evaluate the resulting integrals exactly to obtain a closed-form analytic expression for the difference\n$$\n\\Delta E_{x} \\;=\\; E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}\n$$\nper unit area, as a function of $n_{0}$, $\\alpha$, $\\mu$, and fundamental constants.\n3) Briefly, in one or two sentences, explain how the spatial dependence of $s(x)$ controls the sign and magnitude of $\\Delta E_{x}$ for this density profile.\n\nExpress your final answer as a single closed-form analytic expression for $\\Delta E_{x}$ per unit area. Do not insert numerical values for constants. No rounding is required. Do not include units in the final answer box.", "solution": "The problem statement has been validated and found to be scientifically sound, well-posed, and objective. It poses a standard theoretical calculation within the framework of density functional theory, utilizing established definitions and a valid model system. We may therefore proceed with a rigorous derivation of the solution.\n\nThe problem requires the calculation of the difference between the Generalized Gradient Approximation (GGA) and Local Density Approximation (LDA) exchange energies for a specific one-dimensional electron density profile. The tasks are addressed sequentially.\n\n1) First, we formulate the general expressions for the exchange energy per unit area. The total exchange energy, $E_x$, is the spatial integral of the exchange energy density, $e_x$. For a system described by a density $n(x)$ that is uniform over a unit area in the transverse directions, this is given by an integral over the coordinate $x$.\n\nThe LDA exchange energy per unit area, $E_{x}^{\\mathrm{LDA}}$, is obtained by integrating the LDA exchange energy density $e_{x}^{\\mathrm{LDA}}(n) = -C_{x}n^{4/3}$:\n$$\nE_{x}^{\\mathrm{LDA}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) \\,dx = -C_{x} \\int_{-\\infty}^{\\infty} n(x)^{4/3} \\,dx\n$$\nThe GGA exchange energy is given by $E_{x}^{\\mathrm{GGA}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) F_{x}(s(x)) \\,dx$. Using the provided second-order expansion for the PBE-type enhancement factor, $F_{x}(s) \\approx 1 + \\mu s^{2}$, the corresponding exchange energy per unit area, $E_{x}^{\\mathrm{PBE}}$, becomes:\n$$\nE_{x}^{\\mathrm{PBE}} = \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) \\left(1 + \\mu s(x)^{2}\\right) \\,dx\n$$\nThe difference, $\\Delta E_{x} = E_{x}^{\\mathrm{PBE}} - E_{x}^{\\mathrm{LDA}}$, which represents the second-order gradient correction, is therefore:\n$$\n\\Delta E_{x} = \\int_{-\\infty}^{\\infty} \\left[ e_{x}^{\\mathrm{LDA}}(n(x))(1 + \\mu s(x)^{2}) - e_{x}^{\\mathrm{LDA}}(n(x)) \\right] \\,dx = \\mu \\int_{-\\infty}^{\\infty} e_{x}^{\\mathrm{LDA}}(n(x)) s(x)^{2} \\,dx\n$$\nSubstituting the expression for $e_{x}^{\\mathrm{LDA}}(n)$, we arrive at the required expression for the correction:\n$$\n\\Delta E_{x} = -\\mu C_{x} \\int_{-\\infty}^{\\infty} n(x)^{4/3} s(x)^{2} \\,dx\n$$\n\n2) Next, we evaluate this integral for the given density profile $n(x) = n_{0}\\exp(-\\alpha|x|)$. The first step is to calculate the reduced density gradient, $s(x)$. The gradient of the density is $\\nabla n(x) = \\frac{dn}{dx}\\mathbf{\\hat{x}}$. For $x \\neq 0$, the derivative is $\\frac{dn}{dx} = -\\alpha \\, \\mathrm{sgn}(x) \\, n_{0}\\exp(-\\alpha|x|) = -\\alpha \\, \\mathrm{sgn}(x) \\, n(x)$. The magnitude of the gradient is $|\\nabla n(x)| = \\alpha n(x)$.\n\nThe reduced gradient $s(x)$ is defined as $s(x) = \\frac{|\\nabla n(x)|}{2k_{F}(x)n(x)}$, where $k_{F}(x) = (3\\pi^{2}n(x))^{1/3}$. Substituting the expressions for $|\\nabla n(x)|$ and $k_{F}(x)$:\n$$\ns(x) = \\frac{\\alpha n(x)}{2\\left(3\\pi^{2}n(x)\\right)^{1/3}n(x)} = \\frac{\\alpha}{2(3\\pi^{2})^{1/3}n(x)^{1/3}}\n$$\nNow we can evaluate the integrand $n(x)^{4/3} s(x)^{2}$:\n$$\nn(x)^{4/3} s(x)^{2} = n(x)^{4/3} \\left( \\frac{\\alpha}{2(3\\pi^{2})^{1/3}n(x)^{1/3}} \\right)^{2} = n(x)^{4/3} \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}n(x)^{2/3}} = \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}} n(x)^{2/3}\n$$\nSubstituting this simplified result into the expression for $\\Delta E_{x}$:\n$$\n\\Delta E_{x} = -\\mu C_{x} \\int_{-\\infty}^{\\infty} \\frac{\\alpha^{2}}{4(3\\pi^{2})^{2/3}} n(x)^{2/3} \\,dx = -\\frac{\\mu C_{x} \\alpha^{2}}{4(3\\pi^{2})^{2/3}} \\int_{-\\infty}^{\\infty} n(x)^{2/3} \\,dx\n$$\nWe now evaluate the remaining integral. The integrand is an even function, so we can integrate from $0$ to $\\infty$ and multiply by $2$.\n$$\n\\int_{-\\infty}^{\\infty} n(x)^{2/3} \\,dx = \\int_{-\\infty}^{\\infty} \\left(n_{0}\\exp(-\\alpha|x|)\\right)^{2/3} \\,dx = n_{0}^{2/3} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2\\alpha|x|}{3}\\right) \\,dx\n$$\n$$\n= 2 n_{0}^{2/3} \\int_{0}^{\\infty} \\exp\\left(-\\frac{2\\alpha x}{3}\\right) \\,dx = 2 n_{0}^{2/3} \\left[ -\\frac{3}{2\\alpha} \\exp\\left(-\\frac{2\\alpha x}{3}\\right) \\right]_{0}^{\\infty} = 2 n_{0}^{2/3} \\left( 0 - \\left(-\\frac{3}{2\\alpha}\\right) \\right) = \\frac{3 n_{0}^{2/3}}{\\alpha}\n$$\nInserting this result back into the expression for $\\Delta E_{x}$:\n$$\n\\Delta E_{x} = -\\frac{\\mu C_{x} \\alpha^{2}}{4(3\\pi^{2})^{2/3}} \\left( \\frac{3 n_{0}^{2/3}}{\\alpha} \\right) = -\\frac{3 \\mu C_{x} \\alpha n_{0}^{2/3}}{4(3\\pi^{2})^{2/3}}\n$$\nFinally, we substitute the definition of the constant $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$:\n$$\n\\Delta E_{x} = -\\frac{3 \\mu \\alpha n_{0}^{2/3}}{4(3\\pi^{2})^{2/3}} \\left( \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\right) = -\\frac{9}{16} \\frac{\\mu \\alpha n_{0}^{2/3}}{(3^{2/3}\\pi^{4/3})} (3^{1/3}\\pi^{-1/3})\n$$\n$$\n= -\\frac{9}{16} \\mu \\alpha n_{0}^{2/3} (3^{1/3-2/3}) (\\pi^{-1/3-4/3}) = -\\frac{9}{16} \\mu \\alpha n_{0}^{2/3} 3^{-1/3} \\pi^{-5/3}\n$$\nSince $9 = 3^{2}$, we have $9 \\cdot 3^{-1/3} = 3^{2 - 1/3} = 3^{5/3}$. The final expression is:\n$$\n\\Delta E_{x} = -\\frac{3^{5/3}}{16} \\mu \\alpha n_{0}^{2/3} \\pi^{-5/3} = -\\frac{\\mu \\alpha n_{0}^{2/3}}{16} \\left(\\frac{3}{\\pi}\\right)^{5/3}\n$$\n\n3) The sign and magnitude of $\\Delta E_{x}$ are controlled by the integrand $\\mu s(x)^2 e_{x}^{\\mathrm{LDA}}(n(x))$. As the exchange gradient coefficient $\\mu$ and $s(x)^2$ are positive, while the LDA energy density $e_{x}^{\\mathrm{LDA}}(n(x))$ is negative for any non-zero density, the integrand is everywhere negative, resulting in a strictly negative energy correction $\\Delta E_{x}$. The magnitude of the local contribution is set by the competition between the reduced gradient $s(x)$, which increases exponentially away from the center, and the density $n(x)$, which decays exponentially; for this specific profile, their combined effect produces an integrand proportional to $n(x)^{2/3}$, whose contribution to the total energy is largest at the density maximum ($x=0$) and decays symmetrically outwards.", "answer": "$$\n\\boxed{-\\frac{\\mu \\alpha n_{0}^{2/3}}{16} \\left(\\frac{3}{\\pi}\\right)^{5/3}}\n$$", "id": "2821030"}, {"introduction": "Hybrid functionals, which mix a fraction of exact (Hartree-Fock) exchange with a GGA functional, represent a major advance in accuracy. This practice takes you \"under the hood\" of the widely-used PBE0 hybrid functional to reveal its theoretical origins. By starting from the adiabatic connection formalism, you will derive the famous $1/4$ mixing parameter, demonstrating that it arises from a set of simple, physically motivated constraints rather than empirical fitting [@problem_id:2821028].", "problem": "In the adiabatic connection formalism of Kohn–Sham density functional theory, for a fixed ground-state electron density $n(\\mathbf{r})$, one defines a family of Hamiltonians $\\hat{H}_{\\lambda}$ parametrized by the coupling constant $\\lambda \\in [0,1]$ that scales the electron–electron interaction $\\hat{V}_{\\mathrm{ee}} \\to \\lambda \\hat{V}_{\\mathrm{ee}}$ while an external potential $\\hat{V}_{\\lambda}$ is adjusted to keep $n(\\mathbf{r})$ fixed. The exchange–correlation energy is then given exactly by the adiabatic connection integral\n$$\nE_{\\mathrm{xc}}[n] \\;=\\; \\int_{0}^{1} \\! W_{\\lambda}[n] \\, d\\lambda,\n$$\nwhere the coupling-constant integrand is\n$$\nW_{\\lambda}[n] \\;=\\; \\langle \\Psi_{\\lambda}[n] \\vert \\hat{V}_{\\mathrm{ee}} \\vert \\Psi_{\\lambda}[n] \\rangle \\;-\\; U[n],\n$$\nand $U[n]$ is the classical Hartree energy. At $\\lambda=0$, the interacting state reduces to the Kohn–Sham determinant, so that $W_{0}[n] = E_{x}[n]$ is the exact exchange energy.\n\nConsider a generalized gradient approximation of Perdew–Burke–Ernzerhof type, which supplies an approximate integrand $W_{\\lambda}^{\\mathrm{PBE}}[n]$ and thus an approximate $E_{\\mathrm{xc}}^{\\mathrm{PBE}}[n] = \\int_{0}^{1} W_{\\lambda}^{\\mathrm{PBE}}[n] \\, d\\lambda$. You are asked to construct a hybrid adiabatic-connection integrand by adding to $W_{\\lambda}^{\\mathrm{PBE}}[n]$ a correction that enforces the exact $\\lambda=0$ limit while minimally perturbing the fully interacting end ($\\lambda \\to 1$) in a smooth manner consistent with basic constraints. Proceed as follows:\n\n1) Assume an ansatz of the form\n$$\nW_{\\lambda}^{\\mathrm{hyb}}[n] \\;=\\; W_{\\lambda}^{\\mathrm{PBE}}[n] \\;+\\; \\big(E_{x}^{\\mathrm{HF}}[n] \\;-\\; E_{x}^{\\mathrm{PBE}}[n]\\big)\\, f(\\lambda),\n$$\nwith a scalar weight $f(\\lambda)$ chosen to satisfy $f(0)=1$ so that $W_{0}^{\\mathrm{hyb}}[n] = E_{x}^{\\mathrm{HF}}[n]$ and $f(1)=0$ so that the correction smoothly vanishes at full coupling. Impose in addition the minimal smoothness constraints $f'(1)=0$ and $f''(1)=0$ so that the correction does not alter the first two derivatives of the integrand at $\\lambda=1$.\n\n2) Among polynomials, determine the unique cubic $f(\\lambda)$ that satisfies these four endpoint constraints. Then perform the adiabatic-connection integration to show that the corresponding hybrid exchange–correlation energy has the form\n$$\nE_{\\mathrm{xc}}^{\\mathrm{hyb}}[n] \\;=\\; E_{\\mathrm{xc}}^{\\mathrm{PBE}}[n] \\;+\\; a \\,\\big(E_{x}^{\\mathrm{HF}}[n] \\;-\\; E_{x}^{\\mathrm{PBE}}[n]\\big),\n$$\nand express the mixing coefficient $a$ in terms of $f(\\lambda)$.\n\n3) Evaluate $a$ explicitly for the cubic $f(\\lambda)$ you found in step 2. This $a$ is the Perdew–Ernzerhof hybrid mixing implied by the adiabatic connection and provides the rationale for the PBE0 choice. Report the final value of $a$ as an exact number. No units are required. Do not round.\n\nYour final answer must be a single number.", "solution": "The problem presented is a an exercise in the construction of hybrid exchange-correlation functionals within the framework of Kohn-Sham density functional theory. We are tasked with deriving the mixing coefficient for a specific hybrid functional based on the Perdew-Burke-Ernzerhof (PBE) generalized gradient approximation. The derivation must follow principles of the adiabatic connection.\n\nFirst, we must validate the problem statement.\nThe givens are as follows:\n1. The exact exchange-correlation energy from the adiabatic connection integral: $E_{\\mathrm{xc}}[n] = \\int_{0}^{1} W_{\\lambda}[n] \\, d\\lambda$.\n2. The definition of the coupling-constant integrand: $W_{\\lambda}[n] = \\langle \\Psi_{\\lambda}[n] \\vert \\hat{V}_{\\mathrm{ee}} \\vert \\Psi_{\\lambda}[n] \\rangle - U[n]$.\n3. The $\\lambda=0$ limit of the exact integrand: $W_{0}[n] = E_{x}[n]$.\n4. The PBE approximation for the energy: $E_{\\mathrm{xc}}^{\\mathrm{PBE}}[n] = \\int_{0}^{1} W_{\\lambda}^{\\mathrm{PBE}}[n] \\, d\\lambda$.\n5. A proposed ansatz for a hybrid integrand: $W_{\\lambda}^{\\mathrm{hyb}}[n] = W_{\\lambda}^{\\mathrm{PBE}}[n] + \\big(E_{x}^{\\mathrm{HF}}[n] - E_{x}^{\\mathrm{PBE}}[n]\\big)\\, f(\\lambda)$. Here, the exact exchange energy $E_{x}[n]$ is approximated by the Hartree-Fock exchange energy $E_{x}^{\\mathrm{HF}}[n]$, a common and necessary step in practical hybrid functional construction.\n6. Four constraints on the weighting function $f(\\lambda)$: $f(0)=1$, $f(1)=0$, $f'(1)=0$, and $f''(1)=0$.\n7. The required form for the resulting hybrid energy: $E_{\\mathrm{xc}}^{\\mathrm{hyb}}[n] = E_{\\mathrm{xc}}^{\\mathrm{PBE}}[n] + a \\,\\big(E_{x}^{\\mathrm{HF}}[n] - E_{x}^{\\mathrm{PBE}}[n]\\big)$.\n\nThe problem is scientifically grounded, rooted in the established principles of density functional theory. It is well-posed, providing a sufficient number of constraints to uniquely determine the parameters of a cubic polynomial. The language is objective and the setup is consistent. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe first step is to determine the unique cubic polynomial $f(\\lambda)$ that satisfies the given constraints. Let the general form of a cubic polynomial be\n$$\nf(\\lambda) = c_3 \\lambda^3 + c_2 \\lambda^2 + c_1 \\lambda + c_0.\n$$\nIts first and second derivatives with respect to $\\lambda$ are\n$$\nf'(\\lambda) = 3 c_3 \\lambda^2 + 2 c_2 \\lambda + c_1,\n$$\n$$\nf''(\\lambda) = 6 c_3 \\lambda + 2 c_2.\n$$\nWe apply the four constraints to determine the coefficients $c_0, c_1, c_2, c_3$.\n1.  From $f(0)=1$:\n    $c_3 (0)^3 + c_2 (0)^2 + c_1 (0) + c_0 = 1 \\implies c_0 = 1$.\n2.  From $f(1)=0$:\n    $c_3 (1)^3 + c_2 (1)^2 + c_1 (1) + c_0 = 0 \\implies c_3 + c_2 + c_1 + 1 = 0$.\n3.  From $f'(1)=0$:\n    $3 c_3 (1)^2 + 2 c_2 (1) + c_1 = 0 \\implies 3 c_3 + 2 c_2 + c_1 = 0$.\n4.  From $f''(1)=0$:\n    $6 c_3 (1) + 2 c_2 = 0 \\implies 6 c_3 + 2 c_2 = 0 \\implies c_2 = -3 c_3$.\n\nWe have a system of linear equations. Substituting $c_2 = -3 c_3$ into the equation from constraint $3$:\n$3 c_3 + 2(-3 c_3) + c_1 = 0 \\implies 3 c_3 - 6 c_3 + c_1 = 0 \\implies -3 c_3 + c_1 = 0 \\implies c_1 = 3 c_3$.\n\nNow, substitute the expressions for $c_1$ and $c_2$ in terms of $c_3$ into the equation from constraint $2$:\n$c_3 + (-3 c_3) + (3 c_3) + 1 = 0 \\implies c_3 + 1 = 0 \\implies c_3 = -1$.\n\nWith $c_3 = -1$, we find the other coefficients:\n$c_2 = -3 c_3 = -3(-1) = 3$.\n$c_1 = 3 c_3 = 3(-1) = -3$.\n$c_0 = 1$.\n\nThe unique cubic polynomial is thus\n$$\nf(\\lambda) = - \\lambda^3 + 3 \\lambda^2 - 3 \\lambda + 1.\n$$\nThis expression is recognizable as the binomial expansion of $(1-\\lambda)^3$. So, we can write $f(\\lambda)$ in the more compact form\n$$\nf(\\lambda) = (1-\\lambda)^3.\n$$\n\nThe second step is to perform the adiabatic-connection integration for the hybrid functional. The hybrid exchange-correlation energy is defined as\n$$\nE_{\\mathrm{xc}}^{\\mathrm{hyb}}[n] = \\int_{0}^{1} W_{\\lambda}^{\\mathrm{hyb}}[n] \\, d\\lambda.\n$$\nSubstituting the given ansatz for $W_{\\lambda}^{\\mathrm{hyb}}[n]$:\n$$\nE_{\\mathrm{xc}}^{\\mathrm{hyb}}[n] = \\int_{0}^{1} \\left[ W_{\\lambda}^{\\mathrm{PBE}}[n] + \\big(E_{x}^{\\mathrm{HF}}[n] - E_{x}^{\\mathrm{PBE}}[n]\\big)\\, f(\\lambda) \\right] d\\lambda.\n$$\nThe integral is linear. We can separate it into two parts:\n$$\nE_{\\mathrm{xc}}^{\\mathrm{hyb}}[n] = \\int_{0}^{1} W_{\\lambda}^{\\mathrm{PBE}}[n] \\,d\\lambda + \\int_{0}^{1} \\big(E_{x}^{\\mathrm{HF}}[n] - E_{x}^{\\mathrm{PBE}}[n]\\big)\\, f(\\lambda) \\,d\\lambda.\n$$\nThe first term is, by definition, the PBE exchange-correlation energy, $E_{\\mathrm{xc}}^{\\mathrm{PBE}}[n]$. The energy difference $\\big(E_{x}^{\\mathrm{HF}}[n] - E_{x}^{\\mathrm{PBE}}[n]\\big)$ is a functional of the density $n(\\mathbf{r})$ but does not depend on the integration variable $\\lambda$. Therefore, it can be factored out of the integral:\n$$\nE_{\\mathrm{xc}}^{\\mathrm{hyb}}[n] = E_{\\mathrm{xc}}^{\\mathrm{PBE}}[n] + \\big(E_{x}^{\\mathrm{HF}}[n] - E_{x}^{\\mathrm{PBE}}[n]\\big) \\int_{0}^{1} f(\\lambda) \\,d\\lambda.\n$$\nComparing this result with the required form $E_{\\mathrm{xc}}^{\\mathrm{hyb}}[n] = E_{\\mathrm{xc}}^{\\mathrm{PBE}}[n] + a \\,\\big(E_{x}^{\\mathrm{HF}}[n] - E_{x}^{\\mathrm{PBE}}[n]\\big)$, we identify the mixing coefficient $a$ as the definite integral of the weighting function $f(\\lambda)$:\n$$\na = \\int_{0}^{1} f(\\lambda) \\,d\\lambda.\n$$\n\nThe third and final step is to evaluate this integral for the specific cubic polynomial $f(\\lambda) = (1-\\lambda)^3$ that we found.\n$$\na = \\int_{0}^{1} (1-\\lambda)^3 \\, d\\lambda.\n$$\nThis is a standard integral. We can perform a substitution $u = 1-\\lambda$, which implies $du = -d\\lambda$. The limits of integration change accordingly: when $\\lambda=0$, $u=1$; when $\\lambda=1$, $u=0$.\n$$\na = \\int_{1}^{0} u^3 (-du) = \\int_{0}^{1} u^3 \\, du.\n$$\nThe integral evaluates to:\n$$\na = \\left[ \\frac{u^4}{4} \\right]_{0}^{1} = \\frac{1^4}{4} - \\frac{0^4}{4} = \\frac{1}{4}.\n$$\nThis mixing parameter $a = 1/4$ (or $25\\%$) is precisely the fraction of Hartree-Fock exchange included in the well-known PBE0 hybrid functional. The derivation shows how this specific value arises from a minimal set of physically motivated constraints on the adiabatic connection integrand.", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "2821028"}, {"introduction": "When a DFT calculation yields an inaccurate result, it is crucial to understand the source of the error. The error can stem from the functional's mathematical form (functional-driven error) or from the inaccurate self-consistent density it produces (density-driven error). This exercise introduces a powerful diagnostic technique to disentangle these two contributions, using the calculation of the electron affinity of a chlorine atom as a practical test case for LDA, PBE, and the meta-GGA SCAN functional [@problem_id:2821151].", "problem": "Compute and analyze electron affinities across multiple exchange-correlation approximations in density functional theory for a fixed atomic system using first-principles definitions. Start from the following foundational bases: (i) the Hohenberg–Kohn theorem asserts a one-to-one correspondence between the ground-state electron density and all ground-state observables; (ii) in Kohn–Sham density functional theory (Kohn–Sham DFT), the total ground-state energy is a functional of the electron density, denoted by $E[n]$; (iii) the electron affinity is defined as the difference in ground-state energies between the neutral system and its anion. Denote the neutral chloride atom by $\\mathrm{Cl}$ with $N$ electrons and the chloride anion by $\\mathrm{Cl}^{-}$ with $N+1$ electrons. The exact electron affinity is given by\n$$\n\\mathrm{EA}_{\\mathrm{ref}} \\equiv E_{\\mathrm{ref}}(N) - E_{\\mathrm{ref}}(N+1),\n$$\nwhere $E_{\\mathrm{ref}}$ denotes the reference total energy (e.g., from a highly accurate method) for the corresponding electron number.\n\nIn an approximate exchange-correlation functional setting, denote an approximate energy functional by $E_{\\mathrm{approx}}[n]$. The self-consistent (variational) density $n_{\\mathrm{scf}}$ for this functional minimizes $E_{\\mathrm{approx}}[n]$, leading to the self-consistent energies $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)]$ and $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)]$. The non-self-consistent energy evaluation $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}]$ uses a fixed, high-quality reference density $n_{\\mathrm{ref}}$ rather than the variational density. Define the corresponding electron affinities\n$$\n\\mathrm{EA}_{\\mathrm{scf}} \\equiv E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)],\n\\quad\n\\mathrm{EA}_{\\mathrm{nscf}} \\equiv E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N+1)].\n$$\n\nDefine the total electron affinity error, the functional-driven component, and the density-driven component as\n$$\n\\Delta \\mathrm{EA}_{\\mathrm{total}} \\equiv \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{ref}},\n\\quad\n\\Delta \\mathrm{EA}_{\\mathrm{func}} \\equiv \\mathrm{EA}_{\\mathrm{nscf}} - \\mathrm{EA}_{\\mathrm{ref}},\n\\quad\n\\Delta \\mathrm{EA}_{\\mathrm{den}} \\equiv \\Delta \\mathrm{EA}_{\\mathrm{total}} - \\Delta \\mathrm{EA}_{\\mathrm{func}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{nscf}}.\n$$\nUse the criterion that the electron affinity error is density-driven if and only if $|\\Delta \\mathrm{EA}_{\\mathrm{den}}| > |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$.\n\nImplement a program that, given self-consistent and non-self-consistent total energies for the neutral and anion states under three exchange-correlation approximations—Local Density Approximation (LDA), Perdew–Burke–Ernzerhof Generalized Gradient Approximation (PBE), and Strongly Constrained and Appropriately Normed Meta-Generalized Gradient Approximation (SCAN)—computes the above quantities for the chloride anion and classifies the dominant error source.\n\nAll energies are provided in electronvolts (eV). Express all outputs in electronvolts (eV), rounded to three decimal places. Angles are not involved. Your program must not read any input. It must use the fixed test suite below.\n\nTest suite data (all energies in electronvolts):\n- Reference energies: $E_{\\mathrm{ref}}(N) = -1250.000$, $E_{\\mathrm{ref}}(N+1) = -1253.613$, so $\\mathrm{EA}_{\\mathrm{ref}} = 3.613$.\n- LDA:\n  - Self-consistent energies: $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1248.600$, $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1251.000$.\n  - Non-self-consistent (reference-density) energies: $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1248.700$, $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1252.200$.\n- PBE:\n  - Self-consistent energies: $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1249.500$, $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1252.500$.\n  - Non-self-consistent (reference-density) energies: $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1249.600$, $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1252.880$.\n- SCAN:\n  - Self-consistent energies: $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N) = -1249.800$, $E_{\\mathrm{approx}}[n_{\\mathrm{scf}}](N+1) = -1253.390$.\n  - Non-self-consistent (reference-density) energies: $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N) = -1249.820$, $E_{\\mathrm{approx}}[n_{\\mathrm{ref}}](N+1) = -1253.420$.\n\nTasks to implement:\n1. For each functional (LDA, PBE, SCAN), compute $\\mathrm{EA}_{\\mathrm{scf}}$, $\\mathrm{EA}_{\\mathrm{nscf}}$, $\\Delta \\mathrm{EA}_{\\mathrm{total}}$, $\\Delta \\mathrm{EA}_{\\mathrm{func}}$, and $\\Delta \\mathrm{EA}_{\\mathrm{den}}$ in eV, each rounded to three decimals.\n2. Classify whether the electron affinity error is density-driven using the strict inequality $|\\Delta \\mathrm{EA}_{\\mathrm{den}}| > |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$; output a boolean for this classification.\n\nFinal output format:\nProduce a single line containing a list of three sublists in the order $[\\mathrm{LDA}, \\mathrm{PBE}, \\mathrm{SCAN}]$. Each sublist must be\n$\n[\\mathrm{EA}_{\\mathrm{scf}},\\ \\mathrm{EA}_{\\mathrm{nscf}},\\ \\Delta \\mathrm{EA}_{\\mathrm{total}},\\ \\Delta \\mathrm{EA}_{\\mathrm{func}},\\ \\Delta \\mathrm{EA}_{\\mathrm{den}},\\ \\text{density\\_driven}],\n$\nwhere the first five entries are floats in eV rounded to three decimals, and the last entry is a boolean as defined above. For example, an output might look like\n$\n[[x_1,x_2,x_3,x_4,x_5,\\mathrm{True}],[\\dots],[\\dots]].\n$", "solution": "The problem requires the computation and analysis of electron affinities for the chloride atom using three different exchange-correlation functionals within the framework of density functional theory. The analysis involves decomposing the total error in the electron affinity into components attributable to the functional approximation and the resulting electron density.\n\nThe foundational definitions provided are as follows. The reference electron affinity is\n$$\n\\mathrm{EA}_{\\mathrm{ref}} = E_{\\mathrm{ref}}(N) - E_{\\mathrm{ref}}(N+1)\n$$\nwhere $E_{\\mathrm{ref}}(M)$ is the exact total ground-state energy for a system with $M$ electrons. The number of electrons for the neutral chloride atom $\\mathrm{Cl}$ is $N$.\n\nFor an approximate functional, two affinities are defined:\n1.  The self-consistent electron affinity, $\\mathrm{EA}_{\\mathrm{scf}}$, is computed from total energies that are minimized variationally with respect to the density for the given approximate functional:\n    $$\n    \\mathrm{EA}_{\\mathrm{scf}} = E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{scf}}(N+1)]\n    $$\n2.  The non-self-consistent electron affinity, $\\mathrm{EA}_{\\mathrm{nscf}}$, is computed by evaluating the approximate energy functional on a fixed, high-quality reference density, $n_{\\mathrm{ref}}$:\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf}} = E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N)] - E_{\\mathrm{approx}}[n_{\\mathrm{ref}}(N+1)]\n    $$\n\nThe error components are defined as:\n-   Total error: $\\Delta \\mathrm{EA}_{\\mathrm{total}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{ref}}$\n-   Functional-driven error: $\\Delta \\mathrm{EA}_{\\mathrm{func}} = \\mathrm{EA}_{\\mathrm{nscf}} - \\mathrm{EA}_{\\mathrm{ref}}$\n-   Density-driven error: $\\Delta \\mathrm{EA}_{\\mathrm{den}} = \\mathrm{EA}_{\\mathrm{scf}} - \\mathrm{EA}_{\\mathrm{nscf}}$\n\nIt follows from these definitions that $\\Delta \\mathrm{EA}_{\\mathrm{total}} = \\Delta \\mathrm{EA}_{\\mathrm{func}} + \\Delta \\mathrm{EA}_{\\mathrm{den}}$. The error is classified as density-driven if the magnitude of the density-driven error exceeds the magnitude of the functional-driven error, i.e., $|\\Delta \\mathrm{EA}_{\\mathrm{den}}| > |\\Delta \\mathrm{EA}_{\\mathrm{func}}|$.\n\nWe are given the following energy values in units of electronvolts ($\\mathrm{eV}$):\n-   Reference energies: $E_{\\mathrm{ref}}(N) = -1250.000\\ \\mathrm{eV}$, $E_{\\mathrm{ref}}(N+1) = -1253.613\\ \\mathrm{eV}$.\n-   LDA energies: $E_{\\mathrm{scf}}(N) = -1248.600$, $E_{\\mathrm{scf}}(N+1) = -1251.000$; $E_{\\mathrm{nscf}}(N) = -1248.700$, $E_{\\mathrm{nscf}}(N+1) = -1252.200$.\n-   PBE energies: $E_{\\mathrm{scf}}(N) = -1249.500$, $E_{\\mathrm{scf}}(N+1) = -1252.500$; $E_{\\mathrm{nscf}}(N) = -1249.600$, $E_{\\mathrm{nscf}}(N+1) = -1252.880$.\n-   SCAN energies: $E_{\\mathrm{scf}}(N) = -1249.800$, $E_{\\mathrm{scf}}(N+1) = -1253.390$; $E_{\\mathrm{nscf}}(N) = -1249.820$, $E_{\\mathrm{nscf}}(N+1) = -1253.420$.\n\nFirst, we compute the reference electron affinity:\n$$\n\\mathrm{EA}_{\\mathrm{ref}} = (-1250.000\\ \\mathrm{eV}) - (-1253.613\\ \\mathrm{eV}) = 3.613\\ \\mathrm{eV}\n$$\n\nNow, we proceed with the analysis for each functional.\n\n**1. Local Density Approximation (LDA)**\n-   Self-consistent electron affinity:\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, LDA}} = (-1248.600\\ \\mathrm{eV}) - (-1251.000\\ \\mathrm{eV}) = 2.400\\ \\mathrm{eV}\n    $$\n-   Non-self-consistent electron affinity:\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, LDA}} = (-1248.700\\ \\mathrm{eV}) - (-1252.200\\ \\mathrm{eV}) = 3.500\\ \\mathrm{eV}\n    $$\n-   Error components:\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, LDA}} = 2.400 - 3.613 = -1.213\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, LDA}} = 3.500 - 3.613 = -0.113\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, LDA}} = 2.400 - 3.500 = -1.100\\ \\mathrm{eV}\n    $$\n-   Classification: We compare $|\\Delta \\mathrm{EA}_{\\mathrm{den, LDA}}| = |-1.100| = 1.100$ with $|\\Delta \\mathrm{EA}_{\\mathrm{func, LDA}}| = |-0.113| = 0.113$. Since $1.100 > 0.113$, the error for LDA is **density-driven**.\n\n**2. Perdew–Burke–Ernzerhof (PBE) Generalized Gradient Approximation (GGA)**\n-   Self-consistent electron affinity:\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, PBE}} = (-1249.500\\ \\mathrm{eV}) - (-1252.500\\ \\mathrm{eV}) = 3.000\\ \\mathrm{eV}\n    $$\n-   Non-self-consistent electron affinity:\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, PBE}} = (-1249.600\\ \\mathrm{eV}) - (-1252.880\\ \\mathrm{eV}) = 3.280\\ \\mathrm{eV}\n    $$\n-   Error components:\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, PBE}} = 3.000 - 3.613 = -0.613\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, PBE}} = 3.280 - 3.613 = -0.333\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, PBE}} = 3.000 - 3.280 = -0.280\\ \\mathrm{eV}\n    $$\n-   Classification: We compare $|\\Delta \\mathrm{EA}_{\\mathrm{den, PBE}}| = |-0.280| = 0.280$ with $|\\Delta \\mathrm{EA}_{\\mathrm{func, PBE}}| = |-0.333| = 0.333$. Since $0.280 \\ngtr 0.333$, the error for PBE is **not** density-driven; it is functional-driven.\n\n**3. Strongly Constrained and Appropriately Normed (SCAN) Meta-GGA**\n-   Self-consistent electron affinity:\n    $$\n    \\mathrm{EA}_{\\mathrm{scf, SCAN}} = (-1249.800\\ \\mathrm{eV}) - (-1253.390\\ \\mathrm{eV}) = 3.590\\ \\mathrm{eV}\n    $$\n-   Non-self-consistent electron affinity:\n    $$\n    \\mathrm{EA}_{\\mathrm{nscf, SCAN}} = (-1249.820\\ \\mathrm{eV}) - (-1253.420\\ \\mathrm{eV}) = 3.600\\ \\mathrm{eV}\n    $$\n-   Error components:\n    $$\n    \\Delta \\mathrm{EA}_{\\mathrm{total, SCAN}} = 3.590 - 3.613 = -0.023\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{func, SCAN}} = 3.600 - 3.613 = -0.013\\ \\mathrm{eV} \\\\\n    \\Delta \\mathrm{EA}_{\\mathrm{den, SCAN}} = 3.590 - 3.600 = -0.010\\ \\mathrm{eV}\n    $$\n-   Classification: We compare $|\\Delta \\mathrm{EA}_{\\mathrm{den, SCAN}}| = |-0.010| = 0.010$ with $|\\Delta \\mathrm{EA}_{\\mathrm{func, SCAN}}| = |-0.013| = 0.013$. Since $0.010 \\ngtr 0.013$, the error for SCAN is **not** density-driven; it is functional-driven.\n\nThe following program implements these calculations and provides the output in the specified format. The results must be rounded to three decimal places.", "answer": "[[2.400,3.500,-1.213,-0.113,-1.100,True],[3.000,3.280,-0.613,-0.333,-0.280,False],[3.590,3.600,-0.023,-0.013,-0.010,False]]", "id": "2821151"}]}