{"hands_on_practices": [{"introduction": "The transport of ions through a solid electrolyte is driven by both diffusion due to concentration gradients and migration under an electric field. This practice guides you through a foundational derivation of the steady-state ionic current, starting from the Nernst-Planck equation [@problem_id:2859384]. By applying this framework to a simplified system with a uniform ion concentration, you will see how it reduces to a familiar Ohmic relationship and reveals the microscopic origins of ionic conductivity, $\\sigma$.", "problem": "A dense single-ion conducting solid electrolyte is fabricated as a planar slab of thickness $L$ and cross-sectional area $A$. The mobile ion has valence $z$ and number concentration $c$ (assumed spatially uniform), with self-diffusion coefficient $D$ at absolute temperature $T$. A static electrical potential difference $\\Delta \\phi \\equiv \\phi(L)-\\phi(0)$ is applied between the faces at $x=0$ and $x=L$. Assume one-dimensional transport along $x$, no convection, no interfacial reactions, and a rigid, electroneutral host matrix.\n\nStarting only from fundamental laws and core definitions—specifically Fick's law for diffusion, the Einstein relation connecting mobility and diffusion, and the relationship between electric field and potential—derive the steady one-dimensional Nernst–Planck flux for this ion and then obtain the steady ionic current density through the slab in the special case where the concentration remains uniform. You may assume the electric field is spatially uniform across the slab. Identify the effective ionic conductivity. Briefly discuss the limiting cases corresponding to purely migrative transport, purely diffusive transport, and asymptotic parameter limits such as $D \\to 0$, $c \\to 0$, and $L \\to \\infty$.\n\nProvide your final answer as a single closed-form analytical expression for the steady current density $i$ in terms of $D$, $c$, $z$, the elementary charge $e$, the Boltzmann constant $k_B$, $T$, $\\Delta \\phi$, and $L$. Do not include units in the final boxed answer. If you choose to also express the total current $I$, use $I = i A$ and state it in your derivation, but the final boxed answer must be the expression for $i$ alone.", "solution": "The goal is to derive the steady one-dimensional ionic current density from first principles. We begin by decomposing the particle flux into diffusive and migrative contributions and then use the Einstein relation to connect mobility and diffusion.\n\n1. Fundamental ingredients:\n- Fick's law (diffusion): in one dimension, the diffusive particle flux is given by\n$$\nJ_{\\text{diff}}(x) \\;=\\; - D \\,\\frac{\\partial c}{\\partial x}.\n$$\n- Drift under an electric field: an ion with charge $z e$ subjected to an electric field $E(x)$ experiences a drift velocity $v_{\\text{d}}(x)$ proportional to the field,\n$$\nv_{\\text{d}}(x) \\;=\\; \\mu \\, z e \\, E(x),\n$$\nwhere $\\mu$ is the mobility.\n- Einstein relation: in thermal equilibrium for dilute carriers,\n$$\n\\mu \\;=\\; \\frac{D}{k_B T}.\n$$\n- Electric field and potential: the electric field is related to the electrostatic potential $\\phi(x)$ by\n$$\nE(x) \\;=\\; - \\frac{\\partial \\phi}{\\partial x}.\n$$\n\n2. Migrative particle flux:\nThe migrative contribution to the particle flux is the product of the number concentration and the drift velocity,\n$$\nJ_{\\text{mig}}(x) \\;=\\; c(x)\\, v_{\\text{d}}(x) \\;=\\; c(x)\\, \\mu \\, z e \\, E(x).\n$$\nUsing $E(x) = - \\partial \\phi / \\partial x$ and $\\mu = D/(k_B T)$ gives\n$$\nJ_{\\text{mig}}(x) \\;=\\; - \\frac{D\\, z e}{k_B T}\\, c(x)\\, \\frac{\\partial \\phi}{\\partial x}.\n$$\n\n3. Nernst–Planck particle flux:\nSumming the diffusive and migrative contributions yields the one-dimensional Nernst–Planck particle flux,\n$$\nJ(x) \\;=\\; J_{\\text{diff}}(x) + J_{\\text{mig}}(x)\n\\;=\\; - D \\,\\frac{\\partial c}{\\partial x} \\;-\\; \\frac{D\\, z e}{k_B T}\\, c(x)\\, \\frac{\\partial \\phi}{\\partial x}.\n$$\n\n4. Ionic current density:\nThe electrical current density is the charge per particle times the particle flux,\n$$\ni(x) \\;=\\; z e \\, J(x) \\;=\\; - z e \\, D \\,\\frac{\\partial c}{\\partial x} \\;-\\; \\frac{(z e)^2 D}{k_B T}\\, c(x)\\, \\frac{\\partial \\phi}{\\partial x}.\n$$\nUnder the stated steady conditions with a uniform concentration, $\\partial c / \\partial x = 0$, so the diffusive term vanishes. Assuming a spatially uniform electric field across the slab, the potential varies linearly and\n$$\n\\frac{\\partial \\phi}{\\partial x} \\;=\\; \\frac{\\phi(L)-\\phi(0)}{L} \\;=\\; \\frac{\\Delta \\phi}{L}.\n$$\nTherefore, the steady current density is\n$$\ni \\;=\\; - \\frac{(z e)^2 D}{k_B T}\\, c \\, \\frac{\\Delta \\phi}{L}.\n$$\n\n5. Effective ionic conductivity:\nComparing with Ohm's law in one dimension, $i = - \\sigma \\, \\Delta \\phi / L$, we identify the ionic conductivity as\n$$\n\\sigma \\;=\\; \\frac{(z e)^2 D}{k_B T}\\, c.\n$$\n\n6. Limiting cases and discussion:\n- Purely migrative transport (uniform concentration): This is the present case, yielding $i = - \\sigma \\, \\Delta \\phi / L$ with $\\sigma$ as above. The response is linear in $\\Delta \\phi$ in the regime where $D$ and $c$ are field-independent and the Einstein relation holds.\n- Purely diffusive transport (no electric field): Setting $\\Delta \\phi = 0$ gives $i = - z e \\, D \\, \\partial c / \\partial x$. If the concentration is uniform as specified here, then $i = 0$ when $\\Delta \\phi = 0$.\n- Asymptotic parameter limits: If $D \\to 0$ (immobile ions), $c \\to 0$ (no carriers), or $L \\to \\infty$ (macroscopic separation at fixed $\\Delta \\phi$), then $i \\to 0$. Halving $L$ at fixed $\\Delta \\phi$ doubles $|i|$, reflecting the inverse thickness dependence in Ohmic conduction. The total current is $I = i A$ and thus scales linearly with the area $A$.\n\nThese results are valid within the dilute-carrier, isothermal, and linear-response regime implied by the Einstein relation and a constant $D$. Deviations can occur at very high fields or when concentration polarization creates substantial $\\partial c / \\partial x$, in which case the full Nernst–Planck expression with both terms must be retained.", "answer": "$$\\boxed{-\\,\\frac{(z e)^{2} D\\, c}{k_{B} T}\\,\\frac{\\Delta \\phi}{L}}$$", "id": "2859384"}, {"introduction": "In an ideal system, the random motion of individual ions would directly translate to macroscopic charge transport. In reality, ionic movements in a crystal lattice are often correlated, meaning a jump in one direction may be followed by a jump back, contributing to self-diffusion but not net current. This practice challenges you to quantify this effect by calculating the Haven ratio, $H_{R} = D^{*}/D_{\\sigma}$, which compares the true tracer diffusion coefficient with the diffusion coefficient derived from conductivity [@problem_id:2859392]. Using experimental data for a real material, you will connect macroscopic measurements to the subtle, correlated dance of atoms at the microscopic level.", "problem": "A dense sample of cubic Lithium Lanthanum Zirconium Oxide (LLZO, chemical formula $\\mathrm{Li_7La_3Zr_2O_{12}}$) is characterized at temperature $T = 298$ K. Pulsed Field Gradient Nuclear Magnetic Resonance (PFG-NMR) yields a tracer self-diffusion coefficient $D^{*} = 1.10 \\times 10^{-12}$ m$^{2}$ s$^{-1}$. Electrochemical impedance spectroscopy (EIS) measures a bulk ionic conductivity $\\sigma = 1.5$ mS cm$^{-1}$. The material has density $\\rho = 5.10$ g cm$^{-3}$ and molar mass $M = 839.7$ g mol$^{-1}$. Assume monovalent carriers with charge number $z = 1$, and that only a fraction $f_{m} = 0.15$ of the seven lithium per formula unit participate as mobile charge carriers on the experimental timescale (the remainder are dynamically inert on this timescale). Use Avogadro’s constant $N_{A} = 6.02214076 \\times 10^{23}$ mol$^{-1}$, the gas constant $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$, and the Faraday constant $F = 96485$ C mol$^{-1}$.\n\nThe Haven ratio $H_{R}$ is defined as the ratio of the tracer diffusion coefficient to the conductivity diffusion coefficient, $H_{R} = D^{*}/D_{\\sigma}$. Starting from fundamental transport relations, determine $H_{R}$ for this LLZO sample using the data provided. Then, briefly interpret the case $H_{R}  1$ in terms of correlated ionic motion.\n\nExpress the final value of $H_{R}$ as a dimensionless number and round your answer to three significant figures.", "solution": "The problem requires the calculation of the Haven ratio, $H_{R}$, for a sample of cubic Lithium Lanthanum Zirconium Oxide ($\\mathrm{Li_7La_3Zr_2O_{12}}$), and an interpretation of the result. The problem statement is scientifically grounded, well-posed, and contains all necessary data for a unique solution. It is therefore deemed valid.\n\nThe Haven ratio is defined as the ratio of the tracer self-diffusion coefficient, $D^{*}$, to the conductivity diffusion coefficient, $D_{\\sigma}$:\n$$H_{R} = \\frac{D^{*}}{D_{\\sigma}}$$\nThe value for the tracer diffusion coefficient is given as $D^{*} = 1.10 \\times 10^{-12}$ m$^{2}$ s$^{-1}$. The task thus reduces to determining $D_{\\sigma}$ from the provided electrochemical and material properties.\n\nThe conductivity diffusion coefficient, $D_{\\sigma}$, is related to the bulk ionic conductivity, $\\sigma$, by the Nernst-Einstein equation. In molar terms, this relation is:\n$$\\sigma = \\frac{C_{m} (zF)^2 D_{\\sigma}}{RT}$$\nwhere $\\sigma$ is the ionic conductivity, $C_{m}$ is the molar concentration of mobile charge carriers, $z$ is the charge number of the carriers, $F$ is the Faraday constant, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nTo use this equation, we must first calculate the molar concentration of mobile charge carriers, $C_{m}$. The molar concentration of $\\mathrm{Li_7La_3Zr_2O_{12}}$ formula units is given by the ratio of the material's density, $\\rho$, to its molar mass, $M$. The number of lithium atoms per formula unit is $7$. The problem specifies that only a fraction, $f_{m}$, of these are mobile. Therefore, $C_{m}$ is given by:\n$$C_{m} = \\frac{\\rho}{M} \\times 7 \\times f_{m}$$\nSubstituting this expression for $C_{m}$ into the Nernst-Einstein equation and rearranging to solve for $D_{\\sigma}$ yields:\n$$D_{\\sigma} = \\frac{\\sigma RT}{\\left(\\frac{7 f_{m} \\rho}{M}\\right) z^2 F^2} = \\frac{\\sigma R T M}{7 f_{m} \\rho z^2 F^2}$$\nBefore performing the calculation, all given parameters must be converted to a consistent set of SI units.\n- Tracer diffusion coefficient: $D^{*} = 1.10 \\times 10^{-12}$ m$^{2}$ s$^{-1}$\n- Ionic conductivity: $\\sigma = 1.5$ mS cm$^{-1} = 1.5 \\times 10^{-3}$ S cm$^{-1} \\times (100 \\text{ cm m}^{-1}) = 0.15$ S m$^{-1}$\n- Gas constant: $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$\n- Temperature: $T = 298$ K\n- Molar mass: $M = 839.7$ g mol$^{-1} = 0.8397$ kg mol$^{-1}$\n- Fraction of mobile carriers: $f_{m} = 0.15$ (dimensionless)\n- Density: $\\rho = 5.10$ g cm$^{-3} = 5.10 \\frac{10^{-3} \\text{ kg}}{(10^{-2} \\text{ m})^{3}} = 5100$ kg m$^{-3}$\n- Carrier charge number: $z = 1$ (dimensionless)\n- Faraday constant: $F = 96485$ C mol$^{-1}$\n\nSubstituting these values into the expression for $D_{\\sigma}$:\n$$D_{\\sigma} = \\frac{(0.15 \\text{ S m}^{-1}) \\times (8.31446 \\text{ J mol}^{-1} \\text{K}^{-1}) \\times (298 \\text{ K}) \\times (0.8397 \\text{ kg mol}^{-1})}{7 \\times 0.15 \\times (5100 \\text{ kg m}^{-3}) \\times (1)^2 \\times (96485 \\text{ C mol}^{-1})^2}$$\n$$D_{\\sigma} = \\frac{312.0624 \\text{ J kg m}^{-1}}{4.98503 \\times 10^{13} \\text{ C}^2 \\text{kg m}^{-3} \\text{mol}^{-2}} \\approx 6.2600 \\times 10^{-12} \\text{ m}^2 \\text{s}^{-1}$$\n(Note that the units simplify correctly: $\\frac{\\text{J}}{\\text{C}^2 \\text{m}^{-2}} = \\frac{\\text{C V}}{ \\text{C}^2 \\text{m}^{-2}} = \\frac{\\text{V m}^2}{\\text{C}} = \\frac{\\text{V m}^2}{\\text{A s}} = \\frac{\\text{R m}^2}{\\text{s}}$, and $\\text{S}^{-1} = \\text{R}$, so $\\text{S}^{-1}\\text{R} = 1$, leaving $\\text{m}^2\\text{s}^{-1}$).\n\nNow, we can calculate the Haven ratio:\n$$H_{R} = \\frac{D^{*}}{D_{\\sigma}} = \\frac{1.10 \\times 10^{-12} \\text{ m}^{2} \\text{s}^{-1}}{6.2600 \\times 10^{-12} \\text{ m}^{2} \\text{s}^{-1}} \\approx 0.1757$$\nRounding to three significant figures as required, we obtain $H_{R} = 0.176$.\n\nThe physical interpretation for the case $H_{R}  1$ is as follows. The tracer diffusion coefficient, $D^{*}$, quantifies the total random-walk motion of individual, tagged ions. In contrast, the conductivity diffusion coefficient, $D_{\\sigma}$, reflects the net displacement of charge resulting from the collective motion of all charge carriers. A Haven ratio of less than unity ($H_{R}  1$) signifies that the ionic motions are correlated. Specifically, it indicates that some atomic jump events that contribute to the mean-squared displacement of an individual ion (measured by $D^{*}$) do not contribute to net charge transport (measured by $\\sigma$). This is characteristic of vacancy-mediated diffusion mechanisms in crystalline solids. For example, an ion may jump into a neighboring vacant site, and shortly thereafter, jump back into the original site. This forward-backward jump sequence contributes to $D^{*}$ but results in zero net charge displacement, thus not contributing to $\\sigma$ and $D_{\\sigma}$. The Haven ratio is a measure of this correlation effect, where a value less than $1$ indicates that the charge transport is less efficient than what would be expected from uncorrelated individual ionic motion.", "answer": "$$\\boxed{0.176}$$", "id": "2859392"}, {"introduction": "First-principles simulations like ab initio molecular dynamics (AIMD) provide a powerful window into atomic-scale transport phenomena. However, extracting macroscopic transport properties from raw trajectory data requires a careful and systematic analysis pipeline. This computational practice guides you through the essential steps of this process, starting from the mean-squared displacement (MSD) of ions calculated in a simulation [@problem_id:2859400]. You will apply the Einstein relation to find the diffusion coefficient, correct for artifacts arising from the simulation's finite size, and perform an Arrhenius fit to determine the activation energy $E_{\\mathrm{a}}$, thereby bridging the gap from simulated atomic motion to experimentally relevant kinetic parameters.", "problem": "You are provided with synthetic, but scientifically consistent, ab initio Molecular Dynamics (AIMD) trajectory summaries for the tracer mean-squared displacement (MSD) of mobile ions in a solid-state conductor at several temperatures. Your task is to compute the tracer diffusion coefficients from the MSD using first principles, apply a hydrodynamic finite-size correction appropriate for periodic boundary conditions in a cubic supercell, and then extract the activation energy and prefactor by fitting an Arrhenius relation. All quantities and steps must be handled in a unit-consistent manner.\n\nUse the following fundamental and well-tested bases:\n- In $d$ dimensions, the Einstein relation for tracer diffusion gives $D = \\frac{1}{2 d}\\frac{d\\langle \\Delta r^2(t)\\rangle}{dt}$ in the long-time limit, where $D$ is the tracer diffusion coefficient and $\\langle \\Delta r^2(t)\\rangle$ is the mean-squared displacement.\n- For a cubic, periodic simulation box of linear size $L$, a leading-order hydrodynamic finite-size correction (Yeh–Hummer) may be added to the periodic boundary condition diffusion $D_{\\mathrm{PBC}}$ to estimate the infinite-size diffusion $D_{\\infty}$: $D_{\\infty} = D_{\\mathrm{PBC}} + \\frac{k_{\\mathrm{B}} T \\,\\xi}{6\\pi \\eta L}$, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is absolute temperature, $\\eta$ is shear viscosity, and $\\xi \\approx 2.837297$ for a cubic cell.\n- A thermally activated tracer diffusion coefficient approximately obeys an Arrhenius form $D_{\\infty}(T) = D_0 \\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right)$, where $D_0$ is the prefactor and $E_{\\mathrm{a}}$ is the activation energy.\n\nComputational directives to follow:\n1. For each temperature, perform a least-squares linear regression of $\\langle \\Delta r^2(t)\\rangle$ versus $t$ over a specified long-time window $[t_{\\min}, t_{\\max}]$, with $d=3$, to obtain the slope $s = \\frac{d\\langle \\Delta r^2\\rangle}{dt}$. Then compute $D_{\\mathrm{PBC}} = \\frac{s}{2 d}$.\n2. Units and conversions:\n   - The time data $t$ are provided in picoseconds. The MSD data $\\langle \\Delta r^2\\rangle$ are provided in square ångströms. Convert the slope units (square ångströms per picosecond) to square meters per second using $1~\\text{Å}^2 = 10^{-20}~\\text{m}^2$ and $1~\\text{ps} = 10^{-12}~\\text{s}$. Thus, if $s$ is the slope in $\\text{Å}^2/\\text{ps}$, then $D_{\\mathrm{PBC}}~[\\text{m}^2\\!/\\text{s}] = \\frac{s}{6}\\times 10^{-8}$.\n   - Use $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}~\\text{J/K}$.\n   - Use $\\xi = 2.837297$.\n   - The shear viscosity $\\eta$ is provided in $\\text{Pa}\\cdot\\text{s}$ and the box length $L$ is provided in $\\text{m}$.\n3. Apply the finite-size correction to obtain $D_{\\infty}(T)$ for each temperature using the formula above.\n4. Perform a linear regression of $\\ln D_{\\infty}$ versus $1/T$ to extract the slope and intercept. From the linear model $\\ln D_{\\infty} = \\ln D_0 - \\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}}} \\frac{1}{T}$, identify $E_{\\mathrm{a}}$ and $D_0$. Express $E_{\\mathrm{a}}$ in electronvolts using the conversion factor $1~\\text{eV} = 1.602176634\\times 10^{-19}~\\text{J}$, and express $D_0$ in $\\text{m}^2/\\text{s}$.\n5. Numerical fitting details:\n   - Use ordinary least squares for both the MSD-versus-time fits and the Arrhenius fit.\n   - For the MSD fits, use only the data points with $t \\ge t_{\\min}$ as specified below; take $t_{\\max}$ as the maximum available time.\n   - Take the spatial dimensionality $d=3$.\n\nTest suite:\n- Physical constants for all tests: $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}$ J/K, $\\xi = 2.837297$, $e = 1.602176634\\times 10^{-19}$ J/eV.\n\n- Test Case $1$ (cubic box, smaller size, stronger finite-size effect):\n  - Box length: $L = 1.2\\times 10^{-9}$ m.\n  - Viscosity: $\\eta = 2.5\\times 10^{-3}$ Pa·s.\n  - Temperatures (K): $T \\in \\{600, 800, 1000\\}$.\n  - Time grid $t$ in picoseconds (same for all three temperatures): $[0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]$.\n  - MSD at $T=600$ K (Å$^2$): $[0, 0.4129329434, 0.6763368722, 0.9195042496, 1.1599329074, 1.39999092, 1.63999877116, 1.8799998336942, 2.119999977493, 2.359999996954, 2.599999999588]$.\n  - MSD at $T=800$ K (Å$^2$): $[0, 0.9729329434, 1.7963368722, 2.5995042496, 3.3999329074, 4.19999092, 4.99999877116, 5.7999998336942, 6.599999977493, 7.399999996954, 8.199999999588]$.\n  - MSD at $T=1000$ K (Å$^2$): $[0, 1.8229329434, 3.4963368722, 5.1495042496, 6.7999329074, 8.44999092, 10.09999877116, 11.7499998336942, 13.399999977493, 15.049999996954, 16.699999999588]$.\n  - Use $t_{\\min} = 15$ ps; take $t_{\\max}$ as the maximum time in the list.\n\n- Test Case $2$ (cubic box, larger size, weaker finite-size effect):\n  - Box length: $L = 2.4\\times 10^{-9}$ m.\n  - Viscosity: $\\eta = 2.0\\times 10^{-3}$ Pa·s.\n  - Temperatures (K): $T \\in \\{500, 700, 900\\}$.\n  - Time grid $t$ in picoseconds (same for all three temperatures): $[0, 4, 8, 12, 16, 20, 24]$.\n  - MSD at $T=500$ K (Å$^2$): $[0, 0.1664664717, 0.2581684361, 0.339752124, 0.4199664537, 0.49999546, 0.5799993858]$.\n  - MSD at $T=700$ K (Å$^2$): $[0, 0.3264664717, 0.5781684361, 0.819752124, 1.0599664537, 1.29999546, 1.5399993858]$.\n  - MSD at $T=900$ K (Å$^2$): $[0, 0.5664664717, 1.0581684361, 1.539752124, 2.0199664537, 2.49999546, 2.9799993858]$.\n  - Use $t_{\\min} = 8$ ps; take $t_{\\max}$ as the maximum time in the list.\n\nRequired outputs:\n- For each of the two test cases, compute:\n  - The activation energy $E_{\\mathrm{a}}$ in electronvolts (eV).\n  - The diffusion prefactor $D_0$ in $\\text{m}^2/\\text{s}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[E_{\\mathrm{a},1}~(\\text{eV}), D_{0,1}~(\\text{m}^2/\\text{s}), E_{\\mathrm{a},2}~(\\text{eV}), D_{0,2}~(\\text{m}^2/\\text{s})]$. Express $E_{\\mathrm{a}}$ in eV and $D_0$ in $\\text{m}^2/\\text{s}$ as floating-point numbers.", "solution": "The problem presented is a standard, well-posed exercise in computational materials physics. It requires the analysis of simulated ionic transport data to extract fundamental kinetic parameters. The problem is scientifically grounded in the principles of statistical mechanics and condensed matter physics, provides all necessary data and constants, and follows a logically sound and unambiguous procedure. It is therefore deemed a valid problem.\n\nThe solution proceeds systematically, grounded in three fundamental physical relationships.\n\nFirst, the tracer diffusion coefficient $D$ relates to the mean-squared displacement (MSD) of a particle, denoted $\\langle \\Delta r^2(t)\\rangle$, through the Einstein relation. In three spatial dimensions ($d=3$), this is given by:\n$$\nD = \\lim_{t\\to\\infty} \\frac{1}{6t} \\langle \\Delta r^2(t)\\rangle\n$$\nIn practice, we determine the slope $s = \\frac{d\\langle \\Delta r^2(t)\\rangle}{dt}$ in the long-time, linear (diffusive) regime of the MSD plot. The diffusion coefficient is then $D = s/6$. The data provided from a simulation with periodic boundary conditions (PBC) yields the raw, size-dependent coefficient $D_{\\mathrm{PBC}}$.\n\nSecond, molecular dynamics simulations in a finite periodic box introduce artifacts. The long-range hydrodynamic interactions of an ion are screened by its periodic images, which suppresses long-wavelength fluctuation modes. This leads to a systematic underestimation of the self-diffusion coefficient. For a cubic cell of side length $L$, the leading-order correction to the diffusion coefficient calculated under PBC, $D_{\\mathrm{PBC}}$, relates it to the infinite-system diffusion coefficient $D_{\\infty}$ via the Yeh-Hummer formula:\n$$\nD_{\\infty} = D_{\\mathrm{PBC}} + \\frac{k_{\\mathrm{B}} T \\xi}{6\\pi \\eta L}\n$$\nHere, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, $\\eta$ is the shear viscosity of the medium, and $\\xi$ is a dimensionless constant ($\\xi \\approx 2.837297$) that depends on the geometry of the simulation cell. This correction must be applied to obtain a physically meaningful diffusion coefficient representative of a bulk material.\n\nThird, ionic diffusion in a solid is a thermally activated process. The temperature dependence of the diffusion coefficient is well-described by the Arrhenius relation:\n$$\nD_{\\infty}(T) = D_0 \\exp\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right)\n$$\nwhere $E_{\\mathrm{a}}$ is the activation energy for ion hopping and $D_0$ is the pre-exponential factor. To extract these parameters, we linearize this equation by taking the natural logarithm:\n$$\n\\ln D_{\\infty}(T) = \\ln D_0 - \\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}}} \\left(\\frac{1}{T}\\right)\n$$\nThis equation has the form of a straight line, $y = c + mx$, where $y = \\ln D_{\\infty}$, $x = 1/T$, the intercept is $c = \\ln D_0$, and the slope is $m = -E_{\\mathrm{a}}/k_{\\mathrm{B}}$.\n\nThe computational procedure is as follows:\n\n1.  For each temperature $T$ within a given test case, we perform an ordinary least-squares linear regression on the provided MSD data, $\\langle \\Delta r^2(t)\\rangle$, against time $t$. This fit is restricted to the specified \"long-time\" window, $t \\in [t_{\\min}, t_{\\max}]$, to ensure we are in the diffusive regime. The slope of this fit, $s$, is obtained in units of $\\text{Å}^2/\\text{ps}$.\n\n2.  The raw diffusion coefficient $D_{\\mathrm{PBC}}$ is calculated from the slope $s$ and converted to SI units ($\\text{m}^2/\\text{s}$). Given $d=3$, and the conversion factors $1\\,\\text{Å} = 10^{-10}\\,\\text{m}$ and $1\\,\\text{ps} = 10^{-12}\\,\\text{s}$, we have:\n    $$\n    D_{\\mathrm{PBC}}~[\\text{m}^2/\\text{s}] = \\frac{s~[\\text{Å}^2/\\text{ps}]}{6} \\times \\frac{(10^{-10}\\,\\text{m})^2/\\text{Å}^2}{10^{-12}\\,\\text{s}/\\text{ps}} = \\frac{s}{6} \\times 10^{-8}\n    $$\n\n3.  The finite-size correction term, $\\Delta D = \\frac{k_{\\mathrm{B}} T \\xi}{6\\pi \\eta L}$, is calculated using the provided parameters for each temperature. This value is added to $D_{\\mathrm{PBC}}$ to obtain the corrected diffusion coefficient $D_{\\infty}(T) = D_{\\mathrm{PBC}} + \\Delta D$. All parameters ($k_{\\mathrm{B}}, T, \\xi, \\eta, L$) must be in SI units for this calculation.\n\n4.  After computing $D_{\\infty}(T)$ for all temperatures in a test case, we generate a set of data points $(\\frac{1}{T}, \\ln D_{\\infty})$. A second linear regression is performed on these points.\n\n5.  The activation energy $E_{\\mathrm{a}}$ and prefactor $D_0$ are extracted from the slope $m$ and intercept $c$ of the Arrhenius fit:\n    $$\n    E_{\\mathrm{a}} = -m \\cdot k_{\\mathrm{B}}\n    $$\n    $$\n    D_0 = \\exp(c)\n    $$\n    The activation energy, calculated in Joules, is then converted to electronvolts (eV) using the given conversion factor $1\\,\\text{eV} = 1.602176634\\times 10^{-19}\\,\\text{J}$. The prefactor $D_0$ is already in the correct units of $\\text{m}^2/\\text{s}$.\n\nThis procedure is applied to both test cases to determine the required physical parameters.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing MSD data to find activation energy and\n    diffusion prefactor for two test cases.\n    \"\"\"\n    \n    # Define physical constants\n    KB_J_K = 1.380649e-23  # Boltzmann constant in J/K\n    XI_CUBIC = 2.837297      # Yeh-Hummer constant for a cubic cell\n    E_J_EV = 1.602176634e-19 # Conversion factor from Joules to eV\n\n    # Test Case 1 Data\n    case1_data = {\n        \"L\": 1.2e-9,  # meters\n        \"eta\": 2.5e-3, # Pa·s\n        \"t_min\": 15,  # ps\n        \"t_coords\": [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50], # ps\n        \"temperatures\": [600, 800, 1000],  # K\n        \"msd_list\": [\n            [0, 0.4129329434, 0.6763368722, 0.9195042496, 1.1599329074, 1.39999092, 1.63999877116, 1.8799998336942, 2.119999977493, 2.359999996954, 2.599999999588],\n            [0, 0.9729329434, 1.7963368722, 2.5995042496, 3.3999329074, 4.19999092, 4.99999877116, 5.7999998336942, 6.599999977493, 7.399999996954, 8.199999999588],\n            [0, 1.8229329434, 3.4963368722, 5.1495042496, 6.7999329074, 8.44999092, 10.09999877116, 11.7499998336942, 13.399999977493, 15.049999996954, 16.699999999588]\n        ] # Å^2\n    }\n\n    # Test Case 2 Data\n    case2_data = {\n        \"L\": 2.4e-9,  # meters\n        \"eta\": 2.0e-3, # Pa·s\n        \"t_min\": 8,   # ps\n        \"t_coords\": [0, 4, 8, 12, 16, 20, 24], # ps\n        \"temperatures\": [500, 700, 900],  # K\n        \"msd_list\": [\n            [0, 0.1664664717, 0.2581684361, 0.339752124, 0.4199664537, 0.49999546, 0.5799993858],\n            [0, 0.3264664717, 0.5781684361, 0.819752124, 1.0599664537, 1.29999546, 1.5399993858],\n            [0, 0.5664664717, 1.0581684361, 1.539752124, 2.0199664537, 2.49999546, 2.9799993858]\n        ] # Å^2\n    }\n    \n    test_cases = [case1_data, case2_data]\n    results = []\n\n    def process_case(case):\n        \"\"\"\n        Calculates Ea and D0 for a single test case.\n        \"\"\"\n        L = case[\"L\"]\n        eta = case[\"eta\"]\n        t_min = case[\"t_min\"]\n        \n        inv_T_values = []\n        D_infinity_values = []\n        \n        t_all = np.array(case[\"t_coords\"])\n        \n        for i, T in enumerate(case[\"temperatures\"]):\n            msd_all = np.array(case[\"msd_list\"][i])\n            \n            # 1. MSD vs t fit\n            # Filter data to lie within the fitting window [t_min, t_max]\n            fit_mask = t_all >= t_min\n            t_fit = t_all[fit_mask]\n            msd_fit = msd_all[fit_mask]\n            \n            # Perform linear regression to get the slope s in Å^2/ps\n            slope_msd, _, _, _, _ = linregress(t_fit, msd_fit)\n            \n            # 2. Compute D_pbc in m^2/s\n            # D [m^2/s] = (s [Å^2/ps] / 6) * 1e-8\n            D_pbc = (slope_msd / 6.0) * 1e-8\n            \n            # 3. Apply finite-size correction\n            # delta_D = (kB * T * xi) / (6 * pi * eta * L)\n            correction_term = (KB_J_K * T * XI_CUBIC) / (6 * np.pi * eta * L)\n            D_infinity = D_pbc + correction_term\n            \n            inv_T_values.append(1.0 / T)\n            D_infinity_values.append(D_infinity)\n\n        # 4. Arrhenius fit: ln(D_inf) vs 1/T\n        inv_T_arr = np.array(inv_T_values)\n        ln_D_inf_arr = np.log(D_infinity_values)\n        \n        # Perform linear regression\n        # y = intercept + slope*x  =>  ln(D) = ln(D0) - (Ea/kB)* (1/T)\n        slope_arr, intercept_arr, _, _, _ = linregress(inv_T_arr, ln_D_inf_arr)\n\n        # 5. Extract Ea and D0\n        # Ea = -slope_arr * kB\n        Ea_J = -slope_arr * KB_J_K\n        Ea_eV = Ea_J / E_J_EV\n\n        # D0 = exp(intercept_arr)\n        D0_m2_s = np.exp(intercept_arr)\n        \n        return Ea_eV, D0_m2_s\n\n    for case in test_cases:\n        Ea, D0 = process_case(case)\n        results.append(Ea)\n        results.append(D0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2859400"}]}