{"hands_on_practices": [{"introduction": "The transfer matrix method is a cornerstone for analyzing wave propagation in layered media, providing a powerful and versatile computational tool. This practice guides you through developing an algorithm from first principles to calculate the power reflectance $R$ from a semi-infinite one-dimensional photonic crystal [@problem_id:2850217]. By implementing the propagation matrices for each layer and applying Bloch's theorem to the unit cell, you will learn how to numerically identify the propagating and evanescent bands (pass bands and stop bands) and correctly enforce radiation boundary conditions to select the physically relevant solution.", "problem": "Consider a one-dimensional lossless dielectric photonic crystal formed by a periodic stack of two homogeneous, isotropic, nonmagnetic layers, labeled A and B, with refractive indices $n_{\\mathrm{A}}$ and $n_{\\mathrm{B}}$, and thicknesses $d_{\\mathrm{A}}$ and $d_{\\mathrm{B}}$, respectively. The period is $a = d_{\\mathrm{A}} + d_{\\mathrm{B}}$. The structure occupies $x \\ge 0$, and an incident time-harmonic plane wave of angular frequency $\\omega$ impinges normally from a homogeneous semi-infinite incident medium occupying $x < 0$ with refractive index $n_{\\mathrm{in}}$. Adopt the time dependence $\\exp(-i \\omega t)$, and assume nonmagnetic media with relative permeability equal to $1$. All angles in trigonometric functions must be in radians. Use dimensionless normalization such that lengths are expressed in units of $a$, and define the dimensionless frequency $u = \\omega a / c$, where $c$ is the speed of light in vacuum.\n\nStarting only from Maxwell’s equations in a source-free, piecewise homogeneous medium and the continuity conditions for the tangential electric and magnetic fields at interfaces, together with the statement of Bloch’s theorem for periodic structures, derive an algorithm to compute the power reflectance $R$ at $x = 0$ when the semi-infinite periodic crystal is excited by the incident plane wave under the following radiation boundary condition: inside the periodic crystal, only the Bloch solution that carries power in the $+x$ direction (if a propagating Bloch mode exists) or the Bloch solution that decays as $x \\to +\\infty$ (if no propagating Bloch mode exists) is allowed. Your derivation must explicitly construct the unit-cell transfer matrix, extract the Bloch eigenvalues and eigenvectors, select the physical Bloch mode using the radiation boundary condition, compute the Bloch-mode effective admittance at the interface, and match the fields to determine the reflection coefficient. The final computable quantity is the power reflectance $R = |r|^2$, where $r$ is the complex amplitude reflection coefficient.\n\nImplement your derivation as a program that, for each specified test case, computes the single-pass power reflectance $R$ at $x = 0$ for normal incidence. The states must be represented in terms of the tangential electric field $E$ and tangential magnetic field $H$ at a reference plane immediately to the right of the interface at $x = 0$ (that is, at the start of layer A). The per-layer propagation must be represented in terms of a $2 \\times 2$ transfer (characteristic) matrix obtained by solving the homogeneous Helmholtz equation in each layer and enforcing field continuity at interfaces. The Bloch condition is the eigenproblem for the unit-cell transfer matrix $\\mathbf{M}_{\\text{cell}}$, with eigenvalues $\\lambda = \\exp(i k_{\\mathrm{B}} a)$, where $k_{\\mathrm{B}}$ is the Bloch wave number, and eigenvectors $\\mathbf{v} = (E, H)^{\\mathsf{T}}$ defined at the chosen reference plane.\n\nFor numerical stability, when selecting the physical Bloch eigenvector $\\mathbf{v}$ for a given dimensionless frequency $u$, enforce:\n- If both Bloch multipliers satisfy $||\\lambda| - 1|$ below a small tolerance (propagating band), select the eigenvector whose time-averaged $x$-directed Poynting flux density, proportional to $\\operatorname{Re}\\{E H^*\\}$, is positive (power flowing into $+x$).\n- Otherwise (stop band), select the eigenvector with $|\\lambda| < 1$ (decaying into $+x$).\n\nThen compute the Bloch-mode effective admittance at $x = 0^+$ as $Y_{\\mathrm{B}} = H/E$ from the selected eigenvector and obtain the amplitude reflection coefficient at $x = 0$ by matching to the incident medium total field (incident $+$ reflected) using tangential field continuity. The incident medium admittance is $Y_{\\mathrm{in}} = n_{\\mathrm{in}}$ under the stated normalization. Finally, return the reflectance $R = |r|^2$ as a real number.\n\nUse the following fixed parameters in all test cases:\n- $n_{\\mathrm{A}} = 1.0$,\n- $n_{\\mathrm{B}} = 3.4$,\n- $n_{\\mathrm{in}} = 1.0$,\n- $d_{\\mathrm{A}}$ and $d_{\\mathrm{B}}$ are chosen to satisfy $n_{\\mathrm{A}} d_{\\mathrm{A}} = n_{\\mathrm{B}} d_{\\mathrm{B}}$ and $d_{\\mathrm{A}} + d_{\\mathrm{B}} = 1$ (that is, equal optical thicknesses and one period $a = 1$ in the chosen units).\n\nDefine the three test cases by the list of dimensionless frequencies $u$ as follows:\n- Test case $1$ (pass band, “happy path”): $u = 0.5\\, u_0$,\n- Test case $2$ (inside the first stop band center): $u = u_0$,\n- Test case $3$ (higher-frequency pass band): $u = 1.5\\, u_0$,\nwhere $u_0$ is the midgap (Bragg) normalized frequency corresponding to the equal optical thickness condition described above. All computations must use radians for phases. Your program must compute $u_0$ from the given $n_{\\mathrm{A}}$, $n_{\\mathrm{B}}$, $d_{\\mathrm{A}}$, and $d_{\\mathrm{B}}$ under the stated normalization.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[r1,r2,r3]\"), where each entry is the floating-point value of $R$ for the corresponding test case in the order listed above. There must be no additional characters or whitespace beyond this exact single-line format. All outputs are dimensionless real numbers (no physical units) and should be printed in standard decimal notation.", "solution": "The problem requires the derivation and implementation of an algorithm to compute the power reflectance from a semi-infinite one-dimensional photonic crystal. This will be accomplished by following the transfer matrix method, applying Bloch's theorem, and matching fields at the boundary.\n\nFirst, we begin with Maxwell's equations in a source-free ($\\rho=0, \\mathbf{J}=0$), isotropic, nonmagnetic ($\\mu=\\mu_0$) dielectric medium with refractive index $n$:\n$$ \\nabla \\times \\mathbf{E} = i\\omega\\mu_0\\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = -i\\omega n^2 \\epsilon_0\\mathbf{E} $$\nWe have adopted the time-harmonic convention $\\exp(-i\\omega t)$. For a plane wave at normal incidence propagating along the $x$-axis, with electric field polarized along $y$ ($\\mathbf{E} = E(x)\\hat{y}$) and magnetic field along $z$ ($\\mathbf{H} = H(x)\\hat{z}$), Maxwell's equations reduce to a set of ordinary differential equations:\n$$ \\frac{dE}{dx} = i\\omega\\mu_0 H $$\n$$ \\frac{dH}{dx} = -i\\omega n^2 \\epsilon_0 E $$\nCombining these, we obtain the one-dimensional Helmholtz equation:\n$$ \\frac{d^2 E}{dx^2} + \\left(\\frac{\\omega n}{c}\\right)^2 E = 0 $$\nwhere $c = 1/\\sqrt{\\epsilon_0 \\mu_0}$ is the speed of light in vacuum.\n\nThe problem defines a dimensionless frequency $u = \\omega a / c$, where $a$ is the period of the crystal. Normalizing lengths by $a$ implies $a=1$ in these units. Furthermore, we adopt a system of units where $c=1$ and the impedance of free space $Z_0 = \\sqrt{\\mu_0/\\epsilon_0} = 1$. In these units, the wave number in a medium of index $n$ is $k = \\omega n = u n$, and the characteristic admittance is $Y=n$. The governing equations become:\n$$ \\frac{dE}{dx} = i u H $$\n$$ \\frac{dH}{dx} = -i u n^2 E $$\nThe solution to the Helmholtz equation in a homogeneous layer of thickness $d$ and refractive index $n$ can be expressed using a transfer matrix $\\mathbf{M}$ that relates the fields at $x$ to the fields at $x=0$: $\\begin{pmatrix} E(x) \\\\ H(x) \\end{pmatrix} = \\mathbf{M}(x) \\begin{pmatrix} E(0) \\\\ H(0) \\end{pmatrix}$. The transfer matrix for a layer of thickness $d$ is:\n$$ \\mathbf{M}_{\\text{layer}}(d, n, u) = \\begin{pmatrix} \\cos(und) & i \\frac{1}{n} \\sin(und) \\\\ i n \\sin(und) & \\cos(und) \\end{pmatrix} $$\nThe unit cell of the photonic crystal consists of two layers, A and B, starting from $x=0$. The transfer matrix for the entire unit cell, $\\mathbf{M}_{\\text{cell}}$, is the product of the individual layer matrices:\n$$ \\mathbf{M}_{\\text{cell}} = \\mathbf{M}_{\\text{B}} \\mathbf{M}_{\\text{A}} $$\nwhere $\\mathbf{M}_{\\text{A}}$ and $\\mathbf{M}_{\\text{B}}$ are the transfer matrices for layers A and B with thicknesses $d_{\\mathrm{A}}$, $d_{\\mathrm{B}}$ and refractive indices $n_{\\mathrm{A}}$, $n_{\\mathrm{B}}$, respectively.\n\nAccording to Bloch's theorem, for a periodic potential, the solutions must be of the form $\\mathbf{v}(x+a) = \\lambda \\mathbf{v}(x)$, where $\\mathbf{v}(x) = (E(x), H(x))^{\\mathsf{T}}$ is the field vector and $\\lambda = \\exp(ik_{\\mathrm{B}}a)$ is the Bloch multiplier, with $k_{\\mathrm{B}}$ being the Bloch wave number. Since the field vector at the start of a unit cell is mapped to the field vector at the end by $\\mathbf{M}_{\\text{cell}}$, the allowed field configurations at the cell boundaries are the eigenvectors of $\\mathbf{M}_{\\text{cell}}$:\n$$ \\mathbf{M}_{\\text{cell}} \\mathbf{v} = \\lambda \\mathbf{v} $$\nThe eigenvalues $\\lambda$ are found from the characteristic equation $\\det(\\mathbf{M}_{\\text{cell}} - \\lambda \\mathbf{I}) = 0$. Since $\\det(\\mathbf{M}_{\\text{cell}})=1$ (a property of lossless systems), the equation is $\\lambda^2 - \\text{Tr}(\\mathbf{M}_{\\text{cell}}) \\lambda + 1 = 0$. The solutions are $\\lambda_{1,2} = \\frac{T \\pm \\sqrt{T^2-4}}{2}$, where $T = \\text{Tr}(\\mathbf{M}_{\\text{cell}})$.\n- If $|T/2| \\le 1$, the eigenvalues are complex conjugates with unit magnitude, $\\lambda = \\exp(\\pm i k_{\\mathrm{B}} a)$. This corresponds to propagating Bloch modes (pass band).\n- If $|T/2| > 1$, the eigenvalues are real, with one having $|\\lambda| > 1$ (growing mode) and the other $|\\lambda|  1$ (decaying mode). This corresponds to evanescent modes (stop band).\n\nThe problem specifies a semi-infinite crystal for $x \\ge 0$. The physical solution inside the crystal must be a single Bloch mode satisfying a radiation boundary condition: it must either carry power away from the interface (into the crystal, $+x$ direction) or decay to zero as $x \\to \\infty$.\n- In a pass band, we select the eigenvector $\\mathbf{v}_{\\mathrm{B}} = (E_{\\mathrm{B}}, H_{\\mathrm{B}})^{\\mathsf{T}}$ corresponding to positive time-averaged Poynting flux, $S_x = \\frac{1}{2}\\operatorname{Re}\\{E_{\\mathrm{B}} H_{\\mathrm{B}}^*\\} > 0$.\n- In a stop band, we select the eigenvector corresponding to the eigenvalue with magnitude $|\\lambda|  1$.\n\nOnce the physical Bloch mode eigenvector $\\mathbf{v}_{\\mathrm{B}}$ is identified at the interface $x=0^+$, we compute its effective admittance $Y_{\\mathrm{B}} = H_{\\mathrm{B}} / E_{\\mathrm{B}}$. For the incident medium ($x  0$), the fields are a superposition of incident and reflected plane waves. The total admittance at $x=0^-$ is $Y(0^-) = Y_{\\mathrm{in}} \\frac{1-r}{1+r}$, where $r$ is the amplitude reflection coefficient and $Y_{\\mathrm{in}} = n_{\\mathrm{in}}$ is the admittance of the incident medium.\nContinuity of tangential fields at $x=0$ implies $Y(0^-) = Y(0^+) = Y_{\\mathrm{B}}$. Hence, we can solve for the reflection coefficient:\n$$ r = \\frac{Y_{\\mathrm{in}} - Y_{\\mathrm{B}}}{Y_{\\mathrm{in}} + Y_{\\mathrm{B}}} $$\nThe power reflectance is then $R = |r|^2$.\n\nThe specific parameters for the quarter-wave stack are $n_{\\mathrm{A}}=1.0$, $n_{\\mathrm{B}}=3.4$, $n_{\\mathrm{in}}=1.0$, $a=1$, and $n_{\\mathrm{A}}d_{\\mathrm{A}} = n_{\\mathrm{B}}d_{\\mathrm{B}}$. With $d_{\\mathrm{A}}+d_{\\mathrm{B}}=a=1$, we find $d_{\\mathrm{A}} = n_{\\mathrm{B}}/(n_{\\mathrm{A}}+n_{\\mathrm{B}})$ and $d_{\\mathrm{B}} = n_{\\mathrm{A}}/(n_{\\mathrm{A}}+n_{\\mathrm{B}})$. The midgap frequency $u_0$ corresponds to the condition that the optical path length in each layer is a quarter wavelength, i.e., the phase shift is $\\pi/2$. Thus, $u_0 n_{\\mathrm{A}} d_{\\mathrm{A}} = \\pi/2$, which gives $u_0 = \\frac{\\pi (n_{\\mathrm{A}}+n_{\\mathrm{B}})}{2n_{\\mathrm{A}}n_{\\mathrm{B}}}$.\n\nThe algorithm proceeds as follows:\n1.  Calculate $d_{\\mathrm{A}}, d_{\\mathrm{B}}$, and $u_0$.\n2.  For each test frequency $u$:\n    a. Construct $\\mathbf{M}_{\\text{A}}$ and $\\mathbf{M}_{\\text{B}}$ and compute $\\mathbf{M}_{\\text{cell}} = \\mathbf{M}_{\\text{B}}\\mathbf{M}_{\\text{A}}$.\n    b. Compute the trace $T$.\n    c. If in a stop band ($|T/2| > 1$, as for $u=u_0$), find the eigenvalue with $|\\lambda|1$ and its corresponding eigenvector.\n    d. If in a pass band ($|T/2| \\le 1$, as for $u=0.5u_0, 1.5u_0$), find the two eigenvalues. Select the one corresponding to forward power flow. The Bloch admittance is $Y_{\\mathrm{B}} = (\\lambda_{\\text{fwd}} - M_{11}) / M_{12}$.\n    e. Compute $r = (n_{\\mathrm{in}} - Y_{\\mathrm{B}}) / (n_{\\mathrm{in}} + Y_{\\mathrm{B}})$ and $R = |r|^2$.\n\nThis procedure is implemented in the following program.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reflectance of a semi-infinite 1D photonic crystal.\n    \"\"\"\n    # Fixed parameters from problem statement\n    n_A = 1.0\n    n_B = 3.4\n    n_in = 1.0\n    \n    # In normalized units, period a = 1.\n    # d_A + d_B = 1 and n_A * d_A = n_B * d_B\n    d_A = n_B / (n_A + n_B)\n    d_B = n_A / (n_A + n_B)\n\n    # Midgap (Bragg) normalized frequency for the quarter-wave stack\n    # This comes from the condition that phase thickness u0 * nA * dA = pi/2\n    u0 = np.pi / (2 * n_A * d_A)\n    \n    test_frequencies = [0.5 * u0, u0, 1.5 * u0]\n    \n    results = []\n    \n    for u in test_frequencies:\n        # Phase thickness in each layer. Due to the quarter-wave condition,\n        # phi_A = u * n_A * d_A and phi_B = u * n_B * d_B are equal.\n        phi = u * n_A * d_A\n        \n        c, s = np.cos(phi), np.sin(phi)\n        \n        # Transfer matrix for layer A\n        M_A = np.array([[c, 1j/n_A * s], [1j*n_A * s, c]])\n        # Transfer matrix for layer B\n        M_B = np.array([[c, 1j/n_B * s], [1j*n_B * s, c]])\n        # Unit cell transfer matrix\n        M_cell = M_B @ M_A\n\n        M11 = M_cell[0, 0]\n        M12 = M_cell[0, 1]\n        T = np.trace(M_cell)\n        \n        # Check if in stop band or pass band\n        if np.abs(T/2.0) > 1.0: # Stop band\n            # Eigenvalues are real: lambda_1 * lambda_2 = 1\n            lambda_decay = (T - np.sqrt(T**2 - 4 + 0j)) / 2.0\n            # Ensure we select the one with magnitude  1\n            if np.abs(lambda_decay) > 1:\n                lambda_decay = (T + np.sqrt(T**2 - 4 + 0j)) / 2.0\n            Y_B = (lambda_decay - M11) / M12\n        else: # Pass band\n            # Eigenvalues are complex conjugates on the unit circle\n            gamma_sqrt = np.sqrt(4.0 - T**2 + 0j)\n            \n            lambda1 = (T + 1j * gamma_sqrt) / 2.0\n            lambda2 = (T - 1j * gamma_sqrt) / 2.0\n            \n            Y_B1 = (lambda1 - M11) / M12\n            Y_B2 = (lambda2 - M11) / M12\n            \n            # Poynting flux for mode 1 is Re(E * H*) = Re(1 * Y_B1*).\n            # Select the mode with positive Poynting flux (power flow into +x)\n            if np.real(Y_B1) > 0:\n                Y_B = Y_B1\n            else:\n                Y_B = Y_B2\n\n        # Reflection coefficient at the interface x=0\n        r = (n_in - Y_B) / (n_in + Y_B)\n        \n        # Power reflectance R = |r|^2\n        R = np.abs(r)**2\n        results.append(R.real)\n        \n    # Format the output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2850217"}, {"introduction": "While numerical methods are powerful, analytical models provide deep physical insight, especially in limiting cases. This exercise explores the long-wavelength limit (or homogenization regime), where a finely-layered photonic crystal behaves like a uniform, anisotropic effective medium [@problem_id:2850161]. Starting from Maxwell's equations, you will use a perturbative approach to derive the effective refractive index beyond the simple spatial average, revealing how the microscopic geometry gives rise to macroscopic optical properties like form birefringence.", "problem": "A one-dimensional photonic crystal is formed by a periodic stack of two nonmagnetic dielectric layers with scalar relative permittivities $\\varepsilon_{1}$ and $\\varepsilon_{2}$, thicknesses $d_{1}$ and $d_{2}$, and period $a = d_{1} + d_{2}$. The structure is infinite along the stacking direction $z$ and uniform in the transverse directions. A monochromatic plane wave at normal incidence propagates along $z$ with angular frequency $\\omega$, vacuum light speed $c$, and Bloch wavenumber $k_{B}(\\omega)$. Assume isotropic, lossless dielectrics and that the subwavelength (homogenization) condition $|\\omega| a / c \\ll 1$ holds.\n\nStarting from the source-free macroscopic Maxwell equations in the frequency domain, the boundary conditions for the tangential fields at each interface, and the Bloch theorem for periodic media, derive the long-wavelength expansion of the Bloch dispersion and define an effective refractive index $n_{\\mathrm{eff}}(\\omega)$ through $k_{B}(\\omega) = (\\omega/c)\\, n_{\\mathrm{eff}}(\\omega)$. Show that the expansion has the structure\n$$\nn_{\\mathrm{eff}}^{2}(\\omega) \\;=\\; \\varepsilon_{\\parallel} \\;+\\; \\alpha \\left(\\frac{\\omega a}{c}\\right)^{2} \\;+\\; \\mathcal{O}\\!\\left(\\left(\\frac{\\omega a}{c}\\right)^{4}\\right),\n$$\nwhere $\\varepsilon_{\\parallel} \\equiv f\\,\\varepsilon_{1} + (1-f)\\,\\varepsilon_{2}$ is the arithmetic (in-plane) average permittivity with fill fraction $f \\equiv d_{1}/a$.\n\nDetermine the closed-form analytical expression for the coefficient $\\alpha$ in terms of $\\varepsilon_{1}$, $\\varepsilon_{2}$, and $f$. Your final answer must be the single explicit expression for $\\alpha$ as a function of $\\varepsilon_{1}$, $\\varepsilon_{2}$, and $f$. No numerical evaluation is required.", "solution": "The propagation of a monochromatic plane wave at normal incidence along the $z$-axis in a one-dimensional, nonmagnetic dielectric medium is governed by the scalar wave equation, derived from Maxwell's equations. For an electric field polarized along the $x$-direction, $E_x(z)$, the equation is:\n$$\n\\frac{d^2 E_x(z)}{dz^2} + \\left(\\frac{\\omega}{c}\\right)^2 \\varepsilon(z) E_x(z) = 0\n$$\nwhere $k_0 = \\omega/c$ is the vacuum wavenumber and $\\varepsilon(z)$ is the spatially varying relative permittivity, which is periodic with period $a$.\n\nAccording to Bloch's theorem, the solution must be of the form $E_x(z) = u(z) e^{i k_B z}$, where $u(z)$ is a periodic function with the same period $a$ and $k_B$ is the Bloch wavenumber. We use the plane-wave expansion method, expanding both the periodic part of the field and the periodic permittivity into Fourier series:\n$$ E_x(z) = \\sum_{m=-\\infty}^{\\infty} A_m e^{i(k_B + \\frac{2\\pi m}{a})z} $$\n$$ \\varepsilon(z) = \\sum_{n=-\\infty}^{\\infty} \\epsilon_n e^{i \\frac{2\\pi n}{a} z} $$\nThe Fourier coefficient $\\epsilon_0$ is the spatial average of the permittivity:\n$$ \\epsilon_0 = \\frac{1}{a} \\int_0^a \\varepsilon(z') dz' = \\frac{\\varepsilon_1 d_1 + \\varepsilon_2 d_2}{a} = f \\varepsilon_1 + (1-f) \\varepsilon_2 = \\varepsilon_{\\parallel} $$\nFor $n \\neq 0$:\n$$ \\epsilon_n = \\frac{1}{a} \\left( \\varepsilon_1 \\int_0^{d_1} e^{-i \\frac{2\\pi n z'}{a}} dz' + \\varepsilon_2 \\int_{d_1}^{a} e^{-i \\frac{2\\pi n z'}{a}} dz' \\right) = \\frac{i(\\varepsilon_1 - \\varepsilon_2)}{2\\pi n} (1 - e^{-i 2\\pi n f}) $$\nNote that $\\epsilon_{-n} = \\epsilon_n^*$.\n\nSubstituting the Fourier expansions into the wave equation yields an infinite set of coupled algebraic equations for the coefficients $A_m$:\n$$ -\\left(k_B + \\frac{2\\pi m}{a}\\right)^2 A_m + k_0^2 \\sum_{n=-\\infty}^{\\infty} \\epsilon_{m-n} A_n = 0 $$\nIn the long-wavelength limit ($k_0 a \\ll 1$), we use perturbation theory. The unperturbed solution corresponds to a homogeneous medium with permittivity $\\epsilon_0 = \\varepsilon_\\parallel$, which is the zeroth-order approximation: $k_B^2 = k_0^2 \\epsilon_0$.\n\nTo find the next-order correction, we find an approximate expression for $A_m$ ($m \\neq 0$) from its corresponding equation, assuming $A_m \\ll A_0$ and $k_B \\ll 2\\pi m/a$:\n$$ -\\left(\\frac{2\\pi m}{a}\\right)^2 A_m + k_0^2 \\epsilon_m A_0 \\approx 0 \\implies A_m \\approx \\frac{(k_0 a)^2}{4\\pi^2 m^2} \\epsilon_m A_0 $$\nSubstituting this back into the equation for $m=0$:\n$$ -k_B^2 A_0 + k_0^2 \\left( \\epsilon_0 A_0 + \\sum_{n \\neq 0} \\epsilon_{-n} A_n \\right) = 0 $$\nDividing by $A_0$ and substituting the expression for $A_n$:\n$$ k_B^2 = k_0^2 \\left( \\epsilon_0 + \\sum_{n \\neq 0} \\epsilon_{-n} \\frac{(k_0 a)^2}{4\\pi^2 n^2} \\epsilon_n \\right) = k_0^2 \\epsilon_0 + (k_0 a)^2 k_0^2 \\sum_{n \\neq 0} \\frac{|\\epsilon_n|^2}{4\\pi^2 n^2} $$\nDividing by $k_0^2$ gives the effective permittivity. Comparing with the target form $n_{\\mathrm{eff}}^{2}(\\omega) = \\varepsilon_{\\parallel} + \\alpha (k_0 a)^2 + \\mathcal{O}((k_0 a)^4)$, we identify the coefficient $\\alpha$:\n$$ \\alpha = \\sum_{n \\neq 0} \\frac{|\\epsilon_n|^2}{4\\pi^2 n^2} $$\nWe have $|\\epsilon_n|^2 = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{\\pi^2 n^2} \\sin^2(\\pi nf)$. Substituting this into the expression for $\\alpha$:\n$$ \\alpha = \\sum_{n \\neq 0} \\frac{1}{4\\pi^2 n^2} \\left( \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{\\pi^2 n^2} \\sin^2(\\pi nf) \\right) = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^4} \\sum_{n \\neq 0} \\frac{\\sin^2(\\pi nf)}{n^4} $$\nThe sum can be written as $2 \\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4}$. This infinite series has a known closed form. Using the identity $\\sin^2(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$ and the Fourier series for Bernoulli polynomials, one can show that for $0 \\le f \\le 1$:\n$$ \\sum_{n=1}^{\\infty} \\frac{\\sin^2(\\pi nf)}{n^4} = \\frac{\\pi^4}{6} f^2(1-f)^2 $$\nThus, the sum over non-zero integers is $\\sum_{n \\neq 0} \\frac{\\sin^2(\\pi nf)}{n^4} = \\frac{\\pi^4}{3} f^2(1-f)^2$. Finally, we substitute this sum back into the expression for $\\alpha$:\n$$ \\alpha = \\frac{(\\varepsilon_1 - \\varepsilon_2)^2}{4\\pi^4} \\left( \\frac{\\pi^4}{3} f^2(1-f)^2 \\right) = \\frac{1}{12} (\\varepsilon_1 - \\varepsilon_2)^2 f^2 (1-f)^2 $$\nThis is the closed-form analytical expression for the coefficient $\\alpha$.", "answer": "$$\\boxed{\\frac{1}{12} f^2 (1-f)^2 (\\varepsilon_1 - \\varepsilon_2)^2}$$", "id": "2850161"}, {"introduction": "The true power of photonic crystals emerges from the ability to introduce defects that confine and guide light, forming the basis for resonators, waveguides, and other integrated photonic devices. This problem introduces the elegant and powerful effective mass approximation, a concept borrowed from semiconductor physics, to model how a slowly-varying structural perturbation creates localized photonic states [@problem_id:2850177]. By mapping the band's dispersion curvature to an \"effective mass\" and the perturbation to a \"potential well\", you will discover a direct analogy to the quantum harmonic oscillator to determine the quantized frequencies of confined light.", "problem": "A one-dimensional photonic crystal with lattice period $a$ supports a transverse-electric Bloch mode whose dispersion relation near the bottom of a photonic band at the Brillouin-zone edge wavevector $k_{0} = \\pi/a$ is analytic and has positive curvature. Let $\\omega_{0} \\equiv \\omega_{n}(k_{0})$ denote the band-edge angular frequency and let $D \\equiv \\left.\\frac{\\partial^{2}\\omega_{n}}{\\partial k^{2}}\\right|_{k_{0}}$ denote the curvature along the lattice direction, with $D0$. A slowly varying refractive-index perturbation is introduced such that, within the envelope-function approximation, the local band edge is shifted by a scalar function $U(x)$ with $U(x) = \\tfrac{1}{2} K x^{2}$, where $K0$ is a constant and $x$ is the coordinate along the periodicity direction. Assume that polarization and symmetry allow a scalar treatment, that magnetic permeability is spatially uniform, and that higher-order (beyond quadratic) $k$-dependence and nonparabolic corrections can be neglected.\n\nStarting from the time-harmonic source-free Maxwell equations and Bloch’s theorem, and invoking the Envelope Function Approximation (EFA) together with the Effective Mass Approximation (EMA) near $k_{0}$, derive the leading-order one-dimensional envelope equation governing the slowly varying amplitude $F(x)$ of the Bloch mode. Then, using this equation, determine the fundamental bound-state frequency shift $\\Delta\\omega_{0} \\equiv \\omega_{\\text{bound}} - \\omega_{0}$ as a closed-form analytic expression in terms of $D$ and $K$.\n\nYour final answer must be a single closed-form expression for $\\Delta\\omega_{0}$ in terms of $D$ and $K$. No numerical evaluation is required.", "solution": "The starting point is the dispersion relation for the transverse-electric Bloch mode near the Brillouin-zone edge, $k_{0} = \\pi/a$. The problem specifies that this dispersion is analytic and parabolic, centered at the band-edge frequency $\\omega_{0} \\equiv \\omega_{n}(k_{0})$. For a wavevector $k$ near $k_{0}$, the frequency $\\omega_{n}(k)$ is approximated by a Taylor expansion truncated at the second order:\n$$ \\omega_{n}(k) \\approx \\omega_{n}(k_{0}) + \\left.\\frac{\\partial\\omega_{n}}{\\partial k}\\right|_{k_{0}} (k-k_{0}) + \\frac{1}{2} \\left.\\frac{\\partial^{2}\\omega_{n}}{\\partial k^{2}}\\right|_{k_{0}} (k-k_{0})^{2} $$\nAt a band extremum like the Brillouin-zone edge, the group velocity is zero, so $\\left.\\frac{\\partial\\omega_{n}}{\\partial k}\\right|_{k_{0}} = 0$. Using the given definitions $\\omega_{0}$ and $D = \\left.\\frac{\\partial^{2}\\omega_{n}}{\\partial k^{2}}\\right|_{k_{0}}$, the dispersion simplifies to:\n$$ \\omega_{n}(k) \\approx \\omega_{0} + \\frac{1}{2} D (k-k_{0})^{2} $$\nLet $q \\equiv k - k_{0}$ be the wavevector measured relative to the band edge. The frequency shift within the unperturbed band is $\\delta\\omega_{\\text{band}}(q) = \\omega_{n}(k) - \\omega_{0} = \\frac{1}{2} D q^{2}$.\n\nThe Envelope Function Approximation (EFA) is invoked for a system with a slowly varying perturbation. The total field of a state with frequency $\\omega \\approx \\omega_{0}$ is written as the product of the rapidly oscillating Bloch mode at the band edge, $\\psi_{n,k_{0}}(x) = u_{n,k_{0}}(x) \\exp(i k_{0} x)$, and a slowly varying envelope function, $F(x)$. The full spatiotemporal dependence of the field is approximately $\\Psi(x,t) \\approx F(x) \\psi_{n,k_{0}}(x) \\exp(-i\\omega t)$.\n\nThe dynamics of the envelope function $F(x)$ are governed by an effective wave equation. Within the Effective Mass Approximation (EMA), the wavevector $q$ in the dispersion relation is promoted to a differential operator acting on the envelope function through the substitution $q \\rightarrow \\hat{q} = -i \\frac{d}{dx}$. This transforms the frequency shift due to band dispersion into an operator:\n$$ \\delta\\hat{\\omega}_{\\text{kin}} = \\frac{1}{2} D \\hat{q}^{2} = \\frac{1}{2} D \\left(-i \\frac{d}{dx}\\right)^{2} = -\\frac{D}{2} \\frac{d^{2}}{dx^{2}} $$\nThis operator acts as the \"kinetic energy\" term for the envelope function.\n\nThe problem states that the refractive-index perturbation shifts the local band edge by a scalar potential $U(x) = \\frac{1}{2} K x^{2}$. This potential energy term adds to the kinetic term to form the total effective Hamiltonian operator, $\\hat{H}_{\\text{eff}}$. The eigenvalues of this operator are the frequency shifts $\\Delta\\omega \\equiv \\omega - \\omega_{0}$ of the bound states in the potential. The time-independent eigenvalue equation for the envelope function $F(x)$ is therefore:\n$$ \\hat{H}_{\\text{eff}} F(x) = \\Delta\\omega F(x) $$\nSubstituting the expression for $\\hat{H}_{\\text{eff}}$, we arrive at the one-dimensional envelope equation:\n$$ \\left( -\\frac{D}{2} \\frac{d^{2}}{dx^{2}} + \\frac{1}{2} K x^{2} \\right) F(x) = \\Delta\\omega F(x) $$\nThis equation has the canonical form of the time-independent Schrödinger equation for a one-dimensional quantum harmonic oscillator. The standard form is\n$$ \\left( -\\frac{\\hbar^{2}}{2m} \\frac{d^{2}}{dx^{2}} + \\frac{1}{2} m \\Omega^{2} x^{2} \\right) \\psi(x) = E \\psi(x) $$\nfor which the energy eigenvalues are quantized as $E_{\\nu} = \\hbar \\Omega (\\nu + \\frac{1}{2})$, with $\\nu = 0, 1, 2, \\ldots$.\n\nTo find the bound-state frequency shifts $\\Delta\\omega_{\\nu}$, we map the parameters of our envelope equation to the standard harmonic oscillator model:\n1.  The kinetic coefficient: $\\frac{\\hbar^{2}}{2m} \\longleftrightarrow \\frac{D}{2}$\n2.  The potential coefficient: $\\frac{1}{2} m \\Omega^{2} \\longleftrightarrow \\frac{K}{2}$\n3.  The eigenvalue: $E \\longleftrightarrow \\Delta\\omega$\n\nFrom the first correspondence, we can define an effective mass $m^{*} = \\hbar^{2}/D$. Substituting this into the second correspondence, $m \\Omega^{2} = K$, we find the characteristic frequency $\\Omega$:\n$$ \\left(\\frac{\\hbar^{2}}{D}\\right) \\Omega^{2} = K \\implies \\Omega^{2} = \\frac{DK}{\\hbar^{2}} \\implies \\Omega = \\frac{\\sqrt{DK}}{\\hbar} $$\nThe allowed frequency shifts $\\Delta\\omega_{\\nu}$ are the eigenvalues of our system, which correspond to the energy levels $E_{\\nu}$ of the analogous quantum oscillator:\n$$ \\Delta\\omega_{\\nu} = \\hbar \\Omega \\left(\\nu + \\frac{1}{2}\\right) = \\hbar \\left(\\frac{\\sqrt{DK}}{\\hbar}\\right) \\left(\\nu + \\frac{1}{2}\\right) = \\sqrt{DK} \\left(\\nu + \\frac{1}{2}\\right) $$\nThe problem asks for the fundamental bound-state frequency shift, $\\Delta\\omega_{0}$, which corresponds to the ground state of the system, i.e., the state with the lowest frequency, where the quantum number $\\nu = 0$.\n$$ \\Delta\\omega_{0} = \\sqrt{DK} \\left(0 + \\frac{1}{2}\\right) = \\frac{1}{2} \\sqrt{DK} $$\nThis is the required frequency shift from the unperturbed band edge $\\omega_{0}$ for the fundamental confined mode.", "answer": "$$\n\\boxed{\\frac{1}{2}\\sqrt{DK}}\n$$", "id": "2850177"}]}