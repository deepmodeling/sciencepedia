{"hands_on_practices": [{"introduction": "To understand unconventional superconductivity, we first must grapple with its origins, which often lie in repulsive electronic interactions. This exercise provides a foundational look into spin-fluctuation-mediated pairing, a leading mechanism for superconductivity in materials like cuprates and iron pnictides. By solving the linearized gap equation within a simplified two-patch model, you will demonstrate how repulsive interactions peaked at a specific momentum can generate an attractive pairing channel, leading to a sign-changing superconducting gap [@problem_id:2869544].", "problem": "Consider a $2$-dimensional metal with an approximately circular Fermi surface and low-energy antiferromagnetic spin fluctuations peaked at a single wavevector $\\mathbf{Q}$ that connects two antipodal hot-spot patches on the Fermi surface. The effective singlet pairing interaction mediated by these spin fluctuations is modeled by\n\n$$\nV(\\mathbf{q}) \\;=\\; \\frac{3}{2} \\, U^{2} \\, \\chi(\\mathbf{q}), \\qquad \\chi(\\mathbf{q}) \\;=\\; \\frac{\\chi_{0}}{1 + \\xi^{2} |\\mathbf{q}-\\mathbf{Q}|^{2}},\n$$\n\nwith $U0$, $\\chi_{0}0$, and correlation length $\\xi \\gg k_{F}^{-1}$. In a two-patch reduction that keeps only the two hot-spot patches centered at momenta $\\mathbf{k}_{F}$ and $\\mathbf{k}_{F}+\\mathbf{Q}$, assume the following:\n\n$$\nV_{11} \\approx 0, \\quad V_{22} \\approx 0, \\quad V_{12} = V_{21} \\approx \\frac{3}{2} \\, U^{2} \\, \\chi_{0},\n$$\n\ni.e., interpatch scattering dominates over intrapatch scattering to leading order in $1/\\xi$. Let the patch-resolved density of states at the Fermi level be a constant $N_{p}$ per patch, and use a standard weak-coupling ultraviolet frequency cutoff $\\omega_{c}$ for the Cooper channel.\n\nStarting from the Bardeen–Cooper–Schrieffer (BCS) linearized gap equation at the superconducting transition temperature $T_{c}$,\n\n$$\n\\Delta_{i} \\;=\\; - \\sum_{j\\in\\{1,2\\}} \\int d\\xi \\, N_{p} \\, V_{ij} \\, \\frac{\\tanh\\!\\big(\\xi/(2T_{c})\\big)}{2\\xi} \\, \\Delta_{j},\n$$\n\nreduce the problem to a $2\\times 2$ eigenvalue equation on the hot-spot patches and solve it to obtain:\n\n$$\n\\text{(i) the normalized leading eigenfunction } (\\Delta_{1},\\Delta_{2}) \\text{ with } |\\Delta_{1}|^{2}+|\\Delta_{2}|^{2}=1, \n$$\n\n\n$$\n\\text{(ii) the superconducting transition temperature } T_{c} \\text{ in terms of } \\omega_{c},\\, U,\\, \\chi_{0},\\, N_{p}.\n$$\n\nAdopt units with Boltzmann constant $k_{B}=1$, so that $T_{c}$ is an energy. Express the final $T_{c}$ in terms of $\\omega_{c}$ without introducing any additional numerical prefactor beyond what follows from the logarithmic Cooper integral. Provide your final answer as a single row vector containing $\\Delta_{1}$, $\\Delta_{2}$, and $T_{c}$. No rounding is required; give a closed-form analytic expression.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains sufficient information for a unique solution within the specified theoretical model. It is a standard problem in the theory of unconventional superconductivity. Thus, I shall proceed with the derivation.\n\nThe starting point is the linearized Bardeen–Cooper–Schrieffer (BCS) gap equation provided:\n$$\n\\Delta_{i} \\;=\\; - \\sum_{j\\in\\{1,2\\}} \\int d\\xi \\, N_{p} \\, V_{ij} \\, \\frac{\\tanh\\!\\big(\\xi/(2T_{c})\\big)}{2\\xi} \\, \\Delta_{j}\n$$\nThe integral over the single-particle energy $\\xi$ is performed over the range $[-\\omega_{c}, \\omega_{c}]$, where $\\omega_{c}$ is the ultraviolet cutoff. This integral is independent of the patch indices $i$ and $j$. Let us define this integral factor as $L(T_c)$:\n$$\nL(T_{c}) = \\int_{-\\omega_{c}}^{\\omega_{c}} d\\xi \\, N_{p} \\, \\frac{\\tanh(\\xi/(2T_{c}))}{2\\xi}\n$$\nThe integrand is an even function of $\\xi$, so the integral can be simplified:\n$$\nL(T_{c}) = 2 N_{p} \\int_{0}^{\\omega_{c}} d\\xi \\, \\frac{\\tanh(\\xi/(2T_{c}))}{2\\xi} = N_{p} \\int_{0}^{\\omega_{c}} \\frac{d\\xi}{\\xi} \\tanh\\left(\\frac{\\xi}{2T_{c}}\\right)\n$$\nIn the weak-coupling limit, where the transition temperature $T_c$ is much smaller than the cutoff $\\omega_c$, i.e., $T_c \\ll \\omega_c$, this integral is dominated by a logarithmic term. As per the problem's instruction to not introduce extraneous numerical prefactors, we employ the standard leading-logarithmic approximation for the Cooper integral:\n$$\nL(T_{c}) \\approx N_{p} \\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right)\n$$\nSubstituting this back into the gap equation yields a system of linear equations for the gap components $\\Delta_1$ and $\\Delta_2$:\n$$\n\\Delta_{i} = - L(T_{c}) \\sum_{j\\in\\{1,2\\}} V_{ij} \\Delta_{j}\n$$\nThis can be expressed as a matrix eigenvalue equation:\n$$\n\\begin{pmatrix} V_{11}  V_{12} \\\\ V_{21}  V_{22} \\end{pmatrix} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix} = -\\frac{1}{L(T_{c})} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix}\n$$\nLet $\\mathbf{V}$ be the interaction matrix and $\\lambda_{V}$ be one of its eigenvalues. A non-trivial solution for the gap vector $(\\Delta_{1}, \\Delta_{2})$ exists if the following condition is satisfied:\n$$\n\\lambda_{V} = -\\frac{1}{L(T_{c})}\n$$\nFor a superconducting state to form at a finite temperature $T_c  0$, we require $L(T_c) = N_p \\ln(\\omega_c/T_c)  0$. This implies that a solution is only possible if the interaction matrix possesses a negative (attractive) eigenvalue, $\\lambda_{V}  0$. The highest transition temperature is determined by the most negative eigenvalue, $\\lambda_{V, \\text{min}}$.\n\nThe problem provides the interaction matrix elements for the two-patch model: $V_{11} \\approx 0$, $V_{22} \\approx 0$, and $V_{12} = V_{21} \\approx \\frac{3}{2} U^{2} \\chi_{0}$. Let us denote the repulsive inter-patch interaction strength by $V_{0} = \\frac{3}{2} U^{2} \\chi_{0}$, where $V_{0}  0$. The interaction matrix $\\mathbf{V}$ is thus:\n$$\n\\mathbf{V} = \\begin{pmatrix} 0  V_{0} \\\\ V_{0}  0 \\end{pmatrix}\n$$\nWe find the eigenvalues of $\\mathbf{V}$ by solving the characteristic equation $\\det(\\mathbf{V} - \\lambda_{V}\\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix} -\\lambda_{V}  V_{0} \\\\ V_{0}  -\\lambda_{V} \\end{pmatrix} = (-\\lambda_{V})^{2} - V_{0}^{2} = \\lambda_{V}^{2} - V_{0}^{2} = 0\n$$\nThe eigenvalues are $\\lambda_{V, \\pm} = \\pm V_{0}$. The leading instability corresponds to the attractive channel with the most negative eigenvalue, $\\lambda_{V, \\text{min}} = -V_{0}$.\n\n(i) We first determine the normalized leading eigenfunction $(\\Delta_1, \\Delta_2)$. This is the eigenvector corresponding to the eigenvalue $\\lambda_{V, \\text{min}} = -V_{0}$.\n$$\n\\begin{pmatrix} 0  V_{0} \\\\ V_{0}  0 \\end{pmatrix} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix} = -V_{0} \\begin{pmatrix} \\Delta_1 \\\\ \\Delta_2 \\end{pmatrix}\n$$\nThis matrix equation gives the conditions $V_{0}\\Delta_{2} = -V_{0}\\Delta_{1}$ and $V_{0}\\Delta_{1} = -V_{0}\\Delta_{2}$, which both reduce to $\\Delta_{2} = -\\Delta_{1}$. This indicates a sign-changing gap structure, characteristic of d-wave-like pairing. To find the specific components, we apply the normalization condition $|\\Delta_{1}|^{2} + |\\Delta_{2}|^{2} = 1$:\n$$\n|\\Delta_{1}|^{2} + |-\\Delta_{1}|^{2} = 2|\\Delta_{1}|^{2} = 1 \\implies |\\Delta_{1}| = \\frac{1}{\\sqrt{2}}\n$$\nChoosing the overall phase such that $\\Delta_1$ is real and positive, we obtain the normalized eigenfunction:\n$$\n\\Delta_{1} = \\frac{1}{\\sqrt{2}}, \\quad \\Delta_{2} = -\\frac{1}{\\sqrt{2}}\n$$\n\n(ii) Next, we calculate the superconducting transition temperature $T_c$. We use the condition for the leading instability with $\\lambda_{V, \\text{min}} = -V_{0}$:\n$$\n-V_{0} = -\\frac{1}{L(T_{c})} = -\\frac{1}{N_{p} \\ln(\\omega_{c}/T_{c})}\n$$\nThis simplifies to:\n$$\nV_{0} = \\frac{1}{N_{p} \\ln(\\omega_{c}/T_{c})}\n$$\nSolving for the logarithm gives:\n$$\n\\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right) = \\frac{1}{N_{p} V_{0}}\n$$\nWe now substitute the expression for $V_{0} = \\frac{3}{2} U^{2} \\chi_{0}$:\n$$\n\\ln\\left(\\frac{\\omega_{c}}{T_{c}}\\right) = \\frac{1}{N_{p} (\\frac{3}{2} U^{2} \\chi_{0})} = \\frac{2}{3 N_{p} U^{2} \\chi_{0}}\n$$\nExponentiating both sides of the equation yields:\n$$\n\\frac{\\omega_{c}}{T_{c}} = \\exp\\left(\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right)\n$$\nFinally, we isolate $T_c$ to obtain the final expression for the transition temperature:\n$$\nT_{c} = \\omega_{c} \\exp\\left(-\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right)\n$$\nThis result has the characteristic exponential form of a BCS-type theory, where the effective dimensionless coupling is given by the product of the density of states and the attractive interaction strength, $N_p V_0$.\n\nThe final answer is a row vector containing $\\Delta_1$, $\\Delta_2$, and $T_c$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  \\omega_{c} \\exp\\left(-\\frac{2}{3 N_{p} U^{2} \\chi_{0}}\\right) \\end{pmatrix}}\n$$", "id": "2869544"}, {"introduction": "The defining feature of a topological superconductor is the existence of protected boundary states, such as Majorana zero modes. This practice problem takes you to the heart of this phenomenon by analyzing the conditions for a topological phase transition in a one-dimensional semiconductor nanowire. You will determine the phase diagram by finding where the bulk quasiparticle gap closes, which is the universal signature of a transition between a trivial and a topological state [@problem_id:2869603]. This calculation is fundamental to understanding how to engineer and control Majorana-hosting platforms.", "problem": "Consider a clean, infinite, one-dimensional semiconductor nanowire with Rashba spin-orbit coupling proximity-coupled to a conventional spin-singlet superconductor. The low-energy quasiparticles are described by the Bogoliubov–de Gennes (BdG) Hamiltonian in Nambu spinor basis $\\Psi_{k} = (c_{k\\uparrow}, c_{k\\downarrow}, c^{\\dagger}_{-k\\uparrow}, c^{\\dagger}_{-k\\downarrow})^{T}$,\n$$\nH(k) \\;=\\; \\bigg(\\frac{\\hbar^{2} k^{2}}{2m} - \\mu\\bigg)\\,\\tau_{z} \\;+\\; \\alpha\\,k\\,\\sigma_{y}\\,\\tau_{z} \\;+\\; V_{Z}\\,\\sigma_{x} \\;+\\; \\Delta\\,\\tau_{x},\n$$\nwhere $m$ is the effective mass, $\\mu$ is the chemical potential, $\\alpha$ is the Rashba spin-orbit coupling, $V_{Z}$ is the Zeeman energy associated with a uniform magnetic field along the $x$ axis, and $\\Delta0$ is the induced $s$-wave pairing amplitude. Here $\\sigma_{i}$ and $\\tau_{i}$ are Pauli matrices acting in spin and particle–hole (Nambu) spaces, respectively. Assume translational invariance and neglect orbital magnetic effects and disorder.\n\nA bulk topological phase transition that can host Majorana quasiparticles requires a closing of the bulk quasiparticle gap at some crystal momentum $k$. For fixed $\\alpha$ and $\\Delta$, determine the phase diagram in the $(\\mu, V_{Z})$ plane by identifying the locus of parameters at which the bulk gap closes. Your derivation must begin from the Hamiltonian above and the fundamental criterion that the gap closes when there exists a momentum $k$ at which the lowest positive-energy BdG band touches zero.\n\nProvide the exact analytic expression for the gap-closing line $V_{Z}^{\\ast}(\\mu)$ giving the positive branch as a function of $\\mu$ and $\\Delta$. You may set $\\hbar = 1$ and treat $m$ and $\\alpha$ as finite constants during intermediate steps. The final answer must be a single closed-form expression with no units. Do not approximate.", "solution": "The problem requires the determination of the phase boundary for a topological transition in a one-dimensional nanowire system. This boundary corresponds to the set of parameters $(\\mu, V_{Z})$ for which the bulk quasiparticle gap closes. The starting point is the provided Bogoliubov-de Gennes (BdG) Hamiltonian, given in the Nambu spinor basis $\\Psi_{k} = (c_{k\\uparrow}, c_{k\\downarrow}, c^{\\dagger}_{-k\\uparrow}, c^{\\dagger}_{-k\\downarrow})^{T}$ as\n$$\nH(k) \\;=\\; \\bigg(\\frac{\\hbar^{2} k^{2}}{2m} - \\mu\\bigg)\\,\\tau_{z} \\;+\\; \\alpha\\,k\\,\\sigma_{y}\\,\\tau_{z} \\;+\\; V_{Z}\\,\\sigma_{x} \\;+\\; \\Delta\\,\\tau_{x}\n$$\nThe Pauli matrices $\\sigma_{i}$ and $\\tau_{i}$ act in the spin and particle-hole spaces, respectively. We set $\\hbar = 1$ as instructed. The terms involving products of Pauli matrices are interpreted using the Kronecker product formalism, consistent with standard literature for this model. Specifically, a term with only a $\\sigma$ matrix like $\\sigma_x$ is interpreted as $I_{\\tau} \\otimes \\sigma_x$, a term with only a $\\tau$ matrix like $\\tau_x$ is $\\tau_x \\otimes I_{\\sigma}$, and a product $\\sigma_y \\tau_z$ is $(\\tau_z \\otimes I_{\\sigma})(I_{\\tau} \\otimes \\sigma_y) = \\tau_z \\otimes \\sigma_y$.\n\nLet $\\xi_k = \\frac{k^2}{2m} - \\mu$. The Hamiltonian can be written in a $4 \\times 4$ matrix form. The constituent matrix representations are:\n$$\n\\tau_z \\rightarrow \\begin{pmatrix} I  0 \\\\ 0  -I \\end{pmatrix}, \\quad \\sigma_y \\tau_z \\rightarrow \\begin{pmatrix} \\sigma_y  0 \\\\ 0  -\\sigma_y \\end{pmatrix}, \\quad \\sigma_x \\rightarrow \\begin{pmatrix} \\sigma_x  0 \\\\ 0  \\sigma_x \\end{pmatrix}, \\quad \\tau_x \\rightarrow \\begin{pmatrix} 0  I \\\\ I  0 \\end{pmatrix}\n$$\nwhere $I$ and $\\sigma_i$ are the $2 \\times 2$ identity and Pauli matrices in spin space.\nCombining these, the Hamiltonian is expressed as a block matrix:\n$$\nH(k) = \\begin{pmatrix} \\xi_k I + \\alpha k \\sigma_y + V_Z \\sigma_x  \\Delta I \\\\ \\Delta I  -\\xi_k I - \\alpha k \\sigma_y + V_Z \\sigma_x \\end{pmatrix}\n$$\nA closing of the bulk gap signifies a topological phase transition. This occurs when there exists a momentum $k$ for which a quasiparticle energy eigenvalue $E(k)$ becomes zero. The eigenvalues are determined by the characteristic equation $\\det(H(k) - E \\cdot I_4) = 0$. For a gap closing, we need a zero-energy solution, which requires $\\det(H(k)) = 0$.\n\nUsing the formula for the determinant of a $2 \\times 2$ block matrix, $\\det \\begin{pmatrix} A  B \\\\ C  D \\end{pmatrix} = \\det(AD - CBC^{-1}B)$ if $C$ is invertible. A more general formula is $\\det(AD-BC)$ if $B$ and $C$ commute with $A$ and $D$. Here, the blocks do not commute in general. We use the most general form:\n$$\n\\det(H(k)) = \\det\\left( (\\xi_k I + \\alpha k \\sigma_y + V_Z \\sigma_x)(-\\xi_k I - \\alpha k \\sigma_y + V_Z \\sigma_x) - \\Delta^2 I \\right) = 0\n$$\nLet us define $h_0(k) = \\xi_k I + \\alpha k \\sigma_y$. The expression inside the determinant becomes:\n$$\n(h_0(k) + V_Z \\sigma_x)(-h_0(k) + V_Z \\sigma_x) - \\Delta^2 I = -h_0(k)^2 + h_0(k)V_Z\\sigma_x - V_Z\\sigma_x h_0(k) + V_Z^2 \\sigma_x^2 - \\Delta^2 I\n$$\nThis simplifies to:\n$$\n-h_0(k)^2 + V_Z[h_0(k), \\sigma_x] + (V_Z^2 - \\Delta^2) I\n$$\nWe compute the commutator:\n$$\n[h_0(k), \\sigma_x] = [\\xi_k I + \\alpha k \\sigma_y, \\sigma_x] = \\alpha k [\\sigma_y, \\sigma_x] = -2i\\alpha k \\sigma_z\n$$\nWe also compute the square of $h_0(k)$:\n$$\nh_0(k)^2 = (\\xi_k I + \\alpha k \\sigma_y)^2 = \\xi_k^2 I + 2\\alpha k \\xi_k \\sigma_y + (\\alpha k)^2 \\sigma_y^2 = (\\xi_k^2 + (\\alpha k)^2)I + 2\\alpha k \\xi_k \\sigma_y\n$$\nSubstituting these back, the matrix whose determinant we need is:\n$$\nM = - ((\\xi_k^2 + (\\alpha k)^2)I + 2\\alpha k \\xi_k \\sigma_y) - 2i\\alpha k V_Z \\sigma_z + (V_Z^2 - \\Delta^2) I\n$$\n$$\nM = (V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)I - 2\\alpha k \\xi_k \\sigma_y - 2i\\alpha k V_Z \\sigma_z\n$$\nThis is a $2 \\times 2$ matrix of the form $A I + B \\sigma_y + C \\sigma_z$. Its determinant is $A^2 - B^2 - C^2$.\n$$\n\\det(M) = (V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - (-2\\alpha k \\xi_k)^2 - (-2i\\alpha k V_Z)^2 = 0\n$$\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - 4(\\alpha k)^2 \\xi_k^2 - (4 i^2 (\\alpha k V_Z)^2) = 0\n$$\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 - 4(\\alpha k)^2 \\xi_k^2 + 4(\\alpha k)^2 V_Z^2 = 0\n$$\nThis simplifies to the gap-closing condition:\n$$\n(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 + 4(\\alpha k)^2(V_Z^2 - \\xi_k^2) = 0\n$$\nThis equation must have a real solution for the momentum $k$ for the gap to close. The first term is a square of a real number and is therefore non-negative. The second term's sign depends on $V_Z^2 - \\xi_k^2$.\nLet's analyze the possibility of solutions for $k$:\nCase 1: $V_Z^2 - \\xi_k^2 \\geq 0$. Both terms in the sum are non-negative. For the sum to be zero, both terms must be zero.\n$4(\\alpha k)^2(V_Z^2 - \\xi_k^2) = 0$. Since $\\alpha$ is a finite constant, this requires either $k=0$ or $V_Z^2 = \\xi_k^2$.\nIf $k=0$, then $\\xi_0 = -\\mu$. The condition becomes $(V_Z^2 - \\Delta^2 - \\mu^2)^2 = 0$, which gives $V_Z^2 = \\mu^2 + \\Delta^2$. This is a valid solution.\nIf $k \\ne 0$ and $V_Z^2 = \\xi_k^2$, the first term becomes $(V_Z^2 - \\Delta^2 - V_Z^2 - (\\alpha k)^2)^2 = (-\\Delta^2 - (\\alpha k)^2)^2 = (\\Delta^2 + (\\alpha k)^2)^2$. This term can only be zero if $\\Delta=0$ and $\\alpha k = 0$. However, the problem states $\\Delta  0$. Thus, this sub-case yields no solution.\n\nCase 2: $V_Z^2 - \\xi_k^2  0$. The second term is negative. The equation can be written as $(V_Z^2 - \\Delta^2 - \\xi_k^2 - (\\alpha k)^2)^2 = 4(\\alpha k)^2(\\xi_k^2 - V_Z^2)$. This seems possible.\n\nA more direct method is to treat the gap-closing condition as a quadratic equation for the variable $X=V_Z^2$, with coefficients that depend on $k$.\nLet $A=\\Delta^2$, $B_k = \\xi_k^2+(\\alpha k)^2$, $C_k=4(\\alpha k)^2$, and $D_k=\\xi_k^2$. The equation is $(X - A - B_k)^2 + C_k(X - D_k) = 0$.\n$X^2 + X(-2(A+B_k)+C_k) + (A+B_k)^2 - C_k D_k = 0$.\nThe solutions for $X=V_Z^2$ are given by the quadratic formula. The discriminant $D_s$ of this equation is:\n$D_s = (C_k-2(A+B_k))^2 - 4((A+B_k)^2 - C_k D_k) = C_k^2 - 4C_k(A+B_k) + 4C_k D_k = C_k(C_k-4A-4B_k+4D_k)$.\nSubstituting the definitions:\n$C_k-4A-4B_k+4D_k = 4(\\alpha k)^2 - 4\\Delta^2 - 4(\\xi_k^2+(\\alpha k)^2) + 4\\xi_k^2 = -4\\Delta^2$.\nSo, $D_s = C_k(-4\\Delta^2) = 4(\\alpha k)^2(-4\\Delta^2) = -16(\\alpha k \\Delta)^2$.\nThe solutions for $V_Z^2$ are:\n$$\nV_Z^2 = \\frac{2(A+B_k)-C_k \\pm \\sqrt{D_s}}{2} = \\Delta^2+\\xi_k^2+(\\alpha k)^2 - 2(\\alpha k)^2 \\pm \\frac{\\sqrt{-16(\\alpha k \\Delta)^2}}{2}\n$$\n$$\nV_Z^2 = \\Delta^2 + \\xi_k^2 - (\\alpha k)^2 \\pm 2i|\\alpha k \\Delta|\n$$\nSince $V_Z$ is a real physical parameter, $V_Z^2$ must be a real number. This requires the imaginary part of the solution to be zero:\n$$\n2|\\alpha k \\Delta| = 0\n$$\nGiven that $\\alpha$ is a finite constant and $\\Delta  0$, this condition can only be satisfied if $k=0$.\nTherefore, the gap closing can only occur at the momentum $k=0$.\n\nSubstituting $k=0$ into the condition for $V_Z^2$, the imaginary part vanishes, and we get:\n$$\nV_Z^2 = \\Delta^2 + \\xi_0^2 - 0 = \\Delta^2 + (-\\mu)^2 = \\mu^2 + \\Delta^2\n$$\nThis equation defines the locus of points in the $(\\mu, V_{Z})$ plane where the bulk gap closes, which corresponds to the topological phase transition boundary. The problem asks for the positive branch $V_Z^*(\\mu)$.\nFor $V_Z$ to be real, we need $\\mu^2+\\Delta^2 \\ge 0$. As $\\Delta  0$, this is always true for any real $\\mu$.\nThus, the expression for the positive gap-closing line is:\n$$\nV_Z^*(\\mu) = \\sqrt{\\mu^2 + \\Delta^2}\n$$\nThis describes a hyperbola in the $(\\mu, V_Z)$ plane, separating the trivial superconducting phase ($V_Z  \\sqrt{\\mu^2 + \\Delta^2}$) from the topological superconducting phase ($V_Z  \\sqrt{\\mu^2 + \\Delta^2}$).", "answer": "$$\n\\boxed{\\sqrt{\\mu^{2} + \\Delta^{2}}}\n$$", "id": "2869603"}, {"introduction": "Topological phases of matter are characterized by robust integer invariants that are insensitive to smooth deformations of the system. This hands-on coding exercise challenges you to compute one such invariant, the first Chern number, for a two-dimensional chiral $p+ip$ superconductor. By implementing the gauge-invariant Fukui-Hatsugai-Suzuki method, you will move beyond analytical theory to numerically verify the non-trivial topology of this canonical state [@problem_id:2869469]. This practice provides invaluable experience in the computational techniques used to classify and discover new topological materials.", "problem": "Implement a complete program that computes the first Chern number of the occupied band of a two-dimensional spinless square-lattice chiral $p+ip$ superconductor using a gauge-invariant lattice discretization of Berry curvature suitable for numerical computation, and validate the convergence of the result as the Brillouin zone mesh is refined. Use the following physically standard Bogoliubov–de Gennes (BdG) formulation as the fundamental base.\n\nConsider a tight-binding model on a square lattice with nearest-neighbor hopping amplitude $t$, chemical potential $\\mu$, and chiral pairing amplitude $\\Delta$. In momentum space, the $2 \\times 2$ BdG Hamiltonian is\n$$\nH(\\mathbf{k}) =\n\\begin{pmatrix}\n\\xi(\\mathbf{k})  \\Delta(\\mathbf{k}) \\\\\n\\Delta^{\\ast}(\\mathbf{k})  -\\xi(\\mathbf{k})\n\\end{pmatrix},\n$$\nwhere\n$$\n\\xi(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - \\mu,\\qquad\n\\Delta(\\mathbf{k}) = \\Delta\\left(\\sin k_x + i \\sin k_y\\right),\n$$\nwith $\\mathbf{k}=(k_x,k_y)$ in the Brillouin zone $[-\\pi,\\pi)\\times[-\\pi,\\pi)$. Work in units where $\\hbar=1$.\n\nStart from the following core definitions. The occupied band is the negative-energy eigenstate $\\lvert u(\\mathbf{k})\\rangle$ of $H(\\mathbf{k})$. The Berry connection is $A_i(\\mathbf{k})=-i\\langle u(\\mathbf{k})\\rvert \\partial_{k_i}\\lvert u(\\mathbf{k})\\rangle$ for $i\\in\\{x,y\\}$, the Berry curvature is $F_{xy}(\\mathbf{k})=\\partial_{k_x}A_y(\\mathbf{k})-\\partial_{k_y}A_x(\\mathbf{k})$, and the first Chern number is\n$$\nC = \\frac{1}{2\\pi}\\int_{\\text{BZ}} F_{xy}(\\mathbf{k})\\,d^2\\mathbf{k},\n$$\nwhich takes integer values when the spectrum is fully gapped.\n\nYour tasks:\n- Discretize the Brillouin zone uniformly into an $N_k\\times N_k$ grid in $k$-space with $k_x,k_y\\in[-\\pi,\\pi)$ sampled at $N_k$ equally spaced points in radians. Implement a stable, gauge-invariant lattice discretization of the Berry curvature integral (for example, the Fukui–Hatsugai–Suzuki method, originally formulated by Takahiro Fukui, Yasuhiro Hatsugai, and Hiroshi Suzuki) to compute $C$ for the occupied band. Do not assume any special gauge or phase smoothness beyond what is implied by the definition of the occupied band.\n- Ensure periodic boundary conditions in momentum space when forming finite differences or link variables on the discrete Brillouin zone.\n- For each parameter set, compute the Chern number on progressively finer meshes and assess convergence by comparing the computed values at successive $N_k$. Define convergence as follows: given three meshes with sizes $N_k^{(1)}N_k^{(2)}N_k^{(3)}$, compute three estimates $C^{(1)},C^{(2)},C^{(3)}$ (as real numbers before any rounding), and declare convergence if both $\\lvert C^{(2)}-C^{(1)}\\rvert10^{-3}$ and $\\lvert C^{(3)}-C^{(2)}\\rvert10^{-3}$. For reporting, round the finest-mesh value $C^{(3)}$ to the nearest integer using standard rounding to obtain an integer Chern number.\n- Numerical units: angles are in radians. No other physical units are required.\n\nTest suite:\nCompute results for the following parameter sets (all with $t=1.0$ and $\\Delta=1.0$):\n- Case $1$: $\\mu=-2.0$, meshes $N_k\\in\\{11,21,41\\}$.\n- Case $2$: $\\mu=2.0$, meshes $N_k\\in\\{11,21,41\\}$.\n- Case $3$: $\\mu=5.0$, meshes $N_k\\in\\{11,21,41\\}$.\n\nRequired outputs for each case:\n- An integer equal to the rounded Chern number from the finest mesh $N_k=41$.\n- A boolean indicating whether the sequence across the three meshes satisfies the above convergence criterion.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case is represented by a two-element list of the form $[C_{\\text{int}},\\text{converged}]$. Concretely, the output must have the form\n$[[C_{\\text{int}}^{(1)},\\text{converged}^{(1)}],[C_{\\text{int}}^{(2)},\\text{converged}^{(2)}],[C_{\\text{int}}^{(3)},\\text{converged}^{(3)}]]$\nwith no extra whitespace or text. Angles are in radians by construction, and no additional units are needed in the output.", "solution": "The problem presented is a well-posed and scientifically grounded task in computational condensed matter physics. It requires the calculation of a topological invariant, the first Chern number, for a canonical model of a two-dimensional chiral superconductor. All parameters, definitions, and numerical procedures are explicitly stated and consistent with established principles of topological band theory. The model is the Bogoliubov–de Gennes (BdG) Hamiltonian for a spinless $p+ip$ superconductor on a square lattice, a cornerstone for studying topological phases and Majorana quasiparticles. The problem is valid.\n\nThe core task is to compute the first Chern number, $C$, of the occupied (negative energy) band of the given BdG Hamiltonian $H(\\mathbf{k})$. The Hamiltonian in the basis $(\\psi_{\\mathbf{k}}, \\psi_{-\\mathbf{k}}^{\\dagger})^T$ is:\n$$\nH(\\mathbf{k}) =\n\\begin{pmatrix}\n\\xi(\\mathbf{k})  \\Delta(\\mathbf{k}) \\\\\n\\Delta^{\\ast}(\\mathbf{k})  -\\xi(\\mathbf{k})\n\\end{pmatrix} = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}\n$$\nwhere $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices, and the vector $\\mathbf{d}(\\mathbf{k})$ is given by $\\mathbf{d}(\\mathbf{k}) = (\\text{Re}[\\Delta(\\mathbf{k})], -\\text{Im}[\\Delta(\\mathbf{k})], \\xi(\\mathbf{k}))$. The components are:\n$$\n\\xi(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - \\mu\n$$\n$$\n\\Delta(\\mathbf{k}) = \\Delta\\left(\\sin k_x + i \\sin k_y\\right)\n$$\nThe eigenvalues of $H(\\mathbf{k})$ are $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm\\sqrt{\\xi(\\mathbf{k})^2 + |\\Delta(\\mathbf{k})|^2}$. The system is gapped provided $|\\mathbf{d}(\\mathbf{k})| \\neq 0$ for all $\\mathbf{k}$ in the Brillouin zone (BZ), which is $[-\\pi, \\pi) \\times [-\\pi, \\pi)$. The occupied band corresponds to the negative eigenvalue $E_-(\\mathbf{k})$, and its normalized eigenvector is denoted by $\\lvert u(\\mathbf{k})\\rangle$. For this two-band model, $\\lvert u(\\mathbf{k})\\rangle$ can be written in terms of the normalized vector $\\hat{\\mathbf{d}}(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k})/|\\mathbf{d}(\\mathbf{k})|$.\n\nThe first Chern number is defined as the integral of the Berry curvature, $F_{xy}(\\mathbf{k})$, over the BZ:\n$$\nC = \\frac{1}{2\\pi} \\int_{\\text{BZ}} F_{xy}(\\mathbf{k}) \\, dk_x dk_y\n$$\nThe Berry curvature is $F_{xy}(\\mathbf{k}) = \\partial_{k_x} A_y(\\mathbf{k}) - \\partial_{k_y} A_x(\\mathbf{k})$, where the Berry connection components are $A_i(\\mathbf{k}) = -i \\langle u(\\mathbf{k}) \\rvert \\partial_{k_i} \\lvert u(\\mathbf{k}) \\rangle$. A direct numerical implementation by discretizing this definition is problematic. The eigenvector $\\lvert u(\\mathbf{k})\\rangle$ is defined only up to an arbitrary phase factor, or gauge, $e^{i\\chi(\\mathbf{k})}$. A numerical eigensolver may return eigenvectors with a rapidly fluctuating, non-smooth gauge, rendering numerical differentiation of $\\lvert u(\\mathbf{k})\\rangle$ unreliable.\n\nTo circumvent this, we use the gauge-invariant numerical method developed by Fukui, Hatsugai, and Suzuki. This method computes the Chern number on a discretized Brillouin zone without needing a smooth gauge. The BZ is discretized into a uniform $N_k \\times N_k$ lattice of points $\\mathbf{k}_{j_x, j_y} = (-\\pi + j_x \\delta k, -\\pi + j_y \\delta k)$ where $\\delta k = 2\\pi/N_k$ and $j_x, j_y = 0, \\dots, N_k-1$.\n\nFirst, we define U(1) link variables connecting adjacent points on this momentum-space lattice. For a link in direction $i \\in \\{x,y\\}$, starting from point $\\mathbf{k}$, the link variable is:\n$$\nU_i(\\mathbf{k}) = \\frac{\\langle u(\\mathbf{k}) \\lvert u(\\mathbf{k} + \\delta k \\hat{e}_i) \\rangle}{|\\langle u(\\mathbf{k}) \\lvert u(\\mathbf{k} + \\delta k \\hat{e}_i) \\rangle|}\n$$\nwhere $\\hat{e}_i$ is the unit vector in the $k_i$ direction. This variable captures the relative phase between eigenstates at neighboring points and has a magnitude of $1$. The denominator makes the definition robust against arbitrary scaling of the eigenvectors, although they are assumed to be normalized. The periodic boundary conditions of the BZ are imposed by wrapping around the grid, i.e., indices are taken modulo $N_k$.\n\nNext, we define a lattice field strength (or plaquette flux) on each elementary plaquette of the discretized BZ. For a plaquette with its bottom-left corner at $\\mathbf{k}$, the flux is derived from the product of link variables around it:\n$$\n\\tilde{F}_{xy}(\\mathbf{k}) = U_x(\\mathbf{k}) \\, U_y(\\mathbf{k} + \\delta k \\hat{e}_x) \\, U_x(\\mathbf{k} + \\delta k \\hat{e}_y)^{-1} \\, U_y(\\mathbf{k})^{-1}\n$$\nThe Berry curvature on this plaquette is defined as the argument of this complex number:\n$$\nF_{xy}^{\\text{lat}}(\\mathbf{k}) = \\arg(\\tilde{F}_{xy}(\\mathbf{k})) = \\text{Im}[\\ln(\\tilde{F}_{xy}(\\mathbf{k}))]\n$$\nThe `arg` function must return the principal value in the interval $(-\\pi, \\pi]$. This quantity is manifestly gauge-invariant.\n\nThe total Chern number is then the sum of these local curvatures over all plaquettes, normalized by $2\\pi$:\n$$\nC = \\frac{1}{2\\pi} \\sum_{j_x, j_y = 0}^{N_k-1} F_{xy}^{\\text{lat}}(\\mathbf{k}_{j_x, j_y})\n$$\nThis sum will converge to the true integer Chern number as $N_k \\to \\infty$, provided the system is gapped.\n\nThe computational procedure is as follows:\n1. For each parameter set $(\\mu, t, \\Delta)$, define a function to compute $C$ for a given mesh size $N_k$.\n2. Inside the function, generate the $N_k \\times N_k$ grid of $\\mathbf{k}$-points.\n3. For each $\\mathbf{k}$ on the grid, construct the $2 \\times 2$ Hamiltonian matrix $H(\\mathbf{k})$.\n4. Diagonalize $H(\\mathbf{k})$ using a numerical eigensolver (e.g., `numpy.linalg.eigh`). Store the eigenvector corresponding to the lower (negative) eigenvalue for every $\\mathbf{k}$. This results in an $N_k \\times N_k$ array of $2$-component complex vectors.\n5. Compute the link variables $U_x$ and $U_y$ for all links on the grid. This is done by taking vectorized inner products between the eigenvector array and a shifted version of itself (using `numpy.roll` for periodic boundaries). The results are normalized to have unit magnitude.\n6. Compute the plaquette products $\\tilde{F}_{xy}$ using the arrays of link variables and appropriate shifts.\n7. Calculate the lattice curvature $F_{xy}^{\\text{lat}}$ by taking the angle of the plaquette products using `numpy.angle`.\n8. Sum all values of $F_{xy}^{\\text{lat}}$ and divide by $2\\pi$ to obtain the Chern number $C$ as a floating-point number.\n9. For each parameter set, repeat this computation for mesh sizes $N_k \\in \\{11, 21, 41\\}$ to obtain $C^{(1)}, C^{(2)}, C^{(3)}$.\n10. Assess convergence by checking if $|C^{(2)} - C^{(1)}|  10^{-3}$ and $|C^{(3)} - C^{(2)}|  10^{-3}$.\n11. Round the finest-mesh result, $C^{(3)}$, to the nearest integer to report the final Chern number. The expected values for the test cases, derived from theory, are $1$ for $\\mu=-2.0$, $-1$ for $\\mu=2.0$, and $0$ for $\\mu=5.0$, which provides a robust check of correctness.", "answer": "```python\nimport numpy as np\n\ndef compute_chern(t, mu, delta, Nk):\n    \"\"\"\n    Computes the first Chern number of the occupied band of a p+ip superconductor.\n\n    Args:\n        t (float): Hopping amplitude.\n        mu (float): Chemical potential.\n        delta (float): Pairing amplitude.\n        Nk (int): Size of the Brillouin zone mesh (Nk x Nk).\n\n    Returns:\n        float: The computed Chern number.\n    \"\"\"\n    # 1. Discretize the Brillouin Zone\n    # kx, ky grid from -pi to pi (exclusive of pi)\n    k_vals = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n    kx, ky = np.meshgrid(k_vals, k_vals)\n\n    # 2. Calculate Hamiltonian components and eigenvectors\n    xi_k = -2 * t * (np.cos(kx) + np.cos(ky)) - mu\n    delta_k = delta * (np.sin(kx) + 1j * np.sin(ky))\n    \n    # The BdG Hamiltonian is H = xi*sigma_z + Re(delta)*sigma_x - Im(delta)*sigma_y\n    # The eigenvectors of d.sigma are known analytically, but numerical diagonalization is more general.\n    # We construct the Hamiltonian for each k-point and diagonalize it.\n    eigenvectors = np.zeros((Nk, Nk, 2), dtype=np.complex128)\n    \n    for i in range(Nk):\n        for j in range(Nk):\n            H_k = np.array([\n                [xi_k[i, j], delta_k[i, j]],\n                [np.conj(delta_k[i, j]), -xi_k[i, j]]\n            ], dtype=np.complex128)\n            \n            # Diagonalize to get eigenvalues and eigenvectors\n            # eigh returns sorted eigenvalues, so the first eigenvector\n            # corresponds to the lowest eigenvalue (occupied band)\n            eigenvalues, eigvecs = np.linalg.eigh(H_k)\n            eigenvectors[i, j, :] = eigvecs[:, 0]\n\n    # 3. Compute U(1) link variables using the Fukui-Hatsugai-Suzuki method\n    # Shift eigenvectors for periodic boundary conditions\n    eigenvectors_x_shifted = np.roll(eigenvectors, -1, axis=1) # Shift in +kx (j)\n    eigenvectors_y_shifted = np.roll(eigenvectors, -1, axis=0) # Shift in +ky (i)\n\n    # Calculate overlaps (inner products)\n    # u(k)|u(k+dk_x)\n    U_x = np.einsum('ijk,ijk-ij', np.conj(eigenvectors), eigenvectors_x_shifted)\n    # u(k)|u(k+dk_y)\n    U_y = np.einsum('ijk,ijk-ij', np.conj(eigenvectors), eigenvectors_y_shifted)\n    \n    # Normalize to get U(1) link variables\n    U_x /= np.abs(U_x)\n    U_y /= np.abs(U_y)\n\n    # 4. Compute plaquette flux\n    U_y_x_shifted = np.roll(U_y, -1, axis=1)\n    U_x_y_shifted = np.roll(U_x, -1, axis=0)\n    \n    # Plaquette product: U_x(k) * U_y(k+dk_x) * U_x(k+dk_y)^-1 * U_y(k)^-1\n    plaquette_prod = U_x * U_y_x_shifted * np.conj(U_x_y_shifted) * np.conj(U_y)\n\n    # 5. Calculate Berry curvature and sum to get Chern number\n    # F_xy = arg(plaquette_prod)\n    berry_curvature = np.angle(plaquette_prod)\n    \n    chern_number = np.sum(berry_curvature) / (2 * np.pi)\n    \n    return chern_number\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and format output.\n    \"\"\"\n    problem_params = [\n        {'mu': -2.0, 'Nk_meshes': [11, 21, 41]},\n        {'mu': 2.0, 'Nk_meshes': [11, 21, 41]},\n        {'mu': 5.0, 'Nk_meshes': [11, 21, 41]},\n    ]\n    \n    t = 1.0\n    delta = 1.0\n    convergence_threshold = 1.0e-3\n    \n    results = []\n    \n    for params in problem_params:\n        mu = params['mu']\n        meshes = params['Nk_meshes']\n        \n        # Compute Chern numbers for the three mesh sizes\n        c_vals = [compute_chern(t, mu, delta, Nk) for Nk in meshes]\n        C1, C2, C3 = c_vals[0], c_vals[1], c_vals[2]\n        \n        # Check for convergence\n        converged = (abs(C2 - C1)  convergence_threshold) and \\\n                    (abs(C3 - C2)  convergence_threshold)\n        \n        # Round the finest mesh result to the nearest integer\n        # Python's round() rounds .5 to the nearest even integer\n        C_int = round(C3)\n        \n        results.append([C_int, converged])\n\n    # Format the final output string exactly as required\n    output_str = '[' + ','.join([f'[{c},{str(b).lower()}]' for c, b in results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2869469"}]}