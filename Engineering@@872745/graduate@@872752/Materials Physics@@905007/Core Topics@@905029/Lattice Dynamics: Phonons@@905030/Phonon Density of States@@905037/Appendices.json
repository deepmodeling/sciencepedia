{"hands_on_practices": [{"introduction": "The Debye model offers a remarkably successful yet simplified picture of a solid's vibrational properties. It approximates the complex phonon dispersion with a linear relationship up to a cutoff frequency, $\\omega_D$. This foundational exercise [@problem_id:179778] guides you through the derivation of this crucial parameter, revealing how it connects the microscopic density of states in $k$-space to the macroscopic number of atoms in the crystal.", "problem": "The Debye model provides a powerful framework for understanding the thermal properties of solids. It approximates the complex vibrational spectrum of a crystal lattice with a simplified, continuous model. Consider a simple three-dimensional, monoatomic solid containing $N$ atoms in a volume $V$. The number density of atoms is given by $n = N/V$.\n\nThe key assumptions of the Debye model are:\n1.  The solid is treated as a continuous elastic medium.\n2.  The dispersion relation for phonons is linear and isotropic for all polarizations: $\\omega(\\vec{k}) = v_s |\\vec{k}|$, where $\\omega$ is the angular frequency, $\\vec{k}$ is the wavevector, and $v_s$ is an effective speed of sound, assumed to be constant for all modes.\n3.  The total number of vibrational modes is fixed at $3N$, corresponding to the classical degrees of freedom of the $N$ atoms.\n4.  To satisfy the previous condition, a cutoff frequency, the Debye frequency $\\omega_D$, is introduced. No modes with frequency greater than $\\omega_D$ exist. This implies there is a corresponding cutoff wavevector, $k_D$, such that all allowed modes lie within a sphere of radius $k_D$ in k-space (the Debye sphere).\n\nUsing these assumptions, derive an expression for the Debye frequency $\\omega_D$ in terms of the number density of atoms $n$ and the effective speed of sound $v_s$.", "solution": "The goal is to find the Debye frequency $\\omega_D$ as a function of the number density of atoms $n$ and the effective speed of sound $v_s$. The derivation proceeds by determining the cutoff wavevector $k_D$ that ensures the total number of vibrational modes is equal to $3N$.\n\n**Step 1: Quantization of wavevectors in k-space**\n\nFor a solid of volume $V = L^3$ with periodic boundary conditions, the allowed wavevectors $\\vec{k} = (k_x, k_y, k_z)$ are quantized:\n$$ k_i = \\frac{2\\pi m_i}{L} \\quad \\text{for} \\quad i = x, y, z $$\nwhere $m_i$ are integers. This means that each allowed $\\vec{k}$ vector occupies a volume of $(2\\pi/L)^3 = (2\\pi)^3/V$ in k-space. The density of states in k-space is the reciprocal of this volume, $V/(2\\pi)^3$.\n\n**Step 2: Calculate the total number of modes within the Debye sphere**\n\nThe total number of vibrational modes in the solid is $3N$. In the Debye model, these modes are assumed to be distributed within a sphere of radius $k_D$ in k-space. For each allowed $\\vec{k}$ vector, there are three orthogonal polarization modes (one longitudinal and two transverse). The model simplifies this by assuming they all have the same speed of sound $v_s$.\n\nTo find the total number of modes, we multiply the number of allowed $\\vec{k}$ states within the Debye sphere by the number of polarizations (3). The number of $\\vec{k}$ states is found by integrating the k-space density of states over the volume of the Debye sphere.\n\n$$ 3N = (\\text{number of polarizations}) \\times (\\text{density of k-states}) \\times (\\text{volume of Debye sphere}) $$\n$$ 3N = 3 \\times \\frac{V}{(2\\pi)^3} \\times \\left( \\int_{|\\vec{k}| \\le k_D} d^3k \\right) $$\n\nThe integral is simply the volume of a sphere of radius $k_D$ in 3D k-space, which is $\\frac{4}{3}\\pi k_D^3$.\n\n$$ 3N = 3 \\times \\frac{V}{(2\\pi)^3} \\times \\left( \\frac{4}{3}\\pi k_D^3 \\right) $$\n\n**Step 3: Solve for the Debye wavevector $k_D$**\n\nWe can simplify the expression from Step 2. The factor of 3 on both sides cancels out:\n$$ N = \\frac{V}{8\\pi^3} \\times \\frac{4\\pi}{3} k_D^3 $$\n$$ N = \\frac{V k_D^3}{6\\pi^2} $$\n\nNow, we solve for $k_D^3$. We recall that the number density of atoms is $n = N/V$.\n$$ k_D^3 = \\frac{6\\pi^2 N}{V} $$\n$$ k_D^3 = 6\\pi^2 n $$\n\nTaking the cube root gives the expression for the Debye wavevector:\n$$ k_D = (6\\pi^2 n)^{1/3} $$\n\n**Step 4: Relate the Debye wavevector to the Debye frequency**\n\nThe Debye model assumes a linear dispersion relation $\\omega = v_s k$. The Debye frequency $\\omega_D$ is the frequency corresponding to the cutoff wavevector $k_D$:\n$$ \\omega_D = v_s k_D $$\n\nSubstituting the expression for $k_D$ from Step 3, we get the final result.\n$$ \\omega_D = v_s (6\\pi^2 n)^{1/3} $$\nThis expression gives the Debye frequency in terms of the fundamental properties of the solid: its atomic number density and the speed of sound.", "answer": "$$ \\boxed{v_s (6\\pi^2 n)^{1/3}} $$", "id": "179778"}, {"introduction": "Moving beyond specific models, we can explore how the phonon DOS behaves under general physical transformations such as isotopic substitution, which alters atomic masses without changing interatomic forces. This practice is rooted in the harmonic approximation's equation of motion and demonstrates how scaling the mass matrix affects the vibrational frequencies and, consequently, the entire density of states function. By completing this derivation [@problem_id:2847832], you will gain a deeper insight into the fundamental relationship between mass and vibrational frequency and master the technique for transforming density functions.", "problem": "A crystalline solid with $n$ atoms per primitive unit cell is described in the harmonic approximation by a quadratic potential energy with force-constant matrix $\\Phi$, which is independent of isotopic masses. Let the displacements of atoms be collected in the vector $u(t)$ and let the diagonal, positive-definite mass matrix be $M$. The equations of motion are given by the linear second-order system $M\\,\\ddot{u}(t)=-\\Phi\\,u(t)$. Normal mode solutions of the form $u(t)=\\Re\\{U\\exp(-\\mathrm{i}\\,\\omega t)\\}$ exist with angular frequencies $\\omega\\ge 0$ determined by the generalized eigenvalue problem $\\Phi\\,U=\\omega^{2}M\\,U$.\n\nConsider a uniform isotope substitution that multiplies every atomic mass by the same positive factor $\\alpha0$, so that $M\\mapsto M'=\\alpha M$, while the force-constant matrix $\\Phi$ is unchanged. Let $g_{\\mathrm{old}}(\\omega)$ denote the phonon density of states (density of modes per unit angular-frequency) of the original crystal, defined so that its integral over $\\omega\\in[0,\\infty)$ equals the total number of normal modes, and let $g_{\\mathrm{new}}(\\omega)$ denote the phonon density of states after the isotopic substitution.\n\nStarting only from the harmonic equations of motion and the definition of the phonon density of states, derive how all phonon angular frequencies transform under this mass scaling and, from that, determine the transformation law for the density of states under the uniform isotope substitution. Express your final result as a single closed-form expression for $g_{\\mathrm{new}}(\\omega)$ in terms of $g_{\\mathrm{old}}(\\cdot)$, $\\omega$, and $\\alpha$. Do not use any pre-derived scaling formulas. The final answer must be a single analytic expression. No numerical evaluation is required, and no units should be included in the final boxed expression.", "solution": "The problem as stated is scientifically grounded, well-posed, and self-contained. It describes a standard scenario in the harmonic theory of lattice dynamics. All provided information is consistent and sufficient for a rigorous derivation. We shall therefore proceed to the solution.\n\nThe dynamics of the crystal lattice in the harmonic approximation are governed by the set of linear second-order differential equations:\n$$M\\,\\ddot{u}(t)=-\\Phi\\,u(t)$$\nwhere $M$ is the diagonal mass matrix, $\\Phi$ is the force-constant matrix, and $u(t)$ is the vector of atomic displacements. We seek normal mode solutions of the form $u(t)=\\Re\\{U\\exp(-\\mathrm{i}\\,\\omega t)\\}$, where $U$ is a time-independent amplitude vector and $\\omega$ is the angular frequency. Substituting this ansatz into the equation of motion yields the generalized eigenvalue problem:\n$$\\Phi\\,U = \\omega^2 M\\,U$$\nThe solutions to this equation provide the set of normal mode frequencies $\\{\\omega_j\\}$ for the original crystal.\n\nThe problem can be recast into a standard eigenvalue problem. Since the mass matrix $M$ is diagonal and positive-definite, its inverse $M^{-1}$ exists. Multiplying from the left by $M^{-1}$, we obtain:\n$$ M^{-1}\\Phi\\,U = \\omega^2 U $$\nThus, the squared frequencies $\\omega_j^2$ are the eigenvalues of the dynamical matrix $D = M^{-1}\\Phi$.\n\nNow, consider the uniform isotopic substitution where each atomic mass is scaled by a factor $\\alpha  0$. The new mass matrix is $M' = \\alpha M$. The force-constant matrix $\\Phi$ is stated to be unchanged, as it depends on interatomic electronic interactions, not nuclear mass. The new equations of motion are $M'\\,\\ddot{u}'(t)=-\\Phi\\,u'(t)$, leading to a new eigenvalue problem for the new frequencies $\\omega'$ and amplitudes $U'$:\n$$\\Phi\\,U' = (\\omega')^2 M'\\,U'$$\nSubstituting $M' = \\alpha M$, we have:\n$$\\Phi\\,U' = (\\omega')^2 (\\alpha M)\\,U'$$\nWe can again transform this into a standard eigenvalue problem by multiplying from the left by $(M')^{-1} = (\\alpha M)^{-1} = \\frac{1}{\\alpha} M^{-1}$:\n$$ (M')^{-1}\\Phi\\,U' = (\\omega')^2 U' $$\n$$ \\frac{1}{\\alpha} M^{-1}\\Phi\\,U' = (\\omega')^2 U' $$\nLet the eigenvalues of the original dynamical matrix $D = M^{-1}\\Phi$ be $\\{\\lambda_j = \\omega_j^2\\}$ with corresponding eigenvectors $\\{U_j\\}$. The new dynamical matrix is $D' = \\frac{1}{\\alpha} D$. If a matrix is multiplied by a scalar, its eigenvalues are multiplied by the same scalar, while its eigenvectors remain unchanged. Therefore, the new eigenvectors are identical to the old ones, $U'_j = U_j$, and the new eigenvalues $(\\omega'_j)^2$ are related to the old eigenvalues $\\omega_j^2$ by:\n$$ (\\omega'_j)^2 = \\frac{1}{\\alpha} \\omega_j^2 $$\nSince frequencies are defined to be non-negative ($\\omega_j \\ge 0$ and $\\omega'_j \\ge 0$), we may take the positive square root of both sides:\n$$ \\omega'_j = \\frac{1}{\\sqrt{\\alpha}} \\omega_j $$\nThis is the transformation law for any individual phonon frequency. The entire frequency spectrum is scaled by a factor of $1/\\sqrt{\\alpha}$.\n\nNext, we must determine the transformation of the phonon density of states, $g(\\omega)$. The function $g(\\omega)$ is defined such that $g(\\omega)d\\omega$ is the number of normal modes with frequencies in the infinitesimal interval $[\\omega, \\omega+d\\omega]$. The total number of modes, which is a constant for a given crystal structure, is given by $\\int_0^\\infty g(\\omega)d\\omega$.\n\nLet $g_{\\mathrm{old}}(\\omega)$ be the density of states for the original crystal and $g_{\\mathrm{new}}(\\omega)$ be the density of states for the isotopically substituted crystal. Consider an infinitesimal frequency interval $[\\omega, \\omega+d\\omega]$ in the original system. The number of modes $dN$ in this interval is:\n$$ dN = g_{\\mathrm{old}}(\\omega)\\,d\\omega $$\nUnder the mass scaling, these same modes will have their frequencies shifted. A mode with original frequency $\\omega$ will now have a frequency $\\omega' = \\omega/\\sqrt{\\alpha}$. Thus, the modes originally in the interval $[\\omega, \\omega+d\\omega]$ will now occupy the new frequency interval $[\\omega', \\omega'+d\\omega']$, where:\n$$ \\omega' = \\frac{\\omega}{\\sqrt{\\alpha}} \\quad \\text{and} \\quad \\omega'+d\\omega' = \\frac{\\omega+d\\omega}{\\sqrt{\\alpha}} $$\nThe width of this new interval is $d\\omega' = d\\omega/\\sqrt{\\alpha}$.\n\nThe number of modes in the new interval $[\\omega', \\omega'+d\\omega']$ is given by $g_{\\mathrm{new}}(\\omega')d\\omega'$. Since we are considering the exact same set of physical modes, their count must be conserved. Therefore:\n$$ g_{\\mathrm{old}}(\\omega)\\,d\\omega = g_{\\mathrm{new}}(\\omega')\\,d\\omega' $$\nFrom this equality, we can express $g_{\\mathrm{new}}(\\omega')$:\n$$ g_{\\mathrm{new}}(\\omega') = g_{\\mathrm{old}}(\\omega) \\frac{d\\omega}{d\\omega'} $$\nTo complete this expression, we must write the right-hand side entirely in terms of the new frequency variable $\\omega'$. From the frequency transformation $\\omega' = \\omega/\\sqrt{\\alpha}$, we have $\\omega = \\omega'\\sqrt{\\alpha}$. Differentiating $\\omega$ with respect to $\\omega'$ gives the Jacobian of the transformation:\n$$ \\frac{d\\omega}{d\\omega'} = \\sqrt{\\alpha} $$\nSubstituting both $\\omega = \\omega'\\sqrt{\\alpha}$ and $d\\omega/d\\omega' = \\sqrt{\\alpha}$ into the expression for $g_{\\mathrm{new}}(\\omega')$ yields:\n$$ g_{\\mathrm{new}}(\\omega') = g_{\\mathrm{old}}(\\omega'\\sqrt{\\alpha}) \\sqrt{\\alpha} $$\nThe final step is to replace the dummy variable $\\omega'$ with $\\omega$ to express the new density of states as a function of $\\omega$. This gives the final transformation law for the phonon density of states:\n$$ g_{\\mathrm{new}}(\\omega) = \\sqrt{\\alpha} \\, g_{\\mathrm{old}}(\\omega\\sqrt{\\alpha}) $$\nThis result correctly reflects that if the mass increases ($\\alpha  1$), the frequencies decrease, and the density of states must increase in magnitude and be compressed along the frequency axis to conserve the total number of states. Conversely, if the mass decreases ($0  \\alpha  1$), the frequencies increase, and the density of states decreases in magnitude and is stretched along the frequency axis. The derivation is complete.", "answer": "$$\n\\boxed{\\sqrt{\\alpha} \\, g_{\\mathrm{old}}(\\omega\\sqrt{\\alpha})}\n$$", "id": "2847832"}, {"introduction": "A key goal in modern materials physics is to engineer the phonon DOS to achieve desired properties. This advanced computational practice [@problem_id:2847795] challenges you to design a 1D phononic crystal that exhibits a band gap—a frequency range where $g(\\omega)=0$—centered at a specific target frequency. This exercise bridges theory and application, giving you hands-on experience in the forward design of a metamaterial and using the DOS and transmission spectrum as practical verification tools.", "problem": "You must design and verify a one-dimensional periodic phononic crystal using first principles of lattice dynamics. Consider a centrosymmetric diatomic unit cell consisting of two identical point masses connected in series by two different nearest-neighbor linear springs per unit cell (alternating spring constants), often called a dimerized monoatomic chain. The physical model is: an infinite chain of point masses of mass $m$ on a line at sites separated by a lattice constant $a$, with the intra-cell and inter-cell nearest-neighbor couplings given by two distinct spring constants $K_{1}$ and $K_{2}$ that alternate along the chain. Assume undamped, harmonic motion and apply Newton’s second law and the Bloch theorem to formulate the eigenvalue problem for lattice vibrations. Use the definition of the phonon density of states (DOS), $g(\\omega)$, as the sum over wave vectors of Dirac delta functions at the eigenfrequencies per unit cell, and approximate it numerically by Brillouin-zone sampling with Gaussian broadening. Use the existence or non-existence of real Bloch wavevectors as the criterion for propagating versus evanescent solutions.\n\nDesign task:\n- Given a target angular frequency $\\omega_{0}$, a fixed mass $m$, a lattice constant $a$, and a prescribed spring-constant ratio $r$ defined by $r = K_{1}/K_{2}$, choose spring constants $K_{1}$ and $K_{2}$ so that the fundamental band gap of the infinite periodic chain is centered at $\\omega_{0}$. You must determine from first principles how to relate the band-gap center to the model parameters.\n- For a finite segment consisting of $N$ unit cells, define an approximate transmission metric at a given angular frequency $\\omega$ by using the complex Bloch wavevector $\\kappa$ when no real Bloch wavevector exists (evanescent regime), and by using unity when real Bloch waves exist (propagating regime). In the evanescent regime, model the attenuation across the $N$ cells as an exponential decay in amplitude, and define the transmission magnitude as $\\exp(-2 \\kappa N a)$. You must obtain $\\kappa$ from the dispersion relation by analytic continuation of the Bloch wavevector.\n\nVerification requirements:\n- Numerically approximate the phonon density of states per unit cell, $g(\\omega)$, by sampling the first Brillouin zone and applying Gaussian broadening with a given standard deviation $\\sigma$ (in $\\mathrm{rad/s}$). Evaluate $g(\\omega_{0})$ to test if it is strongly suppressed near the target gap center. Express $g(\\omega_{0})$ in units of $\\mathrm{s}$ (that is, $\\mathrm{(rad/s)}^{-1}$), per unit cell.\n- Determine the upper edge of the acoustic branch and the lower edge of the optical branch of the infinite chain, and report their angular frequencies in $\\mathrm{rad/s}$. Use only derivations from the governing equations; do not invoke any condensed “textbook” band-edge formulas without derivation.\n- Compute the approximate transmission at $\\omega_{0}$ for the finite chain consisting of $N$ unit cells, as described above, and report the dimensionless value $T(\\omega_{0})$.\n\nAcceptance criterion for a successful design at $\\omega_{0}$:\n- The target frequency lies strictly between the acoustic-band maximum and the optical-band minimum (a non-zero gap),\n- The numerically estimated $g(\\omega_{0})$ is smaller than a specified threshold,\n- The transmission $T(\\omega_{0})$ is smaller than a specified threshold.\n\nYour program must, for each test case, produce the tuple of results\n- $[K_{1},K_{2},\\omega_{\\mathrm{ac,max}},\\omega_{\\mathrm{op,min}},g(\\omega_{0}),T(\\omega_{0}),\\text{success}]$,\nwith $K_{1}$ and $K_{2}$ in $\\mathrm{N/m}$, $\\omega_{\\mathrm{ac,max}}$ and $\\omega_{\\mathrm{op,min}}$ in $\\mathrm{rad/s}$, $g(\\omega_{0})$ in $\\mathrm{s}$, $T(\\omega_{0})$ dimensionless, and $\\text{success}$ a boolean.\n\nNumerical instructions and constraints:\n- Brillouin-zone sampling must be uniform in $k$ over one irreducible interval and must include both phonon branches when computing $g(\\omega)$; use Gaussian broadening of width $\\sigma$ (provided per test) to approximate Dirac delta functions. Express angles in radians.\n- When evaluating transmission at $\\omega_{0}$, classify propagation by the Bloch wavevector: if the Bloch wavenumber is real at $\\omega_{0}$, set $T(\\omega_{0})=1$; otherwise, if it is purely imaginary with decay constant $\\kappa$, set $T(\\omega_{0})=\\exp(-2\\kappa N a)$.\n- Use the following thresholds for acceptance: $g(\\omega_{0})10^{-14}\\,\\mathrm{s}$ and $T(\\omega_{0})10^{-5}$.\n\nTest suite:\nProvide results for the following three cases, each specified as $(\\omega_{0}, m, a, r, N, \\sigma)$:\n- Case A (happy path, sizable gap): $(2\\pi\\times 8.0\\times 10^{12}\\,\\mathrm{rad/s},\\, 2.0\\times 10^{-26}\\,\\mathrm{kg},\\, 3.0\\times 10^{-10}\\,\\mathrm{m},\\, 2.0,\\, 50,\\, 5.0\\times 10^{11}\\,\\mathrm{rad/s})$.\n- Case B (boundary case, no gap): $(2\\pi\\times 5.0\\times 10^{12}\\,\\mathrm{rad/s},\\, 2.0\\times 10^{-26}\\,\\mathrm{kg},\\, 3.0\\times 10^{-10}\\,\\mathrm{m},\\, 1.0,\\, 50,\\, 5.0\\times 10^{11}\\,\\mathrm{rad/s})$.\n- Case C (narrow gap): $(2\\pi\\times 10.0\\times 10^{12}\\,\\mathrm{rad/s},\\, 1.5\\times 10^{-26}\\,\\mathrm{kg},\\, 2.5\\times 10^{-10}\\,\\mathrm{m},\\, 1.1,\\, 80,\\, 5.0\\times 10^{11}\\,\\mathrm{rad/s})$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, enclosed in square brackets, in the order of the test suite cases, e.g., $[[\\dots],[\\dots],[\\dots]]$. No additional text is permitted in the output.", "solution": "The problem statement is a valid, well-posed problem in materials physics, specifically the study of lattice dynamics in a one-dimensional periodic structure. It is scientifically grounded, objective, and contains all necessary information to proceed with a unique solution. The model is a standard representation of a dimerized chain, which is equivalent to a diatomic chain with equal masses. The tasks of designing spring constants to center a band gap, calculating band edges, density of states, and transmission are all standard procedures derived from first principles.\n\nHere follows the derivation of the necessary physical quantities.\n\nThe model is a one-dimensional chain of identical masses $m$ with alternating spring constants $K_{1}$ and $K_{2}$. This system has a periodicity defined by a unit cell containing two masses. Let the lattice constant, i.e., the length of the unit cell, be $a$. Let the displacements from equilibrium for the two masses in the $n$-th unit cell be $u_{n,1}$ and $u_{n,2}$. Applying Newton's second law for harmonic motion yields the equations of motion:\n$$m \\ddot{u}_{n,1} = -K_{1}(u_{n,1} - u_{n,2}) - K_{2}(u_{n,1} - u_{n-1,2})$$\n$$m \\ddot{u}_{n,2} = -K_{1}(u_{n,2} - u_{n,1}) - K_{2}(u_{n,2} - u_{n+1,1})$$\n\nWe apply the Bloch theorem and seek plane-wave solutions of the form $u_{n,\\alpha} = U_{\\alpha} e^{i(kna - \\omega t)}$, where $k$ is the wavevector, $\\omega$ is the angular frequency, and $U_{1}, U_{2}$ are the amplitudes. Substituting this ansatz into the equations of motion leads to a system of linear equations for the amplitudes $U_1, U_2$:\n$$\\left( K_{1}+K_{2} - m\\omega^2 \\right) U_1 - \\left( K_{1} + K_{2} e^{-ika} \\right) U_2 = 0$$\n$$-\\left( K_{1} + K_{2} e^{ika} \\right) U_1 + \\left( K_{1}+K_{2} - m\\omega^2 \\right) U_2 = 0$$\n\nFor a non-trivial solution, the determinant of the coefficient matrix must be zero. This yields the secular equation:\n$$\\left( K_{1}+K_{2} - m\\omega^2 \\right)^2 - \\left( K_{1} + K_{2} e^{-ika} \\right) \\left( K_{1} + K_{2} e^{ika} \\right) = 0$$\n$$\\left( K_{1}+K_{2} - m\\omega^2 \\right)^2 = K_{1}^2 + K_{2}^2 + 2K_{1}K_{2}\\cos(ka)$$\n\nSolving for $m\\omega^2$ gives the dispersion relation $\\omega(k)$, which has two branches corresponding to acoustic and optical phonons:\n$$\\omega_{\\pm}^2(k) = \\frac{1}{m} \\left( K_{1}+K_{2} \\pm \\sqrt{K_{1}^2 + K_{2}^2 + 2K_{1}K_{2}\\cos(ka)} \\right)$$\nThe '$-$' sign corresponds to the lower-frequency acoustic branch, and the '$+$' sign to the higher-frequency optical branch.\n\nThe band edges are found at the boundaries of the first Brillouin zone, $k=0$ (zone center) and $k=\\pi/a$ (zone edge).\nAt $k=0$, $\\cos(ka)=1$:\n$\\omega_{-}^2(0) = \\frac{1}{m}(K_{1}+K_{2} - \\sqrt{(K_{1}+K_{2})^2}) = 0$.\n$\\omega_{+}^2(0) = \\frac{1}{m}(K_{1}+K_{2} + \\sqrt{(K_{1}+K_{2})^2}) = \\frac{2(K_{1}+K_{2})}{m}$.\n\nAt $k=\\pi/a$, $\\cos(ka)=-1$:\n$\\omega_{-}^2(\\pi/a) = \\frac{1}{m}(K_{1}+K_{2} - \\sqrt{(K_{1}-K_{2})^2}) = \\frac{1}{m}(K_{1}+K_{2} - |K_{1}-K_{2}|) = \\frac{2\\min(K_{1},K_{2})}{m}$.\n$\\omega_{+}^2(\\pi/a) = \\frac{1}{m}(K_{1}+K_{2} + \\sqrt{(K_{1}-K_{2})^2}) = \\frac{1}{m}(K_{1}+K_{2} + |K_{1}-K_{2}|) = \\frac{2\\max(K_{1},K_{2})}{m}$.\n\nThe top of the acoustic branch is $\\omega_{\\mathrm{ac,max}} = \\sqrt{2\\min(K_{1},K_{2})/m}$, and the bottom of the optical branch is $\\omega_{\\mathrm{op,min}} = \\sqrt{2\\max(K_{1},K_{2})/m}$. A phononic band gap exists between these two frequencies if $K_{1} \\neq K_{2}$.\n\nThe design task requires choosing $K_{1}$ and $K_{2}$ to center the band gap at a given frequency $\\omega_{0}$. We interpret \"centering\" in the $\\omega^2$ domain for algebraic simplicity, which corresponds to the arithmetic mean of the squared band-edge frequencies: $\\omega_{0}^2 = \\frac{1}{2}(\\omega_{\\mathrm{ac,max}}^2 + \\omega_{\\mathrm{op,min}}^2) = \\frac{K_{1}+K_{2}}{m}$. With the given ratio $r=K_{1}/K_{2}$, we solve the system of two equations:\n$K_{1}+K_{2} = m\\omega_{0}^2$\n$K_{1}=rK_{2}$\nThis yields the design equations for the spring constants:\n$$K_{2} = \\frac{m\\omega_{0}^2}{r+1}, \\quad K_{1} = \\frac{rm\\omega_{0}^2}{r+1}$$\n\nThe phonon density of states (DOS) per unit cell, $g(\\omega)$, is the number of modes per unit frequency. It is calculated by summing over all wavevectors and phonon branches. Numerically, we sample the irreducible Brillouin zone ($k \\in [0, \\pi/a]$) with $N_k$ points and use Gaussian broadening to approximate the Dirac delta functions:\n$$g(\\omega) = \\frac{1}{N_k}\\sum_{i=1}^{N_k} \\sum_{j \\in \\{-,+\\}} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(\\omega-\\omega_{j}(k_i))^2}{2\\sigma^2}\\right)$$\nThis expression is normalized such that its integral over all frequencies equals $2$, the number of branches per unit cell.\n\nFor frequencies within a band gap, the wavevector $k$ becomes complex, $k=q+i\\kappa$, indicating an evanescent wave. From the dispersion relation, we can solve for $\\cos(ka)$:\n$$\\cos(ka) = \\frac{(m\\omega^2 - K_{1} - K_{2})^2 - K_{1}^2 - K_{2}^2}{2K_{1}K_{2}}$$\nPropagating modes exist only if $|\\cos(ka)| \\le 1$. If $|\\cos(ka)|  1$, the wave is evanescent. The complex nature of $k$ requires $\\sin(qa)=0$, so $q=0$ or $q=\\pi/a$. Since the gap opens at $k=\\pi/a$, we take $q=\\pi/a$, leading to $\\cos(ka) = -\\cosh(\\kappa a)$.\n\nAt the target design frequency $\\omega_0$, where $m\\omega_0^2 = K_1+K_2$, the condition becomes:\n$$-\\cosh(\\kappa_0 a) = \\frac{-(K_1^2+K_2^2)}{2K_1K_2} \\implies \\cosh(\\kappa_0 a) = \\frac{K_1^2+K_2^2}{2K_1K_2} = \\frac{r^2+1}{2r}$$\nUsing the identity $\\mathrm{arccosh}(x) = \\ln(x+\\sqrt{x^2-1})$, we find the elegant result $\\kappa_0 a = |\\ln r|$. The decay constant is $\\kappa_0 = \\frac{|\\ln r|}{a}$.\nThe transmission $T$ through $N$ unit cells is given by $T(\\omega_0) = \\exp(-2\\kappa_{0} N a)$. Substituting $\\kappa_0$ gives:\n$$T(\\omega_0) = \\exp(-2N|\\ln r|)$$\nIf $r=1$, there is no gap, $\\kappa_0 = 0$, and the mode propagates; by definition $T(\\omega_0)=1$.\n\nThe success of the design is evaluated against three criteria:\n1. The target frequency $\\omega_0$ lies strictly within the band gap: $\\omega_{\\mathrm{ac,max}}  \\omega_0  \\omega_{\\mathrm{op,min}}$. This is equivalent to the condition $r \\ne 1$.\n2. The DOS at the target frequency is below a threshold: $g(\\omega_0)  10^{-14}\\,\\mathrm{s}$.\n3. The transmission at the target frequency is below a threshold: $T(\\omega_0)  10^{-5}$.\n\nThe implementation will follow these derived formulas.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the phononic crystal design and verification problem.\n    \"\"\"\n    # Test cases: (omega0, m, a, r, N, sigma)\n    # omega0 in rad/s, m in kg, a in m, r dimensionless, N dimensionless, sigma in rad/s\n    test_cases = [\n        # Case A: Happy path, sizable gap\n        (2 * np.pi * 8.0e12, 2.0e-26, 3.0e-10, 2.0, 50, 5.0e11),\n        # Case B: Boundary case, no gap\n        (2 * np.pi * 5.0e12, 2.0e-26, 3.0e-10, 1.0, 50, 5.0e11),\n        # Case C: Narrow gap\n        (2 * np.pi * 10.0e12, 1.5e-26, 2.5e-10, 1.1, 80, 5.0e11),\n    ]\n\n    results = []\n    \n    # Number of k-points for Brillouin zone sampling\n    N_k = 20000\n\n    for case in test_cases:\n        omega0, m, a, r, N, sigma = case\n\n        # 1. Calculate spring constants K1 and K2 from design specifications\n        # The band gap is centered at omega0^2, meaning omega0^2 = (K1+K2)/m.\n        # The spring constant ratio is r = K1/K2.\n        K2 = m * omega0**2 / (r + 1)\n        K1 = r * K2\n\n        # 2. Determine the band edge frequencies\n        # The band gap opens at the Brillouin zone edge k = pi/a.\n        # omega_ac_max^2 = 2 * min(K1, K2) / m\n        # omega_op_min^2 = 2 * max(K1, K2) / m\n        K_min = min(K1, K2)\n        K_max = max(K1, K2)\n        \n        omega_ac_max = np.sqrt(2 * K_min / m)\n        omega_op_min = np.sqrt(2 * K_max / m)\n\n        # 3. Numerically approximate the phonon density of states g(omega0)\n        # We sample k uniformly over the irreducible Brillouin zone [0, pi/a].\n        k_values = np.linspace(0, np.pi / a, N_k)\n\n        # Dispersion relation: omega^2(k) = (1/m) * (K1+K2 +/- sqrt(K1^2+K2^2+2*K1*K2*cos(ka)))\n        cos_ka = np.cos(k_values * a)\n        # The term under the square root is always non-negative for real k.\n        sqrt_term = np.sqrt(K1**2 + K2**2 + 2 * K1 * K2 * cos_ka)\n        \n        omega_sq_plus = (1 / m) * (K1 + K2 + sqrt_term)\n        omega_sq_minus = (1 / m) * (K1 + K2 - sqrt_term)\n\n        # Handle potential floating point inaccuracies leading to small negative values\n        omega_plus = np.sqrt(np.maximum(0, omega_sq_plus))\n        omega_minus = np.sqrt(np.maximum(0, omega_sq_minus))\n\n        # Approximate DOS using Gaussian broadening\n        # g(w) = (1/Nk) * sum_{k,branch} (1/(sqrt(2pi)*sigma)) * exp(-(w-w_k,branch)^2 / (2*sigma^2))\n        gauss_contrib_plus = np.exp(-((omega0 - omega_plus)**2) / (2 * sigma**2))\n        gauss_contrib_minus = np.exp(-((omega0 - omega_minus)**2) / (2 * sigma**2))\n        \n        g_omega0 = np.sum(gauss_contrib_plus + gauss_contrib_minus) / (N_k * np.sqrt(2 * np.pi) * sigma)\n        \n        # 4. Compute the approximate transmission T(omega0)\n        # If r=1, no band gap exists. omega0 lies on a propagating band.\n        if np.isclose(r, 1.0):\n            T_omega0 = 1.0\n        else:\n            # If r!=1, a gap exists and omega0 is within it. The wave is evanescent.\n            # The decay constant kappa is derived from kappa*a = |ln(r)|.\n            # T = exp(-2 * kappa * N * a) = exp(-2 * N * |ln(r)|).\n            T_omega0 = np.exp(-2 * N * np.abs(np.log(r)))\n\n        # 5. Verify the design against acceptance criteria\n        g_threshold = 1.0e-14\n        T_threshold = 1.0e-5\n        \n        # Criterion 1: omega0 must be strictly inside the band gap.\n        gap_condition = (omega0 > omega_ac_max) and (omega0  omega_op_min)\n        \n        # Criterion 2: DOS at omega0 must be below the threshold.\n        dos_condition = g_omega0  g_threshold\n\n        # Criterion 3: Transmission at omega0 must be below the threshold.\n        transmission_condition = T_omega0  T_threshold\n        \n        success = gap_condition and dos_condition and transmission_condition\n\n        # 6. Collate results into the required format\n        results.append([\n            K1, \n            K2, \n            omega_ac_max, \n            omega_op_min, \n            g_omega0, \n            T_omega0, \n            bool(success)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2847795"}]}