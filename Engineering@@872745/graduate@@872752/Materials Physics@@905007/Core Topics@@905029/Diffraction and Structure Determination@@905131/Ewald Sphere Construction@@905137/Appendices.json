{"hands_on_practices": [{"introduction": "This first exercise provides a direct link between the abstract geometry of the Ewald sphere and the tangible patterns observed in powder X-ray diffraction. By working through this problem, you will derive the relationship between a crystal's lattice structure and the radii of the Debye-Scherrer rings on a flat detector. This practice reinforces the critical distinction between the Bragg angle $\\theta$ and the experimental scattering angle $2\\theta$, while applying crystallographic selection rules to predict a real experimental observable.", "problem": "A monochromatic X-ray beam with wavelength $\\lambda$ illuminates a fine powder of a cubic crystal. The powder is mounted at the origin, and a flat two-dimensional detector is placed perpendicular to the incident beam at a distance $L$ downstream from the sample (transmission geometry). Consider a crystal with a body-centered cubic (BCC) lattice of parameter $a$. The first observable Debye-Scherrer ring on the detector corresponds to the lowest-angle family of allowed lattice planes. Using only the Ewald sphere construction (wavevector magnitudes $|{\\bf k}|=|{\\bf k}'|=2\\pi/\\lambda$, elastic scattering so that ${\\bf k}'-{\\bf k}={\\bf G}_{hkl}$) together with the geometry of a ray intersecting a plane, and without invoking any small-angle approximations, derive the expression for the ring radius $R$ on the detector for a general allowed $\\{hkl\\}$ of a cubic lattice in terms of $\\lambda$, $a$, $L$, and $h,k,l$. Then, applying the body-centered cubic selection rule, identify the lowest-angle allowed family for a BCC lattice and evaluate the corresponding numerical value of $R$ for\n- wavelength $\\lambda=0.500\\,\\text{\\AA}$,\n- lattice parameter $a=2.8665\\,\\text{\\AA}$,\n- detector distance $L=400.0\\,\\text{mm}$.\nRound your final numerical result for the radius to four significant figures and express it in $\\text{mm}$. State only the numerical value of the radius in your final answer.", "solution": "The fundamental starting point is the Ewald sphere construction for elastic scattering of waves with wavevector magnitude $|{\\bf k}|=|{\\bf k}'|=2\\pi/\\lambda$. Diffraction occurs when the scattering vector equals a reciprocal lattice vector, ${\\bf q}={\\bf k}'-{\\bf k}={\\bf G}_{hkl}$. For elastic scattering, the angle between ${\\bf k}$ and ${\\bf k}'$ is $2\\theta$, where $\\theta$ is the Bragg angle. From vector geometry, the magnitude of the difference between two vectors of equal magnitude $k$ separated by angle $2\\theta$ is\n$$\n|{\\bf q}|=\\sqrt{k^{2}+k^{2}-2k^{2}\\cos(2\\theta)}=2k\\sin\\theta.\n$$\nThus,\n$$\n|{\\bf G}_{hkl}|=2k\\sin\\theta=\\frac{4\\pi}{\\lambda}\\sin\\theta.\n$$\nFor a cubic lattice of parameter $a$, the reciprocal lattice is also cubic with parameter $2\\pi/a$, and the magnitude of ${\\bf G}_{hkl}$ is\n$$\n|{\\bf G}_{hkl}|=\\frac{2\\pi}{a}\\sqrt{h^{2}+k^{2}+l^{2}}.\n$$\nEquating the two expressions gives\n$$\n\\frac{2\\pi}{a}\\sqrt{h^{2}+k^{2}+l^{2}}=\\frac{4\\pi}{\\lambda}\\sin\\theta\n\\;\\;\\Longrightarrow\\;\\;\n\\sin\\theta=\\frac{\\lambda}{2a}\\sqrt{h^{2}+k^{2}+l^{2}}.\n$$\nEquivalently, using the interplanar spacing for a cubic crystal,\n$$\nd_{hkl}=\\frac{a}{\\sqrt{h^{2}+k^{2}+l^{2}}},\n$$\none recovers the Bragg relation in the first order,\n$$\n\\sin\\theta=\\frac{\\lambda}{2d_{hkl}}.\n$$\nNext, we relate the scattering angle to the ring radius on a flat detector. The diffracted rays form a cone of half-angle $2\\theta$ around the incident beam axis. A ray at polar angle $2\\theta$ intersects a plane perpendicular to the axis at distance $L$ at a radial distance\n$$\nR=L\\tan(2\\theta).\n$$\nThis relation follows from elementary right-triangle geometry: the axial distance to the plane is $L$ and the transverse offset is $R$, with $\\tan(2\\theta)=R/L$.\n\nCombining the relations yields the general expression for the radius of the ring from the $\\{hkl\\}$ family in a cubic crystal:\n$$\nR_{hkl}=L\\,\\tan\\!\\Big(2\\,\\arcsin\\!\\Big(\\frac{\\lambda}{2a}\\sqrt{h^{2}+k^{2}+l^{2}}\\Big)\\Big).\n$$\n\nFor a body-centered cubic (BCC) lattice, the structure factor imposes the selection rule that reflections occur only when $h+k+l$ is even. The lowest-angle ring corresponds to the smallest nonzero $\\sqrt{h^{2}+k^{2}+l^{2}}$ satisfying $h+k+l$ even. The $(100)$ family has $h^{2}+k^{2}+l^{2}=1$ but $h+k+l=1$ is odd, so it is forbidden. The next is $(110)$ with $h^{2}+k^{2}+l^{2}=2$ and $h+k+l=2$ even, which is allowed. Therefore the first observable ring is from $\\{110\\}$.\n\nWe now evaluate $R_{110}$ numerically using the given parameters $\\lambda=0.500\\,\\text{\\AA}$, $a=2.8665\\,\\text{\\AA}$, and $L=400.0\\,\\text{mm}$.\n\nCompute the argument of the arcsine:\n$$\n\\sin\\theta = \\frac{\\lambda}{2a}\\sqrt{h^{2}+k^{2}+l^{2}}=\\frac{0.500}{2\\times 2.8665}\\sqrt{2}.\n$$\nThis evaluates to:\n$$\n\\sin\\theta = \\frac{0.500}{5.7330}\\sqrt{2} = 0.0872074... \\times 1.41421356... = 0.123328...\n$$\nThus,\n$$\n\\theta=\\arcsin(0.123328\\ldots)\\approx 0.123671\\ldots\\ \\text{rad},\n$$\nso\n$$\n2\\theta\\approx 0.247342\\ldots\\ \\text{rad},\\quad \\tan(2\\theta)\\approx 0.252298\\ldots\n$$\nFinally,\n$$\nR_{110}=L\\tan(2\\theta)=400.0 \\times 0.252298\\ldots=100.919\\ldots\n$$\nRounded to four significant figures and expressed in $\\text{mm}$, the ring radius is $100.9\\,\\text{mm}$.", "answer": "$$\\boxed{100.9}$$", "id": "2820326"}, {"introduction": "The radius of the Ewald sphere is fundamentally tied to the wavelength of the incident radiation. This practice explores a crucial consequence of this relationship in the context of Transmission Electron Microscopy (TEM), where high-energy electrons are used as the probe. You will investigate how special relativity affects the electron's de Broglie wavelength and, consequently, the Ewald sphere's curvature, a correction that is essential for accurate diffraction analysis in modern electron microscopy.", "problem": "An electron beam of kinetic energy $T$ is used to collect diffraction patterns in Transmission Electron Microscopy (TEM). In constructing the Ewald sphere for electron diffraction, one may either use the non-relativistic de Broglie wavelength or a relativistically corrected wavelength. In the crystallographic convention for reciprocal space (reciprocal vectors without the factor $2\\pi$), the Ewald sphere radius is $R = 1/\\lambda$, where $\\lambda$ is the electron de Broglie wavelength.\n\nStarting only from the fundamental relations $p = h/\\lambda$ (de Broglie relation), $T = p^{2}/(2m_{e})$ (non-relativistic kinetic energy), and the special-relativistic energy-momentum relation $(pc)^{2} = E^{2} - (m_{e}c^{2})^{2}$ with $E = T + m_{e}c^{2}$, do the following:\n\n1. Derive an explicit expression for the relativistically corrected wavelength $\\lambda_{\\mathrm{rel}}(T)$ and for the non-relativistic wavelength $\\lambda_{\\mathrm{nr}}(T)$.\n2. Using the crystallographic Ewald sphere radius $R = 1/\\lambda$, express the fractional change in radius due to the relativistic correction as\n$$\n\\delta \\equiv \\frac{R_{\\mathrm{rel}} - R_{\\mathrm{nr}}}{R_{\\mathrm{nr}}}.\n$$\n3. Evaluate $\\delta$ numerically for electrons of kinetic energy $T = 200\\,\\mathrm{keV}$.\n\nReport the final value of $\\delta$ as a dimensionless decimal rounded to four significant figures.\n\nUse the following constants as needed: $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$, $m_{e} = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$, $c = 2.99792458\\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$, $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, and $m_{e}c^{2} = 511\\,\\mathrm{keV}$. Express all intermediate reasoning symbolically; only the final numerical evaluation of $\\delta$ should use numbers. The final answer must be a single number with no units in the box.", "solution": "The first task is to derive expressions for the non-relativistic wavelength, $\\lambda_{\\mathrm{nr}}(T)$, and the relativistically corrected wavelength, $\\lambda_{\\mathrm{rel}}(T)$.\n\nFor the non-relativistic case, the kinetic energy $T$ is related to the momentum $p_{\\mathrm{nr}}$ by $T = \\frac{p_{\\mathrm{nr}}^{2}}{2m_{e}}$. Solving for momentum gives:\n$$p_{\\mathrm{nr}} = \\sqrt{2m_{e}T}$$\nUsing the de Broglie relation, $\\lambda = \\frac{h}{p}$, we find the non-relativistic wavelength:\n$$\\lambda_{\\mathrm{nr}}(T) = \\frac{h}{p_{\\mathrm{nr}}} = \\frac{h}{\\sqrt{2m_{e}T}}$$\n\nFor the relativistic case, we use the energy-momentum relation $(p_{\\mathrm{rel}}c)^{2} = E^{2} - (m_{e}c^{2})^{2}$, where the total energy is $E = T + m_{e}c^{2}$. Substituting the expression for $E$ into the relation gives:\n$$(p_{\\mathrm{rel}}c)^{2} = (T + m_{e}c^{2})^{2} - (m_{e}c^{2})^{2}$$\nExpanding the squared term and simplifying:\n$$(p_{\\mathrm{rel}}c)^{2} = T^{2} + 2Tm_{e}c^{2} + (m_{e}c^{2})^{2} - (m_{e}c^{2})^{2} = T^{2} + 2Tm_{e}c^{2} = T(T + 2m_{e}c^{2})$$\nSolving for the relativistic momentum $p_{\\mathrm{rel}}$:\n$$p_{\\mathrm{rel}} = \\frac{\\sqrt{T(T + 2m_{e}c^{2})}}{c}$$\nThe relativistic wavelength $\\lambda_{\\mathrm{rel}}$ is then given by the de Broglie relation:\n$$\\lambda_{\\mathrm{rel}}(T) = \\frac{h}{p_{\\mathrm{rel}}} = \\frac{hc}{\\sqrt{T(T + 2m_{e}c^{2})}}$$\n\nThe second task is to derive an expression for the fractional change in the Ewald sphere radius, $\\delta$. The definition is given as:\n$$\\delta \\equiv \\frac{R_{\\mathrm{rel}} - R_{\\mathrm{nr}}}{R_{\\mathrm{nr}}}$$\nUsing the relation $R = 1/\\lambda$, we can express $\\delta$ in terms of the wavelengths:\n$$\\delta = \\frac{1/\\lambda_{\\mathrm{rel}} - 1/\\lambda_{\\mathrm{nr}}}{1/\\lambda_{\\mathrm{nr}}} = \\frac{\\lambda_{\\mathrm{nr}}}{\\lambda_{\\mathrm{rel}}} - 1$$\nThe ratio of the wavelengths is equal to the inverse ratio of the corresponding momenta:\n$$\\frac{\\lambda_{\\mathrm{nr}}}{\\lambda_{\\mathrm{rel}}} = \\frac{h/p_{\\mathrm{nr}}}{h/p_{\\mathrm{rel}}} = \\frac{p_{\\mathrm{rel}}}{p_{\\mathrm{nr}}}$$\nSubstituting the derived expressions for $p_{\\mathrm{rel}}$ and $p_{\\mathrm{nr}}$:\n$$\\frac{p_{\\mathrm{rel}}}{p_{\\mathrm{nr}}} = \\frac{\\frac{\\sqrt{T(T + 2m_{e}c^{2})}}{c}}{\\sqrt{2m_{e}T}} = \\frac{1}{c}\\sqrt{\\frac{T(T + 2m_{e}c^{2})}{2m_{e}T}} = \\sqrt{\\frac{T + 2m_{e}c^{2}}{2m_{e}c^{2}}}$$\nSimplifying this expression further:\n$$\\frac{p_{\\mathrm{rel}}}{p_{\\mathrm{nr}}} = \\sqrt{\\frac{T}{2m_{e}c^{2}} + 1}$$\nTherefore, the fractional change $\\delta$ is given by:\n$$\\delta = \\sqrt{1 + \\frac{T}{2m_{e}c^{2}}} - 1$$\n\nThe third task is to evaluate $\\delta$ numerically for an electron kinetic energy of $T = 200\\,\\mathrm{keV}$. We are given the electron rest mass energy $m_{e}c^{2} = 511\\,\\mathrm{keV}$. Substituting these values into our expression for $\\delta$:\n$$\\delta = \\sqrt{1 + \\frac{200\\,\\mathrm{keV}}{2 \\times 511\\,\\mathrm{keV}}} - 1 = \\sqrt{1 + \\frac{100}{511}} - 1$$\nWe perform the numerical calculation:\n$$\\delta = \\sqrt{\\frac{511 + 100}{511}} - 1 = \\sqrt{\\frac{611}{511}} - 1$$\n$$\\delta \\approx \\sqrt{1.195694716} - 1 \\approx 1.093478265 - 1 = 0.093478265$$\nRounding the result to four significant figures as requested:\n$$\\delta \\approx 0.09348$$\nThis result indicates that for a $200\\,\\mathrm{keV}$ electron, the non-relativistic approximation for the Ewald sphere radius is incorrect by approximately $9.35\\%$.", "answer": "$$\\boxed{0.09348}$$", "id": "2820252"}, {"introduction": "This final practice elevates our analysis into the realm of computational materials science, tasking you with simulating a complete Laue diffraction experiment. You will develop an algorithm to predict which Bragg reflections are excited when a polychromatic beam interacts with an oriented single crystal. This exercise synthesizes the concepts of the reciprocal lattice, crystal orientation, and the Ewald construction for a continuous spectrum of wavelengths to build a powerful predictive tool for materials characterization.", "problem": "You are given a primitive cubic crystal with lattice parameter $a$ expressed in $\\text{\\AA}$ (Angstroms), a unit incident-beam direction $\\mathbf{s}_0$ in laboratory coordinates, a crystal orientation given by a $3\\times 3$ rotation matrix $\\mathbf{R}$ that maps crystal-frame vectors to laboratory-frame vectors, and a spectral range $[\\lambda_{\\min},\\lambda_{\\max}]$ in $\\text{\\AA}$ for a polychromatic beam. You must determine which integer Miller indices $(h,k,l)$ within a bounded search set produce Laue back-reflections, and report them as lists $[h,k,l]$.\n\nFundamental base and constraints:\n1. Use elastic kinematic diffraction in the Laue geometry. The incident and diffracted wavevectors satisfy $\\mathbf{k}' - \\mathbf{k}_0 = \\mathbf{G}$ and $\\lvert \\mathbf{k}' \\rvert = \\lvert \\mathbf{k}_0 \\rvert$, where $\\mathbf{k}_0 = \\dfrac{2\\pi}{\\lambda}\\mathbf{s}_0$ and $\\lambda$ is the wavelength.\n2. The reciprocal lattice vector for Miller indices $(h,k,l)$ in the crystal frame is $\\mathbf{G}_{\\text{crystal}} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3$, with $\\mathbf{b}_1 = \\dfrac{2\\pi}{a}\\hat{\\mathbf{x}}$, $\\mathbf{b}_2 = \\dfrac{2\\pi}{a}\\hat{\\mathbf{y}}$, $\\mathbf{b}_3 = \\dfrac{2\\pi}{a}\\hat{\\mathbf{z}}$ for a primitive cubic lattice. The laboratory-frame vector is $\\mathbf{G} = \\mathbf{R}\\mathbf{G}_{\\text{crystal}}$.\n3. Elasticity implies the Ewald-sphere condition $(\\mathbf{k}_0 + \\mathbf{G})\\cdot(\\mathbf{k}_0 + \\mathbf{G}) = \\mathbf{k}_0\\cdot\\mathbf{k}_0$, which yields a scalar equation relating $\\lambda$ and $\\mathbf{G}$. Solving this equation for $\\lambda$ determines whether a given $(h,k,l)$ is excited and what wavelength is required.\n4. Back-reflection is defined by the diffracted beam emerging into the back hemisphere relative to $\\mathbf{s}_0$, i.e., $\\mathbf{s}_0\\cdot \\mathbf{k}' < 0$.\n\nYour program must:\n- Enumerate all integer triples $(h,k,l)$ with $-H \\le h,k,l \\le H$ and $(h,k,l) \\ne (0,0,0)$. For each, compute $\\mathbf{G}$, then the required wavelength $\\lambda$ (if real and positive), and then check if $\\lambda \\in [\\lambda_{\\min},\\lambda_{\\max}]$. If so, compute $\\mathbf{k}' = \\mathbf{k}_0 + \\mathbf{G}$ for that $\\lambda$ and accept $(h,k,l)$ if and only if $\\mathbf{s}_0\\cdot \\mathbf{k}' < 0$.\n- Use the Euclidean inner product in $\\mathbb{R}^3$.\n- Treat all lengths in $\\text{\\AA}$ and angles implicitly through the provided rotation matrices. The incident-beam direction $\\mathbf{s}_0$ must be a unit vector.\n- For numerical robustness, reject any case where $\\mathbf{s}_0\\cdot \\mathbf{G}$ is zero within a tolerance of $10^{-12}$, as no finite $\\lambda$ satisfies the Ewald condition in that limit. Also, treat the back-reflection check $\\mathbf{s}_0\\cdot \\mathbf{k}' < 0$ with a strict inequality and a tolerance of $10^{-12}$.\n\nStarting point for the derivation you must implement:\n- Elastic scattering with $\\mathbf{k}'-\\mathbf{k}_0=\\mathbf{G}$ and $\\lvert \\mathbf{k}'\\rvert = \\lvert \\mathbf{k}_0\\rvert$.\n- The reciprocal-space definition for a primitive cubic lattice.\n\nRequired algorithmic steps to implement for each $(h,k,l)$:\n- Compute $\\mathbf{G} = \\mathbf{R}\\left(\\dfrac{2\\pi}{a}[h,k,l]^T\\right)$.\n- Solve the Ewald condition for $\\lambda$ implied by $(\\mathbf{k}_0+\\mathbf{G})^2=\\mathbf{k}_0^2$ and $\\mathbf{k}_0=\\dfrac{2\\pi}{\\lambda}\\mathbf{s}_0$, yielding a unique $\\lambda$ if $\\mathbf{s}_0\\cdot \\mathbf{G} \\ne 0$.\n- Check $\\lambda \\in [\\lambda_{\\min},\\lambda_{\\max}]$, then compute $\\mathbf{k}'$ and verify $\\mathbf{s}_0\\cdot \\mathbf{k}' < 0$.\n\nReport format:\n- For each test case, output the accepted $(h,k,l)$ as a list of integer triplets $[h,k,l]$, sorted in ascending lexicographic order by $(h,k,l)$.\n- The final output must be a single line containing a list with one element per test case, in the exact format: a comma-separated list enclosed in square brackets, with each test case result itself being a list of $[h,k,l]$ items (e.g., `[[[h1,k1,l1],[h2,k2,l2]],[],[[...]],...]`).\n\nUse the following test suite. The unit for $a$, $\\lambda_{\\min}$, and $\\lambda_{\\max}$ is $\\text{\\AA}$. The incident direction is $\\mathbf{s}_0=[0,0,1]^T$ for all cases. The search bound is $H$ as listed.\n\n- Test case 1 (general case):\n  - $a = 3.6$\n  - $\\mathbf{R} = \\begin{bmatrix}1&0&0\\\\0&1&0\\\\0&0&1\\end{bmatrix}$\n  - $[\\lambda_{\\min},\\lambda_{\\max}] = [0.5, 2.5]$\n  - $H = 3$\n- Test case 2 (tilted crystal):\n  - $a = 3.6$\n  - $\\mathbf{R} = \\begin{bmatrix}1&0&0\\\\0&\\cos\\theta&-\\sin\\theta\\\\0&\\sin\\theta&\\cos\\theta\\end{bmatrix}$ with $\\theta = 35^\\circ$ represented numerically by $\\cos\\theta \\approx 0.8191520442889918$ and $\\sin\\theta \\approx 0.5735764363510462$\n  - $[\\lambda_{\\min},\\lambda_{\\max}] = [0.8, 2.2]$\n  - $H = 3$\n- Test case 3 (narrow spectrum, likely no solutions):\n  - $a = 3.6$\n  - $\\mathbf{R} = \\begin{bmatrix}\\cos\\phi&0&\\sin\\phi\\\\0&1&0\\\\-\\sin\\phi&0&\\cos\\phi\\end{bmatrix}$ with $\\phi = 60^\\circ$ represented numerically by $\\cos\\phi = 0.5$ and $\\sin\\phi \\approx 0.8660254037844386$\n  - $[\\lambda_{\\min},\\lambda_{\\max}] = [0.5, 0.6]$\n  - $H = 3$\n- Test case 4 (boundary wavelength exactly equal to the required value for some reflections):\n  - $a = 3.6$\n  - $\\mathbf{R} = \\begin{bmatrix}1&0&0\\\\0&1&0\\\\0&0&1\\end{bmatrix}$\n  - $[\\lambda_{\\min},\\lambda_{\\max}] = [2.4, 2.4]$\n  - $H = 3$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a list of $[h,k,l]$ triplets in lexicographic order. Angles are implicit in the numerical rotation matrices; no angle unit is required for input. All physical quantities must be handled in $\\text{\\AA}$, and the program must not require any user interaction.", "solution": "The problem requires us to identify which reciprocal lattice points, indexed by Miller indices $(h,k,l)$, produce a Laue back-reflection for a given crystal structure, orientation, and polychromatic X-ray source. The physical basis is the von Laue condition for constructive interference and the conservation of energy in elastic scattering.\n\nThe fundamental equation of diffraction is the Laue condition, which states that the change in the wavevector of the scattered wave must equal a reciprocal lattice vector $\\mathbf{G}$:\n$$ \\mathbf{k}' - \\mathbf{k}_0 = \\mathbf{G} $$\nHere, $\\mathbf{k}_0$ is the incident wavevector and $\\mathbf{k}'$ is the diffracted wavevector. For elastic scattering, the energy of the photon is conserved, which implies its wavelength $\\lambda$ and thus the magnitude of its wavevector remains unchanged:\n$$ |\\mathbf{k}'| = |\\mathbf{k}_0| = \\frac{2\\pi}{\\lambda} $$\nSubstituting $\\mathbf{k}' = \\mathbf{k}_0 + \\mathbf{G}$ into the elastic scattering condition yields the Ewald sphere equation:\n$$ (\\mathbf{k}_0 + \\mathbf{G}) \\cdot (\\mathbf{k}_0 + \\mathbf{G}) = \\mathbf{k}_0 \\cdot \\mathbf{k}_0 $$\nExpanding the dot product, we find:\n$$ |\\mathbf{k}_0|^2 + 2\\mathbf{k}_0 \\cdot \\mathbf{G} + |\\mathbf{G}|^2 = |\\mathbf{k}_0|^2 $$\nThis simplifies to a condition on $\\mathbf{k}_0$ and $\\mathbf{G}$:\n$$ 2\\mathbf{k}_0 \\cdot \\mathbf{G} + |\\mathbf{G}|^2 = 0 $$\nThe incident wavevector $\\mathbf{k}_0$ is defined by its direction, given by the unit vector $\\mathbf{s}_0$, and its wavelength $\\lambda$: $\\mathbf{k}_0 = \\frac{2\\pi}{\\lambda}\\mathbf{s}_0$. Substituting this into the Ewald sphere equation allows us to solve for the specific wavelength $\\lambda$ that will excite a diffraction spot for a given reciprocal lattice vector $\\mathbf{G}$:\n$$ 2\\left(\\frac{2\\pi}{\\lambda}\\mathbf{s}_0\\right) \\cdot \\mathbf{G} + |\\mathbf{G}|^2 = 0 $$\n$$ \\frac{4\\pi}{\\lambda}(\\mathbf{s}_0 \\cdot \\mathbf{G}) = -|\\mathbf{G}|^2 $$\nSolving for $\\lambda$ yields:\n$$ \\lambda = -\\frac{4\\pi(\\mathbf{s}_0 \\cdot \\mathbf{G})}{|\\mathbf{G}|^2} $$\nFor a physically meaningful solution, the wavelength $\\lambda$ must be real and positive. Since $|\\mathbf{G}|^2$ is always non-negative (and strictly positive for $(h,k,l) \\neq (0,0,0)$), this implies that we must have $\\mathbf{s}_0 \\cdot \\mathbf{G} < 0$. The problem also requires us to reject cases where $\\mathbf{s}_0 \\cdot \\mathbf{G}$ is numerically close to zero, specifically $|\\mathbf{s}_0 \\cdot \\mathbf{G}| \\le 10^{-12}$, which avoids division by a small number.\n\nThe reciprocal lattice vector $\\mathbf{G}$ depends on the Miller indices $(h,k,l)$, the crystal structure, and its orientation. For the given primitive cubic lattice with lattice parameter $a$, the basis vectors of the reciprocal lattice in the crystal frame are $\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$, $\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$, and $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$. The reciprocal lattice vector for indices $(h,k,l)$ in the crystal frame is:\n$$ \\mathbf{G}_{\\text{crystal}} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3 = \\frac{2\\pi}{a} \\begin{pmatrix} h \\\\ k \\\\ l \\end{pmatrix} $$\nTo find the vector in the laboratory frame, we apply the provided rotation matrix $\\mathbf{R}$:\n$$ \\mathbf{G} = \\mathbf{R} \\mathbf{G}_{\\text{crystal}} = \\frac{2\\pi}{a} \\mathbf{R} \\begin{pmatrix} h \\\\ k \\\\ l \\end{pmatrix} $$\nThe magnitude squared of $\\mathbf{G}$ is $|\\mathbf{G}|^2 = \\mathbf{G} \\cdot \\mathbf{G}$. Since $\\mathbf{R}$ is a rotation matrix, it is orthogonal ($\\mathbf{R}^T\\mathbf{R} = \\mathbf{I}$), so it preserves vector lengths. Thus, $|\\mathbf{G}|^2 = |\\mathbf{G}_{\\text{crystal}}|^2 = (\\frac{2\\pi}{a})^2(h^2+k^2+l^2)$.\n\nThe final condition is for back-reflection. The diffracted beam must emerge into the hemisphere opposite to the incident beam direction $\\mathbf{s}_0$. Mathematically, this is expressed as:\n$$ \\mathbf{s}_0 \\cdot \\mathbf{k}' < 0 $$\nUsing $\\mathbf{k}' = \\mathbf{k}_0 + \\mathbf{G} = \\frac{2\\pi}{\\lambda}\\mathbf{s}_0 + \\mathbf{G}$ and the fact that $\\mathbf{s}_0$ is a unit vector ($|\\mathbf{s}_0|=1$), the condition becomes:\n$$ \\mathbf{s}_0 \\cdot \\left(\\frac{2\\pi}{\\lambda}\\mathbf{s}_0 + \\mathbf{G}\\right) = \\frac{2\\pi}{\\lambda}(\\mathbf{s}_0 \\cdot \\mathbf{s}_0) + \\mathbf{s}_0 \\cdot \\mathbf{G} = \\frac{2\\pi}{\\lambda} + \\mathbf{s}_0 \\cdot \\mathbf{G} < 0 $$\nThis inequality must be checked with a numerical tolerance of $10^{-12}$, i.e., $\\frac{2\\pi}{\\lambda} + \\mathbf{s}_0 \\cdot \\mathbf{G} < -10^{-12}$.\n\nThe complete algorithm for each test case is as follows:\n1. Initialize an empty list for valid Miller indices.\n2. Iterate through all integer triplets $(h,k,l)$ where $h,k,l \\in [-H, H]$, excluding the trivial case $(0,0,0)$.\n3. For each triplet $(h,k,l)$, construct the vector $\\mathbf{g}_{hkl} = [h,k,l]^T$.\n4. Compute the reciprocal lattice vector in the laboratory frame: $\\mathbf{G} = \\frac{2\\pi}{a} \\mathbf{R}\\mathbf{g}_{hkl}$.\n5. Calculate the dot product $S_G = \\mathbf{s}_0 \\cdot \\mathbf{G}$.\n6. Verify that $|S_G| > 10^{-12}$. If not, this triplet is rejected.\n7. Calculate the squared magnitude $G2 = \\mathbf{G} \\cdot \\mathbf{G}$.\n8. Calculate the required wavelength $\\lambda = -4\\pi S_G / G2$.\n9. Check if this wavelength is within the specified spectral range: $\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]$. Note that the condition $S_G < 0$ is implicitly required for $\\lambda$ to be positive.\n10. If the wavelength is in range, check the back-reflection condition: $\\frac{2\\pi}{\\lambda} + S_G < -10^{-12}$.\n11. If all conditions are satisfied, the triplet $(h,k,l)$ is a valid back-reflection and is added to the list.\n12. After checking all triplets, sort the list of valid indices in lexicographical order.\nThis procedure is applied to each test case to generate the final result.", "answer": "```python\nimport numpy as np\n\ndef list_to_string_no_spaces(data):\n    \"\"\"\n    Recursively converts a list to a string representation without spaces,\n    as implicitly required by the problem's output format example.\n    \"\"\"\n    if isinstance(data, list):\n        return f\"[{','.join([list_to_string_no_spaces(x) for x in data])}]\"\n    return str(data)\n\ndef find_reflections(a, R, lambda_min, lambda_max, H, s0):\n    \"\"\"\n    Finds Miller indices (h,k,l) that produce Laue back-reflections.\n\n    Args:\n        a (float): Lattice parameter in Angstroms.\n        R (np.ndarray): 3x3 rotation matrix.\n        lambda_min (float): Minimum wavelength in Angstroms.\n        lambda_max (float): Maximum wavelength in Angstroms.\n        H (int): Search bound for Miller indices.\n        s0 (np.ndarray): Unit vector for incident beam direction.\n\n    Returns:\n        list: A sorted list of [h,k,l] triplets that satisfy the conditions.\n    \"\"\"\n    valid_hkl = []\n    tol = 1e-12\n\n    # Iterate through all Miller indices within the search bound H\n    for h in range(-H, H + 1):\n        for k in range(-H, H + 1):\n            for l in range(-H, H + 1):\n                # Exclude the (0,0,0) reflection\n                if h == 0 and k == 0 and l == 0:\n                    continue\n\n                g_crystal = np.array([h, k, l], dtype=np.float64)\n\n                # 1. Compute reciprocal lattice vector G in the lab frame\n                G = (2 * np.pi / a) * (R @ g_crystal)\n\n                # 2. Compute the dot product s0 . G\n                s0_dot_G = np.dot(s0, G)\n\n                # 3. Apply numerical stability check\n                if abs(s0_dot_G) = tol:\n                    continue\n\n                # 4. Compute G squared\n                G_squared = np.dot(G, G)\n\n                # 5. Solve for wavelength lambda\n                lamb = -4 * np.pi * s0_dot_G / G_squared\n                \n                # 6. Check if lambda is within the specified spectral range.\n                # A positive lambda implies s0_dot_G must be negative.\n                if not (lambda_min = lamb = lambda_max):\n                    continue\n                \n                # 7. Check the back-reflection condition\n                s0_dot_k_prime = (2 * np.pi / lamb) + s0_dot_G\n                if s0_dot_k_prime  -tol:\n                    valid_hkl.append([h, k, l])\n\n    # 8. Sort the results lexicographically\n    valid_hkl.sort()\n    return valid_hkl\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    s0 = np.array([0, 0, 1], dtype=np.float64)\n    \n    # Define test cases from the problem statement\n    test_cases = [\n        {\n            \"a\": 3.6,\n            \"R\": np.identity(3, dtype=np.float64),\n            \"lambda_range\": [0.5, 2.5],\n            \"H\": 3\n        },\n        {\n            \"a\": 3.6,\n            \"R\": np.array([\n                [1, 0, 0],\n                [0, 0.8191520442889918, -0.5735764363510462],\n                [0, 0.5735764363510462, 0.8191520442889918]\n            ], dtype=np.float64),\n            \"lambda_range\": [0.8, 2.2],\n            \"H\": 3\n        },\n        {\n            \"a\": 3.6,\n            \"R\": np.array([\n                [0.5, 0, 0.8660254037844386],\n                [0, 1, 0],\n                [-0.8660254037844386, 0, 0.5]\n            ], dtype=np.float64),\n            \"lambda_range\": [0.5, 0.6],\n            \"H\": 3\n        },\n        {\n            \"a\": 3.6,\n            \"R\": np.identity(3, dtype=np.float64),\n            \"lambda_range\": [2.4, 2.4],\n            \"H\": 3\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_reflections(\n            case[\"a\"],\n            case[\"R\"],\n            case[\"lambda_range\"][0],\n            case[\"lambda_range\"][1],\n            case[\"H\"],\n            s0\n        )\n        results.append(result)\n\n    # Format the final output string to remove spaces inside lists\n    final_output_string = list_to_string_no_spaces(results)\n    print(final_output_string)\n\nsolve()\n```", "id": "2820258"}]}