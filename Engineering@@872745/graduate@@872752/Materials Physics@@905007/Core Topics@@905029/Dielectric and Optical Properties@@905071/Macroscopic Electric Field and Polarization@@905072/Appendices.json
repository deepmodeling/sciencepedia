{"hands_on_practices": [{"introduction": "Understanding how a material's internal polarization gives rise to macroscopic charge distributions is a cornerstone of dielectric physics. This exercise provides direct practice in calculating these 'bound' charges from a given, non-uniform polarization field $\\mathbf{P}$ [@problem_id:147528]. By applying the fundamental definitions $\\rho_b = -\\nabla \\cdot \\mathbf{P}$ and $\\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{n}}$, you will translate an abstract vector field into tangible charge densities, reinforcing your skills in vector calculus and clarifying the physical origins of the dielectric response.", "problem": "In macroscopic electrodynamics, the response of a dielectric material to an electric field is described by the polarization vector $\\mathbf{P}$, which represents the dipole moment per unit volume. This polarization can result in an effective accumulation of charge, known as bound charge. These bound charges are not free to move through the material but are tied to the atoms or molecules. The volume density of bound charge is given by $\\rho_b = -\\nabla \\cdot \\mathbf{P}$, and the surface density of bound charge is given by $\\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{n}}$, where $\\hat{\\mathbf{n}}$ is the outward-pointing unit normal vector to the surface of the dielectric.\n\nConsider a solid dielectric cylinder of radius $a$ and height $h$. The cylinder is oriented with its axis along the $z$-axis, and its geometric center is at the origin, such that its top surface is at $z = h/2$ and its bottom surface is at $z = -h/2$. The material has a permanent \"frozen-in\" polarization given in cylindrical coordinates $(s, \\phi, z)$ by:\n$$\n\\mathbf{P}(s, \\phi, z) = P_0 \\left(\\frac{s}{a}\\right) \\hat{\\mathbf{s}} + P_1 \\left(\\frac{z}{h}\\right) \\hat{\\mathbf{z}}\n$$\nwhere $P_0$ and $P_1$ are positive constants with units of polarization (charge per unit area), $\\hat{\\mathbf{s}}$ is the radial unit vector, and $\\hat{\\mathbf{z}}$ is the axial unit vector.\n\nCalculate the total bound charge, $Q_b^{\\text{surf}}$, residing on the entire surface of the cylinder.", "solution": "The total bound charge on the surface, $ Q_b^{\\text{surf}} $, is found by integrating the surface bound charge density $ \\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{n}} $ over the entire surface of the cylinder. The cylinder has three surfaces: top, bottom, and lateral.\n\nThe polarization vector is given by:\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( \\frac{z}{h} \\right) \\hat{\\mathbf{z}}\n$$\n\n\n### Top surface ($ z = h/2 $, $ \\hat{\\mathbf{n}} = \\hat{\\mathbf{z}} $):\nAt $ z = h/2 $,\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( \\frac{1}{2} \\right) \\hat{\\mathbf{z}}\n$$\n\n\n$$\n\\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{z}} = P_1 \\left( \\frac{1}{2} \\right) = \\frac{P_1}{2}\n$$\n\nThe area of the top surface is $ \\pi a^2 $, so:\n\n$$\nQ_b^{\\text{top}} = \\int \\sigma_b  dA = \\frac{P_1}{2} \\cdot \\pi a^2 = \\frac{\\pi a^2 P_1}{2}\n$$\n\n\n### Bottom surface ($ z = -h/2 $, $ \\hat{\\mathbf{n}} = -\\hat{\\mathbf{z}} $):\nAt $ z = -h/2 $,\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( -\\frac{1}{2} \\right) \\hat{\\mathbf{z}} = P_0 \\left( \\frac{s}{a} \\right) \\hat{\\mathbf{s}} - \\frac{P_1}{2} \\hat{\\mathbf{z}}\n$$\n\n\n$$\n\\sigma_b = \\mathbf{P} \\cdot (-\\hat{\\mathbf{z}}) = -\\left( -\\frac{P_1}{2} \\right) = \\frac{P_1}{2}\n$$\n\nThe area of the bottom surface is $ \\pi a^2 $, so:\n\n$$\nQ_b^{\\text{bottom}} = \\frac{P_1}{2} \\cdot \\pi a^2 = \\frac{\\pi a^2 P_1}{2}\n$$\n\n\n### Lateral surface ($ s = a $, $ \\hat{\\mathbf{n}} = \\hat{\\mathbf{s}} $):\nAt $ s = a $,\n\n$$\n\\mathbf{P} = P_0 \\left( \\frac{a}{a} \\right) \\hat{\\mathbf{s}} + P_1 \\left( \\frac{z}{h} \\right) \\hat{\\mathbf{z}} = P_0 \\hat{\\mathbf{s}} + P_1 \\left( \\frac{z}{h} \\right) \\hat{\\mathbf{z}}\n$$\n\n\n$$\n\\sigma_b = \\mathbf{P} \\cdot \\hat{\\mathbf{s}} = P_0\n$$\n\nThe area of the lateral surface is $ 2\\pi a h $, so:\n\n$$\nQ_b^{\\text{lateral}} = P_0 \\cdot 2\\pi a h = 2\\pi a h P_0\n$$\n\n\n### Total surface bound charge:\n\n$$\nQ_b^{\\text{surf}} = Q_b^{\\text{top}} + Q_b^{\\text{bottom}} + Q_b^{\\text{lateral}} = \\frac{\\pi a^2 P_1}{2} + \\frac{\\pi a^2 P_1}{2} + 2\\pi a h P_0 = \\pi a^2 P_1 + 2\\pi a h P_0\n$$\n\n\nAs a verification, the volume bound charge density is $ \\rho_b = -\\nabla \\cdot \\mathbf{P} $. In cylindrical coordinates:\n\n$$\n\\nabla \\cdot \\mathbf{P} = \\frac{1}{s} \\frac{\\partial}{\\partial s} \\left( s P_s \\right) + \\frac{\\partial P_z}{\\partial z} = \\frac{1}{s} \\frac{\\partial}{\\partial s} \\left( s \\cdot P_0 \\frac{s}{a} \\right) + \\frac{\\partial}{\\partial z} \\left( P_1 \\frac{z}{h} \\right) = \\frac{1}{s} \\frac{\\partial}{\\partial s} \\left( \\frac{P_0}{a} s^2 \\right) + P_1 \\frac{1}{h}\n$$\n\n\n$$\n= \\frac{1}{s} \\cdot \\frac{2 P_0}{a} s + \\frac{P_1}{h} = \\frac{2 P_0}{a} + \\frac{P_1}{h}\n$$\n\n\n$$\n\\rho_b = -\\left( \\frac{2 P_0}{a} + \\frac{P_1}{h} \\right)\n$$\n\nThe total volume bound charge is:\n\n$$\nQ_b^{\\text{vol}} = \\int \\rho_b  dV = -\\left( \\frac{2 P_0}{a} + \\frac{P_1}{h} \\right) \\int_0^{2\\pi} d\\phi \\int_0^a s  ds \\int_{-h/2}^{h/2} dz = -\\left( \\frac{2 P_0}{a} + \\frac{P_1}{h} \\right) (2\\pi) \\left( \\frac{a^2}{2} \\right) (h) = -2\\pi a h P_0 - \\pi a^2 P_1\n$$\n\nThe total bound charge (surface plus volume) is:\n\n$$\nQ_b^{\\text{total}} = Q_b^{\\text{surf}} + Q_b^{\\text{vol}} = (\\pi a^2 P_1 + 2\\pi a h P_0) + (-2\\pi a h P_0 - \\pi a^2 P_1) = 0\n$$\n\nThis confirms that the dielectric is neutral, supporting the surface charge calculation.", "answer": "$$ \\boxed{2\\pi a h P_0 + \\pi a^2 P_1} $$", "id": "147528"}, {"introduction": "In most practical scenarios, polarization is not a fixed property but is induced by an external electric field. This classic problem challenges you to determine this induced response for a dielectric sphere placed in a uniform field $\\mathbf{E}_0$ [@problem_id:2838411]. By solving Laplace's equation and applying the appropriate boundary conditions at the dielectric interface, you will derive the internal and external fields and discover how the object acquires a macroscopic dipole moment, a foundational concept for understanding polarizability and screening.", "problem": "A solid, homogeneous, isotropic, linear dielectric sphere of radius $R$ and permittivity $\\varepsilon$ is embedded in vacuum of permittivity $\\varepsilon_{0}$. The system is static, with no free charge anywhere in space except in remote sources that establish a uniform macroscopic electric field $\\mathbf{E}_{0}$ in the absence of the sphere. The uniform field is directed along the $\\hat{\\mathbf{z}}$ axis, so that $\\mathbf{E}_{0} = E_{0}\\,\\hat{\\mathbf{z}}$ with $E_{0}$ a positive scalar.\n\nStarting from the macroscopic Maxwell equations, the constitutive relation $\\mathbf{D} = \\varepsilon \\mathbf{E}$ inside the sphere and $\\mathbf{D} = \\varepsilon_{0} \\mathbf{E}$ outside the sphere, and the definition of the macroscopic polarization $\\mathbf{P} = \\mathbf{D} - \\varepsilon_{0}\\mathbf{E}$, derive the macroscopic scalar potential and the macroscopic electric field inside the sphere ($rR$) and outside the sphere ($rR$). Use only boundary conditions that follow from the macroscopic Maxwell equations at the dielectric–vacuum interface and require that the potentials be finite at $r=0$ and vanish appropriately as $r\\to\\infty$ up to the background field. Then compute the induced macroscopic dipole moment vector of the sphere.\n\nReport only the induced dipole moment vector as a single closed-form analytic expression in terms of $\\varepsilon$, $\\varepsilon_{0}$, $R$, and $\\mathbf{E}_{0}$. No numerical evaluation is required. Express the answer as a vector and do not include units in the final reported expression.", "solution": "The problem as stated is valid. It is a standard, well-posed problem in electrostatics that is scientifically grounded and self-contained. The solution will be derived from first principles as requested.\n\nIn a static regime with no free charge density, the macroscopic Maxwell equations are $\\nabla \\cdot \\mathbf{D} = 0$ and $\\nabla \\times \\mathbf{E} = \\mathbf{0}$. The second equation implies the existence of a scalar potential $\\Phi$ such that the electric field is given by its negative gradient, $\\mathbf{E} = -\\nabla \\Phi$. Substituting this into the first equation along with the linear constitutive relation $\\mathbf{D} = \\epsilon \\mathbf{E}$ (where $\\epsilon$ is the permittivity of the medium), we obtain $\\nabla \\cdot (\\epsilon \\mathbf{E}) = \\nabla \\cdot (-\\epsilon \\nabla \\Phi) = 0$. For a homogeneous medium, where $\\epsilon$ is constant, this simplifies to Laplace's equation, $\\nabla^2 \\Phi = 0$.\n\nWe must solve Laplace's equation for the potential in two regions: inside the sphere ($r  R$) and outside the sphere ($r  R$). Let the potentials be $\\Phi_{in}$ and $\\Phi_{out}$, respectively.\n\nThe problem possesses azimuthal symmetry due to the uniform external field $\\mathbf{E}_0 = E_0 \\hat{\\mathbf{z}}$. The general solution to Laplace's equation in spherical coordinates $(r, \\theta, \\phi)$ with azimuthal symmetry is a superposition of Legendre polynomials $P_l(\\cos\\theta)$:\n$$ \\Phi(r, \\theta) = \\sum_{l=0}^{\\infty} \\left( A_l r^l + B_l r^{-(l+1)} \\right) P_l(\\cos\\theta) $$\n\nFor the region inside the sphere ($r  R$), the potential $\\Phi_{in}$ must remain finite at the origin ($r=0$). This requires that all coefficients of the terms singular at the origin, $B_l$, must be zero. Thus, the interior potential has the form:\n$$ \\Phi_{in}(r, \\theta) = \\sum_{l=0}^{\\infty} A_l r^l P_l(\\cos\\theta) $$\n\nFor the region outside the sphere ($r  R$), the potential $\\Phi_{out}$ must approach the potential of the uniform external field as $r \\to \\infty$. The potential corresponding to $\\mathbf{E}_0 = E_0 \\hat{\\mathbf{z}}$ is $\\Phi_0 = -E_0 z = -E_0 r \\cos\\theta = -E_0 r P_1(\\cos\\theta)$. Therefore, as $r \\to \\infty$, $\\Phi_{out}$ must behave as $-E_0 r P_1(\\cos\\theta)$. This condition dictates that all coefficients $A_l$ for $l \\neq 1$ must be zero, and $A_1 = -E_0$. The general form for the exterior potential is thus:\n$$ \\Phi_{out}(r, \\theta) = -E_0 r P_1(\\cos\\theta) + \\sum_{l=0}^{\\infty} B_l r^{-(l+1)} P_l(\\cos\\theta) $$\n\nThe coefficients $A_l$ and $B_l$ are determined by the boundary conditions at the dielectric interface $r=R$.\n1.  Continuity of the potential: $\\Phi_{in}(R, \\theta) = \\Phi_{out}(R, \\theta)$.\n2.  Continuity of the normal component of the electric displacement field $\\mathbf{D}$: $D_{in, \\perp} = D_{out, \\perp}$. Since $\\mathbf{D} = -\\epsilon \\nabla \\Phi$, and the normal direction is $\\hat{\\mathbf{r}}$, this condition becomes $\\varepsilon \\frac{\\partial \\Phi_{in}}{\\partial r}\\bigg|_{r=R} = \\varepsilon_0 \\frac{\\partial \\Phi_{out}}{\\partial r}\\bigg|_{r=R}$.\n\nApplying the first boundary condition at $r=R$:\n$$ \\sum_{l=0}^{\\infty} A_l R^l P_l(\\cos\\theta) = -E_0 R P_1(\\cos\\theta) + \\sum_{l=0}^{\\infty} B_l R^{-(l+1)} P_l(\\cos\\theta) $$\nDue to the orthogonality of the Legendre polynomials, we can equate the coefficients for each value of $l$:\nFor $l=1$: $A_1 R = -E_0 R + B_1 R^{-2}$.\nFor $l \\neq 1$: $A_l R^l = B_l R^{-(l+1)}$.\n\nApplying the second boundary condition at $r=R$:\n$$ \\varepsilon \\sum_{l=0}^{\\infty} A_l l R^{l-1} P_l(\\cos\\theta) = \\varepsilon_0 \\left( -E_0 P_1(\\cos\\theta) - \\sum_{l=0}^{\\infty} B_l (l+1) R^{-(l+2)} P_l(\\cos\\theta) \\right) $$\nEquating coefficients for each $l$:\nFor $l=1$: $\\varepsilon (A_1) = \\varepsilon_0 (-E_0 - 2 B_1 R^{-3})$.\nFor $l \\neq 1$: $\\varepsilon A_l l R^{l-1} = -\\varepsilon_0 B_l (l+1) R^{-(l+2)}$.\n\nLet us solve the system for $l \\neq 1$. From the first boundary condition, $B_l = A_l R^{2l+1}$. Substituting this into the second condition:\n$$ \\varepsilon A_l l R^{l-1} = -\\varepsilon_0 (A_l R^{2l+1}) (l+1) R^{-(l+2)} $$\n$$ \\varepsilon A_l l R^{l-1} = -\\varepsilon_0 A_l (l+1) R^{l-1} $$\n$$ A_l (\\varepsilon l + \\varepsilon_0 (l+1)) = 0 $$\nSince $\\varepsilon  0$, $\\varepsilon_0  0$, and for $l \\ge 0$, the term $(\\varepsilon l + \\varepsilon_0 (l+1))$ is strictly positive. Therefore, we must have $A_l=0$ for all $l \\neq 1$. This implies $B_l=0$ for all $l \\neq 1$ as well. The only nonzero coefficients are $A_1$ and $B_1$.\n\nNow we solve the system for $l=1$:\n(i) $A_1 R = -E_0 R + B_1 R^{-2} \\implies A_1 = -E_0 + B_1 R^{-3}$\n(ii) $\\varepsilon A_1 = -\\varepsilon_0 E_0 - 2\\varepsilon_0 B_1 R^{-3}$\nSubstitute $A_1$ from (i) into (ii):\n$$ \\varepsilon(-E_0 + B_1 R^{-3}) = -\\varepsilon_0 E_0 - 2\\varepsilon_0 B_1 R^{-3} $$\n$$ -\\varepsilon E_0 + \\varepsilon B_1 R^{-3} = -\\varepsilon_0 E_0 - 2\\varepsilon_0 B_1 R^{-3} $$\n$$ B_1 R^{-3}(\\varepsilon + 2\\varepsilon_0) = E_0(\\varepsilon - \\varepsilon_0) $$\n$$ B_1 = R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} $$\nWith $B_1$, we can find $A_1$:\n$$ A_1 = -E_0 + \\left( R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) R^{-3} = E_0 \\left( -1 + \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) = E_0 \\frac{-(\\varepsilon + 2\\varepsilon_0) + (\\varepsilon - \\varepsilon_0)}{\\varepsilon + 2\\varepsilon_0} = -\\frac{3\\varepsilon_0 E_0}{\\varepsilon + 2\\varepsilon_0} $$\nThe potentials are thus fully determined. The potential outside the sphere is:\n$$ \\Phi_{out}(r, \\theta) = -E_0 r \\cos\\theta + \\left( R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) \\frac{\\cos\\theta}{r^2} $$\nThe potential outside is a superposition of the potential of the uniform external field and the potential generated by the polarized sphere. The second term is the potential of an ideal electric dipole located at the origin. The potential of a dipole $\\mathbf{p}$ is given by $\\Phi_{dipole}(r, \\theta) = \\frac{\\mathbf{p} \\cdot \\hat{\\mathbf{r}}}{4 \\pi \\varepsilon_0 r^2}$. For a dipole $\\mathbf{p} = p \\hat{\\mathbf{z}}$, this becomes $\\Phi_{dipole} = \\frac{p \\cos\\theta}{4 \\pi \\varepsilon_0 r^2}$.\n\nComparing this form with the second term in $\\Phi_{out}$:\n$$ \\frac{p \\cos\\theta}{4 \\pi \\varepsilon_0 r^2} = \\left( R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) \\frac{\\cos\\theta}{r^2} $$\nFrom this, we identify the magnitude of the induced dipole moment $p$:\n$$ p = 4 \\pi \\varepsilon_0 R^3 E_0 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} $$\nThe orientation of the dipole is along the $\\hat{\\mathbf{z}}$ axis, parallel to the external field $\\mathbf{E}_0$. Thus, the induced dipole moment vector $\\mathbf{p}$ can be written as:\n$$ \\mathbf{p} = \\left( 4 \\pi \\varepsilon_0 R^3 \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) E_0\\hat{\\mathbf{z}} $$\nRecognizing that $\\mathbf{E}_0 = E_0\\hat{\\mathbf{z}}$, we express the final answer in terms of the given vector $\\mathbf{E}_0$.\n$$ \\mathbf{p} = 4 \\pi \\varepsilon_0 R^3 \\left( \\frac{\\varepsilon - \\varepsilon_0}{\\varepsilon + 2\\varepsilon_0} \\right) \\mathbf{E}_0 $$\nThis is the required expression for the induced macroscopic dipole moment vector of the sphere.", "answer": "$$\n\\boxed{4 \\pi \\varepsilon_{0} R^{3} \\left(\\frac{\\varepsilon - \\varepsilon_{0}}{\\varepsilon + 2\\varepsilon_{0}}\\right) \\mathbf{E}_{0}}\n$$", "id": "2838411"}, {"introduction": "The response of a material to an electric field is not instantaneous and depends on the frequency of the field, a concept captured by the complex permittivity $\\varepsilon(\\omega)$. This advanced computational practice explores the profound link between causality and the frequency response through the Kramers-Kronig relations [@problem_id:2838447]. Starting from synthetic time-domain polarization data, you will perform a numerical inversion to obtain $\\varepsilon(\\omega)$ and test its physical consistency, mirroring the data analysis techniques used in modern dielectric spectroscopy.", "problem": "You must write a complete and runnable program that, using synthetic but scientifically sound time-domain data for the macroscopic polarization response to a step electric field in a linear, causal dielectric, inverts for the complex, frequency-dependent relative permittivity and evaluates whether the result is consistent with the Kramers–Kronig relations. The derivation must start from fundamental definitions: the macroscopic displacement field satisfies $\\,\\mathbf{D}(t)=\\varepsilon_{0}\\mathbf{E}(t)+\\mathbf{P}(t)\\,$ in the time domain, and for a linear, time-invariant, causal medium, the polarization is given by a causal convolution $\\,P(t)=\\varepsilon_{0}\\int_{-\\infty}^{\\infty}\\chi_{\\mathrm{e}}(t-t')E(t')\\,\\mathrm{d}t'\\,$ with $\\,\\chi_{\\mathrm{e}}(t)=0\\,$ for $\\,t0\\,$. Adopt the two-sided Fourier transform convention $\\,F(\\omega)=\\int_{-\\infty}^{\\infty}f(t)\\,e^{i\\omega t}\\,\\mathrm{d}t\\,$ so that convolution in time corresponds to multiplication in frequency, and use the relative permittivity $\\,\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega)\\,$ where $\\,\\varepsilon_{\\infty}\\,$ is the high-frequency limit (dimensionless) and $\\,\\chi_{\\mathrm{e}}(\\omega)\\,$ is the electric susceptibility in frequency domain. The program must recover $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ from a given $\\,P(t)\\,$ record generated under a step field $\\,E(t)=E_{0}u(t)\\,$ and then test the recovered $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ for consistency with the Kramers–Kronig relations appropriate for a causal, linear dielectric.\n\nYour program must adhere to all of the following requirements.\n\n- Physics and numerical setup:\n  - Work in International System of Units (SI). Use $\\,\\varepsilon_{0}=8.854\\,187\\,817\\times 10^{-12}\\,\\mathrm{F/m}\\,$. Use time in $\\,\\mathrm{s}\\,$, angular frequency in $\\,\\mathrm{rad/s}\\,$, electric field in $\\,\\mathrm{V/m}\\,$, and polarization in $\\,\\mathrm{C/m^{2}}\\,$.\n  - The input data for $\\,P(t)\\,$ are to be synthesized inside your program as follows. For a step field $\\,E(t)=E_{0}u(t)\\,$, define for $\\,t\\ge 0\\,$ the model polarization\n    $$\\frac{P(t)}{\\varepsilon_{0}E_{0}}=\\sum_{k=1}^{K}\\Delta\\varepsilon_{k}\\left(1-e^{-t/\\tau_{k}}\\right),$$\n    where $\\,\\Delta\\varepsilon_{k}0\\,$ and $\\,\\tau_{k}0\\,$ are given material parameters for $\\,k=1,\\dots,K\\,$. For $\\,t0\\,$, set $\\,P(t)=0\\,$. Optionally, add zero-mean Gaussian noise to $\\,P(t)\\,$ as specified in the test suite below.\n  - From the synthesized $\\,P(t)\\,$ and known $\\,E_{0}\\,$, numerically recover the time-domain susceptibility $\\,\\chi_{\\mathrm{e}}(t)\\,$ for $\\,t\\ge 0\\,$, then compute its frequency-domain counterpart $\\,\\chi_{\\mathrm{e}}(\\omega)\\,$ on a chosen angular frequency grid $\\,\\{\\omega_{m}\\}_{m=1}^{M}\\,$ that spans at least from $\\,\\omega_{\\min}=2\\pi/T\\,$ to $\\,\\omega_{\\max}=\\pi/\\Delta t\\,$, where $\\,T\\,$ is the total record length and $\\,\\Delta t\\,$ is the sampling interval. Use a numerically sound quadrature for the Fourier integral consistent with the stated convention.\n  - Construct $\\,\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega)\\,$.\n\n- Kramers–Kronig compliance test:\n  - Implement the subtracted Kramers–Kronig relations appropriate for relaxing dielectrics with finite $\\,\\varepsilon_{\\infty}\\,$ to reconstruct $\\,\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)-\\varepsilon_{\\infty}\\,$ from $\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ and vice versa on the discrete frequency grid, using a principal value quadrature that excludes the singular self-term. Use linear frequency spacing for the quadrature and the trapezoidal rule for numerical integration.\n  - Define a relative error on an interior frequency band that excludes a small number of lowest and highest frequency samples to mitigate finite-band effects. The relative errors must be computed as the $\\,\\ell^{2}\\,$ norm ratio between the original and Kramers–Kronig-reconstructed components, with a small regularization to avoid division by zero if necessary.\n  - For each test case, report a boolean that is true if and only if both relative errors are less than or equal to a fixed tolerance $\\,\\delta\\,$.\n\n- Test suite:\n  - Use the following four test cases, each providing a self-contained synthesis of $\\,P(t)\\,$:\n    1. Case $\\,1\\,$ (single relaxation, well-resolved, no noise): $\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$, $\\,\\varepsilon_{\\infty}=2.0\\,$, one term with $\\,\\Delta\\varepsilon_{1}=3.0\\,$ and $\\,\\tau_{1}=5.0\\times 10^{-7}\\,\\mathrm{s}\\,$, sampling interval $\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$, number of samples $\\,N=4096\\,$, no added noise.\n    2. Case $\\,2\\,$ (two relaxations, well-resolved, no noise): $\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$, $\\,\\varepsilon_{\\infty}=1.4\\,$, two terms with $\\,(\\Delta\\varepsilon_{1},\\tau_{1})=(2.0,2.0\\times 10^{-7}\\,\\mathrm{s})\\,$ and $\\,(\\Delta\\varepsilon_{2},\\tau_{2})=(1.0,4.0\\times 10^{-6}\\,\\mathrm{s})\\,$, sampling interval $\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$, number of samples $\\,N=4096\\,$, no added noise.\n    3. Case $\\,3\\,$ (single relaxation, coarse and short record, noisy): $\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$, $\\,\\varepsilon_{\\infty}=2.0\\,$, one term with $\\,\\Delta\\varepsilon_{1}=3.0\\,$ and $\\,\\tau_{1}=3.0\\times 10^{-6}\\,\\mathrm{s}\\,$, sampling interval $\\,\\Delta t=5.0\\times 10^{-8}\\,\\mathrm{s}\\,$, number of samples $\\,N=256\\,$, add independent and identically distributed Gaussian noise with standard deviation equal to $\\,\\eta\\,\\max_{t\\in[0,T]}|P(t)|\\,$ with $\\,\\eta=1.0\\times 10^{-1}\\,$.\n    4. Case $\\,4\\,$ (single relaxation, very short record relative to relaxation): $\\,E_{0}=1.0\\times 10^{5}\\,\\mathrm{V/m}\\,$, $\\,\\varepsilon_{\\infty}=2.0\\,$, one term with $\\,\\Delta\\varepsilon_{1}=3.0\\,$ and $\\,\\tau_{1}=1.0\\times 10^{-4}\\,\\mathrm{s}\\,$, sampling interval $\\,\\Delta t=1.0\\times 10^{-8}\\,\\mathrm{s}\\,$, number of samples $\\,N=256\\,$, no added noise.\n  - For all cases, construct the frequency grid from the record parameters as specified above, and set the Kramers–Kronig compliance tolerance to $\\,\\delta=2.5\\times 10^{-1}\\,$.\n\n- Output format:\n  - Your program must output a single line containing the four boolean results corresponding to the above cases, in order, formatted as a comma-separated list enclosed in square brackets, for example $\\,\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}\\right]\\,$. No other text must be printed.\n\nExpress all internal physical quantities in SI units, and ensure that all numerical angles are in radians. The final outputs are booleans and therefore unitless. The derivation and algorithmic steps you implement must be justified by the stated fundamental laws and definitions, not by unmotivated shortcuts.", "solution": "We begin from the macroscopic constitutive relation in the time domain, $\\,\\mathbf{D}(t)=\\varepsilon_{0}\\mathbf{E}(t)+\\mathbf{P}(t)\\,$, and linear, time-invariant response $\\,P(t)=\\varepsilon_{0}\\int_{-\\infty}^{\\infty}\\chi_{\\mathrm{e}}(t-t')E(t')\\,\\mathrm{d}t'\\,$ with causality $\\,\\chi_{\\mathrm{e}}(t)=0\\,$ for $\\,t0\\,$. For a step field $\\,E(t)=E_{0}u(t)\\,$, we have for $\\,t\\ge 0\\,$\n$$\nP(t)=\\varepsilon_{0}E_{0}\\int_{0}^{t}\\chi_{\\mathrm{e}}(\\tau)\\,\\mathrm{d}\\tau,\n$$\nwhich follows by substituting $\\,E(t')=E_{0}u(t')\\,$ and changing variables. Differentiating with respect to $\\,t\\,$ yields\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}t}(t)=\\varepsilon_{0}E_{0}\\,\\chi_{\\mathrm{e}}(t),\\quad t0.\n$$\nThis identity is a direct consequence of linearity and causality and provides an operational inversion in the time domain when the input is a step: given $\\,P(t)\\,$ and $\\,E_{0}\\,$, one obtains\n$$\n\\chi_{\\mathrm{e}}(t)=\\frac{1}{\\varepsilon_{0}E_{0}}\\frac{\\mathrm{d}P}{\\mathrm{d}t}(t),\\quad t\\ge 0.\n$$\n\nTo pass to frequency domain, we adopt the Fourier transform convention\n$$\n\\mathcal{F}\\{f\\}(\\omega)=\\int_{-\\infty}^{\\infty}f(t)\\,e^{i\\omega t}\\,\\mathrm{d}t,\n$$\nso that $\\,\\mathcal{F}\\{f*g\\}(\\omega)=\\mathcal{F}\\{f\\}(\\omega)\\,\\mathcal{F}\\{g\\}(\\omega)\\,$ for the time convolution $\\,f*g\\,$. For causal $\\,\\chi_{\\mathrm{e}}(t)\\,$ supported on $\\,t\\ge 0\\,$, its Fourier transform is\n$$\n\\chi_{\\mathrm{e}}(\\omega)=\\int_{0}^{\\infty}\\chi_{\\mathrm{e}}(t)\\,e^{i\\omega t}\\,\\mathrm{d}t.\n$$\nIn frequency domain, the relative permittivity is\n$$\n\\varepsilon_{\\mathrm{r}}(\\omega)=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega),\n$$\nwith $\\,\\varepsilon_{\\infty}=\\lim_{\\omega\\to\\infty}\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ the high-frequency limit. For a Debye relaxation with time constant $\\,\\tau\\,$ and strength $\\,\\Delta\\varepsilon\\,$, one has $\\,\\chi_{\\mathrm{e}}(t)=(\\Delta\\varepsilon/\\tau)e^{-t/\\tau}\\,u(t)\\,$, consistent with the step-response model $\\,P(t)/(\\varepsilon_{0}E_{0})=\\Delta\\varepsilon(1-e^{-t/\\tau})\\,$ used to synthesize test data. For multiple relaxations, linear superposition applies.\n\nThe Kramers–Kronig relations follow from causality and the analyticity of response functions in the upper half of the complex frequency plane. For a dielectric with finite $\\,\\varepsilon_{\\infty}\\,$, the subtracted relations connecting the real and imaginary parts of $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ read\n$$\n\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega)-\\varepsilon_{\\infty}=\\frac{2}{\\pi}\\,\\mathcal{P}\\int_{0}^{\\infty}\\frac{\\Omega\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\Omega)}{\\Omega^{2}-\\omega^{2}}\\,\\mathrm{d}\\Omega,\n$$\n$$\n\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega)=-\\frac{2\\omega}{\\pi}\\,\\mathcal{P}\\int_{0}^{\\infty}\\frac{\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\Omega)-\\varepsilon_{\\infty}}{\\Omega^{2}-\\omega^{2}}\\,\\mathrm{d}\\Omega,\n$$\nwhere $\\,\\mathcal{P}\\,$ denotes the Cauchy principal value. These formulas provide a basis to test whether a measured or computed $\\,\\varepsilon_{\\mathrm{r}}(\\omega)\\,$ is consistent with causality.\n\nAlgorithmic steps to implement in the program are as follows.\n\n1. Synthesize $\\,P(t)\\,$ for $\\,t_{n}=n\\,\\Delta t\\,$ with $\\,n=0,1,\\dots,N-1\\,$, using the test-suite parameters. For $\\,t0\\,$, set $\\,P(t)=0\\,$. If specified, add zero-mean Gaussian noise with standard deviation $\\,\\eta\\,\\max_{n}|P(t_{n})|\\,$. All quantities are in SI units.\n\n2. Compute the numerical time derivative $\\,\\mathrm{d}P/\\mathrm{d}t\\,$, for example using a centered finite difference via a gradient operator adapted to uniform sampling. Obtain\n$$\n\\chi_{\\mathrm{e}}(t_{n})=\\frac{1}{\\varepsilon_{0}E_{0}}\\left.\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right|_{t=t_{n}},\\quad n=0,1,\\dots,N-1.\n$$\nOptionally, in the presence of noise, the derivative may be mildly regularized or smoothed, but this is not strictly required by the physics.\n\n3. Choose a frequency grid $\\,\\omega_{m}\\,$ linearly spaced on $\\,\\left[\\omega_{\\min},\\omega_{\\max}\\right]\\,$, where $\\,\\omega_{\\min}=2\\pi/T\\,$ with $\\,T=N\\,\\Delta t\\,$ and $\\,\\omega_{\\max}=\\pi/\\Delta t\\,$. Approximate the Fourier transform for $\\,\\omega=\\omega_{m}\\,$ by the Riemann sum\n$$\n\\chi_{\\mathrm{e}}(\\omega_{m})\\approx\\sum_{n=0}^{N-1}\\chi_{\\mathrm{e}}(t_{n})\\,e^{i\\omega_{m}t_{n}}\\,\\Delta t.\n$$\nForm\n$$\n\\varepsilon_{\\mathrm{r}}(\\omega_{m})=\\varepsilon_{\\infty}+\\chi_{\\mathrm{e}}(\\omega_{m}).\n$$\n\n4. Implement the subtracted Kramers–Kronig relations numerically on the discrete grid. With linear frequency spacing $\\,\\Delta\\omega\\,$ and trapezoidal weights, for each interior index $\\,m\\,$ compute the principal value integral by summing over $\\,j\\neq m\\,$:\n$$\n\\left[\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{m})\\right]_{\\mathrm{KK}}=\\varepsilon_{\\infty}+\\frac{2}{\\pi}\\sum_{j\\neq m}w_{j}\\,\\frac{\\omega_{j}\\,\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{j})}{\\omega_{j}^{2}-\\omega_{m}^{2}},\n$$\n$$\n\\left[\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{m})\\right]_{\\mathrm{KK}}=-\\frac{2\\omega_{m}}{\\pi}\\sum_{j\\neq m}w_{j}\\,\\frac{\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}(\\omega_{j})-\\varepsilon_{\\infty}}{\\omega_{j}^{2}-\\omega_{m}^{2}},\n$$\nwhere $\\,w_{j}\\,$ are trapezoidal weights equal to $\\,\\Delta\\omega\\,$ for interior points and $\\,\\Delta\\omega/2\\,$ at the endpoints. The self-term $\\,j=m\\,$ is omitted to realize the principal value.\n\n5. Evaluate relative errors on an interior band $\\,m=m_{\\mathrm{lo}},\\dots,m_{\\mathrm{hi}}\\,$ to avoid boundary effects, for example discarding several samples at each end. Define\n$$\n\\epsilon_{\\mathrm{Re}}=\\frac{\\left\\|\\left(\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}-\\varepsilon_{\\infty}\\right)-\\left(\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}\\right)_{\\mathrm{KK}}+\\varepsilon_{\\infty}\\right\\|_{2}}{\\left\\|\\operatorname{Re}\\,\\varepsilon_{\\mathrm{r}}-\\varepsilon_{\\infty}\\right\\|_{2}+\\epsilon_{0}},\n\\quad\n\\epsilon_{\\mathrm{Im}}=\\frac{\\left\\|\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}-\\left(\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}\\right)_{\\mathrm{KK}}\\right\\|_{2}}{\\left\\|\\operatorname{Im}\\,\\varepsilon_{\\mathrm{r}}\\right\\|_{2}+\\epsilon_{0}},\n$$\nwith a small regularization $\\,\\epsilon_{0}\\,$ (for example $\\,\\epsilon_{0}=10^{-12}\\,$) to avoid division by zero in pathological cases. Declare Kramers–Kronig compliance if $\\,\\max(\\epsilon_{\\mathrm{Re}},\\epsilon_{\\mathrm{Im}})\\le \\delta\\,$ with $\\,\\delta=2.5\\times 10^{-1}\\,$.\n\nThe four test cases are constructed as specified in the problem statement. Cases with well-resolved, noiseless data (cases $\\,1\\,$ and $\\,2\\,$) should yield small relative errors well below the tolerance, hence compliance. Cases with short or coarse records and noise (cases $\\,3\\,$ and $\\,4\\,$) degrade the inversion and finite-band Kramers–Kronig quadrature, typically producing larger relative errors exceeding the tolerance, hence non-compliance.\n\nThe program must synthesize $\\,P(t)\\,$ for each case, carry out the above steps, and finally print a single line with a Python-style list of booleans $\\,\\left[\\mathrm{b}_{1},\\mathrm{b}_{2},\\mathrm{b}_{3},\\mathrm{b}_{4}\\right]\\,$ indicating Kramers–Kronig compliance for cases $\\,1\\,$ through $\\,4\\,$ in order.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants (SI units)\nEPS0 = 8.854187817e-12  # F/m\n\ndef synthesize_P(t, E0, terms, noise_level=0.0, rng=None):\n    \"\"\"\n    Synthesize P(t) for a step field E(t) = E0 * u(t) with Debye relaxations:\n    P(t)/(eps0*E0) = sum_k Delta_eps_k * (1 - exp(-t/tau_k)), for t = 0.\n    terms: list of (Delta_eps, tau)\n    noise_level: relative std dev with respect to max|P(t)| (absolute).\n    \"\"\"\n    P = np.zeros_like(t)\n    # t=0 assumed for supplied t\n    for d_eps, tau in terms:\n        P += EPS0 * E0 * d_eps * (1.0 - np.exp(-t / tau))\n    if noise_level  0.0:\n        if rng is None:\n            rng = np.random.default_rng(12345)\n        sigma = noise_level * np.max(np.abs(P)) if np.max(np.abs(P))  0 else 0.0\n        P = P + rng.normal(0.0, sigma, size=P.shape)\n    return P\n\ndef numerical_derivative_uniform(y, dt):\n    \"\"\"\n    Compute numerical derivative dy/dt for uniformly sampled y(t) with spacing dt.\n    Uses central differences for interior, forward/backward for edges.\n    \"\"\"\n    dy = np.empty_like(y)\n    # Forward difference at start\n    dy[0] = (y[1] - y[0]) / dt\n    # Central differences interior\n    dy[1:-1] = (y[2:] - y[:-2]) / (2.0 * dt)\n    # Backward difference at end\n    dy[-1] = (y[-1] - y[-2]) / dt\n    return dy\n\ndef compute_susceptibility_time(P, E0, dt):\n    \"\"\"\n    Compute chi_e(t) = (1/(eps0*E0)) * dP/dt from P(t)\n    \"\"\"\n    dPdt = numerical_derivative_uniform(P, dt)\n    chi_t = dPdt / (EPS0 * E0)\n    return chi_t\n\ndef fourier_transform_one_sided(chi_t, t, omega):\n    \"\"\"\n    Compute chi_e(omega) = integral_0^T chi_e(t) * exp(i*omega*t) dt\n    using Riemann sum.\n    \"\"\"\n    dt = t[1] - t[0]\n    # Matrix exponential evaluation: t[:,None] * omega[None,:]\n    phase = np.exp(1j * np.outer(t, omega))  # shape (N, M)\n    chi_w = dt * (chi_t[:, None] * phase).sum(axis=0)\n    return chi_w\n\ndef kk_from_imag(omega, eps_im, eps_inf):\n    \"\"\"\n    Compute Re[eps_r](omega) via Kramers-Kronig from Im[eps_r](omega), subtracted form.\n    Re[eps_r](w) - eps_inf = (2/pi) P ∫_0^∞ [Omega * Im eps_r(Omega)]/(Omega^2 - w^2) dOmega\n    Implemented on discrete, linearly spaced omega grid with trapezoidal weights.\n    \"\"\"\n    M = omega.size\n    # Linear spacing assumed\n    domega = omega[1] - omega[0]\n    weights = np.ones(M) * domega\n    weights[0] *= 0.5\n    weights[-1] *= 0.5\n\n    re_eps = np.empty(M, dtype=float)\n    for m in range(M):\n        # Principal value: exclude j == m\n        denom = omega**2 - omega[m]**2\n        with np.errstate(divide='ignore', invalid='ignore'):\n            integrand = omega * eps_im / denom\n        integrand[m] = 0.0  # exclude self-term\n        val = (2.0 / np.pi) * np.sum(weights * integrand)\n        re_eps[m] = eps_inf + val\n    return re_eps\n\ndef kk_from_real(omega, eps_re, eps_inf):\n    \"\"\"\n    Compute Im[eps_r](omega) via Kramers-Kronig from Re[eps_r](omega), subtracted form.\n    Im[eps_r](w) = -(2*w/pi) P ∫_0^∞ [Re eps_r(Omega) - eps_inf]/(Omega^2 - w^2) dOmega\n    Discrete principal value with trapezoidal weights on linear omega grid.\n    \"\"\"\n    M = omega.size\n    domega = omega[1] - omega[0]\n    weights = np.ones(M) * domega\n    weights[0] *= 0.5\n    weights[-1] *= 0.5\n\n    im_eps = np.empty(M, dtype=float)\n    for m in range(M):\n        denom = omega**2 - omega[m]**2\n        with np.errstate(divide='ignore', invalid='ignore'):\n            integrand = (eps_re - eps_inf) / denom\n        integrand[m] = 0.0  # exclude self-term\n        val = -(2.0 * omega[m] / np.pi) * np.sum(weights * integrand)\n        im_eps[m] = val\n    return im_eps\n\ndef kk_compliance(eps_re, eps_im, omega, eps_inf, trim=5, tol=0.25):\n    \"\"\"\n    Compute relative L2 errors between eps and its KK reconstructions on interior band,\n    and return boolean for compliance (both errors = tol).\n    \"\"\"\n    # K-K reconstructions\n    re_from_im = kk_from_imag(omega, eps_im, eps_inf)\n    im_from_re = kk_from_real(omega, eps_re, eps_inf)\n\n    # Interior slicing to reduce edge effects\n    lo = trim\n    hi = len(omega) - trim\n    if hi = lo + 1:\n        lo = 1\n        hi = len(omega) - 1\n\n    # Relative L2 errors\n    eps0 = 1e-12\n    num_re = np.linalg.norm((eps_re - eps_inf)[lo:hi] - (re_from_im - eps_inf)[lo:hi])\n    den_re = np.linalg.norm((eps_re - eps_inf)[lo:hi]) + eps0\n    err_re = num_re / den_re\n\n    num_im = np.linalg.norm(eps_im[lo:hi] - im_from_re[lo:hi])\n    den_im = np.linalg.norm(eps_im[lo:hi]) + eps0\n    err_im = num_im / den_im\n\n    return (max(err_re, err_im) = tol), err_re, err_im\n\ndef invert_and_test_case(E0, eps_inf, terms, dt, N, noise_level=0.0, seed=1234,\n                         M_freq=256, tol=0.25):\n    \"\"\"\n    Full pipeline for one case:\n    - synthesize P(t)\n    - compute chi_e(t)\n    - compute chi_e(omega) and eps_r(omega)\n    - test Kramers-Kronig compliance\n    Returns boolean compliance.\n    \"\"\"\n    # Time grid\n    t = np.arange(N, dtype=float) * dt\n    # Synthesize P(t)\n    rng = np.random.default_rng(seed)\n    P = synthesize_P(t, E0, terms, noise_level=noise_level, rng=rng)\n    # Time-domain susceptibility via derivative\n    chi_t = compute_susceptibility_time(P, E0, dt)\n    # Frequency grid: linear from 2*pi/T to pi/dt\n    T = N * dt\n    w_min = 2.0 * np.pi / T\n    w_max = np.pi / dt\n    omega = np.linspace(w_min, w_max, M_freq)\n    # Fourier transform\n    chi_w = fourier_transform_one_sided(chi_t, t, omega)\n    # Relative permittivity\n    eps_r = eps_inf + chi_w\n    eps_re = np.real(eps_r)\n    eps_im = np.imag(eps_r)\n    # KK test\n    compliant, _, _ = kk_compliance(eps_re, eps_im, omega, eps_inf, trim=5, tol=tol)\n    return compliant\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case 1: Single relaxation, well-resolved, no noise\n    case1 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 5.0e-7)],\n        dt=1.0e-8,\n        N=4096,\n        noise_level=0.0\n    )\n    # Case 2: Two relaxations, well-resolved, no noise\n    case2 = dict(\n        E0=1.0e5,\n        eps_inf=1.4,\n        terms=[(2.0, 2.0e-7), (1.0, 4.0e-6)],\n        dt=1.0e-8,\n        N=4096,\n        noise_level=0.0\n    )\n    # Case 3: Single relaxation, coarse/short record, noisy\n    case3 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 3.0e-6)],\n        dt=5.0e-8,\n        N=256,\n        noise_level=1.0e-1\n    )\n    # Case 4: Single relaxation, very short record relative to tau\n    case4 = dict(\n        E0=1.0e5,\n        eps_inf=2.0,\n        terms=[(3.0, 1.0e-4)],\n        dt=1.0e-8,\n        N=256,\n        noise_level=0.0\n    )\n\n    test_cases = [case1, case2, case3, case4]\n\n    results = []\n    for idx, params in enumerate(test_cases):\n        compliant = invert_and_test_case(\n            E0=params[\"E0\"],\n            eps_inf=params[\"eps_inf\"],\n            terms=params[\"terms\"],\n            dt=params[\"dt\"],\n            N=params[\"N\"],\n            noise_level=params[\"noise_level\"],\n            seed=1234 + idx,  # different seeds for different cases\n            M_freq=256,\n            tol=0.25\n        )\n        results.append(compliant)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(['True' if r else 'False' for r in results])}]\")\n\nsolve()\n```", "id": "2838447"}]}