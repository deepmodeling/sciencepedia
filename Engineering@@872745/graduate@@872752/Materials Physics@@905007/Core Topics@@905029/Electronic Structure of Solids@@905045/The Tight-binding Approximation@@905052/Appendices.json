{"hands_on_practices": [{"introduction": "The first step in mastering the tight-binding approximation is to apply it to the simplest possible periodic system: a one-dimensional chain of atoms. This foundational exercise connects the microscopic parameters of the model—the hopping integral $t$ and lattice constant $a$—to the emergent electronic band structure $E(k)$. By calculating the curvature of this band at its minimum, you will derive the electron's effective mass $m^*$, a crucial macroscopic quantity that governs its response to external fields [@problem_id:2866069].", "problem": "Consider a one-dimensional Bravais lattice with lattice constant $a$ and a single orthonormal orbital $\\{|n\\rangle\\}$ per site at positions $x_{n}=n a$, where $n\\in\\mathbb{Z}$. Within the tight-binding approximation (TBA), the single-electron Hamiltonian includes an on-site energy and only nearest-neighbor hopping with a real amplitude $t>0$:\n$$\n\\hat{H}=\\varepsilon_{0}\\sum_{n}|n\\rangle\\langle n| - t \\sum_{n}\\Big(|n\\rangle\\langle n+1|+|n+1\\rangle\\langle n|\\Big).\n$$\nUsing Bloch’s theorem and the semiclassical definition of effective mass at a band extremum, derive the band dispersion $E(k)$ and then determine the effective mass $m^{\\ast}$ at the bottom of the band. Express your final result for $m^{\\ast}$ in terms of $t$, $a$, and fundamental constants only. Provide a single closed-form analytical expression; do not append units to your final expression. If numerical values were to be substituted, the effective mass should be expressed in kilograms. No rounding is required.", "solution": "The problem presented is a standard exercise in elementary solid-state theory and is subject to validation.\n\n**Problem Validation:**\n\n*   **Givens:** A one-dimensional Bravais lattice with lattice constant $a$. Site positions are $x_n = na$ for $n \\in \\mathbb{Z}$. A single orthonormal orbital $\\{|n\\rangle\\}$ exists at each site. The Hamiltonian in the tight-binding approximation (TBA) is $\\hat{H}=\\varepsilon_{0}\\sum_{n}|n\\rangle\\langle n| - t \\sum_{n}\\Big(|n\\rangle\\langle n+1|+|n+1\\rangle\\langle n|\\Big)$, with on-site energy $\\varepsilon_0$ and real, positive nearest-neighbor hopping amplitude $t>0$.\n*   **Tasks:** Derive the band dispersion $E(k)$ and the effective mass $m^*$ at the bottom of the band.\n*   **Validation Verdict:** The problem is **valid**. It is a scientifically grounded, well-posed, and objective problem that is a canonical example within the topic of the tight-binding approximation. It is devoid of inconsistencies, ambiguities, or factual errors. All necessary information is provided.\n\n**Solution Derivation:**\n\nThe solution proceeds in two stages: first, the derivation of the energy dispersion relation $E(k)$, followed by the calculation of the effective mass $m^*$ at the band minimum.\n\n**1. Derivation of the Band Dispersion $E(k)$**\n\nAccording to Bloch's theorem, the eigenstates of a periodic potential can be written as Bloch states. For a one-dimensional lattice, a Bloch state $|\\psi_k\\rangle$ is a superposition of the localized atomic orbitals $|n\\rangle$, weighted by a phase factor dependent on the crystal momentum $k$:\n$$\n|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikx_n} |n\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} |n\\rangle\n$$\nwhere $N$ is the number of sites in the lattice, $n$ is an integer indexing the lattice sites, and $k$ is the wavevector.\n\nThe energy eigenvalues $E(k)$ are found by solving the time-independent Schrödinger equation:\n$$\n\\hat{H}|\\psi_k\\rangle = E(k)|\\psi_k\\rangle\n$$\nWe apply the given Hamiltonian $\\hat{H}$ to the Bloch state $|\\psi_k\\rangle$. It is computationally simpler to first determine the action of $\\hat{H}$ on a single localized orbital $|n\\rangle$:\n$$\n\\hat{H}|n\\rangle = \\left(\\varepsilon_{0}\\sum_{m}|m\\rangle\\langle m| - t \\sum_{m}\\Big(|m\\rangle\\langle m+1|+|m+1\\rangle\\langle m|\\Big)\\right)|n\\rangle\n$$\nUsing the orthonormality of the basis, $\\langle m|n\\rangle = \\delta_{mn}$, we find:\n$$\n\\hat{H}|n\\rangle = \\varepsilon_0|n\\rangle - t(|n-1\\rangle + |n+1\\rangle)\n$$\nNow, we apply $\\hat{H}$ to the full Bloch state:\n$$\n\\hat{H}|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} \\hat{H}|n\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} \\Big(\\varepsilon_0|n\\rangle - t|n-1\\rangle - t|n+1\\rangle\\Big)\n$$\nTo find the eigenvalue $E(k)$, we may project onto one of the basis kets, for instance $\\langle m|$:\n$$\n\\langle m|\\hat{H}|\\psi_k\\rangle = E(k)\\langle m|\\psi_k\\rangle\n$$\nThe right-hand side is:\n$$\nE(k)\\langle m|\\psi_k\\rangle = E(k) \\left\\langle m \\left| \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} |n\\rangle \\right. \\right\\rangle = \\frac{E(k)}{\\sqrt{N}} \\sum_{n} e^{ikan} \\delta_{mn} = \\frac{E(k)}{\\sqrt{N}}e^{ikam}\n$$\nThe left-hand side is:\n$$\n\\langle m|\\hat{H}|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} \\langle m| \\Big(\\varepsilon_0|n\\rangle - t|n-1\\rangle - t|n+1\\rangle\\Big) = \\frac{1}{\\sqrt{N}} \\sum_{n} e^{ikan} (\\varepsilon_0 \\delta_{mn} - t \\delta_{m,n+1} - t \\delta_{m,n-1})\n$$\nThe sum has non-zero contributions only when $n=m$, $n=m-1$, and $n=m+1$. Evaluating these terms:\n$$\n\\langle m|\\hat{H}|\\psi_k\\rangle = \\frac{1}{\\sqrt{N}} \\Big( e^{ikam}\\varepsilon_0 - e^{ik a (m+1)}t - e^{ik a (m-1)}t \\Big) = \\frac{e^{ikam}}{\\sqrt{N}} \\Big( \\varepsilon_0 - t(e^{ika} + e^{-ika}) \\Big)\n$$\nEquating the left and right sides yields:\n$$\n\\frac{E(k)}{\\sqrt{N}}e^{ikam} = \\frac{e^{ikam}}{\\sqrt{N}} \\Big( \\varepsilon_0 - t(e^{ika} + e^{-ika}) \\Big)\n$$\nThis gives the energy dispersion relation. Using the Euler identity $2\\cos(x) = e^{ix} + e^{-ix}$:\n$$\nE(k) = \\varepsilon_0 - 2t\\cos(ka)\n$$\n\n**2. Calculation of the Effective Mass $m^*$**\n\nThe semiclassical effective mass $m^*$ near a band extremum is defined from the curvature of the energy band. In one dimension, the formula is:\n$$\nm^* = \\hbar^2 \\left( \\frac{d^2E}{dk^2} \\right)^{-1}\n$$\nwhere $\\hbar$ is the reduced Planck constant.\n\nFirst, we must identify the location of the bottom of the band. The energy $E(k)$ is minimized when the term $-2t\\cos(ka)$ is at its most negative value. Since $t>0$, this occurs when $\\cos(ka)$ is maximized, i.e., $\\cos(ka)=1$. In the first Brillouin zone, $k \\in [-\\pi/a, \\pi/a]$, this condition is met at the zone center, $k=0$. This point corresponds to the bottom of the band.\n\nNext, we compute the second derivative of $E(k)$ with respect to $k$. The first derivative is:\n$$\n\\frac{dE}{dk} = \\frac{d}{dk} \\Big( \\varepsilon_0 - 2t\\cos(ka) \\Big) = -2t(-\\sin(ka) \\cdot a) = 2ta \\sin(ka)\n$$\nThe second derivative is:\n$$\n\\frac{d^2E}{dk^2} = \\frac{d}{dk} \\Big( 2ta \\sin(ka) \\Big) = 2ta (\\cos(ka) \\cdot a) = 2ta^2 \\cos(ka)\n$$\nWe evaluate this second derivative at the band bottom, $k=0$:\n$$\n\\left. \\frac{d^2E}{dk^2} \\right|_{k=0} = 2ta^2 \\cos(0) = 2ta^2\n$$\nSince this quantity is positive (as $t>0$ and $a>0$), it correctly describes a band minimum.\n\nFinally, we substitute this result into the formula for the effective mass:\n$$\nm^* = \\hbar^2 \\left( 2ta^2 \\right)^{-1}\n$$\nThis leads to the final expression for the effective mass at the bottom of the band.\n$$\nm^* = \\frac{\\hbar^2}{2ta^2}\n$$\nThis expression is in terms of the hopping parameter $t$, the lattice constant $a$, and the fundamental constant $\\hbar$, as required.", "answer": "$$\n\\boxed{\\frac{\\hbar^2}{2ta^2}}\n$$", "id": "2866069"}, {"introduction": "While a simple metallic chain provides a starting point, many real materials have more complex crystal structures and potentials. This practice explores how a small modification to the one-dimensional chain—a staggered on-site potential—can dramatically alter its electronic properties. By analyzing this system, you will uncover the fundamental mechanism of band gap opening, which is the key to understanding insulators and semiconductors [@problem_id:1822021]. This problem serves as a gateway to understanding more complex phenomena like dimerization and topological phases.", "problem": "Consider a one-dimensional chain of identical atoms spaced by a distance $a$. The electronic properties of this chain are described by a tight-binding model. The state of an electron is described as a linear combination of atomic orbitals $|n\\rangle$, where $|n\\rangle$ is the atomic orbital centered on the atom at site $n$. The Hamiltonian $H$ for the system has the following matrix elements in this basis:\n\n- The on-site energy at site $n$ is given by a staggered potential: $\\langle n|H|n \\rangle = \\epsilon_n = \\epsilon_0 + (-1)^n \\Delta$, where $\\epsilon_0$ and $\\Delta$ are real energy constants with $\\Delta > 0$.\n- The hopping energy between nearest-neighbor sites $n$ and $n \\pm 1$ is $\\langle n|H|n \\pm 1 \\rangle = -t$, where $t$ is a real, positive constant.\n- All other matrix elements of the Hamiltonian are zero.\n\nThis staggered potential creates a band gap in the electronic energy spectrum. Determine the magnitude of the direct band gap, which is defined as the minimum energy difference between the upper and lower energy bands across all wavevectors. Express your answer as a symbolic expression in terms of the given parameters.", "solution": "We model the chain with a two-site unit cell due to the staggered on-site energies. Let even sites form sublattice A with on-site energy $\\epsilon_{A}=\\epsilon_{0}+\\Delta$, and odd sites form sublattice B with on-site energy $\\epsilon_{B}=\\epsilon_{0}-\\Delta$. Using Bloch’s theorem with lattice vector $2a$, define Bloch basis states $\\{|k,A\\rangle,|k,B\\rangle\\}$.\n\nNearest-neighbor hopping of amplitude $-t$ connects $A$ in cell $m$ to $B$ in the same cell and to $B$ in the neighboring cell. In $k$-space, the Bloch Hamiltonian is\n$$\nH(k)=\\begin{pmatrix}\n\\epsilon_{0}+\\Delta & -t\\bigl(1+\\exp(-i\\,2ka)\\bigr)\\\\\n-t\\bigl(1+\\exp(i\\,2ka)\\bigr) & \\epsilon_{0}-\\Delta\n\\end{pmatrix}.\n$$\nThe band energies are obtained from $\\det\\bigl[H(k)-E I\\bigr]=0$, i.e.\n$$\n\\bigl(\\epsilon_{0}+\\Delta-E\\bigr)\\bigl(\\epsilon_{0}-\\Delta-E\\bigr)-t^{2}\\bigl|1+\\exp(i\\,2ka)\\bigr|^{2}=0.\n$$\nExpanding the diagonal part gives\n$$\n\\bigl(\\epsilon_{0}-E\\bigr)^{2}-\\Delta^{2}-t^{2}\\bigl|1+\\exp(i\\,2ka)\\bigr|^{2}=0,\n$$\nso\n$$\nE_{\\pm}(k)=\\epsilon_{0}\\pm\\sqrt{\\Delta^{2}+t^{2}\\bigl|1+\\exp(i\\,2ka)\\bigr|^{2}}.\n$$\nEvaluate the modulus:\n$$\n\\bigl|1+\\exp(i\\,2ka)\\bigr|^{2}=(1+\\exp(i\\,2ka))(1+\\exp(-i\\,2ka))=2+2\\cos(2ka)=4\\cos^{2}(ka).\n$$\nThus the dispersion is\n$$\nE_{\\pm}(k)=\\epsilon_{0}\\pm\\sqrt{\\Delta^{2}+4t^{2}\\cos^{2}(ka)}.\n$$\nThe direct gap at wavevector $k$ is\n$$\nE_{+}(k)-E_{-}(k)=2\\sqrt{\\Delta^{2}+4t^{2}\\cos^{2}(ka)}.\n$$\nTo find the magnitude of the direct band gap, minimize this over all $k$. The minimum occurs when $\\cos(ka)=0$, i.e., at $k=\\pm\\frac{\\pi}{2a}$ (within the reduced Brillouin zone), yielding\n$$\nE_{+}-E_{-}\\Big|_{\\min}=2\\sqrt{\\Delta^{2}}=2\\Delta,\n$$\nusing $\\Delta>0$ as given. Therefore, the magnitude of the direct band gap is $2\\Delta$.", "answer": "$$\\boxed{2\\Delta}$$", "id": "1822021"}, {"introduction": "In contemporary materials research, analytical solutions are often limited to idealized models, making numerical computation an indispensable tool. However, the validity of any simulation hinges on the correctness of its underlying code. This capstone practice guides you through the essential process of code validation, where you will implement a general tight-binding solver and verify its accuracy by comparing its output against exact analytical solutions for simple lattices [@problem_id:2866058]. This exercise bridges the gap between theoretical understanding and robust computational practice.", "problem": "You are asked to validate a general-purpose implementation of the Tight-Binding (TB) approximation by reproducing analytic band dispersions for one-dimensional chains and two-dimensional square lattices with one orbital per lattice site and nearest-neighbor hopping, and by quantifying numerical error norms. The validation must be self-consistent and based on derivations from first principles without using pre-quoted dispersion formulas in the problem statement.\n\nFundamental base to be used in your derivations:\n- Periodicity of a crystalline lattice and Bloch's theorem: electronic eigenstates in a periodic potential can be labeled by crystal momentum $k$ in the Brillouin Zone (BZ).\n- The Tight-Binding (TB) approximation: start from orthonormal, localized atomic-like orbitals centered on lattice sites, retain on-site energy and a finite set of hopping integrals between sites, and use lattice translation symmetry to write the Hamiltonian in reciprocal space.\n- For numerical comparison, periodic boundary conditions imply a first Brillouin Zone of $[-\\pi/a, \\pi/a]$ in one dimension and $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$ in two dimensions when the lattice constant is $a$.\n\nTasks:\n1. Starting from the TB Hamiltonian with a single orbital per site and only nearest-neighbor hopping on:\n   - a one-dimensional Bravais lattice,\n   - a two-dimensional square Bravais lattice,\n   derive the analytic expressions for the band energies $E(k)$ and $E(k_x, k_y)$ using Bloch's theorem and the Fourier representation of the lattice sums. Your derivations must start from the fundamental definitions of the TB Hamiltonian and Bloch states and justify each step to obtain the closed-form analytic expressions.\n\n2. Implement a program that:\n   - Constructs the Bloch Hamiltonian $H(k)$ (or $H(k_x, k_y)$) from on-site energy and nearest-neighbor hopping vectors using lattice translation symmetry.\n   - Computes the numerical band energies by diagonalizing $H(k)$ for each $k$-point on a uniform grid that spans the first Brillouin Zone (BZ).\n   - Independently computes the analytic band energies using the expressions you derived in Task $1$ (do not hard-code any formulas from the problem statement because none are given; you must encode your derived expressions).\n   - Computes two absolute error norms over the sampled BZ:\n     - The uniform norm (also called the $L_\\infty$ norm): $\\max |E_{\\text{num}} - E_{\\text{ana}}|$.\n     - The root-mean-square (RMS) norm: $\\sqrt{\\langle (E_{\\text{num}} - E_{\\text{ana}})^2 \\rangle}$ where the average is over the sampled BZ grid points.\n\n3. Use the following test suite of parameter sets to exercise different aspects of your implementation:\n   - Test Case $1$ (one-dimensional chain, general case): lattice constant $a = 0.246 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = 0.3\\,\\text{eV}$, nearest-neighbor hopping $t = -2.7\\,\\text{eV}$, number of evenly spaced $k$-points $N_k = 257$ over the closed interval $[-\\pi/a, \\pi/a]$.\n   - Test Case $2$ (one-dimensional chain, boundary case): lattice constant $a = 0.5 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = 1.0\\,\\text{eV}$, nearest-neighbor hopping $t = 0.0\\,\\text{eV}$, number of $k$-points $N_k = 1$ (interpret this as sampling only $k = 0$).\n   - Test Case $3$ (two-dimensional square lattice, general case): lattice constant $a = 0.35 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = -0.2\\,\\text{eV}$, nearest-neighbor hopping $t = 1.1\\,\\text{eV}$, number of evenly spaced grid points $N_{k_x} = 129$ and $N_{k_y} = 127$ over the closed rectangle $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$.\n   - Test Case $4$ (two-dimensional square lattice, symmetry and sign check): lattice constant $a = 0.3 \\times 10^{-9}\\,\\text{m}$, on-site energy $\\varepsilon_0 = 0.0\\,\\text{eV}$, nearest-neighbor hopping $t = -3.33\\,\\text{eV}$, number of grid points $N_{k_x} = 31$ and $N_{k_y} = 31$ over the closed rectangle $[-\\pi/a, \\pi/a] \\times [-\\pi/a, \\pi/a]$.\n\nAngle units and physical units:\n- Crystal momenta must be treated in radians, i.e., the scalar products $k \\cdot R$ and $k_x a$, $k_y a$ are in radians.\n- Lattice constants $a$ must be treated in meters.\n- Energies must be expressed in electronvolts (eV).\n- Numerical error norms must be reported in electronvolts (eV).\n\nNumerical protocol:\n- For $N_k = 1$ in one dimension, use $k = 0$ only.\n- For $N_k \\ge 2$ in one dimension, sample $k$ uniformly over $[-\\pi/a, \\pi/a]$ including both endpoints.\n- For two dimensions, sample a Cartesian product grid $k_x \\in [-\\pi/a, \\pi/a]$, $k_y \\in [-\\pi/a, \\pi/a]$ including both endpoints in each direction if $N_{k_x}, N_{k_y} \\ge 2$; if $N_{k_x} = 1$ or $N_{k_y} = 1$, use the single point $0$ for that direction.\n- Compute the two norms over the full set of sampled points. Round each norm to $12$ decimal places.\n\nRequired final output format:\n- For each test case, produce a list with two floats $[L_\\infty, L_2]$ in electronvolts, each rounded to $12$ decimal places.\n- Aggregate the four test-case results into a single Python-style list and print it as one line only, with no extra spaces inserted beyond those necessary for valid comma separation. For example: $[[x_{11},x_{12}],[x_{21},x_{22}],[x_{31},x_{32}],[x_{41},x_{42}]]$.\n\nYour program must be a complete, runnable program that performs all computations without user input and prints exactly one line in the format specified above.", "solution": "The problem is found to be valid. It is a well-posed, scientifically grounded task from fundamental solid-state physics, requiring the derivation and numerical verification of the tight-binding band structure for simple lattices. All required parameters are provided, and the task is unambiguous.\n\nThe solution proceeds in $2$ stages. First, the analytic dispersion relations are derived from first principles for a $1$-dimensional ($1$D) chain and a $2$-dimensional ($2$D) square lattice. Second, these derivations are used to construct a self-consistent numerical validation program.\n\n**Derivation of the Analytic Band Dispersion**\n\nThe tight-binding model starts with a basis of localized atomic-like orbitals $|\\phi_{\\mathbf{R}}\\rangle$ centered at each lattice site $\\mathbf{R}$. These orbitals are assumed to form an orthonormal set: $\\langle \\phi_{\\mathbf{R}} | \\phi_{\\mathbf{R}'} \\rangle = \\delta_{\\mathbf{R}\\mathbf{R}'}$. The Hamiltonian $H$ is defined by its matrix elements in this basis. For a model with a single ($1$) orbital per site, an on-site energy $\\varepsilon_0$, and a hopping integral $t$ only between nearest neighbors, the matrix elements are:\n$$\n\\langle \\phi_{\\mathbf{R}'} | H | \\phi_{\\mathbf{R}} \\rangle =\n\\begin{cases}\n\\varepsilon_0 & \\text{if } \\mathbf{R}' = \\mathbf{R} \\\\\nt & \\text{if } \\mathbf{R}' \\text{ and } \\mathbf{R} \\text{ are nearest neighbors} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n\nAccording to Bloch's theorem, the eigenstates of a periodic system can be written as Bloch waves, which are superpositions of the localized orbitals, distinguished by a crystal momentum vector $\\mathbf{k}$ from the first Brillouin Zone. For a lattice with $N$ sites, the Bloch state is:\n$$\n|\\psi_{\\mathbf{k}}\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}} e^{i\\mathbf{k} \\cdot \\mathbf{R}} |\\phi_{\\mathbf{R}}\\rangle\n$$\nSince there is $1$ orbital per site, the basis for the eigenstates for a given $\\mathbf{k}$ is $1$-dimensional. The Bloch Hamiltonian $H(\\mathbf{k})$ is therefore a $1 \\times 1$ matrix, whose single element is the energy eigenvalue $E(\\mathbf{k})$. This is calculated as the expectation value of the Hamiltonian in the Bloch state:\n$$\nE(\\mathbf{k}) = \\langle \\psi_{\\mathbf{k}} | H | \\psi_{\\mathbf{k}} \\rangle = \\frac{1}{N} \\sum_{\\mathbf{R}, \\mathbf{R}'} e^{-i\\mathbf{k} \\cdot \\mathbf{R}'} e^{i\\mathbf{k} \\cdot \\mathbf{R}} \\langle \\phi_{\\mathbf{R}'} | H | \\phi_{\\mathbf{R}} \\rangle\n$$\nBy using the translation invariance of the lattice, we can set one summation index, say $\\mathbf{R}'$, as the origin without loss of generality and sum over displacement vectors $\\boldsymbol{\\delta} = \\mathbf{R} - \\mathbf{R}'$. This simplifies the expression to a sum over neighbors:\n$$\nE(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} H_{\\mathbf{0}, \\boldsymbol{\\delta}}\n$$\nwhere $H_{\\mathbf{0}, \\boldsymbol{\\delta}} = \\langle \\phi_{\\mathbf{0}} | H | \\phi_{\\boldsymbol{\\delta}} \\rangle$ are the Hamiltonian matrix elements connecting the origin site to sites at $\\boldsymbol{\\delta}$. This expression is the discrete Fourier transform of the real-space Hamiltonian matrix elements and represents the general method for constructing the Bloch Hamiltonian.\n\n**One-Dimensional ($1$D) Chain**\n\nFor a $1$D chain with lattice constant $a$, the lattice sites are at positions $R_n = na$ for integer $n$. The crystal momentum is a scalar $k$. The nearest neighbors of a site at $na$ are at $(n \\pm 1)a$. The displacement vectors $\\boldsymbol{\\delta}$ from the origin are thus $\\delta = 0$ (the site itself), $\\delta = +a$, and $\\delta = -a$.\nApplying the general formula for $E(k)$:\n- For $\\delta = 0$: The term is $e^{ik \\cdot 0} H_{0,0} = 1 \\cdot \\varepsilon_0 = \\varepsilon_0$.\n- For $\\delta = +a$: The term is $e^{ik a} H_{0,a} = e^{ika} t$.\n- For $\\delta = -a$: The term is $e^{ik (-a)} H_{0,-a} = e^{-ika} t$.\n\nSumming these contributions gives the energy dispersion for the $1$D chain:\n$$\nE(k) = \\varepsilon_0 + t(e^{ika} + e^{-ika})\n$$\nUsing Euler's formula, $e^{ix} + e^{-ix} = 2\\cos(x)$, we obtain the final analytic expression:\n$$\nE(k) = \\varepsilon_0 + 2t \\cos(ka)\n$$\n\n**Two-Dimensional ($2$D) Square Lattice**\n\nFor a $2$D square lattice with lattice constant $a$, the sites are at positions $\\mathbf{R} = (n_x a, n_y a)$. The crystal momentum is a vector $\\mathbf{k} = (k_x, k_y)$. The nearest neighbors of a site are at displacements $\\boldsymbol{\\delta} \\in \\{ (a, 0), (-a, 0), (0, a), (0, -a) \\}$.\nWe again apply the sum over displacement vectors $\\boldsymbol{\\delta}$:\n- For $\\boldsymbol{\\delta} = (0, 0)$: The term is $e^{i\\mathbf{k} \\cdot \\mathbf{0}} H_{\\mathbf{0},\\mathbf{0}} = 1 \\cdot \\varepsilon_0 = \\varepsilon_0$.\n- For $\\boldsymbol{\\delta} = (a, 0)$: The term is $e^{i\\mathbf{k} \\cdot (a,0)} H_{\\mathbf{0},(a,0)} = e^{ik_xa} t$.\n- For $\\boldsymbol{\\delta} = (-a, 0)$: The term is $e^{i\\mathbf{k} \\cdot (-a,0)} H_{\\mathbf{0},(-a,0)} = e^{-ik_xa} t$.\n- For $\\boldsymbol{\\delta} = (0, a)$: The term is $e^{i\\mathbf{k} \\cdot (0,a)} H_{\\mathbf{0},(0,a)} = e^{ik_ya} t$.\n- For $\\boldsymbol{\\delta} = (0, -a)$: The term is $e^{i\\mathbf{k} \\cdot (0,-a)} H_{\\mathbf{0},(0,-a)} = e^{-ik_ya} t$.\n\nSumming all contributions:\n$$\nE(\\mathbf{k}) = \\varepsilon_0 + t(e^{ik_xa} + e^{-ik_xa}) + t(e^{ik_ya} + e^{-ik_ya})\n$$\nUsing Euler's formula for both the $x$ and $y$ components, we get the final analytic expression for the $2$D square lattice:\n$$\nE(k_x, k_y) = \\varepsilon_0 + 2t (\\cos(k_x a) + \\cos(k_y a))\n$$\n\n**Numerical Validation and Error Analysis**\n\nThe problem requires a program to perform a self-consistent validation. This involves $2$ calculations of the energy dispersion over a grid of $\\mathbf{k}$-points in the first Brillouin Zone.\n1.  **Numerical Energy ($E_{\\text{num}}$)**: This is computed by directly implementing the discrete Fourier transform $E(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} H_{\\mathbf{0}, \\boldsymbol{\\delta}}$. For the single-orbital case, this sum gives the $1 \\times 1$ Bloch Hamiltonian, which is the energy itself. In the code, this corresponds to summing complex exponential terms.\n2.  **Analytical Energy ($E_{\\text{ana}}$)**: This is computed using the simplified real-valued expressions derived above, which involve cosine functions.\n\nThe difference between these $2$ methods should theoretically be zero. In practice, due to finite-precision floating-point arithmetic, there might be minuscule differences on the order of machine epsilon. The purpose of the calculation is to verify that these $2$ computational paths yield identical results to within this precision, thus validating the implementation of the general numerical scheme against the specific analytical solution.\n\nTwo error norms are calculated over the set of $M$ sampled $\\mathbf{k}$-points:\n- The uniform norm or $L_\\infty$ norm, which measures the maximum absolute deviation:\n$$\nL_\\infty = \\max_{i=1 \\dots M} |E_{\\text{num}}(\\mathbf{k}_i) - E_{\\text{ana}}(\\mathbf{k}_i)|\n$$\n- The root-mean-square (RMS) norm, or $L_2$ norm, which measures the average deviation:\n$$\nL_2 = \\sqrt{\\frac{1}{M} \\sum_{i=1}^{M} (E_{\\text{num}}(\\mathbf{k}_i) - E_{\\text{ana}}(\\mathbf{k}_i))^2}\n$$\nGiven the mathematical equivalence of the $2$ energy expressions, both norms are expected to be close to $0$. The required rounding to $12$ decimal places should result in exactly $0.0$ for all test cases. This confirms the correctness of the physics implementation and the derivations. The provided code implements this validation procedure for the specified test cases.", "answer": "```python\nimport numpy as np\n\ndef calculate_norms(case):\n    \"\"\"\n    Calculates numerical and analytical energies and their error norms for a given test case.\n    \"\"\"\n    dim, a, eps0, t, Nk_x, Nk_y = case['dim'], case['a'], case['eps0'], case['t'], case['Nk_x'], case.get('Nk_y')\n\n    if dim == 1:\n        # Generate 1D k-point grid\n        if Nk_x == 1:\n            k_vals = np.array([0.0])\n        else:\n            k_vals = np.linspace(-np.pi / a, np.pi / a, Nk_x)\n        \n        # \"Numerical\" E_num from summing complex exponentials (Fourier transform of H_ij)\n        # For a single orbital model, the 1x1 Bloch Hamiltonian is the energy.\n        # H(k) = sum_{delta} exp(i*k*delta) * H_{0,delta}\n        # H_{0,0} = eps0, H_{0,a} = t, H_{0,-a} = t\n        H_k = eps0 + t * (np.exp(1j * k_vals * a) + np.exp(-1j * k_vals * a))\n        # Energy must be real since Hamiltonian is Hermitian.\n        E_num = np.real(H_k)\n\n        # \"Analytical\" E_ana from the derived simplified formula\n        E_ana = eps0 + 2 * t * np.cos(k_vals * a)\n        \n        diff = E_num - E_ana\n        \n    elif dim == 2:\n        # Generate 2D k-point grid\n        if Nk_x == 1:\n            kx_vals = np.array([0.0])\n        else:\n            kx_vals = np.linspace(-np.pi / a, np.pi / a, Nk_x)\n        \n        if Nk_y == 1:\n            ky_vals = np.array([0.0])\n        else:\n            ky_vals = np.linspace(-np.pi / a, np.pi / a, Nk_y)\n        \n        kx_grid, ky_grid = np.meshgrid(kx_vals, ky_vals)\n        \n        # \"Numerical\" E_num from summing complex exponentials\n        # H(k) = eps0 + t*exp(i*kx*a) + t*exp(-i*kx*a) + t*exp(i*ky*a) + t*exp(-i*ky*a)\n        term_x = t * (np.exp(1j * kx_grid * a) + np.exp(-1j * kx_grid * a))\n        term_y = t * (np.exp(1j * ky_grid * a) + np.exp(-1j * ky_grid * a))\n        H_k = eps0 + term_x + term_y\n        E_num = np.real(H_k)\n\n        # \"Analytical\" E_ana from the derived simplified formula\n        E_ana = eps0 + 2 * t * (np.cos(kx_grid * a) + np.cos(ky_grid * a))\n        \n        diff = E_num - E_ana\n\n    else:\n        raise ValueError(\"Dimension must be 1 or 2.\")\n        \n    # Calculate norms\n    l_inf_norm = np.max(np.abs(diff))\n    rms_norm = np.sqrt(np.mean(diff**2))\n    \n    # Round to 12 decimal places as required\n    return [round(l_inf_norm, 12), round(rms_norm, 12)]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Test Case 1 (1D general)\n        {'dim': 1, 'a': 0.246e-9, 'eps0': 0.3, 't': -2.7, 'Nk_x': 257},\n        # Test Case 2 (1D boundary)\n        {'dim': 1, 'a': 0.5e-9, 'eps0': 1.0, 't': 0.0, 'Nk_x': 1},\n        # Test Case 3 (2D general)\n        {'dim': 2, 'a': 0.35e-9, 'eps0': -0.2, 't': 1.1, 'Nk_x': 129, 'Nk_y': 127},\n        # Test Case 4 (2D symmetry/sign check)\n        {'dim': 2, 'a': 0.3e-9, 'eps0': 0.0, 't': -3.33, 'Nk_x': 31, 'Nk_y': 31},\n    ]\n\n    results = []\n    for case in test_cases:\n        norms = calculate_norms(case)\n        results.append(norms)\n\n    # Format the final output string to be exactly as requested, with no extra spaces.\n    # The str() representation of a list of lists has spaces after commas.\n    # str(results) -> '[[0.0, 0.0], [0.0, 0.0], ...]'\n    # We remove these spaces for exact formatting compliance.\n    output_str = str(results).replace(' ', '')\n    print(output_str)\n\nsolve()\n```", "id": "2866058"}]}