{"hands_on_practices": [{"introduction": "The foundation of the finite element method lies in the systematic construction of basis (or shape) functions that define the element's approximation capabilities. This exercise [@problem_id:2555221] focuses on the tensor-product construction, a powerful technique for generating basis functions for quadrilateral and hexahedral elements from simpler one-dimensional Lagrange polynomials. By explicitly building the basis for a 9-node biquadratic quadrilateral element ($\\mathcal{Q}_2$) and verifying its interpolating properties, you will gain a concrete understanding of how higher-order elements are formulated and why they can exactly represent any polynomial function contained within their own basis space.", "problem": "Consider the reference square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ with local coordinates $(\\xi,\\eta)$. Let $\\mathcal{Q}_p$ denote the family of tensor-product Lagrange quadrilateral elements consisting of all polynomials that are of degree at most $p$ in $\\xi$ and at most $p$ in $\\eta$. The nodal degrees of freedom (DOFs) are point evaluations at the tensor-product of $p+1$ distinct nodes on $[-1,1]$ in each coordinate. For the specific case $p=2$, take the univariate nodes $\\{-1,0,1\\}$ in both coordinates, so there are $9$ tensor-product nodes in total.\n\nUsing only the defining properties of univariate Lagrange interpolation and the tensor-product construction, do the following:\n\n1) Formulate the tensor-product basis functions for $\\mathcal{Q}_2$ on $\\hat{\\Omega}$ by first constructing the univariate Lagrange basis polynomials in each coordinate and then taking their products.\n\n2) Using these basis functions and nodal DOFs, construct the $\\mathcal{Q}_2$ nodal interpolant $I_{\\mathcal{Q}_2}u$ of the bivariate polynomial\n$$\nu(\\xi,\\eta) = \\xi^2 \\eta - \\xi \\eta^2.\n$$\nCompute the interpolant explicitly by evaluating the nodal DOFs and assembling the interpolant from the basis functions, and then simplify the resulting expression fully.\n\nReport your final result as a single simplified polynomial expression in $(\\xi,\\eta)$. No numerical rounding is required. The final answer must be a single closed-form analytic expression.", "solution": "The problem statement is examined for validity.\n\nStep 1: Extract Givens\n- Reference domain: Square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ with local coordinates $(\\xi,\\eta)$.\n- Element family: $\\mathcal{Q}_p$, the family of tensor-product Lagrange quadrilateral elements.\n- Polynomial space for $\\mathcal{Q}_p$: Polynomials of degree at most $p$ in $\\xi$ and at most $p$ in $\\eta$.\n- Nodal Degrees of Freedom (DOFs): Point evaluations at the tensor-product of $p+1$ distinct nodes on $[-1,1]$ in each coordinate.\n- Specific case: $p=2$.\n- Univariate nodes for $p=2$: The set $\\{-1,0,1\\}$ in each coordinate.\n- Total nodes for $p=2$: $9$ tensor-product nodes.\n- Task 1: Formulate the tensor-product basis functions for the $\\mathcal{Q}_2$ element.\n- Task 2: Construct the $\\mathcal{Q}_2$ nodal interpolant $I_{\\mathcal{Q}_2}u$ of the function $u(\\xi,\\eta) = \\xi^2 \\eta - \\xi \\eta^2$.\n- Required method: Explicit computation using the basis functions and nodal DOFs, followed by full simplification.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in the theory of the Finite Element Method. It is well-posed, providing all necessary information: the element type ($\\mathcal{Q}_2$), the reference domain, the specific nodes, the function to be interpolated, and the required methodology. The definitions and data are self-contained and consistent. The function $u(\\xi,\\eta) = \\xi^2\\eta - \\xi\\eta^2$ is in the polynomial space associated with the $\\mathcal{Q}_2$ element, which is the space of tensor-product polynomials of degree up to $2$ in each variable. Per the fundamental properties of Lagrange interpolation, the interpolant of a function already in the basis space must be the function itself. The problem requires a demonstration of this result through explicit construction, which is a valid and instructive exercise. The problem is not trivial or ill-posed. It is a formalizable and verifiable mathematical problem.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be constructed as requested.\n\nThe solution proceeds in two parts as dictated by the problem statement. First, the basis functions are constructed. Second, the interpolant is assembled and simplified.\n\nPart 1: Formulation of Basis Functions\n\nThe basis functions for the $\\mathcal{Q}_2$ element are constructed as a tensor product of the univariate Lagrange basis polynomials of degree $p=2$ on the interval $[-1,1]$. Let the univariate coordinate be denoted by $s$. The nodes are given as $s_1 = -1$, $s_2 = 0$, and $s_3 = 1$. The three univariate Lagrange basis polynomials, denoted $l_i(s)$ for $i \\in \\{-1, 0, 1\\}$, are defined by the property $l_i(s_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nThe general formula for the $k$-th Lagrange basis polynomial for a set of $n+1$ nodes $\\{x_0, ..., x_n\\}$ is $L_k(x) = \\prod_{j=0, j \\neq k}^{n} \\frac{x-x_j}{x_k-x_j}$. For our case, $n=2$ and the nodes are $\\{-1, 0, 1\\}$.\n\nFor the node $s=-1$:\n$$l_{-1}(s) = \\frac{s-0}{-1-0} \\cdot \\frac{s-1}{-1-1} = \\frac{s}{-1} \\cdot \\frac{s-1}{-2} = \\frac{1}{2}s(s-1) = \\frac{1}{2}s^2 - \\frac{1}{2}s$$\n\nFor the node $s=0$:\n$$l_{0}(s) = \\frac{s-(-1)}{0-(-1)} \\cdot \\frac{s-1}{0-1} = \\frac{s+1}{1} \\cdot \\frac{s-1}{-1} = -(s^2-1) = 1-s^2$$\n\nFor the node $s=1$:\n$$l_{1}(s) = \\frac{s-(-1)}{1-(-1)} \\cdot \\frac{s-0}{1-0} = \\frac{s+1}{2} \\cdot \\frac{s}{1} = \\frac{1}{2}s(s+1) = \\frac{1}{2}s^2 + \\frac{1}{2}s$$\n\nThe $9$ bivariate tensor-product basis functions for the $\\mathcal{Q}_2$ element on $\\hat{\\Omega}$ are given by $N_{ij}(\\xi,\\eta) = l_i(\\xi)l_j(\\eta)$, where $i,j \\in \\{-1, 0, 1\\}$. These functions are associated with the $9$ nodes $(\\xi_i, \\eta_j)$.\n\nPart 2: Construction and Simplification of the Interpolant\n\nThe nodal interpolant $I_{\\mathcal{Q}_2}u$ of a function $u(\\xi,\\eta)$ is defined as:\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\sum_{i \\in \\{-1,0,1\\}} \\sum_{j \\in \\{-1,0,1\\}} u(\\xi_i, \\eta_j) N_{ij}(\\xi,\\eta) $$\nwhere $(\\xi_i, \\eta_j)$ is the grid of $9$ nodes. The function to be interpolated is $u(\\xi,\\eta) = \\xi^2 \\eta - \\xi \\eta^2$.\n\nFirst, we must evaluate the nodal values $u(\\xi_i, \\eta_j)$:\n- $u(-1, -1) = (-1)^2(-1) - (-1)(-1)^2 = -1 - (-1) = 0$\n- $u(-1, 0) = (-1)^2(0) - (-1)(0)^2 = 0 - 0 = 0$\n- $u(-1, 1) = (-1)^2(1) - (-1)(1)^2 = 1 - (-1) = 2$\n- $u(0, -1) = (0)^2(-1) - (0)(-1)^2 = 0 - 0 = 0$\n- $u(0, 0) = (0)^2(0) - (0)(0)^2 = 0 - 0 = 0$\n- $u(0, 1) = (0)^2(1) - (0)(1)^2 = 0 - 0 = 0$\n- $u(1, -1) = (1)^2(-1) - (1)(-1)^2 = -1 - 1 = -2$\n- $u(1, 0) = (1)^2(0) - (1)(0)^2 = 0 - 0 = 0$\n- $u(1, 1) = (1)^2(1) - (1)(1)^2 = 1 - 1 = 0$\n\nThe only non-zero nodal values are $u(-1,1)=2$ and $u(1,-1)=-2$. Thus, the summation for the interpolant simplifies to only two terms:\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = u(-1,1) N_{-1,1}(\\xi,\\eta) + u(1,-1) N_{1,-1}(\\xi,\\eta) $$\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = 2 \\cdot N_{-1,1}(\\xi,\\eta) - 2 \\cdot N_{1,-1}(\\xi,\\eta) $$\n\nWe now substitute the expressions for the corresponding basis functions:\n$N_{-1,1}(\\xi,\\eta) = l_{-1}(\\xi) l_1(\\eta) = \\left(\\frac{1}{2}\\xi(\\xi-1)\\right) \\left(\\frac{1}{2}\\eta(\\eta+1)\\right) = \\frac{1}{4}\\xi\\eta(\\xi-1)(\\eta+1)$\n$N_{1,-1}(\\xi,\\eta) = l_1(\\xi) l_{-1}(\\eta) = \\left(\\frac{1}{2}\\xi(\\xi+1)\\right) \\left(\\frac{1}{2}\\eta(\\eta-1)\\right) = \\frac{1}{4}\\xi\\eta(\\xi+1)(\\eta-1)$\n\nSubstituting these into the interpolant formula:\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = 2 \\left( \\frac{1}{4}\\xi\\eta(\\xi-1)(\\eta+1) \\right) - 2 \\left( \\frac{1}{4}\\xi\\eta(\\xi+1)(\\eta-1) \\right) $$\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\frac{1}{2}\\xi\\eta \\left[ (\\xi-1)(\\eta+1) - (\\xi+1)(\\eta-1) \\right] $$\n\nNow, simplify the expression inside the brackets:\n$$ (\\xi-1)(\\eta+1) = \\xi\\eta + \\xi - \\eta - 1 $$\n$$ (\\xi+1)(\\eta-1) = \\xi\\eta - \\xi + \\eta - 1 $$\nThe difference is:\n$$ (\\xi\\eta + \\xi - \\eta - 1) - (\\xi\\eta - \\xi + \\eta - 1) = \\xi\\eta + \\xi - \\eta - 1 - \\xi\\eta + \\xi - \\eta + 1 = 2\\xi - 2\\eta = 2(\\xi-\\eta) $$\nSubstitute this result back into the expression for the interpolant:\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\frac{1}{2}\\xi\\eta \\left[ 2(\\xi-\\eta) \\right] $$\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\xi\\eta(\\xi-\\eta) $$\nFinally, expanding this expression gives the simplified polynomial form:\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\xi^2\\eta - \\xi\\eta^2 $$\nThis result is identical to the original function $u(\\xi,\\eta)$, which is the expected outcome because $u(\\xi,\\eta)$ is an element of the polynomial space spanned by the $\\mathcal{Q}_2$ basis functions. The explicit construction confirms the theoretical property of interpolation.", "answer": "$$\n\\boxed{\\xi^{2}\\eta - \\xi\\eta^{2}}\n$$", "id": "2555221"}, {"introduction": "Once an element is formulated, it is essential to verify its correctness and predictive capability. The patch test is a fundamental benchmark that any valid finite element must pass to ensure convergence to the true solution upon mesh refinement. This practice [@problem_id:2555200] provides a tangible demonstration of the patch test for the workhorse bilinear quadrilateral ($\\mathcal{Q}_1$) element in a linear elasticity context. By showing that a patch of elements can exactly reproduce a state of constant strain and satisfy nodal equilibrium, you will confirm the element's consistency and its ability to correctly model fundamental deformation states.", "problem": "Consider the Finite Element Method (FEM) for a two-dimensional, linear-elastic, plane-strain body occupying the L-shaped, three-element patch\n$$\\Omega = \\big([0,1] \\times [0,1]\\big) \\cup \\big([1,2] \\times [0,1]\\big) \\cup \\big([0,1] \\times [1,2]\\big),$$\ncomposed of three isoparametric bilinear quadrilateral elements, commonly denoted as a $Q_1$ quadrilateral family. Let the node set be the eight corner points\n$$(0,0),\\ (1,0),\\ (2,0),\\ (0,1),\\ (1,1),\\ (2,1),\\ (0,2),\\ (1,2),$$\nwith element connectivities (counterclockwise) given by\n$$\\text{Element } 1:\\ (0,0)\\text{-}(1,0)\\text{-}(1,1)\\text{-}(0,1),$$\n$$\\text{Element } 2:\\ (1,0)\\text{-}(2,0)\\text{-}(2,1)\\text{-}(1,1),$$\n$$\\text{Element } 3:\\ (0,1)\\text{-}(1,1)\\text{-}(1,2)\\text{-}(0,2).$$\nAssume an isotropic, homogeneous, linear-elastic constitutive law in plane strain with Lamé parameters $\\lambda>0$ and $\\mu>0$, relating the Cauchy stress tensor $\\boldsymbol{\\sigma}$ and the small-strain tensor $\\boldsymbol{\\varepsilon}$ by $\\boldsymbol{\\sigma} = \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}$. There are no body forces, i.e., $\\mathbf{b}=\\mathbf{0}$.\n\nPrescribe the exact linear displacement field\n$$\\mathbf{u}(x,y) = \\begin{pmatrix} 1 + 2x - 3y \\\\ -2 + 4x + y \\end{pmatrix},$$\nand impose on the outer boundary $\\Gamma$ of the patch the Neumann traction $\\mathbf{t} = \\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathbf{n}$, where $\\mathbf{n}$ is the outward unit normal. Use standard isoparametric $Q_1$ elements with full $2 \\times 2$ Gauss integration for element domain integrals and standard $2$-point Gauss integration along each boundary edge for consistent nodal tractions.\n\nLet $\\mathbf{d}$ be the vector of nodal displacement values obtained by sampling $\\mathbf{u}(x,y)$ at the patch nodes. Assemble the global internal nodal force vector\n$$\\mathbf{f}_{\\mathrm{int}} = \\sum_{e} \\int_{\\Omega_e} \\mathbf{B}_e(\\mathbf{x})^{\\top}\\,\\boldsymbol{\\sigma}(\\mathbf{u}_h)\\, \\mathrm{d}\\Omega,$$\nand the global external nodal force vector\n$$\\mathbf{f}_{\\mathrm{ext}} = \\int_{\\Gamma} \\mathbf{N}(\\mathbf{x})^{\\top}\\,\\mathbf{t} \\,\\mathrm{d}\\Gamma,$$\nwhere $\\mathbf{u}_h$ is the finite element displacement field interpolated from $\\mathbf{d}$, $\\mathbf{B}_e$ is the symmetric-gradient operator applied to the element shape functions, and $\\mathbf{N}$ is the matrix of shape functions mapping nodal values to boundary displacements. Define the global residual\n$$\\mathbf{r} = \\mathbf{f}_{\\mathrm{int}} - \\mathbf{f}_{\\mathrm{ext}}.$$\n\nCompute the Euclidean norm $\\|\\mathbf{r}\\|_{2}$ of the global residual for this three-element patch under the given data and numerical integration rules. Express your final answer as a dimensionless real number. No rounding is required; provide the exact value.", "solution": "We proceed from first principles: the strong form of equilibrium for a linear elastic body with no body forces is\n$$\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}) = \\mathbf{0} \\ \\text{in}\\ \\Omega,$$\nwith the boundary condition on the Neumann portion $\\Gamma$ given by\n$$\\mathbf{t} = \\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathbf{n} \\ \\text{on}\\ \\Gamma.$$\nThe constitutive law in plane strain is\n$$\\boldsymbol{\\sigma}(\\mathbf{u}) = \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon}(\\mathbf{u}))\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}), \\quad \\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\big(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\big).$$\n\nStep $1$: Show that the exact field is linear and produces constant strain and stress. The prescribed displacement field is\n$$\\mathbf{u}(x,y) = \\begin{pmatrix} 1 + 2x - 3y \\\\ -2 + 4x + y \\end{pmatrix},$$\nwhich is linear in $x$ and $y$. Its gradient is constant:\n$$\\nabla \\mathbf{u} = \\begin{pmatrix} \\partial_x u_x & \\partial_y u_x \\\\ \\partial_x u_y & \\partial_y u_y \\end{pmatrix} = \\begin{pmatrix} 2 & -3 \\\\ 4 & 1 \\end{pmatrix}.$$\nHence the small-strain tensor is constant:\n$$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\big(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\big) = \\tfrac{1}{2} \\begin{pmatrix} 2+2 & -3+4 \\\\ -3+4 & 1+1 \\end{pmatrix} = \\begin{pmatrix} 2 & \\tfrac{1}{2} \\\\ \\tfrac{1}{2} & 1 \\end{pmatrix}.$$\nTherefore the Cauchy stress tensor $\\boldsymbol{\\sigma}(\\mathbf{u})$ is constant in $\\Omega$:\n$$\\boldsymbol{\\sigma}(\\mathbf{u}) = \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon}(\\mathbf{u}))\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\lambda \\,(3)\\,\\mathbf{I} + 2\\mu \\begin{pmatrix} 2 & \\tfrac{1}{2} \\\\ \\tfrac{1}{2} & 1 \\end{pmatrix} = \\begin{pmatrix} 3\\lambda + 4\\mu & \\mu \\\\ \\mu & 3\\lambda + 2\\mu \\end{pmatrix}.$$\nBecause $\\boldsymbol{\\sigma}$ is constant, its divergence vanishes:\n$$\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}) = \\mathbf{0}.$$\n\nStep $2$: Interpolation by the isoparametric bilinear quadrilateral ($Q_1$) reproduces any linear field exactly on a rectilinear mesh. The $Q_1$ shape functions on each element span all polynomials that are at most linear in $x$ and $y$ when the element mapping is affine. On the present patch, each element is a rectangle, so the isoparametric mapping from the parent coordinates to global coordinates is affine with a constant Jacobian. Therefore, the finite element interpolant $\\mathbf{u}_h$ built from nodal values $\\mathbf{d}$ sampled from $\\mathbf{u}(x,y)$ satisfies\n$$\\mathbf{u}_h(\\mathbf{x}) \\equiv \\mathbf{u}(\\mathbf{x}) \\ \\text{for all}\\ \\mathbf{x} \\in \\Omega,$$\nand thus\n$$\\boldsymbol{\\varepsilon}(\\mathbf{u}_h) \\equiv \\boldsymbol{\\varepsilon}(\\mathbf{u}), \\quad \\boldsymbol{\\sigma}(\\mathbf{u}_h) \\equiv \\boldsymbol{\\sigma}(\\mathbf{u}),$$\nboth of which are constant on each element and, here, globally constant on $\\Omega$.\n\nStep $3$: Element-level internal forces and boundary tractions under full integration. The internal force vector for an element $e$ can be written as\n$$\\mathbf{f}_{\\mathrm{int}}^{(e)} = \\int_{\\Omega_e} \\mathbf{B}_e(\\mathbf{x})^{\\top}\\,\\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathrm{d}\\Omega,$$\nwhere $\\mathbf{B}_e$ collects the symmetric gradients of the $Q_1$ shape functions. On a rectangular element, $\\mathbf{B}_e(\\mathbf{x})$ is at most linear in the parent coordinates, and $\\boldsymbol{\\sigma}(\\mathbf{u}_h)$ is constant. Therefore, the integrand is at most linear in each parent coordinate. Full $2 \\times 2$ Gauss integration on rectangles integrates exactly any polynomial integrand that is at most cubic in each parent coordinate, so this domain integral is evaluated exactly. Similarly, the consistent external nodal forces along each boundary edge are\n$$\\mathbf{f}_{\\mathrm{ext}} = \\int_{\\Gamma} \\mathbf{N}(\\mathbf{x})^{\\top}\\,\\mathbf{t}\\,\\mathrm{d}\\Gamma = \\sum_{\\text{edges}} \\int_{\\Gamma_{\\text{edge}}} \\mathbf{N}(\\mathbf{x})^{\\top}\\,\\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathbf{n}\\,\\mathrm{d}\\Gamma,$$\nwith $\\mathbf{N}$ linear along each straight edge. Since $\\mathbf{t}$ is constant on each straight edge (because $\\boldsymbol{\\sigma}(\\mathbf{u})$ is constant and $\\mathbf{n}$ is constant on a straight edge), the integrand is linear along each edge, and standard $2$-point Gauss quadrature on edges integrates it exactly.\n\nStep $4$: Nodal equilibrium via the divergence theorem. For any nodal test function vector $\\mathbf{w}_h$ spanned by the $Q_1$ basis, the weak form reads\n$$\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{w}_h) : \\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathrm{d}\\Omega - \\int_{\\Gamma} \\mathbf{w}_h \\cdot \\mathbf{t}\\,\\mathrm{d}\\Gamma = 0.$$\nChoosing $\\mathbf{w}_h$ to be each canonical nodal basis vector in turn yields the assembled residual components. Because $\\boldsymbol{\\sigma}(\\mathbf{u}_h)$ is constant and satisfies $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h) = \\mathbf{0}$, the divergence theorem gives, for each scalar shape function $N_i$ and each Cartesian component,\n$$\\int_{\\Omega} \\nabla N_i \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathbf{e}_k\\,\\mathrm{d}\\Omega = \\int_{\\Gamma} N_i \\,\\mathbf{e}_k \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathbf{n}\\,\\mathrm{d}\\Gamma - \\int_{\\Omega} N_i \\,\\nabla \\cdot \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathbf{e}_k\\big)\\,\\mathrm{d}\\Omega = \\int_{\\Gamma} N_i \\,\\mathbf{t}_k\\,\\mathrm{d}\\Gamma,$$\nwhere $\\mathbf{e}_k$ is the $k$-th unit vector and $\\mathbf{t}_k$ is the $k$-th component of $\\mathbf{t}$. Thus, at the continuous level, each residual component vanishes exactly. Because both the domain and boundary integrals are evaluated exactly by the chosen full integration rules (as shown in Step $3$), the discrete assembled residual vector equals the exact continuous residual, hence\n$$\\mathbf{r} = \\mathbf{f}_{\\mathrm{int}} - \\mathbf{f}_{\\mathrm{ext}} = \\mathbf{0}.$$\n\nStep $5$: Euclidean norm of the residual. Since $\\mathbf{r}=\\mathbf{0}$, its Euclidean norm is\n$$\\|\\mathbf{r}\\|_{2} = 0.$$\n\nThis conclusion hinges on three facts: the linear completeness of the $Q_1$ quadrilateral space on rectangles, the constancy of the exact stress under a linear displacement field, and the exactness of the specified full Gaussian quadrature rules for the resulting polynomial integrands. Therefore, the requested dimensionless scalar is exactly zero.", "answer": "$$\\boxed{0}$$", "id": "2555200"}, {"introduction": "In practical applications, numerical analysts often employ techniques like reduced integration to lower computational cost and alleviate locking phenomena. However, this can introduce non-physical, zero-energy deformation patterns known as \"hourglass\" modes, which can corrupt the solution. This advanced exercise [@problem_id:2555223] delves into the critical topic of diagnosing and curing these element pathologies. You will learn to identify the kinematic signature of an hourglass mode in an underintegrated quadrilateral element and, more importantly, derive a physically-based stabilization parameter $\\alpha$ to restore the element's coercivity and ensure a robust simulation.", "problem": "Consider a single isoparametric bilinear quadrilateral element (commonly denoted as a $Q4$ element) in two-dimensional linear elasticity under plane strain. The element is a square of side length $L$, with nodes labeled counterclockwise starting at the lower-left corner, and physical coordinates $\\{(0,0),\\,(L,0),\\,(L,L),\\,(0,L)\\}$. The material is homogeneous and isotropic with Lamé parameters $\\lambda$ and $\\mu$, and the strain energy density is given by the standard linear elastic form. In the Finite Element Method (FEM), the element stiffness using one-point Gauss quadrature (underintegration) is rank-deficient and admits spurious zero-energy “hourglass” modes.\n\nStart from the definitions of the bilinear shape functions on the parent square $\\{(\\xi,\\eta)\\in[-1,1]^2\\}$, the isoparametric mapping to the physical element, the small-strain tensor $\\boldsymbol{\\varepsilon}=\\nabla^{s}\\boldsymbol{u}$, and the elastic energy density $w(\\boldsymbol{\\varepsilon})=\\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}+\\frac{\\lambda}{2}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^{2}$. Use the following procedure.\n\n1) Identify two linearly independent, non-rigid-body, zero-energy displacement patterns (hourglass modes) admitted by the one-point underintegrated $Q4$ stiffness. Concretely, search for nodal displacement vectors $\\boldsymbol{u}_{\\mathrm{hg}}$ such that the constant-strain operator evaluated at the element centroid annihilates them, i.e., the three strain components computed from the centroidal strain-displacement matrix are zero.\n\n2) Define an element-level stabilization functional that penalizes these two hourglass modes via the hourglass generalized coordinates\n$$\nq_{1}=\\frac{u_{1x}-u_{2x}+u_{3x}-u_{4x}}{2},\\qquad\nq_{2}=\\frac{u_{1y}-u_{2y}+u_{3y}-u_{4y}}{2},\n$$\nand an added stabilization energy\n$$\nE_{\\mathrm{stab}}=\\alpha\\left(q_{1}^{2}+q_{2}^{2}\\right),\n$$\nwhere $\\alpha$ is a scalar stabilization parameter to be chosen.\n\n3) Determine $\\alpha$ by the following coercivity-restoring and consistency-matching criterion: for each of the two hourglass displacement patterns from part (1), the stabilization energy $E_{\\mathrm{stab}}$ added to the underintegrated element must equal the exact element strain energy obtained by fully integrating (with a $2\\times 2$ Gauss rule) the elastic energy density of the corresponding bilinear displacement field with those nodal values.\n\nExpress your final answer as a single closed-form expression for $\\alpha$ in terms of $\\lambda$ and $\\mu$. No numerical approximation or rounding is required, and no units should be included in the final boxed answer.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Element: A single isoparametric bilinear quadrilateral ($Q4$) element.\n- Physics: 2D linear elasticity, plane strain conditions.\n- Geometry: Square element of side length $L$, with physical coordinates for nodes 1-4 being $(0,0)$, $(L,0)$, $(L,L)$, and $(0,L)$ respectively.\n- Material: Homogeneous, isotropic, with Lamé parameters $\\lambda$ and $\\mu$.\n- Strain energy density: $w(\\boldsymbol{\\varepsilon})=\\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}+\\frac{\\lambda}{2}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^{2}$.\n- FEM procedure: Use of one-point Gauss quadrature, which is underintegration.\n- Task: Determine the stabilization parameter $\\alpha$ for an hourglass control scheme.\n- Hourglass coordinates: $q_{1}=\\frac{u_{1x}-u_{2x}+u_{3x}-u_{4x}}{2}$ and $q_{2}=\\frac{u_{1y}-u_{2y}+u_{3y}-u_{4y}}{2}$.\n- Stabilization energy: $E_{\\mathrm{stab}}=\\alpha\\left(q_{1}^{2}+q_{2}^{2}\\right)$.\n- Criterion for $\\alpha$: For the two fundamental hourglass displacement modes, the stabilization energy $E_{\\mathrm{stab}}$ must equal the exact element strain energy calculated using a full $2 \\times 2$ Gauss quadrature.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a classic and fundamental topic in the theory of the Finite Element Method. The concepts of isoparametric mapping, plane strain elasticity, underintegration, and hourglass instability are standard in computational mechanics. All provided formulae are correct and well-established.\n- **Well-Posed:** The problem is well-defined. It provides a clear procedure and a specific criterion to determine a unique value for the parameter $\\alpha$. All necessary information is provided.\n- **Objective:** The language is formal, precise, and free of any subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous solution can be constructed.\n\n**Solution Derivation**\n\nThe solution requires determining the stabilization parameter $\\alpha$ by matching the prescribed stabilization energy to the exact elastic energy of the hourglass deformation modes. We assume unit thickness for the plane strain element, so all \"energy\" calculations refer to energy per unit thickness.\n\nFirst, we establish the relationship between the physical coordinates $(x,y)$ and the parent coordinates $(\\xi, \\eta) \\in [-1,1]^2$. The bilinear shape functions are $N_{1}(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_{2}(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_{3}(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$, and $N_{4}(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$. The isoparametric mapping $x(\\xi,\\eta) = \\sum_i N_i(\\xi, \\eta) x_i$ and $y(\\xi,\\eta) = \\sum_i N_i(\\xi, \\eta) y_i$ for the given square element yields:\n$$x(\\xi,\\eta) = \\frac{L}{2}(1+\\xi)$$\n$$y(\\xi,\\eta) = \\frac{L}{2}(1+\\eta)$$\nThe Jacobian matrix of this transformation is constant:\n$$\\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L}{2} & 0 \\\\ 0 & \\frac{L}{2} \\end{pmatrix}$$\nThe determinant is $\\det(\\boldsymbol{J}) = \\frac{L^2}{4}$, and the inverse is $\\boldsymbol{J}^{-1} = \\frac{2}{L}\\boldsymbol{I}$.\n\nThe hourglass modes are displacement patterns that produce zero strain at the element center $(\\xi, \\eta) = (0,0)$. These modes are proportional to the term $\\xi\\eta$, which is zero along the axes $\\xi=0$ and $\\eta=0$. The fundamental hourglass shape function, $N_{\\mathrm{hg}}(\\xi,\\eta)$, is given by the linear combination:\n$$N_{\\mathrm{hg}}(\\xi,\\eta) = N_1 - N_2 + N_3 - N_4 = \\xi\\eta$$\nThe corresponding nodal vector is $\\boldsymbol{h}^{*} = (1, -1, 1, -1)^T$.\n\nA general hourglass displacement field, characterized by the generalized coordinates $q_1$ and $q_2$, can be written as:\n$$u_x(\\xi, \\eta) = c_1 N_{\\mathrm{hg}}(\\xi,\\eta) = c_1 \\xi\\eta$$\n$$u_y(\\xi, \\eta) = c_2 N_{\\mathrm{hg}}(\\xi,\\eta) = c_2 \\xi\\eta$$\nThe amplitudes $c_1$ and $c_2$ are related to $q_1$ and $q_2$. The nodal displacements are $u_{ix} = c_1 (\\xi_i \\eta_i) = c_1 h^*_i$ and $u_{iy} = c_2 (\\xi_i \\eta_i) = c_2 h^*_i$.\nUsing the definitions of $q_1$ and $q_2$:\n$$q_1 = \\frac{1}{2}\\sum_{i=1}^4 h^*_i u_{ix} = \\frac{1}{2}\\sum_{i=1}^4 h^*_i (c_1 h^*_i) = \\frac{c_1}{2}\\sum_{i=1}^4 (h^*_i)^2 = \\frac{c_1}{2}(4) = 2c_1 \\implies c_1 = \\frac{q_1}{2}$$\n$$q_2 = \\frac{1}{2}\\sum_{i=1}^4 h^*_i u_{iy} = \\frac{1}{2}\\sum_{i=1}^4 h^*_i (c_2 h^*_i) = \\frac{c_2}{2}\\sum_{i=1}^4 (h^*_i)^2 = 2c_2 \\implies c_2 = \\frac{q_2}{2}$$\nSo, the hourglass displacement field is:\n$$u_x(\\xi,\\eta) = \\frac{q_1}{2}\\xi\\eta, \\quad u_y(\\xi,\\eta) = \\frac{q_2}{2}\\xi\\eta$$\nwhere $q_1$ and $q_2$ have units of length.\n\nNext, we compute the strain tensor field $\\boldsymbol{\\varepsilon}$ for this displacement field.\nThe gradient operator is $\\nabla_{\\boldsymbol{x}} = \\boldsymbol{J}^{-T} \\nabla_{\\boldsymbol{\\xi}} = \\frac{2}{L}\\nabla_{\\boldsymbol{\\xi}}$.\n$$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{2}{L}\\frac{\\partial u_x}{\\partial\\xi} = \\frac{2}{L}\\left(\\frac{q_1}{2}\\eta\\right) = \\frac{q_1\\eta}{L}$$\n$$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{2}{L}\\frac{\\partial u_y}{\\partial\\eta} = \\frac{2}{L}\\left(\\frac{q_2}{2}\\xi\\right) = \\frac{q_2\\xi}{L}$$\n$$2\\varepsilon_{xy} = \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\frac{2}{L}\\left(\\frac{\\partial u_x}{\\partial\\eta} + \\frac{\\partial u_y}{\\partial\\xi}\\right) = \\frac{2}{L}\\left(\\frac{q_1}{2}\\xi + \\frac{q_2}{2}\\eta\\right) = \\frac{q_1\\xi + q_2\\eta}{L}$$\nThus, $\\varepsilon_{xy} = \\frac{q_1\\xi + q_2\\eta}{2L}$. The strains are correctly dimensionless.\n\nNow we compute the strain energy density $w(\\boldsymbol{\\varepsilon})$.\n$$\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx} + \\varepsilon_{yy} = \\frac{q_1\\eta + q_2\\xi}{L}$$\n$$\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} = \\varepsilon_{xx}^2 + \\varepsilon_{yy}^2 + 2\\varepsilon_{xy}^2 = \\left(\\frac{q_1\\eta}{L}\\right)^2 + \\left(\\frac{q_2\\xi}{L}\\right)^2 + 2\\left(\\frac{q_1\\xi + q_2\\eta}{2L}\\right)^2$$\n$$w = \\mu \\left[ \\frac{q_1^2\\eta^2}{L^2} + \\frac{q_2^2\\xi^2}{L^2} + \\frac{(q_1\\xi + q_2\\eta)^2}{2L^2} \\right] + \\frac{\\lambda}{2} \\frac{(q_1\\eta + q_2\\xi)^2}{L^2}$$\n$$w = \\frac{1}{L^2} \\left\\{ \\mu \\left( q_1^2\\eta^2 + q_2^2\\xi^2 + \\frac{1}{2}(q_1^2\\xi^2 + q_2^2\\eta^2 + 2q_1q_2\\xi\\eta) \\right) + \\frac{\\lambda}{2} (q_1^2\\eta^2 + q_2^2\\xi^2 + 2q_1q_2\\xi\\eta) \\right\\}$$\nCollecting terms in $\\xi^2$, $\\eta^2$, and $\\xi\\eta$:\n$$w = \\frac{1}{L^2} \\left\\{ \\xi^2\\left(\\mu q_2^2 + \\frac{\\mu}{2}q_1^2 + \\frac{\\lambda}{2}q_2^2\\right) + \\eta^2\\left(\\mu q_1^2 + \\frac{\\mu}{2}q_2^2 + \\frac{\\lambda}{2}q_1^2\\right) + \\xi\\eta\\left(\\mu q_1q_2 + \\lambda q_1q_2\\right) \\right\\}$$\nThe total element strain energy (per unit thickness) is $E_{\\mathrm{exact}} = \\int_A w \\, dA = \\int_{-1}^1 \\int_{-1}^1 w(\\xi,\\eta) \\det(\\boldsymbol{J}) \\,d\\xi d\\eta$. With $\\det(\\boldsymbol{J}) = L^2/4$:\n$$E_{\\mathrm{exact}} = \\frac{L^2}{4} \\int_{-1}^1 \\int_{-1}^1 w(\\xi,\\eta) \\,d\\xi d\\eta$$\nThe $L^2$ terms cancel. We use the integrals $\\int_{-1}^1 \\int_{-1}^1 \\xi^2 \\,d\\xi d\\eta = \\frac{4}{3}$, $\\int_{-1}^1 \\int_{-1}^1 \\eta^2 \\,d\\xi d\\eta = \\frac{4}{3}$, and $\\int_{-1}^1 \\int_{-1}^1 \\xi\\eta \\,d\\xi d\\eta = 0$.\nThe term with $\\xi\\eta$ integrates to zero.\n$$E_{\\mathrm{exact}} = \\frac{1}{4} \\left[ \\frac{4}{3}\\left(\\mu q_2^2 + \\frac{\\mu}{2}q_1^2 + \\frac{\\lambda}{2}q_2^2\\right) + \\frac{4}{3}\\left(\\mu q_1^2 + \\frac{\\mu}{2}q_2^2 + \\frac{\\lambda}{2}q_1^2\\right) \\right]$$\n$$E_{\\mathrm{exact}} = \\frac{1}{3} \\left[ q_1^2\\left(\\frac{\\mu}{2}+\\mu+\\frac{\\lambda}{2}\\right) + q_2^2\\left(\\mu+\\frac{\\lambda}{2}+\\frac{\\mu}{2}\\right) \\right]$$\n$$E_{\\mathrm{exact}} = \\frac{1}{3} \\left[ q_1^2\\left(\\frac{3\\mu+\\lambda}{2}\\right) + q_2^2\\left(\\frac{3\\mu+\\lambda}{2}\\right) \\right]$$\n$$E_{\\mathrm{exact}} = \\left(\\frac{3\\mu+\\lambda}{6}\\right) (q_1^2 + q_2^2)$$\nThe stabilization energy is given as $E_{\\mathrm{stab}} = \\alpha (q_1^2 + q_2^2)$. The matching criterion requires $E_{\\mathrm{stab}} = E_{\\mathrm{exact}}$.\n$$\\alpha (q_1^2 + q_2^2) = \\left(\\frac{3\\mu+\\lambda}{6}\\right) (q_1^2 + q_2^2)$$\nThis directly yields the expression for the stabilization parameter $\\alpha$.\n$$\\alpha = \\frac{3\\mu+\\lambda}{6} = \\frac{\\mu}{2} + \\frac{\\lambda}{6}$$\nThe result is independent of the element size $L$ and the particular values of $q_1$ and $q_2$, as required for a material-based stabilization parameter.", "answer": "$$\\boxed{\\frac{\\lambda+3\\mu}{6}}$$", "id": "2555223"}]}