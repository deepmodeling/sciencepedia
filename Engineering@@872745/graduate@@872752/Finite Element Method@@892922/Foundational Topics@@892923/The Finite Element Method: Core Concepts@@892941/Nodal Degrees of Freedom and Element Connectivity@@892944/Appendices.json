{"hands_on_practices": [{"introduction": "The foundation of the finite element method rests on approximating solutions within each element using a polynomial basis. This first exercise connects this abstract idea to the concrete concepts of nodal degrees of freedom (DOFs) by asking you to determine the number and location of nodes for linear and quadratic tetrahedral elements from first principles. Mastering this connection is essential for understanding how the choice of element order—a key decision in any analysis—impacts the computational cost and accuracy of your model. [@problem_id:2583811]", "problem": "Consider the scalar Poisson problem $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a bounded domain $\\Omega \\subset \\mathbb{R}^{3}$ with appropriate boundary conditions, discretized by a conforming tetrahedral mesh. Suppose you construct a continuous Galerkin (CG) finite element method using standard Lagrange shape functions of total polynomial degree $p \\in \\{1,2\\}$ on each tetrahedral element $T$. In this setting, a nodal degree of freedom (DOF) corresponds to the value of the discrete field $u_{h}$ at an interpolation node associated with $T$, and the number of element-level DOFs equals the dimension of the local polynomial approximation space on $T$. \n\nStarting from first principles, do the following:\n1. From the characterization of monomials in three variables, determine the number of linearly independent polynomials of total degree at most $p$ on a tetrahedron for $p=1$ (linear) and $p=2$ (quadratic), and thus the number of nodal DOFs per tetrahedral element for a scalar unknown $u$ for each $p$.\n2. Identify where these nodal DOFs are geometrically located within a tetrahedral element (i.e., associated with vertices, edges, faces, and/or the interior) for $p=1$ and for $p=2$, consistent with standard Lagrange interpolation on tetrahedra.\n3. Based on your derivation, compute the increase in the number of element-level DOFs when moving from linear ($p=1$) to quadratic ($p=2$) tetrahedral elements for the scalar Poisson problem.\n\nReport only the increase in the number of DOFs per element as your final answer. No rounding is required, and no units are to be reported.", "solution": "The problem statement is subjected to validation before any attempt at a solution is made.\n\nFirst, the givens are extracted verbatim as required.\n- Problem: Scalar Poisson problem $-\\nabla \\cdot (\\kappa \\nabla u) = f$.\n- Domain: A bounded domain $\\Omega \\subset \\mathbb{R}^{3}$.\n- Mesh: A conforming tetrahedral mesh.\n- Method: Continuous Galerkin (CG) finite element method.\n- Shape functions: Standard Lagrange shape functions of total polynomial degree $p \\in \\{1,2\\}$.\n- Element type: A tetrahedral element $T$.\n- Nodal DOF definition: The value of the discrete field $u_{h}$ at an interpolation node associated with $T$.\n- Number of element-level DOFs: The dimension of the local polynomial approximation space on $T$.\n- Tasks:\n    1. Determine the number of linearly independent polynomials of total degree at most $p$ on a tetrahedron (i.e., the number of nodal DOFs) for $p=1$ and $p=2$.\n    2. Identify the geometric location of these nodal DOFs for $p=1$ and $p=2$.\n    3. Compute the increase in the number of element-level DOFs from $p=1$ to $p=2$.\n\nThe problem is now validated against the specified criteria.\n- **Scientifically Grounded**: The problem is a fundamental exercise in the theory of the finite element method. It deals with standard concepts: the Poisson equation, tetrahedral elements, Lagrange polynomials, and degrees of freedom. All premises are factually sound and central to computational mathematics.\n- **Well-Posed**: The problem is clearly stated and provides all necessary information to derive a unique, deterministic answer.\n- **Objective**: The language is formal, precise, and devoid of any subjective or non-scientific content.\n\nThe problem is therefore valid. It is a standard, well-posed question that can be answered rigorously from first principles. We proceed to the solution.\n\nThe number of nodal degrees of freedom (DOFs) for a scalar unknown on a single element corresponds to the dimension of the local polynomial space used for approximation. For a Lagrange element, this dimension is equal to the number of nodes required to uniquely define a polynomial of a given degree. We are asked to consider polynomials of total degree at most $p$ in three spatial dimensions $(x, y, z)$.\n\nThe space of polynomials of total degree at most $p$ in $d$ variables is denoted $\\mathcal{P}_p(\\mathbb{R}^d)$. The dimension of this space is the number of distinct monomials of the form $x_1^{\\alpha_1} x_2^{\\alpha_2} \\cdots x_d^{\\alpha_d}$ where the exponents $\\alpha_i$ are non-negative integers such that their sum is less than or equal to $p$: $\\sum_{i=1}^{d} \\alpha_i \\le p$.\n\nIn our case, the spatial dimension is $d=3$. The condition is $\\alpha_1 + \\alpha_2 + \\alpha_3 \\le p$. To count the number of such integer solutions, we can use a standard combinatorial argument, often referred to as \"stars and bars\". By introducing a slack variable $\\alpha_4 \\ge 0$, the inequality is transformed into an equality: $\\alpha_1 + \\alpha_2 + \\alpha_3 + \\alpha_4 = p$. The problem is now equivalent to finding the number of ways to distribute $p$ identical items (stars) into $d+1 = 4$ distinct bins (separated by $d=3$ bars). The formula for this is given by the binomial coefficient:\n$$ N_{\\text{dof}}(p, d) = \\binom{p+d}{d} $$\nFor our specific three-dimensional tetrahedral element, $d=3$, so the formula simplifies to:\n$$ N_{\\text{dof}}(p, 3) = \\binom{p+3}{3} $$\n\nWe now apply this formula for the specified polynomial degrees $p=1$ and $p=2$.\n\n1 . For linear elements, $p=1$.\nThe number of DOFs per element, $N_1$, is:\n$$ N_{1} = \\binom{1+3}{3} = \\binom{4}{3} = \\frac{4!}{3!(4-3)!} = \\frac{4!}{3!1!} = 4 $$\nThus, a linear tetrahedral element has $4$ DOFs. For a Lagrange element, these DOFs must uniquely determine a linear polynomial $P_1(x, y, z) = c_0 + c_1 x + c_2 y + c_3 z$. A tetrahedron is a geometric shape with $4$ vertices. Placing one node at each of the $4$ vertices provides the $4$ necessary and sufficient conditions to define the polynomial. Therefore, for $p=1$, the nodal DOFs are located at the $4$ vertices of the tetrahedron.\n\n2 . For quadratic elements, $p=2$.\nThe number of DOFs per element, $N_2$, is:\n$$ N_{2} = \\binom{2+3}{3} = \\binom{5}{3} = \\frac{5!}{3!(5-3)!} = \\frac{5!}{3!2!} = \\frac{5 \\times 4}{2 \\times 1} = 10 $$\nThus, a quadratic tetrahedral element has $10$ DOFs. To uniquely define a quadratic polynomial on the element, we need to place $10$ nodes. The geometric placement for standard Lagrange elements is determined by the unisolvence requirement. For continuity between elements, the nodes must be sufficient to uniquely define the polynomial trace on each face and edge. The trace of a $3$D quadratic polynomial on an edge (a line) is a $1$D quadratic polynomial. A $1$D quadratic requires $3$ points for its unique definition. An edge connects two vertices, so we must add one node to the interior of each edge. A tetrahedron has $4$ vertices and $6$ edges.\nThe locations of the $10$ nodes are therefore:\n- $4$ nodes at the vertices of the tetrahedron.\n- $6$ nodes at the midpoints of each of the $6$ edges.\nThis gives a total of $4 + 6 = 10$ nodes, which matches the dimension of the polynomial space. There are no nodes on the interior of the faces (other than the edges) and no nodes in the interior (volume) of the tetrahedron for the standard $p=2$ Lagrange element.\n\nFinally, we compute the increase in the number of element-level DOFs when moving from linear ($p=1$) to quadratic ($p=2$) elements.\nThe increase, $\\Delta N$, is the difference between the number of DOFs for the quadratic and linear cases:\n$$ \\Delta N = N_2 - N_1 = 10 - 4 = 6 $$\nThe increase in the number of element-level degrees of freedom is $6$.", "answer": "$$\\boxed{6}$$", "id": "2583811"}, {"introduction": "Once elements are assembled into a global system, the collective behavior of the degrees of freedom reveals important physical properties. For an unconstrained elastic body, certain displacement patterns correspond to rigid body motion, which generate no strain and thus no resistance from the material. This exercise challenges you to identify these modes from first principles and determine the minimum number of constraints needed to obtain a unique solution, a critical step in setting up any valid structural mechanics simulation. [@problem_id:2583823]", "problem": "Consider a simply connected three-dimensional elastic body discretized by standard isoparametric $8$-node hexahedral (trilinear) solid elements. Each node possesses exactly $3$ translational nodal degrees of freedom (DOFs), denoted by $u$, $v$, and $w$. The body undergoes small strains and small displacements, and the constitutive behavior is linear elastic with a positive-definite fourth-order elasticity tensor. No multipoint constraints, rotational DOFs, drilling DOFs, or penalty terms are present. Let $K_{e}$ be the element stiffness matrix obtained from the standard principle of virtual work and strain-displacement operator, and let $K$ be the assembled global stiffness matrix for the unconstrained mesh.\n\nStarting from the definition of the infinitesimal strain tensor $\\varepsilon(\\mathbf{u}) = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\right)$ and the fact that the internal elastic energy density depends quadratically on $\\varepsilon(\\mathbf{u})$, argue which displacement fields produce zero internal energy in the continuum limit and identify the corresponding nodal displacement patterns these induce in the discrete system. Use this to determine the dimension $r$ of the rigid body motion subspace for the $3$D body and hence the nullity of $K$ in the absence of essential boundary conditions. Then, reasoning from rank-nullity considerations and independence of constraints, determine the minimal number $N$ of independent nodal translational DOFs that must be prescribed on the boundary to render $K$ nonsingular for a connected domain without internal mechanisms. In your reasoning, you must also state a concrete example of a set of independent translational constraints that achieves this minimal number, using only nodal translations.\n\nProvide only the value of $N$ as your final answer. No rounding is needed, and no units are required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a fundamental question in the theory of the finite element method as applied to linear elastostatics. I shall proceed with the solution.\n\nThe internal elastic strain energy, $U$, stored within a deformable body occupying a volume $\\Omega$ is given by the integral of the strain energy density, $W(\\varepsilon)$, over the volume:\n$$\nU = \\int_{\\Omega} W(\\varepsilon) \\, dV\n$$\nThe problem states that the constitutive behavior is linear elastic with a positive-definite fourth-order elasticity tensor, $C$. The strain energy density is a quadratic form of the strain tensor, $\\varepsilon$:\n$$\nW(\\varepsilon) = \\frac{1}{2} \\varepsilon_{ij} C_{ijkl} \\varepsilon_{kl}\n$$\nwhere summation over repeated indices is implied. Since the tensor $C$ is positive-definite, the strain energy density $W(\\varepsilon)$ is zero if and only if the strain tensor $\\varepsilon$ is identically zero everywhere within the body. Consequently, the total internal energy $U$ is zero if and only if $\\varepsilon(\\mathbf{u}) = \\mathbf{0}$ for all points $\\mathbf{x} \\in \\Omega$.\n\nThe displacement fields $\\mathbf{u}(\\mathbf{x})$ that produce zero strain are found by solving the set of partial differential equations:\n$$\n\\varepsilon(\\mathbf{u}) = \\frac{1}{2} \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top} \\right) = \\mathbf{0}\n$$\nThis is the defining equation for rigid body motion in continuum mechanics. The general solution in three dimensions is a displacement field of the form:\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\mathbf{x}\n$$\nwhere $\\mathbf{a}$ is a constant vector representing an arbitrary rigid translation and $\\boldsymbol{\\omega}$ is a constant vector representing an arbitrary infinitesimal rigid rotation about the origin.\n\nThe vector $\\mathbf{a}$ has $3$ independent components ($a_x, a_y, a_z$) corresponding to translations along the coordinate axes. The vector $\\boldsymbol{\\omega}$ also has $3$ independent components ($\\omega_x, \\omega_y, \\omega_z$) corresponding to rotations about the coordinate axes. These two vectors define a $6$-dimensional vector space of displacement fields that result in zero strain and thus zero internal energy. These are the rigid body modes of the continuum. The dimension of this rigid body motion subspace is therefore $r = 3 (\\text{translations}) + 3 (\\text{rotations}) = 6$.\n\nIn the finite element discretization, the nodal displacements $\\mathbf{d}$ are related to the continuous displacement field $\\mathbf{u}$ by the shape functions. The unconstrained global stiffness matrix $K$ is positive semi-definite. Its null space consists of all nodal displacement vectors $\\mathbf{d}$ for which the strain energy is zero. Since the $8$-node hexahedral element has shape functions that are linear in each coordinate direction (trilinear), it can exactly represent any displacement field that is a linear function of the spatial coordinates $\\mathbf{x}$. The rigid body motion field $\\mathbf{u}(\\mathbf{x}) = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\mathbf{x}$ is a linear function of $\\mathbf{x} = (x, y, z)$. Therefore, the discrete system can exactly represent all $6$ rigid body modes. This means that for any nodal displacement vector $\\mathbf{d}$ corresponding to one of these modes, the resulting strain in every element is zero. Consequently, the product $K\\mathbf{d}$ will be the zero vector. The dimension of the null space of $K$, which is its nullity, is equal to the number of independent rigid body modes. For a single, connected $3$D body, the nullity of the unconstrained global stiffness matrix $K$ is therefore $r=6$.\n\nTo render the matrix $K$ nonsingular (i.e., invertible), its nullity must be reduced to zero. This is achieved by applying essential boundary conditions, which are constraints on the nodal degrees of freedom (DOFs). Each independent constraint applied to the system that is capable of restricting at least one rigid body motion effectively removes one dimension from the null space. To eliminate all $6$ rigid body modes, one must apply a minimum of $6$ independent constraints. Applying fewer than $6$ constraints would leave at least one rigid body motion unconstrained, and the matrix $K$ would remain singular. Applying more than $6$ constraints would be redundant, assuming the first $6$ were chosen correctly to be independent. Therefore, the minimal number $N$ of independent nodal translational DOFs that must be prescribed to render $K$ nonsingular is equal to the number of rigid body modes, which is $6$.\n\nAs required, a concrete example of a minimal set of independent translational constraints that achieves this is the so-called \"$3-2-1$\" support condition. Consider three non-collinear nodes P1, P2, and P3.\n\\begin{enumerate}\n    \\item At node P1, fix all three translational DOFs ($u, v, w$). This requires $3$ constraints and prevents all three rigid translations ($T_x, T_y, T_z$). The body can now only rotate about axes passing through P1.\n    \\item At node P2, which does not coincide with P1, fix two translational DOFs. For instance, if the line P1-P2 is not parallel to the $x$-axis, fixing $v$ and $w$ at P2 requires $2$ more constraints. These prevent rotations about the $y$ and $z$ axes. The body can now only rotate about the axis defined by the line connecting P1 and P2.\n    \\item At node P3, which is not collinear with P1 and P2, fix one translational DOF. This single constraint must be perpendicular to the plane formed by P1, P2, and P3 if they are coplanar, or more generally, it must restrict the motion of P3 due to the final remaining rotation. For example, fixing the $w$ DOF at P3 would prevent rotation about an axis in the $xy$-plane. This final, $6$-th constraint eliminates the last rigid body mode.\n\\end{enumerate}\nThis set of $3+2+1=6$ constraints is independent and sufficient to suppress all $6$ rigid body modes, thus making the global stiffness matrix $K$ nonsingular. The minimal number of such constraints is therefore $N=6$.", "answer": "$$\n\\boxed{6}\n$$", "id": "2583823"}, {"introduction": "The way we number nodes and degrees of freedom may seem arbitrary, but it has profound consequences for the efficiency of the solution process. The mesh connectivity dictates the sparsity pattern of the global stiffness matrix, and a strategic renumbering can significantly reduce its bandwidth, accelerating certain types of direct solvers. In this practice, you will manually apply the Cuthill-McKee algorithm to a small mesh, gaining a concrete understanding of how graph theory is used to optimize the computational core of the finite element method. [@problem_id:2583821]", "problem": "Consider a small two-dimensional finite element mesh with nodal set labeled $\\{1,2,3,4,5,6,7,8\\}$ and first-order triangular elements. The nodal degrees of freedom per node are those of planar linear elasticity, namely $2$ translational degrees of freedom per node. The element connectivity is given by the following list; each triangle with vertices $(i,j,k)$ indicates that all node pairs in $\\{i,j,k\\}$ are coupled in the assembled global stiffness matrix:\n- $e_{1}: (1,2,5)$\n- $e_{2}: (1,5,4)$\n- $e_{3}: (2,3,6)$\n- $e_{4}: (2,6,5)$\n- $e_{5}: (4,5,8)$\n- $e_{6}: (4,8,7)$\n- $e_{7}: (5,6,8)$\n\nThe graph of the global stiffness matrix at the nodal (supernode) level has an undirected edge between nodes $i$ and $j$ if there exists at least one element whose connectivity contains both $i$ and $j$. You are to apply the Cuthill–McKee reordering (not the reverse) to the nodal graph to obtain a new node numbering that reduces the bandwidth. Use the following deterministic rules to make the ordering unique:\n- Choose the starting node as the smallest-index node among those of minimum degree.\n- In breadth-first expansion, when enqueuing the unnumbered neighbors of the current node, sort them by nondecreasing degree; break ties by increasing original node index.\n- Never enqueue a node more than once.\n\nDefine the half-bandwidth at the nodal level for a labeling $\\pi:\\{1,\\dots,8\\}\\to\\{1,\\dots,8\\}$ by\n$$\nb_{\\text{node}} \\;=\\; \\max_{\\{i,j\\}\\in E} \\big|\\pi(i)-\\pi(j)\\big|,\n$$\nwhere $E$ is the edge set induced by the element connectivity. After obtaining the Cuthill–McKee ordering $\\pi$, form the degree-of-freedom (DOF) level ordering by grouping the $2$ translational degrees of freedom of each node contiguously, in the node order prescribed by $\\pi$. Assume standard finite element assembly, so that if two nodes are adjacent at the nodal level, then the corresponding $2\\times 2$ DOF block is nonzero.\n\nWhat is the resulting half-bandwidth of the assembled global stiffness matrix at the DOF level after applying the specified Cuthill–McKee ordering and expanding to the $2$ DOFs per node with contiguous grouping? Give a single integer as your answer. No rounding is required, and no units are to be reported.", "solution": "The problem requires the calculation of the half-bandwidth of a global stiffness matrix after reordering the nodes using the Cuthill-McKee algorithm. The analysis proceeds in three main stages: first, constructing the nodal graph and determining node degrees; second, applying the Cuthill-McKee algorithm to find the new node ordering; and third, calculating the half-bandwidth at the degree-of-freedom (DOF) level based on this new ordering.\n\nFirst, we must construct the undirected graph representing the nodal connectivity. The set of nodes is $V = \\{1, 2, 3, 4, 5, 6, 7, 8\\}$. An edge $(i, j)$ exists in the edge set $E$ if nodes $i$ and $j$ appear in the same element. The element connectivity list is:\n- $e_1: (1,2,5) \\implies$ edges $(1,2), (1,5), (2,5)$\n- $e_2: (1,5,4) \\implies$ edges $(1,4), (1,5), (4,5)$\n- $e_3: (2,3,6) \\implies$ edges $(2,3), (2,6), (3,6)$\n- $e_4: (2,6,5) \\implies$ edges $(2,5), (2,6), (5,6)$\n- $e_5: (4,5,8) \\implies$ edges $(4,5), (4,8), (5,8)$\n- $e_6: (4,8,7) \\implies$ edges $(4,7), (4,8), (7,8)$\n- $e_7: (5,6,8) \\implies$ edges $(5,6), (5,8), (6,8)$\n\nCombining these edges and removing duplicates, we can establish the adjacency list for each node and determine its degree, which is the number of other nodes it is connected to.\n- Node $1$: connected to $\\{2, 4, 5\\}$. Degree is $3$.\n- Node $2$: connected to $\\{1, 3, 5, 6\\}$. Degree is $4$.\n- Node $3$: connected to $\\{2, 6\\}$. Degree is $2$.\n- Node $4$: connected to $\\{1, 5, 7, 8\\}$. Degree is $4$.\n- Node $5$: connected to $\\{1, 2, 4, 6, 8\\}$. Degree is $5$.\n- Node $6$: connected to $\\{2, 3, 5, 8\\}$. Degree is $4$.\n- Node $7$: connected to $\\{4, 8\\}$. Degree is $2$.\n- Node $8$: connected to $\\{4, 5, 6, 7\\}$. Degree is $4$.\n\nNext, we apply the Cuthill-McKee (CM) algorithm.\n1.  **Select the starting node:** We must find the node(s) with the minimum degree. The minimum degree is $2$, and nodes $3$ and $7$ have this degree. The rule is to choose the one with the smallest original index, which is node $3$.\n\n2.  **Perform Breadth-First Search (BFS):** We maintain a result list $R$ and a queue $Q$. The process is as follows:\n- Initialize $R = []$ and $Q = [3]$. Mark node $3$ as visited.\n- **Level 0:** Dequeue $3$. Add to $R$. So, $R = (3)$. Find its unvisited neighbors: $\\{2, 6\\}$.\n    - Sort neighbors by degree: Degree($2$) = $4$, Degree($6$) = $4$. A tie.\n    - Break tie by original index: $2  6$. The sorted order is $(2, 6)$.\n    - Enqueue them: $Q = [2, 6]$. Mark $2, 6$ as visited.\n- **Level 1:**\n    - Dequeue $2$. Add to $R$. $R = (3, 2)$. Find its unvisited neighbors: $\\{1, 5\\}$. Note that $3$ is visited and $6$ is in $Q$ (and marked visited).\n    - Sort neighbors by degree: Degree($1$) = $3$, Degree($5$) = $5$. The sorted order is $(1, 5)$.\n    - Enqueue them: $Q = [6, 1, 5]$. Mark $1, 5$ as visited.\n    - Dequeue $6$. Add to $R$. $R = (3, 2, 6)$. Find its unvisited neighbors: $\\{8\\}$. Note that $2, 3$ are visited and $5$ is in $Q$.\n    - Sort neighbors: only $\\{8\\}$. The order is $(8)$.\n    - Enqueue it: $Q = [1, 5, 8]$. Mark $8$ as visited.\n- **Level 2:**\n    - Dequeue $1$. Add to $R$. $R = (3, 2, 6, 1)$. Find its unvisited neighbors: $\\{4\\}$. Note that $2, 5$ are visited/in-queue.\n    - Sort neighbors: only $\\{4\\}$. The order is $(4)$.\n    - Enqueue it: $Q = [5, 8, 4]$. Mark $4$ as visited.\n    - Dequeue $5$. Add to $R$. $R = (3, 2, 6, 1, 5)$. Find its unvisited neighbors: None. All its neighbors $\\{1, 2, 4, 6, 8\\}$ are visited/in-queue.\n    - $Q = [8, 4]$.\n    - Dequeue $8$. Add to $R$. $R = (3, 2, 6, 1, 5, 8)$. Find its unvisited neighbors: $\\{7\\}$. Note that $4, 5, 6$ are visited/in-queue.\n    - Sort neighbors: only $\\{7\\}$. The order is $(7)$.\n    - Enqueue it: $Q = [4, 7]$. Mark $7$ as visited.\n- **Level 3:**\n    - Dequeue $4$. Add to $R$. $R = (3, 2, 6, 1, 5, 8, 4)$. Find its unvisited neighbors: None. All its neighbors $\\{1, 5, 7, 8\\}$ are visited/in-queue.\n    - $Q = [7]$.\n    - Dequeue $7$. Add to $R$. $R = (3, 2, 6, 1, 5, 8, 4, 7)$. Find its unvisited neighbors: None. All its neighbors $\\{4, 8\\}$ are visited.\n    - $Q = []$.\n\nThe queue is empty, so the algorithm terminates. The Cuthill-McKee ordering is $R = (3, 2, 6, 1, 5, 8, 4, 7)$.\nThis ordering defines a mapping $\\pi$ from the original node labels to the new labels (their position in $R$, from $1$ to $8$):\n$\\pi(3)=1$, $\\pi(2)=2$, $\\pi(6)=3$, $\\pi(1)=4$, $\\pi(5)=5$, $\\pi(8)=6$, $\\pi(4)=7$, $\\pi(7)=8$.\n\nNow, we calculate the nodal half-bandwidth, $b_{\\text{node}} = \\max_{\\{i,j\\}\\in E} |\\pi(i)-\\pi(j)|$. We check this for all edges in $E$:\n- $(1,2): |\\pi(1)-\\pi(2)| = |4-2| = 2$\n- $(1,4): |\\pi(1)-\\pi(4)| = |4-7| = 3$\n- $(1,5): |\\pi(1)-\\pi(5)| = |4-5| = 1$\n- $(2,3): |\\pi(2)-\\pi(3)| = |2-1| = 1$\n- $(2,5): |\\pi(2)-\\pi(5)| = |2-5| = 3$\n- $(2,6): |\\pi(2)-\\pi(6)| = |2-3| = 1$\n- $(3,6): |\\pi(3)-\\pi(6)| = |1-3| = 2$\n- $(4,5): |\\pi(4)-\\pi(5)| = |7-5| = 2$\n- $(4,7): |\\pi(4)-\\pi(7)| = |7-8| = 1$\n- $(4,8): |\\pi(4)-\\pi(8)| = |7-6| = 1$\n- $(5,6): |\\pi(5)-\\pi(6)| = |5-3| = 2$\n- $(5,8): |\\pi(5)-\\pi(8)| = |5-6| = 1$\n- $(6,8): |\\pi(6)-\\pi(8)| = |3-6| = 3$\n- $(7,8): |\\pi(7)-\\pi(8)| = |8-6| = 2$\nThe maximum of these differences is $3$. Thus, the nodal half-bandwidth is $b_{\\text{node}} = 3$.\n\nFinally, we determine the half-bandwidth of the global stiffness matrix at the DOF level, $B_{\\text{DOF}}$. There are $n_d = 2$ DOFs per node. With the new node ordering, the DOFs for a node with new label $k = \\pi(i)$ are indexed as $2k-1$ and $2k$. The half-bandwidth of the matrix is defined as $B_{\\text{DOF}} = \\max_{K_{IJ} \\neq 0} |I-J|$. Non-zero entries $K_{IJ}$ occur if DOFs $I$ and $J$ are coupled. This happens when the DOFs belong to the same node (maximum difference of 1) or to adjacent nodes.\n\nLet two nodes $i$ and $j$ be connected, with new labels $k_i = \\pi(i)$ and $k_j = \\pi(j)$. Assume, without loss of generality, $k_i > k_j$. The DOFs for node $i$ occupy indices $\\{2k_i-1, 2k_i\\}$ and for node $j$ occupy indices $\\{2k_j-1, 2k_j\\}$. To maximize the difference $|I-J|$, we must choose the largest possible index from the block for node $i$ and the smallest possible index from the block for node $j$. This gives a maximum difference for this pair of:\n$$ |I-J|_{\\text{max for pair}} = (2k_i) - (2k_j-1) = 2(k_i - k_j) + 1 $$\nThe global half-bandwidth $B_{\\text{DOF}}$ is the maximum of this value over all connected pairs of nodes $\\{i, j\\}$:\n$$ B_{\\text{DOF}} = \\max_{\\{i,j\\}\\in E} \\left( 2|\\pi(i) - \\pi(j)| + 1 \\right) $$\nSince the function $f(x) = 2x+1$ is monotonically increasing, we can take the maximum of the argument first:\n$$ B_{\\text{DOF}} = 2 \\left( \\max_{\\{i,j\\}\\in E} |\\pi(i) - \\pi(j)| \\right) + 1 $$\nWe recognize the term in the parenthesis as the nodal half-bandwidth, $b_{\\text{node}}$.\n$$ B_{\\text{DOF}} = 2 \\cdot b_{\\text{node}} + 1 $$\nSubstituting the calculated value $b_{\\text{node}} = 3$:\n$$ B_{\\text{DOF}} = 2 \\cdot 3 + 1 = 7 $$\n\nThe resulting half-bandwidth of the assembled global stiffness matrix at the DOF level is $7$.", "answer": "$$\\boxed{7}$$", "id": "2583821"}]}