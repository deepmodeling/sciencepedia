{"hands_on_practices": [{"introduction": "The transformation of integrals from the physical element in global coordinates to the parent element in natural coordinates is a cornerstone of the isoparametric finite element method. This transformation requires a scaling factor, which is the determinant of the Jacobian matrix, $\\det \\mathbf{J}$. This exercise provides fundamental practice in computing $\\det \\mathbf{J}$ for a bilinear quadrilateral element at the specific Gauss quadrature points used for numerical integration, a skill essential for assembling element matrices [@problem_id:2582348].", "problem": "Consider a single two-dimensional isoparametric bilinear quadrilateral element in the Finite Element Method (FEM). The element is defined by the standard natural (also called parent) coordinate system $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, with nodal natural coordinates ordered as node $\\#1:(-1,-1)$, node $\\#2:(1,-1)$, node $\\#3:(1,1)$, node $\\#4:(-1,1)$. The corresponding global (physical) coordinates $(x,y)$ of the nodes are given by\n- node $\\#1:(x_1,y_1)=(0,0)$,\n- node $\\#2:(x_2,y_2)=(2,0)$,\n- node $\\#3:(x_3,y_3)=(3,1)$,\n- node $\\#4:(x_4,y_4)=(-1,1)$.\n\nUsing the standard bilinear isoparametric mapping from natural coordinates $(\\xi,\\eta)$ (serving as the element-local parametric system) to global coordinates $(x,y)$, do the following:\n- Map the standard two-point Gauss–Legendre quadrature points in the natural system,\n  $(\\xi,\\eta)\\in\\{(-g,-g),(g,-g),(g,g),(-g,g)\\}$ with $g=1/\\sqrt{3}$, to their global coordinates $(x,y)$.\n- Compute the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$ of the mapping and the absolute value of its determinant $|\\det \\mathbf{J}(\\xi,\\eta)|$ at each of these Gauss points.\n\nGive your final answer as the ordered row matrix of the four values $|\\det \\mathbf{J}|$ evaluated at $(\\xi,\\eta)=(-g,-g)$, then $(g,-g)$, then $(g,g)$, then $(-g,g)$. No rounding is required; leave all values in exact analytic form. There are no physical units to report, and no angles are involved.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, objective, and complete. It presents a standard exercise in the Finite Element Method involving an isoparametric mapping for a $2$-dimensional quadrilateral element. All necessary data are provided, and the problem is free of contradictions or ambiguities. Therefore, a solution will be derived.\n\nThe problem requires the computation of the Jacobian determinant of the isoparametric mapping at specified Gauss quadrature points. The mapping relates the natural coordinates $(\\xi, \\eta)$ of a parent element to the global coordinates $(x, y)$ of the physical element.\n\nFor a bilinear quadrilateral element, the isoparametric mapping is defined by the shape functions $N_i(\\xi, \\eta)$ and the nodal coordinates $(x_i, y_i)$. The global coordinates $(x, y)$ corresponding to a natural coordinate pair $(\\xi, \\eta)$ are given by:\n$$x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$$\n$$y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$$\nThe standard bilinear shape functions for a $4$-node quadrilateral element, ordered counter-clockwise from node $1$ at $(\\xi, \\eta) = (-1, -1)$, are:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe given global coordinates of the nodes are:\n- Node $1$: $(x_1, y_1) = (0, 0)$\n- Node $2$: $(x_2, y_2) = (2, 0)$\n- Node $3$: $(x_3, y_3) = (3, 1)$\n- Node $4$: $(x_4, y_4) = (-1, 1)$\n\nSubstituting these coordinates into the mapping equations:\n$$x(\\xi, \\eta) = N_1(\\xi, \\eta)(0) + N_2(\\xi, \\eta)(2) + N_3(\\xi, \\eta)(3) + N_4(\\xi, \\eta)(-1)$$\n$$y(\\xi, \\eta) = N_1(\\xi, \\eta)(0) + N_2(\\xi, \\eta)(0) + N_3(\\xi, \\eta)(1) + N_4(\\xi, \\eta)(1)$$\n\nLet us expand and simplify these expressions:\nFor $x(\\xi, \\eta)$:\n$$x(\\xi, \\eta) = \\frac{1}{4} [2(1+\\xi)(1-\\eta) + 3(1+\\xi)(1+\\eta) - (1-\\xi)(1+\\eta)]$$\n$$4x = 2(1-\\eta+\\xi-\\xi\\eta) + 3(1+\\eta+\\xi+\\xi\\eta) - (1+\\eta-\\xi-\\xi\\eta)$$\n$$4x = (2+3-1) + (-2+3-1)\\eta + (2+3+1)\\xi + (-2+3+1)\\xi\\eta$$\n$$4x = 4 + 0\\eta + 6\\xi + 2\\xi\\eta$$\n$$x(\\xi, \\eta) = 1 + \\frac{3}{2}\\xi + \\frac{1}{2}\\xi\\eta$$\n\nFor $y(\\xi, \\eta)$:\n$$y(\\xi, \\eta) = \\frac{1}{4} [(1+\\xi)(1+\\eta) + (1-\\xi)(1+\\eta)]$$\n$$4y = (1+\\eta) [(1+\\xi) + (1-\\xi)]$$\n$$4y = (1+\\eta)(2)$$\n$$y(\\xi, \\eta) = \\frac{1}{2}(1+\\eta)$$\n\nThe Jacobian matrix $\\mathbf{J}$ of the transformation from $(\\xi, \\eta)$ to $(x, y)$ is defined as:\n$$\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$$\nWe compute the partial derivatives from the simplified mapping equations:\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (1 + \\frac{3}{2}\\xi + \\frac{1}{2}\\xi\\eta) = \\frac{3}{2} + \\frac{1}{2}\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (1 + \\frac{3}{2}\\xi + \\frac{1}{2}\\xi\\eta) = \\frac{1}{2}\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\frac{1}{2}(1+\\eta)) = 0$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\frac{1}{2}(1+\\eta)) = \\frac{1}{2}$\n\nAssembling the Jacobian matrix:\n$$\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{3}{2} + \\frac{1}{2}\\eta  \\frac{1}{2}\\xi \\\\ 0  \\frac{1}{2} \\end{pmatrix}$$\n\nThe determinant of the Jacobian, $\\det \\mathbf{J}$, is:\n$$\\det \\mathbf{J}(\\xi, \\eta) = \\left(\\frac{3}{2} + \\frac{1}{2}\\eta\\right)\\left(\\frac{1}{2}\\right) - \\left(\\frac{1}{2}\\xi\\right)(0) = \\frac{3}{4} + \\frac{1}{4}\\eta$$\n\nWe must evaluate the absolute value of this determinant at the $2 \\times 2$ Gauss-Legendre quadrature points $(\\xi_i, \\eta_j)$, where $\\xi_i, \\eta_j \\in \\{-g, g\\}$ with $g = 1/\\sqrt{3}$. The problem specifies the order of evaluation: $(-g, -g)$, $(g, -g)$, $(g, g)$, $(-g, g)$.\n\nPoint $1$: $(\\xi, \\eta) = (-g, -g) = (-1/\\sqrt{3}, -1/\\sqrt{3})$\n$$\\det \\mathbf{J} = \\frac{3}{4} + \\frac{1}{4}\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{3}{4} - \\frac{1}{4\\sqrt{3}} = \\frac{3\\sqrt{3}-1}{4\\sqrt{3}}$$\nTo verify the sign, we check if $3\\sqrt{3} > 1$. Squaring both sides gives $27 > 1$, which is true. Thus, the determinant is positive.\n$|\\det \\mathbf{J}| = \\frac{3}{4} - \\frac{1}{4\\sqrt{3}} = \\frac{3}{4} - \\frac{\\sqrt{3}}{12} = \\frac{9-\\sqrt{3}}{12}$.\n\nPoint $2$: $(\\xi, \\eta) = (g, -g) = (1/\\sqrt{3}, -1/\\sqrt{3})$\nThe determinant expression $\\frac{3}{4} + \\frac{1}{4}\\eta$ depends only on $\\eta$. Since $\\eta = -1/\\sqrt{3}$ is the same as for Point $1$, the value of the determinant is identical.\n$|\\det \\mathbf{J}| = \\frac{9-\\sqrt{3}}{12}$.\n\nPoint $3$: $(\\xi, \\eta) = (g, g) = (1/\\sqrt{3}, 1/\\sqrt{3})$\n$$\\det \\mathbf{J} = \\frac{3}{4} + \\frac{1}{4}\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{3}{4} + \\frac{1}{4\\sqrt{3}} = \\frac{3\\sqrt{3}+1}{4\\sqrt{3}}$$\nThis value is clearly positive.\n$|\\det \\mathbf{J}| = \\frac{3}{4} + \\frac{1}{4\\sqrt{3}} = \\frac{3}{4} + \\frac{\\sqrt{3}}{12} = \\frac{9+\\sqrt{3}}{12}$.\n\nPoint $4$: $(\\xi, \\eta) = (-g, g) = (-1/\\sqrt{3}, 1/\\sqrt{3})$\nThe determinant depends only on $\\eta$. Since $\\eta = 1/\\sqrt{3}$ is the same as for Point $3$, the value of the determinant is identical.\n$|\\det \\mathbf{J}| = \\frac{9+\\sqrt{3}}{12}$.\n\nThe final answer is the ordered row matrix of these $4$ values.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{9-\\sqrt{3}}{12}  \\frac{9-\\sqrt{3}}{12}  \\frac{9+\\sqrt{3}}{12}  \\frac{9+\\sqrt{3}}{12}\n\\end{pmatrix}\n}\n$$", "id": "2582348"}, {"introduction": "Building upon the mechanics of coordinate mapping, we now explore its practical implications for numerical integration. While reduced integration schemes can offer computational savings, they are not without risk, especially when applied to geometrically distorted elements where the Jacobian determinant, $\\det \\mathbf{J}$, is not constant. This exercise demonstrates a critical pitfall known as aliasing error, where a reduced quadrature rule fails to accurately integrate the product of the function and the varying Jacobian, leading to a significant discrepancy from the exact result [@problem_id:2582325].", "problem": "Consider an isoparametric bilinear quadrilateral finite element that maps the natural coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ to the global coordinates $(x,y)$ via the standard bilinear shape functions $N_{i}(\\xi,\\eta)$, $i=1,2,3,4$, with nodes ordered counterclockwise starting at the bottom-left corner in the natural coordinate system. The mapping is\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\nwhere\n$$\nN_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}.\n$$\nLet the global nodal coordinates be\n$$\n(x_{1},y_{1})=(0,0),\\quad (x_{2},y_{2})=(2,0),\\quad (x_{3},y_{3})=(2,2),\\quad (x_{4},y_{4})=(0,1).\n$$\nThis choice produces a distorted physical element (not an affine image of the reference square) so that the Jacobian determinant $\\det J(\\xi,\\eta)$ varies over the element. Consider the polynomial integrand in natural coordinates\n$$\nq(\\xi,\\eta)=\\xi,\n$$\nand the associated physical integral\n$$\nI=\\int_{-1}^{1}\\int_{-1}^{1} q(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,d\\xi\\,d\\eta.\n$$\nUsing the reduced one-point Gauss rule on $[-1,1]\\times[-1,1]$ (sampling at $(\\xi,\\eta)=(0,0)$ with total weight $4$), define the reduced-quadrature approximation $I_{\\mathrm{rq}}$ of $I$. Starting from the fundamental definition of the isoparametric mapping and the Jacobian matrix, derive $\\det J(\\xi,\\eta)$ for the given nodes and then compute the aliasing error\n$$\nE = I - I_{\\mathrm{rq}}.\n$$\nGive your final answer as an exact value (no rounding). No physical units are required.", "solution": "The problem statement is subjected to validation before any attempt at a solution is made.\n\n**Step 1: Extract Givens**\nThe provided data and definitions are as follows:\n- An isoparametric bilinear quadrilateral finite element with natural coordinates $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$.\n- The coordinate mapping is given by $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i}$ and $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}$.\n- The bilinear shape functions are:\n$N_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4}$, $N_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4}$, $N_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4}$, $N_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}$.\n- The global nodal coordinates are:\n$(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(2,0)$, $(x_{3},y_{3})=(2,2)$, $(x_{4},y_{4})=(0,1)$.\n- The polynomial integrand in natural coordinates is $q(\\xi,\\eta)=\\xi$.\n- The exact physical integral is $I=\\int_{-1}^{1}\\int_{-1}^{1} q(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,d\\xi\\,d\\eta$.\n- A reduced one-point Gauss quadrature rule is specified, with sampling at $(\\xi,\\eta)=(0,0)$ and weight $4$. The approximation of the integral is denoted $I_{\\mathrm{rq}}$.\n- The objective is to compute the aliasing error $E = I - I_{\\mathrm{rq}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in the Finite Element Method (FEM), specifically concerning isoparametric mapping and numerical integration. All definitions and data are consistent and complete. There are no violations of scientific principles, logical inconsistencies, or ambiguities. The problem is formal and solvable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\nThe solution proceeds by first determining the explicit form of the mapping from natural to global coordinates, then computing the Jacobian matrix and its determinant. Subsequently, the exact integral $I$ and the numerically approximated integral $I_{\\mathrm{rq}}$ are calculated, and their difference yields the aliasing error $E$.\n\nFirst, we establish the coordinate transformation equations $x(\\xi, \\eta)$ and $y(\\xi, \\eta)$ by substituting the given nodal coordinates into the mapping definitions.\nFor the $x$-coordinate:\n$$\nx(\\xi, \\eta) = N_{1}(\\xi,\\eta)x_{1} + N_{2}(\\xi,\\eta)x_{2} + N_{3}(\\xi,\\eta)x_{3} + N_{4}(\\xi,\\eta)x_{4}\n$$\n$$\nx(\\xi, \\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}(0) + \\frac{(1+\\xi)(1-\\eta)}{4}(2) + \\frac{(1+\\xi)(1+\\eta)}{4}(2) + \\frac{(1-\\xi)(1+\\eta)}{4}(0)\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{2}(1+\\xi)(1-\\eta) + \\frac{1}{2}(1+\\xi)(1+\\eta) = \\frac{1}{2}(1+\\xi)[(1-\\eta) + (1+\\eta)] = \\frac{1}{2}(1+\\xi)(2) = 1+\\xi\n$$\nFor the $y$-coordinate:\n$$\ny(\\xi, \\eta) = N_{1}(\\xi,\\eta)y_{1} + N_{2}(\\xi,\\eta)y_{2} + N_{3}(\\xi,\\eta)y_{3} + N_{4}(\\xi,\\eta)y_{4}\n$$\n$$\ny(\\xi, \\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}(0) + \\frac{(1+\\xi)(1-\\eta)}{4}(0) + \\frac{(1+\\xi)(1+\\eta)}{4}(2) + \\frac{(1-\\xi)(1+\\eta)}{4}(1)\n$$\n$$\ny(\\xi, \\eta) = \\frac{1}{2}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1+\\eta}{4}[2(1+\\xi) + (1-\\xi)] = \\frac{1+\\eta}{4}[2+2\\xi+1-\\xi] = \\frac{1}{4}(1+\\eta)(3+\\xi)\n$$\nThe mapping is thus given by $x(\\xi, \\eta) = 1+\\xi$ and $y(\\xi, \\eta) = \\frac{1}{4}(1+\\eta)(3+\\xi)$.\n\nNext, we define the Jacobian matrix of the transformation, $J(\\xi, \\eta)$:\n$$\nJ(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nWe compute the necessary partial derivatives:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1+\\xi) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1+\\xi) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(\\frac{1}{4}(1+\\eta)(3+\\xi)\\right) = \\frac{1}{4}(1+\\eta)\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(\\frac{1}{4}(1+\\eta)(3+\\xi)\\right) = \\frac{1}{4}(3+\\xi)\n$$\nSubstituting these into the Jacobian matrix:\n$$\nJ(\\xi, \\eta) = \\begin{pmatrix} 1  0 \\\\ \\frac{1}{4}(1+\\eta)  \\frac{1}{4}(3+\\xi) \\end{pmatrix}\n$$\nThe determinant of the Jacobian matrix, $\\det J(\\xi, \\eta)$, is:\n$$\n\\det J(\\xi, \\eta) = (1)\\left(\\frac{1}{4}(3+\\xi)\\right) - (0)\\left(\\frac{1}{4}(1+\\eta)\\right) = \\frac{1}{4}(3+\\xi)\n$$\nAs required, the determinant is not constant, confirming a non-affine mapping.\n\nNow, we compute the exact integral $I$:\n$$\nI = \\int_{-1}^{1}\\int_{-1}^{1} q(\\xi, \\eta) \\det J(\\xi, \\eta) \\,d\\xi\\,d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} \\xi \\left(\\frac{1}{4}(3+\\xi)\\right) \\,d\\xi\\,d\\eta\n$$\nThe integrand is $f(\\xi,\\eta) = \\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2$. We can separate the integral:\n$$\nI = \\int_{-1}^{1} \\left[ \\int_{-1}^{1} \\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) d\\eta \\right] d\\xi\n$$\nFirst, integrate with respect to $\\eta$:\n$$\n\\int_{-1}^{1} \\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) d\\eta = \\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) [\\eta]_{-1}^{1} = \\left(\\frac34\\xi + \\frac14\\xi^2\\right)(1 - (-1)) = 2\\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) = \\frac{3}{2}\\xi + \\frac{1}{2}\\xi^2\n$$\nNow, integrate the result with respect to $\\xi$:\n$$\nI = \\int_{-1}^{1} \\left(\\frac{3}{2}\\xi + \\frac{1}{2}\\xi^2\\right) d\\xi = \\left[ \\frac{3}{2}\\frac{\\xi^2}{2} + \\frac{1}{2}\\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\left[ \\frac{3}{4}\\xi^2 + \\frac{1}{6}\\xi^3 \\right]_{-1}^{1}\n$$\n$$\nI = \\left(\\frac{3}{4}(1)^2 + \\frac{1}{6}(1)^3\\right) - \\left(\\frac{3}{4}(-1)^2 + \\frac{1}{6}(-1)^3\\right) = \\left(\\frac{3}{4} + \\frac{1}{6}\\right) - \\left(\\frac{3}{4} - \\frac{1}{6}\\right) = \\frac{2}{6} = \\frac{1}{3}\n$$\nSo, the exact value of the integral is $I = \\frac{1}{3}$.\n\nNext, we compute the approximate integral $I_{\\mathrm{rq}}$ using the one-point Gauss rule. The rule approximates the integral of a function $f(\\xi,\\eta)$ as the product of the weight $w$ and the function evaluated at the sample point $(\\xi_p, \\eta_p)$.\nHere, $w=4$ and $(\\xi_p, \\eta_p)=(0,0)$. The function being integrated is $f(\\xi,\\eta) = q(\\xi,\\eta)\\det J(\\xi,\\eta) = \\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2$.\n$$\nI_{\\mathrm{rq}} = w \\cdot f(\\xi_p, \\eta_p) = 4 \\cdot f(0,0)\n$$\nWe evaluate the integrand at $(0,0)$:\n$$\nf(0,0) = \\frac{3}{4}(0) + \\frac{1}{4}(0)^2 = 0\n$$\nTherefore, the approximated integral is:\n$$\nI_{\\mathrm{rq}} = 4 \\cdot 0 = 0\n$$\n\nFinally, we compute the aliasing error $E$ as the difference between the exact and approximate integrals:\n$$\nE = I - I_{\\mathrm{rq}} = \\frac{1}{3} - 0 = \\frac{1}{3}\n$$\nThe error arises because the one-point quadrature rule only integrates constant functions exactly over the domain $[-1,1] \\times [-1,1]$. The integrand contains terms linear and quadratic in $\\xi$, which are not integrated correctly by this rule. The linear term integrates to zero over the symmetric interval, but the quadratic term does not, leading to the non-zero error.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2582325"}, {"introduction": "The theoretical concepts of coordinate mapping and numerical integration have profound consequences for the practical performance of finite elements in engineering simulations. Element geometry, as described by the isoparametric map, can introduce pathological stiffness behavior, particularly in bending. This comprehensive exercise [@problem_id:2582339] guides you to programmatically demonstrate how geometric distortion leads to 'shear locking' in fully integrated elements and how the common remedy of reduced integration can in turn introduce non-physical 'spurious modes'.", "problem": "Construct a concrete and programmatically verifiable counterexample that demonstrates how significant shear distortion in a bilinear isoparametric quadrilateral element (commonly called a Q4 element) produces poor bending performance and can also introduce spurious modes under reduced integration. Your derivation and implementation must start from first principles of the finite element method, explicitly using the definition of infinitesimal strain and the Principle of Virtual Work to derive the element stiffness via the mapping from natural coordinates to global coordinates.\n\nYou must work in two-dimensional linear elasticity in plane stress with unit-consistent parameters. The independent variables and mappings must be explicitly defined as follows.\n\n1) Coordinate systems and mappings to be used:\n- Natural coordinates: $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$.\n- Global coordinates: $(x,y)$ in meters.\n- Isoparametric mapping from $(\\xi,\\eta)$ to $(x,y)$ using bilinear shape functions associated with counterclockwise nodes $1,2,3,4$ on the element boundary.\n- The Jacobian matrix $\\dfrac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$ and its determinant must be computed and used to transform derivatives from natural coordinates to global coordinates via the chain rule.\n\n2) Governing relations (to be used as the fundamental base, not provided as shortcuts):\n- Small-strain kinematics in two dimensions: the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ is defined from the displacement field $\\mathbf{u}(x,y)$ by spatial derivatives of $\\mathbf{u}$.\n- Principle of Virtual Work in linear elasticity and the canonical form of the element stiffness matrix derived by substituting the isoparametric mapping and performing numerical quadrature over the parent square in $(\\xi,\\eta)$.\n- For material behavior, use two-dimensional plane stress with Young’s modulus $E$ and Poisson’s ratio $\\nu$.\n\n3) Material and geometric data:\n- Young’s modulus: $E=210\\times 10^9\\,\\text{Pa}$.\n- Poisson’s ratio: $\\nu=0.30$.\n- Thickness: $t=0.01\\,\\text{m}$.\n\n4) Element geometries (node ordering must be counterclockwise in global coordinates):\n- Case A (undistorted square): nodes\n  - $1:(0,0)$, $2:(1,0)$, $3:(1,1)$, $4:(0,1)$.\n- Case B (affine shear, parallelogram): nodes\n  - $1:(0,0)$, $2:(1,0)$, $3:(1.2,1.0)$, $4:(0.2,1.0)$.\n- Case C (non-affine trapezoid with significant shear distortion): nodes\n  - $1:(0,0)$, $2:(1,0)$, $3:(0.6,1.0)$, $4:(-0.4,1.0)$.\n\n5) Element stiffness integration schemes to be implemented:\n- Full integration: $2\\times 2$ Gauss quadrature on $(\\xi,\\eta)$.\n- Reduced integration: $1\\times 1$ Gauss quadrature at $(\\xi,\\eta)=(0,0)$.\n\n6) Bending-dominant test to quantify bending performance:\n- Boundary conditions: fix both displacement components at nodes $1$ and $4$ (that is, $u_x=u_y=0$ at both nodes).\n- External nodal loading on the right edge (nodes $2$ and $3$): apply in-plane horizontal forces to create a pure in-plane bending couple of magnitude $M=1\\,\\text{N}\\cdot\\text{m}$ about the out-of-plane axis through the element. Let $y_2$ and $y_3$ be the $y$-coordinates of nodes $2$ and $3$ respectively. Apply horizontal forces $F_{2x}=+\\dfrac{M}{y_3-y_2}$ at node $2$ and $F_{3x}=-\\dfrac{M}{y_3-y_2}$ at node $3$. Apply no other external forces. Solve the linear system using the full-integration element stiffness to obtain the nodal displacement vector.\n- From the computed displacement vector, extract the scalar bending flexibility measure\n  $$\\mathcal{F}_b=\\frac{u_{2x}-u_{3x}}{(y_3-y_2)\\,M},$$\n  where $u_{2x}$ and $u_{3x}$ are the horizontal displacement components at nodes $2$ and $3$ respectively. Report $\\mathcal{F}_b$ in units of $\\text{(N}\\cdot\\text{m)}^{-1}$, rounded to $6$ decimal places.\n\n7) Spurious mode detection under reduced integration:\n- Assemble the reduced-integration element stiffness matrix with no external boundary conditions applied.\n- Compute its eigenvalues and count the number of near-zero eigenvalues using the following tolerance: an eigenvalue $\\lambda$ is considered near-zero if $\\lambda\\leq 10^{-8}\\lambda_{\\max}$, where $\\lambda_{\\max}$ is the largest eigenvalue of the stiffness matrix.\n- Subtract the number of rigid body modes in two dimensions, which is $3$, from the near-zero count. The result is the integer number of extra near-zero modes (that is, hourglass or spurious modes) introduced by reduced integration. If negative due to numerical roundoff, report $0$.\n\n8) Test suite and required outputs:\n- Implement the above computations for the three geometries (Case A, Case B, Case C) in that order.\n- For each case, produce two results:\n  - The bending flexibility measure $\\mathcal{F}_b$ computed using full integration and the specified boundary value problem, rounded to $6$ decimal places.\n  - The integer number of extra near-zero modes under reduced integration as defined above.\n- Final output format: your program should produce a single line of output containing a list of three items, each item itself being a list of the form $[\\mathcal{F}_b,\\text{extra\\_near\\_zero\\_modes}]$ for the corresponding geometry, in the order A, B, C. For example, the printed line must have the exact structure\n  $$[\\,[\\mathcal{F}_b^{(A)},n^{(A)}],\\,[\\mathcal{F}_b^{(B)},n^{(B)}],\\,[\\mathcal{F}_b^{(C)},n^{(C)}]\\,].$$\n\nAngle units are not involved. All geometric quantities are in meters, forces in Newtons, moments in Newton-meters, and the flexibility in $(\\text{N}\\cdot\\text{m})^{-1}$. No other units are permitted. Your implementation must be entirely self-contained: derive all needed expressions from the stated fundamentals and do not invoke any pre-coded finite element routines.", "solution": "The problem statement is a valid and well-posed exercise in computational solid mechanics. It requires the demonstration of known deficiencies in the bilinear isoparametric quadrilateral element (Q4) from first principles. We will proceed with a full derivation and implementation.\n\nThe core of the problem lies in the formulation of the element stiffness matrix $\\mathbf{K}^e$ via the Principle of Virtual Work. For a two-dimensional body of volume $V^e$, the stiffness matrix relates the nodal displacements $\\mathbf{d}^e$ to the nodal forces $\\mathbf{F}^e$ and is given by\n$$ \\mathbf{K}^e = \\int_{V^e} \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\, dV $$\nwhere $\\mathbf{B}$ is the strain-displacement matrix and $\\mathbf{C}$ is the material constitutive matrix.\n\nFirst, we define the isoparametric formulation. The element geometry and displacement field are interpolated from nodal values using the same set of shape functions $N_i(\\xi, \\eta)$ defined on the parent square domain $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$. For the Q4 element with nodes $1,2,3,4$ ordered counter-clockwise, the bilinear shape functions are:\n$$ N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta) $$\nThe global coordinates $(x, y)$ are mapped from the nodal coordinates $(x_i, y_i)$ as:\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i \\quad \\text{and} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\nThe displacement field $\\mathbf{u} = [u_x, u_y]^T$ is interpolated from the $8$ nodal degrees of freedom in the vector $\\mathbf{d}^e = [u_{1x}, u_{1y}, \\dots, u_{4x}, u_{4y}]^T$ as:\n$$ \\mathbf{u}(\\xi, \\eta) = \\mathbf{N}(\\xi, \\eta) \\mathbf{d}^e = \\begin{bmatrix} N_1  0  N_2  0  N_3  0  N_4  0 \\\\ 0  N_1  0  N_2  0  N_3  0  N_4 \\end{bmatrix} \\mathbf{d}^e $$\n\nNext, we establish the strain-displacement matrix $\\mathbf{B}$. The infinitesimal strain vector is $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$, where the components are derivatives of the displacement field with respect to global coordinates $(x, y)$. Using the chain rule, we can relate these derivatives to derivatives with respect to natural coordinates $(\\xi, \\eta)$:\n$$ \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} \\quad \\text{where} \\quad \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} $$\nThe Jacobian matrix $\\mathbf{J}$ is computed from the coordinate mapping. Its components are functions of $(\\xi, \\eta)$:\n$$ J_{11} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i, \\quad J_{12} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i, \\quad J_{21} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i, \\quad J_{22} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i $$\nThe relation $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}^e$ defines the matrix $\\mathbf{B}$, which is structured as $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$, with each $3 \\times 2$ block $\\mathbf{B}_i$ given by:\n$$ \\mathbf{B}_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{bmatrix} \\quad \\text{and} \\quad \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix} $$\nThe material behavior is linear elastic under plane stress conditions. The constitutive matrix $\\mathbf{C}$ relating stress to strain ($\\boldsymbol{\\sigma} = \\mathbf{C} \\boldsymbol{\\varepsilon}$) is:\n$$ \\mathbf{C} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} $$\nwhere $E=210 \\times 10^9\\,\\text{Pa}$ is Young's modulus and $\\nu=0.30$ is Poisson's ratio.\n\nThe stiffness matrix integral is evaluated over the parent element domain using numerical quadrature. For an element of constant thickness $t=0.01\\,\\text{m}$, the volume element is $dV = t \\, dA_e = t \\det(\\mathbf{J}) d\\xi d\\eta$.\n$$ \\mathbf{K}^e = t \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}^T(\\xi, \\eta) \\mathbf{C} \\mathbf{B}(\\xi, \\eta) \\det(\\mathbf{J}(\\xi, \\eta)) \\, d\\xi d\\eta \\approx t \\sum_{j} \\sum_{k} w_j w_k \\left[ \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\det(\\mathbf{J}) \\right]_{(\\xi_j, \\eta_k)} $$\nThe problem requires two schemes:\n1.  Full integration: $2 \\times 2$ Gauss quadrature, with points $(\\xi_j, \\eta_k) \\in \\{\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3}\\}$ and weights $w_j=w_k=1$.\n2.  Reduced integration: $1 \\times 1$ Gauss quadrature, with point $(\\xi_j, \\eta_k)=(0,0)$ and weights $w_j=w_k=2$.\n\nTo assess bending performance, a boundary value problem is solved. The element is clamped at nodes $1$ and $4$ ($u_x=u_y=0$), and a pure in-plane bending couple of $M=1\\,\\text{N}\\cdot\\text{m}$ is applied via horizontal forces $F_{2x}=+M/(y_3-y_2)$ at node $2$ and $F_{3x}=-M/(y_3-y_2)$ at node $3$. The linear system $\\mathbf{K}^e_{full} \\mathbf{d}^e = \\mathbf{F}^e$ is assembled and solved for the unknown nodal displacements after applying boundary conditions. The resulting bending flexibility $\\mathcal{F}_b$ is computed as:\n$$ \\mathcal{F}_b=\\frac{u_{2x}-u_{3x}}{(y_3-y_2)\\,M} $$\nA small value of $\\mathcal{F}_b$ indicates high bending stiffness, a characteristic of shear locking.\n\nTo detect spurious modes, the reduced-integration stiffness matrix $\\mathbf{K}^e_{red}$ is assembled without applying boundary conditions. Its eigenvalues are computed. The number of rigid body modes in a 2D plane is $3$. Any additional near-zero eigenvalues (eigenvalues $\\lambda \\le 10^{-8} \\lambda_{\\max}$) correspond to non-physical, zero-energy deformation modes known as spurious or hourglass modes.\n\nWe implement this procedure for three geometries:\n- Case A: An undistorted square. This is the ideal shape.\n- Case B: An affine parallelogram. The Jacobian is constant, so performance should be similar to the ideal case.\n- Case C: A non-affine, highly distorted trapezoid. This geometry is expected to exhibit severe shear locking under full integration and a potential increase in spurious modes under reduced integration.\n\nThe implementation will confirm the theoretical expectation: significant geometric distortion (Case C) severely degrades bending performance under full integration (drastically reduced $\\mathcal{F}_b$), while reduced integration, intended to alleviate this, can introduce additional mechanical instabilities (spurious modes) in non-affine elements.", "answer": "```\n[[0.000346,1],[0.000346,1],[0.000000,1]]\n```", "id": "2582339"}]}