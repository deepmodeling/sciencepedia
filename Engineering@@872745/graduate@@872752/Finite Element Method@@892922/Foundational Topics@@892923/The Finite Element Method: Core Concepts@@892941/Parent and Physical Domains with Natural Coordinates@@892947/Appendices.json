{"hands_on_practices": [{"introduction": "A primary reason for using the parent domain is to simplify calculations. However, the governing partial differential equations involve derivatives in physical space. This practice bridges that gap by demonstrating how to compute the physical gradient $\\nabla_{\\mathbf{x}} N_a$ of a shape function using the chain rule. You will apply the core relationship $\\nabla_{\\mathbf{x}} = (\\mathbf{J}^{-1})^{\\mathsf T} \\nabla_{\\boldsymbol{\\xi}}$ to see firsthand how the Jacobian matrix facilitates this crucial transformation [@problem_id:2585622].", "problem": "In the isoparametric Finite Element Method (FEM) for two-dimensional problems, the mapping from a parent domain with natural coordinates to a physical domain enables the computation of gradients of shape functions in physical space using the chain rule. Consider a single four-node bilinear quadrilateral element (often called a Q4 element) with the parent (reference) domain given by the square in the natural coordinates $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$. The physical element is a rectangle with nodes ordered counterclockwise:\n- Node $1$ at $(x_1,y_1)=(0,0)$,\n- Node $2$ at $(x_2,y_2)=(2,0)$,\n- Node $3$ at $(x_3,y_3)=(2,1)$,\n- Node $4$ at $(x_4,y_4)=(0,1)$.\n\nLet the bilinear shape functions on the parent domain be the standard four-node polynomials,\n\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n\nThe isoparametric mapping to the physical coordinates is defined by\n\n$$\nx(\\xi,\\eta)=\\sum_{a=1}^{4}N_a(\\xi,\\eta)\\,x_a,\\qquad\ny(\\xi,\\eta)=\\sum_{a=1}^{4}N_a(\\xi,\\eta)\\,y_a.\n$$\n\n\nUsing only these definitions and the chain rule for multivariable calculus, derive the mapping Jacobian and its inverse transpose for this element, and then compute the physical gradient $\\nabla_{x} N_2$, where $\\nabla_{x}:=\\bigl[\\partial/\\partial x,\\ \\partial/\\partial y\\bigr]^{\\mathsf T}$, at the four standard two-point tensor-product Gauss quadrature points in the parent domain,\n\n$$\n(\\xi,\\eta)\\in\\left\\{ \\left(-\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}\\right),\\ \\left(\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}\\right),\\ \\left(\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}}\\right),\\ \\left(-\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}}\\right) \\right\\}.\n$$\n\n\nExpress your final answer as a single row matrix listing the components in the order\n\n$$\n\\bigl[\\ (\\partial N_2/\\partial x)\\text{ at }P_1,\\ (\\partial N_2/\\partial y)\\text{ at }P_1,\\ (\\partial N_2/\\partial x)\\text{ at }P_2,\\ (\\partial N_2/\\partial y)\\text{ at }P_2,\\ (\\partial N_2/\\partial x)\\text{ at }P_3,\\ (\\partial N_2/\\partial y)\\text{ at }P_3,\\ (\\partial N_2/\\partial x)\\text{ at }P_4,\\ (\\partial N_2/\\partial y)\\text{ at }P_4\\ \\bigr],\n$$\n\nwhere the points $P_1,P_2,P_3,P_4$ are ordered as written above. Give exact values; no rounding is required. The final answer must be a single analytical expression as specified.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is a standard exercise in the isoparametric formulation of the Finite Element Method. All necessary data are provided, and the problem is free of contradictions or ambiguities. I will therefore proceed with the solution.\n\nThe core of the problem is to relate the gradient of a shape function in the physical domain $(x,y)$ to its gradient in the parent domain $(\\xi,\\eta)$. This is accomplished via the chain rule of multivariable calculus. For any function $f(\\xi,\\eta)$, its derivatives are related by:\n\n$$\n\\frac{\\partial f}{\\partial \\xi} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\xi} + \\frac{\\partial f}{\\partial y}\\frac{\\partial y}{\\partial \\xi}\n$$\n$$\n\\frac{\\partial f}{\\partial \\eta} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\eta} + \\frac{\\partial f}{\\partial y}\\frac{\\partial y}{\\partial \\eta}\n$$\n\nThis system can be written in matrix form:\n$$\n\\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix}\n$$\n\nThe standard definition of the mapping Jacobian matrix, denoted $\\mathbf{J}$, for the transformation from parent coordinates $(\\xi,\\eta)$ to physical coordinates $(x,y)$ is:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n\nUsing this definition, the chain rule relationship is expressed in terms of the transpose of the Jacobian, $\\mathbf{J}^{\\mathsf T}$:\n$$\n\\nabla_{\\xi} f = \\mathbf{J}^{\\mathsf T} \\nabla_{x} f\n$$\nTo find the physical gradient $\\nabla_{x} f$, we must invert this relationship:\n$$\n\\nabla_{x} f = (\\mathbf{J}^{\\mathsf T})^{-1} \\nabla_{\\xi} f = (\\mathbf{J}^{-1})^{\\mathsf T} \\nabla_{\\xi} f\n$$\nThe matrix $(\\mathbf{J}^{-1})^{\\mathsf T}$ is the inverse transpose of the Jacobian, which the problem requires.\n\nFirst, we compute the components of the Jacobian matrix $\\mathbf{J}$. The isoparametric mapping is given by $x(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) x_a$ and $y(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) y_a$. The derivatives are:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\xi} x_a, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\eta} x_a\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\xi} y_a, \\quad \\frac{\\partial y}{\\partial \\eta} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\eta} y_a\n$$\n\nThe derivatives of the shape functions with respect to the natural coordinates are:\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)\n$$\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)\n$$\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)\n$$\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n$$\n\nThe nodal coordinates are given as $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(2,0)$, $(x_3,y_3)=(2,1)$, and $(x_4,y_4)=(0,1)$.\nSubstituting these into the expressions for the Jacobian components:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial N_1}{\\partial \\xi}(0) + \\frac{\\partial N_2}{\\partial \\xi}(2) + \\frac{\\partial N_3}{\\partial \\xi}(2) + \\frac{\\partial N_4}{\\partial \\xi}(0) = \\frac{1}{4}(1-\\eta)(2) + \\frac{1}{4}(1+\\eta)(2) = \\frac{1}{2}(1-\\eta+1+\\eta) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial N_1}{\\partial \\eta}(0) + \\frac{\\partial N_2}{\\partial \\eta}(2) + \\frac{\\partial N_3}{\\partial \\eta}(2) + \\frac{\\partial N_4}{\\partial \\eta}(0) = -\\frac{1}{4}(1+\\xi)(2) + \\frac{1}{4}(1+\\xi)(2) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial N_1}{\\partial \\xi}(0) + \\frac{\\partial N_2}{\\partial \\xi}(0) + \\frac{\\partial N_3}{\\partial \\xi}(1) + \\frac{\\partial N_4}{\\partial \\xi}(1) = \\frac{1}{4}(1+\\eta)(1) - \\frac{1}{4}(1+\\eta)(1) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial N_1}{\\partial \\eta}(0) + \\frac{\\partial N_2}{\\partial \\eta}(0) + \\frac{\\partial N_3}{\\partial \\eta}(1) + \\frac{\\partial N_4}{\\partial \\eta}(1) = \\frac{1}{4}(1+\\xi)(1) + \\frac{1}{4}(1-\\xi)(1) = \\frac{1}{4}(1+\\xi+1-\\xi) = \\frac{1}{2}\n$$\n\nThe Jacobian matrix $\\mathbf{J}$ is constant over the element, which is expected for an affine mapping (a rectangle mapped to a rectangle):\n$$\n\\mathbf{J} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}\n$$\nThe determinant of the Jacobian is $\\det(\\mathbf{J}) = (1)(\\frac{1}{2}) - (0)(0) = \\frac{1}{2}$.\nThe inverse of the Jacobian is:\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})} \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix} = 2 \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}\n$$\nThe required inverse transpose is:\n$$\n(\\mathbf{J}^{-1})^{\\mathsf T} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}^{\\mathsf T} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}\n$$\n\nNow, we compute the physical gradient of the shape function $N_2$. First, we find its gradient in the parent domain:\n$$\n\\nabla_{\\xi} N_2 = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial \\xi} \\\\ \\frac{\\partial N_2}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1+\\xi) \\end{pmatrix}\n$$\nThe physical gradient $\\nabla_{x} N_2$ is then:\n$$\n\\nabla_{x} N_2 = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x} \\\\ \\frac{\\partial N_2}{\\partial y} \\end{pmatrix} = (\\mathbf{J}^{-1})^{\\mathsf T} \\nabla_{\\xi} N_2 = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1+\\xi) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{2}(1+\\xi) \\end{pmatrix}\n$$\n\nFinally, we evaluate this gradient at the four specified Gauss quadrature points.\nLet $\\alpha = \\frac{1}{\\sqrt{3}}$. The points are $P_1(-\\alpha, -\\alpha)$, $P_2(\\alpha, -\\alpha)$, $P_3(\\alpha, \\alpha)$, and $P_4(-\\alpha, \\alpha)$.\n\nAt point $P_1: (\\xi,\\eta) = (-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - (-\\frac{1}{\\sqrt{3}})\\right) = \\frac{1}{4}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}+1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + (-\\frac{1}{\\sqrt{3}})\\right) = -\\frac{1}{2}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{1-\\sqrt{3}}{2\\sqrt{3}}\n$$\n\nAt point $P_2: (\\xi,\\eta) = (\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - (-\\frac{1}{\\sqrt{3}})\\right) = \\frac{1}{4}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}+1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = -\\frac{\\sqrt{3}+1}{2\\sqrt{3}}\n$$\n\nAt point $P_3: (\\xi,\\eta) = (\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}-1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = -\\frac{\\sqrt{3}+1}{2\\sqrt{3}}\n$$\n\nAt point $P_4: (\\xi,\\eta) = (-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}-1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + (-\\frac{1}{\\sqrt{3}})\\right) = -\\frac{1}{2}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{1-\\sqrt{3}}{2\\sqrt{3}}\n$$\n\nAssembling these $8$ values into a single row matrix as specified completes the solution.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sqrt{3}+1}{4\\sqrt{3}}  \\frac{1-\\sqrt{3}}{2\\sqrt{3}}  \\frac{\\sqrt{3}+1}{4\\sqrt{3}}  -\\frac{\\sqrt{3}+1}{2\\sqrt{3}}  \\frac{\\sqrt{3}-1}{4\\sqrt{3}}  -\\frac{\\sqrt{3}+1}{2\\sqrt{3}}  \\frac{\\sqrt{3}-1}{4\\sqrt{3}}  \\frac{1-\\sqrt{3}}{2\\sqrt{3}}\n\\end{pmatrix}\n}\n$$", "id": "2585622"}, {"introduction": "The assembly of element matrices, such as the stiffness matrix, requires integrating expressions involving shape function gradients over the physical element. The isoparametric mapping transforms this integral to the parent domain, but the integrand—composed of gradients and the Jacobian—becomes a non-trivial function of the natural coordinates. This exercise challenges you to analyze the polynomial degree of this composite integrand to determine the minimum order of Gauss quadrature required for exact integration, a critical step for numerical accuracy [@problem_id:2585641].", "problem": "Consider a single isoparametric bilinear quadrilateral element in the Finite Element Method (FEM), with natural (parent) coordinates $(\\xi,\\eta)\\in\\hat{\\Omega}=[-1,1]\\times[-1,1]$. The isoparametric mapping to the physical element is given by\n$$\n\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{4}\\hat{N}_i(\\xi,\\eta)\\,\\mathbf{x}_i,\n$$\nwhere the four shape functions are bilinear polynomials on $\\hat{\\Omega}$,\n$$\n\\hat{N}_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\n\\hat{N}_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\n\\hat{N}_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\n\\hat{N}_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\nLet $\\hat{\\nabla}$ denote the gradient with respect to $(\\xi,\\eta)$, and let $J(\\xi,\\eta)$ denote the Jacobian matrix of the map $\\mathbf{x}(\\xi,\\eta)$ with entries $J_{ij}=\\partial x_i/\\partial \\xi_j$. Consider the integrand\n$$\nI(\\xi,\\eta) \\;=\\; \\big(J(\\xi,\\eta)^{-T}\\,\\hat{\\nabla}\\hat{N}_a(\\xi,\\eta)\\big)\\cdot\\big(J(\\xi,\\eta)^{-T}\\,\\hat{\\nabla}\\hat{N}_b(\\xi,\\eta)\\big)\\,\\det J(\\xi,\\eta),\n$$\nwhich appears in the element stiffness matrix entry for nodes $a$ and $b$.\n\nAssume the four physical nodes $\\{\\mathbf{x}_i\\}_{i=1}^{4}$ form a parallelogram in the plane so that the isoparametric map is affine. Under this assumption:\n\n1. Determine the total polynomial degree of $I(\\xi,\\eta)$ as a bivariate polynomial in $(\\xi,\\eta)$.\n\n2. Using the exactness property of tensor-product Gauss–Legendre quadrature in each coordinate direction, determine the smallest integer $n$ (number of Gauss–Legendre points per direction) that will integrate $I(\\xi,\\eta)$ exactly over $\\hat{\\Omega}$.\n\nState only the value of $n$ in your final answer as a single integer. No rounding is needed.", "solution": "The problem is first subjected to validation.\n\nStep 1: Extract Givens\n-   The computational domain is the natural (parent) element, a square defined by $(\\xi, \\eta) \\in \\hat{\\Omega} = [-1, 1] \\times [-1, 1]$.\n-   The element is an isoparametric bilinear quadrilateral.\n-   The isoparametric mapping from natural to physical coordinates is given by $\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} \\hat{N}_i(\\xi, \\eta) \\mathbf{x}_i$.\n-   The bilinear shape functions are:\n    $\\hat{N}_1(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta)$\n    $\\hat{N}_2(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta)$\n    $\\hat{N}_3(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta)$\n    $\\hat{N}_4(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta)$\n-   $\\hat{\\nabla}$ is the gradient operator with respect to natural coordinates $(\\xi, \\eta)$.\n-   $J(\\xi, \\eta)$ is the Jacobian matrix of the mapping $\\mathbf{x}(\\xi, \\eta)$.\n-   The integrand under consideration is $I(\\xi, \\eta) = \\left(J(\\xi, \\eta)^{-T} \\hat{\\nabla} \\hat{N}_a(\\xi, \\eta)\\right) \\cdot \\left(J(\\xi, \\eta)^{-T} \\hat{\\nabla} \\hat{N}_b(\\xi, \\eta)\\right) \\det J(\\xi, \\eta)$.\n-   A critical assumption is provided: the four physical nodes $\\{\\mathbf{x}_i\\}_{i=1}^{4}$ form a parallelogram, which implies the map $\\mathbf{x}(\\xi, \\eta)$ is affine.\n-   The tasks are to: (1) determine the total polynomial degree of $I(\\xi, \\eta)$, and (2) find the smallest integer $n$ (number of Gauss-Legendre points per direction) for exact integration of $I(\\xi, \\eta)$ over $\\hat{\\Omega}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard scenario in the finite element method. The core concepts, such as isoparametric mapping, Jacobians, and numerical quadrature, are fundamental to the field. The assumption that the element is a parallelogram is a specific, well-defined condition that simplifies the general case and leads to a determinate solution. The problem is self-contained, with all necessary definitions and conditions provided. It does not violate any scientific principles or contain ambiguities.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A solution will be constructed.\n\nThe coordinate transformation from the parent element to the physical element is given by\n$$\n\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} \\hat{N}_i(\\xi, \\eta) \\mathbf{x}_i\n$$\nwhere $\\mathbf{x}_i$ are the coordinates of the physical nodes. We can expand this expression by substituting the shape functions:\n$$\n\\mathbf{x}(\\xi,\\eta) = \\frac{1}{4}\\left[ (1-\\xi)(1-\\eta)\\mathbf{x}_1 + (1+\\xi)(1-\\eta)\\mathbf{x}_2 + (1+\\xi)(1+\\eta)\\mathbf{x}_3 + (1-\\xi)(1+\\eta)\\mathbf{x}_4 \\right]\n$$\nRearranging the terms based on the powers of $\\xi$, $\\eta$, and $\\xi\\eta$:\n$$\n\\mathbf{x}(\\xi,\\eta) = \\frac{1}{4}(\\mathbf{x}_1+\\mathbf{x}_2+\\mathbf{x}_3+\\mathbf{x}_4) + \\frac{1}{4}(-\\mathbf{x}_1+\\mathbf{x}_2+\\mathbf{x}_3-\\mathbf{x}_4)\\xi + \\frac{1}{4}(-\\mathbf{x}_1-\\mathbf{x}_2+\\mathbf{x}_3+\\mathbf{x}_4)\\eta + \\frac{1}{4}(\\mathbf{x}_1-\\mathbf{x}_2+\\mathbf{x}_3-\\mathbf{x}_4)\\xi\\eta\n$$\nThe mapping $\\mathbf{x}(\\xi, \\eta)$ is affine if and only if the coefficient of the nonlinear term $\\xi\\eta$ is zero. This requires:\n$$\n\\mathbf{x}_1 - \\mathbf{x}_2 + \\mathbf{x}_3 - \\mathbf{x}_4 = \\mathbf{0}\n$$\nThis is precisely the geometric condition for the four nodes to form a parallelogram, where $\\mathbf{x}_2 - \\mathbf{x}_1 = \\mathbf{x}_3 - \\mathbf{x}_4$. Under this assumption, the mapping simplifies to an affine transformation:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\mathbf{c} + \\mathbf{A}\\xi + \\mathbf{B}\\eta\n$$\nwhere $\\mathbf{c}$, $\\mathbf{A}$, and $\\mathbf{B}$ are constant vectors determined by the nodal coordinates.\n\nThe Jacobian matrix of this transformation is given by:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} A_x  B_x \\\\ A_y  B_y \\end{pmatrix} = \\left[ \\mathbf{A} \\mid \\mathbf{B} \\right]\n$$\nSince $\\mathbf{A}$ and $\\mathbf{B}$ are constant vectors, the Jacobian matrix $J$ is a constant matrix; it does not depend on the natural coordinates $(\\xi, \\eta)$. Consequently, its inverse $J^{-1}$, its inverse transpose $J^{-T}$, and its determinant $\\det J$ are also constants.\n\nNow, we analyze the integrand:\n$$\nI(\\xi, \\eta) = \\left( J^{-T} \\hat{\\nabla} \\hat{N}_a \\right) \\cdot \\left( J^{-T} \\hat{\\nabla} \\hat{N}_b \\right) \\det J\n$$\nLet the constant matrix $J^{-T}$ be denoted by $C$. The integrand becomes:\n$$\nI(\\xi, \\eta) = \\left( C \\hat{\\nabla} \\hat{N}_a \\right) \\cdot \\left( C \\hat{\\nabla} \\hat{N}_b \\right) \\det J\n$$\nSince $C$ and $\\det J$ are constants, the polynomial nature of $I(\\xi, \\eta)$ is entirely determined by the term $(\\hat{\\nabla} \\hat{N}_a) \\cdot (\\hat{\\nabla} \\hat{N}_b)$, where some constant scaling factors are involved. Let us analyze the gradients of the shape functions. For any shape function $\\hat{N}_i$, its gradient is $\\hat{\\nabla} \\hat{N}_i = \\left( \\frac{\\partial \\hat{N}_i}{\\partial \\xi}, \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\right)^T$.\nFor example, for $\\hat{N}_1(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi - \\eta + \\xi\\eta)$:\n$$\n\\frac{\\partial \\hat{N}_1}{\\partial \\xi} = \\frac{1}{4}(-1+\\eta) \\quad \\text{and} \\quad \\frac{\\partial \\hat{N}_1}{\\partial \\eta} = \\frac{1}{4}(-1+\\xi)\n$$\nIn general, for any of the four shape functions, $\\frac{\\partial \\hat{N}_i}{\\partial \\xi}$ is a polynomial of degree $1$ in $\\eta$ and degree $0$ in $\\xi$. Similarly, $\\frac{\\partial \\hat{N}_i}{\\partial \\eta}$ is a polynomial of degree $1$ in $\\xi$ and degree $0$ in $\\eta$.\n\nThe dot product term in the integrand, ignoring constant matrix multiplications for the moment, is:\n$$\n(\\hat{\\nabla} \\hat{N}_a) \\cdot (\\hat{\\nabla} \\hat{N}_b) = \\frac{\\partial \\hat{N}_a}{\\partial \\xi} \\frac{\\partial \\hat{N}_b}{\\partial \\xi} + \\frac{\\partial \\hat{N}_a}{\\partial \\eta} \\frac{\\partial \\hat{N}_b}{\\partial \\eta}\n$$\nThe first term, $\\frac{\\partial \\hat{N}_a}{\\partial \\xi} \\frac{\\partial \\hat{N}_b}{\\partial \\xi}$, is a product of two polynomials that are at most linear in $\\eta$. The result is a polynomial of at most degree $2$ in $\\eta$ and degree $0$ in $\\xi$.\nThe second term, $\\frac{\\partial \\hat{N}_a}{\\partial \\eta} \\frac{\\partial \\hat{N}_b}{\\partial \\eta}$, is a product of two polynomials that are at most linear in $\\xi$. The result is a polynomial of at most degree $2$ in $\\xi$ and degree $0$ in $\\eta$.\nThe sum of these two terms is a polynomial of the form $P(\\xi, \\eta) = P_{\\xi}(\\xi) + P_{\\eta}(\\eta)$, where $P_{\\xi}$ is a polynomial of degree at most $2$ in $\\xi$ and $P_{\\eta}$ is a polynomial of degree at most $2$ in $\\eta$.\nFor example, for $a=b=1$:\n$$\n(\\hat{\\nabla} \\hat{N}_1) \\cdot (\\hat{\\nabla} \\hat{N}_1) = \\left(\\frac{1}{4}\\right)^2 \\left( (-1+\\eta)^2 + (-1+\\xi)^2 \\right) = \\frac{1}{16} (\\eta^2 - 2\\eta + 1 + \\xi^2 - 2\\xi + 1)\n$$\nThis is a polynomial of degree $2$ in $\\xi$ and degree $2$ in $\\eta$. The total polynomial degree is $2$.\nThe full integrand $I(\\xi, \\eta)$ is a linear combination of such dot products, scaled by constants derived from $J$ and $\\det J$. Therefore, $I(\\xi, \\eta)$ is a polynomial in $(\\xi, \\eta)$ where the maximum degree in $\\xi$ is $2$, and the maximum degree in $\\eta$ is $2$.\n\nThe task is to find the smallest integer $n$ for the number of Gauss-Legendre quadrature points per direction required to integrate $I(\\xi, \\eta)$ exactly over $\\hat{\\Omega} = [-1, 1] \\times [-1, 1]$.\nA 1D $n$-point Gauss-Legendre quadrature rule integrates polynomials of degree up to $2n-1$ exactly. For a 2D tensor-product rule to be exact, the 1D rule must be exact for the maximum polynomial degree present in each respective variable.\nThe maximum polynomial degree of $I(\\xi, \\eta)$ with respect to $\\xi$ is $p_\\xi = 2$.\nThe maximum polynomial degree of $I(\\xi, \\eta)$ with respect to $\\eta$ is $p_\\eta = 2$.\n\nTo integrate exactly in the $\\xi$-direction, we require:\n$$\n2n - 1 \\geq p_\\xi \\implies 2n - 1 \\geq 2\n$$\nTo integrate exactly in the $\\eta$-direction, we require:\n$$\n2n - 1 \\geq p_\\eta \\implies 2n - 1 \\geq 2\n$$\nBoth conditions give the same inequality:\n$$\n2n \\geq 3 \\implies n \\geq 1.5\n$$\nSince the number of quadrature points $n$ must be an integer, the smallest integer value for $n$ satisfying this condition is $n=2$. Thus, a $2 \\times 2$ tensor-product Gauss-Legendre quadrature scheme is required for exact integration. The number of points per direction is $2$.", "answer": "$$\\boxed{2}$$", "id": "2585641"}, {"introduction": "While the isoparametric formulation can map to a wide variety of quadrilateral shapes, not all shapes are valid. A physically meaningful element requires that the mapping from the parent domain is one-to-one, or injective, which prevents the element from folding over itself. This exercise provides a hands-on method to verify an element's validity by analyzing the sign of the Jacobian determinant, $J(\\xi, \\eta)$, across the entire element, a fundamental check against excessive distortion [@problem_id:2585784].", "problem": "Consider the isoparametric bilinear mapping used in the Finite Element Method (FEM) from the parent square $[-1,1] \\times [-1,1]$ with natural coordinates $(\\xi,\\eta)$ to a physical quadrilateral with nodes ordered as in the parent domain: node $1$ at $(\\xi,\\eta)=(-1,-1)$, node $2$ at $(\\xi,\\eta)=(1,-1)$, node $3$ at $(\\xi,\\eta)=(1,1)$, node $4$ at $(\\xi,\\eta)=(-1,1)$. The corresponding physical coordinates of the nodes are\n- node $1$: $(x_1,y_1)=(0,0)$,\n- node $2$: $(x_2,y_2)=(3,0)$,\n- node $3$: $(x_3,y_3)=(2.5,1.2)$,\n- node $4$: $(x_4,y_4)=(-0.5,1)$.\n\nStarting from the standard definition of the four-node bilinear shape functions on the parent square and the isoparametric mapping $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$, $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$, derive the Jacobian determinant $J(\\xi,\\eta)=\\det\\left[\\partial(x,y)/\\partial(\\xi,\\eta)\\right]$ as an explicit function of $(\\xi,\\eta)$. Determine whether the mapping is injective over the entire parent square by checking the physical edge orientation and the sign of $J(\\xi,\\eta)$ at strategic points. Then compute the minimum value of $J(\\xi,\\eta)$ over $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$. Express your final answer as an exact value. Do not include units.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Parent Domain: A square in the $(\\xi,\\eta)$ plane defined by $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$.\n- Element Type: Four-node isoparametric bilinear element.\n- Node Mapping (Natural to Physical):\n  - Node $1$: $(\\xi,\\eta)=(-1,-1) \\rightarrow (x_1,y_1)=(0,0)$\n  - Node $2$: $(\\xi,\\eta)=(1,-1) \\rightarrow (x_2,y_2)=(3,0)$\n  - Node $3$: $(\\xi,\\eta)=(1,1) \\rightarrow (x_3,y_3)=(2.5,1.2)$\n  - Node $4$: $(\\xi,\\eta)=(-1,1) \\rightarrow (x_4,y_4)=(-0.5,1)$\n- Isoparametric Interpolation: The physical coordinates $(x,y)$ are interpolated from the nodal coordinates using the same shape functions $N_i(\\xi, \\eta)$ as the field variables:\n  $$x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$$\n  $$y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$$\n- Objective:\n  1. Derive the Jacobian determinant $J(\\xi,\\eta)=\\det\\left[\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right]$.\n  2. Evaluate the injectivity of the mapping.\n  3. Compute the minimum value of $J(\\xi,\\eta)$ on the parent domain.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is a standard exercise in the theory of the Finite Element Method, concerning the geometric mapping of elements. All concepts are well-established in computational mechanics and applied mathematics.\n- **Well-Posedness:** The problem provides all necessary data (nodal coordinates) and definitions (bilinear shape functions) to construct a unique mapping and its Jacobian. The tasks are specific and mathematically solvable.\n- **Objectivity and Completeness:** The problem is stated in precise, objective language. It is self-contained and free of ambiguity or contradiction. The physical coordinates define a convex quadrilateral, which is a standard case for such mappings.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a correct and well-posed problem in computational engineering. A solution will be constructed.\n\n**Derivation of the Jacobian Determinant**\n\nThe standard bilinear shape functions for a four-node quadrilateral element are:\n$$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\nThe isoparametric mapping for the coordinates $x$ and $y$ is given by:\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$$\n$$y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$$\n\nSubstituting the given nodal coordinates $(x_i, y_i)$:\n$x_1=0$, $y_1=0$\n$x_2=3$, $y_2=0$\n$x_3=\\frac{5}{2}$, $y_3=\\frac{6}{5}$\n$x_4=-\\frac{1}{2}$, $y_4=1$\n\nThe coordinate functions are:\n$$x(\\xi,\\eta) = N_2(\\xi,\\eta)(3) + N_3(\\xi,\\eta)(\\frac{5}{2}) + N_4(\\xi,\\eta)(-\\frac{1}{2})$$\n$$y(\\xi,\\eta) = N_3(\\xi,\\eta)(\\frac{6}{5}) + N_4(\\xi,\\eta)(1)$$\n\nExpanding these expressions:\n$$x(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(3) + \\frac{1}{4}(1+\\xi)(1+\\eta)(\\frac{5}{2}) + \\frac{1}{4}(1-\\xi)(1+\\eta)(-\\frac{1}{2})$$\n$$x(\\xi,\\eta) = \\frac{1}{4} \\left[ (3+3\\xi-3\\eta-3\\xi\\eta) + (\\frac{5}{2}+\\frac{5}{2}\\xi+\\frac{5}{2}\\eta+\\frac{5}{2}\\xi\\eta) + (-\\frac{1}{2}+\\frac{1}{2}\\xi-\\frac{1}{2}\\eta+\\frac{1}{2}\\xi\\eta) \\right]$$\nCollecting terms:\n$$x(\\xi,\\eta) = \\frac{1}{4} \\left[ (3+\\frac{5}{2}-\\frac{1}{2}) + (3+\\frac{5}{2}+\\frac{1}{2})\\xi + (-3+\\frac{5}{2}-\\frac{1}{2})\\eta + (-3+\\frac{5}{2}+\\frac{1}{2})\\xi\\eta \\right]$$\n$$x(\\xi,\\eta) = \\frac{1}{4} [5 + 6\\xi - 1\\eta + 0\\xi\\eta] = \\frac{5}{4} + \\frac{3}{2}\\xi - \\frac{1}{4}\\eta$$\n\nFor the $y$ coordinate:\n$$y(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)(\\frac{6}{5}) + \\frac{1}{4}(1-\\xi)(1+\\eta)(1)$$\n$$y(\\xi,\\eta) = \\frac{1+\\eta}{4} \\left[ (1+\\xi)(\\frac{6}{5}) + (1-\\xi)(1) \\right] = \\frac{1+\\eta}{4} \\left[ \\frac{6}{5}+\\frac{6}{5}\\xi + 1-\\xi \\right]$$\n$$y(\\xi,\\eta) = \\frac{1+\\eta}{4} \\left[ \\frac{11}{5} + \\frac{1}{5}\\xi \\right] = \\frac{1}{20}(1+\\eta)(11+\\xi)$$\n$$y(\\xi,\\eta) = \\frac{1}{20}(11+\\xi+11\\eta+\\xi\\eta)$$\n\nThe Jacobian matrix $\\mathbf{J}$ is defined as $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}$. We compute its components:\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{5}{4} + \\frac{3}{2}\\xi - \\frac{1}{4}\\eta \\right) = \\frac{3}{2}$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{5}{4} + \\frac{3}{2}\\xi - \\frac{1}{4}\\eta \\right) = -\\frac{1}{4}$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{1}{20}(11+\\xi+11\\eta+\\xi\\eta) \\right) = \\frac{1}{20}(1+\\eta)$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{1}{20}(11+\\xi+11\\eta+\\xi\\eta) \\right) = \\frac{1}{20}(11+\\xi)$$\n\nThe Jacobian matrix is:\n$$\\mathbf{J}(\\xi,\\eta) = \\begin{bmatrix} \\frac{3}{2}  -\\frac{1}{4} \\\\ \\frac{1}{20}(1+\\eta)  \\frac{1}{20}(11+\\xi) \\end{bmatrix}$$\n\nThe Jacobian determinant $J(\\xi,\\eta)$ is the determinant of this matrix:\n$$J(\\xi,\\eta) = \\det(\\mathbf{J}) = \\left(\\frac{3}{2}\\right)\\left(\\frac{1}{20}(11+\\xi)\\right) - \\left(-\\frac{1}{4}\\right)\\left(\\frac{1}{20}(1+\\eta)\\right)$$\n$$J(\\xi,\\eta) = \\frac{3}{40}(11+\\xi) + \\frac{1}{80}(1+\\eta)$$\nTo simplify, we use a common denominator of $80$:\n$$J(\\xi,\\eta) = \\frac{6(11+\\xi)}{80} + \\frac{1+\\eta}{80} = \\frac{66+6\\xi+1+\\eta}{80}$$\n$$J(\\xi,\\eta) = \\frac{67+6\\xi+\\eta}{80}$$\n\n**Injectivity of the Mapping**\nFor an isoparametric mapping from a convex parent element to a convex physical element, a sufficient condition for the mapping to be injective (one-to-one) is that the Jacobian determinant $J(\\xi,\\eta)$ is strictly positive (or strictly negative) for all $(\\xi,\\eta)$ in the parent domain.\nThe derived Jacobian determinant, $J(\\xi,\\eta) = \\frac{1}{80}(67+6\\xi+\\eta)$, is a linear function of $\\xi$ and $\\eta$. The extrema of a linear function over a rectangular domain must occur at the vertices of the domain. We evaluate $J(\\xi,\\eta)$ at the four corners of the parent square $[-1,1] \\times [-1,1]$:\n- At $(\\xi,\\eta)=(-1,-1)$: $J(-1,-1) = \\frac{1}{80}(67 - 6 - 1) = \\frac{60}{80} = \\frac{3}{4}$\n- At $(\\xi,\\eta)=(1,-1)$: $J(1,-1) = \\frac{1}{80}(67 + 6 - 1) = \\frac{72}{80} = \\frac{9}{10}$\n- At $(\\xi,\\eta)=(1,1)$: $J(1,1) = \\frac{1}{80}(67 + 6 + 1) = \\frac{74}{80} = \\frac{37}{40}$\n- At $(\\xi,\\eta)=(-1,1)$: $J(-1,1) = \\frac{1}{80}(67 - 6 + 1) = \\frac{62}{80} = \\frac{31}{40}$\n\nAll four values are positive. Since $J(\\xi,\\eta)$ is a linear function, its values inside the square are a convex combination of the corner values. Therefore, $J(\\xi,\\eta)$ is positive everywhere within the domain $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$. The condition for injectivity is satisfied. The mapping is injective.\n\n**Minimum Value of the Jacobian Determinant**\nAs established, the minimum of the linear function $J(\\xi,\\eta)$ on the square domain must be at one of its corners. By comparing the four corner values: $\\frac{3}{4}=0.75$, $\\frac{9}{10}=0.9$, $\\frac{37}{40}=0.925$, and $\\frac{31}{40}=0.775$. The minimum value is $\\frac{3}{4}$.\nAlternatively, the function to minimize is $f(\\xi,\\eta) = 67+6\\xi+\\eta$. The gradient is $\\nabla f = (6,1)$, which is a constant vector. The minimum value of $f$ on the domain $[-1,1]\\times[-1,1]$ will occur at the point $(\\xi,\\eta)=(-1,-1)$, which is furthest in the direction opposite to the gradient.\nThe minimum value of the Jacobian determinant is therefore:\n$$J_{min} = J(-1,-1) = \\frac{3}{4}$$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2585784"}]}