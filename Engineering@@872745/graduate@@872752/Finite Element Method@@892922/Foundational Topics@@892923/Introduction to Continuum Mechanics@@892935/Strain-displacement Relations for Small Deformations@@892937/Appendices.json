{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin with the simplest possible scenario: the deformation of a one-dimensional bar. This exercise guides you through the derivation of the linearized small strain measure from the more general, nonlinear Green-Lagrange strain, a fundamental process in continuum mechanics. By applying this to a simple linear displacement field [@problem_id:2601702], you will concretely distinguish between the component of displacement that causes strain (stretching or compression) and the component that represents strain-free rigid-body motion.", "problem": "Consider a small-deformation kinematics setting for a one-dimensional elastic bar in the reference configuration with material coordinate $X \\in [0,L]$. The motion is given by the mapping $x(X) = X + u(X)$, where $u(X)$ is the displacement field. Use the definition of the Green–Lagrange strain (a Lagrangian strain measure) and its linearization about zero displacement gradient to obtain the small (infinitesimal) strain. Then, for the affine displacement field $u(X) = a X + b$, where $a$ and $b$ are constants with $|a| \\ll 1$, compute the resulting constant infinitesimal strain and provide a brief physical interpretation of the roles of $a$ and $b$ in terms of uniform strain and rigid translation. Express the final strain as a dimensionless quantity. The final reported answer must be the value of the constant infinitesimal strain as a single symbolic expression in terms of $a$ only.", "solution": "The problem statement is submitted for validation.\n\n**Step 1: Extract Givens**\n-   System: One-dimensional elastic bar.\n-   Material coordinate: $X \\in [0,L]$.\n-   Motion mapping: $x(X) = X + u(X)$, where $u(X)$ is the displacement field.\n-   Strain measure to use: Green–Lagrange strain, followed by its linearization about zero displacement gradient to obtain the small (infinitesimal) strain.\n-   Specified displacement field: $u(X) = a X + b$.\n-   Constants: $a$, $b$.\n-   Constraint: $|a| \\ll 1$.\n-   Task 1: Compute the constant infinitesimal strain for the given displacement field.\n-   Task 2: Provide a physical interpretation of the roles of constants $a$ and $b$.\n-   Final Answer requirement: The constant infinitesimal strain as a single symbolic expression in terms of $a$ only.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is subjected to critical examination.\n-   **Scientific Groundedness**: The problem is based on fundamental principles of continuum mechanics, specifically the kinematics of deformable bodies. The concepts of a reference configuration, displacement field, Green-Lagrange strain, and its linearization to infinitesimal strain are standard, well-established topics in solid mechanics and finite element theory. The problem is scientifically sound.\n-   **Well-Posedness**: The problem is clearly stated. It provides all necessary information: the kinematic relation, the definition of strain to be used (implicitly through its name and derivation method), and a specific displacement field. The objective is to perform a standard derivation and apply it to a simple, illustrative case. A unique and meaningful solution exists.\n-   **Objectivity**: The language is precise and free of subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem is found to be valid. It is a standard, fundamental exercise in continuum mechanics. Proceeding with the solution.\n\nThe solution is developed as follows.\n\nThe motion of a point in the one-dimensional body is described by its final position $x$ as a function of its initial position $X$ in the reference configuration. This is given by the mapping $x(X) = X + u(X)$, where $u(X)$ is the displacement field.\n\nFirst, we define the deformation gradient, $F$. In one dimension, this is a scalar quantity defined as the derivative of the current position with respect to the reference position:\n$$\nF = \\frac{dx}{dX}\n$$\nSubstituting the given mapping $x(X)$:\n$$\nF = \\frac{d}{dX} (X + u(X)) = 1 + \\frac{du}{dX}\n$$\nThe term $\\frac{du}{dX}$ is the displacement gradient.\n\nNext, we introduce the Green–Lagrange strain tensor, $\\mathbf{E}$. In a general three-dimensional setting, it is defined as $\\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^T \\mathbf{F} - \\mathbf{I})$, where $\\mathbf{F}$ is the deformation gradient tensor and $\\mathbf{I}$ is the identity tensor. For our one-dimensional case, this definition simplifies to a scalar equation:\n$$\nE = \\frac{1}{2}(F^2 - 1)\n$$\nThis strain measure is defined with respect to the reference (Lagrangian) configuration and is geometrically exact, meaning it is valid for arbitrarily large deformations and rotations.\n\nSubstituting the expression for $F$ into the equation for $E$:\n$$\nE = \\frac{1}{2} \\left( \\left(1 + \\frac{du}{dX}\\right)^2 - 1 \\right)\n$$\nExpanding the squared term:\n$$\nE = \\frac{1}{2} \\left( 1 + 2\\frac{du}{dX} + \\left(\\frac{du}{dX}\\right)^2 - 1 \\right)\n$$\nSimplifying the expression yields the exact one-dimensional Green–Lagrange strain:\n$$\nE = \\frac{du}{dX} + \\frac{1}{2}\\left(\\frac{du}{dX}\\right)^2\n$$\nThis is a nonlinear function of the displacement gradient.\n\nThe problem requires the derivation of the small or infinitesimal strain, denoted here by $\\epsilon$. This is obtained by linearizing the Green–Lagrange strain $E$ under the assumption of small deformations. The small deformation kinematics implies that the magnitude of the displacement gradient is much less than unity:\n$$\n\\left|\\frac{du}{dX}\\right| \\ll 1\n$$\nUnder this condition, the quadratic term $\\left(\\frac{du}{dX}\\right)^2$ is negligible in comparison to the linear term $\\frac{du}{dX}$. By neglecting this higher-order term, we arrive at the linearized strain, also known as the infinitesimal strain or Cauchy strain:\n$$\n\\epsilon \\approx \\frac{du}{dX}\n$$\nThis is the fundamental strain-displacement relation for small deformations in one dimension.\n\nNow, we apply this result to the specified affine displacement field:\n$$\nu(X) = aX + b\n$$\nThe constants $a$ and $b$ are given, with the constraint $|a| \\ll 1$. We compute the displacement gradient:\n$$\n\\frac{du}{dX} = \\frac{d}{dX}(aX + b) = a\n$$\nSubstituting this result into the expression for infinitesimal strain $\\epsilon$:\n$$\n\\epsilon = a\n$$\nThe strain is a constant value $a$, independent of the material coordinate $X$. This is consistent with the problem's request for the \"constant infinitesimal strain.\" The condition $|a| \\ll 1$ validates the use of the small-strain approximation, as it directly corresponds to $|\\frac{du}{dX}| \\ll 1$. The strain $a$ is a dimensionless quantity, representing the change in length per unit original length.\n\nFinally, we provide a physical interpretation of the constants $a$ and $b$.\n-   The constant $a$ is the infinitesimal strain $\\epsilon$. It represents a uniform deformation of the bar. If $a > 0$, the bar undergoes uniform extension (stretching). If $a < 0$, the bar undergoes uniform compression. The displacement component $aX$ is responsible for this change in the bar's length.\n-   The constant $b$ represents a uniform displacement of every material point in the bar. The entire bar is shifted rigidly along the axis by a distance $b$ without any change in its length, shape, or orientation. This is a rigid-body translation. It does not induce any strain, as is evident from the fact that it disappears upon differentiation with respect to $X$.\n\nThe final answer required is the value of the constant infinitesimal strain in terms of $a$ only. As derived, this value is $a$.", "answer": "$$\n\\boxed{a}\n$$", "id": "2601702"}, {"introduction": "Building on the one-dimensional case, we now move to a two-dimensional plane to explore a deeper concept: the decomposition of motion. Any displacement field can be locally broken down into a part that deforms the material (strain) and a part that moves it rigidly (translation and rotation). This practice [@problem_id:2601697] provides a specific displacement field representing a pure rotation and asks you to demonstrate that it correctly yields a zero strain tensor, making the distinction between strain and rotation exceptionally clear.", "problem": "Consider the planar motion of a continuum body occupying an open set $\\Omega \\subset \\mathbb{R}^{2}$ with Cartesian coordinates $(x,y)$. The displacement field is prescribed by $u_{x}(x,y)=-\\theta\\,y$ and $u_{y}(x,y)=\\theta\\,x$, where $\\theta$ is a constant parameter with the dimension of an angle and is sufficiently small to justify the small-deformation kinematics used in the finite element method. Starting only from the standard definitions of the small-strain tensor and the infinitesimal rotation tensor, carry out the following tasks:\n\n- Derive the components of the small-strain tensor $\\epsilon_{ij}$ and the infinitesimal rotation tensor $\\omega_{ij}$ in Cartesian coordinates.\n- Using the linearization of the deformation gradient appropriate to small deformations, justify that the motion is a rigid-body rotation to first order in $\\theta$, explicitly stating any terms you neglect in your argument.\n- Compute the scalar invariant $I_{\\epsilon}=\\epsilon_{ij}\\,\\epsilon_{ij}$ (Einstein summation convention) and report this scalar as your final answer.\n\nExpress the final answer as a single real number with no units. No rounding is necessary.", "solution": "The context is small-deformation kinematics as used in the finite element method. The fundamental kinematic quantities are defined as follows. For a displacement field $u_{i}(x_{j})$, the displacement gradient is $u_{i,j}=\\partial u_{i}/\\partial x_{j}$. The small-strain tensor and infinitesimal rotation tensor are the symmetric and skew-symmetric parts of the displacement gradient:\n$$\n\\epsilon_{ij}=\\tfrac{1}{2}\\left(u_{i,j}+u_{j,i}\\right),\\qquad \\omega_{ij}=\\tfrac{1}{2}\\left(u_{i,j}-u_{j,i}\\right).\n$$\nGiven $u_{x}(x,y)=-\\theta\\,y$ and $u_{y}(x,y)=\\theta\\,x$ with $\\theta$ constant, we compute the displacement gradient components:\n$$\nu_{x,x}=\\frac{\\partial u_{x}}{\\partial x}=0,\\quad\nu_{x,y}=\\frac{\\partial u_{x}}{\\partial y}=-\\theta,\\quad\nu_{y,x}=\\frac{\\partial u_{y}}{\\partial x}=\\theta,\\quad\nu_{y,y}=\\frac{\\partial u_{y}}{\\partial y}=0.\n$$\nAssemble the gradient in matrix form (with the first index as row and the second as column):\n$$\n\\nabla \\mathbf{u}=\n\\begin{pmatrix}\nu_{x,x} & u_{x,y}\\\\[4pt]\nu_{y,x} & u_{y,y}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & -\\theta\\\\[4pt]\n\\theta & 0\n\\end{pmatrix}.\n$$\nCompute the small-strain tensor $\\epsilon_{ij}$:\n- The normal strain components are\n$$\n\\epsilon_{xx}=\\tfrac{1}{2}\\left(u_{x,x}+u_{x,x}\\right)=u_{x,x}=0,\\qquad\n\\epsilon_{yy}=\\tfrac{1}{2}\\left(u_{y,y}+u_{y,y}\\right)=u_{y,y}=0.\n$$\n- The shear strain component is\n$$\n\\epsilon_{xy}=\\epsilon_{yx}=\\tfrac{1}{2}\\left(u_{x,y}+u_{y,x}\\right)=\\tfrac{1}{2}\\left(-\\theta+\\theta\\right)=0.\n$$\nHence,\n$$\n\\boldsymbol{\\epsilon}=\n\\begin{pmatrix}\n0 & 0\\\\[4pt]\n0 & 0\n\\end{pmatrix}.\n$$\nCompute the infinitesimal rotation tensor $\\omega_{ij}$:\n- The only independent off-diagonal component is\n$$\n\\omega_{xy}=\\tfrac{1}{2}\\left(u_{x,y}-u_{y,x}\\right)=\\tfrac{1}{2}\\left(-\\theta-\\theta\\right)=-\\theta,\n$$\nand by skew-symmetry $\\omega_{yx}=-\\omega_{xy}=\\theta$, with the diagonal components zero. Therefore,\n$$\n\\boldsymbol{\\omega}=\n\\begin{pmatrix}\n0 & -\\theta\\\\[4pt]\n\\theta & 0\n\\end{pmatrix}.\n$$\nInterpretation as a rigid-body rotation to first order. In small-deformation kinematics, the deformation gradient is linearized as\n$$\n\\mathbf{F}\\approx \\mathbf{I}+\\nabla \\mathbf{u}.\n$$\nFor the present motion,\n$$\n\\mathbf{F}\\approx\n\\begin{pmatrix}\n1 & 0\\\\[4pt]\n0 & 1\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n0 & -\\theta\\\\[4pt]\n\\theta & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & -\\theta\\\\[4pt]\n\\theta & 1\n\\end{pmatrix}.\n$$\nThe determinant is\n$$\n\\det\\mathbf{F}=1\\cdot 1-(-\\theta)\\theta=1+\\theta^{2}.\n$$\nTo first order in $\\theta$, terms of order $\\theta^{2}$ are neglected, so\n$$\n\\det\\mathbf{F}=1+\\mathcal{O}\\!\\left(\\theta^{2}\\right)\\approx 1.\n$$\nThis indicates no volumetric change to first order. Moreover, the vanishing of all components of $\\boldsymbol{\\epsilon}$ shows there is no strain to first order. Together, these facts characterize a rigid-body rotation at the infinitesimal level with rotation rate about the out-of-plane axis equal to $\\theta$.\n\nFinally, compute the requested scalar invariant\n$$\nI_{\\epsilon}=\\epsilon_{ij}\\,\\epsilon_{ij}=\n\\epsilon_{xx}^{2}+2\\,\\epsilon_{xy}^{2}+\\epsilon_{yy}^{2}=0+2\\cdot 0+0=0.\n$$\nTherefore, the required scalar is zero exactly (and in particular to first order in $\\theta$), which is consistent with a pure rigid-body rotation producing no strain in the linearized kinematics.", "answer": "$$\\boxed{0}$$", "id": "2601697"}, {"introduction": "The final practice bridges the gap between continuous theory and computational practice, a crucial step in mastering the finite element method. You are tasked with implementing the \"patch test,\" a fundamental verification procedure for any finite element formulation [@problem_id:2601633]. This hands-on coding exercise will guide you to programmatically confirm that a standard bilinear quadrilateral element (Q4) can exactly reproduce an arbitrary constant strain state, a critical property that ensures the reliability and convergence of finite element simulations.", "problem": "You must write a complete, runnable program that verifies the constant-strain patch test for a two-dimensional isoparametric quadrilateral element of bilinear order (commonly called Q4) under small deformations. The patch consists of four Q4 elements forming a $2 \\times 2$ mesh over a rectangle. A uniform displacement gradient is prescribed, from which exact strains are known. Your program must compute numerically recovered small strains from the nodal displacements at standard Gaussian quadrature points and report an error metric that compares the computed strains to the exact constant strain.\n\nStart from the following fundamental base:\n- Small-strain kinematics: for a displacement field $\\boldsymbol{u}(\\boldsymbol{x}) = [u_x(\\boldsymbol{x}), u_y(\\boldsymbol{x})]^T$, the small-strain tensor is defined by\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u}(\\boldsymbol{x}) + \\nabla \\boldsymbol{u}(\\boldsymbol{x})^T\\right).\n$$\n- Isoparametric mapping for a Q4 element with natural coordinates $(\\xi,\\eta) \\in [-1,1]^2$ uses the bilinear shape functions\n$$\nN_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\nTheir derivatives with respect to $(\\xi,\\eta)$, together with the Jacobian matrix of the geometric mapping, allow you to obtain the spatial derivatives $\\partial N_a/\\partial x$ and $\\partial N_a/\\partial y$ by the chain rule. The displacement field inside each element is interpolated as $\\boldsymbol{u}_h(\\boldsymbol{x}) = \\sum_{a=1}^4 N_a(\\xi,\\eta)\\,\\boldsymbol{u}_a$, with $\\boldsymbol{u}_a$ the nodal displacements. The displacement gradient is then computed from $\\nabla \\boldsymbol{u}_h = \\sum_{a=1}^4 \\boldsymbol{u}_a \\otimes \\nabla N_a$.\n\nYour program must:\n- Build a $2 \\times 2$ patch of Q4 elements over a rectangle of size $L_x \\times L_y$, discretized with nodes at $x \\in \\{0, L_x/2, L_x\\}$ and $y \\in \\{0, L_y/2, L_y\\}$, giving $9$ nodes and $4$ elements.\n- Use the local node ordering per element corresponding to $(\\xi,\\eta)$ corners $(-1,-1)$, $(+1,-1)$, $(+1,+1)$, $(-1,+1)$, i.e., bottom-left, bottom-right, top-right, top-left.\n- Prescribe a uniform displacement field\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{u}_0 + \\mathbf{G}\\,\\boldsymbol{x},\n$$\nwhere $\\boldsymbol{x} = [x,y]^T$, $\\boldsymbol{u}_0 \\in \\mathbb{R}^2$ is a constant translation, and $\\mathbf{G} \\in \\mathbb{R}^{2 \\times 2}$ is a constant displacement gradient. This produces an exact constant small-strain tensor\n$$\n\\boldsymbol{\\varepsilon}^{\\text{exact}} = \\tfrac{1}{2}\\left(\\mathbf{G} + \\mathbf{G}^T\\right).\n$$\n- Compute, for each element and for each of the standard $2 \\times 2$ Gauss points at $(\\xi,\\eta) \\in \\{(-\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}), (\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}), (\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}}), (-\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}})\\}$, the numerically recovered small-strain tensor $\\boldsymbol{\\varepsilon}^{\\text{num}}$ by:\n    - Evaluating $\\partial N_a/\\partial x$ and $\\partial N_a/\\partial y$ via the isoparametric Jacobian at the Gauss point.\n    - Computing $\\nabla \\boldsymbol{u}_h$ from nodal displacements and then $\\boldsymbol{\\varepsilon}^{\\text{num}} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u}_h + \\nabla \\boldsymbol{u}_h^T\\right)$.\n- Quantify the patch-test error by the root-mean-square Frobenius norm of the difference between the numerical and exact strains over all Gauss points of all elements, namely\n$$\nE_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{q=1}^{N} \\left\\| \\boldsymbol{\\varepsilon}^{\\text{num}}(\\boldsymbol{x}_q) - \\boldsymbol{\\varepsilon}^{\\text{exact}} \\right\\|_F^2},\n$$\nwhere $\\|\\cdot\\|_F$ is the Frobenius norm and $N$ is the total number of Gauss points in the patch. This number is expected to be on the order of machine precision for a proper patch test.\n\nTest Suite:\nImplement your program to evaluate $E_{\\text{RMS}}$ for the following five parameter sets. All quantities are dimensionless.\n- Case $1$ (general constant gradient on a moderate rectangle):\n    - $L_x = 2$, $L_y = 1$\n    - $\\boldsymbol{u}_0 = [0.1, -0.2]^T$\n    - $\\mathbf{G} = \\begin{bmatrix} 0.02 & 0.01 \\\\ 0 & -0.03 \\end{bmatrix}$\n- Case $2$ (pure rigid translation; zero strain):\n    - $L_x = 3$, $L_y = 2$\n    - $\\boldsymbol{u}_0 = [-5.0, 7.0]^T$\n    - $\\mathbf{G} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$\n- Case $3$ (pure rigid rotation; zero strain):\n    - $L_x = 1$, $L_y = 1$\n    - $\\boldsymbol{u}_0 = [0, 0]^T$\n    - $\\mathbf{G} = \\begin{bmatrix} 0 & -0.2 \\\\ 0.2 & 0 \\end{bmatrix}$\n- Case $4$ (high aspect ratio rectangle):\n    - $L_x = 2.5$, $L_y = 10^{-3}$\n    - $\\boldsymbol{u}_0 = [-10^{-3}, 2 \\cdot 10^{-3}]^T$\n    - $\\mathbf{G} = \\begin{bmatrix} 10^{-4} & 2 \\cdot 10^{-4} \\\\ 3 \\cdot 10^{-4} & -2 \\cdot 10^{-4} \\end{bmatrix}$\n- Case $5$ (symmetric nontrivial gradient on a tall rectangle):\n    - $L_x = 0.5$, $L_y = 2$\n    - $\\boldsymbol{u}_0 = [0, 0]^T$\n    - $\\mathbf{G} = \\begin{bmatrix} 0.03 & 0.01 \\\\ 0.01 & 0.005 \\end{bmatrix}$\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above, where each entry is the scalar $E_{\\text{RMS}}$ for that case. For example, an output with three hypothetical results should look like \"[$r_1$,$r_2$,$r_3$]\". Do not print any other text.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n\n- **Problem Type**: Verification of the constant-strain patch test for a two-dimensional isoparametric quadrilateral element (Q4) under small deformations.\n- **Mesh**: A $2 \\times 2$ patch of $4$ Q4 elements over a rectangle of size $L_x \\times L_y$. The mesh has $9$ nodes at coordinates $x \\in \\{0, L_x/2, L_x\\}$ and $y \\in \\{0, L_y/2, L_y\\}$.\n- **Small-Strain Tensor**: $\\boldsymbol{\\varepsilon}(\\boldsymbol{x}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u}(\\boldsymbol{x}) + \\nabla \\boldsymbol{u}(\\boldsymbol{x})^T\\right)$.\n- **Q4 Shape Functions**:\n  - $N_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta)$\n  - $N_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta)$\n  - $N_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta)$\n  - $N_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta)$\n- **Local Node Ordering**: Corresponds to $(\\xi,\\eta)$ corners $(-1,-1)$, $(+1,-1)$, $(+1,+1)$, $(-1,+1)$.\n- **Displacement Field Interpolation**: $\\boldsymbol{u}_h(\\boldsymbol{x}) = \\sum_{a=1}^4 N_a(\\xi,\\eta)\\,\\boldsymbol{u}_a$.\n- **Prescribed Displacement Field**: $\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{u}_0 + \\mathbf{G}\\,\\boldsymbol{x}$, where $\\boldsymbol{u}_0$ is a constant vector and $\\mathbf{G}$ is a constant displacement gradient matrix.\n- **Exact Strain Tensor**: $\\boldsymbol{\\varepsilon}^{\\text{exact}} = \\tfrac{1}{2}\\left(\\mathbf{G} + \\mathbf{G}^T\\right)$.\n- **Numerical Strain Calculation Points**: Standard $2 \\times 2$ Gauss points at $(\\xi,\\eta) \\in \\{(-\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}), (\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}), (\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}}), (-\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}})\\}$.\n- **Error Metric**: $E_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{q=1}^{N} \\left\\| \\boldsymbol{\\varepsilon}^{\\text{num}}(\\boldsymbol{x}_q) - \\boldsymbol{\\varepsilon}^{\\text{exact}} \\right\\|_F^2}$, where $N$ is the total number of Gauss points.\n- **Test Cases**:\n    - Case $1$: $L_x = 2$, $L_y = 1$, $\\boldsymbol{u}_0 = [0.1, -0.2]^T$, $\\mathbf{G} = \\begin{bmatrix} 0.02 & 0.01 \\\\ 0 & -0.03 \\end{bmatrix}$.\n    - Case $2$: $L_x = 3$, $L_y = 2$, $\\boldsymbol{u}_0 = [-5.0, 7.0]^T$, $\\mathbf{G} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$.\n    - Case $3$: $L_x = 1$, $L_y = 1$, $\\boldsymbol{u}_0 = [0, 0]^T$, $\\mathbf{G} = \\begin{bmatrix} 0 & -0.2 \\\\ 0.2 & 0 \\end{bmatrix}$.\n    - Case $4$: $L_x = 2.5$, $L_y = 10^{-3}$, $\\boldsymbol{u}_0 = [-10^{-3}, 2 \\cdot 10^{-3}]^T$, $\\mathbf{G} = \\begin{bmatrix} 10^{-4} & 2 \\cdot 10^{-4} \\\\ 3 \\cdot 10^{-4} & -2 \\cdot 10^{-4} \\end{bmatrix}$.\n    - Case $5$: $L_x = 0.5$, $L_y = 2$, $\\boldsymbol{u}_0 = [0, 0]^T$, $\\mathbf{G} = \\begin{bmatrix} 0.03 & 0.01 \\\\ 0.01 & 0.005 \\end{bmatrix}$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement is analyzed for validity.\n- **Scientific or Factual Unsoundness**: The problem is scientifically sound. It describes the patch test, a standard and fundamental verification procedure in the finite element method. The provided equations for small-strain kinematics, bilinear shape functions, isoparametric mapping, and strain recovery are all correct and standard in the field of computational mechanics.\n- **Non-Formalizable or Irrelevant**: The problem is highly formalizable and directly relevant to the topic of strain-displacement relations within the finite element method.\n- **Incomplete or Contradictory Setup**: The problem is fully self-contained. It provides all necessary information: mesh geometry, element type, shape functions, local ordering, prescribed displacement field, analysis points (Gauss quadrature), a precise error metric, and a complete set of test parameters. There are no contradictions.\n- **Unrealistic or Infeasible**: The conditions are standard for a numerical a test. The patch test is, by design, a test of the code's ability to reproduce a simple, known solution. The parameters are physically plausible for small deformations.\n- **Ill-Posed or Poorly Structured**: The problem is well-posed. The procedure is deterministic and leads to a unique numerical result for each test case. The expected result (error on the order of machine precision) is a direct consequence of the completeness of bilinear shape functions for linear fields.\n- **Pseudo-Profound, Trivial, Tautological**: While the expected outcome is that the error is near zero, the implementation is non-trivial. It requires correct application of isoparametric mapping, chain rule for derivatives, and assembly of the strain-displacement relations. It is a substantive computational problem, not a trivial exercise.\n- **Outside Scientific Verifiability**: The problem is perfectly verifiable by implementing the described numerical procedure and performing the calculation.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. It is a well-posed, scientifically sound, and complete problem statement from computational solid mechanics. A reasoned solution will be provided.\n\n---\n\nThe problem requires the implementation of a constant-strain patch test for a mesh of four Q4 bilinear isoparametric elements. The core principle of the patch test is to verify that the finite element formulation can exactly reproduce a constant strain state, up to machine precision. For a Q4 element, whose shape functions are bilinear, it is known that a displacement field that is a linear function of the spatial coordinates can be represented exactly. The prescribed displacement field $\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{u}_0 + \\mathbf{G}\\,\\boldsymbol{x}$ is indeed linear, which implies a constant displacement gradient $\\nabla\\boldsymbol{u} = \\mathbf{G}$ and a constant strain tensor $\\boldsymbol{\\varepsilon}^{\\text{exact}} = \\frac{1}{2}(\\mathbf{G} + \\mathbf{G}^T)$. The numerical procedure must recover this exact constant strain at all integration points.\n\nThe procedure is as follows:\n\nFirst, we define the computational domain and mesh. A $2 \\times 2$ regular mesh on a rectangle $[0, L_x] \\times [0, L_y]$ consists of $9$ nodes and $4$ elements. Let the global node indices be arranged as:\n$$\n\\begin{matrix}\n6 & - & 7 & - & 8 \\\\\n| & E_3 & | & E_4 & | \\\\\n3 & - & 4 & - & 5 \\\\\n| & E_1 & | & E_2 & | \\\\\n0 & - & 1 & - & 2\n\\end{matrix}\n$$\nThe coordinates of node $i$ are denoted $\\boldsymbol{x}_i$. Following the specified local node ordering (bottom-left, bottom-right, top-right, top-left), the element connectivity which maps global node indices to local element nodes is:\n- Element $1$: $[0, 1, 4, 3]$\n- Element $2$: $[1, 2, 5, 4]$\n- Element $3$: $[3, 4, 7, 6]$\n- Element $4$: $[4, 5, 8, 7]$\n\nNodal displacements $\\boldsymbol{u}_i$ for each global node $i$ are computed by evaluating the prescribed field at the nodal coordinates: $\\boldsymbol{u}_i = \\boldsymbol{u}(\\boldsymbol{x}_i) = \\boldsymbol{u}_0 + \\mathbf{G} \\boldsymbol{x}_i$.\n\nThe core of the calculation occurs within each element at each specified Gauss quadrature point $(\\xi_q, \\eta_q)$. For the Q4 element, the relationship between spatial derivatives and derivatives in the natural coordinate system $(\\xi, \\eta)$ is given by the chain rule:\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\mathbf{J} \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix}\n$$\nwhere $\\mathbf{J}$ is the Jacobian matrix of the isoparametric map $\\boldsymbol{x}(\\xi,\\eta) = \\sum_{a=1}^4 N_a(\\xi,\\eta) \\boldsymbol{x}_a$. The components of $\\mathbf{J}$ are computed as $J_{11} = \\sum_{a=1}^4 \\frac{\\partial N_a}{\\partial\\xi} x_a$, $J_{12} = \\sum_{a=1}^4 \\frac{\\partial N_a}{\\partial\\xi} y_a$, and so on. The derivatives of the shape functions $N_a$ with respect to $(\\xi, \\eta)$ are simple linear functions. For example, $\\frac{\\partial N_1}{\\partial\\xi} = -\\frac{1}{4}(1-\\eta)$.\n\nTo compute the strain, we require the spatial derivatives of the shape functions, which are obtained by inverting the relationship:\n$$\n\\begin{Bmatrix} \\frac{\\partial N_a}{\\partial x} \\\\ \\frac{\\partial N_a}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_a}{\\partial \\xi} \\\\ \\frac{\\partial N_a}{\\partial \\eta} \\end{Bmatrix}\n$$\nThe numerically computed displacement gradient tensor inside an element is then $\\nabla \\boldsymbol{u}_h = \\sum_{a=1}^4 \\boldsymbol{u}_a \\otimes \\nabla N_a$. Its components are:\n$$\n\\begin{aligned}\n(\\nabla \\boldsymbol{u}_h)_{11} = \\frac{\\partial u_x}{\\partial x} = \\sum_{a=1}^4 \\frac{\\partial N_a}{\\partial x} u_{ax} \\\\\n(\\nabla \\boldsymbol{u}_h)_{12} = \\frac{\\partial u_y}{\\partial x} = \\sum_{a=1}^4 \\frac{\\partial N_a}{\\partial x} u_{ay} \\\\\n(\\nabla \\boldsymbol{u}_h)_{21} = \\frac{\\partial u_x}{\\partial y} = \\sum_{a=1}^4 \\frac{\\partial N_a}{\\partial y} u_{ax} \\\\\n(\\nabla \\boldsymbol{u}_h)_{22} = \\frac{\\partial u_y}{\\partial y} = \\sum_{a=1}^4 \\frac{\\partial N_a}{\\partial y} u_{ay}\n\\end{aligned}\n$$\nwhere $\\boldsymbol{u}_a = [u_{ax}, u_{ay}]^T$ are the displacements of the element's local node $a$. From this, the numerical small-strain tensor is found: $\\boldsymbol{\\varepsilon}^{\\text{num}} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u}_h + (\\nabla \\boldsymbol{u}_h)^T\\right)$.\n\nThis numerical strain tensor $\\boldsymbol{\\varepsilon}^{\\text{num}}$ is computed at each of the four Gauss points for each of the four elements. The error is quantified by the root-mean-square of the Frobenius norm of the difference $\\boldsymbol{\\varepsilon}^{\\text{num}} - \\boldsymbol{\\varepsilon}^{\\text{exact}}$ over all $N=16$ quadrature points.\n$$\nE_{\\text{RMS}} = \\sqrt{\\frac{1}{16}\\sum_{q=1}^{16} \\left\\| \\boldsymbol{\\varepsilon}^{\\text{num}}(\\boldsymbol{x}_q) - \\boldsymbol{\\varepsilon}^{\\text{exact}} \\right\\|_F^2}\n$$\nFor a successful patch test, this error must be on the order of machine precision, demonstrating the code correctly implements the element formulation. This holds true even for distorted elements, which is tested in Case 4. Cases 2 and 3 test the ability to represent rigid body motions (translation and rotation) which must result in zero strain.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Verifies the constant-strain patch test for a 2x2 mesh of Q4 elements.\n    \"\"\"\n    test_cases = [\n        {\n            \"Lx\": 2.0, \"Ly\": 1.0,\n            \"u0\": np.array([0.1, -0.2]),\n            \"G\": np.array([[0.02, 0.01], [0.0, -0.03]]),\n        },\n        {\n            \"Lx\": 3.0, \"Ly\": 2.0,\n            \"u0\": np.array([-5.0, 7.0]),\n            \"G\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n        },\n        {\n            \"Lx\": 1.0, \"Ly\": 1.0,\n            \"u0\": np.array([0.0, 0.0]),\n            \"G\": np.array([[0.0, -0.2], [0.2, 0.0]]),\n        },\n        {\n            \"Lx\": 2.5, \"Ly\": 1e-3,\n            \"u0\": np.array([-1e-3, 2e-3]),\n            \"G\": np.array([[1e-4, 2e-4], [3e-4, -2e-4]]),\n        },\n        {\n            \"Lx\": 0.5, \"Ly\": 2.0,\n            \"u0\": np.array([0.0, 0.0]),\n            \"G\": np.array([[0.03, 0.01], [0.01, 0.005]]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, u0, G = case[\"Lx\"], case[\"Ly\"], case[\"u0\"], case[\"G\"]\n\n        # 1. Define Mesh Geometry and Connectivity\n        # 9 global nodes in a 3x3 grid\n        x_coords = np.array([0.0, Lx/2.0, Lx])\n        y_coords = np.array([0.0, Ly/2.0, Ly])\n        node_coords = np.array([[x, y] for y in y_coords for x in x_coords])\n\n        # 4 elements with local node ordering: BL, BR, TR, TL -> CCW\n        connectivity = [\n            [0, 1, 4, 3],  # Element 1 (bottom-left)\n            [1, 2, 5, 4],  # Element 2 (bottom-right)\n            [3, 4, 7, 6],  # Element 3 (top-left)\n            [4, 5, 8, 7],  # Element 4 (top-right)\n        ]\n\n        # 2. Prescribe Nodal Displacements\n        # u(x) = u0 + G @ x  -->  U = u0_T + X @ G_T for all nodes\n        nodal_disps = u0 + node_coords @ G.T\n\n        # 3. Define Gauss Quadrature Points (2x2)\n        gp_coord = 1.0 / np.sqrt(3.0)\n        gauss_points = [\n            (-gp_coord, -gp_coord), (gp_coord, -gp_coord),\n            (gp_coord, gp_coord), (-gp_coord, gp_coord)\n        ]\n\n        # 4. Calculate Exact Strain Tensor (constant)\n        epsilon_exact = 0.5 * (G + G.T)\n\n        # 5. Loop over elements and Gauss points to compute numerical strain\n        total_squared_error_norm = 0.0\n        \n        for elem_nodes in connectivity:\n            elem_node_coords = node_coords[elem_nodes]\n            elem_node_disps = nodal_disps[elem_nodes]\n\n            for xi, eta in gauss_points:\n                # Derivatives of shape functions w.r.t. natural coordinates (xi, eta)\n                # N_1, N_2, N_3, N_4\n                dN_dxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n                dN_deta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi),  (1 - xi)])\n                \n                # Jacobian matrix of the isoparametric mapping\n                J = np.zeros((2, 2))\n                J[0, 0] = dN_dxi @ elem_node_coords[:, 0]  # dx/dxi\n                J[0, 1] = dN_dxi @ elem_node_coords[:, 1]  # dy/dxi\n                J[1, 0] = dN_deta @ elem_node_coords[:, 0] # dx/deta\n                J[1, 1] = dN_deta @ elem_node_coords[:, 1] # dy/deta\n\n                # Inverse of Jacobian to find spatial derivatives\n                J_inv = np.linalg.inv(J)\n                \n                # Derivatives of shape functions w.r.t. physical coordinates (x, y)\n                dN_dxy = J_inv @ np.vstack((dN_dxi, dN_deta))\n                dN_dx = dN_dxy[0, :]\n                dN_dy = dN_dxy[1, :]\n\n                # Numerical displacement gradient tensor\n                # (grad u)_ij = d(u_i)/d(x_j)\n                grad_u_final = np.array([\n                    [dN_dx @ elem_node_disps[:, 0], dN_dy @ elem_node_disps[:, 0]], # dux/dx, dux/dy\n                    [dN_dx @ elem_node_disps[:, 1], dN_dy @ elem_node_disps[:, 1]]  # duy/dx, duy/dy\n                ])\n\n                # Numerical strain tensor\n                epsilon_num = 0.5 * (grad_u_final + grad_u_final.T)\n\n                # Error calculation\n                error_tensor = epsilon_num - epsilon_exact\n                squared_frobenius_norm = np.sum(error_tensor**2)\n                total_squared_error_norm += squared_frobenius_norm\n\n        # 6. Compute final RMS error\n        num_gauss_points_total = len(connectivity) * len(gauss_points)\n        e_rms = np.sqrt(total_squared_error_norm / num_gauss_points_total)\n        results.append(e_rms)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2601633"}]}