{"hands_on_practices": [{"introduction": "The journey from a partial differential equation to a solvable linear system begins at the element level. This first practice is a cornerstone of the finite element method, guiding you through the calculation of the local stiffness matrix, which forms the fundamental building block of the global system. By working through this exercise [@problem_id:2589003], you will translate the abstract integral of the weak formulation into concrete numerical values for a triangular element, developing a crucial intuition for how the geometry of the mesh influences the final discrete equations.", "problem": "Consider the scalar Poisson model problem on a bounded polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with homogeneous Dirichlet boundary condition: find $u \\in H_{0}^{1}(\\Omega)$ such that\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx \\;=\\; \\int_{\\Omega} f v \\, dx \\quad \\text{for all } v \\in H_{0}^{1}(\\Omega).\n$$\nLet $\\mathcal{T}_{h}$ be a conforming simplicial triangulation of $\\Omega$ into nondegenerate triangles $K$, and let $V_{h} \\subset H_{0}^{1}(\\Omega)$ be the standard continuous, piecewise affine (i.e., polynomial degree $1$) finite element space with the usual nodal (Lagrange) basis $\\{\\phi_{a}\\}$. For each element $K \\in \\mathcal{T}_{h}$ with local nodal basis $\\{\\phi_{1},\\phi_{2},\\phi_{3}\\}$, the element (local) stiffness matrix entries are\n$$\na_{ij}^{K} \\;=\\; \\int_{K} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j} \\, dx, \\quad i,j \\in \\{1,2,3\\}.\n$$\nYour tasks are:\n\n1) Starting only from the weak form and the definition of the continuous, piecewise affine finite element space, derive the expression for the local stiffness entries $a_{ij}^{K}$ and explain why they depend only on $\\nabla \\phi_{i}$ and $\\nabla \\phi_{j}$ over $K$.\n\n2) Introduce the affine mapping $F_{K}: \\hat{K} \\to K$ from the reference triangle $\\hat{K} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$, given by $x = F_{K}(\\hat{x}) = B_{K} \\hat{x} + x_{1}$, where $x_{1}$ is a vertex of $K$ and $B_{K}$ is the $2 \\times 2$ Jacobian matrix with columns given by the edge vectors of $K$ emanating from $x_{1}$. Using the chain rule and the change of variables formula for integrals, derive the reference-element expression for $a_{ij}^{K}$ in terms of $\\nabla_{\\hat{x}} \\hat{\\phi}_{i}$, $B_{K}^{-1}$, $B_{K}^{-T}$, and $|\\det B_{K}|$, where $\\hat{\\phi}_{i}$ are the reference-element basis functions.\n\n3) For the specific element $K$ with vertices\n$$\nx_{1} = (0,0), \\quad x_{2} = (2,0), \\quad x_{3} = (0,1),\n$$\ncompute the single entry $a_{12}^{K}$ exactly. Report your final answer as an exact number (no rounding). No units are required.", "solution": "The problem statement is found to be valid as it represents a standard theoretical exercise in the finite element method. It is mathematically well-posed, scientifically grounded, and internally consistent. We proceed with the solution.\n\nThe problem is divided into three parts. We shall address them in sequence.\n\n1) First, we are tasked to derive the expression for the local stiffness matrix entries $a_{ij}^{K}$ and explain the structure of the integrand. The finite element space $V_{h}$ is defined as the space of continuous, piecewise affine functions. This means that for any function $u_h \\in V_{h}$, its restriction to a specific triangular element $K \\in \\mathcal{T}_{h}$ is an affine function of the spatial coordinates $x = (x_1, x_2)$. That is, for $x \\in K$,\n$$\nu_h|_K(x) = c_1 x_1 + c_2 x_2 + c_3\n$$\nfor some constants $c_1, c_2, c_3$ that depend on the element $K$ and the function $u_h$.\n\nThe nodal basis functions $\\{\\phi_{i}\\}$ for the space $V_{h}$ are themselves members of $V_{h}$. Consequently, for each basis function $\\phi_i$, its restriction $\\phi_i|_K$ to an element $K$ is an affine function. The gradient of such a function is\n$$\n\\nabla \\phi_i|_K = \\nabla (c_{i,1} x_1 + c_{i,2} x_2 + c_{i,3}) = \\begin{pmatrix} c_{i,1} \\\\ c_{i,2} \\end{pmatrix}.\n$$\nThis gradient is a constant vector over the entire element $K$.\n\nThe local stiffness matrix entry $a_{ij}^{K}$ is defined as\n$$\na_{ij}^{K} = \\int_{K} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j} \\, dx.\n$$\nThe integrand is the dot product of the gradients of two basis functions, $\\nabla \\phi_{i}$ and $\\nabla \\phi_{j}$. Since both $\\nabla \\phi_i$ and $\\nabla \\phi_j$ are constant vectors on the element $K$, their dot product, $\\nabla \\phi_i|_K \\cdot \\nabla \\phi_j|_K$, is a constant scalar value over $K$. Because the integrand is constant, the integral becomes the product of this constant value and the measure (area) of the domain of integration:\n$$\na_{ij}^{K} = (\\nabla \\phi_i|_K \\cdot \\nabla \\phi_j|_K) \\int_{K} 1 \\, dx = (\\nabla \\phi_i|_K \\cdot \\nabla \\phi_j|_K) \\, |K|,\n$$\nwhere $|K|$ denotes the area of the triangle $K$. This expression demonstrates that the value of $a_{ij}^{K}$ depends only on the (constant) gradients of the basis functions $\\phi_i$ and $\\phi_j$ over the element $K$ and the element's area.\n\n2) Second, we derive the expression for $a_{ij}^{K}$ on a reference element $\\hat{K}$. The affine mapping is given by $x = F_{K}(\\hat{x}) = B_{K} \\hat{x} + x_{1}$, which maps the reference triangle $\\hat{K}$ to the physical element $K$. The basis functions on the physical and reference elements are related by $\\phi_i(x) = \\hat{\\phi}_i(\\hat{x})$, where $x=F_K(\\hat{x})$. This implies $\\phi_i(x) = \\hat{\\phi}_i(F_K^{-1}(x))$.\n\nTo transform the gradient, we use the chain rule. Let $\\hat{x} = F_K^{-1}(x)$. The gradient of $\\phi_i$ with respect to the physical coordinates $x$ is\n$$\n\\nabla_x \\phi_i(x) = (\\nabla_x \\hat{x})^T \\nabla_{\\hat{x}} \\hat{\\phi}_i(\\hat{x}).\n$$\nThe term $\\nabla_x \\hat{x}$ is the Jacobian matrix of the inverse mapping, $J_{F_K^{-1}}$. It is a known result that the Jacobian of an inverse map is the inverse of the Jacobian of the forward map: $J_{F_K^{-1}} = (J_{F_K})^{-1}$. The Jacobian of the forward map $F_K(\\hat{x}) = B_K \\hat{x} + x_1$ is simply the matrix $B_K$. Thus, $J_{F_K^{-1}} = B_K^{-1}$.\n\nSubstituting this into the chain rule expression, we obtain the transformation for the gradient vector:\n$$\n\\nabla_x \\phi_i = (B_K^{-1})^T \\nabla_{\\hat{x}} \\hat{\\phi}_i = B_K^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_i.\n$$\nNow, we can express the dot product in the integrand in terms of reference coordinates:\n$$\n\\nabla_x \\phi_{i} \\cdot \\nabla_x \\phi_{j} = (B_{K}^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_{i}) \\cdot (B_{K}^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_{j}).\n$$\nUsing the identity $A\\vec{u} \\cdot A\\vec{v} = (A\\vec{u})^T (A\\vec{v}) = \\vec{u}^T A^T A \\vec{v}$, this becomes:\n$$\n\\nabla_x \\phi_{i} \\cdot \\nabla_x \\phi_{j} = (\\nabla_{\\hat{x}} \\hat{\\phi}_{i})^T (B_K^{-T})^T B_K^{-T} (\\nabla_{\\hat{x}} \\hat{\\phi}_{j}) = (\\nabla_{\\hat{x}} \\hat{\\phi}_{i})^T B_K^{-1} B_K^{-T} (\\nabla_{\\hat{x}} \\hat{\\phi}_{j}).\n$$\nFinally, we apply the change of variables formula to the integral itself:\n$$\ndx = |\\det(J_{F_K})| \\, d\\hat{x} = |\\det(B_K)| \\, d\\hat{x}.\n$$\nSubstituting the transformed integrand and the differential element into the definition of $a_{ij}^{K}$, we arrive at the reference-element expression:\n$$\na_{ij}^{K} = \\int_{\\hat{K}} \\left[ (\\nabla_{\\hat{x}} \\hat{\\phi}_{i})^T B_K^{-1} B_K^{-T} (\\nabla_{\\hat{x}} \\hat{\\phi}_{j}) \\right] |\\det(B_K)| \\, d\\hat{x}.\n$$\nThis is the required expression in terms of $\\nabla_{\\hat{x}} \\hat{\\phi}_{i}$, $B_{K}^{-1}$, $B_{K}^{-T}$, and $|\\det B_{K}|$.\n\n3) Third, we compute the specific entry $a_{12}^{K}$ for the element $K$ with vertices $x_{1} = (0,0)$, $x_{2} = (2,0)$, and $x_{3} = (0,1)$. We utilize the direct approach on the physical element, as established in the first part.\n$$\na_{12}^{K} = (\\nabla \\phi_1|_K \\cdot \\nabla \\phi_2|_K) \\, |K|.\n$$\nThe element $K$ is a right triangle with vertices at $(0,0)$, $(2,0)$, and $(0,1)$. Its area is $|K| = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times 2 \\times 1 = 1$.\n\nNext, we find the gradients of the basis functions $\\phi_1$ and $\\phi_2$ on $K$. A basis function $\\phi_i|_K(x,y) = ax+by+c$ is defined by the property $\\phi_i(x_j) = \\delta_{ij}$.\n\nTo find $\\phi_1(x,y)$:\nIt must satisfy $\\phi_1(x_1) = 1$, $\\phi_1(x_2) = 0$, $\\phi_1(x_3) = 0$.\n1. $\\phi_1(0,0) = a(0) + b(0) + c = 1 \\implies c = 1$.\n2. $\\phi_1(2,0) = a(2) + b(0) + c = 0 \\implies 2a + 1 = 0 \\implies a = -1/2$.\n3. $\\phi_1(0,1) = a(0) + b(1) + c = 0 \\implies b + 1 = 0 \\implies b = -1$.\nSo, $\\phi_1(x,y) = -\\frac{1}{2}x - y + 1$. The gradient is constant on $K$: $\\nabla \\phi_1 = (-\\frac{1}{2}, -1)$.\n\nTo find $\\phi_2(x,y)$:\nIt must satisfy $\\phi_2(x_1) = 0$, $\\phi_2(x_2) = 1$, $\\phi_2(x_3) = 0$.\n1. $\\phi_2(0,0) = a(0) + b(0) + c = 0 \\implies c = 0$.\n2. $\\phi_2(2,0) = a(2) + b(0) + c = 1 \\implies 2a = 1 \\implies a = 1/2$.\n3. $\\phi_2(0,1) = a(0) + b(1) + c = 0 \\implies b = 0$.\nSo, $\\phi_2(x,y) = \\frac{1}{2}x$. The gradient is constant on $K$: $\\nabla \\phi_2 = (\\frac{1}{2}, 0)$.\n\nNow, we compute the dot product of the gradients:\n$$\n\\nabla \\phi_1 \\cdot \\nabla \\phi_2 = \\begin{pmatrix} -1/2 \\\\ -1 \\end{pmatrix} \\cdot \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix} = \\left(-\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + (-1)(0) = -\\frac{1}{4}.\n$$\nFinally, we calculate $a_{12}^{K}$:\n$$\na_{12}^{K} = \\left(-\\frac{1}{4}\\right) \\times |K| = \\left(-\\frac{1}{4}\\right) \\times 1 = -\\frac{1}{4}.\n$$\nThe exact value of the entry is $-\\frac{1}{4}$.", "answer": "$$\n\\boxed{-\\frac{1}{4}}\n$$", "id": "2589003"}, {"introduction": "A numerically computed solution should ideally inherit the qualitative properties of the true solution, such as the maximum principle for the Laplace equation. This advanced practice explores the deep connection between the geometry of the finite element mesh and the physical fidelity of the discrete solution. By constructing a specific counterexample [@problem_id:2588983], you will demonstrate how a poor-quality mesh can lead to a violation of the discrete maximum principle, yielding unphysical results and highlighting why mesh generation is not merely a geometric task but a critical component of ensuring a reliable simulation.", "problem": "Consider the Laplace equation $-\\Delta u = 0$ on a polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with Dirichlet boundary condition $u = g$ on $\\partial \\Omega$. Let $\\mathcal{T}_{h}$ be a conforming triangulation of $\\Omega$, and let $V_{h}$ be the space of continuous, piecewise affine functions with respect to $\\mathcal{T}_{h}$. Assume that the triangulation contains a single interior edge connecting two interior vertices $p$ and $q$, and that this edge is shared by exactly two triangles $T_{\\alpha}$ and $T_{\\beta}$. Let the angles opposite the edge $\\overline{pq}$ in these two triangles be $\\alpha$ and $\\beta$, respectively. Suppose further that $\\alpha + \\beta  \\pi$ (an interior, non-Delaunay configuration).\n\nLet $\\mathcal{N}_{p}$ denote the set of boundary vertices directly connected to $p$ by an edge, and let $\\mathcal{N}_{q}$ denote the set of boundary vertices directly connected to $q$ by an edge. Impose Dirichlet data such that $g=1$ at all vertices in $\\mathcal{N}_{p}$, $g=0$ at all vertices in $\\mathcal{N}_{q}$, and $g$ is arbitrary elsewhere on $\\partial \\Omega$ (these other boundary values do not couple directly into the equations at $p$ and $q$ because they are not adjacent to $p$ or $q$ by an edge).\n\nStarting only from the weak form and the definition of the piecewise affine basis functions, derive the $2 \\times 2$ linear system satisfied by the nodal values $u_{p}$ and $u_{q}$ in terms of cotangent weights. Introduce the notations\n$$\nw := \\frac{1}{2}\\big(\\cot \\alpha + \\cot \\beta\\big), \\quad\nA := \\sum_{b \\in \\mathcal{N}_{p}} w_{pb}, \\quad\nB := \\sum_{b \\in \\mathcal{N}_{q}} w_{qb},\n$$\nwhere for any edge $\\overline{ij}$ interior to $\\Omega$ with adjacent angles $\\theta_{1}$ and $\\theta_{2}$ in the two incident triangles, the edge weight is $w_{ij} := \\frac{1}{2}\\big(\\cot \\theta_{1} + \\cot \\theta_{2}\\big)$, and for a boundary edge $\\overline{ib}$ with interior angle $\\theta$ in its unique incident triangle, $w_{ib} := \\frac{1}{2}\\cot \\theta$.\n\nSolve the resulting $2 \\times 2$ system symbolically and provide the exact expression for $u_{p}$ in terms of $A$, $B$, and $w$. You must give your final answer as a single, closed-form analytic expression. Then, using your expression, explain why the condition $\\alpha + \\beta  \\pi$ (equivalently $w  0$) yields $u_{p}  1$, thereby furnishing a counterexample to the discrete maximum principle (DMP). Finally, briefly discuss two remedies grounded in mesh optimization that prevent such violations. The final answer must be the exact expression you derived for $u_{p}$.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard problem in the analysis of the Finite Element Method (FEM) for elliptic partial differential equations. All necessary information is provided and is internally consistent. Therefore, we proceed with the derivation.\n\nThe strong form of the problem is the Laplace equation with Dirichlet boundary conditions:\n$$\n\\begin{cases}\n    -\\Delta u = 0  \\text{in } \\Omega \\\\\n    u = g  \\text{on } \\partial\\Omega\n\\end{cases}\n$$\nThe corresponding weak formulation is to find $u \\in H^1(\\Omega)$ such that $u|_{\\partial\\Omega} = g$ and for all test functions $v \\in H_0^1(\\Omega)$, the following holds:\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\mathbf{x} = 0\n$$\nIn the Finite Element Method, we seek an approximate solution $u_h$ in a finite-dimensional subspace $V_h \\subset H^1(\\Omega)$. The space $V_h$ is given as the space of continuous, piecewise affine functions over a conforming triangulation $\\mathcal{T}_h$ of $\\Omega$. The solution $u_h$ can be written as a linear combination of nodal basis functions $\\phi_i$:\n$$\nu_h(\\mathbf{x}) = \\sum_{i \\in \\mathcal{I}} u_i \\phi_i(\\mathbf{x})\n$$\nwhere $\\mathcal{I}$ is the set of all vertices in the triangulation and $u_i$ are the nodal values of the solution. The basis function $\\phi_i$ is the unique function in $V_h$ such that $\\phi_i(p_j) = \\delta_{ij}$ for all vertices $p_j$.\n\nThe discrete weak formulation is to find $u_h \\in V_h$ such that $u_h(b) = g(b)$ for all boundary vertices $b$, and for all interior vertices $p_j$:\n$$\n\\int_{\\Omega} \\nabla u_h \\cdot \\nabla \\phi_j \\, d\\mathbf{x} = 0\n$$\nSubstituting the expansion for $u_h$, we obtain a linear system for the unknown nodal values $u_i$ at interior vertices. For an interior vertex $p_j$, the equation is:\n$$\n\\sum_{i \\in \\mathcal{I}} u_i \\int_{\\Omega} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, d\\mathbf{x} = 0\n$$\nThe integral $\\int_{\\Omega} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, d\\mathbf{x}$ constitutes the $(j, i)$-th entry of the stiffness matrix $K$. It is non-zero only if vertices $p_i$ and $p_j$ are connected by an edge in the triangulation. The well-known cotangent formula for linear finite elements states that for an edge $\\overline{p_i p_j}$ shared by two triangles with opposite angles $\\theta_1$ and $\\theta_2$, the corresponding off-diagonal entry in the stiffness matrix is:\n$$\nK_{ji} = \\int_{\\Omega} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, d\\mathbf{x} = -\\frac{1}{2}(\\cot\\theta_1 + \\cot\\theta_2) = -w_{ij}\n$$\nThe diagonal entry is given by $K_{jj} = \\sum_{i \\in \\mathcal{N}(j)} w_{ij}$, where $\\mathcal{N}(j)$ is the set of vertices adjacent to $p_j$. The equation for node $p_j$ can thus be written as:\n$$\nu_j \\left( \\sum_{i \\in \\mathcal{N}(j)} w_{ij} \\right) + \\sum_{i \\in \\mathcal{N}(j), i \\neq j} u_i (-w_{ij}) = 0\n$$\nThis simplifies to the compact form:\n$$\n\\sum_{i \\in \\mathcal{N}(j)} w_{ij} (u_j - u_i) = 0\n$$\nWe now apply this formula to the two specified interior vertices $p$ and $q$.\n\nFor vertex $p$, its neighbors are the vertex $q$ and the set of boundary vertices $\\mathcal{N}_p$. The equation is:\n$$\nw_{pq}(u_p - u_q) + \\sum_{b \\in \\mathcal{N}_p} w_{pb}(u_p - u_b) = 0\n$$\nUsing the provided definitions and boundary conditions:\n- The weight for the interior edge $\\overline{pq}$ is $w_{pq} = \\frac{1}{2}(\\cot \\alpha + \\cot \\beta) = w$.\n- The boundary values are $u_b = g(b) = 1$ for all $b \\in \\mathcal{N}_p$.\n- The sum of weights for edges connecting $p$ to the boundary is $\\sum_{b \\in \\mathcal{N}_p} w_{pb} = A$.\n\nSubstituting these into the equation for $p$:\n$$\nw(u_p - u_q) + \\sum_{b \\in \\mathcal{N}_p} w_{pb}(u_p - 1) = 0\n$$\n$$\nw(u_p - u_q) + (u_p - 1)\\sum_{b \\in \\mathcal{N}_p} w_{pb} = 0\n$$\n$$\nw(u_p - u_q) + A(u_p - 1) = 0\n$$\n$$\n(w+A)u_p - w u_q = A \\quad (1)\n$$\n\nFor vertex $q$, its neighbors are the vertex $p$ and the set of boundary vertices $\\mathcal{N}_q$. The equation is:\n$$\nw_{qp}(u_q - u_p) + \\sum_{b \\in \\mathcal{N}_q} w_{qb}(u_q - u_b) = 0\n$$\nUsing the provided definitions and boundary conditions:\n- The weight is $w_{qp} = w_{pq} = w$.\n- The boundary values are $u_b = g(b) = 0$ for all $b \\in \\mathcal{N}_q$.\n- The sum of weights for edges connecting $q$ to the boundary is $\\sum_{b \\in \\mathcal{N}_q} w_{qb} = B$.\n\nSubstituting these into the equation for $q$:\n$$\nw(u_q - u_p) + \\sum_{b \\in \\mathcal{N}_q} w_{qb}(u_q - 0) = 0\n$$\n$$\nw(u_q - u_p) + u_q \\sum_{b \\in \\mathcal{N}_q} w_{qb} = 0\n$$\n$$\nw(u_q - u_p) + B u_q = 0\n$$\n$$\n-w u_p + (w+B) u_q = 0 \\quad (2)\n$$\n\nEquations $(1)$ and $(2)$ form the $2 \\times 2$ linear system for the nodal values $u_p$ and $u_q$:\n$$\n\\begin{pmatrix}\nw+A  -w \\\\\n-w  w+B\n\\end{pmatrix}\n\\begin{pmatrix}\nu_p \\\\\nu_q\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nA \\\\\n0\n\\end{pmatrix}\n$$\nTo solve this system for $u_p$, we use Cramer's rule. The determinant of the coefficient matrix is:\n$$\n\\det(K) = (w+A)(w+B) - (-w)(-w) = w^2 + wB + wA + AB - w^2 = w(A+B) + AB\n$$\nThe determinant of the matrix for $u_p$ is:\n$$\n\\det(K_p) = \\det \\begin{pmatrix} A  -w \\\\ 0  w+B \\end{pmatrix} = A(w+B) - 0 = A(w+B)\n$$\nThe solution for $u_p$ is therefore:\n$$\nu_p = \\frac{\\det(K_p)}{\\det(K)} = \\frac{A(w+B)}{w(A+B)+AB}\n$$\n\nNow, we analyze this result to demonstrate a violation of the discrete maximum principle (DMP). The DMP would require that the solution at any interior node is bounded by the minimum and maximum values on the boundary. Here, the specified boundary values are $0$ and $1$. A DMP violation occurs if $u_p  1$ or $u_p  0$. We will show $u_p  1$.\n\nThe condition $\\alpha + \\beta  \\pi$, where $\\alpha, \\beta \\in (0, \\pi)$, implies that $\\cot \\alpha + \\cot \\beta  0$. This is because if one angle, say $\\alpha$, is obtuse ($\\alpha  \\pi/2$), its cotangent is negative. If the other angle $\\beta$ is acute such that $\\alpha+\\beta  \\pi$, then $\\beta  \\pi-\\alpha$, and since $\\cot$ is a decreasing function on $(0, \\pi)$, we have $\\cot \\beta  \\cot(\\pi-\\alpha) = -\\cot\\alpha$. Thus, $\\cot\\alpha + \\cot\\beta  0$. This directly implies that $w = \\frac{1}{2}(\\cot \\alpha + \\cot \\beta)  0$.\n\nLet us examine the expression for $u_p - 1$:\n$$\nu_p - 1 = \\frac{A(w+B)}{w(A+B)+AB} - 1 = \\frac{Aw + AB - (wA + wB + AB)}{w(A+B)+AB} = \\frac{-wB}{w(A+B)+AB}\n$$\nTo show $u_p  1$, we must show that $u_p - 1  0$.\nThe quantities $A$ and $B$ are sums of edge weights. For a reasonably shaped mesh, the angles subtending the boundary edges are acute, making their cotangents positive. Thus, we assume $w_{pb}  0$ and $w_{qb}  0$, which implies $A  0$ and $B  0$.\nWith $w  0$ and $B  0$, the numerator $-wB$ is positive.\nThe denominator is $D = \\det(K) = w(A+B) + AB$. The stiffness matrix $K$ for the interior nodes must be positive definite for the overall FEM problem to be well-posed and have a unique solution. A symmetric $2 \\times 2$ matrix is positive definite if its trace and determinant are positive. Its determinant $D$ must therefore be positive.\nSince the numerator $-wB$ is positive and the denominator $D$ is positive, we conclude that:\n$$\nu_p - 1 = \\frac{-wB}{D}  0 \\implies u_p  1\n$$\nThe maximum value of the specified Dirichlet data is $1$. The fact that the nodal value $u_p$ at an interior vertex exceeds this maximum is a direct violation of the discrete maximum principle. This violation is caused by the non-Delaunay condition $\\alpha+\\beta  \\pi$, which results in a positive off-diagonal entry $-w$ in the stiffness matrix, preventing it from being an M-matrix.\n\nTwo remedies grounded in mesh optimization can prevent such violations:\n$1$. **Delaunay Meshing**: The most direct remedy is to ensure the triangulation $\\mathcal{T}_h$ is a Delaunay triangulation. For any interior edge in a Delaunay triangulation, the sum of the opposite angles is less than or equal to $\\pi$. This ensures that $\\cot \\alpha + \\cot \\beta \\ge 0$, leading to non-negative weights $w \\ge 0$. With all edge weights non-negative, all off-diagonal entries of the stiffness matrix are non-positive, making it an M-matrix. This property is sufficient to guarantee the DMP. Delaunay meshes can be generated using algorithms like advancing front or constructed from a set of points (e.g., Bowyer-Watson), or an existing mesh can be converted to Delaunay via an edge-flipping algorithm.\n$2$. **Mesh Quality Improvement (Smoothing)**: Mesh smoothing algorithms, such as Laplacian smoothing, reposition interior vertices to improve triangle quality. For instance, moving a vertex to the geometric centroid of its neighbors tends to make triangles more equilateral, increasing their minimum angles. This process typically eliminates very large angles and non-Delaunay configurations like the one described. By improving the local geometry, these methods effectively enforce a \"soft\" Delaunay-like condition, which restores the validity of the DMP.", "answer": "$$\n\\boxed{\\frac{A(w+B)}{w(A+B)+AB}}\n$$", "id": "2588983"}]}