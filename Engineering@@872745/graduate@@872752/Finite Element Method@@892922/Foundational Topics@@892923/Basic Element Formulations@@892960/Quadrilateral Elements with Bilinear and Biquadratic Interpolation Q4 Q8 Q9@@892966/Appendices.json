{"hands_on_practices": [{"introduction": "A cornerstone of the isoparametric finite element method is the mapping from a simple, standardized parent element to a complex physical element. The validity of this mapping is governed by the Jacobian matrix, whose determinant must remain positive throughout the element to avoid creating a physically impossible \"inverted\" geometry. This first practice provides a direct, hands-on experience with this crucial concept by exploring how the simple act of ordering nodes clockwise versus counter-clockwise affects the sign of the Jacobian determinant for a Q4 element [@problem_id:2592296].", "problem": "In the isoparametric finite element method (FEM) for a four-node isoparametric quadrilateral (Q4), the mapping from the reference square with local coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ and standard reference-node locations $(-1,-1)$, $(1,-1)$, $(1,1)$, $(-1,1)$ to the physical element is defined by the bilinear interpolation\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i,\\quad\ny(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i,\n$$\nwith the Jacobian matrix\n$$\n\\mathbf{J}(\\xi,\\eta)=\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}.\n$$\nConsider a convex physical quadrilateral with vertex coordinates\n$$\n\\mathbf{P}_1=(0,0),\\quad \\mathbf{P}_2=(3,0),\\quad \\mathbf{P}_3=(4,2),\\quad \\mathbf{P}_4=(0,1).\n$$\nDefine two node-numbering cases for assigning these physical points to the Q4 nodes:\n- Case CCW: nodes $1,2,3,4$ map to $\\mathbf{P}_1,\\mathbf{P}_2,\\mathbf{P}_3,\\mathbf{P}_4$ respectively (counterclockwise traversal).\n- Case CW: nodes $1,2,3,4$ map to $\\mathbf{P}_1,\\mathbf{P}_4,\\mathbf{P}_3,\\mathbf{P}_2$ respectively (clockwise traversal).\n\nUsing only the fundamental definitions above and the standard bilinear shape functions for Q4 on the reference square, compute the determinants\n$$\n\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0)\\quad \\text{and}\\quad \\det\\mathbf{J}_{\\mathrm{CW}}(0,0),\n$$\nand then evaluate the ratio\n$$\nr=\\frac{\\det\\mathbf{J}_{\\mathrm{CW}}(0,0)}{\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0)}.\n$$\nExpress your final result for $r$ as a pure number with no units. No rounding is required. In your derivation, identify which node numbering convention avoids inverted elements by ensuring a positive Jacobian determinant throughout the element. The final answer should be the value of $r$ only.", "solution": "The problem presented is a standard exercise in the theory of isoparametric finite elements. It is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We shall proceed with the derivation.\n\nThe mapping from the reference element, a square in the $(\\xi, \\eta)$ local coordinate system where $\\xi, \\eta \\in [-1, 1]$, to the physical element in the $(x, y)$ coordinate system is given by\n$$x(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i$$\n$$y(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$$\nwhere $(x_i, y_i)$ are the coordinates of the $i$-th node of the physical element. The standard bilinear shape functions for the four-node quadrilateral element (Q4) are defined with respect to the reference nodes $1(-1,-1)$, $2(1,-1)$, $3(1,1)$, and $4(-1,1)$ as:\n$$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\nThe Jacobian matrix of this transformation is\n$$\n\\mathbf{J}(\\xi,\\eta)=\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i \\\\\n\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i & \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i\n\\end{pmatrix}\n$$\nTo evaluate the Jacobian at the center of the element, $(\\xi, \\eta) = (0,0)$, we first compute the partial derivatives of the shape functions and evaluate them at this point.\nThe derivatives are:\n$$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$$\n$$\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)$$\n$$\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)$$\n$$\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)$$\nAt $(\\xi, \\eta) = (0,0)$, these derivatives become:\n$$\\frac{\\partial N_1}{\\partial \\xi}\\Big|_{(0,0)}=-\\frac{1}{4}, \\quad \\frac{\\partial N_2}{\\partial \\xi}\\Big|_{(0,0)}=\\frac{1}{4}, \\quad \\frac{\\partial N_3}{\\partial \\xi}\\Big|_{(0,0)}=\\frac{1}{4}, \\quad \\frac{\\partial N_4}{\\partial \\xi}\\Big|_{(0,0)}=-\\frac{1}{4}$$\n$$\\frac{\\partial N_1}{\\partial \\eta}\\Big|_{(0,0)}=-\\frac{1}{4}, \\quad \\frac{\\partial N_2}{\\partial \\eta}\\Big|_{(0,0)}=-\\frac{1}{4}, \\quad \\frac{\\partial N_3}{\\partial \\eta}\\Big|_{(0,0)}=\\frac{1}{4}, \\quad \\frac{\\partial N_4}{\\partial \\eta}\\Big|_{(0,0)}=\\frac{1}{4}$$\nSubstituting these into the expression for the Jacobian matrix at $(\\xi, \\eta) = (0,0)$, we obtain:\n$$\n\\mathbf{J}(0,0) = \\frac{1}{4}\n\\begin{pmatrix}\n-x_1+x_2+x_3-x_4 & -x_1-x_2+x_3+x_4 \\\\\n-y_1+y_2+y_3-y_4 & -y_1-y_2+y_3+y_4\n\\end{pmatrix}\n$$\nNow, we analyze the two specified node-numbering cases.\n\nCase CCW: Nodes $1,2,3,4$ map to $\\mathbf{P}_1, \\mathbf{P}_2, \\mathbf{P}_3, \\mathbf{P}_4$ respectively.\nThe physical coordinates are:\n$(x_1, y_1) = (0,0)$\n$(x_2, y_2) = (3,0)$\n$(x_3, y_3) = (4,2)$\n$(x_4, y_4) = (0,1)$\nWe compute the components of the Jacobian matrix $\\mathbf{J}_{\\mathrm{CCW}}(0,0)$:\n$$J_{11} = \\frac{1}{4}(-0+3+4-0) = \\frac{7}{4}$$\n$$J_{12} = \\frac{1}{4}(-0-3+4+0) = \\frac{1}{4}$$\n$$J_{21} = \\frac{1}{4}(-0+0+2-1) = \\frac{1}{4}$$\n$$J_{22} = \\frac{1}{4}(-0-0+2+1) = \\frac{3}{4}$$\nThus, the Jacobian matrix is\n$$\n\\mathbf{J}_{\\mathrm{CCW}}(0,0) =\n\\begin{pmatrix}\n\\frac{7}{4} & \\frac{1}{4} \\\\\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}\n$$\nThe determinant is\n$$\n\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0) = \\left(\\frac{7}{4}\\right)\\left(\\frac{3}{4}\\right) - \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{4}\\right) = \\frac{21}{16} - \\frac{1}{16} = \\frac{20}{16} = \\frac{5}{4}\n$$\nThe positive sign of the determinant confirms that the mapping preserves orientation. A counter-clockwise traversal of the nodes in the reference element maps to a counter-clockwise traversal of the nodes in the physical element. This is the correct convention to avoid generating inverted, or \"inside-out,\" elements.\n\nCase CW: Nodes $1,2,3,4$ map to $\\mathbf{P}_1, \\mathbf{P}_4, \\mathbf{P}_3, \\mathbf{P}_2$ respectively.\nThe physical coordinates are:\n$(x_1, y_1) = (0,0)$\n$(x_2, y_2) = (0,1)$\n$(x_3, y_3) = (4,2)$\n$(x_4, y_4) = (3,0)$\nWe compute the components of the Jacobian matrix $\\mathbf{J}_{\\mathrm{CW}}(0,0)$:\n$$J_{11} = \\frac{1}{4}(-0+0+4-3) = \\frac{1}{4}$$\n$$J_{12} = \\frac{1}{4}(-0-0+4+3) = \\frac{7}{4}$$\n$$J_{21} = \\frac{1}{4}(-0+1+2-0) = \\frac{3}{4}$$\n$$J_{22} = \\frac{1}{4}(-0-1+2+0) = \\frac{1}{4}$$\nThus, the Jacobian matrix is\n$$\n\\mathbf{J}_{\\mathrm{CW}}(0,0) =\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{7}{4} \\\\\n\\frac{3}{4} & \\frac{1}{4}\n\\end{pmatrix}\n$$\nThe determinant is\n$$\n\\det\\mathbf{J}_{\\mathrm{CW}}(0,0) = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{4}\\right) - \\left(\\frac{7}{4}\\right)\\left(\\frac{3}{4}\\right) = \\frac{1}{16} - \\frac{21}{16} = -\\frac{20}{16} = -\\frac{5}{4}\n$$\nThe negative sign of the determinant indicates that the mapping reverses orientation. A counter-clockwise path in the reference element maps to a clockwise path in the physical element, which is physically and mathematically invalid for most finite element analyses.\n\nFinally, we compute the required ratio $r$:\n$$\nr = \\frac{\\det\\mathbf{J}_{\\mathrm{CW}}(0,0)}{\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0)} = \\frac{-5/4}{5/4} = -1\n$$\nThis result demonstrates a fundamental property: reversing the orientation of the physical element's node numbering (from CCW to CW) relative to the reference element's fixed CCW numbering results in a negation of the Jacobian determinant, all other factors being equal. The counter-clockwise numbering convention (Case CCW) ensures a positive Jacobian determinant for a convex quadrilateral and is the standard practice.", "answer": "$$\n\\boxed{-1}\n$$", "id": "2592296"}, {"introduction": "For a finite element to be reliable, it must be able to exactly represent fundamental physical states, such as constant strain. This capability is formally assessed through the \"patch test,\" a critical benchmark for ensuring convergence. This exercise guides you through proving that the bilinear quadrilateral (Q4) element correctly passes the constant strain patch test, regardless of its shape [@problem_id:2592310]. You will then investigate how geometric distortion, which causes the Jacobian to vary, separates a general quadrilateral from an ideal, constant-strain-friendly parallelogram.", "problem": "Consider a single isoparametric bilinear quadrilateral (Q4) element from the Finite Element Method (FEM) in plane strain. Let the parent coordinates be $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and let the isoparametric mapping be defined by the standard bilinear shape functions $N_{i}(\\xi,\\eta)$ and physical nodal coordinates $(x_{i},y_{i})$, $i=1,2,3,4$, so that\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}.\n$$\nAssume a parallelogram element corresponds to an affine map, in which case the Jacobian matrix is constant over the element, while a general quadrilateral corresponds to a non-affine bilinear map with non-constant Jacobian.\n\nTo make the discussion concrete, consider the following one-parameter family of elements with nodal coordinates chosen so that\n$$\nx(\\xi,\\eta)=\\xi,\\qquad y(\\xi,\\eta)=\\eta+t\\,\\xi\\,\\eta,\n$$\nwhere $t\\in\\mathbb{R}$ parameterizes the element distortion, and $t=0$ yields the rectangle $[-1,1]\\times[-1,1]$ (an affine parallelogram). The corresponding physical nodal coordinates are\n$$\n(x_{1},y_{1})=(-1,t-1),\\quad (x_{2},y_{2})=(1,-1-t),\\quad (x_{3},y_{3})=(1,1+t),\\quad (x_{4},y_{4})=(-1,1-t).\n$$\n\nLet the exact displacement field be any linear function in the physical coordinates,\n$$\nu(x,y)=a+b\\,x+c\\,y,\\qquad v(x,y)=d+e\\,x+f\\,y,\n$$\nwith constants $a,b,c,d,e,f\\in\\mathbb{R}$, so that the exact small-strain tensor is constant in the element. The Q4 displacement interpolation is $u_{h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,u_{i}$ and $v_{h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,v_{i}$, where $u_{i}=u(x_{i},y_{i})$ and $v_{i}=v(x_{i},y_{i})$.\n\nTasks:\n1) Starting from the definition of isoparametric interpolation and the partition of unity property $\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)=1$, derive from first principles that the Q4 element reproduces the above linear displacement field exactly for any quadrilateral geometry, including non-affine distortion. Conclude that the resulting finite element small-strain tensor is exactly constant in the element.\n\n2) Under exact (full) $2\\times 2$ Gaussian quadrature, argue from first principles of numerical integration that the element internal energy for this constant-strain state is integrated exactly for the given mapping family.\n\n3) Distinguish what geometric property “fails” under general distortion compared to an affine parallelogram map: the Jacobian determinant becomes non-constant. To quantify this loss of affinity, define the following scalar distortion indicator as the squared $L^{2}$-deviation of the Jacobian determinant from its mean value over the parent square:\n$$\n\\mathcal{M}(t)\\;=\\;\\int_{-1}^{1}\\!\\!\\int_{-1}^{1}\\left(J(\\xi,\\eta)-\\overline{J}\\right)^{2}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $J(\\xi,\\eta)=\\det\\left(\\dfrac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right)$ and $\\overline{J}=\\dfrac{1}{4}\\int_{-1}^{1}\\!\\!\\int_{-1}^{1}J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$ is the mean of $J$ over the parent domain. Compute $\\mathcal{M}(t)$ in closed form as a function of $t$.\n\nYour final answer must be the closed-form analytic expression for $\\mathcal{M}(t)$. No rounding is required and no units are involved in this scalar indicator.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It presents a standard, albeit detailed, inquiry into the properties of isoparametric finite elements, specifically the bilinear quadrilateral element ($Q4$). All definitions and data provided are consistent and sufficient for a unique solution. The inquiry is firmly grounded in the mathematical theory of the Finite Element Method. We shall proceed with the solution.\n\nThe problem requires a three-part analysis. The first two parts are conceptual and foundational, and the third part involves a direct calculation. We will address them in order.\n\nPart 1: Reproduction of a Linear Displacement Field.\n\nThe fundamental premise of the isoparametric formulation is that a single set of shape functions, $N_{i}(\\xi,\\eta)$, is used both for interpolating the geometry and the solution field. Let the interpolated displacement field be denoted by $\\mathbf{u}_{h} = (u_{h}, v_{h})$. For the $u$-component, we have:\n$$\nu_{h}(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta) u_{i}\n$$\nThe nodal displacements, $u_{i}$, are obtained by evaluating the exact linear displacement field, $u(x,y) = a+b\\,x+c\\,y$, at the physical nodal coordinates $(x_{i}, y_{i})$. Thus, $u_{i} = u(x_{i}, y_{i}) = a+b\\,x_{i}+c\\,y_{i}$. Substituting this into the interpolation formula yields:\n$$\nu_{h}(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta) (a+b\\,x_{i}+c\\,y_{i})\n$$\nBy distributing the summation, we obtain:\n$$\nu_{h}(\\xi,\\eta) = a \\left(\\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\right) + b \\left(\\sum_{i=1}^{4} N_{i}(\\xi,\\eta) x_{i}\\right) + c \\left(\\sum_{i=1}^{4} N_{i}(\\xi,\\eta) y_{i}\\right)\n$$\nWe now invoke the two key properties of the shape functions in an isoparametric element. First, the shape functions must form a partition of unity, which means their sum at any point is unity:\n$$\n\\sum_{i=1}^{4} N_{i}(\\xi,\\eta) = 1\n$$\nSecond, the geometric mapping from the parent domain $(\\xi, \\eta)$ to the physical domain $(x,y)$ is defined by these same shape functions:\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta) x_{i} \\quad \\text{and} \\quad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta) y_{i}\n$$\nSubstituting these two properties into the expression for $u_{h}(\\xi,\\eta)$ gives:\n$$\nu_{h}(\\xi,\\eta) = a(1) + b\\,x(\\xi,\\eta) + c\\,y(\\xi,\\eta)\n$$\nThis demonstrates that the interpolated field $u_{h}$, when expressed in physical coordinates, is identical to the exact linear field $u(x,y)$. The same derivation holds for the $v$-component, $v_{h}(x,y) = d+e\\,x+f\\,y$. This property, known as passing the constant strain patch test, is a necessary condition for convergence and is independent of the element's geometric distortion. Because the reproduced displacement field is exactly linear in $x$ and $y$, its spatial derivatives will be constant. The small-strain tensor components, e.g., $\\epsilon_{xx} = \\partial u_{h}/\\partial x = b$, are therefore constant throughout the element, matching the exact strain field.\n\nPart 2: Exactness of Numerical Integration for Internal Energy.\n\nThe element internal energy, $\\mathcal{U}_{e}$, for a linear elastic material is given by the integral of the strain energy density over the element's area, $A$:\n$$\n\\mathcal{U}_{e} = \\int_{A} \\frac{1}{2} \\boldsymbol{\\epsilon}^{T} \\mathbf{C} \\boldsymbol{\\epsilon} \\, \\mathrm{d}A\n$$\nwhere $\\boldsymbol{\\epsilon}$ is the strain vector and $\\mathbf{C}$ is the constant material stiffness matrix. From Part 1, for the given linear displacement field, the strain tensor $\\boldsymbol{\\epsilon}$ is constant. Therefore, the term $\\frac{1}{2} \\boldsymbol{\\epsilon}^{T} \\mathbf{C} \\boldsymbol{\\epsilon}$ is a constant scalar value, let us call it $W$. The integral is transformed to the parent domain:\n$$\n\\mathcal{U}_{e} = \\int_{-1}^{1} \\int_{-1}^{1} W \\, J(\\xi,\\eta) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta = W \\int_{-1}^{1} \\int_{-1}^{1} J(\\xi,\\eta) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\nwhere $J(\\xi,\\eta)$ is the determinant of the Jacobian matrix of the mapping. For the specific mapping given, $x(\\xi,\\eta)=\\xi$ and $y(\\xi,\\eta)=\\eta+t\\,\\xi\\,\\eta$, the Jacobian matrix is:\n$$\n\\mathbf{J}_{\\text{map}} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ t\\eta & 1+t\\xi \\end{pmatrix}\n$$\nThe determinant is $J(\\xi,\\eta) = \\det(\\mathbf{J}_{\\text{map}}) = (1)(1+t\\xi) - (0)(t\\eta) = 1+t\\xi$.\nThe integrand for the energy calculation is $W(1+t\\xi)$. This is a polynomial of degree $1$ in $\\xi$ and degree $0$ in $\\eta$. A $2 \\times 2$ Gaussian quadrature rule uses $4$ integration points and integrates exactly any polynomial of degree up to $2n-1 = 2(2)-1 = 3$ in each variable direction. Since the integrand's polynomial degree ($1$ in $\\xi$, $0$ in $\\eta$) is well below this limit, a full $2 \\times 2$ Gaussian quadrature will compute the integral, and thus the element internal energy, exactly.\n\nPart 3: Calculation of the Distortion Indicator $\\mathcal{M}(t)$.\n\nWe are tasked to compute $\\mathcal{M}(t) = \\int_{-1}^{1}\\int_{-1}^{1}\\left(J(\\xi,\\eta)-\\overline{J}\\right)^{2}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\nWe have already found the Jacobian determinant: $J(\\xi,\\eta) = 1+t\\xi$.\nFirst, we compute the mean value, $\\overline{J}$:\n$$\n\\overline{J} = \\frac{1}{A_{\\text{parent}}} \\int_{-1}^{1}\\int_{-1}^{1} J(\\xi,\\eta) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} (1+t\\xi) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\nWe integrate with respect to $\\eta$ first:\n$$\n\\overline{J} = \\frac{1}{4} \\int_{-1}^{1} \\left[ (1+t\\xi)\\eta \\right]_{\\eta=-1}^{1} \\, \\mathrm{d}\\xi = \\frac{1}{4} \\int_{-1}^{1} (1+t\\xi)(1 - (-1)) \\, \\mathrm{d}\\xi = \\frac{2}{4} \\int_{-1}^{1} (1+t\\xi) \\, \\mathrm{d}\\xi\n$$\nNow, we integrate with respect to $\\xi$:\n$$\n\\overline{J} = \\frac{1}{2} \\left[ \\xi + t\\frac{\\xi^2}{2} \\right]_{\\xi=-1}^{1} = \\frac{1}{2} \\left[ \\left(1 + \\frac{t}{2}\\right) - \\left(-1 + \\frac{t}{2}\\right) \\right] = \\frac{1}{2} [2] = 1\n$$\nThe mean Jacobian $\\overline{J}$ is $1$. For an affine map (parallelogram), $J$ is constant, so $J=\\overline{J}$ and $\\mathcal{M}=0$. Here, $t=0$ corresponds to an affine map (a rectangle), for which $J=1$, and correctly $\\mathcal{M}(0)=0$.\n\nNow we compute the deviation term required for the integrand:\n$$\nJ(\\xi,\\eta) - \\overline{J} = (1+t\\xi) - 1 = t\\xi\n$$\nWe substitute this into the definition of $\\mathcal{M}(t)$:\n$$\n\\mathcal{M}(t) = \\int_{-1}^{1}\\int_{-1}^{1} (t\\xi)^{2} \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta = \\int_{-1}^{1}\\int_{-1}^{1} t^{2}\\xi^{2} \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\nThe term $t^2$ is a constant with respect to the integration variables. The integrand is independent of $\\eta$.\n$$\n\\mathcal{M}(t) = t^{2} \\left( \\int_{-1}^{1} \\mathrm{d}\\eta \\right) \\left( \\int_{-1}^{1} \\xi^{2} \\, \\mathrm{d}\\xi \\right)\n$$\nThe individual integrals are computed as:\n$$\n\\int_{-1}^{1} \\mathrm{d}\\eta = [\\eta]_{-1}^{1} = 1 - (-1) = 2\n$$\n$$\n\\int_{-1}^{1} \\xi^{2} \\, \\mathrm{d}\\xi = \\left[ \\frac{\\xi^{3}}{3} \\right]_{-1}^{1} = \\frac{1^{3}}{3} - \\frac{(-1)^{3}}{3} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\nCombining these results, we find the closed-form expression for the distortion indicator:\n$$\n\\mathcal{M}(t) = t^{2} \\cdot 2 \\cdot \\frac{2}{3} = \\frac{4}{3}t^{2}\n$$\nThis result quantifies how the non-affinity of the element, parameterized by $t$, manifests as a non-uniform Jacobian determinant, measured by its mean square deviation.", "answer": "$$\n\\boxed{\\frac{4}{3}t^{2}}\n$$", "id": "2592310"}, {"introduction": "To achieve higher accuracy and capture complex deformation patterns, we often turn to higher-order elements like the nine-node biquadratic quadrilateral (Q9). While their shape functions may seem complex, they are built from simple, elegant principles. This practice demystifies the Q9 element by having you derive its shape functions from the ground up using the tensor product of one-dimensional quadratic polynomials [@problem_id:2592295]. By verifying fundamental properties like the partition of unity and the Kronecker-delta condition, you will gain a deep, foundational understanding of how these powerful elements are constructed.", "problem": "In the isoparametric Finite Element Method (FEM), the nine-node quadrilateral ($\\mathrm{Q9}$) element uses biquadratic interpolation constructed as a tensor product of one-dimensional quadratic Lagrange polynomials defined on the parent domain with local coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$. Consider the canonical nodal layout with nodal locations in the parent domain given by:\n- Node $1$: $(-1,-1)$, Node $2$: $(+1,-1)$, Node $3$: $(+1,+1)$, Node $4$: $(-1,+1)$,\n- Node $5$: $(0,-1)$, Node $6$: $(+1,0)$, Node $7$: $(0,+1)$, Node $8$: $(-1,0)$,\n- Node $9$: $(0,0)$.\n\nStarting from the fundamental interpolation property that the one-dimensional quadratic Lagrange basis polynomials $\\ell_{-1}(\\zeta)$, $\\ell_{0}(\\zeta)$, and $\\ell_{+1}(\\zeta)$ satisfy $\\ell_{a}(b)=\\delta_{ab}$ for $a,b\\in\\{-1,0,+1\\}$, derive the two-dimensional $\\mathrm{Q9}$ shape functions $N_i(\\xi,\\eta)$ as tensor products of these one-dimensional polynomials. Then compute their first derivatives with respect to $\\xi$ and $\\eta$.\n\nUsing only these derived expressions (no pre-memorized element formulas), perform the following verifications:\n- Show that the partition of unity holds, i.e., $\\sum_{i=1}^{9} N_i(\\xi,\\eta)=1$ for all $(\\xi,\\eta)$ in the parent domain.\n- Show the Kronecker-delta property at each nodal point, i.e., $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$ for all $i,j\\in\\{1,\\dots,9\\}$.\n- Show that the gradients satisfy $\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta)=0$ and $\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)=0$ for all $(\\xi,\\eta)$ in the parent domain.\n- Verify explicitly the nodal and mid-edge evaluations at the points $(-1,-1)$, $(+1,-1)$, $(+1,+1)$, $(-1,+1)$, $(0,-1)$, $(+1,0)$, $(0,+1)$, $(-1,0)$, and $(0,0)$.\n\nFinally, at the arbitrary point $(\\xi,\\eta)=\\left(\\frac{1}{3},-\\frac{1}{2}\\right)$, evaluate $N_2(\\xi,\\eta)$, $\\frac{\\partial N_5}{\\partial \\xi}(\\xi,\\eta)$, and $\\frac{\\partial N_7}{\\partial \\eta}(\\xi,\\eta)$ using your derived formulas, and report the exact value of the scalar quantity\n$$\nQ \\;=\\; N_2\\!\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) \\;+\\; 3\\,\\frac{\\partial N_5}{\\partial \\xi}\\!\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) \\;-\\; 2\\,\\frac{\\partial N_7}{\\partial \\eta}\\!\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right).\n$$\nProvide $Q$ as an exact value (no rounding). Do not include units.", "solution": "The problem statement has been rigorously evaluated and is deemed valid. It is a standard, well-posed problem within the framework of the Finite Element Method, free of scientific inaccuracies, logical contradictions, or ill-defined terms. We will proceed with the derivation and verification as stipulated.\n\nFirst, we derive the one-dimensional quadratic Lagrange basis polynomials, $\\ell_k(\\zeta)$, defined over the interval $\\zeta \\in [-1, 1]$ with nodes at $\\{-1, 0, +1\\}$. These polynomials must satisfy the property $\\ell_a(b) = \\delta_{ab}$ for $a, b \\in \\{-1, 0, +1\\}$, where $\\delta_{ab}$ is the Kronecker delta.\n\nThe polynomial for the node at $\\zeta = -1$ is denoted $\\ell_{-1}(\\zeta)$. It must be zero at $\\zeta=0$ and $\\zeta=1$, and unity at $\\zeta=-1$.\n$$ \\ell_{-1}(\\zeta) = \\frac{(\\zeta-0)(\\zeta-1)}{(-1-0)(-1-1)} = \\frac{\\zeta(\\zeta-1)}{2} = \\frac{1}{2}(\\zeta^2 - \\zeta) $$\nThe polynomial for the node at $\\zeta = 0$ is $\\ell_{0}(\\zeta)$. It must be zero at $\\zeta=-1$ and $\\zeta=1$, and unity at $\\zeta=0$.\n$$ \\ell_{0}(\\zeta) = \\frac{(\\zeta - (-1))(\\zeta-1)}{(0 - (-1))(0-1)} = \\frac{(\\zeta+1)(\\zeta-1)}{-1} = 1-\\zeta^2 $$\nThe polynomial for the node at $\\zeta = +1$ is $\\ell_{+1}(\\zeta)$. It must be zero at $\\zeta=-1$ and $\\zeta=0$, and unity at $\\zeta=1$.\n$$ \\ell_{+1}(\\zeta) = \\frac{(\\zeta - (-1))(\\zeta-0)}{(1 - (-1))(1-0)} = \\frac{\\zeta(\\zeta+1)}{2} = \\frac{1}{2}(\\zeta^2 + \\zeta) $$\nTheir first derivatives with respect to $\\zeta$ are:\n$$ \\ell'_{-1}(\\zeta) = \\frac{d}{d\\zeta}\\left(\\frac{1}{2}(\\zeta^2 - \\zeta)\\right) = \\frac{1}{2}(2\\zeta - 1) $$\n$$ \\ell'_{0}(\\zeta) = \\frac{d}{d\\zeta}(1-\\zeta^2) = -2\\zeta $$\n$$ \\ell'_{+1}(\\zeta) = \\frac{d}{d\\zeta}\\left(\\frac{1}{2}(\\zeta^2 + \\zeta)\\right) = \\frac{1}{2}(2\\zeta + 1) $$\n\nThe two-dimensional shape functions $N_i(\\xi, \\eta)$ for the $\\mathrm{Q9}$ element are formed by the tensor product of these 1D polynomials. A node $i$ with local coordinates $(\\xi_i, \\eta_i)$, where $\\xi_i, \\eta_i \\in \\{-1, 0, +1\\}$, has a corresponding shape function given by $N_i(\\xi, \\eta) = \\ell_{\\xi_i}(\\xi)\\ell_{\\eta_i}(\\eta)$. The nodal numbering maps to coordinate pairs as follows:\n$1:(-1,-1)$, $2:(+1,-1)$, $3:(+1,+1)$, $4:(-1,+1)$, $5:(0,-1)$, $6:(+1,0)$, $7:(0,+1)$, $8:(-1,0)$, $9:(0,0)$.\nThus, the shape functions are:\n$N_1(\\xi, \\eta) = \\ell_{-1}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{4}(\\xi^2-\\xi)(\\eta^2-\\eta)$\n$N_2(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{4}(\\xi^2+\\xi)(\\eta^2-\\eta)$\n$N_3(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{+1}(\\eta) = \\frac{1}{4}(\\xi^2+\\xi)(\\eta^2+\\eta)$\n$N_4(\\xi, \\eta) = \\ell_{-1}(\\xi)\\ell_{+1}(\\eta) = \\frac{1}{4}(\\xi^2-\\xi)(\\eta^2+\\eta)$\n$N_5(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{2}(1-\\xi^2)(\\eta^2-\\eta)$\n$N_6(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{0}(\\eta) = \\frac{1}{2}(\\xi^2+\\xi)(1-\\eta^2)$\n$N_7(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell_{+1}(\\eta) = \\frac{1}{2}(1-\\xi^2)(\\eta^2+\\eta)$\n$N_8(\\xi, \\eta) = \\ell_{-1}(\\xi)\\ell_{0}(\\eta) = \\frac{1}{2}(\\xi^2-\\xi)(1-\\eta^2)$\n$N_9(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell_{0}(\\eta) = (1-\\xi^2)(1-\\eta^2)$\n\nThe first derivatives are $\\frac{\\partial N_i}{\\partial \\xi} = \\ell'_{\\xi_i}(\\xi)\\ell_{\\eta_i}(\\eta)$ and $\\frac{\\partial N_i}{\\partial \\eta} = \\ell_{\\xi_i}(\\xi)\\ell'_{\\eta_i}(\\eta)$.\n\nWe now perform the required verifications.\n\n1.  Partition of Unity: $\\sum_{i=1}^{9} N_i(\\xi,\\eta) = 1$.\n    Using the tensor product structure:\n    $$ \\sum_{i=1}^{9} N_i(\\xi, \\eta) = \\sum_{k \\in \\{-1,0,1\\}} \\sum_{l \\in \\{-1,0,1\\}} \\ell_k(\\xi) \\ell_l(\\eta) = \\left(\\sum_{k \\in \\{-1,0,1\\}} \\ell_k(\\xi)\\right) \\left(\\sum_{l \\in \\{-1,0,1\\}} \\ell_l(\\eta)\\right) $$\n    The sum of the 1D polynomials is:\n    $$ \\sum_{k \\in \\{-1,0,1\\}} \\ell_k(\\zeta) = \\frac{1}{2}(\\zeta^2 - \\zeta) + (1-\\zeta^2) + \\frac{1}{2}(\\zeta^2 + \\zeta) = \\left(\\frac{1}{2}-1+\\frac{1}{2}\\right)\\zeta^2 + \\left(-\\frac{1}{2}+\\frac{1}{2}\\right)\\zeta + 1 = 1 $$\n    Therefore, $\\sum_{i=1}^{9} N_i(\\xi, \\eta) = (1)(1) = 1$. The partition of unity is verified.\n\n2.  Kronecker-delta property: $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$.\n    Let node $i$ correspond to coordinates $(\\xi_k, \\eta_l)$ and node $j$ correspond to $(\\xi_m, \\eta_n)$, where $k, l, m, n \\in \\{-1, 0, 1\\}$.\n    The shape function for node $i$ is $N_i(\\xi, \\eta) = \\ell_k(\\xi)\\ell_l(\\eta)$.\n    Evaluating at node $j$: $N_i(\\xi_j, \\eta_j) = \\ell_k(\\xi_m)\\ell_l(\\eta_n) = \\delta_{km}\\delta_{ln}$.\n    The product is $1$ only if $k=m$ and $l=n$, meaning that nodes $i$ and $j$ are the same. Otherwise, it is $0$. Thus, $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$.\n    As an explicit verification, consider $N_5(\\xi, \\eta) = \\ell_0(\\xi)\\ell_{-1}(\\eta) = (1-\\xi^2) \\frac{1}{2}\\eta(\\eta-1)$.\n    At node $5$, $(\\xi_5, \\eta_5) = (0, -1)$: $N_5(0,-1) = (1-0^2) \\frac{1}{2}(-1)(-1-1) = (1)\\frac{1}{2}(-1)(-2) = 1$.\n    At node $1$, $(\\xi_1, \\eta_1) = (-1, -1)$: $N_5(-1,-1) = (1-(-1)^2) \\frac{1}{2}(-1)(-2) = (0)(\\dots) = 0$.\n    At node $9$, $(\\xi_9, \\eta_9) = (0, 0)$: $N_5(0,0) = (1-0^2) \\frac{1}{2}(0)(0-1) = (1)(0) = 0$.\n    The property holds.\n\n3.  Sum of Gradients property: $\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\xi}=0$ and $\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\eta}=0$.\n    This follows from differentiating the partition of unity property:\n    $$ \\frac{\\partial}{\\partial \\xi} \\left(\\sum_{i=1}^{9} N_i(\\xi, \\eta)\\right) = \\frac{\\partial}{\\partial \\xi}(1) = 0 \\implies \\sum_{i=1}^{9} \\frac{\\partial N_i}{\\partial \\xi}(\\xi, \\eta) = 0 $$\n    $$ \\frac{\\partial}{\\partial \\eta} \\left(\\sum_{i=1}^{9} N_i(\\xi, \\eta)\\right) = \\frac{\\partial}{\\partial \\eta}(1) = 0 \\implies \\sum_{i=1}^{9} \\frac{\\partial N_i}{\\partial \\eta}(\\xi, \\eta) = 0 $$\n    Alternatively, using the tensor product expansion:\n    $$ \\sum_{i=1}^{9} \\frac{\\partial N_i}{\\partial \\xi} = \\left(\\sum_{k \\in \\{-1,0,1\\}} \\ell'_k(\\xi)\\right) \\left(\\sum_{l \\in \\{-1,0,1\\}} \\ell_l(\\eta)\\right) $$\n    The sum of 1D derivatives is $\\sum_k \\ell'_k(\\zeta) = \\frac{1}{2}(2\\zeta - 1) + (-2\\zeta) + \\frac{1}{2}(2\\zeta + 1) = (\\zeta-\\frac{1}{2})-2\\zeta+(\\zeta+\\frac{1}{2}) = 0$.\n    Since $\\sum_l \\ell_l(\\eta) = 1$, we have $\\sum_i \\frac{\\partial N_i}{\\partial \\xi} = (0)(1) = 0$. By symmetry, $\\sum_i \\frac{\\partial N_i}{\\partial \\eta} = 0$. The verification is complete.\n\nFinally, we compute the quantity $Q$ at $(\\xi, \\eta) = (\\frac{1}{3}, -\\frac{1}{2})$.\n$$ Q = N_2\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) + 3\\,\\frac{\\partial N_5}{\\partial \\xi}\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) - 2\\,\\frac{\\partial N_7}{\\partial \\eta}\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) $$\nWe need the expressions for $N_2$, $\\frac{\\partial N_5}{\\partial \\xi}$, and $\\frac{\\partial N_7}{\\partial \\eta}$.\n$N_2(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{2}\\xi(\\xi+1) \\cdot \\frac{1}{2}\\eta(\\eta-1) = \\frac{1}{4}\\xi(\\xi+1)\\eta(\\eta-1)$.\n$\\frac{\\partial N_5}{\\partial \\xi}(\\xi, \\eta) = \\ell'_{0}(\\xi)\\ell_{-1}(\\eta) = (-2\\xi) \\cdot \\frac{1}{2}\\eta(\\eta-1) = -\\xi\\eta(\\eta-1)$.\n$\\frac{\\partial N_7}{\\partial \\eta}(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell'_{+1}(\\eta) = (1-\\xi^2) \\cdot \\frac{1}{2}(2\\eta+1)$.\n\nNow, we evaluate these at $(\\xi, \\eta) = (\\frac{1}{3}, -\\frac{1}{2})$.\n$N_2(\\frac{1}{3}, -\\frac{1}{2}) = \\frac{1}{4}(\\frac{1}{3})(\\frac{1}{3}+1)(-\\frac{1}{2})(-\\frac{1}{2}-1) = \\frac{1}{4}(\\frac{1}{3})(\\frac{4}{3})(-\\frac{1}{2})(-\\frac{3}{2}) = \\frac{1}{4} \\cdot \\frac{4}{9} \\cdot \\frac{3}{4} = \\frac{1}{12}$.\n\n$\\frac{\\partial N_5}{\\partial \\xi}(\\frac{1}{3}, -\\frac{1}{2}) = -(\\frac{1}{3})(-\\frac{1}{2})(-\\frac{1}{2}-1) = -(\\frac{1}{3})(-\\frac{1}{2})(-\\frac{3}{2}) = -\\frac{3}{12} = -\\frac{1}{4}$.\n\n$\\frac{\\partial N_7}{\\partial \\eta}(\\frac{1}{3}, -\\frac{1}{2}) = (1-(\\frac{1}{3})^2) \\cdot \\frac{1}{2}(2(-\\frac{1}{2})+1) = (1-\\frac{1}{9}) \\cdot \\frac{1}{2}(-1+1) = (\\frac{8}{9}) \\cdot 0 = 0$.\n\nSubstituting these values into the expression for $Q$:\n$Q = \\frac{1}{12} + 3\\left(-\\frac{1}{4}\\right) - 2(0) = \\frac{1}{12} - \\frac{3}{4} = \\frac{1}{12} - \\frac{9}{12} = -\\frac{8}{12} = -\\frac{2}{3}$.\nThe required scalar quantity is computed as an exact fraction.", "answer": "$$\n\\boxed{-\\frac{2}{3}}\n$$", "id": "2592295"}]}