{"hands_on_practices": [{"introduction": "This practice provides a foundational walkthrough of calibrating a Rayleigh damping model. You will start with a simple two-degree-of-freedom system, determine its natural frequencies, and then calculate the damping coefficients $\\alpha$ and $\\beta$ to meet specific modal damping targets. This exercise [@problem_id:2610995] solidifies the connection between the abstract model parameters and their physical effect on system response, a core skill in structural dynamics analysis.", "problem": "Consider a two-degree-of-freedom (2-DOF) linear mass–spring system modeled within the Finite Element Method (FEM), consisting of two point masses connected in series: mass $1$ is attached to ground by a linear spring of stiffness $k_1$, mass $1$ and mass $2$ are connected by a linear spring of stiffness $k_2$, and mass $2$ has no direct support to ground. Assume small displacements and linear behavior. The mass matrix is a diagonal (lumped) matrix, with entries equal to the masses. The assembled undamped equations of motion in physical coordinates are of the form $M \\ddot{u} + K u = 0$, and with linear viscous damping they become $M \\ddot{u} + C \\dot{u} + K u = 0$. Suppose the damping is of the proportional (Rayleigh) form $C = \\alpha M + \\beta K$. The system data are $m_1 = m_2 = 1\\ \\mathrm{kg}$, $k_1 = 1000\\ \\mathrm{N/m}$, and $k_2 = 2000\\ \\mathrm{N/m}$. \n\nTasks:\n- From first principles, assemble the $2\\times 2$ mass matrix $M$ and stiffness matrix $K$, and pose the undamped free-vibration eigenproblem. Solve for the undamped natural frequencies $\\omega_1$ and $\\omega_2$.\n- Calibrate the Rayleigh damping coefficients $(\\alpha,\\beta)$ so that the first and second modal damping ratios are $\\zeta_1 = 0.02$ and $\\zeta_2 = 0.05$, respectively. Base your derivation on the decoupling of the damped equations in modal coordinates for proportional damping and the definition of modal damping ratio.\n- To verify the time-domain decay, consider the initial value problem with $u(0)$ equal to the first mass-normalized eigenvector scaled so that the displacement of degree-of-freedom $1$ at $t=0$ is $1\\ \\mathrm{mm}$, and $\\dot{u}(0)=0$. Using the single-mode approximation justified by proportional damping and orthogonality, derive the analytical form of $u_1(t)$ for this initial condition and determine the ratio $r$ of the absolute values of the first two successive positive peaks of $u_1(t)$, i.e., $r = |u_1(t_{p,1})|/|u_1(t_{p,2})|$. \n\nReport only the value of $r$ as a dimensionless decimal, rounded to $4$ significant figures.", "solution": "The problem statement is critically evaluated for validity prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- System: A two-degree-of-freedom (2-DOF) linear mass-spring system.\n- Mass matrix ($M$): Diagonal, with entries equal to the lumped masses.\n- Damping matrix ($C$): Proportional (Rayleigh) form, $C = \\alpha M + \\beta K$.\n- Mass values: $m_1 = 1\\ \\mathrm{kg}$, $m_2 = 1\\ \\mathrm{kg}$.\n- Stiffness values: $k_1 = 1000\\ \\mathrm{N/m}$, $k_2 = 2000\\ \\mathrm{N/m}$.\n- Modal damping ratios: $\\zeta_1 = 0.02$, $\\zeta_2 = 0.05$.\n- Initial conditions (IC): $u(0)$ is the first mass-normalized eigenvector scaled such that $u_1(0) = 1\\ \\mathrm{mm} = 0.001\\ \\mathrm{m}$, and $\\dot{u}(0)=0$.\n- Required output: The ratio $r = |u_1(t_{p,1})|/|u_1(t_{p,2})|$ of the absolute values of the first two successive positive peaks of the displacement $u_1(t)$, rounded to $4$ significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in structural dynamics, specifically concerning multi-degree-of-freedom systems, modal analysis, and Rayleigh damping.\n- **Scientifically Grounded:** The problem is based on fundamental principles of classical mechanics and linear systems theory. The model and parameters are physically realistic for a small mechanical system.\n- **Well-Posed:** The problem is self-contained and provides all necessary data and conditions for determining a unique solution for the requested value $r$. The tasks are logically sequenced.\n- **Objective:** The problem is stated using precise, standard terminology of the field.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe analysis proceeds in three stages as delineated by the problem statement.\n\n**1. System Matrices and Undamped Eigenproblem**\n\nFirst, the mass matrix $M$ and stiffness matrix $K$ for the 2-DOF system are assembled.\nThe positions of the masses are denoted by the displacement vector $u = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$.\nThe mass matrix is specified as a diagonal (lumped) matrix with $m_1=1$ and $m_2=1$:\n$$ M = \\begin{pmatrix} m_1 & 0 \\\\ 0 & m_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\nThe stiffness matrix $K$ is derived from the forces exerted by the springs. The force vector $F$ is $F = -Ku$.\nForce on mass $1$: $F_1 = -k_1 u_1 - k_2(u_1-u_2) = -(k_1+k_2)u_1 + k_2 u_2$.\nForce on mass $2$: $F_2 = -k_2(u_2-u_1) = k_2 u_1 - k_2 u_2$.\nFrom this, the stiffness matrix is:\n$$ K = \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix} $$\nSubstituting the given stiffness values $k_1 = 1000\\ \\mathrm{N/m}$ and $k_2 = 2000\\ \\mathrm{N/m}$:\n$$ K = \\begin{pmatrix} 3000 & -2000 \\\\ -2000 & 2000 \\end{pmatrix} $$\nThe undamped free-vibration eigenproblem is $(K - \\omega^2 M)\\phi = 0$. We solve for the squared natural frequencies $\\lambda = \\omega^2$ by finding the roots of the characteristic equation $\\det(K-\\lambda M)=0$. Since $M$ is the identity matrix, this simplifies to $\\det(K-\\lambda I)=0$.\n$$ \\det \\begin{pmatrix} 3000-\\lambda & -2000 \\\\ -2000 & 2000-\\lambda \\end{pmatrix} = 0 $$\n$$ (3000-\\lambda)(2000-\\lambda) - (-2000)^2 = 0 $$\n$$ \\lambda^2 - 5000\\lambda + 6 \\times 10^6 - 4 \\times 10^6 = 0 $$\n$$ \\lambda^2 - 5000\\lambda + 2 \\times 10^6 = 0 $$\nThe solutions for $\\lambda$ are found using the quadratic formula:\n$$ \\lambda = \\frac{5000 \\pm \\sqrt{5000^2 - 4(1)(2 \\times 10^6)}}{2} = \\frac{5000 \\pm \\sqrt{25 \\times 10^6 - 8 \\times 10^6}}{2} = \\frac{5000 \\pm \\sqrt{17 \\times 10^6}}{2} $$\n$$ \\lambda = 2500 \\pm 500\\sqrt{17} $$\nThe two squared natural frequencies are $\\lambda_1 = \\omega_1^2$ and $\\lambda_2 = \\omega_2^2$. By convention, $\\omega_1 < \\omega_2$.\n$$ \\omega_1^2 = 2500 - 500\\sqrt{17} \\quad (\\text{rad/s})^2 $$\n$$ \\omega_2^2 = 2500 + 500\\sqrt{17} \\quad (\\text{rad/s})^2 $$\n\n**2. Proportional Damping Calibration**\n\nThe damping is of the Rayleigh form $C = \\alpha M + \\beta K$. For such proportional damping, the damped equations of motion decouple in the modal coordinate basis. The modal damping ratio $\\zeta_i$ for the $i$-th mode is given by the relation:\n$$ 2\\zeta_i\\omega_i = \\alpha + \\beta\\omega_i^2 $$\nor, equivalently,\n$$ \\zeta_i = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2} $$\nThe problem provides $\\zeta_1 = 0.02$ and $\\zeta_2 = 0.05$. We have a system of two linear equations for the coefficients $\\alpha$ and $\\beta$:\n$$ \\begin{pmatrix} 1 & \\omega_1^2 \\\\ 1 & \\omega_2^2 \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} 2\\omega_1\\zeta_1 \\\\ 2\\omega_2\\zeta_2 \\end{pmatrix} $$\nSince $\\omega_1^2 \\neq \\omega_2^2$, this system has a unique solution for $(\\alpha, \\beta)$. This confirms that the specified modal damping ratios can be achieved with a Rayleigh damping model, which justifies the use of a single-mode analysis for the subsequent task. The explicit values of $\\alpha$ and $\\beta$ are not required for the final answer.\n\n**3. Time-Domain Response and Peak Ratio**\n\nThe system is subjected to initial conditions $u(0) = c_1\\phi_1$ and $\\dot{u}(0)=0$, where $\\phi_1$ is the first mass-normalized eigenvector and $c_1$ is a scaling constant. Because the initial displacement is proportional to a single mode shape and the initial velocity is zero, only that mode will be excited. All other modal coordinates $q_i(t)$ for $i > 1$ will be zero for all time $t$. Thus, the response is exactly given by the first mode's contribution:\n$$ u(t) = \\phi_1 q_1(t) $$\nThe equation of motion for the first modal coordinate $q_1(t)$ is that of a single-degree-of-freedom system:\n$$ \\ddot{q}_1(t) + 2\\zeta_1\\omega_1 \\dot{q}_1(t) + \\omega_1^2 q_1(t) = 0 $$\nThe initial conditions for $q_1(t)$ are found by projecting the physical initial conditions onto the modal basis:\n$$ q_1(0) = \\phi_1^T M u(0) = \\phi_1^T M (c_1\\phi_1) = c_1(\\phi_1^T M \\phi_1) = c_1 $$\nThe last step follows from the mass-normalization condition $\\phi_1^T M \\phi_1 = 1$.\n$$ \\dot{q}_1(0) = \\phi_1^T M \\dot{u}(0) = \\phi_1^T M (0) = 0 $$\nThe solution to the SDOF equation with initial displacement $q_1(0)$ and zero initial velocity is:\n$$ q_1(t) = q_1(0) e^{-\\zeta_1\\omega_1 t} \\left(\\cos(\\omega_{d1}t) + \\frac{\\zeta_1}{\\sqrt{1-\\zeta_1^2}}\\sin(\\omega_{d1}t)\\right) $$\nwhere $\\omega_{d1} = \\omega_1\\sqrt{1-\\zeta_1^2}$ is the damped natural frequency.\nThe displacement of the first mass, $u_1(t)$, is the first component of $u(t)$:\n$$ u_1(t) = \\phi_{11} q_1(t) = \\phi_{11} q_1(0) e^{-\\zeta_1\\omega_1 t} \\left(\\dots\\right) $$\nFrom the initial conditions, we know $u_1(0) = \\phi_{11} q_1(0) = 0.001\\ \\mathrm{m}$. Therefore:\n$$ u_1(t) = u_1(0) e^{-\\zeta_1\\omega_1 t} \\left(\\cos(\\omega_{d1}t) + \\frac{\\zeta_1}{\\sqrt{1-\\zeta_1^2}}\\sin(\\omega_{d1}t)\\right) $$\nTo find the times of the peaks, we set the derivative $\\dot{u}_1(t)$ to zero.\n$$ \\dot{u}_1(t) = u_1(0) \\frac{d}{dt} \\left[ e^{-\\zeta_1\\omega_1 t} \\left(\\cos(\\omega_{d1}t) + \\frac{\\zeta_1}{\\sqrt{1-\\zeta_1^2}}\\sin(\\omega_{d1}t)\\right) \\right] $$\nThe derivative calculation shows that $\\dot{u}_1(t)=0$ when $\\sin(\\omega_{d1}t)=0$. This occurs at times $t = \\frac{n\\pi}{\\omega_{d1}}$ for integers $n=0, 1, 2, \\dots$.\nAt $t=0$ ($n=0$), we have $u_1(0)=0.001 > 0$ and $\\dot{u}_1(0)=0$. The second derivative $\\ddot{u}_1(0) = -u_1(0)\\omega_1^2 < 0$, confirming a local maximum. Thus, the first positive peak is at $t_{p,1} = 0$, with magnitude $|u_1(t_{p,1})| = u_1(0) = 0.001$.\nThe next peak occurs at $n=1$, $t=\\pi/\\omega_{d1}$. At this time, $\\cos(\\omega_{d1}t) = \\cos(\\pi)=-1$, which corresponds to a negative peak.\nThe next positive peak occurs at $n=2$, i.e., $t_{p,2} = \\frac{2\\pi}{\\omega_{d1}}$. At this time, $\\cos(\\omega_{d1}t_{p,2}) = \\cos(2\\pi) = 1$ and $\\sin(\\omega_{d1}t_{p,2}) = \\sin(2\\pi) = 0$.\nThe magnitude of the second positive peak is:\n$$ |u_1(t_{p,2})| = \\left| u_1(0) e^{-\\zeta_1\\omega_1 t_{p,2}} (\\cos(2\\pi)+0) \\right| = u_1(0) e^{-\\zeta_1\\omega_1 \\frac{2\\pi}{\\omega_{d1}}} $$\nThe required ratio $r$ is:\n$$ r = \\frac{|u_1(t_{p,1})|}{|u_1(t_{p,2})|} = \\frac{u_1(0)}{u_1(0) \\exp\\left(-\\frac{2\\pi\\zeta_1\\omega_1}{\\omega_{d1}}\\right)} = \\exp\\left(\\frac{2\\pi\\zeta_1\\omega_1}{\\omega_{d1}}\\right) $$\nSubstituting $\\omega_{d1} = \\omega_1\\sqrt{1-\\zeta_1^2}$:\n$$ r = \\exp\\left(\\frac{2\\pi\\zeta_1\\omega_1}{\\omega_1\\sqrt{1-\\zeta_1^2}}\\right) = \\exp\\left(\\frac{2\\pi\\zeta_1}{\\sqrt{1-\\zeta_1^2}}\\right) $$\nThis expression, $\\delta = \\frac{2\\pi\\zeta_1}{\\sqrt{1-\\zeta_1^2}}$, is the logarithmic decrement.\nWe are given $\\zeta_1=0.02$. We substitute this value to obtain the numerical answer.\n$$ r = \\exp\\left(\\frac{2\\pi(0.02)}{\\sqrt{1-(0.02)^2}}\\right) = \\exp\\left(\\frac{0.04\\pi}{\\sqrt{1-0.0004}}\\right) = \\exp\\left(\\frac{0.04\\pi}{\\sqrt{0.9996}}\\right) $$\n$$ r \\approx \\exp\\left(\\frac{0.1256637}{0.99979998}\\right) \\approx \\exp(0.12569135) \\approx 1.1339304 $$\nRounding the result to $4$ significant figures, we get $r = 1.134$.", "answer": "$$\\boxed{1.134}$$", "id": "2610995"}, {"introduction": "While Rayleigh damping is a powerful and widely used tool, it is essential to understand its limitations. This problem presents a hypothetical scenario with widely spaced modal frequencies to demonstrate a critical weakness known as \"damping sag.\" By working through this counterexample [@problem_id:2610929], you will gain a deeper appreciation for when the simple Rayleigh model may be insufficient and why more advanced damping models are sometimes necessary.", "problem": "A three-degree-of-freedom structural model assembled by the Finite Element Method (FEM) has been modal-analyzed in the undamped case, yielding the following natural circular frequencies: $\\omega_{1} = 10 \\ \\text{rad/s}$, $\\omega_{2} = 100 \\ \\text{rad/s}$, and $\\omega_{3} = 1000 \\ \\text{rad/s}$. The damping matrix is assumed proportional (Rayleigh damping), i.e., $\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}$, where $\\mathbf{M}$ and $\\mathbf{K}$ are the assembled mass and stiffness matrices, and $\\alpha$ and $\\beta$ are scalars to be chosen. You are told to select $\\alpha$ and $\\beta$ so that the modal damping ratios of modes $1$ and $3$ both equal $\\zeta_{0} = 0.05$. Using only fundamental principles of linear vibration and proportional damping, determine the damping ratio $\\zeta_{2}$ that results for the intermediate mode at $\\omega_{2} = 100 \\ \\text{rad/s}$. Round your answer to four significant figures and report it as a decimal with no units. This calculation must explicitly demonstrate why matching $\\zeta$ at two modes does not ensure acceptable damping at an intermediate mode when the eigenfrequencies are unevenly spaced.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of linear structural dynamics, well-posed with sufficient information for a unique solution, and expressed in objective, unambiguous language. We will now proceed with the formal derivation.\n\nThe fundamental relationship between the modal damping ratio $\\zeta_i$ for the $i$-th mode and the Rayleigh damping coefficients $\\alpha$ and $\\beta$ is given for an undamped natural circular frequency $\\omega_i$ by:\n$$2\\zeta_i\\omega_i = \\alpha + \\beta\\omega_i^2$$\nThis can be expressed for the damping ratio as:\n$$\\zeta_i = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2}$$\nThe problem provides the natural frequencies for a $3$-degree-of-freedom system: $\\omega_1 = 10 \\ \\text{rad/s}$, $\\omega_2 = 100 \\ \\text{rad/s}$, and $\\omega_3 = 1000 \\ \\text{rad/s}$.\nThe damping coefficients $\\alpha$ and $\\beta$ must be selected such that the damping ratios for the first and third modes are equal to a target value $\\zeta_0 = 0.05$.\nThis gives us a system of two linear equations for the two unknowns, $\\alpha$ and $\\beta$:\nFor mode $1$:\n$$\\zeta_1 = \\zeta_0 = \\frac{\\alpha}{2\\omega_1} + \\frac{\\beta\\omega_1}{2} \\implies 2\\zeta_0\\omega_1 = \\alpha + \\beta\\omega_1^2$$\nFor mode $3$:\n$$\\zeta_3 = \\zeta_0 = \\frac{\\alpha}{2\\omega_3} + \\frac{\\beta\\omega_3}{2} \\implies 2\\zeta_0\\omega_3 = \\alpha + \\beta\\omega_3^2$$\nWe can solve this system symbolically. Subtracting the first equation from the second yields:\n$$2\\zeta_0\\omega_3 - 2\\zeta_0\\omega_1 = (\\alpha + \\beta\\omega_3^2) - (\\alpha + \\beta\\omega_1^2)$$\n$$2\\zeta_0(\\omega_3 - \\omega_1) = \\beta(\\omega_3^2 - \\omega_1^2) = \\beta(\\omega_3 - \\omega_1)(\\omega_3 + \\omega_1)$$\nSince $\\omega_3 \\neq \\omega_1$, we can divide by $(\\omega_3 - \\omega_1)$ to find $\\beta$:\n$$\\beta = \\frac{2\\zeta_0}{\\omega_1 + \\omega_3}$$\nNow, we substitute this expression for $\\beta$ back into the first equation to solve for $\\alpha$:\n$$\\alpha = 2\\zeta_0\\omega_1 - \\beta\\omega_1^2 = 2\\zeta_0\\omega_1 - \\left(\\frac{2\\zeta_0}{\\omega_1 + \\omega_3}\\right)\\omega_1^2$$\n$$\\alpha = 2\\zeta_0 \\left( \\omega_1 - \\frac{\\omega_1^2}{\\omega_1 + \\omega_3} \\right) = 2\\zeta_0 \\left( \\frac{\\omega_1(\\omega_1 + \\omega_3) - \\omega_1^2}{\\omega_1 + \\omega_3} \\right) = 2\\zeta_0 \\frac{\\omega_1^2 + \\omega_1\\omega_3 - \\omega_1^2}{\\omega_1 + \\omega_3}$$\n$$\\alpha = 2\\zeta_0 \\frac{\\omega_1\\omega_3}{\\omega_1 + \\omega_3}$$\nWe now substitute the given numerical values: $\\zeta_0 = 0.05$, $\\omega_1 = 10 \\ \\text{rad/s}$, $\\omega_3 = 1000 \\ \\text{rad/s}$.\n$$\\beta = \\frac{2(0.05)}{10 + 1000} = \\frac{0.1}{1010} = \\frac{1}{10100}$$\n$$\\alpha = 2(0.05) \\frac{10 \\cdot 1000}{10 + 1000} = (0.1) \\frac{10000}{1010} = \\frac{1000}{1010} = \\frac{100}{101}$$\nWith the coefficients $\\alpha = \\frac{100}{101}$ and $\\beta = \\frac{1}{10100}$ determined, we can compute the damping ratio $\\zeta_2$ for the intermediate mode with frequency $\\omega_2 = 100 \\ \\text{rad/s}$:\n$$\\zeta_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2}$$\n$$\\zeta_2 = \\frac{100/101}{2(100)} + \\frac{(1/10100)(100)}{2} = \\frac{1}{2 \\cdot 101} + \\frac{100}{2 \\cdot 10100} = \\frac{1}{202} + \\frac{1}{202}$$\n$$\\zeta_2 = \\frac{2}{202} = \\frac{1}{101}$$\nThe problem requires this answer as a decimal rounded to four significant figures.\n$$\\zeta_2 = \\frac{1}{101} \\approx 0.00990099...$$\nRounding to four significant figures yields $0.009901$.\n\nThe result explicitly demonstrates the critical weakness of the standard Rayleigh damping model. The damping ratio function $\\zeta(\\omega) = \\frac{\\alpha}{2\\omega} + \\frac{\\beta\\omega}{2}$ is defined by matching the desired damping $\\zeta_0$ at two frequencies, $\\omega_1$ and $\\omega_3$. This function represents the superposition of mass-proportional damping (the $\\frac{1}{\\omega}$ term, dominant at low frequencies) and stiffness-proportional damping (the $\\omega$ term, dominant at high frequencies). The function exhibits a minimum at a frequency $\\omega_{min}$ where its derivative is zero:\n$$\\frac{d\\zeta}{d\\omega} = -\\frac{\\alpha}{2\\omega^2} + \\frac{\\beta}{2} = 0 \\implies \\omega_{min} = \\sqrt{\\frac{\\alpha}{\\beta}}$$\nUsing our calculated coefficients:\n$$\\omega_{min} = \\sqrt{\\frac{100/101}{1/10100}} = \\sqrt{\\frac{100 \\cdot 10100}{101}} = \\sqrt{100 \\cdot 100} = 100 \\ \\text{rad/s}$$\nThis calculation reveals that the intermediate frequency $\\omega_2 = 100 \\ \\text{rad/s}$ is precisely the frequency at which the minimum damping occurs. This is not a coincidence; it is a direct consequence of the frequencies being logarithmically spaced, i.e., $\\omega_2 = \\sqrt{\\omega_1 \\omega_3}$. The damping at this minimum is $\\zeta_{min} = \\sqrt{\\alpha\\beta} = \\sqrt{\\frac{100}{101} \\cdot \\frac{1}{10100}} = \\frac{1}{101}$. The value of $\\zeta_2$ is significantly lower than $\\zeta_0$, a phenomenon known as \"damping sag\". This illustrates that when modes are widely spaced, achieving a uniform damping level across the frequency spectrum with a simple two-parameter Rayleigh model is impossible. The model will necessarily under-damp intermediate modes.", "answer": "$$\\boxed{0.009901}$$", "id": "2610929"}, {"introduction": "Moving from theory to computational practice requires rigorous verification. This exercise tasks you with designing a unit test to confirm that a Rayleigh damping implementation behaves as expected in a finite element context. You will verify both the modal decoupling property and the accuracy of the resulting modal damping ratios [@problem_id:2610986], reinforcing the theoretical underpinnings of the model while developing crucial skills in computational quality assurance.", "problem": "You are given a linear, undamped, three-degree-of-freedom ($3$-DOF) mass-spring finite element model consisting of three identical lumped masses connected in a line by identical linear springs, with the end masses attached to fixed supports. Let the displacement vector be $\\mathbf{x}(t) \\in \\mathbb{R}^3$. The mass matrix is $\\mathbf{M} = m \\mathbf{I}$ for a scalar mass $m \\gt 0$, and the stiffness matrix is the symmetric tridiagonal matrix\n$$\n\\mathbf{K} = k \\begin{bmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{bmatrix},\n$$\nfor a scalar spring constant $k \\gt 0$. Assume Kelvin-Voigt linear viscous damping modeled by Rayleigh damping, that is, the damping matrix is\n$$\n\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K},\n$$\nwith Rayleigh coefficients $\\alpha \\ge 0$ (with unit $\\mathrm{s}^{-1}$) and $\\beta \\ge 0$ (with unit $\\mathrm{s}$). The equations of motion are\n$$\n\\mathbf{M}\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\mathbf{x}(t) = \\mathbf{0}.\n$$\n\nYour task is to design an automated unit test that verifies two properties of a Rayleigh damping implementation for this $3$-DOF benchmark:\n\n- Modal decoupling: In the modal basis defined by the generalized eigenvectors of the undamped problem, the transformed damping matrix is diagonal (up to numerical tolerance), which implies that the damped equations of motion decouple into independent scalar modal equations.\n\n- Correct modal damping ratios: The modal damping ratio $\\zeta_n$ predicted by Rayleigh damping theory for each mode $n$ must match the modal damping ratio measured from the diagonal entries of the modal damping matrix obtained via the transformation.\n\nStart only from the following foundational bases:\n\n- Newton’s second law applied to linear finite element semi-discretization, leading to the second-order ordinary differential equation system above.\n\n- The generalized symmetric-definite eigenvalue problem for undamped free vibration, which determines natural frequencies and mode shapes:\n$$\n\\mathbf{K}\\boldsymbol{\\phi}_n = \\omega_n^2 \\mathbf{M} \\boldsymbol{\\phi}_n,\n$$\nwith real, positive natural frequencies $\\omega_n$ and real mode shapes $\\boldsymbol{\\phi}_n$, chosen to satisfy $\\boldsymbol{\\Phi}^\\mathsf{T}\\mathbf{M}\\boldsymbol{\\Phi} = \\mathbf{I}$ when assembled into the modal matrix $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1\\ \\boldsymbol{\\phi}_2\\ \\boldsymbol{\\phi}_3]$.\n\nDerive, from these bases only and without shortcut formulas, the expressions needed to (i) demonstrate modal decoupling under Rayleigh damping, and (ii) compute the theoretical modal damping ratios $\\zeta_n$ for comparison with those identified from the transformed damping matrix.\n\nThen implement a program that for each test case below:\n\n1. Constructs $\\mathbf{M}$, $\\mathbf{K}$, and $\\mathbf{C}$ from the provided parameters $(m,k,\\alpha,\\beta)$ specified in International System of Units (SI): $m$ in $\\mathrm{kg}$, $k$ in $\\mathrm{N}/\\mathrm{m}$, $\\alpha$ in $\\mathrm{s}^{-1}$, and $\\beta$ in $\\mathrm{s}$.\n\n2. Solves the generalized symmetric-definite eigenproblem for $(\\mathbf{K},\\mathbf{M})$ to obtain natural frequencies $\\omega_n$ and an $\\mathbf{M}$-orthonormal modal matrix $\\boldsymbol{\\Phi}$.\n\n3. Forms the modal damping matrix $\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi}$ and checks the maximum absolute value of its off-diagonal entries against a tolerance $\\tau_\\mathrm{off} = 10^{-9}$, declaring “decoupling verified” if the maximum absolute off-diagonal is less than $\\tau_\\mathrm{off}$.\n\n4. Computes for each mode the theoretical modal damping ratio $\\zeta_n$ implied by Rayleigh damping using only the derived relations and compares it to the “measured” modal damping ratio obtained from the diagonal entries of $\\mathbf{C}_\\mathrm{modal}$ and the natural frequencies $\\omega_n$. Declare the damping ratios “correct” if the maximum absolute difference across modes is less than a tolerance $\\tau_\\zeta = 10^{-9}$.\n\n5. Returns a boolean $true$ for the test case if and only if both “decoupling verified” and “correct damping ratios” hold; otherwise returns $false$.\n\nUse the following test suite of parameter sets $(m,k,\\alpha,\\beta)$:\n\n- Test $1$: $(m,k,\\alpha,\\beta) = (2.0,1000.0,0.4,0.0008)$.\n\n- Test $2$: $(m,k,\\alpha,\\beta) = (1.0,1000.0,0.2,0.0)$.\n\n- Test $3$: $(m,k,\\alpha,\\beta) = (1.0,1200.0,0.0,0.001)$.\n\n- Test $4$: $(m,k,\\alpha,\\beta) = (1.5,500.0,0.1,0.002)$.\n\nAll computations must be carried out in SI units; however, the final outputs are unitless booleans. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[true,true,false]”), but using the programming language’s canonical boolean literals.\n\nThe expected output type is a list of booleans, one for each test case, in the same order as listed. No user input is required; the program must run to completion as-is and print the single-line result.", "solution": "The problem requires the derivation of fundamental properties of Rayleigh damping in the context of a specific $3$-degree-of-freedom ($3$-DOF) system, and the subsequent implementation of a numerical verification test. The derivation must proceed from first principles.\n\nLet the system's equation of motion be\n$$\n\\mathbf{M}\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\mathbf{x}(t) = \\mathbf{0}\n$$\nwhere $\\mathbf{x}(t) \\in \\mathbb{R}^3$ is the displacement vector, and $\\mathbf{M}$, $\\mathbf{C}$, and $\\mathbf{K}$ are the mass, damping, and stiffness matrices, respectively.\n\nThe undamped free vibration is governed by the generalized eigenvalue problem:\n$$\n\\mathbf{K}\\boldsymbol{\\phi}_n = \\omega_n^2 \\mathbf{M} \\boldsymbol{\\phi}_n\n$$\nwhere $\\omega_n$ are the natural frequencies and $\\boldsymbol{\\phi}_n$ are the mode shapes for modes $n=1, 2, 3$. The mode shapes can be assembled into a modal matrix $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1, \\boldsymbol{\\phi}_2, \\boldsymbol{\\phi}_3]$. We are given that these mode shapes are chosen to be $\\mathbf{M}$-orthonormal, which means\n$$\n\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi} = \\mathbf{I}\n$$\nwhere $\\mathbf{I}$ is the $3 \\times 3$ identity matrix.\n\nThe physical coordinates $\\mathbf{x}(t)$ can be expressed in terms of the modal coordinates $\\mathbf{q}(t)=[q_1(t), q_2(t), q_3(t)]^\\mathsf{T}$ via the transformation\n$$\n\\mathbf{x}(t) = \\boldsymbol{\\Phi}\\mathbf{q}(t)\n$$\nSubstituting this into the equation of motion and pre-multiplying by $\\boldsymbol{\\Phi}^\\mathsf{T}$ yields the equation in modal coordinates:\n$$\n(\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi}) \\ddot{\\mathbf{q}}(t) + (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi}) \\dot{\\mathbf{q}}(t) + (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi}) \\mathbf{q}(t) = \\mathbf{0}\n$$\nThis is a system of coupled equations governed by the modal matrices $\\mathbf{M}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi}$, $\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi}$, and $\\mathbf{K}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi}$.\n\nBy definition, the modal mass matrix is $\\mathbf{M}_\\mathrm{modal} = \\mathbf{I}$.\nTo determine the modal stiffness matrix, we write the eigenproblems for all modes collectively as $\\mathbf{K}\\boldsymbol{\\Phi} = \\mathbf{M}\\boldsymbol{\\Phi}\\boldsymbol{\\Omega}^2$, where $\\boldsymbol{\\Omega}^2 = \\mathrm{diag}(\\omega_1^2, \\omega_2^2, \\omega_3^2)$. Pre-multiplying by $\\boldsymbol{\\Phi}^\\mathsf{T}$ gives:\n$$\n\\mathbf{K}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi} = \\boldsymbol{\\Phi}^\\mathsf{T} (\\mathbf{M}\\boldsymbol{\\Phi}\\boldsymbol{\\Omega}^2) = (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi})\\boldsymbol{\\Omega}^2 = \\mathbf{I}\\boldsymbol{\\Omega}^2 = \\boldsymbol{\\Omega}^2\n$$\nThe modal stiffness matrix is diagonal, which confirms that the equations are uncoupled with respect to stiffness.\n\nThe central task is to analyze the modal damping matrix, $\\mathbf{C}_\\mathrm{modal}$. The problem specifies Rayleigh damping, where the damping matrix $\\mathbf{C}$ is a linear combination of the mass and stiffness matrices:\n$$\n\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}\n$$\nwith scalar coefficients $\\alpha$ and $\\beta$.\n\n**Part (i): Modal Decoupling Verification**\nTo demonstrate that Rayleigh damping leads to modal decoupling, we compute the modal damping matrix $\\mathbf{C}_\\mathrm{modal}$:\n$$\n\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\Phi} = \\boldsymbol{\\Phi}^\\mathsf{T} (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\boldsymbol{\\Phi}\n$$\nUsing the linearity of matrix multiplication, we have:\n$$\n\\mathbf{C}_\\mathrm{modal} = \\alpha (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{M} \\boldsymbol{\\Phi}) + \\beta (\\boldsymbol{\\Phi}^\\mathsf{T} \\mathbf{K} \\boldsymbol{\\Phi})\n$$\nSubstituting the previously established identities for the modal mass and stiffness matrices:\n$$\n\\mathbf{C}_\\mathrm{modal} = \\alpha \\mathbf{I} + \\beta \\boldsymbol{\\Omega}^2\n$$\nSince $\\mathbf{I}$ and $\\boldsymbol{\\Omega}^2$ are both diagonal matrices, their linear combination $\\mathbf{C}_\\mathrm{modal}$ is also a diagonal matrix. The diagonal entries are $[\\mathbf{C}_\\mathrm{modal}]_{nn} = \\alpha + \\beta\\omega_n^2$. The off-diagonal entries are all zero. This proves, from first principles, that the choice of Rayleigh damping ensures that the system of equations of motion completely decouples in the modal basis. The numerical verification will consist of computing $\\mathbf{C}_\\mathrm{modal} = \\boldsymbol{\\Phi}^\\mathsf{T} (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\boldsymbol{\\Phi}$ and confirming that its off-diagonal entries are zero within a numerical tolerance $\\tau_\\mathrm{off}$.\n\n**Part (ii): Modal Damping Ratio Derivation**\nWith the diagonal modal matrices, the system of equations becomes:\n$$\n\\mathbf{I}\\ddot{\\mathbf{q}}(t) + (\\alpha \\mathbf{I} + \\beta \\boldsymbol{\\Omega}^2)\\dot{\\mathbf{q}}(t) + \\boldsymbol{\\Omega}^2\\mathbf{q}(t) = \\mathbf{0}\n$$\nThis represents a set of $3$ independent scalar differential equations. For each mode $n$, the equation is:\n$$\n\\ddot{q}_n(t) + (\\alpha + \\beta \\omega_n^2) \\dot{q}_n(t) + \\omega_n^2 q_n(t) = 0\n$$\nThe standard canonical form for a viscously damped single-degree-of-freedom oscillator is:\n$$\n\\ddot{q}_n(t) + 2\\zeta_n\\omega_n \\dot{q}_n(t) + \\omega_n^2 q_n(t) = 0\n$$\nwhere $\\zeta_n$ is the modal damping ratio for mode $n$. By comparing the coefficient of the velocity term $\\dot{q}_n(t)$ between the derived modal equation and the standard form, we equate them:\n$$\n2\\zeta_n\\omega_n = \\alpha + \\beta \\omega_n^2\n$$\nSolving for the theoretical modal damping ratio $\\zeta_n$ provides the required expression:\n$$\n\\zeta_n = \\frac{\\alpha + \\beta \\omega_n^2}{2\\omega_n}\n$$\nThe numerical test must verify this relationship. The \"measured\" damping ratio for mode $n$ is obtained from the diagonal entries, $c_{nn} = [\\mathbf{C}_\\mathrm{modal}]_{nn}$, of the numerically computed modal damping matrix. From the standard form, $c_{nn} = 2\\zeta_{n, \\text{measured}}\\omega_n$, which gives:\n$$\n\\zeta_{n, \\text{measured}} = \\frac{c_{nn}}{2\\omega_n}\n$$\nThe verification involves comparing the theoretical value $\\zeta_n$ with the measured value $\\zeta_{n, \\text{measured}}$ for each mode and checking that the absolute difference is within a numerical tolerance $\\tau_\\zeta$.\n\nThe implemented program will execute these steps for each test case to determine if both the decoupling and damping ratio properties hold true.", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Executes a unit test to verify Rayleigh damping properties for a 3-DOF system.\n    \"\"\"\n\n    test_cases = [\n        # (m, k, alpha, beta)\n        (2.0, 1000.0, 0.4, 0.0008),  # Test 1\n        (1.0, 1000.0, 0.2, 0.0),     # Test 2\n        (1.0, 1200.0, 0.0, 0.001),    # Test 3\n        (1.5, 500.0, 0.1, 0.002),     # Test 4\n    ]\n\n    tolerances = {\n        \"off_diag\": 1e-9,\n        \"damping_ratio\": 1e-9,\n    }\n\n    results = []\n\n    for m, k, alpha, beta in test_cases:\n        # Step 1: Construct M, K, and C matrices\n        # Mass matrix M = m * I\n        M = m * np.identity(3)\n        \n        # Stiffness matrix K\n        K_base = np.array([\n            [2.0, -1.0, 0.0],\n            [-1.0, 2.0, -1.0],\n            [0.0, -1.0, 2.0]\n        ])\n        K = k * K_base\n        \n        # Rayleigh damping matrix C = alpha*M + beta*K\n        C = alpha * M + beta * K\n\n        # Step 2: Solve the generalized eigenvalue problem K*phi = omega^2*M*phi\n        # scipy.linalg.eigh returns eigenvalues (omega^2) and M-orthonormal eigenvectors (Phi)\n        # such that Phi.T @ M @ Phi = I.\n        omega_sq, Phi = linalg.eigh(K, M)\n        \n        # Natural frequencies omega = sqrt(omega^2)\n        # Eigvals are guaranteed to be positive since K is positive definite.\n        omega = np.sqrt(omega_sq)\n\n        # Step 3: Verify modal decoupling\n        # Form modal damping matrix C_modal = Phi.T * C * Phi\n        C_modal = Phi.T @ C @ Phi\n        \n        # Check if C_modal is diagonal within tolerance tau_off\n        off_diag_mask = ~np.eye(3, dtype=bool)\n        max_abs_off_diag = np.max(np.abs(C_modal[off_diag_mask]))\n        decoupling_verified = max_abs_off_diag  tolerances[\"off_diag\"]\n\n        # Step 4: Verify modal damping ratios\n        # Compute theoretical damping ratios from the derived formula:\n        # zeta_n = (alpha + beta * omega_n^2) / (2 * omega_n)\n        zeta_theoretical = (alpha + beta * omega_sq) / (2 * omega)\n        \n        # Compute \"measured\" damping ratios from the diagonal of C_modal:\n        # c_nn = 2 * zeta_n_measured * omega_n => zeta_n_measured = c_nn / (2*omega_n)\n        c_modal_diag = np.diag(C_modal)\n        zeta_measured = c_modal_diag / (2 * omega)\n        \n        # Check if theoretical and measured ratios match within tolerance tau_zeta\n        max_abs_diff = np.max(np.abs(zeta_theoretical - zeta_measured))\n        ratios_correct = max_abs_diff  tolerances[\"damping_ratio\"]\n\n        # Step 5: Final result for the test case\n        # Test passes if and only if both conditions are met\n        test_passed = decoupling_verified and ratios_correct\n        results.append(str(test_passed).lower())\n\n    # Print results in the required format\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2610986"}]}