{"hands_on_practices": [{"introduction": "To appreciate the innovations of the Hilber-Hughes-Taylor method, it is essential to first understand the trade-offs inherent in more fundamental schemes. This practice guides you through a first-principles analysis of two cornerstone members of the Newmark family: the average acceleration and linear acceleration methods. By deriving and comparing their stability, accuracy, and dissipation characteristics, you will uncover the core challenges—such as the conflict between unconditional stability and period accuracy—that motivated the development of more advanced integrators like HHT.", "problem": "Consider the undamped single-degree-of-freedom semi-discrete structural dynamics model obtained from the finite element method: $m \\ddot{u}(t) + k u(t) = 0$, with natural circular frequency $\\omega = \\sqrt{k/m}$. Time integration is performed by the Newmark family with parameters $(\\beta,\\gamma)$ in the standard form\n- $u_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta a_{n+1}\\right]$,\n- $v_{n+1} = v_n + \\Delta t \\left[(1 - \\gamma) a_n + \\gamma a_{n+1}\\right]$,\nwhere $a_n = \\ddot{u}_n$. For the undamped oscillator, $a_n = -\\omega^2 u_n$.\n\nFocus on the case $\\gamma = 1/2$ and compare the two choices $(\\beta,\\gamma) = (1/4,\\,1/2)$ and $(\\beta,\\gamma) = (1/6,\\,1/2)$. Let $h := \\omega \\Delta t$. Define the numerical (discrete) frequency $\\Omega$ by seeking nontrivial solutions of the form $u_n = \\Re\\{\\hat{u}\\, r^n\\}$ with $r = e^{i \\Omega \\Delta t}$.\n\nFrom the governing equation and the Newmark update, derive from first principles the leading-order small-$h$ behavior of the numerical period error for each scheme, i.e., the relative error in $T = 2\\pi/\\omega$ versus $T_{\\text{num}} = 2\\pi/\\Omega$, and then use it to estimate the relative period error at $h = 1$. Based on your analysis, as well as the stability and dissipation properties that follow from the amplification relation for $r$, determine which of the following statements are correct. Select all that apply.\n\nA. At $h = 1$, both $(\\beta,\\gamma) = (1/4,\\,1/2)$ and $(\\beta,\\gamma) = (1/6,\\,1/2)$ are non-dissipative for the undamped oscillator, and $(\\beta,\\gamma) = (1/6,\\,1/2)$ exhibits roughly half the period elongation of $(1/4,\\,1/2)$.\n\nB. The choice $(\\beta,\\gamma) = (1/6,\\,1/2)$ introduces algorithmic damping (amplitude decay) even for the undamped oscillator.\n\nC. The leading-order relative period error scales like $\\mathcal{O}(h^4)$ for $(\\beta,\\gamma) = (1/6,\\,1/2)$, whereas it is $\\mathcal{O}(h^2)$ for $(1/4,\\,1/2)$.\n\nD. The Hilber–Hughes–Taylor method (often denoted the $\\alpha$-method) achieves second-order accuracy with tunable high-frequency numerical dissipation by taking $\\alpha \\in (-1/3,\\,0]$ together with $\\gamma = 1/2 - \\alpha$ and $\\beta = \\tfrac{1}{4}(1 - \\alpha)^2$.\n\nE. Both $(\\beta,\\gamma) = (1/4,\\,1/2)$ and $(\\beta,\\gamma) = (1/6,\\,1/2)$ are unconditionally stable for any $h$ because $\\gamma = 1/2$ eliminates instabilities.\n\nF. For $h = 4$, $(\\beta,\\gamma) = (1/6,\\,1/2)$ is unstable, while $(\\beta,\\gamma) = (1/4,\\,1/2)$ remains stable.\n\nDiscuss, in particular, the tradeoff between period accuracy and numerical dissipation, and how introducing Hilber–Hughes–Taylor parameters affects high-frequency content while preserving low-frequency accuracy.", "solution": "The problem statement is scientifically sound, self-contained, and well-posed. It presents a standard analysis of the Newmark time integration family for a single-degree-of-freedom undamped oscillator, which is a fundamental topic in computational structural dynamics. All provided definitions and equations are standard. We may proceed with the solution.\n\nThe problem requires analyzing the Newmark integration scheme for the semi-discrete equation of motion:\n$$m \\ddot{u}(t) + k u(t) = 0$$\nLet $\\omega = \\sqrt{k/m}$ be the natural circular frequency. The equation becomes $\\ddot{u}(t) + \\omega^2 u(t) = 0$. For a numerical scheme, we enforce this equation at the discrete time steps, so $a_n = -\\omega^2 u_n$ and $a_{n+1} = -\\omega^2 u_{n+1}$, where $u_n = u(t_n)$ and $a_n = \\ddot{u}(t_n)$.\n\nThe Newmark update rules are given by:\n$$u_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta a_{n+1}\\right]$$\n$$v_{n+1} = v_n + \\Delta t \\left[(1 - \\gamma) a_n + \\gamma a_{n+1}\\right]$$\n\nWe substitute $a_n = -\\omega^2 u_n$ and $a_{n+1} = -\\omega^2 u_{n+1}$ into the update rules. Let $h = \\omega \\Delta t$.\n$$u_{n+1} = u_n + \\Delta t\\, v_n - \\Delta t^2 \\omega^2 \\left(\\tfrac{1}{2} - \\beta\\right) u_n - \\Delta t^2 \\omega^2 \\beta u_{n+1}$$\n$$u_{n+1}(1 + \\beta h^2) = u_n(1 - (\\tfrac{1}{2} - \\beta)h^2) + \\Delta t v_n$$\n$$v_{n+1} = v_n - \\Delta t \\omega^2 (1 - \\gamma) u_n - \\Delta t \\omega^2 \\gamma u_{n+1}$$\n$$\\Delta t v_{n+1} = \\Delta t v_n - h^2 (1 - \\gamma) u_n - h^2 \\gamma u_{n+1}$$\n\nLet the state vector be $\\mathbf{d}_n = \\{u_n, \\Delta t v_n\\}^T$. The update can be written in matrix form $\\mathbf{M}_L \\mathbf{d}_{n+1} = \\mathbf{M}_R \\mathbf{d}_n$:\n$$\n\\begin{pmatrix} 1 + \\beta h^2  0 \\\\ \\gamma h^2  1 \\end{pmatrix}\n\\begin{pmatrix} u_{n+1} \\\\ \\Delta t v_{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} 1 - (\\tfrac{1}{2} - \\beta)h^2  1 \\\\ -h^2(1 - \\gamma)  1 \\end{pmatrix}\n\\begin{pmatrix} u_n \\\\ \\Delta t v_n \\end{pmatrix}\n$$\nThe amplification matrix $\\mathbf{A}$ is given by $\\mathbf{A} = \\mathbf{M}_L^{-1} \\mathbf{M}_R$.\n$$\n\\mathbf{A} = \\frac{1}{1+\\beta h^2}\n\\begin{pmatrix}\n1 - (\\tfrac{1}{2} - \\beta)h^2  1 \\\\\n-h^2  1+(\\beta-\\gamma)h^2\n\\end{pmatrix}\n$$\nThe eigenvalues $r$ of $\\mathbf{A}$ govern the numerical solution characteristics. They are the roots of the characteristic equation $r^2 - (\\text{tr}\\mathbf{A})r + \\det\\mathbf{A} = 0$.\n\nThe problem states to focus on $\\gamma = 1/2$.\nWith $\\gamma=1/2$, the determinant of the amplification matrix can be shown to be $\\det\\mathbf{A} = 1$. This means the method is non-dissipative (it preserves amplitude). The trace is:\n$$ \\text{tr}\\mathbf{A} = \\frac{1 - (\\tfrac{1}{2} - \\beta)h^2 + 1 + (\\beta - \\tfrac{1}{2})h^2}{1 + \\beta h^2} = \\frac{2 - (1 - 2\\beta)h^2}{1 + \\beta h^2} $$\n\nThe eigenvalues are $r = e^{\\pm i \\Omega \\Delta t}$, where $\\Omega$ is the numerical frequency. From the characteristic equation, $r+\\bar{r} = 2\\cos(\\Omega \\Delta t) = \\text{tr}\\mathbf{A}$.\n$$ \\cos(\\Omega \\Delta t) = \\frac{1}{2}\\text{tr}\\mathbf{A} = \\frac{1 - \\frac{1}{2}(1 - 2\\beta)h^2}{1 + \\beta h^2} $$\nFor stability, the eigenvalues must be on or inside the unit circle. Since for $\\gamma=1/2$ they are on the unit circle (if the roots are complex), stability requires $|\\text{tr}\\mathbf{A}| \\le 2$. This condition leads to unconditional stability if $4\\beta \\ge 1$ and conditional stability with $h^2(1-4\\beta)  4$ if $4\\beta  1$.\n\nNow we analyze the two specific schemes with $\\gamma=1/2$.\n\nCase 1: $(\\beta, \\gamma) = (1/4, 1/2)$ (Average acceleration/Trapezoidal rule)\nSince $\\beta=1/4$, the condition $4\\beta \\ge 1$ is met ($1 \\ge 1$), so this method is unconditionally stable.\n$$ \\cos(\\Omega \\Delta t) = \\frac{1 - \\frac{1}{2}(1 - 2/4)h^2}{1 + h^2/4} = \\frac{1 - h^2/4}{1 + h^2/4} $$\nTo find the period error, we use the identity $\\tan^2(x/2) = (1-\\cos x)/(1+\\cos x)$.\n$$ \\tan^2\\left(\\frac{\\Omega \\Delta t}{2}\\right) = \\frac{1 - \\frac{1 - h^2/4}{1 + h^2/4}}{1 + \\frac{1 - h^2/4}{1 + h^2/4}} = \\frac{(1+h^2/4) - (1-h^2/4)}{(1+h^2/4)+(1-h^2/4)} = \\frac{h^2/2}{2} = \\frac{h^2}{4} $$\nTaking the square root, $\\tan(\\frac{\\Omega \\Delta t}{2}) = \\frac{h}{2}$.\nExpanding $\\arctan(x) = x - x^3/3 + \\dots$:\n$$ \\frac{\\Omega \\Delta t}{2} = \\arctan\\left(\\frac{h}{2}\\right) = \\frac{h}{2} - \\frac{1}{3}\\left(\\frac{h}{2}\\right)^3 + O(h^5) = \\frac{h}{2} - \\frac{h^3}{24} + O(h^5) $$\n$$ \\frac{\\Omega}{\\omega} = \\frac{\\Omega \\Delta t}{h} = 1 - \\frac{h^2}{12} + O(h^4) $$\nThe relative period error is $\\frac{T_{\\text{num}} - T}{T} = \\frac{\\omega}{\\Omega} - 1 = \\left(1 - \\frac{h^2}{12}\\right)^{-1} - 1 = 1 + \\frac{h^2}{12} + O(h^4) - 1 = \\frac{h^2}{12} + O(h^4)$.\nThe error is $\\mathcal{O}(h^2)$ and positive, indicating numerical period elongation.\n\nCase 2: $(\\beta, \\gamma) = (1/6, 1/2)$ (Linear acceleration method)\nSince $\\beta=1/6$, $4\\beta=4/6=2/3  1$. This method is conditionally stable. The stability limit is $h^2(1-2/3)  4$, or $h^2  12$, so $h  \\sqrt{12} \\approx 3.46$.\n$$ \\cos(\\Omega \\Delta t) = \\frac{1 - \\frac{1}{2}(1 - 2/6)h^2}{1 + h^2/6} = \\frac{1 - h^2/3}{1 + h^2/6} $$\n$$ \\tan^2\\left(\\frac{\\Omega \\Delta t}{2}\\right) = \\frac{1 - \\frac{1 - h^2/3}{1 + h^2/6}}{1 + \\frac{1 - h^2/3}{1 + h^2/6}} = \\frac{(1+h^2/6) - (1-h^2/3)}{(1+h^2/6) + (1-h^2/3)} = \\frac{h^2/2}{2 - h^2/6} = \\frac{h^2}{4 - h^2/3} $$\nFor small $h$, $\\tan(\\frac{\\Omega \\Delta t}{2}) \\approx \\frac{h/2}{\\sqrt{1-h^2/12}} \\approx \\frac{h}{2}(1 + \\frac{h^2}{24})$.\n$$ \\frac{\\Omega \\Delta t}{2} = \\arctan\\left(\\frac{h}{2}\\left(1 + \\frac{h^2}{24}\\right)\\right) = \\left(\\frac{h}{2}+\\frac{h^3}{48}\\right) - \\frac{1}{3}\\left(\\frac{h}{2}\\right)^3 + O(h^5) = \\frac{h}{2} - \\frac{h^3}{48} + O(h^5) $$\n$$ \\frac{\\Omega}{\\omega} = \\frac{\\Omega \\Delta t}{h} = 1 - \\frac{h^2}{24} + O(h^4) $$\nThe relative period error is $\\frac{T_{\\text{num}} - T}{T} = \\frac{\\omega}{\\Omega} - 1 = \\frac{h^2}{24} + O(h^4)$.\nThe error is also $\\mathcal{O}(h^2)$ and indicates period elongation, but the leading error coefficient is half that of the average acceleration method.\n\nNow we evaluate each statement.\n\nA. At $h = 1$, both $(\\beta,\\gamma) = (1/4,\\,1/2)$ and $(\\beta,\\gamma) = (1/6,\\,1/2)$ are non-dissipative for the undamped oscillator, and $(\\beta,\\gamma) = (1/6,\\,1/2)$ exhibits roughly half the period elongation of $(1/4,\\,1/2)$.\n- As shown, $\\gamma=1/2$ implies $\\det\\mathbf{A}=1$, so both schemes are non-dissipative.\n- The leading-order period error for $(\\beta,\\gamma)=(1/6,1/2)$ is $h^2/24$, which is exactly half of $h^2/12$ for $(\\beta,\\gamma)=(1/4,1/2)$. For $h=1$, the small-$h$ approximation suggests the error for the former is half that of the latter. Let's compute directly:\n  - For $(\\beta,\\gamma)=(1/4,1/2)$, relative period error is $\\frac{T_{num}}{T}-1 = \\frac{\\omega \\Delta t}{\\Omega \\Delta t} - 1 = \\frac{h}{2\\arctan(h/2)} - 1$. For $h=1$, this is $\\frac{1}{2\\arctan(0.5)} - 1 \\approx 0.0784$.\n  - For $(\\beta,\\gamma)=(1/6,1/2)$, relative period error is $\\frac{h}{2\\arctan(h/\\sqrt{4-h^2/3})} - 1$. For $h=1$, this is $\\frac{1}{2\\arctan(1/\\sqrt{11/3})} - 1 \\approx 0.0388$.\n  The ratio $0.0388/0.0784 \\approx 0.495$, which is indeed \"roughly half\".\n- **Verdict: Correct.**\n\nB. The choice $(\\beta,\\gamma) = (1/6,\\,1/2)$ introduces algorithmic damping (amplitude decay) even for the undamped oscillator.\n- This is false. Algorithmic damping is controlled by the determinant of the amplification matrix, or more generally the spectral radius $\\rho(\\mathbf{A})$. For $\\gamma=1/2$, $\\det(\\mathbf{A})=1$ and within the stability limit, the eigenvalues lie on the unit circle, meaning $\\rho(\\mathbf{A})=1$. There is no amplitude decay. Damping requires $\\gamma > 1/2$.\n- **Verdict: Incorrect.**\n\nC. The leading-order relative period error scales like $\\mathcal{O}(h^4)$ for $(\\beta,\\gamma) = (1/6,\\,1/2)$, whereas it is $\\mathcal{O}(h^2)$ for $(1/4,\\,1/2)$.\n- This is false. As derived above, the leading-order relative period error for both schemes scales as $\\mathcal{O}(h^2)$. The constant factors are different ($1/24$ vs $1/12$). A method with fourth-order period accuracy is the Fox-Goodwin method, which has $(\\beta,\\gamma) = (1/12, 1/2)$.\n- **Verdict: Incorrect.**\n\nD. The Hilber–Hughes–Taylor method (often denoted the $\\alpha$-method) achieves second-order accuracy with tunable high-frequency numerical dissipation by taking $\\alpha \\in (-1/3,\\,0]$ together with $\\gamma = 1/2 - \\alpha$ and $\\beta = \\tfrac{1}{4}(1 - \\alpha)^2$.\n- This is a statement of fact about the HHT-$\\alpha$ method. The method is designed to introduce numerical dissipation to damp high-frequency modes while retaining second-order accuracy for low-frequency modes. The parameter relations $\\gamma = 1/2 - \\alpha$ and $\\beta = \\frac{1}{4}(1 - \\alpha)^2$ are precisely those required to achieve this. With $\\alpha \\in [-1/3, 0]$, decreasing $\\alpha$ from $0$ increases high-frequency dissipation. $\\alpha=0$ recovers the non-dissipative trapezoidal rule. The statement is a correct summary of the properties of this widely used method.\n- **Verdict: Correct.**\n\nE. Both $(\\beta,\\gamma) = (1/4,\\,1/2)$ and $(\\beta,\\gamma) = (1/6,\\,1/2)$ are unconditionally stable for any $h$ because $\\gamma = 1/2$ eliminates instabilities.\n- This is false. While $(\\beta,\\gamma)=(1/4,1/2)$ is unconditionally stable, $(\\beta,\\gamma)=(1/6,1/2)$ is only conditionally stable for $h  \\sqrt{12}$. The reason given is also false; $\\gamma=1/2$ eliminates numerical dissipation, it does not guarantee stability. Stability for $\\gamma=1/2$ is governed by $\\beta$.\n- **Verdict: Incorrect.**\n\nF. For $h = 4$, $(\\beta,\\gamma) = (1/6,\\,1/2)$ is unstable, while $(\\beta,\\gamma) = (1/4,\\,1/2)$ remains stable.\n- The scheme $(\\beta,\\gamma)=(1/4,1/2)$ is unconditionally stable, so it is stable for any $h$, including $h=4$.\n- The scheme $(\\beta,\\gamma)=(1/6,1/2)$ has a stability limit of $h  \\sqrt{12} \\approx 3.46$. Since $h=4 > 3.46$, the method is unstable.\n- The statement is therefore true.\n- **Verdict: Correct.**\n\nDiscussion on tradeoffs and HHT method:\nThe analysis reveals a fundamental tradeoff in numerical time integration. Comparing the two primary schemes here, the linear acceleration method $(\\beta=1/6, \\gamma=1/2)$ offers superior period accuracy over the average acceleration method $(\\beta=1/4, \\gamma=1/2)$, with half the leading-order error. However, this comes at the cost of unconditional stability. The average acceleration method is robustly stable for any time step size $\\Delta t$, but less accurate in period. In many applications, especially those involving stiff systems with a wide range of frequencies, unconditional stability is paramount.\n\nNeither of these schemes provides numerical dissipation, which is often desirable to damp out spurious high-frequency oscillations arising from spatial discretization in multi-degree-of-freedom systems. The HHT-$\\alpha$ method (and similar methods like the generalized-$\\alpha$ method) provides a solution. By choosing $\\alpha  0$, we get $\\gamma = 1/2-\\alpha > 1/2$, introducing dissipation. The specific choice of parameters ensures that this dissipation primarily affects high frequencies (large $h$) while preserving second-order accuracy, which means low-frequency response (small $h$) remains highly accurate. This allows engineers to obtain accurate solutions for the dominant structural modes while filtering out non-physical high-frequency noise. This represents a more sophisticated trade-off, balancing accuracy, stability, and dissipation.", "answer": "$$\\boxed{ADF}$$", "id": "2564542"}, {"introduction": "The primary strength of the HHT-$\\alpha$ method lies in its ability to introduce frequency-dependent numerical damping, but a crucial engineering skill is knowing precisely when and how to deploy this feature. This exercise presents the canonical scenario for which the HHT method was designed: a system where non-physical, high-frequency oscillations arise from the spatial discretization of a finite element mesh. By reasoning through the optimal choice for the parameter $\\alpha$, you will solidify your understanding of how to use it as a control knob to selectively filter numerical noise while preserving the fidelity of the physically meaningful, low-frequency response.", "problem": "Consider the undamped linear semi-discrete structural dynamics model arising from the Finite Element Method (FEM): \n$$\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},$$\nwith symmetric positive-definite mass matrix $\\mathbf{M}$ and stiffness matrix $\\mathbf{K}$. You discretize in time using the Hilber-Hughes-Taylor (HHT) method with parameter $\\alpha$, enforcing equilibrium at the blended time $t_{n+1+\\alpha}$ and updating kinematics via a Newmark-type scheme. Assume the time step $\\Delta t$ is fixed and the mesh is such that high-frequency numerical artifacts are primarily due to spatial discretization (e.g., poorly resolved local modes), not true physical stiffness. \n\nFrom a first-principles perspective, and using only fundamental properties of linear oscillators and standard consistency/stability facts of the HHT family, assess how $\\alpha$ should be chosen to selectively damp the spurious high-frequency content while preserving the fidelity of the physically relevant low-to-mid frequency response. In particular, recall that:\n- For undamped linear systems, the exact mechanical energy is conserved.\n- The HHT method recovers the average-acceleration Newmark scheme at $\\alpha = 0$.\n- For appropriate $(\\beta,\\gamma)$ chosen as functions of $\\alpha$, the HHT method is second-order accurate and unconditionally stable for $\\alpha$ within an admissible interval.\n\nWhich of the following guidelines for choosing $\\alpha$ is most appropriate under the stated conditions?\n\nA. Choose $\\alpha$ moderately negative, for example $\\alpha \\in [-0.2, -0.05]$, and set the Newmark parameters to $\\gamma = \\tfrac{1}{2} - \\alpha$ and $\\beta = \\tfrac{1}{4}\\left(1 - \\alpha\\right)^2$. This preserves second-order accuracy and introduces selective algorithmic dissipation that attenuates high-frequency mesh noise while minimally affecting low-frequency content.\n\nB. Choose $\\alpha = 0$, since this eliminates numerical dissipation and thus avoids any distortion of the spectrum; it is preferable because the high-frequency artifacts are numerical rather than physical.\n\nC. Choose $\\alpha$ as negative as possible, i.e., $\\alpha$ close to $- \\tfrac{1}{3}$, to annihilate all high-frequency components without impacting the low-frequency response.\n\nD. Choose a small positive $\\alpha$ to add just enough algorithmic dissipation while maintaining unconditional stability and second-order accuracy.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Governing Equation: $\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}$.\n- Matrix Properties: $\\mathbf{M}$ and $\\mathbf{K}$ are symmetric positive-definite.\n- System Type: Undamped linear semi-discrete structural dynamics model from Finite Element Method (FEM).\n- Numerical Scheme: Hilber-Hughes-Taylor (HHT) method with parameter $\\alpha$. Equilibrium is enforced at time $t_{n+1+\\alpha}$. Kinematics are updated via a Newmark-type scheme.\n- Time Step: $\\Delta t$ is fixed.\n- Source of Error: High-frequency numerical artifacts are due to spatial discretization (mesh noise).\n- Objective: Choose $\\alpha$ to selectively damp spurious high-frequency content while preserving the fidelity of the low-to-mid frequency response.\n- Provided Facts:\n    1. Exact mechanical energy is conserved for the undamped linear system.\n    2. HHT with $\\alpha = 0$ recovers the average-acceleration Newmark scheme.\n    3. For appropriate $(\\beta,\\gamma)$ as functions of $\\alpha$, the HHT method is second-order accurate and unconditionally stable for $\\alpha$ within an admissible interval.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded, well-posed, and objective. It presents a standard scenario in computational mechanics: the need to control non-physical, high-frequency oscillations arising from spatial discretization in a dynamic analysis. The HHT-$\\alpha$ method is a canonical tool for this purpose. The governing equation, terminology, and stated properties of the numerical method are all consistent with established literature in the field of finite element analysis and computational dynamics. The problem does not violate any scientific principles, is not based on false premises, and contains sufficient information to arrive at a definitive answer.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A solution will be derived.\n\nThe problem concerns the selection of the parameter $\\alpha$ in the Hilber-Hughes-Taylor (HHT) time integration scheme for the semi-discrete equation of motion of an undamped linear system:\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0} $$\nThe HHT method modifies the discrete form of this equation by evaluating the residual at a blended time point, which, for a linear system, is equivalent to modifying the stiffness contribution:\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}}_{n+1} + (1+\\alpha)\\mathbf{K}\\,\\mathbf{u}_{n+1} - \\alpha\\mathbf{K}\\,\\mathbf{u}_n = \\mathbf{0} $$\nThe displacement and velocity are updated using the Newmark-beta relations:\n$$ \\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t \\dot{\\mathbf{u}}_n + \\Delta t^2 \\left[ (\\tfrac{1}{2}-\\beta) \\ddot{\\mathbf{u}}_n + \\beta \\ddot{\\mathbf{u}}_{n+1} \\right] $$\n$$ \\dot{\\mathbf{u}}_{n+1} = \\dot{\\mathbf{u}}_n + \\Delta t \\left[ (1-\\gamma) \\ddot{\\mathbf{u}}_n + \\gamma \\ddot{\\mathbf{u}}_{n+1} \\right] $$\nThe central properties of this family of algorithms—accuracy, stability, and numerical dissipation—are functions of the parameters $\\alpha$, $\\beta$, and $\\gamma$. For the HHT method to be unconditionally stable and second-order accurate, these parameters must satisfy specific relations.\n\n1.  **Second-Order Accuracy**: This requires $\\gamma = \\frac{1}{2} - \\alpha$.\n2.  **Unconditional Stability**: For linear systems, this requires $\\alpha \\in [-\\frac{1}{3}, 0]$ and $2\\beta \\ge \\gamma \\ge \\frac{1}{2}$. Combining the accuracy condition with $\\gamma \\ge \\frac{1}{2}$ yields $\\frac{1}{2} - \\alpha \\ge \\frac{1}{2}$, which simplifies to $\\alpha \\le 0$. Thus, the interval for second-order accuracy and unconditional stability is $\\alpha \\in [-\\frac{1}{3}, 0]$. The typical choice for $\\beta$ that guarantees stability and minimizes low-frequency dissipation is $\\beta = \\frac{1}{4}(1-\\alpha)^2$.\n\nThe parameter $\\alpha$ directly controls the amount of numerical (or algorithmic) dissipation. The analysis of a single-degree-of-freedom oscillator with natural frequency $\\omega$ shows how dissipation depends on both $\\alpha$ and the non-dimensional frequency $\\Omega = \\omega \\Delta t$.\n\n-   When $\\alpha=0$, we have $\\gamma=\\frac{1}{2}$ and $\\beta=\\frac{1}{4}$. This is the average acceleration method (trapezoidal rule). This method has no numerical dissipation; the spectral radius of its amplification matrix is exactly $1$ for all frequencies. It conserves energy for linear systems, which means it will not damp any oscillations, including the non-physical, high-frequency \"noise\" from the spatial mesh mentioned in the problem.\n\n-   When $\\alpha  0$ (within the range $[-\\frac{1}{3}, 0)$), we have $\\gamma > \\frac{1}{2}$. This introduces numerical dissipation. A crucial feature of the HHT method is that this dissipation is frequency-dependent: it is very small for low-frequency modes (small $\\Omega$) and increases for high-frequency modes (large $\\Omega$). This is precisely the desired behavior: to damp spurious high-frequency content while leaving the physically significant low-frequency response largely unaffected. The amount of dissipation at any given frequency increases as $\\alpha$ becomes more negative (approaches $-\\frac{1}{3}$).\n\nThe objective is to \"selectively damp the spurious high-frequency content while preserving the fidelity of the physically relevant low-to-mid frequency response\". This points directly to choosing a negative value of $\\alpha$.\n\nNow, we evaluate each option.\n\n**A. Choose $\\alpha$ moderately negative, for example $\\alpha \\in [-0.2, -0.05]$, and set the Newmark parameters to $\\gamma = \\tfrac{1}{2} - \\alpha$ and $\\beta = \\tfrac{1}{4}\\left(1 - \\alpha\\right)^2$. This preserves second-order accuracy and introduces selective algorithmic dissipation that attenuates high-frequency mesh noise while minimally affecting low-frequency content.**\nThis statement is entirely correct.\n- The parameter relations $\\gamma = \\frac{1}{2} - \\alpha$ and $\\beta = \\frac{1}{4}(1 - \\alpha)^2$ are the standard choices for achieving second-order accuracy and unconditional stability.\n- The range $\\alpha \\in [-0.2, -0.05]$ is within the permissible stable range $[-\\frac{1}{3}, 0]$.\n- A negative $\\alpha$ introduces numerical dissipation.\n- The dissipation is frequency-dependent, being stronger at higher frequencies. This property is described as \"selective algorithmic dissipation that attenuates high-frequency mesh noise while minimally affecting low-frequency content,\" which is the primary motivation for the HHT method. A moderate value avoids excessive damping of physically relevant modes.\n**Verdict: Correct.**\n\n**B. Choose $\\alpha = 0$, since this eliminates numerical dissipation and thus avoids any distortion of the spectrum; it is preferable because the high-frequency artifacts are numerical rather than physical.**\nThis statement reflects a misunderstanding of the problem's objective. While $\\alpha=0$ (average acceleration method) does eliminate numerical dissipation, this is undesirable in the present context. The problem explicitly states that high-frequency artifacts exist and need to be dealt with. An energy-conserving scheme will allow these numerical artifacts to persist and pollute the entire solution. The goal is to remove this numerical noise, which requires the introduction of numerical dissipation.\n**Verdict: Incorrect.**\n\n**C. Choose $\\alpha$ as negative as possible, i.e., $\\alpha$ close to $- \\tfrac{1}{3}$, to annihilate all high-frequency components without impacting the low-frequency response.**\nThis choice provides the maximum amount of numerical dissipation possible within the unconditionally stable, second-order HHT family. While it is very effective at damping high-frequency modes, the claim that it does so \"without impacting the low-frequency response\" is an overstatement. Increasing dissipation at the high-frequency end inevitably increases dissipation in the mid-frequency range as well. For many problems, this level of damping is excessive and can degrade the accuracy of physically relevant modes that are not at the lowest end of the spectrum. The term \"annihilate\" is also too strong. Therefore, this is not the \"most appropriate\" general guideline, as a more moderate choice is often a better compromise between stability, noise reduction, and accuracy across the relevant frequency spectrum.\n**Verdict: Incorrect.**\n\n**D. Choose a small positive $\\alpha$ to add just enough algorithmic dissipation while maintaining unconditional stability and second-order accuracy.**\nThis statement is factually incorrect regarding the properties of the HHT method. For the method to be unconditionally stable and second-order accurate using the standard parameter relations, $\\alpha$ must be in the range $[-\\frac{1}{3}, 0]$. A choice of $\\alpha > 0$ violates the conditions for unconditional stability. Therefore, this is not a valid strategy within the context of the HHT-$\\alpha$ method as it is conventionally formulated and used.\n**Verdict: Incorrect.**\n\nBased on this analysis, the only correct and appropriate guideline is given in Option A.", "answer": "$$\\boxed{A}$$", "id": "2564581"}, {"introduction": "The ultimate test of comprehension is the ability to translate abstract theory into a functional, working algorithm. This comprehensive practice challenges you to bridge the gap between derivation and application by building an adaptive HHT-$\\alpha$ integrator from the ground up. You will implement a scheme where the amount of numerical damping is automatically adjusted based on the system's frequency content relative to the time step, and then validate your code against a suite of tests for stability, accuracy, and effectiveness.", "problem": "Consider the second-order linear initial value problem arising in structural dynamics and the finite element method, governed by the balance of linear momentum,\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{f}(t),\n$$\nwhere $\\mathbf{M}$ is a symmetric positive-definite mass matrix, $\\mathbf{C}$ is a symmetric positive-semidefinite damping matrix, $\\mathbf{K}$ is a symmetric positive-semidefinite stiffness matrix, and $\\mathbf{u}(t)$ is the displacement vector. The Hilber-Hughes-Taylor (HHT-$\\alpha$) method is a one-step implicit time integration scheme that enforces the equilibrium equation at a shifted time $t_{n+\\alpha}$ and uses Newmark-type kinematic relations. In the classical scheme, a constant numerical damping parameter $\\alpha \\in [-\\frac{1}{3}, 0]$ is used to control high-frequency dissipation while retaining second-order accuracy and unconditional stability for linear systems.\n\nYour tasks are as follows.\n\n1) Starting from the fundamental definitions of kinematics,\n$$\n\\dot{\\mathbf{u}} = \\frac{d\\mathbf{u}}{dt}, \\quad \\ddot{\\mathbf{u}} = \\frac{d^2\\mathbf{u}}{dt^2},\n$$\nand the linear momentum balance above, derive a one-step HHT-type algorithm for advancing from $(\\mathbf{u}_n, \\dot{\\mathbf{u}}_n, \\ddot{\\mathbf{u}}_n)$ at time $t_n$ to $(\\mathbf{u}_{n+1}, \\dot{\\mathbf{u}}_{n+1}, \\ddot{\\mathbf{u}}_{n+1})$ at time $t_{n+1} = t_n + \\Delta t$. Your derivation must enforce the weighted equilibrium at the shifted time\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{C}\\,\\dot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{K}\\,\\mathbf{u}_{n+\\alpha} = \\mathbf{f}_{n+\\alpha},\n$$\nwith the affine averaging $\\mathbf{x}_{n+\\alpha} = (1-\\alpha)\\,\\mathbf{x}_{n+1} + \\alpha\\,\\mathbf{x}_n$ applied to $\\mathbf{u}, \\dot{\\mathbf{u}}, \\ddot{\\mathbf{u}}$, and $\\mathbf{f}$. Combine this with Newmark-type kinematics for $\\mathbf{u}_{n+1}$ and $\\dot{\\mathbf{u}}_{n+1}$ in terms of $\\ddot{\\mathbf{u}}_{n+1}$, $\\Delta t$, and $(\\mathbf{u}_n,\\dot{\\mathbf{u}}_n,\\ddot{\\mathbf{u}}_n)$. Derive the algebraic conditions relating the Newmark parameters to $\\alpha$ that are necessary and sufficient for consistency up to local truncation error of order $O(\\Delta t^3)$ (that is, global second-order accuracy) and for unconditional stability on linear systems with $\\mathbf{C}\\succeq \\mathbf{0}$. Do not assume any specific forms of these relations; obtain them from Taylor expansions and the enforced weighted equilibrium.\n\n2) Propose a variable-$\\alpha$ construction that depends on a modal content estimator. For a single-degree-of-freedom system with scalar $m0$, $c\\ge 0$, and $k\\ge 0$, define the estimator using the Rayleigh frequency\n$$\n\\omega_n = \\sqrt{\\frac{k}{m}},\n$$\nand normalize it by the numerical Nyquist frequency\n$$\n\\omega_N = \\frac{\\pi}{\\Delta t}.\n$$\nDefine a smooth mapping\n$$\n\\phi = \\tanh\\!\\left(\\left(\\frac{\\omega_n}{\\omega_N}\\right)^p\\right), \\quad p = 4,\n$$\nand set the per-step numerical damping as\n$$\n\\alpha = -\\alpha_{\\max}\\,\\phi, \\quad \\alpha_{\\max} = 0.30,\n$$\nchosen at the beginning of the step and held fixed within that step. Select the Newmark parameters consistently with your derivation in task $1$ to retain second-order accuracy when $\\alpha$ varies stepwise in time. Justify the conditions under which second-order accuracy is retained and unconditional stability persists for the resulting variable-$\\alpha$ HHT scheme.\n\n3) Implement the resulting variable-$\\alpha$ HHT scheme for the single-degree-of-freedom case with zero external load $\\mathbf{f}(t) = 0$, using the above estimator and mapping. Use the International System of Units (SI): mass in kilograms, stiffness in newtons per meter, damping in newton-seconds per meter, displacements in meters, and time in seconds. Your implementation must be a complete and runnable program, and must not require any user input.\n\n4) Use your implementation to evaluate the following test suite. For every simulation, use the stated units and initial conditions. The external force is zero. For accuracy assessment, when an analytical reference is needed, use the exact undamped harmonic oscillator solution. The final outputs must be:\n- For stability checks, a boolean defined as true if the maximum absolute displacement over the simulated time interval does not exceed the provided bound.\n- For order checks, a float estimating the observed order $p_{\\mathrm{obs}}$ computed as $\\log(e_{\\Delta t}/e_{\\Delta t/2})/\\log(2)$, where $e_{\\Delta t}$ is the absolute error in displacement at the final time using step size $\\Delta t$.\n\nTest cases:\n- Test $1$ (happy path stability under modest damping and moderate resolution): $m=1$, $c=0.02$, $k=(2\\pi\\cdot 20)^2$, $\\Delta t = 0.0025$, total time $T=0.5$, initial conditions $u(0)=1$, $\\dot{u}(0)=0$. Output a boolean indicating whether $\\max_{0\\le t\\le T} |u(t)| \\le 1.5$.\n- Test $2$ (large time step stability edge): same $m$, $c$, and $k$ as Test $1$, but with $\\Delta t = 0.02$, total time $T=0.5$, initial conditions $u(0)=1$, $\\dot{u}(0)=0$. Output a boolean indicating whether $\\max_{0\\le t\\le T} |u(t)| \\le 5.0$.\n- Test $3$ (second-order accuracy verification at low frequency): undamped oscillator with $m=1$, $c=0$, $k=(2\\pi)^2$, initial conditions $u(0)=1$, $\\dot{u}(0)=0$, final time $T=1$. Compute the displacement error at $t=T$ for $\\Delta t_1=0.02$ and $\\Delta t_2=0.01$ and output the estimated order $p_{\\mathrm{obs}}$ as a float. The analytical reference is $u_{\\mathrm{exact}}(T)=\\cos(\\omega T)$ with $\\omega=\\sqrt{k/m}$.\n- Test $4$ (adaptive numerical damping effectiveness): high-frequency system with $m=1$, $c=0.02$, $k=(2\\pi\\cdot 50)^2$, $\\Delta t=0.01$, total time $T=0.2$, initial conditions $u(0)=0$, $\\dot{u}(0)=1$. Compute two simulations: one with variable $\\alpha$ as defined, and one with $\\alpha=0$ (the average-acceleration Newmark method). Output a boolean indicating whether the root-mean-square displacement over the interval $[0,T]$ produced by the variable-$\\alpha$ scheme is less than or equal to that from $\\alpha=0$.\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases: $[b_1,b_2,p_3,b_4]$. The booleans $b_1$, $b_2$, and $b_4$ must be printed as literal true or false in Python’s default formatting, and the float $p_3$ must be printed rounded to six decimal places. No other text should be printed.", "solution": "The problem presented is a standard, well-posed exercise in the field of computational structural dynamics. It asks for the derivation, specialization, implementation, and testing of the Hilber-Hughes-Taylor (HHT-$\\alpha$) time integration method, or more specifically, a form often known as the WBZ-$\\alpha$ method, for a second-order linear system. All parameters and objectives are clearly defined, scientifically grounded, and computationally feasible. The problem is valid.\n\nWe proceed with the solution in four parts as requested.\n\n### Part 1: Derivation of the HHT-type Algorithm\n\nThe governing equation of motion for a linear structural system is given by:\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{f}(t)\n$$\nwhere $\\mathbf{M}$, $\\mathbf{C}$, and $\\mathbf{K}$ are the mass, damping, and stiffness matrices, respectively, and $\\mathbf{u}(t)$ is the displacement vector.\n\nThe HHT-$\\alpha$ method is a one-step implicit scheme that numerically integrates this equation. It belongs to the family of Newmark methods. We start by defining the Newmark kinematic relations, which approximate the displacement $\\mathbf{u}_{n+1}$ and velocity $\\dot{\\mathbf{u}}_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$:\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t\\,\\dot{\\mathbf{u}}_n + \\frac{\\Delta t^2}{2} \\left[ (1 - 2\\beta) \\ddot{\\mathbf{u}}_n + 2\\beta \\ddot{\\mathbf{u}}_{n+1} \\right]\n$$\n$$\n\\dot{\\mathbf{u}}_{n+1} = \\dot{\\mathbf{u}}_n + \\Delta t \\left[ (1 - \\gamma) \\ddot{\\mathbf{u}}_n + \\gamma \\ddot{\\mathbf{u}}_{n+1} \\right]\n$$\nHere, $\\beta$ and $\\gamma$ are the Newmark integration parameters that determine the stability and accuracy of the method. These equations can be rearranged to express $\\mathbf{u}_{n+1}$ and $\\dot{\\mathbf{u}}_{n+1}$ in terms of the yet unknown acceleration $\\ddot{\\mathbf{u}}_{n+1}$ and quantities from time $t_n$.\n\nThe HHT-$\\alpha$ method, as defined in the problem, enforces the equation of motion at a weighted-average point between $t_n$ and $t_{n+1}$:\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{C}\\,\\dot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{K}\\,\\mathbf{u}_{n+\\alpha} = \\mathbf{f}_{n+\\alpha}\n$$\nwhere a generic quantity $\\mathbf{x}_{n+\\alpha}$ is defined by the affine average:\n$$\n\\mathbf{x}_{n+\\alpha} = (1-\\alpha)\\,\\mathbf{x}_{n+1} + \\alpha\\,\\mathbf{x}_n\n$$\napplied to $\\mathbf{u}, \\dot{\\mathbf{u}}, \\ddot{\\mathbf{u}}$, and $\\mathbf{f}$. The parameter $\\alpha \\in [-\\frac{1}{3}, 0]$ controls numerical dissipation of high-frequency modes.\n\nSubstituting the affine averaging into the weighted equilibrium equation gives:\n$$\n(1-\\alpha)(\\mathbf{M}\\ddot{\\mathbf{u}}_{n+1} + \\mathbf{C}\\dot{\\mathbf{u}}_{n+1} + \\mathbf{K}\\mathbf{u}_{n+1}) + \\alpha(\\mathbf{M}\\ddot{\\mathbf{u}}_{n} + \\mathbf{C}\\dot{\\mathbf{u}}_{n} + \\mathbf{K}\\mathbf{u}_{n}) = (1-\\alpha)\\mathbf{f}_{n+1} + \\alpha\\mathbf{f}_{n}\n$$\nNow, substitute the Newmark relations for $\\mathbf{u}_{n+1}$ and $\\dot{\\mathbf{u}}_{n+1}$ into this equation. This leads to an equation solely for the unknown acceleration $\\ddot{\\mathbf{u}}_{n+1}$:\n$$\n(1-\\alpha)\\left(\\mathbf{M}\\ddot{\\mathbf{u}}_{n+1} + \\mathbf{C}(\\dot{\\mathbf{u}}_n + \\Delta t (1 - \\gamma) \\ddot{\\mathbf{u}}_n + \\gamma \\Delta t \\ddot{\\mathbf{u}}_{n+1}) + \\mathbf{K}(\\mathbf{u}_n + \\Delta t\\,\\dot{\\mathbf{u}}_n + \\frac{\\Delta t^2}{2} ((1 - 2\\beta) \\ddot{\\mathbf{u}}_n + 2\\beta \\ddot{\\mathbf{u}}_{n+1}))\\right) + \\alpha(\\mathbf{M}\\ddot{\\mathbf{u}}_{n} + \\mathbf{C}\\dot{\\mathbf{u}}_{n} + \\mathbf{K}\\mathbf{u}_{n}) = (1-\\alpha)\\mathbf{f}_{n+1} + \\alpha\\mathbf{f}_{n}\n$$\nRearranging to group terms involving $\\ddot{\\mathbf{u}}_{n+1}$ on the left-hand side:\n$$\n\\left[ (1-\\alpha)\\mathbf{M} + (1-\\alpha)\\gamma\\Delta t\\,\\mathbf{C} + (1-\\alpha)\\beta\\Delta t^2\\,\\mathbf{K} \\right] \\ddot{\\mathbf{u}}_{n+1} = (1-\\alpha)\\mathbf{f}_{n+1} + \\alpha\\mathbf{f}_{n} - \\alpha(\\mathbf{M}\\ddot{\\mathbf{u}}_{n} + \\mathbf{C}\\dot{\\mathbf{u}}_{n} + \\mathbf{K}\\mathbf{u}_{n}) - (1-\\alpha)\\left( \\mathbf{C}(\\dot{\\mathbf{u}}_n + \\Delta t(1-\\gamma)\\ddot{\\mathbf{u}}_n) + \\mathbf{K}(\\mathbf{u}_n + \\Delta t\\dot{\\mathbf{u}}_n + \\Delta t^2(\\frac{1}{2}-\\beta)\\ddot{\\mathbf{u}}_n) \\right)\n$$\nThis is a linear system of equations of the form $\\hat{\\mathbf{M}}\\,\\ddot{\\mathbf{u}}_{n+1} = \\hat{\\mathbf{f}}_n$, where $\\hat{\\mathbf{M}}$ is the effective mass matrix and $\\hat{\\mathbf{f}}_n$ is the effective force vector. Once $\\ddot{\\mathbf{u}}_{n+1}$ is computed, $\\mathbf{u}_{n+1}$ and $\\dot{\\mathbf{u}}_{n+1}$ are found from the Newmark relations.\n\n**Conditions for Accuracy and Stability:**\nThe derivation of these conditions is based on analyzing the method's behavior on an unforced, undamped single-degree-of-freedom (SDOF) system, $\\ddot{u} + \\omega^2 u = 0$. The analysis involves writing the one-step algorithm as $\\mathbf{y}_{n+1} = \\mathbf{A}\\,\\mathbf{y}_n$, where $\\mathbf{y}_n = \\{u_n, \\Delta t \\dot{u}_n, \\Delta t^2 \\ddot{u}_n\\}^T$ and $\\mathbf{A}$ is the amplification matrix.\n\n1.  **Second-Order Accuracy:** To achieve second-order accuracy (i.e., local truncation error of order $O(\\Delta t^3)$), the method must not introduce artificial numerical damping in the low-frequency limit ($\\omega \\Delta t \\rightarrow 0$) and must have a period error of $O(\\Delta t^2)$. This analysis, performed by comparing the characteristic roots of the amplification matrix to the exact solution $e^{\\pm i\\omega\\Delta t}$, yields the condition:\n    $$\n    \\gamma = \\frac{1}{2} - \\alpha\n    $$\n\n2.  **Unconditional Stability:** For unconditional stability, the spectral radius of the amplification matrix, $\\rho(\\mathbf{A})$, must be less than or equal to one for all values of $\\omega \\Delta t$. For the method to be dissipative in the high-frequency limit ($\\omega \\Delta t \\rightarrow \\infty$), we require $\\rho(\\mathbf{A})  1$. These constraints lead to the following necessary and sufficient conditions:\n    $$\n    \\gamma \\ge \\frac{1}{2}, \\quad \\beta \\ge \\frac{1}{4}(1-\\alpha+\\gamma)^2\n    $$\n    Combining the accuracy and stability requirements, we substitute $\\gamma = 1/2 - \\alpha$. The condition $\\gamma \\ge 1/2$ requires $1/2 - \\alpha \\ge 1/2$, which implies $\\alpha \\le 0$. The problem states $\\alpha \\in [-1/3, 0]$, which satisfies this. The most common choice to maximize high-frequency dissipation for a given $\\alpha$ is:\n    $$\n    \\beta = \\frac{(1-\\alpha)^2}{4}\n    $$\n    This choice fulfills the general stability conditions for $\\alpha \\in [-1/3, 0]$. Specifically, for $\\alpha=0$, we recover the Newmark average acceleration method with $\\gamma=1/2, \\beta=1/4$, which is non-dissipative and unconditionally stable. For $\\alpha=-1/3$, we get $\\gamma=5/6$ and $\\beta=4/9$, which provides strong numerical damping.\n\n### Part 2: Variable-$\\alpha$ Construction\n\nWe are asked to propose a variable-$\\alpha$ scheme where $\\alpha$ is adjusted at each time step based on modal content. For an SDOF system, the modal content is defined by the natural frequency $\\omega_n = \\sqrt{k/m}$.\n\nThe scheme is defined as:\n$$\n\\alpha_n = -\\alpha_{\\max}\\,\\phi_n, \\quad \\text{with} \\quad \\alpha_{\\max} = 0.30\n$$\nwhere $\\phi_n$ is a mapping based on the ratio of the system's frequency to the numerical Nyquist frequency, $\\omega_N = \\pi/\\Delta t$:\n$$\n\\phi_n = \\tanh\\left(\\left(\\frac{\\omega_n}{\\omega_N}\\right)^p\\right), \\quad \\text{with} \\quad p = 4\n$$\nAt the beginning of each step $n$, we compute $\\alpha_n$ and hold it fixed for the duration of that step. To maintain second-order accuracy and unconditional stability, we must select the Newmark parameters consistently at each step. Following the derivation in Part 1, we set:\n$$\n\\gamma_n = \\frac{1}{2} - \\alpha_n\n$$\n$$\n\\beta_n = \\frac{(1-\\alpha_n)^2}{4}\n$$\n\n**Justification of Properties:**\n\n1.  **Second-Order Accuracy:** For a scheme with time-varying parameters, second-order accuracy is retained if the parameters for step $n \\to n+1$ are determined based on the state at time $t_n$ (or are otherwise independent of the state at $t_{n+1}$) and satisfy the accuracy condition for a constant-parameter scheme. In our case, $\\omega_n$ is constant for an LTI system, so $\\alpha_n$, $\\beta_n$, and $\\gamma_n$ are constant throughout the simulation (though dependent on $\\Delta t$). Even if $k$ or $m$ were changing slowly, the principle of determining parameters at the start of the step preserves accuracy. The relation $\\gamma_n = 1/2 - \\alpha_n$ is satisfied by construction, ensuring the local truncation error is $O(\\Delta t^3)$, which integrates to a global error of $O(\\Delta t^2)$.\n\n2.  **Unconditional Stability:** For a linear system, stability can be analyzed on a per-step basis. At each step $n$, the algorithm proceeds with a fixed set of parameters $(\\alpha_n, \\beta_n, \\gamma_n)$. We must check if these parameters satisfy the unconditional stability conditions.\n    -   The mapping $\\phi_n$ produces values in $[0, 1)$, since $\\omega_n/\\omega_N \\ge 0$.\n    -   Therefore, $\\alpha_n = -0.30\\,\\phi_n$ lies in the range $(-0.30, 0]$. This is within the range $[-1/3, 0]$ for which the HHT method is known to be unconditionally stable with the chosen parameter relations.\n    -   The parameters are chosen as $\\gamma_n = 1/2 - \\alpha_n$ and $\\beta_n = (1-\\alpha_n)^2/4$. As established in Part 1, these choices ensure that the stability conditions $\\gamma_n \\ge 1/2$ and the more general conditions are met for $\\alpha_n \\le 0$.\n    -   Since the method is unconditionally stable for the parameters chosen at every individual step, the overall variable-parameter scheme remains unconditionally stable for linear problems. The amount of numerical damping is adapted based on how well the time step resolves the system's natural period.\n\n### Part 3: Implementation Algorithm\n\nFor a single-degree-of-freedom system with $f(t)=0$, the algorithm to advance from step $n$ to $n+1$ is as follows:\n\n1.  **Initialization**: Given $m, c, k$ and initial conditions $u_0, \\dot{u}_0$. Calculate the initial acceleration by enforcing the equation of motion at $t=0$:\n    $$\n    \\ddot{u}_0 = -(c\\dot{u}_0 + k u_0) / m\n    $$\n\n2.  **For each time step $n=0, 1, 2, ...$**:\n    a. **Compute adaptive parameters**:\n       -   $\\omega_n = \\sqrt{k/m}$\n       -   $\\omega_N = \\pi/\\Delta t$\n       -   $\\phi_n = \\tanh((\\omega_n/\\omega_N)^4)$\n       -   $\\alpha_n = -0.30\\,\\phi_n$\n       -   $\\gamma_n = 1/2 - \\alpha_n$\n       -   $\\beta_n = (1-\\alpha_n)^2/4$\n       For the specific fixed-parameter test case ($\\alpha=0$), these are simply set to $\\alpha_n=0, \\gamma_n=1/2, \\beta_n=1/4$.\n\n    b. **Solve for $\\ddot{u}_{n+1}$**:\n       The linear system from Part 1 simplifies to a scalar equation $A\\ddot{u}_{n+1} = B$, where:\n       $$\n       A = (1-\\alpha_n)m + (1-\\alpha_n)\\gamma_n\\Delta t\\,c + (1-\\alpha_n)\\beta_n\\Delta t^2\\,k\n       $$\n       $$\n        B = -(1-\\alpha_n)\\left[ c(\\dot{u}_n + \\Delta t(1-\\gamma_n)\\ddot{u}_n) + k(u_n + \\Delta t\\dot{u}_n + \\Delta t^2(\\frac{1}{2}-\\beta_n)\\ddot{u}_n) \\right] - \\alpha_n(m\\ddot{u}_n + c\\dot{u}_n + ku_n)\n       $$\n       $$\n       \\ddot{u}_{n+1} = B/A\n       $$\n\n    c. **Update state (corrector step)**:\n       $$\n       u_{n+1} = \\left(u_n + \\Delta t\\dot{u}_n + \\Delta t^2(\\frac{1}{2}-\\beta_n)\\ddot{u}_n\\right) + \\beta_n\\Delta t^2 \\ddot{u}_{n+1}\n       $$\n       $$\n       \\dot{u}_{n+1} = \\left(\\dot{u}_n + \\Delta t(1-\\gamma_n)\\ddot{u}_n\\right) + \\gamma_n\\Delta t \\ddot{u}_{n+1}\n       $$\n    The terms in parentheses are the \"predictor\" values.\n\n### Part 4: Test Suite Evaluation\n\nThe implementation described in Part 3 is used to run the specified test cases. The results are computed as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by implementing the variable-alpha HHT scheme and running the specified test cases.\n    \"\"\"\n\n    def run_hht_simulation(m, c, k, u0, v0, dt, T, alpha_mode='variable'):\n        \"\"\"\n        Runs a single-degree-of-freedom HHT simulation.\n\n        Args:\n            m (float): mass\n            c (float): damping\n            k (float): stiffness\n            u0 (float): initial displacement\n            v0 (float): initial velocity\n            dt (float): time step\n            T (float): total simulation time\n            alpha_mode (str): 'variable' for adaptive alpha, 'zero' for alpha=0.\n\n        Returns:\n            A tuple (t_hist, u_hist, v_hist, a_hist) with time histories.\n        \"\"\"\n        n_steps = int(round(T / dt))\n        t_hist = np.linspace(0, n_steps * dt, n_steps + 1)\n        u_hist = np.zeros(n_steps + 1)\n        v_hist = np.zeros(n_steps + 1)\n        a_hist = np.zeros(n_steps + 1)\n\n        # Initial conditions\n        u_hist[0] = u0\n        v_hist[0] = v0\n        # Enforce EOM at t=0 to find a0, assuming f(0)=0\n        if m > 0:\n            a_hist[0] = -(c * v0 + k * u0) / m\n        else: # m=0 case not expected but handle\n            a_hist[0] = 0\n\n        # Pre-calculate frequency terms for variable alpha\n        if alpha_mode == 'variable':\n            if m > 0 and k >= 0:\n                omega_n = np.sqrt(k / m)\n            else:\n                omega_n = 0.0\n            omega_N = np.pi / dt\n            ratio = omega_n / omega_N if omega_N > 0 else 0\n            # Use p=4 as specified\n            phi = np.tanh(ratio**4)\n            # Use alpha_max = 0.30 as specified\n            alpha = -0.30 * phi\n        else: # alpha_mode == 'zero'\n            alpha = 0.0\n\n        gamma = 0.5 - alpha\n        beta = (1 - alpha)**2 / 4\n\n        for n in range(n_steps):\n            u_n, v_n, a_n = u_hist[n], v_hist[n], a_hist[n]\n\n            # The problem is mislabeled as HHT-alpha but describes the WBZ-alpha method.\n            # The derivation in the solution text follows the WBZ-alpha method.\n            # Solve for a_{n+1}. Equation is A_eff*a_{n+1} = B_eff\n            # A_eff = (1-a)m + (1-a)g*dt*c + (1-a)b*dt^2*k\n            # B_eff = -(1-a)[c(v_n+dt(1-g)a_n) + k(u_n+dt*v_n+dt^2(0.5-b)a_n)] - a(m*a_n+c*v_n+k*u_n)\n            \n            A_eff = (1 - alpha) * (m + gamma * dt * c + beta * dt**2 * k)\n            \n            # Predictor terms needed for B_eff\n            v_tilde_np1 = v_n + dt * (1 - gamma) * a_n\n            u_tilde_np1 = u_n + dt * v_n + dt**2 * (0.5 - beta) * a_n\n\n            # External force is zero, so f_nalpha = 0\n            # The EOM at t=0 is satisfied by a_0, so (m*a_n+c*v_n+k*u_n) is not zero for n>0\n            # if we were to enforce f_n=0. But the term comes from the alpha-weighting.\n            B_eff = -(1-alpha)*(c * v_tilde_np1 + k * u_tilde_np1) - alpha * (m * a_n + c * v_n + k * u_n)\n            \n            if A_eff != 0:\n                a_np1 = B_eff / A_eff\n            else:\n                a_np1 = 0\n\n            # Corrector step\n            u_np1 = u_tilde_np1 + beta * dt**2 * a_np1\n            v_np1 = v_tilde_np1 + gamma * dt * a_np1\n\n            u_hist[n + 1] = u_np1\n            v_hist[n + 1] = v_np1\n            a_hist[n + 1] = a_np1\n\n        return t_hist, u_hist, v_hist, a_hist\n\n    results = []\n\n    # Test 1: Stability under modest damping and moderate resolution\n    m1, c1, k1 = 1.0, 0.02, (2 * np.pi * 20)**2\n    dt1, T1 = 0.0025, 0.5\n    u01, v01 = 1.0, 0.0\n    _, u_hist1, _, _ = run_hht_simulation(m1, c1, k1, u01, v01, dt1, T1)\n    b1 = np.max(np.abs(u_hist1)) = 1.5\n    results.append(b1)\n\n    # Test 2: Large time step stability edge\n    m2, c2, k2 = 1.0, 0.02, (2 * np.pi * 20)**2\n    dt2, T2 = 0.02, 0.5\n    u02, v02 = 1.0, 0.0\n    _, u_hist2, _, _ = run_hht_simulation(m2, c2, k2, u02, v02, dt2, T2)\n    b2 = np.max(np.abs(u_hist2)) = 5.0\n    results.append(b2)\n    \n    # Test 3: Second-order accuracy verification\n    m3, c3, k3 = 1.0, 0.0, (2 * np.pi)**2\n    T3 = 1.0\n    u03, v03 = 1.0, 0.0\n    dt3a, dt3b = 0.02, 0.01\n\n    _, u_hist3a, _, _ = run_hht_simulation(m3, c3, k3, u03, v03, dt3a, T3)\n    u_final_3a = u_hist3a[-1]\n\n    _, u_hist3b, _, _ = run_hht_simulation(m3, c3, k3, u03, v03, dt3b, T3)\n    u_final_3b = u_hist3b[-1]\n    \n    omega_3 = np.sqrt(k3 / m3)\n    u_exact_T3 = np.cos(omega_3 * T3)\n\n    e_dta = np.abs(u_final_3a - u_exact_T3)\n    e_dtb = np.abs(u_final_3b - u_exact_T3)\n\n    if e_dta > 0 and e_dtb > 0:\n        p_obs = np.log(e_dta / e_dtb) / np.log(2)\n    else: # Fallback if error is zero (unlikely but possible)\n        p_obs = 2.0\n        \n    results.append(f\"{p_obs:.6f}\")\n    \n    # Test 4: Adaptive numerical damping effectiveness\n    m4, c4, k4 = 1.0, 0.02, (2 * np.pi * 50)**2\n    dt4, T4 = 0.2\n    u04, v04 = 0.0, 1.0\n\n    # Variable alpha simulation\n    _, u_hist4_var, _, _ = run_hht_simulation(m4, c4, k4, u04, v04, dt4, T4, alpha_mode='variable')\n    rms_var = np.sqrt(np.mean(u_hist4_var**2))\n\n    # Alpha=0 simulation (Newmark average acceleration)\n    _, u_hist4_zero, _, _ = run_hht_simulation(m4, c4, k4, u04, v04, dt4, T4, alpha_mode='zero')\n    rms_zero = np.sqrt(np.mean(u_hist4_zero**2))\n\n    b4 = rms_var = rms_zero\n    results.append(b4)\n    \n    # Final print statement\n    result_str = \",\".join(map(str, results)).lower()\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "2564526"}]}