{"hands_on_practices": [{"introduction": "We begin with a foundational exercise that constructs the stiffness matrix for a simple one-dimensional problem from scratch. This practice is essential as it directly illustrates how the core properties of the stiffness matrix—sparsity, symmetry, and positive definiteness—emerge naturally from the local support of the finite element basis functions and the symmetric nature of the underlying physical model [@problem_id:2600099]. By working through this canonical example, you will gain a concrete understanding of the matrix's structure and its connection to the problem's weak formulation.", "problem": "Consider the scalar, second-order elliptic boundary value problem on the unit interval with homogeneous Dirichlet boundary conditions: find $u$ such that $- \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right) = f$ in $(0,1)$ with $u(0)=u(1)=0$, where $a(x)$ is strictly positive and essentially bounded. Starting from the weak formulation obtained by multiplying the strong form by a test function $v$ and integrating by parts on $(0,1)$, use the standard continuous, piecewise-linear finite element method on the uniform partition $0=x_0<x_1<x_2<x_3<x_4=1$ with $x_i = i/4$ and interior nodes $x_1$, $x_2$, $x_3$. Let the coefficient be constant, $a(x) \\equiv 1$, and let $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ denote the canonical nodal basis of the discrete space $V_h \\subset H_0^1(0,1)$.\n\nUsing only the definition of the bilinear form $b(u,v) = \\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx$, derive the assembled stiffness matrix $K \\in \\mathbb{R}^{3 \\times 3}$ with entries $K_{ij} = b(\\varphi_i,\\varphi_j)$. From first principles, justify why $K$ is sparse, symmetric, and positive definite. Finally, determine the smallest eigenvalue of $K$ in closed form. Give your final answer as a single exact expression (no numerical rounding).", "solution": "We start from the strong form $- \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right) = f$ in $(0,1)$ with $u(0)=u(1)=0$. Let $v \\in H_0^1(0,1)$ be arbitrary. Multiplying the strong form by $v$ and integrating over $(0,1)$ gives $\\int_0^1 - \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right)v\\,dx = \\int_0^1 f\\,v\\,dx$. Integration by parts together with $v(0)=v(1)=0$ yields the weak form\n\n$$\n\\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx = \\int_0^1 f(x)\\,v(x)\\,dx,\n$$\n\ni.e., $b(u,v) = \\ell(v)$ with bilinear form $b(u,v) = \\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx$ and linear functional $\\ell(v) = \\int_0^1 f\\,v\\,dx$.\n\nWe discretize with continuous, piecewise-linear functions on the uniform mesh with nodes $x_i = i/4$, $i=0,1,2,3,4$, and homogeneous Dirichlet boundary conditions incorporated by restricting to the interior nodes $x_1$, $x_2$, $x_3$. The basis $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ satisfies $\\varphi_i(x_j) = \\delta_{ij}$ for $i,j \\in \\{1,2,3\\}$, with support of $\\varphi_i$ equal to $[x_{i-1},x_{i+1}]$. On each element, the derivative of a basis function is constant: on $[x_{i-1},x_i]$ we have $\\varphi_i'(x) = \\frac{1}{h}$ and $\\varphi_{i-1}'(x) = -\\frac{1}{h}$, while on $[x_i,x_{i+1}]$ we have $\\varphi_i'(x) = -\\frac{1}{h}$ and $\\varphi_{i+1}'(x) = \\frac{1}{h}$, where $h = x_i - x_{i-1} = \\frac{1}{4}$.\n\nWith $a(x) \\equiv 1$, the element stiffness matrix on any interval $[x_{e},x_{e+1}]$ for the local nodal basis $\\{\\widehat{\\varphi}_{e},\\widehat{\\varphi}_{e+1}\\}$ is\n\n$$\nk^{(e)}_{lm} \\;=\\; \\int_{x_e}^{x_{e+1}} \\widehat{\\varphi}'_{l}(x)\\,\\widehat{\\varphi}'_{m}(x)\\,dx\n\\;=\\; \\frac{1}{h}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}_{lm}.\n$$\n\nAssembling the three identical contributions from the elements $[x_0,x_1]$, $[x_1,x_2]$, $[x_2,x_3]$, and $[x_3,x_4]$ into the interior-node basis $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ yields the global stiffness matrix\n\n$$\nK \\;=\\; \\frac{1}{h}\n\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}\n\\;=\\;\n4\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix},\n$$\n\nbecause $h = \\frac{1}{4}$.\n\nWe now justify the three properties.\n\nSparsity: For $|i-j| \\geq 2$, the supports of $\\varphi_i$ and $\\varphi_j$ are disjoint, hence $\\varphi_i'(x)\\,\\varphi_j'(x) = 0$ almost everywhere. Therefore, $K_{ij} = \\int_0^1 \\varphi_i'(x)\\,\\varphi_j'(x)\\,dx = 0$ for $|i-j|\\geq 2$. Only $K_{ii}$ and $K_{i,i\\pm 1}$ can be nonzero, which gives a tridiagonal matrix. This sparsity arises solely from the locality of the basis functions and the elementwise definition of the bilinear form.\n\nSymmetry: For any basis functions $\\varphi_i$ and $\\varphi_j$, we have\n\n$$\nK_{ij} \\;=\\; b(\\varphi_i,\\varphi_j) \\;=\\; \\int_0^1 a(x)\\,\\varphi_i'(x)\\,\\varphi_j'(x)\\,dx \\;=\\; \\int_0^1 a(x)\\,\\varphi_j'(x)\\,\\varphi_i'(x)\\,dx \\;=\\; b(\\varphi_j,\\varphi_i) \\;=\\; K_{ji},\n$$\n\nbecause multiplication of real-valued functions is commutative and $a(x)>0$ is scalar. Hence $K$ is symmetric.\n\nPositive definiteness: For any nonzero coefficient vector $c = (c_1,c_2,c_3)^{\\mathsf{T}}$, define $u_h = \\sum_{i=1}^{3} c_i\\,\\varphi_i \\in V_h$, which is not the zero function if $c \\neq 0$. Then\n\n$$\nc^{\\mathsf{T}} K c \\;=\\; \\sum_{i,j=1}^{3} c_i\\,c_j\\,K_{ij} \\;=\\; \\sum_{i,j=1}^{3} c_i\\,c_j\\,b(\\varphi_i,\\varphi_j) \\;=\\; b(u_h,u_h) \\;=\\; \\int_0^1 a(x)\\,|u_h'(x)|^2\\,dx.\n$$\n\nWith $a(x) \\equiv 1$, we have $c^{\\mathsf{T}} K c = \\int_0^1 |u_h'(x)|^2\\,dx$. For $u_h \\in H_0^1(0,1)$ and $u_h \\neq 0$, one has $u_h' \\not\\equiv 0$, so $\\int_0^1 |u_h'(x)|^2\\,dx > 0$. Hence $K$ is positive definite.\n\nWe now compute the smallest eigenvalue of $K$. Let\n\n$$\nT \\;=\\; \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}.\n$$\n\nBecause $K = \\frac{1}{h}\\,T$ with $h=\\frac{1}{4}$, the eigenvalues of $K$ are $\\frac{1}{h}$ times the eigenvalues of $T$. It suffices to find the eigenvalues of $T$. Consider vectors $w^{(m)} \\in \\mathbb{R}^3$ with components $w^{(m)}_j = \\sin\\!\\left(j\\,\\theta_m\\right)$ for $j \\in \\{1,2,3\\}$, where $\\theta_m = \\frac{m\\pi}{n+1}$, $n=3$, and $m \\in \\{1,2,3\\}$. For $1 \\leq j \\leq 3$ we compute\n\n$$\n(T w^{(m)})_j \\;=\\; 2 \\sin(j\\theta_m) - \\sin((j-1)\\theta_m) - \\sin((j+1)\\theta_m).\n$$\n\nUsing the trigonometric identity $\\sin((j+1)\\theta) + \\sin((j-1)\\theta) = 2\\sin(j\\theta)\\cos(\\theta)$, we obtain\n\n$$\n(T w^{(m)})_j \\;=\\; 2 \\sin(j\\theta_m) - 2\\sin(j\\theta_m)\\cos(\\theta_m) \\;=\\; 2\\bigl(1-\\cos(\\theta_m)\\bigr)\\,\\sin(j\\theta_m).\n$$\n\nThus $w^{(m)}$ is an eigenvector of $T$ with eigenvalue\n\n$$\n\\mu_m \\;=\\; 2\\bigl(1-\\cos(\\theta_m)\\bigr) \\;=\\; 2 - 2\\cos\\!\\left(\\frac{m\\pi}{4}\\right), \\quad m \\in \\{1,2,3\\}.\n$$\n\nTherefore, the eigenvalues of $K$ are\n\n$$\n\\lambda_m \\;=\\; \\frac{1}{h}\\,\\mu_m \\;=\\; 4\\,\\mu_m \\;=\\; 4\\left(2 - 2\\cos\\!\\left(\\frac{m\\pi}{4}\\right)\\right), \\quad m \\in \\{1,2,3\\}.\n$$\n\nThe smallest eigenvalue corresponds to $m=1$ (since $\\cos(\\cdot)$ is decreasing on $(0,\\pi)$), giving\n\n$$\n\\lambda_{\\min}(K) \\;=\\; 4\\left(2 - 2\\cos\\!\\left(\\frac{\\pi}{4}\\right)\\right) \\;=\\; 8 - 8\\cdot\\frac{\\sqrt{2}}{2} \\;=\\; 8 - 4\\sqrt{2}.\n$$\n\nThis is a closed-form exact expression.", "answer": "$$\\boxed{8-4\\sqrt{2}}$$", "id": "2600099"}, {"introduction": "This next exercise builds upon the fundamental case by introducing piecewise-constant material properties and a non-uniform mesh, which are common in real-world engineering analysis. You will derive the stiffness matrix by assembling contributions from individual elements, each with its own distinct characteristics [@problem_id:2600101]. This practice highlights the modularity of the finite element method and deepens your understanding of how the global stiffness matrix quantitatively represents the spatial distribution of physical properties across the domain.", "problem": "Consider the scalar diffusion problem on the interval $[0,L]$ with homogeneous Dirichlet boundary conditions:\n$$\n- \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right) \\;=\\; f(x) \\quad \\text{on } (0,L), \n\\qquad u(0)=0,\\quad u(L)=0,\n$$\nwhere $a(x)>0$ is piecewise constant. Let a conforming finite element discretization be defined by the mesh nodes $x_0=0<x_1<x_2<x_3<x_4=L$, so there are $4$ elements $e_i=[x_{i-1},x_i]$ of lengths $h_i = x_i - x_{i-1} > 0$ for $i=1,2,3,4$. On each element $e_i$, the diffusion coefficient is a positive constant $a_i>0$. Use continuous, piecewise-linear shape functions over this mesh and the standard Galerkin formulation built from the weak form \n$$\n\\int_0^L a(x)\\,u'(x)\\,v'(x)\\,dx \\;=\\; \\int_0^L f(x)\\,v(x)\\,dx \\quad \\text{for all admissible } v.\n$$\n\nTasks:\n- Starting from the weak form, derive the $2\\times 2$ element stiffness matrix for an arbitrary element $e_i$, explicitly in terms of $a_i$ and $h_i$.\n- Assemble the global stiffness matrix for the ordering of global nodes $\\{0,1,2,3,4\\}$, and then impose the Dirichlet boundary conditions by eliminating rows and columns associated with nodes $0$ and $4$, obtaining the reduced stiffness matrix $K_{\\text{red}}\\in\\mathbb{R}^{3\\times 3}$ associated with interior nodes $\\{1,2,3\\}$.\n- From first principles, explain how the assembly and the local supports of basis functions imply the sparsity pattern and symmetry of $K_{\\text{red}}$, and why $K_{\\text{red}}$ is Symmetric Positive Definite (SPD) when $a_i>0$ for all $i$.\n- Let $k_i := \\dfrac{a_i}{h_i}$ for $i=1,2,3,4$. Compute the exact closed-form expression for the determinant $\\det(K_{\\text{red}})$ in terms of $k_1,k_2,k_3,k_4$.\n\nProvide as your final answer only the exact analytic expression for $\\det(K_{\\text{red}})$ (no numerical evaluation or rounding is required).", "solution": "The element stiffness matrix $K^{(e_i)}$ for an element $e_i = [x_{i-1}, x_i]$ is derived from the bilinear form. For the two local linear basis functions $N_1$ and $N_2$ on the element, the derivatives are constant: $\\frac{dN_1}{dx} = -\\frac{1}{h_i}$ and $\\frac{dN_2}{dx} = \\frac{1}{h_i}$. The entries of the $2\\times2$ matrix are computed by integrating over the element length $h_i$, with constant coefficient $a_i$:\n$K_{11}^{(e_i)} = \\int_{x_{i-1}}^{x_i} a_i (-\\frac{1}{h_i})(-\\frac{1}{h_i}) dx = \\frac{a_i}{h_i}$. Similarly, $K_{12}^{(e_i)} = K_{21}^{(e_i)} = -\\frac{a_i}{h_i}$ and $K_{22}^{(e_i)} = \\frac{a_i}{h_i}$. Using the definition $k_i = \\frac{a_i}{h_i}$, the element stiffness matrix is:\n$$\nK^{(e_i)} = \\frac{a_i}{h_i} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = k_i \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe global $5\\times 5$ stiffness matrix is assembled by summing the contributions from the four element matrices. The matrix for element $e_i$ contributes to the rows and columns associated with global nodes $i-1$ and $i$.\n$$\nK = \\begin{pmatrix}\nk_1 & -k_1 & 0 & 0 & 0 \\\\\n-k_1 & k_1+k_2 & -k_2 & 0 & 0 \\\\\n0 & -k_2 & k_2+k_3 & -k_3 & 0 \\\\\n0 & 0 & -k_3 & k_3+k_4 & -k_4 \\\\\n0 & 0 & 0 & -k_4 & k_4\n\\end{pmatrix}\n$$\nImposing homogeneous Dirichlet boundary conditions $u(0)=u(L)=0$ corresponds to eliminating the rows and columns for nodes $0$ and $4$. This yields the $3\\times 3$ reduced stiffness matrix $K_{\\text{red}}$ for the interior nodes $\\{1,2,3\\}$:\n$$\nK_{\\text{red}} = \\begin{pmatrix}\nk_1+k_2 & -k_2 & 0 \\\\\n-k_2 & k_2+k_3 & -k_3 \\\\\n0 & -k_3 & k_3+k_4\n\\end{pmatrix}\n$$\nThe properties of $K_{\\text{red}}$ are justified as follows:\n- **Symmetry:** The underlying bilinear form $B(v, w) = \\int_0^L a(x) v' w' dx$ is symmetric, so the global matrix $K$ is symmetric. As a principal submatrix of $K$, $K_{\\text{red}}$ is also symmetric.\n- **Sparsity:** The entry $(K)_{ij}$ is non-zero only if the supports of basis functions $\\phi_i$ and $\\phi_j$ overlap. For linear \"hat\" functions, this occurs only for $|i-j| \\le 1$, resulting in a tridiagonal (sparse) matrix.\n- **Positive Definiteness:** For any non-zero vector of interior nodal values $U_{\\text{red}}$, the quadratic form $U_{\\text{red}}^T K_{\\text{red}} U_{\\text{red}}$ is equal to $\\int_0^L a(x) [v_h'(x)]^2 dx$, where $v_h$ is the corresponding finite element function. Since $a(x)>0$ and $v_h$ is not the zero function (due to the boundary conditions), this integral is strictly positive. Thus, $K_{\\text{red}}$ is symmetric positive definite (SPD).\n\nTo compute the determinant of $K_{\\text{red}}$, we use cofactor expansion along the first row:\n$$\n\\det(K_{\\text{red}}) = (k_1+k_2) \\begin{vmatrix} k_2+k_3 & -k_3 \\\\ -k_3 & k_3+k_4 \\end{vmatrix} - (-k_2) \\begin{vmatrix} -k_2 & -k_3 \\\\ 0 & k_3+k_4 \\end{vmatrix}\n$$\n$$\n= (k_1+k_2)((k_2+k_3)(k_3+k_4) - k_3^2) + k_2(-k_2(k_3+k_4))\n$$\n$$\n= (k_1+k_2)(k_2k_3+k_2k_4+k_3k_4) - k_2^2(k_3+k_4)\n$$\n$$\n= (k_1k_2k_3+k_1k_2k_4+k_1k_3k_4) + (k_2^2k_3+k_2^2k_4+k_2k_3k_4) - (k_2^2k_3+k_2^2k_4)\n$$\nAfter cancellation, the expression simplifies to:\n$$\n\\det(K_{\\text{red}}) = k_1k_2k_3 + k_1k_2k_4 + k_1k_3k_4 + k_2k_3k_4\n$$", "answer": "$$ \\boxed{k_1k_2k_3 + k_1k_2k_4 + k_1k_3k_4 + k_2k_3k_4} $$", "id": "2600101"}, {"introduction": "Our final practice is a conceptual exploration into the physical meaning of a singular stiffness matrix, which is not positive definite. By analyzing a 2D elasticity problem with no displacement constraints, you will investigate the structure of the matrix's nullspace [@problem_id:2600103]. This exercise reveals the profound connection between the mathematical concept of a nullspace and the physical phenomenon of rigid body motions, providing critical insight into why sufficient boundary conditions are necessary to ensure a unique, stable solution in structural analysis.", "problem": "Consider the two-dimensional linearized elasticity model on a polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with Lamé parameters $\\lambda>0$ and $\\mu>0$. Let the total domain be the union $\\Omega=\\Omega_{1}\\cup \\Omega_{2}$ of two polygonal subdomains $\\Omega_{1}$ and $\\Omega_{2}$ whose interiors are disjoint. Assume there is a conforming simplicial triangulation $\\mathcal{T}_{h}$ of $\\Omega$ such that $\\Omega_{1}$ and $\\Omega_{2}$ are each unions of elements of $\\mathcal{T}_{h}$ and share exactly one vertex $x_{0}$ in common, with no common edge of positive length. Consider the conforming vector finite element space $V_{h}\\subset H^{1}(\\Omega;\\mathbb{R}^{2})$ of continuous, piecewise affine vector fields with respect to $\\mathcal{T}_{h}$.\n\nThe bilinear form associated with the elastic energy is\n$$\na(u,v)\\;=\\;\\int_{\\Omega}\\Big(2\\mu\\,\\varepsilon(u):\\varepsilon(v)\\;+\\;\\lambda\\,\\operatorname{div}u\\,\\operatorname{div}v\\Big)\\,\\mathrm{d}x,\n$$\nwhere $\\varepsilon(u)=\\tfrac{1}{2}\\left(\\nabla u+(\\nabla u)^{\\top}\\right)$ is the symmetric gradient. Assemble the global stiffness matrix $K$ by $K_{ij}=a(\\varphi_{j},\\varphi_{i})$ using the standard nodal basis $\\{\\varphi_{i}\\}$ of $V_{h}$, under traction-free (homogeneous Neumann) boundary conditions on all of $\\partial\\Omega$ and with no Dirichlet constraints.\n\nStarting only from foundational facts about the linearized elastic energy and the definition of the symmetric gradient, reason from first principles to characterize the discrete nullspace of $K$ in terms of discrete rigid body motions on $\\Omega_{1}$ and $\\Omega_{2}$ and the imposed inter-subdomain continuity at the single shared vertex $x_{0}$. Determine the dimension of the nullspace of $K$ as a single real number. Your answer must be a single integer with no units. No rounding is required.", "solution": "The nullspace of the stiffness matrix $K$ consists of all discrete vector fields $u_h \\in V_h$ for which the associated elastic energy is zero. This energy is given by the quadratic form $a(u_h, u_h)$:\n$$\na(u_{h}, u_{h}) = \\int_{\\Omega} \\Big( 2\\mu\\,\\varepsilon(u_{h}):\\varepsilon(u_{h}) + \\lambda\\,(\\operatorname{div}u_{h})^2 \\Big)\\,\\mathrm{d}x\n$$\nSince the Lamé parameters $\\mu$ and $\\lambda$ are positive, the integrand is non-negative. For the integral to be zero, the integrand must vanish almost everywhere. This implies that the strain tensor $\\varepsilon(u_h)$ must be zero almost everywhere in $\\Omega$.\n\nA vector field whose strain tensor is zero on a connected domain is a rigid body motion (RBM). In two dimensions, the space of RBMs is 3-dimensional, spanned by two translations and one infinitesimal rotation. A general 2D RBM has the form $u(x) = c + A x$, where $c \\in \\mathbb{R}^2$ is a translation vector and $A$ is a skew-symmetric matrix representing rotation.\n\nThe domain $\\Omega$ consists of two subdomains, $\\Omega_1$ and $\\Omega_2$, connected only at a single vertex $x_0$. Because $u_h$ is continuous and piecewise affine with $\\varepsilon(u_h)=0$ on each element, its restriction to each subdomain must be a single RBM.\n- The restriction of $u_h$ to $\\Omega_1$, denoted $u_1$, must be an RBM on $\\Omega_1$. This motion is defined by 3 parameters.\n- The restriction of $u_h$ to $\\Omega_2$, denoted $u_2$, must be an RBM on $\\Omega_2$. This motion is also defined by 3 parameters.\n\nIf the subdomains were disconnected, the total number of parameters would be $3 + 3 = 6$. However, $u_h$ must be a continuous function over the entire domain $\\Omega$, which imposes a constraint at the shared vertex $x_0$:\n$$\nu_1(x_0) = u_2(x_0)\n$$\nTo analyze this, we can express each RBM relative to the shared point $x_0$. For $x \\in \\Omega_1$, let $u_1(x) = c_1 + A_1 (x - x_0)$, where $c_1$ represents the translation of the point $x_0$ and $A_1$ is the rotation matrix for $\\Omega_1$. Similarly, for $x \\in \\Omega_2$, let $u_2(x) = c_2 + A_2 (x - x_0)$.\n\nEvaluating the continuity constraint at $x = x_0$ gives:\n$u_1(x_0) = c_1$\n$u_2(x_0) = c_2$\nThus, the constraint simplifies to $c_1 = c_2$. This is a vector equation in $\\mathbb{R}^2$, which imposes two independent scalar linear constraints on the $6$ available parameters.\n\nThe dimension of the nullspace of $K$ is the number of degrees of freedom in the system of piecewise RBMs, which is the initial number of parameters minus the number of independent constraints.\n$$\n\\operatorname{dim}(\\operatorname{ker}(K)) = (\\text{params for } u_1) + (\\text{params for } u_2) - (\\text{constraints})\n$$\n$$\n\\operatorname{dim}(\\operatorname{ker}(K)) = 3 + 3 - 2 = 4\n$$\nThe 4 modes comprising the nullspace are:\n1.  Global translation in the x-direction.\n2.  Global translation in the y-direction.\n3.  Rotation of $\\Omega_1$ about $x_0$ (with $\\Omega_2$ fixed).\n4.  Rotation of $\\Omega_2$ about $x_0$ (with $\\Omega_1$ fixed).\nThese four modes are linearly independent and span the nullspace. The dimension is therefore 4.", "answer": "$$\n\\boxed{4}\n$$", "id": "2600103"}]}