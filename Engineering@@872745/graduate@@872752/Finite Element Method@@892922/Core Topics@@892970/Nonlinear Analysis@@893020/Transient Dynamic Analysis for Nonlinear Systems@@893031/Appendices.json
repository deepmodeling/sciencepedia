{"hands_on_practices": [{"introduction": "The cornerstone of any explicit transient dynamic analysis is the concept of conditional stability. Unlike implicit methods, explicit time integration schemes are only stable if the time step, $\\Delta t$, is smaller than a critical value. This exercise guides you through a first-principles derivation of this stability limit for a simple one-dimensional system [@problem_id:2607423]. By connecting the spatial discretization (element size $h$) and material properties (wave speed $c$) to the temporal discretization ($\\Delta t$), you will derive the celebrated Courant-Friedrichs-Lewy (CFL) condition, which physically means that information cannot be allowed to propagate across more than one element in a single time step.", "problem": "A uniform, slender, one-dimensional elastic bar of constant cross-section is undergoing transient motion governed by Newton’s second law. The material response is nonlinear, but at a given time instant consider a linearization about the current configuration so that the bar has an instantaneous tangent modulus $E_{t}$ and constant mass density $\\rho$. Define the instantaneous elastic wave speed as $c = \\sqrt{E_{t}/\\rho}$. The bar is discretized by the finite element method (FEM) using a uniform mesh of linear, two-node elements of length $h$, and a diagonal (lumped) mass matrix is employed. Assume a sufficiently large periodic mesh so that boundary effects can be neglected and the highest-frequency mode is governed by the mesh-level dispersion relation.\n\nYou will use the explicit central difference method (CDM) to advance the semi-discrete equations in time. Starting from first principles, and without invoking any pre-tabulated stability limits, proceed as follows:\n- Write the semi-discrete equations of motion for the uniform mesh and reduce them to a nearest-neighbor lattice equation for interior nodes.\n- Postulate a harmonic wave solution on the discrete lattice to obtain the mesh dispersion relation and identify the maximum discrete angular frequency $\\omega_{\\max}$ in terms of $c$ and $h$.\n- Apply a linear stability analysis of the central difference time integrator for the scalar oscillator $\\ddot{y} + \\omega^{2} y = 0$ and deduce the critical time step $\\Delta t_{\\text{crit}}$ in terms of $\\omega_{\\max}$.\n\nFinally, combine the above results to obtain a closed-form expression for the central-difference critical time step $\\Delta t_{\\text{crit}}$ as a function of the wave speed $c$ and the element size $h$ for this mesh. Provide your answer as a symbolic expression in terms of $c$ and $h$. Do not include units and do not perform any numerical rounding.", "solution": "The problem requires the derivation of the critical time step for the explicit central difference method applied to a one-dimensional elastic bar discretized with linear finite elements. The derivation will proceed in three stages as specified: first, deriving the semi-discrete equations of motion; second, performing a dispersion analysis to find the maximum natural frequency of the discrete system; and third, performing a stability analysis of the time integrator to relate the critical time step to this maximum frequency.\n\nFirst, we establish the semi-discrete equation of motion for an interior node of a uniform finite element mesh. For a one-dimensional, two-node bar element of length $h$, constant cross-section $A$, tangent modulus $E_t$, and mass density $\\rho$, the element stiffness matrix $\\mathbf{K}^e$ is given by:\n$$\n\\mathbf{K}^e = \\frac{A E_t}{h}\n\\begin{pmatrix}\n1  -1 \\\\\n-1  1\n\\end{pmatrix}\n$$\nThe problem specifies a diagonal (lumped) mass matrix. The total mass of the element is $m^e = \\rho A h$. This mass is distributed equally to the two nodes, resulting in the element mass matrix $\\mathbf{M}^e$:\n$$\n\\mathbf{M}^e = \\frac{\\rho A h}{2}\n\\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix}\n$$\nWe consider an infinite, uniform mesh and focus on an arbitrary interior node $j$. This node is connected to its neighbors, node $j-1$ and node $j+1$, through two adjacent elements, element $(j-1, j)$ and element $(j, j+1)$. The global equation of motion for the system is $\\mathbf{M}\\ddot{\\mathbf{u}} + \\mathbf{K}\\mathbf{u} = \\mathbf{F}_{ext}$. For free vibration, $\\mathbf{F}_{ext} = \\mathbf{0}$. The equation for the degree of freedom $u_j$ at node $j$ is assembled from the contributions of the two adjacent elements.\n\nThe mass associated with node $j$ is the sum of contributions from each element:\n$$\nM_{jj} = \\left(\\mathbf{M}^e\\right)_{22} + \\left(\\mathbf{M}^e\\right)_{11} = \\frac{\\rho A h}{2} + \\frac{\\rho A h}{2} = \\rho A h\n$$\nThe internal force on node $j$ is the sum of forces from the stiffness of the two elements. The force on node $j$ from element $(j-1, j)$ is $\\frac{A E_t}{h}(-u_{j-1} + u_j)$. The force on node $j$ from element $(j, j+1)$ is $\\frac{A E_t}{h}(u_j - u_{j+1})$. The total internal force is the sum:\n$$\n(K_{j, j-1} u_{j-1} + K_{jj} u_j + K_{j, j+1} u_{j+1}) = \\frac{A E_t}{h}(-u_{j-1} + u_j) + \\frac{A E_t}{h}(u_j - u_{j+1}) = \\frac{A E_t}{h}(-u_{j-1} + 2u_j - u_{j+1})\n$$\nThus, the equation of motion for node $j$ is:\n$$\n(\\rho A h) \\ddot{u}_j + \\frac{A E_t}{h} (2u_j - u_{j-1} - u_{j+1}) = 0\n$$\nDividing by $\\rho A h$ and substituting the definition of the wave speed $c = \\sqrt{E_t/\\rho}$, which implies $c^2 = E_t/\\rho$, we obtain the nearest-neighbor lattice equation:\n$$\n\\ddot{u}_j + \\frac{c^2}{h^2} (2u_j - u_{j-1} - u_{j+1}) = 0\n$$\n\nSecond, we perform a dispersion analysis on this lattice equation to find the maximum frequency. We postulate a harmonic wave solution of the form $u_j(t) = U \\exp[i(kx_j - \\omega t)]$, where $x_j = jh$ is the coordinate of node $j$, $k$ is the wave number, and $\\omega$ is the angular frequency. The required terms are:\n$$\n\\ddot{u}_j(t) = -\\omega^2 u_j(t)\n$$\n$$\nu_{j-1}(t) = U \\exp[i(k(j-1)h - \\omega t)] = u_j(t) \\exp(-ikh)\n$$\n$$\nu_{j+1}(t) = U \\exp[i(k(j+1)h - \\omega t)] = u_j(t) \\exp(ikh)\n$$\nSubstituting these into the lattice equation yields:\n$$\n-\\omega^2 u_j + \\frac{c^2}{h^2} (2u_j - u_j \\exp(-ikh) - u_j \\exp(ikh)) = 0\n$$\nDividing by $u_j$ (which is non-zero for a non-trivial solution) and rearranging:\n$$\n\\omega^2 = \\frac{c^2}{h^2} (2 - (\\exp(ikh) + \\exp(-ikh)))\n$$\nUsing the Euler identity $\\cos(z) = \\frac{1}{2}(\\exp(iz) + \\exp(-iz))$, this becomes:\n$$\n\\omega^2 = \\frac{2c^2}{h^2} (1 - \\cos(kh))\n$$\nApplying the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we obtain the dispersion relation for the discrete system:\n$$\n\\omega^2 = \\frac{2c^2}{h^2} \\left(2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) = \\frac{4c^2}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\n$$\nThe maximum frequency of the mesh, $\\omega_{\\max}$, corresponds to the mode that maximizes this expression. The sine function has a maximum absolute value of $1$. This occurs when its argument is an odd multiple of $\\pi/2$. The highest frequency mode corresponds to the shortest wavelength the mesh can represent, which is $\\lambda_{\\min} = 2h$. The wave number for this mode is $k_{\\max} = 2\\pi/\\lambda_{\\min} = \\pi/h$. Substituting this into the dispersion relation:\n$$\n\\omega_{\\max} = \\sqrt{\\frac{4c^2}{h^2} \\sin^2\\left(\\frac{(\\pi/h)h}{2}\\right)} = \\frac{2c}{h} \\left|\\sin\\left(\\frac{\\pi}{2}\\right)\\right| = \\frac{2c}{h}\n$$\n\nThird, we analyze the stability of the central difference method for the scalar harmonic oscillator equation $\\ddot{y} + \\omega^2 y = 0$. The central difference approximation for the second derivative is $\\ddot{y}_n \\approx (y_{n+1} - 2y_n + y_{n-1})/(\\Delta t)^2$. Substituting this into the model equation gives the recurrence relation:\n$$\n\\frac{y_{n+1} - 2y_n + y_{n-1}}{(\\Delta t)^2} + \\omega^2 y_n = 0\n$$\n$$\ny_{n+1} = (2 - (\\omega \\Delta t)^2) y_n - y_{n-1}\n$$\nTo analyze stability, we assume a solution of the form $y_n = G^n$, where $G$ is an amplification factor. Substituting this into the recurrence relation gives the characteristic equation for $G$:\n$$\nG^{n+1} = (2 - (\\omega \\Delta t)^2) G^n - G^{n-1}\n$$\n$$\nG^2 - (2 - (\\omega \\Delta t)^2) G + 1 = 0\n$$\nFor the numerical solution to remain bounded (stable), the magnitudes of the roots $G$ of this quadratic equation must not exceed $1$, i.e., $|G| \\le 1$. The roots are:\n$$\nG = \\frac{(2 - (\\omega \\Delta t)^2) \\pm \\sqrt{(2 - (\\omega \\Delta t)^2)^2 - 4}}{2}\n$$\nThe solution becomes unstable if any root has a magnitude greater than $1$. This occurs when the roots are real and unequal, which happens when the discriminant is positive. A positive discriminant requires $(2 - (\\omega \\Delta t)^2)^2  4$, or $|2 - (\\omega \\Delta t)^2|  2$. This inequality holds if $2 - (\\omega \\Delta t)^2  2$ (which is impossible as $-(\\omega \\Delta t)^2 \\le 0$) or if $2 - (\\omega \\Delta t)^2  -2$. The latter condition gives $(\\omega \\Delta t)^2  4$, or $|\\omega \\Delta t|  2$.\nTherefore, for stability, we must have $|\\omega \\Delta t| \\le 2$. The integration scheme must be stable for all frequencies present in the semi-discrete system. This requires the condition to hold for the maximum frequency, $\\omega_{\\max}$:\n$$\n\\omega_{\\max} \\Delta t \\le 2\n$$\nThe critical time step, $\\Delta t_{\\text{crit}}$, is the largest value of $\\Delta t$ for which this condition is met:\n$$\n\\Delta t_{\\text{crit}} = \\frac{2}{\\omega_{\\max}}\n$$\n\nFinally, we combine the results. Substituting the expression for $\\omega_{\\max} = 2c/h$ into the equation for $\\Delta t_{\\text{crit}}$:\n$$\n\\Delta t_{\\text{crit}} = \\frac{2}{2c/h} = \\frac{h}{c}\n$$\nThis represents the Courant-Friedrichs-Lewy (CFL) condition for this particular numerical scheme, stating that the time step must be no larger than the time it takes for a wave to travel across one element.", "answer": "$$\n\\boxed{\\frac{h}{c}}\n$$", "id": "2607423"}, {"introduction": "In large-scale nonlinear simulations, computational efficiency is paramount. This often motivates the use of under-integrated finite elements, which are computationally cheaper but can suffer from unphysical, zero-energy \"hourglass\" modes. This practice problem explores the critical task of suppressing these spurious modes without corrupting the physical behavior of the simulation [@problem_id:2607407]. You will analyze and contrast different stabilization strategies, learning how to design a viscous hourglass control that effectively damps non-physical oscillations while preserving the accuracy of long-wavelength physical waves and maintaining a favorable stable time step.", "problem": "A compressible hyperelastic solid of density $\\rho$ and tangent elasticity tensor $\\mathbb{C}(\\boldsymbol{\\varepsilon})$ is discretized by under-integrated, trilinear hexahedral elements and advanced in time using an explicit central difference scheme. The semidiscrete equation of motion is $\\,\\mathbf{M}\\,\\ddot{\\mathbf{u}}+\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u})=\\mathbf{f}_{\\mathrm{ext}}$, where $\\mathbf{M}$ is a diagonal (lumped) mass matrix, $\\mathbf{u}$ the nodal displacement vector, $\\mathbf{f}_{\\mathrm{int}}$ the internal force vector obtained from the Principle of Virtual Work, and $\\mathbf{f}_{\\mathrm{ext}}$ the external force vector. With reduced integration, the element admits zero-energy (hourglass) deformation modes that produce no strain energy and thus no restoring force in $\\mathbf{f}_{\\mathrm{int}}$. To suppress the growth of these modes under transient loading, an hourglass control is added in one of two forms: a stiffness-like stabilization or a viscosity-like stabilization applied in the hourglass subspace.\n\nStarting from conservation of linear momentum and the structure of the explicit central difference scheme, analyze how hourglass control influences stability and phase accuracy, and outline a principled calibration procedure for a viscosity-like hourglass control that suppresses spurious hourglass oscillations without corrupting the physical wave speeds of long-wavelength disturbances. In your reasoning, base any wave speed you use on the current tangent moduli, e.g., the shear wave speed $c_{s}=\\sqrt{G_{\\mathrm{tan}}/\\rho}$, where $G_{\\mathrm{tan}}$ is the current tangent shear modulus.\n\nWhich of the following statements are correct? Select all that apply.\n\nA. Adding a stiffness-like hourglass control raises the highest discrete frequency in the spectrum of the linearized system and therefore tightens the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$; by contrast, a viscosity-like hourglass control that is projected onto the hourglass subspace and calibrated to target a damping ratio at a high wavenumber (e.g., near the Nyquist limit) can suppress spurious modes while preserving long-wavelength phase velocity. A practical calibration is to set $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ with $\\omega_{h}\\approx \\pi c_{s}/h$ and $m_{h}$ an estimate of the modal mass associated with a single hourglass mode, where $h$ is a characteristic element size and $\\zeta_{h}$ is a chosen target damping ratio.\n\nB. To avoid affecting shear waves, the hourglass viscosity should be scaled with the bulk modulus $K$ so that $\\eta_{h}\\propto K$; this ensures that only volumetric hourglass patterns are damped and that the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$ increases because the stabilizing forces act against unphysical deformations.\n\nC. Global Rayleigh damping calibrated to critically damp the element’s highest mode is an appropriate substitute for hourglass viscosity: it suppresses hourglass instabilities while leaving the explicit stability limit unchanged and does not alter the phase velocity of physical waves.\n\nD. A wave-speed-preserving viscosity calibration can be constructed by (i) defining an hourglass operator $\\mathbf{H}$ such that $\\mathbf{H}\\,\\mathbf{u}= \\mathbf{0}$ for rigid-body motions and any displacement field that induces constant strain over the element, (ii) adding a viscous hourglass force $\\mathbf{f}_{h}^{v}=\\eta_{h}\\,\\mathbf{H}\\,\\dot{\\mathbf{u}}$, and (iii) choosing $\\eta_{h}$ to realize a target modal damping ratio $\\zeta_{h}$ at a representative hourglass frequency $\\omega_{h}\\approx \\pi c_{t}/h$, where $c_{t}$ is a current tangent wave speed (e.g., $c_{s}$). Estimating the modal mass as $m_{h}\\approx \\alpha\\,m_{e}$ for some $\\alpha$ of order unity (with $m_{e}=\\rho V_{e}$ the element mass and $V_{e}$ its volume) and setting $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ yields damping concentrated on high-wavenumber hourglass content. Because $\\mathbf{H}$ annihilates linear fields, this procedure does not change the dispersion or phase velocity for wavelengths $\\lambda\\gg h$.\n\nE. Increasing the stiffness-like hourglass parameter always increases the maximum stable explicit time step because the added stiffness suppresses unphysical modes, thereby improving numerical stability without affecting the highest physical frequencies.\n\nOnly consider scientifically defensible arguments and scalings derived from the governing equations and standard properties of the explicit central difference method; do not assume any proprietary formulation details.", "solution": "The semidiscrete equation of motion for the finite element system is given as:\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) = \\mathbf{f}_{\\mathrm{ext}} $$\nwhere $\\mathbf{M}$ is the diagonal lumped mass matrix, $\\mathbf{u}$ is the vector of nodal displacements, $\\mathbf{f}_{\\mathrm{int}}$ is the vector of internal forces, and $\\mathbf{f}_{\\mathrm{ext}}$ is the vector of external forces. Using under-integrated elements, certain deformation modes—the hourglass modes—produce zero strain at the integration points. Consequently, they contribute nothing to the strain energy and thus nothing to the internal force vector, $\\mathbf{f}_{\\mathrm{int}}$. These modes are unresisted and can grow spuriously in a dynamic simulation. To counteract this, a stabilization force, $\\mathbf{f}_{h}$, is added to the system:\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) + \\mathbf{f}_{h} = \\mathbf{f}_{\\mathrm{ext}} $$\nThe explicit central difference scheme updates displacements based on accelerations at time step $n$:\n$$ \\mathbf{u}^{n+1} = \\mathbf{u}^{n} + \\Delta t \\, \\dot{\\mathbf{u}}^{n+1/2} $$\n$$ \\dot{\\mathbf{u}}^{n+1/2} = \\dot{\\mathbf{u}}^{n-1/2} + \\Delta t \\, \\ddot{\\mathbf{u}}^{n} $$\nwhere $\\ddot{\\mathbf{u}}^{n} = \\mathbf{M}^{-1}(\\mathbf{f}_{\\mathrm{ext}}^{n} - \\mathbf{f}_{\\mathrm{int}}^{n} - \\mathbf{f}_{h}^{n})$. The stability of this scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition, which limits the time step size $\\Delta t$ based on the highest natural frequency of the discretized system, $\\omega_{\\max}$. The critical time step is $\\Delta t_{\\mathrm{crit}} \\le 2/\\omega_{\\max}$. The highest frequency $\\omega_{\\max}$ is determined by the minimum time it takes for a wave to travel across an element, i.e., $\\omega_{\\max} \\approx c_{\\max}/h_{\\min}$, where $c_{\\max}$ is the fastest wave speed in the material and $h_{\\min}$ is a characteristic dimension of the smallest element. For a linearized system with tangent stiffness $\\mathbf{K}_{\\mathrm{tan}}$, $\\omega_{\\max}$ is the square root of the largest eigenvalue of the generalized eigenproblem $\\mathbf{K}_{\\mathrm{tan}}\\mathbf{v} = \\omega^2 \\mathbf{M}\\mathbf{v}$.\n\nLet us analyze the two types of hourglass control.\n\n1.  **Stiffness-like control**: Here, $\\mathbf{f}_{h} = \\mathbf{K}_{h}\\mathbf{u}$, where $\\mathbf{K}_{h}$ is an artificial stiffness matrix that acts only on the hourglass modes. The linearized equation of motion becomes $\\mathbf{M}\\,\\ddot{\\mathbf{u}} + (\\mathbf{K}_{\\mathrm{tan}} + \\mathbf{K}_{h})\\mathbf{u} = \\mathbf{f}_{\\mathrm{ext}}$. The total system stiffness is increased. Since $\\mathbf{K}_{h}$ is a positive semi-definite matrix, adding it to $\\mathbf{K}_{\\mathrm{tan}}$ will increase (or leave unchanged) the eigenvalues of $\\mathbf{M}^{-1}\\mathbf{K}_{\\mathrm{Total}}$. This leads to a higher maximum frequency, $\\omega'_{\\max} \\ge \\omega_{\\max}$. Consequently, the critical time step is reduced: $\\Delta t'_{\\mathrm{crit}} \\le 2/\\omega'_{\\max} \\le \\Delta t_{\\mathrm{crit}}$.\n\n2.  **Viscosity-like control**: Here, $\\mathbf{f}_{h} = \\mathbf{C}_{h}\\dot{\\mathbf{u}}$, where $\\mathbf{C}_{h}$ is an artificial viscous damping matrix projected onto the hourglass subspace. The goal is to add damping specifically to the unphysical, high-frequency hourglass modes without affecting the physical, long-wavelength modes. A properly formulated viscous control projects the velocity field onto the hourglass modal basis and applies a force proportional to the rate of hourglassing. For a long-wavelength disturbance, the displacement field across a single element is nearly linear. An hourglass operator, by definition, is orthogonal to rigid-body motions and constant strain fields (which arise from linear displacement fields). Therefore, such an operator will produce nearly zero force for long-wavelength modes, preserving their phase velocity and physical behavior.\n    For an unforced single hourglass mode, the equation is $m_{h}\\ddot{u}_{h} + c_{h}\\dot{u}_{h} = 0$, where $m_{h}$ is the modal mass, $u_{h}$ is the modal displacement, and $c_{h}$ is the modal viscosity. The characteristic equation is $m_{h}s^2 + c_{h}s = 0$. The solution is damped. To achieve a specified damping ratio $\\zeta_{h}$ at a certain frequency $\\omega_{h}$, we use the standard formula for a second-order system: $c_{h} = 2\\zeta_{h}m_{h}\\omega_{h}$. The frequency $\\omega_{h}$ is chosen to be representative of the hourglass phenomenon, which is a high-wavenumber mode. A wavelength of $\\lambda=2h$ (where $h$ is the element size) is appropriate, corresponding to the Nyquist frequency. The frequency is then $\\omega_{h} = 2\\pi c / \\lambda = \\pi c/h$, where $c$ is a relevant wave speed, such as the tangent shear wave speed $c_{s}$. The modal mass $m_{h}$ is some fraction of the total element mass. This provides a principled calibration procedure. Adding such viscosity has a small effect on the stability limit, which for a damped system is $\\Delta t \\le \\frac{2}{\\omega_{\\max}} (\\sqrt{1+\\xi_{\\max}^2} - \\xi_{\\max})$. Since the viscosity is targeted and usually small ($\\zeta_h \\ll 1$), this reduction is minimal compared to the significant reduction from stiffness-based control.\n\nNow, we evaluate each statement.\n\n**A. Adding a stiffness-like hourglass control raises the highest discrete frequency in the spectrum of the linearized system and therefore tightens the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$; by contrast, a viscosity-like hourglass control that is projected onto the hourglass subspace and calibrated to target a damping ratio at a high wavenumber (e.g., near the Nyquist limit) can suppress spurious modes while preserving long-wavelength phase velocity. A practical calibration is to set $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ with $\\omega_{h}\\approx \\pi c_{s}/h$ and $m_{h}$ an estimate of the modal mass associated with a single hourglass mode, where $h$ is a characteristic element size and $\\zeta_{h}$ is a chosen target damping ratio.**\n- The first clause correctly states that stiffness control increases $\\omega_{\\max}$ and thus reduces (tightens) $\\Delta t_{\\mathrm{crit}}$. This is correct as derived above.\n- The second clause correctly describes the advantage of projected viscous damping: it targets spurious modes while preserving the physics of long-wavelength modes. This is the main motivation for using such schemes.\n- The third clause presents the standard calibration procedure for achieving a target modal damping ratio $\\zeta_{h}$. The formula $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ (using $\\eta_h$ for the modal viscous coefficient) is correct. The estimate for the hourglass frequency $\\omega_{h}\\approx \\pi c_{s}/h$ is physically sound, representing a mode with wavelength on the order of the element size.\nThe statement is a correct and concise summary of the state of the art in hourglass control.\n**Verdict: Correct.**\n\n**B. To avoid affecting shear waves, the hourglass viscosity should be scaled with the bulk modulus $K$ so that $\\eta_{h}\\propto K$; this ensures that only volumetric hourglass patterns are damped and that the explicit time-step limit $\\Delta t_{\\mathrm{crit}}$ increases because the stabilizing forces act against unphysical deformations.**\n- The primary hourglass modes in trilinear hexahedra are deviatoric (shear-like) in nature. Scaling the control with the bulk modulus $K$ would primarily damp volumetric modes, which is not the main problem. To avoid affecting *physical* shear waves, the control should be orthogonal to them, not scaled with a property ($K$) unrelated to shear. The premise is flawed.\n- The claim that $\\Delta t_{\\mathrm{crit}}$ *increases* is fundamentally false. Adding any form of stabilization, whether stiffness or damping, cannot increase the stable time step. Stiffness control *decreases* it. Viscous control at best leaves it nearly unchanged or slightly decreases it. The argument that suppressing unphysical modes improves stability in a way that allows for a larger time step conflates two different types of stability (modal vs. numerical integration).\n**Verdict: Incorrect.**\n\n**C. Global Rayleigh damping calibrated to critically damp the element’s highest mode is an appropriate substitute for hourglass viscosity: it suppresses hourglass instabilities while leaving the explicit stability limit unchanged and does not alter the phase velocity of physical waves.**\n- Rayleigh damping, $\\mathbf{C} = \\alpha_R \\mathbf{M} + \\beta_R \\mathbf{K}$, is not a targeted control. It introduces damping across all modes. While a large $\\beta_R$ can damp high-frequency modes (including hourglass), the $\\alpha_R \\mathbf{M}$ term heavily damps low-frequency physical modes, which is undesirable and corrupts phase accuracy. Thus, it *does* alter the phase velocity of physical waves.\n- Calibrating it to *critically damp* ($\\zeta=1$) the highest mode means the damping ratio at $\\omega_{\\max}$ is $\\xi_{\\max}=1$. The stability limit becomes $\\Delta t \\le \\frac{2}{\\omega_{\\max}} (\\sqrt{1+1^2} - 1) \\approx 0.414 (2/\\omega_{\\max})$. This is a severe *reduction*, not \"unchanged\".\n**Verdict: Incorrect.**\n\n**D. A wave-speed-preserving viscosity calibration can be constructed by (i) defining an hourglass operator $\\mathbf{H}$ such that $\\mathbf{H}\\,\\mathbf{u}= \\mathbf{0}$ for rigid-body motions and any displacement field that induces constant strain over the element, (ii) adding a viscous hourglass force $\\mathbf{f}_{h}^{v}=\\eta_{h}\\,\\mathbf{H}\\,\\dot{\\mathbf{u}}$, and (iii) choosing $\\eta_{h}$ to realize a target modal damping ratio $\\zeta_{h}$ at a representative hourglass frequency $\\omega_{h}\\approx \\pi c_{t}/h$, where $c_{t}$ is a current tangent wave speed (e.g., $c_{s}$). Estimating the modal mass as $m_{h}\\approx \\alpha\\,m_{e}$ for some $\\alpha$ of order unity (with $m_{e}=\\rho V_{e}$ the element mass and $V_{e}$ its volume) and setting $\\eta_{h}=2\\,\\zeta_{h}\\,m_{h}\\,\\omega_{h}$ yields damping concentrated on high-wavenumber hourglass content. Because $\\mathbf{H}$ annihilates linear fields, this procedure does not change the dispersion or phase velocity for wavelengths $\\lambda\\gg h$.**\n- This statement provides a formal and detailed description of the viscosity-like control method.\n- (i) The definition of the hourglass operator $\\mathbf{H}$ is correct; its orthogonality to rigid-body and constant-strain modes is the essential property that isolates hourglassing.\n- (ii) The form of the viscous force is a valid conceptual representation of a projected viscous force.\n- (iii) The calibration procedure is identical to the one described correctly in statement A and is based on sound physical principles. The estimation of modal mass as a fraction of the element mass is a common practice.\n- The final conclusion is correct: because $\\mathbf{H}$ annihilates linear fields, it correctly leaves long-wavelength physical modes unaffected, thus preserving their phase velocity. The assertion that $\\alpha$ is of order unity is a slight imprecision (it's typically a fraction less than $1$), but in the context of order-of-magnitude estimation, this does not invalidate the statement's fundamental correctness.\n**Verdict: Correct.**\n\n**E. Increasing the stiffness-like hourglass parameter always increases the maximum stable explicit time step because the added stiffness suppresses unphysical modes, thereby improving numerical stability without affecting the highest physical frequencies.**\n- This statement is fundamentally incorrect. As analyzed for statement A, adding stiffness, artificial or physical, increases the system's highest frequency $\\omega_{\\max}$. The stability limit $\\Delta t_{\\mathrm{crit}} \\le 2/\\omega_{\\max}$ is therefore *reduced*, not increased.\n- The reasoning provided is flawed. While the control does suppress the growth of unphysical modes (a form of \"improving stability\"), it does so by stiffening the response at high frequencies, which is precisely what tightens the explicit time integration stability limit. The statement incorrectly claims this does not affect the highest frequencies; the hourglass frequencies *are* the highest frequencies in the system after stabilization.\n**Verdict: Incorrect.**\n\nIn summary, statements A and D provide correct descriptions of hourglass control theory and practice. Statements B, C, and E contain fundamental errors regarding the effect of stabilization on the explicit time step and the nature of different damping schemes.", "answer": "$$\\boxed{AD}$$", "id": "2607407"}, {"introduction": "A central challenge in nonlinear analysis is accurately modeling complex material behavior like plasticity and rate-dependence. This hands-on exercise focuses on the heart of the numerical implementation: the constitutive update within a single time step for a viscoplastic material [@problem_id:2607436]. You will derive the consistent algorithmic tangent modulus, $E_{\\text{alg}}$, which is essential for ensuring the quadratic convergence of the global Newton-Raphson iterations in an implicit analysis. This derivation provides deep insight into how path-dependent and rate-dependent material history is integrated and consistently linearized within the finite element framework.", "problem": "Consider a one-dimensional bar undergoing small strains in transient dynamics within the Finite Element Method (FEM). The governing balance at the element level is the balance of linear momentum, but focus only on the material nonlinear constitutive update at a fixed material point, which supplies the consistent algorithmic tangent used in the global Newton iterations for the time-discrete equations of motion.\n\nAssume the following standard viscoplastic overstress model in uniaxial tension:\n- Additive strain decomposition: $\\epsilon = \\epsilon_{e} + \\epsilon_{p}$.\n- Linear elastic law: $\\sigma = E \\, \\epsilon_{e} = E \\, (\\epsilon - \\epsilon_{p})$, where $E gt; 0$ is the Young's modulus.\n- Isotropic linear hardening: $R = H \\, \\epsilon_{p}$ with $H \\ge 0$.\n- Perzyna-type viscoplastic flow with linear overstress (rate sensitivity exponent $m = 1$): $\\dot{\\epsilon}_{p} = \\frac{1}{\\eta} \\left\\langle \\sigma - \\sigma_{y} - R \\right\\rangle$, where $\\sigma_{y} gt; 0$ is the initial yield stress, $\\eta gt; 0$ is the viscosity parameter, and $\\langle \\cdot \\rangle$ denotes the Macaulay bracket.\n\nConsider a single time step from $t_{n}$ to $t_{n+1} = t_{n} + \\Delta t$, with the backward Euler time discretization applied to the internal variable update. Assume that during this step the viscoplastic flow remains active (i.e., the overstress is strictly positive throughout the step) and that the stress remains tensile, so that no sign changes occur and the Macaulay bracket can be dropped consistently over the step.\n\nStarting from the above definitions and assumptions, and using only backward Euler time discretization for the internal variable, derive the closed-form expression for the consistent algorithmic tangent modulus $E_{\\text{alg}} = \\frac{d \\sigma_{n+1}}{d \\epsilon_{n+1}}$ to be used in the material stiffness for the Newton linearization at $t_{n+1}$. Express your final answer in terms of $E$, $H$, $\\eta$, and $\\Delta t$, and show explicitly how the result depends on the ratio $\\Delta t / \\eta$ (thereby demonstrating rate dependence). Do not assume any special numerical values.\n\nYour final answer must be a single closed-form analytic expression for $E_{\\text{alg}}$. No numerical evaluation is required. If you introduce any intermediate variables, eliminate them in the final expression so that only $E$, $H$, $\\eta$, and $\\Delta t$ appear in the final result.", "solution": "The objective is to derive the consistent algorithmic tangent modulus, defined as $E_{\\text{alg}} = \\frac{d \\sigma_{n+1}}{d \\epsilon_{n+1}}$, for a given viscoplastic model. The derivation is performed at a single material point over a time step from $t_{n}$ to $t_{n+1} = t_{n} + \\Delta t$. The total strain at the end of the step, $\\epsilon_{n+1}$, is considered the independent variable.\n\nThe given constitutive relations are:\n1.  Additive strain decomposition: $\\epsilon = \\epsilon_{e} + \\epsilon_{p}$\n2.  Linear elastic law: $\\sigma = E (\\epsilon - \\epsilon_{p})$\n3.  Linear isotropic hardening: $R = H \\epsilon_{p}$\n4.  Viscoplastic flow rule: $\\dot{\\epsilon}_{p} = \\frac{1}{\\eta} \\left\\langle \\sigma - \\sigma_{y} - R \\right\\rangle$\n\nThe problem specifies using the backward Euler time discretization for the evolution of the internal variable, $\\epsilon_{p}$. Applying this to the flow rule, we evaluate all quantities on the right-hand side at time $t_{n+1}$. The rate $\\dot{\\epsilon}_{p}$ is approximated as $\\frac{\\epsilon_{p, n+1} - \\epsilon_{p, n}}{\\Delta t}$. The problem states that viscoplastic flow is active and the stress is tensile, allowing the Macaulay bracket $\\langle \\cdot \\rangle$ to be dropped. Thus, the discretized flow rule is:\n$$ \\frac{\\epsilon_{p, n+1} - \\epsilon_{p, n}}{\\Delta t} = \\frac{1}{\\eta} \\left( \\sigma_{n+1} - \\sigma_{y} - R_{n+1} \\right) $$\nThe constitutive relations for stress and hardening at time $t_{n+1}$ are:\n$$ \\sigma_{n+1} = E (\\epsilon_{n+1} - \\epsilon_{p, n+1}) $$\n$$ R_{n+1} = H \\epsilon_{p, n+1} $$\nHere, $\\epsilon_{p, n}$ is the known plastic strain from the previous time step. Our goal is to find an expression for $\\sigma_{n+1}$ in terms of $\\epsilon_{n+1}$ and then differentiate it. To do this, we must first solve for the internal variables at time $t_{n+1}$.\n\nFirst, substitute the expression for $R_{n+1}$ into the discretized flow rule:\n$$ \\frac{\\epsilon_{p, n+1} - \\epsilon_{p, n}}{\\Delta t} = \\frac{1}{\\eta} \\left( \\sigma_{n+1} - \\sigma_{y} - H \\epsilon_{p, n+1} \\right) $$\nThis equation provides a relationship between the unknowns $\\epsilon_{p, n+1}$ and $\\sigma_{n+1}$. We can rearrange it to express $\\epsilon_{p, n+1}$ in terms of $\\sigma_{n+1}$ and known quantities.\n$$ \\eta (\\epsilon_{p, n+1} - \\epsilon_{p, n}) = \\Delta t (\\sigma_{n+1} - \\sigma_{y} - H \\epsilon_{p, n+1}) $$\n$$ \\eta \\epsilon_{p, n+1} + H \\Delta t \\, \\epsilon_{p, n+1} = \\eta \\epsilon_{p, n} + \\Delta t (\\sigma_{n+1} - \\sigma_{y}) $$\n$$ \\epsilon_{p, n+1} (\\eta + H \\Delta t) = \\eta \\epsilon_{p, n} + \\Delta t (\\sigma_{n+1} - \\sigma_{y}) $$\n$$ \\epsilon_{p, n+1} = \\frac{\\eta \\epsilon_{p, n} + \\Delta t (\\sigma_{n+1} - \\sigma_{y})}{\\eta + H \\Delta t} $$\nNow, substitute this expression for $\\epsilon_{p, n+1}$ into the stress-strain relation $\\sigma_{n+1} = E (\\epsilon_{n+1} - \\epsilon_{p, n+1})$:\n$$ \\sigma_{n+1} = E \\left( \\epsilon_{n+1} - \\frac{\\eta \\epsilon_{p, n} + \\Delta t (\\sigma_{n+1} - \\sigma_{y})}{\\eta + H \\Delta t} \\right) $$\nThis equation is an implicit expression for $\\sigma_{n+1}$. We must solve it for $\\sigma_{n+1}$ to obtain an explicit function of $\\epsilon_{n+1}$.\n$$ \\sigma_{n+1} = E \\epsilon_{n+1} - \\frac{E \\Delta t}{\\eta + H \\Delta t} \\sigma_{n+1} - \\frac{E (\\eta \\epsilon_{p, n} - \\Delta t \\, \\sigma_{y})}{\\eta + H \\Delta t} $$\nGroup the terms containing $\\sigma_{n+1}$:\n$$ \\sigma_{n+1} \\left( 1 + \\frac{E \\Delta t}{\\eta + H \\Delta t} \\right) = E \\epsilon_{n+1} - \\frac{E (\\eta \\epsilon_{p, n} - \\Delta t \\, \\sigma_{y})}{\\eta + H \\Delta t} $$\nSimplify the term in the parentheses on the left-hand side:\n$$ 1 + \\frac{E \\Delta t}{\\eta + H \\Delta t} = \\frac{\\eta + H \\Delta t + E \\Delta t}{\\eta + H \\Delta t} = \\frac{\\eta + (E+H) \\Delta t}{\\eta + H \\Delta t} $$\nSubstituting this back gives:\n$$ \\sigma_{n+1} \\left( \\frac{\\eta + (E+H) \\Delta t}{\\eta + H \\Delta t} \\right) = E \\epsilon_{n+1} - \\frac{E (\\eta \\epsilon_{p, n} - \\Delta t \\, \\sigma_{y})}{\\eta + H \\Delta t} $$\nNow, we can isolate $\\sigma_{n+1}$:\n$$ \\sigma_{n+1} = \\left( \\frac{\\eta + H \\Delta t}{\\eta + (E+H) \\Delta t} \\right) \\left( E \\epsilon_{n+1} - \\frac{E (\\eta \\epsilon_{p, n} - \\Delta t \\, \\sigma_{y})}{\\eta + H \\Delta t} \\right) $$\n$$ \\sigma_{n+1} = \\frac{E (\\eta + H \\Delta t)}{\\eta + (E+H) \\Delta t} \\epsilon_{n+1} - \\frac{E (\\eta \\epsilon_{p, n} - \\Delta t \\, \\sigma_{y})}{\\eta + (E+H) \\Delta t} $$\nThis expression gives $\\sigma_{n+1}$ as a linear function of $\\epsilon_{n+1}$. All other terms in the expression depend on material parameters ($E, H, \\eta, \\sigma_{y}$), the time step size $\\Delta t$, and the known state at $t_{n}$ (specifically $\\epsilon_{p, n}$).\n\nThe consistent algorithmic tangent modulus is the derivative of $\\sigma_{n+1}$ with respect to $\\epsilon_{n+1}$:\n$$ E_{\\text{alg}} = \\frac{d \\sigma_{n+1}}{d \\epsilon_{n+1}} $$\nSince the second term in the expression for $\\sigma_{n+1}$ does not depend on $\\epsilon_{n+1}$, its derivative is zero. The derivative is simply the coefficient of the $\\epsilon_{n+1}$ term:\n$$ E_{\\text{alg}} = \\frac{E (\\eta + H \\Delta t)}{\\eta + (E+H) \\Delta t} $$\nTo explicitly show the dependence on the ratio $\\Delta t / \\eta$ as requested, we can divide the numerator and the denominator by $\\eta$:\n$$ E_{\\text{alg}} = \\frac{E \\left( 1 + H \\frac{\\Delta t}{\\eta} \\right)}{1 + (E+H) \\frac{\\Delta t}{\\eta}} $$\nThis is the final expression for the consistent algorithmic tangent modulus. It is a rate-dependent modulus, as its value depends on the time step $\\Delta t$ and the viscosity $\\eta$ through their ratio. As viscosity $\\eta \\to \\infty$ or as the time step $\\Delta t \\to 0$, the ratio $\\frac{\\Delta t}{\\eta} \\to 0$, and we have $E_{\\text{alg}} \\to E$, which correctly recovers the elastic response. In the rate-independent limit where $\\eta \\to 0$, we have $E_{\\text{alg}} \\to \\frac{E(H\\frac{\\Delta t}{\\eta})}{(E+H)\\frac{\\Delta t}{\\eta}} = \\frac{EH}{E+H}$, which is the correct tangent modulus for rate-independent plasticity with linear hardening.", "answer": "$$\\boxed{\\frac{E \\left( 1 + H \\frac{\\Delta t}{\\eta} \\right)}{1 + (E+H) \\frac{\\Delta t}{\\eta}}}$$", "id": "2607436"}]}