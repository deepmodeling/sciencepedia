{"hands_on_practices": [{"introduction": "A cornerstone of finite element analysis is the principle of performing computations on a simple reference element and transferring the results to physical mesh elements via an affine map. This practice guides you through the fundamental derivation of how key mathematical quantities, such as Sobolev norms, scale under this transformation [@problem_id:2557640]. Mastering this technique is essential for understanding the origin of inverse inequalities and for deriving a priori error estimates that explicitly depend on element size $h_K$ and polynomial degree $r$.", "problem": "Let $\\widehat{K} \\subset \\mathbb{R}^{d}$ be a fixed reference element (either the unit simplex or the unit cube), and let $K \\subset \\mathbb{R}^{d}$ be a physical element obtained by an affine map $F_{K} : \\widehat{K} \\to K$ of the form $F_{K}(\\widehat{x}) = B_{K}\\widehat{x} + b_{K}$, where $B_{K} \\in \\mathbb{R}^{d \\times d}$ is invertible and $b_{K} \\in \\mathbb{R}^{d}$. Denote by $J_{K} = \\det(B_{K})$ the Jacobian determinant, and by $\\|\\cdot\\|$ the spectral matrix norm induced by the Euclidean vector norm. For a function $v : K \\to \\mathbb{R}$, define its pullback $\\widehat{v} = v \\circ F_{K}$ on $\\widehat{K}$. Assume that $K$ belongs to a shape-regular family of affine images of $\\widehat{K}$, so that there exist element diameter $h_{K}  0$ and constants depending only on the shape-regularity for which $\\|B_{K}\\| \\simeq h_{K}$, $\\|B_{K}^{-1}\\| \\simeq h_{K}^{-1}$, and $|J_{K}| \\simeq h_{K}^{d}$.\n\nConsider the polynomial finite element space of degree at most $r \\in \\mathbb{N}$ on $K$, obtained by pullback from $\\mathbb{P}_{r}(\\widehat{K})$ (total degree) or $\\mathbb{Q}_{r}(\\widehat{K})$ (tensor-product degree) on $\\widehat{K}$. Let $0 \\leq \\ell \\leq m$ be integers for which the seminorms $|\\cdot|_{H^{\\ell}}$ and $|\\cdot|_{H^{m}}$ are well-defined on this space.\n\nStarting only from the change-of-variables formula for integrals under $F_{K}$ and the chain rule for derivatives under affine maps, first derive the exact dependence of $\\|v\\|_{L^{2}(K)}$ and $|v|_{H^{1}(K)}$ on $|J_{K}|$ and $\\|B_{K}^{-1}\\|$ in terms of the corresponding norms and seminorms of $\\widehat{v}$ on $\\widehat{K}$. Then invoke a reference-element inverse estimate of the form\n$$\n|\\widehat{v}|_{H^{m}(\\widehat{K})} \\leq C_{\\mathrm{ref}}(d,m,\\ell)\\, r^{2(m-\\ell)}\\, |\\widehat{v}|_{H^{\\ell}(\\widehat{K})}\n$$\nthat holds for all $\\widehat{v}$ in the reference polynomial space, where $C_{\\mathrm{ref}}(d,m,\\ell)$ does not depend on $h_{K}$ or $r$. Combine these ingredients to obtain the corresponding elementwise inverse inequality on $K$ and identify the minimal dependence of its constant on $h_{K}$ and $r$ for given $m$ and $\\ell$.\n\nYour final answer must be the single analytic expression $S(h_{K},r;m,\\ell)$ giving the asymptotic scaling of the elementwise inverse-inequality constant in terms of $h_{K}$ and $r$, up to a multiplicative factor independent of $h_{K}$ and $r$. Do not include any inequality or additional text in the final answer. Express the result in closed form as a function of $h_{K}$, $r$, $m$, and $\\ell$.", "solution": "The problem is valid and represents a standard derivation in the theory of finite element methods. We proceed to derive the elementwise inverse inequality by following the specified steps.\n\nFirst, we must establish the relationship between Sobolev seminorms of a function $v$ on a physical element $K$ and its pullback $\\widehat{v}$ on the reference element $\\widehat{K}$. The mapping is given by $x = F_K(\\widehat{x}) = B_K\\widehat{x} + b_K$.\n\nLet us begin with the $L^2$-norm, which corresponds to the $H^0$-seminorm. The square of the $L^2(K)$-norm is given by the integral $\\|v\\|_{L^2(K)}^2 = \\int_K |v(x)|^2 \\, dx$. We perform a change of variables from $x$ to $\\widehat{x}$. The Jacobian of the transformation $F_K$ is the matrix $B_K$, so its determinant is $J_K = \\det(B_K)$. The differential volume elements are related by $dx = |\\det(\\nabla F_K)| \\, d\\widehat{x} = |J_K| \\, d\\widehat{x}$. By definition of the pullback, $v(x) = v(F_K(\\widehat{x})) = \\widehat{v}(\\widehat{x})$. Substituting these into the integral gives:\n$$ \\|v\\|_{L^2(K)}^2 = \\int_{\\widehat{K}} |\\widehat{v}(\\widehat{x})|^2 |J_K| \\, d\\widehat{x} = |J_K| \\int_{\\widehat{K}} |\\widehat{v}(\\widehat{x})|^2 \\, d\\widehat{x} = |J_K| \\|\\widehat{v}\\|_{L^2(\\widehat{K})}^2 $$\nTaking the square root, we obtain the exact scaling relation for the $L^2$-norm:\n$$ \\|v\\|_{L^2(K)} = |J_K|^{1/2} \\|\\widehat{v}\\|_{L^2(\\widehat{K})} $$\n\nNext, we generalize this to an arbitrary integer-order Sobolev seminorm $|v|_{H^k(K)}$ for $k \\ge 0$. The squared seminorm is defined as $|v|_{H^k(K)}^2 = \\sum_{|\\alpha|=k} \\int_K |D^\\alpha_x v(x)|^2 \\, dx$, where $D^\\alpha_x$ denotes the partial derivative with respect to $x$ for the multi-index $\\alpha$. We must relate the derivatives of $v$ with respect to $x$ to the derivatives of $\\widehat{v}$ with respect to $\\widehat{x}$.\nFrom the relation $\\widehat{v}(\\widehat{x}) = v(B_K\\widehat{x} + b_K)$, the chain rule for the gradient gives:\n$$ \\nabla_{\\widehat{x}} \\widehat{v} = B_K^T (\\nabla_x v) $$\nwhere gradients are column vectors. Solving for $\\nabla_x v$, we get:\n$$ \\nabla_x v = (B_K^T)^{-1} \\nabla_{\\widehat{x}} \\widehat{v} = (B_K^{-1})^T \\nabla_{\\widehat{x}} \\widehat{v} $$\nBy applying the chain rule repeatedly, any $k$-th order derivative of $v$ can be expressed as a linear combination of $k$-th order derivatives of $\\widehat{v}$. Schematically, the transformation of the tensor of $k$-th derivatives involves $k$ applications of the matrix $(B_K^{-1})^T$. Taking a suitable tensor norm (e.g., the Frobenius norm), denoted $\\|\\cdot\\|_{\\text{tensor}}$, we have the following bound:\n$$ \\|D^k_x v(x)\\|_{\\text{tensor}} \\le \\|(B_K^{-1})^T\\|^k \\|D^k_{\\widehat{x}} \\widehat{v}(\\widehat{x})\\|_{\\text{tensor}} = \\|B_K^{-1}\\|^k \\|D^k_{\\widehat{x}} \\widehat{v}(\\widehat{x})\\|_{\\text{tensor}} $$\nwhere $\\|\\cdot\\|$ is the spectral norm. Since all norms on finite-dimensional spaces are equivalent, this inequality holds up to a constant for any choice of norm on the space of derivative tensors. Squaring this and summing over all derivatives of order $k$, we obtain a bound for the integrands of the seminorms:\n$$ \\sum_{|\\alpha|=k} |D^\\alpha_x v(x)|^2 \\le C_U' \\|B_K^{-1}\\|^{2k} \\sum_{|\\beta|=k} |D^\\beta_{\\widehat{x}} \\widehat{v}(\\widehat{x})|^2 $$\nwhere $C_U'$ is a constant depending on $d$ and $k$. Integrating over $K$ and changing variables gives:\n$$ |v|_{H^k(K)}^2 \\le C_U' \\int_{\\widehat{K}} \\|B_K^{-1}\\|^{2k} \\left(\\sum_{|\\beta|=k} |D^\\beta_{\\widehat{x}} \\widehat{v}(\\widehat{x})|^2\\right) |J_K| \\, d\\widehat{x} = C_U' |J_K| \\|B_K^{-1}\\|^{2k} |\\widehat{v}|_{H^k(\\widehat{K})}^2 $$\nTaking the square root yields an upper bound on the seminorm on the physical element:\n$$ |v|_{H^k(K)} \\le C_U(k) |J_K|^{1/2} \\|B_K^{-1}\\|^k |\\widehat{v}|_{H^k(\\widehat{K})} $$\nwhere $C_U(k) = \\sqrt{C_U'}$.\n\nFor a lower bound, we use the inverse relation $\\nabla_{\\widehat{x}} \\widehat{v} = B_K^T \\nabla_x v$. A similar argument shows:\n$$ \\|D^k_{\\widehat{x}} \\widehat{v}(\\widehat{x})\\|_{\\text{tensor}} \\le \\|B_K\\|^k \\|D^k_x v(x)\\|_{\\text{tensor}} $$\nThis leads to the inequality:\n$$ |\\widehat{v}|_{H^k(\\widehat{K})}^2 \\le C_L' |J_K|^{-1} \\|B_K\\|^{2k} |v|_{H^k(K)}^2 $$\nRearranging and taking the square root gives a lower bound on $|v|_{H^k(K)}$:\n$$ |v|_{H^k(K)} \\ge C_L(k) |J_K|^{1/2} \\|B_K\\|^{-k} |\\widehat{v}|_{H^k(\\widehat{K})} $$\n\nWe now have all the necessary ingredients to derive the inverse inequality on $K$. We are given $0 \\le \\ell \\le m$. We start from the upper bound for $|v|_{H^m(K)}$:\n$$ |v|_{H^m(K)} \\le C_U(m) |J_K|^{1/2} \\|B_K^{-1}\\|^m |\\widehat{v}|_{H^m(\\widehat{K})} $$\nNext, we apply the given inverse inequality on the reference element $\\widehat{K}$:\n$$ |\\widehat{v}|_{H^m(\\widehat{K})} \\le C_{\\mathrm{ref}}(d,m,\\ell) \\, r^{2(m-\\ell)} \\, |\\widehat{v}|_{H^\\ell(\\widehat{K})} $$\nSubstituting this into our expression yields:\n$$ |v|_{H^m(K)} \\le C_U(m) |J_K|^{1/2} \\|B_K^{-1}\\|^m \\left( C_{\\mathrm{ref}} r^{2(m-\\ell)} |\\widehat{v}|_{H^\\ell(\\widehat{K})} \\right) $$\nTo complete the inequality, we need to relate $|\\widehat{v}|_{H^\\ell(\\widehat{K})}$ back to $|v|_{H^\\ell(K)}$. We use the lower bound derived for $|v|_{H^\\ell(K)}$, which we rearrange to obtain an upper bound for $|\\widehat{v}|_{H^\\ell(\\widehat{K})}$:\n$$ |\\widehat{v}|_{H^\\ell(\\widehat{K})} \\le \\frac{1}{C_L(\\ell)} |J_K|^{-1/2} \\|B_K\\|^{\\ell} |v|_{H^\\ell(K)} $$\nSubstituting this final piece into the main inequality:\n$$ |v|_{H^m(K)} \\le C_U(m) C_{\\mathrm{ref}} |J_K|^{1/2} \\|B_K^{-1}\\|^m r^{2(m-\\ell)} \\left( \\frac{1}{C_L(\\ell)} |J_K|^{-1/2} \\|B_K\\|^{\\ell} |v|_{H^\\ell(K)} \\right) $$\nThe terms $|J_K|^{1/2}$ and $|J_K|^{-1/2}$ cancel. Grouping the constants and the terms involving the mapping gives:\n$$ |v|_{H^m(K)} \\le \\frac{C_U(m) C_{\\mathrm{ref}}}{C_L(\\ell)} \\|B_K^{-1}\\|^m \\|B_K\\|^{\\ell} r^{2(m-\\ell)} |v|_{H^\\ell(K)} $$\nThe constant of this inverse inequality on $K$ is $C_K = C_{\\text{inv}} \\|B_K^{-1}\\|^m \\|B_K\\|^{\\ell} r^{2(m-\\ell)}$, where $C_{\\text{inv}}$ absorbs all factors independent of $h_K$ and $r$.\n\nThe problem asks for the minimal dependence of this constant on $h_K$ and $r$. This corresponds to the asymptotic scaling of $C_K$. We use the given shape-regularity estimates: $\\|B_K\\| \\simeq h_K$ and $\\|B_K^{-1}\\| \\simeq h_K^{-1}$. The symbol $\\simeq$ indicates that the quantities are proportional up to constants that depend only on the shape-regularity of the mesh, not on $h_K$.\nSubstituting these scaling relations into the derived expression for the constant:\n$$ \\|B_K^{-1}\\|^m \\|B_K\\|^{\\ell} \\simeq (h_K^{-1})^m (h_K)^{\\ell} = h_K^{-m} h_K^{\\ell} = h_K^{\\ell-m} $$\nTherefore, the scaling of the inverse inequality constant with respect to $h_K$ is $h_K^{\\ell-m}$.\nThe dependence on the polynomial degree $r$ is explicitly given as $r^{2(m-\\ell)}$.\nCombining these, the asymptotic scaling of the constant, denoted $S(h_K, r; m, \\ell)$, is:\n$$ S(h_K, r; m, \\ell) = h_K^{\\ell-m} r^{2(m-\\ell)} $$\nThis can also be written as $(r^2 h_K^{-1})^{m-\\ell}$. This is the final expression for the scaling factor.", "answer": "$$\\boxed{h_{K}^{\\ell-m} r^{2(m-\\ell)}}$$", "id": "2557640"}, {"introduction": "Building on the concept of element mapping, this exercise explores the consequences of using more general isoparametric transformations, which allow elements to have curved edges and accurately model complex domains. You will investigate how a \"bubble function,\" designed to vanish on the boundary of a reference element, behaves when it is mapped to a curved physical element [@problem_id:2557609]. This analysis is crucial for correctly constructing finite element spaces that satisfy boundary conditions, particularly in high-order methods.", "problem": "Let $\\widehat{K}\\subset\\mathbb{R}^{2}$ be the reference triangle with vertices $\\widehat{\\boldsymbol{X}}_{1}=(0,0)$, $\\widehat{\\boldsymbol{X}}_{2}=(1,0)$, and $\\widehat{\\boldsymbol{X}}_{3}=(0,1)$. Denote the barycentric coordinates on $\\widehat{K}$ by $\\lambda_{1}(\\widehat{\\boldsymbol{\\xi}})$, $\\lambda_{2}(\\widehat{\\boldsymbol{\\xi}})$, and $\\lambda_{3}(\\widehat{\\boldsymbol{\\xi}})$, where $\\widehat{\\boldsymbol{\\xi}}=(\\xi,\\eta)$, so that $\\lambda_{1}=1-\\xi-\\eta$, $\\lambda_{2}=\\xi$, and $\\lambda_{3}=\\eta$. Consider the interior bubble function $\\widehat{b}(\\widehat{\\boldsymbol{\\xi}})=27\\,\\lambda_{1}(\\widehat{\\boldsymbol{\\xi}})\\,\\lambda_{2}(\\widehat{\\boldsymbol{\\xi}})\\,\\lambda_{3}(\\widehat{\\boldsymbol{\\xi}})$ on $\\widehat{K}$.\n\nLet $K\\subset\\mathbb{R}^{2}$ be a curved quadratic isoparametric image of $\\widehat{K}$ under a bijective, continuously differentiable mapping $F:\\widehat{K}\\to K$ defined by the quadratic Lagrange interpolation of the physical nodes $\\{\\boldsymbol{X}_{A}\\}_{A=1}^{6}\\subset\\mathbb{R}^{2}$:\n$$\nF(\\widehat{\\boldsymbol{\\xi}})=\\sum_{A=1}^{6}N_{A}(\\widehat{\\boldsymbol{\\xi}})\\,\\boldsymbol{X}_{A},\n$$\nwhere $\\{N_{A}\\}_{A=1}^{6}$ are the quadratic Lagrange shape functions on $\\widehat{K}$ associated with the $6$-node quadratic triangle, and the three midside nodes are placed so that each image of a reference edge is a smooth curve on $\\partial K$. Assume $F$ is a diffeomorphism onto its image and maps $\\partial\\widehat{K}$ onto $\\partial K$.\n\nDefine the mapped bubble field by composition $b:\\,K\\to\\mathbb{R}$, $b(\\boldsymbol{x})=\\widehat{b}\\big(F^{-1}(\\boldsymbol{x})\\big)$. Starting from the fundamental definitions of isoparametric transformations and pullback of scalar fields by composition with the inverse mapping, perform the following:\n\n- Derive an explicit expression for $b(\\boldsymbol{x})$ in terms of $\\lambda_{i}\\circ F^{-1}$ and justify that $b\\in H^{1}(K)$.\n- Using only the defining properties of $\\lambda_{i}$ on $\\partial\\widehat{K}$ and the boundary-to-boundary property of $F$, determine whether $b$ has a zero trace on $\\partial K$.\n\nFinally, evaluate the boundary line integral\n$$\nI=\\int_{\\partial K} b(\\boldsymbol{x})\\,\\mathrm{d}s.\n$$\nExpress the final answer as a real number. No rounding is required. No physical units are involved.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and self-contained. It is a standard problem in the theory of the finite element method. We may proceed with the solution.\n\nThe problem asks for the properties and a boundary integral of a scalar field $b(\\boldsymbol{x})$ defined on a curved domain $K \\subset \\mathbb{R}^{2}$. The domain $K$ is the image of a reference triangle $\\widehat{K}$ under a quadratic isoparametric mapping $F$. The field $b$ is defined by pulling back a reference bubble function $\\widehat{b}$ from $\\widehat{K}$ to $K$.\n\nThe reference triangle $\\widehat{K}$ has vertices $\\widehat{\\boldsymbol{X}}_{1}=(0,0)$, $\\widehat{\\boldsymbol{X}}_{2}=(1,0)$, and $\\widehat{\\boldsymbol{X}}_{3}=(0,1)$. The barycentric coordinates on $\\widehat{K}$ are given by $\\lambda_{1}(\\widehat{\\boldsymbol{\\xi}}) = 1-\\xi-\\eta$, $\\lambda_{2}(\\widehat{\\boldsymbol{\\xi}}) = \\xi$, and $\\lambda_{3}(\\widehat{\\boldsymbol{\\xi}}) = \\eta$ for a point $\\widehat{\\boldsymbol{\\xi}}=(\\xi,\\eta) \\in \\widehat{K}$. These are linear polynomials in the coordinates $(\\xi, \\eta)$.\n\nThe reference bubble function is defined as $\\widehat{b}(\\widehat{\\boldsymbol{\\xi}}) = 27\\,\\lambda_{1}(\\widehat{\\boldsymbol{\\xi}})\\,\\lambda_{2}(\\widehat{\\boldsymbol{\\xi}})\\,\\lambda_{3}(\\widehat{\\boldsymbol{\\xi}})$. As a product of polynomials, $\\widehat{b}$ is a cubic polynomial on $\\widehat{K}$, and is therefore infinitely differentiable on the interior of $\\widehat{K}$ and belongs to any Sobolev space $H^{k}(\\widehat{K})$ for $k \\ge 0$.\n\nThe mapping $F: \\widehat{K} \\to K$ is a quadratic isoparametric transformation, $F(\\widehat{\\boldsymbol{\\xi}}) = \\sum_{A=1}^{6} N_{A}(\\widehat{\\boldsymbol{\\xi}})\\,\\boldsymbol{X}_{A}$, where $\\{N_{A}\\}_{A=1}^{6}$ are the quadratic Lagrange basis functions. The problem states that $F$ is a diffeomorphism, which implies it is a continuously differentiable bijection with a continuously differentiable inverse $F^{-1}: K \\to \\widehat{K}$. The Jacobian determinant of $F$, denoted $\\det(DF)$, is therefore strictly positive and bounded on $\\widehat{K}$.\n\nThe mapped bubble field is defined by composition with the inverse map: $b(\\boldsymbol{x}) = \\widehat{b}(F^{-1}(\\boldsymbol{x}))$ for $\\boldsymbol{x} \\in K$.\n\nFirst, we derive an explicit expression for $b(\\boldsymbol{x})$ and analyze its regularity. Let us define the barycentric coordinates on the physical element $K$ as the pullbacks of the reference coordinates: $L_{i}(\\boldsymbol{x}) = \\lambda_{i}(F^{-1}(\\boldsymbol{x}))$ for $i=1,2,3$. With this definition, the expression for $b(\\boldsymbol{x})$ becomes:\n$$\nb(\\boldsymbol{x}) = 27 \\, L_{1}(\\boldsymbol{x}) \\, L_{2}(\\boldsymbol{x}) \\, L_{3}(\\boldsymbol{x})\n$$\nTo justify that $b \\in H^{1}(K)$, we examine its properties. The function $\\widehat{b}$ is a polynomial on $\\widehat{K}$, so it is square-integrable, i.e., $\\widehat{b} \\in L^{2}(\\widehat{K})$. The change of variables formula for integration gives\n$$\n\\int_{K} |b(\\boldsymbol{x})|^{2} \\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\widehat{K}} |\\widehat{b}(F^{-1}(F(\\widehat{\\boldsymbol{\\xi}})))|^{2} |\\det(DF(\\widehat{\\boldsymbol{\\xi}}))| \\, \\mathrm{d}\\widehat{\\boldsymbol{\\xi}} = \\int_{\\widehat{K}} |\\widehat{b}(\\widehat{\\boldsymbol{\\xi}})|^{2} \\det(DF(\\widehat{\\boldsymbol{\\xi}})) \\, \\mathrm{d}\\widehat{\\boldsymbol{\\xi}}.\n$$\nSince $\\widehat{b}$ is a polynomial on a compact set $\\widehat{K}$, it is bounded. The Jacobian determinant $\\det(DF)$ is also bounded as $F$ is continuously differentiable. The integral on the right is therefore finite, which implies $b \\in L^{2}(K)$.\n\nThe weak gradient of $b$ is given by the chain rule: $\\nabla_{\\boldsymbol{x}} b(\\boldsymbol{x}) = [ (DF(\\widehat{\\boldsymbol{\\xi}}))^{-T} \\nabla_{\\widehat{\\boldsymbol{\\xi}}} \\widehat{b}(\\widehat{\\boldsymbol{\\xi}}) ]_{\\widehat{\\boldsymbol{\\xi}}=F^{-1}(\\boldsymbol{x})}$. The gradient of the reference function, $\\nabla_{\\widehat{\\boldsymbol{\\xi}}} \\widehat{b}$, is a vector of quadratic polynomials and is thus square-integrable on $\\widehat{K}$. Since $F$ is a diffeomorphism on a compact set, the matrix norm of $(DF)^{-T}$ is bounded on $K$. By another application of the change of variables formula, we find that $\\int_{K} |\\nabla_{\\boldsymbol{x}} b(\\boldsymbol{x})|^{2} \\, \\mathrm{d}\\boldsymbol{x}$ is finite. Thus, $b \\in H^{1}(K)$.\n\nNext, we determine if $b$ has a zero trace on the boundary $\\partial K$. The trace of $b$ on $\\partial K$ is the restriction of the function to the boundary. Let $\\boldsymbol{x}$ be an arbitrary point on $\\partial K$. The problem states that $F$ maps the boundary of the reference element to the boundary of the physical element, $F(\\partial\\widehat{K}) = \\partial K$. Because $F$ is a bijection, for any $\\boldsymbol{x} \\in \\partial K$, its pre-image $F^{-1}(\\boldsymbol{x})$ must lie on the boundary of the reference element, $\\partial\\widehat{K}$. Let $\\widehat{\\boldsymbol{\\xi}} = F^{-1}(\\boldsymbol{x}) \\in \\partial\\widehat{K}$.\n\nThe boundary $\\partial\\widehat{K}$ consists of three edges:\n$1.$ The edge connecting $\\widehat{\\boldsymbol{X}}_{1}=(0,0)$ and $\\widehat{\\boldsymbol{X}}_{2}=(1,0)$, where $\\eta=0$. On this edge, $\\lambda_{3}(\\widehat{\\boldsymbol{\\xi}}) = \\eta = 0$.\n$2.$ The edge connecting $\\widehat{\\boldsymbol{X}}_{2}=(1,0)$ and $\\widehat{\\boldsymbol{X}}_{3}=(0,1)$, where $\\xi+\\eta=1$. On this edge, $\\lambda_{1}(\\widehat{\\boldsymbol{\\xi}}) = 1-\\xi-\\eta = 0$.\n$3.$ The edge connecting $\\widehat{\\boldsymbol{X}}_{3}=(0,1)$ and $\\widehat{\\boldsymbol{X}}_{1}=(0,0)$, where $\\xi=0$. On this edge, $\\lambda_{2}(\\widehat{\\boldsymbol{\\xi}}) = \\xi = 0$.\n\nIn all cases, for any point $\\widehat{\\boldsymbol{\\xi}} \\in \\partial\\widehat{K}$, at least one of its barycentric coordinates $\\lambda_{1}(\\widehat{\\boldsymbol{\\xi}})$, $\\lambda_{2}(\\widehat{\\boldsymbol{\\xi}})$, or $\\lambda_{3}(\\widehat{\\boldsymbol{\\xi}})$ is zero.\nThe reference bubble function is $\\widehat{b}(\\widehat{\\boldsymbol{\\xi}}) = 27\\,\\lambda_{1}(\\widehat{\\boldsymbol{\\xi}})\\,\\lambda_{2}(\\widehat{\\boldsymbol{\\xi}})\\,\\lambda_{3}(\\widehat{\\boldsymbol{\\xi}})$. Due to the presence of the product of all three barycentric coordinates, if any one of them is zero, the entire expression becomes zero. Therefore, $\\widehat{b}(\\widehat{\\boldsymbol{\\xi}})=0$ for all $\\widehat{\\boldsymbol{\\xi}} \\in \\partial\\widehat{K}$.\n\nNow we evaluate $b(\\boldsymbol{x})$ for $\\boldsymbol{x} \\in \\partial K$. We have:\n$$\nb(\\boldsymbol{x}) = \\widehat{b}(F^{-1}(\\boldsymbol{x}))\n$$\nAs established, if $\\boldsymbol{x} \\in \\partial K$, then its pre-image $\\widehat{\\boldsymbol{\\xi}} = F^{-1}(\\boldsymbol{x})$ is in $\\partial\\widehat{K}$. Consequently, $\\widehat{b}(F^{-1}(\\boldsymbol{x})) = \\widehat{b}(\\widehat{\\boldsymbol{\\xi}}) = 0$.\nThis demonstrates that $b(\\boldsymbol{x}) = 0$ for all $\\boldsymbol{x} \\in \\partial K$. The function $b$ has a zero trace on the boundary $\\partial K$.\n\nFinally, we evaluate the boundary line integral $I = \\int_{\\partial K} b(\\boldsymbol{x})\\,\\mathrm{d}s$.\nSince the integrand $b(\\boldsymbol{x})$ is identically zero for every point $\\boldsymbol{x}$ on the path of integration $\\partial K$, the value of the integral is unequivocally zero.\n$$\nI = \\int_{\\partial K} 0 \\, \\mathrm{d}s = 0.\n$$\nThe specific shape of the curved element $K$ and the exact locations of the nodes $\\{\\boldsymbol{X}_{A}\\}_{A=1}^{6}$ are irrelevant, provided the mapping $F$ remains a diffeomorphism. The result is a structural property of the bubble function pulled back to a physical element.", "answer": "$$\n\\boxed{0}\n$$", "id": "2557609"}, {"introduction": "While standard interpolation can be effective, ensuring the stability of the interpolation operator is critical for the robustness of a finite element scheme, especially for high polynomial degrees. This practice introduces a powerful alternative: an interpolation operator defined via orthogonal projection in the natural energy space [@problem_id:2557630]. By deriving its best-approximation property and calculating its operator norm, you will gain direct insight into the functional analysis that guarantees both the stability and optimality of this class of projectors.", "problem": "Consider the scalar model problem on the one-dimensional domain $\\Omega = (0,1)$ with homogeneous Dirichlet boundary conditions on $\\partial \\Omega$. Let $\\mathcal{T}_h$ be a partition of $\\Omega$ into subintervals $K$ such that the mesh is shape-regular in the sense that there exists a constant $\\sigma \\geq 1$ with $\\max_{K \\in \\mathcal{T}_h} |K| \\leq \\sigma \\min_{K \\in \\mathcal{T}_h} |K|$. For a fixed polynomial degree $p \\in \\mathbb{N}$, define the conforming finite element space\n$$\nV_h^p := \\left\\{ v \\in H^1_0(\\Omega) : v|_K \\in \\mathbb{P}_p(K) \\text{ for all } K \\in \\mathcal{T}_h \\right\\}.\n$$\nDefine the operator $\\Pi_{h,p}: H^1_0(\\Omega) \\to V_h^p$ by the variational condition\n$$\n\\sum_{K \\in \\mathcal{T}_h} \\int_K \\left( u' - (\\Pi_{h,p}u)' \\right) \\, (v_h)' \\, dx \\;=\\; 0 \n\\quad \\text{for all } v_h \\in V_h^p.\n$$\nThis operator is an energy-orthogonal projector with respect to the bilinear form $a(w,z) := \\sum_{K \\in \\mathcal{T}_h} \\int_K w' z' \\, dx$, which is the canonical inner product that induces the $H^1$-seminorm on $H^1_0(\\Omega)$.\n\nTasks:\n- Starting from the fundamental properties of the Sobolev space $H^1_0(\\Omega)$ and the Riesz representation theorem, argue that $\\Pi_{h,p}$ is well defined and linear, and that it preserves the homogeneous Dirichlet boundary conditions.\n- Using only coercivity and symmetry of $a(\\cdot,\\cdot)$ together with Cauchy–Schwarz inequality, derive a best-approximation (quasi-optimality) estimate for the error in the $H^1$-seminorm that is uniform in $p$ and depends on the mesh only through shape-regularity:\n$$\n\\| u - \\Pi_{h,p} u \\|_{H^1(\\Omega)} \\;\\le\\; \\inf_{w_h \\in V_h^p} \\| u - w_h \\|_{H^1(\\Omega)}.\n$$\n- Finally, compute the operator norm of $\\Pi_{h,p}$ as a mapping $\\Pi_{h,p}: \\left( H^1_0(\\Omega), |\\cdot|_{H^1(\\Omega)} \\right) \\to \\left( H^1_0(\\Omega), |\\cdot|_{H^1(\\Omega)} \\right)$ with respect to the $H^1$-seminorm, that is,\n$$\n\\| \\Pi_{h,p} \\|_{H^1_0(\\Omega) \\to H^1_0(\\Omega)} \\;=\\; \\sup_{u \\in H^1_0(\\Omega)\\setminus\\{0\\}} \\frac{|\\Pi_{h,p} u|_{H^1(\\Omega)}}{|u|_{H^1(\\Omega)}}.\n$$\n\nGive your final answer as a single exact value for this operator norm. No rounding is required and no physical units are involved.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It poses a standard question in the theory of the finite element method, relying on fundamental principles of functional analysis. All terms are defined with sufficient precision, and the premises are internally consistent. We may therefore proceed with the solution.\n\nWe address the three tasks in sequence. The analysis will use the $H^1$-seminorm $|v|_{H^1(\\Omega)} := \\left( \\int_{\\Omega} (v')^2 dx \\right)^{1/2}$. On the space $H^1_0(\\Omega)$, the Poincaré-Friedrichs inequality guarantees that this seminorm is a norm, equivalent to the standard $H^1(\\Omega)$ norm. The problem statement uses the notation $\\|\\cdot\\|_{H^1(\\Omega)}$ in this context, which we will interpret as the $H^1$-seminorm $|\\cdot|_{H^1(\\Omega)}$. The bilinear form is $a(w,z) := \\int_{\\Omega} w' z' dx$, such that $a(v,v) = |v|_{H^1(\\Omega)}^2$.\n\n**1. Well-definedness, Linearity, and Boundary Conditions of $\\Pi_{h,p}$**\n\nThe operator $\\Pi_{h,p}: H^1_0(\\Omega) \\to V_h^p$ is defined by the condition $\\sum_{K \\in \\mathcal{T}_h} \\int_K ( u' - (\\Pi_{h,p}u)' ) \\, (v_h)' \\, dx = 0$ for all $v_h \\in V_h^p$. In terms of the bilinear form $a(\\cdot, \\cdot)$, this is $a(u - \\Pi_{h,p}u, v_h) = 0$, which can be rewritten as $a(\\Pi_{h,p}u, v_h) = a(u, v_h)$ for all $v_h \\in V_h^p$.\n\nWell-definedness: The space $H^1_0(\\Omega)$ equipped with the inner product $a(\\cdot, \\cdot)$ is a Hilbert space. The finite element space $V_h^p$ is a finite-dimensional, and therefore closed, subspace of $H^1_0(\\Omega)$. As such, $(V_h^p, a(\\cdot, \\cdot))$ is itself a Hilbert space. For a fixed $u \\in H^1_0(\\Omega)$, we define a functional $L: V_h^p \\to \\mathbb{R}$ by $L(v_h) = a(u, v_h)$. This functional is linear. It is also bounded due to the Cauchy-Schwarz inequality: $|L(v_h)| = |a(u, v_h)| \\le |u|_{H^1(\\Omega)} |v_h|_{H^1(\\Omega)}$. By the Riesz Representation Theorem applied to the Hilbert space $V_h^p$, there exists a unique element, which we denote $\\Pi_{h,p}u \\in V_h^p$, such that $a(\\Pi_{h,p}u, v_h) = L(v_h) = a(u, v_h)$ for all $v_h \\in V_h^p$. This establishes that the operator $\\Pi_{h,p}$ is well-defined, providing a unique output $\\Pi_{h,p}u$ for each input $u$.\n\nLinearity: Let $u_1, u_2 \\in H^1_0(\\Omega)$ and $\\alpha, \\beta \\in \\mathbb{R}$. The element $\\Pi_{h,p}(\\alpha u_1 + \\beta u_2)$ is the unique element in $V_h^p$ satisfying $a(\\Pi_{h,p}(\\alpha u_1 + \\beta u_2), v_h) = a(\\alpha u_1 + \\beta u_2, v_h)$ for all $v_h \\in V_h^p$. By the bilinearity of $a(\\cdot,\\cdot)$, $a(\\alpha u_1 + \\beta u_2, v_h) = \\alpha a(u_1, v_h) + \\beta a(u_2, v_h)$. Using the definition of the projector, this becomes $\\alpha a(\\Pi_{h,p}u_1, v_h) + \\beta a(\\Pi_{h,p}u_2, v_h) = a(\\alpha\\Pi_{h,p}u_1 + \\beta\\Pi_{h,p}u_2, v_h)$. Thus, we have $a(\\Pi_{h,p}(\\alpha u_1 + \\beta u_2), v_h) = a(\\alpha\\Pi_{h,p}u_1 + \\beta\\Pi_{h,p}u_2, v_h)$. As this holds for all $v_h \\in V_h^p$, the uniqueness from the Riesz Representation Theorem implies $\\Pi_{h,p}(\\alpha u_1 + \\beta u_2) = \\alpha\\Pi_{h,p}u_1 + \\beta\\Pi_{h,p}u_2$. The operator is therefore linear.\n\nBoundary Conditions: The preservation of homogeneous Dirichlet boundary conditions is immediate from the definition of the codomain of the operator. The operator maps $H^1_0(\\Omega)$ to $V_h^p$. The space $V_h^p$ is explicitly defined as a subset of $H^1_0(\\Omega)$, i.e., $V_h^p \\subset H^1_0(\\Omega)$. Therefore, for any $u \\in H^1_0(\\Omega)$, its image $\\Pi_{h,p}u$ is an element of $V_h^p$, which means it is also an element of $H^1_0(\\Omega)$. Functions in $H^1_0(\\Omega)$ satisfy homogeneous Dirichlet boundary conditions in the sense of traces.\n\n**2. Best-Approximation Estimate**\n\nThe operator $\\Pi_{h,p}$ is the orthogonal projection of $H^1_0(\\Omega)$ onto its subspace $V_h^p$ with respect to the inner product $a(\\cdot, \\cdot)$. The defining property is the Galerkin orthogonality: $a(u - \\Pi_{h,p}u, v_h) = 0$ for all $v_h \\in V_h^p$. Let $w_h$ be an arbitrary element of $V_h^p$. We decompose the error $u - w_h$ as $u - w_h = (u - \\Pi_{h,p}u) + (\\Pi_{h,p}u - w_h)$. The term $\\Pi_{h,p}u - w_h$ is an element of $V_h^p$, since $V_h^p$ is a vector space.\n\nWe compute the squared seminorm of $u - w_h$:\n$$\n|u - w_h|_{H^1(\\Omega)}^2 = a(u - w_h, u - w_h) = a((u - \\Pi_{h,p}u) + (\\Pi_{h,p}u - w_h), (u - \\Pi_{h,p}u) + (\\Pi_{h,p}u - w_h))\n$$\nBy bilinearity of $a(\\cdot, \\cdot)$:\n$$\n|u - w_h|_{H^1(\\Omega)}^2 = a(u - \\Pi_{h,p}u, u - \\Pi_{h,p}u) + 2a(u - \\Pi_{h,p}u, \\Pi_{h,p}u - w_h) + a(\\Pi_{h,p}u - w_h, \\Pi_{h,p}u - w_h)\n$$\nFrom Galerkin orthogonality, the cross term is zero: $a(u - \\Pi_{h,p}u, \\Pi_{h,p}u - w_h) = 0$, because $\\Pi_{h,p}u - w_h \\in V_h^p$. The expression simplifies to the Pythagorean theorem for this orthogonal decomposition:\n$$\n|u - w_h|_{H^1(\\Omega)}^2 = |u - \\Pi_{h,p}u|_{H^1(\\Omega)}^2 + |\\Pi_{h,p}u - w_h|_{H^1(\\Omega)}^2\n$$\nSince $|\\Pi_{h,p}u - w_h|_{H^1(\\Omega)}^2 \\ge 0$, it follows that $|u - \\Pi_{h,p}u|_{H^1(\\Omega)}^2 \\le |u - w_h|_{H^1(\\Omega)}^2$. Taking the square root gives $|u - \\Pi_{h,p}u|_{H^1(\\Omega)} \\le |u - w_h|_{H^1(\\Omega)}$. This inequality holds for any $w_h \\in V_h^p$, meaning $\\Pi_{h,p}u$ is the best approximation to $u$ from $V_h^p$. Therefore,\n$$\n|u - \\Pi_{h,p}u|_{H^1(\\Omega)} \\leq \\inf_{w_h \\in V_h^p} |u - w_h|_{H^1(\\Omega)}\n$$\nThis is precisely the requested quasi-optimality estimate, where the constant is $1$.\n\n**3. Operator Norm of $\\Pi_{h,p}$**\n\nWe must compute the operator norm with respect to the $H^1$-seminorm:\n$$\n\\| \\Pi_{h,p} \\| = \\sup_{u \\in H^1_0(\\Omega)\\setminus\\{0\\}} \\frac{|\\Pi_{h,p} u|_{H^1(\\Omega)}}{|u|_{H^1(\\Omega)}}\n$$\nFrom the defining relation $a(\\Pi_{h,p}u, v_h) = a(u, v_h)$, we make the specific choice $v_h = \\Pi_{h,p}u \\in V_h^p$. This gives:\n$$\na(\\Pi_{h,p}u, \\Pi_{h,p}u) = a(u, \\Pi_{h,p}u)\n$$\nIn terms of the seminorm, this is $|\\Pi_{h,p}u|_{H^1(\\Omega)}^2 = a(u, \\Pi_{h,p}u)$. Applying the Cauchy-Schwarz inequality to the right-hand side yields:\n$$\na(u, \\Pi_{h,p}u) \\le |u|_{H^1(\\Omega)} |\\Pi_{h,p}u|_{H^1(\\Omega)}\n$$\nCombining these results, we find:\n$$\n|\\Pi_{h,p}u|_{H^1(\\Omega)}^2 \\le |u|_{H^1(\\Omega)} |\\Pi_{h,p}u|_{H^1(\\Omega)}\n$$\nIf $\\Pi_{h,p}u \\ne 0$, we may divide by $|\\Pi_{h,p}u|_{H^1(\\Omega)}$ to obtain $|\\Pi_{h,p}u|_{H^1(\\Omega)} \\le |u|_{H^1(\\Omega)}$. This inequality holds trivially if $\\Pi_{h,p}u = 0$. Consequently, for any $u \\in H^1_0(\\Omega)\\setminus\\{0\\}$, the ratio $\\frac{|\\Pi_{h,p} u|_{H^1(\\Omega)}}{|u|_{H^1(\\Omega)}} \\le 1$. This establishes an upper bound for the norm: $\\| \\Pi_{h,p} \\| \\le 1$.\n\nTo show that the norm is exactly $1$, we must demonstrate that this upper bound is attained. Consider any non-zero function $u_h \\in V_h^p$. For $p \\ge 1$, the space $V_h^p$ is not the trivial space $\\{0\\}$. Since $u_h$ is already an element of the subspace $V_h^p$, its best approximation from $V_h^p$ is itself. Formally, $u_h$ satisfies the condition $a(u_h, v_h) = a(u_h, v_h)$ for all $v_h \\in V_h^p$. By the uniqueness of the Riesz representer, it must be that $\\Pi_{h,p}u_h = u_h$.\n\nFor any such non-zero $u_h \\in V_h^p$, the ratio becomes:\n$$\n\\frac{|\\Pi_{h,p} u_h|_{H^1(\\Omega)}}{|u_h|_{H^1(\\Omega)}} = \\frac{|u_h|_{H^1(\\Omega)}}{|u_h|_{H^1(\\Omega)}} = 1\n$$\nSince there exists a set of functions for which the ratio is $1$, and the ratio can never exceed $1$, the supremum must be exactly $1$.\n$$\n\\| \\Pi_{h,p} \\|_{H^1_0(\\Omega) \\to H^1_0(\\Omega)} = 1\n$$\nThis result is independent of the polynomial degree $p$ and the mesh properties, as it is a general property of non-trivial orthogonal projection operators in a Hilbert space.", "answer": "$$\\boxed{1}$$", "id": "2557630"}]}