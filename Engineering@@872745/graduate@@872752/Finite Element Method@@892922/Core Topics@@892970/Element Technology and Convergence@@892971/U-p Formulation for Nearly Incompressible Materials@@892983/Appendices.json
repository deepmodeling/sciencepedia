{"hands_on_practices": [{"introduction": "The primary motivation for using the $u$-$p$ formulation is to overcome volumetric locking, which plagues standard displacement-based elements in nearly incompressible analysis. This first practice provides a direct, hands-on look at the origin of this phenomenon. By applying a known divergence-free displacement field to a simple bilinear ($Q_1$) element, you will discover how the discrete approximation can generate a spurious, non-zero volumetric strain, which is the root cause of the non-physical stiffness known as locking [@problem_id:2609062].", "problem": "Consider a single isoparametric bilinear quadrilateral element ($Q_1$) in plane strain within the Finite Element Method (FEM) using the displacement-pressure ($u$-$p$) formulation for a nearly incompressible material. The weak incompressibility constraint in this formulation is enforced via the pressure test functions, so the key kinematic quantity is the volumetric strain (the divergence of the displacement), denoted by $\\varepsilon_v = \\nabla \\cdot \\mathbf{u}$.\n\nLet the physical element occupy the square $\\Omega = \\{(x,y) \\,|\\, -1 \\le x \\le 1,\\, -1 \\le y \\le 1\\}$, with the standard bilinear shape functions\n$$\nN_1(x,y) = \\tfrac{1}{4}(1-x)(1-y),\\quad\nN_2(x,y) = \\tfrac{1}{4}(1+x)(1-y),\\quad\nN_3(x,y) = \\tfrac{1}{4}(1+x)(1+y),\\quad\nN_4(x,y) = \\tfrac{1}{4}(1-x)(1+y).\n$$\nAssume the exact kinematically admissible displacement field is divergence-free (perfectly incompressible) and is generated by the stream function $\\psi(x,y) = x y^{2}$ via\n$$\nu_x(x,y) = \\frac{\\partial \\psi}{\\partial y} = 2 x y,\\qquad\nu_y(x,y) = -\\frac{\\partial \\psi}{\\partial x} = - y^{2},\n$$\nso that $\\nabla \\cdot \\mathbf{u} = 0$ exactly in $\\Omega$.\n\nConstruct the discrete $Q_1$ displacement field $\\mathbf{u}^h = (u_x^h,u_y^h)$ by nodal interpolation of the exact values, that is,\n$$\nu_x^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_x(x_a,y_a),\\qquad\nu_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_y(x_a,y_a),\n$$\nwhere $(x_a,y_a)$ are the four element corner coordinates $(\\pm 1,\\pm 1)$. Define the discrete volumetric strain as $\\varepsilon_v^h(x,y) := \\nabla \\cdot \\mathbf{u}^h(x,y)$.\n\nUsing the standard $2\\times 2$ Gaussian quadrature points at $(x,y) = \\big(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3}\\big)$, compute the value of the discrete volumetric strain $\\varepsilon_v^h$ at the Gauss point $(x,y) = \\big(1/\\sqrt{3}, -1/\\sqrt{3}\\big)$. Provide your answer as an exact value. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard exercise in the Finite Element Method, testing the fundamental properties of bilinear interpolation and its consequences for enforcing incompressibility. All necessary data and functions are provided, and there are no contradictions or ambiguities. The problem is valid.\n\nThe objective is to compute the discrete volumetric strain, $\\varepsilon_v^h(x,y) = \\nabla \\cdot \\mathbf{u}^h(x,y)$, at the Gauss point $(x_g, y_g) = (1/\\sqrt{3}, -1/\\sqrt{3})$. The discrete displacement field $\\mathbf{u}^h = (u_x^h, u_y^h)$ is obtained by nodal interpolation of an exact, divergence-free displacement field.\n\nFirst, we must determine the nodal displacement values. The element nodes are the corners of the square domain $\\Omega$, which we number in standard counter-clockwise order:\nNode $1$: $(x_1, y_1) = (-1, -1)$\nNode $2$: $(x_2, y_2) = (1, -1)$\nNode $3$: $(x_3, y_3) = (1, 1)$\nNode $4$: $(x_4, y_4) = (-1, 1)$\n\nThe exact displacement field is given by $u_x(x,y) = 2xy$ and $u_y(x,y) = -y^2$. We evaluate these functions at the nodal coordinates to find the nodal displacements.\n\nFor the $x$-component of displacement, $u_x$:\n$u_{x1} = u_x(-1, -1) = 2(-1)(-1) = 2$\n$u_{x2} = u_x(1, -1) = 2(1)(-1) = -2$\n$u_{x3} = u_x(1, 1) = 2(1)(1) = 2$\n$u_{x4} = u_x(-1, 1) = 2(-1)(1) = -2$\n\nFor the $y$-component of displacement, $u_y$:\n$u_{y1} = u_y(-1, -1) = -(-1)^2 = -1$\n$u_{y2} = u_y(1, -1) = -(-1)^2 = -1$\n$u_{y3} = u_y(1, 1) = -(1)^2 = -1$\n$u_{y4} = u_y(-1, 1) = -(1)^2 = -1$\n\nThe discrete displacement field $\\mathbf{u}^h(x,y)$ is then given by the interpolation formulas:\n$$u_x^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_{xa}$$\n$$u_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_{ya}$$\nThe discrete volumetric strain is the divergence of this interpolated field:\n$$\\varepsilon_v^h(x,y) = \\frac{\\partial u_x^h}{\\partial x} + \\frac{\\partial u_y^h}{\\partial y} = \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial x} u_{xa} + \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial y} u_{ya}$$\n\nLet us analyze the term involving $u_y$. Since all nodal values $u_{ya}$ are equal to $-1$, the interpolated field $u_y^h$ is:\n$$u_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)(-1) = -1 \\cdot \\sum_{a=1}^{4} N_a(x,y)$$\nA fundamental property of isoparametric shape functions is that they form a partition of unity, i.e., $\\sum_{a=1}^{4} N_a(x,y) = 1$ for all $(x,y)$ in the element. Therefore, $u_y^h(x,y) = -1$.\nThe derivative of a constant is zero, so:\n$$\\frac{\\partial u_y^h}{\\partial y} = \\frac{\\partial}{\\partial y}(-1) = 0$$\nThis simplifies the calculation of the discrete volumetric strain considerably. The total expression reduces to:\n$$\\varepsilon_v^h(x,y) = \\frac{\\partial u_x^h}{\\partial x} = \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial x} u_{xa}$$\n\nWe now require the derivatives of the shape functions with respect to $x$:\n$\\frac{\\partial N_1}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1-x)(1-y)\\right) = -\\frac{1}{4}(1-y)$\n$\\frac{\\partial N_2}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1+x)(1-y)\\right) = \\frac{1}{4}(1-y)$\n$\\frac{\\partial N_3}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1+x)(1+y)\\right) = \\frac{1}{4}(1+y)$\n$\\frac{\\partial N_4}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1-x)(1+y)\\right) = -\\frac{1}{4}(1+y)$\n\nNext, we evaluate these derivatives at the specified Gauss point $(x_g, y_g) = (1/\\sqrt{3}, -1/\\sqrt{3})$:\n$\\frac{\\partial N_1}{\\partial x}\\bigg|_{(x_g, y_g)} = -\\frac{1}{4}(1 - (-\\frac{1}{\\sqrt{3}})) = -\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_2}{\\partial x}\\bigg|_{(x_g, y_g)} = \\frac{1}{4}(1 - (-\\frac{1}{\\sqrt{3}})) = \\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_3}{\\partial x}\\bigg|_{(x_g, y_g)} = \\frac{1}{4}(1 + (-\\frac{1}{\\sqrt{3}})) = \\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_4}{\\partial x}\\bigg|_{(x_g, y_g)} = -\\frac{1}{4}(1 + (-\\frac{1}{\\sqrt{3}})) = -\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})$\n\nFinally, we compute the sum for $\\varepsilon_v^h(x_g, y_g)$ using the nodal values $u_{xa} = \\{2, -2, 2, -2\\}$:\n$\\varepsilon_v^h = \\left(-\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})\\right)(2) + \\left(\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})\\right)(-2) + \\left(\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})\\right)(2) + \\left(-\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})\\right)(-2)$\n$\\varepsilon_v^h = -\\frac{1}{2}(1 + \\frac{1}{\\sqrt{3}}) - \\frac{1}{2}(1 + \\frac{1}{\\sqrt{3}}) + \\frac{1}{2}(1 - \\frac{1}{\\sqrt{3}}) + \\frac{1}{2}(1 - \\frac{1}{\\sqrt{3}})$\n$\\varepsilon_v^h = -1 \\cdot (1 + \\frac{1}{\\sqrt{3}}) + 1 \\cdot (1 - \\frac{1}{\\sqrt{3}})$\n$\\varepsilon_v^h = -1 - \\frac{1}{\\sqrt{3}} + 1 - \\frac{1}{\\sqrt{3}}$\n$\\varepsilon_v^h = -\\frac{2}{\\sqrt{3}}$\n\nTo express the result with a rational denominator:\n$\\varepsilon_v^h = -\\frac{2\\sqrt{3}}{3}$\n\nThis non-zero result for the discrete volumetric strain, which arises from a continuous field that is perfectly incompressible ($\\nabla \\cdot \\mathbf{u} = 0$), is a manifestation of the phenomenon known as volumetric locking in low-order finite elements.", "answer": "$$\n\\boxed{-\\frac{2\\sqrt{3}}{3}}\n$$", "id": "2609062"}, {"introduction": "Adopting a mixed formulation is the first step, but not just any combination of displacement and pressure interpolations will work. A stable pairing must satisfy the crucial Ladyzhenskaya–Babuška–Brezzi (LBB) condition to avoid contaminating the solution with non-physical pressure oscillations. This exercise demonstrates the failure of the seemingly intuitive equal-order $Q_1/Q_1$ element pairing by having you analyze a 'checkerboard' pressure mode, a classic example of a spurious mode that leads to numerical instability [@problem_id:2609028].", "problem": "Consider the mixed displacement–pressure formulation of linear elasticity for a nearly incompressible solid on the square domain $\\Omega = [0,1]\\times[0,1]$. Let the displacement be $\\mathbf{u} = (u_x,u_y)$ and the pressure be $p$, with the incompressibility constraint enforced weakly through the bilinear form $b(q,\\mathbf{v}) = \\int_{\\Omega} q\\,\\nabla\\cdot \\mathbf{v}\\,d\\Omega$. Discretize $\\Omega$ with a uniform, structured mesh of $N_x \\times N_y$ congruent bilinear quadrilateral elements, and use equal-order bilinear shape functions ($Q_1/Q_1$) for both displacement and pressure. Assemble the discrete coupling operator $B$ corresponding to $b(\\cdot,\\cdot)$ by applying a one-point Gauss quadrature rule per element for the coupling term only, that is, approximate\n$$\n\\int_{\\Omega_e} \\phi_m\\,\\nabla\\cdot\\mathbf{v}\\,d\\Omega \\approx A_e\\,\\phi_m(\\mathbf{x}_e)\\,\\nabla\\cdot\\mathbf{v}(\\mathbf{x}_e),\n$$\nwhere $\\Omega_e$ is an element, $A_e$ is its area, $\\mathbf{x}_e$ is its centroid, and $\\phi_m$ is a nodal bilinear pressure shape function.\n\nIndex the mesh nodes by integer pairs $(i,j)$ with $i=0,\\dots,N_x$ and $j=0,\\dots,N_y$, and define the nodal pressure vector $\\mathbf{p}^{\\mathrm{cb}}$ (a checkerboard pressure mode) by\n$$\np_{i,j}^{\\mathrm{cb}} = (-1)^{i+j}.\n$$\nLet $\\|\\cdot\\|_2$ denote the Euclidean norm and let $B^T$ be the transpose of $B$. Using only the definitions above and the stated quadrature, compute the exact value of the squared Euclidean norm\n$$\n\\bigl\\|B^{T}\\,\\mathbf{p}^{\\mathrm{cb}}\\bigr\\|_2^{2}.\n$$\nExpress your final result as a pure number (no units). No rounding is required.", "solution": "The problem asks for the computation of the squared Euclidean norm of the vector $B^{T}\\,\\mathbf{p}^{\\mathrm{cb}}$, where $B$ is the discrete coupling operator in a mixed finite element formulation, and $\\mathbf{p}^{\\mathrm{cb}}$ is a specific nodal pressure vector known as the checkerboard mode.\n\nLet $\\mathbf{d}$ be the vector of global nodal displacement degrees of freedom and $\\mathbf{p}$ be the vector of global nodal pressure degrees of freedom. The discrete weak form of the incompressibility constraint is given by $\\mathbf{p}^{T} B \\mathbf{d}$, which corresponds to the bilinear form $b(p_h, \\mathbf{u}_h) = \\int_{\\Omega} p_h \\nabla \\cdot \\mathbf{u}_h \\, d\\Omega$. Here, $p_h$ and $\\mathbf{u}_h$ are the finite element approximations of the pressure and displacement fields, respectively.\n\nThe vector $B^{T} \\mathbf{p}$ can be interpreted as a vector of generalized forces acting on the displacement degrees of freedom, arising from the pressure field $\\mathbf{p}$. Let us denote this force vector as $\\mathbf{F} = B^{T} \\mathbf{p}$. The component of this vector corresponding to the $x$-displacement at a node $k$ is $F_{x,k}$, and for the $y$-displacement is $F_{y,k}$. These components are found by evaluating the weak form with test functions corresponding to a single degree of freedom. Let $N_k(\\mathbf{x})$ be the scalar bilinear shape function associated with node $k$. The vector shape functions for the displacement at node $k$ are $\\mathbf{N}_{k,x} = (N_k, 0)^T$ and $\\mathbf{N}_{k,y} = (0, N_k)^T$.\n\nThe component $F_{x,k}$ is obtained by setting the displacement field to $\\mathbf{u}_h = \\mathbf{N}_{k,x}$ and the pressure field to $p_h^{\\mathrm{cb}}(\\mathbf{x}) = \\sum_{m} p_{m}^{\\mathrm{cb}} N_m(\\mathbf{x})$, where $p_m^{\\mathrm{cb}}$ are the nodal values of the checkerboard pressure vector.\n$$\nF_{x,k} = \\int_{\\Omega} p_h^{\\mathrm{cb}}(\\mathbf{x}) (\\nabla \\cdot \\mathbf{N}_{k,x}) \\, d\\Omega = \\int_{\\Omega} p_h^{\\mathrm{cb}}(\\mathbf{x}) \\frac{\\partial N_k}{\\partial x} \\, d\\Omega\n$$\nSimilarly, for the $y$-component:\n$$\nF_{y,k} = \\int_{\\Omega} p_h^{\\mathrm{cb}}(\\mathbf{x}) (\\nabla \\cdot \\mathbf{N}_{k,y}) \\, d\\Omega = \\int_{\\Omega} p_h^{\\mathrm{cb}}(\\mathbf{x}) \\frac{\\partial N_k}{\\partial y} \\, d\\Omega\n$$\nThe integral over the domain $\\Omega$ is computed by summing contributions from all elements $\\Omega_e$:\n$$\nF_{x,k} = \\sum_{e} \\int_{\\Omega_e} p_h^{\\mathrm{cb}}(\\mathbf{x}) \\frac{\\partial N_k}{\\partial x} \\, d\\Omega\n$$\nThe problem specifies that the coupling term is evaluated using a one-point Gauss quadrature rule at the centroid $\\mathbf{x}_e$ of each element. This means the integral over each element is approximated as:\n$$\n\\int_{\\Omega_e} p_h^{\\mathrm{cb}}(\\mathbf{x}) \\frac{\\partial N_k}{\\partial x} \\, d\\Omega \\approx A_e \\left( p_h^{\\mathrm{cb}}(\\mathbf{x}_e) \\frac{\\partial N_k}{\\partial x}(\\mathbf{x}_e) \\right)\n$$\nwhere $A_e$ is the area of element $\\Omega_e$. The support of the shape function $N_k$ and its derivatives is limited to the elements adjacent to node $k$. Thus, the sum for $F_{x,k}$ only includes contributions from these adjacent elements.\n$$\nF_{x,k} \\approx \\sum_{e | k \\in \\text{nodes}(e)} A_e \\, p_h^{\\mathrm{cb}}(\\mathbf{x}_e) \\frac{\\partial N_k}{\\partial x}(\\mathbf{x}_e)\n$$\nAn identical expression holds for $F_{y,k}$. The core of the problem now reduces to evaluating the interpolated pressure $p_h^{\\mathrm{cb}}(\\mathbf{x}_e)$ at the centroid of an arbitrary element $\\Omega_e$.\n\nFor a bilinear quadrilateral element ($Q_1$), the value of an interpolated function at the element centroid is the arithmetic mean of its values at the four corner nodes. Let the four local nodes of element $\\Omega_e$ be indexed by $a=1,2,3,4$. The interpolated pressure at the centroid $\\mathbf{x}_e$ is:\n$$\np_h^{\\mathrm{cb}}(\\mathbf{x}_e) = \\sum_{a=1}^{4} p_{a}^{\\mathrm{cb}} N_a(\\mathbf{x}_e) = \\frac{1}{4} \\sum_{a=1}^{4} p_{a}^{\\mathrm{cb}}\n$$\nwhere $p_{a}^{\\mathrm{cb}}$ are the nodal pressure values at the four corners of element $\\Omega_e$.\n\nThe problem defines the checkerboard pressure mode by the nodal values $p_{i,j}^{\\mathrm{cb}} = (-1)^{i+j}$, where $(i,j)$ are the integer indices of a node in the structured mesh, for $i=0,\\dots,N_x$ and $j=0,\\dots,N_y$. Consider a generic element $\\Omega_e$ whose bottom-left node has indices $(i,j)$. Its four nodes are $(i,j)$, $(i+1,j)$, $(i+1,j+1)$, and $(i,j+1)$. The corresponding nodal pressures are:\n\\begin{itemize}\n    \\item $p_{i,j}^{\\mathrm{cb}} = (-1)^{i+j}$\n    \\item $p_{i+1,j}^{\\mathrm{cb}} = (-1)^{(i+1)+j} = -(-1)^{i+j}$\n    \\item $p_{i+1,j+1}^{\\mathrm{cb}} = (-1)^{(i+1)+(j+1)} = (-1)^{i+j+2} = (-1)^{i+j}$\n    \\item $p_{i,j+1}^{\\mathrm{cb}} = (-1)^{i+(j+1)} = -(-1)^{i+j}$\n\\end{itemize}\nThe sum of these four nodal pressure values is:\n$$\n\\sum_{a=1}^{4} p_{a}^{\\mathrm{cb}} = (-1)^{i+j} - (-1)^{i+j} + (-1)^{i+j} - (-1)^{i+j} = 0\n$$\nSince the sum of the nodal values is zero, the interpolated pressure at the centroid of any element is also zero:\n$$\np_h^{\\mathrm{cb}}(\\mathbf{x}_e) = \\frac{1}{4} \\cdot 0 = 0\n$$\nThis holds for every element $\\Omega_e$ in the mesh.\n\nNow we substitute this result back into the expressions for the nodal force components $F_{x,k}$ and $F_{y,k}$. For any node $k$:\n$$\nF_{x,k} = \\sum_{e | k \\in \\text{nodes}(e)} A_e \\cdot (0) \\cdot \\frac{\\partial N_k}{\\partial x}(\\mathbf{x}_e) = 0\n$$\n$$\nF_{y,k} = \\sum_{e | k \\in \\text{nodes}(e)} A_e \\cdot (0) \\cdot \\frac{\\partial N_k}{\\partial y}(\\mathbf{x}_e) = 0\n$$\nSince all components of the vector $\\mathbf{F} = B^{T}\\mathbf{p}^{\\mathrm{cb}}$ are zero, the vector itself is the zero vector:\n$$\nB^{T}\\mathbf{p}^{\\mathrm{cb}} = \\mathbf{0}\n$$\nThe squared Euclidean norm of the zero vector is, by definition, zero.\n$$\n\\bigl\\|B^{T}\\,\\mathbf{p}^{\\mathrm{cb}}\\bigr\\|_2^{2} = \\|\\mathbf{0}\\|_2^{2} = 0\n$$\nThis result demonstrates that the checkerboard pressure mode lies in the null space of the discrete divergence operator $B^T$ when using $Q_1/Q_1$ elements with one-point quadrature. This is a classic example of a spurious pressure mode leading to the failure of the Ladyzhenskaya–Babuška–Brezzi (LBB) stability condition for this element choice and quadrature rule.", "answer": "$$\\boxed{0}$$", "id": "2609028"}, {"introduction": "Having explored the pitfalls of locking and instability, we can now appreciate the nuances between different methods designed to handle near-incompressibility. This practice provides a quantitative comparison between a stable mixed $u$-$p$ formulation (using a $Q_1/P_0$ element), the penalty method, and the augmented Lagrangian approach within a controlled single-element benchmark. By computing the pressure error for each method against a known exact solution, you will gain practical insight into their differing behaviors and the superior pressure accuracy often afforded by a well-posed mixed formulation [@problem_id:2609074].", "problem": "Consider the small-strain, isotropic, linear elasticity model in two dimensions under the displacement–pressure mixed formulation for nearly incompressible materials. Let the computational domain be the unit square $\\Omega = [0,1]\\times[0,1]$. The unknown fields are the displacement $\\mathbf{u} = (u_x,u_y)$ and the pressure $p$. The standard mixed weak form for a nearly incompressible material with bulk modulus $K$ and shear modulus $\\mu$ (not directly used in the pressure equation below) reads: find $\\mathbf{u}$ and $p$ such that for all admissible virtual fields $\\mathbf{v}$ and $q$,\n$$\n\\int_{\\Omega} 2\\mu\\,\\varepsilon(\\mathbf{u}):\\varepsilon(\\mathbf{v})\\,\\mathrm{d}\\Omega \\;-\\; \\int_{\\Omega} p\\,\\nabla\\cdot\\mathbf{v}\\,\\mathrm{d}\\Omega \\;=\\; \\int_{\\Omega}\\mathbf{f}\\cdot\\mathbf{v}\\,\\mathrm{d}\\Omega,\n$$\n$$\n-\\int_{\\Omega} q\\,\\nabla\\cdot\\mathbf{u}\\,\\mathrm{d}\\Omega \\;-\\; \\frac{1}{K}\\int_{\\Omega} p\\,q\\,\\mathrm{d}\\Omega \\;=\\; 0.\n$$\nHere $\\varepsilon(\\mathbf{u})$ is the symmetric gradient of $\\mathbf{u}$, $\\mathbf{f}$ is the body force (taken as zero in this benchmark), and $K$ is assumed large (nearly incompressible regime).\n\nTo isolate and compare the pressure behavior of three stabilization strategies—mixed $u$–$p$, penalty, and augmented Lagrangian—we consider a single four-node bilinear ($Q_1$) finite element covering $\\Omega$ with nodal coordinates at $(0,0)$, $(1,0)$, $(1,1)$, and $(0,1)$. The discrete displacement field $\\mathbf{u}_h$ is fixed by Dirichlet conditions at these four nodes, taken from a manufactured divergence-free exact field constructed from a stream function. Specifically, for a given amplitude parameter $a$, define the stream function\n$$\n\\psi(x,y) \\;=\\; a\\,x^2 y \\;-\\; a\\,x y^2,\n$$\nand set the exact displacement field by\n$$\n\\mathbf{u}_{\\text{exact}}(x,y) \\;=\\; \\Big(\\frac{\\partial \\psi}{\\partial y}(x,y),\\,-\\frac{\\partial \\psi}{\\partial x}(x,y)\\Big) \\;=\\; \\big(a\\,x^2 - 2a\\,x\\,y,\\,-2a\\,x\\,y + a\\,y^2\\big).\n$$\nThis field satisfies $\\nabla\\cdot \\mathbf{u}_{\\text{exact}} \\equiv 0$. Impose $\\mathbf{u}_h$ at the $Q_1$ element nodes by sampling $\\mathbf{u}_{\\text{exact}}$ at the four corners; thus $\\mathbf{u}_h$ is the bilinear interpolant of these nodal values. Because $\\mathbf{u}_{\\text{exact}}$ is quadratic, $\\mathbf{u}_h$ will not generally be exactly divergence-free in the element interior, i.e., $\\nabla\\cdot\\mathbf{u}_h \\neq 0$, thereby producing a nonzero discrete pressure in the nearly incompressible limit. The exact pressure is taken as $p_{\\text{exact}} \\equiv 0$.\n\nDefine and compare the following three discrete pressure reconstructions:\n\n- Mixed $u$–$p$ method with piecewise-constant pressure ($P_0$ on the single element): With $q \\equiv 1$ constant, the pressure $p_{\\text{mix}}$ is determined by the second equation of the mixed system as\n$$\np_{\\text{mix}} \\;=\\; -K\\,\\frac{1}{|\\Omega|}\\int_{\\Omega} \\nabla\\cdot\\mathbf{u}_h\\,\\mathrm{d}\\Omega,\n$$\ni.e., $p_{\\text{mix}}$ equals $-K$ times the average divergence of $\\mathbf{u}_h$ over the element.\n\n- Penalty method: A displacement-only formulation penalizes the volumetric strain via the energy term $\\frac{K}{2}\\int_{\\Omega} (\\nabla\\cdot\\mathbf{u}_h)^2\\,\\mathrm{d}\\Omega$. A commonly used pressure surrogate is the pointwise relation\n$$\np_{\\text{pen}}(x,y) \\;=\\; -K\\,\\nabla\\cdot\\mathbf{u}_h(x,y),\n$$\nwhich is not constant over the element in general.\n\n- Augmented Lagrangian method: Using the standard augmented Lagrangian functional for the compressible mixed system, the stationarity conditions at convergence recover the same discrete pressure as the mixed method (for the same pressure space), i.e.,\n$$\np_{\\text{aug}} \\;=\\; p_{\\text{mix}} \\;=\\; -K\\,\\frac{1}{|\\Omega|}\\int_{\\Omega} \\nabla\\cdot\\mathbf{u}_h\\,\\mathrm{d}\\Omega.\n$$\n\nFor each method, quantify the pressure accuracy by the $L^2$-norm of the pressure error against $p_{\\text{exact}} \\equiv 0$:\n- For the mixed and augmented Lagrangian methods (constant pressure over the element),\n$$\n\\|p_{\\bullet} - p_{\\text{exact}}\\|_{L^2(\\Omega)} \\;=\\; |p_{\\bullet}|\\,\\sqrt{|\\Omega|} \\;=\\; |K|\\,\\Big|\\frac{1}{|\\Omega|}\\int_{\\Omega}\\nabla\\cdot\\mathbf{u}_h\\,\\mathrm{d}\\Omega\\Big|.\n$$\n- For the penalty method,\n$$\n\\|p_{\\text{pen}} - p_{\\text{exact}}\\|_{L^2(\\Omega)} \\;=\\; \\Big(\\int_{\\Omega} K^2\\,(\\nabla\\cdot\\mathbf{u}_h)^2\\,\\mathrm{d}\\Omega\\Big)^{1/2}.\n$$\n\nNumerical integration: Use the standard $2\\times 2$ Gauss quadrature on the reference square $[-1,1]\\times[-1,1]$, with points at $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$ and product weights $1$. Map to the physical element $\\Omega$ via the affine mapping $x = (\\xi+1)/2$, $y = (\\eta+1)/2$. The Jacobian determinant is constant $|\\det J| = 1/4$ and the element area is $|\\Omega| = 1$. The $Q_1$ shape functions and their derivatives with respect to the reference coordinates $(\\xi,\\eta)$ should be used to compute $\\nabla\\cdot\\mathbf{u}_h$ at quadrature points; derivatives with respect to physical coordinates follow from the affine map scaling factors.\n\nAll quantities are nondimensional. Your program must:\n- Construct $\\mathbf{u}_h$ by sampling $\\mathbf{u}_{\\text{exact}}$ at the four $Q_1$ nodes for the given amplitude $a$.\n- Compute $\\nabla\\cdot\\mathbf{u}_h$ at the four Gauss points.\n- Assemble the average divergence and the $L^2$ integral using the given quadrature.\n- Compute the $L^2$ pressure error for each method as defined above.\n\nTest suite: Evaluate the $L^2$ pressure error for the following five cases, each specified by a tuple (method, $K$, $a$). For the augmented Lagrangian case, include an augmentation parameter $r$ in the description, but note that for the fully converged solution with the same pressure space it does not change the result.\n- Case $1$: (\"mixed\", $K = 10^5$, $a = 2\\times 10^{-1}$).\n- Case $2$: (\"penalty\", $K = 10^5$, $a = 2\\times 10^{-1}$).\n- Case $3$: (\"augmented\", $K = 10^5$, $a = 2\\times 10^{-1}$, $r = 10^3$; result equals the mixed method for the same $(K,a)$).\n- Case $4$: (\"penalty\", $K = 10^5$, $a = 0$).\n- Case $5$: (\"penalty\", $K = 10^9$, $a = 2\\times 10^{-1}$).\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, i.e., $[e_1,e_2,e_3,e_4,e_5]$, where $e_i$ is the $L^2$ pressure error (a floating-point number) for case $i$.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in the principles of continuum mechanics and the finite element method, is well-posed with a clear objective, and provides all necessary information for a unique solution. The problem is a standard numerical benchmark for comparing pressure stabilization techniques in nearly incompressible elasticity.\n\nWe shall proceed with a complete analytical derivation. The solution requires computing two key integrals over the domain $\\Omega = [0,1]\\times[0,1]$: the average divergence of the discrete displacement field, $\\frac{1}{|\\Omega|}\\int_{\\Omega} \\nabla\\cdot\\mathbf{u}_h\\,\\mathrm{d}\\Omega$, and the $L^2$-norm of the divergence, $(\\int_{\\Omega} (\\nabla\\cdot\\mathbf{u}_h)^2\\,\\mathrm{d}\\Omega)^{1/2}$.\n\nFirst, we establish the discrete displacement field $\\mathbf{u}_h$. The problem defines a single four-node bilinear ($Q_1$) element over the unit square $\\Omega$, with nodes at $N_1(0,0)$, $N_2(1,0)$, $N_3(1,1)$, and $N_4(0,1)$. The discrete displacement field $\\mathbf{u}_h$ is the $Q_1$ interpolant of the exact displacement field $\\mathbf{u}_{\\text{exact}}$ evaluated at these four nodes.\n\nThe exact displacement field is given by $\\mathbf{u}_{\\text{exact}}(x,y) = (a\\,x^2 - 2a\\,x\\,y,\\,-2a\\,x\\,y + a\\,y^2)$.\nEvaluating at the four nodal coordinates provides the nodal displacement vectors $\\mathbf{u}_i = (u_{i,x}, u_{i,y})$:\n$$\n\\mathbf{u}_1 = \\mathbf{u}_{\\text{exact}}(0,0) = (0, 0)\n$$\n$$\n\\mathbf{u}_2 = \\mathbf{u}_{\\text{exact}}(1,0) = (a, 0)\n$$\n$$\n\\mathbf{u}_3 = \\mathbf{u}_{\\text{exact}}(1,1) = (a-2a, -2a+a) = (-a, -a)\n$$\n$$\n\\mathbf{u}_4 = \\mathbf{u}_{\\text{exact}}(0,1) = (0, a)\n$$\n\nThe $Q_1$ shape functions for the physical element $\\Omega = [0,1]\\times[0,1]$ are:\n$$\nN_1(x,y) = (1-x)(1-y)\n$$\n$$\nN_2(x,y) = x(1-y)\n$$\n$$\nN_3(x,y) = xy\n$$\n$$\nN_4(x,y) = (1-x)y\n$$\nThe interpolated displacement field $\\mathbf{u}_h(x,y) = \\sum_{i=1}^4 N_i(x,y) \\mathbf{u}_i$ is computed component-wise:\n$$\nu_{h,x}(x,y) = \\sum_{i=1}^4 N_i u_{i,x} = N_1(0) + N_2(a) + N_3(-a) + N_4(0) = a(N_2 - N_3)\n$$\n$$\nu_{h,y}(x,y) = \\sum_{i=1}^4 N_i u_{i,y} = N_1(0) + N_2(0) + N_3(-a) + N_4(a) = a(N_4 - N_3)\n$$\nSubstituting the shape function expressions:\n$$\nu_{h,x}(x,y) = a(x(1-y) - xy) = a(x - 2xy)\n$$\n$$\nu_{h,y}(x,y) = a((1-x)y - xy) = a(y - 2xy)\n$$\n\nNext, we compute the divergence of this discrete field, $\\nabla \\cdot \\mathbf{u}_h = \\frac{\\partial u_{h,x}}{\\partial x} + \\frac{\\partial u_{h,y}}{\\partial y}$:\n$$\n\\frac{\\partial u_{h,x}}{\\partial x} = \\frac{\\partial}{\\partial x} a(x-2xy) = a(1-2y)\n$$\n$$\n\\frac{\\partial u_{h,y}}{\\partial y} = \\frac{\\partial}{\\partial y} a(y-2xy) = a(1-2x)\n$$\nThe divergence is therefore:\n$$\n\\nabla \\cdot \\mathbf{u}_h(x,y) = a(1-2y) + a(1-2x) = 2a(1-x-y)\n$$\nThis represents the pointwise divergence of the interpolated displacement field as a function of position $(x,y)$ within the element.\n\nWith the expression for the divergence, we can compute the required integrals.\nFirst, the average divergence over the element area $|\\Omega|=1$:\n$$\n\\frac{1}{|\\Omega|}\\int_{\\Omega} \\nabla\\cdot\\mathbf{u}_h\\,\\mathrm{d}\\Omega = \\int_0^1 \\int_0^1 2a(1-x-y)\\,\\mathrm{d}x\\mathrm{d}y\n$$\n$$\n= 2a \\int_0^1 \\left[x - \\frac{x^2}{2} - xy\\right]_{x=0}^{x=1} \\mathrm{d}y = 2a \\int_0^1 \\left(1 - \\frac{1}{2} - y\\right) \\mathrm{d}y = 2a \\int_0^1 \\left(\\frac{1}{2} - y\\right) \\mathrm{d}y\n$$\n$$\n= 2a \\left[\\frac{y}{2} - \\frac{y^2}{2}\\right]_{y=0}^{y=1} = 2a \\left(\\frac{1}{2} - \\frac{1}{2}\\right) = 0\n$$\nThe average divergence of the discrete displacement field is exactly zero.\n\nSecond, the integral of the squared divergence:\n$$\n\\int_{\\Omega} (\\nabla\\cdot\\mathbf{u}_h)^2\\,\\mathrm{d}\\Omega = \\int_0^1 \\int_0^1 (2a(1-x-y))^2\\,\\mathrm{d}x\\mathrm{d}y = 4a^2 \\int_0^1 \\int_0^1 (1-x-y)^2\\,\\mathrm{d}x\\mathrm{d}y\n$$\nThe integrand is $(1-x-y)^2 = 1 + x^2 + y^2 - 2x - 2y + 2xy$.\n$$\n\\int_0^1 (1 + x^2 + y^2 - 2x - 2y + 2xy)\\,\\mathrm{d}x = \\left[x + \\frac{x^3}{3} + y^2x - x^2 - 2yx + x^2y\\right]_{x=0}^{x=1} = 1 + \\frac{1}{3} + y^2 - 1 - 2y + y = \\frac{1}{3} + y^2 - y\n$$\n$$\n\\int_0^1 \\left(\\frac{1}{3} + y^2 - y\\right)\\,\\mathrm{d}y = \\left[\\frac{y}{3} + \\frac{y^3}{3} - \\frac{y^2}{2}\\right]_{y=0}^{y=1} = \\frac{1}{3} + \\frac{1}{3} - \\frac{1}{2} = \\frac{2}{3} - \\frac{1}{2} = \\frac{1}{6}\n$$\nThus, the integral of the squared divergence is:\n$$\n\\int_{\\Omega} (\\nabla\\cdot\\mathbf{u}_h)^2\\,\\mathrm{d}\\Omega = 4a^2 \\left(\\frac{1}{6}\\right) = \\frac{2a^2}{3}\n$$\nNote that the integrands $\\nabla\\cdot\\mathbf{u}_h$ and $(\\nabla\\cdot\\mathbf{u}_h)^2$ are low-order polynomials. The specified $2\\times 2$ Gauss quadrature rule is exact for polynomials of degree up to $3$ in each coordinate direction of the reference element. The analytical integration performed here is therefore equivalent to the result that would be obtained via the specified numerical quadrature rule.\n\nNow we can evaluate the $L^2$-norm of the pressure error for each method.\n\nFor the mixed ($p_{\\text{mix}}$) and augmented Lagrangian ($p_{\\text{aug}}$) methods, the constant pressure is given by $p_{\\bullet} = -K\\,\\frac{1}{|\\Omega|}\\int_{\\Omega} \\nabla\\cdot\\mathbf{u}_h\\,\\mathrm{d}\\Omega$. Since the average divergence is zero, $p_{\\text{mix}} = p_{\\text{aug}} = 0$. The exact pressure is $p_{\\text{exact}} = 0$. The error is:\n$$\n\\|p_{\\bullet} - p_{\\text{exact}}\\|_{L^2(\\Omega)} = \\|0 - 0\\|_{L^2(\\Omega)} = 0\n$$\n\nFor the penalty method, the pressure surrogate is $p_{\\text{pen}}(x,y) = -K\\,\\nabla\\cdot\\mathbf{u}_h(x,y)$. The $L^2$-error is:\n$$\n\\|p_{\\text{pen}} - p_{\\text{exact}}\\|_{L^2(\\Omega)} = \\|-K\\,\\nabla\\cdot\\mathbf{u}_h - 0\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} K^2 (\\nabla\\cdot\\mathbf{u}_h)^2\\,\\mathrm{d}\\Omega\\right)^{1/2}\n$$\n$$\n= |K| \\left(\\int_{\\Omega} (\\nabla\\cdot\\mathbf{u}_h)^2\\,\\mathrm{d}\\Omega\\right)^{1/2} = |K| \\left(\\frac{2a^2}{3}\\right)^{1/2} = |K| |a| \\sqrt{\\frac{2}{3}}\n$$\n\nThese derived formulas are now applied to the specified test cases.\nCase 1: (method=\"mixed\", $K = 10^5$, $a = 0.2$)\nError = $0$.\n\nCase 2: (method=\"penalty\", $K = 10^5$, $a = 0.2$)\nError = $(10^5)(0.2)\\sqrt{2/3} = 20000 \\sqrt{2/3} \\approx 16329.9316$.\n\nCase 3: (method=\"augmented\", $K = 10^5$, $a = 0.2$)\nThe pressure is identical to the mixed method. Error = $0$.\n\nCase 4: (method=\"penalty\", $K = 10^5$, $a = 0$)\nIf $a=0$, $\\mathbf{u}_{\\text{exact}} \\equiv \\mathbf{0}$, thus $\\mathbf{u}_h \\equiv \\mathbf{0}$, and $\\nabla \\cdot \\mathbf{u}_h \\equiv 0$. Error = $0$.\n\nCase 5: (method=\"penalty\", $K = 10^9$, $a = 0.2$)\nError = $(10^9)(0.2)\\sqrt{2/3} = 2 \\times 10^8 \\sqrt{2/3} \\approx 163299316.185$.\n\nThis analysis demonstrates a key property of the Q1/P0 element pair. The interpolation of the quadratic field results in a discrete divergence field whose average is zero, leading to a zero constant pressure locking-free prediction. The penalty method, by contrast, retains the local (non-zero) divergence information, leading to a non-zero pressure error.", "answer": "[0.0,16329.93161855452,0.0,0.0,163299316.1855452]", "id": "2609074"}]}