{"hands_on_practices": [{"introduction": "The Mindlin plate model simplifies 3D reality by using an equivalent, uniform shear strain through the plate's thickness. This simplification requires a shear correction factor, $\\kappa$, to maintain energy consistency with the true, non-uniform shear stress distribution. This exercise [@problem_id:2558519] guides you through the classic derivation of $\\kappa$ for a rectangular cross-section by equating the shear strain energy of the Mindlin model with that of the exact 3D elasticity solution, providing a deep insight into the physical foundation of the theory.", "problem": "An isotropic, homogeneous Mindlin–Reissner plate (first-order shear deformation theory) of thickness $t$ is subjected to a transverse shear resultant per unit length $V$ in the $x$-direction. In the finite element formulation of Mindlin plates, the transverse shear strain energy is represented using an equivalent constant shear strain through the thickness multiplied by a shear correction factor $\\kappa$ to account for the true, nonuniform three-dimensional shear stress distribution. The goal of this problem is to calibrate $\\kappa$ by enforcing energy equivalence with the exact Three-Dimensional (3D) Saint-Venant solution for a rectangular cross section.\n\nStarting only from fundamental principles of linear elasticity and work conjugacy:\n- The linear elastic shear strain energy density is $u = \\tau^{2} / (2 G)$, where $G$ is the shear modulus.\n- The shear resultant $V$ is the area integral of the shear traction, $V = \\int_{A} \\tau \\,\\mathrm{d}A$.\n- In the Mindlin–Reissner plate idealization under a uniaxial shear state, an equivalent uniform transverse shear strain $\\bar{\\gamma}$ is introduced so that the shear strain energy per unit length is represented with a single scalar $\\kappa$.\n\nConsider a long prismatic strip of the plate of width $b$ (in the $y$-direction), thickness $t$ (in the $z$-direction), and unit length in $x$, carrying a constant shear resultant $V$ in the $x$-direction. Let $z$ be measured from the mid-surface, $z \\in [-t/2, t/2]$. Use the exact Saint-Venant shear stress distribution for a rectangular cross section under transverse shear,\n$$\n\\tau_{xz}(z) \\;=\\; \\frac{3}{2}\\,\\frac{V}{A}\\left(1 - \\frac{4 z^{2}}{t^{2}}\\right), \\quad A = b\\,t,\n$$\nto compute the exact 3D shear strain energy per unit length. Then, model the same state in the Mindlin–Reissner sense with an equivalent constant shear strain $\\bar{\\gamma}$ and an unknown correction factor $\\kappa$, derive the Mindlin shear energy per unit length by work conjugacy, and enforce energy equivalence to identify $\\kappa$.\n\nProvide the final value of $\\kappa$ for a rectangular cross section as an exact fraction. No rounding is required. The final answer must be given as a single exact number without units.", "solution": "The problem as stated is valid. It is scientifically sound, self-contained, and presents a well-posed question standard to the field of solid mechanics. We proceed directly to the derivation.\n\nThe task is to find the shear correction factor $\\kappa$ by equating the shear strain energy per unit length from two models: a rigorous 3D elasticity model and the simplified Mindlin-Reissner plate model.\n\nFirst, we calculate the exact shear strain energy per unit length, which we denote $U_\\mathrm{3D}$, based on the provided Saint-Venant shear stress distribution for a rectangular cross-section. The strain energy density is $u = \\frac{\\tau_{xz}^{2}}{2G}$. The total energy per unit length is the integral of $u$ over the cross-sectional area $A=bt$.\n$$\nU_\\mathrm{3D} = \\int_{A} u \\, \\mathrm{d}A = \\int_{-b/2}^{b/2} \\int_{-t/2}^{t/2} \\frac{\\tau_{xz}^{2}(z)}{2G} \\, \\mathrm{d}z \\, \\mathrm{d}y\n$$\nSince $\\tau_{xz}$ does not depend on the $y$-coordinate, the integration over the width $b$ simplifies to a multiplicative factor.\n$$\nU_\\mathrm{3D} = \\frac{b}{2G} \\int_{-t/2}^{t/2} \\left[ \\tau_{xz}(z) \\right]^2 \\mathrm{d}z\n$$\nSubstituting the given stress distribution, $\\tau_{xz}(z) = \\frac{3V}{2bt}\\left(1 - \\frac{4 z^{2}}{t^{2}}\\right)$:\n$$\nU_\\mathrm{3D} = \\frac{b}{2G} \\int_{-t/2}^{t/2} \\left[ \\frac{3V}{2bt} \\left(1 - \\frac{4z^2}{t^2}\\right) \\right]^2 \\mathrm{d}z\n$$\nWe extract the constant factors from the integral:\n$$\nU_\\mathrm{3D} = \\frac{b}{2G} \\left(\\frac{3V}{2bt}\\right)^2 \\int_{-t/2}^{t/2} \\left(1 - \\frac{4z^2}{t^2}\\right)^2 \\mathrm{d}z = \\frac{9V^2}{8Gbt^2} \\int_{-t/2}^{t/2} \\left(1 - \\frac{8z^2}{t^2} + \\frac{16z^4}{t^4}\\right) \\mathrm{d}z\n$$\nNow, we evaluate the definite integral. The integrand is an even function, so the integral from $-t/2$ to $t/2$ is twice the integral from $0$ to $t/2$.\n$$\n\\int_{-t/2}^{t/2} \\left(1 - \\frac{8z^2}{t^2} + \\frac{16z^4}{t^4}\\right) \\mathrm{d}z = 2 \\int_{0}^{t/2} \\left(1 - \\frac{8z^2}{t^2} + \\frac{16z^4}{t^4}\\right) \\mathrm{d}z\n$$\n$$\n= 2 \\left[ z - \\frac{8z^3}{3t^2} + \\frac{16z^5}{5t^4} \\right]_{0}^{t/2} = 2 \\left[ \\frac{t}{2} - \\frac{8(t^3/8)}{3t^2} + \\frac{16(t^5/32)}{5t^4} \\right]\n$$\n$$\n= 2 \\left( \\frac{t}{2} - \\frac{t}{3} + \\frac{t}{10} \\right) = 2t \\left( \\frac{15-10+3}{30} \\right) = 2t \\left( \\frac{8}{30} \\right) = \\frac{8t}{15}\n$$\nSubstituting this back into the expression for $U_\\mathrm{3D}$:\n$$\nU_\\mathrm{3D} = \\frac{9V^2}{8Gbt^2} \\left( \\frac{8t}{15} \\right) = \\frac{9V^2}{15Gbt} = \\frac{3V^2}{5G(bt)}\n$$\nSince $A = bt$, the exact shear strain energy per unit length is:\n$$\nU_\\mathrm{3D} = \\frac{3V^2}{5GA}\n$$\nSecond, we define the corresponding energy in the Mindlin-Reissner model, $U_\\mathrm{Mindlin}$. This model uses an equivalent constant shear strain $\\bar{\\gamma}$ across the thickness. The average shear stress is $\\bar{\\tau} = V/A$. The constitutive law relating these averaged quantities is:\n$$\n\\bar{\\tau} = \\kappa G \\bar{\\gamma}\n$$\nThe strain energy per unit length, derived from work conjugacy, is one-half the product of the shear resultant $V$ and the conjugate shear strain $\\bar{\\gamma}$:\n$$\nU_\\mathrm{Mindlin} = \\frac{1}{2} V \\bar{\\gamma}\n$$\nWe express $\\bar{\\gamma}$ in terms of $V$ using the constitutive relation: $\\bar{\\gamma} = \\frac{\\bar{\\tau}}{\\kappa G} = \\frac{V/A}{\\kappa G} = \\frac{V}{\\kappa G A}$. Substituting this into the energy expression gives:\n$$\nU_\\mathrm{Mindlin} = \\frac{1}{2} V \\left( \\frac{V}{\\kappa G A} \\right) = \\frac{V^2}{2 \\kappa G A}\n$$\nFinally, we enforce energy equivalence, $U_\\mathrm{3D} = U_\\mathrm{Mindlin}$:\n$$\n\\frac{3V^2}{5GA} = \\frac{V^2}{2 \\kappa G A}\n$$\nAssuming a non-trivial shear state where $V \\neq 0$, the terms $V^2$, $G$, and $A$ cancel.\n$$\n\\frac{3}{5} = \\frac{1}{2 \\kappa}\n$$\nSolving for $\\kappa$:\n$$\n6 \\kappa = 5 \\implies \\kappa = \\frac{5}{6}\n$$\nThis is the required value for the shear correction factor for a rectangular cross-section.", "answer": "$$\n\\boxed{\\frac{5}{6}}\n$$", "id": "2558519"}, {"introduction": "The finite element method discretizes continuous fields by interpolating them from nodal values using shape functions. A key step is calculating strains, which involves differentiating these interpolated fields. This practice [@problem_id:2558491] walks you through the fundamental mechanics of a four-node quadrilateral (Q4) element, from defining shape functions to using the isoparametric mapping to compute strain components at a specific point, solidifying your understanding of how discrete nodal data translates into continuous physical behavior.", "problem": "A Mindlin–Reissner plate element is modeled using the finite element method (FEM) with a four-node quadrilateral (Q4) isoparametric interpolation. The kinematic assumptions are that the in-plane displacements vary linearly through thickness with rotations, and that the transverse displacement is independent of thickness: the displacement field is defined by $u(x,y,z)=-z\\,\\theta_{x}(x,y)$, $v(x,y,z)=-z\\,\\theta_{y}(x,y)$, and $w(x,y)$, where $\\theta_{x}$ and $\\theta_{y}$ are the plate rotations about the $y$- and $x$-axes, respectively, and $w$ is the transverse deflection. The bending curvatures and transverse shear strains are defined as $\\kappa_{x}=-\\partial \\theta_{x}/\\partial x$, $\\kappa_{y}=-\\partial \\theta_{y}/\\partial y$, $\\kappa_{xy}=-(\\partial \\theta_{x}/\\partial y+\\partial \\theta_{y}/\\partial x)$, $\\gamma_{xz}=\\partial w/\\partial x-\\theta_{x}$, and $\\gamma_{yz}=\\partial w/\\partial y-\\theta_{y}$.\n\nConsider a single Q4 element covering the rectangle with physical coordinates $(x,y)$ having nodes at $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(2,0)$, $(x_{3},y_{3})=(2,1)$, and $(x_{4},y_{4})=(0,1)$. The natural coordinates are $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$. The element uses the standard bilinear isoparametric mapping and bilinear shape functions in $(\\xi,\\eta)$ for all three fields $(\\theta_{x},\\theta_{y},w)$.\n\nTasks:\n1) Construct the bilinear shape functions $N_{i}(\\xi,\\eta)$, $i=1,2,3,4$, for the Q4 element, and write the interpolations $\\theta_{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{x,i}$, $\\theta_{y}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{y,i}$, and $w(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,w_{i}$.\n2) Using the isoparametric mapping, explain how spatial derivatives with respect to $x$ and $y$ enter the bending and shear strain–displacement matrices $B_{b}$ and $B_{s}$. Your explanation should express the bending curvatures $\\kappa_{x}$, $\\kappa_{y}$, $\\kappa_{xy}$ and the transverse shear strains $\\gamma_{xz}$, $\\gamma_{yz}$ in terms of derivatives of shape functions with respect to the physical coordinates and the nodal degrees of freedom.\n3) For the nodal values $w_{1}=0$, $w_{2}=2$, $w_{3}=4$, $w_{4}=2$ and $\\theta_{x,1}=0$, $\\theta_{x,2}=0.2$, $\\theta_{x,3}=0.4$, $\\theta_{x,4}=0.2$, compute the transverse shear strain $\\gamma_{xz}$ at the element center $(\\xi,\\eta)=(0,0)$. Express your final answer as an exact number. The quantity $\\gamma_{xz}$ is dimensionless.", "solution": "The problem statement presented is scientifically grounded, self-contained, and well-posed. It outlines a standard procedure in the finite element analysis of Mindlin plates, providing all necessary definitions, geometry, and data for a complete solution. Therefore, the problem is valid. The solution is constructed according to the three specified tasks.\n\n1) The four-node quadrilateral element ($Q4$) uses bilinear shape functions in the natural coordinate system $(\\xi,\\eta) \\in [-1,1]\\times[-1,1]$. The node numbering in the problem corresponds to the standard counter-clockwise numbering in the natural coordinate system as follows: node $1$ at $(\\xi,\\eta)=(-1,-1)$, node $2$ at $(\\xi,\\eta)=(1,-1)$, node $3$ at $(\\xi,\\eta)=(1,1)$, and node $4$ at $(\\xi,\\eta)=(-1,1)$. The general form of the shape function for node $i$ with natural coordinates $(\\xi_i, \\eta_i)$ is $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)$.\n\nThe explicit forms of the four shape functions are:\n$N_{1}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta)$\n$N_{2}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta)$\n$N_{3}(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta)$\n$N_{4}(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta)$\n\nThe displacement fields (rotations $\\theta_x, \\theta_y$ and transverse deflection $w$) are interpolated from the nodal degrees of freedom using these shape functions. Let the nodal degrees of freedom for node $i$ be $\\theta_{x,i}$, $\\theta_{y,i}$, and $w_i$. The interpolated fields are given by:\n$\\theta_{x}(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{x,i} = N_{1}\\theta_{x,1} + N_{2}\\theta_{x,2} + N_{3}\\theta_{x,3} + N_{4}\\theta_{x,4}$\n$\\theta_{y}(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{y,i} = N_{1}\\theta_{y,1} + N_{2}\\theta_{y,2} + N_{3}\\theta_{y,3} + N_{4}\\theta_{y,4}$\n$w(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,w_{i} = N_{1}w_{1} + N_{2}w_{2} + N_{3}w_{3} + N_{4}w_{4}$\n\n2) In the isoparametric formulation, the physical coordinates $(x,y)$ are interpolated using the same shape functions as the displacement fields:\n$x(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i}$\n$y(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}$\n\nThe strain definitions involve derivatives with respect to the physical coordinates $(x,y)$, but the shape functions are defined in terms of natural coordinates $(\\xi,\\eta)$. The chain rule of differentiation is used to relate these derivatives. The relationship is expressed via the Jacobian matrix, $J$:\n$$\n\\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix}\n$$\nThe components of the Jacobian matrix are computed as $J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial\\xi}x_i$, $J_{12} = \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial\\xi}y_i$, $J_{21} = \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial\\eta}x_i$, and $J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial\\eta}y_i$.\n\nTo compute physical derivatives from natural derivatives, we use the inverse relationship:\n$$\n\\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n$$\nFor any function $f(\\xi,\\eta)$, its physical derivatives are:\n$\\frac{\\partial f}{\\partial x} = J^{-1}_{11}\\frac{\\partial f}{\\partial \\xi} + J^{-1}_{12}\\frac{\\partial f}{\\partial \\eta}$\n$\\frac{\\partial f}{\\partial y} = J^{-1}_{21}\\frac{\\partial f}{\\partial \\xi} + J^{-1}_{22}\\frac{\\partial f}{\\partial \\eta}$\n\nThe derivatives of the shape functions with respect to physical coordinates are thus found as:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix}\n$$\nThe strain components can now be expressed in terms of nodal degrees of freedom. Let the nodal displacement vector for the element be $\\mathbf{d}^e = [\\dots, w_i, \\theta_{x,i}, \\theta_{y,i}, \\dots]^T$.\nThe bending curvatures are:\n$\\kappa_{x} = -\\frac{\\partial \\theta_{x}}{\\partial x} = -\\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial x}\\theta_{x,i}$\n$\\kappa_{y} = -\\frac{\\partial \\theta_{y}}{\\partial y} = -\\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial y}\\theta_{y,i}$\n$\\kappa_{xy} = -(\\frac{\\partial \\theta_{x}}{\\partial y} + \\frac{\\partial \\theta_{y}}{\\partial x}) = -\\sum_{i=1}^{4}\\left(\\frac{\\partial N_i}{\\partial y}\\theta_{x,i} + \\frac{\\partial N_i}{\\partial x}\\theta_{y,i}\\right)$\n\nThese can be written in matrix form $\\boldsymbol{\\kappa} = \\mathbf{B}_b \\mathbf{d}^e$, where the bending strain-displacement matrix $\\mathbf{B}_b$ is composed of blocks for each node $i$:\n$\\mathbf{B}_{b,i} = \\begin{pmatrix} 0 & -\\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & 0 & -\\frac{\\partial N_i}{\\partial y} \\\\ 0 & -\\frac{\\partial N_i}{\\partial y} & -\\frac{\\partial N_i}{\\partial x} \\end{pmatrix}$\n\nThe transverse shear strains are:\n$\\gamma_{xz} = \\frac{\\partial w}{\\partial x} - \\theta_{x} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial x}w_i - \\sum_{i=1}^{4}N_i\\theta_{x,i} = \\sum_{i=1}^{4}\\left(\\frac{\\partial N_i}{\\partial x}w_i - N_i\\theta_{x,i}\\right)$\n$\\gamma_{yz} = \\frac{\\partial w}{\\partial y} - \\theta_{y} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial y}w_i - \\sum_{i=1}^{4}N_i\\theta_{y,i} = \\sum_{i=1}^{4}\\left(\\frac{\\partial N_i}{\\partial y}w_i - N_i\\theta_{y,i}\\right)$\n\nThese can be written in matrix form $\\boldsymbol{\\gamma} = \\mathbf{B}_s \\mathbf{d}^e$, where the shear strain-displacement matrix $\\mathbf{B}_s$ is composed of blocks for each node $i$:\n$\\mathbf{B}_{s,i} = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & -N_i & 0 \\\\ \\frac{\\partial N_i}{\\partial y} & 0 & -N_i \\end{pmatrix}$\n\n3) To compute the transverse shear strain $\\gamma_{xz}$ at the element center $(\\xi,\\eta)=(0,0)$, we must first compute the Jacobian matrix at this point. The coordinate mapping is:\n$x(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)(0) + \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(2) + \\frac{1}{4}(1-\\xi)(1+\\eta)(0) = \\frac{1}{2}(1+\\xi)(1-\\eta) + \\frac{1}{2}(1+\\xi)(1+\\eta) = \\frac{1}{2}(1+\\xi)(1-\\eta+1+\\eta) = 1+\\xi$.\n$y(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)(0) + \\frac{1}{4}(1+\\xi)(1-\\eta)(0) + \\frac{1}{4}(1+\\xi)(1+\\eta)(1) + \\frac{1}{4}(1-\\xi)(1+\\eta)(1) = \\frac{1}{4}(1+\\eta)(1+\\xi+1-\\xi) = \\frac{1}{2}(1+\\eta)$.\n\nThe derivatives for the Jacobian are:\n$\\frac{\\partial x}{\\partial \\xi} = 1$, $\\frac{\\partial x}{\\partial \\eta} = 0$, $\\frac{\\partial y}{\\partial \\xi} = 0$, $\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{2}$.\nThe Jacobian matrix is constant for this rectangular element: $J = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1/2 \\end{pmatrix}$.\nThe inverse Jacobian is $J^{-1} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix}$.\n\nThe shear strain is $\\gamma_{xz} = \\frac{\\partial w}{\\partial x} - \\theta_{x}$. We evaluate each term at $(\\xi,\\eta)=(0,0)$.\nFirst, the rotation field $\\theta_x$:\nAt $(\\xi,\\eta)=(0,0)$, the shape functions are $N_1 = N_2 = N_3 = N_4 = \\frac{1}{4}$.\n$\\theta_x(0,0) = \\sum_{i=1}^{4} N_i(0,0)\\theta_{x,i} = \\frac{1}{4}(\\theta_{x,1} + \\theta_{x,2} + \\theta_{x,3} + \\theta_{x,4})$.\nUsing the given nodal values $\\theta_{x,1}=0$, $\\theta_{x,2}=0.2$, $\\theta_{x,3}=0.4$, $\\theta_{x,4}=0.2$:\n$\\theta_x(0,0) = \\frac{1}{4}(0 + 0.2 + 0.4 + 0.2) = \\frac{0.8}{4} = 0.2$.\n\nNext, the derivative of the transverse deflection, $\\frac{\\partial w}{\\partial x}$:\n$\\frac{\\partial w}{\\partial x} = J^{-1}_{11}\\frac{\\partial w}{\\partial \\xi} + J^{-1}_{12}\\frac{\\partial w}{\\partial \\eta} = (1)\\frac{\\partial w}{\\partial \\xi} + (0)\\frac{\\partial w}{\\partial \\eta} = \\frac{\\partial w}{\\partial \\xi}$.\nWe need to compute $\\frac{\\partial w}{\\partial \\xi} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial\\xi}w_i$ at $(\\xi,\\eta)=(0,0)$.\nThe derivatives of the shape functions with respect to $\\xi$ are:\n$\\frac{\\partial N_1}{\\partial\\xi} = -\\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_2}{\\partial\\xi} = \\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_3}{\\partial\\xi} = \\frac{1}{4}(1+\\eta)$, $\\frac{\\partial N_4}{\\partial\\xi} = -\\frac{1}{4}(1+\\eta)$.\nEvaluating at $(\\xi,\\eta)=(0,0)$:\n$\\frac{\\partial N_1}{\\partial\\xi}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial\\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial\\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial\\xi}(0,0) = -\\frac{1}{4}$.\nThus,\n$\\frac{\\partial w}{\\partial x}(0,0) = \\frac{\\partial w}{\\partial\\xi}(0,0) = (-\\frac{1}{4})w_1 + (\\frac{1}{4})w_2 + (\\frac{1}{4})w_3 + (-\\frac{1}{4})w_4 = \\frac{1}{4}(-w_1+w_2+w_3-w_4)$.\nUsing the given nodal values $w_{1}=0$, $w_{2}=2$, $w_{3}=4$, $w_{4}=2$:\n$\\frac{\\partial w}{\\partial x}(0,0) = \\frac{1}{4}(-0+2+4-2) = \\frac{4}{4} = 1$.\n\nFinally, the transverse shear strain $\\gamma_{xz}$ at the center is:\n$\\gamma_{xz}(0,0) = \\frac{\\partial w}{\\partial x}(0,0) - \\theta_x(0,0) = 1 - 0.2 = 0.8$.\nThe result is an exact number as required.", "answer": "$$\n\\boxed{0.8}\n$$", "id": "2558491"}, {"introduction": "Writing finite element code requires rigorous verification to ensure the implementation correctly reflects the underlying theory. This hands-on exercise [@problem_id:2558528] tasks you with designing and implementing a unit testing suite for a Mindlin plate element. By creating tests for rigid-body motion and constant strain states (the \"patch test\"), you will learn the essential process of verifying the kinematic correctness of your element formulation, a critical skill for any developer in computational mechanics.", "problem": "You are tasked with designing and implementing a minimal yet rigorous verification harness for the finite element formulation of Reissner–Mindlin plates (Mindlin plates) at the element level. The goal is to verify the correctness of element-level strain–displacement matrices by unit tests that target the kinematics and mapping, independent of constitutive parameters. Your program must be self-contained and produce a single list of boolean results, each indicating whether a specified verification item passes.\n\nStarting point and fundamental base: adopt the Reissner–Mindlin (Mindlin) kinematics for moderately thick plates under small deformation. Let the primary fields be the transverse displacement $w(x,y)$ and the rotations $\\theta_x(x,y)$ and $\\theta_y(x,y)$ of the normal to the mid-surface about the $y$- and $x$-axes respectively (angles in radians). The Reissner–Mindlin strain measures are the bending curvatures and transverse shear strains defined by\n$$\n\\kappa_x = -\\frac{\\partial \\theta_x}{\\partial x},\\quad\n\\kappa_y = -\\frac{\\partial \\theta_y}{\\partial y},\\quad\n\\kappa_{xy} = -(\\frac{\\partial \\theta_x}{\\partial y} + \\frac{\\partial \\theta_y}{\\partial x}),\n$$\n$$\n\\gamma_{xz} = \\frac{\\partial w}{\\partial x} - \\theta_x,\\quad\n\\gamma_{yz} = \\frac{\\partial w}{\\partial y} - \\theta_y.\n$$\nAdopt a four-node bilinear quadrilateral element with nodes $i \\in \\{1,2,3,4\\}$, natural coordinates $(\\xi,\\eta) \\in [-1,1]^2$, and bilinear shape functions $N_i(\\xi,\\eta)$ and their derivatives $\\partial N_i/\\partial \\xi$, $\\partial N_i/\\partial \\eta$. Use the exact isoparametric mapping from $(\\xi,\\eta)$ to the element with physical node coordinates $(x_i,y_i)$ and the Jacobian $\\mathbf{J}(\\xi,\\eta)$, so that\n$$\n\\begin{bmatrix}\n\\frac{\\partial N_i}{\\partial x} \\\\\n\\frac{\\partial N_i}{\\partial y}\n\\end{bmatrix}\n=\n\\mathbf{J}^{-T}\n\\begin{bmatrix}\n\\frac{\\partial N_i}{\\partial \\xi} \\\\\n\\frac{\\partial N_i}{\\partial \\eta}\n\\end{bmatrix}.\n$$\nUse the standard interpolation of primary fields by the shape functions $N_i(\\xi,\\eta)$ at the element level, without providing any specialized reduced/selective integration scheme:\n$$\nw^h(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\, w_i,\\quad\n\\theta_x^h(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\, \\theta_{x,i},\\quad\n\\theta_y^h(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\, \\theta_{y,i}.\n$$\nFrom these definitions alone, derive the element-level strain–displacement matrices that map nodal degrees of freedom to the strain measures at any $(\\xi,\\eta)$:\n- The bending matrix $B_b(\\xi,\\eta)$ such that\n$$\n\\begin{bmatrix}\n\\kappa_x \\\\ \\kappa_y \\\\ \\kappa_{xy}\n\\end{bmatrix}\n=\nB_b(\\xi,\\eta)\\,\n\\begin{bmatrix}\n\\theta_{x,1} \\\\ \\theta_{y,1} \\\\\n\\theta_{x,2} \\\\ \\theta_{y,2} \\\\\n\\theta_{x,3} \\\\ \\theta_{y,3} \\\\\n\\theta_{x,4} \\\\ \\theta_{y,4}\n\\end{bmatrix}.\n$$\n- The shear matrix $B_s(\\xi,\\eta)$ such that\n$$\n\\begin{bmatrix}\n\\gamma_{xz} \\\\ \\gamma_{yz}\n\\end{bmatrix}\n=\nB_s(\\xi,\\eta)\\,\n\\begin{bmatrix}\nw_1 \\\\ \\theta_{x,1} \\\\ \\theta_{y,1} \\\\\nw_2 \\\\ \\theta_{x,2} \\\\ \\theta_{y,2} \\\\\nw_3 \\\\ \\theta_{x,3} \\\\ \\theta_{y,3} \\\\\nw_4 \\\\ \\theta_{x,4} \\\\ \\theta_{y,4}\n\\end{bmatrix}.\n$$\n\nDesign a verification suite that exercises the following logically independent checks, all of which derive from the kinematic definitions given above. For each case, compute strains at the standard tensor-product Gauss points $(\\xi,\\eta) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$ inside each element and compare to the analytical target strain values.\n\n- Element-level rigid-body tilt and translation (shear and bending null test): Choose an element and impose a rigid-body field that combines a constant transverse displacement and a uniform small tilt, namely\n  $$\n  w(x,y) = w_0 + p\\,x + q\\,y,\\quad\n  \\theta_x(x,y) = p,\\quad\n  \\theta_y(x,y) = q,\n  $$\n  where $w_0$, $p$, and $q$ are constants. Show that $\\kappa_x = \\kappa_y = \\kappa_{xy} = 0$ and $\\gamma_{xz} = \\gamma_{yz} = 0$ exactly. Verification passes if the maximum absolute values of all computed curvatures and shears at all Gauss points are below a tolerance $\\varepsilon$.\n- Constant curvature bending patch (bending consistency test): Choose an element. Impose\n  $$\n  \\theta_x(x,y) = -\\alpha\\,x,\\quad\n  \\theta_y(x,y) = 0,\\quad w(x,y) \\text{ arbitrary (unused)},\n  $$\n  for constant $\\alpha$. Show that $\\kappa_x = \\alpha$, $\\kappa_y = 0$, and $\\kappa_{xy} = 0$ at all Gauss points. Verification passes if the maximum absolute deviation from these targets across Gauss points is below $\\varepsilon$.\n- Constant shear patch (shear consistency test): Choose an element. Impose\n  $$\n  w(x,y) = s_x\\,x + s_y\\,y,\\quad\n  \\theta_x(x,y) = 0,\\quad\n  \\theta_y(x,y) = 0,\n  $$\n  for constants $s_x$ and $s_y$. Show that $\\gamma_{xz} = s_x$ and $\\gamma_{yz} = s_y$ at all Gauss points and all bending curvatures vanish. Verification passes if the maximum absolute deviation from these targets across Gauss points is below $\\varepsilon$.\n- Geometric invariance under skew mapping (mapping robustness test): Repeat the rigid-body tilt and translation test on a skewed convex quadrilateral element and verify that computed strains remain numerically zero within tolerance $\\varepsilon$.\n- Two-element patch test (inter-element consistency via local evaluation): Tile two elements to form a patch that covers a rectangle, set the rigid-body tilt and translation field across both elements consistently, and verify that every Gauss point in both elements yields bending curvatures and shear strains equal to zero within tolerance $\\varepsilon$.\n\nTest suite specification. Your program shall implement the above checks with the following concrete parameter values:\n- Tolerance: $\\varepsilon = 10^{-12}$.\n- Gauss points: $(\\xi,\\eta) \\in \\{(-1/\\sqrt{3},-1/\\sqrt{3}), (-1/\\sqrt{3},+1/\\sqrt{3}), (+1/\\sqrt{3},-1/\\sqrt{3}), (+1/\\sqrt{3},+1/\\sqrt{3})\\}$.\n- Element geometries:\n  - Rectangular element $\\mathcal{E}_R$ with nodes $(x_i,y_i)$ ordered counterclockwise: $(0,0)$, $(2,0)$, $(2,1)$, $(0,1)$.\n  - Skewed quadrilateral element $\\mathcal{E}_S$ with nodes: $(0,0)$, $(1.8,0.2)$, $(2.1,1.0)$, $(0,1.0)$.\n  - Two-element patch $\\mathcal{P}$ composed of $\\mathcal{E}_{L}$ with nodes $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$ and $\\mathcal{E}_{R}$ with nodes $(1,0)$, $(2,0)$, $(2,1)$, $(1,1)$.\n- Field parameters:\n  - Rigid-body: $w_0 = 0.1$, $p = 0.25$, $q = -0.4$.\n  - Constant curvature: $\\alpha = 0.75$.\n  - Constant shear: $s_x = 0.3$, $s_y = -0.5$.\n\nYour program must:\n- Construct $B_b(\\xi,\\eta)$ and $B_s(\\xi,\\eta)$ directly from the fundamental kinematics and isoparametric mapping with bilinear shape functions, without hardcoding any shortcut formulas beyond the standard derivative transformation via $\\mathbf{J}^{-T}$.\n- For each test case, assemble the nodal degrees of freedom by evaluating the prescribed fields at the element nodes.\n- Evaluate strains at all Gauss points and check them against the analytical targets for that test.\n- Return one boolean per test case in the order listed below, with value true if and only if the test passes within the tolerance $\\varepsilon$:\n  1. Rigid-body test on $\\mathcal{E}_R$.\n  2. Skewed rigid-body test on $\\mathcal{E}_S$.\n  3. Constant curvature test on $\\mathcal{E}_R$ with $\\alpha$ as specified.\n  4. Constant shear test on $\\mathcal{E}_R$ with $s_x$ and $s_y$ as specified.\n  5. Two-element patch rigid-body test on $\\mathcal{P}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[true,false,true,true,false]\"), where each entry is a Python boolean with capitalized initial letter. No additional text should be printed.\n\nAngle unit: Use radians for all rotation quantities. No physical units are required in the output.", "solution": "The problem posed is a request to construct and implement a verification suite for a four-node bilinear quadrilateral finite element for Reissner-Mindlin plate theory. The verification must confirm the correctness of the element's kinematic formulation by performing a series of tests based on fundamental principles. The problem is valid, scientifically sound, and well-posed. It provides all necessary definitions, data, and parameters to proceed with a solution.\n\nThe solution will be developed based on the following principles:\n\n1.  **Reissner-Mindlin Plate Kinematics**: The formulation begins with the core kinematic assumptions of Reissner-Mindlin theory. The strain measures are the bending curvatures $\\boldsymbol{\\kappa} = [\\kappa_x, \\kappa_y, \\kappa_{xy}]^T$ and the transverse shear strains $\\boldsymbol{\\gamma} = [\\gamma_{xz}, \\gamma_{yz}]^T$. These are defined in terms of the derivatives of the transverse displacement $w$ and the rotations $\\theta_x$ and $\\theta_y$ as specified in the problem statement:\n    $$\n    \\kappa_x = -\\frac{\\partial \\theta_x}{\\partial x}, \\quad \\kappa_y = -\\frac{\\partial \\theta_y}{\\partial y}, \\quad \\kappa_{xy} = -(\\frac{\\partial \\theta_x}{\\partial y} + \\frac{\\partial \\theta_y}{\\partial x})\n    $$\n    $$\n    \\gamma_{xz} = \\frac{\\partial w}{\\partial x} - \\theta_x, \\quad \\gamma_{yz} = \\frac{\\partial w}{\\partial y} - \\theta_y\n    $$\n\n2.  **Isoparametric Finite Element Discretization**: The continuous fields ($w, \\theta_x, \\theta_y$) are approximated over a four-node quadrilateral element using standard bilinear shape functions $N_i(\\xi, \\eta)$, where $(\\xi, \\eta) \\in [-1, 1]^2$ are the natural coordinates of the parent element. For each field $u$, the approximation $u^h$ is given by $u^h(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) u_i$, where $u_i$ are the nodal values of the field. The shape functions for a standard counter-clockwise node ordering from $(\\xi, \\eta) = (-1, -1)$ are:\n    $$\n    N_i(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi_i \\xi)(1 + \\eta_i \\eta)\n    $$\n    where $(\\xi_i, \\eta_i)$ are the natural coordinates of node $i$.\n\n3.  **Strain-Displacement Matrices ($B$-matrices)**: By substituting the discrete field approximations into the kinematic equations, we derive the algebraic relationship between strains at a point and the element's nodal degrees of freedom. This relationship is expressed through the strain-displacement matrices, $B_b$ and $B_s$.\n\n    For bending, the nodal degrees of freedom are the rotations $\\mathbf{d}_\\theta = [\\theta_{x,1}, \\theta_{y,1}, \\dots, \\theta_{x,4}, \\theta_{y,4}]^T$. The curvatures are:\n    $$\n    \\begin{bmatrix} \\kappa_x \\\\ \\kappa_y \\\\ \\kappa_{xy} \\end{bmatrix} = \\sum_{i=1}^4 \\begin{bmatrix} -\\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & -\\frac{\\partial N_i}{\\partial y} \\\\ -\\frac{\\partial N_i}{\\partial y} & -\\frac{\\partial N_i}{\\partial x} \\end{bmatrix} \\begin{bmatrix} \\theta_{x,i} \\\\ \\theta_{y,i} \\end{bmatrix} = B_b \\mathbf{d}_\\theta\n    $$\n    The matrix $B_b$ is a $3 \\times 8$ matrix constructed by concatenating the $3 \\times 2$ blocks for each of the $4$ nodes.\n\n    For shear, the nodal degrees of freedom are $\\mathbf{d} = [w_1, \\theta_{x,1}, \\theta_{y,1}, \\dots, w_4, \\theta_{x,4}, \\theta_{y,4}]^T$. The shear strains are:\n    $$\n    \\begin{bmatrix} \\gamma_{xz} \\\\ \\gamma_{yz} \\end{bmatrix} = \\sum_{i=1}^4 \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & -N_i & 0 \\\\ \\frac{\\partial N_i}{\\partial y} & 0 & -N_i \\end{bmatrix} \\begin{bmatrix} w_i \\\\ \\theta_{x,i} \\\\ \\theta_{y,i} \\end{bmatrix} = B_s \\mathbf{d}\n    $$\n    The matrix $B_s$ is a $2 \\times 12$ matrix constructed by concatenating the $2 \\times 3$ blocks for each of the $4$ nodes.\n\n4.  **Coordinate Transformation via the Jacobian**: The shape function derivatives are naturally computed with respect to $(\\xi, \\eta)$, but the strain definitions require derivatives with respect to physical coordinates $(x, y)$. The transformation is achieved using the Jacobian matrix of the isoparametric map $x(\\xi, \\eta) = \\sum N_i x_i$, $y(\\xi, \\eta) = \\sum N_i y_i$. As per the problem's definition, the Jacobian matrix $\\mathbf{J}$ relates the gradient operators by $\\nabla_x = \\mathbf{J}^{-T} \\nabla_\\xi$. This specific Jacobian is computed as:\n    $$\n    \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum_i \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_i \\frac{\\partial N_i}{\\partial \\xi} y_i \\\\ \\sum_i \\frac{\\partial N_i}{\\partial \\eta} x_i & \\sum_i \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{bmatrix}\n    $$\n    The derivatives of a shape function $N_i$ in physical coordinates are then found by:\n    $$\n    \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{bmatrix} = \\mathbf{J}^{-T} \\begin{bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{bmatrix}\n    $$\n\n5.  **Verification Principles (Patch Tests)**: A fundamental requirement for any valid finite element is its ability to exactly reproduce constant strain states and rigid-body modes. The specified tests are designed to verify this property, a condition known as passing the patch test. Bilinear elements can exactly represent any field that is linear in the physical coordinates $x$ and $y$. The test cases are designed with fields that are either constant or linear, ensuring that the interpolated field within the element is identical to the analytical field. Consequently, the computed strains must match the exact analytical strains up to machine precision.\n\n    - **Rigid-Body Motion**: A field $w(x,y) = w_0 + px + qy$, $\\theta_x = p$, $\\theta_y = q$ corresponds to a rigid translation and rotation. Analytically, this state produces zero strain everywhere. The test verifies that the element formulation also yields zero strain.\n    - **Constant Strain States**: A linear rotation field like $\\theta_x = -\\alpha x$ produces a constant curvature $\\kappa_x = \\alpha$. A linear displacement field like $w = s_x x + s_y y$ (with zero rotations) produces constant shear strains $\\gamma_{xz} = s_x$ and $\\gamma_{yz} = s_y$. The tests verify that the element can reproduce these constant states exactly.\n    - **Geometric Invariance**: Repeating the rigid-body test on a skewed element verifies that the formulation is independent of the element's specific shape, a key feature of the isoparametric method.\n    - **Inter-element Consistency**: The two-element patch test confirms that when elements are assembled, continuity of the primary fields is sufficient to ensure a consistent (in this case, zero) strain field across the patch.\n\nThe implementation will construct a class for the Q4 element that encapsulates these calculations. A testing harness will then execute the five specified test cases by defining the element geometries and analytical fields, computing the nodal degrees of freedom, calculating the strains at the specified Gauss points using the derived $B$-matrices, and comparing the results to the analytical targets with a tolerance of $\\varepsilon=10^{-12}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ... Not needed for this problem.\n\nclass MindlinQ4Element:\n    \"\"\"\n    Implements the kinematic formulation for a 4-node bilinear\n    Reissner-Mindlin plate element.\n    \"\"\"\n\n    def __init__(self, node_coords: np.ndarray):\n        \"\"\"\n        Initializes the element with its physical node coordinates.\n        Args:\n            node_coords (np.ndarray): A 4x2 array of node coordinates (x, y),\n                                      ordered counter-clockwise.\n        \"\"\"\n        if node_coords.shape != (4, 2):\n            raise ValueError(\"node_coords must be a 4x2 array.\")\n        self.node_coords = node_coords\n\n    @staticmethod\n    def get_shape_functions(xi: float, eta: float) -> tuple[np.ndarray, np.ndarray]:\n        \"\"\"\n        Computes shape functions and their derivatives in natural coordinates.\n        Node ordering: 1=(-1,-1), 2=(1,-1), 3=(1,1), 4=(-1,1).\n        \n        Args:\n            xi (float): Natural coordinate xi.\n            eta (float): Natural coordinate eta.\n\n        Returns:\n            tuple[np.ndarray, np.ndarray]:\n                - N (1x4 array): Shape function values N_i.\n                - dN_dxi_eta (2x4 array): Natural derivatives [dN/dxi; dN/deta].\n        \"\"\"\n        N = 0.25 * np.array([\n            (1 - xi) * (1 - eta),\n            (1 + xi) * (1 - eta),\n            (1 + xi) * (1 + eta),\n            (1 - xi) * (1 + eta)\n        ])\n\n        dN_dxi = 0.25 * np.array([\n            -(1 - eta),\n            (1 - eta),\n            (1 + eta),\n            -(1 + eta)\n        ])\n\n        dN_deta = 0.25 * np.array([\n            -(1 - xi),\n            -(1 + xi),\n            (1 + xi),\n            (1 - xi)\n        ])\n        \n        return N, np.vstack([dN_dxi, dN_deta])\n\n    def get_B_matrices(self, xi: float, eta: float) -> tuple[np.ndarray, np.ndarray]:\n        \"\"\"\n        Computes the strain-displacement matrices B_b and B_s at a point.\n\n        Args:\n            xi (float): Natural coordinate xi.\n            eta (float): Natural coordinate eta.\n\n        Returns:\n            tuple[np.ndarray, np.ndarray]:\n                - B_b (3x8 array): Bending strain-displacement matrix.\n                - B_s (2x12 array): Shear strain-displacement matrix.\n        \"\"\"\n        N, dN_dxi_eta = self.get_shape_functions(xi, eta)\n\n        # Jacobian matrix J based on the problem's definition\n        # J_ij = sum_k (d(N_k)/d(xi_i) * x_j_k)\n        # J = [dx/dxi dy/dxi; dx/deta dy/deta]\n        J = dN_dxi_eta @ self.node_coords\n        \n        # Cartesian derivatives dN_dx, dN_dy\n        # [dN/dx; dN/dy] = J_inv_T @ [dN/dxi; dN/deta]\n        J_inv_T = np.linalg.inv(J).T\n        dN_dxy = J_inv_T @ dN_dxi_eta\n\n        B_b = np.zeros((3, 8))\n        B_s = np.zeros((2, 12))\n\n        for i in range(4):\n            # Bending matrix Bb (3x8)\n            # Dofs order: [th_x1, th_y1, th_x2, th_y2, ...]\n            B_b[0, 2*i]     = -dN_dxy[0, i]  # kappa_x from th_x\n            B_b[1, 2*i + 1] = -dN_dxy[1, i]  # kappa_y from th_y\n            B_b[2, 2*i]     = -dN_dxy[1, i]  # kappa_xy from th_x\n            B_b[2, 2*i + 1] = -dN_dxy[0, i]  # kappa_xy from th_y\n\n            # Shear matrix Bs (2x12)\n            # Dofs order: [w1, th_x1, th_y1, w2, ...]\n            B_s[0, 3*i]     = dN_dxy[0, i]  # gamma_xz from w\n            B_s[0, 3*i + 1] = -N[i]         # gamma_xz from th_x\n            B_s[1, 3*i]     = dN_dxy[1, i]  # gamma_yz from w\n            B_s[1, 3*i + 2] = -N[i]         # gamma_yz from th_y\n            \n        return B_b, B_s\n\ndef run_test_on_element(element, field_params, test_type, gauss_points, tolerance):\n    \"\"\"\n    Runs a single verification test on a single element.\n    \"\"\"\n    node_coords = element.node_coords\n    \n    # Assemble nodal DOFs\n    w_nodes = np.zeros(4)\n    th_x_nodes = np.zeros(4)\n    th_y_nodes = np.zeros(4)\n    \n    # Define analytical fields and targets based on test type\n    if test_type == 'rigid_body':\n        w0, p, q = field_params['w0'], field_params['p'], field_params['q']\n        for i in range(4):\n            x, y = node_coords[i]\n            w_nodes[i] = w0 + p * x + q * y\n            th_x_nodes[i] = p\n            th_y_nodes[i] = q\n        target_kappa = np.zeros(3)\n        target_gamma = np.zeros(2)\n    elif test_type == 'constant_curvature':\n        alpha = field_params['alpha']\n        for i in range(4):\n            x, y = node_coords[i]\n            th_x_nodes[i] = -alpha * x\n            th_y_nodes[i] = 0.0\n        target_kappa = np.array([alpha, 0.0, 0.0])\n        target_gamma = np.zeros(2) # Not checked in this specific test\n    elif test_type == 'constant_shear':\n        sx, sy = field_params['sx'], field_params['sy']\n        for i in range(4):\n            x, y = node_coords[i]\n            w_nodes[i] = sx * x + sy * y\n            th_x_nodes[i] = 0.0\n            th_y_nodes[i] = 0.0\n        target_kappa = np.zeros(3)\n        target_gamma = np.array([sx, sy])\n    else:\n        raise ValueError(f\"Unknown test type: {test_type}\")\n\n    # Nodal DOF vectors\n    d_theta = np.ravel(np.column_stack((th_x_nodes, th_y_nodes)))\n    d_full = np.ravel(np.column_stack((w_nodes, th_x_nodes, th_y_nodes)))\n\n    max_abs_error = 0.0\n    \n    for gp in gauss_points:\n        xi, eta = gp\n        B_b, B_s = element.get_B_matrices(xi, eta)\n        \n        # Compute strains\n        kappa_computed = B_b @ d_theta\n        gamma_computed = B_s @ d_full\n        \n        # Check errors\n        if test_type in ['rigid_body', 'constant_shear']:\n            error_kappa = np.abs(kappa_computed - target_kappa)\n            max_abs_error = max(max_abs_error, np.max(error_kappa))\n        \n        if test_type in ['rigid_body', 'constant_shear', 'constant_curvature']:\n            # The constant curvature test doesn't use w or gamma, but we will check all\n            # to be thorough. For const-curve, gamma is not guaranteed to be zero analytically\n            # unless w is specially chosen, but the problem specifies B_b only.\n            # We are constrained by problem statement. In const-curvature test, only kappa is checked.\n            if test_type == 'constant_curvature':\n                error_kappa = np.abs(kappa_computed - target_kappa)\n                max_abs_error = max(max_abs_error, np.max(error_kappa))\n            else:\n                 error_gamma = np.abs(gamma_computed - target_gamma)\n                 max_abs_error = max(max_abs_error, np.max(error_gamma))\n                 \n    return max_abs_error < tolerance\n\ndef solve():\n    \"\"\"\n    Main function to run the verification suite.\n    \"\"\"\n    # Test suite specification\n    tolerance = 1e-12\n    g = 1.0 / np.sqrt(3.0)\n    gauss_points = [(-g, -g), (-g, g), (g, -g), (g, g)]\n\n    # Element geometries\n    coords_E_R = np.array([[0.0, 0.0], [2.0, 0.0], [2.0, 1.0], [0.0, 1.0]])\n    coords_E_S = np.array([[0.0, 0.0], [1.8, 0.2], [2.1, 1.0], [0.0, 1.0]])\n    coords_E_L_patch = np.array([[0.0, 0.0], [1.0, 0.0], [1.0, 1.0], [0.0, 1.0]])\n    coords_E_R_patch = np.array([[1.0, 0.0], [2.0, 0.0], [2.0, 1.0], [1.0, 1.0]])\n\n    # Field parameters\n    rigid_body_params = {'w0': 0.1, 'p': 0.25, 'q': -0.4}\n    const_curv_params = {'alpha': 0.75}\n    const_shear_params = {'sx': 0.3, 'sy': -0.5}\n\n    results = []\n\n    # 1. Rigid-body test on E_R\n    elem_R = MindlinQ4Element(coords_E_R)\n    res1 = run_test_on_element(elem_R, rigid_body_params, 'rigid_body', gauss_points, tolerance)\n    results.append(res1)\n\n    # 2. Skewed rigid-body test on E_S\n    elem_S = MindlinQ4Element(coords_E_S)\n    res2 = run_test_on_element(elem_S, rigid_body_params, 'rigid_body', gauss_points, tolerance)\n    results.append(res2)\n\n    # 3. Constant curvature test on E_R\n    res3 = run_test_on_element(elem_R, const_curv_params, 'constant_curvature', gauss_points, tolerance)\n    results.append(res3)\n\n    # 4. Constant shear test on E_R\n    res4 = run_test_on_element(elem_R, const_shear_params, 'constant_shear', gauss_points, tolerance)\n    results.append(res4)\n\n    # 5. Two-element patch rigid-body test on P\n    elem_L_patch = MindlinQ4Element(coords_E_L_patch)\n    elem_R_patch = MindlinQ4Element(coords_E_R_patch)\n    \n    # This test is basically a logical AND of two single-element tests\n    pass_L = run_test_on_element(elem_L_patch, rigid_body_params, 'rigid_body', gauss_points, tolerance)\n    pass_R = run_test_on_element(elem_R_patch, rigid_body_params, 'rigid_body', gauss_points, tolerance)\n    results.append(pass_L and pass_R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\nsolve()\n\n```", "id": "2558528"}]}