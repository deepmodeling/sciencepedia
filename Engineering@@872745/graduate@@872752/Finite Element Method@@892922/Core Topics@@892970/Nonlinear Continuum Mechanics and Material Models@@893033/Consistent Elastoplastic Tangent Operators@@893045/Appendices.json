{"hands_on_practices": [{"introduction": "The first step in mastering consistent tangent operators is to derive one from first principles for a foundational model. This exercise guides you through the derivation for associative von Mises plasticity, the cornerstone of metal plasticity [@problem_id:2547052]. By performing a spectral analysis, you will uncover the deep connection between the tangent's mathematical properties and the physical onset of strain localization, marked by the loss of ellipticity.", "problem": "Consider small-strain, rate-independent, associative von Mises elastoplasticity with linear isotropic hardening in three dimensions. The elastic response is isotropic with bulk modulus $K$ and shear modulus $G$, so that the fourth-order elastic stiffness is $C^{e} = K\\,\\mathbf{I} \\otimes \\mathbf{I} + 2G\\,\\mathbb{I}_{\\mathrm{dev}}$, where $\\mathbf{I}$ is the second-order identity tensor and $\\mathbb{I}_{\\mathrm{dev}}$ is the fourth-order deviatoric projector. The total strain is additively decomposed as $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{e} + \\boldsymbol{\\varepsilon}^{p}$, and the Cauchy stress is $\\boldsymbol{\\sigma} = C^{e} : \\boldsymbol{\\varepsilon}^{e}$. The von Mises yield function is $f(\\boldsymbol{\\sigma},\\kappa) = \\sqrt{\\frac{3}{2}}\\,\\|\\mathbf{s}\\| - \\sigma_{y0} - H'\\kappa$, where $\\mathbf{s} = \\mathrm{dev}(\\boldsymbol{\\sigma})$ is the stress deviator, $\\kappa$ is the accumulated equivalent plastic strain, $\\sigma_{y0}$ is the initial yield stress, and $H' \\ge 0$ is the linear isotropic hardening modulus. The plastic flow is associative, so that $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda\\,\\partial f / \\partial \\boldsymbol{\\sigma}$, and the consistency condition holds during plastic loading. Starting from these fundamental definitions and relations, derive the consistent elastoplastic tangent operator $C^{ep}$ appropriate for use in a Newton method within the Finite Element Method (FEM). Restricting attention to the plastic loading regime and to the deviatoric subspace, consider the spectral decomposition of the deviatoric part of $C^{ep}$ with respect to the plastic flow direction $\\mathbf{n} = \\partial f / \\partial \\boldsymbol{\\sigma}$ and its orthogonal complement. Determine, in closed form, the smallest eigenvalue $\\lambda_{\\min}(H',G)$ of the deviatoric part of $C^{ep}$ as a function of the hardening modulus $H'$ and the shear modulus $G$. Discuss, in words, what happens to this eigenvalue and to ellipticity as $H' \\to 0$ (the perfect plasticity limit), and explain the mechanical significance. Provide only the analytic expression for $\\lambda_{\\min}(H',G)$ as your final answer. Express your final answer in Pascals, treating $H'$ and $G$ as given in Pascals. No numerical approximation or rounding is required.", "solution": "The problem as stated is a standard, well-posed problem in the theory of computational plasticity. It is scientifically grounded, objective, and provides all necessary information for its solution. Therefore, we proceed with the derivation.\n\nThe fundamental starting point for deriving the tangent modulus in rate-independent plasticity is the Karush-Kuhn-Tucker (KKT) conditions for plastic loading, specifically the consistency condition, which states that the yield function must remain zero during a plastic state.\n$$ \\mathrm{d} f = 0 $$\nExpanding this using the chain rule gives:\n$$ \\mathrm{d}f = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} : \\mathrm{d}\\boldsymbol{\\sigma} + \\frac{\\partial f}{\\partial \\kappa} \\mathrm{d}\\kappa = 0 $$\nLet us denote the gradient of the yield function with respect to stress as $\\mathbf{n}$:\n$$ \\mathbf{n} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} \\left( \\sqrt{\\frac{3}{2}}\\,\\|\\mathbf{s}\\| - \\sigma_{y0} - H'\\kappa \\right) = \\sqrt{\\frac{3}{2}} \\frac{\\partial \\|\\mathbf{s}\\|}{\\partial \\boldsymbol{\\sigma}} $$\nThe derivative of the norm of the stress deviator $\\mathbf{s}$ with respect to the full stress tensor $\\boldsymbol{\\sigma}$ is $\\frac{\\mathbf{s}}{\\|\\mathbf{s}\\|}$. Thus, the flow direction is:\n$$ \\mathbf{n} = \\sqrt{\\frac{3}{2}} \\frac{\\mathbf{s}}{\\|\\mathbf{s}\\|} $$\nThis tensor $\\mathbf{n}$ is deviatoric, i.e., $\\mathrm{tr}(\\mathbf{n})=0$. Its squared norm is $\\mathbf{n}:\\mathbf{n} = \\frac{3}{2}$.\n\nThe derivative of the yield function with respect to the hardening variable $\\kappa$ is:\n$$ \\frac{\\partial f}{\\partial \\kappa} = -H' $$\nThe increment of the accumulated plastic strain $\\mathrm{d}\\kappa$ is related to the increment of the plastic multiplier $\\mathrm{d}\\lambda$. For the standard von Mises model, this relationship is $\\mathrm{d}\\kappa = \\mathrm{d}\\lambda$. This is derived from the work conjugacy principle, where $\\mathrm{d}\\kappa = \\sqrt{\\frac{2}{3}} \\|\\mathrm{d}\\boldsymbol{\\varepsilon}^p\\|$. Since the flow rule is $\\mathrm{d}\\boldsymbol{\\varepsilon}^p = \\mathrm{d}\\lambda \\mathbf{n}$, we have $\\|\\mathrm{d}\\boldsymbol{\\varepsilon}^p\\| = \\mathrm{d}\\lambda \\|\\mathbf{n}\\| = \\mathrm{d}\\lambda \\sqrt{\\frac{3}{2}}$, which leads to $\\mathrm{d}\\kappa = \\sqrt{\\frac{2}{3}} \\left( \\mathrm{d}\\lambda \\sqrt{\\frac{3}{2}} \\right) = \\mathrm{d}\\lambda$.\n\nSubstituting these into the consistency condition gives:\n$$ \\mathbf{n} : \\mathrm{d}\\boldsymbol{\\sigma} - H' \\mathrm{d}\\lambda = 0 \\implies \\mathbf{n} : \\mathrm{d}\\boldsymbol{\\sigma} = H' \\mathrm{d}\\lambda $$\nThe stress increment $\\mathrm{d}\\boldsymbol{\\sigma}$ is related to the total strain increment $\\mathrm{d}\\boldsymbol{\\varepsilon}$ through Hooke's law and the additive strain decomposition:\n$$ \\mathrm{d}\\boldsymbol{\\sigma} = C^e : \\mathrm{d}\\boldsymbol{\\varepsilon}^e = C^e : (\\mathrm{d}\\boldsymbol{\\varepsilon} - \\mathrm{d}\\boldsymbol{\\varepsilon}^p) = C^e : (\\mathrm{d}\\boldsymbol{\\varepsilon} - \\mathrm{d}\\lambda \\mathbf{n}) $$\nNow we substitute this expression for $\\mathrm{d}\\boldsymbol{\\sigma}$ into the consistency condition to solve for the plastic multiplier $\\mathrm{d}\\lambda$:\n$$ \\mathbf{n} : \\left[ C^e : (\\mathrm{d}\\boldsymbol{\\varepsilon} - \\mathrm{d}\\lambda \\mathbf{n}) \\right] = H' \\mathrm{d}\\lambda $$\n$$ \\mathbf{n} : C^e : \\mathrm{d}\\boldsymbol{\\varepsilon} - \\mathrm{d}\\lambda (\\mathbf{n} : C^e : \\mathbf{n}) = H' \\mathrm{d}\\lambda $$\n$$ \\mathrm{d}\\lambda = \\frac{\\mathbf{n} : C^e : \\mathrm{d}\\boldsymbol{\\varepsilon}}{H' + \\mathbf{n} : C^e : \\mathbf{n}} $$\nTo simplify the term $\\mathbf{n} : C^e : \\mathbf{n}$, we use the given form of $C^e = K\\,\\mathbf{I} \\otimes \\mathbf{I} + 2G\\,\\mathbb{I}_{\\mathrm{dev}}$ and the fact that $\\mathbf{n}$ is deviatoric. The action of $C^e$ on $\\mathbf{n}$ is:\n$$ C^e : \\mathbf{n} = (K\\,\\mathbf{I} \\otimes \\mathbf{I} + 2G\\,\\mathbb{I}_{\\mathrm{dev}}) : \\mathbf{n} = K (\\mathbf{I} : \\mathbf{n})\\mathbf{I} + 2G (\\mathbb{I}_{\\mathrm{dev}} : \\mathbf{n}) $$\nSince $\\mathrm{tr}(\\mathbf{n})=0$ and $\\mathbb{I}_{\\mathrm{dev}}$ is a projector onto the deviatoric space, this simplifies to:\n$$ C^e : \\mathbf{n} = 2G\\,\\mathbf{n} $$\nTherefore, the denominator term becomes:\n$$ H' + \\mathbf{n} : C^e : \\mathbf{n} = H' + \\mathbf{n} : (2G\\,\\mathbf{n}) = H' + 2G\\,(\\mathbf{n} : \\mathbf{n}) = H' + 2G\\,\\left(\\frac{3}{2}\\right) = H' + 3G $$\nThe elastoplastic tangent operator $C^{ep}$ is defined by $\\mathrm{d}\\boldsymbol{\\sigma} = C^{ep} : \\mathrm{d}\\boldsymbol{\\varepsilon}$. We find its expression by substituting the formula for $\\mathrm{d}\\lambda$ back into the relation for $\\mathrm{d}\\boldsymbol{\\sigma}$:\n$$ \\mathrm{d}\\boldsymbol{\\sigma} = C^e : \\mathrm{d}\\boldsymbol{\\varepsilon} - \\mathrm{d}\\lambda (C^e:\\mathbf{n}) = C^e : \\mathrm{d}\\boldsymbol{\\varepsilon} - \\frac{(C^e : \\mathbf{n}) \\otimes (\\mathbf{n} : C^e)}{H' + \\mathbf{n} : C^e : \\mathbf{n}} : \\mathrm{d}\\boldsymbol{\\varepsilon} $$\n$$ C^{ep} = C^e - \\frac{(C^e : \\mathbf{n}) \\otimes (C^e : \\mathbf{n})}{H' + 3G} $$\nUsing $C^e:\\mathbf{n} = 2G \\mathbf{n}$, this becomes:\n$$ C^{ep} = C^e - \\frac{(2G\\mathbf{n}) \\otimes (2G\\mathbf{n})}{H' + 3G} = K\\,\\mathbf{I} \\otimes \\mathbf{I} + 2G\\,\\mathbb{I}_{\\mathrm{dev}} - \\frac{4G^2}{H' + 3G} \\mathbf{n} \\otimes \\mathbf{n} $$\nThe problem asks for the eigenvalues of the deviatoric part of this operator, which we denote $C^{ep}_{\\mathrm{dev}}$. This operator maps a deviatoric strain increment $\\mathrm{d}\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}$ to a deviatoric stress increment $\\mathrm{d}\\mathbf{s}$. Noting that $\\mathbf{I}\\otimes\\mathbf{I}$ maps deviatoric tensors to zero and $\\mathbb{I}_{\\mathrm{dev}}$ acts as the identity on them, we obtain:\n$$ C^{ep}_{\\mathrm{dev}} = 2G\\,\\mathbb{I}_{\\mathrm{dev}} - \\frac{4G^2}{H' + 3G} \\mathbf{n} \\otimes \\mathbf{n} $$\nTo find the eigenvalues, we solve the eigenvalue problem $C^{ep}_{\\mathrm{dev}} : \\mathbf{v} = \\lambda \\mathbf{v}$, where $\\mathbf{v}$ is a non-zero deviatoric tensor.\n$$ \\left( 2G\\,\\mathbb{I}_{\\mathrm{dev}} - \\frac{4G^2}{H' + 3G} \\mathbf{n} \\otimes \\mathbf{n} \\right) : \\mathbf{v} = \\lambda \\mathbf{v} $$\n$$ 2G\\mathbf{v} - \\frac{4G^2}{H' + 3G} (\\mathbf{n} : \\mathbf{v}) \\mathbf{n} = \\lambda \\mathbf{v} $$\nWe consider two cases for the eigenvector $\\mathbf{v}$:\n\nCase 1: The eigenvector $\\mathbf{v}$ is parallel to the flow direction $\\mathbf{n}$.\nLet $\\mathbf{v} = c\\mathbf{n}$ for some non-zero scalar $c$.\n$$ 2G(c\\mathbf{n}) - \\frac{4G^2}{H' + 3G} (\\mathbf{n} : c\\mathbf{n}) \\mathbf{n} = \\lambda (c\\mathbf{n}) $$\nDividing by $c$ and using $\\mathbf{n} : \\mathbf{n} = \\frac{3}{2}$:\n$$ \\left( 2G - \\frac{4G^2}{H' + 3G} \\left(\\frac{3}{2}\\right) \\right) \\mathbf{n} = \\lambda \\mathbf{n} $$\n$$ \\lambda_1 = 2G - \\frac{6G^2}{H' + 3G} = \\frac{2G(H' + 3G) - 6G^2}{H' + 3G} = \\frac{2GH' + 6G^2 - 6G^2}{H' + 3G} = \\frac{2GH'}{H' + 3G} $$\n\nCase 2: The eigenvector $\\mathbf{v}$ is orthogonal to the flow direction $\\mathbf{n}$ (i.e., $\\mathbf{v}$ is in the hyperplane orthogonal to $\\mathbf{n}$ within the space of deviatoric tensors).\nHere, $\\mathbf{n} : \\mathbf{v} = 0$. The eigenvalue equation simplifies to:\n$$ 2G\\mathbf{v} - \\mathbf{0} = \\lambda \\mathbf{v} $$\n$$ \\lambda_2 = 2G $$\nThis eigenvalue has a multiplicity of $4$, corresponding to the dimensionality of the orthogonal complement of $\\mathbf{n}$ in the $5$-dimensional space of symmetric deviatoric tensors.\n\nTo find the smallest eigenvalue, we compare $\\lambda_1$ and $\\lambda_2$. Since $G > 0$ and the hardening modulus $H' \\ge 0$, we have $H' \\le H' + 3G$. Consequently, the fraction $\\frac{H'}{H' + 3G} \\le 1$. Therefore, $\\lambda_1 = 2G \\left(\\frac{H'}{H' + 3G}\\right) \\le 2G = \\lambda_2$. The smallest eigenvalue is $\\lambda_{\\min} = \\lambda_1$.\n$$ \\lambda_{\\min}(H',G) = \\frac{2GH'}{H' + 3G} $$\nIn the limit of perfect plasticity, $H' \\to 0$, the smallest eigenvalue $\\lambda_{\\min}$ approaches $0$. The tangent operator $C^{ep}$ ceases to be positive definite and becomes only positive semi-definite. This loss of strong ellipticity of the governing equations of equilibrium is a critical event. The mechanical significance is that the material loses all stiffness in the direction of plastic flow, $\\mathbf{n}$. This allows for deformation to occur under constant stress, which is the definition of perfect plastic flow. This mathematical condition is a prerequisite for the physical phenomenon of strain localization, such as the formation of shear bands, which can lead to material failure. In numerical simulations using the Finite Element Method (FEM), the singularity of the tangent stiffness matrix at the element level causes severe numerical difficulties and indicates the failure of the classical continuum formulation to describe the post-localization behavior.", "answer": "$$\n\\boxed{\\frac{2GH'}{H' + 3G}}\n$$", "id": "2547052"}, {"introduction": "While the consistent tangent is elegantly expressed as a fourth-order tensor $C^{ep}_{ijkl}$ in continuum mechanics, finite element codes require a matrix representation. This practice addresses the crucial and often error-prone task of converting the tensor into its Voigt matrix form, $D^{ep}$ [@problem_id:2547039]. You will learn to handle the conventions of engineering shear strain and the necessary symmetrization required by standard user material interfaces.", "problem": "A three-dimensional small-strain consistent elastoplastic tangent operator $C^{ep}_{ijkl}$ relates the symmetric Cauchy stress increment $d\\sigma_{ij}$ and the infinitesimal strain increment $d\\varepsilon_{kl}$ by the linearized relation $d\\sigma_{ij} = C^{ep}_{ijkl}\\, d\\varepsilon_{kl}$. In a finite element implementation through a User Material (UMAT) or User Element (UEL) interface, the tangent is provided in Voigt notation as a $6 \\times 6$ matrix $D^{ep}$ such that $d\\sigma^{V} = D^{ep}\\, d\\varepsilon^{V}$, where the Voigt vectors adopt the engineering-shear convention and the standard index order $[11,22,33,23,13,12]$. Concretely, the stress vector is $\\sigma^{V} = [\\sigma_{11},\\, \\sigma_{22},\\, \\sigma_{33},\\, \\sigma_{23},\\, \\sigma_{13},\\, \\sigma_{12}]^{\\mathsf{T}}$ and the strain vector is $\\varepsilon^{V} = [\\varepsilon_{11},\\, \\varepsilon_{22},\\, \\varepsilon_{33},\\, 2\\varepsilon_{23},\\, 2\\varepsilon_{13},\\, 2\\varepsilon_{12}]^{\\mathsf{T}}$. The interface expects that the fourth-order tangent respects the minor symmetries implied by stress and strain symmetry, namely $C^{ep}_{ijkl} = C^{ep}_{jikl} = C^{ep}_{ijlk}$, but it does not require major symmetry $C^{ep}_{ijkl} = C^{ep}_{klij}$ in general.\n\nYou are given a numerically computed algorithmic tangent around a return-mapping point that is slightly non-symmetric in each index pair due to finite differencing. To comply with the interface conventions, first enforce the minor symmetries by defining the pairwise-symmetrized tensor\n$$\n\\widetilde{C}^{ep}_{ijkl} \\equiv \\frac{1}{4}\\big(C^{ep}_{ijkl} + C^{ep}_{jikl} + C^{ep}_{ijlk} + C^{ep}_{jilk}\\big).\n$$\nThe only nonzero components you need for this task are reported (in gigapascals) as\n$$\nC^{ep}_{2313} = 7.20,\\quad C^{ep}_{2331} = 7.28,\\quad C^{ep}_{3213} = 7.16,\\quad C^{ep}_{3231} = 7.36.\n$$\n\nUsing only the foundational relation $d\\sigma_{ij} = C^{ep}_{ijkl}\\, d\\varepsilon_{kl}$, the stated Voigt mapping with engineering shear, and the required minor symmetrization step above, map $\\widetilde{C}^{ep}$ to the Voigt matrix $D^{ep}$ and determine the single matrix entry $D^{ep}_{45}$ (row $4$, column $5$), which couples $\\sigma_{23}$ to $2\\varepsilon_{13}$ in the UMAT/UEL convention. Express your final result in $\\mathrm{GPa}$ and round your answer to four significant figures.", "solution": "The problem is subjected to validation.\n\n**Step 1: Extracted Givens**\n- Constitutive relation: $d\\sigma_{ij} = C^{ep}_{ijkl}\\, d\\varepsilon_{kl}$, where $d\\sigma_{ij}$ and $d\\varepsilon_{kl}$ are symmetric.\n- Voigt notation relation: $d\\sigma^{V} = D^{ep}\\, d\\varepsilon^{V}$.\n- Voigt stress vector mapping: $\\sigma^{V} = [\\sigma_{11},\\, \\sigma_{22},\\, \\sigma_{33},\\, \\sigma_{23},\\, \\sigma_{13},\\, \\sigma_{12}]^{\\mathsf{T}}$. The indices map as $1 \\to 11$, $2 \\to 22$, $3 \\to 33$, $4 \\to 23$, $5 \\to 13$, $6 \\to 12$.\n- Voigt strain vector mapping (engineering shear): $\\varepsilon^{V} = [\\varepsilon_{11},\\, \\varepsilon_{22},\\, \\varepsilon_{33},\\, 2\\varepsilon_{23},\\, 2\\varepsilon_{13},\\, 2\\varepsilon_{12}]^{\\mathsf{T}}$.\n- Required minor symmetries for the tangent provided to the interface: $C^{ep}_{ijkl} = C^{ep}_{jikl}$ and $C^{ep}_{ijkl} = C^{ep}_{ijlk}$. Major symmetry not required.\n- Symmetrization rule for a numerically computed tangent $C^{ep}$: $\\widetilde{C}^{ep}_{ijkl} \\equiv \\frac{1}{4}\\big(C^{ep}_{ijkl} + C^{ep}_{jikl} + C^{ep}_{ijlk} + C^{ep}_{jilk}\\big)$.\n- Numerical values of non-symmetric components (in gigapascals):\n$C^{ep}_{2313} = 7.20$, $C^{ep}_{2331} = 7.28$, $C^{ep}_{3213} = 7.16$, $C^{ep}_{3231} = 7.36$.\n- Objective: Determine the Voigt matrix entry $D^{ep}_{45}$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, describing a standard procedure in computational solid mechanics for handling material tangent operators in finite element codes. The definitions of Voigt notation, engineering shear strain, and the symmetrization procedure are consistent with established practice. The problem is well-posed, providing all necessary data and a clear objective. The language is precise and objective. There are no contradictions or ambiguities.\n\n**Step 3: Verdict**\nThe problem is valid. A solution will be provided.\n\n**Solution Derivation**\n\nThe primary task is to establish the precise mathematical relationship between the components of the fourth-order tensor $\\widetilde{C}^{ep}_{ijkl}$ and the components of the second-order Voigt matrix $D^{ep}_{IJ}$. The constitutive law is expressed using the symmetrized tensor $\\widetilde{C}^{ep}_{ijkl}$:\n$$d\\sigma_{ij} = \\widetilde{C}^{ep}_{ijkl}\\, d\\varepsilon_{kl}$$\nHere, summation over repeated indices $k$ and $l$ from $1$ to $3$ is implied. The Voigt matrix form of this law is:\n$$d\\sigma^V_I = D^{ep}_{IJ}\\, d\\varepsilon^V_J$$\n\nWe want to find the component $D^{ep}_{45}$. According to the specified Voigt mapping, the index $I=4$ corresponds to the stress component $\\sigma_{23}$, and the index $J=5$ corresponds to the strain component $2\\varepsilon_{13}$.\n\nLet us expand the tensor equation for the stress increment component $d\\sigma_{23}$:\n$$d\\sigma_{23} = \\sum_{k=1}^3 \\sum_{l=1}^3 \\widetilde{C}^{ep}_{23kl}\\, d\\varepsilon_{kl}$$\nSince the infinitesimal strain tensor $d\\varepsilon_{kl}$ is symmetric ($d\\varepsilon_{kl} = d\\varepsilon_{lk}$), we can group terms in the expansion:\n$$d\\sigma_{23} = \\sum_{p=1}^3 \\widetilde{C}^{ep}_{23pp}\\,d\\varepsilon_{pp} + \\sum_{pq} (\\widetilde{C}^{ep}_{23pq}\\,d\\varepsilon_{pq} + \\widetilde{C}^{ep}_{23qp}\\,d\\varepsilon_{qp})$$\nUsing $d\\varepsilon_{pq} = d\\varepsilon_{qp}$, this becomes:\n$$d\\sigma_{23} = \\sum_{p=1}^3 \\widetilde{C}^{ep}_{23pp}\\,d\\varepsilon_{pp} + \\sum_{pq} (\\widetilde{C}^{ep}_{23pq} + \\widetilde{C}^{ep}_{23qp})\\,d\\varepsilon_{pq}$$\nThe symmetrized tensor $\\widetilde{C}^{ep}_{ijkl}$ is constructed to possess minor symmetries, i.e., $\\widetilde{C}^{ep}_{ijkl} = \\widetilde{C}^{ep}_{jikl}$ and $\\widetilde{C}^{ep}_{ijkl} = \\widetilde{C}^{ep}_{ijlk}$. Let us verify this in the context of our problem. The term we require involves $\\widetilde{C}^{ep}_{23pq}$ and $\\widetilde{C}^{ep}_{23qp}$. The problem statement requires the *interface* to receive a tangent with minor symmetries, and this is why the symmetrization step on $C^{ep}$ is performed. The resulting tensor $\\widetilde{C}^{ep}$ does in fact possess these symmetries. For example, $\\widetilde{C}^{ep}_{ijlk} = \\frac{1}{4}(C^{ep}_{ijlk} + C^{ep}_{jilk} + C^{ep}_{ijkl} + C^{ep}_{jikl}) = \\widetilde{C}^{ep}_{ijkl}$.\n\nDue to the symmetry $\\widetilde{C}^{ep}_{23pq} = \\widetilde{C}^{ep}_{23qp}$ not being guaranteed (this would be a different symmetry property), we must keep both terms. However, we are only interested in the component related to $d\\varepsilon_{13}$, which corresponds to setting $(p,q)$ or $(q,p)$ to $(1,3)$. The relevant part of the sum for $d\\sigma_{23}$ is:\n$$d\\sigma_{23} = \\dots + (\\widetilde{C}^{ep}_{2313} + \\widetilde{C}^{ep}_{2331})\\,d\\varepsilon_{13} + \\dots$$\n\nNow, we relate the tensor strain increment $d\\varepsilon_{13}$ to its Voigt counterpart $d\\varepsilon^V_5$. From the definition $\\varepsilon^{V} = [\\dots, 2\\varepsilon_{13}, \\dots]^{\\mathsf{T}}$, we have $d\\varepsilon^V_5 = 2d\\varepsilon_{13}$, which implies $d\\varepsilon_{13} = \\frac{1}{2}d\\varepsilon^V_5$.\nSubstituting this into the expression for $d\\sigma_{23}$:\n$$d\\sigma_{23} = \\dots + (\\widetilde{C}^{ep}_{2313} + \\widetilde{C}^{ep}_{2331}) \\left(\\frac{1}{2} d\\varepsilon^V_5\\right) + \\dots$$\n$$d\\sigma_{23} = \\dots + \\frac{1}{2}(\\widetilde{C}^{ep}_{2313} + \\widetilde{C}^{ep}_{2331})\\,d\\varepsilon^V_5 + \\dots$$\n\nFrom the Voigt relation, with $I=4$ corresponding to $\\sigma_{23}$, we have:\n$$d\\sigma_{23} = d\\sigma^V_4 = \\sum_{J=1}^6 D^{ep}_{4J}\\,d\\varepsilon^V_J = \\dots + D^{ep}_{45}\\,d\\varepsilon^V_5 + \\dots$$\nBy comparing the coefficients of $d\\varepsilon^V_5$ in the two expressions for $d\\sigma_{23}$, we find:\n$$D^{ep}_{45} = \\frac{1}{2}(\\widetilde{C}^{ep}_{2313} + \\widetilde{C}^{ep}_{2331})$$\nThe tensor $\\widetilde{C}^{ep}$ has minor symmetry in the last two indices, $\\widetilde{C}^{ep}_{ijkl} = \\widetilde{C}^{ep}_{ijlk}$. Applying this to our components: $\\widetilde{C}^{ep}_{2313} = \\widetilde{C}^{ep}_{2331}$. Therefore, the expression simplifies:\n$$D^{ep}_{45} = \\frac{1}{2}(\\widetilde{C}^{ep}_{2313} + \\widetilde{C}^{ep}_{2313}) = \\widetilde{C}^{ep}_{2313}$$\n\nThe final step is to compute the value of $\\widetilde{C}^{ep}_{2313}$ using the given formula and data.\nThe symmetrization formula is:\n$$\\widetilde{C}^{ep}_{ijkl} = \\frac{1}{4}\\big(C^{ep}_{ijkl} + C^{ep}_{jikl} + C^{ep}_{ijlk} + C^{ep}_{jilk}\\big)$$\nFor the indices $i=2, j=3, k=1, l=3$:\n$$\\widetilde{C}^{ep}_{2313} = \\frac{1}{4}\\big(C^{ep}_{2313} + C^{ep}_{3213} + C^{ep}_{2331} + C^{ep}_{3231}\\big)$$\nSubstituting the numerical values provided in the problem statement (all in $\\mathrm{GPa}$):\n$C^{ep}_{2313} = 7.20$\n$C^{ep}_{3213} = 7.16$\n$C^{ep}_{2331} = 7.28$\n$C^{ep}_{3231} = 7.36$\n$$\\widetilde{C}^{ep}_{2313} = \\frac{1}{4}(7.20 + 7.16 + 7.28 + 7.36)$$\n$$\\widetilde{C}^{ep}_{2313} = \\frac{1}{4}(29.00) = 7.25$$\nSo, $D^{ep}_{45} = 7.25 \\, \\mathrm{GPa}$. The problem requires the answer to four significant figures.\n\nFinal result: $D^{ep}_{45} = 7.250 \\, \\mathrm{GPa}$.", "answer": "$$\\boxed{7.250}$$", "id": "2547039"}, {"introduction": "A correct analytical derivation is not enough; the coded tangent must be the *exact* linearization of the coded stress update to ensure quadratic convergence in a Newton-Raphson scheme. This comprehensive exercise challenges you to implement a numerical perturbation test, a standard industry practice for verifying your user material subroutine [@problem_id:2547062]. Successfully completing this test provides confidence that your implementation is correct and will be numerically efficient.", "problem": "Design and implement a self-contained program that constructs a finite-difference perturbation test to numerically verify a coded consistent elastoplastic tangent operator for small-strain, associative, isotropic, rate-independent elastoplasticity with linear isotropic hardening. The goal is to verify that the consistent elastoplastic tangent operator $C^{ep}$ satisfies the directional derivative definition\n$$\nC^{ep}_{ijkl} \\approx \\frac{\\sigma_{ij}(\\varepsilon + \\delta\\,\\Delta\\varepsilon^{(kl)}) - \\sigma_{ij}(\\varepsilon)}{\\delta}\n$$\nto within a prescribed tolerance, for each independent symmetric strain component $(k,l)$, where $\\Delta\\varepsilon^{(kl)}$ is the symmetric perturbation direction that corresponds to a unit perturbation in the $(k,l)$ component of the symmetric strain tensor.\n\nThe material model is posed in three dimensions under the small-strain assumption. Use the following fundamental base and widely accepted facts:\n\n- Kinematics: the infinitesimal strain tensor is $\\varepsilon = \\tfrac{1}{2}(\\nabla u + (\\nabla u)^{T})$, with trace $\\mathrm{tr}(\\varepsilon)$ and deviatoric part $\\mathrm{dev}(\\varepsilon) = \\varepsilon - \\tfrac{1}{3}\\mathrm{tr}(\\varepsilon)\\,I$, where $I$ is the second-order identity.\n- Isotropic linear elasticity: bulk modulus $K = \\dfrac{E}{3(1-2\\nu)}$, shear modulus $G = \\dfrac{E}{2(1+\\nu)}$, and elastic stiffness in fourth-order notation $C^{e} = K\\,I\\otimes I + 2G\\,I^{\\mathrm{dev}}$, where $I^{\\mathrm{dev}}$ is the fourth-order deviatoric projector.\n- Von Mises type yield function based on the Frobenius norm of the deviatoric stress $s$: define $q = \\|s\\| = \\sqrt{s:s}$ and the yield function $f(s,\\alpha) = q - (\\sigma_{y0} + H\\,\\alpha)$, where $\\sigma_{y0}$ is the initial yield stress and $H$ is the linear isotropic hardening modulus. The internal variable $\\alpha$ is the accumulated plastic strain with increment $\\Delta \\alpha = \\Delta \\gamma$, where $\\Delta \\gamma$ is the plastic multiplier increment.\n- Associative flow rule and standard return-mapping: in an incremental step from an initially stress-free state with $\\alpha_{n} = 0$, form the trial deviatoric stress $s^{\\mathrm{tr}} = 2G\\,\\mathrm{dev}(\\varepsilon)$, its norm $r = \\|s^{\\mathrm{tr}}\\|$, and $c = \\sigma_{y0} + H\\,\\alpha_{n} = \\sigma_{y0}$. If $r \\le c$, the response is elastic. If $r  c$, plastic correction occurs with radial return: define the unit normal $n = s^{\\mathrm{tr}}/r$, the plastic multiplier $\\Delta \\gamma = \\dfrac{r - c}{2G + H}$, and the corrected deviatoric stress $s = s^{\\mathrm{tr}} - 2G\\,\\Delta \\gamma\\,n$. The Cauchy stress is $\\sigma = K\\,\\mathrm{tr}(\\varepsilon)\\,I + s$.\n\nYour task is to:\n\n- Implement a function that, for a given symmetric strain tensor $\\varepsilon$, returns the Cauchy stress tensor $\\sigma(\\varepsilon)$ and the consistent elastoplastic tangent operator $C^{ep}(\\varepsilon)$, obtained by linearizing the above return-mapping equations about the converged stress state.\n- Implement a finite-difference (forward difference) perturbation procedure to approximate each column $C^{ep}_{ij\\,kl}$ by perturbing the symmetric strain tensor in the $(k,l)$ component. The perturbation must preserve symmetry: for $k=l$, set $\\Delta\\varepsilon^{(kk)}_{kk} = \\delta$; for $k\\ne l$, set $\\Delta\\varepsilon^{(kl)}_{kl} = \\Delta\\varepsilon^{(kl)}_{lk} = \\delta/2$, and all other components zero, so that\n$$\n\\frac{\\sigma_{ij}(\\varepsilon + \\delta\\,\\Delta\\varepsilon^{(kl)}) - \\sigma_{ij}(\\varepsilon)}{\\delta} \\approx C^{ep}_{ij\\,kl}.\n$$\n- Quantify the verification by computing, for each test case, the maximum relative Frobenius-norm error across all independent $(k,l)$:\n$$\n\\mathrm{err} = \\max_{k\\le l} \\frac{\\left\\| \\frac{\\sigma(\\varepsilon + \\delta\\,\\Delta\\varepsilon^{(kl)}) - \\sigma(\\varepsilon)}{\\delta} - C^{ep}:\\Delta\\varepsilon^{(kl)} \\right\\|_F}{\\max\\left(\\left\\|C^{ep}:\\Delta\\varepsilon^{(kl)}\\right\\|_F,\\,1\\right)}.\n$$\nDeclare the test case as passing if $\\mathrm{err} \\le \\tau$, where $\\tau$ is the prescribed tolerance for that case.\n\nThe program must implement all fourth-order tensor operations in a basis-invariant manner using standard Kronecker deltas, the symmetric fourth-order identity $I^{\\mathrm{sym}}$, the volumetric projector $I^{\\mathrm{vol}} = \\tfrac{1}{3}I\\otimes I$, and the deviatoric projector $I^{\\mathrm{dev}} = I^{\\mathrm{sym}} - I^{\\mathrm{vol}}$, and must produce a single-line output that aggregates pass/fail booleans for a provided test suite.\n\nUse the following test suite of parameter values, designed to cover a typical elastic state, a plastic state well inside the plastic regime, and a hydrostatic elastic state. All numbers are dimensionless but consistent; the final outputs are booleans, hence unitless.\n\n- Material parameters common to all tests: Young’s modulus $E = 2.1\\times 10^{5}$, Poisson’s ratio $\\nu = 0.3$, initial yield stress $\\sigma_{y0} = 250$, hardening modulus $H = 1000$.\n- Perturbation magnitude for finite differences: $\\delta = 10^{-8}$.\n- Tolerances:\n    - Elastic regime tolerance $\\tau_{\\mathrm{el}} = 10^{-7}$.\n    - Plastic regime tolerance $\\tau_{\\mathrm{pl}} = 10^{-6}$.\n    - Hydrostatic elastic tolerance $\\tau_{\\mathrm{hy}} = 10^{-9}$.\n\n- Test cases (each is a symmetric strain tensor $\\varepsilon$):\n    - Case A (elastic, mixed deviatoric-volumetric): \n      $\n      \\varepsilon =\n      \\begin{bmatrix}\n      1\\times 10^{-5}  2\\times 10^{-6}  -1\\times 10^{-6} \\\\\n      2\\times 10^{-6}  -5\\times 10^{-6}  0 \\\\\n      -1\\times 10^{-6}  0  0\n      \\end{bmatrix}\n      $\n      with tolerance $\\tau = \\tau_{\\mathrm{el}}$.\n    - Case B (plastic, well inside plastic regime):\n      $\n      \\varepsilon =\n      \\begin{bmatrix}\n      5\\times 10^{-3}  2\\times 10^{-3}  -1\\times 10^{-3} \\\\\n      2\\times 10^{-3}  -3\\times 10^{-3}  5\\times 10^{-4} \\\\\n      -1\\times 10^{-3}  5\\times 10^{-4}  -2\\times 10^{-3}\n      \\end{bmatrix}\n      $\n      with tolerance $\\tau = \\tau_{\\mathrm{pl}}$.\n    - Case C (pure hydrostatic elastic):\n      $\n      \\varepsilon =\n      \\begin{bmatrix}\n      1\\times 10^{-3}  0  0 \\\\\n      0  1\\times 10^{-3}  0 \\\\\n      0  0  1\\times 10^{-3}\n      \\end{bmatrix}\n      $\n      with tolerance $\\tau = \\tau_{\\mathrm{hy}}$.\n\nProgram requirements:\n\n- The program must compute, for each test case, the boolean pass/fail result defined by the above error metric and tolerance.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,True,False]\") in the order of the test cases A, B, C.\n- No user input is allowed; all data must be embedded in the program.\n\nNote: All mathematical derivations and implementations must respect tensor minor and major symmetries. The perturbation for off-diagonal components must be split as $\\delta/2$ on both symmetric positions to represent a unit perturbation of the single independent component $\\varepsilon_{kl}$ with $k\\ne l$.", "solution": "The task is to design and implement a numerical test to verify the correctness of a coded consistent elastoplastic tangent operator, $C^{ep}$, for a small-strain $J_2$ plasticity model with linear isotropic hardening. The verification is based on the definition of the tangent operator as the directional derivative of the stress tensor $\\sigma$ with respect to the strain tensor $\\varepsilon$, which is approximated using a forward finite-difference scheme.\n\nThe constitutive model is first defined. The total strain $\\varepsilon$ is additively decomposed into an elastic part $\\varepsilon^e$ and a plastic part $\\varepsilon^p$. The model is defined in a rate-independent, incremental form. For a given total strain $\\varepsilon$ (relative to an initial stress-free state), the stress $\\sigma$ and the consistent tangent $C^{ep}$ are determined.\n\nThe fundamental relations are:\n- **Elastic Law**: The stress is related to the elastic strain via Hooke's law for an isotropic material. It is convenient to decompose the stress and strain into volumetric and deviatoric parts. The volumetric part of the stress (pressure $p$) is related to the volumetric strain ($\\mathrm{tr}(\\varepsilon)$) via the bulk modulus $K = \\frac{E}{3(1-2\\nu)}$. The deviatoric stress $s$ is related to the deviatoric elastic strain $\\mathrm{dev}(\\varepsilon^e)$ via the shear modulus $G = \\frac{E}{2(1+\\nu)}$. The total Cauchy stress is $\\sigma = K\\,\\mathrm{tr}(\\varepsilon^e)I + 2G\\,\\mathrm{dev}(\\varepsilon^e)$. Since plastic flow is assumed to be isochoric, $\\mathrm{tr}(\\varepsilon^p)=0$, which implies $\\mathrm{tr}(\\varepsilon^e) = \\mathrm{tr}(\\varepsilon)$. Thus, $\\sigma = K\\,\\mathrm{tr}(\\varepsilon)I + s$, where $s = 2G\\,\\mathrm{dev}(\\varepsilon^e)$.\n\n- **Yield Criterion**: Plastic deformation occurs when the von Mises yield function $f(\\sigma, \\alpha)$ reaches zero. The function is defined as $f(s, \\alpha) = q - (\\sigma_{y0} + H\\alpha)$, where $q = \\|s\\|_F = \\sqrt{s:s}$ is the Frobenius norm of the deviatoric stress, $\\sigma_{y0}$ is the initial yield stress, $H$ is the linear isotropic hardening modulus, and $\\alpha$ is the accumulated plastic strain.\n\n- **Flow Rule and Return Mapping**: The associative flow rule dictates that the increment of plastic strain is normal to the yield surface. For the von Mises criterion, this means the deviatoric stress and the plastic strain rate are coaxial. The state update is performed using a standard radial return mapping algorithm.\n1.  A trial elastic deviatoric stress is computed: $s^{\\mathrm{tr}} = 2G\\,\\mathrm{dev}(\\varepsilon)$.\n2.  The trial yield function is evaluated: $f^{\\mathrm{tr}} = \\|s^{\\mathrm{tr}}\\| - \\sigma_y$, where $\\sigma_y = \\sigma_{y0} + H\\alpha_n$. Since the problem specifies an increment from a virgin state, $\\alpha_n=0$, so $\\sigma_y = \\sigma_{y0}$.\n3.  If $f^{\\mathrm{tr}} \\le 0$, the step is elastic. The state is updated as $s = s^{\\mathrm{tr}}$ and no plastic strain occurs ($\\Delta\\alpha=0$).\n4.  If $f^{\\mathrm{tr}}  0$, plastic flow occurs. The plastic multiplier increment $\\Delta\\gamma$ is computed as $\\Delta\\gamma = \\frac{f^{\\mathrm{tr}}}{2G + H}$. The deviatoric stress is returned to the yield surface via the radial path: $s = s^{\\mathrm{tr}} - 2G\\Delta\\gamma n$, where $n = s^{\\mathrm{tr}}/\\|s^{\\mathrm{tr}}\\|$ is the unit normal direction. The accumulated plastic strain is updated: $\\alpha = \\alpha_n + \\Delta\\gamma = \\Delta\\gamma$.\n\nThe consistent tangent operator $C^{ep} = \\frac{d\\sigma}{d\\varepsilon}$ is obtained by analytically linearizing this return mapping algorithm. The form of $C^{ep}$ depends on whether the step is elastic or plastic.\n- **Elastic Tangent**: If the state is elastic, the stress is linearly related to the strain, $\\sigma = C^e : \\varepsilon$, where $C^e$ is the fourth-order elastic stiffness tensor. The tangent operator is simply $C^{ep} = C^e = K(I \\otimes I) + 2G I^{\\mathrm{dev}}$. Here, $I$ is the second-order identity, $I \\otimes I$ is the volumetric projection operator (scaled by $1/3$), and $I^{\\mathrm{dev}} = I^{\\mathrm{sym}} - \\frac{1}{3}I \\otimes I$ is the deviatoric projection operator, with $I^{\\mathrm{sym}}_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})$.\n\n- **Elastoplastic Tangent**: If the state is plastic, the linearization of the radial return algorithm yields the consistent tangent. The derivation involves applying the chain rule to all variables in the return mapping equations. The resulting operator is:\n$$ C^{ep} = K(I \\otimes I) + 2G(1-\\beta)I^{\\mathrm{dev}} - 2G\\gamma_c(n \\otimes n) $$\nwhere $r = \\|s^{\\mathrm{tr}}\\|$, $n=s^{\\mathrm{tr}}/r$, and the coefficients $\\beta$ and $\\gamma_c$ are given by:\n$$ \\beta = \\frac{2G\\Delta\\gamma}{r} $$\n$$ \\gamma_c = \\frac{2G}{2G+H} - \\beta $$\nThis form ensures quadratic convergence in Newton-Raphson solvers for which it is designed.\n\nThe numerical verification, or perturbation test, is structured as follows:\n1.  For a given strain tensor $\\varepsilon$, compute the baseline stress $\\sigma(\\varepsilon)$ and the analytical tangent operator $C^{ep}(\\varepsilon)$ using the material model logic described above.\n2.  Define a set of six linearly independent, symmetric perturbation direction tensors, $\\{V^{(p)}\\}_{p=1}^6$. These directions correspond to unit perturbations in the independent components of the strain tensor within a Voigt notation framework. For example, a perturbation in $\\varepsilon_{11}$ corresponds to $V^{(1)}$ with a $1$ in the $(1,1)$ component. A perturbation in $\\varepsilon_{12}$ corresponds to $V^{(4)}$ with a $0.5$ in both the $(1,2)$ and $(2,1)$ components.\n3.  For each perturbation direction $V^{(p)}$, perform the following:\n    a.  Compute a perturbed strain $\\varepsilon' = \\varepsilon + \\delta V^{(p)}$, where $\\delta$ is a small number (e.g., $10^{-8}$).\n    b.  Compute the stress at the perturbed state, $\\sigma' = \\sigma(\\varepsilon')$, by re-running the full material model.\n    c.  Calculate the numerical approximation of the directional derivative: $D_{\\mathrm{num}}^{(p)} = \\frac{\\sigma' - \\sigma}{\\delta}$.\n    d.  Calculate the analytical directional derivative using the consistent tangent: $D_{\\mathrm{ana}}^{(p)} = C^{ep} : V^{(p)}$.\n    e.  Compute the relative error between the numerical and analytical results:\n        $$ \\mathrm{err}^{(p)} = \\frac{\\|D_{\\mathrm{num}}^{(p)} - D_{\\mathrm{ana}}^{(p)}\\|_F}{\\max(\\|D_{\\mathrm{ana}}^{(p)}\\|_F, 1.0)} $$\n        The floor of $1.0$ in the denominator prevents division by zero and provides a measure of absolute error when the analytical derivative is small.\n4.  The overall error for the test case is the maximum error found across all six perturbation directions, $\\mathrm{err} = \\max_{p} \\mathrm{err}^{(p)}$.\n5.  This error is compared against a prescribed tolerance, $\\tau$. The test passes if $\\mathrm{err} \\le \\tau$.\n\nThe implementation uses `numpy` for all tensor representations and operations. Second-order tensors are represented as $3 \\times 3$ arrays, and fourth-order tensors as $3 \\times 3 \\times 3 \\times 3$ arrays. Tensor contractions (dot products, outer products) are elegantly handled using `numpy.einsum`. The program iterates through the provided test cases, each with a specific strain tensor and tolerance, and reports a boolean pass/fail result for each.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the finite-difference perturbation test for the\n    consistent elastoplastic tangent operator.\n    \"\"\"\n    \n    # Material parameters (common to all tests)\n    E = 2.1e5\n    NU = 0.3\n    SIGMA_Y0 = 250.0\n    H = 1000.0\n    \n    # Numerical parameters\n    DELTA = 1e-8\n    \n    # Test cases: (strain_tensor, tolerance)\n    TOL_EL = 1e-7\n    TOL_PL = 1e-6\n    TOL_HY = 1e-9\n    \n    test_cases = [\n        (np.array([\n            [1e-5, 2e-6, -1e-6],\n            [2e-6, -5e-6, 0.0],\n            [-1e-6, 0.0, 0.0]\n        ]), TOL_EL, \"Elastic\"),\n        (np.array([\n            [5e-3, 2e-3, -1e-3],\n            [2e-3, -3e-3, 5e-4],\n            [-1e-3, 5e-4, -2e-3]\n        ]), TOL_PL, \"Plastic\"),\n        (np.array([\n            [1e-3, 0.0, 0.0],\n            [0.0, 1e-3, 0.0],\n            [0.0, 0.0, 1e-3]\n        ]), TOL_HY, \"Hydrostatic Elastic\"),\n    ]\n\n    # Pre-compute derived material properties and constant tensors\n    K_bulk = E / (3.0 * (1.0 - 2.0 * NU))\n    G_shear = E / (2.0 * (1.0 + NU))\n\n    I = np.eye(3)\n    # Note: np.einsum is used for basis-agnostic tensor algebra\n    I_dyad_I = np.einsum('ij,kl-ijkl', I, I)\n    \n    # Symmetric fourth-order identity tensor I_sym\n    delta = np.eye(3)\n    I_sym = 0.5 * (np.einsum('ik,jl', delta, delta) + np.einsum('il,jk', delta, delta))\n    \n    # Deviatoric projection tensor\n    I_dev = I_sym - (1.0/3.0) * I_dyad_I\n\n    def get_stress_and_tangent(epsilon):\n        \"\"\"\n        Computes Cauchy stress and consistent tangent for small-strain J2 plasticity.\n        \"\"\"\n        tr_eps = np.trace(epsilon)\n        dev_eps = epsilon - (tr_eps / 3.0) * I\n        \n        s_tr = 2.0 * G_shear * dev_eps\n        r_tr = np.linalg.norm(s_tr)\n        \n        # Machine precision epsilon for safe division\n        machine_eps = 1e-12 \n\n        # Yield condition check\n        yield_check = r_tr - SIGMA_Y0\n        \n        if yield_check = 0.0 or r_tr  machine_eps:\n            # Elastic case\n            sigma = K_bulk * tr_eps * I + s_tr\n            C_ep = K_bulk * I_dyad_I + 2.0 * G_shear * I_dev\n        else:\n            # Plastic case (radial return)\n            n_dir = s_tr / r_tr\n            delta_gamma = yield_check / (2.0 * G_shear + H)\n            \n            s = s_tr - 2.0 * G_shear * delta_gamma * n_dir\n            sigma = K_bulk * tr_eps * I + s\n            \n            # Consistent elastoplastic tangent\n            beta = 2.0 * G_shear * delta_gamma / r_tr\n            gamma_c = (2.0 * G_shear / (2.0 * G_shear + H)) - beta\n            \n            n_dyad_n = np.einsum('ij,kl-ijkl', n_dir, n_dir)\n            \n            C_ep = (K_bulk * I_dyad_I + \n                    2.0 * G_shear * (1.0 - beta) * I_dev - \n                    2.0 * G_shear * gamma_c * n_dyad_n)\n            \n        return sigma, C_ep\n\n    # Perturbation directions corresponding to Voigt basis\n    perturb_dirs = []\n    # Diagonal components\n    for i in range(3):\n        v = np.zeros((3, 3))\n        v[i, i] = 1.0\n        perturb_dirs.append(v)\n    # Off-diagonal components\n    for i, j in [(0, 1), (0, 2), (1, 2)]:\n        v = np.zeros((3, 3))\n        v[i, j] = 0.5\n        v[j, i] = 0.5\n        perturb_dirs.append(v)\n\n    results = []\n    for epsilon_base, tolerance, _ in test_cases:\n        sigma_base, C_ep_base = get_stress_and_tangent(epsilon_base)\n        \n        max_err = 0.0\n        for v_dir in perturb_dirs:\n            # Perturb strain\n            epsilon_pert = epsilon_base + DELTA * v_dir\n            \n            # Get perturbed stress\n            sigma_pert, _ = get_stress_and_tangent(epsilon_pert)\n            \n            # Numerical directional derivative (Forward Difference)\n            D_num = (sigma_pert - sigma_base) / DELTA\n            \n            # Analytical directional derivative\n            D_ana = np.einsum('ijkl,kl-ij', C_ep_base, v_dir)\n            \n            # Error calculation\n            numerator = np.linalg.norm(D_num - D_ana)\n            denominator = max(np.linalg.norm(D_ana), 1.0)\n            \n            err = numerator / denominator\n            if err  max_err:\n                max_err = err\n        \n        results.append(max_err = tolerance)\n        \n    print(f\"[{','.join(map(str, [r for r in results]))}]\")\n\nsolve()\n```", "id": "2547062"}]}