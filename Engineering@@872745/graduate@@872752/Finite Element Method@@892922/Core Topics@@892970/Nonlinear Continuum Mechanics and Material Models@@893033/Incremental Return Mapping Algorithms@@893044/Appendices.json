{"hands_on_practices": [{"introduction": "The core of a return mapping algorithm is solving the consistency condition to find the plastic multiplier, $\\Delta \\gamma$. While linear hardening models admit a simple closed-form solution, realistic nonlinear hardening requires solving a scalar nonlinear equation. This practice challenges you to analyze and select robust numerical strategies, such as safeguarded Newton methods, to ensure the solver for $\\Delta \\gamma$ is globally convergent, a critical requirement for any production-level code. [@problem_id:2568881]", "problem": "Consider small-strain associative elastoplasticity with an isotropic von Mises yield condition and nonlinear isotropic hardening with saturation. Let the Cauchy stress be decomposed as $\\boldsymbol{\\sigma} = \\mathbf{C} : (\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p})$, where $\\mathbf{C}$ is the isotropic elastic stiffness, and let the deviatoric stress be $\\mathbf{s} = \\operatorname{dev}(\\boldsymbol{\\sigma})$. The yield function is $f(\\boldsymbol{\\sigma}, \\alpha) = \\lVert \\mathbf{s} \\rVert - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}(\\alpha)$, where the hardening stress $\\sigma_{y}(\\alpha)$ is $C^{1}$, strictly increasing, and bounded above (saturation), for example $\\sigma_{y}(\\alpha) = \\sigma_{\\infty} - (\\sigma_{\\infty} - \\sigma_{0}) \\exp(-b\\,\\alpha)$ with parameters $\\sigma_{\\infty}  \\sigma_{0}  0$ and $b  0$. The internal variable $\\alpha$ is the accumulated plastic strain, evolving according to $d\\alpha = \\sqrt{\\tfrac{2}{3}}\\, d\\gamma$ with plastic multiplier increment $d\\gamma \\ge 0$.\n\nUsing the implicit backward Euler return-mapping for a time step from $n$ to $n+1$, define the trial state at step $n+1$ by $\\mathbf{s}_{\\mathrm{tr}} = \\mathbf{s}_{n} + 2\\mu\\, \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$, where $\\mu$ is the shear modulus and $\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$ is the increment of deviatoric strain. Assume the trial state is plastically admissible such that $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n})  0$. The backward Euler update with associative flow leads to a scalar consistency condition for the plastic multiplier increment $\\Delta \\gamma \\ge 0$ of the form\n$$\nr(\\Delta \\gamma) \\equiv \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = 0.\n$$\nOne wishes to solve $r(\\Delta \\gamma) = 0$ robustly using either a safeguarded Newton method with bracketing or a line search globalization on a suitable merit function.\n\nSelect all statements that give sufficient conditions and constructions ensuring global convergence to the unique solution $\\Delta \\gamma^{\\star} \\in (0,\\infty)$ of $r(\\Delta \\gamma) = 0$ for the above model.\n\nA. Define the merit function $\\phi(\\Delta \\gamma) = \\tfrac{1}{2} \\, r(\\Delta \\gamma)^{2}$. Suppose $r$ is continuously differentiable on a closed interval $[0,\\Delta \\gamma_{\\max}]$, its derivative $r'(\\Delta \\gamma)$ is Lipschitz continuous on $[0,\\Delta \\gamma_{\\max}]$, and there exists a constant $c_{0}  0$ such that $r'(\\Delta \\gamma) \\le -c_{0}  0$ for all $\\Delta \\gamma \\in [0,\\Delta \\gamma_{\\max}]$. Using at each iterate the Newton direction $p_{k}$ given by $r'(\\Delta \\gamma_{k})\\, p_{k} = - r(\\Delta \\gamma_{k})$ and an Armijo backtracking line search with parameters $c \\in (0,\\tfrac{1}{2})$ and contraction factor $\\rho \\in (0,1)$ to enforce\n$$\n\\phi(\\Delta \\gamma_{k} + s_{k} p_{k}) \\le \\phi(\\Delta \\gamma_{k}) + c s_{k} \\phi'(\\Delta \\gamma_{k}) p_{k},\n$$\nfrom any initial guess $\\Delta \\gamma_{0} \\in [0,\\Delta \\gamma_{\\max}]$ generates a sequence that globally converges to the unique root of $r$.\n\nB. If one can construct a bracket $[0,\\Delta \\gamma_{\\max}]$ with $r(0) \\ge 0$ and $r(\\Delta \\gamma_{\\max}) \\le 0$, and if $r$ is continuous and strictly monotone on $[0,\\Delta \\gamma_{\\max}]$, then a safeguarded Newton method that computes a Newton trial step each iteration and projects it back into the bracket, falling back to bisection whenever the trial step leaves the bracket or does not reduce $|r|$, converges globally to the unique root.\n\nC. Because $r$ is strictly monotone for the given hardening law with saturation, pure Newton's method without any line search or safeguarding, started at $\\Delta \\gamma_{0} = 0$, is guaranteed to converge globally to the unique root for all admissible data.\n\nD. Using the residual itself $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ as a merit function and enforcing an Armijo decrease condition on $\\phi$ with the Newton direction ensures global convergence, since $\\phi$ strictly decreases with $\\Delta \\gamma$ due to saturation.\n\nE. A sufficient and computable upper bound to construct a sign-changing bracket is\n$$\n\\Delta \\gamma_{\\max} = \\frac{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}}{2\\mu} \\, ,\n$$\nwhich, provided it is positive, guarantees $r(\\Delta \\gamma_{\\max}) \\le 0$ for any $\\alpha_{n}$, because $\\sigma_{y}(\\alpha) \\ge \\sigma_{0}$ for all $\\alpha$ in a saturation law with $\\sigma_{\\infty}  \\sigma_{0}  0$.\n\nChoose all that apply.", "solution": "The user requires a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Framework**: Small-strain associative elastoplasticity.\n*   **Yield Condition**: Isotropic von Mises.\n*   **Hardening**: Nonlinear isotropic hardening with saturation. The yield stress $\\sigma_{y}(\\alpha)$ is a $C^{1}$ function of accumulated plastic strain $\\alpha$, strictly increasing, and bounded above. Example: $\\sigma_{y}(\\alpha) = \\sigma_{\\infty} - (\\sigma_{\\infty} - \\sigma_{0}) \\exp(-b\\,\\alpha)$ with $\\sigma_{\\infty}  \\sigma_{0}  0$, $b  0$.\n*   **Yield Function**: $f(\\boldsymbol{\\sigma}, \\alpha) = \\lVert \\mathbf{s} \\rVert - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}(\\alpha)$, where $\\mathbf{s}$ is the deviatoric stress.\n*   **Accumulated Plastic Strain Evolution**: $d\\alpha = \\sqrt{\\tfrac{2}{3}}\\, d\\gamma$, where $d\\gamma \\ge 0$.\n*   **Numerical Scheme**: Implicit backward Euler return-mapping.\n*   **Trial State**: $\\mathbf{s}_{\\mathrm{tr}} = \\mathbf{s}_{n} + 2\\mu\\, \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$.\n*   **Plastic Loading Condition**: The trial state is plastically admissible, $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n})  0$.\n*   **Consistency Equation**: The problem reduces to solving the scalar nonlinear equation $r(\\Delta \\gamma) = 0$ for the plastic multiplier increment $\\Delta \\gamma \\ge 0$:\n    $$r(\\Delta \\gamma) \\equiv \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = 0.$$\n*   **Objective**: Identify all statements that describe sufficient conditions and constructions to ensure global convergence to the unique solution $\\Delta \\gamma^{\\star} \\in (0,\\infty)$.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific Grounding**: The problem is a classic topic in computational inelasticity, representing the local constitutive update in a finite element simulation. The model (von Mises with isotropic hardening) and the algorithm (backward Euler return mapping) are standard and fundamentally sound.\n2.  **Well-Posedness**: Let us analyze the function $r(\\Delta \\gamma)$ for $\\Delta \\gamma \\ge 0$.\n    *   **Value at origin**: The plastic loading condition $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n})  0$ is equivalent to $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\frac{2}{3}}\\sigma_{y}(\\alpha_n)  0$. This is precisely $r(0)$. So, $r(0)  0$.\n    *   **Monotonicity**: The derivative of $r(\\Delta \\gamma)$ is:\n        $$r'(\\Delta \\gamma) = \\frac{d}{d(\\Delta \\gamma)} \\left( \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) \\right)$$\n        $$r'(\\Delta \\gamma) = -2\\mu - \\sqrt{\\tfrac{2}{3}} \\cdot \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) \\cdot \\sqrt{\\tfrac{2}{3}}$$\n        $$r'(\\Delta \\gamma) = -2\\mu - \\tfrac{2}{3}\\, \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right)$$\n        Since the shear modulus $\\mu  0$ and the hardening is strictly increasing ($\\sigma_{y}'  0$), we have $r'(\\Delta \\gamma)  -2\\mu  0$ for all $\\Delta \\gamma \\ge 0$. Thus, $r(\\Delta \\gamma)$ is a strictly decreasing function.\n    *   **Asymptotic Behavior**: As $\\Delta \\gamma \\to \\infty$, the term $-2\\mu \\Delta \\gamma \\to -\\infty$. The hardening function $\\sigma_{y}(\\alpha)$ is bounded above by some $\\sigma_{\\infty}$. Therefore, $r(\\Delta \\gamma) \\to -\\infty$ as $\\Delta \\gamma \\to \\infty$.\n    *   **Existence and Uniqueness of Solution**: Since $r(\\Delta \\gamma)$ is continuous, $r(0)  0$, and $r(\\Delta \\gamma) \\to -\\infty$, the Intermediate Value Theorem guarantees the existence of at least one root. Because $r(\\Delta \\gamma)$ is strictly decreasing, this root must be unique. Let us call it $\\Delta \\gamma^{\\star}$. Since $r(0)0$, we have $\\Delta \\gamma^{\\star}  0$. The problem of finding the solution is mathematically well-posed.\n3.  **Objectivity**: The problem is stated using precise mathematical and technical language, free from subjectivity.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, mathematically well-posed, and objectively formulated. It is a valid problem. We proceed to the solution.\n\n### Derivation and Option-by-Option Analysis\n\nWe must find the correct statements about globally convergent algorithms for solving $r(\\Delta \\gamma) = 0$.\n\n**Analysis of Option A**\nThis statement proposes a line search globalization of Newton's method using the merit function $\\phi(\\Delta \\gamma) = \\frac{1}{2} r(\\Delta \\gamma)^{2}$. This is a standard technique in numerical optimization.\nThe derivative of the merit function is $\\phi'(\\Delta \\gamma) = r(\\Delta \\gamma) r'(\\Delta \\gamma)$. The Newton direction for the root-finding problem $r(\\Delta \\gamma)=0$ is $p_{k} = -r(\\Delta \\gamma_{k}) / r'(\\Delta \\gamma_{k})$.\nThe directional derivative of the merit function along this direction is:\n$$\\phi'(\\Delta \\gamma_{k})\\, p_{k} = r(\\Delta \\gamma_{k}) r'(\\Delta \\gamma_{k}) \\left( \\frac{-r(\\Delta \\gamma_{k})}{r'(\\Delta \\gamma_{k})} \\right) = -[r(\\Delta \\gamma_{k})]^2 = -2\\phi(\\Delta \\gamma_{k})$$\nSince $\\phi(\\Delta \\gamma_{k}) \\ge 0$, the directional derivative is negative for any $\\Delta \\gamma_{k}$ that is not the root, meaning $p_{k}$ is always a descent direction for $\\phi$.\nThe Armijo condition, along with the backtracking procedure, ensures that a sufficient decrease in the merit function is achieved at each step.\nThe statement includes standard assumptions for proving global convergence of such a method: Lipschitz continuity of the gradient of the merit function (implied by $r$ being $C^2$, which holds if $\\sigma_y$ is $C^2$, a reasonable assumption for a smooth hardening law) and the search direction being a descent direction. The conditions on $r'(\\Delta \\gamma)$ are met by the physical model. Under these conditions, the line search Newton method is guaranteed to converge to a stationary point of $\\phi$, i.e., where $\\phi'(\\Delta \\gamma)=0$. This means $r(\\Delta \\gamma)r'(\\Delta \\gamma) = 0$. Since we have proven that $r'(\\Delta \\gamma)  -2\\mu  0$, the limit point must satisfy $r(\\Delta \\gamma) = 0$. Thus, the method converges to the unique root $\\Delta \\gamma^{\\star}$.\n**Verdict for A**: Correct.\n\n**Analysis of Option B**\nThis statement proposes a safeguarded Newton method, which combines Newton steps with bisection within a bracket $[0, \\Delta \\gamma_{\\max}]$ where $r(0)  0$ and $r(\\Delta \\gamma_{\\max}) \\le 0$.\nThe existence of such a bracket is guaranteed because $r(0)  0$ and $r(\\Delta \\gamma) \\to -\\infty$ for large $\\Delta \\gamma$. The problem also requires $r$ to be continuous and strictly monotone on the bracket, which we have already verified.\nA safeguarded method works as follows: at each iteration, it attempts a fast-converging step (like Newton's). If this step is \"good\" (e.g., stays within the bracket and sufficiently reduces the residual $|r|$), it is accepted. If not, the algorithm falls back to a robust but slower step (like bisection). Bisection is guaranteed to converge for a continuous, sign-changing function on an interval. By always ensuring the root remains bracketed and falling back to bisection when necessary, the hybrid algorithm guarantees global convergence. The description in the option, while slightly informal, correctly identifies all the key ingredients for such a guarantee.\n**Verdict for B**: Correct.\n\n**Analysis of Option C**\nThis statement claims that the pure Newton's method ($\\Delta \\gamma_{k+1} = \\Delta \\gamma_k - r(\\Delta \\gamma_k)/r'(\\Delta \\gamma_k)$), starting from $\\Delta \\gamma_0 = 0$, is guaranteed to converge globally.\nFor a scalar equation $r(x)=0$, a known theorem states that if one starts at $x_0$ where $r(x_0)0$, and if $r'(x)0$ and $r''(x) \\ge 0$ for all $x \\ge x_0$, then the Newton iterates form a monotonically increasing sequence that converges to the root.\nIn our problem, we have $r(0)  0$ and $r'(\\Delta\\gamma)  0$. The third condition is $r''(\\Delta \\gamma) \\ge 0$. Let us compute the second derivative:\n$$r''(\\Delta \\gamma) = -\\frac{2}{3} \\frac{d}{d(\\Delta \\gamma)} \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = -\\left(\\frac{2}{3}\\right)^{3/2} \\sigma_{y}''\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right)$$\nThe condition $r''(\\Delta \\gamma) \\ge 0$ is thus equivalent to $\\sigma_{y}''(\\alpha) \\le 0$ for all relevant $\\alpha$. This means the hardening function $\\sigma_y(\\alpha)$ must be concave.\nWhile the provided example hardening law is concave, the problem only specifies that $\\sigma_y(\\alpha)$ is $C^1$, strictly increasing, and bounded. It is possible to construct a function with these properties that is not globally concave (i.e., it may have inflection points). If $\\sigma_y(\\alpha)$ has a region of convexity ($\\sigma_y''  0$), then $r(\\Delta \\gamma)$ will be concave ($r''  0$), and Newton's method can overshoot the root, potentially leading to divergence or convergence to a non-physical negative value. Therefore, the guarantee is not universally valid for all hardening laws covered by the problem's definition.\n**Verdict for C**: Incorrect.\n\n**Analysis of Option D**\nThis statement proposes using $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ as a merit function for a line search method.\nA merit function in the context of line search algorithms is a function to be minimized, whose minimum corresponds to the solution of the original problem (here, root finding). The standard Armijo condition and the associated convergence theorems are derived for such a minimization setting. A key requirement for the merit function is that it must be bounded below on the search path.\nHere, the proposed merit function $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ is not bounded below; we know $r(\\Delta \\gamma) \\to -\\infty$ as $\\Delta \\gamma \\to \\infty$. A line search algorithm seeking to minimize this \"merit function\" would attempt to drive $\\Delta \\gamma$ to infinity rather than stopping at the root where $r(\\Delta \\gamma) = 0$. The framework of a minimization-based line search is fundamentally misapplied here. While one can design specialized damped Newton schemes for root-finding, describing it with the standard terminology of \"merit function\" and \"Armijo decrease condition\" is conceptually flawed because the goal is not to minimize $r$, but to find where it is zero.\n**Verdict for D**: Incorrect.\n\n**Analysis of Option E**\nThis statement proposes a computable upper bound $\\Delta \\gamma_{\\max}$ to form a bracket $[0, \\Delta \\gamma_{\\max}]$.\nThe proposed bound is $\\Delta \\gamma_{\\max} = \\frac{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}}{2\\mu}$.\nFirst, we must check if this quantity is positive. The plastic loading condition is $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert  \\sqrt{\\frac{2}{3}} \\sigma_y(\\alpha_n)$. Since $\\sigma_y(\\alpha)$ is a strictly increasing function and $\\alpha_n \\ge 0$, we have $\\sigma_y(\\alpha_n) \\ge \\sigma_y(0) = \\sigma_0$. Therefore, $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert  \\sqrt{\\frac{2}{3}} \\sigma_y(\\alpha_n) \\ge \\sqrt{\\frac{2}{3}} \\sigma_0$. This implies $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\frac{2}{3}} \\sigma_0  0$, so $\\Delta \\gamma_{\\max}$ is always positive. The proviso \"provided it is positive\" is redundant but does not invalidate the statement.\nNext, we must check if $r(\\Delta \\gamma_{\\max}) \\le 0$.\n$$r(\\Delta \\gamma_{\\max}) = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu \\Delta \\gamma_{\\max} - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right)$$\nBy construction of $\\Delta \\gamma_{\\max}$, we have $2\\mu \\Delta \\gamma_{\\max} = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}$. Substituting this into the expression for $r$:\n$$r(\\Delta \\gamma_{\\max}) = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\left(\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}\\right) - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right)$$\n$$r(\\Delta \\gamma_{\\max}) = \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0} - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right) = \\sqrt{\\tfrac{2}{3}} \\left( \\sigma_{0} - \\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right) \\right)$$\nThe argument of the hardening function is $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\frac{2}{3}}\\Delta\\gamma_{\\max}$. Since $\\alpha_n \\ge 0$ and $\\Delta\\gamma_{\\max}  0$, the argument is positive. As $\\sigma_y$ is strictly increasing, $\\sigma_y(\\alpha_{n+1})  \\sigma_y(0) = \\sigma_0$.\nTherefore, $\\sigma_0 - \\sigma_y(\\alpha_{n+1})  0$, which implies $r(\\Delta \\gamma_{\\max})  0$. This satisfies the condition $r(\\Delta \\gamma_{\\max}) \\le 0$. A valid sign-changing bracket $[0, \\Delta \\gamma_{\\max}]$ is successfully constructed.\n**Verdict for E**: Correct.\n\n**Summary of Correct Options**\nThe correct options are A, B, and E, as they describe valid and robust methods or constructions for finding the unique solution to the consistency equation.", "answer": "$$\\boxed{ABE}$$", "id": "2568881"}, {"introduction": "A robust numerical algorithm must gracefully handle all possible states, including degenerate or singular cases. In $J_2$ plasticity, such a case occurs at purely hydrostatic stress states, where the deviatoric stress $\\boldsymbol{s}$ is zero and the plastic flow direction $\\boldsymbol{n} = \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$ is undefined. This exercise explores the consequences of this singularity on both the algorithm and its linearization, and guides you to identify a mathematically sound regularization that ensures stability without violating physical principles. [@problem_id:2568912]", "problem": "In associative plasticity with the von Mises (second deviatoric invariant $J_2$) yield function, the incremental return mapping algorithm in a finite element method (FEM) implementation uses the deviatoric flow direction $\\boldsymbol{n}$, defined by $\\boldsymbol{n} = \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$, where $\\boldsymbol{s}$ is the deviatoric part of the Cauchy stress $\\boldsymbol{\\sigma}$ and $\\lVert\\cdot\\rVert$ denotes the Euclidean norm. The plastic flow rule is $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\partial g/\\partial \\boldsymbol{\\sigma}$ with plastic potential $g = f$ for associative flow, so $\\partial g/\\partial \\boldsymbol{\\sigma} = \\sqrt{3/2}\\,\\boldsymbol{n}$. In a Newton–Raphson solution for the global equilibrium, the consistent algorithmic tangent requires linearization of all internal variables, which involves $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$. Consider an implicit incremental update where the elastic predictor gives a trial deviatoric stress $\\boldsymbol{s}^{\\mathrm{trial}}$ whose norm may be very small, for instance near a purely hydrostatic elastic state or near the elastic domain origin. \n\nStarting from the fundamental definitions above and standard vector calculus, reason about the numerical sensitivity of computing $\\boldsymbol{n} = \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$ when $\\lVert\\boldsymbol{s}\\rVert$ is small, and about the impact on the consistent tangent $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$. Then, select the option that both correctly identifies the core numerical issue and proposes a robust regularization that preserves frame indifference and deviatoricity, ensures nonnegative plastic dissipation, and admits a well-defined consistent linearization for use in the Newton–Raphson iterations.\n\nA. The issue is a loss of numerical stability due to division by a small $\\lVert\\boldsymbol{s}\\rVert$, which amplifies floating-point perturbations and makes $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ unbounded. A robust fix is to replace the normalization by a smooth regularization $\\boldsymbol{n}_{\\varepsilon} = \\boldsymbol{s}/\\sqrt{\\lVert\\boldsymbol{s}\\rVert^{2} + \\varepsilon^{2}}$ with a stress-like $\\varepsilon$ chosen relative to a characteristic stress scale, and to use the consistent derivative $\\partial \\boldsymbol{n}_{\\varepsilon}/\\partial \\boldsymbol{s} = \\frac{1}{\\sqrt{\\lVert\\boldsymbol{s}\\rVert^{2} + \\varepsilon^{2}}}\\,\\mathbb{I} - \\frac{\\boldsymbol{s}\\otimes \\boldsymbol{s}}{(\\lVert\\boldsymbol{s}\\rVert^{2} + \\varepsilon^{2})^{3/2}}$ in the algorithmic tangent.\n\nB. The issue is that $\\boldsymbol{s}$ may lose deviatoricity numerically. A robust fix is to add a small hydrostatic bias before normalization, defining $\\tilde{\\boldsymbol{s}} = \\boldsymbol{s} + \\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ and computing $\\boldsymbol{n} = \\tilde{\\boldsymbol{s}}/\\lVert\\tilde{\\boldsymbol{s}}\\rVert$, which stabilizes the direction and improves convergence.\n\nC. The issue is a lack of uniqueness of $\\boldsymbol{n}$ at $\\boldsymbol{s} = \\boldsymbol{0}$. A robust fix is to set $\\boldsymbol{n} = \\boldsymbol{0}$ whenever $\\lVert\\boldsymbol{s}\\rVert  \\varepsilon$ and otherwise use $\\boldsymbol{n} = \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$, which avoids division by small numbers and simplifies the consistent tangent to $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} = \\boldsymbol{0}$ below the threshold.\n\nD. The issue is only the magnitude blow-up of $\\boldsymbol{n}$. A robust fix is to clip the denominator, using $\\boldsymbol{n} = \\boldsymbol{s}/\\max(\\lVert\\boldsymbol{s}\\rVert,\\varepsilon)$, which guarantees $\\lVert\\boldsymbol{n}\\rVert \\le 1$ and removes the singularity without altering the return mapping equations or the consistent tangent.\n\nSelect the single best option.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It describes a standard and non-trivial numerical issue in the well-established field of computational plasticity. All provided definitions and conditions are consistent with the theory of the finite element method and continuum mechanics. Thus, the problem is valid and we proceed to a full analysis.\n\nThe central issue concerns the definition of the plastic flow direction, a normalized deviatoric stress tensor, $\\boldsymbol{n} = \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$. Here, $\\boldsymbol{s}$ is the deviatoric stress tensor and $\\lVert\\boldsymbol{s}\\rVert = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$ is its Euclidean norm. This expression presents two significant numerical challenges when the elastic trial stress state is near the origin of the deviatoric stress space, i.e., when $\\lVert\\boldsymbol{s}\\rVert \\to 0$.\n\nFirst, there is the direct numerical instability. Division by a floating-point number close to zero results in overflow or significant loss of precision. The function $\\boldsymbol{n}(\\boldsymbol{s})$ is undefined at $\\boldsymbol{s} = \\boldsymbol{0}$, corresponding to the geometric fact that a zero vector has no unique direction.\n\nSecond, and more critical for the implicit Newton-Raphson scheme mentioned in the problem, is the behavior of the derivative $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$. The quadratic convergence rate of the Newton-Raphson method relies on the use of a consistent tangent operator, which is the exact linearization of the numerical algorithm. This requires the Gâteaux derivative of all internal variables. The derivative of the flow direction $\\boldsymbol{n}$ with respect to the deviatoric stress $\\boldsymbol{s}$ is a fourth-order tensor given by:\n$$ \\frac{\\partial \\boldsymbol{n}}{\\partial \\boldsymbol{s}} = \\frac{\\partial}{\\partial \\boldsymbol{s}} \\left( \\frac{\\boldsymbol{s}}{\\lVert\\boldsymbol{s}\\rVert} \\right) = \\frac{1}{\\lVert\\boldsymbol{s}\\rVert} \\mathbb{I}_{\\text{dev}} - \\frac{\\boldsymbol{s} \\otimes \\boldsymbol{s}}{\\lVert\\boldsymbol{s}\\rVert^3} $$\nwhere $\\mathbb{I}_{\\text{dev}}$ is the fourth-order identity tensor on the space of deviatoric tensors. As $\\lVert\\boldsymbol{s}\\rVert \\to 0$, the terms $\\lVert\\boldsymbol{s}\\rVert^{-1}$ and $\\lVert\\boldsymbol{s}\\rVert^{-3}$ cause this derivative to become unbounded. A singular derivative leads to a singular or ill-conditioned global tangent stiffness matrix, destroying the convergence of the Newton-Raphson iteration.\n\nA robust solution must regularize the function $\\boldsymbol{n}(\\boldsymbol{s})$ such that it becomes continuously differentiable everywhere, especially at $\\boldsymbol{s}=\\boldsymbol{0}$, while preserving the essential physics of the model: frame indifference, deviatoricity of flow, and non-negative plastic dissipation.\n\nNow, we evaluate each option.\n\nA. The issue is a loss of numerical stability due to division by a small $\\lVert\\boldsymbol{s}\\rVert$, which amplifies floating-point perturbations and makes $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ unbounded. A robust fix is to replace the normalization by a smooth regularization $\\boldsymbol{n}_{\\varepsilon} = \\boldsymbol{s}/\\sqrt{\\lVert\\boldsymbol{s}\\rVert^{2} + \\varepsilon^{2}}$ with a stress-like $\\varepsilon$ chosen relative to a characteristic stress scale, and to use the consistent derivative $\\partial \\boldsymbol{n}_{\\varepsilon}/\\partial \\boldsymbol{s} = \\frac{1}{\\sqrt{\\lVert\\boldsymbol{s}\\rVert^{2} + \\varepsilon^{2}}}\\,\\mathbb{I} - \\frac{\\boldsymbol{s}\\otimes \\boldsymbol{s}}{(\\lVert\\boldsymbol{s}\\rVert^{2} + \\varepsilon^{2})^{3/2}}$ in the algorithmic tangent.\n\nThis option correctly identifies both core issues: the numerical instability in computing $\\boldsymbol{n}$ and the singularity of its derivative $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$. The proposed regularization, $\\boldsymbol{n}_{\\varepsilon}(\\boldsymbol{s}) = \\boldsymbol{s}/\\sqrt{\\lVert\\boldsymbol{s}\\rVert^{2} + \\varepsilon^{2}}$, is a standard technique. It is smooth ($C^{\\infty}$) for any choice of constant $\\varepsilon > 0$. At $\\boldsymbol{s} = \\boldsymbol{0}$, we have $\\boldsymbol{n}_{\\varepsilon}(\\boldsymbol{0}) = \\boldsymbol{0}$. For $\\lVert\\boldsymbol{s}\\rVert \\gg \\varepsilon$, we recover $\\boldsymbol{n}_{\\varepsilon} \\approx \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$. This regularization preserves the deviatoric nature of the flow direction, is frame-indifferent, and ensures non-negative dissipation since $\\boldsymbol{s}:\\boldsymbol{n}_{\\varepsilon} = \\lVert\\boldsymbol{s}\\rVert^2 / \\sqrt{\\lVert\\boldsymbol{s}\\rVert^2 + \\varepsilon^2} \\ge 0$. The derivative is computed by the product rule:\n$$ \\frac{\\partial \\boldsymbol{n}_{\\varepsilon}}{\\partial \\boldsymbol{s}} = \\frac{\\partial}{\\partial \\boldsymbol{s}} \\left( \\boldsymbol{s} (\\lVert\\boldsymbol{s}\\rVert^2 + \\varepsilon^2)^{-1/2} \\right) = \\mathbb{I} \\cdot (\\lVert\\boldsymbol{s}\\rVert^2 + \\varepsilon^2)^{-1/2} + \\boldsymbol{s} \\otimes \\left( -\\frac{1}{2} (\\lVert\\boldsymbol{s}\\rVert^2 + \\varepsilon^2)^{-3/2} \\cdot 2\\boldsymbol{s} \\right) $$\n$$ = \\frac{1}{\\sqrt{\\lVert\\boldsymbol{s}\\rVert^2 + \\varepsilon^2}} \\mathbb{I} - \\frac{\\boldsymbol{s} \\otimes \\boldsymbol{s}}{(\\lVert\\boldsymbol{s}\\rVert^2 + \\varepsilon^2)^{3/2}} $$\nThis matches the formula in the option (using $\\mathbb{I}$ as the appropriate identity tensor). At $\\boldsymbol{s} = \\boldsymbol{0}$, this derivative is well-defined and equals $(1/\\varepsilon)\\mathbb{I}$. The tangent is thus non-singular and continuous everywhere, satisfying all requirements for robust Newton-Raphson convergence.\nVerdict: **Correct**.\n\nB. The issue is that $\\boldsymbol{s}$ may lose deviatoricity numerically. A robust fix is to add a small hydrostatic bias before normalization, defining $\\tilde{\\boldsymbol{s}} = \\boldsymbol{s} + \\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ and computing $\\boldsymbol{n} = \\tilde{\\boldsymbol{s}}/\\lVert\\tilde{\\boldsymbol{s}}\\rVert$, which stabilizes the direction and improves convergence.\n\nThis option is fundamentally incorrect. The primary numerical issue is not the loss of deviatoricity of $\\boldsymbol{s}$, but the singularity at $\\lVert\\boldsymbol{s}\\rVert \\to 0$. More importantly, the proposed fix is physically inadmissible for $J_2$ plasticity. The theory of $J_2$ plasticity mandates that plastic flow is isochoric (volume-preserving), which means the plastic strain rate tensor $\\dot{\\boldsymbol{\\varepsilon}}^p$ must be deviatoric. Since $\\dot{\\boldsymbol{\\varepsilon}}^{p} \\propto \\boldsymbol{n}$, the flow direction $\\boldsymbol{n}$ must be a deviatoric tensor. The proposed $\\tilde{\\boldsymbol{s}} = \\boldsymbol{s} + \\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ is not deviatoric, as it has a non-zero trace: $\\mathrm{tr}(\\tilde{\\boldsymbol{s}}) = \\mathrm{tr}(\\boldsymbol{s}) + \\mathrm{tr}(\\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}) = 0 + 3\\varepsilon\\,\\mathrm{tr}(\\boldsymbol{\\sigma})$. Using this $\\tilde{\\boldsymbol{s}}$ to define $\\boldsymbol{n}$ would introduce spurious plastic volume changes, violating a basic principle of the constitutive model.\nVerdict: **Incorrect**.\n\nC. The issue is a lack of uniqueness of $\\boldsymbol{n}$ at $\\boldsymbol{s} = \\boldsymbol{0}$. A robust fix is to set $\\boldsymbol{n} = \\boldsymbol{0}$ whenever $\\lVert\\boldsymbol{s}\\rVert  \\varepsilon$ and otherwise use $\\boldsymbol{n} = \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$, which avoids division by small numbers and simplifies the consistent tangent to $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} = \\boldsymbol{0}$ below the threshold.\n\nThis option correctly identifies the uniqueness issue at the origin. However, the proposed fix, using a piecewise definition controlled by an `if` statement, is not robust for a Newton-Raphson solver. While the function $\\boldsymbol{n}(\\boldsymbol{s})$ itself is made continuous, its derivative $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s}$ becomes discontinuous across the sphere $\\lVert\\boldsymbol{s}\\rVert = \\varepsilon$. For $\\lVert\\boldsymbol{s}\\rVert  \\varepsilon$, $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} = \\boldsymbol{0}$. For $\\lVert\\boldsymbol{s}\\rVert > \\varepsilon$, $\\partial \\boldsymbol{n}/\\partial \\boldsymbol{s} \\neq \\boldsymbol{0}$. This jump in the tangent operator destroys the quadratic convergence property of the Newton-Raphson method and can lead to oscillations or failure to converge when a state point crosses this artificial boundary during iteration. A \"well-defined consistent linearization\" implies, at minimum, a continuous tangent. This proposal fails to provide one.\nVerdict: **Incorrect**.\n\nD. The issue is only the magnitude blow-up of $\\boldsymbol{n}$. A robust fix is to clip the denominator, using $\\boldsymbol{n} = \\boldsymbol{s}/\\max(\\lVert\\boldsymbol{s}\\rVert,\\varepsilon)$, which guarantees $\\lVert\\boldsymbol{n}\\rVert \\le 1$ and removes the singularity without altering the return mapping equations or the consistent tangent.\n\nThis option mischaracterizes the problem. The magnitude of $\\boldsymbol{n} = \\boldsymbol{s}/\\lVert\\boldsymbol{s}\\rVert$ is, by definition, $1$ (for $\\boldsymbol{s} \\neq \\boldsymbol{0}$); it does not \"blow up\". The proposed fix, $\\boldsymbol{n} = \\boldsymbol{s}/\\max(\\lVert\\boldsymbol{s}\\rVert,\\varepsilon)$, is simply a different way of writing a piecewise function identical in effect to the one in option C for states near the origin (if $\\lVert\\boldsymbol{s}\\rVert  \\varepsilon$, then $\\boldsymbol{n} = \\boldsymbol{s}/\\varepsilon$). As with option C, this function has a discontinuous derivative at $\\lVert\\boldsymbol{s}\\rVert = \\varepsilon$. This invalidates the claim that it provides a robust solution for a Newton-Raphson context. The claim that this does not alter the \"return mapping equations or the consistent tangent\" is false; it explicitly alters the definition of $\\boldsymbol{n}$ and therefore the equations, and it fails to produce a continuously differentiable tangent.\nVerdict: **Incorrect**.\n\nFinal Conclusion: Option A is the only one that correctly identifies all facets of the numerical problem and proposes a solution that is both physically consistent and mathematically robust, providing the smooth, well-defined consistent tangent required for optimal performance of the Newton-Raphson algorithm.", "answer": "$$\\boxed{A}$$", "id": "2568912"}, {"introduction": "To achieve the rapid, quadratic convergence of a global Newton-Raphson solver in an implicit finite element analysis, the constitutive model must provide its exact linearization—the consistent algorithmic tangent. This tangent is not the same as the continuum elastoplastic tangent and must be derived directly from the numerical integration algorithm. This exercise provides an essential capstone practice: deriving the algorithmic tangent for the $J_2$ return mapping algorithm, a fundamental skill for developers of nonlinear finite element software. [@problem_id:2612466]", "problem": "Consider small-strain, isotropic, rate-independent von Mises ($J_2$) plasticity with linear isotropic hardening, to be used within a Newton method in the Finite Element Method (FEM). The elastic response is characterized by bulk modulus $K$ and shear modulus $\\mu$, and the yield stress is $\\sigma_y(\\alpha) = \\sigma_{y0} + H \\alpha$, where $\\alpha$ is the accumulated plastic strain. The stress is additively decomposed into volumetric and deviatoric parts, with deviatoric stress $s$ and volumetric pressure $p$, and the elastic law is $p = K \\,\\text{tr}(\\varepsilon)$ and $s = 2 \\mu (\\varepsilon^{\\text{dev}} - \\varepsilon^{p,\\text{dev}})$. The flow is associative, and the backward Euler integration (implicit return mapping) over a time increment uses the plastic multiplier increment $\\Delta \\gamma$ and flow direction $m_{n+1} = \\dfrac{3}{2} \\dfrac{s_{n+1}}{\\lVert s_{n+1}\\rVert}$. The accumulated plastic strain is updated via $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\dfrac{2}{3}} \\,\\lVert\\varepsilon^{p}_{n+1} - \\varepsilon^{p}_n\\rVert$. The return mapping residuals at the end of the step are\n$$\nr_s := s_{n+1} - s_{\\text{tr}} + 2 \\mu \\,\\Delta \\gamma\\, m_{n+1} = 0, \n\\qquad\nr_f := \\sqrt{\\frac{3}{2}}\\,\\lVert s_{n+1}\\rVert - \\sigma_y\\!\\Big(\\alpha_n + \\sqrt{\\frac{2}{3}}\\,\\lVert\\varepsilon^{p}_{n+1} - \\varepsilon^{p}_n\\rVert\\Big) = 0,\n$$\nwith $s_{\\text{tr}} := 2 \\mu \\big(\\varepsilon^{\\text{dev}}_{n+1} - \\varepsilon^{p,\\text{dev}}_{n}\\big)$. Using consistent linearization (i.e., exact differentiation of the residuals with respect to the strain increment), derive the closed-form algorithmic tangent modulus $\\boldsymbol{C}^{\\text{alg}}$ mapping the symmetric total strain increment at the end of the step $\\delta \\varepsilon_{n+1}$ to the corresponding stress increment $\\delta \\sigma_{n+1}$, in terms of the known end-of-step state $(s_{n+1}, \\Delta \\gamma_{n+1})$ and material parameters $(K,\\mu,H)$. \n\nDefine the second-order identity $I$, the fourth-order symmetric identity $\\mathbb{I}$, and the fourth-order deviatoric projector $\\mathbb{I}_{\\text{dev}} := \\mathbb{I} - \\dfrac{1}{3} I \\otimes I$. Let $n_{n+1} := \\dfrac{s_{n+1}}{\\lVert s_{n+1}\\rVert}$, $\\mathbb{N} := n_{n+1} \\otimes n_{n+1}$, and $\\mathbb{P} := \\mathbb{I}_{\\text{dev}} - \\mathbb{N}$. Your final expression must be a single analytic expression for $\\boldsymbol{C}^{\\text{alg}}$ written in terms of these tensors and the scalar \n$$\n\\beta := \\frac{3 \\mu \\,\\Delta \\gamma_{n+1}}{\\lVert s_{n+1}\\rVert}.\n$$\n\nExpress your final answer as a closed-form analytic expression. No numerical evaluation is required. The final answer must be a single analytic expression. Do not include units in the final answer.", "solution": "The problem requires the derivation of the algorithmic tangent modulus, $\\boldsymbol{C}^{\\text{alg}}$, for a $J_2$ plasticity model with linear isotropic hardening. This modulus relates an infinitesimal increment of total strain, $\\delta\\varepsilon_{n+1}$, to the corresponding infinitesimal increment of total stress, $\\delta\\sigma_{n+1}$, at the end of a time step, i.e., $\\delta\\sigma_{n+1} = \\boldsymbol{C}^{\\text{alg}} : \\delta\\varepsilon_{n+1}$. The derivation is based on the consistent linearization of the backward Euler return mapping algorithm's residual equations.\n\nThe stress tensor $\\sigma$ is additively decomposed into its volumetric part, $pI$, and its deviatoric part, $s$, such that $\\sigma = pI+s$. The volumetric response is purely elastic:\n$$p_{n+1} = K \\, \\text{tr}(\\varepsilon_{n+1})$$\nLinearizing this equation gives the volumetric part of the stress increment:\n$$\\delta p_{n+1} = K \\, \\text{tr}(\\delta\\varepsilon_{n+1}) = K (I : \\delta\\varepsilon_{n+1})$$\nThis implies that the total stress increment is $\\delta\\sigma_{n+1} = \\delta p_{n+1} I + \\delta s_{n+1}$. The volumetric component of the tangent modulus is therefore $K (I \\otimes I)$. The central task is to find the deviatoric tangent modulus, $\\boldsymbol{C}^{\\text{alg}}_{\\text{dev}}$, which relates $\\delta\\varepsilon_{n+1}$ to $\\delta s_{n+1}$.\n\nThe state at the end of the step, $(s_{n+1}, \\Delta\\gamma_{n+1})$, is determined by solving the system of nonlinear residual equations for a given strain $\\varepsilon_{n+1}$:\n$$r_s := s_{n+1} - s_{\\text{tr}} + 2 \\mu \\,\\Delta \\gamma_{n+1}\\, m_{n+1} = 0$$\n$$r_f := \\sqrt{\\frac{3}{2}}\\,\\lVert s_{n+1}\\rVert - \\sigma_y(\\alpha_{n+1}) = 0$$\nwhere $s_{\\text{tr}} := 2 \\mu (\\varepsilon^{\\text{dev}}_{n+1} - \\varepsilon^{p,\\text{dev}}_{n})$, and $\\alpha_{n+1}$ is the accumulated plastic strain.\n\nTo find the tangent modulus, we perform a consistent linearization of this system. We take the variation of each residual equation with respect to the independent variable $\\varepsilon_{n+1}$ and the dependent variables $s_{n+1}$ and $\\Delta\\gamma_{n+1}$. The state at step $n$ is known and fixed, so its variation is zero.\n\nLet's linearize the first residual, $\\delta r_s = 0$:\n$$\\delta s_{n+1} - \\delta s_{\\text{tr}} + 2 \\mu \\,(\\delta(\\Delta\\gamma_{n+1}))\\, m_{n+1} + 2 \\mu \\,\\Delta \\gamma_{n+1}\\, \\delta m_{n+1} = 0$$\nWe evaluate each variation:\nThe variation of the trial stress is $\\delta s_{\\text{tr}} = 2 \\mu (\\delta\\varepsilon^{\\text{dev}}_{n+1} - \\delta\\varepsilon^{p,\\text{dev}}_{n}) = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$, since $\\varepsilon^{p,\\text{dev}}_{n}$ is a past value.\nThe flow direction is $m_{n+1} = \\frac{3}{2}\\frac{s_{n+1}}{\\lVert s_{n+1}\\rVert} = \\frac{3}{2}n_{n+1}$. Its variation is:\n$$\\delta m_{n+1} = \\frac{3}{2}\\delta n_{n+1} = \\frac{3}{2} \\left( \\frac{1}{\\lVert s_{n+1}\\rVert} (\\mathbb{I}_{\\text{dev}} - n_{n+1} \\otimes n_{n+1}) : \\delta s_{n+1} \\right) = \\frac{3}{2\\lVert s_{n+1}\\rVert} \\mathbb{P} : \\delta s_{n+1}$$\nSubstituting these into the linearized equation for $r_s$:\n$$\\delta s_{n+1} - 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1} + 3 \\mu \\,n_{n+1} \\delta(\\Delta\\gamma_{n+1}) + 2 \\mu \\,\\Delta \\gamma_{n+1}\\, \\left(\\frac{3}{2\\lVert s_{n+1}\\rVert} \\mathbb{P} : \\delta s_{n+1}\\right) = 0$$\nRearranging and collecting terms with $\\delta s_{n+1}$:\n$$\\left(\\mathbb{I}_{\\text{dev}} + \\frac{3 \\mu \\Delta\\gamma_{n+1}}{\\lVert s_{n+1}\\rVert} \\mathbb{P}\\right) : \\delta s_{n+1} + 3 \\mu\\, n_{n+1} \\delta(\\Delta\\gamma_{n+1}) = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$$\nUsing the given definition $\\beta = \\frac{3 \\mu \\Delta\\gamma_{n+1}}{\\lVert s_{n+1}\\rVert}$, we get our first linearized equation:\n$$(1) \\quad (\\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P}) : \\delta s_{n+1} + 3 \\mu\\, n_{n+1} \\delta(\\Delta\\gamma_{n+1}) = 2\\mu\\,\\mathbb{I}_{\\text{dev}}:\\delta\\varepsilon_{n+1}$$\n\nNext, we linearize the yield condition residual, $\\delta r_f = 0$:\n$$\\sqrt{\\frac{3}{2}}\\,\\delta\\lVert s_{n+1}\\rVert - \\delta\\sigma_y(\\alpha_{n+1}) = 0$$\nThe variation of the norm is $\\delta\\lVert s_{n+1}\\rVert = \\frac{s_{n+1}}{\\lVert s_{n+1}\\rVert} : \\delta s_{n+1} = n_{n+1} : \\delta s_{n+1}$.\nThe variation of the yield stress is $\\delta\\sigma_y(\\alpha_{n+1}) = H \\delta\\alpha_{n+1}$.\nThe update rule for the accumulated plastic strain $\\alpha$ is given as $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\frac{2}{3}} \\,\\lVert\\varepsilon^{p}_{n+1} - \\varepsilon^{p}_n\\rVert$.\nThe plastic strain increment is $\\Delta\\varepsilon^p = \\varepsilon^p_{n+1} - \\varepsilon^p_n = \\Delta\\gamma_{n+1} m_{n+1} = \\frac{3}{2}\\Delta\\gamma_{n+1} n_{n+1}$.\nIts norm is $\\lVert\\Delta\\varepsilon^p\\rVert = \\frac{3}{2}\\Delta\\gamma_{n+1}$.\nTherefore, the increment in $\\alpha$ is $\\Delta\\alpha_{n+1} = \\alpha_{n+1}-\\alpha_n = \\sqrt{\\frac{2}{3}}\\left(\\frac{3}{2}\\Delta\\gamma_{n+1}\\right) = \\sqrt{\\frac{3}{2}}\\Delta\\gamma_{n+1}$.\nThe variation of $\\alpha_{n+1}$ is thus $\\delta\\alpha_{n+1} = \\sqrt{\\frac{3}{2}}\\delta(\\Delta\\gamma_{n+1})$.\nSubstituting these into the linearized yield condition:\n$$\\sqrt{\\frac{3}{2}}(n_{n+1} : \\delta s_{n+1}) - H \\left(\\sqrt{\\frac{3}{2}}\\delta(\\Delta\\gamma_{n+1})\\right) = 0$$\nThis simplifies to our second linearized equation:\n$$(2) \\quad n_{n+1} : \\delta s_{n+1} - H \\delta(\\Delta\\gamma_{n+1}) = 0$$\nFrom equation $(2)$, we can express $\\delta(\\Delta\\gamma_{n+1})$ in terms of $\\delta s_{n+1}$:\n$$\\delta(\\Delta\\gamma_{n+1}) = \\frac{1}{H} (n_{n+1} : \\delta s_{n+1})$$\nNow, substitute this into equation $(1)$:\n$$(\\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P}) : \\delta s_{n+1} + 3 \\mu\\, n_{n+1} \\left(\\frac{1}{H} (n_{n+1} : \\delta s_{n+1})\\right) = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$$\nThe term with the scalar product can be rewritten using the rank-1 tensor $\\mathbb{N} = n_{n+1} \\otimes n_{n+1}$:\n$$\\left[ \\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P} + \\frac{3\\mu}{H} \\mathbb{N} \\right] : \\delta s_{n+1} = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$$\nLet $\\mathbb{A} = \\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P} + \\frac{3\\mu}{H} \\mathbb{N}$. We need to find its inverse. Using the spectral decomposition $\\mathbb{I}_{\\text{dev}} = \\mathbb{P} + \\mathbb{N}$:\n$$\\mathbb{A} = (\\mathbb{P} + \\mathbb{N}) + \\beta \\mathbb{P} + \\frac{3\\mu}{H} \\mathbb{N} = (1+\\beta)\\mathbb{P} + \\left(1 + \\frac{3\\mu}{H}\\right)\\mathbb{N}$$\nSince $\\mathbb{P}$ and $\\mathbb{N}$ are orthogonal projectors ($\\mathbb{P}:\\mathbb{N}=0$, $\\mathbb{P}:\\mathbb{P}=\\mathbb{P}$, $\\mathbb{N}:\\mathbb{N}=\\mathbb{N}$), the inverse of $\\mathbb{A}$ is:\n$$\\mathbb{A}^{-1} = \\frac{1}{1+\\beta}\\mathbb{P} + \\frac{1}{1 + \\frac{3\\mu}{H}}\\mathbb{N} = \\frac{1}{1+\\beta}\\mathbb{P} + \\frac{H}{H+3\\mu}\\mathbb{N}$$\nNow we can solve for $\\delta s_{n+1}$:\n$$\\delta s_{n+1} = 2\\mu\\,\\mathbb{A}^{-1} : \\delta\\varepsilon^{\\text{dev}}_{n+1}$$\nThe operators $\\mathbb{P}$ and $\\mathbb{N}$ project onto the deviatoric space, so $\\mathbb{A}^{-1}: \\delta\\varepsilon^{\\text{dev}}_{n+1} = \\mathbb{A}^{-1}: \\delta\\varepsilon_{n+1}$.\nThus, the deviatoric part of the algorithmic tangent is:\n$$\\boldsymbol{C}^{\\text{alg}}_{\\text{dev}} = 2\\mu\\,\\mathbb{A}^{-1} = 2\\mu \\left( \\frac{1}{1+\\beta}\\mathbb{P} + \\frac{H}{H+3\\mu}\\mathbb{N} \\right)$$\nThe full algorithmic tangent modulus $\\boldsymbol{C}^{\\text{alg}}$ is the sum of the volumetric and deviatoric parts:\n$$\\boldsymbol{C}^{\\text{alg}} = K (I \\otimes I) + \\boldsymbol{C}^{\\text{alg}}_{\\text{dev}}$$\nSubstituting the derived expression for $\\boldsymbol{C}^{\\text{alg}}_{\\text{dev}}$ gives the final result.", "answer": "$$\\boxed{K (I \\otimes I) + 2\\mu \\left( \\frac{1}{1+\\beta} \\mathbb{P} + \\frac{H}{H+3\\mu} \\mathbb{N} \\right)}$$", "id": "2612466"}]}