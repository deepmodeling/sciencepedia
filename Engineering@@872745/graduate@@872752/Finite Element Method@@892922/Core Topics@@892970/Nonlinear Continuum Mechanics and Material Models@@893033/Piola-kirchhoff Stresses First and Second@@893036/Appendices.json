{"hands_on_practices": [{"introduction": "Understanding the relationship between different stress measures is fundamental in continuum mechanics. While Cauchy stress, $\\boldsymbol{\\sigma}$, is physically intuitive as force per current area, the Piola-Kirchhoff stresses are essential for formulating problems in the reference configuration. This first exercise provides a foundational practice in transforming between these tensors, starting from the principle of force equivalence on a material element and applying Nanson's formula. By working through the specific case of a pure stretch, you will gain concrete, hands-on experience with the algebraic manipulations connecting $\\boldsymbol{\\sigma}$, $\\mathbf{P}$, and $\\mathbf{S}$ [@problem_id:2587889].", "problem": "In a Total Lagrangian finite element formulation for finite deformation elasticity, consider a material mapping from a reference configuration with position vector $\\boldsymbol{X}$ to a current configuration with position vector $\\boldsymbol{x}=\\boldsymbol{\\varphi}(\\boldsymbol{X})$. The deformation gradient is $\\boldsymbol{F}=\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{\\varphi}$. Let the unit normal to a surface element in the reference configuration be $\\boldsymbol{N}$ with area $\\mathrm{d}A$, and the corresponding unit normal in the current configuration be $\\boldsymbol{n}$ with area $\\mathrm{d}a$. Let the Cauchy stress (true stress) be $\\boldsymbol{\\sigma}$, the first Piola–Kirchhoff stress be $\\boldsymbol{P}$, and the second Piola–Kirchhoff stress be $\\boldsymbol{S}$.\n\nYou are given the following fundamental relations:\n- Cauchy traction definition in the current configuration: $\\boldsymbol{t}=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$.\n- Nominal traction definition in the reference configuration: $\\boldsymbol{T}_{0}=\\boldsymbol{P}\\,\\boldsymbol{N}$.\n- Equality of contact forces on corresponding surface elements: $\\boldsymbol{t}\\,\\mathrm{d}a=\\boldsymbol{T}_{0}\\,\\mathrm{d}A$.\n- Nanson’s formula: $\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A$, where $J=\\det \\boldsymbol{F}$.\n\nStarting only from the above relations and the definition $\\boldsymbol{S}=\\boldsymbol{F}^{-1}\\boldsymbol{P}$, first derive expressions for $\\boldsymbol{P}$ and $\\boldsymbol{S}$ in terms of $\\boldsymbol{F}$, $J$, and $\\boldsymbol{\\sigma}$. Then, specialize to the case of a pure stretch with\n$$\n\\boldsymbol{F}=\\operatorname{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3}), \\quad \\lambda_{i}>0,\n$$\nand a diagonal Cauchy stress\n$$\n\\boldsymbol{\\sigma}=\\operatorname{diag}(\\sigma_{1},\\sigma_{2},\\sigma_{3}).\n$$\n\nCompute the diagonal components of $\\boldsymbol{P}$ and $\\boldsymbol{S}$ explicitly as closed-form expressions in terms of $\\lambda_{1},\\lambda_{2},\\lambda_{3}$ and $\\sigma_{1},\\sigma_{2},\\sigma_{3}$. Express your final answer as a single row matrix containing the six diagonal entries in the order $\\big(P_{11},P_{22},P_{33},S_{11},S_{22},S_{33}\\big)$, using $J=\\lambda_{1}\\lambda_{2}\\lambda_{3}$ where needed. Express your final answer symbolically; do not include units.", "solution": "The problem statement is analyzed and found to be valid. It is a well-posed problem in continuum mechanics, grounded in established principles, with a complete and consistent set of definitions and relations. There are no scientific or logical flaws. The solution will proceed by first deriving the general relationships between the stress tensors and then specializing to the given case.\n\nThe starting point is the equality of contact forces acting on a material surface element in the current and reference configurations:\n$$\n\\boldsymbol{t}\\,\\mathrm{d}a = \\boldsymbol{T}_{0}\\,\\mathrm{d}A\n$$\nHere, $\\boldsymbol{t}$ is the Cauchy traction vector in the current configuration and $\\boldsymbol{T}_{0}$ is the nominal traction vector in the reference configuration. The elemental areas are $\\mathrm{d}a$ and $\\mathrm{d}A$, respectively.\n\nWe substitute the definitions of the traction vectors in terms of the Cauchy stress $\\boldsymbol{\\sigma}$ and the first Piola-Kirchhoff stress $\\boldsymbol{P}$:\n$$\n(\\boldsymbol{\\sigma}\\,\\boldsymbol{n})\\,\\mathrm{d}a = (\\boldsymbol{P}\\,\\boldsymbol{N})\\,\\mathrm{d}A\n$$\nwhere $\\boldsymbol{n}$ and $\\boldsymbol{N}$ are the unit normal vectors to the surface element in the current and reference configurations. Rearranging the terms yields:\n$$\n\\boldsymbol{\\sigma}\\,(\\boldsymbol{n}\\,\\mathrm{d}a) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\nWe now employ Nanson's formula, which relates the oriented area elements in the two configurations:\n$$\n\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A\n$$\nwhere $\\boldsymbol{F}$ is the deformation gradient, $J = \\det(\\boldsymbol{F})$, and $\\boldsymbol{F}^{-T}$ is the inverse transpose of $\\boldsymbol{F}$. Substituting Nanson's formula into the force balance equation gives:\n$$\n\\boldsymbol{\\sigma}\\,(J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\nSince this relation must hold for any arbitrary surface element, we can cancel the scalar term $\\mathrm{d}A$ and recognize that the equality must hold for any choice of the normal vector $\\boldsymbol{N}$. This implies the following relationship between the tensors:\n$$\n\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\nThis is the required expression relating the first Piola-Kirchhoff stress $\\boldsymbol{P}$ to the Cauchy stress $\\boldsymbol{\\sigma}$.\n\nNext, we derive the expression for the second Piola-Kirchhoff stress, $\\boldsymbol{S}$. We are given the definition:\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\boldsymbol{P}\n$$\nSubstituting the expression for $\\boldsymbol{P}$ we just derived:\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\,(J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T})\n$$\nThe scalar $J$ can be moved to the front:\n$$\n\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\nThis is the required expression relating the second Piola-Kirchhoff stress $\\boldsymbol{S}$ to the Cauchy stress $\\boldsymbol{\\sigma}$. This completes the first part of the problem.\n\nFor the second part, we specialize these general relations to the case of a pure stretch, where the deformation gradient $\\boldsymbol{F}$ and the Cauchy stress $\\boldsymbol{\\sigma}$ are given as diagonal matrices:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} \\lambda_{1} & 0 & 0 \\\\ 0 & \\lambda_{2} & 0 \\\\ 0 & 0 & \\lambda_{3} \\end{pmatrix}, \\quad \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix}\n$$\nwith principal stretches $\\lambda_{i} > 0$. The determinant of $\\boldsymbol{F}$ is $J = \\det(\\boldsymbol{F}) = \\lambda_{1}\\lambda_{2}\\lambda_{3}$. Since $\\boldsymbol{F}$ is a diagonal matrix, its transpose is itself, $\\boldsymbol{F}^{T} = \\boldsymbol{F}$. The inverse of its transpose is:\n$$\n\\boldsymbol{F}^{-T} = (\\boldsymbol{F}^T)^{-1} = \\boldsymbol{F}^{-1} = \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix}\n$$\nWe now compute the components of $\\boldsymbol{P}$ using $\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$:\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix}\n$$\nThe product of the two diagonal matrices is a diagonal matrix:\n$$\n\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\nMultiplying by the scalar $J$ gives the components of $\\boldsymbol{P}$:\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{1}\\lambda_{3} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{1}\\lambda_{2} \\end{pmatrix}\n$$\nThe diagonal components of the first Piola-Kirchhoff stress are:\n$P_{11} = \\sigma_{1}\\lambda_{2}\\lambda_{3}$\n$P_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{3}$\n$P_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}$\n\nFinally, we compute the components of $\\boldsymbol{S}$ using $\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$:\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1} & 0 & 0 \\\\ 0 & \\sigma_{2} & 0 \\\\ 0 & 0 & \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix}\n$$\nPerforming the matrix multiplications:\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-1} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-2} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{2}^{-2} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{3}^{-2} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3} & 0 & 0 \\\\ 0 & \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3} & 0 \\\\ 0 & 0 & \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\nThe diagonal components of the second Piola-Kirchhoff stress are:\n$S_{11} = \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}$\n$S_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}$\n$S_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1}$\n\nThe required six diagonal components are assembled into a single row matrix for the final answer.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3} & \\sigma_{2}\\lambda_{1}\\lambda_{3} & \\sigma_{3}\\lambda_{1}\\lambda_{2} & \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3} & \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3} & \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}}\n$$", "id": "2587889"}, {"introduction": "In hyperelasticity, the first and second Piola-Kirchhoff stresses are not independent entities but are deeply connected through the stored energy function, $W$. They are energetically conjugate to different kinematic measures, which gives rise to a fundamental relationship between them. This exercise challenges you to demonstrate this consistency by deriving $\\mathbf{P}$ and $\\mathbf{S}$ independently from a given energy potential and then proving that the identity $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$ holds exactly [@problem_id:2587930]. Successfully completing this task reinforces the theoretical elegance and internal consistency of the hyperelastic framework.", "problem": "Consider a three-dimensional hyperelastic solid with deformation gradient $\\mathbf{F} \\in \\mathrm{GL}^{+}(3)$, right Cauchy–Green tensor $\\mathbf{C} = \\mathbf{F}^{\\top} \\mathbf{F}$, and invariants $I_{1}(\\mathbf{C}) = \\mathrm{tr}(\\mathbf{C})$, $I_{2}(\\mathbf{C}) = \\tfrac{1}{2}\\big((\\mathrm{tr}\\mathbf{C})^{2} - \\mathrm{tr}(\\mathbf{C}^{2})\\big)$, and $I_{3}(\\mathbf{C}) = \\det(\\mathbf{C})$. The stored energy per unit reference volume is given by\n$$\nW(\\mathbf{F}) = \\alpha\\big(I_{1}(\\mathbf{C}) - 3\\big) + \\beta\\big(I_{2}(\\mathbf{C}) - 3\\big) + \\gamma\\big(I_{3}(\\mathbf{C}) - 1\\big),\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are positive constants. Using only foundational definitions from continuum mechanics, compute the first Piola–Kirchhoff stress $\\mathbf{P}$ and the second Piola–Kirchhoff stress $\\mathbf{S}$, and verify that the identity $\\mathbf{P} = \\mathbf{F}\\,\\mathbf{S}$ holds identically for all $\\mathbf{F} \\in \\mathrm{GL}^{+}(3)$ consistent with the stated energy. As a scalar check of your verification, define the Frobenius-norm residual $r = \\|\\mathbf{P} - \\mathbf{F}\\,\\mathbf{S}\\|_{F}^{2}$ and report its value. Express the final value of $r$ as a pure number without units.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard exercise in nonlinear continuum mechanics for an isotropic hyperelastic material. All provided definitions and relations are standard. The problem is valid and admits a unique solution.\n\nWe will proceed with the derivation. The fundamental definitions for the first Piola-Kirchhoff stress tensor $\\mathbf{P}$ and the second Piola-Kirchhoff stress tensor $\\mathbf{S}$ in terms of the stored energy function $W$ are:\n$$\n\\mathbf{P} = \\frac{\\partial W}{\\partial \\mathbf{F}} \\quad \\text{and} \\quad \\mathbf{S} = 2 \\frac{\\partial W}{\\partial \\mathbf{C}}\n$$\nwhere $\\mathbf{F}$ is the deformation gradient and $\\mathbf{C} = \\mathbf{F}^{\\top} \\mathbf{F}$ is the right Cauchy-Green deformation tensor. The problem requires computing $\\mathbf{P}$ and $\\mathbf{S}$ for the given stored energy function and then verifying the fundamental identity $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$.\n\nThe stored energy function is given as:\n$$\nW(\\mathbf{F}) = W(\\mathbf{C}(\\mathbf{F})) = \\alpha\\big(I_{1}(\\mathbf{C}) - 3\\big) + \\beta\\big(I_{2}(\\mathbf{C}) - 3\\big) + \\gamma\\big(I_{3}(\\mathbf{C}) - 1\\big)\n$$\nwhere $I_1(\\mathbf{C}) = \\mathrm{tr}(\\mathbf{C})$, $I_2(\\mathbf{C}) = \\frac{1}{2}\\left((\\mathrm{tr}\\mathbf{C})^2 - \\mathrm{tr}(\\mathbf{C}^2)\\right)$, $I_3(\\mathbf{C}) = \\det(\\mathbf{C})$, and $\\alpha$, $\\beta$, $\\gamma$ are positive material constants.\n\nFirst, we compute the second Piola-Kirchhoff stress tensor $\\mathbf{S}$. Using the chain rule for differentiation with respect to the tensor $\\mathbf{C}$:\n$$\n\\mathbf{S} = 2 \\frac{\\partial W}{\\partial \\mathbf{C}} = 2 \\left( \\frac{\\partial W}{\\partial I_1} \\frac{\\partial I_1}{\\partial \\mathbf{C}} + \\frac{\\partial W}{\\partial I_2} \\frac{\\partial I_2}{\\partial \\mathbf{C}} + \\frac{\\partial W}{\\partial I_3} \\frac{\\partial I_3}{\\partial \\mathbf{C}} \\right)\n$$\nThe partial derivatives of $W$ with respect to the invariants $I_1$, $I_2$, and $I_3$ are straightforwardly obtained from its definition:\n$$\n\\frac{\\partial W}{\\partial I_1} = \\alpha, \\quad \\frac{\\partial W}{\\partial I_2} = \\beta, \\quad \\frac{\\partial W}{\\partial I_3} = \\gamma\n$$\nThe derivatives of the invariants with respect to $\\mathbf{C}$ are standard results from tensor calculus:\n$$\n\\frac{\\partial I_1}{\\partial \\mathbf{C}} = \\frac{\\partial(\\mathrm{tr}(\\mathbf{C}))}{\\partial \\mathbf{C}} = \\mathbf{I}\n$$\n$$\n\\frac{\\partial I_2}{\\partial \\mathbf{C}} = \\frac{\\partial}{\\partial \\mathbf{C}} \\left( \\frac{1}{2}[(\\mathrm{tr}\\mathbf{C})^2 - \\mathrm{tr}(\\mathbf{C}^2)] \\right) = I_1 \\mathbf{I} - \\mathbf{C}\n$$\n$$\n\\frac{\\partial I_3}{\\partial \\mathbf{C}} = \\frac{\\partial(\\det(\\mathbf{C}))}{\\partial \\mathbf{C}} = \\det(\\mathbf{C}) \\mathbf{C}^{-\\top} = I_3 \\mathbf{C}^{-1} \\quad (\\text{since } \\mathbf{C} \\text{ is symmetric})\n$$\nSubstituting these expressions into the formula for $\\mathbf{S}$ yields:\n$$\n\\mathbf{S} = 2 \\left( \\alpha \\mathbf{I} + \\beta (I_1 \\mathbf{I} - \\mathbf{C}) + \\gamma I_3 \\mathbf{C}^{-1} \\right)\n$$\nThis is the expression for the second Piola-Kirchhoff stress tensor for the given material model.\n\nNext, we compute the first Piola-Kirchhoff stress tensor $\\mathbf{P}$ independently. Using the chain rule for differentiation with respect to the tensor $\\mathbf{F}$:\n$$\n\\mathbf{P} = \\frac{\\partial W}{\\partial \\mathbf{F}} = \\frac{\\partial W}{\\partial I_1} \\frac{\\partial I_1}{\\partial \\mathbf{F}} + \\frac{\\partial W}{\\partial I_2} \\frac{\\partial I_2}{\\partial \\mathbf{F}} + \\frac{\\partial W}{\\partial I_3} \\frac{\\partial I_3}{\\partial \\mathbf{F}}\n$$\nThe derivatives of the invariants with respect to $\\mathbf{F}$ are also standard results:\n$$\n\\frac{\\partial I_1}{\\partial \\mathbf{F}} = \\frac{\\partial (\\mathrm{tr}(\\mathbf{F}^{\\top}\\mathbf{F}))}{\\partial \\mathbf{F}} = 2\\mathbf{F}\n$$\n$$\n\\frac{\\partial I_2}{\\partial \\mathbf{F}} = 2(I_1 \\mathbf{F} - \\mathbf{F}\\mathbf{C})\n$$\n$$\n\\frac{\\partial I_3}{\\partial \\mathbf{F}} = \\frac{\\partial ((\\det \\mathbf{F})^2)}{\\partial \\mathbf{F}} = 2\\det(\\mathbf{F}) \\frac{\\partial(\\det \\mathbf{F})}{\\partial \\mathbf{F}} = 2\\det(\\mathbf{F}) (\\det(\\mathbf{F}) \\mathbf{F}^{-\\top}) = 2(\\det \\mathbf{F})^2 \\mathbf{F}^{-\\top} = 2 I_3 \\mathbf{F}^{-\\top}\n$$\nSubstituting these, along with the derivatives of $W$ with respect to the invariants, into the formula for $\\mathbf{P}$:\n$$\n\\mathbf{P} = \\alpha (2\\mathbf{F}) + \\beta (2(I_1 \\mathbf{F} - \\mathbf{F}\\mathbf{C})) + \\gamma (2 I_3 \\mathbf{F}^{-\\top})\n$$\n$$\n\\mathbf{P} = 2\\alpha \\mathbf{F} + 2\\beta(I_1 \\mathbf{F} - \\mathbf{F}\\mathbf{C}) + 2\\gamma I_3 \\mathbf{F}^{-\\top}\n$$\nThis is the independent expression for the first Piola-Kirchhoff stress tensor.\n\nNow, we must verify the identity $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$. We compute the product $\\mathbf{F}\\mathbf{S}$ using our derived expression for $\\mathbf{S}$:\n$$\n\\mathbf{F}\\mathbf{S} = \\mathbf{F} \\left[ 2 \\left( \\alpha \\mathbf{I} + \\beta (I_1 \\mathbf{I} - \\mathbf{C}) + \\gamma I_3 \\mathbf{C}^{-1} \\right) \\right]\n$$\n$$\n\\mathbf{F}\\mathbf{S} = 2\\alpha \\mathbf{F}\\mathbf{I} + 2\\beta \\mathbf{F}(I_1 \\mathbf{I} - \\mathbf{C}) + 2\\gamma I_3 \\mathbf{F} \\mathbf{C}^{-1}\n$$\n$$\n\\mathbf{F}\\mathbf{S} = 2\\alpha \\mathbf{F} + 2\\beta(I_1 \\mathbf{F} - \\mathbf{F}\\mathbf{C}) + 2\\gamma I_3 \\mathbf{F} \\mathbf{C}^{-1}\n$$\nComparing this expression for $\\mathbf{F}\\mathbf{S}$ with our expression for $\\mathbf{P}$, we see that the first two terms match identically. The identity $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$ holds if and only if the third terms are equal:\n$$\n2\\gamma I_3 \\mathbf{F}^{-\\top} = 2\\gamma I_3 \\mathbf{F} \\mathbf{C}^{-1}\n$$\nThis simplifies to verifying if $\\mathbf{F}^{-\\top} = \\mathbf{F}\\mathbf{C}^{-1}$. We use the definition $\\mathbf{C} = \\mathbf{F}^{\\top}\\mathbf{F}$. The inverse of $\\mathbf{C}$ is $\\mathbf{C}^{-1} = (\\mathbf{F}^{\\top}\\mathbf{F})^{-1} = \\mathbf{F}^{-1}(\\mathbf{F}^{\\top})^{-1} = \\mathbf{F}^{-1}\\mathbf{F}^{-\\top}$.\nNow, we pre-multiply $\\mathbf{C}^{-1}$ by $\\mathbf{F}$:\n$$\n\\mathbf{F}\\mathbf{C}^{-1} = \\mathbf{F}(\\mathbf{F}^{-1}\\mathbf{F}^{-\\top}) = (\\mathbf{F}\\mathbf{F}^{-1})\\mathbf{F}^{-\\top} = \\mathbf{I} \\mathbf{F}^{-\\top} = \\mathbf{F}^{-\\top}\n$$\nThe equality is proven. Thus, the expression for $\\mathbf{P}$ derived from $\\partial W / \\partial \\mathbf{F}$ is identical to the expression for $\\mathbf{F}\\mathbf{S}$ where $\\mathbf{S}$ is derived from $2 \\partial W / \\partial \\mathbf{C}$. The identity $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$ holds for the given hyperelastic energy function for all $\\mathbf{F} \\in \\mathrm{GL}^{+}(3)$.\n\nFinally, we compute the scalar residual $r = \\|\\mathbf{P} - \\mathbf{F}\\mathbf{S}\\|_{F}^{2}$. The Frobenius norm of a matrix $\\mathbf{A}$ is defined as $\\|\\mathbf{A}\\|_{F} = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$.\nSince we have rigorously demonstrated that $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$ is an identity, the difference $\\mathbf{P} - \\mathbf{F}\\mathbf{S}$ is the zero tensor, designated by $\\mathbf{0}$.\n$$\n\\mathbf{P} - \\mathbf{F}\\mathbf{S} = \\mathbf{0}\n$$\nThe Frobenius norm of the zero tensor is:\n$$\n\\|\\mathbf{0}\\|_{F} = \\sqrt{\\sum_{i,j} 0^2} = 0\n$$\nTherefore, the residual is:\n$$\nr = \\|\\mathbf{P} - \\mathbf{F}\\mathbf{S}\\|_{F}^{2} = 0^{2} = 0\n$$\nThe value of the residual is exactly $0$, as expected from the fundamental relationship between the two stress measures.", "answer": "$$\\boxed{0}$$", "id": "2587930"}, {"introduction": "Theoretical relationships in continuum mechanics serve as powerful validation tools in computational settings like the finite element method. The symmetry of the second Piola-Kirchhoff stress ($\\mathbf{S}$) and the identity $\\mathbf{P} = \\mathbf{F}\\mathbf{S}$ are not just theoretical curiosities; they are essential properties that a correct material model implementation must satisfy. This hands-on exercise requires you to translate theory into practice by creating a numerical script to verify these conditions for a compressible neo-Hookean model [@problem_id:2587885]. This type of verification is a cornerstone of robust software development in computational mechanics, ensuring that the numerical tool faithfully represents the underlying physics.", "problem": "Construct, justify, and implement a numerical symmetry test for the second Piola–Kirchhoff stress and a consistency test for the first Piola–Kirchhoff stress in three-dimensional hyperelasticity, starting from first principles of hyperelastic materials.\n\nYou are given the following definitions and foundational facts:\n- The deformation gradient is denoted by $\\mathbf{F} \\in \\mathbb{R}^{3 \\times 3}$ with positive Jacobian $J = \\det \\mathbf{F} > 0$, and the right Cauchy–Green tensor is $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$.\n- Consider a compressible hyperelastic material whose strain energy density function depends on $\\mathbf{F}$ via the compressible neo-Hookean model\n$$\nW(\\mathbf{F}) = \\frac{\\mu}{2}\\big(\\operatorname{tr}(\\mathbf{C}) - 3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}\\big(\\ln J\\big)^2,\n$$\nwhere $\\lambda$ and $\\mu$ are the Lamé parameters (with physical units of Pascals). Angles, if any, must be expressed in radians.\n- In hyperelasticity, the second Piola–Kirchhoff stress is defined by $\\mathbf{S} = 2\\,\\partial W/\\partial \\mathbf{C}$, and the first Piola–Kirchhoff stress is defined by $\\mathbf{P} = \\partial W/\\partial \\mathbf{F}$.\n\nTasks:\n1. Starting from the above definitions, derive an explicit expression for $\\mathbf{S}$ in terms of $\\mathbf{C}$, $J$, $\\lambda$, and $\\mu$, and demonstrate from its structure why $\\mathbf{S}$ is symmetric for any $\\mathbf{F}$ with $J>0$.\n2. Starting from the same energy function and the definition of $\\mathbf{P}$, derive an explicit expression for $\\mathbf{P}$ in terms of $\\mathbf{F}$, $J$, $\\lambda$, and $\\mu$. Then prove that the identity $\\mathbf{P} = \\mathbf{F}\\,\\mathbf{S}$ holds.\n3. Implement a program that, for each test case in the suite below, numerically evaluates $\\mathbf{S}$ and $\\mathbf{P}$ independently from your derived expressions, and then verifies:\n   - Symmetry: the Frobenius norm residual $\\lVert \\mathbf{S} - \\mathbf{S}^{\\mathsf{T}} \\rVert_{\\mathrm{F}} \\le \\varepsilon$,\n   - Consistency: the Frobenius norm residual $\\lVert \\mathbf{P} - \\mathbf{F} \\mathbf{S} \\rVert_{\\mathrm{F}} \\le \\varepsilon$,\n   where $\\varepsilon = 10^{-9}$.\n4. For each test case, produce a boolean result that is $\\mathrm{True}$ if both checks pass and $\\mathrm{False}$ otherwise.\n\nUse the following material parameters (you will not output stresses with physical units; the outputs are dimensionless booleans):\n- $\\lambda = 120000.0$,\n- $\\mu = 80000.0$.\n\nTest suite (all matrices are $3 \\times 3$ with $J > 0$):\n- Case 1 (identity): \n$$\nF_1 = \\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\n- Case 2 (pure rotation about the $z$-axis by angle $\\theta = 0.7$ radians, where $\\cos(0.7) \\approx 0.7648421872844886$ and $\\sin(0.7) \\approx 0.6442176872376910$):\n$$\nF_2 = \\begin{bmatrix}\n0.7648421872844886 & -0.6442176872376910 & 0 \\\\\n0.6442176872376910 & \\;\\,0.7648421872844886 & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\n- Case 3 (isochoric diagonal stretch with $J=1$):\n$$\nF_3 = \\begin{bmatrix}\n1.2 & 0 & 0 \\\\\n0 & 0.8 & 0 \\\\\n0 & 0 & 1.0416666666666667\n\\end{bmatrix}.\n$$\n- Case 4 (upper-triangular shear-stretch with $J = 1.05 \\times 0.95 \\times 1.1$):\n$$\nF_4 = \\begin{bmatrix}\n1.05 & 0.3 & -0.2 \\\\\n0 & 0.95 & 0.25 \\\\\n0 & 0 & 1.1\n\\end{bmatrix}.\n$$\n- Case 5 (near-singular but invertible lower-triangular with $J = 0.02$):\n$$\nF_5 = \\begin{bmatrix}\n1.0 & 0.0 & 0.0 \\\\\n0.02 & 1.0 & 0.0 \\\\\n-0.01 & 0.03 & 0.02\n\\end{bmatrix}.\n$$\n\nProgram requirements:\n- Implement numerically stable computations of $C$, $J$, $S$, and $P$ for each case.\n- Use the Frobenius norm to compute residuals for the symmetry and consistency tests.\n- Use tolerance $\\varepsilon = 10^{-9}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\ldots]$ corresponding to Cases $1$ through $5$ in order.\n\nThe final outputs are booleans and therefore unitless. No angles other than the one specified are needed beyond radians as given.", "solution": "We begin from the fundamentals of hyperelasticity. Let $\\mathbf{F} \\in \\mathbb{R}^{3 \\times 3}$ be the deformation gradient, $J = \\det \\mathbf{F} > 0$ the Jacobian, and $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$ the right Cauchy–Green tensor. For the compressible neo-Hookean energy\n$$\nW(\\mathbf{F}) = \\frac{\\mu}{2}\\big(\\operatorname{tr}(\\mathbf{C}) - 3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}\\big(\\ln J\\big)^2,\n$$\nthe second Piola–Kirchhoff stress is defined by\n$$\n\\mathbf{S} = 2\\,\\frac{\\partial W}{\\partial \\mathbf{C}},\n$$\nand the first Piola–Kirchhoff stress is defined by\n$$\n\\mathbf{P} = \\frac{\\partial W}{\\partial \\mathbf{F}}.\n$$\n\nDerivation of $\\mathbf{S}$:\n- The term $\\frac{\\mu}{2}\\operatorname{tr}(\\mathbf{C})$ has derivative with respect to $\\mathbf{C}$ equal to $\\frac{\\mu}{2} \\mathbf{I}$, because $\\partial \\operatorname{tr}(\\mathbf{C})/\\partial \\mathbf{C} = \\mathbf{I}$. Hence it contributes $\\mathbf{S}_1 = 2 \\cdot \\frac{\\mu}{2} \\mathbf{I} = \\mu \\mathbf{I}$.\n- The Jacobian determinant satisfies $J = \\sqrt{\\det \\mathbf{C}}$, so $\\ln J = \\frac{1}{2}\\ln \\det \\mathbf{C}$. Using the well-known identity $\\partial \\ln \\det \\mathbf{C} / \\partial \\mathbf{C} = \\mathbf{C}^{-\\mathsf{T}}$ for invertible $\\mathbf{C}$, we obtain\n$$\n\\frac{\\partial \\ln J}{\\partial \\mathbf{C}} = \\frac{1}{2} \\mathbf{C}^{-\\mathsf{T}}.\n$$\nThus the term $-\\mu \\ln J$ contributes\n$\n\\frac{\\partial}{\\partial \\mathbf{C}}\\big(-\\mu \\ln J\\big) = -\\mu \\cdot \\frac{1}{2} \\mathbf{C}^{-\\mathsf{T}},\n$\nso $\\mathbf{S}_2 = 2 \\cdot \\big(-\\mu \\cdot \\frac{1}{2} \\mathbf{C}^{-\\mathsf{T}}\\big) = -\\mu \\mathbf{C}^{-\\mathsf{T}}$.\n- The last term $\\frac{\\lambda}{2} (\\ln J)^2$ has derivative\n$\n\\frac{\\partial}{\\partial \\mathbf{C}}\\Big(\\frac{\\lambda}{2} (\\ln J)^2\\Big) = \\lambda \\ln J \\cdot \\frac{\\partial \\ln J}{\\partial \\mathbf{C}} = \\lambda \\ln J \\cdot \\frac{1}{2} \\mathbf{C}^{-\\mathsf{T}},\n$\nhence $\\mathbf{S}_3 = 2 \\cdot \\lambda \\ln J \\cdot \\frac{1}{2} \\mathbf{C}^{-\\mathsf{T}} = \\lambda \\ln J \\, \\mathbf{C}^{-\\mathsf{T}}$.\n\nSumming the three contributions,\n$$\n\\mathbf{S} = \\mu \\mathbf{I} - \\mu \\mathbf{C}^{-\\mathsf{T}} + \\lambda \\ln J \\, \\mathbf{C}^{-\\mathsf{T}}.\n$$\nSince $\\mathbf{C}$ is symmetric positive definite for $J>0$ and invertible $\\mathbf{F}$, we have $\\mathbf{C}^{-\\mathsf{T}} = \\mathbf{C}^{-1}$, which is also symmetric. Therefore $\\mathbf{S}$ is a linear combination of symmetric tensors ($\\mathbf{I}$ and $\\mathbf{C}^{-1}$) with scalar coefficients, implying that $\\mathbf{S}$ is symmetric:\n$$\n\\mathbf{S}^{\\mathsf{T}} = \\mathbf{S}.\n$$\n\nDerivation of $\\mathbf{P}$ and proof of $\\mathbf{P} = \\mathbf{F} \\mathbf{S}$:\nWe compute $\\mathbf{P} = \\frac{\\partial W}{\\partial \\mathbf{F}}$. Use the chain rule with $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$ and the identity $\\mathrm{d}\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathrm{d}\\mathbf{F} + (\\mathrm{d}\\mathbf{F})^{\\mathsf{T}} \\mathbf{F}$. From hyperelasticity,\n$$\n\\mathbf{P} = \\frac{\\partial W}{\\partial \\mathbf{F}} = \\frac{\\partial W}{\\partial \\mathbf{C}} : \\frac{\\partial \\mathbf{C}}{\\partial \\mathbf{F}} + \\frac{\\partial W}{\\partial J} \\frac{\\partial J}{\\partial \\mathbf{F}}.\n$$\nHowever, for the given $W(\\mathbf{F})$, a direct variation yields the classical identity for energies depending on $\\mathbf{C}$ and $J$:\n- The part depending on $\\mathbf{C}$ produces $\\mathbf{P}_C = \\mathbf{F} \\mathbf{S}$ because\n$\n\\delta W|_C = \\frac{1}{2} \\mathbf{S} : \\delta \\mathbf{C} = \\frac{1}{2} \\mathbf{S} : \\big(\\mathbf{F}^{\\mathsf{T}} \\delta \\mathbf{F} + (\\delta \\mathbf{F})^{\\mathsf{T}} \\mathbf{F} \\big) = (\\mathbf{F} \\mathbf{S}) : \\delta \\mathbf{F},\n$\nusing $\\mathbf{S}^{\\mathsf{T}}=\\mathbf{S}$.\n- The dependence on $J$ provides the well-known derivative $\\partial J / \\partial \\mathbf{F} = J \\mathbf{F}^{-\\mathsf{T}}$, and since\n$\n\\frac{\\partial W}{\\partial J} = -\\mu \\frac{1}{J} + \\lambda \\frac{\\ln J}{J},\n$\nwe obtain\n$\n\\mathbf{P}_J = \\frac{\\partial W}{\\partial J} \\frac{\\partial J}{\\partial \\mathbf{F}} = \\big(-\\mu + \\lambda \\ln J\\big) \\mathbf{F}^{-\\mathsf{T}}.\n$\nCombining contributions in a standard derivation for the compressible neo-Hookean model, one can equivalently obtain the explicit formula\n$$\n\\mathbf{P} = \\mu \\big(\\mathbf{F} - \\mathbf{F}^{-\\mathsf{T}}\\big) + \\lambda \\ln J \\, \\mathbf{F}^{-\\mathsf{T}}.\n$$\nOn the other hand, substituting $\\mathbf{S}$ from above into $\\mathbf{F} \\mathbf{S}$,\n$\n\\mathbf{F} \\mathbf{S} = \\mathbf{F}\\big(\\mu \\mathbf{I} - \\mu \\mathbf{C}^{-1} + \\lambda \\ln J \\, \\mathbf{C}^{-1}\\big) = \\mu \\mathbf{F} - \\mu \\mathbf{F} \\mathbf{C}^{-1} + \\lambda \\ln J \\, \\mathbf{F} \\mathbf{C}^{-1}.\n$\nUsing $\\mathbf{C}^{-1} = (\\mathbf{F}^{\\mathsf{T}} \\mathbf{F})^{-1} = \\mathbf{F}^{-1} \\mathbf{F}^{-\\mathsf{T}}$ and $\\mathbf{F} \\mathbf{C}^{-1} = \\mathbf{F} \\mathbf{F}^{-1} \\mathbf{F}^{-\\mathsf{T}} = \\mathbf{F}^{-\\mathsf{T}}$, we obtain\n$\n\\mathbf{F} \\mathbf{S} = \\mu \\mathbf{F} - \\mu \\mathbf{F}^{-\\mathsf{T}} + \\lambda \\ln J \\, \\mathbf{F}^{-\\mathsf{T}},\n$\nwhich matches the explicit $\\mathbf{P}$ above. Therefore $\\mathbf{P} = \\mathbf{F} \\mathbf{S}$.\n\nAlgorithmic design for the program:\n- For each test matrix $\\mathbf{F}$:\n  1. Compute $J = \\det \\mathbf{F}$ and ensure $J > 0$ (guaranteed by the test suite).\n  2. Compute $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$ and its inverse $\\mathbf{C}^{-1}$.\n  3. Assemble $\\mathbf{S} = \\mu \\mathbf{I} - \\mu \\mathbf{C}^{-1} + \\lambda \\ln J \\, \\mathbf{C}^{-1}$.\n  4. Independently assemble $\\mathbf{P}$ from the explicit expression $\\mathbf{P} = \\mu (\\mathbf{F} - \\mathbf{F}^{-\\mathsf{T}}) + \\lambda \\ln J \\, \\mathbf{F}^{-\\mathsf{T}}$.\n  5. Form residuals $r_{\\text{sym}} = \\lVert \\mathbf{S} - \\mathbf{S}^{\\mathsf{T}} \\rVert_{\\mathrm{F}}$ and $r_{\\text{cons}} = \\lVert \\mathbf{P} - \\mathbf{F} \\mathbf{S} \\rVert_{\\mathrm{F}}$.\n  6. Compare both residuals to $\\varepsilon = 10^{-9}$ and record a boolean $\\mathrm{True}$ if both are below tolerance, else $\\mathrm{False}$.\n- Output the list of booleans in a single line as specified.\n\nNumerical considerations:\n- Since all $\\mathbf{F}$ in the test suite are well-conditioned enough (with $J$ bounded away from zero except for the near-singular but positive case), double-precision arithmetic suffices. The Frobenius norms should be on the order of machine precision for correct implementations.\n- The symmetry of $\\mathbf{S}$ follows analytically; numerically, any deviation is due to floating-point round-off, which the tolerance accommodates.\n\nThis verifies the two essential properties for the Piola–Kirchhoff stresses in the compressible neo-Hookean model: the symmetry of $\\mathbf{S}$ and the identity $\\mathbf{P} = \\mathbf{F} \\mathbf{S}$ for all $\\mathbf{F}$ with $J>0$ in the test suite.", "answer": "```python\nimport numpy as np\n\ndef compute_S(F, lam, mu):\n    \"\"\"\n    Compute the second Piola–Kirchhoff stress S for compressible neo-Hookean:\n    S = mu*I - mu*C^{-1} + lam*ln(J)*C^{-1}, where C = F^T F, J = det(F).\n    \"\"\"\n    C = F.T @ F\n    J = np.linalg.det(F)\n    C_inv = np.linalg.inv(C)\n    I = np.eye(3)\n    S = mu * I - mu * C_inv + lam * np.log(J) * C_inv\n    return S\n\ndef compute_P_from_F(F, lam, mu):\n    \"\"\"\n    Compute the first Piola–Kirchhoff stress P directly from F for compressible neo-Hookean:\n    P = mu*(F - F^{-T}) + lam*ln(J)*F^{-T}.\n    \"\"\"\n    J = np.linalg.det(F)\n    FinvT = np.linalg.inv(F).T\n    P = mu * (F - FinvT) + lam * np.log(J) * FinvT\n    return P\n\ndef run_tests():\n    lam = 120000.0\n    mu = 80000.0\n    eps = 1e-9\n\n    # Test cases as specified\n    F1 = np.array([\n        [1.0, 0.0, 0.0],\n        [0.0, 1.0, 0.0],\n        [0.0, 0.0, 1.0]\n    ], dtype=float)\n\n    c = 0.7648421872844886\n    s = 0.6442176872376910\n    F2 = np.array([\n        [ c, -s, 0.0],\n        [ s,  c, 0.0],\n        [0.0, 0.0, 1.0]\n    ], dtype=float)\n\n    F3 = np.array([\n        [1.2, 0.0, 0.0],\n        [0.0, 0.8, 0.0],\n        [0.0, 0.0, 1.0416666666666667]\n    ], dtype=float)\n\n    F4 = np.array([\n        [1.05, 0.3,  -0.2],\n        [0.0, 0.95,  0.25],\n        [0.0, 0.0,   1.1]\n    ], dtype=float)\n\n    F5 = np.array([\n        [ 1.0,  0.0, 0.0],\n        [ 0.02, 1.0, 0.0],\n        [-0.01, 0.03, 0.02]\n    ], dtype=float)\n\n    test_cases = [F1, F2, F3, F4, F5]\n\n    results = []\n    for F in test_cases:\n        # Compute stresses\n        S = compute_S(F, lam, mu)\n        P_direct = compute_P_from_F(F, lam, mu)\n        P_via_S = F @ S\n\n        # Residuals\n        sym_res = np.linalg.norm(S - S.T, ord='fro')\n        cons_res = np.linalg.norm(P_direct - P_via_S, ord='fro')\n\n        # Check tolerances\n        passed = (sym_res <= eps) and (cons_res <= eps)\n        results.append(passed)\n\n    return results\n\ndef main():\n    results = run_tests()\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    main()\n```", "id": "2587885"}]}