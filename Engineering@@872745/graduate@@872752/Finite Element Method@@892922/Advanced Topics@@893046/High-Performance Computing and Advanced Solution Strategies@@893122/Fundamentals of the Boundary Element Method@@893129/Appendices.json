{"hands_on_practices": [{"introduction": "The Boundary Element Method begins by transforming a partial differential equation defined over a volume into an equivalent integral equation on its surface. This exercise guides you through this fundamental process for the Laplace equation, starting from Green's second identity. By completing this derivation [@problem_id:2560745], you will build the discrete BEM system from scratch, gaining a first-principles understanding of the core influence matrices and the careful treatment required for their singular diagonal terms.", "problem": "Consider a bounded, simply connected domain $\\Omega \\subset \\mathbb{R}^{2}$ with a piecewise $\\mathcal{C}^{1}$ boundary $\\Gamma$, outward unit normal $\\boldsymbol{n}$, and an interior Dirichlet boundary-value problem for Laplace’s equation: find $u$ such that $\\Delta u = 0$ in $\\Omega$ and $u = \\bar{u}$ on $\\Gamma$, where $\\bar{u}$ is prescribed and sufficiently smooth. Use Green’s second identity together with the free-space fundamental solution of the Laplace operator in $\\mathbb{R}^{2}$, namely $G(\\boldsymbol{x},\\boldsymbol{\\xi}) = -\\dfrac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}|$, to derive the direct boundary integral equation for the limit of the interior solution trace approaching a boundary point. Then, construct the collocation Boundary Element Method (BEM) by:\n- discretizing $\\Gamma$ into $N$ straight elements with nodes $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$ ordered along $\\Gamma$,\n- approximating both the boundary potential $u$ and its outward normal derivative $q := \\partial u/\\partial n$ on $\\Gamma$ using scalar shape functions $\\{N_{j}\\}_{j=1}^{N}$ associated with the same nodal set,\n- enforcing the boundary integral equation at the set of nodal collocation points $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$.\n\nExplicitly identify the matrix kernels that arise and their limiting interpretations at the diagonal. Discuss, from first principles, how the singular behavior of the kernels is treated at the diagonal entries, distinguishing between the weakly singular logarithmic kernel and the Cauchy principal value kernel, and relate the diagonal coefficient $c_{i}$ to the local interior wedge angle $\\theta_{i}$ at $\\boldsymbol{\\xi}_{i}$ (measured in radians). Finally, for a point $\\boldsymbol{\\xi}_{i}$ where $\\Gamma$ is locally smooth (i.e., $\\theta_{i} = \\pi$), state the exact value of the diagonal coefficient $c_{i}$. Your final answer must be a single number. Use radians for any angle considerations. No rounding is required.", "solution": "We begin from Green’s second identity: for sufficiently smooth scalar fields $u,v$ on $\\Omega$ with boundary $\\Gamma$ and outward unit normal $\\boldsymbol{n}$,\n$$\n\\int_{\\Omega}\\left(u\\,\\Delta v - v\\,\\Delta u\\right)\\,\\mathrm{d}\\Omega\n=\n\\int_{\\Gamma}\\left(u\\,\\frac{\\partial v}{\\partial n} - v\\,\\frac{\\partial u}{\\partial n}\\right)\\,\\mathrm{d}\\Gamma.\n$$\nLet $v(\\boldsymbol{x}) = G(\\boldsymbol{x},\\boldsymbol{\\xi})$, where $G$ is the free-space fundamental solution of the Laplace operator in $\\mathbb{R}^{2}$,\n$$\nG(\\boldsymbol{x},\\boldsymbol{\\xi}) = -\\frac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}|,\n$$\nwhich satisfies $\\Delta_{\\boldsymbol{x}} G(\\boldsymbol{x},\\boldsymbol{\\xi}) = -\\delta(\\boldsymbol{x}-\\boldsymbol{\\xi})$. Since $u$ is harmonic ($\\Delta u = 0$ in $\\Omega$), substituting into Green's identity yields, for any fixed source point $\\boldsymbol{\\xi}\\in \\Omega$,\n$$\n\\int_{\\Omega}\\left(u(\\boldsymbol{x})\\,(-\\delta(\\boldsymbol{x}-\\boldsymbol{\\xi})) - G(\\boldsymbol{x},\\boldsymbol{\\xi})\\,(0)\\right)\\,\\mathrm{d}\\Omega(\\boldsymbol{x}) = \\int_{\\Gamma}\\left(u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi})}{\\partial n(\\boldsymbol{x})} - G(\\boldsymbol{x},\\boldsymbol{\\xi})\\,\\frac{\\partial u(\\boldsymbol{x})}{\\partial n(\\boldsymbol{x})}\\right)\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}).\n$$\nThe left-hand side reduces to $-u(\\boldsymbol{\\xi})$ by the sifting property of the Dirac delta function. Rearranging gives the Somigliana identity for an interior point:\n$$\nu(\\boldsymbol{\\xi}) = \\int_{\\Gamma}\\left(G(\\boldsymbol{x},\\boldsymbol{\\xi})\\,\\frac{\\partial u(\\boldsymbol{x})}{\\partial n(\\boldsymbol{x})} - u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi})}{\\partial n(\\boldsymbol{x})}\\right)\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\nwhere we define $q(\\boldsymbol{x}) := \\partial u/\\partial n$. Taking the limit as the interior point $\\boldsymbol{\\xi}$ approaches a boundary point $\\boldsymbol{\\xi}_{0}\\in \\Gamma$, the classic jump relations for layer potentials introduce a free-term coefficient $c(\\boldsymbol{\\xi}_{0})$, yielding the direct boundary integral equation:\n$$\nc(\\boldsymbol{\\xi}_{0})\\,u(\\boldsymbol{\\xi}_{0})\n+\n\\int_{\\Gamma} u(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{0})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\n=\n\\int_{\\Gamma} q(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{0})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\nwhere $c(\\boldsymbol{\\xi}_{0})$ is a geometric coefficient determined by the interior wedge angle at $\\boldsymbol{\\xi}_{0}$:\n$$\nc(\\boldsymbol{\\xi}_{0}) = \\frac{\\theta(\\boldsymbol{\\xi}_{0})}{2\\pi},\n$$\nwith $\\theta(\\boldsymbol{\\xi}_{0})$ the interior angle (in radians) of $\\Omega$ at $\\boldsymbol{\\xi}_{0}$. For a smooth point, $\\theta(\\boldsymbol{\\xi}_{0}) = \\pi$, hence $c(\\boldsymbol{\\xi}_{0}) = 1/2$.\n\nTo construct a collocation Boundary Element Method (BEM), partition $\\Gamma$ into $N$ straight boundary elements $\\{\\Gamma_{e}\\}_{e=1}^{N_{el}}$ with nodal points $\\{\\boldsymbol{\\xi}_{i}\\}_{i=1}^{N}$ ordered along $\\Gamma$. Introduce scalar shape functions $\\{N_{j}\\}_{j=1}^{N}$ associated with these nodes, and approximate the boundary fields as\n$$\nu(\\boldsymbol{x}) \\approx \\sum_{j=1}^{N} N_{j}(\\boldsymbol{x})\\,u_{j}, \n\\qquad\nq(\\boldsymbol{x}) \\approx \\sum_{j=1}^{N} N_{j}(\\boldsymbol{x})\\,q_{j},\n\\quad \\boldsymbol{x}\\in \\Gamma.\n$$\nEnforce the boundary integral equation at the collocation points $\\boldsymbol{\\xi}_{i}$, $i=1,\\dots,N$, to obtain\n$$\nc_{i}\\,u_{i} + \\sum_{j=1}^{N} \\left(\\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\\right) u_{j}\n=\n\\sum_{j=1}^{N} \\left(\\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x})\\right) q_{j}.\n$$\nDefine the influence matrices\n$$\nH_{ij} := \\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}), \n\\qquad\nG_{ij} := \\int_{\\Gamma} N_{j}(\\boldsymbol{x})\\,G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})\\,\\mathrm{d}\\Gamma(\\boldsymbol{x}),\n$$\nso the discrete collocation system reads\n$$\nc_{i}\\,u_{i} + \\sum_{j=1}^{N} H_{ij}\\,u_{j} = \\sum_{j=1}^{N} G_{ij}\\,q_{j}, \\quad i=1,\\dots,N.\n$$\nFor the interior Dirichlet problem, the boundary values $u_{j}$ are known (from $u|_{\\Gamma}=\\bar{u}$), and the unknowns are $\\{q_{j}\\}_{j=1}^{N}$. The right-hand side is assembled from the known $u_{j}$ and the matrix $H_{ij}$, while the left-hand side matrix acting on the unknowns is $G_{ij}$.\n\nWe now discuss the singular behavior and the diagonal terms:\n\n$1.$ The kernel $G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i}) = -\\dfrac{1}{2\\pi}\\ln|\\boldsymbol{x}-\\boldsymbol{\\xi}_{i}|$ is weakly singular (logarithmic) as $\\boldsymbol{x}\\to \\boldsymbol{\\xi}_{i}$. For $j$ such that the support of $N_{j}$ contains $\\boldsymbol{\\xi}_{i}$, the integral $G_{ij}$ is finite and can be evaluated exactly by analytic integration on straight elements or by singularity subtraction. No jump term arises from $G_{ij}$; the singularity is integrable.\n\n$2.$ The kernel $\\dfrac{\\partial G(\\boldsymbol{x},\\boldsymbol{\\xi}_{i})}{\\partial n(\\boldsymbol{x})}$ behaves like $\\mathcal{O}(|\\boldsymbol{x}-\\boldsymbol{\\xi}_{i}|^{-1})$ as $\\boldsymbol{x}\\to \\boldsymbol{\\xi}_{i}$ and must be interpreted in the Cauchy principal value sense. The classical jump relation for the double-layer potential yields that, upon taking the interior limit to the boundary, one obtains an additional local term $c_{i}\\,u_{i}$ with\n$$\nc_{i}=\\frac{\\theta_{i}}{2\\pi},\n$$\nwhere $\\theta_{i}$ is the interior wedge angle of $\\Omega$ at $\\boldsymbol{\\xi}_{i}$ (in radians). In practice, one either:\n- evaluates $H_{ij}$ as a principal value integral and treats $c_{i}$ explicitly, or\n- groups the diagonal contribution into $H_{ii}$ by adding or subtracting $c_{i}$ so that the implemented $H_{ii}$ is finite and consistent with the jump relation.\n\nFor a smooth point on $\\Gamma$, the local geometry has interior angle $\\theta_{i}=\\pi$, hence\n$$\nc_{i}=\\frac{\\pi}{2\\pi}=\\frac{1}{2}.\n$$\n\nTherefore, the exact value of the diagonal coefficient at a smooth boundary collocation point is $c_{i} = 1/2$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2560745"}, {"introduction": "While the previous practice established the BEM system, its accuracy hinges on correctly accounting for the local boundary geometry, especially at non-smooth points. This exercise [@problem_id:2560772] focuses on the 'free-term' coefficient, $c(\\mathbf{x})$, which captures the solid angle of the domain at a given boundary point. You will derive how this coefficient is determined by the interior angle at a corner, a critical step for ensuring the BEM formulation is consistent for realistic, polygonal domains.", "problem": "Consider the interior Laplace problem in two space dimensions on a bounded polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with boundary $\\Gamma$, where $u$ satisfies $\\nabla^{2} u = 0$ in $\\Omega$. Let $\\mathbf{x}_{0} \\in \\Gamma$ be a corner point where two straight edges meet, and let $\\theta \\in (0,2\\pi)$ denote the interior angle of $\\Omega$ at $\\mathbf{x}_{0}$ measured in radians. The direct boundary integral equation (BIE) based on Green’s third identity is formed using the two-dimensional fundamental solution $U(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$, the outward unit normal $\\mathbf{n}(\\mathbf{y})$ on $\\Gamma$, and the normal derivative $q(\\mathbf{y}) = \\frac{\\partial u}{\\partial n}(\\mathbf{y})$. When the source point approaches the boundary, a coefficient $c(\\mathbf{x}_{0})$ appears multiplying $u(\\mathbf{x}_{0})$.\n\nStarting from Green’s identities and the fundamental solution property $\\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) = -\\delta(\\mathbf{y}-\\mathbf{x})$, derive an expression for $c(\\mathbf{x}_{0})$ in terms of the interior angle $\\theta$ by analyzing the limiting process in which a small disk of radius $\\varepsilon$ centered at $\\mathbf{x}_{0}$ is removed from $\\Omega$ and $\\varepsilon \\to 0^{+}$. Then, evaluate $c(\\mathbf{x}_{0})$ for a re-entrant corner with $\\theta = \\frac{3\\pi}{2}$.\n\nFinally, briefly explain how this coefficient $c(\\mathbf{x})$ determines the correct diagonal entries of the system matrix in a collocation-based direct boundary element method (BEM) discretization of the BIE, and why using the angle-dependent value at corners is essential for consistency.\n\nProvide the value of $c(\\mathbf{x}_{0})$ for $\\theta = \\frac{3\\pi}{2}$ as an exact fraction. No rounding is required and no units are needed.", "solution": "The problem statement is analyzed and found to be valid. It is a well-posed problem in the mathematical theory of the boundary element method, containing no scientific or logical contradictions. All necessary information is provided.\n\nThe problem requires the derivation of the coefficient $c(\\mathbf{x}_{0})$ for the direct boundary integral equation (BIE) at a corner point $\\mathbf{x}_{0}$ on the boundary $\\Gamma$ of a two-dimensional domain $\\Omega$. The starting point is Green's second identity for a harmonic function $u$ (i.e., $\\nabla^{2} u = 0$) and the fundamental solution of the Laplace equation, $U(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$. The property of the fundamental solution is $\\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) = -\\delta(\\mathbf{y}-\\mathbf{x})$, where $\\delta$ is the Dirac delta function.\n\nGreen's second identity states:\n$$ \\int_{\\Omega} \\left( u(\\mathbf{y}) \\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) - U(\\mathbf{x},\\mathbf{y}) \\nabla^{2}_{\\mathbf{y}} u(\\mathbf{y}) \\right) d\\Omega_{\\mathbf{y}} = \\int_{\\Gamma} \\left( u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} - U(\\mathbf{x},\\mathbf{y}) \\frac{\\partial u(\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\nSubstituting $\\nabla^{2}u = 0$ and $\\nabla^{2}_{\\mathbf{y}} U = -\\delta(\\mathbf{y}-\\mathbf{x})$, for a source point $\\mathbf{x}$ inside the domain $\\Omega$, the identity becomes:\n$$ \\int_{\\Omega} u(\\mathbf{y}) (-\\delta(\\mathbf{y}-\\mathbf{x})) d\\Omega_{\\mathbf{y}} = -u(\\mathbf{x}) $$\nLetting $q(\\mathbf{y}) = \\frac{\\partial u}{\\partial n}(\\mathbf{y})$, we obtain the integral representation for $u(\\mathbf{x})$ for $\\mathbf{x} \\in \\Omega$:\n$$ -u(\\mathbf{x}) = \\int_{\\Gamma} \\left( u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} - U(\\mathbf{x},\\mathbf{y}) q(\\mathbf{y}) \\right) d\\Gamma_{\\mathbf{y}} $$\nThis is commonly rearranged as:\n$$ u(\\mathbf{x}) = \\int_{\\Gamma} \\left( U(\\mathbf{x},\\mathbf{y}) q(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\nTo derive the BIE for a source point $\\mathbf{x}_{0}$ on the boundary, we must account for the singularity of the kernels $U$ and $\\frac{\\partial U}{\\partial n}$. We follow the procedure of excluding a small disk $B(\\mathbf{x}_{0}, \\varepsilon)$ of radius $\\varepsilon$ around $\\mathbf{x}_{0}$ from the domain. The new domain is $\\Omega_{\\varepsilon} = \\Omega \\setminus B(\\mathbf{x}_{0}, \\varepsilon)$. The point $\\mathbf{x}_{0}$ is exterior to $\\Omega_{\\varepsilon}$, so the sifting property of the Dirac delta gives zero. Green's identity on $\\Omega_{\\varepsilon}$ with the source at $\\mathbf{x}_{0}$ is:\n$$ 0 = \\int_{\\partial \\Omega_{\\varepsilon}} \\left( U(\\mathbf{x}_{0},\\mathbf{y}) q(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x}_{0},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\nThe boundary $\\partial \\Omega_{\\varepsilon}$ consists of the original boundary excluding the part inside the disk, which we denote $\\Gamma'$, and the circular arc $\\Gamma_{\\varepsilon} = \\partial B(\\mathbf{x}_{0}, \\varepsilon) \\cap \\Omega$. The integral becomes:\n$$ 0 = \\int_{\\Gamma'} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma + \\int_{\\Gamma_{\\varepsilon}} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma $$\nWe now take the limit as $\\varepsilon \\to 0$. In this limit, the integral over $\\Gamma'$ becomes the Cauchy principal value (p.v.) integral over $\\Gamma$:\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma'} (\\dots) d\\Gamma = \\text{p.v.} \\int_{\\Gamma} (\\dots) d\\Gamma $$\nWe must evaluate the limit of the integral over the arc $\\Gamma_{\\varepsilon}$. Let us analyze the two terms separately.\nFor the first term, involving $U q$: on $\\Gamma_{\\varepsilon}$, $|\\mathbf{y}-\\mathbf{x}_{0}|=\\varepsilon$, so $U(\\mathbf{x}_{0},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln(\\varepsilon)$. The length of the arc $\\Gamma_{\\varepsilon}$ is $\\theta\\varepsilon$, where $\\theta$ is the interior angle at the corner $\\mathbf{x}_{0}$. Assuming $q(\\mathbf{y})$ is bounded near $\\mathbf{x}_{0}$, we have:\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} U q \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} \\left( -\\frac{1}{2\\pi}\\ln(\\varepsilon) \\right) \\cdot (\\text{average } q) \\cdot (\\theta\\varepsilon) = 0 $$\nsince $\\lim_{\\varepsilon \\to 0} \\varepsilon \\ln(\\varepsilon) = 0$.\n\nFor the second term, involving $-u \\frac{\\partial U}{\\partial n}$: on the arc $\\Gamma_{\\varepsilon}$, the outward unit normal $\\mathbf{n}$ with respect to the domain $\\Omega_{\\varepsilon}$ points towards the center $\\mathbf{x}_{0}$. It is given by $\\mathbf{n} = -\\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|}$. The gradient of the fundamental solution is $\\nabla_{\\mathbf{y}} U = -\\frac{1}{2\\pi} \\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|^2}$.\nThe normal derivative of $U$ is:\n$$ \\frac{\\partial U}{\\partial n_{\\mathbf{y}}} = \\nabla_{\\mathbf{y}} U \\cdot \\mathbf{n} = \\left( -\\frac{1}{2\\pi} \\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|^2} \\right) \\cdot \\left( -\\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|} \\right) = \\frac{1}{2\\pi} \\frac{|\\mathbf{y}-\\mathbf{x}_{0}|^2}{|\\mathbf{y}-\\mathbf{x}_{0}|^3} = \\frac{1}{2\\pi|\\mathbf{y}-\\mathbf{x}_{0}|} $$\nOn $\\Gamma_{\\varepsilon}$, $|\\mathbf{y}-\\mathbf{x}_{0}| = \\varepsilon$, so $\\frac{\\partial U}{\\partial n} = \\frac{1}{2\\pi\\varepsilon}$. Assuming $u$ is continuous at $\\mathbf{x}_{0}$, $u(\\mathbf{y}) \\to u(\\mathbf{x}_{0})$ as $\\varepsilon \\to 0$. The limit of the integral is:\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} -u(\\mathbf{y}) \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} -u(\\mathbf{y}) \\frac{1}{2\\pi\\varepsilon} \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} -u(\\mathbf{x}_{0}) \\frac{1}{2\\pi\\varepsilon} (\\theta\\varepsilon) = -u(\\mathbf{x}_{0}) \\frac{\\theta}{2\\pi} $$\nSubstituting these limits back into the integral equation:\n$$ 0 = \\text{p.v.} \\int_{\\Gamma} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma - u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} $$\nThe standard form of the direct boundary integral equation is written as:\n$$ c(\\mathbf{x}_{0})u(\\mathbf{x}_{0}) + \\int_{\\Gamma} u \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\int_{\\Gamma} U q \\, d\\Gamma $$\nwhere the integrals are understood in the principal value sense. Rearranging our derived equation:\n$$ u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} = \\text{p.v.} \\int_{\\Gamma} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma \\implies u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} + \\text{p.v.}\\int_{\\Gamma} u \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\text{p.v.}\\int_{\\Gamma} U q \\, d\\Gamma $$\nBy comparing this with the standard BIE form, we identify the coefficient $c(\\mathbf{x}_{0})$:\n$$ c(\\mathbf{x}_{0}) = \\frac{\\theta}{2\\pi} $$\nThis coefficient represents the fraction of the solid angle subtended by the domain at the point $\\mathbf{x}_{0}$. For a smooth point, $\\theta=\\pi$, so $c(\\mathbf{x}_{0}) = \\frac{1}{2}$. For an interior point, $\\theta=2\\pi$, so $c(\\mathbf{x}_{0})=1$.\n\nFor a re-entrant corner with interior angle $\\theta = \\frac{3\\pi}{2}$, the coefficient is:\n$$ c(\\mathbf{x}_{0}) = \\frac{3\\pi/2}{2\\pi} = \\frac{3\\pi}{4\\pi} = \\frac{3}{4} $$\n\nIn a collocation-based Boundary Element Method (BEM), the BIE is enforced at a set of discrete nodes $\\{\\mathbf{x}_i\\}$ on the boundary. This yields a system of linear algebraic equations $[H]\\{u\\} = [G]\\{q\\}$. The coefficient matrix $[H]$ is assembled from terms involving the free-term coefficient $c(\\mathbf{x}_i)$ and integrals of the kernel $\\frac{\\partial U}{\\partial n}$. The diagonal entry of the full matrix operating on the unknown vector $\\{u\\}$ at node $i$ is $\\hat{H}_{ii} = c(\\mathbf{x}_i) + \\text{p.v.}\\int_{\\Gamma_i} \\frac{\\partial U(\\mathbf{x}_i, \\mathbf{y})}{\\partial n_y} d\\Gamma_y$, where $\\Gamma_i$ is the boundary element containing the node $\\mathbf{x}_i$. The coefficient $c(\\mathbf{x}_i)$ is thus an explicit, essential component of the diagonal terms of the system matrix.\n\nUsing the correct, angle-dependent value for $c(\\mathbf{x}_i)$ at corners is essential for consistency because this value is a direct consequence of the governing integral equation derived from Green's identities. It mathematically represents the local geometry at the collocation point. Using an incorrect value, such as assuming $c(\\mathbf{x}_i) = \\frac{1}{2}$ everywhere, would mean that the discretized equations do not correctly represent the underlying physics at the corners. This introduces a fundamental error into the numerical model, leading to an inconsistent system and inaccurate solutions, particularly in regions of high gradients like corners. The consistency of the BEM relies on each discrete equation being a faithful representation of the integral identity, for which the correct geometric factor $c(\\mathbf{x}_i)$ is non-negotiable.", "answer": "$$\n\\boxed{\\frac{3}{4}}\n$$", "id": "2560772"}, {"introduction": "The ultimate test of understanding is the ability to translate theory into a working implementation. This hands-on coding challenge [@problem_id:2560737] leverages the unique symmetries of a circular domain to implement a highly efficient BEM using the Fast Fourier Transform. You will derive the exact Dirichlet-to-Neumann map for the exterior Laplace problem and verify your numerical results against this analytical benchmark, providing concrete insight into the method's accuracy and convergence properties.", "problem": "Consider the two-dimensional Laplace equation in the plane, with a circular interface of radius $a$ separating an interior disk $\\Omega^{-}$ and the unbounded exterior $\\Omega^{+}$. Let the outward unit normal $\\mathbf{n}$ point from $\\Omega^{-}$ into $\\Omega^{+}$. The potential $u$ satisfies $\\Delta u = 0$ in both $\\Omega^{-}$ and $\\Omega^{+}$. On the interface $\\Gamma = \\{ (x,y) : x^{2} + y^{2} = a^{2} \\}$, the continuity conditions for a perfect coupling without sources are the continuity of the trace $u^{-}|_{\\Gamma} = u^{+}|_{\\Gamma}$ and the balance of normal fluxes $q^{-} + q^{+} = 0$, where $q^{\\pm} = \\partial u^{\\pm} / \\partial \\mathbf{n}$ denotes the normal derivative taken with the normal pointing from $\\Omega^{-}$ to $\\Omega^{+}$. Assume the exterior solution in $\\Omega^{+}$ decays at infinity.\n\nStarting only from the following fundamental base:\n- The two-dimensional fundamental solution of the Laplace operator, $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert$.\n- Green’s identities and the boundary integral representation of harmonic functions.\n- The definitions of the single-layer and double-layer potentials and their boundary traces on smooth curves.\n\nDerive the boundary equation that couples the prescribed Dirichlet data $u|_{\\Gamma}$ on the circle to the unknown exterior Neumann data $q^{+}$ via boundary integral operators. Specialize this equation to the case of a circular interface and deduce the action of the exterior Dirichlet-to-Neumann map on Fourier modes $\\cos(n\\theta)$, where $\\theta$ is the polar angle on $\\Gamma$ measured in radians.\n\nThen implement a numerical scheme that uses this boundary integral coupling to enforce the exterior Dirichlet-to-Neumann map for the exterior domain. For the interior field, use the analytic harmonic polynomial $u^{-}(r,\\theta) = r^{n} \\cos(n\\theta)$ in polar coordinates $(r,\\theta)$; this provides the boundary Dirichlet data $g(\\theta) = u^{-}(a,\\theta)$ and the interior normal flux $q^{-}(\\theta) = \\partial u^{-}/\\partial r \\big|_{r=a}$. Use a Fourier-based implementation of the boundary integral coupling specialized to the circle to map $g(\\theta)$ to an approximation of the exterior flux $q^{+}(\\theta)$, and verify both:\n- That the numerically enforced Dirichlet-to-Neumann map for the exterior agrees with the exact map derived from first principles.\n- That the coupling condition $q^{-} + q^{+} = 0$ holds on $\\Gamma$.\n\nYour program must:\n- Parameterize the circle $\\Gamma$ by $N$ equispaced angles $\\theta_{j} = 2\\pi j / N$ for $j = 0,\\dots,N-1$ (angles in radians), sample $g(\\theta_{j})$ on these points, and compute the numerical exterior Neumann data $q^{+}_{\\mathrm{num}}(\\theta_{j})$ using a Fourier-symbol application of the boundary integral coupling specialized to the circle.\n- Compute the exact exterior Neumann data $q^{+}_{\\mathrm{exact}}(\\theta_{j})$ corresponding to $g(\\theta)$ obtained from $u^{-}(r,\\theta) = r^{n}\\cos(n\\theta)$, based on your derivation of the exact Dirichlet-to-Neumann map for the circle.\n- Report two scalar errors for each test case:\n  1. The maximum absolute error of the exterior Dirichlet-to-Neumann map on the nodes, $E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$.\n  2. The maximum absolute violation of the coupling condition, $E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$.\n\nTest suite:\n- Use the following parameter triples $(a,n,N)$:\n  1. $(a,n,N) = (1.0, 1, 128)$.\n  2. $(a,n,N) = (1.0, 5, 128)$.\n  3. $(a,n,N) = (2.0, 3, 128)$.\n  4. $(a,n,N) = (1.0, 30, 64)$.\n  5. $(a,n,N) = (1.0, 10, 16)$.\nThese cover a typical case, higher harmonics, a different radius, a near-Nyquist mode, and an under-resolved edge case, respectively.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is a two-element list of floats $[E_{\\mathrm{DtN}}, E_{\\mathrm{cpl}}]$ for the corresponding test case, in the order listed above. For example: [[e1_dtn,e1_cpl],[e2_dtn,e2_cpl],...].\n\nNo external input is required. All angles must be treated in radians, and no physical units are involved; all quantities are dimensionless. The code must be fully self-contained and runnable as provided.", "solution": "The problem requires the derivation and numerical implementation of a boundary integral equation (BIE) method to determine the exterior Dirichlet-to-Neumann (DtN) map for the 2D Laplace equation on a circular interface.\n\n### Part 1: Derivation of the Boundary Integral Equation\n\nLet $\\Omega^{-}$ be the interior disk of radius $a$ and $\\Omega^{+}$ be the unbounded exterior region. The interface is the circle $\\Gamma$. The potential $u$ is harmonic, i.e., $\\Delta u = 0$, in $\\Omega^{-}$ and $\\Omega^{+}$. Let $g = u|_{\\Gamma}$ be the Dirichlet data on the interface, and let $q^{\\pm} = \\partial u^{\\pm}/\\partial\\mathbf{n}$ be the normal derivatives, where $\\mathbf{n}$ is the outward normal from $\\Omega^{-}$.\n\nGreen's third identity for a harmonic function $u$ in a domain $\\Omega$ with boundary $\\partial\\Omega$ is:\n$$\nu(\\mathbf{x}) = \\int_{\\partial\\Omega} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u}{\\partial \\mathbf{n}_{\\mathbf{y}}}(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}, \\quad \\mathbf{x} \\in \\Omega\n$$\nwhere $G(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi} \\ln|\\mathbf{x} - \\mathbf{y}|$ is the fundamental solution and $\\mathbf{n}_{\\mathbf{y}}$ is the outward normal at $\\mathbf{y} \\in \\partial\\Omega$.\n\nWe apply this identity to the exterior domain $\\Omega^{+}$. The boundary of $\\Omega^{+}$ is $\\Gamma \\cup \\Gamma_{\\infty}$, where $\\Gamma_{\\infty}$ is a circle at infinity. The normal vector pointing out of $\\Omega^{+}$ is $-\\mathbf{n}$ on $\\Gamma$. The contribution from $\\Gamma_{\\infty}$ vanishes due to the decay condition on $u^{+}$. If $u^{+}$ decays as $O(1/|\\mathbf{x}|)$, the term $u_{\\infty}$ is zero. We assume a stronger decay condition that is standard for this problem, ensuring $u \\to 0$ at infinity. Applying Green's identity to $u^{+}$ in $\\Omega^{+}$ for a point $\\mathbf{x} \\in \\Omega^{+}$:\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u^{+}}{\\partial (-\\mathbf{n})}(\\mathbf{y}) - u^{+}(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial (-\\mathbf{n})} \\right) dS_{\\mathbf{y}}\n$$\nSubstituting $g=u^{+}|_{\\Gamma}$, $q^{+} = \\partial u^{+}/\\partial\\mathbf{n}$, and $\\partial/\\partial(-\\mathbf{n}) = -\\partial/\\partial\\mathbf{n}$:\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( -G(\\mathbf{x}, \\mathbf{y}) q^{+}(\\mathbf{y}) + g(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}\n$$\nLet us define the single-layer potential operator $\\mathcal{S}_{\\Gamma}$ and double-layer potential operator $\\mathcal{D}_{\\Gamma}$:\n$$\n(\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\sigma(\\mathbf{y}) dS_{\\mathbf{y}}\n$$\n$$\n(\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\mu(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} dS_{\\mathbf{y}}\n$$\nThe representation for $u^{+}$ is thus $u^{+}(\\mathbf{x}) = -(\\mathcal{S}_{\\Gamma} q^{+})(\\mathbf{x}) + (\\mathcal{D}_{\\Gamma} g)(\\mathbf{x})$ for $\\mathbf{x} \\in \\Omega^{+}$.\n\nTo obtain a boundary integral equation, we take the limit as $\\mathbf{x} \\to \\mathbf{p} \\in \\Gamma$ from the exterior $\\Omega^{+}$. Using the standard jump relations for layer potentials on a smooth boundary:\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = (S_{\\Gamma} \\sigma)(\\mathbf{p})\n$$\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = (K_{\\Gamma} \\mu)(\\mathbf{p}) + \\frac{1}{2}\\mu(\\mathbf{p})\n$$\nwhere $S_{\\Gamma}$ and $K_{\\Gamma}$ are the boundary integral operators (the non-singular parts of the potentials on $\\Gamma$). Applying these limits to the representation of $u^{+}$:\n$$\ng(\\mathbf{p}) = -(S_{\\Gamma} q^{+})(\\mathbf{p}) + \\left((K_{\\Gamma} g)(\\mathbf{p}) + \\frac{1}{2}g(\\mathbf{p})\\right)\n$$\nRearranging gives the desired boundary integral equation coupling the Dirichlet data $g$ to the exterior Neumann data $q^{+}$:\n$$\n\\left(\\frac{1}{2}I - K_{\\Gamma}\\right)g = -S_{\\Gamma} q^{+}\n$$\n\n### Part 2: Specialization to a Circle and the DtN Map\n\nFor a circular boundary of radius $a$, the operators $S_{\\Gamma}$ and $K_{\\Gamma}$ are convolution operators and are diagonalized by the complex Fourier basis $\\{e^{ik\\theta}\\}_{k \\in \\mathbb{Z}}$. We find their eigenvalues (symbols), denoted $\\hat{S}_k$ and $\\hat{K}_k$.\nThe kernel of $K_{\\Gamma}$ is $K(\\mathbf{x},\\mathbf{y}) = \\frac{\\partial G}{\\partial n_y} = -\\frac{1}{4\\pi a}$ for $\\mathbf{x}, \\mathbf{y} \\in \\Gamma$. The symbol is found to be:\n$$\n\\hat{K}_k =\n\\begin{cases}\n-1/2  \\text{if } k=0 \\\\\n0  \\text{if } k \\neq 0\n\\end{cases}\n$$\nThe kernel of $S_{\\Gamma}$ is $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert = -\\frac{1}{2\\pi} \\ln \\left( 2a \\left|\\sin\\left(\\frac{\\theta'-\\theta}{2}\\right)\\right| \\right)$. Its symbol is:\n$$\n\\hat{S}_k =\n\\begin{cases}\n-a\\ln a  \\text{if } k=0 \\text{ and } a \\neq 1 \\\\\na/(2|k|)  \\text{if } k \\neq 0\n\\end{cases}\n$$\nFor $a=1$, the capacity of the unit circle causes a logarithmic singularity in potential theory, making $\\hat{S}_0=0$. This implies a compatibility condition on the data.\n\nThe BIE in Fourier space becomes an algebraic equation for the Fourier coefficients $\\hat{g}_k$ and $\\hat{q}^{+}_k$:\n$$\n(\\frac{1}{2} - \\hat{K}_k)\\hat{g}_k = -\\hat{S}_k \\hat{q}^{+}_k\n$$\nWe can now solve for $\\hat{q}^{+}_k$, which defines the DtN map $\\Lambda^{+}: g \\mapsto q^{+}$.\n\nFor $k \\neq 0$:\n$$\n(\\frac{1}{2} - 0)\\hat{g}_k = -\\frac{a}{2|k|} \\hat{q}^{+}_k \\quad \\implies \\quad \\hat{q}^{+}_k = -\\frac{|k|}{a}\\hat{g}_k\n$$\n\nThe problem specifies boundary data derived from an interior solution $u^{-}(r,\\theta)=r^n\\cos(n\\theta)$, so $g(\\theta)=a^n\\cos(n\\theta)$. For $n0$, this function has zero mean, so $\\hat{g}_0=0$, which in turn implies $\\hat{q}^{+}_0=0$. We do not need to analyze the $k=0$ case further for the given test cases.\n\nLet's find the action of $\\Lambda^{+}$ on $g(\\theta) = a^n \\cos(n\\theta)$.\n$g(\\theta) = \\frac{a^n}{2}(e^{in\\theta} + e^{-in\\theta})$. Its non-zero Fourier coefficients are $\\hat{g}_n = \\hat{g}_{-n} = \\frac{a^n}{2\\pi} \\pi = a^n/2$ (with the $\\frac{1}{2\\pi}\\int$ convention for FFT). Normalizing for `numpy.fft`, let's work with the total function.\nThe mode $e^{in\\theta}$ for $g$ maps to $-\\frac{|n|}{a}e^{in\\theta}$ for $q^+$. Linearity implies:\n$$\n\\Lambda^{+}(a^n\\cos(n\\theta)) = a^n \\Lambda^{+}(\\cos(n\\theta)) = a^n \\left( -\\frac{n}{a} \\cos(n\\theta) \\right) = -n a^{n-1} \\cos(n\\theta)\n$$\nThis is the exact exterior Neumann data, $q^{+}_{\\mathrm{exact}}(\\theta)$.\n\n### Part 3: Numerical Implementation and Verification\n\nThe numerical scheme proceeds as follows:\n1. Discretize $\\Gamma$ with $N$ points $\\theta_j = 2\\pi j/N$. Sample $g(\\theta_j) = a^n \\cos(n\\theta_j)$.\n2. Compute the Discrete Fourier Transform (DFT) of $g$, yielding $\\hat{g}_k$.\n3. Apply the DtN map in Fourier space: for each wavenumber $k$, compute $\\hat{q}^{+}_{k, \\text{num}} = - \\frac{|k|}{a} \\hat{g}_k$. For $k=0$, $\\hat{q}^{+}_{0, \\text{num}}=0$.\n4. Compute the numerical exterior flux $q^{+}_{\\mathrm{num}}$ by applying the Inverse DFT to $\\hat{q}^{+}_{k, \\text{num}}$.\n5. Compute the exact interior flux $q^{-}(\\theta_j) = \\partial_r(r^n\\cos(n\\theta))|_{r=a} = na^{n-1}\\cos(n\\theta_j)$.\n6. Compute the exact exterior flux $q^{+}_{\\mathrm{exact}}(\\theta_j) = -na^{n-1}\\cos(n\\theta_j) = -q^{-}(\\theta_j)$.\n7. Calculate the errors:\n   - $E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$\n   - $E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$\n\nAs $q^{-}(\\theta_j) = -q^{+}_{\\mathrm{exact}}(\\theta_j)$, the two error metrics are mathematically equivalent:\n$E_{\\mathrm{cpl}} = \\max_{j} \\lvert -q^{+}_{\\mathrm{exact}}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert = E_{\\mathrm{DtN}}$.\nThe numerical implementation will confirm this. The error arises from the discretization of the Fourier transform and floating-point arithmetic. For the under-resolved case ($n  N/2$), aliasing will be the dominant source of error.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    This program implements a Fourier-based boundary integral method to solve for the\n    exterior Dirichlet-to-Neumann (DtN) map for the 2D Laplace equation on a circle.\n    It verifies the numerical DtN map against the exact analytical map for specific\n    harmonic boundary data derived from an interior solution.\n    \"\"\"\n\n    # Test suite: (a, n, N)\n    # a: radius of the circular interface\n    # n: mode number of the harmonic data (cos(n*theta))\n    # N: number of discretization points on the circle\n    test_cases = [\n        (1.0, 1, 128),\n        (1.0, 5, 128),\n        (2.0, 3, 128),\n        (1.0, 30, 64),\n        (1.0, 10, 16),\n    ]\n\n    results = []\n\n    for a, n, N in test_cases:\n        # 1. Discretize the boundary and define data from the interior problem.\n        # N equispaced points on the circle of radius a.\n        theta = 2 * np.pi * np.arange(N) / N\n\n        # The interior potential is u^-(r, theta) = r^n * cos(n*theta).\n        # This provides the Dirichlet data g(theta) on the boundary r=a.\n        g = (a**n) * np.cos(n * theta)\n\n        # The interior normal flux is q^-(theta) = du^-/dr |_(r=a).\n        # For n=0, q- is 0. For n0, it is n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_minus = np.zeros(N)\n        else:\n            q_minus = n * (a**(n - 1)) * np.cos(n * theta)\n\n        # 2. Compute the numerical exterior flux q_plus_num using BIE in Fourier space.\n        # The BIE relating exterior flux q+ to Dirichlet data g is:\n        # (1/2 * I - K) * g = -S * q+\n        # This implies the DtN map in Fourier space for mode k is:\n        # q_hat_k = -inv(S_k) * (1/2 - K_k) * g_hat_k\n        \n        g_hat = np.fft.fft(g)\n        k = np.fft.fftfreq(N) * N\n\n        # The DtN map symbol (eigenvalue) for mode k is -(k/a).\n        # For k=0, the map is more complex, but for mean-zero data, flux is mean-zero.\n        # Since n0 for all test cases, g has zero mean, so g_hat[0] is zero.\n        # This implies q_plus_hat_num[0] is also zero.\n        \n        dtn_symbol = np.zeros(N, dtype=float)\n        k_nonzero_indices = np.where(k != 0)\n        k_nonzero = k[k_nonzero_indices]\n        dtn_symbol[k_nonzero_indices] = -np.abs(k_nonzero) / a\n        \n        q_plus_hat_num = dtn_symbol * g_hat\n\n        # Transform back to physical space. Result should be real.\n        q_plus_num = np.fft.ifft(q_plus_hat_num).real\n\n        # 3. Compute the exact exterior flux q_plus_exact.\n        # The exterior solution is u^+(r,theta) = a^(2n)*r^(-n)*cos(n*theta).\n        # q_plus_exact = du+/dr |_(r=a) = -n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_plus_exact = np.zeros(N)\n        else:\n            q_plus_exact = -n * (a**(n - 1)) * np.cos(n * theta)\n        \n        # 4. Calculate errors.\n        # Error 1: DtN map error\n        e_dtn = np.max(np.abs(q_plus_num - q_plus_exact))\n\n        # Error 2: Coupling condition violation\n        e_cpl = np.max(np.abs(q_minus + q_plus_num))\n        \n        results.append([e_dtn, e_cpl])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(res) for res in results)}]\")\n\nsolve()\n```", "id": "2560737"}]}