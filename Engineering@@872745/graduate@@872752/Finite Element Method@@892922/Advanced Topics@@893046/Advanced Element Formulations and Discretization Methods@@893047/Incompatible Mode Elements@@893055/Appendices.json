{"hands_on_practices": [{"introduction": "To appreciate the power of incompatible mode elements, we first need to understand the limitations of standard formulations. This exercise presents a classic cantilever beam problem, a scenario where low-order elements often struggle. By comparing the behavior of a standard fully-integrated element, a reduced-integration element, and an element enhanced with incompatible modes, you will gain a qualitative understanding of issues like shear locking and stress oscillations, providing a clear motivation for the advanced techniques discussed in this article [@problem_id:2568555].", "problem": "A long, slender, plane-stress cantilever of length $L$, height $H$, and thickness $t$ (in the out-of-plane direction) is subjected to a constant end moment $M$ at $x=L$ that induces nearly pure bending about the $z$-axis. The material is linear elastic with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The exact continuum bending field (for a slender beam) has axial stress varying linearly across the depth, $\\sigma_{xx}(y)=\\dfrac{M}{I}\\,y$, with $I=\\dfrac{H^3 t}{12}$, and negligible shear stress $\\sigma_{xy}\\approx 0$ in the interior.\n\nDiscretize the beam by a structured mesh of isoparametric bilinear quadrilateral elements on a rectangular domain. Consider three element/integration variants:\n- Standard bilinear $Q4$ with full Gauss integration using $2\\times 2$ points.\n- Reduced integration bilinear $Q4$ using $1\\times 1$ point (no hourglass control).\n- Bilinear $Q4$ enriched with incompatible modes (Wilson–Taylor type) condensed at the element level, integrated with $2\\times 2$ points.\n\nAlong a vertical cut located at some fixed $x=x_c$ with $0<x_c<L$, engineers often observe element-to-element oscillations in pointwise axial stress $\\sigma_{xx}(y)$ when plotting Gauss-point or extrapolated nodal stresses versus $y$.\n\nWhich of the following statements about the relative magnitude of these oscillations and the underlying mechanisms is/are most consistent with first principles of the finite element method?\n\nA. In bending-dominated states, the standard fully integrated $Q4$ tends to produce pronounced element-to-element oscillations in $\\sigma_{xx}(y)$ because the exact quadratic-in-$x$ component of $u_y$ cannot be represented by a bilinear field, leading to parasitic shear/membrane strains and interelement stress jumps; reduced integration $Q4$ generally reduces the oscillation amplitude by under-integrating parasitic stiffness but risks hourglass modes; the $Q4$ with incompatible modes yields the smoothest and most accurate stress profile by improving the representation of curvature-induced strain gradients without introducing spurious zero-energy modes.\n\nB. The dominant cause of the oscillations in standard $Q4$ under bending is volumetric locking; therefore, as $\\nu\\to 0$ the oscillations vanish regardless of the integration rule.\n\nC. Reduced integration completely eliminates oscillations in bending because it exactly integrates the bilinear stiffness; consequently, it cannot hourglass on a regular mesh subjected to pure bending.\n\nD. Incompatible mode enrichment reduces oscillations by augmenting the internal strain field with bubble-like displacement modes that vanish on element edges, preserving interelement $C^0$ continuity while improving the element’s ability to represent curvature; this alleviates parasitic shear/membrane strains and does not create hourglass modes.\n\nE. If only a single element ($N_h=1$) is used across the depth $H$, then the three formulations produce essentially identical pointwise axial stresses in pure bending because they share the same boundary nodal degrees of freedom.\n\nSelect all that apply.", "solution": "The user has provided a problem statement concerning the behavior of different finite element formulations for a beam in pure bending. I will first validate the problem statement and then proceed to a detailed solution.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Physical System**: A long, slender, plane-stress cantilever beam. Dimensions: length $L$, height $H$, thickness $t$.\n- **Loading**: A constant end moment $M$ at $x=L$, inducing nearly pure bending.\n- **Material Properties**: Linear elastic with Young’s modulus $E$ and Poisson’s ratio $\\nu$.\n- **Analytical Solution (Slender Beam)**: Axial stress $\\sigma_{xx}(y)=\\dfrac{M}{I}\\,y$ with $I=\\dfrac{H^3 t}{12}$. Shear stress $\\sigma_{xy}\\approx 0$.\n- **Finite Element Model**: A structured mesh of isoparametric bilinear quadrilateral ($Q4$) elements on a rectangular domain.\n- **Element/Integration Variants**:\n    1. Standard bilinear $Q4$ with full $2\\times 2$ Gauss integration.\n    2. Reduced integration bilinear $Q4$ with a single $1\\times 1$ Gauss point ($Q4/1$).\n    3. Bilinear $Q4$ enriched with incompatible modes (e.g., Wilson-Taylor type), integrated with $2\\times 2$ points ($Q4I$).\n- **Phenomenon of Interest**: Element-to-element oscillations in pointwise axial stress $\\sigma_{xx}(y)$ observed along a vertical cut at $x=x_c$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is firmly grounded in the established theory of the finite element method and linear elasticity. The concepts of shear locking, reduced integration, hourglassing, and incompatible modes for bilinear quadrilateral elements are standard topics in computational mechanics. The scenario described is a classic benchmark problem used to evaluate element performance. The problem is scientifically sound.\n- **Well-Posedness**: The problem asks for a qualitative assessment of several statements based on FEM principles. It is well-posed, as a definitive analysis of these element behaviors under bending is possible and leads to unambiguous conclusions about the correctness of the given statements.\n- **Objectivity**: The language is technical, precise, and objective. Terms used have specific, well-defined meanings within the field.\n- **Completeness and Consistency**: The problem statement is self-contained and provides sufficient information to analyze the underlying mechanics of the different element formulations. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is a standard, well-structured problem in advanced solid mechanics and finite element analysis. I will proceed with the detailed derivation and solution.\n\n### Derivation and Analysis\n\nThe problem concerns the ability of low-order finite elements to accurately model a state of pure bending. The exact displacement field for a cantilever beam under an end moment $M$ according to Euler-Bernoulli beam theory is:\n$$u_x(x,y) = -\\frac{M}{EI}xy$$\n$$u_y(x,y) = \\frac{M}{2EI}x^2 + \\frac{\\nu M}{2EI}y^2 + \\text{rigid body terms}$$\nThe key features are that the axial displacement $u_x$ is bilinear in $x$ and $y$, and the transverse displacement $u_y$ is quadratic in $x$. The corresponding strains are $\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = -\\frac{M}{EI}y$, $\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\nu M}{EI}y$, and the shear strain $\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = (-\\frac{M}{EI}x) + (\\frac{M}{EI}x) = 0$. The axial stress is $\\sigma_{xx} \\approx E \\epsilon_{xx} = -\\frac{M}{I}y$ (for plane stress with $\\nu=0$ for simplicity, but the argument holds for general $\\nu$), which is linear in $y$.\n\n1.  **Standard Bilinear Q4 Element (Full Integration)**\n    A standard isoparametric $Q4$ element has a displacement field of the form $u(\\xi, \\eta) = a_0 + a_1\\xi + a_2\\eta + a_3\\xi\\eta$ for each component, where $\\xi$ and $\\eta$ are the local coordinates. For a rectangular mesh aligned with the $x,y$ axes, $\\xi$ is proportional to $x$ and $\\eta$ is proportional to $y$. The element can exactly represent the bilinear $u_x$ field. However, it cannot represent the quadratic $u_y(x) \\propto x^2$ field. To approximate the required curvature, the element edges must bend, but they are constrained to remain straight. As an assembly of such elements bends, each element deforms into a shape that induces a spurious, non-zero shear strain, $\\gamma_{xy}^{spurious} \\neq 0$. This occurs because the term $\\frac{\\partial u_y}{\\partial x}$ from the FEM approximation does not exactly cancel the $\\frac{\\partial u_x}{\\partial y}$ term as it should. This spurious shear strain generates artificial shear stress and contributes a large, non-physical strain energy term, making the element excessively stiff in bending. This phenomenon is known as **shear locking**. This excessive stiffness leads to poor displacement and stress results, manifesting as severe oscillations in the stress field from one element to the next, as the elements struggle to accommodate the bending deformation.\n\n2.  **Reduced Integration Q4 Element (Q4/1)**\n    This formulation uses a single Gauss point at the element center ($\\xi=0, \\eta=0$) to compute the strains and build the stiffness matrix. For a rectangular element under bending, the parasitic shear strain field $\\gamma_{xy}^{spurious}$ happens to be zero at the element center. By evaluating the strain energy integral using only this point, the contribution from the parasitic shear is completely ignored. This \"unlocks\" the element, making it much more flexible and accurate for bending-dominated problems. The severe stress oscillations associated with locking are drastically reduced. However, this comes at a cost. The single integration point cannot \"sense\" certain deformation modes, known as **hourglass modes** or zero-energy modes. These are spurious deformation patterns that produce no strain at the element center and thus have no associated stiffness. If excited, they can corrupt the solution with meaningless oscillations.\n\n3.  **Q4 with Incompatible Modes (Q4I)**\n    This advanced formulation enhances the element's kinematics. The standard bilinear displacement field is augmented with internal \"bubble\" functions that are zero on the element's boundary. For bending, crucial modes are of the form $(1-\\xi^2)$ and $(1-\\eta^2)$. For example, enriching $u_y$ with a mode proportional to $(1-\\xi^2)$ allows the element to represent a quadratic variation of displacement internally. This provides the necessary kinematic freedom to model pure bending curvature without inducing parasitic shear strains. Since the enrichment modes are zero at the element boundaries, $C^0$-continuity with adjacent elements is preserved. The internal parameters associated with these modes are condensed out at the element level. The element is evaluated using full $2\\times 2$ integration, which provides the correct stiffness and ensures that hourglass modes have positive strain energy and are therefore suppressed. This formulation successfully cures shear locking without introducing the instability of reduced integration, leading to a smooth and highly accurate stress solution.\n\n### Option-by-Option Analysis\n\n**A. In bending-dominated states, the standard fully integrated $Q4$ tends to produce pronounced element-to-element oscillations in $\\sigma_{xx}(y)$ because the exact quadratic-in-$x$ component of $u_y$ cannot be represented by a bilinear field, leading to parasitic shear/membrane strains and interelement stress jumps; reduced integration $Q4$ generally reduces the oscillation amplitude by under-integrating parasitic stiffness but risks hourglass modes; the $Q4$ with incompatible modes yields the smoothest and most accurate stress profile by improving the representation of curvature-induced strain gradients without introducing spurious zero-energy modes.**\nThis statement provides a complete and accurate summary. It correctly identifies the kinematic deficiency of the standard $Q4$ element as the cause of parasitic shear (shear locking) and stress oscillations. It correctly describes the trade-off of reduced integration (reduced locking at the risk of hourglassing). It also correctly describes the superior performance of the incompatible mode element, which enriches the kinematics to represent curvature accurately while using full integration to avoid spurious modes.\n**Verdict: Correct.**\n\n**B. The dominant cause of the oscillations in standard Q4 under bending is volumetric locking; therefore, as $\\nu\\to 0$ the oscillations vanish regardless of the integration rule.**\nThis statement is incorrect. The dominant locking mechanism in this problem is **shear locking**, which arises from the element's inability to model pure bending deformation. **Volumetric locking** occurs in nearly incompressible materials (when Poisson's ratio $\\nu \\to 0.5$) and is unrelated to this specific issue unless $\\nu$ is very high. Shear locking persists even for $\\nu=0$, as it is related to the shear modulus $G = E/(2(1+\\nu))$, which remains finite.\n**Verdict: Incorrect.**\n\n**C. Reduced integration completely eliminates oscillations in bending because it exactly integrates the bilinear stiffness; consequently, it cannot hourglass on a regular mesh subjected to pure bending.**\nThis statement contains multiple errors. First, reduced integration does not \"exactly integrate\" the bilinear stiffness matrix; full ($2\\times 2$) quadrature is required for exact integration of the stiffness matrix of a rectangular $Q4$ element. Reduced integration works precisely because it *inexactly* integrates the stiffness, failing to capture the parasitic shear energy. Second, while it dramatically reduces oscillations from locking, it does not \"completely eliminate\" them; the resulting element-wise constant stress profile is itself a form of oscillation (a stairstep approximation). Third, while pure bending on a perfect mesh may not excite hourglass modes, the element formulation is fundamentally susceptible to them under more general conditions. The statement misrepresents the underlying principles.\n**Verdict: Incorrect.**\n\n**D. Incompatible mode enrichment reduces oscillations by augmenting the internal strain field with bubble-like displacement modes that vanish on element edges, preserving interelement $C^0$ continuity while improving the element’s ability to represent curvature; this alleviates parasitic shear/membrane strains and does not create hourglass modes.**\nThis statement provides a precise and accurate description of the incompatible modes method. The displacement field is augmented with internal modes (functions which are zero on element boundaries, thus preserving $C^0$ continuity). This enrichment directly improves the element's ability to represent curvature. As a result, the source of parasitic shear is removed. The element employs full integration, which properly captures the energy of all deformation modes and thus does not suffer from hourglassing.\n**Verdict: Correct.**\n\n**E. If only a single element ($N_h=1$) is used across the depth $H$, then the three formulations produce essentially identical pointwise axial stresses in pure bending because they share the same boundary nodal degrees of freedom.**\nThis statement is incorrect. The three formulations have fundamentally different element stiffness matrices ($[K_e]$) due to different integration rules and/or kinematic assumptions. For a given set of applied loads, the system equations $[K][U]=[F]$ will yield different nodal displacement vectors $[U]$ for each formulation. Consequently, the stresses, computed from these displacements (e.g., $\\boldsymbol{\\sigma}=[D][B][U]$), will also be different. The very motivation for developing $Q4/1$ and $Q4I$ elements is that they produce results superior to the standard $Q4$ in bending, and this difference does not disappear simply because the mesh is coarse in one direction. The shear locking of the standard $Q4$ element is still present.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{AD}$$", "id": "2568555"}, {"introduction": "Having seen *why* incompatible modes are necessary, we now delve into *how* they work mechanically. This practice guides you through a focused calculation on a single plate element, demonstrating the core mechanism of static condensation [@problem_id:2568518]. By explicitly computing the change in bending stiffness resulting from an added incompatible mode, you will develop a concrete understanding of how these enrichments modify the element's behavior to alleviate locking and improve accuracy.", "problem": "Consider a single four-node isoparametric quadrilateral element in the Finite Element Method (FEM) for the bending of a thin plate modeled by the Mindlin–Reissner theory, occupying the unit square domain $\\Omega = [0,1] \\times [0,1]$ in the $x$–$y$ plane. Focus only on the bending part of the energy (ignore transverse shear). Let the plate’s bending constitutive matrix be taken as\n$$\n\\mathbf{D}_{b} \\;=\\; D_{0}\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\nwith the normalization $D_{0} = 1$ and $\\nu = 0$, so that $\\mathbf{D}_{b} = \\mathrm{diag}(1,\\,1,\\,\\tfrac{1}{2})$. The bending strains (curvatures) are defined in terms of the rotations $\\theta_{x}(x,y)$ and $\\theta_{y}(x,y)$ as\n$$\n\\kappa_{x} = -\\frac{\\partial \\theta_{x}}{\\partial x}, \\quad\n\\kappa_{y} = -\\frac{\\partial \\theta_{y}}{\\partial y}, \\quad\n\\kappa_{xy} = -\\frac{\\partial \\theta_{x}}{\\partial y} - \\frac{\\partial \\theta_{y}}{\\partial x}.\n$$\nLet the compatible rotations be interpolated bilinearly from nodal values, and consider the specific compatible bending mode corresponding to a uniform curvature about the $y$-axis:\n$$\n\\theta_{x}^{c}(x,y) = x, \\qquad \\theta_{y}^{c}(x,y) = 0,\n$$\nwhich is exactly representable by bilinear interpolation on $\\Omega$ by assigning nodal values equal to the $x$-coordinates for $\\theta_{x}$ and zero for $\\theta_{y}$. Augment the element with a single scalar incompatible internal mode $a \\in \\mathbb{R}$ of the form\n$$\n\\theta_{x}^{i}(x,y) = a\\,x\\,y, \\qquad \\theta_{y}^{i}(x,y) = 0,\n$$\nto be eliminated by static condensation at the element level. Denote by $\\mathbf{K}_{cc}$ the compatible (condensed) bending stiffness associated with the compatible degrees of freedom, by $\\mathbf{K}_{ii}$ the self-stiffness of the single incompatible mode, and by $\\mathbf{K}_{ci}$, $\\mathbf{K}_{ic}$ the coupling blocks. Using the bending energy functional\n$$\n\\Pi_{b}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A,\n$$\ncompute, for the above fields, the scalar quadratic form\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q,\n$$\nwhere $q$ is the compatible nodal vector that reproduces $\\theta_{x}^{c}(x,y)=x$, $\\theta_{y}^{c}(x,y)=0$. Then quantify the change in bending stiffness along this mode by the ratio\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}.\n$$\nEvaluate $r$ exactly as a real number. Express the final answer as an exact number without units. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard problem in the theory of the Finite Element Method concerning incompatible modes and static condensation. All necessary data and definitions are provided. The problem is valid and admits a unique solution. We proceed.\n\nThe task is to compute the ratio $r$, defined as:\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}\n$$\nThe terms in this expression originate from the element's bending energy functional, $\\Pi_b$. The total rotation field is a sum of a compatible part, interpolated from nodal degrees of freedom $q$, and an incompatible part, parameterized by an internal degree of freedom $a$. Let the rotation fields be $\\boldsymbol{\\theta} = (\\theta_x, \\theta_y)$. The strain vector $\\boldsymbol{\\kappa} = (\\kappa_x, \\kappa_y, \\kappa_{xy})$ is derived from $\\boldsymbol{\\theta}$ via a differential operator, which we denote $\\boldsymbol{\\kappa} = \\mathcal{L}(\\boldsymbol{\\theta})$. This relation is linear. Therefore, the total strain can be decomposed as $\\boldsymbol{\\kappa} = \\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i$, where $\\boldsymbol{\\kappa}^c = \\mathcal{L}(\\boldsymbol{\\theta}^c)$ and $\\boldsymbol{\\kappa}^i = \\mathcal{L}(\\boldsymbol{\\theta}^i)$.\n\nThe bending energy functional is given by:\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A\n$$\nSubstituting the decomposed strain, we have:\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} (\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)^{T}\\,\\mathbf{D}_{b}\\,(\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)\\, \\mathrm{d}A \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\left( (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c + 2 (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i + (\\boldsymbol{\\kappa}^i)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i \\right) \\mathrm{d}A\n$$\nThe strain fields are related to the degrees of freedom $q$ and $a$ by strain-displacement matrices $\\mathbf{B}_c$ and $\\mathbf{B}_i$ such that $\\boldsymbol{\\kappa}^c = \\mathbf{B}_c q$ and $\\boldsymbol{\\kappa}^i = \\mathbf{B}_i a$. The energy can then be written in matrix form:\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2} q^T \\mathbf{K}_{cc} q + q^T \\mathbf{K}_{ci} a + \\frac{1}{2} a^T \\mathbf{K}_{ii} a\n$$\nwhere the stiffness sub-matrices are defined by integrals over the element domain $\\Omega$:\n$\\mathbf{K}_{cc} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_c \\mathrm{d}A$, $\\mathbf{K}_{ci} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$, and $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$.\n\nThe quadratic forms in the ratio $r$ can be expressed directly in terms of the strain fields:\nThe denominator is $q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\mathbf{B}_c q)^T \\mathbf{D}_b (\\mathbf{B}_c q) \\mathrm{d}A = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$.\nFor the numerator, since $a$ is a scalar degree of freedom, $\\mathbf{K}_{ii}$ is a $1 \\times 1$ matrix (a scalar), $\\mathbf{K}_{ic}$ is a $1 \\times N$ row vector (where $N$ is the size of $q$), and $\\mathbf{K}_{ci} = \\mathbf{K}_{ic}^T$ is a $N \\times 1$ column vector. The numerator becomes:\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{(q^T \\mathbf{K}_{ci})(\\mathbf{K}_{ic} q)}{\\mathbf{K}_{ii}} = \\frac{(\\mathbf{K}_{ic}q)^2}{\\mathbf{K}_{ii}}\n$$\nwhere $\\mathbf{K}_{ic} q = \\left(\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_c \\mathrm{d}A\\right) q = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b (\\mathbf{B}_c q) \\mathrm{d}A = \\int_{\\Omega} (\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c) \\mathrm{d}A$. Also, $\\mathbf{K}_{ii}$ is the scalar integral $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$.\nThus, the numerator is:\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A \\right)^2}{\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A}\n$$\n\nWe now compute the necessary components using the provided data.\nThe domain is $\\Omega = [0,1] \\times [0,1]$.\nThe constitutive matrix is $\\mathbf{D}_{b} = \\mathrm{diag}(1, 1, \\frac{1}{2})$.\n\nFirst, determine the strain fields.\nThe compatible rotation fields are $\\theta_{x}^{c}(x,y) = x$ and $\\theta_{y}^{c}(x,y) = 0$. The corresponding compatible strains (curvatures) are:\n$$\n\\boldsymbol{\\kappa}^c = \\begin{pmatrix} -\\frac{\\partial \\theta_{x}^{c}}{\\partial x} \\\\ -\\frac{\\partial \\theta_{y}^{c}}{\\partial y} \\\\ -\\frac{\\partial \\theta_{x}^{c}}{\\partial y} - \\frac{\\partial \\theta_{y}^{c}}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\partial (x)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (x)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe incompatible rotation fields are $\\theta_{x}^{i}(x,y) = a\\,x\\,y$ and $\\theta_{y}^{i}(x,y) = 0$. The corresponding incompatible strains are:\n$$\n\\boldsymbol{\\kappa}^i = \\begin{pmatrix} -\\frac{\\partial (a\\,x\\,y)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (a\\,x\\,y)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -a\\,y \\\\ 0 \\\\ -a\\,x \\end{pmatrix} = a \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}\n$$\nFrom this, we identify the incompatible strain shape matrix $\\mathbf{B}_i = \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}$.\n\nNow, we compute the integrals.\n1. Denominator of $r$: $q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$.\nThe integrand is:\n$$\n(\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1\n$$\nThe integral is over the unit square:\n$$\nq^T \\mathbf{K}_{cc} q = \\int_{0}^{1}\\int_{0}^{1} 1\\, \\mathrm{d}x\\mathrm{d}y = 1\n$$\n\n2. Numerator of $r$: $q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q$. This requires two separate integrals.\na. The coupling integral term $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$:\nThe integrand is:\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -y & 0 & -x \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -y & 0 & -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = y\n$$\nThe integral is:\n$$\n\\int_{0}^{1}\\int_{0}^{1} y\\, \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} y \\left[ x \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} y\\, \\mathrm{d}y = \\left[ \\frac{y^2}{2} \\right]_{0}^{1} = \\frac{1}{2}\n$$\nSo, the squared term is $(\\frac{1}{2})^2 = \\frac{1}{4}$.\n\nb. The incompatible stiffness term $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$:\nThe integrand is:\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i = \\begin{pmatrix} -y & 0 & -x \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = \\begin{pmatrix} -y & 0 & -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = y^2 + \\frac{x^2}{2}\n$$\nThe integral is:\n$$\n\\mathbf{K}_{ii} = \\int_{0}^{1}\\int_{0}^{1} \\left(y^2 + \\frac{x^2}{2}\\right) \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} \\left[ y^2 x + \\frac{x^3}{6} \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} \\left(y^2 + \\frac{1}{6}\\right) \\mathrm{d}y\n$$\n$$\n\\mathbf{K}_{ii} = \\left[ \\frac{y^3}{3} + \\frac{y}{6} \\right]_{0}^{1} = \\frac{1}{3} + \\frac{1}{6} = \\frac{2}{6} + \\frac{1}{6} = \\frac{3}{6} = \\frac{1}{2}\n$$\n\nc. Assemble the numerator:\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\frac{1}{2} \\right)^2}{\\frac{1}{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}\n$$\n\n3. Finally, compute the ratio $r$:\n$$\nr = \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q} = \\frac{\\frac{1}{2}}{1} = \\frac{1}{2}\n$$\nThe ratio representing the change in bending stiffness for the given mode due to the addition of the incompatible mode is precisely $\\frac{1}{2}$. This change corresponds to a reduction in stiffness, as the effective stiffness matrix after static condensation is $\\mathbf{K}_{eff} = \\mathbf{K}_{cc} - \\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}$. This softening effect is a known consequence of such incompatible mode formulations, often introduced to alleviate locking phenomena.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2568518"}, {"introduction": "Moving from theory to practice, this final exercise addresses a critical aspect of implementing robust finite elements for real-world engineering analysis. In practical meshes, elements are often distorted, which can lead to numerical issues for advanced formulations. This problem directs you to numerically investigate the sensitivity of the internal stiffness matrix's conditioning to the element's aspect ratio, and to test a scaling strategy designed to ensure the element remains accurate and stable regardless of its shape [@problem_id:2568531].", "problem": "You are given a rectangular, isoparametric, four-node quadrilateral finite element in two-dimensional linear elasticity under plane strain. Consider an Enhanced Assumed Strain (EAS) incompatible-mode enrichment with $2$ internal strain parameters collected in the vector $\\boldsymbol{\\alpha} = [\\alpha_{x}, \\alpha_{y}]^{\\mathsf{T}}$. The incompatible strain field is assumed directly in physical coordinates $(x,y)$ as\n$$\n\\boldsymbol{\\varepsilon}^{\\text{inc}}(x,y) \\;=\\; \\mathbf{H}(x,y)\\,\\boldsymbol{\\alpha}, \\qquad \n\\mathbf{H}(x,y) \\;=\\; \n\\begin{bmatrix}\nx & 0 \\\\\n0 & y \\\\\n0 & 0\n\\end{bmatrix},\n$$\nso that $\\varepsilon_{xx}^{\\text{inc}} = \\alpha_{x}\\,x$, $\\varepsilon_{yy}^{\\text{inc}} = \\alpha_{y}\\,y$, and $\\gamma_{xy}^{\\text{inc}} = 0$.\n\nLet the element occupy the rectangle $[-a/2,\\,a/2] \\times [-b/2,\\,b/2]$ in physical coordinates, with side lengths $a>0$ and $b>0$ and aspect ratio $r = a/b$. The linear elastic constitutive matrix for plane strain is\n$$\n\\mathbf{D} \\;=\\; \n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & 2\\mu\n\\end{bmatrix}, \\qquad\n\\lambda \\;=\\; \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}, \\quad\n\\mu \\;=\\; \\dfrac{E}{2(1+\\nu)},\n$$\nwhere $E>0$ is the Young’s modulus and $\\nu \\in (0,\\,0.5)$ is the Poisson’s ratio. The incompatible-mode internal stiffness submatrix $\\mathbf{K}_{ii} \\in \\mathbb{R}^{2\\times 2}$ is defined by the strain energy of the incompatible modes:\n$$\n\\mathbf{K}_{ii} \\;=\\; \\int_{\\Omega_e} \\mathbf{H}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\mathbf{H}(x,y) \\,\\mathrm{d}A,\n$$\nwith $\\Omega_e$ the element domain in physical coordinates. Assume thickness equal to $1$ so that $\\mathrm{d}A$ is area measure, and all quantities are unit-consistent; the requested condition numbers are therefore unitless and must be reported as pure numbers without any unit.\n\nTo mitigate ill-conditioning with large aspect ratios, consider a length-based scaled variant of the incompatible strain mapping,\n$$\n\\widetilde{\\mathbf{H}}(x,y) \\;=\\; \n\\begin{bmatrix}\n\\dfrac{x}{a} & 0 \\\\\n0 & \\dfrac{y}{b} \\\\\n0 & 0\n\\end{bmatrix},\n\\qquad\n\\widetilde{\\mathbf{K}}_{ii} \\;=\\; \\int_{\\Omega_e} \\widetilde{\\mathbf{H}}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\widetilde{\\mathbf{H}}(x,y) \\,\\mathrm{d}A,\n$$\nwhich corresponds to scaling the internal parameters by characteristic element lengths in each direction. The numerical task is to evaluate the sensitivity of the conditioning of $\\mathbf{K}_{ii}$ to the aspect ratio and to assess the effectiveness of the above scaling.\n\nStarting from the total elastic energy functional and the definition of the Enhanced Assumed Strain incompatible modes, derive the expressions needed to numerically evaluate $\\mathbf{K}_{ii}$ and its condition number. Then implement a program that uses tensor-product Gauss–Legendre quadrature on the parent square $[-1,1]\\times[-1,1]$ with the isoparametric mapping\n$$\nx = \\dfrac{a}{2}\\,\\xi, \\qquad y = \\dfrac{b}{2}\\,\\eta, \\qquad \\mathrm{d}A = \\dfrac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nto compute the following for each test case:\n- the spectral condition number $\\kappa(\\mathbf{K}_{ii})$ of the unscaled matrix, and\n- the spectral condition number $\\kappa(\\widetilde{\\mathbf{K}}_{ii})$ of the length-scaled matrix.\n\nYour program must implement the following steps from first principles:\n- construct $\\mathbf{D}$ from $(E,\\nu)$,\n- assemble $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$ via numerical quadrature of the given integrals, and\n- compute the spectral condition number using the matrix $2$-norm.\n\nUse the following test suite of element and material parameters $(a,b,E,\\nu)$:\n- Case $1$: $(a,b,E,\\nu) = (\\,1,\\,1,\\,1,\\,0.3\\,)$,\n- Case $2$: $(a,b,E,\\nu) = (\\,10,\\,1,\\,1,\\,0.3\\,)$,\n- Case $3$: $(a,b,E,\\nu) = (\\,1,\\,10,\\,1,\\,0.3\\,)$,\n- Case $4$: $(a,b,E,\\nu) = (\\,10^{-3},\\,1,\\,1,\\,0.3\\,)$,\n- Case $5$: $(a,b,E,\\nu) = (\\,4,\\,1,\\,1,\\,0.4999\\,)$.\n\nAll outputs must be unitless real numbers. For each case, return a pair $[\\kappa(\\mathbf{K}_{ii}),\\,\\kappa(\\widetilde{\\mathbf{K}}_{ii})]$ as floating-point numbers.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing a comma-separated list of the pair results for all cases, enclosed in square brackets. For example, the conceptual format is $[\\,[\\kappa_{1}^{\\text{un}},\\kappa_{1}^{\\text{sc}}],\\,[\\kappa_{2}^{\\text{un}},\\kappa_{2}^{\\text{sc}}],\\,\\dots\\,]$.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Element Definition**: Rectangular, isoparametric, four-node quadrilateral finite element in two-dimensional linear elasticity under plane strain.\n- **Domain**: $\\Omega_e = [-a/2, a/2] \\times [-b/2, b/2]$ with $a > 0$, $b > 0$.\n- **Incompatible Modes**: An Enhanced Assumed Strain (EAS) enrichment with $2$ internal parameters $\\boldsymbol{\\alpha} = [\\alpha_{x}, \\alpha_{y}]^{\\mathsf{T}}$.\n- **Unscaled Incompatible Strain Mapping**: $\\boldsymbol{\\varepsilon}^{\\text{inc}}(x,y) = \\mathbf{H}(x,y)\\,\\boldsymbol{\\alpha}$, with $\\mathbf{H}(x,y) = \\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}$.\n- **Length-Scaled Incompatible Strain Mapping**: $\\widetilde{\\boldsymbol{\\varepsilon}}^{\\text{inc}}(x,y) = \\widetilde{\\mathbf{H}}(x,y)\\,\\boldsymbol{\\alpha}$, with $\\widetilde{\\mathbf{H}}(x,y) = \\begin{bmatrix} x/a & 0 \\\\ 0 & y/b \\\\ 0 & 0 \\end{bmatrix}$.\n- **Constitutive Matrix (Plane Strain)**: $\\mathbf{D} = \\begin{bmatrix} \\lambda + 2\\mu & \\lambda & 0 \\\\ \\lambda & \\lambda + 2\\mu & 0 \\\\ 0 & 0 & 2\\mu \\end{bmatrix}$, where $\\lambda = \\frac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\frac{E}{2(1+\\nu)}$. $E>0$, $\\nu \\in (0, 0.5)$.\n- **Internal Stiffness Matrices**:\n  - Unscaled: $\\mathbf{K}_{ii} = \\int_{\\Omega_e} \\mathbf{H}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\mathbf{H}(x,y) \\,\\mathrm{d}A$.\n  - Scaled: $\\widetilde{\\mathbf{K}}_{ii} = \\int_{\\Omega_e} \\widetilde{\\mathbf{H}}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\widetilde{\\mathbf{H}}(x,y) \\,\\mathrm{d}A$.\n- **Isoparametric Mapping**: $x = \\frac{a}{2}\\,\\xi$, $y = \\frac{b}{2}\\,\\eta$ for $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$. The area differential is $\\mathrm{d}A = \\frac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\n- **Numerical Method**: Tensor-product Gauss–Legendre quadrature on the parent element.\n- **Task**: For each test case, compute the spectral condition numbers $\\kappa(\\mathbf{K}_{ii})$ and $\\kappa(\\widetilde{\\mathbf{K}}_{ii})$.\n- **Test Cases**: $(a,b,E,\\nu)$\n  1. $(1, 1, 1, 0.3)$\n  2. $(10, 1, 1, 0.3)$\n  3. $(1, 10, 1, 0.3)$\n  4. $(10^{-3}, 1, 1, 0.3)$\n  5. $(4, 1, 1, 0.4999)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is formulated within the standard theory of the Finite Element Method, specifically using the Enhanced Assumed Strain (EAS) concept for linear elasticity. All provided equations are correct representations of established principles.\n- **Well-Posed**: The problem is well-posed. The integrals for the stiffness matrices $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$ are defined over a simple rectangular domain with polynomial integrands, ensuring they are well-defined and computable. The material parameters are in valid physical ranges. The task is specific and leads to a unique numerical result.\n- **Objective**: The problem is stated using precise, objective, and standard scientific terminology. There are no subjective or ambiguous statements.\n\nThe problem contains no scientific or factual unsoundness, is formalizable, self-contained, physically plausible, and well-structured.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n---\n\nThe task is to compute the spectral condition numbers of two internal stiffness matrices, $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$, associated with an incompatible-mode formulation. The derivation must originate from first principles and the computation must be performed using numerical quadrature as specified.\n\nFirst, we derive the integrands for the stiffness matrices. The unscaled shape matrix for incompatible strains is $\\mathbf{H}(x,y) = \\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}$. The constitutive matrix is $\\mathbf{D}$. The integrand for $\\mathbf{K}_{ii}$ is the $2 \\times 2$ matrix $\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H}$.\n$$\n\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H} =\n\\begin{bmatrix} x & 0 & 0 \\\\ 0 & y & 0 \\end{bmatrix}\n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & 2\\mu\n\\end{bmatrix}\n\\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}\n=\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2 & \\lambda xy \\\\ \\lambda xy & (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n$$\nThe matrix $\\mathbf{K}_{ii}$ is obtained by integrating this expression over the element domain $\\Omega_e = [-a/2, a/2] \\times [-b/2, b/2]$.\n$$\n\\mathbf{K}_{ii} = \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2}\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2 & \\lambda xy \\\\ \\lambda xy & (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\nDue to the symmetry of the integration domain about the origin, the integrals of the off-diagonal terms, which are odd functions ($xy$), evaluate to zero.\n$$\n\\int_{-a/2}^{a/2} x \\,\\mathrm{d}x = 0, \\quad \\int_{-b/2}^{b/2} y \\,\\mathrm{d}y = 0 \\quad \\implies \\quad \\int_{\\Omega_e} xy \\,\\mathrm{d}A = 0\n$$\nThe diagonal terms are computed as:\n$$\n(\\mathbf{K}_{ii})_{11} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} x^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( b \\right) \\left( \\frac{x^3}{3} \\right)\\bigg|_{-a/2}^{a/2} = (\\lambda + 2\\mu) \\frac{a^3b}{12}\n$$\n$$\n(\\mathbf{K}_{ii})_{22} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} y^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( a \\right) \\left( \\frac{y^3}{3} \\right)\\bigg|_{-b/2}^{b/2} = (\\lambda + 2\\mu) \\frac{ab^3}{12}\n$$\nThus, the unscaled internal stiffness matrix is diagonal:\n$$\n\\mathbf{K}_{ii} = \\frac{\\lambda + 2\\mu}{12}\n\\begin{bmatrix} a^3b & 0 \\\\ 0 & ab^3 \\end{bmatrix}\n$$\nThe spectral condition number $\\kappa(\\mathbf{K}_{ii})$ is the ratio of the largest to the smallest eigenvalue. For a positive definite diagonal matrix, this is the ratio of the maximum to the minimum diagonal entry.\n$$\n\\kappa(\\mathbf{K}_{ii}) = \\frac{\\max(a^3b, ab^3)}{\\min(a^3b, ab^3)} = \\frac{\\max(a^2, b^2)}{\\min(a^2, b^2)} = \\left( \\frac{\\max(a, b)}{\\min(a, b)} \\right)^2 = \\max\\left( \\frac{a^2}{b^2}, \\frac{b^2}{a^2} \\right)\n$$\nIf we define the aspect ratio $r = a/b$, then $\\kappa(\\mathbf{K}_{ii}) = \\max(r^2, 1/r^2)$. This directly shows the sensitivity of the conditioning to the element aspect ratio.\n\nNext, we analyze the length-scaled formulation. The scaled shape matrix is $\\widetilde{\\mathbf{H}}(x,y) = \\begin{bmatrix} x/a & 0 \\\\ 0 & y/b \\\\ 0 & 0 \\end{bmatrix}$. The integrand is $\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}}$. Following the same procedure, we replace $x$ with $x/a$ and $y$ with $y/b$ in the integrand expression.\n$$\n\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}} =\n\\begin{bmatrix} (\\lambda + 2\\mu)(x/a)^2 & \\lambda (x/a)(y/b) \\\\ \\lambda (x/a)(y/b) & (\\lambda + 2\\mu)(y/b)^2 \\end{bmatrix}\n$$\nIntegrating over $\\Omega_e$:\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{11} = \\frac{\\lambda + 2\\mu}{a^2} \\int_{\\Omega_e} x^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{a^2} \\frac{a^3b}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{22} = \\frac{\\lambda + 2\\mu}{b^2} \\int_{\\Omega_e} y^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{b^2} \\frac{ab^3}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\nThe off-diagonal terms are again zero. The resulting scaled matrix is:\n$$\n\\widetilde{\\mathbf{K}}_{ii} = (\\lambda + 2\\mu) \\frac{ab}{12}\n\\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}\n$$\nThis is a multiple of the identity matrix. The condition number of any non-zero multiple of the identity matrix is identically $1$.\n$$\n\\kappa(\\widetilde{\\mathbf{K}}_{ii}) = 1\n$$\nThis analytical derivation confirms that the length scaling eliminates the dependency of the internal stiffness matrix conditioning on the element aspect ratio. Notably, the material parameters $E$ and $\\nu$ do not influence the condition numbers in either case, as they appear as a common scaling factor on the diagonal entries.\n\nFor the numerical implementation, we use a tensor-product Gauss-Legendre quadrature. The transformation from the parent element $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ to the physical element is $x = \\frac{a}{2}\\xi$ and $y = \\frac{b}{2}\\eta$. The differential area is $\\mathrm{d}A = \\det(\\mathbf{J})\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta = \\frac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\nThe integral for any component of $\\mathbf{K}_{ii}$ or $\\widetilde{\\mathbf{K}}_{ii}$ takes the form:\n$$\n\\int_{\\Omega_e} f(x,y) \\,\\mathrm{d}A = \\int_{-1}^{1} \\int_{-1}^{1} f\\left(\\frac{a}{2}\\xi, \\frac{b}{2}\\eta\\right) \\frac{ab}{4} \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta \\approx \\frac{ab}{4} \\sum_{i=1}^{N_p} \\sum_{j=1}^{N_p} w_i w_j f\\left(\\frac{a}{2}\\xi_i, \\frac{b}{2}\\eta_j\\right)\n$$\nwhere $(\\xi_i, w_i)$ and $(\\eta_j, w_j)$ are the Gauss points and weights, and $N_p$ is the number of points in one dimension. The integrands are polynomials in $x$ and $y$ of degree at most $2$. After mapping to the parent element, they become polynomials in $\\xi$ and $\\eta$ of the same degree. A $2$-point Gauss rule ($N_p=2$) integrates polynomials of degree up to $2 \\times 2 - 1 = 3$ exactly. Thus, a $2 \\times 2$ tensor-product quadrature rule is sufficient for an exact evaluation of the integrals.\n\nThe implementation will construct the constitutive matrix $\\mathbf{D}$, perform the numerical integration for $\\mathbf{K}_{ii}$ and $\\widetilde{\\mathbf{K}}_{ii}$ using a $2 \\times 2$ Gauss quadrature for each test case, and then compute their spectral condition numbers.", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Solves the finite element problem for all specified test cases.\n    \"\"\"\n    \n    # Test suite of element and material parameters (a, b, E, nu).\n    test_cases = [\n        # Case 1: Square element, standard material.\n        (1.0, 1.0, 1.0, 0.3),\n        # Case 2: High aspect ratio (a > b).\n        (10.0, 1.0, 1.0, 0.3),\n        # Case 3: High aspect ratio (b > a).\n        (1.0, 10.0, 1.0, 0.3),\n        # Case 4: Extreme aspect ratio (a << b).\n        (1e-3, 1.0, 1.0, 0.3),\n        # Case 5: High aspect ratio, near-incompressible material.\n        (4.0, 1.0, 1.0, 0.4999),\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa_pair = compute_condition_numbers(*case)\n        results.append(kappa_pair)\n\n    # Format the final output as a comma-separated list of lists.\n    # str([a, b]) produces '[a, b]'. join combines these strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_condition_numbers(a: float, b: float, E: float, nu: float):\n    \"\"\"\n    Computes the spectral condition numbers for K_ii and tilde(K)_ii.\n    \n    Args:\n        a: Length of the element in the x-direction.\n        b: Length of the element in the y-direction.\n        E: Young's modulus.\n        nu: Poisson's ratio.\n        \n    Returns:\n        A list containing the condition numbers [kappa(K_ii), kappa(tilde(K)_ii)].\n    \"\"\"\n    \n    # 1. Construct the plane strain constitutive matrix D.\n    # Lamé parameters\n    lmbda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n    mu = E / (2 * (1 + nu))\n    \n    D = np.array([\n        [lmbda + 2 * mu, lmbda,         0],\n        [lmbda,         lmbda + 2 * mu, 0],\n        [0,             0,             2 * mu]\n    ])\n    \n    # 2. Set up tensor-product Gauss-Legendre quadrature.\n    # A 2-point rule is exact for the polynomial integrands.\n    n_gauss_points = 2\n    gauss_points, gauss_weights = roots_legendre(n_gauss_points)\n    \n    # Isoparametric mapping Jacobian determinant (constant for a rectangle).\n    det_J = (a * b) / 4.0\n    \n    # 3. Assemble K_ii (unscaled) and tilde(K)_ii (scaled).\n    K_ii = np.zeros((2, 2))\n    tilde_K_ii = np.zeros((2, 2))\n    \n    for i in range(n_gauss_points):\n        for j in range(n_gauss_points):\n            xi = gauss_points[i]\n            eta = gauss_points[j]\n            w_i = gauss_weights[i]\n            w_j = gauss_weights[j]\n            \n            # Map from parent to physical coordinates.\n            x = (a / 2.0) * xi\n            y = (b / 2.0) * eta\n            \n            # --- Unscaled version ---\n            # H matrix: epsilon_inc = H * alpha\n            H = np.array([\n                [x,   0.0],\n                [0.0,   y],\n                [0.0, 0.0]\n            ])\n            \n            # Integrand for K_ii\n            integrand_K = H.T @ D @ H\n            K_ii += integrand_K * w_i * w_j * det_J\n\n            # --- Scaled version ---\n            # tilde(H) matrix\n            tilde_H = np.array([\n                [x / a, 0.0],\n                [0.0, y / b],\n                [0.0, 0.0]\n            ])\n\n            # Integrand for tilde(K)_ii\n            integrand_tilde_K = tilde_H.T @ D @ tilde_H\n            tilde_K_ii += integrand_tilde_K * w_i * w_j * det_J\n\n    # 4. Compute spectral condition numbers (using 2-norm).\n    kappa_K_ii = np.linalg.cond(K_ii, 2)\n    kappa_tilde_K_ii = np.linalg.cond(tilde_K_ii, 2)\n    \n    return [kappa_K_ii, kappa_tilde_K_ii]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2568531"}]}