{"hands_on_practices": [{"introduction": "The strain-displacement matrix, denoted as the $B$-matrix, forms the core of any structural finite element by linking the discrete nodal degrees of freedom to the continuous strain field within the element. This foundational exercise guides you through the derivation of the $B$-matrix for a linear wedge element, a process that is central to computing the element stiffness matrix. Mastering this derivation provides essential practice in applying the chain rule and the isoparametric mapping concept, which are fundamental skills in finite element analysis [@problem_id:2611736].", "problem": "Consider the isoparametric linear wedge (triangular prism) finite element used in $3$-dimensional small-strain elasticity within the Finite Element Method (FEM). Let the natural coordinates be $(\\xi,\\eta,\\zeta)$, where $(\\xi,\\eta)$ are coordinates on the reference triangle with $\\xi \\ge 0$, $\\eta \\ge 0$, $\\xi+\\eta \\le 1$, and $\\zeta \\in [-1,1]$ is the thickness coordinate. Define the linear wedge shape functions using the triangle barycentric coordinates $L_1=1-\\xi-\\eta$, $L_2=\\xi$, $L_3=\\eta$ as\n$$\nN_1 = L_1 \\frac{1-\\zeta}{2},\\quad\nN_2 = L_2 \\frac{1-\\zeta}{2},\\quad\nN_3 = L_3 \\frac{1-\\zeta}{2},\\quad\nN_4 = L_1 \\frac{1+\\zeta}{2},\\quad\nN_5 = L_2 \\frac{1+\\zeta}{2},\\quad\nN_6 = L_3 \\frac{1+\\zeta}{2}.\n$$\nThe physical (Cartesian) node coordinates are given as\n- Node $1$: $(x_1,y_1,z_1)=(0,0,0)$,\n- Node $2$: $(x_2,y_2,z_2)=(1,0,0)$,\n- Node $3$: $(x_3,y_3,z_3)=(0,1,0)$,\n- Node $4$: $(x_4,y_4,z_4)=(0,0,1)$,\n- Node $5$: $(x_5,y_5,z_5)=(1,0,1)$,\n- Node $6$: $(x_6,y_6,z_6)=(0,1,1)$.\n\nTasks:\n1) Starting only from the above shape function definitions and the isoparametric mapping $x(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i x_i$, $y(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i y_i$, $z(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i z_i$, compute the natural-coordinate derivatives $\\partial N_i/\\partial \\xi$, $\\partial N_i/\\partial \\eta$, and $\\partial N_i/\\partial \\zeta$ for all $i \\in \\{1,\\dots,6\\}$.\n2) Using the definition of the small-strain tensor $\\varepsilon=\\tfrac{1}{2}(\\nabla \\mathbf{u}+(\\nabla \\mathbf{u})^{\\top})$ and the chain rule relating derivatives with respect to $(x,y,z)$ and $(\\xi,\\eta,\\zeta)$ via the Jacobian of the isoparametric map, assemble the element kinematic matrix $B(\\xi,\\eta,\\zeta)$ such that $\\boldsymbol{\\varepsilon} = B \\mathbf{d}$, where the nodal displacement vector is ordered as $\\mathbf{d}=[u_1\\ v_1\\ w_1\\ u_2\\ v_2\\ w_2\\ u_3\\ v_3\\ w_3\\ u_4\\ v_4\\ w_4\\ u_5\\ v_5\\ w_5\\ u_6\\ v_6\\ w_6]^{\\top}$ and the engineering strain vector is ordered as $[\\varepsilon_{xx}\\ \\varepsilon_{yy}\\ \\varepsilon_{zz}\\ \\gamma_{xy}\\ \\gamma_{yz}\\ \\gamma_{zx}]^{\\top}$.\n\nProvide your final answer as the single compact analytic expression of the $6 \\times 18$ matrix $B(\\xi,\\eta,\\zeta)$ in terms of $\\xi$, $\\eta$, and $\\zeta$. No numerical rounding is required. Do not include units in the final answer.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extraction of Givens**\n- Element Type: Isoparametric linear wedge (triangular prism) finite element.\n- Physics: $3$-dimensional small-strain elasticity.\n- Natural Coordinates: $(\\xi, \\eta, \\zeta)$, with $\\xi \\ge 0$, $\\eta \\ge 0$, $\\xi+\\eta \\le 1$, and $\\zeta \\in [-1,1]$.\n- Triangular Barycentric Coordinates: $L_1=1-\\xi-\\eta$, $L_2=\\xi$, $L_3=\\eta$.\n- Shape Functions:\n$$\n\\begin{aligned}\nN_1 = L_1 \\frac{1-\\zeta}{2} = (1 - \\xi - \\eta) \\frac{1-\\zeta}{2} \\\\\nN_2 = L_2 \\frac{1-\\zeta}{2} = \\xi \\frac{1-\\zeta}{2} \\\\\nN_3 = L_3 \\frac{1-\\zeta}{2} = \\eta \\frac{1-\\zeta}{2} \\\\\nN_4 = L_1 \\frac{1+\\zeta}{2} = (1 - \\xi - \\eta) \\frac{1+\\zeta}{2} \\\\\nN_5 = L_2 \\frac{1+\\zeta}{2} = \\xi \\frac{1+\\zeta}{2} \\\\\nN_6 = L_3 \\frac{1+\\zeta}{2} = \\eta \\frac{1+\\zeta}{2}\n\\end{aligned}\n$$\n- Physical Node Coordinates:\n  - Node $1$: $(0,0,0)$\n  - Node $2$: $(1,0,0)$\n  - Node $3$: $(0,1,0)$\n  - Node $4$: $(0,0,1)$\n  - Node $5$: $(1,0,1)$\n  - Node $6$: $(0,1,1)$\n- Isoparametric Mapping: $x(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i x_i$, $y(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i y_i$, $z(\\xi,\\eta,\\zeta)=\\sum_{i=1}^{6} N_i z_i$.\n- Strain Definition: Small-strain tensor $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}(\\nabla \\mathbf{u}+(\\nabla \\mathbf{u})^{\\top})$.\n- Required Relation: $\\boldsymbol{\\varepsilon} = B \\mathbf{d}$, where $\\mathbf{d}$ is the nodal displacement vector $[u_1, v_1, w_1, \\dots, u_6, v_6, w_6]^{\\top}$ and $\\boldsymbol{\\varepsilon}$ is the engineering strain vector $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx}]^{\\top}$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard, canonical problem in the theory of the Finite Element Method. All definitions, data, and conditions are standard, complete, and consistent. The specified nodal coordinates define a non-degenerate element geometry, ensuring the existence of a unique, stable, and meaningful solution. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict**\nThe problem is **valid**. A solution will be derived.\n\n**Solution Derivation**\n\nThe engineering strain vector $\\boldsymbol{\\varepsilon}$ is defined in terms of the spatial derivatives of the displacement field $\\mathbf{u} = (u,v,w)$:\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\varepsilon_{zz} \\\\ \\gamma_{xy} \\\\ \\gamma_{yz} \\\\ \\gamma_{zx} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial u}{\\partial x} \\\\ \\frac{\\partial v}{\\partial y} \\\\ \\frac{\\partial w}{\\partial z} \\\\ \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\\\ \\frac{\\partial v}{\\partial z} + \\frac{\\partial w}{\\partial y} \\\\ \\frac{\\partial w}{\\partial x} + \\frac{\\partial u}{\\partial z} \\end{pmatrix}\n$$\nThe displacement field is interpolated from the nodal displacements $\\mathbf{d}$ using the shape functions $N_i$:\n$$\nu = \\sum_{i=1}^{6} N_i u_i, \\quad v = \\sum_{i=1}^{6} N_i v_i, \\quad w = \\sum_{i=1}^{6} N_i w_i\n$$\nSubstituting these into the strain definition yields the relation $\\boldsymbol{\\varepsilon} = B \\mathbf{d}$, where $B$ is the $6 \\times 18$ strain-displacement matrix. The matrix $B$ is constructed by partitioning it into $6$ blocks, $B = [B_1, B_2, B_3, B_4, B_5, B_6]$, where each $B_i$ is a $6 \\times 3$ matrix associated with node $i$:\n$$\nB_i = \\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x}  0  0 \\\\\n0  \\frac{\\partial N_i}{\\partial y}  0 \\\\\n0  0  \\frac{\\partial N_i}{\\partial z} \\\\\n\\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_i}{\\partial z}  \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial z}  0  \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n$$\nTo construct $B_i$, we require the derivatives of the shape functions with respect to the physical coordinates $(x,y,z)$. These are obtained from the derivatives with respect to the natural coordinates $(\\xi, \\eta, \\zeta)$ via the chain rule:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\eta} \\\\ \\frac{\\partial x}{\\partial \\zeta}  \\frac{\\partial y}{\\partial \\zeta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{pmatrix} = J \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{pmatrix}\n$$\nwhere $J$ is the Jacobian matrix of the isoparametric mapping. The required physical derivatives are then given by:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{pmatrix}\n$$\nFirst, we compute the derivatives of the shape functions with respect to natural coordinates:\n$$\n\\begin{array}{lll}\n\\frac{\\partial N_1}{\\partial \\xi}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_1}{\\partial \\eta}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_1}{\\partial \\zeta}=-\\frac{1-\\xi-\\eta}{2} \\\\\n\\frac{\\partial N_2}{\\partial \\xi}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_2}{\\partial \\eta}=0  \\frac{\\partial N_2}{\\partial \\zeta}=-\\frac{\\xi}{2} \\\\\n\\frac{\\partial N_3}{\\partial \\xi}=0  \\frac{\\partial N_3}{\\partial \\eta}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_3}{\\partial \\zeta}=-\\frac{\\eta}{2} \\\\\n\\frac{\\partial N_4}{\\partial \\xi}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_4}{\\partial \\eta}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_4}{\\partial \\zeta}=\\frac{1-\\xi-\\eta}{2} \\\\\n\\frac{\\partial N_5}{\\partial \\xi}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_5}{\\partial \\eta}=0  \\frac{\\partial N_5}{\\partial \\zeta}=\\frac{\\xi}{2} \\\\\n\\frac{\\partial N_6}{\\partial \\xi}=0  \\frac{\\partial N_6}{\\partial \\eta}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_6}{\\partial \\zeta}=\\frac{\\eta}{2}\n\\end{array}\n$$\nNext, we compute the Jacobian matrix $J$. The components are $J_{kl} = \\frac{\\partial x_k}{\\partial \\xi_l} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi_l} x_{i,k}$, where $(x_1, x_2, x_3)=(x,y,z)$ and $(\\xi_1, \\xi_2, \\xi_3)=(\\xi,\\eta,\\zeta)$.\nFor this specific geometry, the mapping is:\n$x = \\sum N_i x_i = N_2(1) + N_5(1) = \\xi\\frac{1-\\zeta}{2} + \\xi\\frac{1+\\zeta}{2} = \\xi$\n$y = \\sum N_i y_i = N_3(1) + N_6(1) = \\eta\\frac{1-\\zeta}{2} + \\eta\\frac{1+\\zeta}{2} = \\eta$\n$z = \\sum N_i z_i = N_4(1) + N_5(1) + N_6(1) = (1-\\xi-\\eta+\\xi+\\eta)\\frac{1+\\zeta}{2} = \\frac{1+\\zeta}{2}$\nThe Jacobian matrix is therefore:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\eta} \\\\ \\frac{\\partial x}{\\partial \\zeta}  \\frac{\\partial y}{\\partial \\zeta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}\n$$\nThe inverse Jacobian is:\n$$\nJ^{-1} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  2 \\end{pmatrix}\n$$\nNow we find the physical derivatives of $N_i$:\n$\\frac{\\partial N_i}{\\partial x} = \\frac{\\partial N_i}{\\partial \\xi}$, $\\frac{\\partial N_i}{\\partial y} = \\frac{\\partial N_i}{\\partial \\eta}$, and $\\frac{\\partial N_i}{\\partial z} = 2\\frac{\\partial N_i}{\\partial \\zeta}$.\n$$\n\\begin{array}{lll}\n\\frac{\\partial N_1}{\\partial x}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_1}{\\partial y}=-\\frac{1-\\zeta}{2}  \\frac{\\partial N_1}{\\partial z}=-(1-\\xi-\\eta) \\\\\n\\frac{\\partial N_2}{\\partial x}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_2}{\\partial y}=0  \\frac{\\partial N_2}{\\partial z}=-\\xi \\\\\n\\frac{\\partial N_3}{\\partial x}=0  \\frac{\\partial N_3}{\\partial y}=\\frac{1-\\zeta}{2}  \\frac{\\partial N_3}{\\partial z}=-\\eta \\\\\n\\frac{\\partial N_4}{\\partial x}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_4}{\\partial y}=-\\frac{1+\\zeta}{2}  \\frac{\\partial N_4}{\\partial z}=1-\\xi-\\eta \\\\\n\\frac{\\partial N_5}{\\partial x}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_5}{\\partial y}=0  \\frac{\\partial N_5}{\\partial z}=\\xi \\\\\n\\frac{\\partial N_6}{\\partial x}=0  \\frac{\\partial N_6}{\\partial y}=\\frac{1+\\zeta}{2}  \\frac{\\partial N_6}{\\partial z}=\\eta\n\\end{array}\n$$\nFinally, we assemble the $B$ matrix. The columns are grouped by node number $(1 \\dots 6)$, with each node having three columns for its $(u,v,w)$ displacements.\n$$\nB(\\xi,\\eta,\\zeta) = [B_1 \\ B_2 \\ B_3 \\ B_4 \\ B_5 \\ B_6]\n$$\nSubstituting the derivatives yields the final expression for the $B$ matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1-\\zeta}{2}  0  0  \\frac{1-\\zeta}{2}  0  0  0  0  0  -\\frac{1+\\zeta}{2}  0  0  \\frac{1+\\zeta}{2}  0  0  0  0  0 \\\\\n0  -\\frac{1-\\zeta}{2}  0  0  0  0  0  \\frac{1-\\zeta}{2}  0  0  -\\frac{1+\\zeta}{2}  0  0  0  0  0  \\frac{1+\\zeta}{2}  0 \\\\\n0  0  -(1-\\xi-\\eta)  0  0  -\\xi  0  0  -\\eta  0  0  1-\\xi-\\eta  0  0  \\xi  0  0  \\eta \\\\\n-\\frac{1-\\zeta}{2}  -\\frac{1-\\zeta}{2}  0  0  \\frac{1-\\zeta}{2}  0  \\frac{1-\\zeta}{2}  0  0  -\\frac{1+\\zeta}{2}  -\\frac{1+\\zeta}{2}  0  0  \\frac{1+\\zeta}{2}  0  \\frac{1+\\zeta}{2}  0  0 \\\\\n0  -(1-\\xi-\\eta)  -\\frac{1-\\zeta}{2}  0  -\\xi  0  0  -\\eta  \\frac{1-\\zeta}{2}  0  1-\\xi-\\eta  -\\frac{1+\\zeta}{2}  0  \\xi  0  0  \\eta  \\frac{1+\\zeta}{2} \\\\\n-(1-\\xi-\\eta)  0  -\\frac{1-\\zeta}{2}  -\\xi  0  \\frac{1-\\zeta}{2}  -\\eta  0  0  1-\\xi-\\eta  0  -\\frac{1+\\zeta}{2}  \\xi  0  \\frac{1+\\zeta}{2}  \\eta  0  0\n\\end{pmatrix}\n}\n$$", "id": "2611736"}, {"introduction": "Pyramid elements play a specialized but vital role in finite element meshing, often serving as a flexible transition between regions of hexahedral and tetrahedral elements. This practice explores the elegant mathematical properties of pyramid shape functions under geometric degeneration, specifically when one of its base edges collapses to a point. By deriving the limiting form of the shape functions as the pyramid transforms into a tetrahedron, you will gain a deeper, more intuitive understanding of the isoparametric concept and the inherent connections between different element families [@problem_id:2611714].", "problem": "Consider the standard five-node linear pyramid element used in the Finite Element Method (FEM), with natural coordinates given by the triplet $(\\xi,\\eta,\\zeta)$. Let the apex be at $\\zeta=1$, and the base be at $\\zeta=0$. Define the scaled cross-section coordinates $\\alpha$ and $\\beta$ by $\\alpha = \\xi/(1-\\zeta)$ and $\\beta = \\eta/(1-\\zeta)$, so that for each fixed $\\zeta \\in [0,1)$, the in-plane domain is the square $-1 \\le \\alpha,\\beta \\le 1$, and the lateral faces are triangles. The shape functions are required to satisfy the Kronecker-delta property at the nodes, the partition of unity, linear variation along each edge, and linear variation over each triangular face, consistent with isoparametric interpolation.\n\nNumber the base nodes at $\\zeta=0$ as follows in terms of $(\\alpha,\\beta)$: node $1$ at $(-1,-1)$, node $2$ at $(+1,-1)$, node $3$ at $(+1,+1)$, node $4$ at $(-1,+1)$, and apex node $5$ at $\\zeta=1$.\n\nNow consider a geometric degeneration in which the physical base edge between nodes $1$ and $2$ shrinks so that the two nodes coalesce in physical space. In the limit, the pyramid degenerates to a four-node tetrahedron whose vertices are the merged base node $\\{1,2\\}$, nodes $3$ and $4$ on the base, and the apex node $5$. Using the above fundamental requirements on the shape functions and the isoparametric viewpoint, derive the limiting shape functions for this tetrahedral limit and express them as functions of $(\\xi,\\eta,\\zeta)$. Present your final result as the row vector $\\big[N_{\\{1,2\\}}^{\\mathrm{lim}},\\,N_{3}^{\\mathrm{lim}},\\,N_{4}^{\\mathrm{lim}},\\,N_{5}^{\\mathrm{lim}}\\big]$.\n\nYour final answer must be a single closed-form analytic expression. No units are involved. No rounding is required.", "solution": "The problem statement presented is subjected to validation.\n\nGivens are extracted verbatim as follows:\n- Element type: Five-node linear pyramid element.\n- Natural coordinates: $(\\xi, \\eta, \\zeta)$.\n- Apex at $\\zeta=1$, base at $\\zeta=0$.\n- Scaled cross-section coordinates: $\\alpha = \\xi/(1-\\zeta)$ and $\\beta = \\eta/(1-\\zeta)$.\n- For fixed $\\zeta \\in [0,1)$, the in-plane domain is the square $-1 \\le \\alpha,\\beta \\le 1$.\n- Node numbering: Node $1$ at $(-1,-1,0)$, Node $2$ at $(1,-1,0)$, Node $3$ at $(1,1,0)$, Node $4$ at $(-1,1,0)$ in $(\\xi,\\eta,\\zeta)$ coordinates; Node $5$ at the apex where $\\zeta=1$. The apex in a pyramid corresponds to $(\\xi,\\eta,\\zeta) = (0,0,1)$.\n- Shape function properties: Kronecker-delta property at nodes, partition of unity, linear variation along edges, linear variation over triangular faces.\n- Degeneration: Physical base edge between nodes $1$ and $2$ shrinks, causing them to coalesce.\n- Resulting element: Four-node tetrahedron with vertices at merged node $\\{1,2\\}$, node $3$, node $4$, and node $5$.\n- Task: Derive the limiting shape functions for this tetrahedral limit as functions of $(\\xi, \\eta, \\zeta)$.\n\nThe problem is scientifically grounded in the theory of the Finite Element Method, specifically concerning isoparametric element formulations and degeneration techniques. It is well-posed, objective, and contains sufficient information for a unique solution. No contradictions or factual errors are present. The problem is therefore deemed **valid**.\n\nThe solution proceeds as follows. First, the shape functions for the five-node pyramid element are established based on the provided definitions. Let the shape functions for the base nodes ($i=1, 2, 3, 4$) be denoted by $N_i$ and the apex node shape function by $N_5$.\nThe shape function for the apex, $N_5$, must be $1$ at node $5$ (where $\\zeta=1$) and $0$ on the base (where $\\zeta=0$). The simplest function satisfying this is:\n$$N_5(\\xi, \\eta, \\zeta) = \\zeta$$\nFor the partition of unity, $\\sum_{i=1}^5 N_i = 1$, which implies $\\sum_{i=1}^4 N_i = 1 - N_5 = 1 - \\zeta$.\nThe shape functions for the base nodes must be zero at the apex ($\\zeta=1$), so they must contain a factor of $(1-\\zeta)$. The problem defines scaled coordinates $\\alpha = \\xi/(1-\\zeta)$ and $\\beta = \\eta/(1-\\zeta)$, which map the cross-section at any $\\zeta$ to a unit square. This suggests constructing the base shape functions by taking the standard bilinear shape functions for a four-node quadrilateral in $(\\alpha, \\beta)$ coordinates and multiplying by $(1-\\zeta)$.\nThe standard bilinear shape functions $\\hat{N}_i(\\alpha, \\beta)$ for a square with vertices at $(\\pm 1, \\pm 1)$ are:\n$$ \\hat{N}_1(\\alpha, \\beta) = \\frac{1}{4}(1-\\alpha)(1-\\beta) $$\n$$ \\hat{N}_2(\\alpha, \\beta) = \\frac{1}{4}(1+\\alpha)(1-\\beta) $$\n$$ \\hat{N}_3(\\alpha, \\beta) = \\frac{1}{4}(1+\\alpha)(1+\\beta) $$\n$$ \\hat{N}_4(\\alpha, \\beta) = \\frac{1}{4}(1-\\alpha)(1+\\beta) $$\nThe pyramid shape functions are thus defined as $N_i = \\hat{N}_i(\\alpha, \\beta) (1-\\zeta)$ for $i=1,2,3,4$:\n$$ N_1(\\xi, \\eta, \\zeta) = \\frac{1}{4}(1-\\alpha)(1-\\beta)(1-\\zeta) = \\frac{1}{4}\\left(1-\\frac{\\xi}{1-\\zeta}\\right)\\left(1-\\frac{\\eta}{1-\\zeta}\\right)(1-\\zeta) $$\n$$ N_2(\\xi, \\eta, \\zeta) = \\frac{1}{4}(1+\\alpha)(1-\\beta)(1-\\zeta) = \\frac{1}{4}\\left(1+\\frac{\\xi}{1-\\zeta}\\right)\\left(1-\\frac{\\eta}{1-\\zeta}\\right)(1-\\zeta) $$\n$$ N_3(\\xi, \\eta, \\zeta) = \\frac{1}{4}(1+\\alpha)(1+\\beta)(1-\\zeta) = \\frac{1}{4}\\left(1+\\frac{\\xi}{1-\\zeta}\\right)\\left(1+\\frac{\\eta}{1-\\zeta}\\right)(1-\\zeta) $$\n$$ N_4(\\xi, \\eta, \\zeta) = \\frac{1}{4}(1-\\alpha)(1+\\beta)(1-\\zeta) = \\frac{1}{4}\\left(1-\\frac{\\xi}{1-\\zeta}\\right)\\left(1+\\frac{\\eta}{1-\\zeta}\\right)(1-\\zeta) $$\nThese functions satisfy all stated requirements, including partition of unity, the Kronecker-delta property at the nodes, and linear variation on the element faces when parameterized naturally.\n\nThe problem describes a geometric degeneration where the physical coordinates of nodes $1$ and $2$ coalesce, i.e., $\\boldsymbol{x}_1 = \\boldsymbol{x}_2 = \\boldsymbol{x}_{\\{1,2\\}}$. In the isoparametric formulation, the physical coordinate $\\boldsymbol{x}$ of a point is interpolated from the nodal coordinates $\\boldsymbol{x}_i$ using the shape functions:\n$$ \\boldsymbol{x}(\\xi, \\eta, \\zeta) = \\sum_{i=1}^5 N_i(\\xi, \\eta, \\zeta) \\boldsymbol{x}_i = N_1 \\boldsymbol{x}_1 + N_2 \\boldsymbol{x}_2 + N_3 \\boldsymbol{x}_3 + N_4 \\boldsymbol{x}_4 + N_5 \\boldsymbol{x}_5 $$\nApplying the degeneration condition $\\boldsymbol{x}_1 = \\boldsymbolx_2 = \\boldsymbol{x}_{\\{1,2\\}}$, the interpolation becomes:\n$$ \\boldsymbol{x}(\\xi, \\eta, \\zeta) = N_1 \\boldsymbol{x}_{\\{1,2\\}} + N_2 \\boldsymbol{x}_{\\{1,2\\}} + N_3 \\boldsymbolx_3 + N_4 \\boldsymbol{x}_4 + N_5 \\boldsymbol{x}_5 $$\n$$ \\boldsymbol{x}(\\xi, \\eta, \\zeta) = (N_1 + N_2) \\boldsymbol{x}_{\\{1,2\\}} + N_3 \\boldsymbolx_3 + N_4 \\boldsymbol{x}_4 + N_5 \\boldsymbol{x}_5 $$\nThis demonstrates that the shape function for the new merged node $\\{1,2\\}$, denoted $N_{\\{1,2\\}}^{\\mathrm{lim}}$, is the sum of the original shape functions $N_1$ and $N_2$. The shape functions for the remaining nodes are unchanged in their functional form with respect to the parent coordinates $(\\xi, \\eta, \\zeta)$.\n$$ N_{\\{1,2\\}}^{\\mathrm{lim}} = N_1 + N_2 $$\n$$ N_{3}^{\\mathrm{lim}} = N_3 $$\n$$ N_{4}^{\\mathrm{lim}} = N_4 $$\n$$ N_{5}^{\\mathrm{lim}} = N_5 $$\nWe now compute the explicit expression for $N_{\\{1,2\\}}^{\\mathrm{lim}}$:\n$$ N_{\\{1,2\\}}^{\\mathrm{lim}} = \\frac{1}{4}(1-\\alpha)(1-\\beta)(1-\\zeta) + \\frac{1}{4}(1+\\alpha)(1-\\beta)(1-\\zeta) $$\n$$ N_{\\{1,2\\}}^{\\mathrm{lim}} = \\frac{1}{4}(1-\\beta)(1-\\zeta) \\left[ (1-\\alpha) + (1+\\alpha) \\right] = \\frac{1}{4}(1-\\beta)(1-\\zeta)(2) = \\frac{1}{2}(1-\\beta)(1-\\zeta) $$\nSubstituting $\\beta = \\eta / (1-\\zeta)$:\n$$ N_{\\{1,2\\}}^{\\mathrm{lim}} = \\frac{1}{2}\\left(1 - \\frac{\\eta}{1-\\zeta}\\right)(1-\\zeta) = \\frac{1}{2}(1-\\zeta-\\eta) $$\nThe other limiting shape functions are already known. We express them in terms of $(\\xi, \\eta, \\zeta)$ by simplifying the products:\n$$ N_{3}^{\\mathrm{lim}} = \\frac{1}{4}\\left(1+\\frac{\\xi}{1-\\zeta}\\right)\\left(1+\\frac{\\eta}{1-\\zeta}\\right)(1-\\zeta) = \\frac{1}{4(1-\\zeta)^2}(1-\\zeta+\\xi)(1-\\zeta+\\eta)(1-\\zeta) = \\frac{(1-\\zeta+\\xi)(1-\\zeta+\\eta)}{4(1-\\zeta)} $$\n$$ N_{4}^{\\mathrm{lim}} = \\frac{1}{4}\\left(1-\\frac{\\xi}{1-\\zeta}\\right)\\left(1+\\frac{\\eta}{1-\\zeta}\\right)(1-\\zeta) = \\frac{1}{4(1-\\zeta)^2}(1-\\zeta-\\xi)(1-\\zeta+\\eta)(1-\\zeta) = \\frac{(1-\\zeta-\\xi)(1-\\zeta+\\eta)}{4(1-\\zeta)} $$\n$$ N_{5}^{\\mathrm{lim}} = \\zeta $$\nThe resulting set of four shape functions for the degenerated tetrahedral element, expressed in the parent coordinates of the original pyramid, are:\n$N_{\\{1,2\\}}^{\\mathrm{lim}} = \\frac{1}{2}(1-\\zeta-\\eta)$,\n$N_{3}^{\\mathrm{lim}} = \\frac{(1-\\zeta+\\xi)(1-\\zeta+\\eta)}{4(1-\\zeta)}$,\n$N_{4}^{\\mathrm{lim}} = \\frac{(1-\\zeta-\\xi)(1-\\zeta+\\eta)}{4(1-\\zeta)}$,\n$N_{5}^{\\mathrm{lim}} = \\zeta$.\nThese functions form the required row vector.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}(1-\\zeta-\\eta)  \\frac{(1-\\zeta+\\xi)(1-\\zeta+\\eta)}{4(1-\\zeta)}  \\frac{(1-\\zeta-\\xi)(1-\\zeta+\\eta)}{4(1-\\zeta)}  \\zeta \\end{pmatrix}}$$", "id": "2611714"}, {"introduction": "Moving beyond static analysis, understanding an element's inertial properties is crucial for dynamic simulations, a task that begins with the consistent mass matrix. This advanced computational exercise requires you to implement a numerical algorithm to assemble the mass matrix for a wedge element using appropriate quadrature rules. By subsequently analyzing how the matrix's eigenvalues respond to changes in the element's aspect ratio, you will develop practical insights into issues of element quality and their direct impact on the performance and stability of explicit time integration schemes [@problem_id:2611725].", "problem": "Consider the linear wedge (triangular prism) element in the Finite Element Method (FEM). Let the natural coordinates be $(\\xi,\\eta,\\zeta)$ with $(\\xi,\\eta)$ on the reference triangle defined by $\\xi \\ge 0$, $\\eta \\ge 0$, $\\xi+\\eta \\le 1$, and $\\zeta \\in [-1,1]$. The linear wedge has $6$ nodes, indexed as bottom face nodes $1,2,3$ at $\\zeta=-1$ and top face nodes $4,5,6$ at $\\zeta=+1$. The shape functions are defined by the standard linear triangle barycentric coordinates $L_1=1-\\xi-\\eta$, $L_2=\\xi$, $L_3=\\eta$, combined with linear functions in $\\zeta$:\n$$\nN_1 = L_1 \\frac{1-\\zeta}{2},\\quad\nN_2 = L_2 \\frac{1-\\zeta}{2},\\quad\nN_3 = L_3 \\frac{1-\\zeta}{2},\\quad\nN_4 = L_1 \\frac{1+\\zeta}{2},\\quad\nN_5 = L_2 \\frac{1+\\zeta}{2},\\quad\nN_6 = L_3 \\frac{1+\\zeta}{2}.\n$$\nConsider a prismatic physical mapping in which the bottom triangular face lies in the plane $z=0$ with nodes\n$$\n\\mathbf{x}_1=(0,0,0),\\quad \\mathbf{x}_2=(s,0,0),\\quad \\mathbf{x}_3=(0,s,0),\n$$\nand the top triangular face lies in the plane $z=h$ with nodes\n$$\n\\mathbf{x}_4=(0,0,h),\\quad \\mathbf{x}_5=(s,0,h),\\quad \\mathbf{x}_6=(0,s,h),\n$$\nwhere $s0$ is a base scale for the triangular face and $h0$ is the wedge length in the $\\zeta$-direction. Let the material density be constant with value $\\rho=1$ (dimensionless). The consistent mass matrix $\\mathbf{M} \\in \\mathbb{R}^{6 \\times 6}$ is defined by\n$$\n\\mathbf{M} = \\int_{V} \\rho\\, \\mathbf{N}^\\mathsf{T} \\mathbf{N}\\, dV,\n$$\nwhere $\\mathbf{N} = [N_1,\\dots,N_6]$ and $V$ is the physical wedge volume mapped from the reference domain via the isoparametric rule $\\mathbf{x}(\\xi,\\eta,\\zeta)=\\sum_{a=1}^6 N_a(\\xi,\\eta,\\zeta)\\mathbf{x}_a$.\n\nTask: From the above fundamental definitions and domain mapping, derive and implement a numerically exact algorithm (for polynomials up to degree $2$ in $(\\xi,\\eta)$ and degree $2$ in $\\zeta$) to assemble $\\mathbf{M}$ using separable Gaussian Quadrature (GQ): a triangle rule in $(\\xi,\\eta)$ of degree at least $2$ and a one-dimensional Gauss-Legendre rule in $\\zeta$ of degree at least $3$. Compute the eigenvalues of $\\mathbf{M}$ and analyze their sensitivity to the aspect ratio defined by\n$$\n\\mathrm{AR} = \\frac{h}{s}.\n$$\nUse the following facts as a starting point for your derivation:\n- The Jacobian determinant $|\\mathbf{J}|$ for the above prismatic mapping is constant over the element and equal to the product of the base area and half the height, namely $|\\mathbf{J}| = A \\cdot h/2 = V/2$, where $A$ is the physical area of the base triangle and $V=Ah$ is the element volume.\n- For the specified right triangle base with vertices $(0,0)$, $(s,0)$, $(0,s)$, the area is $A = \\frac{s^2}{2}$.\n\nYour program must implement the assembly of $\\mathbf{M}$ by quadrature, compute its eigenvalues, and then evaluate the following test suite. All quantities are dimensionless. Angles do not appear. The final program output must be a single line containing a comma-separated Python list with one floating-point number per test case, in the order listed below.\n\nTest Suite:\n- Test case $1$ (normalized eigenvalue invariance across aspect ratios at fixed base scale): Set $s=1$ and compute the normalized eigenvalues $\\lambda_i / (A h)$ for $\\mathrm{AR}=0.5$ and for $\\mathrm{AR}=3.0$ (i.e., $h=\\mathrm{AR}\\cdot s$). Sort each eigenvalue set in ascending order and return the maximum absolute difference between the two normalized spectra. The expected result is a small float near $0$.\n- Test case $2$ (logarithmic sensitivity at fixed base scale): With $s=1$, evaluate the largest eigenvalue $\\lambda_{\\max}$ at $\\mathrm{AR}_0=1.2$ using a symmetric perturbation $\\delta=10^{-4}$ to approximate the logarithmic derivative\n$$\nS_{\\mathrm{fixed}\\,s} \\approx \\frac{\\ln \\lambda_{\\max}(\\mathrm{AR}_0+\\delta)-\\ln \\lambda_{\\max}(\\mathrm{AR}_0-\\delta)}{\\ln(\\mathrm{AR}_0+\\delta)-\\ln(\\mathrm{AR}_0-\\delta)}.\n$$\nReturn this single float. The expected value is close to $1$.\n- Test case $3$ (logarithmic sensitivity at fixed volume): Impose a fixed volume $V_0=1$ and $\\mathrm{AR}_0=1.2$ with the same symmetric perturbation $\\delta=10^{-4}$. For each perturbed aspect ratio $\\mathrm{AR}$, choose $s=(2 V_0 / \\mathrm{AR})^{1/3}$ and $h=\\mathrm{AR}\\cdot s$ so that $A h = V_0$ holds exactly. Compute\n$$\nS_{\\mathrm{fixed}\\,V} \\approx \\frac{\\ln \\lambda_{\\max}(\\mathrm{AR}_0+\\delta)-\\ln \\lambda_{\\max}(\\mathrm{AR}_0-\\delta)}{\\ln(\\mathrm{AR}_0+\\delta)-\\ln(\\mathrm{AR}_0-\\delta)}.\n$$\nReturn this single float. The expected value is close to $0$.\n- Test case $4$ (near-degenerate geometric scaling check): Compare normalized eigenvalues at $(s,\\mathrm{AR})=(1,1)$ and at $(s,\\mathrm{AR})=(10^{-3},10^{3})$. For each case, compute the normalized spectrum $\\lambda_i/(A h)$, sort ascending, and return the Euclidean norm of the difference between the two normalized spectra. The expected result is a small float near $0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[x_1,x_2,x_3,x_4]$). Each $x_k$ must be a floating-point number corresponding to test case $k$ in the order given above.", "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and objective. It presents a standard problem in the Finite Element Method with clear definitions and constraints, allowing for a unique and verifiable solution.\n\nThe task is to compute the consistent mass matrix $\\mathbf{M}$ for a linear wedge element and analyze its eigenvalues. The mass matrix is defined by the integral:\n$$\nM_{ab} = \\int_{V} \\rho N_a N_b dV\n$$\nwhere $a, b \\in \\{1, \\dots, 6\\}$ are node indices, $\\mathbf{N} = [N_1, \\dots, N_6]$ is the vector of shape functions, $V$ is the physical volume of the element, and the density $\\rho$ is given as $1$.\n\nThe isoparametric mapping transforms this integral from the physical domain to the reference domain $(\\xi, \\eta, \\zeta)$, where $(\\xi, \\eta)$ are coordinates on the reference triangle and $\\zeta \\in [-1, 1]$. The volume element transforms as $dV = |\\mathbf{J}| d\\xi d\\eta d\\zeta$, where $|\\mathbf{J}|$ is the determinant of the Jacobian matrix of the mapping. For the specific prismatic mapping given by $\\mathbf{x} = (\\xi s, \\eta s, h(1+\\zeta)/2)$, the Jacobian matrix is diagonal: $\\mathbf{J} = \\mathrm{diag}(s, s, h/2)$, so its determinant is constant: $|\\mathbf{J}| = s^2 h / 2$. This is equal to the element volume $V = (s^2/2)h$ divided by the reference element height (2). The integral for the mass matrix becomes:\n$$\nM_{ab} = \\frac{s^2 h}{2} \\int_{-1}^{1} \\left( \\int_{A_{\\text{ref}}} N_a(\\xi, \\eta, \\zeta) N_b(\\xi, \\eta, \\zeta) \\,d\\xi d\\eta \\right) \\,d\\zeta\n$$\nwhere $A_{\\text{ref}}$ is the area of the reference triangle, which is $1/2$.\n\nThe integrand, $N_a N_b$, is a product of shape functions. The shape functions are defined as $N_i = L_k \\frac{1 \\pm \\zeta}{2}$, where $L_k$ are the linear barycentric coordinates on the triangle. Specifically, $L_1 = 1-\\xi-\\eta$, $L_2 = \\xi$, and $L_3 = \\eta$. Consequently, the term $N_a N_b$ is a polynomial of at most degree $2$ in the triangle coordinates $(\\xi,\\eta)$ and at most degree $2$ in the coordinate $\\zeta$.\n\nTo compute this integral numerically and exactly (up to machine precision), we use a Gaussian Quadrature scheme that is exact for polynomials of the required degree.\n1.  For the integral over the reference triangle in $(\\xi, \\eta)$, the integrand is quadratic. A $3$-point quadrature rule, which is exact for polynomials up to degree $2$, is sufficient. The quadrature points $(\\xi_i, \\eta_i)$ and weights $w_i^{\\text{tri}}$ for the reference triangle with vertices at $(0,0), (1,0), (0,1)$ are:\n    *   Points: $(1/2, 0), (0, 1/2), (1/2, 1/2)$\n    *   Weights: $w_i^{\\text{tri}} = 1/6$ for each point. These weights correspond to an integration domain of area $1/2$.\n2.  For the integral over $\\zeta \\in [-1, 1]$, the integrand is quadratic. The problem requires a rule of degree at least $3$. A $2$-point Gauss-Legendre quadrature rule is exact for polynomials up to degree $2(2)-1 = 3$, which satisfies the requirement. The points $\\zeta_j$ and weights $w_j^{\\zeta}$ are:\n    *   Points: $\\pm 1/\\sqrt{3}$\n    *   Weights: $w_j^{\\zeta} = 1$ for each point.\n\nThe mass matrix is then assembled by summing the contributions from each quadrature point:\n$$\nM_{ab} \\approx |\\mathbf{J}| \\sum_{j} w_j^{\\zeta} \\sum_{i} w_i^{\\text{tri}} N_a(\\xi_i, \\eta_i, \\zeta_j) N_b(\\xi_i, \\eta_i, \\zeta_j)\n$$\nThis can be implemented by iterating through all $3 \\times 2 = 6$ quadrature points. At each point, the shape function vector $\\mathbf{N}$ is evaluated, and the outer product $\\mathbf{N}^\\mathsf{T} \\mathbf{N}$ is scaled by the corresponding total weight and added to the mass matrix $\\mathbf{M}$. The total weight for a quadrature point $(\\xi_i, \\eta_i, \\zeta_j)$ is $|\\mathbf{J}| \\cdot w_i^{\\text{tri}} \\cdot w_j^{\\zeta}$.\n\nThe eigenvalues $\\lambda_i$ of the resulting symmetric positive-definite matrix $\\mathbf{M}$ are then computed numerically.\n\nFor the analysis in the test cases, it is crucial to recognize the scaling behavior of the mass matrix. The matrix $\\mathbf{M}$ can be expressed as:\n$$\n\\mathbf{M} = |\\mathbf{J}| \\mathbf{M}_{\\text{ref-int}} = \\frac{V}{2} \\mathbf{M}_{\\text{ref-int}}\n$$\nwhere $\\mathbf{M}_{\\text{ref-int}}$ is a constant reference matrix from the integral, independent of the geometric parameters $s$ and $h$. The eigenvalues $\\lambda_i$ of $\\mathbf{M}$ are therefore directly proportional to the element volume $V = A h$:\n$$\n\\lambda_i = C \\cdot V \\cdot \\lambda_{i, \\text{ref}}\n$$\nwhere $\\lambda_{i, \\text{ref}}$ are constant eigenvalues and $C$ is a constant. This implies that the normalized eigenvalues $\\lambda_i / V = \\lambda_i / (A h)$ are invariant with respect to the element's geometry. This principle explains the expected outcomes for the test cases:\n*   **Test Cases 1 and 4**: The normalized eigenvalue spectra are independent of the aspect ratio and scale, so their difference should be near zero.\n*   **Test Case 2**: With fixed $s=1$, the volume $V = A h = \\frac{s^2 h}{2} = \\frac{h}{2} = \\frac{s \\cdot \\mathrm{AR}}{2} = \\frac{\\mathrm{AR}}{2}$. Thus, $\\lambda_{\\max} \\propto \\mathrm{AR}$. The logarithmic derivative $\\frac{d(\\ln \\lambda_{\\max})}{d(\\ln \\mathrm{AR})} = 1$.\n*   **Test Case 3**: With fixed volume $V=V_0=1$, the eigenvalues $\\lambda_{\\max} = C \\cdot V_0 \\cdot \\lambda_{\\max, \\text{ref}}$ are constant. Therefore, their derivative with respect to any parameter, including $\\mathrm{AR}$, is $0$.\n\nThe implementation will follow this robust theoretical and numerical framework.", "answer": "```python\nimport numpy as np\nimport math\n\ndef get_quadrature_data():\n    \"\"\"\n    Provides quadrature points and weights for the reference wedge element.\n    - Triangle: 3-point rule, exact for degree 2 polynomials.\n    - Line: 2-point Gauss-Legendre rule, exact for degree 3 polynomials.\n    \"\"\"\n    # Triangle (xi, eta) quadrature for reference triangle with area 1/2\n    # Vertices at (0,0), (1,0), (0,1)\n    tri_points = np.array([\n        [0.5, 0.0],\n        [0.0, 0.5],\n        [0.5, 0.5]\n    ])\n    # Weights for a domain of area 1/2\n    tri_weights = np.array([1/6.0, 1/6.0, 1/6.0])\n\n    # 1D Gauss-Legendre quadrature for interval [-1, 1]\n    zeta_points = np.array([-1.0 / math.sqrt(3.0), 1.0 / math.sqrt(3.0)])\n    zeta_weights = np.array([1.0, 1.0])\n    \n    return tri_points, tri_weights, zeta_points, zeta_weights\n\ndef assemble_mass_matrix(s, h, quad_data):\n    \"\"\"\n    Assembles the 6x6 consistent mass matrix for a linear wedge element.\n    \n    Args:\n        s (float): Base scale of the triangular face.\n        h (float): Height of the wedge.\n        quad_data (tuple): Quadrature points and weights.\n\n    Returns:\n        numpy.ndarray: The 6x6 mass matrix.\n    \"\"\"\n    tri_points, tri_weights, zeta_points, zeta_weights = quad_data\n    mass_matrix = np.zeros((6, 6))\n    \n    # The Jacobian determinant is constant for this prismatic mapping.\n    # The mapping is x=s*xi, y=s*eta, z=h/2*(1+zeta).\n    # The Jacobian matrix is diagonal with entries (s, s, h/2).\n    # Its determinant is |J| = s^2 * h / 2.\n    jac_det = (s**2 * h) / 2.0\n    \n    # Pre-calculate shape function vector at each quadrature point\n    N_qp = np.zeros(6)\n    \n    for i in range(len(tri_points)):\n        xi, eta = tri_points[i]\n        w_tri = tri_weights[i]\n        \n        # Barycentric coordinates\n        L = np.array([1.0 - xi - eta, xi, eta])\n        \n        for j in range(len(zeta_points)):\n            zeta = zeta_points[j]\n            w_zeta = zeta_weights[j]\n            \n            # Linear functions in zeta direction\n            f_zeta = np.array([(1.0 - zeta) / 2.0, (1.0 + zeta) / 2.0])\n            \n            # Shape functions N_1 to N_6\n            N_qp[0:3] = L * f_zeta[0]  # Bottom face (zeta=-1)\n            N_qp[3:6] = L * f_zeta[1]  # Top face (zeta=+1)\n            \n            # Total weight for the current quadrature point\n            total_weight = jac_det * w_tri * w_zeta\n            \n            # Add contribution to the mass matrix\n            mass_matrix += np.outer(N_qp, N_qp) * total_weight\n            \n    return mass_matrix\n\ndef compute_sorted_eigs(s, h, quad_data):\n    \"\"\"Computes and sorts the eigenvalues of the mass matrix.\"\"\"\n    M = assemble_mass_matrix(s, h, quad_data)\n    # The mass matrix is symmetric, use eigvalsh for numerical stability and efficiency.\n    eigs = np.linalg.eigvalsh(M)\n    return np.sort(eigs)\n\ndef solve():\n    \"\"\"\n    Executes the test suite for the wedge element eigenvalue analysis.\n    \"\"\"\n    quad_data = get_quadrature_data()\n    results = []\n\n    # Test Case 1: Normalized eigenvalue invariance\n    s = 1.0\n    ar_a, ar_b = 0.5, 3.0\n    h_a, h_b = ar_a * s, ar_b * s\n    vol_a, vol_b = (s**2 / 2.0) * h_a, (s**2 / 2.0) * h_b\n    \n    eigs_a = compute_sorted_eigs(s, h_a, quad_data)\n    eigs_b = compute_sorted_eigs(s, h_b, quad_data)\n    \n    norm_eigs_a = eigs_a / vol_a\n    norm_eigs_b = eigs_b / vol_b\n  \n    result1 = np.max(np.abs(norm_eigs_a - norm_eigs_b))\n    results.append(result1)\n\n    # Test Case 2: Logarithmic sensitivity at fixed base scale\n    s = 1.0\n    ar0 = 1.2\n    delta = 1.0e-4\n    ar_plus, ar_minus = ar0 + delta, ar0 - delta\n\n    h_plus, h_minus = ar_plus * s, ar_minus * s\n\n    lambda_max_plus = compute_sorted_eigs(s, h_plus, quad_data)[-1]\n    lambda_max_minus = compute_sorted_eigs(s, h_minus, quad_data)[-1]\n\n    log_deriv_num = math.log(lambda_max_plus) - math.log(lambda_max_minus)\n    log_deriv_den = math.log(ar_plus) - math.log(ar_minus)\n    result2 = log_deriv_num / log_deriv_den\n    results.append(result2)\n\n    # Test Case 3: Logarithmic sensitivity at fixed volume\n    v0 = 1.0\n    ar0 = 1.2\n    delta = 1.0e-4\n    ar_plus, ar_minus = ar0 + delta, ar0 - delta\n\n    def get_geom_from_vol_ar(v, ar):\n        # V = A*h = (s^2/2)*h. Also h = AR*s.\n        # V = (s^2/2)*AR*s = AR*s^3/2.\n        # s^3 = 2*V/AR => s = (2*V/AR)^(1/3)\n        s = (2.0 * v / ar)**(1.0/3.0)\n        h = ar * s\n        return s, h\n\n    s_plus, h_plus = get_geom_from_vol_ar(v0, ar_plus)\n    s_minus, h_minus = get_geom_from_vol_ar(v0, ar_minus)\n\n    lambda_max_plus = compute_sorted_eigs(s_plus, h_plus, quad_data)[-1]\n    lambda_max_minus = compute_sorted_eigs(s_minus, h_minus, quad_data)[-1]\n\n    log_deriv_num = math.log(lambda_max_plus) - math.log(lambda_max_minus)\n    log_deriv_den = math.log(ar_plus) - math.log(ar_minus)\n    result3 = log_deriv_num / log_deriv_den\n    results.append(result3)\n\n    # Test Case 4: Near-degenerate geometric scaling check\n    s_a, ar_a = 1.0, 1.0\n    h_a = s_a * ar_a\n    vol_a = (s_a**2 / 2.0) * h_a\n    eigs_a = compute_sorted_eigs(s_a, h_a, quad_data)\n    norm_eigs_a = eigs_a / vol_a\n\n    s_b, ar_b = 1.0e-3, 1.0e3\n    h_b = s_b * ar_b  # h_b = 1.0\n    vol_b = (s_b**2 / 2.0) * h_b # vol_b = 0.5e-6\n    eigs_b = compute_sorted_eigs(s_b, h_b, quad_data)\n    norm_eigs_b = eigs_b / vol_b\n   \n    result4 = np.linalg.norm(norm_eigs_a - norm_eigs_b)\n    results.append(result4)\n\n    # Format the final output\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "2611725"}]}