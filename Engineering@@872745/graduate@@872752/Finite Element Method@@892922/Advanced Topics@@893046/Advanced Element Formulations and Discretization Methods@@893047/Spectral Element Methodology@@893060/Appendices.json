{"hands_on_practices": [{"introduction": "The power of the Spectral Element Method stems from its use of high-order polynomial bases on a standardized reference element, typically the interval $[-1,1]$. This foundational practice guides you through the derivation of the explicit formulas for the differentiation matrices, which are the core operators for computing derivatives within an element. By constructing these matrices from first principles and analyzing their spectral properties, you will gain deep insight into the accuracy, stability, and overall behavior of the method.", "problem": "Consider a single spectral element on the interval $[-1,1]$ using the spectral element method (SEM). Let $\\{x_j\\}_{j=0}^{N}$ be the Gauss–Lobatto–Legendre (GLL) nodes associated with the Legendre polynomial $P_{N}(x)$ of degree $N$, that is, $x_0=-1$, $x_N=1$, and $x_1,\\dots,x_{N-1}$ are the roots of $P_{N}'(x)$. Let $\\{\\ell_j(x)\\}_{j=0}^{N}$ be the Lagrange nodal basis polynomials satisfying $\\ell_j(x_i)=\\delta_{ij}$, and define the first and second derivative matrices by\n$$\nD_{ij}=\\ell_j'(x_i),\\qquad D^{(2)}_{ij}=\\ell_j''(x_i).\n$$\nWork from the following fundamental bases:\n- The definition of the nodal polynomial $\\pi(x)=\\prod_{m=0}^{N}(x-x_m)$ for the nodes $\\{x_m\\}$ and its relation to the Lagrange basis $\\ell_j(x)=\\dfrac{\\pi(x)}{\\pi'(x_j)(x-x_j)}$.\n- The characterization of GLL nodes by $(1-x^2)P_N'(x)=0$ and that, up to a nonzero constant, $\\pi(x)\\propto (1-x^2)P_{N}'(x)$.\n- The Legendre differential equation $(1-x^2)P_{N}''(x)-2xP_{N}'(x)+N(N+1)P_{N}(x)=0$ and its derivatives.\n- The summation-by-parts property associated with GLL quadrature weights in the context of SEM.\n\nTasks:\n1. Derive a closed-form expression for off-diagonal entries $D_{ij}$ for $i\\neq j$ in terms of $P_{N}(x)$ and the GLL nodes.\n2. Derive closed-form diagonal entries $D_{ii}$ for all $i\\in\\{0,1,\\dots,N\\}$.\n3. Using only identities that follow from the definitions above, derive explicit formulas for $D^{(2)}_{ij}$ for $i\\neq j$ in terms of $D_{ij}$, $x_i$, $x_j$, and $D_{ii}$, and then simplify these formulas for interior rows $i\\in\\{1,\\dots,N-1\\}$. Derive closed-form diagonal entries $D^{(2)}_{ii}$ for interior and endpoint indices separately.\n4. Let $W=\\mathrm{diag}(w_0,\\dots,w_N)$ be the diagonal matrix of GLL quadrature weights. Consider the Galerkin stiffness $K=D^{\\top}WD$ and mass $M=W$, and impose homogeneous Dirichlet boundary conditions by restricting to the interior degrees of freedom, yielding $K_{\\mathrm{int}}$ and $M_{\\mathrm{int}}$. Analyze the spectra of the following operators:\n   - The first derivative matrix $D$ (qualitative behavior and scaling of the spectral radius with $N$).\n   - The collocation second derivative matrix $D^{(2)}$ (qualitative behavior and scaling of the spectral radius with $N$).\n   - The generalized eigenvalue problem $K_{\\mathrm{int}}v=\\lambda M_{\\mathrm{int}}v$ (reality, definiteness, and scaling of extremal eigenvalues with $N$).\nProvide rigorous arguments based on the listed bases, including the Legendre equation, properties of $\\pi(x)$, and polynomial inverse inequalities, but avoid any shortcut formulas not derivable from these ingredients.\n\nYour final reported answer must be a single closed-form expression: the off-diagonal entry $D_{ij}$ for $i\\neq j$ in terms of $P_N$ and the nodes $x_i,x_j$. Do not include units. Do not provide numerical values. Do not include any additional text in your final answer beyond the requested expression.", "solution": "The problem statement is a well-posed, scientifically grounded problem in the field of numerical analysis, specifically concerning the spectral element method. All terms are standard and the tasks require rigorous derivations based on the provided fundamental principles. The problem is deemed valid and a full solution is presented.\n\nThe derivation will proceed by addressing the four tasks in the order they are presented.\n\nTask 1: Derivation of off-diagonal entries $D_{ij}$ for $i\\neq j$.\n\nThe first derivative matrix entries are defined as $D_{ij} = \\ell_j'(x_i)$, where $\\{\\ell_j(x)\\}_{j=0}^{N}$ are the Lagrange basis polynomials defined on the Gauss-Lobatto-Legendre (GLL) nodes $\\{x_k\\}_{k=0}^N$. The Lagrange basis polynomial $\\ell_j(x)$ is given by the formula:\n$$\n\\ell_j(x) = \\prod_{m=0, m\\neq j}^{N} \\frac{x-x_m}{x_j-x_m}\n$$\nThis can be expressed in terms of the nodal polynomial $\\pi(x) = \\prod_{m=0}^{N}(x-x_m)$. A simple manipulation gives $\\pi'(x_j) = \\prod_{m=0, m\\neq j}^{N}(x_j-x_m)$, which allows us to write $\\ell_j(x)$ as proposed in the problem statement:\n$$\n\\ell_j(x) = \\frac{\\pi(x)}{\\pi'(x_j)(x-x_j)}\n$$\nTo find $D_{ij}$, we must differentiate $\\ell_j(x)$ with respect to $x$ and then evaluate the result at $x=x_i$. For a fixed $j$, and for $x \\neq x_j$, the derivative of $\\ell_j(x)$ using the quotient rule is:\n$$\n\\ell_j'(x) = \\frac{1}{\\pi'(x_j)} \\frac{\\pi'(x)(x-x_j) - \\pi(x)\\cdot 1}{(x-x_j)^2}\n$$\nWe want to evaluate this at $x=x_i$ for $i \\neq j$. Since $x_i$ is a GLL node, it is a root of the nodal polynomial $\\pi(x)$, so $\\pi(x_i) = 0$. The expression for $\\ell_j'(x_i)$ simplifies significantly:\n$$\nD_{ij} = \\ell_j'(x_i) = \\frac{1}{\\pi'(x_j)} \\frac{\\pi'(x_i)(x_i-x_j) - \\pi(x_i)}{(x_i-x_j)^2} = \\frac{1}{\\pi'(x_j)} \\frac{\\pi'(x_i)(x_i-x_j) - 0}{(x_i-x_j)^2} = \\frac{\\pi'(x_i)}{\\pi'(x_j)(x_i-x_j)}\n$$\nNow, we must use the given properties of the GLL nodes. The nodal polynomial $\\pi(x)$ is proportional to $(1-x^2)P_N'(x)$, where $P_N(x)$ is the Legendre polynomial of degree $N$. Let this proportionality be $\\pi(x) = c(1-x^2)P_N'(x)$ for some non-zero constant $c$. To find $\\pi'(x)$, we differentiate this expression:\n$$\n\\pi'(x) = c \\left[ -2xP_N'(x) + (1-x^2)P_N''(x) \\right]\n$$\nThe Legendre differential equation, also provided, is $(1-x^2)P_N''(x) - 2xP_N'(x) + N(N+1)P_N(x) = 0$. We can solve for the term $(1-x^2)P_N''(x)$:\n$$\n(1-x^2)P_N''(x) = 2xP_N'(x) - N(N+1)P_N(x)\n$$\nSubstituting this into the expression for $\\pi'(x)$:\n$$\n\\pi'(x) = c \\left[ -2xP_N'(x) + \\left( 2xP_N'(x) - N(N+1)P_N(x) \\right) \\right] = -c N(N+1) P_N(x)\n$$\nThis provides a simple form for $\\pi'(x)$ evaluated at a node $x_k$: $\\pi'(x_k) = -cN(N+1)P_N(x_k)$. Substituting this back into our formula for $D_{ij}$:\n$$\nD_{ij} = \\frac{-c N(N+1) P_N(x_i)}{(-c N(N+1) P_N(x_j))(x_i-x_j)} = \\frac{P_N(x_i)}{P_N(x_j)(x_i-x_j)}\n$$\nThis is the required closed-form expression for the off-diagonal entries of the first derivative matrix for $i \\neq j$.\n\nTask 2: Derivation of diagonal entries $D_{ii}$.\n\nTo find the diagonal entries $D_{ii} = \\ell_i'(x_i)$, we can use the property that the derivative of a constant is zero. The sum of all Lagrange basis functions is identically equal to $1$:\n$$\n\\sum_{j=0}^{N} \\ell_j(x) = 1\n$$\nDifferentiating this identity with respect to $x$ yields:\n$$\n\\sum_{j=0}^{N} \\ell_j'(x) = 0\n$$\nEvaluating this sum at a node $x_i$ gives the sum of the entries in the $i$-th row of the matrix $D$:\n$$\n\\sum_{j=0}^{N} \\ell_j'(x_i) = \\sum_{j=0}^{N} D_{ij} = 0\n$$\nThis allows us to express the diagonal entry $D_{ii}$ in terms of the off-diagonal entries: $D_{ii} = - \\sum_{j=0, j \\neq i}^{N} D_{ij}$. While correct, a closed form is required.\n\nA direct derivation for $D_{ii}$ starts by considering $\\ell_i'(x_i)$ via the limit definition of the derivative. A more direct route is to find the second derivative of $\\pi(x)$. From the result $\\ell_i'(x_i) = \\frac{\\pi''(x_i)}{2\\pi'(x_i)}$ (which can be derived using L'Hôpital's rule twice on $\\frac{\\ell_i(x)-1}{x-x_i}$ or by Taylor expansion), we can find a closed form. We have $\\pi'(x) = -c N(N+1) P_N(x)$, so $\\pi''(x) = -c N(N+1) P_N'(x)$.\nSubstituting these into the formula for $D_{ii}$:\n$$\nD_{ii} = \\frac{-c N(N+1) P_N'(x_i)}{2(-c N(N+1) P_N(x_i))} = \\frac{P_N'(x_i)}{2P_N(x_i)}\n$$\nWe must evaluate this at the different types of GLL nodes.\nFor interior nodes $i \\in \\{1, \\dots, N-1\\}$, the nodes $x_i$ are defined as the roots of $P_N'(x)$, so $P_N'(x_i) = 0$. This gives:\n$$\nD_{ii} = 0, \\quad \\text{for } i = 1, \\dots, N-1\n$$\nFor the endpoint nodes $x_0 = -1$ and $x_N = 1$:\nAt $x_N=1$, we use the standard values $P_N(1) = 1$ and $P_N'(1) = \\frac{N(N+1)}{2}$.\n$$\nD_{NN} = \\frac{P_N'(1)}{2P_N(1)} = \\frac{N(N+1)/2}{2(1)} = \\frac{N(N+1)}{4}\n$$\nAt $x_0=-1$, we use $P_N(-1) = (-1)^N$ and $P_N'(-1) = (-1)^{N-1}\\frac{N(N+1)}{2}$.\n$$\nD_{00} = \\frac{P_N'(-1)}{2P_N(-1)} = \\frac{(-1)^{N-1}N(N+1)/2}{2(-1)^N} = -\\frac{N(N+1)}{4}\n$$\n\nTask 3: Derivation of second derivative matrix entries $D^{(2)}_{ij}$.\n\nFirst, we derive the off-diagonal entries $D^{(2)}_{ij} = \\ell_j''(x_i)$ for $i \\neq j$. We start from the expression for $\\ell_j'(x)$ derived earlier:\n$$\n\\ell_j'(x) = \\frac{\\pi'(x)(x-x_j) - \\pi(x)}{\\pi'(x_j)(x-x_j)^2}\n$$\nDifferentiating this with respect to $x$ using the quotient rule gives:\n$$\n\\ell_j''(x) = \\frac{1}{\\pi'(x_j)} \\frac{d}{dx} \\left( \\frac{\\pi'(x)(x-x_j) - \\pi(x)}{(x-x_j)^2} \\right)\n$$\nThe derivative of the numerator is $\\pi''(x)(x-x_j) + \\pi'(x) - \\pi'(x) = \\pi''(x)(x-x_j)$. The derivative of the denominator is $2(x-x_j)$.\n$$\n\\ell_j''(x) = \\frac{1}{\\pi'(x_j)} \\frac{[\\pi''(x)(x-x_j)](x-x_j)^2 - [\\pi'(x)(x-x_j)-\\pi(x)][2(x-x_j)]}{(x-x_j)^4}\n$$\nSimplifying by a factor of $(x-x_j)$:\n$$\n\\ell_j''(x) = \\frac{1}{\\pi'(x_j)} \\frac{\\pi''(x)(x-x_j)^2 - 2[\\pi'(x)(x-x_j)-\\pi(x)]}{(x-x_j)^3}\n$$\nEvaluating at $x=x_i$ where $i \\neq j$, we use $\\pi(x_i)=0$:\n$$\nD_{ij}^{(2)} = \\ell_j''(x_i) = \\frac{1}{\\pi'(x_j)} \\frac{\\pi''(x_i)(x_i-x_j)^2 - 2\\pi'(x_i)(x_i-x_j)}{(x_i-x_j)^3} = \\frac{\\pi''(x_i)(x_i-x_j) - 2\\pi'(x_i)}{\\pi'(x_j)(x_i-x_j)^2}\n$$\nWe can split this into two terms:\n$$\nD_{ij}^{(2)} = \\frac{\\pi''(x_i)}{\\pi'(x_j)(x_i-x_j)} - \\frac{2\\pi'(x_i)}{\\pi'(x_j)(x_i-x_j)^2}\n$$\nWe can express these terms using $D_{ij}$ and $D_{ii}$. Recall $D_{ij} = \\frac{\\pi'(x_i)}{\\pi'(x_j)(x_i-x_j)}$ and $D_{ii} = \\frac{\\pi''(x_i)}{2\\pi'(x_i)}$, which implies $\\pi''(x_i) = 2D_{ii}\\pi'(x_i)$.\nThe second term is $\\frac{2}{x_i-x_j} \\frac{\\pi'(x_i)}{\\pi'(x_j)(x_i-x_j)} = \\frac{2D_{ij}}{x_i-x_j}$.\nThe first term is $\\frac{2D_{ii}\\pi'(x_i)}{\\pi'(x_j)(x_i-x_j)} = 2D_{ii} \\frac{\\pi'(x_i)}{\\pi'(x_j)(x_i-x_j)} = 2D_{ii}D_{ij}$.\nCombining these gives the formula:\n$$\nD^{(2)}_{ij} = 2D_{ii}D_{ij} - \\frac{2D_{ij}}{x_i-x_j} = 2D_{ij}\\left(D_{ii} - \\frac{1}{x_i-x_j}\\right) \\quad \\text{for } i \\neq j\n$$\nFor interior rows $i \\in \\{1,\\dots,N-1\\}$, we have $D_{ii}=0$. The formula simplifies to:\n$$\nD^{(2)}_{ij} = -\\frac{2D_{ij}}{x_i-x_j}, \\quad i \\in \\{1,\\dots,N-1\\}, i \\neq j\n$$\nNext, we derive the diagonal entries $D^{(2)}_{ii} = \\ell_i''(x_i)$. A direct formula is $D^{(2)}_{ii} = \\frac{\\pi'''(x_i)}{3\\pi'(x_i)}$. We have $\\pi'(x) = -c N(N+1)P_N(x)$ and thus $\\pi'''(x) = -c N(N+1)P_N''(x)$.\n$$\nD^{(2)}_{ii} = \\frac{-c N(N+1)P_N''(x_i)}{3(-c N(N+1)P_N(x_i))} = \\frac{P_N''(x_i)}{3P_N(x_i)}\n$$\nUsing the Legendre equation, $P_N''(x_i) = \\frac{2x_iP_N'(x_i) - N(N+1)P_N(x_i)}{1-x_i^2}$.\nFor interior nodes $i \\in \\{1,\\dots,N-1\\}$, $x_i^2 \\neq 1$ and $P_N'(x_i)=0$.\n$$\nD^{(2)}_{ii} = \\frac{1}{3P_N(x_i)} \\frac{-N(N+1)P_N(x_i)}{1-x_i^2} = -\\frac{N(N+1)}{3(1-x_i^2)}, \\quad i \\in \\{1,\\dots,N-1\\}\n$$\nFor the endpoints $i=0,N$, the denominator $1-x_i^2$ is zero. We must handle these separately. Using the identity $D^{(2)}_{ii} = \\frac{P_N''(x_i)}{3P_N(x_i)}$ is simpler if we find $P_N''(1)$. Differentiating the Legendre equation yields $(1-x^2)P_N''' - 4xP_N'' + (N(N+1)-2)P_N' = 0$. At $x=1$, this gives $-4P_N''(1) + (N(N+1)-2)P_N'(1) = 0$.\nSo, $P_N''(1) = \\frac{N(N+1)-2}{4}P_N'(1) = \\frac{N(N+1)-2}{4} \\frac{N(N+1)}{2} = \\frac{N(N+1)(N^2+N-2)}{8}$.\nThen for $i=N$, since $P_N(1)=1$:\n$$\nD^{(2)}_{NN} = \\frac{P_N''(1)}{3P_N(1)} = \\frac{N(N+1)(N^2+N-2)}{24}\n$$\nBy symmetry of the GLL nodes about $x=0$, $D^{(2)}_{00} = D^{(2)}_{NN}$.\n\nTask 4: Spectral analysis.\n\n- **Spectrum of $D$**: The eigenvalues $\\lambda$ of $D$ are not, in general, purely imaginary. Using the summation-by-parts (SBP) property $W D + D^T W = B$, where $B=\\text{diag}(-1, 0, \\dots, 0, 1)$, for an eigenvector $v$ with eigenvalue $\\lambda$, we have $2\\text{Re}(\\lambda)v^H W v = |v_N|^2 - |v_0|^2$. So the real part of $\\lambda$ is non-zero if the eigenvector has different magnitudes at the boundaries. For eigenvectors with $v_0=v_N=0$, the eigenvalues are purely imaginary. The matrix $D$ is not normal. The spectral radius $\\rho(D) = \\max|\\lambda|$ scales with the polynomial degree $N$. From the polynomial inverse inequality (Markov's inequality), $||Du||_{\\infty} \\leq C N^2 ||u||_{\\infty}$ for a vector $u$ representing polynomial values at the nodes. This implies $\\rho(D) = O(N^2)$.\n\n- **Spectrum of $D^{(2)}$**: The eigenvalues of $D^{(2)}$ are real and non-positive. Since $\\sum_j D^{(2)}_{ij}=0$, the vector of all ones is an eigenvector with eigenvalue $0$. The other eigenvalues are negative. From the relation $D^{(2)}_{ij} = (D^2)_{ij}$, we can infer that the eigenvalues of $D^{(2)}$ are the eigenvalues of $D^2$, which are approximately squares of the eigenvalues of $D$. Given that many eigenvalues of $D$ are close to the imaginary axis, their squares are real and negative. The spectral radius $\\rho(D^{(2)})$ scales as $O(N^4)$, which can be inferred from the corresponding polynomial inverse inequality for second derivatives: $||D^{(2)}u||_{\\infty} \\leq C N^4 ||u||_{\\infty}$.\n\n- **Spectrum of $K_{\\mathrm{int}}v=\\lambda M_{\\mathrm{int}}v$**: This is the generalized eigenvalue problem for the Galerkin discretization of the one-dimensional Poisson equation with homogeneous Dirichlet boundary conditions.\n  - $M_{\\mathrm{int}}$ is the mass matrix restricted to interior nodes. It is a diagonal matrix with the GLL weights $w_j = \\int_{-1}^1 \\ell_j(x) dx$ for $j=1,\\dots,N-1$. All $w_j>0$, so $M_{\\mathrm{int}}$ is symmetric positive definite (SPD).\n  - $K_{\\mathrm{int}}$ is the stiffness matrix for interior nodes. For any interior vector $v$ (padded with zeros at endpoints to form $\\tilde{v}$), the quadratic form is $v^T K_{\\mathrm{int}} v = \\tilde{v}^T D^T W D \\tilde{v} = (D\\tilde{v})^T W (D\\tilde{v}) = \\sum_{i=0}^N w_i ( (D\\tilde{v})_i )^2 \\ge 0$. The form is zero only if $D\\tilde{v}=0$, which means the corresponding polynomial has zero derivative at all nodes, hence is a constant. As the polynomial is zero at the boundaries, it must be zero everywhere. Thus, $v=0$. So $K_{\\mathrm{int}}$ is also SPD.\n  - The generalized eigenvalue problem with two SPD matrices has real and positive eigenvalues: $\\lambda > 0$.\n  - The eigenvalues $\\lambda$ approximate the eigenvalues of the continuous problem $-u''=\\mu u$ on $[-1,1]$ with $u(\\pm 1)=0$, which are $\\mu_k = (k\\pi/2)^2$ for $k=1,2,\\dots$.\n  - The smallest eigenvalue, $\\lambda_{\\min}$, converges to the smallest continuous eigenvalue $\\mu_1 = (\\pi/2)^2$ as $N \\to \\infty$. Thus, $\\lambda_{\\min} = O(1)$.\n  - The largest eigenvalue, $\\lambda_{\\max}$, is related to the maximum frequency resolvable by the grid. It scales with the inverse of the minimum grid spacing squared. For GLL nodes, this leads to a scaling of $\\lambda_{\\max} = O(N^4)$. This is consistent with the stability constraint for explicit time integrators for the heat equation, which is $\\Delta t \\propto 1/\\lambda_{\\max}$.", "answer": "$$\\boxed{\\frac{P_{N}(x_i)}{P_{N}(x_j)(x_i-x_j)}}$$", "id": "2597917"}, {"introduction": "Real-world geometries are rarely as simple as the reference element domain. This practice introduces the essential concept of isoparametric mapping, an elegant technique for connecting the idealized reference element to general, possibly curved, physical domains. You will derive the transformation Jacobian and apply it to an integral, making clear how all computations can be standardized on the reference element, a cornerstone of practical finite and spectral element codes.", "problem": "Consider a one-dimensional spectral element on the reference interval $[-1,1]$ with nodes $\\{\\xi_i\\}_{i=0}^{N}$ chosen as the Gauss–Lobatto–Legendre (GLL) nodes, and define the Lagrange interpolating basis $\\{\\ell_i(\\xi)\\}_{i=0}^{N}$ by the conditions $\\ell_i(\\xi_j)=\\delta_{ij}$. The isoparametric mapping from the reference coordinate $\\xi$ to the physical coordinate $x$ is defined by $x(\\xi)=\\sum_{i=0}^{N} X_i \\,\\ell_i(\\xi)$, where $\\{X_i\\}_{i=0}^{N}$ are the physical nodal coordinates.\n\nTasks:\n1) Starting from the definition of the Lagrange interpolating polynomials on the nodes $\\{\\xi_i\\}_{i=0}^{N}$, derive an explicit expression for the Jacobian $J(\\xi)=\\dfrac{dx}{d\\xi}$ in terms of $\\{X_i\\}$ and the derivatives $\\{\\ell_i'(\\xi)\\}$.\n\n2) Using only the one-dimensional change-of-variables theorem from calculus and the chain rule, derive the transformation rule for an integral of a scalar function $f(x)$ over the physical element $K=x([-1,1])$:\n$$\n\\int_{K} f(x)\\,dx \\quad \\text{in terms of} \\quad \\int_{-1}^{1} \\cdots \\, d\\xi.\n$$\nClearly indicate the role played by $J(\\xi)$.\n\n3) Specialize to the case $N=2$ with GLL nodes $\\xi_0=-1$, $\\xi_1=0$, $\\xi_2=1$ and physical nodal coordinates $X_0=0$, $X_1=1$, $X_2=3$. For the function $f(x)=x^2$, compute the exact value of the physical integral\n$$\nI \\;=\\; \\int_{x(-1)}^{x(1)} x^2\\,dx\n$$\nby transforming to the reference interval $[-1,1]$ and evaluating the resulting expression exactly. Provide your final answer as a single real number with no units and do not round.", "solution": "The problem statement is first subjected to a critical validation to ensure its scientific and logical integrity.\n\nThe givens are as follows:\n- A one-dimensional spectral element on the reference interval $[-1,1]$.\n- Nodal points are the Gauss–Lobatto–Legendre (GLL) nodes $\\{\\xi_i\\}_{i=0}^{N}$.\n- The basis functions are the Lagrange interpolating polynomials $\\{\\ell_i(\\xi)\\}_{i=0}^{N}$ satisfying the property $\\ell_i(\\xi_j)=\\delta_{ij}$.\n- The isoparametric mapping from the reference coordinate $\\xi$ to the physical coordinate $x$ is given by $x(\\xi)=\\sum_{i=0}^{N} X_i \\,\\ell_i(\\xi)$, where $\\{X_i\\}_{i=0}^{N}$ are the physical nodal coordinates.\n- For Task $3$, we are given $N=2$, with GLL nodes $\\xi_0=-1$, $\\xi_1=0$, $\\xi_2=1$.\n- The corresponding physical nodal coordinates are $X_0=0$, $X_1=1$, $X_2=3$.\n- The function to be integrated is $f(x)=x^2$.\n\nThe problem is scientifically grounded, being a standard formulation in the finite element and spectral element literature. It is well-posed, with all necessary information provided to derive the requested expressions and compute the final value. The language is objective and precise. The problem is free of logical contradictions, factual errors, or any other flaws that would render it invalid. Therefore, we proceed with the solution.\n\nTask 1: Derive an explicit expression for the Jacobian $J(\\xi)$.\n\nThe Jacobian of the one-dimensional transformation from the reference coordinate $\\xi$ to the physical coordinate $x$ is defined as $J(\\xi) = \\frac{dx}{d\\xi}$. The mapping is given by the isoparametric formulation:\n$$\nx(\\xi) = \\sum_{i=0}^{N} X_i \\, \\ell_i(\\xi)\n$$\nTo find the Jacobian, we differentiate this expression with respect to $\\xi$. The physical nodal coordinates $\\{X_i\\}$ are constants with respect to the reference coordinate $\\xi$. The differentiation operation is linear, so we can differentiate the sum term by term:\n$$\nJ(\\xi) = \\frac{d}{d\\xi} \\left( \\sum_{i=0}^{N} X_i \\, \\ell_i(\\xi) \\right)\n$$\nApplying the derivative to each term in the summation yields:\n$$\nJ(\\xi) = \\sum_{i=0}^{N} X_i \\, \\frac{d\\ell_i}{d\\xi}(\\xi)\n$$\nUsing prime notation for the derivative, $\\ell_i'(\\xi) = \\frac{d\\ell_i}{d\\xi}(\\xi)$, the expression for the Jacobian is:\n$$\nJ(\\xi) = \\sum_{i=0}^{N} X_i \\, \\ell_i'(\\xi)\n$$\n\nTask 2: Derive the transformation rule for an integral of a scalar function $f(x)$.\n\nWe are asked to transform the integral of a scalar function $f(x)$ over the physical element $K = x([-1,1])$. The integral is $\\int_{K} f(x)\\,dx$. The domain $K$ corresponds to the interval $[x(-1), x(1)]$. We use the one-dimensional change-of-variables theorem from calculus. The transformation is given by the mapping $x=x(\\xi)$. The differential element $dx$ is related to the differential element $d\\xi$ by the chain rule:\n$$\ndx = \\frac{dx}{d\\xi} \\, d\\xi = J(\\xi) \\, d\\xi\n$$\nWhen the variable of integration is changed from $x$ to $\\xi$, the limits of integration must also be transformed. The physical domain $K$ spans from $x_{start} = x(-1)$ to $x_{end} = x(1)$. These correspond to the reference domain limits $\\xi=-1$ and $\\xi=1$, respectively. Substituting $x=x(\\xi)$, $dx=J(\\xi)d\\xi$, and the new limits into the integral gives the transformation rule:\n$$\n\\int_{x(-1)}^{x(1)} f(x) \\, dx = \\int_{-1}^{1} f(x(\\xi)) \\, J(\\xi) \\, d\\xi\n$$\nThe role of the Jacobian $J(\\xi)$ is to act as a scaling factor that relates the differential length element $dx$ in the physical domain to the differential length element $d\\xi$ in the reference domain. It accounts for the local stretching ($|J(\\xi)| > 1$), compression ($|J(\\xi)|  1$), or orientation reversal ($J(\\xi)  0$) of the mapping at each point $\\xi$. For a valid, non-degenerate element mapping, the Jacobian must not be zero within the element's interior.\n\nTask 3: Compute the exact value of the integral for the specified case.\n\nWe have $N=2$, with nodes $\\xi_0=-1$, $\\xi_1=0$, $\\xi_2=1$. We first construct the Lagrange basis polynomials $\\{\\ell_i(\\xi)\\}_{i=0}^{2}$:\n$$\n\\ell_0(\\xi) = \\frac{(\\xi - \\xi_1)(\\xi - \\xi_2)}{(\\xi_0 - \\xi_1)(\\xi_0 - \\xi_2)} = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{\\xi(\\xi-1)}{2} = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\n$$\n$$\n\\ell_1(\\xi) = \\frac{(\\xi - \\xi_0)(\\xi - \\xi_2)}{(\\xi_1 - \\xi_0)(\\xi_1 - \\xi_2)} = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = \\frac{(\\xi+1)(\\xi-1)}{-1} = 1 - \\xi^2\n$$\n$$\n\\ell_2(\\xi) = \\frac{(\\xi - \\xi_0)(\\xi - \\xi_1)}{(\\xi_2 - \\xi_0)(\\xi_2 - \\xi_1)} = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{(\\xi+1)\\xi}{2} = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\n$$\nNext, we construct the isoparametric mapping $x(\\xi)$ using the physical node coordinates $X_0=0$, $X_1=1$, and $X_2=3$:\n$$\nx(\\xi) = X_0\\ell_0(\\xi) + X_1\\ell_1(\\xi) + X_2\\ell_2(\\xi)\n$$\n$$\nx(\\xi) = (0)\\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1)(1 - \\xi^2) + (3)\\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right)\n$$\n$$\nx(\\xi) = 1 - \\xi^2 + \\frac{3}{2}\\xi^2 + \\frac{3}{2}\\xi = \\frac{1}{2}\\xi^2 + \\frac{3}{2}\\xi + 1\n$$\nWe verify the mapping at the nodes: $x(-1) = \\frac{1}{2} - \\frac{3}{2} + 1 = 0 = X_0$, $x(0) = 1 = X_1$, $x(1) = \\frac{1}{2} + \\frac{3}{2} + 1 = 3 = X_2$. The mapping is correct.\n\nNow, we compute the Jacobian $J(\\xi)$:\n$$\nJ(\\xi) = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1}{2}\\xi^2 + \\frac{3}{2}\\xi + 1\\right) = \\xi + \\frac{3}{2}\n$$\nThe integral to be computed is $I = \\int_{x(-1)}^{x(1)} x^2\\,dx = \\int_{0}^{3} x^2\\,dx$.\nWe transform this integral to the reference interval $[-1,1]$:\n$$\nI = \\int_{-1}^{1} (x(\\xi))^2 \\, J(\\xi) \\, d\\xi\n$$\nSubstituting the expressions for $x(\\xi)$ and $J(\\xi)$:\n$$\nI = \\int_{-1}^{1} \\left(\\frac{1}{2}\\xi^2 + \\frac{3}{2}\\xi + 1\\right)^2 \\left(\\xi + \\frac{3}{2}\\right) d\\xi\n$$\nLet us recognize that the term $\\xi + \\frac{3}{2}$ is precisely the derivative of the term inside the parenthesis, i.e., $J(\\xi) = \\frac{dx(\\xi)}{d\\xi}$. This allows for a direct substitution. Let $u = x(\\xi) = \\frac{1}{2}\\xi^2 + \\frac{3}{2}\\xi + 1$. Then $du = (\\xi + \\frac{3}{2})d\\xi = J(\\xi)d\\xi$. We must also change the limits of integration according to this substitution:\n- When $\\xi = -1$, $u = x(-1) = 0$.\n- When $\\xi = 1$, $u = x(1) = 3$.\n\nThe integral transforms as follows:\n$$\nI = \\int_{u(\\xi=-1)}^{u(\\xi=1)} u^2 \\, du = \\int_{0}^{3} u^2 \\, du\n$$\nThis is a trivial integral to evaluate:\n$$\nI = \\left[ \\frac{u^3}{3} \\right]_{0}^{3} = \\frac{3^3}{3} - \\frac{0^3}{3} = \\frac{27}{3} = 9\n$$\nThis result can be verified by direct integration in the physical space, which confirms the correctness of our procedure:\n$$\n\\int_{0}^{3} x^2 \\, dx = \\left[ \\frac{x^3}{3} \\right]_{0}^{3} = \\frac{3^3}{3} = 9\n$$\nThe calculation is consistent and correct.", "answer": "$$\n\\boxed{9}\n$$", "id": "2597909"}, {"introduction": "This exercise bridges the gap between spatial discretization and the practicalities of time-dependent simulation by applying the SEM to the diffusion equation. You will assemble the system's mass and stiffness matrices and then impose boundary conditions, mimicking the workflow for solving partial differential equations. By analyzing the generalized eigenvalues of the resulting system, you will compute the maximum stable time step for an explicit integration scheme, a critical skill for ensuring the robustness of numerical simulations.", "problem": "Construct a one-dimensional Spectral Element Method (SEM) on the reference element $[-1,1]$ using the Gauss–Lobatto–Legendre (GLL) collocation points for polynomial degree $N$. Consider the homogeneous Dirichlet boundary value problem for the unit-coefficient diffusion equation $u_{t} = u_{xx}$; its Galerkin semi-discretization with the nodal Lagrange basis $\\{\\ell_{j}(x)\\}_{j=0}^{N}$ yields a mass matrix $M$ with entries $M_{ij} = \\int_{-1}^{1} \\ell_{i}(x)\\,\\ell_{j}(x)\\,dx$ and a stiffness matrix $K$ with entries $K_{ij} = \\int_{-1}^{1} \\ell_{i}'(x)\\,\\ell_{j}'(x)\\,dx$. In the SEM collocation setting with GLL quadrature, the integrals are approximated by the GLL rule. Impose homogeneous Dirichlet boundary conditions at $x=-1$ and $x=1$ by eliminating the boundary degrees of freedom associated with the endpoints. Work entirely on the single reference element $[-1,1]$ with unit coefficients and no source terms.\n\nFrom foundational principles, begin with the weak form of $u_{t} = u_{xx}$, i.e., find $u$ such that for all admissible test functions $v$,\n$$\n\\int_{-1}^{1} v(x)\\,u_{t}(x,t)\\,dx + \\int_{-1}^{1} v_{x}(x)\\,u_{x}(x,t)\\,dx = 0,\n$$\nand derive the semi-discrete system $M\\,\\dot{\\mathbf{u}} + K\\,\\mathbf{u} = 0$, where $\\mathbf{u}$ collects the nodal unknowns (after eliminating the boundary nodes). The GLL nodes $\\{x_{i}\\}_{i=0}^{N}$ are the endpoints $x_{0}=-1$, $x_{N}=1$ together with the $N-1$ interior points given by the roots of the derivative of the Legendre polynomial $P_{N}'(x)$ in $(-1,1)$. The GLL quadrature weights $\\{w_{i}\\}_{i=0}^{N}$ satisfy $w_{i} = \\dfrac{2}{N(N+1)\\,[P_{N}(x_{i})]^{2}}$. Use the nodal Lagrange basis at the GLL nodes and the collocated quadrature to construct $M$ and $K$ on $[-1,1]$.\n\nAfter forming $M$ and $K$ on the full node set, enforce homogeneous Dirichlet boundary conditions by restricting to the interior indices $\\{1,2,\\dots,N-1\\}$. Denote the interior-restricted matrices by $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$. Let the generalized eigenvalues $\\{\\lambda_{j}\\}$ be defined by $K_{\\mathrm{int}}\\mathbf{v}_{j} = \\lambda_{j}\\,M_{\\mathrm{int}}\\mathbf{v}_{j}$. The explicit Forward Euler time discretization of $M_{\\mathrm{int}}\\dot{\\mathbf{u}} + K_{\\mathrm{int}}\\mathbf{u} = 0$ is $\\mathbf{u}^{n+1} = \\mathbf{u}^{n} - \\Delta t\\,M_{\\mathrm{int}}^{-1}K_{\\mathrm{int}}\\mathbf{u}^{n}$ and is stable if and only if the time step satisfies $\\Delta t \\le \\dfrac{2}{\\max_{j}\\lambda_{j}}$. This restriction is the one you must compute and report.\n\nYour tasks are:\n- Construct the GLL nodes on $[-1,1]$ and the corresponding weights for a given polynomial degree $N$.\n- Assemble the SEM mass matrix $M$ using the collocated GLL quadrature, which renders $M$ diagonal with diagonal entries equal to the quadrature weights.\n- Assemble the SEM stiffness matrix $K$ as the GLL quadrature of the gradient terms, which is given by $K = D^{\\top} W D$, where $D$ is the nodal differentiation matrix with entries $D_{ij} = \\ell_{j}'(x_{i})$ and $W = \\mathrm{diag}(w_{0},\\dots,w_{N})$ is the diagonal matrix of quadrature weights.\n- Impose homogeneous Dirichlet boundary conditions by eliminating the first and last degrees of freedom, yielding $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$.\n- Compute the eigenvalues of $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$ individually, and compute the generalized eigenvalues $\\{\\lambda_{j}\\}$ of $(K_{\\mathrm{int}}, M_{\\mathrm{int}})$.\n- From the generalized spectrum, compute the Forward Euler time step restriction $\\Delta t_{\\max} = \\dfrac{2}{\\max_{j}\\lambda_{j}}$.\n\nTest suite and output specification:\n- Use three test cases with polynomial degrees $N \\in \\{2,6,10\\}$ on the single element $[-1,1]$.\n- For each test case, compute and report the following list of real numbers: $[N, \\min\\operatorname{eig}(M_{\\mathrm{int}}), \\max\\operatorname{eig}(M_{\\mathrm{int}}), \\min\\operatorname{eig}(K_{\\mathrm{int}}), \\max\\operatorname{eig}(K_{\\mathrm{int}}), \\max_{j}\\lambda_{j}, \\Delta t_{\\max}]$.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists with no spaces, e.g., for three cases it must look like $[[\\cdots],[\\cdots],[\\cdots]]$.\n\nAngle units and physical units are not applicable; all quantities are dimensionless real numbers. All outputs must be numerical and appear as standard decimal representations. The program must be fully self-contained, must not read any input, and must exactly adhere to the specified final output format in a single printed line.", "solution": "The problem presented is a standard and well-posed exercise in the field of computational science, specifically concerning the spectral element method for parabolic partial differential equations. It is scientifically grounded, logically consistent, and all necessary conditions and definitions for its resolution are provided. We shall therefore proceed with its solution.\n\nThe problem commences with the one-dimensional heat-diffusion equation with a unit diffusion coefficient, given as\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial^2 u}{\\partial x^2}\n$$\non the domain $\\Omega = [-1, 1]$, subject to homogeneous Dirichlet boundary conditions, $u(-1, t) = 0$ and $u(1, t) = 0$. The first step in the finite element or spectral element formulation is to derive the weak form. We multiply the equation by a sufficiently smooth test function $v(x)$ that satisfies the same homogeneous boundary conditions, and integrate over the domain $\\Omega$:\n$$\n\\int_{-1}^{1} v(x) u_t(x,t) \\, dx = \\int_{-1}^{1} v(x) u_{xx}(x,t) \\, dx.\n$$\nApplying integration by parts to the right-hand side and utilizing the fact that the test function $v(x)$ vanishes at the boundaries ($v(-1)=v(1)=0$), we obtain the weak formulation. Find $u(x,t)$ such that for all admissible test functions $v(x)$:\n$$\n\\int_{-1}^{1} v(x) u_t(x,t) \\, dx + \\int_{-1}^{1} v_x(x) u_x(x,t) \\, dx = 0.\n$$\nThe spectral element method approximates the solution $u(x,t)$ as a linear combination of basis functions. Specifically, we use a nodal expansion of degree $N$ based on a set of collocation points $\\{x_j\\}_{j=0}^{N}$:\n$$\nu(x,t) \\approx u_h(x,t) = \\sum_{j=0}^{N} u_j(t) \\ell_j(x),\n$$\nwhere $u_j(t) = u_h(x_j,t)$ are the time-dependent coefficients representing the solution at the nodes, and $\\{\\ell_j(x)\\}_{j=0}^{N}$ is the set of Lagrange basis polynomials satisfying $\\ell_j(x_i) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. The test function $v(x)$ is chosen from the same space, i.e., $v(x) = \\ell_i(x)$ for $i=0, \\dots, N$.\n\nSubstituting the expansion for $u_h$ into the weak form and using $\\ell_i(x)$ as the test function, we arrive at a system of ordinary differential equations for the unknown coefficients $\\mathbf{u}(t) = [u_0(t), \\dots, u_N(t)]^T$:\n$$\n\\sum_{j=0}^{N} \\left( \\int_{-1}^{1} \\ell_i(x) \\ell_j(x) \\, dx \\right) \\frac{d u_j}{dt} + \\sum_{j=0}^{N} \\left( \\int_{-1}^{1} \\ell_i'(x) \\ell_j'(x) \\, dx \\right) u_j(t) = 0, \\quad \\text{for } i=0, \\dots, N.\n$$\nThis is the semi-discrete system $M\\dot{\\mathbf{u}} + K\\mathbf{u} = \\mathbf{0}$, where the mass matrix $M$ and stiffness matrix $K$ have entries:\n$$\nM_{ij} = \\int_{-1}^{1} \\ell_i(x) \\ell_j(x) \\, dx, \\quad \\quad K_{ij} = \\int_{-1}^{1} \\ell_i'(x) \\ell_j'(x) \\, dx.\n$$\nIn the spectral element method, these integrals are not computed exactly. Instead, they are approximated using numerical quadrature. The choice of Gauss-Lobatto-Legendre (GLL) quadrature is central. A GLL quadrature rule of order $N$ uses $N+1$ points $\\{x_k\\}_{k=0}^N$ and corresponding weights $\\{w_k\\}_{k=0}^N$. The integral of a function $f(x)$ is approximated as:\n$$\n\\int_{-1}^{1} f(x) \\, dx \\approx \\sum_{k=0}^{N} f(x_k) w_k.\n$$\nThis quadrature is exact for polynomials of degree up to $2N-1$. The GLL nodes $\\{x_k\\}$ are the roots of $(1-x^2)P_N'(x)$, where $P_N(x)$ is the Legendre polynomial of degree $N$. This set includes the endpoints $x_0 = -1$ and $x_N = 1$. The weights are given by the formula $w_k = \\frac{2}{N(N+1)[P_N(x_k)]^2}$.\n\nWhen we apply this quadrature to the mass matrix entries, and because the Lagrange basis functions are used at the quadrature points themselves, we have $\\ell_j(x_k) = \\delta_{jk}$. This results in a remarkable simplification:\n$$\nM_{ij} = \\int_{-1}^{1} \\ell_i(x) \\ell_j(x) \\, dx \\approx \\sum_{k=0}^{N} w_k \\ell_i(x_k) \\ell_j(x_k) = \\sum_{k=0}^{N} w_k \\delta_{ik} \\delta_{jk} = w_i \\delta_{ij}.\n$$\nThe mass matrix $M$ becomes diagonal, with the quadrature weights on its diagonal: $M = \\mathrm{diag}(w_0, \\dots, w_N)$. This is a defining advantage of the SEM, often called \"mass lumping\".\n\nThe stiffness matrix entries are similarly approximated:\n$$\nK_{ij} = \\int_{-1}^{1} \\ell_i'(x) \\ell_j'(x) \\, dx \\approx \\sum_{k=0}^{N} w_k \\ell_i'(x_k) \\ell_j'(x_k).\n$$\nIf we define the nodal differentiation matrix $D$ with entries $D_{ki} = \\ell_i'(x_k)$, and a diagonal weight matrix $W = \\mathrm{diag}(w_0, \\dots, w_N)$, then the stiffness matrix can be concisely expressed as $K = D^T W D$. The entries of the differentiation matrix $D$ have a known analytical form for GLL nodes:\n$$\nD_{ij} = \\ell_j'(x_i) = \\begin{cases} \\frac{P_N(x_i)}{P_N(x_j)} \\frac{1}{x_i - x_j}  i \\neq j \\\\ -\\frac{N(N+1)}{4}  i=j=0 \\\\ \\frac{N(N+1)}{4}  i=j=N \\\\ 0  i=j \\in \\{1, \\dots, N-1\\} \\end{cases}\n$$\n\nThe homogeneous Dirichlet boundary conditions $u(-1,t)=0$ and $u(1,t)=0$ imply that the coefficients at the boundary nodes, $u_0(t)$ and $u_N(t)$, are fixed at zero for all time. We enforce this by eliminating the first and last rows and columns of the matrices $M$ and $K$. This yields the interior system:\n$$\nM_{\\mathrm{int}} \\dot{\\mathbf{u}}_{\\mathrm{int}} + K_{\\mathrm{int}} \\mathbf{u}_{\\mathrm{int}} = \\mathbf{0},\n$$\nwhere $\\mathbf{u}_{\\mathrm{int}} = [u_1, \\dots, u_{N-1}]^T$, and $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$ are the $(N-1) \\times (N-1)$ submatrices corresponding to the interior degrees of freedom.\n\nTo analyze the stability of a time-stepping scheme, we consider the eigenvalues of the system. The equation can be rewritten as $\\dot{\\mathbf{u}}_{\\mathrm{int}} = -M_{\\mathrm{int}}^{-1} K_{\\mathrm{int}} \\mathbf{u}_{\\mathrm{int}}$. The Forward Euler method discretizes this as:\n$$\n\\mathbf{u}_{\\mathrm{int}}^{n+1} = \\mathbf{u}_{\\mathrm{int}}^n - \\Delta t \\, M_{\\mathrm{int}}^{-1} K_{\\mathrm{int}} \\mathbf{u}_{\\mathrm{int}}^n = (I - \\Delta t \\, M_{\\mathrm{int}}^{-1} K_{\\mathrm{int}}) \\mathbf{u}_{\\mathrm{int}}^n.\n$$\nFor stability, the spectral radius of the amplification matrix $G = I - \\Delta t \\, M_{\\mathrm{int}}^{-1} K_{\\mathrm{int}}$ must not exceed $1$. The eigenvalues of $G$ are $1 - \\Delta t \\lambda_j$, where $\\lambda_j$ are the generalized eigenvalues of the pair $(K_{\\mathrm{int}}, M_{\\mathrm{int}})$, satisfying $K_{\\mathrm{int}}\\mathbf{v}_j = \\lambda_j M_{\\mathrm{int}}\\mathbf{v}_j$. Since $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$ are symmetric and positive definite, the eigenvalues $\\lambda_j$ are real and positive. The stability condition $|1 - \\Delta t \\lambda_j| \\le 1$ for all $j$ becomes $-1 \\le 1 - \\Delta t \\lambda_j \\le 1$, which simplifies to $0 \\le \\Delta t \\lambda_j \\le 2$. This must hold for the largest eigenvalue, leading to the stability limit:\n$$\n\\Delta t \\le \\frac{2}{\\lambda_{\\mathrm{max}}},\n$$\nwhere $\\lambda_{\\mathrm{max}} = \\max_j \\lambda_j$.\n\nThe required computational procedure is as follows:\n1. For a given polynomial degree $N$, compute the $N-1$ interior GLL nodes as the roots of $P_N'(x)$, and form the full set of $N+1$ nodes by including $-1$ and $1$.\n2. Compute the corresponding $N+1$ GLL weights $w_k$.\n3. Construct the $(N-1) \\times (N-1)$ interior mass matrix $M_{\\mathrm{int}}$, which is diagonal with entries $\\{w_1, \\dots, w_{N-1}\\}$.\n4. Construct the full $(N+1) \\times (N+1)$ differentiation matrix $D$ and subsequently the full stiffness matrix $K = D^T W D$. Extract the $(N-1) \\times (N-1)$ interior submatrix $K_{\\mathrm{int}}$.\n5. Compute the standard eigenvalues of $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$. The eigenvalues of $M_{\\mathrm{int}}$ are its diagonal entries.\n6. Solve the generalized eigenvalue problem $K_{\\mathrm{int}}\\mathbf{v} = \\lambda M_{\\mathrm{int}}\\mathbf{v}$ to find the generalized spectrum $\\{\\lambda_j\\}$.\n7. Determine the maximum generalized eigenvalue $\\lambda_{\\max}$ and compute the critical time step $\\Delta t_{\\max} = 2 / \\lambda_{\\max}$.\nThis rigorous procedure will be implemented for the specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Constructs and analyzes a 1D Spectral Element Method for the diffusion equation\n    on the reference element [-1, 1] for various polynomial degrees N.\n    \"\"\"\n    \n    test_cases = [2, 6, 10]\n    all_results = []\n\n    for N in test_cases:\n        # Step 1: Compute GLL nodes and weights\n        # The interior GLL nodes are the roots of the derivative of the N-th Legendre polynomial.\n        L_N = np.polynomial.legendre.Legendre.basis(N)\n        L_N_prime = L_N.deriv(1)\n        interior_nodes = L_N_prime.roots()\n        \n        # The full set of nodes includes the endpoints -1 and 1.\n        # Nodes must be sorted.\n        nodes = np.concatenate(([-1.0], np.sort(interior_nodes), [1.0]))\n        \n        # Compute GLL weights\n        # w_i = 2 / (N*(N+1) * L_N(x_i)^2)\n        weights = 2.0 / (N * (N + 1.0) * (L_N(nodes)**2))\n        \n        # Step 2: Assemble the differentiation matrix D\n        # D_ij = l_j'(x_i)\n        D = np.zeros((N + 1, N + 1))\n        L_N_vals_at_nodes = L_N(nodes)\n        \n        for i in range(N + 1):\n            for j in range(N + 1):\n                if i == j:\n                    if i == 0:\n                        D[i, j] = -N * (N + 1) / 4.0\n                    elif i == N:\n                        D[i, j] = N * (N + 1) / 4.0\n                    else:\n                        D[i, j] = 0.0\n                else:\n                    D[i, j] = L_N_vals_at_nodes[i] / (L_N_vals_at_nodes[j] * (nodes[i] - nodes[j]))\n\n        # Step 3: Assemble Mass and Stiffness matrices M and K\n        # The collocated mass matrix M is diagonal with weights on the diagonal.\n        M = np.diag(weights)\n        # The stiffness matrix K is given by D^T * W * D, where W = M.\n        K = D.T @ M @ D\n        \n        # Step 4: Impose homogeneous Dirichlet boundary conditions.\n        # This is done by taking the interior submatrices (indices 1 to N-1).\n        if N > 1:\n            M_int = M[1:-1, 1:-1]\n            K_int = K[1:-1, 1:-1]\n        else: # Trivial case for N=1 (no interior nodes)\n            M_int = np.array([])\n            K_int = np.array([])\n        \n        # Step 5: Compute eigenvalues of M_int and K_int\n        # Eigenvalues of M_int are its diagonal entries as it's a diagonal matrix.\n        if N > 1:\n            eig_M_int = np.diag(M_int)\n            min_eig_M = np.min(eig_M_int)\n            max_eig_M = np.max(eig_M_int)\n\n            # Eigenvalues of K_int (symmetric matrix)\n            eig_K_int = np.linalg.eigvalsh(K_int)\n            min_eig_K = np.min(eig_K_int)\n            max_eig_K = np.max(eig_K_int)\n\n            # Step 6: Compute generalized eigenvalues\n            # Solve K_int * v = lambda * M_int * v\n            # scipy.linalg.eigh is suitable for symmetric/Hermitian generalized eigenvalue problems.\n            gen_eigvals = eigh(K_int, M_int, eigvals_only=True)\n            max_gen_eig = np.max(gen_eigvals)\n            \n            # Step 7: Compute the Forward Euler time step restriction\n            dt_max = 2.0 / max_gen_eig\n        else: # Handle N=1 case where matrices are empty\n            min_eig_M, max_eig_M, min_eig_K, max_eig_K, max_gen_eig, dt_max = (np.nan,)*6\n            \n        case_results = [\n            float(N),\n            min_eig_M,\n            max_eig_M,\n            min_eig_K,\n            max_eig_K,\n            max_gen_eig,\n            dt_max\n        ]\n        \n        # Format the sublist without spaces\n        formatted_sublist = f\"[{','.join(map(str, case_results))}]\"\n        all_results.append(formatted_sublist)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n\n```", "id": "2597942"}]}