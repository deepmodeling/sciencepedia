{"hands_on_practices": [{"introduction": "The power of Polynomial Chaos Expansions lies in choosing the right analytical tools for the job. For optimal convergence, the polynomial basis must be orthogonal with respect to the probability measure of the underlying random inputs, a principle encapsulated in the Wiener-Askey scheme. This practice problem [@problem_id:2589475] challenges you to apply this core principle to a lognormal random variable, a common model for strictly positive uncertain parameters, forcing a distinction between the variable itself and its underlying Gaussian 'germ'.", "problem": "Consider a scalar elliptic model problem in the Finite Element Method (FEM): find a random solution field $u(\\mathbf{x},\\omega)$ such that\n$$\n-\\nabla\\cdot\\big(a(\\mathbf{x},\\omega)\\,\\nabla u(\\mathbf{x},\\omega)\\big)=f(\\mathbf{x})\\quad\\text{in }D,\\qquad u(\\mathbf{x},\\omega)=0\\quad\\text{on }\\partial D,\n$$\nwhere $D\\subset\\mathbb{R}^d$ is a bounded Lipschitz domain, $f$ is a deterministic load, and the scalar diffusion coefficient is spatially uniform but uncertain, modeled as a single lognormal random variable\n$$\na(\\mathbf{x},\\omega)\\equiv X(\\omega)=\\exp\\big(\\sigma Z(\\omega)+\\mu\\big),\n$$\nwith $Z\\sim\\mathcal{N}(0,1)$, and with given parameters $\\mu\\in\\mathbb{R}$ and $\\sigma>0$. You wish to construct a Polynomial Chaos Expansion (PCE) of a scalar Quantity of Interest (QoI) $Q(\\omega)=\\mathcal{Q}(u(\\cdot,\\omega))$, and to approximate expectations by Stochastic Collocation (SC).\n\nFrom first principles, recall that a PCE employs a basis of polynomials orthogonal with respect to the law of the underlying random germ and that SC should use quadrature rules consistent with that germ. The exponential mapping from $Z$ to $X$ is highly nonlinear.\n\nWhich option identifies a natural polynomial basis for the PCE and a principled way to handle the exponential nonlinearity in both stochastic Galerkin and stochastic collocation formulations?\n\nA. Use generalized Laguerre polynomials in the variable $X$ because $X>0$, and tame the exponential nonlinearity by a first-order Taylor linearization of $\\exp(\\sigma Z+\\mu)$ about its mean.\n\nB. Use Hermite polynomials in the underlying standard Gaussian variable $Z$, and represent the exponential mapping by its Hermite series (thereby enabling exact algebra in stochastic Galerkin and Gaussian-weighted quadrature in SC, e.g., Gauss–Hermite nodes in $Z$).\n\nC. Map $X$ affinely to an interval and use Legendre polynomials in that mapped variable because Legendre polynomials are bounded, and handle the exponential nonlinearity by resampling Monte Carlo realizations at each collocation node.\n\nD. Use Chebyshev polynomials in $X$ and mitigate the exponential nonlinearity by an isoprobabilistic transform that maps the lognormal law to a uniform law.\n\nE. Use Hermite polynomials in $Z$ for the PCE but employ Gauss–Laguerre abscissae in $X$ for collocation and integration, since $X>0$.\n\nSelect the best answer.", "solution": "The analysis of the problem will proceed in two stages. First, the problem statement itself shall be validated for scientific and logical integrity. Second, upon confirmation of its validity, a solution will be derived from fundamental principles, followed by a critical evaluation of each presented option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equation**: A scalar elliptic partial differential equation (PDE) is given by $-\\nabla\\cdot\\big(a(\\mathbf{x},\\omega)\\,\\nabla u(\\mathbf{x},\\omega)\\big)=f(\\mathbf{x})$ in a domain $D$.\n*   **Boundary Conditions**: Homogeneous Dirichlet boundary conditions are specified, $u(\\mathbf{x},\\omega)=0$ on the boundary $\\partial D$.\n*   **Domain**: $D \\subset \\mathbb{R}^d$ is a bounded Lipschitz domain.\n*   **Forcing Term**: The term $f(\\mathbf{x})$ is a deterministic function.\n*   **Diffusion Coefficient**: The coefficient $a(\\mathbf{x},\\omega)$ is spatially uniform but uncertain, defined as $a(\\mathbf{x},\\omega) \\equiv X(\\omega)=\\exp\\big(\\sigma Z(\\omega)+\\mu\\big)$.\n*   **Random Input**: The uncertainty is driven by a single standard normal random variable, $Z(\\omega) \\sim \\mathcal{N}(0,1)$. This implies that $X(\\omega)$ is a lognormal random variable.\n*   **Parameters**: The parameters $\\mu \\in \\mathbb{R}$ and $\\sigma > 0$ are given constants.\n*   **Objective**: To construct a Polynomial Chaos Expansion (PCE) for a scalar Quantity of Interest (QoI), $Q(\\omega)=\\mathcal{Q}(u(\\cdot,\\omega))$, and to approximate expectations using Stochastic Collocation (SC).\n*   **Guiding Principles**: The problem notes that a PCE basis should be orthogonal with respect to the law of the underlying random \"germ,\" and that SC quadrature should be consistent with this germ. The exponential mapping from $Z$ to $X$ is highlighted as a key nonlinearity.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is scrutinized against the validation criteria:\n\n*   **Scientific Grounding**: The problem is a canonical example in the field of Uncertainty Quantification (UQ). The model—an elliptic PDE with a random coefficient—is fundamental in many areas of physics and engineering. The lognormal model for the diffusion coefficient is a common and appropriate choice for a parameter that must remain strictly positive. The methods mentioned, PCE and SC, are standard and well-established techniques for propagating uncertainty through computational models. The problem is scientifically sound.\n*   **Well-Posedness**: The question asks for the \"natural\" polynomial basis and a \"principled\" way to handle the nonlinearity. In the context of PCE, these terms have precise mathematical meaning. The \"natural\" basis refers to the family of orthogonal polynomials corresponding to the probability measure of the input random variable, as per the Wiener-Askey scheme. A \"principled\" method refers to a mathematically rigorous and computationally efficient approach, as opposed to an ad-hoc or poorly converging one. A unique and well-defined answer exists based on the theory of spectral methods for UQ.\n*   **Objectivity and Completeness**: The problem is stated with objective mathematical language. All necessary information to answer the conceptual question is provided. The definitions of the model and the random input are unambiguous.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. It is a well-posed, scientifically sound, and standard problem in computational mathematics and engineering. The analysis will proceed to derive the correct solution and evaluate the options.\n\n### Solution and Option Analysis\n\nThe fundamental principle of Polynomial Chaos Expansions is to represent a random quantity as a spectral expansion in a basis of polynomials that are orthogonal with respect to the probability measure of the underlying random inputs. This choice yields optimal (spectral) convergence rates for the expansion.\n\n1.  **Identification of the Random Germ and Orthogonal Basis**: The source of all randomness in the problem is the standard normal random variable $Z(\\omega) \\sim \\mathcal{N}(0,1)$. This is the \"random germ.\" The probability density function (PDF) of $Z$ is the Gaussian function $\\phi(z) = (2\\pi)^{-1/2}\\exp(-z^2/2)$. The family of polynomials that are orthogonal with respect to the Gaussian weighting function $\\exp(-z^2/2)$ are the **Hermite polynomials**, denoted $\\{H_k(z)\\}_{k=0}^\\infty$. Therefore, any square-integrable functional of $Z$, including the solution $u(\\mathbf{x}, Z(\\omega))$ and the QoI $Q(Z(\\omega))$, should be expanded in a basis of Hermite polynomials in the variable $Z$ for maximum efficiency:\n    $$ Q(\\omega) = Q(Z(\\omega)) \\approx \\sum_{k=0}^P q_k H_k(Z(\\omega)) $$\n\n2.  **Handling the Nonlinearity in Stochastic Galerkin (SG)**: In the SG method, the PCE for $u$ is substituted into the PDE, which is then projected onto each basis function $H_j(Z)$. This requires computing terms like $\\mathbb{E}[a(Z) \\nabla u_i(x) H_i(Z) \\cdot \\nabla H_j(Z)]$. The coefficient $a(Z) = \\exp(\\sigma Z + \\mu)$ is also a function of $Z$. The principled way to handle this is to expand $a(Z)$ in the same Hermite basis:\n    $$ a(Z) = \\sum_{k=0}^\\infty a_k H_k(Z) $$\n    The coefficients $a_k$ can be computed via projection. This allows the product of the random parts to be computed systematically using the known triple-product integrals $\\mathbb{E}[H_i H_j H_k]$. This approach fully incorporates the nonlinearity into the spectral representation.\n\n3.  **Handling the Nonlinearity in Stochastic Collocation (SC)**: The SC method is a non-intrusive approach. It involves solving the deterministic PDE at a specific set of points, or \"nodes,\" in the random space. To achieve spectral accuracy for integration and interpolation of functions of a Gaussian variable, the nodes must be chosen as the roots of a high-order Hermite polynomial. This leads to the **Gauss-Hermite quadrature** rule. The procedure is:\n    *   Choose a set of Gauss-Hermite nodes $\\{z_j\\}_{j=1}^M$ in the $Z$-space.\n    *   For each node $z_j$, evaluate the diffusion coefficient *exactly*: $a_j = \\exp(\\sigma z_j + \\mu)$.\n    *   Solve the deterministic PDE for each $a_j$ to obtain a set of solutions $u_j(\\mathbf{x})$.\n    *   Compute the QoI for each solution: $Q_j = \\mathcal{Q}(u_j)$.\n    *   The statistics of the QoI (e.g., expectation) are then computed using the Gauss-Hermite quadrature formula $\\mathbb{E}[Q] \\approx \\sum_{j=1}^M w_j Q_j$, where $w_j$ are the corresponding weights.\n    In this method, the exponential nonlinearity is not approximated; it is evaluated exactly at the chosen collocation points.\n\nThis combined strategy—using Hermite polynomials for the basis and Gauss-Hermite quadrature for collocation/integration—is the standard, principled, and most efficient approach for this problem.\n\n**Evaluation of Options:**\n\n**A. Use generalized Laguerre polynomials in the variable $X$ because $X>0$, and tame the exponential nonlinearity by a first-order Taylor linearization of $\\exp(\\sigma Z+\\mu)$ about its mean.**\nGeneralized Laguerre polynomials are orthogonal with respect to a gamma distribution measure ($w(x) = x^\\alpha e^{-x}$ on $x \\in (0, \\infty)$), not a lognormal one. This choice of basis is incorrect and will result in poor convergence. Additionally, Taylor linearization is a crude approximation that fails to capture the significant nonlinearity, especially for large $\\sigma$. This approach is not principled.\n**Verdict: Incorrect.**\n\n**B. Use Hermite polynomials in the underlying standard Gaussian variable $Z$, and represent the exponential mapping by its Hermite series (thereby enabling exact algebra in stochastic Galerkin and Gaussian-weighted quadrature in SC, e.g., Gauss–Hermite nodes in $Z$).**\nThis option correctly identifies the random germ $Z$ and the corresponding orthogonal basis (Hermite polynomials). It correctly describes the standard procedure for both stochastic Galerkin (expressing the coefficient in a Hermite series) and stochastic collocation (using Gauss-Hermite quadrature/nodes in the $Z$ variable). This is the canonical and most efficient approach.\n**Verdict: Correct.**\n\n**C. Map $X$ affinely to an interval and use Legendre polynomials in that mapped variable because Legendre polynomials are bounded, and handle the exponential nonlinearity by resampling Monte Carlo realizations at each collocation node.**\nThe lognormal variable $X$ lives on the unbounded domain $(0, \\infty)$. An affine map to a finite interval requires truncating the distribution, introducing error. The resulting PDF on the truncated interval would not be uniform, making Legendre polynomials a poor choice of basis. The argument about boundedness of Legendre polynomials is irrelevant. The phrase \"resampling Monte Carlo realizations at each collocation node\" is nonsensical; it conflates the deterministic nature of collocation with the random sampling of Monte Carlo.\n**Verdict: Incorrect.**\n\n**D. Use Chebyshev polynomials in $X$ and mitigate the exponential nonlinearity by an isoprobabilistic transform that maps the lognormal law to a uniform law.**\nThis option is confused. An isoprobabilistic (Rosenblatt) transform would map the lognormal variable $X$ not to a variable for which Chebyshev polynomials are orthogonal, but to a uniform variable $U \\sim \\mathcal{U}[0,1]$. For a uniform variable, Legendre polynomials are the natural choice. Using Chebyshev polynomials in the original variable $X$ is baseless. While the idea of an isoprobabilistic transform is a valid UQ technique, working directly with the Gaussian germ $Z$ is more straightforward and natural for this problem. The statement as written is contradictory.\n**Verdict: Incorrect.**\n\n**E. Use Hermite polynomials in $Z$ for the PCE but employ Gauss–Laguerre abscissae in $X$ for collocation and integration, since $X>0$.**\nThis option correctly identifies the PCE basis (Hermite polynomials in $Z$). However, it proposes a completely inconsistent integration scheme. The choice of quadrature rule must match the probability measure of the integration variable. Since the expansion and integration are performed with respect to the Gaussian measure of $Z$, Gauss-Hermite quadrature in the $Z$-space is required. Using Gauss-Laguerre quadrature in the $X$-space is incorrect, being based on the flawed reasoning that the domain $X \\in (0, \\infty)$ implies a Laguerre-related measure, which is false.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "2589475"}, {"introduction": "Once an appropriate polynomial basis is chosen, the stochastic Galerkin method provides an intrusive framework for solving stochastic PDEs. By projecting the governing equations onto the chaos basis, we transform the stochastic problem into a larger, coupled system of deterministic equations for the PCE coefficients. This exercise [@problem_id:2589428] offers hands-on experience with this fundamental procedure, guiding you through the assembly of the coupled system for a 1D diffusion problem and revealing how uncertainty in a model parameter manifests as a specific coupling structure in the final algebraic system.", "problem": "Consider the one-dimensional diffusion equation on the domain $[0,1]$ with a random diffusion coefficient and homogeneous Dirichlet boundary conditions:\n$$\n-\\frac{d}{dx}\\!\\left(a(x,\\xi)\\,\\frac{du(x,\\xi)}{dx}\\right) \\,=\\, f(x,\\xi), \\quad x \\in (0,1), \\qquad u(0,\\xi)=0,\\; u(1,\\xi)=0,\n$$\nwhere the random input is parameterized by a single standard normal random variable $\\xi \\sim \\mathcal{N}(0,1)$. The coefficient is affine in $\\xi$:\n$$\na(x,\\xi) \\,=\\, a_{0}(x) + a_{1}(x)\\,\\xi,\n$$\nwith given deterministic functions $a_{0}(x)$ and $a_{1}(x)$. Use a stochastic Galerkin approach with a Polynomial Chaos Expansion (PCE) of degree $p=2$ based on the orthonormal Hermite polynomials with respect to the standard normal density:\n$$\n\\psi_{0}(\\xi)=1,\\qquad \\psi_{1}(\\xi)=\\xi,\\qquad \\psi_{2}(\\xi)=\\frac{\\xi^{2}-1}{\\sqrt{2}},\n$$\nso that $\\mathbb{E}[\\psi_{i}(\\xi)\\psi_{j}(\\xi)]=\\delta_{ij}$ for all $i,j \\in \\{0,1,2\\}$.\n\nDiscretize the spatial domain with linear finite elements on a uniform mesh of $2$ elements with nodes at $x_{0}=0$, $x_{1}=\\tfrac{1}{2}$, and $x_{2}=1$. Enforce the homogeneous Dirichlet boundary conditions strongly at $x=0$ and $x=1$, so that only the interior node at $x=\\tfrac{1}{2}$ remains as an unknown in the spatial discretization for each PCE mode. Let $\\varphi_{1}(x)$ be the associated global hat function for the interior node.\n\nStarting from the weak form of the diffusion equation and the definitions above, perform the following:\n\n- Derive the coupled stochastic Galerkin finite element system in block form for the PCE coefficients of the solution, clearly identifying the stochastic coupling structure induced by the expansion of $a(x,\\xi)$.\n- Assemble the right-hand side blocks for the particular forcing\n$$\nf(x,\\xi)=f_{0}(x)+f_{1}(x)\\,\\xi,\\qquad f_{0}(x)=1,\\qquad f_{1}(x)=x.\n$$\n\nYour derivation must start from the weak form definition and the orthonormality of $\\{\\psi_{k}\\}_{k=0}^{2}$ and must not assume any pre-stated coupling identities. As your final result, report the exact value of the single degree-of-freedom entry of the right-hand side corresponding to chaos mode $k=1$ (that is, the entry obtained by testing with $\\varphi_{1}(x)\\psi_{1}(\\xi)$ after enforcing the boundary conditions).", "solution": "The problem requires the derivation of the stochastic Galerkin finite element system for a one-dimensional diffusion equation with a random coefficient, and the calculation of a specific entry in the resulting right-hand side vector.\n\nThe governing stochastic partial differential equation is:\n$$\n-\\frac{d}{dx}\\left(a(x,\\xi)\\,\\frac{du(x,\\xi)}{dx}\\right) \\,=\\, f(x,\\xi), \\quad x \\in (0,1)\n$$\nwith homogeneous Dirichlet boundary conditions $u(0,\\xi)=0$ and $u(1,\\xi)=0$. The analysis begins with the weak formulation. We seek a solution $u(x,\\xi)$ from a suitable function space such that for all test functions $v(x,\\xi)$ from the same space (satisfying the boundary conditions), the following holds:\n$$\n\\int_{0}^{1} a(x,\\xi) \\frac{du(x,\\xi)}{dx} \\frac{dv(x,\\xi)}{dx} dx - \\int_{0}^{1} f(x,\\xi) v(x,\\xi) dx = 0\n$$\n\nThe stochastic Galerkin method projects the problem onto a finite-dimensional subspace of the stochastic space. We use a Polynomial Chaos Expansion (PCE) of degree $p=2$. The solution $u(x,\\xi)$ is approximated as:\n$$\nu(x,\\xi) \\approx u^{(2)}(x,\\xi) = \\sum_{j=0}^{2} u_{j}(x) \\psi_{j}(\\xi)\n$$\nwhere $\\{u_{j}(x)\\}_{j=0}^{2}$ are deterministic coefficient functions to be determined, and $\\{\\psi_{j}(\\xi)\\}_{j=0}^{2}$ are the given orthonormal Hermite polynomials with respect to the standard normal measure. The random coefficient $a(x,\\xi)$ and forcing term $f(x,\\xi)$ are given as affine expansions:\n$$\na(x,\\xi) = a_{0}(x) + a_{1}(x)\\xi = a_0(x)\\psi_0(\\xi) + a_1(x)\\psi_1(\\xi)\n$$\n$$\nf(x,\\xi) = f_{0}(x) + f_{1}(x)\\xi = f_0(x)\\psi_0(\\xi) + f_1(x)\\psi_1(\\xi)\n$$\nThe test functions $v(x,\\xi)$ are chosen from the same approximation space, specifically in the form $v(x,\\xi) = w(x)\\psi_{k}(\\xi)$ for $k \\in \\{0, 1, 2\\}$, where $w(x)$ is a spatial test function from the finite element space.\n\nSubstituting the expansions into the weak form and applying the Galerkin projection in the stochastic domain by taking the expectation $\\mathbb{E}[\\cdot]$ yields a system of coupled equations. For each $k \\in \\{0, 1, 2\\}$:\n$$\n\\mathbb{E}\\left[ \\int_{0}^{1} \\left( \\sum_{j=0}^{2} a_{j,pce}(x)\\psi_j(\\xi) \\right) \\left( \\sum_{i=0}^{2} \\frac{du_i(x)}{dx} \\psi_i(\\xi) \\right) \\left( \\frac{dw(x)}{dx}\\psi_k(\\xi) \\right) dx \\right] = \\mathbb{E}\\left[ \\int_{0}^{1} \\left( \\sum_{j=0}^{1} f_j(x)\\psi_j(\\xi) \\right) w(x) \\psi_k(\\xi) dx \\right]\n$$\nHere, we have written $a(x, \\xi) = a_0(x)\\psi_0(\\xi) + a_1(x)\\psi_1(\\xi)$, so $a_{0,pce}=a_0$ and $a_{1,pce}=a_1$. For brevity, we will use the original notation. Moving the expectation operator inside the integral and regrouping terms gives:\n$$\n\\sum_{i=0}^{2} \\int_{0}^{1} \\mathbb{E}\\left[ a(x,\\xi) \\psi_i(\\xi) \\psi_k(\\xi) \\right] \\frac{du_i(x)}{dx} \\frac{dw(x)}{dx} dx = \\int_{0}^{1} \\mathbb{E}\\left[ f(x,\\xi) \\psi_k(\\xi) \\right] w(x) dx\n$$\nThe expectation on the left hand side is:\n$$\n\\mathbb{E}[a(x,\\xi) \\psi_i(\\xi) \\psi_k(\\xi)] = \\mathbb{E}[(a_0(x) + a_1(x)\\xi) \\psi_i(\\xi) \\psi_k(\\xi)] = a_0(x) \\mathbb{E}[\\psi_i\\psi_k] + a_1(x) \\mathbb{E}[\\xi\\psi_i\\psi_k]\n$$\nBy orthonormality, $\\mathbb{E}[\\psi_i\\psi_k] = \\delta_{ik}$. We define the coupling coefficients $C_{ik} = \\mathbb{E}[\\xi\\psi_i\\psi_k]$. Using the given polynomials $\\psi_{0}=1$, $\\psi_{1}=\\xi$, $\\psi_{2}=(\\xi^{2}-1)/\\sqrt{2}$ and moments of $\\xi \\sim \\mathcal{N}(0,1)$ ($\\mathbb{E}[\\xi]=0, \\mathbb{E}[\\xi^2]=1, \\mathbb{E}[\\xi^3]=0, \\mathbb{E}[\\xi^4]=3$), we compute:\n$C_{00} = \\mathbb{E}[\\xi] = 0$\n$C_{01} = \\mathbb{E}[\\xi^2] = 1$\n$C_{02} = \\mathbb{E}[\\xi(\\xi^2-1)/\\sqrt{2}] = (\\mathbb{E}[\\xi^3]-\\mathbb{E}[\\xi])/\\sqrt{2} = 0$\n$C_{11} = \\mathbb{E}[\\xi^3] = 0$\n$C_{12} = \\mathbb{E}[\\xi^2(\\xi^2-1)/\\sqrt{2}] = (\\mathbb{E}[\\xi^4]-\\mathbb{E}[\\xi^2])/\\sqrt{2} = (3-1)/\\sqrt{2} = \\sqrt{2}$\n$C_{22} = \\mathbb{E}[\\xi(\\xi^2-1)^2/2] = \\frac{1}{2}\\mathbb{E}[\\xi^5-2\\xi^3+\\xi] = 0$\nDue to symmetry $C_{ik}=C_{ki}$. The coupled system for the coefficient functions $u_i(x)$ is:\n$$\n\\sum_{i=0}^{2} \\int_{0}^{1} \\left( a_0(x)\\delta_{ik} + a_1(x)C_{ik} \\right) \\frac{du_i(x)}{dx} \\frac{dw(x)}{dx} dx = \\int_{0}^{1} \\mathbb{E}[f(x,\\xi)\\psi_k(\\xi)] w(x) dx, \\quad k=0,1,2\n$$\nNext, we apply the finite element method in space. With a $2$-element mesh and nodes at $x_0=0, x_1=1/2, x_2=1$, strong enforcement of homogeneous Dirichlet boundary conditions leaves a single degree of freedom associated with the interior node $x_1=1/2$. The corresponding global basis function is the hat function $\\varphi_1(x)$:\n$$\n\\varphi_1(x) =\n\\begin{cases}\n2x & x \\in [0, 1/2] \\\\\n2(1-x) & x \\in [1/2, 1] \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nEach coefficient function $u_i(x)$ is approximated as $u_i(x) \\approx U_i \\varphi_1(x)$, where $U_i$ is the unknown scalar value of the $i$-th PCE mode at node $x_1$. The test function is chosen as $w(x)=\\varphi_1(x)$. Substituting into the system gives the final algebraic system $\\mathbf{M} \\mathbf{U} = \\mathbf{F}$ for the vector of unknowns $\\mathbf{U} = [U_0, U_1, U_2]^T$. The entries of the matrix $\\mathbf{M}$ are:\n$$\nM_{ki} = \\int_{0}^{1} \\left( a_0(x)\\delta_{ik} + a_1(x)C_{ik} \\right) \\left(\\frac{d\\varphi_1}{dx}\\right)^2 dx = K_0 \\delta_{ik} + K_1 C_{ik}\n$$\nwhere $K_0 = \\int_0^1 a_0(x) (\\frac{d\\varphi_1}{dx})^2 dx$ and $K_1 = \\int_0^1 a_1(x) (\\frac{d\\varphi_1}{dx})^2 dx$. The derivative of the hat function is $\\frac{d\\varphi_1}{dx} = 2$ on $(0,1/2)$ and $\\frac{d\\varphi_1}{dx} = -2$ on $(1/2,1)$.\nThe system matrix $\\mathbf{M}$ is:\n$$\n\\mathbf{M} = \\begin{pmatrix} K_0 & K_1 & 0 \\\\ K_1 & K_0 & \\sqrt{2}K_1 \\\\ 0 & \\sqrt{2}K_1 & K_0 \\end{pmatrix}\n$$\nThis matrix shows the stochastic coupling structure. The diagonal blocks correspond to the uncoupled problem, while the off-diagonal terms, proportional to $K_1$ (from $a_1(x)$) and the coefficients $C_{ik}$, represent the coupling between the chaos modes.\n\nThe problem asks for the component of the right-hand side vector $\\mathbf{F}$ corresponding to chaos mode $k=1$. The components of $\\mathbf{F}$ are given by:\n$$\nF_k = \\int_{0}^{1} \\mathbb{E}[f(x,\\xi)\\psi_k(\\xi)] \\varphi_1(x) dx\n$$\nGiven $f(x,\\xi) = f_0(x) + f_1(x)\\xi = 1+x\\xi$, we calculate the integrand for $k=1$:\n$$\n\\mathbb{E}[f(x,\\xi)\\psi_1(\\xi)] = \\mathbb{E}[(1+x\\xi)\\xi] = \\mathbb{E}[\\xi] + x\\mathbb{E}[\\xi^2] = 0 + x(1) = x\n$$\nTherefore, the desired entry is:\n$$\nF_1 = \\int_{0}^{1} x \\varphi_1(x) dx\n$$\nWe compute this integral by splitting it over the two elements of the mesh:\n$$\nF_1 = \\int_{0}^{1/2} x(2x)dx + \\int_{1/2}^{1} x(2(1-x))dx\n$$\nEvaluating the first integral:\n$$\n\\int_{0}^{1/2} 2x^2 dx = \\left[ \\frac{2x^3}{3} \\right]_{0}^{1/2} = \\frac{2}{3}\\left(\\frac{1}{2}\\right)^3 = \\frac{2}{3} \\cdot \\frac{1}{8} = \\frac{1}{12}\n$$\nEvaluating the second integral:\n$$\n\\int_{1/2}^{1} (2x-2x^2)dx = \\left[ x^2 - \\frac{2x^3}{3} \\right]_{1/2}^{1} = \\left(1^2 - \\frac{2(1)^3}{3}\\right) - \\left(\\left(\\frac{1}{2}\\right)^2 - \\frac{2(1/2)^3}{3}\\right)\n$$\n$$\n= \\left(1-\\frac{2}{3}\\right) - \\left(\\frac{1}{4} - \\frac{2/8}{3}\\right) = \\frac{1}{3} - \\left(\\frac{1}{4} - \\frac{1}{12}\\right) = \\frac{1}{3} - \\left(\\frac{3-1}{12}\\right) = \\frac{1}{3} - \\frac{2}{12} = \\frac{1}{3} - \\frac{1}{6} = \\frac{1}{6}\n$$\nSumming the results from the two elements:\n$$\nF_1 = \\frac{1}{12} + \\frac{1}{6} = \\frac{1}{12} + \\frac{2}{12} = \\frac{3}{12} = \\frac{1}{4}\n$$\nThe value of the right-hand side entry corresponding to chaos mode $k=1$ is $\\frac{1}{4}$.", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "2589428"}, {"introduction": "In contrast to intrusive methods, non-intrusive techniques like stochastic collocation estimate PCE coefficients by evaluating the model at a set of discrete points. While this avoids reformulating the governing equations, it introduces a new challenge: aliasing error, where unresolved high-order modes contaminate the estimates of low-order coefficients. This practice [@problem_id:2589464] delves into this critical numerical pitfall, asking you to explain its mechanism and derive the minimum quadrature exactness required to ensure accurate coefficient estimation, a crucial consideration for any practical application of stochastic collocation.", "problem": "A parametric elliptic boundary value problem is solved by the Finite Element Method (FEM) for each realization of a random input vector $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$ with joint probability density $\\rho(\\boldsymbol{\\xi})$. Let $u(\\boldsymbol{\\xi})$ denote a scalar Quantity of Interest (QoI) extracted from the FEM solution. Consider an expansion of $u(\\boldsymbol{\\xi})$ in a generalized Polynomial Chaos Expansion (PCE) with orthonormal basis $\\{\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\}_{\\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d}}$ with respect to $\\rho(\\boldsymbol{\\xi})$, and truncate this expansion to the total-degree $p$ multi-index set $\\Lambda_{p} := \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} : |\\boldsymbol{\\alpha}| \\le p\\}$, where $|\\boldsymbol{\\alpha}| := \\sum_{i=1}^{d} \\alpha_{i}$. The coefficient of mode $\\boldsymbol{\\alpha} \\in \\Lambda_{p}$ is defined by the orthogonal projection $c_{\\boldsymbol{\\alpha}} := \\int_{\\mathbb{R}^{d}} u(\\boldsymbol{\\xi}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) \\rho(\\boldsymbol{\\xi}) \\,\\mathrm{d}\\boldsymbol{\\xi}$.\n\nIn a non-intrusive stochastic collocation setting, one estimates $c_{\\boldsymbol{\\alpha}}$ using a quadrature rule $\\{(\\boldsymbol{\\xi}^{(q)}, w^{(q)})\\}_{q=1}^{Q}$ that is exact for all multivariate polynomials of total degree up to an integer $r \\ge 0$. That is, for any polynomial $p(\\boldsymbol{\\xi})$ of total degree $\\le r$,\n$\\int_{\\mathbb{R}^{d}} p(\\boldsymbol{\\xi}) \\rho(\\boldsymbol{\\xi}) \\,\\mathrm{d}\\boldsymbol{\\xi} = \\sum_{q=1}^{Q} w^{(q)} p(\\boldsymbol{\\xi}^{(q)})$.\nThe non-intrusive estimator is $\\widehat{c}_{\\boldsymbol{\\alpha}} := \\sum_{q=1}^{Q} w^{(q)} u(\\boldsymbol{\\xi}^{(q)}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)})$.\n\nStarting from the definitions of orthogonality and projection, explain the mechanism by which aliasing arises in $\\widehat{c}_{\\boldsymbol{\\alpha}}$ when the quadrature exactness parameter $r$ is insufficient. Then, by requiring that the discrete inner products mimic the continuous orthogonality for all products $\\Psi_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\beta}}$ with $|\\boldsymbol{\\alpha}| \\le p$ and $|\\boldsymbol{\\beta}| \\le p$, derive the minimal total polynomial degree $r$ (expressed as a function of $p$) that guarantees no aliasing in the non-intrusive estimation of all coefficients $c_{\\boldsymbol{\\alpha}}$ with $|\\boldsymbol{\\alpha}| \\le p$.\n\nExpress your final answer as a single closed-form expression in terms of $p$. No units are required.", "solution": "The problem requires an explanation of the aliasing mechanism in non-intrusive Polynomial Chaos Expansion (PCE) coefficient estimation and the derivation of a minimal quadrature exactness to prevent it under specific conditions.\n\nFirst, we analyze the source of aliasing error. The exact coefficient $c_{\\boldsymbol{\\alpha}}$ for the mode $\\boldsymbol{\\alpha}$ is given by the orthogonal projection of the Quantity of Interest (QoI) $u(\\boldsymbol{\\xi})$ onto the basis polynomial $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$. This projection is defined by the inner product with respect to the probability measure $\\rho(\\boldsymbol{\\xi})\\mathrm{d}\\boldsymbol{\\xi}$:\n$$c_{\\boldsymbol{\\alpha}} := \\langle u, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\int_{\\mathbb{R}^{d}} u(\\boldsymbol{\\xi}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) \\rho(\\boldsymbol{\\xi}) \\,\\mathrm{d}\\boldsymbol{\\xi}$$\nThe non-intrusive estimator, $\\widehat{c}_{\\boldsymbol{\\alpha}}$, replaces this continuous integral with a discrete sum based on a quadrature rule $\\{(\\boldsymbol{\\xi}^{(q)}, w^{(q)})\\}_{q=1}^{Q}$:\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} := \\sum_{q=1}^{Q} w^{(q)} u(\\boldsymbol{\\xi}^{(q)}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)})$$\nThis estimator can be viewed as a discrete inner product, which we denote by $\\langle f, g \\rangle_Q := \\sum_{q=1}^{Q} w^{(q)} f(\\boldsymbol{\\xi}^{(q)}) g(\\boldsymbol{\\xi}^{(q)})$. Thus, $\\widehat{c}_{\\boldsymbol{\\alpha}} = \\langle u, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$.\n\nTo understand the error, we substitute the full PCE representation of the QoI, $u(\\boldsymbol{\\xi}) = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})$, into the expression for $\\widehat{c}_{\\boldsymbol{\\alpha}}$:\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} = \\sum_{q=1}^{Q} w^{(q)} \\left( \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi}^{(q)}) \\right) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)})$$\nBy interchanging the order of summation, which is permissible, we obtain:\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\left( \\sum_{q=1}^{Q} w^{(q)} \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi}^{(q)}) \\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}^{(q)}) \\right) = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$$\nFor comparison, the exact coefficient $c_{\\boldsymbol{\\alpha}}$ is recovered from the full expansion using the *continuous* orthogonality of the basis, $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$:\n$$c_{\\boldsymbol{\\alpha}} = \\langle u, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\left\\langle \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\right\\rangle = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\sum_{\\boldsymbol{\\beta} \\in \\mathbb{N}_{0}^{d}} c_{\\boldsymbol{\\beta}} \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = c_{\\boldsymbol{\\alpha}}$$\nThe discrepancy between $\\widehat{c}_{\\boldsymbol{\\alpha}}$ and $c_{\\boldsymbol{\\alpha}}$ arises when the discrete inner product $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$ does not equal the continuous inner product $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$. The quadrature rule is exact for any polynomial integrand of total degree up to $r$. The integrand for the inner product $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle$ is the product $\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$. Since $\\Psi_{\\boldsymbol{\\gamma}}$ is a polynomial of total degree $|\\boldsymbol{\\gamma}|$, the degree of this product is $|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|$.\nIf $|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}| > r$, the quadrature rule may not be exact, and consequently $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$ may not equal $\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$. In this case, the expression for the estimated coefficient becomes:\n$$\\widehat{c}_{\\boldsymbol{\\alpha}} = c_{\\boldsymbol{\\alpha}} \\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q + \\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{\\alpha}} c_{\\boldsymbol{\\beta}} \\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$$\nEven if $|\\boldsymbol{\\alpha}|+|\\boldsymbol{\\alpha}| \\le r$ (ensuring $\\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q = 1$), a non-zero value for $\\langle \\Psi_{\\boldsymbol{\\beta}}, \\Psi_{\\boldsymbol{\\alpha}} \\rangle_Q$ where $\\boldsymbol{\\beta} \\neq \\boldsymbol{\\alpha}$ means that the coefficient $c_{\\boldsymbol{\\beta}}$ erroneously contributes to the estimate of $c_{\\boldsymbol{\\alpha}}$. This phenomenon is called aliasing: higher-order or different-order modes \"fold over\" and contaminate the estimation of the target mode due to the insufficiency of the discrete sampling.\n\nNext, we derive the minimal quadrature exactness $r$ required to prevent aliasing under the conditions specified. The problem defines \"no aliasing\" for the coefficients $\\{c_{\\boldsymbol{\\alpha}}\\}_{|\\boldsymbol{\\alpha}| \\le p}$ by the strict requirement that the discrete inner products mimic continuous orthogonality for all basis functions within the truncated expansion of degree $p$. That is, we must enforce:\n$$\\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\beta}} \\rangle_Q = \\langle \\Psi_{\\boldsymbol{\\alpha}}, \\Psi_{\\boldsymbol{\\beta}} \\rangle = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$$\nfor all multi-indices $\\boldsymbol{\\alpha}$ and $\\boldsymbol{\\beta}$ in the set $\\Lambda_p = \\{\\boldsymbol{\\gamma} \\in \\mathbb{N}_0^d : |\\boldsymbol{\\gamma}| \\le p\\}$.\nFor the quadrature rule to exactly compute the integral defining the continuous inner product, the total degree of the integrand polynomial must not exceed the quadrature's degree of exactness, $r$. The integrand is $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) \\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})$. The total degree of this polynomial is:\n$$\\text{deg}(\\Psi_{\\boldsymbol{\\alpha}}\\Psi_{\\boldsymbol{\\beta}}) = \\text{deg}(\\Psi_{\\boldsymbol{\\alpha}}) + \\text{deg}(\\Psi_{\\boldsymbol{\\beta}}) = |\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|$$\nTo satisfy the no-aliasing condition for all specified pairs $(\\boldsymbol{\\alpha}, \\boldsymbol{\\beta})$, the quadrature degree $r$ must be greater than or equal to the maximum possible degree of these integrand products. We must therefore find the maximum value of $|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|$ over the allowed range for the multi-indices:\n$$\\max \\{|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}| \\;\\; | \\;\\; |\\boldsymbol{\\alpha}| \\le p \\text{ and } |\\boldsymbol{\\beta}| \\le p \\}$$\nThis maximum is achieved when $|\\boldsymbol{\\alpha}|$ and $|\\boldsymbol{\\beta}|$ are individually maximized. The maximum value for $|\\boldsymbol{\\alpha}|$ in the set $\\Lambda_p$ is $p$, and similarly, the maximum value for $|\\boldsymbol{\\beta}|$ is $p$.\nTherefore, the maximum value of the sum of the degrees is:\n$$\\max (|\\boldsymbol{\\alpha}| + |\\boldsymbol{\\beta}|) = p + p = 2p$$\nTo guarantee that the quadrature is exact for all products $\\Psi_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\beta}}$ with $|\\boldsymbol{\\alpha}| \\le p$ and $|\\boldsymbol{\\beta}| \\le p$, we must require the degree of exactness $r$ to satisfy $r \\ge 2p$.\nThe minimal integer value for $r$ that satisfies this condition is $2p$. This choice of $r$ ensures that for any two basis functions in the degree-$p$ expansion, their discrete inner product correctly evaluates to the Kronecker delta, thereby preventing aliasing from other modes *within the same degree-$p$ expansion*. It is important to note that this does not prevent aliasing from modes $\\boldsymbol{\\beta}$ with $|\\boldsymbol{\\beta}| > p$, as those could produce products $\\Psi_{\\boldsymbol{\\alpha}}\\Psi_{\\boldsymbol{\\beta}}$ of degree higher than $2p$. However, based on the problem's explicit requirement, this is the minimal value.", "answer": "$$\\boxed{2p}$$", "id": "2589464"}]}