{"hands_on_practices": [{"introduction": "The first step in applying the Method of Manufactured Solutions is to understand how to rigorously quantify the discrepancy between your numerical result and the known exact solution. This exercise provides a foundational practice by asking you to analytically compute the two most fundamental error norms in finite element analysis: the $L^2$-norm, which measures the average error, and the $H^1$-seminorm, which measures the error in the gradient. By working through this calculation for a hypothetical (and maximally incorrect) numerical outcome, you will build a concrete intuition for what these abstract error metrics represent and how they are used to validate a code's performance [@problem_id:2576838].", "problem": "You are verifying a two-dimensional finite element method (FEM) implementation for a Poisson problem using the method of manufactured solutions. Consider the boundary value problem with homogeneous Dirichlet conditions on the rectangular domain $\\Omega = (0,1)\\times(0,1)$:\n$a)$ Choose the manufactured solution $u_{m}(x,y) = \\sin(\\pi x)\\sin(2\\pi y)$ and define the volumetric source term $f$ and the boundary data so that $u_{m}$ is the exact solution of $-\\Delta u = f$ on $\\Omega$ with $u=g$ on $\\partial\\Omega$.\n$b)$ Suppose a numerical bug causes the computed finite element solution to be the identically zero function, i.e., $u_{h}(x,y)\\equiv 0$ on $\\Omega$. Compute the exact $L^{2}$-norm error and the exact $H^{1}$ seminorm error between $u_{m}$ and $u_{h}$ over $\\Omega$. Express your final answer as exact symbolic expressions without any rounding.\nReport the final answer as a row matrix containing, in order, the $L^{2}$-norm error and the $H^{1}$ seminorm error. No units are required.", "solution": "The problem statement is first subjected to a critical validation process.\n\n**Step 1: Extract Givens**\n- **Governing Equation**: The two-dimensional Poisson problem is $-\\Delta u = f$ on the domain $\\Omega$.\n- **Domain**: The domain is a unit square, $\\Omega = (0,1)\\times(0,1)$.\n- **Boundary Conditions**: Homogeneous Dirichlet conditions, $u=g$ on the boundary $\\partial\\Omega$.\n- **Part (a) Task**:\n  - **Manufactured Solution**: $u_{m}(x,y) = \\sin(\\pi x)\\sin(2\\pi y)$.\n  - **Objective**: Define the volumetric source term $f$ and boundary data $g$ such that $u_{m}$ is the exact solution.\n- **Part (b) Task**:\n  - **Numerical Solution**: A bug results in a computed solution $u_{h}(x,y)\\equiv 0$ on $\\Omega$.\n  - **Objective**: Compute the exact $L^{2}$-norm error, $\\|u_{m} - u_{h}\\|_{L^{2}(\\Omega)}$, and the exact $H^{1}$ seminorm error, $|u_{m} - u_{h}|_{H^{1}(\\Omega)}$.\n- **Reporting Format**: A row matrix containing the $L^{2}$-norm error and the $H^{1}$ seminorm error, in that order.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is analyzed for validity.\n- **Scientific Grounding**: The problem is well-grounded in the established mathematical fields of partial differential equations and numerical analysis. The method of manufactured solutions is a standard technique for code verification in scientific computing. The Poisson equation, $L^{2}$ norm, and $H^{1}$ seminorm are fundamental concepts.\n- **Well-Posedness**: The tasks are well-posed. Part $a)$ requires a direct calculation of the Laplacian of a given function to find the source term, a uniquely defined operation. The boundary data is found by evaluating the function on the boundary. Part $b)$ requires the calculation of two definite integrals representing standard functional norms. The functions are smooth and the domain is bounded, ensuring the integrals converge to unique, meaningful values.\n- **Objectivity**: The problem is stated using precise, objective mathematical language, free from ambiguity or subjective claims.\n- **Completeness and Consistency**: The problem is self-contained. All necessary information, including the domain, manufactured solution, and the form of the numerical solution, is provided. The mention of \"homogeneous Dirichlet conditions\" is consistent with the boundary data derived from the manufactured solution.\n\n**Step 3: Verdict and Action**\nThe problem is found to be scientifically sound, well-posed, objective, and complete. It is a standard exercise in the application of the method of manufactured solutions. Therefore, the problem is **valid**, and we proceed with the solution.\n\n**Solution Derivation**\n\n**Part (a): Determine Source Term and Boundary Data**\n\nThe manufactured solution is given as $u_{m}(x,y) = \\sin(\\pi x)\\sin(2\\pi y)$.\nTo find the source term $f$, we must compute the negative Laplacian of $u_{m}(x,y)$. The Laplacian is $\\Delta u_{m} = \\frac{\\partial^2 u_{m}}{\\partial x^2} + \\frac{\\partial^2 u_{m}}{\\partial y^2}$.\n\nFirst, we compute the partial derivatives with respect to $x$:\n$$ \\frac{\\partial u_{m}}{\\partial x} = \\pi \\cos(\\pi x)\\sin(2\\pi y) $$\n$$ \\frac{\\partial^2 u_{m}}{\\partial x^2} = -\\pi^2 \\sin(\\pi x)\\sin(2\\pi y) $$\n\nNext, we compute the partial derivatives with respect to $y$:\n$$ \\frac{\\partial u_{m}}{\\partial y} = 2\\pi \\sin(\\pi x)\\cos(2\\pi y) $$\n$$ \\frac{\\partial^2 u_{m}}{\\partial y^2} = -4\\pi^2 \\sin(\\pi x)\\sin(2\\pi y) $$\n\nSumming the second derivatives gives the Laplacian:\n$$ \\Delta u_{m} = -\\pi^2 \\sin(\\pi x)\\sin(2\\pi y) - 4\\pi^2 \\sin(\\pi x)\\sin(2\\pi y) = -5\\pi^2 \\sin(\\pi x)\\sin(2\\pi y) $$\n\nThe source term $f$ is defined by the governing equation $-\\Delta u = f$. Thus:\n$$ f(x,y) = -\\Delta u_m = 5\\pi^2 \\sin(\\pi x)\\sin(2\\pi y) $$\n\nThe boundary data $g$ is the value of $u_{m}$ on the boundary $\\partial\\Omega$. The boundary of the domain $\\Omega = (0,1)\\times(0,1)$ consists of four segments: $x=0$, $x=1$, $y=0$, and $y=1$.\n- On $x=0$: $g(0,y) = u_{m}(0,y) = \\sin(0)\\sin(2\\pi y) = 0$.\n- On $x=1$: $g(1,y) = u_{m}(1,y) = \\sin(\\pi)\\sin(2\\pi y) = 0$.\n- On $y=0$: $g(x,0) = u_{m}(x,0) = \\sin(\\pi x)\\sin(0) = 0$.\n- On $y=1$: $g(x,1) = u_{m}(x,1) = \\sin(\\pi x)\\sin(2\\pi) = 0$.\nThe boundary data is $g(x,y)=0$ on all of $\\partial\\Omega$, corresponding to homogeneous Dirichlet boundary conditions.\n\n**Part (b): Compute Error Norms**\n\nThe error function is $e(x,y) = u_{m}(x,y) - u_{h}(x,y)$. Given $u_{h}(x,y) \\equiv 0$, the error is simply the manufactured solution itself:\n$$ e(x,y) = \\sin(\\pi x)\\sin(2\\pi y) $$\n\n**1. $L^{2}$-norm error**\nThe squared $L^{2}$-norm of the error is given by the integral of $e^2$ over the domain $\\Omega$:\n$$ \\|e\\|_{L^{2}(\\Omega)}^2 = \\int_{\\Omega} e(x,y)^2 \\,dA = \\int_0^1 \\int_0^1 \\left(\\sin(\\pi x)\\sin(2\\pi y)\\right)^2 \\,dx\\,dy $$\nThe integral is separable:\n$$ \\|e\\|_{L^{2}(\\Omega)}^2 = \\left( \\int_0^1 \\sin^2(\\pi x) \\,dx \\right) \\left( \\int_0^1 \\sin^2(2\\pi y) \\,dy \\right) $$\nWe use the identity $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$.\nFor the integral with respect to $x$:\n$$ \\int_0^1 \\sin^2(\\pi x) \\,dx = \\int_0^1 \\frac{1 - \\cos(2\\pi x)}{2} \\,dx = \\frac{1}{2} \\left[ x - \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_0^1 = \\frac{1}{2}(1 - 0) = \\frac{1}{2} $$\nFor the integral with respect to $y$:\n$$ \\int_0^1 \\sin^2(2\\pi y) \\,dy = \\int_0^1 \\frac{1 - \\cos(4\\pi y)}{2} \\,dy = \\frac{1}{2} \\left[ y - \\frac{\\sin(4\\pi y)}{4\\pi} \\right]_0^1 = \\frac{1}{2}(1 - 0) = \\frac{1}{2} $$\nTherefore, the squared $L^{2}$-norm is:\n$$ \\|e\\|_{L^{2}(\\Omega)}^2 = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = \\frac{1}{4} $$\nThe $L^{2}$-norm error is the square root of this value:\n$$ \\|e\\|_{L^{2}(\\Omega)} = \\sqrt{\\frac{1}{4}} = \\frac{1}{2} $$\n\n**2. $H^{1}$ seminorm error**\nThe squared $H^{1}$ seminorm of the error is the integral of the squared magnitude of its gradient over $\\Omega$:\n$$ |e|_{H^{1}(\\Omega)}^2 = \\int_{\\Omega} |\\nabla e|^2 \\,dA = \\int_0^1 \\int_0^1 \\left[ \\left(\\frac{\\partial e}{\\partial x}\\right)^2 + \\left(\\frac{\\partial e}{\\partial y}\\right)^2 \\right] \\,dx\\,dy $$\nThe partial derivatives of the error $e(x,y) = u_m(x,y)$ were computed in Part (a):\n$$ \\frac{\\partial e}{\\partial x} = \\pi \\cos(\\pi x)\\sin(2\\pi y) $$\n$$ \\frac{\\partial e}{\\partial y} = 2\\pi \\sin(\\pi x)\\cos(2\\pi y) $$\nSubstituting these into the integral:\n$$ |e|_{H^{1}(\\Omega)}^2 = \\int_0^1 \\int_0^1 \\left[ (\\pi \\cos(\\pi x)\\sin(2\\pi y))^2 + (2\\pi \\sin(\\pi x)\\cos(2\\pi y))^2 \\right] \\,dx\\,dy $$\n$$ |e|_{H^{1}(\\Omega)}^2 = \\int_0^1 \\int_0^1 \\left[ \\pi^2 \\cos^2(\\pi x)\\sin^2(2\\pi y) + 4\\pi^2 \\sin^2(\\pi x)\\cos^2(2\\pi y) \\right] \\,dx\\,dy $$\nWe separate this into two terms:\n$$ \\text{Term 1} = \\pi^2 \\left( \\int_0^1 \\cos^2(\\pi x) \\,dx \\right) \\left( \\int_0^1 \\sin^2(2\\pi y) \\,dy \\right) $$\n$$ \\text{Term 2} = 4\\pi^2 \\left( \\int_0^1 \\sin^2(\\pi x) \\,dx \\right) \\left( \\int_0^1 \\cos^2(2\\pi y) \\,dy \\right) $$\nWe use the identity $\\cos^2(\\theta) = \\frac{1 + \\cos(2\\theta)}{2}$ and the previously computed integrals for $\\sin^2$.\n$$ \\int_0^1 \\cos^2(\\pi x) \\,dx = \\int_0^1 \\frac{1 + \\cos(2\\pi x)}{2} \\,dx = \\frac{1}{2} \\left[ x + \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_0^1 = \\frac{1}{2} $$\n$$ \\int_0^1 \\cos^2(2\\pi y) \\,dy = \\int_0^1 \\frac{1 + \\cos(4\\pi y)}{2} \\,dy = \\frac{1}{2} \\left[ y + \\frac{\\sin(4\\pi y)}{4\\pi} \\right]_0^1 = \\frac{1}{2} $$\nSubstituting the values of the integrals:\n$$ \\text{Term 1} = \\pi^2 \\left( \\frac{1}{2} \\right) \\left( \\frac{1}{2} \\right) = \\frac{\\pi^2}{4} $$\n$$ \\text{Term 2} = 4\\pi^2 \\left( \\frac{1}{2} \\right) \\left( \\frac{1}{2} \\right) = \\pi^2 $$\nThe squared $H^{1}$ seminorm is the sum of these terms:\n$$ |e|_{H^{1}(\\Omega)}^2 = \\frac{\\pi^2}{4} + \\pi^2 = \\frac{5\\pi^2}{4} $$\nThe $H^{1}$ seminorm error is the square root of this value:\n$$ |e|_{H^{1}(\\Omega)} = \\sqrt{\\frac{5\\pi^2}{4}} = \\frac{\\sqrt{5}\\pi}{2} $$\n\nThe requested quantities are the $L^{2}$-norm error, $\\frac{1}{2}$, and the $H^{1}$ seminorm error, $\\frac{\\sqrt{5}\\pi}{2}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} & \\frac{\\sqrt{5}\\pi}{2}\n\\end{pmatrix}\n}\n$$", "id": "2576838"}, {"introduction": "Moving beyond the simplest models, real-world physical systems often involve material properties that vary in space, leading to partial differential equations with non-constant coefficients. This practice extends the basic MMS procedure to verify a solver for a diffusion equation with a spatially varying conductivity, $k(\\boldsymbol{x})$ [@problem_id:2576877]. You will derive not only the necessary source term but also the corresponding boundary data for both Dirichlet and Neumann conditions, a common requirement in code verification. This problem also encourages a deeper, graduate-level analysis of the underlying mathematical theory, asking you to consider the minimal smoothness conditions on the solution and coefficients that ensure the problem is well-posed in a weak sense.", "problem": "Consider the scalar diffusion equation $-\\nabla \\cdot \\big(k(\\boldsymbol{x}) \\nabla u(\\boldsymbol{x})\\big) = f(\\boldsymbol{x})$ posed on the unit square domain $\\Omega = (0,1) \\times (0,1)$, with either Dirichlet or Neumann boundary conditions. In the method of manufactured solutions for code verification in the Finite Element Method (FEM), one purposefully selects a smooth manufactured solution $u_m$ and a spatially varying conductivity $k$ that is strictly positive, and then derives the forcing term $f$ and boundary data so that $u_m$ is the exact solution to the boundary value problem.\n\nLet the manufactured solution and conductivity be\n$$\nu_m(x,y) = \\exp(x)\\,\\sin(\\pi y), \\qquad k(x,y) = 1 + x + y^2,\n$$\nfor $(x,y) \\in \\Omega$. Assume $k$ is strictly positive on $\\overline{\\Omega}$.\n\nTasks:\n1. By applying only basic multivariable calculus (componentwise differentiation and the product rule), derive the volumetric source term $f(x,y)$ that makes $u_m$ solve $-\\nabla \\cdot (k \\nabla u_m) = f$ in $\\Omega$.\n2. Construct consistent boundary data for both of the following:\n   - Dirichlet data $g$ on $\\partial \\Omega$ such that $u = g$ and $u \\equiv u_m$ on $\\partial \\Omega$.\n   - Neumann data $h$ on $\\partial \\Omega$ such that $-k \\nabla u \\cdot \\boldsymbol{n} = h$ and $u \\equiv u_m$ in $\\Omega$, where $\\boldsymbol{n}$ is the unit outward normal on $\\partial \\Omega$.\n3. State and justify minimal smoothness assumptions on $u_m$ and $k$ that ensure:\n   - The strong-form source $f = -\\nabla \\cdot (k \\nabla u_m)$ is well-defined as a function in $L^2(\\Omega)$ suitable for use in a standard weak formulation.\n   - The Dirichlet trace $g$ is well-defined, and the Neumann flux $h$ is meaningful as the normal trace of a field in the Hilbert space of square-integrable divergence fields.\n\nProvide the final answer as the explicit analytic expression for the source term $f(x,y)$ obtained in Task 1. No numerical evaluation is required, and no rounding is needed. Express angles in radians if any appear.", "solution": "The problem statement is first subjected to critical validation.\n\nStep 1: Extract Givens\n- Governing Equation: $-\\nabla \\cdot \\big(k(\\boldsymbol{x}) \\nabla u(\\boldsymbol{x})\\big) = f(\\boldsymbol{x})$\n- Domain: $\\Omega = (0,1) \\times (0,1)$\n- Manufactured Solution: $u_m(x,y) = \\exp(x)\\,\\sin(\\pi y)$\n- Conductivity: $k(x,y) = 1 + x + y^2$\n- Condition: The problem states to assume $k$ is strictly positive on $\\overline{\\Omega}$. For $(x,y) \\in [0,1] \\times [0,1]$, the minimum value of $k(x,y)$ occurs at $(0,0)$, where $k(0,0)=1$, and the maximum at $(1,1)$, where $k(1,1)=3$. Thus, $k(x,y) \\in [1,3]$ on the closed domain $\\overline{\\Omega}$, confirming it is strictly positive.\n- Tasks:\n  1. Derive the source term $f(x,y)$ such that $-\\nabla \\cdot (k \\nabla u_m) = f$ holds.\n  2. Construct Dirichlet data $g$ and Neumann data $h$ on the boundary $\\partial\\Omega$.\n  3. State minimal smoothness assumptions on $u_m$ and $k$ for the problem to be well-defined in a weak sense.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard application of the Method of Manufactured Solutions for verifying numerical solvers for partial differential equations. It is mathematically well-posed; the tasks involve direct computation based on provided functions and do not present ambiguity. The problem statement is objective and uses precise mathematical language. It is self-contained, with all necessary data provided, and free from internal contradictions. The specified functions $u_m$ and $k$ are infinitely differentiable ($C^\\infty$), which is more than sufficient for the required calculations. The problem does not violate any criteria for validity.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A complete solution will be provided.\n\nThe solution proceeds by addressing the three tasks in order.\n\nTask 1: Derivation of the source term $f(x,y)$\nThe source term is defined by the equation $f(x,y) = -\\nabla \\cdot (k(x,y) \\nabla u_m(x,y))$. We perform this calculation step-by-step.\n\nFirst, we compute the gradient of the manufactured solution, $\\nabla u_m$:\n$$\n\\nabla u_m(x,y) = \\left( \\frac{\\partial u_m}{\\partial x}, \\frac{\\partial u_m}{\\partial y} \\right)\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial u_m}{\\partial x} = \\frac{\\partial}{\\partial x} (\\exp(x) \\sin(\\pi y)) = \\exp(x) \\sin(\\pi y)\n$$\n$$\n\\frac{\\partial u_m}{\\partial y} = \\frac{\\partial}{\\partial y} (\\exp(x) \\sin(\\pi y)) = \\pi \\exp(x) \\cos(\\pi y)\n$$\nSo, the gradient is:\n$$\n\\nabla u_m(x,y) = \\begin{pmatrix} \\exp(x) \\sin(\\pi y) \\\\ \\pi \\exp(x) \\cos(\\pi y) \\end{pmatrix}\n$$\nNext, we multiply the gradient by the conductivity $k(x,y) = 1 + x + y^2$ to obtain the flux vector field, which we denote as $\\boldsymbol{q}_m = k \\nabla u_m$:\n$$\nk \\nabla u_m = (1 + x + y^2) \\begin{pmatrix} \\exp(x) \\sin(\\pi y) \\\\ \\pi \\exp(x) \\cos(\\pi y) \\end{pmatrix} = \\begin{pmatrix} (1 + x + y^2)\\exp(x) \\sin(\\pi y) \\\\ (1 + x + y^2)\\pi \\exp(x) \\cos(\\pi y) \\end{pmatrix}\n$$\nFinally, we compute the divergence of this vector field, $\\nabla \\cdot (k \\nabla u_m)$. Let the components of the vector field be $V_x$ and $V_y$:\n$$\nV_x(x,y) = (1 + x + y^2)\\exp(x) \\sin(\\pi y)\n$$\n$$\nV_y(x,y) = (1 + x + y^2)\\pi \\exp(x) \\cos(\\pi y)\n$$\nThe divergence is $\\nabla \\cdot (k \\nabla u_m) = \\frac{\\partial V_x}{\\partial x} + \\frac{\\partial V_y}{\\partial y}$. We compute each partial derivative using the product rule.\n$$\n\\frac{\\partial V_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ (1 + x + y^2)\\exp(x) \\sin(\\pi y) \\right] = [1 \\cdot \\exp(x) + (1+x+y^2)\\exp(x)] \\sin(\\pi y) = (2+x+y^2)\\exp(x)\\sin(\\pi y)\n$$\n$$\n\\frac{\\partial V_y}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ (1 + x + y^2)\\pi \\exp(x) \\cos(\\pi y) \\right] = [2y \\cdot \\pi \\exp(x) \\cos(\\pi y)] + [(1+x+y^2)\\pi \\exp(x) (-\\pi \\sin(\\pi y))]\n$$\n$$\n\\frac{\\partial V_y}{\\partial y} = 2\\pi y \\exp(x) \\cos(\\pi y) - \\pi^2(1+x+y^2)\\exp(x)\\sin(\\pi y)\n$$\nSumming these derivatives gives the divergence:\n$$\n\\nabla \\cdot (k \\nabla u_m) = (2+x+y^2)\\exp(x)\\sin(\\pi y) + 2\\pi y \\exp(x) \\cos(\\pi y) - \\pi^2(1+x+y^2)\\exp(x)\\sin(\\pi y)\n$$\nGrouping terms with $\\sin(\\pi y)$ and $\\cos(\\pi y)$:\n$$\n\\nabla \\cdot (k \\nabla u_m) = \\left[ (2+x+y^2) - \\pi^2(1+x+y^2) \\right] \\exp(x)\\sin(\\pi y) + 2\\pi y \\exp(x)\\cos(\\pi y)\n$$\nThe source term $f(x,y)$ is the negative of this expression:\n$$\nf(x,y) = -\\nabla \\cdot (k \\nabla u_m) = \\left[ \\pi^2(1+x+y^2) - (2+x+y^2) \\right] \\exp(x)\\sin(\\pi y) - 2\\pi y \\exp(x)\\cos(\\pi y)\n$$\n\nTask 2: Construction of boundary data\nThe boundary $\\partial \\Omega$ of the unit square consists of four segments.\n\n- Dirichlet data $g$: The data is obtained by evaluating $u_m$ on $\\partial \\Omega$, so that $g = u_m|_{\\partial \\Omega}$.\n  - On the bottom edge ($y=0, x \\in [0,1]$): $g(x,0) = \\exp(x)\\sin(0) = 0$.\n  - On the right edge ($x=1, y \\in [0,1]$): $g(1,y) = \\exp(1)\\sin(\\pi y) = e \\sin(\\pi y)$.\n  - On the top edge ($y=1, x \\in [0,1]$): $g(x,1) = \\exp(x)\\sin(\\pi) = 0$.\n  - On the left edge ($x=0, y \\in [0,1]$): $g(0,y) = \\exp(0)\\sin(\\pi y) = \\sin(\\pi y)$.\n\n- Neumann data $h$: The data is defined as $h = -k \\nabla u_m \\cdot \\boldsymbol{n}$, where $\\boldsymbol{n}$ is the unit outward normal vector.\n  - On the bottom edge ($y=0$): $\\boldsymbol{n} = (0,-1)$.\n    $h(x,0) = -(k(x,0) \\nabla u_m(x,0)) \\cdot (0,-1) = - (1+x) \\begin{pmatrix} 0 \\\\ \\pi \\exp(x) \\end{pmatrix} \\cdot \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = (1+x)\\pi\\exp(x)$.\n  - On the right edge ($x=1$): $\\boldsymbol{n} = (1,0)$.\n    $h(1,y) = -(k(1,y) \\nabla u_m(1,y)) \\cdot (1,0) = - (2+y^2) \\begin{pmatrix} e\\sin(\\pi y) \\\\ \\pi e\\cos(\\pi y) \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -(2+y^2)e\\sin(\\pi y)$.\n  - On the top edge ($y=1$): $\\boldsymbol{n} = (0,1)$.\n    $h(x,1) = -(k(x,1) \\nabla u_m(x,1)) \\cdot (0,1) = - (2+x) \\begin{pmatrix} 0 \\\\ -\\pi \\exp(x) \\end{pmatrix} \\cdot \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = (2+x)\\pi\\exp(x)$.\n  - On the left edge ($x=0$): $\\boldsymbol{n} = (-1,0)$.\n    $h(0,y) = -(k(0,y) \\nabla u_m(0,y)) \\cdot (-1,0) = - (1+y^2) \\begin{pmatrix} \\sin(\\pi y) \\\\ \\pi \\cos(\\pi y) \\end{pmatrix} \\cdot \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = (1+y^2)\\sin(\\pi y)$.\n\nTask 3: Minimal smoothness assumptions\nWe analyze the regularity required for each term to be well-defined in the context of weak solutions.\n\n- For the source term $f = -\\nabla \\cdot (k \\nabla u_m)$ to be in $L^2(\\Omega)$:\nThe term can be expanded as $f = -(\\nabla k \\cdot \\nabla u_m + k \\nabla^2 u_m)$. A standard set of sufficient conditions is that $u_m$ is in the Sobolev space $H^2(\\Omega)$ and $k$ is in $W^{1,\\infty}(\\Omega)$. The space $H^2(\\Omega)$ consists of functions with all first and second partial derivatives in $L^2(\\Omega)$. The space $W^{1,\\infty}(\\Omega)$ consists of Lipschitz continuous functions, meaning $k$ is bounded and its first derivatives are essentially bounded. Under these assumptions, $\\nabla^2 u_m \\in L^2(\\Omega)$ and $k \\in L^\\infty(\\Omega)$, so their product $k \\nabla^2 u_m \\in L^2(\\Omega)$. Also, $\\nabla u_m \\in (H^1(\\Omega))^2$, which by Sobolev embedding in two dimensions is contained in $(L^p(\\Omega))^2$ for any finite $p \\geq 1$. Since $\\nabla k \\in (L^\\infty(\\Omega))^2$, the product $\\nabla k \\cdot \\nabla u_m$ is also in $L^2(\\Omega)$. Therefore, $f \\in L^2(\\Omega)$ is guaranteed if $u_m \\in H^2(\\Omega)$ and $k \\in W^{1,\\infty}(\\Omega)$.\n\n- For the Dirichlet trace $g$ to be well-defined:\nThe trace theorem states that for a function $u_m \\in H^1(\\Omega)$, its restriction (trace) to the boundary $\\partial\\Omega$ is well-defined as an element of the space $H^{1/2}(\\partial\\Omega)$. Thus, the minimal assumption on $u_m$ is $u_m \\in H^1(\\Omega)$.\n\n- For the Neumann flux $h$ to be meaningful:\nThe Neumann data $h = -k \\nabla u_m \\cdot \\boldsymbol{n}$ is the normal trace of the vector field $\\boldsymbol{q} = -k \\nabla u_m$. For this normal trace to be well-defined in an appropriate space (typically $H^{-1/2}(\\partial\\Omega)$, the dual of $H^{1/2}(\\partial\\Omega)$), the vector field $\\boldsymbol{q}$ must belong to the space $H(\\text{div}, \\Omega)$. This space consists of vector fields in $(L^2(\\Omega))^2$ whose divergence is also in $L^2(\\Omega)$. The condition $\\boldsymbol{q} = -k \\nabla u_m \\in (L^2(\\Omega))^2$ is met if $k \\in L^\\infty(\\Omega)$ and $u_m \\in H^1(\\Omega)$. The condition $\\nabla \\cdot \\boldsymbol{q} \\in L^2(\\Omega)$ is equivalent to requiring $f \\in L^2(\\Omega)$. As established above, this requires higher regularity, namely $u_m \\in H^2(\\Omega)$ and $k \\in W^{1,\\infty}(\\Omega)$. These are therefore the minimal assumptions on $u_m$ and $k$ for the Neumann flux to be well-defined in this standard functional analytic setting.", "answer": "$$\n\\boxed{\\left[ \\pi^2(1+x+y^2) - (2+x+y^2) \\right]\\exp(x)\\sin(\\pi y) - 2\\pi y \\exp(x)\\cos(\\pi y)}\n$$", "id": "2576877"}, {"introduction": "A primary source of complexity and bugs in finite element codes arises from the geometric transformation, or mapping, from a simple, canonical reference element to a distorted or curved element in physical space. This advanced practice confronts that challenge head-on, demonstrating how MMS can be used to meticulously verify the implementation of a diffusion operator on a 3D curvilinear element [@problem_id:2576815]. By using a manufactured solution that intentionally couples strongly with the geometric terms of the mapping—such as the Jacobian determinant and metric tensor—this exercise provides a robust test to ensure that these intricate and error-prone components of your FEM code are implemented correctly.", "problem": "Consider verification of a mapped-element diffusion operator in three dimensions using the Method of Manufactured Solutions (MMS) within the Finite Element Method (FEM). Let the physical domain be represented by a trilinear-curvilinear mapping from the reference cube with coordinates $(\\xi,\\eta,\\zeta)\\in[0,1]^3$ to physical coordinates $(x,y,z)$ via\n$$\n\\begin{aligned}\nx(\\xi,\\eta,\\zeta) &= \\xi + a \\sin(\\pi \\xi)\\sin(\\pi \\eta) + b\\,\\zeta^2,\\\\\ny(\\xi,\\eta,\\zeta) &= \\eta + c\\,\\xi\\,\\eta + d \\sin(\\pi \\zeta),\\\\\nz(\\xi,\\eta,\\zeta) &= \\zeta + e\\,\\xi\\,\\zeta + f\\,\\eta\\,\\zeta,\n\\end{aligned}\n$$\nwhere $a,b,c,d,e,f$ are real parameters. All trigonometric arguments are in radians. Denote the Jacobian matrix by $X_{i\\alpha}=\\partial x_i/\\partial \\xi_\\alpha$ with $i\\in\\{1,2,3\\}$ corresponding to $(x,y,z)$ and $\\alpha\\in\\{1,2,3\\}$ corresponding to $(\\xi,\\eta,\\zeta)$. Let $J=\\det(X)$ be the Jacobian determinant, $G=X^\\top X$ the covariant metric tensor, and $g=G^{-1}$ the contravariant metric tensor with entries $g^{\\alpha\\beta}$.\n\nWe seek a manufactured solution $u_m(\\xi,\\eta,\\zeta)$ such that it strongly couples with the metric terms in three-dimensional curvilinear elements, ensuring that all mapping components and mixed derivatives are exercised. Consider the following $u_m$:\n$$\n\\begin{aligned}\nu_m(\\xi,\\eta,\\zeta) &= \\sin\\!\\Big(\\pi(\\xi + 0.2\\,\\eta)\\Big)\\,\\cos\\!\\Big(\\pi(\\zeta + 0.1\\,\\xi\\,\\eta)\\Big) \\\\\n&\\quad + \\xi^2 \\eta + \\eta^2 \\zeta + \\zeta^2 \\xi + \\xi \\eta \\zeta.\n\\end{aligned}\n$$\nLet the steady diffusion equation in physical space be\n$$\n- \\nabla \\cdot (k \\nabla u) = f,\n$$\nwith constant conductivity $k>0$. When expressed in reference coordinates using the standard transformation identities for curvilinear coordinates, the physical-space Laplacian of a scalar $u(\\xi,\\eta,\\zeta)$ is given by\n$$\n\\Delta u = \\frac{1}{J} \\,\\partial_\\alpha\\!\\left(J\\, g^{\\alpha\\beta}\\, \\partial_\\beta u\\right),\n$$\nwhere $\\partial_\\alpha$ denotes partial differentiation with respect to the reference coordinate $\\xi_\\alpha\\in\\{\\xi,\\eta,\\zeta\\}$ and the Einstein summation convention applies over repeated Greek indices. Therefore, the manufactured source is\n$$\nf(\\xi,\\eta,\\zeta) = -k\\,\\Delta u_m(\\xi,\\eta,\\zeta) = -\\frac{k}{J} \\,\\partial_\\alpha\\!\\left(J\\, g^{\\alpha\\beta}\\, \\partial_\\beta u_m\\right).\n$$\n\nTask:\n1. Implement the mapping and compute $X$, $J$, $G$, and $g$ at any $(\\xi,\\eta,\\zeta)$ for given $(a,b,c,d,e,f)$. Explicitly compute all first derivatives of $u_m$ with respect to $(\\xi,\\eta,\\zeta)$ analytically. For the divergence $\\partial_\\alpha\\!\\left(J\\, g^{\\alpha\\beta}\\, \\partial_\\beta u_m\\right)$, use a centered finite difference with a stepsize $h = 1\\times 10^{-6}$ in the corresponding reference coordinate, holding the other two fixed, that is,\n$$\n\\partial_\\xi Q_\\xi \\approx \\frac{Q_\\xi(\\xi+h,\\eta,\\zeta)-Q_\\xi(\\xi-h,\\eta,\\zeta)}{2h},\\quad Q_\\xi = J\\,g^{\\xi\\beta}\\,\\partial_\\beta u_m,\n$$\nand analogously for $\\partial_\\eta Q_\\eta$ and $\\partial_\\zeta Q_\\zeta$. Use the formula\n$$\n\\Delta u_m(\\xi,\\eta,\\zeta) \\approx \\frac{1}{J(\\xi,\\eta,\\zeta)}\\left[\\partial_\\xi Q_\\xi + \\partial_\\eta Q_\\eta + \\partial_\\zeta Q_\\zeta\\right].\n$$\n2. For each specified parameter set and conductivity, evaluate $f(\\xi,\\eta,\\zeta)$ at the sample points listed below and report the root-mean-square (RMS) value over these points:\n$$\n\\text{RMS}(f) = \\sqrt{\\frac{1}{N}\\sum_{n=1}^N f(\\xi_n,\\eta_n,\\zeta_n)^2},\\quad N=4,\n$$\nwith the sample points\n$$\n(\\xi,\\eta,\\zeta)\\in\\Big\\{(0.33,0.27,0.41),\\,(0.73,0.19,0.87),\\,(0.51,0.61,0.29),\\,(0.23,0.47,0.79)\\Big\\}.\n$$\n3. Use the following test suite of parameter sets $(a,b,c,d,e,f)$ and conductivities $k$:\n- Case A (affine boundary condition check): $(a,b,c,d,e,f)=(0,0,0,0,0,0)$ and $k=2.0$.\n- Case B (moderate curvature): $(a,b,c,d,e,f)=(0.1,0.05,0.2,0.07,0.15,0.12)$ and $k=1.0$.\n- Case C (stronger curvature): $(a,b,c,d,e,f)=(0.2,0.1,0.3,0.15,0.25,0.22)$ and $k=0.7$.\n\nAll trigonometric function arguments must be in radians. There are no physical units to report. Angles are in radians. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where $r_i$ is the RMS value defined above for the $i$-th parameter set in the test suite, in the order A, B, C. Each $r_i$ must be a floating-point number. The program must be self-contained and use no external input.", "solution": "The problem statement has been rigorously validated and is found to be scientifically grounded, well-posed, and complete. It describes a standard, albeit computationally intensive, procedure in the field of computational mechanics for the verification of numerical codes using the Method of Manufactured Solutions. We will proceed to construct the solution.\n\nThe objective is to compute the manufactured source term $f(\\xi, \\eta, \\zeta)$ corresponding to a prescribed manufactured solution $u_m(\\xi, \\eta, \\zeta)$ under a curvilinear coordinate transformation. The governing equation is the steady-state diffusion equation, $- \\nabla \\cdot (k \\nabla u) = f$.\n\nThe fundamental relationship between the Laplacian operator in physical space $(x, y, z)$ and reference space $(\\xi, \\eta, \\zeta)$ is given by\n$$\n\\Delta u = \\frac{1}{J} \\frac{\\partial}{\\partial \\xi^\\alpha} \\left( J g^{\\alpha\\beta} \\frac{\\partial u}{\\partial \\xi^\\beta} \\right)\n$$\nwhere summation over repeated indices $\\alpha, \\beta \\in \\{1, 2, 3\\}$ is implied. The quantities $J$ and $g^{\\alpha\\beta}$ are the Jacobian determinant and the contravariant metric tensor components, respectively, derived from the coordinate mapping $x_i(\\xi_\\alpha)$.\n\nThe procedure is as follows:\n1.  Analytically derive the components of the Jacobian matrix $X_{i\\alpha} = \\partial x_i / \\partial \\xi_\\alpha$.\n2.  Analytically derive the components of the gradient of the manufactured solution in the reference frame, $\\partial_\\alpha u_m = \\partial u_m / \\partial \\xi_\\alpha$.\n3.  For any point $(\\xi, \\eta, \\zeta)$, numerically compute the geometric tensors and the flux vector in the reference frame.\n4.  Numerically approximate the divergence of the flux vector using a second-order centered finite difference scheme to compute $\\Delta u_m$.\n5.  Calculate the manufactured source $f = -k \\Delta u_m$.\n6.  Finally, compute the root-mean-square (RMS) of $f$ over the specified sample points for each test case.\n\n**1. Jacobian Matrix Derivation**\nThe mapping is given by:\n$$\n\\begin{aligned}\nx(\\xi,\\eta,\\zeta) &= \\xi + a \\sin(\\pi \\xi)\\sin(\\pi \\eta) + b\\,\\zeta^2 \\\\\ny(\\xi,\\eta,\\zeta) &= \\eta + c\\,\\xi\\,\\eta + d \\sin(\\pi \\zeta) \\\\\nz(\\xi,\\eta,\\zeta) &= \\zeta + e\\,\\xi\\,\\zeta + f\\,\\eta\\,\\zeta\n\\end{aligned}\n$$\nThe Jacobian matrix $X$ with components $X_{i\\alpha} = \\partial x_i / \\partial \\xi_\\alpha$ (where $x_1=x, x_2=y, x_3=z$ and $\\xi_1=\\xi, \\xi_2=\\eta, \\xi_3=\\zeta$) is:\n$$\nX = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\zeta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\zeta} \\\\\n\\frac{\\partial z}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\zeta}\n\\end{pmatrix}\n$$\nThe individual components are:\n$$\n\\begin{aligned}\n\\frac{\\partial x}{\\partial \\xi} &= 1 + a \\pi \\cos(\\pi \\xi)\\sin(\\pi \\eta) \\\\\n\\frac{\\partial x}{\\partial \\eta} &= a \\pi \\sin(\\pi \\xi)\\cos(\\pi \\eta) \\\\\n\\frac{\\partial x}{\\partial \\zeta} &= 2 b \\zeta \\\\\n\\frac{\\partial y}{\\partial \\xi} &= c \\eta \\\\\n\\frac{\\partial y}{\\partial \\eta} &= 1 + c \\xi \\\\\n\\frac{\\partial y}{\\partial \\zeta} &= d \\pi \\cos(\\pi \\zeta) \\\\\n\\frac{\\partial z}{\\partial \\xi} &= e \\zeta \\\\\n\\frac{\\partial z}{\\partial \\eta} &= f \\zeta \\\\\n\\frac{\\partial z}{\\partial \\zeta} &= 1 + e \\xi + f \\eta\n\\end{aligned}\n$$\n\n**2. Manufactured Solution Gradient Derivation**\nThe manufactured solution is:\n$$\nu_m(\\xi,\\eta,\\zeta) = \\sin\\Big(\\pi(\\xi + 0.2\\eta)\\Big)\\cos\\Big(\\pi(\\zeta + 0.1\\xi\\eta)\\Big) + \\xi^2 \\eta + \\eta^2 \\zeta + \\zeta^2 \\xi + \\xi \\eta \\zeta\n$$\nIts partial derivatives with respect to the reference coordinates are:\n$$\n\\begin{aligned}\n\\frac{\\partial u_m}{\\partial \\xi} = &\\ \\pi \\cos\\Big(\\pi(\\xi+0.2\\eta)\\Big) \\cos\\Big(\\pi(\\zeta+0.1\\xi\\eta)\\Big) \\\\\n&- 0.1\\pi\\eta \\sin\\Big(\\pi(\\xi+0.2\\eta)\\Big) \\sin\\Big(\\pi(\\zeta+0.1\\xi\\eta)\\Big) \\\\\n&+ 2\\xi\\eta + \\zeta^2 + \\eta\\zeta \\\\\n\\\\\n\\frac{\\partial u_m}{\\partial \\eta} = &\\ 0.2\\pi \\cos\\Big(\\pi(\\xi+0.2\\eta)\\Big) \\cos\\Big(\\pi(\\zeta+0.1\\xi\\eta)\\Big) \\\\\n&- 0.1\\pi\\xi \\sin\\Big(\\pi(\\xi+0.2\\eta)\\Big) \\sin\\Big(\\pi(\\zeta+0.1\\xi\\eta)\\Big) \\\\\n&+ \\xi^2 + 2\\eta\\zeta + \\xi\\zeta \\\\\n\\\\\n\\frac{\\partial u_m}{\\partial \\zeta} = &\\ -\\pi \\sin\\Big(\\pi(\\xi+0.2\\eta)\\Big) \\sin\\Big(\\pi(\\zeta+0.1\\xi\\eta)\\Big) + \\eta^2 + 2\\zeta\\xi + \\xi\\eta\n\\end{aligned}\n$$\n\n**3. Numerical Computation of the Source Term**\nFor a given point $(\\xi, \\eta, \\zeta)$, we define a flux-related vector $Q$ with components:\n$$\nQ_\\alpha = J g^{\\alpha\\beta} \\frac{\\partial u_m}{\\partial \\xi^\\beta}\n$$\nThese components are explicitly:\n$$\n\\begin{aligned}\nQ_\\xi &= J \\left( g^{\\xi\\xi} \\frac{\\partial u_m}{\\partial \\xi} + g^{\\xi\\eta} \\frac{\\partial u_m}{\\partial \\eta} + g^{\\xi\\zeta} \\frac{\\partial u_m}{\\partial \\zeta} \\right) \\\\\nQ_\\eta &= J \\left( g^{\\eta\\xi} \\frac{\\partial u_m}{\\partial \\xi} + g^{\\eta\\eta} \\frac{\\partial u_m}{\\partial \\eta} + g^{\\eta\\zeta} \\frac{\\partial u_m}{\\partial \\zeta} \\right) \\\\\nQ_\\zeta &= J \\left( g^{\\zeta\\xi} \\frac{\\partial u_m}{\\partial \\xi} + g^{\\zeta\\eta} \\frac{\\partial u_m}{\\partial \\eta} + g^{\\zeta\\zeta} \\frac{\\partial u_m}{\\partial \\zeta} \\right)\n\\end{aligned}\n$$\nwhere $J = \\det(X)$ and $g = (X^T X)^{-1}$. The divergence term in the Laplacian, $\\partial_\\alpha Q_\\alpha$, is approximated by central differences with a step size of $h = 1 \\times 10^{-6}$:\n$$\n\\partial_\\alpha Q_\\alpha \\approx \\frac{Q_\\xi(\\xi+h, \\eta, \\zeta) - Q_\\xi(\\xi-h, \\eta, \\zeta)}{2h} + \\frac{Q_\\eta(\\xi, \\eta+h, \\zeta) - Q_\\eta(\\xi, \\eta-h, \\zeta)}{2h} + \\frac{Q_\\zeta(\\xi, \\eta, \\zeta+h) - Q_\\zeta(\\xi, \\eta, \\zeta-h)}{2h}\n$$\nThe Laplacian is then computed at $(\\xi, \\eta, \\zeta)$ as:\n$$\n\\Delta u_m(\\xi, \\eta, \\zeta) \\approx \\frac{1}{J(\\xi,\\eta,\\zeta)} \\left( \\partial_\\alpha Q_\\alpha \\right)\n$$\nAnd the source term is $f(\\xi, \\eta, \\zeta) = -k \\Delta u_m$.\n\n**4. RMS Calculation**\nThe RMS value is computed over the $N=4$ sample points $(\\xi_n, \\eta_n, \\zeta_n)$:\n$$\n\\text{RMS}(f) = \\sqrt{\\frac{1}{N}\\sum_{n=1}^N f(\\xi_n,\\eta_n,\\zeta_n)^2}\n$$\nThis procedure is implemented for each of the three test cases specified in the problem statement. The implementation will use numerical libraries for matrix operations such as determinant and inversion. All trigonometric function inputs are treated as radians.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to execute the Method of Manufactured Solutions task.\n    It computes the RMS of the source term for three different test cases.\n    \"\"\"\n    \n    # Define the finite difference step size\n    H = 1e-6\n    \n    # Define the sample points in the reference domain\n    sample_points = [\n        (0.33, 0.27, 0.41),\n        (0.73, 0.19, 0.87),\n        (0.51, 0.61, 0.29),\n        (0.23, 0.47, 0.79)\n    ]\n    \n    # Define the test cases with mapping parameters and conductivity\n    test_cases = [\n        # Case A: Affine mapping\n        {'params': (0.0, 0.0, 0.0, 0.0, 0.0, 0.0), 'k': 2.0},\n        # Case B: Moderate curvature\n        {'params': (0.1, 0.05, 0.2, 0.07, 0.15, 0.12), 'k': 1.0},\n        # Case C: Stronger curvature\n        {'params': (0.2, 0.1, 0.3, 0.15, 0.25, 0.22), 'k': 0.7}\n    ]\n\n    def get_grad_um(xi, eta, zeta):\n        \"\"\"\n        Computes the analytical gradient of the manufactured solution u_m\n        in the reference coordinates (xi, eta, zeta).\n        \"\"\"\n        term1_arg1 = np.pi * (xi + 0.2 * eta)\n        term1_arg2 = np.pi * (zeta + 0.1 * xi * eta)\n        \n        sin1 = np.sin(term1_arg1)\n        cos1 = np.cos(term1_arg1)\n        sin2 = np.sin(term1_arg2)\n        cos2 = np.cos(term1_arg2)\n\n        # Partial derivative with respect to xi\n        du_dxi = (np.pi * cos1 * cos2 \n                  - 0.1 * np.pi * eta * sin1 * sin2 \n                  + 2.0 * xi * eta + zeta**2 + eta * zeta)\n                  \n        # Partial derivative with respect to eta\n        du_deta = (0.2 * np.pi * cos1 * cos2 \n                   - 0.1 * np.pi * xi * sin1 * sin2 \n                   + xi**2 + 2.0 * eta * zeta + xi * zeta)\n                   \n        # Partial derivative with respect to zeta\n        du_dzeta = (-np.pi * sin1 * sin2 \n                    + eta**2 + 2.0 * zeta * xi + xi * eta)\n        \n        return np.array([du_dxi, du_deta, du_dzeta])\n\n    def compute_Q_and_J(xi, eta, zeta, params):\n        \"\"\"\n        Computes the flux-related vector Q and the Jacobian determinant J.\n        \"\"\"\n        a, b, c, d, e, f = params\n        pi = np.pi\n        \n        # Jacobian matrix X\n        X = np.zeros((3, 3))\n        X[0, 0] = 1.0 + a * pi * np.cos(pi * xi) * np.sin(pi * eta)\n        X[0, 1] = a * pi * np.sin(pi * xi) * np.cos(pi * eta)\n        X[0, 2] = 2.0 * b * zeta\n        X[1, 0] = c * eta\n        X[1, 1] = 1.0 + c * xi\n        X[1, 2] = d * pi * np.cos(pi * zeta)\n        X[2, 0] = e * zeta\n        X[2, 1] = f * zeta\n        X[2, 2] = 1.0 + e * xi + f * eta\n        \n        # Jacobian determinant J\n        J = np.linalg.det(X)\n        \n        # Covariant metric tensor G and contravariant metric tensor g\n        G = X.T @ X\n        g = np.linalg.inv(G)\n        \n        # Gradient of u_m\n        grad_u = get_grad_um(xi, eta, zeta)\n        \n        # Flux vector Q\n        Q = J * (g @ grad_u)\n        \n        return Q, J\n\n    def calculate_source_rms(params, k):\n        \"\"\"\n        Calculates the RMS of the manufactured source term over the sample points.\n        \"\"\"\n        f_squared_values = []\n        \n        for xi_c, eta_c, zeta_c in sample_points:\n            # Finite difference approximation for the divergence of Q\n            Q_px, _ = compute_Q_and_J(xi_c + H, eta_c, zeta_c, params)\n            Q_mx, _ = compute_Q_and_J(xi_c - H, eta_c, zeta_c, params)\n            div_Q_xi = (Q_px[0] - Q_mx[0]) / (2.0 * H)\n            \n            Q_py, _ = compute_Q_and_J(xi_c, eta_c + H, zeta_c, params)\n            Q_my, _ = compute_Q_and_J(xi_c, eta_c - H, zeta_c, params)\n            div_Q_eta = (Q_py[1] - Q_my[1]) / (2.0 * H)\n\n            Q_pz, _ = compute_Q_and_J(xi_c, eta_c, zeta_c + H, params)\n            Q_mz, _ = compute_Q_and_J(xi_c, eta_c, zeta_c - H, params)\n            div_Q_zeta = (Q_pz[2] - Q_mz[2]) / (2.0 * H)\n            \n            div_Q = div_Q_xi + div_Q_eta + div_Q_zeta\n            \n            # Jacobian determinant at the center point\n            _, J_c = compute_Q_and_J(xi_c, eta_c, zeta_c, params)\n            \n            # Laplacian of the manufactured solution\n            laplacian_um = div_Q / J_c\n            \n            # Manufactured source term f\n            f_val = -k * laplacian_um\n            f_squared_values.append(f_val**2)\n            \n        return np.sqrt(np.mean(f_squared_values))\n\n    results = []\n    for case in test_cases:\n        rms_val = calculate_source_rms(case['params'], case['k'])\n        results.append(rms_val)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2576815"}]}