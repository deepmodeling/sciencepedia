{"hands_on_practices": [{"introduction": "A primary consequence of spatial discretization is numerical dispersion, where the wave speed becomes frequency-dependent. While phase velocity error affects the propagation of individual harmonic components, the error in group velocity directly impacts the modeled speed of wave packets and energy transport. This practice guides you through deriving the group velocity for a standard finite element discretization and quantifying its error, a crucial step in assessing the fidelity of wave propagation simulations [@problem_id:2611394].", "problem": "Consider longitudinal wave propagation in a homogeneous, prismatic, linearly elastic rod occupying a one-dimensional domain with uniform cross-section and material properties. Let the axial displacement field be $u(x,t)$ and let the material density be $\\rho$, Young’s modulus be $E$, and wave speed be $c$, where $c = \\sqrt{E/\\rho}$. The governing equation is the linear wave equation $u_{tt} = c^{2} u_{xx}$, where subscripts denote partial derivatives with respect to time and space. Discretize the spatial domain using the standard Galerkin finite element method (FEM) with linear Lagrange basis functions on a uniform mesh of spacing $h$, and retain the consistent mass matrix. Assume a Bloch-Floquet wave ansatz at the nodal level of the form $u_{j}(t) = U \\exp\\!\\big(i (j k h - \\omega t)\\big)$, where $j$ is the integer node index, $k$ is the wavenumber, and $\\omega$ is the angular frequency. Using only the fundamental balance law, the definition of wave speed $c$, the Galerkin finite element construction with linear shape functions, and the Bloch-Floquet ansatz, perform the following:\n\n- Derive the semidiscrete discrete dispersion relation $\\tilde{\\omega}(k)$ for the assembled system on the uniform mesh with consistent mass.\n- Differentiate $\\tilde{\\omega}(k)$ with respect to $k$ to obtain the discrete group velocity $c_{g}^{\\mathrm{FE}} = d\\tilde{\\omega}/dk$, and compare it to the continuous group velocity $c = d\\omega/dk$.\n- Define the nondimensional wavenumber $\\xi = k h$ and the relative group velocity error $\\varepsilon_{g}(\\xi) = \\frac{c_{g}^{\\mathrm{FE}}}{c} - 1$. Express your final answer as a single, exact, closed-form analytic expression for $\\varepsilon_{g}(\\xi)$ in terms of $\\xi$ only, with no units.\n\nYour final answer must be the analytic expression for $\\varepsilon_{g}(\\xi)$ only. Do not provide numerical approximations or units. Do not include any additional quantities beyond $\\varepsilon_{g}(\\xi)$ in the final boxed expression.", "solution": "The governing equation is the one-dimensional wave equation:\n$$ \\rho u_{tt} - E u_{xx} = 0 $$\nThe weak form is obtained by multiplying by a test function $v(x)$ and integrating over the domain. For an element of length $h$, this is:\n$$ \\int_{x_j}^{x_{j+1}} v (\\rho u_{tt}) \\, dx + \\int_{x_j}^{x_{j+1}} v_x (E u_x) \\, dx = 0 $$\nWe discretize the displacement field $u(x,t)$ within an element using linear Lagrange basis functions $N_j(x)$ and $N_{j+1}(x)$:\n$$ u(x,t) = N_j(x) u_j(t) + N_{j+1}(x) u_{j+1}(t) $$\nUsing the Galerkin method, the test functions are chosen from the same space as the basis functions. This yields the element mass matrix $\\mathbf{M}^e$ and stiffness matrix $\\mathbf{K}^e$. For uniform cross-sectional area $A$, which will cancel, the element matrices for a linear element of length $h$ are:\n$$ \\mathbf{M}^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\quad , \\quad \\mathbf{K}^e = \\frac{E A}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\nThe assembled system of semidiscrete equations has the form $\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}$. The equation for a generic interior node $j$ is obtained by assembling contributions from the element spanning nodes $(j-1, j)$ and the element spanning nodes $(j, j+1)$:\n$$ \\frac{\\rho A h}{6} (\\ddot{u}_{j-1} + 4 \\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{E A}{h} (-u_{j-1} + 2 u_j - u_{j+1}) = 0 $$\nWe substitute the Bloch-Floquet ansatz $u_j(t) = U \\exp(i(jkh - \\omega t))$. The second time derivative is $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$. The nodal displacements are related by:\n$u_{j-1} = u_j \\exp(-ikh)$ and $u_{j+1} = u_j \\exp(ikh)$.\nSubstituting these into the assembled equation and dividing by the common factor $A u_j(t)$ gives:\n$$ -\\omega^2 \\frac{\\rho h}{6} (\\exp(-ikh) + 4 + \\exp(ikh)) + \\frac{E}{h} (-\\exp(-ikh) + 2 - \\exp(ikh)) = 0 $$\nUsing Euler's identity, $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, we simplify the expression:\n$$ -\\omega^2 \\frac{\\rho h}{6} (4 + 2\\cos(kh)) + \\frac{E}{h} (2 - 2\\cos(kh)) = 0 $$\nWe solve for $\\omega^2$ to find the discrete dispersion relation. The discrete frequency is denoted $\\tilde{\\omega}$:\n$$ \\tilde{\\omega}^2 \\rho \\frac{h}{6} (2(2 + \\cos(kh))) = \\frac{E}{h} (2(1 - \\cos(kh))) $$\n$$ \\tilde{\\omega}^2 = \\frac{E}{\\rho} \\frac{1}{h^2} \\frac{6(1 - \\cos(kh))}{2 + \\cos(kh)} $$\nUsing the definition $c^2 = E/\\rho$ and the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$ \\tilde{\\omega}^2(k) = c^2 \\frac{6}{h^2} \\frac{2\\sin^2(kh/2)}{2 + \\cos(kh)} = \\frac{12 c^2}{h^2} \\frac{\\sin^2(kh/2)}{2 + \\cos(kh)} $$\nTo simplify the denominator, we use $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$, which gives $2 + \\cos(kh) = 3 - 2\\sin^2(kh/2)$.\n$$ \\tilde{\\omega}^2(k) = \\frac{12 c^2}{h^2} \\frac{\\sin^2(kh/2)}{3 - 2\\sin^2(kh/2)} $$\nThe discrete dispersion relation is therefore:\n$$ \\tilde{\\omega}(k) = \\frac{2\\sqrt{3} c}{h} \\frac{|\\sin(kh/2)|}{\\sqrt{3 - 2\\sin^2(kh/2)}} $$\nThe discrete group velocity is $c_g^{\\mathrm{FE}} = d\\tilde{\\omega}/dk$. To avoid the complex derivative of $\\tilde{\\omega}$, we use the identity $2\\tilde{\\omega} (d\\tilde{\\omega}/dk) = d(\\tilde{\\omega}^2)/dk$, which gives $c_g^{\\mathrm{FE}} = \\frac{1}{2\\tilde{\\omega}} \\frac{d(\\tilde{\\omega}^2)}{dk}$. We differentiate the simpler expression for $\\tilde{\\omega}^2$:\n$$ \\tilde{\\omega}^2(k) = \\frac{6 c^2}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)} $$\nUsing the quotient rule, we find the derivative with respect to $k$:\n$$ \\frac{d(\\tilde{\\omega}^2)}{dk} = \\frac{6 c^2}{h^2} \\frac{(h\\sin(kh))(2+\\cos(kh)) - (1-\\cos(kh))(-h\\sin(kh))}{(2+\\cos(kh))^2} $$\n$$ \\frac{d(\\tilde{\\omega}^2)}{dk} = \\frac{6 c^2 h \\sin(kh)}{h^2 (2+\\cos(kh))^2} (2+\\cos(kh) + 1-\\cos(kh)) = \\frac{18 c^2}{h} \\frac{\\sin(kh)}{(2+\\cos(kh))^2} $$\nNow we construct the group velocity:\n$$ c_g^{\\mathrm{FE}} = \\frac{1}{2\\tilde{\\omega}} \\left( \\frac{18 c^2}{h} \\frac{\\sin(kh)}{(2+\\cos(kh))^2} \\right) $$\nSubstituting the expression for $\\tilde{\\omega}$:\n$$ c_g^{\\mathrm{FE}} = \\frac{1}{2 \\frac{\\sqrt{6}c}{h} \\sqrt{\\frac{1-\\cos(kh)}{2+\\cos(kh)}}} \\left( \\frac{18 c^2}{h} \\frac{\\sin(kh)}{(2+\\cos(kh))^2} \\right) $$\n$$ c_g^{\\mathrm{FE}} = \\frac{9 c}{\\sqrt{6}} \\frac{\\sin(kh)}{(2+\\cos(kh))^{3/2} \\sqrt{1-\\cos(kh)}} $$\nTo simplify, we use half-angle identities with $\\xi = kh$: $\\sin(\\xi) = 2\\sin(\\xi/2)\\cos(\\xi/2)$, $1-\\cos(\\xi) = 2\\sin^2(\\xi/2)$, and $2+\\cos(\\xi) = 3 - 2\\sin^2(\\xi/2)$. Assuming we are in the first Brillouin zone $\\xi \\in [0, \\pi]$, we have $\\sin(\\xi/2) \\ge 0$.\n$$ c_g^{\\mathrm{FE}} = \\frac{9 c}{\\sqrt{6}} \\frac{2\\sin(\\xi/2)\\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2} \\sqrt{2\\sin^2(\\xi/2)}} = \\frac{18 c}{\\sqrt{12}} \\frac{\\sin(\\xi/2)\\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2} \\sin(\\xi/2)} $$\n$$ c_g^{\\mathrm{FE}} = \\frac{18 c}{2\\sqrt{3}} \\frac{\\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2}} = \\frac{3\\sqrt{3} c \\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2}} $$\nThe relative velocity ratio is:\n$$ \\frac{c_g^{\\mathrm{FE}}}{c} = \\frac{3\\sqrt{3} \\cos(\\xi/2)}{(3-2\\sin^2(\\xi/2))^{3/2}} $$\nThe relative group velocity error $\\varepsilon_{g}(\\xi)$ is defined as $\\frac{c_{g}^{\\mathrm{FE}}}{c} - 1$.\n$$ \\varepsilon_{g}(\\xi) = \\frac{3\\sqrt{3} \\cos(\\xi/2)}{\\left(3 - 2\\sin^2(\\xi/2)\\right)^{3/2}} - 1 $$\nThis is the final analytical expression for the relative group velocity error.", "answer": "$$\n\\boxed{\\frac{3\\sqrt{3} \\cos(\\frac{\\xi}{2})}{\\left(3 - 2\\sin^2(\\frac{\\xi}{2})\\right)^{3/2}} - 1}\n$$", "id": "2611394"}, {"introduction": "The dispersion analysis of a semi-discrete system not only reveals its accuracy but also governs the stability of explicit time integration schemes. The maximum frequency supported by the finite element mesh dictates the largest permissible time step, a constraint known as the Courant-Friedrichs-Lewy (CFL) condition. In this exercise, you will leverage the discrete dispersion relation to derive this critical stability bound for a 1D wave problem, a foundational task in setting up reliable explicit dynamic simulations [@problem_id:2611374].", "problem": "Consider one-dimensional longitudinal wave propagation in a homogeneous elastic bar with constant Young’s modulus $E$, density $\\rho$, and cross-sectional area $A$. The displacement field $u(x,t)$ satisfies the equation of motion\n$$\n\\rho A\\,\\frac{\\partial^{2} u}{\\partial t^{2}}=\\frac{\\partial}{\\partial x}\\!\\left(EA\\,\\frac{\\partial u}{\\partial x}\\right),\n$$\nwhich, for constant $E$ and $\\rho$, can be written as\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\,\\frac{\\partial^{2} u}{\\partial x^{2}},\\quad c=\\sqrt{\\frac{E}{\\rho}}.\n$$\nDiscretize the bar spatially by the standard Galerkin finite element method using a uniform mesh of two-node linear elements of length $h$, with the consistent element mass matrix. Let $\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t)+\\mathbf{K}\\,\\mathbf{u}(t)=\\mathbf{0}$ be the resulting semi-discrete system on an effectively infinite uniform lattice (ignore boundary effects by assuming Bloch-periodic waves). Advance this system in time using the explicit central-difference scheme (the explicit Newmark family with $\\beta=0$ and $\\gamma=\\tfrac{1}{2}$).\n\nStarting from the governing partial differential equation and the finite element construction, perform a dispersion analysis on the uniform lattice to determine the highest semi-discrete frequency over all wavenumbers, and then use the amplification-factor analysis of the central-difference scheme to obtain the Courant–Friedrichs–Lewy (CFL) stability bound. What is the maximum admissible time step $\\Delta t_{\\max}$, expressed solely in terms of the mesh size $h$ and the wave speed $c$? Express your final answer in seconds in closed form (no inequalities). Do not round.", "solution": "The determination of the maximum admissible time step, $\\Delta t_{\\max}$, requires two primary steps. First, a dispersion analysis of the semi-discrete system is performed to find the highest natural frequency, $\\omega_{\\max}$, supported by the finite element mesh. Second, a stability analysis of the central-difference time integration scheme is carried out to relate $\\Delta t_{\\max}$ to $\\omega_{\\max}$.\n\nStep 1: Dispersion Analysis of the Semi-Discrete System\n\nA two-node linear finite element of length $h$ is considered. The displacement field $u(x')$ within the element, in local coordinates $x' \\in [0, h]$, is interpolated from the nodal displacements $\\mathbf{u}^e = \\begin{pmatrix} u_1  u_2 \\end{pmatrix}^T$ using linear shape functions $\\mathbf{N}(x') = \\begin{pmatrix} N_1(x')  N_2(x') \\end{pmatrix}$, where $N_1(x') = 1 - \\frac{x'}{h}$ and $N_2(x') = \\frac{x'}{h}$.\n\nThe element stiffness matrix $\\mathbf{k}^e$ is given by:\n$$\n\\mathbf{k}^e = \\int_{0}^{h} \\mathbf{B}^T (EA) \\mathbf{B} \\,dx'\n$$\nwhere $\\mathbf{B} = \\frac{d\\mathbf{N}}{dx'} = \\begin{pmatrix} -\\frac{1}{h}  \\frac{1}{h} \\end{pmatrix}$.\n$$\n\\mathbf{k}^e = EA \\int_{0}^{h} \\begin{pmatrix} -1/h \\\\ 1/h \\end{pmatrix} \\begin{pmatrix} -1/h  1/h \\end{pmatrix} \\,dx' = \\frac{EA}{h^2} \\int_{0}^{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\,dx' = \\frac{EA}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}.\n$$\n\nThe consistent element mass matrix $\\mathbf{m}^e$ is given by:\n$$\n\\mathbf{m}^e = \\int_{0}^{h} \\mathbf{N}^T (\\rho A) \\mathbf{N} \\,dx' = \\rho A \\int_0^h \\begin{pmatrix} (1 - x'/h)^2  (x'/h)(1 - x'/h) \\\\ (x'/h)(1 - x'/h)  (x'/h)^2 \\end{pmatrix} \\,dx'.\n$$\nThe evaluation of the integrals yields:\n$$\n\\mathbf{m}^e = \\rho A h \\begin{pmatrix} 1/3  1/6 \\\\ 1/6  1/3 \\end{pmatrix} = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}.\n$$\n\nFor an infinite uniform lattice, the equation of motion for a generic node $j$ is assembled from the contributions of the two adjacent elements, $(j-1, j)$ and $(j, j+1)$. This yields:\n$$\n\\frac{\\rho A h}{6} (\\ddot{u}_{j-1} + 4 \\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{EA}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0.\n$$\n\nTo perform the dispersion analysis, a Bloch-periodic wave solution is assumed of the form $u_j(t) = \\hat{u} \\exp(i(\\omega_h t - k_n j h))$, where $\\omega_h$ is the semi-discrete frequency and $k_n$ is the wavenumber. Substituting this form into the equation of motion gives:\n$$\nu_{j \\pm 1} = u_j \\exp(\\mp i k_n h) \\quad \\text{and} \\quad \\ddot{u}_j = -\\omega_h^2 u_j.\n$$\nThe equation for node $j$ becomes:\n$$\n-\\omega_h^2 \\frac{\\rho A h}{6} (\\exp(ik_n h) + 4 + \\exp(-ik_n h)) + \\frac{EA}{h} (-\\exp(ik_n h) + 2 - \\exp(-ik_n h)) = 0.\n$$\nUsing the identity $2\\cos\\theta = e^{i\\theta} + e^{-i\\theta}$, the equation simplifies to:\n$$\n-\\omega_h^2 \\frac{\\rho A h}{6} (2\\cos(k_n h) + 4) + \\frac{EA}{h} (2 - 2\\cos(k_n h)) = 0.\n$$\nSolving for $\\omega_h^2$:\n$$\n\\omega_h^2 \\frac{\\rho A h}{3} (2 + \\cos(k_n h)) = \\frac{2EA}{h} (1 - \\cos(k_n h)).\n$$\nIntroducing $c^2 = E/\\rho$, we obtain the dispersion relation for the semi-discrete system:\n$$\n\\omega_h^2 = \\frac{6c^2}{h^2} \\frac{1 - \\cos(k_n h)}{2 + \\cos(k_n h)}.\n$$\n\nThe highest semi-discrete frequency, $\\omega_{\\max}$, occurs when the term dependent on the wavenumber is maximized. Let $\\theta = k_n h$. The function to maximize is $f(\\theta) = \\frac{1 - \\cos\\theta}{2 + \\cos\\theta}$. The shortest wavelength resolved by the mesh is $\\lambda_{\\min} = 2h$, corresponding to the highest wavenumber $k_{\\max} = \\pi/h$. Thus, the domain for $\\theta$ is $[0, \\pi]$. The function $f(\\theta)$ is monotonically increasing with respect to $(-\\cos\\theta)$, and therefore is maximized when $\\cos\\theta$ is minimized. The minimum value of $\\cos\\theta$ is $-1$, which occurs at $\\theta = \\pi$ (i.e., $k_n h = \\pi$).\nSubstituting $\\cos(k_n h) = -1$ into the dispersion relation gives the square of the maximum frequency:\n$$\n\\omega_{\\max}^2 = \\frac{6c^2}{h^2} \\frac{1 - (-1)}{2 + (-1)} = \\frac{6c^2}{h^2} \\frac{2}{1} = \\frac{12c^2}{h^2}.\n$$\nThe maximum semi-discrete frequency is:\n$$\n\\omega_{\\max} = \\sqrt{\\frac{12c^2}{h^2}} = \\frac{2\\sqrt{3}c}{h}.\n$$\n\nStep 2: Stability Analysis of the Central-Difference Scheme\n\nThe semi-discrete system can be decoupled into a set of modal equations, each having the form of a simple harmonic oscillator:\n$$\n\\ddot{q}(t) + \\omega_h^2 q(t) = 0.\n$$\nThe central-difference approximation for the second derivative is $\\ddot{q}_n \\approx (q_{n+1} - 2q_n + q_{n-1})/\\Delta t^2$. Applying this to the modal equation gives:\n$$\n\\frac{q_{n+1} - 2q_n + q_{n-1}}{\\Delta t^2} + \\omega_h^2 q_n = 0.\n$$\nRearranging gives the recurrence relation:\n$$\nq_{n+1} - (2 - \\omega_h^2 \\Delta t^2) q_n + q_{n-1} = 0.\n$$\nFor a stable numerical solution, the magnitude of the roots of the characteristic polynomial $G^2 - (2 - \\omega_h^2 \\Delta t^2)G + 1 = 0$ must satisfy $|G| \\leq 1$. This condition is met if and only if the roots are complex conjugates on the unit circle, which requires the discriminant of the quadratic equation to be non-positive. A more straightforward method is to require the coefficient of $q_n$ to be within the range $[-2, 2]$.\n$$\n-2 \\le 2 - \\omega_h^2 \\Delta t^2 \\le 2.\n$$\nThe right-side inequality, $2 - \\omega_h^2 \\Delta t^2 \\le 2$, implies $-\\omega_h^2 \\Delta t^2 \\le 0$, which is always satisfied.\nThe left-side inequality, $-2 \\le 2 - \\omega_h^2 \\Delta t^2$, gives the stability condition:\n$$\n\\omega_h^2 \\Delta t^2 \\le 4 \\implies \\omega_h \\Delta t \\le 2.\n$$\nFor the entire system of equations to be stable, this condition must hold for all frequencies $\\omega_h$. The most restrictive constraint is imposed by the maximum frequency $\\omega_{\\max}$:\n$$\n\\omega_{\\max} \\Delta t \\le 2.\n$$\nThe maximum admissible time step is therefore:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}}.\n$$\n\nStep 3: Final Result\n\nSubstituting the expression for $\\omega_{\\max}$ from Step 1 into the stability limit from Step 2:\n$$\n\\Delta t_{\\max} = \\frac{2}{2\\sqrt{3}c/h} = \\frac{h}{\\sqrt{3}c}.\n$$\nThis expression can be rewritten using the Courant number, $C_n = c\\Delta t/h$. The stability limit is $C_n \\le 1/\\sqrt{3}$. The maximum time step is the equality case.\n\nThe final answer is the maximum admissible time step $\\Delta t_{\\max}$ expressed solely in terms of the mesh size $h$ and the wave speed $c$.\n$$\n\\Delta t_{\\max} = \\frac{h}{c\\sqrt{3}}.\n$$", "answer": "$$\n\\boxed{\\frac{h}{c\\sqrt{3}}}\n$$", "id": "2611374"}, {"introduction": "Our understanding of numerical dispersion is not just for analyzing simulation errors; it is a powerful tool for interpreting real-world data. When extracting physical parameters like wave speed from measured signals, a naive model that ignores discretization effects can lead to biased estimates. This hands-on programming exercise challenges you to use the derived finite element dispersion relation as a more accurate physical model for data fitting and to apply a bootstrap method to quantify the uncertainty in the estimated wave speed [@problem_id:2611327].", "problem": "You are given a one-dimensional, homogeneous, linearly elastic rod discretized by standard two-node linear finite elements with consistent mass on a uniform mesh of element size $h$ and nodal spacing $h$. Small-amplitude axial waves propagate with longitudinal wave speed $c = \\sqrt{E/\\rho}$, where $E$ is the Young’s modulus and $\\rho$ is the mass density. Let $u(x,t)$ denote the axial displacement, $x$ the spatial coordinate in meters, and $t$ the time in seconds. You will analyze dispersion extraction from finite-element data contaminated by additive noise, quantify uncertainty due to both noise and discretization error, and implement a residual bootstrap to compute two-sided confidence intervals for the inferred wave speed.\n\nStarting point and scope:\n- Begin from the axial wave equation $u_{tt}(x,t) = c^2 u_{xx}(x,t)$ and the standard linear finite element semi-discretization using consistent mass on a uniform mesh. Assume a discrete spatial Fourier (Bloch) ansatz across the nodes indexed by integers, with nodal spacing equal to $h$.\n- Do not assume any dispersion formula at the outset. You must derive, from first principles, the semi-discrete dispersion relation that links the angular frequency $\\omega$ and the wavenumber $k$ for the consistent-mass, linear-element semi-discretization on a uniform grid.\n- Treat the “measured” dispersion data as noisy samples of angular frequency $\\omega$ at prescribed wavenumbers $k$, with additive, independent, zero-mean noise in $\\omega$ having a known standard deviation $\\sigma_\\omega$ (in $\\mathrm{rad/s}$).\n- Define and compare two estimators for $c$:\n  1. A naive estimator that ignores discretization and fits the continuous model $\\omega \\approx c\\,k$ by least squares through the origin.\n  2. A model-based nonlinear least-squares estimator that fits the semi-discrete finite-element dispersion relation you derive.\n- Propose and implement a residual bootstrap procedure for each estimator to construct a two-sided $95$ percent confidence interval (express the bounds as decimal numbers, without using the percent symbol in the output, and report the interval endpoints for $c$ in $\\mathrm{m/s}$).\n\nDerivation requirements:\n- Starting from $u_{tt}(x,t) = c^2 u_{xx}(x,t)$, the standard linear finite element method with consistent mass on a uniform mesh of spacing $h$, and a discrete Bloch wave ansatz $u_j(t) = \\operatorname{Re}\\{U\\,e^{\\mathrm{i}(j q - \\omega t)}\\}$ with $q = k h$, derive a closed-form semi-discrete dispersion relation that links $\\omega$, $k$, $c$, and $h$.\n\nStatistical modeling and bootstrap requirements:\n- Suppose the “measured” data are $N$ pairs $(k_i, \\omega_i)$ with $k_i$ in $\\mathrm{rad/m}$ and $\\omega_i$ in $\\mathrm{rad/s}$. Model $\\omega_i = \\omega_\\text{FE}(k_i; c, h) + \\varepsilon_i$ for the model-based estimator, where $\\omega_\\text{FE}$ is the semi-discrete dispersion relation you derive and $\\varepsilon_i$ are independent with zero mean and finite variance. For the naive estimator, replace $\\omega_\\text{FE}(k_i; c, h)$ by $c\\,k_i$.\n- For each estimator: compute the least-squares fit to obtain $\\widehat{c}$, compute residuals $r_i = \\omega_i - \\widehat{\\omega}_i$, center the residuals by subtracting their sample mean to obtain $r_i^\\circ$, and perform a residual bootstrap with $B$ resamples:\n  - For each bootstrap replicate $b \\in \\{1,\\dots,B\\}$, draw $N$ residuals with replacement from $\\{r_i^\\circ\\}$, form synthetic responses $\\omega_i^{*(b)} = \\widehat{\\omega}_i + r_{j(i)}^\\circ$, refit to obtain $\\widehat{c}^{*(b)}$, and store the result.\n  - Use the empirical quantiles at levels $0.025$ and $0.975$ of $\\{\\widehat{c}^{*(b)}\\}_{b=1}^B$ to construct a two-sided $95$ percent confidence interval for $c$. Report all velocities in $\\mathrm{m/s}$.\n\nNumerical experiment design (test suite):\n- Use the following independent test cases. In each case, generate synthetic “measured” data by choosing $N$ wavenumbers linearly spaced between $k_{\\min}$ and $k_{\\max}$, computing noiseless $\\omega_\\text{FE}(k_i; c_\\text{true}, h)$, and then adding independent Gaussian noise with standard deviation $\\sigma_\\omega$ (in $\\mathrm{rad/s}$).\n- Fix the random number generator seed to $s=7$ for reproducibility.\n- For each test case, use $B=200$ bootstrap replicates.\n- The three test cases are:\n  1. Case A: $c_\\text{true} = 5100\\,\\mathrm{m/s}$, $h = 0.02\\,\\mathrm{m}$, $N = 40$, $k_{\\min} = 0.10\\,\\pi/h$, $k_{\\max} = 0.80\\,\\pi/h$, $\\sigma_\\omega = 20000\\,\\mathrm{rad/s}$.\n  2. Case B: $c_\\text{true} = 4800\\,\\mathrm{m/s}$, $h = 0.05\\,\\mathrm{m}$, $N = 60$, $k_{\\min} = 0.15\\,\\pi/h$, $k_{\\max} = 0.90\\,\\pi/h$, $\\sigma_\\omega = 50000\\,\\mathrm{rad/s}$.\n  3. Case C: $c_\\text{true} = 5200\\,\\mathrm{m/s}$, $h = 0.02\\,\\mathrm{m}$, $N = 30$, $k_{\\min} = 0.01\\,\\pi/h$, $k_{\\max} = 0.10\\,\\pi/h$, $\\sigma_\\omega = 5000\\,\\mathrm{rad/s}$.\n\nProgramming task:\n- Implement a complete, runnable program that:\n  - Derives and uses the semi-discrete dispersion relation you obtained to synthesize $\\omega_i$ and to fit the model-based estimator.\n  - Implements both estimators and their $B=200$ residual bootstraps.\n  - For each test case, returns a list of six floating-point numbers in $\\mathrm{m/s}$: $[\\widehat{c}_\\text{naive}, c_{\\text{naive},\\;0.025}, c_{\\text{naive},\\;0.975}, \\widehat{c}_\\text{FE}, c_{\\text{FE},\\;0.025}, c_{\\text{FE},\\;0.975}]$, where the subscripts denote the lower and upper bounds of the two-sided $95$ percent confidence interval.\n  - Round each reported number to three decimal places.\n- Final output format:\n  - Your program should produce a single line of output containing the results as a comma-separated list of the three per-case lists enclosed in square brackets. For example, an output of the correct shape looks like: $[[a_1,a_2,a_3,a_4,a_5,a_6],[b_1,b_2,b_3,b_4,b_5,b_6],[c_1,c_2,c_3,c_4,c_5,c_6]]$, where all symbols denote floating-point numbers in $\\mathrm{m/s}$.", "solution": "The task requires the derivation of the semi-discrete dispersion relation for axial waves in a rod, the implementation of two distinct estimators for the wave speed $c$, and the quantification of uncertainty using a residual bootstrap procedure.\n\n**1. Derivation of the Semi-Discrete Dispersion Relation**\n\nThe governing equation for small-amplitude axial waves in a homogeneous, linearly elastic rod is the one-dimensional wave equation:\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $u(x,t)$ is the axial displacement, $t$ is time, $x$ is the spatial coordinate, and $c = \\sqrt{E/\\rho}$ is the longitudinal wave speed, with $E$ being the Young's modulus and $\\rho$ the mass density.\n\nWe apply the finite element method using standard two-node linear elements on a uniform mesh of nodal spacing $h$. The weak form of the governing equation, integrated over the domain and with integration by parts on the spatial term, is:\n$$\n\\int \\rho v \\frac{\\partial^2 u}{\\partial t^2} \\,dx + \\int E v_x u_x \\,dx = 0\n$$\nwhere $v$ is a suitable test function and we assume vanishing boundary terms. For a single element of length $h$, the standard linear shape functions lead to the element consistent mass matrix $\\mathbf{M}^e$ and stiffness matrix $\\mathbf{K}^e$:\n$$\n\\mathbf{M}^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad \\mathbf{K}^e = \\frac{E A}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\nwhere $A$ is the cross-sectional area. The semi-discretized system for the vector of nodal displacements $\\mathbf{U}(t)$ is $\\mathbf{M} \\ddot{\\mathbf{U}} + \\mathbf{K} \\mathbf{U} = \\mathbf{0}$. For an infinite, uniform grid, we can write the equation of motion for a generic interior node $j$ by assembling contributions from the two adjacent elements, $(j-1, j)$ and $(j, j+1)$. This yields:\n$$\n\\frac{\\rho A h}{6} (\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{E A}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\nDividing by $\\rho A$ and using $c^2 = E/\\rho$, we obtain:\n$$\n\\frac{h}{6} (\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{c^2}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0\n$$\nWe seek a discrete plane wave (Bloch wave) solution of the form $u_j(t) = U e^{\\mathrm{i}(jkh - \\omega t)}$, where $k$ is the wavenumber and $\\omega$ is the angular frequency. The second time derivative is $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$. Substituting this and the spatial form into the equation of motion gives:\n$$\n-\\omega^2 \\frac{h}{6} (e^{-\\mathrm{i}kh} + 4 + e^{\\mathrm{i}kh}) u_j + \\frac{c^2}{h} (-e^{-\\mathrm{i}kh} + 2 - e^{\\mathrm{i}kh}) u_j = 0\n$$\nDividing by $u_j$ and using the identity $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$, we simplify the expression:\n$$\n-\\omega^2 \\frac{h}{6} (2\\cos(kh) + 4) + \\frac{c^2}{h} (2 - 2\\cos(kh)) = 0\n$$\nRearranging to solve for $\\omega^2$:\n$$\n\\omega^2 \\frac{h}{3} (2 + \\cos(kh)) = \\frac{2c^2}{h} (1 - \\cos(kh))\n$$\nThis leads to the semi-discrete dispersion relation for consistent-mass linear finite elements:\n$$\n\\omega^2 = \\frac{6c^2}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)}\n$$\nFor positive frequencies, the explicit relation is:\n$$\n\\omega_\\text{FE}(k; c, h) = c \\sqrt{\\frac{6}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)}}\n$$\nThis relation correctly recovers the continuum dispersion $\\omega = ck$ in the long-wavelength limit ($kh \\to 0$).\n\n**2. Wave Speed Estimators**\n\nGiven a set of $N$ noisy measurements $(k_i, \\omega_i)$, we define two estimators for $c$.\n\n**Naive Estimator**: This estimator ignores the numerical dispersion introduced by the finite element discretization and assumes the continuum model $\\omega \\approx ck$. The data model is $\\omega_i = c k_i + \\varepsilon_i$. This is a linear regression problem through the origin. The least-squares estimate $\\widehat{c}_\\text{naive}$ minimizes $\\sum_{i=1}^N (\\omega_i - c k_i)^2$, which yields:\n$$\n\\widehat{c}_\\text{naive} = \\frac{\\sum_{i=1}^N k_i \\omega_i}{\\sum_{i=1}^N k_i^2}\n$$\n\n**Model-Based (FE) Estimator**: This estimator uses the derived semi-discrete dispersion relation. The data model is $\\omega_i = \\omega_\\text{FE}(k_i; c, h) + \\varepsilon_i$. We can rewrite the model as:\n$$\n\\omega_i = c \\cdot f(k_i, h) + \\varepsilon_i, \\quad \\text{where} \\quad f(k, h) = \\sqrt{\\frac{6}{h^2} \\frac{1 - \\cos(kh)}{2 + \\cos(kh)}}\n$$\nAlthough the model is a nonlinear function of $k$, it is linear in the parameter $c$ to be estimated (since $h$ is known). The problem is again a linear regression through the origin, just with a transformed independent variable. The least-squares estimate $\\widehat{c}_\\text{FE}$ minimizes $\\sum_{i=1}^N (\\omega_i - c \\cdot f(k_i, h))^2$, yielding:\n$$\n\\widehat{c}_\\text{FE} = \\frac{\\sum_{i=1}^N f(k_i, h) \\omega_i}{\\sum_{i=1}^N f(k_i, h)^2}\n$$\n\n**3. Uncertainty Quantification: Residual Bootstrap**\n\nTo construct a $95$-percent confidence interval for $c$ for each estimator, we employ a residual bootstrap method. This non-parametric approach avoids strong assumptions about the error distribution or the estimator's sampling distribution. The procedure is as follows:\n1.  Compute the point estimate $\\widehat{c}$ (either $\\widehat{c}_\\text{naive}$ or $\\widehat{c}_\\text{FE}$).\n2.  Calculate the predicted frequencies $\\widehat{\\omega}_i$ based on the fitted model (i.e., $\\widehat{\\omega}_i = \\widehat{c} k_i$ or $\\widehat{\\omega}_i = \\widehat{c} f(k_i, h)$).\n3.  Compute the residuals $r_i = \\omega_i - \\widehat{\\omega}_i$.\n4.  Center the residuals to ensure their mean is zero: $r_i^\\circ = r_i - \\frac{1}{N}\\sum_{j=1}^N r_j$.\n5.  Perform $B$ bootstrap replications. For each replicate $b = 1, \\dots, B$:\n    a. Draw a new set of $N$ residuals $\\{r_{j(i)}^\\circ\\}$ by sampling with replacement from the set of centered residuals $\\{r_i^\\circ\\}$.\n    b. Create a synthetic dataset of frequencies: $\\omega_i^{*(b)} = \\widehat{\\omega}_i + r_{j(i)}^\\circ$.\n    c. Recompute the estimate $\\widehat{c}^{*(b)}$ using the synthetic data $(\\omega_i^{*(b)}, k_i)$.\n6.  The collection of bootstrap estimates $\\{\\widehat{c}^{*(b)}\\}_{b=1}^B$ forms an empirical approximation of the sampling distribution of $\\widehat{c}$. A two-sided $95$-percent confidence interval for $c$ is given by the $2.5$-th and $97.5$-th percentiles of this distribution.\n\n**4. Implementation Strategy**\n\nThe numerical experiment will be implemented in Python using the `numpy` and `scipy` libraries.\n- For each test case, synthetic \"measured\" data $(\\omega_i, k_i)$ are generated. The wavenumbers $k_i$ are linearly spaced in the specified range. The true frequencies are computed using $\\omega_{\\text{true},i} = \\omega_\\text{FE}(k_i; c_\\text{true}, h)$. Gaussian noise with zero mean and standard deviation $\\sigma_\\omega$ is then added. A fixed random seed ensures reproducibility.\n- The least-squares estimates for $c$ are computed efficiently using `scipy.linalg.lstsq`, which solves the linear matrix equation arising from the normal equations.\n- The residual bootstrap procedure is implemented as described above for $B=200$ replicates.\n- The final output for each case consists of the point estimates and confidence interval bounds for both the naive and model-based estimators, rounded to three decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import lstsq\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating wave speed `c` from noisy dispersion data\n    using two different models and quantifies uncertainty via residual bootstrap.\n    \"\"\"\n    # Fix the random number generator seed for reproducibility.\n    RNG = np.random.default_rng(7)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"c_true\": 5100.0, \"h\": 0.02, \"N\": 40,\n            \"k_min_factor\": 0.10, \"k_max_factor\": 0.80, \"sigma_omega\": 20000.0,\n        },\n        # Case B\n        {\n            \"c_true\": 4800.0, \"h\": 0.05, \"N\": 60,\n            \"k_min_factor\": 0.15, \"k_max_factor\": 0.90, \"sigma_omega\": 50000.0,\n        },\n        # Case C\n        {\n            \"c_true\": 5200.0, \"h\": 0.02, \"N\": 30,\n            \"k_min_factor\": 0.01, \"k_max_factor\": 0.10, \"sigma_omega\": 5000.0,\n        },\n    ]\n\n    B = 200  # Number of bootstrap replicates\n\n    def omega_fe_func(k, c, h):\n        \"\"\"Calculates angular frequency from the derived FE dispersion relation.\"\"\"\n        kh = k * h\n        # This term can be nan if cos(kh) is -2, but that's impossible.\n        # Add a small epsilon to denominator to be safe, though not strictly needed here.\n        denominator = h**2 * (2.0 + np.cos(kh))\n        \n        # Check for non-physical denominator (should not happen for real kh)\n        # but good practice for numerical stability\n        if np.any(denominator = 0):\n             raise ValueError(\"Division by zero or negative value in dispersion relation.\")\n             \n        numerator = 6.0 * (c**2) * (1.0 - np.cos(kh))\n        return np.sqrt(numerator / denominator)\n\n    def perform_bootstrap_analysis(k_data, omega_data, h, estimator_type):\n        \"\"\"\n        Performs point estimation and residual bootstrap for a given estimator type.\n        \"\"\"\n        \n        if estimator_type == 'naive':\n            # Model: omega = c * k\n            A = k_data[:, np.newaxis]\n        elif estimator_type == 'fe':\n            # Model: omega = c * f(k,h)\n            kh = k_data * h\n            fe_factor = np.sqrt(6.0 / h**2 * (1.0 - np.cos(kh)) / (2.0 + np.cos(kh)))\n            A = fe_factor[:, np.newaxis]\n        else:\n            raise ValueError(\"Unknown estimator type.\")\n\n        # 1. Point Estimation using least squares\n        c_hat_vec, _, _, _ = lstsq(A, omega_data)\n        c_hat = c_hat_vec[0]\n\n        # 2. Compute and center residuals\n        omega_hat = A.flatten() * c_hat\n        residuals = omega_data - omega_hat\n        centered_residuals = residuals - np.mean(residuals)\n        \n        # 3. Perform bootstrap\n        c_bootstrap_samples = np.zeros(B)\n        for i in range(B):\n            # Resample residuals with replacement\n            bootstrap_residuals = RNG.choice(centered_residuals, size=len(k_data), replace=True)\n            # Create synthetic data\n            omega_star = omega_hat + bootstrap_residuals\n            # Re-estimate c on synthetic data\n            c_star_vec, _, _, _ = lstsq(A, omega_star)\n            c_bootstrap_samples[i] = c_star_vec[0]\n            \n        # 4. Determine confidence interval from percentiles\n        ci_lower, ci_upper = np.percentile(c_bootstrap_samples, [2.5, 97.5])\n        \n        return [c_hat, ci_lower, ci_upper]\n\n    all_results = []\n    for case in test_cases:\n        # Generate synthetic data for the current test case\n        h = case[\"h\"]\n        N = case[\"N\"]\n        c_true = case[\"c_true\"]\n        sigma_omega = case[\"sigma_omega\"]\n        \n        k_min = case[\"k_min_factor\"] * np.pi / h\n        k_max = case[\"k_max_factor\"] * np.pi / h\n        k_values = np.linspace(k_min, k_max, N)\n        \n        # Ground truth frequencies based on FE model\n        omega_true = omega_fe_func(k_values, c_true, h)\n        \n        # \"Measured\" frequencies with additive Gaussian noise\n        noise = RNG.normal(0, sigma_omega, N)\n        omega_measured = omega_true + noise\n        \n        # Analyze using the naive estimator\n        naive_results = perform_bootstrap_analysis(k_values, omega_measured, h, 'naive')\n        \n        # Analyze using the model-based FE estimator\n        fe_results = perform_bootstrap_analysis(k_values, omega_measured, h, 'fe')\n        \n        # Combine results for the case and round to 3 decimal places\n        case_results = [round(x, 3) for x in naive_results + fe_results]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified\n    str_results = []\n    for res_list in all_results:\n        str_list = f\"[{','.join(map(str, res_list))}]\"\n        str_results.append(str_list)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```", "id": "2611327"}]}