{"hands_on_practices": [{"introduction": "Monolithic solvers are often essential for coupled problems that are prone to numerical 'locking,' a phenomenon where a poor choice of solution strategy can render the system artificially stiff. This practice demonstrates this pitfall with a simplified poroelasticity problem, where you will see how a naive staggered scheme can fail catastrophically by producing a nonphysical, locked solution. This stark contrast with the successful monolithic approach provides a powerful motivation for employing robustly coupled solution methods in challenging multiphysics simulations. [@problem_id:2598463]", "problem": "Consider one-dimensional linear poroelasticity (Biot theory) on the interval $[0,1]$ with cross-sectional area $A=1$. The unknowns are the solid displacement $u(x,t)$ and the pore pressure $p(x,t)$. The quasi-static balance of linear momentum and the fluid mass conservation law are, respectively,\n- balance of momentum: $\\nabla \\cdot \\sigma' - \\alpha \\nabla p = 0$ with $\\sigma' = E \\nabla u$ in one dimension,\n- fluid mass conservation: $s\\,\\dot{p} + \\alpha\\,\\nabla \\cdot \\dot{u} = w$, with zero Darcy flux (impermeable) so that no diffusion term appears.\n\nHere $E>0$ is the drained elastic modulus, $\\alpha \\in (0,1]$ is the Biot coefficient, $s>0$ is the specific storage, and $w$ is a prescribed volumetric fluid source per unit length.\n\nDiscretize the domain into two equal linear finite elements of length $h=1/2$. Use $P_1$ (continuous, piecewise-linear) for displacement and $P_0$ (discontinuous, elementwise-constant) for pressure, with nodal displacement unknowns $\\{u_0,u_1,u_2\\}$ and elementwise pressures $\\{p_1,p_2\\}$. Impose $u(0,t)=0$ (so $u_0=0$) and traction-free boundary at $x=1$, and take initial conditions $u^n(x)=0$, $p^n(x)=0$ at time $t^n$. At the next time $t^{n+1}=t^n+\\Delta t$, apply a uniform fluid source $w^{n+1}=W$ (constant in space and time step), with no external mechanical tractions.\n\nAdopt backward Euler time discretization. For this single time step from $t^n$ to $t^{n+1}$, do the following.\n\n1. Form the semi-discrete $P_1$–$P_0$ mixed system in matrix form for the monolithic solve at $t^{n+1}$:\n   - the displacement block $K$ comes from the standard $P_1$ stiffness assembly in one dimension;\n   - the displacement–pressure coupling is via the discrete divergence operator $B$ consistent with the weak form;\n   - the storage term contributes a diagonal block proportional to $s h$ for the $P_0$ pressure space;\n   - the source contributes a load vector proportional to $h \\Delta t W$ in the pressure equations.\n\n2. Solve the monolithic system to obtain the right-end nodal displacement $u^{n+1}_{\\mathrm{mono}} := u_2^{n+1}$ as a closed-form expression in the parameters $E$, $\\alpha$, $s$, $\\Delta t$, and $W$.\n\n3. Consider a naive staggered (segregated) scheme that first solves the mechanics subproblem with the pressure lagged at its previous time level, and then solves the mass conservation subproblem with the freshly computed displacement. For this scheme, compute the right-end nodal displacement $u^{n+1}_{\\mathrm{stag}} := u_2^{n+1}$ at the end of the same time step, under the same data.\n\nFinally, compute the ratio\n$$\nR = \\frac{u^{n+1}_{\\mathrm{stag}}}{u^{n+1}_{\\mathrm{mono}}}\n$$\nProvide the exact value of $R$ as your final answer. No numerical values are to be substituted for $E$, $\\alpha$, $s$, $\\Delta t$, or $W$. The ratio is dimensionless, so no units are required. Your final answer must be a single number or a single closed-form expression.", "solution": "The problem requires the analysis of a one-dimensional linear poroelastic system, comparing a monolithic solution to a staggered solution for a single time step.\n\nFirst, we establish the weak formulation of the governing equations. The domain is the interval $\\Omega = [0,1]$. The unknowns are the solid displacement $u(x,t)$ and the pore pressure $p(x,t)$. The strong form of the quasi-static equations is given as:\nBalance of momentum: $E \\frac{\\partial^2 u}{\\partial x^2} - \\alpha \\frac{\\partial p}{\\partial x} = 0$ for $x \\in (0,1)$.\nFluid mass conservation: $s \\frac{\\partial p}{\\partial t} + \\alpha \\frac{\\partial^2 u}{\\partial x \\partial t} = w$.\n\nLet $V$ be the space of test functions for displacement, and $Q$ be the space for pressure test functions. We multiply the momentum equation by a test function $v \\in V$ and integrate over $\\Omega$.\n$\\int_0^1 \\left( E \\frac{\\partial^2 u}{\\partial x^2} \\right) v \\,dx - \\int_0^1 \\left( \\alpha \\frac{\\partial p}{\\partial x} \\right) v \\,dx = 0$.\nIntegrating by parts yields:\n$\\left[ E \\frac{\\partial u}{\\partial x} v \\right]_0^1 - \\int_0^1 E \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx - \\left[ \\alpha p v \\right]_0^1 + \\int_0^1 \\alpha p \\frac{\\partial v}{\\partial x} \\,dx = 0$.\nThe boundary conditions are $u(0,t)=0$ and traction-free at $x=1$. The traction-free condition means the total stress $\\sigma = E \\frac{\\partial u}{\\partial x} - \\alpha p$ is zero at $x=1$. Test functions for displacement must satisfy the essential boundary condition, so $v(0)=0$. The boundary terms become:\n$[ (E \\frac{\\partial u}{\\partial x} - \\alpha p) v ]_0^1 = (E \\frac{\\partial u}{\\partial x}(1) - \\alpha p(1))v(1) - (E \\frac{\\partial u}{\\partial x}(0) - \\alpha p(0))v(0) = 0 \\cdot v(1) - \\dots \\cdot 0 = 0$.\nThe weak form of the momentum balance is thus:\n$\\int_0^1 E \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx - \\int_0^1 \\alpha p \\frac{\\partial v}{\\partial x} \\,dx = 0$.\n\nFor the mass conservation equation, we multiply by a test function $q \\in Q$ and integrate over $\\Omega$:\n$\\int_0^1 s \\frac{\\partial p}{\\partial t} q \\,dx + \\int_0^1 \\alpha \\frac{\\partial^2 u}{\\partial x \\partial t} q \\,dx = \\int_0^1 w q \\,dx$.\n\nWe apply the backward Euler method for time discretization. For a generic function $f(t)$, $\\dot{f}(t^{n+1}) \\approx \\frac{f^{n+1}-f^n}{\\Delta t}$. Given initial conditions $u^n=0$ and $p^n=0$, and source $w^{n+1}=W$, the time-discretized weak forms at time $t^{n+1}$ are:\n1. $\\int_0^1 E \\frac{d u^{n+1}}{d x} \\frac{d v}{d x} \\,dx - \\int_0^1 \\alpha p^{n+1} \\frac{d v}{d x} \\,dx = 0$.\n2. $\\int_0^1 \\frac{s}{\\Delta t} p^{n+1} q \\,dx + \\int_0^1 \\frac{\\alpha}{\\Delta t} \\frac{d u^{n+1}}{d x} q \\,dx = \\int_0^1 W q \\,dx$.\n\nThe spatial discretization uses two equal linear elements of length $h=1/2$. Displacement $u$ is approximated using continuous, piecewise-linear ($P_1$) functions, and pressure $p$ using piecewise-constant ($P_0$) functions. The nodal displacements are $\\{u_0, u_1, u_2\\}$ at nodes $x_0=0$, $x_1=h$, $x_2=2h=1$. The elemental pressures are $\\{p_1, p_2\\}$.\nThe condition $u(0,t)=0$ implies $u_0=0$. The discrete unknowns are $\\mathbf{U} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ and $\\mathbf{P} = \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}$.\n\nThe semi-discrete system can be written in block matrix form:\n$$\n\\begin{pmatrix} K  -\\alpha B^T \\\\ \\frac{\\alpha}{\\Delta t} B  \\frac{s}{\\Delta t} M_p \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{U}^{n+1} \\\\ \\mathbf{P}^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{F}_W \\end{pmatrix}\n$$\nwhere the matrix and vector components are derived from the weak forms:\n- Stiffness matrix $K_{ij} = \\int_0^1 E N'_i N'_j \\,dx$. For the $2$ active degrees of freedom ($u_1, u_2$), this assembles to $K = \\frac{E}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix}$.\n- Coupling matrix $B_{ki} = \\int_0^1 N'_i \\Psi_k \\,dx$. $\\Psi_k$ is the basis function for pressure on element $k$ (characteristic function of the element).\n  $B_{11} = \\int_0^h N'_1 \\,dx = \\int_0^h \\frac{1}{h} \\,dx = 1$.\n  $B_{12} = \\int_0^h N'_2 \\,dx = 0$.\n  $B_{21} = \\int_h^{2h} N'_1 \\,dx = \\int_h^{2h} (-\\frac{1}{h}) \\,dx = -1$.\n  $B_{22} = \\int_h^{2h} N'_2 \\,dx = \\int_h^{2h} \\frac{1}{h} \\,dx = 1$.\n  So, $B = \\begin{pmatrix} 1  0 \\\\ -1  1 \\end{pmatrix}$, and $B^T = \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix}$.\n- Pressure mass matrix $(M_p)_{kl} = \\int_0^1 \\Psi_k \\Psi_l \\,dx$. For $P_0$ elements, this is diagonal: $M_p = h \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$.\n- Fluid source vector $(\\mathbf{F}_W)_k = \\int_0^1 \\frac{W}{\\Delta t} \\Psi_k \\,dx$. This gives $\\mathbf{F}_W = \\frac{W h}{\\Delta t} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nMultiplying the second block row by $\\Delta t$, the monolithic system is:\n$$\n\\begin{pmatrix} K  -\\alpha B^T \\\\ \\alpha B  s M_p \\end{pmatrix}\n\\begin{pmatrix} \\mathbf{U}^{n+1} \\\\ \\mathbf{P}^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} \\mathbf{0} \\\\ \\Delta t W h \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\end{pmatrix}\n$$\nSubstituting the matrices and vectors:\n$$\n\\begin{pmatrix}\n\\frac{E}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix}  -\\alpha \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix} \\\\\n\\alpha \\begin{pmatrix} 1  0 \\\\ -1  1 \\end{pmatrix}  sh \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ p_1 \\\\ p_2 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ \\Delta t W h \\\\ \\Delta t W h \\end{pmatrix}\n$$\nThis gives four linear equations:\n(1) $\\frac{2E}{h} u_1 - \\frac{E}{h} u_2 - \\alpha p_1 + \\alpha p_2 = 0$\n(2) $-\\frac{E}{h} u_1 + \\frac{E}{h} u_2 - \\alpha p_2 = 0$\n(3) $\\alpha u_1 + sh p_1 = \\Delta t W h$\n(4) $-\\alpha u_1 + \\alpha u_2 + sh p_2 = \\Delta t W h$\n\nFrom (1) and (2):\nAdd (1) and (2): $\\frac{E}{h} u_1 - \\alpha p_1 = 0 \\implies p_1 = \\frac{E}{\\alpha h} u_1$.\nNow substitute this into (3): $\\alpha u_1 + sh \\left(\\frac{E}{\\alpha h} u_1\\right) = \\Delta t W h \\implies u_1 \\left(\\alpha + \\frac{sE}{\\alpha}\\right) = \\Delta t W h \\implies u_1 \\left(\\frac{\\alpha^2+sE}{\\alpha}\\right) = \\Delta t W h$.\n$u_1 = \\frac{\\alpha \\Delta t W h}{\\alpha^2 + sE}$.\nNow from (2), substitute $p_2$ into (4):\n$-\\alpha u_1 + \\alpha u_2 + sh \\left(\\frac{E}{\\alpha h}(u_2-u_1)\\right) = \\Delta t W h$.\n$u_2(\\alpha + \\frac{sE}{\\alpha}) - u_1(\\alpha + \\frac{sE}{\\alpha}) = \\Delta t W h$.\n$(u_2 - u_1)\\left(\\frac{\\alpha^2+sE}{\\alpha}\\right) = \\Delta t W h$.\n$u_2 - u_1 = \\frac{\\alpha \\Delta t W h}{\\alpha^2 + sE}$.\nComparing the expressions for $u_1$ and $u_2-u_1$, we see that $u_1 = u_2 - u_1$, which implies $u_2=2u_1$.\nSo, $u^{n+1}_{\\mathrm{mono}} = u_2^{n+1} = 2u_1 = \\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}$.\n\nNow we analyze the naive staggered scheme. The scheme is described as:\n1. Solve the mechanics subproblem for $\\mathbf{U}^{n+1}$ using the pressure from the previous time step, $\\mathbf{P}^n$.\n2. Solve the mass conservation subproblem for $\\mathbf{P}^{n+1}$ using the newly computed displacement $\\mathbf{U}^{n+1}$.\n\nStep 1: The mechanics subproblem is $K \\mathbf{U}^{n+1} - \\alpha B^T \\mathbf{P}^n = \\mathbf{0}$.\nThe initial pressure is given as $p^n(x)=0$, so $\\mathbf{P}^n = \\mathbf{0}$.\nThe equation becomes $K \\mathbf{U}^{n+1} = \\mathbf{0}$.\nThe matrix $K = \\frac{E}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix}$ corresponding to the unconstrained degrees of freedom is invertible because its determinant is $(\\frac{E}{h})^2(2-1) = \\frac{E^2}{h^2} \\ne 0$.\nThe unique solution to $K \\mathbf{U}^{n+1} = \\mathbf{0}$ is $\\mathbf{U}^{n+1} = \\mathbf{0}$.\nThis means $u_1^{n+1} = 0$ and $u_2^{n+1} = 0$.\nThe displacement at the right end for the staggered scheme is therefore $u^{n+1}_{\\mathrm{stag}} = u_2^{n+1} = 0$.\n\nThe second step of the staggered scheme, though not needed for the final answer, would be to solve for pressure:\n$\\alpha B \\mathbf{U}^{n+1} + s M_p \\mathbf{P}^{n+1} = \\Delta t W h \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\nUsing $\\mathbf{U}^{n+1}=\\mathbf{0}$, we get $s M_p \\mathbf{P}^{n+1} = \\Delta t W h \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, which yields $p_1^{n+1}=p_2^{n+1}=\\frac{\\Delta t W}{s}$.\n\nThe problem asks for the ratio $R = \\frac{u^{n+1}_{\\mathrm{stag}}}{u^{n+1}_{\\mathrm{mono}}}$.\nWe have $u^{n+1}_{\\mathrm{stag}} = 0$ and $u^{n+1}_{\\mathrm{mono}} = \\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}$.\nTo ensure the problem is non-trivial and the ratio is well-defined, we assume the source term $W \\ne 0$. All other parameters ($E, \\alpha, s, \\Delta t, h$) are positive, so $u^{n+1}_{\\mathrm{mono}} \\neq 0$.\nThe ratio is therefore:\n$$\nR = \\frac{0}{\\frac{2 \\alpha \\Delta t W h}{sE + \\alpha^2}} = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "2598463"}, {"introduction": "Beyond overt failures like locking, staggered schemes can suffer from more subtle, unphysical behaviors such as numerical instability. A valid numerical method should not artificially create energy in a system that is physically dissipative, yet some partitioned schemes do exactly that. This exercise uses a simplified thermoelastic model to demonstrate analytically how a common 'loosely coupled' staggered approach can spuriously inject mechanical energy, revealing a critical flaw that monolithic schemes inherently avoid by enforcing a consistent energy balance. [@problem_id:2598449]", "problem": "Consider a reduced finite element method (FEM) model of linear thermoelasticity with a single mechanical degree of freedom $u \\in \\mathbb{R}$ and a single thermal degree of freedom $\\theta \\in \\mathbb{R}$ representing a single spatial mode. The Helmholtz free energy at any configuration $(u,\\theta)$ is\n$$\n\\Psi(u,\\theta) \\;=\\; \\frac{1}{2}\\,k\\,\\big(u - \\alpha\\,\\theta\\big)^{2} \\;+\\; \\frac{1}{2}\\,\\eta\\,\\theta^{2},\n$$\nwith stiffness $k>0$, thermal expansion coefficient $\\alpha \\neq 0$, and thermal storage coefficient $\\eta>0$. The thermal evolution obeys the linear first-order balance law\n$$\nM\\,\\dot{\\theta} \\;+\\; L\\,\\theta \\;=\\; 0,\n$$\nwith $M>0$ the lumped heat capacity and $L>0$ a lumped conduction parameter. Time discretization is performed with backward Euler over a time step $\\Delta t>0$, so that $\\theta^{n+1}$ satisfies\n$$\n\\frac{M}{\\Delta t}\\,\\big(\\theta^{n+1} - \\theta^{n}\\big) \\;+\\; L\\,\\theta^{n+1} \\;=\\; 0,\n$$\nwhich is equivalent to \n$$\n\\theta^{n+1} = r\\,\\theta^{n} \\quad \\text{with} \\quad r = \\frac{M}{M + L\\,\\Delta t} \\in (0,1)\n$$\nTwo solution strategies are considered at each time step from $t^{n}$ to $t^{n+1}$:\n\n(a) A monolithic solve enforces mechanical equilibrium and the thermal update simultaneously, i.e., $k\\,(u^{n+1} - \\alpha\\,\\theta^{n+1}) = 0$ together with the backward Euler thermal equation above.\n\n(b) A loosely coupled staggered scheme first updates temperature by backward Euler to get $\\theta^{n+1}$, but then updates mechanics by enforcing $k\\,(u^{n+1} - \\alpha\\,\\theta^{n}) = 0$, i.e., the temperature entering the mechanical equilibrium is lagged.\n\nAssume the configuration at time $t^{n}$ is mechanically relaxed with respect to the current temperature, i.e., $u^{n} = \\alpha\\,\\theta^{n}$. Define the lagging error $\\delta\\theta := \\theta^{n} - \\theta^{n+1}$, which is nonzero whenever $r \\neq 1$.\n\nUsing only the free energy $\\Psi$ and the stated discrete equations, construct a concrete counterexample showing that the loosely coupled staggered scheme injects spurious energy relative to the monolithic scheme, even though the thermal dynamics is dissipative. Quantify the spurious energy growth per time step by deriving an exact closed-form expression for\n$$\n\\Delta E_{\\mathrm{spur}} := \\Psi\\big(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}\\big) - \\Psi\\big(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}\\big)\n$$\nin terms of the lagging error $\\delta\\theta$ and the parameters $k$ and $\\alpha$. Express your final answer as a single symbolic expression. No numerical approximation is required and no units should be reported.", "solution": "The objective is to quantify the spurious energy growth per time step, defined as $\\Delta E_{\\mathrm{spur}} := \\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) - \\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1})$. To do this, we must first determine the state variables $(u^{n+1}, \\theta^{n+1})$ under each scheme.\n\nThe thermal update is identical for both schemes and is given by the backward Euler discretization:\n$$\n\\frac{M}{\\Delta t}\\,(\\theta^{n+1} - \\theta^{n}) + L\\,\\theta^{n+1} = 0\n$$\nThis yields $\\theta^{n+1} = r\\,\\theta^{n}$, where $r = \\frac{M}{M + L\\,\\Delta t}$. Since $M > 0$, $L > 0$, and $\\Delta t > 0$, it follows that $r \\in (0,1)$.\n\nFirst, consider the monolithic solution strategy. The mechanical and thermal equations are solved simultaneously. The mechanical equilibrium equation is enforced at time $t^{n+1}$ using the contemporaneously computed temperature $\\theta^{n+1}$:\n$$\nk\\,(u^{n+1}_{\\mathrm{mono}} - \\alpha\\,\\theta^{n+1}) = 0\n$$\nGiven that the stiffness $k > 0$, this implies that the mechanical degree of freedom for the monolithic scheme is:\n$$\nu^{n+1}_{\\mathrm{mono}} = \\alpha\\,\\theta^{n+1}\n$$\nThis result physically corresponds to a state of mechanical relaxation with respect to the final temperature $\\theta^{n+1}$.\n\nNext, consider the loosely coupled staggered solution strategy. After the thermal update provides $\\theta^{n+1}$, the mechanical equilibrium is enforced using the lagged temperature from time $t^{n}$:\n$$\nk\\,(u^{n+1}_{\\mathrm{stag}} - \\alpha\\,\\theta^{n}) = 0\n$$\nAgain, since $k > 0$, this implies:\n$$\nu^{n+1}_{\\mathrm{stag}} = \\alpha\\,\\theta^{n}\n$$\nThis shows that the mechanical state is out of equilibrium with the final temperature $\\theta^{n+1}$, instead being relaxed with respect to the initial temperature $\\theta^n$.\n\nNow we evaluate the Helmholtz free energy, $\\Psi(u,\\theta) = \\frac{1}{2}\\,k\\,(u - \\alpha\\,\\theta)^{2} + \\frac{1}{2}\\,\\eta\\,\\theta^{2}$, for both final states. The thermal degree of freedom is $\\theta^{n+1}$ in both cases.\n\nFor the monolithic scheme, the final state is $(u^{n+1}_{\\mathrm{mono}}, \\theta^{n+1})$. The free energy is:\n$$\n\\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}) = \\Psi(\\alpha\\,\\theta^{n+1}, \\theta^{n+1}) = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n+1} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\nThe first term vanishes, yielding:\n$$\n\\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1}) = \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\nThis represents the energy of the system when it is fully mechanically relaxed at the temperature $\\theta^{n+1}$.\n\nFor the staggered scheme, the final state is $(u^{n+1}_{\\mathrm{stag}}, \\theta^{n+1})$. The free energy is:\n$$\n\\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) = \\Psi(\\alpha\\,\\theta^{n}, \\theta^{n+1}) = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}\n$$\nThis state contains both mechanical strain energy (due to the lag) and thermal energy.\n\nWe can now compute the spurious energy growth $\\Delta E_{\\mathrm{spur}}$ by taking the difference:\n$$\n\\Delta E_{\\mathrm{spur}} = \\Psi(u^{n+1}_{\\mathrm{stag}},\\theta^{n+1}) - \\Psi(u^{n+1}_{\\mathrm{mono}},\\theta^{n+1})\n$$\n$$\n\\Delta E_{\\mathrm{spur}} = \\left[ \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2} + \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2} \\right] - \\left[ \\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2} \\right]\n$$\nThe thermal energy terms, $\\frac{1}{2}\\,\\eta\\,(\\theta^{n+1})^{2}$, cancel out, leaving:\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,(\\alpha\\,\\theta^{n} - \\alpha\\,\\theta^{n+1})^{2}\n$$\nThe problem asks for this expression in terms of the lagging error $\\delta\\theta := \\theta^{n} - \\theta^{n+1}$. We can factor $\\alpha$ from the squared term:\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\theta^{n} - \\theta^{n+1})^{2}\n$$\nSubstituting the definition of $\\delta\\theta$:\n$$\n\\Delta E_{\\mathrm{spur}} = \\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\delta\\theta)^{2}\n$$\nSince $k > 0$ and $\\alpha \\neq 0$, the term $\\frac{1}{2}\\,k\\,\\alpha^{2}$ is strictly positive. The term $(\\delta\\theta)^{2}$ is non-negative. For any non-trivial thermal evolution where $\\theta^{n} \\neq \\theta^{n+1}$, we have $\\delta\\theta \\neq 0$, and therefore $\\Delta E_{\\mathrm{spur}} > 0$. This demonstrates that the staggered scheme spuriously injects mechanical energy into the system at each time step due to the time lag in the coupling term, despite the underlying thermal physics being dissipative. This unphysical energy growth is a well-known artifact of such explicit coupling schemes and can lead to numerical instability. The monolithic scheme, by contrast, correctly finds the minimum energy state for the given temperature and is thus unconditionally stable in this regard.", "answer": "$$\n\\boxed{\\frac{1}{2}\\,k\\,\\alpha^{2}\\,(\\delta\\theta)^{2}}\n$$", "id": "2598449"}, {"introduction": "To move beyond simply observing success or failure, we need tools to quantitatively analyze the behavior of staggered schemes. Many partitioned methods can be mathematically framed as fixed-point iterations, whose convergence depends on the properties of the underlying iteration map. In this exercise, you will derive the full discrete system for a thermoelastic problem and then analyze a specific staggered partitioning, explicitly calculating the scheme's scalar contraction factor to gain direct insight into the physical and numerical parameters that govern its stability. [@problem_id:2598423]", "problem": "Consider a one-dimensional, linearly thermoelastic rod of length $L$ and constant cross-sectional area $A$. Let the Young’s modulus be $E$, the coefficient of thermal expansion be $\\alpha$, the thermal conductivity be $k$, the mass density be $\\rho$, the specific heat be $c$, and the reference temperature be $T_0$. Assume small strains and the Duhamel–Neumann constitutive law. The governing field equations are the balance of linear momentum and the energy balance:\n- Mechanical equilibrium: $\\frac{\\partial \\sigma}{\\partial x} = 0$ with $\\sigma = E\\left(\\varepsilon - \\alpha \\left(T - T_0\\right)\\right)$ and $\\varepsilon = \\frac{\\partial u}{\\partial x}$.\n- Heat balance: $\\rho c \\,\\dot{T} + E \\alpha T_0 \\,\\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right) = 0$.\n\nImpose the following boundary and loading conditions:\n- Displacement Dirichlet boundary: $u(0,t) = 0$.\n- Traction-free boundary: $\\sigma(L,t) = 0$.\n- Temperature Dirichlet boundary: $T(0,t) = T_0$.\n- Insulated boundary: $-k \\frac{\\partial T}{\\partial x}(L,t) = 0$.\n- No body forces and no heat sources.\n\nDiscretize the rod with a single, linear, two-node finite element using the standard Galerkin Finite Element Method (FEM) with shape functions $N_1(x) = 1 - \\frac{x}{L}$ and $N_2(x) = \\frac{x}{L}$. Use Backward Euler time stepping over a time step $\\Delta t$ from $t^n$ to $t^{n+1}$. Because of the essential boundary conditions $u(0,t) = 0$ and $T(0,t) = T_0$, the only unknown nodal values at time $t^{n+1}$ are $u_2^{n+1}$ and $T_2^{n+1}$. \n\nStarting from the weak forms of the above balance laws, and using the foregoing element and boundary data, do the following:\n\n- Derive the monolithic residual vector $\\mathbf{R}(u_2^{n+1},T_2^{n+1}) = \\mathbf{0}$ for the coupled discrete system at time $t^{n+1}$, keeping all contributions that arise from the Backward Euler discretization, including those depending on $u_2^{n}$ and $T_2^{n}$ on the right-hand side.\n\n- Consider a staggered fixed-point iteration at time $t^{n+1}$ in which the mechanical subproblem uses a lagged temperature. Specifically, at iteration $k$:\n  - Mechanical step: solve the mechanical equilibrium for $u_2^{(k)}$ using $T_2^{(k-1)}$ held fixed (lagged).\n  - Thermal step: solve the heat equation for $T_2^{(k)}$ using the just-updated $u_2^{(k)}$ and Backward Euler in time.\n\nShow that this staggered iteration induces an affine one-dimensional fixed-point map on $T_2$, and extract its scalar contraction factor $\\lambda$, defined as the magnitude of the linear coefficient multiplying $T_2^{(k-1)}$ in the update to $T_2^{(k)}$. \n\nYour tasks must be carried out from the stated governing equations and definitions, without invoking any pre-packaged coupled thermoelastic formulas beyond those stated. Express your final answer as a single closed-form analytic expression for $\\lambda$ in terms of $E$, $\\alpha$, $T_0$, $k$, $\\rho$, $c$, $L$, and $\\Delta t$. No numerical evaluation is required. State no intermediate results in the final answer. No units should be included in the final answer. If you decide to approximate anything, your final answer must be expressed exactly, with no rounding.", "solution": "First, we derive the weak forms of the governing equations. Let $\\delta u$ and $\\delta T$ be the test functions for displacement and temperature, respectively. They must satisfy the homogeneous essential boundary conditions, so $\\delta u(0) = 0$ and $\\delta T(0) = 0$.\n\nThe weak form of the mechanical equilibrium equation is obtained by multiplying by $\\delta u$ and integrating over the domain $[0, L]$. We assume the quantities are defined over a volume $V$ with cross-section $A$, such that $\\int_V dV = A \\int_0^L dx$.\n$$ \\int_0^L A \\frac{\\partial \\sigma}{\\partial x} \\delta u \\, dx = 0 $$\nIntegrating by parts:\n$$ [A \\sigma \\delta u]_0^L - \\int_0^L A \\sigma \\frac{\\partial(\\delta u)}{\\partial x} \\, dx = 0 $$\nThe boundary term at $x=0$ vanishes because $\\delta u(0) = 0$. The term at $x=L$ vanishes because the traction is zero, $\\sigma(L,t) = 0$. Defining the test strain $\\delta\\varepsilon = \\frac{\\partial(\\delta u)}{\\partial x}$ and substituting the constitutive law for $\\sigma$:\n$$ \\int_0^L A E \\left(\\frac{\\partial u}{\\partial x} - \\alpha (T - T_0)\\right) \\delta\\varepsilon \\, dx = 0 $$\n\nThe weak form of the heat equation is obtained by multiplying by $\\delta T$ and integrating:\n$$ \\int_0^L A \\left( \\rho c \\,\\dot{T} + E \\alpha T_0 \\,\\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right) \\right) \\delta T \\, dx = 0 $$\nIntegrating the conduction term by parts:\n$$ \\int_0^L A \\left( (\\rho c \\,\\dot{T} + E \\alpha T_0 \\,\\dot{\\varepsilon}) \\delta T + k \\frac{\\partial T}{\\partial x} \\frac{\\partial(\\delta T)}{\\partial x} \\right) dx - [A k \\frac{\\partial T}{\\partial x} \\delta T]_0^L = 0 $$\nThe boundary term at $x=0$ vanishes because $\\delta T(0) = 0$. The term at $x=L$ is the heat flux, which is zero due to the insulated boundary condition. Thus, the weak form is:\n$$ \\int_0^L A \\left( (\\rho c \\,\\dot{T} + E \\alpha T_0 \\,\\dot{\\varepsilon}) \\delta T + k \\frac{\\partial T}{\\partial x} \\frac{\\partial(\\delta T)}{\\partial x} \\right) dx = 0 $$\n\nNext, we discretize using the given linear finite element. The fields $u$ and $T$ are approximated as:\n$$ u(x,t) \\approx u_1(t) N_1(x) + u_2(t) N_2(x) $$\n$$ T(x,t) \\approx T_1(t) N_1(x) + T_2(t) N_2(x) $$\nWith boundary conditions $u_1=0$ and $T_1=T_0$:\n$$ u(x,t) \\approx u_2(t) N_2(x) = u_2(t) \\frac{x}{L} $$\n$$ T(x,t) \\approx T_0 N_1(x) + T_2(t) N_2(x) = T_0(1-\\frac{x}{L}) + T_2(t)\\frac{x}{L} $$\nThe gradients are:\n$$ \\varepsilon(x,t) = \\frac{\\partial u}{\\partial x} \\approx \\frac{u_2(t)}{L} $$\n$$ \\frac{\\partial T}{\\partial x} \\approx \\frac{T_2(t) - T_0}{L} $$\nThe test functions are chosen from the same basis, corresponding to the free degrees of freedom: $\\delta u = \\delta u_2 N_2(x)$ and $\\delta T = \\delta T_2 N_2(x)$. Thus $\\delta\\varepsilon = \\delta u_2/L$ and $\\partial(\\delta T)/\\partial x = \\delta T_2/L$.\n\nSubstituting these into the weak forms, we obtain the semi-discrete system. For the mechanical equation, since it must hold for any $\\delta u_2$, the residual component is:\n$$ R_u = \\int_0^L A E \\left( \\frac{u_2}{L} - \\alpha \\left( (T_0(1-\\frac{x}{L}) + T_2\\frac{x}{L}) - T_0 \\right) \\right) \\frac{1}{L} \\, dx = 0 $$\n$$ R_u = \\frac{AE}{L} \\int_0^L \\left( \\frac{u_2}{L} - \\alpha (T_2-T_0)\\frac{x}{L} \\right) \\, dx = \\frac{AE}{L} \\left[ \\frac{u_2}{L}x - \\frac{\\alpha(T_2-T_0)}{L}\\frac{x^2}{2} \\right]_0^L $$\n$$ R_u = \\frac{AE}{L} \\left( u_2 - \\frac{\\alpha(T_2-T_0)L}{2} \\right) = \\frac{AE}{L}u_2 - \\frac{AE\\alpha}{2}(T_2-T_0) = 0 $$\n\nFor the thermal equation, the residual component is:\n$$ R_T = \\int_0^L A \\left( (\\rho c \\dot{T} + E \\alpha T_0 \\dot{\\varepsilon}) N_2 + k \\frac{\\partial T}{\\partial x} \\frac{\\partial N_2}{\\partial x} \\right) dx = 0 $$\nThe time derivatives are $\\dot{T} = \\dot{T}_2 N_2$ (since $\\dot{T}_1=0$) and $\\dot{\\varepsilon} = \\dot{u}_2/L$. We evaluate each term in the integral:\n1. Capacitance: $\\int_0^L A \\rho c (\\dot{T}_2 N_2) N_2 dx = A \\rho c \\dot{T}_2 \\int_0^L N_2^2 dx = A \\rho c \\dot{T}_2 \\frac{L}{3}$.\n2. Coupling: $\\int_0^L A E \\alpha T_0 (\\frac{\\dot{u}_2}{L}) N_2 dx = \\frac{A E \\alpha T_0 \\dot{u}_2}{L} \\int_0^L N_2 dx = \\frac{A E \\alpha T_0 \\dot{u}_2}{L} \\frac{L}{2} = \\frac{A E \\alpha T_0}{2} \\dot{u}_2$.\n3. Conduction: $\\int_0^L A k (\\frac{T_2-T_0}{L}) \\frac{1}{L} dx = \\frac{Ak(T_2-T_0)}{L^2} \\int_0^L dx = \\frac{Ak}{L}(T_2-T_0)$.\n\nCombining terms, we get the semi-discrete thermal equation:\n$$ R_T = \\frac{A\\rho c L}{3} \\dot{T}_2 + \\frac{A E \\alpha T_0}{2} \\dot{u}_2 + \\frac{Ak}{L}(T_2-T_0) = 0 $$\n\nApplying the Backward Euler scheme, $\\dot{y}^{n+1} \\approx (y^{n+1}-y^n)/\\Delta t$, at time $t^{n+1}$:\nThe mechanical equation is static in form:\n$$ \\frac{AE}{L}u_2^{n+1} - \\frac{AE\\alpha}{2}(T_2^{n+1}-T_0) = 0 $$\nThe thermal equation becomes:\n$$ \\frac{A\\rho c L}{3} \\frac{T_2^{n+1}-T_2^n}{\\Delta t} + \\frac{A E \\alpha T_0}{2} \\frac{u_2^{n+1}-u_2^n}{\\Delta t} + \\frac{Ak}{L}(T_2^{n+1}-T_0) = 0 $$\nThese two equations together represent the condition $\\mathbf{R}(u_2^{n+1}, T_2^{n+1}) = \\mathbf{0}$, thus fulfilling the first task.\n\nNow, we analyze the staggered iterative scheme at time $t^{n+1}$. Let $k$ be the iteration counter.\n**Mechanical step**: Solve for $u_2^{(k)}$ using $T_2^{(k-1)}$:\n$$ \\frac{AE}{L}u_2^{(k)} - \\frac{AE\\alpha}{2}(T_2^{(k-1)}-T_0) = 0 $$\n$$ u_2^{(k)} = \\frac{L\\alpha}{2}(T_2^{(k-1)}-T_0) $$\n\n**Thermal step**: Solve for $T_2^{(k)}$ using the updated $u_2^{(k)}$:\n$$ \\frac{A\\rho c L}{3} \\frac{T_2^{(k)}-T_2^n}{\\Delta t} + \\frac{A E \\alpha T_0}{2} \\frac{u_2^{(k)}-u_2^n}{\\Delta t} + \\frac{Ak}{L}(T_2^{(k)}-T_0) = 0 $$\nSubstitute the expression for $u_2^{(k)}$ into the thermal equation:\n$$ \\frac{A\\rho c L}{3\\Delta t}(T_2^{(k)}-T_2^n) + \\frac{A E \\alpha T_0}{2\\Delta t} \\left(\\frac{L\\alpha}{2}(T_2^{(k-1)}-T_0) - u_2^n\\right) + \\frac{Ak}{L}(T_2^{(k)}-T_0) = 0 $$\nWe now rearrange to find the map $T_2^{(k-1)} \\to T_2^{(k)}$. Isolate terms with $T_2^{(k)}$ on the left side:\n$$ T_2^{(k)} \\left( \\frac{A\\rho c L}{3\\Delta t} + \\frac{Ak}{L} \\right) = \\frac{A\\rho c L}{3\\Delta t}T_2^n - \\frac{A E \\alpha T_0}{2\\Delta t} \\left(\\frac{L\\alpha}{2}(T_2^{(k-1)}-T_0) - u_2^n\\right) + \\frac{Ak}{L}T_0 $$\nExpand the right side and identify the coefficient of $T_2^{(k-1)}$:\n$$ T_2^{(k)} \\left( \\dots \\right) = - \\frac{A E \\alpha^2 L T_0}{4\\Delta t} T_2^{(k-1)} + \\left[ \\text{terms not depending on } T_2^{(k-1)} \\right] $$\nThe mapping is affine, $T_2^{(k)} = C_1 T_2^{(k-1)} + C_2$, where the linear coefficient $C_1$ is:\n$$ C_1 = \\frac{- \\frac{A E \\alpha^2 L T_0}{4\\Delta t}}{\\frac{A\\rho c L}{3\\Delta t} + \\frac{Ak}{L}} $$\nThe contraction factor $\\lambda$ is the magnitude $|C_1|$. All physical constants are positive, so we can determine the sign. The area $A$ cancels out.\n$$ \\lambda = \\left| \\frac{- \\frac{E \\alpha^2 L T_0}{4\\Delta t}}{\\frac{\\rho c L}{3\\Delta t} + \\frac{k}{L}} \\right| = \\frac{\\frac{E \\alpha^2 L T_0}{4\\Delta t}}{\\frac{\\rho c L}{3\\Delta t} + \\frac{k}{L}} $$\nTo simplify, multiply the numerator and denominator by $12L\\Delta t$:\n$$ \\lambda = \\frac{\\left(\\frac{E \\alpha^2 L T_0}{4\\Delta t}\\right) (12L\\Delta t)}{\\left(\\frac{\\rho c L}{3\\Delta t}\\right) (12L\\Delta t) + \\left(\\frac{k}{L}\\right) (12L\\Delta t)} $$\n$$ \\lambda = \\frac{3 E \\alpha^2 L^2 T_0}{4 \\rho c L^2 + 12 k \\Delta t} $$\nThis is the final expression for the contraction factor.", "answer": "$$\\boxed{\\frac{3 E \\alpha^{2} L^{2} T_0}{4 \\rho c L^{2} + 12 k \\Delta t}}$$", "id": "2598423"}]}