{"hands_on_practices": [{"introduction": "Before any calculation begins, a crucial strategic choice in any nonconforming contact simulation is assigning the master and slave roles to the interacting surfaces. This decision is not arbitrary and has profound implications for the numerical stability of the contact pressure solution. This exercise [@problem_id:2581181] guides you through applying the fundamental Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition to reason about this choice, helping you develop the intuition to set up stable and reliable contact models.", "problem": "Consider frictionless small-deformation contact between two linearly elastic bodies with a nonconforming interface in the Finite Element Method (FEM). Let the interface be denoted by $\\Gamma_c$, and let the meshes on the two sides have characteristic sizes $h_M$ and $h_S$ with $h_S < h_M$. A classical mortar contact formulation enforces nonpenetration weakly by a Lagrange multiplier (LM) field $\\lambda$ defined on one side of the interface (the mortar, or master, side), acting against the trace of the displacement field on the other side (the non-mortar, or slave, side). Assume comparable polynomial orders on both sides and consistent interface quadrature.\n\nStarting from the principle of virtual work with contact contributions and the stability requirement of mixed formulations (the Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition), reason about how the assignment of master versus slave affects the accuracy of the computed contact pressure. In particular, focus on choosing the finer mesh as slave versus master. Which statement best captures the impact on contact pressure accuracy and provides a justified recommendation?\n\nA. Selecting the finer mesh as master (mortar) always improves the accuracy of the contact pressure because the LM field $\\lambda$ then has higher resolution; this choice is unconditionally stable and recommended regardless of $h_M$ and $h_S$.\n\nB. Selecting the finer mesh as slave (non-mortar) and the coarser mesh as master (mortar) generally avoids spurious oscillations in the contact pressure by better satisfying the discrete inf-sup condition; the pressure field is then represented on the coarser side and may be slightly smeared but is variationally consistent. This assignment is recommended when $h_S \\ll h_M$.\n\nC. The master/slave assignment is irrelevant in mortar methods; with consistent quadrature the contact pressure accuracy is essentially identical for either choice, so no recommendation is necessary.\n\nD. The best accuracy is achieved by setting the finer mesh as master (mortar) and compensating any mismatch with a sufficiently large penalty parameter on the interface; this guarantees both stability and improved pressure resolution and is the recommended practice.", "solution": "The validity of the problem statement must first be established.\n\nStep 1: Extract Givens\n-   **System**: Frictionless small-deformation contact between two linearly elastic bodies.\n-   **Interface**: $\\Gamma_c$, nonconforming finite element meshes.\n-   **Mesh Sizes**: Characteristic sizes $h_M$ and $h_S$, with the explicit condition $h_S < h_M$.\n-   **Methodology**: A classical mortar contact formulation based on the Finite Element Method (FEM).\n-   **Constraint Enforcement**: Nonpenetration is enforced weakly using a Lagrange multiplier (LM) field, $\\lambda$.\n-   **Field Definitions**: The LM field $\\lambda$ is defined on the mortar (master) side. It acts against the trace of the displacement field on the non-mortar (slave) side.\n-   **Assumptions**: Polynomial orders of the basis functions are comparable on both sides. Interface quadrature is consistent.\n-   **Guiding Principles**: The analysis must start from the principle of virtual work and consider the Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition for stability.\n-   **Question**: Determine how the master-slave assignment (specifically, choosing the finer mesh vs. the coarser mesh as master) impacts the accuracy of the computed contact pressure and provide a justified recommendation.\n\nStep 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is located squarely within the established theory of computational contact mechanics, a sub-discipline of computational solid mechanics. The concepts of mortar methods, nonconforming meshes, Lagrange multipliers, and the LBB stability condition are standard and fundamentally correct.\n-   **Well-Posedness**: The problem is well-posed. It asks for a qualitative analysis based on established stability theory, not for a single numerical answer. The premises provided are sufficient to derive a logical and unique conclusion regarding the recommended practice.\n-   **Objectivity**: The problem is stated using precise, objective, and standard terminology from the field of FEM. There are no subjective or ambiguous statements.\n-   **Conclusion of Validation**: The problem statement is scientifically sound, self-contained, well-posed, and objective. It contains no contradictions, vagueness, or pseudoscientific elements. It is a valid problem in advanced computational mechanics.\n\nStep 3: Verdict and Action\nThe problem is valid. A full solution will be derived.\n\nThe problem describes a mixed finite element formulation for contact. The stationary point of the Lagrangian functional, which incorporates the elastic energy and the weak form of the contact constraints, leads to a saddle-point system. The unknowns are the displacement field, $u$, and the Lagrange multiplier field, $\\lambda$, which represents the contact pressure. In discretized form, we seek $(u_h, \\lambda_h)$ in appropriate finite element spaces $V^h \\times M^h$.\n\nThe stability of such a saddle-point problem is governed by the discrete Ladyzhenskaya–Babuška–Brezzi (LBB), or inf-sup, condition. This condition relates the Lagrange multiplier space $M^h$ (where $\\lambda_h$ lives) to the displacement space $V^h$ (from which the trace of the test functions $\\delta u_h$ on the slave boundary is taken). The condition states that there must exist a constant $\\beta > 0$, independent of the mesh discretization parameter $h$, such that:\n$$ \\inf_{\\lambda_h \\in M^h} \\sup_{\\delta u_h \\in V^h} \\frac{c(\\delta u_h, \\lambda_h)}{\\|\\delta u_h\\|_{V^h} \\|\\lambda_h\\|_{M^h}} \\ge \\beta $$\nHere, $c(\\delta u_h, \\lambda_h) = \\int_{\\Gamma_c} \\lambda_h (\\text{trace}(\\delta u_h))_n d\\Gamma$ is the bilinear form that couples the two fields. A failure to satisfy this condition leads to an unstable formulation, which typically manifests as severe, non-physical oscillations in the computed Lagrange multiplier field, i.e., the contact pressure $\\lambda_h$.\n\nIn the context of mortar methods for contact, the Lagrange multiplier space $M^h$ is constructed from basis functions defined on the **master** mesh. The displacement test functions $\\delta u_h$ are, of course, defined over the entire domain, but the coupling term $c(\\cdot, \\cdot)$ involves their trace on the **slave** surface. The LBB condition, in essence, requires that the space of displacement traces on the slave side be \"rich\" enough to constrain every mode in the Lagrange multiplier space on the master side.\n\nLet us analyze the two possible choices for master/slave assignment given that $h_S < h_M$:\n\n1.  **Choice 1: Finer mesh ($h_S$) as master, coarser mesh ($h_M$) as slave.**\n    In this case, the Lagrange multiplier space $M^h$ is defined on the fine mesh. It is a rich space, containing degrees of freedom capable of representing high-frequency pressure variations. The displacement test functions are evaluated on the slave surface, which is the coarse mesh. The space of displacement traces on this coarse mesh is \"poor\" and contains only low-frequency modes.\n    Consider a high-frequency mode for the pressure, $\\lambda_h$, on the fine master mesh. It is possible for such a mode to be nearly orthogonal to all possible displacement test functions available on the coarse slave mesh. For such a $\\lambda_h$, the numerator $c(\\delta u_h, \\lambda_h)$ would be very small for all $\\delta u_h$. This would violate the inf-sup condition, as the infimum would approach zero. The result is numerical instability and spurious oscillations in the computed contact pressure.\n\n2.  **Choice 2: Coarser mesh ($h_M$) as master, finer mesh ($h_S$) as slave.**\n    Here, the Lagrange multiplier space $M^h$ is defined on the coarse mesh. It is a \"poor\" space, capable of representing only smooth, slowly varying pressure fields. The displacement test functions are evaluated on the slave surface, which is the fine mesh. This provides a \"rich\" space of displacement traces.\n    For any Lagrange multiplier $\\lambda_h$ from the coarse master space, it is always possible to find a displacement mode $\\delta u_h$ in the rich space on the fine slave mesh that couples with it effectively (i.e., makes the integral $c(\\delta u_h, \\lambda_h)$ non-zero and sufficiently large). The richness of the slave displacement space relative to the master multiplier space ensures that the LBB condition is more easily satisfied. This leads to a stable solution for the contact pressure. The resulting pressure field $\\lambda_h$ will naturally be smooth, as it is an element of the space defined on the coarse mesh. While it cannot capture pressure variations at a scale smaller than $h_M$, it provides a stable and variationally consistent approximation, which is the best possible representation within the chosen instability-prone space $M^h$. This effect is sometimes described as a \"smearing\" or averaging of the true pressure, but it is free from non-physical noise.\n\nTherefore, to ensure numerical stability, the recommended practice is to select the coarser mesh as the master surface and the finer mesh as the slave surface.\n\nNow, we evaluate the given options based on this derivation.\n\nA. Selecting the finer mesh as master (mortar) always improves the accuracy of the contact pressure because the LM field $\\lambda$ then has higher resolution; this choice is unconditionally stable and recommended regardless of $h_M$ and $h_S$.\nThis statement is fundamentally flawed. While the LM field being defined on the finer mesh does theoretically allow for higher resolution, this choice is precisely the one that leads to failure of the LBB condition and numerical instability. The claim that it is \"unconditionally stable\" is false. Such a choice is known to cause spurious pressure oscillations.\n**Verdict: Incorrect.**\n\nB. Selecting the finer mesh as slave (non-mortar) and the coarser mesh as master (mortar) generally avoids spurious oscillations in the contact pressure by better satisfying the discrete inf-sup condition; the pressure field is then represented on the coarser side and may be slightly smeared but is variationally consistent. This assignment is recommended when $h_S \\ll h_M$.\nThis statement accurately reflects the theoretical analysis. It correctly identifies the stable master-slave assignment (coarser as master, finer as slave). It provides the correct reason: better satisfaction of the discrete inf-sup (LBB) condition and avoidance of spurious oscillations. It correctly characterizes the resulting pressure field as being represented on the coarser mesh (potentially \"smeared,\" which means it's a smooth approximation) and \"variationally consistent.\" This is the standard, correct reasoning in the field.\n**Verdict: Correct.**\n\nC. The master/slave assignment is irrelevant in mortar methods; with consistent quadrature the contact pressure accuracy is essentially identical for either choice, so no recommendation is necessary.\nThis statement is false. The master/slave assignment is of critical importance for the stability of the classical Lagrange multiplier formulation, as dictated by the LBB condition. Consistent quadrature ensures correct integration but cannot fix an ill-posed choice of discrete function spaces. The accuracy is far from identical; one choice is stable and the other is unstable.\n**Verdict: Incorrect.**\n\nD. The best accuracy is achieved by setting the finer mesh as master (mortar) and compensating any mismatch with a sufficiently large penalty parameter on the interface; this guarantees both stability and improved pressure resolution and is the recommended practice.\nThis statement introduces a concept not specified in the problem's guiding principles: penalty stabilization. The problem asks for an analysis based on the classical mortar method (pure Lagrange multiplier) and its LBB condition. Adding a penalty term fundamentally changes the formulation into an augmented Lagrangian or stabilized method. While such methods can stabilize the otherwise unstable choice (finer mesh as master), this option is not an analysis of the classical formulation. Furthermore, the claim that it \"guarantees\" both stability and improved resolution is too strong. A large penalty parameter can introduce other numerical problems like ill-conditioning. This is not the answer within the specified framework.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "2581181"}, {"introduction": "The core of the mortar method is the careful construction of integrals over the nonconforming interface, which requires segmenting slave elements based on their projection onto the master surface. This hands-on calculation [@problem_id:2581175] provides a concrete 2D example of this fundamental process. You will determine the segmentation points and build a composite numerical quadrature rule, a necessary skill for understanding how mortar methods accurately handle geometric mismatch at the lowest level.", "problem": "In the context of the finite element method for nonconforming contact using mortar methods, consider a planar interface where the master side is a polyline composed of two linear edges sharing a common vertex and the slave side is a single straight linear edge that overlaps both master edges in the sense of closest-point orthogonal projection.\n\nLet the master edges be $\\Gamma_{M,1}$ from $\\mathbf{A}=(0,0)$ to $\\mathbf{B}=(1,0)$ and $\\Gamma_{M,2}$ from $\\mathbf{B}=(1,0)$ to $\\mathbf{C}=(1,1)$. Let the slave edge be $\\Gamma_{S}$ from $\\mathbf{P}_0=(0.4,-0.2)$ to $\\mathbf{P}_1=(1.1,0.9)$. Parameterize the slave edge by the standard affine map from the biunit interval $s\\in[-1,1]$ to the segment, $\\mathbf{x}_{S}(s)=\\mathbf{x}_{m}+s\\,\\mathbf{x}_{d}$, where $\\mathbf{x}_{m}=(\\mathbf{P}_0+\\mathbf{P}_1)/2$ and $\\mathbf{x}_{d}=(\\mathbf{P}_1-\\mathbf{P}_0)/2$. Adopt the closest-point orthogonal projection onto the master polyline with edge selection determined by comparing distances $d_1(s)=|y_{S}(s)|$ to $\\Gamma_{M,1}$ and $d_2(s)=|x_{S}(s)-1|$ to $\\Gamma_{M,2}$, and require that the orthogonal foot lies within the corresponding edge (for this geometry, this requirement is satisfied on the active portions). Define the active contact interface as the portion of $\\Gamma_{S}$ whose projections lie on $\\Gamma_{M,1}\\cup\\Gamma_{M,2}$.\n\nTasks:\n- Compute the slave-parameter partition point $s^{\\star}$ at which the active master edge changes, i.e., the unique point where $d_1(s)=d_2(s)$ with $x_{S}(s)\\le 1$ and $y_{S}(s)\\ge 0$. Use this to identify the two slave subsegments $I_1=[-1,s^{\\star}]$ paired with $\\Gamma_{M,1}$ and $I_2=[s^{\\star},1]$ paired with $\\Gamma_{M,2}$.\n- For each subsegment $I_j=[a_j,b_j]$, construct the $2$-point Gauss–Legendre quadrature on $I_j$ in the slave parameter $s$ with nodes $s_{j}^{\\pm}=\\frac{a_j+b_j}{2}\\pm\\frac{b_j-a_j}{2}\\,\\frac{1}{\\sqrt{3}}$ and parametric weights $w_{j}^{\\pm}=\\frac{b_j-a_j}{2}$. Provide the corresponding physical line-integration weights $\\widehat{w}_{j}^{\\pm}=J_{S}\\,w_{j}^{\\pm}$, where $J_{S}=\\|\\mathbf{x}_{d}\\|$ is the constant line Jacobian on $\\Gamma_{S}$. For each quadrature node $s_{j}^{\\pm}$, also give the associated master-edge local coordinate $t\\in[-1,1]$: for $\\Gamma_{M,1}$, use $\\mathbf{x}_{M,1}(t)=\\big(\\frac{1+t}{2},0\\big)$ so that $t_{1}(s)=2\\,x_{S}(s)-1$; for $\\Gamma_{M,2}$, use $\\mathbf{x}_{M,2}(t)=\\big(1,\\frac{1+t}{2}\\big)$ so that $t_{2}(s)=2\\,y_{S}(s)-1$.\n- Using the above composite quadrature on $I_1\\cup I_2$, evaluate the mortar line integral\n$$\nI=\\int_{\\Gamma_{S}^{\\text{act}}}\\big(x+2y\\big)\\,\\mathrm{d}\\ell,\n$$\nwhere $(x,y)$ are the coordinates on $\\Gamma_{S}$ and $\\mathrm{d}\\ell$ is the line element. Express the final value of $I$ as an exact analytic expression with no units. Do not round.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\nGivens are extracted verbatim:\n- Master edges: $\\Gamma_{M,1}$ from $\\mathbf{A}=(0,0)$ to $\\mathbf{B}=(1,0)$; $\\Gamma_{M,2}$ from $\\mathbf{B}=(1,0)$ to $\\mathbf{C}=(1,1)$.\n- Slave edge: $\\Gamma_{S}$ from $\\mathbf{P}_0=(0.4,-0.2)$ to $\\mathbf{P}_1=(1.1,0.9)$.\n- Slave parametrization: $\\mathbf{x}_{S}(s)=\\mathbf{x}_{m}+s\\,\\mathbf{x}_{d}$ for $s\\in[-1,1]$, with $\\mathbf{x}_{m}=(\\mathbf{P}_0+\\mathbf{P}_1)/2$ and $\\mathbf{x}_{d}=(\\mathbf{P}_1-\\mathbf{P}_0)/2$.\n- Projection rule: Closest-point orthogonal projection onto master polyline. Edge selection determined by comparing distances $d_1(s)=|y_{S}(s)|$ to $\\Gamma_{M,1}$ and $d_2(s)=|x_{S}(s)-1|$ to $\\Gamma_{M,2}$.\n- Active interface condition: Orthogonal foot lies within the corresponding master edge.\n- Task 1: Find the partition point $s^{\\star}$ where $d_1(s)=d_2(s)$ with $x_{S}(s)\\le 1$ and $y_{S}(s)\\ge 0$. This defines subsegments $I_1=[-1,s^{\\star}]$ and $I_2=[s^{\\star},1]$.\n- Task 2: For each subsegment $I_j$, construct a $2$-point Gauss–Legendre quadrature with nodes $s_{j}^{\\pm}$, parametric weights $w_{j}^{\\pm}$, physical weights $\\widehat{w}_{j}^{\\pm}$, and associated master-edge local coordinates $t(s)$.\n- Task 3: Evaluate the integral $I=\\int_{\\Gamma_{S}^{\\text{act}}}\\big(x+2y\\big)\\,\\mathrm{d}\\ell$ using this quadrature.\n\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in computational mechanics involving numerical integration over a segmented domain. The data are complete, consistent, and computationally feasible. The problem does not violate any fundamental principles and is structured to admit a unique, verifiable solution. Therefore, the problem is deemed valid and a solution will be provided.\n\nFirst, we determine the slave edge parametrization. The midpoint $\\mathbf{x}_m$ and direction vector $\\mathbf{x}_d$ are:\n$$\n\\mathbf{x}_{m} = \\frac{\\mathbf{P}_0+\\mathbf{P}_1}{2} = \\frac{1}{2}\\big((0.4,-0.2) + (1.1,0.9)\\big) = (0.75, 0.35) = \\left(\\frac{3}{4}, \\frac{7}{20}\\right)\n$$\n$$\n\\mathbf{x}_{d} = \\frac{\\mathbf{P}_1-\\mathbf{P}_0}{2} = \\frac{1}{2}\\big((1.1,0.9) - (0.4,-0.2)\\big) = (0.35, 0.55) = \\left(\\frac{7}{20}, \\frac{11}{20}\\right)\n$$\nThe parametrization of the slave edge $\\Gamma_S$ is $\\mathbf{x}_S(s) = (x_S(s), y_S(s))$:\n$$\nx_S(s) = \\frac{3}{4} + \\frac{7}{20}s\n$$\n$$\ny_S(s) = \\frac{7}{20} + \\frac{11}{20}s\n$$\n\nNext, we find the slave-parameter partition point $s^{\\star}$. This is the point where the projection switches from $\\Gamma_{M,1}$ to $\\Gamma_{M,2}$, defined by $d_1(s)=d_2(s)$ under the conditions $x_S(s)\\le 1$ and $y_S(s)\\ge 0$. The distances are $d_1(s)=|y_S(s)|$ and $d_2(s)=|x_S(s)-1|$. The conditions imply we can write the equality as $y_S(s) = 1 - x_S(s)$.\n$$\n\\frac{7}{20} + \\frac{11}{20}s = 1 - \\left(\\frac{3}{4} + \\frac{7}{20}s\\right) = \\frac{1}{4} - \\frac{7}{20}s\n$$\n$$\n\\left(\\frac{11}{20} + \\frac{7}{20}\\right)s = \\frac{1}{4} - \\frac{7}{20} = \\frac{5-7}{20}\n$$\n$$\n\\frac{18}{20}s = -\\frac{2}{20} \\implies \\frac{9}{10}s = -\\frac{1}{10} \\implies s^{\\star} = -\\frac{1}{9}\n$$\nThe slave subsegments are $I_1=[-1, -1/9]$ and $I_2=[-1/9, 1]$.\n\nWe now construct the composite $2$-point Gauss-Legendre quadrature. The line Jacobian $J_S$ is constant:\n$$\nJ_{S} = \\|\\mathbf{x}_{d}\\| = \\sqrt{\\left(\\frac{7}{20}\\right)^2 + \\left(\\frac{11}{20}\\right)^2} = \\sqrt{\\frac{49+121}{400}} = \\frac{\\sqrt{170}}{20}\n$$\n\nFor subsegment $I_1 = [-1, -1/9]$:\n- Midpoint: $\\frac{a_1+b_1}{2} = -\\frac{5}{9}$. Half-length: $\\frac{b_1-a_1}{2} = \\frac{4}{9}$.\n- Nodes: $s_{1}^{\\pm} = -\\frac{5}{9} \\pm \\frac{4}{9\\sqrt{3}}$.\n- Parametric weights: $w_{1}^{\\pm} = \\frac{4}{9}$.\n- Physical weights: $\\widehat{w}_{1}^{\\pm} = J_S w_{1}^{\\pm} = \\frac{\\sqrt{170}}{20} \\cdot \\frac{4}{9} = \\frac{\\sqrt{170}}{45}$.\n- Master coordinate mapping for $\\Gamma_{M,1}$: $t_1(s) = 2x_S(s)-1 = 2(\\frac{3}{4}+\\frac{7}{20}s)-1 = \\frac{1}{2}+\\frac{7}{10}s$.\n- Master coordinates at nodes: $t_1(s_{1}^{\\pm}) = \\frac{1}{2} + \\frac{7}{10}\\left(-\\frac{5}{9} \\pm \\frac{4}{9\\sqrt{3}}\\right) = \\frac{1}{9} \\pm \\frac{14\\sqrt{3}}{135}$.\n\nFor subsegment $I_2 = [-1/9, 1]$:\n- Midpoint: $\\frac{a_2+b_2}{2} = \\frac{4}{9}$. Half-length: $\\frac{b_2-a_2}{2} = \\frac{5}{9}$.\n- Nodes: $s_{2}^{\\pm} = \\frac{4}{9} \\pm \\frac{5}{9\\sqrt{3}}$.\n- Parametric weights: $w_{2}^{\\pm} = \\frac{5}{9}$.\n- Physical weights: $\\widehat{w}_{2}^{\\pm} = J_S w_{2}^{\\pm} = \\frac{\\sqrt{170}}{20} \\cdot \\frac{5}{9} = \\frac{\\sqrt{170}}{36}$.\n- Master coordinate mapping for $\\Gamma_{M,2}$: $t_2(s) = 2y_S(s)-1 = 2(\\frac{7}{20}+\\frac{11}{20}s)-1 = -\\frac{3}{10}+\\frac{11}{10}s$.\n- Master coordinates at nodes: $t_2(s_{2}^{\\pm}) = -\\frac{3}{10} + \\frac{11}{10}\\left(\\frac{4}{9} \\pm \\frac{5}{9\\sqrt{3}}\\right) = \\frac{17}{90} \\pm \\frac{11\\sqrt{3}}{54}$.\n\nFinally, we evaluate the integral $I=\\int_{\\Gamma_{S}^{\\text{act}}}\\big(x+2y\\big)\\,\\mathrm{d}\\ell$. The integrand on $\\Gamma_S$ is:\n$$\nf(s) = x_S(s)+2y_S(s) = \\left(\\frac{3}{4}+\\frac{7}{20}s\\right) + 2\\left(\\frac{7}{20}+\\frac{11}{20}s\\right) = \\frac{29}{20} + \\frac{29}{20}s = \\frac{29}{20}(1+s)\n$$\nThe integral is approximated by the sum: $I \\approx \\sum_{k \\in \\{-,+\\}} f(s_{1}^{k}) \\widehat{w}_{1}^{k} + \\sum_{k \\in \\{-,+\\}} f(s_{2}^{k}) \\widehat{w}_{2}^{k}$.\nContribution from $I_1$:\n$$\nI_1 = \\widehat{w}_{1}^{\\pm} \\left( f(s_1^-) + f(s_1^+) \\right) = \\frac{\\sqrt{170}}{45} \\left( \\frac{29}{20}(1+s_1^-) + \\frac{29}{20}(1+s_1^+) \\right)\n$$\n$$\nI_1 = \\frac{29\\sqrt{170}}{900} \\left( (1 - \\frac{5}{9} - \\frac{4}{9\\sqrt{3}}) + (1 - \\frac{5}{9} + \\frac{4}{9\\sqrt{3}}) \\right) = \\frac{29\\sqrt{170}}{900} \\left(2 \\cdot \\frac{4}{9}\\right) = \\frac{29\\sqrt{170}}{900} \\cdot \\frac{8}{9} = \\frac{58\\sqrt{170}}{2025}\n$$\nContribution from $I_2$:\n$$\nI_2 = \\widehat{w}_{2}^{\\pm} \\left( f(s_2^-) + f(s_2^+) \\right) = \\frac{\\sqrt{170}}{36} \\left( \\frac{29}{20}(1+s_2^-) + \\frac{29}{20}(1+s_2^+) \\right)\n$$\n$$\nI_2 = \\frac{29\\sqrt{170}}{720} \\left( (1 + \\frac{4}{9} - \\frac{5}{9\\sqrt{3}}) + (1 + \\frac{4}{9} + \\frac{5}{9\\sqrt{3}}) \\right) = \\frac{29\\sqrt{170}}{720} \\left(2 \\cdot \\frac{13}{9}\\right) = \\frac{29\\sqrt{170}}{720} \\cdot \\frac{26}{9} = \\frac{377\\sqrt{170}}{3240}\n$$\nTotal integral:\n$$\nI = I_1 + I_2 = \\frac{58\\sqrt{170}}{2025} + \\frac{377\\sqrt{170}}{3240}\n$$\nThe least common multiple of $2025=3^4 \\cdot 5^2$ and $3240=2^3 \\cdot 3^4 \\cdot 5$ is $16200$.\n$$\nI = \\frac{58 \\cdot 8}{16200}\\sqrt{170} + \\frac{377 \\cdot 5}{16200}\\sqrt{170} = \\frac{464 + 1885}{16200}\\sqrt{170} = \\frac{2349\\sqrt{170}}{16200}\n$$\nSimplifying the fraction, since $2349 = 29 \\cdot 81 = 29 \\cdot 3^4$ and $16200 = 200 \\cdot 81 = 200 \\cdot 3^4$:\n$$\nI = \\frac{29 \\cdot 3^4}{200 \\cdot 3^4}\\sqrt{170} = \\frac{29\\sqrt{170}}{200}\n$$\nAs the integrand is a linear polynomial in $s$, the $2$-point Gauss quadrature provides the exact value of the integral over each subinterval, and thus the composite quadrature is exact for the total integral.", "answer": "$$\n\\boxed{\\frac{29\\sqrt{170}}{200}}\n$$", "id": "2581175"}, {"introduction": "Once the interface integrals are defined, they must be incorporated into the finite element system of equations for an implicit solver. This requires deriving the contact contribution to both the residual vector and the consistent tangent (stiffness) matrix. This practice problem [@problem_id:2581208] demonstrates this derivation for a simple penalty-based contact element, connecting the principle of virtual work to the concrete algebraic expressions that drive the nonlinear solution process.", "problem": "Consider a small-deformation, frictionless, normal contact interaction between a single slave node and a single two-node master line element in two dimensions. Assume that only the normal components of displacement are active for contact and are collected in the ordered vector of unknowns $\\{u\\} = \\big(u_{s}^{n},\\,u_{A}^{n},\\,u_{B}^{n}\\big)^{\\mathsf{T}}$, where $u_{s}^{n}$ is the slave-node normal displacement and $u_{A}^{n}$, $u_{B}^{n}$ are the master nodes’ normal displacements. The master line element uses standard isoparametric shape functions $N_{A}(\\xi) = \\frac{1-\\xi}{2}$ and $N_{B}(\\xi) = \\frac{1+\\xi}{2}$ with a parametric coordinate $\\xi \\in [-1,1]$. The (known) contact point on the master lies at $\\xi=\\xi_{c} \\in [-1,1]$.\n\nUse a mortar penalty formulation for normal contact with penalty parameter $k_{n}>0$. Assume a single-point mortar quadrature located at the slave node with weight $w>0$ and a unit-valued dual shape function at that point so that the slave-side test function evaluates to one at the quadrature point. Let the signed normal gap be defined as\n$$\ng(u) \\equiv u_{s}^{n} - N_{A}(\\xi_{c})\\,u_{A}^{n} - N_{B}(\\xi_{c})\\,u_{B}^{n} + g_{0},\n$$\nwhere $g_{0}$ is the initial geometric gap in the normal direction (which may be nonzero but is known). Assume that contact is active at the current iterate so that the penalty contribution is smooth in a neighborhood of $g(u)$.\n\nStarting from the principle of virtual work for the penalty contact contribution, derive the local mortar residual vector contribution $\\{r_{c}\\}$ and the consistent tangent matrix contribution $[K_{c}]$ to the global system corresponding to $\\{u\\}$, expressed in terms of $w$, $k_{n}$, and the master shape functions evaluated at $\\xi_{c}$. Then, using your assembled expressions, determine the single scalar entry of the tangent matrix that couples the master nodes $A$ and $B$ in the normal direction, namely the $(A,B)$ component of $[K_{c}]$, as a closed-form symbolic expression in $w$, $k_{n}$, and $\\xi_{c}$.\n\nYour final answer must be a single analytic expression for this scalar entry. Do not include units in the final boxed answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a rigorous derivation. It represents a standard exercise in the field of computational contact mechanics. Therefore, I will proceed with the solution.\n\nThe starting point for this derivation is the potential energy contribution from the penalty contact term, denoted $\\Pi_c$. For an active contact state, as assumed in the problem, the potential is a function of the squared normal gap, $g$.\n$$ \\Pi_c = \\frac{1}{2} k_{n} \\int_{\\Gamma_c} g^{2} \\, d\\Gamma $$\nHere, $k_{n} > 0$ is the penalty parameter and $\\Gamma_c$ represents the contact interface. The problem specifies a mortar formulation with a single-point quadrature rule located at the slave node, with an associated weight $w > 0$ and a unit-valued dual shape function. This discretization simplifies the integral to an algebraic expression:\n$$ \\Pi_c \\approx \\frac{1}{2} w k_{n} g^{2} $$\nThe signed normal gap $g$ is defined as a function of the nodal normal displacements $\\{u\\} = (u_{s}^{n}, u_{A}^{n}, u_{B}^{n})^{\\mathsf{T}}$:\n$$ g(\\{u\\}) \\equiv u_{s}^{n} - N_{A}(\\xi_{c}) u_{A}^{n} - N_{B}(\\xi_{c}) u_{B}^{n} + g_{0} $$\nwhere $N_{A}(\\xi_{c})$ and $N_{B}(\\xi_{c})$ are the master element shape functions evaluated at the contact point $\\xi_c$, and $g_0$ is the known initial gap. This relation can be expressed in matrix form:\n$$ g = \\{c\\}^{\\mathsf{T}}\\{u\\} + g_{0} $$\nwhere the constant vector $\\{c\\}$ is defined as:\n$$ \\{c\\}^{\\mathsf{T}} = \\begin{pmatrix} 1 & -N_{A}(\\xi_{c}) & -N_{B}(\\xi_{c}) \\end{pmatrix} $$\n\nThe contribution to the residual vector, $\\{r_c\\}$, is derived from the principle of virtual work, which is equivalent to finding the negative gradient of the potential energy with respect to the displacement vector $\\{u\\}$.\n$$ \\{r_c\\} = -\\frac{\\partial\\Pi_c}{\\partial\\{u\\}} = -\\frac{\\partial}{\\partial\\{u\\}} \\left( \\frac{1}{2} w k_{n} g^{2} \\right) $$\nApplying the chain rule, we obtain:\n$$ \\{r_c\\} = -w k_{n} g \\frac{\\partial g}{\\partial\\{u\\}} $$\nThe gradient of the gap function $g$ with respect to $\\{u\\}$ is simply the constant vector $\\{c\\}$:\n$$ \\frac{\\partial g}{\\partial\\{u\\}} = \\{c\\} $$\nThus, the residual vector contribution is:\n$$ \\{r_c\\} = -w k_{n} g \\{c\\} = -w k_{n} \\left( \\{c\\}^{\\mathsf{T}}\\{u\\} + g_{0} \\right) \\{c\\} $$\n\nNext, the consistent tangent matrix contribution, $[K_c]$, is derived by taking the negative partial derivative of the residual vector contribution $\\{r_c\\}$ with respect to the displacement vector transpose $\\{u\\}^{\\mathsf{T}}$.\n$$ [K_c] = -\\frac{\\partial\\{r_c\\}}{\\partial\\{u\\}^{\\mathsf{T}}} = -\\frac{\\partial}{\\partial\\{u\\}^{\\mathsf{T}}} \\left( -w k_{n} g \\{c\\} \\right) = w k_{n} \\frac{\\partial}{\\partial\\{u\\}^{\\mathsf{T}}} \\left( g \\{c\\} \\right) $$\nUsing the product rule for differentiation:\n$$ [K_c] = w k_{n} \\left( \\frac{\\partial g}{\\partial\\{u\\}^{\\mathsf{T}}} \\{c\\} + g \\frac{\\partial\\{c\\}}{\\partial\\{u\\}^{\\mathsf{T}}} \\right) $$\nThe derivative of the scalar gap $g$ with respect to the row vector $\\{u\\}^{\\mathsf{T}}$ is the row vector $\\{c\\}^{\\mathsf{T}}$:\n$$ \\frac{\\partial g}{\\partial\\{u\\}^{\\mathsf{T}}} = \\{c\\}^{\\mathsf{T}} $$\nThe vector $\\{c\\}$ is composed of shape functions evaluated at a fixed parametric coordinate $\\xi_c$, and is therefore constant with respect to the displacements $\\{u\\}$. Its derivative is a zero matrix:\n$$ \\frac{\\partial\\{c\\}}{\\partial\\{u\\}^{\\mathsf{T}}} = [0] $$\nSubstituting these results yields the expression for the tangent matrix:\n$$ [K_c] = w k_{n} ( \\{c\\}^{\\mathsf{T}} \\{c\\} + [0] ) = w k_{n} \\{c\\} \\{c\\}^{\\mathsf{T}} $$\nWriting this outer product explicitly:\n$$ [K_c] = w k_{n} \\begin{pmatrix} 1 \\\\ -N_{A}(\\xi_{c}) \\\\ -N_{B}(\\xi_{c}) \\end{pmatrix} \\begin{pmatrix} 1 & -N_{A}(\\xi_{c}) & -N_{B}(\\xi_{c}) \\end{pmatrix} $$\n$$ [K_c] = w k_{n} \\begin{pmatrix} 1 & -N_A(\\xi_c) & -N_B(\\xi_c) \\\\ -N_A(\\xi_c) & N_A(\\xi_c)^2 & N_A(\\xi_c)N_B(\\xi_c) \\\\ -N_B(\\xi_c) & N_A(\\xi_c)N_B(\\xi_c) & N_B(\\xi_c)^2 \\end{pmatrix} $$\nThe rows and columns of this $3 \\times 3$ matrix correspond to the ordered degrees of freedom $(u_{s}^{n}, u_{A}^{n}, u_{B}^{n})$. The problem asks for the single scalar entry that couples the master nodes $A$ and $B$, which is the component $[K_c]_{AB}$. This corresponds to the entry in the second row and third column of the matrix derived above.\n$$ [K_c]_{AB} = w k_{n} N_{A}(\\xi_{c}) N_{B}(\\xi_{c}) $$\nWe now substitute the given expressions for the isoparametric shape functions:\n$$ N_{A}(\\xi_c) = \\frac{1-\\xi_c}{2} $$\n$$ N_{B}(\\xi_c) = \\frac{1+\\xi_c}{2} $$\nThis gives the final expression for the requested component:\n$$ [K_c]_{AB} = w k_{n} \\left( \\frac{1-\\xi_c}{2} \\right) \\left( \\frac{1+\\xi_c}{2} \\right) = w k_{n} \\frac{1 - \\xi_c^2}{4} $$\nThis expression represents the coupling stiffness between the normal displacements of the two master nodes, arising from the penalty enforcement of contact with a single slave node.", "answer": "$$\n\\boxed{w k_{n} \\frac{1 - \\xi_{c}^{2}}{4}}\n$$", "id": "2581208"}]}