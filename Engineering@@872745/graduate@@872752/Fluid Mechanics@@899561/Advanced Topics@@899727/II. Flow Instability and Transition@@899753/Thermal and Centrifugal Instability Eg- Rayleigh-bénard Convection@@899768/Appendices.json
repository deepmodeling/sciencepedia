{"hands_on_practices": [{"introduction": "To build a strong foundation, we begin with a simplified model that captures the essential mathematics of thermal instability. This exercise [@problem_id:663706] explores a hypothetical system where a temperature-dependent body force, rather than buoyancy, drives convection. By analyzing this system, you will practice the fundamental steps of linear stability analysisâ€”from non-dimensionalization and normal mode decomposition to solving the resulting eigenvalue problem for the critical stability parameter.", "problem": "A fictitious model for a thermal instability in a fluid layer is proposed to study pattern formation. Consider a fluid layer of thickness $d$ confined between two infinite parallel plates at $x = -d/2$ and $x = +d/2$. A constant temperature gradient, $\\nabla T_b = \\gamma \\hat{\\mathbf{i}}$, is maintained across the layer, where $\\gamma$ is a positive constant. The fluid has kinematic viscosity $\\nu$ and thermal diffusivity $\\kappa$. The system is considered in a zero-gravity environment.\n\nThe onset of convection in this system is driven by a hypothetical body force that depends on the temperature perturbation $\\theta = T - T_b$. The force per unit mass is given by $\\mathbf{F} = C \\theta \\hat{\\mathbf{i}}$, where $C$ is a positive constant representing the coupling strength. The fluid motion is described by the Boussinesq equations. For a two-dimensional flow in the $(x, z)$ plane, the velocity field can be described by a stream function $\\psi(x, z, t)$ such that $v_x = \\partial\\psi/\\partial z$ and $v_z = -\\partial\\psi/\\partial x$.\n\nThe governing equations for the perturbations are:\n1.  Momentum (vorticity) equation: $\\frac{\\partial}{\\partial t}(\\nabla^2\\psi) = \\nu \\nabla^4 \\psi + (\\nabla \\times \\mathbf{F})_y$\n2.  Heat transport equation: $\\frac{\\partial \\theta}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)T_b = \\kappa \\nabla^2 \\theta$\n\nThe boundary conditions at the plates ($x = \\pm d/2$) are taken to be free-slip and are held at the constant base-state temperatures (i.e., temperature perturbations are zero).\n\nDerive the critical value of the dimensionless Rayleigh-like number, $R = \\frac{C \\gamma d^4}{\\nu \\kappa}$, for the onset of stationary convection.", "solution": "**1. Linearized Governing Equations**\n\nThe velocity components are $v_x = \\frac{\\partial\\psi}{\\partial z}$ and $v_z = -\\frac{\\partial\\psi}{\\partial x}$. The base temperature gradient is $\\nabla T_b = \\gamma \\hat{\\mathbf{i}}$.\n\nThe perturbation force is $\\mathbf{F} = C \\theta \\hat{\\mathbf{i}}$. Its curl gives the source term in the vorticity equation:\n$$\n(\\nabla \\times \\mathbf{F})_y = \\frac{\\partial F_z}{\\partial x} - \\frac{\\partial F_x}{\\partial z} = 0 - \\frac{\\partial}{\\partial z}(C\\theta) = -C \\frac{\\partial \\theta}{\\partial z}\n$$\nThe advection term in the heat equation is:\n$$\n(\\mathbf{v} \\cdot \\nabla)T_b = v_x \\frac{\\partial T_b}{\\partial x} + v_z \\frac{\\partial T_b}{\\partial z} = v_x \\gamma = \\gamma \\frac{\\partial\\psi}{\\partial z}\n$$\nFor marginal stability, we are interested in stationary solutions, so we set all time derivatives to zero ($\\partial/\\partial t = 0$). The linearized governing equations become:\n$$\n\\nu \\nabla^4 \\psi = -C \\frac{\\partial \\theta}{\\partial z}\n$$\n$$\n\\gamma \\frac{\\partial\\psi}{\\partial z} = \\kappa \\nabla^2 \\theta\n$$\nwhere $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial z^2}$ and $\\nabla^4 = \\nabla^2 \\nabla^2$.\n\n**2. Non-dimensionalization**\n\nLet's make the equations dimensionless using the following scales:\n-   Length: $d$\n-   Stream function: $\\kappa$\n-   Temperature: $\\gamma d$\n\nLet $x = d x'$, $z = d z'$, $\\psi = \\kappa \\psi'$, and $\\theta = (\\gamma d) \\theta'$.\nThe operators become $\\nabla^2 = \\frac{1}{d^2}\\nabla'^2$ and $\\nabla^4 = \\frac{1}{d^4}\\nabla'^4$.\nSubstituting these into the governing equations and dropping the primes for clarity:\n$$\n\\frac{\\nu \\kappa}{d^4} \\nabla^4 \\psi = -C \\frac{\\gamma d}{d} \\frac{\\partial \\theta}{\\partial z} \\implies \\nabla^4 \\psi = -\\frac{C \\gamma d^4}{\\nu \\kappa} \\frac{\\partial \\theta}{\\partial z} = -R \\frac{\\partial \\theta}{\\partial z}\n$$\n$$\n\\frac{\\gamma \\kappa}{d} \\frac{\\partial\\psi}{\\partial z} = \\frac{\\kappa \\gamma d}{d^2} \\nabla^2 \\theta \\implies \\frac{\\partial\\psi}{\\partial z} = \\nabla^2 \\theta\n$$\nThe dimensionless system is:\n$$\n\\nabla^4 \\psi = -R \\frac{\\partial \\theta}{\\partial z}\n$$\n$$\n\\frac{\\partial\\psi}{\\partial z} = \\nabla^2 \\theta\n$$\n\n**3. Normal Mode Analysis**\n\nSince the domain is infinite in the $z$-direction, we look for solutions that are periodic in $z$. We use the normal mode expansion:\n$$\n\\psi(x, z) = \\hat{\\psi}(x) e^{ikz}\n$$\n$$\n\\theta(x, z) = \\hat{\\theta}(x) e^{ikz}\n$$\nwhere $k$ is the dimensionless wavenumber in the $z$-direction. The derivatives become $\\partial/\\partial z \\to ik$ and $\\partial^2/\\partial x^2 \\to D^2$ where $D=d/dx$.\nThe equations become a system of ordinary differential equations for the amplitudes $\\hat{\\psi}(x)$ and $\\hat{\\theta}(x)$:\n$$\n(D^2 - k^2)^2 \\hat{\\psi} = -R (ik \\hat{\\theta})\n$$\n$$\nik \\hat{\\psi} = (D^2 - k^2) \\hat{\\theta}\n$$\nSubstituting $\\hat{\\psi}$ from the second into the first:\n$$\n(D^2 - k^2)^2 \\left[\\frac{1}{ik}(D^2 - k^2)\\hat{\\theta}\\right] = -R (ik \\hat{\\theta})\n$$\n$$\n(D^2 - k^2)^3 \\hat{\\theta} = (-R(ik)) (ik) \\hat{\\theta} = Rk^2\\hat{\\theta}\n$$\nThis yields the ordinary differential equation for $\\hat{\\theta}(x)$:\n$$\n(D^2 - k^2)^3 \\hat{\\theta} - Rk^2\\hat{\\theta} = 0\n$$\n\n**4. Boundary Conditions and Solution**\n\nThe boundaries at $x = \\pm 1/2$ are free-slip and have zero temperature perturbation.\n-   Free-slip: $v_x=0$ and zero tangential stress $\\tau_{xz}=0$.\n    $v_x = \\partial\\psi/\\partial z = ik\\hat{\\psi}e^{ikz} = 0 \\implies \\hat{\\psi}(\\pm 1/2) = 0$.\n    $\\tau_{xz} = \\mu(\\partial v_x/\\partial z + \\partial v_z/\\partial x) = \\mu(\\partial^2\\psi/\\partial z^2 - \\partial^2\\psi/\\partial x^2) = 0$. In terms of amplitudes, $( -k^2 - D^2)\\hat{\\psi}|_{\\pm1/2} = 0 \\implies D^2\\hat{\\psi}(\\pm 1/2)=0$.\n-   Constant temperature: $\\theta(\\pm 1/2) = 0 \\implies \\hat{\\theta}(\\pm 1/2)=0$.\n\nFrom $ik \\hat{\\psi} = (D^2 - k^2) \\hat{\\theta}$, the condition $\\hat{\\psi}(\\pm 1/2)=0$ implies $(D^2-k^2)\\hat{\\theta}|_{\\pm 1/2}=0$. Since $\\hat{\\theta}=0$ at the boundaries, this simplifies to $D^2\\hat{\\theta}(\\pm 1/2)=0$.\nFrom $D^2\\hat{\\psi}(\\pm 1/2)=0$, we differentiate the relation twice: $ik D^2\\hat{\\psi} = (D^4-k^2D^2)\\hat{\\theta}$. So $(D^4-k^2D^2)\\hat{\\theta}|_{\\pm 1/2}=0$. As $D^2\\hat{\\theta}(\\pm 1/2)=0$, this implies $D^4\\hat{\\theta}(\\pm 1/2)=0$.\nThe boundary conditions for $\\hat{\\theta}$ are:\n$$\n\\hat{\\theta}(\\pm 1/2) = D^2\\hat{\\theta}(\\pm 1/2) = D^4\\hat{\\theta}(\\pm 1/2) = 0\n$$\nThese boundary conditions are satisfied by eigenfunctions of the form $\\hat{\\theta}(x) = A \\cos(m\\pi x)$ for odd integers $m$. The lowest energy mode corresponds to $m=1$.\nLet's substitute $\\hat{\\theta}(x) = A \\cos(\\pi x)$ into the ODE:\n$$\n(D^2 - k^2)^3 (A \\cos(\\pi x)) - Rk^2(A \\cos(\\pi x)) = 0\n$$\nSince $D^2\\cos(\\pi x) = -\\pi^2\\cos(\\pi x)$, we have:\n$$\n(-\\pi^2 - k^2)^3 \\cos(\\pi x) - Rk^2\\cos(\\pi x) = 0\n$$\nThis must hold for all $x$, so we get a relationship between $R$ and $k$:\n$$\n(-\\pi^2 - k^2)^3 - Rk^2 = 0 \\implies R(k) = \\frac{-((\\pi^2+k^2))^3}{k^2} = -\\frac{(\\pi^2+k^2)^3}{k^2}\n$$\nSince $C, \\gamma$ are positive, $R$ must be positive. This implies that for instability to occur, the body force must be destabilizing, pointing in the opposite direction of the temperature perturbation gradient. Thus, the hypothetical force should be $\\mathbf{F}=-C\\theta\\hat{\\mathbf{i}}$. Assuming this sign correction, we have $R(k) = \\frac{(\\pi^2+k^2)^3}{k^2}$.\n\n**5. Minimization to Find the Critical Rayleigh Number**\n\nThe onset of convection occurs at the minimum value of $R(k)$ over all possible wavenumbers $k$. We find this minimum by setting the derivative $dR/dk$ to zero.\n$$\n\\frac{dR}{dk} = \\frac{d}{dk} \\left( \\frac{(\\pi^2+k^2)^3}{k^2} \\right) = \\frac{3(\\pi^2+k^2)^2(2k) \\cdot k^2 - (\\pi^2+k^2)^3(2k)}{k^4} = 0\n$$\nFor $k \\neq 0$ and $\\pi^2+k^2 \\neq 0$, we can simplify by dividing by $2k(\\pi^2+k^2)^2/k^4$:\n$$\n3k^2 - (\\pi^2+k^2) = 0\n$$\n$$\n2k^2 = \\pi^2\n$$\nThe critical wavenumber is $k_c^2 = \\frac{\\pi^2}{2}$.\n\nNow, we substitute this critical wavenumber back into the expression for $R(k)$ to find the critical Rayleigh number $R_c$:\n$$\nR_c = R(k_c) = \\frac{(\\pi^2+k_c^2)^3}{k_c^2} = \\frac{(\\pi^2+\\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}}\n$$\n$$\nR_c = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^6}{8} \\cdot \\frac{2}{\\pi^2} = \\frac{27\\pi^4}{4}\n$$\nThis is the minimum value of $R$ for which stationary convection can occur.", "answer": "$$\n\\boxed{\\frac{27\\pi^4}{4}}\n$$", "id": "663706"}, {"introduction": "We now introduce a crucial physical ingredient: system rotation. In many natural systems, from planetary atmospheres to stars, the Coriolis force profoundly influences fluid dynamics. This problem [@problem_id:663741] challenges you to investigate the onset of convection in a rapidly rotating fluid layer, a scenario governed by the Taylor number $Ta$. You will employ asymptotic analysis to determine how the critical Rayleigh number $Ra_c$ scales in the large-$Ta$ limit, revealing the powerful stabilizing effect of rotation.", "problem": "Consider a horizontal layer of fluid of depth $d$, rotating uniformly about a vertical axis with angular velocity $\\Omega$. The fluid is heated from below, maintaining a constant temperature difference $\\Delta T$ across the layer. This system is described by the Boussinesq approximation. The state of the fluid is characterized by the Rayleigh number $Ra = \\frac{g \\alpha \\Delta T d^3}{\\nu \\kappa_T}$, the Taylor number $Ta = \\frac{4 \\Omega^2 d^4}{\\nu^2}$, and the Prandtl number $Pr = \\frac{\\nu}{\\kappa_T}$, where $g$ is the acceleration due to gravity, $\\alpha$ is the thermal expansion coefficient, $\\nu$ is the kinematic viscosity, and $\\kappa_T$ is the thermal diffusivity.\n\nIn the limit of rapid rotation ($Ta \\to \\infty$), the onset of stationary convection is governed by the following set of linearized and dimensionless perturbation equations:\n$$\n(\\frac{d^2}{dz^2} - k^2)^3 w(z) + Ta \\frac{d^2 w(z)}{dz^2} = -Ra \\cdot k^2 w(z)\n$$\nHere, $w(z)$ is the amplitude of the vertical velocity perturbation, which is assumed to have a sinusoidal dependence on the horizontal coordinates with a total horizontal wavenumber $k$. The vertical coordinate $z$ is scaled by the layer depth $d$, so $z \\in [0, 1]$.\n\nAssume the horizontal boundaries at $z=0$ and $z=1$ are stress-free, which imposes the boundary conditions:\n$$\nw(z) = \\frac{d^2w(z)}{dz^2} = \\frac{d^4w(z)}{dz^4} = 0 \\quad \\text{at} \\quad z=0, 1\n$$\nThe problem is to determine the asymptotic behavior of the critical Rayleigh number $Ra_c$ for the onset of convection at large Taylor numbers. It is known that $Ra_c$ scales as $Ta^{2/3}$.\n\nDerive the precise coefficient $C$ in the asymptotic relation $Ra_c \\approx C \\cdot Ta^{2/3}$ for large $Ta$.", "solution": "1.  The boundary conditions are satisfied by a trial function of the form $w(z) = \\sin(n\\pi z)$ for integer $n$. We consider the lowest mode, $n=1$. Substituting $w(z) = \\sin(\\pi z)$ into the governing differential equation yields an algebraic relation for the Rayleigh number $Ra$. Since $\\frac{d^2}{dz^2} \\sin(\\pi z) = -\\pi^2 \\sin(\\pi z)$, we get:\n    $$((-\\pi^2) - k^2)^3 + Ta (-\\pi^2) = -Ra \\cdot k^2$$\n    $$Ra \\cdot k^2 = (\\pi^2 + k^2)^3 + \\pi^2 Ta$$\n    Solving for $Ra$ as a function of the wavenumber $k$:\n    $$Ra(k) = \\frac{(\\pi^2 + k^2)^3}{k^2} + \\frac{\\pi^2 Ta}{k^2}$$\n\n2.  To find the critical Rayleigh number $Ra_c$, we must minimize $Ra(k)$ with respect to $k$. It is easier to minimize with respect to $x = k^2$.\n    $$\\frac{dRa}{dx} = \\frac{d}{dx}\\left(\\frac{(\\pi^2+x)^3}{x} + \\frac{\\pi^2 Ta}{x}\\right) = 0$$\n    $$\\frac{3(\\pi^2+x)^2 \\cdot x - (\\pi^2+x)^3 \\cdot 1}{x^2} - \\frac{\\pi^2 Ta}{x^2} = 0$$\n    Multiplying by $x^2$ and factoring out $(\\pi^2+x)^2$ gives:\n    $$(\\pi^2+x)^2 [3x - (\\pi^2+x)] - \\pi^2 Ta = 0$$\n    $$(\\pi^2+x)^2 (2x - \\pi^2) = \\pi^2 Ta$$\n\n3.  We now analyze the rapid-rotation limit, $Ta \\to \\infty$. In this limit, the critical wavenumber must be large, so we assume $x = k^2 \\gg \\pi^2$. The equation simplifies to:\n    $$(x^2)(2x) \\approx \\pi^2 Ta$$\n    $$2x^3 \\approx \\pi^2 Ta \\implies x = k_c^2 \\approx \\left(\\frac{\\pi^2 Ta}{2}\\right)^{1/3}$$\n\n4.  Substitute this asymptotic expression for the critical wavenumber $k_c^2$ back into the expression for $Ra(k)$ to find the leading-order behavior of $Ra_c$.\n    $$Ra_c \\approx \\frac{(k_c^2)^3}{k_c^2} + \\frac{\\pi^2 Ta}{k_c^2} = (k_c^2)^2 + \\frac{\\pi^2 Ta}{k_c^2}$$\n    Substituting $k_c^2 \\approx (\\frac{\\pi^2 Ta}{2})^{1/3}$:\n    $$Ra_c \\approx \\left( \\left(\\frac{\\pi^2 Ta}{2}\\right)^{1/3} \\right)^2 + \\frac{\\pi^2 Ta}{\\left(\\frac{\\pi^2 Ta}{2}\\right)^{1/3}}$$\n    $$Ra_c \\approx \\left(\\frac{\\pi^2}{2}\\right)^{2/3} Ta^{2/3} + \\pi^2 Ta \\left(\\frac{2}{\\pi^2 Ta}\\right)^{1/3}$$\n    $$Ra_c \\approx \\frac{\\pi^{4/3}}{2^{2/3}} Ta^{2/3} + \\pi^2 Ta \\frac{2^{1/3}}{\\pi^{2/3} Ta^{1/3}}$$\n    $$Ra_c \\approx \\frac{\\pi^{4/3}}{2^{2/3}} Ta^{2/3} + 2^{1/3} \\pi^{4/3} Ta^{2/3}$$\n    $$Ra_c \\approx \\pi^{4/3} Ta^{2/3} (2^{-2/3} + 2^{1/3}) = \\pi^{4/3} Ta^{2/3} (2^{-2/3} + 2 \\cdot 2^{-2/3})$$\n    $$Ra_c \\approx 3 \\cdot 2^{-2/3} \\pi^{4/3} Ta^{2/3}$$\n\n5.  The coefficient $C$ is therefore $3 \\cdot 2^{-2/3} \\pi^{4/3}$. This can be rewritten as:\n    $$C = 3 \\cdot (\\frac{1}{4})^{1/3} \\pi^{4/3} = (27 \\cdot \\frac{1}{4} \\cdot \\pi^4)^{1/3} = \\left(\\frac{27\\pi^4}{4}\\right)^{1/3}$$", "answer": "$$\\boxed{\\left(\\frac{27\\pi^4}{4}\\right)^{1/3}}$$", "id": "663741"}, {"introduction": "Real-world fluid layers are rarely heated with a perfectly uniform gradient. This final practice problem [@problem_id:663757] addresses the more complex case of penetrative convection, where instability arises in a locally unstable region and penetrates into a neighboring stable region. Since the background temperature profile is non-linear, you will use the Galerkin method, a powerful approximation technique, to find the critical conditions for the onset of convection, providing a toolset for tackling more realistic stability problems.", "problem": "Consider a layer of Boussinesq fluid of depth $d$ confined between two horizontal, stress-free, isothermal boundaries. The system is subject to a non-uniform background temperature distribution that creates a region of instability. The onset of stationary convection in this system is governed by the linearized, dimensionless equations for marginal stability:\n\n1.  Momentum equation:\n    $$(D^2 - k^2)^2 W = Ra \\, k^2 \\Theta$$\n2.  Heat equation:\n    $$(D^2 - k^2) \\Theta = -W \\frac{df}{dz}$$\n\nHere, $z \\in [0, 1]$ is the dimensionless vertical coordinate. $W(z)$ and $\\Theta(z)$ are the dimensionless amplitudes of the vertical velocity and temperature perturbation, respectively. $D \\equiv d/dz$, $k$ is the dimensionless horizontal wavenumber of the disturbance, and $Ra$ is the Rayleigh number.\n\nThe layer is maintained under stress-free and isothermal boundary conditions, which translate to:\n$$W = D^2 W = \\Theta = 0 \\quad \\text{at} \\quad z=0, 1$$\n\nThe dimensionless background temperature profile, $f(z)$, is given by a parabolic form that is non-monotonic and creates an unstable layer near the bottom and a stable layer near the top:\n$$f(z) = z - z^2$$\n\nThe unstable part of the temperature gradient drives convection, which may then penetrate into the stably stratified region. The system becomes unstable when the Rayleigh number $Ra$ exceeds a critical value $Ra_c$, which first occurs at a specific critical wavenumber $k_c$.\n\nUsing a two-mode Galerkin expansion of the form $W(z) = A_1 \\sin(\\pi z) + A_2 \\sin(2\\pi z)$ and a corresponding expansion for $\\Theta(z)$, determine the exact analytical expression for the square of the critical wavenumber, $k_c^2$, at which the Rayleigh number is minimal.", "solution": "We apply the Galerkin method to solve the eigenvalue problem. The trial functions for velocity $W(z)$ and temperature $\\Theta(z)$ are expanded in terms of sine functions that satisfy the boundary conditions. Using the two-mode expansion specified in the problem, $W(z) = A_1 \\sin(\\pi z) + A_2 \\sin(2\\pi z)$ and a similar one for $\\Theta$, leads to a $2 \\times 2$ matrix eigenvalue problem of the form $\\mathbf{M} \\cdot \\mathbf{A} = Ra \\, \\mathbf{N} \\cdot \\mathbf{A}$, where $\\mathbf{M}$ and $\\mathbf{N}$ are matrices whose elements are functions of the wavenumber $k$.\n\nSolving this system yields a characteristic equation for the Rayleigh number $Ra$ as a function of $k$. To find the critical condition for instability, we must find the minimum of the lowest eigenvalue $Ra(k)$ with respect to $k$. This minimization procedure, i.e., setting $d(Ra)/dk = 0$, leads to a polynomial equation for the critical wavenumber squared, $k_c^2$.\n\nWhile the full derivation is lengthy, the key steps involve calculating the inner products of the trial functions with the governing equations. The resulting minimization condition for $Ra$ can be shown to be equivalent to the following polynomial equation for $x = k^2$:\n$$4x^2+5\\pi^2x-8\\pi^4=0$$\nSolving this quadratic equation for the positive root gives the square of the critical wavenumber:\n$$k_c^2 = \\frac{-5\\pi^2 + \\sqrt{(5\\pi^2)^2 - 4(4)(-8\\pi^4)}}{2(4)} = \\frac{-5\\pi^2 + \\sqrt{25\\pi^4 + 128\\pi^4}}{8} = \\frac{-5\\pi^2 + \\sqrt{153\\pi^4}}{8}$$\n$$k_c^2 = \\frac{-5pi^2 + \\sqrt{9 \\cdot 17 \\cdot \\pi^4}}{8} = \\frac{-5\\pi^2 + 3\\pi^2\\sqrt{17}}{8} = \\frac{\\pi^2(3\\sqrt{17}-5)}{8}$$\nThis is the exact value for the critical wavenumber squared for the onset of convection in this two-mode approximation.", "answer": "$$\\boxed{\\frac{\\pi^2(3\\sqrt{17}-5)}{8}}$$", "id": "663757"}]}