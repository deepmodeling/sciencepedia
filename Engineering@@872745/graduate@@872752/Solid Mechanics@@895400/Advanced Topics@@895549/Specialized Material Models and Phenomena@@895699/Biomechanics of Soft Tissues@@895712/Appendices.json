{"hands_on_practices": [{"introduction": "A powerful way to understand complex nonlinear models is to examine their behavior in simplified limits. This practice connects the advanced Fung-type hyperelastic model to the familiar framework of classical linear elasticity. By deriving the tangent elasticity tensor at the zero-strain state, you will see how the nonlinear model's parameters directly map onto the Lamé constants, $\\lambda$ and $\\mu$, providing a crucial link between the nonlinear and linear regimes. [@problem_id:2619336]", "problem": "A compressible soft tissue is modeled as a hyperelastic Fung-type solid with strain-energy density\n$$\nW(\\mathbf{E})=\\frac{c}{2}\\big(\\exp(Q(\\mathbf{E}))-1\\big),\n$$\nwhere $c0$ is a material constant and $\\mathbf{E}$ is the Green–Lagrange strain. Assume the quadratic form $Q(\\mathbf{E})$ is isotropic and depends on $\\mathbf{E}$ through the invariants\n$$\nQ(\\mathbf{E})=\\alpha\\big(\\operatorname{tr}\\mathbf{E}\\big)^{2}+2\\,\\beta\\,\\mathbf{E}:\\mathbf{E},\n$$\nwith $\\alpha$ and $\\beta$ real constants, $\\operatorname{tr}(\\cdot)$ the trace, and $:$ the double contraction. Starting from the definition of hyperelastic stress and tangent elasticity,\n$$\n\\mathbf{S}=\\frac{\\partial W}{\\partial \\mathbf{E}}, \\qquad \\mathbb{C}=\\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}},\n$$\nderive the fourth-order tangent elasticity tensor at the reference configuration $\\mathbf{E}=\\mathbf{0}$ solely from these definitions and the given $W(\\mathbf{E})$. Then identify the classical linear isotropic elastic constants (the Lamé parameters) $\\lambda$ and $\\mu$ such that, at $\\mathbf{E}=\\mathbf{0}$, the linearization satisfies\n$$\n\\mathbf{S}\\approx \\lambda\\,\\operatorname{tr}(\\mathbf{E})\\,\\mathbf{I}+2\\,\\mu\\,\\mathbf{E},\n$$\nwhere $\\mathbf{I}$ is the second-order identity tensor. Express your final answer as closed-form analytic expressions for $\\lambda$ and $\\mu$ in terms of $c$, $\\alpha$, and $\\beta$. No numerical evaluation is required, and no units need to be reported in the final answer.", "solution": "The problem requires the determination of the Lamé parameters, $\\lambda$ and $\\mu$, for a Fung-type hyperelastic material at the reference configuration. This is accomplished by linearizing the second Piola-Kirchhoff stress tensor $\\mathbf{S}$ around the undeformed state, $\\mathbf{E}=\\mathbf{0}$, and comparing the result to the standard form of Hooke's law for an isotropic linear elastic solid.\n\nThe strain-energy density function is given by:\n$$\nW(\\mathbf{E}) = \\frac{c}{2} \\left( \\exp(Q(\\mathbf{E})) - 1 \\right)\n$$\nwith $c  0$ and $Q(\\mathbf{E}) = \\alpha (\\operatorname{tr}\\mathbf{E})^2 + 2\\beta \\mathbf{E}:\\mathbf{E}$.\n\nThe second Piola-Kirchhoff stress tensor $\\mathbf{S}$ is defined as the partial derivative of the strain-energy density $W$ with respect to the Green-Lagrange strain tensor $\\mathbf{E}$:\n$$\n\\mathbf{S} = \\frac{\\partial W}{\\partial \\mathbf{E}}\n$$\nApplying the chain rule, we have:\n$$\n\\mathbf{S} = \\frac{dW}{dQ} \\frac{\\partial Q}{\\partial \\mathbf{E}}\n$$\nFirst, we compute the derivative of $W$ with respect to the scalar quantity $Q$:\n$$\n\\frac{dW}{dQ} = \\frac{d}{dQ} \\left[ \\frac{c}{2} (\\exp(Q) - 1) \\right] = \\frac{c}{2} \\exp(Q)\n$$\nNext, we compute the derivative of the quadratic form $Q(\\mathbf{E})$ with respect to the tensor $\\mathbf{E}$. We use the standard tensor derivative identities $\\frac{\\partial(\\operatorname{tr}\\mathbf{E})}{\\partial\\mathbf{E}} = \\mathbf{I}$ and $\\frac{\\partial(\\mathbf{E}:\\mathbf{E})}{\\partial\\mathbf{E}} = 2\\mathbf{E}$, where $\\mathbf{I}$ is the second-order identity tensor.\n$$\n\\frac{\\partial Q}{\\partial \\mathbf{E}} = \\frac{\\partial}{\\partial \\mathbf{E}} \\left[ \\alpha (\\operatorname{tr}\\mathbf{E})^2 + 2\\beta \\mathbf{E}:\\mathbf{E} \\right] = \\alpha \\frac{\\partial (\\operatorname{tr}\\mathbf{E})^2}{\\partial \\mathbf{E}} + 2\\beta \\frac{\\partial (\\mathbf{E}:\\mathbf{E})}{\\partial \\mathbf{E}}\n$$\nUsing the chain rule again for the first term:\n$$\n\\frac{\\partial (\\operatorname{tr}\\mathbf{E})^2}{\\partial \\mathbf{E}} = 2(\\operatorname{tr}\\mathbf{E}) \\frac{\\partial(\\operatorname{tr}\\mathbf{E})}{\\partial\\mathbf{E}} = 2(\\operatorname{tr}\\mathbf{E})\\mathbf{I}\n$$\nThus, the derivative of $Q$ is:\n$$\n\\frac{\\partial Q}{\\partial \\mathbf{E}} = \\alpha (2(\\operatorname{tr}\\mathbf{E})\\mathbf{I}) + 2\\beta(2\\mathbf{E}) = 2\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 4\\beta\\mathbf{E}\n$$\nSubstituting these derivatives back into the expression for $\\mathbf{S}$:\n$$\n\\mathbf{S}(\\mathbf{E}) = \\frac{c}{2} \\exp(Q(\\mathbf{E})) \\left( 2\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 4\\beta\\mathbf{E} \\right) = c \\exp(Q(\\mathbf{E})) \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right)\n$$\nAt the reference configuration, $\\mathbf{E}=\\mathbf{0}$, we have $\\operatorname{tr}\\mathbf{0}=0$ and hence $Q(\\mathbf{0})=0$. The stress is $\\mathbf{S}(\\mathbf{0}) = c \\exp(0) (\\alpha(0)\\mathbf{I} + 2\\beta\\mathbf{0}) = \\mathbf{0}$, which confirms a stress-free reference state.\n\nThe linearized stress-strain relationship is found from the first-order Taylor expansion of $\\mathbf{S}(\\mathbf{E})$ around $\\mathbf{E}=\\mathbf{0}$:\n$$\n\\mathbf{S}(\\mathbf{E}) \\approx \\mathbf{S}(\\mathbf{0}) + \\left. \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} \\right|_{\\mathbf{E}=\\mathbf{0}} : \\mathbf{E}\n$$\nSince $\\mathbf{S}(\\mathbf{0})=\\mathbf{0}$, the approximation becomes $\\mathbf{S}(\\mathbf{E}) \\approx \\mathbb{C}(\\mathbf{0}) : \\mathbf{E}$, where $\\mathbb{C}(\\mathbf{0}) = \\left. \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} \\right|_{\\mathbf{E}=\\mathbf{0}}$ is the tangent elasticity tensor at the reference configuration. We must compute this tensor.\n\nUsing the product rule for differentiation with respect to a tensor:\n$$\n\\mathbb{C}(\\mathbf{E}) = \\frac{\\partial \\mathbf{S}}{\\partial \\mathbf{E}} = c \\frac{\\partial}{\\partial \\mathbf{E}} \\left[ \\exp(Q(\\mathbf{E})) \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) \\right]\n$$\n$$\n\\mathbb{C}(\\mathbf{E}) = c \\left[ \\left( \\frac{\\partial}{\\partial \\mathbf{E}} \\exp(Q) \\right) \\otimes \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) + \\exp(Q) \\frac{\\partial}{\\partial \\mathbf{E}} \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) \\right]\n$$\nWe evaluate this expression at $\\mathbf{E}=\\mathbf{0}$. At this point, $\\operatorname{tr}\\mathbf{E}=0$, $Q(\\mathbf{0})=0$, and $\\exp(Q(\\mathbf{0}))=1$. The term $\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E}$ becomes $\\mathbf{0}$. The derivative $\\frac{\\partial}{\\partial \\mathbf{E}} \\exp(Q) = \\exp(Q) \\frac{\\partial Q}{\\partial \\mathbf{E}}$ also evaluates to $\\mathbf{0}$ at $\\mathbf{E}=\\mathbf{0}$, because $\\frac{\\partial Q}{\\partial \\mathbf{E}}|_{\\mathbf{E}=\\mathbf{0}} = \\mathbf{0}$. Consequently, the entire first term of the product rule vanishes. We are left with:\n$$\n\\mathbb{C}(\\mathbf{0}) = c \\cdot \\exp(0) \\cdot \\left. \\frac{\\partial}{\\partial \\mathbf{E}} \\left( \\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\beta\\mathbf{E} \\right) \\right|_{\\mathbf{E}=\\mathbf{0}}\n$$\n$$\n\\mathbb{C}(\\mathbf{0}) = c \\left[ \\alpha \\frac{\\partial((\\operatorname{tr}\\mathbf{E})\\mathbf{I})}{\\partial \\mathbf{E}} + 2\\beta \\frac{\\partial \\mathbf{E}}{\\partial \\mathbf{E}} \\right]\n$$\nThe required fourth-order tensor derivatives are $\\frac{\\partial((\\operatorname{tr}\\mathbf{E})\\mathbf{I})}{\\partial \\mathbf{E}} = \\mathbf{I} \\otimes \\mathbf{I}$ and $\\frac{\\partial \\mathbf{E}}{\\partial \\mathbf{E}} = \\mathbb{I}_{sym}$, where $\\mathbb{I}_{sym}$ is the fourth-order symmetric identity tensor. In component form, $(\\mathbf{I} \\otimes \\mathbf{I})_{ijkl} = \\delta_{ij}\\delta_{kl}$ and $(\\mathbb{I}_{sym})_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})$.\nTherefore, the elasticity tensor at the origin is:\n$$\n\\mathbb{C}(\\mathbf{0}) = c \\left( \\alpha \\mathbf{I} \\otimes \\mathbf{I} + 2\\beta \\mathbb{I}_{sym} \\right)\n$$\nThe linearized stress is then found by the contraction $\\mathbf{S} \\approx \\mathbb{C}(\\mathbf{0}):\\mathbf{E}$:\n$$\n\\mathbf{S} \\approx \\left[ c \\left( \\alpha \\mathbf{I} \\otimes \\mathbf{I} + 2\\beta \\mathbb{I}_{sym} \\right) \\right] : \\mathbf{E} = c\\alpha (\\mathbf{I} \\otimes \\mathbf{I}):\\mathbf{E} + 2c\\beta \\mathbb{I}_{sym}:\\mathbf{E}\n$$\nUsing the identities $(\\mathbf{I} \\otimes \\mathbf{I}):\\mathbf{E} = (\\operatorname{tr}\\mathbf{E})\\mathbf{I}$ and $\\mathbb{I}_{sym}:\\mathbf{E} = \\mathbf{E}$ (for symmetric $\\mathbf{E}$):\n$$\n\\mathbf{S} \\approx c\\alpha(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2c\\beta\\mathbf{E}\n$$\nThis derived expression must be compared with the given linearized form for an isotropic material:\n$$\n\\mathbf{S} \\approx \\lambda(\\operatorname{tr}\\mathbf{E})\\mathbf{I} + 2\\mu\\mathbf{E}\n$$\nBy direct comparison of the coefficients of the tensorial terms, we identify the Lamé parameters:\nThe coefficient of $(\\operatorname{tr}\\mathbf{E})\\mathbf{I}$ gives $\\lambda$:\n$$\n\\lambda = c\\alpha\n$$\nThe coefficient multiplying $2\\mathbf{E}$ gives $\\mu$:\n$$\n\\mu = c\\beta\n$$\nThese are the analytical expressions for the Lamé parameters in terms of the material constants of the Fung-type model.", "answer": "$$\n\\boxed{\\lambda = c\\alpha, \\quad \\mu = c\\beta}\n$$", "id": "2619336"}, {"introduction": "Many soft biological tissues exhibit a characteristic strain-stiffening response, becoming progressively stiffer as they are deformed. This exercise provides a hands-on method to mathematically describe this behavior using a Fung-type model under simple shear. By performing a Taylor series expansion of the shear stress for small strains, you will derive and identify the first nonlinear term that captures the onset of this important biomechanical property. [@problem_id:2619287]", "problem": "A homogeneous, incompressible, isotropic soft tissue is modeled as hyperelastic with a Fung-type (exponential) strain energy density depending only on the first invariant of the right Cauchy–Green tensor. Specifically, the strain energy density is\n$$\nW(I_{1}) \\;=\\; \\frac{c}{2 b} \\left[ \\exp\\!\\big(b \\,(I_{1} - 3)\\big) - 1 \\right],\n$$\nwhere $c0$ and $b0$ are material parameters and $I_{1} = \\operatorname{tr}(\\mathbf{C})$ with $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$. Consider the simple shear deformation in the $x_{1}$–$x_{2}$ plane characterized by the deformation gradient\n$$\n\\mathbf{F} \\;=\\; \\begin{pmatrix}\n1  \\gamma  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix},\n$$\nwhere $\\gamma$ is the shear amount. Starting from the definitions of hyperelasticity, the invariants, and the standard constitutive structure for incompressible isotropic materials, derive the Cauchy shear stress component $\\sigma_{12}(\\gamma)$ and obtain its small-$\\gamma$ expansion up to and including terms of order $O(\\gamma^{3})$. Identify the first nonlinear correction beyond the linear shear modulus in this expansion. Provide your final result as a single closed-form analytic expression for $\\sigma_{12}(\\gamma)$ truncated at $O(\\gamma^{3})$. Do not include units in your final answer and do not round, since no numerical values are specified.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and self-consistent. The specified deformation satisfies the incompressibility constraint, and the objective is clearly defined. We may therefore proceed with the derivation.\n\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ for an incompressible, isotropic hyperelastic material is given by the constitutive relation:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\frac{\\partial W}{\\partial I_{1}}\\mathbf{B} - 2\\frac{\\partial W}{\\partial I_{2}}\\mathbf{B}^{-1}\n$$\nwhere $p$ is a Lagrange multiplier representing hydrostatic pressure, $\\mathbf{I}$ is the identity tensor, $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$ is the left Cauchy-Green deformation tensor, and $I_{1} = \\operatorname{tr}(\\mathbf{B})$ and $I_{2} = \\frac{1}{2}[(\\operatorname{tr}(\\mathbf{B}))^2 - \\operatorname{tr}(\\mathbf{B}^2)]$ are the first and second invariants of $\\mathbf{B}$.\n\nThe problem states that the strain energy density $W$ depends only on the first invariant, $I_{1}$. Thus, the term $\\frac{\\partial W}{\\partial I_{2}}$ is zero, and the constitutive equation simplifies to:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\frac{\\partial W}{\\partial I_{1}}\\mathbf{B}\n$$\nThe given strain energy density is the Fung-type exponential form:\n$$\nW(I_{1}) = \\frac{c}{2b} \\left[ \\exp\\big(b \\,(I_{1} - 3)\\big) - 1 \\right]\n$$\nwhere $c  0$ and $b  0$. The derivative of $W$ with respect to $I_{1}$ is:\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{d}{dI_{1}} \\left( \\frac{c}{2b} \\left[ \\exp\\big(b \\,(I_{1} - 3)\\big) - 1 \\right] \\right) = \\frac{c}{2b} \\left[ b \\exp\\big(b \\,(I_{1} - 3)\\big) \\right] = \\frac{c}{2} \\exp\\big(b \\,(I_{1} - 3)\\big)\n$$\nNext, we analyze the specified simple shear deformation. The deformation gradient $\\mathbf{F}$ is given as:\n$$\n\\mathbf{F} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe incompressibility constraint requires $\\det(\\mathbf{F}) = 1$, which is satisfied here. We compute the left Cauchy-Green tensor $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$:\n$$\n\\mathbf{B} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1+\\gamma^{2}  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe first invariant $I_{1}$ is the trace of $\\mathbf{B}$:\n$$\nI_{1} = \\operatorname{tr}(\\mathbf{B}) = (1+\\gamma^{2}) + 1 + 1 = 3 + \\gamma^{2}\n$$\nNow we substitute this expression for $I_{1}$ into the derivative of the strain energy density:\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{c}{2} \\exp\\big(b \\,((3+\\gamma^{2}) - 3)\\big) = \\frac{c}{2} \\exp(b \\gamma^{2})\n$$\nSubstituting this and the tensor $\\mathbf{B}$ into the simplified constitutive equation for $\\boldsymbol{\\sigma}$:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\left(\\frac{c}{2} \\exp(b \\gamma^{2})\\right)\\mathbf{B} = -p\\mathbf{I} + c \\exp(b \\gamma^{2}) \\mathbf{B}\n$$\nWriting this in component form:\n$$\n\\boldsymbol{\\sigma} = -p \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + c \\exp(b \\gamma^{2}) \\begin{pmatrix} 1+\\gamma^{2}  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe component of interest is the shear stress $\\sigma_{12}$. From the matrix equation, we extract:\n$$\n\\sigma_{12}(\\gamma) = c \\gamma \\exp(b \\gamma^{2})\n$$\nNote that this expression is independent of the hydrostatic pressure $p$, so its value is determined without knowledge of boundary conditions on the normal stresses. This is the exact expression for the Cauchy shear stress.\n\nThe problem requires a small-$\\gamma$ expansion up to and including terms of order $O(\\gamma^{3})$. We perform a Taylor series expansion of $\\exp(b\\gamma^{2})$ around $\\gamma=0$:\n$$\n\\exp(x) = 1 + x + \\frac{x^{2}}{2!} + O(x^{3})\n$$\nLetting $x = b\\gamma^{2}$, the expansion becomes:\n$$\n\\exp(b\\gamma^{2}) = 1 + b\\gamma^{2} + \\frac{(b\\gamma^{2})^{2}}{2} + \\dots = 1 + b\\gamma^{2} + O(\\gamma^{4})\n$$\nSubstituting this series into the expression for $\\sigma_{12}(\\gamma)$:\n$$\n\\sigma_{12}(\\gamma) = c\\gamma \\left( 1 + b\\gamma^{2} + O(\\gamma^{4}) \\right) = c\\gamma + cb\\gamma^{3} + O(\\gamma^{5})\n$$\nThe expansion up to and including terms of order $O(\\gamma^{3})$ is therefore $c\\gamma + cb\\gamma^{3}$.\n\nIn this expansion, the term $c\\gamma$ represents the linear elastic response, where $c$ is the small-strain shear modulus. The term $cb\\gamma^{3}$ is the first nonlinear correction to the shear stress. Since both $c$ and $b$ are positive constants, this cubic term indicates a strain-stiffening response, which is characteristic of many biological soft tissues.\n\nThe final result is the truncated expression for $\\sigma_{12}(\\gamma)$.", "answer": "$$\n\\boxed{c\\gamma + cb\\gamma^{3}}\n$$", "id": "2619287"}, {"introduction": "A central task in biomechanics is to determine the parameters of a constitutive model from experimental data. This practical exercise guides you through the foundational steps of this process by fitting a Fung-type hyperelastic model to synthetic uniaxial tension measurements. You will derive the theoretical stress-stretch relationship and the Jacobian matrix required for a Gauss-Newton optimization algorithm, bridging the gap between constitutive theory and its application in material characterization. [@problem_id:2619321]", "problem": "Consider an incompressible, isotropic soft tissue modeled as a hyperelastic material with Fung-type strain-energy density depending on the isochoric first invariant. Let the strain-energy density be given by\n$$\nW(\\mathbf{F};c,k) = \\frac{c}{2k}\\left[\\exp\\!\\left(k\\left(\\bar{I}_1 - 3\\right)\\right) - 1\\right],\n$$\nwhere $c$ has units of kilopascals (kPa), $k$ is dimensionless, $\\mathbf{F}$ is the deformation gradient, $\\bar{I}_1$ is the isochoric first invariant, and incompressibility is enforced by $\\det\\mathbf{F} = 1$. Under uniaxial extension by stretch $\\lambda$ in the $x_1$-direction with traction-free lateral directions, the Cauchy stress $\\sigma_{11}(\\lambda;c,k)$ is determined from standard hyperelasticity and the incompressibility constraint.\n\nYou are given measured uniaxial stress–stretch data $\\{(\\lambda_i,\\sigma_{11}^{\\text{exp}}(\\lambda_i))\\}_{i=1}^N$. You must set up the nonlinear least-squares problem to estimate the parameters $(c,k)$ by minimizing the sum of squared residuals. Define the residuals $r_i(c,k) = \\sigma_{11}(\\lambda_i;c,k) - \\sigma_{11}^{\\text{exp}}(\\lambda_i)$ and the objective \n$$\n\\Phi(c,k) = \\frac{1}{2}\\sum_{i=1}^N r_i(c,k)^2.\n$$\nDerive, from first principles of incompressible isotropic hyperelasticity, the uniaxial Cauchy stress–stretch relation $\\sigma_{11}(\\lambda;c,k)$ implied by $W(\\mathbf{F};c,k)$ and the traction-free lateral boundary conditions. Then, write the analytic Jacobian of the residual vector with respect to the parameter vector $(c,k)$, that is, compute $\\partial r_i/\\partial c$ and $\\partial r_i/\\partial k$ for each data point.\n\nYour program must:\n- Implement the derived uniaxial Cauchy stress–stretch relation $\\sigma_{11}(\\lambda;c,k)$.\n- Construct the residual vector $\\mathbf{r}(c,k)$ and the Jacobian matrix $\\mathbf{J}(c,k)$ whose $i$-th row contains $\\left[\\partial r_i/\\partial c,\\ \\partial r_i/\\partial k\\right]$.\n- For each test case below, evaluate $\\mathbf{r}$ and $\\mathbf{J}$ at a provided initial guess $(c_0,k_0)$, perform one Gauss–Newton update\n$$\n\\Delta\\boldsymbol{\\theta} = \\arg\\min_{\\Delta\\boldsymbol{\\theta}} \\left\\|\\mathbf{J}(c_0,k_0)\\,\\Delta\\boldsymbol{\\theta} + \\mathbf{r}(c_0,k_0)\\right\\|_2,\\quad \\boldsymbol{\\theta}=\\begin{bmatrix}c\\\\k\\end{bmatrix},\n$$\nand report the updated parameters $\\boldsymbol{\\theta}_{\\text{new}} = \\boldsymbol{\\theta}_0 + \\Delta\\boldsymbol{\\theta}$.\n\nPhysical and numerical units:\n- Report $c$ in kilopascals (kPa) and $k$ as dimensionless.\n- Stretches $\\lambda$ are dimensionless.\n- Express all final numerical outputs rounded to $6$ decimal places.\n\nAngle units are not involved. No percentages are involved.\n\nTest suite. Use the following three test cases. For each case, the synthetic measured stresses $\\sigma_{11}^{\\text{exp}}(\\lambda_i)$ are generated from the same derived $\\sigma_{11}(\\lambda;c,k)$ using the provided ground-truth parameters $(c^{\\ast},k^{\\ast})$:\n- Case $1$ (happy path):\n  - Stretches: $\\lambda = [1.05,\\,1.10,\\,1.20,\\,1.30]$.\n  - Ground-truth parameters: $(c^{\\ast},k^{\\ast}) = (10.0,\\,2.0)$.\n  - Initial guess: $(c_0,k_0) = (9.0,\\,1.0)$.\n- Case $2$ (near-incompressible small extension regime):\n  - Stretches: $\\lambda = [1.00,\\,1.02,\\,1.04,\\,1.06]$.\n  - Ground-truth parameters: $(c^{\\ast},k^{\\ast}) = (8.0,\\,1.0)$.\n  - Initial guess: $(c_0,k_0) = (5.0,\\,0.5)$.\n- Case $3$ (more nonlinear high extension regime):\n  - Stretches: $\\lambda = [1.15,\\,1.30,\\,1.45,\\,1.60]$.\n  - Ground-truth parameters: $(c^{\\ast},k^{\\ast}) = (15.0,\\,2.5)$.\n  - Initial guess: $(c_0,k_0) = (12.0,\\,2.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[c_{\\text{new}}^{(1)},k_{\\text{new}}^{(1)},c_{\\text{new}}^{(2)},k_{\\text{new}}^{(2)},c_{\\text{new}}^{(3)},k_{\\text{new}}^{(3)}]$, where the superscripts $(1)$, $(2)$, and $(3)$ correspond to Cases $1$, $2$, and $3$, respectively.\n- Each number must be rounded to $6$ decimal places and reported as a decimal float in the specified units. For example, an admissible output format is $[9.123456,1.234567,\\,\\ldots]$.", "solution": "The problem is valid. It is a well-posed problem in continuum mechanics and numerical optimization, grounded in the established theory of hyperelasticity for soft tissues. All necessary information is provided, and the task is to derive and implement a standard numerical method.\n\nThe solution proceeds in two stages. First, we derive the necessary analytical expressions from first principles. Second, we implement these expressions to perform the numerical computation as required.\n\n**1. Derivation of the Uniaxial Cauchy Stress**\n\nThe material is assumed to be incompressible and isotropic, with a strain-energy density function $W$ given by:\n$$ W(\\mathbf{F};c,k) = \\frac{c}{2k}\\left[\\exp\\!\\left(k\\left(\\bar{I}_1 - 3\\right)\\right) - 1\\right] $$\nwhere $c$ and $k$ are material parameters, and $\\bar{I}_1$ is the first invariant of the isochoric part of the left Cauchy-Green deformation tensor. For an incompressible material, the deformation gradient $\\mathbf{F}$ satisfies $\\det\\mathbf{F} = 1$. This implies that the volumetric part of the deformation is unity, and the deformation is purely isochoric. Consequently, $\\mathbf{F} = \\bar{\\mathbf{F}}$, the left Cauchy-Green tensor $\\mathbf{B} = \\mathbf{F}\\mathbf{F}^T$ is identical to its isochoric part $\\bar{\\mathbf{B}}$, and the first invariant $I_1 = \\text{tr}(\\mathbf{B})$ is identical to the first isochoric invariant $\\bar{I}_1 = \\text{tr}(\\bar{\\mathbf{B}})$.\n\nThe strain-energy function can thus be written as a function of $I_1$:\n$$ W(I_1;c,k) = \\frac{c}{2k}\\left[\\exp\\!\\left(k\\left(I_1 - 3\\right)\\right) - 1\\right] $$\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ for an incompressible isotropic hyperelastic material is given by:\n$$ \\boldsymbol{\\sigma} = -p\\mathbf{I} + 2 \\frac{\\partial W}{\\partial I_1}\\mathbf{B} $$\nwhere $p$ is the hydrostatic pressure, a Lagrange multiplier ensuring incompressibility, and $\\mathbf{I}$ is the identity tensor. The derivative of $W$ with respect to $I_1$ is:\n$$ \\frac{\\partial W}{\\partial I_1} = \\frac{c}{2k} \\frac{\\partial}{\\partial I_1} \\left( \\exp(k(I_1-3)) - 1 \\right) = \\frac{c}{2k} \\left( k \\exp(k(I_1-3)) \\right) = \\frac{c}{2} \\exp(k(I_1-3)) $$\nSubstituting this into the stress equation yields:\n$$ \\boldsymbol{\\sigma} = -p\\mathbf{I} + c \\exp(k(I_1-3))\\mathbf{B} $$\nFor a state of uniaxial extension with stretch $\\lambda$ in the $x_1$-direction, the deformation gradient tensor $\\mathbf{F}$ and the left Cauchy-Green tensor $\\mathbf{B}$ are:\n$$ \\mathbf{F} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  \\lambda^{-1/2}  0 \\\\ 0  0  \\lambda^{-1/2} \\end{pmatrix}, \\quad \\mathbf{B} = \\mathbf{F}\\mathbf{F}^T = \\begin{pmatrix} \\lambda^2  0  0 \\\\ 0  \\lambda^{-1}  0 \\\\ 0  0  \\lambda^{-1} \\end{pmatrix} $$\nThe first invariant of $\\mathbf{B}$ is $I_1 = \\text{tr}(\\mathbf{B}) = \\lambda^2 + 2\\lambda^{-1}$.\nThe components of the Cauchy stress tensor are:\n$$ \\sigma_{11} = -p + c \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) \\lambda^2 $$\n$$ \\sigma_{22} = \\sigma_{33} = -p + c \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) \\lambda^{-1} $$\nThe problem specifies traction-free lateral directions, which imposes the boundary conditions $\\sigma_{22} = \\sigma_{33} = 0$. Using this condition, we solve for the pressure $p$:\n$$ 0 = -p + c \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) \\lambda^{-1} \\implies p = c \\lambda^{-1} \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) $$\nSubstituting this expression for $p$ into the equation for $\\sigma_{11}$:\n$$ \\sigma_{11} = -c \\lambda^{-1} \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) + c \\lambda^2 \\exp(k(\\lambda^2 + 2\\lambda^{-1} - 3)) $$\nFactoring out common terms gives the final expression for the uniaxial Cauchy stress:\n$$ \\sigma_{11}(\\lambda;c,k) = c (\\lambda^2 - \\lambda^{-1}) \\exp\\left(k(\\lambda^2 + 2\\lambda^{-1} - 3)\\right) $$\n\n**2. Derivation of the Jacobian of the Residuals**\n\nThe nonlinear least-squares problem aims to find parameters $(c,k)$ that minimize the sum of squared residuals. The residual for the $i$-th data point $(\\lambda_i, \\sigma_{11,i}^{\\text{exp}})$ is:\n$$ r_i(c,k) = \\sigma_{11}(\\lambda_i;c,k) - \\sigma_{11,i}^{\\text{exp}} $$\nThe Jacobian matrix $\\mathbf{J}$ of the residual vector $\\mathbf{r}$ with respect to the parameter vector $\\boldsymbol{\\theta} = [c, k]^T$ has elements $J_{ij} = \\partial r_i / \\partial \\theta_j$. The $i$-th row of $\\mathbf{J}$ is $[\\partial r_i/\\partial c, \\partial r_i/\\partial k]$.\n\nThe partial derivative with respect to $c$ is:\n$$ \\frac{\\partial r_i}{\\partial c} = \\frac{\\partial}{\\partial c} \\left[ c (\\lambda_i^2 - \\lambda_i^{-1}) \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) - \\sigma_{11,i}^{\\text{exp}} \\right] $$\n$$ \\frac{\\partial r_i}{\\partial c} = (\\lambda_i^2 - \\lambda_i^{-1}) \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) $$\nThis can also be written as $\\partial r_i/\\partial c = \\sigma_{11}(\\lambda_i;c,k)/c$.\n\nThe partial derivative with respect to $k$ is:\n$$ \\frac{\\partial r_i}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ c (\\lambda_i^2 - \\lambda_i^{-1}) \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) - \\sigma_{11,i}^{\\text{exp}} \\right] $$\nUsing the chain rule for the exponential function:\n$$ \\frac{\\partial r_i}{\\partial k} = c (\\lambda_i^2 - \\lambda_i^{-1}) \\left[ \\exp\\left(k(\\lambda_i^2 + 2\\lambda_i^{-1} - 3)\\right) \\cdot (\\lambda_i^2 + 2\\lambda_i^{-1} - 3) \\right] $$\nThis simplifies to $\\partial r_i/\\partial k = \\sigma_{11}(\\lambda_i;c,k) \\cdot (\\lambda_i^2 + 2\\lambda_i^{-1} - 3)$.\n\n**3. Gauss-Newton Update Step**\n\nThe Gauss-Newton algorithm approximates the objective function locally with a linear model. At each iteration, we solve for a parameter update $\\Delta\\boldsymbol{\\theta}$ that minimizes the linearized sum of squares:\n$$ \\Delta\\boldsymbol{\\theta} = \\arg\\min_{\\Delta\\boldsymbol{\\theta}} \\left\\| \\mathbf{J}(\\boldsymbol{\\theta}_0) \\Delta\\boldsymbol{\\theta} + \\mathbf{r}(\\boldsymbol{\\theta}_0) \\right\\|_2^2 $$\nThis is a standard linear least-squares problem, which can be solved for $\\Delta\\boldsymbol{\\theta}$. The parameter vector is then updated as $\\boldsymbol{\\theta}_{\\text{new}} = \\boldsymbol{\\theta}_0 + \\Delta\\boldsymbol{\\theta}$. The provided program implements one step of this procedure for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the parameter estimation problem for a Fung-type hyperelastic model\n    by performing one Gauss-Newton update for three test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"stretches\": np.array([1.05, 1.10, 1.20, 1.30]),\n            \"gt_params\": (10.0, 2.0),\n            \"initial_guess\": (9.0, 1.0)\n        },\n        {\n            \"stretches\": np.array([1.00, 1.02, 1.04, 1.06]),\n            \"gt_params\": (8.0, 1.0),\n            \"initial_guess\": (5.0, 0.5)\n        },\n        {\n            \"stretches\": np.array([1.15, 1.30, 1.45, 1.60]),\n            \"gt_params\": (15.0, 2.5),\n            \"initial_guess\": (12.0, 2.0)\n        }\n    ]\n\n    all_results = []\n\n    def sigma_11_uniaxial(lmbda, c, k):\n        \"\"\"\n        Calculates the uniaxial Cauchy stress sigma_11 for a Fung-type material.\n        \n        Args:\n            lmbda (np.ndarray): Array of stretches.\n            c (float): Material parameter c [kPa].\n            k (float): Material parameter k [dimensionless].\n        \n        Returns:\n            np.ndarray: Array of corresponding stresses [kPa].\n        \"\"\"\n        # To avoid division by zero or warnings for lmbda=0, although not in test cases.\n        lmbda = np.asarray(lmbda)\n        # For lambda=1, the term (lmbda**2 - 1/lmbda) is zero, so stress is correctly zero.\n        # This prevents potential numerical issues with the exponential term.\n        # Use np.where to handle the lmbda=1 case robustly to avoid 0*inf if k is large.\n        \n        # This check is not strictly necessary with test data but is good practice.\n        # The expression is numerically stable for lambda  0.\n        is_one = np.isclose(lmbda, 1.0)\n        \n        # Calculate I1, the first invariant\n        I1 = lmbda**2 + 2.0 / lmbda\n        \n        # Calculate stress\n        stress = c * (lmbda**2 - 1.0 / lmbda) * np.exp(k * (I1 - 3.0))\n\n        # Ensure stress is exactly zero at lambda=1\n        stress[is_one] = 0.0\n        \n        return stress\n\n    for case in test_cases:\n        lmbda_data = case[\"stretches\"]\n        c_star, k_star = case[\"gt_params\"]\n        c0, k0 = case[\"initial_guess\"]\n\n        # 1. Generate synthetic experimental data using ground-truth parameters\n        sigma_exp = sigma_11_uniaxial(lmbda_data, c_star, k_star)\n\n        # 2. Evaluate model and residuals at the initial guess (c0, k0)\n        sigma_model_at_theta0 = sigma_11_uniaxial(lmbda_data, c0, k0)\n        residuals = sigma_model_at_theta0 - sigma_exp\n\n        # 3. Construct the Jacobian matrix J at the initial guess (c0, k0)\n        # J has shape (N, 2), where N is the number of data points.\n        # Column 1: d(r_i)/d(c)\n        # Column 2: d(r_i)/d(k)\n        \n        I1_data = lmbda_data**2 + 2.0 / lmbda_data\n        \n        # Partial derivative with respect to c: d(r_i)/d(c) = sigma_i / c\n        # A more direct and robust way is to use the derived formula\n        J_col1 = (lmbda_data**2 - 1.0 / lmbda_data) * np.exp(k0 * (I1_data - 3.0))\n        # Ensure the jacobian entry is zero for lambda = 1\n        is_one_mask = np.isclose(lmbda_data, 1.0)\n        J_col1[is_one_mask] = 0.0\n\n        # Partial derivative with respect to k: d(r_i)/d(k) = sigma_i * (I1_i - 3)\n        J_col2 = sigma_model_at_theta0 * (I1_data - 3.0)\n\n        J = np.stack([J_col1, J_col2], axis=1)\n\n        # 4. Solve the linear least-squares problem for the Gauss-Newton step\n        # J * delta_theta = -residuals\n        delta_theta, _, _, _ = np.linalg.lstsq(J, -residuals, rcond=None)\n        \n        # 5. Update the parameters\n        theta0 = np.array([c0, k0])\n        theta_new = theta0 + delta_theta\n        \n        all_results.extend(theta_new)\n\n    # Format the final output string\n    output_str = \",\".join([f\"{val:.6f}\" for val in all_results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "2619321"}]}