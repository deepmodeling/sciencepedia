{"hands_on_practices": [{"introduction": "To begin our practical exploration, we will tackle the fundamental 'rate problem' at the heart of thermoplasticity theory. This exercise challenges you to derive the plastic multiplier rate from first principles, applying the crucial consistency condition for a material subjected to both mechanical and thermal loading [@problem_id:2702532]. Mastering this core calculation is essential for understanding how a material's internal state evolves instantaneously in response to external stimuli.", "problem": "A small-strain, isotropic, temperature-dependent von Mises (also known as J2) thermoplastic solid is loaded under a prescribed strain-rate path and a prescribed temperature-rate. The kinematics follow the additive decomposition of strain rate, and the elastic response is linear with thermal expansion. The plasticity model is associative, with an isotropic hardening variable equal to the accumulated plastic strain.\n\nAssume the following fundamental ingredients:\n- Additive rate decomposition: $\\dot{\\boldsymbol{\\varepsilon}} = \\dot{\\boldsymbol{\\varepsilon}}^{e} + \\dot{\\boldsymbol{\\varepsilon}}^{p} + \\dot{\\boldsymbol{\\varepsilon}}^{th}$, with $\\dot{\\boldsymbol{\\varepsilon}}^{th} = \\alpha\\,\\dot{T}\\,\\boldsymbol{I}$, where $\\alpha$ is the coefficient of linear thermal expansion and $\\boldsymbol{I}$ is the second-order identity tensor.\n- Linear isotropic elasticity: $\\dot{\\boldsymbol{\\sigma}} = \\mathsf{C} : \\left(\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^{p} - \\dot{\\boldsymbol{\\varepsilon}}^{th}\\right)$, with isotropic stiffness $\\mathsf{C}$ determined by Young’s modulus $E$ and Poisson’s ratio $\\nu$.\n- Von Mises yield function with temperature-dependent isotropic hardening: $f(\\boldsymbol{\\sigma},\\kappa,T) = \\sigma_{eq}(\\boldsymbol{\\sigma}) - \\sigma_{y}(\\kappa,T)$, where $\\sigma_{eq} = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$ with $\\boldsymbol{s}$ the deviatoric Cauchy stress, and $\\sigma_{y}(\\kappa,T) = \\left(\\sigma_{y0} + H\\,\\kappa\\right)\\left[1 - \\beta\\left(T - T_{0}\\right)\\right]$.\n- Associative flow: $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$, and accumulated plastic strain evolution $\\dot{\\kappa} = \\dot{\\lambda}$.\n- Plastic loading with consistency: $f = 0$ and $\\dot{f} = 0$.\n\nAt the current configuration, the state and material data are:\n- Elastic constants: $E = 210\\,\\mathrm{GPa}$, $\\nu = 0.3$; coefficient of thermal expansion: $\\alpha = 1.2\\times 10^{-5}\\,\\mathrm{K}^{-1}$.\n- Yield parameters: $\\sigma_{y0} = 300\\,\\mathrm{MPa}$, $H = 2.0\\,\\mathrm{GPa}$, $\\beta = 8.0\\times 10^{-4}\\,\\mathrm{K}^{-1}$, and reference temperature $T_{0} = 293\\,\\mathrm{K}$.\n- Current internal variable and temperature: $\\kappa = 0.02$, $T = 450\\,\\mathrm{K}$, with temperature rate $\\dot{T} = 1.5\\,\\mathrm{K/s}$.\n- Prescribed total strain-rate tensor (in a Cartesian basis) is diagonal, $\\dot{\\boldsymbol{\\varepsilon}} = \\mathrm{diag}\\!\\left(1.0\\times 10^{-4},\\,0,\\,0\\right)\\,\\mathrm{s}^{-1}$.\n- The current Cauchy stress is uniaxial tension in the $x$-direction, $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma,0,0)$, with magnitude chosen such that the von Mises equivalent stress equals the current temperature-dependent yield stress, i.e., $\\sigma_{eq} = \\sigma_{y}(\\kappa,T)$, so that the consistency condition is active.\n\nUsing only the principles and definitions stated above, derive from first principles and compute the plastic multiplier rate $\\dot{\\lambda}$ and the isotropic hardening rate $\\dot{\\kappa}$ implied by the consistency condition at this state. Express your final numeric answers in $\\mathrm{s}^{-1}$, and round to four significant figures. Report the pair $\\left(\\dot{\\lambda},\\dot{\\kappa}\\right)$ as a single row using the LaTeX $\\mathrm{pmatrix}$ convention in the final answer.", "solution": "The problem presented is a standard exercise in the theory of rate-independent thermoplasticity. It is well-posed, scientifically grounded, and contains all necessary information for a unique solution. Therefore, we proceed with the derivation.\n\nThe primary objective is to compute the plastic multiplier rate, $\\dot{\\lambda}$, and the isotropic hardening rate, $\\dot{\\kappa}$, at the given state. The foundation of this calculation is the Kuhn-Tucker-Karush loading/unloading conditions combined with the plastic consistency condition. Since plastic loading is specified to be active, we have $f=0$ and its rate form, the consistency condition, $\\dot{f}=0$.\n\nThe yield function is given as $f(\\boldsymbol{\\sigma},\\kappa,T) = \\sigma_{eq}(\\boldsymbol{\\sigma}) - \\sigma_{y}(\\kappa,T) = 0$.\nThe consistency condition is obtained by taking the total time derivative of the yield function:\n$$ \\dot{f} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} : \\dot{\\boldsymbol{\\sigma}} + \\frac{\\partial f}{\\partial \\kappa}\\dot{\\kappa} + \\frac{\\partial f}{\\partial T}\\dot{T} = 0 $$\n\nWe must evaluate each term in this equation.\n\nFirst, the partial derivatives of the yield function $f$ are determined:\nThe derivative with respect to the Cauchy stress tensor $\\boldsymbol{\\sigma}$ defines the direction of plastic flow, which we denote as $\\boldsymbol{N}$:\n$$ \\boldsymbol{N} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial \\sigma_{eq}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} \\left( \\sqrt{\\tfrac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}} \\right) = \\frac{3}{2 \\sigma_{eq}} \\boldsymbol{s} $$\nwhere $\\boldsymbol{s}$ is the deviatoric part of the Cauchy stress tensor $\\boldsymbol{\\sigma}$.\n\nThe derivative with respect to the isotropic hardening variable $\\kappa$ is:\n$$ \\frac{\\partial f}{\\partial \\kappa} = -\\frac{\\partial \\sigma_{y}}{\\partial \\kappa} = -\\frac{\\partial}{\\partial \\kappa} \\left[ \\left(\\sigma_{y0} + H\\,\\kappa\\right)\\left(1 - \\beta\\left(T - T_{0}\\right)\\right) \\right] = -H\\left[1 - \\beta\\left(T - T_{0}\\right)\\right] $$\n\nThe derivative with respect to the temperature $T$ is:\n$$ \\frac{\\partial f}{\\partial T} = -\\frac{\\partial \\sigma_{y}}{\\partial T} = -\\frac{\\partial}{\\partial T} \\left[ \\left(\\sigma_{y0} + H\\,\\kappa\\right)\\left(1 - \\beta\\left(T - T_{0}\\right)\\right) \\right] = - \\left(\\sigma_{y0} + H\\,\\kappa\\right)(-\\beta) = \\beta\\left(\\sigma_{y0} + H\\,\\kappa\\right) $$\n\nNext, we require an expression for the stress rate, $\\dot{\\boldsymbol{\\sigma}}$. This is given by the hypoelastic law:\n$$ \\dot{\\boldsymbol{\\sigma}} = \\mathsf{C} : \\dot{\\boldsymbol{\\varepsilon}}^{e} = \\mathsf{C} : \\left( \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^{p} - \\dot{\\boldsymbol{\\varepsilon}}^{th} \\right) $$\nSubstituting the expressions for the plastic strain rate, $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\boldsymbol{N}$, and the thermal strain rate, $\\dot{\\boldsymbol{\\varepsilon}}^{th} = \\alpha\\,\\dot{T}\\,\\boldsymbol{I}$, we have:\n$$ \\dot{\\boldsymbol{\\sigma}} = \\mathsf{C} : \\left( \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}\\boldsymbol{N} - \\alpha\\dot{T}\\boldsymbol{I} \\right) $$\n\nWe substitute this expression for $\\dot{\\boldsymbol{\\sigma}}$ into the consistency condition:\n$$ \\boldsymbol{N} : \\left[ \\mathsf{C} : \\left( \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}\\boldsymbol{N} - \\alpha\\dot{T}\\boldsymbol{I} \\right) \\right] + \\frac{\\partial f}{\\partial \\kappa}\\dot{\\kappa} + \\frac{\\partial f}{\\partial T}\\dot{T} = 0 $$\n\nThis equation can be expanded:\n$$ \\boldsymbol{N} : \\mathsf{C} : \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda} \\left( \\boldsymbol{N} : \\mathsf{C} : \\boldsymbol{N} \\right) - \\alpha\\dot{T} \\left( \\boldsymbol{N} : \\mathsf{C} : \\boldsymbol{I} \\right) + \\frac{\\partial f}{\\partial \\kappa}\\dot{\\kappa} + \\frac{\\partial f}{\\partial T}\\dot{T} = 0 $$\n\nFor isotropic elasticity, the stiffness tensor contracted with a second-order deviatoric tensor $\\boldsymbol{A}$ (i.e., $\\mathrm{tr}(\\boldsymbol{A})=0$) simplifies to $\\mathsf{C}:\\boldsymbol{A} = 2G\\boldsymbol{A}$, where $G$ is the shear modulus. Since $\\boldsymbol{N}$ is proportional to $\\boldsymbol{s}$, it is deviatoric. Thus, $\\mathsf{C}:\\boldsymbol{N} = 2G\\boldsymbol{N}$.\nFurthermore, the term $\\boldsymbol{N} : \\mathsf{C} : \\boldsymbol{I}$ simplifies to $3K_{bulk}(\\boldsymbol{N}:\\boldsymbol{I})$, where $K_{bulk}$ is the bulk modulus. As $\\boldsymbol{N}$ is deviatoric, its trace is zero, meaning $\\boldsymbol{N}:\\boldsymbol{I} = \\mathrm{tr}(\\boldsymbol{N}) = 0$. This eliminates the term associated with the coefficient of thermal expansion $\\alpha$ from the final equation for $\\dot{\\lambda}$.\n\nThe simplified consistency equation becomes:\n$$ (2G \\boldsymbol{N}) : \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda} \\left( (2G\\boldsymbol{N}) : \\boldsymbol{N} \\right) + \\frac{\\partial f}{\\partial \\kappa}\\dot{\\kappa} + \\frac{\\partial f}{\\partial T}\\dot{T} = 0 $$\nUsing the hardening law $\\dot{\\kappa} = \\dot{\\lambda}$ and rearranging to solve for $\\dot{\\lambda}$:\n$$ \\dot{\\lambda} \\left( 2G(\\boldsymbol{N}:\\boldsymbol{N}) - \\frac{\\partial f}{\\partial \\kappa} \\right) = 2G(\\boldsymbol{N}:\\dot{\\boldsymbol{\\varepsilon}}) + \\frac{\\partial f}{\\partial T}\\dot{T} $$\n$$ \\dot{\\lambda} = \\frac{2G(\\boldsymbol{N}:\\dot{\\boldsymbol{\\varepsilon}}) + (\\partial f / \\partial T)\\dot{T}}{2G(\\boldsymbol{N}:\\boldsymbol{N}) - (\\partial f / \\partial \\kappa)} $$\nSubstituting the expressions for the partial derivatives:\n$$ \\dot{\\lambda} = \\frac{2G(\\boldsymbol{N}:\\dot{\\boldsymbol{\\varepsilon}}) + \\beta(\\sigma_{y0} + H\\kappa)\\dot{T}}{2G(\\boldsymbol{N}:\\boldsymbol{N}) + H(1 - \\beta(T - T_{0}))} $$\n\nNow, we must compute the numerical values of the terms. All units will be in MPa, s, and K.\nElastic constants: $E = 210000\\,\\mathrm{MPa}$, $\\nu = 0.3$.\nShear modulus $G = \\frac{E}{2(1+\\nu)} = \\frac{210000}{2(1.3)} = \\frac{105000}{1.3}\\,\\mathrm{MPa}$.\n\nCurrent stress state: Uniaxial tension $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma, 0, 0)$.\nThe deviatoric stress is $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I} = \\mathrm{diag}(\\frac{2\\sigma}{3}, -\\frac{\\sigma}{3}, -\\frac{\\sigma}{3})$.\nThe von Mises equivalent stress is $\\sigma_{eq} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{\\frac{3}{2}\\left[\\left(\\frac{2\\sigma}{3}\\right)^2 + \\left(-\\frac{\\sigma}{3}\\right)^2 + \\left(-\\frac{\\sigma}{3}\\right)^2\\right]} = \\sqrt{\\frac{3}{2}\\frac{6\\sigma^2}{9}} = |\\sigma|$.\nSince the state is on the yield surface, $\\sigma = \\sigma_{eq} = \\sigma_y(\\kappa,T)$.\n\nCalculate the current yield stress:\n$\\sigma_{y0} = 300\\,\\mathrm{MPa}$, $H = 2000\\,\\mathrm{MPa}$, $\\kappa = 0.02$.\n$\\beta = 8.0 \\times 10^{-4}\\,\\mathrm{K}^{-1}$, $T = 450\\,\\mathrm{K}$, $T_0 = 293\\,\\mathrm{K}$.\n$\\sigma_{y0} + H\\kappa = 300 + 2000(0.02) = 340\\,\\mathrm{MPa}$.\n$T-T_0 = 450 - 293 = 157\\,\\mathrm{K}$.\n$1 - \\beta(T-T_0) = 1 - (8.0 \\times 10^{-4})(157) = 1 - 0.1256 = 0.8744$.\nThe current yield stress is $\\sigma_y = (340\\,\\mathrm{MPa})(0.8744) = 297.296\\,\\mathrm{MPa}$. So $\\sigma = 297.296\\,\\mathrm{MPa}$.\n\nCalculate the flow direction tensor $\\boldsymbol{N}$:\n$\\boldsymbol{N} = \\frac{3}{2\\sigma_{eq}}\\boldsymbol{s} = \\frac{3}{2\\sigma} \\left[ \\frac{2\\sigma}{3} \\mathrm{diag}(1, -1/2, -1/2) \\right] = \\mathrm{diag}(1, -1/2, -1/2)$.\n\nNow, assemble the terms for the $\\dot{\\lambda}$ expression:\nNumerator:\nThe prescribed strain rate is $\\dot{\\boldsymbol{\\varepsilon}} = \\mathrm{diag}(1.0\\times 10^{-4}, 0, 0)\\,\\mathrm{s}^{-1}$.\n$\\boldsymbol{N}:\\dot{\\boldsymbol{\\varepsilon}} = (1)(1.0\\times 10^{-4}) + (-1/2)(0) + (-1/2)(0) = 1.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$.\n$2G(\\boldsymbol{N}:\\dot{\\boldsymbol{\\varepsilon}}) = 2 \\left(\\frac{105000}{1.3}\\right) (1.0\\times 10^{-4}) = \\frac{21}{1.3}\\,\\mathrm{MPa/s}$.\nThe temperature rate is $\\dot{T} = 1.5\\,\\mathrm{K/s}$.\n$\\beta(\\sigma_{y0} + H\\kappa)\\dot{T} = (8.0\\times 10^{-4})(340)(1.5) = 0.408\\,\\mathrm{MPa/s}$.\nNumerator = $\\frac{21}{1.3} + 0.408 \\approx 16.153846 + 0.408 = 16.561846\\,\\mathrm{MPa/s}$.\n\nDenominator:\n$\\boldsymbol{N}:\\boldsymbol{N} = (1)^2 + (-1/2)^2 + (-1/2)^2 = 1 + 0.25 + 0.25 = 1.5$.\n$2G(\\boldsymbol{N}:\\boldsymbol{N}) = 2 \\left(\\frac{105000}{1.3}\\right) (1.5) = \\frac{315000}{1.3}\\,\\mathrm{MPa}$.\n$H(1 - \\beta(T-T_0)) = (2000)(0.8744) = 1748.8\\,\\mathrm{MPa}$.\nDenominator = $\\frac{315000}{1.3} + 1748.8 \\approx 242307.692 + 1748.8 = 244056.492\\,\\mathrm{MPa}$.\n\nFinally, calculate $\\dot{\\lambda}$:\n$$ \\dot{\\lambda} = \\frac{16.561846}{244056.492} \\approx 6.78601 \\times 10^{-5}\\,\\mathrm{s}^{-1} $$\nRounding to four significant figures, we get $\\dot{\\lambda} = 6.786 \\times 10^{-5}\\,\\mathrm{s}^{-1}$.\n\nFrom the hardening law, $\\dot{\\kappa} = \\dot{\\lambda}$. Therefore, $\\dot{\\kappa} = 6.786 \\times 10^{-5}\\,\\mathrm{s}^{-1}$.\n\nThe resulting pair is $\\left(\\dot{\\lambda}, \\dot{\\kappa}\\right) = \\left(6.786 \\times 10^{-5}\\,\\mathrm{s}^{-1}, 6.786 \\times 10^{-5}\\,\\mathrm{s}^{-1}\\right)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6.786 \\times 10^{-5} & 6.786 \\times 10^{-5}\n\\end{pmatrix}\n}\n$$", "id": "2702532"}, {"introduction": "Building on the instantaneous rate calculation, we now broaden our perspective to analyze an entire deformation process and develop crucial physical intuition. This practice involves comparing the characteristic timescales of mechanical loading and heat diffusion to derive a dimensionless index that predicts whether a process is nearly adiabatic or isothermal [@problem_id:2702488]. Understanding this balance is vital for analyzing real-world applications, from high-speed metal forming to the failure of structures under dynamic loads.", "problem": "A long, homogeneous cylindrical bar of radius $R$ made of a thermoplastic material is subjected to a spatially uniform uniaxial plastic deformation at a constant total strain rate $\\dot{\\varepsilon}$ from zero to a prescribed final plastic strain $\\varepsilon_{f}$. The material density is $\\rho$, the specific heat at constant configuration is $c$, and the thermal diffusivity is $\\alpha_{th}$. Assume that the plastic work rate per unit volume is converted into heat with a constant Taylor–Quinney factor $\\beta \\in (0,1]$. The plastic flow is described by a Hollomon-type relation $\\sigma = K \\varepsilon_{p}^{n}$ over the plastic strain range $0 \\le \\varepsilon_{p} \\le \\varepsilon_{f}$, where $K>0$ and $n>-1$ are material constants, $\\sigma$ is the axial Cauchy stress, and $\\varepsilon_{p}$ is the axial plastic strain. Thermal properties $\\rho$, $c$, and $\\alpha_{th}$ may be treated as constants over the temperature excursion of interest. The bar is sufficiently long that axial heat conduction may be neglected relative to radial conduction to the surface.\n\nStarting from the heat balance (first law of thermodynamics with Fourier heat conduction) and kinematics, derive:\n- A dimensionless adiabaticity index, defined as the ratio of the characteristic radial thermal diffusion time to the characteristic mechanical loading time, expressed in terms of $R$, $\\alpha_{th}$, $\\dot{\\varepsilon}$, and $\\varepsilon_{f}$.\n- The resulting adiabatic temperature rise $\\Delta T$ at the bar center at the end of loading, expressed in Kelvin, assuming negligible heat loss during deformation.\n\nState clearly any approximations you make in defining the characteristic times. Provide your final answer as a single row matrix containing, in order, the adiabaticity index and the adiabatic temperature rise, each as a closed-form symbolic expression in the given parameters. Do not introduce any additional parameters. No numerical values are required. Express the temperature rise in Kelvin. Do not include units in your final boxed answer.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens\n- Geometry: Long, homogeneous cylindrical bar of radius $R$.\n- Material: Thermoplastic.\n- Loading: Spatially uniform uniaxial plastic deformation at a constant total strain rate $\\dot{\\varepsilon}$.\n- Strain range: From an initial strain of $0$ to a final plastic strain $\\varepsilon_{f}$.\n- Material Properties:\n    - Density: $\\rho$\n    - Specific heat at constant configuration: $c$\n    - Thermal diffusivity: $\\alpha_{th}$\n    - Taylor–Quinney factor: $\\beta \\in (0,1]$\n    - Material constants for flow rule: $K>0$, $n>-1$.\n- Constitutive Relation: Plastic flow is described by a Hollomon-type relation $\\sigma = K \\varepsilon_{p}^{n}$ for $0 \\le \\varepsilon_{p} \\le \\varepsilon_{f}$, where $\\sigma$ is the axial Cauchy stress and $\\varepsilon_{p}$ is the axial plastic strain.\n- Assumptions:\n    - Thermal properties $\\rho$, $c$, and $\\alpha_{th}$ are constant.\n    - Axial heat conduction is negligible relative to radial conduction.\n- Required Outputs:\n    1. A dimensionless adiabaticity index, defined as the ratio of the characteristic radial thermal diffusion time to the characteristic mechanical loading time, expressed in terms of $R$, $\\alpha_{th}$, $\\dot{\\varepsilon}$, and $\\varepsilon_{f}$.\n    2. The adiabatic temperature rise $\\Delta T$ at the bar center, assuming negligible heat loss.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in the field of thermoplasticity, which is a sub-discipline of solid mechanics. It combines principles from continuum mechanics (kinematics, stress, strain), thermodynamics (first law, heat generation), and material science (constitutive modeling). The Hollomon law is a widely used empirical model for plastic flow, and the Taylor–Quinney factor is a standard concept for quantifying the conversion of plastic work to heat. The condition $n>-1$ ensures the plastic work integral is convergent. The assumptions of constant thermal properties and negligible axial heat conduction are standard idealizations for simplifying the analysis of such problems. The problem is well-posed, providing sufficient information to derive the requested quantities. The language is objective and unambiguous. No inconsistencies or contradictions are present.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A solution will be provided.\n\nThe solution proceeds by deriving the two requested quantities in order.\n\nDerivation of the Adiabaticity Index\n\nThe adiabaticity index, which we shall denote by $\\mathcal{A}$, is defined as the ratio of two characteristic time scales: the thermal diffusion time, $\\tau_{th}$, and the mechanical loading time, $\\tau_{mech}$.\n\n1.  Characteristic Radial Thermal Diffusion Time ($\\tau_{th}$):\n    Heat transfer via conduction is governed by the heat equation, which dimensionally relates time, length, and thermal diffusivity. For diffusion processes, the characteristic time $\\tau$ required for a property to diffuse over a characteristic length $L$ is given by the scaling law $\\tau \\sim L^2/\\alpha$, where $\\alpha$ is the relevant diffusivity. In this problem, heat diffuses radially from the center to the surface of the bar. The characteristic length scale for this process is the radius $R$. The relevant diffusivity is the thermal diffusivity $\\alpha_{th}$. Therefore, the characteristic radial thermal diffusion time is defined as:\n    $$ \\tau_{th} = \\frac{R^2}{\\alpha_{th}} $$\n\n2.  Characteristic Mechanical Loading Time ($\\tau_{mech}$):\n    The mechanical loading process consists of deforming the material at a constant total strain rate $\\dot{\\varepsilon}$ up to a final plastic strain of $\\varepsilon_{f}$. For problems involving large plastic strains, it is a standard and justifiable approximation to neglect the elastic portion of the strain. Thus, we assume the total strain is approximately equal to the plastic strain, $\\varepsilon \\approx \\varepsilon_{p}$, and consequently, the total strain rate is approximately equal to the plastic strain rate, $\\dot{\\varepsilon} \\approx \\dot{\\varepsilon}_{p}$. Under this approximation, the time required to achieve the final plastic strain $\\varepsilon_{f}$ at a constant rate $\\dot{\\varepsilon}$ is:\n    $$ \\tau_{mech} = \\frac{\\varepsilon_{f}}{\\dot{\\varepsilon}} $$\n\n3.  Adiabaticity Index ($\\mathcal{A}$):\n    The dimensionless adiabaticity index is the ratio of these two time scales:\n    $$ \\mathcal{A} = \\frac{\\tau_{th}}{\\tau_{mech}} = \\frac{R^2 / \\alpha_{th}}{\\varepsilon_{f} / \\dot{\\varepsilon}} $$\n    Simplifying this expression yields the final form for the adiabaticity index:\n    $$ \\mathcal{A} = \\frac{R^2 \\dot{\\varepsilon}}{\\alpha_{th} \\varepsilon_{f}} $$\n    This index provides a measure of process adiabaticity. If $\\mathcal{A} \\gg 1$, the loading is fast compared to heat diffusion, and the process is nearly adiabatic. If $\\mathcal{A} \\ll 1$, the loading is slow, allowing heat to diffuse out, and the process is nearly isothermal.\n\nDerivation of the Adiabatic Temperature Rise\n\nThe adiabatic temperature rise $\\Delta T$ is calculated under the assumption of \"negligible heat loss\", which means the process is perfectly adiabatic. This corresponds to neglecting the heat conduction term in the first law of thermodynamics for the material volume.\n\n1.  First Law of Thermodynamics (Heat Balance):\n    For a material element undergoing deformation, with internal heat generation and constant thermal properties, the local heat balance equation (neglecting conduction) is:\n    $$ \\rho c \\frac{dT}{dt} = \\dot{q}_{int} $$\n    where $T$ is the temperature, $t$ is time, and $\\dot{q}_{int}$ is the rate of internal heat generation per unit volume.\n\n2.  Internal Heat Generation:\n    The problem states that a fraction $\\beta$ of the plastic work rate per unit volume, $\\dot{W}_{p}$, is converted into heat. The plastic work rate is given by $\\dot{W}_{p} = \\sigma \\dot{\\varepsilon}_{p}$. Therefore, the internal heat generation rate is:\n    $$ \\dot{q}_{int} = \\beta \\dot{W}_{p} = \\beta \\sigma \\dot{\\varepsilon}_{p} $$\n\n3.  Integration to Find Total Temperature Rise:\n    Substituting the expression for $\\dot{q}_{int}$ into the heat balance equation gives:\n    $$ \\rho c \\frac{dT}{dt} = \\beta \\sigma \\dot{\\varepsilon}_{p} $$\n    To find the total temperature rise $\\Delta T = T_{f} - T_{0}$ over the entire deformation process (from $t=0$ to $t=t_{f}$), we integrate this equation with respect to time:\n    $$ \\int_{T_{0}}^{T_{f}} \\rho c \\, dT = \\int_{0}^{t_{f}} \\beta \\sigma \\dot{\\varepsilon}_{p} \\, dt $$\n    Since $\\rho$ and $c$ are constant, the left side becomes $\\rho c \\Delta T$. For the right side, we change the variable of integration from time $t$ to plastic strain $\\varepsilon_{p}$. Given that $\\dot{\\varepsilon}_{p} = d\\varepsilon_{p}/dt$, we have $dt = d\\varepsilon_{p} / \\dot{\\varepsilon}_{p}$. The integration limits for plastic strain are from $0$ to $\\varepsilon_{f}$.\n    $$ \\rho c \\Delta T = \\int_{0}^{\\varepsilon_{f}} \\beta \\sigma(\\varepsilon_{p}) \\dot{\\varepsilon}_{p} \\left(\\frac{d\\varepsilon_{p}}{\\dot{\\varepsilon}_{p}}\\right) = \\beta \\int_{0}^{\\varepsilon_{f}} \\sigma(\\varepsilon_{p}) \\, d\\varepsilon_{p} $$\n    The integral on the right represents the total plastic work per unit volume, $W_{p}$.\n\n4.  Calculate Plastic Work and Solve for $\\Delta T$:\n    We substitute the given Hollomon relation, $\\sigma = K \\varepsilon_{p}^{n}$, into the work integral:\n    $$ W_{p} = \\int_{0}^{\\varepsilon_{f}} K \\varepsilon_{p}^{n} \\, d\\varepsilon_{p} = K \\left[ \\frac{\\varepsilon_{p}^{n+1}}{n+1} \\right]_{0}^{\\varepsilon_{f}} $$\n    Since $n > -1$, the term evaluates to zero at the lower limit $\\varepsilon_p=0$. The result is:\n    $$ W_{p} = \\frac{K \\varepsilon_{f}^{n+1}}{n+1} $$\n    Now, we substitute this result back into the integrated heat balance equation:\n    $$ \\rho c \\Delta T = \\beta W_{p} = \\frac{\\beta K \\varepsilon_{f}^{n+1}}{n+1} $$\n    Solving for the adiabatic temperature rise $\\Delta T$ yields:\n    $$ \\Delta T = \\frac{\\beta K \\varepsilon_{f}^{n+1}}{\\rho c (n+1)} $$\n    Under the adiabatic assumption for a spatially uniform deformation, the heat generation is uniform throughout the material. With no heat loss, the temperature rise is also uniform across the bar's cross-section. Thus, this expression gives the temperature rise at the center as well as everywhere else in the bar.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{R^{2} \\dot{\\varepsilon}}{\\alpha_{th} \\varepsilon_{f}} & \\frac{\\beta K \\varepsilon_{f}^{n+1}}{\\rho c (n+1)}\n\\end{pmatrix}\n}\n$$", "id": "2702488"}, {"introduction": "Finally, we bridge theory and practical simulation by modeling the fully coupled thermomechanical field problem. This capstone exercise guides you through the process of building a numerical solver for the transient heat equation, complete with a source term representing heat generation from plastic work [@problem_id:2702545]. By implementing and running this simulation, you will gain a concrete understanding of how localized plastic deformation generates thermal fields and how the resulting heat competes with conduction, a phenomenon central to understanding thermal softening and shear localization.", "problem": "Consider a straight, prismatic, one-dimensional bar of length $L$ with spatial coordinate $x \\in [0,L]$ and time $t \\ge 0$. The bar is initially at a uniform reference temperature (taken as the zero of temperature), so $T(x,0) = 0$ for all $x \\in [0,L]$. The bar undergoes spatially localized plastic flow that generates heat, while heat simultaneously conducts along the bar. The aim is to derive, discretize, and implement the evolution of the temperature field $T(x,t)$ and to quantify how competing conduction and plastic dissipation influence the solution.\n\nStart from the fundamental balance of energy for a continuum in one dimension and the constitutive law for heat conduction. Specifically, use:\n- Conservation of energy: the volumetric internal energy rate equals the divergence of heat flux plus mechanical dissipation, namely that the rate of change of internal energy per unit volume $\\rho c \\,\\partial T/\\partial t$ equals the divergence of conductive heat flux plus the rate of conversion of plastic work to heat.\n- Fourier’s law for conduction: the heat flux satisfies $q_{\\text{cond}}(x,t) = -k \\,\\partial T/\\partial x$.\n- A standard representation of plastic dissipation: take the heat source per unit volume generated by plastic flow to be $q_{\\text{pl}}(x,t) = \\beta\\,\\sigma\\,\\dot{\\varepsilon}^{p}(x,t)$, where $\\beta \\in [0,1]$ is the Taylor–Quinney coefficient (fraction of plastic work converted to heat), $\\sigma$ is the Cauchy stress, and $\\dot{\\varepsilon}^{p}$ is the plastic strain rate. Assume simple uniaxial plastic flow with stress equal to a constant yield level, $\\sigma = \\sigma_{y}$, so that $q_{\\text{pl}}(x,t)=\\beta\\,\\sigma_{y}\\,\\dot{\\varepsilon}^{p}(x,t)$.\n\nDefine the spatially localized plastic strain rate to be a Gaussian pulse centered at mid-span with a top-hat time dependence:\n$$\n\\dot{\\varepsilon}^{p}(x,t)=\\dot{\\varepsilon}_{0}\\,\\exp\\!\\left(-\\frac{(x-x_{c})^{2}}{2w^{2}}\\right)\\,H(t_{p}-t),\n$$\nwhere $x_{c}=L/2$, $w$ is the spatial half-width parameter, $\\dot{\\varepsilon}_{0}$ is the amplitude, $t_{p}$ is the pulse duration, and $H$ is the unit Heaviside step function. Assume all material parameters are constant in space and time.\n\nBoundary conditions may be either fixed temperature (Dirichlet) or insulated (zero heat flux, Neumann). Use the specified boundary conditions in each test case below. The ambient temperature is the zero reference, and any Dirichlet boundary values are $0$.\n\nTasks:\n1. Derive the strong form evolution equation for $T(x,t)$ strictly from the above fundamental statements without invoking any additional shortcut formulas. Clearly state the resulting partial differential equation, initial condition, and boundary conditions.\n2. Design a stable finite difference time-stepping algorithm to solve the derived equation on a uniform grid with $N$ nodes on $[0,L]$, using a second-order accurate finite difference approximation for spatial derivatives and a time-integration scheme that is at least first-order accurate and unconditionally stable for the conduction operator (for example, a Crank–Nicolson scheme for the conduction term with a midpoint-in-time evaluation of the source). The implementation must enforce the boundary conditions exactly at each time step.\n3. Implement the algorithm as a complete, runnable program that computes, for each test case, the maximum temperature over the domain at the final time. Express all final temperatures in kelvin (K), rounded to six decimal places.\n\nMaterial and numerical parameters common to all tests:\n- Density $\\rho = 7800~\\text{kg}/\\text{m}^{3}$.\n- Specific heat $c = 500~\\text{J}/(\\text{kg}\\cdot\\text{K})$.\n- Yield stress $\\sigma_{y} = 4.0\\times 10^{8}~\\text{Pa}$.\n- Bar length $L = 0.02~\\text{m}$.\n- Spatial grid: uniform with $N = 201$ nodes.\n- Time step $\\Delta t = 0.001~\\text{s}$.\n- Gaussian center $x_{c} = L/2$.\n- Initial temperature $T(x,0)=0~\\text{K}$.\n\nTest suite (each test is a tuple of parameters $(k,\\beta,\\dot{\\varepsilon}_{0},w,t_{p},t_{\\text{end}},\\text{BC}_{\\text{left}},\\text{BC}_{\\text{right}})$ with boundary condition type specified as either Dirichlet or Neumann and a value in kelvin):\n- Test A (diffusion-dominated with fixed ends): $k=200~\\text{W}/(\\text{m}\\cdot\\text{K})$, $\\beta=0.9$, $\\dot{\\varepsilon}_{0}=1.0~\\text{s}^{-1}$, $w=0.002~\\text{m}$, $t_{p}=0.2~\\text{s}$, $t_{\\text{end}}=0.5~\\text{s}$, left boundary $\\text{Dirichlet}(0~\\text{K})$, right boundary $\\text{Dirichlet}(0~\\text{K})$.\n- Test B (nearly adiabatic evolution): $k=1~\\text{W}/(\\text{m}\\cdot\\text{K})$, $\\beta=0.9$, $\\dot{\\varepsilon}_{0}=1.0~\\text{s}^{-1}$, $w=0.002~\\text{m}$, $t_{p}=0.2~\\text{s}$, $t_{\\text{end}}=0.2~\\text{s}$, left boundary $\\text{Neumann}(0)$, right boundary $\\text{Neumann}(0)$.\n- Test C (no plastic dissipation): $k=1~\\text{W}/(\\text{m}\\cdot\\text{K})$, $\\beta=0.0$, $\\dot{\\varepsilon}_{0}=1.0~\\text{s}^{-1}$, $w=0.002~\\text{m}$, $t_{p}=0.2~\\text{s}$, $t_{\\text{end}}=0.2~\\text{s}$, left boundary $\\text{Neumann}(0)$, right boundary $\\text{Neumann}(0)$.\n- Test D (short, intense pulse with fixed ends): $k=40~\\text{W}/(\\text{m}\\cdot\\text{K})$, $\\beta=0.9$, $\\dot{\\varepsilon}_{0}=10.0~\\text{s}^{-1}$, $w=0.002~\\text{m}$, $t_{p}=0.01~\\text{s}$, $t_{\\text{end}}=0.5~\\text{s}$, left boundary $\\text{Dirichlet}(0~\\text{K})$, right boundary $\\text{Dirichlet}(0~\\text{K})$.\n\nYour program must compute, for each test, the maximum temperature over $x \\in [0,L]$ at $t=t_{\\text{end}}$, expressed in kelvin. The final output format must be a single line containing a comma-separated list of the four results enclosed in square brackets, for example:\n\"[resultA,resultB,resultC,resultD]\"\nEach result must be rounded to six decimal places and expressed in kelvin.\n\nAngle units are not involved in this problem. No percentages are to be reported; all results are floats in kelvin as specified.", "solution": "The problem presented is a well-posed initial-boundary value problem in continuum thermomechanics. It is scientifically grounded, internally consistent, and contains all necessary information for a unique solution. It is therefore deemed valid. The solution will proceed in three parts as requested: derivation of the governing equation, design of the numerical algorithm, and implementation.\n\n### 1. Derivation of the Governing Partial Differential Equation (PDE)\n\nThe derivation begins from the local form of the first law of thermodynamics, representing the conservation of energy for a continuum. For a one-dimensional body with no mass transport, the rate of change of internal energy per unit volume, $\\dot{u}$, is balanced by the negative divergence of the heat flux vector, $-\\nabla \\cdot \\mathbf{q}$, and the rate of internal heat generation per unit volume, $S$. In one dimension, this is stated as:\n$$\n\\dot{u}(x,t) = -\\frac{\\partial q(x,t)}{\\partial x} + S(x,t)\n$$\nThe internal energy per unit volume for a material with constant density $\\rho$ and specific heat capacity $c$ is given by $u = \\rho c T$, where $T(x,t)$ is the temperature field relative to a reference state. The rate of change is thus:\n$$\n\\dot{u} = \\frac{\\partial}{\\partial t}(\\rho c T) = \\rho c \\frac{\\partial T}{\\partial t}\n$$\nThe problem specifies two contributions to the heat flux and source terms:\n1.  **Conductive heat flux**, $q_{\\text{cond}}$, is governed by Fourier's law. For a material with constant thermal conductivity $k$, this is:\n    $$\n    q_{\\text{cond}}(x,t) = -k \\frac{\\partial T}{\\partial x}\n    $$\n2.  **Internal heat generation**, $S$, arises from the dissipation of plastic work. This is given as $q_{\\text{pl}}$:\n    $$\n    S(x,t) = q_{\\text{pl}}(x,t) = \\beta \\sigma_y \\dot{\\varepsilon}^{p}(x,t)\n    $$\nSubstituting these constitutive relations into the energy balance equation yields:\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left(-k \\frac{\\partial T}{\\partial x}\\right) + \\beta \\sigma_y \\dot{\\varepsilon}^{p}(x,t)\n$$\nAs the thermal conductivity $k$ is constant, this simplifies to the final strong form of the governing PDE:\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} + \\beta \\sigma_y \\dot{\\varepsilon}^{p}(x,t)\n$$\nThis is the one-dimensional heat equation with a source term. We can define the thermal diffusivity $\\alpha = k/(\\rho c)$ and rewrite the equation as:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + \\frac{1}{\\rho c} S(x,t)\n$$\nwhere the source term $S(x,t)$ is explicitly defined as:\n$$\nS(x,t) = \\beta \\sigma_y \\dot{\\varepsilon}_{0}\\,\\exp\\!\\left(-\\frac{(x-x_{c})^{2}}{2w^{2}}\\right)\\,H(t_{p}-t)\n$$\nThe problem is fully specified by this PDE, along with the initial condition and boundary conditions.\n\n**Initial-Boundary Value Problem (IBVP):**\n- **PDE:** $\\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} + S(x,t)$ for $x \\in (0,L)$ and $t > 0$.\n- **Initial Condition (IC):** $T(x,0) = 0$ for all $x \\in [0,L]$.\n- **Boundary Conditions (BCs):** Two types are specified:\n    - **Dirichlet:** $T(0,t) = 0$ and $T(L,t) = 0$.\n    - **Neumann:** $\\frac{\\partial T}{\\partial x}(0,t) = 0$ and $\\frac{\\partial T}{\\partial x}(L,t) = 0$.\n\n### 2. Design of the Finite Difference Algorithm\n\nWe solve the PDE numerically using the method of lines, discretizing space first and then time.\n\n**Spatial Discretization:**\nThe spatial domain $[0,L]$ is discretized into a uniform grid of $N$ nodes, $x_i = i \\Delta x$ for $i=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L/(N-1)$. The temperature at node $x_i$ and time $t_n$ is denoted $T_i^n \\approx T(x_i, t_n)$. The second spatial derivative is approximated using a second-order accurate central difference stencil:\n$$\n\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_{x_i} \\approx \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2}\n$$\n\n**Temporal Discretization (Crank-Nicolson Scheme):**\nThe Crank-Nicolson method averages the spatial derivative between the current time step $n$ and the next time step $n+1$, leading to an unconditionally stable scheme for the diffusion operator. The time derivative is approximated by a forward difference. The source term is evaluated at the midpoint in time, $t_{n+1/2} = t_n + \\Delta t/2$, as specified.\n$$\n\\rho c \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{k}{2} \\left[ \\left(\\frac{T_{i+1}^{n+1} - 2T_i^{n+1} + T_{i-1}^{n+1}}{(\\Delta x)^2}\\right) + \\left(\\frac{T_{i+1}^{n} - 2T_i^{n} + T_{i-1}^{n}}{(\\Delta x)^2}\\right) \\right] + S_i^{n+1/2}\n$$\nLet $\\lambda = \\frac{k \\Delta t}{2 \\rho c (\\Delta x)^2}$. This dimensionless parameter controls the scheme. Rearranging the equation to separate unknown terms at step $n+1$ (left-hand side) from known terms at step $n$ (right-hand side):\n$$\n-\\lambda T_{i-1}^{n+1} + (1+2\\lambda)T_i^{n+1} - \\lambda T_{i+1}^{n+1} = \\lambda T_{i-1}^{n} + (1-2\\lambda)T_i^{n} + \\lambda T_{i+1}^{n} + \\frac{\\Delta t}{\\rho c} S_i^{n+1/2}\n$$\nThis equation holds for all interior nodes. This forms a system of linear equations $\\mathbf{A}\\mathbf{T}^{n+1} = \\mathbf{d}^n$, where $\\mathbf{T}^{n+1}$ is the vector of unknown temperatures at the next time step. The matrix $\\mathbf{A}$ and vector $\\mathbf{d}^n$ depend on the boundary conditions.\n\n**Boundary Condition Implementation:**\n\n- **Dirichlet Boundaries:** $T_0 = 0, T_{N-1} = 0$. The system is solved for the $N-2$ interior nodes, $i=1, \\dots, N-2$. The matrix $\\mathbf{A}$ is an $(N-2) \\times (N-2)$ tridiagonal matrix with $(1+2\\lambda)$ on the main diagonal and $-\\lambda$ on the sub- and super-diagonals. The boundary values $T_0^{n+1}=0$ and $T_{N-1}^{n+1}=0$ are enforced directly.\n\n- **Neumann Boundaries:** $\\partial T/\\partial x = 0$ at $x=0$ and $x=L$. These are implemented using ghost nodes. At the left boundary ($i=0$), a ghost node at $x_{-1}$ is introduced. The centered difference for the zero-flux condition gives $\\frac{T_1 - T_{-1}}{2\\Delta x} = 0$, which implies $T_{-1} = T_1$. Substituting $T_{-1}^{n+1}$ with $T_1^{n+1}$ and $T_{-1}^{n}$ with $T_1^{n}$ into the main discretized equation for $i=0$ yields:\n$$\n(1+2\\lambda)T_0^{n+1} - 2\\lambda T_1^{n+1} = (1-2\\lambda)T_0^{n} + 2\\lambda T_1^{n} + \\frac{\\Delta t}{\\rho c} S_0^{n+1/2}\n$$\nSimilarly, at the right boundary ($i=N-1$), the condition $T_{N} = T_{N-2}$ leads to:\n$$\n-2\\lambda T_{N-2}^{n+1} + (1+2\\lambda)T_{N-1}^{n+1} = 2\\lambda T_{N-2}^{n} + (1-2\\lambda)T_{N-1}^{n} + \\frac{\\Delta t}{\\rho c} S_{N-1}^{n+1/2}\n$$\nIn this case, the system is for all $N$ nodes. The matrix $\\mathbf{A}$ is an $N \\times N$ matrix. It is tridiagonal except for the terms `A[0,1]` and `A[N-1,N-2]`, which are $-2\\lambda$. This is still a banded matrix, and the system can be solved efficiently.\n\n### 3. Implementation\n\nThe numerical solution is implemented as a time-stepping loop. A runnable Python script that executes the logic described above is provided here.\n\n```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve_thermoplasticity_problem():\n    \"\"\"\n    Solves the 1D thermoplasticity problem for a set of test cases.\n    \"\"\"\n\n    # Common material and numerical parameters\n    rho = 7800.0   # kg/m^3\n    c = 500.0      # J/(kg.K)\n    sigma_y = 4.0e8 # Pa\n    L = 0.02       # m\n    N = 201        # nodes\n    dt = 0.001     # s\n    x_c = L / 2.0  # m\n\n    # Test suite: (k, beta, eps_dot_0, w, t_p, t_end, BC_left, BC_right)\n    test_cases = [\n        # Test A: Diffusion-dominated, fixed ends\n        (200.0, 0.9, 1.0, 0.002, 0.2, 0.5, 'Dirichlet', 'Dirichlet'),\n        # Test B: Nearly adiabatic, insulated ends\n        (1.0, 0.9, 1.0, 0.002, 0.2, 0.2, 'Neumann', 'Neumann'),\n        # Test C: No plastic dissipation, insulated ends\n        (1.0, 0.0, 1.0, 0.002, 0.2, 0.2, 'Neumann', 'Neumann'),\n        # Test D: Short, intense pulse, fixed ends\n        (40.0, 0.9, 10.0, 0.002, 0.01, 0.5, 'Dirichlet', 'Dirichlet'),\n    ]\n\n    results = []\n    for case in test_cases:\n        max_temp = run_simulation(case, rho, c, sigma_y, L, N, dt, x_c)\n        results.append(f\"{max_temp:.6f}\")\n\n    return f\"[{','.join(results)}]\"\n\ndef run_simulation(case_params, rho, c, sigma_y, L, N, dt, x_c):\n    \"\"\"\n    Runs a single simulation for one test case.\n    \"\"\"\n    k, beta, eps_dot_0, w, t_p, t_end, bc_left, bc_right = case_params\n\n    # Spatial grid\n    x = np.linspace(0, L, N)\n    dx = L / (N - 1)\n\n    # Initial temperature field\n    T = np.zeros(N)\n\n    # Time steps\n    time_steps = np.arange(0, t_end, dt)\n\n    # Crank-Nicolson parameter\n    lmda = (k * dt) / (2 * rho * c * dx**2)\n\n    # Pre-calculate spatial part of the source term\n    S_spatial = beta * sigma_y * eps_dot_0 * np.exp(-((x - x_c)**2) / (2 * w**2))\n\n    # --- Matrix Assembly ---\n    # The system to solve is A * T_new = d\n    if bc_left == 'Dirichlet' and bc_right == 'Dirichlet':\n        num_unknowns = N - 2\n        A_banded = np.zeros((3, num_unknowns))\n        A_banded[0, 1:] = -lmda\n        A_banded[1, :] = 1 + 2 * lmda\n        A_banded[2, :-1] = -lmda\n    elif bc_left == 'Neumann' and bc_right == 'Neumann':\n        num_unknowns = N\n        A_banded = np.zeros((3, num_unknowns))\n        A_banded[0, 1:] = -lmda\n        A_banded[1, :] = 1 + 2 * lmda\n        A_banded[2, :-1] = -lmda\n        A_banded[0, 1] = -2 * lmda\n        A_banded[2, -2] = -2 * lmda\n    else:\n        raise NotImplementedError(\"Mixed boundary conditions not implemented.\")\n\n    for t in time_steps:\n        # Determine source term for the current time step (midpoint evaluation)\n        if t + dt / 2  t_p:\n            S_term = (dt / (rho * c)) * S_spatial\n        else:\n            S_term = np.zeros(N)\n\n        # --- Construct RHS vector d ---\n        if bc_left == 'Dirichlet' and bc_right == 'Dirichlet':\n            T_interior = T[1:-1]\n            d = np.zeros(num_unknowns)\n            d[1:-1] = lmda * T_interior[:-2] + (1 - 2 * lmda) * T_interior[1:-1] + lmda * T_interior[2:]\n            d[0] = (1 - 2 * lmda) * T[1] + lmda * T[2]\n            d[-1] = lmda * T[-3] + (1 - 2 * lmda) * T[-2]\n            \n            d += S_term[1:-1]\n            \n            T_new_interior = solve_banded((1, 1), A_banded, d)\n            T[1:-1] = T_new_interior\n\n        elif bc_left == 'Neumann' and bc_right == 'Neumann':\n            d = np.zeros(num_unknowns)\n            d[1:-1] = lmda * T[:-2] + (1 - 2 * lmda) * T[1:-1] + lmda * T[2:]\n            d[0] = (1 - 2 * lmda) * T[0] + 2 * lmda * T[1]\n            d[-1] = 2 * lmda * T[-2] + (1 - 2 * lmda) * T[-1]\n            \n            d += S_term\n            \n            T = solve_banded((1, 1), A_banded, d)\n\n    return np.max(T)\n\n# The function call solve_thermoplasticity_problem() would produce the final answer string.\n```", "answer": "[7.279626,18.461538,0.000000,8.656846]", "id": "2702545"}]}