{"hands_on_practices": [{"introduction": "The complex modulus $E^*$ is the cornerstone of characterizing linear viscoelastic materials under dynamic loading. This first practice establishes the direct link between the raw data obtained from a Dynamic Mechanical Analysis (DMA) experiment—stress amplitude $\\sigma_0$, strain amplitude $\\varepsilon_0$, and phase angle $\\delta$—and the fundamental material properties: the storage modulus $E'$ and loss modulus $E''$. By working through this foundational exercise [@problem_id:2623222], you will gain proficiency in translating experimental measurements into the standard language of viscoelasticity.", "problem": "A homogeneous, isotropic, one-dimensional linear viscoelastic solid is subjected to a steady harmonic test in Dynamic Mechanical Analysis (DMA). At a fixed angular frequency, the measured stress and strain histories are sinusoidal with a constant phase difference: the stress amplitude is $\\sigma_{0}$, the strain amplitude is $\\varepsilon_{0}$, and the stress leads the strain by a phase angle $\\delta$. The material is assumed to be within the linear viscoelastic regime, and inertial effects are negligible so that one-dimensional constitutive relations apply.\n\nStarting only from the fundamental definition that, under steady harmonic loading, the stress and strain are sinusoidal with a constant phase difference and that the complex modulus encodes both the in-phase and out-of-phase responses associated with recoverable (elastic) and dissipative (viscous) processes, derive expressions for the storage modulus $E'$ and the loss modulus $E''$ in terms of $\\sigma_{0}$, $\\varepsilon_{0}$, and $\\delta$, as well as the magnitude $\\lvert E^{*} \\rvert$ of the complex modulus. Then, using the measured values $\\sigma_{0} = 100\\,\\text{kPa}$, $\\varepsilon_{0} = 0.01$, and $\\delta = 20^{\\circ}$ at the test frequency, compute $E'$, $E''$, and $\\lvert E^{*} \\rvert$.\n\nExpress all three final results in megapascals (MPa) and round each to four significant figures. Treat the given phase angle $\\delta$ in degrees; if you convert to radians for intermediate steps, ensure consistency in your trigonometric evaluations.", "solution": "The problem describes a one-dimensional, steady-state harmonic loading scenario. The time-dependent strain, $\\varepsilon(t)$, and stress, $\\sigma(t)$, are sinusoidal with the same angular frequency, $\\omega$. We can represent the strain as the reference signal:\n$$ \\varepsilon(t) = \\varepsilon_{0} \\sin(\\omega t) $$\nwhere $\\varepsilon_{0}$ is the strain amplitude. The problem states that the stress leads the strain by a phase angle $\\delta$. Therefore, the stress response is given by:\n$$ \\sigma(t) = \\sigma_{0} \\sin(\\omega t + \\delta) $$\nwhere $\\sigma_{0}$ is the stress amplitude.\n\nTo analyze the relationship between stress and strain, it is most convenient to use complex number representation. The time-dependent strain and stress can be written as the imaginary parts of complex functions, $\\varepsilon^{*}(t)$ and $\\sigma^{*}(t)$:\n$$ \\varepsilon(t) = \\Im\\{\\varepsilon^{*}(t)\\} = \\Im\\{\\varepsilon_{0} e^{i\\omega t}\\} $$\n$$ \\sigma(t) = \\Im\\{\\sigma^{*}(t)\\} = \\Im\\{\\sigma_{0} e^{i(\\omega t + \\delta)}\\} $$\nwhere $i = \\sqrt{-1}$.\n\nThe complex modulus, $E^{*}$, is defined for a linear viscoelastic material as the ratio of the complex stress to the complex strain under steady-state harmonic loading:\n$$ E^{*} = \\frac{\\sigma^{*}(t)}{\\varepsilon^{*}(t)} $$\nSubstituting the complex expressions for stress and strain, we have:\n$$ E^{*} = \\frac{\\sigma_{0} e^{i(\\omega t + \\delta)}}{\\varepsilon_{0} e^{i\\omega t}} = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\frac{e^{i\\omega t} e^{i\\delta}}{e^{iomega t}} = \\frac{\\sigma_{0}}{\\varepsilon_{0}} e^{i\\delta} $$\nUsing Euler's formula, $e^{i\\delta} = \\cos(\\delta) + i \\sin(\\delta)$, the complex modulus can be expressed in its Cartesian form:\n$$ E^{*} = \\frac{\\sigma_{0}}{\\varepsilon_{0}} (\\cos(\\delta) + i \\sin(\\delta)) $$\n\nBy definition, the complex modulus $E^{*}$ is also expressed in terms of the storage modulus, $E'$, and the loss modulus, $E''$, as:\n$$ E^{*} = E' + i E'' $$\nHere, $E'$ represents the in-phase (elastic) component of the response, corresponding to energy stored and recovered per cycle. $E''$ represents the out-of-phase (viscous) component, corresponding to energy dissipated as heat per cycle.\n\nBy equating the two expressions for $E^{*}$, we can identify the real and imaginary parts:\n$$ E' + i E'' = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\cos(\\delta) + i \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\sin(\\delta) $$\nEquating the real parts gives the expression for the storage modulus:\n$$ E' = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\cos(\\delta) $$\nEquating the imaginary parts gives the expression for the loss modulus:\n$$ E'' = \\frac{\\sigma_{0}}{\\varepsilon_{0}} \\sin(\\delta) $$\n\nThe magnitude of the complex modulus, $\\lvert E^{*} \\rvert$, can be derived directly from the polar form $E^{*} = (\\sigma_{0}/\\varepsilon_{0}) e^{i\\delta}$:\n$$ \\lvert E^{*} \\rvert = \\left| \\frac{\\sigma_{0}}{\\varepsilon_{0}} e^{i\\delta} \\right| = \\frac{\\sigma_{0}}{\\varepsilon_{0}} |e^{i\\delta}| = \\frac{\\sigma_{0}}{\\varepsilon_{0}} $$\nsince $|e^{i\\delta}| = \\sqrt{\\cos^2(\\delta) + \\sin^2(\\delta)} = 1$. This magnitude represents the overall stiffness of the material under the specific dynamic conditions.\n\nNow, we compute the numerical values using the given data:\n$\\sigma_{0} = 100\\,\\text{kPa}$\n$\\varepsilon_{0} = 0.01$\n$\\delta = 20^{\\circ}$\n\nFirst, we must ensure consistent units. The final results are required in megapascals (MPa).\n$$ \\sigma_{0} = 100\\,\\text{kPa} = 100 \\times 10^{3}\\,\\text{Pa} = 0.1 \\times 10^{6}\\,\\text{Pa} = 0.1\\,\\text{MPa} $$\nThe strain $\\varepsilon_{0}$ is a dimensionless quantity.\n\nWe calculate the magnitude of the complex modulus, $\\lvert E^{*} \\rvert$:\n$$ \\lvert E^{*} \\rvert = \\frac{\\sigma_{0}}{\\varepsilon_{0}} = \\frac{0.1\\,\\text{MPa}}{0.01} = 10\\,\\text{MPa} $$\nTo express this with four significant figures, we write it as $10.00\\,\\text{MPa}$.\n\nNext, we calculate the storage modulus, $E'$:\n$$ E' = \\lvert E^{*} \\rvert \\cos(\\delta) = (10\\,\\text{MPa}) \\cos(20^{\\circ}) $$\nUsing a calculator, $\\cos(20^{\\circ}) \\approx 0.9396926$.\n$$ E' \\approx 10 \\times 0.9396926\\,\\text{MPa} = 9.396926\\,\\text{MPa} $$\nRounding to four significant figures, $E' = 9.397\\,\\text{MPa}$.\n\nFinally, we calculate the loss modulus, $E''$:\n$$ E'' = \\lvert E^{*} \\rvert \\sin(\\delta) = (10\\,\\text{MPa}) \\sin(20^{\\circ}) $$\nUsing a calculator, $\\sin(20^{\\circ}) \\approx 0.3420201$.\n$$ E'' \\approx 10 \\times 0.3420201\\,\\text{MPa} = 3.420201\\,\\text{MPa} $$\nRounding to four significant figures, $E'' = 3.420\\,\\text{MPa}$. The trailing zero is significant and must be retained.\n\nThe requested values are $E'$, $E''$, and $\\lvert E^{*} \\rvert$ in MPa, rounded to four significant figures.", "answer": "$$ \\boxed{ \\begin{pmatrix} 9.397 & 3.420 & 10.00 \\end{pmatrix} } $$", "id": "2623222"}, {"introduction": "While the storage and loss moduli provide a convenient mathematical description of viscoelastic response, their true power lies in their physical interpretation. This exercise [@problem_id:2623311] guides you to connect $E'$ and $E''$ to the core energetic processes at play: recoverable energy storage and irreversible energy dissipation. By deriving the relationship between the moduli and the energy lost per cycle, you will develop a more profound, physical intuition for why materials exhibit viscoelastic behavior.", "problem": "A homogeneous, isotropic, linear viscoelastic solid is subjected to uniaxial sinusoidal strain of the form $\\varepsilon(t)=\\varepsilon_{0}\\sin(\\omega t)$ at a fixed angular frequency $\\omega$. The material’s complex Young’s modulus is $E^*=E'+iE''$, with storage modulus $E'$ and loss modulus $E''$ measured at this $\\omega$. The Cauchy stress under such loading may be taken as the linear response implied by $E^*$.\n\nStarting only from the definitions that (i) the mechanical work per unit volume done over one cycle is the closed integral $\\oint \\sigma\\,\\mathrm{d}\\varepsilon$ and (ii) the recoverable strain energy density associated with the in-phase (elastic) response at a given strain $\\varepsilon$ is $(1/2)E'\\varepsilon^{2}$, derive an expression for the fraction $f$ of the maximum recoverable strain energy that is dissipated as heat in one complete cycle. Then evaluate $f$ for a material with $E'=1\\,\\text{GPa}$ and $E''=0.1\\,\\text{GPa}$ at the given $\\omega$. \n\n- Express the final fraction as a pure number (no units), rounded to three significant figures.\n- Briefly justify whether $f$ depends on the strain amplitude $\\varepsilon_{0}$ under the stated assumptions.", "solution": "The relationship between the sinusoidal stress $\\sigma(t)$ and strain $\\varepsilon(t)$ in a linear viscoelastic material can be described using the complex Young's modulus, $E^* = E' + iE''$. In the frequency domain, this relationship is $\\tilde{\\sigma}(\\omega) = E^*(\\omega) \\tilde{\\varepsilon}(\\omega)$.\n\nThe applied strain is given as $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$. We can represent this using complex numbers as $\\varepsilon(t) = \\text{Im}[\\varepsilon_c(t)]$, where the complex strain is $\\varepsilon_c(t) = \\varepsilon_{0}\\exp(i\\omega t)$. The corresponding complex stress $\\sigma_c(t)$ is then:\n$$\n\\sigma_c(t) = E^* \\varepsilon_c(t) = (E' + iE'') \\varepsilon_{0}\\exp(i\\omega t)\n$$\nExpanding the exponential term using Euler's formula, $\\exp(i\\omega t) = \\cos(\\omega t) + i\\sin(\\omega t)$:\n$$\n\\sigma_c(t) = \\varepsilon_{0} [ (E'\\cos(\\omega t) - E''\\sin(\\omega t)) + i(E'\\sin(\\omega t) + E''\\cos(\\omega t)) ]\n$$\nThe real, physical stress $\\sigma(t)$ is the imaginary part of $\\sigma_c(t)$, corresponding to the imaginary part of the complex strain representation:\n$$\n\\sigma(t) = \\text{Im}[\\sigma_c(t)] = \\varepsilon_{0} (E'\\sin(\\omega t) + E''\\cos(\\omega t))\n$$\nThis expression shows that the stress response consists of a component in-phase with the strain, $\\varepsilon_{0}E'\\sin(\\omega t)$, and a component out-of-phase by $\\pi/2$ radians, $\\varepsilon_{0}E''\\cos(\\omega t)$.\n\nFirst, we calculate the energy dissipated per unit volume in one complete cycle, $W_d$. This is given by the integral of the stress-strain curve over one cycle, as stated in the problem definition (i):\n$$\nW_d = \\oint \\sigma\\,\\mathrm{d}\\varepsilon\n$$\nTo evaluate this integral, we convert it to an integral over time for one period, $T = 2\\pi/\\omega$. We need the differential of strain, $\\mathrm{d}\\varepsilon$:\n$$\n\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t) \\implies \\mathrm{d}\\varepsilon = \\frac{\\mathrm{d}\\varepsilon}{\\mathrm{d}t}\\mathrm{d}t = \\varepsilon_{0}\\omega\\cos(\\omega t)\\,\\mathrm{d}t\n$$\nNow, substitute the expressions for $\\sigma(t)$ and $\\mathrm{d}\\varepsilon$ into the integral:\n$$\nW_d = \\int_{0}^{T} \\sigma(t) \\frac{\\mathrm{d}\\varepsilon}{\\mathrm{d}t} \\mathrm{d}t = \\int_{0}^{2\\pi/\\omega} [\\varepsilon_{0}(E'\\sin(\\omega t) + E''\\cos(\\omega t))] [\\varepsilon_{0}\\omega\\cos(\\omega t)]\\,\\mathrm{d}t\n$$\n$$\nW_d = \\varepsilon_{0}^{2}\\omega \\int_{0}^{2\\pi/\\omega} (E'\\sin(\\omega t)\\cos(\\omega t) + E''\\cos^{2}(\\omega t))\\,\\mathrm{d}t\n$$\nWe evaluate the two integrals over one period separately.\nThe integral of the term associated with $E'$ is:\n$$\n\\int_{0}^{2\\pi/\\omega} \\sin(\\omega t)\\cos(\\omega t)\\,\\mathrm{d}t = \\int_{0}^{2\\pi/\\omega} \\frac{1}{2}\\sin(2\\omega t)\\,\\mathrm{d}t = \\left[-\\frac{1}{4\\omega}\\cos(2\\omega t)\\right]_{0}^{2\\pi/\\omega} = -\\frac{1}{4\\omega}(\\cos(4\\pi) - \\cos(0)) = 0\n$$\nThe integral of the term associated with $E''$ is:\n$$\n\\int_{0}^{2\\pi/\\omega} \\cos^{2}(\\omega t)\\,\\mathrm{d}t = \\int_{0}^{2\\pi/\\omega} \\frac{1}{2}(1 + \\cos(2\\omega t))\\,\\mathrm{d}t = \\left[\\frac{t}{2} + \\frac{1}{4\\omega}\\sin(2\\omega t)\\right]_{0}^{2\\pi/\\omega} = \\left(\\frac{2\\pi}{2\\omega} + 0\\right) - (0 + 0) = \\frac{\\pi}{\\omega}\n$$\nSubstituting these results back into the expression for $W_d$:\n$$\nW_d = \\varepsilon_{0}^{2}\\omega \\left(E'(0) + E''\\left(\\frac{\\pi}{\\omega}\\right)\\right) = \\pi E'' \\varepsilon_{0}^{2}\n$$\nThis is the energy dissipated as heat per unit volume in one loading cycle.\n\nNext, we determine the maximum recoverable strain energy, $U_{\\text{max}}$. The problem definition (ii) states that the recoverable strain energy density associated with the in-phase (elastic) response at strain $\\varepsilon$ is $U = \\frac{1}{2}E'\\varepsilon^{2}$. This energy is maximal when the strain magnitude is maximal. Since $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$, the maximum strain is $\\varepsilon_{\\text{max}} = \\varepsilon_{0}$.\nTherefore, the maximum recoverable strain energy density is:\n$$\nU_{\\text{max}} = \\frac{1}{2}E'(\\varepsilon_{\\text{max}})^{2} = \\frac{1}{2}E'\\varepsilon_{0}^{2}\n$$\n\nFinally, we find the fraction $f$ of the maximum recoverable strain energy that is dissipated in one cycle. This is the ratio of $W_d$ to $U_{\\text{max}}$:\n$$\nf = \\frac{W_d}{U_{\\text{max}}} = \\frac{\\pi E'' \\varepsilon_{0}^{2}}{\\frac{1}{2}E'\\varepsilon_{0}^{2}}\n$$\n$$\nf = 2\\pi \\frac{E''}{E'}\n$$\nThe ratio $E''/E'$ is the loss tangent, $\\tan(\\delta)$.\n\nAs seen from the derived expression, the strain amplitude $\\varepsilon_{0}$ cancels out. The fraction $f$ is independent of $\\varepsilon_{0}$. This is a characteristic feature of linear viscoelasticity, where both the dissipated energy per cycle ($W_d \\propto \\varepsilon_{0}^{2}$) and the maximum stored elastic energy ($U_{\\text{max}} \\propto \\varepsilon_{0}^{2}$) scale with the square of the strain amplitude, making their ratio independent of it.\n\nNow, we evaluate $f$ for the given values $E' = 1\\,\\text{GPa}$ and $E'' = 0.1\\,\\text{GPa}$.\n$$\nf = 2\\pi \\frac{0.1\\,\\text{GPa}}{1\\,\\text{GPa}} = 2\\pi(0.1) = 0.2\\pi\n$$\nUsing the value of $\\pi \\approx 3.14159...$:\n$$\nf \\approx 0.2 \\times 3.14159... = 0.628318...\n$$\nRounding to three significant figures, we get $f \\approx 0.628$.", "answer": "$$\n\\boxed{0.628}\n$$", "id": "2623311"}, {"introduction": "The entire framework of linear viscoelasticity, and the definitions of $E'$ and $E''$ themselves, hinge on the critical assumption of a linear material response. This computational practice [@problem_id:2623338] addresses the practical challenge of verifying this assumption and identifying the Linear Viscoelastic Range (LVR) for a material. You will implement an algorithm to analyze how nonlinearities manifest as higher harmonics in the stress response, a crucial skill for designing valid experiments and correctly interpreting DMA data.", "problem": "You are tasked with designing and implementing a quantitative algorithm to verify the linear viscoelastic response of a material measured by Dynamic Mechanical Analysis (DMA) under amplitude sweeps. The algorithm must be based on the following fundamental bases and observations:\n\n1. Under a prescribed sinusoidal strain input of the form $\\varepsilon(t)=\\varepsilon_{0}\\sin(\\omega t)$, a linear viscoelastic material produces a stress response at the same angular frequency $\\omega$ with a phase shift. In the frequency-domain description, this is captured by the complex modulus $E^*=E'+i E''$, where $E'$ (storage modulus) is the in-phase component and $E''$ (loss modulus) is the out-of-phase component relative to the input strain.\n\n2. When the response departs from linear viscoelasticity (e.g., because of amplitude-dependent stiffness or nonlinear constitutive terms), higher harmonics appear in the stress response at odd multiples of the excitation frequency (for example $3\\omega$, $5\\omega$), and the apparent moduli $E'$ and $E''$ become amplitude dependent.\n\nYour method must:\n- Generate strain-controlled DMA signals $\\varepsilon(t)=\\varepsilon_{0}\\sin(\\omega t)$ with frequency $f$ (in $\\mathrm{Hz}$) and angular frequency $\\omega=2\\pi f$ (in $\\mathrm{rad/s}$).\n- Generate stress signals $\\sigma(t)$ for a generalized viscoelastic response that includes a linear Kelvin–Voigt part and a cubic nonlinearity:\n  $$\\sigma(t)=E\\,\\varepsilon(t)+\\eta\\,\\dot{\\varepsilon}(t)+k_{3}\\,\\varepsilon(t)^{3},$$\n  where $E$ is the elastic modulus (in $\\mathrm{MPa}$), $\\eta$ is the viscosity (in $\\mathrm{MPa\\cdot s}$), and $k_{3}$ is the cubic stiffness coefficient (in $\\mathrm{MPa}$). The strain $\\varepsilon$ is dimensionless, and time $t$ is in $\\mathrm{s}$, with angles measured in radians.\n\n- Extract the fundamental (at $\\omega$) and higher harmonic components (at $3\\omega$ and $5\\omega$) of the stress response by orthogonal projection onto $\\sin(n\\omega t)$ and $\\cos(n\\omega t)$ for $n\\in\\{1,3,5\\}$ over an integer number of cycles. From the $n=1$ components, determine the storage and loss moduli via the in-phase (sine) and quadrature (cosine) projections normalized by $\\varepsilon_{0}$.\n\n- Quantify the Linear Viscoelastic Range (LVR) at a given frequency $f$ using two simultaneous criteria:\n  (a) Harmonic purity: For each tested $\\varepsilon_{0}$, the ratio $R_{3} = A_{3}/A_{1}$ and $R_{5} = A_{5}/A_{1}$ must satisfy $R_{3}\\le r_{\\max}$ and $R_{5}\\le r_{\\max}$, where $A_{n}$ is the amplitude of the $n$th harmonic of $\\sigma(t)$ obtained from the orthogonal projections.\n  (b) Amplitude-invariance of moduli: Let $E'_{\\mathrm{ref}}$ and $E''_{\\mathrm{ref}}$ denote the storage and loss moduli at the smallest tested amplitude $\\varepsilon_{0,\\min}$. For a tested $\\varepsilon_{0}$ to be acceptable, both relative deviations must satisfy\n  $$\\left|\\frac{E'(\\varepsilon_{0})-E'_{\\mathrm{ref}}}{E'_{\\mathrm{ref}}}\\right|\\le \\tau_{\\mathrm{mod}},\\quad \\left|\\frac{E''(\\varepsilon_{0})-E''_{\\mathrm{ref}}}{E''_{\\mathrm{ref}}}\\right|\\le \\tau_{\\mathrm{mod}}.$$\n\n- Define the acceptable strain amplitude range as the largest contiguous range starting from the minimum tested amplitude up to the largest amplitude for which both criteria (a) and (b) hold.\n\nImplementation details:\n- Use numerical signals sampled uniformly over an integer number of cycles to ensure orthogonality of projections. Use at least $N_{\\mathrm{ppc}}=1024$ samples per cycle and $N_{\\mathrm{cyc}}=8$ cycles, so the total number of samples is $N= N_{\\mathrm{ppc}}\\times N_{\\mathrm{cyc}}$. Use time in $\\mathrm{s}$ and angles in radians.\n- Extract harmonic coefficients by discrete-time orthogonal projection. For a signal $x(t)$, define the sine and cosine projections at angular frequency $\\Omega$ as:\n  $$C_{\\sin}(\\Omega)=\\frac{2}{T}\\int_{0}^{T} x(t)\\sin(\\Omega t)\\,dt,\\quad C_{\\cos}(\\Omega)=\\frac{2}{T}\\int_{0}^{T} x(t)\\cos(\\Omega t)\\,dt,$$\n  and in discrete time approximate these integrals by uniform-sampling Riemann sums. The amplitude at that harmonic is $A=\\sqrt{C_{\\sin}^{2}+C_{\\cos}^{2}}$. For $n=1$, define\n  $$E'=\\frac{C_{\\sin}(\\omega)}{\\varepsilon_{0}},\\quad E''=\\frac{C_{\\cos}(\\omega)}{\\varepsilon_{0}}.$$\n\n- Angle unit: radians. Frequency unit: $\\mathrm{Hz}$. Stress unit: $\\mathrm{MPa}$. Strain is dimensionless.\n\nYour program must apply this method to the following test suite. For each test case, use the same amplitude sweep\n$\\varepsilon_{0}\\in\\left\\{1.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-3},\\,1.0\\times 10^{-2}\\right\\}$ (dimensionless). Adopt $r_{\\max}=2.0\\times 10^{-2}$ and $\\tau_{\\mathrm{mod}}=1.0\\times 10^{-1}$.\n\nTest suite:\n- Case A (pure linear Kelvin–Voigt): $E=1.5\\,\\mathrm{MPa}$, $\\eta=0.8\\,\\mathrm{MPa\\cdot s}$, $k_{3}=0\\,\\mathrm{MPa}$, $f=1.0\\,\\mathrm{Hz}$.\n- Case B (weak cubic nonlinearity): $E=1.5\\,\\mathrm{MPa}$, $\\eta=0.8\\,\\mathrm{MPa\\cdot s}$, $k_{3}=4.2\\times 10^{3}\\,\\mathrm{MPa}$, $f=1.0\\,\\mathrm{Hz}$.\n- Case C (stronger cubic nonlinearity): $E=1.5\\,\\mathrm{MPa}$, $\\eta=0.8\\,\\mathrm{MPa\\cdot s}$, $k_{3}=2.0\\times 10^{4}\\,\\mathrm{MPa}$, $f=1.0\\,\\mathrm{Hz}$.\n\nFor each case, determine the maximum acceptable strain amplitude (dimensionless) in the sense defined above. If no amplitude satisfies both criteria, return $0.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC]\"), where each result is the maximum acceptable strain amplitude (dimensionless) for Cases A, B, and C, respectively. The numbers must be printed as plain decimal floats (dimensionless). No additional text should be printed.", "solution": "The core of the problem is to distinguish between linear and nonlinear viscoelastic responses. A material is considered linear viscoelastic if, under a sinusoidal strain input $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$, the resultant stress $\\sigma(t)$ is also sinusoidal at the same angular frequency $\\omega$, possibly with a phase shift $\\delta$. This behavior is described by the complex modulus $E^*(\\omega) = E'(\\omega) + iE''(\\omega)$, where the storage modulus $E'$ and loss modulus $E''$ are independent of the strain amplitude $\\varepsilon_{0}$. When the material response becomes nonlinear, which typically occurs at larger strain amplitudes, the stress signal becomes distorted. This distortion manifests as the appearance of higher-order harmonics (at frequencies $3\\omega$, $5\\omega$, etc.) in the stress spectrum and a dependency of the apparent moduli $E'$ and $E''$ on $\\varepsilon_{0}$.\n\nThe algorithm to be implemented follows these principles.\n\nFirst, we generate the necessary time-domain signals. A discrete time vector $t$ is created over an integer number of cycles $N_{\\mathrm{cyc}}=8$ with a sufficient number of samples per cycle $N_{\\mathrm{ppc}}=1024$ to prevent aliasing and ensure accurate integration. The total number of points is $N=N_{\\mathrm{ppc}} \\times N_{\\mathrm{cyc}}$, and the total duration is $T = N_{\\mathrm{cyc}} / f$, where $f=1.0\\,\\mathrm{Hz}$ is the test frequency. For each strain amplitude $\\varepsilon_0$ in the specified sweep, the strain signal $\\varepsilon(t) = \\varepsilon_{0}\\sin(\\omega t)$ and its time derivative $\\dot{\\varepsilon}(t) = \\varepsilon_{0}\\omega\\cos(\\omega t)$ are computed, with $\\omega=2\\pi f$. The corresponding stress signal $\\sigma(t)$ is then synthesized using the provided generalized Kelvin-Voigt model with a cubic nonlinearity:\n$$\n\\sigma(t) = E\\,\\varepsilon(t) + \\eta\\,\\dot{\\varepsilon}(t) + k_{3}\\,\\varepsilon(t)^{3}\n$$\nwhere the parameters $E$, $\\eta$, and $k_3$ are given for each test case.\n\nSecond, we analyze the harmonic content of the generated stress signal $\\sigma(t)$. This is achieved by orthogonal projection, which is numerically implemented as a discrete Fourier analysis. For each harmonic of interest, with angular frequency $\\Omega_n = n\\omega$ for $n \\in \\{1, 3, 5\\}$, we compute the sine and cosine projection coefficients:\n$$\nC_{\\sin}(n\\omega) = \\frac{2}{N} \\sum_{i=0}^{N-1} \\sigma(t_i) \\sin(n\\omega t_i)\n$$\n$$\nC_{\\cos}(n\\omega) = \\frac{2}{N} \\sum_{i=0}^{N-1} \\sigma(t_i) \\cos(n\\omega t_i)\n$$\nThese formulae are the discrete-time equivalents of the continuous-time integral definitions provided in the problem, arising from a Riemann sum approximation over $N$ uniform samples. The amplitude of the $n$-th harmonic is then $A_n = \\sqrt{C_{\\sin}(n\\omega)^2 + C_{\\cos}(n\\omega)^2}$.\n\nFrom the fundamental harmonic ($n=1$) projections, the apparent storage and loss moduli are determined as:\n$$\nE'(\\varepsilon_0) = \\frac{C_{\\sin}(\\omega)}{\\varepsilon_0}\n$$\n$$\nE''(\\varepsilon_0) = \\frac{C_{\\cos}(\\omega)}{\\varepsilon_0}\n$$\nThese calculations are performed for every strain amplitude $\\varepsilon_0$ in the sweep.\n\nThird, we apply the two criteria to define the LVR. For each amplitude $\\varepsilon_0$:\n1.  **Harmonic Purity Criterion**: The ratios of the amplitudes of the $3$rd and $5$th harmonics to the fundamental, $R_3 = A_3/A_1$ and $R_5 = A_5/A_1$, must not exceed a tolerance $r_{\\max} = 2.0 \\times 10^{-2}$.\n2.  **Modulus Invariance Criterion**: The relative deviations of the storage and loss moduli from their reference values, $E'_{\\mathrm{ref}}$ and $E''_{\\mathrm{ref}}$ (measured at the lowest strain amplitude $\\varepsilon_{0,\\min}$), must not exceed a tolerance $\\tau_{\\mathrm{mod}} = 1.0 \\times 10^{-1}$. The conditions are:\n    $$\n    \\left|\\frac{E'(\\varepsilon_{0}) - E'_{\\mathrm{ref}}}{E'_{\\mathrm{ref}}}\\right| \\le \\tau_{\\mathrm{mod}} \\quad \\text{and} \\quad \\left|\\frac{E''(\\varepsilon_{0}) - E''_{\\mathrm{ref}}}{E''_{\\mathrm{ref}}}\\right| \\le \\tau_{\\mathrm{mod}}\n    $$\n\nFinally, the LVR is determined as the largest contiguous range of strain amplitudes, starting from $\\varepsilon_{0,\\min}$, for which both criteria are simultaneously satisfied. The algorithm iterates through the amplitudes in ascending order. The maximum acceptable strain amplitude is the largest value in this contiguous range. If the conditions are not met even for the smallest amplitude, the result is $0.0$. This procedure is systematically applied to each test case to derive the required results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of determining the linear viscoelastic range (LVR)\n    for materials under dynamic loading based on specified criteria.\n    \"\"\"\n\n    def calculate_max_strain(params):\n        \"\"\"\n        Calculates the maximum acceptable strain amplitude for a single test case.\n\n        Args:\n            params (dict): A dictionary containing material and test parameters:\n                           E, eta, k3, f, amplitudes, r_max, tau_mod.\n\n        Returns:\n            float: The maximum acceptable strain amplitude.\n        \"\"\"\n        # Unpack parameters\n        E = params['E']\n        eta = params['eta']\n        k3 = params['k3']\n        f = params['f']\n        amplitudes = params['amplitudes']\n        r_max = params['r_max']\n        tau_mod = params['tau_mod']\n\n        # Simulation parameters\n        N_ppc = 1024\n        N_cyc = 8\n        N = N_ppc * N_cyc\n        \n        # Time and frequency setup\n        omega = 2.0 * np.pi * f\n        T = N_cyc / f\n        dt = T / N\n        t = np.arange(N) * dt\n\n        # Store results for each amplitude\n        results_per_amp = []\n\n        for eps0 in amplitudes:\n            # Generate signals\n            strain = eps0 * np.sin(omega * t)\n            strain_rate = eps0 * omega * np.cos(omega * t)\n            stress = E * strain + eta * strain_rate + k3 * (strain**3)\n\n            harmonic_data = {}\n            for n in [1, 3, 5]:\n                omega_n = n * omega\n                \n                # Orthogonal projection using discrete summation\n                sin_proj = (2.0 / N) * np.sum(stress * np.sin(omega_n * t))\n                cos_proj = (2.0 / N) * np.sum(stress * np.cos(omega_n * t))\n                \n                amplitude_n = np.sqrt(sin_proj**2 + cos_proj**2)\n                \n                harmonic_data[n] = {\n                    'sin_proj': sin_proj,\n                    'cos_proj': cos_proj,\n                    'amp': amplitude_n\n                }\n\n            # Calculate moduli from fundamental harmonic\n            E_prime = harmonic_data[1]['sin_proj'] / eps0\n            E_double_prime = harmonic_data[1]['cos_proj'] / eps0\n\n            results_per_amp.append({\n                'eps0': eps0,\n                'E_prime': E_prime,\n                'E_double_prime': E_double_prime,\n                'A1': harmonic_data[1]['amp'],\n                'A3': harmonic_data[3]['amp'],\n                'A5': harmonic_data[5]['amp']\n            })\n\n        # Apply LVR criteria\n        if not results_per_amp:\n            return 0.0\n\n        # Reference values from the smallest amplitude\n        ref_result = results_per_amp[0]\n        E_prime_ref = ref_result['E_prime']\n        E_double_prime_ref = ref_result['E_double_prime']\n        \n        # Handle potential zero reference values, though not expected here\n        if E_prime_ref == 0.0 or E_double_prime_ref == 0.0:\n            # This case implies a purely viscous or elastic material with zero E' or E''.\n            # The relative error check is ill-defined. Based on problem context, this won't happen.\n            # But for robustness, we can assume failure.\n            return 0.0\n\n        max_acceptable_amplitude = 0.0\n        \n        for res in results_per_amp:\n            # Check harmonic purity\n            A1 = res['A1']\n            if A1 == 0: # Avoid division by zero\n                harmonic_ok = False\n            else:\n                R3 = res['A3'] / A1\n                R5 = res['A5'] / A1\n                harmonic_ok = (R3 = r_max) and (R5 = r_max)\n\n            # Check modulus invariance\n            E_prime_dev = abs((res['E_prime'] - E_prime_ref) / E_prime_ref)\n            E_double_prime_dev = abs((res['E_double_prime'] - E_double_prime_ref) / E_double_prime_ref)\n            moduli_ok = (E_prime_dev = tau_mod) and (E_double_prime_dev = tau_mod)\n\n            # Check combined criteria for contiguous range\n            if harmonic_ok and moduli_ok:\n                max_acceptable_amplitude = res['eps0']\n            else:\n                # Break at the first amplitude that fails, as we need a contiguous range\n                break\n        \n        return max_acceptable_amplitude\n\n\n    # Shared parameters for all test cases\n    shared_params = {\n        'amplitudes': np.array([1.0e-4, 5.0e-4, 1.0e-3, 5.0e-3, 1.0e-2]),\n        'r_max': 2.0e-2,\n        'tau_mod': 1.0e-1,\n        'f': 1.0,\n    }\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {'E': 1.5, 'eta': 0.8, 'k3': 0.0},  # Case A\n        {'E': 1.5, 'eta': 0.8, 'k3': 4.2e3}, # Case B\n        {'E': 1.5, 'eta': 0.8, 'k3': 2.0e4}, # Case C\n    ]\n    \n    final_results = []\n    for case_params in test_cases:\n        full_params = {**shared_params, **case_params}\n        result = calculate_max_strain(full_params)\n        final_results.append(result)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "2623338"}]}