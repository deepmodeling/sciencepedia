{"hands_on_practices": [{"introduction": "The study of column stability begins with the idealized model of a perfectly straight, elastic column. Deriving the critical buckling load from first principles is a foundational skill, as it reveals the mathematical nature of stability as an eigenvalue problem. This practice [@problem_id:2885501] challenges you to analyze the classic case of a column with fixed ends, a configuration that offers significantly more resistance to buckling than pinned supports. By working through the derivation, you will solidify your understanding of how boundary conditions dictate the stability and buckling mode of a structural member.", "problem": "A straight, prismatic, homogeneous column of length $L$ with constant flexural rigidity $E I$ is axially compressed by a conservative end force $P$. Both ends are perfectly fixed (clamped). Assume small strains and small rotations and adopt the Euler–Bernoulli kinematic hypothesis. Work in radians for all trigonometric functions. \n\nStarting from first principles, use either the stationary condition of the total potential energy or the force–moment equilibrium in the deformed configuration to derive the linearized eigenvalue problem governing the transverse deflection $w(x)$ in the prebuckling-negligible-deflection limit. Impose the clamped boundary conditions of zero deflection and zero rotation at $x=0$ and $x=L$. Solve for the lowest (fundamental) eigenvalue and a corresponding nontrivial eigenfunction $w(x)$ (up to an arbitrary amplitude scaling). Verify directly that your eigenfunction satisfies zero displacement and zero slope at both ends.\n\nExpress your final reported answer as the symbolic expression for the lowest critical load $P_{\\mathrm{cr}}$ in terms of $E$, $I$, and $L$; express it in Newtons. No numerical rounding is required. Do not report the mode shape in your final answer, but you must derive and use it to verify the boundary conditions in your working.", "solution": "The governing differential equation for the transverse deflection $w(x)$ of a beam-column under an axial compressive load $P$ is derived by considering equilibrium in the deformed configuration. For an Euler-Bernoulli beam, the internal bending moment $M(x)$ is proportional to the curvature, given by the relation:\n$$M(x) = E I \\frac{d^2 w}{dx^2}$$\nwhere $E$ is the Young's modulus and $I$ is the second moment of area of the column's cross-section. The product $EI$ is the flexural rigidity, assumed constant.\n\nConsider a free-body diagram of the column cut at an arbitrary longitudinal coordinate $x$. The equilibrium of moments about the cut gives:\n$$M(x) + P w(x) + V_0 x - M_0 = 0$$\nwhere $M_0$ and $V_0$ are the reaction moment and shear force, respectively, at the support located at $x=0$.\nDifferentiating this equation twice with respect to $x$ eliminates the unknown reaction terms $M_0$ and $V_0$:\n$$\\frac{d^2}{dx^2} [M(x) + P w(x)] = 0$$\nSubstituting the moment-curvature relation gives:\n$$\\frac{d^2}{dx^2} \\left[ E I \\frac{d^2 w}{dx^2} \\right] + P \\frac{d^2 w}{dx^2} = 0$$\nAs the flexural rigidity $EI$ is constant, this simplifies to the governing linear homogeneous ordinary differential equation:\n$$E I \\frac{d^4 w}{dx^4} + P \\frac{d^2 w}{dx^2} = 0$$\nWe define a parameter $k^2 = \\frac{P}{EI}$, where $k$ is real and positive since $P$ and $EI$ are positive. The equation becomes:\n$$\\frac{d^4 w}{dx^4} + k^2 \\frac{d^2 w}{dx^2} = 0$$\nThis equation, together with the specified boundary conditions, constitutes the linearized eigenvalue problem. The load $P$ (or $k^2$) is the eigenvalue, and the deflection shape $w(x)$ is the eigenfunction. The characteristic equation of this ODE is $r^4 + k^2 r^2 = 0$, which has roots $r=0$ (with multiplicity $2$) and $r = \\pm ik$. The general solution for the deflection $w(x)$ is therefore:\n$$w(x) = C_1 \\sin(kx) + C_2 \\cos(kx) + C_3 x + C_4$$\nwhere $C_1, C_2, C_3, C_4$ are constants of integration determined by the boundary conditions.\n\nThe column is clamped at both ends, which imposes the following four boundary conditions:\n$1$. Zero deflection at $x=0$: $w(0) = 0$.\n$2$. Zero slope at $x=0$: $w'(0) = 0$.\n$3$. Zero deflection at $x=L$: $w(L) = 0$.\n$4$. Zero slope at $x=L$: $w'(L) = 0$.\n\nApplying the conditions at $x=0$:\nFrom $w(0) = 0$:\n$$C_1 \\sin(0) + C_2 \\cos(0) + C_3(0) + C_4 = 0 \\implies C_2 + C_4 = 0 \\implies C_4 = -C_2$$\nThe first derivative of $w(x)$ is $w'(x) = C_1 k \\cos(kx) - C_2 k \\sin(kx) + C_3$.\nFrom $w'(0) = 0$:\n$$C_1 k \\cos(0) - C_2 k \\sin(0) + C_3 = 0 \\implies C_1 k + C_3 = 0 \\implies C_3 = -C_1 k$$\nSubstituting these relations back into the general solution gives:\n$$w(x) = C_1 (\\sin(kx) - kx) + C_2 (\\cos(kx) - 1)$$\nNow, we apply the boundary conditions at $x=L$:\nFrom $w(L) = 0$:\n$$C_1 (\\sin(kL) - kL) + C_2 (\\cos(kL) - 1) = 0$$\nFrom $w'(L) = 0$:\n$$w'(x) = C_1 k (\\cos(kx) - 1) - C_2 k \\sin(kx)$$\n$$C_1 k (\\cos(kL) - 1) - C_2 k \\sin(kL) = 0$$\nSince $k \\neq 0$ for buckling to occur, we can divide by $k$:\n$$C_1 (\\cos(kL) - 1) - C_2 \\sin(kL) = 0$$\nWe now have a system of two linear homogeneous equations in terms of the constants $C_1$ and $C_2$:\n$$\n\\begin{pmatrix}\n\\sin(kL) - kL & \\cos(kL) - 1 \\\\\n\\cos(kL) - 1 & -\\sin(kL)\n\\end{pmatrix}\n\\begin{pmatrix}\nC_1 \\\\\nC_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFor a non-trivial solution ($C_1$ and $C_2$ not both zero), the determinant of the coefficient matrix must be zero.\n$$(\\sin(kL) - kL)(-\\sin(kL)) - (\\cos(kL) - 1)^2 = 0$$\n$$-\\sin^2(kL) + kL \\sin(kL) - [\\cos^2(kL) - 2\\cos(kL) + 1] = 0$$\n$$-(\\sin^2(kL) + \\cos^2(kL)) + kL \\sin(kL) + 2\\cos(kL) - 1 = 0$$\nUsing the trigonometric identity $\\sin^2\\theta + \\cos^2\\theta = 1$:\n$$-1 + kL \\sin(kL) + 2\\cos(kL) - 1 = 0$$\n$$kL \\sin(kL) + 2\\cos(kL) - 2 = 0$$\nThis is the characteristic equation for the eigenvalues $k$. To solve it, we use half-angle identities $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$ and $\\cos\\theta = 1-2\\sin^2(\\theta/2)$:\n$$kL \\left(2\\sin\\frac{kL}{2}\\cos\\frac{kL}{2}\\right) + 2\\left(1-2\\sin^2\\frac{kL}{2}\\right) - 2 = 0$$\n$$2kL\\sin\\frac{kL}{2}\\cos\\frac{kL}{2} - 4\\sin^2\\frac{kL}{2} = 0$$\n$$2\\sin\\frac{kL}{2} \\left[ kL\\cos\\frac{kL}{2} - 2\\sin\\frac{kL}{2} \\right] = 0$$\nThis equation is satisfied if either of the two factors is zero:\nCase 1: $\\sin(kL/2) = 0$. This implies $kL/2 = n\\pi$ for any non-zero integer $n$, so $kL = 2n\\pi$.\nCase 2: $kL\\cos(kL/2) - 2\\sin(kL/2) = 0$. This implies $\\tan(kL/2) = kL/2$.\n\nThe lowest critical load $P_{\\mathrm{cr}}$ corresponds to the smallest non-zero value of $k$ that satisfies this characteristic equation.\nIn Case 1, the smallest positive value occurs for $n=1$, giving $kL = 2\\pi$.\nIn Case 2, letting $\\alpha = kL/2$, the equation is $\\tan(\\alpha) = \\alpha$. The smallest non-zero root of this transcendental equation is approximately $\\alpha \\approx 4.4934$, which gives $kL \\approx 8.9868$.\nComparing the two smallest non-zero values for $kL$, we have $2\\pi \\approx 6.2832$ and $8.9868$. The smaller value is $2\\pi$.\nThus, the fundamental buckling mode is determined by:\n$$kL = 2\\pi$$\nSubstituting back $k^2=P_{\\mathrm{cr}}/EI$:\n$$\\left(\\sqrt{\\frac{P_{\\mathrm{cr}}}{EI}}\\right)^2 L^2 = (2\\pi)^2$$\n$$\\frac{P_{\\mathrm{cr}} L^2}{EI} = 4\\pi^2$$\nSolving for the lowest critical load $P_{\\mathrm{cr}}$:\n$$P_{\\mathrm{cr}} = \\frac{4\\pi^2 E I}{L^2}$$\nTo verify consistency, we find the corresponding eigenfunction. For $kL=2\\pi$, the second equation for the constants becomes:\n$$C_1 (\\cos(2\\pi) - 1) - C_2 \\sin(2\\pi) = C_1(1-1) - C_2(0) = 0$$\nThis equation is trivially satisfied. The first equation becomes:\n$$C_1 (\\sin(2\\pi) - 2\\pi) + C_2 (\\cos(2\\pi) - 1) = C_1(0 - 2\\pi) + C_2(1-1) = -2\\pi C_1 = 0$$\nThis implies $C_1=0$. Therefore, the mode shape for the fundamental buckling load is given by:\n$$w(x) = C_2 (\\cos(kx) - 1) = C_2 \\left(\\cos\\left(\\frac{2\\pi x}{L}\\right) - 1\\right)$$\nwhere $C_2$ is an arbitrary constant representing the amplitude of the buckled shape.\n\nFinally, we directly verify that this eigenfunction satisfies all boundary conditions. Let $C$ be the arbitrary amplitude $C_2$.\n$w(x) = C \\left(\\cos\\left(\\frac{2\\pi x}{L}\\right) - 1\\right)$.\n$w'(x) = -C \\frac{2\\pi}{L} \\sin\\left(\\frac{2\\pi x}{L}\\right)$.\nAt $x=0$:\n$w(0) = C(\\cos(0) - 1) = C(1-1) = 0$. (Condition satisfied)\n$w'(0) = -C \\frac{2\\pi}{L} \\sin(0) = 0$. (Condition satisfied)\nAt $x=L$:\n$w(L) = C(\\cos(2\\pi) - 1) = C(1-1) = 0$. (Condition satisfied)\n$w'(L) = -C \\frac{2\\pi}{L} \\sin(2\\pi) = 0$. (Condition satisfied)\nThe verification is successful. The derived expression for the lowest critical load is correct.", "answer": "$$\\boxed{\\frac{4 \\pi^2 E I}{L^2}}$$", "id": "2885501"}, {"introduction": "While the ideal Euler model provides essential insights, real-world columns are never perfectly straight. This exercise [@problem_id:2885504] moves beyond bifurcation theory to explore the more realistic behavior of a column with an initial geometric imperfection. Using an energy-based approach, you will discover how an initial crookedness transforms the stability problem from an eigenvalue analysis into a load-deflection problem. This hands-on practice is crucial for understanding that in imperfect systems, deflections grow with the applied load, a phenomenon central to modern structural design and safety assessment.", "problem": "A straight, prismatic, pin-ended column of length $L$ and constant bending stiffness $E I$ is subjected to a compressive axial load $P$ applied through the centroidal axes at the pinned ends. The column has a small initial crookedness (out-of-straightness) described by $y_{0}(x)=\\delta_{0}\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$, where $\\delta_{0}\\ll L$. Assume small slopes and employ the first-order geometric approximation. Let the load-induced additional deflection be represented by a single admissible function $y(x)=a\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$ consistent with pinned boundary conditions, so that the total lateral deflection is $w(x)=y_{0}(x)+y(x)$.\n\nStarting only from fundamental definitions for strain energy of bending and the work of a compressive axial force under end-shortening, take the curvature responsible for bending stress to be the change of curvature relative to the stress-free imperfect shape, and approximate the end-shortening by the classical small-slope expression. Using energy minimization with respect to the amplitude $a$, derive:\n- the first-order bending moment distribution $M(x)$ generated by the axial load $P$ acting through the deflected shape, and\n- the modified load–deflection relation linking the midspan deflection amplitude to $P$ and the imperfection amplitude $\\delta_{0}$.\n\nProvide only the final closed-form expression for the total midspan deflection $w(L/2)$ as a function of $P$, $E$, $I$, $L$, and $\\delta_{0}$. Express the final deflection in meters. Do not substitute numerical values and do not simplify to a numerical approximation.", "solution": "The principle of total potential energy states that for an elastic system in equilibrium, the total potential energy $\\Pi$ is stationary. For a stable equilibrium, $\\Pi$ must be a minimum. The total potential energy is the sum of the strain energy stored in the column, $U$, and the potential energy of the externally applied load, $\\Omega$.\n$$\n\\Pi = U + \\Omega\n$$\nThe system is in equilibrium when $\\frac{d\\Pi}{da} = 0$, where $a$ is the amplitude of the additional deflection.\n\nFirst, we calculate the strain energy of bending, $U$. The problem specifies that the curvature causing stress is the change in curvature from the initial stress-free state. The initial curvature is $\\kappa_0(x) = y_0''(x)$ and the final curvature is $\\kappa(x) = w''(x)$. The change in curvature is $\\Delta\\kappa(x) = \\kappa(x) - \\kappa_0(x) = w''(x) - y_0''(x)$.\nGiven $w(x) = y_0(x) + y(x)$, the change in curvature is simply $\\Delta\\kappa(x) = y''(x)$.\nThe strain energy is given by:\n$$\nU = \\frac{1}{2} \\int_0^L EI (\\Delta\\kappa(x))^2 dx = \\frac{1}{2} \\int_0^L EI (y''(x))^2 dx\n$$\nWith the assumed additional deflection $y(x) = a\\sin\\left(\\frac{\\pi x}{L}\\right)$, the second derivative is $y''(x) = -a\\left(\\frac{\\pi}{L}\\right)^2\\sin\\left(\\frac{\\pi x}{L}\\right)$.\nSubstituting this into the expression for $U$:\n$$\nU = \\frac{1}{2} \\int_0^L EI \\left[-a\\left(\\frac{\\pi}{L}\\right)^2\\sin\\left(\\frac{\\pi x}{L}\\right)\\right]^2 dx = \\frac{EI a^2 \\pi^4}{2L^4} \\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right) dx\n$$\nThe integral evaluates to $\\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{L}{2}$.\nTherefore, the strain energy is:\n$$\nU = \\frac{EI a^2 \\pi^4}{2L^4} \\left(\\frac{L}{2}\\right) = \\frac{EI \\pi^4 a^2}{4L^3}\n$$\nNext, we calculate the potential energy of the axial load $P$, which is $\\Omega = -W$, where $W$ is the work done by the load. The work is the product of the force $P$ and the axial shortening $\\Delta S$ of the column due to the total deflection. The classical small-slope approximation for the change in end-shortening is:\n$$\n\\Delta S = \\frac{1}{2}\\int_0^L (w'(x))^2 dx - \\frac{1}{2}\\int_0^L (y_0'(x))^2 dx\n$$\nWe have $y_0(x) = \\delta_0 \\sin(\\frac{\\pi x}{L})$ and $w(x) = (\\delta_0 + a)\\sin(\\frac{\\pi x}{L})$. The derivatives are:\n$y_0'(x) = \\delta_0 \\frac{\\pi}{L}\\cos(\\frac{\\pi x}{L})$ and $w'(x) = (\\delta_0 + a)\\frac{\\pi}{L}\\cos(\\frac{\\pi x}{L})$.\nSubstituting these into the expression for $\\Delta S$:\n$$\n\\Delta S = \\frac{1}{2} \\left(\\frac{\\pi}{L}\\right)^2 \\left[ (\\delta_0 + a)^2 - \\delta_0^2 \\right] \\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx\n$$\nThe integral evaluates to $\\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx = \\frac{L}{2}$. The term in the brackets simplifies to $(\\delta_0^2 + 2a\\delta_0 + a^2) - \\delta_0^2 = 2a\\delta_0 + a^2$.\n$$\n\\Delta S = \\frac{1}{2} \\left(\\frac{\\pi}{L}\\right)^2 (2a\\delta_0 + a^2) \\left(\\frac{L}{2}\\right) = \\frac{\\pi^2}{4L}(2a\\delta_0 + a^2)\n$$\nThe potential of the load is $\\Omega = -P \\Delta S = -P\\frac{\\pi^2}{4L}(a^2 + 2a\\delta_0)$.\n\nThe total potential energy $\\Pi$ as a function of $a$ is:\n$$\n\\Pi(a) = U + \\Omega = \\frac{EI \\pi^4 a^2}{4L^3} - P\\frac{\\pi^2}{4L}(a^2 + 2a\\delta_0)\n$$\nTo find the equilibrium state, we minimize $\\Pi(a)$ with respect to $a$:\n$$\n\\frac{d\\Pi}{da} = \\frac{d}{da} \\left[ \\frac{EI \\pi^4 a^2}{4L^3} - P\\frac{\\pi^2}{4L}(a^2 + 2a\\delta_0) \\right] = 0\n$$\n$$\n\\frac{EI \\pi^4 (2a)}{4L^3} - P\\frac{\\pi^2}{4L}(2a + 2\\delta_0) = 0\n$$\n$$\n\\frac{EI \\pi^4 a}{2L^3} - \\frac{P \\pi^2 (a + \\delta_0)}{2L} = 0\n$$\nMultiplying by $\\frac{2L}{\\pi^2}$ gives:\n$$\n\\frac{EI \\pi^2 a}{L^2} - P(a + \\delta_0) = 0\n$$\nWe recognize the Euler critical buckling load for a pin-ended column, $P_E = \\frac{\\pi^2 EI}{L^2}$. Substituting this definition:\n$$\nP_E a - Pa - P\\delta_0 = 0\n$$\n$$\na(P_E - P) = P\\delta_0 \\implies a = \\frac{P\\delta_0}{P_E - P}\n$$\nThis expression provides the amplitude of the additional deflection $a$.\n\nThe total deflection is $w(x) = y_0(x) + y(x) = (\\delta_0+a)\\sin(\\frac{\\pi x}{L})$. The total midspan deflection is $w_{mid} = w(L/2) = \\delta_0 + a$.\nSubstituting the expression for $a$:\n$$\nw(L/2) = \\delta_0 + \\frac{P\\delta_0}{P_E - P} = \\delta_0 \\left(1 + \\frac{P}{P_E - P}\\right) = \\delta_0 \\left(\\frac{P_E - P + P}{P_E - P}\\right) = \\frac{\\delta_0 P_E}{P_E - P}\n$$\nThis can be written as the load-deflection relation:\n$$\nw(L/2) = \\frac{\\delta_0}{1 - P/P_E}\n$$\nThis shows that the total midspan deflection is the initial midspan deflection amplified by a factor that approaches infinity as the applied load $P$ approaches the Euler critical load $P_E$.\n\nThe bending moment distribution is given by the axial load multiplied by the total lateral deflection: $M(x) = -P w(x)$.\n$$\nM(x) = -P \\left( \\frac{\\delta_0}{1 - P/P_E} \\right) \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\nThe problem asks for the final closed-form expression for $w(L/2)$ in terms of the given parameters $P, E, I, L, \\delta_0$. We substitute the expression for $P_E$:\n$$\nw(L/2) = \\frac{\\delta_0}{1 - P \\left/ \\left(\\frac{\\pi^2 EI}{L^2}\\right) \\right.} = \\frac{\\delta_0}{1 - \\frac{PL^2}{\\pi^2 EI}} = \\frac{\\delta_0}{\\frac{\\pi^2 EI - PL^2}{\\pi^2 EI}}\n$$\nThis simplifies to the final expression.\n$$\nw(L/2) = \\frac{\\delta_0 \\pi^2 EI}{\\pi^2 EI - PL^2}\n$$", "answer": "$$\\boxed{\\frac{\\delta_{0} \\pi^{2} EI}{\\pi^{2} EI - PL^{2}}}$$", "id": "2885504"}, {"introduction": "Analytical solutions form the bedrock of our understanding, but modern engineering relies heavily on computational tools to analyze complex structures. This final practice [@problem_id:2620892] bridges the gap between theory and application by guiding you through the implementation of a Finite Element Method (FEM) solution for column buckling. By discretizing the column and assembling the elastic and geometric stiffness matrices, you will solve the buckling eigenvalue problem numerically. This exercise not only provides practical coding experience but also demonstrates the powerful concept of numerical convergence, as your solution approaches the exact analytical result with mesh refinement.", "problem": "Consider a straight, prismatic column of length $L$ made of a linear elastic material with Young's modulus $E$ and second moment of area $I$. The column is idealized as an Euler-Bernoulli beam and is pinned (simply supported) at both ends. The column is subjected to an unknown uniform compressive axial load $P$ along its centroidal axis. The first (smallest positive) critical buckling load corresponds to the loss of stability of the trivial configuration, which arises from the stationarity of the second variation of the total potential energy. Starting from the small-deflection kinematics for Euler-Bernoulli beams and the principle of minimum potential energy, one can write the bilinear forms that lead to a symmetric generalized eigenvalue problem when the column is discretized into $n$ equal two-node Euler-Bernoulli elements using the Finite Element Method (FEM). The essential boundary conditions for a pinned-pinned column are zero transverse deflection at the ends and free end rotations.\n\nYour task is to write a complete program that:\n- Discretizes the column into $n$ equal Euler-Bernoulli beam elements with two degrees of freedom per node (transverse displacement $w$ and rotation $\\theta$).\n- Assembles the global elastic stiffness matrix and the global geometric stiffness operator in a form that yields a symmetric generalized eigenvalue problem of the form $K \\phi = P \\, G \\phi$, where $K$ depends on $E$, $I$, and the element length, and $G$ is independent of $P$ and depends only on the element length.\n- Imposes the pinned-pinned boundary conditions by enforcing zero transverse displacement at the two end nodes while leaving the end rotations free.\n- Solves for the smallest positive eigenvalue $P_n$ (the discrete first critical load) of the assembled system for each specified number of elements $n$.\n\nUse the following parameter values in the International System of Units (SI):\n- $E = 210 \\times 10^9 \\,\\text{Pa}$,\n- $I = 8.1 \\times 10^{-6} \\,\\text{m}^4$,\n- $L = 2.0 \\,\\text{m}$.\n\nFor each $n$ in the test suite below, compute the relative error of the discrete buckling load $P_n$ with respect to the analytical first buckling load for a pinned-pinned Euler-Bernoulli column, denoted $P_{\\text{cr}}$, defined by the exact theory for the given $E$, $I$, and $L$:\n- For each $n$, report the value $|P_n - P_{\\text{cr}}|/P_{\\text{cr}}$ as a dimensionless real number.\n\nTest suite (number of equal elements $n$):\n- $n \\in \\{1,2,4,8,16,32\\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of floating-point values enclosed in square brackets and ordered according to the test suite, with each value rounded to $8$ decimal places (for example: $[0.12345678,0.00123456,0.00000042]$).", "solution": "The objective is to determine the first critical buckling load of a pinned-pinned column using a finite element model and to analyze the convergence of the numerical solution to the exact analytical solution as the mesh is refined.\n\nFirst, we establish the benchmark for our analysis: the analytical solution. The governing differential equation for the buckling of a uniform Euler-Bernoulli column under an axial compressive load $P$ is:\n$$ EI \\frac{d^4w(x)}{dx^4} + P \\frac{d^2w(x)}{dx^2} = 0 $$\nwhere $w(x)$ is the transverse displacement, $E$ is the Young's modulus, and $I$ is the second moment of area. For a column of length $L$ that is pinned at both ends ($x=0$ and $x=L$), the boundary conditions are zero displacement and zero bending moment at the ends:\n$$ w(0) = 0, \\quad w''(0) = 0 $$\n$$ w(L) = 0, \\quad w''(L) = 0 $$\nThe non-trivial solutions to this boundary value problem yield the critical buckling loads. The smallest positive load for which a non-trivial buckled shape can exist is the first critical load, $P_{\\text{cr}}$, given by the classical Euler formula:\n$$ P_{\\text{cr}} = \\frac{\\pi^2 EI}{L^2} $$\nUsing the provided parameters, $E = 210 \\times 10^9 \\,\\text{Pa}$, $I = 8.1 \\times 10^{-6} \\,\\text{m}^4$, and $L = 2.0 \\,\\text{m}$, the exact critical load is:\n$$ P_{\\text{cr}} = \\frac{\\pi^2 (210 \\times 10^9 \\,\\text{Pa}) (8.1 \\times 10^{-6} \\,\\text{m}^4)}{(2.0 \\,\\text{m})^2} \\approx 4.1954 \\times 10^6 \\,\\text{N} $$\nThis value will serve as the reference against which we compare our numerical results.\n\nNext, we formulate the Finite Element Method solution. The column is discretized into $n$ identical Euler-Bernoulli beam elements, each of length $h = L/n$. Each element has two nodes, and each node possesses two degrees of freedom (DOFs): a transverse displacement $w$ and a rotation $\\theta = dw/dx$. The nodal displacement vector for an element connecting nodes $i$ and $j$ is $\\mathbf{d}^e = [w_i, \\theta_i, w_j, \\theta_j]^T$.\n\nThe stability analysis using FEM leads to a generalized symmetric eigenvalue problem:\n$$ \\mathbf{K} \\mathbf{D} = P \\mathbf{G} \\mathbf{D} $$\nHere, $\\mathbf{K}$ is the global elastic stiffness matrix, which represents the strain energy due to bending, and $\\mathbf{G}$ is the global geometric stiffness matrix (or stability matrix), which represents the work done by the axial force $P$ during buckling. The eigenvalues of this system are the critical loads $P$, and the eigenvectors $\\mathbf{D}$ are the corresponding buckling mode shapes.\n\nFor a single element of length $h$, the element elastic stiffness matrix $\\mathbf{k}^e$ is given by:\n$$ \\mathbf{k}^e = \\frac{EI}{h^3} \\begin{bmatrix} 12 & 6h & -12 & 6h \\\\ 6h & 4h^2 & -6h & 2h^2 \\\\ -12 & -6h & 12 & -6h \\\\ 6h & 2h^2 & -6h & 4h^2 \\end{bmatrix} $$\nThe element geometric stiffness matrix $\\mathbf{g}^e$ is:\n$$ \\mathbf{g}^e = \\frac{1}{30h} \\begin{bmatrix} 36 & 3h & -36 & 3h \\\\ 3h & 4h^2 & -3h & -h^2 \\\\ -36 & -3h & 36 & -3h \\\\ 3h & -h^2 & -3h & 4h^2 \\end{bmatrix} $$\nThe global matrices $\\mathbf{K}$ and $\\mathbf{G}$ for a system of $n$ elements and $n+1$ nodes (total DOFs are $2(n+1)$) are assembled by summing the contributions of each element matrix into the appropriate global locations according to element connectivity.\n\nThe boundary conditions for a pinned-pinned column are $w(0) = 0$ and $w(L) = 0$. In our discrete model, this translates to enforcing zero displacement at the first node (node 1) and the last node (node $n+1$). The rotational DOFs at these nodes remain free. We impose these essential boundary conditions by removing the rows and columns from $\\mathbf{K}$ and $\\mathbf{G}$ that correspond to these specified zero-displacement DOFs. This reduces the size of the matrix system. For a system with $2(n+1)$ total DOFs, we remove two DOFs, resulting in a reduced system of size $2n \\times 2n$.\n\nThe computational procedure is as follows:\n1. For each value of $n$ from the test suite $\\{1, 2, 4, 8, 16, 32\\}$, calculate the element length $h = L/n$.\n2. Construct the element matrices $\\mathbf{k}^e$ and $\\mathbf{g}^e$ using the calculated $h$ and given $E$ and $I$.\n3. Initialize global matrices $\\mathbf{K}$ and $\\mathbf{G}$ of size $2(n+1) \\times 2(n+1)$ with zeros.\n4. Assemble the global matrices by iterating through all $n$ elements and adding their respective $\\mathbf{k}^e$ and $\\mathbf{g}^e$ matrices to the correct positions in $\\mathbf{K}$ and $\\mathbf{G}$.\n5. Apply the pinned-pinned boundary conditions by creating reduced matrices $\\mathbf{K}_{\\text{red}}$ and $\\mathbf{G}_{\\text{red}}$. This is done by deleting the rows and columns corresponding to the transverse displacement DOFs at the first and last nodes.\n6. Solve the reduced generalized eigenvalue problem $\\mathbf{K}_{\\text{red}} \\mathbf{D}_{\\text{red}} = P \\mathbf{G}_{\\text{red}} \\mathbf{D}_{\\text{red}}$ for its eigenvalues. We use a numerical library function suitable for symmetric matrices.\n7. The smallest positive eigenvalue obtained is the first numerical buckling load, $P_n$.\n8. Calculate the analytical critical load, $P_{\\text{cr}} = \\pi^2 EI/L^2$.\n9. Compute the relative error for each $n$: $\\epsilon_n = |P_n - P_{\\text{cr}}|/P_{\\text{cr}}$.\n10. Report the resulting list of relative errors, formatted as specified.\n\nThis procedure will demonstrate the convergence of the finite element solution towards the exact analytical solution as the number of elements $n$ increases. As expected from approximation theory for this type of problem, the numerical model is overly stiff, and thus $P_n$ will approach $P_{\\text{cr}}$ from above.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the relative error of the FEM buckling load for a pinned-pinned column\n    with respect to the analytical Euler buckling load for various mesh densities.\n    \"\"\"\n    # Define physical and material constants in SI units\n    E = 210e9  # Young's modulus in Pa\n    I = 8.1e-6  # Second moment of area in m^4\n    L = 2.0  # Length of the column in m\n\n    # Define the test suite for the number of elements\n    test_cases_n = [1, 2, 4, 8, 16, 32]\n\n    # Calculate the analytical first critical buckling load (P_cr)\n    P_cr = (np.pi**2 * E * I) / (L**2)\n\n    results = []\n\n    for n in test_cases_n:\n        # Step 1: Define element properties\n        h = L / n  # Length of one element\n\n        # Step 2: Define the element elastic stiffness matrix (ke)\n        # ke = (E*I/h**3) * ...\n        ke_factor = (E * I) / (h**3)\n        ke = ke_factor * np.array([\n            [12, 6 * h, -12, 6 * h],\n            [6 * h, 4 * h**2, -6 * h, 2 * h**2],\n            [-12, -6 * h, 12, -6 * h],\n            [6 * h, 2 * h**2, -6 * h, 4 * h**2]\n        ])\n\n        # Step 3: Define the element geometric stiffness matrix (ge)\n        # ge = (1/(30*h)) * ...\n        ge_factor = 1 / (30 * h)\n        ge = ge_factor * np.array([\n            [36, 3 * h, -36, 3 * h],\n            [3 * h, 4 * h**2, -3 * h, -h**2],\n            [-36, -3 * h, 36, -3 * h],\n            [3 * h, -h**2, -3 * h, 4 * h**2]\n        ])\n        \n        # Step 4: Assemble the global matrices K and G\n        num_nodes = n + 1\n        num_dofs = 2 * num_nodes\n        K = np.zeros((num_dofs, num_dofs))\n        G = np.zeros((num_dofs, num_dofs))\n\n        for i in range(n):\n            # Determine the global DOFs for the current element\n            dof_indices = np.array([2*i, 2*i + 1, 2*(i+1), 2*(i+1) + 1])\n            # Use np.ix_ to facilitate adding the element matrix to the global matrix\n            ix = np.ix_(dof_indices, dof_indices)\n            K[ix] += ke\n            G[ix] += ge\n\n        # Step 5: Apply boundary conditions (pinned-pinned)\n        # We enforce zero transverse displacement at the first and last nodes.\n        # This corresponds to DOF 0 (at node 0) and DOF 2*n (at node n).\n        # We remove the corresponding rows and columns from K and G.\n        \n        # DOFs to remove are the displacement DOFs at the ends.\n        # Using 0-based indexing: node 0's displacement is DOF 0.\n        # Node n's displacement is DOF 2*n.\n        dofs_to_remove = [0, 2*n]\n        \n        K_red = np.delete(K, dofs_to_remove, axis=0)\n        K_red = np.delete(K_red, dofs_to_remove, axis=1)\n\n        G_red = np.delete(G, dofs_to_remove, axis=0)\n        G_red = np.delete(G_red, dofs_to_remove, axis=1)\n\n        # Step 6: Solve the generalized eigenvalue problem K_red * v = P * G_red * v\n        # linalg.eigh returns eigenvalues in ascending order.\n        eigenvalues, eigenvectors = linalg.eigh(K_red, G_red)\n        \n        # The smallest positive eigenvalue is the first numerical buckling load, P_n.\n        P_n = eigenvalues[0]\n\n        # Step 7: Calculate the relative error\n        relative_error = abs(P_n - P_cr) / P_cr\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2620892"}]}