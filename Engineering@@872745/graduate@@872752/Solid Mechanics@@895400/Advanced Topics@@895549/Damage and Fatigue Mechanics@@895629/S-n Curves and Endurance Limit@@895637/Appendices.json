{"hands_on_practices": [{"introduction": "The power-law relationship, often known as Basquin's law, is the cornerstone of high-cycle fatigue analysis. This exercise guides you through a fundamental derivation to solidify your understanding of how the S-N curve's slope on a log-log plot dictates the material's sensitivity to stress changes. By working through this problem [@problem_id:2682666], you will develop the analytical skills to predict changes in fatigue life based on variations in stress amplitude, a critical task in design and failure analysis.", "problem": "In high-cycle fatigue of metals under fully reversed loading (zero mean stress), experimental evidence shows that the relationship between stress amplitude and fatigue life follows a power law that yields a straight line on a double-logarithmic plot of stress versus cycles to failure, commonly called the stress-number of cycles (S-N) curve. Consider a material whose S-N data, plotted as stress amplitude versus number of cycles on a base-$10$ logarithmic scale for both axes, is well represented by a straight line. The measured slope of this line is $-0.095$. \n\nUsing a power-law stress-life relation consistent with such empirical S-N behavior, do the following:\n- Starting from the power-law relation, derive the equation of the S-N line on a log-log plot and show how the slope $-b$ arises.\n- From this base, derive the logarithmic sensitivity of life to stress amplitude changes, in the form $d\\ln N/d\\ln \\sigma_{a}$, and explain how it depends on the slope magnitude.\n- For a finite change, derive an analytic expression for the ratio of lives at two different stress amplitudes in terms of the ratio of the amplitudes and the slope parameter.\n\nFinally, suppose the stress amplitude is reduced by a factor of $0.88$ relative to its original value, while the power-law slope parameter remains unchanged and equal to the magnitude of the measured slope. Compute the corresponding life ratio. Express the life ratio $N_{2}/N_{1}$ as a pure number and round your answer to three significant figures.", "solution": "The relationship between stress amplitude, $\\sigma_a$, and the number of cycles to failure, $N$, in the high-cycle fatigue regime is described by a power law known as Basquin's equation. A common form of this relation is:\n$$ \\sigma_a = C N^{-b} $$\nHere, $C$ is the fatigue strength coefficient and $b$ is the fatigue strength exponent, both of which are material constants. The exponent $b$ is a positive number.\n\nThe first task is to derive the equation of the S-N line on a double-logarithmic plot and relate its slope to the parameter $b$. The problem specifies a base-$10$ logarithmic scale for both axes. We take the $\\log_{10}$ of both sides of Basquin's equation:\n$$ \\log_{10}(\\sigma_a) = \\log_{10}(C N^{-b}) $$\nUsing the properties of logarithms, we expand the right-hand side:\n$$ \\log_{10}(\\sigma_a) = \\log_{10}(C) + \\log_{10}(N^{-b}) $$\n$$ \\log_{10}(\\sigma_a) = \\log_{10}(C) - b \\log_{10}(N) $$\nThis equation is of the form $Y = mX + c$, where the vertical axis coordinate is $Y = \\log_{10}(\\sigma_a)$, the horizontal axis coordinate is $X = \\log_{10}(N)$, the slope is $m = -b$, and the y-intercept is $c = \\log_{10}(C)$. This demonstrates that the power-law relation yields a straight line on a log-log plot of $\\sigma_a$ versus $N$. The slope of this line is indeed $-b$. The problem states the measured slope is $-0.095$. Therefore, the parameter $b$ for this material is $0.095$.\n\nThe second task is to derive the logarithmic sensitivity of life to stress, defined as the derivative $d\\ln N / d\\ln \\sigma_a$. For this derivation, it is more convenient to use the natural logarithm ($\\ln$). We take the natural logarithm of Basquin's equation:\n$$ \\ln(\\sigma_a) = \\ln(C N^{-b}) $$\n$$ \\ln(\\sigma_a) = \\ln(C) - b \\ln(N) $$\nWe are interested in the derivative of $\\ln(N)$ with respect to $\\ln(\\sigma_a)$. We can differentiate the entire equation with respect to $\\ln(\\sigma_a)$:\n$$ \\frac{d}{d\\ln\\sigma_a} \\left( \\ln(\\sigma_a) \\right) = \\frac{d}{d\\ln\\sigma_a} \\left( \\ln(C) - b \\ln(N) \\right) $$\nSince $\\ln(C)$ is a constant, its derivative is zero. Applying the chain rule to the term with $\\ln(N)$:\n$$ 1 = 0 - b \\frac{d\\ln N}{d\\ln \\sigma_a} $$\nSolving for the desired sensitivity gives:\n$$ \\frac{d\\ln N}{d\\ln \\sigma_a} = -\\frac{1}{b} $$\nThis result shows that the logarithmic sensitivity of life to stress is the negative reciprocal of the fatigue strength exponent $b$. This means that a smaller value of $b$ (a shallower slope on the S-N curve) corresponds to a higher sensitivity of fatigue life to changes in stress amplitude. Conversely, a larger $b$ (a steeper slope) indicates that life is less sensitive to stress variations.\n\nThe third task is to derive an expression for the ratio of lives at two different stress amplitudes. Let two states on the S-N curve be $(\\sigma_{a,1}, N_1)$ and $(\\sigma_{a,2}, N_2)$. Both points must satisfy the power-law relation:\n$$ \\sigma_{a,1} = C N_1^{-b} \\quad (1) $$\n$$ \\sigma_{a,2} = C N_2^{-b} \\quad (2) $$\nTo eliminate the constant $C$, we divide equation $(2)$ by equation $(1)$:\n$$ \\frac{\\sigma_{a,2}}{\\sigma_{a,1}} = \\frac{C N_2^{-b}}{C N_1^{-b}} = \\left( \\frac{N_2}{N_1} \\right)^{-b} $$\nWe are required to find the life ratio $N_2/N_1$. We raise both sides of the equation to the power of $-1/b$:\n$$ \\left( \\frac{\\sigma_{a,2}}{\\sigma_{a,1}} \\right)^{-1/b} = \\left( \\left( \\frac{N_2}{N_1} \\right)^{-b} \\right)^{-1/b} $$\n$$ \\frac{N_2}{N_1} = \\left( \\frac{\\sigma_{a,2}}{\\sigma_{a,1}} \\right)^{-1/b} $$\nThis is the required analytic expression. An equivalent form is $\\frac{N_2}{N_1} = \\left( \\frac{\\sigma_{a,1}}{\\sigma_{a,2}} \\right)^{1/b}$.\n\nFinally, we must compute the life ratio $N_2/N_1$ for the given conditions. The stress amplitude is reduced by a factor of $0.88$, which means the ratio of the new stress amplitude to the original is $\\sigma_{a,2}/\\sigma_{a,1} = 0.88$. The power-law slope parameter $b$ is the magnitude of the measured slope, so $b = |-0.095| = 0.095$.\n\nSubstituting these values into the derived expression:\n$$ \\frac{N_2}{N_1} = (0.88)^{-1/0.095} $$\nThe exponent is calculated as $-1 / 0.095 \\approx -10.5263$.\n$$ \\frac{N_2}{N_1} = (0.88)^{-10.5263...} \\approx 3.84053 $$\nRounding the result to three significant figures, we get $3.84$. This means that a $12\\%$ reduction in stress amplitude results in an increase in fatigue life by a factor of approximately $3.84$.", "answer": "$$\\boxed{3.84}$$", "id": "2682666"}, {"introduction": "While the Basquin relation describes idealized, fully reversed loading, most real-world components experience non-zero mean stresses. This practice problem [@problem_id:2682734] challenges you to apply a standard mean stress correction model—the Gerber relation—to a practical engineering scenario. You will quantify the significant life improvement provided by a compressive residual stress, a common outcome of surface treatments, thereby connecting theoretical models to tangible design benefits.", "problem": "A steel component exhibits a measured, mechanically stable compressive residual stress of $-200\\ \\text{MPa}$ at the critical location. The steel has an ultimate tensile strength $\\sigma_{u}=1000\\ \\text{MPa}$. The service loading at that location is nominally uniaxial and periodic with minimum and maximum normal stresses $\\sigma_{\\min}=80\\ \\text{MPa}$ and $\\sigma_{\\max}=480\\ \\text{MPa}$ in each cycle. Assume linear-elastic superposition so that the residual stress shifts the cycle’s mean stress but does not alter the alternating component, and neglect any residual-stress relaxation during service.\n\nUnder fully reversed loading (stress ratio $R=-1$), the stress amplitude-number of cycles (S-N) behavior follows a Basquin power law of the form $\\sigma_{a}=C\\,N^{b}$, where $\\sigma_{a}$ is the stress amplitude and $N$ is the life in cycles. The constants $C$ and $b$ are not given directly but are calibrated from two fully reversed data points: at $N=10^{5}$ cycles, $\\sigma_{a}=600\\ \\text{MPa}$; at $N=10^{7}$ cycles, $\\sigma_{a}=400\\ \\text{MPa}$.\n\nTo account for nonzero mean stress, use the Gerber mean-stress correction based on the Haigh diagram with ultimate strength $\\sigma_{u}$.\n\nDefine the life improvement factor as $\\Lambda = N_{\\text{with res}}/N_{\\text{no res}}$, where $N_{\\text{with res}}$ is the predicted life with the residual stress present and $N_{\\text{no res}}$ is the predicted life if the residual stress were absent, all else equal.\n\nUsing only the information above and standard, well-tested relations, compute $\\Lambda$. Round your answer to three significant figures and express it as a unitless decimal number.", "solution": "The objective is to compute the life improvement factor $\\Lambda$, defined as the ratio of fatigue life with residual stress to the life without it. The solution proceeds in several logical steps.\n\nFirst, we determine the Basquin exponent, $b$, from the two provided data points on the S-N curve. The Basquin relation is given as $\\sigma_{a} = C N^{b}$. Writing this for the two data points gives:\n$$\n\\sigma_{a,1} = C N_{1}^{b} \\implies 600 = C (10^{5})^{b}\n$$\n$$\n\\sigma_{a,2} = C N_{2}^{b} \\implies 400 = C (10^{7})^{b}\n$$\nDividing the first equation by the second eliminates the constant $C$:\n$$\n\\frac{\\sigma_{a,1}}{\\sigma_{a,2}} = \\frac{C N_{1}^{b}}{C N_{2}^{b}} = \\left(\\frac{N_1}{N_2}\\right)^{b}\n$$\nSubstituting the given values:\n$$\n\\frac{600}{400} = \\left(\\frac{10^{5}}{10^{7}}\\right)^{b} \\implies 1.5 = (10^{-2})^{b}\n$$\nTo solve for $b$, we take the base-$10$ logarithm of both sides:\n$$\n\\log_{10}(1.5) = \\log_{10}(10^{-2b}) = -2b\n$$\nThus, the Basquin exponent is:\n$$\nb = -\\frac{\\log_{10}(1.5)}{2}\n$$\nThe constant $C$ is not needed for the final calculation of the life ratio, as will be shown.\n\nNext, we analyze the applied service stress cycle. The alternating stress, $\\sigma_{a}$, and mean stress, $\\sigma_{m}$, are calculated from the given minimum and maximum stresses:\n$$\n\\sigma_{a} = \\frac{\\sigma_{\\max} - \\sigma_{\\min}}{2} = \\frac{480 - 80}{2} = 200\\ \\text{MPa}\n$$\n$$\n\\sigma_{m, \\text{nom}} = \\frac{\\sigma_{\\max} + \\sigma_{\\min}}{2} = \\frac{480 + 80}{2} = 280\\ \\text{MPa}\n$$\nThis mean stress, $\\sigma_{m, \\text{nom}}$, is the nominal value before considering the residual stress.\n\nThe Gerber mean-stress correction relates a stress cycle with a non-zero mean stress to an equivalent, fully reversed stress cycle ($\\sigma_{m} = 0$) that yields the same fatigue life. The equivalent stress amplitude, $\\sigma_{a, \\text{eq}}$, is given by rearranging the Gerber equation $\\frac{\\sigma_{a}}{\\sigma_{a, \\text{eq}}} + (\\frac{\\sigma_{m}}{\\sigma_{u}})^{2} = 1$:\n$$\n\\sigma_{a, \\text{eq}} = \\frac{\\sigma_{a}}{1 - (\\frac{\\sigma_{m}}{\\sigma_{u}})^{2}}\n$$\nWe apply this relation to two cases: without residual stress and with residual stress.\n\nCase 1: No residual stress ($N_{\\text{no res}}$)\nThe mean stress is the nominal mean stress: $\\sigma_{m, \\text{no res}} = \\sigma_{m, \\text{nom}} = 280\\ \\text{MPa}$. The equivalent stress amplitude is:\n$$\n\\sigma_{a, \\text{eq, no res}} = \\frac{\\sigma_{a}}{1 - (\\frac{\\sigma_{m, \\text{no res}}}{\\sigma_{u}})^{2}} = \\frac{200}{1 - (\\frac{280}{1000})^{2}}\n$$\n\nCase 2: With residual stress ($N_{\\text{with res}}$)\nThe residual stress $\\sigma_{\\text{res}} = -200\\ \\text{MPa}$ is superposed onto the mean stress. The alternating stress is unaffected. The new effective mean stress is:\n$$\n\\sigma_{m, \\text{with res}} = \\sigma_{m, \\text{nom}} + \\sigma_{\\text{res}} = 280 + (-200) = 80\\ \\text{MPa}\n$$\nThe corresponding equivalent stress amplitude is:\n$$\n\\sigma_{a, \\text{eq, with res}} = \\frac{\\sigma_{a}}{1 - (\\frac{\\sigma_{m, \\text{with res}}}{\\sigma_{u}})^{2}} = \\frac{200}{1 - (\\frac{80}{1000})^{2}}\n$$\n\nThe fatigue life $N$ is found by inverting the Basquin relation for the equivalent stress amplitude: $N = (\\sigma_{a, \\text{eq}} / C)^{1/b}$. The life improvement factor $\\Lambda$ is the ratio of the lives:\n$$\n\\Lambda = \\frac{N_{\\text{with res}}}{N_{\\text{no res}}} = \\frac{(\\sigma_{a, \\text{eq, with res}} / C)^{1/b}}{(\\sigma_{a, \\text{eq, no res}} / C)^{1/b}} = \\left(\\frac{\\sigma_{a, \\text{eq, with res}}}{\\sigma_{a, \\text{eq, no res}}}\\right)^{1/b}\n$$\nAs anticipated, the constant $C$ cancels. It is often more convenient to work with a base greater than $1$, so we can write:\n$$\n\\Lambda = \\left(\\frac{\\sigma_{a, \\text{eq, no res}}}{\\sigma_{a, \\text{eq, with res}}}\\right)^{-1/b}\n$$\nSubstituting the expressions for the equivalent stresses:\n$$\n\\Lambda = \\left(\\frac{\\frac{200}{1 - (280/1000)^{2}}}{\\frac{200}{1 - (80/1000)^{2}}}\\right)^{-1/b} = \\left(\\frac{1 - (80/1000)^{2}}{1 - (280/1000)^{2}}\\right)^{-1/b}\n$$\nThe exponent is $-1/b = -1 / (-\\frac{\\log_{10}(1.5)}{2}) = \\frac{2}{\\log_{10}(1.5)}$.\nNow, we substitute the numerical values:\n$$\n\\Lambda = \\left(\\frac{1 - (0.08)^{2}}{1 - (0.28)^{2}}\\right)^{\\frac{2}{\\log_{10}(1.5)}} = \\left(\\frac{1 - 0.0064}{1 - 0.0784}\\right)^{\\frac{2}{\\log_{10}(1.5)}}\n$$\n$$\n\\Lambda = \\left(\\frac{0.9936}{0.9216}\\right)^{\\frac{2}{\\log_{10}(1.5)}} \\approx (1.078125)^{2 / 0.176091} \\approx (1.078125)^{11.3577}\n$$\nEvaluating this expression:\n$$\n\\ln(\\Lambda) \\approx 11.3577 \\times \\ln(1.078125) \\approx 11.3577 \\times 0.07521 \\approx 0.8542\n$$\n$$\n\\Lambda = \\exp(0.8542) \\approx 2.3495\n$$\nRounding the result to three significant figures, as requested, gives $\\Lambda = 2.35$. The compressive residual stress substantially increases the fatigue life by reducing the effective mean stress, which is consistent with established mechanical principles.", "answer": "$$\\boxed{2.35}$$", "id": "2682734"}, {"introduction": "Modern fatigue analysis often involves consolidating data from tests run at various stress ratios ($R$) into a single, unified model. This computational exercise [@problem_id:2682726] provides hands-on practice with the Walker mean stress model, a versatile tool for this purpose. You will linearize the model, use least-squares regression to calibrate its parameters from synthetic data, and learn to interpret the mean stress sensitivity exponent, $\\gamma$, which is a crucial skill for advanced material characterization.", "problem": "Consider a family of high-cycle fatigue data sets in which the stress ratio $R$ varies across tests. Assume a mean-stress corrected power-law relationship between the stress amplitude and the number of cycles to failure, where the equivalent amplitude is obtained by scaling the observed amplitude by a power of $\\left(1 - R\\right)$. Your task is to calibrate the three unknown parameters that govern this relationship from multi-$R$ stress-life data and to interpret the mean stress exponent in terms of sensitivity to mean stress.\n\nStarting from fundamental bases:\n- The power-law relation between fully reversed stress amplitude and life, often called the Basquin law, is well-established in high-cycle fatigue. It states that there exist constants such that a strictly monotone power relation between amplitude and life holds over an appropriate regime.\n- The stress ratio $R$ defined by $R = \\sigma_{\\min} / \\sigma_{\\max}$ captures the effect of mean stress on fatigue life in a dimensionally consistent way through a dimensionless factor involving $\\left(1 - R\\right)$.\n- Natural logarithms linearize products and powers, enabling linear regression on logarithmic transforms to estimate exponents and intercepts.\n\nAssume that the mapping from $\\left(\\sigma_a, R, N\\right)$ to an $R$-independent equivalent amplitude is accomplished by multiplying $\\sigma_a$ by $\\left(1 - R\\right)^{\\gamma}$ for some unknown exponent $\\gamma$, and that the life relation in the equivalent domain follows a two-parameter power law with unknown slope exponent $b$ and intercept $C$. Here $\\sigma_a$ is the stress amplitude expressed in $\\mathrm{MPa}$, $R$ is dimensionless, and $N$ is the number of cycles to failure (dimensionless count). You will estimate the triplet $\\left(\\gamma, b, C\\right)$ by linearizing the relationship in the logarithmic domain and applying least-squares fitting across pooled multi-$R$ data.\n\nDefine the following three test cases. For each case, you are given a parameter set $\\left(C_{\\text{true}}, b_{\\text{true}}, \\gamma_{\\text{true}}\\right)$, along with lists of $R$-values and $N$-values. Synthetic data are generated by the rule that the measured stress amplitude $\\sigma_a$ satisfies the mean-stress corrected power law exactly. Concretely, for each pair $\\left(R, N\\right)$ in the Cartesian product of the provided lists, define a datum by\n$$\n\\sigma_a = \\frac{C_{\\text{true}} \\, N^{-b_{\\text{true}}}}{\\left(1 - R\\right)^{\\gamma_{\\text{true}}}},\n$$\nwith $\\sigma_a$ in $\\mathrm{MPa}$.\n\n- Test Case A (happy path, multiple $R$ and decades of $N$):\n  - $\\left(C_{\\text{true}}, b_{\\text{true}}, \\gamma_{\\text{true}}\\right) = \\left(1600 \\ \\mathrm{MPa}, \\ 0.1, \\ 0.5\\right)$\n  - $R$-list: $\\left[-1, \\ 0, \\ 0.5\\right]$\n  - $N$-list: $\\left[10^5, \\ 10^6, \\ 10^7\\right]$\n\n- Test Case B (boundary in which mean stress has no effect):\n  - $\\left(C_{\\text{true}}, b_{\\text{true}}, \\gamma_{\\text{true}}\\right) = \\left(1500 \\ \\mathrm{MPa}, \\ 0.08, \\ 0.0\\right)$\n  - $R$-list: $\\left[-1, \\ 0.4\\right]$\n  - $N$-list: $\\left[10^5, \\ 10^6, \\ 10^7\\right]$\n\n- Test Case C (edge with high stress ratio near $R \\to 1$):\n  - $\\left(C_{\\text{true}}, b_{\\text{true}}, \\gamma_{\\text{true}}\\right) = \\left(2000 \\ \\mathrm{MPa}, \\ 0.12, \\ 0.8\\right)$\n  - $R$-list: $\\left[0.0, \\ 0.5, \\ 0.9\\right]$\n  - $N$-list: $\\left[10^4, \\ 10^5, \\ 10^6\\right]$\n\nTasks your program must perform for each test case:\n1. Generate the synthetic multi-$R$ stress-life data $\\left(\\sigma_a, R, N\\right)$ using the rule above, with $\\sigma_a$ in $\\mathrm{MPa}$ and $N$ as a count of cycles.\n2. Using only the generated $\\left(\\sigma_a, R, N\\right)$ triplets, estimate $\\left(\\hat{\\gamma}, \\hat{b}, \\hat{C}\\right)$ by linearizing the model with natural logarithms and solving a least-squares problem. Ensure that $\\hat{C}$ is reported in $\\mathrm{MPa}$, while $\\hat{\\gamma}$ and $\\hat{b}$ are dimensionless.\n3. Compute a scalar goodness-of-collapse metric that quantifies the extent to which the fitted mean-stress exponent removes the $R$-dependence. Define the metric as the root-mean-square of the residuals in the logarithmic domain,\n$$\n\\text{RMSE}_{\\log} = \\sqrt{\\frac{1}{n}\\sum_{i=1}^{n}\\left[\\ln\\left(\\sigma_{a,i}\\left(1 - R_i\\right)^{\\hat{\\gamma}}\\right) - \\left(\\ln \\hat{C} - \\hat{b}\\ln N_i\\right)\\right]^2},\n$$\nwhich is dimensionless.\n4. Interpret the mean stress sensitivity by mapping $\\hat{\\gamma}$ to a categorical code $k$ as follows:\n   - If $\\left|\\hat{\\gamma}\\right|  0.05$, then $k = 0$ (negligible mean stress sensitivity).\n   - Else if $0.05 \\le \\left|\\hat{\\gamma}\\right|  0.5$, then $k = 1$ (moderate mean stress sensitivity).\n   - Else $k = 2$ (strong mean stress sensitivity).\n\nFinal output format:\n- For each test case, produce a list $\\left[\\hat{\\gamma}, \\hat{b}, \\hat{C}, \\text{RMSE}_{\\log}, k\\right]$ with the three estimates, the scalar metric, and the integer code.\n- Aggregate the three per-case lists into a single list in the order A, B, C.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example,\n$[\\,[\\hat{\\gamma}_A,\\hat{b}_A,\\hat{C}_A,\\text{RMSE}_{\\log,A},k_A],\\,[\\hat{\\gamma}_B,\\hat{b}_B,\\hat{C}_B,\\text{RMSE}_{\\log,B},k_B],\\,[\\hat{\\gamma}_C,\\hat{b}_C,\\hat{C}_C,\\text{RMSE}_{\\log,C},k_C]\\,]$,\nwith all floating-point values rounded to $6$ decimal places. Report $\\hat{C}$ in $\\mathrm{MPa}$, and report $\\hat{\\gamma}$, $\\hat{b}$, and $\\text{RMSE}_{\\log}$ as dimensionless quantities.", "solution": "The task is to estimate the parameters $\\left(\\gamma, b, C\\right)$ of the mean-stress corrected fatigue life model from synthetic data. The model is given by the equation:\n$$\n\\sigma_a = \\frac{C \\, N^{-b}}{\\left(1 - R\\right)^{\\gamma}}\n$$\nwhere $\\sigma_a$ is the stress amplitude, $N$ is the number of cycles to failure, and $R$ is the stress ratio. The parameters are the fatigue strength coefficient $C$, the Basquin exponent $b$, and the mean-stress sensitivity exponent $\\gamma$.\n\nThe fundamental approach for parameter estimation is the method of least squares, applied to a linearized form of the model. The provided power-law relationship is intrinsically non-linear. However, application of the natural logarithm transforms it into a linear equation, a standard and correct procedure.\n\nTaking the natural logarithm of both sides of the equation yields:\n$$\n\\ln(\\sigma_a) = \\ln(C) - b \\ln(N) - \\gamma \\ln(1 - R)\n$$\nThis equation is of the form of a multiple linear regression model. Let us define the variables for the regression:\n- The dependent variable, $y = \\ln(\\sigma_a)$.\n- The independent variables, $x_1 = \\ln(N)$ and $x_2 = \\ln(1 - R)$.\n\nThe model can now be expressed in a standard linear form:\n$$\ny = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2\n$$\nBy comparing this to the logarithmically transformed fatigue equation, we can identify the regression coefficients $\\beta_j$ with the physical parameters of the fatigue model:\n- The intercept $\\beta_0$ corresponds to $\\ln(C)$.\n- The coefficient $\\beta_1$ corresponds to $-b$.\n- The coefficient $\\beta_2$ corresponds to $-\\gamma$.\n\nFor a set of $n$ data points $\\left(\\sigma_{a,i}, R_i, N_i\\right)$, we can write a system of linear equations. In matrix form, this system is expressed as $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$, where:\n- $\\mathbf{y}$ is the $n \\times 1$ vector of observed responses: $\\mathbf{y} = \\left[ \\ln(\\sigma_{a,1}), \\dots, \\ln(\\sigma_{a,n}) \\right]^T$.\n- $\\mathbf{X}$ is the $n \\times 3$ design matrix, where each row corresponds to an observation:\n$$\n\\mathbf{X} = \\begin{bmatrix}\n1  \\ln(N_1)  \\ln(1 - R_1) \\\\\n1  \\ln(N_2)  \\ln(1 - R_2) \\\\\n\\vdots  \\vdots  \\vdots \\\\\n1  \\ln(N_n)  \\ln(1 - R_n)\n\\end{bmatrix}\n$$\n- $\\boldsymbol{\\beta}$ is the $3 \\times 1$ vector of coefficients to be estimated: $\\boldsymbol{\\beta} = \\left[ \\beta_0, \\beta_1, \\beta_2 \\right]^T = \\left[ \\ln(C), -b, -\\gamma \\right]^T$.\n\nThe least-squares estimate $\\hat{\\boldsymbol{\\beta}}$ that minimizes the sum of squared residuals, $\\left\\| \\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta} \\right\\|^2$, is given by the solution to the normal equations:\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}\n$$\nOnce the vector of estimated regression coefficients $\\hat{\\boldsymbol{\\beta}} = \\left[ \\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_2 \\right]^T$ is computed, the estimates for the physical parameters of the fatigue model are recovered as follows:\n- $\\hat{C} = \\exp(\\hat{\\beta}_0)$\n- $\\hat{b} = -\\hat{\\beta}_1$\n- $\\hat{\\gamma} = -\\hat{\\beta}_2$\n\nThe problem specifies that the synthetic data are generated exactly according to the model, without any stochastic noise. Consequently, the linear least-squares fit must perfectly recover the true parameters, and the residuals of the fit should be numerically zero.\n\nThe goodness-of-collapse metric, $\\text{RMSE}_{\\log}$, is defined as the root mean square of the residuals in the logarithmic domain.\n$$\n\\text{RMSE}_{\\log} = \\sqrt{\\frac{1}{n}\\sum_{i=1}^{n} e_i^2}\n$$\nwhere the residual $e_i$ for the $i$-th data point is:\n$$\ne_i = \\ln(\\sigma_{a,i}) - (\\hat{\\beta}_0 + \\hat{\\beta}_1 \\ln(N_i) + \\hat{\\beta}_2 \\ln(1 - R_i))\n$$\nThis corresponds directly to the standard definition of root-mean-square error for the linear regression. Given the noiseless data, we expect $\\text{RMSE}_{\\log} \\approx 0$.\n\nFinally, the mean stress sensitivity is categorized into an integer code $k$ based on the estimated value $\\hat{\\gamma}$, according to the specified thresholds:\n- $k = 0$ for negligible sensitivity: $|\\hat{\\gamma}|  0.05$.\n- $k = 1$ for moderate sensitivity: $0.05 \\le |\\hat{\\gamma}|  0.5$.\n- $k = 2$ for strong sensitivity: $|\\hat{\\gamma}| \\ge 0.5$.\n\nThis complete procedure will be executed for each of the three test cases provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the fatigue parameter estimation problem for three test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A\n        {\n            \"params\": (1600.0, 0.1, 0.5), # (C_true, b_true, gamma_true)\n            \"R_list\": [-1.0, 0.0, 0.5],\n            \"N_list\": [1e5, 1e6, 1e7]\n        },\n        # Test Case B\n        {\n            \"params\": (1500.0, 0.08, 0.0), # (C_true, b_true, gamma_true)\n            \"R_list\": [-1.0, 0.4],\n            \"N_list\": [1e5, 1e6, 1e7]\n        },\n        # Test Case C\n        {\n            \"params\": (2000.0, 0.12, 0.8), # (C_true, b_true, gamma_true)\n            \"R_list\": [0.0, 0.5, 0.9],\n            \"N_list\": [1e4, 1e5, 1e6]\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        C_true, b_true, gamma_true = case[\"params\"]\n        R_list = case[\"R_list\"]\n        N_list = case[\"N_list\"]\n\n        # 1. Generate synthetic data\n        data_points = []\n        for R_val in R_list:\n            for N_val in N_list:\n                # sigma_a = (C_true * N**(-b_true)) / ((1 - R)**gamma_true)\n                sigma_a = C_true * (N_val ** (-b_true)) * ((1 - R_val) ** (-gamma_true))\n                data_points.append({'sigma_a': sigma_a, 'R': R_val, 'N': N_val})\n        \n        n_points = len(data_points)\n\n        # 2. Estimate parameters using linear least-squares on the log-transformed model\n        # The model is: ln(sigma_a) = ln(C) - b*ln(N) - gamma*ln(1-R)\n        # This is a linear model y = beta_0 + beta_1*x1 + beta_2*x2 where:\n        # y = ln(sigma_a)\n        # x1 = ln(N)\n        # x2 = ln(1-R)\n        # beta_0 = ln(C)\n        # beta_1 = -b\n        # beta_2 = -gamma\n\n        # Construct the y vector and X matrix\n        y = np.array([np.log(p['sigma_a']) for p in data_points])\n        \n        X_T = np.array([\n            np.ones(n_points),\n            np.array([np.log(p['N']) for p in data_points]),\n            np.array([np.log(1 - p['R']) for p in data_points])\n        ])\n        X = X_T.T\n\n        # Solve the least-squares problem: X * beta = y\n        # The function returns: coefficients, residuals, rank, singular values\n        # We need the coefficients (beta_hat) and the sum of squared residuals.\n        solution = np.linalg.lstsq(X, y, rcond=None)\n        beta_hat = solution[0]\n        # Sum of squared residuals is returned in a list\n        sum_sq_residuals = solution[1][0] if solution[1].size > 0 else 0.0\n\n        # Recover the physical parameter estimates\n        hat_C = np.exp(beta_hat[0])\n        hat_b = -beta_hat[1]\n        hat_gamma = -beta_hat[2]\n\n        # 3. Compute the goodness-of-collapse metric RMSE_log\n        rmse_log = np.sqrt(sum_sq_residuals / n_points)\n\n        # 4. Interpret mean stress sensitivity\n        abs_hat_gamma = abs(hat_gamma)\n        if abs_hat_gamma  0.05:\n            k = 0\n        elif 0.05 = abs_hat_gamma  0.5:\n            k = 1\n        else:\n            k = 2\n\n        # Append the list of results for this case\n        results.append([hat_gamma, hat_b, hat_C, rmse_log, k])\n\n    # Format the final output string as per requirements\n    formatted_results = []\n    for res in results:\n        gamma, b, C, rmse, k_val = res\n        s = f\"[{gamma:.6f},{b:.6f},{C:.6f},{rmse:.6f},{k_val}]\"\n        formatted_results.append(s)\n\n    final_output = f\"[[{','.join(formatted_results)}]]\"\n    # The final output needs to be a single line. The problem description shows a different format.\n    # e.g., [[...],[...],[...]]. My join creates a single inner list.\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2682726"}]}