{"hands_on_practices": [{"introduction": "The first step in understanding motion is to decompose it into its fundamental parts: translation, rotation, and deformation. The vorticity vector, $\\boldsymbol{\\omega}$, is the primary measure of the local rate of rigid-body rotation. This exercise challenges you to do the opposite: to construct a velocity field that represents a pure deformation, meaning it has a non-zero rate-of-deformation tensor $\\mathbf{D}$ but a vanishing vorticity vector [@problem_id:2700488]. By exploring the properties of such an irrotational flow, you will build a solid foundation for distinguishing spin from strain, a crucial concept in kinematics.", "problem": "A three-dimensional, homogeneous deformation rate in a continuum (solid) can be modeled by a time-independent velocity field that is linear in the spatial coordinates. Starting from first principles appropriate to solid mechanics, specifically the component definitions of the spatial gradient and the curl, construct a smooth velocity field $\\mathbf{v}(\\mathbf{x})$ for which the vorticity vector $\\boldsymbol{\\omega}$ vanishes everywhere but the rate-of-deformation tensor $\\mathbf{D}$ is nonzero. Then interpret this kinematics as an irrotational pure strain by relating it to the absence of rigid-body spin.\n\nProceed as follows:\n- Begin from the fundamental definitions: the velocity gradient $\\mathbf{L}$ is the spatial gradient of $\\mathbf{v}$, the rate-of-deformation tensor is the symmetric part $\\mathbf{D} = (\\mathbf{L} + \\mathbf{L}^{T})/2$, and the vorticity vector is the curl $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$. Do not invoke vector calculus identities without justification; verify your claims using component-wise reasoning.\n- Propose a class of velocity fields that satisfies $\\boldsymbol{\\omega}=\\mathbf{0}$ while $\\mathbf{D}\\neq\\mathbf{0}$, and demonstrate these properties directly from the definitions.\n- Provide a concrete example by taking a scalar potential $\\phi(\\mathbf{x}) = \\tfrac{1}{2}\\,\\mathbf{x}^{T}\\mathbf{A}\\mathbf{x}$ with a constant symmetric matrix\n$$\n\\mathbf{A}=\\begin{pmatrix}\na & m & n\\\\\nm & b & p\\\\\nn & p & c\n\\end{pmatrix},\n$$\nwhere $a$, $b$, $c$, $m$, $n$, and $p$ are real constants with at least one nonzero.\n\nFor this concrete example, compute the second invariant of the rate-of-deformation tensor, defined by\n$$\nJ_{2} = \\tfrac{1}{2}\\Big[(\\operatorname{tr}\\mathbf{D})^{2} - \\operatorname{tr}(\\mathbf{D}^{2})\\Big],\n$$\nexpressing the result in terms of $a$, $b$, $c$, $m$, $n$, and $p$. Treat the entries of $\\mathbf{A}$ as having units of inverse time so that $J_{2}$ has units of $\\mathrm{s}^{-2}$. Express your final answer in $\\mathrm{s}^{-2}$. Do not include units in your boxed final answer. Your final answer must be a single closed-form analytic expression.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is rooted in the fundamental principles of continuum mechanics and is free of contradictions or ambiguities. Therefore, a rigorous solution can be constructed.\n\nWe begin from the first principles of kinematics in solid mechanics. The velocity field is denoted by $\\mathbf{v}(\\mathbf{x})$, where $\\mathbf{x}$ is the position vector with components $(x_1, x_2, x_3)$. The spatial velocity gradient tensor, $\\mathbf{L}$, is defined by its components $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$. This tensor can be decomposed into its symmetric and skew-symmetric parts:\n$$\n\\mathbf{L} = \\mathbf{D} + \\mathbf{W}\n$$\nwhere $\\mathbf{D}$ is the rate-of-deformation tensor and $\\mathbf{W}$ is the spin tensor. Their component definitions are:\n$$\nD_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} + \\frac{\\partial v_j}{\\partial x_i} \\right) = \\frac{1}{2} (L_{ij} + L_{ji})\n$$\n$$\nW_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} - \\frac{\\partial v_j}{\\partial x_i} \\right) = \\frac{1}{2} (L_{ij} - L_{ji})\n$$\nBy definition, $\\mathbf{D}$ is symmetric ($D_{ij} = D_{ji}$) and $\\mathbf{W}$ is skew-symmetric ($W_{ij} = -W_{ji}$).\n\nThe vorticity vector, $\\boldsymbol{\\omega}$, is defined as the curl of the velocity field: $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$. In component form, using the Levi-Civita symbol $\\epsilon_{kij}$:\n$$\n\\omega_k = \\epsilon_{kij} \\frac{\\partial v_j}{\\partial x_i}\n$$\nThe components of the vorticity vector are related to the components of the spin tensor. For example,\n$$\n\\omega_3 = \\epsilon_{3ij} \\frac{\\partial v_j}{\\partial x_i} = \\epsilon_{312} \\frac{\\partial v_2}{\\partial x_1} + \\epsilon_{321} \\frac{\\partial v_1}{\\partial x_2} = \\frac{\\partial v_2}{\\partial x_1} - \\frac{\\partial v_1}{\\partial x_2} = -2 W_{12}\n$$\nIn general, the relationship is $\\omega_k = -2 \\epsilon_{kij} W_{ij}$. From this, it is evident that the condition $\\boldsymbol{\\omega} = \\mathbf{0}$ is equivalent to the condition that all components of the spin tensor are zero, i.e., $\\mathbf{W} = \\mathbf{0}$.\n\nA motion is an irrotational pure strain if its spin tensor vanishes ($\\mathbf{W}=\\mathbf{0}$) but its rate-of-deformation tensor does not ($\\mathbf{D} \\neq \\mathbf{0}$). The condition $\\mathbf{W} = \\mathbf{0}$ implies that $\\mathbf{L} - \\mathbf{L}^T = \\mathbf{0}$, which means the velocity gradient tensor $\\mathbf{L}$ must be symmetric: $L_{ij} = L_{ji}$. This condition is\n$$\n\\frac{\\partial v_i}{\\partial x_j} = \\frac{\\partial v_j}{\\partial x_i}\n$$\nThis is precisely the condition for a vector field $\\mathbf{v}$ to be conservative, which, on a simply connected domain, guarantees the existence of a scalar potential $\\phi(\\mathbf{x})$ such that $\\mathbf{v} = \\nabla \\phi$. To verify this, let us assume such a potential exists. The components of velocity are $v_i = \\frac{\\partial \\phi}{\\partial x_i}$. The components of the velocity gradient are then:\n$$\nL_{ij} = \\frac{\\partial v_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( \\frac{\\partial \\phi}{\\partial x_i} \\right) = \\frac{\\partial^2 \\phi}{\\partial x_j \\partial x_i}\n$$\nFor a sufficiently smooth potential $\\phi$, the order of partial differentiation is immaterial (Clairaut's theorem), so $L_{ij} = \\frac{\\partial^2 \\phi}{\\partial x_i \\partial x_j} = L_{ji}$. Thus, $\\mathbf{L}$ is symmetric. This confirms that the class of velocity fields derived from a scalar potential, $\\mathbf{v} = \\nabla \\phi$, is irrotational. For this class of motion, $\\mathbf{L}$ is symmetric, so $\\mathbf{W} = \\mathbf{0}$ and $\\mathbf{D} = \\mathbf{L}$. The condition $\\mathbf{D} \\neq \\mathbf{0}$ simply requires that the Hessian matrix of the potential $\\phi$, given by $H_{ij} = \\frac{\\partial^2 \\phi}{\\partial x_i \\partial x_j}$, is not the zero matrix.\n\nWe now turn to the concrete example provided. The scalar potential is given as a quadratic form:\n$$\n\\phi(\\mathbf{x}) = \\frac{1}{2} \\mathbf{x}^T \\mathbf{A} \\mathbf{x} = \\frac{1}{2} x_i A_{ij} x_j\n$$\nwhere $\\mathbf{A}$ is a constant, symmetric matrix. We compute the velocity field $\\mathbf{v} = \\nabla \\phi$. The $k$-th component is:\n$$\nv_k = \\frac{\\partial \\phi}{\\partial x_k} = \\frac{1}{2} \\frac{\\partial}{\\partial x_k} (x_i A_{ij} x_j) = \\frac{1}{2} \\left[ (\\delta_{ik} A_{ij} x_j) + (x_i A_{ij} \\delta_{jk}) \\right] = \\frac{1}{2} (A_{kj} x_j + x_i A_{ik})\n$$\nSince $\\mathbf{A}$ is symmetric, $A_{ik} = A_{ki}$. Thus, $x_i A_{ik} = x_i A_{ki} = A_{ki} x_i$. Renaming the dummy summation index $i$ to $j$ gives $A_{kj} x_j$. Therefore:\n$$\nv_k = \\frac{1}{2} (A_{kj} x_j + A_{kj} x_j) = A_{kj} x_j\n$$\nIn matrix form, this is $\\mathbf{v}(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}$. This is a linear velocity field as specified.\nThe velocity gradient is $L_{ij} = \\frac{\\partial v_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j}(A_{ik}x_k) = A_{ik}\\delta_{jk} = A_{ij}$. So, $\\mathbf{L} = \\mathbf{A}$.\nSince $\\mathbf{A}$ is symmetric, $\\mathbf{L}$ is symmetric. This immediately implies that the spin tensor $\\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^T) = \\frac{1}{2}(\\mathbf{A} - \\mathbf{A}^T) = \\mathbf{0}$, and thus the vorticity $\\boldsymbol{\\omega} = \\mathbf{0}$.\nThe rate-of-deformation tensor is $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^T) = \\frac{1}{2}(\\mathbf{A} + \\mathbf{A}^T) = \\mathbf{A}$. The problem states that at least one constant in $\\mathbf{A}$ is nonzero, so $\\mathbf{A} \\neq \\mathbf{0}$, which means $\\mathbf{D} \\neq \\mathbf{0}$. This velocity field therefore correctly models an irrotational pure strain.\n\nThe final task is to compute the second invariant of $\\mathbf{D}$, which is $J_2 = \\frac{1}{2}[(\\operatorname{tr}\\mathbf{D})^2 - \\operatorname{tr}(\\mathbf{D}^2)]$. With $\\mathbf{D}=\\mathbf{A}$, we have:\n$$\nJ_2 = \\frac{1}{2}[(\\operatorname{tr}\\mathbf{A})^2 - \\operatorname{tr}(\\mathbf{A}^2)]\n$$\nThe matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A}=\\begin{pmatrix}\na & m & n\\\\\nm & b & p\\\\\nn & p & c\n\\end{pmatrix}\n$$\nThe trace of $\\mathbf{A}$ is the sum of its diagonal elements:\n$$\n\\operatorname{tr}\\mathbf{A} = a + b + c\n$$\nNext, we compute $\\mathbf{A}^2$:\n$$\n\\mathbf{A}^2 = \\begin{pmatrix}\na & m & n\\\\\nm & b & p\\\\\nn & p & c\n\\end{pmatrix} \\begin{pmatrix}\na & m & n\\\\\nm & b & p\\\\\nn & p & c\n\\end{pmatrix} = \\begin{pmatrix}\na^2+m^2+n^2 & am+mb+np & an+mp+nc \\\\\nma+bm+pn & m^2+b^2+p^2 & mn+bp+pc \\\\\nna+pm+cn & nm+pb+cp & n^2+p^2+c^2\n\\end{pmatrix}\n$$\nThe trace of $\\mathbf{A}^2$ is the sum of its diagonal elements:\n$$\n\\operatorname{tr}(\\mathbf{A}^2) = (a^2+m^2+n^2) + (m^2+b^2+p^2) + (n^2+p^2+c^2)\n$$\n$$\n\\operatorname{tr}(\\mathbf{A}^2) = a^2+b^2+c^2+2m^2+2n^2+2p^2\n$$\nNow, we substitute these traces into the expression for $J_2$:\n$$\nJ_2 = \\frac{1}{2} \\left[ (a+b+c)^2 - (a^2+b^2+c^2+2m^2+2n^2+2p^2) \\right]\n$$\nExpanding the squared term gives $(a+b+c)^2 = a^2+b^2+c^2+2ab+2ac+2bc$.\n$$\nJ_2 = \\frac{1}{2} \\left[ (a^2+b^2+c^2+2ab+2ac+2bc) - (a^2+b^2+c^2+2m^2+2n^2+2p^2) \\right]\n$$\nSimplifying the expression by canceling terms:\n$$\nJ_2 = \\frac{1}{2} \\left[ 2ab+2ac+2bc - 2m^2 - 2n^2 - 2p^2 \\right]\n$$\n$$\nJ_2 = ab+ac+bc - m^2 - n^2 - p^2\n$$\nThe entries of $\\mathbf{A}$ have units of $\\mathrm{s}^{-1}$, so each term in the final expression for $J_2$ (e.g., $ab$, $m^2$) has units of $\\mathrm{s}^{-2}$, as required.", "answer": "$$\n\\boxed{ab+ac+bc - m^{2} - n^{2} - p^{2}}\n$$", "id": "2700488"}, {"introduction": "In infinitesimal deformations, the total rotation can be found by simply integrating the rate of rotation over time. However, in the world of finite deformations, this simple relationship breaks down. This practice problem delves into this subtlety by examining a simple shear flow, where you will compare the rotation calculated by integrating the spin rate (derived from vorticity) with the true material rotation obtained from the polar decomposition of the deformation gradient [@problem_id:2700460]. Quantifying the error between these two measures provides a deep insight into the non-commutative nature of finite rotations and the necessity of more sophisticated kinematic treatments.", "problem": "Consider a two-dimensional, plane, incompressible simple shear of a solid in the $x$–$y$ plane, with spatial velocity field $\\mathbf{v}(x,y,t) = \\big(\\dot{\\gamma}\\, y,\\, 0\\big)$, where $\\dot{\\gamma} > 0$ is constant. Let the deformation gradient $\\mathbf{F}(t)$ evolve from the stress-free reference configuration with $\\mathbf{F}(0) = \\mathbf{I}$ according to the kinematic relation $\\dot{\\mathbf{F}} = \\mathbf{L}\\,\\mathbf{F}$, where $\\mathbf{L} = \\nabla \\mathbf{v}$ is the spatial velocity gradient. Let the spin tensor be $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{T})$ and the vorticity vector be $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$, whose $z$-component is denoted $\\omega_{z}$. Define the right polar decomposition $\\mathbf{F}(t) = \\mathbf{R}(t)\\,\\mathbf{U}(t)$, where $\\mathbf{R}(t) \\in SO(3)$ (the special orthogonal group in three dimensions) is the finite rotation and $\\mathbf{U}(t)$ is the right stretch.\n\nTwo time-accumulated measures of rotation are considered over an interval $[0,T]$:\n1. The spin-integrated approximation, $\\theta_{W}(T)$, obtained by integrating the instantaneous rigid-body rotation rate implied by the vorticity, i.e., $\\theta_{W}(T) = \\int_{0}^{T} \\frac{\\omega_{z}(t)}{2}\\,dt$.\n2. The finite polar rotation, $\\theta_{R}(T)$, defined as the unique angle in radians such that, when restricted to the $x$–$y$ plane, $\\mathbf{R}(T)$ is the planar rotation by $\\theta_{R}(T)$ that appears in the right polar decomposition of $\\mathbf{F}(T)$.\n\nUsing only the core kinematic definitions above, derive an exact, closed-form analytical expression for the error\n$$\n\\varepsilon(k) = \\theta_{W}(T) - \\theta_{R}(T),\n$$\nexpressed in terms of the accumulated shear $k = \\dot{\\gamma}\\,T$. Express your final expression for $\\varepsilon(k)$ in radians. No numerical evaluation or rounding is required; provide a closed-form expression in $k$ only.", "solution": "The problem requires the derivation of an expression for the error $\\varepsilon(k) = \\theta_{W}(T) - \\theta_{R}(T)$, where $\\theta_{W}(T)$ is the rotation angle obtained by integrating the vorticity-based spin rate, and $\\theta_{R}(T)$ is the rotation angle from the polar decomposition of the deformation gradient. The accumulated shear is given by $k = \\dot{\\gamma}T$. The analysis proceeds from the fundamental kinematic definitions provided.\n\nFirst, we determine the spatial velocity gradient tensor, $\\mathbf{L}$, defined as $\\mathbf{L} = \\nabla\\mathbf{v}$. The given velocity field is $\\mathbf{v} = (\\dot{\\gamma}y, 0, 0)$. The components of $\\mathbf{L}$, $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$, are calculated. The only non-zero component is $L_{12} = \\frac{\\partial}{\\partial y}(\\dot{\\gamma}y) = \\dot{\\gamma}$. Thus, the matrix representation of $\\mathbf{L}$ is:\n$$\n\\mathbf{L} = \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nSince $\\dot{\\gamma}$ is a constant, $\\mathbf{L}$ is constant in time.\n\nNext, we solve for the deformation gradient $\\mathbf{F}(t)$ using the evolution equation $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$ with the initial condition $\\mathbf{F}(0) = \\mathbf{I}$. For a constant $\\mathbf{L}$, this linear ordinary differential equation system has the solution $\\mathbf{F}(t) = \\exp(t\\mathbf{L})\\mathbf{F}(0) = \\exp(t\\mathbf{L})$. We compute the matrix exponential:\n$$\n\\exp(t\\mathbf{L}) = \\mathbf{I} + t\\mathbf{L} + \\frac{(t\\mathbf{L})^2}{2!} + \\dots\n$$\nThe square of the matrix $t\\mathbf{L}$ is:\n$$\n(t\\mathbf{L})^2 = \\begin{pmatrix} 0 & t\\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & t\\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\mathbf{0}\n$$\nSince $(t\\mathbf{L})^2$ is the zero matrix, all higher powers are also zero. The series for the exponential truncates, yielding $\\mathbf{F}(t) = \\mathbf{I} + t\\mathbf{L}$.\nLet $\\gamma(t) = \\dot{\\gamma}t$ be the amount of shear at time $t$. Then:\n$$\n\\mathbf{F}(t) = \\begin{pmatrix} 1 & \\gamma(t) & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\nWe now calculate the first measure of rotation, $\\theta_{W}(T)$. This requires the vorticity vector $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$.\n$$\n\\boldsymbol{\\omega} = \\left( \\frac{\\partial v_z}{\\partial y} - \\frac{\\partial v_y}{\\partial z}, \\frac{\\partial v_x}{\\partial z} - \\frac{\\partial v_z}{\\partial x}, \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y} \\right) = (0, 0, 0 - \\dot{\\gamma}) = (0, 0, -\\dot{\\gamma})\n$$\nThe $z$-component is $\\omega_z = -\\dot{\\gamma}$, which is constant. The spin-integrated rotation is defined as:\n$$\n\\theta_{W}(T) = \\int_{0}^{T} \\frac{\\omega_{z}(t)}{2}\\,dt = \\int_{0}^{T} \\frac{-\\dot{\\gamma}}{2}\\,dt = -\\frac{\\dot{\\gamma}T}{2}\n$$\nIn terms of the total accumulated shear $k = \\dot{\\gamma}T$, this is:\n$$\n\\theta_{W}(T) = -\\frac{k}{2}\n$$\n\nNext, we determine the finite polar rotation, $\\theta_{R}(T)$, from the right polar decomposition $\\mathbf{F}(t) = \\mathbf{R}(t)\\mathbf{U}(t)$. At time $T$, we have $k = \\dot{\\gamma}T$. The right stretch tensor $\\mathbf{U}$ must be symmetric and positive-definite, and the rotation tensor $\\mathbf{R}$ must be proper orthogonal. Let the planar part of $\\mathbf{R}(T)$ be a rotation by angle $\\theta_R$:\n$$\n\\mathbf{R}_{2D}(T) = \\begin{pmatrix} \\cos\\theta_{R} & -\\sin\\theta_{R} \\\\ \\sin\\theta_{R} & \\cos\\theta_{R} \\end{pmatrix}\n$$\nFrom the decomposition, we can write $\\mathbf{U} = \\mathbf{R}^T \\mathbf{F}$. Substituting the planar parts:\n$$\n\\mathbf{U}_{2D}(T) = \\mathbf{R}_{2D}^T(T) \\mathbf{F}_{2D}(T) = \\begin{pmatrix} \\cos\\theta_{R} & \\sin\\theta_{R} \\\\ -\\sin\\theta_{R} & \\cos\\theta_{R} \\end{pmatrix} \\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta_{R} & k\\cos\\theta_{R} + \\sin\\theta_{R} \\\\ -\\sin\\theta_{R} & -k\\sin\\theta_{R} + \\cos\\theta_{R} \\end{pmatrix}\n$$\nFor $\\mathbf{U}_{2D}$ to be symmetric, its off-diagonal components must be equal. Thus:\n$$\nk\\cos\\theta_{R} + \\sin\\theta_{R} = -\\sin\\theta_{R}\n$$\nThis simplifies to $k\\cos\\theta_{R} = -2\\sin\\theta_{R}$. Since $\\dot{\\gamma} > 0$, we have $k>0$. For non-trivial shear, $\\cos\\theta_R$ cannot be zero, so we can divide by it:\n$$\n\\tan(\\theta_{R}) = \\frac{\\sin\\theta_{R}}{\\cos\\theta_{R}} = -\\frac{k}{2}\n$$\nFor small positive shear $k$, we expect a small negative (clockwise) rotation. In this case, $\\theta_R$ is in the fourth quadrant, where $\\cos\\theta_R > 0$ and $\\sin\\theta_R  0$. The arctangent function gives the unique angle in $(-\\pi/2, \\pi/2)$, which satisfies these conditions. Therefore:\n$$\n\\theta_{R}(T) = \\arctan\\left(-\\frac{k}{2}\\right) = -\\arctan\\left(\\frac{k}{2}\\right)\n$$\nFinally, we compute the error $\\varepsilon(k) = \\theta_{W}(T) - \\theta_{R}(T)$:\n$$\n\\varepsilon(k) = \\left( -\\frac{k}{2} \\right) - \\left( -\\arctan\\left(\\frac{k}{2}\\right) \\right) = \\arctan\\left(\\frac{k}{2}\\right) - \\frac{k}{2}\n$$\nThis is the required closed-form analytical expression for the error in terms of the accumulated shear $k$.", "answer": "$$\n\\boxed{\\arctan\\left(\\frac{k}{2}\\right) - \\frac{k}{2}}\n$$", "id": "2700460"}, {"introduction": "The theoretical principles of kinematics and objectivity find their ultimate test in the development of computational models. A robust simulation must produce results that are independent of the observer's frame of reference, a property known as frame invariance. This exercise transitions from analytical derivation to computational implementation, tasking you with creating a numerical algorithm that correctly updates an internal material state variable in the presence of material spin [@problem_id:2700502]. By using the vorticity vector to drive a corotational update, you will learn a fundamental technique for ensuring the objectivity of constitutive models in finite-element analysis.", "problem": "You are tasked with designing and implementing a principled time-stepping algorithm for updating a spin-dependent internal vector-valued variable in finite-deformation solid mechanics while preserving frame invariance (objectivity) of the stored energy. The target is to start from first principles and produce a robust update that uses the vorticity vector. Your final program must compute results for a specified test suite and print them in a single prescribed format.\n\nConsider a spatial velocity field with spatial velocity gradient $\\mathbf{L} = \\nabla \\mathbf{v}$. The local material spin is described by the spin tensor $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$. The axial vector of the spin tensor is the local angular velocity $\\mathbf{w}$. The vorticity vector $\\boldsymbol{\\omega}$ is defined as $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$, and is related to the angular velocity by $\\boldsymbol{\\omega} = 2\\mathbf{w}$. Let $\\mathbf{a}(t) \\in \\mathbb{R}^{3}$ denote a spatial internal vector whose evolution may depend on the local spin; assume the stored energy density depends on $\\mathbf{a}$ only through the quadratic form $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$ with $k  0$ constant. Frame invariance (objectivity) requires that superposed rigid body motions do not alter the stored energy; equivalently, if $\\mathbf{S}(t)$ is any proper orthogonal tensor, then a superposed rigid rotation $\\mathbf{a} \\mapsto \\mathbf{S}\\mathbf{a}$ must leave $\\psi$ unchanged. Your task is to derive, from first principles and core definitions only, an algorithmic update of $\\mathbf{a}$ over a single time step that uses the vorticity vector $\\boldsymbol{\\omega}$ in such a way that $\\psi$ remains invariant under arbitrary superposed rigid rotations.\n\nSpecifically, over a single time step of duration $\\Delta t$, suppose that within the step the spin is generated by the local angular velocity $\\mathbf{w} = \\boldsymbol{\\omega}/2$, and that the intrinsic (dissipative) evolution of $\\mathbf{a}$ occurs in a corotating frame via a linear relaxation $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$ with $\\lambda \\ge 0$ constant, where $\\widehat{\\mathbf{a}}$ denotes the internal variable expressed in the corotating frame. Your derivation should begin from the definitions of $\\mathbf{W}$, $\\boldsymbol{\\omega}$, and objectivity; it must use a physically sound finite rotation over the step induced by the spin, and it must articulate how to transform to and from the corotating frame to ensure that the stored energy density $\\psi$ is unaffected by superposed rigid motions. Do not assume any “shortcut” constitutive update formulas; instead, justify each step from the foundational kinematic definitions and the requirement of objectivity.\n\nImplementation requirements:\n- Use the exact finite rotation induced by the spin over the step as generated by the skew-symmetric operator corresponding to the local angular velocity $\\mathbf{w} = \\boldsymbol{\\omega}/2$ held constant during the step. Angles must be in radians. \n- Use the corotational update consistent with the objectivity requirement, where the dissipative model $G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$ acts in the corotating frame.\n- The stored energy is $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$. Numerically verify energy invariance where appropriate.\n- All inputs are dimensionless; no physical unit conversions are required. \n\nTest suite to implement and evaluate:\n1. Pure rigid-body spin, no dissipation (energy conservation): \n   - Initial internal vector $\\mathbf{a}_{0} = [\\,1.2,\\,-0.7,\\,0.3\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,0,\\,0,\\,10\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.01$.\n   - Relaxation parameter $\\lambda = 0$.\n   - Stiffness $k = 2.0$.\n   - Output a boolean indicating whether the energy is conserved within a tolerance of $10^{-10}$ over one step.\n\n2. Frame invariance under superposed rigid rotation (objectivity check):\n   - Initial internal vector $\\mathbf{a}_{0} = [\\,0.3,\\,0.5,\\,-1.1\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,2.0,\\,-1.0,\\,0.5\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.02$.\n   - Relaxation parameter $\\lambda = 0$.\n   - Stiffness $k = 3.0$.\n   - Superposed rigid rotation $\\mathbf{S}$: rotation about the $x$-axis by angle $\\theta_{\\mathrm{s}} = 0.8$ radians (i.e., a proper orthogonal matrix corresponding to this axis-angle).\n   - Compute the update in two ways over one step: (A) in the original frame; (B) in the rotated frame starting from $\\mathbf{a}'_{0} = \\mathbf{S}\\mathbf{a}_{0}$ with $\\boldsymbol{\\omega}' = \\mathbf{S}\\boldsymbol{\\omega}$, and then map the result back by $\\mathbf{S}^{\\mathsf{T}}$. Output a boolean that is true if both the updated vectors satisfy $\\mathbf{a}_{1} = \\mathbf{S}^{\\mathsf{T}} \\mathbf{a}'_{1}$ within a tolerance of $10^{-10}$ and the final energies match within $10^{-10}$.\n\n3. Zero spin with dissipation (energy ratio):\n   - Initial internal vector $\\mathbf{a}_{0} = [\\,1.0,\\,2.0,\\,-1.0\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,0,\\,0,\\,0\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.02$.\n   - Relaxation parameter $\\lambda = 5.0$.\n   - Stiffness $k = 1.5$.\n   - Output the float ratio $\\psi(\\mathbf{a}_{1})/\\psi(\\mathbf{a}_{0})$ after one step.\n\n4. Combined spin and dissipation (objectivity of energy change under rotation):\n   - Initial internal vector $\\mathbf{a}_{0} = [\\,0.2,\\,-0.3,\\,0.4\\,]^{\\mathsf{T}}$.\n   - Vorticity vector $\\boldsymbol{\\omega} = [\\,4.0,\\,3.0,\\,0.0\\,]^{\\mathsf{T}}$.\n   - Time step $\\Delta t = 0.005$.\n   - Relaxation parameter $\\lambda = 20.0$.\n   - Stiffness $k = 0.7$.\n   - Output a boolean that is true if the energy ratio $\\psi(\\mathbf{a}_{1})/\\psi(\\mathbf{a}_{0})$ matches the value predicted by dissipation alone in the corotating frame, namely $(1-\\lambda \\Delta t)^{2}$, within a tolerance of $10^{-12}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the four test cases above. For example, the format must be exactly like $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$, where the first, second, and fourth entries are booleans and the third is a float.", "solution": "The goal is to construct a time discretization for a spin-dependent internal vector $\\mathbf{a} \\in \\mathbb{R}^{3}$ that preserves frame invariance (objectivity) of the quadratic stored energy $\\psi(\\mathbf{a}) = \\tfrac{1}{2} k \\lVert \\mathbf{a} \\rVert^{2}$, starting from fundamental definitions.\n\nFundamental kinematics and corotational frames:\n- The physical state is described by the vector $\\mathbf{a}(t)$ in the current spatial frame and a corresponding vector $\\widehat{\\mathbf{a}}(t)$ in a corotating material frame. These vectors are related by a time-dependent rotation tensor $\\mathbf{R}(t)$, such that $\\mathbf{a}(t) = \\mathbf{R}(t)\\widehat{\\mathbf{a}}(t)$.\n- The corotating frame is defined as one that spins with the local angular velocity of the material, $\\mathbf{w}$. This implies that its rotation tensor evolves according to $\\dot{\\mathbf{R}}(t) = \\mathbf{W}(t)\\mathbf{R}(t)$, where $\\mathbf{W}$ is the spin tensor. The spin tensor is the skew-symmetric matrix whose axial vector is $\\mathbf{w}$.\n- The vorticity vector $\\boldsymbol{\\omega}$ is given, and it relates to the angular velocity by $\\mathbf{w} = \\boldsymbol{\\omega}/2$.\n- The intrinsic evolution law is given in the material frame: $\\dot{\\widehat{\\mathbf{a}}} = G(\\widehat{\\mathbf{a}}) = -\\lambda \\widehat{\\mathbf{a}}$. This separation of kinematics (rotation) from intrinsic physics (dissipation) is the core of corotational formulations.\n\nObjective time-stepping algorithm:\nTo derive an algorithm to update the state from $\\mathbf{a}_n$ at time $t_n$ to $\\mathbf{a}_{n+1}$ at time $t_{n+1}=t_n+\\Delta t$, we use an operator-split approach that respects this separation.\n1. **Map to Material Frame:** At the beginning of the time step, $t_n$, we can align the material frame with the spatial frame, so we set $\\mathbf{R}(t_n) = \\mathbf{I}$. This means the vector representations are identical at this instant: $\\widehat{\\mathbf{a}}_n = \\mathbf{R}(t_n)^{\\mathsf{T}}\\mathbf{a}_n = \\mathbf{a}_n$.\n2. **Evolve in Material Frame:** We solve for the evolution of $\\widehat{\\mathbf{a}}$ over the time step. A first-order explicit Euler approximation to the solution of $\\dot{\\widehat{\\mathbf{a}}} = -\\lambda \\widehat{\\mathbf{a}}$ is $\\widehat{\\mathbf{a}}_{n+1} \\approx \\widehat{\\mathbf{a}}_n + \\Delta t G(\\widehat{\\mathbf{a}}_n) = \\widehat{\\mathbf{a}}_n(1-\\lambda\\Delta t)$. Substituting from step 1 gives $\\widehat{\\mathbf{a}}_{n+1} \\approx \\mathbf{a}_n(1-\\lambda\\Delta t)$.\n3. **Evolve the Rotation:** We solve for the rotation of the material frame over the time step. Assuming the angular velocity $\\mathbf{w}$ is constant during the step, the solution to $\\dot{\\mathbf{R}} = \\mathbf{W R}$ is $\\mathbf{R}(t_{n+1}) = \\exp(\\Delta t \\, \\mathbf{W}) \\mathbf{R}(t_n)$. The finite rotation over the step is thus $\\mathbf{Q} = \\exp(\\Delta t \\, \\mathbf{W})$. The spin tensor $\\mathbf{W}$ is generated from the local angular velocity $\\mathbf{w} = \\boldsymbol{\\omega}/2$, so $\\mathbf{W} = \\operatorname{skew}(\\boldsymbol{\\omega}/2)$.\n4. **Map Back to Spatial Frame:** Finally, we map the updated material vector $\\widehat{\\mathbf{a}}_{n+1}$ back to the spatial frame at time $t_{n+1}$ to get the final result $\\mathbf{a}_{n+1}$.\n   $$\n   \\mathbf{a}_{n+1} = \\mathbf{R}(t_{n+1}) \\widehat{\\mathbf{a}}_{n+1} \\approx \\mathbf{Q} \\left( \\mathbf{a}_n(1-\\lambda\\Delta t) \\right)\n   $$\nSince scalar multiplication commutes, the final update rule is:\n$$\n\\mathbf{a}_{n+1} = (1 - \\lambda\\Delta t) \\mathbf{Q} \\mathbf{a}_n\n$$\nThis algorithm is objective because, under a superposed rotation $\\mathbf{S}$, $\\mathbf{a}_n \\to \\mathbf{S}\\mathbf{a}_n$ and $\\mathbf{Q} \\to \\mathbf{S}\\mathbf{Q}\\mathbf{S}^{\\mathsf{T}}$, which leads to $\\mathbf{a}_{n+1} \\to (1 - \\lambda\\Delta t) (\\mathbf{S}\\mathbf{Q}\\mathbf{S}^{\\mathsf{T}}) (\\mathbf{S}\\mathbf{a}_n) = \\mathbf{S} (1 - \\lambda\\Delta t) \\mathbf{Q} \\mathbf{a}_n = \\mathbf{S}\\mathbf{a}_{n+1}$. The vector transforms correctly.\n\nEnergy considerations:\nThe energy after one step is $\\psi(\\mathbf{a}_{n+1}) = \\frac{1}{2} k \\lVert \\mathbf{a}_{n+1} \\rVert^2$. Substituting the update rule:\n$$\n\\psi(\\mathbf{a}_{n+1}) = \\frac{1}{2} k \\lVert (1 - \\lambda\\Delta t) \\mathbf{Q} \\mathbf{a}_n \\rVert^2 = (1 - \\lambda\\Delta t)^2 \\frac{1}{2} k \\lVert \\mathbf{Q} \\mathbf{a}_n \\rVert^2\n$$\nSince $\\mathbf{Q}$ is a rotation, it preserves norms: $\\lVert \\mathbf{Q} \\mathbf{a}_n \\rVert = \\lVert \\mathbf{a}_n \\rVert$. Therefore:\n$$\n\\psi(\\mathbf{a}_{n+1}) = (1 - \\lambda\\Delta t)^2 \\left( \\frac{1}{2} k \\lVert \\mathbf{a}_n \\rVert^2 \\right) = (1 - \\lambda\\Delta t)^2 \\psi(\\mathbf{a}_n)\n$$\nThe energy ratio $\\psi(\\mathbf{a}_{n+1})/\\psi(\\mathbf{a}_n) = (1 - \\lambda\\Delta t)^2$. This shows that the energy dissipation depends only on the intrinsic parameter $\\lambda$ and is independent of the rotation, which is a key property of an objective formulation. If $\\lambda=0$ (no dissipation), the ratio is 1, and energy is conserved.\n\nTest suite expectations based on this correct algorithm:\n1. With $\\lambda = 0$, the energy ratio is 1. Test passes (`True`).\n2. The algorithm is objective as proven above. Test passes (`True`).\n3. With $\\boldsymbol{\\omega} = \\mathbf{0}$, $\\mathbf{Q}=\\mathbf{I}$, so $\\mathbf{a}_{n+1} = (1 - \\lambda\\Delta t) \\mathbf{a}_n$. The energy ratio is $(1 - \\lambda\\Delta t)^2 = (1 - 5.0 \\times 0.02)^2 = 0.9^2 = 0.81$. The result is `0.81`.\n4. The energy ratio is always $(1 - \\lambda\\Delta t)^2$ regardless of rotation. Here, this is $(1 - 20.0 \\times 0.005)^2 = 0.9^2 = 0.81$. The computed ratio will match this. Test passes (`True`).", "answer": "```python\nimport numpy as np\n\ndef skew_from_vec(v):\n    \"\"\"Creates a skew-symmetric matrix from a 3-vector.\"\"\"\n    vx, vy, vz = v\n    return np.array([[0.0, -vz, vy],\n                     [vz,  0.0, -vx],\n                     [-vy, vx,  0.0]], dtype=float)\n\ndef rotation_from_spin_vec_dt(spin_vec, dt, tol=1e-12):\n    \"\"\"\n    Computes the finite rotation matrix Q = exp(dt * W) from a spin vector `spin_vec` (e.g., angular velocity w).\n    W = skew(spin_vec).\n    \"\"\"\n    spin_vec = np.asarray(spin_vec, dtype=float).reshape(3)\n    angle = np.linalg.norm(spin_vec) * dt\n    \n    if angle  tol:\n        # Small-angle series for stability: Q ≈ I + dt*W + 0.5*(dt*W)^2\n        Wdt = skew_from_vec(spin_vec) * dt\n        return np.eye(3) + Wdt + 0.5 * (Wdt @ Wdt)\n    \n    # Axis-angle Rodrigues' formula\n    axis = spin_vec / np.linalg.norm(spin_vec)\n    K = skew_from_vec(axis)\n    s = np.sin(angle)\n    c = np.cos(angle)\n    return np.eye(3) + s * K + (1.0 - c) * (K @ K)\n\ndef objective_update_a(a_n, omega, dt, lam):\n    \"\"\"\n    Performs a one-step objective update of an internal vector 'a' using an\n    operator-split corotational method.\n    \"\"\"\n    # 1. Get the local angular velocity w from the vorticity omega.\n    w = 0.5 * omega\n    \n    # 2. Compute the finite rotation Q over the time step.\n    Q = rotation_from_spin_vec_dt(w, dt)\n    \n    # 3. Apply the operator-split update: a_{n+1} = (1-lam*dt) * Q * a_n\n    # First, rotate the vector with the material.\n    a_rotated = Q @ a_n\n    # Second, apply the intrinsic dissipative evolution.\n    a_np1 = (1.0 - lam * dt) * a_rotated\n    \n    return a_np1\n\ndef energy(a, k):\n    return 0.5 * k * float(a @ a)\n\ndef test_case_1():\n    a0 = np.array([1.2, -0.7, 0.3], dtype=float)\n    omega = np.array([0.0, 0.0, 10.0], dtype=float)\n    dt = 0.01\n    lam = 0.0\n    k = 2.0\n    E0 = energy(a0, k)\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    return abs(E1 - E0) = 1e-10\n\ndef rotation_about_x(theta):\n    c = np.cos(theta)\n    s = np.sin(theta)\n    return np.array([[1.0, 0.0, 0.0],\n                     [0.0, c,   -s ],\n                     [0.0, s,    c ]], dtype=float)\n\ndef test_case_2():\n    a0 = np.array([0.3, 0.5, -1.1], dtype=float)\n    omega = np.array([2.0, -1.0, 0.5], dtype=float)\n    dt = 0.02\n    lam = 0.0\n    k = 3.0\n    # Frame A\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    # Superposed rotation S about x by 0.8 rad\n    theta_s = 0.8\n    S = rotation_about_x(theta_s)\n    # Transform to frame B\n    a0p = S @ a0\n    omegap = S @ omega\n    # Update in frame B\n    a1p = objective_update_a(a0p, omegap, dt, lam)\n    # Map back to frame A\n    a1_back = S.T @ a1p\n    E1p = energy(a1p, k)  # energy is frame-invariant with same k\n    same_vec = np.allclose(a1_back, a1, atol=1e-10, rtol=0.0)\n    same_energy = abs(E1p - E1) = 1e-10\n    return bool(same_vec and same_energy)\n\ndef test_case_3():\n    a0 = np.array([1.0, 2.0, -1.0], dtype=float)\n    omega = np.array([0.0, 0.0, 0.0], dtype=float)\n    dt = 0.02\n    lam = 5.0\n    k = 1.5\n    E0 = energy(a0, k)\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    # E0 can be zero if a0 is zero, handle division by zero.\n    ratio = E1 / E0 if E0 > 1e-12 else 0.0\n    return float(ratio)\n\ndef test_case_4():\n    a0 = np.array([0.2, -0.3, 0.4], dtype=float)\n    omega = np.array([4.0, 3.0, 0.0], dtype=float)\n    dt = 0.005\n    lam = 20.0\n    k = 0.7\n    E0 = energy(a0, k)\n    a1 = objective_update_a(a0, omega, dt, lam)\n    E1 = energy(a1, k)\n    ratio = E1 / E0 if E0 > 1e-12 else 0.0\n    expected = (1.0 - lam * dt) ** 2\n    return abs(ratio - expected) = 1e-12\n\ndef solve():\n    results = []\n    results.append(test_case_1())\n    results.append(test_case_2())\n    results.append(test_case_3())\n    results.append(test_case_4())\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2700502"}]}