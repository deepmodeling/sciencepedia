{"hands_on_practices": [{"introduction": "To effectively implement a radial return algorithm, one must first have a clear, sequential blueprint. This exercise challenges you to assemble the complete algorithmic flowchart for a standard von Mises plasticity model at a single material point, which forms the heart of a user material subroutine in a Finite Element code. By correctly identifying the sequence from trial stress calculation to the update of state variables and the crucial algorithmic tangent, you will build a solid foundation for robust implementation and debugging. [@problem_id:2678297]", "problem": "Consider a single material integration point in a Finite Element (FE) computation for small-strain, associative von Mises ($J_2$) elastoplasticity with isotropic hardening, integrated implicitly by a backward-Euler radial return mapping. The material has linear elasticity with bulk modulus $\\kappa$ and shear modulus $\\mu$, and an isotropic hardening yield stress $\\sigma_{y}(\\alpha)$ with tangent $H' = d\\sigma_{y}/d\\alpha$. The state at step $n$ consists of Cauchy stress $\\boldsymbol{\\sigma}_{n}$, plastic strain $\\boldsymbol{\\varepsilon}^{p}_{n}$, and equivalent plastic strain $\\alpha_{n}$. At step $n+1$, the input is a total strain increment $\\Delta \\boldsymbol{\\varepsilon}$ and the material parameters at the current temperature. The update must output the Cauchy stress $\\boldsymbol{\\sigma}_{n+1}$ and the symmetric algorithmic consistent tangent $\\mathbb{C}_{n+1}$, along with updated internal variables. Assume small-strain kinematics and a standard associative flow rule and Kuhn–Tucker conditions for rate-independent plasticity. No additional kinematic hardening is present.\n\nWhich option most accurately and completely specifies the algorithmic sequence in correct order, the data dependencies linking inputs, state, and outputs, and realistic, common sources of implementation bugs to guard against, for a robust radial return implementation at a single integration point?\n\nA. Sequence and dependencies:\n- Inputs: $\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$, $\\kappa$, $\\mu$, $\\sigma_{y}(\\cdot)$.\n- Compute elastic trial stress $\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}$ with $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$.\n- Check yield using $f_{\\mathrm{tr}} = \\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$.\n- If $f_{\\mathrm{tr}} \\le 0$, set $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$, $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n+1} = \\alpha_{n}$, and $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$.\n- If $f_{\\mathrm{tr}} > 0$, compute direction $\\mathbf{n} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}/\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ and plastic multiplier $\\Delta \\gamma = f_{\\mathrm{tr}}/(2\\mu)$, correct stress $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - 2\\mu \\Delta \\gamma \\mathbf{n}$, update $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma \\mathbf{n}$ and $\\alpha_{n+1} = \\alpha_{n} + \\sqrt{2/3}\\,\\Delta \\gamma$, and set $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$.\n- Common bugs: Newton–Raphson divergence from large $\\Delta \\boldsymbol{\\varepsilon}$; floating-point underflow in norm calculation.\n\nB. Sequence and dependencies:\n- Inputs: $\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$, material parameters $\\kappa$, $\\mu$, and hardening law $\\sigma_{y}(\\cdot)$ and its tangent $H'(\\cdot)$ evaluated consistently with the chosen integration point state.\n- Elastic predictor: compute the trial stress by elastic response to the total increment and keeping plastic strain fixed, $\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}$ with $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$, where $\\mathbb{I}_{\\mathrm{dev}} = \\mathbb{I}_{\\mathrm{s}} - \\tfrac{1}{3} \\mathbf{I} \\otimes \\mathbf{I}$ and $\\mathbb{I}_{\\mathrm{s}}$ is the fourth-order symmetric identity. Extract deviatoric trial stress $\\mathbf{s}_{\\mathrm{tr}} = \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}})$.\n- Yield check on the deviatoric norm: $f_{\\mathrm{tr}} = \\sqrt{3/2}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$.\n- Elastic step if $f_{\\mathrm{tr}} \\le 0$: accept the trial state, i.e., $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$, $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n+1} = \\alpha_{n}$, and set $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$.\n- Plastic corrector if $f_{\\mathrm{tr}} > 0$: compute unit flow direction $\\mathbf{n} = \\mathbf{s}_{\\mathrm{tr}}/\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert$ (coaxiality), and the plastic multiplier using consistency linearization $\\Delta \\gamma = f_{\\mathrm{tr}}/(3\\mu + H')$ with $H' = d\\sigma_{y}/d\\alpha$ evaluated consistently (commonly at $\\alpha_{n}$ for the closed-form update or at $\\alpha_{n+1}$ within a local Newton iteration). Update stresses by radial return on deviatoric part and keep the hydrostatic part elastic: $\\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{3/2}\\,\\mathbf{n}$ and $p_{n+1} = p_{\\mathrm{tr}}$, so $\\boldsymbol{\\sigma}_{n+1} = p_{\\mathrm{tr}}\\mathbf{I} + \\mathbf{s}_{n+1}$. Update internal variables by associative flow: $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\partial f/\\partial \\boldsymbol{\\sigma} = \\Delta \\gamma\\,\\sqrt{3/2}\\,\\mathbf{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\boldsymbol{\\varepsilon}^{p}$, and $\\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma$.\n- Algorithmic consistent tangent: return $\\mathbb{C}_{n+1} = \\mathbb{C}^{e} - \\frac{6\\mu^2}{3\\mu+H'}\\mathbf{n}\\otimes\\mathbf{n}$, which is symmetric and reduces stiffness only along $\\mathbf{n}$; if $\\sigma_{y}$ is nonlinear, use $H' = d\\sigma_{y}/d\\alpha$ consistently with the stress update point.\n- Data dependencies: the update depends on $(\\Delta \\boldsymbol{\\varepsilon}, \\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n}, \\kappa, \\mu, \\sigma_{y}(\\cdot), H'(\\cdot))$; the plastic branch further depends on the trial direction $\\mathbf{n}$ and $H'$, and the tangent depends on $\\mathbf{n}$ and $H'$ at the chosen evaluation state.\n- Common implementation bugs: using $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ instead of $\\lVert \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}) \\rVert$ in $f_{\\mathrm{tr}}$; forgetting to normalize $\\mathbf{s}_{\\mathrm{tr}}$ when forming $\\mathbf{n}$; erroneously modifying the hydrostatic stress during plastic correction (violating plastic incompressibility); inconsistent or nonsymmetric $\\mathbb{C}_{n+1}$ due to using an incorrect projector; evaluating $H'$ at the wrong state for nonlinear hardening; failing to handle $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert \\approx 0$ or very small $f_{\\mathrm{tr}}$ robustly; mixing total and incremental quantities for $\\boldsymbol{\\varepsilon}^{p}$ or $\\alpha$; returning a secant instead of consistent tangent; neglecting temperature- or rate-dependence of $\\kappa$, $\\mu$, or $\\sigma_{y}$ when applicable; inadequate tolerances in the local solve if a Newton iteration for $\\Delta \\gamma$ is used or lack of substepping for very large $\\Delta \\boldsymbol{\\varepsilon}$.\n\nC. Sequence and dependencies:\n- Inputs: $\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$, $\\kappa$, $\\mu$, $\\sigma_{y}(\\cdot)$.\n- Compute $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$ and $f_{\\mathrm{tr}}$ as in the elastic predictor but replace the yield function by $f_{\\mathrm{tr}} = \\sqrt{3}\\,\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})$.\n- If $f_{\\mathrm{tr}} > 0$, solve for $\\Delta \\gamma$ by a Newton iteration on $g(\\Delta \\gamma) = \\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} - 2\\mu \\Delta \\gamma \\mathbf{n} \\rVert - \\sigma_{y}(\\alpha_{n})$ with initial guess $\\Delta \\gamma = f_{\\mathrm{tr}}/\\mu$; update plastic strain first by $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma \\mathbf{n}$, then recompute stress elastically from total strain; set $\\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma$ and reduce the hydrostatic stress by the same amount as the deviatoric correction; return a symmetric secant tangent computed from $\\Delta \\boldsymbol{\\sigma}/\\Delta \\boldsymbol{\\varepsilon}$.\n- Common bugs: poor convergence of the Newton solve; overshoot of $\\Delta \\gamma$; sensitivity to time step selection.\n\nD. Sequence and dependencies:\n- Inputs: $\\Delta \\boldsymbol{\\varepsilon}$, $\\boldsymbol{\\sigma}_{n}$, $\\boldsymbol{\\varepsilon}^{p}_{n}$, $\\alpha_{n}$, $\\kappa$, $\\mu$, $\\sigma_{y}(\\cdot)$.\n- Use an objective stress rate (Jaumann rate) to rotate $\\boldsymbol{\\sigma}_{n}$, then compute a trial stress; for plasticity, compute $\\mathbf{n}$ from $\\boldsymbol{\\sigma}_{n+1}$ and set $\\Delta \\gamma = \\left(\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n+1})\\right)/(3\\mu)$; update hydrostatic and deviatoric stresses by the same plastic correction; update $\\alpha_{n+1}$ from the trace of $\\Delta \\boldsymbol{\\varepsilon}^{p}$; return $\\mathbb{C}_{n+1} = \\mathbb{C}^{e}$ to preserve symmetry.\n- Common bugs: neglecting corotational effects; misalignment of principal directions; nonuniqueness of $\\mathbf{n}$ near corners of the yield surface.\n\nChoose one option.", "solution": "We derive the algorithmic sequence, data dependencies, and consistent tangent from first principles of small-strain associative von Mises ($J_2$) plasticity with isotropic hardening and a backward-Euler time discretization. The goal is to map inputs at a single integration point to updated stress and algorithmic tangent in a way that is thermodynamically consistent and numerically robust.\n\nFoundational constitutive structure. In small-strain elastoplasticity with linear elasticity, the Cauchy stress is\n$$\n\\boldsymbol{\\sigma} = \\kappa\\,\\mathrm{tr}\\!\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p}\\right)\\mathbf{I} + 2\\mu\\,\\mathrm{dev}\\!\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p}\\right),\n$$\nwhere $\\boldsymbol{\\varepsilon}$ is total strain, $\\boldsymbol{\\varepsilon}^{p}$ is plastic strain, $\\kappa$ is the bulk modulus, $\\mu$ is the shear modulus, $\\mathbf{I}$ is the second-order identity, and $\\mathrm{dev}(\\cdot)$ denotes the deviatoric part. Define the deviatoric stress $\\mathbf{s} = \\mathrm{dev}(\\boldsymbol{\\sigma})$ and the hydrostatic pressure $p = \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$. The von Mises equivalent stress is $\\sigma_{\\mathrm{eq}} = \\sqrt{3/2}\\,\\lVert \\mathbf{s} \\rVert$, and the yield function with isotropic hardening is\n$$\nf(\\boldsymbol{\\sigma}, \\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\alpha) \\le 0.\n$$\nAssociative flow and hardening read\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\quad \\mathbf{n} := \\frac{\\mathbf{s}}{\\lVert \\mathbf{s} \\rVert}, \\quad \\Delta \\alpha = \\sqrt{\\tfrac{2}{3}}\\lVert \\Delta \\boldsymbol{\\varepsilon}^{p} \\rVert = \\Delta \\gamma,\n$$\nwith Kuhn–Tucker conditions $\\Delta \\gamma \\ge 0$, $f \\le 0$, and $\\Delta \\gamma\\,f = 0$. The elastic stiffness is $\\mathbb{C}^{e} = \\kappa \\mathbf{I} \\otimes \\mathbf{I} + 2\\mu \\mathbb{I}_{\\mathrm{dev}}$, where $\\mathbb{I}_{\\mathrm{dev}} = \\mathbb{I}_{\\mathrm{s}} - \\tfrac{1}{3} \\mathbf{I} \\otimes \\mathbf{I}$ and $\\mathbb{I}_{\\mathrm{s}}$ is the fourth-order symmetric identity.\n\nRadial return mapping. Given state $(\\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n})$ and increment $\\Delta \\boldsymbol{\\varepsilon}$, the elastic predictor (trial state) assumes $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\mathbf{0}$:\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C}^{e} : \\Delta \\boldsymbol{\\varepsilon}, \\qquad \\mathbf{s}_{\\mathrm{tr}} = \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}).\n$$\nEvaluate the trial yield function\n$$\nf_{\\mathrm{tr}} = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n}).\n$$\nIf $f_{\\mathrm{tr}} \\le 0$, the step is elastic: accept the trial state\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\quad \\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n}, \\quad \\alpha_{n+1} = \\alpha_{n}, \\quad \\mathbb{C}_{n+1} = \\mathbb{C}^{e}.\n$$\nIf $f_{\\mathrm{tr}} > 0$, plastic loading occurs. Under isotropy and associativity, the corrector is coaxial with the deviatoric trial stress (coaxiality). Define the unit direction\n$$\n\\mathbf{n} = \\frac{\\mathbf{s}_{\\mathrm{tr}}}{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert}.\n$$\nUsing backward Euler for the flow and hardening and enforcing $f_{n+1} = 0$ (consistency), the deviatoric stress update is\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}_{\\mathrm{tr}} - 2\\mu\\,\\Delta \\boldsymbol{\\varepsilon}^{p} = \\mathbf{s}_{\\mathrm{tr}} - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\quad p_{n+1} = p_{\\mathrm{tr}},\n$$\nso that $\\boldsymbol{\\sigma}_{n+1} = p_{\\mathrm{tr}} \\mathbf{I} + \\mathbf{s}_{n+1}$. The updated internal variables are\n$$\n\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\,\\mathbf{n}, \\qquad \\alpha_{n+1} = \\alpha_{n} + \\Delta \\gamma.\n$$\nTo find $\\Delta \\gamma$, impose $f_{n+1} = 0$ with a first-order linearization of $\\sigma_{y}(\\alpha_{n+1}) \\approx \\sigma_{y}(\\alpha_{n}) + H' \\Delta \\gamma$, where $H' = d\\sigma_{y}/d\\alpha$ evaluated consistently. The equivalent stress at $n+1$ equals\n$$\n\\sigma_{\\mathrm{eq},n+1} = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{n+1} \\rVert = \\sqrt{\\tfrac{3}{2}}\\left(\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\,\\Delta \\gamma\\,\\sqrt{\\tfrac{3}{2}}\\right) = \\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 3\\mu\\,\\Delta \\gamma.\n$$\nConsistency $f_{n+1} = \\sigma_{\\mathrm{eq},n+1} - \\sigma_{y}(\\alpha_{n+1}) = 0$ gives\n$$\n0 = \\underbrace{\\left(\\sqrt{\\tfrac{3}{2}}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sigma_{y}(\\alpha_{n})\\right)}_{f_{\\mathrm{tr}}} - (3\\mu + H')\\,\\Delta \\gamma \\quad \\Rightarrow \\quad \\Delta \\gamma = \\frac{f_{\\mathrm{tr}}}{3\\mu + H'}.\n$$\nThis is the hallmark closed-form of the radial return for isotropic hardening; for nonlinear $\\sigma_{y}(\\cdot)$, one can also solve $f_{n+1} = 0$ by a scalar Newton method for $\\Delta \\gamma$ while maintaining the same structure.\n\nAlgorithmic consistent tangent. Differentiating the stress update with respect to total strain yields the symmetric algorithmic tangent. A standard form for the consistent tangent is $\\mathbb{C}_{n+1} = \\mathbb{C}^{e} - \\frac{(\\mathbb{C}^e : \\partial f/\\partial \\boldsymbol{\\sigma}) \\otimes (\\mathbb{C}^e : \\partial f/\\partial \\boldsymbol{\\sigma})}{(\\partial f/\\partial \\boldsymbol{\\sigma}) : \\mathbb{C}^e : (\\partial f/\\partial \\boldsymbol{\\sigma}) + H'}$. For $J_2$ plasticity, this simplifies to\n$\n\\mathbb{C}_{n+1} = \\mathbb{C}^{e} - \\frac{6\\mu^2}{3\\mu+H'}\\mathbf{n}\\otimes\\mathbf{n}.\n$\nThis form reduces the shear stiffness only along the active flow direction $\\mathbf{n}$, preserves volumetric elasticity, and is symmetric. If the hardening modulus depends on $\\alpha$, $H' = d\\sigma_{y}/d\\alpha$ should be evaluated consistently with the stress update point to guarantee quadratic convergence of the global Newton method.\n\nData dependencies. The update requires the strain increment $\\Delta \\boldsymbol{\\varepsilon}$, prior state $(\\boldsymbol{\\sigma}_{n}, \\boldsymbol{\\varepsilon}^{p}_{n}, \\alpha_{n})$, elastic moduli $(\\kappa, \\mu)$, and the hardening law $\\sigma_{y}(\\cdot)$ and its tangent $H'(\\cdot)$. On the plastic branch, the direction $\\mathbf{n}$ and the scalar $\\Delta \\gamma$ are computed from the trial state; the consistent tangent depends explicitly on $\\mathbf{n}$ and $H'$.\n\nCommon sources of bugs. Typical errors are: using the norm $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ instead of $\\lVert \\mathrm{dev}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}) \\rVert$ in the yield check; failing to normalize $\\mathbf{s}_{\\mathrm{tr}}$ when forming $\\mathbf{n}$; modifying the hydrostatic stress during plastic correction (violating plastic incompressibility); returning a nonsymmetric or inconsistent tangent by using an incorrect projector term; evaluating $H'$ at an inconsistent state for nonlinear hardening; not handling $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert \\approx 0$ or very small $f_{\\mathrm{tr}}$ robustly; mixing total versus incremental updates of $\\boldsymbol{\\varepsilon}^{p}$ or $\\alpha$; returning a secant instead of a consistent tangent; neglecting temperature- or rate-dependence where present; lack of substepping for extremely large $\\Delta \\boldsymbol{\\varepsilon}$ in materials with strong nonlinearity.\n\nOption-by-option analysis.\n\n- Option A: Incorrect. It uses the full stress norm $\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$ in the yield check, rather than the deviatoric norm $\\sqrt{3/2}\\,\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert$. The plastic flow direction $\\mathbf{n}$ is taken from total stress, and the flow magnitude omits the factor $\\sqrt{3/2}$, breaking consistency with the von Mises metric. The hardening increment $\\alpha_{n+1} = \\alpha_{n} + \\sqrt{2/3}\\,\\Delta \\gamma$ is inconsistent with the standard normalization where $\\Delta \\alpha = \\Delta \\gamma$. It also returns $\\mathbb{C}^{e}$ in plasticity, which is not the algorithmic consistent tangent and will harm global Newton convergence. The listed bugs are incomplete and do not highlight the fundamental pitfalls mentioned above.\n\n- Option B: Correct. It specifies the inputs and state consistently, performs the elastic predictor, checks yield on the deviatoric norm with the correct $\\sqrt{3/2}$ factor, branches elastic versus plastic, applies the plastic corrector along the normalized deviatoric trial direction using the correct plastic multiplier $\\Delta \\gamma = f_{\\mathrm{tr}}/(3\\mu + H')$, keeps the hydrostatic stress elastic (plastic incompressibility), updates $\\boldsymbol{\\varepsilon}^{p}$ and $\\alpha$ with the associative flow and the normalization that ensures $\\Delta \\alpha = \\Delta \\gamma$, and provides a correct form for the symmetric algorithmic consistent tangent. It also properly notes dependence on $H'$ and $\\mathbf{n}$ and enumerates a comprehensive list of realistic implementation bugs.\n\n- Option C: Incorrect. It defines the yield check with $\\sqrt{3}\\,\\lVert \\boldsymbol{\\sigma}_{\\mathrm{tr}} \\rVert$, mis-scaling the equivalent stress and using the total stress norm. The initial guess for $\\Delta \\gamma$ is incorrect, and the plastic update recomputes stress purely elastically from total strain after updating plastic strain, which is not the radial return form. It incorrectly reduces the hydrostatic stress during plastic correction, violating plastic incompressibility, and returns a secant tangent instead of the consistent tangent required for quadratic global convergence.\n\n- Option D: Incorrect. Introducing an objective stress rate (Jaumann) and stress rotations is unnecessary and incorrect in small-strain settings without finite rotations. It computes $\\Delta \\gamma$ with an inconsistent denominator and uses $\\alpha_{n+1}$ in the yield stress before it is determined consistently. It also applies the plastic correction to both hydrostatic and deviatoric parts, violating plastic incompressibility, and returns $\\mathbb{C}^{e}$ in plasticity, which is not consistent. The listed bug sources are not the primary issues for this algorithmic context.\n\nTherefore, only Option B satisfies the correct sequence, dependencies, and bug identification.", "answer": "$$\\boxed{B}$$", "id": "2678297"}, {"introduction": "Once the theoretical algorithm is understood, the next critical step is verification: how can you be certain your code is correct? This practice moves from abstract theory to concrete validation by tasking you with designing a minimal yet comprehensive suite of unit tests. You will derive the expected closed-form responses for canonical loading scenarios—uniaxial tension, pure shear, and biaxial loading—providing a clear benchmark against which to validate your implementation's stress and internal variable updates. [@problem_id:2678252]", "problem": "A small-strain isotropic elastoplastic constitutive model with von Mises (J2) yield and linear isotropic hardening is implemented using a deviatoric radial return mapping algorithm in stress space. The material parameters are Young’s modulus $E = 210\\,\\mathrm{GPa}$, Poisson’s ratio $\\nu = 0.3$, initial yield stress $\\sigma_{y0} = 250\\,\\mathrm{MPa}$, and linear isotropic hardening modulus $H = 1\\,\\mathrm{GPa}$. The initial state is stress-free with zero plastic strain and zero hardening variable. You are asked to design a minimal yet sufficient unit test suite, using first principles, to validate both the stress update and the internal variable update of the radial return mapping for the following canonical loadings: uniaxial tension, pure shear, and equibiaxial in-plane loading under plane stress. The tests must specify the loading, the trial elastic response, the yield check, the precise plastic correction and expected closed-form updated stresses, and at least one check of an algorithmic tangent or invariance that distinguishes correct from incorrect implementations.\n\nWhich option proposes a correct and fully self-consistent set of such unit tests and their expected closed-form responses?\n\nA. Uniaxial tension (1D specialization): prescribe a total axial strain $\\varepsilon_{11} = 0.003$. The elastic predictor for this 1D case gives a trial axial stress $\\sigma^{\\mathrm{tr}} = E\\,\\varepsilon_{11} = 0.630\\,\\mathrm{GPa}$ and equivalent trial stress $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = 0.630\\,\\mathrm{GPa}$. The trial yield function is $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} = 0.380\\,\\mathrm{GPa} > 0$, so plastic correction occurs. For the 1D model, the plastic strain increment is $\\Delta\\varepsilon_p = \\dfrac{f^{\\mathrm{tr}}}{E + H} = \\dfrac{0.380}{210+1} = 0.00180\\,\\mathrm{GPa}$. The updated axial stress is $\\sigma_{11}^{n+1} = \\sigma_{y0} + H\\,\\Delta\\varepsilon_p = 0.250 + 1 \\times 0.00180 = 0.25180\\,\\mathrm{GPa}$. A slope check under monotonic plastic flow gives the uniaxial elastoplastic tangent $E_{\\mathrm{ep}} = \\dfrac{E\\,H}{E + H} = 0.99526\\,\\mathrm{GPa}$. Pure shear: prescribe an engineering shear $\\gamma_{12} = 0.01$ (so small-strain tensor component $\\varepsilon_{12} = \\gamma_{12}/2$). The elastic predictor yields $\\tau^{\\mathrm{tr}} = G\\,\\gamma_{12} = 0.80769\\,\\mathrm{GPa}$ and $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{3}\\,\\tau^{\\mathrm{tr}} = 1.3987\\,\\mathrm{GPa}$ (where shear modulus $G=80.769$ GPa). Then $f^{\\mathrm{tr}} = 1.1487\\,\\mathrm{GPa}$. Using the 3D algorithm, the plastic multiplier is $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G + H} = \\dfrac{1.1487}{243.307} = 0.0047213$, so $\\sigma_{\\mathrm{eq}}^{n+1} = 0.250 + H\\Delta\\gamma = 0.25472\\,\\mathrm{GPa}$, and $\\tau^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}/\\sqrt{3} = 0.14705\\,\\mathrm{GPa}$. The deviatoric stress direction remains aligned with the trial shear direction, and the hydrostatic stress remains zero. Equibiaxial in-plane loading (plane stress specialization): prescribe equal in-plane strains $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$ and enforce plane stress $\\sigma_{33} = 0$. For an equibiaxial stress state $\\sigma_{11}=\\sigma_{22}=\\sigma$, the elastic plane-stress predictor gives $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1-\\nu}\\,\\varepsilon_{11} = 0.450\\,\\mathrm{GPa}$ and $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma^{\\mathrm{tr}} = 0.450\\,\\mathrm{GPa}$. Then $f^{\\mathrm{tr}} = 0.200\\,\\mathrm{GPa}$. The plastic strain increment for this specialized case is $\\Delta\\varepsilon_p = \\dfrac{f^{\\mathrm{tr}}}{E/(1-\\nu) + H} = \\dfrac{0.200}{300+1} = 0.000664$. The updated stress is $\\sigma^{n+1} = \\sigma_{y0} + H\\Delta\\varepsilon_p = 0.250+1\\times0.000664 = 0.250664\\,\\mathrm{GPa}$. Thus $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = 0.25066\\,\\mathrm{GPa}$ and $\\sigma_{33}^{n+1} = 0$. In all three tests, the equivalent plastic strain increment $\\Delta\\alpha$ must be verified from the internal variable update ($\\Delta\\alpha = \\Delta\\varepsilon_p$ for 1D, $\\Delta\\alpha=\\Delta\\gamma$ for 3D).\n\nB. Uniaxial tension: prescribe $\\varepsilon_{11} = 0.003$; use a plastic multiplier increment $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{2G + H}$ so that $\\Delta \\gamma = \\dfrac{0.380}{163.538} = 0.002324$ and $\\sigma_{11}^{n+1} = 0.252324\\,\\mathrm{GPa}$. The post-yield slope is taken as $E_{\\mathrm{ep}} = H$. Pure shear: take von Mises shear yield at $\\tau_{y} = \\sigma_{y0}/2 = 125\\,\\mathrm{MPa}$ and use $\\sigma_{\\mathrm{eq}} = 2\\,\\tau$ for the return mapping, giving a corrected $\\tau^{n+1} = 0.125\\,\\mathrm{GPa}$ for $\\gamma_{12} = 0.01$. Equibiaxial in-plane loading: for $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$ under plane stress, assume $\\sigma_{\\mathrm{eq}} = \\sqrt{2}\\,\\sigma$ so the corrected in-plane stress after return is $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}/\\sqrt{2} = 0.1773\\,\\mathrm{GPa}$.\n\nC. Uniaxial tension: prescribe $\\varepsilon_{11} = 0.003$ and update stress by the piecewise bilinear relation $\\sigma_{11}^{n+1} = \\sigma_{y0} + H(\\varepsilon_{11} - \\sigma_{y0}/E)$ after yield, giving $\\sigma_{11}^{n+1} = 0.2518095\\,\\mathrm{GPa}$, and take $E_{\\mathrm{ep}} = H$. Pure shear: take $\\sigma_{\\mathrm{eq}} = 2\\,\\tau$ and yield in shear at $\\tau_{y} = \\sigma_{y0}/\\sqrt{2}$; with $\\gamma_{12} = 0.01$ the corrected $\\tau^{n+1} = 0.125\\,\\mathrm{GPa}$. Equibiaxial in-plane loading under plane stress: use the predictor $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1+\\nu}\\,\\varepsilon$ so that for $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$ one has $\\sigma^{\\mathrm{tr}} = 0.2423\\,\\mathrm{GPa}  \\sigma_{y0}$ and the response is elastic with $\\sigma_{11}^{n+1} = \\sigma_{22}^{n+1} = 0.2423\\,\\mathrm{GPa}$.\n\nD. Uniaxial tension: prescribe $\\varepsilon_{11} = 0.003$ and use a hydrostatic return mapping based on the bulk modulus $K$, with plastic multiplier increment $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{3K + H}$ and updated stress $\\sigma_{11}^{n+1} = 0.2516\\,\\mathrm{GPa}$. Pure shear: check hydrostatic invariance by applying a hydrostatic strain $\\varepsilon_{11} = \\varepsilon_{22} = \\varepsilon_{33} = 0.002$; expect yielding when the hydrostatic pressure exceeds $\\sigma_{y0}$ and a plastic correction that reduces the pressure. Equibiaxial in-plane loading: for $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$, assume $\\sigma_{\\mathrm{eq}} = \\sqrt{2}\\,\\sigma$ and update with $\\Delta \\gamma = \\dfrac{f^{\\mathrm{tr}}}{2G + H}$ to get $\\sigma_{11}^{n+1} = 0.180\\,\\mathrm{GPa}$.\n\nSelect the correct option.", "solution": "The problem statement asks to identify a correct and self-consistent set of unit tests for a small-strain isotropic J2 elastoplastic model with linear hardening, implemented using a deviatoric radial return mapping algorithm. The tests cover uniaxial tension, pure shear, and equibiaxial plane stress loading.\n\n### Theoretical Framework\n\nThe core of the algorithm involves an elastic prediction step followed by a plastic correction if the trial stress lies outside the yield surface.\n\n1.  **Elastic Constants**:\n    -   Shear modulus: $G = \\dfrac{E}{2(1+\\nu)} = \\dfrac{210\\,\\mathrm{GPa}}{2(1+0.3)} \\approx 80.769\\,\\mathrm{GPa}$.\n    -   Young's modulus: $E = 210\\,\\mathrm{GPa}$.\n    -   Hardening modulus: $H = 1\\,\\mathrm{GPa}$.\n\n2.  **Radial Return Algorithm (3D)**:\n    -   Yield check: $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y(\\alpha^n)$, with $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\mathbf{s}^{\\mathrm{tr}}:\\mathbf{s}^{\\mathrm{tr}}}$.\n    -   Plastic multiplier: $\\Delta\\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G+H}$.\n    -   Update: $\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_y(\\alpha^n) + H\\Delta\\gamma$; $\\mathbf{s}^{n+1} = \\dfrac{\\sigma_{\\mathrm{eq}}^{n+1}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} \\mathbf{s}^{\\mathrm{tr}}$.\n\n3.  **1D Specialization (Uniaxial Stress)**:\n    -   Plastic strain increment: $\\Delta\\varepsilon_p = \\dfrac{\\sigma^{\\mathrm{tr}} - \\sigma_{y0}}{E+H}$.\n    -   Update: $\\sigma^{n+1} = \\sigma_{y0} + H\\Delta\\varepsilon_p$.\n\n4.  **Plane Stress Specialization (Equibiaxial Stress)**:\n    -   Equivalent 1D modulus: $E_{ps} = \\dfrac{E}{1-\\nu}$.\n    -   Plastic strain increment: $\\Delta\\varepsilon_p = \\dfrac{\\sigma^{\\mathrm{tr}} - \\sigma_{y0}}{E_{ps}+H}$.\n    -   Update: $\\sigma^{n+1} = \\sigma_{y0} + H\\Delta\\varepsilon_p$.\n\n### Analysis of Options\n\n**Option A**: This option proposes three tests with calculations.\n\n*   **Uniaxial Tension (1D specialization)**:\n    -   **Loading**: $\\varepsilon_{11} = 0.003$.\n    -   **Elastic Predictor**: $\\sigma^{\\mathrm{tr}} = E\\varepsilon_{11} = 210 \\times 0.003 = 0.630\\,\\mathrm{GPa}$. Correct. For this 1D case, $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma^{\\mathrm{tr}}$.\n    -   **Yield Check**: $f^{\\mathrm{tr}} = 0.630 - 0.250 = 0.380\\,\\mathrm{GPa} > 0$. Correct.\n    -   **Plastic Correction**: Using the correct 1D formula, $\\Delta\\varepsilon_p = \\dfrac{f^{\\mathrm{tr}}}{E+H} = \\dfrac{0.380}{210+1} = 0.00180\\,\\mathrm{GPa}$. Correct. Updated stress $\\sigma_{11}^{n+1} = \\sigma_{y0} + H\\Delta\\varepsilon_p = 0.250 + 1 \\times 0.00180 = 0.25180\\,\\mathrm{GPa}$. Correct. The elastoplastic tangent $E_{ep}$ is also calculated correctly. This test is self-consistent and correct for a 1D model.\n\n*   **Pure Shear (3D algorithm)**:\n    -   **Loading**: $\\gamma_{12} = 0.01 \\implies \\varepsilon_{12}=0.005$.\n    -   **Elastic Predictor**: $\\tau^{\\mathrm{tr}} = G\\gamma_{12} = 80.769 \\times 0.01 = 0.80769\\,\\mathrm{GPa}$. $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{3}\\tau^{\\mathrm{tr}} = 1.3987\\,\\mathrm{GPa}$. Correct.\n    -   **Yield Check**: $f^{\\mathrm{tr}} = 1.3987 - 0.250 = 1.1487\\,\\mathrm{GPa} > 0$. Correct.\n    -   **Plastic Correction**: $\\Delta\\gamma = \\dfrac{f^{\\mathrm{tr}}}{3G+H} = \\dfrac{1.1487}{243.307} = 0.0047213$. Correct. $\\sigma_{\\mathrm{eq}}^{n+1} = 0.250 + 1 \\times 0.0047213 = 0.25472\\,\\mathrm{GPa}$. Correct. $\\tau^{n+1} = \\sigma_{\\mathrm{eq}}^{n+1}/\\sqrt{3} = 0.14705\\,\\mathrm{GPa}$. Correct. This test is self-consistent and correct for the 3D algorithm.\n\n*   **Equibiaxial Plane Stress (specialization)**:\n    -   **Loading**: $\\varepsilon_{11} = \\varepsilon_{22} = 0.0015$.\n    -   **Elastic Predictor**: $\\sigma^{\\mathrm{tr}} = \\dfrac{E}{1-\\nu}\\varepsilon_{11} = \\dfrac{210}{0.7} \\times 0.0015 = 0.450\\,\\mathrm{GPa}$. For this state, $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma^{\\mathrm{tr}}$. Correct.\n    -   **Yield Check**: $f^{\\mathrm{tr}} = 0.450 - 0.250 = 0.200\\,\\mathrm{GPa} > 0$. Correct.\n    -   **Plastic Correction**: Using the correct specialization formula, the denominator is $E/(1-\\nu) + H = 300+1=301$. The plastic strain is $\\Delta\\varepsilon_p = \\dfrac{0.200}{301} = 0.000664$. Updated stress $\\sigma^{n+1} = 0.250 + 1 \\times 0.000664 = 0.250664\\,\\mathrm{GPa}$. All in-plane stresses are equal to this. Correct.\n\n**Conclusion for Option A**: All three tests are correctly described and calculated based on standard, self-consistent specializations of the model.\n\n**Option B**: Contains multiple fundamental errors. The denominator for $\\Delta\\gamma$ is incorrect ($2G+H$). It uses Tresca criterion relations ($\\tau_y = \\sigma_{y0}/2$) for a von Mises model. It uses an incorrect formula for $\\sigma_{\\mathrm{eq}}$ in the biaxial case. Incorrect.\n\n**Option C**: Contains multiple fundamental errors. The hardening relation is dimensionally incorrect. It uses Tresca/incorrect relations for shear. It uses an incorrect elastic predictor for the biaxial case. Incorrect.\n\n**Option D**: Contains multiple fundamental errors. It invokes a \"hydrostatic return mapping\" which is nonsensical for pressure-independent $J_2$ plasticity. It misunderstands hydrostatic invariance. It uses incorrect formulas for $\\sigma_{eq}$ and $\\Delta\\gamma$. Incorrect.\n\nTherefore, Option A is the only one that proposes a correct and fully self-consistent set of unit tests.", "answer": "$$\\boxed{A}$$", "id": "2678252"}, {"introduction": "A verified implementation is a great achievement, but it is equally important to understand its boundaries of accuracy. The single-step backward-Euler integration is an approximation, and this practice explores the conditions under which it is exact versus when it introduces significant error. By analyzing the algorithm's behavior for large strain increments with different hardening models, you will uncover the reasons why the 'radial' return path can become a curve, motivating the need for adaptive substepping to ensure robust and accurate simulations. [@problem_id:2678275]", "problem": "Consider small-strain, rate-independent, associative $J_2$ plasticity for an isotropic, linear elastic solid with elastic stiffness $\\mathbb{C}$, Cauchy stress $\\boldsymbol{\\sigma}$, total strain $\\boldsymbol{\\varepsilon}$, and plastic strain $\\boldsymbol{\\varepsilon}^p$. The elastic relation is $\\boldsymbol{\\sigma} = \\mathbb{C} : \\left( \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^p \\right)$. Let $\\boldsymbol{s}$ denote the deviatoric part of $\\boldsymbol{\\sigma}$. The von Mises yield function with combined hardening is\n$$\nf\\left(\\boldsymbol{\\sigma}, \\boldsymbol{a}, p\\right) = \\sqrt{\\tfrac{3}{2}} \\left\\| \\boldsymbol{s} - \\boldsymbol{a} \\right\\| - \\left( \\sigma_{y0} + R(p) \\right),\n$$\nwhere $\\boldsymbol{a}$ is the deviatoric backstress associated with kinematic hardening, $p$ is the equivalent plastic strain, $\\sigma_{y0}$ is the initial yield stress, and $R(p)$ is a smooth, monotonically nondecreasing isotropic hardening function. The associative flow rule is\n$$\n\\mathrm{d}\\boldsymbol{\\varepsilon}^p = \\mathrm{d}\\lambda \\, \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\mathrm{d}\\lambda \\, \\tfrac{3}{2} \\, \\boldsymbol{n}, \\quad \\text{with} \\quad \\boldsymbol{n} := \\frac{\\boldsymbol{s} - \\boldsymbol{a}}{\\left\\|\\boldsymbol{s} - \\boldsymbol{a}\\right\\|},\n$$\nand the consistency condition enforces $f \\le 0$ with $\\mathrm{d}\\lambda \\ge 0$ and $\\mathrm{d}\\lambda \\, f = 0$. The equivalent plastic strain evolves as $\\mathrm{d}p = \\sqrt{\\tfrac{2}{3}} \\left\\| \\mathrm{d}\\boldsymbol{\\varepsilon}^p \\right\\| = \\mathrm{d}\\lambda$. Consider two kinematic hardening laws: (i) linear Prager-type with $\\mathrm{d}\\boldsymbol{a} = H_k \\, \\mathrm{d}\\lambda \\, \\boldsymbol{n}$, where $H_k \\ge 0$ is constant, and (ii) nonlinear Armstrong–Frederick-type with $\\mathrm{d}\\boldsymbol{a} = H_k \\, \\mathrm{d}\\lambda \\, \\boldsymbol{n} - \\gamma \\, \\boldsymbol{a} \\, \\mathrm{d}p$, with constants $H_k \\ge 0$ and $\\gamma \\ge 0$.\n\nA standard backward Euler increment over a time step from $t_n$ to $t_{n+1}$ with strain increment $\\Delta \\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}_n$ is to compute an elastic trial state and, if plasticity is detected, perform a closest-point projection by a plastic corrector. A commonly used corrector is the single-step radial return, defined here as follows: in the space of relative deviatoric stress $\\boldsymbol{r} := \\boldsymbol{s} - \\boldsymbol{a}$, the correction from the elastic trial point proceeds along a line that preserves the direction of the deviatoric trial relative stress. Equivalently, the final unit normal $\\boldsymbol{n}_{n+1}$ is taken to satisfy $\\boldsymbol{n}_{n+1} \\parallel \\boldsymbol{r}_{\\text{trial}}$ so that the corrected $\\boldsymbol{r}_{n+1}$ is colinear with $\\boldsymbol{r}_{\\text{trial}}$.\n\nAssume the step begins from a state on the yield surface with $f_n = 0$ and that the applied increment $\\Delta \\boldsymbol{\\varepsilon}$ is sufficiently large that the elastic trial stress overshoots the yield surface by a significant amount in deviatoric space. You are asked to analyze, starting from the governing definitions above and without assuming any special “shortcut” formulas, the conditions under which this single-step radial return is accurate for large strain increments, and to motivate a substepping strategy when those conditions are violated.\n\nWhich of the following statements are correct?\n\nA. For associative $J_2$ plasticity with purely isotropic hardening (possibly nonlinear $R(p)$) and no kinematic hardening (that is, $\\boldsymbol{a} \\equiv \\boldsymbol{0}$), the single-step backward Euler radial return produces the exact end-of-step stress for any size of $\\Delta \\boldsymbol{\\varepsilon}$ because the flow direction $\\boldsymbol{n}$ remains constant during the corrector, so the projection is truly radial in deviatoric stress space.\n\nB. For associative $J_2$ plasticity with linear Prager kinematic hardening, the single-step backward Euler translated radial return in the relative stress $\\boldsymbol{r} = \\boldsymbol{s} - \\boldsymbol{a}$ space yields the exact end-of-step solution for any size of $\\Delta \\boldsymbol{\\varepsilon}$.\n\nC. For anisotropic yield functions where the outward unit normal $\\boldsymbol{n} = \\partial f / \\partial \\boldsymbol{\\sigma} / \\left\\| \\partial f / \\partial \\boldsymbol{\\sigma} \\right\\|$ depends sensitively on the stress direction, a single-step radial return aligned with the trial direction can lose accuracy for large $\\Delta \\boldsymbol{\\varepsilon}$ because $\\boldsymbol{n}$ rotates substantially during the step; substepping mitigates this by resolving the rotation of $\\boldsymbol{n}$.\n\nD. If the isotropic hardening function $R(p)$ is strongly nonlinear so that its tangent varies sharply with $p$ inside the increment, a single-step radial return always fails regardless of other model features; therefore substepping is always mandatory in this case.\n\nE. A practical a posteriori substepping trigger is to monitor the angle $\\theta = \\arccos\\!\\left( \\boldsymbol{n}_{\\text{trial}} \\cdot \\boldsymbol{n}_{n+1} \\right)$ between the trial and corrected flow directions and, if $\\theta$ exceeds a small tolerance, reject the step and redo it with substeps to improve accuracy.\n\nSelect all that apply.", "solution": "The problem statement is a valid exercise in computational solid mechanics. It is scientifically grounded, well-posed, and contains all necessary definitions to proceed with a rigorous analysis.\n\nThe core of the problem is to assess the accuracy of a \"single-step radial return\" algorithm for an associative $J_2$ plasticity model with combined hardening. The algorithm is defined by the assumption that the plastic correction occurs along a fixed direction in the relative deviatoric stress space, $\\boldsymbol{r} = \\boldsymbol{s} - \\boldsymbol{a}$. This fixed direction is the one determined at the elastic trial state, $\\boldsymbol{r}_{\\text{trial}}$. Let $\\boldsymbol{n}_{\\text{trial}} = \\boldsymbol{r}_{\\text{trial}} / \\|\\boldsymbol{r}_{\\text{trial}}\\|$. The algorithm enforces that the direction of plastic flow at the end of the increment, $\\boldsymbol{n}_{n+1}$, is equal to this trial direction: $\\boldsymbol{n}_{n+1} = \\boldsymbol{n}_{\\text{trial}}$.\n\nThe backward Euler discretized equations for a plastic step from state $n$ to $n+1$ are:\n- Final stress deviator: $\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{trial}} - 2G\\Delta\\boldsymbol{e}^p$.\n- Flow rule: $\\Delta\\boldsymbol{e}^p = \\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\, \\tfrac{3}{2} \\, \\boldsymbol{n}_{n+1}$.\n- Equivalent plastic strain: $\\Delta p = \\Delta\\lambda$.\n\nCombining these, we get the stress update:\n$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{trial}} - 3G\\Delta p \\, \\boldsymbol{n}_{n+1}$.\nThe final relative stress is $\\boldsymbol{r}_{n+1} = \\boldsymbol{s}_{n+1} - \\boldsymbol{a}_{n+1}$. Substituting the expressions for $\\boldsymbol{s}_{n+1}$ and $\\boldsymbol{s}_{\\text{trial}} = \\boldsymbol{r}_{\\text{trial}} + \\boldsymbol{a}_n$:\n$\\boldsymbol{r}_{n+1} = (\\boldsymbol{r}_{\\text{trial}} + \\boldsymbol{a}_n) - 3G\\Delta p \\, \\boldsymbol{n}_{n+1} - \\boldsymbol{a}_{n+1}$.\n$\\boldsymbol{r}_{n+1} = \\boldsymbol{r}_{\\text{trial}} - 3G\\Delta p \\, \\boldsymbol{n}_{n+1} + (\\boldsymbol{a}_n - \\boldsymbol{a}_{n+1})$.\n\nThe algorithm is exact (for the discrete time step) if the assumption $\\boldsymbol{n}_{n+1} = \\boldsymbol{n}_{\\text{trial}}$ is self-consistent. This means that if we substitute $\\boldsymbol{n}_{n+1} = \\boldsymbol{n}_{\\text{trial}}$ into the evolution equations, the resulting $\\boldsymbol{r}_{n+1}$ must be collinear with $\\boldsymbol{r}_{\\text{trial}}$, such that $\\boldsymbol{r}_{n+1}/\\|\\boldsymbol{r}_{n+1}\\| = \\boldsymbol{n}_{\\text{trial}}$. This is equivalent to requiring the vector sum $\\boldsymbol{r}_{\\text{trial}} - 3G\\Delta p \\, \\boldsymbol{n}_{n+1} + (\\boldsymbol{a}_n - \\boldsymbol{a}_{n+1})$ to be collinear with $\\boldsymbol{r}_{\\text{trial}}$ (and hence $\\boldsymbol{n}_{\\text{trial}}$). This condition is satisfied if the term $(\\boldsymbol{a}_n - \\boldsymbol{a}_{n+1})$ is collinear with $\\boldsymbol{n}_{\\text{trial}}$.\n\nWe now analyze each option.\n\n**A. For associative $J_2$ plasticity with purely isotropic hardening (possibly nonlinear $R(p)$) and no kinematic hardening (that is, $\\boldsymbol{a} \\equiv \\boldsymbol{0}$), the single-step backward Euler radial return produces the exact end-of-step stress for any size of $\\Delta \\boldsymbol{\\varepsilon}$ because the flow direction $\\boldsymbol{n}$ remains constant during the corrector, so the projection is truly radial in deviatoric stress space.**\n\nIn this case, $\\boldsymbol{a} \\equiv \\boldsymbol{0}$, which implies $\\boldsymbol{a}_n = \\boldsymbol{a}_{n+1} = \\boldsymbol{0}$. The relative stress is the deviatoric stress, $\\boldsymbol{r} = \\boldsymbol{s}$. The general equation for $\\boldsymbol{r}_{n+1}$ simplifies to:\n$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{trial}} - 3G\\Delta p \\, \\boldsymbol{n}_{n+1}$.\nThe radial return algorithm assumes $\\boldsymbol{n}_{n+1} = \\boldsymbol{n}_{\\text{trial}} = \\boldsymbol{s}_{\\text{trial}} / \\|\\boldsymbol{s}_{\\text{trial}}\\|$. Substituting this gives:\n$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{trial}} - 3G\\Delta p \\, \\frac{\\boldsymbol{s}_{\\text{trial}}}{\\|\\boldsymbol{s}_{\\text{trial}}\\|} = \\left(1 - \\frac{3G\\Delta p}{\\|\\boldsymbol{s}_{\\text{trial}}\\|}\\right) \\boldsymbol{s}_{\\text{trial}}$.\nThe final deviatoric stress $\\boldsymbol{s}_{n+1}$ is manifestly collinear with the trial deviatoric stress $\\boldsymbol{s}_{\\text{trial}}$. Therefore, the assumption is self-consistent and the algorithm provides the exact solution to the time-discretized equations. This holds for any size of the increment $\\Delta \\boldsymbol{\\varepsilon}$ and any form of the isotropic hardening function $R(p)$, which only influences the scalar value of $\\Delta p$.\nVerdict: **Correct**.\n\n**B. For associative $J_2$ plasticity with linear Prager kinematic hardening, the single-step backward Euler translated radial return in the relative stress $\\boldsymbol{r} = \\boldsymbol{s} - \\boldsymbol{a}$ space yields the exact end-of-step solution for any size of $\\Delta \\boldsymbol{\\varepsilon}$.**\n\nFor linear Prager hardening, the evolution is $\\mathrm{d}\\boldsymbol{a} = H_k \\, \\mathrm{d}\\lambda \\, \\boldsymbol{n}$. The backward Euler integration yields $\\boldsymbol{a}_{n+1} = \\boldsymbol{a}_n + H_k \\Delta\\lambda \\, \\boldsymbol{n}_{n+1}$. With $\\Delta p = \\Delta\\lambda$, we have $\\boldsymbol{a}_{n+1} = \\boldsymbol{a}_n + H_k \\Delta p \\, \\boldsymbol{n}_{n+1}$.\nThe term $(\\boldsymbol{a}_n - \\boldsymbol{a}_{n+1})$ becomes $-H_k \\Delta p \\, \\boldsymbol{n}_{n+1}$. The update for $\\boldsymbol{r}_{n+1}$ is:\n$\\boldsymbol{r}_{n+1} = \\boldsymbol{r}_{\\text{trial}} - 3G\\Delta p \\, \\boldsymbol{n}_{n+1} - H_k \\Delta p \\, \\boldsymbol{n}_{n+1} = \\boldsymbol{r}_{\\text{trial}} - (3G + H_k)\\Delta p \\, \\boldsymbol{n}_{n+1}$.\nThe radial return algorithm assumes $\\boldsymbol{n}_{n+1} = \\boldsymbol{n}_{\\text{trial}} = \\boldsymbol{r}_{\\text{trial}} / \\|\\boldsymbol{r}_{\\text{trial}}\\|$. Substituting this:\n$\\boldsymbol{r}_{n+1} = \\boldsymbol{r}_{\\text{trial}} - (3G + H_k)\\Delta p \\, \\frac{\\boldsymbol{r}_{\\text{trial}}}{\\|\\boldsymbol{r}_{\\text{trial}}\\|} = \\left(1 - \\frac{(3G + H_k)\\Delta p}{\\|\\boldsymbol{r}_{\\text{trial}}\\|}\\right) \\boldsymbol{r}_{\\text{trial}}$.\nThe final relative stress $\\boldsymbol{r}_{n+1}$ is collinear with the trial relative stress $\\boldsymbol{r}_{\\text{trial}}$. The assumption is again self-consistent, and the algorithm is exact for any step size.\nVerdict: **Correct**.\n\n**C. For anisotropic yield functions where the outward unit normal $\\boldsymbol{n} = \\partial f / \\partial \\boldsymbol{\\sigma} / \\left\\| \\partial f / \\partial \\boldsymbol{\\sigma} \\right\\|$ depends sensitively on the stress direction, a single-step radial return aligned with the trial direction can lose accuracy for large $\\Delta \\boldsymbol{\\varepsilon}$ because $\\boldsymbol{n}$ rotates substantially during the step; substepping mitigates this by resolving the rotation of $\\boldsymbol{n}$.**\n\nThis statement generalizes the context to highlight a key limitation. For $J_2$ plasticity, the yield surface is a cylinder in principal stress space, and its deviatoric cross-section is a circle. This simple geometry is the reason the normal vector $\\boldsymbol{n}$ does not rotate for the models in A and B. For general anisotropic yield functions, the yield surface has a more complex shape with varying curvature. As the stress state evolves during the corrector step, the normal vector $\\boldsymbol{n}$ to the yield surface rotates. A single-step algorithm that assumes a fixed normal direction ($\\boldsymbol{n}_{n+1} = \\boldsymbol{n}_{\\text{trial}}$) cannot capture this rotation, leading to significant errors for large increments where the rotation is substantial. The same issue arises for the nonlinear Armstrong-Frederick kinematic hardening model provided in the problem, where the evolution of the backstress $\\boldsymbol{a}$ includes a term $-\\gamma \\boldsymbol{a} \\mathrm{d}p$ that causes the evolution of $\\boldsymbol{a}$ to be non-collinear with $\\boldsymbol{n}$, which in turn causes $\\boldsymbol{n}$ to rotate during the increment. Substepping addresses this by breaking the large increment into smaller ones, over which the rotation of $\\boldsymbol{n}$ is small enough that the constant-normal assumption is a good approximation. The statement correctly identifies the source of error and the mitigation strategy.\nVerdict: **Correct**.\n\n**D. If the isotropic hardening function $R(p)$ is strongly nonlinear so that its tangent varies sharply with $p$ inside the increment, a single-step radial return always fails regardless of other model features; therefore substepping is always mandatory in this case.**\n\nThis statement is incorrect. As demonstrated in the analysis of option A, the radial return for purely isotropic hardening $J_2$ plasticity is exact in direction, regardless of the functional form of $R(p)$. The nonlinearity of $R(p)$ only affects the scalar nonlinear equation for the consistency parameter $\\Delta p$:\n$\\sqrt{\\tfrac{3}{2}} (\\|\\boldsymbol{s}_{\\text{trial}}\\| - 3G \\Delta p) - (\\sigma_{y0} + R(p_n + \\Delta p)) = 0$.\nWhile a \"strongly nonlinear\" $R(p)$ might pose a numerical challenge for the scalar root-finding procedure to determine $\\Delta p$, it does not invalidate the geometric basis of the radial return algorithm itself. The direction of the return remains exact. The claim that the method \"always fails\" is false.\nVerdict: **Incorrect**.\n\n**E. A practical a posteriori substepping trigger is to monitor the angle $\\theta = \\arccos\\!\\left( \\boldsymbol{n}_{\\text{trial}} \\cdot \\boldsymbol{n}_{n+1} \\right)$ between the trial and corrected flow directions and, if $\\theta$ exceeds a small tolerance, reject the step and redo it with substeps to improve accuracy.**\n\nThis statement describes a standard and effective method for adaptive time stepping in computational plasticity. The fundamental assumption of the simplified radial return is that the flow direction does not rotate, i.e., $\\boldsymbol{n}_{n+1} = \\boldsymbol{n}_{\\text{trial}}$. In cases where this is not exact (e.g., nonlinear kinematic hardening, anisotropy), the actual corrected normal $\\boldsymbol{n}_{n+1}$ (computed via a more accurate iterative scheme) will differ from $\\boldsymbol{n}_{\\text{trial}}$. The angle $\\theta$ between these two vectors is a direct measure of the error introduced by the constant-normal assumption. A large angle signifies that the assumed straight-line return path is a poor approximation of the true curved path. Therefore, monitoring $\\theta$ and enforcing that it remains below a tolerance by reducing the step size (substepping) is a robust and physically meaningful error control strategy.\nVerdict: **Correct**.", "answer": "$$\\boxed{ABCE}$$", "id": "2678275"}]}