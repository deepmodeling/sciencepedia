{"hands_on_practices": [{"introduction": "The bridge between a continuous weak formulation and a computational solution is the discretization process that yields a matrix system. This exercise provides a foundational, hands-on experience in this process by guiding you to manually construct the stiffness matrix and force vector for a simple boundary value problem. Mastering this procedure is the first step toward understanding and implementing the finite element method [@problem_id:2440325].", "problem": "Consider the steady one-dimensional boundary value problem (BVP) for diffusion on the interval $\\left(0,1\\right)$:\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) \\;=\\; f_0 \\quad \\text{in } \\left(0,1\\right),\n$$\nwith the essential boundary condition $u(0)=0$ and the natural boundary condition $k\\,u'(1)=t_0$, where $k>0$, $f_0$ and $t_0$ are given constants. Discretize the weak form of this problem using the standard Galerkin Finite Element Method (FEM) with two uniform linear elements on $\\left[0,1\\right]$ (nodes at $x_0=0$, $x_1=\\tfrac{1}{2}$, $x_2=1$). After imposing the essential boundary condition $u(0)=0$, manually construct the assembled reduced $2\\times 2$ global stiffness matrix and the corresponding right-hand side force vector associated with the unknown nodal values $u_1$ and $u_2$. \n\nProvide your final answer as the determinant of this assembled reduced $2\\times 2$ stiffness matrix, expressed as a simplified analytical expression in terms of $k$ only. Do not include units. No rounding is required.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n- Differential Equation: $- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) = f_0$\n- Domain: $x \\in (0,1)$\n- Boundary Conditions: $u(0)=0$ (essential) and $k\\,u'(1)=t_0$ (natural)\n- Constants: $k>0$, $f_0$, $t_0$ are given constants.\n- Discretization: Standard Galerkin Finite Element Method (FEM) with two uniform linear elements.\n- Nodes: $x_0=0$, $x_1=\\tfrac{1}{2}$, $x_2=1$.\n- Goal: Construct the reduced $2\\times 2$ global stiffness matrix and force vector for unknown nodal values $u_1$ and $u_2$, then find the determinant of this stiffness matrix.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard, second-order, one-dimensional boundary value problem for diffusion.\n- **Scientifically Grounded:** The problem is a canonical representation of steady-state heat conduction or diffusion, a fundamental concept in physics and engineering. It is scientifically sound.\n- **Well-Posed:** The combination of an essential boundary condition at one end and a natural (Neumann) boundary condition at the other for a second-order elliptic equation ensures a unique and stable solution exists. The problem is well-posed.\n- **Objective:** The problem is stated using precise mathematical language, with no subjective or ambiguous terms.\n- **Completeness:** All necessary information, including the differential equation, domain, boundary conditions, discretization scheme, and required output, is explicitly provided. The problem is self-contained.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be developed.\n\nThe starting point is the strong form of the boundary value problem:\n$$\n- \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) = f_0 \\quad \\text{for } x \\in (0,1)\n$$\nwith boundary conditions $u(0)=0$ and $k \\frac{du}{dx}(1) = t_0$.\n\nTo derive the weak form, we multiply the differential equation by a suitable test function $v(x)$ and integrate over the domain $\\Omega = (0,1)$:\n$$\n-\\int_{0}^{1} v \\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) dx = \\int_{0}^{1} v f_0 dx\n$$\nApplying integration by parts to the left-hand side term gives:\n$$\n\\int_{0}^{1} \\frac{dv}{dx} k \\frac{du}{dx} dx - \\left[ v k \\frac{du}{dx} \\right]_{0}^{1} = \\int_{0}^{1} v f_0 dx\n$$\nRearranging and substituting the boundary conditions:\n$$\n\\int_{0}^{1} k \\frac{du}{dx} \\frac{dv}{dx} dx = \\int_{0}^{1} f_0 v dx + v(1) \\left(k \\frac{du}{dx}(1)\\right) - v(0) \\left(k \\frac{du}{dx}(0)\\right)\n$$\nThe essential boundary condition is $u(0)=0$. The test function $v$ must belong to a space of functions where this condition is met in its homogeneous form, i.e., $v(0)=0$. This causes the term involving $v(0)$ to vanish. The natural boundary condition is $k \\frac{du}{dx}(1) = t_0$. This value is substituted directly.\n\nThe weak form is: Find $u(x) \\in V = \\{ w \\in H^1(0,1) | w(0)=0 \\}$ such that for all $v(x) \\in V$:\n$$\n\\int_{0}^{1} k u'(x) v'(x) dx = \\int_{0}^{1} f_0 v(x) dx + t_0 v(1)\n$$\nThe domain $[0,1]$ is discretized into two uniform elements, denoted $\\Omega_1 = [0, \\tfrac{1}{2}]$ and $\\Omega_2 = [\\tfrac{1}{2}, 1]$. The nodes are at $x_0=0$, $x_1=\\tfrac{1}{2}$, and $x_2=1$. The element length is $h = \\tfrac{1}{2}$.\n\nWe approximate the solution $u(x)$ using linear basis (shape) functions $N_i(x)$:\n$$\nu(x) \\approx u^h(x) = \\sum_{j=0}^{2} u_j N_j(x) = u_0 N_0(x) + u_1 N_1(x) + u_2 N_2(x)\n$$\nwhere $u_j = u(x_j)$ are the nodal values. The Galerkin method uses the basis functions as test functions, $v(x) = N_i(x)$.\n\nThe elemental stiffness matrix for a linear element of length $h$ is given by $K^{(e)}_{ij} = \\int_{\\Omega_e} k \\frac{dN_j}{dx} \\frac{dN_i}{dx} dx$. For a constant $k$ and element length $h$, this is:\n$$\nK^{(e)} = \\frac{k}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nSince $h=\\tfrac{1}{2}$, the stiffness matrix for both elements is:\n$$\nK^{(1)} = K^{(2)} = \\frac{k}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\nThe elemental force vector from the source term $f_0$ is $F^{(e)}_{f,i} = \\int_{\\Omega_e} f_0 N_i dx$. For a constant $f_0$ and linear element, this is:\n$$\nF^{(e)}_f = \\frac{f_0 h}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nSince $h=\\tfrac{1}{2}$, the force vector for both elements is:\n$$\nF^{(1)}_f = F^{(2)}_f = \\frac{f_0 (1/2)}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/4 \\end{pmatrix}\n$$\nNow, we assemble the $3 \\times 3$ global system $K \\mathbf{u} = F$.\nThe global stiffness matrix $K$ is assembled by summing the contributions from each element:\n$$\nK_{00} = K^{(1)}_{11} = 2k\n$$\n$$\nK_{11} = K^{(1)}_{22} + K^{(2)}_{11} = 2k + 2k = 4k\n$$\n$$\nK_{22} = K^{(2)}_{22} = 2k\n$$\n$$\nK_{01} = K_{10} = K^{(1)}_{12} = -2k\n$$\n$$\nK_{12} = K_{21} = K^{(2)}_{12} = -2k\n$$\nSo, the global stiffness matrix is:\n$$\nK = \\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix}\n$$\nThe global force vector $F$ has contributions from the source term $f_0$ and the natural boundary condition $t_0$. The total force vector is $F_i = \\int_0^1 f_0 N_i dx + t_0 N_i(1)$.\n$$\nF_0 = \\int_{\\Omega_1} f_0 N_0 dx + t_0 N_0(1) = f_0/4 + t_0(0) = f_0/4\n$$\n$$\nF_1 = \\int_{\\Omega_1} f_0 N_1 dx + \\int_{\\Omega_2} f_0 N_1 dx + t_0 N_1(1) = f_0/4 + f_0/4 + t_0(0) = f_0/2\n$$\n$$\nF_2 = \\int_{\\Omega_2} f_0 N_2 dx + t_0 N_2(1) = f_0/4 + t_0(1) = f_0/4 + t_0\n$$\nThe assembled system is:\n$$\n\\begin{pmatrix} 2k & -2k & 0 \\\\ -2k & 4k & -2k \\\\ 0 & -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/4 \\\\ f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\nNext, we impose the essential boundary condition $u(0)=u_0=0$. This reduces the system to a $2 \\times 2$ system for the unknown nodal values $u_1$ and $u_2$. We consider the second and third rows of the full system and substitute $u_0=0$:\n$$\n-2k(u_0) + 4k u_1 - 2k u_2 = f_0/2 \\implies 4k u_1 - 2k u_2 = f_0/2\n$$\n$$\n0(u_0) - 2k u_1 + 2k u_2 = f_0/4 + t_0 \\implies -2k u_1 + 2k u_2 = f_0/4 + t_0\n$$\nThe resulting reduced $2 \\times 2$ system is:\n$$\n\\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} f_0/2 \\\\ f_0/4 + t_0 \\end{pmatrix}\n$$\nThe problem asks for the determinant of the assembled reduced $2 \\times 2$ global stiffness matrix, which is:\n$$\nK_{reduced} = \\begin{pmatrix} 4k & -2k \\\\ -2k & 2k \\end{pmatrix}\n$$\nThe determinant is calculated as:\n$$\n\\det(K_{reduced}) = (4k)(2k) - (-2k)(-2k) = 8k^2 - 4k^2 = 4k^2\n$$\nThis is the required expression.", "answer": "$$\\boxed{4k^{2}}$$", "id": "2440325"}, {"introduction": "A key advantage of the weak formulation is its inherent ability to handle concentrated loads and sources with mathematical elegance. In this problem, a point source is deliberately placed within an element rather than at a node, a situation that is handled seamlessly by the integral nature of the weak form. This practice demonstrates how the variational framework naturally distributes singular inputs into consistent nodal forces, a feature that is less direct to handle using the strong form alone [@problem_id:2440379].", "problem": "A slender rod of length $L$ and constant cross-sectional area $A$ conducts heat in steady state with constant thermal conductivity $k$. There is no distributed volumetric heat source, but a concentrated point heat input of total rate $Q$ (in Watts) is applied at position $x_p$, where $0 < x_p < a < L$. The boundary temperatures are prescribed as $u(0) = 0$ and $u(L) = 0$. You will derive the strong form and weak form of the boundary value problem, then approximate the solution using the Finite Element Method (FEM) with a mesh of two linear elements and three nodes at $x_0 = 0$, $x_1 = a$, and $x_2 = L$, deliberately choosing $x_p \\neq x_i$ for any node so that the point source lies strictly within the left element.\n\nStarting only from conservation of energy and Fourier’s law, and without assuming any shortcut formulas:\n\n- Derive the strong form for the temperature field $u(x)$ on $(0,L)$ that models this situation, including all boundary conditions.\n- Derive the weak form by multiplying the strong form by an arbitrary smooth test function $v(x)$ satisfying the essential boundary conditions and integrating by parts exactly once, identifying the function spaces involved.\n- Construct the two-node linear shape functions on each element and use the weak form to obtain the element-level and assembled global finite element equilibrium equations for the three nodal temperatures $u_0$, $u_1$, and $u_2$.\n- Enforce the essential boundary conditions $u_0 = 0$ and $u_2 = 0$ and solve the resulting reduced system in closed form for the interior nodal temperature $u_1$ as a function of $Q$, $k$, $A$, $L$, $a$, and $x_p$.\n\nProvide your final result as a single closed-form analytic expression for $u_1$. Express the temperature in Kelvin.", "solution": "The problem will be validated before any attempt at a solution is made. This is not optional; it is a necessity for rigorous scientific work.\n\nStep 1: Extract Givens.\n- A slender rod of length $L$ and constant cross-sectional area $A$.\n- Heat conduction is in steady state.\n- Thermal conductivity $k$ is constant.\n- There is no distributed volumetric heat source.\n- A concentrated point heat input of total rate $Q$ is applied at position $x_p$.\n- The position of the source satisfies $0 < x_p < a < L$.\n- Prescribed boundary temperatures: $u(0) = 0$ and $u(L) = 0$.\n- The solution is to be approximated using the Finite Element Method (FEM) with a mesh of two linear elements.\n- The three nodes are at $x_0 = 0$, $x_1 = a$, and $x_2 = L$.\n- The point source is located strictly within the first element, as $x_p \\neq x_i$ for any node $i$.\n- The final result for the nodal temperature $u_1$ must be a single closed-form analytic expression.\n- The temperature is to be expressed in Kelvin.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is assessed against the criteria for validity.\n- **Scientific Grounding**: The problem is based on the fundamental principles of heat transfer, namely the conservation of energy and Fourier's law of heat conduction. The use of a point heat source, mathematically represented by a Dirac delta function, is a standard and valid idealization in physics and engineering analysis. The problem is scientifically sound.\n- **Well-Posedness**: The problem describes a second-order ordinary differential equation with prescribed Dirichlet boundary conditions at both ends. This constitutes a well-posed boundary value problem, for which a unique solution is expected to exist.\n- **Objectivity**: The problem is stated using precise, unambiguous technical language. It is free of subjective or opinion-based content.\n- **Completeness and Consistency**: All necessary parameters ($L, A, k, Q, x_p, a$), boundary conditions, and geometric constraints are provided. The conditions are internally consistent (e.g., $0 < x_p < a < L$ correctly places the source within the first element of the defined mesh).\n- **Physical Realism**: While a boundary condition of $u(0) = 0$ Kelvin is physically impossible, it is a common mathematical simplification in theoretical problems, typically representing a temperature difference relative to a reference. We will proceed under this understanding that it is a mathematical idealization.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be derived.\n\nThe derivation will proceed in the four stages requested.\n\nFirst, we derive the strong form of the boundary value problem.\nThe governing principle is the conservation of energy in steady state. For any arbitrary segment of the rod $[x_a, x_b]$ not containing the source at $x_p$, the rate of heat entering at $x_a$ must equal the rate of heat exiting at $x_b$. The heat flow rate is given by the product of heat flux, $q(x)$, and area, $A$. Thus, $q(x_a)A - q(x_b)A = 0$.\nFourier's law states that $q(x) = -k \\frac{du}{dx}$. Substituting this into the energy balance gives $-kA\\frac{du}{dx}|_{x_a} - (-kA\\frac{du}{dx}|_{x_b}) = 0$. Since this holds for any interval $[x_a, x_b]$, it implies that the quantity $-kA \\frac{du}{dx}$ is constant. Differentiating with respect to $x$ gives the governing differential equation for regions without sources:\n$$\n\\frac{d}{dx}\\left(-kA\\frac{du}{dx}\\right) = 0\n$$\nSince $k$ and $A$ are constant, this simplifies to $\\frac{d^2u}{dx^2} = 0$ for $x \\in (0, L)$ and $x \\neq x_p$.\n\nAt the location of the point source, $x_p$, we perform an energy balance over an infinitesimal control volume $[x_p - \\epsilon, x_p + \\epsilon]$ as $\\epsilon \\to 0$. The balance is: (heat in at $x_p-\\epsilon$) - (heat out at $x_p+\\epsilon$) + (source term) = $0$.\n$$\n\\left(-kA\\frac{du}{dx}\\right)\\bigg|_{x_p-\\epsilon} - \\left(-kA\\frac{du}{dx}\\right)\\bigg|_{x_p+\\epsilon} + Q = 0\n$$\nThis represents a discontinuity in the heat flux. We can express the source term $Q$ distributed over the domain using the Dirac delta function, $\\delta(x-x_p)$. The governing equation for the entire domain $(0,L)$ becomes:\n$$\n-kA\\frac{d^2u}{dx^2} = Q \\delta(x-x_p)\n$$\nThe strong form is to find the temperature field $u(x)$ that satisfies this differential equation subject to the prescribed Dirichlet boundary conditions: $u(0)=0$ and $u(L)=0$.\n\nSecond, we derive the weak form.\nWe multiply the strong form's differential equation by a smooth test function $v(x)$ and integrate over the domain $\\Omega = (0, L)$. The test function $v(x)$ must belong to a function space $V$ where functions satisfy the homogeneous form of the essential boundary conditions, i.e., $v(0)=0$ and $v(L)=0$.\n$$\n\\int_0^L \\left(-kA\\frac{d^2u}{dx^2} - Q \\delta(x-x_p)\\right) v(x) \\,dx = 0\n$$\nThis must hold for all $v \\in V$. We separate the terms:\n$$\n-\\int_0^L kA\\frac{d^2u}{dx^2} v(x) \\,dx - \\int_0^L Q \\delta(x-x_p) v(x) \\,dx = 0\n$$\nThe second integral is evaluated using the sifting property of the Dirac delta function: $\\int_0^L Q \\delta(x-x_p) v(x) \\,dx = Q v(x_p)$.\nWe apply integration by parts to the first term, $\\int u''v = [u'v] - \\int u'v'$:\n$$\n-\\int_0^L kA\\frac{d^2u}{dx^2} v(x) \\,dx = -kA \\left[ \\frac{du}{dx} v(x) \\right]_0^L + \\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx\n$$\nThe boundary term, $-kA \\left( \\frac{du}{dx}|_L v(L) - \\frac{du}{dx}|_0 v(0) \\right)$, vanishes because $v(L)=0$ and $v(0)=0$ for any test function $v \\in V$.\nSubstituting back, the equation becomes:\n$$\n\\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx - Q v(x_p) = 0\n$$\nThe weak form is: Find $u \\in U = \\{u \\in H^1(0,L) \\mid u(0)=0, u(L)=0\\}$ such that for all $v \\in V = \\{v \\in H^1(0,L) \\mid v(0)=0, v(L)=0\\}$, the following relation holds:\n$$\n\\int_0^L kA \\frac{du}{dx} \\frac{dv}{dx} \\,dx = Q v(x_p)\n$$\nHere, $H^1(0,L)$ is the Sobolev space of functions defined on $(0,L)$ with square-integrable first derivatives.\n\nThird, we construct the finite element approximation.\nThe domain $[0, L]$ is discretized by nodes $x_0=0, x_1=a, x_2=L$, forming two elements: element $1$ over $[0,a]$ and element $2$ over $[a,L]$.\nThe temperature field $u(x)$ and test function $v(x)$ are approximated using linear shape functions $N_i(x)$:\n$u(x) \\approx u_h(x) = \\sum_{i=0}^{2} u_i N_i(x)$ and $v(x) \\approx v_h(x) = \\sum_{j=0}^{2} c_j N_j(x)$, where $u_i$ are the unknown nodal temperatures and $c_j$ are arbitrary coefficients.\n\nThe global shape functions $N_i(x)$ are piecewise linear.\nFor element $1$ ($x \\in [0, a]$, length $L_e^{(1)}=a$):\n$N_0^{(1)}(x) = 1 - \\frac{x}{a}$, $N_1^{(1)}(x) = \\frac{x}{a}$.\nTheir derivatives are $\\frac{dN_0^{(1)}}{dx} = -\\frac{1}{a}$, $\\frac{dN_1^{(1)}}{dx} = \\frac{1}{a}$.\n\nFor element $2$ ($x \\in [a, L]$, length $L_e^{(2)}=L-a$):\n$N_1^{(2)}(x) = 1 - \\frac{x-a}{L-a} = \\frac{L-x}{L-a}$, $N_2^{(2)}(x) = \\frac{x-a}{L-a}$.\nTheir derivatives are $\\frac{dN_1^{(2)}}{dx} = -\\frac{1}{L-a}$, $\\frac{dN_2^{(2)}}{dx} = \\frac{1}{L-a}$.\n\nSubstituting these approximations into the weak form gives the algebraic system $[K]\\{u\\}=\\{F\\}$.\nThe stiffness matrix components are $K_{ji} = \\int_0^L kA \\frac{dN_j}{dx} \\frac{dN_i}{dx} dx$.\nThe force vector components are $F_j = Q N_j(x_p)$.\n\nThe element stiffness matrix for a 1D linear element of length $L_e$ is $k^{(e)} = \\frac{kA}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nFor element $1$ (nodes $0, 1$), $L_e=a$: $k^{(1)} = \\frac{kA}{a} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nFor element $2$ (nodes $1, 2$), $L_e=L-a$: $k^{(2)} = \\frac{kA}{L-a} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\nThe source $Q$ at $x_p$ is located within element $1$ since $0 < x_p < a$.\nThe element force vector is $F^{(e)}_j = \\int_{L_e} Q \\delta(x-x_p) N_j^{(e)}(x) dx = Q N_j^{(e)}(x_p)$.\nFor element 1 (nodes 0, 1): $F^{(1)} = \\begin{pmatrix} Q N_0^{(1)}(x_p) \\\\ Q N_1^{(1)}(x_p) \\end{pmatrix} = Q \\begin{pmatrix} 1-x_p/a \\\\ x_p/a \\end{pmatrix}$.\nFor element 2, there is no source: $F^{(2)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\n\nAssembling the global system for nodes $(0, 1, 2)$:\n$K_{00} = k^{(1)}_{00} = \\frac{kA}{a}$\n$K_{11} = k^{(1)}_{11} + k^{(2)}_{11} = \\frac{kA}{a} + \\frac{kA}{L-a}$\n$K_{22} = k^{(2)}_{22} = \\frac{kA}{L-a}$\n$K_{01}=K_{10} = k^{(1)}_{01} = -\\frac{kA}{a}$\n$K_{12}=K_{21} = k^{(2)}_{12} = -\\frac{kA}{L-a}$\n$K_{02}=K_{20} = 0$\nThe global stiffness matrix is $K = kA \\begin{pmatrix} \\frac{1}{a} & -\\frac{1}{a} & 0 \\\\ -\\frac{1}{a} & \\frac{1}{a} + \\frac{1}{L-a} & -\\frac{1}{L-a} \\\\ 0 & -\\frac{1}{L-a} & \\frac{1}{L-a} \\end{pmatrix}$.\n\nThe global force vector is $F = \\begin{pmatrix} F^{(1)}_0 \\\\ F^{(1)}_1 + F^{(2)}_1 \\\\ F^{(2)}_2 \\end{pmatrix} = \\begin{pmatrix} Q(1-x_p/a) \\\\ Q(x_p/a) \\\\ 0 \\end{pmatrix}$.\n\nThe full system of equations is:\n$$\nkA \\begin{pmatrix} \\frac{1}{a} & -\\frac{1}{a} & 0 \\\\ -\\frac{1}{a} & \\frac{1}{a} + \\frac{1}{L-a} & -\\frac{1}{L-a} \\\\ 0 & -\\frac{1}{L-a} & \\frac{1}{L-a} \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = Q \\begin{pmatrix} 1 - \\frac{x_p}{a} \\\\ \\frac{x_p}{a} \\\\ 0 \\end{pmatrix}\n$$\n\nFourth, we enforce boundary conditions and solve for $u_1$.\nThe essential boundary conditions are $u_0 = 0$ and $u_2 = 0$. These nodes are constrained. The only unknown is the temperature $u_1$ at the free node $x_1=a$. We only need the equation corresponding to this degree of freedom, which is the second row of the matrix system:\n$$\nkA \\left[ -\\frac{1}{a} u_0 + \\left(\\frac{1}{a} + \\frac{1}{L-a}\\right)u_1 - \\frac{1}{L-a} u_2 \\right] = Q \\frac{x_p}{a}\n$$\nSubstituting $u_0 = 0$ and $u_2 = 0$:\n$$\nkA \\left(\\frac{1}{a} + \\frac{1}{L-a}\\right)u_1 = Q \\frac{x_p}{a}\n$$\nWe simplify the term in the parenthesis:\n$$\n\\frac{1}{a} + \\frac{1}{L-a} = \\frac{L-a+a}{a(L-a)} = \\frac{L}{a(L-a)}\n$$\nThe equation for $u_1$ becomes:\n$$\nkA \\frac{L}{a(L-a)} u_1 = Q \\frac{x_p}{a}\n$$\nFinally, we solve for $u_1$:\n$$\nu_1 = \\frac{Q x_p/a}{kA L / (a(L-a))} = \\frac{Q x_p}{a} \\cdot \\frac{a(L-a)}{kA L}\n$$\n$$\nu_1 = \\frac{Q x_p (L-a)}{k A L}\n$$\nThis is the closed-form solution for the temperature at node $x_1=a$. The unit analysis $\\frac{[W][m][m]}{[W/(m \\cdot K)][m^2][m]} = [K]$ confirms the result is a temperature, consistent with the problem's request.", "answer": "$$\n\\boxed{\\frac{Q x_p (L-a)}{k A L}}\n$$", "id": "2440379"}, {"introduction": "While strongly enforcing essential boundary conditions is common, modern computational methods often require the flexibility of weak enforcement, especially in multiphysics or contact problems. This advanced practice introduces the symmetric Nitsche's method, a powerful technique for weakly imposing Dirichlet conditions that modifies the bilinear form with consistency and stability terms. By deriving the modified stiffness matrix and performing a stability analysis, you will gain insight into the theoretical and practical aspects of this important variational crime [@problem_id:2711092].", "problem": "A prismatic, linearly elastic bar of length $L$, constant cross-sectional area $A$, and Young’s modulus $E$ occupies the interval $\\Omega = (0,L)$. Let $u(x)$ denote the axial displacement. The governing strong form under quasi-static, small-strain assumptions with no body force is\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)=0\\quad\\text{in}\\ \\Omega,\n$$\nwith a homogeneous Dirichlet boundary condition $u(0)=0$ at the left end and a homogeneous Neumann boundary condition $\\sigma(L)n(L)=0$ at the right end, where $\\sigma=E\\varepsilon$ with $\\varepsilon = u'$ and $n$ is the outward unit normal ($n(0)=-1$, $n(L)=+1$). You will treat the Dirichlet boundary condition $u(0)=0$ by three weak imposition strategies and then specialize to a single linear finite element to extract a stability threshold.\n\nTasks:\n1) Starting from the strong form and the definitions $\\varepsilon=u'$ and $\\sigma=E\\varepsilon$, derive the standard weak form by multiplying the equilibrium equation by an admissible test function $v$ and integrating by parts. State clearly the boundary terms that arise and how they are treated when $u(0)=0$ is not imposed strongly.\n\n2) For the boundary $\\Gamma_D=\\{0\\}$, write down the modified weak forms that weakly enforce $u(0)=0$ using each of the following:\n- Penalty method with penalty parameter $\\alpha>0$ scaled as $(\\alpha EA/h)\\int_{\\Gamma_D}uv$, where $h$ is a characteristic mesh size associated with $\\Gamma_D$.\n- Symmetric Nitsche method with stabilization parameter $\\gamma>0$ scaled as $(\\gamma EA/h)\\int_{\\Gamma_D}uv$.\n- Lagrange multiplier method introducing an auxiliary unknown $\\lambda$ on $\\Gamma_D$.\n\nTake the prescribed displacement to be homogeneous, $u_D=0$, so that all load-like contributions from the boundary condition vanish.\n\n3) Consider a single two-node linear Finite Element Method (FEM) discretization over the entire bar, with nodal unknowns $u_1=u(0)$ and $u_2=u(L)$, and shape functions $N_1(x)=1-x/L$ and $N_2(x)=x/L$. Using the symmetric Nitsche formulation from part $2$, assemble the element stiffness contributions from the domain integral and the boundary terms at $x=0$. Express the resulting $2\\times 2$ element stiffness matrix as a function of $E$, $A$, $L$, $h$, and $\\gamma$.\n\n4) Determine the smallest value of the Nitsche stabilization parameter $\\gamma$ that guarantees the resulting $2\\times 2$ element stiffness matrix is positive definite. Express your final answer as a single closed-form analytic expression in terms of $h$ and $L$ only. Do not include units. No numerical rounding is required.", "solution": "The problem will be validated against the required criteria before a solution is attempted.\n\n### Step 1: Extract Givens\n- Governing Equation: $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)=0$ in the domain $\\Omega = (0,L)$.\n- Material and Geometric Properties: Linearly elastic bar with constant cross-sectional area $A$, Young’s modulus $E$, and length $L$.\n- Kinematics: $u(x)$ is the axial displacement, $\\varepsilon=u'$ is the strain.\n- Constitutive Law: $\\sigma=E\\varepsilon$.\n- Boundary Conditions (Strong Form): Homogeneous Dirichlet $u(0)=0$ at $x=0$. Homogeneous Neumann $\\sigma(L)n(L)=0$ at $x=L$.\n- Outward Unit Normal: $n(0)=-1$, $n(L)=+1$.\n- Weak Imposition Methods for $u(0)=u_D=0$:\n  - Penalty method: Modified weak form includes the term $(\\alpha EA/h)\\int_{\\Gamma_D}uv$ with penalty parameter $\\alpha>0$ and characteristic length $h$.\n  - Symmetric Nitsche method: Modified weak form uses a stabilization parameter $\\gamma>0$ and a term scaled as $(\\gamma EA/h)\\int_{\\Gamma_D}uv$.\n  - Lagrange multiplier method: Introduces an auxiliary unknown $\\lambda$ on $\\Gamma_D=\\{0\\}$.\n- Finite Element Discretization: A single two-node linear element is used.\n  - Nodal displacements: $u_1 = u(0)$, $u_2 = u(L)$.\n  - Shape functions: $N_1(x) = 1-x/L$, $N_2(x) = x/L$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the standard theory of linear elasticity and computational solid mechanics (Finite Element Method). The concepts of strong and weak forms, integration by parts, and boundary condition imposition techniques (Penalty, Nitsche, Lagrange multiplier) are fundamental and well-established in this field. The problem is well-posed, providing all necessary information for a sequence of logical derivations. The language is objective and precise. The problem does not violate any of the invalidity criteria. It is a standard, albeit non-trivial, exercise in applied mechanics and numerical analysis.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n***\n\nThe solution proceeds by addressing each of the four specified tasks.\n\n### Task 1: Derivation of the Standard Weak Form\nThe strong form of the equilibrium equation is given as:\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) = 0, \\quad x \\in \\Omega=(0,L)\n$$\nTo derive the weak form, we multiply this equation by an arbitrary, admissible test function $v(x)$ and integrate over the domain $\\Omega$:\n$$\n-\\int_{0}^{L} v(x) \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) \\mathrm{d}x = 0\n$$\nApplying integration by parts, $\\int_a^b f'g \\, dx = [fg]_a^b - \\int_a^b fg' \\, dx$, with $g=v$ and $f' = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(EA\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)$, yields:\n$$\n\\int_{0}^{L} \\frac{\\mathrm{d}v}{\\mathrm{d}x}\\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right) \\mathrm{d}x - \\left[v(x) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\right]_{0}^{L} = 0\n$$\nExpanding the boundary term, we obtain:\n$$\n\\int_{0}^{L} EA \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\mathrm{d}x = v(L) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\bigg|_{x=L} - v(0) \\left(EA\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)\\bigg|_{x=0}\n$$\nThe terms on the right-hand side are the boundary terms. They represent the work done by the boundary tractions. The traction is defined as $t = \\sigma n = (E\\varepsilon)n$.\nAt the right end, $x=L$, the outward normal is $n(L)=+1$. The traction is $t(L)=\\sigma(L)n(L) = E u'(L)$. The problem states a homogeneous Neumann condition $\\sigma(L)n(L)=0$, which implies $E u'(L)=0$. Consequently, the boundary term at $x=L$ vanishes: $v(L) \\left(EA\\,u'(L)\\right) = 0$.\nAt the left end, $x=0$, the outward normal is $n(0)=-1$. The traction is $t(0)=\\sigma(0)n(0) = -E u'(0)$. The boundary term at $x=0$ is $-v(0) (EA u'(0))$.\n\nWhen the Dirichlet condition $u(0)=0$ is not imposed strongly on the function spaces for $u$ and $v$, this boundary term at $x=0$ persists. The resulting weak form is:\nFind $u(x)$ such that for all admissible $v(x)$:\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x = -v(0) \\left(EA\\,u'(0)\\right)\n$$\nThe term at $x=0$, namely $-v(0) (EA u'(0))$, is the boundary term that must be handled by the weak imposition methods, as it contains the unknown flux (reaction force) $EA u'(0)$ at the Dirichlet boundary.\n\n### Task 2: Modified Weak Forms\nThe goal is to weakly enforce the condition $u(0)=u_D=0$.\n\n**Penalty Method:** This method adds a penalty term to the weak form that penalizes deviations from the Dirichlet condition. The unknown flux term is discarded. The specified penalty term is $\\frac{\\alpha EA}{h} \\int_{\\Gamma_D} uv \\,d\\Gamma$. For $\\Gamma_D=\\{0\\}$, this integral becomes a point evaluation scaled by the penalty parameter $\\alpha>0$. The modified weak form is:\nFind $u(x)$ such that for all $v(x)$:\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + \\frac{\\alpha EA}{h} u(0) v(0) = 0\n$$\n\n**Symmetric Nitsche Method:** This method replaces the unknown reaction force term with a set of terms that enforce the condition weakly while maintaining symmetry. The formulation is constructed by subtracting the work of the tractions for both trial and test functions from the standard bilinear form, and adding a stabilization term. For the boundary $\\Gamma_D=\\{0\\}$ with outward normal $n=-1$, the traction is $t(u) = \\sigma(u) n = -EAu'$. The weak form becomes:\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x - t(u)v(0) - t(v)u(0) + \\frac{\\gamma EA}{h} u(0)v(0) = 0\n$$\nSubstituting $t(u) = -EAu'$ and $t(v) = -EAv'$:\nFind $u(x)$ such that for all $v(x)$:\n$$\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + E A u'(0)v(0) + E A v'(0)u(0) + \\frac{\\gamma EA}{h} u(0)v(0) = 0\n$$\n\n**Lagrange Multiplier Method:** This method introduces a Lagrange multiplier $\\lambda$ to enforce the constraint $u(0)=u_D=0$. $\\lambda$ acts as the reaction force. We form a mixed system. The modified weak formulation is a system of two equations:\nFind $(u, \\lambda) \\in H^1(\\Omega) \\times \\mathbb{R}$ such that for all test functions $(v, \\mu) \\in H^1(\\Omega) \\times \\mathbb{R}$:\n$$\n\\begin{cases}\n\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + \\lambda v(0) = 0 \\\\\n\\mu u(0) = 0\n\\end{cases}\n$$\n\n### Task 3: FEM Discretization with Symmetric Nitsche\nWe discretize the fields $u(x)$ and $v(x)$ using the given linear shape functions:\n$u(x) = N_1(x)u_1 + N_2(x)u_2$ and $v(x) = N_1(x)v_1 + N_2(x)v_2$.\nThe derivatives are constant: $u'(x) = N_1'u_1 + N_2'u_2 = -\\frac{1}{L}u_1 + \\frac{1}{L}u_2 = \\frac{u_2-u_1}{L}$. Similarly, $v'(x) = \\frac{v_2-v_1}{L}$.\nThe values at the boundary $x=0$ are $u(0)=u_1$ and $v(0)=v_1$.\nWe assemble the element stiffness matrix $\\mathbf{K}$ from the symmetric Nitsche weak form $B_N(u,v)=0$, which is represented as $\\mathbf{v}^T \\mathbf{K} \\mathbf{u} = 0$. We evaluate each term.\n\n1.  **Domain Term**:\n    $$\n    \\int_0^L EA u' v' \\, \\mathrm{d}x = \\int_0^L EA \\left(\\frac{u_2-u_1}{L}\\right) \\left(\\frac{v_2-v_1}{L}\\right) \\mathrm{d}x = \\frac{EA}{L}(u_2-u_1)(v_2-v_1)\n    $$\n    This corresponds to the standard bar element stiffness matrix: $\\mathbf{K}_{\\text{domain}} = \\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\n2.  **Nitsche Boundary Terms at $x=0$**:\n    Using the correct weak form: $\\int_{0}^{L} EA u' v' \\, \\mathrm{d}x + E A u'(0)v(0) + E A v'(0)u(0) + \\frac{\\gamma EA}{h} u(0)v(0) = 0$.\n    Consistency term contribution: $+EAu'(0)v(0) = EA \\frac{u_2-u_1}{L} v_1 = \\frac{EA}{L}(-v_1u_1 + v_1u_2)$. Matrix: $\\mathbf{K}_{N1} = \\frac{EA}{L}\\begin{pmatrix} -1 & 1 \\\\ 0 & 0 \\end{pmatrix}$.\n    Symmetry term contribution: $+EAv'(0)u(0) = EA \\frac{v_2-v_1}{L} u_1 = \\frac{EA}{L}(-u_1v_1 + u_1v_2)$. Matrix: $\\mathbf{K}_{N2} = \\frac{EA}{L}\\begin{pmatrix} -1 & 0 \\\\ 1 & 0 \\end{pmatrix}$.\n    Stabilization term contribution: $+\\frac{\\gamma EA}{h} u(0)v(0) = \\frac{\\gamma EA}{h} u_1v_1$. Matrix: $\\mathbf{K}_{N3} = \\frac{\\gamma EA}{h}\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$.\n\n3.  **Total Element Stiffness Matrix**:\n    The total stiffness matrix $\\mathbf{K}$ is the sum $\\mathbf{K}_{\\text{domain}} + \\mathbf{K}_{N1} + \\mathbf{K}_{N2} + \\mathbf{K}_{N3}$.\n    $$\n    \\mathbf{K} = \\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} + \\frac{EA}{L}\\begin{pmatrix} -1 & 1 \\\\ 0 & 0 \\end{pmatrix} + \\frac{EA}{L}\\begin{pmatrix} -1 & 0 \\\\ 1 & 0 \\end{pmatrix} + \\frac{\\gamma EA}{h}\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n    $$\n    Summing the components:\n    $K_{11} = \\frac{EA}{L}(1 - 1 - 1) + \\frac{\\gamma EA}{h} = -\\frac{EA}{L} + \\frac{\\gamma EA}{h}$\n    $K_{12} = \\frac{EA}{L}(-1 + 1 + 0) = 0$\n    $K_{21} = \\frac{EA}{L}(-1 + 0 + 1) = 0$\n    $K_{22} = \\frac{EA}{L}(1) = \\frac{EA}{L}$\n    The resulting $2\\times 2$ element stiffness matrix is:\n    $$\n    \\mathbf{K} = \\begin{pmatrix} -\\frac{EA}{L} + \\frac{\\gamma EA}{h} & 0 \\\\ 0 & \\frac{EA}{L} \\end{pmatrix}\n    $$\n\n### Task 4: Stability Threshold for $\\gamma$\nFor the matrix $\\mathbf{K}$ to be positive definite, its leading principal minors must be strictly positive. For a symmetric $2 \\times 2$ matrix, this requires $K_{11} > 0$ and $\\det(\\mathbf{K}) > 0$.\n\n1.  **First Condition ($K_{11} > 0$)**:\n    $$\n    K_{11} = -\\frac{EA}{L} + \\frac{\\gamma EA}{h} > 0\n    $$\n    Given that $E, A, L, h$ are positive physical quantities, we can simplify:\n    $$\n    \\frac{\\gamma}{h} > \\frac{1}{L} \\implies \\gamma > \\frac{h}{L}\n    $$\n\n2.  **Second Condition ($\\det(\\mathbf{K}) > 0$)**:\n    Since the matrix is diagonal, the determinant is the product of the diagonal entries:\n    $$\n    \\det(\\mathbf{K}) = K_{11}K_{22} = \\left(-\\frac{EA}{L} + \\frac{\\gamma EA}{h}\\right)\\left(\\frac{EA}{L}\\right) > 0\n    $$\n    Since $EA/L > 0$, this inequality reduces to the same condition as the first one:\n    $$\n    -\\frac{EA}{L} + \\frac{\\gamma EA}{h} > 0 \\implies \\gamma > \\frac{h}{L}\n    $$\n    The matrix is strictly positive definite for any value of $\\gamma$ greater than $h/L$. The smallest value that guarantees this is the infimum of this set. The threshold value, which separates the stable (positive definite) region from the unstable (not positive definite) region, is this lower bound.\n\nThe smallest value of $\\gamma$ is therefore $\\frac{h}{L}$.", "answer": "$$\n\\boxed{\\frac{h}{L}}\n$$", "id": "2711092"}]}