{"hands_on_practices": [{"introduction": "In linear elasticity, the stiffness matrix is symmetric, a property rooted in the existence of a strain energy potential. However, when dealing with nonlinear systems, especially those involving non-conservative forces like follower loads, this symmetry is not guaranteed. This exercise provides a crucial counterexample by asking you to derive the tangent stiffness for a system subjected to a direction-dependent follower force, demonstrating explicitly how and why the resulting tangent operator becomes non-symmetric [@problem_id:2655351].", "problem": "A two-dimensional point-like end-effector located at position vector $\\boldsymbol{q} \\in \\mathbb{R}^{2}$ is subjected to a follower thrust of constant magnitude $P>0$ whose direction always coincides with the counterclockwise tangent to the circle centered at the origin passing through the current position $\\boldsymbol{q}$. The tangent unit vector is given by\n$$\n\\boldsymbol{t}(\\boldsymbol{q}) \\;=\\; \\frac{\\boldsymbol{R}\\,\\boldsymbol{q}}{\\|\\boldsymbol{q}\\|},\n$$\nwhere $\\|\\cdot\\|$ denotes the Euclidean norm and $\\boldsymbol{R}$ is the constant rotation-by-ninety-degrees operator in the plane,\n$$\n\\boldsymbol{R} \\;=\\; \\begin{bmatrix} 0 & -1 \\\\ 1 & 0 \\end{bmatrix}.\n$$\nAs a result, the external follower force is $\\boldsymbol{f}(\\boldsymbol{q}) = P\\,\\boldsymbol{t}(\\boldsymbol{q})$. The external virtual work is\n$$\n\\delta W_{\\mathrm{ext}}(\\boldsymbol{q};\\delta \\boldsymbol{q}) \\;=\\; \\boldsymbol{f}(\\boldsymbol{q}) \\cdot \\delta \\boldsymbol{q}.\n$$\nConsider the linearization of the nonlinear virtual work about the base configuration $\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$ with $L>0$, in the sense that for an increment $\\Delta \\boldsymbol{q}$ and a virtual displacement $\\delta \\boldsymbol{q}$,\n$$\n\\Delta\\big(\\delta W_{\\mathrm{ext}}\\big) \\;=\\; \\delta \\boldsymbol{q}^{\\mathsf{T}} \\,\\boldsymbol{K}\\, \\Delta \\boldsymbol{q} \\;+\\; \\text{higher-order terms},\n$$\nwhere $\\boldsymbol{K} = \\left.\\dfrac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}}\\right|_{\\boldsymbol{q}_{0}}$ is the tangent operator. Starting only from the definition of the external virtual work and the given follower-force direction, and without invoking any pre-stated linearization formulas, do the following:\n\n- Derive $\\boldsymbol{K}$ explicitly at $\\boldsymbol{q}_{0}$.\n- Demonstrate that $\\boldsymbol{K}$ is not symmetric, thereby constructing a counterexample in which the linearization of nonlinear virtual work is not symmetric under a nonconservative follower load.\n- Explain the physical origin of the antisymmetry in terms of the dependence of the load direction on configuration and the associated non-existence of a potential.\n\nFinally, to quantify the lack of symmetry in the linearized virtual work, evaluate the mismatch\n$$\nM \\;=\\; \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{1},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{2}} \\;-\\; \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{2},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{1}},\n$$\nwhere $\\boldsymbol{e}_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ and $\\boldsymbol{e}_{2}=\\begin{bmatrix}0\\\\1\\end{bmatrix}$ are the canonical basis vectors. Express your final answer symbolically as a closed-form analytic expression in terms of $P$ and $L$. Do not include units in your final answer.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extraction of Givens**\n- Position vector: $\\boldsymbol{q} \\in \\mathbb{R}^{2}$.\n- Thrust magnitude: $P > 0$, constant.\n- Force direction: Tangent unit vector $\\boldsymbol{t}(\\boldsymbol{q}) = \\frac{\\boldsymbol{R}\\,\\boldsymbol{q}}{\\|\\boldsymbol{q}\\|}$.\n- Rotation operator: $\\boldsymbol{R} = \\begin{bmatrix} 0 & -1 \\\\ 1 & 0 \\end{bmatrix}$.\n- External follower force: $\\boldsymbol{f}(\\boldsymbol{q}) = P\\,\\boldsymbol{t}(\\boldsymbol{q})$.\n- External virtual work: $\\delta W_{\\mathrm{ext}}(\\boldsymbol{q};\\delta \\boldsymbol{q}) = \\boldsymbol{f}(\\boldsymbol{q}) \\cdot \\delta \\boldsymbol{q}$.\n- Base configuration for linearization: $\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$ with $L>0$.\n- Linearization of virtual work: $\\Delta\\big(\\delta W_{\\mathrm{ext}}\\big) = \\delta \\boldsymbol{q}^{\\mathsf{T}} \\,\\boldsymbol{K}\\, \\Delta \\boldsymbol{q} + \\text{h.o.t.}$.\n- Tangent operator: $\\boldsymbol{K} = \\left.\\dfrac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}}\\right|_{\\boldsymbol{q}_{0}}$.\n- Mismatch to evaluate: $M = \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{1},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{2}} - \\Delta\\big(\\delta W_{\\mathrm{ext}}\\big)\\big|_{\\delta \\boldsymbol{q}=\\boldsymbol{e}_{2},\\,\\Delta \\boldsymbol{q}=\\boldsymbol{e}_{1}}$.\n- Basis vectors: $\\boldsymbol{e}_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ and $\\boldsymbol{e}_{2}=\\begin{bmatrix}0\\\\1\\end{bmatrix}$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard non-conservative follower force problem in continuum mechanics. All terms are defined mathematically, and the provided data are self-contained and consistent. The problem does not violate any fundamental principles of physics or mathematics. It is a rigorous and formalizable problem central to the topic of nonlinear mechanics.\n\n**Step 3: Verdict**\nThe problem is valid. A solution will be derived.\n\nThe first task is to derive the tangent stiffness operator $\\boldsymbol{K}$. We begin by expressing the force vector $\\boldsymbol{f}(\\boldsymbol{q})$ in terms of the components of $\\boldsymbol{q} = \\begin{bmatrix} q_1 \\\\ q_2 \\end{bmatrix}$.\nThe norm is $\\|\\boldsymbol{q}\\| = \\sqrt{q_1^2 + q_2^2}$. The rotated vector is $\\boldsymbol{R}\\,\\boldsymbol{q} = \\begin{bmatrix} -q_2 \\\\ q_1 \\end{bmatrix}$.\nThus, the force vector is:\n$$\n\\boldsymbol{f}(\\boldsymbol{q}) = \\begin{bmatrix} f_1(q_1, q_2) \\\\ f_2(q_1, q_2) \\end{bmatrix} = \\frac{P}{\\sqrt{q_1^2 + q_2^2}} \\begin{bmatrix} -q_2 \\\\ q_1 \\end{bmatrix}\n$$\nThe tangent operator $\\boldsymbol{K}$ is the Jacobian matrix of $\\boldsymbol{f}$ with respect to $\\boldsymbol{q}$:\n$$\n\\boldsymbol{K} = \\frac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{q}} = \\begin{bmatrix} \\frac{\\partial f_1}{\\partial q_1} & \\frac{\\partial f_1}{\\partial q_2} \\\\ \\frac{\\partial f_2}{\\partial q_1} & \\frac{\\partial f_2}{\\partial q_2} \\end{bmatrix}\n$$\nWe compute the partial derivatives of the components of $\\boldsymbol{f}$.\nFor $f_1 = -P q_2 (q_1^2 + q_2^2)^{-1/2}$:\n$$\n\\frac{\\partial f_1}{\\partial q_1} = -P q_2 \\left(-\\frac{1}{2}(q_1^2 + q_2^2)^{-3/2}(2q_1)\\right) = \\frac{P q_1 q_2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_1}{\\partial q_2} = P \\frac{\\partial}{\\partial q_2} \\left(\\frac{-q_2}{(q_1^2 + q_2^2)^{1/2}}\\right) = P \\left[ \\frac{-1 \\cdot (q_1^2+q_2^2)^{1/2} - (-q_2) \\cdot \\frac{1}{2}(q_1^2+q_2^2)^{-1/2}(2q_2)}{q_1^2+q_2^2} \\right] = P \\frac{-(q_1^2+q_2^2)+q_2^2}{(q_1^2+q_2^2)^{3/2}} = \\frac{-P q_1^2}{(q_1^2 + q_2^2)^{3/2}}\n$$\nFor $f_2 = P q_1 (q_1^2 + q_2^2)^{-1/2}$:\n$$\n\\frac{\\partial f_2}{\\partial q_1} = P \\frac{\\partial}{\\partial q_1} \\left(\\frac{q_1}{(q_1^2 + q_2^2)^{1/2}}\\right) = P \\left[ \\frac{1 \\cdot (q_1^2+q_2^2)^{1/2} - q_1 \\cdot \\frac{1}{2}(q_1^2+q_2^2)^{-1/2}(2q_1)}{q_1^2+q_2^2} \\right] = P \\frac{(q_1^2+q_2^2)-q_1^2}{(q_1^2+q_2^2)^{3/2}} = \\frac{P q_2^2}{(q_1^2 + q_2^2)^{3/2}}\n$$\n$$\n\\frac{\\partial f_2}{\\partial q_2} = P q_1 \\left(-\\frac{1}{2}(q_1^2 + q_2^2)^{-3/2}(2q_2)\\right) = \\frac{-P q_1 q_2}{(q_1^2 + q_2^2)^{3/2}}\n$$\nAssembling the Jacobian matrix $\\boldsymbol{K}(\\boldsymbol{q})$:\n$$\n\\boldsymbol{K}(\\boldsymbol{q}) = \\frac{P}{(q_1^2 + q_2^2)^{3/2}} \\begin{bmatrix} q_1 q_2 & -q_1^2 \\\\ q_2^2 & -q_1 q_2 \\end{bmatrix}\n$$\nNow, we evaluate this matrix at the specified base configuration $\\boldsymbol{q}_{0} = \\begin{bmatrix} L \\\\ 0 \\end{bmatrix}$. At this point, $q_1 = L$ and $q_2 = 0$. The denominator becomes $(L^2 + 0^2)^{3/2} = L^3$.\nSubstituting these values into the components of $\\boldsymbol{K}$:\n$$\nK_{11} = \\frac{P(L)(0)}{L^3} = 0\n$$\n$$\nK_{12} = \\frac{-P(L^2)}{L^3} = -\\frac{P}{L}\n$$\n$$\nK_{21} = \\frac{P(0^2)}{L^3} = 0\n$$\n$$\nK_{22} = \\frac{-P(L)(0)}{L^3} = 0\n$$\nSo, the tangent operator at $\\boldsymbol{q}_{0}$ is:\n$$\n\\boldsymbol{K} = \\begin{bmatrix} 0 & -\\frac{P}{L} \\\\ 0 & 0 \\end{bmatrix}\n$$\nTo demonstrate that $\\boldsymbol{K}$ is not symmetric, we compute its transpose:\n$$\n\\boldsymbol{K}^{\\mathsf{T}} = \\begin{bmatrix} 0 & 0 \\\\ -\\frac{P}{L} & 0 \\end{bmatrix}\n$$\nSince $P>0$ and $L>0$, the term $-P/L$ is non-zero. It is clear that $K_{12} = -P/L$ while $K_{21} = 0$, so $K_{12} \\neq K_{21}$. Therefore, $\\boldsymbol{K} \\neq \\boldsymbol{K}^{\\mathsf{T}}$, and the tangent stiffness matrix is not symmetric. This serves as the required counterexample.\n\nThe physical origin of this asymmetry lies in the non-conservative nature of the follower force. A force field $\\boldsymbol{f}$ is conservative if and only if it is the gradient of a scalar potential, $\\boldsymbol{f} = -\\nabla V$. A necessary condition for a force field to be conservative is that its Jacobian matrix be symmetric. This is a consequence of the equality of mixed partial derivatives (Clairaut's theorem), as $K_{ij} = \\frac{\\partial f_i}{\\partial q_j} = \\frac{\\partial}{\\partial q_j}(-\\frac{\\partial V}{\\partial q_i}) = -\\frac{\\partial^2 V}{\\partial q_j \\partial q_i}$, which must equal $K_{ji} = -\\frac{\\partial^2 V}{\\partial q_i \\partial q_j}$. Since we have shown that $\\boldsymbol{K}$ is asymmetric, no such potential $V(\\boldsymbol{q})$ exists for the force $\\boldsymbol{f}(\\boldsymbol{q})$. This can also be verified by computing the curl of the force field in two dimensions:\n$$\n(\\text{curl}\\,\\boldsymbol{f})_z = \\frac{\\partial f_2}{\\partial q_1} - \\frac{\\partial f_1}{\\partial q_2} = \\frac{P q_2^2}{(q_1^2 + q_2^2)^{3/2}} - \\left(\\frac{-P q_1^2}{(q_1^2 + q_2^2)^{3/2}}\\right) = \\frac{P(q_1^2 + q_2^2)}{(q_1^2 + q_2^2)^{3/2}} = \\frac{P}{\\sqrt{q_1^2 + q_2^2}} = \\frac{P}{\\|\\boldsymbol{q}\\|}\n$$\nThe curl is non-zero (for $\\|\\boldsymbol{q}\\| < \\infty$), which proves that the force field is rotational and therefore non-conservative. The work done by this force depends on the path taken. The asymmetry in the tangent stiffness matrix $\\boldsymbol{K}$ is the direct mathematical manifestation of the configuration-dependent direction of the follower load, which prevents the work from being expressed as a change in potential energy.\n\nFinally, we evaluate the mismatch $M$. The linearized virtual work is $\\Delta(\\delta W_{\\mathrm{ext}}) = \\delta \\boldsymbol{q}^{\\mathsf{T}} \\boldsymbol{K} \\Delta \\boldsymbol{q}$.\nThe mismatch is defined as:\n$$\nM = \\left(\\boldsymbol{e}_{1}^{\\mathsf{T}} \\boldsymbol{K} \\boldsymbol{e}_{2}\\right) - \\left(\\boldsymbol{e}_{2}^{\\mathsf{T}} \\boldsymbol{K} \\boldsymbol{e}_{1}\\right)\n$$\nThis expression is simply the difference between the off-diagonal components of $\\boldsymbol{K}$:\n$$\nM = K_{12} - K_{21}\n$$\nUsing the components of $\\boldsymbol{K}$ evaluated at $\\boldsymbol{q}_{0}$:\n$$\nK_{12} = -\\frac{P}{L}\n$$\n$$\nK_{21} = 0\n$$\nSubstituting these values gives the mismatch:\n$$\nM = -\\frac{P}{L} - 0 = -\\frac{P}{L}\n$$\nThis quantifies the lack of symmetry in the linearized virtual work for the given infinitesimal virtual and real displacements.", "answer": "$$\n\\boxed{-\\frac{P}{L}}\n$$", "id": "2655351"}, {"introduction": "While non-conservative forces can break symmetry, the linearization of virtual work for hyperelastic materials (which are inherently conservative) yields a symmetric tangent stiffness, crucial for stability analyses. This practice guides you through the derivation of the incremental shear modulus for a pre-stressed, incompressible neo-Hookean solid [@problem_id:2655366]. By performing the linearization about a deformed state, you will gain hands-on experience with the rate form of constitutive laws and see how initial stresses contribute to the material's tangent response.", "problem": "A homogeneous, incompressible neo-Hookean solid occupies a current configuration obtained from a uniform finite pre-deformation with principal stretches $\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$ along an orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$, subject to the isochoric constraint $\\lambda_{1}\\lambda_{2}\\lambda_{3}=1$. The strain-energy density per unit reference volume is $\\Psi=\\frac{\\mu}{2}(I_{1}-3)$, where $I_{1}=\\operatorname{tr}\\mathbf{C}$ and $\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$, with $\\mathbf{F}$ the deformation gradient, and $\\mu$ is a positive constant shear modulus. Let $\\mathbf{B}=\\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$ denote the left Cauchy–Green tensor, and let $\\boldsymbol{\\tau}$ be the Kirchhoff stress.\n\nIn the current configuration, superpose an incremental, homogeneous, isochoric, pure shear motion in the $\\mathbf{e}_{1}$–$\\mathbf{e}_{2}$ plane, with zero incremental spin, so that the rate-of-deformation tensor $\\mathbf{d}$ has only $d_{12}=d_{21}\\neq 0$ as nonzero components and $\\operatorname{tr}\\mathbf{d}=0$. Define the incremental shear modulus in this plane, $G_{12}$, as the proportionality factor such that the incremental Kirchhoff shear stress component obeys $\\dot{\\tau}_{12}=2\\,G_{12}\\,d_{12}$ under the specified incremental motion.\n\nTasks:\n- Starting from fundamental principles of finite hyperelasticity and incompressibility, derive a closed-form expression for $G_{12}$ in terms of $\\mu$, $\\lambda_{1}$, and $\\lambda_{2}$.\n- Independently confirm the same $G_{12}$ by linearizing the internal virtual work about the pre-deformed state for the same incremental motion. Consider the current-configuration internal power density $\\boldsymbol{\\tau}:\\mathbf{d}$, neglect body forces and tractions, and use a kinematically admissible virtual rate-of-deformation field of the same form, enforcing incompressibility.\n\nState the final expression for $G_{12}$ in Pascals. No numerical substitution is required, and no rounding is needed. The final answer must be a single closed-form analytic expression in terms of $\\mu$, $\\lambda_{1}$, and $\\lambda_{2}$.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed problem in finite elasticity, based on established principles of continuum mechanics and hyperelasticity. The given information is self-contained and consistent, allowing for a unique and meaningful solution. All terms are defined with sufficient rigor.\n\nThe problem asks for the derivation of the incremental shear modulus, $G_{12}$, for a pre-stretched incompressible neo-Hookean solid using two distinct methods.\n\nFirst, let us establish the fundamental relationships. The solid is described by the strain-energy density function $\\Psi=\\frac{\\mu}{2}(I_{1}-3)$, where $\\mu$ is the shear modulus, $I_{1}=\\operatorname{tr}\\mathbf{C}$, and $\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ is the right Cauchy-Green tensor. For an incompressible material, the Kirchhoff stress tensor $\\boldsymbol{\\tau}$ is related to the left Cauchy-Green tensor $\\mathbf{B}=\\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$ by\n$$ \\boldsymbol{\\tau} = -p\\mathbf{I} + 2\\frac{\\partial\\Psi}{\\partial I_1}\\mathbf{B} $$\nwhere $p$ is the hydrostatic pressure enforcing the incompressibility constraint $J=\\det\\mathbf{F}=1$. For the neo-Hookean model, $\\frac{\\partial\\Psi}{\\partial I_1} = \\frac{\\mu}{2}$, so the constitutive law simplifies to\n$$ \\boldsymbol{\\tau} = -p\\mathbf{I} + \\mu\\mathbf{B} $$\nThe initial state is a uniform finite deformation with principal stretches $\\lambda_1, \\lambda_2, \\lambda_3$ along the orthonormal basis $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$. The deformation gradient $\\mathbf{F}$ and the left Cauchy-Green tensor $\\mathbf{B}$ in this state are diagonal with respect to this basis:\n$$ [\\mathbf{F}] = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}, \\quad [\\mathbf{B}] = \\begin{pmatrix} \\lambda_{1}^{2} & 0 & 0 \\\\ 0 & \\lambda_{2}^{2} & 0 \\\\ 0 & 0 & \\lambda_{3}^{2} \\end{pmatrix} $$\nThe isochoric constraint is $\\lambda_1\\lambda_2\\lambda_3=1$.\n\n**Method 1: Derivation from the Rate Form of the Constitutive Law**\n\nWe seek the relationship between the rate of stress and the rate of deformation. The material time derivative of the constitutive equation gives the rate of change of the Kirchhoff stress:\n$$ \\dot{\\boldsymbol{\\tau}} = -\\dot{p}\\mathbf{I} + \\mu\\dot{\\mathbf{B}} $$\nThe rate of change of the left Cauchy-Green tensor, $\\dot{\\mathbf{B}}$, is related to the velocity gradient $\\mathbf{l} = \\operatorname{grad}(\\mathbf{v})$ by\n$$ \\dot{\\mathbf{B}} = \\frac{d}{dt}(\\mathbf{F}\\mathbf{F}^{\\mathsf{T}}) = \\dot{\\mathbf{F}}\\mathbf{F}^{\\mathsf{T}} + \\mathbf{F}\\dot{\\mathbf{F}}^{\\mathsf{T}} $$\nUsing the relation $\\dot{\\mathbf{F}}=\\mathbf{l}\\mathbf{F}$, we find\n$$ \\dot{\\mathbf{B}} = (\\mathbf{l}\\mathbf{F})\\mathbf{F}^{\\mathsf{T}} + \\mathbf{F}(\\mathbf{l}\\mathbf{F})^{\\mathsf{T}} = \\mathbf{l}(\\mathbf{F}\\mathbf{F}^{\\mathsf{T}}) + \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}\\mathbf{l}^{\\mathsf{T}} = \\mathbf{l}\\mathbf{B} + \\mathbf{B}\\mathbf{l}^{\\mathsf{T}} $$\nThe velocity gradient is decomposed into its symmetric part, the rate-of-deformation tensor $\\mathbf{d}$, and its skew-symmetric part, the spin tensor $\\mathbf{w}$: $\\mathbf{l} = \\mathbf{d} + \\mathbf{w}$. The problem specifies an incremental motion with zero spin, so $\\mathbf{w}=\\mathbf{0}$ and $\\mathbf{l}=\\mathbf{d}$. The expression for $\\dot{\\mathbf{B}}$ becomes\n$$ \\dot{\\mathbf{B}} = \\mathbf{d}\\mathbf{B} + \\mathbf{B}\\mathbf{d} $$\nSubstituting this into the stress rate equation yields\n$$ \\dot{\\boldsymbol{\\tau}} = -\\dot{p}\\mathbf{I} + \\mu(\\mathbf{d}\\mathbf{B} + \\mathbf{B}\\mathbf{d}) $$\nThe incremental motion is a pure shear in the $\\mathbf{e}_1$-$\\mathbf{e}_2$ plane, so the rate-of-deformation tensor $\\mathbf{d}$ has the form:\n$$ [\\mathbf{d}] = \\begin{pmatrix} 0 & d_{12} & 0 \\\\ d_{12} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nThe condition $\\operatorname{tr}(\\mathbf{d})=0$ is satisfied, consistent with incompressibility. We now compute the $12$-component of the stress rate, $\\dot{\\tau}_{12}$. The term $-\\dot{p}\\mathbf{I}$ has no off-diagonal components. Thus,\n$$ \\dot{\\tau}_{12} = \\mu \\left( (\\mathbf{d}\\mathbf{B})_{12} + (\\mathbf{B}\\mathbf{d})_{12} \\right) $$\nUsing matrix multiplication with the component forms of $\\mathbf{d}$ and the pre-strained $\\mathbf{B}$:\n$$ (\\mathbf{d}\\mathbf{B})_{12} = \\sum_{k=1}^{3} d_{1k} B_{k2} = d_{11}B_{12} + d_{12}B_{22} + d_{13}B_{32} = d_{12}\\lambda_{2}^{2} $$\n$$ (\\mathbf{B}\\mathbf{d})_{12} = \\sum_{k=1}^{3} B_{1k} d_{k2} = B_{11}d_{12} + B_{12}d_{22} + B_{13}d_{32} = \\lambda_{1}^{2}d_{12} $$\nSubstituting these into the expression for $\\dot{\\tau}_{12}$:\n$$ \\dot{\\tau}_{12} = \\mu ( d_{12}\\lambda_{2}^{2} + \\lambda_{1}^{2}d_{12} ) = \\mu (\\lambda_{1}^{2} + \\lambda_{2}^{2}) d_{12} $$\nThe problem defines the incremental shear modulus $G_{12}$ via the relation $\\dot{\\tau}_{12} = 2 G_{12} d_{12}$. Comparing this with our derived expression, we find\n$$ 2 G_{12} d_{12} = \\mu (\\lambda_{1}^{2} + \\lambda_{2}^{2}) d_{12} $$\nThis gives the closed-form expression for the incremental shear modulus:\n$$ G_{12} = \\frac{\\mu}{2}(\\lambda_{1}^{2} + \\lambda_{2}^{2}) $$\nThe shear modulus $\\mu$ has units of pressure (Pascals), and the stretches $\\lambda_i$ are dimensionless, so $G_{12}$ correctly has units of pressure.\n\n**Method 2: Confirmation by Linearization of Internal Virtual Work**\n\nThis method relies on the principle of virtual power. The internal virtual power density is given by $\\boldsymbol{\\tau} : \\mathbf{d}^*$, where $\\mathbf{d}^*$ is a kinematically admissible virtual rate-of-deformation field. Linearizing this quantity about the pre-deformed state involves examining its rate of change, which represents the incremental virtual power. Assuming the virtual field $\\mathbf{d}^*$ itself does not change during the increment, the rate of change of the internal virtual power density is\n$$ \\frac{d}{dt}(\\boldsymbol{\\tau} : \\mathbf{d}^*) = \\dot{\\boldsymbol{\\tau}} : \\mathbf{d}^* $$\nWe substitute the expression for the objective part of the stress rate. From the first method, we have $\\dot{\\boldsymbol{\\tau}} = -\\dot{p}\\mathbf{I} + \\mu(\\mathbf{d}\\mathbf{B} + \\mathbf{B}\\mathbf{d})$. Thus,\n$$ \\dot{\\boldsymbol{\\tau}} : \\mathbf{d}^* = \\left( -\\dot{p}\\mathbf{I} + \\mu(\\mathbf{d}\\mathbf{B} + \\mathbf{B}\\mathbf{d}) \\right) : \\mathbf{d}^* = -\\dot{p} \\operatorname{tr}(\\mathbf{d}^*) + \\mu(\\mathbf{d}\\mathbf{B} + \\mathbf{B}\\mathbf{d}) : \\mathbf{d}^* $$\nThe virtual field $\\mathbf{d}^*$ is specified to be kinematically admissible for an incompressible material, which requires $\\operatorname{tr}(\\mathbf{d}^*) = 0$. This eliminates the term involving the indeterminate pressure rate $\\dot{p}$. The incremental virtual power density is therefore:\n$$ \\dot{P}_{int} = \\mu(\\mathbf{d}\\mathbf{B} + \\mathbf{B}\\mathbf{d}) : \\mathbf{d}^* $$\nThe problem states that $\\mathbf{d}^*$ has the same form as $\\mathbf{d}$, corresponding to a pure shear in the $\\mathbf{e}_1$-$\\mathbf{e}_2$ plane. Let the only non-zero components be $d^*_{12} = d^*_{21}$.\nWe expand the scalar product. Let $\\mathbf{T}_{inc} = \\mu(\\mathbf{d}\\mathbf{B} + \\mathbf{B}\\mathbf{d})$. Then $\\dot{P}_{int} = \\mathbf{T}_{inc} : \\mathbf{d}^* = \\sum_{i,j} T_{inc,ij} d^*_{ij}$. Since $\\mathbf{d}^*$ has only non-zero components for $(i,j)=(1,2)$ and $(2,1)$,\n$$ \\dot{P}_{int} = T_{inc,12} d^*_{12} + T_{inc,21} d^*_{21} $$\nThe tensor $\\mathbf{T}_{inc}$ is symmetric because $\\mathbf{d}$ and $\\mathbf{B}$ are symmetric. Also, $d^*_{12}=d^*_{21}$. Thus,\n$$ \\dot{P}_{int} = 2 T_{inc,12} d^*_{12} $$\nFrom the first method, we already computed $T_{inc,12} = \\mu(\\lambda_{1}^{2} + \\lambda_{2}^{2}) d_{12}$. Substituting this gives:\n$$ \\dot{P}_{int} = 2 \\mu(\\lambda_{1}^{2} + \\lambda_{2}^{2}) d_{12} d^*_{12} $$\nThis expression for the incremental virtual power density was obtained from the constitutive law. Alternatively, we can express it directly using the definition of stress work. The incremental power density is $\\dot{\\boldsymbol{\\tau}}:\\mathbf{d}^*$. Expanding this gives:\n$$ \\dot{\\boldsymbol{\\tau}}:\\mathbf{d}^* = \\sum_{i,j}\\dot{\\tau}_{ij}d^*_{ij} = \\dot{\\tau}_{12}d^*_{12} + \\dot{\\tau}_{21}d^*_{21} $$\nSince the Kirchhoff stress tensor $\\boldsymbol{\\tau}$ is symmetric, its material time derivative $\\dot{\\boldsymbol{\\tau}}$ is also symmetric, meaning $\\dot{\\tau}_{12}=\\dot{\\tau}_{21}$. Therefore,\n$$ \\dot{\\boldsymbol{\\tau}}:\\mathbf{d}^* = 2 \\dot{\\tau}_{12}d^*_{12} $$\nBy equating the two expressions derived for the incremental virtual power density, we have:\n$$ 2 \\dot{\\tau}_{12}d^*_{12} = 2 \\mu(\\lambda_{1}^{2} + \\lambda_{2}^{2}) d_{12} d^*_{12} $$\nAssuming a non-trivial virtual field ($d^*_{12} \\neq 0$), we can cancel terms to find the relationship for the incremental stress component:\n$$ \\dot{\\tau}_{12} = \\mu(\\lambda_{1}^{2} + \\lambda_{2}^{2}) d_{12} $$\nUsing the definition $\\dot{\\tau}_{12} = 2 G_{12} d_{12}$, we once again arrive at the same conclusion:\n$$ G_{12} = \\frac{\\mu}{2}(\\lambda_{1}^{2} + \\lambda_{2}^{2}) $$\nBoth methods yield the identical result, confirming the validity of the derivation. The expression depends only on the shear modulus $\\mu$ and the principal stretches in the plane of shear, $\\lambda_1$ and $\\lambda_2$.", "answer": "$$ \\boxed{\\frac{\\mu}{2}(\\lambda_{1}^{2} + \\lambda_{2}^{2})} $$", "id": "2655366"}, {"introduction": "The ultimate purpose of deriving the consistent tangent is to build efficient numerical solvers for nonlinear systems, most notably the Newton-Raphson method. The order of operations—discretization and linearization—is critical, and only the 'discretize-then-linearize' (DTL) approach guarantees the quadratic convergence rate of the Newton method. This coding exercise will have you implement and compare the DTL and 'linearize-then-discretize' (LTL) schemes, computationally demonstrating the dramatic impact of using a consistent versus an inconsistent tangent on solver performance [@problem_id:2664942].", "problem": "Consider a geometrically nonlinear axial deformation of a one-dimensional hyperelastic bar in the total Lagrangian setting. The reference configuration is the interval $[0,L]$ with constant cross-sectional area $A$, and the displacement field is $u(X)$ along the axial direction, where $X$ is the material coordinate. The deformation gradient is $F = 1 + \\dfrac{du}{dX}$, the Green-Lagrange strain is $E = \\dfrac{1}{2}\\left(F^2 - 1\\right)$, and the constitutive behavior is Saint-Venant–Kirchhoff with strain energy density $\\psi(E) = \\dfrac{1}{2} E_m E^2$, where $E_m$ is the material modulus. The second Piola–Kirchhoff stress is $S = \\dfrac{d\\psi}{dE} = E_m E$. The principle of virtual work (internal equals external) in the reference configuration reads\n$$ \\int_{0}^{L} A\\, S\\, \\delta E \\, dX \\;=\\; P\\, \\delta u(L), $$\nwith essential boundary condition $u(0) = 0$ and a single concentrated external load $P$ applied at $X = L$.\n\nDiscretize the bar with a single linear ($2$-node) finite element with nodal displacements $u_1$ and $u_2$, using the standard linear shape functions over the element in the reference domain. You will implement and compare two different Newton–Raphson linearization choices for solving the discrete equilibrium equation for the single unknown $u_2$ (since $u_1=0$):\n\n- Discretize-then-linearize (DTL): First derive the discrete residual exactly from the discrete virtual work, and then compute its exact Jacobian (the consistent tangent) with respect to the discrete unknown.\n- Linearize-then-discretize (LTL): First linearize the continuum virtual work density with respect to the Green–Lagrange strain using the material modulus (that is, use only the constitutive linearization $C = \\dfrac{dS}{dE}$) while treating the kinematic mapping from $u$ to $E$ as if it were fixed when forming the Jacobian, and then discretize. This produces a different discrete tangent because the dependence of the kinematic operator on the displacement is not included in the Jacobian.\n\nYour tasks:\n\n$1.$ Starting from the fundamental definitions above, construct the discrete residual for the single-element problem with $u_1=0$ and unknown $u_2$. Do not assume small strain. Express the discrete internal force at node $X=L$ and form the scalar equilibrium equation with the external load $P$.\n\n$2.$ For the DTL approach, compute the exact derivative (with respect to $u_2$) of the discrete residual you derived in task $1$.\n\n$3.$ For the LTL approach, compute the Jacobian by using only the constitutive linearization $C = \\dfrac{dS}{dE}$ at the continuum level and then discretizing with the current kinematic mapping held fixed in the Jacobian (that is, omit the derivative of the kinematic mapping with respect to the displacement in the Jacobian). Show explicitly that the two Jacobians differ and identify the additional term present in DTL.\n\n$4.$ Implement a Newton–Raphson solver for the scalar unknown $u_2$ using each Jacobian choice (DTL and LTL). Use the same residual from task $1$ in both solvers, but use the respective Jacobian in the Newton update.\n\n$5.$ Using the same initial guess $u_2^{(0)} = \\dfrac{P L}{A E_m}$, iterate until either the absolute residual magnitude falls below a tolerance $\\varepsilon_R = 10^{-10}\\,\\mathrm{N}$ or the absolute update magnitude falls below $\\varepsilon_U = 10^{-12}\\,\\mathrm{m}$, or a maximum of $N_{\\max} = 50$ iterations is reached. If the method reaches a tolerance before $N_{\\max}$, declare convergence; otherwise, declare non-convergence. Ensure that your implementation guards against division by zero in the Newton update.\n\nYou must evaluate the two schemes on the following test suite, which fixes the geometric and material parameters and varies the load:\n\n- Fixed parameters: $L = 1.0\\,\\mathrm{m}$, $A = 0.01\\,\\mathrm{m}^2$, $E_m = 2.10\\times 10^{11}\\,\\mathrm{Pa}$.\n- Loads:\n  - Case $1$: $P = 0\\,\\mathrm{N}$.\n  - Case $2$: $P = 0.02 \\times A E_m\\,\\mathrm{N}$.\n  - Case $3$: $P = 0.50 \\times A E_m\\,\\mathrm{N}$.\n  - Case $4$: $P = 0.90 \\times A E_m\\,\\mathrm{N}$.\n\nFor each case, your program must output the following, in order: the converged displacement using DTL in meters, the number of DTL iterations, a boolean indicating DTL convergence, the converged displacement using LTL in meters (use the special floating-point token NaN if non-convergent), the number of LTL iterations, and a boolean indicating LTL convergence.\n\nFinal output format: Your program should produce a single line of output containing a list of results, one per test case, where each test case result is itself a list of the six values described above, for example\n$$ [\\,[u_{2,\\mathrm{DTL}},\\, n_{\\mathrm{DTL}},\\, \\mathrm{True},\\, u_{2,\\mathrm{LTL}},\\, n_{\\mathrm{LTL}},\\, \\mathrm{False}],\\; \\ldots\\,] $$\nNumerical quantities involving length must be in meters and those involving force must be in newtons. The printed line must be a single valid Python list literal with comma-separated entries and square brackets, containing floats, integers, and booleans only, in the order specified above.", "solution": "The problem presented is a valid and well-posed exercise in computational solid mechanics, requiring the application of the Newton-Raphson method to a geometrically nonlinear problem discretized by the finite element method. It serves as a canonical example for comparing a quadratically convergent scheme based on the consistent tangent (Discretize-then-Linearize, DTL) with a scheme that uses an inconsistent tangent (Linearize-then-Discretize, LTL), thereby demonstrating fundamental concepts of nonlinear finite element analysis. All provided data are scientifically sound, consistent, and sufficient for deriving a unique solution. We shall proceed with the derivation and solution.\n\nThe analysis begins with the discretization of the continuum mechanics formulation for a single two-node finite element spanning the domain $X \\in [0,L]$.\n\n**1. Discretization and Residual Formulation**\n\nThe displacement field $u(X)$ is approximated using linear shape functions $N_1(X) = 1 - X/L$ and $N_2(X) = X/L$. With nodal displacements $u_1$ and $u_2$, the field is $u(X) = u_1 N_1(X) + u_2 N_2(X)$. Applying the essential boundary condition $u(0) = 0$ implies $u_1 = 0$, simplifying the displacement field to:\n$$ u(X) = u_2 N_2(X) = u_2 \\frac{X}{L} $$\nThe displacement gradient is constant throughout the element:\n$$ \\frac{du}{dX} = \\frac{d}{dX} \\left( u_2 \\frac{X}{L} \\right) = \\frac{u_2}{L} $$\nFrom this, we derive the deformation gradient $F$ and the Green-Lagrange strain $E$:\n$$ F = 1 + \\frac{du}{dX} = 1 + \\frac{u_2}{L} $$\n$$ E = \\frac{1}{2}(F^2 - 1) = \\frac{1}{2}\\left[\\left(1 + \\frac{u_2}{L}\\right)^2 - 1\\right] = \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 $$\nThe material is of the Saint-Venant–Kirchhoff type, so the second Piola-Kirchhoff stress $S$ is linearly related to the Green-Lagrange strain via the modulus $E_m$:\n$$ S = E_m E = E_m \\left[ \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] $$\nThe principle of virtual work, $\\int_{0}^{L} A S \\delta E \\, dX = P \\delta u(L)$, provides the governing equilibrium equation. The variation of strain $\\delta E$ is found by applying the variational operator $\\delta$:\n$$ \\delta E = \\frac{dE}{du_2} \\delta u_2 = \\left[ \\frac{1}{L} + \\frac{u_2}{L^2} \\right] \\delta u_2 = \\frac{1}{L} \\left( 1 + \\frac{u_2}{L} \\right) \\delta u_2 = \\frac{F}{L} \\delta u_2 $$\nThe virtual displacement at the loaded end is $\\delta u(L) = \\delta u_2$. Since all kinematic quantities ($F$, $E$, $S$, $\\delta E$) are constant over the single element domain, the integral in the virtual work statement becomes trivial:\n$$ \\text{Internal Virtual Work (IVW)} = \\int_{0}^{L} A S \\delta E \\, dX = A S (\\delta E) L = A S \\left( \\frac{F}{L} \\delta u_2 \\right) L = A S F \\delta u_2 $$\nThe discrete internal force at node $2$, $f_{\\text{int}}$, is the coefficient of $\\delta u_2$:\n$$ f_{\\text{int}}(u_2) = A S F = A (E_m E) F = A E_m \\left[ \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] \\left( 1 + \\frac{u_2}{L} \\right) $$\nEquilibrium requires that the internal force equals the external force, $f_{\\text{int}} = P$. The residual function $R(u_2)$ for the Newton-Raphson procedure is defined as the imbalance between internal and external forces:\n$$ R(u_2) = f_{\\text{int}}(u_2) - P = A E_m \\left[ \\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] \\left( 1 + \\frac{u_2}{L} \\right) - P $$\n\n**2. Discretize-then-Linearize (DTL) Jacobian**\n\nThe DTL approach derives the tangent stiffness (Jacobian) by taking the exact derivative of the discrete residual $R(u_2)$ with respect to the unknown $u_2$. This yields the consistent tangent, which ensures quadratic convergence of the Newton-Raphson method near the solution.\n$$ K_{\\text{DTL}}(u_2) = \\frac{d R(u_2)}{d u_2} = \\frac{d f_{\\text{int}}(u_2)}{d u_2} $$\nUsing the expression $f_{\\text{int}} = A E_m E F$ and applying the product rule:\n$$ K_{\\text{DTL}} = A E_m \\frac{d}{du_2}(E F) = A E_m \\left[ \\left(\\frac{dE}{du_2}\\right) F + E \\left(\\frac{dF}{du_2}\\right) \\right] $$\nThe required derivatives are:\n$$ \\frac{dF}{du_2} = \\frac{d}{du_2}\\left(1 + \\frac{u_2}{L}\\right) = \\frac{1}{L} $$\n$$ \\frac{dE}{du_2} = \\frac{d}{du_2}\\left(\\frac{u_2}{L} + \\frac{1}{2}\\frac{u_2^2}{L^2}\\right) = \\frac{1}{L} + \\frac{u_2}{L^2} = \\frac{1}{L}\\left(1+\\frac{u_2}{L}\\right) = \\frac{F}{L} $$\nSubstituting these into the expression for $K_{\\text{DTL}}$:\n$$ K_{\\text{DTL}} = A E_m \\left[ \\left(\\frac{F}{L}\\right)F + E\\left(\\frac{1}{L}\\right) \\right] = \\frac{A E_m}{L} (F^2 + E) $$\nThis expression combines the material stiffness contribution ($\\propto F^2$) and the geometric stiffness contribution ($\\propto E$). Substituting for $F$ and $E$ in terms of $u_2$:\n$$ K_{\\text{DTL}} = \\frac{A E_m}{L} \\left[ \\left(1+\\frac{u_2}{L}\\right)^2 + \\left(\\frac{u_2}{L} + \\frac{1}{2}\\left(\\frac{u_2}{L}\\right)^2\\right) \\right] $$\n$$ K_{\\text{DTL}} = \\frac{A E_m}{L} \\left[ 1 + 3\\frac{u_2}{L} + \\frac{3}{2}\\left(\\frac{u_2}{L}\\right)^2 \\right] $$\n\n**3. Linearize-then-Discretize (LTL) Jacobian and Comparison**\n\nThe LTL approach follows a different procedure. The linearization is performed at the continuum level, but only partially. It considers only the material component of the linearization, $\\Delta S = C \\Delta E$ where $C = dS/dE = E_m$, and neglects the geometric part that arises from the variation of the strain operator itself. The tangent is formed by discretizing the approximate linearized virtual work:\n$$ \\delta(\\text{IVW})_{\\text{LTL}} = \\int_0^L A (C \\Delta E) \\delta E \\, dX $$\nWe now substitute the discrete forms of $\\Delta E$ and $\\delta E$:\n$$ \\Delta E = \\frac{dE}{du_2} \\Delta u_2 = \\frac{F}{L} \\Delta u_2 $$\n$$ \\delta E = \\frac{dE}{du_2} \\delta u_2 = \\frac{F}{L} \\delta u_2 $$\nSubstituting into the LTL integral:\n$$ \\delta(\\text{IVW})_{\\text{LTL}} = \\int_0^L A E_m \\left(\\frac{F}{L} \\Delta u_2\\right) \\left(\\frac{F}{L} \\delta u_2\\right) \\, dX $$\nSince all terms are constant over the element, this evaluates to:\n$$ \\delta(\\text{IVW})_{\\text{LTL}} = A E_m \\frac{F^2}{L^2} L \\, \\Delta u_2 \\, \\delta u_2 = \\left( \\frac{A E_m F^2}{L} \\right) \\Delta u_2 \\, \\delta u_2 $$\nThe LTL Jacobian is the term multiplying the displacement increments:\n$$ K_{\\text{LTL}} = \\frac{A E_m F^2}{L} = \\frac{A E_m}{L} \\left(1 + \\frac{u_2}{L}\\right)^2 = \\frac{A E_m}{L} \\left[ 1 + 2\\frac{u_2}{L} + \\left(\\frac{u_2}{L}\\right)^2 \\right] $$\nComparing the two Jacobians, we see they are not identical:\n$$ K_{\\text{DTL}} = K_{\\text{LTL}} + \\frac{A E_m}{L} E $$\nThe LTL Jacobian is missing the geometric stiffness term, $\\frac{A E_m}{L} E = \\frac{A S}{L}$. This term accounts for the effect of existing stress on the stiffness. Its omission means $K_{\\text{LTL}}$ is not the consistent tangent for the residual $R(u_2)$, and the Newton-Raphson method using it will not exhibit quadratic convergence. The convergence rate is expected to degrade to linear, or fail entirely, especially for large strains where $E$ is significant.\n\n**4. Newton-Raphson Implementation**\n\nFor the scalar unknown $u_2$, the Newton-Raphson update at iteration $k$ is:\n$$ u_2^{(k+1)} = u_2^{(k)} - \\frac{R(u_2^{(k)})}{K(u_2^{(k)})} $$\nWe implement this iterative scheme for both the DTL and LTL choices of the Jacobian, $K$. The initial guess is taken from linear elastic theory, $u_2^{(0)} = PL/(AE_m)$. The iteration proceeds until the absolute value of the residual falls below $\\varepsilon_R = 10^{-10}\\,\\mathrm{N}$, or the absolute value of the displacement update falls below $\\varepsilon_U = 10^{-12}\\,\\mathrm{m}$. A maximum of $N_{\\max} = 50$ iterations is allowed. If convergence is not achieved, the method is declared non-convergent. A check for a near-zero Jacobian is included to prevent division by zero, which would indicate a loss of stiffness. The following Python code implements this logic and evaluates the performance of both schemes on the specified test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the nonlinear axial deformation of a hyperelastic bar using\n    two different Newton-Raphson schemes (DTL and LTL) and reports\n    the convergence behavior for a suite of test cases.\n    \"\"\"\n    \n    # Fixed parameters\n    L = 1.0  # m\n    A = 0.01  # m^2\n    E_m = 2.10e11  # Pa\n    \n    # Numerical parameters for the solver\n    TOL_R = 1e-10  # N, absolute residual tolerance\n    TOL_U = 1e-12  # m, absolute update tolerance\n    MAX_ITER = 50  # Maximum number of iterations\n    \n    # Reference force for defining loads\n    A_Em = A * E_m\n    \n    # Test cases: loads P\n    test_cases = [\n        0.0,\n        0.02 * A_Em,\n        0.50 * A_Em,\n        0.90 * A_Em,\n    ]\n\n    def run_newton_solver(P, jacobian_type):\n        \"\"\"\n        Performs the Newton-Raphson iteration for a given load and Jacobian type.\n        \n        Args:\n            P (float): External load in N.\n            jacobian_type (str): 'DTL' or 'LTL'.\n            \n        Returns:\n            tuple: (final_displacement, num_iterations, converged_status)\n        \"\"\"\n        # Initial guess from linear elasticity\n        u = (P * L) / A_Em\n        \n        # Check initial guess before iterating\n        u_L_ratio = u / L\n        F = 1.0 + u_L_ratio\n        E = u_L_ratio + 0.5 * u_L_ratio**2\n        S = E_m * E\n        R = A * S * F - P\n        \n        if abs(R) < TOL_R:\n            return u, 0, True\n\n        for n_iter in range(1, MAX_ITER + 1):\n            # Calculate Jacobian K\n            u_L_ratio = u / L\n            F = 1.0 + u_L_ratio\n            \n            if jacobian_type == 'DTL':\n                # Consistent tangent K_DTL = A*Em/L * (1 + 3*(u/L) + 1.5*(u/L)^2)\n                K = (A * E_m / L) * (1.0 + 3.0 * u_L_ratio + 1.5 * u_L_ratio**2)\n            elif jacobian_type == 'LTL':\n                # Inconsistent tangent K_LTL = A*Em/L * F^2\n                K = (A * E_m / L) * F**2\n            else:\n                raise ValueError(\"Unknown Jacobian type\")\n            \n            # Check for near-zero stiffness (singularity)\n            if abs(K) < 1e-20:\n                u_final = float('nan') if jacobian_type == 'LTL' else u\n                return u_final, n_iter - 1, False\n\n            # Calculate update and apply it\n            du = -R / K\n            u += du\n            \n            # Check update convergence\n            if abs(du) < TOL_U:\n                return u, n_iter, True\n            \n            # Recalculate residual for next iteration's residual check\n            u_L_ratio = u / L\n            F = 1.0 + u_L_ratio\n            E = u_L_ratio + 0.5 * u_L_ratio**2\n            S = E_m * E\n            R = A * S * F - P\n            \n            # Check residual convergence\n            if abs(R) < TOL_R:\n                return u, n_iter, True\n\n        # If loop completes, max iterations were reached without convergence\n        u_final = float('nan') if jacobian_type == 'LTL' else u\n        return u_final, MAX_ITER, False\n\n    results = []\n    for P in test_cases:\n        u_dtl, n_dtl, conv_dtl = run_newton_solver(P, 'DTL')\n        u_ltl, n_ltl, conv_ltl = run_newton_solver(P, 'LTL')\n        \n        # For LTL non-convergence, the displacement is NaN as per problem spec\n        if not conv_ltl:\n            u_ltl = float('nan')\n\n        results.append([u_dtl, n_dtl, conv_dtl, u_ltl, n_ltl, conv_ltl])\n\n    # Final print statement must produce a single valid Python list literal.\n    # The default print() for a list of lists matches the required format.\n    print(results)\n\nsolve()\n```", "id": "2664942"}]}