{"hands_on_practices": [{"introduction": "The fundamental link between a material's constitutive behavior (the $\\sigma$-$\\epsilon$ relationship) and a beam section's macroscopic response (the $M$-$\\kappa$ relationship) is forged through the principles of kinematics and equilibrium. This exercise guides you through the analytical derivation of the moment-curvature curve for a bilinear material model, which incorporates post-yield strain hardening. Mastering this derivation is crucial for understanding the origins of nonlinear structural behavior directly from first principles. [@problem_id:2670668]", "problem": "A straight prismatic beam of rectangular cross-section, width $b$ and total depth $h$, is subjected to uniform bending about its strong axis under the Euler–Bernoulli kinematic assumption that plane sections remain plane and orthogonal to the neutral axis. The material obeys a bilinear, rate-independent stress–strain relation in uniaxial tension and compression with initial Young’s modulus $E$, yield stress $\\sigma_{y}$ at yield strain $\\varepsilon_{y} = \\sigma_{y}/E$, and a constant post-yield hardening modulus $H'$, identical in tension and compression. There is no axial force in the section, and the cross-section and material are symmetric so that the neutral axis remains at the mid-depth.\n\n1) Starting only from the definitions $\\varepsilon(y) = \\kappa\\,y$ for the longitudinal strain at a fiber located at a distance $y$ from the neutral axis and $M = \\int_{A} \\sigma(y)\\,y\\,\\mathrm{d}A$ for the bending moment, derive the exact section moment–curvature relation $M(\\kappa)$ for the rectangular section. Your derivation must explicitly identify the elastic regime and the elastoplastic regime, and express $M(\\kappa)$ in closed form in terms of $b$, $h$, $E$, $\\sigma_{y}$, $H'$, and $\\kappa$ only.\n\n2) Define an effective plastic moment at a prescribed local plastic hinge rotation demand $\\theta_{d}$ by introducing a plastic hinge length $L_{p}$ and assuming that the curvature is uniform across this length, so that the hinge rotation satisfies $\\theta_{d} = \\kappa\\,L_{p}$. Using your $M(\\kappa)$ from part 1, set $M_{\\mathrm{eff}}(\\theta_{d}) := M\\!\\left(\\kappa = \\theta_{d}/L_{p}\\right)$.\n\nEvaluate $M_{\\mathrm{eff}}(\\theta_{d})$ numerically for the data\n$b = 0.200 \\text{ m}$, $h = 0.300 \\text{ m}$, $E = 200 \\times 10^{9} \\text{ Pa}$, $\\sigma_{y} = 300 \\times 10^{6} \\text{ Pa}$, $H' = 5.0 \\times 10^{9} \\text{ Pa}$, $\\theta_{d} = 0.020 \\text{ rad}$, $L_{p} = 0.150 \\text{ m}$.\nExpress your final moment in $\\text{kN}\\cdot\\text{m}$ and round your answer to four significant figures.", "solution": "The problem statement is first subjected to validation.\n\nGivens extracted verbatim from the statement:\n- A straight prismatic beam of rectangular cross-section, width $b$ and total depth $h$.\n- Subjected to uniform bending about its strong axis.\n- Euler–Bernoulli kinematic assumption: plane sections remain plane and orthogonal to the neutral axis.\n- Material stress–strain relation: bilinear, rate-independent, with initial Young’s modulus $E$, yield stress $\\sigma_{y}$ at yield strain $\\varepsilon_{y} = \\sigma_{y}/E$, and a constant post-yield hardening modulus $H'$. Identical in tension and compression.\n- No axial force, neutral axis remains at mid-depth.\n- Definition of strain: $\\varepsilon(y) = \\kappa\\,y$.\n- Definition of bending moment: $M = \\int_{A} \\sigma(y)\\,y\\,\\mathrm{d}A$.\n- Part $1$ task: Derive the exact section moment–curvature relation $M(\\kappa)$ in closed form.\n- Part $2$ definitions: plastic hinge length $L_{p}$ and hinge rotation $\\theta_{d} = \\kappa\\,L_{p}$.\n- Part $2$ task: Evaluate $M_{\\mathrm{eff}}(\\theta_{d}) := M(\\kappa = \\theta_{d}/L_{p})$ numerically.\n- Numerical data: $b = 0.200 \\text{ m}$, $h = 0.300 \\text{ m}$, $E = 200 \\times 10^{9} \\text{ Pa}$, $\\sigma_{y} = 300 \\times 10^{6} \\text{ Pa}$, $H' = 5.0 \\times 10^{9} \\text{ Pa}$, $\\theta_{d} = 0.020 \\text{ rad}$, $L_{p} = 0.150 \\text{ m}$.\n- Final answer requirements: Express moment in $\\text{kN}\\cdot\\text{m}$, rounded to four significant figures.\n\nValidation against criteria:\n- **Scientifically Grounded**: The problem is a standard, fundamental problem in the field of inelastic solid mechanics. The concepts of Euler-Bernoulli kinematics, bilinear material models, moment-curvature relations, and plastic hinges are established and central to structural analysis.\n- **Well-Posed**: The problem is clearly defined, provides all necessary information and definitions, and leads to a unique, stable solution for both the analytical derivation and the numerical calculation.\n- **Objective**: The language is precise, technical, and free of any subjective or ambiguous terms.\n\nVerdict: The problem is valid. It is a well-formulated, self-contained problem in advanced mechanics of materials. We proceed with the solution.\n\nThe response of the cross-section is derived by first establishing the constitutive law and then integrating the stress field over the section.\n\n**Part 1: Derivation of the Moment-Curvature Relation $M(\\kappa)$**\n\nThe bilinear stress-strain law $\\sigma(\\varepsilon)$ is given by:\n$$\n\\sigma(\\varepsilon) =\n\\begin{cases}\nE\\varepsilon & \\text{for } |\\varepsilon| \\le \\varepsilon_y \\\\\n\\mathrm{sgn}(\\varepsilon)[\\sigma_y + H'(|\\varepsilon| - \\varepsilon_y)] & \\text{for } |\\varepsilon| > \\varepsilon_y\n\\end{cases}\n$$\nwhere $\\varepsilon_y = \\sigma_y / E$. The strain distribution is linear across the depth: $\\varepsilon(y) = \\kappa y$. The moment is $M = \\int_{-h/2}^{h/2} \\sigma(\\kappa y) y (b \\, dy)$.\n\n**Regime 1: Fully Elastic Behavior ($0 \\le \\kappa \\le \\kappa_y$)**\nThe section is fully elastic as long as the strain at the extreme fibers ($y = \\pm h/2$) does not exceed the yield strain. This condition, $|\\varepsilon(h/2)| = \\kappa (h/2) \\le \\varepsilon_y$, defines the limit of the elastic regime. The curvature at first yield is:\n$$ \\kappa_y = \\frac{\\varepsilon_y}{h/2} = \\frac{2\\varepsilon_y}{h} = \\frac{2\\sigma_y}{Eh} $$\nFor any curvature $\\kappa \\le \\kappa_y$, the stress is $\\sigma(y) = E\\varepsilon(y) = E\\kappa y$ everywhere. The moment is:\n$$ M(\\kappa) = \\int_{-h/2}^{h/2} (E\\kappa y) y (b \\, dy) = E\\kappa b \\int_{-h/2}^{h/2} y^2 dy = E\\kappa \\left( \\frac{bh^3}{12} \\right) $$\nLetting $I = bh^3/12$ be the second moment of area, the moment-curvature relation in the elastic regime is:\n$$ M(\\kappa) = EI\\kappa $$\n\n**Regime 2: Elastoplastic Behavior ($\\kappa > \\kappa_y$)**\nWhen $\\kappa > \\kappa_y$, the outer fibers yield. An elastic core exists for $|y| \\le y_c$, where $y_c$ is the distance from the neutral axis at which strain equals $\\varepsilon_y$.\n$$ \\kappa y_c = \\varepsilon_y \\implies y_c = \\frac{\\varepsilon_y}{\\kappa} = \\frac{\\kappa_y}{\\kappa}\\frac{h}{2} $$\nTo derive the moment, we use superposition. The stress-strain law can be decomposed as $\\sigma(\\varepsilon) = \\sigma_1(\\varepsilon) + \\sigma_2(\\varepsilon)$:\n1. A linear hardening component: $\\sigma_1(\\varepsilon) = H'\\varepsilon$. This is valid for all strains.\n2. An elastic-perfectly plastic component: $\\sigma_2(\\varepsilon)$, with elastic modulus $E' = E - H'$ and yield stress $\\sigma_{y,eff} = \\sigma_y - H'\\varepsilon_y = \\sigma_y(1 - H'/E)$. The yield strain for this component is $\\varepsilon_{y,eff} = \\sigma_{y,eff} / E' = \\sigma_y/E = \\varepsilon_y$.\n\nThe total moment is $M = M_1 + M_2$.\nThe moment from the linear hardening component is:\n$$ M_1 = \\int_A \\sigma_1(\\kappa y) y \\, dA = \\int_A (H'\\kappa y) y \\, dA = H'I\\kappa $$\nThe moment from the elastic-perfectly plastic component requires integration over its elastic core and plastic zones. For an elastic-perfectly plastic rectangular section, the moment is a known result:\n$$ M_2 = M_{p,eff} \\left( 1 - \\frac{1}{3} \\frac{y_c^2}{(h/2)^2} \\right) $$\nwhere $M_{p,eff}$ is the fully plastic moment for the effective yield stress $\\sigma_{y,eff}$, and $y_c$ is the extent of the elastic core.\n$$ M_{p,eff} = \\sigma_{y,eff} Z_p = \\sigma_y \\left(1 - \\frac{H'}{E}\\right) \\frac{bh^2}{4} $$\nHere, $Z_p = bh^2/4$ is the plastic section modulus. Substituting $y_c = (\\kappa_y/\\kappa)(h/2)$:\n$$ M_2 = \\sigma_y \\left(1 - \\frac{H'}{E}\\right) \\frac{bh^2}{4} \\left( 1 - \\frac{1}{3} \\left(\\frac{\\kappa_y}{\\kappa}\\right)^2 \\right) $$\nCombining the two parts gives the moment for the elastoplastic regime:\n$$ M(\\kappa) = H'I\\kappa + \\sigma_y \\left(1 - \\frac{H'}{E}\\right) \\frac{bh^2}{4} \\left( 1 - \\frac{1}{3} \\left(\\frac{\\kappa_y}{\\kappa}\\right)^2 \\right) $$\n\nSummary of the moment-curvature relation:\n$$\nM(\\kappa) =\n\\begin{cases}\nE I \\kappa & \\text{for } 0 \\le \\kappa \\le \\kappa_y \\\\\nH'I\\kappa + \\sigma_y \\left(1 - \\frac{H'}{E}\\right) Z_p \\left( 1 - \\frac{1}{3} \\left(\\frac{\\kappa_y}{\\kappa}\\right)^2 \\right) & \\text{for } \\kappa > \\kappa_y\n\\end{cases}\n$$\nwhere $I = bh^3/12$, $Z_p = bh^2/4$, and $\\kappa_y = 2\\sigma_y / (Eh)$.\n\n**Part 2: Numerical Evaluation**\n\nGiven data:\n$b = 0.200 \\text{ m}$\n$h = 0.300 \\text{ m}$\n$E = 200 \\times 10^{9} \\text{ Pa}$\n$\\sigma_{y} = 300 \\times 10^{6} \\text{ Pa}$\n$H' = 5.0 \\times 10^{9} \\text{ Pa}$\n$\\theta_{d} = 0.020 \\text{ rad}$\n$L_{p} = 0.150 \\text{ m}$\n\nFirst, calculate the required curvature $\\kappa$:\n$$ \\kappa = \\frac{\\theta_d}{L_p} = \\frac{0.020}{0.150} = \\frac{2}{15} \\text{ m}^{-1} \\approx 0.1333 \\text{ m}^{-1} $$\nNext, calculate the yield curvature $\\kappa_y$ to determine the regime:\n$$ \\kappa_y = \\frac{2\\sigma_y}{Eh} = \\frac{2 \\times (300 \\times 10^6 \\text{ Pa})}{(200 \\times 10^9 \\text{ Pa}) \\times (0.300 \\text{ m})} = \\frac{6 \\times 10^8}{6 \\times 10^{10}} = 0.01 \\text{ m}^{-1} $$\nSince $\\kappa = 2/15 \\text{ m}^{-1} > \\kappa_y = 0.01 \\text{ m}^{-1}$, the section is in the elastoplastic regime. We use the corresponding formula.\n\nCalculate the necessary geometric and material parameters:\nSecond moment of area:\n$$ I = \\frac{bh^3}{12} = \\frac{(0.200 \\text{ m})(0.300 \\text{ m})^3}{12} = 4.5 \\times 10^{-4} \\text{ m}^4 $$\nPlastic section modulus:\n$$ Z_p = \\frac{bh^2}{4} = \\frac{(0.200 \\text{ m})(0.300 \\text{ m})^2}{4} = 4.5 \\times 10^{-3} \\text{ m}^3 $$\nRatio of hardening modulus to Young's modulus:\n$$ \\frac{H'}{E} = \\frac{5.0 \\times 10^9 \\text{ Pa}}{200 \\times 10^9 \\text{ Pa}} = 0.025 $$\nRatio of curvatures squared:\n$$ \\left(\\frac{\\kappa_y}{\\kappa}\\right)^2 = \\left(\\frac{0.01}{2/15}\\right)^2 = (0.075)^2 = 0.005625 $$\n\nNow, evaluate the two terms of the moment expression:\nTerm $1$: $H'I\\kappa$\n$$ M_1 = (5.0 \\times 10^9 \\text{ Pa}) \\times (4.5 \\times 10^{-4} \\text{ m}^4) \\times (\\frac{2}{15} \\text{ m}^{-1}) = 300000 \\text{ N}\\cdot\\text{m} $$\nTerm $2$: $\\sigma_y (1 - H'/E) Z_p (1 - \\frac{1}{3}(\\kappa_y/\\kappa)^2)$\n$$ M_2 = (300 \\times 10^6 \\text{ Pa}) \\times (1 - 0.025) \\times (4.5 \\times 10^{-3} \\text{ m}^3) \\times \\left(1 - \\frac{1}{3}(0.005625)\\right) $$\n$$ M_2 = (300 \\times 10^6) \\times (0.975) \\times (4.5 \\times 10^{-3}) \\times (1 - 0.001875) $$\n$$ M_2 = (1316250) \\times (0.998125) \\text{ N}\\cdot\\text{m} $$\n$$ M_2 = 1313791.40625 \\text{ N}\\cdot\\text{m} $$\nThe total moment $M_{\\mathrm{eff}}(\\theta_d) = M(\\kappa)$ is the sum $M_1 + M_2$:\n$$ M = 300000 + 1313791.40625 = 1613791.40625 \\text{ N}\\cdot\\text{m} $$\nConvert to $\\text{kN}\\cdot\\text{m}$:\n$$ M = 1613.79140625 \\text{ kN}\\cdot\\text{m} $$\nRounding to four significant figures as required:\n$$ M \\approx 1614 \\text{ kN}\\cdot\\text{m} $$\nThe effective plastic moment is $1614 \\text{ kN}\\cdot\\text{m}$.", "answer": "$$\n\\boxed{1614}\n$$", "id": "2670668"}, {"introduction": "While analytical derivations provide essential insight, they are often limited to simple cross-sections and idealized material laws. This practice introduces the fiber discretization method, a powerful and versatile numerical technique used to compute the moment-curvature response for virtually any section geometry or material model. By implementing this algorithm, you will gain hands-on experience with the computational engine that underpins the nonlinear analysis of beam elements in modern finite element software. [@problem_id:2663507]", "problem": "Consider a prismatic beam with a rectangular cross-section of width $b$ and height $h$. Assume the kinematics of Euler–Bernoulli beam theory (plane sections remain plane) so that the axial strain distribution over the cross-section is $ \\epsilon_x(y) = \\epsilon_0 + \\kappa\\, y $, where $y$ is the coordinate measured from the centroidal axis (positive upward), $\\epsilon_0$ is a uniform axial strain, and $\\kappa$ is the curvature (in radians per meter). The material is modeled as an isotropic, rate-independent, small-strain, one-dimensional elastoplastic solid with linear isotropic hardening: for a uniaxial state, the Cauchy stress is a function $ \\sigma_x = \\sigma_x(\\epsilon_x) $ defined by the following principles:\n- Before yielding, stress is linear elastic with Young's modulus $E$.\n- Yielding initiates at the initial yield stress $\\sigma_{y0}$ in tension or compression.\n- After yielding under monotonic loading, the stress-strain response is bilinear with a constant hardening modulus $H \\ge 0$, ensuring objectivity under load reversals is ignored for this problem.\nAssume small strains and small rotations, and neglect shear deformation.\n\nYour task is to implement a fiber-discretization section integration algorithm that, for a given curvature $\\kappa$, determines the unique axial strain offset $\\epsilon_0$ such that the resultant axial force over the cross-section vanishes, and then computes the corresponding bending moment $M$ (about the $z$ axis, with the $x$ axis along the beam and $y$ axis vertical). Specifically:\n- Discretize the cross-section into $N_y$ horizontal fibers of equal area $\\Delta A = b\\, h / N_y$, located at positions $y_i$ uniformly spanning the height, for $i = 1,2,\\ldots,N_y$.\n- Impose the axial strain in fiber $i$ as $ \\epsilon_i = \\epsilon_0 + \\kappa\\, y_i $.\n- Use a constitutive map $\\sigma_i = \\sigma_x(\\epsilon_i; E,\\sigma_{y0},H)$ that is consistent with linear elasticity up to first yield and linear isotropic hardening thereafter under monotonic loading.\n- Enforce axial force equilibrium $ N(\\epsilon_0,\\kappa) = \\sum_{i=1}^{N_y} \\sigma_i \\Delta A = 0 $ by solving for $\\epsilon_0$ for a given $\\kappa$.\n- Compute the bending moment $ M(\\kappa) = \\sum_{i=1}^{N_y} \\sigma_i\\, y_i\\, \\Delta A $ once $N=0$ is satisfied.\n\nStart from fundamental principles only: equilibrium of internal resultants, kinematics of plane sections, and the definition of the bilinear elastoplastic behavior with linear isotropic hardening. Do not use or cite any pre-derived moment–curvature relations. Your implementation must handle both the purely elastic regime and the inelastic regime up to nearly fully plastic response, and must be robust in the limit of perfect plasticity ($H=0$).\n\nNumerical and physical specifications:\n- Use the International System of Units: $b$ and $h$ in meters, $E$ and $\\sigma_{y0}$ and $H$ in Pascals, $\\kappa$ in radians per meter, and report $M$ in Newton-meters.\n- The angle unit for curvature is radians per meter.\n- Use $N_y = 800$ fibers.\n- Solve the scalar equilibrium equation in $\\epsilon_0$ with a robust root-finding strategy that remains reliable when the tangent stiffness degenerates (for example, by combining Newton’s method with bisection fallback).\n- In computing the local one-dimensional elastoplastic response under monotonic loading from zero, use the bilinear law consistent with linear isotropic hardening, with elastic modulus $E$, initial yield strain $\\epsilon_y = \\sigma_{y0}/E$, and post-yield tangent modulus $E_t = E H / (E + H)$ for $H > 0$, and $E_t = 0$ for $H = 0$.\n\nTest suite:\nFor each parameter set $(b,h,E,\\sigma_{y0},H,\\kappa)$, compute the bending moment $M$ in Newton-meters. Use the following four test cases:\n- Case A (elastic regime): $(b,h,E,\\sigma_{y0},H,\\kappa) = (\\, 0.3,\\, 0.6,\\, 210\\times 10^9,\\, 250\\times 10^6,\\, 2\\times 10^9,\\, 1.0\\times 10^{-5}\\,)$.\n- Case B (moderate plasticity with hardening): $(\\, 0.3,\\, 0.6,\\, 210\\times 10^9,\\, 250\\times 10^6,\\, 2\\times 10^9,\\, 5.0\\times 10^{-3}\\,)$.\n- Case C (near fully plastic, perfect plasticity): $(\\, 0.3,\\, 0.6,\\, 210\\times 10^9,\\, 250\\times 10^6,\\, 0.0,\\, 5.0\\times 10^{-2}\\,)$.\n- Case D (zero curvature boundary case): $(\\, 0.3,\\, 0.6,\\, 210\\times 10^9,\\, 250\\times 10^6,\\, 1\\times 10^9,\\, 0.0\\,)$.\n\nFinal output specification:\n- Your program must produce a single line containing a Python list literal of the four computed bending moments, in Newton-meters, rounded to three decimal places, ordered as $[M_A, M_B, M_C, M_D]$ corresponding to Cases A–D.\n- The single line must have no additional text or spaces beyond the commas separating the values. For example, a valid output format is $[11340.000,123456.789,6750000.000,0.000]$.", "solution": "The posed problem is a standard exercise in the nonlinear analysis of structures, specifically the computation of the moment-curvature relationship for a beam with an inelastic material model. It is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We shall proceed with its resolution.\n\nThe objective is to determine the bending moment $M$ in a rectangular beam section for a given curvature $\\kappa$, under the constraint that the net axial force $N$ is zero. This requires a numerical approach, as the material behavior is nonlinear (elastoplastic). We will employ the fiber-discretization method, which is a robust and fundamental technique for analyzing the inelastic response of beam cross-sections.\n\nThe solution is constructed upon three pillars of solid mechanics: kinematics, material constitutive law, and equilibrium.\n\n**1. Kinematics: The Euler-Bernoulli Hypothesis**\nThe foundation of our analysis is the Euler-Bernoulli beam theory, which posits that plane sections initially normal to the beam's axis remain plane and normal to the axis after deformation. This kinematic constraint implies a linear distribution of axial strain $\\epsilon_x$ across the section's height. The strain at a vertical distance $y$ from the centroidal axis is given by:\n$$\n\\epsilon_x(y) = \\epsilon_0 + \\kappa y\n$$\nHere, $\\epsilon_0$ represents a uniform axial strain across the entire section, and $\\kappa$ is the curvature of the beam's neutral axis. Our task is to find the specific $\\epsilon_0$ that ensures axial equilibrium for a given $\\kappa$.\n\n**2. Material Constitutive Law: Bilinear Elastoplasticity with Hardening**\nThe material exhibits a bilinear stress-strain relationship under monotonic uniaxial loading. This model is characterized by an initial linear elastic region followed by a linear plastic (hardening) region. Let $E$ be the Young's modulus, $\\sigma_{y0}$ be the initial yield stress, and $H$ be the hardening modulus. The yield strain is $\\epsilon_{y0} = \\sigma_{y0} / E$. The post-yield tangent modulus, $E_t$, is derived from the series coupling of elastic and plastic stiffnesses, resulting in $E_t = \\frac{EH}{E+H}$ for $H > 0$. For perfect plasticity, $H=0$, which implies $E_t = 0$.\n\nThe uniaxial stress $\\sigma_x$ is a function of the axial strain $\\epsilon_x$ as follows:\n$$\n\\sigma_x(\\epsilon_x) =\n\\begin{cases}\nE \\epsilon_x & \\text{if } |\\epsilon_x| \\le \\epsilon_{y0} \\quad \\text{(Elastic)} \\\\\n\\sigma_{y0} + E_t (\\epsilon_x - \\epsilon_{y0}) & \\text{if } \\epsilon_x > \\epsilon_{y0} \\quad \\text{(Tension Yielding)} \\\\\n-\\sigma_{y0} + E_t (\\epsilon_x + \\epsilon_{y0}) & \\text{if } \\epsilon_x < -\\epsilon_{y0} \\quad \\text{(Compression Yielding)}\n\\end{cases}\n$$\nThis relationship is piecewise linear and continuous. The local tangent modulus, $d\\sigma_x/d\\epsilon_x$, is $E$ in the elastic range and $E_t$ in the plastic range.\n\n**3. Equilibrium of Stress Resultants**\nThe internal forces on the cross-section must be in equilibrium with any external loads. For pure bending, the net axial force $N$ must be zero. The axial force and bending moment $M$ are defined as the integrated effects of the stress distribution $\\sigma_x(y)$ over the cross-sectional area $A$.\n\nThe axial force resultant $N$ is:\n$$\nN = \\int_A \\sigma_x(y) \\, dA\n$$\nThe bending moment resultant $M$ about the z-axis (the axis parallel to the width $b$) is:\n$$\nM = \\int_A \\sigma_x(y) \\, y \\, dA\n$$\n\n**4. Numerical Solution: The Fiber Discretization Method**\nSince the stress function $\\sigma_x(\\epsilon_x(y))$ is nonlinear, the equilibrium integrals are analytically tractable only in the simplest cases. A general and powerful solution is to discretize the cross-section into a finite number of \"fibers.\"\n\nWe divide the rectangular section of width $b$ and height $h$ into $N_y$ horizontal fibers of equal thickness. Each fiber $i$ has an area $\\Delta A = b \\cdot (h/N_y)$ and is located at a centroidal coordinate $y_i$. For a uniform discretization, the coordinate of the $i$-th fiber (for $i=1, 2, \\ldots, N_y$) can be defined at the center of each layer:\n$$\ny_i = -\\frac{h}{2} + \\left(i - \\frac{1}{2}\\right) \\frac{h}{N_y}\n$$\nThe continuous integrals for $N$ and $M$ are then approximated by finite sums:\n$$\nN \\approx \\sum_{i=1}^{N_y} \\sigma_i \\Delta A \\quad\\text{and}\\quad M \\approx \\sum_{i=1}^{N_y} \\sigma_i y_i \\Delta A\n$$\nThe strain in each fiber is given by the kinematic relation: $\\epsilon_i = \\epsilon_0 + \\kappa y_i$. The stress in each fiber, $\\sigma_i$, is then determined from the constitutive law: $\\sigma_i = \\sigma_x(\\epsilon_i)$.\n\n**5. Algorithm to Compute Moment for a Given Curvature**\nFor a specified curvature $\\kappa$, our procedure is:\n1.  **Solve for $\\epsilon_0$**: We must find the value of $\\epsilon_0$ that satisfies the axial equilibrium condition $N(\\epsilon_0, \\kappa) = 0$. This is a root-finding problem for the scalar nonlinear equation:\n    $$\n    N(\\epsilon_0) = \\sum_{i=1}^{N_y} \\sigma_x(\\epsilon_0 + \\kappa y_i) \\Delta A = 0\n    $$\n    The function $N(\\epsilon_0)$ is monotonically increasing because $\\sigma_x(\\epsilon_x)$ is a monotonically increasing function. This property guarantees a unique root. A robust numerical method, such as Brent's method or a Newton-Raphson scheme with a bisection fallback, is suitable for this task. The problem specification recommends this robust approach. We will use a standard library implementation of a bracketing root-finder (Brent's method) which is highly reliable. To use such a method, we only need to provide a search interval $[\\epsilon_{a}, \\epsilon_{b}]$ such that $N(\\epsilon_{a})$ and $N(\\epsilon_{b})$ have opposite signs. A sufficiently large interval, such as $[-0.1, 0.1]$, is guaranteed to bracket the root for any realistic engineering problem.\n\n2.  **Compute Bending Moment $M$**: Once the unique root $\\epsilon_0$ is found, the strain distribution is fully defined. The corresponding stress $\\sigma_i$ in each fiber can be calculated. The bending moment $M$ is then computed by the summation:\n    $$\n    M = \\sum_{i=1}^{N_y} \\sigma_x(\\epsilon_0 + \\kappa y_i) \\cdot y_i \\cdot \\Delta A\n    $$\n\nThis algorithm is implemented in the following Python code, adhering to all specified constraints. The code defines a function for the bilinear constitutive law, a function to compute the axial force for a given $\\epsilon_0$, and uses `scipy.optimize.root_scalar` to solve the equilibrium equation before finally calculating the moment. This process is repeated for each test case provided.", "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the moment-curvature problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # (b, h, E, sigma_y0, H, kappa)\n        # Case A: Elastic\n        (0.3, 0.6, 210e9, 250e6, 2e9, 1.0e-5),\n        # Case B: Moderate plasticity with hardening\n        (0.3, 0.6, 210e9, 250e6, 2e9, 5.0e-3),\n        # Case C: Near fully plastic, perfect plasticity\n        (0.3, 0.6, 210e9, 250e6, 0.0, 5.0e-2),\n        # Case D: Zero curvature boundary case\n        (0.3, 0.6, 210e9, 250e6, 1e9, 0.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        moment = calculate_moment_for_section(*params)\n        results.append(f\"{moment:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\n\ndef get_stress(epsilon, E, sigma_y0, E_t):\n    \"\"\"\n    Computes stress based on a bilinear elastoplastic model with linear hardening.\n    This function is vectorized to handle numpy arrays of strain.\n    \"\"\"\n    epsilon_y0 = sigma_y0 / E\n\n    # Conditions for elastic, tension yield, and compression yield\n    elastic_cond = np.abs(epsilon) <= epsilon_y0\n    tension_yield_cond = epsilon > epsilon_y0\n    \n    # Calculate stress using np.where for vectorized conditional logic\n    stress = np.where(\n        elastic_cond,\n        E * epsilon,\n        np.where(\n            tension_yield_cond,\n            sigma_y0 + E_t * (epsilon - epsilon_y0),  # Tension yield\n            -sigma_y0 + E_t * (epsilon + epsilon_y0) # Compression yield\n        )\n    )\n    return stress\n\n\ndef calculate_moment_for_section(b, h, E, sigma_y0, H, kappa, Ny=800):\n    \"\"\"\n    Calculates the bending moment for a rectangular section given curvature and\n    material properties, using the fiber method.\n\n    Args:\n        b (float): Width of the cross-section [m].\n        h (float): Height of the cross-section [m].\n        E (float): Young's modulus [Pa].\n        sigma_y0 (float): Initial yield stress [Pa].\n        H (float): Hardening modulus [Pa].\n        kappa (float): Curvature [rad/m].\n        Ny (int): Number of fibers for discretization.\n\n    Returns:\n        float: The corresponding bending moment [Nm].\n    \"\"\"\n    if kappa == 0.0:\n        return 0.0\n\n    # 1. Define section and material properties\n    delta_A = b * h / Ny\n    epsilon_y0 = sigma_y0 / E\n    if H > 0:\n        E_t = (E * H) / (E + H)\n    else:\n        E_t = 0.0\n\n    # 2. Discretize the section (fiber coordinates)\n    # y_coords are the centroidal positions of each fiber\n    y_coords = np.linspace(-h/2 + h/(2*Ny), h/2 - h/(2*Ny), Ny)\n\n    # 3. Define the objective function for the root-finder\n    # This function computes the net axial force N for a given axial strain epsilon_0.\n    def axial_force_function(epsilon_0):\n        # Calculate strain in each fiber\n        strains = epsilon_0 + kappa * y_coords\n        # Calculate stress in each fiber using the constitutive law\n        stresses = get_stress(strains, E, sigma_y0, E_t)\n        # Sum forces from all fibers to get the total axial force\n        net_force = np.sum(stresses) * delta_A\n        return net_force\n\n    # 4. Solve for epsilon_0 that makes axial force N = 0\n    # We use a robust bracketing root-finder from SciPy.\n    # The bracket [-0.1, 0.1] is extremely safe for strains in structural materials.\n    try:\n        # A robust bracketing solver like brentq is preferred\n        solution = optimize.root_scalar(\n            axial_force_function,\n            bracket=[-0.1, 0.1],\n            method='brentq'\n        )\n        epsilon_0_sol = solution.root\n    except ValueError:\n        # This fallback might occur if N(a) and N(b) have the same sign,\n        # which is unlikely with a large bracket for this well-behaved function.\n        # But for robustness, we return NaN.\n        return np.nan\n\n    # 5. Compute the bending moment using the found epsilon_0\n    # With the correct epsilon_0, compute the final strain and stress distributions\n    final_strains = epsilon_0_sol + kappa * y_coords\n    final_stresses = get_stress(final_strains, E, sigma_y0, E_t)\n    \n    # The moment is the sum of force*lever_arm for all fibers\n    moment = np.sum(final_stresses * y_coords) * delta_A\n    \n    return moment\n\nsolve()\n```", "id": "2663507"}, {"introduction": "A core application of the moment-curvature relationship lies in the field of plastic design, where understanding a structure's post-yield behavior is paramount for safety and resilience. This exercise bridges the gap between the theoretical $M$-$\\kappa$ curve and its practical use in quantifying the rotation capacity of a plastic hinge. You will connect the abstract concept of section curvature to the tangible engineering parameter of plastic rotation, a key metric for assessing the ductility of structures under extreme loads. [@problem_id:2663512]", "problem": "A prismatic steel beam with a rectangular cross-section of width $b=200~\\mathrm{mm}$ and depth $h=300~\\mathrm{mm}$ is subjected to a monotonically increasing bending moment that localizes at midspan. Assume Euler–Bernoulli beam theory (plane sections remain plane and small strains), and an Elastic–Perfectly Plastic (EPP) constitutive law for steel with Young’s modulus $E=210~\\mathrm{GPa}$ and yield stress $\\sigma_{y}=355~\\mathrm{MPa}$; take the strain hardening ratio to be zero. In a constant-moment region surrounding the maximum-moment section, adopt a plastic zone (plastic hinge) length $L_{p}=0.5\\,h$. The structure must be able to supply a target plastic rotation capacity at the hinge of $\\Theta_{\\mathrm{req}}=0.030~\\mathrm{rad}$. To ensure material ductility is not exceeded, take an ultimate usable engineering strain magnitude at the extreme fiber of $\\varepsilon_{u}=0.10$. \n\nStarting from the fundamental kinematics of Euler–Bernoulli bending and the linear elastic law up to first yield, and then using the EPP idealization beyond yield, derive the yield curvature and a relation for the plastic rotation accumulated over the plastic zone. Use these to determine the smallest section curvature $\\kappa$ at the hinge such that the plastic rotation capacity equals $\\Theta_{\\mathrm{req}}$, subject to the ductility bound implied by $\\varepsilon_{u}$. If the computed curvature exceeds the ductility-limited curvature, use the ductility-limited value instead. \n\nExpress the final curvature in radians per meter and round your answer to four significant figures.", "solution": "The problem is subjected to validation.\n\nStep 1: Extract Givens.\n- Beam type: Prismatic, rectangular cross-section.\n- Cross-section width: $b=200~\\mathrm{mm}$.\n- Cross-section depth: $h=300~\\mathrm{mm}$.\n- Beam theory: Euler–Bernoulli.\n- Material model: Elastic–Perfectly Plastic (EPP).\n- Young’s modulus: $E=210~\\mathrm{GPa}$.\n- Yield stress: $\\sigma_{y}=355~\\mathrm{MPa}$.\n- Strain hardening ratio: $0$.\n- Plastic hinge length: $L_{p}=0.5\\,h$.\n- Required plastic rotation: $\\Theta_{\\mathrm{req}}=0.030~\\mathrm{rad}$.\n- Ultimate usable engineering strain: $\\varepsilon_{u}=0.10$.\n\nStep 2: Validate Using Extracted Givens.\n- **Scientifically Grounded**: The problem is based on the classical Euler–Bernoulli beam theory and the widely used Elastic–Perfectly Plastic material model. These are fundamental and standard concepts in structural mechanics and solid mechanics. All provided material and geometric properties are realistic for a structural steel beam.\n- **Well-Posed**: The problem is well-posed. It provides sufficient information to derive the required quantities and determine a unique numerical answer. The objective is clearly defined.\n- **Objective**: The problem is stated in precise, objective language without ambiguity or subjective claims.\n\nStep 3: Verdict and Action.\nThe problem is valid. It is a standard exercise in the plastic analysis of structures. A solution will be provided.\n\nThe analysis proceeds by deriving the necessary relations from first principles as requested.\n\nFirst, we derive the yield curvature, $\\kappa_{y}$. According to the Euler–Bernoulli beam theory, the normal strain $\\varepsilon$ at a distance $y$ from the neutral axis is linearly proportional to the curvature $\\kappa$. We adopt the sign convention where positive curvature causes tension (positive strain) for positive $y$.\n$$ \\varepsilon(y) = \\kappa y $$\nYielding initiates when the strain at the extreme fiber, where $|y| = h/2$, reaches the yield strain $\\varepsilon_{y}$. The yield strain is defined by Hooke's law, $\\varepsilon_{y} = \\sigma_{y}/E$.\nLet $\\kappa_{y}$ be the curvature at first yield.\n$$ \\varepsilon_{y} = \\kappa_{y} \\frac{h}{2} $$\nSubstituting the expression for $\\varepsilon_{y}$ and solving for $\\kappa_{y}$:\n$$ \\frac{\\sigma_{y}}{E} = \\kappa_{y} \\frac{h}{2} \\implies \\kappa_{y} = \\frac{2\\sigma_{y}}{Eh} $$\nThis is the expression for the yield curvature.\n\nNext, we derive the relation for the plastic rotation, $\\Theta_{p}$. The total curvature $\\kappa$ at a section can be decomposed into an elastic part $\\kappa_e$ and a plastic part $\\kappa_p$. For an EPP material, once the section is fully plastic, any increase in curvature is purely plastic. However, the problem simplifies the analysis by defining plastic rotation as the integral of the plastic component of curvature, $\\kappa_p = \\kappa - \\kappa_y$, over the defined plastic hinge length $L_p$. The problem specifies to \"adopt a plastic zone ... length $L_p$\" within a \"constant-moment region\". A constant moment implies a constant curvature $\\kappa$ throughout this region.\nThe plastic rotation $\\Theta_{p}$ is thus the integral of the constant plastic curvature over the length $L_p$:\n$$ \\Theta_{p} = \\int_{0}^{L_{p}} \\kappa_{p} \\, dx = \\int_{0}^{L_{p}} (\\kappa - \\kappa_{y}) \\, dx $$\nSince $\\kappa$ and $\\kappa_{y}$ are constant over this length:\n$$ \\Theta_{p} = (\\kappa - \\kappa_{y}) L_{p} $$\nThis is the required relation for plastic rotation.\n\nWe are tasked to find the curvature $\\kappa$ that satisfies the target plastic rotation $\\Theta_{\\mathrm{req}} = 0.030~\\mathrm{rad}$. Let this curvature be $\\kappa_{\\mathrm{req}}$. Setting $\\Theta_{p} = \\Theta_{\\mathrm{req}}$:\n$$ \\Theta_{\\mathrm{req}} = (\\kappa_{\\mathrm{req}} - \\kappa_{y}) L_{p} $$\nSolving for $\\kappa_{\\mathrm{req}}$:\n$$ \\kappa_{\\mathrm{req}} = \\kappa_{y} + \\frac{\\Theta_{\\mathrm{req}}}{L_{p}} $$\n\nBefore finalizing, this required curvature must be checked against the ductility limit. The ultimate strain at the extreme fiber is given as $\\varepsilon_{u}$. The curvature that corresponds to this strain limit, $\\kappa_{u}$, is found from the fundamental kinematic relation:\n$$ \\varepsilon_u = \\kappa_u \\frac{h}{2} \\implies \\kappa_u = \\frac{2\\varepsilon_u}{h} $$\nThe final curvature $\\kappa$ must not cause the material to exceed its ultimate strain capacity. Therefore, the actual curvature is the minimum of the required curvature and the ultimate curvature:\n$$ \\kappa = \\min(\\kappa_{\\mathrm{req}}, \\kappa_{u}) $$\n\nWe now substitute the given numerical values into the derived expressions. All units will be converted to the SI base units (meters, Pascals, radians).\n- $h = 300~\\mathrm{mm} = 0.3~\\mathrm{m}$\n- $E = 210~\\mathrm{GPa} = 210 \\times 10^{9}~\\mathrm{Pa}$\n- $\\sigma_{y} = 355~\\mathrm{MPa} = 355 \\times 10^{6}~\\mathrm{Pa}$\n- $L_p = 0.5 h = 0.5 \\times 0.3~\\mathrm{m} = 0.15~\\mathrm{m}$\n- $\\Theta_{\\mathrm{req}} = 0.030~\\mathrm{rad}$\n- $\\varepsilon_u = 0.10$\n\n1.  Calculate the yield curvature $\\kappa_y$:\n    $$ \\kappa_{y} = \\frac{2 \\times (355 \\times 10^{6}~\\mathrm{Pa})}{(210 \\times 10^{9}~\\mathrm{Pa}) \\times (0.3~\\mathrm{m})} = \\frac{710 \\times 10^{6}}{63 \\times 10^{9}}~\\mathrm{m}^{-1} \\approx 0.0112698~\\mathrm{rad/m} $$\n\n2.  Calculate the required curvature $\\kappa_{\\mathrm{req}}$ for the target plastic rotation:\n    $$ \\kappa_{\\mathrm{req}} = \\kappa_{y} + \\frac{\\Theta_{\\mathrm{req}}}{L_{p}} = 0.0112698~\\mathrm{rad/m} + \\frac{0.030~\\mathrm{rad}}{0.15~\\mathrm{m}} $$\n    $$ \\kappa_{\\mathrm{req}} = 0.0112698~\\mathrm{rad/m} + 0.2~\\mathrm{rad/m} = 0.2112698~\\mathrm{rad/m} $$\n\n3.  Calculate the ultimate curvature $\\kappa_u$ from the ductility limit:\n    $$ \\kappa_u = \\frac{2 \\varepsilon_u}{h} = \\frac{2 \\times 0.10}{0.3~\\mathrm{m}} = \\frac{0.2}{0.3}~\\mathrm{m}^{-1} \\approx 0.666667~\\mathrm{rad/m} $$\n\n4.  Compare $\\kappa_{\\mathrm{req}}$ with $\\kappa_u$:\n    $0.2112698~\\mathrm{rad/m} < 0.666667~\\mathrm{rad/m}$\n    Since $\\kappa_{\\mathrm{req}} < \\kappa_{u}$, the ductility limit is not exceeded. The required curvature is achievable.\n    The final answer is $\\kappa = \\kappa_{\\mathrm{req}}$.\n\nRounding the result to four significant figures as requested:\n$$ \\kappa \\approx 0.2113~\\mathrm{rad/m} $$", "answer": "$$\n\\boxed{0.2113}\n$$", "id": "2663512"}]}