{"hands_on_practices": [{"introduction": "The predictive power of continuum mechanics stems from its ability to derive governing equations of motion from fundamental conservation principles. This exercise is a classic and essential derivation that bridges the abstract laws of mass and momentum conservation with the concrete phenomenon of wave propagation in elastic solids. By systematically linearizing and combining these laws, you will derive the elastodynamic wave equation and discover how material properties like Lamé's constants and density determine the characteristic speeds of waves traveling through a material [@problem_id:2623893].", "problem": "A homogeneous, isotropic solid in the small-strain regime occupies an unbounded domain. Let $\\rho$, $\\mathbf{v}$, and $\\boldsymbol{\\sigma}$ denote the current mass density, velocity, and Cauchy stress, respectively. Assume the following fundamental laws and definitions hold:\n- Mass conservation: $\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$.\n- Linear momentum balance (neglecting body forces): $\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$.\n- Small-strain kinematics with displacement $\\mathbf{u}$: $\\mathbf{v} = \\dot{\\mathbf{u}}$ and $\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$.\n- Isotropic linear elastic constitutive behavior: $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$, with Lamé moduli $\\lambda$ and $\\mu$.\n\nLinearize the mass conservation about a constant reference density $\\rho_{0}$ and combine it with linear momentum balance to obtain a closed system for $\\mathbf{u}$ and $\\rho$. Classify the resulting system for a compressible solid and for the incompressible limit, and state the parameter conditions under which the initial value problem is well posed in each case.\n\nFinally, consider plane-wave solutions and extract the longitudinal characteristic speed. Let $\\mathbf{u}(\\mathbf{x},t) = \\Re\\{\\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)\\}$ with wavevector $\\mathbf{k} \\neq \\mathbf{0}$, angular frequency $\\omega$, and polarization $\\mathbf{a} \\neq \\mathbf{0}$. Define the longitudinal characteristic speed $c_{\\mathrm{L}}$ by $c_{\\mathrm{L}} = \\omega/\\|\\mathbf{k}\\|$ associated with polarizations parallel to $\\mathbf{k}$. What is the closed-form analytic expression for $c_{\\mathrm{L}}^{2}$ in terms of $\\lambda$, $\\mu$, and $\\rho_{0}$? Provide your final answer as a single analytic expression; do not evaluate numerically.", "solution": "The problem statement is subjected to rigorous validation before any attempt at a solution.\n\nStep 1: Extracted Givens\n- Domain: A homogeneous, isotropic solid in the small-strain regime occupying an unbounded domain.\n- State variables: Current mass density $\\rho$, velocity $\\mathbf{v}$, Cauchy stress $\\boldsymbol{\\sigma}$, displacement $\\mathbf{u}$.\n- Fundamental Laws:\n    - Mass conservation: $\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$.\n    - Linear momentum balance (body forces neglected): $\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$.\n- Definitions and Constitutive Relations:\n    - Small-strain kinematics: $\\mathbf{v} = \\dot{\\mathbf{u}}$ and $\\boldsymbol{\\varepsilon} = \\dfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$.\n    - Isotropic linear elastic constitutive behavior: $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$, with Lamé moduli $\\lambda$ and $\\mu$.\n- Analysis Tasks:\n    - Linearize mass conservation about a constant reference density $\\rho_{0}$.\n    - Combine with linearized momentum balance to obtain a closed system for $\\mathbf{u}$ and $\\rho$.\n    - Classify the resulting system and state well-posedness conditions for compressible and incompressible cases.\n    - Consider a plane-wave solution $\\mathbf{u}(\\mathbf{x},t) = \\Re\\{\\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)\\}$ with wavevector $\\mathbf{k} \\neq \\mathbf{0}$, angular frequency $\\omega$, and polarization $\\mathbf{a} \\neq \\mathbf{0}$.\n    - Extract the longitudinal characteristic speed $c_{\\mathrm{L}} = \\omega/\\|\\mathbf{k}\\|$ for polarizations parallel to $\\mathbf{k}$, and find an expression for $c_{\\mathrm{L}}^{2}$.\n\nStep 2: Validation\nThe problem is scientifically grounded, being based entirely on the fundamental principles of continuum mechanics and linear elasticity. It is well-posed, objective, and self-contained, providing all necessary equations and definitions to derive the requested result. The problem requires a standard, but non-trivial, derivation in elastodynamics. There are no logical contradictions, factual errors, or ambiguities.\n\nStep 3: Verdict\nThe problem is valid. A solution will be formulated.\n\nThe derivation proceeds from first principles as required.\n\nFirst, we linearize the governing equations. We consider small perturbations from a quiescent state, where $\\rho = \\rho_{0}$, $\\mathbf{v} = \\mathbf{0}$, and $\\mathbf{u} = \\mathbf{0}$. We let $\\rho = \\rho_0 + \\rho'$, where $\\rho'$ and $\\mathbf{v} = \\dot{\\mathbf{u}}$ are first-order small quantities.\n\nThe mass conservation equation is $\\dfrac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho \\nabla \\cdot \\mathbf{v} = 0$. The material derivative is $\\dfrac{\\mathrm{D}}{\\mathrm{D}t} = \\dfrac{\\partial}{\\partial t} + \\mathbf{v} \\cdot \\nabla$.\nExpanding this:\n$$\n\\frac{\\partial (\\rho_{0} + \\rho')}{\\partial t} + \\mathbf{v} \\cdot \\nabla (\\rho_{0} + \\rho') + (\\rho_{0} + \\rho') \\nabla \\cdot \\mathbf{v} = 0\n$$\nSince $\\rho_0$ is a constant, this simplifies to:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\rho' + \\rho_{0} \\nabla \\cdot \\mathbf{v} + \\rho' \\nabla \\cdot \\mathbf{v} = 0\n$$\nNeglecting second-order terms (products of small quantities like $\\mathbf{v} \\cdot \\nabla \\rho'$ and $\\rho' \\nabla \\cdot \\mathbf{v}$), the linearized mass conservation equation is:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\mathbf{v} = 0\n$$\nSince $\\mathbf{v} = \\dot{\\mathbf{u}} = \\dfrac{\\partial \\mathbf{u}}{\\partial t}$, this becomes $\\dfrac{\\partial \\rho'}{\\partial t} + \\rho_{0} \\nabla \\cdot \\left(\\dfrac{\\partial \\mathbf{u}}{\\partial t}\\right) = 0$.\n\nNext, we linearize the linear momentum balance: $\\rho \\,\\dfrac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma}$.\nThe left-hand side is $(\\rho_0 + \\rho') \\left( \\dfrac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right)$. The convective acceleration $(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$ is second-order. The term $\\rho' \\dfrac{\\partial \\mathbf{v}}{\\partial t}$ is also second-order. The only first-order term is $\\rho_0 \\dfrac{\\partial \\mathbf{v}}{\\partial t}$. With $\\mathbf{v} = \\dot{\\mathbf{u}}$, this is $\\rho_0 \\ddot{\\mathbf{u}}$.\nThe stress tensor $\\boldsymbol{\\sigma}$ is already a first-order quantity, as it is linear in the strain $\\boldsymbol{\\varepsilon}$, which is linear in gradients of the first-order displacement $\\mathbf{u}$. Thus, the linearized momentum equation is:\n$$\n\\rho_{0} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = \\nabla \\cdot \\boldsymbol{\\sigma}\n$$\nNow, substitute the constitutive relation $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$ and the strain definition $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$. Note that $\\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$.\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\nabla \\cdot \\left( \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon} \\right) = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + 2\\mu \\nabla \\cdot \\boldsymbol{\\varepsilon}\n$$\n$$\n2\\mu \\nabla \\cdot \\boldsymbol{\\varepsilon} = \\mu \\nabla \\cdot (\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})\n$$\nUsing the vector identities $\\nabla \\cdot (\\nabla \\mathbf{u}) = \\nabla^2 \\mathbf{u}$ (vector Laplacian) and $\\nabla \\cdot (\\nabla \\mathbf{u}^{\\mathsf{T}}) = \\nabla(\\nabla \\cdot \\mathbf{u})$, we obtain:\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu (\\nabla^2 \\mathbf{u} + \\nabla(\\nabla \\cdot \\mathbf{u})) = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\nThe governing equation for the displacement field $\\mathbf{u}$ is thus:\n$$\n\\rho_{0} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\nThis is the elastodynamic wave equation, also known as Navier's equation. The closed system consists of this equation for $\\mathbf{u}$ and the linearized mass conservation relating $\\rho'$ to $\\mathbf{u}$.\n\nFor a compressible solid, this is a system of second-order hyperbolic partial differential equations. An initial value problem is well-posed if the material parameters ensure physical stability, which corresponds to the strain energy density being positive-definite. This requires the Lamé parameters to satisfy $\\mu > 0$ and $\\lambda + \\frac{2}{3}\\mu > 0$ (positive bulk modulus). A stricter condition, ensuring real wave speeds for all propagation directions, is $\\mu > 0$ and $\\lambda + 2\\mu > 0$.\n\nIn the incompressible limit, we impose the constraint $\\nabla \\cdot \\mathbf{v} = 0$, which for a deformation starting from rest implies $\\nabla \\cdot \\mathbf{u} = 0$. Mass conservation $\\dot{\\rho'} + \\rho_0 \\nabla \\cdot \\mathbf{v}=0$ then implies $\\dot{\\rho'} = 0$, so the density remains constant. The term $\\lambda (\\nabla \\cdot \\mathbf{u})$ in the stress becomes indeterminate and is replaced by a scalar pressure field $-p$ that acts as a Lagrange multiplier to enforce the incompressibility constraint. The constitutive law becomes $\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}$. The momentum equation becomes:\n$$\n\\rho_{0} \\ddot{\\mathbf{u}} = \\nabla \\cdot (-p\\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}) = -\\nabla p + \\mu \\nabla^2\\mathbf{u}\n$$\nTaking the divergence of this equation and using $\\nabla \\cdot \\mathbf{u} = 0$ yields $\\nabla^2 p = 0$. The pressure field is governed by an elliptic Laplace equation, while the evolution of the solenoidal part of the velocity field is governed by a wave equation. The system is of mixed elliptic-hyperbolic type. The initial value problem is well-posed if $\\mu > 0$.\n\nTo find the longitudinal wave speed, we use the compressible elastodynamic equation and substitute the plane-wave ansatz $\\mathbf{u}(\\mathbf{x},t) = \\mathbf{a}\\,\\exp\\left(\\mathrm{i}(\\mathbf{k}\\cdot \\mathbf{x} - \\omega t)\\right)$. The required derivatives are:\n$$\n\\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = -\\omega^2 \\mathbf{u}\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{u}) = \\nabla(\\mathrm{i}\\mathbf{k} \\cdot \\mathbf{u}) = \\mathrm{i}\\mathbf{k}(\\mathrm{i}\\mathbf{k} \\cdot \\mathbf{u}) = -(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} \\exp(\\dots)\n$$\n$$\n\\nabla^2 \\mathbf{u} = \\nabla \\cdot (\\nabla \\mathbf{u}) = \\nabla \\cdot (\\mathrm{i}\\mathbf{k}\\mathbf{u}) = \\mathrm{i}\\mathbf{k} \\cdot (\\mathrm{i}\\mathbf{k}\\mathbf{u}) = -(\\mathbf{k} \\cdot \\mathbf{k})\\mathbf{u} = -\\|\\mathbf{k}\\|^2 \\mathbf{u}\n$$\nSubstituting these into Navier's equation:\n$$\n\\rho_{0}(-\\omega^2 \\mathbf{a}) \\exp(\\dots) = (\\lambda + \\mu)( -(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k}) \\exp(\\dots) + \\mu(-\\|\\mathbf{k}\\|^2 \\mathbf{a}) \\exp(\\dots)\n$$\nCanceling the exponential term and negative signs yields the Christoffel equation:\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + \\mu)(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} + \\mu\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\nFor longitudinal waves, the polarization vector $\\mathbf{a}$ is parallel to the wavevector $\\mathbf{k}$. Thus, $\\mathbf{a}$ is an eigenvector of the tensor operator. In this case, $\\mathbf{a}$ can be written as a scalar multiple of $\\mathbf{k}$. The relationship $\\mathbf{k} \\cdot \\mathbf{a} = \\|\\mathbf{k}\\| \\|\\mathbf{a}\\|$ holds. Then $(\\mathbf{k} \\cdot \\mathbf{a})\\mathbf{k} = (\\|\\mathbf{k}\\| \\|\\mathbf{a}\\|) \\frac{\\mathbf{k}}{\\|\\mathbf{k}\\|} \\|\\mathbf{k}\\| = \\|\\mathbf{k}\\|^2 \\|\\mathbf{a}\\| \\frac{\\mathbf{a}}{\\|\\mathbf{a}\\|} = \\|\\mathbf{k}\\|^2 \\mathbf{a}$.\nSubstituting this into the Christoffel equation:\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + \\mu)\\|\\mathbf{k}\\|^2 \\mathbf{a} + \\mu\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\n$$\n\\rho_{0} \\omega^2 \\mathbf{a} = (\\lambda + 2\\mu)\\|\\mathbf{k}\\|^2 \\mathbf{a}\n$$\nSince $\\mathbf{a} \\neq \\mathbf{0}$, we can divide by the vector $\\mathbf{a}$:\n$$\n\\rho_{0} \\omega^2 = (\\lambda + 2\\mu)\\|\\mathbf{k}\\|^2\n$$\nThe longitudinal characteristic speed $c_{\\mathrm{L}}$ is defined as $\\omega/\\|\\mathbf{k}\\|$. We are asked for $c_{\\mathrm{L}}^{2}$:\n$$\nc_{\\mathrm{L}}^{2} = \\frac{\\omega^2}{\\|\\mathbf{k}\\|^2} = \\frac{\\lambda + 2\\mu}{\\rho_{0}}\n$$\nThis is the final expression. This result confirms the well-posedness condition $\\lambda+2\\mu > 0$ for a compressible solid, as the wave speed squared must be positive for real wave propagation to occur.", "answer": "$$\n\\boxed{\\frac{\\lambda + 2\\mu}{\\rho_{0}}}\n$$", "id": "2623893"}, {"introduction": "Conservation of mass plays a pivotal role in coupling different physical phenomena, providing essential kinematic relationships. This practice delves into the realm of thermoelasticity, where thermal expansion causes a material to deform. You will apply the continuity equation to a solid experiencing a rapid, non-uniform temperature change to derive the resulting field of volumetric strain rate, a key quantity in understanding thermal shock and transient thermal stresses [@problem_id:2623896].", "problem": "A homogeneous, orthotropic thermoelastic solid occupies a plate-like region with Cartesian coordinates $(x,y,z)$ and thickness $H$ along $z$. The solid experiences a rapid thermal loading whose material time derivative of temperature is prescribed as\n$$\n\\dot{T}(x,y,z,t) = \\Gamma \\,\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{a^{2}}\\right)\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\cos\\!\\left(\\frac{\\pi z}{H}\\right).\n$$\nThe principal material directions of orthotropy are aligned with the $(x,y,z)$ axes, and the principal linear coefficients of thermal expansion are $\\alpha_{1}$, $\\alpha_{2}$, and $\\alpha_{3}$ along $x$, $y$, and $z$, respectively. Assume small strains and rotations, no mass sources or sinks, no diffusion, and traction-free boundaries so that the body undergoes free thermal expansion during the transient.\n\nStarting only from the local mass conservation law for a deforming continuum and the small-strain kinematics, derive an expression for the volumetric strain rate field $\\dot{\\theta}(x,y,z,t)$ induced by the prescribed $\\dot{T}(x,y,z,t)$ under free thermal expansion in an orthotropic solid. Then evaluate $\\dot{\\theta}$ at the point $(x,y,z)=\\left(\\frac{a}{\\sqrt{2}},\\,0,\\,\\frac{H}{3}\\right)$ and time $t=\\tau \\ln 2$ for the parameters\n$$\n\\alpha_{1}=4.0\\times 10^{-6}\\ \\text{K}^{-1},\\quad \\alpha_{2}=6.0\\times 10^{-6}\\ \\text{K}^{-1},\\quad \\alpha_{3}=8.0\\times 10^{-6}\\ \\text{K}^{-1},\n$$\n$$\n\\Gamma=2.0\\times 10^{4}\\ \\text{K}\\,\\text{s}^{-1},\\quad a=2.0\\ \\text{mm},\\quad H=5.0\\ \\text{mm},\\quad \\tau=1.00\\times 10^{-2}\\ \\text{s}.\n$$\nExpress the final numerical value of $\\dot{\\theta}$ in $\\text{s}^{-1}$ and round your answer to four significant figures.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on fundamental principles of continuum mechanics, specifically the interplay between mass conservation, small-strain kinematics, and thermoelastic constitutive laws. The problem is self-contained and free of contradictions or ambiguities. I will now proceed with the solution.\n\nThe starting point is the local form of the law of conservation of mass, also known as the continuity equation, which holds for any continuum. In the absence of mass sources or sinks, it is stated as:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0\n$$\nwhere $\\rho(x,y,z,t)$ is the mass density and $\\mathbf{v}(x,y,z,t)$ is the velocity field. Expanding the divergence term yields:\n$$\n\\frac{\\partial \\rho}{\\partial t} + (\\nabla \\rho) \\cdot \\mathbf{v} + \\rho (\\nabla \\cdot \\mathbf{v}) = 0\n$$\nThe first two terms constitute the material time derivative of the density, $\\dot{\\rho} = \\frac{D\\rho}{Dt} = \\frac{\\partial \\rho}{\\partial t} + (\\nabla \\rho) \\cdot \\mathbf{v}$. Thus, the continuity equation can be written compactly as:\n$$\n\\dot{\\rho} + \\rho (\\nabla \\cdot \\mathbf{v}) = 0\n$$\nWithin the framework of small-strain kinematics, the divergence of the velocity field, $\\nabla \\cdot \\mathbf{v}$, is equal to the rate of volumetric strain, $\\dot{\\theta}$. The volumetric strain, or dilatation, $\\theta$, is defined as the trace of the small strain tensor $\\boldsymbol{\\varepsilon}$, i.e., $\\theta = \\text{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{kk}$. The volumetric strain is related to the density change by $\\rho \\approx \\rho_0 (1 - \\theta)$, where $\\rho_0$ is the constant density in the undeformed reference configuration. Taking the material time derivative of this approximate relation gives $\\dot{\\rho} \\approx -\\rho_0 \\dot{\\theta}$. Substituting this and $\\rho \\approx \\rho_0$ into the continuity equation gives:\n$$\n-\\rho_0 \\dot{\\theta} + \\rho_0 (\\nabla \\cdot \\mathbf{v}) = 0\n$$\nwhich simplifies to $\\dot{\\theta} = \\nabla \\cdot \\mathbf{v}$. The rate of volumetric strain is also the trace of the rate of deformation tensor $\\mathbf{D}$, which under the small strain assumption is equal to the material time derivative of the strain tensor, $\\dot{\\boldsymbol{\\varepsilon}}$. Therefore, we have established the kinematic relation:\n$$\n\\dot{\\theta} = \\text{tr}(\\dot{\\boldsymbol{\\varepsilon}}) = \\dot{\\varepsilon}_{xx} + \\dot{\\varepsilon}_{yy} + \\dot{\\varepsilon}_{zz}\n$$\nNext, we invoke the constitutive law for a thermoelastic solid. The total strain tensor $\\boldsymbol{\\varepsilon}$ is additively decomposed into an elastic part $\\boldsymbol{\\varepsilon}^e$ and a thermal part $\\boldsymbol{\\varepsilon}^T$:\n$$\n\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^T\n$$\nThe problem states that the body undergoes free thermal expansion, which implies that the mechanical stress tensor $\\boldsymbol{\\sigma}$ is zero throughout the body. The elastic strain is related to the stress by the generalized Hooke's law, $\\boldsymbol{\\varepsilon}^e = \\mathbf{S}:\\boldsymbol{\\sigma}$, where $\\mathbf{S}$ is the fourth-order compliance tensor. With $\\boldsymbol{\\sigma}=\\mathbf{0}$, it follows that the elastic strain is also zero, $\\boldsymbol{\\varepsilon}^e = \\mathbf{0}$.\nConsequently, the total strain is purely thermal: $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^T$.\n\nFor an orthotropic material with principal axes of thermal expansion aligned with the Cartesian axes $(x,y,z)$, the thermal strain components are:\n$$\n\\varepsilon^T_{xx} = \\alpha_1 (T - T_{ref}), \\quad \\varepsilon^T_{yy} = \\alpha_2 (T - T_{ref}), \\quad \\varepsilon^T_{zz} = \\alpha_3 (T - T_{ref})\n$$\nwhere $\\alpha_1$, $\\alpha_2$, $\\alpha_3$ are the principal coefficients of linear thermal expansion and $T_{ref}$ is the stress-free reference temperature. Taking the material time derivative of the total strain tensor components, we find the strain rates:\n$$\n\\dot{\\varepsilon}_{xx} = \\dot{\\varepsilon}^T_{xx} = \\alpha_1 \\dot{T}\n$$\n$$\n\\dot{\\varepsilon}_{yy} = \\dot{\\varepsilon}^T_{yy} = \\alpha_2 \\dot{T}\n$$\n$$\n\\dot{\\varepsilon}_{zz} = \\dot{\\varepsilon}^T_{zz} = \\alpha_3 \\dot{T}\n$$\nHere, $\\dot{T}$ is the material time derivative of the temperature, which is prescribed in the problem. The volumetric strain rate $\\dot{\\theta}$ is the sum of these diagonal components:\n$$\n\\dot{\\theta} = \\dot{\\varepsilon}_{xx} + \\dot{\\varepsilon}_{yy} + \\dot{\\varepsilon}_{zz} = (\\alpha_1 + \\alpha_2 + \\alpha_3) \\dot{T}\n$$\nSubstituting the given expression for $\\dot{T}(x,y,z,t)$:\n$$\n\\dot{\\theta}(x,y,z,t) = (\\alpha_1 + \\alpha_2 + \\alpha_3) \\Gamma \\,\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{a^{2}}\\right)\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\cos\\!\\left(\\frac{\\pi z}{H}\\right)\n$$\nThis is the required general expression for the volumetric strain rate field.\n\nNow, we must evaluate this expression at the specified point $(x,y,z)=\\left(\\frac{a}{\\sqrt{2}},\\,0,\\,\\frac{H}{3}\\right)$ and time $t=\\tau \\ln 2$.\nFirst, we evaluate the spatial terms:\nThe argument of the first exponential function is:\n$$\n-\\frac{x^2 + y^2}{a^2} = -\\frac{(\\frac{a}{\\sqrt{2}})^2 + 0^2}{a^2} = -\\frac{a^2/2}{a^2} = -\\frac{1}{2}\n$$\nThe argument of the cosine function is:\n$$\n\\frac{\\pi z}{H} = \\frac{\\pi (H/3)}{H} = \\frac{\\pi}{3}\n$$\nSo, $\\cos(\\frac{\\pi}{3}) = \\frac{1}{2}$.\n\nNext, we evaluate the temporal term:\nThe argument of the second exponential function is:\n$$\n-\\frac{t}{\\tau} = -\\frac{\\tau \\ln 2}{\\tau} = -\\ln 2\n$$\nSo, $\\exp(-\\ln 2) = \\exp(\\ln(2^{-1})) = \\frac{1}{2}$.\n\nCombining these factors, the value of $\\dot{\\theta}$ at the specified point and time is:\n$$\n\\dot{\\theta} = (\\alpha_1 + \\alpha_2 + \\alpha_3) \\Gamma \\left[\\exp\\!\\left(-\\frac{1}{2}\\right)\\right] \\left[\\exp(-\\ln 2)\\right] \\left[\\cos\\!\\left(\\frac{\\pi}{3}\\right)\\right]\n$$\n$$\n\\dot{\\theta} = (\\alpha_1 + \\alpha_2 + \\alpha_3) \\Gamma \\left(\\frac{1}{\\sqrt{e}}\\right) \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{\\Gamma}{4\\sqrt{e}} (\\alpha_1 + \\alpha_2 + \\alpha_3)\n$$\nNow we substitute the given numerical values for the parameters:\n$\\alpha_1 = 4.0\\times 10^{-6}\\ \\text{K}^{-1}$\n$\\alpha_2 = 6.0\\times 10^{-6}\\ \\text{K}^{-1}$\n$\\alpha_3 = 8.0\\times 10^{-6}\\ \\text{K}^{-1}$\n$\\Gamma = 2.0\\times 10^{4}\\ \\text{K}\\,\\text{s}^{-1}$\n\nThe sum of the thermal expansion coefficients is:\n$$\n\\alpha_1 + \\alpha_2 + \\alpha_3 = (4.0 + 6.0 + 8.0) \\times 10^{-6}\\ \\text{K}^{-1} = 18.0 \\times 10^{-6}\\ \\text{K}^{-1}\n$$\nSubstituting these values into the expression for $\\dot{\\theta}$:\n$$\n\\dot{\\theta} = \\frac{2.0\\times 10^{4}\\ \\text{K}\\,\\text{s}^{-1}}{4\\sqrt{e}} (18.0 \\times 10^{-6}\\ \\text{K}^{-1})\n$$\n$$\n\\dot{\\theta} = \\frac{36.0 \\times 10^{-2}}{4\\sqrt{e}}\\ \\text{s}^{-1} = \\frac{9.0 \\times 10^{-2}}{\\sqrt{e}}\\ \\text{s}^{-1}\n$$\nUsing the value $e \\approx 2.71828$, we calculate $\\sqrt{e} \\approx 1.648721$.\n$$\n\\dot{\\theta} \\approx \\frac{0.09}{1.648721}\\ \\text{s}^{-1} \\approx 0.0545862\\ \\text{s}^{-1}\n$$\nRounding to four significant figures as required by the problem statement:\n$$\n\\dot{\\theta} \\approx 5.459 \\times 10^{-2}\\ \\text{s}^{-1}\n$$\nThis is the final numerical answer.", "answer": "$$\n\\boxed{5.459 \\times 10^{-2}}\n$$", "id": "2623896"}, {"introduction": "In the age of computational mechanics, it is not enough to understand the theory; one must also be able to verify that its numerical implementation is correct. This hands-on computational exercise guides you through the process of designing and implementing a verification test for the conservation of mass in a large deformation setting. By comparing the reference density $\\rho_0$ with the product of the current density $\\rho$ and the deformation Jacobian $J$, you will quantify both global and local errors, a fundamental skill for developing and validating finite element codes [@problem_id:2623914].", "problem": "A compressible solid occupies a reference configuration $\\Omega_0 \\subset \\mathbb{R}^3$ with material coordinates $\\mathbf{X} \\in \\Omega_0$ and deforms to a current configuration $\\Omega_t$ with spatial coordinates $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$. The deformation gradient is defined as $\\mathbf{F}(\\mathbf{X},t) = \\partial \\mathbf{x}/\\partial \\mathbf{X}$ and the Jacobian determinant is $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$, with $J(\\mathbf{X},t)  0$. Let $\\rho_0(\\mathbf{X})$ denote the reference mass density field at time $t=0$ and let $\\rho(\\mathbf{X},t)$ denote the spatial mass density at time $t$ evaluated at the mapped point $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$. Starting only from the fundamental statement that the total mass of any material region is invariant in time, and the definitions of $\\mathbf{F}$ and $J$, you must:\n\n- Derive expressions suitable for verification that quantify:\n  - A global mass conservation error for the entire body, expressed as a dimensionless scalar based on ratios of integrals over $\\Omega_0$.\n  - A local mass conservation error field expressed in $\\Omega_0$ and a corresponding dimensionless scalar measure based on a norm over $\\Omega_0$.\n\n- Design a numerical procedure to evaluate the above error measures from given fields $\\rho_0(\\mathbf{X})$, $\\mathbf{F}(\\mathbf{X})$, and $\\rho(\\mathbf{X})$ without using any property not implied by the fundamental statement. The numerical procedure must:\n  - Work on a hexahedral partition of $\\Omega_0 = [0,1]^3$ into a structured mesh with $N_e \\times N_e \\times N_e$ congruent elements, where $N_e$ is any positive integer. For this assignment, you must take $N_e = 8$.\n  - Approximate integrals over $\\Omega_0$ by tensor-product Gaussian quadrature with $2 \\times 2 \\times 2$ quadrature points per element. The $1$-dimensional quadrature rule on $[-1,1]$ uses points $\\{-1/\\sqrt{3},+1/\\sqrt{3}\\}$ with unit weights $\\{1,1\\}$. Map these points affinely to each element of size $h \\times h \\times h$ with $h = 1/N_e$ in the reference domain.\n  - Compute $J(\\mathbf{X}) = \\det \\mathbf{F}(\\mathbf{X})$ pointwise at quadrature points.\n  - Produce the global error as a dimensionless absolute ratio and a local error as a dimensionless norm ratio, both evaluated over $\\Omega_0$.\n\n- Implement the procedure as a program that evaluates the error measures for the following four test cases, where all fields are given in closed form. In each case, $\\mathbf{X} = (X_1,X_2,X_3)$ with $X_1,X_2,X_3 \\in [0,1]$. All coordinates are in meters (m). All densities are in kilograms per cubic meter (kg/m$^3$). The outputs are dimensionless decimals (no percent sign). Define $\\pi$ as the usual circular constant.\n\nTest suite:\n- Case A (kinematically compatible density):\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1 + 0.2\\,X_1\\big)\\big(1 + 0.1\\,X_2\\big)\\big(1 - 0.05\\,X_3\\big)}$.\n- Case B (small local perturbation to spatial density):\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1 + 0.2\\,X_1\\big)\\big(1 + 0.1\\,X_2\\big)\\big(1 - 0.05\\,X_3\\big)}\\Big(1 + 10^{-3}\\,\\sin(2\\pi X_1)\\sin(2\\pi X_2)\\sin(2\\pi X_3)\\Big)$.\n- Case C (uniform dilation with global bias):\n  - $\\mathbf{F}(\\mathbf{X}) = \\alpha\\,\\mathbf{I}$ with $\\alpha = 1.5$ and $\\mathbf{I}$ the identity tensor.\n  - $\\rho_0(\\mathbf{X}) = 7800$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\alpha^3}\\,(1 + 0.05)$.\n- Case D (strongly varying volumetric stretch with localized defect):\n  - $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1,\\; 1,\\; 0.2 + 0.1\\,X_3\\big)$.\n  - $\\rho_0(\\mathbf{X}) = 900 + 100\\,\\cos(2\\pi X_1)\\cos(2\\pi X_2)\\cos(2\\pi X_3)$.\n  - $\\rho(\\mathbf{X}) = \\dfrac{\\rho_0(\\mathbf{X})}{\\big(1\\big)\\big(1\\big)\\big(0.2 + 0.1\\,X_3\\big)} + 10\\,\\exp\\!\\Big(-\\dfrac{(X_1 - 0.5)^2 + (X_2 - 0.5)^2 + (X_3 - 0.5)^2}{0.02}\\Big)$.\n\nYour program must:\n- Use $N_e = 8$ with the specified $2 \\times 2 \\times 2$ Gaussian quadrature per element.\n- For each case, compute:\n  - The global mass error defined as the absolute value of a difference of two integrals divided by a reference integral, both over $\\Omega_0$.\n  - The local mass error norm defined as the square root of an integral of a squared residual divided by the square root of an integral of a squared reference field, both over $\\Omega_0$.\n- Aggregate the results for the four cases as $8$ floating-point numbers in the order $\\big[\\text{global}_A,\\text{local}_A,\\text{global}_B,\\text{local}_B,\\text{global}_C,\\text{local}_C,\\text{global}_D,\\text{local}_D\\big]$.\n- Final output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$). Each floating-point number must be rounded to exactly $8$ decimal places.\n\nExpress all final answers as pure decimals (no percent sign). No user input is required; the program must be self-contained and produce the single-line output upon execution.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Configurations**: Reference configuration $\\Omega_0 \\subset \\mathbb{R}^3$ with material coordinates $\\mathbf{X}$; current configuration $\\Omega_t$ with spatial coordinates $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X},t)$.\n- **Kinematics**: Deformation gradient $\\mathbf{F}(\\mathbf{X},t) = \\partial \\mathbf{x}/\\partial \\mathbf{X}$; Jacobian determinant $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)  0$.\n- **Density Fields**: Reference mass density $\\rho_0(\\mathbf{X})$; spatial mass density at the mapped point $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X},t)$ is given as $\\rho(\\mathbf{X},t)$.\n- **Fundamental Principle**: The total mass of any material region is invariant in time.\n- **Domain**: $\\Omega_0 = [0,1]^3 \\subset \\mathbb{R}^3$.\n- **Numerical Discretization**: A structured mesh of $N_e \\times N_e \\times N_e$ congruent hexahedral elements, with $N_e = 8$. Element size is $h = 1/N_e = 1/8$.\n- **Numerical Integration**: Tensor-product Gaussian quadrature with $2 \\times 2 \\times 2$ points per element. The $1$-D rule on $[-1,1]$ has points $\\{\\pm 1/\\sqrt{3}\\}$ and weights $\\{1,1\\}$.\n- **Task**: Derive expressions for a global mass conservation error and a local mass conservation error field and its norm. Implement a numerical procedure to evaluate these errors for four specified test cases.\n- **Test Cases**:\n    - Case A: $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1 + 0.2\\,X_1,\\; 1 + 0.1\\,X_2,\\; 1 - 0.05\\,X_3\\big)$, $\\rho_0(\\mathbf{X}) = 1000 + 100 \\,\\sin(\\pi X_1)\\,\\cos(\\pi X_2)\\,e^{-X_3}$, $\\rho(\\mathbf{X}) = \\rho_0(\\mathbf{X}) / J(\\mathbf{X})$.\n    - Case B: Same $\\mathbf{F}$ and $\\rho_0$ as Case A, $\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{J(\\mathbf{X})}\\Big(1 + 10^{-3}\\,\\sin(2\\pi X_1)\\sin(2\\pi X_2)\\sin(2\\pi X_3)\\Big)$.\n    - Case C: $\\mathbf{F}(\\mathbf{X}) = 1.5\\,\\mathbf{I}$, $\\rho_0(\\mathbf{X}) = 7800$, $\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{1.5^3}\\,(1 + 0.05)$.\n    - Case D: $\\mathbf{F}(\\mathbf{X}) = \\operatorname{diag}\\big(1,\\; 1,\\; 0.2 + 0.1\\,X_3\\big)$, $\\rho_0(\\mathbf{X}) = 900 + 100\\,\\cos(2\\pi X_1)\\cos(2\\pi X_2)\\cos(2\\pi X_3)$, $\\rho(\\mathbf{X}) = \\frac{\\rho_0(\\mathbf{X})}{J(\\mathbf{X})} + 10\\,\\exp\\!\\Big(-\\frac{(X_1 - 0.5)^2 + (X_2 - 0.5)^2 + (X_3 - 0.5)^2}{0.02}\\Big)$.\n- **Output Requirement**: A single list of $8$ decimal numbers (global and local error for each case) rounded to $8$ decimal places.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is examined against the specified validity criteria.\n- **Scientifically Grounded**: The problem is based on the principle of conservation of mass, a cornerstone of continuum mechanics. All definitions and concepts ($\\mathbf{F}$, $J$, $\\rho_0$, $\\rho$) are standard. The derivation requested is a fundamental exercise in the field. The condition $J0$ is a standard requirement for physical admissibility of a deformation and is satisfied for all test cases within the domain $\\Omega_0 = [0,1]^3$. The problem is scientifically sound.\n- **Well-Posed**: The problem requests the derivation of error metrics and the implementation of a specific, well-defined numerical algorithm to compute them for given analytical functions. All numerical parameters (domain, mesh size, quadrature rule) are precisely specified. This structure guarantees that a unique, stable, and meaningful numerical result exists.\n- **Objective**: The problem is stated using precise, objective mathematical language. The test cases are defined by explicit, closed-form functions, leaving no room for subjective interpretation.\n- **Completeness and Consistency**: The problem provides all necessary information to proceed. There are no missing data or contradictory constraints.\n- **Other Flaws**: The problem is free from triviality, pseudo-profundity, or any other listed invalidity flaw. It constitutes a standard verification problem in computational solid mechanics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Design and Solution\n\nThe solution proceeds in two stages: theoretical derivation followed by numerical implementation design.\n\n#### Derivation of Mass Conservation Error Measures\n\nThe fundamental axiom is that the mass of an arbitrary material volume $V_0 \\subset \\Omega_0$ is conserved under deformation. Let $V_t = \\boldsymbol{\\varphi}(V_0, t)$ be the same material volume in the current configuration. The mass at time $t=0$ is given by the integral of the reference density $\\rho_0(\\mathbf{X})$ over $V_0$:\n$$ M = \\int_{V_0} \\rho_0(\\mathbf{X}) \\, dV_0 $$\nThe mass at time $t$ is given by the integral of the spatial density $\\rho(\\mathbf{x}, t)$ over $V_t$:\n$$ M = \\int_{V_t} \\rho(\\mathbf{x}, t) \\, dV_t $$\nConservation of mass requires these two expressions for $M$ to be equal. To compare them within a single integral, we perform a change of variables on the second integral, mapping it back to the reference domain $V_0$. The relationship between a differential volume element in the current configuration, $dV_t$, and the reference configuration, $dV_0$, is given by $dV_t = J(\\mathbf{X},t) \\, dV_0$, where $J = \\det(\\mathbf{F})$. Substituting this and expressing the spatial density at point $\\mathbf{x}(\\mathbf{X},t)$ as $\\rho(\\mathbf{X},t)$ (as per the problem's notation) yields:\n$$ \\int_{V_0} \\rho_0(\\mathbf{X}) \\, dV_0 = \\int_{V_0} \\rho(\\mathbf{X},t) J(\\mathbf{X},t) \\, dV_0 $$\nSince this equality must hold for any arbitrary choice of material volume $V_0 \\subseteq \\Omega_0$, the integrands must be equal. This gives the local form of mass conservation in the material description:\n$$ \\rho_0(\\mathbf{X}) = \\rho(\\mathbf{X},t) J(\\mathbf{X},t) $$\nFor the remainder of this analysis, the explicit dependence on time $t$ is omitted as we are considering a static snapshot of the deformation. The equation for conservation is thus $\\rho_0(\\mathbf{X}) = \\rho(\\mathbf{X}) J(\\mathbf{X})$.\n\nAny deviation from this equality represents a violation of mass conservation. We define a local mass residual field, $R(\\mathbf{X})$, on the reference domain $\\Omega_0$:\n$$ R(\\mathbf{X}) = \\rho_0(\\mathbf{X}) - \\rho(\\mathbf{X}) J(\\mathbf{X}) $$\nA perfect conservation of mass implies $R(\\mathbf{X}) = 0$ for all $\\mathbf{X} \\in \\Omega_0$. We can now formulate the required error metrics.\n\n1.  **Global Mass Conservation Error ($E_{global}$)**: This metric quantifies the net mass imbalance over the entire body. It is defined as the absolute value of the total mass residual, normalized by the total initial mass.\n    $$ E_{global} = \\frac{\\left| \\int_{\\Omega_0} \\big(\\rho_0(\\mathbf{X}) - \\rho(\\mathbf{X}) J(\\mathbf{X})\\big) \\, dV_0 \\right|}{\\int_{\\Omega_0} \\rho_0(\\mathbf{X}) \\, dV_0} = \\frac{\\left| \\int_{\\Omega_0} R(\\mathbf{X}) \\, dV_0 \\right|}{\\int_{\\Omega_0} \\rho_0(\\mathbf{X}) \\, dV_0} $$\n    This is a dimensionless scalar representing the fractional error in the total mass.\n\n2.  **Local Mass Conservation Error Norm ($E_{local}$)**: This metric quantifies the magnitude of the local residual field across the body. A suitable measure is the $L_2$ norm of the residual field $R(\\mathbf{X})$, normalized by the $L_2$ norm of the reference density field $\\rho_0(\\mathbf{X})$.\n    $$ E_{local} = \\frac{\\sqrt{\\int_{\\Omega_0} [R(\\mathbf{X})]^2 \\, dV_0}}{\\sqrt{\\int_{\\Omega_0} [\\rho_0(\\mathbf{X})]^2 \\, dV_0}} $$\n    This provides a dimensionless root-mean-square measure of the local mass conservation error.\n\n#### Numerical Procedure\n\nThe error measures require the evaluation of integrals over the domain $\\Omega_0 = [0,1]^3$. We employ the specified numerical quadrature scheme.\n\nThe domain is partitioned into $N_e^3 = 8^3 = 512$ hexahedral elements, each of size $h \\times h \\times h$ where $h=1/8$. The integral over $\\Omega_0$ is the sum of integrals over each element $\\Omega^{(e)}$:\n$$ \\int_{\\Omega_0} f(\\mathbf{X}) \\, dV_0 = \\sum_{e=1}^{N_e^3} \\int_{\\Omega^{(e)}} f(\\mathbf{X}) \\, dV_0 $$\nEach element integral is approximated using a $2 \\times 2 \\times 2$ tensor-product Gaussian quadrature rule. The $1$-D rule on the canonical interval $[-1,1]$ uses points $\\xi_k \\in \\{-1/\\sqrt{3}, 1/\\sqrt{3}\\}$ and weights $w_k=1$.\n\nA point $\\boldsymbol{\\xi} = (\\xi_1, \\xi_2, \\xi_3)$ in the canonical element $[-1,1]^3$ is mapped to a point $\\mathbf{X}$ in a physical element $\\Omega^{(e)}$ via an affine map: $\\mathbf{X}(\\boldsymbol{\\xi}) = \\mathbf{X}_c^{(e)} + \\frac{h}{2}\\boldsymbol{\\xi}$, where $\\mathbf{X}_c^{(e)}$ is the center of the element. The differential volume for this mapping is $dV_0 = \\det(\\partial\\mathbf{X}/\\partial\\boldsymbol{\\xi}) dV_\\xi = (h/2)^3 dV_\\xi$.\n\nThe integral over a single element is thus approximated as:\n$$ \\int_{\\Omega^{(e)}} f(\\mathbf{X}) \\, dV_0 \\approx \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 f(\\mathbf{X}_{ijk}) \\, (w_i w_j w_k) \\left(\\frac{h}{2}\\right)^3 $$\nwhere $\\mathbf{X}_{ijk}$ are the quadrature points in the physical element. Since all $w_k=1$, the weight for each of the $8$ quadrature points within an element is a constant $W_{qp} = (h/2)^3 = (1/16)^3$.\n\nThe total number of quadrature points over the entire domain $\\Omega_0$ is $N_{total\\_qp} = N_e^3 \\times 2^3 = 512 \\times 8 = 4096$. The numerical approximation for an integral over $\\Omega_0$ is a sum over all these points:\n$$ \\int_{\\Omega_0} f(\\mathbf{X}) \\, dV_0 \\approx \\sum_{p=1}^{N_{total\\_qp}} f(\\mathbf{X}_p) W_{qp} $$\nwhere $\\mathbf{X}_p$ is the coordinate of the $p$-th global quadrature point.\n\nSince the quadrature weight $W_{qp}$ is constant for all points, it can be factored out of the sums in the numerators and denominators of the error metrics $E_{global}$ and $E_{local}$, and subsequently cancelled. The calculation simplifies to summing the function values at all quadrature points:\n$$ E_{global} \\approx \\frac{\\left| \\sum_p R(\\mathbf{X}_p) \\right|}{\\sum_p \\rho_0(\\mathbf{X}_p)} $$\n$$ E_{local} \\approx \\frac{\\sqrt{\\sum_p [R(\\mathbf{X}_p)]^2}}{\\sqrt{\\sum_p [\\rho_0(\\mathbf{X}_p)]^2}} $$\nThe algorithm consists of generating the coordinates of all $4096$ quadrature points, evaluating the fields $\\rho_0$, $\\mathbf{F}$, $\\rho$ at these points, computing the Jacobian $J$ and residual $R$, and finally calculating the sums to obtain the error metrics for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the continuum mechanics problem by deriving and calculating mass conservation errors.\n    \"\"\"\n\n    # Define the four test cases with their respective field functions.\n    test_cases = [\n        # Case A: Kinematically compatible density. Expected error is zero.\n        {\n            \"name\": \"A\",\n            \"F_func\": lambda X, Y, Z: (\n                1 + 0.2 * X,\n                1 + 0.1 * Y,\n                1 - 0.05 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z),\n            \"rho_func\": lambda X, Y, Z, J: (1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z)) / J\n        },\n        # Case B: Small local perturbation to spatial density.\n        {\n            \"name\": \"B\",\n            \"F_func\": lambda X, Y, Z: (\n                1 + 0.2 * X,\n                1 + 0.1 * Y,\n                1 - 0.05 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z),\n            \"rho_func\": lambda X, Y, Z, J: (\n                (1000 + 100 * np.sin(np.pi * X) * np.cos(np.pi * Y) * np.exp(-Z)) / J *\n                (1 + 1e-3 * np.sin(2*np.pi * X) * np.sin(2*np.pi * Y) * np.sin(2*np.pi * Z))\n            )\n        },\n        # Case C: Uniform dilation with global bias. Expected error is 0.05.\n        {\n            \"name\": \"C\",\n            \"F_func\": lambda X, Y, Z: (1.5, 1.5, 1.5),\n            \"rho0_func\": lambda X, Y, Z: 7800.0,\n            \"rho_func\": lambda X, Y, Z, J: (7800.0 / J) * 1.05\n        },\n        # Case D: Strongly varying stretch with localized defect.\n        {\n            \"name\": \"D\",\n            \"F_func\": lambda X, Y, Z: (\n                1.0,\n                1.0,\n                0.2 + 0.1 * Z\n            ),\n            \"rho0_func\": lambda X, Y, Z: 900 + 100 * np.cos(2*np.pi*X)*np.cos(2*np.pi*Y)*np.cos(2*np.pi*Z),\n            \"rho_func\": lambda X, Y, Z, J: (\n                (900 + 100 * np.cos(2*np.pi*X)*np.cos(2*np.pi*Y)*np.cos(2*np.pi*Z)) / J +\n                10 * np.exp(-((X-0.5)**2 + (Y-0.5)**2 + (Z-0.5)**2) / 0.02)\n            )\n        }\n    ]\n\n    # Numerical parameters\n    Ne = 8  # Number of elements per dimension\n    h = 1.0 / Ne  # Element size\n\n    # Generate 1D quadrature points in the canonical element [-1, 1]\n    canon_pts_1d = np.array([-1.0, 1.0]) / np.sqrt(3.0)\n\n    # Map canonical points to physical coordinates for all elements\n    cell_centers_1d = (np.arange(Ne) + 0.5) * h\n    # Offsets from cell centers to quadrature points\n    offsets = (h / 2.0) * canon_pts_1d\n    # Generate all 1D quadrature point coordinates\n    phys_pts_1d = (cell_centers_1d[:, None] + offsets[None, :]).flatten()\n\n    # Create a 3D grid of all quadrature points in the domain [0,1]^3\n    X_qp, Y_qp, Z_qp = np.meshgrid(phys_pts_1d, phys_pts_1d, phys_pts_1d, indexing='ij')\n\n    results = []\n\n    for case in test_cases:\n        # Evaluate reference density at all quadrature points\n        rho0_vals = case[\"rho0_func\"](X_qp, Y_qp, Z_qp)\n\n        # Evaluate deformation gradient components and Jacobian\n        F_diag = case[\"F_func\"](X_qp, Y_qp, Z_qp)\n        # For diagonal F, J is the product of diagonal entries.\n        if isinstance(F_diag, tuple):\n             J_vals = F_diag[0] * F_diag[1] * F_diag[2]\n        else: # For Case C with constant F\n             J_vals = F_diag**3\n        \n        # Evaluate spatial density\n        rho_vals = case[\"rho_func\"](X_qp, Y_qp, Z_qp, J_vals)\n\n        # Calculate the local mass residual field\n        R_vals = rho0_vals - rho_vals * J_vals\n\n        # The constant quadrature weight (h/2)^3 cancels in the ratios,\n        # so we can use sums directly.\n\n        # Calculate global error\n        # Sum of residuals (proportional to net mass change)\n        numerator_global = np.sum(R_vals)\n        # Sum of reference densities (proportional to total reference mass)\n        denominator_global = np.sum(rho0_vals)\n        E_global = np.abs(numerator_global) / denominator_global if denominator_global != 0 else 0.0\n\n        # Calculate local error norm\n        # Sum of squared residuals (proportional to L2 norm squared of R)\n        numerator_local_sq = np.sum(R_vals**2)\n        # Sum of squared reference densities (proportional to L2 norm squared of rho0)\n        denominator_local_sq = np.sum(rho0_vals**2)\n        \n        E_local = (np.sqrt(numerator_local_sq) / np.sqrt(denominator_local_sq) \n                   if denominator_local_sq > 0 else 0.0)\n\n        results.extend([E_global, E_local])\n\n    # Format the final output string\n    output_str = f\"[{','.join(f'{x:.8f}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2623914"}]}