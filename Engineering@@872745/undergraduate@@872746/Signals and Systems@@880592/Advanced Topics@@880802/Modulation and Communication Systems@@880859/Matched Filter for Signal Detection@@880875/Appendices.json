{"hands_on_practices": [{"introduction": "Understanding the output of a matched filter is the first step toward appreciating its function. This exercise provides a foundational experience by having you calculate the output waveform when a simple, yet ubiquitous, rectangular pulse is passed through its own matched filter. By performing this convolution, you will see directly that the output is the signal's autocorrelation function, which reaches its peak at the precise moment optimal for signal detection [@problem_id:1736683].", "problem": "In a simplified baseband digital communication system, a rectangular pulse is used to represent a binary '1'. The pulse, denoted by $s(t)$, has a duration of $T$ and a unit amplitude. It is defined as:\n$$s(t) = u(t) - u(t-T)$$\nwhere $u(t)$ is the Heaviside unit step function, defined as $u(t) = 1$ for $t \\ge 0$ and $u(t) = 0$ for $t  0$.\n\nTo maximize the signal-to-noise ratio at the receiver at a specific time, a matched filter is employed. The impulse response of a filter matched to a signal $g(t)$ is generally given by $h(t) = g(T_d - t)$, where $T_d$ is a design parameter representing a time delay. For this system, the filter is made causal by choosing the delay to be equal to the pulse duration, so its impulse response is $h(t) = s(T - t)$.\n\nAssume the transmitted pulse $s(t)$ is the input to this matched filter. Determine the complete mathematical expression for the output waveform $y(t)$ as a function of time $t$ and the parameter $T$. Your answer should be expressed in terms of the unit ramp function, defined as $r(t) = t u(t)$.", "solution": "The matched filter output is the convolution of the input pulse with the impulse response:\n$$\ny(t) = (s * h)(t), \\quad \\text{with} \\quad s(t) = u(t) - u(t - T), \\quad h(t) = s(T - t).\n$$\nSince $s(t)$ is a unit-amplitude rectangular pulse of width $T$, $h(t)$ is also a rectangular pulse of width $T$ (time-reversed and shifted to ensure causality). For convolution with piecewise-continuous signals, point values at isolated times do not affect the result; thus we may equivalently use the causal representation\n$$\nh(t) \\equiv u(t) - u(t - T)\n$$\nfor computing the convolution. Therefore,\n$$\ny(t) = \\big(u - u(\\cdot - T)\\big) * \\big(u - u(\\cdot - T)\\big).\n$$\nBy linearity of convolution,\n$$\ny(t) = u * u \\;-\\; u * u(t - T) \\;-\\; u(t - T) * u \\;+\\; u(t - T) * u(t - T).\n$$\nUsing the standard result $u * u = r(t)$ with $r(t) = t\\,u(t)$ and the shift property of convolution,\n$$\nu * u(t - T) = r(t - T), \\quad u(t - T) * u = r(t - T), \\quad u(t - T) * u(t - T) = r(t - 2T).\n$$\nSubstituting these into the expression for $y(t)$ yields\n$$\ny(t) = r(t) - 2\\,r(t - T) + r(t - 2T),\n$$\nwhich is a triangular waveform of base $2T$ and peak value $T$ at $t = T$, as expected for the matched filter output (equal to the autocorrelation of $s(t)$ evaluated at lag $t - T$).", "answer": "$$\\boxed{r(t) - 2\\,r(t - T) + r(t - 2T)}$$", "id": "1736683"}, {"introduction": "While matched filters are optimally designed for detecting signals in additive white Gaussian noise, real-world systems often face other impairments. This practice explores a common non-ideal scenario where a constant DC offset corrupts the received signal. By analyzing how this offset affects the output signal-to-noise ratio (SNR), you will gain a deeper understanding of the filter's sensitivity to structured interference and the importance of considering the complete signal environment in receiver design [@problem_id:1736640].", "problem": "In a digital communication system, a binary data stream is transmitted using a simple rectangular pulse shaping scheme. The system is designed to be zero-mean in the long run, with transmissions of a signal pulse $s(t)$ and its inverse $-s(t)$ being equally likely. For our analysis, we focus on the detection of a single pulse $s(t)$ defined as:\n$$\ns(t) = \\begin{cases} A  \\text{if } 0 \\le t \\le T \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nwhere $A$ and $T$ are positive constants.\n\nThe receiver employs a filter matched to this signal $s(t)$ to maximize the detectability of the pulse in the presence of Additive White Gaussian Noise (AWGN), which has a constant two-sided power spectral density of $N_0/2$. The output of the matched filter is sampled at the optimal time to achieve the highest Signal-to-Noise Ratio (SNR).\n\nIn an ideal scenario, the received signal is $r_{ideal}(t) = s(t) + n(t)$, where $n(t)$ is the AWGN. The performance is measured by the output SNR, denoted $SNR_{ideal}$, which is defined as the squared value of the signal component at the filter's output at the sampling instant, divided by the average power (variance) of the noise component at the output.\n\nNow, consider a non-ideal, degraded scenario where a small, unknown, but constant DC offset $C$ contaminates the signal due to an imperfection in the receiver's analog front-end. The received signal is now $r_{degraded}(t) = s(t) + C + n(t)$. The same matched filter is used. In this case, the DC offset acts as a form of interference. The degraded performance is measured by $SNR_{degraded}$, where the \"signal\" power at the output is still due to $s(t)$ alone, but the \"total noise\" power at the output is the sum of the power due to the AWGN and the power due to the DC offset $C$.\n\nCalculate the ratio $\\frac{SNR_{degraded}}{SNR_{ideal}}$ to quantify the performance degradation. Express your answer as a closed-form analytic expression in terms of $C$, $T$, and $N_0$.", "solution": "Let $s(t)$ be real-valued and time-limited to $[0,T]$. Define its energy and area by\n$$\nE_{s} \\equiv \\int_{-\\infty}^{\\infty} s^{2}(t)\\,dt, \n\\qquad\nS_{1} \\equiv \\int_{-\\infty}^{\\infty} s(t)\\,dt.\n$$\nFor the given rectangular pulse $s(t)=A$ on $[0,T]$ and zero otherwise,\n$$\nE_{s}=\\int_{0}^{T} A^{2}\\,dt = A^{2}T,\n\\qquad\nS_{1}=\\int_{0}^{T} A\\,dt = AT.\n$$\n\nWith a matched filter $h(t)=s(T-t)$, the sample at $t=T$ is the correlation $y(T)=\\int_{-\\infty}^{\\infty} s(u)\\,r(u)\\,du$.\n\nIdeal case $r_{\\text{ideal}}(t)=s(t)+n(t)$:\n- Signal component at the output sample is\n$$\ny_{s}(T)=\\int s(u)\\,s(u)\\,du=E_{s}.\n$$\n- Noise component is $y_{n}(T)=\\int s(u)\\,n(u)\\,du$, which is zero-mean Gaussian with variance\n$$\n\\operatorname{Var}\\{y_{n}(T)\\}=\\frac{N_{0}}{2}\\int s^{2}(u)\\,du=\\frac{N_{0}}{2}E_{s}.\n$$\nTherefore,\n$$\nSNR_{\\text{ideal}}=\\frac{\\left(y_{s}(T)\\right)^{2}}{\\operatorname{Var}\\{y_{n}(T)\\}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}=\\frac{2E_{s}}{N_{0}}.\n$$\n\nDegraded case $r_{\\text{degraded}}(t)=s(t)+C+n(t)$:\n- Output sample decomposes as\n$$\ny(T)=\\int s(u)\\,s(u)\\,du+\\int s(u)\\,C\\,du+\\int s(u)\\,n(u)\\,du\n=E_{s}+C\\,S_{1}+y_{n}(T).\n$$\n- The signal component remains $E_{s}$. The interference from the DC offset is the deterministic term $C\\,S_{1}$, whose power contribution at the sample is $(C\\,S_{1})^{2}$. The AWGN contribution has variance $\\left(\\frac{N_{0}}{2}\\right)E_{s}$. Hence the total noise-plus-interference power at the output sample is\n$$\n\\left(\\frac{N_{0}}{2}\\right)E_{s}+(C\\,S_{1})^{2}.\n$$\nThus,\n$$\nSNR_{\\text{degraded}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}.\n$$\n\nThe degradation ratio is\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}}{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}}\n=\\frac{\\left(\\frac{N_{0}}{2}\\right)E_{s}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}}.\n$$\nFor the rectangular pulse, $E_{s}=A^{2}T$ and $S_{1}=AT$, so\n$$\n\\frac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}=\\frac{2\\,C^{2}\\,A^{2}T^{2}}{N_{0}\\,A^{2}T}=\\frac{2\\,C^{2}T}{N_{0}},\n$$\nwhich yields\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}T}{N_{0}}}\n=\\frac{N_{0}}{N_{0}+2\\,C^{2}T}.\n$$\nThis expression depends only on $C$, $T$, and $N_{0}$, as required.", "answer": "$$\\boxed{\\frac{N_{0}}{N_{0}+2C^{2}T}}$$", "id": "1736640"}, {"introduction": "Moving beyond simple detection in white noise, this advanced problem challenges you to design a filter that performs a dual role: detecting a desired signal while simultaneously rejecting a known interfering signal. This requires extending the matched filter concept to a constrained optimization problem within the framework of signal spaces. Solving this problem will illustrate how the principles of orthogonality can be used to create sophisticated filters that are robust to specific types of interference, a crucial technique in modern communication and radar systems [@problem_id:1736682].", "problem": "A linear time-invariant filter with impulse response $h(t)$ is to be designed for a signal detection application. The filter's input is a received signal $r(t)$ which is a superposition of a desired signal component $s_1(t)$, an interfering signal component $s_2(t)$, and Additive White Gaussian Noise (AWGN) $n(t)$. The noise $n(t)$ has a constant, two-sided power spectral density of $N_0/2$. The desired and interfering signals are causal and defined over the time interval $[0, T]$ as follows:\n$$ s_1(t) = \\begin{cases} A,  0 \\le t \\le T \\\\ 0,  \\text{otherwise} \\end{cases} $$\n$$ s_2(t) = \\begin{cases} B \\frac{t}{T},  0 \\le t \\le T \\\\ 0,  \\text{otherwise} \\end{cases} $$\nHere, $A$ and $B$ are real, non-zero constants representing the amplitudes of the signals.\n\nThe filter is designed to satisfy two criteria at the specific sampling instant $t=T$:\n1. The component of the filter's output resulting from the interfering signal $s_2(t)$ must be exactly zero.\n2. The output signal-to-noise ratio (SNR), defined as the squared magnitude of the output component from the desired signal $s_1(t)$ divided by the variance of the output noise component, must be maximized.\n\nDetermine the maximum possible output SNR that can be achieved under these two constraints. Express your answer as a closed-form analytic expression in terms of the parameters $A$, $B$, $T$, and $N_0$.", "solution": "Let the filter output at time $T$ be $y(T) = \\int_{-\\infty}^{\\infty} h(\\tau) r(T-\\tau) \\, d\\tau$. Decompose $r(t) = s_{1}(t) + s_{2}(t) + n(t)$ into desired, interference, and noise terms. Accordingly, at $t=T$,\n$$\ny(T) = y_{1}(T) + y_{2}(T) + y_{n}(T),\n$$\nwith\n$$\ny_{1}(T) = \\int h(\\tau) s_{1}(T-\\tau) \\, d\\tau, \\quad y_{2}(T) = \\int h(\\tau) s_{2}(T-\\tau) \\, d\\tau, \\quad y_{n}(T) = \\int h(\\tau) n(T-\\tau) \\, d\\tau.\n$$\nDefine the inner product $\\langle f,g\\rangle \\triangleq \\int_{-\\infty}^{\\infty} f(\\tau) g^{*}(\\tau) \\, d\\tau$ and the norm $\\|f\\|^{2} \\triangleq \\langle f,f\\rangle$. Let $a(\\tau) \\triangleq s_{1}(T-\\tau)$ and $b(\\tau) \\triangleq s_{2}(T-\\tau)$. Then $y_{1}(T) = \\langle h,a\\rangle$, $y_{2}(T) = \\langle h,b\\rangle$. The interference-nulling constraint is\n$$\n\\langle h,b\\rangle = 0.\n$$\nFor AWGN with two-sided PSD $N_{0}/2$, the output noise variance at time $T$ is\n$$\n\\sigma_{n}^{2} = \\frac{N_{0}}{2} \\int |h(\\tau)|^{2} \\, d\\tau = \\frac{N_{0}}{2} \\|h\\|^{2}.\n$$\nHence the output SNR is\n$$\n\\mathrm{SNR}(h) = \\frac{|\\langle h,a\\rangle|^{2}}{\\sigma_{n}^{2}} = \\frac{2}{N_{0}} \\frac{|\\langle h,a\\rangle|^{2}}{\\|h\\|^{2}},\n$$\nto be maximized subject to $\\langle h,b\\rangle=0$. Decompose $a$ into components parallel and orthogonal to $b$:\n$$\na = a_{\\parallel} + a_{\\perp}, \\quad a_{\\parallel} = \\frac{\\langle a,b\\rangle}{\\|b\\|^{2}} b, \\quad \\langle a_{\\perp}, b\\rangle = 0.\n$$\nFor any $h$ with $\\langle h,b\\rangle=0$, we have $\\langle h,a\\rangle = \\langle h,a_{\\perp}\\rangle$, and by Cauchy-Schwarz,\n$$\n\\frac{|\\langle h,a\\rangle|^{2}}{\\|h\\|^{2}} = \\frac{|\\langle h,a_{\\perp}\\rangle|^{2}}{\\|h\\|^{2}} \\le \\|a_{\\perp}\\|^{2},\n$$\nwith equality when $h$ is proportional to $a_{\\perp}$. Therefore,\n$$\n\\mathrm{SNR}_{\\max} = \\frac{2}{N_{0}} \\|a_{\\perp}\\|^{2} = \\frac{2}{N_{0}} \\left( \\|a\\|^{2} - \\frac{|\\langle a,b\\rangle|^{2}}{\\|b\\|^{2}} \\right).\n$$\nNow compute $a$ and $b$. Since $s_{1}(t)=A$ and $s_{2}(t)=B t/T$ for $t\\in[0,T]$ and zero otherwise,\n$$\na(\\tau) = s_{1}(T-\\tau) = \\begin{cases} A,  \\tau \\in [0,T] \\\\ 0,  \\text{otherwise} \\end{cases}, \\quad\nb(\\tau) = s_{2}(T-\\tau) = \\begin{cases} B \\frac{T-\\tau}{T},  \\tau \\in [0,T] \\\\ 0,  \\text{otherwise} \\end{cases}.\n$$\nThus,\n$$\n\\|a\\|^{2} = \\int_{0}^{T} A^{2} \\, d\\tau = A^{2} T,\n$$\n$$\n\\langle a,b\\rangle = \\int_{0}^{T} A \\cdot B \\frac{T-\\tau}{T} \\, d\\tau = \\frac{AB}{T} \\int_{0}^{T} (T-\\tau) \\, d\\tau = \\frac{ABT}{2},\n$$\n$$\n\\|b\\|^{2} = \\int_{0}^{T} \\left(B \\frac{T-\\tau}{T}\\right)^{2} d\\tau = \\frac{B^{2}}{T^{2}} \\int_{0}^{T} (T-\\tau)^{2} \\, d\\tau = \\frac{B^{2} T}{3}.\n$$\nTherefore,\n$$\n\\|a_{\\perp}\\|^{2} = \\|a\\|^{2} - \\frac{|\\langle a,b\\rangle|^{2}}{\\|b\\|^{2}} = A^{2} T - \\frac{(ABT/2)^{2}}{B^{2} T/3} = A^{2} T - \\frac{3 A^{2} T}{4} = \\frac{A^{2} T}{4}.\n$$\nSubstituting into the SNR expression,\n$$\n\\mathrm{SNR}_{\\max} = \\frac{2}{N_{0}} \\cdot \\frac{A^{2} T}{4} = \\frac{A^{2} T}{2 N_{0}}.\n$$\nThis value is independent of $B$, as the linear constraint depends only on the direction of $s_{2}$ in the signal space.", "answer": "$$\\boxed{\\frac{A^{2} T}{2 N_{0}}}$$", "id": "1736682"}]}