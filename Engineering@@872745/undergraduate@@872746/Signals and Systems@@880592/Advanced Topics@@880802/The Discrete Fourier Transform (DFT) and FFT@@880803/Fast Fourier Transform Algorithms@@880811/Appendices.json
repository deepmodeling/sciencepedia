{"hands_on_practices": [{"introduction": "The Fast Fourier Transform (FFT) achieves its remarkable speed through a \"divide and conquer\" strategy, breaking down a large DFT calculation into many smaller, manageable ones. The radix-2 decimation-in-time algorithm, a popular FFT implementation, requires an initial but crucial data-shuffling step known as bit-reversal. This practice provides a concrete exercise in performing this re-ordering, a fundamental step in understanding how the FFT organizes data for efficient computation [@problem_id:1717784].", "problem": "An embedded systems engineer is tasked with implementing a real-time audio spectrum analyzer on a microcontroller with limited memory. To achieve this, the engineer decides to use the radix-2 Decimation-In-Time (DIT) Fast Fourier Transform (FFT) algorithm. The first crucial step of this algorithm involves re-ordering the input time-domain samples before the main butterfly computations begin. This re-ordering is accomplished by placing the sample from index $n$ of the original sequence, $x[n]$, into a new position, index $k$, in the scrambled sequence. The new index $k$ is found by reversing the binary representation of the original index $n$.\n\nConsider a discrete-time signal that has been sampled to produce an $N=8$ point sequence, denoted as $x[n]$ for $n=0, 1, 2, ..., 7$. According to the DIT-FFT's bit-reversal procedure, the sample $x[6]$ will be moved to a new index in the re-ordered input buffer. What is the numerical value of this new index?", "solution": "In a radix-2 DIT-FFT with sequence length $N=2^{m}$, the bit-reversal re-ordering maps an index $n$ to $k$ by reversing the $m$-bit binary representation of $n$. Formally, if $n=\\sum_{i=0}^{m-1} b_{i} 2^{i}$ with $b_{i}\\in\\{0,1\\}$, then the bit-reversed index is\n$$\nk=\\sum_{i=0}^{m-1} b_{i} 2^{m-1-i}.\n$$\nFor $N=8$, we have $m=\\log_{2}(8)=3$. The index $n=6$ has the 3-bit binary representation\n$$\n6=1\\cdot 2^{2}+1\\cdot 2^{1}+0\\cdot 2^{0}\\;\\Rightarrow\\;(110)_{2},\n$$\nso $b_{2}=1$, $b_{1}=1$, $b_{0}=0$. Reversing these three bits gives $(011)_{2}$, which in decimal is\n$$\nk=0\\cdot 2^{2}+1\\cdot 2^{1}+1\\cdot 2^{0}=3.\n$$\nTherefore, under the DIT-FFT bit-reversal re-ordering for $N=8$, the sample $x[6]$ is moved to index $k=3$.", "answer": "$$\\boxed{3}$$", "id": "1717784"}, {"introduction": "In an ideal world, the frequencies of a signal would align perfectly with the discrete frequency bins of an FFT. In practice, however, analyzing a finite segment of data almost always results in a mismatch, causing the signal's energy to \"leak\" into adjacent frequency bins. This exercise delves into this critical phenomenon of spectral leakage, allowing you to quantitatively analyze how the energy of a pure sinusoid is distributed when its frequency falls between two FFT bins [@problem_id:1717762].", "problem": "An engineer is analyzing a vibration signal from a large industrial motor. For this analysis, the signal is modeled as a pure sinusoid, $x(t) = \\cos(2\\pi f_c t)$, where the effects of amplitude and phase are ignored as they do not influence the final required ratio. The signal is sampled by an Analog-to-Digital Converter (ADC) at a sampling rate of $f_s = 8000 \\text{ Hz}$. A total of $N = 1024$ samples are collected and then processed using a Fast Fourier Transform (FFT) algorithm, which computes the Discrete Fourier Transform (DFT).\n\nThe true rotational frequency of the motor results in a vibration signal with a frequency of $f_c = 150.0 \\text{ Hz}$. Due to the finite sampling duration, this frequency does not coincide exactly with any of the frequency bins of the 1024-point FFT. As a result, the signal's energy appears spread across multiple frequency bins, a phenomenon known as spectral leakage.\n\nLet $X[k]$ be the complex-valued coefficient of the $k$-th frequency bin of the FFT, where $k$ is an integer from $0$ to $N-1$. Calculate the ratio of the magnitude of the FFT coefficient in the adjacent bin above the true frequency to the magnitude of the FFT coefficient in the adjacent bin below the true frequency. Specifically, determine the value of the ratio $|X[k_{above}]| / |X[k_{below}]|$ where $k_{below}$ and $k_{above}$ are the integer bin indices immediately below and above the true signal frequency $f_c$, respectively.\n\nExpress your answer as a single real number rounded to three significant figures.", "solution": "We sample the continuous-time sinusoid $x(t)=\\cos(2\\pi f_{c}t)$ to obtain the discrete-time sequence $x[n]=\\cos\\!\\left(2\\pi \\frac{f_{c}}{f_{s}}n\\right)$ for $n=0,\\ldots,N-1$. The $N$-point DFT is defined by\n$$\nX[k]=\\sum_{n=0}^{N-1}x[n]\\exp\\!\\left(-j\\frac{2\\pi kn}{N}\\right).\n$$\nUsing $x[n]=\\frac{1}{2}\\left(\\exp\\!\\left(j2\\pi \\frac{f_{c}}{f_{s}}n\\right)+\\exp\\!\\left(-j2\\pi \\frac{f_{c}}{f_{s}}n\\right)\\right)$ and linearity,\n$$\nX[k]=\\frac{1}{2}X_{+}[k]+\\frac{1}{2}X_{-}[k],\n$$\nwhere\n$$\nX_{+}[k]=\\sum_{n=0}^{N-1}\\exp\\!\\left(j2\\pi n\\left(\\frac{f_{c}}{f_{s}}-\\frac{k}{N}\\right)\\right),\\qquad\nX_{-}[k]=\\sum_{n=0}^{N-1}\\exp\\!\\left(-j2\\pi n\\left(\\frac{f_{c}}{f_{s}}+\\frac{k}{N}\\right)\\right).\n$$\nEach is a finite geometric series. Let $\\Delta=\\frac{f_{c}}{f_{s}}-\\frac{k}{N}$. Then\n$$\nX_{+}[k]=\\exp\\!\\left(j\\pi (N-1)\\Delta\\right)\\frac{\\sin(\\pi N\\Delta)}{\\sin(\\pi \\Delta)},\n$$\nso\n$$\n|X_{+}[k]|=\\frac{|\\sin(\\pi N\\Delta)|}{|\\sin(\\pi \\Delta)|}.\n$$\nDefine the bin location of the tone as $r=\\frac{Nf_{c}}{f_{s}}$ and the fractional offset $\\alpha=r-\\lfloor r\\rfloor\\in(0,1)$. The adjacent bins around $f_{c}$ are $k_{below}=\\lfloor r\\rfloor$ and $k_{above}=\\lfloor r\\rfloor+1$. Then\n$$\n\\Delta_{below}=\\frac{f_{c}}{f_{s}}-\\frac{k_{below}}{N}=\\frac{r}{N}-\\frac{\\lfloor r\\rfloor}{N}=\\frac{\\alpha}{N},\\qquad\n\\Delta_{above}=\\frac{f_{c}}{f_{s}}-\\frac{k_{above}}{N}=\\frac{\\alpha-1}{N}=-\\frac{1-\\alpha}{N}.\n$$\nThus, for the complex exponential component near $+f_{c}$,\n$$\n|X_{+}[k_{below}]|=\\frac{|\\sin(\\pi \\alpha)|}{|\\sin(\\pi \\alpha/N)|},\\qquad\n|X_{+}[k_{above}]|=\\frac{|\\sin(\\pi (1-\\alpha))|}{|\\sin(\\pi (1-\\alpha)/N)|}.\n$$\nUsing $|\\sin(\\pi \\alpha)|=|\\sin(\\pi (1-\\alpha))|$, the ratio governed by the main lobe is\n$$\nR\\equiv\\frac{|X[k_{above}]|}{|X[k_{below}]|}\\approx\\frac{|X_{+}[k_{above}]|}{|X_{+}[k_{below}]|}=\\frac{\\sin(\\pi \\alpha/N)}{\\sin(\\pi (1-\\alpha)/N)}.\n$$\nNow substitute the given parameters to find $\\alpha$. With $f_{s}=8000$, $N=1024$, and $f_{c}=150$,\n$$\nr=\\frac{Nf_{c}}{f_{s}}=\\frac{1024\\cdot 150}{8000}=19.2,\\qquad \\alpha=0.2.\n$$\nHence\n$$\nR=\\frac{\\sin\\!\\left(\\pi\\cdot \\frac{0.2}{1024}\\right)}{\\sin\\!\\left(\\pi\\cdot \\frac{0.8}{1024}\\right)}.\n$$\nBecause the arguments are small, using $\\sin(x)\\approx x$ gives\n$$\nR\\approx\\frac{\\pi\\cdot 0.2/1024}{\\pi\\cdot 0.8/1024}=\\frac{0.2}{0.8}=\\frac{1}{4}=0.25.\n$$\nRounded to three significant figures, the ratio is $0.250$.", "answer": "$$\\boxed{0.250}$$", "id": "1717762"}, {"introduction": "A common technique in digital signal processing is to append zeros to a time-domain signal before performing an FFT, a process known as zero-padding. While this produces a smoother, more detailed-looking spectrum, it's essential to understand what is actually happening. This practice challenges the common misconception that zero-padding improves spectral resolution, helping you distinguish between the interpolation of a spectrum and a true enhancement in the ability to resolve closely spaced frequency components [@problem_id:2391651].", "problem": "A real-valued, finite-duration discrete-time signal $x[n]$ is obtained by sampling a continuous-time process at sampling frequency $f_{s}$ with sampling interval $\\Delta t = 1/f_{s}$. The available data are $x[n]$ for $n = 0,1,\\dots,N-1$, corresponding to a rectangular time aperture of duration $T = N \\Delta t$. Define the zero-padded sequence $x_{L}[n]$ of length $L$ by $x_{L}[n] = x[n]$ for $0 \\le n \\le N-1$ and $x_{L}[n] = 0$ for $N \\le n \\le L-1$, where $L \\ge N$ is an integer. The length-$L$ discrete Fourier transform (DFT) of $x_{L}[n]$ is\n$$\nX_{L}[k] = \\sum_{n=0}^{L-1} x_{L}[n]\\, e^{-j 2 \\pi kn/L}, \\quad k = 0,1,\\dots,L-1,\n$$\ncomputed numerically using a fast Fourier transform (FFT) algorithm. Consider the periodogram (power spectrum) defined as $P_{L}[k] = \\left|X_{L}[k]\\right|^{2}$, and the discrete-time Fourier transform (DTFT) of the unpadded finite sequence $x[n]$,\n$$\nX\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n}, \\quad \\omega \\in \\mathbb{R}.\n$$\n\nSelect all statements that are correct about the effect of zero-padding on the power spectrum and its frequency sampling:\n\nA. If $M = L/N$ is an integer, zero-padding by the factor $M$ reduces the DFT bin spacing in hertz from $f_{s}/N$ to $f_{s}/L$ (a factor of $M$ finer), but it does not change the width in hertz of the mainlobe of the spectral leakage pattern produced by the rectangular time aperture of duration $T$.\n\nB. For two equal-amplitude sinusoids within the data window, zero-padding to sufficiently large $L$ enables resolving two tones whose frequency separation is less than $1/T$ in the periodogram, even though the time aperture remains $T$.\n\nC. For any $L \\ge N$, the length-$L$ DFT of the zero-padded data satisfies $X_{L}[k] = X\\!\\left(e^{j \\omega_{k}}\\right)$ with $\\omega_{k} = 2\\pi k/L$, that is, zero-padding causes the DFT to evaluate uniformly spaced samples of the DTFT of the finite sequence.\n\nD. Using the conventional DFT normalization in which Parseval’s theorem holds as $\\sum_{n=0}^{L-1} |x_{L}[n]|^{2} = \\frac{1}{L}\\sum_{k=0}^{L-1} |X_{L}[k]|^{2}$, the total power inferred from the spectrum, interpreted as a Riemann sum $\\left(\\frac{f_{s}}{L}\\right)\\sum_{k} P_{L}[k]$, is invariant under zero-padding.\n\nE. As $L$ increases with $N$ fixed, zero-padding reduces spectral leakage due to the rectangular window, lowering sidelobe levels in $P_{L}[k]$ even though the time-domain data are unchanged.", "solution": "We proceed from definitions of the discrete Fourier transform (DFT), the discrete-time Fourier transform (DTFT), and properties of time-limited sequences.\n\nFirst, observe that $x[n]$ is nonzero only for $0 \\le n \\le N-1$ and equals zero elsewhere. The zero-padded sequence $x_{L}[n]$ of length $L$ agrees with $x[n]$ on $0 \\le n \\le N-1$ and is zero for $N \\le n \\le L-1$.\n\nRelation between zero-padded DFT and DTFT (interpolation property):\nBy definition,\n$$\nX_{L}[k] = \\sum_{n=0}^{L-1} x_{L}[n]\\, e^{-j 2 \\pi k n/L}.\n$$\nBecause $x_{L}[n] = 0$ for $n \\ge N$, this reduces to\n$$\nX_{L}[k] = \\sum_{n=0}^{N-1} x[n]\\, e^{-j 2 \\pi k n/L}.\n$$\nOn the other hand, the DTFT of the finite sequence $x[n]$ is\n$$\nX\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j \\omega n}.\n$$\nEvaluating the DTFT at the angular frequencies $\\omega_{k} = 2\\pi k/L$ gives\n$$\nX\\!\\left(e^{j \\omega_{k}}\\right) = \\sum_{n=0}^{N-1} x[n]\\, e^{-j (2\\pi k/L) n} = X_{L}[k].\n$$\nThus, for any $L \\ge N$, the length-$L$ DFT of the zero-padded data equals uniformly spaced samples of the DTFT of the finite signal. This demonstrates that zero-padding provides an interpolation of the underlying continuous spectrum $X\\!\\left(e^{j\\omega}\\right)$ at a denser frequency grid.\n\nEffect on frequency grid and spectral resolution:\nThe $k$th DFT bin of length $L$ corresponds to physical frequency\n$$\nf_{k} = \\frac{k}{L} f_{s}, \\quad k = 0,1,\\dots,L-1,\n$$\nso the bin spacing in hertz is\n$$\n\\Delta f_{L} = \\frac{f_{s}}{L}.\n$$\nIf $L = M N$ with integer $M \\ge 1$, then zero-padding by a factor $M$ changes the bin spacing from $\\Delta f_{N} = f_{s}/N$ to $\\Delta f_{L} = f_{s}/(M N)$, which is finer by a factor of $M$. However, the intrinsic spectral resolution is governed by the time aperture $T = N \\Delta t$, because the observed data are the original signal multiplied by a rectangular window $w[n]$ of length $N$. In the frequency domain, multiplication by $w[n]$ corresponds to convolution with the transform of $w[n]$, whose magnitude envelope is the discrete-time counterpart of a sinc-shaped mainlobe with width proportional to $1/T$ and sidelobes whose levels are determined by the window shape. Zero-padding does not change $w[n]$ or $T$, and hence does not narrow the mainlobe or reduce sidelobe levels. It only produces a denser sampling of the same leakage pattern, i.e., an interpolation in frequency.\n\nEnergy and power under Parseval:\nWith the DFT convention given, Parseval’s theorem states\n$$\n\\sum_{n=0}^{L-1} |x_{L}[n]|^{2} = \\frac{1}{L}\\sum_{k=0}^{L-1} |X_{L}[k]|^{2}.\n$$\nBecause $x_{L}[n]$ is $x[n]$ followed by zeros, $\\sum_{n=0}^{L-1} |x_{L}[n]|^{2} = \\sum_{n=0}^{N-1} |x[n]|^{2}$ is invariant with respect to $L$. Interpreting the spectral sum as a Riemann sum approximating an integral over frequency,\n$$\n\\int_{0}^{f_{s}} |X(f)|^{2}\\, df \\;\\approx\\; \\sum_{k=0}^{L-1} \\left|X_{L}[k]\\right|^{2}\\, \\Delta f_{L} \\;=\\; \\sum_{k=0}^{L-1} \\left|X_{L}[k]\\right|^{2}\\, \\frac{f_{s}}{L},\n$$\nwe see that the factor $\\frac{1}{L}$ in Parseval precisely compensates the refinement of the frequency grid $\\Delta f_{L} = f_{s}/L$. Therefore, the total spectral power inferred from the periodogram remains invariant under zero-padding.\n\nConsequences for resolving close sinusoids:\nConsider two equal-amplitude sinusoids observed through the same rectangular window of duration $T$. Their spectra are the sum of two shifted leakage patterns (mainlobes plus sidelobes) determined solely by $T$ and the window shape. If their frequency separation is smaller than the mainlobe width (on the order of $1/T$ for a rectangular window), the two peaks merge and cannot be resolved by linear spectral analysis of the fixed windowed data. Zero-padding cannot change this, because it does not alter $T$; it only samples the same merged curve more densely. Hence, it cannot create resolvability where the aperture does not support it.\n\nOption-by-option analysis:\n\nA. The bin spacing in hertz is $\\Delta f_{L} = f_{s}/L$, so zero-padding by $M$ refines the spacing by a factor of $M$. The mainlobe width and sidelobe structure come from the Fourier transform of the rectangular window of duration $T = N \\Delta t$ and are independent of $L$. Thus, the mainlobe width in hertz is unchanged by zero-padding. Verdict — Correct.\n\nB. The ability to resolve two close sinusoids with a rectangular window is limited by the aperture $T$, with a characteristic mainlobe width on the order of $1/T$. Zero-padding does not change $T$ and therefore cannot make two tones with separation less than $1/T$ resolvable in the periodogram of the same data; it only provides a smoother-looking curve. Verdict — Incorrect.\n\nC. From the derivation above, $X_{L}[k] = X\\!\\left(e^{j (2\\pi k/L)}\\right)$ for all $k$, which is precisely the statement that zero-padding yields uniformly spaced DTFT samples. Verdict — Correct.\n\nD. Parseval’s theorem with the stated normalization gives $\\sum_{n=0}^{L-1} |x_{L}[n]|^{2} = \\frac{1}{L}\\sum_{k=0}^{L-1} |X_{L}[k]|^{2}$. Multiplying both sides by $f_{s}$ and recognizing $\\Delta f_{L} = f_{s}/L$ shows that $\\left(\\frac{f_{s}}{L}\\right)\\sum_{k} P_{L}[k]$ is invariant for fixed time-domain data, i.e., independent of $L$. Verdict — Correct.\n\nE. Spectral leakage (mainlobe width and sidelobe levels) is dictated by the window $w[n]$ and its duration $T$, not by how finely the frequency axis is sampled. Zero-padding does not change $w[n]$ or $T$, so sidelobe levels do not drop as $L$ increases; they are merely sampled more densely. Verdict — Incorrect.", "answer": "$$\\boxed{ACD}$$", "id": "2391651"}]}