{"hands_on_practices": [{"introduction": "In practical signal processing, such as designing a Finite Impulse Response (FIR) filter, specifications often dictate the desired frequency resolution. This resolution is directly tied to the mainlobe width of the window function used. This exercise [@problem_id:1723953] provides a hands-on approach to a fundamental design task: determining the minimum window length $N$ required to meet a specific bandwidth constraint for a Hamming window.", "problem": "A signal processing engineer is designing a digital Finite Impulse Response (FIR) filter using the windowing method. The design requires a precise control over the filter's transition band, which is critically dependent on the mainlobe width of the window function used. The engineer chooses a Hamming window, which is defined for a length $N$ as:\n$$w[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right), \\quad \\text{for } n = 0, 1, \\dots, N-1.$$\n\nThe signal to be filtered is sampled at a frequency $f_s = 48$ kHz. For this family of window functions, extensive empirical studies have established a relationship between the main lobe's null-to-null bandwidth, $\\Delta f_{\\text{null}}$, and its 3-decibel (dB) bandwidth, $\\Delta f_{\\text{3dB}}$. This relationship is given by $\\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\Delta f_{\\text{null}}$.\n\nThe mainlobe of the Hamming window's frequency spectrum is centered at 0 Hz, and its first nulls occur at frequencies $f = \\pm \\frac{c f_s}{N}$, where $c$ is a constant. For the Hamming window, this constant is $c=2$.\n\nThe filter design specification requires the 3-dB bandwidth of the window's mainlobe to be no more than 150 Hz.\n\nDetermine the minimum integer window length $N$ that satisfies this design constraint.", "solution": "The problem asks for the minimum integer window length $N$ that ensures the 3-dB bandwidth, $\\Delta f_{\\text{3dB}}$, of the Hamming window's mainlobe is no more than 150 Hz. The design constraint can be written as:\n$$ \\Delta f_{\\text{3dB}} \\le 150 \\text{ Hz} $$\n\nTo solve this, we first need to find an expression for $\\Delta f_{\\text{3dB}}$ in terms of the window length $N$. The problem provides a relationship between the 3-dB bandwidth and the null-to-null bandwidth, $\\Delta f_{\\text{null}}$:\n$$ \\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\Delta f_{\\text{null}} $$\n\nNext, we determine $\\Delta f_{\\text{null}}$. The problem states that the first nulls of the mainlobe occur at frequencies $f = \\pm \\frac{c f_s}{N}$, with the constant $c=2$ for the Hamming window. Let's call these null frequencies $f_{\\text{null,1}}$ and $f_{\\text{null,2}}$.\n$$ f_{\\text{null,1}} = +\\frac{2 f_s}{N} $$\n$$ f_{\\text{null,2}} = -\\frac{2 f_s}{N} $$\nThe null-to-null bandwidth is the difference between these two frequencies:\n$$ \\Delta f_{\\text{null}} = f_{\\text{null,1}} - f_{\\text{null,2}} = \\left(\\frac{2 f_s}{N}\\right) - \\left(-\\frac{2 f_s}{N}\\right) = \\frac{4 f_s}{N} $$\n\nNow we can substitute this expression for $\\Delta f_{\\text{null}}$ into the equation for $\\Delta f_{\\text{3dB}}$:\n$$ \\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\left(\\frac{4 f_s}{N}\\right) = \\frac{1.3 f_s}{N} $$\n\nWith this expression, we can use the design constraint to find the required window length $N$:\n$$ \\frac{1.3 f_s}{N} \\le 150 $$\nWe need to solve for $N$. Rearranging the inequality gives:\n$$ N \\ge \\frac{1.3 f_s}{150} $$\n\nNow we can substitute the given numerical values. The sampling frequency is $f_s = 48$ kHz, which is $48000$ Hz.\n$$ N \\ge \\frac{1.3 \\times 48000}{150} $$\nLet's perform the calculation:\n$$ N \\ge \\frac{1.3 \\times 4800}{15} $$\nSince $4800 / 15 = 320$, we have:\n$$ N \\ge 1.3 \\times 320 $$\n$$ N \\ge 416 $$\n\nThe inequality shows that $N$ must be greater than or equal to 416. Since the window length $N$ must be an integer, the minimum integer value for $N$ that satisfies this condition is 416.", "answer": "$$\\boxed{416}$$", "id": "1723953"}, {"introduction": "Understanding the spectral characteristics of a window function begins with its mathematical representation in the frequency domain. This problem [@problem_id:1723929] challenges you to derive the closed-form expression for the Discrete-Time Fourier Transform (DTFT) of the Hamming window. By working through the derivation, you will see precisely how the window's cosine-based shape in the time domain translates into its distinct main lobe and sidelobe pattern in the frequency domain.", "problem": "In digital signal processing, windowing is a fundamental technique used to taper a signal and reduce spectral leakage. Consider a signal processing chain where a discrete-time signal $x[n]$ is first multiplied by a rectangular window $w_R[n]$ of length $N$. The resulting signal is then immediately multiplied by a Hamming window $w_H[n]$ of the same length $N$. This sequence of operations is equivalent to multiplying the original signal $x[n]$ by a single composite window, $w_{eq}[n]$.\n\nThe windows are formally defined as follows:\n- The rectangular window is given by $w_R[n] = 1$ for $0 \\le n \\le N-1$, and $w_R[n] = 0$ otherwise.\n- The Hamming window is given by $w_H[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right)$ for $0 \\le n \\le N-1$, and $w_H[n] = 0$ otherwise.\n\nAssume that $N$ is an integer greater than 1.\n\nYour task is to derive a closed-form analytic expression for the Discrete-Time Fourier Transform (DTFT), denoted as $W_{eq}(e^{j\\omega})$, of the equivalent composite window $w_{eq}[n]$. Express your final answer in terms of $N$ and the angular frequency $\\omega$.", "solution": "The time-domain operation multiplies $x[n]$ by the rectangular window $w_{R}[n]$ and then by the Hamming window $w_{H}[n]$, both of length $N$. Since $w_{R}[n]=1$ for $0 \\leq n \\leq N-1$ and zero otherwise, and $w_{H}[n]=0$ outside the same interval, their product equals the Hamming window itself:\n$$\nw_{eq}[n]=w_{R}[n]\\,w_{H}[n]=w_{H}[n],\\quad \\text{for all }n.\n$$\nThe DTFT of $w_{eq}[n]$ is therefore the DTFT of the Hamming window:\n$$\nW_{eq}\\!\\left(\\exp(\\mathrm{j}\\omega)\\right)=\\sum_{n=0}^{N-1}\\left(0.54-0.46\\cos\\!\\left(\\frac{2\\pi n}{N-1}\\right)\\right)\\exp(-\\mathrm{j}\\omega n).\n$$\nUsing linearity of the DTFT and the identity $\\cos(\\theta)=\\frac{1}{2}\\left(\\exp(\\mathrm{j}\\theta)+\\exp(-\\mathrm{j}\\theta)\\right)$, we write\n$$\nW_{eq}\\!\\left(\\exp(\\mathrm{j}\\omega)\\right)\n=0.54\\sum_{n=0}^{N-1}\\exp(-\\mathrm{j}\\omega n)\n-\\frac{0.46}{2}\\sum_{n=0}^{N-1}\\left[\\exp\\!\\left(-\\mathrm{j}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)n\\right)+\\exp\\!\\left(-\\mathrm{j}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)n\\right)\\right].\n$$\nFor any real $a$, the finite geometric series evaluates to\n$$\n\\sum_{n=0}^{N-1}\\exp(-\\mathrm{j}a n)=\\exp\\!\\left(-\\mathrm{j}a\\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N a}{2}\\right)}{\\sin\\!\\left(\\frac{a}{2}\\right)}.\n$$\nApplying this with $a=\\omega$, $a=\\omega-\\frac{2\\pi}{N-1}$, and $a=\\omega+\\frac{2\\pi}{N-1}$ yields the closed-form expression\n$$\nW_{eq}\\!\\left(\\exp(\\mathrm{j}\\omega)\\right)\n=0.54\\,\\exp\\!\\left(-\\mathrm{j}\\omega\\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}\n-0.23\\left[\n\\exp\\!\\left(-\\mathrm{j}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\!\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}\n+\\exp\\!\\left(-\\mathrm{j}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\!\\left(\\frac{1}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}\n\\right].\n$$\nThis expression is valid for all $N>1$ and all $\\omega$, with the usual interpretation at removable singularities where denominators vanish.", "answer": "$$\\boxed{0.54\\,\\exp\\!\\left(-\\mathrm{j}\\omega\\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}-0.23\\left[\\exp\\!\\left(-\\mathrm{j}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\!\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}+\\exp\\!\\left(-\\mathrm{j}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\!\\left(\\frac{1}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}\\right]}$$", "id": "1723929"}, {"introduction": "The world of windowing functions contains many closely related options, each with its own trade-offs. This exercise [@problem_id:1723928] presents a practical scenario where you must distinguish between a Hamming and a Hanning window by examining their spectra. By calculating and comparing the ratio of their sidelobe magnitudes, you will learn to identify the unique \"spectral fingerprint\" that sets these important windows apart.", "problem": "In digital signal processing, window functions are used to taper finite-length signals to reduce spectral leakage when computing their Discrete Fourier Transform (DFT). Two common choices are the Hanning and Hamming windows. An engineer has lost the metadata for a dataset and needs to determine whether a Hanning or a Hamming window was applied. The plan is to analyze the structure of the frequency spectrum.\n\nThe continuous-time model for a generalized raised-cosine window of duration $T$, centered at $t=0$, is given by:\n$$w(t) = a_0 - a_1 \\cos\\left(\\frac{2\\pi t}{T}\\right), \\quad \\text{for } |t| \\le \\frac{T}{2}$$\nand $w(t)=0$ otherwise. Its Fourier transform, $W(\\omega)$, can be expressed in terms of the sinc function, where $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$:\n$$W(\\omega) = T \\left( a_0 \\, \\text{sinc}\\left(\\frac{\\omega T}{2\\pi}\\right) - \\frac{a_1}{2} \\left[ \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} - 1\\right) + \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} + 1\\right) \\right] \\right) $$\nThe coefficients for the Hanning and Hamming windows are:\n-   **Hanning window:** $a_0 = 0.5$, $a_1 = 0.5$\n-   **Hamming window:** $a_0 = 0.54$, $a_1 = 0.46$\n\nFor raised-cosine windows, the main lobe is followed by a series of sidelobes. We are interested in the ratio of the peak magnitudes of the first and second sidelobes. For the purpose of this problem, assume that the peaks of the first and second sidelobes for both window spectra occur at approximate normalized frequencies $x_1 = 2.5$ and $x_2 = 3.5$, respectively, where $x = \\frac{\\omega T}{2\\pi}$.\n\nCalculate the theoretical ratio of the peak magnitude of the first sidelobe to the peak magnitude of the second sidelobe for both the Hanning window and the Hamming window. Present your answer as two numerical values: the ratio for the Hanning window followed by the ratio for the Hamming window. Round your final answers to four significant figures.", "solution": "The goal is to compute the ratio of the first sidelobe peak magnitude to the second sidelobe peak magnitude for both the Hanning and Hamming windows, using the provided expression for the Fourier transform and the given approximate peak locations.\n\nThe Fourier transform of the window function is given by:\n$$W(\\omega) = T \\left( a_0 \\, \\text{sinc}\\left(\\frac{\\omega T}{2\\pi}\\right) - \\frac{a_1}{2} \\left[ \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} - 1\\right) + \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} + 1\\right) \\right] \\right)$$\nLet's define the normalized frequency $x = \\frac{\\omega T}{2\\pi}$. The spectral shape, ignoring the constant factor $T$, can be described by the function $S(x)$:\n$$S(x) = a_0 \\, \\text{sinc}(x) - \\frac{a_1}{2} \\left( \\text{sinc}(x - 1) + \\text{sinc}(x + 1) \\right)$$\nWe need to find the ratio $\\frac{|S(x_1)|}{|S(x_2)|}$ where $x_1 = 2.5$ is the location of the first sidelobe peak and $x_2 = 3.5$ is the location of the second sidelobe peak.\n\nFirst, let's list the values of the sinc function at the required half-integer points:\n- $\\text{sinc}(1.5) = \\frac{\\sin(1.5\\pi)}{1.5\\pi} = \\frac{-1}{1.5\\pi} = -\\frac{2}{3\\pi}$\n- $\\text{sinc}(2.5) = \\frac{\\sin(2.5\\pi)}{2.5\\pi} = \\frac{1}{2.5\\pi} = \\frac{2}{5\\pi}$\n- $\\text{sinc}(3.5) = \\frac{\\sin(3.5\\pi)}{3.5\\pi} = \\frac{-1}{3.5\\pi} = -\\frac{2}{7\\pi}$\n- $\\text{sinc}(4.5) = \\frac{\\sin(4.5\\pi)}{4.5\\pi} = \\frac{1}{4.5\\pi} = \\frac{2}{9\\pi}$\n\n**1. Hanning Window Calculation**\nFor the Hanning window, the coefficients are $a_0 = 0.5$ and $a_1 = 0.5$.\n\nMagnitude of the first sidelobe peak at $x_1 = 2.5$:\n$$S_{Hanning}(2.5) = 0.5 \\, \\text{sinc}(2.5) - \\frac{0.5}{2} \\left( \\text{sinc}(2.5 - 1) + \\text{sinc}(2.5 + 1) \\right)$$\n$$S_{Hanning}(2.5) = 0.5 \\, \\text{sinc}(2.5) - 0.25 \\left( \\text{sinc}(1.5) + \\text{sinc}(3.5) \\right)$$\nSubstituting the sinc values:\n$$S_{Hanning}(2.5) = 0.5 \\left(\\frac{2}{5\\pi}\\right) - 0.25 \\left(-\\frac{2}{3\\pi} - \\frac{2}{7\\pi}\\right) = \\frac{1}{5\\pi} + \\frac{0.5}{\\pi} \\left(\\frac{1}{3} + \\frac{1}{7}\\right)$$\n$$S_{Hanning}(2.5) = \\frac{1}{5\\pi} + \\frac{0.5 \\times 10}{21\\pi} = \\frac{1}{5\\pi} + \\frac{5}{21\\pi}$$\n$$S_{Hanning}(2.5) = \\frac{1}{\\pi}\\left(\\frac{21 + 25}{105}\\right) = \\frac{46}{105\\pi}$$\nThe magnitude is $|S_{Hanning}(2.5)| = \\frac{46}{105\\pi}$.\n\nMagnitude of the second sidelobe peak at $x_2 = 3.5$:\n$$S_{Hanning}(3.5) = 0.5 \\, \\text{sinc}(3.5) - 0.25 \\left( \\text{sinc}(2.5) + \\text{sinc}(4.5) \\right)$$\nSubstituting the sinc values:\n$$S_{Hanning}(3.5) = 0.5 \\left(-\\frac{2}{7\\pi}\\right) - 0.25 \\left(\\frac{2}{5\\pi} + \\frac{2}{9\\pi}\\right) = -\\frac{1}{7\\pi} - \\frac{0.5}{\\pi} \\left(\\frac{1}{5} + \\frac{1}{9}\\right)$$\n$$S_{Hanning}(3.5) = -\\frac{1}{7\\pi} - \\frac{0.5 \\times 14}{45\\pi} = -\\frac{1}{7\\pi} - \\frac{7}{45\\pi}$$\n$$S_{Hanning}(3.5) = -\\frac{1}{\\pi}\\left(\\frac{45 + 49}{315}\\right) = -\\frac{94}{315\\pi}$$\nThe magnitude is $|S_{Hanning}(3.5)| = \\frac{94}{315\\pi}$.\n\nThe ratio for the Hanning window is:\n$$R_{Hanning} = \\frac{|S_{Hanning}(2.5)|}{|S_{Hanning}(3.5)|} = \\frac{46/105\\pi}{94/315\\pi} = \\frac{46}{105} \\times \\frac{315}{94} = \\frac{46}{94} \\times \\frac{315}{105} = \\frac{23}{47} \\times 3 = \\frac{69}{47}$$\n$$R_{Hanning} \\approx 1.468085...$$\nRounding to four significant figures, $R_{Hanning} \\approx 1.468$.\n\n**2. Hamming Window Calculation**\nFor the Hamming window, the coefficients are $a_0 = 0.54$ and $a_1 = 0.46$.\n\nMagnitude of the first sidelobe peak at $x_1 = 2.5$:\n$$S_{Hamming}(2.5) = 0.54 \\, \\text{sinc}(2.5) - \\frac{0.46}{2} \\left( \\text{sinc}(1.5) + \\text{sinc}(3.5) \\right)$$\n$$S_{Hamming}(2.5) = 0.54 \\left(\\frac{2}{5\\pi}\\right) - 0.23 \\left(-\\frac{2}{3\\pi} - \\frac{2}{7\\pi}\\right) = \\frac{1.08}{5\\pi} + \\frac{0.46}{\\pi} \\left(\\frac{1}{3} + \\frac{1}{7}\\right)$$\n$$S_{Hamming}(2.5) = \\frac{0.216}{\\pi} + \\frac{0.46}{\\pi} \\left(\\frac{10}{21}\\right) = \\frac{1}{\\pi} \\left(0.216 + \\frac{4.6}{21}\\right)$$\n$$S_{Hamming}(2.5) \\approx \\frac{1}{\\pi} (0.216 + 0.2190476) = \\frac{0.4350476}{\\pi}$$\nThe magnitude is $|S_{Hamming}(2.5)| \\approx \\frac{0.4350476}{\\pi}$.\n\nMagnitude of the second sidelobe peak at $x_2 = 3.5$:\n$$S_{Hamming}(3.5) = 0.54 \\, \\text{sinc}(3.5) - 0.23 \\left( \\text{sinc}(2.5) + \\text{sinc}(4.5) \\right)$$\n$$S_{Hamming}(3.5) = 0.54 \\left(-\\frac{2}{7\\pi}\\right) - 0.23 \\left(\\frac{2}{5\\pi} + \\frac{2}{9\\pi}\\right) = -\\frac{1.08}{7\\pi} - \\frac{0.46}{\\pi} \\left(\\frac{1}{5} + \\frac{1}{9}\\right)$$\n$$S_{Hamming}(3.5) = -\\frac{1.08}{7\\pi} - \\frac{0.46}{\\pi} \\left(\\frac{14}{45}\\right) = -\\frac{1}{\\pi} \\left(\\frac{1.08}{7} + \\frac{0.46 \\times 14}{45}\\right)$$\n$$S_{Hamming}(3.5) \\approx -\\frac{1}{\\pi} (0.1542857 + 0.1431111) = -\\frac{0.2973968}{\\pi}$$\nThe magnitude is $|S_{Hamming}(3.5)| \\approx \\frac{0.2973968}{\\pi}$.\n\nThe ratio for the Hamming window is:\n$$R_{Hamming} = \\frac{|S_{Hamming}(2.5)|}{|S_{Hamming}(3.5)|} \\approx \\frac{0.4350476/\\pi}{0.2973968/\\pi} = \\frac{0.4350476}{0.2973968}$$\n$$R_{Hamming} \\approx 1.46285...$$\nRounding to four significant figures, $R_{Hamming} \\approx 1.463$.\n\nThe two calculated ratios are for the Hanning and Hamming windows, respectively.", "answer": "$$\\boxed{\\begin{pmatrix} 1.468 & 1.463 \\end{pmatrix}}$$", "id": "1723928"}]}