{"hands_on_practices": [{"introduction": "The core principle of the frequency sampling method is the direct relationship between the desired frequency response samples and the filter's impulse response. This practice provides a foundational exercise in applying the Inverse Discrete Fourier Transform (IDFT) to translate a set of specified frequency samples, $H(k)$, into a specific filter coefficient, $h(n)$. Mastering this calculation is the first step toward understanding and implementing this filter design technique.", "problem": "A linear-phase Finite Impulse Response (FIR) filter of length $N=15$ is being designed using the frequency sampling technique. In this method, the desired filter's frequency response is specified by a set of $N$ frequency samples, $H(k)$, for $k = 0, 1, \\dots, N-1$. These samples correspond to the frequencies $\\omega_k = \\frac{2\\pi k}{N}$.\n\nFor this particular design, a symmetric low-pass characteristic is chosen, with the frequency samples defined as:\n$$\nH(k) = \\begin{cases}\n1 & \\text{for } k \\in \\{0, 1, 2, 13, 14\\} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nThe impulse response of the filter, $h(n)$, is obtained by computing the $N$-point Inverse Discrete Fourier Transform (IDFT) of the sequence $H(k)$.\n\nDetermine the value of the impulse response coefficient $h(7)$. Provide your answer as a single, closed-form analytic expression.", "solution": "For an $N$-point IDFT with the conventional DFT/IDFT pair\n$$\nX(k)=\\sum_{n=0}^{N-1} x(n)\\exp\\left(-\\mathrm{j}\\frac{2\\pi kn}{N}\\right),\\quad\nx(n)=\\frac{1}{N}\\sum_{k=0}^{N-1} X(k)\\exp\\left(\\mathrm{j}\\frac{2\\pi kn}{N}\\right),\n$$\nthe impulse response is\n$$\nh(n)=\\frac{1}{N}\\sum_{k=0}^{N-1} H(k)\\exp\\left(\\mathrm{j}\\frac{2\\pi kn}{N}\\right).\n$$\nWith $N=15$ and $H(k)=1$ for $k\\in\\{0,1,2,13,14\\}$ and $H(k)=0$ otherwise, we obtain\n$$\nh(n)=\\frac{1}{15}\\left[\\exp(0)+\\exp\\left(\\mathrm{j}\\frac{2\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{4\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{26\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{28\\pi n}{15}\\right)\\right].\n$$\nUsing $13\\equiv -2\\pmod{15}$ and $14\\equiv -1\\pmod{15}$ gives\n$$\nh(n)=\\frac{1}{15}\\left[1+\\exp\\left(\\mathrm{j}\\frac{2\\pi n}{15}\\right)+\\exp\\left(\\mathrm{j}\\frac{4\\pi n}{15}\\right)+\\exp\\left(-\\mathrm{j}\\frac{4\\pi n}{15}\\right)+\\exp\\left(-\\mathrm{j}\\frac{2\\pi n}{15}\\right)\\right].\n$$\nApplying $\\exp(\\mathrm{j}\\theta)+\\exp(-\\mathrm{j}\\theta)=2\\cos\\theta$ yields\n$$\nh(n)=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{2\\pi n}{15}\\right)+2\\cos\\left(\\frac{4\\pi n}{15}\\right)\\right].\n$$\nFor $n=7$,\n$$\nh(7)=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{14\\pi}{15}\\right)+2\\cos\\left(\\frac{28\\pi}{15}\\right)\\right].\n$$\nUse the identities $\\cos(\\pi-\\alpha)=-\\cos(\\alpha)$ and $\\cos(2\\pi-\\alpha)=\\cos(\\alpha)$ to obtain\n$$\n\\cos\\left(\\frac{14\\pi}{15}\\right)=-\\cos\\left(\\frac{\\pi}{15}\\right),\\qquad\n\\cos\\left(\\frac{28\\pi}{15}\\right)=\\cos\\left(\\frac{2\\pi}{15}\\right).\n$$\nTherefore,\n$$\nh(7)=\\frac{1}{15}\\left[1-2\\cos\\left(\\frac{\\pi}{15}\\right)+2\\cos\\left(\\frac{2\\pi}{15}\\right)\\right].\n$$\nOptionally, using $\\cos(2x)=2\\cos^{2}(x)-1$ with $x=\\frac{\\pi}{15}$ gives the equivalent closed form\n$$\nh(7)=\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right].\n$$\nEither expression is a valid single, closed-form analytic expression for $h(7)$.", "answer": "$$\\boxed{\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right]}$$", "id": "1719137"}, {"introduction": "Beyond the basic IDFT calculation, practical FIR filter design often involves satisfying additional constraints to achieve desired characteristics like linear phase. This exercise moves into that practical realm, focusing on a Type-II linear-phase filter. You will need to apply a fundamental property specific to this filter type, demonstrating how theoretical constraints guide the selection of frequency samples in a real-world design scenario.", "problem": "A digital signal processing engineer is designing a low-pass Finite Impulse Response (FIR) filter of length $N=16$ using the frequency sampling method. The design specifies a Type-II linear-phase filter, which implies that the filter's impulse response, denoted $h(n)$, is real-valued and symmetric ($h(n) = h(N-1-n)$) and its length $N$ is an even number.\n\nThe filter's characteristics are defined by $N$ frequency samples, $H(k)$, taken at frequencies $\\omega_k = \\frac{2\\pi k}{N}$ for $k=0, 1, \\dots, N-1$. To ensure a real-valued impulse response, these samples are chosen to be real and to satisfy the symmetry condition $H(k) = H(N-k)$.\n\nThe target is a low-pass filter, and the engineer has specified most of the independent sample values as follows:\n- Passband samples: $H(0)=1, H(1)=1, H(2)=1, H(3)=1$.\n- Transition sample: $H(4)=0.4$.\n- Stopband samples: $H(5)=0, H(6)=0, H(7)=0$.\n\nThe sample at $k=8$ corresponds to the Nyquist frequency. The remaining samples for $k>8$ are determined by the symmetry requirement. Based on the fundamental properties that all Type-II FIR filters must satisfy, determine the correct values for the set of independent frequency samples $H(k)$ for $k = 0, 1, \\dots, 8$.\n\nPresent your answer as a row matrix containing the values for $H(0), H(1), \\dots, H(8)$ in order.", "solution": "We are given an FIR filter of length $N=16$ with Type-II linear phase, which implies $N$ is even and the impulse response is symmetric, $h(n)=h(N-1-n)$. The frequency-sampling method specifies $N$ samples $H(k)$ at $\\omega_{k}=\\frac{2\\pi k}{N}$, $k=0,1,\\dots,N-1$, chosen real and symmetric as $H(k)=H(N-k)$ to ensure a real-valued $h(n)$.\n\nA fundamental property of Type-II FIR filters (even $N$, symmetric $h(n)$) is that the frequency response must be zero at the Nyquist frequency $\\omega=\\pi$. To see this, let $N=2M$ with $M=8$. The DTFT of $h(n)$ is\n$$\nH(\\mathrm{e}^{\\mathrm{j}\\omega})=\\sum_{n=0}^{N-1}h(n)\\,\\mathrm{e}^{-\\mathrm{j}\\omega n}.\n$$\nUsing symmetry $h(n)=h(N-1-n)$ and pairing terms $n$ with $N-1-n$ for $n=0,\\dots,M-1$, we obtain\n$$\nH(\\mathrm{e}^{\\mathrm{j}\\omega})=\\sum_{n=0}^{M-1}h(n)\\left(\\mathrm{e}^{-\\mathrm{j}\\omega n}+\\mathrm{e}^{-\\mathrm{j}\\omega (N-1-n)}\\right)\n=e^{-\\mathrm{j}\\omega (N-1)/2}\\sum_{n=0}^{M-1}2h(n)\\cos\\!\\left(\\omega\\left(n-\\frac{N-1}{2}\\right)\\right).\n$$\nFor even $N$, we have $\\frac{N-1}{2}=M-\\frac{1}{2}$, a half-integer. Evaluating at the Nyquist frequency $\\omega=\\pi$ yields\n$$\n\\cos\\!\\left(\\pi\\left(n-\\frac{N-1}{2}\\right)\\right)=\\cos\\!\\left(\\pi\\left(n-M+\\frac{1}{2}\\right)\\right)=0\n$$\nfor every integer $n$. Hence the entire sum is zero and\n$$\nH(\\mathrm{e}^{\\mathrm{j}\\pi})=0.\n$$\nIn the frequency-sampling design, $H(k)$ are samples of $H(\\mathrm{e}^{\\mathrm{j}\\omega})$ at $\\omega_{k}=\\frac{2\\pi k}{N}$. The Nyquist frequency corresponds to $k=\\frac{N}{2}=8$, so the Type-II property enforces\n$$\nH(8)=0.\n$$\n\nAll other specified independent samples remain as given, and symmetry $H(k)=H(N-k)$ determines those for $k>8$. Therefore, the correct set of independent samples for $k=0,1,\\dots,8$ is\n$$\n\\begin{pmatrix}\nH(0) & H(1) & H(2) & H(3) & H(4) & H(5) & H(6) & H(7) & H(8)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 1 & 1 & 1 & 0.4 & 0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\nThis satisfies the Type-II constraint $H(8)=0$, maintains real-valued and symmetric samples, and preserves the specified passband, transition, and stopband values.", "answer": "$$\\boxed{\\begin{pmatrix}1 & 1 & 1 & 1 & 0.4 & 0 & 0 & 0 & 0\\end{pmatrix}}$$", "id": "1719134"}, {"introduction": "A crucial aspect of the frequency sampling method is understanding what happens *between* the specified sample points; the continuous frequency response is an interpolation of the discrete samples, not a simple connection. This thought experiment explores the non-local nature of this interpolation by examining the system-wide effect of a single, small error. This reveals deep insights into the behavior and potential pitfalls of this design method.", "problem": "An engineer is designing a linear-phase Finite Impulse Response (FIR) low-pass filter of length $N=51$ using the frequency sampling method. The ideal desired frequency response, $H_d(e^{j\\omega})$, is defined as:\n$$\nH_d(e^{j\\omega}) = \n\\begin{cases} \n1 & \\text{for } |\\omega| \\leq 0.3\\pi \\\\\n0 & \\text{for } 0.3\\pi < |\\omega| \\leq \\pi\n\\end{cases}\n$$\nThe frequency samples, $H(k)$, are taken at frequencies $\\omega_k = \\frac{2\\pi k}{N}$ for $k = 0, 1, \\dots, N-1$. Due to a hardware quantization error during implementation, a single frequency sample in the intended stopband is erroneously set. Specifically, the sample at index $k=15$, which should be $H(15)=0$, is instead stored as a small positive real value $H(15) = \\epsilon$. All other $N-1$ frequency samples are set to their correct ideal values.\n\nWhich of the following statements most accurately describes the effect of this single error on the magnitude of the final interpolated frequency response, $|H(e^{j\\omega})|$?\n\nA. The error introduces a single, infinitely narrow spike in the stopband at the frequency $\\omega = \\frac{2\\pi(15)}{51}$, but the rest of the stopband remains at an ideal attenuation of zero.\n\nB. The error's effect is localized; a small ripple appears around the frequency $\\omega = \\frac{2\\pi(15)}{51}$, but the frequency response quickly returns to ideal zero for frequencies far from this point in the stopband.\n\nC. The error causes the FIR filter to become unstable, leading to an unbounded output for certain bounded input signals.\n\nD. The error introduces a ripple that extends across the entire frequency spectrum, including the passband and the stopband. The shape of this ripple is a scaled and shifted version of the periodic sinc (or Dirichlet) function.\n\nE. The error only affects the phase response of the filter, leaving the magnitude response $|H(e^{j\\omega})|$ identical to the ideal design.", "solution": "The frequency sampling method specifies the $N$ frequency samples $H(k)$ at $\\omega_{k}=\\frac{2\\pi k}{N}$. The corresponding impulse response is obtained by the inverse DFT:\n$$\nh[n]=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\exp\\left(j\\frac{2\\pi k}{N}n\\right),\\quad n=0,1,\\dots,N-1.\n$$\nThe DTFT of $h[n]$ gives the interpolated frequency response:\n$$\nH\\left(\\exp(j\\omega)\\right)=\\sum_{n=0}^{N-1}h[n]\\exp(-j\\omega n).\n$$\nSubstituting $h[n]$ into this DTFT yields\n$$\nH\\left(\\exp(j\\omega)\\right)=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\sum_{n=0}^{N-1}\\exp\\left(-j\\left(\\omega-\\frac{2\\pi k}{N}\\right)n\\right).\n$$\nThe inner sum is a finite geometric series that evaluates to the Dirichlet kernel (up to a linear phase factor):\n$$\n\\sum_{n=0}^{N-1}\\exp\\left(-j\\left(\\omega-\\frac{2\\pi k}{N}\\right)n\\right)=\\exp\\left(-j\\frac{(N-1)}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}.\n$$\nTherefore,\n$$\nH\\left(\\exp(j\\omega)\\right)=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\exp\\left(-j\\frac{(N-1)}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}.\n$$\nThis shows that each sample $H(k)$ contributes a shifted and scaled Dirichlet kernel across the entire frequency axis. If all samples match the ideal low-pass values, their superposition approximates the desired response. If exactly one stopband sample is in error by $H(15)=\\epsilon$ (with the ideal being zero), then $H\\left(\\exp(j\\omega)\\right)$ can be written as\n$$\nH\\left(\\exp(j\\omega)\\right)=H_{\\text{ideal}}\\left(\\exp(j\\omega)\\right)+\\frac{\\epsilon}{N}\\exp\\left(-j\\frac{(N-1)}{2}\\left(\\omega-\\frac{2\\pi\\cdot 15}{N}\\right)\\right)\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi\\cdot 15}{N}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi\\cdot 15}{N}\\right)\\right)}.\n$$\nTaking magnitudes, the added term yields a ripple shaped like the magnitude of the Dirichlet kernel, centered at $\\omega=\\frac{2\\pi\\cdot 15}{N}$, and extending across the entire spectrum due to the noncompact support of the Dirichlet kernel in frequency. Hence:\n- It is not an infinitely narrow spike at a single frequency; instead, the Dirichlet kernel has sidelobes across all frequencies, so option A is false.\n- The effect is not localized near $\\omega=\\frac{2\\pi\\cdot 15}{N}$; the Dirichlet kernel produces nonzero contributions across the full spectrum (except at its zeros), so option B is false.\n- FIR filters are BIBO stable regardless of coefficient quantization, so option C is false.\n- The error directly alters the magnitude via the added Dirichlet-shaped term, so it does not only affect phase; option E is false.\n\nTherefore, the correct description is that the single erroneous sample introduces a ripple extending across the entire frequency spectrum with the shape of a scaled, shifted Dirichlet kernel, which is option D.", "answer": "$$\\boxed{D}$$", "id": "1719159"}]}