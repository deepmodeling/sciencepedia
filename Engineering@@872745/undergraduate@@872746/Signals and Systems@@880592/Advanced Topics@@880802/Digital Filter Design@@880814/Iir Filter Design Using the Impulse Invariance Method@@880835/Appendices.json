{"hands_on_practices": [{"introduction": "The cornerstone of the impulse invariance method is the direct mapping of characteristics from an analog filter to its digital counterpart. This begins with understanding how the poles, which define a filter's behavior, are transformed from the continuous s-plane to the discrete z-plane. This first exercise [@problem_id:1726595] guides you through this fundamental transformation for a simple first-order filter, illustrating the core mathematical relationship $z_p = \\exp(s_p T_s)$ that governs the process.", "problem": "An engineer is designing a digital signal processing system to replace an existing analog component. The analog component is a simple, stable, first-order low-pass filter whose transfer function has a single real pole located at $s = -5$ in the s-plane. To create the digital equivalent, the engineer decides to use the impulse invariance method. A sampling period of $T_s$ is used for the analog-to-digital conversion process.\n\nDetermine the location of the corresponding pole in the z-plane for the resulting digital Infinite Impulse Response (IIR) filter. Express your answer as a symbolic expression in terms of the sampling period $T_s$.", "solution": "The given analog system is a stable first-order low-pass filter with a single real pole at $s=-5$. A canonical form for such a system is $H_{a}(s)=\\frac{K}{s+5}$ with some gain $K$, whose impulse response is $h_{a}(t)=K \\exp(-5 t) u(t)$, where $u(t)$ is the unit step function.\n\nUnder impulse invariance, the discrete-time impulse response is obtained by sampling the continuous-time impulse response at integer multiples of the sampling period $T_s$:\n$$\nh[n]=h_{a}(nT_s)=K \\exp(-5 n T_s) u[n].\n$$\nTaking the $z$-transform of $h[n]$,\n$$\nH(z)=\\sum_{n=0}^{\\infty} K \\exp(-5 T_s n) z^{-n}=K \\sum_{n=0}^{\\infty} \\left(\\exp(-5 T_s) z^{-1}\\right)^{n}.\n$$\nThis is a geometric series with common ratio $\\exp(-5 T_s) z^{-1}$, which converges for $|z|>|\\exp(-5 T_s)|$, and sums to\n$$\nH(z)=\\frac{K}{1-\\exp(-5 T_s) z^{-1}}.\n$$\nHence the pole of the digital IIR filter is the root of the denominator,\n$$\n1-\\exp(-5 T_s) z^{-1}=0 \\quad \\Rightarrow \\quad z=\\exp(-5 T_s).\n$$\nMore generally, under impulse invariance, a continuous-time pole at $s=s_{0}$ maps to a discrete-time pole at $z=\\exp(s_{0} T_s)$. Substituting $s_{0}=-5$ yields the pole location $z=\\exp(-5 T_s)$.", "answer": "$$\\boxed{\\exp(-5 T_s)}$$", "id": "1726595"}, {"introduction": "Once we understand how to map poles, the next practical step is to translate this into a functional digital filter. The pole locations in the z-plane directly determine the coefficients of the difference equation that implements the filter in a real digital signal processor. This practice problem [@problem_id:1726536] bridges the gap between theory and application by asking you to calculate a key feedback coefficient for a first-order IIR filter, demonstrating how the analog prototype and sampling period shape the final digital implementation.", "problem": "A digital filter is to be designed to approximate a first-order continuous-time system. The continuous-time system is described by the transfer function $H_a(s) = \\frac{10}{s+5}$. The design methodology is the impulse invariance method, using a sampling period of $T_s = 0.1$ seconds. The resulting digital filter is to be implemented using a first-order Infinite Impulse Response (IIR) structure, described by the difference equation $y[n] = b_0x[n] - a_1y[n-1]$, where $x[n]$ is the input sequence and $y[n]$ is the output sequence. Determine the numerical value of the feedback coefficient $a_1$. Round your final answer to three significant figures.", "solution": "The continuous-time transfer function is $H_{a}(s)=\\frac{10}{s+5}$. Its impulse response is obtained by inverse Laplace transform:\n$$\nh_{a}(t)=10\\exp(-5t)u(t).\n$$\nUsing impulse invariance with sampling period $T_s$, the discrete-time impulse response is the sampled and scaled version:\n$$\nh_{d}[n]=T_s\\,h_{a}(nT_s)=10T_s\\,\\exp(-5nT_s)u[n].\n$$\nTaking the $Z$-transform, we obtain a geometric series:\n$$\nH(z)=\\sum_{n=0}^{\\infty}10T_s\\,\\exp(-5nT_s)z^{-n}=\\frac{10T_s}{1-\\exp(-5T_s)z^{-1}}.\n$$\nThe given IIR structure is $y[n]=b_{0}x[n]-a_{1}y[n-1]$, whose transfer function is\n$$\nH(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}}{1+a_{1}z^{-1}}.\n$$\nEquating with the impulse-invariant $H(z)$, the denominators must match:\n$$\n1+a_{1}z^{-1}=1-\\exp(-5T_s)z^{-1}\\quad\\Rightarrow\\quad a_{1}=-\\exp(-5T_s).\n$$\nWith $T_s=0.1$, this becomes\n$$\na_{1}=-\\exp(-0.5)\\approx-0.606530659\\ldots\n$$\nRounded to three significant figures:\n$$\na_{1}\\approx-0.607.\n$$", "answer": "$$\\boxed{-0.607}$$", "id": "1726536"}, {"introduction": "The sampling process at the heart of the impulse invariance method can lead to some surprising and non-intuitive outcomes. A crucial concept to grasp is aliasing, where different continuous-time signals can become indistinguishable after sampling. This advanced problem [@problem_id:1726542] explores a fascinating consequence of aliasing, challenging you to show how two vastly different analog filters—a low-pass and a band-pass—can produce the exact same digital filter, highlighting a critical limitation of the design method.", "problem": "The design of an Infinite Impulse Response (IIR) digital filter from an analog prototype can sometimes lead to counter-intuitive outcomes. One such design technique is the impulse invariance method, where the digital filter's impulse response is created by sampling the impulse response of a continuous-time analog filter.\n\nConsider a stable, second-order, low-pass analog filter with real-valued coefficients, given by the transfer function:\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{(s - \\sigma_0)^2 + \\omega_0^2}$$\nwhere $\\sigma_0$ and $\\omega_0$ are real constants representing filter parameters, with the constraints $\\sigma_0  0$ and $\\omega_0  0$. This filter's DC gain is unity.\n\nThis filter is used as a prototype to design a digital filter $H(z)$ using the impulse invariance method with a sampling period $T_s$.\n\nIt turns out that there exists a different stable, second-order analog filter, $H_2(s)$, which has a distinct band-pass frequency response characteristic, yet produces the exact same digital filter $H(z)$ when the same impulse invariance design process is applied with the same sampling period $T_s$.\n\nDetermine the transfer function for one such filter, $H_2(s)$. Your final answer should be a single closed-form analytic expression in terms of $s$, $\\sigma_0$, $\\omega_0$, and $T_s$.", "solution": "The core principle of the impulse invariance method is that the impulse response of the digital filter, $h_d[n]$, is a sampled version of the analog filter's impulse response, $h_a(t)$. That is, $h_d[n] = h_a(nT_s)$, where $T_s$ is the sampling period.\n\nFor two different analog filters, $H_1(s)$ and $H_2(s)$, to produce the identical digital filter $H(z)$, their respective impulse responses, $h_1(t)$ and $h_2(t)$, must yield the same sampled sequence. Therefore, the condition is:\n$$h_1(nT_s) = h_2(nT_s) \\quad \\text{for all integers } n \\ge 0$$\nNote that this does not imply that $h_1(t)$ must equal $h_2(t)$ for all $t$.\n\nFirst, we find the impulse response $h_1(t)$ corresponding to the given low-pass filter $H_1(s)$.\nThe transfer function is:\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{(s - \\sigma_0)^2 + \\omega_0^2}$$\nThis form can be related to the Laplace transform pair $\\mathcal{L}\\{e^{at}\\sin(bt)u(t)\\} = \\frac{b}{(s-a)^2 + b^2}$.\nWe can rewrite $H_1(s)$ as:\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\cdot \\frac{\\omega_0}{(s - \\sigma_0)^2 + \\omega_0^2}$$\nApplying the inverse Laplace transform, we find the impulse response $h_1(t)$:\n$$h_1(t) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_0 t) u(t)$$\nwhere $u(t)$ is the Heaviside step function.\n\nNext, we sample this impulse response at intervals of $T_s$:\n$$h_1(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s) \\quad \\text{for } n \\ge 0$$\n\nNow, we need to find a different continuous-time impulse response, $h_2(t)$, such that $h_2(nT_s) = h_1(nT_s)$. The key lies in the periodic nature of the sampled sinusoidal function. The sine function has the property that $\\sin(\\theta) = \\sin(\\theta + 2\\pi k)$ for any integer $k$.\nLet's consider the term $\\sin(\\omega_0 n T_s)$. We can define a new frequency, $\\omega_1$, such that $\\sin(\\omega_1 n T_s) = \\sin(\\omega_0 n T_s)$ for all integers $n$.\nThis equality holds if:\n$$\\omega_1 n T_s = \\omega_0 n T_s + 2\\pi k n$$\nfor some non-zero integer $k$. Dividing by $n T_s$ (for $n \\neq 0$), we get:\n$$\\omega_1 = \\omega_0 + \\frac{2\\pi k}{T_s}$$\nTo create a filter that is different from $H_1(s)$, we must choose $k \\neq 0$. The problem specifies that $H_2(s)$ should have a band-pass characteristic. A band-pass filter generally has a resonance at a higher frequency than a comparable low-pass filter. This suggests picking a positive integer for $k$ to increase the frequency. The simplest choice is $k=1$. Let's define our new frequency:\n$$\\omega_1 = \\omega_0 + \\frac{2\\pi}{T_s}$$\n\nWe can now construct the impulse response $h_2(t)$. It must have the same exponential decay envelope and the same amplitude scaling as $h_1(t)$ to match at the sampling instants, but with the new sinusoidal frequency $\\omega_1$:\n$$h_2(t) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_1 t) u(t)$$\nLet's verify that $h_2(nT_s) = h_1(nT_s)$:\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_1 n T_s)$$\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin\\left(\\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right) n T_s\\right)$$\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s + 2\\pi n)$$\nSince $n$ is an integer, $2\\pi n$ is an integer multiple of $2\\pi$, so $\\sin(\\omega_0 n T_s + 2\\pi n) = \\sin(\\omega_0 n T_s)$.\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s) = h_1(nT_s)$$\nThe condition is satisfied.\n\nFinally, we find the transfer function $H_2(s)$ by taking the Laplace transform of $h_2(t)$:\n$$H_2(s) = \\mathcal{L}\\{h_2(t)\\} = \\mathcal{L}\\left\\{ \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_1 t) u(t) \\right\\}$$\nUsing the same Laplace transform pair as before:\n$$H_2(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\left[ \\frac{\\omega_1}{(s - \\sigma_0)^2 + \\omega_1^2} \\right]$$\nSubstituting the expression for $\\omega_1$:\n$$H_2(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\frac{\\omega_0 + \\frac{2\\pi}{T_s}}{(s - \\sigma_0)^2 + \\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)^2}$$\nThis is the transfer function for a stable ($\\sigma_00$), second-order filter. Its resonance is centered around a much higher frequency $\\omega_1 = \\omega_0 + 2\\pi/T_s$, and its DC gain $H_2(0)$ is significantly less than its peak gain, which confirms its band-pass characteristic, contrasting with the low-pass filter $H_1(s)$ which has maximum gain at DC.", "answer": "$$\\boxed{\\frac{(\\sigma_0^2 + \\omega_0^2)\\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)}{\\omega_0 \\left( (s-\\sigma_0)^2 + \\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)^2 \\right)}}$$", "id": "1726542"}]}