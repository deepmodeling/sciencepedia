{"hands_on_practices": [{"introduction": "A system's block diagram is more than just a picture; it's a precise blueprint for its computational flow. This exercise challenges you to translate a specific realization, known as a transposed form, into its governing input-output difference equation [@problem_id:1756406]. By systematically tracing signals and eliminating the internal state variables, you'll practice a crucial skill in moving from a structural implementation back to its high-level mathematical description.", "problem": "A causal, discrete-time Linear Time-Invariant (LTI) system is realized using a computational structure described by a set of coupled equations. These equations relate the input sequence $x[n]$, the output sequence $y[n]$, and two internal state sequences, $s_1[n]$ and $s_2[n]$. The relationships are defined for all integers $n$ as follows:\n\n1.  $y[n] = s_1[n] + b_0 x[n]$\n2.  $s_1[n] = s_2[n-1] + b_1 x[n-1] - a_1 y[n-1]$\n3.  $s_2[n] = b_2 x[n-1] - a_2 y[n-1]$\n\nThe system is characterized by the constant, real-valued coefficients $a_1, a_2, b_0, b_1, b_2$.\n\nYour task is to eliminate the internal state sequences $s_1[n]$ and $s_2[n]$ to find the single difference equation that directly describes the input-output relationship of the system. Express your final answer as the expression for $y[n]$ in terms of past output values (i.e., $y[n-k]$ for $k>0$) and present and past input values (i.e., $x[n-k]$ for $k \\ge 0$).", "solution": "We begin from the given coupled equations:\n$$y[n]=s_{1}[n]+b_{0}x[n],$$\n$$s_{1}[n]=s_{2}[n-1]+b_{1}x[n-1]-a_{1}y[n-1],$$\n$$s_{2}[n]=b_{2}x[n-1]-a_{2}y[n-1].$$\n\nFirst, express $s_{1}[n]$ from the output equation:\n$$s_{1}[n]=y[n]-b_{0}x[n].$$\n\nEquate this to the expression for $s_{1}[n]$ from the second equation:\n$$y[n]-b_{0}x[n]=s_{2}[n-1]+b_{1}x[n-1]-a_{1}y[n-1].$$\n\nNext, obtain $s_{2}[n-1]$ by shifting the third equation by one time step:\n$$s_{2}[n-1]=b_{2}x[n-2]-a_{2}y[n-2].$$\n\nSubstitute this into the previous relation:\n$$y[n]-b_{0}x[n]=\\bigl(b_{2}x[n-2]-a_{2}y[n-2]\\bigr)+b_{1}x[n-1]-a_{1}y[n-1].$$\n\nFinally, solve for $y[n]$ to obtain the single input-output difference equation:\n$$y[n]=-a_{1}y[n-1]-a_{2}y[n-2]+b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2].$$", "answer": "$$\\boxed{y[n]=-a_{1}y[n-1]-a_{2}y[n-2]+b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2]}$$", "id": "1756406"}, {"introduction": "Complex systems are often built by connecting simpler, modular subsystems in series, a configuration known as a cascade structure. This practice demonstrates how to determine the overall system behavior from its constituent parts [@problem_id:1756424]. By finding the transfer function for two cascaded first-order systems, you will reinforce the key principle that the overall transfer function is simply the product of the individual transfer functions.", "problem": "A digital signal processing system is designed by connecting two simpler discrete-time linear time-invariant (LTI) subsystems, labeled System 1 and System 2, in series. The output of System 1 serves as the input for System 2.\n\nThe input-output relationship for System 1 is described by the difference equation:\n$$y_1[n] = x[n] + \\alpha y_1[n-1]$$\nwhere $x[n]$ is the input signal to System 1 and $y_1[n]$ is its output.\n\nThe input-output relationship for System 2 is described by the difference equation:\n$$y[n] = y_1[n] - \\gamma y_1[n-1] + \\beta y[n-1]$$\nwhere $y_1[n]$ is the input to System 2 and $y[n]$ is the final output of the entire system.\n\nThe parameters $\\alpha$, $\\beta$, and $\\gamma$ are real-valued, non-zero constants that characterize the behavior of the subsystems.\n\nDetermine the overall transfer function $H(z) = \\frac{Y(z)}{X(z)}$ of the composite system. Express your answer as a rational function in terms of powers of $z^{-1}$.", "solution": "We consider two discrete-time LTI systems connected in series, so the overall transfer function equals the product of the individual transfer functions. This follows from the cascade property of LTI systems: if $H_{1}(z) = \\frac{Y_{1}(z)}{X(z)}$ and $H_{2}(z) = \\frac{Y(z)}{Y_{1}(z)}$, then $H(z) = \\frac{Y(z)}{X(z)} = H_{2}(z)H_{1}(z)$.\n\nFirst, derive $H_{1}(z)$ for System 1. The difference equation is\n$$\ny_{1}[n] = x[n] + \\alpha y_{1}[n-1].\n$$\nTaking the $z$-transform under initial rest and using the time-shift property $Z\\{y[n-k]\\} = z^{-k}Y(z)$,\n$$\nY_{1}(z) = X(z) + \\alpha z^{-1} Y_{1}(z).\n$$\nRearranging,\n$$\nY_{1}(z)\\left(1 - \\alpha z^{-1}\\right) = X(z),\n$$\nhence\n$$\nH_{1}(z) = \\frac{Y_{1}(z)}{X(z)} = \\frac{1}{1 - \\alpha z^{-1}}.\n$$\n\nNext, derive $H_{2}(z)$ for System 2. The difference equation is\n$$\ny[n] = y_{1}[n] - \\gamma y_{1}[n-1] + \\beta y[n-1].\n$$\nTaking the $z$-transform under initial rest,\n$$\nY(z) = Y_{1}(z) - \\gamma z^{-1} Y_{1}(z) + \\beta z^{-1} Y(z).\n$$\nRearranging,\n$$\nY(z)\\left(1 - \\beta z^{-1}\\right) = Y_{1}(z)\\left(1 - \\gamma z^{-1}\\right),\n$$\nhence\n$$\nH_{2}(z) = \\frac{Y(z)}{Y_{1}(z)} = \\frac{1 - \\gamma z^{-1}}{1 - \\beta z^{-1}}.\n$$\n\nBy the cascade property, the overall transfer function is\n$$\nH(z) = H_{2}(z)H_{1}(z) = \\frac{1 - \\gamma z^{-1}}{1 - \\beta z^{-1}} \\cdot \\frac{1}{1 - \\alpha z^{-1}} = \\frac{1 - \\gamma z^{-1}}{\\left(1 - \\beta z^{-1}\\right)\\left(1 - \\alpha z^{-1}\\right)}.\n$$\nExpanding the denominator into powers of $z^{-1}$,\n$$\n\\left(1 - \\beta z^{-1}\\right)\\left(1 - \\alpha z^{-1}\\right) = 1 - \\left(\\alpha + \\beta\\right) z^{-1} + \\alpha \\beta z^{-2}.\n$$\nTherefore,\n$$\nH(z) = \\frac{1 - \\gamma z^{-1}}{1 - \\left(\\alpha + \\beta\\right) z^{-1} + \\alpha \\beta z^{-2}}.\n$$", "answer": "$$\\boxed{\\frac{1 - \\gamma z^{-1}}{1 - \\left(\\alpha + \\beta\\right) z^{-1} + \\alpha \\beta z^{-2}}}$$", "id": "1756424"}, {"introduction": "While different block diagrams can realize the same overall transfer function, they are not necessarily equivalent in their internal behavior. This advanced problem explores the profound consequences of a pole-zero cancellation on three different state-space realizations [@problem_id:1756417]. You will investigate how this seemingly simple cancellation leads to a non-minimal system, manifesting as a loss of either controllability or observability depending on the chosen structure.", "problem": "Consider a causal, linear time-invariant (LTI) system described by the following second-order linear constant-coefficient difference equation (LCCDE):\n$$y[n] - (\\alpha + \\beta)y[n-1] + \\alpha\\beta y[n-2] = x[n-1] - \\alpha x[n-2]$$\nwhere $x[n]$ is the input and $y[n]$ is the output. The parameters $\\alpha$ and $\\beta$ are distinct, non-zero real constants.\n\nThis LCCDE corresponds to a transfer function $H(z)$ that exhibits a pole-zero cancellation. We wish to analyze the consequences of this cancellation on the properties of different state-space realizations of the system. We will consider three standard second-order (i.e., non-minimal) realizations, all represented by the state-space model:\n$$\n\\begin{align*}\n\\mathbf{s}[n+1] &= A\\mathbf{s}[n] + Bx[n] \\\\\ny[n] &= C\\mathbf{s}[n] + Dx[n]\n\\end{align*}\n$$\n\nThe three realizations are defined as follows:\n1.  **Direct Form II:** The realization where the state matrix $A$ is the companion matrix derived directly from the denominator coefficients of $H(z)$.\n2.  **Transposed Direct Form II:** The realization whose model matrices $(A_T, B_T, C_T, D_T)$ are the transposes of the Direct Form II matrices $(A, C, B, D)$ respectively, i.e., $A_T = A^T$, $B_T = C^T$, $C_T = B^T$, and $D_T = D$.\n3.  **Parallel Form:** The realization constructed by performing a partial fraction expansion of the transfer function $H(z)$. This results in a diagonal state matrix $A = \\mathrm{diag}(\\alpha, \\beta)$. For this problem, assume the specific structure where the input is fed to each parallel branch ($B = [1, 1]^T$) and the outputs of the branches are weighted by the residues and summed ($C$ is a row vector of the residues).\n\nWhich of the following statements correctly describes the controllability and observability of these three non-minimal, second-order state-space realizations?\n\nA. The Direct Form II realization is uncontrollable, the Transposed Direct Form II is unobservable, and the Parallel Form is uncontrollable.\n\nB. The Direct Form II realization is unobservable, the Transposed Direct Form II is uncontrollable, and the Parallel Form is unobservable.\n\nC. All three realizations are minimal and therefore both controllable and observable.\n\nD. The Direct Form II realization is unobservable, the Transposed Direct Form II is uncontrollable, and the Parallel Form is uncontrollable.\n\nE. All three realizations are unobservable.\n\nF. All three realizations are uncontrollable.", "solution": "Start from the given LCCDE\n$$y[n] - (\\alpha + \\beta)y[n-1] + \\alpha\\beta y[n-2] = x[n-1] - \\alpha x[n-2]$$\nand take the $z$-transform under zero initial conditions:\n$$Y(z) - (\\alpha + \\beta)z^{-1}Y(z) + \\alpha\\beta z^{-2}Y(z) = z^{-1}X(z) - \\alpha z^{-2}X(z).$$\nHence the transfer function is\n$$H(z) \\triangleq \\frac{Y(z)}{X(z)} = \\frac{z^{-1} - \\alpha z^{-2}}{1 - (\\alpha + \\beta)z^{-1} + \\alpha\\beta z^{-2}}.$$\nMultiplying numerator and denominator by $z^{2}$ gives\n$$H(z) = \\frac{z - \\alpha}{z^{2} - (\\alpha + \\beta)z + \\alpha\\beta} = \\frac{z - \\alpha}{(z - \\alpha)(z - \\beta)} = \\frac{1}{z - \\beta} = \\frac{z^{-1}}{1 - \\beta z^{-1}}.$$\nThus the minimal system is first order with the single pole at $z=\\beta$, and the pole at $z=\\alpha$ cancels with a zero. Any second-order realization must therefore be non-minimal, containing an unobservable or uncontrollable mode at $z=\\alpha$.\n\nDirect Form II (DFII). Use the standard DFII canonical realization for\n$$\\frac{b_{0} + b_{1} z^{-1} + b_{2} z^{-2}}{1 + a_{1} z^{-1} + a_{2} z^{-2}},$$\nwith $a_{1} = -(\\alpha + \\beta)$, $a_{2} = \\alpha\\beta$, $b_{0} = 0$, $b_{1} = 1$, $b_{2} = -\\alpha$. The DFII matrices are\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -a_{2} & -a_{1} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -\\alpha\\beta & \\alpha + \\beta \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},$$\n$$C = \\begin{pmatrix} b_{2} - a_{2} b_{0} & b_{1} - a_{1} b_{0} \\end{pmatrix} = \\begin{pmatrix} -\\alpha & 1 \\end{pmatrix},\\quad D = b_{0} = 0.$$\nObservability: the observability matrix is\n$$\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} -\\alpha & 1 \\\\ -\\alpha\\beta & \\beta \\end{pmatrix},\\quad \\det(\\mathcal{O}) = (-\\alpha)\\beta - 1\\cdot(-\\alpha\\beta) = 0,$$\nso rank is one and the realization is unobservable. Controllability: the controllability matrix is\n$$\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & \\alpha + \\beta \\end{pmatrix},\\quad \\det(\\mathcal{C}) = -1 \\neq 0,$$\nso rank is two and the realization is controllable.\n\nTransposed Direct Form II (TDFII). By definition $A_{T} = A^{T}$, $B_{T} = C^{T}$, $C_{T} = B^{T}$, $D_{T} = D$. Explicitly,\n$$A_{T} = \\begin{pmatrix} 0 & -\\alpha\\beta \\\\ 1 & \\alpha + \\beta \\end{pmatrix},\\quad B_{T} = \\begin{pmatrix} -\\alpha \\\\ 1 \\end{pmatrix},\\quad C_{T} = \\begin{pmatrix} 0 & 1 \\end{pmatrix},\\quad D_{T} = 0.$$\nControllability:\n$$\\mathcal{C}_{T} = \\begin{pmatrix} B_{T} & A_{T}B_{T} \\end{pmatrix} = \\begin{pmatrix} -\\alpha & -\\alpha\\beta \\\\ 1 & \\beta \\end{pmatrix},\\quad \\det(\\mathcal{C}_{T}) = (-\\alpha)\\beta - (-\\alpha\\beta)\\cdot 1 = 0,$$\nso rank is one and the realization is uncontrollable. Observability:\n$$\\mathcal{O}_{T} = \\begin{pmatrix} C_{T} \\\\ C_{T}A_{T} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & \\alpha + \\beta \\end{pmatrix},\\quad \\det(\\mathcal{O}_{T}) = -1 \\neq 0,$$\nso rank is two and the realization is observable.\n\nParallel Form. The partial fraction residues for\n$$H(z) = \\frac{z - \\alpha}{(z - \\alpha)(z - \\beta)}$$\nare\n$$r_{\\alpha} = \\lim_{z \\to \\alpha} (z - \\alpha) H(z) = \\lim_{z \\to \\alpha} \\frac{z - \\alpha}{z - \\beta} = 0,\\quad r_{\\beta} = \\lim_{z \\to \\beta} (z - \\beta) H(z) = 1.$$\nWith $A = \\mathrm{diag}(\\alpha, \\beta)$, $B = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$, $D = 0$, controllability is determined by\n$$\\mathcal{C}_{\\mathrm{par}} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 1 & \\alpha \\\\ 1 & \\beta \\end{pmatrix},\\quad \\det(\\mathcal{C}_{\\mathrm{par}}) = \\beta - \\alpha \\neq 0,$$\nso the realization is controllable. Observability is determined by\n$$\\mathcal{O}_{\\mathrm{par}} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 0 & \\beta \\end{pmatrix},$$\nwhich has rank one, so the realization is unobservable.\n\nTherefore:\n- Direct Form II: unobservable, controllable.\n- Transposed Direct Form II: uncontrollable, observable.\n- Parallel Form: unobservable, controllable.\n\nThe correct choice is B.", "answer": "$$\\boxed{B}$$", "id": "1756417"}]}