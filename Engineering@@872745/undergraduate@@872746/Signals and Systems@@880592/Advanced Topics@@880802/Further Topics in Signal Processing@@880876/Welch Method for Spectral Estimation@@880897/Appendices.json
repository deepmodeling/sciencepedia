{"hands_on_practices": [{"introduction": "Before we can analyze a signal's spectrum, we must first implement the core idea of the Welch method: segmentation. This initial exercise provides hands-on practice in calculating the total number of data segments you can create from a signal, given a specific segment length and overlap. This is a fundamental parameter that directly influences the statistical stability of your final spectral estimate [@problem_id:1773288].", "problem": "An engineer is using Welch's method to estimate the Power Spectral Density (PSD) of a noisy signal received from a deep-space probe. The recorded discrete-time signal consists of a total of $N=8192$ samples. For the analysis, the signal is to be segmented into windows of length $L=512$ samples each. To improve the statistical stability of the estimate, successive segments are designed to have an overlap of 75%. Calculate the total number of data segments that will be created for averaging in this procedure.", "solution": "Let $N$ be the total number of samples in the signal, $L$ be the length of each segment, and $P$ be the overlap percentage. We are given:\n- Total samples, $N = 8192$.\n- Segment length, $L = 512$ samples.\n- Overlap percentage, $P = 75\\% = 0.75$.\n\nFirst, we calculate the number of samples that overlap between any two consecutive segments. This is simply the overlap percentage multiplied by the segment length.\n$$\n\\text{Overlap in samples} = P \\times L = 0.75 \\times 512 = 384 \\text{ samples}\n$$\n\nNext, we determine the \"hop size\" or \"stride\", which we will denote as $S$. The hop size is the number of samples by which the window is shifted to obtain the next segment. It is the difference between the segment length and the number of overlapping samples.\n$$\nS = L - (\\text{Overlap in samples}) = 512 - 384 = 128 \\text{ samples}\n$$\n\nLet $K$ be the total number of segments. The first segment starts at sample index 0. The second segment starts at index $S$. The third at $2S$, and so on. The $k$-th segment (where $k$ is an integer from 1 to $K$) starts at the sample index $(k-1)S$.\n\nFor a segment to be valid, its starting position plus its length must not exceed the total number of samples in the signal:\n$$\n(k-1)S + L \\le N\n$$\n\nWe want to find the maximum integer $k$ (which will be our total number of segments, $K$) that satisfies this condition.\n$$\n(K-1)S \\le N - L\n$$\n$$\nK - 1 \\le \\frac{N - L}{S}\n$$\nSince $K-1$ must be an integer, we take the floor of the right-hand side to find the maximum possible value for $K-1$.\n$$\nK - 1 = \\left\\lfloor \\frac{N - L}{S} \\right\\rfloor\n$$\nTherefore, the total number of segments $K$ is:\n$$\nK = \\left\\lfloor \\frac{N - L}{S} \\right\\rfloor + 1\n$$\n\nNow, we substitute the given numerical values into this formula:\n$$\nK = \\left\\lfloor \\frac{8192 - 512}{128} \\right\\rfloor + 1\n$$\n$$\nK = \\left\\lfloor \\frac{7680}{128} \\right\\rfloor + 1\n$$\nPerforming the division:\n$$\n\\frac{7680}{128} = 60\n$$\nSo, we have:\n$$\nK = \\lfloor 60 \\rfloor + 1 = 60 + 1 = 61\n$$\n\nThus, a total of 61 segments are created for the analysis.", "answer": "$$\\boxed{61}$$", "id": "1773288"}, {"introduction": "One of the most critical parameters in spectral estimation is frequency resolution—our ability to distinguish between two closely spaced frequency components. In the Welch method, the resolution is not determined by the total signal length, but rather by the length of the individual segments. This practice demonstrates this crucial relationship and how to calculate the resolution of your spectral estimate [@problem_id:1773290].", "problem": "An engineer is analyzing the output signal from a Micro-Electro-Mechanical System (MEMS) gyroscope to characterize its noise profile. The gyroscope signal is sampled digitally at a sampling frequency of $f_s = 4096$ Hz for a total duration of $T = 12.0$ seconds. To estimate the Power Spectral Density (PSD) of the noise, the engineer employs Welch's method. This method involves partitioning the signal into overlapping segments, applying a window function to each segment, and averaging the periodograms of these windowed segments. The engineer chooses to use segments of length $L = 2048$ samples, with a 50% overlap between consecutive segments.\n\nCalculate the frequency resolution of the resulting PSD estimate. Express your answer in Hz, rounded to three significant figures.", "solution": "The problem asks for the frequency resolution of a Power Spectral Density (PSD) estimate calculated using Welch's method.\n\nThe fundamental principle underlying spectral analysis via the Discrete Fourier Transform (DFT) is that the frequency resolution, $\\Delta f$, is determined by the sampling frequency, $f_s$, and the number of samples, $N_{DFT}$, used in the DFT calculation. The formula is:\n$$\n\\Delta f = \\frac{f_s}{N_{DFT}}\n$$\n\nIn Welch's method, the original long signal is divided into shorter segments. A DFT is then computed for each of these individual segments. Therefore, the number of points in the DFT, $N_{DFT}$, is equal to the length of a single segment, $L$. The resulting spectra from all segments are then averaged to produce a final PSD estimate with reduced variance.\n\nThe parameters given in the problem are:\n- Sampling frequency: $f_s = 4096$ Hz\n- Total signal duration: $T = 12.0$ s\n- Segment length: $L = 2048$ samples\n- Overlap: 50%\n\nFor calculating the frequency resolution, the relevant parameters are the sampling frequency $f_s$ and the segment length $L$. The number of samples in the DFT for each segment is $N_{DFT} = L = 2048$.\n\nThe total signal duration $T$ and the overlap percentage are important for determining the total number of segments that are averaged, which in turn affects the statistical variance (or stability) of the final PSD estimate. However, they do not influence the frequency resolution, which is solely a function of the segment length and sampling rate.\n\nUsing the formula for frequency resolution with $N_{DFT} = L$:\n$$\n\\Delta f = \\frac{f_s}{L}\n$$\n\nNow, we substitute the given numerical values:\n$$\n\\Delta f = \\frac{4096 \\text{ Hz}}{2048}\n$$\n\nPerforming the calculation:\n$$\n\\Delta f = 2.00 \\text{ Hz}\n$$\n\nThe question asks for the answer to be rounded to three significant figures. The calculated value is exactly 2, so to express this with three significant figures, we write it as $2.00$.", "answer": "$$\\boxed{2.00}$$", "id": "1773290"}, {"introduction": "The Welch method presents a fundamental trade-off between frequency resolution and the variance of the estimate. While longer segments provide sharper frequency resolution, they result in fewer segments to average, leading to a noisier, more \"jagged\" estimate. This thought experiment challenges you to apply your understanding of this trade-off by deducing the underlying parameters from the qualitative features of a finished Power Spectral Density plot [@problem_id:1773291].", "problem": "An engineer is tasked with analyzing a discrete-time signal, $x[n]$, which is known to be the sum of two distinct sinusoidal components corrupted by additive white noise. To estimate the signal's frequency content, the engineer computes the Power Spectral Density (PSD) using Welch's method. Two separate estimates are generated from the exact same signal $x[n]$, and they are labeled Estimate A and Estimate B.\n\nThe only parameter that was altered between the two computations was the length of the individual segments used in the Welch algorithm. All other parameters, such as the choice of window function and the percentage of overlap between segments, were kept identical.\n\nThe following qualitative observations are made by comparing the two resulting PSD plots:\n\n*   **Estimate A:** The plot displays two distinct peaks, but they are very broad and somewhat smeared. The baseline of the plot, representing the noise floor, is very smooth and shows minimal random fluctuation.\n*   **Estimate B:** The plot shows two extremely sharp and well-defined peaks at the frequencies of the two sinusoids. However, the entire plot, including the noise floor, appears jagged and has a high degree of random, spiky variation from one frequency bin to the next.\n\nBased on these descriptions, what is the relationship between the segment length, $L_A$, used for Estimate A and the segment length, $L_B$, used for Estimate B?\n\nA. $L_A < L_B$\n\nB. $L_A > L_B$\n\nC. $L_A = L_B$\n\nD. The relationship cannot be determined without knowing the total signal length.\n\nE. The relationship cannot be determined without knowing the window function used.", "solution": "Welch’s method estimates the power spectral density by averaging windowed, overlapped periodograms computed on segments of length $L$. Let the total data length be $N$, the overlap be a fixed fraction $\\rho$ (identical in both estimates), and the window $w[n]$ be fixed.\n\n1) Definition of the Welch estimator:\nFor segment index $k=0,\\ldots,K-1$, form\n$$\nX_{k}[m] = \\sum_{n=0}^{L-1} x_{k}[n]\\,w[n]\\exp\\!\\left(-j\\frac{2\\pi mn}{L}\\right),\n$$\nand the per-segment periodogram\n$$\nI_{k}[m] = \\frac{1}{U L}\\,|X_{k}[m]|^{2}, \\quad U = \\frac{1}{L}\\sum_{n=0}^{L-1} w^{2}[n].\n$$\nThe Welch PSD estimate is\n$$\n\\hat{S}[m] = \\frac{1}{K}\\sum_{k=0}^{K-1} I_{k}[m].\n$$\n\n2) Frequency resolution versus segment length:\nThe spectral window is $W(\\omega)=\\sum_{n=0}^{L-1} w[n]\\exp(-j\\omega n)$. Its main-lobe width satisfies\n$$\n\\Delta\\omega_{\\text{ML}} = \\frac{c_{w}}{L},\n$$\nwhere $c_{w}$ depends only on the chosen window (identical in both estimates). Thus, larger $L$ yields smaller $\\Delta\\omega_{\\text{ML}}$, i.e., sharper, better-resolved spectral peaks; smaller $L$ yields broader peaks.\n\n3) Variance reduction by averaging and dependence on $L$:\nWith fixed window and overlap, the variance of the Welch estimator scales inversely with the effective number of averaged segments $K$:\n$$\n\\operatorname{var}\\{\\hat{S}[m]\\} \\propto \\frac{1}{K},\n$$\nup to a constant that depends only on the window and overlap (both fixed here). For fixed $N$ and overlap fraction $\\rho$, increasing $L$ decreases $K$ (fewer segments fit into $N$), while decreasing $L$ increases $K$ (more segments). Hence, larger $L$ implies a more “jagged” PSD (higher variance), and smaller $L$ implies a smoother PSD (lower variance).\n\n4) Mapping observations to $L$:\n- Estimate A: broad, smeared peaks (poor resolution) and a very smooth noise floor (low variance) imply small $L$ and large $K$.\n- Estimate B: extremely sharp peaks (good resolution) and a jagged, spiky noise floor (high variance) imply large $L$ and small $K$.\n\nTherefore, the segment lengths satisfy\n$$\nL_{A} < L_{B}.\n$$\nThis conclusion depends only on how $L$ affects resolution and variance under fixed window and overlap; it does not require knowledge of the total length $N$ or the specific window beyond being identical across estimates.\n\nHence, the correct choice is A.", "answer": "$$\\boxed{A}$$", "id": "1773291"}]}