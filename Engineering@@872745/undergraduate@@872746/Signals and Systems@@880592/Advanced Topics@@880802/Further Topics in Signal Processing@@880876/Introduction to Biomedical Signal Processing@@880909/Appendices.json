{"hands_on_practices": [{"introduction": "Before we can process complex biomedical signals, we must first learn how to characterize them using fundamental metrics. This exercise introduces the concept of signal energy, a measure of a signal's strength over time, by applying it to a simplified model of an Electrocardiogram (ECG) waveform. By calculating the energy of one heartbeat from this model, you will practice applying core signal analysis principles to a practical scenario [@problem_id:1728867].", "problem": "In biomedical signal processing, a simplified model of one cycle of an Electrocardiogram (ECG) signal, denoted as $v(t)$, can be constructed using basic geometric shapes. The signal is considered to be zero everywhere except for a sequence of non-overlapping pulses representing the P-wave, QRS complex, and T-wave.\n\nConsider one such heartbeat cycle modeled by the following components:\n1.  **P-wave**: A rectangular pulse with a constant amplitude of $A_P = 0.2$ millivolts (mV) and a duration of $T_P = 100$ milliseconds (ms).\n2.  **Q-wave**: A rectangular pulse with a constant amplitude of $A_Q = -0.1$ mV and a duration of $T_Q = 50$ ms.\n3.  **R-wave**: A symmetric triangular pulse with a peak amplitude of $A_R = 1.5$ mV and a total base duration of $T_R = 60$ ms.\n4.  **S-wave**: A rectangular pulse with a constant amplitude of $A_S = -0.4$ mV and a duration of $T_S = 50$ ms.\n5.  **T-wave**: A rectangular pulse with a constant amplitude of $A_T = 0.5$ mV and a duration of $T_T = 160$ ms.\n\nThe signal is at 0 mV during the time intervals between these pulses.\n\nCalculate the total energy of this signal model $v(t)$ for a single heartbeat cycle. Express your final answer in units of microvolt-squared seconds ($\\mu\\text{V}^2\\cdot\\text{s}$).", "solution": "The total energy $E_v$ of a continuous-time signal $v(t)$ is defined by the integral of its squared magnitude over all time:\n$$E_v = \\int_{-\\infty}^{\\infty} |v(t)|^2 dt$$\nThe problem states that the signal is composed of five non-overlapping pulses. When a signal is composed of components that are non-zero on disjoint time intervals, the total energy is the sum of the energies of the individual components. Therefore, the total energy is:\n$$E_v = E_P + E_Q + E_R + E_S + E_T$$\nwhere $E_P, E_Q, E_S, E_T$ are the energies of the rectangular pulses and $E_R$ is the energy of the triangular pulse.\n\nFirst, let's find the energy formulas for the two types of pulses.\nFor a rectangular pulse with amplitude $A$ and duration $T$, the energy is:\n$$E_{\\text{rect}} = \\int_{0}^{T} A^2 dt = A^2 [t]_0^T = A^2 T$$\nFor a symmetric triangular pulse with peak amplitude $A$ and base duration $T$, the signal can be described over its duration, say from $t=0$ to $t=T$, as:\n$$v_{\\text{tri}}(t) = \\begin{cases} \\frac{2A}{T}t  0 \\le t  T/2 \\\\ 2A - \\frac{2A}{T}t  T/2 \\le t \\le T \\end{cases}$$\nThe energy is the integral of the square of this function. Due to symmetry, we can integrate over the first half and multiply by 2:\n$$E_{\\text{tri}} = \\int_{0}^{T} |v_{\\text{tri}}(t)|^2 dt = 2 \\int_{0}^{T/2} \\left(\\frac{2A}{T}t\\right)^2 dt$$\n$$E_{\\text{tri}} = 2 \\cdot \\frac{4A^2}{T^2} \\int_{0}^{T/2} t^2 dt = \\frac{8A^2}{T^2} \\left[\\frac{t^3}{3}\\right]_0^{T/2} = \\frac{8A^2}{T^2} \\frac{(T/2)^3}{3} = \\frac{8A^2}{T^2} \\frac{T^3}{24} = \\frac{1}{3} A^2 T$$\n\nNext, we must handle the units. The given amplitudes are in millivolts (mV) and durations are in milliseconds (ms). The final answer must be in microvolt-squared seconds ($\\mu\\text{V}^2\\cdot\\text{s}$). Let's establish the conversion factors:\n$1 \\text{ mV} = 10^3 \\mu\\text{V}$\n$1 \\text{ ms} = 10^{-3} \\text{ s}$\nThe energy is calculated in terms of $A^2 T$. The units of this product are initially $(\\text{mV})^2 \\cdot \\text{ms}$.\n$(\\text{mV})^2 \\cdot \\text{ms} = (10^3 \\mu\\text{V})^2 \\cdot (10^{-3} \\text{s}) = (10^6 \\mu\\text{V}^2) \\cdot (10^{-3} \\text{s}) = 10^3 \\mu\\text{V}^2\\cdot\\text{s}$.\nSo, to convert a value from $(\\text{mV})^2 \\cdot \\text{ms}$ to $\\mu\\text{V}^2\\cdot\\text{s}$, we multiply by 1000.\n\nNow, we calculate the energy for each pulse.\n\n1.  **P-wave (rectangular)**: $A_P = 0.2$ mV, $T_P = 100$ ms.\n    $E_P = A_P^2 T_P = (0.2)^2 \\cdot 100 = 0.04 \\cdot 100 = 4.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n2.  **Q-wave (rectangular)**: $A_Q = -0.1$ mV, $T_Q = 50$ ms.\n    $E_Q = A_Q^2 T_Q = (-0.1)^2 \\cdot 50 = 0.01 \\cdot 50 = 0.5 \\text{ mV}^2\\cdot\\text{ms}$\n\n3.  **R-wave (triangular)**: $A_R = 1.5$ mV, $T_R = 60$ ms.\n    $E_R = \\frac{1}{3} A_R^2 T_R = \\frac{1}{3} (1.5)^2 \\cdot 60 = \\frac{1}{3} \\cdot 2.25 \\cdot 60 = 0.75 \\cdot 60 = 45.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n4.  **S-wave (rectangular)**: $A_S = -0.4$ mV, $T_S = 50$ ms.\n    $E_S = A_S^2 T_S = (-0.4)^2 \\cdot 50 = 0.16 \\cdot 50 = 8.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n5.  **T-wave (rectangular)**: $A_T = 0.5$ mV, $T_T = 160$ ms.\n    $E_T = A_T^2 T_T = (0.5)^2 \\cdot 160 = 0.25 \\cdot 160 = 40.0 \\text{ mV}^2\\cdot\\text{ms}$\n\nNow we sum these individual energies to find the total energy in units of $\\text{mV}^2\\cdot\\text{ms}$:\n$E_{\\text{total, intermediate}} = E_P + E_Q + E_R + E_S + E_T = 4.0 + 0.5 + 45.0 + 8.0 + 40.0 = 97.5 \\text{ mV}^2\\cdot\\text{ms}$\n\nFinally, we convert this total energy to the required units of $\\mu\\text{V}^2\\cdot\\text{s}$ using the conversion factor we found:\n$E_v = 97.5 \\text{ mV}^2\\cdot\\text{ms} \\times \\frac{1000 \\mu\\text{V}^2\\cdot\\text{s}}{1 \\text{ mV}^2\\cdot\\text{ms}} = 97500 \\mu\\text{V}^2\\cdot\\text{s}$", "answer": "$$\\boxed{97500}$$", "id": "1728867"}, {"introduction": "In digital signal processing, the conversion of continuous signals to discrete samples is a necessary step, but one that is fraught with potential pitfalls. This practice problem illustrates the critical concept of aliasing, a distortion that occurs when a signal is sampled at too low a rate without proper filtering. You will analyze a hypothetical but realistic scenario where improper downsampling of a Photoplethysmography (PPG) signal leads to a dangerously incorrect heart rate measurement, highlighting the importance of the Nyquist-Shannon sampling theorem in medical device design [@problem_id:1728885].", "problem": "A biomedical engineer is analyzing a Photoplethysmography (PPG) signal, used for monitoring heart rate. The initial high-fidelity signal was recorded with a sampling frequency of $F_s = 500$ Hz. A spectral analysis of this clean, high-resolution signal reveals two primary frequency components: the physiological signal corresponding to a true heart rate of 162 beats per minute (bpm), and a strong sinusoidal interference from power-line noise at a frequency of $f_N = 60$ Hz. All other harmonics and noise sources can be considered negligible.\n\nTo reduce the data storage requirements, the engineer decides to downsample the signal by decimation. The goal is to obtain a new sampling rate, $F_s'$, that is as close as possible to, but not exceeding, 65 Hz. This is achieved by choosing a suitable integer decimation factor, $M$, and keeping only every $M$-th sample of the original signal. Crucially, the engineer forgets to apply an anti-aliasing low-pass filter before this decimation process.\n\nDue to this oversight, the power-line noise component is aliased to a new, lower frequency. This new spurious frequency is strong enough to be mistaken for the patient's heart rate. What is this incorrectly measured heart rate?\n\nExpress your final answer in beats per minute (bpm), rounded to three significant figures.", "solution": "We are given an original sampling frequency $F_s=500$ Hz and a power-line interference at $f_N=60$ Hz. The engineer downsamples by an integer decimation factor $M$ without prefiltering, aiming for a new sampling rate $F_s'$ that is as close as possible to, but not exceeding, $65$ Hz.\n\nThe new sampling frequency after decimation is\n$$\nF_s'=\\frac{F_s}{M}.\n$$\nThe constraint $F_s'\\leq 65$ Hz gives\n$$\n\\frac{500}{M}\\leq 65 \\quad \\Longrightarrow \\quad M\\geq \\frac{500}{65}.\n$$\nThus the smallest integer $M$ satisfying this is\n$$\nM=\\left\\lceil \\frac{500}{65}\\right\\rceil=8,\n$$\nso\n$$\nF_s'=\\frac{500}{8}=62.5 \\text{ Hz}.\n$$\n\nWithout an anti-aliasing filter, a sinusoid at frequency $f$ sampled at $F_s'$ aliases to\n$$\nf_{\\text{alias}}=\\left|f-kF_s'\\right|,\n$$\nwhere $k\\in \\mathbb{Z}$ is chosen so that $f_{\\text{alias}}\\leq \\frac{F_s'}{2}$. For $f_N=60$ Hz and $F_s'=62.5$ Hz, we choose $k=1$:\n$$\nf_{\\text{alias}}=\\left|60-62.5\\right|=2.5 \\text{ Hz},\n$$\nwhich satisfies $2.5 \\leq \\frac{62.5}{2}=31.25$.\n\nThe erroneously inferred heart rate in beats per minute is obtained by multiplying the aliased frequency in hertz by $60$:\n$$\n\\text{HR}_{\\text{incorrect}}=60\\times f_{\\text{alias}}=60\\times 2.5=150 \\text{ bpm}.\n$$\nRounded to three significant figures, this remains $150$.", "answer": "$$\\boxed{150}$$", "id": "1728885"}, {"introduction": "Beyond analyzing signals, a biomedical engineer must also design and analyze the systems that process them, ensuring they are safe and effective. This problem delves into the crucial concept of Bounded-Input, Bounded-Output (BIBO) stability, using the example of a closed-loop insulin delivery system. By examining the poles of different system models, you will determine which algorithms are stable and which could lead to catastrophic failure, a vital skill in the design of any automated medical device [@problem_id:1728934].", "problem": "An engineering team is developing a prototype for a closed-loop automated insulin delivery system. The core of this system is a Digital Signal Processor (DSP) that calculates the insulin dose, $y[n]$, to be administered at discrete time step $n$. This calculation is based on the current pre-processed blood glucose measurement, $x[n]$, and past dosages. The initial algorithm implemented is described by the first-order linear difference equation:\n\n$y[n] = x[n] + 1.2y[n-1]$\n\nDuring testing, this algorithm was found to be unstable, as small fluctuations in blood glucose could lead to dangerously escalating insulin dosages. To correct this, the engineering team has proposed several modifications to the system's difference equation. Your task is to analyze these proposals and identify all that would result in a Bounded-Input, Bounded-Output (BIBO) stable system.\n\nWhich of the following modified difference equations describe a BIBO stable system? Select all that apply.\n\nA. $y[n] = x[n] + 1.2y[n-1]$\n\nB. $y[n] = x[n] + 0.9y[n-1]$\n\nC. $y[n] = x[n] + 0.5y[n-1] + 0.6y[n-2]$\n\nD. $y[n] = x[n] - 1.05y[n-2]$\n\nE. $y[n] = x[n] - 0.5x[n-1] + 1.1y[n-1] - 0.5y[n-2]$", "solution": "For a causal LTI system described by a linear constant-coefficient difference equation, the transfer function is obtained by taking the $Z$-transform (with zero initial conditions). If the equation is\n$$\ny[n] = \\sum_{k=0}^{M} b_{k} x[n-k] + \\sum_{k=1}^{N} c_{k} y[n-k],\n$$\nthen\n$$\nY(z) = \\left(\\sum_{k=0}^{M} b_{k} z^{-k}\\right) X(z) + \\left(\\sum_{k=1}^{N} c_{k} z^{-k}\\right) Y(z),\n$$\nso\n$$\nH(z) \\equiv \\frac{Y(z)}{X(z)} = \\frac{\\sum_{k=0}^{M} b_{k} z^{-k}}{1 - \\sum_{k=1}^{N} c_{k} z^{-k}}.\n$$\nBIBO stability requires all poles of $H(z)$ to satisfy $|z|1$, i.e., the roots of the characteristic equation $1 - \\sum_{k=1}^{N} c_{k} z^{-k} = 0$ must lie strictly inside the unit circle.\n\nAnalyze each option:\n\nA. $y[n] = x[n] + 1.2 y[n-1]$.\nHere $H(z) = \\dfrac{1}{1 - 1.2 z^{-1}}$ with pole given by $1 - 1.2 z^{-1} = 0 \\Rightarrow z = 1.2$. Since $|1.2| > 1$, this is not BIBO stable.\n\nB. $y[n] = x[n] + 0.9 y[n-1]$.\nHere $H(z) = \\dfrac{1}{1 - 0.9 z^{-1}}$ with pole at $z = 0.9$. Since $|0.9|  1$, this is BIBO stable.\n\nC. $y[n] = x[n] + 0.5 y[n-1] + 0.6 y[n-2]$.\nHere\n$$\nH(z) = \\frac{1}{1 - 0.5 z^{-1} - 0.6 z^{-2}},\n$$\nso poles satisfy $1 - 0.5 z^{-1} - 0.6 z^{-2} = 0$. Multiplying by $z^{2}$ gives the characteristic polynomial\n$$\nz^{2} - 0.5 z - 0.6 = 0.\n$$\nThe discriminant is $\\Delta = ( -0.5 )^{2} - 4(1)(-0.6) = 0.25 + 2.4 = 2.65$. The roots are $z = \\frac{0.5 \\pm \\sqrt{2.65}}{2}$. The larger root is\n$$\nz_{+} = \\frac{0.5 + \\sqrt{2.65}}{2}.\n$$\nSince $\\sqrt{2.65} > \\sqrt{2.25} = 1.5$, it follows that $z_{+} > \\frac{0.5 + 1.5}{2} = 1$. Therefore at least one pole has $|z|>1$, so this system is not BIBO stable.\n\nD. $y[n] = x[n] - 1.05 y[n-2]$.\nHere\n$$\nH(z) = \\frac{1}{1 + 1.05 z^{-2}},\n$$\nso poles satisfy $1 + 1.05 z^{-2} = 0 \\Rightarrow z^{2} = -1.05$. Thus $|z| = \\sqrt{1.05} > 1$, so the poles are outside the unit circle and the system is not BIBO stable. Equivalently, the polynomial $z^{2} + 1.05$ fails the second-order Jury condition $|a_{2}|  a_{0}$ since $1.05 \\not 1$.\n\nE. $y[n] = x[n] - 0.5 x[n-1] + 1.1 y[n-1] - 0.5 y[n-2]$.\nHere\n$$\nH(z) = \\frac{1 - 0.5 z^{-1}}{1 - 1.1 z^{-1} + 0.5 z^{-2}},\n$$\nso the characteristic polynomial is\n$$\nz^{2} - 1.1 z + 0.5 = 0.\n$$\nIts discriminant is $1.21 - 2 = -0.79  0$, so roots are complex conjugates. The product of the roots is $0.5$, hence if the roots are $r \\exp(\\pm i\\theta)$, then $r^{2} = 0.5$ and $r = \\sqrt{0.5}  1$. Therefore both poles lie strictly inside the unit circle, and the system is BIBO stable. The Jury conditions also confirm stability:\n$|0.5|  1$, $1 - 1.1 + 0.5 = 0.4 > 0$, and $1 - (-1.1) + 0.5 = 2.6 > 0$.\n\nTherefore, the BIBO stable systems among the options are B and E.", "answer": "$$\\boxed{BE}$$", "id": "1728934"}]}