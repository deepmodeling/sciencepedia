{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we start with the simplest and most intuitive wavelet system: the Haar wavelet. The Haar transform breaks a signal down by calculating local averages (approximations) and differences (details). This exercise will walk you through the fundamental mechanics of the one-level Discrete Wavelet Transform (DWT), from analysis to synthesis, giving you a concrete understanding of how signals are decomposed and reconstructed. You will also see firsthand how manipulating coefficients in the wavelet domain directly impacts the final signal, a core concept in wavelet-based signal processing.", "problem": "In a signal processing application, a simple manipulation of wavelet coefficients is explored. Consider a discrete-time signal of length four, given by $x[n] = \\{3, 1, 4, 0\\}$. The signal undergoes a three-step process: analysis, manipulation, and synthesis.\n\n**Step 1: Analysis**\nThe signal is analyzed using a single-level Haar Discrete Wavelet Transform (DWT). The transform is applied to non-overlapping, adjacent pairs of signal values. For a generic pair $(s_a, s_b)$, the transformation yields one approximation coefficient $c_A$ and one detail coefficient $c_D$, defined as:\n$$c_A = \\frac{s_a + s_b}{\\sqrt{2}}$$\n$$c_D = \\frac{s_a - s_b}{\\sqrt{2}}$$\nApplying this to the signal $x[n]$ results in a set of two approximation coefficients, $cA_1$, and a set of two detail coefficients, $cD_1$.\n\n**Step 2: Manipulation**\nIn the transform domain, the two calculated detail coefficients are swapped. The approximation coefficients remain unchanged.\n\n**Step 3: Synthesis**\nA new signal, $\\hat{x}[n]$, is synthesized from the original approximation coefficients and the swapped detail coefficients by applying the inverse Haar DWT. The inverse transformation to reconstruct an original pair $(s_a, s_b)$ from a corresponding pair $(c_A, c_D)$ is given by:\n$$s_a = \\frac{c_A + c_D}{\\sqrt{2}}$$\n$$s_b = \\frac{c_A - c_D}{\\sqrt{2}}$$\n\nDetermine the reconstructed signal $\\hat{x}[n]$.", "solution": "We are given the single-level Haar DWT on adjacent, non-overlapping pairs and its inverse. For a pair $(s_{a},s_{b})$, the analysis coefficients are\n$$\nc_{A}=\\frac{s_{a}+s_{b}}{\\sqrt{2}},\\quad c_{D}=\\frac{s_{a}-s_{b}}{\\sqrt{2}},\n$$\nand the inverse synthesis is\n$$\ns_{a}=\\frac{c_{A}+c_{D}}{\\sqrt{2}},\\quad s_{b}=\\frac{c_{A}-c_{D}}{\\sqrt{2}}.\n$$\n\nStep 1 (Analysis): Split $x[n]=\\{3,1,4,0\\}$ into pairs $(3,1)$ and $(4,0)$.\n- For $(3,1)$:\n$$\nc_{A,1}=\\frac{3+1}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2},\\quad\nc_{D,1}=\\frac{3-1}{\\sqrt{2}}=\\frac{2}{\\sqrt{2}}=\\sqrt{2}.\n$$\n- For $(4,0)$:\n$$\nc_{A,2}=\\frac{4+0}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2},\\quad\nc_{D,2}=\\frac{4-0}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2}.\n$$\n\nStep 2 (Manipulation): Swap the two detail coefficients while keeping approximation coefficients unchanged:\n$$\n\\tilde{c}_{D,1}=c_{D,2}=2\\sqrt{2},\\quad \\tilde{c}_{D,2}=c_{D,1}=\\sqrt{2},\\quad c_{A,1}=2\\sqrt{2},\\quad c_{A,2}=2\\sqrt{2}.\n$$\n\nStep 3 (Synthesis): Reconstruct each pair using the inverse formulas.\n- From $(c_{A,1},\\tilde{c}_{D,1})=(2\\sqrt{2},2\\sqrt{2})$:\n$$\n\\hat{s}_{a,1}=\\frac{2\\sqrt{2}+2\\sqrt{2}}{\\sqrt{2}}=\\frac{4\\sqrt{2}}{\\sqrt{2}}=4,\\quad\n\\hat{s}_{b,1}=\\frac{2\\sqrt{2}-2\\sqrt{2}}{\\sqrt{2}}=0.\n$$\n- From $(c_{A,2},\\tilde{c}_{D,2})=(2\\sqrt{2},\\sqrt{2})$:\n$$\n\\hat{s}_{a,2}=\\frac{2\\sqrt{2}+\\sqrt{2}}{\\sqrt{2}}=\\frac{3\\sqrt{2}}{\\sqrt{2}}=3,\\quad\n\\hat{s}_{b,2}=\\frac{2\\sqrt{2}-\\sqrt{2}}{\\sqrt{2}}=\\frac{\\sqrt{2}}{\\sqrt{2}}=1.\n$$\n\nTherefore, the reconstructed signal is $\\hat{x}[n]=\\{4,0,3,1\\}$.", "answer": "$$\\boxed{\\begin{pmatrix}4 & 0 & 3 & 1\\end{pmatrix}}$$", "id": "1731109"}, {"introduction": "Now that you have practiced the mechanics of the DWT, let's build a deeper intuition for what the wavelet coefficients truly represent. The detail coefficients are designed to capture the \"change\" or high-frequency information within a signal. This exercise challenges you to think in reverse: what kind of signal produces zero detail? By constructing such a signal, you will solidify your understanding of how the Haar wavelet's high-pass filter operates and discover the specific signal property that makes it \"smooth\" or \"low-frequency\" from the wavelet's perspective.", "problem": "In the analysis of discrete signals, the Discrete Wavelet Transform (DWT) is a powerful tool for representing a signal in terms of its localized characteristics. It decomposes a signal into approximation (low-frequency) and detail (high-frequency) components.\n\nConsider a simple, real-valued, four-point signal $x[n]$ defined for $n = 0, 1, 2, 3$. The first-level DWT decomposition of this signal using the Haar wavelet system splits the signal into a two-point approximation-coefficient signal $a_1[k]$ and a two-point detail-coefficient signal $d_1[k]$, for $k=0,1$.\n\nThe decomposition is performed using a low-pass filter $h[n]$ and a high-pass filter $g[n]$. For the Haar wavelet system, these filters are defined as:\n$$h[n] = \\begin{cases} 1/\\sqrt{2} & n=0, 1 \\\\ 0 & \\text{otherwise} \\end{cases}$$\n$$g[n] = \\begin{cases} 1/\\sqrt{2} & n=0 \\\\ -1/\\sqrt{2} & n=1 \\\\ 0 & \\text{otherwise} \\end{cases}$$\n\nThe approximation and detail coefficients are calculated using the standard analysis equations:\n$$a_1[k] = \\sum_{m} x[m] h[m - 2k]$$\n$$d_1[k] = \\sum_{m} x[m] g[m - 2k]$$\n\nWhich one of the following options provides an example of a non-zero signal $x[n]$ for which **all** first-level detail coefficients $d_1[k]$ are zero, and correctly describes the general property that any such signal must possess at this level of decomposition?\n\nA. Signal: $\\{2, 2, -4, -4\\}$. Property: The signal is piecewise constant over non-overlapping two-sample blocks.\n\nB. Signal: $\\{1, 2, 4, 8\\}$. Property: The signal exhibits exponential growth.\n\nC. Signal: $\\{3, 3, 3, 3\\}$. Property: The signal must be a constant DC signal across its entire length.\n\nD. Signal: $\\{1, 3, 3, 1\\}$. Property: The signal must be symmetric (palindromic).\n\nE. Signal: $\\{5, -5, 5, -5\\}$. Property: The signal is purely oscillatory and its average value is zero.", "solution": "The first-level Haar DWT detail coefficients are computed as\n$$\nd_{1}[k]=\\sum_{m}x[m]\\,g[m-2k],\n$$\nwith the given $g[n]$ such that $g[0]=\\frac{1}{\\sqrt{2}}$, $g[1]=-\\frac{1}{\\sqrt{2}}$, and $g[n]=0$ otherwise.\n\nFor $k=0$,\n$$\nd_{1}[0]=\\sum_{m}x[m]\\,g[m]=x[0]g[0]+x[1]g[1]=\\frac{1}{\\sqrt{2}}x[0]-\\frac{1}{\\sqrt{2}}x[1]=\\frac{x[0]-x[1]}{\\sqrt{2}}.\n$$\nFor $k=1$,\n$$\nd_{1}[1]=\\sum_{m}x[m]\\,g[m-2]=x[2]g[0]+x[3]g[1]=\\frac{1}{\\sqrt{2}}x[2]-\\frac{1}{\\sqrt{2}}x[3]=\\frac{x[2]-x[3]}{\\sqrt{2}}.\n$$\nThus, all first-level detail coefficients are zero if and only if\n$$\nd_{1}[0]=0 \\;\\;\\Longleftrightarrow\\;\\; x[0]=x[1],\\qquad d_{1}[1]=0 \\;\\;\\Longleftrightarrow\\;\\; x[2]=x[3].\n$$\nTherefore, the necessary and sufficient condition is that the signal is piecewise constant on the non-overlapping two-sample blocks $\\{x[0],x[1]\\}$ and $\\{x[2],x[3]\\}$; the two blocks need not have the same constant value.\n\nNow check the options:\n- A: $\\{2,2,-4,-4\\}$ gives $d_{1}[0]=\\frac{2-2}{\\sqrt{2}}=0$ and $d_{1}[1]=\\frac{-4-(-4)}{\\sqrt{2}}=0$, and its stated property matches the derived condition.\n- B: $\\{1,2,4,8\\}$ yields $d_{1}[0]=\\frac{1-2}{\\sqrt{2}}\\neq 0$, so it fails.\n- C: $\\{3,3,3,3\\}$ yields zero details, but the stated property “must be constant across entire length” is not necessary; it is only a special case of the true condition, so the description is incorrect.\n- D: $\\{1,3,3,1\\}$ yields $d_{1}[0]=\\frac{1-3}{\\sqrt{2}}\\neq 0$, so it fails and the property is not the general condition.\n- E: $\\{5,-5,5,-5\\}$ yields $d_{1}[0]=\\frac{5-(-5)}{\\sqrt{2}}\\neq 0$, so it fails.\n\nThus, the correct choice is A, and the correct general property is that the signal is constant within each two-sample block at this level.", "answer": "$$\\boxed{A}$$", "id": "1731140"}, {"introduction": "We now shift our focus from theory to one of the most powerful applications of wavelet transforms: signal compression. The efficiency of compression hinges on a principle called energy compaction, where a transform concentrates most of the signal's energy into just a few coefficients. This exercise demonstrates that not all wavelets are created equal; the choice of wavelet should match the characteristics of the signal. By comparing the performance of the blocky Haar wavelet against the smoother Daubechies wavelet on a smooth Gaussian signal, you will quantitatively measure their ability to capture signal energy and gain crucial insight into designing effective wavelet-based applications [@problem_id:1731106].", "problem": "An important application of the Discrete Wavelet Transform (DWT) in signal processing is compression, which relies on the principle of energy compaction. A transform provides good energy compaction for a signal if it can represent the signal's energy using only a small number of large-magnitude coefficients.\n\nConsider a discrete-time signal `x[n]` of length `N=8` that represents a sampled Gaussian pulse. The values of the signal are given as:\n`x = [0.00219, 0.04393, 0.32465, 0.88250, 0.88250, 0.32465, 0.04393, 0.00219]`\n\nA single-level DWT decomposes this signal into a set of approximation coefficients `cA` and a set of detail coefficients `cD`. The approximation coefficients are obtained by convolving the signal with a low-pass filter `h` and then downsampling by a factor of 2. The convolution should be performed using periodic boundary conditions (also known as circular convolution).\n\nWe wish to compare the energy compaction performance of two different wavelets for this signal: the Haar wavelet and the Daubechies 4-tap (D4) wavelet. The respective low-pass filter coefficients `h` are given below.\n- Haar filter: `h_Haar = [0.70711, 0.70711]`\n- Daubechies 4-tap (D4) filter: `h_D4 = [0.48296, 0.83652, 0.22414, -0.12941]`\n\nThe energy contained in a set of coefficients is the sum of the squared magnitudes of the coefficients. Let `E_Haar` be the energy of the approximation coefficients `cA` obtained using the Haar filter, and let `E_D4` be the energy of the approximation coefficients `cA` obtained using the D4 filter.\n\nCalculate the ratio `R = E_D4 / E_Haar`. Round your final answer to four significant figures.", "solution": "We are given a length-$N=8$ real-valued discrete-time signal $x[n]$ with periodic boundary conditions (circular convolution) and two low-pass analysis filters $h_{\\text{Haar}}$ and $h_{\\text{D4}}$. A single-level DWT approximation sequence $cA$ is obtained by circular convolution of $x[n]$ with $h[m]$ followed by downsampling by $2$. Using the standard discrete circular convolution,\n$$\ny_{h}[n] = \\sum_{m=0}^{L-1} h[m]\\,x[(n-m)\\bmod N],\\quad cA[k] = y_{h}[2k],\\quad k=0,1,2,3.\n$$\nThe given signal values are\n$$\nx[0]=0.00219,\\;x[1]=0.04393,\\;x[2]=0.32465,\\;x[3]=0.88250,\\;x[4]=0.88250,\\;x[5]=0.32465,\\;x[6]=0.04393,\\;x[7]=0.00219.\n$$\n\nHaar case: $h_{\\text{Haar}}[0]=0.70711$, $h_{\\text{Haar}}[1]=0.70711$. The circular convolution is\n$$\ny_{\\text{Haar}}[n]=0.70711\\,x[n]+0.70711\\,x[n-1].\n$$\nDownsampling at even indices gives\n$$\n\\begin{aligned}\ncA_{\\text{Haar}}[0]&=y_{\\text{Haar}}[0]=0.70711\\,(x[0]+x[7])=0.70711\\cdot(0.00219+0.00219)=0.0030971418,\\\\\ncA_{\\text{Haar}}[1]&=y_{\\text{Haar}}[2]=0.70711\\,(x[2]+x[1])=0.70711\\cdot(0.32465+0.04393)=0.2606266038,\\\\\ncA_{\\text{Haar}}[2]&=y_{\\text{Haar}}[4]=0.70711\\,(x[4]+x[3])=0.70711\\cdot(0.88250+0.88250)=1.24804915,\\\\\ncA_{\\text{Haar}}[3]&=y_{\\text{Haar}}[6]=0.70711\\,(x[6]+x[5])=0.70711\\cdot(0.04393+0.32465)=0.2606266038.\n\\end{aligned}\n$$\nHence the approximation energy is\n$$\n\\begin{aligned}\nE_{\\text{Haar}}&=\\sum_{k=0}^{3}\\bigl(cA_{\\text{Haar}}[k]\\bigr)^{2}\\\\\n&=(0.0030971418)^{2}+(0.2606266038)^{2}+(1.24804915)^{2}+(0.2606266038)^{2}\\\\\n&=9.592287329\\times 10^{-6}+0.067926226608322+1.5576266808157225+0.067926226608322\\\\\n&\\approx 1.6934887263196955.\n\\end{aligned}\n$$\n\nDaubechies-4 case: $h_{\\text{D4}}[0]=0.48296$, $h_{\\text{D4}}[1]=0.83652$, $h_{\\text{D4}}[2]=0.22414$, $h_{\\text{D4}}[3]=-0.12941$. The circular convolution at even indices gives\n$$\n\\begin{aligned}\ny_{\\text{D4}}[0]&=0.48296\\,x[0]+0.83652\\,x[-1]+0.22414\\,x[-2]-0.12941\\,x[-3]\\\\\n&=0.48296\\,x[0]+0.83652\\,x[7]+0.22414\\,x[6]-0.12941\\,x[5]\\\\\n&=0.48296\\cdot 0.00219+0.83652\\cdot 0.00219+0.22414\\cdot 0.04393-0.12941\\cdot 0.32465\\\\\n&=0.0010576824+0.0018319788+0.0098464702-0.0420129565\\\\\n&=-0.0292768251,\\\\[6pt]\ny_{\\text{D4}}[2]&=0.48296\\,x[2]+0.83652\\,x[1]+0.22414\\,x[0]-0.12941\\,x[7]\\\\\n&=0.48296\\cdot 0.32465+0.83652\\cdot 0.04393+0.22414\\cdot 0.00219-0.12941\\cdot 0.00219\\\\\n&=0.156792964+0.0367483236+0.0004908666-0.0002834079\\\\\n&=0.1937487463,\\\\[6pt]\ny_{\\text{D4}}[4]&=0.48296\\,x[4]+0.83652\\,x[3]+0.22414\\,x[2]-0.12941\\,x[1]\\\\\n&=0.48296\\cdot 0.88250+0.83652\\cdot 0.88250+0.22414\\cdot 0.32465-0.12941\\cdot 0.04393\\\\\n&=0.4262122+0.7382289+0.072767051-0.0056849813\\\\\n&=1.2315231697,\\\\[6pt]\ny_{\\text{D4}}[6]&=0.48296\\,x[6]+0.83652\\,x[5]+0.22414\\,x[4]-0.12941\\,x[3]\\\\\n&=0.48296\\cdot 0.04393+0.83652\\cdot 0.32465+0.22414\\cdot 0.88250-0.12941\\cdot 0.88250\\\\\n&=0.0212164328+0.271576218+0.19780355-0.114204325\\\\\n&=0.3763918758.\n\\end{aligned}\n$$\nThus $cA_{\\text{D4}}=[-0.0292768251,\\;0.1937487463,\\;1.2315231697,\\;0.3763918758]$ and the approximation energy is\n$$\n\\begin{aligned}\nE_{\\text{D4}}&=\\sum_{k=0}^{3}\\bigl(cA_{\\text{D4}}[k]\\bigr)^{2}\\\\\n&=(-0.0292768251)^{2}+(0.1937487463)^{2}+(1.2315231697)^{2}+(0.3763918758)^{2}\\\\\n&=0.000857132487936+0.03753857669282176+1.516649317508+0.1416708441682426\\\\\n&\\approx 1.6967158708570004.\n\\end{aligned}\n$$\n\nThe desired ratio is\n$$\nR=\\frac{E_{\\text{D4}}}{E_{\\text{Haar}}}=\\frac{1.6967158708570004}{1.6934887263196955}\\approx 1.001905616.\n$$\nRounding to four significant figures gives\n$$\nR\\approx 1.002.\n$$", "answer": "$$\\boxed{1.002}$$", "id": "1731106"}]}