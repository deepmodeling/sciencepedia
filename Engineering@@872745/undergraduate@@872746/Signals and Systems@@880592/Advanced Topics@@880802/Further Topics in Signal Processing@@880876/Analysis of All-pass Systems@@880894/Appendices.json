{"hands_on_practices": [{"introduction": "The journey into understanding all-pass systems often begins with their fundamental mathematical representations. While the transfer function $H(z)$ is a powerful tool for analysis, systems are frequently described by the difference equations that govern their input-output relationship. This first practice [@problem_id:1696641] provides a foundational exercise in bridging these two descriptions, asking you to derive the transfer function from a difference equation and then test for the defining characteristic of an all-pass system: a magnitude response that remains constant across all frequencies.", "problem": "A causal, discrete-time Linear Time-Invariant (LTI) system is designed as a simple phase equalizer. It relates the output signal $y[n]$ to the input signal $x[n]$ through the following difference equation:\n\n$$y[n] - 0.25y[n-1] = x[n-1] - 0.25x[n]$$\n\nYour task is to determine the transfer function $H(z) = Y(z)/X(z)$ of this system and to classify whether it is an all-pass system. An all-pass system is defined as a system whose frequency response magnitude is constant for all frequencies.\n\nWhich one of the following statements accurately describes the system?\n\nA. The transfer function is $H(z) = \\frac{z^{-1} - 0.25}{1 - 0.25z^{-1}}$, and the system is an all-pass system.\n\nB. The transfer function is $H(z) = \\frac{z^{-1} - 0.25}{1 - 0.25z^{-1}}$, and the system is not an all-pass system.\n\nC. The transfer function is $H(z) = \\frac{1 - 0.25z^{-1}}{z^{-1} - 0.25}$, and the system is an all-pass system.\n\nD. The transfer function is $H(z) = \\frac{z - 0.25}{1 - 0.25z}$, and the system is not an all-pass system.\n\nE. The transfer function is $H(z) = \\frac{z^{-1} + 0.25}{1 + 0.25z^{-1}}$, and the system is not an all-pass system.", "solution": "Start from the given causal LTI difference equation:\n$$\ny[n]-\\frac{1}{4}y[n-1]=x[n-1]-\\frac{1}{4}x[n].\n$$\nTaking the $z$-transform of both sides under zero initial conditions and using linearity and the shift property $\\mathcal{Z}\\{x[n-k]\\}=z^{-k}X(z)$ gives\n$$\nY(z)-\\frac{1}{4}z^{-1}Y(z)=z^{-1}X(z)-\\frac{1}{4}X(z).\n$$\nFactor $Y(z)$ and $X(z)$ to obtain\n$$\n\\bigl(1-\\tfrac{1}{4}z^{-1}\\bigr)Y(z)=\\bigl(z^{-1}-\\tfrac{1}{4}\\bigr)X(z).\n$$\nHence the transfer function is\n$$\nH(z)\\equiv\\frac{Y(z)}{X(z)}=\\frac{z^{-1}-\\tfrac{1}{4}}{1-\\tfrac{1}{4}z^{-1}}.\n$$\nTo test the all-pass property, evaluate the frequency response on the unit circle $z=\\exp(j\\omega)$:\n$$\nH\\bigl(\\exp(j\\omega)\\bigr)=\\frac{\\exp(-j\\omega)-\\tfrac{1}{4}}{1-\\tfrac{1}{4}\\exp(-j\\omega)}.\n$$\nCompute the squared magnitude:\n$$\n\\left|H\\bigl(\\exp(j\\omega)\\bigr)\\right|^{2}\n= \\frac{\\left(\\exp(-j\\omega)-\\tfrac{1}{4}\\right)\\left(\\exp(j\\omega)-\\tfrac{1}{4}\\right)}{\\left(1-\\tfrac{1}{4}\\exp(-j\\omega)\\right)\\left(1-\\tfrac{1}{4}\\exp(j\\omega)\\right)}.\n$$\nExpand numerator and denominator:\n$$\n\\left(\\exp(-j\\omega)-\\tfrac{1}{4}\\right)\\left(\\exp(j\\omega)-\\tfrac{1}{4}\\right)\n= 1-\\tfrac{1}{4}\\exp(j\\omega)-\\tfrac{1}{4}\\exp(-j\\omega)+\\left(\\tfrac{1}{4}\\right)^{2},\n$$\n$$\n\\left(1-\\tfrac{1}{4}\\exp(-j\\omega)\\right)\\left(1-\\tfrac{1}{4}\\exp(j\\omega)\\right)\n= 1-\\tfrac{1}{4}\\exp(j\\omega)-\\tfrac{1}{4}\\exp(-j\\omega)+\\left(\\tfrac{1}{4}\\right)^{2}.\n$$\nSince numerator and denominator are identical, it follows that\n$$\n\\left|H\\bigl(\\exp(j\\omega)\\bigr)\\right|=1 \\quad \\text{for all } \\omega.\n$$\nTherefore the system is all-pass. Comparing with the options, the correct statement is that $H(z)=\\frac{z^{-1}-0.25}{1-0.25z^{-1}}$ and the system is an all-pass system.", "answer": "$$\\boxed{A}$$", "id": "1696641"}, {"introduction": "Having established how to identify an all-pass system, we now turn to its primary function: altering a signal's phase without affecting its amplitude. The group delay, $\\tau_g(\\omega)$, is a crucial concept that quantifies this phase-shifting behavior by measuring the time delay experienced by different frequency components. This exercise [@problem_id:1696624] focuses on calculating the group delay for a canonical first-order all-pass filter, providing direct insight into how the filter's internal structure influences its temporal characteristics.", "problem": "A first-order all-pass filter is a fundamental component in digital signal processing, frequently employed for phase equalization in audio systems. Consider such a stable, causal, discrete-time Linear Time-Invariant (LTI) system with a real-valued pole, described by the transfer function $H(z)$:\n$$H(z) = -\\frac{z^{-1}-a}{1-az^{-1}}$$\nHere, $a$ is a real-valued constant such that $|a| < 1$.\n\nThe group delay, denoted by $\\tau_g(\\omega)$, characterizes the delay experienced by different frequency components of a signal passing through the filter. It is defined as the negative rate of change of the filter's phase response, $\\theta(\\omega) = \\arg\\{H(e^{j\\omega})\\}$, with respect to the angular frequency $\\omega$. Mathematically,\n$$\\tau_g(\\omega) = -\\frac{d\\theta(\\omega)}{d\\omega}$$\nwhere $H(e^{j\\omega})$ is the frequency response of the system.\n\nCalculate the group delay of this all-pass filter at zero frequency (i.e., for $\\omega = 0$). Your final answer should be a symbolic expression in terms of the constant $a$.", "solution": "We are given the stable, causal, discrete-time LTI all-pass filter\n$$H(z) = -\\frac{z^{-1}-a}{1-az^{-1}}, \\quad |a|<1,$$\nand we need the group delay at zero frequency, defined by\n$$\\tau_{g}(\\omega) = -\\frac{d\\theta(\\omega)}{d\\omega}, \\quad \\theta(\\omega) = \\arg\\{H(e^{j\\omega})\\}.$$\nUsing the general identity for a complex frequency response,\n$$\\frac{d\\theta(\\omega)}{d\\omega} = \\Im\\left\\{\\frac{d}{d\\omega}\\ln H(e^{j\\omega})\\right\\},$$\nthe group delay becomes\n$$\\tau_{g}(\\omega) = -\\Im\\left\\{\\frac{d}{d\\omega}\\ln H(e^{j\\omega})\\right\\}.$$\n\nSubstitute $z=e^{j\\omega}$, so $z^{-1}=u=e^{-j\\omega}$, and write\n$$H(e^{j\\omega}) = H(u) = -\\frac{u - a}{1 - a u}.$$\nDifferentiate $H(u)$ with respect to $u$ using the quotient rule. Let $f(u)=u-a$ and $g(u)=1-au$, so $H(u)=-f(u)/g(u)$, $f'(u)=1$, and $g'(u)=-a$. Then\n$$\\frac{dH}{du} = -\\frac{f'(u)g(u) - f(u)g'(u)}{g(u)^{2}} = -\\frac{(1)(1-au) - (u-a)(-a)}{(1-au)^{2}} = -\\frac{1 - a^{2}}{(1 - a u)^{2}}.$$\nNext, use the chain rule with $u=e^{-j\\omega}$, so $\\frac{du}{d\\omega} = -j u$. Therefore,\n$$\\frac{d}{d\\omega}\\ln H(e^{j\\omega}) = \\frac{1}{H(u)}\\frac{dH}{du}\\frac{du}{d\\omega} = \\frac{1}{H(u)}\\left(-\\frac{1 - a^{2}}{(1 - a u)^{2}}\\right)(-j u) = -j\\,u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}}.$$\nHence,\n$$\\tau_{g}(\\omega) = -\\Im\\left\\{-j\\,u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}}\\right\\} = \\Re\\left\\{u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}}\\right\\},$$\nsince for any complex $Y$, $\\Im\\{-jY\\}=-\\Re\\{Y\\}$.\n\nNow compute $1/H(u)$. From $H(u) = -\\frac{u-a}{1-au}$, we have\n$$\\frac{1}{H(u)} = -\\frac{1-au}{u-a}.$$\nThus,\n$$u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}} = u\\left(-\\frac{1-au}{u-a}\\right)\\frac{1 - a^{2}}{(1 - a u)^{2}} = \\frac{u(1 - a^{2})}{(1 - a u)(u - a)}.$$\nTherefore,\n$$\\tau_{g}(\\omega) = \\Re\\left\\{\\frac{u(1 - a^{2})}{(1 - a u)(u - a)}\\right\\}, \\quad u=e^{-j\\omega}.$$\n\nAt zero frequency, $\\omega=0$ implies $u=e^{-j\\cdot 0}=1$. Substituting $u=1$ yields\n$$\\tau_{g}(0) = \\Re\\left\\{\\frac{1\\cdot(1 - a^{2})}{(1 - a\\cdot 1)(1 - a)}\\right\\} = \\frac{1 - a^{2}}{(1 - a)^{2}} = \\frac{(1 - a)(1 + a)}{(1 - a)^{2}} = \\frac{1 + a}{1 - a}.$$\nBecause $a$ is real with $|a|<1$, the expression is real and finite, and the overall constant factor of $-1$ in $H(z)$ contributes only a constant phase shift and does not affect the group delay.", "answer": "$$\\boxed{\\frac{1+a}{1-a}}$$", "id": "1696624"}, {"introduction": "Analysis and design are two sides of the same coin in engineering. Moving from pure analysis, this practice [@problem_id:1696675] presents a design-oriented challenge that simulates a real-world application, such as phase equalization in audio systems. You will determine the valid range for a filter's design parameter, $a$, required to meet a specific phase shift specification, directly linking the system's internal coefficients to its frequency-domain performance.", "problem": "In the design of a digital phase equalizer for audio processing, a first-order all-pass filter is often used to manipulate the phase response of a signal without altering its magnitude spectrum. Consider such a filter with the discrete-time transfer function in the Z-domain given by:\n$$H(z) = \\frac{z^{-1} - a}{1 - az^{-1}}$$\nFor the filter to be stable, the real-valued coefficient $a$ is restricted to the interval $(-1, 1)$. The frequency response of the filter is obtained by evaluating $H(z)$ on the unit circle, $z = e^{j\\omega}$, where $\\omega$ is the normalized angular frequency in radians per sample.\n\nA specific design requirement dictates that the filter must produce a phase shift, $\\phi(\\omega)$, whose magnitude is greater than $120$ degrees at the normalized angular frequency of $\\omega_0 = \\pi/2$ radians per sample.\n\nWhich of the following ranges for the parameter $a$ satisfies this design constraint?\n\nA. $(-1, -2+\\sqrt{3})$\n\nB. $(0, 2-\\sqrt{3})$\n\nC. $(2-\\sqrt{3}, 1)$\n\nD. $(1/\\sqrt{3}, 1)$\n\nE. $(-1, 0)$", "solution": "The filter is first-order all-pass with transfer function $H(z) = \\frac{z^{-1} - a}{1 - a z^{-1}}$ and stability constraint $a \\in (-1, 1)$. Its frequency response is obtained by substituting $z = \\exp(j\\omega)$. At the specified frequency $\\omega_{0} = \\frac{\\pi}{2}$,\n$$\nH\\!\\left(\\exp(j\\omega_{0})\\right) = \\frac{\\exp(-j\\pi/2) - a}{1 - a \\exp(-j\\pi/2)} = \\frac{-j - a}{1 + a j} = \\frac{-a - j}{1 + a j}.\n$$\nTo express this in rectangular form, multiply numerator and denominator by the complex conjugate of the denominator:\n$$\nH\\!\\left(\\exp(j\\omega_{0})\\right) = \\frac{(-a - j)(1 - a j)}{1 + a^{2}}.\n$$\nExpanding the numerator gives\n$$\n(-a - j)(1 - a j) = -a + a^{2} j - j + a j^{2} = -2a + (a^{2} - 1)j,\n$$\nhence\n$$\nH\\!\\left(\\exp(j\\omega_{0})\\right) = \\frac{-2a}{1 + a^{2}} + j\\,\\frac{a^{2} - 1}{1 + a^{2}}.\n$$\nTherefore, the phase at $\\omega_{0}$ is $\\phi(\\omega_{0}) = \\arg H$ with\n$$\n\\tan\\big(\\phi(\\omega_{0})\\big) = \\frac{\\Im\\{H\\}}{\\Re\\{H\\}} = \\frac{a^{2} - 1}{-2a} = \\frac{1 - a^{2}}{2a}.\n$$\nFor $a \\in (-1, 0)$, $\\Re\\{H\\} > 0$ and $\\Im\\{H\\} < 0$, so $\\phi(\\omega_{0}) \\in \\left(-\\frac{\\pi}{2}, 0\\right)$ and cannot satisfy $|\\phi(\\omega_{0})| > \\frac{2\\pi}{3}$. For $a \\in (0, 1)$, $\\Re\\{H\\} < 0$ and $\\Im\\{H\\} < 0$, so $\\phi(\\omega_{0}) \\in \\left(-\\pi, -\\frac{\\pi}{2}\\right)$, and we can enforce the design constraint\n$$\n|\\phi(\\omega_{0})| > \\frac{2\\pi}{3} \\quad\\Longleftrightarrow\\quad \\phi(\\omega_{0}) < -\\frac{2\\pi}{3}.\n$$\nIn the third quadrant, $\\tan$ is positive and strictly increasing, so the threshold for equality is obtained from\n$$\n\\tan\\big(\\phi(\\omega_{0})\\big) = \\tan\\!\\left(-\\frac{2\\pi}{3}\\right) = \\sqrt{3}.\n$$\nThus, for $a>0$ we solve\n$$\n\\frac{1 - a^{2}}{2a} = \\sqrt{3} \\;\\;\\Longleftrightarrow\\;\\; 1 - a^{2} = 2\\sqrt{3}\\,a \\;\\;\\Longleftrightarrow\\;\\; a^{2} + 2\\sqrt{3}\\,a - 1 = 0.\n$$\nSolving the quadratic gives\n$$\na = -\\sqrt{3} \\pm 2.\n$$\nThe admissible solution in $(0, 1)$ is $a = 2 - \\sqrt{3}$. Since $\\phi(\\omega_{0})$ decreases monotonically from $-\\frac{\\pi}{2}$ to $-\\pi$ as $a$ increases from $0$ to $1$, the strict inequality $|\\phi(\\omega_{0})| > \\frac{2\\pi}{3}$ holds precisely for\n$$\na \\in \\big(2 - \\sqrt{3},\\,1\\big).\n$$\nAmong the given options, this is option C.", "answer": "$$\\boxed{C}$$", "id": "1696675"}]}