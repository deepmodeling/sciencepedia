{"hands_on_practices": [{"introduction": "The second Noble Identity provides a powerful rule for optimizing multirate systems by swapping the order of filtering and upsampling. This practice exercise challenges you to apply this identity to a concrete system redesign scenario. By determining the new filter transfer function, you will gain hands-on experience with the transformation $H(z) = G(z^L)$, a cornerstone of efficient multirate structures. [@problem_id:1737867]", "problem": "In the field of digital signal processing, multirate systems are often used to change the sampling rate of a signal. Consider a discrete-time signal processing architecture, which we will call System 1. In this system, an input signal $x[n]$ with Z-transform $X(z)$ is first processed by a Finite Impulse Response (FIR) filter with a transfer function given by $G(z) = 1 + 2z^{-1} + z^{-2}$. The output of this filter is then upsampled by a factor of $L=2$ to produce an output signal $y_1[n]$. Upsampling by a factor $L$ is a process where $L-1$ zeros are inserted between each sample of the sequence to be upsampled.\n\nFor hardware implementation reasons, a system redesign is necessary. In the new design, called System 2, the order of operations is reversed. The same input signal $x[n]$ is first upsampled by the same factor of $L=2$. This upsampled signal is then passed through a new FIR filter with a transfer function $H(z)$ to produce an output signal $y_2[n]$.\n\nDetermine the transfer function $H(z)$ of the new filter that ensures System 2 is functionally equivalent to System 1 for any arbitrary input signal $x[n]$. Your answer should be an expression for $H(z)$ in terms of powers of $z^{-1}$.", "solution": "Let $x[n]$ have $Z$-transform $X(z)$ and let $G(z)=1+2z^{-1}+z^{-2}$. Filtering by an LTI system with transfer function $G(z)$ yields $V(z)=G(z)X(z)$. Upsampling by a factor $L$ inserts $L-1$ zeros between samples; if $u[n]$ is obtained by upsampling $v[n]$ by $L$, then its $Z$-transform satisfies $U(z)=V(z^{L})$. Therefore, in System 1 (filter then upsample by $2$),\n$$\nY_{1}(z)=V(z^{2})=G(z^{2})X(z^{2}).\n$$\n\nIn System 2, upsampling is first: with $w[n]$ the upsampled version of $x[n]$ by $2$, we have\n$$\nW(z)=X(z^{2}).\n$$\nThen filtering by $H(z)$ gives\n$$\nY_{2}(z)=H(z)W(z)=H(z)X(z^{2}).\n$$\n\nFor functional equivalence for all input signals, we require $Y_{2}(z)=Y_{1}(z)$ for all $X(z)$, which implies\n$$\nH(z)=G(z^{2}).\n$$\nSubstituting $G(z)=1+2z^{-1}+z^{-2}$ yields\n$$\nH(z)=1+2z^{-2}+z^{-4}.\n$$\nThis also matches the time-domain view that moving the filter after the upsampler inserts $L-1$ zeros between the coefficients, i.e., $h[n]=g[n/2]$ for even $n$ and $0$ for odd $n$.", "answer": "$$\\boxed{1+2z^{-2}+z^{-4}}$$", "id": "1737867"}, {"introduction": "One of the primary motivations for using multirate signal processing is to reduce computational load by performing operations at lower sample rates. The first Noble Identity is crucial for this, as it allows a filter to be moved after a downsampler. This problem asks you to work backward, deriving the original filter from its more efficient, low-rate equivalent, which reinforces the identity $H(z) = G(z^M)$ and highlights its practical importance in designing efficient systems. [@problem_id:1737879]", "problem": "In digital signal processing, performing operations at a high sampling rate can be computationally expensive. A common strategy to improve efficiency is to rearrange operations. Consider a system where a discrete-time signal is first passed through a digital filter with a transfer function $H(z)$ and then downsampled by a factor of $M=4$. This process is known as decimation.\n\nTo reduce the computational load, an engineer proposes an alternative system that is functionally equivalent. In this new system, the same input signal is first downsampled by a factor of $M=4$, and the resulting lower-rate signal is then filtered by a much simpler filter with a transfer function given by $G(z) = 1 + z^{-1}$.\n\nAssuming the two systems produce identical output signals for any given input signal, determine the transfer function $H(z)$ of the filter in the original, computationally expensive configuration.", "solution": "Let the input signal be $x[n]$ and the final output signal be $y[n]$. We are given two equivalent systems that produce the same output $y[n]$ from the same input $x[n]$.\n\nSystem 1: A filter with transfer function $H(z)$ is followed by a decimator (downsampler) by a factor of $M=4$.\nThe signal after the filter $H(z)$ is $w[n]$, with its Z-transform being $W(z) = H(z)X(z)$.\nThe decimator then produces the output $y[n] = w[4n]$. The Z-transform of the output is given by\n$$Y(z) = \\frac{1}{4} \\sum_{k=0}^{3} W\\left(z^{1/4} \\exp\\left(-j\\frac{2\\pi k}{4}\\right)\\right) = \\frac{1}{4} \\sum_{k=0}^{3} H\\left(z^{1/4} e^{-j\\pi k/2}\\right) X\\left(z^{1/4} e^{-j\\pi k/2}\\right)$$\n\nSystem 2: A decimator by a factor of $M=4$ is followed by a filter with transfer function $G(z)$.\nThe signal after the decimator is $v[n] = x[4n]$. Its Z-transform is $V(z)$.\nThis signal is then filtered by $G(z)$. The Z-transform of the final output is $Y(z) = G(z)V(z)$.\nThe Z-transform of the downsampled signal $v[n]$ is related to the Z-transform of the original signal $x[n]$ by\n$$V(z) = \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} \\exp\\left(-j\\frac{2\\pi k}{4}\\right)\\right) = \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} e^{-j\\pi k/2}\\right)$$\nSo, the output of System 2 is\n$$Y(z) = G(z) \\left( \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} e^{-j\\pi k/2}\\right) \\right)$$\n\nFor the two systems to be equivalent, their outputs must be identical. This problem is a direct application of the first Noble Identity for multirate systems. This identity states that a filter $H(z)$ followed by a downsampler by $M$ is equivalent to a downsampler by $M$ followed by a filter $G(z)$ if and only if $H(z)$ is an $M$-th band filter, meaning its transfer function can be expressed as $H(z) = G(z^M)$.\n\nIn this problem, we have:\nThe downsampling factor $M = 4$.\nThe transfer function of the filter in the efficient system is $G(z) = 1 + z^{-1}$.\nThe transfer function of the filter in the original system is $H(z)$.\n\nAccording to the first Noble Identity, the relationship between the two filter transfer functions is:\n$$H(z) = G(z^M)$$\n\nSubstituting the given values of $M=4$ into this relationship, we get:\n$$H(z) = G(z^4)$$\n\nNow, we find $G(z^4)$ by replacing every occurrence of $z$ in the expression for $G(z)$ with $z^4$.\nGiven $G(z) = 1 + z^{-1}$, we have:\n$$G(z^4) = 1 + (z^4)^{-1}$$\n$$G(z^4) = 1 + z^{-4}$$\n\nTherefore, the transfer function of the filter in the original system is:\n$$H(z) = 1 + z^{-4}$$", "answer": "$$\\boxed{1 + z^{-4}}$$", "id": "1737879"}, {"introduction": "This advanced practice problem moves from simple block diagram manipulation to a real-world design challenge: creating a computationally efficient interference cancellation system. To solve this, you must not only apply principles related to the Noble Identities but also account for the frequency aliasing that occurs during downsampling. This exercise demonstrates how to design a low-rate filter to target a specific frequency in the original high-rate signal, a critical skill in software-defined radio and other advanced applications. [@problem_id:1737892]", "problem": "In modern software-defined radio systems, it is often necessary to remove strong, narrow-band interference. To minimize computational load, signal processing is frequently performed at the lowest possible sample rate.\n\nConsider a discrete-time signal that is contaminated by a powerful sinusoidal interference. The normalized angular frequency of this interference is known to be $\\omega_0 = \\frac{3\\pi}{8}$ radians/sample. To remove this interference, the signal is first passed through a decimator, which downsamples the signal by a factor of $M=5$. The resulting low-rate signal is then filtered by a stable, second-order Infinite Impulse Response (IIR) filter, $H(z)$.\n\nThis notch filter is designed to have a pair of complex-conjugate zeros on the unit circle, located at $z_{1,2} = e^{\\pm j\\theta_z}$, which are responsible for nullifying the interference. The filter's poles are located at $p_{1,2} = r e^{\\pm j\\theta_z}$ with a radius of $r=0.95$ to ensure stability while creating a sharp notch.\n\nYour task is to determine the fundamental positive angle $\\theta_z$ that defines the positions of the filter's zeros. Your answer should satisfy $0  \\theta_z  \\pi$. Express your final answer in radians.", "solution": "The interference in the original discrete-time signal has normalized angular frequency $\\omega_{0} = \\frac{3\\pi}{8}$ radians/sample. After decimation by a factor $M=5$, the downsampled sequence is $y[n] = x[nM]$. For a complex exponential component $x[n] = \\exp(j\\omega_{0} n)$, the decimated sequence becomes $y[n] = \\exp(j \\omega_{0} M n)$, which corresponds to a normalized angular frequency\n$$\n\\omega_{d} = M\\omega_{0} \\quad \\text{mod} \\; 2\\pi\n$$.\nTo place the notch of the IIR filter at the interference frequency present in the downsampled signal, we must map $\\omega_{d}$ into the principal interval $(-\\pi,\\pi]$:\n$$\n\\omega_{d} = \\left(M\\omega_{0} + 2\\pi k\\right) \\in (-\\pi,\\pi] \\quad \\text{for some} \\; k \\in \\mathbb{Z}\n$$.\nSubstituting $\\omega_{0} = \\frac{3\\pi}{8}$ and $M=5$ gives\n$$\nM\\omega_{0} = \\frac{15\\pi}{8}\n$$.\nChoosing $k=-1$ to fold into the interval $(-\\pi,\\pi]$,\n$$\n\\omega_{d} = \\frac{15\\pi}{8} - 2\\pi = \\frac{15\\pi}{8} - \\frac{16\\pi}{8} = -\\frac{\\pi}{8}\n$$.\nThe notch filter zeros must be located at $z_{1,2} = \\exp(\\pm j\\theta_{z})$ with a positive fundamental angle $\\theta_{z}$ in $(0,\\pi)$. Since the interference in the downsampled signal appears at $\\omega_{d} = -\\frac{\\pi}{8}$, the required positive angle is the magnitude\n$$\n\\theta_{z} = |\\omega_{d}| = \\frac{\\pi}{8}\n$$.\nThis choice places the zeros at the correct conjugate angles to eliminate the aliased interference. The pole radius $r=0.95$ determines the notch sharpness but does not affect the angle $\\theta_{z}$.", "answer": "$$\\boxed{\\frac{\\pi}{8}}$$", "id": "1737892"}]}