{"hands_on_practices": [{"introduction": "The defining characteristic of a Bessel filter is its maximally flat group delay, which ensures minimal waveform distortion in the passband. This first exercise provides foundational practice in quantifying this key property. By calculating the group delay at an angular frequency of $\\omega=0$ for a second-order Bessel filter, you will directly engage with the mathematical basis of its excellent time-domain performance [@problem_id:1282712].", "problem": "An analog filter is being designed for a high-fidelity audio system to remove high-frequency noise without distorting the phase of the audio signals in the passband. The chosen topology is a second-order low-pass Bessel filter, known for its maximally flat group delay characteristic. The filter's voltage transfer function, $H(s) = \\frac{V_{out}(s)}{V_{in}(s)}$, is given by:\n$$H(s) = \\frac{A}{s^2 + B s + C}$$\nFor this particular design, the coefficients have been determined to be $B = 1.20 \\times 10^4 \\text{ s}^{-1}$ and $C = 4.80 \\times 10^7 \\text{ s}^{-2}$. The constant $A$ is chosen such that the filter has a DC gain of unity.\n\nCalculate the group delay of this filter at an angular frequency of $\\omega=0$ rad/s.\n\nExpress your answer in microseconds (Âµs), rounded to three significant figures.", "solution": "The group delay is defined as $\\tau_{g}(\\omega)=-\\frac{d}{d\\omega}\\arg H(j\\omega)$. For $H(s)=\\frac{A}{s^{2}+Bs+C}$ with unity DC gain, we require $H(0)=1$, which gives $\\frac{A}{C}=1$ and hence $A=C$. Therefore,\n$$\nH(j\\omega)=\\frac{C}{C-\\omega^{2}+jB\\omega}.\n$$\nLet the denominator be $D(j\\omega)=x(\\omega)+j y(\\omega)$ with $x(\\omega)=C-\\omega^{2}$ and $y(\\omega)=B\\omega$. Then $\\arg H(j\\omega)=-\\arg D(j\\omega)$, so\n$$\n\\tau_{g}(\\omega)=-\\frac{d}{d\\omega}\\arg H(j\\omega)=\\frac{d}{d\\omega}\\arg D(j\\omega).\n$$\nUsing the derivative of the argument of a complex function, \n$$\n\\frac{d}{d\\omega}\\arg D(j\\omega)=\\frac{x(\\omega)\\,y'(\\omega)-y(\\omega)\\,x'(\\omega)}{x(\\omega)^{2}+y(\\omega)^{2}},\n$$\nwith $x'(\\omega)=-2\\omega$ and $y'(\\omega)=B$, we obtain\n$$\n\\tau_{g}(\\omega)=\\frac{(C-\\omega^{2})B-(B\\omega)(-2\\omega)}{(C-\\omega^{2})^{2}+(B\\omega)^{2}}=\\frac{B\\,(C+\\omega^{2})}{(C-\\omega^{2})^{2}+(B\\omega)^{2}}.\n$$\nAt $\\omega=0$,\n$$\n\\tau_{g}(0)=\\frac{B\\,C}{C^{2}}=\\frac{B}{C}.\n$$\nSubstituting the given values $B=1.20\\times 10^{4}\\ \\text{s}^{-1}$ and $C=4.80\\times 10^{7}\\ \\text{s}^{-2}$,\n$$\n\\tau_{g}(0)=\\frac{1.20\\times 10^{4}}{4.80\\times 10^{7}}\\ \\text{s}=2.50\\times 10^{-4}\\ \\text{s}.\n$$\nConverting to microseconds (where $1\\ \\text{microsecond}=10^{-6}\\ \\text{s}$) gives\n$$\n\\tau_{g}(0)=2.50\\times 10^{2}\\ \\text{microseconds}.\n$$\nRounded to three significant figures, the value in microseconds is $2.50\\times 10^{2}$.", "answer": "$$\\boxed{2.50 \\times 10^{2}}$$", "id": "1282712"}, {"introduction": "While Bessel filters are prized for their time-domain behavior, their performance as a frequency-selective device is also critical. This practice examines the filter's magnitude response in the stopband. You will determine the ultimate roll-off rate for a fourth-order Bessel filter, a characteristic that is fundamentally linked to the filter's order and dictates how effectively it attenuates high-frequency signals [@problem_id:1282695].", "problem": "In a signal processing application, a fourth-order low-pass Bessel filter is implemented to condition an analog signal before digitization. The Bessel filter is selected for its maximally flat group delay, which preserves the waveform of the signal in the passband. For frequencies well above the filter's cutoff frequency, the magnitude of the filter's frequency response attenuates at a constant asymptotic rate, known as the ultimate roll-off rate.\n\nWhat is the ultimate roll-off rate for this fourth-order low-pass filter?\n\nA. -20 dB/decade\n\nB. -40 dB/decade\n\nC. -60 dB/decade\n\nD. -80 dB/decade\n\nE. -120 dB/decade", "solution": "A causal, proper, low-pass filter of order $n$ with transfer function $H(s)$ and no finite-frequency zeros has numerator degree $m=0$ and denominator degree $n$. As $|s| \\to \\infty$, the denominator is dominated by its highest power, so one has the asymptotic behavior\n$$\nH(s) \\sim \\frac{K}{a_{n}s^{n}},\n$$\nfor some constants $K$ and $a_{n}$. Evaluated on the imaginary axis, $s=j\\omega$, this yields\n$$\n|H(j\\omega)| \\propto \\omega^{-n}.\n$$\nExpressed in decibels, the magnitude is\n$$\n20\\log_{10}|H(j\\omega)| \\sim \\text{constant} - 20\\,n\\,\\log_{10}\\omega,\n$$\nwhich implies an ultimate high-frequency roll-off of $-20n$ dB per decade. A fourth-order Bessel low-pass filter is an $n=4$th-order low-pass with no finite zeros (its numerator is constant and its denominator is a Bessel polynomial of degree $n$), so its asymptotic magnitude roll-off is\n$$\n-20\\times 4 = -80 \\text{ dB/decade}.\n$$\nTherefore, the correct option is D.", "answer": "$$\\boxed{D}$$", "id": "1282695"}, {"introduction": "This final practice transitions from analysis to a practical design challenge, demonstrating the value of the Bessel response in system engineering. You will design an all-pass equalizer to compensate for the non-ideal group delay of a Butterworth filter, aiming to make the combined response mimic that of a higher-order Bessel filter. This exercise in delay equalization highlights how engineers can actively shape a system's phase response to preserve signal integrity [@problem_id:1282705].", "problem": "In high-frequency communication systems, maintaining signal integrity requires that all frequency components of a signal experience the same time delay. This property is characterized by a flat group delay. A common technique to achieve this is to use a delay equalizer to compensate for the non-constant group delay of other filters in the signal path.\n\nConsider a normalized second-order Butterworth low-pass filter (LPF) with the transfer function:\n$$ H_{LPF}(s) = \\frac{1}{s^2 + \\sqrt{2}s + 1} $$\nTo improve its phase response, this filter is placed in series (cascaded) with a second-order all-pass equalizer (APE) whose transfer function is given by:\n$$ H_{APE}(s) = \\frac{s^2 - as + b}{s^2 + as + b} $$\nwhere $a$ and $b$ are positive real constants to be determined. The denominator of the APE, $s^2 + as + b$, can be related to the standard second-order form $s^2 + \\frac{\\omega_0}{Q}s + \\omega_0^2$, where $\\omega_0$ is the undamped natural frequency and $Q$ is the quality factor.\n\nThe design objective is to choose $a$ and $b$ such that the group delay of the total cascaded system, $H_{Total}(s) = H_{LPF}(s) \\cdot H_{APE}(s)$, is maximally flat at a frequency of $\\omega=0$. This condition makes the overall response approximate that of a fourth-order Bessel filter near DC.\n\nTo constrain the design, the quality factor of the all-pass equalizer's poles is specified to be $Q = \\frac{1}{2}$.\n\nDetermine the required values for the parameters $a$ and $b$. Present your final answer as an ordered pair $(a, b)$.", "solution": "The total group delay of a cascade equals the sum of the group delays of the factors. Let $H_{Total}(s)=H_{LPF}(s)H_{APE}(s)$ and let $\\tau(\\omega)$ denote group delay at frequency $\\omega$, so\n$$\n\\tau_{Total}(\\omega)=\\tau_{LPF}(\\omega)+\\tau_{APE}(\\omega).\n$$\nFor a second-order denominator $D(s)=s^{2}+a_{1}s+a_{0}$, we have $D(j\\omega)=X(\\omega)+jY(\\omega)$ with $X(\\omega)=a_{0}-\\omega^{2}$ and $Y(\\omega)=a_{1}\\omega$. The phase of $D(j\\omega)$ is $\\arg D(j\\omega)$ and\n$$\n\\frac{d}{d\\omega}\\arg D(j\\omega)=\\frac{X(\\omega)Y'(\\omega)-Y(\\omega)X'(\\omega)}{X(\\omega)^{2}+Y(\\omega)^{2}}=\\frac{a_{1}\\big(a_{0}+\\omega^{2}\\big)}{(a_{0}-\\omega^{2})^{2}+(a_{1}\\omega)^{2}}.\n$$\nFor the LPF $H_{LPF}(s)=1/(s^{2}+\\sqrt{2}\\,s+1)$, the phase is $-\\arg D_{L}(j\\omega)$ with $D_{L}(s)=s^{2}+\\sqrt{2}\\,s+1$, hence\n$$\n\\tau_{LPF}(\\omega)=\\frac{d}{d\\omega}\\arg D_{L}(j\\omega)=\\frac{\\sqrt{2}\\,(1+\\omega^{2})}{(1-\\omega^{2})^{2}+2\\omega^{2}}=\\frac{\\sqrt{2}\\,(1+\\omega^{2})}{1+\\omega^{4}}.\n$$\nIts Maclaurin expansion to order $\\omega^{2}$ is\n$$\n\\tau_{LPF}(\\omega)=\\sqrt{2}+\\sqrt{2}\\,\\omega^{2}+O(\\omega^{4}).\n$$\nFor the all-pass equalizer $H_{APE}(s)=(s^{2}-as+b)/(s^{2}+as+b)$, note that the numerator equals $D_{A}(-s)$ where $D_{A}(s)=s^{2}+as+b$. Thus\n$$\n\\arg H_{APE}(j\\omega)=\\arg D_{A}(-j\\omega)-\\arg D_{A}(j\\omega)=-2\\,\\arg D_{A}(j\\omega),\n$$\nand therefore\n$$\n\\tau_{APE}(\\omega)=-\\frac{d}{d\\omega}\\arg H_{APE}(j\\omega)=2\\,\\frac{d}{d\\omega}\\arg D_{A}(j\\omega)=\\frac{2a\\,(b+\\omega^{2})}{(b-\\omega^{2})^{2}+(a\\omega)^{2}}.\n$$\nExpand $\\tau_{APE}(\\omega)$ near $\\omega=0$. Write the denominator as $b^{2}+(a^{2}-2b)\\omega^{2}+O(\\omega^{4})$ and invert:\n$$\n\\frac{1}{(b-\\omega^{2})^{2}+(a\\omega)^{2}}=\\frac{1}{b^{2}}\\left[1-\\frac{a^{2}-2b}{b^{2}}\\omega^{2}+O(\\omega^{4})\\right].\n$$\nThus\n$$\n\\tau_{APE}(\\omega)=\\frac{2a}{b^{2}}(b+\\omega^{2})\\left[1-\\frac{a^{2}-2b}{b^{2}}\\omega^{2}+O(\\omega^{4})\\right]\n=\\frac{2a}{b}+ \\frac{2a(3b-a^{2})}{b^{3}}\\omega^{2}+O(\\omega^{4}).\n$$\nHence the total group delay expansion is\n$$\n\\tau_{Total}(\\omega)=\\left(\\sqrt{2}+\\frac{2a}{b}\\right)+\\left(\\sqrt{2}+\\frac{2a(3b-a^{2})}{b^{3}}\\right)\\omega^{2}+O(\\omega^{4}).\n$$\nMaximally flat group delay at $\\omega=0$ imposes that the first nontrivial curvature term vanish, i.e.,\n$$\n\\sqrt{2}+\\frac{2a(3b-a^{2})}{b^{3}}=0.\n$$\nThe APE denominator is compared with the standard form $s^{2}+(\\omega_{0}/Q)s+\\omega_{0}^{2}$, giving $a=\\omega_{0}/Q$ and $b=\\omega_{0}^{2}$. With the specified $Q=\\frac{1}{2}$, this yields\n$$\nb=a^{2}Q^{2}=\\frac{a^{2}}{4}.\n$$\nSubstitute $b=\\frac{a^{2}}{4}$ into the flatness condition. Compute $3b-a^{2}=\\frac{3a^{2}}{4}-a^{2}=-\\frac{a^{2}}{4}$ and $b^{3}=\\frac{a^{6}}{64}$, hence\n$$\n\\sqrt{2}+\\frac{2a(3b-a^{2})}{b^{3}}=\\sqrt{2}+2a\\cdot\\frac{-a^{2}/4}{a^{6}/64}\n=\\sqrt{2}-\\frac{32}{a^{3}}=0.\n$$\nTherefore $a^{3}=16\\sqrt{2}$, and\n$$\na=(16\\sqrt{2})^{1/3}=2^{3/2}=2\\sqrt{2},\\qquad b=\\frac{a^{2}}{4}=2.\n$$\nThese values satisfy the specified $Q=\\frac{1}{2}$ and make the total group delay maximally flat at $\\omega=0$ to second order, yielding a near-DC behavior akin to a fourth-order Bessel response.", "answer": "$$\\boxed{(2\\sqrt{2}, 2)}$$", "id": "1282705"}]}