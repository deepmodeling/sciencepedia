{"hands_on_practices": [{"introduction": "A core task in analog design is selecting component values to meet performance specifications. This first exercise [@problem_id:1297907] puts you in the role of a designer tasked with setting the differential-mode gain of a MOSFET differential pair. It provides direct practice in applying the fundamental gain equation, $A_d = -g_m R_D$, to determine the required load resistance for a given transistor transconductance.", "problem": "An engineer is designing the input stage of an operational amplifier, which employs a symmetric differential pair as its core. This circuit consists of two identical Metal-Oxide-Semiconductor Field-Effect Transistors (MOSFETs) and two identical drain resistors, denoted as $R_D$. The transistors are biased in their saturation region and exhibit a transconductance, $g_m$, of $2.5 \\text{ mA/V}$. For this stage to meet performance specifications, the differential-mode voltage gain, defined as $A_d = v_{od}/v_{id}$ where $v_{od}$ is the differential output voltage and $v_{id}$ is the differential input voltage, must be precisely $-10 \\text{ V/V}$.\n\nAssuming the Early effect is negligible (i.e., the transistors' intrinsic output resistance $r_o$ is infinitely large) and the pair is biased by an ideal tail current source, calculate the necessary value for the drain resistor $R_D$.\n\nExpress your answer in kilo-ohms ($\\text{k}\\Omega$).", "solution": "The problem asks for the value of the drain resistor $R_D$ in a symmetric MOSFET differential pair required to achieve a specific differential-mode voltage gain $A_d$. We are given the transconductance $g_m$ of the transistors.\n\nThe differential-mode voltage gain, $A_d$, is defined as the ratio of the differential output voltage $v_{od}$ to the differential input voltage $v_{id}$:\n$$A_d = \\frac{v_{od}}{v_{id}}$$\n\nFor a small differential input voltage $v_{id}$, applied such that $v_{g1} = v_{id}/2$ and $v_{g2} = -v_{id}/2$ (where $v_{g1}$ and $v_{g2}$ are the small-signal gate voltages of the two MOSFETs), the resulting small-signal drain currents are given by:\n$$i_{d1} = g_m v_{gs1} = g_m \\frac{v_{id}}{2}$$\n$$i_{d2} = g_m v_{gs2} = g_m \\left(-\\frac{v_{id}}{2}\\right) = -g_m \\frac{v_{id}}{2}$$\nHere we have used the fact that the source terminals are common, so $v_{gs} = v_g - v_s$. For a differential input, the common source voltage $v_s$ does not change, so $\\Delta v_s = 0$, which means $v_{gs1} = v_{g1}$ and $v_{gs2} = v_{g2}$.\n\nThe small-signal output voltages at each drain, $v_{o1}$ and $v_{o2}$, are determined by the drain currents flowing through the drain resistors $R_D$. Since the problem states the transistor output resistance $r_o$ is infinite, it does not appear in parallel with $R_D$.\n$$v_{o1} = -i_{d1} R_D = -\\left(g_m \\frac{v_{id}}{2}\\right) R_D$$\n$$v_{o2} = -i_{d2} R_D = -\\left(-g_m \\frac{v_{id}}{2}\\right) R_D = \\left(g_m \\frac{v_{id}}{2}\\right) R_D$$\n\nThe differential output voltage $v_{od}$ is the difference between these two single-ended output voltages:\n$$v_{od} = v_{o1} - v_{o2} = \\left(-\\frac{g_m R_D v_{id}}{2}\\right) - \\left(\\frac{g_m R_D v_{id}}{2}\\right)$$\n$$v_{od} = -g_m R_D v_{id}$$\n\nNow, we can find the expression for the differential-mode gain $A_d$:\n$$A_d = \\frac{v_{od}}{v_{id}} = \\frac{-g_m R_D v_{id}}{v_{id}} = -g_m R_D$$\n\nWe are given the target gain $A_d = -10 \\text{ V/V}$ and the transconductance $g_m = 2.5 \\text{ mA/V}$. We can rearrange the gain formula to solve for $R_D$:\n$$R_D = -\\frac{A_d}{g_m}$$\n\nSubstitute the given numerical values into this expression. It is important to be consistent with units. We have $g_m = 2.5 \\text{ mA/V} = 2.5 \\times 10^{-3} \\text{ A/V}$.\n$$R_D = -\\frac{-10 \\text{ V/V}}{2.5 \\times 10^{-3} \\text{ A/V}} = \\frac{10}{2.5 \\times 10^{-3}} \\, \\Omega$$\n$$R_D = \\frac{10}{0.0025} \\, \\Omega = 4000 \\, \\Omega$$\n\nThe problem asks for the answer to be expressed in kilo-ohms ($\\text{k}\\Omega$).\n$$R_D = 4000 \\, \\Omega = 4 \\text{ k}\\Omega$$", "answer": "$$\\boxed{4}$$", "id": "1297907"}, {"introduction": "Effective circuit design involves balancing multiple performance metrics, such as gain and power consumption. This practice [@problem_id:1297845] moves beyond a simple calculation to explore these crucial trade-offs. By analyzing a Figure of Merit, you will investigate how adjusting a transistor's physical dimensions ($W/L$) impacts the amplifier's gain and efficiency, a central consideration in modern integrated circuit design.", "problem": "An analog circuit designer is evaluating a differential amplifier built with a matched pair of n-channel Metal-Oxide-Semiconductor Field-Effect Transistors (MOSFETs), M1 and M2. The amplifier is biased by an ideal constant current source that sinks a total current $I_{SS}$. Each transistor has an identical resistive load $R_D$ connected between its drain and the positive supply voltage $V_{DD}$. In this configuration, the total DC power, $P_{DC}$, drawn by the two transistors and their loads from the supply is $P_{DC} = V_{DD} I_{SS}$.\n\nA key performance metric under consideration is a Figure of Merit (FoM), defined as the ratio of the magnitude of the differential-mode voltage gain, $|A_d|$, to the total DC power consumption, $P_{DC}$.\n$$ \\text{FoM} = \\frac{|A_d|}{P_{DC}} $$\nThe original design uses transistors with a width-to-length ratio of $(W/L)_{orig}$. The designer proposes a modification where the width of both input transistors is doubled, while their length is kept the same, resulting in a new ratio of $(W/L)_{new} = 2(W/L)_{orig}$. For this new design, the total bias current $I_{SS}$, the supply voltage $V_{DD}$, and the load resistors $R_D$ are all kept identical to the original design.\n\nAssuming both transistors operate in the saturation region and that channel-length modulation effects are negligible ($\\lambda = 0$), calculate the ratio of the new Figure of Merit, $FoM_{new}$, to the original Figure of Merit, $FoM_{orig}$.", "solution": "The differential pair is biased by an ideal current source of value $I_{SS}$; at the symmetric operating point each transistor carries $I_{D} = I_{SS}/2$. With $\\lambda = 0$ and identical loads $R_{D}$ to $V_{DD}$, use small-signal differential analysis with an ideal tail source (infinite small-signal resistance): under differential excitation $v_{id}$, the source node is at AC ground.\n\nLet $v_{g1} = +\\frac{v_{id}}{2}$ and $v_{g2} = -\\frac{v_{id}}{2}$. Then $v_{gs1} = +\\frac{v_{id}}{2}$ and $v_{gs2} = -\\frac{v_{id}}{2}$. The small-signal drain currents are $i_{d1} = g_{m}\\left(\\frac{v_{id}}{2}\\right)$ and $i_{d2} = g_{m}\\left(-\\frac{v_{id}}{2}\\right)$. With loads $R_{D}$ and neglecting $r_{o}$, the small-signal outputs are\n$$\nv_{o1} = -g_{m} R_{D} \\frac{v_{id}}{2}, \\qquad v_{o2} = +g_{m} R_{D} \\frac{v_{id}}{2}.\n$$\nHence the differential output is\n$$\nv_{od} = v_{o1} - v_{o2} = -g_{m} R_{D} v_{id},\n$$\nso the magnitude of the differential-mode gain is\n$$\n|A_{d}| = g_{m} R_{D}.\n$$\n\nThe Figure of Merit is\n$$\n\\text{FoM} = \\frac{|A_{d}|}{P_{DC}} = \\frac{g_{m} R_{D}}{V_{DD} I_{SS}},\n$$\nand since $R_{D}$, $V_{DD}$, and $I_{SS}$ are unchanged, the FoM scales directly with $g_{m}$.\n\nFor a MOSFET in saturation with $\\lambda=0$,\n$$\nI_{D} = \\frac{1}{2} \\mu_{n} C_{ox} \\frac{W}{L} V_{ov}^{2}, \\qquad g_{m} = \\mu_{n} C_{ox} \\frac{W}{L} V_{ov} = \\sqrt{2 \\mu_{n} C_{ox} \\frac{W}{L} I_{D}}.\n$$\nAt the operating point, $I_{D} = I_{SS}/2$ is fixed by the tail current and symmetry, so\n$$\ng_{m} \\propto \\sqrt{\\frac{W}{L}}.\n$$\nDoubling the width at fixed length gives $\\left(\\frac{W}{L}\\right)_{new} = 2 \\left(\\frac{W}{L}\\right)_{orig}$, hence\n$$\n\\frac{g_{m,new}}{g_{m,orig}} = \\sqrt{2}.\n$$\n\nSince $P_{DC} = V_{DD} I_{SS}$ is unchanged, the ratio of Figures of Merit equals the ratio of transconductances:\n$$\n\\frac{\\text{FoM}_{new}}{\\text{FoM}_{orig}} = \\frac{g_{m,new}}{g_{m,orig}} = \\sqrt{2}.\n$$", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "1297845"}, {"introduction": "Our small-signal models are powerful, but they are linear approximations valid only around a specific DC bias point. This exercise [@problem_id:1297850] explores what happens when that bias point is shifted by a DC input offset, a common real-world scenario. You will calculate the small-signal gain for an asymmetrically biased BJT differential pair, revealing how the amplifier's gain is not a fixed constant but changes dynamically with the input conditions.", "problem": "Consider a differential amplifier circuit built with a pair of matched NPN Bipolar Junction Transistors (BJTs), denoted as Q1 and Q2. The transistors are biased by a constant ideal current source that sinks a tail current of $I_{EE} = 1.00$ mA from their common-emitter node. Two identical collector resistors, $R_{C1} = R_{C2} = R_C = 10.0$ k$\\Omega$, are connected from the collectors of Q1 and Q2, respectively, to a positive supply voltage. For this analysis, you may assume that the transistor current gain, $\\beta$, is infinitely large and the Early effect is negligible. The thermal voltage is given as $V_T = 25.0$ mV.\n\nA DC differential voltage $V_{ID} = V_{B1} - V_{B2} = 50.0$ mV is applied to the bases of the transistors, causing an imbalance in their operating points. On top of this DC bias, a small-signal differential voltage, $v_{id} = v_{b1} - v_{b2}$, is applied.\n\nDetermine the magnitude of the small-signal single-ended voltage gain, defined as $A_v = v_{o2} / v_{id}$, where $v_{o2}$ is the small-signal voltage at the collector of transistor Q2.\n\nReport your answer as a dimensionless value, rounded to three significant figures.", "solution": "Because the BJTs are matched, have infinite $\\beta$, and negligible Early effect, their small-signal transconductances are $g_{mi} = I_{i}/V_{T}$, where $I_{i}$ is the DC collector current of transistor $i$ and $V_{T}$ is the thermal voltage.\n\nThe applied DC differential input $V_{ID}$ sets the DC current split. With a common emitter node, $V_{BE1} - V_{BE2} = V_{ID}$. For BJTs, $I_{1}/I_{2} = \\exp\\!\\left(\\frac{V_{BE1}-V_{BE2}}{V_{T}}\\right) = \\exp\\!\\left(\\frac{V_{ID}}{V_{T}}\\right) \\equiv r$, and the ideal tail source enforces $I_{1} + I_{2} = I_{EE}$. Solving gives\n$$\nI_{1} = I_{EE}\\frac{r}{1+r}, \\quad I_{2} = I_{EE}\\frac{1}{1+r},\n$$\nso\n$$\ng_{m1} = \\frac{I_{1}}{V_{T}}, \\quad g_{m2} = \\frac{I_{2}}{V_{T}}.\n$$\n\nFor a purely differential small-signal excitation $v_{id} = v_{b1} - v_{b2}$, choose $v_{b1} = \\frac{v_{id}}{2}$ and $v_{b2} = -\\frac{v_{id}}{2}$. The ideal tail current source has infinite small-signal resistance, so its small-signal current is zero and the emitter-node constraint is $i_{c1} + i_{c2} = 0$. Using $i_{ci} = g_{mi} v_{bei}$ with $v_{bei} = v_{bi} - v_{e}$,\n$$\ng_{m1}(v_{b1} - v_{e}) + g_{m2}(v_{b2} - v_{e}) = 0\n\\;\\Rightarrow\\;\nv_{e} = \\frac{g_{m1} v_{b1} + g_{m2} v_{b2}}{g_{m1} + g_{m2}}.\n$$\nThen\n$$\nv_{be2} = v_{b2} - v_{e} = -\\frac{g_{m1}}{g_{m1} + g_{m2}}\\,v_{id},\n\\quad\ni_{c2} = g_{m2} v_{be2} = -\\frac{g_{m1} g_{m2}}{g_{m1} + g_{m2}}\\,v_{id}.\n$$\nWith a collector resistor $R_{C}$ to the supply and infinite $r_{o}$, the small-signal collector voltage is\n$$\nv_{o2} = -i_{c2} R_{C} = \\frac{g_{m1} g_{m2}}{g_{m1} + g_{m2}}\\,R_{C}\\,v_{id}.\n$$\nTherefore the single-ended differential gain is\n$$\nA_{v} \\equiv \\frac{v_{o2}}{v_{id}} = \\frac{g_{m1} g_{m2}}{g_{m1} + g_{m2}}\\,R_{C}.\n$$\nSubstituting $g_{mi} = I_{i}/V_{T}$ and $I_{1} + I_{2} = I_{EE}$ gives\n$$\nA_{v} = \\frac{I_{1} I_{2}}{V_{T} (I_{1} + I_{2})} R_{C} = \\frac{I_{1} I_{2}}{V_{T} I_{EE}} R_{C}.\n$$\nUsing $I_{1} = I_{EE}\\frac{r}{1+r}$ and $I_{2} = I_{EE}\\frac{1}{1+r}$ with $r = \\exp\\!\\left(\\frac{V_{ID}}{V_{T}}\\right)$ yields\n$$\nI_{1} I_{2} = I_{EE}^{2}\\frac{r}{(1+r)^{2}},\n\\quad\n\\Rightarrow\\quad\nA_{v} = \\frac{R_{C} I_{EE}}{V_{T}} \\frac{r}{(1+r)^{2}}.\n$$\nEquivalently, letting $\\Delta \\equiv \\frac{V_{ID}}{V_{T}}$ and writing $r = \\exp(\\Delta)$,\n$$\n\\frac{r}{(1+r)^{2}} = \\frac{1}{4\\cosh^{2}\\!\\left(\\frac{\\Delta}{2}\\right)},\n\\quad\n\\Rightarrow\\quad\nA_{v} = \\frac{R_{C} I_{EE}}{4 V_{T} \\cosh^{2}\\!\\left(\\frac{V_{ID}}{2 V_{T}}\\right)}.\n$$\n\nNow evaluate numerically with $R_{C} = 10.0 \\times 10^{3}$, $I_{EE} = 1.00 \\times 10^{-3}$, $V_{T} = 25.0 \\times 10^{-3}$, and $V_{ID} = 50.0 \\times 10^{-3}$ so that $\\Delta = \\frac{V_{ID}}{V_{T}} = 2$:\n$$\n\\frac{R_{C} I_{EE}}{V_{T}} = \\frac{10.0 \\times 10^{3} \\times 1.00 \\times 10^{-3}}{25.0 \\times 10^{-3}} = 400,\n\\quad\n\\frac{r}{(1+r)^{2}} = \\frac{\\exp(2)}{\\left(1+\\exp(2)\\right)^{2}} \\approx 0.104994,\n$$\nso\n$$\nA_{v} \\approx 400 \\times 0.104994 \\approx 41.998.\n$$\nThe requested magnitude, rounded to three significant figures, is $42.0$.", "answer": "$$\\boxed{42.0}$$", "id": "1297850"}]}