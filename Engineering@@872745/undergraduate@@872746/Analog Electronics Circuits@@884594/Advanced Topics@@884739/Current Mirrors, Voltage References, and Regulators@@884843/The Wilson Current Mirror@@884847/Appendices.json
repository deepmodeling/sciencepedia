{"hands_on_practices": [{"introduction": "The first step in utilizing any current mirror is to establish a stable and accurate reference current. This practice exercise focuses on this fundamental design task. You will calculate the required value of a reference resistor to set a desired output current in a Wilson current mirror, bridging the gap between theoretical equations and practical circuit implementation. [@problem_id:1342141]", "problem": "An electronics engineer is designing a precision biasing circuit for an amplifier stage in a low-power integrated circuit. The design utilizes a Wilson current mirror to generate a stable output current, $I_{\\text{out}}$. The circuit is constructed using three NPN Bipolar Junction Transistors (BJTs) that are assumed to be perfectly matched.\n\nThe mirror is powered by a supply voltage of $V_{CC} = 5.00 \\text{ V}$. For the specific topology of the Wilson mirror being used, a detailed analysis provides the following relationships, assuming the transistors operate in the forward-active region and the Early effect is negligible:\n\n1.  The reference current, $I_{\\text{REF}}$, which flows through the reference resistor $R_{\\text{ref}}$, is related to the desired output current $I_{\\text{out}}$ by the equation:\n    $$I_{\\text{REF}} = I_{\\text{out}} \\left(1 + \\frac{2}{\\beta(\\beta + 1)}\\right)$$\n    where $\\beta$ is the common-emitter current gain of the transistors.\n\n2.  The DC voltage at the reference node (the point where $R_{\\text{ref}}$ connects to the transistor network) is stable at twice the base-emitter turn-on voltage, i.e., $V_{\\text{REF}} = 2V_{BE,\\text{on}}$.\n\nThe design requires a stable output current of $I_{\\text{out}} = 100.0\\ \\mu\\text{A}$. The matched transistors have a current gain of $\\beta = 100$, and their base-emitter turn-on voltage is $V_{BE,\\text{on}} = 0.700 \\text{ V}$.\n\nCalculate the required value of the reference resistor, $R_{\\text{ref}}$, to achieve the specified output current. Express your answer in kilohms ($\\text{k}\\Omega$) and round to three significant figures.", "solution": "We are given the Wilson mirror relations:\n- Reference current to output current: \n$$I_{\\text{REF}} = I_{\\text{out}}\\left(1 + \\frac{2}{\\beta(\\beta + 1)}\\right)$$\n- Reference node voltage: \n$$V_{\\text{REF}} = 2V_{BE,\\text{on}}$$\nAssuming the reference resistor $R_{\\text{ref}}$ is connected from $V_{CC}$ to the reference node, Ohm’s law gives:\n$$R_{\\text{ref}} = \\frac{V_{CC} - V_{\\text{REF}}}{I_{\\text{REF}}}$$\nSubstitute $V_{\\text{REF}}$ and $I_{\\text{REF}}$:\n$$R_{\\text{ref}} = \\frac{V_{CC} - 2V_{BE,\\text{on}}}{I_{\\text{out}}\\left(1 + \\frac{2}{\\beta(\\beta + 1)}\\right)}$$\nInsert the given values $V_{CC} = 5.00\\text{ V}$, $V_{BE,\\text{on}} = 0.700\\text{ V}$, $I_{\\text{out}} = 100.0\\ \\mu\\text{A}$, and $\\beta = 100$:\n$$V_{CC} - 2V_{BE,\\text{on}} = 5.00 - 2(0.700) = 3.600\\text{ V}$$\n$$1 + \\frac{2}{\\beta(\\beta + 1)} = 1 + \\frac{2}{100\\cdot 101} = 1 + \\frac{1}{5050} = \\frac{5051}{5050}$$\nThus,\n$$R_{\\text{ref}} = \\frac{3.600\\text{ V}}{100.0\\ \\mu\\text{A}\\cdot \\frac{5051}{5050}} = \\frac{3.600\\text{ V}}{100.0\\ \\mu\\text{A}}\\cdot \\frac{5050}{5051}$$\nCompute the base ratio:\n$$\\frac{3.600\\text{ V}}{100.0\\ \\mu\\text{A}} = 36.000\\ \\text{k}\\Omega$$\nTherefore,\n$$R_{\\text{ref}} = 36.000\\ \\text{k}\\Omega \\times \\frac{5050}{5051} \\approx 35.9929\\ \\text{k}\\Omega$$\nRounding to three significant figures as required gives $36.0\\ \\text{k}\\Omega$.", "answer": "$$\\boxed{36.0}$$", "id": "1342141"}, {"introduction": "Beyond setting the output current, understanding the internal DC operating points of a Wilson mirror is crucial for ensuring all transistors are correctly biased in the forward-active region. This problem invites you to look inside the circuit and calculate a key internal node voltage. By doing so, you will apply Kirchhoff's laws and the BJT's exponential current-voltage relationship to confirm the circuit's internal state. [@problem_id:1342095]", "problem": "An analog integrated circuit designer is analyzing a bias-generation sub-circuit. The circuit is an improved current mirror topology built with three NPN Bipolar Junction Transistors (BJTs), designated Q1, Q2, and Q3. The transistors are considered to be perfectly identical and are all operating in the forward-active region. The Early effect can be neglected for this DC bias analysis.\n\nThe circuit is configured as follows:\n- The emitters of both Q1 and Q2 are connected to the ground reference (0 V).\n- A reference current, $I_{\\text{ref}}$, is sourced into the collector of Q1. The collector of Q1 is also connected directly to its own base.\n- The base of Q1 is connected to the base of Q2.\n- The collector of Q2 is connected to the emitter of Q3.\n- The base of Q3 is connected to the base of Q1.\n- The collector of Q3 serves as the circuit's output, and a suitable voltage is applied to it to ensure all assumptions hold.\n\nThe circuit operates with the following parameters:\n- Reference Current, $I_{\\text{ref}} = 120\\ \\mu\\text{A}$\n- Transistor Forward Current Gain, $\\beta = 180$\n- Thermal Voltage, $V_T = 25.0\\ \\text{mV}$\n\nFor these specific transistors, it is known that the base-emitter voltage $V_{\\text{BE}}$ is $0.700\\ \\text{V}$ when the collector current $I_C$ is $1.00\\ \\text{mA}$.\n\nCalculate the DC voltage at the collector of transistor Q1. Express your answer in Volts, rounded to three significant figures.", "solution": "All BJTs are identical, forward-active, and Early effect is neglected. Let the common base/collector node of Q1 be at voltage $V_{B}$. Since Q1 is diode-connected and Q1, Q2 share the same base and have emitters at ground, their base-emitter voltages are equal: $V_{BE1}=V_{BE2}=V_{B}$. With the ideal BJT law, their collector currents are\n$$\nI_{C1}=I_{C2}=I_{S}\\exp\\!\\left(\\frac{V_{B}}{V_{T}}\\right)\\equiv I,\n$$\nwhere $I_{S}$ is the (common) saturation current.\n\nLet node $X$ be the connection of Q2’s collector and Q3’s emitter. KCL at node $X$ gives\n$$\nI_{E3}=I_{C2}.\n$$\nSince $I_{E3}=I_{C3}\\left(1+\\frac{1}{\\beta}\\right)$ in forward-active operation and $I_{C2}=I$, it follows that\n$$\nI_{C3}=\\frac{I}{1+\\frac{1}{\\beta}}=I\\cdot\\frac{\\beta}{\\beta+1}.\n$$\nUsing the exponential current-voltage relation for Q2 and Q3,\n$$\n\\frac{I_{C3}}{I_{C2}}=\\exp\\!\\left(-\\frac{V_{X}}{V_{T}}\\right)=\\frac{\\beta}{\\beta+1}\n\\;\\Rightarrow\\;\nV_{X}=V_{T}\\ln\\!\\left(1+\\frac{1}{\\beta}\\right),\n$$\nconfirming node $X$ is a small positive voltage.\n\nApply KCL at the base node (collector of Q1), where $I_{\\text{ref}}$ is injected:\n$$\nI_{\\text{ref}}=I_{C1}+I_{B1}+I_{B2}+I_{B3}\n=I+\\frac{I}{\\beta}+\\frac{I}{\\beta}+\\frac{I_{C3}}{\\beta}\n=I\\left[1+\\frac{2}{\\beta}+\\frac{1}{\\beta}\\cdot\\frac{\\beta}{\\beta+1}\\right].\n$$\nThus\n$$\nI=\\frac{I_{\\text{ref}}}{1+\\frac{2}{\\beta}+\\frac{1}{\\beta+1}}.\n$$\nWith $\\beta=180$,\n$$\n1+\\frac{2}{\\beta}+\\frac{1}{\\beta+1}=1+\\frac{1}{90}+\\frac{1}{181}=\\frac{16561}{16290},\n$$\nso\n$$\nI=I_{\\text{ref}}\\cdot\\frac{16290}{16561}.\n$$\n\nThe collector (base) voltage of Q1 is set by its $V_{BE}$ at current $I$. Using the given calibration point $V_{\\text{BE}}=0.700\\ \\text{V}$ at $I_{C}=1.00\\times 10^{-3}\\ \\text{A}$ and the ideal law,\n$$\nV_{B}=0.700+V_{T}\\ln\\!\\left(\\frac{I}{1.00\\times 10^{-3}}\\right).\n$$\nNow substitute $I_{\\text{ref}}=120\\times 10^{-6}\\ \\text{A}$ and $V_{T}=25.0\\times 10^{-3}\\ \\text{V}$:\n$$\nI=120\\times 10^{-6}\\cdot\\frac{16290}{16561}\\ \\text{A}\\approx 1.18036\\times 10^{-4}\\ \\text{A},\n$$\n$$\nV_{B}=0.700+0.0250\\cdot\\ln\\!\\left(\\frac{1.18036\\times 10^{-4}}{1.00\\times 10^{-3}}\\right)\n\\approx 0.700+0.0250\\cdot\\ln(0.118036)\\approx 0.6466\\ \\text{V}.\n$$\nTherefore, the DC voltage at the collector of Q1 (which equals the base-node voltage) is approximately $0.647\\ \\text{V}$ to three significant figures.", "answer": "$$\\boxed{0.647}$$", "id": "1342095"}, {"introduction": "A key advantage of the Wilson current mirror is its exceptionally high output resistance, which makes it an excellent approximation of an ideal current source. To appreciate this, we must move from DC analysis to small-signal analysis. This exercise guides you through the derivation of the circuit's output resistance, a critical performance metric that quantifies how well the output current remains constant despite changes in the output voltage. [@problem_id:1333859]", "problem": "An engineer is designing a precision current source using a Wilson current mirror topology. The circuit is constructed with three NPN Bipolar Junction Transistors (BJTs), labeled Q1, Q2, and Q3, which are perfectly matched. Each transistor has a small-signal transconductance of $g_m$ and a finite small-signal output resistance of $r_o$.\n\nThe circuit is configured as follows:\n- The emitters of Q1 and Q2 are connected to ground.\n- Q1 is diode-connected, with its collector tied to its base. A reference current source is connected to this node.\n- The base of Q2 is connected to the base of Q1.\n- Q3 is stacked on top of Q2, meaning the emitter of Q3 is connected to the collector of Q2.\n- The base of Q3 is connected to the common base node of Q1 and Q2.\n- The output current is drawn from the collector of Q3.\n\nAssuming the current gain, $\\beta$, of the transistors is infinitely large, determine the small-signal output resistance, $R_{out}$, of the current mirror as seen from the collector of Q3. Express your answer as a single closed-form analytic expression in terms of $g_m$ and $r_o$.", "solution": "We use the small-signal hybrid-pi model for BJTs with infinite current gain. Let all three transistors be matched with transconductance $g_{m}$ and output resistance $r_{o}$. Define $g_{o} \\equiv \\frac{1}{r_{o}}$.\n\nLabel nodes as follows:\n- Node $B$: common base node of Q1, Q2, Q3 and collector of Q1 (diode-connected).\n- Node $X$: collector of Q2 and emitter of Q3.\n- Node $Y$: collector of Q3 (the output node).\n- Ground: emitters of Q1 and Q2.\n\nSmall-signal elements:\n- Q1 (diode-connected) from $B$ to ground presents an admittance $g_{m}+g_{o}$ since its small-signal current is $i_{1}=(g_{m}+g_{o})v_{b}$.\n- Q2 has a dependent current source of value $g_{m}v_{b}$ from $X$ to ground and a resistor $r_{o}$ from $X$ to ground (conductance $g_{o}$).\n- Q3 has a dependent current source of value $g_{m}(v_{b}-v_{x})$ from $Y$ to $X$ and a resistor $r_{o}$ from $Y$ to $X$ (conductance $g_{o}$).\n\nWe seek $R_{\\text{out}}$ seen at $Y$ by applying a test voltage $v_{y}$ at node $Y$ (with respect to ground), solving for the resulting current $i_{y}$ flowing from node $Y$ into the network, and then using $R_{\\text{out}}=\\frac{v_{y}}{i_{y}}$.\n\nFirst, determine $v_{b}$. With infinite $\\beta$, base currents are zero; the only element connected to node $B$ is Q1 (to ground). There is no small-signal excitation connected to $B$ through Q2 or Q3 because controlled sources do not inject current into $B$. Therefore KCL at $B$ gives\n$$ (g_{m}+g_{o})v_{b}=0 \\;\\;\\Rightarrow\\;\\; v_{b}=0 $$\n\nNext, write KCL at node $X$. Sum of currents leaving $X$ must be zero (no independent source at $X$):\n- Through Q2 $r_{o}$ to ground: $g_{o}v_{x}$.\n- Through Q2 $g_{m}$ source to ground: $g_{m}v_{b}$.\n- Through Q3 $r_{o}$ to $Y$: $g_{o}(v_{x}-v_{y})$.\n- Through Q3 $g_{m}$ source (which is oriented from $Y$ to $X$): current leaving $X$ via this source is $-g_{m}(v_{b}-v_{x})$.\n\nThus\n$$ g_{o}v_{x}+g_{m}v_{b}+g_{o}(v_{x}-v_{y})-g_{m}(v_{b}-v_{x})=0 $$\nWith $v_{b}=0$, this simplifies to\n$$ (2g_{o}+g_{m})v_{x}=g_{o}v_{y} \\;\\;\\Rightarrow\\;\\; v_{x}=\\frac{g_{o}}{2g_{o}+g_{m}}\\,v_{y} $$\n\nNow compute the test current $i_{y}$ flowing from node $Y$ into the network. Currents leaving $Y$ toward the network are:\n- Through Q3 $r_{o}$ to $X$: $g_{o}(v_{y}-v_{x})$.\n- Through Q3 $g_{m}$ source from $Y$ to $X$: $g_{m}(v_{b}-v_{x})$.\n\nHence, using $v_{b}=0$,\n$$ i_{y}=g_{o}(v_{y}-v_{x})-g_{m}v_{x} $$\nSubstitute $v_{x}=\\alpha v_{y}$ with $\\alpha=\\frac{g_{o}}{2g_{o}+g_{m}}$:\n$$ i_{y}=\\left[g_{o}(1-\\alpha)-g_{m}\\alpha\\right]v_{y} $$\nCompute $1-\\alpha=\\frac{g_{o}+g_{m}}{2g_{o}+g_{m}}$, so\n$$ g_{o}(1-\\alpha)-g_{m}\\alpha=\\frac{g_{o}(g_{o}+g_{m})-g_{m}g_{o}}{2g_{o}+g_{m}}=\\frac{g_{o}^{2}}{2g_{o}+g_{m}} $$\nTherefore\n$$ i_{y}=\\frac{g_{o}^{2}}{2g_{o}+g_{m}}\\,v_{y}\n\\quad\\Rightarrow\\quad\nR_{out}=\\frac{v_{y}}{i_{y}}=\\frac{2g_{o}+g_{m}}{g_{o}^{2}}=g_{m}r_{o}^{2}+2r_{o} $$\n\nThis is the closed-form small-signal output resistance as seen from the collector of Q3.", "answer": "$$\\boxed{g_{m}r_{o}^{2}+2r_{o}}$$", "id": "1333859"}]}