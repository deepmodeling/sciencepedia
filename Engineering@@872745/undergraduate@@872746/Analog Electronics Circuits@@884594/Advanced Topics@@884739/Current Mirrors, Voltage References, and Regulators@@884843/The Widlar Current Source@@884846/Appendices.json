{"hands_on_practices": [{"introduction": "The core function of a Widlar current source is to generate a small, stable output current from a larger reference current. This is achieved by introducing a resistor, $R_E$, in the emitter of the output transistor, which creates a voltage drop that logarithmically controls the current ratio. This first practice [@problem_id:1341657] will guide you through the fundamental design calculation of determining the required value of $R_E$ to achieve a specific current reduction, a crucial first step in any Widlar source design.", "problem": "An analog integrated circuit designer is tasked with creating a low-current bias source for an operational amplifier's input stage. To achieve a stable, small output current from a larger, more easily generated reference current, a Widlar current source is employed.\n\nThe circuit consists of two perfectly matched NPN Bipolar Junction Transistors (BJTs), $Q_1$ and $Q_2$, operating in the forward-active region. The base and collector of the reference transistor, $Q_1$, are connected together. A reference current, $I_{ref}$, is fed into this common node. The base of the output transistor, $Q_2$, is connected to the base of $Q_1$. An emitter resistor, $R_E$, is placed between the emitter of $Q_2$ and the common ground rail, which is also connected to the emitter of $Q_1$. The collector of $Q_2$ provides the desired output current, $I_{out}$.\n\nFor this design, assume the base currents are negligible compared to the collector currents. The reference current is set to $I_{ref} = 1.00 \\text{ mA}$ and the desired output current is $I_{out} = 10.0 \\text{ µA}$. The circuit operates at a temperature where the thermal voltage is $V_T = 26.0 \\text{ mV}$.\n\nCalculate the required value of the emitter resistance $R_E$ to achieve this current ratio. Express your answer in kilo-ohms ($\\text{k}\\Omega$) and round to three significant figures.", "solution": "Because the transistors are matched and operate in forward-active mode with negligible base currents, we can take $I_{C1} \\approx I_{E1} = I_{ref}$ and $I_{C2} \\approx I_{E2} = I_{out}$. For a BJT in forward-active operation, the collector current and base-emitter voltage satisfy $I_{C} = I_{S} \\exp\\!\\left(\\frac{V_{BE}}{V_{T}}\\right)$, which implies\n$$\nV_{BE} = V_{T} \\ln\\!\\left(\\frac{I_{C}}{I_{S}}\\right).\n$$\nSince the bases are tied together, the emitter of $Q_{2}$ is elevated by the resistor $R_{E}$, and the voltage across $R_{E}$ equals the difference in the base-emitter voltages:\n$$\nV_{R_{E}} = V_{BE1} - V_{BE2}.\n$$\nUsing the expression for $V_{BE}$ above with $I_{C1} = I_{ref}$ and $I_{C2} = I_{out}$,\n$$\nV_{BE1} - V_{BE2} = V_{T} \\ln\\!\\left(\\frac{I_{ref}}{I_{S}}\\right) - V_{T} \\ln\\!\\left(\\frac{I_{out}}{I_{S}}\\right) = V_{T} \\ln\\!\\left(\\frac{I_{ref}}{I_{out}}\\right).\n$$\nWith negligible base current, $I_{E2} \\approx I_{out}$, so the resistor satisfies\n$$\nR_{E} = \\frac{V_{R_{E}}}{I_{E2}} = \\frac{V_{T} \\ln\\!\\left(\\frac{I_{ref}}{I_{out}}\\right)}{I_{out}}.\n$$\nSubstituting the given values $V_{T} = 26.0 \\text{ mV}$, $I_{ref} = 1.00 \\text{ mA}$, and $I_{out} = 10.0 \\text{ µA}$,\n$$\nR_{E} = \\frac{26.0 \\times 10^{-3}}{10.0 \\times 10^{-6}} \\ln(100) \\text{ }\\Omega = 2600 \\ln(100) \\text{ }\\Omega.\n$$\nSince $\\ln(100) = 2 \\ln(10) \\approx 4.605170$, we get\n$$\nR_{E} \\approx 2600 \\times 4.605170 \\text{ }\\Omega \\approx 11973.4 \\text{ }\\Omega = 11.9734 \\text{ k}\\Omega.\n$$\nRounded to three significant figures in kilo-ohms, this is $12.0 \\text{ k}\\Omega$.", "answer": "$$\\boxed{12.0}$$", "id": "1341657"}, {"introduction": "To truly understand how a circuit component works, it is often insightful to analyze what happens when it fails. In this exercise [@problem_id:1341633], we will explore a hypothetical manufacturing defect where the emitter resistor, $R_E$, is short-circuited. By calculating the resulting output current, you will see how the circuit reverts to a basic current mirror, starkly illustrating the essential role $R_E$ plays in generating a small output current.", "problem": "An electronics engineer is designing a Widlar current source to generate a small, stable bias current for a sensitive amplifier stage. The design utilizes two matched bipolar junction transistors (BJTs) with a shared base connection. The reference side of the circuit is supplied with a reference current of $I_{REF} = 1.20 \\text{ mA}$. The circuit is specifically engineered to produce a much smaller output current of $I_{OUT,design} = 15.0 \\text{ µA}$. The transistors are maintained at a constant temperature where the thermal voltage is $V_T = 26.0 \\text{ mV}$. For this analysis, assume the transistors are operating in the forward-active region and have a high current gain ($\\beta \\gg 1$), which allows for the approximation that the collector current is equal to the emitter current ($I_C \\approx I_E$).\n\nDuring the circuit's fabrication on a silicon chip, a manufacturing defect occurs, resulting in the emitter resistor, $R_E$, of the output transistor being inadvertently short-circuited. Calculate the ratio of the actual, faulty output current, $I_{OUT,faulty}$, to the intended design current, $I_{OUT,design}$.\n\nExpress your answer as a single numerical value, rounded to three significant figures.", "solution": "The key device relation for a BJT in forward-active operation with high current gain is the diode equation for the collector current:\n$$\nI_{C} = I_{S} \\exp\\!\\left(\\frac{V_{BE}}{V_{T}}\\right),\n$$\nwhere $I_{S}$ is the saturation current and $V_{T}$ is the thermal voltage. With $\\beta \\gg 1$, we take $I_{C} \\approx I_{E}$.\n\nIn a Widlar current source, two matched transistors share the same base node. The reference transistor (without emitter degeneration) is forced to carry the reference current $I_{REF}$, which sets its base-emitter voltage $V_{BE,ref}$ through\n$$\nI_{REF} = I_{S} \\exp\\!\\left(\\frac{V_{BE,ref}}{V_{T}}\\right).\n$$\nThe output transistor normally includes an emitter resistor $R_{E}$, which reduces its effective $V_{BE}$ relative to the reference and thereby its current, achieving $I_{OUT,design} \\ll I_{REF}$.\n\nIf the emitter resistor of the output transistor is short-circuited, then $R_{E} \\to 0$ and both transistors become identical with the same $V_{BE}$ (they share the same base, and with $R_{E}=0$ the emitters are at the same potential). Thus,\n$$\nV_{BE,out} = V_{BE,ref}\n\\quad\\Rightarrow\\quad\nI_{OUT,faulty} = I_{S} \\exp\\!\\left(\\frac{V_{BE,out}}{V_{T}}\\right) = I_{S} \\exp\\!\\left(\\frac{V_{BE,ref}}{V_{T}}\\right) = I_{REF}.\n$$\nTherefore, the ratio of the faulty output current to the intended design current is\n$$\n\\frac{I_{OUT,faulty}}{I_{OUT,design}} = \\frac{I_{REF}}{I_{OUT,design}}.\n$$\nSubstituting the given numerical values,\n$$\n\\frac{I_{OUT,faulty}}{I_{OUT,design}} = \\frac{1.20 \\times 10^{-3}}{15.0 \\times 10^{-6}} = \\frac{1.20}{15.0} \\times 10^{3} = 0.08 \\times 10^{3} = 80.0,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{80.0}$$", "id": "1341633"}, {"introduction": "Moving from design and analysis to real-world application, this practice places you in the role of an engineer debugging a faulty prototype. When a circuit's measured performance deviates from its design specification, a systematic approach is needed to identify the root cause. This problem [@problem_id:1341621] challenges you to use the Widlar source equations to evaluate several possible component faults and determine which one accounts for an unexpectedly low output current, honing your troubleshooting and analytical skills.", "problem": "An electronics student is building a Widlar current source, a circuit designed to generate a small, stable output current. The design uses two matched Bipolar Junction Transistors (BJTs), $Q_1$ and $Q_2$. The circuit is powered by a supply voltage $V_{CC} = 12 \\text{ V}$. The reference current is set by a resistor $R_1 = 22 \\text{ k}\\Omega$ connected from $V_{CC}$ to the collector of the diode-connected transistor $Q_1$. The output current $I_{OUT}$ is the collector current of $Q_2$, which has an emitter resistor $R_2 = 1.0 \\text{ k}\\Omega$.\n\nThe design goal is to produce a stable microampere-level current. Upon testing the prototype, the student measures an output current of $I_{OUT} = 18 \\text{ µA}$, which is significantly lower than the intended design value. Suspecting a single component was installed with an incorrect value, the student considers several possibilities.\n\nFor all calculations, assume the base-emitter voltage of the reference transistor is constant at $V_{BE1} = 0.7 \\text{ V}$ for the purpose of calculating the reference current. The thermal voltage is $V_T = 25 \\text{ mV}$, and base currents are negligible.\n\nWhich of the following single-component faults could account for this measurement?\n\nA. The resistor $R_1$ was mistakenly replaced with a $33 \\text{ k}\\Omega$ resistor.\n\nB. The resistor $R_1$ was mistakenly replaced with a $15 \\text{ k}\\Omega$ resistor.\n\nC. The resistor $R_2$ was mistakenly replaced with a $4.7 \\text{ k}\\Omega$ resistor.\n\nD. The resistor $R_2$ was mistakenly replaced with a $470 \\text{ }\\Omega$ resistor.\n\nE. The supply voltage $V_{CC}$ has drifted down to $10 \\text{ V}$.", "solution": "The problem asks us to identify which of the given single-component faults would result in an output current of $I_{OUT} = 18 \\text{ µA}$ in a Widlar current source. To do this, we will first analyze the intended circuit and then evaluate the effect of each proposed fault.\n\nThe core equation for a Widlar current source relates the reference current ($I_{REF}$) and the output current ($I_{OUT}$) through the emitter resistor $R_2$ and the thermal voltage $V_T$. The reference transistor $Q_1$ and the output transistor $Q_2$ are matched. The Kirchhoff's Voltage Law (KVL) loop through the base-emitter junctions of $Q_1$ and $Q_2$ gives:\n$V_{BE1} = V_{BE2} + I_{E2}R_2$\n\nAssuming high beta for the transistors, the emitter current $I_{E2}$ is approximately equal to the collector current $I_{C2}$, which is the output current $I_{OUT}$.\n$I_{E2} \\approx I_{OUT}$\nSo, $V_{BE1} - V_{BE2} = I_{OUT}R_2$.\n\nThe base-emitter voltages are related to the collector currents by the diode equation:\n$V_{BE} = V_T \\ln\\left(\\frac{I_C}{I_S}\\right)$, where $I_S$ is the saturation current.\nFor two matched transistors, $I_S$ is the same. Therefore:\n$V_{BE1} - V_{BE2} = V_T \\ln\\left(\\frac{I_{C1}}{I_S}\\right) - V_T \\ln\\left(\\frac{I_{C2}}{I_S}\\right) = V_T \\ln\\left(\\frac{I_{C1}}{I_{C2}}\\right)$\n\nSince $Q_1$ is diode-connected, its collector current $I_{C1}$ is approximately equal to the reference current $I_{REF}$ (neglecting the small base currents).\n$I_{C1} \\approx I_{REF}$\nAnd $I_{C2} = I_{OUT}$.\nCombining these equations gives the fundamental Widlar source equation:\n$I_{OUT}R_2 = V_T \\ln\\left(\\frac{I_{REF}}{I_{OUT}}\\right)$\n\nThe reference current, $I_{REF}$, is set by the supply voltage $V_{CC}$ and the resistor $R_1$.\n$I_{REF} = \\frac{V_{CC} - V_{BE1}}{R_1}$\n\nFirst, let's calculate the intended $I_{REF}$ for the original design.\nGiven: $V_{CC} = 12 \\text{ V}$, $R_1 = 22 \\text{ k}\\Omega$, $V_{BE1} = 0.7 \\text{ V}$.\n$I_{REF} = \\frac{12 \\text{ V} - 0.7 \\text{ V}}{22 \\text{ k}\\Omega} = \\frac{11.3 \\text{ V}}{22 \\times 10^3 \\text{ }\\Omega} \\approx 0.5136 \\text{ mA}$\n\nNow, we evaluate each option to see which one yields $I_{OUT} = 18 \\text{ µA}$.\n\n**A. The resistor $R_1$ was mistakenly replaced with a $33 \\text{ k}\\Omega$ resistor.**\nIf $R_1 = 33 \\text{ k}\\Omega$, the reference current changes. The other parameters ($R_2 = 1.0 \\text{ k}\\Omega$, $V_{CC}=12 \\text{ V}$) are as designed.\nNew reference current: $I_{REF}' = \\frac{12 \\text{ V} - 0.7 \\text{ V}}{33 \\text{ k}\\Omega} = \\frac{11.3 \\text{ V}}{33 \\times 10^3 \\text{ }\\Omega} \\approx 0.3424 \\text{ mA}$.\nWe now solve for the resulting $I_{OUT}'$ using the Widlar equation:\n$I_{OUT}' \\cdot (1.0 \\text{ k}\\Omega) = (25 \\text{ mV}) \\ln\\left(\\frac{0.3424 \\text{ mA}}{I_{OUT}'}\\right)$\nWe can test if $I_{OUT}' = 18 \\text{ µA}$ satisfies this equation.\nLHS = $(18 \\times 10^{-6} \\text{ A}) \\cdot (1000 \\text{ }\\Omega) = 18 \\text{ mV}$.\nRHS = $(25 \\text{ mV}) \\ln\\left(\\frac{0.3424 \\times 10^{-3} \\text{ A}}{18 \\times 10^{-6} \\text{ A}}\\right) = (25 \\text{ mV}) \\ln(19.02) \\approx (25 \\text{ mV}) \\cdot 2.946 = 73.6 \\text{ mV}$.\nLHS ($18 \\text{ mV}$) $\\neq$ RHS ($73.6 \\text{ mV}$). So, this fault does not explain the measurement.\n\n**B. The resistor $R_1$ was mistakenly replaced with a $15 \\text{ k}\\Omega$ resistor.**\nA decrease in $R_1$ will increase $I_{REF}$, which in turn increases $I_{OUT}$. This is the opposite of the observed effect (a lower than expected current), so this option is incorrect.\n\n**C. The resistor $R_2$ was mistakenly replaced with a $4.7 \\text{ k}\\Omega$ resistor.**\nIn this case, $R_2 = 4.7 \\text{ k}\\Omega$. The reference current is the original design value, $I_{REF} = 0.5136 \\text{ mA}$.\nWe must check if this fault leads to $I_{OUT} = 18 \\text{ µA}$.\nThe equation is: $(18 \\text{ µA}) \\cdot R_2' = (25 \\text{ mV}) \\ln\\left(\\frac{0.5136 \\text{ mA}}{18 \\text{ µA}}\\right)$. Let's check the equality:\nLHS = $(18 \\times 10^{-6} \\text{ A}) \\cdot (4.7 \\times 10^3 \\text{ }\\Omega) = 84.6 \\text{ mV}$.\nRHS = $(25 \\text{ mV}) \\ln\\left(\\frac{0.5136 \\times 10^{-3} \\text{ A}}{18 \\times 10^{-6} \\text{ A}}\\right) = (25 \\text{ mV}) \\ln(28.53) \\approx (25 \\text{ mV}) \\cdot 3.351 = 83.8 \\text{ mV}$.\nLHS ($84.6 \\text{ mV}$) is extremely close to RHS ($83.8 \\text{ mV}$). The small difference is due to rounding in the calculations and the simplified model. This is a very strong match.\n\n**D. The resistor $R_2$ was mistakenly replaced with a $470 \\text{ }\\Omega$ resistor.**\nA decrease in $R_2$ will increase $I_{OUT}$ to maintain the balance in the Widlar equation. This is the opposite of the observed effect, so this option is incorrect.\n\n**E. The supply voltage $V_{CC}$ has drifted down to $10 \\text{ V}$.**\nIf $V_{CC} = 10 \\text{ V}$, the reference current changes. The resistors are at their design values ($R_1 = 22 \\text{ k}\\Omega$, $R_2=1.0 \\text{ k}\\Omega$).\nNew reference current: $I_{REF}'' = \\frac{10 \\text{ V} - 0.7 \\text{ V}}{22 \\text{ k}\\Omega} = \\frac{9.3 \\text{ V}}{22 \\times 10^3 \\text{ }\\Omega} \\approx 0.4227 \\text{ mA}$.\nWe test if this leads to $I_{OUT} = 18 \\text{ µA}$.\nLHS = $(18 \\times 10^{-6} \\text{ A}) \\cdot (1000 \\text{ }\\Omega) = 18 \\text{ mV}$.\nRHS = $(25 \\text{ mV}) \\ln\\left(\\frac{0.4227 \\times 10^{-3} \\text{ A}}{18 \\times 10^{-6} \\text{ A}}\\right) = (25 \\text{ mV}) \\ln(23.48) \\approx (25 \\text{ mV}) \\cdot 3.156 = 78.9 \\text{ mV}$.\nLHS ($18 \\text{ mV}$) $\\neq$ RHS ($78.9 \\text{ mV}$). So, this fault does not explain the measurement.\n\nBased on the calculations, the only fault that quantitatively accounts for the measured output current of $18 \\text{ µA}$ is the incorrect installation of a $4.7 \\text{ k}\\Omega$ resistor for $R_2$.", "answer": "$$\\boxed{C}$$", "id": "1341621"}]}