{"hands_on_practices": [{"introduction": "Before building a complex circuit like a Wallace tree multiplier, it is essential to first understand the problem it is designed to solve. The multiplication of two binary numbers initially generates a matrix of partial products that must be summed. This foundational exercise asks you to quantify the size and complexity of this initial matrix, which are the very factors that necessitate an efficient reduction strategy like the Wallace tree [@problem_id:1977426].", "problem": "In digital arithmetic, multiplying two unsigned binary numbers is a fundamental operation. Consider the multiplication of a 4-bit unsigned number, the multiplicand, by a 6-bit unsigned number, the multiplier. The product is formed by first generating an array of partial products and then summing them.\n\nLet the 4-bit multiplicand be denoted by $A$, with bits $A_3A_2A_1A_0$, and the 6-bit multiplier be denoted by $B$, with bits $B_5B_4B_3B_2B_1B_0$. A partial product term is formed by the logical AND of a multiplicand bit $A_i$ and a multiplier bit $B_j$. The weight of this term in the final sum is $2^{i+j}$.\n\nBefore any addition or reduction is performed (e.g., using a Wallace Tree or a Carry-Save Adder array), these individual partial product bits are conceptually arranged into columns based on their binary weight. All terms with the same weight $2^k$ (i.e., same value of $i+j$) belong to the same column, say column $k$. The \"height\" of a column is the number of partial product bits it contains.\n\nDetermine the following two quantities for this $4 \\times 6$ multiplication:\n1. The total number of partial product bits generated.\n2. The height of the tallest column in the initial partial product matrix.\n\nProvide the two integer answers as a row matrix, with the total number of bits as the first element and the tallest column height as the second.", "solution": "The problem asks for two properties of the initial partial product matrix for a $4 \\times 6$ unsigned binary multiplication. The multiplicand $A$ is 4 bits wide, so its bits are indexed $i \\in \\{0, 1, 2, 3\\}$. The multiplier $B$ is 6 bits wide, so its bits are indexed $j \\in \\{0, 1, 2, 3, 4, 5\\}$.\n\n**Part 1: Total number of partial product bits**\n\nA partial product bit is formed by the logical AND of one bit from the multiplicand, $A_i$, and one bit from the multiplier, $B_j$. Since there are 4 bits in the multiplicand and 6 bits in the multiplier, every combination of one bit from each operand forms a unique partial product.\n\nThe total number of partial product bits is therefore the product of the number of bits in the multiplicand and the number of bits in the multiplier.\n\nTotal number of partial product bits = (width of $A$) $\\times$ (width of $B$)\n$$ \\text{Total bits} = 4 \\times 6 = 24 $$\nThis is the first part of our answer.\n\n**Part 2: Height of the tallest column**\n\nThe partial product bits are arranged in columns based on their weight, $2^k$, where the column index $k$ is given by the sum of the bit indices, $k = i + j$. The height of a column $k$ is the number of pairs $(i, j)$ such that $i+j=k$, with the constraints $0 \\le i \\le 3$ and $0 \\le j \\le 5$.\n\nWe can systematically determine the height of each column by enumerating the valid $(i,j)$ pairs for each $k$:\n\n- **Column $k=0$**: $i+j=0$. The only valid pair is $(i,j)=(0,0)$. Height = 1.\n- **Column $k=1$**: $i+j=1$. Valid pairs are $(0,1)$ and $(1,0)$. Height = 2.\n- **Column $k=2$**: $i+j=2$. Valid pairs are $(0,2)$, $(1,1)$, and $(2,0)$. Height = 3.\n- **Column $k=3$**: $i+j=3$. Valid pairs are $(0,3)$, $(1,2)$, $(2,1)$, and $(3,0)$. Height = 4.\n- **Column $k=4$**: $i+j=4$. Valid pairs are $(0,4)$, $(1,3)$, $(2,2)$, and $(3,1)$. Height = 4.\n- **Column $k=5$**: $i+j=5$. Valid pairs are $(0,5)$, $(1,4)$, $(2,3)$, and $(3,2)$. Height = 4.\n- **Column $k=6$**: $i+j=6$. Valid pairs are $(1,5)$, $(2,4)$, and $(3,3)$. The pair $(0,6)$ is invalid since $j_{max}=5$. Height = 3.\n- **Column $k=7$**: $i+j=7$. Valid pairs are $(2,5)$ and $(3,4)$. Height = 2.\n- **Column $k=8$**: $i+j=8$. The only valid pair is $(3,5)$. Height = 1.\n- **Column $k=9$**: $i+j=9$. No valid pairs exist. For example, $(3,6)$ has $j>5$. Height = 0.\n\nThe sequence of column heights is (1, 2, 3, 4, 4, 4, 3, 2, 1). We can verify this by summing the heights: $1+2+3+4+4+4+3+2+1 = 24$, which matches the total number of partial product bits calculated in the first part.\n\nBy inspecting the sequence of heights, the maximum value is 4. This occurs for columns $k=3, 4, 5$.\n\nThus, the height of the tallest column is 4. This is the second part of our answer.\n\nBoth requested values have been determined. The total number of partial product bits is 24, and the height of the tallest column is 4.", "answer": "$$\\boxed{\\begin{pmatrix} 24 & 4 \\end{pmatrix}}$$", "id": "1977426"}, {"introduction": "With the initial partial product matrix established, the next step is to explore the core mechanism of the Wallace tree: its powerful reduction engine. The structure compresses the matrix by using parallel stages of full and half adders until only two rows of bits remain. This detailed practice provides direct, hands-on experience in simulating the entire reduction process, allowing you to track the flow of data and appreciate the hardware resources required to achieve high-speed multiplication [@problem_id:1977482].", "problem": "In the design of a high-speed arithmetic logic unit, an engineer is implementing an unsigned hardware multiplier for two 5-bit binary numbers using a Wallace tree architecture. The multiplier first generates a matrix of partial products. This matrix is then reduced to a two-row matrix by a series of reduction stages. The final two rows are then added using a conventional carry-propagate adder.\n\nThe reduction process proceeds in stages. In each stage, the bits within each column of the matrix are reduced using Full Adders (FAs) and Half Adders (HAs) according to a greedy strategy:\n- A Full Adder takes three bits from a single column as input and produces a one-bit sum output for the same column and a one-bit carry output for the next higher-order (more significant) column.\n- A Half Adder takes two bits from a single column as input and produces a one-bit sum output for the same column and a one-bit carry output for the next higher-order column.\n\nWithin each column, as many FAs as possible are used. If two bits remain after forming groups of three, one HA is used. If one bit remains, it is passed directly to the next stage in the same column. The sum bits from the adders and any passed-through bits form the rows for that column in the next stage, along with the carry bits from the adjacent, lower-order column. This process is repeated until no column in the matrix has more than two bits.\n\nCalculate the total number of Full Adders and Half Adders required for the entire reduction phase of this $5 \\times 5$ Wallace tree multiplier. Present your answer as a pair of integers `(Total FAs, Total HAs)`.", "solution": "Let the two 5-bit unsigned numbers be $A = a_4a_3a_2a_1a_0$ and $B = b_4b_3b_2b_1b_0$. The multiplication $A \\times B$ generates 25 partial product bits, with the final product having up to 10 bits. The reduction process is analyzed by tracking the height of each column, from C0 (LSB) to C9 (MSB).\n\n**Initial State (N0)**\n\nFirst, we determine the initial column heights from the partial product matrix.\n- C0: 1, C1: 2, C2: 3, C3: 4, C4: 5, C5: 4, C6: 3, C7: 2, C8: 1, C9: 0.\nThe vector of initial heights `N0` (from C9 to C0) is `[0, 1, 2, 3, 4, 5, 4, 3, 2, 1]`.\n\n**Stage 1 Reduction**\n\nWe apply FAs and HAs to each column of `N0`.\n- For a column of height $k$, we use $\\lfloor k/3 \\rfloor$ FAs and $\\lfloor (k \\pmod 3) / 2 \\rfloor$ HAs.\n- Each FA produces 1 sum bit (s) and 1 carry bit (c). Each HA produces 1 sum bit and 1 carry bit. Bits not used in an adder are passed through.\n\n| Column | Height (k) | FAs | HAs | Sum Bits (s) | Carry-out (c) |\n| :--- | :--- | :-- | :-- | :--- | :--- |\n| C0 | 1 | 0 | 0 | 1 | 0 |\n| C1 | 2 | 0 | 1 | 1 | 1 |\n| C2 | 3 | 1 | 0 | 1 | 1 |\n| C3 | 4 | 1 | 0 | 2 (1 sum + 1 pass) | 1 |\n| C4 | 5 | 1 | 1 | 2 (1 sum + 1 sum) | 2 (1c + 1c) |\n| C5 | 4 | 1 | 0 | 2 (1 sum + 1 pass) | 1 |\n| C6 | 3 | 1 | 0 | 1 | 1 |\n| C7 | 2 | 0 | 1 | 1 | 1 |\n| C8 | 1 | 0 | 0 | 1 | 0 |\n| C9 | 0 | 0 | 0 | 0 | 0 |\n| **Total**| | **5**| **3** | | |\n\nThe height of the columns for the next stage, `N1`, is calculated as `N1[k] = s[k] + c[k-1]`.\n- N1 heights: `[0, 2, 2, 2, 4, 3, 3, 2, 1, 1]`. Max height is 4.\n\n**Stage 2 Reduction**\n\nRepeat the process for the `N1` height vector.\n\n| Column | Height (k) | FAs | HAs | Sum Bits (s) | Carry-out (c) |\n| :--- | :--- | :-- | :-- | :--- | :--- |\n| C0 | 1 | 0 | 0 | 1 | 0 |\n| C1 | 1 | 0 | 0 | 1 | 0 |\n| C2 | 2 | 0 | 1 | 1 | 1 |\n| C3 | 3 | 1 | 0 | 1 | 1 |\n| C4 | 3 | 1 | 0 | 1 | 1 |\n| C5 | 4 | 1 | 0 | 2 (1 sum + 1 pass) | 1 |\n| C6 | 2 | 0 | 1 | 1 | 1 |\n| C7 | 2 | 0 | 1 | 1 | 1 |\n| C8 | 2 | 0 | 1 | 1 | 1 |\n| C9 | 0 | 0 | 0 | 0 | 0 |\n| **Total**| | **3**| **4** | | |\n\nThe next column heights, `N2`, are calculated.\n- N2 heights: `[1, 2, 2, 2, 3, 2, 2, 1, 1, 1]`. Max height is 3.\n\n**Stage 3 Reduction**\n\nRepeat the process for the `N2` height vector.\n\n| Column | Height (k) | FAs | HAs | Sum Bits (s) | Carry-out (c) |\n| :--- | :--- | :-- | :-- | :--- | :--- |\n| C0 | 1 | 0 | 0 | 1 | 0 |\n| C1 | 1 | 0 | 0 | 1 | 0 |\n| C2 | 1 | 0 | 0 | 1 | 0 |\n| C3 | 2 | 0 | 1 | 1 | 1 |\n| C4 | 2 | 0 | 1 | 1 | 1 |\n| C5 | 3 | 1 | 0 | 1 | 1 |\n| C6 | 2 | 0 | 1 | 1 | 1 |\n| C7 | 2 | 0 | 1 | 1 | 1 |\n| C8 | 2 | 0 | 1 | 1 | 1 |\n| C9 | 1 | 0 | 0 | 1 | 0 |\n| **Total**| | **1**| **5** | | |\n\nThe final column heights, `N3`, are calculated.\n- N3 heights: `[2, 2, 2, 2, 2, 2, 1, 1, 1, 1]`.\nThe maximum height of any column is now 2. The reduction phase is complete.\n\n**Total Adder Count**\n\nSumming the adders used in each stage:\n- Total Full Adders (FAs) = 5 (Stage 1) + 3 (Stage 2) + 1 (Stage 3) = 9.\n- Total Half Adders (HAs) = 3 (Stage 1) + 4 (Stage 2) + 5 (Stage 3) = 12.\n\nThe entire reduction phase requires 9 Full Adders and 12 Half Adders.", "answer": "$$\\boxed{\\begin{pmatrix} 9 & 12 \\end{pmatrix}}$$", "id": "1977482"}, {"introduction": "A true test of comprehension comes from analyzing a circuit's behavior under non-ideal conditions. This problem bridges the gap between abstract logic design and practical computer arithmetic by exploring the consequences of a specific hardware defect. By tracing the impact of a single \"stuck-at-0\" fault on a carry-out wire, you will gain a deeper understanding of how the physical implementation of a Wallace tree directly determines the numerical accuracy of the final computed result [@problem_id:1977496].", "problem": "An engineer is designing a 5-bit unsigned binary multiplier that uses a Wallace tree architecture. The multiplier is intended to compute the product of a 5-bit multiplicand, $A = a_4a_3a_2a_1a_0$, and a 5-bit multiplier, $B = b_4b_3b_2b_1b_0$. The bits of the operands are indexed such that bit 0 is the Least Significant Bit (LSB) and bit 4 is the Most Significant Bit (MSB). In this architecture, the initial step is to generate an array of partial products. The bit resulting from the logical AND operation $a_j \\land b_i$ is positioned in a column corresponding to a bit weight of $2^{j+i}$.\n\nThe Wallace tree then reduces this array of partial products using multiple stages of parallel adders. The first reduction stage takes the initial array and applies Full Adders (FAs) and Half Adders (HAs) to reduce the number of rows. A Full Adder is a digital logic circuit that takes three input bits from a single column and produces a sum bit, which remains in the same column for the subsequent stage, and a carry-out bit, which is passed to the next more significant column (i.e., column $k+1$) for the subsequent stage.\n\nDuring post-fabrication testing, a defect is discovered. The carry-out wire of the Full Adder that processes the bits in the most significant column requiring a Full Adder in the first reduction stage is permanently stuck-at-0.\n\nFor a specific test case where the multiplicand is $A = 28$ and the multiplier is $B = 28$, calculate the numerical difference between the product computed by the faulty multiplier and the correct product. That is, find the value of $P_{\\text{faulty}} - P_{\\text{correct}}$.", "solution": "The problem asks for the error in the final product of a 5x5 Wallace tree multiplier due to a specific stuck-at-0 fault. The inputs are $A=28$ and $B=28$.\n\nFirst, we represent the multiplicand $A$ and the multiplier $B$ as 5-bit unsigned binary numbers.\n$A = 28_{10} = 16 + 8 + 4 = 1 \\cdot 2^4 + 1 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 0 \\cdot 2^0 = 11100_2$.\nSo, $a_4=1, a_3=1, a_2=1, a_1=0, a_0=0$.\n$B = 28_{10} = 11100_2$.\nSo, $b_4=1, b_3=1, b_2=1, b_1=0, b_0=0$.\n\nNext, we need to determine the structure of the initial partial product array for a general 5x5 multiplication. The bit $a_j \\land b_i$ is placed in column $j+i$. The columns are indexed from 0 to 8. We determine the height of each column (number of bits) in the initial array.\n\n- Column 0: $a_0b_0$ (Height: 1)\n- Column 1: $a_1b_0, a_0b_1$ (Height: 2)\n- Column 2: $a_2b_0, a_1b_1, a_0b_2$ (Height: 3)\n- Column 3: $a_3b_0, a_2b_1, a_1b_2, a_0b_3$ (Height: 4)\n- Column 4: $a_4b_0, a_3b_1, a_2b_2, a_1b_3, a_0b_4$ (Height: 5)\n- Column 5: $a_4b_1, a_3b_2, a_2b_3, a_1b_4$ (Height: 4)\n- Column 6: $a_4b_2, a_3b_3, a_2b_4$ (Height: 3)\n- Column 7: $a_4b_3, a_3b_4$ (Height: 2)\n- Column 8: $a_4b_4$ (Height: 1)\n\nA Full Adder (FA) is required to reduce any column with a height of 3 or more. The columns that require FAs in the first reduction stage are columns 2, 3, 4, 5, and 6.\n\nThe problem states that the fault occurs in the \"most significant column requiring a Full Adder\". Based on our analysis, this is column 6.\n\nThe FA in column 6 takes the three bits in that column as its inputs. These inputs are:\n1.  $I_1 = a_4b_2$\n2.  $I_2 = a_3b_3$\n3.  $I_3 = a_2b_4$\n\nNow, we evaluate these inputs for the given values of $A=11100_2$ and $B=11100_2$.\n- $a_4=1, a_3=1, a_2=1$\n- $b_4=1, b_3=1, b_2=1$\n\n- $I_1 = a_4 \\land b_2 = 1 \\land 1 = 1$\n- $I_2 = a_3 \\land b_3 = 1 \\land 1 = 1$\n- $I_3 = a_2 \\land b_4 = 1 \\land 1 = 1$\n\nThe inputs to the FA in column 6 are $(1, 1, 1)$.\n\nA Full Adder with inputs $(x, y, z)$ generates a sum $S = x \\oplus y \\oplus z$ and a carry-out $C_{out} = (x \\land y) \\lor (y \\land z) \\lor (z \\land x)$.\nFor the inputs $(1, 1, 1)$:\n- The sum bit is $S = 1 \\oplus 1 \\oplus 1 = 1$. This bit remains in column 6 for the next stage.\n- The correct carry-out bit is $C_{out} = (1 \\land 1) \\lor (1 \\land 1) \\lor (1 \\land 1) = 1$. This bit should be passed to column 7 for the next stage.\n\nThe fault is a stuck-at-0 on this carry-out wire. This means that regardless of the inputs, the carry-out is always 0.\n- Correct carry-out: $C_{correct} = 1$\n- Faulty carry-out: $C_{faulty} = 0$\n\nThis carry-out bit from column 6 contributes to column 7. The positional weight of a bit in column 7 is $2^7$. The error introduced in the final sum is the difference in the carry bit's value multiplied by its positional weight.\n\nError = $(C_{faulty} - C_{correct}) \\times (\\text{weight of column 7})$\nError = $(0 - 1) \\times 2^7$\nError = $-1 \\times 128$\nError = $-128$\n\nThis error directly translates to the difference between the faulty product and the correct product, because the Wallace tree is a summation circuit and the fault simply removes one term from the sum.\nTherefore, $P_{\\text{faulty}} - P_{\\text{correct}} = -128$.\n\nTo verify, the correct product is $28 \\times 28 = 784$. The faulty multiplier calculates a sum that is 128 less than the correct sum. So, $P_{\\text{faulty}} = 784 - 128 = 656$. The difference is $656 - 784 = -128$.", "answer": "$$\\boxed{-128}$$", "id": "1977496"}]}