{"hands_on_practices": [{"introduction": "The first and most critical requirement for any control system is stability. This exercise uses the Routh-Hurwitz criterion, a powerful analytical tool, to map out the stable operating region for a PD controller. By solving this problem, you will determine the exact relationship between the proportional gain $K_p$ and derivative gain $K_d$ that defines the boundary between stable behavior and instability, providing a concrete foundation for controller tuning.", "problem": "A simplified model for the attitude control of a small satellite is being analyzed. The satellite uses a Proportional-Derivative (PD) controller to maintain its orientation. The stability of the closed-loop control system is governed by its characteristic equation, which depends on the satellite's physical properties and the controller gains.\n\nThe characteristic equation is given by:\n$$s^3 + a s^2 + (b + K_d)s + (c + K_p) = 0$$\nHere, $s$ is the complex frequency variable. The parameters $a$, $b$, and $c$ are positive real constants that represent the inherent dynamics of the satellite and its actuators. $K_p$ is the proportional gain and $K_d$ is the derivative gain, which are the tunable parameters of the PD controller.\n\nFor the system to be on the verge of instability, exhibiting sustained oscillations, a particular relationship must exist between the gains $K_p$ and $K_d$. This critical boundary in the parameter space of the gains can be described by a linear equation of the form $K_p = m K_d + C$.\n\nDetermine the expressions for the slope $m$ and the intercept $C$ of this stability boundary line. The expressions should be in terms of the given positive constants $a, b,$ and $c$. Provide your answer as the expressions for $m$ and $C$, in that order.", "solution": "We are given the cubic characteristic polynomial\n$$s^{3} + a s^{2} + (b + K_{d}) s + (c + K_{p}) = 0.$$\nLet $A = a$, $B = b + K_{d}$, and $D = c + K_{p}$ so that the polynomial is $s^{3} + A s^{2} + B s + D$.\n\nFor a cubic $s^{3} + A s^{2} + B s + D$, the Routh array is\n$$\n\\begin{array}{cc}\ns^{3}:  1 \\quad B \\\\\ns^{2}:  A \\quad D \\\\\ns^{1}:  \\dfrac{A B - D}{A} \\quad 0 \\\\\ns^{0}:  D\n\\end{array}\n$$\nRouth-Hurwitz stability requires all first-column entries to be positive, namely $10$, $A0$, $\\dfrac{A B - D}{A}  0$, and $D0$. Since $a$, $b$, and $c$ are positive, we have $A = a  0$. The boundary of stability with sustained oscillations (purely imaginary roots) occurs when the first-column element in the $s^{1}$ row vanishes:\n$$A B - D = 0.$$\nSubstituting $A = a$, $B = b + K_{d}$, and $D = c + K_{p}$ gives\n$$a\\,(b + K_{d}) - (c + K_{p}) = 0.$$\nSolving for $K_{p}$,\n$$K_{p} = a\\,(b + K_{d}) - c = a K_{d} + a b - c.$$\nThis is of the form $K_{p} = m K_{d} + C$, hence\n$$m = a, \\quad C = a b - c.$$", "answer": "$$\\boxed{\\begin{pmatrix} a  a b - c \\end{pmatrix}}$$", "id": "1602726"}, {"introduction": "While a PD controller can stabilize many systems, it cannot overcome certain inherent physical limitations. This practice problem explores the challenging behavior of non-minimum phase systems, which are characterized by a counterintuitive initial response in the wrong direction. By analyzing a UAV altitude control model, you will see how the system's structure dictates an unavoidable undershoot, a critical lesson in understanding the fundamental trade-offs of control design.", "problem": "A simplified model for the vertical altitude control of a small Unmanned Aerial Vehicle (UAV) is being analyzed. Due to complex aerodynamic interactions, the system exhibits non-minimum phase behavior. The transfer function $P(s)$ from the motor control signal $U(s)$ to the resulting change in altitude $Y(s)$ is given by:\n$$P(s) = \\frac{A(z_0 - s)}{(s+p)^2}$$\nwhere $A$, $z_0$, and $p$ are positive real constants representing the system gain, the location of a non-minimum phase zero, and the pole location, respectively.\n\nTo regulate the UAV's altitude, a Proportional-Derivative (PD) controller is implemented. To prevent large control signal spikes from step changes in the desired altitude, the controller is designed such that its derivative action acts only on the measured altitude, not on the complete error signal. The control signal $U(s)$ is therefore generated according to the following relationship:\n$$U(s) = K_p(R(s) - Y(s)) - K_d s Y(s)$$\nwhere $R(s)$ is the desired altitude reference, $K_p$ is the proportional gain, and $K_d$ is the derivative gain. Both $K_p$ and $K_d$ are positive real constants.\n\nAssuming the system is initially at rest, a unit step command for the desired altitude is applied at $t=0$, meaning $R(s)=1/s$. Determine the initial velocity of the UAV's altitude change, $\\dot{y}(0^+) = \\lim_{t \\to 0^+} \\frac{dy(t)}{dt}$. Provide your answer as a closed-form analytic expression in terms of the parameters $A$, $p$, $z_0$, $K_p$, and $K_d$.", "solution": "We use Laplace-domain analysis and the initial value theorem for derivatives. With zero initial conditions, the initial slope is given by\n$$\n\\dot{y}(0^{+})=\\lim_{t\\to 0^{+}}\\frac{dy(t)}{dt}=\\lim_{s\\to\\infty}s\\left[sY(s)-y(0)\\right]=\\lim_{s\\to\\infty}s^{2}Y(s),\n$$\nwhere $y(0)=0$ due to initial rest and strict properness of the closed loop.\n\nThe plant is\n$$\nP(s)=\\frac{A(z_{0}-s)}{(s+p)^{2}},\n$$\nand the controller law is\n$$\nU(s)=K_{p}(R(s)-Y(s))-K_{d}sY(s).\n$$\nThe loop equation is $Y(s)=P(s)U(s)$, so\n$$\nY(s)=P(s)\\left[K_{p}R(s)-(K_{p}+K_{d}s)Y(s)\\right].\n$$\nThus,\n$$\nY(s)\\left[1+P(s)\\left(K_{p}+K_{d}s\\right)\\right]=P(s)K_{p}R(s),\n$$\nand the closed-loop transfer function from $R$ to $Y$ is\n$$\nT(s)\\equiv\\frac{Y(s)}{R(s)}=\\frac{P(s)K_{p}}{1+P(s)\\left(K_{p}+K_{d}s\\right)}.\n$$\nFor a unit step input, $R(s)=\\frac{1}{s}$, so $Y(s)=\\frac{T(s)}{s}$ and\n$$\n\\dot{y}(0^{+})=\\lim_{s\\to\\infty}s^{2}\\frac{T(s)}{s}=\\lim_{s\\to\\infty}s\\,T(s).\n$$\nSubstitute $P(s)$:\n$$\nT(s)=\\frac{A K_{p}(z_{0}-s)/(s+p)^{2}}{1+\\frac{A(z_{0}-s)}{(s+p)^{2}}(K_{p}+K_{d}s)}\n=\\frac{A K_{p}(z_{0}-s)}{(s+p)^{2}+A(z_{0}-s)(K_{p}+K_{d}s)}.\n$$\nExpand the denominator:\n$$\n(s+p)^{2}+A(z_{0}-s)(K_{p}+K_{d}s)\n=s^{2}+2ps+p^{2}+A(z_{0}K_{p}+z_{0}K_{d}s-K_{p}s-K_{d}s^{2})\n$$\n$$\n=(1-AK_{d})s^{2}+\\left(2p+A z_{0}K_{d}-A K_{p}\\right)s+\\left(p^{2}+A z_{0}K_{p}\\right).\n$$\nThe numerator is\n$$\nA K_{p}(z_{0}-s)=-A K_{p}s+A K_{p}z_{0}.\n$$\nTherefore,\n$$\ns\\,T(s)=\\frac{s\\left(-A K_{p}s+A K_{p}z_{0}\\right)}{(1-AK_{d})s^{2}+\\left(2p+A z_{0}K_{d}-A K_{p}\\right)s+\\left(p^{2}+A z_{0}K_{p}\\right)}.\n$$\nTaking the limit as $s\\to\\infty$ and comparing leading powers,\n$$\n\\dot{y}(0^{+})=\\lim_{s\\to\\infty}s\\,T(s)=\\frac{-A K_{p}}{1-A K_{d}},\n$$\nprovided $1-AK_{d}\\neq 0$. This result can also be obtained directly from the high-frequency approximation $P(s)\\sim -A/s$ as $s\\to\\infty$, which implies $\\dot{y}(0^{+})=-A\\,u(0^{+})$, and with $u(0^{+})=K_{p}-K_{d}\\dot{y}(0^{+})$ one obtains the same expression after solving for $\\dot{y}(0^{+})$.", "answer": "$$\\boxed{-\\frac{A K_{p}}{1-A K_{d}}}$$", "id": "1602752"}, {"introduction": "Control design often relies on simplified models, but the real world is full of complexities like structural vibrations and sensor noise. This exercise demonstrates a critical pitfall of derivative action: its tendency to amplify high-frequency signals. By examining a robotic arm with an unmodeled resonance, you will discover how increasing the derivative gain $K_d$ can unexpectedly destabilize an otherwise well-behaved system, illustrating a crucial consideration for robust, real-world controller implementation.", "problem": "A control engineer is designing a Proportional-Derivative (PD) controller for a single-joint robotic arm. A simplified model of the arm's dynamics is initially used, representing it as a standard second-order system. The transfer function of this simplified plant is:\n$$ P_{simple}(s) = \\frac{1}{s^2 + s + 1} $$\nHowever, the actual physical system possesses a high-frequency, lightly-damped structural resonance that was neglected in the simplified model. The more accurate transfer function for the actual plant is given by:\n$$ P_{actual}(s) = \\left(\\frac{1}{s^2 + s + 1}\\right) \\left(\\frac{\\omega_r^2}{s^2 + 2\\zeta_r \\omega_r s + \\omega_r^2}\\right) $$\nwhere the second term models the parasitic resonance.\n\nThe PD controller, with transfer function $C(s) = K_p + K_d s$, is placed in a unity negative feedback loop with the actual plant, $P_{actual}(s)$. The engineer chooses a proportional gain of $K_p = 8$. It is observed that for a zero derivative gain ($K_d = 0$), the closed-loop system is stable. However, increasing the derivative gain $K_d$ can destabilize the system by amplifying the response at the resonant frequency $\\omega_r$.\n\nGiven the parameters for the parasitic resonance are $\\omega_r = 10 \\text{ rad/s}$ and $\\zeta_r = 0.05$, determine the smallest positive value of the derivative gain $K_d$ for which the closed-loop system becomes marginally stable. Express your answer for $K_d$, which is a dimensionless gain, rounded to three significant figures.", "solution": "The closed-loop characteristic equation for unity negative feedback with controller $C(s)=K_{p}+K_{d}s$ and plant $P_{actual}(s)$ is obtained from $1 + C(s)P_{actual}(s) = 0$. With\n$$\nP_{actual}(s) = \\frac{1}{s^{2}+s+1}\\cdot\\frac{\\omega_{r}^{2}}{s^{2}+2\\zeta_{r}\\omega_{r}s+\\omega_{r}^{2}},\n$$\nwe have the characteristic polynomial\n$$\n\\Delta(s) = (s^{2}+s+1)(s^{2}+2\\zeta_{r}\\omega_{r}s+\\omega_{r}^{2}) + \\omega_{r}^{2}(K_{p}+K_{d}s).\n$$\nExpanding the product,\n$$\n(s^{2}+s+1)(s^{2}+2\\zeta_{r}\\omega_{r}s+\\omega_{r}^{2}) = s^{4} + (1+2\\zeta_{r}\\omega_{r})s^{3} + (\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r}+1)s^{2} + (\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r})s + \\omega_{r}^{2}.\n$$\nTherefore,\n$$\n\\Delta(s) = s^{4} + (1+2\\zeta_{r}\\omega_{r})s^{3} + (\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r}+1)s^{2} + \\bigl(\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r}+\\omega_{r}^{2}K_{d}\\bigr)s + \\omega_{r}^{2}(1+K_{p}).\n$$\nSubstituting $\\omega_{r}=10$, $\\zeta_{r}=0.05$, and $K_{p}=8$ gives\n$$\n\\Delta(s) = s^{4} + 2s^{3} + 102s^{2} + (101+100K_{d})s + 900.\n$$\nTo find the smallest positive $K_{d}$ at marginal stability, apply the Routh-Hurwitz test for a quartic $s^{4}+a_{1}s^{3}+a_{2}s^{2}+a_{3}s+a_{4}$ with $a_{1}=2$, $a_{2}=102$, $a_{3}=101+100K_{d}$, $a_{4}=900$. The Routh array leading elements are:\n- $s^{4}$ row: $1,\\;a_{2},\\;a_{4} = 1,\\;102,\\;900$,\n- $s^{3}$ row: $a_{1},\\;a_{3},\\;0 = 2,\\;101+100K_{d},\\;0$,\n- $s^{2}$ row first element $b_{1} = \\frac{a_{1}a_{2}-a_{3}}{a_{1}} = \\frac{2\\cdot 102 -(101+100K_{d})}{2} = \\frac{103-100K_{d}}{2}$, and second element $b_{2}=\\frac{a_{1}a_{4}-0}{a_{1}}=900$,\n- $s^{1}$ row first element $c_{1} = \\frac{b_{1}a_{3}-a_{1}b_{2}}{b_{1}} = (101+100K_{d}) - \\frac{1800}{b_{1}}$.\n\nMarginal stability occurs when a first-column entry becomes zero while the preceding ones are positive. Starting from $K_{d}=0$, all entries are positive, so the first loss of strict positivity occurs when $c_{1}=0$ (since $b_{1}=0$ would occur later at $K_{d}=\\frac{103}{100}$). Setting $c_{1}=0$ yields\n$$\n(101+100K_{d}) = \\frac{1800}{b_{1}} = \\frac{3600}{103-100K_{d}},\n$$\nso\n$$\n(101+100K_{d})(103-100K_{d}) = 3600.\n$$\nExpanding and simplifying,\n$$\n-10000K_{d}^{2} + 200K_{d} + 10403 = 3600 \\;\\;\\Rightarrow\\;\\; 10000K_{d}^{2} - 200K_{d} - 6803 = 0.\n$$\nSolving the quadratic for $K_{d}$,\n$$\nK_{d} = \\frac{200 \\pm \\sqrt{200^{2} + 4\\cdot 10000 \\cdot 6803}}{2\\cdot 10000} = \\frac{200 \\pm \\sqrt{272160000}}{20000}.\n$$\nTaking the positive root gives\n$$\nK_{d} = \\frac{200 + \\sqrt{272160000}}{20000} = \\frac{2 + \\sqrt{27216}}{200} \\approx 0.834864.\n$$\nSince $b_{1}=\\frac{103-100K_{d}}{2}$ remains positive at this value and $b_{1}=0$ occurs later at $K_{d}=1.03$, the smallest positive derivative gain producing marginal stability is $K_{d}\\approx 0.835$ when rounded to three significant figures.", "answer": "$$\\boxed{0.835}$$", "id": "1602753"}]}