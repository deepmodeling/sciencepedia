{"hands_on_practices": [{"introduction": "A primary goal of feedback control is to maintain system performance despite unknown external influences. This first exercise provides a quantitative look at the most fundamental principle of disturbance rejection. By analyzing a simple temperature control system, we can directly see how the gain of the feedback loop impacts the system's ability to suppress a constant external disturbance, providing a concrete understanding of the sensitivity function in action. [@problem_id:1572075]", "problem": "A temperature control system for a small experimental oven is designed using a unity negative feedback configuration. The thermal behavior of the oven (the plant) is modeled by the first-order transfer function $P(s) = \\frac{K}{\\tau s + 1}$, where $K$ is the DC gain and $\\tau$ is the time constant. A proportional controller with gain $K_p$, represented by $C(s) = K_p$, is used to regulate the temperature.\n\nThe system is subject to an external thermal disturbance, such as a sudden draft of cold air, which is modeled as a constant disturbance $d_0$ added directly to the output of the plant. We are interested in the steady-state temperature deviation from the setpoint caused by this disturbance, assuming the reference temperature setpoint itself remains unchanged. Let the initial DC loop gain, defined as the product of the controller's gain and the plant's DC gain, be denoted by $L_0 = K_p K$.\n\nNow, an engineer modifies the oven's insulation and heating element. This modification has the net effect of doubling the plant's DC gain $K$ while leaving its time constant $\\tau$ and the controller gain $K_p$ unchanged.\n\nWhich of the following expressions represents the ratio of the new steady-state temperature deviation (after the modification) to the original steady-state temperature deviation (before the modification)?\n\nA. $\\frac{1+L_0}{1+2L_0}$\n\nB. $\\frac{1+2L_0}{1+L_0}$\n\nC. $\\frac{1}{2}$\n\nD. $2$\n\nE. $\\frac{L_0}{1+2L_0}$", "solution": "The plant and controller are given by $P(s) = \\frac{K}{\\tau s + 1}$ and $C(s) = K_{p}$, with unity negative feedback. A constant disturbance $d_{0}$ is added at the plant output. Let $r$ be the reference input and $y$ the output. The closed-loop relationship with an output disturbance is obtained from\n$$\ny = P C (r - y) + d,\n$$\nwhich rearranges to\n$$\ny (1 + P C) = P C\\, r + d.\n$$\nThus, the transfer functions from $r$ and $d$ to $y$ are\n$$\n\\frac{y}{r} = \\frac{P C}{1 + P C} \\equiv T(s), \\quad \\frac{y}{d} = \\frac{1}{1 + P C} \\equiv S(s).\n$$\nHere $S(s)$ is the sensitivity function. With the setpoint held constant and the disturbance being a constant $d(t) = d_{0}$, its Laplace transform is $d(s) = \\frac{d_{0}}{s}$. The steady-state output deviation from the setpoint caused by this disturbance equals the steady-state output due solely to $d$, given by the final value theorem:\n$$\n\\lim_{t \\to \\infty} (y(t) - r) = \\lim_{t \\to \\infty} y_{d}(t) = \\lim_{s \\to 0} s \\left( S(s) \\frac{d_{0}}{s} \\right) = S(0)\\, d_{0}.\n$$\nAt $s = 0$, the loop gain is $L(0) = C(0) P(0) = K_{p} K \\equiv L_{0}$, so initially\n$$\nS_{\\text{old}}(0) = \\frac{1}{1 + L_{0}}.\n$$\nAfter doubling $K$ (with $\\tau$ and $K_{p}$ unchanged), the new DC loop gain is $L_{\\text{new}}(0) = K_{p} (2K) = 2 L_{0}$, hence\n$$\nS_{\\text{new}}(0) = \\frac{1}{1 + 2 L_{0}}.\n$$\nTherefore, the ratio of the new steady-state temperature deviation to the original one is\n$$\n\\frac{S_{\\text{new}}(0)\\, d_{0}}{S_{\\text{old}}(0)\\, d_{0}} = \\frac{\\frac{1}{1 + 2 L_{0}}}{\\frac{1}{1 + L_{0}}} = \\frac{1 + L_{0}}{1 + 2 L_{0}}.\n$$\nThis corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1572075"}, {"introduction": "Building upon the core idea of loop gain, we now explore a critical nuance: the effect of a disturbance depends heavily on where it enters the system. Is an unwanted signal more problematic if it affects the process input or the final output? This practice directly compares these two common scenarios, revealing how the plant's own characteristics interact with the feedback loop to determine the final error. [@problem_id:1572095]", "problem": "Consider a unity negative feedback control system designed to regulate a process. The controller is a simple proportional controller with a transfer function given by $C(s) = K_p$, where $K_p$ is a positive gain constant. The process, or plant, is modeled as a stable first-order system with a transfer function $P(s) = \\frac{K}{Ts+1}$, where $K$ is the positive DC gain and $T$ is the positive time constant.\n\nThe system is subject to an unwanted constant disturbance, $d(t)$, of magnitude $d_0$, which has the Laplace transform $D(s) = \\frac{d_0}{s}$. To analyze the system's disturbance rejection capability, we evaluate its performance with a zero reference input, i.e., $r(t) = 0$. The error signal is defined as the difference between the reference and the output, $e(t) = r(t) - y(t)$.\n\nWe will compare two distinct scenarios for where this disturbance enters the system:\n\n1.  **Input Disturbance:** The disturbance is added to the controller's output signal, just before the plant.\n2.  **Output Disturbance:** The disturbance is added to the plant's output signal.\n\nLet $e_{ss,1}$ be the steady-state error for the input disturbance case, and let $e_{ss,2}$ be the steady-state error for the output disturbance case.\n\nDetermine the value of the ratio of the magnitudes of these two steady-state errors, $\\frac{|e_{ss,1}|}{|e_{ss,2}|}$. Express your answer as a closed-form analytic expression in terms of the given symbolic parameters.", "solution": "We consider a unity negative feedback system with controller $C(s)=K_{p}$ and plant $P(s)=\\frac{K}{Ts+1}$, subject to a constant disturbance $D(s)=\\frac{d_{0}}{s}$ and zero reference $R(s)=0$. The error is $E(s)=R(s)-Y(s)=-Y(s)$. We assume closed-loop stability so that the final value theorem applies.\n\nCase 1: Input disturbance (added before the plant). The plant input is $U_{\\text{in}}(s)=C(s)E(s)+D(s)$. The output is\n$$\nY(s)=P(s)U_{\\text{in}}(s)=P(s)\\big(C(s)E(s)+D(s)\\big)=P(s)\\big(C(s)(-Y(s))+D(s)\\big).\n$$\nRearranging,\n$$\nY(s)+P(s)C(s)Y(s)=P(s)D(s)\\;\\;\\Rightarrow\\;\\;Y(s)=\\frac{P(s)}{1+P(s)C(s)}D(s).\n$$\nHence\n$$\nE(s)=-Y(s)=-\\frac{P(s)}{1+P(s)C(s)}D(s).\n$$\nBy the final value theorem,\n$$\ne_{ss,1}=\\lim_{t\\to\\infty}e(t)=\\lim_{s\\to 0}sE(s)=\\lim_{s\\to 0}\\left[-\\frac{P(s)}{1+P(s)C(s)}\\,d_{0}\\right].\n$$\nEvaluating at $s=0$ gives $P(0)=K$ and $C(0)=K_{p}$, thus\n$$\ne_{ss,1}=-\\frac{K}{1+KK_{p}}\\,d_{0},\\quad |e_{ss,1}|=\\frac{K}{1+KK_{p}}\\,|d_{0}|.\n$$\n\nCase 2: Output disturbance (added at the plant output). The measured output is\n$$\nY(s)=P(s)C(s)E(s)+D(s).\n$$\nWith $E(s)=-Y(s)$, we have\n$$\nE(s)=-\\big(P(s)C(s)E(s)+D(s)\\big)\\;\\;\\Rightarrow\\;\\;E(s)+P(s)C(s)E(s)=-D(s),\n$$\nso\n$$\nE(s)=-\\frac{1}{1+P(s)C(s)}D(s).\n$$\nThen\n$$\ne_{ss,2}=\\lim_{s\\to 0}sE(s)=\\lim_{s\\to 0}\\left[-\\frac{1}{1+P(s)C(s)}\\,d_{0}\\right]=-\\frac{1}{1+KK_{p}}\\,d_{0},\n$$\nand\n$$\n|e_{ss,2}|=\\frac{1}{1+KK_{p}}\\,|d_{0}|.\n$$\n\nTherefore, the ratio of the magnitudes of the steady-state errors is\n$$\n\\frac{|e_{ss,1}|}{|e_{ss,2}|}=\\frac{\\frac{K}{1+KK_{p}}|d_{0}|}{\\frac{1}{1+KK_{p}}|d_{0}|}=K.\n$$\nThis ratio is independent of $K_{p}$, $T$, and $d_{0}$.", "answer": "$$\\boxed{K}$$", "id": "1572095"}, {"introduction": "While high-gain feedback can reduce errors, some applications demand their complete elimination. This practice introduces a more advanced and powerful concept: the Internal Model Principle. By considering a high-precision system affected by both a constant drift and a persistent vibration, we can determine the specific controller structure required to achieve perfect, asymptotic rejection of these unwanted signals, moving beyond mere suppression to targeted cancellation. [@problem_id:1572074]", "problem": "A high-precision optical trapping system is used in a biophysics laboratory to hold a microscopic dielectric bead at a fixed reference position. The system's dynamics are modeled by a plant with transfer function $P(s)$. A controller $C(s)$ is used in a unity negative feedback configuration to maintain the bead's position.\n\nThe system is subject to external disturbances that are additively combined with the plant's output. The total disturbance signal, $d(t)$, consists of two components: a constant offset $A$ due to slow thermal drift in the system's electronics, and a sinusoidal vibration of amplitude $B$ and angular frequency $\\omega_0$ transmitted from a nearby piece of equipment. The total disturbance can thus be written as:\n$$d(t) = A + B\\sin(\\omega_0 t)$$\nwhere $A$, $B$, and $\\omega_0$ are positive real constants.\n\nAssume the plant $P(s)$ is stable and does not have any poles located at $s=0$ or at $s = \\pm j\\omega_0$. Also assume that the controller $C(s)$ is designed such that the overall closed-loop system is stable.\n\nTo ensure that the position error caused by the disturbance $d(t)$ asymptotically approaches zero (i.e., $\\lim_{t\\to\\infty} e(t) = 0$), what is the minimal set of poles that the controller transfer function $C(s)$ must contain?\n\nA. A single pole at $s=0$.\n\nB. A pair of poles at $s = \\pm j\\omega_0$.\n\nC. A single pole at $s=0$ and a pair of poles at $s = \\pm j\\omega_0$.\n\nD. A double pole at $s=0$.\n\nE. A pair of poles at $s = \\pm \\omega_0$.\n\nF. No specific poles are required; a sufficiently high-gain proportional controller can achieve this.", "solution": "Let the loop transfer function be $L(s) = P(s)C(s)$. In unity negative feedback, with the disturbance $d$ added at the plant output, the closed-loop relations are\n$$y(s) = \\frac{L(s)}{1+L(s)}\\,r(s) + \\frac{1}{1+L(s)}\\,d(s), \\quad e(s) = r(s) - y(s).$$\nDefine the sensitivity $S(s) = \\frac{1}{1+L(s)}$ and the complementary sensitivity $T(s) = \\frac{L(s)}{1+L(s)}$. Then\n$$e(s) = r(s) - \\left(T(s)r(s) + S(s)d(s)\\right) = S(s)r(s) - S(s)d(s).$$\nThus, the transfer function from $d$ to $e$ is $G_{ed}(s) = -S(s)$. To make the position error caused by $d(t)$ asymptotically vanish for the given disturbance components, we require that the steady response of $e$ to each component is zero.\n\n1) Constant component $A$. Its Laplace transform is $d_{A}(s) = \\frac{A}{s}$. The error contribution is\n$$e_{A}(s) = -S(s)\\frac{A}{s}.$$\nBy the Final Value Theorem (closed-loop stable by assumption),\n$$\\lim_{t\\to\\infty} e_{A}(t) = \\lim_{s\\to 0} s e_{A}(s) = \\lim_{s\\to 0} \\left(-A S(s)\\right).$$\nHence we need $S(0)=0$. Since $S(0) = \\frac{1}{1+L(0)}$, this requires $|L(0)| \\to \\infty$. The plant has no pole at $s=0$ and is stable, so $P(0)$ is finite and nonzero. Therefore the only way to achieve $|L(0)| \\to \\infty$ is for the controller to contribute a pole at $s=0$ (integral action). A single pole at $s=0$ is sufficient for perfect rejection of a constant disturbance; a double pole is not necessary for this disturbance class.\n\n2) Sinusoidal component $B\\sin(\\omega_{0} t)$. Its Laplace transform is $d_{B}(s) = \\frac{B\\omega_{0}}{s^{2}+\\omega_{0}^{2}}$. The steady-state sinusoidal error due to this input is governed by the frequency response at $\\omega_{0}$:\n$$e_{B,ss}(t) = \\Re\\left\\{-S(j\\omega_{0})\\,B \\exp(j\\omega_{0} t)\\right\\}.$$\nTo have $e_{B,ss}(t) \\equiv 0$, we require $S(j\\omega_{0}) = 0$. Since $S(j\\omega_{0}) = \\frac{1}{1+L(j\\omega_{0})}$, this requires $|L(j\\omega_{0})| \\to \\infty$. The plant has no poles at $s=\\pm j\\omega_{0}$ and is stable, so $P(j\\omega_{0})$ is finite and nonzero. Thus, to make $|L(j\\omega_{0})| \\to \\infty$, the controller must include an internal model of the sinusoid, namely a pair of poles at $s=\\pm j\\omega_{0}$.\n\nBy the Internal Model Principle, the minimal internal model that guarantees asymptotic rejection of the exogenous signals $A$ and $B\\sin(\\omega_{0} t)$ is the union of the required generators: one integrator at $s=0$ for the constant and a resonant pair at $s=\\pm j\\omega_{0}$ for the sinusoid. This corresponds to option C. Options A or B alone reject only one of the two components; option D is not minimal for a constant disturbance; option E places real poles and does not provide infinite loop gain at $s=\\pm j\\omega_{0}$; option F cannot achieve exact zero error because finite proportional gain yields $S(j\\omega)\\neq 0$.", "answer": "$$\\boxed{C}$$", "id": "1572074"}]}