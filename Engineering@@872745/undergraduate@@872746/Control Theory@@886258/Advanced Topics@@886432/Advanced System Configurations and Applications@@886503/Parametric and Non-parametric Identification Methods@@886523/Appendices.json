{"hands_on_practices": [{"introduction": "A foundational task in system identification is to create a simple model from experimental data. This first exercise guides you through one of the most common methods: estimating the parameters of a first-order system from its step response. By analyzing how a system reacts to a sudden, constant input, we can extract its key dynamic characteristics—the DC gain and the dominant time constant—providing a powerful yet intuitive way to build a working model [@problem_id:1597885].", "problem": "An engineering student is tasked with creating a simplified dynamic model for a small, self-balancing electric scooter. To do this, they conduct an experiment. With the scooter initially at rest ($t=0$), a constant command voltage of $U_0 = 5.0$ V is applied to the wheel's motor controller, and the resulting forward speed, $v$, is recorded over time. The collected data of time-speed pairs are as follows:\n\n- (0.0 s, 0.00 m/s)\n- (0.5 s, 0.46 m/s)\n- (1.0 s, 0.81 m/s)\n- (1.5 s, 1.14 m/s)\n- (2.0 s, 1.36 m/s)\n- (2.5 s, 1.59 m/s)\n- (3.0 s, 1.73 m/s)\n- (4.0 s, 2.03 m/s)\n- (5.0 s, 2.15 m/s)\n- (8.0 s, 2.41 m/s)\n- (10.0 s, 2.46 m/s)\n- (12.0 s, 2.51 m/s)\n- (15.0 s, 2.49 m/s)\n- (18.0 s, 2.50 m/s)\n\nAssuming the scooter's speed dynamics can be approximated by a first-order linear system, estimate the two key parameters of this model: the DC gain and the dominant time constant.\n\nYour final answer should be a row matrix containing two numbers: the estimated DC gain first, followed by the estimated time constant. The DC gain should be expressed in units of (m/s)/V and the time constant in seconds. Both values must be rounded to two significant figures.", "solution": "For a first-order linear system driven by a step input of magnitude $U_{0}$ at $t=0$, the transfer function is assumed to be\n$$\nG(s)=\\frac{K}{\\tau s+1},\n$$\nso the step response of the speed is\n$$\nv(t)=K\\,U_{0}\\left(1-\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right), \\quad t\\geq 0.\n$$\nThe steady-state (DC) value is\n$$\nv_{\\infty}=\\lim_{t\\to\\infty}v(t)=K\\,U_{0}\\;\\Rightarrow\\;K=\\frac{v_{\\infty}}{U_{0}}.\n$$\nFrom the data, the speed approaches a steady value near the last samples (10 s to 18 s): $2.46$, $2.51$, $2.49$, $2.50$ m/s. Taking $v_{\\infty}\\approx 2.50$ m/s and $U_{0}=5.0$ V gives\n$$\nK=\\frac{2.50}{5.0}=0.50\\;\\text{(m/s)/V}.\n$$\nFor a first-order step response, the time constant $\\tau$ satisfies\n$$\nv(\\tau)=v_{\\infty}\\left(1-\\exp(-1)\\right)\\approx 0.632\\,v_{\\infty}.\n$$\nWith $v_{\\infty}\\approx 2.50$ m/s, the target level is\n$$\nv_{\\text{target}}=0.632\\times 2.50=1.58\\;\\text{m/s}.\n$$\nFrom the measurements, $v=1.36$ m/s at $t_{1}=2.0$ s and $v=1.59$ m/s at $t_{2}=2.5$ s, so $v_{\\text{target}}$ lies between these times. Using linear interpolation,\n$$\n\\tau\\approx t_{1}+\\frac{v_{\\text{target}}-v(t_{1})}{v(t_{2})-v(t_{1})}\\,(t_{2}-t_{1})\n=2.0+\\frac{1.58-1.36}{1.59-1.36}\\times 0.5\\approx 2.48\\;\\text{s}.\n$$\nRounded to two significant figures, $\\tau\\approx 2.5$ s. Therefore, the estimated parameters are a DC gain of $0.50$ (m/s)/V and a dominant time constant of $2.5$ s.", "answer": "$$\\boxed{\\begin{pmatrix} 0.50 & 2.5 \\end{pmatrix}}$$", "id": "1597885"}, {"introduction": "While graphical methods are intuitive, a more rigorous and broadly applicable approach is the method of least squares. This practice introduces the core mechanics of this powerful technique, tasking you with setting up and solving the equations to identify a multi-input system model. This exercise is key to understanding how to computationally fit a model to data, a central skill in modern control and data science [@problem_id:1597904].", "problem": "A control engineer is developing a simplified thermal model for a specific component on a complex circuit board. The temperature of the component at discrete time step $k$, denoted by $T(k)$ in degrees Celsius, is hypothesized to be linearly dependent on its temperature at the previous time step, $T(k-1)$, and the power dissipated by two nearby heat sources, $P_1(k-1)$ and $P_2(k-1)$, both in Watts.\n\nThe proposed discrete-time model is given by the following linear difference equation:\n$$T(k) = -a_1 T(k-1) + b_1 P_1(k-1) + b_2 P_2(k-1)$$\nwhere $a_1$, $b_1$, and $b_2$ are unknown real-valued parameters that characterize the thermal dynamics. To identify these parameters, an experiment was conducted, and the following sequence of measurements was recorded:\n\n| Time step, $k$ | Temperature, $T(k)$ (°C) | Power source 1, $P_1(k)$ (W) | Power source 2, $P_2(k)$ (W) |\n| :---: | :---: | :---: | :---: |\n| 0 | 1 | 2 | 1 |\n| 1 | 2 | -1 | 0 |\n| 2 | -1 | -2 | 1 |\n| 3 | -2 | 1 | 1 |\n| 4 | 3 | not applicable | not applicable |\n\nUsing the provided data and the method of least squares, determine the optimal estimate for the parameter vector $\\theta = [a_1, b_1, b_2]^T$. Present your answer as a column vector of numerical values. The parameters are dimensionless. Round your final answer for each parameter to three significant figures.", "solution": "We are given the discrete-time linear model\n$$T(k) = -a_{1} T(k-1) + b_{1} P_{1}(k-1) + b_{2} P_{2}(k-1),$$\nwith unknown parameters $\\theta = [a_{1}, b_{1}, b_{2}]^{T}$. Using measurements for $k=1,2,3,4$, we express the model in linear regression form $y = X \\theta$, where each row of $X$ is $[-T(k-1),\\, P_{1}(k-1),\\, P_{2}(k-1)]$ and $y$ collects $T(k)$.\n\nFrom the data:\n- For $k=1$: $T(0)=1$, $P_{1}(0)=2$, $P_{2}(0)=1$, $T(1)=2$ gives row $[-1,\\,2,\\,1]$, $y_{1}=2$.\n- For $k=2$: $T(1)=2$, $P_{1}(1)=-1$, $P_{2}(1)=0$, $T(2)=-1$ gives row $[-2,\\,-1,\\,0]$, $y_{2}=-1$.\n- For $k=3$: $T(2)=-1$, $P_{1}(2)=-2$, $P_{2}(2)=1$, $T(3)=-2$ gives row $[1,\\,-2,\\,1]$, $y_{3}=-2$.\n- For $k=4$: $T(3)=-2$, $P_{1}(3)=1$, $P_{2}(3)=1$, $T(4)=3$ gives row $[2,\\,1,\\,1]$, $y_{4}=3$.\n\nThus\n$$\nX=\\begin{pmatrix}\n-1 & 2 & 1\\\\\n-2 & -1 & 0\\\\\n1 & -2 & 1\\\\\n2 & 1 & 1\n\\end{pmatrix},\\quad\ny=\\begin{pmatrix}\n2\\\\\n-1\\\\\n-2\\\\\n3\n\\end{pmatrix}.\n$$\n\nThe least-squares estimate satisfies the normal equations\n$$\nX^{T}X\\,\\theta = X^{T}y.\n$$\nLet the columns of $X$ be $c_{1}, c_{2}, c_{3}$:\n$$\nc_{1}=\\begin{pmatrix}-1\\\\-2\\\\1\\\\2\\end{pmatrix},\\quad\nc_{2}=\\begin{pmatrix}2\\\\-1\\\\-2\\\\1\\end{pmatrix},\\quad\nc_{3}=\\begin{pmatrix}1\\\\0\\\\1\\\\1\\end{pmatrix}.\n$$\nThen\n$$\nX^{T}X=\\begin{pmatrix}\nc_{1}\\cdot c_{1} & c_{1}\\cdot c_{2} & c_{1}\\cdot c_{3}\\\\\nc_{2}\\cdot c_{1} & c_{2}\\cdot c_{2} & c_{2}\\cdot c_{3}\\\\\nc_{3}\\cdot c_{1} & c_{3}\\cdot c_{2} & c_{3}\\cdot c_{3}\n\\end{pmatrix}\n=\\begin{pmatrix}\n10 & 0 & 2\\\\\n0 & 10 & 1\\\\\n2 & 1 & 3\n\\end{pmatrix},\n\\quad\nX^{T}y=\\begin{pmatrix}\nc_{1}\\cdot y\\\\\nc_{2}\\cdot y\\\\\nc_{3}\\cdot y\n\\end{pmatrix}\n=\\begin{pmatrix}\n4\\\\\n12\\\\\n3\n\\end{pmatrix}.\n$$\n\nTherefore, we solve\n$$\n\\begin{pmatrix}\n10 & 0 & 2\\\\\n0 & 10 & 1\\\\\n2 & 1 & 3\n\\end{pmatrix}\n\\begin{pmatrix}\na_{1}\\\\\nb_{1}\\\\\nb_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4\\\\\n12\\\\\n3\n\\end{pmatrix}.\n$$\nFrom the first and second equations:\n$$\n10 a_{1} + 2 b_{2} = 4 \\;\\Rightarrow\\; a_{1} = \\frac{4 - 2 b_{2}}{10},\n\\qquad\n10 b_{1} + b_{2} = 12 \\;\\Rightarrow\\; b_{1} = \\frac{12 - b_{2}}{10}.\n$$\nSubstitute into the third equation $2 a_{1} + b_{1} + 3 b_{2} = 3$:\n$$\n2\\left(\\frac{4 - 2 b_{2}}{10}\\right) + \\left(\\frac{12 - b_{2}}{10}\\right) + 3 b_{2} = 3,\n$$\n$$\n\\frac{8 - 4 b_{2}}{10} + \\frac{12 - b_{2}}{10} + 3 b_{2} = 3,\n$$\n$$\n\\frac{20 - 5 b_{2}}{10} + 3 b_{2} = 3 \\;\\Rightarrow\\; 2 + \\frac{5}{2} b_{2} = 3 \\;\\Rightarrow\\; b_{2} = \\frac{2}{5}.\n$$\nThen\n$$\na_{1} = \\frac{4 - 2\\cdot \\frac{2}{5}}{10} = \\frac{4 - \\frac{4}{5}}{10} = \\frac{\\frac{16}{5}}{10} = \\frac{8}{25},\n\\qquad\nb_{1} = \\frac{12 - \\frac{2}{5}}{10} = \\frac{\\frac{58}{5}}{10} = \\frac{29}{25}.\n$$\nThus the exact solution is\n$$\n\\theta^{\\ast}=\\begin{pmatrix}\\frac{8}{25}\\\\ \\frac{29}{25}\\\\ \\frac{2}{5}\\end{pmatrix}.\n$$\nRounding each entry to three significant figures gives\n$$\n\\theta^{\\ast}\\approx\\begin{pmatrix}0.320\\\\ 1.16\\\\ 0.400\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.320\\\\1.16\\\\0.400\\end{pmatrix}}$$", "id": "1597904"}, {"introduction": "Identifying parameters is only part of the story; we must also determine if our chosen model structure is appropriate. This final practice focuses on model validation by comparing two different models—one static and one dynamic—against the same experimental data. You will use the sum of squared errors (SSE) as a performance metric to quantify which model provides a better fit, a fundamental technique for evaluating and selecting the best representation of a system [@problem_id:1597909].", "problem": "An engineering team is developing a thermal model for a new processing unit. To evaluate potential models, they've collected experimental data. A series of measurements were taken at discrete time steps $k$. The following table lists the power consumption $u(k)$ in Watts, and the corresponding measured core temperature $y(k)$ in degrees Celsius.\n\n| Time Step $k$ | Power $u(k)$ (W) | Measured Temperature $y(k)$ (°C) |\n|---------------|------------------|----------------------------------|\n| 1             | 10.0             | 45.0                             |\n| 2             | 12.0             | 50.0                             |\n| 3             | 11.0             | 52.0                             |\n| 4             | 13.0             | 56.0                             |\n\nThe initial conditions at time step $k=0$ were $u(0) = 8.0$ W and $y(0) = 40.0$ °C.\n\nTwo candidate parametric models, A and B, have been identified to predict the temperature.\n\n**Model A (Static Model):** The predicted temperature $y_A(k)$ is given by the relation:\n$$y_A(k) = K_A u(k) + T_{\\text{offset}}$$\nwhere the identified parameters are $K_A = 3.0$ °C/W and $T_{\\text{offset}} = 14.0$ °C.\n\n**Model B (Dynamic Model):** The predicted temperature $y_B(k)$ is given by the one-step-ahead prediction equation:\n$$y_B(k) = a_1 y(k-1) + b_1 u(k-1)$$\nwhere the identified parameters are $a_1 = 0.6$ (dimensionless) and $b_1 = 2.0$ °C/W.\n\nTo determine which model provides a better fit to the data, you must first quantify the performance of each. For each model, calculate its total squared prediction error, which is defined as the sum of the squares of the differences between the measured temperature and the model-predicted temperature for $k = 1, 2, 3, 4$.\n\nCalculate the ratio of the total squared prediction error of Model B to that of Model A. Round your final answer to three significant figures.", "solution": "The total squared prediction error for a model $M$ over the time steps $k=1,2,3,4$ is defined as\n$$S_{M}=\\sum_{k=1}^{4}\\left(y(k)-y_{M}(k)\\right)^{2}.$$\n\nFor Model A, $y_{A}(k)=K_{A}u(k)+T_{\\text{offset}}$ with $K_{A}=3.0$ and $T_{\\text{offset}}=14.0$.\nFor $k=1$: $y_{A}(1)=3.0\\cdot 10.0+14.0=44.0$, $e_{A}(1)=45.0-44.0=1.0$, $e_{A}(1)^{2}=1.0$.\nFor $k=2$: $y_{A}(2)=3.0\\cdot 12.0+14.0=50.0$, $e_{A}(2)=50.0-50.0=0.0$, $e_{A}(2)^{2}=0.0$.\nFor $k=3$: $y_{A}(3)=3.0\\cdot 11.0+14.0=47.0$, $e_{A}(3)=52.0-47.0=5.0$, $e_{A}(3)^{2}=25.0$.\nFor $k=4$: $y_{A}(4)=3.0\\cdot 13.0+14.0=53.0$, $e_{A}(4)=56.0-53.0=3.0$, $e_{A}(4)^{2}=9.0$.\nThus,\n$$S_{A}=1.0+0.0+25.0+9.0=35.0.$$\n\nFor Model B, $y_{B}(k)=a_{1}y(k-1)+b_{1}u(k-1)$ with $a_{1}=0.6$, $b_{1}=2.0$, using $y(0)=40.0$ and $u(0)=8.0$.\nFor $k=1$: $y_{B}(1)=0.6\\cdot 40.0+2.0\\cdot 8.0=24.0+16.0=40.0$, $e_{B}(1)=45.0-40.0=5.0$, $e_{B}(1)^{2}=25.0$.\nFor $k=2$: $y_{B}(2)=0.6\\cdot 45.0+2.0\\cdot 10.0=27.0+20.0=47.0$, $e_{B}(2)=50.0-47.0=3.0$, $e_{B}(2)^{2}=9.0$.\nFor $k=3$: $y_{B}(3)=0.6\\cdot 50.0+2.0\\cdot 12.0=30.0+24.0=54.0$, $e_{B}(3)=52.0-54.0=-2.0$, $e_{B}(3)^{2}=4.0$.\nFor $k=4$: $y_{B}(4)=0.6\\cdot 52.0+2.0\\cdot 11.0=31.2+22.0=53.2$, $e_{B}(4)=56.0-53.2=2.8$, $e_{B}(4)^{2}=7.84$.\nThus,\n$$S_{B}=25.0+9.0+4.0+7.84=45.84.$$\n\nThe required ratio is\n$$R=\\frac{S_{B}}{S_{A}}=\\frac{45.84}{35.0}\\approx 1.31,$$\nrounded to three significant figures.", "answer": "$$\\boxed{1.31}$$", "id": "1597909"}]}