{"hands_on_practices": [{"introduction": "In a multivariable system, a fundamental design choice is which input should control which output. This pairing decision is not arbitrary; a poor choice can render the entire system unstable, even with perfectly designed individual controllers. This practice introduces the Niederlinski Index, a simple yet powerful tool based on steady-state gains, to screen for pairings that are guaranteed to lead to instability, helping you avoid pitfalls early in the design process. [@problem_id:1581163]", "problem": "In the control of a simplified continuous stirred-tank bioreactor, two manipulated variables are available: the substrate feed rate, $u_1(t)$, and the aeration rate, $u_2(t)$. The goal is to control two output variables: the biomass concentration, $y_1(t)$, and the dissolved oxygen concentration, $y_2(t)$. The dynamic relationship between the inputs and outputs around a specific operating point is described by the following linear Multiple-Input, Multiple-Output (MIMO) model, given in terms of Laplace transforms:\n\n$$\n\\begin{pmatrix} Y_1(s) \\\\ Y_2(s) \\end{pmatrix} = \n\\begin{pmatrix}\n\\frac{2}{10s+1} & \\frac{3}{5s+1} \\\\\n\\frac{-4}{8s+1} & \\frac{5}{12s+1}\n\\end{pmatrix}\n\\begin{pmatrix} U_1(s) \\\\ U_2(s) \\end{pmatrix}\n$$\n\nA decentralized control strategy is proposed, which involves using two independent single-loop controllers. Two possible pairing schemes are considered:\n\n*   **Pairing Scheme A:** The substrate feed rate controls the biomass concentration ($u_1 \\to y_1$), and the aeration rate controls the dissolved oxygen concentration ($u_2 \\to y_2$).\n*   **Pairing Scheme B:** The substrate feed rate controls the dissolved oxygen concentration ($u_1 \\to y_2$), and the aeration rate controls the biomass concentration ($u_2 \\to y_1$).\n\nTo assess the feasibility of these pairings before designing the controllers, the Niederlinski Index (NI) is used. The NI is a stability criterion for decentralized control systems. It is defined for a given pairing as $NI = \\frac{\\det(K)}{\\prod_{i} K_{ii}}$, where $K$ is the steady-state gain matrix of the process and $K_{ii}$ are the steady-state gains of the chosen input-output pairs. A negative value of the NI for a given pairing indicates that the closed-loop system will be unstable if any form of integral control is used for that pairing.\n\nBased on an analysis using the Niederlinski Index, which of the following statements is correct?\n\nA. Only Pairing Scheme A is guaranteed to be unstable.\n\nB. Only Pairing Scheme B is guaranteed to be unstable.\n\nC. Both Pairing Scheme A and Pairing Scheme B are guaranteed to be unstable.\n\nD. The Niederlinski Index does not predict instability for either pairing scheme.", "solution": "The Niederlinski Index (NI) is defined for a given input-output pairing as\n$$\nNI=\\frac{\\det(K)}{\\prod_{i} K_{ii}},\n$$\nwhere $K$ is the steady-state gain matrix of the process corresponding to the chosen input-output ordering, and $K_{ii}$ are the steady-state gains of the selected input-output pairs.\n\nFirst, compute the steady-state gain matrix $K$ from the given transfer function matrix. For each element of the form $\\frac{k}{\\tau s+1}$, the steady-state gain is obtained by evaluating at $s=0$, yielding $k$. Therefore,\n$$\nK=\\begin{pmatrix} 2 & 3 \\\\ -4 & 5 \\end{pmatrix}.\n$$\nCompute the determinant of $K$:\n$$\n\\det(K)=2\\cdot 5-3\\cdot(-4)=10+12=22.\n$$\n\nEvaluate the NI for each pairing scheme.\n\nFor Pairing Scheme A, the pairs are $(u_{1}\\to y_{1})$ and $(u_{2}\\to y_{2})$. The NI is calculated using the diagonal elements of the original matrix $K$, which are $K_{11}=2$ and $K_{22}=5$. Thus,\n$$\nNI_{A}=\\frac{\\det(K)}{K_{11}K_{22}}=\\frac{22}{2\\cdot 5}=\\frac{22}{10}=2.2,\n$$\nwhich is positive. A negative NI indicates guaranteed instability with any integral control; since $NI_{A}>0$, the NI does not predict instability for Scheme A.\n\nFor Pairing Scheme B, the pairs are $(u_{1}\\to y_{2})$ and $(u_{2}\\to y_{1})$. To apply the Niederlinski Index for this off-diagonal pairing, we maintain the determinant of the original gain matrix, $\\det(K)$, but use the product of the gains for the chosen pairs in the denominator. The gains for this pairing are $K_{21}=-4$ (for $u_1 \\to y_2$) and $K_{12}=3$ (for $u_2 \\to y_1$). The product is $K_{21}K_{12} = (-4)(3) = -12$. The Niederlinski Index for this pairing is therefore calculated as:\n$$\nNI_{B}=\\frac{\\det(K)}{K_{21}K_{12}}=\\frac{22}{-12}=-\\frac{11}{6},\n$$\nwhich is negative. Therefore, the NI predicts that Scheme B will be unstable under any integral control.\n\nTherefore, only Pairing Scheme B is guaranteed to be unstable according to the Niederlinski Index criterion.", "answer": "$$\\boxed{B}$$", "id": "1581163"}, {"introduction": "While steady-state analysis provides a valuable first look, system interactions are often dynamic and change with frequency. The Relative Gain Array (RGA) is a more comprehensive tool that captures this frequency-dependent behavior. This exercise will guide you through calculating the RGA at different frequencies, demonstrating how a control pairing that seems appropriate at steady-state might become problematic at higher frequencies, a critical insight for robust controller design. [@problem_id:1581221]", "problem": "A two-input, two-output (2x2) multi-variable control system has its dynamics described by the Laplace-domain relationship $Y(s) = G(s)U(s)$, where $U(s)$ is the vector of inputs and $Y(s)$ is the vector of outputs. The system's transfer function matrix $G(s)$ is given by:\n$$G(s) = \\begin{pmatrix} 1 & s+1 \\\\ s+1 & 2s^2+s+2 \\end{pmatrix}$$\nTo analyze the interaction between the inputs and outputs, a control engineer decides to use the Relative Gain Array (RGA). For a general non-singular square matrix $G(s)$, the RGA is defined as $\\Lambda(s) = G(s) \\circ (G(s)^{-1})^T$, where $\\circ$ denotes the Hadamard (element-wise) product.\n\nFor a 2x2 system, the choice of a diagonal pairing is typically evaluated using the (1,1) element of the RGA, $\\lambda_{11}$.\n- If $\\lambda_{11}$ is positive and close to 1, the pairing ($u_1 \\to y_1$, $u_2 \\to y_2$) is recommended.\n- If $\\lambda_{11}$ is close to 0, which implies $\\lambda_{12} = 1-\\lambda_{11}$ is close to 1, the pairing ($u_1 \\to y_2$, $u_2 \\to y_1$) is recommended.\n- Negative values of $\\lambda_{11}$ strongly discourage the ($u_1 \\to y_1$, $u_2 \\to y_2$) pairing, as this configuration can lead to instability when the loops are closed. In such cases, the alternative off-diagonal pairing is considered.\n\nYour task is to analyze how the preferred pairing for this system changes with frequency. Calculate the RGA element $\\lambda_{11}(s)$ at two different conditions: steady-state ($s=0$) and at an angular frequency of $\\omega_c = 1$ rad/s (i.e., for $s=j\\omega_c=j$).\n\nBased on your calculations, which of the following statements correctly describes the pairing recommendation?\n\nA. The recommended pairing is ($u_1 \\to y_1$, $u_2 \\to y_2$) at both steady-state and at $\\omega_c = 1$ rad/s.\n\nB. The recommended pairing is ($u_1 \\to y_2$, $u_2 \\to y_1$) at both steady-state and at $\\omega_c = 1$ rad/s.\n\nC. The pairing recommendation switches from ($u_1 \\to y_1$, $u_2 \\to y_2$) at steady-state to ($u_1 \\to y_2$, $u_2 \\to y_1$) at $\\omega_c = 1$ rad/s.\n\nD. The pairing recommendation switches from ($u_1 \\to y_2$, $u_2 \\to y_1$) at steady-state to ($u_1 \\to y_1$, $u_2 \\to y_2$) at $\\omega_c = 1$ rad/s.\n\nE. The system is singular at $s=j$, so the RGA at that frequency is undefined.", "solution": "The Relative Gain Array is defined as $\\Lambda(s) = G(s) \\circ (G(s)^{-1})^{T}$, so for a $2 \\times 2$ system,\n$$\n\\lambda_{11}(s) = g_{11}(s)\\,(G(s)^{-1})_{11}.\n$$\nFor a $2 \\times 2$ matrix $G(s) = \\begin{pmatrix} g_{11} & g_{12} \\\\ g_{21} & g_{22} \\end{pmatrix}$,\n$$\nG(s)^{-1} = \\frac{1}{\\det G(s)} \\begin{pmatrix} g_{22} & -g_{12} \\\\ -g_{21} & g_{11} \\end{pmatrix},\n\\quad\n\\det G(s) = g_{11}g_{22} - g_{12}g_{21}.\n$$\nThus,\n$$\n\\lambda_{11}(s) = g_{11} \\cdot \\frac{g_{22}}{\\det G(s)}.\n$$\nFor the given $G(s) = \\begin{pmatrix} 1 & s+1 \\\\ s+1 & 2s^{2}+s+2 \\end{pmatrix}$, we have $g_{11}=1$, $g_{12}=s+1$, $g_{21}=s+1$, $g_{22}=2s^{2}+s+2$, and\n$$\n\\det G(s) = 1\\cdot(2s^{2}+s+2) - (s+1)(s+1) = 2s^{2}+s+2 - (s^{2}+2s+1) = s^{2} - s + 1.\n$$\nTherefore,\n$$\n\\lambda_{11}(s) = \\frac{2s^{2}+s+2}{s^{2}-s+1}.\n$$\n\nAt steady state $s=0$:\n$$\n\\lambda_{11}(0) = \\frac{2\\cdot 0^{2} + 0 + 2}{0^{2} - 0 + 1} = \\frac{2}{1} = 2.\n$$\nThis is positive, and the complementary element is $\\lambda_{12}(0) = 1 - \\lambda_{11}(0) = -1$, which is negative; hence the off-diagonal pairing is strongly discouraged, and the recommended pairing is the diagonal ($u_{1} \\to y_{1}$, $u_{2} \\to y_{2}$).\n\nAt $\\omega_{c}=1$ rad/s, take $s=j$ with $j^{2}=-1$:\n$$\n\\lambda_{11}(j) = \\frac{2j^{2} + j + 2}{j^{2} - j + 1} = \\frac{-2 + j + 2}{-1 - j + 1} = \\frac{j}{-j} = -1.\n$$\nThis is negative, which strongly discourages the diagonal pairing; thus the off-diagonal pairing ($u_{1} \\to y_{2}$, $u_{2} \\to y_{1}$) is recommended at $\\omega_{c}=1$. Also, $\\det G(j) = j^{2} - j + 1 = -j \\neq 0$, so the system is not singular at $s=j$ and the RGA is well-defined there.\n\nTherefore, the pairing recommendation switches from diagonal at steady state to off-diagonal at $\\omega_{c}=1$ rad/s, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1581221"}, {"introduction": "After analyzing interaction, the next logical step is to eliminate it. This can be achieved by designing a decoupler, a component that cancels out the cross-couplings in a process, making the system behave as if it were a set of independent single-input, single-output loops. This practice puts you in the designer's seat, tasking you with calculating a static pre-compensator matrix that achieves ideal decoupling at steady-state for a hypothetical chemical reactor, turning a complex interactive system into a simple one to control. [@problem_id:1581230]", "problem": "A chemical process in a Continuous Stirred-Tank Reactor (CSTR) is characterized by two manipulated inputs and two measured outputs. The inputs are the molar flow rate of a reactant, $u_1$, and the flow rate of a coolant, $u_2$. The outputs are the product concentration, $y_1$, and the reactor temperature, $y_2$. For small deviations around a nominal operating point, the steady-state behavior of the reactor is described by a linear model relating the change in outputs, $\\Delta y$, to the change in inputs, $\\Delta u$. This relationship is given by the process gain matrix, $K_p$, as follows:\n$$\n\\Delta y = K_p \\Delta u \\quad \\text{where} \\quad \\Delta y = \\begin{pmatrix} \\Delta y_1 \\\\ \\Delta y_2 \\end{pmatrix} \\quad \\text{and} \\quad \\Delta u = \\begin{pmatrix} \\Delta u_1 \\\\ \\Delta u_2 \\end{pmatrix}\n$$\nThe empirically determined process gain matrix for this system is:\n$$\nK_p = \\begin{pmatrix} 2.5 & -0.5 \\\\ 1.5 & 4.0 \\end{pmatrix}\n$$\nThe non-zero off-diagonal elements indicate that the system is coupled; changing one input affects both outputs. To simplify the control of the reactor, a static pre-compensator matrix, $D$, is to be implemented. This matrix relates a new set of independent command signals, $\\Delta v$, to the process inputs, $\\Delta u$, via the equation $\\Delta u = D \\Delta v$.\n\nYour task is to find the pre-compensator matrix $D$ that achieves ideal steady-state decoupling. Ideal decoupling in this context means that the overall transfer relationship from the new command signals $\\Delta v$ to the process outputs $\\Delta y$ is represented by the $2 \\times 2$ identity matrix, $I$.\n\nDetermine the elements of the static pre-compensator matrix $D$. Present your answer as a $2 \\times 2$ matrix, with each element rounded to three significant figures.", "solution": "The steady-state relationships are $\\Delta y = K_{p}\\Delta u$ and $\\Delta u = D\\Delta v$. The overall mapping from $\\Delta v$ to $\\Delta y$ is therefore\n$$\n\\Delta y = K_{p}D\\Delta v.\n$$\nIdeal steady-state decoupling requires $K_{p}D = I$, which implies\n$$\nD = K_{p}^{-1}.\n$$\nFor a $2\\times 2$ matrix $A = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$, the inverse is\n$$\nA^{-1} = \\frac{1}{ad - bc}\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}.\n$$\nWith $K_{p} = \\begin{pmatrix} 2.5 & -0.5 \\\\ 1.5 & 4.0 \\end{pmatrix}$, identify $a = 2.5$, $b = -0.5$, $c = 1.5$, $d = 4.0$. The determinant is\n$$\n\\det(K_{p}) = ad - bc = 2.5\\cdot 4.0 - (-0.5)\\cdot 1.5 = 10 + 0.75 = 10.75.\n$$\nThus\n$$\nK_{p}^{-1} = \\frac{1}{10.75}\\begin{pmatrix} 4.0 & 0.5 \\\\ -1.5 & 2.5 \\end{pmatrix} = \\frac{4}{43}\\begin{pmatrix} 4.0 & 0.5 \\\\ -1.5 & 2.5 \\end{pmatrix}.\n$$\nEvaluating each element and rounding to three significant figures gives\n$$\nD = \\begin{pmatrix}\n0.372 & 0.0465 \\\\\n-0.140 & 0.233\n\\end{pmatrix}.\n$$\nThis $D$ satisfies $K_{p}D = I$ exactly before rounding, and achieves ideal steady-state decoupling.", "answer": "$$\\boxed{\\begin{pmatrix}0.372 & 0.0465 \\\\ -0.140 & 0.233\\end{pmatrix}}$$", "id": "1581230"}]}