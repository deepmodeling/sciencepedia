{"hands_on_practices": [{"introduction": "The core idea of loop shaping is to modify a plant's frequency response to meet performance and robustness specifications before synthesizing a controller. This is achieved by cascading the plant with compensators, or weighting functions. A key metric in this process is the unity-gain crossover frequency, the frequency at which the open-loop gain is one, as it is closely related to the closed-loop bandwidth and response speed. This exercise [@problem_id:1578985] provides practice in calculating this crucial frequency for a 'shaped' plant, reinforcing your understanding of how compensators alter system dynamics.", "problem": "Consider the design of a simplified vertical altitude controller for a small quadcopter drone. The linearized dynamics from the commanded motor thrust to the resulting vertical velocity can be modeled by a first-order plant, $G(s)$. In a loop-shaping control design framework, the nominal plant is augmented with weighting functions, also known as compensators, to achieve desired performance characteristics.\n\nThe plant is given by the transfer function:\n$$G(s) = \\frac{K}{s+a}$$\nwhere $K$ and $a$ are positive real constants representing the system's DC gain and pole location, respectively.\n\nTo improve performance, a proportional pre-compensator, $W_1(s)$, and an integral post-compensator, $W_2(s)$, are introduced. Their transfer functions are:\n$$W_1(s) = k_p$$\n$$W_2(s) = \\frac{k_i}{s}$$\nwhere $k_p$ and $k_i$ are positive real gains.\n\nThe \"shaped plant,\" denoted as $G_s(s)$, is formed by cascading these elements in the order $W_2(s)$, $G(s)$, and $W_1(s)$.\n\nDetermine the angular frequency $\\omega > 0$ at which the magnitude of the frequency response of the shaped plant, $|G_s(j\\omega)|$, is equal to unity. Express your answer as a formula in terms of $K$, $a$, $k_p$, and $k_i$.", "solution": "The shaped plant is the cascade of $W_{2}(s)$, $G(s)$, and $W_{1}(s)$:\n$$\nG_{s}(s)=W_{2}(s)\\,G(s)\\,W_{1}(s)=\\frac{k_{i}}{s}\\cdot\\frac{K}{s+a}\\cdot k_{p}=\\frac{k_{p}k_{i}K}{s(s+a)}.\n$$\nEvaluating the frequency response at $s=j\\omega$ gives\n$$\nG_{s}(j\\omega)=\\frac{k_{p}k_{i}K}{(j\\omega)(j\\omega+a)}.\n$$\nThe magnitude is\n$$\n\\left|G_{s}(j\\omega)\\right|=\\frac{k_{p}k_{i}K}{|j\\omega|\\;|j\\omega+a|}=\\frac{k_{p}k_{i}K}{\\omega\\,\\sqrt{a^{2}+\\omega^{2}}}.\n$$\nImposing $\\left|G_{s}(j\\omega)\\right|=1$ yields\n$$\n\\frac{k_{p}k_{i}K}{\\omega\\,\\sqrt{a^{2}+\\omega^{2}}}=1 \\;\\;\\Longrightarrow\\;\\; \\omega\\,\\sqrt{a^{2}+\\omega^{2}}=k_{p}k_{i}K.\n$$\nSquaring both sides and defining $x=\\omega^{2}$ gives a quadratic in $x$:\n$$\n\\omega^{2}\\left(a^{2}+\\omega^{2}\\right)=(k_{p}k_{i}K)^{2}\\;\\;\\Longrightarrow\\;\\; x^{2}+a^{2}x-(k_{p}k_{i}K)^{2}=0.\n$$\nSolving for $x$ and selecting the nonnegative root,\n$$\nx=\\frac{-a^{2}+\\sqrt{a^{4}+4(k_{p}k_{i}K)^{2}}}{2},\n$$\nhence\n$$\n\\omega=\\sqrt{x}=\\sqrt{\\frac{-a^{2}+\\sqrt{a^{4}+4(k_{p}k_{i}K)^{2}}}{2}}.\n$$\nThis $\\omega>0$ satisfies $\\left|G_{s}(j\\omega)\\right|=1$.", "answer": "$$\\boxed{\\sqrt{\\frac{-a^{2}+\\sqrt{a^{4}+4\\left(k_{p}k_{i}K\\right)^{2}}}{2}}}$$", "id": "1578985"}, {"introduction": "While $\\mathcal{H}_{\\infty}$ loop shaping offers powerful tools for designing robust controllers, it comes with a significant practical consideration: the complexity of the resulting controller. Unlike classical methods, $\\mathcal{H}_{\\infty}$ synthesis can produce controllers of a very high order. This exercise [@problem_id:1579013] illustrates a fundamental rule of thumb for predicting the controller's order based on the plant and the chosen weighting functions, a critical skill for managing the trade-off between performance and implementation complexity.", "problem": "A control systems engineer is designing a feedback controller for a manufacturing process using a standard mixed-sensitivity H-infinity ($\\text{H}_{\\infty}$) loop-shaping design. The objective is to find a stabilizing controller $K(s)$ that minimizes the infinity-norm of a transfer function matrix representing a trade-off between disturbance rejection and control effort. This is typically formulated as finding $K(s)$ to satisfy:\n$$ \\left\\| \\begin{pmatrix} W_1(s)S(s) \\\\ W_2(s)K(s)S(s) \\end{pmatrix} \\right\\|_{\\infty} < 1 $$\nwhere $S(s) = (1+G(s)K(s))^{-1}$ is the sensitivity function, which relates the output to disturbances.\n\nThe dynamic model of the process is given by the plant's transfer function:\n$$ G(s) = \\frac{10}{(s+1)(s+3)} $$\nThe performance weighting function, selected to enforce good tracking and disturbance rejection at low frequencies, is:\n$$ W_1(s) = \\frac{s+10}{2s+0.02} $$\nThe control effort weighting function, chosen to limit the magnitude of the control signal, especially at high frequencies, is:\n$$ W_2(s) = \\frac{0.5s+1}{s+20} $$\n\nAssuming a standard H-infinity synthesis algorithm is employed and no subsequent model order reduction is performed on the resulting controller, what is the expected state-space order of the controller $K(s)$?\n\nA. 2\n\nB. 3\n\nC. 4\n\nD. 5\n\nE. 6", "solution": "In the standard mixed-sensitivity $\\text{H}_{\\infty}$ formulation, one builds a generalized plant $P(s)$ by interconnecting the original plant $G(s)$ with the weighting filters $W_{1}(s)$ and $W_{2}(s)$. Let $n_{G}$, $n_{W_{1}}$, and $n_{W_{2}}$ denote the minimal state-space orders of $G$, $W_{1}$, and $W_{2}$, respectively. The generalized plant has minimal order\n$$\nn_{P}=n_{G}+n_{W_{1}}+n_{W_{2}},\n$$\nsince the weighting filters contribute their dynamics as additional states in the augmented realization.\n\nFor the given transfer functions,\n$$\nG(s)=\\frac{10}{(s+1)(s+3)}, \\quad W_{1}(s)=\\frac{s+10}{2s+0.02}, \\quad W_{2}(s)=\\frac{0.5s+1}{s+20},\n$$\nwe read off the minimal orders:\n$$\nn_{G}=2 \\quad \\text{(two poles at } s=-1,-3\\text{)},\n$$\n$$\nn_{W_{1}}=1 \\quad \\text{(first-order proper weight)},\n$$\n$$\nn_{W_{2}}=1 \\quad \\text{(first-order proper weight)}.\n$$\nThus,\n$$\nn_{P}=2+1+1=4.\n$$\n\nIn $\\text{H}_{\\infty}$ dynamic output-feedback synthesis (e.g., via two coupled algebraic Riccati equations) with a strictly proper plant channel from control to measurement (so $D_{22}=0$) and without subsequent model reduction, the controller $K(s)$ typically has order equal to the order of the generalized plant:\n$$\nn_{K}=n_{P}.\n$$\nTherefore,\n$$\nn_{K}=4.\n$$\nThis corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1579013"}, {"introduction": "The robustness guarantees provided by $\\mathcal{H}_{\\infty}$ methods are not magic; they are built upon a rigorous mathematical framework. One of the cornerstones of the celebrated Glover-McFarlane loop shaping procedure is the normalized coprime factorization (NCF) of the plant. This exercise [@problem_id:1578958] asks you to verify the conditions for such a factorization, providing essential hands-on experience with the definitions that underpin the stability and robustness theorems in modern control.", "problem": "In modern robust control theory, a plant with a transfer function $G(s)$ can be represented as a fraction of two stable transfer functions, a method known as coprime factorization. A specific type, the normalized right coprime factorization, is particularly useful in H-infinity controller synthesis.\n\nA pair of stable and proper transfer functions, $(N(s), M(s))$, is a normalized right coprime factorization of a plant $G(s)$ if it satisfies the following three conditions:\n1.  $G(s) = N(s)M(s)^{-1}$\n2.  The Bezout identity is satisfied: there exist stable and proper transfer functions $X(s)$ and $Y(s)$ such that $X(s)N(s) + Y(s)M(s) = 1$.\n3.  The normalization condition is met: $N(s)N(-s) + M(s)M(-s) = 1$.\n\nConsider a plant with the transfer function $G(s) = s+1$. A control engineer proposes the following pair of transfer functions as a potential normalized right coprime factorization:\n$$N(s) = \\frac{s+1}{s+2}$$\n$$M(s) = \\frac{1}{s+2}$$\n\nDetermine which of the following statements is true regarding the proposed factorization $(N(s), M(s))$ for the plant $G(s)$.\n\nA. The pair is not a valid factorization because $N(s)$ or $M(s)$ is unstable.\n\nB. The pair is a valid coprime factorization ($G=NM^{-1}$ and the Bezout identity holds), but it is not normalized.\n\nC. The pair satisfies the normalization condition, but it is not a valid factorization for $G(s)$ because $G(s) \\neq N(s)M(s)^{-1}$.\n\nD. The pair is a valid normalized right coprime factorization of $G(s)$.\n\nE. The pair is not a valid coprime factorization because the Bezout identity cannot be satisfied with stable, proper $X(s)$ and $Y(s)$.", "solution": "We first verify stability and properness of the proposed factors. The transfer functions are $N(s)=\\frac{s+1}{s+2}$ and $M(s)=\\frac{1}{s+2}$. Each has a single pole at $s=-2$, which lies in the open left half-plane, so both are stable. Both are proper because the degree of each numerator does not exceed the degree of its denominator.\n\nNext, we check the factorization condition $G(s)=N(s)M(s)^{-1}$. Since $M(s)^{-1}=s+2$, we get\n$$\nN(s)M(s)^{-1}=\\frac{s+1}{s+2}\\,(s+2)=s+1=G(s).\n$$\nThus, the factorization condition is satisfied.\n\nWe now verify the Bezout identity. We seek stable, proper $X(s)$ and $Y(s)$ such that $X(s)N(s)+Y(s)M(s)=1$. Multiply the desired identity by $(s+2)^{2}$ to clear denominators:\n$$\n\\left[X(s)\\frac{s+1}{s+2}+Y(s)\\frac{1}{s+2}\\right](s+2)^{2}=1\\cdot(s+2)^{2}.\n$$\nEquivalently,\n$$\nX(s)(s+1)(s+2)+Y(s)(s+2)=(s+2)^{2}.\n$$\nChoose a common proper, stable denominator $Q(s)=s+2$ and set $X(s)=\\frac{P(s)}{Q(s)}$, $Y(s)=\\frac{R(s)}{Q(s)}$ with $P(s)$ and $R(s)$ polynomials of degree at most one so that $X,Y\\in RH_{\\infty}$. Then\n$$\n\\frac{P(s)}{s+2}(s+1)(s+2)+\\frac{R(s)}{s+2}(s+2)=(s+2)^{2}\n$$\nreduces to\n$$\nP(s)(s+1)+R(s)=(s+2)^{2}.\n$$\nLet $P(s)=a s+b$ and $R(s)=c s+d$. Matching coefficients against $(s+2)^{2}=s^{2}+4s+4$ yields\n$$\na=1,\\quad a+b+c=4,\\quad b+d=4.\n$$\nOne valid choice is $b=0$, $c=3$, $d=4$, giving $P(s)=s$ and $R(s)=3s+4$. Hence\n$$\nX(s)=\\frac{s}{s+2},\\qquad Y(s)=\\frac{3s+4}{s+2},\n$$\nwhich are stable and proper, and\n$$\nX(s)N(s)+Y(s)M(s)=\\frac{s}{s+2}\\cdot\\frac{s+1}{s+2}+\\frac{3s+4}{s+2}\\cdot\\frac{1}{s+2}\n=\\frac{s^{2}+4s+4}{(s+2)^{2}}=1.\n$$\nTherefore, the Bezout identity holds.\n\nFinally, we check the normalization condition $N(s)N(-s)+M(s)M(-s)=1$. Compute\n$$\nN(s)N(-s)=\\frac{s+1}{s+2}\\cdot\\frac{1-s}{2-s}=\\frac{(s+1)(s-1)}{(s+2)(s-2)}=\\frac{s^{2}-1}{s^{2}-4},\n$$\nand\n$$\nM(s)M(-s)=\\frac{1}{s+2}\\cdot\\frac{1}{2-s}=-\\frac{1}{(s+2)(s-2)}=-\\frac{1}{s^{2}-4}.\n$$\nThus,\n$$\nN(s)N(-s)+M(s)M(-s)=\\frac{s^{2}-1}{s^{2}-4}-\\frac{1}{s^{2}-4}=\\frac{s^{2}-2}{s^{2}-4}\\neq 1.\n$$\nTherefore, the proposed pair is a valid coprime factorization but not normalized.\n\nThe correct statement is B.", "answer": "$$\\boxed{B}$$", "id": "1578958"}]}