{"hands_on_practices": [{"introduction": "This first practice exercise serves as a foundational drill in applying Pontryagin's Minimum Principle. We will analyze a coupled linear system, a common scenario in many engineering fields, with the goal of minimizing control energy. Your task [@problem_id:1600509] is not to find a specific numerical answer, but to derive the general form of the optimal control law, which will illuminate the direct relationship between the control input and the evolution of the costate variables.", "problem": "Consider a simplified model for a thermal regulation system composed of two coupled components. The temperature deviations of these components from the ambient temperature are denoted by $x_1(t)$ and $x_2(t)$. The dynamics of the system are described by the following set of linear ordinary differential equations:\n$$\n\\dot{x}_1(t) = -x_1(t) + x_2(t)\n$$\n$$\n\\dot{x}_2(t) = -x_2(t) + u(t)\n$$\nwhere $u(t)$ is an external control input representing a controlled heating or cooling rate. An optimal control strategy is sought to manipulate the system's state over a time interval of interest $[0, T_f]$. The objective is to minimize the control effort, which is quantified by the cost functional:\n$$\nJ = \\frac{1}{2}\\int_0^{T_f} u(t)^2 dt\n$$\nUsing Pontryagin's Minimum Principle, determine the general functional form of the optimal control law, $u^*(t)$. Your final expression should be a function of time $t$ and the initial values of the costate variables, $p_1(0)$ and $p_2(0)$.", "solution": "We apply Pontryagin’s Minimum Principle. Define the Hamiltonian\n$$\nH(x_{1},x_{2},p_{1},p_{2},u)=\\frac{1}{2}u^{2}+p_{1}\\left(-x_{1}+x_{2}\\right)+p_{2}\\left(-x_{2}+u\\right).\n$$\nThe optimality condition is obtained from $\\partial H/\\partial u=0$, which gives\n$$\n\\frac{\\partial H}{\\partial u}=u+p_{2}=0 \\quad \\Rightarrow \\quad u^{*}(t)=-p_{2}(t).\n$$\nThe costate equations are $ \\dot{p}_{i}=-\\partial H/\\partial x_{i}$. Computing the partial derivatives,\n$$\n\\frac{\\partial H}{\\partial x_{1}}=-p_{1}, \\qquad \\frac{\\partial H}{\\partial x_{2}}=p_{1}-p_{2},\n$$\nwe obtain\n$$\n\\dot{p}_{1}=p_{1}, \\qquad \\dot{p}_{2}=-p_{1}+p_{2}.\n$$\nSolving $\\dot{p}_{1}=p_{1}$ with initial condition $p_{1}(0)$ yields\n$$\np_{1}(t)=p_{1}(0)\\exp(t).\n$$\nSubstitute into the $\\dot{p}_{2}$ equation to get a linear ODE:\n$$\n\\dot{p}_{2}-p_{2}=-p_{1}(0)\\exp(t).\n$$\nUsing the integrating factor $\\exp(-t)$,\n$$\n\\frac{d}{dt}\\left(p_{2}(t)\\exp(-t)\\right)=-p_{1}(0),\n$$\nintegrate to obtain\n$$\np_{2}(t)\\exp(-t)=p_{2}(0)-p_{1}(0)\\,t \\quad \\Rightarrow \\quad p_{2}(t)=\\exp(t)\\left[p_{2}(0)-p_{1}(0)\\,t\\right].\n$$\nTherefore, the optimal control is\n$$\nu^{*}(t)=-p_{2}(t)=\\exp(t)\\left[p_{1}(0)\\,t-p_{2}(0)\\right].\n$$\nIf the terminal state is free and no terminal cost is present, the transversality condition gives $p_{1}(T_{f})=p_{2}(T_{f})=0$, which implies $p_{1}(0)=p_{2}(0)=0$ and hence $u^{*}(t)=0$. However, the general functional form in terms of $t$, $p_{1}(0)$, and $p_{2}(0)$ is the expression above.", "answer": "$$\\boxed{u^{*}(t) = \\exp(t)\\left[p_{1}(0)\\,t-p_{2}(0)\\right]}$$", "id": "1600509"}, {"introduction": "Building upon the previous exercise, this problem introduces the practical constraint of fixed initial and final states. Here, you are tasked with steering a system from a known starting point to a specific target while minimizing energy expenditure. This practice [@problem_id:1600520] demonstrates how to use the system's boundary conditions to determine the specific constants in the costate trajectory, allowing you to calculate the explicit minimum cost of the maneuver.", "problem": "Consider a simplified model for controlling the temperature of a small object, such as a component on a circuit board. Let $x(t)$ be the temperature difference between the object and its constant-temperature surroundings at time $t$. According to Newton's law of cooling, the object naturally cools (or warms) towards the ambient temperature, with its temperature difference decaying at a rate proportional to the difference itself. A thermoelectric controller (like a Peltier device) is used to actively change the object's temperature. The temperature dynamics are described by the linear ordinary differential equation:\n$$ \\dot{x}(t) = -\\alpha x(t) + \\beta u(t) $$\nHere, $u(t)$ is the control input, which is proportional to the power supplied to the controller. The parameters $\\alpha$ and $\\beta$ are positive real constants representing the thermal coupling to the environment and the effectiveness of the controller, respectively.\n\nYour task is to find the minimum cost to steer the system from a known initial temperature difference $x(0) = x_0$ to thermal equilibrium with the surroundings, $x(T) = 0$, over a fixed time interval $T$. The cost is defined by the total control energy expended, given by the functional:\n$$ J = \\int_{0}^{T} \\frac{1}{2} u(t)^2 dt $$\nDetermine a closed-form analytic expression for the minimum cost $J$ in terms of the parameters $x_0$, $T$, $\\alpha$, and $\\beta$.", "solution": "We seek the minimum-energy control to steer the scalar linear system $\\dot{x}(t)=-\\alpha x(t)+\\beta u(t)$ from $x(0)=x_{0}$ to $x(T)=0$ with cost $J=\\int_{0}^{T}\\frac{1}{2}u(t)^{2}\\,dt$. This is a fixed-endpoint optimal control problem with quadratic control cost. By Pontryagin’s Minimum Principle, define the Hamiltonian\n$$\nH(x,u,p)=\\frac{1}{2}u^{2}+p\\left(-\\alpha x+\\beta u\\right).\n$$\nThe optimality condition $\\partial H/\\partial u=0$ gives\n$$\nu^{\\ast}(t)+\\beta p(t)=0 \\quad \\Rightarrow \\quad u^{\\ast}(t)=-\\beta p(t).\n$$\nThe costate equation is\n$$\n\\dot{p}(t)=-\\frac{\\partial H}{\\partial x}=\\alpha p(t),\n$$\nwhose solution is\n$$\np(t)=C\\,\\exp(\\alpha t),\n$$\nwhere $C$ is a constant to be determined from the boundary conditions. Substituting $u^{\\ast}$ into the state dynamics yields\n$$\n\\dot{x}(t)=-\\alpha x(t)-\\beta^{2}p(t)=-\\alpha x(t)-\\beta^{2}C\\,\\exp(\\alpha t).\n$$\nThis linear ODE has integrating factor $\\exp(\\alpha t)$, hence\n$$\n\\frac{d}{dt}\\left(\\exp(\\alpha t)\\,x(t)\\right)=-\\beta^{2}C\\,\\exp(2\\alpha t).\n$$\nIntegrating from $0$ to $t$ and using $x(0)=x_{0}$ gives\n$$\n\\exp(\\alpha t)\\,x(t)-x_{0}=-\\beta^{2}C\\int_{0}^{t}\\exp(2\\alpha s)\\,ds\n=-\\beta^{2}C\\,\\frac{\\exp(2\\alpha t)-1}{2\\alpha}.\n$$\nTherefore,\n$$\nx(t)=\\exp(-\\alpha t)\\left[x_{0}-\\beta^{2}C\\,\\frac{\\exp(2\\alpha t)-1}{2\\alpha}\\right].\n$$\nImposing the terminal constraint $x(T)=0$ yields\n$$\n0=\\exp(-\\alpha T)\\left[x_{0}-\\beta^{2}C\\,\\frac{\\exp(2\\alpha T)-1}{2\\alpha}\\right]\n\\quad \\Rightarrow \\quad\nC=\\frac{2\\alpha x_{0}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}.\n$$\nThe optimal control is then\n$$\nu^{\\ast}(t)=-\\beta p(t)=-\\beta C\\,\\exp(\\alpha t).\n$$\nThe minimal cost is\n$$\nJ^{\\ast}=\\int_{0}^{T}\\frac{1}{2}\\left(u^{\\ast}(t)\\right)^{2}dt\n=\\frac{1}{2}\\int_{0}^{T}\\beta^{2}C^{2}\\exp(2\\alpha t)\\,dt\n=\\frac{1}{2}\\,\\beta^{2}C^{2}\\,\\frac{\\exp(2\\alpha T)-1}{2\\alpha}.\n$$\nSubstituting $C=\\dfrac{2\\alpha x_{0}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}$,\n$$\nJ^{\\ast}=\\frac{1}{2}\\cdot\\beta^{2}\\cdot\\frac{4\\alpha^{2}x_{0}^{2}}{\\beta^{4}\\left(\\exp(2\\alpha T)-1\\right)^{2}}\n\\cdot\\frac{\\exp(2\\alpha T)-1}{2\\alpha}\n=\\frac{\\alpha x_{0}^{2}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}.\n$$\nThis is the desired closed-form expression in terms of $x_{0}$, $T$, $\\alpha$, and $\\beta$.", "answer": "$$\\boxed{\\frac{\\alpha x_{0}^{2}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}}$$", "id": "1600520"}, {"introduction": "This final practice explores a different facet of optimal control by shifting the objective from minimizing energy to minimizing time. We consider a scenario with a simple \"on/off\" controller, a type of control common in many real-world devices. This time-optimal problem [@problem_id:1600533] will challenge you to determine the fastest possible switching strategy to move a system between two states, showcasing the power of the Minimum Principle in handling non-standard objectives and discrete control inputs.", "problem": "A simplified model for the temperature control of a small chemical reactor is described by the first-order linear differential equation:\n$$\n\\frac{dx}{dt} = -x(t) + u(t)\n$$\nHere, $x(t)$ represents the dimensionless temperature of the reactor, relative to the ambient temperature. The term $-x(t)$ models the natural cooling process (Newton's law of cooling), and $u(t)$ represents the action of a heater. The heater is a simple device that can only be completely off, corresponding to $u(t)=0$, or fully on, corresponding to $u(t)=1$.\n\nThe reactor is initially at a temperature of $x(0) = 3$. The process requires the temperature to be brought down to a final value of $x(t_f) = 0.5$. Your task is to determine the control strategy for the heater that achieves this temperature change in the minimum possible time.\n\nCalculate the minimum time $t_f$ required to transition the system from the initial state to the final state. Report your answer as a numerical value rounded to three significant figures.", "solution": "We are given the linear system $\\dot{x}(t)=-x(t)+u(t)$ with $u(t)\\in\\{0,1\\}$, $x(0)=3$, and the target $x(t_{f})=0.5$. The objective is to minimize time to reach $0.5$.\n\nFor any fixed state $x$, the right-hand side is increasing in $u$: $-x+0=-x$ and $-x+1=-(x-1)$. For $x>1$, we have $-x<-x+1$, so $u=0$ makes $\\dot{x}$ more negative, yielding the fastest decrease. For $x<1$, $-x+1>0$, so choosing $u=1$ would increase $x$ and delay reaching $0.5<1$. Therefore, the time-optimal control is $u(t)=0$ until the target is reached.\n\nUnder $u(t)=0$, the ODE is $\\dot{x}=-x$, which solves to\n$$\nx(t)=x(0)\\exp(-t)=3\\exp(-t).\n$$\nImposing the terminal condition $x(t_{f})=0.5$ gives\n$$\n3\\exp(-t_{f})=0.5 \\;\\;\\Longrightarrow\\;\\; \\exp(-t_{f})=\\frac{1}{6} \\;\\;\\Longrightarrow\\;\\; t_{f}=\\ln(6).\n$$\nNumerically, $\\ln(6)\\approx 1.791759\\ldots$, which rounded to three significant figures is $1.79$.", "answer": "$$\\boxed{1.79}$$", "id": "1600533"}]}