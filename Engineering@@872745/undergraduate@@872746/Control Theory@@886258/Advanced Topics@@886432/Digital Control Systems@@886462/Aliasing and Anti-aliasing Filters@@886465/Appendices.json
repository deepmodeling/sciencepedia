{"hands_on_practices": [{"introduction": "The first step in designing any digital control or signal processing system is ensuring the integrity of the data acquisition process. To convert a continuous analog signal into a sequence of digital numbers without losing information, we must sample it frequently enough. This exercise introduces the foundational principle governing this process: the Nyquist-Shannon sampling theorem. By working through this problem, you will learn to apply the theorem to calculate the absolute minimum sampling rate required to perfectly reconstruct a signal, a critical skill for avoiding a distortion known as aliasing. [@problem_id:1557482]", "problem": "A team of audio engineers is designing a custom Analog-to-Digital Converter (ADC) for a professional recording studio. Their goal is to capture a complex audio signal without loss of information due to aliasing. The signal to be digitized, representing the voltage $V(t)$ from a sensitive microphone, can be accurately modeled as a superposition of three sinusoidal components:\n\n$$V(t) = A_1 \\cos(2\\pi f_1 t + \\phi_1) + A_2 \\cos(2\\pi f_2 t + \\phi_2) + A_3 \\cos(2\\pi f_3 t + \\phi_3)$$\n\nThe frequencies of these components are known to be $f_1 = 18.0$ kHz, $f_2 = 35.5$ kHz, and $f_3 = 45.0$ kHz. The amplitudes ($A_1$, $A_2$, $A_3$) and phases ($\\phi_1$, $\\phi_2$, $\\phi_3$) are arbitrary and can vary. To ensure that the original continuous-time signal can be perfectly reconstructed from its discrete samples, the sampling rate must be chosen carefully.\n\nDetermine the theoretical minimum sampling rate required to avoid aliasing for this signal. Express your answer in kilohertz (kHz).", "solution": "The signal is a sum of three sinusoids at frequencies $f_{1}$, $f_{2}$, and $f_{3}$, so it is baseband-limited with highest frequency $f_{\\max}=\\max\\{f_{1},f_{2},f_{3}\\}$. By the Nyquistâ€“Shannon sampling theorem, perfect reconstruction without aliasing for a baseband signal requires a sampling frequency satisfying\n$$\nf_{s} \\geq 2 f_{\\max}.\n$$\nHere, $f_{\\max}=\\max\\{18.0,35.5,45.0\\}\\ \\text{kHz}=45.0\\ \\text{kHz}$, hence the theoretical minimum sampling rate is\n$$\nf_{s,\\min}=2 f_{\\max}=2 \\times 45.0\\ \\text{kHz}=90.0\\ \\text{kHz}.\n$$\nThe amplitudes and phases do not affect this bound.", "answer": "$$\\boxed{90.0}$$", "id": "1557482"}, {"introduction": "While the Nyquist-Shannon theorem tells us how to sample correctly, what happens when we break this rule? The consequence is aliasing, a phenomenon where high-frequency components in a signal are incorrectly perceived as lower frequencies after sampling. This is analogous to the \"wagon-wheel effect\" in films, where a rapidly spinning wheel appears to rotate slowly or even backward. This practice provides a concrete example of this \"frequency folding,\" guiding you to calculate the apparent frequency of an undersampled signal and demonstrating how aliasing can lead to a fundamental misinterpretation of measured data. [@problem_id:1557455]", "problem": "A control engineer is tasked with implementing a digital monitoring system for a high-speed rotating machine. A sensor attached to the machine measures its primary vibration, which is a pure sinusoidal signal with a frequency of $f_{actual} = 120$ Hz. The engineer connects this sensor to a data acquisition (DAQ) system. However, due to budget constraints, the only available DAQ system has a maximum sampling rate of $f_s = 100$ Hz, which the engineer sets for the measurement. When the engineer analyzes the digitally sampled data, the frequency of the oscillation appears to be different from the actual physical vibration.\n\nAssuming no anti-aliasing filter is used, calculate the apparent frequency of the machine's vibration as it would be observed in the discrete-time data. The apparent frequency is defined as the unique frequency $f_{apparent}$ in the range $0 \\le f_{apparent} \\le f_s/2$.\n\nExpress your final answer in Hz, rounded to three significant figures.", "solution": "The continuous-time sinusoidal signal is $x(t)=A\\cos(2\\pi f_{actual} t+\\phi)$ with $f_{actual}=120$. Sampling at rate $f_{s}=100$ produces a discrete-time sinusoid whose digital angular frequency is\n$$\n\\omega_{d}=2\\pi\\left(\\frac{f_{actual}}{f_{s}}\\right)\\ \\text{mod}\\ 2\\pi.\n$$\nAliasing arises because spectral replicas occur at integer multiples of $f_{s}$. The apparent continuous-time frequency observed from the sampled data is the unique folded frequency in $[0, f_{s}/2]$, given by\n$$\nf_{apparent}=\\left|f_{actual}-n f_{s}\\right|,\n$$\nwhere $n\\in\\mathbb{Z}$ is chosen to minimize $\\left|f_{actual}-n f_{s}\\right|$, equivalently $n=\\operatorname{round}\\!\\left(\\frac{f_{actual}}{f_{s}}\\right)$.\n\nCompute\n$$\nn=\\operatorname{round}\\!\\left(\\frac{120}{100}\\right)=\\operatorname{round}(1.2)=1,\n$$\nso\n$$\nf_{apparent}=\\left|120-1\\cdot 100\\right|=20.\n$$\nSince $f_{apparent}=20\\leq \\frac{f_{s}}{2}=50$, no further folding is needed. Rounding to three significant figures yields $20.0$.", "answer": "$$\\boxed{20.0}$$", "id": "1557455"}, {"introduction": "In practical engineering applications, signals are often corrupted by high-frequency noise from the environment. Even if our signal of interest has a low frequency, this unwanted noise can be aliased into our measurement band, corrupting our data and destabilizing a control system. The solution is to use an anti-aliasing filter, a low-pass filter that removes these high frequencies before sampling. This final exercise bridges theory and practice by having you design a Butterworth anti-aliasing filter to meet a specific noise attenuation requirement, a common task for control engineers ensuring system robustness and reliability. [@problem_id:1557475]", "problem": "A digital control system is being designed for a high-precision manufacturing process. The system relies on a sensor measurement that is sampled at a frequency $f_s = 20.0 \\text{ kHz}$. The control algorithm is designed to effectively manage system dynamics up to the Nyquist frequency. However, the manufacturing environment contains equipment that generates a strong sinusoidal electromagnetic interference, corrupting the sensor signal with a noise component at a frequency of $f_n = 35.0 \\text{ kHz}$.\n\nTo prevent this high-frequency noise from aliasing into the operating frequency band of the controller, a Butterworth low-pass anti-aliasing filter is placed in the signal path just before the sampler. The cutoff frequency of this filter, $f_c$, is set precisely to the Nyquist frequency of the sampling system. For the controller to maintain its required performance and stability margins, the amplitude of the noise component at frequency $f_n$ must be attenuated by a factor of at least $1000$ (i.e., its amplitude after filtering must be no more than $0.1\\%$ of its original amplitude).\n\nDetermine the minimum integer order, $N$, of the Butterworth filter required to satisfy this attenuation specification.", "solution": "The sampling frequency is given as $f_{s} = 20.0$ kHz. The Nyquist frequency is therefore $f_{\\text{N}} = \\frac{f_{s}}{2}$, and the anti-aliasing Butterworth filter has cutoff $f_{c} = f_{\\text{N}}$. The interference frequency is $f_{n} = 35.0$ kHz, so the frequency ratio relative to the cutoff is\n$$\nr \\equiv \\frac{f_{n}}{f_{c}} = \\frac{f_{n}}{f_{s}/2} = \\frac{35.0}{10.0} = 3.5.\n$$\n\nFor an $N$th-order Butterworth low-pass filter, the magnitude response at frequency $f$ is\n$$\n|H(j2\\pi f)| = \\frac{1}{\\sqrt{1 + \\left(\\frac{f}{f_{c}}\\right)^{2N}}}.\n$$\nAt $f = f_{n}$ this becomes\n$$\n|H(j2\\pi f_{n})| = \\frac{1}{\\sqrt{1 + r^{2N}}}.\n$$\n\nThe specification requires an amplitude attenuation factor of at least $1000$, i.e.\n$$\n|H(j2\\pi f_{n})| \\leq \\frac{1}{1000}.\n$$\nImposing this on the Butterworth response gives\n$$\n\\frac{1}{\\sqrt{1 + r^{2N}}} \\leq \\frac{1}{1000}\n\\;\\;\\Longrightarrow\\;\\;\n\\sqrt{1 + r^{2N}} \\geq 10^{3}\n\\;\\;\\Longrightarrow\\;\\;\n1 + r^{2N} \\geq 10^{6}\n\\;\\;\\Longrightarrow\\;\\;\nr^{2N} \\geq 10^{6} - 1.\n$$\nTaking natural logarithms,\n$$\n2N \\ln r \\geq \\ln\\!\\left(10^{6} - 1\\right)\n\\;\\;\\Longrightarrow\\;\\;\nN \\geq \\frac{1}{2}\\,\\frac{\\ln\\!\\left(10^{6} - 1\\right)}{\\ln r}.\n$$\nWith $r = 3.5$,\n$$\nN \\geq \\frac{1}{2}\\,\\frac{\\ln\\!\\left(10^{6} - 1\\right)}{\\ln(3.5)} \\approx 5.514\\ldots\n$$\nHence the minimum integer order is the ceiling:\n$$\nN_{\\min} = 6.\n$$\n\nVerification:\n- For $N = 5$: $r^{2N} = 3.5^{10} \\approx 2.77 \\times 10^{5}$, so $|H| \\approx \\frac{1}{\\sqrt{1 + 2.77 \\times 10^{5}}} \\approx \\frac{1}{526}$, which is not sufficient.\n- For $N = 6$: $r^{2N} = 3.5^{12} \\approx 3.38 \\times 10^{6}$, so $|H| \\approx \\frac{1}{\\sqrt{1 + 3.38 \\times 10^{6}}} \\approx \\frac{1}{1838}$, which meets the requirement.\n\nTherefore, a sixth-order Butterworth filter is required.", "answer": "$$\\boxed{6}$$", "id": "1557475"}]}