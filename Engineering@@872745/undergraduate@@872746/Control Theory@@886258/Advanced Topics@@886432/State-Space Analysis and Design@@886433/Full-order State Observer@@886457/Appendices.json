{"hands_on_practices": [{"introduction": "The fundamental goal of a state observer is to produce an estimate that rapidly converges to the true state of a system. The key to achieving this is to design the observer so that the dynamics of the estimation error, $e = x - \\hat{x}$, are stable and fast. This practice gets to the heart of observer design by tasking you with calculating the observer gain matrix $L$ to place the eigenvalues of the error dynamics at specific, desired locations in the complex plane [@problem_id:1577274]. This method, known as pole placement, is a cornerstone of modern control theory.", "problem": "A simplified model for the single-axis attitude dynamics of a small satellite is described by a linear time-invariant system. The state of the system is represented by the vector $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$, where $x_1$ is the angular position and $x_2$ is the angular velocity. The system dynamics are given by the state-space equations:\n\n$$\n\\dot{x} = Ax + Bu\n$$\n$$\ny = Cx\n$$\n\nThe system matrices are given as:\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\nThe matrix $B$ and the control input $u$ are part of the control system design and are not needed for this problem.\n\nDue to sensor limitations, only the angular position $x_1$ can be directly measured, as reflected by the output matrix $C$. To control the satellite effectively, an estimate of the full state vector $x$ is required. A Luenberger state observer is designed to provide this estimate, denoted by $\\hat{x}$. The performance of this observer is determined by the dynamics of the estimation error, $e = x - \\hat{x}$.\n\nYour task is to determine the observer gain matrix $L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$ that places the two eigenvalues (poles) of the estimation error dynamics at the desired locations $s_1 = -p_1$ and $s_2 = -p_2$, where $p_1$ and $p_2$ are distinct positive real constants that specify the desired speed of convergence for the observer.\n\nExpress the observer gain matrix $L$ as a column vector in terms of $p_1$ and $p_2$.", "solution": "A Luenberger observer for the system is defined by\n$$\n\\dot{\\hat{x}} = A \\hat{x} + B u + L\\big(y - C \\hat{x}\\big).\n$$\nDefine the estimation error $e = x - \\hat{x}$. Using the plant dynamics $\\dot{x} = A x + B u$ and the observer dynamics, the error dynamics are\n$$\n\\dot{e} = \\dot{x} - \\dot{\\hat{x}} = A x + B u - \\big(A \\hat{x} + B u + L(C x - C \\hat{x})\\big) = (A - L C)e.\n$$\nWith $A = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$, and $L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}$, we have\n$$\nA - L C = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}\\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} -l_{1} & 1 \\\\ -l_{2} & 0 \\end{pmatrix}.\n$$\nThe characteristic polynomial of the error dynamics matrix is\n$$\n\\det\\big(s I - (A - L C)\\big) = \\det\\begin{pmatrix} s + l_{1} & -1 \\\\ l_{2} & s \\end{pmatrix} = s(s + l_{1}) + l_{2} = s^{2} + l_{1}s + l_{2}.\n$$\nThe desired error dynamics have eigenvalues at $s_{1} = -p_{1}$ and $s_{2} = -p_{2}$, so the desired characteristic polynomial is\n$$\n(s + p_{1})(s + p_{2}) = s^{2} + (p_{1} + p_{2})s + p_{1}p_{2}.\n$$\nMatching coefficients yields\n$$\nl_{1} = p_{1} + p_{2}, \\quad l_{2} = p_{1}p_{2}.\n$$\nTherefore, the observer gain is\n$$\nL = \\begin{pmatrix} p_{1} + p_{2} \\\\ p_{1}p_{2} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} p_{1}+p_{2} \\\\ p_{1}p_{2} \\end{pmatrix}}$$", "id": "1577274"}, {"introduction": "While an ideal observer's error converges to zero, real-world systems must contend with imperfections like sensor noise and quantization. This practice explores how a persistent, bounded disturbance affects the observer's accuracy in the long run. By analyzing the system's response to a quantized output signal, you will learn to determine the ultimate bounds on the steady-state estimation error, a crucial step in assessing the practical performance of an observer design [@problem_id:1577300].", "problem": "Consider a linear time-invariant system described by the state-space equations:\n$$\n\\dot{x}(t) = Ax(t) + Bu(t) \\\\\ny(t) = Cx(t)\n$$\nwhere $x(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$ is the state vector, $u(t)$ is a scalar input, and $y(t)$ is the scalar output. The system matrices are given by:\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\nA full-order state observer is designed to estimate the state vector $x(t)$. The observer dynamics are given by:\n$$\n\\dot{\\hat{x}}(t) = A\\hat{x}(t) + Bu(t) + L(y_q(t) - C\\hat{x}(t))\n$$\nwhere $\\hat{x}(t)$ is the estimated state vector and $L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$ is the observer gain vector.\n\nThe sensor measuring the output $y(t)$ is subject to uniform quantization. The quantized measurement, $y_q(t)$, is related to the true output $y(t)$ by $y_q(t) = y(t) + e_q(t)$, where $e_q(t)$ is the quantization error. This error is bounded by $|e_q(t)| \\le \\frac{\\Delta}{2}$ for all time $t$, where $\\Delta$ is the quantization resolution.\n\nThe observer gain vector $L$ is chosen such that both eigenvalues of the observer error dynamics matrix are placed at $-p$, where $p$ is a given positive real constant.\n\nLet the state estimation error be $e(t) = x(t) - \\hat{x}(t) = \\begin{pmatrix} e_1(t) \\\\ e_2(t) \\end{pmatrix}$. Due to the persistent quantization error, the estimation error does not converge to zero but remains within a bounded region in the steady state. Let the ultimate bounds on the magnitudes of the individual error components be denoted by $E_1^{\\max}$ and $E_2^{\\max}$, representing the supremum of $|e_1(t)|$ and $|e_2(t)|$ respectively, as $t \\to \\infty$.\n\nDetermine the analytical expression for the ratio $\\frac{E_1^{\\max}}{E_2^{\\max}}$ in terms of the parameter $p$.", "solution": "The observer error dynamics with quantized measurement follow from\n$$\n\\dot{x} = A x + B u, \\quad \\dot{\\hat{x}} = A \\hat{x} + B u + L(y_{q} - C \\hat{x}), \\quad y_{q} = C x + e_{q},\n$$\nso, with $e = x - \\hat{x}$ and $M \\equiv A - L C$, we obtain\n$$\n\\dot{e} = M e - L e_{q}.\n$$\nPlacing both eigenvalues of $M$ at $-p$ means that the characteristic polynomial of $M$ equals $(s + p)^{2} = s^{2} + 2 p s + p^{2}$. For\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix},\n$$\nwe have\n$$\nM = A - L C = \\begin{pmatrix} -l_{1} & 1 \\\\ -l_{2} & 0 \\end{pmatrix},\n$$\nwhose characteristic polynomial is $s^{2} + l_{1} s + l_{2}$. Matching coefficients gives\n$$\nl_{1} = 2 p, \\qquad l_{2} = p^{2}, \\qquad L = \\begin{pmatrix} 2 p \\\\ p^{2} \\end{pmatrix}, \\qquad M = \\begin{pmatrix} -2 p & 1 \\\\ -p^{2} & 0 \\end{pmatrix}.\n$$\n\nTreat $e_{q}$ as a bounded disturbance input with $|e_{q}(t)| \\le \\Delta/2$. The (vector) transfer function from $e_{q}$ to $e$ is\n$$\nG(s) = -(s I - M)^{-1} L.\n$$\nCompute\n$$\ns I - M = \\begin{pmatrix} s + 2 p & -1 \\\\ p^{2} & s \\end{pmatrix}, \\quad (s I - M)^{-1} = \\frac{1}{(s + p)^{2}} \\begin{pmatrix} s & 1 \\\\ -p^{2} & s + 2 p \\end{pmatrix},\n$$\nso\n$$\nG(s) = -\\frac{1}{(s + p)^{2}} \\begin{pmatrix} s & 1 \\\\ -p^{2} & s + 2 p \\end{pmatrix} \\begin{pmatrix} 2 p \\\\ p^{2} \\end{pmatrix} = -\\begin{pmatrix} \\dfrac{2 p s + p^{2}}{(s + p)^{2}} \\\\ \\dfrac{p^{2} s}{(s + p)^{2}} \\end{pmatrix}.\n$$\nHence the componentwise impulse responses $h_{1}(t)$ and $h_{2}(t)$ (from $e_{q}$ to $e_{1}$ and $e_{2}$) are\n$$\nh_{1}(t) = \\mathcal{L}^{-1}\\!\\left[-\\frac{2 p s + p^{2}}{(s + p)^{2}}\\right]\n= -2 p \\bigl(\\exp(-p t) - p t \\exp(-p t)\\bigr) - p^{2} \\bigl(t \\exp(-p t)\\bigr)\n= p \\exp(-p t)\\,(p t - 2),\n$$\n$$\nh_{2}(t) = \\mathcal{L}^{-1}\\!\\left[-\\frac{p^{2} s}{(s + p)^{2}}\\right]\n= -p^{2} \\bigl(\\exp(-p t) - p t \\exp(-p t)\\bigr)\n= p^{2} \\exp(-p t)\\,(p t - 1).\n$$\n\nFor a stable LTI system with scalar input $u(t)$ and impulse response $h_{i}(t)$, the output satisfies\n$$\n|e_{i}(t)| = \\left|\\int_{0}^{\\infty} h_{i}(\\tau)\\, u(t - \\tau)\\, d\\tau\\right|\n\\le \\|u\\|_{\\infty} \\int_{0}^{\\infty} |h_{i}(\\tau)|\\, d\\tau.\n$$\nThis bound is tight in the sense that, by choosing $u$ to align with the sign of $h_{i}$, the supremum over time approaches $\\|u\\|_{\\infty} \\int_{0}^{\\infty} |h_{i}(\\tau)|\\, d\\tau$. Therefore, with $|e_{q}(t)| \\le \\Delta/2$, the ultimate bounds are\n$$\nE_{i}^{\\max} = \\frac{\\Delta}{2} \\int_{0}^{\\infty} |h_{i}(t)|\\, dt,\n$$\nand the ratio is independent of $\\Delta$:\n$$\n\\frac{E_{1}^{\\max}}{E_{2}^{\\max}} = \\frac{\\int_{0}^{\\infty} |h_{1}(t)|\\, dt}{\\int_{0}^{\\infty} |h_{2}(t)|\\, dt}.\n$$\n\nCompute these integrals. With the change of variable $z = p t$ (so $dt = dz/p$), we have\n$$\n|h_{1}(t)| = p \\exp(-p t) |p t - 2|, \\quad |h_{2}(t)| = p^{2} \\exp(-p t) |p t - 1|.\n$$\nThus\n$$\n\\int_{0}^{\\infty} |h_{1}(t)|\\, dt = \\int_{0}^{\\infty} \\exp(-z) |z - 2|\\, dz\n= \\int_{0}^{2} \\exp(-z)(2 - z)\\, dz + \\int_{2}^{\\infty} \\exp(-z)(z - 2)\\, dz.\n$$\nUsing $\\int \\exp(-z) (z - c)\\, dz = (c - z - 1)\\exp(-z) + \\text{const}$, the two terms evaluate to\n$$\n\\int_{0}^{2} \\exp(-z)(2 - z)\\, dz = 1 + \\exp(-2), \\qquad\n\\int_{2}^{\\infty} \\exp(-z)(z - 2)\\, dz = \\exp(-2),\n$$\nso\n$$\n\\int_{0}^{\\infty} |h_{1}(t)|\\, dt = 1 + 2 \\exp(-2).\n$$\nSimilarly,\n$$\n\\int_{0}^{\\infty} |h_{2}(t)|\\, dt = p \\int_{0}^{\\infty} \\exp(-z) |z - 1|\\, dz\n= p \\left[\\int_{0}^{1} \\exp(-z)(1 - z)\\, dz + \\int_{1}^{\\infty} \\exp(-z)(z - 1)\\, dz\\right]\n= p \\left[\\exp(-1) + \\exp(-1)\\right]\n= 2 p \\exp(-1).\n$$\n\nTherefore,\n$$\n\\frac{E_{1}^{\\max}}{E_{2}^{\\max}} = \\frac{1 + 2 \\exp(-2)}{2 p \\exp(-1)} = \\frac{\\exp(1) + 2 \\exp(-1)}{2 p}.\n$$\nThis expression depends only on $p$ (as required), with all other quantities cancelling in the ratio.", "answer": "$$\\boxed{\\frac{\\exp(1)+2\\exp(-1)}{2p}}$$", "id": "1577300"}, {"introduction": "In the world of digital control, systems evolve in discrete time steps, which allows for a unique and powerful observer design known as a \"deadbeat\" observer. This type of observer is engineered to drive any initial estimation error to exactly zero in a minimum number of steps. This exercise challenges you to first design such a high-performance observer and then analyze its behavior when faced with an unexpected, transient disturbance, providing insight into the robustness of finite-time convergence schemes [@problem_id:1577305].", "problem": "Consider a discrete-time, linear time-invariant system described by the state-space equations:\n$$\nx(k+1) = A x(k) + B u(k)\n$$\n$$\ny(k) = C x(k)\n$$\nwhere $k$ is the time index, $x(k) \\in \\mathbb{R}^2$ is the state vector, $u(k) \\in \\mathbb{R}$ is the control input, and $y(k) \\in \\mathbb{R}$ is the measured output. The system matrices are given by:\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\nA full-order state observer is designed for this system. The observer is required to be a \"deadbeat\" observer, meaning that for the nominal system (without disturbances), any initial estimation error is driven to zero in the minimum possible number of time steps.\n\nThe system is operated under the following conditions:\n1. The true initial state of the system is the zero vector, $x(0) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\n2. The observer's initial state estimate is incorrect, given by $\\hat{x}(0) = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n3. The control input is held at zero for all time, $u(k) = 0$ for all $k \\ge 0$.\n4. The system is subject to an unmodeled, transient disturbance on the input. The true system dynamics are actually $x(k+1) = A x(k) + B(u(k) + w(k))$, where the disturbance $w(k)$ is a single pulse: $w(0) = 1$ and $w(k) = 0$ for all $k \\ge 1$. The observer's model does not account for $w(k)$.\n\nYour task is to calculate the state estimation error vector, defined as $e(k) = x(k) - \\hat{x}(k)$, at the specific time step $k=2$. The final answer should be a row matrix containing the components of the error vector $e(2)$.", "solution": "The problem asks for the state estimation error $e(2)$ for a system with a deadbeat observer, subject to an initial estimation error and an unmodeled input disturbance.\n\nFirst, we design the deadbeat observer. The structure of a full-order Luenberger observer is:\n$$\n\\hat{x}(k+1) = A\\hat{x}(k) + Bu(k) + L(y(k) - \\hat{y}(k))\n$$\nwhere $L$ is the observer gain matrix, and $\\hat{y}(k) = C\\hat{x}(k)$ is the estimated output.\n\nThe state estimation error is $e(k) = x(k) - \\hat{x}(k)$. Let's derive the error dynamics. The actual system dynamics including the disturbance $w(k)$ are $x(k+1) = Ax(k) + Bu(k) + Bw(k)$.\nThe observer dynamics are $\\hat{x}(k+1) = A\\hat{x}(k) + Bu(k) + L(Cx(k) - C\\hat{x}(k))$.\nSubtracting the observer equation from the system equation:\n$$\ne(k+1) = x(k+1) - \\hat{x}(k+1) = (Ax(k) + Bu(k) + Bw(k)) - (A\\hat{x}(k) + Bu(k) + LC(x(k) - \\hat{x}(k)))\n$$\n$$\ne(k+1) = A(x(k) - \\hat{x}(k)) - LC(x(k) - \\hat{x}(k)) + Bw(k)\n$$\n$$\ne(k+1) = (A - LC)e(k) + Bw(k)\n$$\nThis is the equation governing the evolution of the estimation error.\n\nFor a deadbeat observer, the eigenvalues of the matrix $A_e = A - LC$ must all be at the origin. This means the characteristic polynomial of $A_e$ must be $\\det(zI - A_e) = z^n$, where $n$ is the dimension of the state, which is $n=2$ in this case.\n\nLet the observer gain be $L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$. The error dynamics matrix is:\n$$\nA_e = A - LC = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} l_1 & 0 \\\\ l_2 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 - l_1 & 1 \\\\ -l_2 & 1 \\end{pmatrix}\n$$\nThe characteristic polynomial is:\n$$\n\\det(zI - A_e) = \\det \\begin{pmatrix} z - (1-l_1) & -1 \\\\ l_2 & z - 1 \\end{pmatrix} = (z - 1 + l_1)(z - 1) + l_2\n$$\n$$\n= z^2 - z + l_1 z - z + 1 - l_1 + l_2 = z^2 + (l_1 - 2)z + (1 - l_1 + l_2)\n$$\nFor a deadbeat observer, we want this polynomial to be $z^2 + 0z + 0$. By comparing the coefficients, we get:\n- Coefficient of $z^1$: $l_1 - 2 = 0 \\implies l_1 = 2$\n- Coefficient of $z^0$: $1 - l_1 + l_2 = 0 \\implies 1 - 2 + l_2 = 0 \\implies l_2 = 1$\n\nSo, the required observer gain is $L = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$.\nWith this gain, the error dynamics matrix is $A_e = \\begin{pmatrix} 1 - 2 & 1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix}$.\nLet's verify that $A_e^2 = 0$:\n$$\nA_e^2 = \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} (-1)(-1) + (1)(-1) & (-1)(1) + (1)(1) \\\\ (-1)(-1) + (1)(-1) & (-1)(1) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nThis confirms the deadbeat design for $n=2$.\n\nNow we compute the error evolution. The initial error is:\n$$\ne(0) = x(0) - \\hat{x}(0) = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\nThe disturbance is $w(0)=1$ and $w(k)=0$ for $k \\ge 1$.\nThe error at $k=1$ is:\n$$\ne(1) = A_e e(0) + B w(0) = \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (1)\n$$\n$$\ne(1) = \\begin{pmatrix} 1+1 \\\\ 1+1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}\n$$\nThe error at $k=2$ is:\n$$\ne(2) = A_e e(1) + B w(1)\n$$\nSince $w(1)=0$, this simplifies to:\n$$\ne(2) = A_e e(1) = \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -2+3 \\\\ -2+3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n\nAlternatively, we can use the general solution for the error dynamics:\n$$\ne(k) = A_e^k e(0) + \\sum_{j=0}^{k-1} A_e^{k-1-j} B w(j)\n$$\nFor $k=2$, this is:\n$$\ne(2) = A_e^2 e(0) + A_e^{1} B w(0) + A_e^{0} B w(1) = A_e^2 e(0) + A_e B w(0) + I B w(1)\n$$\nSince $A_e^2=0$ and $w(1)=0$, the equation simplifies significantly:\n$$\ne(2) = (0) e(0) + A_e B w(0) + B (0) = A_e B w(0)\n$$\nLet's compute $A_e B$:\n$$\nA_e B = \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nNow, substitute this into the expression for $e(2)$:\n$$\ne(2) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} w(0) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} (1) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nBoth methods yield the same result. The estimation error at $k=2$ is $e(2) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. As a row matrix, this is $\\begin{pmatrix} 1 & 1 \\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 1 \\end{pmatrix}}$$", "id": "1577305"}]}