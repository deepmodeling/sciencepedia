{"hands_on_practices": [{"introduction": "Understanding controllability begins with its fundamental mathematical definition. This first practice problem takes you back to basics, focusing on the discrete-time controllability Gramian, which is constructed as a sum over a finite time horizon. By directly applying the summation formula to a simple diagonal system, you will gain hands-on experience with the building blocks of controllability analysis and see how the system's dynamics influence its ability to be controlled over time [@problem_id:1565967].", "problem": "A discrete-time, linear time-invariant (LTI) system is used to model the dynamics of a simplified two-component chemical reaction. The concentration deviations from equilibrium are represented by the state vector $x_k \\in \\mathbb{R}^2$ at discrete time step $k$. The system's evolution is governed by the state-space equation:\n$$x_{k+1} = A x_k + B u_k$$\nwhere $u_k \\in \\mathbb{R}$ is a scalar input representing the rate of addition of a catalyst. The system matrices $A$ and $B$ are given by:\n$$A = \\begin{pmatrix} a_1 & 0 \\\\ 0 & a_2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$$\nHere, $a_1, a_2, b_1, b_2$ are real constants representing reaction rates and sensitivities to the catalyst.\n\nA key matrix in analyzing such systems is the discrete-time controllability Gramian, $W_c$, which is defined over a finite time horizon of $N$ steps as:\n$$W_c(N) = \\sum_{k=0}^{N-1} A^k B B^T (A^k)^T$$\nCalculate the controllability Gramian $W_c(N)$ for this system. Assume that the parameters are such that $|a_1| \\neq 1$, $|a_2| \\neq 1$, and $|a_1 a_2| \\neq 1$. The final answer should be a $2 \\times 2$ matrix with entries expressed in terms of $a_1, a_2, b_1, b_2$, and $N$.", "solution": "We are given the discrete-time, linear time-invariant system with state update\n$$x_{k+1} = A x_k + B u_k,$$\nand the finite-horizon controllability Gramian\n$$W_{c}(N) = \\sum_{k=0}^{N-1} A^{k} B B^{T} (A^{k})^{T}.$$\nWith\n$$A = \\begin{pmatrix} a_{1} & 0 \\\\ 0 & a_{2} \\end{pmatrix}, \\quad B = \\begin{pmatrix} b_{1} \\\\ b_{2} \\end{pmatrix},$$\nwe first compute powers of the diagonal matrix $A$:\n$$A^{k} = \\begin{pmatrix} a_{1}^{k} & 0 \\\\ 0 & a_{2}^{k} \\end{pmatrix}, \\quad (A^{k})^{T} = A^{k}.$$\nThe product $A^{k} B$ is\n$$A^{k} B = \\begin{pmatrix} a_{1}^{k} b_{1} \\\\ a_{2}^{k} b_{2} \\end{pmatrix}.$$\nTherefore,\n$$A^{k} B B^{T} (A^{k})^{T} = (A^{k} B)(A^{k} B)^{T} = \\begin{pmatrix} a_{1}^{2k} b_{1}^{2} & a_{1}^{k} a_{2}^{k} b_{1} b_{2} \\\\ a_{1}^{k} a_{2}^{k} b_{1} b_{2} & a_{2}^{2k} b_{2}^{2} \\end{pmatrix}.$$\nSumming from $k=0$ to $N-1$ gives\n$$W_{c}(N) = \\sum_{k=0}^{N-1} \\begin{pmatrix} a_{1}^{2k} b_{1}^{2} & a_{1}^{k} a_{2}^{k} b_{1} b_{2} \\\\ a_{1}^{k} a_{2}^{k} b_{1} b_{2} & a_{2}^{2k} b_{2}^{2} \\end{pmatrix} = \\begin{pmatrix} b_{1}^{2} \\sum_{k=0}^{N-1} a_{1}^{2k} & b_{1} b_{2} \\sum_{k=0}^{N-1} (a_{1} a_{2})^{k} \\\\ b_{1} b_{2} \\sum_{k=0}^{N-1} (a_{1} a_{2})^{k} & b_{2}^{2} \\sum_{k=0}^{N-1} a_{2}^{2k} \\end{pmatrix}.$$\nEach sum is a finite geometric series. For $r \\neq 1$,\n$$\\sum_{k=0}^{N-1} r^{k} = \\frac{1 - r^{N}}{1 - r}.$$\nUsing the assumptions $|a_{1}| \\neq 1$, $|a_{2}| \\neq 1$, and $|a_{1} a_{2}| \\neq 1$, we obtain\n$$\\sum_{k=0}^{N-1} a_{1}^{2k} = \\frac{1 - a_{1}^{2N}}{1 - a_{1}^{2}}, \\quad \\sum_{k=0}^{N-1} a_{2}^{2k} = \\frac{1 - a_{2}^{2N}}{1 - a_{2}^{2}}, \\quad \\sum_{k=0}^{N-1} (a_{1} a_{2})^{k} = \\frac{1 - (a_{1} a_{2})^{N}}{1 - a_{1} a_{2}}.$$\nTherefore, the controllability Gramian is\n$$W_{c}(N) = \\begin{pmatrix} b_{1}^{2} \\frac{1 - a_{1}^{2N}}{1 - a_{1}^{2}} & b_{1} b_{2} \\frac{1 - (a_{1} a_{2})^{N}}{1 - a_{1} a_{2}} \\\\ b_{1} b_{2} \\frac{1 - (a_{1} a_{2})^{N}}{1 - a_{1} a_{2}} & b_{2}^{2} \\frac{1 - a_{2}^{2N}}{1 - a_{2}^{2}} \\end{pmatrix}.$$\nThis expression is valid under the stated parameter assumptions, which ensure that the denominators are nonzero.", "answer": "$$\\boxed{\\begin{pmatrix} b_{1}^{2} \\frac{1 - a_{1}^{2N}}{1 - a_{1}^{2}} & b_{1} b_{2} \\frac{1 - (a_{1} a_{2})^{N}}{1 - a_{1} a_{2}} \\\\ b_{1} b_{2} \\frac{1 - (a_{1} a_{2})^{N}}{1 - a_{1} a_{2}} & b_{2}^{2} \\frac{1 - a_{2}^{2N}}{1 - a_{2}^{2}} \\end{pmatrix}}$$", "id": "1565967"}, {"introduction": "While the summation formula is fundamental, for stable continuous-time systems, there is a more elegant method to determine controllability over an infinite horizon. This exercise introduces the algebraic Lyapunov equation, a cornerstone of control theory that connects a system's stability properties directly to its controllability Gramian. By solving this equation for a system of uncoupled subsystems, you will see how the Gramian's structure reflects the system's physical structure and learn a powerful alternative to direct integration [@problem_id:1565982].", "problem": "Consider a physical system composed of two independent, non-interacting subsystems. The state of the overall system is described by the state vector $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) & x_2(t) \\end{pmatrix}^T$, and its evolution is governed by the linear time-invariant (LTI) state-space equation $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)$.\n\nThe system dynamics are defined by the matrix $A$, and the control inputs $\\mathbf{u}(t)$ influence the system through the matrix $B$. For this particular system, the matrices are given as:\n$$\nA = \\begin{pmatrix} -\\lambda_1 & 0 \\\\ 0 & -\\lambda_2 \\end{pmatrix}\n\\quad \\text{and} \\quad\nB = \\begin{pmatrix} \\beta_1 & 0 \\\\ 0 & \\beta_2 \\end{pmatrix}\n$$\nHere, $\\lambda_1$ and $\\lambda_2$ are distinct positive constants representing the stable decay rates of the two subsystems, and $\\beta_1$ and $\\beta_2$ are non-zero real constants representing the effectiveness of the corresponding inputs.\n\nThe controllability of this stable system over an infinite time horizon can be quantified by the controllability Gramian, $W_c$. This Gramian is the unique symmetric positive-definite matrix that satisfies the continuous-time algebraic Lyapunov equation:\n$$\nAW_c + W_c A^T = -BB^T\n$$\nYour task is to solve this equation to determine the controllability Gramian $W_c$ for the given system. Express your answer as a 2x2 matrix in terms of the symbolic parameters $\\lambda_1, \\lambda_2, \\beta_1$, and $\\beta_2$.", "solution": "Given the continuous-time algebraic Lyapunov equation for the controllability Gramian $W_{c}$,\n$$\nA W_{c} + W_{c} A^{T} = - B B^{T},\n$$\nwith\n$$\nA = \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix}, \\quad B = \\begin{pmatrix} \\beta_{1} & 0 \\\\ 0 & \\beta_{2} \\end{pmatrix},\n$$\nand $\\lambda_{1}, \\lambda_{2} > 0$, $\\beta_{1}, \\beta_{2} \\neq 0$. Since $A$ is diagonal with negative diagonal entries, it is Hurwitz, so the Lyapunov equation has a unique symmetric positive-definite solution. Let\n$$\nW_{c} = \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix}, \\quad A^{T} = A, \\quad B B^{T} = \\begin{pmatrix} \\beta_{1}^{2} & 0 \\\\ 0 & \\beta_{2}^{2} \\end{pmatrix}.\n$$\nCompute each term:\n$$\nA W_{c} = \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix} \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix} = \\begin{pmatrix} -\\lambda_{1} w_{11} & -\\lambda_{1} w_{12} \\\\ -\\lambda_{2} w_{12} & -\\lambda_{2} w_{22} \\end{pmatrix},\n$$\n$$\nW_{c} A = \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix} \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix} = \\begin{pmatrix} -\\lambda_{1} w_{11} & -\\lambda_{2} w_{12} \\\\ -\\lambda_{1} w_{12} & -\\lambda_{2} w_{22} \\end{pmatrix}.\n$$\nThus,\n$$\nA W_{c} + W_{c} A = \\begin{pmatrix} -2 \\lambda_{1} w_{11} & -(\\lambda_{1} + \\lambda_{2}) w_{12} \\\\ -(\\lambda_{1} + \\lambda_{2}) w_{12} & -2 \\lambda_{2} w_{22} \\end{pmatrix}.\n$$\nEquating to $- B B^{T}$ gives the system\n$$\n-2 \\lambda_{1} w_{11} = - \\beta_{1}^{2}, \\quad -(\\lambda_{1} + \\lambda_{2}) w_{12} = 0, \\quad -2 \\lambda_{2} w_{22} = - \\beta_{2}^{2}.\n$$\nSolving using $\\lambda_{1}, \\lambda_{2} > 0$ yields\n$$\nw_{11} = \\frac{\\beta_{1}^{2}}{2 \\lambda_{1}}, \\quad w_{12} = 0, \\quad w_{22} = \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}}.\n$$\nTherefore,\n$$\nW_{c} = \\begin{pmatrix} \\frac{\\beta_{1}^{2}}{2 \\lambda_{1}} & 0 \\\\ 0 & \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}} \\end{pmatrix},\n$$\nwhich is symmetric positive-definite since $\\lambda_{1}, \\lambda_{2} > 0$ and $\\beta_{1}, \\beta_{2} \\neq 0$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\beta_{1}^{2}}{2 \\lambda_{1}} & 0 \\\\ 0 & \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}}\\end{pmatrix}}$$", "id": "1565982"}, {"introduction": "Gramians are not just mathematical objects; they carry deep physical meaning about a system's behavior. This practice moves from calculation to conceptual understanding by contrasting the controllability of stable and unstable systems. By finding the precise moment when an unstable system's growing control authority matches the total, finite authority of a stable one, you will develop a powerful intuition for how system stability dictates the very nature of controllability [@problem_id:1565972].", "problem": "Consider a first-order Linear Time-Invariant (LTI) system where the state dynamics are governed by the equation $\\dot{x}(t) = A x(t) + B u(t)$, with $x(t)$ being the scalar state and $u(t)$ being the scalar control input. The finite-horizon controllability Gramian over a time interval $[0, T]$ is defined as $W_c(T) = \\int_0^T e^{A\\tau} B B^T e^{A^T \\tau} d\\tau$.\n\nWe will analyze two such systems:\n1.  An unstable system, $S_U$, described by the state equation $\\dot{x}(t) = \\alpha x(t) + \\beta u(t)$.\n2.  A stable system, $S_S$, described by the state equation $\\dot{x}(t) = -\\alpha x(t) + \\beta u(t)$.\n\nIn these models, $\\alpha$ and $\\beta$ are real constants with $\\alpha > 0$ and $\\beta \\neq 0$.\n\nLet $W_{c,U}(T)$ denote the controllability Gramian for the unstable system $S_U$. The infinite-horizon controllability Gramian for the stable system $S_S$ is well-defined and is given by $W_{c,S}(\\infty) = \\lim_{T \\to \\infty} W_{c,S}(T)$, where $W_{c,S}(T)$ is the finite-horizon Gramian for $S_S$.\n\nDetermine the specific time horizon $T^*$ at which the value of the unstable system's Gramian, $W_{c,U}(T^*)$, becomes exactly equal to the stable system's infinite-horizon Gramian, $W_{c,S}(\\infty)$. Express your answer as an analytic expression in terms of $\\alpha$.", "solution": "For a scalar first-order LTI system with state equation $\\dot{x}(t) = A x(t) + B u(t)$, the finite-horizon controllability Gramian over $[0,T]$ is\n$$\nW_{c}(T) = \\int_{0}^{T} \\exp(A \\tau)\\, B B^{T}\\, \\exp(A^{T} \\tau)\\, d\\tau.\n$$\nSince $A$ and $B$ are scalars, $A^{T} = A$ and $B B^{T} = \\beta^{2}$. Therefore,\n$$\nW_{c}(T) = \\beta^{2} \\int_{0}^{T} \\exp(2 A \\tau)\\, d\\tau.\n$$\nEvaluating the integral for $A \\neq 0$ gives\n$$\nW_{c}(T) = \\beta^{2} \\left[\\frac{1}{2 A} \\exp(2 A \\tau)\\right]_{0}^{T} = \\frac{\\beta^{2}}{2 A}\\left(\\exp(2 A T) - 1\\right).\n$$\n\nFor the unstable system $S_{U}$ with $A = \\alpha$ and $\\alpha > 0$,\n$$\nW_{c,U}(T) = \\frac{\\beta^{2}}{2 \\alpha}\\left(\\exp(2 \\alpha T) - 1\\right).\n$$\nFor the stable system $S_{S}$ with $A = -\\alpha$,\n$$\nW_{c,S}(T) = \\beta^{2} \\int_{0}^{T} \\exp(-2 \\alpha \\tau)\\, d\\tau = \\frac{\\beta^{2}}{2 \\alpha}\\left(1 - \\exp(-2 \\alpha T)\\right),\n$$\nand the infinite-horizon Gramian is\n$$\nW_{c,S}(\\infty) = \\lim_{T \\to \\infty} W_{c,S}(T) = \\frac{\\beta^{2}}{2 \\alpha}.\n$$\n\nWe seek $T^{*}$ such that $W_{c,U}(T^{*}) = W_{c,S}(\\infty)$. Setting these equal,\n$$\n\\frac{\\beta^{2}}{2 \\alpha}\\left(\\exp(2 \\alpha T^{*}) - 1\\right) = \\frac{\\beta^{2}}{2 \\alpha}.\n$$\nBecause $\\alpha > 0$ and $\\beta \\neq 0$, we divide both sides by $\\frac{\\beta^{2}}{2 \\alpha}$ to obtain\n$$\n\\exp(2 \\alpha T^{*}) - 1 = 1 \\quad \\Rightarrow \\quad \\exp(2 \\alpha T^{*}) = 2.\n$$\nTaking the natural logarithm,\n$$\n2 \\alpha T^{*} = \\ln 2 \\quad \\Rightarrow \\quad T^{*} = \\frac{1}{2 \\alpha} \\ln 2.\n$$\nThis expression depends only on $\\alpha$, as required.", "answer": "$$\\boxed{\\frac{\\ln 2}{2\\alpha}}$$", "id": "1565972"}]}