{"hands_on_practices": [{"introduction": "The foundation of a reliable computational fluid dynamics (CFD) simulation is a well-designed mesh. This first practice challenges you to think like a CFD analyst by deciding on the most efficient grid strategy for a classic benchmark problem: flow over a backward-facing step. You will apply the fundamental principle of mesh refinement, which dictates that computational cells should be concentrated in regions where flow variables change rapidly, such as near walls and in areas of flow separation [@problem_id:1761175].", "problem": "In the field of Computational Fluid Dynamics (CFD), the accuracy of a numerical simulation heavily depends on the quality of the computational mesh, or grid, used to discretize the domain. Consider the classic problem of two-dimensional, incompressible, laminar flow through a channel that undergoes a sudden expansion, commonly known as a backward-facing step. The channel has a height $H$ upstream of the step and a height $H_2 > H$ downstream. The flow enters from the left with a uniform velocity profile and develops as it moves to the right.\n\nFor a successful simulation, the grid must be designed to capture the important flow features accurately. The \"grid density\" refers to the concentration of grid points or cells in a particular region. A higher density is required in areas where flow variables (like velocity or pressure) change rapidly. A \"structured grid\" consists of a regular, repeating pattern of cells (e.g., quadrilaterals in 2D) where each grid point can be identified by integer indices $(i, j)$.\n\nWhich of the following descriptions represents the most appropriate and efficient grid design strategy for simulating the flow over this backward-facing step?\n\nA. A structured grid with high, uniform density across the entire domain to ensure maximum a priori accuracy everywhere.\n\nB. An unstructured grid composed of triangles, with the highest grid density located in the core of the flow, far away from any solid walls, to best capture the bulk fluid motion.\n\nC. A structured grid partitioned into several blocks (a multi-block grid). Grid lines are clustered with high density near all solid walls, with a particular concentration of cells in the region immediately downstream of the step corner.\n\nD. A structured grid with a high density only near the inlet and outlet boundaries of the channel, and a very coarse grid in the middle section, to save computational cost.\n\nE. A uniform structured grid where the cell size is determined by the smallest geometric feature, which is the sharp corner of the step itself.", "solution": "For a two-dimensional incompressible laminar backward-facing step, the dominant flow features dictating grid requirements are as follows: (i) no-slip boundary layers along all solid walls, both upstream and downstream, which impose steep wall-normal gradients and require near-wall clustering for accuracy and stability; (ii) a sudden expansion at the step that creates an adverse pressure gradient and leads to flow separation at the step corner, generating a recirculation bubble immediately downstream; (iii) a free shear layer that emanates from the step corner, grows downstream, and reattaches to the wall at a finite distance, after which the boundary layer redevelops. The largest spatial gradients in velocity and pressure occur at the walls, within the separated shear layer, and in the vicinity immediately downstream of the step where the recirculation and reattachment occur. Efficient grids allocate high density to these regions and allow coarsening in the low-gradient core flow.\n\nA structured grid aligned with the walls provides good control of orthogonality and stretching, which reduces numerical diffusion along streamwise directions and allows effective clustering normal to walls to meet near-wall resolution targets (e.g., for laminar resolution, small first-cell height consistent with the required $y^{+}$). The geometric discontinuity at the step is naturally accommodated by a multi-block structured topology, enabling local refinement and smooth grid-spacing transitions around the corner, along the separated shear layer, and across the recirculation region, while keeping the far-field core flow relatively coarse. This achieves accuracy where needed and computational efficiency elsewhere.\n\nAssessing the options:\n- A uses a high, uniform density everywhere. While accurate, it is inefficient because it wastes cells in regions with weak gradients and violates the principle of targeted refinement.\n- B places the highest density in the core away from walls. This misallocates resolution; the core has relatively mild gradients compared to walls and the shear layer, so critical near-wall and post-step regions would be under-resolved.\n- C employs a multi-block structured grid with clustering near all walls and particularly downstream of the step. This aligns with the physics: it resolves boundary layers, the separated shear layer, the recirculation bubble, and the reattachment region efficiently while allowing coarser spacing in the core.\n- D refines only near inlet and outlet and coarsens the middle, which fails to resolve the key post-step separation and shear-layer dynamics.\n- E enforces a uniform grid sized by the smallest feature (the corner), which is inefficient globally and does not provide the anisotropic near-wall clustering and localized post-step refinement required.\n\nTherefore, the most appropriate and efficient strategy is the multi-block structured grid with clustering near walls and focused refinement immediately downstream of the step, corresponding to option C.", "answer": "$$\\boxed{C}$$", "id": "1761175"}, {"introduction": "While structured grids are highly efficient, many real-world geometries are too complex to be meshed with a single rectangular block, which is where hybrid meshing is useful. This approach combines the order of structured hexahedra with the flexibility of unstructured tetrahedra. This exercise focuses on the critical transition zone between these two mesh types, asking you to quantify the geometry of the pyramidal cells that bridge the gap and ensure a conforming mesh [@problem_id:1761200].", "problem": "In the field of Computational Fluid Dynamics (CFD), creating a high-quality computational mesh is a critical step. Consider a hybrid meshing strategy for a complex domain. The domain is divided into two regions. Region 1 is a simple rectangular prism defined by $0 \\le x \\le L_x$, $0 \\le y \\le L_y$, and $0 \\le z \\le L_z$. This region is filled with a structured grid of identical hexahedral elements (cells with 6 quadrilateral faces). The grid has $N_x=50$ divisions along the x-axis, $N_y=30$ divisions along the y-axis, and $N_z=20$ divisions along the z-axis.\n\nRegion 2, which occupies the space $x > L_x$, has a complex geometry and is to be filled with an unstructured grid of tetrahedral elements (cells with 4 triangular faces). To ensure a conforming mesh, a transition layer of pyramidal elements must be placed at the interface plane at $x=L_x$. A pyramidal element is a cell with 5 faces: one quadrilateral base and four triangular side faces. The quadrilateral base of each pyramidal element in the transition layer perfectly matches one of the quadrilateral faces of a hexahedral element from the structured grid at the interface. The collection of triangular side faces of these pyramidal elements then forms a new surface, which serves as the boundary for meshing Region 2 with tetrahedra.\n\nWhat is the total number of triangular faces that make up this new boundary surface between the transition layer and the unstructured tetrahedral region?\n\nA. 600\n\nB. 1200\n\nC. 2400\n\nD. 3000\n\nE. 4800", "solution": "The problem asks for the total number of triangular faces on the surface of a transition layer used to connect a structured hexahedral mesh to an unstructured tetrahedral mesh.\n\nFirst, we need to determine the number of hexahedral element faces that lie on the interface plane between Region 1 and Region 2. The interface is located at the plane $x=L_x$. The structured grid in Region 1 has $N_y=30$ divisions along the y-axis and $N_z=20$ divisions along the z-axis. The number of quadrilateral faces on any plane of constant $x$ is the product of the number of divisions in the other two directions.\n\nNumber of quadrilateral faces at the interface = $N_y \\times N_z$\nSubstituting the given values:\nNumber of quadrilateral faces = $30 \\times 20 = 600$\n\nAccording to the problem description, a transition layer of pyramidal elements is used to connect the two regions. Each pyramidal element has a quadrilateral base that must match a quadrilateral face from the hexahedral mesh at the interface. Therefore, the number of pyramidal elements required in the transition layer is equal to the number of quadrilateral faces on the interface.\n\nNumber of pyramidal elements = Number of quadrilateral faces = 600\n\nThe problem asks for the total number of triangular faces that form the new boundary for the unstructured tetrahedral region. These triangular faces are the side faces of the pyramidal elements. Each pyramidal element is defined as having one quadrilateral base and four triangular side faces.\n\nNumber of triangular faces per pyramidal element = 4\n\nThe total number of triangular faces forming the new surface is the product of the number of pyramidal elements and the number of triangular faces per element.\n\nTotal triangular faces = (Number of pyramidal elements) $\\times$ (Triangular faces per pyramidal element)\nTotal triangular faces = $600 \\times 4 = 2400$\n\nThus, the new surface, which will serve as the boundary for the tetrahedral meshing of Region 2, is composed of 2400 triangular faces. This corresponds to option C.\n\nLet's review the other options as potential mistakes:\nA. 600: This is the number of quadrilateral faces at the interface, not the number of triangular faces after the transition.\nB. 1200: This might result from incorrectly assuming that each quadrilateral face is split into two triangles to form the new surface, which would be the case for a different type of transition (e.g., using prisms or wedges if split in a structured way).\nD. 3000: This would be $600 \\times 5$, which is the total number of faces (1 quad + 4 tri) of all pyramids, not just the triangular ones.\nE. 4800: This would be $600 \\times 8$, possibly confusing faces with vertices of the original hexahedra.", "answer": "$$\\boxed{C}$$", "id": "1761200"}, {"introduction": "What if you could bypass the often-difficult task of generating a mesh that conforms to a complex object's surface? This final practice introduces a powerful alternative paradigm known as the Immersed Boundary Method (IBM). Instead of fitting the grid to the body, IBM uses a simple, fixed grid and represents the object's physical influence through a calculated force field, a concept you will explore in this problem [@problem_id:1761230].", "problem": "In the field of Computational Fluid Dynamics (CFD), simulating fluid flow around complex or moving solid objects presents a significant challenge. Traditional methods often rely on generating a body-conforming mesh, where the computational grid lines align with the object's surface. This process can be extremely time-consuming and difficult, especially for objects with intricate geometries or those that deform over time.\n\nAn alternative approach is the Immersed Boundary Method (IBM). The IBM allows for the use of a simple, non-body-conforming grid (such as a fixed Cartesian grid) that does not change, even as the solid object moves or deforms within it. The solid boundary is simply \"immersed\" in this background fluid grid.\n\nConsider a simulation of an incompressible, viscous fluid governed by the Navier-Stokes equations, which is being performed on a fixed Cartesian grid. A solid object, with a defined surface and velocity, is present within the fluid domain. The surface of this object does not coincide with the grid lines. Which of the following statements most accurately describes the fundamental mechanism by which the Immersed Boundary Method accounts for the physical presence of the solid object and enforces the no-slip boundary condition on its surface?\n\nA. The method identifies all grid cells that lie completely inside the solid object's volume and deactivates them from the fluid flow calculation. The boundary condition is then applied on the faces of the active fluid cells that are adjacent to these deactivated cells.\n\nB. The method modifies the fluid's material properties. Specifically, the viscosity and density of the fluid are set to extremely high values at all grid points located inside the solid object, effectively making the region behave like a rigid body.\n\nC. The method introduces a carefully calculated, localized body force term into the fluid momentum equations. This force is non-zero only in the immediate vicinity of the immersed boundary and acts to drive the local fluid velocity towards the specified velocity of the solid surface.\n\nD. The method dynamically refines the mesh in every computational step, adding new grid points along the object's surface to ensure it is always captured by a layer of body-conforming cells, while the rest of the grid remains Cartesian.\n\nE. The method solves the standard fluid equations on the entire grid, and then, in a post-processing step, it finds the grid points closest to the solid surface and directly overwrites their computed velocities with the velocity of the boundary.", "solution": "We consider an incompressible, viscous fluid governed by the Navier–Stokes equations on a fixed Cartesian grid. The immersed boundary method augments the standard equations by adding a localized body force that enforces the no-slip condition on a moving or deforming solid boundary represented in Lagrangian form.\n\nStart with the incompressible Navier–Stokes equations with an added body force:\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) = -\\nabla p + \\mu \\nabla^{2}\\boldsymbol{u} + \\boldsymbol{f}_{\\mathrm{IB}},\\qquad \\nabla\\cdot \\boldsymbol{u} = 0,\n$$\nwhere $\\rho$ is the density, $\\mu$ is the dynamic viscosity, $\\boldsymbol{u}$ is the Eulerian fluid velocity, $p$ is the pressure, and $\\boldsymbol{f}_{\\mathrm{IB}}$ is the immersed-boundary forcing term.\n\nRepresent the solid surface as a Lagrangian manifold parameterized by $\\boldsymbol{X}(s,t)$ with prescribed surface velocity $\\boldsymbol{U}_{b}(s,t)$. The no-slip condition requires the Eulerian velocity at the boundary location to match the boundary velocity:\n$$\n\\boldsymbol{u}(\\boldsymbol{X}(s,t),t) = \\boldsymbol{U}_{b}(s,t).\n$$\n\nThe IBM enforces this by coupling Lagrangian and Eulerian variables via a regularized Dirac delta distribution. Define a Lagrangian force density $\\boldsymbol{F}(s,t)$ on the boundary, and spread it to the Eulerian grid to obtain the body force:\n$$\n\\boldsymbol{f}_{\\mathrm{IB}}(\\boldsymbol{x},t) = \\int_{\\Gamma} \\boldsymbol{F}(s,t)\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}(s,t)\\right)\\, \\mathrm{d}s,\n$$\nwhere $\\delta_{h}$ is a regularized delta function supported only in a small neighborhood of the boundary. Conversely, interpolate the Eulerian velocity to the boundary by\n$$\n\\boldsymbol{u}(\\boldsymbol{X}(s,t),t) = \\int_{\\Omega} \\boldsymbol{u}(\\boldsymbol{x},t)\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}(s,t)\\right)\\, \\mathrm{d}\\boldsymbol{x}.\n$$\n\nIn a typical semi-implicit time discretization, let $\\boldsymbol{u}^{*}$ be the intermediate velocity obtained without the IBM force, and let $\\Delta t$ be the time step. The velocity update due to IBM forcing is\n$$\n\\boldsymbol{u}^{n+1}(\\boldsymbol{x}) = \\boldsymbol{u}^{*}(\\boldsymbol{x}) + \\frac{\\Delta t}{\\rho}\\,\\boldsymbol{f}_{\\mathrm{IB}}^{n+1}(\\boldsymbol{x}).\n$$\nInterpolating to the boundary and enforcing no slip yields\n$$\n\\boldsymbol{U}_{b}^{n+1}(s) = \\int_{\\Omega} \\boldsymbol{u}^{n+1}(\\boldsymbol{x})\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}^{n+1}(s)\\right)\\,\\mathrm{d}\\boldsymbol{x}\n= \\int_{\\Omega} \\boldsymbol{u}^{*}(\\boldsymbol{x})\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}^{n+1}(s)\\right)\\,\\mathrm{d}\\boldsymbol{x} + \\frac{\\Delta t}{\\rho}\\int_{\\Omega} \\boldsymbol{f}_{\\mathrm{IB}}^{n+1}(\\boldsymbol{x})\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}^{n+1}(s)\\right)\\,\\mathrm{d}\\boldsymbol{x}.\n$$\nUsing the spreading relation for $\\boldsymbol{f}_{\\mathrm{IB}}$ gives\n$$\n\\int_{\\Omega} \\boldsymbol{f}_{\\mathrm{IB}}^{n+1}(\\boldsymbol{x})\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}^{n+1}(s)\\right)\\,\\mathrm{d}\\boldsymbol{x}\n= \\int_{\\Omega}\\int_{\\Gamma} \\boldsymbol{F}^{n+1}(q)\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}^{n+1}(q)\\right)\\,\\delta_{h}\\!\\left(\\boldsymbol{x}-\\boldsymbol{X}^{n+1}(s)\\right)\\,\\mathrm{d}q\\,\\mathrm{d}\\boldsymbol{x}.\n$$\nIn operator form, let $J$ denote interpolation from Eulerian grid to the boundary and $S$ denote spreading from boundary to grid, so that $\\boldsymbol{u}_{b} = J\\boldsymbol{u}$ and $\\boldsymbol{f}_{\\mathrm{IB}} = S\\boldsymbol{F}$. Then the boundary condition becomes\n$$\n\\boldsymbol{U}_{b}^{n+1} = J\\boldsymbol{u}^{*} + \\frac{\\Delta t}{\\rho}\\,J S\\,\\boldsymbol{F}^{n+1}.\n$$\nA common direct-forcing choice sets\n$$\n\\boldsymbol{F}^{n+1} = \\frac{\\rho}{\\Delta t}\\left(\\boldsymbol{U}_{b}^{n+1} - J\\boldsymbol{u}^{*}\\right),\n$$\npossibly with a suitable treatment of $J S$, which then yields\n$$\n\\boldsymbol{f}_{\\mathrm{IB}}^{n+1} = S\\boldsymbol{F}^{n+1},\n$$\na spatially localized force supported only in the immediate vicinity of the immersed boundary due to the compact support of $\\delta_{h}$. This force drives the nearby fluid velocity to match the boundary velocity, thereby enforcing no slip and no penetration without altering the mesh.\n\nThis mechanism—introducing a localized body force in the momentum equations, computed to enforce the boundary kinematics—is the defining feature of the immersed boundary method. The other options either deactivate cells (cut-cell/immersed interface type), alter material properties globally or quasi-globally (penalization of viscosity or density, not the standard IBM), rely on dynamic mesh refinement (not IBM), or overwrite velocities in post-processing (which generally violates conservation and incompressibility constraints). Therefore, the correct description is the introduction of a localized forcing term that enforces the no-slip condition.", "answer": "$$\\boxed{C}$$", "id": "1761230"}]}