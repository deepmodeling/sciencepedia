{"hands_on_practices": [{"introduction": "The best way to understand the Finite Volume Method is to apply it to a simple case. This first exercise focuses on the discretization of a pure diffusion problem, which forms the backbone of many transport phenomena models. By integrating the governing equation over a single control volume and approximating the fluxes, you will derive the fundamental algebraic relationship between a node and its neighbors, providing a solid foundation for more complex problems [@problem_id:1749431].", "problem": "Consider a one-dimensional, steady-state physical system where a scalar quantity $\\phi$ diffuses through a medium. The process is governed by the pure diffusion equation:\n$$ \\frac{d}{dx} \\left( \\Gamma \\frac{d\\phi}{dx} \\right) = 0 $$\nwhere $\\Gamma$ is the diffusion coefficient, which is assumed to be constant.\n\nThis physical domain is discretized into a uniform one-dimensional grid with a constant spacing of $\\Delta x$ between adjacent nodes. We wish to find the algebraic equation for a generic internal node $P$ (also denoted by index $i$) using the Finite Volume Method (FVM). The control volume for node $P$ is centered on the node and its boundaries (faces) are located at positions $x_P - \\frac{\\Delta x}{2}$ and $x_P + \\frac{\\Delta x}{2}$. The nodes adjacent to $P$ are the west node $W$ (index $i-1$) and the east node $E$ (index $i+1$).\n\nFollowing the FVM procedure, which involves integrating the governing equation over the control volume and approximating the fluxes at the faces, derive the resulting algebraic equation. The gradients at the control volume faces should be approximated using the values at the two nearest nodes. For example, the gradient at the east face between nodes $P$ and $E$ is approximated as $\\frac{\\phi_E - \\phi_P}{\\Delta x}$.\n\nThe final algebraic equation should be written in the standard form:\n$$ a_P \\phi_P = a_W \\phi_W + a_E \\phi_E $$\nTo ensure a unique set of coefficients, the equation must be normalized such that $a_W = \\frac{\\Gamma}{\\Delta x}$.\n\nBased on this formulation, determine the expressions for the coefficients $a_P$ and $a_E$. Present your answer as an ordered pair of expressions $(a_P, a_E)$.", "solution": "Start from the steady one-dimensional diffusion equation with constant diffusion coefficient:\n$$\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right)=0.$$\nIntegrate over the control volume of node $P$, whose faces are at $x_{w}=x_{P}-\\frac{\\Delta x}{2}$ and $x_{e}=x_{P}+\\frac{\\Delta x}{2}$:\n$$\\int_{x_{w}}^{x_{e}}\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right)\\,dx=\\left[\\Gamma \\frac{d\\phi}{dx}\\right]_{e}-\\left[\\Gamma \\frac{d\\phi}{dx}\\right]_{w}=0.$$\nApproximate the face gradients using the two nearest nodes on a uniform grid:\n$$(\\partial\\phi/\\partial x)_{e}\\approx\\frac{\\phi_{E}-\\phi_{P}}{\\Delta x},\\qquad(\\partial\\phi/\\partial x)_{w}\\approx\\frac{\\phi_{P}-\\phi_{W}}{\\Delta x}.$$\nSubstitute these into the integrated balance:\n$$\\Gamma\\frac{\\phi_{E}-\\phi_{P}}{\\Delta x}-\\Gamma\\frac{\\phi_{P}-\\phi_{W}}{\\Delta x}=0.$$\nRearrange to obtain the algebraic equation:\n$$\\frac{\\Gamma}{\\Delta x}\\,\\phi_{E}+\\frac{\\Gamma}{\\Delta x}\\,\\phi_{W}=2\\,\\frac{\\Gamma}{\\Delta x}\\,\\phi_{P}.$$\nMatch this to the standard form $a_{P}\\phi_{P}=a_{W}\\phi_{W}+a_{E}\\phi_{E}$. With the normalization $a_{W}=\\frac{\\Gamma}{\\Delta x}$, it follows that\n$$a_{E}=\\frac{\\Gamma}{\\Delta x},\\qquad a_{P}=a_{W}+a_{E}=\\frac{2\\Gamma}{\\Delta x}.$$\nThus, the requested ordered pair is $(a_{P},a_{E})=\\left(\\frac{2\\Gamma}{\\Delta x},\\frac{\\Gamma}{\\Delta x}\\right)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2\\Gamma}{\\Delta x}  \\frac{\\Gamma}{\\Delta x}\\end{pmatrix}}$$", "id": "1749431"}, {"introduction": "Real-world engineering problems rarely involve just one control volume or simple diffusion; they often include internal sources or sinks and are defined over a larger domain. This practice builds on the previous exercise by incorporating a source term and fixed boundary conditions, guiding you through the process of assembling a complete system of linear equations. Mastering this step is crucial for transitioning from single-equation derivations to solving for an entire field of values [@problem_id:1749401].", "problem": "Consider the one-dimensional, steady-state transport of a chemical species in a narrow, quiescent fluid channel of length $L$. The concentration of the species, denoted by $\\phi(x)$, is governed by the diffusion equation:\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) + S = 0\n$$\nwhere $\\Gamma$ is the constant diffusion coefficient. The species undergoes a first-order chemical reaction, leading to a source/sink term $S$ that is a linear function of the local concentration:\n$$\nS = S_C + S_P \\phi\n$$\nHere, $S_C$ and $S_P$ are constant coefficients.\n\nThe channel extends from $x=0$ to $x=L$. The concentrations at the boundaries are held constant at known values: $\\phi(0) = \\phi_A$ and $\\phi(L) = \\phi_B$.\n\nTo solve for the concentration profile, the domain is discretized into a uniform grid with five equally-spaced nodes: $x_0, x_1, x_2, x_3, x_4$, where $x_0=0$ and $x_4=L$. The concentrations at the three internal nodes, $\\phi(x_1) \\equiv \\phi_1$, $\\phi(x_2) \\equiv \\phi_2$, and $\\phi(x_3) \\equiv \\phi_3$, are unknown.\n\nApplying a central-differencing-based finite volume method to the governing equation at each internal node results in a system of three linear algebraic equations for the three unknown concentrations. This system can be written in matrix form as $[A][\\Phi] = [b]$, where $[\\Phi]$ is the column vector of unknown concentrations, $$[\\Phi] = \\begin{pmatrix} \\phi_1  \\phi_2  \\phi_3 \\end{pmatrix}^T$$.\n\nDetermine the $3 \\times 3$ coefficient matrix $[A]$. Your answer should be expressed in terms of $\\Gamma$, $L$, and $S_P$.", "solution": "The governing equation with constant diffusion coefficient is\n$$\n\\Gamma \\frac{d^{2}\\phi}{dx^{2}} + S_C + S_P \\phi = 0.\n$$\nDiscretize the domain into five equally spaced nodes with spacing $h = \\frac{L}{4}$. Using a finite volume method on a control volume of width $h$ around an internal node $i \\in \\{1,2,3\\}$, integrate the equation over the control volume and approximate face gradients by central differences:\n$$\n\\Gamma \\left[\\left.\\frac{d\\phi}{dx}\\right|_{e} - \\left.\\frac{d\\phi}{dx}\\right|_{w}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\nwith\n$$\n\\left.\\frac{d\\phi}{dx}\\right|_{e} \\approx \\frac{\\phi_{i+1} - \\phi_i}{h}, \\qquad \\left.\\frac{d\\phi}{dx}\\right|_{w} \\approx \\frac{\\phi_i - \\phi_{i-1}}{h}.\n$$\nSubstituting these into the balance gives\n$$\n\\Gamma \\left[\\frac{\\phi_{i+1} - \\phi_i}{h} - \\frac{\\phi_i - \\phi_{i-1}}{h}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\nwhich simplifies to\n$$\n\\frac{\\Gamma}{h}\\phi_{i-1} + \\left(-\\frac{2\\Gamma}{h} + S_P h\\right)\\phi_i + \\frac{\\Gamma}{h}\\phi_{i+1} = - S_C h.\n$$\nRearranging into the standard linear-system form $[A][\\Phi]=[b]$, move neighbor terms to the left-hand side and the constant source and boundary contributions to the right-hand side. The finite-volume coefficients for any internal node are\n$$\na_W = \\frac{\\Gamma}{h}, \\qquad a_E = \\frac{\\Gamma}{h}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h.\n$$\nFor the $3 \\times 3$ matrix acting on $[\\Phi] = (\\phi_1,\\phi_2,\\phi_3)^{T}$, the rows correspond to nodes $i=1,2,3$. For $i=1$, the west neighbor is the boundary node $\\phi_0=\\phi_A$ (moved to the right-hand side), so only $\\phi_1$ and $\\phi_2$ appear on the left. For $i=2$, both neighbors are unknowns. For $i=3$, the east neighbor is the boundary node $\\phi_4=\\phi_B$ (moved to the right-hand side). Substituting $h=\\frac{L}{4}$ gives\n$$\na_W = a_E = \\frac{\\Gamma}{h} = \\frac{4\\Gamma}{L}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h = \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}.\n$$\nTherefore, the coefficient matrix is\n$$\n[A] =\n\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_P L}{4}  -\\frac{4\\Gamma}{L}  0 \\\\\n-\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}  -\\frac{4\\Gamma}{L} \\\\\n0  -\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}  -\\frac{4\\Gamma}{L}  0 \\\\\n-\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}  -\\frac{4\\Gamma}{L} \\\\\n0  -\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}\n\\end{pmatrix}}$$", "id": "1749401"}, {"introduction": "When fluid flow is present, we must account for transport by convection in addition to diffusion, which introduces new numerical challenges. This final exercise explores the convection-diffusion equation and the concept of numerical stability, assessed by the Péclet number, $Pe$. You will apply a hybrid differencing scheme—a practical technique that intelligently switches between different approximations to ensure a physically realistic solution—highlighting how FVM adapts to different flow regimes [@problem_id:1749433].", "problem": "In the study of computational fluid dynamics, hybrid differencing schemes are often employed to discretize the convection-diffusion transport equation for a scalar property $\\phi$. Consider a steady, one-dimensional flow field with a uniform velocity $u$ oriented in the positive $x$-direction. The transport of $\\phi$, which in this case represents a mass fraction (dimensionless), is governed by constant fluid density $\\rho$ and a constant diffusion coefficient $\\Gamma$.\n\nA Finite Volume Method (FVM) grid is established with adjacent computational nodes at locations $P$ and $E$, where $E$ is downstream of $P$. The distance between these nodes is $\\delta x$. The scalar values at the nodes are known to be $\\phi_P$ and $\\phi_E$.\n\nThe total flux (convective plus diffusive) per unit area, $q_e$, at the cell face 'e' located midway between $P$ and $E$, is calculated using a hybrid differencing scheme. This scheme's logic is based on the local cell Péclet number, defined as $Pe = \\frac{\\rho u \\delta x}{\\Gamma}$. The scheme defaults to a stable upwind-differencing approximation for the total flux when the magnitude of the Péclet number is high ($|Pe| \\geq 2$), effectively neglecting the explicit diffusion term under strong convection. For low-Péclet-number-flows ($|Pe|  2$), it uses a more accurate central-differencing approximation for the total flux.\n\nGiven the following parameters:\n- Fluid density, $\\rho = 1.25$ kg/m³\n- Flow velocity, $u = 4.0$ m/s\n- Diffusion coefficient, $\\Gamma = 0.50$ kg/(m·s)\n- Nodal spacing, $\\delta x = 0.25$ m\n- Scalar value at node P, $\\phi_P = 12.0$\n- Scalar value at node E, $\\phi_E = 5.0$\n\nCalculate the total flux of $\\phi$ per unit area, $q_e$, at the cell face 'e'. Express your answer in kg/(m²·s), rounded to three significant figures.", "solution": "The total flux per unit area at face e is the sum of convective and diffusive contributions. In continuous form at the face,\n$$\nq_{e} = \\rho u \\,\\phi\\big|_{e} - \\Gamma \\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{e}.\n$$\nThe hybrid differencing scheme selects between upwind and central differencing based on the local cell Péclet number,\n$$\nPe = \\frac{\\rho u \\,\\delta x}{\\Gamma}.\n$$\nCompute the Péclet number using the given parameters:\n$$\nPe = \\frac{(1.25)\\,(4.0)\\,(0.25)}{0.50} = \\frac{1.25}{0.50} = 2.5.\n$$\nSince $|Pe| = 2.5 \\geq 2$, the scheme uses the stable upwind-differencing approximation for the convective flux. With flow in the positive $x$-direction, the upwind face value is $\\phi_{e} = \\phi_{P}$, so the total flux is approximated by the convective flux only:\n$$\nq_{e} \\approx \\rho u \\,\\phi_{P}.\n$$\nSubstituting the given values,\n$$\nq_{e} = (1.25)\\,(4.0)\\,(12.0) = 5 \\times 12.0 = 60.0.\n$$\nThus, the total flux per unit area is $60.0$ kg/(m$^{2}$·s), rounded to three significant figures.", "answer": "$$\\boxed{60.0}$$", "id": "1749433"}]}