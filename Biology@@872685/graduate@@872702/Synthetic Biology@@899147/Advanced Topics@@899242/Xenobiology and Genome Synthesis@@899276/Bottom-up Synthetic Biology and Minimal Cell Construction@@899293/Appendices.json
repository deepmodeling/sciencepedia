{"hands_on_practices": [{"introduction": "The first challenge in bottom-up synthetic biology is the co-encapsulation of all necessary molecular components into a single chassis, like a lipid vesicle. At this scale, the process is fundamentally stochastic, and this exercise introduces a powerful statistical tool to quantify the probability of successful assembly. By applying the principles of Poisson loading, you will derive an expression for the yield of functional minimal cells, a critical parameter in designing and scaling up production protocols [@problem_id:2717858].", "problem": "You are assembling a bottom-up minimal cell by co-encapsulating $k$ distinct molecular components (for example, an enzyme, a ribosome, a transfer ribonucleic acid (tRNA), and a genome fragment) into giant unilamellar vesicles generated from a well-mixed reservoir. The feed solution contains component $i$ at molar concentration $c_i$ (units $\\mathrm{mol}\\,\\mathrm{L}^{-1}$), and the vesicles have a fixed internal aqueous volume $V$ (units $\\mathrm{L}$). Assume the following foundational facts: (i) molecules are independently and uniformly sampled into each vesicle from the reservoir, (ii) for a given component, the number of molecules encapsulated in a vesicle follows the Poisson limit of independent Bernoulli sampling from a large reservoir, and (iii) different components load independently. Let $N_A$ denote Avogadro’s constant (units $\\mathrm{mol}^{-1}$).\n\nStarting from the binomial model of independent sampling and the definition of molar concentration, derive a closed-form analytical expression for the probability that a randomly formed vesicle contains at least one copy of each of the $k$ distinct components. Your final expression must be written in terms of $V$, $\\{c_i\\}_{i=1}^{k}$, and $N_A$. Express the final probability as a dimensionless quantity. No numerical evaluation or rounding is required.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Number of distinct molecular components: $k$.\n- Molar concentration of component $i$: $c_i$ (units $\\mathrm{mol}\\,\\mathrm{L}^{-1}$).\n- Vesicle internal aqueous volume: $V$ (units $\\mathrm{L}$).\n- Avogadro's constant: $N_A$ (units $\\mathrm{mol}^{-1}$).\n- Assumption (i): Molecules are independently and uniformly sampled into each vesicle from the reservoir.\n- Assumption (ii): For a given component, the number of molecules encapsulated in a vesicle follows the Poisson limit of independent Bernoulli sampling.\n- Assumption (iii): Different components load independently.\n- Objective: Derive a closed-form analytical expression for the probability that a randomly formed vesicle contains at least one copy of each of the $k$ distinct components, in terms of $V$, $\\{c_i\\}_{i=1}^{k}$, and $N_A$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard and fundamental problem in statistical biophysics and synthetic biology, specifically related to the stochastic nature of molecular encapsulation. The assumptions provided are standard for modeling such systems:\n1.  The use of molar concentration $c_i$, volume $V$, and Avogadro's constant $N_A$ is standard chemistry.\n2.  The assumption that the number of encapsulated molecules follows a Poisson distribution is a correct and widely used limit of the binomial distribution for rare events (encapsulating a specific molecule) from a large population (the reservoir). This is physically and mathematically sound.\n3.  The assumption of independent loading for different components is a common starting point for such models and makes the problem tractable.\n\nThe problem contains no scientific fallacies, is not based on subjective claims, and provides all necessary information for a unique solution. The units are consistent. Therefore, the problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. We proceed with the derivation.\n\nThe objective is to find the probability that a vesicle contains at least one molecule of each of the $k$ specified components. Let us denote this probability as $P_{success}$.\n\nWe begin by considering a single molecular component, indexed by $i$. The problem states that the number of molecules of this component within a vesicle follows a Poisson distribution. We must first determine the parameter of this distribution, which is its mean, typically denoted by $\\lambda_i$. The mean, $\\lambda_i$, represents the average number of molecules of component $i$ expected to be found in a vesicle of volume $V$.\n\nThe molar concentration $c_i$ is defined as moles of solute per liter of solution. The number concentration (molecules per liter) is therefore $c_i N_A$. The average number of molecules of component $i$ in a volume $V$ is the product of the number concentration and the volume:\n$$ \\lambda_i = (c_i N_A) V $$\nThe units of this expression are $(\\mathrm{mol} \\cdot \\mathrm{L}^{-1}) \\cdot (\\mathrm{mol}^{-1}) \\cdot (\\mathrm{L})$, which correctly results in a dimensionless quantity representing a count.\n\nLet $n_i$ be the random variable for the number of molecules of component $i$ in a vesicle. According to the problem's assumption, $n_i$ follows a Poisson distribution with mean $\\lambda_i$. The probability mass function is given by:\n$$ P(n_i = m) = \\frac{\\lambda_i^m \\exp(-\\lambda_i)}{m!} $$\nfor $m = 0, 1, 2, \\dots$.\n\nWe are interested in the event that there is *at least one* molecule of component $i$ in the vesicle. This corresponds to the probability $P(n_i \\ge 1)$. It is more direct to calculate the probability of the complementary event, which is finding *zero* molecules of component $i$, or $P(n_i = 0)$.\nUsing the Poisson probability mass function for $m=0$:\n$$ P(n_i = 0) = \\frac{\\lambda_i^0 \\exp(-\\lambda_i)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda_i)}{1} = \\exp(-\\lambda_i) $$\nThe probability of finding at least one molecule is therefore:\n$$ P(n_i \\ge 1) = 1 - P(n_i = 0) = 1 - \\exp(-\\lambda_i) $$\nSubstituting the expression for $\\lambda_i$:\n$$ P(n_i \\ge 1) = 1 - \\exp(-c_i V N_A) $$\n\nThe problem requires finding the probability that a vesicle contains at least one copy of *each* of the $k$ distinct components. Let $E_i$ be the event that a vesicle contains at least one molecule of component $i$. We seek the probability of the joint event $P(E_1 \\cap E_2 \\cap \\dots \\cap E_k)$.\n\nAccording to assumption (iii), the loading of different components is independent. This means that the events $\\{E_i\\}_{i=1}^{k}$ are mutually independent. For independent events, the probability of their intersection is the product of their individual probabilities:\n$$ P_{success} = P(E_1 \\cap E_2 \\cap \\dots \\cap E_k) = \\prod_{i=1}^{k} P(E_i) $$\nSubstituting the expression for $P(E_i) = P(n_i \\ge 1)$ that we derived:\n$$ P_{success} = \\prod_{i=1}^{k} (1 - \\exp(-c_i V N_A)) $$\n\nThis is the final, closed-form analytical expression for the probability that a randomly formed vesicle contains at least one copy of each of the $k$ distinct components. The expression is given in terms of the specified variables $V$, $\\{c_i\\}_{i=1}^{k}$, and $N_A$, and it is dimensionless as required for a probability.", "answer": "$$ \\boxed{\\prod_{i=1}^{k} \\left(1 - \\exp(-c_i V N_A)\\right)} $$", "id": "2717858"}, {"introduction": "Once assembled, a minimal cell must power its internal machinery, with protein synthesis being one of the most energy-demanding processes. This practice guides you through a first-principles derivation of the energetic cost of translation, breaking it down into its constituent $ATP$ and $GTP$ consumption steps. Mastering this calculation provides insight into the fundamental thermodynamic constraints on growth and allows for the estimation of the power required to sustain a synthetic system [@problem_id:2717894].", "problem": "A bottom-up minimal cell in a cell-free transcription–translation system synthesizes a single soluble protein from supplied amino acids and nucleotides. Use the Central Dogma of Molecular Biology and well-established steps of translation to derive the energetic budget in terms of adenosine triphosphate (ATP) and guanosine triphosphate (GTP) consumption.\n\nAssumptions grounded in canonical bacterial-like translation:\n- Aminoacyl–transfer RNA (tRNA) synthetases charge each amino acid onto its cognate tRNA using one molecule of adenosine triphosphate (ATP) with the net reaction consuming two phosphoanhydride bonds because ATP is converted to adenosine monophosphate (AMP) plus pyrophosphate, and inorganic pyrophosphatase drives pyrophosphate hydrolysis.\n- Ribosomal initiation consumes one molecule of guanosine triphosphate (GTP).\n- Each elongation cycle that forms one peptide bond requires two molecules of GTP (one for ternary complex delivery and one for translocation).\n- Ribosomal termination consumes one molecule of GTP.\n- Ignore proofreading beyond the above baseline, amino acid recycling, and any other futile cycles. Assume the effective standard free energy for hydrolysis of a single phosphoanhydride bond of either ATP or GTP under the operating conditions is a constant $\\Delta G_{p}$.\n\nTasks:\n1) For a protein of length $n$ amino acids (so there are $n-1$ peptide bonds), derive the exact ATP and GTP budgets per peptide bond. Report these as symbolic expressions in terms of $n$ that give the number of ATP molecules per peptide bond and the number of GTP molecules per peptide bond.\n\n2) Using your result, compute the steady power required to sustain protein synthesis in a well-mixed vesicle of volume $V$ that produces the protein at a volumetric synthesis rate $\\dot{c}$ (in $\\mathrm{mol}\\ \\mathrm{L}^{-1}\\ \\mathrm{min}^{-1}$). Express your final answer for the power as a single real number in $\\mathrm{W}$.\n\nUse the following numerical values:\n- Protein length $n = 300$.\n- Volume $V = 1.00\\times 10^{-9}\\ \\mathrm{L}$.\n- Volumetric synthesis rate $\\dot{c} = 1.00\\times 10^{-6}\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}\\ \\mathrm{min}^{-1}$.\n- Phosphoanhydride hydrolysis free energy $\\Delta G_{p} = 50.0\\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}$.\n\nRound your final numerical answer for the power to three significant figures. Express the power in watts. Do not report intermediate rounded values; carry symbols through the derivation and substitute numbers only at the end.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extracted Givens.\n- A functional unit is a bottom-up minimal cell in a cell-free transcription-translation system synthesizing a single type of soluble protein.\n- The protein has a length of $n$ amino acids, implying $n-1$ peptide bonds.\n- Energy consumption is based on canonical bacterial-like translation.\n- Charging of each amino acid to its cognate tRNA consumes one molecule of ATP, which is converted to AMP, corresponding to the hydrolysis of two phosphoanhydride bonds.\n- Ribosomal initiation consumes one molecule of GTP.\n- Each peptide bond formation (elongation cycle) consumes two molecules of GTP.\n- Ribosomal termination consumes one molecule of GTP.\n- The standard free energy for the hydrolysis of a single phosphoanhydride bond from either ATP or GTP is constant, denoted by $\\Delta G_{p}$.\n- The following numerical values are provided:\n  - Protein length $n = 300$.\n  - Vesicle volume $V = 1.00 \\times 10^{-9}\\ \\mathrm{L}$.\n  - Volumetric protein synthesis rate $\\dot{c} = 1.00 \\times 10^{-6}\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}\\ \\mathrm{min}^{-1}$.\n  - Phosphoanhydride hydrolysis free energy $\\Delta G_{p} = 50.0 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}$.\n\nStep 2: Validation Using Extracted Givens.\n- **Scientific Grounding**: The problem is grounded in the established principles of molecular biology, specifically the energetics of protein translation. The specified costs in ATP and GTP are standard textbook simplifications for prokaryotic systems.\n- **Well-Posedness**: The problem is well-posed. It clearly defines two tasks: first, to derive symbolic expressions for the energy budget, and second, to calculate a numerical value for power using supplied constants. The information provided is sufficient and consistent for deriving a unique solution.\n- **Objectivity**: The problem is stated in objective, quantitative terms, free of subjective or ambiguous language.\n\nStep 3: Verdict and Action.\nThe problem is deemed **valid**. It is scientifically sound, well-posed, and objective. A solution will be derived.\n\nThe solution proceeds in two parts as requested.\n\nPart 1: Derivation of ATP and GTP Budgets\nLet $N_{ATP}$ and $N_{GTP}$ be the number of ATP and GTP molecules, respectively, consumed to synthesize one protein of length $n$.\n\nThe consumption of ATP occurs during amino acid charging. To synthesize a protein with $n$ amino acids, $n$ amino acids must be activated and charged onto their respective tRNAs. According to the stated assumption, each charging event consumes one molecule of ATP.\n$$N_{ATP} = n$$\n\nThe consumption of GTP occurs during initiation, elongation, and termination.\n- Initiation requires $1$ molecule of GTP.\n- Elongation involves the formation of $n-1$ peptide bonds. Each elongation cycle consumes $2$ molecules of GTP. The total for elongation is $2(n-1)$ molecules of GTP.\n- Termination requires $1$ molecule of GTP.\n\nSumming these contributions gives the total number of GTP molecules consumed:\n$$N_{GTP} = 1 + 2(n-1) + 1 = 1 + 2n - 2 + 1 = 2n$$\n\nThe problem asks for the budget per peptide bond. The number of peptide bonds in a protein of length $n$ is $n-1$.\n\nThe number of ATP molecules per peptide bond is:\n$$\\frac{N_{ATP}}{n-1} = \\frac{n}{n-1}$$\n\nThe number of GTP molecules per peptide bond is:\n$$\\frac{N_{GTP}}{n-1} = \\frac{2n}{n-1}$$\nThese are the symbolic expressions for the budgets per peptide bond, as required by the first task.\n\nPart 2: Calculation of Power\nPower $P$ is the rate of energy consumption, given by $\\frac{dE}{dt}$. To find the power, we first determine the total energy consumed per protein synthesized and then multiply by the rate of protein synthesis.\n\nThe total energy cost is determined by the total number of high-energy phosphoanhydride bonds hydrolyzed.\n- Each of the $n$ ATP molecules is hydrolyzed to AMP, which is explicitly stated to be equivalent to the hydrolysis of $2$ phosphoanhydride bonds. Total bonds from ATP: $2n$.\n- Each of the $N_{GTP} = 2n$ GTP molecules is hydrolyzed to GDP, which corresponds to the hydrolysis of $1$ phosphoanhydride bond. Total bonds from GTP: $2n$.\n\nThe total number of phosphoanhydride bonds, $N_{bonds}$, hydrolyzed per protein molecule synthesized is:\n$$N_{bonds} = 2n + 2n = 4n$$\nGiven $\\Delta G_{p}$ as the free energy change per mole of bonds hydrolyzed, the total energy consumed per mole of protein synthesized, $\\Delta G_{protein}$, is:\n$$\\Delta G_{protein} = N_{bonds} \\times \\Delta G_{p} = 4n \\Delta G_{p}$$\nThe rate of protein synthesis must be expressed in units of $\\mathrm{mol}\\ \\mathrm{s}^{-1}$. The given volumetric rate is $\\dot{c}$ in $\\mathrm{mol}\\ \\mathrm{L}^{-1}\\ \\mathrm{min}^{-1}$. The total rate of synthesis within the vesicle of volume $V$, which we denote $\\dot{N}_{protein}$, is $\\dot{c} \\times V$.\n$$\\dot{N}_{protein} = \\dot{c} V$$\nThe units of this rate are $(\\mathrm{mol}\\ \\mathrm{L}^{-1}\\ \\mathrm{min}^{-1}) \\times \\mathrm{L} = \\mathrm{mol}\\ \\mathrm{min}^{-1}$. To convert to $\\mathrm{mol}\\ \\mathrm{s}^{-1}$, we divide by $60\\ \\mathrm{s}\\ \\mathrm{min}^{-1}$.\n$$\\dot{N}_{protein} (\\mathrm{mol}\\ \\mathrm{s}^{-1}) = \\frac{\\dot{c} V}{60}$$\nThe power $P$ is the product of the energy per mole of protein and the molar rate of synthesis.\n$$P = \\Delta G_{protein} \\times \\dot{N}_{protein} (\\mathrm{mol}\\ \\mathrm{s}^{-1})$$\n$$P = (4n \\Delta G_{p}) \\times \\left(\\frac{\\dot{c} V}{60}\\right)$$\nThis expression gives the power in units of $(\\mathrm{J}\\ \\mathrm{mol}^{-1}) \\times (\\mathrm{mol}\\ \\mathrm{s}^{-1}) = \\mathrm{J}\\ \\mathrm{s}^{-1} = \\mathrm{W}$. We now substitute the given numerical values:\n- $n = 300$\n- $\\Delta G_{p} = 50.0 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}$\n- $\\dot{c} = 1.00 \\times 10^{-6}\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}\\ \\mathrm{min}^{-1}$\n- $V = 1.00 \\times 10^{-9}\\ \\mathrm{L}$\n\n$$P = \\frac{4 \\times 300 \\times (50.0 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}) \\times (1.00 \\times 10^{-6}\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}\\ \\mathrm{min}^{-1}) \\times (1.00 \\times 10^{-9}\\ \\mathrm{L})}{60\\ \\mathrm{s}\\ \\mathrm{min}^{-1}}$$\n$$P = \\frac{(1200) \\times (50.0 \\times 10^{3}) \\times (1.00 \\times 10^{-6}) \\times (1.00 \\times 10^{-9})}{60}\\ \\mathrm{W}$$\n$$P = \\frac{(6.00 \\times 10^{4} \\times 10^{3}) \\times (1.00 \\times 10^{-15})}{60}\\ \\mathrm{W}$$\n$$P = \\frac{6.00 \\times 10^{7} \\times 1.00 \\times 10^{-15}}{60}\\ \\mathrm{W}$$\n$$P = \\frac{6.00 \\times 10^{-8}}{60}\\ \\mathrm{W}$$\n$$P = 0.100 \\times 10^{-8}\\ \\mathrm{W}$$\n$$P = 1.00 \\times 10^{-9}\\ \\mathrm{W}$$\nThe final answer for the power, rounded to three significant figures, is $1.00 \\times 10^{-9}$ watts.", "answer": "$$\\boxed{1.00 \\times 10^{-9}}$$", "id": "2717894"}, {"introduction": "To achieve complex functions, individual reactions within a minimal cell must operate as a coherent network. Flux Balance Analysis (FBA) is a cornerstone of systems biology for analyzing metabolic networks at steady state, and this practice provides a hands-on introduction to this powerful technique. You will construct a stoichiometric model for a hypothetical minimal metabolism and use it to formulate and solve a linear programming problem that optimizes for a biological objective, simulating a real-world design task in synthetic biology [@problem_id:2717904].", "problem": "Consider a bottom-up synthetic metabolism for a minimal cell in which internal metabolites are limited to a nutrient pool $N$, an energy currency $A$ (adenosine triphosphate), and a biomass precursor $P$. External nutrient is denoted $N_{\\text{ext}}$ and is not tracked as an internal metabolite. The reaction network is defined by the following five irreversible reactions (all fluxes are nonnegative):\n\n- Reaction $v_1$: $N_{\\text{ext}} \\rightarrow N$.\n- Reaction $v_2$: $N \\rightarrow A$.\n- Reaction $v_3$: $N + A \\rightarrow P$.\n- Reaction $v_4$: $P + A \\rightarrow \\text{Biomass}$ (a sink reaction).\n- Reaction $v_5$: $A \\rightarrow \\text{ADP}$ (non-growth-associated adenosine triphosphate maintenance).\n\nYour tasks are as follows, starting only from mass conservation and steady state as the fundamental base:\n\n1) Construct the stoichiometric matrix $S$ for the internal metabolites ordered as $(N, A, P)$ and reactions ordered as $(v_1, v_2, v_3, v_4, v_5)$ by assigning each column to a reaction’s stoichiometric changes on $(N, A, P)$.\n\n2) Using conservation of mass and the steady-state assumption, derive the steady-state condition $S\\,v = 0$ for the internal metabolites, where $v \\in \\mathbb{R}^5$ is the vector of reaction fluxes.\n\n3) Formulate a Flux Balance Analysis (FBA) linear program to maximize the biomass production flux. Use the objective to maximize $v_4$ subject to:\n- The steady-state mass-balance constraints $S\\,v = 0$.\n- Irreversibility and capacity constraints $0 \\le v_i \\le u_i$ for $i \\in \\{1,2,3,4,5\\}$, except for the maintenance constraint which imposes a lower bound $v_5 \\ge m$ as well as the upper bound $v_5 \\le u_5$.\n\n4) Implement a program that solves this linear program for each test case below and returns the optimal biomass flux $v_4^\\star$ as a float for each case. If the linear program is feasible, report the optimal value of $v_4$; if it is infeasible, report the float $-1.0$.\n\nPhysical interpretation and units: All fluxes are to be interpreted as reaction rates in millimoles per gram dry weight per hour (mmol gDW$^{-1}$ h$^{-1}$). In your program’s output, express each optimal value numerically as a decimal float with exactly six digits after the decimal point (do not print units).\n\nTest suite (capacity parameters for each case):\n- Case A: $(u_1,u_2,u_3,u_4,u_5,m) = (10, 10, 100, 100, 100, 1)$.\n- Case B: $(u_1,u_2,u_3,u_4,u_5,m) = (100, 5, 100, 100, 100, 1)$.\n- Case C: $(u_1,u_2,u_3,u_4,u_5,m) = (2, 2, 100, 100, 100, 2)$.\n- Case D: $(u_1,u_2,u_3,u_4,u_5,m) = (100, 100, 1.5, 100, 100, 0.5)$.\n- Case E: $(u_1,u_2,u_3,u_4,u_5,m) = (100, 100, 100, 1.234567, 100, 0.123456)$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[x,y,z]\"), in the same order as the test cases above. Each entry must be printed with exactly six digits after the decimal point. The entries must correspond to the optimal biomass flux $v_4^\\star$ for each test case, with $-1.000000$ used only if the optimization problem is infeasible.", "solution": "The problem statement has been analyzed and is found to be valid. It is a well-posed problem in metabolic modeling, based on established principles of mass conservation and steady-state analysis, and is free of scientific inaccuracies or logical contradictions. We now proceed with the solution.\n\nThe problem requires a systematic derivation and solution for a Flux Balance Analysis (FBA) model of a minimal synthetic metabolism. This will be addressed in three parts: construction of the stoichiometric matrix, derivation of the steady-state condition, and formulation of the linear programming problem to maximize biomass.\n\n**1. Construction of the Stoichiometric Matrix $S$**\n\nThe stoichiometric matrix, denoted by $S$, represents the quantitative relationships between metabolites and reactions in a biochemical network. The dimensions of $S$ are $m \\times n$, where $m$ is the number of internal metabolites and $n$ is the number of reactions. For this system, we have $m=3$ internal metabolites, ordered as $(N, A, P)$, and $n=5$ reactions, with fluxes ordered as $(v_1, v_2, v_3, v_4, v_5)$. The entry $S_{ij}$ of the matrix is the stoichiometric coefficient of metabolite $i$ in reaction $j$. By convention, coefficients are negative for reactants and positive for products.\n\nWe construct the matrix column by column, where each column corresponds to a reaction vector.\n\n- **Reaction $v_1$:** $N_{\\text{ext}} \\rightarrow N$. This reaction produces one molecule of $N$. The change in metabolite counts is $(+1, 0, 0)$. The first column of $S$ is $\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n\n- **Reaction $v_2$:** $N \\rightarrow A$. This reaction consumes one molecule of $N$ and produces one molecule of $A$. The change is $(-1, +1, 0)$. The second column of $S$ is $\\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$.\n\n- **Reaction $v_3$:** $N + A \\rightarrow P$. This reaction consumes one molecule of $N$ and one molecule of $A$ to produce one molecule of $P$. The change is $(-1, -1, +1)$. The third column of $S$ is $\\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\end{pmatrix}$.\n\n- **Reaction $v_4$:** $P + A \\rightarrow \\text{Biomass}$. This sink reaction consumes one molecule of $P$ and one molecule of $A$. The change is $(0, -1, -1)$. The fourth column of $S$ is $\\begin{pmatrix} 0 \\\\ -1 \\\\ -1 \\end{pmatrix}$.\n\n- **Reaction $v_5$:** $A \\rightarrow \\text{ADP}$. This non-growth-associated maintenance reaction consumes one molecule of $A$. The change is $(0, -1, 0)$. The fifth column of $S$ is $\\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\end{pmatrix}$.\n\nAssembling these columns creates the complete $3 \\times 5$ stoichiometric matrix $S$:\n$$\nS = \\begin{pmatrix}\n1  -1  -1  0  0 \\\\\n0  1  -1  -1  -1 \\\\\n0  0  1  -1  0\n\\end{pmatrix}\n$$\n\n**2. Derivation of the Steady-State Condition**\n\nThe principle of mass conservation dictates that the rate of change of the concentration of any metabolite is the sum of the rates of all reactions that produce it, minus the sum of the rates of all reactions that consume it. Let $\\mathbf{c} = [N, A, P]^T$ be the vector of internal metabolite concentrations and $\\mathbf{v} = [v_1, v_2, v_3, v_4, v_5]^T$ be the vector of reaction fluxes. The dynamics of the system are described by the following system of ordinary differential equations:\n$$\n\\frac{d\\mathbf{c}}{dt} = S \\mathbf{v}\n$$\nThe steady-state assumption posits that the concentrations of internal metabolites do not change over time. This is a common and powerful simplification in metabolic modeling, assuming that the cell's internal environment reaches equilibrium much faster than the rate of cell growth or environmental change. Mathematically, this assumption is expressed as:\n$$\n\\frac{d\\mathbf{c}}{dt} = \\mathbf{0}\n$$\nwhere $\\mathbf{0}$ is the zero vector of appropriate dimension (in this case, $\\mathbf{0} \\in \\mathbb{R}^3$). By substituting this into the dynamic equation, we arrive at the fundamental steady-state mass-balance constraint for FBA:\n$$\nS \\mathbf{v} = \\mathbf{0}\n$$\nThis is a system of linear equations that constrains the possible values of the flux vector $\\mathbf{v}$ at steady state.\n\n**3. Formulation of the Flux Balance Analysis (FBA) Linear Program**\n\nFBA frames the problem of finding a feasible flux distribution that optimizes a specific cellular objective as a linear program (LP). Here, the objective is to maximize the biomass production flux, $v_4$.\n\nThe LP is formulated as follows:\n\n**Objective Function:**\nMaximize $v_4$. This is equivalent to maximizing the linear function $f(\\mathbf{v}) = \\mathbf{c}_{obj}^T \\mathbf{v}$, where $\\mathbf{c}_{obj} = [0, 0, 0, 1, 0]^T$.\n\n**Constraints:**\n1.  **Steady-State Mass Balance:** The flux vector $\\mathbf{v}$ must satisfy the steady-state condition derived previously.\n    $$S \\mathbf{v} = \\mathbf{0}$$\n    This expands to the following system of three linear equations:\n    - For metabolite $N$: $v_1 - v_2 - v_3 = 0$\n    - For metabolite $A$: $v_2 - v_3 - v_4 - v_5 = 0$\n    - For metabolite $P$: $v_3 - v_4 = 0$\n\n2.  **Flux Bounds and Irreversibility:** All reactions are defined as irreversible, meaning their fluxes must be non-negative ($v_i \\ge 0$). Additionally, each flux $v_i$ is limited by an upper capacity constraint $u_i$. The maintenance flux $v_5$ has a specific lower bound $m$ which represents the minimum energy expenditure required for cellular functions not associated with growth.\n    - $0 \\le v_1 \\le u_1$\n    - $0 \\le v_2 \\le u_2$\n    - $0 \\le v_3 \\le u_3$\n    - $0 \\le v_4 \\le u_4$\n    - $m \\le v_5 \\le u_5$\n\nStandard LP solvers typically solve minimization problems. To use such a solver, we re-frame our maximization problem as a minimization problem by negating the objective function.\n\n**Standard LP Formulation (for minimization):**\n\nMinimize: $-v_4$ (or $\\mathbf{c}^T \\mathbf{v}$ with $\\mathbf{c} = [0, 0, 0, -1, 0]^T$)\n\nSubject to:\n- Equality constraints: $A_{eq} \\mathbf{v} = \\mathbf{b}_{eq}$, where $A_{eq} = S$ and $\\mathbf{b}_{eq} = [0, 0, 0]^T$.\n- Bound constraints: $\\mathbf{v}_{lb} \\le \\mathbf{v} \\le \\mathbf{v}_{ub}$, where\n  - $\\mathbf{v}_{lb} = [0, 0, 0, 0, m]^T$\n  - $\\mathbf{v}_{ub} = [u_1, u_2, u_3, u_4, u_5]^T$\n\nThis fully specified LP can be solved using standard numerical optimization software to find the optimal flux vector $\\mathbf{v}^\\star$ and the corresponding maximum biomass flux $v_4^\\star$. If the constraints are inconsistent (e.g., if $m > u_5$, or if the nutrient uptake limits $u_1, u_2$ are insufficient to support the maintenance flux $m$), the LP will be infeasible.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the Flux Balance Analysis (FBA) linear program for a minimal\n    cell model under different parameter sets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains parameters (u1, u2, u3, u4, u5, m).\n    test_cases = [\n        (10, 10, 100, 100, 100, 1),\n        (100, 5, 100, 100, 100, 1),\n        (2, 2, 100, 100, 100, 2),\n        (100, 100, 1.5, 100, 100, 0.5),\n        (100, 100, 100, 1.234567, 100, 0.123456),\n    ]\n\n    # Objective function: Minimize -v4 to maximize v4.\n    # The flux vector v is [v1, v2, v3, v4, v5].\n    c_obj = np.array([0, 0, 0, -1, 0])\n\n    # Stoichiometric matrix S, used for equality constraints S*v = 0.\n    # Rows correspond to metabolites (N, A, P).\n    # Columns correspond to reactions (v1, v2, v3, v4, v5).\n    S_matrix = np.array([\n        [1, -1, -1, 0, 0],  # dN/dt = v1 - v2 - v3\n        [0, 1, -1, -1, -1], # dA/dt = v2 - v3 - v4 - v5\n        [0, 0, 1, -1, 0]    # dP/dt = v3 - v4\n    ])\n\n    # Right-hand side of the equality constraints, which is the zero vector.\n    b_eq = np.array([0, 0, 0])\n\n    results = []\n    for case in test_cases:\n        u1, u2, u3, u4, u5, m = case\n\n        # Define the bounds for each flux variable for the current case.\n        # Format is a list of (lower_bound, upper_bound) tuples.\n        flux_bounds = [\n            (0, u1),          # 0 = v1 = u1\n            (0, u2),          # 0 = v2 = u2\n            (0, u3),          # 0 = v3 = u3\n            (0, u4),          # 0 = v4 = u4\n            (m, u5)           # m = v5 = u5\n        ]\n\n        # Solve the linear program using the 'highs' solver, which is robust.\n        res = linprog(c=c_obj, \n                      A_eq=S_matrix, \n                      b_eq=b_eq, \n                      bounds=flux_bounds, \n                      method='highs')\n\n        # Check if the optimization was successful.\n        # res.success is True if an optimal solution was found.\n        if res.success:\n            # The objective was to minimize -v4, so the maximum v4 is -res.fun.\n            # The solver should respect bounds, making v4 non-negative.\n            # A small tolerance check is added for robustness against\n            # floating point noise around zero.\n            optimal_v4 = -res.fun\n            if optimal_v4  1e-9:\n                optimal_v4 = 0.0\n            results.append(optimal_v4)\n        else:\n            # If res.success is False, the problem is likely infeasible\n            # (or another issue occurred). As per the problem statement,\n            # report -1.0 for an infeasible problem.\n            results.append(-1.0)\n\n    # Format the results into the required single-line string format.\n    # Each result is formatted as a float with exactly six decimal places.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2717904"}]}