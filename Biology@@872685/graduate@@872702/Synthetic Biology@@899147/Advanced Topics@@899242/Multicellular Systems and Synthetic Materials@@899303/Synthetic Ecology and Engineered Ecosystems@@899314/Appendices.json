{"hands_on_practices": [{"introduction": "Competition for shared resources is a fundamental interaction shaping the structure of any ecosystem. This exercise provides practice in applying one of the most powerful predictive frameworks in microbial ecology, the $R^{\\ast}$ theory, to a controlled chemostat environment. By calculating the break-even resource concentration ($R^{\\ast}$) for two competing engineered strains based on their specific Monod growth kinetics, including maintenance energy costs, you will determine the winner of the competition. This practice is invaluable for learning how to translate fundamental kinetic parameters like $\\mu_{\\max}$, $K_{S}$, and $m$ into a direct prediction of ecological success or failure. [@problem_id:2779692]", "problem": "In a continuous stirred-tank bioreactor (chemostat) of constant volume operated at constant dilution rate, two engineered bacterial strains compete for a single limiting substrate supplied at a fixed influent concentration. Each strain follows Monod kinetics with an explicit maintenance term in its net growth rate. Let the substrate concentration be denoted by $S$ and the dilution rate by $D$. For strain $i \\in \\{A,B\\}$, the specific growth rate is $\\mu_{i}(S) = \\mu_{i,\\max}\\,\\dfrac{S}{K_{i} + S}$ and the net growth rate is $\\mu_{i}(S) - m_{i}$, where $\\mu_{i,\\max}$ is the maximum specific growth rate, $K_{i}$ is the half-saturation constant, and $m_{i}$ is the maintenance (endogenous loss) rate. The biomass dynamics for each strain in the chemostat are governed by the standard mass balance for a well-mixed flow-through reactor. The influent substrate concentration is $S_{\\mathrm{in}}$.\n\nYou are given the following parameters (all rates in $\\mathrm{h}^{-1}$ and all concentrations in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$):\n- Dilution rate: $D = 0.18$.\n- Influent substrate concentration: $S_{\\mathrm{in}} = 12$.\n- Strain $A$: $\\mu_{A,\\max} = 0.62$, $K_{A} = 0.015$, $m_{A} = 0.03$.\n- Strain $B$: $\\mu_{B,\\max} = 0.44$, $K_{B} = 0.004$, $m_{B} = 0.01$.\n\nStarting from the chemostat mass-balance principle and the definition of zero net growth at steady state for a persisting population, derive the resource requirement $R_{i}^{\\ast}$ for each strain $i$ as the substrate concentration at which its net growth rate exactly balances the dilution loss. Evaluate $R_{A}^{\\ast}$ and $R_{B}^{\\ast}$ using the provided parameters. Assuming competitive exclusion on a single limiting resource and that $S_{\\mathrm{in}}$ permits persistence of at least one strain, determine the unique steady-state substrate concentration $S^{\\ast}$ that the chemostat will converge to under long-term competition between these two strains.\n\nExpress your final answer as the numerical value of $S^{\\ast}$ in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$, rounded to four significant figures.", "solution": "The problem presented is scientifically grounded, well-posed, and free of contradictions. All necessary parameters are provided to determine the outcome of competition between two microbial strains in a chemostat for a single limiting resource. The framework relies on established principles of microbial ecology and bioreactor engineering, specifically the Monod growth model and the theory of resource competition ($R^{\\ast}$-theory). Therefore, the problem is valid, and a rigorous solution can be derived.\n\nThe dynamics of a microbial population with biomass concentration $X_i$ in a chemostat with dilution rate $D$ are described by the mass balance equation:\n$$\n\\frac{dX_i}{dt} = (\\text{net specific growth rate}) \\cdot X_i - (\\text{dilution rate}) \\cdot X_i\n$$\nThe problem specifies that the net specific growth rate for strain $i$ is its specific growth rate $\\mu_i(S)$ minus a maintenance term $m_i$. Thus, the biomass dynamics for strain $i \\in \\{A, B\\}$ are given by:\n$$\n\\frac{dX_i}{dt} = (\\mu_i(S) - m_i - D) X_i\n$$\nwhere $S$ is the concentration of the limiting substrate.\n\nFor a strain to persist in the chemostat at a non-trivial steady state (i.e., $X_i^{\\ast}  0$), its population must not be washed out. This requires that the rate of change of its biomass is zero, $\\frac{dX_i}{dt} = 0$. Since $X_i^{\\ast}  0$, this implies that the term in the parenthesis must be zero:\n$$\n\\mu_i(S^{\\ast}) - m_i - D = 0\n$$\nThis equation defines the steady-state substrate concentration, $S^{\\ast}$, that a single strain would maintain in the chemostat if it were growing in monoculture. This concentration is the strain's resource requirement, denoted as $R_i^{\\ast}$. The definition of $R_i^{\\ast}$ is therefore the substrate concentration $S$ that satisfies:\n$$\n\\mu_i(R_i^{\\ast}) = D + m_i\n$$\nThe specific growth rate $\\mu_i(S)$ is given by the Monod equation: $\\mu_i(S) = \\mu_{i,\\max} \\frac{S}{K_i + S}$. Substituting this into the steady-state condition gives:\n$$\n\\mu_{i,\\max} \\frac{R_i^{\\ast}}{K_i + R_i^{\\ast}} = D + m_i\n$$\nTo solve for $R_i^{\\ast}$, we perform algebraic manipulation:\n$$\n\\frac{R_i^{\\ast}}{K_i + R_i^{\\ast}} = \\frac{D + m_i}{\\mu_{i,\\max}}\n$$\n$$\n\\mu_{i,\\max} R_i^{\\ast} = (D + m_i)(K_i + R_i^{\\ast})\n$$\n$$\n\\mu_{i,\\max} R_i^{\\ast} = (D + m_i)K_i + (D + m_i)R_i^{\\ast}\n$$\n$$\nR_i^{\\ast} (\\mu_{i,\\max} - (D + m_i)) = (D + m_i)K_i\n$$\nThis yields the explicit expression for the resource requirement $R_i^{\\ast}$:\n$$\nR_i^{\\ast} = \\frac{(D + m_i)K_i}{\\mu_{i,\\max} - D - m_i}\n$$\nFor a population to be able to persist at dilution rate $D$, its maximum net growth rate must exceed $D$, i.e., $\\mu_{i,\\max} - m_i  D$, which ensures the denominator is positive.\n\nWe now evaluate $R_A^{\\ast}$ and $R_B^{\\ast}$ using the provided parameters:\n$D = 0.18\\,\\mathrm{h}^{-1}$, $S_{\\mathrm{in}} = 12\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$.\nFor Strain A: $\\mu_{A,\\max} = 0.62\\,\\mathrm{h}^{-1}$, $K_{A} = 0.015\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$, $m_{A} = 0.03\\,\\mathrm{h}^{-1}$.\n$$\nR_A^{\\ast} = \\frac{(0.18 + 0.03) \\cdot 0.015}{0.62 - 0.18 - 0.03} = \\frac{0.21 \\cdot 0.015}{0.41} = \\frac{0.00315}{0.41} \\approx 0.0076829\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\nFor Strain B: $\\mu_{B,\\max} = 0.44\\,\\mathrm{h}^{-1}$, $K_{B} = 0.004\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$, $m_{B} = 0.01\\,\\mathrm{h}^{-1}$.\n$$\nR_B^{\\ast} = \\frac{(0.18 + 0.01) \\cdot 0.004}{0.44 - 0.18 - 0.01} = \\frac{0.19 \\cdot 0.004}{0.25} = \\frac{0.00076}{0.25} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\nThe principle of competitive exclusion ($R^{\\ast}$-theory) states that when two or more species compete for a single limiting resource, the species that can survive at, and therefore reduce the resource to, the lowest concentration will competitively exclude all other species. The winning competitor is the one with the minimum $R^{\\ast}$ value.\n\nComparing the two resource requirements:\n$$\nR_B^{\\ast} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1} \\quad  \\quad R_A^{\\ast} \\approx 0.00768\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\nSince $R_B^{\\ast}  R_A^{\\ast}$, Strain B is the superior competitor. Under long-term competition in the chemostat, Strain B will outcompete Strain A. The population of Strain B will grow, consuming the substrate until the substrate concentration is driven down to its own break-even level, $R_B^{\\ast}$. At this substrate level, the net growth rate of Strain B balances its washout rate. For Strain A, because the substrate concentration $R_B^{\\ast}$ is below its own break-even requirement $R_A^{\\ast}$, its net growth rate will be negative ($\\mu_A(R_B^{\\ast}) - m_A - D  0$), and it will be washed out of the system.\n\nTherefore, the unique steady-state substrate concentration $S^{\\ast}$ in the chemostat with both strains present will be determined by the winning competitor, Strain B.\n$$\nS^{\\ast} = R_B^{\\ast} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$\nThe problem specifies that $S_{\\mathrm{in}}$ is sufficient for persistence, which is confirmed as $S^{\\ast} = 0.00304\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}  S_{\\mathrm{in}} = 12\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}$.\n\nThe final answer must be rounded to four significant figures. The calculated value is $0.00304$. To express this with four significant figures, we add a trailing zero.\n$$\nS^{\\ast} = 0.003040\\,\\mathrm{mg}\\,\\mathrm{L}^{-1}\n$$", "answer": "$$\n\\boxed{0.003040}\n$$", "id": "2779692"}, {"introduction": "Beyond competition, engineered mutualisms can generate complex and highly nonlinear system behaviors. This problem explores an obligate mutualism where two species depend on each other for survival, a scenario that can lead to bistability—the existence of multiple stable states. You will use the tools of nonlinear dynamics to derive the system's nullclines and perform a bifurcation analysis to find the critical mutualism strength $m_c$ required to establish a stable coexistence equilibrium. Mastering this type of analysis is crucial for designing robust synthetic ecosystems and understanding their potential for sudden, irreversible state shifts. [@problem_id:2779463]", "problem": "An engineered two-species obligate mutualism is implemented by reciprocal cross-feeding in a well-mixed chemostat-like environment where each species requires an essential metabolite produced by its partner. Assume that in the absence of mutualistic benefit each species experiences net per-capita decline, that intraspecific crowding imposes a linear density-dependent penalty, and that mutualistic benefit saturates with partner abundance due to transporter saturation. Let $x(t)$ and $y(t)$ denote the population densities of the two engineered strains at time $t$. The dynamics are modeled by\n$$\n\\frac{dx}{dt} \\;=\\; x\\left(-d_x \\;+\\; \\frac{m_x\\,y}{h_x + y} \\;-\\; c_x\\,x\\right),\\qquad\n\\frac{dy}{dt} \\;=\\; y\\left(-d_y \\;+\\; \\frac{m_y\\,x}{h_y + x} \\;-\\; c_y\\,y\\right),\n$$\nwith parameters $d_x,d_y0$ (net per-capita loss in the absence of mutualism), $c_x,c_y0$ (intraspecific crowding coefficients), $m_x,m_y0$ (maximal mutualistic benefit strengths), and $h_x,h_y0$ (half-saturation constants).\n\nStarting only from mass balance, density-dependent self-limitation, and saturating uptake as fundamental bases, do the following:\n\na) Derive the $x$-nullcline and the $y$-nullcline in the positive quadrant. Describe qualitatively their shapes and threshold behavior with respect to the partner’s density.\n\nb) Analyze the local stability of the extinction equilibrium at $(x,y)=(0,0)$ by linearization.\n\nc) Impose symmetric engineering ($d_x=d_y=d0$, $c_x=c_y=c0$, $m_x=m_y=m0$, $h_x=h_y=h0$), and focus on symmetric coexistence equilibria of the form $(x,y)=(z,z)$ with $z0$. By enforcing the condition for a saddle-node bifurcation of symmetric equilibria, determine the critical mutualism strength $m_c$ at which a pair of nontrivial symmetric equilibria is created. Using this, specify the parameter range in $m$ for which the system exhibits two stable equilibria (the extinction equilibrium and a positive coexistence equilibrium) separated by an unstable saddle. Your final reported result should be the closed-form analytic expression for $m_c$ in terms of $c$, $h$, and $d$. Do not include units in your final answer.", "solution": "The problem as stated is scientifically sound, mathematically well-posed, objective, and self-contained. It is a standard problem in theoretical ecology and synthetic biology, suitable for analysis using nonlinear dynamics. All parameters are clearly defined, and the premises are based on established modeling principles such as mass-balance, density-dependent limitation, and saturating functional responses. Therefore, a solution will be provided.\n\na) Derivation of nullclines\nThe dynamics of the system are given by:\n$$\n\\frac{dx}{dt} \\;=\\; x\\left(-d_x \\;+\\; \\frac{m_x\\,y}{h_x + y} \\;-\\; c_x\\,x\\right) \\\\\n\\frac{dy}{dt} \\;=\\; y\\left(-d_y \\;+\\; \\frac{m_y\\,x}{h_y + x} \\;-\\; c_y\\,y\\right)\n$$\nThe $x$-nullcline is the set of points $(x,y)$ in the state space for which $\\frac{dx}{dt} = 0$. This condition yields:\n$$\nx\\left(-d_x \\;+\\; \\frac{m_x\\,y}{h_x + y} \\;-\\; c_x\\,x\\right) = 0\n$$\nThis equation is satisfied if $x=0$ (the $y$-axis) or if the term in the parenthesis is zero. The latter gives the nontrivial nullcline:\n$$\n-d_x \\;+\\; \\frac{m_x\\,y}{h_x + y} \\;-\\; c_x\\,x = 0\n$$\nSolving for $x$ as a function of $y$:\n$$\nc_x\\,x = -d_x + \\frac{m_x\\,y}{h_x + y} = \\frac{-d_x(h_x+y) + m_x y}{h_x+y} = \\frac{(m_x - d_x)y - d_x h_x}{h_x+y}\n$$\n$$\nx(y) = \\frac{1}{c_x}\\frac{(m_x - d_x)y - d_x h_x}{h_x+y}\n$$\nFor a biologically meaningful population density, we require $x0$. Since $c_x, h_x, y$ are all positive, this requires the numerator to be positive: $(m_x - d_x)y - d_x h_x  0$.\nIf $m_x \\le d_x$, the numerator is always negative for $y0$, so no positive $x$ values exist on this nullcline. In this case, the per-capita growth rate is always negative.\nIf $m_x  d_x$, a positive $x$ exists only if $y  \\frac{d_x h_x}{m_x - d_x}$. This defines a threshold density of species $y$, call it $y_{th} = \\frac{d_x h_x}{m_x - d_x}$, below which species $x$ cannot survive. The shape of the nullcline $x(y)$ for $y  y_{th}$ is a monotonically increasing function that starts at $x=0$ at $y=y_{th}$ and saturates, approaching a horizontal asymptote as $y \\to \\infty$:\n$$\n\\lim_{y\\to\\infty} x(y) = \\lim_{y\\to\\infty} \\frac{1}{c_x}\\frac{(m_x - d_x)y}{y} = \\frac{m_x - d_x}{c_x}\n$$\nBy symmetry, the $y$-nullcline consists of the line $y=0$ (the $x$-axis) and the curve:\n$$\ny(x) = \\frac{1}{c_y}\\frac{(m_y - d_y)x - d_y h_y}{h_y+x}\n$$\nThis nontrivial nullcline exists in the positive quadrant only if $m_y  d_y$ and for $x  x_{th} = \\frac{d_y h_y}{m_y - d_y}$. It is a monotonically increasing function of $x$ that saturates at $y = \\frac{m_y - d_y}{c_y}$.\n\nb) Stability of the extinction equilibrium\nThe extinction equilibrium is at $(x,y)=(0,0)$. To analyze its local stability, we linearize the system by computing the Jacobian matrix $J(x,y)$.\nLet $F(x,y) = x(-d_x + \\frac{m_x y}{h_x + y} - c_x x)$ and $G(x,y) = y(-d_y + \\frac{m_y x}{h_y + x} - c_y y)$.\nThe partial derivatives are:\n$\\frac{\\partial F}{\\partial x} = -d_x + \\frac{m_x y}{h_x + y} - 2c_x x$\n$\\frac{\\partial F}{\\partial y} = \\frac{m_x x h_x}{(h_x+y)^2}$\n$\\frac{\\partial G}{\\partial x} = \\frac{m_y y h_y}{(h_y+x)^2}$\n$\\frac{\\partial G}{\\partial y} = -d_y + \\frac{m_y x}{h_y + x} - 2c_y y$\nEvaluating the Jacobian at $(x,y)=(0,0)$:\n$$\nJ(0,0) = \\begin{pmatrix} -d_x  0 \\\\ 0  -d_y \\end{pmatrix}\n$$\nThe eigenvalues of this diagonal matrix are its diagonal entries, $\\lambda_1 = -d_x$ and $\\lambda_2 = -d_y$. Given that $d_x0$ and $d_y0$, both eigenvalues are strictly negative. Therefore, the extinction equilibrium $(0,0)$ is a stable node. This is expected for an obligate mutualism, where both species decline to extinction in the absence of their partner.\n\nc) Symmetric case and bifurcation analysis\nUnder symmetric engineering, the parameters are set as $d_x=d_y=d$, $c_x=c_y=c$, $m_x=m_y=m$, and $h_x=h_y=h$. We seek symmetric coexistence equilibria of the form $(x,y)=(z,z)$ with $z0$. Substituting into the governing equations at steady state:\n$$\nz\\left(-d + \\frac{m z}{h + z} - c z\\right) = 0\n$$\nFor a nontrivial equilibrium ($z0$), we must solve:\n$$\n-d + \\frac{m z}{h + z} - c z = 0\n$$\nRearranging this equation gives:\n$$\n\\frac{m z}{h + z} = d + c z \\implies m z = (d+cz)(h+z) = dh + dz + chz + cz^2\n$$\nThis leads to a quadratic equation for $z$:\n$$\ncz^2 + (d+ch-m)z + dh = 0\n$$\nA pair of nontrivial symmetric equilibria is created via a saddle-node bifurcation. This occurs when the two roots of the quadratic equation for $z$ merge into a single real root. This corresponds to the discriminant of the quadratic equation being zero:\n$$\n\\Delta = (d+ch-m)^2 - 4(c)(dh) = 0\n$$\nThis gives $(d+ch-m)^2 = 4cdh$, so $d+ch-m = \\pm 2\\sqrt{cdh}$, which implies $m = d+ch \\pm 2\\sqrt{cdh}$.\nThese expressions can be factored: $m = (\\sqrt{d} \\pm \\sqrt{ch})^2$.\nThe equilibria must be positive ($z0$). The product of the roots is $z_1 z_2 = dh/c  0$, so the roots have the same sign. The sum of the roots is $z_1+z_2 = -(d+ch-m)/c = (m-d-ch)/c$. For the roots to be positive, their sum must be positive, which requires $m  d+ch$.\nOf the two possible values for $m$ from the discriminant condition, only $m = d+ch+2\\sqrt{cdh}$ satisfies $md+ch$. The other value, $m=d+ch-2\\sqrt{cdh}$, leads to a negative sum of roots.\nTherefore, the critical mutualism strength $m_c$ at which a pair of positive symmetric equilibria is created is:\n$$\nm_c = d+ch+2\\sqrt{cdh} = (\\sqrt{d}+\\sqrt{ch})^2\n$$\nFor $m  m_c$, two distinct positive equilibria exist. Let them be $z_1$ and $z_2$, with $0  z_1  z_2$. The stability of these equilibria $(z,z)$ is determined by the eigenvalues of the Jacobian matrix evaluated at $(z,z)$:\n$$\nJ(z,z) = \\begin{pmatrix} -cz  \\frac{mzh}{(h+z)^2} \\\\ \\frac{mzh}{(h+z)^2}  -cz \\end{pmatrix}\n$$\nThe eigenvalues are $\\lambda_{1,2} = -cz \\pm \\frac{mzh}{(h+z)^2}$. Since all parameters and $z$ are positive, the eigenvalue $\\lambda_2 = -cz - \\frac{mzh}{(h+z)^2}$ is always negative. The stability is determined by the sign of $\\lambda_1 = -cz + \\frac{mzh}{(h+z)^2} = z(-c + \\frac{mh}{(h+z)^2})$.\nThe equilibrium is stable if $\\lambda_1  0$, which is equivalent to $c  \\frac{mh}{(h+z)^2}$.\nA graphical analysis or direct evaluation shows that for the smaller root $z_1$, the inequality is reversed ($c  \\frac{mh}{(h+z_1)^2}$), so $\\lambda_10$ and this equilibrium is an unstable saddle. For the larger root $z_2$, the inequality holds ($c  \\frac{mh}{(h+z_2)^2}$), so $\\lambda_10$ and this equilibrium is a stable node.\nThus, for the parameter range $m  m_c$, the system has two stable equilibria: the extinction point $(0,0)$ and the coexistence point $(z_2, z_2)$, separated by the unstable saddle point $(z_1, z_1)$. This is the condition for bistability. The problem asks for the critical value $m_c$ that marks the onset of this regime.\n\nThe expression for $m_c$ is:\n$m_c = (\\sqrt{d}+\\sqrt{ch})^2$", "answer": "$$\n\\boxed{(\\sqrt{d} + \\sqrt{ch})^{2}}\n$$", "id": "2779463"}, {"introduction": "As synthetic ecosystems grow in complexity, moving beyond two-species interactions, analytical solutions become impractical. This exercise transitions from analytical methods to computational analysis, a necessary step for studying larger consortia. Using the generalized Lotka-Volterra (gLV) model, you will develop a program to systematically enumerate all possible equilibria for a three-species community and determine their stability by computing the eigenvalues of the Jacobian matrix. This hands-on computational practice builds essential skills for predicting the behavior and stability of complex, multi-species engineered microbial systems. [@problem_id:2779542]", "problem": "You are given a system of generalized Lotka–Volterra (gLV) population dynamics for a well-mixed engineered microbial consortium of $3$ interacting species. The state vector is $x \\in \\mathbb{R}^3_{\\ge 0}$ with components $x_i$ representing the abundance of species $i$. The dynamics are\n$$\n\\frac{dx_i}{dt} \\;=\\; x_i\\left(r_i + \\sum_{j=1}^{3} A_{ij} x_j\\right), \\quad i \\in \\{1,2,3\\},\n$$\nwhere $r \\in \\mathbb{R}^3$ is the intrinsic growth vector and $A \\in \\mathbb{R}^{3 \\times 3}$ is the interaction matrix. An equilibrium $x^\\ast$ satisfies $x_i^\\ast \\ge 0$ for all $i$ and $x_i^\\ast\\left(r_i + \\sum_{j=1}^{3} A_{ij} x_j^\\ast\\right)=0$ for all $i$. The Jacobian of the vector field at a point $x$ is\n$$\nJ_{ij}(x) \\;=\\; \\frac{\\partial}{\\partial x_j}\\left[x_i\\left(r_i + \\sum_{k=1}^{3} A_{ik} x_k\\right)\\right]\n\\;=\\; \\delta_{ij}\\left(r_i + \\sum_{k=1}^{3} A_{ik} x_k\\right) + x_i A_{ij},\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. An equilibrium $x^\\ast$ is locally asymptotically stable if all eigenvalues of $J(x^\\ast)$ have strictly negative real parts.\n\nYour task is to design a program that, for each parameter set $\\{r, A\\}$ below, does the following from first principles:\n- Enumerate all candidate nonnegative equilibria constructed by considering every subset $S \\subseteq \\{1,2,3\\}$ of species that are present (strictly positive) at equilibrium. For each subset $S$, attempt to solve the linear system\n$$\nA_{SS} x_S \\;=\\; -\\, r_S,\n$$\nwhere $A_{SS}$ is the principal submatrix of $A$ indexed by $S$, $r_S$ is the subvector of $r$ on $S$, and $x_S$ is the subvector of unknowns on $S$. If $S$ is empty, the candidate equilibrium is $x^\\ast = (0,0,0)$. For nonempty $S$, include the equilibrium obtained by setting $x_i^\\ast = 0$ for all $i \\notin S$ and $x_S^\\ast$ equal to the unique solution of the system if and only if the solution exists uniquely and satisfies $x_S^\\ast \\ge 0$ componentwise. If the linear system does not have a unique solution, discard that $S$.\n- For each feasible equilibrium $x^\\ast$ thus found, compute the Jacobian $J(x^\\ast)$ and its eigenvalues numerically, and classify the equilibrium as linearly stable if and only if every eigenvalue has real part strictly less than $0$.\n- Report, for each parameter set, the following three integers:\n    1. The total number of feasible equilibria found (including the all-zero equilibrium if it is feasible by the construction above).\n    2. The number of linearly stable equilibria among the feasible ones.\n    3. An indicator for the interior coexistence equilibrium: output $1$ if there exists a linearly stable equilibrium with all three components strictly positive, and $0$ otherwise.\n\nUse the following numerical conventions to ensure robustness:\n- Treat a candidate solution component $x_i^\\ast$ as zero if $x_i^\\ast \\ge -\\epsilon$ and set it to exactly zero when recorded, where $\\epsilon = 10^{-9}$.\n- Classify linear stability using the strict threshold that all eigenvalues $\\lambda$ of $J(x^\\ast)$ satisfy $\\operatorname{Re}(\\lambda)  -\\epsilon_{\\mathrm{eig}}$ with $\\epsilon_{\\mathrm{eig}} = 10^{-9}$.\n- Only accept equilibria from subsets $S$ for which the linear system has a unique solution (that is, $A_{SS}$ is full rank). Do not include non-unique continua of equilibria.\n\nTest suite (four parameter sets $\\{r, A\\}$):\n- Case $1$ (diagonal self-limitation, no interactions):\n    - $r = [\\,1.0,\\,1.0,\\,1.0\\,]$.\n    - $A = \\begin{bmatrix}\n    -1.0  0.0  0.0\\\\\n    0.0  -1.0  0.0\\\\\n    0.0  0.0  -1.0\n    \\end{bmatrix}$.\n- Case $2$ (symmetric strong competition):\n    - $r = [\\,1.0,\\,1.0,\\,1.0\\,]$.\n    - $A = \\begin{bmatrix}\n    -1.0  -2.0  -2.0\\\\\n    -2.0  -1.0  -2.0\\\\\n    -2.0  -2.0  -1.0\n    \\end{bmatrix}$.\n- Case $3$ (singular fully competitive interactions; no interior coexistence):\n    - $r = [\\,1.0,\\,0.8,\\,0.7\\,]$.\n    - $A = \\begin{bmatrix}\n    -1.0  -1.0  -1.0\\\\\n    -1.0  -1.0  -1.0\\\\\n    -1.0  -1.0  -1.0\n    \\end{bmatrix}$.\n- Case $4$ (weak mutualism with self-limitation; negative definite interactions):\n    - $r = [\\,1.0,\\,0.9,\\,1.1\\,]$.\n    - $A = \\begin{bmatrix}\n    -1.0  0.2  0.2\\\\\n    0.2  -1.0  0.2\\\\\n    0.2  0.2  -1.0\n    \\end{bmatrix}$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of results, one per case, in the same order as listed above. Each case’s result must be a list of three integers $[\\,\\text{n\\_feasible},\\,\\text{n\\_stable},\\,\\text{interior\\_stable}\\,]$. The overall line must be a single outer list with the four inner lists, printed with comma separators and without any extra text. For example, a syntactically valid output looks like\n\"[[a,b,c],[d,e,f],[g,h,i],[j,k,l]]\"\nwith the actual integer values substituted.", "solution": "The problem requires an algorithmic analysis of a generalized Lotka-Volterra (gLV) system for a consortium of $3$ microbial species. The dynamics for the abundance $x_i$ of species $i$ are given by the ordinary differential equation:\n$$\n\\frac{dx_i}{dt} = x_i\\left(r_i + \\sum_{j=1}^{3} A_{ij} x_j\\right), \\quad i \\in \\{1,2,3\\}\n$$\nFor each provided parameter set, comprising a growth vector $r \\in \\mathbb{R}^3$ and an interaction matrix $A \\in \\mathbb{R}^{3 \\times 3}$, we must determine the number of feasible non-negative equilibria, the number of linearly stable equilibria, and an indicator for the existence of a stable interior equilibrium.\n\nThe solution is implemented by following a two-step procedure for each parameter set: first, the enumeration of all feasible equilibria, and second, the linear stability analysis of each found equilibrium.\n\n**Step 1: Enumeration of Feasible Equilibria**\n\nAn equilibrium point $x^\\ast \\in \\mathbb{R}^3_{\\ge 0}$ is a state where the population dynamics cease, i.e., $\\frac{dx_i}{dt} = 0$ for all $i \\in \\{1,2,3\\}$. This condition implies that for each species $i$, either its abundance is zero ($x_i^\\ast=0$), or its specific growth rate is zero ($r_i + \\sum_{j=1}^{3} A_{ij} x_j^\\ast=0$).\n\nWe systematically search for all such equilibria by considering every possible subset of species that could be present (i.e., have non-zero abundance) at equilibrium. Let $S \\subseteq \\{1,2,3\\}$ be the set of indices of species with potentially non-zero abundance. The species with indices not in $S$ are assumed to be absent, so $x_i^\\ast = 0$ for all $i \\notin S$. For the species $i \\in S$, their specific growth rates must be zero. This leads to a system of linear equations for the abundances $x_S^\\ast = (x_i^\\ast)_{i \\in S}$:\n$$\n\\sum_{j \\in S} A_{ij} x_j^\\ast = -r_i, \\quad \\forall i \\in S\n$$\nIn matrix form, this is $A_{SS} x_S^\\ast = -r_S$, where $A_{SS}$ is the principal submatrix of $A$ corresponding to the indices in $S$, and $r_S$ is the corresponding subvector of $r$.\n\nThe algorithm proceeds by iterating through all $2^3 = 8$ subsets $S$ of $\\{1,2,3\\}$:\n1.  For each subset $S$, we construct the sub-system $A_{SS} x_S = -r_S$.\n2.  The case $S=\\emptyset$ corresponds to the trivial equilibrium $x^\\ast=(0,0,0)$, which is always a candidate.\n3.  For non-empty $S$, we first check if the matrix $A_{SS}$ is invertible (i.e., has full rank). If it is singular, no unique solution exists, and this subset $S$ is discarded as per the problem specification.\n4.  If $A_{SS}$ is invertible, we solve the linear system to find a unique candidate solution $x_S^\\ast$.\n5.  The solution is deemed physically feasible only if all its components are non-negative. We use the specified numerical tolerance $\\epsilon = 10^{-9}$, accepting a solution if all its components $x_i^\\ast$ satisfy $x_i^\\ast \\ge -\\epsilon$.\n6.  If the solution is feasible, we construct the full $3$-dimensional equilibrium vector $x^\\ast$ by setting components corresponding to indices in $S$ to the values from $x_S^\\ast$, and all other components to $0$. To ensure that numerically small values are treated as zero and to maintain a canonical representation for each equilibrium, any component $x_i^\\ast$ with a value smaller than $\\epsilon$ (i.e., $x_i^\\ast  \\epsilon$) is clamped to exactly $0.0$.\n7.  The resulting unique equilibrium vectors are stored in a set to avoid duplicates, which can arise when a solution for a set $S$ has zero components, meaning it is also a solution for a proper subset of $S$.\nThe total count of unique vectors in this set gives the number of feasible equilibria, $N_{\\text{feasible}}$.\n\n**Step 2: Linear Stability Analysis**\n\nFor each feasible equilibrium $x^\\ast$ found in Step 1, we assess its local asymptotic stability. This is determined by the eigenvalues of the Jacobian matrix $J(x^\\ast)$ of the system, evaluated at that equilibrium. The formula for the Jacobian entries is given as:\n$$\nJ_{ij}(x^\\ast) = \\delta_{ij}\\left(r_i + \\sum_{k=1}^{3} A_{ik} x_k^\\ast\\right) + x_i^\\ast A_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. The term $\\left(r_i + \\sum_k A_{ik} x_k^\\ast\\right)$ is the specific growth rate of species $i$ at $x^\\ast$. This term is zero if $x_i^\\ast  0$ and is equal to the invasion growth rate if $x_i^\\ast=0$.\n\nThe analysis proceeds as follows:\n1.  For each unique equilibrium $x^\\ast$, we compute the $3 \\times 3$ Jacobian matrix $J(x^\\ast)$.\n2.  We then compute the eigenvalues of $J(x^\\ast)$ numerically.\n3.  An equilibrium is classified as linearly stable if and only if the real parts of all its eigenvalues are strictly negative. Following the problem's numerical convention, this condition is checked as $\\operatorname{Re}(\\lambda)  -\\epsilon_{\\text{eig}}$ for all eigenvalues $\\lambda$, with $\\epsilon_{\\text{eig}} = 10^{-9}$.\n4.  We count the total number of such stable equilibria, $N_{\\text{stable}}$.\n5.  Among the stable equilibria, we check if any represent coexistence of all three species, i.e., $x_i^\\ast  0$ for all $i \\in \\{1,2,3\\}$. Numerically, we test if $x_i^\\ast  \\epsilon$ for all $i$. If such a stable interior equilibrium exists, we set an indicator variable, $I_{\\text{interior\\_stable}}$, to $1$; otherwise, it is $0$.\n\nFinally, for each parameter set, we report the triplet $[N_{\\text{feasible}}, N_{\\text{stable}}, I_{\\text{interior\\_stable}}]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import combinations\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"r\": np.array([1.0, 1.0, 1.0]),\n            \"A\": np.array([\n                [-1.0, 0.0, 0.0],\n                [0.0, -1.0, 0.0],\n                [0.0, 0.0, -1.0]\n            ])\n        },\n        {\n            \"r\": np.array([1.0, 1.0, 1.0]),\n            \"A\": np.array([\n                [-1.0, -2.0, -2.0],\n                [-2.0, -1.0, -2.0],\n                [-2.0, -2.0, -1.0]\n            ])\n        },\n        {\n            \"r\": np.array([1.0, 0.8, 0.7]),\n            \"A\": np.array([\n                [-1.0, -1.0, -1.0],\n                [-1.0, -1.0, -1.0],\n                [-1.0, -1.0, -1.0]\n            ])\n        },\n        {\n            \"r\": np.array([1.0, 0.9, 1.1]),\n            \"A\": np.array([\n                [-1.0, 0.2, 0.2],\n                [0.2, -1.0, 0.2],\n                [0.2, 0.2, -1.0]\n            ])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        r, A = case[\"r\"], case[\"A\"]\n        result = analyze_system(r, A)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_system(r, A):\n    \"\"\"\n    Analyzes a single gLV system for a given r and A.\n    Returns [n_feasible, n_stable, interior_stable].\n    \"\"\"\n    epsilon = 1e-9\n    epsilon_eig = 1e-9\n    num_species = len(r)\n    \n    # --- Step 1: Find all feasible equilibria ---\n    found_equilibria = set()\n    \n    indices = range(num_species)\n    for s_size in range(num_species + 1):\n        for s_indices in combinations(indices, s_size):\n            if not s_indices:\n                # Trivial equilibrium: all species absent\n                found_equilibria.add(tuple([0.0] * num_species))\n                continue\n\n            # Non-trivial case: solve for species in S\n            s_indices_arr = np.array(s_indices)\n            A_ss = A[np.ix_(s_indices_arr, s_indices_arr)]\n            r_s = r[s_indices_arr]\n\n            # Check for unique solution (A_ss must be invertible)\n            if np.linalg.matrix_rank(A_ss)  len(s_indices):\n                continue\n\n            try:\n                x_s = np.linalg.solve(A_ss, -r_s)\n            except np.linalg.LinAlgError:\n                continue\n\n            # Feasibility check: non-negative abundances\n            if np.any(x_s  -epsilon):\n                continue\n            \n            # Construct the full equilibrium vector\n            x_star = np.zeros(num_species)\n            x_star[s_indices_arr] = x_s\n            \n            # Clamp near-zero values for canonical representation\n            x_star[x_star  epsilon] = 0.0\n            \n            found_equilibria.add(tuple(x_star))\n            \n    n_feasible = len(found_equilibria)\n    \n    # --- Step 2: Stability analysis ---\n    n_stable = 0\n    interior_stable = 0\n    \n    for eq_tuple in found_equilibria:\n        x_star = np.array(eq_tuple)\n        \n        # Compute Jacobian matrix J(x*)\n        # J_ij = delta_ij * (r_i + sum_k A_ik * x_k) + x_i * A_ij\n        growth_rates = r + A @ x_star\n        J = np.diag(growth_rates) + np.diag(x_star) @ A\n        \n        # Compute eigenvalues\n        try:\n            eigvals = np.linalg.eigvals(J)\n        except np.linalg.LinAlgError:\n            continue\n        \n        # Check for linear stability\n        if np.all(np.real(eigvals)  -epsilon_eig):\n            is_stable = True\n        else:\n            is_stable = False\n            \n        if is_stable:\n            n_stable += 1\n            # Check if it's a stable interior equilibrium\n            if np.all(x_star > epsilon):\n                interior_stable = 1\n                \n    return [n_feasible, n_stable, interior_stable]\n\nsolve()\n```", "id": "2779542"}]}