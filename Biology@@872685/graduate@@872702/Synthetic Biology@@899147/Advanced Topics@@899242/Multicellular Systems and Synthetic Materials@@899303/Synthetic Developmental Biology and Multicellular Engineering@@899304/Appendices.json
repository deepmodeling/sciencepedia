{"hands_on_practices": [{"introduction": "Morphogen gradients are a cornerstone of developmental patterning, providing spatial information to cells within a tissue. A key question for both natural and synthetic systems is robustness: how does the resulting pattern respond to fluctuations in parameters like morphogen production? This foundational exercise [@problem_id:2779091] walks through a classic reaction-diffusion model to derive an analytical scaling law, revealing how a gene expression boundary shifts in response to changes in morphogen source strength and providing crucial insight for designing predictable multicellular systems.", "problem": "A one-dimensional epithelium occupies the semi-infinite domain $x \\geq 0$. A morphogen is produced at the boundary $x=0$ and diffuses into the tissue with diffusion coefficient $D$ and undergoes first-order degradation with rate constant $k$. At steady state, the morphogen concentration $c(x)$ satisfies the reaction–diffusion partial differential equation (PDE)\n$$\n0 = D \\frac{d^{2} c}{dx^{2}} - k\\, c,\n$$\nfor $x>0$, together with the far-field condition $c(x) \\to 0$ as $x \\to \\infty$. Production at the boundary is modeled as a constant influx with flux $J$, giving the boundary condition $-D \\left.\\frac{dc}{dx}\\right|_{x=0} = J$.\n\nA target gene decodes the morphogen linearly: the gene’s regulatory input is $g(x) = \\alpha\\, c(x) - \\beta$, where $\\alpha>0$ and $\\beta>0$ are constants. The gene is expressed where $g(x) \\geq 0$ and not expressed where $g(x)  0$. The gene expression boundary (GEB) position $x^{\\ast}$ is defined implicitly by $g(x^{\\ast}) = 0$.\n\nSuppose that the morphogen production rate (and thus the influx $J$) is increased by a dimensionless factor $r>0$, with all other parameters unchanged. Let $x^{\\ast}_{0}$ denote the GEB before the change and $x^{\\ast}_{r}$ denote the GEB after the change. Compute the boundary shift $\\Delta x = x^{\\ast}_{r} - x^{\\ast}_{0}$ under these assumptions. Express your final answer as a closed-form analytic expression in terms of $r$, $D$, and $k$ only. Do not include any units in your final answer and do not use numerical approximations.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard model of morphogen gradient formation and interpretation from the field of developmental biology, which is mathematically formalizable and internally consistent. All necessary parameters and conditions are provided to derive a unique solution. Therefore, the problem is valid, and a solution will be derived.\n\nThe problem describes the steady-state concentration $c(x)$ of a morphogen in a one-dimensional semi-infinite domain $x \\ge 0$. The governing equation is a reaction-diffusion equation, which at steady state becomes an ordinary differential equation (ODE):\n$$\nD \\frac{d^{2} c}{dx^{2}} - k c = 0\n$$\nThis can be rewritten as:\n$$\n\\frac{d^{2} c}{dx^{2}} - \\frac{k}{D} c = 0\n$$\nThis is a second-order linear homogeneous ODE with constant coefficients. The characteristic equation is $\\lambda^{2} - \\frac{k}{D} = 0$, which has roots $\\lambda = \\pm\\sqrt{\\frac{k}{D}}$.\nThe general solution is therefore:\n$$\nc(x) = A \\exp\\left(x\\sqrt{\\frac{k}{D}}\\right) + B \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\nThe first boundary condition is the far-field condition, $c(x) \\to 0$ as $x \\to \\infty$. The term $A \\exp\\left(x\\sqrt{\\frac{k}{D}}\\right)$ grows without bound as $x \\to \\infty$ (since $k>0$ and $D>0$). To satisfy the condition, we must set its coefficient $A = 0$. The solution is thus simplified to:\n$$\nc(x) = B \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\nTo simplify notation, let us define the characteristic length scale $\\lambda_L = \\sqrt{D/k}$. The solution becomes $c(x) = B \\exp(-x/\\lambda_L)$.\n\nThe second boundary condition is a constant influx $J$ at $x=0$, given by $-D \\left.\\frac{dc}{dx}\\right|_{x=0} = J$.\nFirst, we compute the derivative of $c(x)$:\n$$\n\\frac{dc}{dx} = \\frac{d}{dx} \\left[ B \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right) \\right] = -B \\sqrt{\\frac{k}{D}} \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\nEvaluating this derivative at $x=0$:\n$$\n\\left.\\frac{dc}{dx}\\right|_{x=0} = -B \\sqrt{\\frac{k}{D}}\n$$\nSubstituting this into the boundary condition equation:\n$$\n-D \\left(-B \\sqrt{\\frac{k}{D}}\\right) = J\n$$\n$$\nD B \\frac{\\sqrt{k}}{\\sqrt{D}} = J \\implies B \\sqrt{Dk} = J\n$$\nSolving for the constant $B$:\n$$\nB = \\frac{J}{\\sqrt{Dk}}\n$$\nThus, the morphogen concentration profile is given by:\n$$\nc(x) = \\frac{J}{\\sqrt{Dk}} \\exp\\left(-x\\sqrt{\\frac{k}{D}}\\right)\n$$\nThe gene expression boundary (GEB) position, $x^{\\ast}$, is defined by the condition $g(x^{\\ast}) = 0$. The regulatory input is $g(x) = \\alpha c(x) - \\beta$.\nSetting $g(x^{\\ast}) = 0$ gives $\\alpha c(x^{\\ast}) - \\beta = 0$, which implies that the concentration at the boundary is a fixed threshold value:\n$$\nc(x^{\\ast}) = \\frac{\\beta}{\\alpha}\n$$\nWe can now find an expression for $x^{\\ast}$ by equating the two expressions for the concentration at this position:\n$$\n\\frac{J}{\\sqrt{Dk}} \\exp\\left(-x^{\\ast}\\sqrt{\\frac{k}{D}}\\right) = \\frac{\\beta}{\\alpha}\n$$\nTo solve for $x^{\\ast}$, we first isolate the exponential term:\n$$\n\\exp\\left(-x^{\\ast}\\sqrt{\\frac{k}{D}}\\right) = \\frac{\\beta \\sqrt{Dk}}{\\alpha J}\n$$\nTaking the natural logarithm of both sides:\n$$\n-x^{\\ast}\\sqrt{\\frac{k}{D}} = \\ln\\left(\\frac{\\beta \\sqrt{Dk}}{\\alpha J}\\right)\n$$\nSolving for $x^{\\ast}$:\n$$\nx^{\\ast} = -\\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\beta \\sqrt{Dk}}{\\alpha J}\\right) = \\sqrt{\\frac{D}{k}} \\ln\\left(\\left[\\frac{\\beta \\sqrt{Dk}}{\\alpha J}\\right]^{-1}\\right) = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right)\n$$\nThis general expression relates the GEB position to the system parameters.\n\nNow we consider the two specific cases.\nFirst, the initial state with influx $J$. The GEB is $x^{\\ast}_{0}$:\n$$\nx^{\\ast}_{0} = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right)\n$$\nSecond, the modified state where the influx is increased by a factor $r$, becoming $rJ$. The new GEB is $x^{\\ast}_{r}$:\n$$\nx^{\\ast}_{r} = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha (rJ)}{\\beta \\sqrt{Dk}}\\right)\n$$\nThe problem asks for the boundary shift, $\\Delta x = x^{\\ast}_{r} - x^{\\ast}_{0}$.\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha r J}{\\beta \\sqrt{Dk}}\\right) - \\sqrt{\\frac{D}{k}} \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right)\n$$\nFactoring out the common term $\\sqrt{D/k}$:\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\left[ \\ln\\left(\\frac{\\alpha r J}{\\beta \\sqrt{Dk}}\\right) - \\ln\\left(\\frac{\\alpha J}{\\beta \\sqrt{Dk}}\\right) \\right]\n$$\nUsing the logarithm property $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\ln\\left( \\frac{\\frac{\\alpha r J}{\\beta \\sqrt{Dk}}}{\\frac{\\alpha J}{\\beta \\sqrt{Dk}}} \\right)\n$$\nThe terms inside the logarithm simplify:\n$$\n\\Delta x = \\sqrt{\\frac{D}{k}} \\ln(r)\n$$\nThis is the final expression for the boundary shift, given in terms of $r$, $D$, and $k$ only, as required. The parameters describing the source strength ($J$) and the gene readout mechanism ($\\alpha$, $\\beta$) are not present in the final result, demonstrating a key scaling property of this system.", "answer": "$$\\boxed{\\sqrt{\\frac{D}{k}} \\ln(r)}$$", "id": "2779091"}, {"introduction": "Building upon the concept of an ideal morphogen gradient, we must account for the biological reality of noise. Cells cannot measure molecular concentrations with perfect accuracy, and this measurement uncertainty translates into an error in their perceived position. By deriving the relationship between concentration noise, the local gradient steepness, and the resulting positional error [@problem_id:2779048], you will gain a quantitative understanding of the fundamental limits to precision in any pattern decoded from a chemical signal.", "problem": "A one-dimensional engineered tissue establishes a synthetic morphogen gradient along the spatial coordinate $x \\in [0,L]$ with mean concentration profile $c(x)$ that is strictly monotonic and differentiable. Single cells read out the local morphogen concentration through receptor-mediated sensing, resulting in a noisy measurement $c_{\\mathrm{meas}} = c(x) + \\eta$, where $\\eta$ is a zero-mean Gaussian random variable with standard deviation $\\sigma_{c}$ that is independent of $x$ over the neighborhood of interest. Cells decode their position by inverting the mean profile, $\\hat{x} = c^{-1}(c_{\\mathrm{meas}})$, which is well-defined due to monotonicity. The fate decision rule is monotonic in the sensed concentration, so that the conditional response $p(f \\mid c)$ is consistent with a single-valued inverse mapping between $c$ and $x$ in the region considered.\n\nStarting from a first-order Taylor linearization of $c(\\hat{x})$ about the true position $x$ and the definition of standard deviation for Gaussian noise, derive the analytic expression for the positional uncertainty $\\sigma_{x}(x)$, defined as the standard deviation of $\\hat{x}$ around $x$, in terms of $\\sigma_{c}$ and the local slope $\\partial c / \\partial x$. Then, specialize your expression to the common exponential gradient $c(x) = c_{0} \\exp(-x/\\lambda)$, where $c_{0} > 0$ is the concentration at $x=0$ and $\\lambda > 0$ is the decay length. \n\nProvide your final answer as a single closed-form expression for $\\sigma_{x}(x)$ in terms of $c_{0}$, $\\lambda$, $\\sigma_{c}$, and $x$. Assume $x$ and $\\lambda$ are measured in micrometers and $c_{0}$ and $\\sigma_{c}$ are measured in the same concentration units so that your expression has units of micrometers. Also, briefly explain what happens to $\\sigma_{x}(x)$ when $|\\partial c/\\partial x| \\to 0$, and justify your explanation mathematically based on your derived expression. No numerical approximation is required.", "solution": "The problem posed will first be subjected to a rigorous validation to ensure its scientific and logical integrity.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- The system is a one-dimensional engineered tissue along the spatial coordinate $x \\in [0,L]$.\n- The mean morphogen concentration profile is $c(x)$, which is strictly monotonic and differentiable.\n- A cell's measurement of concentration is a noisy variable: $c_{\\mathrm{meas}} = c(x) + \\eta$.\n- The noise term $\\eta$ is a zero-mean Gaussian random variable with standard deviation $\\sigma_{c}$.\n- $\\sigma_{c}$ is stated to be independent of $x$ in the region of interest.\n- The cell's estimate of its position is $\\hat{x} = c^{-1}(c_{\\mathrm{meas}})$. The inverse function $c^{-1}$ is well-defined.\n- The positional uncertainty, $\\sigma_{x}(x)$, is defined as the standard deviation of $\\hat{x}$ around the true position $x$.\n- The derivation must begin from a first-order Taylor linearization of $c(\\hat{x})$ about the true position $x$.\n- The specific gradient profile to be analyzed is $c(x) = c_{0} \\exp(-x/\\lambda)$, with constants $c_{0} > 0$ and $\\lambda > 0$.\n- The final expression for $\\sigma_{x}(x)$ must be in terms of $c_{0}$, $\\lambda$, $\\sigma_{c}$, and $x$.\n- A brief explanation is required for the behavior of $\\sigma_{x}(x)$ as $|\\partial c/\\partial x| \\to 0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a classic formulation of the \"positional information\" principle in developmental biology, applied within a synthetic biology context. The use of a morphogen gradient, noisy sensing, decoding via function inversion, and an exponential profile (a solution to the diffusion-degradation equation) are all standard, well-established concepts in quantitative biology and biophysics. The model is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It provides all necessary information and a clear, structured path for the derivation (Taylor linearization). The inputs ($c(x)$, $\\sigma_c$) are defined, and the output ($\\sigma_x(x)$) is specified unambiguously.\n- **Objective:** The problem statement is objective, using precise mathematical and scientific language, and is free of subjective or ambiguous terminology.\n\nAll other validation criteria are met. The problem does not contain contradictions, incompleteness, trivialities, or unscientific premises.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will now proceed with the solution.\n\n**Derivation of Positional Uncertainty**\n\nThe position estimate $\\hat{x}$ is a function of the measured concentration $c_{\\mathrm{meas}}$, specifically $\\hat{x} = c^{-1}(c_{\\mathrm{meas}})$. The measured concentration at a true position $x$ is $c_{\\mathrm{meas}} = c(\\hat{x})$. The problem asks to start with a first-order Taylor series expansion of $c(\\hat{x})$ around the true position $x$:\n$$c(\\hat{x}) \\approx c(x) + (\\hat{x} - x) \\frac{\\partial c}{\\partial x}$$\nHere, $\\hat{x} - x$ represents the error in the position estimate.\nWe are given that the measured concentration is $c_{\\mathrm{meas}} = c(x) + \\eta$, where $\\eta$ is the measurement noise. Equating the two expressions for the measured concentration, we have:\n$$c(x) + \\eta \\approx c(x) + (\\hat{x} - x) \\frac{\\partial c}{\\partial x}$$\nSubtracting $c(x)$ from both sides yields an approximate relationship between the concentration noise $\\eta$ and the positional error $\\hat{x} - x$:\n$$\\eta \\approx (\\hat{x} - x) \\frac{\\partial c}{\\partial x}$$\nRearranging this equation to solve for the positional error gives:\n$$\\hat{x} - x \\approx \\frac{\\eta}{\\frac{\\partial c}{\\partial x}}$$\nThe positional uncertainty $\\sigma_{x}(x)$ is the standard deviation of the position estimate $\\hat{x}$. Since $x$ is a fixed, non-random quantity, the variance of the estimate $\\hat{x}$ is equal to the variance of the error $\\hat{x} - x$.\n$$\\sigma_{x}^{2}(x) = \\mathrm{Var}(\\hat{x}) = \\mathrm{Var}(\\hat{x} - x)$$\nUsing the derived approximation for the error, we find the variance:\n$$\\sigma_{x}^{2}(x) \\approx \\mathrm{Var}\\left(\\frac{\\eta}{\\frac{\\partial c}{\\partial x}}\\right)$$\nThe derivative $\\frac{\\partial c}{\\partial x}$ is evaluated at the true position $x$ and is therefore a deterministic quantity, not a random variable. We can treat it as a constant factor in the variance calculation. Using the property that for a random variable $Y$ and a constant $a$, $\\mathrm{Var}(aY) = a^{2}\\mathrm{Var}(Y)$, we have:\n$$\\sigma_{x}^{2}(x) \\approx \\left(\\frac{1}{\\frac{\\partial c}{\\partial x}}\\right)^{2} \\mathrm{Var}(\\eta)$$\nWe are given that the standard deviation of the noise $\\eta$ is $\\sigma_{c}$, so its variance is $\\mathrm{Var}(\\eta) = \\sigma_{c}^{2}$. Substituting this into the expression gives:\n$$\\sigma_{x}^{2}(x) \\approx \\frac{\\sigma_{c}^{2}}{\\left(\\frac{\\partial c}{\\partial x}\\right)^{2}}$$\nTaking the square root of both sides gives the general expression for the positional uncertainty. As standard deviation must be non-negative, we use the absolute value of the derivative in the denominator:\n$$\\sigma_{x}(x) = \\frac{\\sigma_{c}}{\\left|\\frac{\\partial c}{\\partial x}\\right|}$$\n\n**Specialization for an Exponential Gradient**\n\nThe problem now requires us to specialize this result for the exponential concentration profile $c(x) = c_{0} \\exp(-x/\\lambda)$.\nFirst, we compute the derivative of $c(x)$ with respect to $x$:\n$$\\frac{\\partial c}{\\partial x} = \\frac{d}{dx}\\left[c_{0} \\exp\\left(-\\frac{x}{\\lambda}\\right)\\right] = c_{0} \\exp\\left(-\\frac{x}{\\lambda}\\right) \\cdot \\left(-\\frac{1}{\\lambda}\\right) = -\\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\nNext, we take the absolute value of this derivative. Since $c_{0} > 0$, $\\lambda > 0$, and the exponential function is always positive, the absolute value is:\n$$\\left|\\frac{\\partial c}{\\partial x}\\right| = \\left|-\\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)\\right| = \\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\nFinally, we substitute this expression into the general formula for $\\sigma_{x}(x)$:\n$$\\sigma_{x}(x) = \\frac{\\sigma_{c}}{\\frac{c_{0}}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right)}$$\nSimplifying this fraction yields the final closed-form expression:\n$$\\sigma_{x}(x) = \\frac{\\sigma_{c} \\lambda}{c_{0}} \\exp\\left(\\frac{x}{\\lambda}\\right)$$\n\n**Analysis of the Limit $|\\partial c/\\partial x| \\to 0$**\n\nBased on the general derived expression $\\sigma_{x}(x) = \\sigma_{c} / |\\partial c/\\partial x|$, we can analyze the behavior as the magnitude of the gradient slope approaches zero. As $|\\partial c/\\partial x| \\to 0$, with a non-zero measurement noise $\\sigma_{c} > 0$, the denominator of the fraction approaches zero while the numerator remains a positive constant.\nMathematically, this means the positional uncertainty $\\sigma_{x}(x)$ diverges to infinity:\n$$\\lim_{|\\partial c/\\partial x| \\to 0} \\sigma_{x}(x) = \\infty$$\nThe physical justification is that a shallow or flat morphogen gradient provides very poor positional information. When the concentration changes very little with position, a small, unavoidable noise in the concentration measurement ($\\eta$) makes it impossible to distinguish between widely separated positions. The cell's decoding mechanism maps a small concentration range, blurred by noise, to a very large range of possible positions, resulting in a large positional uncertainty. In the limit of a perfectly flat gradient ($|\\partial c/\\partial x| = 0$), the local concentration carries no information about position, and the uncertainty becomes infinite.", "answer": "$$\n\\boxed{\\frac{\\sigma_{c} \\lambda}{c_{0}} \\exp\\left(\\frac{x}{\\lambda}\\right)}\n$$", "id": "2779048"}, {"introduction": "A primary goal of synthetic developmental biology is to move beyond analysis and toward rational design and control. This challenge shifts our perspective from a \"forward problem\"—predicting the pattern that results from a given source—to an \"inverse problem\" of calculating the source required to generate a specific target pattern. This computational exercise [@problem_id:2779025] will guide you through the process of designing an optogenetic input to create a desired morphogen profile, a powerful engineering paradigm for programming multicellular structures.", "problem": "You will design and implement an algorithm that computes the optimal one-dimensional illumination pattern to produce a target steady-state morphogen concentration profile in a linear diffusion-degradation system driven by an optogenetic source. The forward biophysical model is derived from Fick’s law and first-order degradation. On a one-dimensional domain of length $L$ with spatial coordinate $x \\in [0,L]$, morphogen concentration $c(x)$ satisfies the steady-state equation\n$$\nD \\,\\frac{d^2 c}{dx^2} - k\\,c + s\\,u(x) = 0,\n$$\nwhere $D$ is the diffusion coefficient, $k$ is the degradation rate constant, $s$ is the source strength per unit illumination, and $u(x)$ is the nonnegative illumination intensity. Zero-flux (Neumann) boundary conditions hold at both ends:\n$$\n\\frac{dc}{dx}(0) = 0, \\quad \\frac{dc}{dx}(L) = 0.\n$$\nDefine a uniform grid of $N$ points with spacing $h = L/(N-1)$. Use a standard second-order centered finite-difference discretization of the second derivative that enforces the zero-flux boundary conditions at the endpoints by the canonical ghost-point elimination, resulting in a tridiagonal second-derivative matrix $L_N \\in \\mathbb{R}^{N \\times N}$ whose interior rows use the three-point stencil and whose boundary rows consistently impose zero spatial derivative. The steady-state discretized forward model can be written as\n$$\n\\left(k I - D L_N\\right)\\, \\mathbf{c} = s\\, \\mathbf{u},\n$$\nwith $\\mathbf{c}, \\mathbf{u} \\in \\mathbb{R}^N$ the discretized concentration and illumination, and $I$ the $N \\times N$ identity matrix. The illumination is constrained componentwise by $0 \\le u_i \\le u_{\\max}$.\n\nGiven a target concentration profile $\\mathbf{c}^{\\star} \\in \\mathbb{R}^N$, pose the inverse problem as finding $\\mathbf{u}$ that minimizes the convex quadratic objective\n$$\nJ(\\mathbf{u}) = \\left\\| G \\mathbf{u} - \\mathbf{c}^{\\star} \\right\\|_2^2 \\;+\\; \\alpha \\left\\| D_1 \\mathbf{u} \\right\\|_2^2\n$$\nsubject to the box constraints $0 \\le u_i \\le u_{\\max}$ for all $i$, where $G = s(k I - D L_N)^{-1}$ is the discrete forward operator mapping illumination to concentration, $D_1 \\in \\mathbb{R}^{(N-1)\\times N}$ is the first-difference matrix defined by $(D_1 \\mathbf{u})_i = u_{i+1} - u_i$ for $i=1,\\dots,N-1$, and $\\alpha \\ge 0$ is a smoothing parameter. For each test case below, compute the optimal $\\mathbf{u}^{\\star}$, then evaluate the produced concentration $\\widehat{\\mathbf{c}} = G \\mathbf{u}^{\\star}$ and report the root mean squared error\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^N \\left(\\widehat{c}_i - c_i^{\\star}\\right)^2 }.\n$$\nReport the $\\mathrm{RMSE}$ in concentration arbitrary units (a.u.).\n\nImplementation requirements:\n- Construct $L_N$ with the standard three-point stencil in the interior and consistent zero-flux boundary rows.\n- Construct $G$ by numerically inverting $k I - D L_N$ or by solving linear systems with that matrix.\n- Use the first-difference $D_1$ for smoothing, and incorporate the smoothing term using a standard technique that preserves convexity.\n- Enforce $0 \\le u_i \\le u_{\\max}$.\n\nTest suite. Use $N$ and $L$ as specified per case, and define the target $\\mathbf{c}^{\\star}$ by sampling the indicated continuous function on the uniform grid $x_j = j h$, $j=0,\\dots,N-1$:\n\n- Case A (smooth target under moderate diffusion): $L = 500\\,\\mu\\mathrm{m}$, $N = 64$, $D = 10\\,\\mu\\mathrm{m}^2/\\mathrm{s}$, $k = 0.01\\,\\mathrm{s}^{-1}$, $s = 1.0\\,\\mathrm{(a.u.)/(\\mathrm{W}\\,\\mathrm{m}^{-2})}$, $\\alpha = 10^{-2}$, $u_{\\max} = 5.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$, target $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}\\cdot \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\cdot (60\\,\\mu\\mathrm{m})^2}\\right)$.\n\n- Case B (uniform target to probe boundary handling): $L = 400\\,\\mu\\mathrm{m}$, $N = 50$, $D = 5\\,\\mu\\mathrm{m}^2/\\mathrm{s}$, $k = 0.05\\,\\mathrm{s}^{-1}$, $s = 1.0$, $\\alpha = 10^{-3}$, $u_{\\max} = 5.0$, target $c^{\\star}(x) = 0.2\\,\\mathrm{a.u.}$ for all $x$.\n\n- Case C (step target with stronger smoothing): $L = 600\\,\\mu\\mathrm{m}$, $N = 80$, $D = 8\\,\\mu\\mathrm{m}^2/\\mathrm{s}$, $k = 0.02\\,\\mathrm{s}^{-1}$, $s = 1.0$, $\\alpha = 5 \\times 10^{-2}$, $u_{\\max} = 10.0$, target $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}$ for $x \\le L/3$ and $c^{\\star}(x) = 0.1\\,\\mathrm{a.u.}$ for $x > L/3$.\n\n- Case D (high diffusion and weak degradation, narrow feature): $L = 500\\,\\mu\\mathrm{m}$, $N = 64$, $D = 50\\,\\mu\\mathrm{m}^2/\\mathrm{s}$, $k = 0.005\\,\\mathrm{s}^{-1}$, $s = 1.0$, $\\alpha = 10^{-2}$, $u_{\\max} = 10.0$, target $c^{\\star}(x) = 1.0\\,\\mathrm{a.u.}\\cdot \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\cdot (20\\,\\mu\\mathrm{m})^2}\\right)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the $\\mathrm{RMSE}$ values for Cases A, B, C, and D, in that order, as a comma-separated list of floats enclosed in square brackets (e.g., \"[$r_A$,$r_B$,$r_C$,$r_D$]\"). Each $\\mathrm{RMSE}$ must be in concentration arbitrary units (a.u.).\n- The program must be fully self-contained, take no input, and perform all computations internally.", "solution": "The problem presented is a well-posed inverse problem in the field of synthetic developmental biology, specifically concerning the control of multicellular patterns via optogenetics. The objective is to determine an optimal illumination pattern $\\mathbf{u}$ that generates a desired steady-state morphogen concentration profile $\\mathbf{c}^{\\star}$. This requires inverting a biophysical model based on reaction-diffusion dynamics. The problem is formulated as a convex optimization problem with box constraints, which is computationally tractable.\n\nThe forward model describes the steady-state concentration $c(x)$ of a morphogen on a one-dimensional domain of length $L$, given by the differential equation:\n$$\nD \\,\\frac{d^2 c}{dx^2} - k\\,c + s\\,u(x) = 0\n$$\nHere, $D$ is the diffusion coefficient, $k$ is the first-order degradation rate, $s$ is the source production rate, and $u(x)$ is the spatially varying illumination input. The system is closed, which is enforced by zero-flux (Neumann) boundary conditions:\n$$\n\\frac{dc}{dx}(0) = 0, \\quad \\frac{dc}{dx}(L) = 0\n$$\nTo solve this problem numerically, we first discretize the spatial domain $x \\in [0, L]$ into a uniform grid of $N$ points $\\{x_i\\}_{i=0}^{N-1}$ with spacing $h = L/(N-1)$. The concentration and illumination profiles are represented by vectors $\\mathbf{c}, \\mathbf{u} \\in \\mathbb{R}^N$.\n\nThe second derivative operator, $\\frac{d^2}{dx^2}$, is approximated using a second-order centered finite difference scheme. For an interior grid point $x_i$, this is:\n$$\n\\frac{d^2 c}{dx^2}\\bigg|_{x_i} \\approx \\frac{c_{i-1} - 2c_i + c_{i+1}}{h^2}\n$$\nTo maintain second-order accuracy at the boundaries, we introduce ghost points $c_{-1}$ and $c_{N}$ and apply the centered difference approximation of the zero-flux boundary conditions:\n- At $x_0 = 0$: $\\frac{dc}{dx}(0) \\approx \\frac{c_1 - c_{-1}}{2h} = 0 \\implies c_{-1} = c_1$.\n- At $x_{N-1} = L$: $\\frac{dc}{dx}(L) \\approx \\frac{c_{N} - c_{N-2}}{2h} = 0 \\implies c_{N} = c_{N-2}$.\nSubstituting these into the second-derivative approximation at the boundary nodes yields:\n- At $x_0$: $\\frac{d^2 c}{dx^2}\\bigg|_{x_0} \\approx \\frac{c_{-1} - 2c_0 + c_1}{h^2} = \\frac{2c_1 - 2c_0}{h^2}$.\n- At $x_{N-1}$: $\\frac{d^2 c}{dx^2}\\bigg|_{x_{N-1}} \\approx \\frac{c_{N-2} - 2c_{N-1} + c_{N}}{h^2} = \\frac{2c_{N-2} - 2c_{N-1}}{h^2}$.\nThis leads to the construction of the discrete Laplacian matrix $L_N \\in \\mathbb{R}^{N \\times N}$:\n$$\nL_N = \\frac{1}{h^2} \\begin{pmatrix}\n-2  2  0  \\dots  0 \\\\\n1  -2  1  \\dots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  \\vdots \\\\\n0  \\dots  1  -2  1 \\\\\n0  \\dots  0  2  -2\n\\end{pmatrix}\n$$\nThe discretized form of the governing equation is a linear system:\n$$\n\\left( D L_N - k I \\right) \\mathbf{c} + s \\mathbf{u} = \\mathbf{0}\n$$\nwhere $I$ is the $N \\times N$ identity matrix. Rearranging, we obtain the discretized forward model:\n$$\n\\left( k I - D L_N \\right) \\mathbf{c} = s \\mathbf{u}\n$$\nThe matrix $A = (k I - D L_N)$ is positive definite for $D, k > 0$ and thus invertible. We can therefore define a linear forward operator $G$ that maps an illumination vector $\\mathbf{u}$ to a concentration vector $\\mathbf{c}$:\n$$\n\\mathbf{c} = s (k I - D L_N)^{-1} \\, \\mathbf{u} = G \\mathbf{u}\n$$\nThe inverse problem is to find an illumination pattern $\\mathbf{u}$ that produces a concentration profile as close as possible to a target profile $\\mathbf{c}^{\\star}$. This is formulated as a regularized optimization problem to ensure a stable and physically meaningful solution. We minimize the following convex quadratic objective function:\n$$\nJ(\\mathbf{u}) = \\underbrace{\\left\\| G \\mathbf{u} - \\mathbf{c}^{\\star} \\right\\|_2^2}_{\\text{Fidelity Term}} + \\underbrace{\\alpha \\left\\| D_1 \\mathbf{u} \\right\\|_2^2}_{\\text{Smoothing Term}}\n$$\nThe first term measures the squared Euclidean distance between the produced concentration $G\\mathbf{u}$ and the target $\\mathbf{c}^{\\star}$. The second term is a Tikhonov regularization term, which penalizes large variations between adjacent points in the illumination pattern, controlled by the smoothing parameter $\\alpha \\ge 0$. Here, $D_1 \\in \\mathbb{R}^{(N-1)\\times N}$ is the first-difference matrix. Additionally, the illumination must satisfy the physical constraints $0 \\le u_i \\le u_{\\max}$ for all grid points $i$.\n\nThis problem structure is equivalent to a bound-constrained linear least-squares problem. We can rewrite the objective function by stacking the matrices and vectors:\n$$\nJ(\\mathbf{u}) = \\left\\| \\begin{pmatrix} G \\\\ \\sqrt{\\alpha} D_1 \\end{pmatrix} \\mathbf{u} - \\begin{pmatrix} \\mathbf{c}^{\\star} \\\\ \\mathbf{0} \\end{pmatrix} \\right\\|_2^2\n$$\nThis is of the form $\\min_{\\mathbf{u}} \\| M\\mathbf{u} - \\mathbf{d} \\|_2^2$ subject to $0 \\le \\mathbf{u} \\le u_{\\max}$, where $M = \\begin{pmatrix} G \\\\ \\sqrt{\\alpha} D_1 \\end{pmatrix}$ and $\\mathbf{d} = \\begin{pmatrix} \\mathbf{c}^{\\star} \\\\ \\mathbf{0} \\end{pmatrix}$. This formulation can be solved efficiently using standard numerical optimization routines, such as `scipy.optimize.lsq_linear`.\n\nThe solution algorithm proceeds as follows for each test case:\n1.  Set the physical parameters $L, N, D, k, s, \\alpha, u_{\\max}$.\n2.  Construct the spatial grid $\\mathbf{x}$ and the target concentration vector $\\mathbf{c}^{\\star}$.\n3.  Assemble the discrete Laplacian matrix $L_N$ and the forward operator matrix $G$.\n4.  Assemble the first-difference matrix $D_1$.\n5.  Formulate the augmented matrix $M$ and vector $\\mathbf{d}$ for the least-squares problem.\n6.  Solve the bound-constrained least-squares problem to find the optimal illumination vector $\\mathbf{u}^{\\star}$.\n7.  Compute the resulting concentration profile $\\widehat{\\mathbf{c}} = G \\mathbf{u}^{\\star}$.\n8.  Calculate the root mean squared error (RMSE) between $\\widehat{\\mathbf{c}}$ and $\\mathbf{c}^{\\star}$ as $\\sqrt{\\frac{1}{N} \\sum_{i=1}^N (\\widehat{c}_i - c_i^{\\star})^2}$.\nThis procedure is repeated for all specified test cases to evaluate the performance of the control strategy under different physical regimes.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Computes the optimal illumination pattern for target morphogen profiles\n    and reports the root mean squared error for several test cases.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'name': 'A', 'L': 500.0, 'N': 64, 'D': 10.0, 'k': 0.01, 's': 1.0, 'alpha': 1e-2, 'u_max': 5.0,\n         'c_star_func': lambda x, L: 1.0 * np.exp(-(x - L/2)**2 / (2 * 60**2))},\n        # Case B\n        {'name': 'B', 'L': 400.0, 'N': 50, 'D': 5.0, 'k': 0.05, 's': 1.0, 'alpha': 1e-3, 'u_max': 5.0,\n         'c_star_func': lambda x, L: 0.2 * np.ones_like(x)},\n        # Case C\n        {'name': 'C', 'L': 600.0, 'N': 80, 'D': 8.0, 'k': 0.02, 's': 1.0, 'alpha': 5e-2, 'u_max': 10.0,\n         'c_star_func': lambda x, L: np.where(x = L/3, 1.0, 0.1)},\n        # Case D\n        {'name': 'D', 'L': 500.0, 'N': 64, 'D': 50.0, 'k': 0.005, 's': 1.0, 'alpha': 1e-2, 'u_max': 10.0,\n         'c_star_func': lambda x, L: 1.0 * np.exp(-(x - L/2)**2 / (2 * 20**2))}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # 1. Unpack parameters and set up the domain\n        L, N, D, k, s, alpha, u_max = case['L'], case['N'], case['D'], case['k'], case['s'], case['alpha'], case['u_max']\n        \n        x_grid = np.linspace(0, L, N)\n        h = L / (N - 1)\n        h2_inv = 1.0 / (h**2)\n        \n        # 2. Construct the second-derivative matrix L_N with Neumann BCs\n        diag_main = -2.0 * np.ones(N)\n        diag_off = np.ones(N - 1)\n        \n        L_N = h2_inv * (np.diag(diag_main) + np.diag(diag_off, k=1) + np.diag(diag_off, k=-1))\n        \n        # Apply zero-flux (Neumann) boundary conditions\n        L_N[0, 0] = -2.0 * h2_inv\n        L_N[0, 1] = 2.0 * h2_inv\n        L_N[N-1, N-2] = 2.0 * h2_inv\n        L_N[N-1, N-1] = -2.0 * h2_inv\n        \n        # 3. Construct matrices for the inverse problem\n        # Forward operator matrix G\n        A_op = k * np.eye(N) - D * L_N\n        G = s * np.linalg.inv(A_op)\n        \n        # First-difference matrix D1 for regularization\n        D1 = np.eye(N, k=1) - np.eye(N)\n        D1 = D1[:-1, :]\n\n        # Target concentration profile\n        c_star = case['c_star_func'](x_grid, L)\n\n        # 4. Set up and solve the bound-constrained least-squares problem\n        # The objective is to minimize ||M*u - d||^2_2\n        # where M = vstack([G, sqrt(alpha)*D1]) and d = concatenate([c_star, 0s])\n        M = np.vstack((G, np.sqrt(alpha) * D1))\n        d = np.concatenate((c_star, np.zeros(N - 1)))\n        \n        bounds = (0, u_max)\n        \n        # Solve for the optimal illumination u_star\n        opt_result = lsq_linear(M, d, bounds=bounds)\n        u_star = opt_result.x\n        \n        # 5. Compute the resulting concentration and RMSE\n        c_hat = G @ u_star\n        rmse = np.sqrt(np.mean((c_hat - c_star)**2))\n        results.append(rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2779025"}]}