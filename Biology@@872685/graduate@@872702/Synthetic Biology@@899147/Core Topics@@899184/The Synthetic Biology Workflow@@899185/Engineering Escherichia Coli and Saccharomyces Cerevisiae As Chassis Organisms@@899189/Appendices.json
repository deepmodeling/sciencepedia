{"hands_on_practices": [{"introduction": "Successfully expressing a foreign gene requires careful consideration of the host's molecular machinery. This exercise delves into the critical concept of codon usage bias by modeling how the choice of synonymous codons impacts translation speed and overall protein yield. By applying a kinetic model based on codon availability [@problem_id:2732911], you will learn to predict the relative translation efficiency of a gene in both *E. coli* and *S. cerevisiae*, and identify the specific 'bottleneck' codons that can limit expression.", "problem": "You are given a formalized kinetic model for translation elongation to compare expected translation efficiencies of a single coding DNA sequence in two host organisms: Escherichia coli (E. coli) and Saccharomyces cerevisiae (S. cerevisiae). The model adheres to the central dogma of molecular biology and posits that the average per-codon decoding time in a host is inversely proportional to the availability of the corresponding transfer ribonucleic acid (tRNA), which is here proxied by host-specific codon availability weights. Formally, for a host $h$, a codon $c$, and an arbitrary host-dependent proportionality constant $k_h>0$, the decoding time is $t_{c,h} = 1/(k_h f_{c,h})$ where $f_{c,h}>0$ is the given relative availability weight for codon $c$ in host $h$. For a coding sequence comprising codons $\\{c_1,\\dots,c_L\\}$, the total elongation time is $T_h = \\sum_{i=1}^{L} t_{c_i,h}$. To eliminate unknown host-dependent scale factors and the effect of sequence length, you must compute the normalized relative translation efficiency in host $h$ defined as\n$$\nE_h \\equiv \\frac{T_{h,\\mathrm{opt}}}{T_h} = \\frac{\\sum_{i=1}^{L} \\frac{1}{f_{a_i,h}^{\\max}}}{\\sum_{i=1}^{L} \\frac{1}{f_{c_i,h}}},\n$$\nwhere $a_i$ is the amino acid specified at position $i$, and $f_{a_i,h}^{\\max}$ is the maximum $f_{c,h}$ among the synonymous codons for amino acid $a_i$ in host $h$. This normalization corresponds to the ratio of the optimal time (using, at each position, the best synonymous codon in host $h$) to the actual time of the given sequence. Additionally, define translation bottlenecks in host $h$ as the set of codon positions achieving the maximum per-codon time $t_{c_i,h}$ along the sequence; that is, positions $i$ such that $\\frac{1}{f_{c_i,h}}$ is maximized.\n\nInput data for this task are fully specified below and must be embedded directly in your program. The sequence alphabet is deoxyribonucleic acid (DNA) with standard uppercase bases, and reading frames are in-frame from the first nucleotide. All frequencies $f_{c,h}$ are strictly positive real numbers.\n\nYou must implement the above model and compute, for each test case: the pair $(E_{\\mathrm{Ec}}, E_{\\mathrm{Sc}})$, the cross-host ratio $R = E_{\\mathrm{Ec}}/E_{\\mathrm{Sc}}$, and the bottleneck position lists for both hosts as $1$-based indices. All floating-point outputs must be rounded to $6$ decimal places. The only amino acids present in the sequences and needed for normalization are Lysine (K), Glycine (G), Proline (P), and Aspartic Acid (D), with the following synonymous codons:\n- Lysine (K): {AAA, AAG}.\n- Glycine (G): {GGT, GGC, GGA, GGG}.\n- Proline (P): {CCT, CCC, CCA, CCG}.\n- Aspartic Acid (D): {GAT, GAC}.\n\nHost-specific codon availability weights $f_{c,h}$ are as follows:\n- Escherichia coli (E. coli): AAA: $0.7$, AAG: $0.3$; GGT: $0.35$, GGC: $0.4$, GGA: $0.1$, GGG: $0.15$; CCT: $0.3$, CCC: $0.18$, CCA: $0.22$, CCG: $0.3$; GAT: $0.65$, GAC: $0.35$.\n- Saccharomyces cerevisiae (S. cerevisiae): AAA: $0.3$, AAG: $0.7$; GGT: $0.4$, GGC: $0.2$, GGA: $0.25$, GGG: $0.15$; CCT: $0.2$, CCC: $0.15$, CCA: $0.5$, CCG: $0.15$; GAT: $0.45$, GAC: $0.55$.\n\nTest suite to implement and evaluate:\n- Test case $1$ (mixed codons): coding sequence with codons in order AAA, GGA, GGT, GGC, GGG, CCG, CCA, CCC, CCT, GAT, GAC, AAG; that is, the concatenated DNA string \"AAAGGAGGTGGCCCGCCACCCCCTGATGACAAG\".\n- Test case $2$ (single-codon repeat): coding sequence of Lysine using AAA repeated $10$ times consecutively; that is, the concatenated DNA string of length $30$ bases comprising \"AAA\" repeated $10$ times without separators.\n- Test case $3$ (E. coli–optimal codons per amino acid): coding sequence with codons in order AAA, GGC, CCG, GAT, AAA, GGC, CCG, GAT; that is, the concatenated DNA string \"AAAGGCCCGGATAAAGGCCCGGAT\".\n\nFor each test case, your program must:\n- Parse the DNA sequence into codons $\\{c_1,\\dots,c_L\\}$.\n- For each host $h \\in \\{\\mathrm{Ec}, \\mathrm{Sc}\\}$, compute $E_h$ as defined above and identify the bottleneck positions as $1$-based indices where $\\frac{1}{f_{c_i,h}}$ attains its maximum along the sequence.\n- Compute the cross-host ratio $R = E_{\\mathrm{Ec}}/E_{\\mathrm{Sc}}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results over all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a list of the form $[E_{\\mathrm{Ec}}, E_{\\mathrm{Sc}}, R, \\mathrm{bneck}_{\\mathrm{Ec}}, \\mathrm{bneck}_{\\mathrm{Sc}}]$, with all $E$ and $R$ values rounded to $6$ decimal places, and each bottleneck list $\\mathrm{bneck}_{\\mathrm{Ec}}$ and $\\mathrm{bneck}_{\\mathrm{Sc}}$ being a list of integers in ascending order. For example, a valid output structure looks like \"[[...], [...], [...]]\".", "solution": "The problem statement presents a formalized kinetic model to assess the translation efficiency of a given coding DNA sequence in two different host organisms, *Escherichia coli* and *Saccharomyces cerevisiae*. The problem is to be validated before any solution is attempted.\n\n**Step 1: Extract Givens**\n- **Model for per-codon decoding time:** For a host $h$ and codon $c$, the decoding time is $t_{c,h} = 1/(k_h f_{c,h})$, where $k_h > 0$ is a host-specific proportionality constant and $f_{c,h} > 0$ is the codon's relative availability weight in that host.\n- **Total elongation time:** For a sequence of $L$ codons $\\{c_1, \\dots, c_L\\}$, the total time is $T_h = \\sum_{i=1}^{L} t_{c_i,h}$.\n- **Normalized relative translation efficiency:**\n$$E_h = \\frac{T_{h,\\mathrm{opt}}}{T_h} = \\frac{\\sum_{i=1}^{L} \\frac{1}{f_{a_i,h}^{\\max}}}{\\sum_{i=1}^{L} \\frac{1}{f_{c_i,h}}}$$\nHere, $a_i$ is the amino acid at position $i$, and $f_{a_i,h}^{\\max}$ is the maximum availability weight among all synonymous codons for amino acid $a_i$ in host $h$.\n- **Translation bottlenecks:** The set of $1$-based codon positions $i$ where the decoding time $t_{c_i,h}$ (or equivalently, the value $1/f_{c_i,h}$) is maximized for the sequence in host $h$.\n- **Cross-host ratio:** $R = E_{\\mathrm{Ec}}/E_{\\mathrm{Sc}}$.\n- **Amino Acid to Codon Mapping:**\n  - Lysine (K): {AAA, AAG}\n  - Glycine (G): {GGT, GGC, GGA, GGG}\n  - Proline (P): {CCT, CCC, CCA, CCG}\n  - Aspartic Acid (D): {GAT, GAC}\n- **Host-specific Codon Availability Weights ($f_{c,h}$):**\n  - **E. coli (Ec):** AAA: $0.7$, AAG: $0.3$; GGT: $0.35$, GGC: $0.4$, GGA: $0.1$, GGG: $0.15$; CCT: $0.3$, CCC: $0.18$, CCA: $0.22$, CCG: $0.3$; GAT: $0.65$, GAC: $0.35$.\n  - **S. cerevisiae (Sc):** AAA: $0.3$, AAG: $0.7$; GGT: $0.4$, GGC: $0.2$, GGA: $0.25$, GGG: $0.15$; CCT: $0.2$, CCC: $0.15$, CCA: $0.5$, CCG: $0.15$; GAT: $0.45$, GAC: $0.55$.\n- **Test Cases (DNA sequences):**\n  1. \"AAAGGAGGTGGCCCGCCACCCCCTGATGACAAG\"\n  2. \"AAA\" repeated $10$ times.\n  3. \"AAAGGCCCGGATAAAGGCCCGGAT\"\n- **Output Specifications:** For each test case, compute the tuple $(E_{\\mathrm{Ec}}, E_{\\mathrm{Sc}})$, the ratio $R$, and the lists of bottleneck positions for each host. Floating-point values must be rounded to $6$ decimal places.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is subjected to validation.\n- **Scientific Grounding:** The model is a simplified but standard and scientifically accepted representation of translation kinetics, where translation speed is correlated with tRNA abundance, proxied here by codon availability weights. The model is grounded in molecular biology principles.\n- **Well-Posedness:** The problem is well-posed. All necessary data (sequences, weights, mappings) and definitions (formulas for $E_h$ and bottlenecks) are explicitly provided. The objective is clear, and a unique solution can be algorithmically determined.\n- **Objectivity:** The problem statement is written in precise, objective language, free of subjective claims.\n- **Completeness and Consistency:** The data provided is sufficient and self-consistent. The set of codons in the test sequences is a subset of the codons for which weights are provided.\n- **Realism and Feasibility:** The given weights are plausible numerical values. The model, while an abstraction, is not physically impossible or scientifically implausible for its intended purpose of relative comparison.\n- **Structural Integrity:** The definitions are unambiguous. The logic is non-circular.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is scientifically grounded, well-posed, and all necessary components for a solution are provided. A complete, reasoned solution will be developed.\n\n**Principle-Based Design of the Solution**\n\nThe task is to implement the provided quantitative model. The core of the problem lies in the correct application of the formula for normalized relative translation efficiency, $E_h$, and the identification of translation bottlenecks.\n\nFirst, the necessary biological information must be encoded into appropriate data structures. This includes:\n1.  A mapping from each codon to its corresponding amino acid.\n2.  The host-specific availability weights, $f_{c,h}$, for each codon $c$ in each host $h \\in \\{\\mathrm{Ec}, \\mathrm{Sc}\\}$.\n\nThe formula for efficiency $E_h$ is a ratio of two sums. The denominator, $\\sum_{i=1}^{L} \\frac{1}{f_{c_i,h}}$, represents the sum of inverse availability weights for the codons $c_i$ actually present in the sequence. This term is proportional to the total elongation time, $T_h$. The numerator, $\\sum_{i=1}^{L} \\frac{1}{f_{a_i,h}^{\\max}}$, represents the sum of inverse availability weights for an idealized optimal sequence, where for each amino acid $a_i$ in the translated protein, the most abundant (fastest to decode) synonymous codon in host $h$ is used. This term is proportional to the minimal possible elongation time, $T_{h,\\mathrm{opt}}$.\n\nThe computational procedure for a given DNA sequence is as follows:\n\n1.  **Sequence Parsing:** The input DNA string is parsed into a list of $L$ codons, $\\{c_1, c_2, \\dots, c_L\\}$, by taking successive non-overlapping triplets of nucleotides.\n\n2.  **Pre-computation of Optimal Weights:** For each host $h$ and each relevant amino acid $a$, we must pre-calculate the maximum availability weight, $f_{a,h}^{\\max}$. This is done by iterating through all synonymous codons for $a$ and finding the maximum of their $f_{c,h}$ values in host $h$.\n\n3.  **Per-Host Calculation:** The following steps are performed for each host, $h=\\mathrm{Ec}$ and $h=\\mathrm{Sc}$.\n    a.  **Summation for $E_h$**:\n        - Initialize two accumulators: `sum_inv_f_actual` for the denominator and `sum_inv_f_optimal` for the numerator.\n        - Initialize a list to store the per-codon time metric, $\\{1/f_{c_1,h}, 1/f_{c_2,h}, \\dots, 1/f_{c_L,h}\\}$.\n        - Iterate from $i=1$ to $L$:\n            i.  Identify the codon $c_i$ and the corresponding amino acid $a_i$.\n            ii. Retrieve the actual weight $f_{c_i,h}$ and the pre-computed optimal weight $f_{a_i,h}^{\\max}$.\n            iii. Add $1/f_{c_i,h}$ to `sum_inv_f_actual` and store it for bottleneck analysis.\n            iv. Add $1/f_{a_i,h}^{\\max}$ to `sum_inv_f_optimal`.\n    b.  **Efficiency Calculation**: Compute $E_h = \\text{sum\\_inv\\_f\\_optimal} / \\text{sum\\_inv\\_f\\_actual}$.\n    c.  **Bottleneck Identification**: Find the maximum value in the stored list of per-codon time metrics, $\\{1/f_{c_i,h}\\}$. Identify all $1$-based indices $i$ where this maximum value occurs. These indices form the bottleneck list for host $h$.\n\n4.  **Cross-Host Ratio**: After computing $E_{\\mathrm{Ec}}$ and $E_{\\mathrm{Sc}}$, calculate the ratio $R = E_{\\mathrm{Ec}} / E_{\\mathrm{Sc}}$.\n\n5.  **Formatting**: The results for each test case—$E_{\\mathrm{Ec}}$, $E_{\\mathrm{Sc}}$, $R$, and the two bottleneck lists—are collected and formatted according to the output specification, with floating-point numbers rounded to $6$ decimal places. This process is repeated for all provided test cases. The final output is a single string representing a list of these results.\n\nThis structured, step-by-step process ensures that all components of the problem are addressed accurately and systematically, transforming the biological model into a deterministic algorithm.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes translation efficiency and bottlenecks for DNA sequences in E. coli and S. cerevisiae.\n    \"\"\"\n\n    # --- Data Definition ---\n    # Codon to Amino Acid mapping\n    codon_to_aa = {\n        'AAA': 'K', 'AAG': 'K',  # Lysine\n        'GGT': 'G', 'GGC': 'G', 'GGA': 'G', 'GGG': 'G',  # Glycine\n        'CCT': 'P', 'CCC': 'P', 'CCA': 'P', 'CCG': 'P',  # Proline\n        'GAT': 'D', 'GAC': 'D',  # Aspartic Acid\n    }\n\n    # Amino Acid to Synonymous Codons mapping\n    aa_to_codons = {\n        'K': ['AAA', 'AAG'],\n        'G': ['GGT', 'GGC', 'GGA', 'GGG'],\n        'P': ['CCT', 'CCC', 'CCA', 'CCG'],\n        'D': ['GAT', 'GAC'],\n    }\n\n    # Host-specific codon availability weights (f_c,h)\n    f_weights = {\n        'Ec': {\n            'AAA': 0.7, 'AAG': 0.3,\n            'GGT': 0.35, 'GGC': 0.4, 'GGA': 0.1, 'GGG': 0.15,\n            'CCT': 0.3, 'CCC': 0.18, 'CCA': 0.22, 'CCG': 0.3,\n            'GAT': 0.65, 'GAC': 0.35,\n        },\n        'Sc': {\n            'AAA': 0.3, 'AAG': 0.7,\n            'GGT': 0.4, 'GGC': 0.2, 'GGA': 0.25, 'GGG': 0.15,\n            'CCT': 0.2, 'CCC': 0.15, 'CCA': 0.5, 'CCG': 0.15,\n            'GAT': 0.45, 'GAC': 0.55,\n        }\n    }\n\n    # Test cases\n    test_cases = [\n        \"AAAGGAGGTGGCCCGCCACCCCCTGATGACAAG\",\n        \"AAA\" * 10,\n        \"AAAGGCCCGGATAAAGGCCCGGAT\",\n    ]\n\n    # --- Pre-computation ---\n    # Pre-compute maximum availability weights (f_a,h^max) for each amino acid in each host\n    f_max_weights = {'Ec': {}, 'Sc': {}}\n    for host in ['Ec', 'Sc']:\n        for aa, codons in aa_to_codons.items():\n            max_f = max(f_weights[host][c] for c in codons)\n            f_max_weights[host][aa] = max_f\n\n    # --- Main Logic ---\n    all_results = []\n    for dna_sequence in test_cases:\n        # 1. Parse DNA sequence into codons\n        codons = [dna_sequence[i:i+3] for i in range(0, len(dna_sequence), 3)]\n        \n        e_values = {}\n        bottleneck_values = {}\n\n        for host in ['Ec', 'Sc']:\n            sum_inv_f_actual = 0.0\n            sum_inv_f_optimal = 0.0\n            inv_f_values_per_pos = []\n\n            # 2. Calculate sums and collect inverse frequencies\n            for codon in codons:\n                aa = codon_to_aa[codon]\n                \n                f_actual = f_weights[host][codon]\n                f_optimal = f_max_weights[host][aa]\n\n                inv_f_actual = 1.0 / f_actual\n                inv_f_optimal = 1.0 / f_optimal\n\n                sum_inv_f_actual += inv_f_actual\n                sum_inv_f_optimal += inv_f_optimal\n                inv_f_values_per_pos.append(inv_f_actual)\n\n            # 3. Compute efficiency E_h\n            if sum_inv_f_actual == 0:\n                 # This case should not happen with valid positive frequencies\n                 e_h = 0.0\n            else:\n                 e_h = sum_inv_f_optimal / sum_inv_f_actual\n            e_values[host] = e_h\n            \n            # 4. Identify bottleneck positions\n            if not inv_f_values_per_pos:\n                bottlenecks = []\n            else:\n                max_inv_f = max(inv_f_values_per_pos)\n                # Use a tolerance for float comparison to be robust\n                bottlenecks = [\n                    i + 1 for i, val in enumerate(inv_f_values_per_pos)\n                    if np.isclose(val, max_inv_f)\n                ]\n            bottleneck_values[host] = bottlenecks\n\n        # 5. Compute cross-host ratio R\n        e_ec = e_values['Ec']\n        e_sc = e_values['Sc']\n        \n        if e_sc == 0:\n            # Handle division by zero case\n            ratio_r = 0.0\n        else:\n            ratio_r = e_ec / e_sc\n\n        # 6. Format results for the current test case\n        case_result = [\n            round(e_ec, 6),\n            round(e_sc, 6),\n            round(ratio_r, 6),\n            bottleneck_values['Ec'],\n            bottleneck_values['Sc']\n        ]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list in Python produces the required format `[...]`.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2732911"}, {"introduction": "Beyond expressing single proteins, synthetic biology aims to engineer complex multi-enzyme pathways for producing valuable molecules. The overall productivity of such a pathway is governed by its rate-limiting step, a bottleneck determined by both intrinsic enzyme kinetics and host-dependent expression levels. This problem [@problem_id:2732893] guides you through a first-principles analysis to calculate the maximum theoretical flux of a heterologous pathway in *E. coli* and *S. cerevisiae*, revealing how differences in protein expression capacity can dictate which enzymatic step becomes the bottleneck.", "problem": "A heterologous, linear, irreversible, $3$-step pathway $S \\xrightarrow{E_{1}} I_{1} \\xrightarrow{E_{2}} I_{2} \\xrightarrow{E_{3}} P$ is implemented in both Escherichia coli and Saccharomyces cerevisiae as chassis organisms. Each step is catalyzed by a distinct monomeric enzyme $E_{i}$ with turnover number $k_{\\text{cat},i}$ and Michaelis constant $K_{m,i}$ that are intrinsic to the enzyme and identical across chassis. Host-specific expression levels differ and are given as enzyme copy numbers (molecules per cell). Assume:\n- All steps are effectively irreversible on the timescale of interest and there are no branches or bypass reactions.\n- Protein expression leads to active, properly folded enzyme unless otherwise noted.\n- Intracellular substrate concentrations for each step are maintained by upstream design at $[S_{i}] = 10\\,K_{m,i}$ in both chassis.\n- Cell-to-cell variation is negligible; consider a representative cell.\n\nEnzyme kinetic parameters (identical in both chassis):\n- Step $1$: $k_{\\text{cat},1} = 50\\,\\text{s}^{-1}$, $K_{m,1} = 50\\,\\mu\\text{M}$.\n- Step $2$: $k_{\\text{cat},2} = 25\\,\\text{s}^{-1}$, $K_{m,2} = 20\\,\\mu\\text{M}$.\n- Step $3$: $k_{\\text{cat},3} = 100\\,\\text{s}^{-1}$, $K_{m,3} = 10\\,\\mu\\text{M}$.\n\nHost-specific active enzyme copy numbers (molecules per cell):\n- Escherichia coli: $n_{1}^{(\\text{Ec})} = 5.0 \\times 10^{3}$, $n_{2}^{(\\text{Ec})} = 8.0 \\times 10^{3}$, $n_{3}^{(\\text{Ec})} = 2.0 \\times 10^{3}$.\n- Saccharomyces cerevisiae: $n_{1}^{(\\text{Sc})} = 1.5 \\times 10^{4}$, $n_{2}^{(\\text{Sc})} = 3.0 \\times 10^{3}$, $n_{3}^{(\\text{Sc})} = 5.0 \\times 10^{3}$. Due to partial misfolding in Saccharomyces cerevisiae, only a fraction $f_{2}^{(\\text{Sc})} = 0.80$ of $E_{2}$ is active; all other enzymes are fully active.\n\nStarting from the foundational Michaelis–Menten description of catalysis and basic molecular counting (Avogadro’s constant), and without invoking any unsubstantiated shortcuts, compute the steady-state per-cell pathway flux for each chassis under the given conditions and identify the rate-limiting step(s) in each chassis by first principles. Then, report as your final answer the ratio of the predicted steady-state per-cell flux in Escherichia coli to that in Saccharomyces cerevisiae, expressed as a single exact fraction with no units. Do not round; provide the exact value.", "solution": "The problem statement is subjected to validation before any solution is attempted.\n\n**Step 1: Extracted Givens**\n- Pathway: A heterologous, linear, irreversible, $3$-step pathway $S \\xrightarrow{E_{1}} I_{1} \\xrightarrow{E_{2}} I_{2} \\xrightarrow{E_{3}} P$.\n- Chassis Organisms: *Escherichia coli* and *Saccharomyces cerevisiae*.\n- Enzyme Properties: $E_{i}$ are distinct monomeric enzymes. $k_{\\text{cat},i}$ and $K_{m,i}$ are intrinsic and identical across chassis.\n- Substrate Condition: For each step $i$, the substrate concentration is maintained at $[S_{i}] = 10\\,K_{m,i}$.\n- Assumptions: No side reactions, perfect protein expression and folding unless specified, negligible cell-to-cell variation.\n- Kinetic Parameters (identical in both chassis):\n    - Step $1$: $k_{\\text{cat},1} = 50\\,\\text{s}^{-1}$, $K_{m,1} = 50\\,\\mu\\text{M}$.\n    - Step $2$: $k_{\\text{cat},2} = 25\\,\\text{s}^{-1}$, $K_{m,2} = 20\\,\\mu\\text{M}$.\n    - Step $3$: $k_{\\text{cat},3} = 100\\,\\text{s}^{-1}$, $K_{m,3} = 10\\,\\mu\\text{M}$.\n- Host-Specific Enzyme Copy Numbers (molecules per cell):\n    - *E. coli*: $n_{1}^{(\\text{Ec})} = 5.0 \\times 10^{3}$, $n_{2}^{(\\text{Ec})} = 8.0 \\times 10^{3}$, $n_{3}^{(\\text{Ec})} = 2.0 \\times 10^{3}$.\n    - *S. cerevisiae*: $n_{1}^{(\\text{Sc})} = 1.5 \\times 10^{4}$, $n_{2}^{(\\text{Sc})} = 3.0 \\times 10^{3}$, $n_{3}^{(\\text{Sc})} = 5.0 \\times 10^{3}$.\n- Enzyme Activity Fraction: In *S. cerevisiae*, only a fraction $f_{2}^{(\\text{Sc})} = 0.80$ of enzyme $E_{2}$ is active. All other enzymes are fully active ($f=1$).\n\n**Step 2: Validation**\nThe problem is scientifically grounded, being based on standard Michaelis-Menten kinetics and concepts from synthetic biology. It is well-posed, providing all necessary parameters for a unique solution. The language is objective and precise. The condition that $[S_i] = 10\\,K_{m,i}$ for each step is a strong idealization. In a simple unregulated linear pathway, intermediate concentrations would adjust to equalize step fluxes. However, the problem explicitly states this is a maintained condition achieved by \"upstream design.\" This is a valid simplifying constraint within the context of synthetic biology, where such regulation is conceivable, and it serves to make the problem tractable by focusing the analysis on calculating and comparing the maximum potential flux of each step. The problem is therefore deemed valid.\n\n**Step 3: Solution**\nThe solution will be derived from first principles as required.\n\nThe rate of an enzymatic reaction $i$, denoted as the volumetric flux $v_i$ (in units of molar concentration per time), is described by the Michaelis-Menten equation:\n$$v_i = \\frac{k_{\\text{cat},i} [E_T]_i [S_i]}{K_{m,i} + [S_i]}$$\nwhere $[E_T]_i$ is the total concentration of active enzyme $i$, and $[S_i]$ is the concentration of its substrate.\n\nThe problem specifies that for each step, $[S_i] = 10\\,K_{m,i}$. Substituting this condition into the equation gives the specific volumetric flux under these saturating conditions:\n$$v_i = \\frac{k_{\\text{cat},i} [E_T]_i (10\\,K_{m,i})}{K_{m,i} + 10\\,K_{m,i}} = \\frac{10\\,k_{\\text{cat},i} [E_T]_i K_{m,i}}{11\\,K_{m,i}} = \\frac{10}{11} k_{\\text{cat},i} [E_T]_i$$\nThis volumetric flux has units of moles per liter per second. The problem requires the per-cell flux, $J_i$, in units of molecules per cell per second. To convert, we must multiply the volumetric flux by the cell volume, $V_{\\text{cell}}$, and Avogadro's constant, $N_A$:\n$$J_i = v_i \\cdot V_{\\text{cell}} \\cdot N_A$$\nThe enzyme concentration $[E_T]_i$ is related to the number of active enzyme molecules per cell, $n_{i, \\text{active}}$, by:\n$$[E_T]_i = \\frac{n_{i, \\text{active}}}{N_A \\cdot V_{\\text{cell}}}$$\nSubstituting the expressions for $v_i$ and $[E_T]_i$ into the equation for $J_i$:\n$$J_i = \\left(\\frac{10}{11} k_{\\text{cat},i} \\frac{n_{i, \\text{active}}}{N_A \\cdot V_{\\text{cell}}}\\right) \\cdot V_{\\text{cell}} \\cdot N_A$$\nThe terms for cell volume $V_{\\text{cell}}$ and Avogadro's constant $N_A$ cancel, yielding a direct relationship for the per-cell flux of step $i$:\n$$J_i = \\frac{10}{11} k_{\\text{cat},i} n_{i, \\text{active}}$$\nThis represents the catalytic capacity of each step under the given substrate saturation. For a linear irreversible pathway, the overall steady-state flux, $J_{\\text{pathway}}$, is governed by the step with the lowest capacity, known as the rate-limiting step or bottleneck.\n$$J_{\\text{pathway}} = \\min(J_1, J_2, J_3)$$\n\nWe now compute the step capacities for each chassis.\n\n**Analysis for *Escherichia coli***\nIn this chassis, all enzymes are fully active, so $n_{i, \\text{active}}^{(\\text{Ec})} = n_i^{(\\text{Ec})}$.\nThe step capacities are:\n$J_{1}^{(\\text{Ec})} = \\frac{10}{11} k_{\\text{cat},1} n_{1}^{(\\text{Ec})} = \\frac{10}{11} (50) (5.0 \\times 10^{3}) = \\frac{10}{11} (250 \\times 10^{3}) = \\frac{2500 \\times 10^{3}}{11}$ molecules cell$^{-1}$ s$^{-1}$.\n$J_{2}^{(\\text{Ec})} = \\frac{10}{11} k_{\\text{cat},2} n_{2}^{(\\text{Ec})} = \\frac{10}{11} (25) (8.0 \\times 10^{3}) = \\frac{10}{11} (200 \\times 10^{3}) = \\frac{2000 \\times 10^{3}}{11}$ molecules cell$^{-1}$ s$^{-1}$.\n$J_{3}^{(\\text{Ec})} = \\frac{10}{11} k_{\\text{cat},3} n_{3}^{(\\text{Ec})} = \\frac{10}{11} (100) (2.0 \\times 10^{3}) = \\frac{10}{11} (200 \\times 10^{3}) = \\frac{2000 \\times 10^{3}}{11}$ molecules cell$^{-1}$ s$^{-1}$.\n\nComparing these values, the minimum capacity is $\\frac{2000 \\times 10^{3}}{11}$.\nTherefore, the steady-state pathway flux in *E. coli* is:\n$$J^{(\\text{Ec})} = \\min(J_{1}^{(\\text{Ec})}, J_{2}^{(\\text{Ec})}, J_{3}^{(\\text{Ec})}) = \\frac{2000 \\times 10^{3}}{11} \\text{ molecules cell}^{-1} \\text{ s}^{-1}$$\nThe rate-limiting steps are step $2$ and step $3$, which are co-limiting as they have identical and minimal capacities.\n\n**Analysis for *Saccharomyces cerevisiae***\nIn this chassis, enzyme $E_2$ is only partially active. The number of active $E_2$ molecules is:\n$n_{2, \\text{active}}^{(\\text{Sc})} = n_{2}^{(\\text{Sc})} \\cdot f_{2}^{(\\text{Sc})} = (3.0 \\times 10^{3}) \\cdot (0.80) = 2.4 \\times 10^{3}$.\nEnzymes $E_1$ and $E_3$ are fully active: $n_{1, \\text{active}}^{(\\text{Sc})} = n_{1}^{(\\text{Sc})} = 1.5 \\times 10^{4}$ and $n_{3, \\text{active}}^{(\\text{Sc})} = n_{3}^{(\\text{Sc})} = 5.0 \\times 10^{3}$.\n\nThe step capacities are:\n$J_{1}^{(\\text{Sc})} = \\frac{10}{11} k_{\\text{cat},1} n_{1, \\text{active}}^{(\\text{Sc})} = \\frac{10}{11} (50) (1.5 \\times 10^{4}) = \\frac{10}{11} (75 \\times 10^{4}) = \\frac{7500 \\times 10^{3}}{11}$ molecules cell$^{-1}$ s$^{-1}$.\n$J_{2}^{(\\text{Sc})} = \\frac{10}{11} k_{\\text{cat},2} n_{2, \\text{active}}^{(\\text{Sc})} = \\frac{10}{11} (25) (2.4 \\times 10^{3}) = \\frac{10}{11} (60 \\times 10^{3}) = \\frac{600 \\times 10^{3}}{11}$ molecules cell$^{-1}$ s$^{-1}$.\n$J_{3}^{(\\text{Sc})} = \\frac{10}{11} k_{\\text{cat},3} n_{3, \\text{active}}^{(\\text{Sc})} = \\frac{10}{11} (100) (5.0 \\times 10^{3}) = \\frac{10}{11} (500 \\times 10^{3}) = \\frac{5000 \\times 10^{3}}{11}$ molecules cell$^{-1}$ s$^{-1}$.\n\nComparing these values, the minimum capacity is $\\frac{600 \\times 10^{3}}{11}$.\nTherefore, the steady-state pathway flux in *S. cerevisiae* is:\n$$J^{(\\text{Sc})} = \\min(J_{1}^{(\\text{Sc})}, J_{2}^{(\\text{Sc})}, J_{3}^{(\\text{Sc})}) = \\frac{600 \\times 10^{3}}{11} \\text{ molecules cell}^{-1} \\text{ s}^{-1}$$\nThe rate-limiting step is step $2$.\n\n**Final Calculation**\nThe problem requests the ratio of the steady-state per-cell flux in *E. coli* to that in *S. cerevisiae*.\n$$ \\text{Ratio} = \\frac{J^{(\\text{Ec})}}{J^{(\\text{Sc})}} = \\frac{\\frac{2000 \\times 10^{3}}{11}}{\\frac{600 \\times 10^{3}}{11}} $$\nThe common factors of $\\frac{10^3}{11}$ cancel:\n$$ \\text{Ratio} = \\frac{2000}{600} = \\frac{20}{6} = \\frac{10}{3} $$\nThis is the final answer as an exact fraction.", "answer": "$$\\boxed{\\frac{10}{3}}$$", "id": "2732893"}, {"introduction": "Choosing the optimal chassis for a bioproduction task is a critical, multi-faceted engineering decision that extends beyond simple growth rates or expression titers. This final practice introduces a powerful framework, Multi-Criteria Decision Analysis (MCDA), to formalize this complex choice into a quantitative model [@problem_id:2732948]. By assigning weights to critical product requirements like post-translational modification, secretion, and solvent tolerance, you will learn to systematically score and compare *E. coli* and *S. cerevisiae*, demonstrating a rational approach to chassis selection in synthetic biology.", "problem": "You are to design and implement a quantitative decision model that compares two microbial chassis, Escherichia coli and Saccharomyces cerevisiae, for a target product that requires three capabilities: N-glycosylation, secretion, and tolerance to a neutral organic solvent present at concentration $c$ expressed in $\\mathrm{mol/L}$. The decision model must be constructed from first principles of multi-criteria decision making and dose-response inhibition, and then used to compute the preferred chassis as a function of $c$.\n\nFoundational base:\n- Use the definition of a weighted-sum Multi-Criteria Decision Analysis (MCDA): given normalized criteria $x_i \\in [0,1]$ and nonnegative weights $w_i$ that reflect importance and sum to $1$, the overall score is $S = \\sum_i w_i x_i$.\n- Model solvent-limited performance by a Hill-type inhibition function (a standard dose-response relationship): for concentration $c \\ge 0$, the fractional performance is $p(c) = \\dfrac{1}{1 + (c/IC_{50})^h}$, where $IC_{50}$ is the characteristic concentration that yields half-maximal performance and $h \\ge 1$ is the Hill coefficient controlling steepness.\n\nDesign requirements:\n- Define three normalized criteria for each chassis: N-glycosylation capability $g \\in [0,1]$, baseline secretion efficiency $s_0 \\in [0,1]$, and solvent-limited viability/productivity $p(c) \\in (0,1]$ computed by the Hill function. Secretion under solvent is impacted multiplicatively by solvent-limited performance, so the effective secretion criterion is $s(c) = s_0 \\cdot p(c)$.\n- Construct a score $S_{\\text{chassis}}(c)$ as a weighted sum of criteria reflecting the importance of N-glycosylation, secretion, and tolerance, with weights $w_g$, $w_s$, and $w_t$ respectively, satisfying $w_g + w_s + w_t = 1$ and each $w_i \\ge 0$.\n- Use scientifically plausible parameter values for Escherichia coli and Saccharomyces cerevisiae as follows:\n  - Weights: $w_g = 0.5$, $w_s = 0.3$, $w_t = 0.2$.\n  - Glycosylation capabilities: for Escherichia coli, $g_{\\mathrm{Ec}} = 0.15$; for Saccharomyces cerevisiae, $g_{\\mathrm{Sc}} = 0.9$.\n  - Baseline secretion efficiencies: for Escherichia coli, $s_{0,\\mathrm{Ec}} = 0.3$; for Saccharomyces cerevisiae, $s_{0,\\mathrm{Sc}} = 0.85$.\n  - Solvent tolerance parameters (ethanol-like solvent): for Escherichia coli, $IC_{50,\\mathrm{Ec}} = 0.8\\ \\mathrm{mol/L}$; for Saccharomyces cerevisiae, $IC_{50,\\mathrm{Sc}} = 2.5\\ \\mathrm{mol/L}$. Use a common Hill coefficient $h = 2$ for both.\n- Define the preferred chassis at a given $c$ as the one with strictly larger score $S_{\\text{chassis}}(c)$. If the scores are equal up to a small numerical tolerance $\\epsilon = 10^{-12}$, consider this a tie.\n\nTask:\n1. Derive a mathematically consistent expression for $S_{\\mathrm{Ec}}(c)$ and $S_{\\mathrm{Sc}}(c)$ from the foundational base above and the provided parameters.\n2. Implement a program that evaluates the preferred chassis for each $c$ in the test suite below, returning integer codes: $0$ for Escherichia coli, $1$ for Saccharomyces cerevisiae, and $2$ for a tie.\n\nTest suite (express all concentrations in $\\mathrm{mol/L}$):\n- $c = 0.0$\n- $c = 0.5$\n- $c = 1.0$\n- $c = 2.0$\n- $c = 3.0$\n- $c = 4.0$\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the test suite as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_6]$), where each $r_i$ is an integer code as defined above. No additional text should be printed.", "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and objective. It provides a self-contained and consistent set of definitions, models, and parameters to construct a quantitative decision model for microbial chassis selection in a synthetic biology context. The problem is formalizable and requires the application of established principles. Therefore, a complete solution is warranted.\n\nThe core of the problem is to compare two microbial chassis, *Escherichia coli* (Ec) and *Saccharomyces cerevisiae* (Sc), based on a multi-criteria decision analysis (MCDA) score, $S_{\\text{chassis}}(c)$, which is a function of the solvent concentration $c$. The preferred chassis is the one with the higher score.\n\nFirst, we establish the general mathematical framework based on the provided specifications. The performance of each chassis is limited by the solvent concentration $c$ according to a Hill-type inhibition function:\n$$p_{\\text{chassis}}(c) = \\frac{1}{1 + (c/IC_{50, \\text{chassis}})^h}$$\nwhere $IC_{50, \\text{chassis}}$ is the half-maximal inhibitory concentration for the given chassis and $h$ is the Hill coefficient.\n\nThe overall score $S_{\\text{chassis}}(c)$ is a weighted sum of three criteria: N-glycosylation ($g$), secretion ($s(c)$), and solvent tolerance, which is represented by the performance function $p(c)$ itself. The weights are given as $w_g$, $w_s$, and $w_t$. The effective secretion criterion $s(c)$ is the baseline secretion efficiency $s_0$ modulated by the solvent tolerance, i.e., $s(c) = s_0 \\cdot p(c)$.\n\nThe score function is thus defined as:\n$$S_{\\text{chassis}}(c) = w_g g_{\\text{chassis}} + w_s s_{\\text{chassis}}(c) + w_t p_{\\text{chassis}}(c)$$\nSubstituting $s_{\\text{chassis}}(c) = s_{0, \\text{chassis}} \\cdot p_{\\text{chassis}}(c)$, we get:\n$$S_{\\text{chassis}}(c) = w_g g_{\\text{chassis}} + w_s s_{0, \\text{chassis}} p_{\\text{chassis}}(c) + w_t p_{\\text{chassis}}(c)$$\nThis expression can be rearranged by factoring out the performance function $p_{\\text{chassis}}(c)$:\n$$S_{\\text{chassis}}(c) = w_g g_{\\text{chassis}} + (w_s s_{0, \\text{chassis}} + w_t) p_{\\text{chassis}}(c)$$\nThis general formula represents the decision score for any chassis defined by the parameters $g$, $s_0$, and $IC_{50}$.\n\nNext, we derive the specific score functions for *E. coli* and *S. cerevisiae* using the provided parameter values:\nCommon weights: $w_g = 0.5$, $w_s = 0.3$, $w_t = 0.2$.\nCommon Hill coefficient: $h = 2$.\n\nFor *Escherichia coli* (Ec):\n- N-glycosylation capability: $g_{\\mathrm{Ec}} = 0.15$\n- Baseline secretion efficiency: $s_{0,\\mathrm{Ec}} = 0.3$\n- Solvent tolerance: $IC_{50,\\mathrm{Ec}} = 0.8\\ \\mathrm{mol/L}$\n\nThe performance function for *E. coli* is:\n$$p_{\\mathrm{Ec}}(c) = \\frac{1}{1 + (c/0.8)^2}$$\nSubstituting the parameters into the general score formula:\n$$S_{\\mathrm{Ec}}(c) = (0.5 \\cdot 0.15) + (0.3 \\cdot 0.3 + 0.2) p_{\\mathrm{Ec}}(c)$$\n$$S_{\\mathrm{Ec}}(c) = 0.075 + (0.09 + 0.2) p_{\\mathrm{Ec}}(c)$$\n$$S_{\\mathrm{Ec}}(c) = 0.075 + 0.29 \\cdot p_{\\mathrm{Ec}}(c)$$\n\nFor *Saccharomyces cerevisiae* (Sc):\n- N-glycosylation capability: $g_{\\mathrm{Sc}} = 0.9$\n- Baseline secretion efficiency: $s_{0,\\mathrm{Sc}} = 0.85$\n- Solvent tolerance: $IC_{50,\\mathrm{Sc}} = 2.5\\ \\mathrm{mol/L}$\n\nThe performance function for *S. cerevisiae* is:\n$$p_{\\mathrm{Sc}}(c) = \\frac{1}{1 + (c/2.5)^2}$$\nSubstituting the parameters into the general score formula:\n$$S_{\\mathrm{Sc}}(c) = (0.5 \\cdot 0.9) + (0.3 \\cdot 0.85 + 0.2) p_{\\mathrm{Sc}}(c)$$\n$$S_{\\mathrm{Sc}}(c) = 0.45 + (0.255 + 0.2) p_{\\mathrm{Sc}}(c)$$\n$$S_{\\mathrm{Sc}}(c) = 0.45 + 0.455 \\cdot p_{\\mathrm{Sc}}(c)$$\n\nWith the specific score functions derived, we can now compare the two chassis. The decision depends on the sign of the difference $S_{\\mathrm{Sc}}(c) - S_{\\mathrm{Ec}}(c)$. A key observation can be made by analyzing the range of possible scores for each chassis.\nThe performance function $p(c)$ is always in the range $(0, 1]$ for $c \\ge 0$, with $p(c) = 1$ at $c = 0$ and $p(c) \\to 0$ as $c \\to \\infty$.\n\nFor *E. coli*, the maximum score occurs at $c=0$, where $p_{\\mathrm{Ec}}(0)=1$:\n$$\\max(S_{\\mathrm{Ec}}(c)) = S_{\\mathrm{Ec}}(0) = 0.075 + 0.29 \\cdot 1 = 0.365$$\nThe minimum score is approached as $c \\to \\infty$, where $p_{\\mathrm{Ec}}(c) \\to 0$:\n$$\\inf(S_{\\mathrm{Ec}}(c)) = 0.075$$\nTherefore, for all $c \\ge 0$, the score for *E. coli* is bounded: $0.075 < S_{\\mathrm{Ec}}(c) \\le 0.365$.\n\nFor *S. cerevisiae*, the maximum score occurs at $c=0$, where $p_{\\mathrm{Sc}}(0)=1$:\n$$\\max(S_{\\mathrm{Sc}}(c)) = S_{\\mathrm{Sc}}(0) = 0.45 + 0.455 \\cdot 1 = 0.905$$\nThe minimum score is approached as $c \\to \\infty$, where $p_{\\mathrm{Sc}}(c) \\to 0$:\n$$\\inf(S_{\\mathrm{Sc}}(c)) = 0.45$$\nTherefore, for all $c \\ge 0$, the score for *S. cerevisiae* is bounded: $0.45 < S_{\\mathrm{Sc}}(c) \\le 0.905$.\n\nComparing the bounds, we find that the minimum possible score for *S. cerevisiae* ($> 0.45$) is strictly greater than the maximum possible score for *E. coli* ($\\le 0.365$).\n$$S_{\\mathrm{Sc}}(c) > 0.45 > 0.365 \\ge S_{\\mathrm{Ec}}(c) \\quad \\forall c \\ge 0$$\nThe difference $S_{\\mathrm{Sc}}(c) - S_{\\mathrm{Ec}}(c)$ is always positive and significantly larger than the specified numerical tolerance of $\\epsilon = 10^{-12}$.\nThus, *Saccharomyces cerevisiae* is strictly the preferred chassis for all possible non-negative solvent concentrations $c$.\n\nThis conclusion applies directly to the entire test suite ($c \\in \\{0.0, 0.5, 1.0, 2.0, 3.0, 4.0\\}$). For every value of $c$ provided, the score for *S. cerevisiae* will be higher. The decision code for *S. cerevisiae* is $1$. Therefore, the expected result for all test cases is $1$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a quantitative decision model to compare E. coli and S. cerevisiae\n    as microbial chassis for a target product, based on a multi-criteria score.\n    \"\"\"\n\n    # --- Problem Parameters ---\n\n    # Weights for the Multi-Criteria Decision Analysis (MCDA)\n    weights = {'g': 0.5, 's': 0.3, 't': 0.2}\n\n    # Parameters for Escherichia coli (Ec)\n    params_ec = {\n        'g': 0.15,      # Glycosylation capability\n        's0': 0.3,      # Baseline secretion efficiency\n        'IC50': 0.8     # Solvent tolerance (mol/L)\n    }\n\n    # Parameters for Saccharomyces cerevisiae (Sc)\n    params_sc = {\n        'g': 0.9,       # Glycosylation capability\n        's0': 0.85,     # Baseline secretion efficiency\n        'IC50': 2.5     # Solvent tolerance (mol/L)\n    }\n\n    # Common Hill coefficient for solvent inhibition\n    h = 2.0\n\n    # Numerical tolerance for score comparison\n    epsilon = 1e-12\n\n    # Test suite of solvent concentrations in mol/L\n    c_values = [0.0, 0.5, 1.0, 2.0, 3.0, 4.0]\n\n    # --- Model Implementation ---\n\n    def calculate_score(c, params, weights, h_coeff):\n        \"\"\"\n        Calculates the MCDA score for a given chassis at a solvent concentration c.\n        \n        The score S is defined as:\n        S(c) = w_g*g + w_s*s(c) + w_t*p(c)\n             = w_g*g + w_s*s0*p(c) + w_t*p(c)\n             = w_g*g + (w_s*s0 + w_t)*p(c)\n        \n        where p(c) is the Hill-type inhibition function:\n        p(c) = 1 / (1 + (c / IC50)^h)\n        \"\"\"\n        # Unpack parameters\n        g = params['g']\n        s0 = params['s0']\n        ic50 = params['IC50']\n        \n        w_g = weights['g']\n        w_s = weights['s']\n        w_t = weights['t']\n\n        # Calculate the solvent-limited performance p(c)\n        if c  0:\n            # Concentration must be non-negative\n            performance = 0.0\n        else:\n            # Avoid division by zero if IC50 is 0\n            if ic50 > 0:\n                performance = 1.0 / (1.0 + (c / ic50)**h_coeff)\n            else:\n                performance = 0.0 if c > 0 else 1.0\n\n        # Calculate the final score\n        score = w_g * g + (w_s * s0 + w_t) * performance\n        return score\n\n    results = []\n    for c in c_values:\n        # Calculate scores for both chassis\n        score_ec = calculate_score(c, params_ec, weights, h)\n        score_sc = calculate_score(c, params_sc, weights, h)\n\n        # Compare scores and decide the preferred chassis\n        # Code 0: E. coli\n        # Code 1: S. cerevisiae\n        # Code 2: Tie\n        if abs(score_ec - score_sc) = epsilon:\n            results.append(2)  # Tie\n        elif score_ec > score_sc:\n            results.append(0)  # E. coli is preferred\n        else:\n            results.append(1)  # S. cerevisiae is preferred\n\n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2732948"}]}