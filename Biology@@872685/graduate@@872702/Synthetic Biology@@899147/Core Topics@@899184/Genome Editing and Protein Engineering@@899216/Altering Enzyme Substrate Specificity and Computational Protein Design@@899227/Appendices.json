{"hands_on_practices": [{"introduction": "A primary goal of computational enzyme design is to enhance catalytic activity. According to transition state theory, this is achieved by designing an active site that provides greater stabilization to the reaction's transition state, thereby lowering the free energy of activation, $\\Delta G^{\\ddagger}$. This foundational exercise demonstrates the direct quantitative relationship between a change in activation free energy and the resulting fold-change in catalytic efficiency, $k_{\\text{cat}}/K_M$, providing a crucial link between computational energy predictions and observable kinetics [@problem_id:2713840].", "problem": "In a computational protein design campaign to alter substrate specificity, you engineer a single amino acid substitution in an enzyme’s active site to preferentially stabilize the transition state of a non-native substrate $S_2$. The design model predicts a change in activation free energy for the rate-limiting step of catalysis for $S_2$ of $\\Delta\\Delta G^{\\ddagger} = \\Delta G^{\\ddagger}_{\\text{mut}} - \\Delta G^{\\ddagger}_{\\text{wt}} = -1.80~\\text{kcal}\\cdot\\text{mol}^{-1}$ at temperature $T = 298~\\text{K}$. Assume that ground-state binding is unchanged so that the Michaelis constant $K_M$ is unaffected by the mutation for $S_2$. Using transition state theory and standard thermodynamic-statistical reasoning, determine the expected fold-change in catalytic efficiency $k_{\\text{cat}}/K_M$ for $S_2$ between mutant and wild type. Use the gas constant $R = 1.987 \\times 10^{-3}~\\text{kcal}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$. Express your answer as a dimensionless fold-change and round to three significant figures.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\nStep 1: Extract Givens.\n- The system involves a wild-type enzyme (wt) and a mutant enzyme (mut).\n- The substrate of interest is a non-native substrate, denoted $S_2$.\n- The change in activation free energy for the rate-limiting step of catalysis for $S_2$ is given as $\\Delta\\Delta G^{\\ddagger} = \\Delta G^{\\ddagger}_{\\text{mut}} - \\Delta G^{\\ddagger}_{\\text{wt}} = -1.80~\\text{kcal}\\cdot\\text{mol}^{-1}$.\n- The temperature is constant at $T = 298~\\text{K}$.\n- An explicit assumption is provided: the Michaelis constant $K_M$ is unaffected by the mutation for substrate $S_2$.\n- The value of the gas constant is $R = 1.987 \\times 10^{-3}~\\text{kcal}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$.\n- The objective is to determine the dimensionless fold-change in catalytic efficiency, $\\frac{k_{\\text{cat}}}{K_M}$, for the mutant relative to the wild type, rounded to three significant figures.\n\nStep 2: Validate Using Extracted Givens.\n- Scientific Grounding: The problem is fundamentally based on transition state theory and Michaelis-Menten enzyme kinetics, which are cornerstones of physical chemistry and biochemistry. The scenario, altering enzyme specificity through mutation, is a primary goal of computational protein design and synthetic biology. The provided numerical values for energy, temperature, and the gas constant are physically realistic and consistent. The problem is scientifically sound.\n- Well-Posedness: The problem is well-posed. It asks for a specific, calculable quantity (fold-change in catalytic efficiency) and provides all necessary data and a key simplifying assumption ($\\Delta K_M = 0$) to arrive at a unique solution.\n- Objectivity: The problem is stated in precise, objective, and quantitative terms, free of any subjective or ambiguous language.\n\nStep 3: Verdict and Action.\nThe problem is valid. It is a standard, well-defined problem in biophysical chemistry that can be solved using established principles. We will now proceed with the solution.\n\nThe core of the problem lies in the relationship between the rate constant of a reaction and its activation free energy, as described by transition state theory. For an enzymatic reaction, the catalytic rate constant, $k_{\\text{cat}}$, is related to the activation free energy of the rate-limiting step, $\\Delta G^{\\ddagger}$, by the Eyring equation:\n$$ k_{\\text{cat}} = \\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{RT}\\right) $$\nwhere $\\kappa$ is the transmission coefficient (often assumed to be $1$), $k_B$ is the Boltzmann constant, $h$ is the Planck constant, $R$ is the gas constant, and $T$ is the absolute temperature. For our purposes, the pre-exponential factor $\\kappa \\frac{k_B T}{h}$ can be treated as a constant, $A$.\n$$ k_{\\text{cat}} = A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{RT}\\right) $$\nWe are asked to find the fold-change in catalytic efficiency, which is defined as the ratio of the catalytic efficiency of the mutant enzyme to that of the wild-type enzyme.\n$$ \\text{Fold-change} = \\frac{(k_{\\text{cat}}/K_M)_{\\text{mut}}}{(k_{\\text{cat}}/K_M)_{\\text{wt}}} $$\nThe problem explicitly states that the ground-state binding is unchanged, which implies that the Michaelis constant, $K_M$, is the same for both the wild-type and mutant enzymes with respect to substrate $S_2$. That is, $(K_M)_{\\text{mut}} = (K_M)_{\\text{wt}}$. Therefore, the $K_M$ terms cancel out in the expression for the fold-change:\n$$ \\text{Fold-change} = \\frac{(k_{\\text{cat}})_{\\text{mut}}}{(k_{\\text{cat}})_{\\text{wt}}} $$\nNow, we substitute the expression for $k_{\\text{cat}}$ from transition state theory for both the mutant and wild-type enzymes.\n$$ \\text{Fold-change} = \\frac{A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}_{\\text{mut}}}{RT}\\right)}{A \\exp\\left(-\\frac{\\Delta G^{\\ddagger}_{\\text{wt}}}{RT}\\right)} $$\nThe pre-exponential factor $A$ cancels, and we can combine the exponential terms:\n$$ \\text{Fold-change} = \\exp\\left(-\\frac{\\Delta G^{\\ddagger}_{\\text{mut}}}{RT} + \\frac{\\Delta G^{\\ddagger}_{\\text{wt}}}{RT}\\right) $$\n$$ \\text{Fold-change} = \\exp\\left(-\\frac{\\Delta G^{\\ddagger}_{\\text{mut}} - \\Delta G^{\\ddagger}_{\\text{wt}}}{RT}\\right) $$\nThe term in the numerator of the exponent is the given change in activation free energy, $\\Delta\\Delta G^{\\ddagger}$.\n$$ \\text{Fold-change} = \\exp\\left(-\\frac{\\Delta\\Delta G^{\\ddagger}}{RT}\\right) $$\nWe now substitute the provided numerical values into this expression.\nGiven:\n- $\\Delta\\Delta G^{\\ddagger} = -1.80~\\text{kcal}\\cdot\\text{mol}^{-1}$\n- $R = 1.987 \\times 10^{-3}~\\text{kcal}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$\n- $T = 298~\\text{K}$\n\nFirst, we calculate the value of the exponent:\n$$ -\\frac{\\Delta\\Delta G^{\\ddagger}}{RT} = -\\frac{-1.80~\\text{kcal}\\cdot\\text{mol}^{-1}}{(1.987 \\times 10^{-3}~\\text{kcal}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1})(298~\\text{K})} $$\nThe units cancel out as required for the argument of an exponential function.\n$$ \\text{Exponent} = \\frac{1.80}{1.987 \\times 10^{-3} \\times 298} = \\frac{1.80}{0.592126} \\approx 3.04000 $$\nNow, we compute the fold-change:\n$$ \\text{Fold-change} = \\exp(3.04000) \\approx 20.9056 $$\nThe problem requires the answer to be rounded to three significant figures, which is consistent with the precision of the input value $\\Delta\\Delta G^{\\ddagger} = -1.80$.\n$$ \\text{Fold-change} \\approx 20.9 $$\nThe negative sign for $\\Delta\\Delta G^{\\ddagger}$ indicates that the mutation stabilizes the transition state, which is expected to increase the catalytic rate, leading to a fold-change greater than $1$. Our result is consistent with this physical expectation.", "answer": "$$\n\\boxed{20.9}\n$$", "id": "2713840"}, {"introduction": "Beyond enhancing activity for a single substrate, a more common challenge in synthetic biology is to alter an enzyme's selectivity, favoring a desired substrate over a competing one. This requires engineering the active site to differentially stabilize the transition states of the two reactions. This practice introduces a linear free energy relationship (LFER) to model how a specific geometric perturbation—moving a catalytic residue—can be used to quantitatively predict the resulting change in selectivity [@problem_id:2713850].", "problem": "An engineered enzyme is being designed to alter its substrate specificity between two competing substrates, denoted substrate $A$ and substrate $B$. A computational redesign proposes moving a catalytic acid side chain by a displacement $\\Delta x = +0.5\\,\\text{\\AA}$ along the donor–acceptor axis, which increases the hydrogen-bond donor–acceptor distance by $0.5\\,\\text{\\AA}$. Assume the following foundational principles and modeling assumptions rooted in well-tested kinetic and thermodynamic theory:\n\n1. According to Transition State Theory (TST), for each substrate $i \\in \\{A,B\\}$, the catalytic efficiency $k_{\\text{cat}}/K_{M}$ is proportional to $\\exp\\!\\left(-\\Delta G_{i}^{\\ddagger}/(R T)\\right)$, where $\\Delta G_{i}^{\\ddagger}$ is the activation free energy, $R$ is the ideal gas constant, and $T$ is the absolute temperature. Assume that any pre-exponential factor is substrate-independent and remains unchanged by the perturbation considered, so that ratios of catalytic efficiencies are governed by differences in activation free energies.\n2. A linear free energy relationship (LFER) holds between the geometric displacement $x$ and the activation free energy for each substrate $i$, of the form $\\Delta G_{i}^{\\ddagger}(x) = \\Delta G_{i}^{\\ddagger}(0) + m_{i}\\,x$, where $m_{i}$ is a substrate-specific slope. A positive $m_{i}$ means that increasing the donor–acceptor distance raises $\\Delta G_{i}^{\\ddagger}$.\n\nQuantum mechanics/molecular mechanics calibration of the local transition-state hydrogen bond yields substrate-specific slopes $m_{A} = 1.8\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-1}$ and $m_{B} = 0.6\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-1}$. Let the absolute temperature be $T = 298\\,\\text{K}$ and use the ideal gas constant $R = 1.987 \\times 10^{-3}\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n\nDefine the selectivity as the ratio of catalytic efficiencies $\\sigma = \\left(k_{\\text{cat}}/K_{M}\\right)_{A} \\big/ \\left(k_{\\text{cat}}/K_{M}\\right)_{B}$. Compute the fold-change in selectivity $\\sigma_{\\text{new}}/\\sigma_{\\text{old}}$ resulting from the displacement $\\Delta x = +0.5\\,\\text{\\AA}$ under the assumptions above. Express your final answer as a unitless number, rounded to four significant figures.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, and free of contradictions. It presents a standard application of Transition State Theory (TST) and linear free energy relationships (LFERs) to a problem in computational enzyme design. All necessary data are provided. We may therefore proceed with a formal solution.\n\nThe catalytic efficiency for a substrate $i$, where $i \\in \\{A, B\\}$, is given by the ratio $k_{\\text{cat}}/K_{M}$. According to the principles of TST as stated, this efficiency is proportional to an exponential term involving the activation free energy, $\\Delta G_i^\\ddagger$. We can write this relationship as:\n$$ \\left(\\frac{k_{\\text{cat}}}{K_{M}}\\right)_i = C \\exp\\left(-\\frac{\\Delta G_i^\\ddagger}{RT}\\right) $$\nwhere $C$ is a pre-exponential factor, which is assumed to be constant for both substrates and invariant under the specified perturbation. $R$ is the ideal gas constant and $T$ is the absolute temperature.\n\nThe selectivity, $\\sigma$, is defined as the ratio of the catalytic efficiencies for substrate $A$ to substrate $B$:\n$$ \\sigma = \\frac{\\left(k_{\\text{cat}}/K_{M}\\right)_{A}}{\\left(k_{\\text{cat}}/K_{M}\\right)_{B}} $$\nSubstituting the TST expression into this definition, we have:\n$$ \\sigma = \\frac{C \\exp\\left(-\\frac{\\Delta G_A^\\ddagger}{RT}\\right)}{C \\exp\\left(-\\frac{\\Delta G_B^\\ddagger}{RT}\\right)} $$\nThe constant $C$ cancels, which is consistent with the problem's assumptions. Using the properties of exponential functions, this simplifies to:\n$$ \\sigma = \\exp\\left(-\\frac{\\Delta G_A^\\ddagger}{RT} + \\frac{\\Delta G_B^\\ddagger}{RT}\\right) = \\exp\\left(-\\frac{\\Delta G_A^\\ddagger - \\Delta G_B^\\ddagger}{RT}\\right) $$\nThis expression relates selectivity to the difference in activation free energies for the two substrates.\n\nWe are asked to compute the fold-change in selectivity, $\\sigma_{\\text{new}} / \\sigma_{\\text{old}}$, resulting from a displacement $\\Delta x$. The 'old' state corresponds to the initial position, which we can denote by $x=0$, and the 'new' state corresponds to the final position $x=\\Delta x$.\n\nThe selectivity in the old state is:\n$$ \\sigma_{\\text{old}} = \\exp\\left(-\\frac{\\Delta G_A^\\ddagger(0) - \\Delta G_B^\\ddagger(0)}{RT}\\right) $$\nThe selectivity in the new state, after the displacement $\\Delta x$, is:\n$$ \\sigma_{\\text{new}} = \\exp\\left(-\\frac{\\Delta G_A^\\ddagger(\\Delta x) - \\Delta G_B^\\ddagger(\\Delta x)}{RT}\\right) $$\nThe fold-change is the ratio of these two quantities:\n$$ \\frac{\\sigma_{\\text{new}}}{\\sigma_{\\text{old}}} = \\frac{\\exp\\left(-\\frac{\\Delta G_A^\\ddagger(\\Delta x) - \\Delta G_B^\\ddagger(\\Delta x)}{RT}\\right)}{\\exp\\left(-\\frac{\\Delta G_A^\\ddagger(0) - \\Delta G_B^\\ddagger(0)}{RT}\\right)} $$\nAgain, applying the properties of exponential functions, $\\exp(u)/\\exp(v) = \\exp(u-v)$, we obtain:\n$$ \\frac{\\sigma_{\\text{new}}}{\\sigma_{\\text{old}}} = \\exp\\left( \\frac{-\\left(\\Delta G_A^\\ddagger(\\Delta x) - \\Delta G_B^\\ddagger(\\Delta x)\\right) + \\left(\\Delta G_A^\\ddagger(0) - \\Delta G_B^\\ddagger(0)\\right)}{RT} \\right) $$\nRearranging the terms in the numerator of the exponent gives:\n$$ \\frac{\\sigma_{\\text{new}}}{\\sigma_{\\text{old}}} = \\exp\\left( -\\frac{\\left(\\Delta G_A^\\ddagger(\\Delta x) - \\Delta G_A^\\ddagger(0)\\right) - \\left(\\Delta G_B^\\ddagger(\\Delta x) - \\Delta G_B^\\ddagger(0)\\right)}{RT} \\right) $$\nThe problem states a linear free energy relationship governs the change in activation energy with displacement:\n$$ \\Delta G_i^\\ddagger(x) = \\Delta G_i^\\ddagger(0) + m_i x $$\nFrom this, the change in activation free energy for a displacement $\\Delta x$ is $\\Delta G_i^\\ddagger(\\Delta x) - \\Delta G_i^\\ddagger(0) = m_i \\Delta x$. We can substitute this into our expression for the fold-change in selectivity:\n$$ \\frac{\\sigma_{\\text{new}}}{\\sigma_{\\text{old}}} = \\exp\\left( -\\frac{m_A \\Delta x - m_B \\Delta x}{RT} \\right) $$\n$$ \\frac{\\sigma_{\\text{new}}}{\\sigma_{\\text{old}}} = \\exp\\left( -\\frac{(m_A - m_B)\\Delta x}{RT} \\right) $$\nThis final symbolic expression contains all the given quantities. We now substitute the numerical values provided:\n$m_A = 1.8\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-1}$\n$m_B = 0.6\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-1}$\n$\\Delta x = +0.5\\,\\text{\\AA}$\n$R = 1.987 \\times 10^{-3}\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n$T = 298\\,\\text{K}$\n\nFirst, we calculate the terms in the exponent. The difference in the slopes is:\n$$ m_A - m_B = (1.8 - 0.6)\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-1} = 1.2\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-1} $$\nThe numerator, representing the differential change in activation energy, is:\n$$ (m_A - m_B)\\Delta x = (1.2\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}^{-1}) \\times (0.5\\,\\text{\\AA}) = 0.6\\,\\text{kcal}\\,\\text{mol}^{-1} $$\nThe denominator, representing the thermal energy scale, is:\n$$ RT = (1.987 \\times 10^{-3}\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}) \\times (298\\,\\text{K}) \\approx 0.592126\\,\\text{kcal}\\,\\text{mol}^{-1} $$\nNow, we compute the value of the exponent:\n$$ -\\frac{(m_A - m_B)\\Delta x}{RT} = -\\frac{0.6}{0.592126} \\approx -1.013297 $$\nFinally, we calculate the fold-change:\n$$ \\frac{\\sigma_{\\text{new}}}{\\sigma_{\\text{old}}} = \\exp(-1.013297) \\approx 0.362942 $$\nRounding to four significant figures as requested, the result is $0.3629$. The positive displacement $\\Delta x$ coupled with $m_A > m_B$ increases the activation barrier for substrate $A$ more than for substrate $B$, thus decreasing the enzyme's selectivity for $A$ over $B$.", "answer": "$$\n\\boxed{0.3629}\n$$", "id": "2713850"}, {"introduction": "Moving from energetic principles to concrete structural implementation, this exercise addresses a core task in computational protein design: remodeling an active site to accommodate a new substrate. This typically involves a combinatorial search to find new side-chain conformations (rotamers) that create a sterically compatible binding pocket. This problem challenges you to develop a geometric solver that identifies the minimal set of rotamer changes needed to avoid steric clashes, giving you hands-on experience with the fundamental algorithms that power sophisticated protein design software [@problem_id:2713890].", "problem": "You are tasked with implementing a geometric-combinatorial solver for a simplified protein design problem relevant to altering enzyme substrate specificity via side-chain rotamer changes. In the hard-sphere steric model, each atom is approximated as a sphere. Each side-chain rotamer of a residue is given as a finite set of pseudo-atom spheres that approximate the side-chain envelope. A substrate analog introduces an extra spherical substituent that must be accommodated without steric clashes.\n\nFundamental base:\n- In the hard-sphere model, two spheres with centers at positions $\\mathbf{x} \\in \\mathbb{R}^3$ and $\\mathbf{y} \\in \\mathbb{R}^3$ and radii $a \\in \\mathbb{R}_{\\ge 0}$ and $b \\in \\mathbb{R}_{\\ge 0}$ clash if and only if $\\lVert \\mathbf{x} - \\mathbf{y} \\rVert_2 < a + b$.\n- Side-chain rotamers are discrete conformations; choosing one rotamer per residue fixes its side-chain pseudo-atom geometry.\n\nMathematical formulation:\n- There are $N$ residues indexed by $i \\in \\{1,\\dots,N\\}$. Residue $i$ has $K_i$ rotamers indexed by $k \\in \\{0,1,\\dots,K_i-1\\}$. Rotamer $k$ of residue $i$ comprises $M_{i,k}$ pseudo-atoms with centers $\\{\\mathbf{x}_{i,k,m}\\}_{m=1}^{M_{i,k}} \\subset \\mathbb{R}^3$ and radii $\\{a_{i,k,m}\\}_{m=1}^{M_{i,k}} \\subset \\mathbb{R}_{\\ge 0}$.\n- The substrate analog’s extra substituent is a sphere with center $\\mathbf{s} \\in \\mathbb{R}^3$ and radius $r \\in \\mathbb{R}_{\\ge 0}$.\n- A selection is a choice of exactly one rotamer per residue. Let binary decision variables be $y_{i,k} \\in \\{0,1\\}$ with $\\sum_{k=0}^{K_i-1} y_{i,k} = 1$ for all $i$.\n- Substrate clash avoidance: for any chosen rotamer $(i,k)$ and any $m \\in \\{1,\\dots,M_{i,k}\\}$, require $\\lVert \\mathbf{x}_{i,k,m} - \\mathbf{s} \\rVert_2 \\ge a_{i,k,m} + r$.\n- Inter-residue clash avoidance: for any two distinct residues $i \\ne j$, chosen rotamers $(i,k)$ and $(j,\\ell)$, and any $m \\in \\{1,\\dots,M_{i,k}\\}$, $n \\in \\{1,\\dots,M_{j,\\ell}\\}$, require $\\lVert \\mathbf{x}_{i,k,m} - \\mathbf{x}_{j,\\ell,n} \\rVert_2 \\ge a_{i,k,m} + a_{j,\\ell,n}$.\n- The baseline (wild-type) assignment is $k=0$ for every residue $i$. Define the cost of an assignment as $C = \\sum_{i=1}^{N} \\left(1 - y_{i,0}\\right)$, which counts the number of residues changed from baseline. The goal is to minimize $C$ subject to the clash-avoidance constraints.\n- If no feasible assignment exists, return an infeasible indicator.\n\nGeometry and units:\n- All coordinates $\\mathbf{x}_{i,k,m}$ and $\\mathbf{s}$ are in Angstroms. All radii $a_{i,k,m}$ and $r$ are in Angstroms. All distances are Euclidean in Angstroms. Your program must compute exact clash checks using the strict inequality $\\lVert \\mathbf{x} - \\mathbf{y} \\rVert_2 < a + b$ as a clash definition.\n\nYour task:\n- Implement a program that, for each test case below, computes the minimal number of residues that must change rotamer relative to the baseline to accommodate the extra substituent without any clashes, or returns $-1$ if no feasible assignment exists.\n- The required final output format is a single line containing a list of the results for all test cases as a comma-separated list enclosed in square brackets, e.g., $[\\text{result}_1,\\text{result}_2,\\dots]$.\n- There are no physical units in the output because the outputs are integers.\n\nTest suite (use exactly these $4$ cases):\n\n- Test case $1$ (happy path):\n  - Substituent: center $\\mathbf{s} = (\\,0.0,\\,0.0,\\,0.0\\,)$, radius $r = 1.5$.\n  - Residue $1$:\n    - Rotamer $0$: one pseudo-atom at $(\\,1.5,\\,0.0,\\,0.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,5.0,\\,0.0,\\,0.0\\,)$ with radius $1.7$.\n  - Residue $2$:\n    - Rotamer $0$: one pseudo-atom at $(\\,0.0,\\,1.5,\\,0.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,0.0,\\,4.8,\\,0.0\\,)$ with radius $1.7$.\n  - Residue $3$:\n    - Rotamer $0$: one pseudo-atom at $(\\,0.0,\\,0.0,\\,4.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,0.0,\\,0.0,\\,2.0\\,)$ with radius $1.7$.\n\n- Test case $2$ (no changes needed):\n  - Substituent: center $\\mathbf{s} = (\\,0.0,\\,0.0,\\,0.0\\,)$, radius $r = 1.2$.\n  - Residue $1$:\n    - Rotamer $0$: one pseudo-atom at $(\\,4.0,\\,0.0,\\,0.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,5.0,\\,0.0,\\,0.0\\,)$ with radius $1.7$.\n  - Residue $2$:\n    - Rotamer $0$: one pseudo-atom at $(\\,0.0,\\,4.0,\\,0.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,0.0,\\,5.0,\\,0.0\\,)$ with radius $1.7$.\n  - Residue $3$:\n    - Rotamer $0$: one pseudo-atom at $(\\,0.0,\\,0.0,\\,4.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,0.0,\\,0.0,\\,5.0\\,)$ with radius $1.7$.\n\n- Test case $3$ (infeasible due to one residue with no acceptable rotamer):\n  - Substituent: center $\\mathbf{s} = (\\,0.0,\\,0.0,\\,0.0\\,)$, radius $r = 2.0$.\n  - Residue $1$:\n    - Rotamer $0$: one pseudo-atom at $(\\,2.0,\\,0.0,\\,0.0\\,)$ with radius $1.5$.\n    - Rotamer $1$: one pseudo-atom at $(\\,2.2,\\,0.0,\\,0.0\\,)$ with radius $1.5$.\n  - Residue $2$:\n    - Rotamer $0$: one pseudo-atom at $(\\,0.0,\\,4.0,\\,0.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,0.0,\\,5.0,\\,0.0\\,)$ with radius $1.7$.\n\n- Test case $4$ (interaction-induced extra change needed):\n  - Substituent: center $\\mathbf{s} = (\\,0.0,\\,0.0,\\,0.0\\,)$, radius $r = 1.5$.\n  - Residue 1:\n    - Rotamer $0$: one pseudo-atom at $(\\,3.6,\\,0.0,\\,0.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,0.0,\\,3.6,\\,0.0\\,)$ with radius $1.7$.\n  - Residue 2:\n    - Rotamer $0$: one pseudo-atom at $(\\,0.0,\\,1.5,\\,0.0\\,)$ with radius $1.7$.\n    - Rotamer $1$: one pseudo-atom at $(\\,3.6,\\,0.0,\\,0.0\\,)$ with radius $1.7$.\n\nFor each test case, compute the minimal number of residues that must change rotamer relative to baseline (rotamer index $0$) to satisfy all clash-avoidance constraints. If no feasible assignment exists, return $-1$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4]$, where each $x_i$ is an integer for test case $i$.", "solution": "The problem presented is a well-posed combinatorial optimization problem rooted in the principles of computational protein design, a sub-discipline of synthetic biology. Its structure is scientifically sound, relying on the established hard-sphere model for steric interactions, and all necessary parameters are provided, rendering the problem valid for a formal solution.\n\nThe task is to find a selection of side-chain rotamers, one for each of the $N$ residues, that collectively avoids steric clashes while minimizing the number of deviations from a baseline (wild-type) conformation. The cost of an assignment is defined as $C = \\sum_{i=1}^{N} (1 - y_{i,0})$, where $y_{i,0}$ is a binary variable indicating if residue $i$ is in its baseline rotamer (indexed by $k=0$). This cost function quantifies the number of \"mutations\" or changes from the original state.\n\nThe system is subject to two sets of geometric constraints, both derived from the hard-sphere model. Two spheres, with centers $\\mathbf{x}, \\mathbf{y} \\in \\mathbb{R}^3$ and radii $a, b \\in \\mathbb{R}_{\\ge 0}$ respectively, are defined to clash if and only if the Euclidean distance between their centers is less than the sum of their radii: $\\lVert \\mathbf{x} - \\mathbf{y} \\rVert_2 < a + b$. For computational efficiency, this check is more readily implemented by comparing squared quantities: $\\lVert \\mathbf{x} - \\mathbf{y} \\rVert_2^2 < (a + b)^2$.\n\nThe constraints are:\n$1$. **Substrate-Residue Clash Avoidance:** For any selected rotamer $k$ of residue $i$, each of its constituent pseudo-atoms (center $\\mathbf{x}_{i,k,m}$, radius $a_{i,k,m}$) must not clash with the substrate's substituent sphere (center $\\mathbf{s}$, radius $r$). This is expressed as $\\lVert \\mathbf{x}_{i,k,m} - \\mathbf{s} \\rVert_2 \\ge a_{i,k,m} + r$ for all atoms $m$.\n$2$. **Inter-Residue Clash Avoidance:** For any two distinct residues $i$ and $j$ with selected rotamers $k$ and $\\ell$ respectively, none of their constituent pseudo-atoms may clash with one another. This is expressed as $\\lVert \\mathbf{x}_{i,k,m} - \\mathbf{x}_{j,\\ell,n} \\rVert_2 \\ge a_{i,k,m} + a_{j,\\ell,n}$ for all atom pairs $(m, n)$.\n\nA rotamer assignment is a vector of choices $(k_1, k_2, \\dots, k_N)$, where $k_i$ is the index of the chosen rotamer for residue $i$. The total set of possible assignments constitutes the search space. For a system with $N$ residues, where residue $i$ possesses $K_i$ possible rotamers, the total size of this discrete search space is $\\prod_{i=1}^{N} K_i$.\n\nFor the test cases provided, the number of residues $N$ (either $2$ or $3$) and the number of rotamers per residue $K_i$ (always $2$) are small. This results in a very small search space (e.g., $2^3 = 8$ total assignments for a $3$-residue system). Consequently, an exhaustive search, or brute-force enumeration, of all possible assignments is a computationally feasible and entirely rigorous method to find the optimal solution. This approach guarantees finding the global minimum cost if a feasible solution exists.\n\nThe algorithm proceeds as follows:\n$1$. Initialize a minimum cost variable, $\\text{min\\_cost}$, to a value larger than any possible cost, such as $N+1$ or infinity.\n$2$. Generate every possible rotamer assignment. An assignment is a tuple $(k_1, k_2, \\dots, k_N)$, where $k_i \\in \\{0, 1, \\dots, K_i-1\\}$. This can be achieved systematically, for instance, by computing the Cartesian product of the sets of rotamer indices for each residue.\n$3$. For each generated assignment:\n    a. Assume the assignment is valid.\n    b. Check for substrate clashes: For each residue $i \\in \\{1,\\dots,N\\}$, iterate through all pseudo-atoms of its assigned rotamer $k_i$ and verify the non-clash condition with the substrate sphere. If a clash is detected, the assignment is invalid; proceed to the next assignment.\n    c. If no substrate clashes are found, check for inter-residue clashes: For every unique pair of distinct residues $(i, j)$ with $i \\ne j$, iterate through all pairs of pseudo-atoms, one from rotamer $k_i$ and one from rotamer $k_j$, and verify the non-clash condition. If a clash is detected, the assignment is invalid; proceed to the next assignment.\n    d. If the assignment is deemed valid (i.e., it is clash-free), calculate its cost: $C = \\sum_{i=1}^{N} \\mathbb{I}(k_i \\ne 0)$, where $\\mathbb{I}$ is the indicator function. Update $\\text{min\\_cost} = \\min(\\text{min\\_cost}, C)$.\n$4$. After evaluating all possible assignments, if $\\text{min\\_cost}$ remains at its initial high value, it signifies that no feasible, clash-free assignment exists. In this case, the result is $-1$. Otherwise, the final value of $\\text{min\\_cost}$ is the minimum number of mutations required and is the solution.\n\nThis deterministic algorithm correctly solves the posed problem by systematically exploring the complete, finite solution space and identifying the feasible solution with the lowest cost.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import product, combinations\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the solver for each,\n    and print the results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases_data = [\n        # Test case 1 (happy path)\n        {\n            'substrate': {'center': np.array([0.0, 0.0, 0.0]), 'radius': 1.5},\n            'residues': [\n                # Residue 1\n                [\n                    [{'center': np.array([1.5, 0.0, 0.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([5.0, 0.0, 0.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n                # Residue 2\n                [\n                    [{'center': np.array([0.0, 1.5, 0.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([0.0, 4.8, 0.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n                # Residue 3\n                [\n                    [{'center': np.array([0.0, 0.0, 4.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([0.0, 0.0, 2.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n            ]\n        },\n        # Test case 2 (no changes needed)\n        {\n            'substrate': {'center': np.array([0.0, 0.0, 0.0]), 'radius': 1.2},\n            'residues': [\n                # Residue 1\n                [\n                    [{'center': np.array([4.0, 0.0, 0.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([5.0, 0.0, 0.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n                # Residue 2\n                [\n                    [{'center': np.array([0.0, 4.0, 0.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([0.0, 5.0, 0.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n                # Residue 3\n                [\n                    [{'center': np.array([0.0, 0.0, 4.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([0.0, 0.0, 5.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n            ]\n        },\n        # Test case 3 (infeasible due to one residue)\n        {\n            'substrate': {'center': np.array([0.0, 0.0, 0.0]), 'radius': 2.0},\n            'residues': [\n                # Residue 1\n                [\n                    [{'center': np.array([2.0, 0.0, 0.0]), 'radius': 1.5}], # Rotamer 0\n                    [{'center': np.array([2.2, 0.0, 0.0]), 'radius': 1.5}], # Rotamer 1\n                ],\n                # Residue 2\n                [\n                    [{'center': np.array([0.0, 4.0, 0.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([0.0, 5.0, 0.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n            ]\n        },\n        # Test case 4 (interaction-induced extra change needed)\n        {\n            'substrate': {'center': np.array([0.0, 0.0, 0.0]), 'radius': 1.5},\n            'residues': [\n                # Residue A (1)\n                [\n                    [{'center': np.array([3.6, 0.0, 0.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([0.0, 3.6, 0.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n                # Residue B (2)\n                [\n                    [{'center': np.array([0.0, 1.5, 0.0]), 'radius': 1.7}], # Rotamer 0\n                    [{'center': np.array([3.6, 0.0, 0.0]), 'radius': 1.7}], # Rotamer 1\n                ],\n            ]\n        }\n    ]\n\n    results = [solve_case(case) for case in test_cases_data]\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef clashes(sphere1, sphere2):\n    \"\"\"\n    Checks if two spheres clash based on the hard-sphere model.\n    Uses squared distances for efficiency.\n    \"\"\"\n    center1, r1 = sphere1['center'], sphere1['radius']\n    center2, r2 = sphere2['center'], sphere2['radius']\n    dist_sq = np.sum((center1 - center2)**2)\n    radii_sum_sq = (r1 + r2)**2\n    return dist_sq  radii_sum_sq\n\ndef is_assignment_valid(assignment, substrate, residues):\n    \"\"\"\n    Checks if a given rotamer assignment is valid (clash-free).\n    \"\"\"\n    # Check for substrate clashes\n    for i, rot_idx in enumerate(assignment):\n        rotamer = residues[i][rot_idx]\n        for atom in rotamer:\n            if clashes(atom, substrate):\n                return False\n\n    # Check for inter-residue clashes\n    num_residues = len(residues)\n    if num_residues  2:\n        return True\n    \n    for i, j in combinations(range(num_residues), 2):\n        rotamer_i = residues[i][assignment[i]]\n        rotamer_j = residues[j][assignment[j]]\n        for atom_i in rotamer_i:\n            for atom_j in rotamer_j:\n                if clashes(atom_i, atom_j):\n                    return False\n    return True\n\ndef solve_case(case_data):\n    \"\"\"\n    Solves a single test case by exhaustively searching all rotamer assignments.\n    \"\"\"\n    substrate = case_data['substrate']\n    residues = case_data['residues']\n    \n    # Generate all possible rotamer assignments using itertools.product\n    rotamer_indices_per_residue = [range(len(res)) for res in residues]\n    all_assignments = product(*rotamer_indices_per_residue)\n    \n    min_cost = float('inf')\n    \n    # Iterate through every possible assignment\n    for assignment in all_assignments:\n        if is_assignment_valid(assignment, substrate, residues):\n            # If the assignment is valid, calculate its cost\n            cost = sum(1 for rot_idx in assignment if rot_idx > 0)\n            # Update the minimum cost found so far\n            if cost  min_cost:\n                min_cost = cost\n                \n    return min_cost if min_cost != float('inf') else -1\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "2713890"}]}