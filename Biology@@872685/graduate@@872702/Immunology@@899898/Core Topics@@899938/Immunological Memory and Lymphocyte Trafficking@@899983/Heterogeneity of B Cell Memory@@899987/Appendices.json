{"hands_on_practices": [{"introduction": "The journey of a B cell's response begins with the physical interaction between its B cell receptor (BCR) and an antigen. The strength of this binding, quantified by the dissociation constant ($K_D$), dictates the cell's sensitivity and is a primary determinant of its activation threshold. This foundational exercise [@problem_id:2853001] grounds the concept of B cell memory in first principles of biophysical chemistry, allowing you to quantitatively demonstrate how higher affinity translates directly into greater receptor occupancy and a potent competitive advantage during a recall response.", "problem": "A population of antigen-experienced B cells contains two memory subsets whose B cell receptor (BCR) repertoires differ in average affinity for a soluble antigen. Subset A is enriched for high-affinity, class-switched memory B cells with an average dissociation constant ($K_D$) of $10\\,\\mathrm{nM}$, and Subset B is enriched for lower-affinity memory B cells with an average dissociation constant ($K_D$) of $100\\,\\mathrm{nM}$. The extracellular antigen concentration is $30\\,\\mathrm{nM}$. Assume reversible one-to-one binding between B cell receptors and antigen, a well-mixed environment, and that free antigen concentration is well-approximated by the total antigen concentration because antigen is in large molar excess over total receptor. Begin from the law of mass action and the definition of the dissociation constant ($K_D$), and from first principles derive an expression for the equilibrium receptor occupancy as a function of free antigen concentration and the dissociation constant. Using that expression, compute the equilibrium BCR occupancy for Subset A and Subset B at $30\\,\\mathrm{nM}$ antigen, and then report the fold difference in occupancy defined as $B_{\\mathrm{A}}/B_{\\mathrm{B}}$. Briefly justify, based on receptor occupancy principles and activation thresholds in B cell signaling, how this difference would influence which subset is more likely to be activated under antigen-limiting conditions, without invoking any additional empirical formulas. Report only the fold difference $B_{\\mathrm{A}}/B_{\\mathrm{B}}$ as your final numerical answer. Round your answer to four significant figures. Do not include units in your final answer.", "solution": "The problem presents a valid and well-posed question in biophysical chemistry, specifically concerning the principles of receptor-ligand binding as applied to immunology. It is scientifically grounded, objective, and contains all necessary information for a complete solution.\n\nThe binding of a soluble antigen, which acts as a ligand ($L$), to a B cell receptor ($R$) on the cell surface can be described as a reversible one-to-one reaction:\n$$\nR + L \\rightleftharpoons RL\n$$\nwhere $RL$ represents the antigen-bound receptor complex.\n\nAccording to the law of mass action, the rate of the forward reaction (association) is proportional to the concentrations of the free reactants, $k_{on}[R][L]$, and the rate of the reverse reaction (dissociation) is proportional to the concentration of the complex, $k_{off}[RL]$. Here, $k_{on}$ is the association rate constant and $k_{off}$ is the dissociation rate constant.\n\nAt equilibrium, the rate of association equals the rate of dissociation:\n$$\nk_{on}[R][L] = k_{off}[RL]\n$$\n\nThe dissociation constant, $K_D$, is defined as the ratio of the dissociation rate constant to the association rate constant, and it can also be expressed in terms of the equilibrium concentrations:\n$$\nK_D = \\frac{k_{off}}{k_{on}} = \\frac{[R][L]}{[RL]}\n$$\nA lower $K_D$ value signifies a higher affinity of the receptor for its ligand, as a lower concentration of ligand is needed to occupy half of the receptors.\n\nThe receptor occupancy, which we will denote as $B$, is defined as the fraction of total receptors that are bound to the ligand at equilibrium. If $[R_T]$ is the total concentration of receptors, then:\n$$\nB = \\frac{[RL]}{[R_T]}\n$$\nThe total receptor concentration is the sum of the concentrations of free receptors, $[R]$, and bound receptors, $[RL]$:\n$$\n[R_T] = [R] + [RL]\n$$\nFrom this, we can express the free receptor concentration as $[R] = [R_T] - [RL]$.\n\nSubstituting this expression for $[R]$ into the definition of $K_D$:\n$$\nK_D = \\frac{([R_T] - [RL])[L]}{[RL]}\n$$\nThe problem states that the free antigen concentration, $[L]$, is well-approximated by the total antigen concentration, which is given as $30 \\, \\mathrm{nM}$. This is a valid assumption when the ligand is in large molar excess compared to the total receptor concentration, as stated.\n\nTo derive the occupancy $B$ as a function of $[L]$ and $K_D$, we rearrange the equation. First, we can divide both the numerator and denominator of the fraction by $[R_T]$:\n$$\nK_D = \\frac{\\left(1 - \\frac{[RL]}{[R_T]}\\right)[L]}{\\frac{[RL]}{[R_T]}}\n$$\nSubstituting the definition of occupancy, $B = \\frac{[RL]}{[R_T]}$:\n$$\nK_D = \\frac{(1 - B)[L]}{B}\n$$\nThis is the desired expression relating $K_D$, $[L]$, and $B$. We now solve for $B$:\n$$\nK_D \\cdot B = (1 - B)[L]\n$$\n$$\nK_D \\cdot B = [L] - B[L]\n$$\n$$\nK_D \\cdot B + B[L] = [L]\n$$\n$$\nB(K_D + [L]) = [L]\n$$\n$$\nB = \\frac{[L]}{K_D + [L]}\n$$\nThis is the Hill-Langmuir equation for a single binding site, which is the expression for equilibrium receptor occupancy we were tasked to derive from first principles.\n\nNow, we apply this formula to the two B cell subsets, A and B.\nGiven data:\nDissociation constant for Subset A: $K_{D,A} = 10 \\, \\mathrm{nM}$\nDissociation constant for Subset B: $K_{D,B} = 100 \\, \\mathrm{nM}$\nFree antigen concentration: $[L] = 30 \\, \\mathrm{nM}$\n\nFor Subset A, the equilibrium occupancy $B_A$ is:\n$$\nB_A = \\frac{[L]}{K_{D,A} + [L]} = \\frac{30 \\, \\mathrm{nM}}{10 \\, \\mathrm{nM} + 30 \\, \\mathrm{nM}} = \\frac{30}{40} = \\frac{3}{4} = 0.75\n$$\n\nFor Subset B, the equilibrium occupancy $B_B$ is:\n$$\nB_B = \\frac{[L]}{K_{D,B} + [L]} = \\frac{30 \\, \\mathrm{nM}}{100 \\, \\mathrm{nM} + 30 \\, \\mathrm{nM}} = \\frac{30}{130} = \\frac{3}{13}\n$$\n\nThe problem asks for the fold difference in occupancy, defined as the ratio $B_A / B_B$:\n$$\n\\frac{B_A}{B_B} = \\frac{\\frac{3}{4}}{\\frac{3}{13}} = \\frac{3}{4} \\cdot \\frac{13}{3} = \\frac{13}{4} = 3.25\n$$\nRounding to four significant figures as requested, the value is $3.250$.\n\nTo justify which subset is more likely to be activated, we must consider the biophysical meaning of occupancy. B cell activation requires the cross-linking of multiple BCRs, which initiates an intracellular signaling cascade. The magnitude of this initial signal is a function of the number of engaged receptors. This number is directly proportional to the receptor occupancy, $B$. A higher occupancy at a given antigen concentration translates to a stronger and more sustained signal.\n\nThe condition described, $[L] = 30 \\, \\mathrm{nM}$, represents an antigen-limiting environment, particularly for the low-affinity Subset B, as the antigen concentration is well below its $K_D$ of $100 \\, \\mathrm{nM}$. For Subset A, this concentration is above its $K_D$ of $10 \\, \\mathrm{nM}$. Consequently, Subset A achieves a high occupancy of $75\\%$, while Subset B achieves a much lower occupancy of approximately $23.1\\%$. The $3.25$-fold higher receptor occupancy for Subset A means that, for a given number of total receptors on a cell, a B cell from Subset A will have $3.25$ times more antigen-bound receptors than a B cell from Subset B. Assuming a common signaling threshold for activation (a minimum number of engaged receptors required to trigger a response), the high-affinity Subset A is significantly more likely to surpass this threshold and become activated. This principle of affinity-based selection is fundamental to the process of affinity maturation in germinal centers, where B cells with higher affinity BCRs are preferentially selected for survival and differentiation.", "answer": "$$\\boxed{3.250}$$", "id": "2853001"}, {"introduction": "The intense process of affinity maturation, which selects for high-affinity B cells, leaves an indelible evolutionary signature within the BCR's genetic code. By comparing the rate of nonsynonymous substitutions ($dN$) to synonymous substitutions ($dS$), we can measure the selective pressures that have shaped a B cell clone. This hands-on computational practice [@problem_id:2852976] will equip you with the skills to dissect these genetic signatures, revealing the classic pattern of positive selection ($dN/dS \\gt 1$) in the antigen-binding Complementarity-Determining Regions (CDRs) and purifying selection ($dN/dS \\lt 1$) in the structurally critical Framework Regions (FWRs).", "problem": "You are given codon-level coding sequences representing the immunoglobulin variable region of a B cell receptor (BCR) clone: a germline sequence and several observed mutated sequences from memory B cells. Within this region, Complementarity-Determining Regions (CDR) and Framework Regions (FWR) are annotated by codon indices. Your task is to implement a program that computes, for each mutated sequence, the ratio of nonsynonymous to synonymous substitution rates, $dN/dS$, separately for the CDR and FWR partitions, using first principles of codon-based counting. Then, using the computed $dN/dS$, determine whether the pattern is consistent with positive selection in CDR and purifying selection in FWR, as expected under affinity maturation and structural constraint in B cell memory.\n\nUse the following fundamental base:\n- The Central Dogma (deoxyribonucleic acid (DNA) to ribonucleic acid (RNA) to protein) implies that codons of length $3$ nucleotides are translated into amino acids according to the standard genetic code.\n- Somatic hypermutation (SHM) introduces point mutations in immunoglobulin variable regions. Mutations that do not change the encoded amino acid are termed synonymous, while those that change the amino acid are nonsynonymous.\n- Under the Nei–Gojobori counting framework, the expected number of synonymous sites $S$ in a codon is computed by, for each of its three nucleotide positions, enumerating the $3$ possible single-nucleotide changes at that position, counting how many of those result in the same amino acid (synonymous), dividing by $3$ for that position, and summing over the three positions. The expected number of nonsynonymous sites in a codon is $N = 3 - S$.\n- Given observed differences between a germline and a mutated codon that differ by exactly one nucleotide, the difference is classified as synonymous if the encoded amino acids are the same and nonsynonymous otherwise. For differences involving more than one nucleotide, a path of single-nucleotide changes can be considered sequentially; however, in this test suite all codon changes are either identical or differ by a single nucleotide to ensure unambiguous counting.\n- Let $S_{\\mathrm{reg}}$ and $N_{\\mathrm{reg}}$ be the total synonymous and nonsynonymous sites, respectively, in a region $\\mathrm{reg} \\in \\{\\mathrm{CDR}, \\mathrm{FWR}\\}$ obtained by summing the site counts over codons in that region. Let $S^{\\Delta}_{\\mathrm{reg}}$ and $N^{\\Delta}_{\\mathrm{reg}}$ be the observed synonymous and nonsynonymous differences, respectively, between the germline and mutated sequence in that region. Define the synonymous and nonsynonymous rates as $p_S = \\dfrac{S^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{S_{\\mathrm{reg}} + \\varepsilon}$ and $p_N = \\dfrac{N^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{N_{\\mathrm{reg}} + \\varepsilon}$, using a small continuity correction $\\varepsilon = 10^{-6}$ to avoid division by zero in edge cases. Then compute $dN/dS = \\dfrac{p_N}{p_S}$ for each region.\n- Interpretive rule: a pattern with $dN/dS_{\\mathrm{CDR}} > 1$ and $dN/dS_{\\mathrm{FWR}} < 1$ is consistent with affinity-driven positive selection focusing on antigen-contact residues in CDR and purifying (structural) selection constraining FWR in memory B cells.\n\nYour program must implement the standard genetic code and the counting described above. It must treat changes that produce a stop codon as nonsynonymous relative to the original amino acid.\n\nInput is fixed by the test suite below. All indices are $0$-based codon indices. Each sequence is provided as an array of codon triplets $\\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}^3$ with length $L = 24$ codons. The CDR indices are $[5,6,7,16,17]$; all other codons are FWR.\n\nGermline codon array (length $24$):\n[\"GCT\",\"GTT\",\"GGT\",\"CCT\",\"ACT\",\"TTT\",\"TCT\",\"AAT\",\"GCT\",\"GTT\",\"GGT\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CAT\",\"TCT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n\nTest suite of mutated codon arrays (three cases):\n- Case $1$ (expected positive selection signal concentrated in CDR, purifying in FWR):\n[\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TCT\",\"CCT\",\"CAT\",\"GCC\",\"GTC\",\"GGC\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CGT\",\"TTT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n- Case $2$ (near-neutral mixture across regions):\n[\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TTC\",\"TCC\",\"AGT\",\"GCC\",\"GCT\",\"AGT\",\"CAT\",\"CCT\",\"TCT\",\"GAT\",\"GTT\",\"CAC\",\"TTT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n- Case $3$ (edge case with zero synonymous differences in CDR and only synonymous in FWR):\n[\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TAT\",\"TGT\",\"GAT\",\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TAT\",\"GCT\",\"GTT\",\"CTT\",\"CCT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n\nYour program must:\n- Implement the counting of $S_{\\mathrm{reg}}$, $N_{\\mathrm{reg}}$, $S^{\\Delta}_{\\mathrm{reg}}$, $N^{\\Delta}_{\\mathrm{reg}}$ as described, for each region $\\mathrm{reg} \\in \\{\\mathrm{CDR}, \\mathrm{FWR}\\}$ and each test case.\n- Use $\\varepsilon = 10^{-6}$ as the continuity correction in $p_S$ and $p_N$.\n- For each test case, compute two floating-point values $dN/dS_{\\mathrm{CDR}}$ and $dN/dS_{\\mathrm{FWR}}$ and one boolean indicating whether $(dN/dS_{\\mathrm{CDR}} > 1)$ and $(dN/dS_{\\mathrm{FWR}} < 1)$ simultaneously hold.\n- Round each $dN/dS$ to $6$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the form $[dN/dS_{\\mathrm{CDR}}, dN/dS_{\\mathrm{FWR}}, \\mathrm{boolean}]$. For example: [[x11,x12,b1],[x21,x22,b2],[x31,x32,b3]], where each $xij$ is a float rounded to $6$ decimals and each $bk$ is True or False. No extra text should be printed.\n\nNotes on scientific realism and interpretation:\n- The CDR-focused elevation of $dN/dS$ reflects selection for amino acid changes that improve antigen binding, whereas lowered $dN/dS$ in FWR reflects the structural constraints that preserve the BCR fold. Heterogeneity across cases illustrates that not all memory B cells show the same selection signatures; some may be near-neutral or exhibit strong purifying constraints depending on clonal history and antigen exposure.", "solution": "The problem presented is a well-defined and scientifically grounded exercise in computational biology, specifically in the analysis of molecular evolution. It requires the implementation of a fundamental method for quantifying selective pressures on coding sequences—the estimation of the ratio of nonsynonymous to synonymous substitution rates ($dN/dS$). This analysis is to be applied to the variable regions of B cell receptors, a classic model system for studying Darwinian selection at the molecular level. The problem is valid, as it is based on established principles, provides all necessary data and definitions, and its logic is sound. We will proceed with a systematic, principle-based solution.\n\nThe objective is to compute the $dN/dS$ ratio for two distinct functional regions of an immunoglobulin gene—the Complementarity-Determining Region (CDR) and the Framework Region (FWR)—and to interpret the results in the context of somatic hypermutation and affinity maturation.\n\nThe solution is constructed upon the following principles:\n\n1.  **The Standard Genetic Code and Classes of Mutation**: The foundation of this analysis is the central dogma, wherein triplicate nucleotide codons are translated into amino acids. The standard genetic code defines this mapping. A point mutation in a codon is classified based on its effect on the resulting amino acid. A **synonymous** mutation results in a codon that codes for the same amino acid. A **nonsynonymous** mutation results in a codon that codes for a different amino acid. Changes to a stop codon are, by convention, treated as nonsynonymous.\n\n2.  **Quantification of Potential for Substitution (Nei–Gojobori Method)**: Before assessing observed mutations, we must first quantify the intrinsic potential for synonymous and nonsynonymous changes within a sequence. For a given codon, not all nucleotide sites have the same potential to accept synonymous or nonsynonymous mutations. The Nei–Gojobori method provides a way to count the number of potential synonymous sites ($S$) and nonsynonymous sites ($N$). For a codon of length $3$, the total number of sites is $3$. The procedure is as follows:\n    -   For each of the $3$ nucleotide positions in the codon, we enumerate the $3$ possible single-nucleotide changes.\n    -   We count how many of these $3$ changes are synonymous. Let this count be $s_j$. The fractional number of synonymous sites at position $j$ is $s_j/3$.\n    -   The total number of synonymous sites for the codon is the sum over all three positions: $S = \\sum_{j=1}^{3} s_j/3$.\n    -   The number of nonsynonymous sites is the remainder: $N = 3 - S$.\n    This calculation provides an expectation of the number of sites of each type.\n\n3.  **Quantification of Observed Substitutions**: We compare the mutated sequence to the ancestral germline sequence codon by codon. The problem simplifies this by guaranteeing that any differing codons do so by only a single nucleotide. This allows for unambiguous counting:\n    -   For each codon pair (germline, mutated), if they are different, we translate both to their respective amino acids.\n    -   If the amino acids are identical, we count this as one observed synonymous difference, $S^{\\Delta}$.\n    -   If the amino acids are different, we count this as one observed nonsynonymous difference, $N^{\\Delta}$.\n\n4.  **Regional Analysis and Rate Calculation**: The analysis is performed separately for the CDR and FWR partitions.\n    -   First, total site counts ($S_{\\mathrm{reg}}$, $N_{\\mathrm{reg}}$) and observed difference counts ($S^{\\Delta}_{\\mathrm{reg}}$, $N^{\\Delta}_{\\mathrm{reg}}$) are aggregated by summing the values from all codons within each region ($\\mathrm{reg} \\in \\{\\mathrm{CDR}, \\mathrm{FWR}\\}$).\n    -   Next, we calculate the rate of substitution per site for each class. These are defined as proportions, adjusted with a small continuity correction $\\varepsilon = 10^{-6}$ to prevent division by zero.\n        -   The synonymous substitution rate is $p_S = \\dfrac{S^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{S_{\\mathrm{reg}} + \\varepsilon}$. This represents the number of observed synonymous changes per available synonymous site.\n        -   The nonsynonymous substitution rate is $p_N = \\dfrac{N^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{N_{\\mathrm{reg}} + \\varepsilon}$. This represents the number of observed nonsynonymous changes per available nonsynonymous site.\n    -   The final ratio is computed as $dN/dS = \\dfrac{p_N}{p_S}$. This ratio is a metric of selective pressure. $dN/dS > 1$ suggests positive or diversifying selection, favoring amino acid changes. $dN/dS < 1$ suggests negative or purifying selection, removing deleterious amino acid changes. $dN/dS \\approx 1$ suggests neutral evolution.\n\n5.  **Biological Interpretation**: The computed values are evaluated against the specific hypothesis for B cell receptor evolution: affinity maturation driven by antigen requires amino acid changes in the antigen-binding site (CDR), while the structural integrity of the immunoglobulin fold must be maintained (FWR). This translates to the interpretive rule: the pattern is consistent with the hypothesis if $dN/dS_{\\mathrm{CDR}} > 1$ (positive selection in CDR) and $dN/dS_{\\mathrm{FWR}} < 1$ (purifying selection in FWR).\n\nThe provided code implements this entire pipeline. It defines the genetic code, partitions the sequences, systematically applies the Nei–Gojobori counting to determine $S$ and $N$ for each germline codon, counts observed differences $S^{\\Delta}$ and $N^{\\Delta}$ for each test case, and computes the final $dN/dS$ ratios and the corresponding boolean interpretation for each region and case as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating dN/dS ratios for BCR sequences.\n    \"\"\"\n\n    # --- Static Definitions ---\n\n    # The Standard Genetic Code (DNA to Amino Acid)\n    # '*' represents a stop codon.\n    GENETIC_CODE = {\n        'TTT': 'F', 'TTC': 'F', 'TTA': 'L', 'TTG': 'L',\n        'TCT': 'S', 'TCC': 'S', 'TCA': 'S', 'TCG': 'S',\n        'TAT': 'Y', 'TAC': 'Y', 'TAA': '*', 'TAG': '*',\n        'TGT': 'C', 'TGC': 'C', 'TGA': '*', 'TGG': 'W',\n        'CTT': 'L', 'CTC': 'L', 'CTA': 'L', 'CTG': 'L',\n        'CCT': 'P', 'CCC': 'P', 'CCA': 'P', 'CCG': 'P',\n        'CAT': 'H', 'CAC': 'H', 'CAA': 'Q', 'CAG': 'Q',\n        'CGT': 'R', 'CGC': 'R', 'CGA': 'R', 'CGG': 'R',\n        'ATT': 'I', 'ATC': 'I', 'ATA': 'I', 'ATG': 'M',\n        'ACT': 'T', 'ACC': 'T', 'ACA': 'T', 'ACG': 'T',\n        'AAT': 'N', 'AAC': 'N', 'AAA': 'K', 'AAG': 'K',\n        'AGT': 'S', 'AGC': 'S', 'AGA': 'R', 'AGG': 'R',\n        'GTT': 'V', 'GTC': 'V', 'GTA': 'V', 'GTG': 'V',\n        'GCT': 'A', 'GCC': 'A', 'GCA': 'A', 'GCG': 'A',\n        'GAT': 'D', 'GAC': 'D', 'GAA': 'E', 'GAG': 'E',\n        'GGT': 'G', 'GGC': 'G', 'GGA': 'G', 'GGG': 'G',\n    }\n    \n    BASES = ['A', 'C', 'G', 'T']\n\n    # --- Input Data from Problem Statement ---\n    \n    GERMLINE = [\n        \"GCT\",\"GTT\",\"GGT\",\"CCT\",\"ACT\",\"TTT\",\"TCT\",\"AAT\",\"GCT\",\"GTT\",\n        \"GGT\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CAT\",\"TCT\",\"GGT\",\"CCT\",\n        \"ACT\",\"GCT\",\"GTT\",\"GGT\"\n    ]\n\n    TEST_CASES = [\n        # Case 1\n        [\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TCT\",\"CCT\",\"CAT\",\"GCC\",\"GTC\",\n         \"GGC\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CGT\",\"TTT\",\"GGT\",\"CCT\",\n         \"ACT\",\"GCT\",\"GTT\",\"GGT\"],\n        # Case 2\n        [\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TTC\",\"TCC\",\"AGT\",\"GCC\",\"GCT\",\n         \"AGT\",\"CAT\",\"CCT\",\"TCT\",\"GAT\",\"GTT\",\"CAC\",\"TTT\",\"GGT\",\"CCT\",\n         \"ACT\",\"GCT\",\"GTT\",\"GGT\"],\n        # Case 3\n        [\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TAT\",\"TGT\",\"GAT\",\"GCC\",\"GTC\",\n         \"GGC\",\"CCC\",\"ACC\",\"TAT\",\"GCT\",\"GTT\",\"CTT\",\"CCT\",\"GGT\",\"CCT\",\n         \"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n    ]\n\n    CDR_INDICES = {5, 6, 7, 16, 17}\n    EPSILON = 1e-6\n    \n    # --- Helper Functions ---\n\n    memo_potential_sites = {}\n    def calculate_potential_sites(codon):\n        \"\"\"\n        Calculates the number of potential synonymous (S) and nonsynonymous (N)\n        sites for a given codon using the Nei-Gojobori method.\n        \"\"\"\n        if codon in memo_potential_sites:\n            return memo_potential_sites[codon]\n\n        original_aa = GENETIC_CODE[codon]\n        syn_site_sum = 0.0\n\n        for i in range(3):  # Iterate through codon positions\n            original_base = codon[i]\n            syn_changes_at_pos = 0\n            for new_base in BASES:\n                if new_base == original_base:\n                    continue\n                \n                new_codon_list = list(codon)\n                new_codon_list[i] = new_base\n                new_codon = \"\".join(new_codon_list)\n                \n                new_aa = GENETIC_CODE[new_codon]\n                if new_aa == original_aa:\n                    syn_changes_at_pos += 1\n            \n            syn_site_sum += syn_changes_at_pos / 3.0\n            \n        s_sites = syn_site_sum\n        n_sites = 3.0 - s_sites\n        \n        memo_potential_sites[codon] = (s_sites, n_sites)\n        return s_sites, n_sites\n\n    # --- Main Logic ---\n\n    results = []\n    \n    for mutated_seq in TEST_CASES:\n        # Initialize regional counters\n        stats = {\n            'CDR': {'S_sites': 0.0, 'N_sites': 0.0, 'S_delta': 0, 'N_delta': 0},\n            'FWR': {'S_sites': 0.0, 'N_sites': 0.0, 'S_delta': 0, 'N_delta': 0}\n        }\n\n        for i, (germline_codon, mutated_codon) in enumerate(zip(GERMLINE, mutated_seq)):\n            region = 'CDR' if i in CDR_INDICES else 'FWR'\n            \n            # 1. Calculate and aggregate potential sites for the germline codon\n            s_sites, n_sites = calculate_potential_sites(germline_codon)\n            stats[region]['S_sites'] += s_sites\n            stats[region]['N_sites'] += n_sites\n            \n            # 2. Count observed differences\n            if germline_codon != mutated_codon:\n                germline_aa = GENETIC_CODE[germline_codon]\n                mutated_aa = GENETIC_CODE[mutated_codon]\n                \n                if germline_aa == mutated_aa:\n                    stats[region]['S_delta'] += 1\n                else:\n                    stats[region]['N_delta'] += 1\n\n        # 3. Calculate dN/dS for each region\n        case_results = []\n        for region in ['CDR', 'FWR']:\n            s_sites_total = stats[region]['S_sites']\n            n_sites_total = stats[region]['N_sites']\n            s_delta_total = stats[region]['S_delta']\n            n_delta_total = stats[region]['N_delta']\n\n            p_s = (s_delta_total + EPSILON) / (s_sites_total + EPSILON)\n            p_n = (n_delta_total + EPSILON) / (n_sites_total + EPSILON)\n            \n            dn_ds = p_n / p_s if p_s != 0 else float('inf')\n            \n            case_results.append(dn_ds)\n\n        dnds_cdr, dnds_fwr = case_results\n        \n        # 4. Apply interpretation rule\n        is_consistent = (dnds_cdr > 1) and (dnds_fwr < 1)\n        \n        # 5. Format and store result for the case\n        rounded_dnds_cdr = round(dnds_cdr, 6)\n        rounded_dnds_fwr = round(dnds_fwr, 6)\n        \n        results.append([rounded_dnds_cdr, rounded_dnds_fwr, is_consistent])\n\n    # Final print statement in the exact required format.\n    # The default str() for a list gives the '[...]' format and\n    # the default str() for a boolean is 'True' or 'False'.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str.replace(\" \", \"\"))\n\nsolve()\n```", "id": "2852976"}, {"introduction": "Beyond antigen binding, the ultimate fate of an activated B cell is governed by an internal gene regulatory network that functions like a biological circuit. The decision to become a memory B cell or a terminally differentiated plasma cell hinges on the interplay of key transcription factors. This modeling exercise [@problem_id:2853003] introduces a systems biology approach, using a Boolean network to represent the core logic of this cellular decision-making process, and illustrates how the antagonistic interactions between master regulators like BCL6 and Blimp-1 create stable cell fates.", "problem": "In the differentiation of B lymphocytes, B-cell lymphoma 6 (BCL6), Interferon Regulatory Factor 4 (IRF4), BTB and CNC Homology 2 (Bach2), and B lymphocyte-induced maturation protein 1 (Blimp-1) form a core transcriptional circuit whose antagonism and activation underlie the heterogeneity of B cell memory. Well-tested observations include: BCL6 is required for germinal center and memory fate and represses IRF4; IRF4 at sustained or high levels promotes Blimp-1 expression and plasma cell fate while repressing Bach2; Bach2 supports memory by promoting BCL6 and repressing Blimp-1; Blimp-1 antagonizes BCL6. In a minimal coarse-grained formulation, these interactions can be encoded by a synchronous Boolean gene regulatory network with nodes $B$ (BCL6), $I$ (IRF4), $A$ (Bach2), and $P$ (Blimp-1), where $1$ denotes transcriptionally active/high and $0$ denotes inactive/low. Activation is represented as a logical conjunction and inhibition as a logical negation. Consider the following minimal update rules consistent with these interactions:\n- $B(t+1) = A(t) \\land \\neg P(t)$,\n- $P(t+1) = I(t) \\land \\neg A(t)$,\n- $A(t+1) = B(t) \\land \\neg I(t)$,\n- $I(t+1) = \\neg B(t)$.\nA Boolean steady state is an assignment $(B,I,A,P)\\in\\{0,1\\}^4$ such that $B(t+1)=B(t)$, $I(t+1)=I(t)$, $A(t+1)=A(t)$, and $P(t+1)=P(t)$. Define a memory-phenotype steady state as one with $B=1$ and $P=0$, and a plasma-phenotype steady state as one with $B=0$ and $P=1$. Starting from the definitions above and the network rules, determine all steady states and classify them by phenotype. Then compute the fraction of all steady states that correspond to the memory phenotype. Express your final answer as a reduced fraction with no units.", "solution": "The problem statement constitutes a valid, well-posed problem in the domain of discrete dynamical systems applied to a biological context. It is scientifically grounded as a standard modeling approach, free of contradictions, and contains all necessary information for a unique solution. We shall proceed with the formal analysis.\n\nThe system under consideration is a synchronous Boolean network with four nodes, denoted by the variables $B$, $I$, $A$, and $P$, each taking values in $\\{0, 1\\}$. A steady state is a state vector $(B, I, A, P)$ that remains unchanged by the application of the update rules. This condition translates to a system of four simultaneous Boolean equations:\n$$B = A \\land \\neg P \\quad (1)$$\n$$P = I \\land \\neg A \\quad (2)$$\n$$A = B \\land \\neg I \\quad (3)$$\n$$I = \\neg B \\quad (4)$$\nWe must find all state vectors $(B, I, A, P) \\in \\{0, 1\\}^4$ that satisfy these four equations. The most direct method is algebraic substitution.\n\nFrom equation $(4)$, the value of $I$ is determined exclusively by the value of $B$. We substitute this expression for $I$ into equation $(3)$:\n$$A = B \\land \\neg(\\neg B)$$\nBy the law of double negation in Boolean algebra, $\\neg(\\neg X) = X$ for any Boolean variable $X$. The equation simplifies to:\n$$A = B \\land B$$\nBy the idempotent law of conjunction, $X \\land X = X$. Therefore, we find a necessary condition for any steady state:\n$$A = B$$\nThis implies that in any steady state, the nodes $A$ and $B$ must have identical values.\n\nWe now have two variables, $A$ and $I$, expressed in terms of $B$: $A = B$ and $I = \\neg B$. We can use these relations to simplify the remaining equations. Let us substitute them into equation $(2)$:\n$$P = I \\land \\neg A$$\n$$P = (\\neg B) \\land (\\neg B)$$\nApplying the idempotent law again, we obtain:\n$$P = \\neg B$$\nThis result establishes that the value of $P$ is also determined solely by the value of $B$.\n\nAt this point, we have derived the following set of necessary conditions for any steady state:\n$$A = B$$\n$$I = \\neg B$$\n$$P = \\neg B$$\nThese relations imply that the entire state vector $(B, I, A, P)$ is defined by the value of the single variable $B$. To confirm that these relations are sufficient and self-consistent, we must substitute them back into the one remaining unused equation, equation $(1)$:\n$$B = A \\land \\neg P$$\n$$B = (B) \\land \\neg(\\neg B)$$\n$$B = B \\land B$$\n$$B = B$$\nThis equation reduces to a tautology, an identity that is true for any value of $B$. It imposes no additional constraints on $B$. Therefore, any state vector of the form $(B, \\neg B, B, \\neg B)$ is a valid steady state of the system.\n\nSince $B$ is a Boolean variable, it can assume two possible values, $0$ or $1$. Each value of $B$ defines a unique steady state.\n\nCase 1: $B = 0$.\nThe values of the other variables are:\n$I = \\neg 0 = 1$\n$A = 0$\n$P = \\neg 0 = 1$\nThis gives the steady state $(B, I, A, P) = (0, 1, 0, 1)$.\n\nCase 2: $B = 1$.\nThe values of the other variables are:\n$I = \\neg 1 = 0$\n$A = 1$\n$P = \\neg 1 = 0$\nThis gives the steady state $(B, I, A, P) = (1, 0, 1, 0)$.\n\nWe have rigorously determined that the system possesses exactly two steady states. The next task is to classify them according to the given definitions:\n- Memory-phenotype steady state: $B=1$ and $P=0$.\n- Plasma-phenotype steady state: $B=0$ and $P=1$.\n\nLet us classify the two states we found:\n1. The steady state $(1, 0, 1, 0)$ has $B=1$ and $P=0$. This configuration precisely matches the definition of a memory-phenotype steady state.\n2. The steady state $(0, 1, 0, 1)$ has $B=0$ and $P=1$. This configuration precisely matches the definition of a plasma-phenotype steady state.\n\nThe total number of steady states is $N_{\\text{total}} = 2$. The number of steady states corresponding to the memory phenotype is $N_{\\text{memory}} = 1$. The problem asks for the fraction of all steady states that correspond to the memory phenotype. This fraction is calculated as:\n$$\\text{Fraction} = \\frac{N_{\\text{memory}}}{N_{\\text{total}}} = \\frac{1}{2}$$\nThe fraction is in its simplest reduced form.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2853003"}]}