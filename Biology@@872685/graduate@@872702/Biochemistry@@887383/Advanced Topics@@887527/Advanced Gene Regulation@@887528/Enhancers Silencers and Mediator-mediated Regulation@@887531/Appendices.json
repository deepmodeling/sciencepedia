{"hands_on_practices": [{"introduction": "The regulation of gene expression begins with the physical interaction between a transcription factor (TF) and its specific DNA binding site within a regulatory element like an enhancer. This foundational exercise guides you through deriving the quantitative relationship between TF concentration, binding affinity ($K_d$), and the probability that an enhancer site is occupied. Mastering this simple equilibrium model provides the essential framework for understanding how cells tune gene activity in response to changing TF levels. [@problem_id:2560115]", "problem": "A eukaryotic gene is controlled by an enhancer that recruits a specific transcription factor (TF) and, upon TF binding, engages the Mediator complex to stimulate transcription at the promoter. Assume a single, non-cooperative, specific TF binding site within the enhancer, with two mutually exclusive states: free or TF-bound. Let the dissociation constant be $K_{d}$ and the free transcription factor concentration be $[\\mathrm{TF}]$. Assume the number of binding sites is sufficiently small that $[\\mathrm{TF}]$ is not depleted by binding (the dilute binding site approximation). Starting from the law of mass action and the definition of the dissociation constant, derive an expression for the equilibrium probability $P$ that the enhancer site is occupied by TF, written solely in terms of $[\\mathrm{TF}]$ and $K_{d}$. Then, using your derived expression, compute $P$ for $K_{d}=10\\,\\text{nM}$ at $[\\mathrm{TF}]=2\\,\\text{nM}$, $[\\mathrm{TF}]=10\\,\\text{nM}$, and $[\\mathrm{TF}]=50\\,\\text{nM}$. \n\n- Express each occupancy as a decimal fraction (no percent sign). \n- Round each value to four significant figures. \n- Report your three numerical results as a single row vector in the order corresponding to $[\\mathrm{TF}]=2\\,\\text{nM},\\,10\\,\\text{nM},\\,50\\,\\text{nM}$. \n- The occupancy $P$ is dimensionless; do not include units in your final reported vector.", "solution": "The problem statement is accepted as valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a solution based on fundamental principles of chemical kinetics and equilibrium.\n\nThe problem asks for the derivation of the probability of a transcription factor (TF) occupying its binding site on an enhancer, based on the principles of mass-action kinetics. Let $E$ represent the free enhancer binding site, $TF$ the free transcription factor, and $E \\cdot TF$ the complex formed when the TF is bound to the site. The reversible binding reaction is described as:\n$$ E + \\text{TF} \\rightleftharpoons E \\cdot \\text{TF} $$\nThe forward reaction (association) is characterized by the rate constant $k_{on}$, and the reverse reaction (dissociation) by the rate constant $k_{off}$.\n\nAt equilibrium, the rate of association equals the rate of dissociation. The rate of association is proportional to the product of the concentrations of the reactants, $[E]$ and $[\\text{TF}]$. The rate of dissociation is proportional to the concentration of the complex, $[E \\cdot \\text{TF}]$. Thus, at equilibrium:\n$$ \\text{Rate}_{\\text{on}} = \\text{Rate}_{\\text{off}} $$\n$$ k_{on} [E] [\\text{TF}] = k_{off} [E \\cdot \\text{TF}] $$\nThe dissociation constant, $K_{d}$, is defined as the ratio of the dissociation rate constant to the association rate constant, $K_{d} = \\frac{k_{off}}{k_{on}}$. Rearranging the equilibrium rate equation gives the definition of $K_{d}$ in terms of concentrations:\n$$ K_{d} = \\frac{[E] [\\text{TF}]}{[E \\cdot \\text{TF}]} $$\nThe problem asks for the equilibrium probability $P$ that the enhancer site is occupied. This probability is the fraction of the total number of enhancer sites that are in the bound state. Let $[E]_{\\text{total}}$ be the total concentration of enhancer sites. By conservation of mass, the total concentration of sites is the sum of the concentration of free sites and bound sites:\n$$ [E]_{\\text{total}} = [E] + [E \\cdot \\text{TF}] $$\nThe probability of occupancy, $P$, is therefore:\n$$ P = \\frac{[E \\cdot \\text{TF}]}{[E]_{\\text{total}}} = \\frac{[E \\cdot \\text{TF}]}{[E] + [E \\cdot \\text{TF}]} $$\nTo express $P$ solely in terms of $[\\text{TF}]$ and $K_{d}$, we must eliminate $[E]$ and $[E \\cdot \\text{TF}]$ as independent variables. From the definition of $K_{d}$, we can express the concentration of free sites, $[E]$, in terms of the other quantities:\n$$ [E] = K_{d} \\frac{[E \\cdot \\text{TF}]}{[\\text{TF}]} $$\nSubstitute this expression for $[E]$ into the equation for $P$:\n$$ P = \\frac{[E \\cdot \\text{TF}]}{\\left( K_{d} \\frac{[E \\cdot \\text{TF}]}{[\\text{TF}]} \\right) + [E \\cdot \\text{TF}]} $$\nThe term $[E \\cdot \\text{TF}]$ is common to the numerator and the denominator and can be factored out from the denominator:\n$$ P = \\frac{[E \\cdot \\text{TF}]}{[E \\cdot \\text{TF}] \\left( \\frac{K_{d}}{[\\text{TF}]} + 1 \\right)} $$\nAssuming $[E \\cdot \\text{TF}] \\neq 0$ (i.e., binding is possible), we can cancel this term:\n$$ P = \\frac{1}{\\frac{K_{d}}{[\\text{TF}]} + 1} $$\nTo simplify this complex fraction, we multiply the numerator and the denominator by $[\\text{TF}]$:\n$$ P = \\frac{1 \\cdot [\\text{TF}]}{\\left( \\frac{K_{d}}{[\\text{TF}]} + 1 \\right) \\cdot [\\text{TF}]} = \\frac{[\\text{TF}]}{K_{d} + [\\text{TF}]} $$\nThis is the required expression for the equilibrium probability of occupancy, $P$. This result is a form of the Langmuir isotherm, which correctly describes single-site, non-cooperative binding. The problem states that the concentration of free transcription factor, $[\\text{TF}]$, is not significantly depleted by binding, which justifies treating $[\\text{TF}]$ as a constant parameter.\n\nNow, we compute the numerical values of $P$ for the given parameters. The dissociation constant is given as $K_{d} = 10\\,\\text{nM}$. We must calculate $P$ for three different concentrations of $[\\text{TF}]$.\n\nCase 1: $[\\text{TF}] = 2\\,\\text{nM}$\n$$ P_{1} = \\frac{2\\,\\text{nM}}{10\\,\\text{nM} + 2\\,\\text{nM}} = \\frac{2}{12} = \\frac{1}{6} \\approx 0.16666... $$\nRounding to four significant figures, we get $P_{1} = 0.1667$.\n\nCase 2: $[\\text{TF}] = 10\\,\\text{nM}$\n$$ P_{2} = \\frac{10\\,\\text{nM}}{10\\,\\text{nM} + 10\\,\\text{nM}} = \\frac{10}{20} = \\frac{1}{2} = 0.5 $$\nTo four significant figures, this is $P_{2} = 0.5000$. Note that when $[\\text{TF}] = K_{d}$, the site is exactly half-occupied. This is the operational definition of the dissociation constant.\n\nCase 3: $[\\text{TF}] = 50\\,\\text{nM}$\n$$ P_{3} = \\frac{50\\,\\text{nM}}{10\\,\\text{nM} + 50\\,\\text{nM}} = \\frac{50}{60} = \\frac{5}{6} \\approx 0.83333... $$\nRounding to four significant figures, we get $P_{3} = 0.8333$.\n\nThe final answer should report these three values as a single row vector in the specified order.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1667  0.5000  0.8333\n\\end{pmatrix}\n}\n$$", "id": "2560115"}, {"introduction": "Real enhancers are rarely governed by a single binding event; instead, they often function as complex information-processing hubs containing multiple TF binding sites. This practice explores how cooperative interactions between TFs bound to adjacent sites can generate highly non-linear, switch-like transcriptional responses. By quantitatively comparing the effects of different mutations, you will uncover how the specific architecture of an enhancer is critical for its regulatory logic and robustness. [@problem_id:2560089]", "problem": "A eukaryotic enhancer contains two identical binding sites for a transcriptional activator that engage in positive cooperativity and communicate with the Mediator complex to recruit RNA Polymerase II (Pol II). Assume the following fundamental base and model elements, all justified by equilibrium thermodynamics and the law of mass action:\n\n- The Central Dogma links transcriptional output to the probability that Pol II assembles into a productive complex, which increases when one or more activator molecules are bound and communicates via Mediator.\n- At equilibrium, the fractional occupancy of binding states arises from Boltzmann weights or, equivalently, from mass-action terms. For two identical sites with positive cooperativity, there are three classes of states: no activator bound, one activator bound, and two activators bound; the two-bound state is stabilized by a cooperative interaction.\n- Transcriptional output is approximated as a linear functional of occupancy states: when one activator is bound, Mediator-Pol II assembly is modestly stimulated; when both are bound, Mediator-Pol II assembly is strongly stimulated due to cooperative recruitment. Basal output exists but is small compared to activation by the activator.\n\nYou are given parameters for a wild-type enhancer at a fixed nuclear activator concentration:\n- Activator concentration is $[A] = 20\\,\\mathrm{nM}$.\n- Each site has dissociation constant $K_d = 10\\,\\mathrm{nM}$ in the wild-type.\n- The cooperative interaction between the two bound activators is described by a dimensionless factor $\\omega = 20$ (so that the doubly bound state is $\\omega$-fold stabilized relative to independent binding).\n- The transcriptional output is modeled as $r = r_0 + \\alpha_1 P_1 + \\alpha_2 P_2$, where $P_1$ and $P_2$ are the probabilities of having one and two activators bound, respectively; $r_0 = 0.10$ (arbitrary units), $\\alpha_1 = 1.0$, and $\\alpha_2 = 10.0$.\n\nConsider two perturbations:\n- Perturbation M1 (scramble): One of the two binding sites is abolished (scrambled) without changing the other site’s affinity.\n- Perturbation M2 (weaken): Both sites remain intact but are modestly weakened to $\\tilde{K}_d = 30\\,\\mathrm{nM}$, with the same cooperativity $\\omega$.\n\nUsing only the fundamental base above (equilibrium binding, mass action, and the definition of cooperativity) to derive the necessary occupancy probabilities and assemble the predicted transcriptional outputs, which statement best describes the expected effect on expression at $[A] = 20\\,\\mathrm{nM}$ and justifies it by occupancy and cooperativity arguments?\n\nA. At $[A] = 20\\,\\mathrm{nM}$, scrambling one site (M1) causes a much larger reduction in expression than weakening both sites to $\\tilde{K}_d = 30\\,\\mathrm{nM}$ (M2), because positive cooperativity preserves high double occupancy under M2, which sustains Mediator-driven activation.\n\nB. At $[A] = 20\\,\\mathrm{nM}$, weakening both sites to $\\tilde{K}_d = 30\\,\\mathrm{nM}$ (M2) causes a larger reduction than scrambling one site (M1), because loss of affinity at both sites suppresses all bound states more than loss of a single site.\n\nC. At $[A] = 20\\,\\mathrm{nM}$, both perturbations reduce output by approximately the same factor, since the total number of potential binding events lost is one in either case.\n\nD. At very high activator concentration $[A]$, scrambling one site (M1) and weakening both (M2) become equivalent in their effect on the maximal output.", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n\n- System: A eukaryotic enhancer with two identical binding sites for a transcriptional activator, $A$.\n- Activator concentration: $[A] = 20\\,\\mathrm{nM}$.\n- Wild-type dissociation constant for each site: $K_d = 10\\,\\mathrm{nM}$.\n- Cooperativity factor for the doubly bound state: $\\omega = 20$.\n- Model for transcriptional output: $r = r_0 + \\alpha_1 P_1 + \\alpha_2 P_2$.\n- Basal output: $r_0 = 0.10$ arbitrary units.\n- Output coefficient for one activator bound: $\\alpha_1 = 1.0$.\n- Output coefficient for two activators bound: $\\alpha_2 = 10.0$.\n- $P_1$ is the probability of one activator being bound.\n- $P_2$ is the probability of two activators being bound.\n- Perturbation M1 (scramble): One binding site is abolished. The remaining site has $K_d = 10\\,\\mathrm{nM}$.\n- Perturbation M2 (weaken): Both sites are weakened to a new dissociation constant $\\tilde{K}_d = 30\\,\\mathrm{nM}$. The cooperativity factor $\\omega = 20$ remains unchanged.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is based on a standard statistical mechanical model of transcription factor binding and gene regulation, which is a cornerstone of quantitative molecular biology. All premises are well-established:\n- **Scientifically Grounded:** The model uses equilibrium thermodynamics, the law of mass action, and a partition function approach (implicitly) to describe ligand-receptor binding with cooperativity. This is a canonical Adair-Klotz or Monod-Wyman-Changeux type model, which is scientifically sound. The link between transcription factor occupancy and transcriptional output is a fundamental concept.\n- **Well-Posed:** All necessary parameters ($[A]$, $K_d$, $\\tilde{K}_d$, $\\omega$, $r_0$, $\\alpha_1$, $\\alpha_2$) are provided. The model for calculating output is explicitly defined. The question asks for a quantitative comparison between defined states, which allows for a unique solution.\n- **Objective:** The language is technical and free of subjectivity. The model, though a simplification of complex biological reality, is presented as such and is self-consistent for the purposes of the problem.\n\nThe problem does not violate any of the invalidity criteria. It is a well-formulated, quantitative problem in biophysics.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. A solution will be derived.\n\n### Derivation of Solution\n\nThe solution requires calculating the transcriptional output for three cases: wild-type (WT), perturbation M1, and perturbation M2. The central task is to find the probabilities of the singly ($P_1$) and doubly ($P_2$) occupied states for each case.\n\nWe use a partition function approach. Let $x = [A]/K_d$ be the dimensionless concentration of the activator. The statistical weights of the states are:\n- Unbound state (0 activators): weight = $1$.\n- Singly bound state (1 activator): there are $2$ sites, so weight = $2x$.\n- Doubly bound state (2 activators): due to cooperativity $\\omega$, weight = $\\omega x^2$.\n\nThe partition function, $Z$, is the sum of these weights:\n$$Z = 1 + 2x + \\omega x^2$$\n\nThe probabilities of the states are the statistical weights divided by the partition function:\n$$P_1 = \\frac{2x}{Z} = \\frac{2x}{1 + 2x + \\omega x^2}$$\n$$P_2 = \\frac{\\omega x^2}{Z} = \\frac{\\omega x^2}{1 + 2x + \\omega x^2}$$\n\nThe transcriptional output is given by $r = r_0 + \\alpha_1 P_1 + \\alpha_2 P_2$.\n\n**Case 1: Wild-Type (WT)**\nParameters: $[A] = 20\\,\\mathrm{nM}$, $K_d = 10\\,\\mathrm{nM}$, $\\omega = 20$.\nThe dimensionless concentration is $x_{WT} = \\frac{[A]}{K_d} = \\frac{20\\,\\mathrm{nM}}{10\\,\\mathrm{nM}} = 2$.\n\nThe partition function is:\n$$Z_{WT} = 1 + 2(2) + 20(2^2) = 1 + 4 + 80 = 85$$\n\nThe probabilities are:\n$$P_{1,WT} = \\frac{2(2)}{85} = \\frac{4}{85}$$\n$$P_{2,WT} = \\frac{20(2^2)}{85} = \\frac{80}{85}$$\n\nThe transcriptional output is:\n$$r_{WT} = r_0 + \\alpha_1 P_{1,WT} + \\alpha_2 P_{2,WT} = 0.10 + 1.0\\left(\\frac{4}{85}\\right) + 10.0\\left(\\frac{80}{85}\\right)$$\n$$r_{WT} = 0.10 + \\frac{4 + 800}{85} = 0.10 + \\frac{804}{85} \\approx 0.10 + 9.4588 = 9.5588$$\n\n**Case 2: Perturbation M1 (one site scrambled)**\nWith only one binding site, the system is non-cooperative. The states are unbound and bound.\nThe partition function is $Z_{M1} = 1 + \\frac{[A]}{K_d}$.\nThe probability of the site being occupied is $P_1$. Since there is no second site, $P_2=0$.\n$x_{M1} = \\frac{[A]}{K_d} = \\frac{20\\,\\mathrm{nM}}{10\\,\\mathrm{nM}} = 2$.\nSo, $P_{1,M1} = \\frac{x_{M1}}{1+x_{M1}} = \\frac{2}{1+2} = \\frac{2}{3}$.\nAnd $P_{2,M1} = 0$.\n\nThe transcriptional output is:\n$$r_{M1} = r_0 + \\alpha_1 P_{1,M1} + \\alpha_2 P_{2,M1} = 0.10 + 1.0\\left(\\frac{2}{3}\\right) + 10.0(0)$$\n$$r_{M1} \\approx 0.10 + 0.6667 = 0.7667$$\n\n**Case 3: Perturbation M2 (both sites weakened)**\nThe system retains two sites and cooperativity.\nParameters: $[A] = 20\\,\\mathrm{nM}$, $\\tilde{K}_d = 30\\,\\mathrm{nM}$, $\\omega = 20$.\nThe dimensionless concentration is $x_{M2} = \\frac{[A]}{\\tilde{K}_d} = \\frac{20\\,\\mathrm{nM}}{30\\,\\mathrm{nM}} = \\frac{2}{3}$.\n\nThe partition function is:\n$$Z_{M2} = 1 + 2x_{M2} + \\omega x_{M2}^2 = 1 + 2\\left(\\frac{2}{3}\\right) + 20\\left(\\frac{2}{3}\\right)^2 = 1 + \\frac{4}{3} + 20\\left(\\frac{4}{9}\\right) = 1 + \\frac{4}{3} + \\frac{80}{9}$$\n$$Z_{M2} = \\frac{9}{9} + \\frac{12}{9} + \\frac{80}{9} = \\frac{101}{9}$$\n\nThe probabilities are:\n$$P_{1,M2} = \\frac{2(2/3)}{101/9} = \\frac{4/3}{101/9} = \\frac{4}{3} \\cdot \\frac{9}{101} = \\frac{12}{101}$$\n$$P_{2,M2} = \\frac{20(2/3)^2}{101/9} = \\frac{80/9}{101/9} = \\frac{80}{101}$$\n\nThe transcriptional output is:\n$$r_{M2} = r_0 + \\alpha_1 P_{1,M2} + \\alpha_2 P_{2,M2} = 0.10 + 1.0\\left(\\frac{12}{101}\\right) + 10.0\\left(\\frac{80}{101}\\right)$$\n$$r_{M2} = 0.10 + \\frac{12 + 800}{101} = 0.10 + \\frac{812}{101} \\approx 0.10 + 8.0396 = 8.1396$$\n\n**Comparison of Outputs and Reductions**\n- Wild-type output: $r_{WT} \\approx 9.56$\n- M1 output: $r_{M1} \\approx 0.77$\n- M2 output: $r_{M2} \\approx 8.14$\n\nThe reduction in expression for M1 is $r_{WT} - r_{M1} \\approx 9.56 - 0.77 = 8.79$.\nThe reduction in expression for M2 is $r_{WT} - r_{M2} \\approx 9.56 - 8.14 = 1.42$.\n\nThe reduction caused by scrambling one site (M1) is substantially larger than the reduction caused by weakening both sites (M2).\n\n### Evaluation of Options\n\n**A. At $[A] = 20\\,\\mathrm{nM}$, scrambling one site (M1) causes a much larger reduction in expression than weakening both sites to $\\tilde{K}_d = 30\\,\\mathrm{nM}$ (M2), because positive cooperativity preserves high double occupancy under M2, which sustains Mediator-driven activation.**\nThe first part of the statement is confirmed by our calculation ($8.79$ reduction for M1 vs. $1.42$ for M2).\nThe justification rests on occupancy. Let's inspect the probabilities of the doubly bound state, $P_2$, which is heavily weighted in the output ($\\alpha_2 = 10.0$).\n- WT: $P_{2,WT} = 80/85 \\approx 0.941$\n- M1: $P_{2,M1} = 0$\n- M2: $P_{2,M2} = 80/101 \\approx 0.792$\nIn M1, the highly productive doubly occupied state is completely eliminated. In M2, despite the weaker intrinsic affinity, the strong cooperativity ($\\omega=20$) ensures that the doubly occupied state remains the most probable state ($P_2 \\approx 0.792$ is much larger than $P_1 \\approx 0.119$ and $P_0 \\approx 0.089$). This high $P_2$ sustains a high level of transcriptional output. The justification is correct.\n**Verdict: Correct.**\n\n**B. At $[A] = 20\\,\\mathrm{nM}$, weakening both sites to $\\tilde{K}_d = 30\\,\\mathrm{nM}$ (M2) causes a larger reduction than scrambling one site (M1), because loss of affinity at both sites suppresses all bound states more than loss of a single site.**\nThis statement is factually incorrect as per our calculation. The reduction from M1 is much larger than from M2. The reasoning is flawed; it ignores the catastrophic effect of eliminating the cooperative, high-output $P_2$ state in M1.\n**Verdict: Incorrect.**\n\n**C. At $[A] = 20\\,\\mathrm{nM}$, both perturbations reduce output by approximately the same factor, since the total number of potential binding events lost is one in either case.**\nThis statement is factually incorrect. The final outputs ($r_{M1} \\approx 0.77$, $r_{M2} \\approx 8.14$) and the reductions are vastly different. The reasoning is a gross oversimplification that is not based on the provided thermodynamic model.\n**Verdict: Incorrect.**\n\n**D. At very high activator concentration $[A]$, scrambling one site (M1) and weakening both (M2) become equivalent in their effect on the maximal output.**\nTo evaluate this, we consider the limit $[A] \\rightarrow \\infty$.\n- For M1 (one site): As $[A] \\rightarrow \\infty$, the single site becomes saturated, so $P_{1,M1} \\rightarrow 1$ and $P_{2,M1}=0$. The maximal output is $r_{M1,max} = r_0 + \\alpha_1(1) + \\alpha_2(0) = 0.10 + 1.0 = 1.1$.\n- For M2 (two cooperative sites): As $[A] \\rightarrow \\infty$, both sites will be saturated due to the law of mass action, so $P_{2,M2} \\rightarrow 1$ and $P_{1,M2} \\rightarrow 0$. The weakening of $K_d$ only affects how quickly this saturation is reached, not the final saturated state. The maximal output is $r_{M2,max} = r_0 + \\alpha_1(0) + \\alpha_2(1) = 0.10 + 10.0 = 10.1$.\nThe maximal outputs, $1.1$ and $10.1$, are not equivalent. Eliminating a site fundamentally limits the maximal achievable output, while weakening sites does not.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2560089"}, {"introduction": "The principles of TF binding and chromatin modification leave distinct biochemical \"signatures\" across the genome, allowing us to identify regulatory elements on a massive scale. This advanced practice bridges theory and application, challenging you to design a computational classifier based on the characteristic histone mark profiles of enhancers, promoters, and silencers. By formalizing biological knowledge into a statistical model, you will gain insight into how modern bioinformatics leverages epigenomic data to map and understand the regulatory landscape of the cell. [@problem_id:2560065]", "problem": "You are given normalized Chromatin Immunoprecipitation followed by Sequencing (ChIP-seq) signals for four histone marks associated with cis-regulatory states in eukaryotic chromatin: acetylation of histone H3 at lysine 27 ($\\text{H3K27ac}$), monomethylation of histone H3 at lysine 4 ($\\text{H3K4me1}$), trimethylation of histone H3 at lysine 4 ($\\text{H3K4me3}$), and trimethylation of histone H3 at lysine 27 ($\\text{H3K27me3}$). Each signal is a real number in the closed interval $[0,1]$ representing a unitless normalized occupancy score. The task is to design and implement a principled classifier that assigns each element to one of three chromatin states: enhancer, promoter, or silencer, on the basis of first principles and well-established biochemical knowledge, and to justify the decision boundaries used.\n\nFundamental base and modeling assumptions to use:\n- The Central Dogma of molecular biology and the core principles of chromatin-mediated gene regulation: active enhancers and promoters are typically associated with high acetylation such as $\\text{H3K27ac}$, active enhancers are enriched for $\\text{H3K4me1}$, active promoters are enriched for $\\text{H3K4me3}$, and Polycomb-repressed regions (canonical silencers) are enriched for $\\text{H3K27me3}$.\n- The Mediator complex (a large multi-subunit transcriptional coactivator) promotes RNA polymerase II initiation and enhancer–promoter communication and is preferentially recruited in acetylated, activation-favored chromatin. In contrast, enrichment of repressive methylation such as $\\text{H3K27me3}$ disfavors Mediator recruitment.\n- Statistical modeling assumption: conditioned on the latent class $C \\in \\{\\text{enhancer},\\text{promoter},\\text{silencer}\\}$, the observed feature vector $\\mathbf{x} = (x_1, x_2, x_3, x_4)$, corresponding respectively to $(\\text{H3K27ac}, \\text{H3K4me1}, \\text{H3K4me3}, \\text{H3K27me3})$, is drawn from a multivariate normal distribution with class-specific mean $\\boldsymbol{\\mu}_C$ and a class-independent diagonal covariance matrix $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2,\\sigma_4^2)$.\n- Equal base class priors are assumed: $\\pi_{\\text{enh}} = \\pi_{\\text{pro}} = \\pi_{\\text{sil}} = 1/3$.\n- To reflect Mediator-mediated regulation, introduce a multiplicative, strictly positive, element-specific weighting of class evidence $w_C(\\mathbf{x}) = \\exp\\{\\lambda\\, s_C(\\mathbf{x})\\}$, where $s_C(\\mathbf{x})$ is a linear function capturing how compatible the chromatin context is with Mediator-supported activation for class $C$, and $\\lambda  0$ controls the modulation strength. This acts as a context-dependent factor that increases evidence for enhancer and promoter classes in acetylated contexts and increases evidence for the silencer class in $\\text{H3K27me3}$-rich contexts.\n\nUse the following quantitative model parameters, chosen to reflect the biochemical priors:\n- Class means:\n  - Enhancer: $\\boldsymbol{\\mu}_{\\text{enh}} = (0.80,\\,0.70,\\,0.10,\\,0.05)$.\n  - Promoter: $\\boldsymbol{\\mu}_{\\text{pro}} = (0.60,\\,0.20,\\,0.80,\\,0.05)$.\n  - Silencer: $\\boldsymbol{\\mu}_{\\text{sil}} = (0.05,\\,0.10,\\,0.05,\\,0.85)$.\n- Diagonal standard deviations: $(\\sigma_1, \\sigma_2, \\sigma_3, \\sigma_4) = (0.15,\\,0.15,\\,0.15,\\,0.15)$, so that $\\boldsymbol{\\Sigma} = \\mathrm{diag}(0.15^2, 0.15^2, 0.15^2, 0.15^2)$.\n- Mediator compatibility linear scores:\n  - $s_{\\text{enh}}(\\mathbf{x}) = x_1 + 0.8\\,x_2 - 0.5\\,x_3 - 0.8\\,x_4$.\n  - $s_{\\text{pro}}(\\mathbf{x}) = x_3 + 0.5\\,x_1 - 0.5\\,x_2 - 0.5\\,x_4$.\n  - $s_{\\text{sil}}(\\mathbf{x}) = x_4 - 0.5\\,x_1 - 0.3\\,x_2 - 0.3\\,x_3$.\n- Mediator modulation strength: $\\lambda = 1.0$.\n\nTask requirements:\n1. Starting from Bayes’ theorem and the multivariate normal likelihood with diagonal covariance, derive the decision rule that selects the class $C$ maximizing the log posterior score\n   $$g_C(\\mathbf{x}) = \\log p(\\mathbf{x}\\mid C) + \\log \\pi_C + \\log w_C(\\mathbf{x}),$$\n   expressed explicitly in terms of $\\mathbf{x}$, $\\boldsymbol{\\mu}_C$, $\\boldsymbol{\\Sigma}$, $\\lambda$, and $s_C(\\mathbf{x})$. You must reason from these bases without invoking any shortcut formulas that skip the derivation.\n2. Implement the resulting classifier as a program that, for each test element, computes $g_C(\\mathbf{x})$ for $C \\in \\{\\text{enhancer},\\text{promoter},\\text{silencer}\\}$ and returns the class with the largest $g_C(\\mathbf{x})$. Map the classes to integers using the convention: enhancer $\\mapsto 1$, promoter $\\mapsto 2$, silencer $\\mapsto 3$. If there is an exact tie in $g_C(\\mathbf{x})$, break ties by choosing the class with the smallest mapped integer.\n3. Use the following test suite of ten elements, each specified as $(x_1, x_2, x_3, x_4) = (\\text{H3K27ac}, \\text{H3K4me1}, \\text{H3K4me3}, \\text{H3K27me3})$ with each $x_i$ in $[0,1]$:\n   - $[0.85,\\, 0.70,\\, 0.10,\\, 0.05]$\n   - $[0.60,\\, 0.20,\\, 0.80,\\, 0.05]$\n   - $[0.05,\\, 0.10,\\, 0.05,\\, 0.85]$\n   - $[0.30,\\, 0.15,\\, 0.60,\\, 0.60]$\n   - $[0.45,\\, 0.50,\\, 0.15,\\, 0.10]$\n   - $[0.20,\\, 0.70,\\, 0.10,\\, 0.20]$\n   - $[0.45,\\, 0.25,\\, 0.75,\\, 0.08]$\n   - $[0.10,\\, 0.10,\\, 0.10,\\, 0.70]$\n   - $[0.05,\\, 0.05,\\, 0.05,\\, 0.05]$\n   - $[0.70,\\, 0.50,\\, 0.70,\\, 0.70]$\n4. Final output format: Your program should produce a single line of output containing the classification results for the ten test cases as a comma-separated list of integers enclosed in square brackets (for example, $[1,2,3]$). No spaces are allowed in the output line. The return type is therefore a list of integers.\n\nNo physical units or angles are involved. Ensure that the implementation strictly follows the statistical model and mapping described above, with all computations performed in real arithmetic on the given normalized inputs.", "solution": "We begin from Bayes’ theorem. For a class label $C \\in \\{\\text{enhancer}, \\text{promoter}, \\text{silencer}\\}$ and observed feature vector $\\mathbf{x} \\in \\mathbb{R}^4$, the posterior is\n$$\np(C \\mid \\mathbf{x}) \\propto p(\\mathbf{x} \\mid C)\\,\\pi_C\\,w_C(\\mathbf{x}),\n$$\nwhere $\\pi_C$ is the class prior and $w_C(\\mathbf{x})$ is a strictly positive weighting that captures the context-dependent effect of the Mediator complex on the evidence for class $C$ in the local chromatin environment. This multiplicative factor is consistent with a log-additive adjustment to the energy or discriminant, which preserves argmax decisions. Since the base priors are equal, $\\pi_{\\text{enh}} = \\pi_{\\text{pro}} = \\pi_{\\text{sil}} = 1/3$, the prior contributes a constant $\\log \\pi_C$ that does not affect class comparisons; nevertheless we retain it in the derivation for completeness.\n\nThe class-conditional density is modeled as a multivariate normal with diagonal covariance:\n$$\np(\\mathbf{x} \\mid C) = \\frac{1}{(2\\pi)^{2}\\,\\prod_{i=1}^{4}\\sigma_i}\\,\\exp\\left(-\\frac{1}{2}\\sum_{i=1}^{4}\\frac{(x_i - \\mu_{C,i})^2}{\\sigma_i^2}\\right),\n$$\nwhere $\\boldsymbol{\\mu}_C = (\\mu_{C,1},\\mu_{C,2},\\mu_{C,3},\\mu_{C,4})$ is the class mean and $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2,\\sigma_4^2)$ with $(\\sigma_1,\\sigma_2,\\sigma_3,\\sigma_4) = (0.15,0.15,0.15,0.15)$.\n\nThe Mediator compatibility is encoded as\n$$\nw_C(\\mathbf{x}) = \\exp\\{\\lambda\\, s_C(\\mathbf{x})\\}, \\quad \\lambda = 1.0,\n$$\nwith linear scores\n$$\n\\begin{aligned}\ns_{\\text{enh}}(\\mathbf{x}) = x_1 + 0.8\\,x_2 - 0.5\\,x_3 - 0.8\\,x_4,\\\\\ns_{\\text{pro}}(\\mathbf{x}) = x_3 + 0.5\\,x_1 - 0.5\\,x_2 - 0.5\\,x_4,\\\\\ns_{\\text{sil}}(\\mathbf{x}) = x_4 - 0.5\\,x_1 - 0.3\\,x_2 - 0.3\\,x_3.\n\\end{aligned}\n$$\nThese forms reflect well-tested biochemical observations: $\\text{H3K27ac}$ ($x_1$) and $\\text{H3K4me1}$ ($x_2$) favor enhancer activation and recruitment of the Mediator complex; $\\text{H3K4me3}$ ($x_3$) together with some acetylation favors promoter function; and $\\text{H3K27me3}$ ($x_4$) is characteristic of Polycomb-repressed chromatin, disfavoring Mediator-supported activation and thus favoring silencers.\n\nTaking logarithms of the proportional posterior yields the discriminant function:\n$$\n\\begin{aligned}\ng_C(\\mathbf{x}) = \\log p(\\mathbf{x} \\mid C) + \\log \\pi_C + \\log w_C(\\mathbf{x}) \\\\\n= -\\frac{1}{2}\\sum_{i=1}^{4}\\frac{(x_i - \\mu_{C,i})^2}{\\sigma_i^2} - \\sum_{i=1}^{4}\\log(\\sigma_i) - 2\\log(2\\pi) + \\log \\pi_C + \\lambda\\, s_C(\\mathbf{x}).\n\\end{aligned}\n$$\nTerms that are constant across classes, namely $-\\sum_{i=1}^{4}\\log(\\sigma_i) - 2\\log(2\\pi) + \\log \\pi_C$ (given equal priors and common $\\boldsymbol{\\Sigma}$), do not affect the argmax over $C$ and may be dropped for classification. The effective discriminant (up to an additive constant) is therefore\n$$\n\\tilde{g}_C(\\mathbf{x}) = -\\frac{1}{2}\\sum_{i=1}^{4}\\frac{(x_i - \\mu_{C,i})^2}{\\sigma_i^2} + \\lambda\\, s_C(\\mathbf{x}).\n$$\nBecause $\\boldsymbol{\\Sigma}$ is the same across classes and diagonal, the quadratic terms that depend on $\\mathbf{x}$ but not on $\\boldsymbol{\\mu}_C$ cancel pairwise when considering decision boundaries between classes; the resulting boundaries are hyperplanes in $\\mathbf{x}$ when comparing $\\tilde{g}_{C_1}$ and $\\tilde{g}_{C_2}$, with additional linear contributions from the Mediator score differences $\\lambda\\,[s_{C_1}(\\mathbf{x}) - s_{C_2}(\\mathbf{x})]$. This provides a principled, linear decision boundary whose orientation is grounded in both the Gaussian generative model and the biochemical influence of the Mediator complex.\n\nQuantitative parameters for the class means, chosen to reflect canonical chromatin signatures, are:\n- Enhancer: $\\boldsymbol{\\mu}_{\\text{enh}} = (0.80,\\,0.70,\\,0.10,\\,0.05)$.\n- Promoter: $\\boldsymbol{\\mu}_{\\text{pro}} = (0.60,\\,0.20,\\,0.80,\\,0.05)$.\n- Silencer: $\\boldsymbol{\\mu}_{\\text{sil}} = (0.05,\\,0.10,\\,0.05,\\,0.85)$.\n\nAlgorithmic steps:\n1. For each test element $\\mathbf{x}$, compute the three values $\\tilde{g}_{\\text{enh}}(\\mathbf{x})$, $\\tilde{g}_{\\text{pro}}(\\mathbf{x})$, and $\\tilde{g}_{\\text{sil}}(\\mathbf{x})$ using the formula above.\n2. Select the class $C^*(\\mathbf{x}) = \\arg\\max_C \\tilde{g}_C(\\mathbf{x})$. In the event of a floating-point tie, apply the specified tie-break rule by choosing the smallest integer-mapped class (enhancer $=1$, promoter $=2$, silencer $=3$).\n3. Output the mapped integers for the given test suite, in order, as a single line with a bracketed, comma-separated list, with no spaces.\n\nThis procedure unifies a principled statistical discriminant (from the multivariate normal model with equal covariance) with a biologically grounded, Mediator-informed linear modulation term. The equal-covariance assumption yields linear decision boundaries whose geometry can be interpreted: the enhancer–silencer boundary is largely oriented along the $\\text{H3K27ac}$ versus $\\text{H3K27me3}$ axis, while the enhancer–promoter boundary is oriented along the $\\text{H3K4me1}$ versus $\\text{H3K4me3}$ axis. The Mediator modulation shifts these hyperplanes towards activation in acetylated contexts and towards repression in $\\text{H3K27me3}$-rich contexts, aligning the classifier with enhancer–promoter activation and Polycomb-mediated silencing principles.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef gaussian_log_likelihood(x, mu, sigma):\n    # Diagonal covariance: sigma is a 1D array of standard deviations\n    # Compute -0.5 * sum(((x - mu)^2) / sigma^2) - sum(log(sigma)) - 2*log(2*pi)\n    # The constant terms are equal across classes; they can be included or omitted.\n    diff = x - mu\n    inv_var = 1.0 / (sigma ** 2)\n    quad = -0.5 * np.sum((diff ** 2) * inv_var)\n    const = -np.sum(np.log(sigma)) - 2.0 * np.log(2.0 * np.pi)\n    return quad + const\n\ndef mediator_score_enh(x):\n    # s_enh(x) = x1 + 0.8*x2 - 0.5*x3 - 0.8*x4\n    return x[0] + 0.8 * x[1] - 0.5 * x[2] - 0.8 * x[3]\n\ndef mediator_score_pro(x):\n    # s_pro(x) = x3 + 0.5*x1 - 0.5*x2 - 0.5*x4\n    return x[2] + 0.5 * x[0] - 0.5 * x[1] - 0.5 * x[3]\n\ndef mediator_score_sil(x):\n    # s_sil(x) = x4 - 0.5*x1 - 0.3*x2 - 0.3*x3\n    return x[3] - 0.5 * x[0] - 0.3 * x[1] - 0.3 * x[2]\n\ndef solve():\n    # Define model parameters\n    mu_enh = np.array([0.80, 0.70, 0.10, 0.05])\n    mu_pro = np.array([0.60, 0.20, 0.80, 0.05])\n    mu_sil = np.array([0.05, 0.10, 0.05, 0.85])\n    sigma = np.array([0.15, 0.15, 0.15, 0.15])\n    lam = 1.0  # Mediator modulation strength\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        [0.85, 0.70, 0.10, 0.05],\n        [0.60, 0.20, 0.80, 0.05],\n        [0.05, 0.10, 0.05, 0.85],\n        [0.30, 0.15, 0.60, 0.60],\n        [0.45, 0.50, 0.15, 0.10],\n        [0.20, 0.70, 0.10, 0.20],\n        [0.45, 0.25, 0.75, 0.08],\n        [0.10, 0.10, 0.10, 0.70],\n        [0.05, 0.05, 0.05, 0.05],\n        [0.70, 0.50, 0.70, 0.70],\n    ]\n    test_cases = [np.array(tc, dtype=float) for tc in test_cases]\n\n    results = []\n    for x in test_cases:\n        # Compute log-likelihoods\n        ll_enh = gaussian_log_likelihood(x, mu_enh, sigma)\n        ll_pro = gaussian_log_likelihood(x, mu_pro, sigma)\n        ll_sil = gaussian_log_likelihood(x, mu_sil, sigma)\n\n        # Mediator modulation terms (log-space addition)\n        m_enh = lam * mediator_score_enh(x)\n        m_pro = lam * mediator_score_pro(x)\n        m_sil = lam * mediator_score_sil(x)\n\n        # Equal priors: add same constant; can be omitted.\n        # Compute discriminant scores\n        g_enh = ll_enh + m_enh\n        g_pro = ll_pro + m_pro\n        g_sil = ll_sil + m_sil\n\n        scores = np.array([g_enh, g_pro, g_sil])\n        # Argmax with tie-breaking: np.argmax returns the first occurrence of the max\n        cls_index = int(np.argmax(scores)) + 1  # 1: enhancer, 2: promoter, 3: silencer\n        results.append(cls_index)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2560065"}]}