{"hands_on_practices": [{"introduction": "Before embarking on a complex metabolic engineering project, it is essential to establish a theoretical performance ceiling based on fundamental physical laws. This practice introduces the foundational concept of stoichiometric yield calculation, a cornerstone of metabolic analysis. By applying the laws of conservation of mass for key elements, you will determine the maximum possible conversion of a substrate to a product, providing a crucial, pathway-independent benchmark to evaluate the efficiency of engineered strains and guide design strategies [@problem_id:2609259].", "problem": "A metabolic engineering team proposes a heterologous pathway to produce adipic acid from glucose in a growth-decoupled, cell-free setting. You are asked to compute the theoretical maximum molar yield of adipic acid per mole of glucose that is permitted by elemental and redox balances under the following assumptions, which are standard for a stoichiometric upper bound:\n\n- The substrate is glucose, $\\mathrm{C_6H_{12}O_6}$, taken at $1$ mol as the basis.\n- The product is adipic acid, $\\mathrm{C_6H_{10}O_4}$.\n- External species permitted to cross the system boundary in addition to glucose and adipic acid are molecular oxygen $\\mathrm{O_2}$, carbon dioxide $\\mathrm{CO_2}$, and water $\\mathrm{H_2O}$ only. No other external carbon, hydrogen, or oxygen sources or sinks are allowed.\n- There is no biomass formation, no storage, and no accumulation (steady state). All cofactors, including adenosine triphosphate (ATP), nicotinamide adenine dinucleotide (NADH/NAD$^+$), and nicotinamide adenine dinucleotide phosphate (NADPH/NADP$^+$), are internally cycled and do not cross the boundary.\n- Oxygen, if used, acts only as a terminal electron acceptor; its net production is not possible.\n- Ignore maintenance energy and thermodynamic driving forces; use only atomic and electron conservation.\n\nLet the overall reaction be written with unknown stoichiometric coefficients as\n$$\n1\\,\\mathrm{C_6H_{12}O_6} + d\\,\\mathrm{O_2} \\;\\to\\; a\\,\\mathrm{C_6H_{10}O_4} + b\\,\\mathrm{CO_2} + c\\,\\mathrm{H_2O}.\n$$\n\nUsing elemental balances for carbon, hydrogen, and oxygen, together with the requirement that oxygen cannot be a net product, determine the theoretical maximum value of $a$ (mol adipic acid per mol glucose). Express your final answer as an exact fraction (mol/mol). Do not include units in your final answer.\n\nFor context only (no calculation with this number is required), a genome-scale Flux Balance Analysis (FBA) study under fully aerobic conditions reported a maximum network yield of $0.86$ mol adipic acid per mol glucose. Your final answer should be the theoretical maximum yield derived from first principles as specified above.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a well-posed problem in stoichiometric analysis, grounded in the fundamental principle of conservation of mass. It is objective, self-contained, and free from scientific or logical flaws. We may proceed with the solution.\n\nThe problem asks for the theoretical maximum molar yield of adipic acid ($\\mathrm{C_6H_{10}O_4}$) from glucose ($\\mathrm{C_6H_{12}O_6}$), denoted by the stoichiometric coefficient $a$. The analysis is based on the overall reaction stoichiometry provided:\n$$\n1\\,\\mathrm{C_6H_{12}O_6} + d\\,\\mathrm{O_2} \\to a\\,\\mathrm{C_6H_{10}O_4} + b\\,\\mathrm{CO_2} + c\\,\\mathrm{H_2O}\n$$\nThe system is constrained by elemental balances for Carbon (C), Hydrogen (H), and Oxygen (O), and the condition that oxygen cannot be a net product, meaning $d \\ge 0$. We must find the maximum value of $a$ consistent with these constraints.\n\nFirst, we establish the system of linear equations from the elemental balances. All balances are based on $1$ mole of glucose consumed.\n\n$1$. Carbon (C) Balance:\nThe number of carbon atoms on the reactant side is $6 \\times 1 = 6$.\nThe number of carbon atoms on the product side is $a \\times 6 + b \\times 1$.\nEquating the two sides gives the first conservation equation:\n$$6 = 6a + b$$\n\n$2$. Hydrogen (H) Balance:\nThe number of hydrogen atoms on the reactant side is $12 \\times 1 = 12$.\nThe number of hydrogen atoms on the product side is $a \\times 10 + c \\times 2$.\nEquating the two sides gives the second conservation equation:\n$$12 = 10a + 2c$$\nwhich simplifies to:\n$$6 = 5a + c$$\n\n$3$. Oxygen (O) Balance:\nThe number of oxygen atoms on the reactant side is $6 \\times 1 + d \\times 2 = 6 + 2d$.\nThe number of oxygen atoms on the product side is $a \\times 4 + b \\times 2 + c \\times 1$.\nEquating the two sides gives the third conservation equation:\n$$6 + 2d = 4a + 2b + c$$\n\nWe now have a system of three equations with four unknown variables ($a, b, c, d$). Our objective is to maximize $a$. We will express $b$, $c$, and $d$ as functions of $a$.\n\nFrom the carbon balance equation ($1$), we solve for $b$:\n$$b = 6 - 6a$$\n\nFrom the hydrogen balance equation ($2$), we solve for $c$:\n$$c = 6 - 5a$$\n\nNow, we substitute these expressions for $b$ and $c$ into the oxygen balance equation ($3$):\n$$6 + 2d = 4a + 2(6 - 6a) + (6 - 5a)$$\n$$6 + 2d = 4a + 12 - 12a + 6 - 5a$$\nCombine terms on the right-hand side:\n$$6 + 2d = 18 - 13a$$\nNow, solve for $d$ in terms of $a$:\n$$2d = 18 - 6 - 13a$$\n$$2d = 12 - 13a$$\n$$d = \\frac{12 - 13a}{2} = 6 - \\frac{13}{2}a$$\n\nThe problem states that oxygen, if used, acts only as a terminal electron acceptor and its net production is not possible. This imposes the physical constraint that the stoichiometric coefficient for oxygen, $d$, must be non-negative:\n$$d \\ge 0$$\n\nSubstituting our expression for $d$ into this inequality:\n$$6 - \\frac{13}{2}a \\ge 0$$\nTo find the maximum value for $a$, we solve this inequality:\n$$6 \\ge \\frac{13}{2}a$$\n$$12 \\ge 13a$$\n$$a \\le \\frac{12}{13}$$\n\nThis result demonstrates that the molar yield of adipic acid, $a$, cannot exceed $\\frac{12}{13}$. The maximum theoretical yield is achieved when the equality holds, i.e., $a = \\frac{12}{13}$. This corresponds to the case where $d=0$, meaning the process is anaerobic.\n\nTherefore, the theoretical maximum molar yield of adipic acid from glucose, constrained only by elemental balances, is $\\frac{12}{13}$ mol/mol.", "answer": "$$\\boxed{\\frac{12}{13}}$$", "id": "2609259"}, {"introduction": "The overall flux through an engineered metabolic pathway is often limited by the catalytic efficiency of one or more enzymes. This exercise connects the microscopic world of enzyme transition states to the macroscopic goal of improving reaction rates. Using the Eyring equation, you will quantify how stabilizing an enzyme's transition state—a common goal of protein engineering—translates directly into an increase in its catalytic turnover number, $k_{\\text{cat}}$, reinforcing the physical-chemical principles that underpin rational enzyme design [@problem_id:2609268].", "problem": "A synthetic biology team is optimizing flux through a heterologous isoprenoid pathway by engineering the rate-limiting enzyme. Under saturating substrate conditions, assume that the catalytic turnover of a single active site is governed by Transition State Theory, with the rate constant given by the Eyring equation\n$$\nk \\;=\\; \\frac{k_{B}\\,T}{h}\\,\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R\\,T}\\right),\n$$\nwhere $k_{B}$ is the Boltzmann constant, $h$ is Planck’s constant, $T$ is the absolute temperature, $\\Delta G^{\\ddagger}$ is the activation free energy, and $R$ is the universal gas constant. A designed mutation stabilizes the transition state relative to the wild type by an amount $\\Delta\\Delta G^{\\ddagger}$ (that is, the mutant has $\\Delta G_{\\text{mut}}^{\\ddagger} \\,=\\, \\Delta G_{\\text{wt}}^{\\ddagger} - \\Delta\\Delta G^{\\ddagger}$). Assume that the mutation does not alter the pre-exponential factor $\\frac{k_{B}T}{h}$ and that all other conditions are unchanged.\n\nGiven $\\Delta\\Delta G^{\\ddagger} \\,=\\, 4.5\\ \\text{kJ}\\,\\text{mol}^{-1}$ at temperature $T \\,=\\, 310\\ \\text{K}$, compute the multiplicative fold-change in catalytic turnover number,\n$$\nF \\;=\\; \\frac{k_{\\text{cat, mut}}}{k_{\\text{cat, wt}}}.\n$$\nUse $R \\,=\\, 8.314\\ \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$. Express $F$ as a dimensionless number and round your answer to $3$ significant figures.", "solution": "The relevant fundamental base is Transition State Theory, which relates a unimolecular rate constant to the activation free energy via the Eyring equation,\n$$\nk \\;=\\; \\frac{k_{B}\\,T}{h}\\,\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R\\,T}\\right).\n$$\nUnder saturating substrate conditions, the catalytic turnover number $k_{\\text{cat}}$ is proportional to the microscopic rate constant for the chemical step and follows the same dependence on $\\Delta G^{\\ddagger}$. For wild type and mutant enzymes at the same temperature $T$, we have\n$$\nk_{\\text{cat, wt}} \\;=\\; \\frac{k_{B}\\,T}{h}\\,\\exp\\!\\left(-\\frac{\\Delta G_{\\text{wt}}^{\\ddagger}}{R\\,T}\\right), \n\\qquad\nk_{\\text{cat, mut}} \\;=\\; \\frac{k_{B}\\,T}{h}\\,\\exp\\!\\left(-\\frac{\\Delta G_{\\text{mut}}^{\\ddagger}}{R\\,T}\\right).\n$$\nTaking the ratio eliminates the pre-exponential factor:\n$$\nF \\;=\\; \\frac{k_{\\text{cat, mut}}}{k_{\\text{cat, wt}}}\n\\;=\\; \\exp\\!\\left(-\\frac{\\Delta G_{\\text{mut}}^{\\ddagger} - \\Delta G_{\\text{wt}}^{\\ddagger}}{R\\,T}\\right).\n$$\nThe mutation stabilizes the transition state by $\\Delta\\Delta G^{\\ddagger}$, meaning\n$$\n\\Delta G_{\\text{mut}}^{\\ddagger} \\;=\\; \\Delta G_{\\text{wt}}^{\\ddagger} - \\Delta\\Delta G^{\\ddagger}\n\\;\\;\\Rightarrow\\;\\;\n\\Delta G_{\\text{mut}}^{\\ddagger} - \\Delta G_{\\text{wt}}^{\\ddagger} \\;=\\; -\\Delta\\Delta G^{\\ddagger}.\n$$\nSubstitute into the expression for $F$:\n$$\nF \\;=\\; \\exp\\!\\left(-\\frac{-\\Delta\\Delta G^{\\ddagger}}{R\\,T}\\right)\n\\;=\\; \\exp\\!\\left(\\frac{\\Delta\\Delta G^{\\ddagger}}{R\\,T}\\right).\n$$\nNow substitute the given numerical values. First convert $\\Delta\\Delta G^{\\ddagger}$ to joules per mole:\n$$\n\\Delta\\Delta G^{\\ddagger} \\;=\\; 4.5\\ \\text{kJ}\\,\\text{mol}^{-1} \\;=\\; 4.5 \\times 10^{3}\\ \\text{J}\\,\\text{mol}^{-1}.\n$$\nCompute the exponent:\n$$\n\\frac{\\Delta\\Delta G^{\\ddagger}}{R\\,T}\n\\;=\\;\n\\frac{4.5 \\times 10^{3}\\ \\text{J}\\,\\text{mol}^{-1}}{(8.314\\ \\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})\\,(310\\ \\text{K})}\n\\;=\\;\n\\frac{4500}{8.314 \\times 310}.\n$$\nEvaluate the denominator:\n$$\n8.314 \\times 310 \\;=\\; 2577.34.\n$$\nThus,\n$$\n\\frac{\\Delta\\Delta G^{\\ddagger}}{R\\,T} \\;=\\; \\frac{4500}{2577.34} \\;\\approx\\; 1.7459.\n$$\nFinally,\n$$\nF \\;=\\; \\exp(1.7459) \\;\\approx\\; 5.7334.\n$$\nRounded to $3$ significant figures,\n$$\nF \\;\\approx\\; 5.73.\n$$\nThis is a dimensionless multiplicative factor for the fold-change in $k_{\\text{cat}}$.", "answer": "$$\\boxed{5.73}$$", "id": "2609268"}, {"introduction": "Quantifying the output of a synthetic circuit often relies on fluorescent reporters, but the observed signal is a delayed and distorted version of the underlying gene expression event. This computational practice addresses the critical challenge of inferring the true dynamics from the measured output. You will implement a deconvolution algorithm to reverse the effects of reporter maturation and dilution, reconstructing the true protein synthesis rate from a simulated fluorescence time-course, a vital skill in modern quantitative biology [@problem_id:2609196].", "problem": "Consider a fluorescent protein reporter used to monitor gene expression in a growing cell population. The underlying protein synthesis rate is a nonnegative, time-varying function $s(t)$ with units molecules per cell per hour. Fluorescence arises only from the matured form of the reporter. Assume the following standard first-order maturation and dilution model with zero initial conditions at time $t=0$:\n$$\n\\frac{dM}{dt} = s(t) - (k_m + k_d) M(t),\n\\quad\n\\frac{dP}{dt} = k_m M(t) - k_d P(t),\n\\quad\nF(t) = c\\,P(t),\n$$\nwhere $M(t)$ is the immature nonfluorescent reporter, $P(t)$ is the mature fluorescent reporter, $F(t)$ is the measured fluorescence in arbitrary units, $k_m$ is the maturation rate in $\\mathrm{h}^{-1}$, $k_d$ is the effective first-order loss rate in $\\mathrm{h}^{-1}$ (dominated by dilution via growth, with negligible degradation), and $c$ is the fluorescence calibration factor in arbitrary units per molecule. These ordinary differential equations encode mass balance and first-order kinetics, which are accepted foundations in biochemical kinetics and synthetic biology for reporter dynamics.\n\nYou are asked to infer the underlying synthesis rate profile from fluorescence dynamics by principled deconvolution grounded in these laws. Proceed as follows.\n\n1. Time discretization and input model. Discretize time into uniform steps of width $\\Delta t$ (in hours) under a Zero-Order Hold (ZOH) assumption, that is, approximate $s(t)$ as piecewise constant values $r_n$ over intervals $[n\\Delta t,(n+1)\\Delta t)$ for integer $n \\ge 0$. Let $x(t) = [M(t)\\;P(t)]^\\top$, and write the continuous-time linear time-invariant state-space model\n$$\n\\frac{dx}{dt} = A x(t) + B s(t), \\quad y(t) = C x(t),\n$$\nwith\n$$\nA = \\begin{bmatrix}-(k_m+k_d)  0 \\\\ k_m  -k_d \\end{bmatrix}, \\quad\nB = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad\nC = \\begin{bmatrix} 0  1 \\end{bmatrix}.\n$$\nUnder ZOH with step width $\\Delta t$, derive the exact discrete-time model\n$$\nx_{n+1} = \\Phi x_n + \\Gamma r_n, \\quad y_n = C x_n, \\quad F_n = c y_n,\n$$\nwhere $\\Phi = e^{A \\Delta t}$ and $\\Gamma = \\int_{0}^{\\Delta t} e^{A \\tau} B \\, d\\tau$. Use this as the fundamental forward model to generate fluorescence from a given rate sequence $r$ and to construct the linear map from $r$ to $y$.\n\n2. Inference objective. Given a fluorescence sequence $F_n$ generated by some unknown nonnegative rate sequence $r_n$, infer $r$ by solving the following nonnegative, Tikhonov-regularized least-squares problem:\n$$\n\\min_{r \\ge 0} \\;\\; \\| H r - y \\|_2^2 \\;+\\; \\lambda \\| D r \\|_2^2,\n$$\nwhere $y_n = F_n / c$ are mature reporter values, $H$ is the lower-triangular Toeplitz convolution matrix induced by the discrete impulse response of the $(\\Phi,\\Gamma,C)$ system under ZOH, $D$ is the first-difference operator $(Dr)_n = r_{n+1}-r_n$, and $\\lambda$ is a nonnegative regularization weight. Implement this by augmenting the linear system:\n$$\n\\begin{bmatrix} H \\\\ \\sqrt{\\lambda}\\, D \\end{bmatrix} r \\approx \\begin{bmatrix} y \\\\ 0 \\end{bmatrix},\n$$\nand solving the resulting nonnegative least-squares problem.\n\n3. Test suite and required outputs. For each of the following three cases, you must:\n   - Define the time grid $t_n = n\\Delta t$ for $n=0,1,\\dots,N-1$ with $N = \\lfloor T_{\\text{end}}/\\Delta t \\rfloor$ samples.\n   - Specify a ground-truth $r_{\\text{true}}(t)$ (units molecules per cell per hour) and sample it under ZOH to obtain $r_{\\text{true},n} = r_{\\text{true}}(t)$ for $t \\in [n\\Delta t,(n+1)\\Delta t)$.\n   - Generate $F_n$ by simulating the discrete-time model with zero initial conditions.\n   - Infer $\\hat r_n$ from $F_n$ using the method above with a fixed $\\lambda$ shared across tests.\n   - Compute the root-mean-square error\n     $$\n     \\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{n=0}^{N-1} \\left(\\hat r_n - r_{\\text{true},n}\\right)^2}.\n     $$\n     Report this number as a floating-point value in molecules per cell per hour.\n\nUse the following parameter sets and profiles; all rates are in molecules per cell per hour unless otherwise stated:\n- Case A (Gaussian burst with moderate maturation):\n  - $\\Delta t = 0.05$, $T_{\\text{end}} = 6.0$, $k_m = 1.0$, $k_d = 0.1$, $c = 100.0$,\n  - $r_{\\text{true}}(t) = A \\exp\\left(-\\frac{(t - \\mu)^2}{2\\sigma^2}\\right)$ with $A = 500.0$, $\\mu = 2.0$, $\\sigma = 0.3$.\n- Case B (Sustained step with slow maturation):\n  - $\\Delta t = 0.05$, $T_{\\text{end}} = 6.0$, $k_m = 0.2$, $k_d = 0.1$, $c = 80.0$,\n  - $r_{\\text{true}}(t) = A$ for $t \\in [t_{\\text{on}}, t_{\\text{off}})$ and $r_{\\text{true}}(t) = 0$ otherwise, with $A = 200.0$, $t_{\\text{on}} = 1.0$, $t_{\\text{off}} = 4.0$.\n- Case C (Short pulse with very fast maturation and negligible dilution):\n  - $\\Delta t = 0.02$, $T_{\\text{end}} = 3.0$, $k_m = 5.0$, $k_d = 0.0$, $c = 120.0$,\n  - $r_{\\text{true}}(t) = A \\exp\\left(-\\frac{(t - \\mu)^2}{2\\sigma^2}\\right)$ with $A = 1000.0$, $\\mu = 1.0$, $\\sigma = 0.05$.\n\nTake the Tikhonov weight to be $\\lambda = 1.0 \\times 10^{-4}$ for all cases. All time quantities are in hours.\n\nYour program must:\n- Implement the exact discrete-time $(\\Phi,\\Gamma)$ via the matrix exponential for the ZOH model.\n- Build the impulse response and the Toeplitz matrix $H$ consistently with the forward simulation used to generate fluorescence.\n- Solve the augmented nonnegative least-squares problem to infer $r$.\n- Compute the $\\mathrm{RMSE}$ for each case in molecules per cell per hour, rounded to six decimal places.\n\nFinal output format. Your program should produce a single line of output containing the three $\\mathrm{RMSE}$ values for Cases A, B, and C, respectively, as a comma-separated list enclosed in square brackets, for example, $[\\alpha,\\beta,\\gamma]$. The numerical values you output must be in molecules per cell per hour and rounded to six decimal places, with no additional text printed.", "solution": "The problem statement presented is rigorously defined and scientifically valid. It is established upon the fundamental principles of biochemical kinetics and linear systems theory, which are standard in the field of synthetic biology. All parameters, initial conditions, and objectives are specified with sufficient clarity and precision to permit a unique and verifiable solution. There are no contradictions, ambiguities, or scientific inaccuracies. The problem is therefore deemed valid, and I will proceed with its solution.\n\nThe task is to infer a time-varying protein synthesis rate $s(t)$ from measurements of a fluorescent reporter, a process known as deconvolution. The problem is structured in three parts: model discretization, formulation of an inverse problem, and numerical implementation for specific test cases.\n\nFirst, we discretize the continuous-time state-space model. The model is given by\n$$ \\frac{dx}{dt} = A x(t) + B s(t), \\quad y(t) = C x(t) $$\nwith state $x(t) = [M(t)\\;P(t)]^\\top$ and matrices\n$$ A = \\begin{bmatrix}-(k_m+k_d)  0 \\\\ k_m  -k_d \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 0  1 \\end{bmatrix} $$\nWe discretize time with a step $\\Delta t$ and assume the synthesis rate $s(t)$ is piecewise constant, $s(t) = r_n$ for $t \\in [n\\Delta t, (n+1)\\Delta t)$. This is the Zero-Order Hold (ZOH) assumption. The exact solution to the state equation over one interval yields the discrete-time model:\n$$ x_{n+1} = \\Phi x_n + \\Gamma r_n, \\quad y_n = C x_n $$\nwhere $x_n = x(n\\Delta t)$ and $y_n = y(n\\Delta t)$. The state transition matrix $\\Phi$ and the input matrix $\\Gamma$ are given by\n$$ \\Phi = e^{A \\Delta t}, \\quad \\Gamma = \\int_{0}^{\\Delta t} e^{A \\tau} B \\, d\\tau $$\nA robust method to compute both matrices simultaneously is to use the matrix exponential of an augmented matrix:\n$$ \\begin{bmatrix} \\Phi  \\Gamma \\\\ 0  I \\end{bmatrix} = \\exp\\left( \\begin{bmatrix} A  B \\\\ 0  0 \\end{bmatrix} \\Delta t \\right) $$\nwhere the block matrix on the right is of size $3 \\times 3$. This approach is numerically stable and correctly handles special cases such as $k_d=0$.\n\nSecond, we formulate the inference problem. With zero initial conditions, $x_0 = [0\\;0]^\\top$, the state at time $n\\Delta t$ is the result of a discrete-time convolution:\n$$ x_n = \\sum_{k=0}^{n-1} \\Phi^{n-1-k} \\Gamma r_k $$\nThe corresponding output is $y_n = C x_n$. This linear relationship can be written in matrix form as $y = H r$, where $y = [y_0, y_1, \\dots, y_{N-1}]^\\top$, $r = [r_0, r_1, \\dots, r_{N-1}]^\\top$, and $H$ is a lower-triangular Toeplitz matrix. The first column of $H$ is the system's impulse response, $h = [h_0, h_1, \\dots, h_{N-1}]^\\top$, where $h_0 = 0$ and $h_n = C \\Phi^{n-1} \\Gamma$ for $n \\ge 1$.\n\nDeconvolution is an ill-posed problem, often sensitive to noise and model mismatch. Tikhonov regularization is employed to find a stable and physically meaningful solution. We seek to minimize a composite objective function that balances data fidelity and solution smoothness:\n$$ \\min_{r \\ge 0} \\;\\; \\| H r - y \\|_2^2 \\;+\\; \\lambda \\| D r \\|_2^2 $$\nThe nonnegativity constraint $r \\ge 0$ is imposed because the synthesis rate cannot be negative. The term $\\| H r - y \\|_2^2$ is the squared error between the model prediction and the measured data $y_n = F_n / c$. The term $\\lambda \\| D r \\|_2^2$ is a regularization penalty, where $D$ is the first-difference operator, $(Dr)_n = r_{n+1}-r_n$, and $\\lambda$ is the regularization weight. This penalty discourages rapid fluctuations in the inferred rate $r$.\n\nThe optimization problem is equivalent to a standard Nonnegative Least-Squares (NNLS) problem by augmenting the system of equations:\n$$ \\min_{r \\ge 0} \\left\\| \\begin{bmatrix} H \\\\ \\sqrt{\\lambda}\\, D \\end{bmatrix} r - \\begin{bmatrix} y \\\\ 0 \\end{bmatrix} \\right\\|_2^2 $$\nThis augmented problem can be solved efficiently using standard numerical linear algebra libraries.\n\nFor each test case, we perform the following steps:\n1.  Define the time grid of size $N = \\lfloor T_{\\text{end}}/\\Delta t \\rfloor$ and sample the specified ground-truth synthesis rate $r_{\\text{true},n}$.\n2.  Compute the discrete-time matrices $\\Phi$ and $\\Gamma$ using the augmented matrix exponential method.\n3.  Simulate the forward model $x_{n+1} = \\Phi x_n + \\Gamma r_{\\text{true},n}$ with $x_0=0$ to generate the noise-free reporter data sequence $y_n = C x_n$.\n4.  Construct the convolution matrix $H$ from the system's impulse response and the first-difference matrix $D$.\n5.  Set up the augmented system and solve for the estimated rate $\\hat r$ using an NNLS solver.\n6.  Finally, compute the Root-Mean-Square Error (RMSE) between the inferred rate $\\hat r$ and the ground truth $r_{\\text{true}}$ to quantify the accuracy of the deconvolution:\n    $$ \\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{n=0}^{N-1} \\left(\\hat r_n - r_{\\text{true},n}\\right)^2} $$\nThe following code implements this procedure to compute the RMSE for the three specified cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm, toeplitz\nfrom scipy.optimize import nnls\n\ndef solve_case(params):\n    \"\"\"\n    Solves a single deconvolution case.\n    \n    1. Generates ground-truth synthesis rate and corresponding fluorescence data.\n    2. Constructs the matrices for the regularized inverse problem.\n    3. Solves the nonnegative least-squares problem to infer the synthesis rate.\n    4. Computes the RMSE between the true and inferred rates.\n    \"\"\"\n    # Unpack parameters and define the time grid\n    dt = params['dt']\n    Tend = params['Tend']\n    km = params['km']\n    kd = params['kd']\n    lambda_val = params['lambda']\n\n    N = int(np.floor(Tend / dt))\n    t_grid = np.arange(N) * dt\n\n    # Generate the ground-truth synthesis rate r_true\n    r_true_func = params['r_true_func']\n    r_true_params = params['r_true_params']\n    r_true = r_true_func(t_grid, r_true_params)\n\n    # Derive discrete-time matrices Phi and Gamma using the augmented matrix exponential\n    A = np.array([[-(km + kd), 0], [km, -kd]])\n    B = np.array([[1], [0]])\n    \n    aug_matrix = np.zeros((3, 3))\n    aug_matrix[0:2, 0:2] = A\n    aug_matrix[0:2, 2] = B.flatten()\n    \n    exp_aug_matrix = expm(aug_matrix * dt)\n    \n    Phi = exp_aug_matrix[0:2, 0:2]\n    Gamma = exp_aug_matrix[0:2, 2].reshape(2, 1)\n\n    # Generate the \"measured\" data y = F/c via forward simulation\n    C = np.array([[0, 1]])\n    x_hist = np.zeros((2, N + 1))  # State history from x_0 to x_N\n    \n    for n in range(N):\n        x_hist[:, n + 1] = Phi @ x_hist[:, n] + Gamma.flatten() * r_true[n]\n    \n    # y_n = C * x_n for n=0,...,N-1\n    y_data = (C @ x_hist[:, 0:N]).flatten()\n\n    # Construct matrices for the inverse problem\n    #\n    # 1. Impulse response h_n\n    h = np.zeros(N)\n    x_impulse = Gamma  # This is x_1 for an impulse input r_0=1\n    if N  1:\n        h[1] = (C @ x_impulse).item()\n    for n in range(2, N):\n        x_impulse = Phi @ x_impulse  # x_impulse becomes Phi^(n-1)*Gamma\n        h[n] = (C @ x_impulse).item()\n\n    # 2. Toeplitz convolution matrix H\n    H = toeplitz(h, np.zeros(N))\n\n    # 3. First-difference operator D\n    D = np.eye(N, k=1) - np.eye(N)\n    D = D[:-1, :]  # Final size is (N-1) x N\n\n    # Set up and solve the augmented nonnegative least-squares problem\n    H_aug = np.vstack([H, np.sqrt(lambda_val) * D])\n    y_aug = np.concatenate([y_data, np.zeros(N - 1)])\n\n    r_hat, _ = nnls(H_aug, y_aug)\n\n    # Compute the Root-Mean-Square Error (RMSE)\n    rmse = np.sqrt(np.mean((r_hat - r_true)**2))\n    return rmse\n\n\ndef r_gaussian(t, p):\n    \"\"\"Defines a Gaussian pulse for the synthesis rate.\"\"\"\n    return p['A'] * np.exp(-((t - p['mu'])**2) / (2 * p['sigma']**2))\n\ndef r_step(t, p):\n    \"\"\"Defines a step function for the synthesis rate.\"\"\"\n    return p['A'] * ((t = p['t_on'])  (t  p['t_off']))\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'A', 'dt': 0.05, 'Tend': 6.0, 'km': 1.0, 'kd': 0.1, 'c': 100.0,\n            'r_true_func': r_gaussian,\n            'r_true_params': {'A': 500.0, 'mu': 2.0, 'sigma': 0.3}\n        },\n        {\n            'name': 'B', 'dt': 0.05, 'Tend': 6.0, 'km': 0.2, 'kd': 0.1, 'c': 80.0,\n            'r_true_func': r_step,\n            'r_true_params': {'A': 200.0, 't_on': 1.0, 't_off': 4.0}\n        },\n        {\n            'name': 'C', 'dt': 0.02, 'Tend': 3.0, 'km': 5.0, 'kd': 0.0, 'c': 120.0,\n            'r_true_func': r_gaussian,\n            'r_true_params': {'A': 1000.0, 'mu': 1.0, 'sigma': 0.05}\n        }\n    ]\n\n    lambda_val = 1.0e-4\n    results = []\n    \n    for case in test_cases:\n        case['lambda'] = lambda_val\n        rmse = solve_case(case)\n        # Format the result to six decimal places as required.\n        results.append(f\"{rmse:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2609196"}]}