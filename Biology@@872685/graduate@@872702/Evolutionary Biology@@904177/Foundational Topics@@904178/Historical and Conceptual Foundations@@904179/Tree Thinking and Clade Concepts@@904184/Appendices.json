{"hands_on_practices": [{"introduction": "Mastery in evolutionary biology begins with a precise vocabulary. While terms like 'monophyletic' or 'paraphyletic' are often used intuitively, their rigorous application depends on formal, set-theoretic definitions. This exercise [@problem_id:2760582] challenges you to move beyond intuition and apply these strict definitions to classify groups on a given phylogeny, reinforcing the foundational grammar of tree thinking.", "problem": "Consider the rooted phylogenetic tree with leaf set $L=\\{A,B,C,D\\}$ and rooted topology $T=(((A,B),C),D)$, where the root is attached to $D$ and to the internal node whose descendants are $\\{A,B,C\\}$. Use the following standard, tree-based definitions. For any node $v$ in a rooted tree, let $D(v)$ denote the set of descendant leaves of $v$. A subset $S\\subseteq L$ is called monophyletic (a clade) if there exists a node $v$ with $S=D(v)$. A subset $S\\subseteq L$ is called paraphyletic if there exists a node $v$ and a finite collection of its descendant nodes $v_1,\\dots,v_k$ with $k\\ge 1$ such that $S=D(v)\\setminus \\bigcup_{i=1}^k D(v_i)$. A subset $S\\subseteq L$ is called polyphyletic if it cannot be expressed in either of the two forms above relative to the given rooted tree.\n\nUsing only these definitions and the topology $T$, classify each of the following subsets: $\\{A,B\\}$, $\\{A,C\\}$, $\\{A,B,C\\}$, and $\\{B,C,D\\}$.\n\nChoose the single option that correctly classifies all four subsets in the order listed:\n- A. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ paraphyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.\n\n- B. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ polyphyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.\n\n- C. $\\{A,B\\}$ paraphyletic; $\\{A,C\\}$ polyphyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.\n\n- D. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ paraphyletic; $\\{A,B,C\\}$ paraphyletic; $\\{B,C,D\\}$ polyphyletic.\n\n- E. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ monophyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.", "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n-   **Leaf set:** $L=\\{A,B,C,D\\}$\n-   **Rooted topology:** $T=(((A,B),C),D)$\n-   **Root position:** The root is attached to the leaf $D$ and to the internal node whose descendants are $\\{A,B,C\\}$.\n-   **Definition of Monophyletic (clade):** A subset $S\\subseteq L$ is monophyletic if there exists a node $v$ in the tree such that $S=D(v)$, where $D(v)$ is the set of descendant leaves of $v$.\n-   **Definition of Paraphyletic:** A subset $S\\subseteq L$ is paraphyletic if there exists a node $v$ and a finite collection of its descendant nodes $v_1,\\dots,v_k$ with $k\\ge 1$ such that $S=D(v)\\setminus \\bigcup_{i=1}^k D(v_i)$.\n-   **Definition of Polyphyletic:** A subset $S\\subseteq L$ is polyphyletic if it is neither monophyletic nor paraphyletic.\n-   **Task:** Classify the four subsets $\\{A,B\\}$, $\\{A,C\\}$, $\\{A,B,C\\}$, and $\\{B,C,D\\}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem provides a clear, mathematically well-defined structure for a phylogenetic tree and precise, set-theoretic definitions for monophyletic, paraphyletic, and polyphyletic groups. The topology given in Newick format, $(((A,B),C),D)$, is consistent with the description of the root. The problem is self-contained, scientifically grounded in the principles of cladistics, and well-posed. There are no contradictions, ambiguities, or missing information in the problem statement itself. The task is a direct application of the provided definitions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived by strictly applying the given definitions to the specified tree topology.\n\n### Derivation of Solution\nFirst, we must precisely understand the structure of the tree $T=(((A,B),C),D)$.\nLet us denote the nodes of the tree:\n-   $l_A, l_B, l_C, l_D$ are the leaf nodes corresponding to taxa $A, B, C, D$.\n-   $v_1$ is the internal node representing the most recent common ancestor (MRCA) of $A$ and $B$.\n-   $v_2$ is the internal node representing the MRCA of $\\{A,B\\}$ and $C$.\n-   $v_3$ is the root node, representing the MRCA of $\\{A,B,C\\}$ and $D$.\n\nThe sets of descendant leaves for each non-leaf node are:\n-   $D(v_1) = \\{A, B\\}$\n-   $D(v_2) = \\{A, B, C\\}$\n-   $D(v_3) = \\{A, B, C, D\\}$\nThe set of all possible monophyletic groups (clades) containing more than one taxon are $\\{A, B\\}$, $\\{A, B, C\\}$, and $\\{A, B, C, D\\}$. The sets $\\{A\\}, \\{B\\}, \\{C\\}, \\{D\\}$ are also trivially monophyletic.\n\nWe now classify each of the four specified subsets using the provided definitions, assuming a precedence of monophyletic over paraphyletic classification.\n\n**1. Classification of the subset $\\{A,B\\}$**\nAccording to the definition, a set is monophyletic if it is the set of all descendant leaves of some node. The set $\\{A,B\\}$ is the set of all descendant leaves of node $v_1$.\nTherefore, $\\{A,B\\}$ is **monophyletic**.\n\n**2. Classification of the subset $\\{A,C\\}$**\n_Is it monophyletic?_ No. There is no node in the tree $T$ for which $\\{A,C\\}$ is the complete set of descendant leaves.\n_Is it paraphyletic?_ A set $S$ is paraphyletic if it can be expressed as $S = D(v) \\setminus \\bigcup_{i=1}^k D(v_i)$.\nLet us select the node $v = v_2$. The descendant leaves are $D(v_2) = \\{A, B, C\\}$.\nTo obtain $\\{A,C\\}$, we must remove the taxon $B$. The taxon $B$ corresponds to the leaf node $l_B$, and its descendant set is $D(l_B) = \\{B\\}$. The node $l_B$ is a descendant of $v_2$.\nWe can set $k=1$ and $v_1 = l_B$. The expression becomes $D(v_2) \\setminus D(l_B) = \\{A, B, C\\} \\setminus \\{B\\} = \\{A,C\\}$.\nThis construction precisely matches the definition of a paraphyletic group.\nTherefore, according to the definitions provided in the problem, the set $\\{A,C\\}$ is **paraphyletic**. It is not polyphyletic, because the definition of polyphyletic applies only to sets that cannot be described as monophyletic or paraphyletic.\n\n**3. Classification of the subset $\\{A,B,C\\}$**\nThe set $\\{A,B,C\\}$ is the set of all descendant leaves of the node $v_2$.\nTherefore, $\\{A,B,C\\}$ is **monophyletic**.\n\n**4. Classification of the subset $\\{B,C,D\\}$**\n_Is it monophyletic?_ No. There is no node in the tree $T$ for which $\\{B,C,D\\}$ is the complete set of descendant leaves.\n_Is it paraphyletic?_ We check if the set can be formed by the subtractive definition.\nLet us select the root node $v = v_3$. The descendant leaves are $D(v_3) = \\{A, B, C, D\\}$.\nTo obtain $\\{B,C,D\\}$, we must remove the taxon $A$. The taxon $A$ corresponds to the leaf node $l_A$, with descendant set $D(l_A) = \\{A\\}$. The node $l_A$ is a descendant of the root node $v_3$.\nWe set $k=1$ and $v_1 = l_A$. The expression becomes $D(v_3) \\setminus D(l_A) = \\{A, B, C, D\\} \\setminus \\{A\\} = \\{B,C,D\\}$.\nThis construction matches the definition of a paraphyletic group.\nTherefore, $\\{B,C,D\\}$ is **paraphyletic**.\n\n**Summary of Classifications:**\n-   $\\{A,B\\}$: monophyletic\n-   $\\{A,C\\}$: paraphyletic\n-   $\\{A,B,C\\}$: monophyletic\n-   $\\{B,C,D\\}$: paraphyletic\n\nThis sequence of classifications is: monophyletic, paraphyletic, monophyletic, paraphyletic.\n\n### Option-by-Option Analysis\n\n-   **A. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ paraphyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.**\n    This option matches our derived classifications for all four subsets.\n    Verdict: **Correct**.\n\n-   **B. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ polyphyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.**\n    This option incorrectly classifies $\\{A,C\\}$ as polyphyletic. As demonstrated, $\\{A,C\\}$ can be constructed according to the problem's definition of a paraphyletic group.\n    Verdict: **Incorrect**.\n\n-   **C. $\\{A,B\\}$ paraphyletic; $\\{A,C\\}$ polyphyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.**\n    This option incorrectly classifies $\\{A,B\\}$. The set $\\{A,B\\}$ is a clade and is therefore monophyletic, not paraphyletic.\n    Verdict: **Incorrect**.\n\n-   **D. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ paraphyletic; $\\{A,B,C\\}$ paraphyletic; $\\{B,C,D\\}$ polyphyletic.**\n    This option incorrectly classifies $\\{A,B,C\\}$ as paraphyletic. It is a clade and therefore monophyletic. It also incorrectly classifies $\\{B,C,D\\}$ as polyphyletic, when it can be constructed as paraphyletic.\n    Verdict: **Incorrect**.\n\n-   **E. $\\{A,B\\}$ monophyletic; $\\{A,C\\}$ monophyletic; $\\{A,B,C\\}$ monophyletic; $\\{B,C,D\\}$ paraphyletic.**\n    This option incorrectly classifies $\\{A,C\\}$ as monophyletic. As established, it is not a clade.\n    Verdict: **Incorrect**.\n\nThe only option that correctly classifies all four subsets according to the provided formal definitions is A.", "answer": "$$\\boxed{A}$$", "id": "2760582"}, {"introduction": "Once we understand what constitutes a clade, the next step is to learn how to infer them from character data. This practice [@problem_id:2760542] introduces Maximum Parsimony, a foundational method that seeks the tree requiring the fewest evolutionary changes. By applying the classic Fitch algorithm, you will calculate the parsimony score and identify synapomorphies, the shared derived characters that provide the explicit evidence for grouping taxa into clades.", "problem": "You are given a rooted phylogenetic tree on five taxa with topology (((A,B),(C,D)),E), where the root is the bifurcation between taxon E and the clade containing A, B, C, and D. Consider two independent, equal-weight, binary, unordered morphological characters (two sites) observed at the tips. The observed states are:\n- Site $1$: A has state $1$, B has state $1$, C has state $0$, D has state $0$, E has state $0$.\n- Site $2$: A has state $1$, B has state $0$, C has state $1$, D has state $0$, E has state $0$.\n\nUse the principle of Maximum Parsimony (MP) with unordered, equal-cost changes and apply the Fitch algorithm to compute the parsimony score (the minimum number of state changes on the tree) for each site on the given rooted tree. Based on a minimal-change reconstruction that is consistent with the given root, identify which, if any, clades on this tree are supported by synapomorphies (shared derived states arising on a single branch and retained in all descendants). You may assume that the root state is inferred under MP from the data at the tips.\n\nFinally, report only the total parsimony score across both sites as a single integer. No rounding is required and no units are involved. Explain your reasoning from first principles of parsimony, clades, and synapomorphy identification, without invoking any shortcut formulas or computational tools.", "solution": "The problem is valid. It is scientifically grounded in the principles of phylogenetic systematics, specifically Maximum Parsimony (MP). The problem is well-posed, providing a clear tree topology, unambiguous character state data for five taxa at two sites, and a precise set of tasks. The terminology, such as \"clade,\" \"synapomorphy,\" and \"Fitch algorithm,\" is standard in evolutionary biology. The given data is self-contained and sufficient to derive a unique solution for the parsimony score.\n\nThe principle of Maximum Parsimony dictates that the preferred evolutionary hypothesis is the one that requires the minimum number of evolutionary changes (e.g., character state transitions) to explain the observed data. The Fitch algorithm is a two-pass method for calculating this minimum number of changes (the parsimony score) for a given character on a given tree topology.\n\nLet the internal nodes be denoted as follows: $N_1$ is the most recent common ancestor (MRCA) of taxa $A$ and $B$. $N_2$ is the MRCA of taxa $C$ and $D$. $N_3$ is the MRCA of the clade $(A,B,C,D)$. The root of the tree, $R$, is the MRCA of all five taxa, representing the bifurcation between taxon $E$ and the clade $(A,B,C,D)$. The tree topology is $(((A,B)N_1, (C,D)N_2)N_3, E)R$.\n\nWe will apply the Fitch algorithm to each site independently.\n\n**Analysis of Site $1$**\n\nThe observed states at the tips (leaves) of the tree for Site $1$ are: $A:1, B:1, C:0, D:0, E:0$.\n\nThe Fitch algorithm consists of two passes: a bottom-up pass (Phase $1$) to determine the set of possible ancestral states and the parsimony score, and a top-down pass (Phase $2$) to assign specific states to internal nodes.\n\nPhase $1$ (Bottom-up):\nFor each internal node, we compute a set of potential states. If the state sets of its two immediate descendants have a non-empty intersection, the state set of the parent node is this intersection. If the intersection is empty, the state set of the parent node is the union of the descendants' sets, and the parsimony score is incremented by $1$.\n\n1.  Node $N_1$ (ancestor of $A$ and $B$): The state sets are $\\{1\\}$ for $A$ and $\\{1\\}$ for $B$. The intersection is $\\{1\\} \\cap \\{1\\} = \\{1\\}$. So, the state set for $N_1$ is $\\{1\\}$. Score remains $0$.\n2.  Node $N_2$ (ancestor of $C$ and $D$): The state sets are $\\{0\\}$ for $C$ and $\\{0\\}$ for $D$. The intersection is $\\{0\\} \\cap \\{0\\} = \\{0\\}$. So, the state set for $N_2$ is $\\{0\\}$. Score remains $0$.\n3.  Node $N_3$ (ancestor of $N_1$ and $N_2$): The state sets are $\\{1\\}$ for $N_1$ and $\\{0\\}$ for $N_2$. The intersection is $\\{1\\} \\cap \\{0\\} = \\emptyset$. The intersection is empty, so we take the union $\\{1\\} \\cup \\{0\\} = \\{0, 1\\}$ and increment the score. The state set for $N_3$ is $\\{0, 1\\}$. The score is now $1$.\n4.  Node $R$ (Root, ancestor of $N_3$ and $E$): The state sets are $\\{0, 1\\}$ for $N_3$ and $\\{0\\}$ for $E$. The intersection is $\\{0, 1\\} \\cap \\{0\\} = \\{0\\}$. The intersection is not empty, so the state set for the root $R$ is $\\{0\\}$. The score is not incremented.\n\nThe final parsimony score for Site $1$, denoted $S_1$, is the total number of union operations, which is $1$. So, $S_1 = 1$.\n\n**Analysis of Site $2$**\n\nThe observed states at the tips for Site $2$ are: $A:1, B:0, C:1, D:0, E:0$.\n\nPhase $1$ (Bottom-up):\n1.  Node $N_1$ (ancestor of $A$ and $B$): The state sets are $\\{1\\}$ for $A$ and $\\{0\\}$ for $B$. The intersection is empty. Union is $\\{0, 1\\}$. State set for $N_1$ is $\\{0, 1\\}$. Score is incremented to $1$.\n2.  Node $N_2$ (ancestor of $C$ and $D$): The state sets are $\\{1\\}$ for $C$ and $\\{0\\}$ for $D$. The intersection is empty. Union is $\\{0, 1\\}$. State set for $N_2$ is $\\{0, 1\\}$. Score is incremented to $1+1=2$.\n3.  Node $N_3$ (ancestor of $N_1$ and $N_2$): The state sets are $\\{0, 1\\}$ for $N_1$ and $\\{0, 1\\}$ for $N_2$. The intersection is $\\{0, 1\\} \\cap \\{0, 1\\} = \\{0, 1\\}$. The intersection is not empty, so the state set for $N_3$ is $\\{0, 1\\}$. The score is not incremented.\n4.  Node $R$ (Root, ancestor of $N_3$ and $E$): The state sets are $\\{0, 1\\}$ for $N_3$ and $\\{0\\}$ for $E$. The intersection is $\\{0, 1\\} \\cap \\{0\\} = \\{0\\}$. The intersection is not empty, so the state set for the root $R$ is $\\{0\\}$. The score is not incremented.\n\nThe final parsimony score for Site $2$, denoted $S_2$, is $2$.\n\n**Total Parsimony Score**\n\nThe total parsimony score across both sites is the sum of the individual scores:\n$$S_{total} = S_1 + S_2 = 1 + 2 = 3$$\n\n**Synapomorphy Identification**\n\nTo identify synapomorphies, we perform Phase $2$ of the Fitch algorithm (top-down pass) to assign a specific state to each internal node, creating a minimal-change reconstruction. A synapomorphy is a shared derived character state that arose on the stem branch of a clade and is inherited by all members of that clade. The problem states to assume the root state is inferred under MP.\n\nFor Site $1$:\nThe state set for the root $R$ is $\\{0\\}$, so we assign state $0$ to the root.\n-   $R$ has state $0$. Its descendant $E$ also has state $0$ (no change). Its other descendant $N_3$ has state set $\\{0, 1\\}$. Since the parent state $0$ is in this set, we assign $N_3$ the state $0$.\n-   $N_3$ has state $0$. Its descendant $N_2$ has state set $\\{0\\}$, so we must assign $N_2$ the state $0$. Its other descendant $N_1$ has state set $\\{1\\}$. Since the parent state $0$ is not in this set, a state change must occur. We assign $N_1$ the state $1$. This change $0 \\to 1$ occurs on the branch leading from $N_3$ to $N_1$.\nThis single change on the branch leading to the clade $(A,B)$ results in the derived state $1$ being shared by both $A$ and $B$. Thus, state $1$ at Site $1$ is a synapomorphy supporting the clade $(A,B)$.\n\nFor Site $2$:\nThe state set for the root $R$ is $\\{0\\}$, so we assign state $0$ to the root.\n-   $R$ has state $0$. Its descendant $E$ has state $0$. Its other descendant $N_3$ has state set $\\{0, 1\\}$, so we assign $N_3$ the state $0$.\n-   $N_3$ has state $0$. Its descendant $N_1$ has state set $\\{0, 1\\}$, so we can assign $N_1$ the state $0$. Its other descendant $N_2$ has state set $\\{0, 1\\}$, so we can assign $N_2$ the state $0$.\n-   Under this reconstruction (which is one of several equally parsimonious possibilities, e.g., a DELTRAN reconstruction), all internal nodes ($R, N_3, N_2, N_1$) have state $0$. The two required changes are:\n    1.  On the terminal branch to $A$: $0 \\to 1$ (since $N_1$ is $0$).\n    2.  On the terminal branch to $C$: $0 \\to 1$ (since $N_2$ is $0$).\nThese are two independent changes to state $1$. This phenomenon is called homoplasy (specifically, convergence). The state $1$ is not a shared derived character for any clade; it is an autapomorphy for taxon $A$ and an autapomorphy for taxon $C$. Therefore, Site $2$ provides no synapomorphies to support any clades on this tree.\n\nConclusion: Of the characters provided, only Site $1$ provides a synapomorphy, which supports the clade $(A,B)$. The primary question, however, is to report the total parsimony score.\n\nThe total parsimony score across both sites is $3$.", "answer": "$$ \\boxed{3} $$", "id": "2760542"}, {"introduction": "While parsimony provides a powerful and intuitive framework, its simple counting of steps can sometimes lead to ambiguity. This advanced problem [@problem_id:2760550] delves into a probabilistic approach, using a continuous-time Markov model to calculate the likelihood of ancestral states. By deriving the posterior probability from first principles, you will see how model-based methods can provide a decisive answer where parsimony is equivocal, offering a more nuanced understanding of evolutionary inference.", "problem": "Consider a rooted, fully bifurcating $3$-taxon tree with topology $((A,B),C)$, where every edge (including the internal edge) has the same branch length $b$ measured in expected changes per character under the Markov $k$-state (Mk) model. A single binary character is observed at the tips as $A=1$, $B=1$, and $C=0$. Assume the binary Mk model with symmetric instantaneous rates, time-homogeneous dynamics, and equal stationary frequencies, so that the prior at the root assigns probability $1/2$ to each state. Using first principles of likelihood on trees (conditional independence of descendant subtrees given ancestor state and the pruning recursion), derive from the continuous-time two-state Markov chain the exact posterior probability that the root is in state $0$ as a closed-form function of $b$ alone. Express your final result in terms of $\\exp(-2b)$, and present it as a single simplified analytic expression. Then, based on your expression, state which root state maximizes the posterior probability under Mk, and contrast this with the inference at the root under Fitch parsimony for this topology and data. No numerical rounding is required, and no units are needed for $b$.", "solution": "The problem requires the derivation of the posterior probability of the root state for a single binary character on a 3-taxon tree, given a specific dataset and a continuous-time Markov model. This will be contrasted with the result from a parsimony-based inference.\n\nFirst, we formalize the model and the tree structure. The tree topology is $((A,B),C)$, which is a rooted tree where taxa $A$ and $B$ are sister to each other, and taxon $C$ is the outgroup. Let the root be denoted by $R$, and the internal node corresponding to the most recent common ancestor of $A$ and $B$ be denoted by $N$. The problem states that all four edges of this tree—the three terminal edges $(N,A)$, $(N,B)$, $(R,C)$ and the internal edge $(R,N)$—have the same length, $b$. The data at the tips are $s_A=1$, $s_B=1$, and $s_C=0$.\n\nThe evolutionary process is a 2-state symmetric Markov model on states $\\{0, 1\\}$. The instantaneous rate matrix $Q$ for such a process, where branch lengths are measured in expected number of substitutions per site ($b = \\mu t$), is given by:\n$$ Q = \\mu \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} $$\nThe model assumes equal stationary frequencies, $\\pi_0 = \\pi_1 = 1/2$, which is consistent with this symmetric $Q$ matrix.\n\nThe transition probability matrix for a branch of length $b$ is $P(b) = \\exp(Qb)$. The probabilities of remaining in the same state ($P_{ii}(b)$) or changing state ($P_{ij}(b)$ for $i \\neq j$) over a branch of length $b$ are:\n$$ P_{ii}(b) = P_{00}(b) = P_{11}(b) = \\frac{1}{2} + \\frac{1}{2} \\exp(-2b) $$\n$$ P_{ij}(b) = P_{01}(b) = P_{10}(b) = \\frac{1}{2} - \\frac{1}{2} \\exp(-2b) $$\nLet us denote the probability of staying in the same state as $p_s(b) = \\frac{1}{2}(1 + \\exp(-2b))$ and the probability of changing state as $p_d(b) = \\frac{1}{2}(1 - \\exp(-2b))$. Note that $p_s(b) + p_d(b) = 1$. For brevity, we will write $p_s$ and $p_d$.\n\nWe use Felsenstein's pruning algorithm to calculate the likelihood of the data given a specific state at the root. The likelihood of the data $D = \\{s_A=1, s_B=1, s_C=0\\}$ given the root state $s_R$ is $L(s_R) = P(D | s_R)$. The algorithm proceeds recursively from the tips to the root.\n\nThe conditional likelihood for a tip $u$ in state $i$ is $L_u(i) = \\delta_{i, s_u}$, where $\\delta$ is the Kronecker delta.\nFor our data:\n$L_A(i) = \\delta_{i,1}$, so $L_A(0)=0, L_A(1)=1$.\n$L_B(i) = \\delta_{i,1}$, so $L_B(0)=0, L_B(1)=1$.\n$L_C(i) = \\delta_{i,0}$, so $L_C(0)=1, L_C(1)=0$.\n\nNext, we calculate the conditional likelihoods at the internal node $N$:\n$L_N(i) = \\left( \\sum_{j \\in \\{0,1\\}} P_{ij}(b) L_A(j) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{ik}(b) L_B(k) \\right)$\nFor $i=0$:\n$L_N(0) = (P_{00}(b)L_A(0) + P_{01}(b)L_A(1)) \\cdot (P_{00}(b)L_B(0) + P_{01}(b)L_B(1)) = (p_s \\cdot 0 + p_d \\cdot 1)(p_s \\cdot 0 + p_d \\cdot 1) = p_d^2$.\nFor $i=1$:\n$L_N(1) = (P_{10}(b)L_A(0) + P_{11}(b)L_A(1)) \\cdot (P_{10}(b)L_B(0) + P_{11}(b)L_B(1)) = (p_d \\cdot 0 + p_s \\cdot 1)(p_d \\cdot 0 + p_s \\cdot 1) = p_s^2$.\n\nFinally, we calculate the total likelihood for each possible root state at node $R$:\n$L(s_R) = \\left( \\sum_{j \\in \\{0,1\\}} P_{s_R, j}(b) L_N(j) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{s_R, k}(b) L_C(k) \\right)$\nFor root state $s_R=0$:\n$L(0) = (P_{00}(b)L_N(0) + P_{01}(b)L_N(1)) \\cdot (P_{00}(b)L_C(0) + P_{01}(b)L_C(1))$\n$L(0) = (p_s \\cdot p_d^2 + p_d \\cdot p_s^2) \\cdot (p_s \\cdot 1 + p_d \\cdot 0) = (p_s p_d (p_d + p_s)) \\cdot p_s = (p_s p_d) \\cdot p_s = p_s^2 p_d$.\n\nFor root state $s_R=1$:\n$L(1) = (P_{10}(b)L_N(0) + P_{11}(b)L_N(1)) \\cdot (P_{10}(b)L_C(0) + P_{11}(b)L_C(1))$\n$L(1) = (p_d \\cdot p_d^2 + p_s \\cdot p_s^2) \\cdot (p_d \\cdot 1 + p_s \\cdot 0) = (p_d^3 + p_s^3) \\cdot p_d$.\n\nThe posterior probability of the root being in state $0$ is given by Bayes' theorem, with a uniform prior $P(s_R=0)=P(s_R=1)=1/2$:\n$$ P(s_R=0 | D) = \\frac{P(D | s_R=0) P(s_R=0)}{P(D)} = \\frac{L(0) \\cdot (1/2)}{L(0) \\cdot (1/2) + L(1) \\cdot (1/2)} = \\frac{L(0)}{L(0)+L(1)} $$\n$$ P(s_R=0 | D) = \\frac{p_s^2 p_d}{p_s^2 p_d + p_d(p_d^3 + p_s^3)} $$\nSince $b>0$, we have $p_d \\neq 0$, so we can simplify by dividing by $p_d$:\n$$ P(s_R=0 | D) = \\frac{p_s^2}{p_s^2 + p_d^3 + p_s^3} $$\nTo simplify further, we substitute $y = \\exp(-2b)$. Then $p_s = \\frac{1}{2}(1+y)$ and $p_d = \\frac{1}{2}(1-y)$.\n$p_s^2 = \\frac{1}{4}(1+y)^2 = \\frac{1}{4}(1+2y+y^2)$.\n$p_s^3 = \\frac{1}{8}(1+y)^3 = \\frac{1}{8}(1+3y+3y^2+y^3)$.\n$p_d^3 = \\frac{1}{8}(1-y)^3 = \\frac{1}{8}(1-3y+3y^2-y^3)$.\nThe sum $p_d^3 + p_s^3 = \\frac{1}{8}((1-3y+3y^2-y^3) + (1+3y+3y^2+y^3)) = \\frac{1}{8}(2+6y^2) = \\frac{1}{4}(1+3y^2)$.\nThe denominator of the posterior is:\n$p_s^2 + p_d^3 + p_s^3 = \\frac{1}{4}(1+2y+y^2) + \\frac{1}{4}(1+3y^2) = \\frac{1}{4}(2+2y+4y^2) = \\frac{1}{2}(1+y+2y^2)$.\nNow, we write the posterior probability:\n$$ P(s_R=0|D) = \\frac{\\frac{1}{4}(1+y)^2}{\\frac{1}{2}(1+y+2y^2)} = \\frac{(1+y)^2}{2(1+y+2y^2)} $$\nSubstituting $y = \\exp(-2b)$ back into the expression, the final closed-form answer is:\n$$ P(s_R=0|D) = \\frac{(1+\\exp(-2b))^2}{2(1+\\exp(-2b)+2\\exp(-4b))} $$\n\nTo determine which root state maximizes the posterior probability, we compare $P(s_R=0|D)$ with $P(s_R=1|D) = 1 - P(s_R=0|D)$.\n$P(s_R=1|D) = 1 - \\frac{(1+y)^2}{2(1+y+2y^2)} = \\frac{2(1+y+2y^2) - (1+2y+y^2)}{2(1+y+2y^2)} = \\frac{2+2y+4y^2 - 1-2y-y^2}{2(1+y+2y^2)} = \\frac{1+3y^2}{2(1+y+2y^2)}$.\nWe compare the numerators. Let's evaluate the difference: $(1+y)^2 - (1+3y^2) = 1+2y+y^2 - 1 - 3y^2 = 2y - 2y^2 = 2y(1-y)$.\nSince branch length $b > 0$, we have $0 < y = \\exp(-2b) < 1$. In this interval, both $2y$ and $(1-y)$ are positive, so their product $2y(1-y) > 0$.\nThis implies $(1+y)^2 > 1+3y^2$, and therefore $P(s_R=0|D) > P(s_R=1|D)$ for any finite, non-zero branch length $b$. Thus, the Mk model inference favors state $0$ for the root.\n\nFor contrast, we apply Fitch's parsimony algorithm.\nThe up-pass determines the set of possible states for each internal node:\n1.  Tips: $S_A = \\{1\\}$, $S_B = \\{1\\}$, $S_C = \\{0\\}$.\n2.  Node $N$: $S_N = S_A \\cap S_B = \\{1\\} \\cap \\{1\\} = \\{1\\}$.\n3.  Root $R$: $S_R = S_N \\cap S_C = \\{1\\} \\cap \\{0\\} = \\emptyset$. Since the intersection is empty, we take the union: $S_R = S_N \\cup S_C = \\{1\\} \\cup \\{0\\} = \\{0,1\\}$.\nThe minimum number of changes (parsimony score) is $1$, corresponding to the single union operation performed. The set of most parsimonious states for the root is $\\{0,1\\}$. Parsimony is therefore ambiguous and considers both root states $0$ and $1$ to be equally plausible.\n\nIn conclusion, the likelihood-based method under the Mk model provides a decisive result, consistently favoring root state $0$ for any $b>0$. This contrasts with Fitch parsimony, which finds both root states $0$ and $1$ to be equally optimal. The likelihood method is more nuanced, as it accounts for the probability of multiple substitutions along branches and correctly weighs the evidence from the non-independent, phylogenetically related taxa $A$ and $B$. It correctly infers that a single change on the internal branch leading to the $(A,B)$ clade is more probable than a change on the terminal branch leading to $C$, a distinction that the simple counting of changes in parsimony fails to make.", "answer": "$$ \\boxed{\\frac{(1+\\exp(-2b))^{2}}{2(1+\\exp(-2b)+2\\exp(-4b))}} $$", "id": "2760550"}]}