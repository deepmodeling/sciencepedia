{"hands_on_practices": [{"introduction": "Understanding the evolution of body plans begins with the fundamental rules governing Hox gene function. This first practice exercise challenges you to apply the principle of homeotic transformation, a cornerstone of developmental genetics. By predicting the outcome of a classic loss-of-function mutation [@problem_id:1685827], you will reinforce your understanding of how these master regulators establish segmental identity along the anterior-posterior axis.", "problem": "In the fruit fly, *Drosophila melanogaster*, the body plan is organized into segments, each with a specific identity determined by a family of master regulatory genes called Hox genes. The thorax is composed of three segments: the first thoracic segment (T1), the second thoracic segment (T2), and the third thoracic segment (T3). In a wild-type fly, T1 develops a pair of legs. T2 develops a pair of legs and a pair of wings. T3 develops a pair of legs and a pair of small balancing organs called halteres.\n\nThe *Antennapedia* (*Antp*) gene is a Hox gene whose primary function is to specify the identity of the T2 segment. Imagine a developmental biologist creates a mutant fly that has a complete loss-of-function mutation in the *Antp* gene, meaning the gene produces no functional protein.\n\nWhich of the following descriptions best represents the predicted homeotic transformation in this mutant fly?\n\nA. The second thoracic segment (T2) will develop structures characteristic of the first thoracic segment (T1), resulting in a segment with legs but no wings.\n\nB. The second thoracic segment (T2) will develop structures characteristic of the third thoracic segment (T3), resulting in a segment with legs and halteres instead of wings.\n\nC. The head segment will develop a pair of legs in place of the antennae.\n\nD. The second thoracic segment (T2) will fail to develop entirely, and will be absent from the adult fly.\n\nE. Both the second (T2) and third (T3) thoracic segments will develop wings, resulting in a four-winged fly.", "solution": "We use the general principles of Hox gene function and homeotic transformation:\n1) Hox genes specify segmental identity along the anterior-posterior axis. \n2) Loss-of-function of a Hox gene typically causes a homeotic transformation toward a more anterior identity (anteriorization) of the affected segment, not loss of the segment.\n3) Gain-of-function or ectopic expression of a Hox gene can impose a more posterior identity in an anterior region.\n\nApply to the specific case:\n4) The Antennapedia (Antp) gene normally specifies the identity of the second thoracic segment (T2).\n5) A complete loss-of-function mutation in Antp removes T2 identity cues, so the default transformation is toward the identity of the next more anterior segment, which is T1.\n6) The characteristic structures are: T1 has legs only; T2 has legs and wings; T3 has legs and halteres.\n\nPredicted phenotype:\n7) With Antp nonfunctional, the T2 segment assumes T1 identity, yielding a segment with legs but no wings. This matches option A.\n\nExclude other options:\n8) Option B (T2 acquiring T3 identity) would be a posteriorization, not expected from Antp loss-of-function; T3 identity is normally specified by Ultrabithorax (Ubx).\n9) Option C (legs replacing antennae) is the classic Antp gain-of-function in the head, not a loss-of-function in T2.\n10) Option D (segment absence) is not typical of Hox loss-of-function; segments are transformed, not eliminated.\n11) Option E (four-winged fly) is produced by Ubx loss-of-function causing T3 to transform into T2, not by Antp loss-of-function.\n\nTherefore, the correct description is that T2 becomes T1-like: legs without wings.", "answer": "$$\\boxed{A}$$", "id": "1685827"}, {"introduction": "Beyond the function of individual genes, the organization of the Hox cluster itself holds evolutionary clues. A key hypothesis suggests that the gene order on the chromosome reflects the history of gene duplication events. This practice provides a hands-on opportunity to test this idea of 'sequence collinearity' by applying a quantitative approach [@problem_id:1685840], using rank correlation to measure the association between a gene's physical position and its evolutionary divergence.", "problem": "In developmental biology, the Hox genes are a family of transcription factors crucial for establishing the body plan along the anterior-posterior axis. In many animals, these genes are physically organized into clusters on a chromosome. A remarkable phenomenon known as collinearity describes the relationship between a gene's position in the cluster and its expression domain in the developing embryo: genes at the 3' end of the cluster are expressed in anterior regions, while genes at the 5' end are expressed in posterior regions.\n\nAn evolutionary hypothesis proposes a second form of collinearity: that the genomic order of Hox genes also reflects their sequence evolution. Specifically, it is hypothesized that genes which are closer together within the cluster are more similar in sequence than genes that are far apart, suggesting a stepwise evolution of the cluster via local gene duplications.\n\nTo test this hypothesis, you are provided with data from a hypothetical vertebrate species that possesses a single Hox cluster with four genes, ordered sequentially from 3' to 5' as `Hox-1`, `Hox-2`, `Hox-3`, and `Hox-4`. The evolutionary distance between the protein products of each gene pair has been calculated based on the number of amino acid differences in their highly-conserved homeodomain region. The pairwise distances are as follows:\n\n-   Distance(`Hox-1`, `Hox-2`): 10\n-   Distance(`Hox-1`, `Hox-3`): 18\n-   Distance(`Hox-1`, `Hox-4`): 25\n-   Distance(`Hox-2`, `Hox-3`): 12\n-   Distance(`Hox-2`, `Hox-4`): 20\n-   Distance(`Hox-3`, `Hox-4`): 9\n\nYour task is to quantify the strength of the association between the physical separation of the genes on the chromosome and their evolutionary distance. Define \"genomic separation\" as the absolute difference in the numerical identifiers of the genes (e.g., the separation between `Hox-1` and `Hox-3` is $3 - 1 = 2$).\n\nCalculate the Spearman rank correlation coefficient, $\\rho$, between genomic separation and evolutionary distance. Round your final answer to four significant figures.", "solution": "We are given a single Hox cluster with four genes ordered as Hox-1, Hox-2, Hox-3, Hox-4. For each unordered gene pair, define genomic separation as the absolute difference in their indices, and use the provided evolutionary distances. The six pairs and their values are:\n- $(\\text{Hox-1},\\text{Hox-2})$: separation $s=|1-2|=1$, distance $d=10$.\n- $(\\text{Hox-1},\\text{Hox-3})$: separation $s=|1-3|=2$, distance $d=18$.\n- $(\\text{Hox-1},\\text{Hox-4})$: separation $s=|1-4|=3$, distance $d=25$.\n- $(\\text{Hox-2},\\text{Hox-3})$: separation $s=|2-3|=1$, distance $d=12$.\n- $(\\text{Hox-2},\\text{Hox-4})$: separation $s=|2-4|=2$, distance $d=20$.\n- $(\\text{Hox-3},\\text{Hox-4})$: separation $s=|3-4|=1$, distance $d=9$.\n\nSpearman’s rank correlation coefficient $\\rho$ is the Pearson correlation of the ranks of $s$ and $d$. Rank $s$ (with average ranks for ties) and rank $d$ (all distinct):\n- Separations $s$: values are $1,1,1,2,2,3$. Their ranks are $2,2,2,4.5,4.5,6$ respectively.\n- Distances $d$: values are $9,10,12,18,20,25$ with ranks $1,2,3,4,5,6$ respectively.\n\nAligning with the pairs in the order listed above gives rank vectors $r_{s}=(2,\\,4.5,\\,6,\\,2,\\,4.5,\\,2)$ and $r_{d}=(2,\\,4,\\,6,\\,3,\\,5,\\,1).$\nLet $\\bar{r}_{s}$ and $\\bar{r}_{d}$ denote the means. Since ranks are from $1$ to $6$, both means are\n$$\\bar{r}_{s}=\\bar{r}_{d}=\\frac{1+2+3+4+5+6}{6}=\\frac{21}{6}=3.5.$$\nCompute the covariance numerator and the sums of squared deviations:\n$$\\sum_{i=1}^{6}(r_{s,i}-\\bar{r}_{s})(r_{d,i}-\\bar{r}_{d})=15,$$\n$$\\sum_{i=1}^{6}(r_{s,i}-\\bar{r}_{s})^{2}=15,\\qquad \\sum_{i=1}^{6}(r_{d,i}-\\bar{r}_{d})^{2}=17.5=\\frac{35}{2}.$$\nTherefore,\n$$\\rho=\\frac{\\sum_{i}(r_{s,i}-\\bar{r}_{s})(r_{d,i}-\\bar{r}_{d})}{\\sqrt{\\left[\\sum_{i}(r_{s,i}-\\bar{r}_{s})^{2}\\right]\\left[\\sum_{i}(r_{d,i}-\\bar{r}_{d})^{2}\\right]}}=\\frac{15}{\\sqrt{15\\cdot \\frac{35}{2}}}=\\frac{15}{\\sqrt{\\frac{525}{2}}}=\\frac{3\\sqrt{2}}{\\sqrt{21}}=\\frac{\\sqrt{42}}{7}.$$\nNumerically, rounding to four significant figures, $\\rho\\approx 0.9258.$", "answer": "$$\\boxed{0.9258}$$", "id": "1685840"}, {"introduction": "The evolution of morphology is often driven by changes in gene regulation rather than the genes themselves. This advanced problem delves into the evolutionary dynamics of cis-regulatory enhancers, the DNA sequences that control Hox gene expression. You will construct and analyze a population genetics model of transcription factor binding site turnover [@problem_id:2708691], providing insight into how enhancers can maintain stable function while their underlying sequence composition is in constant flux.", "problem": "Consider a simplified evolutionary model of a cis-regulatory enhancer controlling a Homeobox (Hox) gene. The enhancer contains at most $K$ non-overlapping, functionally equivalent transcription factor binding sites (\"motifs\") that contribute redundantly to the probability of transcription factor occupancy. Let $k \\in \\{0,1,\\dots,K\\}$ denote the current number of functional motifs. Motif gains and losses occur by point mutation in the weak-mutation regime such that the population is effectively monomorphic at any time and evolves by rare substitutions that change $k$ by $\\pm 1$. Assume the following:\n\n1. Mutation opportunities and rates:\n   - There are $K - k$ opportunities to gain a motif, each with per-opportunity rate $\\mu_b$ (birth).\n   - There are $k$ opportunities to lose a motif, each with per-opportunity rate $\\mu_d$ (death).\n   - Treat $\\mu_b$ and $\\mu_d$ as constant across $k$ and time, with $\\mu_b > 0$ and $\\mu_d > 0$.\n\n2. Expression model:\n   - The contribution of $k$ motifs to normalized expression is saturating: $E(k) = 1 - e^{-a k}$, where $a \\ge 0$ is a biophysical scale parameter for binding/occupancy.\n\n3. Fitness under stabilizing selection:\n   - The optimal expression is $E^\\star \\in [0,1]$ and the penalty for deviation is Gaussian stabilizing selection in Malthusian units: $m(k) = \\ln W(k) = - S \\left(E(k) - E^\\star\\right)^2$, where $S \\ge 0$ is the selection strength and $W(k)$ is Wrightian fitness.\n\n4. Population-genetic regime:\n   - Assume strong-selection, weak-mutation in a Wright–Fisher population with effective size $N_e$, so that substitutions are rare and the stationary distribution over $k$ exists and obeys detailed balance with respect to mutation asymmetry (numbers of opportunities) and fitness differences.\n\nTask:\n- For each parameter set in the test suite below, compute the stationary distribution $\\pi(k)$ over $k \\in \\{0,\\dots,K\\}$ implied by the above assumptions.\n- Using that distribution, compute:\n  1. The stationary mean number of motifs, $\\mathbb{E}[k] = \\sum_{k=0}^{K} k \\, \\pi(k)$.\n  2. The stationary probability mass of expression states within a specified tolerance $\\delta$, namely $P_\\delta = \\sum_{k: |E(k) - E^\\star| \\le \\delta} \\pi(k)$.\n\nOutput specification:\n- Your program must output a single line containing a comma-separated list enclosed in square brackets. For each test case in order, output two numbers in sequence: the stationary mean number of motifs $\\mathbb{E}[k]$ and the probability $P_\\delta$. Round each number to six decimal places. The final output concatenates all cases in order, e.g., $\"[x_1,y_1,x_2,y_2,\\dots]\"$.\n\nTest suite (each case is $(K,\\mu_b,\\mu_d,a,E^\\star,S,N_e,\\delta)$):\n- Case A (happy path, moderate saturation, strong stabilizing selection): $(10,\\, 1 \\times 10^{-8},\\, 1 \\times 10^{-8},\\, 0.7,\\, 0.8,\\, 50,\\, 1 \\times 10^{5},\\, 0.05)$.\n- Case B (neutral benchmark, asymmetric mutation, no selection): $(12,\\, 1 \\times 10^{-8},\\, 3 \\times 10^{-8},\\, 0.5,\\, 0.6,\\, 0,\\, 1 \\times 10^{5},\\, 0.10)$.\n- Case C (mutation bias favoring gains, intermediate selection): $(8,\\, 5 \\times 10^{-8},\\, 1 \\times 10^{-8},\\, 0.4,\\, 0.6,\\, 10,\\, 5 \\times 10^{4},\\, 0.02)$.\n- Case D (degenerate regulatory effect, no functional dependence on $k$): $(6,\\, 2 \\times 10^{-8},\\, 2 \\times 10^{-8},\\, 0,\\, 0.2,\\, 1000,\\, 1 \\times 10^{5},\\, 0.01)$.\n\nRequirements and clarifications:\n- Assume the stationary distribution exists and is unique under the stated regime.\n- All computations are dimensionless; no physical units are required.\n- Angles are not involved.\n- Ensure numerical stability in computing $\\pi(k)$ for large $N_e S$ by using logarithmic transformations where appropriate.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\"[result_1,result_2,\\dots]\"$), with each number rounded to six decimal places.", "solution": "The problem statement has been evaluated and is deemed valid. It is scientifically grounded in established principles of population genetics and molecular evolution, is mathematically well-posed, and is presented in an objective, formal manner. All necessary parameters are provided, and the model constitutes a solvable problem in theoretical biology.\n\nThe problem requires the computation of the stationary distribution, $\\pi(k)$, for the number of functional transcription factor binding sites, $k$, in an enhancer region. The state space for $k$ is the set of integers $\\{0, 1, \\dots, K\\}$. The system's evolution is modeled as a one-dimensional birth-death process representing the gain and loss of binding sites.\n\nThe stationary distribution of a continuous-time Markov process on a finite state space exists and is unique, provided the process is irreducible. This condition is met here as transitions are possible between any adjacent states $k$ and $k \\pm 1$ (for $0 < k < K$), with boundary conditions preventing transitions out of the state space. The stationary distribution $\\pi(k)$ must satisfy the detailed balance condition:\n$$ \\pi(k) q_{k \\to k+1} = \\pi(k+1) q_{k+1 \\to k} $$\nwhere $q_{i \\to j}$ is the transition rate from state $i$ to state $j$. This implies the following ratio:\n$$ \\frac{\\pi(k+1)}{\\pi(k)} = \\frac{q_{k \\to k+1}}{q_{k+1 \\to k}} $$\n\nThe transition rate is the product of the mutation supply rate and the probability of fixation.\nThe mutation supply rate for a gain of a motif, changing state from $k$ to $k+1$, is given by the number of opportunities to gain a site, $K-k$, multiplied by the per-opportunity rate, $\\mu_b$. So, the mutation supply rate is $M_{k \\to k+1} = (K-k)\\mu_b$.\nSimilarly, the mutation supply rate for a loss of a motif, changing state from $k+1$ to $k$, is $M_{k+1 \\to k} = (k+1)\\mu_d$.\n\nThe fixation probability of a new mutation in a Wright-Fisher population of effective size $N_e$ depends on its selection coefficient, $s$. The Malthusian fitness is given as $m(k) = -S(E(k) - E^\\star)^2$. The selection coefficient, $s_k$, for a mutation from $k$ to $k+1$ is the difference in Malthusian fitness: $s_k = m(k+1) - m(k)$. For the reverse mutation, the selection coefficient is $-s_k$.\n\nIn a haploid Wright-Fisher model, the fixation probability of a mutant with selection coefficient $s$ is given by Kimura's formula:\n$$ P_{\\text{fix}}(s) = \\frac{1 - e^{-2s}}{1 - e^{-2N_e s}} $$\nThe ratio of fixation probabilities for the forward ($k \\to k+1$) and reverse ($k+1 \\to k$) mutations is:\n$$ \\frac{P_{\\text{fix}}(s_k)}{P_{\\text{fix}}(-s_k)} = \\frac{(1 - e^{-2s_k})/(1 - e^{-2N_e s_k})}{(1 - e^{2s_k})/(1 - e^{2N_e s_k})} = \\frac{1 - e^{-2s_k}}{1 - e^{2s_k}} \\cdot \\frac{1 - e^{2N_e s_k}}{1 - e^{-2N_e s_k}} $$\nThis simplifies exactly to:\n$$ \\frac{P_{\\text{fix}}(s_k)}{P_{\\text{fix}}(-s_k)} = e^{2(N_e - 1)s_k} $$\nCombining the mutation supply rates and the fixation probability ratio, we obtain the recurrence relation for the stationary distribution:\n$$ \\frac{\\pi(k+1)}{\\pi(k)} = \\frac{(K-k)\\mu_b}{(k+1)\\mu_d} \\exp\\Big[2(N_e - 1)\\big(m(k+1) - m(k)\\big)\\Big] $$\n\nThis recurrence relation allows for the computation of the unnormalized probabilities $\\tilde{\\pi}(k)$ by setting $\\tilde{\\pi}(0) = 1$ and iterating from $k=0$ to $K-1$:\n$$ \\tilde{\\pi}(k+1) = \\tilde{\\pi}(k) \\cdot \\frac{(K-k)\\mu_b}{(k+1)\\mu_d} \\exp\\Big[2(N_e - 1)\\big(m(k+1) - m(k)\\big)\\Big] $$\nThe term $(N_e-1)S$ can be large, leading to numerical overflow or underflow. To ensure stability, computations are performed in logarithmic space. Let $\\ln\\tilde{\\pi}(k)$ be the logarithm of the unnormalized probability.\n$$ \\ln\\tilde{\\pi}(0) = 0 $$\n$$ \\ln\\tilde{\\pi}(k+1) = \\ln\\tilde{\\pi}(k) + \\ln\\left(\\frac{(K-k)\\mu_b}{(k+1)\\mu_d}\\right) + 2(N_e - 1)\\big(m(k+1) - m(k)\\big) $$\nAfter computing all $\\ln\\tilde{\\pi}(k)$, the probabilities are normalized using the log-sum-exp trick. Let $L_{\\max} = \\max_k \\{ \\ln\\tilde{\\pi}(k) \\}$. The normalized stationary distribution is:\n$$ \\pi(k) = \\frac{\\exp(\\ln\\tilde{\\pi}(k) - L_{\\max})}{\\sum_{j=0}^{K} \\exp(\\ln\\tilde{\\pi}(j) - L_{\\max})} $$\nOnce $\\pi(k)$ is obtained, the required quantities are calculated:\n1. The stationary mean number of motifs: $\\mathbb{E}[k] = \\sum_{k=0}^{K} k \\cdot \\pi(k)$.\n2. The stationary probability mass within tolerance $\\delta$ of the optimal expression $E^\\star$: $P_\\delta = \\sum_{k: |E(k) - E^\\star| \\le \\delta} \\pi(k)$.\n\nThe provided Python code implements this procedure for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stationary distribution of motif counts and derived statistics\n    for a given set of evolutionary parameters.\n    \"\"\"\n\n    # Test suite: (K, mu_b, mu_d, a, E_star, S, N_e, delta)\n    test_cases = [\n        # Case A: happy path, moderate saturation, strong stabilizing selection\n        (10, 1e-8, 1e-8, 0.7, 0.8, 50, 1e5, 0.05),\n        # Case B: neutral benchmark, asymmetric mutation, no selection\n        (12, 1e-8, 3e-8, 0.5, 0.6, 0, 1e5, 0.10),\n        # Case C: mutation bias favoring gains, intermediate selection\n        (8, 5e-8, 1e-8, 0.4, 0.6, 10, 5e4, 0.02),\n        # Case D: degenerate regulatory effect, no functional dependence on k\n        (6, 2e-8, 2e-8, 0, 0.2, 1000, 1e5, 0.01),\n    ]\n\n    all_results = []\n    \n    for params in test_cases:\n        K, mu_b, mu_d, a, E_star, S, N_e, delta = params\n\n        k_vals = np.arange(K + 1, dtype=float)\n        \n        # Vectorized computation of expression and Malthusian fitness\n        E_vals = 1.0 - np.exp(-a * k_vals)\n        m_vals = -S * (E_vals - E_star)**2\n\n        # Compute log unnormalized probabilities iteratively\n        log_pi_tilde = np.zeros(K + 1)\n        for k in range(K):\n            delta_m = m_vals[k + 1] - m_vals[k]\n            \n            # Log of mutational bias term\n            log_mut_ratio = np.log(K - k) + np.log(mu_b) - (np.log(k + 1) + np.log(mu_d))\n            \n            # Log of selection term from the ratio of fixation probabilities\n            selection_term = 2.0 * (N_e - 1.0) * delta_m\n            \n            log_pi_tilde[k + 1] = log_pi_tilde[k] + log_mut_ratio + selection_term\n\n        # Normalize probabilities using log-sum-exp trick for numerical stability\n        log_pi_tilde -= np.max(log_pi_tilde)\n        pi_tilde = np.exp(log_pi_tilde)\n        pi_dist = pi_tilde / np.sum(pi_tilde)\n\n        # Calculate stationary mean number of motifs\n        mean_k = np.sum(k_vals * pi_dist)\n\n        # Calculate stationary probability mass within the specified tolerance\n        condition_mask = np.abs(E_vals - E_star) <= delta\n        P_delta = np.sum(pi_dist[condition_mask])\n\n        all_results.extend([round(mean_k, 6), round(P_delta, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2708691"}]}