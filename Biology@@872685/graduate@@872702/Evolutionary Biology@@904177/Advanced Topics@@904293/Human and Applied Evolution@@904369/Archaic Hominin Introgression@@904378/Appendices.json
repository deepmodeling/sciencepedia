{"hands_on_practices": [{"introduction": "A primary goal in studying introgression is to quantify its extent. The $f_4$-ratio statistic provides a robust method for estimating the admixture proportion, $\\alpha$. This exercise focuses on a crucial aspect of quantitative science: assessing the uncertainty of an estimate. You will use the multivariate delta method to propagate the variance and covariance from block-jackknife estimates of the underlying $f_4$-statistics to determine the standard error of the final admixture proportion, a vital step for interpreting its statistical significance. [@problem_id:2692273]", "problem": "In a study of archaic hominin introgression, consider the four-population statistic $f_4(A,B;C,D)$ defined as the expected product of allele-frequency differences across loci, $f_4(A,B;C,D) = \\mathbb{E}\\left[(p_A - p_B)(p_C - p_D)\\right]$, where $p_X$ denotes the allele frequency in population $X$. For a Test population $T$, an Outgroup $O$, a Neanderthal reference $N$, a Denisovan reference $D$, and a modern human Reference $R$ known to lack Neanderthal ancestry, an $f_4$-ratio estimator of Neanderthal admixture proportion is defined as\n$$\n\\hat{\\alpha} \\equiv \\frac{\\widehat{f_4}(T,O;N,D)}{\\widehat{f_4}(R,O;N,D)} \\equiv \\frac{\\hat{f}_1}{\\hat{f}_2}.\n$$\nBlock jackknife (BJ) across large genomic segments was used to estimate the means and the $2 \\times 2$ covariance matrix of the vector $(\\hat{f}_1,\\hat{f}_2)^{\\top}$. The BJ estimates are:\n$$\n\\hat{f}_1 = 1.30 \\times 10^{-4}, \\qquad \\hat{f}_2 = 6.10 \\times 10^{-3},\n$$\nand\n$$\n\\widehat{\\Sigma} = \n\\begin{pmatrix}\n2.4 \\times 10^{-9}  -3.0 \\times 10^{-9} \\\\\n-3.0 \\times 10^{-9}  1.3 \\times 10^{-7}\n\\end{pmatrix}.\n$$\nUsing first principles of error propagation for smooth functions of random variables, apply the multivariate delta method to compute the standard error $\\operatorname{se}(\\hat{\\alpha}) = \\sqrt{\\operatorname{Var}(\\hat{\\alpha})}$, explicitly accounting for the covariance between $\\hat{f}_1$ and $\\hat{f}_2$. You may treat $(\\hat{f}_1,\\hat{f}_2)^{\\top}$ as approximately jointly normal with mean $(\\hat{f}_1,\\hat{f}_2)^{\\top}$ and covariance $\\widehat{\\Sigma}$.\n\nReport only the standard error $\\operatorname{se}(\\hat{\\alpha})$ (dimensionless) as your final answer, rounded to three significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is therefore deemed valid. The task is to compute the standard error of a ratio estimator using the multivariate delta method.\n\nLet the vector of statistics be $\\boldsymbol{\\theta} = (\\hat{f}_1, \\hat{f}_2)^{\\top}$. The estimator for the admixture proportion is a function of these statistics, $\\hat{\\alpha} = g(\\boldsymbol{\\theta}) = g(\\hat{f}_1, \\hat{f}_2) = \\frac{\\hat{f}_1}{\\hat{f}_2}$. The multivariate delta method provides a first-order approximation for the variance of a smooth function of random variables. If $\\boldsymbol{\\theta}$ is a random vector with mean $\\boldsymbol{\\mu}$ and covariance matrix $\\Sigma$, then the variance of $g(\\boldsymbol{\\theta})$ is approximated by:\n$$\n\\operatorname{Var}(g(\\boldsymbol{\\theta})) \\approx \\left[ \\nabla g(\\boldsymbol{\\mu}) \\right]^{\\top} \\Sigma \\left[ \\nabla g(\\boldsymbol{\\mu}) \\right]\n$$\nIn this problem, we use the estimated means and covariance matrix. The mean is approximated by the sample estimates $\\boldsymbol{\\mu} \\approx (\\hat{f}_1, \\hat{f}_2)^{\\top}$ and the covariance matrix is the given $\\widehat{\\Sigma}$.\n\nFirst, we compute the gradient of the function $g(x_1, x_2) = \\frac{x_1}{x_2}$. The partial derivatives are:\n$$\n\\frac{\\partial g}{\\partial x_1} = \\frac{1}{x_2}\n$$\n$$\n\\frac{\\partial g}{\\partial x_2} = -\\frac{x_1}{x_2^2}\n$$\nThe gradient vector, which we denote by $\\mathbf{J}$, is evaluated at the point $(\\hat{f}_1, \\hat{f}_2)$:\n$$\n\\mathbf{J} = \\nabla g(\\hat{f}_1, \\hat{f}_2) = \\begin{pmatrix} \\frac{1}{\\hat{f}_2} \\\\ -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix}\n$$\nThe variance of $\\hat{\\alpha}$ is then given by the quadratic form:\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\mathbf{J}^{\\top} \\widehat{\\Sigma} \\mathbf{J} = \\begin{pmatrix} \\frac{1}{\\hat{f}_2}  -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix} \\widehat{\\Sigma} \\begin{pmatrix} \\frac{1}{\\hat{f}_2} \\\\ -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix}\n$$\nLet the elements of the covariance matrix be $\\widehat{\\Sigma} = \\begin{pmatrix} \\sigma_{11}  \\sigma_{12} \\\\ \\sigma_{21}  \\sigma_{22} \\end{pmatrix}$. Note that $\\sigma_{12} = \\sigma_{21}$. Expanding the matrix product gives the expression for the variance:\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\left(\\frac{1}{\\hat{f}_2}\\right)^2 \\sigma_{11} + 2 \\left(\\frac{1}{\\hat{f}_2}\\right) \\left(-\\frac{\\hat{f}_1}{\\hat{f}_2^2}\\right) \\sigma_{12} + \\left(-\\frac{\\hat{f}_1}{\\hat{f}_2^2}\\right)^2 \\sigma_{22}\n$$\nSimplifying this expression, we get:\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{\\sigma_{11}}{\\hat{f}_2^2} - \\frac{2\\hat{f}_1\\sigma_{12}}{\\hat{f}_2^3} + \\frac{\\hat{f}_1^2\\sigma_{22}}{\\hat{f}_2^4}\n$$\nThis can be rewritten more compactly in terms of $\\hat{\\alpha} = \\hat{f}_1/\\hat{f}_2$:\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{\\hat{f}_2^2} \\left( \\sigma_{11} - 2\\hat{\\alpha}\\sigma_{12} + \\hat{\\alpha}^2\\sigma_{22} \\right)\n$$\nWe are given the following numerical values:\n$\\hat{f}_1 = 1.30 \\times 10^{-4}$\n$\\hat{f}_2 = 6.10 \\times 10^{-3}$\n$\\sigma_{11} = 2.4 \\times 10^{-9}$\n$\\sigma_{12} = -3.0 \\times 10^{-9}$\n$\\sigma_{22} = 1.3 \\times 10^{-7}$\n\nFirst, we calculate the estimated admixture proportion $\\hat{\\alpha}$:\n$$\n\\hat{\\alpha} = \\frac{\\hat{f}_1}{\\hat{f}_2} = \\frac{1.30 \\times 10^{-4}}{6.10 \\times 10^{-3}} = \\frac{1.30}{61.0} \\approx 0.021311475\n$$\nNow, substitute the values into the variance formula:\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{\\left(6.10 \\times 10^{-3}\\right)^2} \\left[ \\left(2.4 \\times 10^{-9}\\right) - 2\\left(\\frac{1.30}{61.0}\\right)\\left(-3.0 \\times 10^{-9}\\right) + \\left(\\frac{1.30}{61.0}\\right)^2\\left(1.3 \\times 10^{-7}\\right) \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{3.721 \\times 10^{-5}} \\left[ 2.4 \\times 10^{-9} + \\left(\\frac{7.8}{61.0}\\right) \\times 10^{-9} + \\left(\\frac{1.69}{3721}\\right)\\left(1.3 \\times 10^{-7}\\right) \\right]\n$$\nTo maintain precision, we factor out $10^{-9}$:\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-9}}{3.721 \\times 10^{-5}} \\left[ 2.4 + \\frac{7.8}{61.0} + \\frac{1.69 \\times 130}{3721} \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-4}}{3.721} \\left[ 2.4 + 0.1278688... + 0.0590432... \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-4}}{3.721} \\left[ 2.586912... \\right] \\approx 0.695219... \\times 10^{-4} = 6.95219... \\times 10^{-5}\n$$\nThe standard error, $\\operatorname{se}(\\hat{\\alpha})$, is the square root of the variance:\n$$\n\\operatorname{se}(\\hat{\\alpha}) = \\sqrt{\\operatorname{Var}(\\hat{\\alpha})} \\approx \\sqrt{6.95219... \\times 10^{-5}} \\approx 0.00833798...\n$$\nRounding the result to three significant figures, as required, we obtain:\n$$\n\\operatorname{se}(\\hat{\\alpha}) \\approx 0.00834\n$$\nThis is expressed in scientific notation as $8.34 \\times 10^{-3}$.", "answer": "$$\n\\boxed{8.34 \\times 10^{-3}}\n$$", "id": "2692273"}, {"introduction": "Following an admixture event, recombination acts like a clock, progressively breaking down segments of introgressed DNA with each passing generation. The lengths of surviving archaic ancestry tracts in modern genomes therefore hold valuable information about the timing of the original introgression pulse. This practice guides you through the fundamental principles of using the mean tract length, $\\bar{L}$, to derive a point estimate for the time since admixture and, critically, to construct a confidence interval around that estimate. [@problem_id:2692279]", "problem": "A single-pulse archaic hominin introgression event occurred $t_a$ generations ago into an anatomically modern human population. After the admixture pulse, recombination breaks introgressed ancestry tracts each generation, and with a uniform per-base recombination rate $r$ (in $\\text{bp}^{-1}\\text{gen}^{-1}$), the lengths of introgressed tracts (measured in base pairs) can be modeled by a memoryless process along the chromosome. You are given an empirical estimate of the mean tract length $\\bar{L} = 70$ kb from a curated set of introgressed tracts inferred in present-day genomes, and a recombination rate $r = 1.0 \\times 10^{-8}$ per base pair per generation. A generation time of $29$ years is assumed. A block-bootstrap analysis of individuals and genomic regions yields an estimated variance of the sample mean tract length $\\text{Var}[\\bar{L}] = 4.9$ $(\\text{kb})^2$.\n\nUsing only foundational population-genetic reasoning about recombination breakpoints over $t_a$ generations after a single pulse of admixture, proceed as follows:\n\n- Derive an estimator for $t_a$ in generations in terms of $\\bar{L}$ and $r$, and compute its numerical value.\n- Convert the point estimate to years using the given generation time.\n- Using the delta method with the provided $\\text{Var}[\\bar{L}]$, compute an approximate $95\\%$ confidence interval (confidence interval (CI)) for $t_a$ in generations and convert that interval to years.\n\nAssume a single-pulse admixture model, spatially uniform recombination rate, and negligible gene conversion. Round all reported numerical values to three significant figures. Express the time estimates in generations and in years (state the units in your working), but note that only pure numbers will be checked for grading. For numerical computation, remember that $1$ kb $= 1000$ bp.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It describes a standard simplified model used in population genetics to date admixture events based on the decay of ancestry tract lengths due to recombination. The provided parameters are realistic, and the required calculations are standard statistical procedures. We shall therefore proceed to the solution.\n\nThe foundational principle is that the lengths of introgressed chromosome tracts, originating from a single pulse of admixture $t_a$ generations ago, follow an exponential distribution. This arises from modeling recombination breakpoints as a Poisson process along the chromosome. Let $r$ be the uniform recombination rate per base pair per generation. Over $t_a$ generations, the cumulative rate of breakpoints that terminate an ancestry tract is $\\lambda = t_a r$.\n\nThe probability density function for the length $L$ of a tract is given by $f(L) = \\lambda \\exp(-\\lambda L)$. The expected value, or mean length, of tracts from this exponential distribution is $E[L] = \\frac{1}{\\lambda}$.\n\nBy substituting $\\lambda = t_a r$, we obtain the relationship between the mean tract length and the time since admixture:\n$$E[L] = \\frac{1}{t_a r}$$\nThe empirically measured mean tract length, $\\bar{L}$, serves as an estimator for the true population mean $E[L]$. Thus, we can write $\\bar{L} \\approx \\frac{1}{t_a r}$. From this relationship, we derive the estimator for the number of generations since admixture, $\\hat{t}_a$, as a function of the observable quantity $\\bar{L}$ and the fixed parameter $r$:\n$$\\hat{t}_a = \\frac{1}{r \\bar{L}}$$\nThis is the required estimator for $t_a$.\n\nWe now compute the point estimate for $t_a$. The given values are $\\bar{L} = 70$ kb and $r = 1.0 \\times 10^{-8} \\text{ bp}^{-1}\\text{gen}^{-1}$. For dimensional consistency, we must express $\\bar{L}$ in base pairs (bp), using the conversion $1 \\text{ kb} = 1000 \\text{ bp}$:\n$$\\bar{L} = 70 \\text{ kb} = 70 \\times 1000 \\text{ bp} = 7 \\times 10^4 \\text{ bp}$$\nSubstituting the numerical values into our estimator:\n$$\\hat{t}_a = \\frac{1}{(1.0 \\times 10^{-8} \\text{ bp}^{-1}\\text{gen}^{-1}) \\times (7 \\times 10^4 \\text{ bp})} = \\frac{1}{7 \\times 10^{-4}} \\text{ gen} \\approx 1428.57 \\text{ generations}$$\nRounding to three significant figures, the point estimate is $\\hat{t}_a \\approx 1.43 \\times 10^3$ generations.\n\nTo convert this time into years, we use the specified generation time of $29$ years:\n$$\\text{Time in years} = \\hat{t}_a \\times 29 \\text{ years/gen} \\approx 1428.57 \\times 29 \\approx 41428.5 \\text{ years}$$\nRounding to three significant figures, this corresponds to $4.14 \\times 10^4$ years.\n\nNext, we compute the $95\\%$ confidence interval for $t_a$ utilizing the delta method. The delta method approximates the variance of a function of a random variable. Our estimator, $\\hat{t}_a = g(\\bar{L}) = (r\\bar{L})^{-1}$, is a function of the random variable $\\bar{L}$. The variance of $g(\\bar{L})$ is approximated as $\\text{Var}[\\hat{t}_a] \\approx (g'(\\mu_{\\bar{L}}))^2 \\text{Var}[\\bar{L}]$, where we use the sample mean $\\bar{L}$ as an estimate for its expected value $\\mu_{\\bar{L}}$. The derivative of $g(\\bar{L})$ with respect to $\\bar{L}$ is:\n$$g'(\\bar{L}) = \\frac{d}{d\\bar{L}} \\left( \\frac{1}{r\\bar{L}} \\right) = -\\frac{1}{r\\bar{L}^2}$$\nThe variance of our estimator is therefore:\n$$\\text{Var}[\\hat{t}_a] \\approx \\left(-\\frac{1}{r\\bar{L}^2}\\right)^2 \\text{Var}[\\bar{L}] = \\frac{\\text{Var}[\\bar{L}]}{r^2\\bar{L}^4}$$\nThis expression can be rewritten in terms of the point estimate $\\hat{t}_a = \\frac{1}{r\\bar{L}}$:\n$$\\text{Var}[\\hat{t}_a] \\approx \\left(\\frac{1}{r\\bar{L}}\\right)^2 \\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2} = \\hat{t}_a^2 \\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2}$$\nWe are given $\\text{Var}[\\bar{L}] = 4.9 \\text{ (kb)}^2$. The squared coefficient of variation of $\\bar{L}$ is:\n$$\\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2} = \\frac{4.9 \\text{ (kb)}^2}{(70 \\text{ kb})^2} = \\frac{4.9}{4900} = 0.001$$\nThe variance of $\\hat{t}_a$ is then:\n$$\\text{Var}[\\hat{t}_a] \\approx (1428.57 \\text{ gen})^2 \\times 0.001 \\approx 2040.8 \\text{ gen}^2$$\nThe standard error (SE) of the estimate is the square root of its variance:\n$$SE(\\hat{t}_a) = \\sqrt{\\text{Var}[\\hat{t}_a]} \\approx \\sqrt{2040.8} \\approx 45.175 \\text{ generations}$$\nAn approximate $95\\%$ confidence interval is given by $\\hat{t}_a \\pm z_{0.025} \\times SE(\\hat{t}_a)$, where $z_{0.025} \\approx 1.96$ is the critical value from the standard normal distribution. The margin of error is $1.96 \\times 45.175 \\approx 88.543$ generations.\n\nThe $95\\%$ confidence interval for $t_a$ in generations is:\n$$[1428.57 - 88.543, \\quad 1428.57 + 88.543] = [1340.027, \\quad 1517.113] \\text{ generations}$$\nRounding the bounds to three significant figures, the interval is $[1.34 \\times 10^3, 1.52 \\times 10^3]$ generations.\n\nFinally, we convert this interval to years by multiplying the unrounded bounds by the generation time of $29$ years:\n$$\\text{Lower bound (years)}: 1340.027 \\times 29 \\approx 38860.8 \\text{ years}$$\n$$\\text{Upper bound (years)}: 1517.113 \\times 29 \\approx 43996.3 \\text{ years}$$\nRounding to three significant figures, the $95\\%$ confidence interval in years is $[3.89 \\times 10^4, 4.40 \\times 10^4]$ years.\n\nThe requested numerical results are the point estimate for admixture time in generations and years, and the corresponding $95\\%$ confidence interval bounds.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.43 \\times 10^3  4.14 \\times 10^4  1.34 \\times 10^3  1.52 \\times 10^3  3.89 \\times 10^4  4.40 \\times 10^4\n\\end{pmatrix}\n}\n$$", "id": "2692279"}, {"introduction": "The integrity of ancient DNA data is paramount, as contamination with modern human DNA can severely bias population genetic inferences. This exercise is a theoretical exploration into the effects of such contamination on statistics used to detect introgression. By algebraically modeling how a simple mixture of archaic and modern DNA alters the expected counts of ABBA and BABA site patterns, you will derive the precise analytical bias introduced into the D-statistic and $f_4$-statistic, gaining a deeper, first-principles understanding of these tools' vulnerabilities. [@problem_id:2692246]", "problem": "Consider a standard four-taxon arrangement used to test archaic hominin introgression with the ABBA–BABA $D$-statistic: two modern human populations $P_1$ and $P_2$, an archaic hominin $A$, and an outgroup $O$ that defines the ancestral state. Assume the following data-generating scheme at bi-allelic sites with derived and ancestral states coded by $1$ and $0$, respectively, and that the outgroup $O$ is fixed ancestral at all considered sites. You will work under pseudo-haploid sampling: at each site, one allele is observed from each of $P_1$, $P_2$, and the archaic $A$ (or its contaminated counterpart defined below).\n\nDefine two disjoint classes of sites, each of which is present in a fixed count across the genome:\n1. $S_A$ sites of ABBA-class: at each such site, the true (uncontaminated) state configuration is $P_1 = 0$, $P_2 = 1$, $A = 1$, $O = 0$.\n2. $S_B$ sites of BABA-class: at each such site, the true configuration is $P_1 = 1$, $P_2 = 0$, $A = 1$, $O = 0$.\n\nThere are no other considered sites. Now suppose the observed archaic genome is a simple mixture (contamination) of the true archaic and a modern human contaminant population $X$ at fraction $c \\in [0,1]$ as follows: at each site independently, the observed archaic allele is drawn from the true archaic $A$ with probability $1 - c$ and from the contaminant $X$ with probability $c$. Let $x_A \\in [0,1]$ denote the probability that the contaminant $X$ carries the derived allele at ABBA-class sites, and let $x_B \\in [0,1]$ denote the probability that $X$ carries the derived allele at BABA-class sites.\n\nUse only the fundamental definitions below.\n- The ABBA and BABA site-pattern counts are the numbers of sites where the observed pseudo-haploid configuration matches $A\\!B\\!B\\!A$ and $B\\!A\\!B\\!A$, respectively, i.e., the counts of sites with $P_1 = 0$, $P_2 = 1$, archaic $=1$, $O = 0$ (ABBA) and with $P_1 = 1$, $P_2 = 0$, archaic $=1$, $O = 0$ (BABA).\n- The ABBA–BABA $D$-statistic is defined by $D = \\dfrac{\\mathrm{ABBA} - \\mathrm{BABA}}{\\mathrm{ABBA} + \\mathrm{BABA}}$.\n- The four-population statistic (f4) over a set of sites is defined by $f_4(P_1, P_2; A, O) = \\sum_{\\text{sites}} \\left(p_1 - p_2\\right)\\left(p_A - p_O\\right)$, where $p_1, p_2, p_A, p_O \\in \\{0,1\\}$ are the observed pseudo-haploid alleles at the site.\n\nTasks:\n1. Derive the expected ABBA and BABA counts as functions of $c$, $S_A$, $S_B$, $x_A$, and $x_B$ under the simple mixing model above.\n2. Using these expectations, compute the $D$-statistic under contamination, $D(c)$, and under no contamination, $D(0)$, and then derive the shift $\\Delta D(c) = D(c) - D(0)$ as a closed-form expression simplified in terms of $c$, $S_A$, $S_B$, $x_A$, and $x_B$.\n3. Using the definition of the four-population statistic, compute $f_4(P_1, P_2; A(c), O)$ under contamination, $f_4(c)$, and under no contamination, $f_4(0)$, and then derive the shift $\\Delta f_4(c) = f_4(c) - f_4(0)$ as a closed-form expression simplified in terms of $c$, $S_A$, $S_B$, $x_A$, and $x_B$.\n\nExpress your final answer as a single row matrix containing the two expressions $\\Delta D(c)$ and $\\Delta f_4(c)$, in that order. No numerical approximation is required; provide exact symbolic expressions. Do not include units.", "solution": "We proceed from the provided definitions and the described simple mixture model. The key is that, at each site, the observed archaic allele is drawn from the true archaic with probability $1 - c$ and from the contaminant $X$ with probability $c$.\n\nStep 1: Expected ABBA and BABA counts under contamination.\n\nBy construction, at every ABBA-class site the true archaic allele is derived ($1$). Under contamination, the observed archaic allele at an ABBA-class site is\n- derived with probability $(1 - c)\\cdot 1 + c \\cdot x_A = 1 - c(1 - x_A)$,\n- ancestral with complementary probability $c(1 - x_A)$.\n\nTherefore, the expected observed ABBA count is\n$$\n\\mathrm{ABBA}(c) = S_A \\left[1 - c\\left(1 - x_A\\right)\\right].\n$$\n\nSimilarly, at every BABA-class site the true archaic allele is also derived ($1$). Under contamination, the observed archaic allele at a BABA-class site is derived with probability $1 - c(1 - x_B)$. Therefore, the expected observed BABA count is\n$$\n\\mathrm{BABA}(c) = S_B \\left[1 - c\\left(1 - x_B\\right)\\right].\n$$\n\nIn the absence of contamination ($c = 0$), these reduce to\n$$\n\\mathrm{ABBA}(0) = S_A, \\quad \\mathrm{BABA}(0) = S_B.\n$$\n\nStep 2: The ABBA–BABA $D$-statistic and its shift.\n\nBy definition,\n$$\nD(c) = \\frac{\\mathrm{ABBA}(c) - \\mathrm{BABA}(c)}{\\mathrm{ABBA}(c) + \\mathrm{BABA}(c)}.\n$$\nSubstituting the expressions from Step 1,\n$$\nD(c) = \\frac{S_A \\left[1 - c(1 - x_A)\\right] - S_B \\left[1 - c(1 - x_B)\\right]}{S_A \\left[1 - c(1 - x_A)\\right] + S_B \\left[1 - c(1 - x_B)\\right]}.\n$$\nLet $a = S_A$, $b = S_B$, $\\alpha = 1 - x_A$, and $\\beta = 1 - x_B$ for algebraic clarity. Then\n$$\nD(c) = \\frac{(a - b) - c(a \\alpha - b \\beta)}{(a + b) - c(a \\alpha + b \\beta)}.\n$$\nThe uncontaminated value is\n$$\nD(0) = \\frac{a - b}{a + b}.\n$$\nThe shift is\n$$\n\\Delta D(c) = D(c) - D(0) = \\frac{(a - b) - c(a \\alpha - b \\beta)}{(a + b) - c(a \\alpha + b \\beta)} - \\frac{a - b}{a + b}.\n$$\nBring to a common denominator and simplify:\n\n$$\n\\Delta D(c) = \\frac{\\big[(a - b) - c(a \\alpha - b \\beta)\\big](a + b) - (a - b)\\big[(a + b) - c(a \\alpha + b \\beta)\\big]}{(a + b)\\big[(a + b) - c(a \\alpha + b \\beta)\\big]}.\n$$\n\nExpanding the numerator,\n\n$$\n\\Delta D(c) = \\frac{-(c)(a \\alpha - b \\beta)(a + b) + (c)(a - b)(a \\alpha + b \\beta)}{(a + b)\\big[(a + b) - c(a \\alpha + b \\beta)\\big]}.\n$$\n\nGroup the $c$ factor and rearrange terms:\n\n$$\n\\Delta D(c) = \\frac{c\\left[(a - b)(a \\alpha + b \\beta) - (a \\alpha - b \\beta)(a + b)\\right]}{(a + b)\\big[(a + b) - c(a \\alpha + b \\beta)\\big]}.\n$$\n\nCompute the bracketed term explicitly:\n\n$$\n(a - b)(a \\alpha + b \\beta) - (a \\alpha - b \\beta)(a + b) = 2ab(\\beta - \\alpha).\n$$\n\nHence\n\n$$\n\\Delta D(c) = \\frac{2 c\\, a b\\, (\\beta - \\alpha)}{(a + b)\\big[(a + b) - c(a \\alpha + b \\beta)\\big]}.\n$$\n\nReturning to the original variables, recall $\\beta - \\alpha = (1 - x_B) - (1 - x_A) = x_A - x_B$, and $a \\alpha + b \\beta = S_A(1 - x_A) + S_B(1 - x_B)$. Thus\n$$\n\\Delta D(c) = \\frac{2 c\\, S_A S_B\\, (x_A - x_B)}{(S_A + S_B)\\left[(S_A + S_B) - c\\left(S_A(1 - x_A) + S_B(1 - x_B)\\right)\\right]}.\n$$\n\nStep 3: The four-population statistic and its shift.\n\nBy definition,\n$$\nf_4(P_1, P_2; A, O) = \\sum_{\\text{sites}} \\left(p_1 - p_2\\right)\\left(p_A - p_O\\right).\n$$\nOn all considered sites, $p_O = 0$. For ABBA-class sites, $(p_1 - p_2) = 0 - 1 = -1$ and the expected observed archaic allele under contamination is $\\mathbb{E}[p_A] = 1 - c(1 - x_A)$. Hence the total expected contribution from all ABBA-class sites is\n$$\n\\sum_{\\text{ABBA}} (p_1 - p_2) p_A = - S_A \\left[1 - c(1 - x_A)\\right].\n$$\nFor BABA-class sites, $(p_1 - p_2) = 1 - 0 = 1$ and $\\mathbb{E}[p_A] = 1 - c(1 - x_B)$. Hence the total expected contribution from all BABA-class sites is\n$$\n\\sum_{\\text{BABA}} (p_1 - p_2) p_A = S_B \\left[1 - c(1 - x_B)\\right].\n$$\nTherefore,\n$$\nf_4(c) = S_B \\left[1 - c(1 - x_B)\\right] - S_A \\left[1 - c(1 - x_A)\\right].\n$$\nIn the absence of contamination,\n$$\nf_4(0) = S_B - S_A.\n$$\nThus the shift is\n\n$$\n\\Delta f_4(c) = f_4(c) - f_4(0) = - S_B\\, c(1 - x_B) + S_A\\, c(1 - x_A) = c\\left[S_A(1 - x_A) - S_B(1 - x_B)\\right].\n$$\n\n\nThese two closed-form expressions complete the requested derivations. We present them as a row matrix in the order $\\Delta D(c)$, $\\Delta f_4(c)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{2 c\\, S_A S_B\\, (x_A - x_B)}{(S_A + S_B)\\left[(S_A + S_B) - c\\left(S_A(1 - x_A) + S_B(1 - x_B)\\right)\\right]}  c\\left[S_A(1 - x_A) - S_B(1 - x_B)\\right]\\end{pmatrix}}$$", "id": "2692246"}]}