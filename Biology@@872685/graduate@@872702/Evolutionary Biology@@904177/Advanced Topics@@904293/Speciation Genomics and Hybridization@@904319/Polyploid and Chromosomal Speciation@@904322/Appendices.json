{"hands_on_practices": [{"introduction": "Polyploid speciation fundamentally begins with a rare cellular event: the failure of meiosis, leading to the production of unreduced gametes. This exercise challenges you to construct a foundational population genetics model to quantify the rate at which new autotetraploid individuals arise from a diploid population [@problem_id:2744643]. By translating the probability of meiotic error and the population's mating system into an expected frequency of polyploid zygotes, you will gain insight into the critical first step of this major evolutionary transition.", "problem": "In a large, panmictic, hermaphroditic diploid plant population, consider the formation of zygotes in a single reproductive season. Each individual produces both male and female gametes. During gametogenesis, each gamete independently fails meiosis and is unreduced (ploidy $2n$) with probability $u \\in [0,1]$, and is reduced (ploidy $n$) with probability $1-u$. A fraction $s \\in [0,1]$ of zygotes are formed by self-fertilization of a single individual, and the remaining fraction $1-s$ are formed by random mating between different individuals. Assume:\n- Independence of gametogenesis events within and across individuals (male and female meioses are independent even within the same parent).\n- Zygote ploidy is the sum of parental gamete ploidies.\n- Only the union of two unreduced gametes yields an autotetraploid ($4n$) zygote in this setting. Other pathways to $4n$ (for example, somatic doubling post-zygotically) are absent.\n- All zygotes with compatible ploidy class considered here are viable at the point of formation.\n\nUsing the basic principles of meiotic segregation and the law of total probability, derive the expected fraction $R_{4n}(u,s)$ of newly formed zygotes that are autotetraploid in terms of $u$ and $s$. Express your answer as a single closed-form expression in $u$ and $s$. Do not report a percentage; provide the expression as a fraction in $[0,1]$. No numerical rounding is required.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- Population is large, panmictic, hermaphroditic, and diploid.\n- Zygote formation occurs in a single reproductive season.\n- Each individual produces both male and female gametes.\n- Probability of an unreduced ($2n$) gamete is $u \\in [0,1]$.\n- Probability of a reduced ($n$) gamete is $1-u$.\n- A fraction $s \\in [0,1]$ of zygotes are formed by self-fertilization.\n- A fraction $1-s$ of zygotes are formed by random mating.\n- Gametogenesis events are independent within and across individuals.\n- Zygote ploidy is the sum of parental gamete ploidies.\n- An autotetraploid ($4n$) zygote is formed only by the union of two unreduced ($2n$) gametes.\n- All zygotes considered are viable at formation.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the principles of population genetics and evolutionary biology, specifically the formation of polyploids. It is well-posed, providing all necessary parameters ($u$, $s$) and a clear objective. The language is objective and precise. The assumptions, such as the independence of meiotic failure, are explicitly stated, making the problem self-contained and consistent. The model is a simplification of a real biological process but does not violate fundamental principles or contain factual unsoundness. It is a formalizable problem requiring the application of basic probability theory.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A solution will be derived.\n\nThe objective is to determine the expected fraction of newly formed zygotes that are autotetraploid, which we denote as $R_{4n}(u,s)$. The problem states that an autotetraploid ($4n$) zygote is formed only by the fusion of two unreduced ($2n$) gametes. The probability for any single gamete to be unreduced is given as $u$.\n\nWe can approach this using the law of total probability. The formation of a zygote can be partitioned into two mutually exclusive events:\n1.  Self-fertilization (event $S$), which occurs with probability $P(S) = s$.\n2.  Outcrossing or random mating (event $O$), which occurs with probability $P(O) = 1-s$.\n\nLet $Z_{4n}$ be the event that a zygote is autotetraploid. The total probability of this event is the sum of its probabilities conditioned on the mode of fertilization, weighted by the probabilities of those modes:\n$$\nR_{4n}(u,s) = P(Z_{4n}) = P(Z_{4n} | S) P(S) + P(Z_{4n} | O) P(O)\n$$\nWe must now determine the conditional probabilities $P(Z_{4n} | S)$ and $P(Z_{4n} | O)$.\n\nCase 1: Self-fertilization (conditioned on event $S$)\nIn this case, a single parent individual provides both the male and female gametes. A $4n$ zygote results if and only if both of these gametes are unreduced ($2n$). Let $M_{2n}$ be the event that the male gamete is unreduced, and $F_{2n}$ be the event that the female gamete is unreduced. The probability of each event is $P(M_{2n}) = u$ and $P(F_{2n}) = u$.\nThe problem explicitly states that \"male and female meioses are independent even within the same parent\". Therefore, the probability that both gametes from a single self-fertilizing parent are unreduced is the product of their individual probabilities:\n$$\nP(Z_{4n} | S) = P(M_{2n} \\cap F_{2n} | S) = P(M_{2n} | S) \\cdot P(F_{2n} | S) = u \\cdot u = u^{2}\n$$\n\nCase 2: Outcrossing (conditioned on event $O$)\nIn this case, the zygote is formed from gametes produced by two different individuals, chosen randomly from the population. One individual provides the male gamete, and another provides the female gamete. Again, for a $4n$ zygote to form, both gametes must be unreduced ($2n$).\nThe problem states that gametogenesis events are independent \"across individuals\". The probability that a gamete from any randomly chosen individual is unreduced is $u$. Thus, the probability that the male gamete from one parent is unreduced is $u$, and the probability that the female gamete from the other parent is unreduced is also $u$. Due to their independence, the joint probability is:\n$$\nP(Z_{4n} | O) = P(M_{2n} \\cap F_{2n} | O) = P(M_{2n} | O) \\cdot P(F_{2n} | O) = u \\cdot u = u^{2}\n$$\n\nNow, we substitute these conditional probabilities back into the formula for total probability:\n$$\nR_{4n}(u,s) = P(Z_{4n} | S) \\cdot s + P(Z_{4n} | O) \\cdot (1-s)\n$$\n$$\nR_{4n}(u,s) = u^{2} \\cdot s + u^{2} \\cdot (1-s)\n$$\nFactoring out the term $u^{2}$:\n$$\nR_{4n}(u,s) = u^{2} (s + (1-s))\n$$\n$$\nR_{4n}(u,s) = u^{2} (1)\n$$\n$$\nR_{4n}(u,s) = u^{2}\n$$\nThe result shows that, under the strict independence assumption provided in the problem, the fraction of newly formed autotetraploid zygotes is independent of the selfing rate $s$. The probability of forming a $4n$ zygote is simply the probability of two independent meiotic failure events occurring, one for each gamete contributing to the zygote, regardless of whether the gametes originate from one or two parents.", "answer": "$$\n\\boxed{u^{2}}\n$$", "id": "2744643"}, {"introduction": "Once a new polyploid cytotype establishes, its evolutionary trajectory and the strength of the reproductive barrier it forms depend critically on its interactions with the ancestral diploid population. This practice explores the 'triploid bridge,' the primary conduit for gene flow between diploids and tetraploids [@problem_id:2744681]. By modeling the formation of intermediate triploids and their subsequent backcrosses, you will quantify the potential for genetic exchange across ploidy levels, a key factor determining whether polyploidy leads to complete speciation.", "problem": "Consider an autopolyploid plant with two resident cytotypes, diploids with ploidy $2x$ and tetraploids with ploidy $4x$, co-occurring in a large, panmictic, hermaphroditic population. Let the adult cytotype frequencies be $f_{2}$ for $2x$ and $f_{4}$ for $4x$, with $f_{2}+f_{4}=1$. Assume the following foundational facts and simplifying assumptions, all of which are well-supported for many autopolyploid systems:\n\n- Under random mating (random union of gametes), the expected fraction of heterotypic pairings between $2x$ and $4x$ cytotypes is $2 f_{2} f_{4}$; homotypic pairings occur with fractions $f_{2}^{2}$ and $f_{4}^{2}$, respectively.\n- Diploids ($2x$) produce haploid ($x$) gametes; tetraploids ($4x$) produce diploid ($2x$) gametes; no unreduced gamete production occurs in $2x$ or $4x$.\n- Heterotypic matings $2x \\times 4x$ produce triploid ($3x$) zygotes that survive to reproduction; homotypic matings produce $2x$ or $4x$ zygotes, respectively.\n- Triploid meiosis is polysomic and unbiased with respect to homolog assortment. Conditional on producing any viable gamete, a triploid produces euploid $x$ and $2x$ gametes with equal probabilities $1/2$ each; aneuploid gametes are inviable and ignored.\n- Define the triploid fertility parameter $\\phi \\in [0,1]$ as the per-mating probability that a mating involving a triploid parent and a $2x$ or $4x$ partner yields any viable euploid zygote (counting both euploid outcomes that can result from such a mating). Thus, conditional on such a successful mating, the probability that the offspring is in the partner’s cytotype (a $2x$ for a $3x \\times 2x$ mating, or a $4x$ for a $3x \\times 4x$ mating) is $1/2$.\n\nWithin this framework:\n\n1) Derive the expected fraction of zygotes that are triploid in the current generation under random mating, $R_{3}$, as a function of $f_{2}$ and $f_{4}$.\n\n2) Using only the assumptions above and the parameter $\\phi$, derive the per-generation contributions of the triploid bridge to cross-ploidy gene flow, defined as the fractions of all zygotes in the next generation that enter the $4x$ class via a $3x$ backcross to a $4x$ parent (denote this $m_{2\\to 4}$) and that enter the $2x$ class via a $3x$ backcross to a $2x$ parent (denote this $m_{4\\to 2}$). Assume that cytotype frequencies are approximately constant across the two consecutive generations considered (so that partners encountered by triploids in the next generation are distributed in proportion to $f_{2}$ and $f_{4}$), and that each mating produces at most one zygote.\n\nExpress your final answer in terms of $f_{2}$, $f_{4}$, and $\\phi$. Provide the final expressions as a single row matrix in the order $R_{3}$, $m_{2\\to 4}$, $m_{4\\to 2}$. No numerical approximation is required.", "solution": "The problem asks for the derivation of three quantities related to the population genetics of co-occurring diploid and tetraploid cytotypes: the initial rate of triploid formation, and the rates of gene flow between ploidy levels mediated by the resulting triploids.\n\nThe validation of the problem statement has been performed. The problem is scientifically grounded in the theory of polyploid evolution, is well-posed with sufficient and consistent information, and is stated in objective, formal language. The simplifying assumptions are standard in this field of theoretical biology for deriving analytical insights. The problem is deemed valid.\n\nHere is the detailed derivation.\n\n**Part 1: Expected fraction of triploid zygotes ($R_{3}$)**\n\nThe initial population consists of diploid ($2x$) and tetraploid ($4x$) individuals with frequencies $f_{2}$ and $f_{4}$, respectively, such that $f_{2} + f_{4} = 1$. Mating occurs via random union of gametes.\n\nTriploid ($3x$) zygotes are formed exclusively from heterotypic matings between diploid and tetraploid individuals.\nA diploid individual ($2x$) produces haploid ($x$) gametes.\nA tetraploid individual ($4x$) produces diploid ($2x$) gametes.\nThe fusion of an $x$ gamete and a $2x$ gamete results in a $3x$ zygote.\n\nThe problem states that the expected fraction of heterotypic pairings ($2x \\times 4x$) in the population is given by $2 f_{2} f_{4}$. It is also stated that these matings produce triploid zygotes. Assuming the fertility of these matings is the baseline (normalized to $1$), the fraction of zygotes in the new generation that are triploid is equal to the fraction of matings that produce them.\n\nTherefore, the expected fraction of zygotes that are triploid, denoted $R_{3}$, is:\n$$R_{3} = 2 f_{2} f_{4}$$\n\n**Part 2: Contribution of the triploid bridge to gene flow ($m_{2\\to 4}$ and $m_{4\\to 2}$)**\n\nWe are asked to derive the fractions of all zygotes in the next generation that constitute gene flow between the ploidy levels via the \"triploid bridge\". This process occurs in two steps:\n1.  Formation of triploids from $2x \\times 4x$ matings.\n2.  Backcrossing of these triploids to the parental diploid and tetraploid populations.\n\nThe quantities to be derived are:\n-   $m_{2\\to 4}$: The fraction of zygotes that are tetraploid ($4x$) and originate from a diploid gene pool (via a $3x$ intermediate backcrossing to a $4x$ parent).\n-   $m_{4\\to 2}$: The fraction of zygotes that are diploid ($2x$) and originate from a tetraploid gene pool (via a $3x$ intermediate backcrossing to a $2x$ parent).\n\nThe problem states \"fractions of all zygotes in the next generation\", which implies these quantities should be interpreted as rates relative to the total zygote production of the population. The assumption that \"cytotype frequencies are approximately constant\" allows us to consider the total zygote production of the foundational $2x$ and $4x$ population as a baseline, which can be normalized to $1$. This is because the total fraction of matings is $f_{2}^{2} + 2f_{2}f_{4} + f_{4}^{2} = (f_{2} + f_{4})^{2} = 1^2 = 1$. If each of these matings produces one zygote, the total number of zygotes is also normalized to $1$. The quantities $m_{2\\to 4}$ and $m_{4\\to 2}$ are then the additional fractions produced via the triploid bridge pathway, relative to this baseline.\n\nLet us calculate the flux for each pathway.\n\n**Calculation of $m_{2\\to 4}$:**\nThis pathway represents genes from the $2x$ pool entering the $4x$ pool.\n1.  A triploid must be formed from a $2x \\times 4x$ cross. The rate of production of these triploids relative to the total zygote pool is $R_{3} = 2f_{2}f_{4}$.\n2.  This triploid individual must then mate with a tetraploid ($4x$). The problem assumes random mating into a pool with constant frequencies, so the probability of this mating is $f_{4}$.\n3.  This $3x \\times 4x$ mating must be fertile, producing a viable euploid zygote. The probability of this is the triploid fertility parameter, $\\phi$.\n4.  Given a successful mating, the offspring must be a tetraploid ($4x$). A triploid produces $x$ and $2x$ gametes with equal probability ($1/2$). A tetraploid partner produces $2x$ gametes. The possible euploid zygotes are $x+2x=3x$ and $2x+2x=4x$. These occur with equal probability. Therefore, the conditional probability of producing a $4x$ zygote is $1/2$.\n\nThe total fraction $m_{2\\to 4}$ is the product of the probabilities of these sequential events:\n$$m_{2\\to 4} = (\\text{Rate of } 3x \\text{ formation}) \\times (\\text{Prob. of mating with } 4x) \\times (\\text{Fertility}) \\times (\\text{Prob. of } 4x \\text{ offspring})$$\n$$m_{2\\to 4} = (2f_{2}f_{4}) \\times (f_{4}) \\times (\\phi) \\times \\left(\\frac{1}{2}\\right)$$\n$$m_{2\\to 4} = f_{2}f_{4}^{2}\\phi$$\n\n**Calculation of $m_{4\\to 2}$:**\nThis pathway represents genes from the $4x$ pool entering the $2x$ pool.\n1.  A triploid must be formed from a $2x \\times 4x$ cross. The rate of production is again $R_{3} = 2f_{2}f_{4}$.\n2.  This triploid individual must mate with a diploid ($2x$). Under the same assumption, the probability of this mating is $f_{2}$.\n3.  This $3x \\times 2x$ mating must be fertile, with probability $\\phi$.\n4.  Given a successful mating, the offspring must be a diploid ($2x$). A triploid produces $x$ and $2x$ gametes (probability $1/2$ each). A diploid partner produces $x$ gametes. The possible euploid zygotes are $x+x=2x$ and $2x+x=3x$. These occur with equal probability. The conditional probability of producing a $2x$ zygote is $1/2$.\n\nThe total fraction $m_{4\\to 2}$ is the product of these probabilities:\n$$m_{4\\to 2} = (\\text{Rate of } 3x \\text{ formation}) \\times (\\text{Prob. of mating with } 2x) \\times (\\text{Fertility}) \\times (\\text{Prob. of } 2x \\text{ offspring})$$\n$$m_{4\\to 2} = (2f_{2}f_{4}) \\times (f_{2}) \\times (\\phi) \\times \\left(\\frac{1}{2}\\right)$$\n$$m_{4\\to 2} = f_{2}^{2}f_{4}\\phi$$\n\nThe final expressions for the three requested quantities are:\n-   $R_{3} = 2f_{2}f_{4}$\n-   $m_{2\\to 4} = f_{2}f_{4}^{2}\\phi$\n-   $m_{4\\to 2} = f_{2}^{2}f_{4}\\phi$\n\nThese are to be presented as a single row matrix.", "answer": "$$ \\boxed{ \\begin{pmatrix} 2f_{2}f_{4} & f_{2}f_{4}^{2}\\phi & f_{2}^{2}f_{4}\\phi \\end{pmatrix} } $$", "id": "2744681"}, {"introduction": "The principles of polyploid evolution provide a powerful theoretical lens, but the ultimate test lies in identifying these events from empirical data. This final hands-on practice moves from abstract models to concrete data analysis, tasking you with designing a computational pipeline to infer speciation mechanisms [@problem_id:2744638]. You will learn to formalize biological intuition—linking integer-multiple chromosome counts with patterns of reproductive isolation—into a rigorous algorithm, developing the critical skill of distinguishing true polyploid speciation from alternative scenarios like aneuploidy or other chromosomal rearrangements.", "problem": "You are given several independent test cases. In each test case, there is a set of populations indexed by $i \\in \\{1,\\dots,N\\}$. For each population $i$ you are given an integer chromosome count $c_i \\in \\mathbb{N}$ and a symmetric matrix of pairwise crossing fertility $F \\in [0,1]^{N \\times N}$ where $F_{ij}$ quantifies the relative fertility of crosses between populations $i$ and $j$ on a unitless scale from $0$ to $1$ (with $1$ indicating full fertility equal to within-population crosses). The goal is to implement a mathematically rigorous decision pipeline to infer whether the data are most consistent with a polyploid speciation event and to exclude explanations based on aneuploidy or chromosomal polymorphism.\n\nFundamental biological bases to be used:\n- Whole-genome duplication implies that chromosome counts across diverged cytotypes scale by integer ploidy factors. Mathematically, there exists a base count $g \\in \\mathbb{N}$ and integer multipliers $m_i \\in \\mathbb{N}$ such that $c_i \\approx m_i g$ for each $i$.\n- Crossing fertility between different ploidy levels is typically highly reduced, while crosses within the same ploidy level are often fertile. Therefore, fertility is expected to be high within groups that share the same inferred multiplier $m_i$ and low between groups with distinct $m_i$.\n- Aneuploidy implies small deviations (for example, $\\pm 1$) from otherwise similar counts without the integer multiple structure across groups, often not accompanied by a strong, discrete fertility separation by chromosome count.\n- Chromosomal polymorphism (for example, structural rearrangements) can reduce fertility despite identical or nearly identical chromosome counts and can create a pattern of high fertility within clades and low fertility between clades, even when all $c_i$ are equal (or nearly equal).\n\nDesign and implement a program that, for each test case, applies the following logic formulated purely in mathematical terms:\n\n- Ploidy-model fit by integer-lattice approximation:\n  - For candidate base counts $g \\in \\{2,3,\\dots,\\min_i c_i\\}$, define integer multipliers by $m_i(g) = \\max\\{1, \\operatorname{round}(c_i / g)\\}$ and residuals $r_i(g) = |c_i - m_i(g)\\,g|$ for all $i$.\n  - Let the mean absolute residual be $\\bar r(g) = \\frac{1}{N} \\sum_{i=1}^N r_i(g)$.\n  - Define the best-fitting base count $g^\\star$ as a minimizer of $\\bar r(g)$ over the candidate set.\n  - Accept the ploidy-model fit if $\\bar r(g^\\star) \\le \\delta$ and the inferred multipliers $\\{m_i(g^\\star)\\}$ produce at least two distinct groups.\n\n- Fertility separation test given the inferred multipliers:\n  - Using the partition induced by $m_i(g^\\star)$, define the within-group fertility mean $\\mu_{\\mathrm{within}}$ as the average of $F_{ij}$ over all unordered pairs $(i,j)$ with $i < j$ such that $m_i(g^\\star) = m_j(g^\\star)$, and the between-group fertility mean $\\mu_{\\mathrm{between}}$ as the average of $F_{ij}$ over all unordered pairs $(i,j)$ with $i < j$ such that $m_i(g^\\star) \\ne m_j(g^\\star)$.\n  - Accept fertility separation if there is at least one within-group pair and at least one between-group pair and $\\mu_{\\mathrm{within}} \\ge \\theta_w$ and $\\mu_{\\mathrm{between}} \\le \\theta_b$.\n\n- Chromosomal polymorphism alternative:\n  - If the ploidy-model acceptance fails or the fertility separation test fails, check if the chromosome counts are nearly identical: $\\max_i c_i - \\min_i c_i \\le 1$.\n  - If nearly identical, determine whether there exists a bipartition of the populations into two nonempty groups that yields a within-versus-between fertility separation with the same thresholds as above. Formally, over all nontrivial bipartitions of $\\{1,\\dots,N\\}$ into $A$ and $B$ with $A \\ne \\emptyset$, $B \\ne \\emptyset$, $A \\cup B = \\{1,\\dots,N\\}$, $A \\cap B = \\emptyset$, compute the mean fertility over all unordered pairs within $A$ or within $B$ (the pooled within-group mean) and the mean fertility over all unordered pairs with one index in $A$ and the other in $B$. If there exists at least one bipartition such that the pooled within-group mean is at least $\\theta_w$ and the between-group mean is at most $\\theta_b$, accept the chromosomal polymorphism explanation.\n\n- Final classification per test case:\n  - Output $2$ if both the ploidy-model fit is accepted and the fertility separation test (based on multipliers) is accepted.\n  - Otherwise, output $1$ if the chromosomal polymorphism alternative is accepted.\n  - Otherwise, output $0$ (consistent with aneuploid or other non-polyploid explanations).\n\nUse the following fixed thresholds for all test cases:\n- Absolute residual tolerance $\\delta = 1.0$.\n- Within-group fertility threshold $\\theta_w = 0.7$.\n- Between-group fertility threshold $\\theta_b = 0.2$.\n\nYour program must solve the following four test cases and aggregate their classification results:\n\n- Test case $1$:\n  - Chromosome counts $c = [\\,14,\\,14,\\,28,\\,28,\\,42,\\,42\\,]$.\n  - Fertility matrix $F$ defined by $F_{ii} = 1$ for all $i$, $F_{ij} = 0.92$ for pairs within the first group of two populations with $c = 14$, $F_{ij} = 0.93$ for pairs within the two populations with $c = 28$, $F_{ij} = 0.91$ for pairs within the two populations with $c = 42$, and $F_{ij} = 0.08$ for all pairs $(i,j)$ with $i \\ne j$ belonging to different count groups.\n\n- Test case $2$:\n  - Chromosome counts $c = [\\,14,\\,15,\\,16,\\,15\\,]$.\n  - Fertility matrix $F$ defined by $F_{ii} = 1$ for all $i$ and $F_{ij} = 0.5$ for all $i \\ne j$.\n\n- Test case $3$:\n  - Chromosome counts $c = [\\,14,\\,14,\\,14,\\,14,\\,14,\\,14\\,]$.\n  - Fertility matrix $F$ defined by two clades of three populations each: for the first three indices and for the last three indices, $F_{ij} = 0.9$ when $i \\ne j$ are within the same clade, $F_{ij} = 0.1$ for pairs across clades, and $F_{ii} = 1$.\n\n- Test case $4$:\n  - Chromosome counts $c = [\\,24,\\,24,\\,48,\\,48,\\,49\\,]$.\n  - Fertility matrix $F$ defined by $F_{ii} = 1$ for all $i$, $F_{ij} = 0.93$ for the pair of the two populations with $c = 24$, $F_{ij} = 0.92$ for the pair of the two populations with $c = 48$, $F_{ij} = 0.72$ for pairs between the population with $c = 49$ and each of the two populations with $c = 48$, and $F_{ij} = 0.08$ for all pairs between the $24$-count group and the $48$- or $49$-count group.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases, for example $[2,0,1,2]$. The output values must be integers.\n\nNo physical units are involved. Angles are not involved. Percentages must not be used; all fertility quantities are unitless decimals in $[0,1]$.", "solution": "The problem requires the implementation of a classification algorithm to determine if a set of populations, characterized by chromosome counts and inter-population fertility, is most consistent with polyploid speciation, chromosomal polymorphism, or another evolutionary mechanism. The decision logic is provided as a multi-step pipeline with fixed numerical thresholds. The analysis proceeds as follows.\n\nFirst, the validity of the problem statement is confirmed. All givens, including population data ($c_i, F_{ij}$), biological premises, algorithmic steps, and numerical thresholds ($\\delta, \\theta_w, \\theta_b$), are provided in an explicit, self-contained, and scientifically sound manner. The problem is well-posed, objective, and its formalization is directly relevant to quantitative evolutionary biology. No contradictions or fatal ambiguities are present. The instruction to use \"a minimizer\" for the base count $g^\\star$ introduces a minor ambiguity if multiple minimizers exist. A deterministic tie-breaking rule must be established. A plausible choice, adopted here, is to select the largest candidate base count $g$ that minimizes the mean residual, reflecting a search for the most fundamental genomic unit. The problem is thus deemed valid.\n\nThe solution is constructed by translating the prescribed decision pipeline into a computational algorithm. Let $N$ be the number of populations. The chromosome counts are given by a vector $c = (c_1, \\dots, c_N)$ and the fertility matrix by $F \\in [0,1]^{N \\times N}$.\n\n**Step 1: Ploidy-Model Fit**\nThis step evaluates the hypothesis that the chromosome counts $c_i$ represent integer multiples of a base count $g$.\nThe model fit is quantified by the mean absolute residual $\\bar{r}(g)$. For each candidate base count $g$ in the integer range $\\{2, 3, \\dots, \\min_i c_i\\}$, we compute:\n1.  Integer multipliers $m_i(g) = \\max\\{1, \\operatorname{round}(c_i / g)\\}$. The $\\operatorname{round}$ function maps a real number to the nearest integer, with halves rounded to the nearest even integer. The $\\max\\{1, \\dots\\}$ ensures multipliers are at least $1$.\n2.  Residuals $r_i(g) = |c_i - m_i(g) \\cdot g|$.\n3.  The mean absolute residual $\\bar{r}(g) = \\frac{1}{N} \\sum_{i=1}^N r_i(g)$.\n\nThe optimal base count, $g^\\star$, is defined as a minimizer of $\\bar{r}(g)$. Should multiple values of $g$ yield the same minimal $\\bar{r}(g)$, we select the largest among them as $g^\\star$.\n\nThe ploidy model is accepted if two conditions are met:\n1.  The minimal mean residual does not exceed a tolerance $\\delta$: $\\bar{r}(g^\\star) \\le \\delta$. For this problem, $\\delta=1.0$.\n2.  The set of inferred multipliers, $\\{m_i(g^\\star)\\}_{i=1}^N$, contains at least two distinct values, implying a ploidy difference among populations.\n\n**Step 2: Fertility Separation Test**\nIf the ploidy model is accepted, we test if the inferred ploidy groups correspond to reproductive isolation, as indicated by the fertility matrix $F$.\nUsing the population partition induced by the multipliers $m_i(g^\\star)$, we calculate two metrics:\n1.  The mean within-group fertility, $\\mu_{\\mathrm{within}}$: the average of $F_{ij}$ over all unordered pairs $(i,j)$ with $i<j$ where populations $i$ and $j$ have the same multiplier ($m_i(g^\\star) = m_j(g^\\star)$).\n2.  The mean between-group fertility, $\\mu_{\\mathrm{between}}$: the average of $F_{ij}$ over all unordered pairs $(i,j)$ with $i<j$ where populations $i$ and $j$ have different multipliers ($m_i(g^\\star) \\ne m_j(g^\\star)$).\n\nThe fertility separation test is passed if there is at least one pair of populations for the within-group calculation and at least one for the between-group calculation, and the means satisfy the following conditions: $\\mu_{\\mathrm{within}} \\ge \\theta_w$ and $\\mu_{\\mathrm{between}} \\le \\theta_b$. For this problem, the thresholds are $\\theta_w=0.7$ and $\\theta_b=0.2$.\n\nIf both the ploidy-model fit and the fertility separation test are accepted, the case is classified as polyploid speciation (output $2$).\n\n**Step 3: Chromosomal Polymorphism Alternative**\nIf the criteria for polyploid speciation are not fully met (i.e., the ploidy model fit or the fertility test failed), we evaluate an alternative hypothesis: chromosomal polymorphism causing reproductive isolation without significant changes in chromosome number.\nThis check is performed only if the chromosome counts are nearly identical across all populations, defined by the condition $\\max_i c_i - \\min_i c_i \\le 1$.\n\nIf this condition holds, we search for evidence of reproductive isolation by searching through all possible non-trivial bipartitions of the set of populations into two non-empty groups, $A$ and $B$. For each bipartition $\\{A, B\\}$, we compute:\n1.  The pooled within-group fertility: the average of $F_{ij}$ over all pairs $(i,j)$ with $i,j$ both in $A$ or both in $B$ ($i<j$).\n2.  The between-group fertility: the average of $F_{ij}$ over all pairs $(i,j)$ with $i \\in A$ and $j \\in B$.\n\nIf there exists at least one bipartition for which the pooled within-group mean is at least $\\theta_w=0.7$ and the between-group mean is at most $\\theta_b=0.2$, the chromosomal polymorphism explanation is accepted. The classification is then chromosomal polymorphism (output $1$). The search over partitions can be done exhaustively, as the number of populations $N$ is small.\n\n**Step 4: Final Classification**\nThe final output for each test case is determined by the sequential application of the rules:\n- If the ploidy model and subsequent fertility test are both passed, the result is $2$.\n- Otherwise, if the chromosomal polymorphism alternative is accepted, the result is $1$.\n- Otherwise, the result is $0$, indicating the data is most consistent with other phenomena like aneuploidy or that the provided models do not fit well.\n\nThis comprehensive, step-by-step procedure provides a rigorous and objective classification for each test case based on the provided data and principles.", "answer": "```python\nimport numpy as np\nimport itertools\n\ndef classify_speciation(c_list, F):\n    \"\"\"\n    Classifies speciation mechanism based on chromosome counts and fertility matrix.\n    \n    Returns:\n        2: Polyploid speciation\n        1: Chromosomal polymorphism\n        0: Other (e.g., aneuploidy)\n    \"\"\"\n    c = np.array(c_list)\n    N = len(c)\n    delta = 1.0\n    theta_w = 0.7\n    theta_b = 0.2\n\n    # Step 1: Ploidy-model fit\n    min_r_bar = float('inf')\n    \n    # Candidate base counts g must be at least 2.\n    # If minimum chromosome count is less than 2, this test cannot be performed.\n    min_c = np.min(c)\n    if min_c < 2:\n        g_star = -1\n    else:\n        g_candidates = range(2, min_c + 1)\n        g_minimizers = []\n        for g in g_candidates:\n            # Using np.round which rounds to nearest even for .5 cases\n            m = np.maximum(1, np.round(c / g)).astype(int)\n            r = np.abs(c - m * g)\n            r_bar = np.mean(r)\n            \n            if abs(r_bar - min_r_bar) < 1e-9: # Comparing floats\n                g_minimizers.append(g)\n            elif r_bar < min_r_bar:\n                min_r_bar = r_bar\n                g_minimizers = [g]\n\n        g_star = max(g_minimizers) if g_minimizers else -1\n\n    ploidy_model_accepted = False\n    if g_star != -1:\n        m_star = np.maximum(1, np.round(c / g_star)).astype(int)\n        unique_multipliers = np.unique(m_star)\n        if min_r_bar <= delta and len(unique_multipliers) > 1:\n            ploidy_model_accepted = True\n\n    # Step 2: Fertility separation test\n    fertility_separation_accepted = False\n    if ploidy_model_accepted:\n        m_star = np.maximum(1, np.round(c / g_star)).astype(int)\n        \n        within_fertilities = []\n        between_fertilities = []\n\n        for i in range(N):\n            for j in range(i + 1, N):\n                if m_star[i] == m_star[j]:\n                    within_fertilities.append(F[i, j])\n                else:\n                    between_fertilities.append(F[i, j])\n        \n        if within_fertilities and between_fertilities:\n            mu_within = np.mean(within_fertilities)\n            mu_between = np.mean(between_fertilities)\n            \n            if mu_within >= theta_w and mu_between <= theta_b:\n                fertility_separation_accepted = True\n\n    # Final Classification Rule 1\n    if ploidy_model_accepted and fertility_separation_accepted:\n        return 2\n\n    # Step 3: Chromosomal polymorphism alternative\n    chromo_poly_accepted = False\n    if np.max(c) - np.min(c) <= 1:\n        # Generate all non-trivial bipartitions. To avoid duplicates, fix one element (e.g., 0)\n        # in the first set and generate all non-empty, non-full subsets of the rest.\n        other_elements = list(range(1, N))\n        for k in range(len(other_elements) + 1):\n            for subset in itertools.combinations(other_elements, k):\n                set_A_indices = set([0] + list(subset))\n                \n                # Bipartition must be non-trivial\n                if len(set_A_indices) == N:\n                    continue\n\n                set_B_indices = set(range(N)) - set_A_indices\n                \n                within_fertilities_pooled = []\n                # Pairs within A\n                if len(set_A_indices) > 1:\n                    for i, j in itertools.combinations(set_A_indices, 2):\n                        within_fertilities_pooled.append(F[i, j])\n                # Pairs within B\n                if len(set_B_indices) > 1:\n                    for i, j in itertools.combinations(set_B_indices, 2):\n                        within_fertilities_pooled.append(F[i, j])\n                \n                between_fertilities_pooled = []\n                for i in set_A_indices:\n                    for j in set_B_indices:\n                        between_fertilities_pooled.append(F[i, j])\n\n                if not within_fertilities_pooled or not between_fertilities_pooled:\n                    continue\n\n                mu_within_pooled = np.mean(within_fertilities_pooled)\n                mu_between_pooled = np.mean(between_fertilities_pooled)\n                \n                if mu_within_pooled >= theta_w and mu_between_pooled <= theta_b:\n                    chromo_poly_accepted = True\n                    break\n            if chromo_poly_accepted:\n                break\n    \n    # Final Classification Rule 2 & 3\n    if chromo_poly_accepted:\n        return 1\n    \n    return 0\n\ndef solve():\n    # Define the test cases\n    test_cases = [\n        # Test case 1\n        {\n            \"c\": [14, 14, 28, 28, 42, 42],\n            \"F\": np.array([\n                [1.00, 0.92, 0.08, 0.08, 0.08, 0.08],\n                [0.92, 1.00, 0.08, 0.08, 0.08, 0.08],\n                [0.08, 0.08, 1.00, 0.93, 0.08, 0.08],\n                [0.08, 0.08, 0.93, 1.00, 0.08, 0.08],\n                [0.08, 0.08, 0.08, 0.08, 1.00, 0.91],\n                [0.08, 0.08, 0.08, 0.08, 0.91, 1.00]\n            ])\n        },\n        # Test case 2\n        {\n            \"c\": [14, 15, 16, 15],\n            \"F\": np.array([\n                [1.0, 0.5, 0.5, 0.5],\n                [0.5, 1.0, 0.5, 0.5],\n                [0.5, 0.5, 1.0, 0.5],\n                [0.5, 0.5, 0.5, 1.0]\n            ])\n        },\n        # Test case 3\n        {\n            \"c\": [14, 14, 14, 14, 14, 14],\n            \"F\": np.array([\n                [1.0, 0.9, 0.9, 0.1, 0.1, 0.1],\n                [0.9, 1.0, 0.9, 0.1, 0.1, 0.1],\n                [0.9, 0.9, 1.0, 0.1, 0.1, 0.1],\n                [0.1, 0.1, 0.1, 1.0, 0.9, 0.9],\n                [0.1, 0.1, 0.1, 0.9, 1.0, 0.9],\n                [0.1, 0.1, 0.1, 0.9, 0.9, 1.0]\n            ])\n        },\n        # Test case 4\n        {\n            \"c\": [24, 24, 48, 48, 49],\n            \"F\": np.array([\n                [1.00, 0.93, 0.08, 0.08, 0.08],\n                [0.93, 1.00, 0.08, 0.08, 0.08],\n                [0.08, 0.08, 1.00, 0.92, 0.72],\n                [0.08, 0.08, 0.92, 1.00, 0.72],\n                [0.08, 0.08, 0.72, 0.72, 1.00]\n            ])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = classify_speciation(case[\"c\"], case[\"F\"])\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2744638"}]}