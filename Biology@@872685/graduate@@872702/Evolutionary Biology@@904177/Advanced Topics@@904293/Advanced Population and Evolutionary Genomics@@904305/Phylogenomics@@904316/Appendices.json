{"hands_on_practices": [{"introduction": "A central challenge in phylogenomics is that the evolutionary history of a single gene does not always mirror the history of the species that carry it. This exercise [@problem_id:2307587] presents a classic case of gene-tree/species-tree incongruence, tasking you with identifying the most parsimonious evolutionary process at play. Developing the intuition to distinguish between mechanisms like horizontal gene transfer and incomplete lineage sorting is fundamental to accurately interpreting genomic data and uncovering the complex paths of evolution.", "problem": "A molecular biologist is investigating the evolutionary origins of a newly discovered antibiotic resistance gene, `resX`, found in a diverse set of bacterial species. To do this, she first constructs a species phylogeny (a \"species tree\") using the nucleotide sequence of the 16S ribosomal RNA (rRNA) gene, which is a standard and reliable marker for bacterial evolutionary relationships. This tree shows that species from the phylum Proteobacteria (e.g., *Escherichia coli*) are very distantly related to species from the phylum Firmicutes (e.g., *Staphylococcus aureus*), having diverged more than a billion years ago.\n\nNext, she constructs a separate phylogeny (a \"gene tree\") using only the nucleotide sequence of the `resX` gene from the same set of bacteria. She observes a striking conflict: the `resX` gene sequence from her *E. coli* sample is nearly identical to the `resX` sequence from *S. aureus*, making them sister taxa in the gene tree. This finding is highly incongruent with the species tree, where *E. coli* and *S. aureus* are positioned on very distant branches.\n\nWhich of the following evolutionary mechanisms provides the most parsimonious explanation for this observed discrepancy between the gene tree and the species tree?\n\nA. Horizontal Gene Transfer (HGT)\n\nB. Incomplete Lineage Sorting (ILS)\n\nC. Convergent Evolution\n\nD. Sympatric Speciation\n\nE. Genetic Drift", "solution": "We compare the topology of the species tree (based on 16S rRNA, a conserved and reliable marker of vertical descent) with the gene tree for the antibiotic resistance gene resX. The key observation is that resX sequences from very distantly related bacteria, exemplified by Escherichia coli (Proteobacteria) and Staphylococcus aureus (Firmicutes), are nearly identical and form sister taxa in the gene tree despite their species having diverged more than a billion years ago.\n\nTo identify the most parsimonious mechanism:\n1) Horizontal Gene Transfer (HGT): Antibiotic resistance genes are well known to move between distantly related bacteria via plasmids, transposons, integrons, and phages. A recent transfer event would yield near-identity of resX across distant taxa and naturally decouple the gene tree from the species tree. This directly explains the strong incongruence and near-identical sequences.\n2) Incomplete Lineage Sorting (ILS): ILS requires ancestral polymorphism persisting through speciation events, with alternative alleles sorting into descendant lineages. Over the deep timescale separating Proteobacteria and Firmicutes, ancestral polymorphisms would not persist, and even if they did, neutral divergence would make near-identical sequences across entire genes exceedingly unlikely. Thus ILS is not parsimonious here.\n3) Convergent Evolution: Convergence at the nucleotide sequence level across an entire gene producing near identity is extraordinarily improbable, especially for synonymous sites; selection typically acts on amino acid function, not exact nucleotide sequences.\n4) Sympatric Speciation: This is a mode of speciation, not a mechanism producing gene-tree/species-tree discordance across phyla.\n5) Genetic Drift: Drift causes random changes within lineages and cannot produce near-identical sequences across independently evolving, deeply divergent lineages; it instead increases divergence over time.\n\nTherefore, the most parsimonious and well-supported explanation for the observed gene-tree/species-tree conflict and near-identity of resX between distant taxa is Horizontal Gene Transfer.", "answer": "$$\\boxed{A}$$", "id": "2307587"}, {"introduction": "Many phylogenomic analyses, especially those aimed at dating evolutionary events, rely on the molecular clock hypothesis, which assumes a relatively constant rate of evolution. This assumption has a direct mathematical consequence: the resulting matrix of evolutionary distances should be 'ultrametric'. This exercise [@problem_id:2743629] provides hands-on practice in testing this core assumption by applying the three-point condition to a hypothetical distance matrix, allowing you to quantify the deviation from clock-like behavior and make a statistically-informed decision about its plausibility.", "problem": "A genomics consortium assembled whole-genome alignments of five single-copy orthologs from five taxa, labeled $\\{A,B,C,D,E\\}$. From the alignments, they estimated pairwise evolutionary path distances under a time-reversible substitution model, reporting distances in substitutions per site. For a strictly clock-like (ultrametric) divergence process, the three-point condition states that, for any triple of taxa $\\{i,j,k\\}$, among the three pairwise distances $\\{d_{ij},d_{ik},d_{jk}\\}$, the two largest values are equal in the noise-free limit. To operationalize a test of ultrametricity that is agnostic to tree topology, define the ultrametric deviation index\n$$\nU \\equiv \\max_{\\{i,j,k\\}} \\left(\\max\\{d_{ij},d_{ik},d_{jk}\\} - \\text{second\\_largest}\\{d_{ij},d_{ik},d_{jk}\\}\\right),\n$$\nwhich is zero if and only if all triples satisfy the three-point condition exactly. You are given the following symmetric distance matrix $\\mathbf{D}=(d_{ij})$ in the taxon order $(A,B,C,D,E)$, with diagonal entries equal to $0$:\n$$\n\\mathbf{D}=\n\\begin{pmatrix}\n0 & 0.608 & 0.992 & 0.998 & 1.004 \\\\\n0.608 & 0 & 0.996 & 1.006 & 1.002 \\\\\n0.992 & 0.996 & 0 & 0.406 & 0.398 \\\\\n0.998 & 1.006 & 0.406 & 0 & 0.304 \\\\\n1.004 & 1.002 & 0.398 & 0.304 & 0\n\\end{pmatrix}.\n$$\nStarting only from the core definition of ultrametricity via the three-point condition, compute the ultrametric deviation index $U$ for this matrix. Then, based on the commonly used decision rule that a strict molecular clock model is plausible if $U \\leq \\delta$ with $\\delta=0.020$ substitutions per site (reflecting typical genome-scale sampling noise), assess plausibility in your reasoning. Report only the value of $U$, rounded to four significant figures, and express the result in substitutions per site.", "solution": "The problem requires the computation of the ultrametric deviation index, denoted $U$, for a given pairwise distance matrix $\\mathbf{D}$.\n\nThe set of five taxa is labeled $\\{A,B,C,D,E\\}$, which we may index as $\\{1,2,3,4,5\\}$ respectively. The provided symmetric distance matrix is:\n$$\n\\mathbf{D}=\n\\begin{pmatrix}\n0 & 0.608 & 0.992 & 0.998 & 1.004 \\\\\n0.608 & 0 & 0.996 & 1.006 & 1.002 \\\\\n0.992 & 0.996 & 0 & 0.406 & 0.398 \\\\\n0.998 & 1.006 & 0.406 & 0 & 0.304 \\\\\n1.004 & 1.002 & 0.398 & 0.304 & 0\n\\end{pmatrix}.\n$$\nThe ultrametric deviation index $U$ is defined as the maximum deviation from the three-point condition over all possible triples of taxa $\\{i,j,k\\}$:\n$$\nU \\equiv \\max_{\\{i,j,k\\}} \\left(\\max\\{d_{ij},d_{ik},d_{jk}\\} - \\text{second\\_largest}\\{d_{ij},d_{ik},d_{jk}\\}\\right).\n$$\nFor $n=5$ taxa, there are $\\binom{5}{3} = \\frac{5!}{3!2!} = 10$ unique triples to evaluate. Let $\\Delta_{ijk}$ denote the deviation for a given triple $\\{i,j,k\\}$. We must compute $\\Delta_{ijk}$ for all $10$ triples.\n\nThe pairwise distances $d_{ij}$ are:\n$d_{12} = 0.608$, $d_{13} = 0.992$, $d_{14} = 0.998$, $d_{15} = 1.004$\n$d_{23} = 0.996$, $d_{24} = 1.006$, $d_{25} = 1.002$\n$d_{34} = 0.406$, $d_{35} = 0.398$\n$d_{45} = 0.304$\n\nWe now evaluate the deviation for each triple:\n\n$1$. Triple $\\{1,2,3\\}$: Distances are $\\{d_{12}, d_{13}, d_{23}\\} = \\{0.608, 0.992, 0.996\\}$.\nThe two largest are $0.996$ and $0.992$.\n$\\Delta_{123} = 0.996 - 0.992 = 0.004$.\n\n$2$. Triple $\\{1,2,4\\}$: Distances are $\\{d_{12}, d_{14}, d_{24}\\} = \\{0.608, 0.998, 1.006\\}$.\nThe two largest are $1.006$ and $0.998$.\n$\\Delta_{124} = 1.006 - 0.998 = 0.008$.\n\n$3$. Triple $\\{1,2,5\\}$: Distances are $\\{d_{12}, d_{15}, d_{25}\\} = \\{0.608, 1.004, 1.002\\}$.\nThe two largest are $1.004$ and $1.002$.\n$\\Delta_{125} = 1.004 - 1.002 = 0.002$.\n\n$4$. Triple $\\{1,3,4\\}$: Distances are $\\{d_{13}, d_{14}, d_{34}\\} = \\{0.992, 0.998, 0.406\\}$.\nThe two largest are $0.998$ and $0.992$.\n$\\Delta_{134} = 0.998 - 0.992 = 0.006$.\n\n$5$. Triple $\\{1,3,5\\}$: Distances are $\\{d_{13}, d_{15}, d_{35}\\} = \\{0.992, 1.004, 0.398\\}$.\nThe two largest are $1.004$ and $0.992$.\n$\\Delta_{135} = 1.004 - 0.992 = 0.012$.\n\n$6$. Triple $\\{1,4,5\\}$: Distances are $\\{d_{14}, d_{15}, d_{45}\\} = \\{0.998, 1.004, 0.304\\}$.\nThe two largest are $1.004$ and $0.998$.\n$\\Delta_{145} = 1.004 - 0.998 = 0.006$.\n\n$7$. Triple $\\{2,3,4\\}$: Distances are $\\{d_{23}, d_{24}, d_{34}\\} = \\{0.996, 1.006, 0.406\\}$.\nThe two largest are $1.006$ and $0.996$.\n$\\Delta_{234} = 1.006 - 0.996 = 0.010$.\n\n$8$. Triple $\\{2,3,5\\}$: Distances are $\\{d_{23}, d_{25}, d_{35}\\} = \\{0.996, 1.002, 0.398\\}$.\nThe two largest are $1.002$ and $0.996$.\n$\\Delta_{235} = 1.002 - 0.996 = 0.006$.\n\n$9$. Triple $\\{2,4,5\\}$: Distances are $\\{d_{24}, d_{25}, d_{45}\\} = \\{1.006, 1.002, 0.304\\}$.\nThe two largest are $1.006$ and $1.002$.\n$\\Delta_{245} = 1.006 - 1.002 = 0.004$.\n\n$10$. Triple $\\{3,4,5\\}$: Distances are $\\{d_{34}, d_{35}, d_{45}\\} = \\{0.406, 0.398, 0.304\\}$.\nThe two largest are $0.406$ and $0.398$.\n$\\Delta_{345} = 0.406 - 0.398 = 0.008$.\n\nThe set of calculated deviations is $\\{0.004, 0.008, 0.002, 0.006, 0.012, 0.006, 0.010, 0.006, 0.004, 0.008\\}$.\nThe ultrametric deviation index $U$ is the maximum of these values:\n$$\nU = \\max\\{0.004, 0.008, 0.002, 0.006, 0.012, 0.006, 0.010, 0.006, 0.004, 0.008\\} = 0.012.\n$$\nThe value $0.012$ is an exact result of the subtractions. The problem requires rounding to four significant figures. The significant figures in $0.012$ are $1$ and $2$. To express this with four significant figures, we must add trailing zeros, yielding $0.01200$.\n\nFinally, the problem asks to assess plausibility based on the decision rule $U \\leq \\delta$, with the threshold $\\delta = 0.020$ substitutions per site. We have computed $U = 0.012$. Comparing this to the threshold:\n$$\n0.012 \\leq 0.020.\n$$\nSince the computed ultrametric deviation index $U$ is less than or equal to the specified threshold $\\delta$, the hypothesis of a strict molecular clock (ultrametricity) is considered plausible for this dataset under the given decision rule.\nThe final required output is the value of $U$ rounded to four significant figures.", "answer": "$$\\boxed{0.01200}$$", "id": "2743629"}, {"introduction": "Phylogenomics truly shines when it is used to dissect complex evolutionary histories and test specific hypotheses about the drivers of speciation. This advanced problem [@problem_id:2307569] moves beyond simple tree reconstruction to a scenario involving a chromosomal inversion, trans-species polymorphism, and post-speciation gene flow. By carefully applying the molecular clock to divergence data from different genomic regions, you can determine if the inversion predates the speciation event, providing a powerful piece of evidence for its potential role in driving the two species apart.", "problem": "Two closely related insect species, *Divergens volans* and *Divergens quietus*, are studied to understand the genomic basis of their speciation. *D. volans* is known to be polymorphic for a large chromosomal inversion on its third chromosome, with individuals carrying either the standard (S) or the inverted (I) arrangement. In contrast, its sister species, *D. quietus*, is found to be entirely fixed for the inverted (I) arrangement. Genetic analysis of a distant outgroup species, *Divergens primus*, confirms it is fixed for the standard (S) arrangement, establishing S as the ancestral state.\n\nOne leading hypothesis is that this inversion represents a case of trans-species polymorphism, where the inversion arose in the common ancestral population of *D. volans* and *D. quietus*. Under this model, both the S and I arrangements were maintained by balancing selection for a significant period before the speciation event, and were then differentially sorted in the two daughter lineages.\n\nTo test this, you are provided with the following phylogenomic data:\n1.  The average pairwise nucleotide divergence between the standard (S) and inverted (I) haplotypes, sampled from within the *D. volans* population and calculated using loci inside the inversion, is $d_{in} = 0.050$.\n2.  The average pairwise nucleotide divergence between *D. volans* and *D. quietus*, calculated from a large set of autosomal loci located far from the inversion where recombination is frequent, is $d_{out} = 0.031$.\n3.  The fossil-calibrated neutral mutation rate for this genus is $\\mu = 1.25 \\times 10^{-3}$ substitutions per site per million years. You can relate divergence ($d$) to time ($T$) using the molecular clock formula $T = \\frac{d}{2\\mu}$, where the factor of 2 accounts for divergence accumulating on two separate lineages.\n4.  Advanced demographic modeling, which accounts for factors like Incomplete Lineage Sorting (ILS), has revealed that a sustained low level of gene flow occurred between the two species after their initial split. This introgression affected only the freely recombining regions of the genome (i.e., those outside the inversion). The quantifiable impact of this gene flow is that the observed divergence at these unlinked loci ($d_{out}$) yields an apparent speciation time that is 25% shorter than the true, actual speciation time.\n\nBased on this information, calculate the duration, in millions of years, that the S/I polymorphism was maintained in the common ancestral population before the lineages leading to *D. volans* and *D. quietus* split. Express your answer in millions of years, rounded to two significant figures.", "solution": "We are asked for the time interval during which the S/I inversion polymorphism was maintained in the common ancestral population prior to the speciation split. Let $T_{\\text{inv}}$ be the age of the inversion (time since the S and I haplotype classes began diverging) and $T_{\\text{spec}}$ be the true speciation time. The desired duration is\n$$\nT_{\\text{ancestral}}=T_{\\text{inv}}-T_{\\text{spec}}.\n$$\n\nBy the molecular clock, for two lineages diverging neutrally,\n$$\nT=\\frac{d}{2\\mu}.\n$$\nThus, using the divergence inside the inversion between S and I within D. volans,\n$$\nT_{\\text{inv}}=\\frac{d_{\\text{in}}}{2\\mu}.\n$$\n\nFor the speciation time, the freely recombining loci give an apparent time\n$$\nT_{\\text{app}}=\\frac{d_{\\text{out}}}{2\\mu},\n$$\nbut post-split introgression makes this apparent time shorter than the true time by a factor of $1-0.25=0.75$, i.e.,\n$$\nT_{\\text{app}}=0.75\\,T_{\\text{spec}} \\quad \\Rightarrow \\quad T_{\\text{spec}}=\\frac{T_{\\text{app}}}{0.75}.\n$$\n\nPutting this together,\n$$\nT_{\\text{ancestral}}=\\frac{d_{\\text{in}}}{2\\mu}-\\frac{1}{0.75}\\cdot\\frac{d_{\\text{out}}}{2\\mu}.\n$$\n\nNow substitute the given values $d_{\\text{in}}=0.050$, $d_{\\text{out}}=0.031$, and $\\mu=1.25 \\times 10^{-3}$ substitutions per site per million years:\n$$\nT_{\\text{inv}}=\\frac{0.050}{2\\cdot 1.25\\times 10^{-3}}=\\frac{0.050}{2.5\\times 10^{-3}}=20,\n$$\n$$\nT_{\\text{app}}=\\frac{0.031}{2\\cdot 1.25\\times 10^{-3}}=\\frac{0.031}{2.5\\times 10^{-3}}=12.4,\n$$\n$$\nT_{\\text{spec}}=\\frac{12.4}{0.75}=16.533\\overline{3},\n$$\n$$\nT_{\\text{ancestral}}=20-16.533\\overline{3}=3.466\\overline{6}.\n$$\n\nRounded to two significant figures, this is $3.5$ million years.", "answer": "$$\\boxed{3.5}$$", "id": "2307569"}]}