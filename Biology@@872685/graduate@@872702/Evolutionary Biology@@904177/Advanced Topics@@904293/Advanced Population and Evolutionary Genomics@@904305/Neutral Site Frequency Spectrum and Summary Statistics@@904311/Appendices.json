{"hands_on_practices": [{"introduction": "A fundamental task in population genetics is to estimate the population-scaled mutation rate, $\\theta = 4N_e\\mu$, from sequence data. Watterson's estimator, $\\hat{\\theta}_W$, provides a method to do this using the number of segregating sites ($S$) observed in a sample. This exercise guides you through the process of calculating $\\hat{\\theta}_W$ from basic sample information, a cornerstone skill for quantifying genetic variation under the neutral model. [@problem_id:2739378]", "problem": "Consider a panmictic diploid population evolving under the standard neutral coalescent with constant effective population size and the infinite-sites mutation model. Let the scaled mutation rate per site be defined as $\\theta = 4 N_{e} \\mu$, where $N_{e}$ is the effective population size and $\\mu$ is the per-site per-generation mutation rate. You are given a sample of size $n=25$ chromosomes from a single population. Across a contiguous, callable region of length $L=50\\,\\text{kb}$ (assume $L$ is exactly $50{,}000$ independent sites under the infinite-sites model), you observe $S=120$ segregating sites in the sample. Using the neutral site frequency spectrum framework, and starting from the fact that the expected number of segregating sites depends linearly on the mutation rate and a sample-size-dependent harmonic factor arising from the genealogy, derive an unbiased method-of-moments estimator for the scaled mutation rate per site from $S$ and compute its numerical value for these data. Then convert this per-site estimate to a per-kilobase estimate by multiplying by $1000$. Report the two numbers in the order: per site, then per kilobase. Round both reported numbers to four significant figures. Do not include units in your final boxed answer; interpret them as “per site” and “per kb,” respectively.", "solution": "The supplied problem is scientifically grounded, well-posed, and objective. It represents a fundamental application of neutral coalescent theory in population genetics. The problem is therefore valid and a solution will be provided.\n\nThe objective is to derive an unbiased method-of-moments estimator for the scaled mutation rate per site, $\\theta = 4N_{e}\\mu$, and to compute its value given a sample of $n=25$ chromosomes, in which $S=120$ segregating sites are observed over a region of length $L=50000$ sites.\n\nThe derivation begins within the framework of the standard neutral coalescent model for a diploid, panmictic population of constant effective size $N_e$. Time in this model is conventionally measured in units of $2N_e$ generations. For a sample of $n$ haploid sequences (chromosomes), the genealogy is traced backwards in time. The process starts with $n$ distinct lineages. At each step, a pair of lineages merge (coalesce) into a common ancestor. This continues until only one lineage, the most recent common ancestor (MRCA) of the sample, remains.\n\nThe time $T_k$ during which there are $k$ active lineages is an exponentially distributed random variable with rate parameter $\\binom{k}{2}$, as any pair of lineages can coalesce. The expected time spent with $k$ lineages is therefore $E[T_k] = \\frac{1}{\\binom{k}{2}}$. The total length of all branches in the genealogy during this interval is $k \\cdot T_k$. The expected contribution to the total tree length from the interval with $k$ lineages is:\n$$E[k T_k] = k \\cdot E[T_k] = k \\cdot \\frac{1}{\\binom{k}{2}} = k \\cdot \\frac{1}{\\frac{k(k-1)}{2}} = \\frac{2}{k-1}$$\nThese time units are in $2N_e$ generations.\n\nThe total expected length of the genealogy, $E[T_{\\text{total}}]$, is the sum of these expected lengths from $k=n$ down to $k=2$:\n$$E[T_{\\text{total}}] = \\sum_{k=2}^{n} E[k T_k] = \\sum_{k=2}^{n} \\frac{2}{k-1}$$\nBy substituting $i=k-1$, this sum becomes:\n$$E[T_{\\text{total}}] = 2 \\sum_{i=1}^{n-1} \\frac{1}{i} = 2a_{n-1}$$\nwhere $a_{n-1} = \\sum_{i=1}^{n-1} \\frac{1}{i}$ is the $(n-1)$-th harmonic number. This is the total expected genealogical branch length in units of $2N_e$ generations. To convert this to units of generations, we multiply by $2N_e$:\n$$E[T_{\\text{gen}}] = E[T_{\\text{total}}] \\cdot (2N_e) = (2a_{n-1}) \\cdot (2N_e) = 4N_e a_{n-1}$$\n\nUnder the infinite-sites model, each mutation creates a new segregating site. Mutations are assumed to occur as a Poisson process along the branches of the genealogy. The mutation rate per site per generation is $\\mu$. For a region of $L$ sites, the total mutation rate per generation is $\\mu L$. The expected number of segregating sites, $E[S]$, is the product of the total mutation rate per generation and the total expected branch length in generations:\n$$E[S] = (\\mu L) \\cdot E[T_{\\text{gen}}] = (\\mu L) \\cdot (4N_e a_{n-1}) = (4N_e\\mu) L a_{n-1}$$\nUsing the definition of the scaled mutation rate per site, $\\theta = 4N_e\\mu$, we arrive at the fundamental relationship:\n$$E[S] = \\theta L a_{n-1}$$\nThis confirms the premise that the expected number of segregating sites is linear in both the mutation rate ($\\theta$) and the sample-size-dependent harmonic factor ($a_{n-1}$).\n\nThe method of moments consists of equating the observed statistic to its theoretical expectation to derive an estimator for the parameter of interest. We set the observed number of segregating sites $S$ equal to its expectation:\n$$S = \\widehat{E[S]} = \\hat{\\theta} L a_{n-1}$$\nwhere $\\hat{\\theta}$ is the estimator for the per-site scaled mutation rate. Solving for $\\hat{\\theta}$ gives the method-of-moments estimator, famously known as Watterson's estimator per site:\n$$\\hat{\\theta} = \\frac{S}{L a_{n-1}}$$\nThis estimator is unbiased, as can be shown by taking its expectation:\n$$E[\\hat{\\theta}] = E\\left[\\frac{S}{L a_{n-1}}\\right] = \\frac{1}{L a_{n-1}} E[S] = \\frac{1}{L a_{n-1}} (\\theta L a_{n-1}) = \\theta$$\nNow, we compute the numerical value of the estimator. The givens are $S=120$, $n=25$, and $L=50000$. First, we must calculate $a_{n-1}$:\n$$a_{n-1} = a_{24} = \\sum_{i=1}^{24} \\frac{1}{i} = 1 + \\frac{1}{2} + \\frac{1}{3} + \\dots + \\frac{1}{24}$$\nThe value of this sum is approximately $a_{24} \\approx 3.77588149$.\nSubstituting the values into the estimator formula:\n$$\\hat{\\theta} = \\frac{120}{50000 \\cdot a_{24}} \\approx \\frac{120}{50000 \\cdot 3.77588149} \\approx \\frac{120}{188794.0745} \\approx 0.0006356103$$\nRounding to four significant figures, the per-site estimate is $\\hat{\\theta} \\approx 0.0006356$.\n\nThe second part of the problem requires converting this per-site estimate to a per-kilobase (per-kb) estimate. A kilobase consists of $1000$ sites. Therefore, we multiply the per-site estimate by $1000$:\n$$\\hat{\\theta}_{\\text{kb}} = 1000 \\cdot \\hat{\\theta} \\approx 1000 \\cdot 0.0006356103 \\approx 0.6356103$$\nRounding to four significant figures, the per-kb estimate is $\\hat{\\theta}_{\\text{kb}} \\approx 0.6356$.\n\nThe two requested values are the per-site estimate and the per-kilobase estimate, in that order.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0006356  0.6356 \\end{pmatrix}}\n$$", "id": "2739378"}, {"introduction": "Beyond simply counting polymorphic sites, the frequencies of those variants contain rich information about a population's history. This practice introduces nucleotide diversity, $\\pi$, which is sensitive to intermediate-frequency alleles, and contrasts it with Watterson's estimator, $\\hat{\\theta}_W$. By calculating the numerator of Tajima's $D$, you will see how discrepancies between these two estimators can reveal frequency spectrum skews that may signal demographic changes or selection. [@problem_id:2739336]", "problem": "A sample of size $n=20$ haploid genomes is sequenced at $L=1$ megabase (Mb) of noncoding DNA under the infinite-sites model. Across this region there are $S=200$ segregating sites, and the average pairwise nucleotide diversity is measured as $\\pi=0.007$ differences per site. Using only the foundational definitions that (i) the Watterson estimator per site is obtained by dividing the count of segregating sites by the sample-size harmonic factor and by the sequence length, and (ii) the unstandardized numerator of Tajima’s $D$ statistic is the difference between the average pairwise diversity per site and the Watterson estimator per site, compute the unstandardized numerator of $D$ for this sample. Here the harmonic factor is the $(n-1)$-term harmonic number $a_{n-1}=\\sum_{i=1}^{n-1}\\frac{1}{i}$. \n\nReport the unstandardized numerator as a per-site value and round your answer to six significant figures. Then, briefly state whether its sign is positive or negative and what that sign indicates about allele frequency skew relative to the neutral equilibrium expectation.", "solution": "The problem as stated is valid, self-contained, and scientifically grounded in the principles of population genetics. We shall proceed directly to the solution.\n\nThe task is to compute the unstandardized numerator of Tajima's $D$ statistic, given as a per-site value. The problem provides the direct definition for this quantity, which we will designate as $D_{\\text{num}}$. It is the difference between the average pairwise nucleotide diversity per site, $\\pi$, and the Watterson estimator of the population mutation parameter per site, $\\hat{\\theta}_{W}$.\n$$D_{\\text{num}} = \\pi - \\hat{\\theta}_{W}$$\nThe problem provides the following values:\n- The sample size of haploid genomes is $n = 20$.\n- The length of the sequenced noncoding region is $L = 1$ megabase, which is equivalent to $L = 1 \\times 10^{6}$ base pairs.\n- The total number of observed segregating sites (polymorphisms) is $S = 200$.\n- The average pairwise nucleotide diversity per site is given as $\\pi = 0.007$.\n\nThe first step is to compute the Watterson estimator per site, $\\hat{\\theta}_{W}$. The problem statement specifies that this is found \"by dividing the count of segregating sites by the sample-size harmonic factor and by the sequence length\". This translates to the formula:\n$$\\hat{\\theta}_{W} = \\frac{S}{a_{n-1}L}$$\nwhere $a_{n-1}$ is the harmonic factor defined as the $(n-1)$-term harmonic number:\n$$a_{n-1} = \\sum_{i=1}^{n-1} \\frac{1}{i}$$\nGiven the sample size $n = 20$, we must compute $a_{n-1}$ for $n-1 = 19$. This is the $19$-th harmonic number, denoted $H_{19}$ or $a_{19}$.\n$$a_{19} = \\sum_{i=1}^{19} \\frac{1}{i} = 1 + \\frac{1}{2} + \\frac{1}{3} + \\dots + \\frac{1}{19}$$\nThe exact value of this summation is a rational number, but for calculation, a high-precision decimal approximation is sufficient.\n$$a_{19} \\approx 3.54774395474$$\nNow, one can substitute the values of $S$, $a_{19}$, and $L$ into the expression for $\\hat{\\theta}_{W}$.\n$$\\hat{\\theta}_{W} = \\frac{200}{(H_{19}) \\times (1 \\times 10^{6})} \\approx \\frac{200}{3.54774395474 \\times 10^{6}} \\approx 0.000056374937$$\nWe now have both components required to calculate the unstandardized numerator, $D_{\\text{num}}$.\n$$D_{\\text{num}} = \\pi - \\hat{\\theta}_{W} \\approx 0.007 - 0.000056374937$$\n$$D_{\\text{num}} \\approx 0.006943625063$$\nThe problem requires this result to be rounded to six significant figures. The first six significant figures are $6, 9, 4, 3, 6, 2$. The seventh digit is $5$, which requires rounding up the sixth digit.\n$$D_{\\text{num}} \\approx 0.00694363$$\nThe second part of the inquiry concerns the sign of this value and its biological interpretation. The computed value $D_{\\text{num}} \\approx 0.00694363$ is positive.\n\nThe sign of Tajima's $D$ statistic, or its numerator, reflects the skew of the site frequency spectrum relative to the expectation of the standard neutral model at demographic equilibrium. The statistic compares two estimators of the population mutation parameter $\\theta$: $\\pi$, which is the average number of pairwise differences, and $\\hat{\\theta}_{W}$, which is based on the number of segregating sites. The estimator $\\pi$ is most sensitive to polymorphisms at intermediate frequencies, while $\\hat{\\theta}_{W}$ is more heavily weighted by the number of rare variants.\n\nA positive value, as found here ($D_{\\text{num}} > 0$), signifies that $\\pi > \\hat{\\theta}_{W}$. This indicates an excess of alleles at intermediate frequencies compared to the neutral equilibrium expectation. Such a pattern in the site frequency spectrum can be a signature of balancing selection, which maintains diversity in a population, or a recent population bottleneck (contraction), which tends to remove rare alleles while increasing the relative proportion of intermediate-frequency alleles.", "answer": "$$\\boxed{6.94363 \\times 10^{-3}}$$", "id": "2739336"}, {"introduction": "The full site frequency spectrum (SFS) offers the most detailed summary of variation, especially when an outgroup allows us to \"unfold\" it by identifying the derived allele at each site. This exercise focuses on calculating Fay and Wu’s $H$, a powerful statistic that leverages the unfolded SFS to detect the signature of a selective sweep. By working with a spectrum skewed towards high-frequency derived alleles, you will practice quantifying evidence for recent positive selection. [@problem_id:2739363]", "problem": "A population genetics study sequences a contiguous genomic region of length $L = 100{,}000$ base pairs in a sample of $n = 30$ haploid genomes. An outgroup is available to polarize mutations, so the unfolded site frequency spectrum is observed. Across the region, there are exactly $S = 12$ unfolded biallelic segregating sites, with the derived-allele count histogram given by the counts $\\{\\xi_{i}\\}$ for $i \\in \\{1,2,\\dots,n-1\\}$ as follows (all unlisted counts are zero):\n- $\\xi_{24} = 2$\n- $\\xi_{25} = 1$\n- $\\xi_{26} = 3$\n- $\\xi_{27} = 2$\n- $\\xi_{28} = 3$\n- $\\xi_{29} = 1$\n\nAll remaining sites in the region are monomorphic. Using only the foundational definitions that (i) nucleotide diversity is the average per-site heterozygosity across all pairs of sampled genomes and (ii) the Fay and Wu estimator weights sites by the squared derived frequency under the standard neutral model, compute the per-site estimators $\\hat{\\theta}_{\\pi}$ and $\\hat{\\theta}_{H}$ from the unfolded site frequency spectrum, then compute the unstandardized Fay and Wu’s $H$ defined by $H = \\hat{\\theta}_{\\pi} - \\hat{\\theta}_{H}$. Finally, encode the interpretation of the sign by reporting $\\operatorname{sgn}(H) \\in \\{-1, 0, 1\\}$.\n\nReport all three estimators and the sign in the order $\\left(\\hat{\\theta}_{\\pi}, \\hat{\\theta}_{H}, H, \\operatorname{sgn}(H)\\right)$. Provide exact values; do not round.", "solution": "The problem requires the computation of several population genetic summary statistics from a given unfolded site frequency spectrum (SFS). The validation of the problem statement confirms that it is scientifically grounded, well-posed, and contains all necessary and consistent information. We shall proceed with the solution.\n\nThe provided parameters are:\n- Sample size: $n = 30$\n- Locus length: $L = 100{,}000$\n- The non-zero counts in the unfolded SFS, $\\xi_{i}$, which is the number of sites where the derived allele is found in $i$ copies, are:\n  - $\\xi_{24} = 2$\n  - $\\xi_{25} = 1$\n  - $\\xi_{26} = 3$\n  - $\\xi_{27} = 2$\n  - $\\xi_{28} = 3$\n  - $\\xi_{29} = 1$\nThe total number of segregating sites is $S = \\sum_{i=1}^{n-1} \\xi_{i} = 2+1+3+2+3+1 = 12$.\n\nFirst, we compute the per-site nucleotide diversity, $\\hat{\\theta}_{\\pi}$. The formula for this estimator, consistent with the main text, is:\n$$\n\\hat{\\theta}_{\\pi} = \\frac{1}{L} \\frac{2 \\sum_{i=1}^{n-1} i(n-i)\\xi_{i}}{n(n-1)}\n$$\nWe first compute the denominator term:\n$$\nL \\cdot n(n-1) = 100{,}000 \\times 30 \\times (30-1) = 100{,}000 \\times 870 = 87{,}000{,}000\n$$\nNext, we compute the summation term $\\sum i(n-i)\\xi_{i}$ using the provided SFS data, with $n=30$:\n$$\n\\sum_{i=1}^{n-1} i(n-i)\\xi_{i} = 24(30-24)\\xi_{24} + 25(30-25)\\xi_{25} + 26(30-26)\\xi_{26} + 27(30-27)\\xi_{27} + 28(30-28)\\xi_{28} + 29(30-29)\\xi_{29}\n$$\n$$\n= (24 \\times 6 \\times 2) + (25 \\times 5 \\times 1) + (26 \\times 4 \\times 3) + (27 \\times 3 \\times 2) + (28 \\times 2 \\times 3) + (29 \\times 1 \\times 1)\n$$\n$$\n= 288 + 125 + 312 + 162 + 168 + 29 = 1084\n$$\nThus, the estimator $\\hat{\\theta}_{\\pi}$ is:\n$$\n\\hat{\\theta}_{\\pi} = \\frac{2 \\times 1084}{87{,}000{,}000} = \\frac{2168}{87{,}000{,}000} = \\frac{271}{10,875,000}\n$$\n\nSecond, we compute the per-site Fay and Wu's estimator, $\\hat{\\theta}_{H}$. The formula, consistent with the main text, gives more weight to high-frequency derived variants:\n$$\n\\hat{\\theta}_{H} = \\frac{1}{L} \\frac{2 \\sum_{i=1}^{n-1} i^2\\xi_{i}}{n(n-1)}\n$$\nThe denominator term is the same as before. We compute the new summation term $\\sum i^2\\xi_{i}$:\n$$\n\\sum_{i=1}^{n-1} i^2\\xi_{i} = (24^2)\\xi_{24} + (25^2)\\xi_{25} + (26^2)\\xi_{26} + (27^2)\\xi_{27} + (28^2)\\xi_{28} + (29^2)\\xi_{29}\n$$\n$$\n= (576 \\times 2) + (625 \\times 1) + (676 \\times 3) + (729 \\times 2) + (784 \\times 3) + (841 \\times 1)\n$$\n$$\n= 1152 + 625 + 2028 + 1458 + 2352 + 841 = 8456\n$$\nThus, the estimator $\\hat{\\theta}_{H}$ is:\n$$\n\\hat{\\theta}_{H} = \\frac{2 \\times 8456}{87{,}000{,}000} = \\frac{16912}{87{,}000{,}000} = \\frac{2114}{10,875,000} = \\frac{1057}{5,437,500}\n$$\n\nThird, we compute the unstandardized Fay and Wu's $H$ statistic, defined as $H = \\hat{\\theta}_{\\pi} - \\hat{\\theta}_{H}$:\n$$\nH = \\frac{271}{10,875,000} - \\frac{2114}{10,875,000} = \\frac{271 - 2114}{10,875,000} = \\frac{-1843}{10,875,000}\n$$\nSimplifying this fraction gives:\n$$\nH = -\\frac{1843}{10,875,000}\n$$\n\nFinally, we determine the sign of $H$. Since $H$ is a negative value, its sign is $-1$.\n$$\n\\operatorname{sgn}(H) = -1\n$$\nThis negative value of $H$ indicates an excess of high-frequency derived variants compared to the expectation under the standard neutral model. This pattern is a classical signature of a recent selective sweep, where a beneficial mutation has rapidly increased in frequency, carrying linked neutral variants along with it. The observed SFS, containing only alleles with frequencies greater than or equal to $24/30$, is strongly skewed towards high frequencies, consistent with this interpretation.\n\nSummary of results:\n$\\hat{\\theta}_{\\pi} = \\frac{271}{10,875,000}$\n$\\hat{\\theta}_{H} = \\frac{1057}{5,437,500}$\n$H = -\\frac{1843}{10,875,000}$\n$\\operatorname{sgn}(H) = -1$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{271}{10875000}  \\frac{1057}{5437500}  -\\frac{1843}{10875000}  -1 \\end{pmatrix}}\n$$", "id": "2739363"}]}