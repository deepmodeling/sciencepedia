{"hands_on_practices": [{"introduction": "A central task in phylogeography is to synthesize information from disparate sources, such as population genetics and paleoclimatology, to build a cohesive historical narrative. This exercise confronts a classic paradox where deep genetic divergence, implying long-term isolation, appears to conflict with paleoclimatic models that suggest a single, contiguous ancestral range. Resolving this requires a nuanced understanding of scale, forcing us to consider how macro-level climate envelopes may obscure fine-scale environmental heterogeneity that drives evolutionary divergence [@problem_id:1954820].", "problem": "A phylogeographic study was conducted on the Alpine Gem-lizard (*Petrosaurus crystallinus*), a small, montane reptile endemic to the Pyrenees mountain range. Population genetic analysis using mitochondrial DNA (mtDNA) revealed the existence of two deeply divergent, geographically distinct clades, hereafter referred to as the 'Western Clade' and the 'Eastern Clade'. The two clades exhibit a stark parapatric distribution, meeting at a narrow contact zone with very limited inter-clade gene flow. The net sequence divergence ($d_A$) between the mtDNA of the two clades was calculated to be $4.35\\%$. The molecular clock for this mtDNA region is calibrated to a divergence rate of $2.1\\%$ per million years.\n\nIn parallel, paleoclimatic niche modeling was performed to reconstruct the species' likely distribution during the Last Glacial Maximum (LGM), approximately 21,000 years ago. The consensus from multiple models robustly predicts a single, large, and contiguous refugium spanning the lower-elevation slopes of the central and eastern Pyrenees. This predicted contiguous refugial area completely encompasses the current distributions of both the Western and Eastern clades. This presents a paradox: the deep genetic split suggests a long period of allopatric isolation, yet the paleoclimatic evidence suggests the ancestral population inhabited a single, unbroken area.\n\nWhich of the following demographic models provides the most parsimonious and comprehensive explanation that reconciles these apparently conflicting genetic and paleoclimatic findings?\n\nA. The two clades diverged in two geographically distinct and widely separated LGM refugia (e.g., one in the Iberian peninsula and one in the Italian peninsula), and their current parapatric distribution is the result of post-glacial range expansion and secondary contact.\n\nB. The divergence is a very recent, post-LGM event driven by strong disruptive selection for different ecological niches within a continuous population, leading to sympatric speciation.\n\nC. The species has persisted as a single, large, contiguous population for millions of years, and the observed genetic pattern is a classic example of isolation-by-distance, where genetic differentiation gradually increases with geographic separation.\n\nD. Divergence occurred in allopatry over a long period within multiple, small, and stable micro-refugia (e.g., specific valleys or slopes with unique thermal or hydrological properties) that were isolated by unsuitable terrain, all located *within* the broader area identified as a single contiguous refugium by the coarse-grained climate models.\n\nE. The two mtDNA lineages sorted incompletely from a large, ancient ancestral population. The observed geographic sorting of these ancient lineages into Western and Eastern clades is a recent phenomenon, caused by founder effects as different parts of the single LGM refugial population expanded post-glacially.", "solution": "Let $d_{A}$ denote the net mtDNA sequence divergence between the Western and Eastern clades and let the molecular clock be characterized either by a pairwise divergence rate $r$ (divergence accumulating between two lineages) or, equivalently, by a per-lineage substitution rate $u$ such that $r=2u$. The standard molecular-clock relationship between net divergence and time since lineage splitting is\n$$\nt \\;=\\; \\frac{d_{A}}{r} \\;=\\; \\frac{d_{A}}{2u}.\n$$\nWith the reported values, $d_{A}$ is on the order of $10^{-2}$ and $r$ is on the order of $10^{-2}$ per million years, so $t$ is on the order of millions of years; in either rate parameterization (whether $r$ is interpreted directly as the pairwise rate or as $2u$), the factor of $2$ only changes $t$ by a factor of $2$ and does not alter the order of magnitude. Let $t_{\\text{LGM}}$ denote the time since the Last Glacial Maximum. Given the reported $d_{A}$ and clock rate, the implied $t$ satisfies\n$$\n\\frac{t}{t_{\\text{LGM}}} \\gg 1,\n$$\nso the divergence is far older than the LGM and cannot be a post-LGM event.\n\nThis immediately rejects option B, because a very recent, post-LGM, sympatric divergence within a continuous population would require $t$ to be on the order of $t_{\\text{LGM}}$, which contradicts $t \\gg t_{\\text{LGM}}$. Option C is also inconsistent with the genetic pattern: isolation-by-distance predicts a spatially gradual turnover in haplotypes, not two deeply divergent, monophyletic clades meeting at a narrow contact zone with very limited gene flow; a sharp, parapatric break is not parsimoniously explained by simple isolation-by-distance. Option A posits two widely separated LGM refugia outside the Pyrenees, but the paleoclimatic reconstructions robustly support a single large, contiguous refugium encompassing the present ranges of both clades; accepting A would require discarding the core paleoclimatic result and is therefore not parsimonious given the evidence provided. Option E invokes incomplete lineage sorting from a single large ancestral population coupled with recent geographic sorting during post-glacial expansion. However, the observed narrow contact zone with very limited inter-clade gene flow indicates a strong, spatially concordant historical barrier, whereas recent geographic sorting from a single refugium would more parsimoniously produce broad admixture zones and interdigitation of lineages; furthermore, mtDNA has a small effective population size, making the long-term retention of such deep coalescent splits in a single, panmictic refugial population less likely without corresponding historical structure.\n\nOption D provides a parsimonious reconciliation: coarse-grained climate models can identify a broad, climatically suitable envelope as a contiguous refugium while missing fine-scale topographic, thermal, or hydrological heterogeneity that creates multiple small, stable micro-refugia isolated by unsuitable terrain. Long-term allopatry among such micro-refugia within the broader climatic refugium yields deep divergence times consistent with $t \\gg t_{\\text{LGM}}$. Post-glacial range shifts and limited dispersal then produce a parapatric distribution with a narrow contact zone and little gene flow, matching the observed genetic and geographic patterns. Thus, divergence in allopatry within multiple micro-refugia embedded in the coarse-grained contiguous refugium most comprehensively and parsimoniously explains both the deep genetic split and the paleoclimatic reconstruction.", "answer": "$$\\boxed{D}$$", "id": "1954820"}, {"introduction": "Disentangling the effects of demography from those of natural selection is a persistent challenge in population genetics. This practice problem demonstrates how to resolve the ambiguity between a recent range expansion and a selective sweep, two processes that can both drastically reduce genetic diversity. By comparing patterns of variation in the mitochondrial genome with those from unlinked nuclear markers, we can leverage their different modes of inheritance and effective population sizes to diagnose the specific evolutionary forces at play [@problem_id:1954844].", "problem": "A team of evolutionary biologists is studying the phylogeography of *Petrocallis glacialis*, a small alpine plant found in several disconnected mountain ranges. They are trying to understand the species' history since the last glacial maximum. Two primary hypotheses are proposed:\n\n1.  **Recent Range Expansion:** The species survived the glaciation in a single southern refuge and then rapidly expanded to colonize its current, fragmented distribution.\n2.  **Mitochondrial Selective Sweep:** The species has occupied its current set of mountain ranges for a very long time, leading to deep genetic divergence between populations. However, a recent selective sweep involving an advantageous mutation in the mitochondrial genome has spread through all populations, erasing the pre-existing phylogeographic structure in that part of the genome.\n\nTo distinguish between these scenarios, the researchers collect samples from across the species' range and analyze both mitochondrial DNA (mtDNA), which is maternally inherited and does not recombine, and several unlinked nuclear DNA (nDNA) markers. Their analysis reveals the following patterns:\n*   The mtDNA shows extremely low nucleotide diversity. A single haplotype is dominant and found at high frequency in all mountain ranges, with other rare haplotypes differing by only one or two mutations.\n*   The nDNA markers, in contrast, show high levels of genetic diversity. Furthermore, there is significant genetic structure, with strong allele frequency differences observed between populations from different mountain ranges (high $F_{ST}$ values).\n\nBased on the combination of these genetic data, which of the following conclusions is the most strongly supported?\n\nA. The range expansion hypothesis is supported, as the low mtDNA diversity is a classic signature of a population bottleneck associated with colonization from a small founder group.\n\nB. The mitochondrial selective sweep hypothesis is supported, as the deep divergence observed in nDNA is inconsistent with a recent common ancestry for all populations.\n\nC. The data are contradictory and cannot distinguish between the two hypotheses, necessitating the analysis of additional data such as fossil pollen.\n\nD. The range expansion hypothesis is supported, and the high structure in nDNA is likely due to strong, divergent local adaptation that occurred rapidly after the expansion.\n\nE. The mitochondrial selective sweep hypothesis is supported because a selective sweep on one genome (mitochondrial) is known to cause an increase in diversity and structure in the other genome (nuclear).", "solution": "We distinguish the two hypotheses by contrasting their genome-wide expectations against the observed patterns, using population genetic principles about drift, gene flow, selection, and effective population size.\n\n1) Expectations under recent range expansion from a single refuge:\n- A severe bottleneck and serial founder events predict reduced genetic diversity across the entire genome, not only in mtDNA. Because mtDNA is haploid, uniparentally inherited, and nonrecombining, it is particularly sensitive to drift, so very low mtDNA diversity and a dominant haplotype are expected. However, neutral nuclear loci should also show reduced diversity.\n- Immediately following a recent expansion, neutral population structure is expected to be low because allele frequencies have had little time to diverge by drift; $F_{ST}$ should be low to moderate unless isolation has persisted for long periods. Strong, concordant structure across several unlinked nuclear markers requires sufficient time for divergence and/or very limited gene flow.\n- Therefore, the combination of extremely low mtDNA diversity with high nuclear diversity and high $F_{ST}$ across unlinked nuclear markers is not expected under a recent, single-refugium expansion; it would require invoking unusually rapid and pervasive, genome-wide divergent selection to create strong structure across many neutral markers, which is unlikely.\n\n2) Expectations under a mitochondrial selective sweep after long-term regional occupancy:\n- If populations have been long isolated in multiple mountain ranges with limited gene flow, neutral nuclear markers should show high diversity and strong among-population differentiation (high $F_{ST}$), reflecting deep coalescence times and drift in separate demes.\n- A recent selective sweep in mtDNA, which is nonrecombining and maternally inherited, will purge mitochondrial variation species-wide via hitchhiking, producing a single high-frequency mtDNA haplotype and only a few closely related variants differing by one or two mutations. Because the sweep is confined to the mitochondrial genome, it does not homogenize unlinked nuclear markers, so nuclear diversity and structure persist.\n- Thus, low mtDNA diversity with a dominant haplotype across all ranges together with high, structured diversity in multiple unlinked nuclear markers precisely matches the signature of a recent mitochondrial selective sweep superimposed on long-term population structure.\n\n3) Evaluation of options:\n- A: Incomplete and contradicted by the nuclear data; a bottleneck/expansion should depress nuclear diversity and reduce neutral structure, not yield high $F_{ST}$ across unlinked nuclear loci.\n- B: Consistent with the observed deep nuclear divergence and strong structure, alongside a species-wide loss of mtDNA diversity due to a recent sweep.\n- C: The data are not contradictory; they are diagnostic when considering differing inheritance and recombination properties of mtDNA versus nuclear DNA.\n- D: Requires rapid, strong, and pervasive local adaptation across many unlinked loci to generate high $F_{ST}$ despite a recent expansion, which is unlikely, especially given neutral markers. It also fails to explain high nuclear diversity after a severe founder event.\n- E: Incorrect statement of mechanism; a sweep in one genome does not cause an increase in diversity or structure in the other genome.\n\nTherefore, the most strongly supported conclusion is that the mitochondrial selective sweep hypothesis is supported by the combination of low, homogenized mtDNA diversity and high, structured nuclear diversity.", "answer": "$$\\boxed{B}$$", "id": "1954844"}, {"introduction": "Modern phylogeographic research has become increasingly quantitative, relying on statistical model comparison to test complex demographic hypotheses. This advanced practice moves from conceptual understanding to computational implementation, a critical skill for graduate-level research. Here, you will design and apply a set of summary statistics—inspired by those used in Approximate Bayesian Computation (ABC)—to distinguish a range expansion from an equilibrium scenario, bridging the gap between population genetic theory and practical data analysis [@problem_id:2744109].", "problem": "You are given a conceptual design task grounded in phylogeography, focusing on distinguishing range expansion with allele surfing from equilibrium isolation by distance. You must translate biological definitions into implementable algorithms and build a simple decision rule, inspired by Approximate Bayesian Computation (ABC), using carefully defined summary statistics.\n\nConsider a one-dimensional transect of demes (subpopulations) at positions $x_{\\ell}$ for $\\ell = 1, \\dots, L$. At each of $S$ independent biallelic loci, you observe the count $k_{\\ell,s}$ of the derived allele in a sample of size $n$ gene copies (haploid count) from deme $\\ell$. The derived allele frequency is $p_{\\ell,s} = k_{\\ell,s} / n$. Assume $n$ is constant across loci and demes. For all formulas below, interpret sums and averages exactly as stated. All computations are to be performed in real numbers.\n\nUse the following fundamental base:\n- Allele frequency is defined as $p = k/n$.\n- Expected heterozygosity at a biallelic locus with allele frequency $p$ is $H = 2p(1-p)$.\n- The sample covariance between a variable $Y$ and $X$ is $\\mathrm{Cov}(X,Y) = \\frac{1}{L} \\sum_{\\ell=1}^{L} (X_{\\ell} - \\bar{X})(Y_{\\ell} - \\bar{Y})$, where $\\bar{X}$ and $\\bar{Y}$ are sample means.\n- The sample variance is $\\mathrm{Var}(X) = \\mathrm{Cov}(X,X)$.\n- The least-squares slope of $Y$ regressed on $X$ is $b_{Y|X} = \\frac{\\mathrm{Cov}(X,Y)}{\\mathrm{Var}(X)}$ when $\\mathrm{Var}(X) > 0$.\n- The Pearson correlation between two length-$L$ vectors $u$ and $v$ is $r(u,v) = \\frac{\\mathrm{Cov}(u,v)}{\\sqrt{\\mathrm{Var}(u)\\,\\mathrm{Var}(v)}}$, defined to be $0$ if $\\mathrm{Var}(u) = 0$ or $\\mathrm{Var}(v) = 0$.\n\nFrom these definitions, derive and implement the following summary statistics:\n1. Heterozygosity gradient. For each deme $\\ell$, compute the mean expected heterozygosity across loci,\n   $$H_{\\ell} = \\frac{1}{S} \\sum_{s=1}^{S} 2 p_{\\ell,s}\\left(1-p_{\\ell,s}\\right).$$\n   Regress $H_{\\ell}$ on distance $x_{\\ell}$ to obtain the slope\n   $$b_H = \\frac{\\mathrm{Cov}(x, H)}{\\mathrm{Var}(x)}.$$\n2. Directionality index. For each locus $s$, compute the Pearson correlation between $x_{\\ell}$ and $p_{\\ell,s}$ across demes,\n   $$r_s = r\\left(\\{x_{\\ell}\\}_{\\ell=1}^{L}, \\{p_{\\ell,s}\\}_{\\ell=1}^{L}\\right).$$\n   Define the directionality index as the mean correlation across loci,\n   $$\\Psi = \\frac{1}{S} \\sum_{s=1}^{S} r_s.$$\n3. Private allele gradient. For each deme $\\ell$, define the private derived allele count $C_{\\ell}$ as the number of loci $s$ with $k_{\\ell,s} > 0$ and $k_{m,s} = 0$ for all $m \\neq \\ell$. The private allele rate is $R_{\\ell} = C_{\\ell}/S$. Regress $R_{\\ell}$ on $x_{\\ell}$ to obtain\n   $$b_P = \\frac{\\mathrm{Cov}(x, R)}{\\mathrm{Var}(x)}.$$\n\nDesign an ABC-inspired decision rule using the signs of these statistics. For a hypothesized expansion from low to high $x$ (source at the smallest $x$), range expansion with allele surfing typically yields decreasing heterozygosity with distance, clinal increases in derived allele frequencies aligned with distance, and an enrichment of private alleles toward the expansion front. Based on this logic, classify a dataset as an expansion if at least two of the following three inequalities hold: $b_H < 0$, $\\Psi > 0$, $b_P > 0$. Otherwise, classify as equilibrium isolation by distance. The classification result must be a boolean.\n\nImplement a program that computes $(b_H, \\Psi, b_P)$ and outputs the classification for each test case below. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True]\").\n\nTest suite:\n- Case A (expansion-like). Use $L = 5$, $S = 8$, $n = 20$. Distances $x = [$0$, $1$, $2$, $3$, $4$]$. Derived allele counts $k_{\\ell,s}$ given as rows of length $S$ for demes $\\ell = 1, \\dots, 5$:\n  - $\\ell=1$: [$8$, $7$, $6$, $4$, $0$, $0$, $5$, $3$]\n  - $\\ell=2$: [$10$, $9$, $8$, $6$, $0$, $0$, $7$, $4$]\n  - $\\ell=3$: [$12$, $12$, $11$, $10$, $0$, $0$, $9$, $5$]\n  - $\\ell=4$: [$14$, $15$, $14$, $14$, $0$, $0$, $11$, $6$]\n  - $\\ell=5$: [$17$, $18$, $17$, $18$, $20$, $18$, $14$, $8$]\n- Case B (equilibrium isolation by distance-like). Use $L = 5$, $S = 8$, $n = 20$. Distances $x = [$0$, $1$, $2$, $3$, $4$]$. Derived allele counts $k_{\\ell,s}$ as:\n  - $\\ell=1$: [$10$, $8$, $12$, $7$, $1$, $9$, $11$, $10$]\n  - $\\ell=2$: [$11$, $9$, $11$, $8$, $0$, $10$, $10$, $10$]\n  - $\\ell=3$: [$10$, $10$, $10$, $10$, $1$, $10$, $9$, $10$]\n  - $\\ell=4$: [$9$, $9$, $11$, $8$, $0$, $10$, $10$, $10$]\n  - $\\ell=5$: [$10$, $8$, $12$, $7$, $1$, $9$, $11$, $10$]\n- Case C (edge case with minimal clinality). Use $L = 4$, $S = 6$, $n = 20$. Distances $x = [$0$, $1$, $2$, $3$]$. Derived allele counts $k_{\\ell,s}$ as:\n  - $\\ell=1$: [$10$, $6$, $14$, $2$, $0$, $8$]\n  - $\\ell=2$: [$10$, $6$, $14$, $0$, $0$, $8$]\n  - $\\ell=3$: [$10$, $6$, $14$, $0$, $0$, $8$]\n  - $\\ell=4$: [$10$, $6$, $14$, $0$, $2$, $8$]\n\nYour program should produce a single line of output containing the boolean classifications for the three cases in order, as a comma-separated list enclosed in square brackets. No spaces are allowed inside the brackets. The output must be in the exact format \"[result_A,result_B,result_C]\". There are no physical units or angle units required, and no percentages are used in the answer. The final outputs are booleans.", "solution": "The solution involves implementing the specified algorithm to calculate three summary statistics ($b_H$, $\\Psi$, $b_P$) and applying a decision rule for each test case.\n\n**1. Algorithm Steps:**\n*   **Heterozygosity Gradient ($b_H$)**: For each deme, calculate the mean expected heterozygosity ($H_{\\ell}$) across all loci. Then, compute the slope of the linear regression of $H_{\\ell}$ on deme position $x_{\\ell}$.\n*   **Directionality Index ($\\Psi$)**: For each locus, calculate the Pearson correlation ($r_s$) between allele frequencies and deme positions. The index $\\Psi$ is the mean of these correlations across all loci.\n*   **Private Allele Gradient ($b_P$)**: For each deme, count the number of private derived alleles ($C_{\\ell}$) and calculate the rate ($R_{\\ell} = C_{\\ell}/S$). Then, compute the slope of the linear regression of $R_{\\ell}$ on deme position $x_{\\ell}$.\n\n**2. Decision Rule:**\nA dataset is classified as a range expansion (`True`) if at least two of the following conditions are met: $b_H  0$, $\\Psi > 0$, and $b_P > 0$. Otherwise, it is classified as equilibrium IBD (`False`).\n\n**3. Implementation:**\nThe following Python code implements this logic. All calculations strictly follow the formulas provided in the problem description.\n\n```python\nimport numpy as np\n\ndef _cov(X, Y):\n    X_bar, Y_bar = np.mean(X), np.mean(Y)\n    return np.mean((X - X_bar) * (Y - Y_bar))\n\ndef _var(X):\n    return _cov(X, X)\n\ndef _pearson_r(u, v):\n    var_u, var_v = _var(u), _var(v)\n    return 0.0 if var_u == 0 or var_v == 0 else _cov(u, v) / np.sqrt(var_u * var_v)\n\ndef _slope(Y, X):\n    var_x = _var(X)\n    return 0.0 if var_x == 0 else _cov(X, Y) / var_x\n    \ndef classify(L, S, n, x, k):\n    p = k / n\n    \n    # 1. Heterozygosity gradient (b_H)\n    H_vector = np.mean(2 * p * (1 - p), axis=1)\n    b_H = _slope(H_vector, x)\n\n    # 2. Directionality index (Psi)\n    correlations = [_pearson_r(x, p[:, s]) for s in range(S)]\n    Psi = np.mean(correlations)\n\n    # 3. Private allele gradient (b_P)\n    C_vector = np.zeros(L)\n    for s in range(S):\n        present_demes = np.where(k[:, s] > 0)[0]\n        if len(present_demes) == 1:\n            C_vector[present_demes[0]] += 1\n    R_vector = C_vector / S\n    b_P = _slope(R_vector, x)\n    \n    # Decision Rule\n    conditions_met = (b_H  0) + (Psi > 0) + (b_P > 0)\n    return conditions_met >= 2\n\n# Test Case A: Allele frequencies generally increase with distance, and two private alleles appear at the front (deme 5). This strongly suggests expansion. We expect b_H  0, Psi > 0, b_P > 0. Result: True.\n# Test Case B: Allele frequencies are symmetric around the center, with no clear trend. This suggests equilibrium. We expect b_H ≈ 0, Psi ≈ 0, b_P = 0. Result: False.\n# Test Case C: Allele frequencies are mostly constant, but one private allele appears at the start (deme 1) and one at the end (deme 4). The signals are mixed, with b_P > 0 but b_H ≈ 0 and Psi ≈ 0. Only one condition is met. Result: False.\n```\n\nExecuting this program on the provided test cases yields the final classification results.", "answer": "`[True,False,False]`", "id": "2744109"}]}