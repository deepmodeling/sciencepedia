{"hands_on_practices": [{"introduction": "This exercise grounds the endosymbiotic theory in first principles of bioenergetics. You will derive a simple but powerful model to explore the Lane-Martin hypothesis, which posits that mitochondria provided the energetic surplus necessary for the evolution of eukaryotic complexity. By formalizing how energy production scales with membrane area while costs scale with cell volume, this practice [@problem_id:2703253] demonstrates quantitatively why the shift to a multi-genome cellular architecture was a pivotal event in the history of life.", "problem": "A central prediction of the Lane–Martin bioenergetic theory is that endosymbiosis decouples energy supply from genome size by scaling adenosine triphosphate (ATP) production with respiratory membrane area, while many cellular costs scale with cell volume. Consider a eukaryotic cell at steady state in which mitochondria supply all ATP used by the cell. Let the total inner mitochondrial membrane area devoted to respiration be $A_{r}$, and let the net ATP synthesis rate density (ATP molecules per unit time per unit respiratory membrane area, already accounting for proton leak and coupling efficiency) be $j_{r}$. Thus, total mitochondrial ATP production rate is $J_{\\mathrm{prod}} = j_{r} A_{r}$. Assume the basal cellular ATP demand scales with cell volume $V$ with density $m_{v}$ (ATP molecules per unit time per unit volume), so that basal demand is $J_{\\mathrm{basal}} = m_{v} V$. In addition, maintaining mitochondrial deoxyribonucleic acid (mtDNA) imposes an ATP cost $s_{m}$ per mtDNA molecule per unit time, and there are $C_{m}$ mtDNA molecules per cell, giving an mtDNA-specific cost $J_{\\mathrm{mtDNA}} = s_{m} C_{m}$. Assume the steady-state net ATP available to power all gene-associated cellular work is the difference $J_{\\mathrm{net}} = J_{\\mathrm{prod}} - (J_{\\mathrm{basal}} + J_{\\mathrm{mtDNA}})$.\n\nLet the total number of nuclear gene copies per cell (including ploidy) be $G_{N}$, treated as a constant for the cell type considered. Let each mtDNA molecule encode $g_{m}$ genes, so the total number of mtDNA gene copies is $g_{m} C_{m}$. Define the ATP-per-gene supply $\\Phi$ as the steady-state net ATP available per unit time divided by the total number of gene copies that must be maintained and expressed, that is, total gene copies $G_{N} + g_{m} C_{m}$.\n\nStarting from these definitions and the steady-state assumption, and without invoking any specialized results beyond the scaling of production with area and costs with volume and copy number, derive a single closed-form analytic expression for $\\Phi$ as a function of $A_{r}$, $V$, and $C_{m}$, along with the constants $j_{r}$, $m_{v}$, $s_{m}$, $g_{m}$, and $G_{N}$. Express your final answer as an analytic expression. Do not include units in your final expression. You may assume the regime $J_{\\mathrm{prod}} > J_{\\mathrm{basal}} + J_{\\mathrm{mtDNA}}$ so that $\\Phi$ is positive.", "solution": "We are asked to derive an expression for the ATP-per-gene supply, denoted $\\Phi$, based on first principles of scaling: production with membrane area and costs with volume and copy number.\n\nBy definition, the total ATP production rate supplied by mitochondria is given by the product of the net ATP synthesis rate density and the total respiratory membrane area:\n$$\nJ_{\\mathrm{prod}} = j_{r} A_{r}.\n$$\nThe steady-state cellular ATP demand is decomposed into two parts. First, a basal maintenance cost that scales with cell volume:\n$$\nJ_{\\mathrm{basal}} = m_{v} V,\n$$\nwhere $m_{v}$ is the ATP demand density per unit volume. Second, a cost associated with maintaining, replicating, and expressing mitochondrial deoxyribonucleic acid (mtDNA), which scales linearly with the number of mtDNA molecules:\n$$\nJ_{\\mathrm{mtDNA}} = s_{m} C_{m},\n$$\nwhere $s_{m}$ is the ATP cost per mtDNA molecule per unit time and $C_{m}$ is the mtDNA copy number.\n\nUnder the steady-state assumption, the net ATP available to power gene-associated cellular work equals production minus the sum of demands:\n$$\nJ_{\\mathrm{net}} = J_{\\mathrm{prod}} - \\bigl(J_{\\mathrm{basal}} + J_{\\mathrm{mtDNA}}\\bigr) = j_{r} A_{r} - m_{v} V - s_{m} C_{m}.\n$$\n\nNext, we formalize the denominator: the total number of gene copies that must be maintained and expressed. The nuclear gene copies per cell (including ploidy) are taken as a constant $G_{N}$. Each mtDNA molecule carries $g_{m}$ genes, so the mtDNA gene copies are $g_{m} C_{m}$. Therefore, the total gene copies are\n$$\nG_{\\mathrm{tot}} = G_{N} + g_{m} C_{m}.\n$$\n\nBy the definition provided, the ATP-per-gene supply $\\Phi$ is the net ATP available per unit time divided by the total gene copies:\n$$\n\\Phi = \\frac{J_{\\mathrm{net}}}{G_{\\mathrm{tot}}}.\n$$\nSubstituting the expressions for $J_{\\mathrm{net}}$ and $G_{\\mathrm{tot}}$, we obtain\n$$\n\\Phi(A_{r}, V, C_{m}; j_{r}, m_{v}, s_{m}, g_{m}, G_{N}) = \\frac{j_{r} A_{r} - m_{v} V - s_{m} C_{m}}{G_{N} + g_{m} C_{m}}.\n$$\n\nWe can briefly verify dimensional consistency. The numerator has units of ATP per unit time: $j_{r} A_{r}$ is ATP per unit time, as is $m_{v} V$ and $s_{m} C_{m}$. The denominator is a pure count of gene copies. Hence, $\\Phi$ has units of ATP per unit time per gene copy, as intended. The assumed regime $j_{r} A_{r} > m_{v} V + s_{m} C_{m}$ ensures $\\Phi > 0$.\n\nThis expression captures the Lane–Martin intuition: increasing the respiratory membrane area $A_{r}$ raises $\\Phi$, increasing the cell volume $V$ reduces $\\Phi$ through elevated maintenance costs, and increasing mtDNA copy number $C_{m}$ imposes a trade-off by increasing both the numerator’s cost term and the denominator’s gene count, generally tending to reduce $\\Phi$ unless accompanied by compensatory increases in $A_{r}$ or $j_{r}$.", "answer": "$$\\boxed{\\frac{j_{r} A_{r} - m_{v} V - s_{m} C_{m}}{G_{N} + g_{m} C_{m}}}$$", "id": "2703253"}, {"introduction": "Inferring evolutionary history often requires acting as a detective, piecing together clues from disparate sources. This problem [@problem_id:2703178] presents a hypothetical scenario involving a novel organelle to challenge you to weigh multiple, independent lines of evidence—from protein import machinery and membrane lipids to phylogenomic signals. This practice sharpens your skills in hypothesis testing and illustrates the principle of consilience, demonstrating that a powerful evolutionary inference can be made even in the absence of a \"smoking gun\" like a residual organelle genome.", "problem": "A newly described eukaryotic lineage contains a membrane-bound compartment, provisionally named Organelle X. Multiple independent assays (long-read genome sequencing, organelle-enriched fraction sequencing, and ultrasensitive fluorometric deoxyribonucleic acid (DNA) stains) repeatedly fail to detect any DNA in Organelle X under conditions that readily detect nuclear and mitochondrial DNA in control taxa. However, comparative cell biology yields the following jointly observed features of Organelle X across several species in the lineage:\n\n- A double membrane envelope with an outer membrane continuous with neither the endoplasmic reticulum nor the nuclear envelope, and an inner membrane bearing cristae-like invaginations.\n- A dedicated protein import system composed of a beta-barrel pore homologous to bacterial Omp family proteins, a Sorting and Assembly Machinery (SAM, also called Translocase of the Outer Membrane of Beta-barrel proteins (TOB)) homolog, and a Translocase of the Inner Membrane (TIM)-like complex; imported substrates possess N-terminal, amphipathic, arginine-rich targeting peptides that are cleaved upon import.\n- Enrichment of cardiolipin in the inner membrane and division by binary fission using FtsZ-like ring structures.\n- Nuclear genes encoding Organelle X proteins show strong phylogenetic affinity to alphaproteobacterial homologs; many carry organelle-targeting signals and are upregulated during organelle biogenesis.\n\nAutogenous hypotheses posit that new organelles arise by internal differentiation and invagination of the host endomembrane system, whereas the endosymbiotic theory posits origin from an engulfed bacterium followed by reductive evolution and extensive endosymbiotic gene transfer to the nucleus, with evolution of protein targeting and import machinery to retarget the encoded proteins. Given only the evidence above, which conclusion is best supported about the viability of autogenous hypotheses for Organelle X, and why?\n\nA. Autogenous hypotheses remain viable because a double membrane can form by invagination, and the lack of an organelle genome contradicts endosymbiotic origins.\n\nB. Autogenous hypotheses are strongly disfavored; the most parsimonious explanation is an endosymbiotic ancestry with complete genome loss via endosymbiotic gene transfer, as indicated by bacterial-type import machinery, bacterial lipid signatures, binary fission, and alphaproteobacterial phylogenetic affinity of nuclear-encoded organelle proteins.\n\nC. Autogenous and endosymbiotic hypotheses are equally plausible; without a resident organelle genome, origin cannot be inferred, and protein import systems can arise convergently from generic endomembrane translocons.\n\nD. Autogenous hypotheses remain viable only if the import machinery is homologous to eukaryotic endomembrane systems and lipids match typical endoplasmic reticulum profiles; because the observed machinery and lipids are bacterial-like, autogenous origin is not supported by the dataset.", "solution": "Start from core definitions and well-tested evolutionary principles:\n\n- Under the endosymbiotic theory, organelles such as mitochondria and plastids originated when a host cell engulfed a bacterium. Over time, extensive endosymbiotic gene transfer moved many genes to the nucleus, organelle genomes underwent reductive evolution, and protein targeting and import pathways evolved to deliver nuclear-encoded proteins back to the organelle. Empirically, mitochondria-derived organelles can lose their genomes entirely (for example, mitosomes and some hydrogenosomes), while retaining double membranes, division by fission, bacterial-type lipids such as cardiolipin, and specialized import machineries (for example, Translocase of the Outer Membrane (TOM), Sorting and Assembly Machinery (SAM)/Translocase of the Outer Membrane of Beta-barrel proteins (TOB), and Translocase of the Inner Membrane (TIM) systems).\n- Autogenous hypotheses propose that an organelle originates by internal differentiation and invagination of the host endomembrane system. Predicted signatures would include derivation from eukaryotic endomembrane components, lipid compositions characteristic of the endoplasmic reticulum and Golgi rather than bacteria, absence of bacterial division systems (for example, FtsZ), and protein translocation systems homologous to eukaryotic endomembrane translocons (for example, Sec61) rather than to bacterial outer membrane assembly systems (for example, Omp85 family that underlies SAM/TOB).\n\nApply these principles to the observations:\n\n- Double membrane: This alone is not decisive because both engulfment and invagination can yield double membranes. Thus, this feature neither uniquely supports nor excludes either hypothesis on its own.\n- Protein import machinery: The presence of a beta-barrel pore and a SAM/TOB homolog with clear homology to bacterial Omp family proteins, plus a TIM-like complex and substrates with N-terminal amphipathic, arginine-rich targeting peptides, collectively match the canonical mitochondrial protein import and assembly systems and targeting signals. These systems are phylogenetically and structurally tied to bacterial outer membrane assembly (Omp85 family) and are not simple derivatives of eukaryotic endoplasmic reticulum translocons. This is strong evidence for an endosymbiotic ancestry with the evolution of organelle-specific import after gene transfer to the nucleus.\n- Lipids and division: Enrichment of cardiolipin, a lipid abundant in bacteria and inner mitochondrial membranes but not typical of endoplasmic reticulum-derived membranes, and division by binary fission utilizing FtsZ-like systems, are classical bacterial signatures retained in mitochondria and plastids. These are inconsistent with a purely autogenous origin from the host endomembrane system.\n- Nuclear gene phylogenies: Nuclear-encoded Organelle X proteins that nest within alphaproteobacteria in phylogenetic trees strongly support endosymbiotic gene transfer from an alphaproteobacterial ancestor to the host nucleus, with subsequent retargeting to the organelle via N-terminal targeting peptides.\n\nCritically, the absence of a resident organelle genome does not refute endosymbiosis, because genome loss following massive gene transfer is a well-documented outcome of reductive evolution in mitochondrion-derived organelles. Therefore, the conjunction of bacterial-type import machinery, bacterial-like lipid composition, bacterial-style division, and alphaproteobacterial phylogenetic affinity of nuclear-encoded organelle proteins aligns with an endosymbiotic origin followed by complete genome loss. Under autogenous hypotheses, one would expect import systems and membrane compositions to be derived from eukaryotic endomembranes rather than bacterial homologs; the observed dataset contradicts those expectations.\n\nOption-by-option analysis:\n\n- Option A: It is true that double membranes can form by invagination; however, the lack of an organelle genome does not contradict endosymbiosis because complete genome loss can occur after endosymbiotic gene transfer. Moreover, the dataset includes bacterial-type import machinery, bacterial lipids, and bacterial-style division, which are inconsistent with a purely autogenous origin. Verdict — Incorrect.\n\n- Option B: This option integrates the key evidence: bacterial-type import machinery (Omp-family linked SAM/TOB and TIM-like systems with mitochondrial-style targeting peptides), bacterial lipid signatures (cardiolipin enrichment), binary fission with FtsZ-like structures, and alphaproteobacterial phylogenetic affinity of nuclear-encoded organelle proteins. It correctly interprets genome absence as compatible with endosymbiotic ancestry via reductive evolution and endosymbiotic gene transfer. Verdict — Correct.\n\n- Option C: This option treats the hypotheses as equally plausible and assumes import systems can arise convergently from generic endomembrane translocons. The specific homology to bacterial Omp-family machinery and the lipid and division signatures argue against such convergence from eukaryotic systems, and the phylogenetic affinity of organelle-targeted proteins to alphaproteobacteria specifically supports endosymbiosis. Verdict — Incorrect.\n\n- Option D: This option states a conditional that accurately identifies what would be needed to keep autogenous hypotheses viable (eukaryotic endomembrane-derived import and typical endoplasmic reticulum lipid profiles) and concludes that because the observed machinery and lipids are bacterial-like, autogenous origin is not supported. Although framed conditionally, it reaches the same empirical conclusion as Option B. However, the prompt asks for the best supported conclusion given the evidence and to assess viability; Option D’s structure implicitly concedes that autogenous hypotheses are not supported here, but it functions more as a methodological statement than a direct conclusion about the dataset. Between the two, Option B more directly and comprehensively justifies the endosymbiotic interpretation using all listed evidence, including the phylogenetic signal and division mode. Verdict — Incorrect as a best answer, because it is less complete and not the most directly justified conclusion.\n\nTherefore, the best-supported choice is the endosymbiotic origin with genome loss, which disfavours autogenous hypotheses in this case.", "answer": "$$\\boxed{B}$$", "id": "2703178"}, {"introduction": "The endosymbiotic origin of mitochondria left an indelible mark on the eukaryotic nuclear genome, creating a mosaic of genes with archaeal and bacterial ancestries. This practice [@problem_id:2703240] transitions from theory to computational application, guiding you to implement a phylogenomic test to partition nuclear genes into their likely ancestral classes. By building a likelihood-based classifier and performing a statistical enrichment test, you will gain hands-on experience with the quantitative methods used to dissect the chimeric nature of our genomes and test functional hypotheses about the fates of transferred genes.", "problem": "You are given a curated dataset of nuclear gene families with summary statistics that approximate phylogenomic signal for archaeal versus bacterial origins and binary annotations indicating predicted organelle targeting (mitochondria or plastid). Your task is to formalize a likelihood-based classification test grounded in first principles of inference and to assess whether organelle-targeted proteins are enriched among genes classified as bacterial in a statistically principled manner.\n\nBase the derivation on the following well-tested facts and core definitions:\n- Homolog detection counts across clades can be modeled as arising from independent Poisson processes under a given rate parameter, a standard assumption for count data in comparative genomics when sampling heterogeneity is present.\n- The Maximum Likelihood (ML) principle and the likelihood ratio framework: given two competing hypotheses, the ratio of likelihoods computed under each hypothesis provides an optimal test statistic under broad regularity conditions.\n- The Fisher exact test for $2 \\times 2$ contingency tables is an exact test for enrichment and is appropriate for small counts.\n\nModeling assumptions for classification:\n- For each gene family $i$, you observe a pair of nonnegative integers $(b_i, a_i)$ representing the number of significant homolog detections in bacterial and archaeal reference sets, respectively, derived from a standardized homology search pipeline. You also observe a binary indicator $t_i \\in \\{0,1\\}$ for predicted organelle targeting.\n- Let $s_B > 0$ and $s_A > 0$ denote sampling-effort scaling factors for bacterial and archaeal references, respectively, which correct for differences in reference coverage.\n- Let $\\theta > 0$ represent the expected detection rate multiplier when the gene’s true origin matches a clade, and let $\\varepsilon > 0$ represent the expected detection rate multiplier in the non-matching clade, with $\\theta > \\varepsilon$.\n- Under a bacterial-origin hypothesis $H_B$, the expected rates for $(b_i, a_i)$ are $(\\lambda_B, \\lambda_A) = (\\theta s_B, \\varepsilon s_A)$. Under an archaeal-origin hypothesis $H_A$, the expected rates are $(\\lambda_B, \\lambda_A) = (\\varepsilon s_B, \\theta s_A)$.\n- Assume independence of $b_i$ and $a_i$ conditional on origin; each is modeled as a Poisson random variable with its corresponding rate.\n\nClassification task:\n- Derive, from first principles, the log-likelihood ratio statistic for gene $i$,\n  \n$$\n  \\mathrm{LLR}_i = \\log \\frac{L\\big((b_i,a_i) \\mid H_B\\big)}{L\\big((b_i,a_i) \\mid H_A\\big)},\n  $$\n\n  using the Poisson likelihoods under the two hypotheses and assuming equal priors for $H_B$ and $H_A$.\n- Define a deterministic partition rule: classify gene $i$ as bacterial origin if $\\mathrm{LLR}_i \\ge 0$, and archaeal origin otherwise.\n\nEnrichment task:\n- After classifying all genes, construct a $2 \\times 2$ contingency table with rows corresponding to the inferred class (bacterial versus archaeal) and columns indicating organelle-targeted versus not:\n  \n$$\n  \\begin{array}{cc}\n  \\text{targeted in bacterial class} & \\text{non-targeted in bacterial class} \\\\\n  \\text{targeted in archaeal class} & \\text{non-targeted in archaeal class}\n  \\end{array}\n  $$\n\n- Perform a one-sided Fisher exact test for the alternative hypothesis that the odds of organelle targeting are higher in the bacterial class than in the archaeal class.\n- If either class contains zero genes (i.e., no genes classified into that class), define the p-value by convention to be $1.0$. Otherwise, compute the exact one-sided p-value.\n- Report the p-value as a decimal (not a percentage), rounded to exactly six digits after the decimal point.\n\nInput specification (embedded test suite):\nFor each test case, you are provided with $(\\theta, \\varepsilon, s_B, s_A)$ and a list of gene families as triples $(b_i, a_i, t_i)$.\n\nTest Case $1$ (happy path with balanced sampling and strong signal):\n- Parameters: $\\theta = 2.5$, $\\varepsilon = 0.1$, $s_B = 1.0$, $s_A = 1.0$.\n- Gene families $(b_i, a_i, t_i)$:\n  - $(5, 0, 1)$, $(4, 1, 1)$, $(3, 0, 1)$, $(6, 1, 1)$,\n  - $(2, 0, 0)$, $(3, 1, 1)$, $(4, 0, 1)$, $(5, 2, 0)$,\n  - $(0, 4, 0)$, $(1, 5, 0)$, $(0, 3, 0)$, $(1, 4, 0)$.\n\nTest Case $2$ (boundary-like with weak signal and ties):\n- Parameters: $\\theta = 1.2$, $\\varepsilon = 1.0$, $s_B = 1.0$, $s_A = 1.0$.\n- Gene families $(b_i, a_i, t_i)$:\n  - $(0, 0, 1)$, $(1, 1, 0)$, $(2, 2, 1)$,\n  - $(1, 0, 0)$, $(0, 1, 1)$, $(1, 2, 0)$.\n\nTest Case $3$ (sampling-imbalance edge case with correction by $s_B, s_A$):\n- Parameters: $\\theta = 2.0$, $\\varepsilon = 0.2$, $s_B = 5.0$, $s_A = 1.0$.\n- Gene families $(b_i, a_i, t_i)$:\n  - $(6, 4, 0)$, $(7, 5, 0)$, $(10, 0, 1)$, $(8, 1, 1)$,\n  - $(12, 0, 1)$, $(5, 3, 1)$, $(1, 2, 0)$, $(9, 0, 1)$.\n\nProgram requirements:\n- Implement the classification and enrichment analysis exactly as specified.\n- For each test case, produce a list $[N_B, N_A, p]$ where $N_B$ is the number of genes classified as bacterial origin (an integer), $N_A$ is the number classified as archaeal origin (an integer), and $p$ is the one-sided Fisher exact p-value rounded to six digits after the decimal point (a float).\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. The items for each test case must be sublists of the form $[N_B, N_A, p]$. For example: $[[N_{B,1},N_{A,1},p_1],[N_{B,2},N_{A,2},p_2],[N_{B,3},N_{A,3},p_3]]$.", "solution": "We formalize a phylogenomic partition test using the Maximum Likelihood (ML) principle with Poisson count models and then test for enrichment using Fisher’s exact test.\n\nFoundational modeling and derivation:\n- For gene $i$, let the observed counts be $b_i \\in \\mathbb{Z}_{\\ge 0}$ and $a_i \\in \\mathbb{Z}_{\\ge 0}$, corresponding to bacterial and archaeal homolog detections. Under the bacterial-origin hypothesis $H_B$, we posit Poisson rates $\\lambda_B^{(B)} = \\theta s_B$ and $\\lambda_A^{(B)} = \\varepsilon s_A$. Under the archaeal-origin hypothesis $H_A$, we posit $\\lambda_B^{(A)} = \\varepsilon s_B$ and $\\lambda_A^{(A)} = \\theta s_A$. These rates encode the widely supported expectation that homolog detection is more frequent in the matching clade (rate multiplier $\\theta$) than in the non-matching clade (rate multiplier $\\varepsilon$), while correcting for sampling via $s_B$ and $s_A$.\n- Assuming independence, the likelihood under $H_B$ is\n  \n$$\n  L\\big((b_i,a_i)\\mid H_B\\big) = \\mathrm{Poisson}(b_i \\mid \\lambda_B^{(B)}) \\cdot \\mathrm{Poisson}(a_i \\mid \\lambda_A^{(B)}),\n  $$\n\n  and under $H_A$,\n  \n$$\n  L\\big((b_i,a_i)\\mid H_A\\big) = \\mathrm{Poisson}(b_i \\mid \\lambda_B^{(A)}) \\cdot \\mathrm{Poisson}(a_i \\mid \\lambda_A^{(A)}).\n  $$\n\n- The Poisson probability mass function is $P(X=k)=\\frac{\\lambda^k e^{-\\lambda}}{k!}$. Taking logs and forming the log-likelihood ratio with equal priors yields\n  \n$$\n  \\mathrm{LLR}_i = \\log \\frac{L\\big((b_i,a_i)\\mid H_B\\big)}{L\\big((b_i,a_i)\\mid H_A\\big)}\n  = b_i \\log \\frac{\\lambda_B^{(B)}}{\\lambda_B^{(A)}} + a_i \\log \\frac{\\lambda_A^{(B)}}{\\lambda_A^{(A)}} - \\big(\\lambda_B^{(B)} - \\lambda_B^{(A)}\\big) - \\big(\\lambda_A^{(B)} - \\lambda_A^{(A)}\\big).\n  $$\n\n  This expression is obtained by canceling factorial terms and collecting like terms from the Poisson log-likelihoods.\n\nClassification rule:\n- With equal priors for $H_B$ and $H_A$, the likelihood ratio test with threshold $1$ corresponds to $\\mathrm{LLR}_i \\ge 0$ favoring $H_B$. We therefore classify gene $i$ as bacterial origin if $\\mathrm{LLR}_i \\ge 0$ and archaeal origin otherwise.\n\nEnrichment analysis:\n- After classification, we count in the bacterial class the number of organelle-targeted genes $x_B = \\sum_{i \\in \\text{B-class}} \\mathbb{I}(t_i = 1)$ and non-targeted $n_B - x_B$, where $n_B$ is the size of the bacterial class. Similarly, in the archaeal class, $x_A$ targeted and $n_A - x_A$ non-targeted.\n- We construct the $2 \\times 2$ table\n  \n$$\n  \\begin{pmatrix}\n  x_B & n_B - x_B \\\\\n  x_A & n_A - x_A\n  \\end{pmatrix}\n  $$\n\n  and apply the one-sided Fisher exact test for the alternative hypothesis that the odds of targeting are greater in the bacterial class than in the archaeal class. If either $n_B = 0$ or $n_A = 0$, we set the p-value to $1.0$ by convention due to the lack of a comparative baseline.\n- We report the p-value rounded to exactly six digits after the decimal point.\n\nAlgorithmic steps implemented in code:\n- For each test case with given $\\theta$, $\\varepsilon$, $s_B$, and $s_A$, compute $\\lambda_B^{(B)} = \\theta s_B$, $\\lambda_A^{(B)} = \\varepsilon s_A$, $\\lambda_B^{(A)} = \\varepsilon s_B$, $\\lambda_A^{(A)} = \\theta s_A$.\n- For each gene $(b_i, a_i, t_i)$, compute $\\mathrm{LLR}_i$ using the derived formula and classify based on the sign of $\\mathrm{LLR}_i$.\n- Aggregate counts $n_B, n_A, x_B, x_A$.\n- Compute the one-sided Fisher exact p-value for enrichment in the bacterial class, or return $1.0$ if a class is empty.\n- Output, for each test case, $[N_B, N_A, p]$ where $N_B = n_B$, $N_A = n_A$, and $p$ is the rounded p-value.\n- Print a single line containing the list of the three test-case result lists in order.\n\nThis design starts from fundamental probabilistic modeling of count data and applies the ML principle for classification, followed by an exact nonparametric test for enrichment. The sampling-effort parameters $(s_B, s_A)$ correct for reference imbalance, ensuring scientific realism in the presence of uneven database coverage.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import fisher_exact\n\ndef llr_for_gene(b, a, theta, epsilon, sB, sA):\n    \"\"\"\n    Compute log-likelihood ratio LLR = log L(data|HB) - log L(data|HA)\n    Under HB: lambdas = (theta*sB, epsilon*sA)\n    Under HA: lambdas = (epsilon*sB, theta*sA)\n    \"\"\"\n    # Rates under both hypotheses\n    lamB_HB = theta * sB\n    lamA_HB = epsilon * sA\n    lamB_HA = epsilon * sB\n    lamA_HA = theta * sA\n\n    # To avoid any numerical issues, work in log space. All rates are positive by construction.\n    # LLR derived from Poisson log-likelihoods:\n    # b*log(lamB_HB/lamB_HA) + a*log(lamA_HB/lamA_HA) - (lamB_HB - lamB_HA) - (lamA_HB - lamA_HA)\n    term_b = 0.0 if b == 0 else b * (np.log(lamB_HB) - np.log(lamB_HA))\n    term_a = 0.0 if a == 0 else a * (np.log(lamA_HB) - np.log(lamA_HA))\n    offset = (lamB_HB - lamB_HA) + (lamA_HB - lamA_HA)\n    return term_b + term_a - offset\n\ndef classify_genes(gene_data, theta, epsilon, sB, sA):\n    \"\"\"\n    Classify each gene as bacterial (LLR >= 0) or archaeal (LLR < 0).\n    gene_data: list of (b, a, t)\n    Returns: lists of indices for bacterial and archaeal classes, and targeted counts\n    \"\"\"\n    bacterial_indices = []\n    archaeal_indices = []\n    targeted_b = 0\n    targeted_a = 0\n\n    for idx, (b, a, t) in enumerate(gene_data):\n        llr = llr_for_gene(b, a, theta, epsilon, sB, sA)\n        if llr >= 0.0:\n            bacterial_indices.append(idx)\n            if t == 1:\n                targeted_b += 1\n        else:\n            archaeal_indices.append(idx)\n            if t == 1:\n                targeted_a += 1\n\n    return bacterial_indices, archaeal_indices, targeted_b, targeted_a\n\ndef enrichment_p_value(n_b, x_b, n_a, x_a):\n    \"\"\"\n    Compute one-sided Fisher exact test p-value for enrichment of targeting in bacterial class.\n    Returns p-value (float). If either class has zero genes, returns 1.0 by convention.\n    \"\"\"\n    if n_b == 0 or n_a == 0:\n        return 1.0\n    table = np.array([[x_b, n_b - x_b],\n                      [x_a, n_a - x_a]], dtype=int)\n    # One-sided: odds of targeting higher in bacterial\n    _, p = fisher_exact(table, alternative='greater')\n    # Ensure finite numeric value\n    if not np.isfinite(p):\n        p = 1.0\n    return float(p)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a dict with parameters and gene data list of (b, a, t).\n    test_cases = [\n        {\n            \"theta\": 2.5, \"epsilon\": 0.1, \"sB\": 1.0, \"sA\": 1.0,\n            \"genes\": [\n                (5,0,1),(4,1,1),(3,0,1),(6,1,1),\n                (2,0,0),(3,1,1),(4,0,1),(5,2,0),\n                (0,4,0),(1,5,0),(0,3,0),(1,4,0),\n            ],\n        },\n        {\n            \"theta\": 1.2, \"epsilon\": 1.0, \"sB\": 1.0, \"sA\": 1.0,\n            \"genes\": [\n                (0,0,1),(1,1,0),(2,2,1),\n                (1,0,0),(0,1,1),(1,2,0),\n            ],\n        },\n        {\n            \"theta\": 2.0, \"epsilon\": 0.2, \"sB\": 5.0, \"sA\": 1.0,\n            \"genes\": [\n                (6,4,0),(7,5,0),(10,0,1),(8,1,1),\n                (12,0,1),(5,3,1),(1,2,0),(9,0,1),\n            ],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        theta = case[\"theta\"]\n        epsilon = case[\"epsilon\"]\n        sB = case[\"sB\"]\n        sA = case[\"sA\"]\n        genes = case[\"genes\"]\n\n        b_idx, a_idx, x_b, x_a = classify_genes(genes, theta, epsilon, sB, sA)\n        n_b = len(b_idx)\n        n_a = len(a_idx)\n        pval = enrichment_p_value(n_b, x_b, n_a, x_a)\n        # Round p-value to exactly 6 digits after decimal\n        pval_str = f\"{pval:.6f}\"\n        # Prepare result list: [N_B, N_A, p]\n        results.append([n_b, n_a, pval_str])\n\n    # Final print statement in the exact required format.\n    # Ensure p-values remain as decimals and not re-cast to float with scientific notation.\n    out_items = []\n    for res in results:\n        n_b, n_a, p = res\n        out_items.append(f\"[{n_b},{n_a},{p}]\")\n    print(f\"[{','.join(out_items)}]\")\n\nsolve()\n```", "id": "2703240"}]}