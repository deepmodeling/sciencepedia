{"hands_on_practices": [{"introduction": "Simple heuristics are often the first tools applied in bioinformatics, but understanding their limitations is crucial for rigorous science. The Best Reciprocal Hit (BRH) method is a widely used heuristic for identifying putative orthologs, yet it can fail under common evolutionary scenarios. This practice challenges you to dissect a classic failure case caused by asymmetric rates of evolution, where a fast-evolving ortholog appears more distant than a slow-evolving out-paralog [@problem_id:2715922]. Mastering this concept provides the foundational justification for employing more sophisticated, phylogeny-based methods for orthology inference.", "problem": "You are given the following background facts as the foundation for reasoning. Orthologs are pairs of genes in different species whose last common ancestor is a speciation event (Fitch definition), whereas paralogs are pairs whose last common ancestor is a gene duplication event. Under homogeneous rates of sequence evolution, higher sequence similarity (e.g., higher bit-score or lower $E$-value) approximately reflects a shorter evolutionary path (fewer expected substitutions per site) between two sequences. The best reciprocal hit (BRH) heuristic between two species is widely used to identify putative orthologs using pairwise similarity searches.\n\nConsider an unknown researcher who claims that BRH always retrieves true orthologs when comparing two species, and that rate asymmetry cannot cause errors. You want to assess this claim by selecting the option that both (i) correctly defines the BRH heuristic and (ii) provides a specific, scientifically plausible counterexample in which rate asymmetry causes BRH to fail to retrieve the true orthologs.\n\nWhich option best satisfies both (i) and (ii)?\n\nA. BRH definition: For two species $S_1$ and $S_2$, genes $g \\in S_1$ and $h \\in S_2$ form a BRH pair if $h = \\arg\\max_{x \\in S_2} f(g,x)$ and $g = \\arg\\max_{y \\in S_1} f(y,h)$, where $f$ is a similarity score such as bit-score or the negative of the $E$-value. Counterexample: A single ancestral gene duplicates at time $t_d = 1.5$ (measured in the same time units as branch lengths), creating duplicates $X$ and $Y$. A speciation occurs later at time $t_s = 1.0$, yielding species $A$ and $B$. Species $A$ retains only $X$ (call it $a$). Species $B$ retains both $X$ (call it $b_X$) and $Y$ (call it $b_Y$). Substitution rates (per site per unit time) are as follows: along $A$’s $X$ lineage after speciation, $\\mu_{A,X} = 1.0$; along $B$’s $X$ lineage after speciation, $\\mu_{B,X} = 2.0$ (accelerated); along $B$’s $Y$ lineage after speciation, $\\mu_{B,Y} = 0.1$ (slow); along the ancestral pre-speciation branches from duplication to speciation, $\\mu_{\\text{anc}} = 0.5$. Under a Poisson model, the expected pairwise divergence between $a$ and $b_X$ (orthologs) is $d(a,b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = 1.0 \\cdot 1.0 + 2.0 \\cdot 1.0 = 3.0$. The expected divergence between $a$ and $b_Y$ (out-paralogs, last common ancestor at the duplication) is $d(a,b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) = 1.0 \\cdot 1.0 + 0.1 \\cdot 1.0 + 2 \\cdot 0.5 \\cdot (1.5 - 1.0) = 1.6$. Because $1.6 < 3.0$, $f(a,b_Y) > f(a,b_X)$, so the best hit of $a$ in $B$ is $b_Y$. In the reverse search from $B$ to $A$, both $b_X$ and $b_Y$ have their best hit in $A$ as $a$, but only $b_Y$ forms a reciprocal best hit with $a$. Thus BRH returns $(a,b_Y)$, which are out-paralogs, failing to retrieve the true ortholog $(a,b_X)$ due to rate asymmetry.\n\nB. BRH definition: The BRH pair between two species are the two genes with the highest overall similarity across both proteomes after removing lineage-specific paralogs. Counterexample: A gene duplicates in species $B$ after speciation at time $t_s = 1.0$, producing $b_1$ and $b_2$ with rates $\\mu_{B,1} = 2.0$ and $\\mu_{B,2} = 0.1$, while species $A$ has a single ortholog $a$ with $\\mu_{A} = 1.0$. Because $b_2$ is slow, the reciprocal best hits are $(a,b_2)$, which are paralogs rather than orthologs; hence BRH fails due to rate asymmetry.\n\nC. BRH definition: Two genes from different species are reciprocal best hits if they are each other’s highest-scoring local alignments under a fixed scoring scheme. Counterexample: A duplication before speciation yields $X$ in $A$ and $X$ and $Y$ in $B$, with equal post-speciation rates $\\mu_{A,X} = \\mu_{B,X} = \\mu_{B,Y} = 1.0$ and $\\mu_{\\text{anc}} = 0.5$, $t_d = 1.5$, $t_s = 1.0$. Orthologous divergence $d(a,b_X) = 2.0$, paralogous divergence $d(a,b_Y) = 3.0$. Because $d(a,b_X) < d(a,b_Y)$, the reciprocal best hits recover the orthologs, showing that BRH fails under rate asymmetry.\n\nD. BRH definition: In a three-species comparison, three genes are BRHs if they maximize a triangle inequality on pairwise similarities. Counterexample: Long-branch attraction during phylogenetic tree reconstruction makes the wrong leaves cluster, so BRH must also fail from the same artifact, regardless of rates or duplication times.", "solution": "The problem statement is subjected to validation.\n\n**1. Extraction of Givens:**\n- Definition of orthologs: Genes in different species whose last common ancestor is a speciation event.\n- Definition of paralogs: Genes whose last common ancestor is a gene duplication event.\n- Relationship between similarity and distance: Higher sequence similarity reflects a shorter evolutionary path (fewer expected substitutions).\n- Best Reciprocal Hit (BRH): A heuristic for identifying putative orthologs from pairwise similarity searches.\n- The problem posits a claim by a hypothetical researcher that BRH is infallible and immune to errors from rate asymmetry.\n- The task is to select an option that fulfills two criteria: (i) provides a correct definition of the BRH heuristic, and (ii) presents a scientifically sound counterexample where rate asymmetry causes BRH to fail in identifying true orthologs.\n\n**2. Validation:**\n- **Scientific Grounding:** The definitions of orthology and paralogy are the standard Fitch definitions used in molecular evolution. The inverse relationship between sequence similarity and evolutionary distance is a cornerstone of bioinformatics. The proposition that BRH can fail, particularly due to asymmetric evolutionary rates leading to misidentification of out-paralogs (a phenomenon sometimes called \"hidden paralogy\"), is a well-documented issue in computational biology. The problem is therefore scientifically sound.\n- **Well-Posedness:** The problem is well-posed. It requires the identification of an option that satisfies two clear and distinct criteria. The scenario to be evaluated—gene duplication, speciation, differential gene loss, and rate asymmetry—is the canonical model for studying this exact problem.\n- **Objectivity:** The problem is stated objectively and uses precise, standard terminology from the field of evolutionary biology.\n\n**3. Verdict:**\nThe problem statement is valid. It is scientifically rigorous, well-posed, and directly addresses a key conceptual challenge in orthology detection. We may proceed to the solution.\n\n**Solution Derivation:**\nThe task is to evaluate each option against two criteria: a correct definition of the Best Reciprocal Hit (BRH) heuristic and a valid counterexample illustrating its failure due to rate asymmetry. A valid counterexample must describe a scenario where, due to unequal rates of evolution following a gene duplication and speciation, the BRH pair consists of out-paralogs instead of the true orthologs.\n\nThe canonical scenario for this failure involves a gene duplication in a common ancestor, followed by speciation, and then differential gene loss and rate heterogeneity in the descendant lineages. Let there be an ancestral gene that duplicates at time $t_d$ into copies $X$ and $Y$. A speciation event occurs at a later time $t_s < t_d$, creating species $S_1$ and $S_2$. Suppose $S_1$ loses the copy derived from $Y$, retaining only gene $a$ (from $X$). Suppose $S_2$ retains both copies, $b_X$ (from $X$) and $b_Y$ (from $Y$).\n- The true orthologs are $(a, b_X)$, as their last common ancestor is the speciation event.\n- The genes $a$ and $b_Y$ are out-paralogs, as their last common ancestor is the duplication event.\n- Evolutionary distance, $d$, is the total number of expected substitutions along the path connecting two genes in the gene tree. $d \\propto \\sum (\\text{rate} \\times \\text{time})$.\n- Similarity, $f$, is inversely related to distance: if $d_1 < d_2$, then $f_1 > f_2$.\n- BRH fails if it identifies $(a, b_Y)$ as the orthologs. This occurs if $b_Y$ is the best hit for $a$ in $S_2$ (i.e., $f(a, b_Y) > f(a, b_X)$) and $a$ is the best hit for $b_Y$ in $S_1$ (which is trivially true if $a$ is the only gene). The condition simplifies to $d(a, b_Y) < d(a, b_X)$.\n\nThe distance between the orthologs $(a, b_X)$ is the sum of divergences along the two lineages from the speciation node:\n$$d(a, b_X) = \\mu_{1,X} t_s + \\mu_{2,X} t_s$$\nThe distance between the out-paralogs $(a, b_Y)$ is the sum of divergences along the path from $a$ to the duplication node and back down to $b_Y$:\n$$d(a, b_Y) = \\mu_{1,X} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) + \\mu_{2,Y} t_s$$\nwhere $\\mu_{i,G}$ is the rate for gene $G$ in species $i$ post-speciation and $\\mu_{\\text{anc}}$ is the rate on the ancestral branches between duplication and speciation. BRH fails if a high rate for the true ortholog (e.g., large $\\mu_{2,X}$) and a low rate for the out-paralog (e.g., small $\\mu_{2,Y}$) cause $d(a, b_Y) < d(a, b_X)$.\n\n**Evaluation of Options:**\n\n**A. BRH definition: For two species $S_1$ and $S_2$, genes $g \\in S_1$ and $h \\in S_2$ form a BRH pair if $h = \\arg\\max_{x \\in S_2} f(g,x)$ and $g = \\arg\\max_{y \\in S_1} f(y,h)$, where $f$ is a similarity score such as bit-score or the negative of the $E$-value. Counterexample: A single ancestral gene duplicates at time $t_d = 1.5$ (measured in the same time units as branch lengths), creating duplicates $X$ and $Y$. A speciation occurs later at time $t_s = 1.0$, yielding species $A$ and $B$. Species $A$ retains only $X$ (call it $a$). Species $B$ retains both $X$ (call it $b_X$) and $Y$ (call it $b_Y$). Substitution rates (per site per unit time) are as follows: along $A$’s $X$ lineage after speciation, $\\mu_{A,X} = 1.0$; along $B$’s $X$ lineage after speciation, $\\mu_{B,X} = 2.0$ (accelerated); along $B$’s $Y$ lineage after speciation, $\\mu_{B,Y} = 0.1$ (slow); along the ancestral pre-speciation branches from duplication to speciation, $\\mu_{\\text{anc}} = 0.5$. Under a Poisson model, the expected pairwise divergence between $a$ and $b_X$ (orthologs) is $d(a,b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = 1.0 \\cdot 1.0 + 2.0 \\cdot 1.0 = 3.0$. The expected divergence between $a$ and $b_Y$ (out-paralogs, last common ancestor at the duplication) is $d(a,b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) = 1.0 \\cdot 1.0 + 0.1 \\cdot 1.0 + 2 \\cdot 0.5 \\cdot (1.5 - 1.0) = 1.6$. Because $1.6 < 3.0$, $f(a,b_Y) > f(a,b_X)$, so the best hit of $a$ in $B$ is $b_Y$. In the reverse search from $B$ to $A$, both $b_X$ and $b_Y$ have their best hit in $A$ as $a$, but only $b_Y$ forms a reciprocal best hit with $a$. Thus BRH returns $(a,b_Y)$, which are out-paralogs, failing to retrieve the true ortholog $(a,b_X)$ due to rate asymmetry.**\n\n- **Analysis of Definition:** The definition provided, $h = \\arg\\max_{x \\in S_2} f(g,x)$ and $g = \\arg\\max_{y \\in S_1} f(y,h)$, is the precise, formal definition of the Best Reciprocal Hit heuristic. It is correct.\n- **Analysis of Counterexample:** The scenario matches the canonical model for BRH failure. The true orthologs are $(a, b_X)$ and the out-paralogs are $(a, b_Y)$. The calculation of the evolutionary distances is performed correctly based on the provided parameters.\n  - Ortholog distance: $d(a, b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = (1.0 \\times 1.0) + (2.0 \\times 1.0) = 3.0$.\n  - Out-paralog distance: $d(a, b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2\\mu_{\\text{anc}}(t_d - t_s) = (1.0 \\times 1.0) + (0.1 \\times 1.0) + 2(0.5)(1.5 - 1.0) = 1.0 + 0.1 + 1.0(0.5) = 1.6$.\nThe calculations are correct. Since $d(a, b_Y) = 1.6 < d(a, b_X) = 3.0$, the similarity $f(a, b_Y)$ will be greater than $f(a, b_X)$. Thus, the best hit of $a$ in species $B$ is the out-paralog $b_Y$. The reverse search from any gene in $B$ to the single-gene proteome of $A$ will always return $a$ as the best hit. Therefore, $(a, b_Y)$ forms a BRH pair. This is a false positive for orthology. The failure is directly caused by rate asymmetry: the ortholog $b_X$ evolved fast ($\\mu_{B,X} = 2.0$) while the paralog $b_Y$ evolved slow ($\\mu_{B,Y} = 0.1$), making the paralog appear more closely related. The counterexample is specific, scientifically plausible, and mathematically sound.\n- **Verdict:** Correct.\n\n**B. BRH definition: The BRH pair between two species are the two genes with the highest overall similarity across both proteomes after removing lineage-specific paralogs. Counterexample: A gene duplicates in species $B$ after speciation at time $t_s = 1.0$, producing $b_1$ and $b_2$ with rates $\\mu_{B,1} = 2.0$ and $\\mu_{B,2} = 0.1$, while species $A$ has a single ortholog $a$ with $\\mu_{A} = 1.0$. Because $b_2$ is slow, the reciprocal best hits are $(a,b_2)$, which are paralogs rather than orthologs; hence BRH fails due to rate asymmetry.**\n\n- **Analysis of Definition:** This definition is incorrect and muddled. BRH identifies multiple pairs, not \"the\" pair with \"highest overall similarity\". The instruction to remove paralogs *before* the search is circular reasoning, as distinguishing orthologs from paralogs is the goal.\n- **Analysis of Counterexample:** The scenario describes a post-speciation duplication. Gene $a$ in species $A$ is co-orthologous to both $b_1$ and $b_2$ in species $B$; the genes $b_1$ and $b_2$ are in-paralogs. The statement that $(a, b_2)$ are \"paralogs rather than orthologs\" is a fundamental error. Their last common ancestor is the speciation node, so they are, by definition, orthologs. BRH correctly identifies an orthologous relationship, $(a, b_2)$. The issue here is the one-to-many orthology that BRH cannot fully capture, not a failure to distinguish orthologs from paralogs.\n- **Verdict:** Incorrect.\n\n**C. BRH definition: Two genes from different species are reciprocal best hits if they are each other’s highest-scoring local alignments under a fixed scoring scheme. Counterexample: A duplication before speciation yields $X$ in $A$ and $X$ and $Y$ in $B$, with equal post-speciation rates $\\mu_{A,X} = \\mu_{B,X} = \\mu_{B,Y} = 1.0$ and $\\mu_{\\text{anc}} = 0.5$, $t_d = 1.5$, $t_s = 1.0$. Orthologous divergence $d(a,b_X) = 2.0$, paralogous divergence $d(a,b_Y) = 3.0$. Because $d(a,b_X) < d(a,b_Y)$, the reciprocal best hits recover the orthologs, showing that BRH fails under rate asymmetry.**\n\n- **Analysis of Definition:** This definition is informal but acceptable, as it captures the essence of the BRH procedure using BLAST or similar tools.\n- **Analysis of Counterexample:** This example explicitly uses *equal* post-speciation rates, not rate asymmetry. It therefore fails to address a key requirement of the problem. Moreover, its logic is self-contradictory. It calculates (with an error, the correct $d(a,b_Y)$ is 2.5) that the orthologs are more similar ($d(a,b_X) < d(a,b_Y)$) and states that BRH correctly recovers them, but then concludes this \"showing that BRH fails\". The reasoning is nonsensical.\n- **Verdict:** Incorrect.\n\n**D. BRH definition: In a three-species comparison, three genes are BRHs if they maximize a triangle inequality on pairwise similarities. Counterexample: Long-branch attraction during phylogenetic tree reconstruction makes the wrong leaves cluster, so BRH must also fail from the same artifact, regardless of rates or duplication times.**\n\n- **Analysis of Definition:** The definition is completely incorrect. BRH is a pairwise method for two species. The description refers to a different, multi-species heuristic and misuses the term \"triangle inequality\".\n- **Analysis of Counterexample:** This is not a specific counterexample but a flawed argument by analogy. Long-branch attraction is an artifact of tree reconstruction methods, which is mechanistically distinct from the pairwise comparison logic of BRH. While related by the shared cause of rate heterogeneity, one does not directly imply the other in this manner. The claim that this happens \"regardless of rates\" is false; these failures are critically dependent on specific rate configurations.\n- **Verdict:** Incorrect.\n\n**Final Conclusion:**\nOption A is the only one that provides both a correct, formal definition of the BRH heuristic and a valid, specific, and correctly calculated counterexample demonstrating the failure of BRH to distinguish an out-paralog from a true ortholog due to asymmetric rates of evolution.", "answer": "$$\\boxed{A}$$", "id": "2715922"}, {"introduction": "After establishing that gene duplications can confound evolutionary analyses, the next practical step is learning how to detect and quantify them from genomic data. This exercise moves from conceptual theory to hands-on quantitative skill-building by asking you to infer a gene's integer copy number from short-read sequencing data [@problem_id:2715826]. You will apply a Bayesian framework that models read depth using a Poisson distribution, while also accounting for common systematic biases like GC content and mappability, a foundational technique in modern genomics and copy number variation analysis.", "problem": "Copy number changes after gene duplication create distinct paralogs, and inferring the integer copy number of a duplicated gene from short-read sequencing depth must account for sequence composition and mapping properties. Suppose a gene has unknown integer copy number $C \\in \\{0,1,2,3,4\\}$ in a diploid genome. Sequencing reads are sampled approximately independently along the genome, and read depth in a fixed window is well-modeled by a Poisson sampling process with a mean proportional to the true copy number and modulated by Guanine-Cytosine (GC) content bias and mappability. You are given two non-overlapping windows inside the gene with the following calibrated single-copy baseline expectations and bias factors: for window $i \\in \\{1,2\\}$, the expected read count for a single-copy region under neutral conditions is $s_i$, the GC bias multiplier is $g_i$, and the mappability multiplier is $m_i$. The observed read counts in these windows are $r_1$ and $r_2$.\n\nData:\n- Window $1$: $s_1 = 25$, $g_1 = 0.8$, $m_1 = 0.9$, observed $r_1 = 57$.\n- Window $2$: $s_2 = 20$, $g_2 = 1.1$, $m_2 = 0.95$, observed $r_2 = 64$.\n\nAssume:\n- For a given copy number $C$, the expected read count in window $i$ is $\\mu_i(C) = C \\cdot s_i \\cdot g_i \\cdot m_i$.\n- Conditional on $C$, window counts are independent and follow a Poisson distribution with means $\\mu_i(C)$.\n- The prior on $C$ favors copy-number neutrality and is given by $\\Pr(C=k) \\propto \\exp\\!\\big(-\\alpha (k-2)^{2}\\big)$ for $k \\in \\{0,1,2,3,4\\}$, with $\\alpha = 0.2$.\n\nStarting from Bayes’ theorem and the Poisson sampling model, derive an expression for the posterior (up to a proportionality constant) over $C$. Then compute the Maximum A Posteriori (MAP) estimate, defined as the integer $C^{\\ast}$ that maximizes the posterior. Report the value of $C^{\\ast}$ as your final answer. No rounding is required because the answer is an integer.", "solution": "The problem requires us to find the Maximum A Posteriori (MAP) estimate of a gene's integer copy number, $C$, given observed read counts from two genomic windows. This is a standard problem in Bayesian inference.\n\nWe begin with Bayes' theorem, which states that the posterior probability of the parameter $C$ given the data (observed counts $r_1$ and $r_2$) is proportional to the product of the likelihood and the prior probability:\n$$\n\\Pr(C | r_1, r_2) \\propto \\Pr(r_1, r_2 | C) \\cdot \\Pr(C)\n$$\nThe problem states that, conditional on the copy number $C$, the read counts in the two windows are independent. Therefore, the joint likelihood $\\Pr(r_1, r_2 | C)$ is the product of the individual likelihoods:\n$$\n\\Pr(r_1, r_2 | C) = \\Pr(r_1 | C) \\cdot \\Pr(r_2 | C)\n$$\nThe read count $R_i$ in window $i$ is modeled by a Poisson distribution with mean $\\mu_i(C)$. The probability mass function (PMF) for observing $r_i$ reads is:\n$$\n\\Pr(R_i = r_i | C) = \\frac{\\mu_i(C)^{r_i} \\exp(-\\mu_i(C))}{r_i!}\n$$\nThe mean $\\mu_i(C)$ is given by the model $\\mu_i(C) = C \\cdot s_i \\cdot g_i \\cdot m_i$. For simplicity, let us define a composite parameter $\\lambda_i = s_i \\cdot g_i \\cdot m_i$, which represents the expected read count for a single copy ($C=1$) in window $i$. Thus, $\\mu_i(C) = C \\cdot \\lambda_i$.\n\nThe total likelihood is then:\n$$\n\\Pr(r_1, r_2 | C) = \\left( \\frac{(C \\lambda_1)^{r_1} \\exp(-C \\lambda_1)}{r_1!} \\right) \\cdot \\left( \\frac{(C \\lambda_2)^{r_2} \\exp(-C \\lambda_2)}{r_2!} \\right)\n$$\nThe prior distribution for $C=k$ is given as $\\Pr(C=k) \\propto \\exp(-\\alpha (k-2)^2)$ for $k \\in \\{0, 1, 2, 3, 4\\}$.\n\nCombining the likelihood and the prior, the posterior probability for $C=k$ is:\n$$\n\\Pr(C=k | r_1, r_2) \\propto \\left( \\frac{(k \\lambda_1)^{r_1} \\exp(-k \\lambda_1)}{r_1!} \\cdot \\frac{(k \\lambda_2)^{r_2} \\exp(-k \\lambda_2)}{r_2!} \\right) \\cdot \\exp(-\\alpha (k-2)^2)\n$$\nTo find the MAP estimate $C^{\\ast}$, we must find the value of $k$ that maximizes this expression. We can disregard any terms that do not depend on $k$, such as $r_1!$ and $r_2!$.\n$$\n\\Pr(C=k | r_1, r_2) \\propto (k \\lambda_1)^{r_1} (k \\lambda_2)^{r_2} \\exp(-k \\lambda_1 - k \\lambda_2 - \\alpha (k-2)^2)\n$$\nThis expression can be simplified by combining terms involving $k$:\n$$\n\\Pr(C=k | r_1, r_2) \\propto k^{r_1+r_2} \\lambda_1^{r_1} \\lambda_2^{r_2} \\exp(-k(\\lambda_1 + \\lambda_2) - \\alpha(k-2)^2)\n$$\nAgain, terms not depending on $k$ ($\\lambda_1^{r_1}$ and $\\lambda_2^{r_2}$) can be absorbed into the proportionality constant.\n$$\n\\Pr(C=k | r_1, r_2) \\propto k^{r_1+r_2} \\exp(-k(\\lambda_1 + \\lambda_2) - \\alpha(k-2)^2)\n$$\nThis is the final expression for the posterior probability, up to a normalization constant.\n\nTo find the maximum, it is numerically more stable and algebraically simpler to work with the log-posterior. Let $L(k)$ be the natural logarithm of the right-hand side.\n$$\nL(k) = (r_1+r_2)\\ln(k) - k(\\lambda_1 + \\lambda_2) - \\alpha(k-2)^2\n$$\nWe now substitute the given values into this expression. First, we compute the single-copy expectations $\\lambda_1$ and $\\lambda_2$:\n- Window $1$: $\\lambda_1 = s_1 g_1 m_1 = 25 \\cdot 0.8 \\cdot 0.9 = 18.0$\n- Window $2$: $\\lambda_2 = s_2 g_2 m_2 = 20 \\cdot 1.1 \\cdot 0.95 = 20.9$\n\nThe remaining data are:\n- $r_1 = 57$, $r_2 = 64$, so $r_1+r_2 = 121$.\n- $\\alpha = 0.2$.\n\nSubstituting these values into the log-posterior function $L(k)$:\n$$\nL(k) = 121 \\ln(k) - k(18.0 + 20.9) - 0.2(k-2)^2 = 121 \\ln(k) - 38.9k - 0.2(k-2)^2\n$$\nWe must now evaluate $L(k)$ for each possible integer value of $C=k$ in the set $\\{0, 1, 2, 3, 4\\}$.\n\n- For $k=0$: The term $\\ln(0)$ is undefined, which corresponds to a posterior probability of $0$. This is logical, as observing non-zero read counts ($r_1=57$, $r_2=64$) is impossible if the copy number is zero. The likelihood is exactly $0$, so the posterior is $0$.\n\n- For $k=1$:\n$$\nL(1) = 121 \\ln(1) - 38.9(1) - 0.2(1-2)^2 = 121 \\cdot 0 - 38.9 - 0.2(-1)^2 = -38.9 - 0.2 = -39.1\n$$\n\n- For $k=2$:\n$$\nL(2) = 121 \\ln(2) - 38.9(2) - 0.2(2-2)^2 = 121 \\ln(2) - 77.8 - 0.2(0)^2 \\approx 121(0.6931) - 77.8 \\approx 83.87 - 77.8 = 6.07\n$$\n\n- For $k=3$:\n$$\nL(3) = 121 \\ln(3) - 38.9(3) - 0.2(3-2)^2 = 121 \\ln(3) - 116.7 - 0.2(1)^2 = 121 \\ln(3) - 116.9 \\approx 121(1.0986) - 116.9 \\approx 132.93 - 116.9 = 16.03\n$$\n\n- For $k=4$:\n$$\nL(4) = 121 \\ln(4) - 38.9(4) - 0.2(4-2)^2 = 121(2\\ln(2)) - 155.6 - 0.2(2)^2 = 242\\ln(2) - 155.6 - 0.8 = 242\\ln(2) - 156.4 \\approx 242(0.6931) - 156.4 \\approx 167.73 - 156.4 = 11.33\n$$\n\nComparing the values of the log-posterior $L(k)$:\n- $L(1) = -39.1$\n- $L(2) \\approx 6.07$\n- $L(3) \\approx 16.03$\n- $L(4) \\approx 11.33$\n\nThe maximum value of the log-posterior occurs at $k=3$. Therefore, the Maximum A Posteriori (MAP) estimate for the copy number $C$ is $3$.\nThis result is driven by the strong evidence from the likelihood, where the observed read counts ($57$ and $64$) are approximately $3$ times the baseline single-copy expectations ($18.0$ and $20.9$). This evidence outweighs the prior's slight preference for the neutral copy number $C=2$.\n\nThe MAP estimate is $C^{\\ast} = \\arg\\max_{k \\in \\{0,1,2,3,4\\}} L(k) = 3$.", "answer": "$$\\boxed{3}$$", "id": "2715826"}, {"introduction": "This final practice integrates your knowledge into a realistic research scenario, challenging you to think like a critical scientist evaluating a published claim. You are presented with a study reporting positive selection that may be an artifact of hidden paralogy, a situation where erroneously mixed orthologs and paralogs inflate estimates of the nonsynonymous-to-synonymous substitution rate ratio, $\\omega$ [@problem_id:2715891]. Your task is to diagnose the potential flaw and propose a robust phylogenomic workflow to correct the analysis, a crucial skill for conducting and interpreting research in comparative and evolutionary genomics.", "problem": "A published comparative study tested for elevated nonsynonymous over synonymous substitution rates across species for a single-copy gene family $G$ and reported evidence for positive selection. The authors sampled $S=8$ mammals, identified putative orthologs by reciprocal best hits using the Basic Local Alignment Search Tool (BLAST; reciprocal best hit (RBH) criterion with $E<10^{-5}$), retained one sequence per species (total $n=8$), generated a codon alignment, and estimated the ratio of nonsynonymous to synonymous substitution rates $\\omega=d_{N}/d_{S}$. A likelihood ratio test (LRT) reported $\\hat{\\omega}=1.3$ and a $p$-value $p=0.01$. Subsequent inspection of the genomes indicates that in $k=3$ of the $S=8$ species, there are $2$ tandemly duplicated copies of $G$ separated by less than $10$ kilobases, and the RBH procedure appears to have chosen among these duplicates inconsistently across species.\n\nStarting from core definitions in molecular evolution and phylogenomics—namely, that orthologs are homologous genes related by speciation, paralogs are homologous genes related by duplication, and that $\\omega=d_{N}/d_{S}$ is interpreted as purifying selection when $\\omega<1$, neutrality when $\\omega\\approx 1$, and positive selection when $\\omega>1$—propose how you would diagnose whether the originally reported signal of positive selection could be explained by hidden paralogy, and how you would correct the analysis before re-testing for selection. Your plan should be rooted in generally accepted practices for orthology inference and codon-model analysis, and should avoid assumptions that are invalid under gene duplication.\n\nWhich option(s) below most appropriately diagnose and correct hidden paralogy in this context before re-testing for positive selection? Select all that apply.\n\nA. Build a gene tree including all detected copies of $G$ from all $S=8$ species plus at least one outgroup to root the tree; reconcile this gene tree with a curated species tree to infer and time duplication events; identify and prune to a clade of $1$-$1$ orthologs by excluding branches descending from inferred duplication nodes; realign the retained orthologs with a codon-aware aligner and re-estimate $\\omega$ using a branch-site model restricted to the ortholog clade.\n\nB. Keep the original $n=8$ sequence set and alignment unchanged; replace the codon model with a nucleotide substitution model with $\\Gamma$-distributed rate variation across sites to account for heterogeneity, and re-run the same LRT without altering orthology assignments.\n\nC. For species with $2$ duplicates, select the copy with the smallest pairwise synonymous divergence $d_{S}$ to human, keep the original RBH picks for species with a single copy, then pool these $n=8$ sequences and re-estimate $\\omega$ as before.\n\nD. Examine the genomic neighborhood around $G$ across species for conserved synteny at $\\pm 10$ genes to define co-linear putative $1$-$1$ orthologs; cross-validate this set with gene-tree–species-tree reconciliation to confirm that no duplication nodes lie within the chosen clade; restrict the selection analysis to this validated ortholog set, and apply appropriate multiple-testing correction if testing multiple branches or models.\n\nE. Concatenate all paralogous copies per species into a single supersequence for each species to preserve all substitutions, realign, and re-fit the codon model, which increases power to detect selection while avoiding orthology decisions.", "solution": "The problem statement describes a situation where an initial analysis reported positive selection ($\\hat{\\omega} = d_{N}/d_{S} = 1.3$) in a gene family $G$ across $S=8$ mammalian species. This conclusion was based on a set of putative orthologs identified using the Reciprocal Best Hit (RBH) method. However, subsequent investigation revealed that gene $G$ is not a single-copy gene in $k=3$ of the species; these species possess tandem duplicates. The RBH procedure, a pairwise method, is known to be unreliable in the presence of gene duplications and differential gene loss, and in this case, it is stated to have chosen inconsistently among the paralogs. This is a critical flaw.\n\nThe core issue is **hidden paralogy**. The set of $n=8$ sequences used in the original analysis is not a true set of orthologs (genes related by speciation events) but rather a mixture of orthologs and paralogs (genes related by duplication events). After a gene duplication, one of the resulting paralogs may be subject to relaxed purifying selection or undergo positive selection to acquire a new function (neofunctionalization). When such a fast-evolving paralog from one species is mistakenly compared to a conserved ortholog in another species, the rate of nonsynonymous substitutions can appear artificially high. This inflates the estimate of $\\omega$ for the entire gene tree, often leading to a false-positive signal of positive selection. This is a well-documented artifact in molecular evolution studies.\n\nA valid correction must therefore abandon the flawed pairwise RBH approach and instead use a phylogenetically-principled method to distinguish orthology from paralogy. The standard and most robust method to achieve this is to reconstruct the evolutionary history of the entire gene family. The key steps are:\n$1$. Collect all detectable homologous sequences for gene $G$ from the $S=8$ species and include at least one outgroup species.\n$2$. Build a phylogenetic tree for the gene family from a multiple sequence alignment of these sequences. An outgroup is required to root the tree, which establishes the direction of evolution.\n$3$. Reconcile the rooted gene tree with the known species phylogeny. This process involves mapping the gene tree onto the species tree to infer which nodes in the gene tree represent speciation events and which represent gene duplication events.\n$4$. Based on the reconciled tree, identify a set of true one-to-one ($1-1$) orthologs. This is typically a subclade of the gene tree that contains exactly one gene from each species, where all bifurcations within that subclade are speciation events. Any lineages descending from a duplication node must be pruned to obtain such a clean set.\n$5$. Using this validated set of orthologs, redo the selection analysis. This involves creating a new codon alignment and fitting appropriate codon-based models of evolution (e.g., branch-site models) to test for positive selection, now free from the confounding effects of paralogy.\n\nBased on this principled approach, we can evaluate the provided options.\n\n**A. Build a gene tree including all detected copies of $G$ from all $S=8$ species plus at least one outgroup to root the tree; reconcile this gene tree with a curated species tree to infer and time duplication events; identify and prune to a clade of $1$-$1$ orthologs by excluding branches descending from inferred duplication nodes; realign the retained orthologs with a codon-aware aligner and re-estimate $\\omega$ using a branch-site model restricted to the ortholog clade.**\nThis option meticulously follows the standard, robust, and generally accepted phylogenetic workflow for resolving issues of hidden paralogy. It correctly prescribes ($1$) collecting all homologs, ($2$) building a rooted gene tree, ($3$) reconciling the gene and species trees to identify duplications, ($4$) pruning to a clean set of $1-1$ orthologs, and ($5$) re-running a proper selection analysis (using a codon-aware aligner and a powerful branch-site model) on the corrected dataset. This procedure directly addresses the root cause of the problem.\n**Verdict: Correct.**\n\n**B. Keep the original $n=8$ sequence set and alignment unchanged; replace the codon model with a nucleotide substitution model with $\\Gamma$-distributed rate variation across sites to account for heterogeneity, and re-run the same LRT without altering orthology assignments.**\nThis option is fundamentally flawed. Its primary mistake is to \"keep the original $n=8$ sequence set,\" which is known to be contaminated with paralogs. No statistical model, however complex, can correct for a dataset that misrepresents the true evolutionary relationships. Furthermore, replacing a codon model with a nucleotide substitution model is inappropriate for testing for positive selection on a protein's function, as the key metric $\\omega = d_{N}/d_{S}$ is a property of codon evolution, not nucleotide evolution. The $\\Gamma$-distributed rate variation accounts for rate heterogeneity among sites but does not solve the problem of including incorrect sequences (paralogs).\n**Verdict: Incorrect.**\n\n**C. For species with $2$ duplicates, select the copy with the smallest pairwise synonymous divergence $d_{S}$ to human, keep the original RBH picks for species with a single copy, then pool these $n=8$ sequences and re-estimate $\\omega$ as before.**\nThis option proposes a heuristic based on pairwise sequence divergence. While potentially better than random choice, it is not a principled phylogenetic method. It arbitrarily uses \"human\" as a reference, which may not be appropriate, and the assumption that the \"true\" ortholog has the lower $d_S$ is not guaranteed to be true. This method still avoids the crucial step of building a full gene tree to visualize and resolve all relationships simultaneously. It is another form of pairwise analysis, like RBH, and is susceptible to its own set of errors. It is not considered a robust or generally accepted practice for definitive orthology assignment.\n**Verdict: Incorrect.**\n\n**D. Examine the genomic neighborhood around $G$ across species for conserved synteny at $\\pm 10$ genes to define co-linear putative $1$-$1$ orthologs; cross-validate this set with gene-tree–species-tree reconciliation to confirm that no duplication nodes lie within the chosen clade; restrict the selection analysis to this validated ortholog set, and apply appropriate multiple-testing correction if testing multiple branches or models.**\nThis option describes an excellent and highly rigorous approach. It uses an independent line of evidence—conserved synteny (gene order)—to propose putative orthologs. True orthologs are more likely to be found in a conserved genomic context than are paralogs, especially recent tandem duplicates. Critically, it does not rely on synteny alone but \"cross-validates\" this hypothesis using the powerful gene-tree–species-tree reconciliation method. This combination of genomic location and sequence phylogeny provides very strong evidence for orthology. The subsequent steps of restricting the analysis to the validated set and applying appropriate statistical corrections are also correct. This represents a gold-standard approach in modern phylogenomics.\n**Verdict: Correct.**\n\n**E. Concatenate all paralogous copies per species into a single supersequence for each species to preserve all substitutions, realign, and re-fit the codon model, which increases power to detect selection while avoiding orthology decisions.**\nThis procedure is biologically nonsensical. Concatenating paralogs creates an artificial chimeric sequence that does not exist in nature and has no coherent evolutionary history. The assumptions of all phylogenetic and molecular evolution models would be violated. An alignment of such \"supersequences\" would be meaningless, and any resulting $\\omega$ estimate would be uninterpretable garbage. This approach does not \"avoid\" the orthology problem; it completely misunderstands it, leading to a fatally flawed analysis. The claim that this \"increases power\" is baseless.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{AD}$$", "id": "2715891"}]}