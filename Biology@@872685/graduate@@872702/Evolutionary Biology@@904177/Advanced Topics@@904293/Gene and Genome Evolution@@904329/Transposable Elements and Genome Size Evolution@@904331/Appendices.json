{"hands_on_practices": [{"introduction": "To understand how transposable elements (TEs) shape genomes, we must first answer a fundamental question: at what rate do new TE insertions become permanently fixed in a population? This exercise [@problem_id:2760153] guides you through a derivation from first principles in population genetics. By combining the rate of new TE insertions with the probability of fixation, you will determine the long-term substitution rate, a cornerstone of molecular evolution, specifically for the case where TEs are effectively neutral and their fate is governed primarily by genetic drift.", "problem": "Consider a large, randomly mating diploid population evolving under the Wright–Fisher model with effective population size $N_{e}$. A single transposable element (TE; transposable element) family generates new insertions at a per haploid genome rate $u$ per generation. Assume an infinite-sites approximation so that each TE insertion occurs at a previously unoccupied site, and linkage and interference among insertions can be ignored. Each new insertion has an additive fitness effect $s$ on carriers such that the relative fitness of a heterozygote with one copy of the new insertion is $1 - \\frac{s}{2}$ and of a homozygote is $1 - s$, with $|s| \\ll 1$. There is no excision or deletion of TE insertions.\n\nStarting from first principles in population genetics about mutation input and fixation probabilities in finite populations, identify the parameter regime in which selection on individual TE insertions is effectively neutral relative to genetic drift, and derive the expected long-term rate at which fixed TE insertions accumulate across the genome, measured as the expected number of newly fixed TE insertions per generation in the entire population, in the effectively neutral limit. Express your final answer as a closed-form analytic expression in terms of $u$ only. Do not include any inequalities in your final answer.", "solution": "The problem requires the derivation of the long-term rate of accumulation of fixed transposable elements (TEs) in a diploid population under the Wright–Fisher model, specifically in the limit where selection is effectively neutral. This rate, often denoted as the substitution rate $K$, is fundamentally determined by two quantities: the rate at which new mutations (in this case, TE insertions) arise in the entire population per generation, and the probability that a single such new mutation will eventually reach fixation (a frequency of $1$).\n\nFirst, we establish the total number of new TE insertions introduced into the population per generation. The population is diploid with an effective size of $N_{e}$, which means it comprises $2N_{e}$ haploid genomes. The problem states that new TE insertions occur at a rate of $u$ per haploid genome per generation. Therefore, the total rate of new TE insertions across the entire population, $\\mu_{total}$, is:\n$$ \\mu_{total} = 2N_{e}u $$\n\nNext, we must determine the probability of fixation, $P_{fix}$, for a single new TE insertion. The problem specifies an additive fitness model. Relative to a wild-type fitness of $1$, a heterozygote with one copy of the TE has fitness $1 - s/2$, and a homozygote with two copies has fitness $1 - s$. This corresponds to a model of genic selection where the TE-containing allele has a selective coefficient of $s_{het} = -s/2$ in heterozygotes, assuming the TE is deleterious ($s  0$).\n\nThe fixation probability of a new mutation with a selective effect $s_{het}$ in heterozygotes in a diploid population of size $N_{e}$ is given by Kimura's formula:\n$$ P_{fix} = \\frac{1 - \\exp(-2s_{het})}{1 - \\exp(-4N_{e}s_{het})} $$\nSubstituting our value of $s_{het} = -s/2$ into this general expression, we obtain:\n$$ P_{fix} = \\frac{1 - \\exp\\left(-2\\left(-\\frac{s}{2}\\right)\\right)}{1 - \\exp\\left(-4N_{e}\\left(-\\frac{s}{2}\\right)\\right)} = \\frac{1 - \\exp(s)}{1 - \\exp(2N_{e}s)} $$\nThis formula is valid for any value of $s$ and $N_{e}$.\n\nThe problem instructs us to proceed in the \"effectively neutral limit\". An allele behaves as effectively neutral when the magnitude of the force of selection is significantly smaller than the magnitude of the force of genetic drift. The strength of selection on a rare allele is determined by its effect in heterozygotes, $|s_{het}|$, while the strength of drift is on the order of $1/(2N_{e})$. The parameter that compares these two forces is $2N_{e}s_{het}$. The condition for effective neutrality is $|2N_{e}s_{het}| \\ll 1$. For this problem, the condition becomes:\n$$ \\left|2N_{e}\\left(-\\frac{s}{2}\\right)\\right| \\ll 1 \\implies |N_{e}s| \\ll 1 $$\nUnder this condition, the argument of the exponential in the denominator of the $P_{fix}$ formula, $2N_{e}s$, is small in magnitude. The problem also states that $|s| \\ll 1$, which ensures the argument of the exponential in the numerator is also small. We can therefore employ the Taylor series approximation $\\exp(x) \\approx 1 + x$ for small $|x|$.\n\nApplying this approximation to the numerator and denominator of our expression for $P_{fix}$:\n- The numerator becomes: $1 - \\exp(s) \\approx 1 - (1 + s) = -s$.\n- The denominator becomes: $1 - \\exp(2N_{e}s) \\approx 1 - (1 + 2N_{e}s) = -2N_{e}s$.\n\nThus, the fixation probability in the effectively neutral limit simplifies to:\n$$ P_{fix} \\approx \\frac{-s}{-2N_{e}s} = \\frac{1}{2N_{e}} $$\nThis result is consistent with the fundamental principle that the fixation probability of a strictly neutral mutation is equal to its initial frequency in the population, which is $1/(2N_{e})$ for a single copy in a diploid population of effective size $N_{e}$.\n\nFinally, the rate of accumulation of fixed TEs, $K$, is the product of the total mutation rate per population per generation and the fixation probability of each new mutation.\n$$ K = \\mu_{total} \\times P_{fix} $$\nSubstituting the expressions we derived:\n$$ K = (2N_{e}u) \\times \\left(\\frac{1}{2N_{e}}\\right) $$\nThe terms involving the effective population size, $2N_{e}$, cancel out, yielding the final result:\n$$ K = u $$\nThis demonstrates that in the effectively neutral limit, the rate of fixation of new TE insertions per generation for the entire population is simply equal to the rate of insertion per haploid genome. This is a classic result of the neutral theory of molecular evolution, showing that the substitution rate of neutral mutations is independent of population size.", "answer": "$$ \\boxed{u} $$", "id": "2760153"}, {"introduction": "While the fixation of individual elements is a key microevolutionary process, the overall size of a genome reflects a macroevolutionary balance. Genomes are not passive accumulators of TEs; they are dynamic systems subject to both DNA gain and DNA loss. In this practice [@problem_id:2760197], you will develop a simple but powerful balance model that treats genome size evolution like a budget, weighing the input from new TE insertions against the output from deletion processes. This exercise will allow you to define the critical threshold that separates genome expansion from contraction.", "problem": "A large eukaryotic genome contains many transposable elements (TE; transposable elements). Consider a minimal balance model for expected genome size change per generation driven by TE insertions and DNA loss. Let $n$ denote the number of active TE copies in the genome, $u$ the per-copy transposition rate per generation, $\\gamma$ the fraction of transposition events that result in a successful insertion that is retained in the germ line, $\\ell$ the mean insertion length in base pairs (bp; base pairs), and $\\delta$ the expected amount of DNA lost per generation due to small deletions and removal processes. Assume independence among TE copies and generations, and treat expectations linearly.\n\n1. From first principles, write the expected net change in genome size per generation, $\\Delta G$, as the difference between expected DNA added by successful insertions and expected DNA lost by deletion, in terms of $\\gamma$, $u$, $n$, $\\ell$, and $\\delta$.\n\n2. Define the critical loss rate $\\delta_{\\mathrm{crit}}$ as the value of $\\delta$ for which the expected net change satisfies $\\Delta G = 0$. Solve symbolically for $\\delta_{\\mathrm{crit}}$ in terms of $\\gamma$, $u$, $n$, and $\\ell$. Briefly state, in words or symbols, the condition for long-term expected genome expansion in terms of $\\delta$ and $\\delta_{\\mathrm{crit}}$.\n\n3. Using parameter values $\\gamma = 0.3$, $u = 1.0 \\times 10^{-4}$ per copy per generation, $n = 1200$, and $\\ell = 3000$ bp, compute the numerical value of $\\delta_{\\mathrm{crit}}$. Express the final value in base pairs per generation and round your answer to four significant figures. Provide only the numerical value as your final result; do not include units in the final boxed answer.", "solution": "1. The expected net change in genome size per generation, $\\Delta G$, is the difference between the expected total length of DNA added from new TE insertions and the expected total length of DNA lost.\n\nThe expected DNA loss per generation is given directly as the parameter $\\delta$.\n\nThe expected DNA gain per generation must be derived. We begin with a single active TE copy.\n- The rate of transposition for one copy is $u$ events per generation.\n- Not all transposition events lead to a stable insertion. The fraction of events that are successful and heritable is $\\gamma$.\n- Therefore, the rate of successful, heritable insertions per TE copy is the product $\\gamma u$.\n- Since there are $n$ active TE copies in the genome, and their activities are assumed to be independent, the total expected number of successful insertions per generation is the sum of the expectations for each copy, which is $n \\gamma u$.\n- Each successful insertion adds, on average, a length of $\\ell$ base pairs to the genome.\n- By the linearity of expectation, the total expected DNA added per generation is the product of the expected number of successful insertions and the mean length of each insertion.\n- Expected DNA added = $(n \\gamma u) \\times \\ell = n \\gamma u \\ell$.\n\nThe expected net change in genome size, $\\Delta G$, is the expected gain minus the expected loss:\n$$ \\Delta G = n \\gamma u \\ell - \\delta $$\n\n2. The critical loss rate, $\\delta_{\\mathrm{crit}}$, is defined as the value of $\\delta$ at which the expected net change in genome size is zero, i.e., $\\Delta G = 0$. Using the expression derived in the first part, we set up the equation:\n$$ n \\gamma u \\ell - \\delta_{\\mathrm{crit}} = 0 $$\nSolving this equation for $\\delta_{\\mathrm{crit}}$ is trivial:\n$$ \\delta_{\\mathrm{crit}} = n \\gamma u \\ell $$\nThis is the symbolic expression for the critical loss rate.\n\nLong-term expected genome expansion occurs when the net change in genome size is positive, which is the condition $\\Delta G > 0$. Substituting the expression for $\\Delta G$:\n$$ n \\gamma u \\ell - \\delta > 0 $$\nRecognizing that $n \\gamma u \\ell$ is the definition of $\\delta_{\\mathrm{crit}}$, we can write the condition for genome expansion in terms of $\\delta$ and $\\delta_{\\mathrm{crit}}$:\n$$ \\delta_{\\mathrm{crit}} > \\delta \\quad \\text{or equivalently} \\quad \\delta  \\delta_{\\mathrm{crit}} $$\nIn words, the genome is expected to expand if the rate of DNA loss from deletions is less than the rate of DNA gain from TE insertions.\n\n3. We are required to compute the numerical value of $\\delta_{\\mathrm{crit}}$ using the provided parameter values:\n- $n = 1200$\n- $\\gamma = 0.3$\n- $u = 1.0 \\times 10^{-4}$ per generation\n- $\\ell = 3000$ bp\n\nWe substitute these values into the expression for $\\delta_{\\mathrm{crit}}$:\n$$ \\delta_{\\mathrm{crit}} = n \\gamma u \\ell = (1200) \\times (0.3) \\times (1.0 \\times 10^{-4}) \\times (3000) $$\nThe calculation proceeds as follows:\n$$ \\delta_{\\mathrm{crit}} = (1.2 \\times 10^{3}) \\times (3 \\times 10^{-1}) \\times (1.0 \\times 10^{-4}) \\times (3 \\times 10^{3}) $$\n$$ \\delta_{\\mathrm{crit}} = (1.2 \\times 3 \\times 1.0 \\times 3) \\times 10^{(3 - 1 - 4 + 3)} $$\n$$ \\delta_{\\mathrm{crit}} = 10.8 \\times 10^{(1)} $$\n$$ \\delta_{\\mathrm{crit}} = 108 $$\nThe units are consistent, resulting in bp/generation. The problem requires the answer to be rounded to four significant figures. The exact integer value $108$ must be expressed with four significant figures, which is $108.0$.", "answer": "$$\\boxed{108.0}$$", "id": "2760197"}, {"introduction": "Theoretical models are powerful, but their real utility comes from connecting them to observable data. Our models of TE evolution depend on key parameters like the per-element transposition rate ($u$) and the strength of selection ($s$) against them. This final practice [@problem_id:2760164] shows how these abstract parameters can be estimated from real-world population data. By analyzing the statistical distribution of TE copy numbers among individuals, you will derive and apply estimators for $u$ and $s$, bridging the gap between population genetic theory and empirical genomics.", "problem": "You are given a population-genetic modeling task for a single transposable element (TE; Transposable Element) family under copy-and-paste dynamics in a randomly mating population with constant effective population size (Effective Population Size (N_e)). Assume the following well-tested base model that connects transposition, selection, drift, and the observed counts of TE copies per individual:\n\n- Within a generation, new TE copies are produced in each carrier genome as a Poisson process at per-genome rate $u$ per generation. The total TE copy number per individual is denoted by the nonnegative integer random variable $K$.\n- Selection reduces fitness multiplicatively with increasing copy number according to $w = \\exp(-s K)$, where $s \\ge 0$ is the per-copy selection coefficient.\n- Genetic drift is captured by a diffusion approximation with constant $N_e$ under weak selection and mutation.\n\nUnder these assumptions, and considering the latent per-genome Poisson rate $m$ that varies among individuals at stationarity due to the balance of transposition, selection, and drift, it is a standard result that $m$ is approximately Gamma-distributed with shape $\\alpha = 2 N_e u$ and rate $\\beta = 2 N_e s$. Conditional on $m$, the observed copy number is $K \\mid m \\sim \\mathrm{Poisson}(m)$. Marginally among carriers (individuals with at least one autonomous element capable of transposition), $K$ follows a Negative Binomial (Negative Binomial (NB)) distribution because it is a Poisson-Gamma mixture. The resulting moments among carriers are\n$$\n\\mu \\equiv \\mathbb{E}[K \\mid \\text{carrier}] = \\frac{\\alpha}{\\beta} = \\frac{u}{s}, \\quad\n\\sigma^2 \\equiv \\mathrm{Var}(K \\mid \\text{carrier}) = \\mu + \\frac{\\mu^2}{\\alpha} = \\frac{u}{s} + \\frac{u}{2 N_e s^2}.\n$$\nThis diffusion-approximation-based moment structure allows identification of $u$ and $s$ from the joint information of copy number among carriers and known $N_e$, provided that the sample variance among carriers exceeds the sample mean.\n\nYou observe, for each of several scenarios, the following summary statistics computed from a large cohort with known carrier status $C \\in \\{0,1\\}$ (where $C=1$ denotes a carrier of an autonomous element enabling ongoing transposition):\n- The sample mean $\\hat{\\mu}$ of $K$ among carriers ($C=1$),\n- The sample variance $\\hat{\\sigma}^2$ of $K$ among carriers ($C=1$),\n- The effective population size $N_e$ (assumed known),\n- The fraction of carriers in the cohort, $\\hat{f} \\in [0,1]$.\n\nYou may assume that non-carriers ($C=0$) have negligible ongoing transposition ($u \\approx 0$), so their copy number distribution is concentrated near $K=0$; inference of $u$ and $s$ therefore conditions on carriers and uses the diffusion-approximation-based moments above. All quantities here are dimensionless per generation; report all outputs as decimals.\n\nTask:\n- Derive estimators for $u$ and $s$ from the equalities above by eliminating $m$ and $\\alpha$. Your derivation must start from the fundamental model assumptions given in this statement and use only the moment relations stated.\n- Implement a program that, for each test case specified below, computes the estimates $(\\hat{u}, \\hat{s})$ using only $(\\hat{\\mu}, \\hat{\\sigma}^2, N_e)$ from carriers. If $\\hat{\\sigma}^2 \\le \\hat{\\mu}$, set both $\\hat{u}$ and $\\hat{s}$ to $\\mathrm{NaN}$ for that case.\n- Express each $\\hat{u}$ and $\\hat{s}$ as a decimal number rounded to six digits after the decimal point.\n\nTest Suite (each case is a tuple $(\\hat{\\mu}, \\hat{\\sigma}^2, N_e, \\hat{f})$):\n- Case 1 (general): $(20.0, 21.0, 1000, 0.70)$.\n- Case 2 (moderate overdispersion): $(10.0, 12.0, 500, 0.80)$.\n- Case 3 (near-Poisson limit at large $N_e$): $(10.0, 10.0001, 1000000, 0.95)$.\n- Case 4 (low mean, slight overdispersion): $(2.0, 2.00005, 100000, 0.60)$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the concatenated list of the results for all cases in order, formatted as a comma-separated list enclosed in square brackets. For each case, output $\\hat{u}$ followed by $\\hat{s}$. For example, an output with two cases would look like $[\\hat{u}_1,\\hat{s}_1,\\hat{u}_2,\\hat{s}_2]$.\n- For this problem with four cases, your program should therefore output $[\\hat{u}_1,\\hat{s}_1,\\hat{u}_2,\\hat{s}_2,\\hat{u}_3,\\hat{s}_3,\\hat{u}_4,\\hat{s}_4]$ with each entry rounded to six digits after the decimal point.", "solution": "The derivation of estimators for the transposition rate $u$ and the selection coefficient $s$ proceeds from the provided moment equations for the copy number $K$ among carriers. These equations are a result of a diffusion approximation to the dynamics of transposable elements under transposition, selection, and genetic drift. The latent per-genome transposition rate $m$ is assumed to follow a Gamma distribution, $m \\sim \\Gamma(\\alpha, \\beta)$, with shape $\\alpha = 2 N_e u$ and rate $\\beta = 2 N_e s$. The observed copy number $K$ conditioned on $m$ is Poisson-distributed, $K \\mid m \\sim \\mathrm{Poisson}(m)$. The marginal distribution of $K$ is therefore a Negative Binomial, for which the mean and variance are given as:\n$$\n\\mu = \\mathbb{E}[K \\mid \\text{carrier}] = \\frac{\\alpha}{\\beta}\n\\quad (1)\n$$\n$$\n\\sigma^2 = \\mathrm{Var}(K \\mid \\text{carrier}) = \\mu + \\frac{\\mu^2}{\\alpha}\n\\quad (2)\n$$\nHere, $\\mu$ and $\\sigma^2$ are the true mean and variance, and $N_e$ is the effective population size. Our goal is to find expressions for $u$ and $s$ in terms of $\\mu$, $\\sigma^2$, and $N_e$.\n\nFirst, substitute the given definitions $\\alpha = 2 N_e u$ and $\\beta = 2 N_e s$ into equation $(1)$:\n$$\n\\mu = \\frac{2 N_e u}{2 N_e s} = \\frac{u}{s}\n\\quad (3)\n$$\nThis equation directly relates the mean copy number to the ratio of the transposition rate and the selection coefficient.\n\nNext, we rearrange equation $(2)$ to solve for the shape parameter $\\alpha$:\n$$\n\\sigma^2 - \\mu = \\frac{\\mu^2}{\\alpha}\n$$\nProvided that $\\sigma^2  \\mu$, which signifies overdispersion relative to a Poisson distribution, we can write:\n$$\n\\alpha = \\frac{\\mu^2}{\\sigma^2 - \\mu}\n\\quad (4)\n$$\nThe condition $\\sigma^2  \\mu$ is necessary for $\\alpha$ to be positive, which is required for a valid Gamma distribution. If the sample variance does not exceed the sample mean, the model is inapplicable, and the parameters are undefined.\n\nNow, we equate the expression for $\\alpha$ in equation $(4)$ with its definition in terms of the fundamental parameters $u$ and $N_e$:\n$$\n2 N_e u = \\frac{\\mu^2}{\\sigma^2 - \\mu}\n$$\nSolving for $u$ yields the estimator for the transposition rate:\n$$\nu = \\frac{\\mu^2}{2 N_e (\\sigma^2 - \\mu)}\n\\quad (5)\n$$\nTo find the selection coefficient $s$, we rearrange equation $(3)$ to $s = u/\\mu$. Substituting the expression for $u$ from equation $(5)$ gives:\n$$\ns = \\frac{1}{\\mu} \\left( \\frac{\\mu^2}{2 N_e (\\sigma^2 - \\mu)} \\right) = \\frac{\\mu}{2 N_e (\\sigma^2 - \\mu)}\n\\quad (6)\n$$\nUsing the method of moments, we replace the population parameters $\\mu$ and $\\sigma^2$ with their sample estimates, $\\hat{\\mu}$ and $\\hat{\\sigma}^2$, to obtain the estimators $\\hat{u}$ and $\\hat{s}$:\n$$\n\\hat{u} = \\frac{\\hat{\\mu}^2}{2 N_e (\\hat{\\sigma}^2 - \\hat{\\mu})}\n$$\n$$\n\\hat{s} = \\frac{\\hat{\\mu}}{2 N_e (\\hat{\\sigma}^2 - \\hat{\\mu})}\n$$\nThese estimators are used for the computational task.\n\nThe implementation will consist of a function that takes as input the tuple $(\\hat{\\mu}, \\hat{\\sigma}^2, N_e)$. It first verifies the condition $\\hat{\\sigma}^2  \\hat{\\mu}$. If this condition is not met, the function returns Not-a-Number ($\\mathrm{NaN}$) for both $\\hat{u}$ and $\\hat{s}$, as specified. Otherwise, it calculates $\\hat{u}$ and $\\hat{s}$ using the derived formulas. The program will iterate through the provided test cases, compute the estimates for each, format them to six decimal places, and print the flattened list of results in the required format. The fraction of carriers, $\\hat{f}$, is extraneous information for this specific calculation and is correctly ignored.", "answer": "[0.200000,0.010000,0.050000,0.005000,0.500000,0.050000,0.400000,0.200000]", "id": "2760164"}]}