{"hands_on_practices": [{"introduction": "A spatial gradient in allele frequencies, known as a cline, is the quintessential signature of parapatric speciation. To analyze these patterns, we often employ mathematical functions like the hyperbolic tangent model, which provides a flexible description of the sigmoidal transition. This first exercise [@problem_id:2740352] invites you to delve into the mathematical properties of this fundamental model, connecting abstract calculus to the biologically meaningful concept of cline steepness, which is a direct reflection of the intensity of the evolutionary forces at play.", "problem": "In a one-dimensional parapatric contact zone, consider an allele-frequency cline maintained by the balance of dispersal and spatially varying selection. A widely used and empirically supported approximation for the equilibrium allele frequency as a function of position $x$ is the hyperbolic tangent cline\n$$\np(x) \\;=\\; \\frac{1}{2}\\Big[1+\\tanh\\!\\Big(\\frac{2(x-c)}{w}\\Big)\\Big],\n$$\nwhere $c$ is the cline center (the spatial location at which $p(x)=\\frac{1}{2}$) and $w0$ is a width parameter determined by dispersal and selection. Using only fundamental definitions from calculus and the hyperbolic functions $\\sinh$, $\\cosh$, and $\\tanh$, derive an exact analytic expression for the spatial gradient $\\frac{dp}{dx}$ and determine its maximum value at the cline center. Clearly justify why the maximum occurs at the center based on properties of the hyperbolic functions.\n\nProvide your final answer as a row matrix with the first entry equal to the exact expression for $\\frac{dp}{dx}$ in terms of $x$, $c$, and $w$, and the second entry equal to the exact value of the maximum gradient at the cline center. No numerical rounding is required, and no units are needed. Your answer must be given as exact closed-form expressions.", "solution": "The problem statement is scientifically sound, well-posed, and contains all necessary information. It represents a standard exercise in applying differential calculus to a well-known model in population genetics. The hyperbolic tangent cline is a correct and widely used approximation derived from more complex reaction-diffusion models. Therefore, the problem is valid and a solution will be provided.\n\nThe allele frequency as a function of spatial position $x$ is given by\n$$\np(x) = \\frac{1}{2}\\left[1+\\tanh\\left(\\frac{2(x-c)}{w}\\right)\\right]\n$$\nwhere $c$ is the cline center and $w  0$ is the width.\n\nThe objective is to derive the spatial gradient, $\\frac{dp}{dx}$, and determine its maximum value. We will use the chain rule for differentiation. Let the argument of the hyperbolic tangent be $u(x) = \\frac{2(x-c)}{w}$. Then $p(x) = \\frac{1}{2}(1 + \\tanh(u(x)))$.\n\nThe derivative of $p(x)$ with respect to $x$ is\n$$\n\\frac{dp}{dx} = \\frac{dp}{du} \\frac{du}{dx}\n$$\n\nFirst, we find the derivative of the inner function $u(x)$ with respect to $x$:\n$$\n\\frac{du}{dx} = \\frac{d}{dx}\\left(\\frac{2(x-c)}{w}\\right) = \\frac{d}{dx}\\left(\\frac{2x}{w} - \\frac{2c}{w}\\right) = \\frac{2}{w}\n$$\nNext, we find the derivative of $p$ with respect to $u$. This requires the derivative of $\\tanh(u)$. By definition, $\\tanh(u) = \\frac{\\sinh(u)}{\\cosh(u)}$. Using the quotient rule, we have:\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{\\frac{d}{du}(\\sinh(u))\\cosh(u) - \\sinh(u)\\frac{d}{du}(\\cosh(u))}{\\cosh^2(u)}\n$$\nUsing the fundamental definitions $\\frac{d}{du}(\\sinh(u)) = \\cosh(u)$ and $\\frac{d}{du}(\\cosh(u)) = \\sinh(u)$, this becomes:\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{\\cosh^2(u) - \\sinh^2(u)}{\\cosh^2(u)}\n$$\nApplying the fundamental hyperbolic identity $\\cosh^2(u) - \\sinh^2(u) = 1$, we simplify the expression:\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{1}{\\cosh^2(u)}\n$$\nNow, we can find $\\frac{dp}{du}$:\n$$\n\\frac{dp}{du} = \\frac{d}{du}\\left(\\frac{1}{2}(1 + \\tanh(u))\\right) = \\frac{1}{2}\\left(0 + \\frac{d}{du}(\\tanh(u))\\right) = \\frac{1}{2 \\cosh^2(u)}\n$$\nCombining these results using the chain rule gives the expression for the spatial gradient:\n$$\n\\frac{dp}{dx} = \\frac{dp}{du} \\frac{du}{dx} = \\left(\\frac{1}{2 \\cosh^2(u)}\\right) \\left(\\frac{2}{w}\\right) = \\frac{1}{w \\cosh^2(u)}\n$$\nSubstituting back the expression for $u(x)$, we obtain the first part of the answer, the spatial gradient:\n$$\n\\frac{dp}{dx} = \\frac{1}{w \\cosh^2\\left(\\frac{2(x-c)}{w}\\right)}\n$$\nTo find the maximum value of this gradient, we analyze the expression. The parameter $w$ is a positive constant. The value of $\\frac{dp}{dx}$ is therefore maximized when the term $\\cosh^2\\left(\\frac{2(x-c)}{w}\\right)$ is minimized.\n\nThe justification for the location of the maximum is based on the fundamental properties of the hyperbolic cosine function. The function $\\cosh(z)$ has a global minimum at $z=0$, with $\\cosh(0)=1$. For any non-zero real number $z$, $\\cosh(z)  1$. Consequently, the function $\\cosh^2(z)$ also has its global minimum value of $1^2 = 1$ at $z=0$.\n\nIn our case, the argument is $z = \\frac{2(x-c)}{w}$. To minimize the denominator, we must set this argument to zero:\n$$\n\\frac{2(x-c)}{w} = 0\n$$\nSince $w \\neq 0$, this implies $x-c=0$, or $x=c$. This proves that the maximum gradient occurs precisely at the cline center, $x=c$.\n\nTo find the maximum value of the gradient, we substitute $x=c$ into the expression for $\\frac{dp}{dx}$:\n$$\n\\left(\\frac{dp}{dx}\\right)_{\\text{max}} = \\frac{1}{w \\cosh^2\\left(\\frac{2(c-c)}{w}\\right)} = \\frac{1}{w \\cosh^2(0)}\n$$\nSince $\\cosh(0)=1$, the maximum value is:\n$$\n\\left(\\frac{dp}{dx}\\right)_{\\text{max}} = \\frac{1}{w \\cdot 1^2} = \\frac{1}{w}\n$$\nThis is the second part of the answer. The two results are the expression for the gradient and its maximum value.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{w \\cosh^{2}\\left(\\frac{2(x-c)}{w}\\right)}  \\frac{1}{w} \\end{pmatrix}}\n$$", "id": "2740352"}, {"introduction": "While theoretical models provide the language to describe clines, the real challenge lies in connecting them to empirical data. This practice [@problem_id:2740240] transitions from theory to application, guiding you through the process of fitting a cline model to genetic data collected from a hybrid zone. You will explore the robust statistical framework of maximum likelihood estimation to learn how to extract key biological parameters—the cline's center ($c$) and width ($w$)—directly from observed genotype counts, a core skill for any evolutionary biologist studying spatially structured populations.", "problem": "A unidimensional hybrid zone forms at a contact between diverging populations undergoing parapatric speciation, producing a spatial transition in allele frequency along a linear transect coordinate $x \\in \\mathbb{R}$. Consider a single biallelic locus with alleles $A$ and $a$. Assume that at position $x$ the allele $A$ has frequency modeled by the logistic cline\n$$\np(x)=\\frac{1}{1+e^{-4(x-c)/w}},\n$$\nwhere $c \\in \\mathbb{R}$ is the cline center and $w \\in \\mathbb{R}_{0}$ is the cline width. At $I$ sampled sites with coordinates $\\{x_i\\}_{i=1}^I$, you observe genotype counts $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$ with total $m_i=n_{AA,i}+n_{Aa,i}+n_{aa,i}$. Assume individuals are in Hardy–Weinberg Equilibrium (HWE) at each site, and that samples are independent across individuals and sites. Using as fundamental base the multinomial sampling model implied by HWE and independence, and the definition of maximum likelihood (ML), derive the form of the log-likelihood for $(c,w)$ from the genotype counts, obtain the score functions by applying the chain rule to $p(x_i)$, and state a principled computational strategy to obtain the ML estimates and their approximate standard errors.\n\nWhich option correctly specifies all of the following elements, consistent with the stated assumptions: (i) a valid log-likelihood for $(c,w)$ given the genotype counts, (ii) the derivatives $\\partial p_i/\\partial c$ and $\\partial p_i/\\partial w$ for $p_i=p(x_i)$, and (iii) an appropriate ML estimation strategy including parameter constraints and standard error quantification?\n\nA. The joint log-likelihood is\n$$\n\\ell(c,w)=\\sum_{i=1}^I\\Big[2\\,n_{AA,i}\\ln p_i+n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big)+2\\,n_{aa,i}\\ln(1-p_i)\\Big],\n$$\nwith $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$. The derivatives are\n$$\n\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=-\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\nThe score components are obtained by the chain rule,\n$$\n\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^I\\left[\\frac{2n_{AA,i}+n_{Aa,i}}{p_i}-\\frac{2n_{aa,i}+n_{Aa,i}}{1-p_i}\\right]\\frac{\\partial p_i}{\\partial \\theta},\\quad \\theta\\in\\{c,w\\}.\n$$\nMaximize $\\ell(c,w)$ numerically with $w0$ enforced (for example by reparameterizing $w=e^{\\gamma}$), using a twice-differentiable optimizer such as Newton–Raphson or a quasi-Newton method. Obtain approximate standard errors from the inverse observed information, that is the negative inverse Hessian of $\\ell(c,w)$ at the maximizer.\n\nB. The likelihood is based only on heterozygote counts, with log-likelihood\n$$\n\\ell(c,w)=\\sum_{i=1}^I n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big),\n$$\nand $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$. The derivatives are\n$$\n\\frac{\\partial p_i}{\\partial c}=+\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=+\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\nClosed-form ML estimates are obtained by setting the derivatives to zero, yielding $\\hat{c}$ equal to the mean of sites where $n_{Aa,i}$ is maximal and $\\hat{w}$ equal to the range of those sites.\n\nC. Collapse genotypes to allele counts $K_i=2n_{AA,i}+n_{Aa,i}$ and model $K_i\\sim\\mathrm{Binomial}(m_i,p_i)$, giving\n$$\n\\ell(c,w)=\\sum_{i=1}^I\\Big[K_i\\ln p_i+(m_i-K_i)\\ln(1-p_i)\\Big],\n$$\nwith $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$. The derivatives are\n$$\n\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=+\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\nUse unconstrained Newton–Raphson on $(c,w)$ and report standard errors from the curvature matrix.\n\nD. Treat observed allele frequencies $y_i=\\dfrac{2n_{AA,i}+n_{Aa,i}}{2m_i}$ as Gaussian with mean $p_i$ and variance $\\sigma^2/m_i$, and estimate $(c,w)$ by minimizing\n$$\n\\sum_{i=1}^I m_i\\big(y_i-p_i\\big)^2\n$$\nwith $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$. Standard errors follow from linear regression formulas, and no constraints on $w$ are required because the sum of squares is convex in $(c,w)$ near the solution.", "solution": "The problem statement poses a standard maximum likelihood estimation task in population genetics. We must validate its components before proceeding.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   The model for the frequency of allele $A$ at position $x$ is the logistic cline: $p(x)=\\frac{1}{1+e^{-4(x-c)/w}}$.\n-   Parameters to be estimated are the cline center $c \\in \\mathbb{R}$ and the cline width $w \\in \\mathbb{R}_{0}$.\n-   Data are genotype counts $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$ at $I$ sampled sites with coordinates $\\{x_i\\}_{i=1}^I$.\n-   The total number of individuals at site $i$ is $m_i=n_{AA,i}+n_{Aa,i}+n_{aa,i}$.\n-   Assumption $1$: Individuals are in Hardy–Weinberg Equilibrium (HWE) at each site $i$.\n-   Assumption $2$: Samples are independent across individuals and sites.\n-   The task is to derive the log-likelihood for $(c,w)$, the score functions, and a computational strategy for obtaining maximum likelihood (ML) estimates and their standard errors.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. The logistic cline is a canonical model for describing allele frequency transitions in hybrid zones. The assumption of HWE at each spatial location is a standard simplifying assumption in such models. The sampling model, based on independent multinomial samples at each site, is statistically conventional. The question is well-posed, asking for a derivation of a likelihood function and its associated estimation machinery, which is a textbook problem in statistical inference. The terminology is precise and objective. The setup is self-contained and consistent; the constraint $w0$ is physically meaningful, as width cannot be negative. There are no violations of scientific principles, logical inconsistencies, or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with the derivation and evaluation of the provided options.\n\n### Derivation and Option Analysis\n\n**1. Derivation of the Log-Likelihood Function**\n\nUnder the assumption of Hardy–Weinberg Equilibrium at each site $i$, the expected frequencies of genotypes $AA$, $Aa$, and $aa$ are $p_i^2$, $2p_i(1-p_i)$, and $(1-p_i)^2$ respectively, where $p_i = p(x_i)$. The observed counts $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$ for a sample size of $m_i$ individuals follow a multinomial distribution. The likelihood for a single site $i$, as a function of the parameters $(c,w)$ through $p_i$, is given by the multinomial probability mass function:\n$$ L_i(c,w) = \\frac{m_i!}{n_{AA,i}!n_{Aa,i}!n_{aa,i}!} (p_i^2)^{n_{AA,i}} (2p_i(1-p_i))^{n_{Aa,i}} ((1-p_i)^2)^{n_{aa,i}} $$\nDue to the independence of samples across sites, the total likelihood is the product of the likelihoods for each site: $L(c,w) = \\prod_{i=1}^I L_i(c,w)$. The log-likelihood, $\\ell(c,w) = \\ln L(c,w)$, is the sum of the individual log-likelihoods:\n$$ \\ell(c,w) = \\sum_{i=1}^I \\ln L_i(c,w) = \\sum_{i=1}^I \\left( \\ln\\left(\\frac{m_i!}{n_{AA,i}!n_{Aa,i}!n_{aa,i}!}\\right) + n_{AA,i}\\ln(p_i^2) + n_{Aa,i}\\ln(2p_i(1-p_i)) + n_{aa,i}\\ln((1-p_i)^2) \\right) $$\nFor the purpose of maximization with respect to $(c,w)$, we can drop terms that are constant, yielding the kernel of the log-likelihood:\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( 2n_{AA,i}\\ln p_i + n_{Aa,i}\\ln(2p_i(1-p_i)) + 2n_{aa,i}\\ln(1-p_i) \\right) $$\nThis expression is a valid log-likelihood function. It can be simplified. Using properties of logarithms:\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( 2n_{AA,i}\\ln p_i + n_{Aa,i}(\\ln 2 + \\ln p_i + \\ln(1-p_i)) + 2n_{aa,i}\\ln(1-p_i) \\right) $$\nAgain, dropping the constant term $\\sum_i n_{Aa,i}\\ln 2$:\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( (2n_{AA,i} + n_{Aa,i})\\ln p_i + (n_{Aa,i} + 2n_{aa,i})\\ln(1-p_i) \\right) $$\nThis is the log-likelihood for a set of independent binomial trials, where for each site $i$, we observe $K_i = 2n_{AA,i} + n_{Aa,i}$ copies of allele $A$ out of $2m_i$ total alleles. The allele counts are a sufficient statistic for $p_i$ under HWE.\n\n**2. Derivation of the Score Function Components**\n\nThe score function is the gradient of the log-likelihood. For a parameter $\\theta \\in \\{c,w\\}$, we use the chain rule: $\\frac{\\partial \\ell}{\\partial \\theta} = \\sum_{i=1}^I \\frac{\\partial \\ell}{\\partial p_i} \\frac{\\partial p_i}{\\partial \\theta}$.\nFrom the binomial form of the log-likelihood, the first term is:\n$$ \\frac{\\partial \\ell}{\\partial p_i} = \\frac{2n_{AA,i} + n_{Aa,i}}{p_i} - \\frac{n_{Aa,i} + 2n_{aa,i}}{1-p_i} $$\nNext, we need the derivatives of $p_i = p(x_i) = (1+e^{-z_i})^{-1}$ where $z_i = 4(x_i-c)/w$. The derivative of the logistic function is $\\frac{dp}{dz} = p(1-p)$.\nThe partial derivatives of $z_i$ are:\n$$ \\frac{\\partial z_i}{\\partial c} = \\frac{\\partial}{\\partial c} \\left(\\frac{4(x_i-c)}{w}\\right) = -\\frac{4}{w} $$\n$$ \\frac{\\partial z_i}{\\partial w} = \\frac{\\partial}{\\partial w} \\left(4(x_i-c)w^{-1}\\right) = -4(x_i-c)w^{-2} = -\\frac{4(x_i-c)}{w^2} $$\nApplying the chain rule for $\\partial p_i / \\partial \\theta$:\n$$ \\frac{\\partial p_i}{\\partial c} = \\frac{dp_i}{dz_i} \\frac{\\partial z_i}{\\partial c} = p_i(1-p_i) \\left(-\\frac{4}{w}\\right) = -\\frac{4}{w} p_i(1-p_i) $$\n$$ \\frac{\\partial p_i}{\\partial w} = \\frac{dp_i}{dz_i} \\frac{\\partial z_i}{\\partial w} = p_i(1-p_i) \\left(-\\frac{4(x_i-c)}{w^2}\\right) = -\\frac{4(x_i-c)}{w^2} p_i(1-p_i) $$\n\n**3. Computational Strategy for ML Estimation**\n\nThe log-likelihood function is non-linear in parameters $(c,w)$, so numerical optimization is required to find the MLEs $(\\hat{c}, \\hat{w})$. The parameter $w$ is constrained to be positive, $w0$. A standard method to handle such a constraint is to reparameterize, for example, by setting $w = e^{\\gamma}$ and performing unconstrained optimization over $(c, \\gamma) \\in \\mathbb{R}^2$. Suitable algorithms for smooth functions include second-derivative methods like Newton-Raphson or quasi-Newton methods (e.g., L-BFGS-B, which can also handle box constraints directly on $w$).\n\nAccording to standard ML theory, the variance-covariance matrix of the MLEs can be approximated by the inverse of the Fisher information matrix. This matrix can be estimated by the observed information matrix, which is the negative of the Hessian (matrix of second partial derivatives) of the log-likelihood, evaluated at the MLE:\n$$ \\mathrm{Cov}(\\hat{c}, \\hat{w}) \\approx \\left( - \\mathbf{H}_{\\ell}(\\hat{c}, \\hat{w}) \\right)^{-1} = \\begin{pmatrix} -\\frac{\\partial^2 \\ell}{\\partial c^2}  -\\frac{\\partial^2 \\ell}{\\partial c \\partial w} \\\\ -\\frac{\\partial^2 \\ell}{\\partial w \\partial c}  -\\frac{\\partial^2 \\ell}{\\partial w^2} \\end{pmatrix}_{(\\hat{c},\\hat{w})}^{-1} $$\nThe square roots of the diagonal elements of this inverse matrix provide the approximate standard errors for $\\hat{c}$ and $\\hat{w}$.\n\n### Evaluation of Options\n\n**Option A:**\n-   **(i) Log-likelihood**: The form given, $\\ell(c,w)=\\sum_{i=1}^I\\Big[2\\,n_{AA,i}\\ln p_i+n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big)+2\\,n_{aa,i}\\ln(1-p_i)\\Big]$, is the correct full multinomial log-likelihood, retaining the $\\ln 2$ term for heterozygotes. This is valid.\n-   The general form of the score function is also correct, derived using the chain rule on the log-likelihood function: $\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^I\\left[\\frac{2n_{AA,i}+n_{Aa,i}}{p_i}-\\frac{2n_{aa,i}+n_{Aa,i}}{1-p_i}\\right]\\frac{\\partial p_i}{\\partial \\theta}$, which matches my derivation of $\\sum_i (\\partial \\ell/\\partial p_i) (\\partial p_i/\\partial \\theta)$.\n-   **(ii) Derivatives**: The derivatives $\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i)$ and $\\frac{\\partial p_i}{\\partial w}=-\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i)$ are both correct as derived above.\n-   **(iii) Estimation Strategy**: The strategy proposed—numerical maximization using Newton-Raphson or quasi-Newton methods, enforcing $w0$ via reparameterization, and using the inverse observed information matrix (negative inverse Hessian) for standard errors—is the standard, correct, and principled approach for this problem.\n\n**Verdict for Option A:** Correct.\n\n**Option B:**\n-   **(i) Log-likelihood**: This option uses only heterozygote counts. This discards a large amount of information present in the homozygote counts and does not correspond to the maximum likelihood principle applied to the full dataset. It is an incorrect and inefficient method.\n-   **(ii) Derivatives**: Both derivatives, $\\partial p_i/\\partial c$ and $\\partial p_i/\\partial w$, have incorrect positive signs.\n-   **(iii) Estimation Strategy**: Proposes a non-existent closed-form solution and ad-hoc estimators. This is fundamentally incorrect; the problem requires numerical optimization.\n\n**Verdict for Option B:** Incorrect.\n\n**Option C:**\n-   **(i) Log-likelihood**: This option correctly identifies that the problem reduces to a binomial likelihood on allele counts $K_i=2n_{AA,i}+n_{Aa,i}$. However, it incorrectly specifies the number of \"failures\" as $m_i-K_i$ instead of the correct $2m_i-K_i$, since the total number of alleles is $2m_i$. This is a critical error in the formulation of the likelihood.\n-   **(ii) Derivatives**: The derivative $\\partial p_i/\\partial w$ has an incorrect positive sign.\n-   **(iii) Estimation Strategy**: It proposes unconstrained optimization, which is incorrect because it fails to enforce the necessary constraint $w0$.\n\n**Verdict for Option C:** Incorrect.\n\n**Option D:**\n-   **(i) Likelihood/Model**: This option abandons the multinomial sampling model specified in the problem statement in favor of a weighted non-linear least squares approach, assuming Gaussian errors for observed allele frequencies. This is a different statistical model, an approximation that is not what was requested.\n-   **(iii) Estimation Strategy**: It incorrectly claims that no constraint on $w$ is needed and that the objective function is convex. The problem is non-convex, and the constraint $w0$ is essential for the physical meaning of the parameter. The claim that standard errors can be obtained from \"linear regression formulas\" is patently false for a non-linear model.\n\n**Verdict for Option D:** Incorrect.\n\nBased on this analysis, only Option A provides a complete and correct description of the log-likelihood, the necessary derivatives, and the appropriate statistical procedure for estimation and inference as demanded by the problem.", "answer": "$$\\boxed{A}$$", "id": "2740240"}, {"introduction": "Observing and parameterizing a cline is only the beginning; the ultimate goal is to infer the evolutionary processes that generated it. A given clinal pattern could result from a simple selection-migration balance, a historical barrier to gene flow, or the secondary contact of previously isolated populations. This final, capstone exercise [@problem_id:2740355] challenges you to think critically about experimental design and hypothesis testing, synthesizing multiple lines of evidence—from cline concordance and linkage disequilibrium to temporal dynamics—to build a powerful research strategy capable of distinguishing between these competing models of parapatric divergence.", "problem": "An ecotone spans a linear landscape with coordinate $x \\in \\mathbb{R}$, from $x=-\\infty$ (habitat A) to $x=+\\infty$ (habitat B). A focal species is continuously distributed, with dispersal characterized by mean-squared displacement per generation $\\sigma^{2}$, local census density $N(x)$, and local effective population size $N_{e}(x)$. At location $x$, the abiotic environment is summarized by a scalar index $E(x)$, which is smooth and monotone from low to high across the ecotone, with steepest change near $x=0$. Genome-wide single-nucleotide polymorphisms (SNPs) are observed along a transect at many $x$ values for $L$ unlinked loci, where a subset are candidates for local adaptation to $E(x)$.\n\nConsider three alternative process models that can all produce sigmoidal allele-frequency clines across $x$:\n\n- Model $\\mathrm{S}$ (selection gradient): Divergent selection varies with the environment, so that a subset of loci experience opposing selection regimes across the ecotone. Let $s(x)$ denote the selection coefficient favoring allele $A$ relative to $a$ at a given locus; for environmentally associated loci, $s(x)$ changes sign across $x=0$. Gene flow is continuous due to dispersal with variance $\\sigma^{2}$. No historical isolation is assumed.\n\n- Model $\\mathrm{B}$ (demographic barrier): There is a localized reduction in effective migration across a narrow region centered at $x=0$, equivalent to a partially permeable barrier to gene flow. The environment does not impose divergent selection on the focal loci, and any clines are primarily due to restricted gene flow superimposed on isolation by distance.\n\n- Model $\\mathrm{C}$ (secondary contact with a tension zone): Two lineages that diverged in allopatry meet at $x=0$, creating a hybrid zone maintained by selection against hybrids at many loci. This selection can be due to intrinsic incompatibilities or extrinsic multi-locus maladaptation. The cline is a tension zone whose position can be influenced by spatial variation in $N(x)$ and $\\sigma^{2}$.\n\nStarting from core definitions of gene flow, selection, and linkage disequilibrium, and without assuming any specific parametric cline formula in advance, derive the qualitative predictions that distinguish these models with respect to:\n\n- Across-locus concordance of cline centers and widths.\n- The relationship between cline centers and the environmental profile $E(x)$.\n- Patterns of linkage disequilibrium among unlinked loci near the cline center.\n- Temporal dynamics of cline location and width under repeated sampling at times $t$ and $t+\\Delta t$.\n- Neutral genetic diversity and isolation-by-distance patterns on either side of $x=0$ and across it.\n\nYou have access to the following data types: genome-wide allele frequencies at $L$ unlinked loci along $x$, environmental measurements $E(x)$, local density estimates $N(x)$, mark–recapture estimates of $\\sigma^{2}$, and temporal resamples after $\\Delta t$ generations. Which of the following testing strategies is most likely to discriminate among Models $\\mathrm{S}$, $\\mathrm{B}$, and $\\mathrm{C}$ in a single study, based on first-principles predictions of the three processes?\n\nA. Fit sigmoid clines to all loci and test for center and width concordance only among loci identified a priori as environmentally associated; declare Model $\\mathrm{S}$ when these clines share a common center near the steepest $E(x)$ change, Model $\\mathrm{B}$ when these same loci have disparate centers, and Model $\\mathrm{C}$ when these loci alone show narrow widths and excess heterozygote deficit within the cline. Do not analyze linkage disequilibrium among unlinked loci, do not include neutral loci, and do not use temporal data.\n\nB. Jointly: (i) fit clines to all loci and quantify the dispersion of cline centers and widths separately for neutral and environmentally associated loci; test alignment of centers with the location of maximal $|dE/dx|$; (ii) estimate within-locality linkage disequilibrium among unlinked loci as a function of $x$ and test for a peak near $x=0$; (iii) estimate a barrier index for gene flow at $x=0$ by comparing isolation-by-distance slopes on either side to the effective across-barrier connectivity; (iv) quantify temporal movement of the composite cline center over $\\Delta t$ and its association with spatial variation in $N(x)$ or $\\sigma^{2}$. Infer Model $\\mathrm{S}$ if environmentally associated loci are concordant and centered on the environmental break while neutral loci lack concordance and genome-wide unlinked linkage disequilibrium is low; infer Model $\\mathrm{B}$ if both neutral and selected loci show concordant centers and widths not tied to $E(x)$, with low unlinked linkage disequilibrium and a strong barrier index; infer Model $\\mathrm{C}$ if many loci share a common center with excess unlinked linkage disequilibrium and Hardy–Weinberg deviations near $x=0$, and if the cline shows temporal drift toward regions of low $N(x)$.\n\nC. Use only genome scans of environmental association to classify loci and then compute $F_{ST}}$ between the two sides of the ecotone across a fixed window size; declare Model $\\mathrm{S}$ if environmentally associated loci have high $F_{ST}$, Model $\\mathrm{B}$ if neutral loci have high $F_{ST}$, and Model $\\mathrm{C}$ if both have high $F_{ST}$. Ignore spatial cline fitting, linkage disequilibrium, and temporal dynamics.\n\nD. Apply coalescent demographic inference to pooled samples from the two sides of the ecotone to estimate divergence time and migration rate; declare Model $\\mathrm{C}$ if a nonzero divergence time is inferred, Model $\\mathrm{B}$ if the across-ecotone migration rate is lower than within-side migration, and Model $\\mathrm{S}$ otherwise. Do not analyze spatially explicit allele-frequency variation, linkage disequilibrium, or environment–cline alignment.\n\nSelect the single best option.", "solution": "The problem statement is scientifically sound, well-posed, and objective. It presents three canonical models of clinal variation in population genetics—selection-gradient (S), demographic barrier (B), and secondary contact/tension zone (C)—and asks for a strategy to distinguish them using a realistic set of ecological and genomic data. The problem is a valid exercise in theoretical evolutionary biology. We will now proceed with the derivation of the distinguishing predictions from first principles.\n\nLet $p(x,t)$ be the frequency of an allele at a given locus at spatial coordinate $x$ and time $t$. The dynamics of $p(x,t)$ are governed by a reaction-diffusion-advection equation, which in its general form accounts for changes due to dispersal (gene flow), selection, and drift.\n\nThe gene flow term, under a diffusion approximation, is $\\frac{\\sigma^2}{2} \\frac{\\partial^2 p}{\\partial x^2}$, where $\\sigma^2$ is the mean-squared parent-offspring dispersal distance. This term acts to homogenize allele frequencies across space.\nThe selection term is $s(x) p(1-p)$ for a simple codominant locus, where $s(x)$ is the local selection coefficient.\nDrift is a stochastic term with variance proportional to $p(1-p)/(2N_e(x))$, where $N_e(x)$ is the local effective population size.\n\nWe analyze the qualitative predictions for each model based on these principles.\n\n**Model S: Selection Gradient**\nThis model posits that clines are maintained by a balance between spatially varying selection and homogenizing gene flow.\n- Principle: Divergent selection acts on specific loci. At equilibrium, for a single locus, the change in allele frequency is zero: $\\frac{\\sigma^2}{2} \\frac{d^2 p}{dx^2} + s(x)p(1-p) = 0$. The selection coefficient $s(x)$ is a function of the environment $E(x)$ and changes sign at the environmental transition, i.e., $s(x=0) \\approx 0$.\n- **1. Cline Concordance:** Clines will form only at loci under selection, i.e., a subset of the $L$ loci. Neutral loci ($s(x)=0$) will not form sharp clines but will exhibit shallow gradients due to isolation by distance (IBD). For selected loci, the cline centers will be highly concordant, as they are all \"anchored\" to the same environmental transition point. Cline widths, which are proportional to $\\sigma/\\sqrt{s}$ for strong selection, will vary among loci if their respective selection strengths $s$ differ.\n- **2. Cline Center vs. $E(x)$:** The center of each cline is determined by the point where selection changes sign, $s(x)=0$. This corresponds to a specific environmental value and is expected to align with the location of the steepest environmental gradient, where $|dE/dx|$ is maximal.\n- **3. Unlinked Linkage Disequilibrium (LD):** Because gene flow is continuous and loci are unlinked, recombination efficiently breaks down associations between alleles. LD between unlinked loci is therefore expected to be negligible, arising only transiently from the mixing of populations from different locations and quickly decaying.\n- **4. Temporal Dynamics:** The clines are stabilized by the external environmental scaffold $E(x)$. As long as the environment is static, the cline positions are stable and will not move.\n- **5. Neutral Diversity and IBD:** Neutral diversity should be relatively continuous across the landscape. The IBD pattern should reflect continuous gene flow, resulting in a linear relationship between genetic distance and geographic distance, with no abrupt breaks or changes in slope across the ecotone.\n\n**Model B: Demographic Barrier**\nThis model posits that clines result from restricted gene flow across a fixed spatial location, coupled with genetic drift.\n- Principle: There is a localized, exogenous reduction in effective migration at $x=0$. Selection is not the primary force maintaining the clines ($s(x) \\approx 0$). Clines exist because drift on either side of the barrier leads to differentiation, and the barrier prevents homogenization.\n- **1. Cline Concordance:** The barrier impedes gene flow for *all* loci equally. Therefore, any allele that has drifted to a different frequency on either side of the barrier will form a cline. We expect high concordance in cline centers across the entire genome (both neutral and selected loci), all centered on the barrier at $x=0$. Cline widths should also be similar, dictated by the strength of the barrier.\n- **2. Cline Center vs. $E(x)$:** The cline centers are determined by the location of the physical or demographic barrier. Any alignment with the environmental gradient $E(x)$ would be coincidental, not causal.\n- **3. Unlinked LD:** As in Model S, there is no mechanism to generate substantial LD between unlinked loci. The primary process is drift and restricted migration, neither of which creates the necessary multi-locus associations.\n- **4. Temporal Dynamics:** The barrier is assumed to be a fixed feature of the landscape. Consequently, the clines it maintains are expected to be stable in position over time.\n- **5. Neutral Diversity and IBD:** We expect a sharp break in the IBD pattern. The slope of genetic distance vs. geographic distance will be much steeper for pairs of populations spanning the barrier than for pairs on the same side. This is the defining signature of a barrier to gene flow.\n\n**Model C: Secondary Contact with a Tension Zone**\nThis model posits that clines are formed at the meeting point of two previously allopatrically diverged lineages.\n- Principle: The clines are maintained by endogenous selection against hybrids. This selection arises from negative epistatic interactions (genetic incompatibilities) between loci that have diverged in the two lineages. The zone acts as an endogenous barrier to gene flow.\n- **1. Cline Concordance:** Selection against hybrids acts on many loci simultaneously, coupling their dynamics. This creates a \"tension zone\" where clines at many loci—both those causing incompatibilities and neutral loci linked to them or trapped by the barrier effect—will be coincident in position and often width. This results in very high concordance across a large fraction of the genome.\n- **2. Cline Center vs. $E(x)$:** The initial position of the contact zone is a matter of historical contingency. It is not determined by the environment $E(x)$. However, the zone is not necessarily stable in position. Theory predicts it will move towards regions of lower population density or size, as it is \"pushed\" by the higher demographic pressure from the denser population. Therefore, its center may not align with the environmental break but could be found in a demographic sink (low $N(x)$).\n- **3. Unlinked LD:** This is the most critical and unique prediction. The admixture of two diverged parental genomes in the hybrid zone, followed by selection against recombinant genotypes, generates strong LD between alleles that originated from the same parental population, even if these alleles are on different chromosomes (unlinked). A peak of unlinked LD is the hallmark of a tension zone. This may also manifest as Hardy-Weinberg disequilibrium (heterozygote deficits from a Wahlund effect).\n- **4. Temporal Dynamics:** As mentioned, the tension zone is free to move. Temporal resampling can reveal a shift in the clines' positions over $\\Delta t$ generations. The direction of movement is predicted to be towards the area of lower effective population size $N_e(x)$ (or census size $N(x)$ as a proxy).\n- **5. Neutral Diversity and IBD:** The history of allopatric divergence will be evident. Coalescent analyses would infer a non-zero divergence time. Like Model B, the tension zone acts as a barrier, so IBD patterns will show a sharp break. However, unlike B, this barrier is endogenous and associated with high LD.\n\n**Evaluation of Options**\n\n**A. Fit sigmoid clines to all loci and test for center and width concordance only among loci identified a priori as environmentally associated; declare Model S when these clines share a common center near the steepest $E(x)$ change, Model B when these same loci have disparate centers, and Model C when these loci alone show narrow widths and excess heterozygote deficit within the cline. Do not analyze linkage disequilibrium among unlinked loci, do not include neutral loci, and do not use temporal data.**\n- This strategy is flawed. It incorrectly predicts that Model B would show disparate centers for selected loci; in Model B, all loci should show concordant centers at the barrier. It crucially proposes to \"not analyze linkage disequilibrium among unlinked loci\", \"not include neutral loci\", and \"not use temporal data\", thereby discarding the most powerful evidence needed to distinguish Model C from S and B (unlinked LD, temporal movement) and Model B from S (concordance of neutral loci).\n- **Verdict: Incorrect.**\n\n**B. Jointly: (i) fit clines to all loci and quantify the dispersion of cline centers and widths separately for neutral and environmentally associated loci; test alignment of centers with the location of maximal $|dE/dx|$; (ii) estimate within-locality linkage disequilibrium among unlinked loci as a function of $x$ and test for a peak near $x=0$; (iii) estimate a barrier index for gene flow at $x=0$ by comparing isolation-by-distance slopes on either side to the effective across-barrier connectivity; (iv) quantify temporal movement of the composite cline center over $\\Delta t$ and its association with spatial variation in $N(x)$ or $\\sigma^{2}$. Infer Model S if environmentally associated loci are concordant and centered on the environmental break while neutral loci lack concordance and genome-wide unlinked linkage disequilibrium is low; infer Model B if both neutral and selected loci show concordant centers and widths not tied to $E(x)$, with low unlinked linkage disequilibrium and a strong barrier index; infer Model C if many loci share a common center with excess unlinked linkage disequilibrium and Hardy–Weinberg deviations near $x=0$, and if the cline shows temporal drift toward regions of low $N(x)$.**\n- This strategy is comprehensive and systematically applies the key theoretical predictions.\n- (i) correctly uses cline concordance and environmental alignment to identify the signature of Model S.\n- (ii) correctly uses the peak of unlinked LD as the primary diagnostic for Model C.\n- (iii) correctly uses IBD patterns to diagnose a barrier effect, which is present in B and C but not S.\n- (iv) correctly uses temporal movement as a confirmatory test for Model C.\n- The inference logic provided for each model precisely matches the predictions derived from first principles. This multi-pronged approach leverages all available data types to maximize discriminatory power.\n- **Verdict: Correct.**\n\n**C. Use only genome scans of environmental association to classify loci and then compute $F_{ST}}$ between the two sides of the ecotone across a fixed window size; declare Model S if environmentally associated loci have high $F_{ST}$, Model B if neutral loci have high $F_{ST}$, and Model C if both have high $F_{ST}$. Ignore spatial cline fitting, linkage disequilibrium, and temporal dynamics.**\n- This strategy is overly simplistic. $F_{ST}$ is a summary statistic that loses crucial spatial information. High neutral $F_{ST}$ is expected in both Model B and Model C, so it cannot distinguish them. High selected $F_{ST}$ can also occur in Model C. Ignoring spatial patterns, LD, and temporal dynamics is a fatal flaw, as these are the phenomena containing the most diagnostic information.\n- **Verdict: Incorrect.**\n\n**D. Apply coalescent demographic inference to pooled samples from the two sides of the ecotone to estimate divergence time and migration rate; declare Model C if a nonzero divergence time is inferred, Model B if the across-ecotone migration rate is lower than within-side migration, and Model S otherwise. Do not analyze spatially explicit allele-frequency variation, linkage disequilibrium, or environment–cline alignment.**\n- This approach is fundamentally misguided for this problem. It pools samples, thereby averaging over and destroying the essential spatial information that defines a cline. The inference logic is also weak: both Model B (if the populations were separated for some time) and Model C will show a nonzero divergence time. Both will show a low across-ecotone migration rate. Therefore, this method cannot distinguish B from C. Declaring Model S by exclusion is not a rigorous method.\n- **Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "2740355"}]}