{"hands_on_practices": [{"introduction": "The cornerstone of studying inbreeding is the ability to quantify it. The inbreeding coefficient, $F$, provides this measure by calculating the probability that two alleles at a locus are identical by descent. This first exercise [@problem_id:1940055] provides fundamental practice in applying Wright’s path coefficient method to a classic pedigree, demonstrating how a specific mating between relatives—in this case, first cousins—translates into a precise level of inbreeding in the offspring.", "problem": "In a captive breeding program for the critically endangered Iberian lynx, a new cub, 'Zara', is born. The zookeepers are assessing the genetic health of the population and need to calculate the level of inbreeding for this new individual. Zara's parents are 'Félix' and 'Isabel'. Genealogical records show that Félix’s father and Isabel’s father were brothers. All other ancestors in their recent lineage are assumed to be unrelated and not inbred themselves. The inbreeding coefficient, denoted by $F$, quantifies the probability that the two alleles at any given locus in an individual are identical by descent from a common ancestor. Calculate the inbreeding coefficient $F$ for Zara. Express your answer as an exact fraction.", "solution": "The inbreeding coefficient $F$ of an individual equals the probability that the two alleles at a locus are identical by descent. By Wright’s path coefficient method, it is computed as\n$$\nF=\\sum_{A}\\left( \\frac{1}{2} \\right)^{n_{1}+n_{2}+1}\\left(1+F_{A}\\right)\n$$\nwhere the sum is over all common ancestors $A$ of the individual’s parents, $n_{1}$ and $n_{2}$ are the numbers of generations from $A$ to each parent, and $F_{A}$ is the inbreeding coefficient of ancestor $A$.\n\nZara's parents, Félix and Isabel, are first cousins since their fathers were brothers. Their common ancestors are the two parents of those brothers (Zara's great-grandparents). All other ancestors are assumed to be unrelated and not inbred, so for each common ancestor $A$ we have $F_{A}=0$.\n\nFor each of the two common ancestors:\n- The path from a common ancestor $A$ to parent Félix is 2 generations long ($n_1=2$).\n- The path from $A$ to parent Isabel is also 2 generations long ($n_2=2$).\n\nThus, each common ancestor contributes\n$$\n\\left( \\frac{1}{2} \\right)^{2+2+1}(1+0)=\\left( \\frac{1}{2} \\right)^{5}=\\frac{1}{32}.\n$$\nThere are two such common ancestors, so the total is\n$$\nF=2\\times \\frac{1}{32}=\\frac{1}{16}.\n$$\n\nAs a consistency check, the coefficient of relationship between first cousins is $\\frac{1}{8}$, and the kinship coefficient (which equals the offspring’s $F$ when parents are not inbred) is half of that, namely $\\frac{1}{16}$, matching the result above.", "answer": "$$\\boxed{\\frac{1}{16}}$$", "id": "1940055"}, {"introduction": "With an understanding of how to calculate the inbreeding coefficient $F$ for an individual, we now turn to its population-level consequences. Inbreeding fundamentally alters the genetic structure of a population by increasing homozygosity beyond the expectations of random mating. This practice [@problem_id:1940005] demonstrates how to adjust genotype frequency calculations to account for a given level of inbreeding, a critical step in predicting the prevalence of phenotypes associated with recessive alleles.", "problem": "A team of conservation biologists is studying an isolated population of a rare species of mountain fox. This isolation has led to a measurable degree of inbreeding. The biologists are focusing on a single gene locus responsible for ear morphology, which has two alleles: a dominant allele `T` for typical ears and a recessive allele `t` for tufted ears. The tufted ear phenotype is only expressed in individuals with the homozygous recessive genotype (`tt`).\n\nGenetic surveys of the population have established that the frequency of the recessive allele `t` is $q = 0.2$. Further analysis of pedigrees and genetic markers has allowed the biologists to estimate the average inbreeding coefficient for the population, which is $F = 0.1$.\n\nAssuming the population's genetic structure is in equilibrium under these conditions, what is the expected frequency of mountain foxes with tufted ears? Express your answer as a decimal rounded to three significant figures.", "solution": "The problem asks for the expected frequency of homozygous recessive individuals (`tt`) in a population with a known allele frequency and inbreeding coefficient.\n\nThe frequency of the recessive allele `t` is given as $q = 0.2$.\nThe inbreeding coefficient is given as $F = 0.1$.\n\nIn a randomly mating population (i.e., where $F=0$), the frequency of genotypes would follow Hardy-Weinberg equilibrium, and the frequency of homozygous recessive individuals would simply be $q^2$. However, inbreeding increases the probability that an individual will be homozygous, as it increases the chance of receiving alleles that are identical by descent.\n\nThe general formulas for genotype frequencies in a population with an inbreeding coefficient $F$ are:\n- Frequency of `TT` ($P_{TT}$): $p^2(1-F) + pF$\n- Frequency of `Tt` ($P_{Tt}$): $2pq(1-F)$\n- Frequency of `tt` ($P_{tt}$): $q^2(1-F) + qF$\n\nHere, $p$ is the frequency of the dominant allele `T`, and $q$ is the frequency of the recessive allele `t`. Since there are only two alleles at this locus, their frequencies must sum to 1.\n$p + q = 1$\n$p = 1 - q = 1 - 0.2 = 0.8$\n\nWe need to calculate the frequency of the homozygous recessive genotype, $P_{tt}$, which corresponds to the phenotype of tufted ears. We use the formula:\n$$P_{tt} = q^2(1-F) + qF$$\n\nLet's break down this formula. The term $(1-F)$ represents the fraction of the population that can be considered to be mating randomly. Within this fraction, the probability of an individual being homozygous recessive is $q^2$. The term $F$ represents the fraction of the population where alleles are identical by descent due to inbreeding. In this fraction, the probability of an individual being homozygous for allele `t` is simply the frequency of the allele, $q$.\n\nNow we can substitute the given values into the equation:\n$q = 0.2$\n$F = 0.1$\n\n$$P_{tt} = (0.2)^2(1 - 0.1) + (0.2)(0.1)$$\nCalculate each term:\n$(0.2)^2 = 0.04$\n$(1 - 0.1) = 0.9$\n$(0.2)(0.1) = 0.02$\n\nSubstitute these back into the equation for $P_{tt}$:\n$$P_{tt} = (0.04)(0.9) + 0.02$$\n$$P_{tt} = 0.036 + 0.02$$\n$$P_{tt} = 0.056$$\n\nThe problem asks for the answer to be rounded to three significant figures. The calculated value is $0.056$. The first significant figure is 5, and the second is 6. To express this with three significant figures, we must add a trailing zero.\n\nTherefore, the expected frequency of mountain foxes with tufted ears is $0.0560$.", "answer": "$$\\boxed{0.0560}$$", "id": "1940005"}, {"introduction": "The ultimate concern with inbreeding is its detrimental effect on fitness, known as inbreeding depression. This final practice [@problem_id:2725930] transitions from genetic principles to their empirical consequences by introducing a powerful model that relates survival to the inbreeding coefficient $F$. By applying weighted least squares regression to survival data, you will estimate $B$, the number of lethal equivalents, a key metric for quantifying the severity of inbreeding depression in a population.", "problem": "You are given grouped survival outcomes for multiple sets of individuals, each set having a known inbreeding coefficient $F$, a total number of individuals $n$, and a count of survivors $s$. In evolutionary biology, the concept of inbreeding depression is often quantified by the number of lethal equivalents per diploid genome, denoted $B$, which measures how survival changes with inbreeding. Starting from the fundamental base that survival across many independent, rare, deleterious loci combines multiplicatively and that the expected number of effectively lethal hits accumulates additively with the probability of identity by descent, it follows that a log transformation converts a product of survival factors into a sum. Using these principles, derive a linear relationship between the natural logarithm of survival probability and the inbreeding coefficient $F$. Then, design an estimator for $B$ using grouped binomial data by regressing the natural logarithm of the observed survival proportion on $F$ with an intercept. Use total group size $n$ as a weight to account for sampling variance differences among groups. Interpret the negative of the estimated slope as the estimate of $B$.\n\nYour program must implement the following algorithm precisely:\n- For each group $i$ with parameters $(F_i,n_i,s_i)$, compute the observed survival proportion $p_i = s_i/n_i$. Assume $0 < p_i < 1$ for all provided data.\n- Form the weighted least squares regression of $y_i = \\ln(p_i)$ on $x_i = F_i$ with an intercept, using weights $w_i = n_i$. That is, estimate the intercept and slope $(\\beta_0,\\beta_1)$ by minimizing $\\sum_i w_i\\,(y_i - \\beta_0 - \\beta_1 x_i)^2$.\n- Define $\\widehat{B} = -\\widehat{\\beta}_1$.\n- For each dataset, output $\\widehat{B}$ as a floating-point number rounded to $6$ decimal places.\n\nTest suite:\nProvide code that computes $\\widehat{B}$ for the following datasets. Each dataset is a list of triplets $(F,n,s)$.\n\n- Dataset A:\n  - $(0, 400, 320)$\n  - $(0.0625, 300, 222)$\n  - $(0.125, 350, 230)$\n  - $(0.25, 320, 190)$\n\n- Dataset B:\n  - $(0, 500, 450)$\n  - $(0.25, 500, 325)$\n  - $(0.5, 500, 250)$\n\n- Dataset C:\n  - $(0, 40, 36)$\n  - $(0.125, 30, 24)$\n  - $(0.375, 20, 11)$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the datasets, for example, $[b_A,b_B,b_C]$, where each entry is rounded to $6$ decimal places and contains no additional text.", "solution": "We begin from a fundamental base appropriate for evolutionary biology and inbreeding: when fitness components such as survival reflect the combined effect of many independent, rare, deleterious alleles, the overall survival for an individual can be modeled as the product of survival contributions across loci. Let the per-locus contribution to survival for an outbred individual be close to unity and let the expected number of effectively lethal or semi-lethal hits that are exposed by autozygosity increase proportionally with the inbreeding coefficient $F$. This is consistent with two well-tested facts: identity by descent increases homozygosity in proportion to $F$, and multiplicative fitness across independent loci implies that the logarithm of fitness is additive across loci.\n\nDenote by $S(F)$ the survival probability at inbreeding coefficient $F$ and by $S(0)$ the baseline survival probability in the outbred state. If each of many rare, primarily recessive deleterious alleles contributes a small multiplicative reduction in survival when homozygous, then the expected number of such expressed deleterious effects increases approximately linearly with $F$. Under the law of rare events, the count of effectively lethal equivalents exposed can be approximated by a Poisson random variable with mean proportional to $F$. The survival probability is then the baseline survival multiplied by the probability of zero effectively lethal hits, which yields an exponential form. Therefore, a standard and well-tested model in inbreeding depression is\n$$\nS(F) = S(0)\\,\\exp(-B\\,F),\n$$\nwhere $B$ is the number of lethal equivalents per diploid genome. Taking natural logarithms,\n$$\n\\ln S(F) = \\ln S(0) - B\\,F.\n$$\nThis shows that $\\ln S(F)$ depends linearly on $F$ with slope $-B$ and intercept $\\ln S(0)$.\n\nIn practice we observe grouped binomial data: for each group $i$ with common $F_i$, there are $n_i$ individuals and $s_i$ survivors, providing the observed proportion\n$$\np_i = \\frac{s_i}{n_i}.\n$$\nFor large $n_i$ and moderate $p_i$, the sampling variance of $\\ln p_i$ is approximately inversely proportional to $n_i$, which motivates weighting by $n_i$ in a regression of $\\ln p_i$ on $F_i$. Specifically, define $y_i = \\ln(p_i)$, $x_i = F_i$, and weights $w_i = n_i$. We seek $(\\beta_0,\\beta_1)$ that minimize the weighted sum of squares\n$$\nQ(\\beta_0,\\beta_1) = \\sum_i w_i\\left(y_i - \\beta_0 - \\beta_1 x_i\\right)^2.\n$$\nThe weighted normal equations yield closed-form estimators. Define the weighted sums\n$$\nS_0 = \\sum_i w_i,\\quad S_x = \\sum_i w_i x_i,\\quad S_y = \\sum_i w_i y_i,\\quad S_{xx} = \\sum_i w_i x_i^2,\\quad S_{xy} = \\sum_i w_i x_i y_i.\n$$\nThen the determinant $D = S_0 S_{xx} - S_x^2$ is positive provided there is variation in $x_i$. The weighted least squares estimators are\n$$\n\\widehat{\\beta}_1 = \\frac{S_0 S_{xy} - S_x S_y}{D},\\qquad \\widehat{\\beta}_0 = \\frac{S_y - \\widehat{\\beta}_1 S_x}{S_0}.\n$$\nFrom the model $\\ln S(F) = \\ln S(0) - B F$, the slope satisfies $\\beta_1 = -B$, so the estimator of the number of lethal equivalents per diploid genome is\n$$\n\\widehat{B} = -\\widehat{\\beta}_1.\n$$\n\nAlgorithmic design for the program:\n- For each dataset composed of triplets $(F_i,n_i,s_i)$:\n  - Compute $p_i = s_i/n_i$ for all groups $i$.\n  - Compute $y_i = \\ln(p_i)$ and $x_i = F_i$, and set $w_i = n_i$.\n  - Accumulate the weighted sums $S_0, S_x, S_y, S_{xx}, S_{xy}$.\n  - Compute $\\widehat{\\beta}_1$ and then $\\widehat{B} = -\\widehat{\\beta}_1$.\n  - Round $\\widehat{B}$ to $6$ decimal places.\n- Aggregate the three rounded $\\widehat{B}$ values in the order of the datasets into a single list and print it as a single line, comma-separated within brackets, with no extra text.\n\nScientific realism and test coverage:\n- Dataset A spans low to moderate inbreeding coefficients from $F=0$ to $F=0.25$ with substantial sample sizes; observed survival declines with $F$, consistent with inbreeding depression.\n- Dataset B includes higher inbreeding up to $F=0.5$ with balanced large sample sizes, probing a stronger depression regime.\n- Dataset C uses smaller sample sizes to test the weighting behavior and numerical stability while maintaining $0<p_i<1$ to avoid undefined logarithms.\n\nThe method is grounded in the multiplicative fitness model and the additive behavior of logarithms, producing an interpretable slope whose negative equals the estimated number of lethal equivalents per diploid genome.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_B_wls(dataset):\n    \"\"\"\n    Estimate B (lethal equivalents per diploid genome) by weighted least squares\n    regression of ln(p_i) on F_i with intercept, weights w_i = n_i.\n\n    dataset: list of tuples (F_i, n_i, s_i)\n    returns: float, estimated B\n    \"\"\"\n    F = np.array([row[0] for row in dataset], dtype=float)\n    n = np.array([row[1] for row in dataset], dtype=float)\n    s = np.array([row[2] for row in dataset], dtype=float)\n\n    # Observed survival proportions\n    p = s / n\n\n    # Numerical safety: assume 0 < p < 1 as guaranteed by the problem statement.\n    # Compute transformed response\n    y = np.log(p)\n    x = F\n    w = n\n\n    # Weighted sums for closed-form WLS with intercept\n    S0 = np.sum(w)\n    Sx = np.sum(w * x)\n    Sy = np.sum(w * y)\n    Sxx = np.sum(w * x * x)\n    Sxy = np.sum(w * x * y)\n\n    D = S0 * Sxx - Sx * Sx\n    if D == 0.0:\n        # Should not happen with varying F; handle gracefully\n        raise ValueError(\"Design matrix is singular; variation in F is required.\")\n\n    beta1 = (S0 * Sxy - Sx * Sy) / D\n    # beta0 = (Sy - beta1 * Sx) / S0  # not needed for B\n\n    B_hat = -beta1\n    return B_hat\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each dataset is a list of (F, n, s) tuples.\n    dataset_A = [\n        (0.0, 400, 320),\n        (0.0625, 300, 222),\n        (0.125, 350, 230),\n        (0.25, 320, 190),\n    ]\n    dataset_B = [\n        (0.0, 500, 450),\n        (0.25, 500, 325),\n        (0.5, 500, 250),\n    ]\n    dataset_C = [\n        (0.0, 40, 36),\n        (0.125, 30, 24),\n        (0.375, 20, 11),\n    ]\n\n    test_cases = [dataset_A, dataset_B, dataset_C]\n\n    results = []\n    for data in test_cases:\n        B_est = estimate_B_wls(data)\n        # Round to 6 decimal places as required\n        results.append(f\"{B_est:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2725930"}]}