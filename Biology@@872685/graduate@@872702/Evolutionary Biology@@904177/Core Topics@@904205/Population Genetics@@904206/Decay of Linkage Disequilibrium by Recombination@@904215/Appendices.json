{"hands_on_practices": [{"introduction": "To truly grasp how recombination breaks down linkage disequilibrium, we must start from first principles. This foundational exercise [@problem_id:2699687] guides you through the derivation of the fundamental recurrence relation for the linkage disequilibrium coefficient, $D$, starting from the random union of gametes and the process of meiosis. By completing this derivation, you will solidify your understanding of how the recombination fraction $r$ directly governs the rate at which non-random associations between alleles are eroded over time.", "problem": "Consider two diallelic loci, denoted by $A/a$ and $B/b$, in an effectively infinite, randomly mating population with discrete, nonoverlapping generations. Assume no selection, no mutation, and no migration. Let the four gametic (haplotype) frequencies at generation $t$ be $x_{AB,t}$, $x_{Ab,t}$, $x_{aB,t}$, and $x_{ab,t}$, which sum to $1$. Define the marginal allele frequencies $p_{A,t} = x_{AB,t} + x_{Ab,t}$ and $p_{B,t} = x_{AB,t} + x_{aB,t}$, and define linkage disequilibrium (LD) as $D_t = x_{AB,t} - p_{A,t} p_{B,t}$. The recombination fraction between the two loci is a constant $r \\in [0,1/2]$.\n\nUsing only these definitions and the assumptions above, derive from first principles the one-generation recursion relating $D_{t+1}$ to $D_t$ and $r$ by explicitly accounting for the production of recombinant and nonrecombinant gametes by each diploid genotype formed under random mating. Then specialize your result to the unlinked case $r = 0.5$ and show the mapping from $D_t$ to $D_{t+1}$.\n\nFinally, starting from an arbitrary nonzero $D_0$, determine the minimal integer number of generations $t$ required so that the absolute value of LD has been reduced by more than $0.99$ of its initial magnitude, that is, so that $|D_t|  0.01\\,|D_0|$. Report this minimal integer.", "solution": "The problem as stated is a fundamental exercise in theoretical population genetics. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The definitions and assumptions are standard for the derivation of the decay of linkage disequilibrium. Therefore, the problem is valid, and I will proceed with its solution.\n\nThe problem asks for three distinct results: first, a derivation of the one-generation recursion for linkage disequilibrium, $D$; second, the specialization of this recursion for unlinked loci; and third, the calculation of the number of generations required for linkage disequilibrium to decay by more than a specified amount under the unlinked condition.\n\nLet us begin with the derivation of the recursion for $D_t$.\nLinkage disequilibrium at generation $t$ is defined as $D_t = x_{AB,t} - p_{A,t} p_{B,t}$. To find the recursion for $D_t$, we must find an expression for $D_{t+1}$. This requires finding the frequency of the $AB$ gamete in generation $t+1$, $x_{AB, t+1}$, and the allele frequencies in generation $t+1$, $p_{A, t+1}$ and $p_{B, t+1}$.\n\nThe gametes for generation $t+1$ are produced by the diploid individuals of generation $t+1$, which are formed by the random union of gametes from generation $t$. The frequency of any diploid genotype is the product of the frequencies of the two gametes that form it. We must systematically account for the production of $AB$ gametes from all possible parental genotypes. The recombination fraction between the loci is $r$.\n\nThe frequency of the $AB$ gamete in generation $t+1$, denoted $x_{AB,t+1}$, is the sum of contributions from all diploid genotypes present in generation $t+1$. The relevant genotypes that can produce an $AB$ gamete are:\n$1$. Type $AB/AB$: frequency $x_{AB,t}^2$. Produces only $AB$ gametes.\n$2$. Type $AB/Ab$: frequency $2x_{AB,t}x_{Ab,t}$. Produces $AB$ and $Ab$ gametes in equal proportion, so the proportion of $AB$ gametes is $1/2$.\n$3$. Type $AB/aB$: frequency $2x_{AB,t}x_{aB,t}$. Produces $AB$ and $aB$ gametes in equal proportion, so the proportion of $AB$ gametes is $1/2$.\n$4$. Type $AB/ab$ (coupling-phase double heterozygote): frequency $2x_{AB,t}x_{ab,t}$. Produces non-recombinant gametes ($AB$, $ab$) with probability $1-r$ and recombinant gametes ($Ab$, $aB$) with probability $r$. The proportion of $AB$ gametes produced is $(1-r)/2$.\n$5$. Type $Ab/aB$ (repulsion-phase double heterozygote): frequency $2x_{Ab,t}x_{aB,t}$. Produces non-recombinant gametes ($Ab$, $aB$) with probability $1-r$ and recombinant gametes ($AB$, $ab$) with probability $r$. The proportion of $AB$ gametes produced is $r/2$.\n\nSumming the contributions from these genotypes to the gamete pool of generation $t+1$:\n$$x_{AB,t+1} = (x_{AB,t}^2)(1) + (2x_{AB,t}x_{Ab,t})\\left(\\frac{1}{2}\\right) + (2x_{AB,t}x_{aB,t})\\left(\\frac{1}{2}\\right) + (2x_{AB,t}x_{ab,t})\\left(\\frac{1-r}{2}\\right) + (2x_{Ab,t}x_{aB,t})\\left(\\frac{r}{2}\\right)$$\n$$x_{AB,t+1} = x_{AB,t}^2 + x_{AB,t}x_{Ab,t} + x_{AB,t}x_{aB,t} + (1-r)x_{AB,t}x_{ab,t} + r x_{Ab,t}x_{aB,t}$$\nTo simplify, we add and subtract the term $r x_{AB,t}x_{ab,t}$:\n$$x_{AB,t+1} = x_{AB,t}^2 + x_{AB,t}x_{Ab,t} + x_{AB,t}x_{aB,t} + x_{AB,t}x_{ab,t} - r x_{AB,t}x_{ab,t} + r x_{Ab,t}x_{aB,t}$$\nWe can factor out $x_{AB,t}$ from the first four terms:\n$$x_{AB,t+1} = x_{AB,t}(x_{AB,t} + x_{Ab,t} + x_{aB,t} + x_{ab,t}) - r(x_{AB,t}x_{ab,t} - x_{Ab,t}x_{aB,t})$$\nThe sum of all gamete frequencies is $1$, so $x_{AB,t} + x_{Ab,t} + x_{aB,t} + x_{ab,t} = 1$. The term $x_{AB,t}x_{ab,t} - x_{Ab,t}x_{aB,t}$ is an alternative definition of linkage disequilibrium valid under random mating. It can be shown to be equal to $D_t = x_{AB,t} - p_{A,t}p_{B,t}$. Thus, we have:\n$$x_{AB,t+1} = x_{AB,t} - r D_t$$\nNext, we must determine the allele frequencies $p_{A,t+1}$ and $p_{B,t+1}$. In the absence of selection, mutation, and migration, allele frequencies are expected to be constant. We will prove this.\nThe frequency of allele $A$ at generation $t+1$ is $p_{A,t+1} = x_{AB,t+1} + x_{Ab,t+1}$. We derive the recursion for $x_{Ab,t+1}$ by symmetry with $x_{AB,t+1}$. Recombination breaks down $AB/ab$ genotypes to form $Ab$, and breaks down $Ab/aB$ genotypes away from forming $Ab$. The signs on the $D_t$ term are reversed for recombinant haplotypes.\n$$x_{Ab,t+1} = x_{Ab,t} + r D_t$$\nSimilarly, $x_{aB,t+1} = x_{aB,t} + r D_t$ and $x_{ab,t+1} = x_{ab,t} - r D_t$.\nNow, we compute $p_{A,t+1}$:\n$$p_{A,t+1} = x_{AB,t+1} + x_{Ab,t+1} = (x_{AB,t} - r D_t) + (x_{Ab,t} + r D_t) = x_{AB,t} + x_{Ab,t} = p_{A,t}$$\nAnd $p_{B,t+1}$:\n$$p_{B,t+1} = x_{AB,t+1} + x_{aB,t+1} = (x_{AB,t} - r D_t) + (x_{aB,t} + r D_t) = x_{AB,t} + x_{aB,t} = p_{B,t}$$\nThe allele frequencies are constant over generations. Let $p_A = p_{A,t}$ and $p_B = p_{B,t}$ for all $t$.\n\nNow we can write the expression for $D_{t+1}$:\n$$D_{t+1} = x_{AB,t+1} - p_{A,t+1}p_{B,t+1}$$\nSubstituting our results:\n$$D_{t+1} = (x_{AB,t} - r D_t) - p_A p_B = (x_{AB,t} - p_A p_B) - r D_t$$\nRecognizing that $D_t = x_{AB,t} - p_A p_B$, we obtain the one-generation recursion for linkage disequilibrium:\n$$D_{t+1} = D_t - r D_t = (1-r)D_t$$\nThis is the first required result.\n\nFor the second part, we specialize this result to the case of unlinked loci, where $r=1/2 = 0.5$.\n$$D_{t+1} = (1 - 0.5)D_t = 0.5 D_t$$\nThe mapping from $D_t$ to $D_{t+1}$ is a reduction by a factor of $1/2$. This indicates that for unlinked loci, linkage disequilibrium halves with each generation of random mating.\n\nFor the third part, we must find the minimal integer number of generations $t$ for the magnitude of LD to be reduced by more than $99\\%$. This means we require $|D_t|  0.01 |D_0|$ for an arbitrary initial nonzero disequilibrium $D_0$. The case is specified as unlinked, so we use the recursion $D_{t+1} = 0.5 D_t$.\nThis is a first-order linear homogeneous recurrence relation. Its solution is a geometric progression:\n$$D_t = (0.5)^t D_0$$\nWe apply the condition:\n$$|D_0 (0.5)^t|  0.01 |D_0|$$\nSince $D_0$ is nonzero, we can divide by $|D_0|$:\n$$(0.5)^t  0.01$$\n$$(\\frac{1}{2})^t  \\frac{1}{100}$$\n$$2^{-t}  10^{-2}$$\nTo solve for $t$, we take the natural logarithm of both sides.\n$$\\ln(2^{-t})  \\ln(10^{-2})$$\n$$-t \\ln(2)  -2 \\ln(10)$$\nMultiplying by $-1$ reverses the inequality:\n$$t \\ln(2)  2 \\ln(10)$$\n$$t  \\frac{2 \\ln(10)}{\\ln(2)}$$\nAlternatively, from $2^t  100$, we can express this using logarithm base $2$: $t  \\log_2(100)$.\nWe know that $2^6 = 64$ and $2^7 = 128$.\nSince $64  100  128$, it is clear that $6  \\log_2(100)  7$.\nThe value is $\\log_2(100) = \\frac{\\ln(100)}{\\ln(2)} = \\frac{2\\ln(10)}{\\ln(2)} \\approx \\frac{2 \\times 2.3026}{0.6931} \\approx 6.6439$.\nThe problem asks for the minimal integer $t$ that satisfies the inequality $t  6.6439$. The smallest integer greater than this value is $7$.\nThus, a minimum of $7$ generations are required for the linkage disequilibrium to decay to less than $1\\%$ of its initial value for unlinked loci.\nCheck:\nFor $t=6$: $|D_6|/|D_0| = (0.5)^6 = 1/64 = 0.015625$, which is not less than $0.01$.\nFor $t=7$: $|D_7|/|D_0| = (0.5)^7 = 1/128 = 0.0078125$, which is less than $0.01$.\nThe minimal integer number of generations is indeed $7$.", "answer": "$$\\boxed{7}$$", "id": "2699687"}, {"introduction": "The recombination fraction, $r$, is not merely an abstract parameter; it is fundamentally tied to the physical distance separating loci on a chromosome. This practice [@problem_id:2699675] challenges you to connect these concepts by incorporating a mapping function—in this case, Haldane's model—into the dynamics of LD decay. By deriving the 'LD half-distance,' $x_{1/2}(t)$, you will develop a quantitative intuition for how LD patterns create a footprint of genomic architecture.", "problem": "Consider a large, randomly mating diploid population with two bi-allelic loci separated by a physical distance $x$ along a chromosome. Assume no selection, no mutation, and no genetic drift. Let the initial linkage disequilibrium (LD) between the two loci at generation $t=0$ be $D_0$, and denote the LD at generation $t$ and separation $x$ by $D(x,t)$. Recombination occurs with a constant crossover rate per base $\\rho$ (crossovers per base per meiosis) along the chromosome. Crossovers are assumed to follow a Poisson process with no interference, so that the recombination fraction $r(x)$ between the two loci as a function of physical distance $x$ is given by the Haldane mapping function as a function of the map distance $d(x)$ in Morgans, with $d(x)=\\rho x$.\n\nStarting from first principles about how recombination reshapes haplotype frequencies under random mating, and using the Haldane function to connect physical distance to recombination fraction, derive a closed-form analytic expression for the LD half-distance $x_{1/2}(t)$ defined implicitly by the condition $D(x_{1/2},t)=D_0/2$ after $t$ generations. Express your final answer in terms of $\\rho$ and $t$. Do not use approximations, and do not insert numerical values. No rounding is required. Provide your final expression for $x_{1/2}(t)$ without units.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on canonical models in population genetics and contains all necessary information for a unique solution. Therefore, we will proceed with the derivation.\n\nThe first principle is the decay of linkage disequilibrium ($LD$) due to recombination in a large, randomly mating population where other evolutionary forces are absent. Let $D_t$ be the linkage disequilibrium at generation $t$, and $r$ be the recombination fraction between the two loci. The value of $LD$ in the next generation, $D_{t+1}$, is related to its current value by the recurrence relation:\n$$D_{t+1} = (1-r)D_t$$\nThis relation arises because a fraction $r$ of the gametes produced by double heterozygotes are recombinant, which breaks down the non-random association of alleles. Solving this recurrence relation over $t$ generations from an initial state $D_0$ at $t=0$ yields:\n$$D_t = (1-r)^t D_0$$\nThe problem specifies that the recombination fraction $r$ is a function of the physical distance $x$ between the loci, and that the $LD$ is a function of both distance $x$ and time $t$. We thus write the equation as:\n$$D(x,t) = (1-r(x))^t D_0$$\nThe second principle is connecting the recombination fraction $r(x)$ to the physical distance $x$. The problem states that crossovers occur as a Poisson process with a rate $\\rho$ per base. The mean number of crossovers between two loci separated by distance $x$ is the map distance $d(x)$, given by $d(x) = \\rho x$. The problem requires the use of the Haldane mapping function, which relates map distance $d$ to recombination fraction $r$. This function is derived by noting that a recombinant gamete is produced if an odd number of crossovers occur between the loci. For a Poisson process with mean $d$, the probability of exactly $k$ crossovers is $P(k) = \\frac{d^k e^{-d}}{k!}$. The recombination fraction is the sum of probabilities for all odd $k$:\n$$r(d) = \\sum_{k=0}^{\\infty} P(2k+1) = e^{-d} \\sum_{k=0}^{\\infty} \\frac{d^{2k+1}}{(2k+1)!} = e^{-d} \\sinh(d)$$\nUsing the definition of the hyperbolic sine, $\\sinh(d) = \\frac{e^d - e^{-d}}{2}$, we obtain the Haldane function:\n$$r(d) = e^{-d} \\left( \\frac{e^d - e^{-d}}{2} \\right) = \\frac{1 - e^{-2d}}{2}$$\nSubstituting $d(x) = \\rho x$ into this expression gives the recombination fraction as a function of physical distance $x$:\n$$r(x) = \\frac{1}{2} (1 - \\exp(-2\\rho x))$$\nNow, we substitute this expression for $r(x)$ back into the equation for the decay of $LD$:\n$$D(x,t) = \\left( 1 - \\frac{1}{2}(1 - \\exp(-2\\rho x)) \\right)^t D_0$$\nSimplifying the term in the parenthesis gives:\n$$1 - \\frac{1}{2} + \\frac{1}{2}\\exp(-2\\rho x) = \\frac{1}{2} + \\frac{1}{2}\\exp(-2\\rho x) = \\frac{1}{2}(1 + \\exp(-2\\rho x))$$\nThus, the expression for $LD$ as a function of distance and time is:\n$$D(x,t) = \\left( \\frac{1}{2}(1 + \\exp(-2\\rho x)) \\right)^t D_0$$\nThe problem asks for the LD half-distance, $x_{1/2}(t)$, which is defined implicitly by the condition $D(x_{1/2}(t), t) = \\frac{D_0}{2}$. We set up this equation using our derived expression:\n$$\\frac{D_0}{2} = \\left( \\frac{1}{2}(1 + \\exp(-2\\rho x_{1/2}(t))) \\right)^t D_0$$\nAssuming $D_0 \\neq 0$, we can divide both sides by $D_0$:\n$$\\frac{1}{2} = \\left( \\frac{1}{2}(1 + \\exp(-2\\rho x_{1/2}(t))) \\right)^t$$\nTo solve for $x_{1/2}(t)$, we begin by taking the $t$-th root of both sides, for $t0$:\n$$\\left(\\frac{1}{2}\\right)^{1/t} = \\frac{1}{2}(1 + \\exp(-2\\rho x_{1/2}(t)))$$\nMultiply by $2$:\n$$2 \\cdot \\left(\\frac{1}{2}\\right)^{1/t} = 1 + \\exp(-2\\rho x_{1/2}(t))$$\nSimplify the left-hand side:\n$$2^{1} \\cdot 2^{-1/t} = 2^{1 - 1/t} = 1 + \\exp(-2\\rho x_{1/2}(t))$$\nIsolate the exponential term:\n$$\\exp(-2\\rho x_{1/2}(t)) = 2^{1 - 1/t} - 1$$\nFor a real solution for $x_{1/2}(t)$ to exist, the argument of the logarithm must be positive, which requires $2^{1-1/t}  1$, implying $1 - \\frac{1}{t}  0$, or $t1$. This is biologically consistent, as it takes more than one generation of recombination to reduce $LD$ by half.\nTaking the natural logarithm of both sides:\n$$-2\\rho x_{1/2}(t) = \\ln\\left(2^{1 - 1/t} - 1\\right)$$\nFinally, we solve for $x_{1/2}(t)$ by dividing by $-2\\rho$:\n$$x_{1/2}(t) = -\\frac{1}{2\\rho} \\ln\\left(2^{1 - 1/t} - 1\\right)$$\nThis is the required closed-form analytic expression for the LD half-distance as a function of the crossover rate $\\rho$ and the number of generations $t$.", "answer": "$$\\boxed{-\\frac{1}{2\\rho} \\ln\\left(2^{1 - \\frac{1}{t}} - 1\\right)}$$", "id": "2699675"}, {"introduction": "While simple models provide crucial intuition, interpreting real genomic data requires more sophisticated tools that account for the different mechanisms of recombination. This advanced practice [@problem_id:2699672] delves into a two-component model that distinguishes long-range crossovers (rate $r$) from short-range gene conversion events (rate $g$), which leave distinct signatures in the pattern of LD decay. Your task is to build a statistical estimator to fit this model to empirical data, a core skill in modern population genomics for inferring recombination rates from patterns of genetic variation.", "problem": "You are given three empirical curves of normalized linkage disequilibrium as a function of physical distance. Each curve is represented by a set of distances in base pairs and measured values of normalized linkage disequilibrium. Assume a panmictic population with no selection or drift effects over the relevant timescale, and that recombination between two loci per generation arises from two independent mechanisms: crossovers and gene conversion. Treat crossovers as uniformly distributed along the genome with a per-base rate and treat gene conversion as a process that initiates uniformly along the genome with a per-base initiation rate and yields exchange tracts whose lengths are independent and identically distributed with an exponential distribution of known mean tract length. Use the following foundational facts as your base:\n- By definition, linkage disequilibrium (LD) between two loci separated by a recombination probability per generation decays multiplicatively across generations in a large neutral population, satisfying a first-order linear recursion of the form $D_{t+1} = (1 - c) D_t$, where $D_t$ is the covariance of allelic states at generation $t$ and $c$ is the per-generation probability that the two loci are separated onto different genetic backgrounds by recombination.\n- For rare events that occur independently within a generation, the probability of no event is the product of the no-event probabilities, which implies that the combined per-generation hazard of separation is the sum of the components to first order.\n- The normalized LD curve is the ratio $y(d) = D_t(d)/D_0(d)$ of the LD after a known effective number of generations to its initial value. Under the rare-event approximation, this normalized LD is an exponential function of the aggregate per-generation recombination hazard integrated across the known timescale.\n\nYour tasks:\n1) Starting from the above base and the assumptions stated, derive a two-component expression for the aggregate per-generation recombination hazard between two loci separated by a physical distance $d$, in terms of a crossover rate per base $r$, a gene conversion initiation rate per base $g$, and the known mean gene conversion tract length $\\ell$. Explain why, for small per-generation probabilities, the crossovers and gene conversions contribute additively to this hazard, and show how this leads to an exponential form for the normalized LD $y(d)$ after a known effective timescale $s$.\n\n2) Using your derived model, implement a non-linear least squares estimator for the two unknown parameters $(g, r)$ under the constraints $g \\ge 0$ and $r \\ge 0$, given arrays of distances $d_i$ (in base pairs), observed normalized LD values $y_i$ (dimensionless), a known effective timescale $s$ (in generations), and a known mean gene conversion tract length $\\ell$ (in base pairs). The objective function should be the sum of squared deviations between the observed $y_i$ and the model-predicted $\\hat{y}(d_i; g, r)$ in the original scale.\n\n3) Apply your estimator to the following test suite. Each test case provides $(s, \\ell, \\{d_i\\}, \\{y_i\\})$ as follows. Units: distances $d_i$ in base pairs, mean tract length $\\ell$ in base pairs, timescale $s$ in generations. Report the estimates $(\\hat{g}, \\hat{r})$ in events per base per generation. You must return values as decimal floating-point numbers; do not print any percentage signs.\n\nTest Case 1 (two-component with short-range steepness):\n- $s = 10000.0$\n- $\\ell = 300.0$\n- $d = [0.0, 25.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0, 5000.0, 10000.0]$\n- $y = [1.000000, 0.996367, 0.992798, 0.985834, 0.972492, 0.935681, 0.880097, 0.780800, 0.544571, 0.298568]$\n\nTest Case 2 (crossover-only boundary case):\n- $s = 10000.0$\n- $\\ell = 500.0$\n- $d = [0.0, 1000.0, 2000.0, 5000.0, 10000.0, 20000.0]$\n- $y = [1.000000, 0.904837, 0.818731, 0.606531, 0.367879, 0.135335]$\n\nTest Case 3 (two-component with very short tracts):\n- $s = 8000.0$\n- $\\ell = 100.0$\n- $d = [0.0, 10.0, 20.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0]$\n- $y = [1.000000, 0.998535, 0.997176, 0.993614, 0.988986, 0.982468, 0.969364, 0.950096, 0.912822]$\n\nYour program must compute $(\\hat{g}, \\hat{r})$ for each test case by minimizing the sum of squared residuals between the observed $y$ and your model. All outputs must be expressed in events per base per generation and rounded to three significant figures using scientific notation.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists: [[g1,r1],[g2,r2],[g3,r3]], where each number is printed in scientific notation with three significant figures (for example, 3.50e-08). No other text should be printed.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and internally consistent. It poses a standard problem in population genetics: the estimation of recombination parameters from linkage disequilibrium data. The underlying physical model is based on established principles of meiotic recombination and its effect on genetic linkage. We shall proceed with the derivation and solution.\n\n**Task 1: Derivation of the Linkage Disequilibrium Decay Model**\n\nThe decay of linkage disequilibrium (LD) between two bi-allelic loci is described by the recurrence relation $D_{t+1} = (1 - c) D_t$, where $D_t$ is the LD coefficient at generation $t$ and $c$ is the total recombination fraction per generation between the loci. After $s$ generations, the LD becomes $D_s = (1 - c)^s D_0$, where $D_0$ is the initial LD. The normalized LD, $y(d)$, is the ratio $D_s/D_0$.\n$$\ny(d) = \\frac{D_s(d)}{D_0(d)} = (1 - c(d))^s\n$$\nHere, the recombination fraction $c$ is a function of the physical distance $d$ between the loci. For small $c(d)$, which is a valid assumption for per-generation rates over short physical distances, we can use the approximation $(1 - c(d)) \\approx e^{-c(d)}$. This yields:\n$$\ny(d) \\approx (e^{-c(d)})^s = e^{-s \\cdot c(d)}\n$$\nThe problem states that recombination is the result of two independent processes: crossovers (CO) and gene conversions (GC). The total probability of at least one recombination event is $c(d) = c_{CO}(d) + c_{GC}(d) - c_{CO}(d)c_{GC}(d)$. Since these are rare events on a per-generation, per-basepair scale, the product term $c_{CO}(d)c_{GC}(d)$ is negligible compared to the linear terms. Therefore, the total recombination probability is, to a very good approximation, the sum of the individual probabilities:\n$$\nc(d) \\approx c_{CO}(d) + c_{GC}(d)\n$$\nThis is equivalent to the statement that the total hazard of recombination is the sum of the hazards of the independent processes. Let $h(d)$ be the total hazard rate, such that $c(d) \\approx h(d) = h_{CO}(d) + h_{GC}(d)$.\n\nFirst, we model the crossover component, $h_{CO}(d)$. Crossovers are assumed to occur with a uniform rate $r$ per base pair per generation. For two loci separated by a distance $d$, the expected number of crossovers in the interval is $r \\cdot d$. Assuming a Poisson process for crossovers, the probability of zero crossovers is $e^{-rd}$, and the probability of at least one is $1 - e^{-rd}$. The hazard, which is the parameter of the exponential waiting distance between events, is simply the rate parameter, so the contribution to the total hazard is:\n$$\nh_{CO}(d) = r \\cdot d\n$$\n\nSecond, we model the gene conversion component, $h_{GC}(d)$. A gene conversion event is characterized by an initiation position and a tract length $L$. Initiations occur uniformly with a rate $g$ per base pair per generation, and tract lengths are drawn from an exponential distribution with mean $\\ell$, having a probability density function $f(L) = (1/\\ell)e^{-L/\\ell}$ for $L \\ge 0$. A gene conversion event causes recombination between two loci if its tract covers one locus but not the other.\n\nLet the two loci be located at positions $0$ and $d$. We calculate the rate at which gene conversion tracts separate these loci. This can happen in two mutually exclusive ways:\n1. A tract covers the locus at $0$ but not the one at $d$.\n2. A tract covers the locus at $d$ but not the one at $0$.\n\nFor case 1, consider a tract initiated at position $x \\le 0$. For it to cover the locus at $0$, its length $L$ must be at least $-x$. For it to not cover the locus at $d$, its length $L$ must be less than $d-x$. The rate is found by integrating over all possible initiation points $x \\le 0$ and all relevant tract lengths $L$:\n$$\n\\text{Rate}_1 = \\int_{-\\infty}^{0} g \\left( \\int_{-x}^{d-x} \\frac{1}{\\ell} e^{-L/\\ell} dL \\right) dx\n$$\nThe inner integral evaluates to $[-e^{-L/\\ell}]_{-x}^{d-x} = e^{-(-x)/\\ell} - e^{-(d-x)/\\ell} = e^{x/\\ell} - e^{-(d-x)/\\ell}$.\nSubstituting this into the outer integral:\n$$\n\\text{Rate}_1 = g \\int_{-\\infty}^{0} (e^{x/\\ell} - e^{-(d-x)/\\ell}) dx = g \\left[ \\ell e^{x/\\ell} - \\ell e^{-(d-x)/\\ell} \\right]_{-\\infty}^{0}\n$$\n$$\n\\text{Rate}_1 = g \\left( (\\ell e^0 - \\ell e^{-d/\\ell}) - (0 - 0) \\right) = g\\ell(1 - e^{-d/\\ell})\n$$\nBy symmetry, the rate for case 2 (a tract covering the locus at $d$ but not the one at $0$) is identical. This can be conceptualized by placing the origin at $d$ and considering the second locus at $-d$.\nTherefore, the total hazard of recombination due to gene conversion is the sum of these two rates:\n$$\nh_{GC}(d) = \\text{Rate}_1 + \\text{Rate}_2 = 2g\\ell(1 - e^{-d/\\ell})\n$$\nThe total recombination hazard $c(d)$ is the sum of the crossover and gene conversion hazards:\n$$\nc(d) \\approx h(d) = h_{CO}(d) + h_{GC}(d) = rd + 2g\\ell(1 - e^{-d/\\ell})\n$$\nSubstituting this into the expression for normalized LD, we obtain the final model:\n$$\ny(d) = \\exp\\left[-s \\left( rd + 2g\\ell(1-e^{-d/\\ell}) \\right)\\right]\n$$\nThis completes the derivation for Task 1.\n\n**Task 2: Non-Linear Least Squares Estimator**\n\nThe goal is to estimate the unknown parameters $g$ (gene conversion initiation rate) and $r$ (crossover rate) from empirical data. The data consists of a set of $N$ pairs of physical distances and observed normalized LD values, $\\{ (d_i, y_i) \\}_{i=1}^N$. We are given the effective timescale $s$ and the mean gene conversion tract length $\\ell$.\n\nWe define a model function $\\hat{y}(d_i; g, r)$ based on the derivation above:\n$$\n\\hat{y}(d_i; g, r) = \\exp\\left[-s \\left( r d_i + 2g\\ell(1-e^{-d_i/\\ell}) \\right)\\right]\n$$\nThe parameters $(g, r)$ must be estimated by minimizing the sum of squared residuals (SSR) between the observed values $y_i$ and the model predictions $\\hat{y}(d_i; g, r)$. The objective function $S(g,r)$ is:\n$$\nS(g,r) = \\sum_{i=1}^{N} \\left[ y_i - \\hat{y}(d_i; g, r) \\right]^2\n$$\nThis is a non-linear least squares problem. The minimization must be performed subject to the physical constraints that the rates cannot be negative:\n$$\ng \\ge 0, \\quad r \\ge 0\n$$\nWe will employ a numerical optimization algorithm, specifically the L-BFGS-B method, which is suitable for this type of bound-constrained non-linear problem. The algorithm requires an initial guess for the parameters $(g,r)$. Based on typical biological values, an initial guess of $(10^{-8}, 10^{-8})$ for $(g, r)$ in units of events per base per generation is a reasonable starting point.\n\n**Task 3: Application to Test Suite**\n\nThe implemented estimator will be applied to the three provided test cases. For each case, the given datasets $(s, \\ell, \\{d_i\\}, \\{y_i\\})$ will be used. The optimization procedure described in Task 2 will be executed to find the optimal values $(\\hat{g}, \\hat{r})$ that minimize the SSR. The results for each test case will be reported in scientific notation with three significant figures.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating recombination parameters from LD data.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"s\": 10000.0,\n            \"ell\": 300.0,\n            \"d\": np.array([0.0, 25.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0, 5000.0, 10000.0]),\n            \"y\": np.array([1.000000, 0.996367, 0.992798, 0.985834, 0.972492, 0.935681, 0.880097, 0.780800, 0.544571, 0.298568]),\n        },\n        {\n            \"s\": 10000.0,\n            \"ell\": 500.0,\n            \"d\": np.array([0.0, 1000.0, 2000.0, 5000.0, 10000.0, 20000.0]),\n            \"y\": np.array([1.000000, 0.904837, 0.818731, 0.606531, 0.367879, 0.135335]),\n        },\n        {\n            \"s\": 8000.0,\n            \"ell\": 100.0,\n            \"d\": np.array([0.0, 10.0, 20.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0]),\n            \"y\": np.array([1.000000, 0.998535, 0.997176, 0.993614, 0.988986, 0.982468, 0.969364, 0.950096, 0.912822]),\n        }\n    ]\n\n    results = []\n\n    # Model function for normalized LD\n    def model_y(params, d, s, ell):\n        \"\"\"\n        Calculates predicted normalized LD based on the derived model.\n        params: tuple (g, r)\n            g: gene conversion initiation rate per base\n            r: crossover rate per base\n        d: array of distances in base pairs\n        s: effective timescale in generations\n        ell: mean gene conversion tract length in base pairs\n        \"\"\"\n        g, r = params\n        recombination_hazard = r * d + 2 * g * ell * (1 - np.exp(-d / ell))\n        return np.exp(-s * recombination_hazard)\n\n    # Objective function: Sum of Squared Residuals\n    def objective_ssr(params, d_obs, y_obs, s, ell):\n        \"\"\"\n        Calculates the sum of squared residuals between observed and predicted y.\n        \"\"\"\n        y_pred = model_y(params, d_obs, s, ell)\n        return np.sum((y_obs - y_pred)**2)\n\n    for case in test_cases:\n        s = case[\"s\"]\n        ell = case[\"ell\"]\n        d_obs = case[\"d\"]\n        y_obs = case[\"y\"]\n\n        # Initial guess for parameters (g, r)\n        initial_guess = (1e-8, 1e-8)\n\n        # Parameter bounds (g = 0, r = 0)\n        bounds = [(0, None), (0, None)]\n\n        # Perform non-linear least squares optimization\n        result = minimize(\n            fun=objective_ssr,\n            x0=initial_guess,\n            args=(d_obs, y_obs, s, ell),\n            method='L-BFGS-B',\n            bounds=bounds\n        )\n\n        g_hat, r_hat = result.x\n        results.append(f\"[{g_hat:.2e},{r_hat:.2e}]\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[[{results[0][1:-1]},{results[1][1:-1]},{results[2][1:-1]}]]\")\n\nsolve()\n```", "id": "2699672"}]}