{"hands_on_practices": [{"introduction": "Before exploring the solutions to the evolution of cooperation, it's essential to formalize why it presents a paradox from the perspective of individual selection. This exercise guides you through the construction of the classic Prisoner's Dilemma game from the simple biological parameters of cost ($c$) and benefit ($b$). By analyzing the strategic incentives, you will discover why rational self-interest appears to fundamentally oppose the evolution of altruistic behavior, setting the stage for the theories that follow. [@problem_id:2707910]", "problem": "Consider a symmetric two-player social interaction in which each individual chooses between two actions, $C$ (cooperate) and $D$ (defect). Cooperation is modeled as an other-regarding act that imposes a fitness cost $c$ on the actor and yields a fitness benefit $b$ to the recipient, with $b$ and $c$ both strictly positive. Defection imposes no cost and produces no benefit. Assume one-shot interactions and payoffs measured as additive fitness increments from the interaction. Use these premises, together with the following foundational definitions, to construct and analyze the game:\n- A $2 \\times 2$ normal-form game lists the fitness payoffs to the row and column players for each joint action $(C,D)$.\n- A Prisoner’s Dilemma (PD) is a symmetric $2 \\times 2$ game with actions labeled $C$ and $D$ and payoffs $R$ (reward for mutual cooperation), $T$ (temptation payoff to unilateral defection), $S$ (sucker’s payoff to unilateral cooperation), and $P$ (punishment for mutual defection), satisfying the strict inequalities $TRPS$.\n- A Nash equilibrium is a joint action profile in which each player’s action is a best response to the other’s action; equivalently, no single player can increase their payoff by unilaterally deviating.\n\nTasks:\n1. From the biological premises alone, construct the $2 \\times 2$ payoff matrix whose entries are ordered pairs of payoffs $(\\pi_{\\text{row}},\\pi_{\\text{col}})$ as functions of $b$ and $c$. Label rows by the row player’s actions $C$ and $D$, and columns by the column player’s actions $C$ and $D$.\n2. Derive the necessary and sufficient inequalities on $b$ and $c$ under which the resulting game is a Prisoner’s Dilemma as defined above.\n3. Using the definition of best response and Nash equilibrium, identify all Nash equilibria (pure or mixed) of this game under the PD parameter regime you derived in step $2$. Express the equilibrium as cooperation probabilities for the two players, $p^{\\ast}$ for the row player and $q^{\\ast}$ for the column player, where $p^{\\ast}$ is the probability of playing $C$ and $q^{\\ast}$ is the probability of playing $C$.\nReport your final answer as a single row vector $\\big(p^{\\ast}\\;\\;q^{\\ast}\\big)$. No units are required. No rounding is required.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\nStep 1: Extraction of Givens.\n- A symmetric two-player social interaction game.\n- Action set for each player: {$C$, $D$}, where $C$ is 'cooperate' and $D$ is 'defect'.\n- Cost of cooperation for the actor: $c$.\n- Benefit of cooperation for the recipient: $b$.\n- Constraints on parameters: $c  0$ and $b  0$.\n- Defection imposes no cost and yields no benefit.\n- Interactions are one-shot.\n- Payoffs are additive fitness increments.\n- A $2 \\times 2$ normal-form game has payoff entries $(\\pi_{\\text{row}}, \\pi_{\\text{col}})$.\n- Definition of Prisoner’s Dilemma (PD): A symmetric $2 \\times 2$ game with payoffs $R, S, T, P$ satisfying the strict inequalities $T  R  P  S$.\n- Definition of Nash equilibrium (NE): No player can improve their payoff by a unilateral change in strategy.\n\nStep 2: Validation of Givens.\nThe problem is scientifically grounded, relying on the foundational model of the Prisoner's Dilemma from evolutionary game theory. It is well-posed, providing all necessary definitions and parameters ($b$, $c$) to construct the game matrix and analyze its properties. The problem is objective and uses precise, standard terminology from the field. It is not incomplete, contradictory, or based on false premises. All tasks are logically derivable from the provided information.\n\nStep 3: Verdict.\nThe problem statement is deemed valid. A complete solution will now be furnished.\n\nThe solution proceeds in three parts as requested by the problem statement.\n\nPart 1: Construction of the Payoff Matrix.\nThe payoffs represent the net change in fitness. We analyze the four possible outcomes of the interaction. Let $\\pi_i$ denote the payoff to player $i$.\n\n- Outcome 1: (Cooperate, Cooperate). Both players choose action $C$. Each player pays a cost $c$ to cooperate and receives a benefit $b$ from the other's cooperation.\n$$ \\pi_{\\text{row}} = \\pi_{\\text{col}} = b - c $$\nThis is the Reward payoff, $R = b - c$.\n\n- Outcome 2: (Cooperate, Defect). The row player cooperates, and the column player defects. The row player pays a cost $c$ but receives no benefit. The column player pays no cost but receives a benefit $b$.\n$$ \\pi_{\\text{row}} = -c $$\n$$ \\pi_{\\text{col}} = b $$\nThese are the Sucker's payoff, $S = -c$, and the Temptation payoff, $T = b$, respectively.\n\n- Outcome 3: (Defect, Cooperate). By symmetry with the previous case, the row player defects and the column player cooperates.\n$$ \\pi_{\\text{row}} = b $$\n$$ \\pi_{\\text{col}} = -c $$\nHere, $\\pi_{\\text{row}} = T$ and $\\pi_{\\text{col}} = S$.\n\n- Outcome 4: (Defect, Defect). Both players choose action $D$. Neither player pays a cost nor receives a benefit.\n$$ \\pi_{\\text{row}} = \\pi_{\\text{col}} = 0 $$\nThis is the Punishment payoff, $P = 0$.\n\nArranging these payoffs into a $2 \\times 2$ matrix, with rows for the row player's actions and columns for the column player's actions, we obtain:\n$$\n\\begin{array}{c|cc}\n\\multicolumn{1}{c}{}  C  D \\\\\n\\cline{2-3}\nC  (b-c, b-c)  (-c, b) \\\\\nD  (b, -c)  (0, 0) \\\\\n\\end{array}\n$$\n\nPart 2: Derivation of the Prisoner’s Dilemma Condition.\nThe game is a Prisoner’s Dilemma if the payoffs satisfy the strict inequality $T  R  P  S$. We substitute the expressions derived in Part 1:\n$$ b  b-c  0  -c $$\nThis compound inequality consists of three separate inequalities that must hold simultaneously:\n1. $T  R \\implies b  b - c \\implies 0  -c \\implies c  0$. This condition is already given in the problem statement.\n2. $R  P \\implies b - c  0 \\implies b  c$. This is a necessary condition on the relationship between the benefit and the cost.\n3. $P  S \\implies 0  -c \\implies c  0$. This condition is also given.\n\nThe initial premises are $b  0$ and $c  0$. The analysis reveals one additional constraint: $b  c$. Therefore, for the interaction to be correctly classified as a Prisoner's Dilemma, the necessary and sufficient condition, in addition to the positivity of $b$ and $c$, is that the benefit from cooperation must exceed its cost.\n\nPart 3: Identification of Nash Equilibria.\nWe must find all pure and mixed Nash equilibria for the game under the Prisoner's Dilemma condition, i.e., $b  c  0$.\n\nFirst, we search for pure strategy Nash equilibria (PSNE). A PSNE is an action profile where neither player has a unilateral incentive to deviate.\n- Consider the profile $(C, C)$. The row player's payoff is $b-c$. If this player unilaterally deviates to $D$, their payoff becomes $b$. Since $b  b-c$ (because $c  0$), the row player has an incentive to deviate. Thus, $(C, C)$ is not a NE.\n- Consider the profile $(C, D)$. The row player's payoff is $-c$. If this player unilaterally deviates to $D$, their payoff becomes $0$. Since $0  -c$ (because $c  0$), the row player has an incentive to deviate. Thus, $(C, D)$ is not a NE.\n- Consider the profile $(D, C)$. The column player's payoff is $-c$. If this player unilaterally deviates to $D$, their payoff becomes $0$. Since $0  -c$, the column player has an incentive to deviate. Thus, $(D, C)$ is not a NE.\n- Consider the profile $(D, D)$. The row player's payoff is $0$. If this player unilaterally deviates to $C$, their payoff becomes $-c$. Since $0  -c$, the row player has no incentive to deviate. By symmetry, the column player's payoff is also $0$, and a unilateral deviation to $C$ would yield a payoff of $-c$. The column player also has no incentive to deviate.\nTherefore, $(D, D)$ is the unique pure strategy Nash equilibrium.\n\nAlternatively, and more decisively, we can identify dominant strategies. For the row player, regardless of the column player's action, defecting yields a strictly higher payoff:\n- If Col plays $C$, Row gets $b$ from playing $D$ and $b-c$ from playing $C$. Since $b  b-c$, $D$ is the better response.\n- If Col plays $D$, Row gets $0$ from playing $D$ and $-c$ from playing $C$. Since $0  -c$, $D$ is the better response.\nAction $D$ is a strictly dominant strategy for the row player. By symmetry, $D$ is also a strictly dominant strategy for the column player. The unique Nash equilibrium in a game where both players have a strictly dominant strategy is the profile where both play that strategy. This again leads to $(D, D)$.\n\nNext, we search for mixed strategy Nash equilibria (MSNE). An MSNE can only exist if players are indifferent between their pure strategies. Let $p$ be the probability that the row player chooses $C$, and $q$ be the probability that the column player chooses $C$.\nFor the row player to be indifferent between $C$ and $D$, the expected payoff from each must be equal.\n$$ E[\\pi_{\\text{row}}(C)] = q(b-c) + (1-q)(-c) = qb - qc - c + qc = qb - c $$\n$$ E[\\pi_{\\text{row}}(D)] = q(b) + (1-q)(0) = qb $$\nSetting $E[\\pi_{\\text{row}}(C)] = E[\\pi_{\\text{row}}(D)]$ gives:\n$$ qb - c = qb \\implies -c = 0 $$\nThis is a contradiction, as we are given $c  0$. This means the row player is never indifferent for any $q \\in [0, 1]$. In fact, since $-c  0$, we have $E[\\pi_{\\text{row}}(C)]  E[\\pi_{\\text{row}}(D)]$ for all $q$. The best response for the row player is always to play $D$, which means setting their probability of playing $C$ to zero.\nThus, there is no mixed strategy equilibrium in which players randomize with non-zero probability (i.e., $p \\in (0,1)$ or $q \\in (0,1)$).\n\nThe only Nash equilibrium is the pure strategy equilibrium $(D, D)$. We express this equilibrium in terms of the probabilities of cooperation, $p^{\\ast}$ for the row player and $q^{\\ast}$ for the column player.\n- The action $D$ (defect) corresponds to a probability of playing $C$ of $0$.\n- Thus, for the row player, $p^{\\ast} = 0$.\n- For the column player, $q^{\\ast} = 0$.\nThe equilibrium strategy profile is $(p^{\\ast}, q^{\\ast}) = (0, 0)$.\nThe final answer is to be presented as a row vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0\n\\end{pmatrix}\n}\n$$", "id": "2707910"}, {"introduction": "W.D. Hamilton's theory of kin selection provided the first major breakthrough in explaining altruism, encapsulated in an inequality often expressed as $rB  C$. The power of this rule lies in the coefficient of relatedness, $r$, which quantifies the probability that interacting individuals share genes that are identical by descent. This practice provides a concrete method for calculating $r$ using pedigree path analysis, grounding the abstract concept of kin selection in the tangible mechanics of Mendelian inheritance. [@problem_id:2707903]", "problem": "Consider a diploid, autosomal pedigree relevant to evaluating Hamilton’s rule for the evolution of cooperation. A founder pair, denoted $G_1$ and $G_2$, are unrelated and non-inbred. They produce two full-sibling offspring, denoted $S_1$ and $S_2$. Individual $S_1$ mates with an unrelated, non-inbred founder $U_1$ to produce individual $A$. Individual $S_2$ mates with an unrelated, non-inbred founder $U_2$ to produce individual $B$. Thus, $A$ and $B$ are first cousins. All matings not explicitly mentioned are assumed to involve unrelated, non-inbred individuals. Assume Mendelian segregation, with each meiosis transmitting each of the two alleles with probability $1/2$, and no mutation.\n\nUsing only first-principles definitions of identity by descent and kinship (without relying on any unproved “canned” formulas), compute the coefficient of relatedness $r_{A,B}$ between $A$ and $B$ by explicit path counting or by deriving the kinship coefficient. Express the final answer as an exact fraction with no units. No rounding is required.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted verbatim.\n- A diploid, autosomal pedigree is considered.\n- A founder pair, $G_1$ and $G_2$, are unrelated and non-inbred.\n- They produce two full-sibling offspring, $S_1$ and $S_2$.\n- Individual $S_1$ mates with an unrelated, non-inbred founder $U_1$ to produce individual $A$.\n- Individual $S_2$ mates with an unrelated, non-inbred founder $U_2$ to produce individual $B$.\n- Individuals $A$ and $B$ are first cousins.\n- All matings not explicitly mentioned involve unrelated, non-inbred individuals.\n- Mendelian segregation occurs, with each meiosis transmitting each of the two alleles with probability $1/2$.\n- No mutation is assumed.\n- The task is to compute the coefficient of relatedness $r_{A,B}$ between $A$ and $B$.\n- The method must be from first principles (identity by descent, path counting, or kinship coefficient derivation) without using unproved formulas.\n\nSecond, the validity of the problem is assessed. The problem is scientifically grounded, rooted in the fundamental principles of Mendelian and population genetics. It is well-posed, providing a clearly defined pedigree and a complete set of assumptions (diploidy, autosomal inheritance, non-inbred and unrelated founders, Mendelian segregation) that permit a unique and stable solution. The language is objective and precise. The problem does not violate any of the specified criteria for invalidity; it is a standard, formalizable exercise in calculating genetic relatedness.\n\nThe verdict is that the problem is **valid**. A solution will be provided.\n\nThe coefficient of relatedness, $r_{X,Y}$, between two individuals $X$ and $Y$ is a measure of the extent to which they share alleles that are identical by descent (IBD). For diploid, non-inbred individuals, this coefficient is equivalent to the sum of probabilities that an allele drawn from $X$ is IBD with one from $Y$, calculated over all paths of descent through common ancestors. The path counting method provides a direct, first-principles approach. The formula is given by:\n$$r_{X,Y} = \\sum_{\\text{paths}} \\left( \\frac{1}{2} \\right)^n$$\nwhere the sum is over all distinct paths of gene transmission connecting $X$ and $Y$ through their common ancestors, and $n$ is the number of meiotic steps in a given path. This simplified formula applies because all common ancestors ($G_1$ and $G_2$) are stipulated to be non-inbred, meaning their inbreeding coefficient $F$ is $0$.\n\nWe must first identify the common ancestors of individuals $A$ and $B$. The parents of $A$ are $S_1$ and $U_1$. The parents of $B$ are $S_2$ and $U_2$. The parents of $S_1$ and $S_2$ are $G_1$ and $G_2$. The individuals $U_1$ and $U_2$ are unrelated founders and are therefore not ancestors of both $A$ and $B$. The common ancestors of $A$ and $B$ are their shared grandparents, $G_1$ and $G_2$.\n\nWe can now trace all paths connecting $A$ and $B$ through these common ancestors. A valid path consists of moving up the pedigree from one individual to a common ancestor and then down to the other individual.\n\nPath 1: Through the common ancestor $G_1$.\nThe path of descent is $A \\leftarrow S_1 \\leftarrow G_1 \\rightarrow S_2 \\rightarrow B$.\nLet's count the number of meiotic divisions (steps) in this path:\n1.  From $G_1$ to $S_1$: $1$ step.\n2.  From $S_1$ to $A$: $1$ step.\n3.  From $G_1$ to $S_2$: $1$ step.\n4.  From $S_2$ to $B$: $1$ step.\nThe total number of steps in this path is $n_1 = 1 + 1 + 1 + 1 = 4$.\nThe contribution to relatedness from this path is $\\left( \\frac{1}{2} \\right)^{4}$.\n\nPath 2: Through the common ancestor $G_2$.\nThe path of descent is $A \\leftarrow S_1 \\leftarrow G_2 \\rightarrow S_2 \\rightarrow B$.\nThe number of steps in this path is calculated similarly:\n1.  From $G_2$ to $S_1$: $1$ step.\n2.  From $S_1$ to $A$: $1$ step.\n3.  From $G_2$ to $S_2$: $1$ step.\n4.  From $S_2$ to $B$: $1$ step.\nThe total number of steps in this path is $n_2 = 1 + 1 + 1 + 1 = 4$.\nThe contribution to relatedness from this path is $\\left( \\frac{1}{2} \\right)^{4}$.\n\nThere are no other common ancestors, and thus no other paths for gene flow that would result in alleles being identical by descent between $A$ and $B$.\n\nThe total coefficient of relatedness $r_{A,B}$ is the sum of the contributions from all distinct paths:\n$$r_{A,B} = \\left( \\frac{1}{2} \\right)^{n_1} + \\left( \\frac{1}{2} \\right)^{n_2}$$\n$$r_{A,B} = \\left( \\frac{1}{2} \\right)^{4} + \\left( \\frac{1}{2} \\right)^{4}$$\n$$r_{A,B} = \\frac{1}{16} + \\frac{1}{16}$$\n$$r_{A,B} = \\frac{2}{16}$$\n$$r_{A,B} = \\frac{1}{8}$$\n\nThis result corresponds to the well-known relatedness between first cousins. The calculation from first principles confirms this value.", "answer": "$$\\boxed{\\frac{1}{8}}$$", "id": "2707903"}, {"introduction": "While kin selection offers a powerful explanation, modern social evolution theory provides more general frameworks that can unify different perspectives, such as kin and multilevel selection. This exercise employs the Price equation, a fundamental tool for describing evolutionary change, to analyze the fate of a social trait based on its fitness effects within and between groups. By deriving the conditions for altruism to increase, you will see how relatedness emerges as a general statistical association between an individual's trait and the traits of its social partners, offering a deeper and more flexible view of Hamilton's rule. [@problem_id:2707875]", "problem": "In a large, haploid, group-structured population, consider a continuous, additive social trait $z$ that affects both individual and group components of fitness under weak selection. Let the absolute fitness of individual $i$ in group $g$ be given by a linear approximation\n$$\nw_i \\approx 1 + s_w z_i + s_b \\bar{z}_g,\n$$\nwhere $z_i$ is the trait value of the focal individual, $\\bar{z}_g$ is the mean trait value of the focal’s social environment (the group mean), $s_w$ is the within-group selection gradient (the partial effect of $z_i$ on $w_i$ holding $\\bar{z}_g$ fixed), and $s_b$ is the between-group selection gradient (the partial effect of $\\bar{z}_g$ on group mean fitness). Assume weak selection so that higher-order terms in $s_w$ and $s_b$ can be neglected, and ignore transmission bias.\n\nStarting from the Price equation $\\Delta \\bar{z} = \\frac{1}{\\bar{w}} \\operatorname{Cov}(w_i, z_i)$, and using the linear fitness approximation above together with the definition of regression relatedness\n$$\nr \\equiv \\frac{\\operatorname{Cov}(\\bar{z}_g, z_i)}{\\operatorname{Var}(z_i)},\n$$\nderive the threshold relatedness $r_{\\min}$ such that $\\Delta \\bar{z}  0$ if and only if $r  r_{\\min}$. Then, for the empirically estimated selection gradients $s_w = -0.02$ and $s_b = 0.03$, compute the exact value of $r_{\\min}$.\n\nExpress the final answer as a single reduced fraction with no additional commentary. No rounding is required, and no units are involved.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It represents a standard derivation in the field of social evolution. Proceeding with the solution.\n\nThe evolution of the mean trait value $\\bar{z}$ is described by the Price equation, given as:\n$$\n\\Delta \\bar{z} = \\frac{1}{\\bar{w}} \\operatorname{Cov}(w_i, z_i)\n$$\nwhere $\\Delta \\bar{z}$ is the change in the population mean trait value across one generation, $\\bar{w}$ is the mean fitness of the population, $w_i$ is the fitness of individual $i$, and $z_i$ is its trait value. The covariance is taken over all individuals in the population.\n\nFor the trait to increase in frequency, we must have $\\Delta \\bar{z}  0$. Since mean fitness $\\bar{w}$ must be positive, this condition is equivalent to:\n$$\n\\operatorname{Cov}(w_i, z_i)  0\n$$\nThe problem provides a linear approximation for individual fitness:\n$$\nw_i \\approx 1 + s_w z_i + s_b \\bar{z}_g\n$$\nwhere $z_i$ is the individual's trait value, $\\bar{z}_g$ is the mean trait value of its group, and $s_w$ and $s_b$ are the within-group and between-group selection gradients, respectively. We substitute this expression for $w_i$ into the covariance term:\n$$\n\\operatorname{Cov}(1 + s_w z_i + s_b \\bar{z}_g, z_i)  0\n$$\nUsing the properties of the covariance operator, specifically $\\operatorname{Cov}(aX+bY+c, Z) = a\\operatorname{Cov}(X,Z) + b\\operatorname{Cov}(Y,Z)$, this inequality expands to:\n$$\n\\operatorname{Cov}(1, z_i) + \\operatorname{Cov}(s_w z_i, z_i) + \\operatorname{Cov}(s_b \\bar{z}_g, z_i)  0\n$$\nThe covariance of a constant with a variable is zero, so $\\operatorname{Cov}(1, z_i) = 0$. The other terms simplify as:\n$$\ns_w \\operatorname{Cov}(z_i, z_i) + s_b \\operatorname{Cov}(\\bar{z}_g, z_i)  0\n$$\nRecognizing that $\\operatorname{Cov}(z_i, z_i)$ is by definition the variance of $z_i$, denoted $\\operatorname{Var}(z_i)$, we have:\n$$\ns_w \\operatorname{Var}(z_i) + s_b \\operatorname{Cov}(\\bar{z}_g, z_i)  0\n$$\nTo proceed, we introduce the definition of regression relatedness, $r$, provided in the problem statement:\n$$\nr \\equiv \\frac{\\operatorname{Cov}(\\bar{z}_g, z_i)}{\\operatorname{Var}(z_i)}\n$$\nThis allows us to express the covariance between the group mean trait and the individual trait in terms of relatedness and variance:\n$$\n\\operatorname{Cov}(\\bar{z}_g, z_i) = r \\operatorname{Var}(z_i)\n$$\nSubstituting this back into our inequality gives:\n$$\ns_w \\operatorname{Var}(z_i) + s_b \\left( r \\operatorname{Var}(z_i) \\right)  0\n$$\nWe can factor out the variance term $\\operatorname{Var}(z_i)$:\n$$\n(s_w + r s_b) \\operatorname{Var}(z_i)  0\n$$\nFor evolution to occur, there must be variation in the trait, which means $\\operatorname{Var}(z_i)  0$. Therefore, we can divide by $\\operatorname{Var}(z_i)$ without changing the direction of the inequality, yielding the condition for the trait to increase:\n$$\ns_w + r s_b  0\n$$\nThis is a form of Hamilton's rule. We are tasked with finding the threshold relatedness $r_{\\min}$ such that the trait increases ($\\Delta \\bar{z}  0$) if and only if $r  r_{\\min}$. We rearrange the inequality to solve for $r$:\n$$\nr s_b  -s_w\n$$\nTo isolate $r$, we must divide by $s_b$. The direction of the inequality depends on the sign of $s_b$. In the context of social evolution, a positive $s_b$ implies that a higher mean group trait value increases individual fitness, which corresponds to a cooperative or altruistic trait. The given value $s_b = 0.03$ is positive. Dividing by a positive $s_b$ preserves the inequality direction:\n$$\nr  -\\frac{s_w}{s_b}\n$$\nFrom this, we identify the threshold relatedness as:\n$$\nr_{\\min} = -\\frac{s_w}{s_b}\n$$\nThis is the general solution. Now, we compute the specific value for the given selection gradients, $s_w = -0.02$ and $s_b = 0.03$.\n$$\nr_{\\min} = -\\frac{(-0.02)}{(0.03)} = \\frac{0.02}{0.03}\n$$\nTo express this as a reduced fraction:\n$$\nr_{\\min} = \\frac{2/100}{3/100} = \\frac{2}{3}\n$$\nThis is the minimum relatedness required for the social trait to be favored by selection under the specified conditions.", "answer": "$$\n\\boxed{\\frac{2}{3}}\n$$", "id": "2707875"}]}