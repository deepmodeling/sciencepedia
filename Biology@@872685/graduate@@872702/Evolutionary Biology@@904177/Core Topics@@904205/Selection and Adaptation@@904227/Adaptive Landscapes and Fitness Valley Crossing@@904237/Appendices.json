{"hands_on_practices": [{"introduction": "The topography of an adaptive landscape is shaped by epistasisâ€”the non-additive interactions between mutations. This first exercise provides a hands-on approach to quantifying these interactions, focusing on the Malthusian fitness scale, which is fundamental to modeling selection dynamics. By analyzing a simple two-locus system, you will learn to identify reciprocal sign epistasis, the key feature that creates a fitness valley and poses a significant challenge to evolving populations [@problem_id:2689273].", "problem": "Consider an asexual haploid population with two loci, each biallelic, giving genotypes $\\{00,01,10,11\\}$. The relative fitnesses (dimensionless, measured under constant laboratory conditions) of these genotypes are $w_{00}=1.000$, $w_{01}=0.980$, $w_{10}=0.990$, and $w_{11}=1.050$. Let the Malthusian fitness be defined as $m=\\ln w$. In the adaptive landscape framework, assume additivity on the Malthusian scale as the null model across loci, and define pairwise epistasis on the Malthusian scale as the deviation of the observed double-mutant Malthusian fitness from that additive expectation. \n\nUsing only these definitions and the standard properties of the natural logarithm, compute the pairwise epistasis coefficient on the Malthusian scale, denoted $\\epsilon$, from the given fitnesses. Then, based on fundamental definitions, classify the epistatic regime by addressing:\n- whether there is no epistasis, magnitude epistasis (positive or negative on the Malthusian scale), sign epistasis, or reciprocal sign epistasis, where sign epistasis refers to a mutation having opposite sign of effect in different genetic backgrounds.\n\nReport the numerical value of $\\epsilon$ as your final answer. Round your final numerical answer to four significant figures. Express the final answer as a pure number with no units.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens.\n- Population: Asexual haploid.\n- Genotypes: Two loci, biallelic, giving $\\{00, 01, 10, 11\\}$.\n- Relative fitnesses: $w_{00} = 1.000$, $w_{01} = 0.980$, $w_{10} = 0.990$, $w_{11} = 1.050$.\n- Definition of Malthusian fitness: $m = \\ln w$.\n- Null model: Additivity on the Malthusian scale.\n- Definition of pairwise epistasis on the Malthusian scale ($\\epsilon$): The deviation of the observed double-mutant Malthusian fitness from the additive expectation.\n- Task 1: Compute the numerical value of $\\epsilon$.\n- Task 2: Classify the epistatic regime (no epistasis, magnitude epistasis, sign epistasis, or reciprocal sign epistasis).\n- Final answer requirement: Report $\\epsilon$ rounded to four significant figures.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded. The concepts of relative fitness ($w$), Malthusian fitness ($m = \\ln w$), and epistasis are fundamental to population genetics and evolutionary theory. The definition of epistasis on the logarithmic scale as the deviation from additivity ($\\epsilon = m_{11} - m_{10} - m_{01} + m_{00}$) is a standard and rigorous formulation. The problem is well-posed, providing all necessary data and definitions for a unique solution. The language is objective and precise. The fitness values are realistic for microbial evolution experiments. The problem is self-contained and free of contradictions or ambiguities.\n\nStep 3: Verdict and Action.\nThe problem is valid. A complete solution will be provided.\n\nThe Malthusian fitness, $m$, is defined as the natural logarithm of the relative fitness, $w$. We first compute the Malthusian fitness for each of the four genotypes. The genotype $00$ is the reference, or \"wild-type\".\n\nThe Malthusian fitness values are:\n$m_{00} = \\ln(w_{00}) = \\ln(1.000) = 0$\n$m_{01} = \\ln(w_{01}) = \\ln(0.980)$\n$m_{10} = \\ln(w_{10}) = \\ln(0.990)$\n$m_{11} = \\ln(w_{11}) = \\ln(1.050)$\n\nThe null model of no epistasis assumes additivity of mutational effects on the Malthusian fitness scale. The effect of the first mutation (at locus $1$, changing allele $0$ to $1$) in the background of genotype $00$ is $\\Delta m_1 = m_{10} - m_{00}$. The effect of the second mutation (at locus $2$, changing allele $0$ to $1$) in the background of genotype $00$ is $\\Delta m_2 = m_{01} - m_{00}$.\n\nUnder the additive model, the expected Malthusian fitness of the double mutant, $m_{11}^{\\text{add}}$, would be the sum of the reference fitness and the individual effects of each mutation:\n$m_{11}^{\\text{add}} = m_{00} + \\Delta m_1 + \\Delta m_2 = m_{00} + (m_{10} - m_{00}) + (m_{01} - m_{00})$\nSince $m_{00} = 0$, this simplifies to $m_{11}^{\\text{add}} = m_{10} + m_{01}$.\n\nPairwise epistasis on the Malthusian scale, $\\epsilon$, is defined as the deviation of the observed double-mutant Malthusian fitness ($m_{11}$) from this additive expectation ($m_{11}^{\\text{add}}$).\n$\\epsilon = m_{11} - m_{11}^{\\text{add}}$\nSubstituting the expression for $m_{11}^{\\text{add}}$ gives the general formula for two-locus epistasis:\n$\\epsilon = m_{11} - (m_{10} + m_{01})$\nOr, including the reference genotype explicitly:\n$\\epsilon = m_{11} - m_{10} - m_{01} + m_{00}$\n\nNow, we substitute the Malthusian fitness values derived from the given relative fitnesses:\n$\\epsilon = \\ln(w_{11}) - \\ln(w_{10}) - \\ln(w_{01}) + \\ln(w_{00})$\nUsing the properties of the natural logarithm, this can be expressed as:\n$\\epsilon = \\ln\\left(\\frac{w_{11} \\cdot w_{00}}{w_{10} \\cdot w_{01}}\\right)$\n\nInserting the numerical values provided:\n$\\epsilon = \\ln\\left(\\frac{1.050 \\times 1.000}{0.990 \\times 0.980}\\right) = \\ln\\left(\\frac{1.050}{0.9702}\\right)$\n$\\epsilon = \\ln(1.082251082...)$\n$\\epsilon \\approx 0.0790432$\n\nRounding to four significant figures, the epistasis coefficient is $\\epsilon = 0.07904$.\n\nNext, we classify the epistatic regime.\nSince $\\epsilon  0$, we have positive epistasis on the Malthusian scale. This indicates the combined benefit of the two mutations is greater than the sum of their individual effects.\n\nTo check for sign epistasis, we must evaluate the effect of each mutation in different genetic backgrounds.\nEffect of the mutation at the first locus (from $0 \\to 1$):\n- In the background of the `_0` genotype (i.e., comparing $10$ to $00$):\n$\\Delta m_{1|0} = m_{10} - m_{00} = \\ln(0.990) - \\ln(1.000) \\approx -0.01005  0$. The mutation is deleterious.\n- In the background of the `_1` genotype (i.e., comparing $11$ to $01$):\n$\\Delta m_{1|1} = m_{11} - m_{01} = \\ln(1.050) - \\ln(0.980) = \\ln\\left(\\frac{1.050}{0.980}\\right) \\approx 0.06900  0$. The mutation is beneficial.\nSince the sign of the mutation's effect changes from negative to positive, this is sign epistasis.\n\nEffect of the mutation at the second locus (from $0 \\to 1$):\n- In the background of the `0_` genotype (i.e., comparing $01$ to $00$):\n$\\Delta m_{2|0} = m_{01} - m_{00} = \\ln(0.980) - \\ln(1.000) \\approx -0.02020  0$. The mutation is deleterious.\n- In the background of the `1_` genotype (i.e., comparing $11$ to $10$):\n$\\Delta m_{2|1} = m_{11} - m_{10} = \\ln(1.050) - \\ln(0.990) = \\ln\\left(\\frac{1.050}{0.990}\\right) \\approx 0.05884  0$. The mutation is beneficial.\nThe sign of this mutation's effect also changes from negative to positive.\n\nBecause both mutations are deleterious on their own but become beneficial in the presence of the other, the system exhibits **reciprocal sign epistasis**. This is a specific and strong form of sign epistasis. The fitness landscape has a valley between the local optimum at genotype $00$ and the global optimum at genotype $11$, as both single-mutant intermediates ($01$ and $10$) have lower fitness than the starting genotype $00$. An evolving population must cross this fitness valley to reach the genotype with the highest fitness.\n\nThe problem requires the numerical value of $\\epsilon$ as the final answer.\n$\\epsilon \\approx 0.0790432$, which is $0.07904$ when rounded to four significant figures.", "answer": "$$\n\\boxed{0.07904}\n$$", "id": "2689273"}, {"introduction": "Building upon the concept of epistatic interactions, this next practice challenges you to construct and analyze a complete, albeit small, three-locus fitness landscape. You will calculate the fitness for every possible genotype based on a defined model of main effects and epistatic terms. This systematic exploration will allow you to directly apply the definition of a local fitness peak, a crucial skill for mapping the evolutionary paths available to a population [@problem_id:2689246].", "problem": "In a haploid, asexual population with $3$ biallelic loci $A$, $B$, and $C$, consider genotypes encoded as binary strings $x_{A}x_{B}x_{C}$ with $x_{A}, x_{B}, x_{C} \\in \\{0,1\\}$, where $0$ denotes the ancestral allele and $1$ denotes the derived allele. The absolute fitness $W(x_{A},x_{B},x_{C})$ of a genotype is specified by a multiplicative baseline with epistatic modifiers. Let the baseline fitness be $w_{0} = 1$. In the absence of epistasis, each derived allele at locus $i \\in \\{A,B,C\\}$ contributes a multiplicative factor $(1 + s_{i})$ when $x_{i} = 1$, with selection coefficients $s_{A} = \\frac{1}{5}$, $s_{B} = \\frac{1}{4}$, and $s_{C} = -\\frac{1}{10}$. Epistatic interactions are included as multiplicative modifiers: a pairwise epistasis between $A$ and $B$ contributes a factor $(1 + \\epsilon_{AB})$ when $x_{A}x_{B} = 1$; a pairwise epistasis between $B$ and $C$ contributes a factor $(1 + \\epsilon_{BC})$ when $x_{B}x_{C} = 1$; and a three-way epistasis among $A$, $B$, and $C$ contributes a factor $(1 + \\epsilon_{ABC})$ when $x_{A}x_{B}x_{C} = 1$. Use $\\epsilon_{AB} = \\frac{1}{10}$, $\\epsilon_{BC} = -\\frac{1}{5}$, and $\\epsilon_{ABC} = \\frac{1}{5}$. Therefore,\n$$\nW(x_{A},x_{B},x_{C}) \\;=\\; w_{0}\\,(1+s_{A})^{x_{A}}\\,(1+s_{B})^{x_{B}}\\,(1+s_{C})^{x_{C}}\\,(1+\\epsilon_{AB})^{x_{A}x_{B}}\\,(1+\\epsilon_{BC})^{x_{B}x_{C}}\\,(1+\\epsilon_{ABC})^{x_{A}x_{B}x_{C}}.\n$$\nA genotype is said to be a local fitness peak if its fitness is greater than or equal to the fitness of all genotypes at Hamming distance $1$ (i.e., differing by a single locus). The global fitness peak is the genotype with the maximal fitness over all $8$ genotypes.\n\nStarting from these definitions, compute $W$ for each of the $8$ genotypes, determine which genotypes are local peaks by directly comparing to their one-step neighbors on the $3$-dimensional hypercube, and identify the global peak. Report, as your final answer, the total number of local fitness peaks in this landscape. Provide the final answer as a single integer; no rounding is required.", "solution": "The problem requires the determination of the number of local fitness peaks in a given three-locus fitness landscape. A local fitness peak is a genotype whose fitness is greater than or equal to the fitness of all its single-mutant neighbors (genotypes at Hamming distance $1$). The solution necessitates a systematic evaluation of the fitness of all possible genotypes and a direct comparison with their respective neighbors.\n\nThe problem provides the following parameters:\nThe selection coefficients for the derived alleles are $s_{A} = \\frac{1}{5}$, $s_{B} = \\frac{1}{4}$, and $s_{C} = -\\frac{1}{10}$.\nThe epistatic modifiers are $\\epsilon_{AB} = \\frac{1}{10}$, $\\epsilon_{BC} = -\\frac{1}{5}$, and $\\epsilon_{ABC} = \\frac{1}{5}$.\nThe baseline fitness is $w_{0} = 1$.\n\nThe fitness function for a genotype $x_{A}x_{B}x_{C}$, where $x_i \\in \\{0,1\\}$, is given by:\n$$W(x_{A},x_{B},x_{C}) = w_{0}\\,(1+s_{A})^{x_{A}}\\,(1+s_{B})^{x_{B}}\\,(1+s_{C})^{x_{C}}\\,(1+\\epsilon_{AB})^{x_{A}x_{B}}\\,(1+\\epsilon_{BC})^{x_{B}x_{C}}\\,(1+\\epsilon_{ABC})^{x_{A}x_{B}x_{C}}$$\nThe multiplicative factors are:\n$1+s_{A} = 1 + \\frac{1}{5} = \\frac{6}{5}$\n$1+s_{B} = 1 + \\frac{1}{4} = \\frac{5}{4}$\n$1+s_{C} = 1 - \\frac{1}{10} = \\frac{9}{10}$\n$1+\\epsilon_{AB} = 1 + \\frac{1}{10} = \\frac{11}{10}$\n$1+\\epsilon_{BC} = 1 - \\frac{1}{5} = \\frac{4}{5}$\n$1+\\epsilon_{ABC} = 1 + \\frac{1}{5} = \\frac{6}{5}$\n\nWe compute the fitness $W$ for each of the $2^3=8$ genotypes:\n\n1.  Genotype $000$: $W(000) = 1$\n\n2.  Genotype $100$: $W(100) = (1+s_{A}) = \\frac{6}{5} = 1.2$\n\n3.  Genotype $010$: $W(010) = (1+s_{B}) = \\frac{5}{4} = 1.25$\n\n4.  Genotype $001$: $W(001) = (1+s_{C}) = \\frac{9}{10} = 0.9$\n\n5.  Genotype $110$: $W(110) = (1+s_{A})(1+s_{B})(1+\\epsilon_{AB}) = \\frac{6}{5} \\cdot \\frac{5}{4} \\cdot \\frac{11}{10} = \\frac{33}{20} = 1.65$\n\n6.  Genotype $101$: $W(101) = (1+s_{A})(1+s_{C}) = \\frac{6}{5} \\cdot \\frac{9}{10} = \\frac{54}{50} = \\frac{27}{25} = 1.08$\n\n7.  Genotype $011$: $W(011) = (1+s_{B})(1+s_{C})(1+\\epsilon_{BC}) = \\frac{5}{4} \\cdot \\frac{9}{10} \\cdot \\frac{4}{5} = \\frac{9}{10} = 0.9$\n\n8.  Genotype $111$: $W(111) = (1+s_{A})(1+s_{B})(1+s_{C})(1+\\epsilon_{AB})(1+\\epsilon_{BC})(1+\\epsilon_{ABC}) = \\frac{6}{5} \\cdot \\frac{5}{4} \\cdot \\frac{9}{10} \\cdot \\frac{11}{10} \\cdot \\frac{4}{5} \\cdot \\frac{6}{5} = \\frac{891}{625} = 1.4256$\n\nNext, we identify local fitness peaks by checking each genotype against its neighbors at Hamming distance $1$.\n\n-   **Genotype $000$ ($W=1.0$):** Neighbors are $100$ ($W=1.2$), $010$ ($W=1.25$), $001$ ($W=0.9$).\n    Since $W(000)  W(100)$ and $W(000)  W(010)$, genotype $000$ is not a local peak.\n\n-   **Genotype $100$ ($W=1.2$):** Neighbors are $000$ ($W=1.0$), $110$ ($W=1.65$), $101$ ($W=1.08$).\n    Since $W(100)  W(110)$, genotype $100$ is not a local peak.\n\n-   **Genotype $010$ ($W=1.25$):** Neighbors are $000$ ($W=1.0$), $110$ ($W=1.65$), $011$ ($W=0.9$).\n    Since $W(010)  W(110)$, genotype $010$ is not a local peak.\n\n-   **Genotype $001$ ($W=0.9$):** Neighbors are $000$ ($W=1.0$), $101$ ($W=1.08$), $011$ ($W=0.9$).\n    Since $W(001)  W(000)$ and $W(001)  W(101)$, genotype $001$ is not a local peak.\n\n-   **Genotype $110$ ($W=1.65$):** Neighbors are $010$ ($W=1.25$), $100$ ($W=1.2$), $111$ ($W=1.4256$).\n    We check the conditions:\n    $W(110) \\ge W(010) \\implies 1.65 \\ge 1.25$ (True)\n    $W(110) \\ge W(100) \\implies 1.65 \\ge 1.2$ (True)\n    $W(110) \\ge W(111) \\implies 1.65 \\ge 1.4256$ (True)\n    All conditions are met. Therefore, **genotype $110$ is a local fitness peak.**\n\n-   **Genotype $101$ ($W=1.08$):** Neighbors are $001$ ($W=0.9$), $100$ ($W=1.2$), $111$ ($W=1.4256$).\n    Since $W(101)  W(100)$ and $W(101)  W(111)$, genotype $101$ is not a local peak.\n\n-   **Genotype $011$ ($W=0.9$):** Neighbors are $001$ ($W=0.9$), $010$ ($W=1.25$), $111$ ($W=1.4256$).\n    Since $W(011)  W(010)$ and $W(011)  W(111)$, genotype $011$ is not a local peak.\n\n-   **Genotype $111$ ($W=1.4256$):** Neighbors are $011$ ($W=0.9$), $101$ ($W=1.08$), $110$ ($W=1.65$).\n    Since $W(111)  W(110)$, genotype $111$ is not a local peak.\n\nAfter systematically examining all $8$ genotypes, only one, $110$, satisfies the definition of a local fitness peak. It is also the global peak as its fitness $W(110)=1.65$ is the maximum among all genotypes. The total number of local fitness peaks is $1$.", "answer": "$$\\boxed{1}$$", "id": "2689246"}, {"introduction": "An adaptive landscape is not merely a static map; it is the terrain upon which populations evolve. This final exercise delves into the dynamics of navigating this terrain, specifically the challenge of crossing a fitness valley. By deriving the rates of sequential fixation and stochastic tunneling, you will uncover how population size critically determines the dominant evolutionary pathway, providing a deep insight into the interplay between selection, mutation, and genetic drift [@problem_id:2689233].", "problem": "Consider a large, asexual haploid population evolving on a two-step adaptive landscape with a fitness valley. The resident wild type has relative fitness $1$. A single-mutant intermediate has relative fitness $1 - s$ with $s \\in (0,1)$, and the double mutant (the adaptive peak) has relative fitness $1 + S$ with $S \\in (0,1)$. Mutations occur in a forward direction only along this path, from wild type to single mutant and from single mutant to double mutant, each with per-individual per-generation rate $\\mu$, with $\\mu \\ll s$ and $\\mu \\ll S$. Assume the evolutionary dynamics follow the continuous-time Moran model, selection is weak in the sense that $s \\ll 1$ and $S \\ll 1$, and clonal interference is negligible. Work in the regime $N s \\gg 1$ so that the deleterious intermediate is strongly selected against at the population scale.\n\nUsing only well-tested results for fixation probabilities in the Moran model and standard branching-process approximations for subcritical lineages, derive the expected rate of valley crossing via sequential fixation and via stochastic tunneling. Then, by equating these two rates, define the critical population size $N_c$ at which the dominant mechanism switches from sequential fixation to tunneling, and solve explicitly for $N_c$ in terms of $\\mu$, $s$, and $S$. Your final answer must be a single closed-form analytic expression for $N_c$ in terms of $\\mu$, $s$, and $S$. No numerical evaluation is required, and no units are to be included in the final expression.", "solution": "The problem statement must first be rigorously validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\nThe explicit information provided is as follows:\n- **Population**: A large, asexual, haploid population of size $N$.\n- **Evolutionary Model**: Continuous-time Moran model.\n- **Fitness Landscape**: A two-step path with a fitness valley.\n  - Wild type (genotype 0): Relative fitness $w_0 = 1$.\n  - Single-mutant intermediate (genotype 1): Relative fitness $w_1 = 1 - s$, where $s \\in (0,1)$.\n  - Double mutant (genotype 2): Relative fitness $w_2 = 1 + S$, where $S \\in (0,1)$.\n- **Mutation Scheme**: Unidirectional mutations occur at a per-individual, per-generation rate $\\mu$.\n  - Genotype 0 to Genotype 1: Rate $\\mu$.\n  - Genotype 1 to Genotype 2: Rate $\\mu$.\n- **Parameter Regimes and Assumptions**:\n  - $\\mu \\ll s$ and $\\mu \\ll S$.\n  - Weak selection: $s \\ll 1$ and $S \\ll 1$.\n  - Strong selection against the intermediate at the population level: $N s \\gg 1$.\n  - Clonal interference is negligible.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against established criteria.\n\n- **Scientific Grounding**: The problem is well-grounded in the fundamental theory of population genetics and molecular evolution. The scenario of crossing a fitness valley is a classic problem, first addressed by Wright and later formalized with modern mathematical tools. The Moran model, fixation probabilities, and branching process approximations are standard, well-tested concepts in this field.\n- **Well-Posedness**: The problem is well-posed. It asks for the derivation of a specific quantity, the critical population size $N_c$, based on a clear set of parameters and a defined model. The assumptions provided ($\\mu \\ll s$, $s \\ll 1$, $Ns \\gg 1$) create a mathematically tractable regime where a unique solution is expected.\n- **Objectivity**: The problem is stated in precise, objective language, free of ambiguity or subjective claims. All terms are standard in the field.\n\nThe problem does not violate any of the criteria for invalidity. It is not scientifically unsound, non-formalizable, incomplete, contradictory, unrealistic, or ill-posed.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\nThe task is to find the critical population size $N_c$ at which the dominant mechanism for crossing the fitness valley transitions from sequential fixation to stochastic tunneling. This is achieved by deriving the rates for both processes and equating them.\n\n**1. Rate of Sequential Fixation ($R_{seq}$)**\n\nThe sequential fixation pathway consists of two distinct substitution events:\n1. The deleterious single mutant arises and, against selection, drifts to fixation.\n2. From the now-monomorphic population of single mutants, the advantageous double mutant arises and sweeps to fixation.\n\nThe rate of this entire process is limited by the rate of the first, much slower step: the fixation of the deleterious intermediate. The rate of this event, $R_{seq}$, is the product of the rate at which new single mutants appear in the wild-type population and their probability of fixation.\n\nThe rate of appearance of new single mutants is $N\\mu$.\nThe fixation probability, $\\pi_{fix}$, of a single mutant with relative fitness $r$ in a Moran model of size $N$ is given by:\n$$ \\pi_{fix}(r) = \\frac{1 - \\frac{1}{r}}{1 - \\frac{1}{r^N}} $$\nFor the single mutant, the relative fitness is $r = w_1 / w_0 = 1 - s$.\n$$ \\pi_{fix, SM} = \\frac{1 - (1-s)^{-1}}{1 - (1-s)^{-N}} $$\nWe apply the weak selection approximation, where $s \\ll 1$. We can write $1-s \\approx \\exp(-s)$.\n$$ \\pi_{fix, SM} \\approx \\frac{1 - \\exp(s)}{1 - \\exp(Ns)} $$\nGiven $s \\ll 1$, the numerator can be approximated as $1 - \\exp(s) \\approx 1 - (1+s) = -s$.\nGiven $Ns \\gg 1$, the term $\\exp(Ns)$ is very large, so the denominator is approximately $-\\exp(Ns)$.\n$$ \\pi_{fix, SM} \\approx \\frac{-s}{-\\exp(Ns)} = s \\exp(-Ns) $$\nThe rate of sequential fixation is the total rate of such fixation events in the population:\n$$ R_{seq} = (N\\mu) \\times \\pi_{fix, SM} \\approx N\\mu s \\exp(-Ns) $$\n\n**2. Rate of Stochastic Tunneling ($R_{tun}$)**\n\nStochastic tunneling occurs when a double mutant arises from a lineage of single mutants while that lineage is still rare and has not fixed. This double mutant then drives the entire lineage to fixation.\n\nThe process is initiated by the appearance of a single mutant at rate $N\\mu$. This mutant, with relative fitness $1-s$, founds a deleterious lineage. We model the fate of this lineage using a continuous-time subcritical branching process. The expected number of individuals in this lineage at time $t$ is $\\exp(-st)$. The total expected number of mutant-individual-generations produced by this single initial mutant before its lineage goes extinct is the time integral of its expected size:\n$$ \\text{Total progeny time} = \\int_{0}^{\\infty} \\exp(-st) \\,dt = \\frac{1}{s} $$\nDuring the existence of this single-mutant lineage, new mutations to the double-mutant type occur at a rate $\\mu$ per individual. The expected number of double mutants produced within this lineage is:\n$$ N_{DM \\text{ produced}} = \\mu \\times (\\text{Total progeny time}) = \\frac{\\mu}{s} $$\nEach double mutant arises in a population dominated by the wild type. Its relative fitness is $w_2 / w_0 = 1+S$, so its selective advantage is $S$. The fixation probability for such an advantageous mutant in the Moran model with weak selection ($S \\ll 1$) is:\n$$ \\pi_{fix, DM} \\approx S $$\nThe probability that a single initial mutant lineage successfully \"tunnels\" across the valley is the product of the expected number of double mutants produced and their probability of fixation:\n$$ P_{tunnel} = N_{DM \\text{ produced}} \\times \\pi_{fix, DM} = \\frac{\\mu}{s} S $$\nThe overall rate of stochastic tunneling, $R_{tun}$, is the rate of appearance of initial single mutants multiplied by their probability of successful tunneling:\n$$ R_{tun} = (N\\mu) \\times P_{tunnel} = (N\\mu) \\left( \\frac{\\mu S}{s} \\right) = \\frac{N\\mu^2 S}{s} $$\n\n**3. Critical Population Size ($N_c$)**\n\nThe transition between the two regimes occurs at the critical population size $N_c$ where the rates are equal: $R_{seq} = R_{tun}$.\n$$ N_c \\mu s \\exp(-N_c s) = \\frac{N_c \\mu^2 S}{s} $$\nAssuming $N_c  0$ and $\\mu  0$, we can divide both sides by $N_c \\mu$:\n$$ s \\exp(-N_c s) = \\frac{\\mu S}{s} $$\nRearranging the terms to isolate the exponential:\n$$ \\exp(-N_c s) = \\frac{\\mu S}{s^2} $$\nTo solve for $N_c$, we take the natural logarithm of both sides:\n$$ -N_c s = \\ln \\left( \\frac{\\mu S}{s^2} \\right) $$\nFinally, we solve for $N_c$:\n$$ N_c = -\\frac{1}{s} \\ln \\left( \\frac{\\mu S}{s^2} \\right) $$\nUsing the property $\\ln(x^{-1}) = -\\ln(x)$, this expression is more cleanly written as:\n$$ N_c = \\frac{1}{s} \\ln \\left( \\left(\\frac{\\mu S}{s^2}\\right)^{-1} \\right) = \\frac{1}{s} \\ln \\left( \\frac{s^2}{\\mu S} \\right) $$\nThis expression defines the critical population size at which the dominant evolutionary pathway for crossing the fitness valley switches. For $N \\ll N_c$, sequential fixation is more probable ($R_{seq}  R_{tun}$), while for $N \\gg N_c$, stochastic tunneling dominates ($R_{tun}  R_{seq}$).", "answer": "$$ \\boxed{ \\frac{1}{s} \\ln \\left(\\frac{s^2}{\\mu S}\\right) } $$", "id": "2689233"}]}