{"hands_on_practices": [{"introduction": "Before applying a molecular clock, we must first accurately quantify the evolutionary distance between sequences. The observed proportion of differences, or $p$-distance, is a deceptively simple metric that systematically underestimates the true number of substitutions that have occurred due to unobserved \"multiple hits.\" This exercise [@problem_id:2736569] takes you back to first principles, deriving the classic Jukes-Cantor (JC69) correction to reveal how unobserved substitutions are mathematically accounted for and why this correction is a critical first step in any rigorous molecular dating analysis.", "problem": "A researcher is preparing to calibrate a molecular clock and to perform a relative rate test on two sister lineages using a protein-coding gene. Let the observed fraction of pairwise nucleotide differences between the two sequences be $p=0.2$. Assume the Jukes–Cantor $1969$ (JC69) model: a continuous-time, time-homogeneous Markov chain on a $4$-state alphabet with equal stationary base frequencies and equal instantaneous rates among all nucleotide changes, with independence and rate homogeneity across sites.\n\nStarting from these JC69 assumptions and first principles of continuous-time Markov chains (matrix exponential of the instantaneous rate matrix and the definition of the expected number of substitutions per site as the path integral of the instantaneous rate), derive the corrected evolutionary distance $d$ (expected substitutions per site along the total path separating the two sequences) that is consistent with the observed $p=0.2$. Then, quantitatively interpret the magnitude of multiple hits implied by comparing $d$ to $p$ in the context of using such distances for molecular clock calibration or relative rate testing.\n\nExpress the final numerical value of $d$ in substitutions per site and round to four significant figures. The final reported answer must be the single value of $d$ only (without units).", "solution": "The problem requires the derivation of the Jukes-Cantor (JC69) distance, $d$, from the observed proportion of nucleotide differences, $p$, and a quantitative interpretation of the result. The derivation must proceed from first principles.\n\nFirst, we define the instantaneous rate matrix $Q$ for the JC69 model. The model assumes equal stationary base frequencies, $\\pi_i = \\frac{1}{4}$ for $i \\in \\{A, C, G, T\\}$, and an equal rate of substitution $\\alpha$ between any two distinct nucleotides. The diagonal elements $Q_{ii}$ are defined such that the sum of each row is zero, which means $Q_{ii} = -3\\alpha$. The rate matrix is:\n$$\nQ = \\begin{pmatrix} -3\\alpha & \\alpha & \\alpha & \\alpha \\\\ \\alpha & -3\\alpha & \\alpha & \\alpha \\\\ \\alpha & \\alpha & -3\\alpha & \\alpha \\\\ \\alpha & \\alpha & \\alpha & -3\\alpha \\end{pmatrix}\n$$\n\nThe evolutionary distance, $d$, is defined as the expected number of substitutions per site along the total path separating the two sequences. Let the two sequences diverge from their common ancestor at time $0$ and be observed at time $t$. The total divergence time separating the two sequences is $T = 2t$. The overall rate of substitution per site, $\\mu$, is the average rate of leaving any state, weighted by the stationary frequencies:\n$$\n\\mu = -\\sum_{i} \\pi_i Q_{ii} = -\\sum_{i} \\left(\\frac{1}{4}\\right)(-3\\alpha) = 4 \\left(\\frac{3\\alpha}{4}\\right) = 3\\alpha\n$$\nThe total distance $d$ is the product of this rate and the total time duration $T = 2t$:\n$$\nd = \\mu T = (3\\alpha)(2t) = 6\\alpha t\n$$\n\nNext, we relate the observed proportion of differences, $p$, to the model parameters. The value $p$ is the probability that at any given site, the nucleotide in the first sequence differs from the nucleotide in the second sequence. This is equal to $1$ minus the probability that they are the same.\n$$\np = 1 - P(\\text{nucleotides are identical})\n$$\nThe event that the nucleotides are identical corresponds to a site starting in some state $i$ at the common ancestor and ending in the same state $j$ in both lineages. A more direct approach recognizes that the evolutionary process along the two branches separating the sequences is equivalent to a single process over a total time interval of $T = 2t$. The probability of observing a difference is thus the probability that a substitution occurs over this interval. This is $1$ minus the probability that the nucleotide remains the same.\n$$\np = 1 - \\sum_i \\pi_i P_{ii}(2t)\n$$\nDue to the symmetry of the JC69 model, the stationary distribution is uniform ($\\pi_i = \\frac{1}{4}$), and the diagonal elements of the transition probability matrix, $P_{ii}(2t)$, are all equal. Therefore, $p = 1 - P_{AA}(2t)$ for any arbitrary nucleotide like A.\n\nThe transition probability matrix is the exponential of the rate matrix, $P(\\tau) = \\exp(Q\\tau)$. For JC69, the probability of a specific nucleotide remaining unchanged over a time interval $\\tau$ is:\n$$\nP_{ii}(\\tau) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha\\tau)\n$$\nWe evaluate this for the total divergence time $\\tau = 2t$:\n$$\nP_{ii}(2t) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha(2t)) = \\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t)\n$$\nSubstituting this into the expression for $p$:\n$$\np = 1 - \\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t)\\right) = \\frac{3}{4} - \\frac{3}{4}\\exp(-8\\alpha t) = \\frac{3}{4}(1 - \\exp(-8\\alpha t))\n$$\nWe must now express this relationship in terms of the evolutionary distance $d = 6\\alpha t$. From this definition, we have $\\alpha t = \\frac{d}{6}$. Substituting this into the equation for $p$:\n$$\np = \\frac{3}{4}\\left(1 - \\exp\\left(-8 \\cdot \\frac{d}{6}\\right)\\right) = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4d}{3}\\right)\\right)\n$$\nThis is the fundamental relationship between the observed difference $p$ and the corrected distance $d$ under the JC69 model. To solve for $d$, we rearrange the equation:\n$$\n\\frac{4p}{3} = 1 - \\exp\\left(-\\frac{4d}{3}\\right)\n$$\n$$\n\\exp\\left(-\\frac{4d}{3}\\right) = 1 - \\frac{4p}{3}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\frac{4d}{3} = \\ln\\left(1 - \\frac{4p}{3}\\right)\n$$\n$$\nd = -\\frac{3}{4}\\ln\\left(1 - \\frac{4p}{3}\\right)\n$$\nThis is the derived Jukes-Cantor distance correction formula.\n\nWe are given $p = 0.2$. Substituting this value:\n$$\nd = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}(0.2)\\right) = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{15}\\right) = -\\frac{3}{4}\\ln\\left(\\frac{11}{15}\\right) = \\frac{3}{4}\\ln\\left(\\frac{15}{11}\\right)\n$$\nCalculating the numerical value:\n$$\nd \\approx \\frac{3}{4} \\times 0.31015494 = 0.2326162...\n$$\nRounding to four significant figures, the distance is $d \\approx 0.2326$ substitutions per site.\n\nFinally, we must quantitatively interpret the magnitude of multiple hits. The observed proportion of differences, $p=0.2$, represents the number of differences one would count by directly comparing the two sequences. The corrected distance, $d \\approx 0.2326$, represents the estimated actual number of substitutions that have occurred per site over the evolutionary history separating the two sequences. The fact that $d > p$ is a direct consequence of \"multiple hits\": substitutions that are not visible in the final sequence comparison. These include reversions (e.g., A $\\to$ G $\\to$ A) and parallel changes that result in a smaller observed difference than the true number of events.\nThe magnitude of these unobserved substitutions is $d - p \\approx 0.2326 - 0.2 = 0.0326$. This implies that for every $100$ sites, approximately $20$ are observed to be different, but the model infers that an additional $3.26$ substitutions have occurred that are masked by multiple hits. The fractional increase of the corrected distance over the observed difference is $\\frac{d-p}{p} = \\frac{0.0326}{0.2} = 0.163$, or $16.3\\%$.\nThis correction is of fundamental importance for molecular clock calibration and relative rate tests. Using the raw, uncorrected distance $p$ would lead to a systematic underestimation of divergence times or evolutionary rates by approximately $16.3\\%$ in this case. In a relative rate test comparing two lineages, the one with a higher substitution rate would accumulate more multiple hits. Using $p$ instead of $d$ would disproportionately underestimate the distance for the faster lineage, potentially masking a real rate variation and leading to the incorrect acceptance of the molecular clock hypothesis. Therefore, using the corrected distance $d$ is imperative for accurate evolutionary inference.", "answer": "$$\\boxed{0.2326}$$", "id": "2736569"}, {"introduction": "The central assumption of a strict molecular clock is that evolutionary rates are constant across all lineages in a tree, an assumption that must be rigorously tested rather than taken for granted. Tajima’s relative rate test provides an elegant framework for this, using an outgroup to compare the number of substitutions that have accumulated in two sister lineages since their divergence. This practice [@problem_id:2736568] challenges you to build the test from the ground up, translating a biological hypothesis into a formal statistical test and gaining a deep appreciation for the logic of evolutionary hypothesis testing.", "problem": "Two sister taxa $A$ and $B$ and an outgroup $O$ are sampled at $L=1000$ aligned Deoxyribonucleic Acid (DNA) sites. Each site is categorized relative to $O$ as follows: it is counted in $n_{A}$ if $A$ differs from $O$ while $B$ matches $O$, in $n_{B}$ if $B$ differs from $O$ while $A$ matches $O$, and in $n_{\\text{shared}}$ if both $A$ and $B$ match $O$. The observed counts are $n_{A}=120$, $n_{B}=150$, and $n_{\\text{shared}}=730$. Assume sites evolve independently and that, over this divergence, per-site substitutions on the $A$ and $B$ lineages are sufficiently rare that sitewise events can be modeled as independent Bernoulli trials, and the counts $n_{A}$ and $n_{B}$ arise as sums of these trials. Under a strict molecular clock after the $A$–$B$ split, the lineage-specific substitution rates of $A$ and $B$ are equal, so the expected numbers of $A$-specific and $B$-specific differences are equal.\n\nStarting from these assumptions and without invoking any pre-packaged test formula, derive an appropriate standardized normal-test statistic for Tajima’s relative rate test that compares the rates on the $A$ and $B$ lineages using the observed counts. Then compute the resulting $z$-score using the data above. Round your computed $z$-score to $3$ significant figures. Express the final answer as a unitless number.", "solution": "The problem statement presented is scientifically grounded, well-posed, objective, and self-contained. It describes a standard application of a relative rate test in molecular evolution. The data are internally consistent, as the sum of the specified counts $n_{A} + n_{B} + n_{\\text{shared}} = 120 + 150 + 730 = 1000$, which matches the total number of sites $L$. The problem is therefore valid, and a solution will be derived from first principles as requested.\n\nThe objective is to test the null hypothesis ($H_0$) of a strict molecular clock, which posits that the rate of substitution on the lineage leading to taxon $A$ is equal to the rate on the lineage leading to taxon $B$, after their divergence. Let the per-site probability of substitution on the $A$ lineage be $p_A$ and on the $B$ lineage be $p_B$. The problem states that substitutions are rare, which allows us to neglect the probability of substitutions occurring on both lineages at the same site, i.e., $p_A p_B \\approx 0$.\n\nThe null hypothesis $H_0$ is that the rates are equal, which implies $p_A = p_B$. The alternative hypothesis ($H_1$) is that the rates are not equal, $p_A \\ne p_B$.\n\nWe are interested in comparing the number of substitutions that have accumulated on each lineage. The informative sites for this comparison are those where a substitution has occurred on exactly one of the two lineages. The count of sites where only lineage $A$ differs from the outgroup $O$ is $n_A=120$. The count of sites where only lineage $B$ differs from the outgroup is $n_B=150$. The total number of such informative sites is $N = n_A + n_B$. In this problem, $N = 120 + 150 = 270$.\n\nLet us consider a single informative site. Under the assumption that the substitution occurred on either lineage $A$ or lineage $B$, but not both, we want to find the conditional probability that the substitution occurred on lineage $A$. Let $S_A$ be the event of a substitution on lineage $A$ and $S_B$ be the event for lineage $B$. The probability of observing a site counted in $n_A$ is $P(S_A \\text{ and not } S_B) = p_A(1 - p_B) \\approx p_A$. Similarly, the probability of observing a site counted in $n_B$ is $P(S_B \\text{ and not } S_A) = p_B(1 - p_A) \\approx p_B$.\n\nThe conditional probability that a substitution occurred on lineage $A$, given that it is an informative site (i.e., exactly one substitution occurred), is:\n$$ P(S_A | (S_A \\text{ and not } S_B) \\text{ or } (S_B \\text{ and not } S_A)) = \\frac{p_A(1-p_B)}{p_A(1-p_B) + p_B(1-p_A)} $$\nUnder the null hypothesis $H_0: p_A = p_B$, let's call this common probability $p_s$. The expression simplifies to:\n$$ p = \\frac{p_s(1-p_s)}{p_s(1-p_s) + p_s(1-p_s)} = \\frac{p_s(1-p_s)}{2p_s(1-p_s)} = \\frac{1}{2} $$\nTherefore, under the null hypothesis, each of the $N = n_A + n_B$ informative sites has an equal probability of $1/2$ of being an $A$-specific change or a $B$-specific change. This means we can model the count $n_A$ as a random variable drawn from a binomial distribution with $N$ trials and a success probability of $p=1/2$.\n$$ n_A \\sim \\text{Binomial}(N, \\frac{1}{2}) $$\nThe expected value of $n_A$ under $H_0$ is:\n$$ E[n_A] = Np = (n_A + n_B) \\times \\frac{1}{2} = \\frac{n_A + n_B}{2} $$\nThe variance of $n_A$ under $H_0$ is:\n$$ \\text{Var}(n_A) = Np(1-p) = (n_A + n_B) \\times \\frac{1}{2} \\times \\frac{1}{2} = \\frac{n_A + n_B}{4} $$\nFor a sufficiently large number of trials $N$, the binomial distribution can be approximated by a normal distribution. A standardized test statistic, or $z$-score, is formulated as the deviation of the observed value from its expected value, divided by the standard deviation.\n$$ z = \\frac{\\text{Observed} - \\text{Expected}}{\\text{Standard Deviation}} = \\frac{n_A - E[n_A]}{\\sqrt{\\text{Var}(n_A)}} $$\nSubstituting the expressions for the expected value and variance:\n$$ z = \\frac{n_A - \\frac{n_A + n_B}{2}}{\\sqrt{\\frac{n_A + n_B}{4}}} $$\nSimplifying the expression algebraically:\n$$ z = \\frac{\\frac{2n_A - (n_A + n_B)}{2}}{\\frac{\\sqrt{n_A + n_B}}{2}} = \\frac{n_A - n_B}{\\sqrt{n_A + n_B}} $$\nThis is the derived test statistic for Tajima's relative rate test. Now, we compute its value using the provided data: $n_A = 120$ and $n_B = 150$.\n$$ z = \\frac{120 - 150}{\\sqrt{120 + 150}} = \\frac{-30}{\\sqrt{270}} $$\nTo compute the numerical value:\n$$ \\sqrt{270} = \\sqrt{9 \\times 30} = 3\\sqrt{30} \\approx 16.4316767 $$\n$$ z = \\frac{-30}{16.4316767} \\approx -1.825741858 $$\nThe problem requires rounding the result to $3$ significant figures. The first three significant figures are $1$, $8$, and $2$. The next digit is $5$, so we round up the last significant digit.\n$$ z \\approx -1.83 $$\nThis value of the test statistic suggests that the number of substitutions on lineage $B$ is higher than on lineage $A$ to a degree that may be statistically significant, depending on the chosen significance level.", "answer": "$$\\boxed{-1.83}$$", "id": "2736568"}, {"introduction": "Once we have confidence in our distance estimates and the clock-like nature of our data, we can move to a primary goal of molecular evolution: dating divergence events. Under a strict clock, the constant rate of substitution transforms the phylogenetic tree into an ultrametric one, where genetic distance is directly proportional to time. In this culminating exercise [@problem_id:2736532], you will synthesize these principles to convert pairwise evolutionary distances into an absolute age for a speciation event, demonstrating the power of the molecular clock as a tool for uncovering evolutionary timelines.", "problem": "You are given three aligned protein-coding sequences from taxa $A$, $B$, and a known outgroup $O$. Using a well-fitted time-reversible substitution model with among-site rate variation, you have obtained unbiased estimates of the expected number of substitutions per site between each pair of taxa:\n- $d_{AB} = 0.086$,\n- $d_{AO} = 0.196$,\n- $d_{BO} = 0.204$.\n\nAssume a strict molecular clock: along any lineage, the branch length in expected substitutions per site equals the product of a constant substitution rate per site per unit time and the elapsed time. Let $\\mu$ denote the substitution rate (substitutions per site per million years), and suppose an independent calibration gives $\\mu = 1.25 \\times 10^{-3}$.\n\nStarting from fundamental principles:\n- Pairwise distances on a tree are additive along the unique path connecting the two taxa.\n- Under a strict clock, there exists a root placement such that the path length from the root to each tip is identical (an ultrametric tree), and branch length equals $\\mu$ times elapsed time.\n\nTasks:\n1. Using only the additivity of distances on a tree with three taxa and the strict clock assumption, derive the unrooted three-taxon tree’s three pendant branch lengths (from the unique internal node to $A$, to $B$, and to $O$).\n2. Show how to place the root on the edge leading to $O$ so that the tree is ultrametric, justifying your placement from first principles. If the two ingroup pendant lengths disagree slightly due to sampling noise, use the strict clock to enforce equality by replacing them with their average.\n3. Convert the resulting root-to-tip path length (in expected substitutions per site) to an absolute root age (the divergence time between $O$ and the common ancestor of $A$ and $B$) in million years, using $\\mu$.\n\nWhat is the root age in million years? Round your final answer to four significant figures and express it in Myr.", "solution": "The problem requires the calculation of the root age for a three-taxon tree comprising taxa $A$, $B$, and an outgroup $O$, under the assumption of a strict molecular clock.\n\nLet $R$ denote the root of the tree, which corresponds to the most recent common ancestor (MRCA) of all three taxa $A$, $B$, and $O$. Since $O$ is the outgroup, the topology of the rooted tree is $((A,B),O)$. Let $N$ be the internal node representing the MRCA of the ingroup taxa $A$ and $B$. The structure of the tree thus involves three primary branches from the root $R$: one leading to the outgroup $O$, and one splitting at node $N$ to lead to taxa $A$ and $B$.\n\nLet $T$ be the absolute time, in millions of years (Myr), from the root $R$ to the present. This is the root age we seek to determine. Let $t_{AB}$ be the absolute time from the divergence at node $N$ to the present ($t_{AB} < T$). Let $\\mu$ be the constant rate of substitution, given as $\\mu = 1.25 \\times 10^{-3}$ substitutions per site per Myr.\n\nUnder the strict molecular clock model, the length of any branch on the evolutionary tree, measured in expected substitutions per site, is the product of the substitution rate $\\mu$ and the duration of time for that branch.\n\nThe branch lengths of the rooted tree $((A,B),O)$ are therefore:\n- Branch from $N$ to $A$: $b_{NA} = \\mu t_{AB}$\n- Branch from $N$ to $B$: $b_{NB} = \\mu t_{AB}$\n- Branch from $R$ to $N$: $b_{RN} = \\mu (T - t_{AB})$\n- Branch from $R$ to $O$: $b_{RO} = \\mu T$\n\nThe total root-to-tip path length, $L$, is the genetic distance from the root $R$ to any of the present-day taxa. For an ultrametric tree, this distance is constant:\n$L = b_{RN} + b_{NA} = \\mu(T - t_{AB}) + \\mu t_{AB} = \\mu T$\n$L = b_{RN} + b_{NB} = \\mu(T - t_{AB}) + \\mu t_{AB} = \\mu T$\n$L = b_{RO} = \\mu T$\n\nThis confirms that the root-to-tip distance is $L = \\mu T$.\n\nThe pairwise distances between taxa are additive along the paths connecting them. We can express the observable pairwise distances ($d_{AB}$, $d_{AO}$, $d_{BO}$) in terms of the branch lengths:\n1.  The distance between $A$ and $B$ is the sum of the lengths of the branches connecting them through their MRCA, $N$:\n    $$d_{AB} = b_{NA} + b_{NB} = \\mu t_{AB} + \\mu t_{AB} = 2 \\mu t_{AB}$$\n2.  The distance between $A$ and $O$ is the sum of the lengths of the branches connecting them through their MRCA, $R$:\n    $$d_{AO} = b_{NA} + b_{RN} + b_{RO} = \\mu t_{AB} + \\mu(T - t_{AB}) +  \\mu T = 2 \\mu T$$\n3.  Similarly, the distance between $B$ and $O$ is:\n    $$d_{BO} = b_{NB} + b_{RN} + b_{RO} = \\mu t_{AB} + \\mu(T - t_{AB}) + \\mu T = 2 \\mu T$$\n\nA direct consequence of the strict clock model is that the distance between any ingroup taxon and the outgroup taxon must be identical: $d_{AO} = d_{BO} = 2 \\mu T$.\n\nThe provided data are $d_{AO} = 0.196$ and $d_{BO} = 0.204$. These values are not equal, which reflects a slight violation of the strict clock assumption, attributed in the problem to sampling noise. To enforce the clock condition, we must use the best estimate for the true distance between the ingroup and the outgroup, which is the arithmetic mean of the observed distances. Let this corrected distance be $d_{(AB)O}^*$.\n$$d_{(AB)O}^* = \\frac{d_{AO} + d_{BO}}{2} = \\frac{0.196 + 0.204}{2} = \\frac{0.400}{2} = 0.200$$\n\nThis represents the clock-corrected estimate of the distance between the ingroup $(A,B)$ and the outgroup $O$. From our derivation, we have the formal relationship $d_{(AB)O}^* = 2 \\mu T$.\n\nThe quantity $\\mu T$ is precisely the root-to-tip path length $L$. Therefore, we can write:\n$$d_{(AB)O}^* = 2L$$\nWe can now solve for $L$:\n$$L = \\frac{d_{(AB)O}^*}{2} = \\frac{0.200}{2} = 0.100$$\nThis value, $L = 0.100$, is the root-to-tip path length in units of expected substitutions per site. This result fulfills the implicit requirements of Tasks $1$ and $2$ by establishing the ultrametric tree's key parameter.\n\nFor completeness, we can derive all branch lengths of the clock-corrected rooted tree.\n- From $d_{AB} = 2 \\mu t_{AB}$ and the given $d_{AB} = 0.086$, we find the ingroup branch lengths: $b_{NA} = b_{NB} = \\mu t_{AB} = \\frac{d_{AB}}{2} = \\frac{0.086}{2} = 0.043$.\n- The length of the branch leading to the outgroup is $b_{RO} = L = 0.100$.\n- The length of the internal branch is $b_{RN} = L - b_{NA} = 0.100 - 0.043 = 0.057$.\n\nFinally, for Task $3$, we convert the root-to-tip distance $L$ into an absolute root age $T$. We use the fundamental clock equation $L = \\mu T$ and solve for $T$:\n$$T = \\frac{L}{\\mu}$$\nSubstituting the calculated value for $L$ and the given value for $\\mu$:\n$$T = \\frac{0.100 \\text{ (substitutions/site)}}{1.25 \\times 10^{-3} \\text{ (substitutions/site/Myr)}}$$\n$$T = \\frac{0.1}{0.00125} \\text{ Myr} = \\frac{100}{1.25} \\text{ Myr} = 80 \\text{ Myr}$$\nThe root age, which is the divergence time between the outgroup $O$ and the common ancestor of $A$ and $B$, is exactly $80$ million years.\n\nThe problem requires the answer to be rounded to four significant figures. Therefore, the final answer is $80.00$ Myr.", "answer": "$$\\boxed{80.00}$$", "id": "2736532"}]}