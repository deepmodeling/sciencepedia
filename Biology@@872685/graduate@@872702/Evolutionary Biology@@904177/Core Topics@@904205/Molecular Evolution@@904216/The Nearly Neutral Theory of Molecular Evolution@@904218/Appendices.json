{"hands_on_practices": [{"introduction": "The Nearly Neutral Theory posits that the evolutionary fate of a mutation depends on the interplay between selection and genetic drift. But where exactly is the dividing line? This first exercise challenges you to move from this qualitative statement to a quantitative criterion. By using a Taylor series expansion of the exact fixation probability, you will derive the famous rule of thumb that defines the \"effectively neutral\" regime, showing how it depends on both the selection coefficient $s$ and the effective population size $N_e$ [@problem_id:2758881].", "problem": "In the nearly neutral theory of molecular evolution, a newly arisen mutation in a diploid Wright–Fisher population with effective population size $N_e$ and selection coefficient $s$ is said to be \"effectively neutral\" if random genetic drift dominates selection along its trajectory, so that its fixation probability is approximately the neutral value to leading order in $s$. Consider a semidominant mutation introduced as a single copy, so its initial frequency is $x_0 = \\frac{1}{2 N_e}$. Use a well-tested diffusion-approximation expression for the fixation probability of a new mutation under selection and a small-$|s|$ expansion about $s=0$ to determine the leading-order condition on $s$ for effective neutrality, and from it derive the threshold magnitude $s_{\\star}(N_e)$ such that $|s|  s_{\\star}(N_e)$ is effectively neutral.\n\nEvaluate $s_{\\star}(N_e)$ for $N_e = 10^4$ and $N_e = 10^6$. Report your final numeric answer as a row matrix $\\begin{pmatrix} s_{\\star}(10^4)  s_{\\star}(10^6) \\end{pmatrix}$ in scientific notation. No rounding is required. After computing the thresholds, briefly explain the biological implications for typical protein-coding mutations in terms of how the effectively neutral class changes with $N_e$. Do not include units in the final numeric answer.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\n**Step 1: Extract Givens**\n- Model: Diploid Wright–Fisher population.\n- Effective population size: $N_e$.\n- Selection coefficient: $s$.\n- Mutation type: Semidominant.\n- Initial condition: Single copy, initial frequency $x_0 = \\frac{1}{2 N_e}$.\n- Definition of \"effectively neutral\": Random genetic drift dominates selection, and the fixation probability is approximately the neutral value to leading order in $s$.\n- Required method: Use a diffusion-approximation expression for fixation probability and a small-$|s|$ expansion about $s=0$.\n- Deliverables:\n    1.  The leading-order condition on $s$ for effective neutrality.\n    2.  The threshold magnitude $s_{\\star}(N_e)$.\n    3.  Evaluation of $s_{\\star}(N_e)$ for $N_e = 10^4$ and $N_e = 10^6$.\n    4.  A brief explanation of biological implications.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is fundamentally sound. It is situated within the standard theoretical framework of population genetics, utilizing the Wright-Fisher model, diffusion approximation, and the nearly neutral theory of molecular evolution, all of which are established principles.\n- **Well-Posedness**: The problem is well-posed. It requires the application of a standard formula (Kimura's fixation probability) and a standard mathematical technique (Taylor series expansion) to derive a specific quantity. The inputs are clearly defined, and a unique solution is expected.\n- **Objectivity**: The problem is stated in precise, objective, and unambiguous scientific language.\n\n**Step 3: Verdict and Action**\n- **Verdict**: The problem is valid. It is a standard, non-trivial exercise in theoretical population genetics.\n- **Action**: Proceed with providing a complete solution.\n\n**Solution Derivation**\n\nThe fixation probability, $\\Pi(x_0, s)$, for a new mutation with initial frequency $x_0$ and selection coefficient $s$ under a model of genic selection (semidominance) in a diploid population of effective size $N_e$ is given by Kimura's diffusion approximation formula:\n$$ \\Pi(x_0, s) = \\frac{\\int_0^{x_0} \\exp(-4 N_e s y) \\, dy}{\\int_0^1 \\exp(-4 N_e s y) \\, dy} $$\nThe integrals are elementary. The numerator evaluates to:\n$$ \\int_0^{x_0} \\exp(-4 N_e s y) \\, dy = \\left[ -\\frac{1}{4 N_e s} \\exp(-4 N_e s y) \\right]_0^{x_0} = \\frac{1 - \\exp(-4 N_e s x_0)}{4 N_e s} $$\nThe denominator evaluates to:\n$$ \\int_0^1 \\exp(-4 N_e s y) \\, dy = \\frac{1 - \\exp(-4 N_e s)}{4 N_e s} $$\nThus, the fixation probability is the ratio:\n$$ \\Pi(x_0, s) = \\frac{1 - \\exp(-4 N_e s x_0)}{1 - \\exp(-4 N_e s)} $$\nThe problem specifies a new mutation introduced as a single copy, so its initial frequency is $x_0 = \\frac{1}{2N_e}$. Substituting this into the equation gives the fixation probability as a function of $s$ and $N_e$:\n$$ \\Pi(s) = \\frac{1 - \\exp\\left(-4 N_e s \\frac{1}{2N_e}\\right)}{1 - \\exp(-4 N_e s)} = \\frac{1 - \\exp(-2s)}{1 - \\exp(-4 N_e s)} $$\nTo determine the condition for effective neutrality, we first find the neutral fixation probability, $\\Pi_0$, by taking the limit as $s \\to 0$:\n$$ \\Pi_0 = \\lim_{s \\to 0} \\Pi(s) = \\lim_{s \\to 0} \\frac{1 - \\exp(-2s)}{1 - \\exp(-4 N_e s)} $$\nUsing the first-order Taylor expansion $\\exp(z) \\approx 1 + z$ for small $z$, we get:\n$$ \\Pi_0 = \\lim_{s \\to 0} \\frac{1 - (1 - 2s)}{1 - (1 - 4 N_e s)} = \\lim_{s \\to 0} \\frac{2s}{4 N_e s} = \\frac{1}{2N_e} $$\nThis confirms the known result that the fixation probability of a neutral allele equals its initial frequency.\n\nNext, we expand $\\Pi(s)$ as a Taylor series around $s=0$ to find the leading-order correction due to selection. We need terms up to $O(s^2)$ in the numerator and denominator to find the $O(s)$ term in the quotient.\n$$ 1 - \\exp(-2s) = 1 - \\left(1 - 2s + \\frac{(-2s)^2}{2} + O(s^3)\\right) = 2s - 2s^2 + O(s^3) $$\n$$ 1 - \\exp(-4N_e s) = 1 - \\left(1 - 4N_e s + \\frac{(-4N_e s)^2}{2} + O(s^3)\\right) = 4N_e s - 8(N_e s)^2 + O(s^3) $$\nThe fixation probability is then:\n$$ \\Pi(s) = \\frac{2s - 2s^2 + O(s^3)}{4N_e s - 8(N_e s)^2 + O(s^3)} = \\frac{2s(1 - s + O(s^2))}{4N_e s(1 - 2N_e s + O(s^2))} = \\frac{1-s}{2N_e(1 - 2N_e s)} + O(s^2) $$\nUsing the geometric series expansion $(1-z)^{-1} \\approx 1+z$ for small $z$:\n$$ \\Pi(s) \\approx \\frac{1-s}{2N_e}(1 + 2N_e s) = \\frac{1}{2N_e}(1 - s + 2N_e s - 2N_e s^2) = \\frac{1}{2N_e} + \\frac{2N_e-1}{2N_e}s - s^2 $$\nTo first order in $s$, the expression is:\n$$ \\Pi(s) \\approx \\frac{1}{2N_e} + \\left(1 - \\frac{1}{2N_e}\\right)s $$\nThe problem defines \"effectively neutral\" as the regime where random genetic drift dominates selection, such that the fixation probability is approximately the neutral value. This translates to the condition that the magnitude of the first-order correction term due to selection is less than or of the same order as the neutral fixation probability itself.\n$$ \\left| \\left(1 - \\frac{1}{2N_e}\\right)s \\right| \\lesssim \\frac{1}{2N_e} $$\nFor any biologically realistic population size, $N_e \\gg 1$, so the term $(1 - \\frac{1}{2N_e}) \\approx 1$. The condition simplifies to:\n$$ |s| \\lesssim \\frac{1}{2N_e} $$\nThis is the leading-order condition for effective neutrality. The threshold magnitude, $s_{\\star}(N_e)$, is the value at which these quantities are equal.\n$$ s_{\\star}(N_e) = \\frac{1}{2N_e} $$\nA mutation is thus considered effectively neutral if $|s|  s_{\\star}(N_e)$. This is equivalent to the widely used condition $|2N_e s|  1$.\n\n**Numerical Evaluation**\nWe evaluate $s_{\\star}(N_e)$ for the given values of $N_e$.\nFor $N_e = 10^4$:\n$$ s_{\\star}(10^4) = \\frac{1}{2 \\times 10^4} = 5 \\times 10^{-5} $$\nFor $N_e = 10^6$:\n$$ s_{\\star}(10^6) = \\frac{1}{2 \\times 10^6} = 5 \\times 10^{-7} $$\n\n**Biological Implications**\nThe threshold for effective neutrality, $s_{\\star}(N_e) = \\frac{1}{2N_e}$, is inversely proportional to the effective population size. This relationship is central to the nearly neutral theory and has profound implications for molecular evolution. In smaller populations (smaller $N_e$), the threshold $s_{\\star}$ is higher. This means a wider range of mutations, including those with substantial fitness effects (e.g., $|s| \\approx 10^{-4}$), behave as if they are neutral because the random fluctuations of genetic drift are strong enough to overwhelm the directional force of selection. Consequently, slightly deleterious mutations can fix by chance more readily in small populations.\n\nConversely, in larger populations (larger $N_e$), the threshold $s_{\\star}$ is much lower. Selection becomes a far more potent and discerning evolutionary force, capable of acting on mutations with very small fitness effects. In a population with $N_e = 10^6$, a mutation with $s = -10^{-5}$ is strongly selected against (since $|s| \\gg s_{\\star} = 5 \\times 10^{-7}$), whereas in a population with $N_e = 10^4$ it is effectively neutral (since $|s|  s_{\\star} = 5 \\times 10^{-5}$). Therefore, large populations are more efficient at purging slightly deleterious mutations and fixing slightly advantageous ones. This leads to the prediction that organisms with historically large effective population sizes (e.g., many prokaryotes and invertebrates) should exhibit higher levels of adaptive evolution and have more streamlined genomes compared to organisms with small effective population sizes (e.g., many vertebrates), where the fixation of slightly deleterious mutations is more common.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5 \\times 10^{-5}  5 \\times 10^{-7}\n\\end{pmatrix}\n}\n$$", "id": "2758881"}, {"introduction": "With a quantitative boundary for near-neutrality established, we can now explore its profound consequences. This practice presents a hypothetical scenario: consider a single, slightly deleterious mutation in two populations of vastly different sizes. You will calculate its fixation probability in each case, providing a stark illustration of a core prediction of the theory: a mutation that is efficiently purged by selection in a large population can behave as if it is neutral and drift to fixation in a small one [@problem_id:2758906]. This exercise makes the abstract relationship between $N_e$, $s$, and evolutionary fate concrete.", "problem": "A large, randomly mating diploid population follows the classical Wright–Fisher model with genic selection (no dominance). Consider a new mutation that arises in a single copy, so its initial frequency is $x_0 = 1/(2N_e)$. The mutant allele has relative fitness advantage $1 + s$ in heterozygotes and $1 + 2s$ in homozygotes, corresponding to genic selection with selection coefficient $s$ acting additively on allele count. Assume the diffusion approximation holds with the standard drift and diffusion terms for genic selection in a diploid population.\n\nStarting from the backward Kolmogorov equation for the fixation probability $u(x)$ with drift $m(x)$ and diffusion variance $v(x)$ under the Wright–Fisher diffusion, derive the fixation probability $u(x_0)$ of the new mutation and then evaluate it for the parameter values $s = -10^{-6}$ in two cases: $N_e = 10^{6}$ and $N_e = 10^{4}$. Compare the two values and interpret the outcome in the conceptual framework of the nearly neutral theory of molecular evolution.\n\nExpress each fixation probability as a dimensionless number rounded to three significant figures, using scientific notation. Report your final answer as an ordered pair where the first entry corresponds to $N_e = 10^{6}$ and the second to $N_e = 10^{4}$.", "solution": "The problem requires the derivation and evaluation of the fixation probability of a new mutation under a diffusion approximation of the Wright-Fisher model with genic selection. The analysis will proceed in three stages: first, the derivation of the general formula for the fixation probability; second, the calculation of this probability for the specified parameters; and third, the interpretation of the results within the framework of the nearly neutral theory of molecular evolution.\n\nThe evolutionary dynamics of the allele frequency, $x$, can be described by a one-dimensional diffusion process. The ultimate probability of fixation, $u(x)$, for an allele with current frequency $x$ is governed by the backward Kolmogorov equation:\n$$ m(x) \\frac{du}{dx} + \\frac{1}{2} v(x) \\frac{d^2u}{dx^2} = 0 $$\nThe boundary conditions for a fixation problem are $u(0)=0$ and $u(1)=1$, as an allele with frequency $0$ is lost (fixation probability is $0$) and an allele with frequency $1$ is fixed (fixation probability is $1$).\n\nIn the Wright-Fisher model for a diploid population of effective size $N_e$, the drift coefficient, $m(x)$, and the diffusion variance coefficient, $v(x)$, are given by the mean and variance of the change in allele frequency per generation. For genic selection with selection coefficient $s$ (representing the fitness advantage of the mutant allele in heterozygous state), these coefficients are:\n$$ m(x) = s x(1-x) $$\n$$ v(x) = \\frac{x(1-x)}{2N_e} $$\nSubstituting these expressions into the backward Kolmogorov equation yields:\n$$ s x(1-x) \\frac{du}{dx} + \\frac{1}{2} \\left( \\frac{x(1-x)}{2N_e} \\right) \\frac{d^2u}{dx^2} = 0 $$\nFor allele frequencies $x \\in (0, 1)$, we can divide by the common factor $x(1-x)$:\n$$ s \\frac{du}{dx} + \\frac{1}{4N_e} \\frac{d^2u}{dx^2} = 0 $$\nThis is a second-order linear ordinary differential equation with constant coefficients for the function $p(x) = \\frac{du}{dx}$. Let's write it as:\n$$ \\frac{d p(x)}{dx} + (4N_e s) p(x) = 0 $$\nThis is a first-order separable equation with the solution:\n$$ p(x) = C_1 \\exp(-4N_e s x) $$\nwhere $C_1$ is a constant of integration. Since $p(x) = \\frac{du}{dx}$, we integrate with respect to $x$ to find $u(x)$:\n$$ u(x) = \\int p(y) dy = C_1 \\int \\exp(-4N_e s y) dy = C_1 \\left( \\frac{\\exp(-4N_e s x)}{-4N_e s} \\right) + C_2 $$\nTo determine the constants $C_1$ and $C_2$, we apply the boundary conditions. It is more direct to use definite integrals.\n$$ u(x) = \\int_0^x \\frac{du}{dy} dy + u(0) $$\nUsing $u(0)=0$ and $\\frac{du}{dy} = C_1 \\exp(-4N_e s y)$:\n$$ u(x) = C_1 \\int_0^x \\exp(-4N_e s y) dy $$\nNow, applying the second boundary condition, $u(1)=1$:\n$$ 1 = C_1 \\int_0^1 \\exp(-4N_e s y) dy $$\nThis allows us to solve for $C_1$:\n$$ C_1 = \\frac{1}{\\int_0^1 \\exp(-4N_e s y) dy} $$\nSubstituting $C_1$ back into the expression for $u(x)$, we obtain the general solution for the fixation probability, a result first derived by Kimura:\n$$ u(x) = \\frac{\\int_0^x \\exp(-4N_e s y) dy}{\\int_0^1 \\exp(-4N_e s y) dy} $$\nThe integrals are evaluated as:\n$$ \\int_0^z \\exp(-4N_e s y) dy = \\left[ -\\frac{1}{4N_e s} \\exp(-4N_e s y) \\right]_0^z = \\frac{1 - \\exp(-4N_e s z)}{4N_e s} $$\nThus, the fixation probability simplifies to:\n$$ u(x) = \\frac{1 - \\exp(-4N_e s x)}{1 - \\exp(-4N_e s)} $$\nThe problem considers a new mutation arising in a single copy in the population. The initial frequency is therefore $x_0 = \\frac{1}{2N_e}$. Substituting this into our derived formula gives the fixation probability for the new mutation:\n$$ u(x_0) = u\\left(\\frac{1}{2N_e}\\right) = \\frac{1 - \\exp\\left(-4N_e s \\frac{1}{2N_e}\\right)}{1 - \\exp(-4N_e s)} = \\frac{1 - \\exp(-2s)}{1 - \\exp(-4N_e s)} $$\nWe now evaluate this expression for the given parameters. The selection coefficient is $s = -10^{-6}$.\n\nCase 1: $N_e = 10^6$.\nThe fixation probability is:\n$$ u_1 = \\frac{1 - \\exp(-2 \\times (-10^{-6}))}{1 - \\exp(-4 \\times 10^6 \\times (-10^{-6}))} = \\frac{1 - \\exp(2 \\times 10^{-6})}{1 - \\exp(4)} $$\nUsing a calculator for precision:\n$$ u_1 \\approx \\frac{1 - 1.000002000002}{1 - 54.598150} = \\frac{-2.000002 \\times 10^{-6}}{-53.598150} \\approx 3.73148 \\times 10^{-8} $$\nRounded to three significant figures, this is $3.73 \\times 10^{-8}$.\n\nCase 2: $N_e = 10^4$.\nThe fixation probability is:\n$$ u_2 = \\frac{1 - \\exp(-2 \\times (-10^{-6}))}{1 - \\exp(-4 \\times 10^4 \\times (-10^{-6}))} = \\frac{1 - \\exp(2 \\times 10^{-6})}{1 - \\exp(0.04)} $$\nUsing a calculator:\n$$ u_2 \\approx \\frac{1 - 1.000002000002}{1 - 1.04081077} = \\frac{-2.000002 \\times 10^{-6}}{-0.04081077} \\approx 4.90070 \\times 10^{-5} $$\nRounded to three significant figures, this is $4.90 \\times 10^{-5}$.\n\nFinally, we interpret these results. The fixation probability in the smaller population ($u_2 \\approx 4.90 \\times 10^{-5}$) is significantly larger than in the larger population ($u_1 \\approx 3.73 \\times 10^{-8}$). This phenomenon is a central prediction of the nearly neutral theory of molecular evolution. The theory states that the evolutionary fate of mutations with small selection coefficients is determined by the compound parameter $N_e s$, which measures the strength of selection relative to genetic drift. The critical threshold is often considered to be $|2N_e s| \\approx 1$.\n\nIn Case 1 ($N_e = 10^6$), the parameter is $|2N_e s| = |2 \\times 10^6 \\times (-10^{-6})| = 2$. Since this value is greater than $1$, natural selection is strong enough to act efficiently. As the mutation is deleterious ($s  0$), it is effectively purged from the population, resulting in a very low fixation probability, far below the neutral expectation of $x_0 = \\frac{1}{2N_e} = \\frac{1}{2 \\times 10^6} = 5 \\times 10^{-7}$.\n\nIn Case 2 ($N_e = 10^4$), the parameter is $|2N_e s| = |2 \\times 10^4 \\times (-10^{-6})| = 0.02$. Since this value is much less than $1$, the force of random genetic drift overwhelms the weak selective pressure. The mutation behaves as if it is effectively neutral. The fixation probability of a strictly neutral allele is its initial frequency, $x_0 = \\frac{1}{2N_e} = \\frac{1}{2 \\times 10^4} = 5 \\times 10^{-5}$. Our calculated value, $u_2 \\approx 4.90 \\times 10^{-5}$, is very close to this neutral expectation. The weak deleterious effect is almost completely masked by drift.\n\nIn conclusion, for a fixed deleterious selection coefficient, a smaller population size renders selection less effective, allowing the allele to drift to fixation with a probability approaching the neutral rate. Conversely, in a large population, the same allele is subject to efficient negative selection, drastically reducing its chance of fixation. This demonstrates the population-size-dependent boundary between selective and neutral evolution for nearly neutral mutations.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.73 \\times 10^{-8}  4.90 \\times 10^{-5}\n\\end{pmatrix}\n}\n$$", "id": "2758906"}, {"introduction": "Evolution does not act on mutations one at a time; it sorts through a continuous influx of new mutations with a wide spectrum of fitness effects. This advanced exercise bridges the gap from single-locus theory to the more realistic genomic context by introducing the Distribution of Fitness Effects (DFE). Your task is to compute the fraction of all new deleterious mutations that are \"nearly neutral\" for a given population size, a quantity of great importance for understanding rates of molecular evolution. This computational practice [@problem_id:2758951] operationalizes the theory and reflects the methods used in modern evolutionary genomics.", "problem": "You are asked to operationalize a core quantity in the nearly neutral theory of molecular evolution for a deleterious Distribution of Fitness Effects (DFE). Work in a haploid or additive diploid Wright–Fisher setting with effective population size $N_e$, where a new mutation arises at initial frequency $1/(2N_e)$. Assume the following foundational facts:\n\n1. The fixation probability of a new mutation with selection coefficient $s$ in a constant population under Wright–Fisher dynamics is a well-tested result of diffusion theory. Its Taylor expansion about $s=0$ implies a neutral benchmark fixation probability of $1/(2N_e)$ and that selection is weak when $|2N_e s|$ is small.\n\n2. The deleterious DFE is modeled by a Gamma distribution for the absolute fitness effect magnitude $X$, with $X \\sim \\mathrm{Gamma}(k,\\theta)$ having shape $k0$ and scale $\\theta0$. The selection coefficient is $s=-X \\le 0$. The mean of $s$ equals $\\bar{s}=-k\\theta0$. Thus, given $k$ and $\\bar{s}0$, the scale is $\\theta=-\\bar{s}/k0$.\n\nDefine the nearly neutral fraction $F_{\\mathrm{NN}}(N_e)$ as the probability that a new mutation is effectively neutral with respect to drift versus selection according to the canonical drift–selection boundary $|2N_e s|\\le 1$. Your task is to compute $F_{\\mathrm{NN}}(N_e)$ numerically for several parameter sets.\n\nExpress $F_{\\mathrm{NN}}(N_e)$ purely as a mathematical quantity by integrating the DFE over the subset of $s$ that satisfy the nearly neutral criterion. Use the fact that $s=-X$ with $X \\ge 0$. You must not assume any ad hoc shortcuts beyond the foundational ingredients stated above; evaluate the relevant integral numerically or via mathematically equivalent special functions.\n\nLet $F_{\\mathrm{NN}}(N_e)$ be computed for each of the following six test cases, where each case is a triple $(k,\\bar{s},N_e)$:\n\n- Test case $1$: $k=0.5$, $\\bar{s}=-10^{-3}$, $N_e=10^{3}$.\n- Test case $2$: $k=0.5$, $\\bar{s}=-10^{-3}$, $N_e=50$.\n- Test case $3$: $k=5.0$, $\\bar{s}=-10^{-3}$, $N_e=10^{3}$.\n- Test case $4$: $k=0.2$, $\\bar{s}=-10^{-4}$, $N_e=10^{6}$.\n- Test case $5$: $k=2.0$, $\\bar{s}=-10^{-5}$, $N_e=10^{4}$.\n- Test case $6$: $k=1.0$, $\\bar{s}=-10^{-4}$, $N_e=1$.\n\nFor each test case:\n\n- Compute the corresponding Gamma scale $\\theta=-\\bar{s}/k$.\n- Numerically compute $F_{\\mathrm{NN}}(N_e)$ under the criterion $|2N_e s| \\le 1$.\n- Report the result as a real number in $[0,1]$, rounded to $6$ decimal places.\n\nFinal output format: Your program should produce a single line of output containing the six numerical results as a comma-separated list enclosed in square brackets (for example, \"[0.123456,0.234567,0.345678,0.456789,0.567890,0.678901]\"). There are no physical units or angle units in this problem, and no percentages should be printed.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of population genetics, specifically the nearly neutral theory of molecular evolution. It is well-posed, objective, and contains all necessary information for a unique solution. I will proceed to provide a complete, reasoned solution.\n\nThe objective is to compute the nearly neutral fraction, denoted as $F_{\\mathrm{NN}}(N_e)$. This quantity represents the probability that a new deleterious mutation is effectively neutral. The criterion for being effectively neutral is given by the canonical drift-selection boundary condition $|2N_e s| \\le 1$, where $N_e$ is the effective population size and $s$ is the selection coefficient.\n\nThe problem specifies that mutations are deleterious, meaning their selection coefficients are non-positive. The selection coefficient $s$ is related to the magnitude of the fitness effect, a positive random variable $X$, by the relation $s = -X$. Since $X \\ge 0$ and $N_e  0$, the condition for near-neutrality simplifies:\n$$ |2N_e (-X)| \\le 1 \\implies 2N_e X \\le 1 \\implies 0 \\le X \\le \\frac{1}{2N_e} $$\nThe nearly neutral fraction $F_{\\mathrm{NN}}(N_e)$ is therefore the probability that the random variable $X$ falls within this interval.\n\nThe magnitude of the deleterious fitness effect, $X$, is stated to follow a Gamma distribution, $X \\sim \\mathrm{Gamma}(k, \\theta)$, with shape parameter $k  0$ and scale parameter $\\theta  0$. The probability density function (PDF) of $X$ is given by:\n$$ f(x; k, \\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\theta^k \\Gamma(k)} \\quad \\text{for } x \\ge 0 $$\nwhere $\\Gamma(k)$ is the gamma function.\n\nThe nearly neutral fraction $F_{\\mathrm{NN}}(N_e)$ is calculated by integrating this PDF over the interval $[0, 1/(2N_e)]$:\n$$ F_{\\mathrm{NN}}(N_e) = P\\left(X \\le \\frac{1}{2N_e}\\right) = \\int_{0}^{1/(2N_e)} f(x; k, \\theta) \\,dx $$\nThis integral is, by definition, the value of the cumulative distribution function (CDF) of the Gamma distribution evaluated at the point $x' = 1/(2N_e)$.\n\nThe CDF of a Gamma-distributed random variable is most properly expressed using the regularized lower incomplete gamma function, denoted $P(a, z)$, which is defined as:\n$$ P(a, z) = \\frac{\\gamma(a, z)}{\\Gamma(a)} = \\frac{1}{\\Gamma(a)} \\int_{0}^{z} t^{a-1} e^{-t} \\,dt $$\nTo relate our integral to this standard form, we perform a change of variables $t = x/\\theta$, which implies $x = t\\theta$ and $dx = \\theta dt$. The upper limit of integration becomes $x = 1/(2N_e)$, which corresponds to $t = 1/(2N_e\\theta)$. The integral transforms as follows:\n$$ F_{\\mathrm{NN}}(N_e) = \\int_{0}^{1/(2N_e\\theta)} \\frac{(t\\theta)^{k-1} e^{-t}}{\\theta^k \\Gamma(k)} (\\theta \\,dt) = \\frac{1}{\\Gamma(k)} \\int_{0}^{1/(2N_e\\theta)} t^{k-1} e^{-t} \\,dt $$\nThis is precisely the regularized lower incomplete gamma function with shape $a=k$ and argument $z = 1/(2N_e\\theta)$:\n$$ F_{\\mathrm{NN}}(N_e) = P\\left(k, \\frac{1}{2N_e\\theta}\\right) $$\nThe problem provides parameters $k$ and the mean selection coefficient $\\bar{s}$. The mean of the random variable $X \\sim \\mathrm{Gamma}(k, \\theta)$ is $E[X] = k\\theta$. Since $s=-X$, the mean selection coefficient is $\\bar{s} = E[-X] = -E[X] = -k\\theta$. We can solve for the scale parameter $\\theta$:\n$$ \\theta = -\\frac{\\bar{s}}{k} $$\nSince $\\bar{s}  0$ and $k  0$, the scale parameter $\\theta$ is correctly positive.\n\nSubstituting this expression for $\\theta$ into the argument $z$ gives:\n$$ z = \\frac{1}{2N_e \\theta} = \\frac{1}{2N_e (-\\bar{s}/k)} = \\frac{k}{-2N_e \\bar{s}} $$\nThus, for each test case specified by the triplet $(k, \\bar{s}, N_e)$, the computation proceeds in two steps:\n1.  Calculate the argument for the special function: $z = k/(-2N_e \\bar{s})$.\n2.  Compute the nearly neutral fraction: $F_{\\mathrm{NN}}(N_e) = P(k, z)$, using a standard numerical library implementation of the regularized lower incomplete gamma function.\n\nThis procedure is mathematically rigorous and directly follows from the problem statement without any ad hoc assumptions. We will now apply it to the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammainc\n\ndef solve():\n    \"\"\"\n    Computes the nearly neutral fraction F_NN for a deleterious DFE.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (k, s_bar, Ne), representing the Gamma shape,\n    # mean selection coefficient, and effective population size.\n    test_cases = [\n        (0.5, -1e-3, 1e3),\n        (0.5, -1e-3, 50.0),\n        (5.0, -1e-3, 1e3),\n        (0.2, -1e-4, 1e6),\n        (2.0, -1e-5, 1e4),\n        (1.0, -1e-4, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        k, s_bar, Ne = case\n\n        # The nearly neutral fraction F_NN is the probability that a new\n        # deleterious mutation has a selection coefficient s such that |2*Ne*s| = 1.\n        # Given s = -X where X is the fitness effect magnitude (X >= 0),\n        # the condition for near-neutrality becomes 2*Ne*X = 1, or X = 1 / (2*Ne).\n\n        # The magnitude of the fitness effect X follows a Gamma distribution:\n        # X ~ Gamma(shape=k, scale=theta).\n        # We are given the mean selection coefficient s_bar = E[s] = E[-X] = -E[X].\n        # For a Gamma(k, theta) distribution, the mean is k*theta, so E[X] = k*theta.\n        # This implies s_bar = -k*theta.\n\n        # From the given parameters, we find the scale parameter theta.\n        # As s_bar  0 and k > 0, theta is positive as required.\n        theta = -s_bar / k\n\n        # F_NN is the probability P(X = 1 / (2*Ne)).\n        # This is the value of the cumulative distribution function (CDF) of the\n        # Gamma(k, theta) distribution evaluated at the cutoff x_cutoff = 1 / (2*Ne).\n        x_cutoff = 1.0 / (2.0 * Ne)\n\n        # The CDF of a Gamma distribution is given by the regularized lower\n        # incomplete gamma function, P(a, z), where 'a' is the shape parameter\n        # and 'z = x / theta' is the argument.\n        # Here, a = k and z = x_cutoff / theta.\n        # z can also be calculated as z = k / (-2 * Ne * s_bar).\n        z_arg = x_cutoff / theta\n\n        # Calculate F_NN using scipy.special.gammainc for the regularized\n        # lower incomplete gamma function P(k, z).\n        f_nn = gammainc(k, z_arg)\n\n        # Append the result, formatted to 6 decimal places as specified.\n        results.append(f\"{f_nn:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2758951"}]}