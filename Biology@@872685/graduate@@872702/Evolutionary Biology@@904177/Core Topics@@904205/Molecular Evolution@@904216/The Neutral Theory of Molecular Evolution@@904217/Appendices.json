{"hands_on_practices": [{"introduction": "The neutral theory's most famous prediction is the molecular clock, which posits that neutral genetic substitutions accumulate at a constant rate equal to the neutral mutation rate. This powerful concept allows us to use genetic divergence as a tool to estimate evolutionary timescales. This exercise [@problem_id:1527865] provides a foundational application of this principle, guiding you through the calculation of a neutral mutation rate using sequence divergence data and a geological calibration point.", "problem": "A team of molecular evolutionists is studying two species of flightless birds endemic to remote islands. They postulate that the species diverged after a single colonization event. To construct a molecular clock, they sequence a pseudogene locus—a non-coding region of DNA that is presumed to be evolving neutrally, free from the pressures of natural selection.\n\nThe aligned sequences of this pseudogene from the two species are found to be 1200 base pairs in length. A direct comparison reveals that there are 36 nucleotide differences between them. Geological analysis of volcanic rock layers on the islands suggests that the ancestral population was split, leading to the divergence of the two species, approximately 6.0 million years ago.\n\nAssuming the neutral theory of molecular evolution holds for this pseudogene, calculate the average rate of neutral mutation. Express your answer in units of mutations per site per year, written in scientific notation and rounded to two significant figures.", "solution": "Let $L$ be the sequence length, $D$ the observed number of differences, $t$ the divergence time, and $\\mu$ the neutral mutation (substitution) rate per site per year. Under the neutral theory and a molecular clock, each lineage accumulates neutral substitutions at rate $\\mu$, so the expected divergence per site between two lineages after time $t$ is\n$$\nK = 2 \\mu t.\n$$\nThe observed divergence per site is\n$$\nK = \\frac{D}{L}.\n$$\nEquating these gives\n$$\n\\frac{D}{L} = 2 \\mu t \\quad \\Rightarrow \\quad \\mu = \\frac{D}{2 t L}.\n$$\nSubstitute $D=36$, $L=1200$, and $t=6.0 \\times 10^{6}$ years:\n$$\n\\mu = \\frac{36}{2 \\times \\left(6.0 \\times 10^{6}\\right) \\times 1200}.\n$$\nCompute the denominator:\n$$\n2 \\times \\left(6.0 \\times 10^{6}\\right) \\times 1200 = \\left(12.0 \\times 10^{6}\\right) \\times 1200 = \\left(1.2 \\times 10^{7}\\right) \\times \\left(1.2 \\times 10^{3}\\right) = 1.44 \\times 10^{10}.\n$$\nThus,\n$$\n\\mu = \\frac{36}{1.44 \\times 10^{10}} = \\frac{3.6 \\times 10^{1}}{1.44 \\times 10^{10}} = \\left(\\frac{3.6}{1.44}\\right) \\times 10^{1-10} = 2.5 \\times 10^{-9}.\n$$\nRounded to two significant figures and expressed in scientific notation, the average rate of neutral mutation is $2.5 \\times 10^{-9}$ mutations per site per year.", "answer": "$$\\boxed{2.5 \\times 10^{-9}}$$", "id": "1527865"}, {"introduction": "While the neutral theory provides a powerful baseline, its predictions are sensitive to underlying assumptions about the mutational process. A common mistake is to assume that a ratio of nonsynonymous to synonymous substitution rates ($d_N/d_S$) less than one is definitive evidence for purifying selection. This hypothetical exercise [@problem_id:1527820] demonstrates how a simple mutational bias can generate a $d_N/d_S  1$ signature even when all mutations are perfectly neutral, underscoring the importance of defining an accurate null model before inferring selection.", "problem": "In molecular evolution, the ratio of nonsynonymous to synonymous substitutions ($D_N/D_S$) is a key indicator of selective pressure on a protein-coding gene. A ratio of 1 is expected under neutral evolution, while a ratio less than 1 typically implies purifying selection. However, this expectation can be violated if the underlying mutational process is biased.\n\nConsider a hypothetical gene in a bacterium where evolution is known to be completely neutral, meaning all mutations that occur are fixed with equal probability regardless of their effect on the amino acid sequence. The mutational process in this bacterium's DNA exhibits a strong bias. The probability of any specific transition (a mutation between two purines, A↔G, or two pyrimidines, C↔T) is $\\kappa=5$ times the probability of any specific transversion (a mutation between a purine and a pyrimidine).\n\nFor simplicity, we analyze only mutations occurring at the third position of codons. The gene is composed of a very large number of two types of codons in the following proportions:\n- 75% are 'Type 1' codons, exemplified by `GAA`, which codes for the amino acid glutamic acid. At the third position, `GAA` can mutate to:\n    - `GAG` (also codes for glutamic acid, a synonymous change)\n    - `GAC` (codes for aspartic acid, a nonsynonymous change)\n    - `GAT` (also codes for aspartic acid, a nonsynonymous change)\n- 25% are 'Type 2' codons, exemplified by `ATA`, which codes for the amino acid isoleucine. At the third position, `ATA` can mutate to:\n    - `ATG` (codes for methionine, a nonsynonymous change)\n    - `ATC` (also codes for isoleucine, a synonymous change)\n    - `ATT` (also codes for isoleucine, a synonymous change)\n\nGiven the assumption of neutral evolution, the ratio of divergence rates, $D_N/D_S$, is equal to the ratio of the total expected number of nonsynonymous mutations to synonymous mutations occurring across the entire gene. Calculate the expected $D_N/D_S$ ratio for this gene. Round your final answer to three significant figures.", "solution": "Under neutral evolution, the fixation probability is the same for all mutations, so the divergence-rate ratio $D_{N}/D_{S}$ equals the ratio of the expected numbers of nonsynonymous to synonymous mutations across the gene. Because we analyze only the third codon position and both codon types have $A$ at this position, each site has three possible single-nucleotide changes: one transition $A \\to G$ and two transversions $A \\to C$ and $A \\to T$. Let the rate (or probability per unit time) of any specific transversion be $\\mu$, so the rate of the specific transition is $\\mu_{ts}=\\kappa \\mu$ with $\\kappa=5$.\n\nFor Type 1 codons (fraction $f_{1}=\\frac{3}{4}$), the third-position changes are: $A \\to G$ synonymous (transition), $A \\to C$ nonsynonymous (transversion), $A \\to T$ nonsynonymous (transversion). Therefore, the expected synonymous and nonsynonymous mutation rates per Type 1 site are\n$$\nS_{1}=\\kappa \\mu,\\qquad N_{1}=2\\mu.\n$$\nFor Type 2 codons (fraction $f_{2}=\\frac{1}{4}$), the third-position changes are: $A \\to G$ nonsynonymous (transition), $A \\to C$ synonymous (transversion), $A \\to T$ synonymous (transversion). Therefore,\n$$\nS_{2}=2\\mu,\\qquad N_{2}=\\kappa \\mu.\n$$\nWeighting by codon-type frequencies, the total expected nonsynonymous and synonymous mutation rates across the gene are\n$$\nN_{\\text{tot}}=f_{1}N_{1}+f_{2}N_{2}=f_{1}(2\\mu)+f_{2}(\\kappa \\mu)=\\mu\\left(2f_{1}+\\kappa f_{2}\\right),\n$$\n$$\nS_{\\text{tot}}=f_{1}S_{1}+f_{2}S_{2}=f_{1}(\\kappa \\mu)+f_{2}(2\\mu)=\\mu\\left(\\kappa f_{1}+2f_{2}\\right).\n$$\nHence\n$$\n\\frac{D_{N}}{D_{S}}=\\frac{N_{\\text{tot}}}{S_{\\text{tot}}}=\\frac{2f_{1}+\\kappa f_{2}}{\\kappa f_{1}+2f_{2}}.\n$$\nSubstituting $f_{1}=\\frac{3}{4}$, $f_{2}=\\frac{1}{4}$, and $\\kappa=5$,\n$$\n\\frac{D_{N}}{D_{S}}=\\frac{2\\cdot \\frac{3}{4}+5\\cdot \\frac{1}{4}}{5\\cdot \\frac{3}{4}+2\\cdot \\frac{1}{4}}=\\frac{\\frac{3}{2}+\\frac{5}{4}}{\\frac{15}{4}+\\frac{2}{4}}=\\frac{\\frac{11}{4}}{\\frac{17}{4}}=\\frac{11}{17}\\approx 0.6470588.\n$$\nRounded to three significant figures, this yields $0.647$.", "answer": "$$\\boxed{0.647}$$", "id": "1527820"}, {"introduction": "One of the most significant contributions of the neutral theory is its role as a null hypothesis for detecting natural selection. The McDonald-Kreitman (MK) test is a classic method that leverages this principle by contrasting polymorphism within a species with divergence between species. This advanced practice [@problem_id:2859585] delves into this powerful technique, tasking you with deriving the formula for $\\alpha$, the proportion of adaptive amino acid substitutions, and applying it to a realistic dataset to quantify the historical impact of positive selection.", "problem": "A comparative population genomics study collected coding sequence data for $8$ genes from a focal species and a closely related outgroup. For each gene $i$, the data consist of counts of segregating polymorphic sites within the focal species at nonsynonymous sites ($P_{N,i}$) and synonymous sites ($P_{S,i}$), and counts of fixed differences between the focal species and the outgroup at nonsynonymous sites ($D_{N,i}$) and synonymous sites ($D_{S,i}$). The neutral theory of molecular evolution asserts that the long-term substitution rate equals the neutral mutation rate, and under neutrality the ratio of nonsynonymous to synonymous changes is expected to be the same on both the within-species polymorphism and between-species divergence timescales, after appropriately standardizing for opportunities for mutation. In a McDonald–Kreitman (MK) framework, define the proportion of adaptive nonsynonymous substitutions $\\alpha$ as the fraction of nonsynonymous fixed differences that cannot be explained by the neutral expectation inferred from the within-species ratio of nonsynonymous to synonymous polymorphism.\n\nUsing these principles and only the definitions above, do the following:\n- Derive, from first principles, an estimator for $\\alpha$ that depends on the pooled counts $P_{N}=\\sum_{i=1}^{8} P_{N,i}$, $P_{S}=\\sum_{i=1}^{8} P_{S,i}$, $D_{N}=\\sum_{i=1}^{8} D_{N,i}$, and $D_{S}=\\sum_{i=1}^{8} D_{S,i}$.\n- Using the provided per-gene data, compute the point estimate of $\\alpha$.\n- Outline a nonparametric bootstrap strategy to assess the uncertainty of the estimator by resampling genes, and derive a closed-form expression for the bootstrap standard error in terms of the bootstrap replicate estimates.\n\nThe per-gene MK counts are:\n- Gene $1$: $P_{N,1}=5$, $P_{S,1}=22$, $D_{N,1}=12$, $D_{S,1}=20$.\n- Gene $2$: $P_{N,2}=3$, $P_{S,2}=24$, $D_{N,2}=15$, $D_{S,2}=22$.\n- Gene $3$: $P_{N,3}=7$, $P_{S,3}=21$, $D_{N,3}=18$, $D_{S,3}=29$.\n- Gene $4$: $P_{N,4}=4$, $P_{S,4}=26$, $D_{N,4}=20$, $D_{S,4}=34$.\n- Gene $5$: $P_{N,5}=6$, $P_{S,5}=28$, $D_{N,5}=25$, $D_{S,5}=36$.\n- Gene $6$: $P_{N,6}=2$, $P_{S,6}=23$, $D_{N,6}=14$, $D_{S,6}=29$.\n- Gene $7$: $P_{N,7}=8$, $P_{S,7}=20$, $D_{N,7}=23$, $D_{S,7}=30$.\n- Gene $8$: $P_{N,8}=3$, $P_{S,8}=26$, $D_{N,8}=18$, $D_{S,8}=20$.\n\nReport the numeric point estimate of $\\alpha$ as a decimal and round your answer to four significant figures. No units are required.", "solution": "The problem requires the derivation and application of an estimator for the proportion of adaptive nonsynonymous substitutions, denoted by $\\alpha$, within the framework of the McDonald–Kreitman (MK) test. The validity of the problem statement must first be established.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\n- Data are collected for $8$ genes from a focal species and an outgroup.\n- For each gene $i$, the data are:\n    - $P_{N,i}$: count of nonsynonymous polymorphic sites.\n    - $P_{S,i}$: count of synonymous polymorphic sites.\n    - $D_{N,i}$: count of nonsynonymous fixed differences.\n    - $D_{S,i}$: count of synonymous fixed differences.\n- Pooled counts are defined as: $P_{N}=\\sum_{i=1}^{8} P_{N,i}$, $P_{S}=\\sum_{i=1}^{8} P_{S,i}$, $D_{N}=\\sum_{i=1}^{8} D_{N,i}$, and $D_{S}=\\sum_{i=1}^{8} D_{S,i}$.\n- Neutral Theory Assertion: \"under neutrality the ratio of nonsynonymous to synonymous changes is expected to be the same on both the within-species polymorphism and between-species divergence timescales\".\n- Definition of $\\alpha$: \"the fraction of nonsynonymous fixed differences that cannot be explained by the neutral expectation inferred from the within-species ratio of nonsynonymous to synonymous polymorphism\".\n- Per-gene data provided:\n    - Gene $1$: $P_{N,1}=5$, $P_{S,1}=22$, $D_{N,1}=12$, $D_{S,1}=20$.\n    - Gene $2$: $P_{N,2}=3$, $P_{S,2}=24$, $D_{N,2}=15$, $D_{S,2}=22$.\n    - Gene $3$: $P_{N,3}=7$, $P_{S,3}=21$, $D_{N,3}=18$, $D_{S,3}=29$.\n    - Gene $4$: $P_{N,4}=4$, $P_{S,4}=26$, $D_{N,4}=20$, $D_{S,4}=34$.\n    - Gene $5$: $P_{N,5}=6$, $P_{S,5}=28$, $D_{N,5}=25$, $D_{S,5}=36$.\n    - Gene $6$: $P_{N,6}=2$, $P_{S,6}=23$, $D_{N,6}=14$, $D_{S,6}=29$.\n    - Gene $7$: $P_{N,7}=8$, $P_{S,7}=20$, $D_{N,7}=23$, $D_{S,7}=30$.\n    - Gene $8$: $P_{N,8}=3$, $P_{S,8}=26$, $D_{N,8}=18$, $D_{S,8}=20$.\n\n**Step 2: Validation Using Extracted Givens**\n- The problem is scientifically grounded, based on the neutral theory of molecular evolution and the McDonald-Kreitman test, which are cornerstone concepts in population genetics.\n- The problem is well-posed. It provides clear definitions, a complete dataset, and a set of specific tasks (derivation, calculation, and procedural outline) for which a unique solution can be found.\n- The problem statement is objective and uses precise scientific terminology. There are no subjective or ambiguous claims.\n- The provided data are discrete counts, which is appropriate for this type of analysis, and the values are reasonable. There are no contradictions or missing pieces of essential information.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is scientifically sound, fully specified, and logically consistent. I will now proceed with the solution.\n\n### Solution Derivations and Calculation\n\n**Part 1: Derivation of the estimator for $\\alpha$**\n\nThe neutral theory of molecular evolution posits that the vast majority of evolutionary changes at the molecular level are caused by random genetic drift of selectively neutral mutants. A key prediction is that the ratio of nonsynonymous to synonymous substitutions should be constant over time if all mutations are neutral. This implies that the ratio of nonsynonymous ($N$) to synonymous ($S$) changes observed within a species (polymorphism, $P$) should be the same as the ratio observed between species (divergence, $D$), after accounting for the number of available sites for each type of mutation.\n\nThe neutral expectation is formally stated as:\n$$ \\frac{D_{N, \\text{neutral}}}{D_S} = \\frac{P_N}{P_S} $$\nHere, $D_{N, \\text{neutral}}$ represents the number of nonsynonymous fixed differences that would be expected if all nonsynonymous mutations were neutral. $D_S$ is the number of synonymous fixed differences, which are generally assumed to be neutral and serve as a baseline. $P_N$ and $P_S$ are the numbers of nonsynonymous and synonymous polymorphisms, respectively, which reflect the current mutational input and are assumed to be largely neutral or weakly deleterious.\n\nThe total observed number of nonsynonymous fixed differences, $D_N$, is a sum of those that fixed neutrally ($D_{N, \\text{neutral}}$) and those that fixed due to positive selection, i.e., adaptively ($D_{N, \\text{adaptive}}$):\n$$ D_N = D_{N, \\text{neutral}} + D_{N, \\text{adaptive}} $$\n\nFrom the neutral expectation, we can solve for the expected number of neutral nonsynonymous fixed differences:\n$$ D_{N, \\text{neutral}} = D_S \\frac{P_N}{P_S} $$\n\nThe problem defines $\\alpha$ as the fraction of nonsynonymous fixed differences that are adaptive. Mathematically, this is:\n$$ \\alpha = \\frac{D_{N, \\text{adaptive}}}{D_N} $$\n\nSubstituting $D_{N, \\text{adaptive}} = D_N - D_{N, \\text{neutral}}$ into the expression for $\\alpha$ gives:\n$$ \\alpha = \\frac{D_N - D_{N, \\text{neutral}}}{D_N} = 1 - \\frac{D_{N, \\text{neutral}}}{D_N} $$\n\nFinally, substituting the expression for $D_{N, \\text{neutral}}$ based on the neutral expectation, we arrive at the estimator for $\\alpha$:\n$$ \\hat{\\alpha} = 1 - \\frac{D_S P_N}{D_N P_S} $$\nThis is the required estimator derived from first principles.\n\n**Part 2: Computation of the point estimate of $\\alpha$**\n\nFirst, we must compute the pooled counts from the per-gene data for the $8$ genes.\n$$ P_N = \\sum_{i=1}^{8} P_{N,i} = 5 + 3 + 7 + 4 + 6 + 2 + 8 + 3 = 38 $$\n$$ P_S = \\sum_{i=1}^{8} P_{S,i} = 22 + 24 + 21 + 26 + 28 + 23 + 20 + 26 = 190 $$\n$$ D_N = \\sum_{i=1}^{8} D_{N,i} = 12 + 15 + 18 + 20 + 25 + 14 + 23 + 18 = 145 $$\n$$ D_S = \\sum_{i=1}^{8} D_{S,i} = 20 + 22 + 29 + 34 + 36 + 29 + 30 + 20 = 220 $$\n\nNow, substitute these pooled counts into the estimator for $\\alpha$:\n$$ \\hat{\\alpha} = 1 - \\frac{(220)(38)}{(145)(190)} = 1 - \\frac{8360}{27550} $$\nCalculating the fraction:\n$$ \\frac{8360}{27550} \\approx 0.303448275... $$\nTherefore, the point estimate of $\\alpha$ is:\n$$ \\hat{\\alpha} \\approx 1 - 0.303448275... = 0.696551724... $$\nRounding to four significant figures as required:\n$$ \\hat{\\alpha} \\approx 0.6966 $$\n\n**Part 3: Nonparametric bootstrap strategy and standard error expression**\n\nTo assess the uncertainty of the estimator $\\hat{\\alpha}$, a nonparametric bootstrap procedure by resampling genes is appropriate. The unit of resampling is the entire gene, as the counts ($P_N, P_S, D_N, D_S$) for a single gene are not independent.\n\nThe strategy is as follows:\n$1$. The original dataset consists of $N=8$ observations, where each observation $i$ is a vector of four counts: $\\text{gene}_i = (P_{N,i}, P_{S,i}, D_{N,i}, D_{S,i})$.\n\n$2$. Generate a bootstrap replicate dataset by sampling $N=8$ genes with replacement from the original set of genes. Let the $b$-th bootstrap sample be $\\{\\text{gene}_1^{(b)}, \\text{gene}_2^{(b)}, ..., \\text{gene}_8^{(b)}\\}$.\n\n$3$. For each bootstrap replicate $b$, calculate the pooled counts by summing over the resampled genes:\n$$ P_N^{(b)} = \\sum_{j=1}^{8} P_{N,j}^{(b)}, \\quad P_S^{(b)} = \\sum_{j=1}^{8} P_{S,j}^{(b)}, \\quad D_N^{(b)} = \\sum_{j=1}^{8} D_{N,j}^{(b)}, \\quad D_S^{(b)} = \\sum_{j=1}^{8} D_{S,j}^{(b)} $$\n\n$4$. Compute the bootstrap replicate estimate of $\\alpha$ for this replicate:\n$$ \\hat{\\alpha}^{(b)} = 1 - \\frac{D_S^{(b)} P_N^{(b)}}{D_N^{(b)} P_S^{(b)}} $$\n\n$5$. Repeat steps $2$-$4$ a large number of times, $B$ (e.g., $B \\ge 1000$), to obtain a distribution of bootstrap estimates $\\{\\hat{\\alpha}^{(1)}, \\hat{\\alpha}^{(2)}, ..., \\hat{\\alpha}^{(B)}\\}$.\n\nThe bootstrap standard error, $SE_{\\text{boot}}(\\hat{\\alpha})$, is the standard deviation of this distribution of bootstrap estimates. A closed-form expression for this standard error, in terms of the bootstrap replicate estimates, is given by the sample standard deviation formula:\n$$ SE_{\\text{boot}}(\\hat{\\alpha}) = \\sqrt{\\frac{1}{B-1} \\sum_{b=1}^{B} (\\hat{\\alpha}^{(b)} - \\bar{\\alpha}_{\\text{boot}})^2} $$\nwhere $\\bar{\\alpha}_{\\text{boot}}$ is the mean of the bootstrap replicate estimates:\n$$ \\bar{\\alpha}_{\\text{boot}} = \\frac{1}{B} \\sum_{b=1}^{B} \\hat{\\alpha}^{(b)} $$\nThis expression provides the requested measure of statistical uncertainty for the point estimate $\\hat{\\alpha}$.", "answer": "$$\\boxed{0.6966}$$", "id": "2859585"}]}