{"hands_on_practices": [{"introduction": "To begin quantifying codon usage bias, we first need a standardized metric that allows for fair comparisons across different amino acids, which vary in their number of synonymous codons. The Relative Synonymous Codon Usage (RSCU) provides exactly this by comparing the observed frequency of a codon to what would be expected under a model of uniform usage. This exercise [@problem_id:2697540] will guide you through the first-principles derivation of RSCU, providing a foundational tool for any analysis of codon preference.", "problem": "You are studying codon usage bias in a prokaryotic genome. For an amino acid with multiple synonymous codons, researchers often quantify usage patterns using Relative Synonymous Codon Usage (RSCU). Consider a single amino acid family, denoted by index $a$, that is encoded by $k_{a}$ synonymous codons. Let the observed counts of these codons in a sufficiently large set of coding sequences be $x_{a,1}, x_{a,2}, \\ldots, x_{a,k_{a}}$, with total $X_{a}=\\sum_{j=1}^{k_{a}} x_{a,j}$. \n\nUsing a null model in which, conditional on the amino acid $a$, each of its $k_{a}$ synonymous codons is equally likely to be used, derive from first principles a closed-form expression for the Relative Synonymous Codon Usage (RSCU) of codon $i$ in family $a$ as the ratio of its observed count to its expected count under the null model. Then, explain how to interpret values greater than $1$, equal to $1$, or less than $1$ in terms of overuse or underuse relative to the equal-usage expectation.\n\nTo check your derivation concretely, consider the amino acid leucine (which has $k_{a}=6$ synonymous codons). Suppose the observed counts in a curated gene set are $x_{a,1}=255$, $x_{a,2}=90$, $x_{a,3}=30$, $x_{a,4}=60$, $x_{a,5}=45$, and $x_{a,6}=120$, so that $X_{a}=600$. Use your derived expression to compute the RSCU values for codons $1$ and $3$ and state whether each is overused, neutrally used, or underused under the equal-usage null. Do not round these example values.\n\nYour final boxed answer should be the general closed-form expression for the RSCU of codon $i$ in family $a$, in terms of $k_{a}$ and the observed counts $x_{a,1},\\ldots,x_{a,k_{a}}$ only. No units are required.", "solution": "The problem presented requires the derivation of the Relative Synonymous Codon Usage ($RSCU$) metric from first principles, based on a defined null model of uniform codon usage. This is a standard procedure in the quantitative analysis of genomic data. The problem statement is scientifically grounded, well-posed, and contains all necessary information for its resolution. I will proceed with the derivation.\n\nLet us denote an amino acid family by the index $a$. This amino acid is encoded by a set of $k_a$ synonymous codons. The observed counts of these codons within a large set of gene sequences are given as $x_{a,1}, x_{a,2}, \\ldots, x_{a,k_a}$. The total number of codons observed for this specific amino acid is the sum of these individual counts:\n$$\nX_a = \\sum_{j=1}^{k_a} x_{a,j}\n$$\n\nThe null hypothesis, or null model, posits that under no selective pressure for codon preference, each of the $k_a$ synonymous codons for amino acid $a$ would be used with equal frequency. Therefore, conditional on the amino acid being $a$, the probability of observing any specific codon $i$ from this family is:\n$$\nP(\\text{codon}_i | \\text{amino acid}_a) = \\frac{1}{k_a}\n$$\n\nThe expected count of a specific codon $i$, denoted as $E[x_{a,i}]$, is the total number of observations for this amino acid family, $X_a$, multiplied by the probability of codon $i$ occurring under the null model.\n$$\nE[x_{a,i}] = X_a \\cdot P(\\text{codon}_i | \\text{amino acid}_a) = X_a \\cdot \\frac{1}{k_a} = \\frac{X_a}{k_a}\n$$\nThis expected count represents the number of times we would anticipate seeing codon $i$ if codon usage were perfectly uniform across the $k_a$ synonymous options, given a total of $X_a$ instances of the amino acid.\n\nThe problem defines the Relative Synonymous Codon Usage ($RSCU$) for codon $i$ in family $a$, which we denote as $RSCU_{a,i}$, as the ratio of its observed count to its expected count under this null model.\n$$\nRSCU_{a,i} = \\frac{\\text{Observed Count}}{\\text{Expected Count}} = \\frac{x_{a,i}}{E[x_{a,i}]}\n$$\nSubstituting the derived expression for the expected count, we obtain:\n$$\nRSCU_{a,i} = \\frac{x_{a,i}}{\\frac{X_a}{k_a}} = \\frac{x_{a,i} \\cdot k_a}{X_a}\n$$\nFinally, by substituting the definition of $X_a$, we arrive at the closed-form expression for $RSCU_{a,i}$ in terms of the number of synonymous codons $k_a$ and the observed counts $x_{a,j}$:\n$$\nRSCU_{a,i} = \\frac{x_{a,i} \\cdot k_a}{\\sum_{j=1}^{k_a} x_{a,j}}\n$$\nThis is the general expression required.\n\nThe interpretation of the $RSCU_{a,i}$ value is straightforward. It is a normalized measure of codon usage that directly compares the observed frequency to the frequency expected under a uniform usage model.\n- If $RSCU_{a,i} > 1$, it means the observed count $x_{a,i}$ is greater than the expected count $\\frac{X_a}{k_a}$. This indicates that the codon $i$ is used more frequently than expected by chance, and is thus considered **overused** or preferred.\n- If $RSCU_{a,i} = 1$, the observed count $x_{a,i}$ is exactly equal to the expected count $\\frac{X_a}{k_a}$. This indicates that the codon $i$ is used at a frequency consistent with the null model, and is thus considered **neutrally used**.\n- If $RSCU_{a,i} < 1$, the observed count $x_{a,i}$ is less than the expected count $\\frac{X_a}{k_a}$. This indicates that the codon $i$ is used less frequently than expected by chance, and is thus considered **underused** or non-preferred.\n\nNow, we apply this derivation to the specific example of leucine. The givens are:\n- Number of synonymous codons, $k_a = 6$.\n- Observed counts: $x_{a,1}=255$, $x_{a,2}=90$, $x_{a,3}=30$, $x_{a,4}=60$, $x_{a,5}=45$, and $x_{a,6}=120$.\n- Total count for leucine, $X_a = \\sum_{j=1}^{6} x_{a,j} = 255+90+30+60+45+120 = 600$.\n\nFirst, we calculate the expected count for any single leucine codon under the null model of equal usage:\n$$\nE[x_{a,i}] = \\frac{X_a}{k_a} = \\frac{600}{6} = 100\n$$\nNow, we compute the $RSCU$ value for codon $1$:\n$$\nRSCU_{a,1} = \\frac{x_{a,1}}{E[x_{a,1}]} = \\frac{255}{100} = 2.55\n$$\nSince $RSCU_{a,1} = 2.55 > 1$, codon $1$ is **overused**.\n\nNext, we compute the $RSCU$ value for codon $3$:\n$$\nRSCU_{a,3} = \\frac{x_{a,3}}{E[x_{a,3}]} = \\frac{30}{100} = 0.3\n$$\nSince $RSCU_{a,3} = 0.3 < 1$, codon $3$ is **underused**.\n\nThe derived general formula provides a robust and standardized method for quantifying deviations from uniform codon usage, which is a fundamental aspect of studying molecular evolution and the forces, such as translational selection, that shape genome composition.", "answer": "$$\n\\boxed{\\frac{x_{a,i} \\cdot k_a}{\\sum_{j=1}^{k_a} x_{a,j}}}\n$$", "id": "2697540"}, {"introduction": "While RSCU is invaluable for examining individual codons, we often need a single, composite measure to describe the overall strength of codon usage bias for an entire gene. The Effective Number of Codons (ENC) serves this purpose, conceptually representing how many codons a gene 'effectively' uses, with values ranging from 20 (extreme bias) to 61 (no bias). This practice [@problem_id:2697530] provides a step-by-step walkthrough for calculating the ENC from a hypothetical set of codon counts, enabling you to summarize and compare codon usage bias across different genes.", "problem": "You are given synonymous codon count data for a single gene in a free-living bacterium. Assume the Standard Genetic Code and that the Start codon Methionine (Met) and Tryptophan (Trp) are excluded from codon usage bias calculations. The gene uses all remaining amino acids with at least two occurrences in each synonymous family. Codon usage bias is to be quantified by the effective number of codons (ENC), a widely used measure of how evenly synonymous codons are employed.\n\nFoundational definitions and facts:\n- In the Standard Genetic Code, most amino acids are encoded by multiple synonymous codons. These form synonymous families of degeneracy $k \\in \\{2,3,4,6\\}$, where $k$ is the number of synonymous codons in the family.\n- For a given amino acid family $j$ with $k$ synonymous codons and counts $\\{n_{j,1},\\dots,n_{j,k}\\}$ summing to $n_j = \\sum_{i=1}^{k} n_{j,i}$, define the within-family codon homozygosity (unbiased estimator) as\n$$\n\\hat{F}_j \\;=\\; \\frac{n_j \\sum_{i=1}^{k} \\left(\\frac{n_{j,i}}{n_j}\\right)^{2} - 1}{n_j - 1} \\;=\\; \\frac{\\sum_{i=1}^{k} n_{j,i}^{2} - n_j}{n_j\\,(n_j - 1)}.\n$$\n- For each degeneracy class $k \\in \\{2,3,4,6\\}$, define $F_k$ as the arithmetic mean of $\\hat{F}_j$ over all amino acid families of that degeneracy in the Standard Genetic Code.\n- Wright’s effective number of codons (ENC) is then given by\n$$\n\\mathrm{ENC} \\;=\\; 2 \\;+\\; \\frac{9}{F_2} \\;+\\; \\frac{1}{F_3} \\;+\\; \\frac{5}{F_4} \\;+\\; \\frac{3}{F_6}.\n$$\n\nThe observed synonymous codon counts for this gene are:\n\n- Two-fold families ($k=2$, $9$ families; exclude any subfamilies of six-fold amino acids from this list):\n  - Phenylalanine (Phe): UUU $7$, UUC $3$.\n  - Tyrosine (Tyr): UAU $4$, UAC $6$.\n  - Cysteine (Cys): UGU $2$, UGC $3$.\n  - Histidine (His): CAU $5$, CAC $5$.\n  - Glutamine (Gln): CAA $6$, CAG $9$.\n  - Asparagine (Asn): AAU $3$, AAC $5$.\n  - Lysine (Lys): AAA $12$, AAG $8$.\n  - Aspartate (Asp): GAU $7$, GAC $9$.\n  - Glutamate (Glu): GAA $10$, GAG $14$.\n\n- Three-fold family ($k=3$, $1$ family):\n  - Isoleucine (Ile): AUU $5$, AUC $8$, AUA $2$.\n\n- Four-fold families ($k=4$, $5$ families):\n  - Proline (Pro): CCU $4$, CCC $6$, CCA $5$, CCG $5$.\n  - Threonine (Thr): ACU $6$, ACC $10$, ACA $4$, ACG $2$.\n  - Alanine (Ala): GCU $8$, GCC $12$, GCA $7$, GCG $3$.\n  - Valine (Val): GUU $9$, GUC $11$, GUA $5$, GUG $5$.\n  - Glycine (Gly): GGU $7$, GGC $13$, GGA $6$, GGG $4$.\n\n- Six-fold families ($k=6$, $3$ families):\n  - Leucine (Leu): UUA $4$, UUG $6$, CUU $9$, CUC $11$, CUA $5$, CUG $15$.\n  - Arginine (Arg): AGA $5$, AGG $3$, CGU $8$, CGC $12$, CGA $6$, CGG $10$.\n  - Serine (Ser): AGU $4$, AGC $6$, UCU $7$, UCC $9$, UCA $5$, UCG $5$.\n\nTask:\n1. Compute $\\hat{F}_j$ for each family listed above using the unbiased homozygosity estimator.\n2. Compute $F_2$, $F_3$, $F_4$, and $F_6$ as defined.\n3. Compute $\\mathrm{ENC}$ using the formula given.\n4. Report the final $\\mathrm{ENC}$ for this gene as a single unitless number, rounded to four significant figures.\n\nInterpretation requirement (do not include in the final numeric answer): In your solution, briefly explain the theoretical lower and upper bounds of $\\mathrm{ENC}$ under the Standard Genetic Code and what the computed value implies about the strength of codon usage bias in this gene.", "solution": "The problem statement submitted for analysis is deemed valid. It is scientifically grounded in the established principles of molecular evolution and bioinformatics, specifically concerning codon usage bias and its quantification via the Effective Number of Codons (ENC). The problem is well-posed, providing all necessary data—synonymous codon counts—and explicit mathematical definitions for the unbiased homozygosity estimator, $\\hat{F}_j$, the average homozygosities, $F_k$, and the final ENC formula. The data are internally consistent and the task is a direct, verifiable calculation. There are no ambiguities, contradictions, or subjective elements. The problem is thus solvable as stated.\n\nThe solution proceeds systematically as requested. First, the within-family codon homozygosity, $\\hat{F}_j$, is calculated for each amino acid family. Second, these values are averaged across families of the same degeneracy $k$ to obtain $F_2$, $F_3$, $F_4$, and $F_6$. Third, these averages are used to compute the ENC. Finally, an interpretation of the resulting ENC value is provided.\n\nThe formula for the unbiased estimator of within-family homozygosity is:\n$$\n\\hat{F}_j = \\frac{\\sum_{i=1}^{k} n_{j,i}^{2} - n_j}{n_j(n_j - 1)}\n$$\nwhere $n_j$ is the total count of codons for amino acid family $j$, and $n_{j,i}$ are the counts of the $k$ synonymous codons.\n\nStep 1: Calculation of $\\hat{F}_j$ for each amino acid family.\n\nFor two-fold families ($k=2$):\n- Phenylalanine (Phe): Counts $\\{7, 3\\}$, $n_{Phe}=10$. $\\sum n_i^2 = 7^2 + 3^2 = 58$. $\\hat{F}_{Phe} = \\frac{58 - 10}{10(9)} = \\frac{48}{90} \\approx 0.53333$.\n- Tyrosine (Tyr): Counts $\\{4, 6\\}$, $n_{Tyr}=10$. $\\sum n_i^2 = 4^2 + 6^2 = 52$. $\\hat{F}_{Tyr} = \\frac{52 - 10}{10(9)} = \\frac{42}{90} \\approx 0.46667$.\n- Cysteine (Cys): Counts $\\{2, 3\\}$, $n_{Cys}=5$. $\\sum n_i^2 = 2^2 + 3^2 = 13$. $\\hat{F}_{Cys} = \\frac{13 - 5}{5(4)} = \\frac{8}{20} = 0.40000$.\n- Histidine (His): Counts $\\{5, 5\\}$, $n_{His}=10$. $\\sum n_i^2 = 5^2 + 5^2 = 50$. $\\hat{F}_{His} = \\frac{50 - 10}{10(9)} = \\frac{40}{90} \\approx 0.44444$.\n- Glutamine (Gln): Counts $\\{6, 9\\}$, $n_{Gln}=15$. $\\sum n_i^2 = 6^2 + 9^2 = 117$. $\\hat{F}_{Gln} = \\frac{117 - 15}{15(14)} = \\frac{102}{210} \\approx 0.48571$.\n- Asparagine (Asn): Counts $\\{3, 5\\}$, $n_{Asn}=8$. $\\sum n_i^2 = 3^2 + 5^2 = 34$. $\\hat{F}_{Asn} = \\frac{34 - 8}{8(7)} = \\frac{26}{56} \\approx 0.46429$.\n- Lysine (Lys): Counts $\\{12, 8\\}$, $n_{Lys}=20$. $\\sum n_i^2 = 12^2 + 8^2 = 208$. $\\hat{F}_{Lys} = \\frac{208 - 20}{20(19)} = \\frac{188}{380} \\approx 0.49474$.\n- Aspartate (Asp): Counts $\\{7, 9\\}$, $n_{Asp}=16$. $\\sum n_i^2 = 7^2 + 9^2 = 130$. $\\hat{F}_{Asp} = \\frac{130 - 16}{16(15)} = \\frac{114}{240} = 0.47500$.\n- Glutamate (Glu): Counts $\\{10, 14\\}$, $n_{Glu}=24$. $\\sum n_i^2 = 10^2 + 14^2 = 296$. $\\hat{F}_{Glu} = \\frac{296 - 24}{24(23)} = \\frac{272}{552} \\approx 0.49275$.\n\nFor the three-fold family ($k=3$):\n- Isoleucine (Ile): Counts $\\{5, 8, 2\\}$, $n_{Ile}=15$. $\\sum n_i^2 = 5^2 + 8^2 + 2^2 = 93$. $\\hat{F}_{Ile} = \\frac{93 - 15}{15(14)} = \\frac{78}{210} \\approx 0.37143$.\n\nFor four-fold families ($k=4$):\n- Proline (Pro): Counts $\\{4, 6, 5, 5\\}$, $n_{Pro}=20$. $\\sum n_i^2 = 4^2+6^2+5^2+5^2=102$. $\\hat{F}_{Pro} = \\frac{102 - 20}{20(19)} = \\frac{82}{380} \\approx 0.21579$.\n- Threonine (Thr): Counts $\\{6, 10, 4, 2\\}$, $n_{Thr}=22$. $\\sum n_i^2 = 6^2+10^2+4^2+2^2=156$. $\\hat{F}_{Thr} = \\frac{156 - 22}{22(21)} = \\frac{134}{462} \\approx 0.29004$.\n- Alanine (Ala): Counts $\\{8, 12, 7, 3\\}$, $n_{Ala}=30$. $\\sum n_i^2 = 8^2+12^2+7^2+3^2=266$. $\\hat{F}_{Ala} = \\frac{266 - 30}{30(29)} = \\frac{236}{870} \\approx 0.27126$.\n- Valine (Val): Counts $\\{9, 11, 5, 5\\}$, $n_{Val}=30$. $\\sum n_i^2 = 9^2+11^2+5^2+5^2=252$. $\\hat{F}_{Val} = \\frac{252 - 30}{30(29)} = \\frac{222}{870} \\approx 0.25517$.\n- Glycine (Gly): Counts $\\{7, 13, 6, 4\\}$, $n_{Gly}=30$. $\\sum n_i^2 = 7^2+13^2+6^2+4^2=270$. $\\hat{F}_{Gly} = \\frac{270 - 30}{30(29)} = \\frac{240}{870} \\approx 0.27586$.\n\nFor six-fold families ($k=6$):\n- Leucine (Leu): Counts $\\{4, 6, 9, 11, 5, 15\\}$, $n_{Leu}=50$. $\\sum n_i^2 = 4^2+6^2+9^2+11^2+5^2+15^2=504$. $\\hat{F}_{Leu} = \\frac{504 - 50}{50(49)} = \\frac{454}{2450} \\approx 0.18531$.\n- Arginine (Arg): Counts $\\{5, 3, 8, 12, 6, 10\\}$, $n_{Arg}=44$. $\\sum n_i^2 = 5^2+3^2+8^2+12^2+6^2+10^2=378$. $\\hat{F}_{Arg} = \\frac{378 - 44}{44(43)} = \\frac{334}{1892} \\approx 0.17653$.\n- Serine (Ser): Counts $\\{4, 6, 7, 9, 5, 5\\}$, $n_{Ser}=36$. $\\sum n_i^2 = 4^2+6^2+7^2+9^2+5^2+5^2=232$. $\\hat{F}_{Ser} = \\frac{232 - 36}{36(35)} = \\frac{196}{1260} \\approx 0.15556$.\n\nStep 2: Calculation of $F_k$.\n\n$F_k$ is the arithmetic mean of $\\hat{F}_j$ over the families of degeneracy $k$.\n- $F_2 = \\frac{1}{9} (0.53333 + 0.46667 + 0.40000 + 0.44444 + 0.48571 + 0.46429 + 0.49474 + 0.47500 + 0.49275) = \\frac{4.25693}{9} \\approx 0.47299$.\n- $F_3 = \\hat{F}_{Ile} \\approx 0.37143$. There is only one $3$-fold family.\n- $F_4 = \\frac{1}{5} (0.21579 + 0.29004 + 0.27126 + 0.25517 + 0.27586) = \\frac{1.30812}{5} \\approx 0.26162$.\n- $F_6 = \\frac{1}{3} (0.18531 + 0.17653 + 0.15556) = \\frac{0.51740}{3} \\approx 0.17247$.\n\nStep 3: Calculation of ENC.\n\nThe ENC is calculated using the formula:\n$$\n\\mathrm{ENC} = 2 + \\frac{9}{F_2} + \\frac{1}{F_3} + \\frac{5}{F_4} + \\frac{3}{F_6}\n$$\nSubstituting the calculated values for $F_k$:\n$$\n\\mathrm{ENC} \\approx 2 + \\frac{9}{0.47299} + \\frac{1}{0.37143} + \\frac{5}{0.26162} + \\frac{3}{0.17247}\n$$\n$$\n\\mathrm{ENC} \\approx 2 + 19.02789 + 2.69230 + 19.11161 + 17.39433\n$$\n$$\n\\mathrm{ENC} \\approx 60.22613\n$$\n\nStep 4: Interpretation of the ENC value.\n\nThe ENC measures the extent of codon usage bias, ranging from a theoretical minimum of $20$ to a maximum of $61$.\n- An ENC value of $20$ signifies extreme bias, where only one codon is used for each of the $20$ amino acids. This corresponds to the case where homozygosity $F_k \\approx 1$ for all $k$. For such a case, $\\mathrm{ENC} = 2 + 9/1 + 1/1 + 5/1 + 3/1 = 20$.\n- An ENC value of $61$ signifies no bias, where all synonymous codons for each amino acid are used with equal frequency. This corresponds to the case where homozygosity $F_k \\approx 1/k$ for each degeneracy class $k$. For such a case, $\\mathrm{ENC} = 2 + 9/(1/2) + 1/(1/3) + 5/(1/4) + 3/(1/6) = 2 + 18 + 3 + 20 + 18 = 61$. The value $61$ is the total number of sense codons in the Standard Genetic Code ($64$ total codons minus $3$ stop codons).\n\nThe calculated value for this gene is $\\mathrm{ENC} \\approx 60.23$. This is exceptionally close to the theoretical maximum of $61$. This result indicates that there is extremely weak codon usage bias in this gene. The different synonymous codons for each amino acid are used almost equally, with very little preference for any particular codon. Such low bias is often observed in genes that are not highly expressed or in organisms where translational selection is weak.\n\nRounding the final numerical result to four significant figures gives $60.23$.", "answer": "$$\n\\boxed{60.23}\n$$", "id": "2697530"}, {"introduction": "Measuring codon usage bias is only the first step; the next is to understand its functional consequences. Synonymous codon changes can simultaneously alter both the efficiency of translation elongation (via tRNA availability) and the stability of mRNA secondary structure, potentially affecting translation initiation. This computational exercise [@problem_id:2697501] challenges you to build a pipeline that models these two distinct effects, demonstrating how recoding a gene for 'optimal' codons might inadvertently hinder translation by creating a more stable, inhibitory structure near the start of the gene.", "problem": "A coding DNA sequence is translated into a protein according to the Central Dogma of molecular biology, and multiple codons can encode the same amino acid (synonymous codons). In many organisms, synonymous codons are not used equally often, a phenomenon known as codon usage bias. Two widely tested biological observations form the foundational base for this problem: (i) messenger ribonucleic acid (mRNA) secondary structure near the five-prime ($5'$) end can modulate translation initiation, and (ii) codon usage bias, often modeled through relative adaptiveness weights, influences translation elongation via transfer ribonucleic acid (tRNA) availability. Your task is to formalize these ideas into a computational pipeline that, given a coding sequence, performs a synonymous recoding and computes the change in a simplified minimum free energy (MFE) model for the $5'$ end and the change in a codon adaptation index (CAI), then infers potential impacts on initiation and elongation.\n\nYou must implement the following, starting only from the core definitions and the rules below, without using any shortcut formulas beyond what is explicitly specified.\n\nDefinitions and rules to use:\n- Let the input coding DNA sequence be a string $S$ over the alphabet $\\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T} \\}$ of length $3n$ for some integer $n \\geq 1$, where each triplet is a codon. Assume the first codon is the canonical start codon $\\mathrm{ATG}$.\n- Define a host codon preference model by assigning to each sense codon $c$ a raw preference $r(c)$ derived from its guanine-cytosine (GC) content: let $\\mathrm{GC}(c)$ be the count of $\\mathrm{G}$ or $\\mathrm{C}$ nucleotides in $c$, and let\n$$\nr(c) \\equiv \\exp\\!\\big(\\beta \\, \\mathrm{GC}(c)\\big),\n$$\nwith $\\beta = \\ln(2)$.\n- For each amino acid $a$, let $\\mathcal{C}(a)$ be its set of synonymous codons. Define the within-family normalized weight\n$$\nw(c) \\equiv \\frac{r(c)}{\\max_{c' \\in \\mathcal{C}(a)} r(c')}, \\quad c \\in \\mathcal{C}(a).\n$$\nBy construction, $w(c) \\in (0,1]$ and the most GC-rich synonymous codon(s) for $a$ have $w(c)=1$.\n- Define the codon adaptation index (CAI) for a coding sequence $S$ with codons $(c_1,\\dots,c_n)$ as the geometric mean of $w(c_i)$:\n$$\n\\mathrm{CAI}(S) \\equiv \\left( \\prod_{i=1}^n w(c_i) \\right)^{1/n}.\n$$\n- Define a synonymous recoding operation on $S$ parameterized by a directive $d \\in \\{\\text{optimize},\\ \\text{deoptimize}\\}$ that produces a recoded sequence $S^{(d)}$ by replacing, for each amino acid $a$, each codon $c \\in \\mathcal{C}(a)$ by:\n  - if $d=\\text{optimize}$, a synonymous codon $c^\\star \\in \\arg\\max_{c' \\in \\mathcal{C}(a)} w(c')$;\n  - if $d=\\text{deoptimize}$, a synonymous codon $c_\\star \\in \\arg\\min_{c' \\in \\mathcal{C}(a)} w(c')$.\n  The start codon $\\mathrm{ATG}$ must be preserved unchanged. Single-codon amino acids (methionine and tryptophan) are unchanged by either directive.\n- Define a simplified RNA folding energy model for the $5'$ window as follows. Let $L \\geq 1$ be a window length in nucleotides. Consider the first $L$ nucleotides of the coding region (truncate if $L$ exceeds the sequence length). Convert thymine to uracil ($\\mathrm{T} \\mapsto \\mathrm{U}$) and compute an approximate minimum free energy $\\mathrm{MFE}(X_{1:L})$ using a nearest-neighbor-free dynamic programming model with base-pair energies:\n  - Watson–Crick pairs: $\\mathrm{A}\\!-\\!\\mathrm{U}$ and $\\mathrm{U}\\!-\\!\\mathrm{A}$ contribute $-2.0$ $\\mathrm{kcal/mol}$; $\\mathrm{G}\\!-\\!\\mathrm{C}$ and $\\mathrm{C}\\!-\\!\\mathrm{G}$ contribute $-3.0$ $\\mathrm{kcal/mol}$.\n  - Wobble pairs: $\\mathrm{G}\\!-\\!\\mathrm{U}$ and $\\mathrm{U}\\!-\\!\\mathrm{G}$ contribute $-1.0$ $\\mathrm{kcal/mol}$.\n  - Hairpin minimum loop length constraint: a base pair between positions $i$ and $j$ is only allowed if $j - i - 1 \\geq m$, with $m=3$.\n  - No additional loop initiation penalties or stacking bonuses are to be used. The total energy is the sum of the selected base-pair energies. The dynamic programming must find the minimum (most negative) energy over all valid non-crossing pairings subject to the loop-length constraint.\n- For any pair of sequences $S$ and $S^{(d)}$, define the MFE change for the $5'$ window of length $L$ as\n$$\n\\Delta \\mathrm{MFE} \\equiv \\mathrm{MFE}\\big(S^{(d)}_{1:L}\\big) - \\mathrm{MFE}\\big(S_{1:L}\\big),\n$$\nin $\\mathrm{kcal/mol}$, and the CAI change as\n$$\n\\Delta \\mathrm{CAI} \\equiv \\mathrm{CAI}\\big(S^{(d)}\\big) - \\mathrm{CAI}\\big(S\\big).\n$$\n- Infer potential impacts using the following thresholds:\n  - Initiation impact threshold $\\tau = 1.0$ $\\mathrm{kcal/mol}$. If $\\Delta \\mathrm{MFE} \\leq -\\tau$, predict initiation becomes more hindered (boolean $\\mathrm{True}$), else $\\mathrm{False}$.\n  - Elongation impact threshold $\\epsilon = 0.005$ (dimensionless). If $\\Delta \\mathrm{CAI} \\leq -\\epsilon$, predict elongation slows (boolean $\\mathrm{True}$), else $\\mathrm{False}$.\n\nInput test suite:\nProvide a program that solves the following four cases exactly as specified.\n- Case $1$: $S_1 =$ \"ATGAAA AATGGT TCTGCT GTACCT ACTGAA GATCAA CTGATT TATCAT\" (spaces added for readability only; the actual sequence has no spaces), with directive $d_1 = \\text{optimize}$ and window $L_1 = 45$ nucleotides.\n- Case $2$: $S_2 =$ \"ATGGCC CGCCCC GGCGTG ACCTCC CTGCAG GAGAAC AAGATC TACCAC\", with directive $d_2 = \\text{deoptimize}$ and window $L_2 = 60$ nucleotides.\n- Case $3$: $S_3 =$ \"ATG\", with directive $d_3 = \\text{optimize}$ and window $L_3 = 30$ nucleotides.\n- Case $4$: $S_4 =$ \"ATGATA AGATTA GAAAAA TTTCAA CTAGAT TGTTAT GGACTA AAATTA\", with directive $d_4 = \\text{deoptimize}$ and window $L_4 = 54$ nucleotides.\n\nIn all cases, interpret the sequences as contiguous strings of nucleotides without spaces; spaces in the display above delimit codons for human readability. All energies must be computed and reported in $\\mathrm{kcal/mol}$. All angles are irrelevant. Any fractional answers must be expressed as decimal numbers rather than percentages.\n\nRequired outputs:\n- For each case $i \\in \\{1,2,3,4\\}$, compute the list\n$$\nR_i \\equiv \\big[ \\Delta \\mathrm{MFE}_i,\\ \\Delta \\mathrm{CAI}_i,\\ \\mathrm{initiation\\_hindered}_i,\\ \\mathrm{elongation\\_slowed}_i \\big],\n$$\nwhere the first two entries are floats and the last two are booleans.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, with each $R_i$ itself enclosed in square brackets, and the two floats in each $R_i$ rounded to $6$ decimal places. For example, a syntactically correct output with placeholder numbers and booleans would look like \"[[0.000000,0.000000,False,False],[...],...]\". The actual numbers and booleans must be those computed by your implementation, not placeholders.\n\nScientific realism and constraints:\n- Use only the specified definitions and constants: $\\beta=\\ln(2)$, base-pair energies $-3.0$, $-2.0$, $-1.0$ $\\mathrm{kcal/mol}$ as specified, minimum loop length $m=3$, thresholds $\\tau=1.0$ $\\mathrm{kcal/mol}$ and $\\epsilon=0.005$.\n- Do not import any external data; all necessary mappings for the standard genetic code (sense codons only) must be encoded within your program.", "solution": "The problem requires the development of a computational pipeline to analyze the effects of synonymous recoding of a coding DNA sequence, $S$, on two key aspects of protein translation: initiation and elongation. This analysis is based on simplified models of messenger RNA (mRNA) secondary structure stability and codon usage bias. The solution involves a multi-step process: first, establishing the necessary biomolecular data and models; second, implementing algorithms for sequence recoding, Codon Adaptation Index (CAI) calculation, and Minimum Free Energy (MFE) estimation; and finally, integrating these components to compute the specified changes and draw inferences.\n\nThe process begins by formalizing the provided rules and definitions.\n\n**1. Codon Preference Model and Codon Adaptation Index (CAI)**\n\nThe biological phenomenon of codon usage bias is modeled through a codon preference system based on Guanine-Cytosine (GC) content.\n\n-   **Genetic Code**: The standard genetic code defines the mapping from $61$ sense codons to $20$ amino acids. This information must be encoded, including the set of synonymous codons $\\mathcal{C}(a)$ for each amino acid $a$.\n-   **Codon Weights**: For each codon $c$, a raw preference $r(c)$ is calculated as $r(c) = \\exp(\\beta \\cdot \\mathrm{GC}(c))$, where $\\mathrm{GC}(c)$ is the count of 'G' or 'C' nucleotides in the codon and $\\beta = \\ln(2)$. This simplifies to $r(c) = 2^{\\mathrm{GC}(c)}$. The normalized weight, $w(c)$, for a codon $c \\in \\mathcal{C}(a)$ is defined relative to the most preferred synonymous codon for that amino acid:\n    $$\n    w(c) = \\frac{r(c)}{\\max_{c' \\in \\mathcal{C}(a)} r(c')}\n    $$\n    By this definition, $w(c)$ is maximized for codons with the highest GC content within their synonymous family.\n-   **CAI Calculation**: The Codon Adaptation Index (CAI) for a sequence $S$ of $n$ codons $(c_1, c_2, \\dots, c_n)$ is the geometric mean of their weights:\n    $$\n    \\mathrm{CAI}(S) \\equiv \\left( \\prod_{i=1}^n w(c_i) \\right)^{1/n}\n    $$\n    For numerical stability, this is computed using logarithms: $\\mathrm{CAI}(S) = \\exp\\left(\\frac{1}{n} \\sum_{i=1}^n \\ln(w(c_i))\\right)$.\n\n**2. Synonymous Recoding**\n\nThe synonymous recoding operation modifies the input sequence $S$ to produce a new sequence $S^{(d)}$ based on a directive $d \\in \\{\\text{optimize}, \\text{deoptimize}\\}$. For each codon in $S$, it is replaced by a synonymous codon that either maximizes (optimize) or minimizes (deoptimize) the weight $w(c)$. Since $w(c)$ is a monotonic function of $\\mathrm{GC}(c)$, this is equivalent to selecting the synonymous codon with the highest or lowest GC content, respectively. In cases of ties (multiple codons having the same GC content), a deterministic tie-breaking rule, such as choosing the alphabetically first codon, is applied to ensure a unique result. The start codon $\\mathrm{ATG}$ and codons for single-codon amino acids (Methionine and Tryptophan) remain unchanged.\n\n**3. Minimum Free Energy (MFE) of RNA Secondary Structure**\n\nThe stability of the mRNA secondary structure at the $5'$ end, which influences translation initiation, is estimated using a simplified MFE model. This model applies to the first $L$ nucleotides of the sequence (converted from DNA to RNA, i.e., $\\mathrm{T} \\to \\mathrm{U}$). The MFE is the minimum possible energy over all valid, non-crossing secondary structures (collections of base pairs). The total energy is the sum of contributions from individual base pairs, with no other energetic terms. The specified pairing energies are: $\\mathrm{G-C}$ ($ -3.0 \\ \\mathrm{kcal/mol}$), $\\mathrm{A-U}$ ($ -2.0 \\ \\mathrm{kcal/mol}$), and $\\mathrm{G-U}$ wobble ($ -1.0 \\ \\mathrm{kcal/mol}$). A structural constraint is imposed: a hairpin loop must contain at least $m=3$ unpaired nucleotides, meaning a pair between bases at positions $i$ and $j$ is allowed only if $j - i - 1 \\ge 3$, or $j \\ge i+4$.\n\nThis problem is solved using a standard dynamic programming algorithm, often attributed to Zuker and Stiegler. Let $W(i, j)$ be the MFE for the subsequence from index $i$ to $j$. The value of $W(i, j)$ is determined by considering two possibilities for the base at position $i$: it is either unpaired, or it forms a pair with a base at some position $k$. This leads to the following recurrence relation:\n$$\nW(i, j) = \\min \\left( W(i+1, j), \\quad \\min_{k = i+m+1}^{j} \\left( E_{\\text{pair}}(X_i, X_k) + W(i+1, k-1) + W(k+1, j) \\right) \\right)\n$$\nwhere $E_{\\text{pair}}(X_i, X_k)$ is the energy of the pair $(X_i, X_k)$, which is non-zero only for the allowed Watson-Crick and wobble pairs. The term $W(i+1, j)$ corresponds to base $i$ being unpaired. The term with the inner minimum considers all possible partners $k$ for base $i$, subject to the minimum loop length constraint. The energy of such a structure is the sum of the pair energy and the MFEs of the resulting independent subproblems: the region enclosed by the pair, $W(i+1, k-1)$, and the region outside the pair, $W(k+1, j)$. The base case is $W(i, j) = 0$ if $j < i+m+1$, as no valid pair can be formed. The MFE of the entire sequence of length $N$ is $W(0, N-1)$. This recurrence can be implemented either iteratively by filling a DP table or recursively with memoization.\n\n**4. Final Analysis**\n\nFor each test case, the following steps are executed:\n1.  Parse the input sequence $S$, directive $d$, and window length $L$.\n2.  Calculate the CAI of the original sequence, $\\mathrm{CAI}(S)$.\n3.  Extract the $5'$ window $S_{1:L}$ and compute its MFE, $\\mathrm{MFE}(S_{1:L})$.\n4.  Perform synonymous recoding to obtain $S^{(d)}$.\n5.  Calculate the CAI of the recoded sequence, $\\mathrm{CAI}(S^{(d)})$.\n6.  Extract the $5'$ window of the recoded sequence, $S^{(d)}_{1:L}$, and compute its MFE, $\\mathrm{MFE}(S^{(d)}_{1:L})$.\n7.  Compute the changes: $\\Delta \\mathrm{MFE} = \\mathrm{MFE}(S^{(d)}_{1:L}) - \\mathrm{MFE}(S_{1:L})$ and $\\Delta \\mathrm{CAI} = \\mathrm{CAI}(S^{(d)}) - \\mathrm{CAI}(S)$.\n8.  Apply the given thresholds to determine the boolean outcomes:\n    -   `initiation_hindered` is $\\mathrm{True}$ if $\\Delta \\mathrm{MFE} \\leq -1.0$.\n    -   `elongation_slowed` is $\\mathrm{True}$ if $\\Delta \\mathrm{CAI} \\leq -0.005$.\nThe final results for all cases are then formatted into a single list as specified.", "answer": "[[-6.000000,0.306067,True,False],[0.000000,-0.490702,False,True],[0.000000,0.000000,False,False],[-2.000000,-0.158145,True,True]]", "id": "2697501"}]}