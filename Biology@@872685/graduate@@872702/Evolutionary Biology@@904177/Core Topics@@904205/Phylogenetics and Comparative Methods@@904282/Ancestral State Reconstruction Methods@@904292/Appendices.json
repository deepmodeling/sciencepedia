{"hands_on_practices": [{"introduction": "Understanding ancestral state reconstruction often begins with the principle of parsimony, which favors the evolutionary history requiring the fewest changes. This exercise guides you through Fitch's classic algorithm, a fundamental method for calculating the minimum number of character state changes on a phylogeny for an unordered character. By working through this problem [@problem_id:2691502], you will gain a practical understanding of the two-pass procedure used to identify the most parsimonious scenario.", "problem": "You are given a fully bifurcating rooted phylogeny in Newick form $((A,B),(C,D))$ and a single binary morphological character with observed tip states $A=0$, $B=1$, $C=1$, and $D=1$. Using the criterion of Maximum Parsimony (MP), specifically the Fitch parsimony method for unordered binary characters, determine the sets of possible ancestral states at each internal node and compute the minimum number of state changes required over the tree. Provide the minimum number of changes as your final numeric answer. Do not assume any transition bias or rate heterogeneity. No rounding is required.", "solution": "The supplied problem is scientifically grounded, well-posed, and objective. All necessary data for a solution are provided, and the problem asks for the application of a standard, well-defined algorithm in evolutionary biology. Therefore, the problem is valid and a solution will be provided.\n\nThe objective is to apply the Fitch maximum parsimony algorithm to determine the minimum number of state changes for a binary character on a given phylogeny. The phylogeny is $((A,B),(C,D))$, and the character states at the tips are $A=0$, $B=1$, $C=1$, and $D=1$.\n\nFirst, we must define the topology and label the nodes consistently. Let the tips be $A$, $B$, $C$, and $D$. Let the internal node that is the most recent common ancestor of $A$ and $B$ be $N_1$. Let the internal node that is the most recent common ancestor of $C$ and $D$ be $N_2$. The root of the tree, which is the most recent common ancestor of $N_1$ and $N_2$, will be denoted $N_R$. The state of any node $k$ is represented by a set of possible character states, $S_k$.\n\nThe given tip states are:\n$$S_A = \\{0\\}$$\n$$S_B = \\{1\\}$$\n$$S_C = \\{1\\}$$\n$$S_D = \\{1\\}$$\n\nThe Fitch algorithm proceeds in two phases. Phase $1$ is a bottom-up pass from the tips to the root, which determines the preliminary state sets for all internal nodes and calculates the total parsimony score (the minimum number of changes). Phase $2$ is a top-down pass from the root to the tips, which resolves any ambiguities in the state sets to delineate the set of most parsimonious reconstructions (MPRs).\n\n**Phase 1: Bottom-up Pass**\n\nThe rule for determining the state set $S_k$ of an ancestral node $k$ with two immediate descendants $i$ and $j$ is as follows:\n1. If the intersection of the descendant state sets is non-empty, $S_i \\cap S_j \\neq \\emptyset$, then $S_k = S_i \\cap S_j$. The number of changes on this branch is $0$.\n2. If the intersection of the descendant state sets is empty, $S_i \\cap S_j = \\emptyset$, then $S_k = S_i \\cup S_j$. The number of changes on this branch is $1$.\n\nThe total parsimony score is the sum of changes over all internal nodes.\n\nLet $L$ be the total number of changes. Initially, $L=0$.\n\nWe proceed from the tip-ward nodes upwards to the root.\n\n**Step 1: Determine the state set for node $N_1$.**\nNode $N_1$ is the parent of nodes $A$ and $B$.\nThe state sets are $S_A = \\{0\\}$ and $S_B = \\{1\\}$.\nThe intersection is $S_A \\cap S_B = \\{0\\} \\cap \\{1\\} = \\emptyset$.\nSince the intersection is empty, we use the union rule. The state set for $N_1$ is $S_{N_1} = S_A \\cup S_B = \\{0, 1\\}$.\nThis signifies a required character state change. We increment the total score: $L = L + 1 = 1$.\n\n**Step 2: Determine the state set for node $N_2$.**\nNode $N_2$ is the parent of nodes $C$ and $D$.\nThe state sets are $S_C = \\{1\\}$ and $S_D = \\{1\\}$.\nThe intersection is $S_C \\cap S_D = \\{1\\} \\cap \\{1\\} = \\{1\\}$.\nSince the intersection is non-empty, we use the intersection rule. The state set for $N_2$ is $S_{N_2} = S_C \\cap S_D = \\{1\\}$.\nNo change is required. The score remains $L=1$.\n\n**Step 3: Determine the state set for the root node $N_R$.**\nNode $N_R$ is the parent of nodes $N_1$ and $N_2$.\nThe state sets are $S_{N_1} = \\{0, 1\\}$ and $S_{N_2} = \\{1\\}$.\nThe intersection is $S_{N_1} \\cap S_{N_2} = \\{0, 1\\} \\cap \\{1\\} = \\{1\\}$.\nSince the intersection is non-empty, we use the intersection rule. The state set for $N_R$ is $S_{N_R} = S_{N_1} \\cap S_{N_2} = \\{1\\}$.\nNo change is required. The score remains $L=1$.\n\nThe bottom-up pass is complete. The minimum number of state changes required over the entire tree is $L=1$.\n\n_For completeness, we discuss the sets of possible ancestral states._\nThe preliminary state sets are $S_{N_1} = \\{0, 1\\}$, $S_{N_2} = \\{1\\}$, and $S_{N_R} = \\{1\\}$. The state set for node $N_1$ is ambiguous. To determine the actual set of possible states that can exist at each node in any most parsimonious reconstruction (MPR), we must ensure that any assignment is consistent with the total minimum score of $L=1$.\n\nThe state of the root $N_R$ is unambiguously $\\{1\\}$. The state of node $N_2$ is unambiguously $\\{1\\}$.\nWe must check the ambiguity at node $N_1$. Its preliminary set is $\\{0, 1\\}$.\n- If we assign state $1$ to node $N_1$: The state change occurs on the branch leading to taxon $A$ ($1 \\to 0$). All other branches have no change ($N_R(1) \\to N_1(1)$, $N_1(1) \\to B(1)$, $N_R(1) \\to N_2(1)$, etc.). The total number of changes is $1$. This reconstruction is a most parsimonious one.\n- If we assign state $0$ to node $N_1$: A state change occurs on the branch leading to taxon $B$ ($0 \\to 1$). Additionally, since the state of the root $N_R$ must be $1$, a change must also occur on the branch connecting $N_R$ to $N_1$ ($1 \\to 0$). This reconstruction requires $2$ changes. Since $2 > 1$, this is not a most parsimonious reconstruction.\n\nTherefore, there is only one Most Parsimonious Reconstruction. In this reconstruction, the state of $N_1$ must be $1$. The sets of possible ancestral states at the internal nodes are:\n- Node $N_1$: $\\{1\\}$\n- Node $N_2$: $\\{1\\}$\n- Root Node $N_R$: $\\{1\\}$\nThe single evolutionary event is a change from state $1$ to state $0$ on the branch leading to taxon $A$.\n\nThe question, however, asks for the minimum number of state changes required, which was calculated during the first phase of the Fitch algorithm.\n\nThe final result is the parsimony score $L$.", "answer": "$$\\boxed{1}$$", "id": "2691502"}, {"introduction": "While Fitch's algorithm is powerful, many biological characters have more than two states or involve transitions that are not equally likely. The Sankoff algorithm provides a more general dynamic programming framework to address this complexity, allowing for user-defined costs between states. This practice [@problem_id:2691545] challenges you to apply this method to an ordered, multistate character, using an explicit cost matrix to compute the minimal parsimony score.", "problem": "In a discrete ancestral state reconstruction problem for an ordered multistate character, the total parsimony score is defined as the sum over all edges of the transition costs between the states at the incident nodes. Consider a rooted binary tree with topology $\\bigl((A,B),(C,D)\\bigr)$ and a single character that takes values in the ordered set $\\{0,1,2\\}$. The tip observations are $A=0$, $B=2$, $C=2$, and $D=1$. The transition cost between any two states $i$ and $j$ is additive and given by $C_{ij}=|i-j|$. Using the Sankoff dynamic programming approach to parsimony, compute the minimal total parsimony score and the optimal state at the root. If there are multiple optimal root states, report the smallest state value. Express your final answer as a two-entry row matrix containing first the minimal score and second the optimal root state. No rounding is needed, and the answer should be exact integers without units.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard application of the Sankoff algorithm for ancestral state reconstruction under the parsimony criterion, a fundamental technique in computational phylogenetics. All necessary information—the tree topology, character states at the tips, and the transition cost function—is provided, and no contradictions exist. The problem is therefore deemed valid and a formal solution may proceed.\n\nThe objective is to find the minimum parsimony score for a given character on a phylogenetic tree and determine the optimal state at the root. We will employ the Sankoff dynamic programming algorithm, which operates in a post-order traversal (from tips to root) to compute cost vectors for each node.\n\nLet the rooted binary tree be denoted by $T$. The internal nodes are the root, $R$, and its two children, $N_1$ and $N_2$. The node $N_1$ is the parent of tips $A$ and $B$, and $N_2$ is the parent of tips $C$ and $D$. The tree topology is $\\bigl((A,B),(C,D)\\bigr)$.\nThe character can take states from the ordered set $S = \\{0, 1, 2\\}$.\nThe observed states at the tips are: $s_A = 0$, $s_B = 2$, $s_C = 2$, and $s_D = 1$.\nThe transition cost between any two states $i$ and $j$ in $S$ is given by the additive cost function $C_{ij} = |i-j|$.\n\nThe Sankoff algorithm calculates, for each node $k$ in the tree and each possible state $s \\in S$, a score $S_k(s)$ representing the minimum parsimony cost for the subtree rooted at $k$, given that node $k$ is in state $s$. The calculation proceeds from the tips towards the root.\n\nFor a tip node $u$ with observed state $s_u$, the initial score vector $S_u$ is defined such that $S_u(s_u) = 0$ and $S_u(s) = \\infty$ for all $s \\neq s_u$. This reflects that the observed state has a cost of $0$ to explain itself, while any other state is impossible.\nThe initial score vectors for the tips are:\n- $S_A = (0, \\infty, \\infty)$ for states $\\{0, 1, 2\\}$.\n- $S_B = (\\infty, \\infty, 0)$ for states $\\{0, 1, 2\\}$.\n- $S_C = (\\infty, \\infty, 0)$ for states $\\{0, 1, 2\\}$.\n- $S_D = (\\infty, 0, \\infty)$ for states $\\{0, 1, 2\\}$.\n\nFor an internal node $k$ with children $i$ and $j$, the score $S_k(s)$ for a state $s \\in S$ is computed by summing the minimum costs from its children:\n$$S_k(s) = \\min_{s_i \\in S} \\bigl(C_{s,s_i} + S_i(s_i)\\bigr) + \\min_{s_j \\in S} \\bigl(C_{s,s_j} + S_j(s_j)\\bigr)$$\n\nWe now compute the score vectors for the internal nodes $N_1$ and $N_2$.\n\nFor internal node $N_1$ (parent of $A$ and $B$):\n$S_{N_1}(s) = \\min_{s_A \\in S} \\bigl(C_{s,s_A} + S_A(s_A)\\bigr) + \\min_{s_B \\in S} \\bigl(C_{s,s_B} + S_B(s_B)\\bigr)$\nGiven the initial scores for $A$ and $B$, the minimizations select $s_A=0$ and $s_B=2$.\n$S_{N_1}(s) = \\bigl(C_{s,0} + S_A(0)\\bigr) + \\bigl(C_{s,2} + S_B(2)\\bigr) = |s-0| + 0 + |s-2| + 0 = |s| + |s-2|$.\nWe evaluate this for each possible state $s \\in \\{0, 1, 2\\}$:\n- $S_{N_1}(0) = |0| + |0-2| = 0 + 2 = 2$.\n- $S_{N_1}(1) = |1| + |1-2| = 1 + 1 = 2$.\n- $S_{N_1}(2) = |2| + |2-2| = 2 + 0 = 2$.\nThe score vector for node $N_1$ is $S_{N_1} = (2, 2, 2)$.\n\nFor internal node $N_2$ (parent of $C$ and $D$):\n$S_{N_2}(s) = \\min_{s_C \\in S} \\bigl(C_{s,s_C} + S_C(s_C)\\bigr) + \\min_{s_D \\in S} \\bigl(C_{s,s_D} + S_D(s_D)\\bigr)$\nThis simplifies to using $s_C=2$ and $s_D=1$.\n$S_{N_2}(s) = \\bigl(C_{s,2} + S_C(2)\\bigr) + \\bigl(C_{s,1} + S_D(1)\\bigr) = |s-2| + 0 + |s-1| + 0 = |s-2| + |s-1|$.\nWe evaluate this for each state $s \\in \\{0, 1, 2\\}$:\n- $S_{N_2}(0) = |0-2| + |0-1| = 2 + 1 = 3$.\n- $S_{N_2}(1) = |1-2| + |1-1| = 1 + 0 = 1$.\n- $S_{N_2}(2) = |2-2| + |2-1| = 0 + 1 = 1$.\nThe score vector for node $N_2$ is $S_{N_2} = (3, 1, 1)$.\n\nFinally, we compute the score vector for the root node $R$ (parent of $N_1$ and $N_2$):\n$S_R(s) = \\min_{s_{N_1} \\in S} \\bigl(C_{s,s_{N_1}} + S_{N_1}(s_{N_1})\\bigr) + \\min_{s_{N_2} \\in S} \\bigl(C_{s,s_{N_2}} + S_{N_2}(s_{N_2})\\bigr)$.\n\nLet's compute the two terms separately.\nFirst term, for child $N_1$: $\\min_{s_{N_1} \\in \\{0,1,2\\}} \\bigl(|s-s_{N_1}| + S_{N_1}(s_{N_1})\\bigr)$.\n- For $s=0$: $\\min(|0-0|+2, |0-1|+2, |0-2|+2) = \\min(2, 3, 4) = 2$.\n- For $s=1$: $\\min(|1-0|+2, |1-1|+2, |1-2|+2) = \\min(3, 2, 3) = 2$.\n- For $s=2$: $\\min(|2-0|+2, |2-1|+2, |2-2|+2) = \\min(4, 3, 2) = 2$.\n\nSecond term, for child $N_2$: $\\min_{s_{N_2} \\in \\{0,1,2\\}} \\bigl(|s-s_{N_2}| + S_{N_2}(s_{N_2})\\bigr)$.\n- For $s=0$: $\\min(|0-0|+3, |0-1|+1, |0-2|+1) = \\min(3, 2, 3) = 2$.\n- For $s=1$: $\\min(|1-0|+3, |1-1|+1, |1-2|+1) = \\min(4, 1, 2) = 1$.\n- For $s=2$: $\\min(|2-0|+3, |2-1|+1, |2-2|+1) = \\min(5, 2, 1) = 1$.\n\nNow, we sum the terms to get the score vector $S_R$ for the root:\n- $S_R(0) = 2 + 2 = 4$.\n- $S_R(1) = 2 + 1 = 3$.\n- $S_R(2) = 2 + 1 = 3$.\nThe final score vector for the root is $S_R = (4, 3, 3)$.\n\nThe minimal total parsimony score for the entire tree is the minimum value in the root's score vector:\nMinimal Score $= \\min\\bigl(S_R(0), S_R(1), S_R(2)\\bigr) = \\min(4, 3, 3) = 3$.\n\nThe optimal state(s) for the root are those states that yield this minimal score. In this case, the states are $1$ and $2$, since $S_R(1)=3$ and $S_R(2)=3$. The problem stipulates that if multiple optimal root states exist, the smallest state value must be chosen.\nThe set of optimal states is $\\{1, 2\\}$. The smallest value in this set is $1$.\nThus, the optimal root state to be reported is $1$.\n\nThe final answer is composed of the minimal score followed by the optimal root state.\nMinimal Score: $3$.\nOptimal Root State: $1$.", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 1 \\end{pmatrix}}$$", "id": "2691545"}, {"introduction": "Moving beyond parsimony, probabilistic methods offer a powerful alternative for ancestral state reconstruction by explicitly modeling the evolutionary process. This exercise [@problem_id:2691564] introduces the Maximum Likelihood framework, where you will use a continuous-time Markov model and Felsenstein's pruning algorithm to compute the likelihood of observed data given the model. This hands-on calculation demonstrates how branch lengths and substitution rates are integrated to infer ancestral probabilities, a cornerstone of modern phylogenetic comparative methods.", "problem": "Consider a binary character evolving on a fixed, four-taxon phylogeny with topology $((A,B),(C,D))$. All four pendant branches from internal nodes to the tips have length $0.1$. The internal branch connecting the two internal nodes has length $0.4$, and the root is placed at its midpoint, so that the two branches from the root to each internal node have length $0.2$. The character evolves according to the two-state Markov $k$-state (Mk) model, which in this case is a continuous-time Markov chain (CTMC) on the state space $\\{0,1\\}$ with instantaneous rate matrix\n$$\nQ \\;=\\; \\begin{pmatrix}\n-q & q\\\\\nq & -q\n\\end{pmatrix},\n$$\nwhere $q=2$. The stationary distribution for this symmetric model is $(\\tfrac{1}{2},\\tfrac{1}{2})$. The observed tip states are $A=0$, $B=1$, $C=1$, and $D=1$.\n\nStarting from first principles of CTMCs on trees and the pruning algorithm (dynamic programming over the tree), do the following:\n- Derive the transition probability matrix $P(t)=\\exp(Qt)$ for the two-state symmetric CTMC and express its entries in terms of $q$ and $t$.\n- Using these transition probabilities, compute the conditional likelihood vectors at the two internal nodes immediately ancestral to $(A,B)$ and to $(C,D)$.\n- Propagate these conditional likelihoods to the root using the two branches of length $0.2$ from the root to the internal nodes, and, assuming the stationary prior $(\\tfrac{1}{2},\\tfrac{1}{2})$ at the root, compute the posterior probability that the root is in state $1$ given the data.\n\nReport only the final posterior probability as a decimal rounded to four significant figures. No units are required.", "solution": "The problem is valid as it is scientifically grounded in the principles of continuous-time Markov chains on phylogenetic trees, a standard methodology in computational evolutionary biology. The problem is well-posed, objective, and contains all necessary information to compute a unique solution.\n\nLet the state space of the binary character be $S = \\{0, 1\\}$. The evolution is governed by the instantaneous rate matrix:\n$$\nQ = \\begin{pmatrix} -q & q \\\\ q & -q \\end{pmatrix}\n$$\nwhere the rate parameter is given as $q=2$.\n\nFirst, we derive the transition probability matrix $P(t) = \\exp(Qt)$. The matrix $Q$ can be written as $Q = q \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}$. We find the eigenvalues and eigenvectors of $Q$. The characteristic equation is $\\det(Q - \\lambda I) = 0$:\n$$\n(-q - \\lambda)^2 - q^2 = 0 \\implies \\lambda^2 + 2q\\lambda = 0 \\implies \\lambda(\\lambda + 2q) = 0\n$$\nThe eigenvalues are $\\lambda_1 = 0$ and $\\lambda_2 = -2q$. The corresponding eigenvectors are $v_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and $v_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\nThe matrix of eigenvectors is $V = \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$, and its inverse is $V^{-1} = \\frac{1}{2} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$.\nThe transition matrix is given by $P(t) = V \\exp(Dt) V^{-1}$, where $D$ is the diagonal matrix of eigenvalues:\n$$\nP(t) = \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} \\exp(0 \\cdot t) & 0 \\\\ 0 & \\exp(-2qt) \\end{pmatrix} \\frac{1}{2} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\n$$\nP(t) = \\frac{1}{2} \\begin{pmatrix} 1 & \\exp(-2qt) \\\\ 1 & -\\exp(-2qt) \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 + \\exp(-2qt) & 1 - \\exp(-2qt) \\\\ 1 - \\exp(-2qt) & 1 + \\exp(-2qt) \\end{pmatrix}\n$$\nThe entries of the transition matrix are:\n$P_{00}(t) = P_{11}(t) = \\frac{1}{2}(1 + \\exp(-2qt))$ (probability of staying in the same state over time $t$).\n$P_{01}(t) = P_{10}(t) = \\frac{1}{2}(1 - \\exp(-2qt))$ (probability of changing state over time $t$).\n\nNext, we apply Felsenstein's pruning algorithm. Let the internal node ancestral to tips $A$ and $B$ be $N_{AB}$, and the node ancestral to $C$ and $D$ be $N_{CD}$. The root of the tree is $N_R$. The conditional likelihood vector for a node $u$, $L_u$, is a vector $[L_u(0), L_u(1)]^T$, where $L_u(i)$ is the probability of the observed data in the subtree subtended by $u$, given that $u$ is in state $i$.\n\nFor the tips, the likelihood vectors are determined by the observed states: $A=0, B=1, C=1, D=1$.\n$L_A = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, $L_B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $L_C = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $L_D = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\nThe pendant branch lengths are all $t_p = 0.1$. We compute the conditional likelihoods at node $N_{AB}$:\n$L_{N_{AB}}(i) = \\left( \\sum_{j \\in S} P_{ij}(t_p) L_A(j) \\right) \\times \\left( \\sum_{k \\in S} P_{ik}(t_p) L_B(k) \\right)$.\n$L_{N_{AB}}(0) = (P_{00}(t_p) \\cdot 1 + P_{01}(t_p) \\cdot 0) \\times (P_{00}(t_p) \\cdot 0 + P_{01}(t_p) \\cdot 1) = P_{00}(t_p) P_{01}(t_p)$.\n$L_{N_{AB}}(1) = (P_{10}(t_p) \\cdot 1 + P_{11}(t_p) \\cdot 0) \\times (P_{10}(t_p) \\cdot 0 + P_{11}(t_p) \\cdot 1) = P_{10}(t_p) P_{11}(t_p)$.\nSince $P_{00}=P_{11}$ and $P_{01}=P_{10}$, we have $L_{N_{AB}}(0) = L_{N_{AB}}(1) = P_{00}(t_p) P_{01}(t_p)$.\n\nSimilarly, for node $N_{CD}$:\n$L_{N_{CD}}(i) = \\left( \\sum_{j \\in S} P_{ij}(t_p) L_C(j) \\right) \\times \\left( \\sum_{k \\in S} P_{ik}(t_p) L_D(k) \\right)$.\n$L_{N_{CD}}(0) = (P_{01}(t_p))^2$.\n$L_{N_{CD}}(1) = (P_{11}(t_p))^2$.\n\nNow, we propagate these likelihoods to the root $N_R$. The branches from the root to $N_{AB}$ and $N_{CD}$ both have length $t_r = 0.2$. The conditional likelihood at the root is:\n$L_{N_R}(i) = \\left( \\sum_{j \\in S} P_{ij}(t_r) L_{N_{AB}}(j) \\right) \\times \\left( \\sum_{k \\in S} P_{ik}(t_r) L_{N_{CD}}(k) \\right)$.\n\nFor $i=0$:\n$L_{N_R}(0) = [P_{00}(t_r)L_{N_{AB}}(0) + P_{01}(t_r)L_{N_{AB}}(1)] \\times [P_{00}(t_r)L_{N_{CD}}(0) + P_{01}(t_r)L_{N_{CD}}(1)]$.\nSubstituting $L_{N_{AB}}(0)=L_{N_{AB}}(1)$, the first term becomes $(P_{00}(t_r) + P_{01}(t_r))L_{N_{AB}}(0)$. Since $P_{00}(t_r) + P_{01}(t_r) = 1$, this simplifies to $L_{N_{AB}}(0)$.\n$L_{N_R}(0) = P_{00}(t_p)P_{01}(t_p) \\times [P_{00}(t_r)(P_{01}(t_p))^2 + P_{01}(t_r)(P_{11}(t_p))^2]$.\n\nFor $i=1$:\n$L_{N_R}(1) = [P_{10}(t_r)L_{N_{AB}}(0) + P_{11}(t_r)L_{N_{AB}}(1)] \\times [P_{10}(t_r)L_{N_{CD}}(0) + P_{11}(t_r)L_{N_{CD}}(1)]$.\nThe first term similarly simplifies to $L_{N_{AB}}(1)$.\n$L_{N_R}(1) = P_{10}(t_p)P_{11}(t_p) \\times [P_{10}(t_r)(P_{01}(t_p))^2 + P_{11}(t_r)(P_{11}(t_p))^2]$.\n\nThe total likelihood of the data is $P(D) = \\sum_{i \\in S} \\pi_i L_{N_R}(i)$, where $\\pi = (\\frac{1}{2}, \\frac{1}{2})$ is the stationary distribution at the root. The posterior probability of the root being in state $1$ is:\n$$\nP(\\text{root}=1|D) = \\frac{\\pi_1 L_{N_R}(1)}{\\pi_0 L_{N_R}(0) + \\pi_1 L_{N_R}(1)} = \\frac{L_{N_R}(1)}{L_{N_R}(0) + L_{N_R}(1)}\n$$\nThe common factor $P_{00}(t_p)P_{01}(t_p)$ (since $P_{00}=P_{11}, P_{01}=P_{10}$) cancels from the numerator and denominator. Let $p_s = P_{11}(t_p)$, $p_d = P_{01}(t_p)$, $p'_s = P_{11}(t_r)$, and $p'_d = P_{01}(t_r)$.\n$$\nP(\\text{root}=1|D) = \\frac{p'_d(p_d)^2 + p'_s(p_s)^2}{[p'_s(p_d)^2 + p'_d(p_s)^2] + [p'_d(p_d)^2 + p'_s(p_s)^2]}\n$$\nThe denominator simplifies to $(p'_s+p'_d)(p_d)^2 + (p'_d+p'_s)(p_s)^2 = (p_d)^2 + (p_s)^2$.\n$$\nP(\\text{root}=1|D) = \\frac{p'_d(p_d)^2 + p'_s(p_s)^2}{(p_d)^2 + (p_s)^2}\n$$\nWe have $q=2$. For $t_p=0.1$, $2qt_p=0.4$. For $t_r=0.2$, $2qt_r=0.8$.\n$p_s = P_{11}(0.1) = \\frac{1}{2}(1 + \\exp(-0.4))$.\n$p_d = P_{01}(0.1) = \\frac{1}{2}(1 - \\exp(-0.4))$.\n$p'_s = P_{11}(0.2) = \\frac{1}{2}(1 + \\exp(-0.8))$.\n$p'_d = P_{01}(0.2) = \\frac{1}{2}(1 - \\exp(-0.8))$.\n\nLet's evaluate the denominator: $(p_d)^2 + (p_s)^2 = \\frac{1}{4}(1-\\exp(-0.4))^2 + \\frac{1}{4}(1+\\exp(-0.4))^2 = \\frac{1}{4}(1 - 2\\exp(-0.4) + \\exp(-0.8) + 1 + 2\\exp(-0.4) + \\exp(-0.8)) = \\frac{1}{2}(1+\\exp(-0.8)) = p'_s$.\nThe posterior probability becomes:\n$$\nP(\\text{root}=1|D) = \\frac{p'_d (p_d)^2 + p'_s (p_s)^2}{p'_s}\n$$\nSubstitute the expressions for the probabilities:\nLet $u = \\exp(-0.4)$, so $u^2 = \\exp(-0.8)$.\n$p_s = \\frac{1}{2}(1+u)$, $p_d = \\frac{1}{2}(1-u)$, $p'_s = \\frac{1}{2}(1+u^2)$, $p'_d = \\frac{1}{2}(1-u^2)$.\nNumerator: $\\frac{1}{2}(1-u^2)\\frac{1}{4}(1-u)^2 + \\frac{1}{2}(1+u^2)\\frac{1}{4}(1+u)^2$\n$= \\frac{1}{8}[(1-u^2)(1-2u+u^2) + (1+u^2)(1+2u+u^2)]$\n$= \\frac{1}{8}[(1-2u+u^2 - u^2+2u^3-u^4) + (1+2u+u^2 + u^2+2u^3+u^4)]$\n$= \\frac{1}{8}[1-2u+2u^3-u^4 + 1+2u+2u^2+2u^3+u^4] = \\frac{1}{8}[2+2u^2+4u^3] = \\frac{1}{4}(1+u^2+2u^3)$.\nSo, $P(\\text{root}=1|D) = \\frac{\\frac{1}{4}(1+u^2+2u^3)}{\\frac{1}{2}(1+u^2)} = \\frac{1}{2}\\frac{1+u^2+2u^3}{1+u^2} = \\frac{1}{2}\\frac{1+\\exp(-0.8)+2\\exp(-1.2)}{1+\\exp(-0.8)}$.\nNumerically:\n$\\exp(-0.8) \\approx 0.449329$\n$\\exp(-1.2) \\approx 0.301194$\n$P(\\text{root}=1|D) \\approx \\frac{1}{2} \\frac{1+0.449329+2(0.301194)}{1+0.449329} = \\frac{1}{2} \\frac{1.449329+0.602388}{1.449329} = \\frac{1}{2} \\frac{2.051717}{1.449329} \\approx \\frac{1}{2}(1.415635) \\approx 0.7078175$.\nRounding to four significant figures, the posterior probability is $0.7078$.", "answer": "$$\\boxed{0.7078}$$", "id": "2691564"}]}