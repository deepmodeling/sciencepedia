{"hands_on_practices": [{"introduction": "The fundamental challenge in comparative biology is that species are not independent data points due to their shared evolutionary history. Felsenstein's method of phylogenetically independent contrasts (PICs) was a groundbreaking solution, transforming trait data from related species into a set of values that are statistically independent and identically distributed. This foundational exercise [@problem_id:1761373] will guide you through the step-by-step mechanics of this algorithm, allowing you to build the core computational skill required for many modern comparative analyses.", "problem": "An evolutionary biologist is studying the evolution of body size in a small group of scarab beetles. She has constructed a phylogeny and collected body size data for three species: *Rhinoceps ferox*, *Goliathus parvus*, and *Chalcosoma medius*. The phylogenetic relationships are as follows: *R. ferox* and *G. parvus* are sister species, and their common ancestor represents a clade that is sister to *C. medius*.\n\nThe branch lengths, representing evolutionary time in millions of years (Myr), are given:\n- The branch from the common ancestor of *R. ferox* and *G. parvus* to the present-day *R. ferox* is 2 Myr.\n- The branch from the common ancestor of *R. ferox* and *G. parvus* to the present-day *G. parvus* is 2 Myr.\n- The branch from the root of the three-species tree to the common ancestor of *R. ferox* and *G. parvus* is 3 Myr.\n- The branch from the root of the tree to the present-day *C. medius* is 5 Myr.\n\nThe average adult body lengths for these species are:\n- *Rhinoceps ferox*: 45.5 mm\n- *Goliathus parvus*: 52.1 mm\n- *Chalcosoma medius*: 38.0 mm\n\nTo prepare for a comparative analysis, one must compute the phylogenetically independent contrasts for the body length trait. Using the standard algorithm for this method, calculate the numerical value of the independent contrast computed at the root of this three-species tree. Assume a Brownian motion model of trait evolution. Express your answer rounded to three significant figures.", "solution": "The problem asks for the calculation of the phylogenetically independent contrast at the root of a three-species tree. We will use Felsenstein's algorithm, which proceeds from the tips of the tree down to the root.\n\nLet's denote the species and their traits and branch lengths with symbols for clarity.\nLet species A be *Rhinoceps ferox*, species B be *Goliathus parvus*, and species C be *Chalcosoma medius*.\nThe trait values (body length) are:\n$x_A = 45.5$ mm\n$x_B = 52.1$ mm\n$x_C = 38.0$ mm\n\nThe branch lengths are:\n- The terminal branch leading to A, $v_A = 2$ Myr.\n- The terminal branch leading to B, $v_B = 2$ Myr.\n- The terminal branch leading to C, $v_C = 5$ Myr.\n- The internal branch leading to the common ancestor of A and B, which we'll call Node 1, has length $v_{1, \\text{stem}} = 3$ Myr.\n\nThe algorithm consists of two main parts for this tree: first, calculating the contrast between the sister species A and B and estimating the state at their common ancestor (Node 1); second, calculating the contrast between Node 1 and species C.\n\n**Step 1: Calculate the contrast between sister species A and B.**\nThe first independent contrast, $C_1$, is the difference in trait values between A and B, scaled by the square root of the sum of their branch lengths. The order of subtraction is arbitrary; we will compute $x_B - x_A$.\n$$\nC_1 = \\frac{x_B - x_A}{\\sqrt{v_A + v_B}}\n$$\nSubstituting the values:\n$$\nC_1 = \\frac{52.1 - 45.5}{\\sqrt{2 + 2}} = \\frac{6.6}{\\sqrt{4}} = \\frac{6.6}{2} = 3.3\n$$\n\n**Step 2: Estimate the trait value at the common ancestor (Node 1).**\nThe trait value at Node 1, $x_1$, is estimated as a weighted average of the trait values of its descendants, where the weights are the inverse of the respective branch lengths.\n$$\nx_1 = \\frac{\\frac{1}{v_A}x_A + \\frac{1}{v_B}x_B}{\\frac{1}{v_A} + \\frac{1}{v_B}}\n$$\nSince $v_A = v_B = 2$, this simplifies to the arithmetic mean:\n$$\nx_1 = \\frac{x_A + x_B}{2} = \\frac{45.5 + 52.1}{2} = \\frac{97.6}{2} = 48.8\n$$\nSo, the estimated body length of the ancestor at Node 1 is 48.8 mm.\n\n**Step 3: Update the branch length for Node 1.**\nNode 1 now acts like a tip for the next calculation. Its branch length needs to be adjusted to account for the variance introduced by the estimation in Step 2. The new branch length, $v'_1$, is its original stem branch length plus a term related to the lengths of the branches descending from it.\n$$\nv'_1 = v_{1, \\text{stem}} + \\frac{v_A v_B}{v_A + v_B}\n$$\nSubstituting the values:\n$$\nv'_1 = 3 + \\frac{2 \\times 2}{2 + 2} = 3 + \\frac{4}{4} = 3 + 1 = 4\n$$\nThe adjusted branch length for Node 1 is 4 Myr.\n\n**Step 4: Calculate the contrast at the root.**\nThe final step is to calculate the contrast at the root of the tree. This contrast, $C_{\\text{root}}$, is between the newly characterized Node 1 and the remaining species, C. We use their respective trait values ($x_1$ and $x_C$) and branch lengths ($v'_1$ and $v_C$).\n$$\nC_{\\text{root}} = \\frac{x_1 - x_C}{\\sqrt{v'_1 + v_C}}\n$$\nSubstituting the calculated and given values:\n$$\nC_{\\text{root}} = \\frac{48.8 - 38.0}{\\sqrt{4 + 5}} = \\frac{10.8}{\\sqrt{9}} = \\frac{10.8}{3} = 3.6\n$$\nThe value of the independent contrast computed at the root is 3.6.\n\n**Step 5: Final rounding.**\nThe problem asks for the answer to be rounded to three significant figures. The calculated value is 3.6, which when expressed with three significant figures is 3.60.", "answer": "$$\\boxed{3.60}$$", "id": "1761373"}, {"introduction": "Fitting a phylogenetic model is only half the battle; a crucial part of any robust analysis is to diagnose how well the model actually fits the data. One of the most important diagnostic checks is to test whether the model has successfully accounted for the phylogenetic signal it was designed to address. This practice problem [@problem_id:1761351] places you in the role of a researcher who has just received results from a Phylogenetic Generalized Least Squares (PGLS) analysis, challenging you to interpret what it means when significant phylogenetic structure remains in the model's residuals.", "problem": "A team of evolutionary biologists is investigating the allometric scaling of gut length in herbivorous mammals. They hypothesize that a species' gut length, a key trait for digesting plant matter, is primarily a function of its body mass. To test this, they gather data on the average body mass and average gut length for 85 species of herbivores and construct a robust molecular phylogeny for these species.\n\nThey decide to use a Phylogenetic Generalized Least Squares (PGLS) model to account for the statistical non-independence of species due to shared ancestry. The model is specified as:\n$$ \\ln(\\text{Gut Length}) = \\beta_0 + \\beta_1 \\ln(\\text{Body Mass}) + \\epsilon $$\nwhere $\\epsilon$ is the error term. The PGLS procedure estimates the model parameters ($\\beta_0$, $\\beta_1$) while simultaneously estimating Pagel's lambda ($\\lambda$), a measure of phylogenetic signal that structures the expected variance-covariance of the error term $\\epsilon$.\n\nAfter fitting the model, the team obtains statistically significant estimates for the intercept $\\beta_0$ and the slope $\\beta_1$. As a standard diagnostic check, they extract the residuals from the fitted model. They then test these residuals for the presence of phylogenetic signal and find a statistically significant result (e.g., using a likelihood ratio test, they find $\\lambda_{\\text{residuals}} = 0.65$ with $p  0.01$).\n\nWhich of the following is the most likely and direct interpretation of the finding that significant phylogenetic signal remains in the residuals of the PGLS model?\n\nA. The PGLS model has successfully accounted for all relevant phylogenetic effects, and the observed residual signal is a statistical artifact of the test used.\n\nB. The relationship between body mass and gut length is an example of pure Brownian motion evolution, meaning the PGLS model is the perfect and final model for these data.\n\nC. The model is misspecified, most likely because an important predictor variable that itself is phylogenetically patterned has been omitted.\n\nD. The significant slope $\\beta_1$ is spurious, and there is, in fact, no evolutionarily meaningful relationship between body mass and gut length.\n\nE. The phylogenetic tree used for the analysis is incorrect, and constructing a new tree from different genetic markers would eliminate the signal in the residuals.", "solution": "Let $y_{i}=\\ln(\\text{Gut Length}_{i})$ and $x_{i}=\\ln(\\text{Body Mass}_{i})$, and write the PGLS model in matrix form as\n$$\n\\mathbf{y}=\\mathbf{X}\\boldsymbol{\\beta}+\\boldsymbol{\\epsilon},\n$$\nwith $\\boldsymbol{\\epsilon}\\sim \\mathcal{N}\\!\\left(\\mathbf{0},\\,\\sigma^{2}\\mathbf{V}_{\\lambda}\\right)$, where $\\mathbf{X}$ has a column of ones and the predictor $x$, and $\\mathbf{V}_{\\lambda}$ is the phylogenetic variance-covariance matrix parameterized by Pagel’s $\\lambda$. A common specification is\n$$\n\\mathbf{V}_{\\lambda}=\\lambda \\mathbf{V}+(1-\\lambda)\\mathbf{D},\n$$\nwhere $\\mathbf{V}$ is the Brownian-motion covariance on the tree and $\\mathbf{D}=\\operatorname{diag}(\\mathbf{V})$, so that off-diagonal covariances are scaled by $\\lambda$ while the diagonal variances are preserved.\n\nGiven $\\lambda$, the generalized least squares estimator is\n$$\n\\hat{\\boldsymbol{\\beta}}=\\left(\\mathbf{X}^{\\top}\\mathbf{V}_{\\lambda}^{-1}\\mathbf{X}\\right)^{-1}\\mathbf{X}^{\\top}\\mathbf{V}_{\\lambda}^{-1}\\mathbf{y}.\n$$\nDefine the residuals $\\mathbf{r}=\\mathbf{y}-\\mathbf{X}\\hat{\\boldsymbol{\\beta}}$. Under a correctly specified mean model $\\mathbf{X}\\boldsymbol{\\beta}$, the residuals should represent noise structured exactly as modeled by $\\mathbf{V}_{\\lambda}$; equivalently, after appropriate GLS whitening, no remaining phylogenetic structure should be detectable. Operationally, testing for phylogenetic signal in $\\mathbf{r}$ amounts to comparing models\n$$\n\\mathbf{r}\\sim \\mathcal{N}\\!\\left(\\mathbf{0},\\,\\sigma^{2}\\mathbf{V}_{\\lambda_{r}}\\right)\n\\quad \\text{versus} \\quad\n\\mathbf{r}\\sim \\mathcal{N}\\!\\left(\\mathbf{0},\\,\\sigma^{2}\\mathbf{I}\\right),\n$$\nand a significant estimate $\\hat{\\lambda}_{\\text{residuals}}0$ indicates that residual covariance aligns with the tree beyond what would be expected if the predictor(s) fully captured phylogenetically patterned mean differences.\n\nThe empirical finding $\\hat{\\lambda}_{\\text{residuals}}=0.65$ with small $p$-value therefore implies that, after accounting for the fitted relationship $y=\\beta_{0}+\\beta_{1}x$, there remains systematic variation along the phylogeny. The most direct interpretation is model misspecification of the mean structure: an omitted predictor (or incorrect functional form) that is itself phylogenetically conserved causes residuals to inherit phylogenetic signal. This does not imply that the significant slope $\\beta_{1}$ is spurious; rather, it indicates that additional phylogenetically patterned predictors (e.g., fermentation strategy, diet composition, habitat, clade-specific intercepts/slopes, or nonlinearities) are needed. It also does not follow that the PGLS fully succeeded (contradicting option A), that the model is perfect under Brownian motion (contradicting option B), or that the tree must be incorrect (option E is not the most direct inference given the residual pattern).\n\nThus, the most likely and direct interpretation is that the model is misspecified due to omitted phylogenetically patterned predictors.", "answer": "$$\\boxed{C}$$", "id": "1761351"}, {"introduction": "The toolbox of phylogenetic comparative methods contains two cornerstone approaches: Felsenstein's Independent Contrasts (IC) and the more general framework of Phylogenetic Generalized Least Squares (PGLS). While they may seem distinct in their application, they are built on the same statistical and evolutionary principles. This advanced exercise [@problem_id:2742873] is designed to provide a deep, unifying insight by having you demonstrate their mathematical equivalence. By calculating a regression slope using both methods on an identical dataset, you will empirically prove that IC regression is a specific instance of the PGLS model, cementing your understanding of the field's theoretical foundations.", "problem": "Consider a balanced four-taxon phylogeny with topology $\\big((A,B),(C,D)\\big)$ in which all branch lengths are $1$ (that is, each tip is at distance $2$ from the root, sister pairs share an internal branch of length $1$, and there is no shared branch length between the two clades $(A,B)$ and $(C,D)$). Two continuous traits $X$ and $Y$ were measured at the tips with observed values:\n- $X_{A}=1$, $X_{B}=5$, $X_{C}=2$, $X_{D}=8$,\n- $Y_{A}=2$, $Y_{B}=12$, $Y_{C}=3$, $Y_{D}=14$.\n\nAssume a Brownian motion model of trait evolution with variance proportional to branch length and no measurement error. Use the following foundational principles:\n- Under Brownian motion on a known phylogeny, the variance of a tip value equals the total path length from the root to that tip, and the covariance between two tips equals the shared path length from the root to their most recent common ancestor.\n- For Felsenstein’s phylogenetically independent contrasts (IC), at a bifurcation with descendants having trait values $x_{i}$ and $x_{j}$ and branch lengths $v_{i}$ and $v_{j}$ to that node, the reconstructed ancestral value is $(x_{i}/v_{i}+x_{j}/v_{j})/(1/v_{i}+1/v_{j})$ and the corresponding variance is $1/(1/v_{i}+1/v_{j})$. The standardized contrast at that node is $(x_{i}-x_{j})/\\sqrt{v_{i}+v_{j}}$, and for contrasts at higher nodes the branch length to the ancestor is the original internal branch length plus the reconstructed variance.\n- In ordinary least squares through the origin with independent, identically distributed errors, for data pairs $(U_{X,k},U_{Y,k})$ the slope estimator is $\\hat{\\beta}=\\sum_{k} U_{X,k}U_{Y,k}/\\sum_{k} U_{X,k}^{2}$, with residual variance estimate $\\hat{s}^{2}=\\sum_{k} \\hat{\\epsilon}_{k}^{2}/(n-1)$ and $\\mathrm{SE}(\\hat{\\beta})=\\sqrt{\\hat{s}^{2}/\\sum_{k} U_{X,k}^{2}}$, where $n$ is the number of contrasts.\n- In phylogenetic generalized least squares (PGLS), with response vector $y$, predictor vector $x$, and covariance matrix $V=\\sigma^{2}C$ implied by the Brownian motion model and the tree, the generalized least squares estimator in the model with an intercept is $(X^{\\top}V^{-1}X)^{-1}X^{\\top}V^{-1}y$, where $X=[\\mathbf{1}\\ \\ x]$. The estimated residual variance is $\\hat{s}^{2}=(y-X\\hat{\\beta})^{\\top}V^{-1}(y-X\\hat{\\beta})/(n-p)$ with $p=2$, and the standard error for the slope is the square root of the slope’s diagonal element of $\\hat{s}^{2}(X^{\\top}V^{-1}X)^{-1}$.\n\nTasks:\n1) Compute the three standardized independent contrasts for $X$ and for $Y$ implied by the given tree and Brownian motion assumptions. Then fit the regression through the origin $U_{Y}=\\beta\\,U_{X}+\\epsilon$ to obtain the independent contrasts estimate $\\hat{\\beta}_{\\mathrm{IC}}$ and its standard error.\n\n2) Construct the phylogenetic covariance matrix $C$ for the tip values under Brownian motion on the given tree, compute $V^{-1}$ up to a proportionality constant, and fit the PGLS with an intercept to obtain the slope $\\hat{\\beta}_{\\mathrm{PGLS}}$ and its standard error.\n\n3) Show that the two slope estimates are identical and that the two standard errors are identical for this dataset, thereby empirically demonstrating the equivalence of independent contrasts and phylogenetic generalized least squares under matching assumptions.\n\nReport as your final answer the common slope estimate $\\hat{\\beta}$ as a simplified fraction. Do not include units and do not round; give the exact value.", "solution": "The phylogeny is a balanced four-taxon tree with topology $\\big((A,B),(C,D)\\big)$. All branch lengths are given as $1$. Let the root be $R$, the most recent common ancestor (MRCA) of species $A$ and $B$ be node $N_{AB}$, and the MRCA of $C$ and $D$ be node $N_{CD}$. The stated branch lengths are $l(R, N_{AB}) = 1$, $l(R, N_{CD}) = 1$, $l(N_{AB}, A) = 1$, $l(N_{AB}, B) = 1$, $l(N_{CD}, C) = 1$, and $l(N_{CD}, D) = 1$. This structure is consistent with the condition that each tip is at a distance of $2$ from the root.\n\nThe provided trait data are vectors $X = \\begin{pmatrix} X_A \\\\ X_B \\\\ X_C \\\\ X_D \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 5 \\\\ 2 \\\\ 8 \\end{pmatrix}$ and $Y = \\begin{pmatrix} Y_A \\\\ Y_B \\\\ Y_C \\\\ Y_D \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 12 \\\\ 3 \\\\ 14 \\end{pmatrix}$.\n\nTask 1: Felsenstein’s Independent Contrasts (IC)\nWe compute the $n-1 = 4-1 = 3$ standardized independent contrasts.\n\nContrast at node $N_{AB}$:\nThe branch lengths from the node to the descendants $A$ and $B$ are $v_A = 1$ and $v_B = 1$.\nThe standardized contrast for trait $X$ is $U_{X,1} = \\frac{X_A - X_B}{\\sqrt{v_A + v_B}} = \\frac{1-5}{\\sqrt{1+1}} = \\frac{-4}{\\sqrt{2}} = -2\\sqrt{2}$.\nThe standardized contrast for trait $Y$ is $U_{Y,1} = \\frac{Y_A - Y_B}{\\sqrt{v_A + v_B}} = \\frac{2-12}{\\sqrt{1+1}} = \\frac{-10}{\\sqrt{2}} = -5\\sqrt{2}$.\nThe estimated ancestral state at $N_{AB}$ for $X$ is $X_{N_{AB}} = \\frac{X_A/v_A + X_B/v_B}{1/v_A + 1/v_B} = \\frac{1/1 + 5/1}{1/1 + 1/1} = \\frac{6}{2} = 3$.\nFor $Y$, it is $Y_{N_{AB}} = \\frac{Y_A/v_A + Y_B/v_B}{1/v_A + 1/v_B} = \\frac{2/1 + 12/1}{1/1 + 1/1} = \\frac{14}{2} = 7$.\nThe variance of this estimate is $Var_{N_{AB}} = \\frac{1}{1/v_A + 1/v_B} = \\frac{1}{1/1 + 1/1} = \\frac{1}{2}$.\n\nContrast at node $N_{CD}$:\nThe branch lengths are $v_C = 1$ and $v_D = 1$.\n$U_{X,2} = \\frac{X_C - X_D}{\\sqrt{v_C + v_D}} = \\frac{2-8}{\\sqrt{1+1}} = \\frac{-6}{\\sqrt{2}} = -3\\sqrt{2}$.\n$U_{Y,2} = \\frac{Y_C - Y_D}{\\sqrt{v_C + v_D}} = \\frac{3-14}{\\sqrt{1+1}} = \\frac{-11}{\\sqrt{2}}$.\n$X_{N_{CD}} = \\frac{X_C/v_C + X_D/v_D}{1/v_C + 1/v_D} = \\frac{2/1 + 8/1}{1/1 + 1/1} = \\frac{10}{2} = 5$.\n$Y_{N_{CD}} = \\frac{Y_C/v_C + Y_D/v_D}{1/v_C + 1/v_D} = \\frac{3/1 + 14/1}{1/1 + 1/1} = \\frac{17}{2}$.\n$Var_{N_{CD}} = \\frac{1}{1/v_C + 1/v_D} = \\frac{1}{1/1 + 1/1} = \\frac{1}{2}$.\n\nContrast at root node $R$:\nThe descendants are nodes $N_{AB}$ and $N_{CD}$. The branch lengths are updated as per the problem description: $v_{N_{AB}} = l(R,N_{AB}) + Var_{N_{AB}} = 1 + \\frac{1}{2} = \\frac{3}{2}$ and $v_{N_{CD}} = l(R,N_{CD}) + Var_{N_{CD}} = 1 + \\frac{1}{2} = \\frac{3}{2}$.\n$U_{X,3} = \\frac{X_{N_{AB}} - X_{N_{CD}}}{\\sqrt{v_{N_{AB}} + v_{N_{CD}}}} = \\frac{3-5}{\\sqrt{3/2 + 3/2}} = \\frac{-2}{\\sqrt{3}}$.\n$U_{Y,3} = \\frac{Y_{N_{AB}} - Y_{N_{CD}}}{\\sqrt{v_{N_{AB}} + v_{N_{CD}}}} = \\frac{7 - 17/2}{\\sqrt{3/2 + 3/2}} = \\frac{-3/2}{\\sqrt{3}} = -\\frac{\\sqrt{3}}{2}$.\n\nFit regression through the origin $U_Y = \\beta U_X + \\epsilon$:\nThe slope estimator is $\\hat{\\beta}_{\\mathrm{IC}} = \\frac{\\sum_{k=1}^3 U_{X,k} U_{Y,k}}{\\sum_{k=1}^3 U_{X,k}^2}$.\n$\\sum U_{X,k}^2 = (-2\\sqrt{2})^2 + (-3\\sqrt{2})^2 + (-\\frac{2}{\\sqrt{3}})^2 = 8 + 18 + \\frac{4}{3} = 26 + \\frac{4}{3} = \\frac{78+4}{3} = \\frac{82}{3}$.\n$\\sum U_{X,k} U_{Y,k} = (-2\\sqrt{2})(-5\\sqrt{2}) + (-3\\sqrt{2})(-\\frac{11}{\\sqrt{2}}) + (-\\frac{2}{\\sqrt{3}})(-\\frac{\\sqrt{3}}{2}) = 20 + 33 + 1 = 54$.\n$\\hat{\\beta}_{\\mathrm{IC}} = \\frac{54}{82/3} = \\frac{54 \\times 3}{82} = \\frac{162}{82} = \\frac{81}{41}$.\n\nStandard error of $\\hat{\\beta}_{\\mathrm{IC}}$:\n$SE(\\hat{\\beta}_{\\mathrm{IC}}) = \\sqrt{\\frac{\\hat{s}^2}{\\sum U_{X,k}^2}}$, where $\\hat{s}^2 = \\frac{\\sum \\hat{\\epsilon}_k^2}{n-1}$ for $n=3$ contrasts.\n$\\sum \\hat{\\epsilon}_k^2 = \\sum U_{Y,k}^2 - \\frac{(\\sum U_{X,k}U_{Y,k})^2}{\\sum U_{X,k}^2}$.\n$\\sum U_{Y,k}^2 = (-5\\sqrt{2})^2 + (-\\frac{11}{\\sqrt{2}})^2 + (-\\frac{\\sqrt{3}}{2})^2 = 50 + \\frac{121}{2} + \\frac{3}{4} = \\frac{200+242+3}{4} = \\frac{445}{4}$.\n$\\sum \\hat{\\epsilon}_k^2 = \\frac{445}{4} - \\frac{54^2}{82/3} = \\frac{445}{4} - \\frac{2916 \\times 3}{82} = \\frac{445}{4} - \\frac{8748}{82} = \\frac{445}{4} - \\frac{4374}{41} = \\frac{445 \\times 41 - 4374 \\times 4}{164} = \\frac{18245 - 17496}{164} = \\frac{749}{164}$.\n$\\hat{s}^2 = \\frac{749/164}{3-1} = \\frac{749}{328}$.\n$SE(\\hat{\\beta}_{\\mathrm{IC}})^2 = \\frac{\\hat{s}^2}{\\sum U_{X,k}^2} = \\frac{749/328}{82/3} = \\frac{749 \\times 3}{328 \\times 82} = \\frac{2247}{26896}$.\n$SE(\\hat{\\beta}_{\\mathrm{IC}}) = \\sqrt{\\frac{2247}{26896}}$.\n\nTask 2: Phylogenetic Generalized Least Squares (PGLS)\nThe PGLS model is $y = X\\beta + \\epsilon$ with an intercept, where $E[\\epsilon]=0$ and $Var[\\epsilon]=V=\\sigma^2 C$. The matrix $C$ is the phylogenetic covariance matrix derived from branch lengths. For tips $i$ and $j$, $C_{ij}$ is the shared path length from the root to their MRCA. $C_{ii}$ is the path length from the root to tip $i$.\n$$C = \\begin{pmatrix} 2  1  0  0 \\\\ 1  2  0  0 \\\\ 0  0  2  1 \\\\ 0  0  1  2 \\end{pmatrix}$$\nThis is a block diagonal matrix. Its inverse is the block diagonal matrix of the inverses of the blocks. The inverse of $\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$ is $\\frac{1}{3}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$.\n$$C^{-1} = \\frac{1}{3} \\begin{pmatrix} 2  -1  0  0 \\\\ -1  2  0  0 \\\\ 0  0  2  -1 \\\\ 0  0  -1  2 \\end{pmatrix}$$\nThe design matrix $X$ and response vector $y$ are:\n$$X = \\begin{pmatrix} 1  1 \\\\ 1  5 \\\\ 1  2 \\\\ 1  8 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 2 \\\\ 12 \\\\ 3 \\\\ 14 \\end{pmatrix}$$\nThe GLS estimator is $\\hat{\\beta}_{\\mathrm{PGLS}} = (X^\\top V^{-1} X)^{-1} X^\\top V^{-1} y$. The unknown variance scalar $\\sigma^2$ cancels from this expression, so we use $C^{-1}$ for $V^{-1}$.\n$X^\\top C^{-1} = \\frac{1}{3} \\begin{pmatrix} 1  1  1  1 \\\\ 1  5  2  8 \\end{pmatrix} \\begin{pmatrix} 2  -1  0  0 \\\\ -1  2  0  0 \\\\ 0  0  2  -1 \\\\ 0  0  -1  2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 1  1  1  1 \\\\ -3  9  -4  14 \\end{pmatrix}$.\n$X^\\top C^{-1} X = \\frac{1}{3} \\begin{pmatrix} 1  1  1  1 \\\\ -3  9  -4  14 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  5 \\\\ 1  2 \\\\ 1  8 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 4  16 \\\\ 16  146 \\end{pmatrix}$.\nLet $A = X^\\top C^{-1} X$. The inverse is $A^{-1} = 3 \\left(\\begin{pmatrix} 4  16 \\\\ 16  146 \\end{pmatrix}\\right)^{-1} = 3 \\frac{1}{4 \\cdot 146 - 16^2} \\begin{pmatrix} 146  -16 \\\\ -16  4 \\end{pmatrix} = \\frac{3}{328} \\begin{pmatrix} 146  -16 \\\\ -16  4 \\end{pmatrix}$.\n$X^\\top C^{-1} y = \\frac{1}{3} \\begin{pmatrix} 1  1  1  1 \\\\ -3  9  -4  14 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 12 \\\\ 3 \\\\ 14 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 31 \\\\ 286 \\end{pmatrix}$.\n$\\hat{\\beta}_{\\mathrm{PGLS}} = A^{-1} (X^\\top C^{-1} y) = \\frac{3}{328} \\begin{pmatrix} 146  -16 \\\\ -16  4 \\end{pmatrix} \\frac{1}{3} \\begin{pmatrix} 31 \\\\ 286 \\end{pmatrix} = \\frac{1}{328} \\begin{pmatrix} 146 \\cdot 31 - 16 \\cdot 286 \\\\ -16 \\cdot 31 + 4 \\cdot 286 \\end{pmatrix} = \\frac{1}{328} \\begin{pmatrix} 4526 - 4576 \\\\ -496 + 1144 \\end{pmatrix} = \\frac{1}{328} \\begin{pmatrix} -50 \\\\ 648 \\end{pmatrix}$.\nThe estimate for the slope is the second component: $\\hat{\\beta}_{\\mathrm{PGLS}} = \\frac{648}{328} = \\frac{81}{41}$.\n\nStandard error of $\\hat{\\beta}_{\\mathrm{PGLS}}$:\nThe estimated residual variance is $\\hat{s}^2 = \\frac{(y - X\\hat{\\beta})^\\top C^{-1} (y - X\\hat{\\beta})}{n-p}$ with $n=4, p=2$. The numerator is $\\mathrm{SSE} = y^\\top C^{-1} y - \\hat{\\beta}^\\top X^\\top C^{-1} y$.\n$y^\\top C^{-1}y = \\frac{1}{3} \\begin{pmatrix} 2  12  3  14 \\end{pmatrix} \\begin{pmatrix} 2  -1  0  0 \\\\ -1  2  0  0 \\\\ 0  0  2  -1 \\\\ 0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 12 \\\\ 3 \\\\ 14 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} -8  22  -8  25 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 12 \\\\ 3 \\\\ 14 \\end{pmatrix} = \\frac{1}{3}(-16+264-24+350) = \\frac{574}{3}$.\n$\\hat{\\beta}^\\top X^\\top C^{-1} y = \\frac{1}{328} \\begin{pmatrix} -50  648 \\end{pmatrix} \\frac{1}{3} \\begin{pmatrix} 31 \\\\ 286 \\end{pmatrix} = \\frac{1}{984}(-50 \\cdot 31 + 648 \\cdot 286) = \\frac{1}{984}(-1550 + 185328) = \\frac{183778}{984} = \\frac{91889}{492}$.\n$\\mathrm{SSE} = \\frac{574}{3} - \\frac{91889}{492} = \\frac{574 \\cdot 164}{492} - \\frac{91889}{492} = \\frac{94136 - 91889}{492} = \\frac{2247}{492} = \\frac{749}{164}$.\n$\\hat{s}^2_{\\mathrm{PGLS}} = \\frac{749/164}{4-2} = \\frac{749}{328}$.\nThe estimated variance-covariance matrix for $\\hat{\\beta}$ is $\\hat{s}^2 (X^\\top C^{-1} X)^{-1}$. The variance of the slope estimate is the $(2,2)$ element.\n$SE(\\hat{\\beta}_{\\mathrm{PGLS}})^2 = \\hat{s}^2_{\\mathrm{PGLS}} \\cdot \\left((X^\\top C^{-1}X)^{-1}\\right)_{22} = \\frac{749}{328} \\cdot \\left(\\frac{3}{328} \\begin{pmatrix} 146  -16 \\\\ -16  4 \\end{pmatrix}\\right)_{22} = \\frac{749}{328} \\cdot \\frac{3 \\cdot 4}{328} = \\frac{749 \\cdot 12}{328^2} = \\frac{749 \\cdot 3}{328 \\cdot 82} = \\frac{2247}{26896}$.\n$SE(\\hat{\\beta}_{\\mathrm{PGLS}}) = \\sqrt{\\frac{2247}{26896}}$.\n\nTask 3: Comparison\nThe slope estimate from independent contrasts is $\\hat{\\beta}_{\\mathrm{IC}} = \\frac{81}{41}$.\nThe slope estimate from phylogenetic generalized least squares is $\\hat{\\beta}_{\\mathrm{PGLS}} = \\frac{81}{41}$.\nThese are identical.\nThe squared standard error from independent contrasts is $SE(\\hat{\\beta}_{\\mathrm{IC}})^2 = \\frac{2247}{26896}$.\nThe squared standard error from PGLS is $SE(\\hat{\\beta}_{\\mathrm{PGLS}})^2 = \\frac{2247}{26896}$.\nThese are also identical.\nThe analysis empirically demonstrates the mathematical equivalence of Felsenstein's independent contrasts method (with regression through the origin) and phylogenetic generalized least squares (with an intercept term) when the underlying evolutionary model (Brownian motion) and phylogenetic tree are the same for both methods.\nThe common slope estimate is $\\frac{81}{41}$.", "answer": "$$\\boxed{\\frac{81}{41}}$$", "id": "2742873"}]}