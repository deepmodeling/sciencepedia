{"hands_on_practices": [{"introduction": "The \"wavefront\" of the clock and wavefront model is a gradient of positional information, often established by a morphogen like FGF. This practice challenges you to derive the steady-state profile of such a morphogen from first principles of diffusion and degradation. By identifying the characteristic length scale $\\lambda = \\sqrt{D/k}$, you will uncover a fundamental parameter that governs the extent of the gradient and thus constrains the region where somites can form [@problem_id:2679229].", "problem": "A core ingredient of the clock and wavefront model for somitogenesis is a posterior-to-anterior molecular gradient in the presomitic mesoderm (PSM), frequently attributed to Fibroblast Growth Factor (FGF). Consider a one-dimensional tissue coordinate $x \\ge 0$ along the anterior–posterior (A–P) axis with the tailbud at $x=0$. Fibroblast Growth Factor (FGF) is produced at $x=0$, diffuses into the PSM with diffusion coefficient $D$, and is uniformly degraded by first-order kinetics with rate constant $k$. Assume that the system has reached a steady state in the tissue frame and that the tailbud acts as a constant source imposing a fixed production flux $J_{0}$ into the PSM. Far from the source, the concentration vanishes.\n\nStarting only from (i) mass conservation, (ii) Fick’s law of diffusion, and (iii) first-order degradation kinetics, derive the steady-state concentration profile $c(x)$ and identify the characteristic length scale governing the spatial decay of the profile. Then, in the context of the clock and wavefront model, define the position $x^{\\ast}$ where the FGF concentration equals a fixed threshold $c_{\\mathrm{th}}$ and express $x^{\\ast}$ in terms of the characteristic length scale and boundary quantities. Finally, interpret biologically what this characteristic length scale represents for the FGF gradient in the PSM and how it constrains the location of the wavefront.\n\nYour final answer must be the closed-form analytical expression for the characteristic length scale. Do not include any units in the final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard reaction-diffusion scenario, a cornerstone of mathematical biology for modeling morphogen gradients. All data and conditions provided are consistent and sufficient for deriving a unique and meaningful solution. The problem is therefore deemed valid.\n\nWe proceed with the derivation. The problem asks us to derive the steady-state concentration profile $c(x)$ of Fibroblast Growth Factor (FGF) along a one-dimensional tissue axis, $x \\ge 0$. The derivation must start from three fundamental principles: (i) mass conservation, (ii) Fick’s law of diffusion, and (iii) first-order degradation kinetics.\n\nLet us consider a small, one-dimensional control volume of length $\\Delta x$ and uniform cross-sectional area $A$, located between position $x$ and $x+\\Delta x$. The total amount of FGF in this volume is $c(x,t) A \\Delta x$.\n\nThe principle of mass conservation states that the rate of change of the amount of substance in the control volume is equal to the net flux into the volume minus the rate of removal by degradation.\nThe rate of change of mass is $\\frac{\\partial}{\\partial t} (c A \\Delta x)$.\nThe flux of FGF into the volume at position $x$ is $J(x,t) A$, and the flux out of the volume at position $x+\\Delta x$ is $J(x+\\Delta x, t) A$. The net flux into the volume is thus $(J(x,t) - J(x+\\Delta x,t))A$.\nThe FGF is degraded by first-order kinetics with rate constant $k$. The rate of removal from the volume is therefore $(k c) A \\Delta x$.\n\nCombining these terms, the mass balance equation is:\n$$ \\frac{\\partial}{\\partial t} (c A \\Delta x) = (J(x,t) - J(x+\\Delta x,t))A - k c A \\Delta x $$\nDividing by the volume $A \\Delta x$ and rearranging gives:\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{J(x+\\Delta x,t) - J(x,t)}{\\Delta x} - k c $$\nTaking the limit as $\\Delta x \\to 0$, we obtain the one-dimensional reaction-diffusion equation in its general form:\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{\\partial J}{\\partial x} - k c $$\nNext, we invoke Fick's first law of diffusion, which relates the flux $J$ to the concentration gradient:\n$$ J = -D \\frac{\\partial c}{\\partial x} $$\nwhere $D$ is the diffusion coefficient. Substituting Fick's law into the mass balance equation yields:\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{\\partial}{\\partial x} \\left(-D \\frac{\\partial c}{\\partial x}\\right) - k c = D \\frac{\\partial^2 c}{\\partial x^2} - k c $$\nThe problem specifies that the system has reached a steady state, which means the concentration no longer changes with time. Therefore, $\\frac{\\partial c}{\\partial t} = 0$. This simplifies the governing equation to a second-order ordinary differential equation (ODE):\n$$ D \\frac{d^2 c}{d x^2} - k c = 0 $$\n$$ \\frac{d^2 c}{d x^2} - \\frac{k}{D} c = 0 $$\nThis equation describes the steady-state concentration profile. To solve it, we define a parameter with the dimension of length, $\\lambda$, as $\\lambda = \\sqrt{\\frac{D}{k}}$. The ODE can now be written in a more compact form:\n$$ \\frac{d^2 c}{d x^2} - \\frac{1}{\\lambda^2} c = 0 $$\nThis is a homogeneous linear second-order ODE with constant coefficients. The characteristic equation is $r^2 - \\frac{1}{\\lambda^2} = 0$, which has roots $r = \\pm \\frac{1}{\\lambda}$. The general solution is therefore:\n$$ c(x) = C_1 \\exp\\left(\\frac{x}{\\lambda}\\right) + C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\nwhere $C_1$ and $C_2$ are integration constants to be determined by the boundary conditions.\n\nThe first boundary condition is that the concentration vanishes far from the source: $c(x) \\to 0$ as $x \\to \\infty$. For this to hold, the term with the positive exponent, $\\exp(x/\\lambda)$, must be zero, as it grows without bound as $x \\to \\infty$. This requires that the constant $C_1$ must be $0$. The solution reduces to:\n$$ c(x) = C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\nThe second boundary condition is a constant production flux, $J_0$, at the source $x=0$. The flux $J(x)$ is given by Fick's law:\n$$ J(x) = -D \\frac{dc}{dx} = -D \\frac{d}{dx} \\left( C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) \\right) = -D \\left( -\\frac{C_2}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) \\right) = \\frac{D C_2}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\nAt $x=0$, the flux is $J(0) = J_0$:\n$$ J_0 = \\frac{D C_2}{\\lambda} $$\nSolving for the constant $C_2$ gives:\n$$ C_2 = \\frac{J_0 \\lambda}{D} $$\nSubstituting this back into the solution for $c(x)$, we obtain the final steady-state concentration profile:\n$$ c(x) = \\frac{J_0 \\lambda}{D} \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\nFrom this derivation, the characteristic length scale governing the spatial decay of the profile is immediately identified as:\n$$ \\lambda = \\sqrt{\\frac{D}{k}} $$\nThis length scale emerges naturally from the non-dimensionalization of the governing ODE and dictates the distance over which the concentration decays by a factor of $e^{-1}$.\n\nNext, we define the position of the wavefront, $x^{\\ast}$, as the location where the FGF concentration equals a fixed threshold $c_{\\mathrm{th}}$. We set $c(x^{\\ast}) = c_{\\mathrm{th}}$:\n$$ \\frac{J_0 \\lambda}{D} \\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = c_{\\mathrm{th}} $$\nTo solve for $x^{\\ast}$, we first isolate the exponential term:\n$$ \\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = \\frac{c_{\\mathrm{th}} D}{J_0 \\lambda} $$\nTaking the natural logarithm of both sides:\n$$ -\\frac{x^{\\ast}}{\\lambda} = \\ln\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right) $$\n$$ x^{\\ast} = -\\lambda \\ln\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right) = \\lambda \\ln\\left(\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right)^{-1}\\right) $$\nThus, the position of the wavefront is:\n$$ x^{\\ast} = \\lambda \\ln\\left(\\frac{J_0 \\lambda}{c_{\\mathrm{th}} D}\\right) $$\nThe term $\\frac{J_0 \\lambda}{D}$ is the concentration at the source, $c(0)$, which we can denote as $c_0$. The expression for $x^{\\ast}$ can be written more transparently as $x^{\\ast} = \\lambda \\ln(c_0 / c_{\\mathrm{th}})$, which explicitly shows its dependence on the characteristic length scale $\\lambda$ and the ratio of the source concentration to the threshold concentration.\n\nFinally, we provide the biological interpretation. The characteristic length scale, $\\lambda = \\sqrt{D/k}$, is a fundamental parameter of the morphogen gradient. It represents the distance over which an FGF molecule, produced at the tailbud, typically diffuses before it is degraded. A larger $\\lambda$ (due to high diffusion $D$ or low degradation $k$) results in a shallow gradient that extends far into the presomitic mesoderm (PSM). A smaller $\\lambda$ (due to low diffusion $D$ or high degradation $k$) results in a steep, localized gradient. In the context of the clock and wavefront model, the wavefront of somitogenesis is posited to be the location where the FGF concentration falls below a critical threshold, $c_{\\mathrm{th}}$. Our derived expression, $x^{\\ast} = \\lambda \\ln(c_0/c_{\\mathrm{th}})$, demonstrates that the position of this wavefront is directly proportional to the characteristic length scale $\\lambda$. Therefore, $\\lambda$ is not merely an abstract mathematical parameter; it is a physical property of the tissue system that directly constrains positional information. Any genetic or environmental factor that alters the diffusion or degradation rates of FGF will change $\\lambda$ and consequently shift the position of the wavefront, thereby affecting the size and location of the formed somites.\n\nThe problem specifically asks for the closed-form analytical expression for the characteristic length scale.", "answer": "$$ \\boxed{\\sqrt{\\frac{D}{k}}} $$", "id": "2679229"}, {"introduction": "At the heart of the \"clock\" is a self-sustaining molecular oscillator within each cell, often driven by delayed negative feedback in gene regulatory networks. This exercise delves into the dynamics of this oscillator, asking you to perform a linear stability analysis on a delay differential equation model. You will derive the critical condition for the onset of oscillations—a Hopf bifurcation—which reveals how parameters like feedback delay and protein degradation rates conspire to make the clock tick [@problem_id:2679227].", "problem": "In the clock and wavefront model of somite formation, intracellular oscillations of gene products are often modeled by delayed negative feedback arising from transcription, translation, and delayed autorepression. Consider a single-gene delayed negative feedback model for a protein concentration $p(t)$ given by the delay differential equation (DDE)\n$$\n\\dot{p}(t) \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{p(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\, p(t),\n$$\nwhere $\\beta \\!>\\! 0$ is the maximal production rate, $K \\!>\\! 0$ is the half-saturation constant, $n \\!>\\! 1$ is the Hill coefficient, $\\gamma \\!>\\! 0$ is the first-order degradation rate, and $\\tau \\!>\\! 0$ is an effective transcription-translation-feedback delay. Let $p^{\\ast}$ denote a steady state satisfying $\\dot{p}(t)=0$.\n\nStarting from first principles of stability analysis for delay differential equations, perform a linearization about the steady state $p^{\\ast}$ and apply the definition of a Hopf bifurcation (the appearance of a pair of purely imaginary eigenvalues) to obtain a closed-form expression for the smallest positive critical delay $\\tau_{c}$ at which a Hopf bifurcation occurs. Your derivation should begin from the linearization procedure and the characteristic equation for the DDE, and should identify the necessary compatibility conditions for purely imaginary roots. Express your final result $\\tau_{c}$ in terms of the model parameters $\\gamma$, $K$, $n$, and the steady-state value $p^{\\ast}$; angles must be expressed in radians. The final answer must be a single closed-form analytic expression. Do not report any inequalities; only report the expression for $\\tau_{c}$.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It provides a standard delay differential equation model for a biological oscillator and asks for the derivation of the critical delay for a Hopf bifurcation using established methods of stability analysis. All necessary parameters and conditions are defined. The problem is valid.\n\nWe begin with the delay differential equation (DDE) for the protein concentration $p(t)$:\n$$ \\frac{d p}{dt} = \\frac{\\beta}{1 + \\left(\\frac{p(t-\\tau)}{K}\\right)^{n}} - \\gamma p(t) $$\nThe parameters $\\beta$, $K$, $n$, $\\gamma$, and $\\tau$ are all positive constants, with $n > 1$.\n\nFirst, we identify the steady state $p^{\\ast}$. A steady state is a constant solution, so $p(t) = p(t-\\tau) = p^{\\ast}$ and $\\frac{dp}{dt} = 0$. Substituting these into the DDE gives the steady-state condition:\n$$ 0 = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast}}{K}\\right)^{n}} - \\gamma p^{\\ast} \\quad \\implies \\quad \\gamma p^{\\ast} = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\nThe problem requires the final answer in terms of $p^{\\ast}$, so we do not need to solve this equation for $p^{\\ast}$.\n\nNext, we perform a linear stability analysis around the steady state $p^{\\ast}$. Let $p(t) = p^{\\ast} + x(t)$, where $x(t)$ represents a small perturbation. Substituting this into the DDE yields:\n$$ \\frac{d}{dt}(p^{\\ast} + x(t)) = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast} + x(t-\\tau)}{K}\\right)^{n}} - \\gamma(p^{\\ast} + x(t)) $$\nThe left side is $\\frac{dx}{dt}$. Let the nonlinear production term be $f(p) = \\frac{\\beta}{1 + (p/K)^{n}}$. We perform a first-order Taylor expansion of $f(p(t-\\tau))$ around $p^{\\ast}$:\n$$ f(p^{\\ast} + x(t-\\tau)) \\approx f(p^{\\ast}) + f'(p^{\\ast}) x(t-\\tau) $$\nThe full equation becomes:\n$$ \\frac{dx}{dt} \\approx f(p^{\\ast}) + f'(p^{\\ast}) x(t-\\tau) - \\gamma p^{\\ast} - \\gamma x(t) $$\nFrom the steady-state condition, $f(p^{\\ast}) = \\gamma p^{\\ast}$. These terms cancel, leaving the linearized DDE:\n$$ \\frac{dx}{dt} = f'(p^{\\ast}) x(t-\\tau) - \\gamma x(t) $$\nWe must calculate the derivative $f'(p^{\\ast})$. The derivative of $f(p)$ is:\n$$ f'(p) = \\frac{d}{dp}\\left[\\beta \\left(1 + \\left(\\frac{p}{K}\\right)^{n}\\right)^{-1}\\right] = -\\beta \\left(1 + \\left(\\frac{p}{K}\\right)^{n}\\right)^{-2} \\cdot n\\left(\\frac{p}{K}\\right)^{n-1} \\cdot \\frac{1}{K} $$\n$$ f'(p) = -\\frac{\\beta n}{K} \\frac{(p/K)^{n-1}}{(1+(p/K)^{n})^{2}} $$\nUsing the steady-state relation $\\beta = \\gamma p^{\\ast} (1 + (p^{\\ast}/K)^{n})$, we substitute for $\\beta$ to express $f'(p^{\\ast})$ in terms of the other parameters:\n$$ f'(p^{\\ast}) = -\\frac{\\gamma p^{\\ast} (1 + (p^{\\ast}/K)^{n}) n}{K} \\frac{(p^{\\ast}/K)^{n-1}}{(1+(p^{\\ast}/K)^{n})^{2}} = -\\frac{\\gamma n p^{\\ast}}{K} \\frac{(p^{\\ast}/K)^{n-1}}{1+(p^{\\ast}/K)^{n}} = -\\frac{\\gamma n (p^{\\ast}/K)^{n}}{1+(p^{\\ast}/K)^{n}} $$\nThe term $f'(p^{\\ast})$ is negative since all parameters and $p^{\\ast}$ are positive and $n > 1$. Let us define a positive constant $A = -f'(p^{\\ast})$ representing the strength of the negative feedback:\n$$ A = \\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\nThe linearized DDE is now $\\frac{dx}{dt} = -A x(t-\\tau) - \\gamma x(t)$.\n\nTo find the stability of the steady state, we analyze the characteristic equation. We seek solutions of the form $x(t) \\propto \\exp(\\lambda t)$. Substituting this ansatz into the linearized equation:\n$$ \\lambda e^{\\lambda t} = -A e^{\\lambda(t-\\tau)} - \\gamma e^{\\lambda t} $$\nDividing by $e^{\\lambda t}$ yields the characteristic equation for the eigenvalue $\\lambda$:\n$$ \\lambda + \\gamma + A e^{-\\lambda \\tau} = 0 $$\nA Hopf bifurcation occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. At the bifurcation point, there exists a purely imaginary eigenvalue pair $\\lambda = \\pm i\\omega_c$, where $\\omega_c > 0$ is the critical frequency. Substituting $\\lambda = i\\omega_c$ into the characteristic equation:\n$$ i\\omega_c + \\gamma + A e^{-i\\omega_c \\tau_c} = 0 $$\nUsing Euler's identity $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$, we get:\n$$ i\\omega_c + \\gamma + A(\\cos(\\omega_c \\tau_c) - i\\sin(\\omega_c \\tau_c)) = 0 $$\nSeparating the real and imaginary parts gives a system of two equations:\n$$ \\text{Real part:} \\quad \\gamma + A\\cos(\\omega_c \\tau_c) = 0 \\quad \\implies \\quad \\cos(\\omega_c \\tau_c) = -\\frac{\\gamma}{A} $$\n$$ \\text{Imaginary part:} \\quad \\omega_c - A\\sin(\\omega_c \\tau_c) = 0 \\quad \\implies \\quad \\sin(\\omega_c \\tau_c) = \\frac{\\omega_c}{A} $$\nFor a solution to exist, we use the identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$ \\left(-\\frac{\\gamma}{A}\\right)^2 + \\left(\\frac{\\omega_c}{A}\\right)^2 = 1 \\implies \\frac{\\gamma^2}{A^2} + \\frac{\\omega_c^2}{A^2} = 1 $$\n$$ \\omega_c^2 + \\gamma^2 = A^2 \\implies \\omega_c^2 = A^2 - \\gamma^2 $$\nFor a non-zero real frequency $\\omega_c$, we must have $A^2 > \\gamma^2$, or $A > \\gamma$. The critical frequency is therefore $\\omega_c = \\sqrt{A^2 - \\gamma^2}$.\n\nTo find the critical delay $\\tau_c$, we use the equations for cosine and sine. From the signs, $\\cos(\\omega_c \\tau_c) < 0$ and $\\sin(\\omega_c \\tau_c) > 0$, the angle $\\omega_c \\tau_c$ must lie in the second quadrant. We can solve for the angle using the arccosine function, whose principal value range is $[0, \\pi]$. The condition correctly places the angle in $(\\pi/2, \\pi)$.\n$$ \\omega_c \\tau_c = \\arccos\\left(-\\frac{\\gamma}{A}\\right) + 2k\\pi $$\nwhere $k$ is an integer $k \\ge 0$. The smallest positive delay $\\tau_c$ corresponds to $k=0$:\n$$ \\tau_c = \\frac{1}{\\omega_c} \\arccos\\left(-\\frac{\\gamma}{A}\\right) $$\nSubstituting $\\omega_c = \\sqrt{A^2 - \\gamma^2}$:\n$$ \\tau_c = \\frac{1}{\\sqrt{A^2 - \\gamma^2}} \\arccos\\left(-\\frac{\\gamma}{A}\\right) $$\nFinally, we substitute the expression for $A$ in terms of the model parameters to obtain the final closed-form solution for $\\tau_c$.\nThe denominator is:\n$$ \\sqrt{A^2 - \\gamma^2} = \\sqrt{\\left(\\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right)^2 - \\gamma^2} = \\gamma \\sqrt{\\frac{n^2\\left(\\frac{p^{\\ast}}{K}\\right)^{2n}}{\\left(1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}\\right)^2} - 1} $$\n$$ = \\frac{\\gamma}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} \\sqrt{n^2\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - \\left(1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}\\right)^2} $$\n$$ = \\frac{\\gamma}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} \\sqrt{\\left(n^2-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1} $$\nThe argument of the arccosine is:\n$$ -\\frac{\\gamma}{A} = -\\frac{\\gamma}{\\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}} = -\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\nCombining these gives the expression for $\\tau_c$:\n$$ \\tau_c = \\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{\\gamma \\sqrt{\\left(n^2-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1}} \\arccos\\left(-\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right) $$\nThis is the final expression for the smallest positive critical delay at which a Hopf bifurcation occurs.", "answer": "$$\\boxed{\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{\\gamma \\sqrt{\\left(n^{2}-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1}} \\arccos\\left(-\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right)}$$", "id": "2679227"}, {"introduction": "The predictive power of the clock and wavefront model lies in its ability to integrate spatial and temporal signals to create a precise pattern. In this computational practice, you will synthesize the concepts of the wavefront gradient and the segmentation clock into a single simulation. Your task is to model how the intersection of a repressive FGF gradient and an oscillatory activation signal generates a sharp stripe of Mesp2 expression, providing a hands-on look at how the abstract model translates into a concrete biological output [@problem_id:2679198].", "problem": "Design and implement a self-contained numerical program that, for a minimal and biologically plausible model of Mesp2 stripe formation under the clock and wavefront framework, computes the full width at half maximum (FWHM) of the Mesp2 expression stripe as a function of the steepness of the Fibroblast Growth Factor (FGF) gradient and the amplitude of clock oscillations. The program must produce one FWHM value per test case and aggregate the results into a single-line list as specified below.\n\nModel assumptions, definitions, and requirements:\n- Biological context and minimal mathematical model: In the presomitic mesoderm, the FGF (Fibroblast Growth Factor, FGF) protein forms a posterior-to-anterior gradient that represses Mesp2, while the segmentation clock periodically activates target genes via oscillatory Notch signaling. We model the steady-time snapshot of Mesp2 expression at a fixed time as the multiplicative integration of a repression term and an activation term, capturing a logical “AND” where both low FGF and a permissive clock state are required.\n- Spatial domain: Use a one-dimensional embryonic axis with position $x \\in [0,L]$, posterior at $x=0$ and anterior at $x=L$. Treat all quantities as unitless unless explicitly specified. Angles must be in radians.\n- FGF gradient: Let the FGF concentration be $F(x) = F_0 \\exp(-s x)$, where $F_0$ is the posterior concentration and $s$ is the gradient steepness parameter to be varied across test cases.\n- FGF repression of Mesp2: Let the repression be modeled as a Hill-type relief-of-repression factor\n$$\nR(F) = \\frac{1}{1 + \\left(\\frac{F}{K_f}\\right)^{n_f}},\n$$\nwhere $K_f$ is the FGF half-effect concentration and $n_f$ is the Hill coefficient representing cooperativity.\n- Clock-driven activation: Let the instantaneous clock drive be a half-wave rectified cosine\n$$\nC(x) = \\max\\left(0, A \\cos(q x + \\phi_0)\\right),\n$$\nwhere $A$ is the oscillation amplitude to be varied across test cases, $q$ is the spatial wavenumber, and $\\phi_0$ is a phase offset. Model transcriptional activation by a Hill function\n$$\nH(C) = \\begin{cases}\n\\frac{1}{1 + \\left(\\frac{K_c}{C}\\right)^{n_c}}, & C > 0, \\\\\n0, & C \\le 0,\n\\end{cases}\n$$\nwith activation threshold $K_c$ and Hill coefficient $n_c$.\n- Mesp2 snapshot: Define the instantaneous Mesp2 expression profile at a fixed time as\n$$\nM(x) = H(C(x)) \\cdot R(F(x)).\n$$\n- Determination front: Define the determination front as the position $x_{\\mathrm{df}}$ where $R(F(x_{\\mathrm{df}})) = \\tfrac{1}{2}$, equivalently where $F(x_{\\mathrm{df}}) = K_f$. Under the exponential gradient, this is\n$$\nx_{\\mathrm{df}} = \\frac{\\ln\\left(\\frac{F_0}{K_f}\\right)}{s}.\n$$\n- Stripe identification and FWHM: Among all local maxima of $M(x)$ on $[0,L]$, select the peak whose position is closest to $x_{\\mathrm{df}}$. Let its peak value be $M_{\\max}$. Define the full width at half maximum (FWHM) as the spatial distance between the two nearest points on either side of the peak where $M(x)$ crosses $\\tfrac{1}{2} M_{\\max}$, obtained by linear interpolation between adjacent sampled points. If $M(x)$ has no local maxima or $M_{\\max} = 0$, define the FWHM to be $0$.\n- Numerical method requirements:\n    - Use a uniform grid of $N$ points over $[0,L]$ with $N$ sufficiently large to resolve the stripe and robustly compute FWHM by interpolation.\n    - Use angles in radians for all trigonometric computations.\n    - Use only the specified constants below and vary only $(s,A)$ across the test suite.\n\nConstants to use for all simulations:\n- Spatial domain length: $L = 5$.\n- Posterior FGF: $F_0 = 1$.\n- FGF Hill parameters: $K_f = 0.2$, $n_f = 4$.\n- Clock spatial wavenumber and phase: $q = 2\\pi$, $\\phi_0 = 0$.\n- Clock Hill parameters: $K_c = 0.5$, $n_c = 3$.\n- Grid resolution: $N = 10001$.\n\nTest suite:\n- Case $1$: $(s, A) = (1.0, 0.6)$.\n- Case $2$: $(s, A) = (2.0, 0.6)$.\n- Case $3$: $(s, A) = (0.5, 0.6)$.\n- Case $4$: $(s, A) = (1.0, 0.2)$.\n- Case $5$: $(s, A) = (1.0, 1.2)$.\n- Case $6$: $(s, A) = (1.0, 0.0)$.\n\nOutput specification:\n- For each test case, compute the FWHM as defined above and report it as a floating-point number rounded to $4$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[w1,w2,w3,w4,w5,w6]”).\n\nAnswer format:\n- The final answer must be a complete, standalone Python program that runs as is and prints exactly one line in the specified format.", "solution": "The problem statement is critically validated and deemed to be valid. It is scientifically grounded in the established clock-and-wavefront model of developmental biology, well-posed with all necessary parameters and functions clearly defined, and objective in its formulation. The problem is a non-trivial computational task that is free of contradictions, ambiguities, or pseudo-profound claims. I will, therefore, proceed with a complete solution.\n\nThe objective is to compute the full width at half maximum (FWHM) of a simulated Mesp2 gene expression stripe. The model describes the Mesp2 expression profile, $M(x)$, at a fixed time point along a one-dimensional embryonic axis, $x \\in [0, L]$, where $x=0$ is the posterior and $x=L$ is the anterior.\n\nThe model is constructed as a multiplicative integration of a repression term and an activation term, representing a logical AND gate where both conditions—relief from repression and presence of an activation signal—must be met for gene expression.\n\n1.  **FGF-mediated Repression**: The Fibroblast Growth Factor (FGF) forms a posterior-to-anterior gradient, modeled as an exponential decay:\n    $$\n    F(x) = F_0 \\exp(-s x)\n    $$\n    where $F_0$ is the concentration at the posterior ($x=0$) and $s$ is the steepness of the gradient. FGF represses Mesp2. This effect is modeled as a relief-of-repression term, $R(F)$, which is a sigmoidal Hill-type function. The expression of Mesp2 is permitted where FGF concentration is low. The spatial profile of this repression relief is:\n    $$\n    R(x) = \\frac{1}{1 + \\left(\\frac{F(x)}{K_f}\\right)^{n_f}} = \\frac{1}{1 + \\left(\\frac{F_0 \\exp(-s x)}{K_f}\\right)^{n_f}}\n    $$\n    Here, $K_f$ is the FGF concentration at which its repressive effect is half-maximal, and $n_f$ is the Hill coefficient describing the cooperativity (steepness) of the response. This function is close to $0$ for large $F(x)$ (at low $x$) and approaches $1$ for small $F(x)$ (at large $x$).\n\n2.  **Clock-driven Activation**: A periodic segmentation clock provides a spatially oscillating activation signal. The instantaneous local concentration of the clock-related activator is modeled as a half-wave rectified cosine function:\n    $$\n    C(x) = \\max\\left(0, A \\cos(q x + \\phi_0)\\right)\n    $$\n    where $A$ is the amplitude of the oscillation, $q$ is the spatial wavenumber, and $\\phi_0$ is a phase offset. Transcriptional activation of Mesp2 by this signal is modeled by another Hill function, $H(C)$:\n    $$\n    H(C) = \\begin{cases}\n    \\frac{1}{1 + \\left(\\frac{K_c}{C}\\right)^{n_c}}, & C > 0 \\\\\n    0, & C \\le 0\n    \\end{cases}\n    $$\n    where $K_c$ is the activator concentration required for half-maximal activation, and $n_c$ is the Hill coefficient.\n\n3.  **Mesp2 Expression Profile**: The resulting Mesp2 expression profile, $M(x)$, is the product of the activation and repression-relief terms:\n    $$\n    M(x) = H(C(x)) \\cdot R(x)\n    $$\n    This profile will exhibit sharp stripes of expression only where $R(x)$ is significantly greater than $0$ (anterior region) AND $H(C(x))$ is significantly greater than $0$ (within a positive phase of the clock oscillation).\n\nThe numerical procedure to compute the FWHM is as follows:\n\nFirst, we define the spatial grid. The domain $[0, L]$ is discretized into $N$ points, $x_i = i \\cdot \\Delta x$ for $i = 0, 1, \\dots, N-1$, where $\\Delta x = L/(N-1)$. The following constants are used for all simulations: $L=5$, $F_0=1$, $K_f=0.2$, $n_f=4$, $q=2\\pi$, $\\phi_0=0$, $K_c=0.5$, $n_c=3$, and $N=10001$.\n\nFor each test case, defined by a pair of parameters $(s, A)$:\n1.  **Compute Profiles**: Evaluate the functions $F(x_i)$, $R(x_i)$, $C(x_i)$, $H(C(x_i))$, and $M(x_i)$ for all points $x_i$ on the grid.\n2.  **Locate Determination Front**: The determination front, $x_{\\mathrm{df}}$, is a reference position defined as the point where the FGF repression is half-lifted, i.e., $R(x_{\\mathrm{df}}) = \\tfrac{1}{2}$. This corresponds to $F(x_{\\mathrm{df}}) = K_f$. Solving for $x$ gives:\n    $$\n    x_{\\mathrm{df}} = \\frac{\\ln\\left(\\frac{F_0}{K_f}\\right)}{s}\n    $$\n3.  **Find and Select Peak**: Identify all local maxima in the computed Mesp2 profile $M(x_i)$. A point at index $i$ is a local maximum if $M_i > M_{i-1}$ and $M_i > M_{i+1}$. From the set of all found peaks, we select the one whose spatial position is closest to the calculated determination front $x_{\\mathrm{df}}$. Let this peak's index be $i_{\\text{peak}}$, its position be $x_{\\text{peak}}$, and its value be $M_{\\max} = M(x_{\\text{peak}})$. If no peaks are found or if $M_{\\max}=0$, the FWHM is defined to be $0$.\n4.  **Calculate FWHM**: The FWHM is the width of the stripe at half of its maximum height, $M_{\\text{hm}} = \\tfrac{1}{2} M_{\\max}$. We must find two points, $x_{\\text{left}}$ and $x_{\\text{right}}$, on either side of the peak where $M(x) = M_{\\text{hm}}$.\n    -   To find $x_{\\text{left}}$, we search backwards from $i_{\\text{peak}}$ to find the first grid interval $[x_{j-1}, x_j]$ that brackets the half-maximum value (i.e., $M_{j-1} \\le M_{\\text{hm}} < M_j$).\n    -   To find $x_{\\text{right}}$, we search forwards from $i_{\\text{peak}}$ to find the first grid interval $[x_k, x_{k+1}]$ that brackets the half-maximum value (i.e., $M_{k+1} \\le M_{\\text{hm}} < M_k$).\n    -   The positions $x_{\\text{left}}$ and $x_{\\text{right}}$ are then found by linear interpolation within these intervals. For two points $(x_1, y_1)$ and $(x_2, y_2)$, the interpolated position $x_{\\text{interp}}$ for a target value $y_{\\text{target}}$ is given by:\n    $$\n    x_{\\text{interp}} = x_1 + (x_2 - x_1) \\frac{y_{\\text{target}} - y_1}{y_2 - y_1}\n    $$\n    -   The FWHM is then a simple difference: FWHM $= x_{\\text{right}} - x_{\\text{left}}$.\n\nThis entire procedure is automated and executed for each of the six test cases provided, and the resulting FWHM values are aggregated.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Computes the FWHM of the Mesp2 expression stripe for a series of test cases based on\n    a minimal clock and wavefront model.\n    \"\"\"\n    # Define the constants for the simulation\n    L = 5.0\n    F0 = 1.0\n    Kf = 0.2\n    nf = 4\n    q = 2 * np.pi\n    phi0 = 0.0\n    Kc = 0.5\n    nc = 3\n    N = 10001\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.6),  # Case 1\n        (2.0, 0.6),  # Case 2\n        (0.5, 0.6),  # Case 3\n        (1.0, 0.2),  # Case 4\n        (1.0, 1.2),  # Case 5\n        (1.0, 0.0),  # Case 6\n    ]\n\n    results = []\n    \n    # Create the spatial grid\n    x = np.linspace(0, L, N)\n    dx = x[1] - x[0]\n\n    for s, A in test_cases:\n        # Step 1: Compute Mesp2 expression profile M(x)\n        \n        # FGF gradient and repression term R(x)\n        F = F0 * np.exp(-s * x)\n        R = 1.0 / (1.0 + (F / Kf)**nf)\n        \n        # Clock activation term C(x) and H(C(x))\n        C = np.maximum(0, A * np.cos(q * x + phi0))\n        \n        H = np.zeros_like(C)\n        # Avoid division by zero where C is 0\n        positive_C_mask = C > 0\n        H[positive_C_mask] = 1.0 / (1.0 + (Kc / C[positive_C_mask])**nc)\n        \n        # Mesp2 profile M(x)\n        M = H * R\n        \n        # Handle trivial case where M is identically zero\n        if np.all(M == 0):\n            results.append(0.0)\n            continue\n            \n        # Step 2: Find peaks and select the one closest to the determination front\n        \n        # Find all local maxima\n        peak_indices, _ = find_peaks(M)\n        \n        if len(peak_indices) == 0:\n            results.append(0.0)\n            continue\n        \n        # Calculate determination front position\n        x_df = np.log(F0 / Kf) / s\n        \n        # Select peak closest to x_df\n        peak_positions = x[peak_indices]\n        closest_peak_index_in_list = np.argmin(np.abs(peak_positions - x_df))\n        main_peak_index = peak_indices[closest_peak_index_in_list]\n        \n        M_max = M[main_peak_index]\n        \n        if M_max == 0:\n            results.append(0.0)\n            continue\n            \n        # Step 3: Calculate Full Width at Half Maximum (FWHM)\n        \n        M_half_max = M_max / 2.0\n        \n        # Find left crossing point by searching backwards from the peak\n        x_left = 0.0\n        found_left = False\n        for i in range(main_peak_index, 0, -1):\n            if M[i] > M_half_max and M[i-1] = M_half_max:\n                # Linear interpolation between points (i-1) and (i)\n                y1, y2 = M[i-1], M[i]\n                x1, x2 = x[i-1], x[i]\n                x_left = x1 + (x2 - x1) * (M_half_max - y1) / (y2 - y1)\n                found_left = True\n                break\n        \n        # Find right crossing point by searching forwards from the peak\n        x_right = 0.0\n        found_right = False\n        for i in range(main_peak_index, N - 1):\n            if M[i] > M_half_max and M[i+1] = M_half_max:\n                # Linear interpolation between points (i) and (i+1)\n                y1, y2 = M[i], M[i+1]\n                x1, x2 = x[i], x[i+1]\n                x_right = x1 + (x2 - x1) * (M_half_max - y1) / (y2 - y1)\n                found_right = True\n                break\n\n        # If either crossing was not found, FWHM is ill-defined.\n        # Based on the model, this should not happen for a valid peak.\n        if not found_left or not found_right:\n            fwhm = 0.0\n        else:\n            fwhm = x_right - x_left\n            \n        results.append(round(fwhm, 4))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2679198"}]}