{"hands_on_practices": [{"introduction": "Meiotic recombination is a highly regulated process that begins with an excess of potential initiation sites—DNA double-strand breaks (DSBs)—only a fraction of which mature into crossovers. This exercise [@problem_id:2652156] provides a foundational quantitative model for this process. By applying basic principles of probability, you will derive the expected numbers of different crossover types, translating a biological pathway schematic into a concrete mathematical prediction.", "problem": "In a population of meiotic nuclei, programmed deoxyribonucleic acid (DNA) double-strand breaks (DSBs) are initiated to enable homologous recombination. Each DSB can be processed into either a crossover (CO) or a non-crossover (NCO) outcome. Consider a model nucleus with a total DSB count $N$. Empirical data in many organisms support that only a fraction of DSBs are designated to mature as crossovers, while the remainder are resolved as non-crossovers. Let $f$ denote the fraction of DSBs that are designated to mature as crossovers, and assume that each designated DSB yields exactly one crossover. Crossovers can be subdivided into two mechanistic classes: class I crossovers (interference-dependent) and class II crossovers (interference-independent). In many systems, class II crossovers are dependent on the Methyl methanesulfonate and ultraviolet-sensitive protein 81 (MUS81) endonuclease. Suppose that among all crossovers, a proportion $\\beta$ proceed via the MUS81-dependent pathway and thus are class II, while the remaining proportion $1-\\beta$ are class I.\n\nAssume that crossover designation and pathway choice occur independently for each DSB designated for crossover, and that there is no competition or saturation among pathways at the scale of this nucleus. Starting from the definitions above and the basic probabilistic principle that the expected count of outcomes in a large set of independent trials equals the total number of trials times the outcome probability, derive closed-form expressions for the expected numbers of class I and class II crossovers as functions of $N$, $f$, and $\\beta$.\n\nReport your final answer as an ordered pair in the form “class I, class II” using a single analytic expression. No numerical evaluation is required, and no units are needed for counts. Do not round.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Total deoxyribonucleic acid (DNA) double-strand break (DSB) count in a model nucleus: $N$.\n- Fraction of DSBs designated to mature as crossovers: $f$.\n- Each designated DSB yields exactly one crossover.\n- Proportion of all crossovers that are class II (MUS81-dependent): $\\beta$.\n- Proportion of all crossovers that are class I: $1-\\beta$.\n- Assumptions: Crossover designation and pathway choice occur independently for each DSB. The expected count of outcomes is the total number of trials times the outcome probability.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed for validity.\n- **Scientifically Grounded:** The problem uses a simplified but standard model of meiotic recombination. The concepts of DSBs, their resolution into crossovers (COs) or non-crossovers (NCOs), and the existence of distinct mechanistic classes of crossovers (class I and class II, with MUS81 being a key factor for class II) are all well-established in molecular biology and genetics. The model is a valid abstraction for a quantitative problem.\n- **Well-Posed:** The problem provides a clear set of definitions and parameters ($N$, $f$, $\\beta$) and asks for a specific derivation of expected values. It is quantitatively formulated and has a unique mathematical solution based on the provided principles.\n- **Objective:** The language is technical, precise, and free of subjectivity.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, and objective. It contains no logical contradictions, missing information, or pseudoscientific claims. Therefore, the problem is deemed **valid**. A solution will be derived.\n\nThe task is to derive expressions for the expected numbers of class I and class II crossovers. Let $E_{\\text{I}}$ denote the expected number of class I crossovers and $E_{\\text{II}}$ denote the expected number of class II crossovers.\n\nThe derivation proceeds from the fundamental principles provided. The starting point is the total number of DSBs, which is given as $N$. These $N$ DSBs represent the total population of initial events or \"trials.\"\n\nAccording to the problem, a fraction $f$ of these DSBs are designated to mature as crossovers. The problem states we must use the principle that the expected count of an outcome is the total number of trials multiplied by the probability of that outcome.\nThe total number of trials is the total number of DSBs, $N$.\nThe probability of a single DSB being designated as a crossover is $f$.\nTherefore, the expected number of total crossovers, let us denote this $E_{\\text{CO}}$, is given by:\n$$E_{\\text{CO}} = N \\times f$$\n\nThe problem further states that each designated DSB yields exactly one crossover. This implies that the expected number of DSBs designated for crossover is equal to the expected total number of crossovers.\n\nThese total crossovers are partitioned into two classes: class I and class II.\n- A proportion $\\beta$ of all crossovers are class II.\n- A proportion $1-\\beta$ of all crossovers are class I.\n\nThe pathway choice is independent of the initial designation. Therefore, to find the expected number of crossovers in each class, we multiply the total expected number of crossovers, $E_{\\text{CO}}$, by the respective proportions.\n\nThe expected number of class II crossovers, $E_{\\text{II}}$, is the total expected number of crossovers, $E_{\\text{CO}}$, multiplied by the proportion $\\beta$:\n$$E_{\\text{II}} = E_{\\text{CO}} \\times \\beta = (N f) \\beta$$\nRearranging for convention, we write:\n$$E_{\\text{II}} = f \\beta N$$\n\nSimilarly, the expected number of class I crossovers, $E_{\\text{I}}$, is the total expected number of crossovers, $E_{\\text{CO}}$, multiplied by the proportion $(1-\\beta)$:\n$$E_{\\text{I}} = E_{\\text{CO}} \\times (1-\\beta) = (N f) (1-\\beta)$$\nRearranging for convention, we write:\n$$E_{\\text{I}} = f(1-\\beta)N$$\n\nThe problem requests the final answer as an ordered pair in the form \"class I, class II\". Thus, the ordered pair of expected values is $(E_{\\text{I}}, E_{\\text{II}})$.\nSubstituting the derived expressions, we obtain the pair:\n$(f(1-\\beta)N, f\\beta N)$\nThis represents the closed-form expressions for the expected numbers of class I and class II crossovers as functions of the given parameters $N$, $f$, and $\\beta$.", "answer": "$$\\boxed{\\begin{pmatrix} f(1-\\beta)N & f\\beta N \\end{pmatrix}}$$", "id": "2652156"}, {"introduction": "A cornerstone of molecular genetics is the ability to infer gene function by observing the consequences of its disruption. This problem [@problem_id:2652329] challenges you to think like an experimentalist, applying your integrated knowledge of the meiotic recombination pathway to predict the complex cellular and chromosomal phenotypes that arise from knocking out key genes. This practice hones your ability to reason causally through a multi-step biological process, a critical skill for designing experiments and interpreting their results.", "problem": "A research group creates three independent mouse lines to interrogate distinct control points in meiotic recombination during gametogenesis. Each line is analyzed by immunocytology on surface-spread meiocytes for synaptonemal complex components and DNA damage response markers, by counting late recombination nodules on pachytene chromosomes, by diakinesis chromosome spreads to score chiasmata, and by chromatin immunoprecipitation followed by sequencing for histone marks associated with recombination initiation sites. The lines are: a Spo11-null knockout, a Prdm9 allele-replacement line homozygous for a zinc-finger array that recognizes a different DNA motif than the wild type allele, and a MutSγ-null line (loss of the MSH4–MSH5 heterodimer).\n\nUsing only the following foundational facts: in mammals, homolog pairing and synapsis are normally triggered by programmed meiotic double-strand breaks catalyzed by Spo11; the PR/SET domain protein PRDM9 deposits histone H3 lysine tri-methylation and directs where Spo11-induced breaks are positioned by binding sequence motifs with its zinc-finger domain; and MutSγ (MSH4–MSH5) stabilizes interhomolog recombination intermediates that mature into the interference-dependent class I crossover pathway, whereas a minor, interference-insensitive class II pathway can operate via structure-selective nucleases, choose the option that best predicts the integrated molecular and cytological outcomes for all three lines.\n\nOptions:\n\nA. \n- Spo11 knockout: absence of RAD51/DMC1 foci, widespread asynapsis with HORMAD1 retained on chromosome axes, loss of MLH1 foci and chiasmata, defective meiotic sex chromosome inactivation and apoptotic arrest at a zygotene-like stage.\n- Prdm9 allele swap (homozygous): global reduction in double-strand break number, retargeting of breaks to promoter-associated histone marks, and widespread asynapsis.\n- MutSγ loss: normal double-strand break formation and synapsis, severe reduction of class I crossovers with loss of MLH1 foci, residual noninterfering crossovers, and abundant univalents at the first meiotic division.\n\nB.\n- Spo11 knockout: failure to form programmed double-strand breaks evidenced by near absence of RAD51/DMC1 and $\\gamma$H2AX on autosomes, persistence of HORMAD1 on unsynapsed axes with extensive asynapsis and minimal or aberrant synaptonemal complex, no MLH1 foci and no chiasmata with checkpoint-mediated arrest.\n- Prdm9 allele swap (homozygous): redistribution of PRDM9-dependent H3K4me3 and double-strand break hotspots to the new zinc-finger motif with homeostatically maintained break load, preservation of homolog synapsis and crossover numbers when both homologs carry the same swapped allele, and progressive erosion of hotspot motifs at the new sites over generations by biased gene conversion.\n- MutSγ loss: normal formation of double-strand breaks and early strand-exchange foci, partial synapsis with unstable interhomolog engagement, failure of designated recombination sites to mature into MLH1-marked class I crossovers with loss of crossover interference, few or no chiasmata at diakinesis, and univalents triggering the spindle assembly checkpoint at the first meiotic division.\n\nC.\n- Spo11 knockout: synapsis proceeds largely normally by a double-strand break–independent pathway, MLH1 foci are maintained by compensatory mechanisms, and fertility is largely preserved.\n- Prdm9 allele swap (homozygous): abolition of H3K4me3 at hotspots because PRDM9 is not present at its canonical sites, leading to loss of double-strand breaks and promoter-proximal repair.\n- MutSγ loss: persistent RAD51/DMC1 foci due to arrested repair but normal bivalent formation owing to complete compensation by class II crossovers.\n\nD.\n- Spo11 knockout: accumulation of excessive double-strand breaks with pan-nuclear $\\gamma$H2AX, hyper-recombination, and pachytene arrest despite normal chiasmata.\n- Prdm9 allele swap (homozygous): male-limited hybrid sterility caused by asymmetric hotspot usage even in a non-hybrid background, severe asynapsis, and loss of double-strand breaks.\n- MutSγ loss: increased crossing over due to upregulation of structure-selective nucleases, elevated MLH1 foci, and enhanced crossover interference.\n\nWhich option is most consistent with the stated foundational facts and the expected logic of pathway dependencies in mammalian meiosis? Select one best answer.", "solution": "The problem requires an integrated prediction of molecular and cytological phenotypes for three distinct mouse mutations affecting meiotic recombination, based on a provided set of foundational principles. The validity of the problem statement must be established first.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n\n*   **Mutant Lines:**\n    1.  `Spo11-null` knockout.\n    2.  `Prdm9` allele-replacement line, homozygous for a zinc-finger array recognizing a different DNA motif.\n    3.  `MutSγ-null` line (loss of the `MSH4`–`MSH5` heterodimer).\n*   **Foundational Facts:**\n    1.  In mammals, `Spo11`-catalyzed programmed meiotic double-strand breaks (DSBs) normally trigger homolog pairing and synapsis.\n    2.  `PRDM9` deposits histone H3 lysine 4 tri-methylation (`H3K4me3`) and directs where `Spo11`-induced breaks are positioned by binding to specific DNA motifs.\n    3.  `MutSγ` (the `MSH4`–`MSH5` heterodimer) is essential for stabilizing interhomolog recombination intermediates that mature into the interference-dependent class I crossover pathway.\n    4.  A minor, interference-insensitive class II crossover pathway exists, which operates via structure-selective nucleases.\n*   **Question:** Identify the option that best predicts the outcomes for all three lines based on these facts and logical pathway dependencies.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is scientifically sound, well-posed, and objective. It describes standard genetic models used in meiosis research (`Spo11` knockout, `Prdm9` allele modification, `MutSγ` knockout). The \"foundational facts\" are accurate, established principles of mammalian meiosis. The task is to deduce the logical consequences of these specific genetic perturbations, which is a standard exercise in genetics and cell biology. The problem is not ambiguous, contradictory, or trivial. It requires a substantive understanding of the causal chain of events in meiotic recombination.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be derived by analyzing each mutation and then evaluating the provided options.\n\n**Derivation of Predicted Phenotypes**\n\n**1. `Spo11-null` Knockout:**\n*   **Principle:** `Spo11` is the evolutionarily conserved transesterase that catalyzes the formation of meiotic DSBs. According to foundational fact $1$, these DSBs are the initiating lesions for homologous recombination and are required for homolog pairing and synapsis in mammals.\n*   **Prediction:** In a `Spo11-null` mutant, no programmed meiotic DSBs will be formed.\n*   **Consequences:**\n    *   **Molecular:** There will be a near-total absence of DSB markers on autosomes, such as $\\gamma$H2AX and the strand-exchange proteins `RAD51` and `DMC1`.\n    *   **Cytological:** The absence of DSBs leads to a catastrophic failure of homolog pairing and synapsis of homologous chromosomes. Chromosome axes will form but remain as unsynapsed univalents. Markers of unsynapsed axes, such as `HORMAD1`, will persist. Since recombination is not initiated, no crossover intermediates can form. Consequently, there will be a complete loss of late recombination nodules, which are marked by proteins such as `MLH1`, and a complete absence of chiasmata at diakinesis/metaphase I.\n    *   **Cell Fate:** The meiotic prophase checkpoint stringently monitors both DSB repair and synapsis. Widespread asynapsis triggers checkpoint-mediated apoptosis, typically arresting development at a zygotene-like stage.\n\n**2. `Prdm9` Allele-Replacement (Homozygous):**\n*   **Principle:** Foundational fact $2$ states `PRDM9` determines the location of DSBs by binding to specific DNA motifs and depositing H3K4me3, which then licenses `Spo11` activity. The engineered allele has a zinc-finger domain that recognizes a *new* set of motifs. The mouse line is homozygous for this new allele.\n*   **Prediction:** The locations of `PRDM9` binding, H3K4me3 deposition, and subsequent DSBs will be redistributed from the wild-type hotspots to the new motifs recognized by the engineered zinc-finger domain.\n*   **Consequences:**\n    *   **Molecular:** The overall number of DSBs is subject to homeostatic regulation and is expected to remain relatively constant. The critical point is that the line is homozygous. Both homologous chromosomes carry the same set of new hotspot motifs. This symmetry ensures that DSBs are formed at corresponding positions on both homologs, facilitating efficient recognition and strand exchange. Over evolutionary or experimental time, the new hotspot motifs would be subject to erosion through biased gene conversion, a known phenomenon associated with `PRDM9` activity.\n    *   **Cytological:** Because DSBs are formed at homologous locations on both parental chromosomes, homolog pairing, synapsis, and crossover formation should proceed with high efficiency. Crossover numbers and chiasma frequencies are expected to be similar to wild type. Widespread asynapsis is characteristic of *heterozygosity* for different `Prdm9` alleles, not homozygosity.\n\n**3. `MutSγ-null` (loss of `MSH4`–`MSH5`):**\n*   **Principle:** Foundational facts $3$ and $4$ specify that `MutSγ` is required for the major, interference-dependent class I crossover pathway, while a minor, class II pathway remains functional.\n*   **Prediction:** The class I crossover pathway will be ablated, leaving only the minor class II pathway.\n*   **Consequences:**\n    *   **Molecular:** DSB formation by `Spo11` and initial strand invasion, marked by `RAD51`/`DMC1` foci, will be normal. The defect is downstream, at the step of stabilizing recombination intermediates and designating them for maturation as class I crossovers. As `MLH1` is a specific marker for maturing class I sites, `MLH1` foci will be absent or severely reduced.\n    *   **Cytological:** While synapsis may initiate, the stability of interhomolog interactions can be compromised. Most importantly, the total number of crossovers will be drastically reduced (by approximately $80-90\\%$). The remaining crossovers are generated by the class II pathway and lack interference. The severe reduction in crossovers leads to a failure to form chiasmata for many or most chromosome pairs. These chromosomes will appear as achiasmate univalents at diakinesis and metaphase I.\n    *   **Cell Fate:** The presence of numerous univalents at metaphase I will trigger the spindle assembly checkpoint, leading to meiotic arrest and apoptosis.\n\n**Evaluation of Options**\n\n*   **Option A:**\n    *   `Spo11` knockout: The description is correct.\n    *   `Prdm9` allele swap: This description is incorrect. It incorrectly claims a \"global reduction in double-strand break number\" and \"widespread asynapsis\", which contradicts the expected outcome for a homozygous allele swap. It also misattributes the default retargeting to promoter regions (a `Prdm9-null` phenotype) to this allele swap scenario.\n    *   `MutSγ` loss: The description is largely correct.\n    *   **Verdict:** **Incorrect**. The description for the `Prdm9` line is fundamentally flawed.\n\n*   **Option B:**\n    *   `Spo11` knockout: This description is precise and accurate. It correctly mentions the absence of DSBs, the lack of `RAD51`/`DMC1` and $\\gamma$H2AX foci, persistent `HORMAD1`, asynapsis, absence of `MLH1`/chiasmata, and checkpoint arrest.\n    *   `Prdm9` allele swap (homozygous): This description is highly accurate and sophisticated. It correctly states that DSBs and H3K4me3 are redistributed, the break number is homeostatically maintained, synapsis and crossover numbers are preserved in the homozygous state, and it correctly mentions the long-term consequence of biased gene conversion.\n    *   `MutSγ` loss: This description is excellent. It correctly identifies normal DSB formation, the downstream failure of class I crossover maturation (`MLH1`), the loss of interference, the resulting univalents at the first meiotic division, and subsequent checkpoint arrest. The mention of \"partial synapsis with unstable interhomolog engagement\" is a nuanced and accurate detail.\n    *   **Verdict:** **Correct**. All three descriptions are fully consistent with the foundational principles and established experimental facts.\n\n*   **Option C:**\n    *   `Spo11` knockout: This is entirely incorrect. It claims normal synapsis and preserved fertility, directly contradicting foundational fact $1$ and all known data for `Spo11` knockouts in mammals.\n    *   `Prdm9` allele swap: This misinterprets an allele swap as a knockout, incorrectly claiming \"abolition of H3K4me3\" and \"loss of double-strand breaks\".\n    *   `MutSγ` loss: This is incorrect. It wrongly claims \"normal bivalent formation\" due to \"complete compensation\", which does not happen. Class II crossovers are a minor pathway.\n    *   **Verdict:** **Incorrect**. All three descriptions contain severe errors.\n\n*   **Option D:**\n    *   `Spo11` knockout: This description is the opposite of the known phenotype. A `Spo11` knockout *lacks* DSBs; it does not have \"excessive\" DSBs.\n    *   `Prdm9` allele swap: This description incorrectly applies the phenotype of a hybrid or heterozygote (\"hybrid sterility caused by asymmetric hotspot usage\") to a homozygous, non-hybrid background.\n    *   `MutSγ` loss: This description is the opposite of reality. It claims \"increased crossing over\", \"elevated MLH1 foci\", and \"enhanced crossover interference\", whereas the actual outcome is a severe decrease in crossovers, loss of `MLH1` foci, and loss of interference.\n    *   **Verdict:** **Incorrect**. All three descriptions are factually wrong, often stating the exact opposite of what occurs.\n\nBased on this rigorous analysis, Option B is the only one that provides a scientifically correct and consistent set of predictions for all three mutant lines.", "answer": "$$\\boxed{B}$$", "id": "2652329"}, {"introduction": "Moving from qualitative models to quantitative analysis is essential for modern biology. One of the most fascinating features of meiosis is crossover interference, and quantifying its strength is a classic problem in genetics. This hands-on computational exercise [@problem_id:2652310] guides you through the process of fitting a widely used statistical model to data on crossover positions, using the powerful method of maximum likelihood estimation to extract a key biological parameter. This task provides a practical link between theoretical concepts, experimental data, and computational analysis.", "problem": "You are given a modeling and estimation task grounded in meiosis. In pachytene nuclei, MutL Homolog 1 (MLH1) immunofoci mark class I crossovers, which exhibit spatial interference. The beam-film interference model posits that mechanical stress along the synaptonemal complex (SC) spreads and inhibits nearby crossover designation, yielding overdispersed interfocus spacings relative to a memoryless process. As a mathematical abstraction on a circularized bivalent (to remove boundary effects), model MLH1 focus positions as a stationary renewal process whose independent and identically distributed inter-event distances follow a gamma distribution with shape parameter $k$ (interference strength) and scale parameter $\\theta$, with probability density function\n$$\nf(x \\mid k,\\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\Gamma(k)\\,\\theta^k}, \\quad x>0,\\; k>0,\\; \\theta>0.\n$$\nIn this abstraction, $k$ quantifies interference strength: $k=1$ corresponds to an exponential waiting-time distribution (no interference), and larger $k$ indicates stronger interference and more regular spacing.\n\nStarting from the assumptions of a stationary renewal process on a circle and the gamma model above, derive a maximum likelihood estimator for $k$ and implement a robust numerical solver to compute it from synthetic MLH1 interfocus spacing data. For given data $\\{x_i\\}_{i=1}^{n}$, the nuisance parameter $\\theta$ should be profiled out, and only the interference strength $k$ is required as the final reported estimate per dataset.\n\nYour program must:\n- Generate synthetic datasets for MLH1 interfocus spacings by sampling independent and identically distributed values $x_i \\sim \\mathrm{Gamma}(k_{\\text{true}},\\theta_{\\text{true}})$ using a fixed pseudorandom seed for reproducibility. Use NumPy's parameterization where the gamma distribution takes a shape parameter equal to $k$ and a scale parameter equal to $\\theta$.\n- For each dataset, compute the maximum likelihood estimate $\\hat{k}$ via solving the first-order condition. Use a numerically stable root-finding method with appropriate safeguards to ensure $k>0$ and convergence when $n$ is small or the variance is near zero.\n- Return the list of estimated interference strengths $\\hat{k}$ for all test cases, each rounded to exactly three decimal places.\n\nScientific base assumptions you may use:\n- Crossovers along the SC can be modeled as a renewal process with independent inter-event spacings on a circularized domain, so that the likelihood of observed spacings factorizes as a product of univariate densities.\n- The gamma family is a well-tested phenomenological model for interference, where $k$ encodes interference strength.\n\nData generation test suite:\nFor each case, generate $n$ samples with the specified $(k_{\\text{true}},\\theta_{\\text{true}})$ and seed. All quantities are dimensionless.\n\n- Case A (general, moderate interference): $n=200$, $k_{\\text{true}}=3.5$, $\\theta_{\\text{true}}=0.3$, seed $=42$.\n- Case B (boundary near no interference): $n=400$, $k_{\\text{true}}=1.0$, $\\theta_{\\text{true}}=0.5$, seed $=31415$.\n- Case C (strong interference and larger sample): $n=800$, $k_{\\text{true}}=8.0$, $\\theta_{\\text{true}}=0.15$, seed $=271828$.\n- Case D (small-sample edge case): $n=12$, $k_{\\text{true}}=2.2$, $\\theta_{\\text{true}}=0.4$, seed $=7$.\n\nAngle units are not applicable. There are no physical units in this problem; all distances are unitless.\n\nFinal output format:\n- Your program should produce a single line of output containing the estimated interference strengths $\\hat{k}$ for Cases A–D, in order, as a comma-separated list enclosed in square brackets, with each value rounded to exactly three decimal places (for example, $\\texttt{[3.487,1.012,7.951,2.034]}$). No other text should be printed.", "solution": "The problem statement is scientifically grounded, self-contained, and well-posed. It presents a standard parameter estimation task from mathematical statistics, applied to a recognized model in developmental biology concerning meiotic crossovers. The model, data generation procedure, and objective are all defined with sufficient precision to permit a unique and verifiable solution. Thus, the problem is deemed valid. We proceed with the derivation and implementation of the required estimator.\n\nThe task is to find the maximum likelihood estimate (MLE) of the shape parameter $k$ of a gamma distribution for a given dataset of inter-focus spacings $\\{x_i\\}_{i=1}^{n}$. The spacings are modeled as independent and identically distributed (i.i.d.) random variables from a gamma distribution with probability density function (PDF):\n$$\nf(x \\mid k, \\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\Gamma(k)\\theta^k}, \\quad x > 0, k > 0, \\theta > 0\n$$\nwhere $k$ is the shape parameter (interference strength) and $\\theta$ is the scale parameter.\n\nFirst, we construct the log-likelihood function. Given $n$ i.i.d. observations $\\{x_i\\}_{i=1}^{n}$, the likelihood function is the product of the individual PDFs:\n$$\nL(k, \\theta \\mid \\{x_i\\}) = \\prod_{i=1}^{n} f(x_i \\mid k, \\theta) = \\frac{\\left(\\prod_{i=1}^{n} x_i\\right)^{k-1} \\exp\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\\right)}{\\left(\\Gamma(k)\\theta^k\\right)^n}\n$$\nThe log-likelihood function, $\\ell(k, \\theta) = \\ln L(k, \\theta)$, is more convenient for maximization:\n$$\n\\ell(k, \\theta) = \\sum_{i=1}^{n} \\left[ (k-1)\\ln x_i - \\frac{x_i}{\\theta} - \\ln\\Gamma(k) - k\\ln\\theta \\right]\n$$\nThis can be expressed using the sample arithmetic mean, $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$, and the sample geometric mean, whose logarithm is $\\frac{1}{n}\\sum_{i=1}^{n} \\ln x_i = \\ln \\tilde{x}$:\n$$\n\\ell(k, \\theta) = n(k-1)\\ln\\tilde{x} - \\frac{n\\bar{x}}{\\theta} - n\\ln\\Gamma(k) - nk\\ln\\theta\n$$\n\nThe parameter $\\theta$ is a nuisance parameter. To find the MLE for $k$, we first derive the profile log-likelihood for $k$ by maximizing $\\ell(k, \\theta)$ with respect to $\\theta$ for a fixed $k$. We find the partial derivative of $\\ell$ with respect to $\\theta$ and set it to zero:\n$$\n\\frac{\\partial \\ell}{\\partial \\theta} = \\frac{n\\bar{x}}{\\theta^2} - \\frac{nk}{\\theta} = 0\n$$\nSolving for $\\theta$ yields its MLE as a function of $k$:\n$$\n\\hat{\\theta}(k) = \\frac{\\bar{x}}{k}\n$$\n\nNext, we substitute $\\hat{\\theta}(k)$ back into the log-likelihood function to obtain the profile log-likelihood, $\\ell_p(k)$:\n$$\n\\ell_p(k) = \\ell(k, \\hat{\\theta}(k)) = n(k-1)\\ln\\tilde{x} - \\frac{n\\bar{x}}{(\\bar{x}/k)} - n\\ln\\Gamma(k) - nk\\ln\\left(\\frac{\\bar{x}}{k}\\right)\n$$\n$$\n\\ell_p(k) = n(k-1)\\ln\\tilde{x} - nk - n\\ln\\Gamma(k) - nk(\\ln\\bar{x} - \\ln k)\n$$\n$$\n\\ell_p(k) = n \\left[ (k-1)\\ln\\tilde{x} - k - \\ln\\Gamma(k) - k\\ln\\bar{x} + k\\ln k \\right]\n$$\n\nTo find the MLE $\\hat{k}$, we differentiate $\\ell_p(k)$ with respect to $k$ and set the result to zero. The derivative requires the digamma function, $\\psi(k) = \\frac{d}{dk}\\ln\\Gamma(k)$.\n$$\n\\frac{d\\ell_p}{dk} = n \\left[ \\ln\\tilde{x} - 1 - \\psi(k) - \\ln\\bar{x} + (\\ln k + 1) \\right] = n \\left[ \\ln\\tilde{x} - \\psi(k) - \\ln\\bar{x} + \\ln k \\right]\n$$\nSetting the derivative to zero gives the first-order condition for $\\hat{k}$:\n$$\n\\ln\\hat{k} - \\psi(\\hat{k}) = \\ln\\bar{x} - \\ln\\tilde{x} = \\ln\\left(\\frac{\\bar{x}}{\\tilde{x}}\\right)\n$$\nThis equation cannot be solved for $\\hat{k}$ in closed form. A numerical root-finding method is required. Let $S = \\ln(\\bar{x}/\\tilde{x})$. We must find the root of the function:\n$$\ng(k) = \\ln k - \\psi(k) - S = 0\n$$\n\nThe function $h(k) = \\ln k - \\psi(k)$ is a strictly monotonically decreasing function for $k>0$, with limits $h(k) \\to \\infty$ as $k \\to 0^+$ and $h(k) \\to 0$ as $k \\to \\infty$. By the arithmetic mean-geometric mean inequality, $\\bar{x} \\ge \\tilde{x}$, which implies $S \\ge 0$. For any strictly positive sample variance, $S>0$, ensuring a unique solution $\\hat{k} \\in (0, \\infty)$ exists.\n\nFor numerical implementation, we use a robust root-finding algorithm, such as Brent's method, available in `scipy.optimize.brentq`. This method requires a search interval $[a, b]$ where $g(a)$ and $g(b)$ have opposite signs. Since $g(k \\to 0^+) \\to \\infty$ and $g(k \\to \\infty) \\to -S < 0$, such an interval always exists. We can choose a small positive lower bound (e.g., $10^{-6}$) and a sufficiently large upper bound (e.g., $10^8$).\n\nA special case arises when the sample variance is near zero. In this situation, $\\bar{x} \\approx \\tilde{x}$, so $S$ is a very small positive number. The equation $h(k) = S$ then yields a very large $\\hat{k}$. For large $k$, the asymptotic expansion $\\psi(k) \\approx \\ln k - \\frac{1}{2k}$ is accurate, leading to $h(k) \\approx \\frac{1}{2k}$. The solution is thus approximated by $\\hat{k} \\approx \\frac{1}{2S}$. To ensure numerical stability and robust convergence, if $S$ is below a small threshold (e.g., $10^{-7}$), we can use this approximation directly instead of the iterative solver, which may struggle with the very large root and flat function profile. This approach correctly handles the \"variance is near zero\" condition specified in the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import digamma\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating the gamma distribution shape parameter k\n    for multiple synthetic datasets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n, k_true, theta_true, seed)\n        (200, 3.5, 0.3, 42),      # Case A\n        (400, 1.0, 0.5, 31415),  # Case B\n        (800, 8.0, 0.15, 271828), # Case C\n        (12, 2.2, 0.4, 7),        # Case D\n    ]\n\n    results = []\n    \n    # A small threshold for S to switch to the large-k approximation.\n    # This ensures numerical stability for near-zero variance data.\n    S_THRESHOLD = 1e-7\n    \n    # Search bracket for the root-finding algorithm.\n    LOWER_BOUND = 1e-6\n    UPPER_BOUND = 1e8\n\n    for n, k_true, theta_true, seed in test_cases:\n        # 1. Generate synthetic data\n        rng = np.random.default_rng(seed)\n        spacings = rng.gamma(shape=k_true, scale=theta_true, size=n)\n\n        # 2. Calculate sufficient statistics\n        # Ensure all spacings are positive to avoid log(0)\n        spacings = spacings[spacings > 0]\n        if spacings.size == 0:\n            # This case is highly unlikely but would make estimation impossible.\n            # We would append an error marker, e.g., np.nan, but problem constraints suggest valid data.\n            # For this problem, we assume this will not happen.\n            pass\n\n        mean_x = np.mean(spacings)\n        mean_log_x = np.mean(np.log(spacings))\n        \n        # This is the key statistic for estimating k\n        s = np.log(mean_x) - mean_log_x\n\n        # 3. Compute the maximum likelihood estimate for k\n        k_hat = 0.0\n        \n        if s  S_THRESHOLD:\n            # For very small s (near-zero variance), k is very large.\n            # Use the asymptotic approximation k_hat ~ 0.5 / s to avoid numerical issues.\n            k_hat = 0.5 / s\n        else:\n            # Define the function whose root is the MLE for k.\n            # g(k) = ln(k) - digamma(k) - s\n            def g(k_var):\n                return np.log(k_var) - digamma(k_var) - s\n\n            try:\n                # Use Brent's method to find the root. It is robust and efficient.\n                k_hat = brentq(g, LOWER_BOUND, UPPER_BOUND)\n            except ValueError:\n                # This may happen if g(LOWER_BOUND) and g(UPPER_BOUND) don't have opposite signs.\n                # Given the properties of g(k), this is unlikely with the chosen bounds\n                # unless s is extremely small (handled by the approximation) or large.\n                # If it occurs, it indicates an issue with the data or bounds.\n                # For this problem, we assume the standard case holds.\n                k_hat = np.nan # Placeholder for an error case\n\n        results.append(k_hat)\n\n    # 4. Format the final output\n    # Round each result to exactly three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2652310"}]}