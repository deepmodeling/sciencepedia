{"hands_on_practices": [{"introduction": "The study of calcium waves begins with accurate measurement. This exercise guides you through the fundamental process of converting raw photon counts from a Förster Resonance Energy Transfer (FRET) biosensor into a quantitative calcium concentration, a cornerstone of modern cell biology. By also propagating the inherent photon shot noise, you will learn to critically assess the confidence in your measurement, an essential skill for rigorous experimental analysis.", "problem": "A fertilization-triggered calcium wave is imaged in a single Xenopus laevis egg expressing a genetically encoded Förster Resonance Energy Transfer (FRET) calcium biosensor with a cyan fluorescent protein donor and yellow fluorescent protein acceptor. At one pixel on the advancing wavefront, the background- and bleedthrough-corrected photon counts during a single exposure are measured as follows: donor channel counts $N_{C} = 3200$ and acceptor channel counts $N_{Y} = 4000$. The ratiometric readout is computed as the acceptor-to-donor photon ratio $R = N_{Y}/N_{C}$. The biosensor has been calibrated in situ in the same egg under steady-state conditions to yield a low-calcium ratio $R_{\\min} = 0.80$ and a high-calcium ratio $R_{\\max} = 2.00$. The dissociation constant determined for this sensor in the cytosolic environment is $K_{d} = 300\\,\\mathrm{nM}$. Assume the following foundational bases:\n\n- Under a single-site binding equilibrium, the fraction of biosensor in the calcium-bound state is $f = [\\mathrm{Ca}^{2+}]/(K_{d} + [\\mathrm{Ca}^{2+}])$.\n- The FRET ratio responds linearly to occupancy, so that the measured ratio satisfies $R = R_{\\min} + (R_{\\max} - R_{\\min}) f$ at steady state.\n- Photon detection is limited by shot noise: $N_{Y}$ and $N_{C}$ are independent Poisson random variables with means equal to their observed values for the purpose of uncertainty estimation. Other noise sources are negligible over this exposure.\n\nUsing only these assumptions and first principles, derive the cytosolic free calcium concentration $[\\mathrm{Ca}^{2+}]$ at this pixel from the measured ratio and propagate the shot noise to obtain the approximate two-sided $95\\%$ confidence interval half-width for $[\\mathrm{Ca}^{2+}]$ via first-order error propagation.\n\nReport only the $95\\%$ confidence interval half-width for $[\\mathrm{Ca}^{2+}]$ in nanomolar. Round your answer to three significant figures and express the result in nanomolar (nM).", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It contains all necessary information and is free of contradictions or ambiguities. It describes a standard biophysical analysis and is therefore valid. We proceed with the solution.\n\nThe objective is to calculate the cytosolic free calcium concentration, $[\\mathrm{Ca}^{2+}]$, and its associated $95\\%$ confidence interval half-width from the provided photon count data.\n\nFirst, we calculate the FRET ratio, $R$, which is defined as the ratio of acceptor-to-donor photon counts, $N_{Y}$ to $N_{C}$.\nGiven $N_{Y} = 4000$ and $N_{C} = 3200$, the ratio is:\n$$R = \\frac{N_{Y}}{N_{C}} = \\frac{4000}{3200} = 1.25$$\n\nNext, we determine the fraction of the biosensor in the calcium-bound state, $f$. The problem states that the FRET ratio, $R$, responds linearly to the fractional occupancy, $f$, according to the relation:\n$$R = R_{\\min} + (R_{\\max} - R_{\\min}) f$$\nwhere $R_{\\min} = 0.80$ is the ratio at zero calcium and $R_{\\max} = 2.00$ is the ratio at saturating calcium. We can solve for $f$:\n$$f = \\frac{R - R_{\\min}}{R_{\\max} - R_{\\min}}$$\nSubstituting the values:\n$$f = \\frac{1.25 - 0.80}{2.00 - 0.80} = \\frac{0.45}{1.20} = 0.375$$\n\nWith the fractional occupancy, we can now calculate the free calcium concentration, $[\\mathrm{Ca}^{2+}]$. The relationship is given by the single-site binding equilibrium model:\n$$f = \\frac{[\\mathrm{Ca}^{2+}]}{K_{d} + [\\mathrm{Ca}^{2+}]}$$\nwhere the dissociation constant is $K_{d} = 300\\,\\mathrm{nM}$. Solving for $[\\mathrm{Ca}^{2+}]$:\n$$f(K_{d} + [\\mathrm{Ca}^{2+}]) = [\\mathrm{Ca}^{2+}]$$\n$$f K_{d} = [\\mathrm{Ca}^{2+}] (1 - f)$$\n$$[\\mathrm{Ca}^{2+}] = K_{d} \\frac{f}{1 - f}$$\nSubstituting the known values for $K_{d}$ and $f$:\n$$[\\mathrm{Ca}^{2+}] = (300\\,\\mathrm{nM}) \\frac{0.375}{1 - 0.375} = (300\\,\\mathrm{nM}) \\frac{0.375}{0.625} = (300\\,\\mathrm{nM}) \\times 0.6 = 180\\,\\mathrm{nM}$$\n\nThe second part of the problem requires calculating the uncertainty in this value. We use first-order error propagation, also known as the delta method. The uncertainty in $[\\mathrm{Ca}^{2+}]$ arises from the statistical fluctuations (shot noise) in the photon counts $N_{Y}$ and $N_{C}$. The problem states these are independent Poisson random variables, for which the variance is equal to the mean. We approximate the mean by the observed count.\n$$\\sigma_{N_{Y}}^{2} = N_{Y} = 4000$$\n$$\\sigma_{N_{C}}^{2} = N_{C} = 3200$$\n\nWe first propagate these uncertainties to the ratio, $R = N_{Y}/N_{C}$. For independent variables, the variance of the ratio, $\\sigma_{R}^{2}$, is given by:\n$$\\sigma_{R}^{2} \\approx R^{2} \\left[ \\left(\\frac{\\sigma_{N_{Y}}}{N_{Y}}\\right)^{2} + \\left(\\frac{\\sigma_{N_{C}}}{N_{C}}\\right)^{2} \\right] = R^{2} \\left[ \\frac{\\sigma_{N_{Y}}^{2}}{N_{Y}^{2}} + \\frac{\\sigma_{N_{C}}^{2}}{N_{C}^{2}} \\right]$$\nSubstituting $\\sigma_{N_{Y}}^{2} = N_{Y}$ and $\\sigma_{N_{C}}^{2} = N_{C}$:\n$$\\sigma_{R}^{2} = R^{2} \\left[ \\frac{1}{N_{Y}} + \\frac{1}{N_{C}} \\right]$$\nNumerically:\n$$\\sigma_{R}^{2} = (1.25)^{2} \\left[ \\frac{1}{4000} + \\frac{1}{3200} \\right] = 1.5625 \\left( 0.00025 + 0.0003125 \\right) = 1.5625 (0.0005625) = 0.00087890625$$\n\nNext, we propagate the uncertainty from $R$ to $[\\mathrm{Ca}^{2+}]$. The variance of $[\\mathrm{Ca}^{2+}]$, denoted $\\sigma_{[\\mathrm{Ca}^{2+}]}^{2}$, is:\n$$\\sigma_{[\\mathrm{Ca}^{2+}]}^{2} \\approx \\left( \\frac{d[\\mathrm{Ca}^{2+}]}{dR} \\right)^{2} \\sigma_{R}^{2}$$\nWe must find the derivative $\\frac{d[\\mathrm{Ca}^{2+}]}{dR}$. Using the chain rule, $\\frac{d[\\mathrm{Ca}^{2+}]}{dR} = \\frac{d[\\mathrm{Ca}^{2+}]}{df} \\frac{df}{dR}$.\nThe first derivative is:\n$$\\frac{df}{dR} = \\frac{d}{dR}\\left( \\frac{R - R_{\\min}}{R_{\\max} - R_{\\min}} \\right) = \\frac{1}{R_{\\max} - R_{\\min}} = \\frac{1}{2.00 - 0.80} = \\frac{1}{1.20}$$\nThe second derivative is:\n$$\\frac{d[\\mathrm{Ca}^{2+}]}{df} = \\frac{d}{df}\\left( K_{d} \\frac{f}{1 - f} \\right) = K_{d} \\frac{(1)(1 - f) - (f)(-1)}{(1 - f)^{2}} = \\frac{K_{d}}{(1 - f)^{2}}$$\nAt $f = 0.375$, this is:\n$$\\frac{d[\\mathrm{Ca}^{2+}]}{df} = \\frac{300\\,\\mathrm{nM}}{(1-0.375)^{2}} = \\frac{300\\,\\mathrm{nM}}{(0.625)^{2}} = \\frac{300\\,\\mathrm{nM}}{0.390625} = 768\\,\\mathrm{nM}$$\nCombining these results for the total derivative:\n$$\\frac{d[\\mathrm{Ca}^{2+}]}{dR} = \\frac{d[\\mathrm{Ca}^{2+}]}{df} \\frac{df}{dR} = (768\\,\\mathrm{nM}) \\left( \\frac{1}{1.20} \\right) = 640\\,\\mathrm{nM}$$\nNow we can compute the standard deviation of the calcium concentration, $\\sigma_{[\\mathrm{Ca}^{2+}]}$:\n$$\\sigma_{[\\mathrm{Ca}^{2+}]} = \\left| \\frac{d[\\mathrm{Ca}^{2+}]}{dR} \\right| \\sigma_{R} = (640\\,\\mathrm{nM}) \\sqrt{0.00087890625} \\approx (640\\,\\mathrm{nM})(0.02964635) \\approx 18.97366\\,\\mathrm{nM}$$\n\nThe problem asks for the two-sided $95\\%$ confidence interval half-width. For a Normal approximation, this is given by $z \\times \\sigma$, where $z \\approx 1.96$ for a $95\\%$ confidence level.\n$$ \\text{Half-width} = 1.96 \\times \\sigma_{[\\mathrm{Ca}^{2+}]} \\approx 1.96 \\times 18.97366\\,\\mathrm{nM} \\approx 37.18838\\,\\mathrm{nM} $$\nRounding to three significant figures as requested, the half-width is $37.2\\,\\mathrm{nM}$.", "answer": "$$\\boxed{37.2}$$", "id": "2678609"}, {"introduction": "Once we can measure the features of calcium oscillations, such as their period and amplitude, the next step is to understand how cellular machinery controls them. This practice demonstrates the power of a minimal mathematical model to link observable signal dynamics to the underlying activities of key enzymes like phospholipase C (PLC) and SERCA pumps. You will use this model with parameters $k_{\\mathrm{prod}}$ and $v_{\\mathrm{SERCA}}$ to interpret experimental data and deduce the target of a pharmacological agent, a classic example of using theory to guide experimental inquiry.", "problem": "An unfertilized vertebrate egg exhibits repetitive cytosolic calcium transients that initiate egg activation. Consider a minimal mechanistic representation that captures two robust, widely observed features of egg calcium oscillations:\n\n(i) Between spikes, Sarco/Endoplasmic Reticulum Calcium ATPase (SERCA) pumps refill the endoplasmic reticulum store at an approximately constant rate, denoted by $v_{\\mathrm{SERCA}}$, so that the store content increases linearly with time over the interspike interval. At each spike, inositol trisphosphate receptors ($IP_3R$) discharge a fraction of the store, producing a cytosolic calcium transient whose peak amplitude $A$ is proportional to the released store content. Let the proportionality constant be $g>0$, so the release per spike $\\Delta S$ and amplitude satisfy $A = g \\, \\Delta S$.\n\n(ii) The trigger for a spike is the accumulation of inositol 1,4,5-trisphosphate ($IP_3$) to a threshold value $I_{\\mathrm{th}}$ that activates $IP_3R$. Between spikes, the $IP_3$ concentration $I(t)$ rises approximately linearly at a rate governed by phospholipase C (PLC) activity, $k_{\\mathrm{prod}}$, starting from a post-spike baseline $I_0$. The refractory decay of $I(t)$ during the spike is fast compared to the interspike interval, so that $I(t)$ effectively resets to $I_0$ immediately after a spike.\n\nAssume steady, strictly periodic oscillations so that the depletion of the store at each spike equals the refilling that occurred in the preceding interspike interval. Assume that $I_{\\mathrm{th}}$, $I_0$, and $g$ are unchanged by the perturbation below, and that store leak is negligible on the interspike timescale.\n\nFrom these bases, derive expressions for the oscillation period $T$ and the amplitude $A$ in terms of $k_{\\mathrm{prod}}$, $v_{\\mathrm{SERCA}}$, and constants. Then, using the following experimental observations on a single egg before and after application of an unknown drug:\n\n- Before drug: over $20 \\ \\mathrm{min}$, $8$ calcium spikes are observed. The mean peak amplitude is $0.45 \\ \\mathrm{\\mu M}$ above baseline.\n- After drug: over the next $20 \\ \\mathrm{min}$, $6$ calcium spikes are observed. The mean peak amplitude is $0.60 \\ \\mathrm{\\mu M}$ above baseline.\n\nBaseline cytosolic calcium remains unchanged across conditions. Assume that the drug targets only one of the two pathways represented by $k_{\\mathrm{prod}}$ (PLC) and $v_{\\mathrm{SERCA}}$ (SERCA), meaning that one of these parameters changes while the other remains constant.\n\nIdentify which pathway is targeted (based on consistency with the model) and compute the fractional change in the targeted kinetic parameter, defined as the ratio \"after/before\". Report your final answer as a dimensionless number. If you obtain a non-terminating decimal, round your answer to four significant figures.", "solution": "The problem presented is a valid exercise in quantitative biological modeling. It is scientifically grounded, well-posed, and contains sufficient information for a unique solution. We will proceed with the analysis.\n\nFirst, we must derive the theoretical expressions for the oscillation period, $T$, and the peak amplitude, $A$, from the provided model description.\n\nThe interspike interval, which defines the period $T$, is determined by the time required for the inositol 1,4,5-trisphosphate ($IP_3$) concentration, $I(t)$, to rise from its post-spike baseline, $I_0$, to the activation threshold of the $IP_3$ receptors, $I_{\\mathrm{th}}$. The problem states that this increase is linear with a rate of production $k_{\\mathrm{prod}}$. We can thus write:\n$$I(t) = I_0 + k_{\\mathrm{prod}} \\cdot t$$\nA spike occurs at time $t=T$ when $I(T) = I_{\\mathrm{th}}$. Substituting this into the equation gives:\n$$I_{\\mathrm{th}} = I_0 + k_{\\mathrm{prod}} \\cdot T$$\nSolving for the period $T$, we obtain:\n$$T = \\frac{I_{\\mathrm{th}} - I_0}{k_{\\mathrm{prod}}}$$\nSince $I_{\\mathrm{th}}$ and $I_0$ are constants, we can define a constant $\\Delta I = I_{\\mathrm{th}} - I_0$. The expression for the period is then:\n$$T = \\frac{\\Delta I}{k_{\\mathrm{prod}}}$$\nThis shows that the period $T$ is inversely proportional to the rate of $IP_3$ production, $k_{\\mathrm{prod}}$.\n\nNext, we derive the expression for the amplitude $A$. The Sarco/Endoplasmic Reticulum Calcium ATPase (SERCA) pump refills the calcium store at a constant rate $v_{\\mathrm{SERCA}}$ during the interspike interval $T$. The total amount of calcium refilled is therefore the product of the rate and the duration, $v_{\\mathrm{SERCA}} \\cdot T$. For steady, periodic oscillations, the amount of calcium released from the store at each spike, $\\Delta S$, must equal the amount refilled in the preceding interval.\n$$\\Delta S = v_{\\mathrm{SERCA}} \\cdot T$$\nThe problem states that the peak amplitude of the cytosolic calcium transient, $A$, is directly proportional to this released amount, with a proportionality constant $g > 0$.\n$$A = g \\cdot \\Delta S$$\nSubstituting the expression for $\\Delta S$, we get:\n$$A = g \\cdot v_{\\mathrm{SERCA}} \\cdot T$$\nWe can further substitute our derived expression for $T$ into this equation to relate $A$ to the elementary parameters $k_{\\mathrm{prod}}$ and $v_{\\mathrm{SERCA}}$:\n$$A = g \\cdot v_{\\mathrm{SERCA}} \\cdot \\left( \\frac{I_{\\mathrm{th}} - I_0}{k_{\\mathrm{prod}}} \\right)$$\nThis can be simplified by grouping all the constant terms ($g$, $I_{\\mathrm{th}}$, $I_0$) into a single constant, $C = g(I_{\\mathrm{th}}-I_0)$.\n$$A = C \\cdot \\frac{v_{\\mathrm{SERCA}}}{k_{\\mathrm{prod}}}$$\nThis shows that the amplitude $A$ is proportional to the ratio of the SERCA pump rate to the $IP_3$ production rate.\n\nNow, we apply these theoretical relationships to the experimental data. Let the \"before\" state be denoted by subscript $1$ and the \"after\" state by subscript $2$.\n\nFrom the experimental data before the drug is applied (state $1$):\nNumber of spikes is $8$ in a $20$-minute interval.\nThe period is $T_1 = \\frac{20 \\ \\mathrm{min}}{8} = 2.5 \\ \\mathrm{min}$.\nThe mean peak amplitude is $A_1 = 0.45 \\ \\mathrm{\\mu M}$.\n\nAfter the drug is applied (state $2$):\nNumber of spikes is $6$ in a $20$-minute interval.\nThe period is $T_2 = \\frac{20 \\ \\mathrm{min}}{6} = \\frac{10}{3} \\ \\mathrm{min}$.\nThe mean peak amplitude is $A_2 = 0.60 \\ \\mathrm{\\mu M}$.\n\nThe problem states that the drug targets only one parameter: either $k_{\\mathrm{prod}}$ or $v_{\\mathrm{SERCA}}$. We test the two resulting hypotheses.\n\nHypothesis 1: The drug targets the PLC pathway, so $k_{\\mathrm{prod}}$ changes ($k_{\\mathrm{prod,1}} \\neq k_{\\mathrm{prod,2}}$) while $v_{\\mathrm{SERCA}}$ remains constant ($v_{\\mathrm{SERCA,1}} = v_{\\mathrm{SERCA,2}} = v_{\\mathrm{SERCA}}$).\nFrom our derived equations, we form ratios between the two states:\nThe ratio of periods is $\\frac{T_2}{T_1} = \\frac{\\Delta I / k_{\\mathrm{prod,2}}}{\\Delta I / k_{\\mathrm{prod,1}}} = \\frac{k_{\\mathrm{prod,1}}}{k_{\\mathrm{prod,2}}}$.\nThe ratio of amplitudes is $\\frac{A_2}{A_1} = \\frac{C \\cdot v_{\\mathrm{SERCA}} / k_{\\mathrm{prod,2}}}{C \\cdot v_{\\mathrm{SERCA}} / k_{\\mathrm{prod,1}}} = \\frac{k_{\\mathrm{prod,1}}}{k_{\\mathrm{prod,2}}}$.\nThis hypothesis predicts that the ratio of periods must be equal to the ratio of amplitudes: $\\frac{T_2}{T_1} = \\frac{A_2}{A_1}$.\nLet us check this with the experimental values:\nRatio of periods: $\\frac{T_2}{T_1} = \\frac{10/3}{2.5} = \\frac{10/3}{5/2} = \\frac{10 \\cdot 2}{3 \\cdot 5} = \\frac{20}{15} = \\frac{4}{3}$.\nRatio of amplitudes: $\\frac{A_2}{A_1} = \\frac{0.60}{0.45} = \\frac{60}{45} = \\frac{4}{3}$.\nThe experimentally observed ratios are identical, which is consistent with Hypothesis 1.\n\nHypothesis 2: The drug targets the SERCA pathway, so $v_{\\mathrm{SERCA}}$ changes ($v_{\\mathrm{SERCA,1}} \\neq v_{\\mathrm{SERCA,2}}$) while $k_{\\mathrm{prod}}$ remains constant ($k_{\\mathrm{prod,1}} = k_{\\mathrm{prod,2}} = k_{\\mathrm{prod}}$).\nThe period is given by $T = \\frac{\\Delta I}{k_{\\mathrm{prod}}}$. If $k_{\\mathrm{prod}}$ is constant, the period must also be constant, i.e., $T_1 = T_2$.\nHowever, our experimental data shows $T_1 = 2.5 \\ \\mathrm{min}$ and $T_2 = \\frac{10}{3} \\ \\mathrm{min}$, which are not equal. Therefore, Hypothesis 2 is contradicted by the evidence and must be rejected.\n\nWe conclude that the drug targets the PLC pathway, modulating the parameter $k_{\\mathrm{prod}}$. We are required to compute the fractional change, defined as the ratio $\\frac{k_{\\mathrm{prod,2}}}{k_{\\mathrm{prod,1}}}$.\nFrom our analysis under Hypothesis 1, we found $\\frac{T_2}{T_1} = \\frac{k_{\\mathrm{prod,1}}}{k_{\\mathrm{prod,2}}}$.\nInverting this relationship gives the desired ratio:\n$$\\frac{k_{\\mathrm{prod,2}}}{k_{\\mathrm{prod,1}}} = \\frac{T_1}{T_2}$$\nUsing the experimental values:\n$$\\frac{k_{\\mathrm{prod,2}}}{k_{\\mathrm{prod,1}}} = \\frac{2.5}{10/3} = \\frac{5/2}{10/3} = \\frac{5 \\cdot 3}{2 \\cdot 10} = \\frac{15}{20} = \\frac{3}{4}$$\nThe result as a decimal is $0.75$. The drug reduces PLC activity ($k_{\\mathrm{prod}}$) to $75\\%$ of its initial value, which lengthens the interspike period and allows for greater store refilling, thereby increasing the amplitude of the subsequent calcium spike. This is precisely what the data indicates.\nThe final answer is the dimensionless ratio of the kinetic parameters.", "answer": "$$\n\\boxed{0.75}\n$$", "id": "2678590"}, {"introduction": "While simple models provide key insights, the full richness of calcium dynamics arises from complex nonlinear interactions. This computational exercise challenges you to simulate a well-established model of the egg's calcium control system, mapping out how different physiological states—quiescence, excitability, and oscillation—emerge from the interplay between $IP_3$ production and calcium pumping. This systems-level approach is crucial for understanding how the egg cell transitions from a dormant to an activated state.", "problem": "You are tasked with constructing, simulating, and classifying a minimal, mechanistically grounded model of the calcium wave underlying egg activation. Your goal is to map regions of monostability, excitability, and oscillations across a grid of parameter values that represent Inositol 1,4,5-trisphosphate (IP3) production and cytosolic calcium pump rates. The model and classification must be implemented as a complete, runnable program that produces the requested outputs.\n\nModeling assumptions and foundations:\n- Use mass balance for cytosolic calcium concentration $c(t)$ (in $\\mu\\mathrm{M}$), assuming a well-mixed cytosol and an endoplasmic reticulum (ER) reservoir with fast luminal mixing. Let $h(t)$ be the IP3 receptor inactivation gate.\n- Adopt the two-variable reduction of the De Young–Keizer IP3 receptor kinetics (often called the Li–Rinzel model), which is a standard, well-tested representation of calcium-induced calcium release (CICR) mediated by IP3 receptors, together with pumping back into the ER and a passive ER leak.\n- Treat IP3 as quasi-steady for each parameter set by setting the IP3 concentration to the steady value $p^\\ast = k_p/k_d$, where $k_p$ is the IP3 production rate and $k_d$ is the first-order IP3 degradation rate (units of $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ and $\\mathrm{s}^{-1}$, respectively). This connects parameter scans in production rate to a biologically interpretable steady IP3 level.\n- All simulations must include a standardized, brief cytosolic calcium influx that mimics fertilization-triggered input to probe excitability.\n\nModel equations and parameters:\n- State variables: $c(t)$ in $\\mu\\mathrm{M}$ and $h(t)$ unitless.\n- Define the ER calcium concentration via conservation: $c_{\\mathrm{ER}}(t) = \\dfrac{c_0 - c(t)}{c_1}$, where $c_0$ is the total calcium (cytosol plus ER) and $c_1$ is the ER-to-cytosol volume ratio.\n- Fluxes (all in $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ unless dimensionless time constants are involved):\n  1. IP3 receptor-mediated channel flux:\n     $$J_{\\mathrm{chan}} = v_1 \\, m_\\infty(c,p^\\ast)^3 \\, h^3 \\, \\left(c_{\\mathrm{ER}} - c\\right),$$\n     where $m_\\infty(c,p^\\ast) = \\dfrac{p^\\ast}{p^\\ast + d_1}\\dfrac{c}{c + d_5}.$\n  2. Passive ER leak:\n     $$J_{\\mathrm{leak}} = v_2 \\, \\left(c_{\\mathrm{ER}} - c\\right).$$\n  3. Sarco/endoplasmic reticulum Ca$^{2+}$-ATPase (SERCA) pump:\n     $$J_{\\mathrm{pump}} = v_{\\mathrm{pump}} \\, \\dfrac{c^2}{k_{\\mathrm{pump}}^2 + c^2}.$$\n  4. Standardized fertilization-like influx pulse:\n     $$J_{\\mathrm{in}}(t) = \\begin{cases} A_{\\mathrm{pulse}}, & 0 \\le t \\le T_{\\mathrm{pulse}} \\\\ 0, & t > T_{\\mathrm{pulse}}.\\end{cases}$$\n- Gating kinetics:\n  $$\\dfrac{d h}{dt} = \\dfrac{h_\\infty(c,p^\\ast) - h}{\\tau_h(c,p^\\ast)}, \\quad h_\\infty(c,p^\\ast) = \\dfrac{Q_2(p^\\ast)}{Q_2(p^\\ast) + c}, \\quad \\tau_h(c,p^\\ast) = \\dfrac{1}{a_2 \\left(Q_2(p^\\ast) + c\\right)},$$\n  where $Q_2(p^\\ast) = d_2 \\dfrac{p^\\ast + d_1}{p^\\ast + d_3}.$\n- Cytosolic calcium dynamics:\n  $$\\dfrac{d c}{dt} = J_{\\mathrm{chan}} + J_{\\mathrm{leak}} - J_{\\mathrm{pump}} + J_{\\mathrm{in}}(t).$$\n\nFixed parameter values to use:\n- $d_1 = 0.13 \\,\\mu\\mathrm{M}$, $d_2 = 1.049 \\,\\mu\\mathrm{M}$, $d_3 = 0.943 \\,\\mu\\mathrm{M}$, $d_5 = 0.082 \\,\\mu\\mathrm{M}$, $a_2 = 0.2 \\,\\mu\\mathrm{M}^{-1}\\mathrm{s}^{-1}$.\n- $v_1 = 6.0 \\,\\mathrm{s}^{-1}$, $v_2 = 0.11 \\,\\mathrm{s}^{-1}$, $k_{\\mathrm{pump}} = 0.1 \\,\\mu\\mathrm{M}$, $c_0 = 2.0 \\,\\mu\\mathrm{M}$, $c_1 = 0.185$.\n- IP3 degradation rate $k_d = 0.1 \\,\\mathrm{s}^{-1}$.\n- Pulse parameters $A_{\\mathrm{pulse}} = 0.2 \\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ and $T_{\\mathrm{pulse}} = 5.0 \\,\\mathrm{s}$.\n\nVariable parameters to scan:\n- IP3 production rate $k_p$ (sets $p^\\ast = k_p/k_d$).\n- Maximum SERCA pump rate $v_{\\mathrm{pump}}$.\n\nInitial conditions and simulation protocol:\n- Use $c(0) = 0.1 \\,\\mu\\mathrm{M}$, $h(0) = h_\\infty\\big(c(0),p^\\ast\\big)$.\n- Simulate on $t \\in [0, 400]$ seconds.\n- Use a numerically stable ordinary differential equation solver with an evaluation grid dense enough to resolve $t$ with at most $0.1$ second spacing.\n\nClassification criteria:\n- Let $c(t)$ be sampled uniformly over the simulation interval. Define the “tail” window as $t \\in [200, 400]$ seconds and compute the median baseline $b$ over this interval.\n- Define a peak as a local maximum of $c(t)$ that exceeds $b + \\delta$ with $\\delta = 0.05 \\,\\mu\\mathrm{M}$, and enforce a minimum peak separation of $5.0$ seconds.\n- Compute:\n  1. $N_{\\mathrm{peaks,tail}}$: the number of peaks in the tail window.\n  2. $\\sigma_{\\mathrm{tail}}$: the standard deviation of $c(t)$ in the tail window.\n  3. $N_{\\mathrm{peaks,all}}$: the number of peaks over the full $[0,400]$ seconds.\n- Classification rule for each parameter pair:\n  - Oscillatory: if $N_{\\mathrm{peaks,tail}} \\ge 3$ and $\\sigma_{\\mathrm{tail}}/(b + 10^{-6}) \\ge 0.02$.\n  - Excitable (single-spike response): else if $N_{\\mathrm{peaks,all}} \\ge 1$ and $\\sigma_{\\mathrm{tail}} < 0.01 \\,\\mu\\mathrm{M}$.\n  - Monostable (no spike): else monostable.\n\nUnits:\n- Time in seconds, concentrations in micromolar ($\\mu\\mathrm{M}$). The program’s outputs are integer counts (unitless).\n\nTest suite (three scans):\n- Case $1$ (balanced scan): $k_p \\in \\{0.02, 0.05, 0.08\\}$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ and $v_{\\mathrm{pump}} \\in \\{0.4, 0.6, 0.8\\}$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$.\n- Case $2$ (lower pump, near-oscillatory window): $k_p \\in \\{0.04, 0.06, 0.09\\}$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ and $v_{\\mathrm{pump}} \\in \\{0.3, 0.5, 0.7\\}$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$.\n- Case $3$ (high pump, suppression edge): $k_p \\in \\{0.01, 0.03\\}$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ and $v_{\\mathrm{pump}} \\in \\{0.9, 1.1\\}$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$.\n\nRequired program output:\n- For each case, count how many grid points are monostable, excitable, and oscillatory, in that order, producing three integers per case.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[S_1,E_1,O_1,S_2,E_2,O_2,S_3,E_3,O_3]$, where $S_i$ is monostable count, $E_i$ is excitable count, and $O_i$ is oscillatory count for case $i$.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It presents a well-posed, scientifically grounded problem in the field of computational systems biology. The model, a reduction of the De Young–Keizer model for intracellular calcium dynamics, is standard in the literature. All parameters, equations, initial conditions, and classification criteria are provided in a complete, self-consistent, and unambiguous manner. Therefore, we may proceed with the solution.\n\nThe core of this problem is the numerical simulation and subsequent classification of the behavior of a system of two coupled, nonlinear ordinary differential equations (ODEs) describing the dynamics of cytosolic calcium concentration, $c(t)$, and the IP3 receptor inactivation variable, $h(t)$. The system is defined as follows:\n$$\n\\begin{align*}\n\\frac{dc}{dt} &= J_{\\mathrm{chan}} + J_{\\mathrm{leak}} - J_{\\mathrm{pump}} + J_{\\mathrm{in}}(t) \\\\\n\\frac{dh}{dt} &= \\frac{h_\\infty(c, p^\\ast) - h}{\\tau_h(c, p^\\ast)}\n\\end{align*}\n$$\nThe state variables are $c(t)$ (in $\\mu\\mathrm{M}$) and the dimensionless gating variable $h(t)$. The terms in the equations represent transmembrane and kinetic processes. The quasi-steady IP3 concentration is given by $p^\\ast = k_p / k_d$. The total calcium concentration is conserved, allowing the ER calcium concentration $c_{\\mathrm{ER}}$ to be expressed in terms of $c(t)$:\n$$\nc_{\\mathrm{ER}}(t) = \\frac{c_0 - c(t)}{c_1}\n$$\nThe fluxes are defined as:\n$$\n\\begin{align*}\nJ_{\\mathrm{chan}} &= v_1 \\left( \\frac{p^\\ast}{p^\\ast + d_1} \\frac{c}{c + d_5} \\right)^3 h^3 (c_{\\mathrm{ER}} - c) \\\\\nJ_{\\mathrm{leak}} &= v_2 (c_{\\mathrm{ER}} - c) \\\\\nJ_{\\mathrm{pump}} &= v_{\\mathrm{pump}} \\frac{c^2}{k_{\\mathrm{pump}}^2 + c^2}\n\\end{align*}\n$$\nAn external stimulus is modeled as a brief influx pulse:\n$$\nJ_{\\mathrm{in}}(t) = \\begin{cases} A_{\\mathrm{pulse}}, & 0 \\le t \\le T_{\\mathrm{pulse}} \\\\ 0, & t > T_{\\mathrm{pulse}} \\end{cases}\n$$\nThe dynamics of the inactivation gate $h$ are governed by its approach to a calcium- and IP3-dependent steady state $h_\\infty(c, p^\\ast)$ with a characteristic time constant $\\tau_h(c, p^\\ast)$:\n$$\nh_\\infty(c, p^\\ast) = \\frac{Q_2(p^\\ast)}{Q_2(p^\\ast) + c}, \\quad \\tau_h(c, p^\\ast) = \\frac{1}{a_2 (Q_2(p^\\ast) + c)}\n$$\nwhere $Q_2(p^\\ast) = d_2 \\frac{p^\\ast + d_1}{p^\\ast + d_3}$.\n\nThe solution procedure is as follows. For each pair of scanned parameters $(k_p, v_{\\mathrm{pump}})$, we perform a numerical integration and subsequent analysis.\n\nFirst, the system parameters are set. The fixed parameters are constants provided in the problem statement. The variable parameter $k_p$ is used to calculate the steady-state IP3 concentration $p^\\ast = k_p / k_d$. The initial conditions are $c(0) = 0.1 \\,\\mu\\mathrm{M}$ and $h(0) = h_\\infty(c(0), p^\\ast)$, which ensures the slow inactivation gate begins at its equilibrium value for the resting calcium level.\n\nSecond, the system of ODEs is numerically integrated over the time interval $t \\in [0, 400]$ seconds. A robust, adaptive step-size solver, such as a Runge-Kutta method of order $4(5)$, is appropriate. We use `scipy.integrate.solve_ivp` for this purpose. The solution is evaluated on a uniform time grid with a spacing of $\\Delta t = 0.1$ seconds to ensure proper resolution for subsequent analysis.\n\nThird, the resulting calcium trajectory $c(t)$ is classified according to the specified criteria. This involves a three-step analysis:\n1.  Isolate the time series data for the \"tail\" window, defined as $t \\in [200, 400]$ seconds.\n2.  Compute key statistical measures from this tail window: the median baseline calcium level, $b$, and the standard deviation, $\\sigma_{\\mathrm{tail}}$.\n3.  Identify peaks in the calcium signal. A peak is a local maximum that surpasses a threshold of $b + \\delta$, where $\\delta = 0.05 \\,\\mu\\mathrm{M}$. Additionally, a minimum temporal separation between peaks of $5.0$ seconds is enforced. This is achieved using a standard peak-finding algorithm, such as `scipy.signal.find_peaks`, with appropriate `height` and `distance` parameters. We count the number of such peaks over the entire simulation interval ($N_{\\mathrm{peaks,all}}$) and within the tail window only ($N_{\\mathrm{peaks,tail}}$).\n\nFinally, the classification rule is applied based on these computed metrics:\n- The system is classified as **Oscillatory** if the tail exhibits sustained oscillations, defined by the condition $N_{\\mathrm{peaks,tail}} \\ge 3$ and a significant relative amplitude, $\\sigma_{\\mathrm{tail}}/(b + 10^{-6}) \\ge 0.02$.\n- If not oscillatory, the system is classified as **Excitable** if the initial pulse elicits at least one spike but the system returns to a stable steady state, defined by $N_{\\mathrm{peaks,all}} \\ge 1$ and a quiescent tail, $\\sigma_{\\mathrm{tail}} < 0.01 \\,\\mu\\mathrm{M}$.\n- Otherwise, the system is classified as **Monostable**, representing cases with no significant response to the stimulus or responses that do not meet the criteria for excitability or oscillation.\n\nThis entire procedure is automated and executed for every grid point $(k_p, v_{\\mathrm{pump}})$ specified in the three test cases. The counts of each behavior (monostable, excitable, oscillatory) are tallied for each case and reported in the specified format. The implementation encapsulates this logic into a single, self-contained program.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Constructs, simulates, and classifies a model of calcium dynamics\n    across a grid of parameter values, according to the problem specification.\n    \"\"\"\n    # Fixed model parameters\n    params_fixed = {\n        'd1': 0.13, 'd2': 1.049, 'd3': 0.943, 'd5': 0.082, 'a2': 0.2,\n        'v1': 6.0, 'v2': 0.11, 'k_pump': 0.1, 'c0': 2.0, 'c1': 0.185,\n        'kd': 0.1, 'A_pulse': 0.2, 'T_pulse': 5.0\n    }\n    \n    # Simulation and classification parameters\n    t_span = [0, 400]\n    dt = 0.1\n    t_eval = np.arange(t_span[0], t_span[1] + dt, dt)\n    c_init = 0.1\n    delta_peak = 0.05\n    min_peak_sep_s = 5.0\n    min_peak_dist_samples = int(min_peak_sep_s / dt)\n    \n    # Test cases: grids of (k_p, v_pump) values\n    test_cases = [\n        {'kp_vals': [0.02, 0.05, 0.08], 'vp_vals': [0.4, 0.6, 0.8]},\n        {'kp_vals': [0.04, 0.06, 0.09], 'vp_vals': [0.3, 0.5, 0.7]},\n        {'kp_vals': [0.01, 0.03], 'vp_vals': [0.9, 1.1]}\n    ]\n    \n    final_results = []\n    \n    for case_params in test_cases:\n        counts = {'Monostable': 0, 'Excitable': 0, 'Oscillatory': 0}\n        \n        for kp in case_params['kp_vals']:\n            for v_pump in case_params['vp_vals']:\n                # Run a single simulation and classify the result\n                classification = run_and_classify(\n                    kp, v_pump, params_fixed, t_span, t_eval, c_init,\n                    delta_peak, min_peak_dist_samples\n                )\n                counts[classification] += 1\n                \n        final_results.extend([counts['Monostable'], counts['Excitable'], counts['Oscillatory']])\n    \n    print(f\"[{','.join(map(str, final_results))}]\")\n\ndef model_rhs(t, y, params):\n    \"\"\"Defines the system of ODEs for the calcium model.\"\"\"\n    c, h = y\n    \n    # Unpack parameters\n    d1, d2, d3, d5, a2 = params['d1'], params['d2'], params['d3'], params['d5'], params['a2']\n    v1, v2, k_pump, c0, c1 = params['v1'], params['v2'], params['k_pump'], params['c0'], params['c1']\n    p_star, v_pump = params['p_star'], params['v_pump']\n    A_pulse, T_pulse = params['A_pulse'], params['T_pulse']\n    \n    # Algebraic relations\n    c_ER = (c0 - c) / c1\n    m_inf = (p_star / (p_star + d1)) * (c / (c + d5))\n    Q2 = d2 * (p_star + d1) / (p_star + d3)\n    \n    # Fluxes\n    J_chan = v1 * (m_inf**3) * (h**3) * (c_ER - c)\n    J_leak = v2 * (c_ER - c)\n    J_pump = v_pump * (c**2) / (k_pump**2 + c**2)\n    J_in = A_pulse if 0 <= t <= T_pulse else 0\n    \n    # Gating variable kinetics\n    h_inf = Q2 / (Q2 + c)\n    tau_h = 1 / (a2 * (Q2 + c))\n    dh_dt = (h_inf - h) / tau_h\n    \n    # Calcium dynamics\n    dc_dt = J_chan + J_leak - J_pump + J_in\n    \n    return [dc_dt, dh_dt]\n\ndef classify_trajectory(t, c, delta_peak, min_peak_dist):\n    \"\"\"Classifies a calcium trajectory based on specified criteria.\"\"\"\n    \n    # Tail window analysis\n    tail_mask = (t >= 200) & (t <= 400)\n    c_tail = c[tail_mask]\n    \n    if len(c_tail) == 0:\n        return 'Monostable' # Should not happen with current t_eval\n        \n    b = np.median(c_tail)\n    sigma_tail = np.std(c_tail)\n    \n    # Peak finding\n    peak_height_threshold = b + delta_peak\n    \n    peaks_tail_indices, _ = find_peaks(c_tail, height=peak_height_threshold, distance=min_peak_dist)\n    N_peaks_tail = len(peaks_tail_indices)\n    \n    peaks_all_indices, _ = find_peaks(c, height=peak_height_threshold, distance=min_peak_dist)\n    N_peaks_all = len(peaks_all_indices)\n\n    # Classification logic\n    if N_peaks_tail >= 3 and sigma_tail / (b + 1e-6) >= 0.02:\n        return 'Oscillatory'\n    elif N_peaks_all >= 1 and sigma_tail < 0.01:\n        return 'Excitable'\n    else:\n        return 'Monostable'\n\ndef run_and_classify(kp, v_pump, params_fixed, t_span, t_eval, c_init, delta, dist):\n    \"\"\"Runs one simulation and returns its classification.\"\"\"\n    \n    params = params_fixed.copy()\n    params['kp'] = kp\n    params['v_pump'] = v_pump\n    params['p_star'] = kp / params['kd']\n    \n    # Calculate initial condition for h\n    p_star, d1, d2, d3 = params['p_star'], params['d1'], params['d2'], params['d3']\n    Q2_init = d2 * (p_star + d1) / (p_star + d3)\n    h0 = Q2_init / (Q2_init + c_init)\n    y0 = [c_init, h0]\n    \n    # Solve ODE system\n    sol = solve_ivp(\n        fun=model_rhs,\n        t_span=t_span,\n        y0=y0,\n        method='RK45',\n        t_eval=t_eval,\n        args=(params,)\n    )\n    \n    c_trajectory = sol.y[0]\n    \n    # Classify the result\n    return classify_trajectory(t_eval, c_trajectory, delta, dist)\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2678522"}]}