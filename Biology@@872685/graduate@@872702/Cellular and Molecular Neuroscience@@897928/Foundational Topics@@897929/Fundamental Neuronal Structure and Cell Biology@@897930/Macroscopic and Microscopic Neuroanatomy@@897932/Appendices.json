{"hands_on_practices": [{"introduction": "Dendritic spines are the primary sites of excitatory synapses, and their morphology critically shapes the electrical signals that a neuron receives. This exercise provides a foundational understanding of this structure-function relationship by modeling the spine neck as a simple resistor. By applying elementary circuit theory, you will quantify how an excitatory postsynaptic potential (EPSP) is attenuated as it travels from the spine head to the parent dendrite, a key determinant of synaptic strength and integration. [@problem_id:2721334]", "problem": "A thin dendritic spine neck can be modeled as a uniform cylindrical conductor connecting a spine head to its parent dendrite. Consider a spine neck of length $L = 1 \\ \\mu\\mathrm{m}$ and radius $r = 0.05 \\ \\mu\\mathrm{m}$. Assume the cytoplasmic resistivity is $\\rho = 150 \\ \\Omega \\cdot \\mathrm{cm}$ and that, over the time course of a slowly varying excitatory postsynaptic potential (EPSP), capacitive effects can be neglected so that the circuit is effectively resistive (quasi–steady state). The local input resistance of the parent dendrite at the spine insertion point is $R_{d} = 50 \\ \\mathrm{M}\\Omega$.\n\nStarting from the definition of resistivity that relates resistance to geometry, and the elementary rule for a series voltage divider, derive an expression for the attenuation factor $a$, defined as the ratio of the voltage change at the parent dendrite to the voltage change in the spine head, $a = V_{d}/V_{\\text{head}}$, in terms of $\\rho$, $L$, $r$, and $R_{d}$. Then evaluate $a$ numerically using the given parameters. Use centimeters for all geometric quantities when computing the neck resistance. Round your final numerical result to four significant figures and express it as a dimensionless decimal (no units). Report only the attenuation factor $a$ as your final answer.", "solution": "The problem statement is subjected to critical validation before any attempt at a solution.\n\n**Step 1: Extract Givens**\n- Model: A thin dendritic spine neck is a uniform cylindrical conductor.\n- Spine neck length: $L = 1 \\ \\mu\\mathrm{m}$.\n- Spine neck radius: $r = 0.05 \\ \\mu\\mathrm{m}$.\n- Cytoplasmic resistivity: $\\rho = 150 \\ \\Omega \\cdot \\mathrm{cm}$.\n- Assumption: Capacitive effects are neglected (quasi–steady state).\n- Parent dendrite input resistance: $R_{d} = 50 \\ \\mathrm{M}\\Omega$.\n- Definition of attenuation factor: $a = V_{d}/V_{\\text{head}}$, where $V_{d}$ is the voltage change at the parent dendrite and $V_{\\text{head}}$ is the voltage change in the spine head.\n- Objective $1$: Derive an expression for $a$ in terms of $\\rho$, $L$, $r$, and $R_{d}$.\n- Objective $2$: Evaluate $a$ numerically.\n- Constraint: Use centimeters for geometric quantities in resistance calculation.\n- Constraint: Round the final numerical result to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the required criteria.\n- **Scientific Grounding**: The problem uses a standard, simplified resistive model of a dendritic spine, which is a fundamental concept in computational neuroscience and biophysics. The use of Ohm's law and the voltage divider rule is appropriate for the quasi-static assumption. The provided physical parameters ($L$, $r$, $\\rho$, $R_d$) are within physiologically realistic ranges. The problem is scientifically sound.\n- **Well-Posedness**: The problem is clearly stated. It provides all necessary information and a clear objective. There is a single, unique path to the solution based on fundamental principles of electric circuits.\n- **Objectivity**: The problem is formulated with precise, objective language and avoids any subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It is deemed **valid**. I will proceed with the solution.\n\nThe problem requires a derivation of the attenuation factor $a$ in a simplified electrical model of a dendritic spine. The spine neck acts as a resistor, $R_{\\text{neck}}$, in series with the input resistance of the parent dendrite, $R_{d}$. This configuration forms a classic voltage divider circuit. The voltage in the spine head, $V_{\\text{head}}$, is the input voltage to this circuit, and the voltage at the dendrite, $V_{d}$, is the output voltage measured across the dendritic resistance $R_{d}$.\n\nFirst, we must find an expression for the resistance of the spine neck, $R_{\\text{neck}}$. The neck is modeled as a uniform cylinder of length $L$ and radius $r$. The resistance $R$ of a conductor is related to its resistivity $\\rho$, length $L$, and cross-sectional area $A$ by the formula:\n$$R = \\rho \\frac{L}{A}$$\nFor a cylinder, the cross-sectional area is $A = \\pi r^2$. Substituting this into the resistance formula gives the expression for the neck resistance:\n$$R_{\\text{neck}} = \\rho \\frac{L}{\\pi r^2}$$\n\nNext, we apply the voltage divider rule to the series circuit formed by $R_{\\text{neck}}$ and $R_{d}$. The voltage across the dendritic resistance, $V_{d}$, is given by:\n$$V_{d} = V_{\\text{head}} \\left( \\frac{R_{d}}{R_{\\text{neck}} + R_{d}} \\right)$$\nThe attenuation factor $a$ is defined as the ratio $a = V_{d} / V_{\\text{head}}$. Rearranging the voltage divider equation gives:\n$$a = \\frac{V_{d}}{V_{\\text{head}}} = \\frac{R_{d}}{R_{\\text{neck}} + R_{d}}$$\nThis is the general expression for the attenuation factor. To express it in terms of the fundamental parameters, we substitute the expression for $R_{\\text{neck}}$:\n$$a = \\frac{R_{d}}{\\rho \\frac{L}{\\pi r^2} + R_{d}}$$\nThis completes the first part of the problem.\n\nFor the second part, we must evaluate $a$ numerically. The problem mandates the use of centimeters for geometric quantities. We convert the given parameters:\n- Length: $L = 1 \\ \\mu\\mathrm{m} = 1 \\times 10^{-4} \\ \\mathrm{cm}$\n- Radius: $r = 0.05 \\ \\mu\\mathrm{m} = 5 \\times 10^{-6} \\ \\mathrm{cm}$\nThe other parameters are:\n- Resistivity: $\\rho = 150 \\ \\Omega \\cdot \\mathrm{cm}$\n- Dendritic resistance: $R_{d} = 50 \\ \\mathrm{M}\\Omega = 50 \\times 10^6 \\ \\Omega$\n\nNow, we calculate the numerical value of $R_{\\text{neck}}$:\n$$R_{\\text{neck}} = (150 \\ \\Omega \\cdot \\mathrm{cm}) \\frac{1 \\times 10^{-4} \\ \\mathrm{cm}}{\\pi (5 \\times 10^{-6} \\ \\mathrm{cm})^2} = \\frac{150 \\times 10^{-4}}{\\pi \\times 25 \\times 10^{-12}} \\ \\Omega$$\n$$R_{\\text{neck}} = \\frac{6 \\times 10^{-4}}{\\pi \\times 10^{-12}} \\ \\Omega = \\frac{6}{\\pi} \\times 10^8 \\ \\Omega$$\nNumerically, $\\frac{6}{\\pi} \\approx 1.909859...$, so:\n$$R_{\\text{neck}} \\approx 1.909859 \\times 10^8 \\ \\Omega$$\n\nFinally, we calculate the attenuation factor $a$ using the values of $R_{\\text{neck}}$ and $R_{d}$:\n$$a = \\frac{50 \\times 10^6 \\ \\Omega}{\\left(\\frac{6}{\\pi} \\times 10^8\\right) \\ \\Omega + (50 \\times 10^6 \\ \\Omega)}$$\nWe can simplify by dividing the numerator and denominator by $10^6$:\n$$a = \\frac{50}{\\frac{600}{\\pi} + 50}$$\nSubstituting the numerical value for $\\frac{600}{\\pi} \\approx 190.9859...$:\n$$a = \\frac{50}{190.9859... + 50} = \\frac{50}{240.9859...} \\approx 0.207481...$$\nThe problem requires the result to be rounded to four significant figures.\n$$a \\approx 0.2075$$\nThis dimensionless value represents the fraction of the voltage signal from the spine head that reaches the parent dendrite.", "answer": "$$\\boxed{0.2075}$$", "id": "2721334"}, {"introduction": "Efficient long-range communication is a fundamental challenge for the nervous system, solved in vertebrates by the evolution of myelin. This practice moves beyond simple calculation to explore an optimization problem: how to maximize information flow for a given metabolic and spatial cost. By working with established biophysical scaling laws, you will derive the optimal $g$-ratio—the ratio of axon diameter to the total outer diameter—that maximizes conduction velocity per unit of fiber volume, revealing how a fundamental microanatomical feature of white matter can be understood as an elegant solution to competing constraints. [@problem_id:2721316]", "problem": "In myelinated axons of the central nervous system, the $g$-ratio is defined as $g = d/D$, where $d$ is the inner (axon) diameter and $D$ is the outer diameter including myelin. Consider saltatory conduction as a sequence of internodal charging events driven by nodal ion channel currents. Assume the following well-tested scaling relations from cable theory and membrane biophysics:\n- The internode length scales with outer diameter as $L = k_L D$, where $k_L$ is a positive constant.\n- The axoplasmic resistance per unit length scales as $r_i = 4 \\rho_i/(\\pi d^2)$, with $\\rho_i$ the cytoplasmic resistivity. Thus the axial resistance of an internode scales as $R_{\\mathrm{ax}} \\propto L/d^2$.\n- The nodal sodium current capacity scales with the nodal area, so the nodal conductance $G_{\\mathrm{node}}$ satisfies $G_{\\mathrm{node}} \\propto d$ (taking the nodal length and channel density as approximately constant). Hence the nodal resistance scales as $R_{\\mathrm{node}} \\propto 1/d$.\n- Myelin wraps constitute capacitors in series; if the myelin thickness is $t = (D-d)/2$ and each lamella has thickness $\\delta$, then the number of wraps is $n \\propto t/\\delta \\propto (D-d)$. The effective specific capacitance scales inversely with $n$, so the internodal capacitance per unit length scales as $c_{\\mathrm{eff}} \\propto D/(D-d)$. Over an internode, the effective capacitive load scales as $C_{\\mathrm{eff}} \\propto L \\, c_{\\mathrm{eff}}$.\n\nModel the saltatory step time as the time to charge the effective load through the series resistance, $T \\propto (R_{\\mathrm{node}} + R_{\\mathrm{ax}}) C_{\\mathrm{eff}}$. The conduction velocity is $v = L/T$. Define fiber volume usage per unit length by the cross-sectional area $A \\propto D^2$. Define the objective to maximize as conduction velocity per unit fiber volume, $v/A$.\n\nUsing only the scalings above, derive the $g$-dependence of $v/A$ up to an overall positive constant and show it can be written in the form\n$$\n\\frac{v}{A} \\;\\propto\\; \\frac{g^2\\,(1-g)}{a g + b},\n$$\nfor some positive $g$-independent constants $a$ and $b$ that collect biophysical parameters. Then, by maximizing with respect to $g \\in (0,1)$, obtain a closed-form expression for the optimal $g$-ratio $g^{\\ast}$ in terms of $a$ and $b$. Finally, under the symmetric trade-off assumption that the nodal and axial contributions are comparable at the operating point so that $a=b$, evaluate $g^{\\ast}$ exactly as a single analytic number. Provide your final answer as a single analytic expression without units.", "solution": "The problem is to determine the optimal $g$-ratio, defined as $g = d/D$, that maximizes the conduction velocity per unit fiber volume, $v/A$. This is a well-posed optimization problem based on a set of biophysical scaling laws. The problem is scientifically grounded within the context of theoretical neurobiology and is self-contained. Therefore, I will proceed with its solution.\n\nThe objective function to maximize is proportional to $v/A$. We must first express this quantity in terms of the $g$-ratio. The analysis will proceed by expressing each physical parameter as a function of the outer diameter $D$ and the $g$-ratio, using the given scaling relations.\n\nThe scaling for the internode length $L$ is given as $L \\propto D$. We can write this as $L = k_L D$ for some positive constant $k_L$.\n\nThe axial resistance of an internode, $R_{\\mathrm{ax}}$, scales as $R_{\\mathrm{ax}} \\propto L/d^2$. Substituting $L \\propto D$ and $d = gD$:\n$$\nR_{\\mathrm{ax}} \\propto \\frac{D}{(gD)^2} = \\frac{D}{g^2 D^2} = \\frac{1}{g^2 D}\n$$\nLet us introduce a constant of proportionality $k_{\\mathrm{ax}} > 0$ such that $R_{\\mathrm{ax}} = \\frac{k_{\\mathrm{ax}}}{g^2 D}$.\n\nThe nodal resistance, $R_{\\mathrm{node}}$, scales as $R_{\\mathrm{node}} \\propto 1/d$. Substituting $d = gD$:\n$$\nR_{\\mathrm{node}} \\propto \\frac{1}{gD}\n$$\nLet us introduce a constant of proportionality $k_{\\mathrm{node}} > 0$ such that $R_{\\mathrm{node}} = \\frac{k_{\\mathrm{node}}}{gD}$.\n\nThe effective internodal capacitive load, $C_{\\mathrm{eff}}$, scales as $C_{\\mathrm{eff}} \\propto L \\cdot c_{\\mathrm{eff}}$. The problem gives the scaling for the internodal capacitance per unit length as $c_{\\mathrm{eff}} \\propto D/(D-d)$. Using $d=gD$, this becomes:\n$$\nc_{\\mathrm{eff}} \\propto \\frac{D}{D-gD} = \\frac{D}{D(1-g)} = \\frac{1}{1-g}\n$$\nCombining this with $L \\propto D$, the total capacitance $C_{\\mathrm{eff}}$ scales as:\n$$\nC_{\\mathrm{eff}} \\propto D \\cdot \\frac{1}{1-g}\n$$\nLet us introduce a constant of proportionality $k_C > 0$ such that $C_{\\mathrm{eff}} = \\frac{k_C D}{1-g}$.\n\nThe saltatory step time, $T$, is the time constant for charging the internode, which scales as $T \\propto (R_{\\mathrm{node}} + R_{\\mathrm{ax}}) C_{\\mathrm{eff}}$. Substituting the expressions derived above:\n$$\nT \\propto \\left( \\frac{k_{\\mathrm{node}}}{gD} + \\frac{k_{\\mathrm{ax}}}{g^2 D} \\right) \\left( \\frac{k_C D}{1-g} \\right)\n$$\n$$\nT \\propto \\left( \\frac{g k_{\\mathrm{node}} + k_{\\mathrm{ax}}}{g^2 D} \\right) \\left( \\frac{k_C D}{1-g} \\right) = \\frac{k_C (g k_{\\mathrm{node}} + k_{\\mathrm{ax}})}{g^2 (1-g)}\n$$\nNote that the step time $T$ is independent of the outer diameter $D$.\n\nThe conduction velocity $v$ is given by $v = L/T$. Using the scaling relations:\n$$\nv \\propto \\frac{L}{T} \\propto \\frac{D}{\\frac{g k_{\\mathrm{node}} + k_{\\mathrm{ax}}}{g^2 (1-g)}} = D \\cdot \\frac{g^2 (1-g)}{g k_{\\mathrm{node}} + k_{\\mathrm{ax}}}\n$$\nThis demonstrates the well-known linear scaling of conduction velocity with fiber diameter, $v \\propto D$.\n\nThe fiber volume usage per unit length is defined by the cross-sectional area $A$, which scales as $A \\propto D^2$. Let $A = k_A D^2$ for some constant $k_A > 0$.\n\nThe objective function to maximize is the conduction velocity per unit fiber volume, $v/A$:\n$$\n\\frac{v}{A} \\propto \\frac{D \\cdot \\frac{g^2 (1-g)}{g k_{\\mathrm{node}} + k_{\\mathrm{ax}}}}{D^2} = \\frac{1}{D} \\cdot \\frac{g^2 (1-g)}{g k_{\\mathrm{node}} + k_{\\mathrm{ax}}}\n$$\nTo maximize this function with respect to $g$, we only need to consider the $g$-dependent part, which we denote $f(g)$. By defining $a = k_{\\mathrm{node}}$ and $b = k_{\\mathrm{ax}}$, where $a$ and $b$ are positive constants, we have shown that\n$$\n\\frac{v}{A} \\propto \\frac{g^2(1-g)}{ag+b}\n$$\nThis completes the first part of the problem.\n\nNow, we must find the value of $g \\in (0,1)$ that maximizes $f(g) = \\frac{g^2-g^3}{ag+b}$. We compute the derivative with respect to $g$ and set it to zero. Using the quotient rule,\n$$\nf'(g) = \\frac{(2g - 3g^2)(ag+b) - (g^2 - g^3)(a)}{(ag+b)^2}\n$$\nSetting $f'(g) = 0$ for $g \\in (0,1)$ requires the numerator to be zero:\n$$\n(2g - 3g^2)(ag+b) - a(g^2 - g^3) = 0\n$$\nSince $g \\neq 0$, we can divide the entire equation by $g$:\n$$\n(2 - 3g)(ag+b) - a(g - g^2) = 0\n$$\nExpanding the terms:\n$$\n2ag + 2b - 3ag^2 - 3bg - ag + ag^2 = 0\n$$\nCollecting terms by powers of $g$:\n$$\n(-3a+a)g^2 + (2a-3b-a)g + 2b = 0\n$$\n$$\n-2ag^2 + (a-3b)g + 2b = 0\n$$\nMultiplying by $-1$ gives a standard quadratic equation:\n$$\n2ag^2 - (a-3b)g - 2b = 0\n$$\nWe solve for $g$ using the quadratic formula $g = \\frac{-B \\pm \\sqrt{B^2-4AC}}{2A}$, with $A=2a$, $B=-(a-3b)$, and $C=-2b$:\n$$\ng^{\\ast} = \\frac{a-3b \\pm \\sqrt{(-(a-3b))^2 - 4(2a)(-2b)}}{2(2a)}\n$$\n$$\ng^{\\ast} = \\frac{a-3b \\pm \\sqrt{(a-3b)^2 + 16ab}}{4a}\n$$\n$$\ng^{\\ast} = \\frac{a-3b \\pm \\sqrt{a^2 - 6ab + 9b^2 + 16ab}}{4a}\n$$\n$$\ng^{\\ast} = \\frac{a-3b \\pm \\sqrt{a^2 + 10ab + 9b^2}}{4a}\n$$\nThe discriminant can be factored as $a^2 + 10ab + 9b^2 = (a+b)(a+9b)$. Since $a>0$ and $b>0$, the discriminant is always positive.\n$$\ng^{\\ast} = \\frac{a-3b \\pm \\sqrt{(a+b)(a+9b)}}{4a}\n$$\nSince $g$ must be a positive ratio, we must choose the correct sign. The term $\\sqrt{a^2+10ab+9b^2} > \\sqrt{a^2+6ab+9b^2} = \\sqrt{(a+3b)^2} = a+3b$.\nThus, $\\sqrt{(a+b)(a+9b)} > a+3b$.\nThe solution with the minus sign gives $g = \\frac{a-3b - \\sqrt{\\dots}}{4a} < \\frac{a-3b - (a+3b)}{4a} = \\frac{-6b}{4a} < 0$. This is unphysical.\nTherefore, we must take the positive sign. The optimal $g$-ratio is:\n$$\ng^{\\ast} = \\frac{a-3b + \\sqrt{(a+b)(a+9b)}}{4a}\n$$\nThis gives the closed-form expression for $g^{\\ast}$ in terms of $a$ and $b$.\n\nFinally, we evaluate $g^{\\ast}$ under the assumption that $a=b$. This corresponds to a symmetric trade-off where the nodal and axial resistances make comparable contributions to the circuit.\nSubstituting $a=b$ into the expression for $g^{\\ast}$:\n$$\ng^{\\ast} = \\frac{a-3a + \\sqrt{(a+a)(a+9a)}}{4a} = \\frac{-2a + \\sqrt{(2a)(10a)}}{4a}\n$$\n$$\ng^{\\ast} = \\frac{-2a + \\sqrt{20a^2}}{4a} = \\frac{-2a + a\\sqrt{20}}{4a}\n$$\nSince $a$ is a positive constant, it cancels out:\n$$\ng^{\\ast} = \\frac{-2 + \\sqrt{20}}{4}\n$$\nSimplifying the square root, $\\sqrt{20} = \\sqrt{4 \\times 5} = 2\\sqrt{5}$:\n$$\ng^{\\ast} = \\frac{-2 + 2\\sqrt{5}}{4} = \\frac{2(-1 + \\sqrt{5})}{4} = \\frac{\\sqrt{5}-1}{2}\n$$\nThis is a well-known constant, the reciprocal of the golden ratio, with a numerical value of approximately $0.618$.", "answer": "$$\n\\boxed{\\frac{\\sqrt{5}-1}{2}}\n$$", "id": "2721316"}, {"introduction": "Higher brain functions like memory are thought to emerge from the collective dynamics of neural networks, where the microanatomical connectivity matrix serves as the substrate. This practice bridges the gap between the static map of synaptic weights in the hippocampal CA3 region and the dynamic stability of its \"attractor\" states, which are putative correlates of memory. You will use linear stability analysis on a firing-rate model to predict how the network's ability to sustain a memory trace is altered by the selective loss of its recurrent connections, a powerful technique for linking anatomy to function and dysfunction. [@problem_id:2721344]", "problem": "You are modeling the recurrent associational network of Cornu Ammonis area 3 (CA3) pyramidal neurons using a microanatomical connectivity matrix. Let $W \\in \\mathbb{R}^{N \\times N}$ denote the synaptic weight matrix of excitatory recurrent collaterals among CA3 pyramidal cells, where $W_{ij} \\ge 0$ represents the synaptic efficacy from neuron $j$ to neuron $i$, and $W_{ii} = 0$ (no autapses). Consider a discrete-time firing-rate model with Euler step size $\\alpha \\in (0,1)$:\n$$\nr_{t+1} = (1 - \\alpha)\\, r_t + \\alpha\\, \\phi\\!\\left(W'\\, r_t\\right),\n$$\nwhere $r_t \\in \\mathbb{R}^N$ is the vector of firing rates at time $t$, $\\phi(\\cdot)$ is a static nonlinear transfer function with local slope $\\phi'(u^*) = g$ evaluated at the fixed point input $u^* = W' r^*$, and $W'$ is the post-lesion connectivity matrix defined by a selective loss of recurrent collaterals. The selective loss is restricted to off-diagonal elements to reflect microanatomical pruning of recurrent collaterals while keeping self-terms unchanged. Let the lesion fraction be $f \\in [0,1]$, and define\n$$\nW' \\equiv \\operatorname{diag}(\\operatorname{diag}(W)) + (1 - f)\\,\\big(W - \\operatorname{diag}(\\operatorname{diag}(W))\\big).\n$$\nAssume that near any candidate fixed point $r^*$ the population operates in the approximately linear regime of the nonlinearity with constant slope $g > 0$. From first principles of linear stability analysis and linear algebra, derive how to decide stability of an attractor $r^*$ by analyzing the linearization of the update map around $r^*$, and express a scalar stability margin\n$$\nm \\equiv 1 - \\rho(J),\n$$\nwhere $\\rho(\\cdot)$ denotes the spectral radius of the Jacobian matrix $J$ of the linearized map at $r^*$. A positive $m$ indicates local asymptotic stability, and a negative $m$ indicates local instability. You must explicitly account for the anatomical selectivity of the lesion via $f$ and the fact that only off-diagonal entries of $W$ are scaled.\n\nYour task is to write a program that, for each test case, constructs $W'$ from $W$ and $f$, forms the appropriate linearization, computes the spectral radius, and outputs the stability margin $m$. Report each margin rounded to $6$ decimal places.\n\nUse the following fixed microanatomical connectivity matrix of size $N = 5$:\n$$\nW = \\begin{bmatrix}\n0 & 0.15 & 0.05 & 0.00 & 0.20 \\\\\n0.15 & 0 & 0.10 & 0.05 & 0.00 \\\\\n0.05 & 0.10 & 0 & 0.15 & 0.05 \\\\\n0.00 & 0.05 & 0.15 & 0 & 0.10 \\\\\n0.20 & 0.00 & 0.05 & 0.10 & 0\n\\end{bmatrix}.\n$$\n\nUse the discrete-time step size $\\alpha = 0.20$. For each test case, you will be given $(g, f)$, where $g$ is the local slope of the transfer function at the fixed point and $f$ is the lesion fraction as defined above. Compute the stability margin $m$ for the following test suite:\n- Test $1$: $(g, f) = (0.90, 0.00)$.\n- Test $2$: $(g, f) = (0.90, 0.50)$.\n- Test $3$: $(g, f) = (3.00, 0.00)$.\n- Test $4$: $(g, f) = (3.00, 0.75)$.\n- Test $5$: $(g, f) = (4.00, 1.00)$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “$[0.123456,0.000000,-0.250000]$”). Round each $m$ to $6$ decimal places. No additional text should be printed.", "solution": "We start from a firing-rate description of a recurrent excitatory network of Cornu Ammonis area 3 (CA3) pyramidal neurons. The microanatomical connectivity is represented by a weight matrix $W \\in \\mathbb{R}^{N \\times N}$, with $W_{ii} = 0$ (no autapses), and $W_{ij} \\ge 0$ encoding the strength of recurrent collaterals. Selective loss of CA3 recurrent collaterals corresponds to pruning only off-diagonal connections; anatomically, this preserves the absence of autapses and does not modify diagonal entries. With a lesion fraction $f \\in [0,1]$, the post-lesion matrix is\n$$\nW' = \\operatorname{diag}(\\operatorname{diag}(W)) + (1 - f)\\,\\big(W - \\operatorname{diag}(\\operatorname{diag}(W))\\big).\n$$\nBecause $W_{ii} = 0$ in our setting, this simplifies numerically to $W' = (1 - f) W$, but we keep the explicit decomposition to remain faithful to the microanatomical rule.\n\nThe discrete-time population dynamics with Euler step $\\alpha \\in (0,1)$ is\n$$\nr_{t+1} = (1 - \\alpha)\\, r_t + \\alpha\\, \\phi\\!\\left(W'\\, r_t\\right),\n$$\nwhere $r_t \\in \\mathbb{R}^N$, and $\\phi(\\cdot)$ is a static nonlinearity. A fixed point $r^*$ satisfies\n$$\nr^* = (1 - \\alpha)\\, r^* + \\alpha\\, \\phi\\!\\left(W' r^*\\right),\n$$\nwhich reduces to $r^* = \\phi(W' r^*)$.\n\nTo assess local stability of $r^*$, we linearize the update map around $r^*$. Let $\\delta r_t = r_t - r^*$ denote a small perturbation. A first-order Taylor expansion gives\n$$\n\\delta r_{t+1} \\approx (1 - \\alpha)\\, \\delta r_t + \\alpha\\, \\underbrace{\\left.\\frac{\\partial \\phi}{\\partial u}\\right|_{u = W' r^*}}_{=\\,g}\\, W'\\, \\delta r_t,\n$$\nwhere we approximate the slope of the nonlinearity at the operating point by a constant $g = \\phi'(W' r^*) > 0$ (homogeneous slope assumption in the local regime). Therefore, the Jacobian of the linearized map is\n$$\nJ = (1 - \\alpha)\\, I + \\alpha\\, g\\, W',\n$$\nwhere $I$ is the identity matrix.\n\nA fixed point $r^*$ is locally asymptotically stable if and only if all eigenvalues of $J$ lie strictly inside the unit disk in the complex plane, that is, if the spectral radius $\\rho(J) < 1$. A scalar stability margin that quantifies the distance to the stability boundary is\n$$\nm \\equiv 1 - \\rho(J).\n$$\nThus $m > 0$ indicates local stability, and $m < 0$ indicates local instability. This criterion follows from linear stability analysis of discrete-time dynamical systems.\n\nWe now connect the lesion to $J$. By construction,\n$$\nW' = \\operatorname{diag}(\\operatorname{diag}(W)) + (1 - f)\\,\\big(W - \\operatorname{diag}(\\operatorname{diag}(W))\\big).\n$$\nIn our test matrix, $W_{ii} = 0$ for all $i$, so numerically $W' = (1 - f)\\, W$. Using linear algebra, the spectrum of an affine transformation of a matrix satisfies\n$$\n\\operatorname{spec}\\!\\big(a I + b W'\\big) = \\left\\{ a + b \\lambda \\,:\\, \\lambda \\in \\operatorname{spec}(W') \\right\\}.\n$$\nTherefore, if $\\lambda$ is an eigenvalue of $W'$, then $\\mu = (1 - \\alpha) + \\alpha g \\lambda$ is an eigenvalue of $J$, and\n$$\n\\rho(J) = \\max_{\\lambda \\in \\operatorname{spec}(W')} \\left| (1 - \\alpha) + \\alpha g \\lambda \\right|.\n$$\nSince $W'$ is a nonnegative matrix and our chosen $W$ is symmetric, its eigenvalues are real and the dominant eigenvalue is nonnegative. Selective loss scales the off-diagonal entries and, with zero diagonal, scales the entire $W$ by $(1 - f)$, so the eigenvalues scale as $\\lambda' = (1 - f)\\, \\lambda$. Consequently,\n$$\n\\rho(J) = \\max_{\\lambda \\in \\operatorname{spec}(W)} \\left| (1 - \\alpha) + \\alpha g (1 - f)\\, \\lambda \\right|.\n$$\nThis shows that increasing $f$ (more loss of recurrent collaterals) reduces $\\rho(J)$ linearly in $(1 - f)$, thereby increasing the margin $m$ and stabilizing the fixed points, at the cost of weakening recurrent amplification that underlies strong attractor dynamics.\n\nAlgorithm:\n1. Construct $W$ as given.\n2. For each test case $(g, f)$, build $W'$ using the microanatomical rule.\n3. Form $J = (1 - \\alpha)\\, I + \\alpha g W'$.\n4. Compute $\\rho(J)$ as the maximum absolute eigenvalue of $J$.\n5. Compute $m = 1 - \\rho(J)$ and round to $6$ decimal places.\n\nEdge cases in the test suite:\n- $f = 0$ (intact recurrence), demonstrating baseline attractor strength.\n- $f = 0.5$ (partial loss), showing increased margin from weakened recurrence.\n- Large $g$ with $f = 0$, possibly yielding $\\rho(J) > 1$ and negative $m$ (instability).\n- Large $g$ with substantial loss $f = 0.75$, restoring stability.\n- $f = 1$ (no recurrence), in which case $W' = 0$ and $\\rho(J) = |1 - \\alpha|$, so $m = 1 - |1 - \\alpha| = \\alpha$.\n\nThe program implements these steps and outputs the list of stability margins $m$, each rounded to $6$ decimal places, in the required single-line format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef stability_margin(W, g, f, alpha):\n    \"\"\"\n    Compute the stability margin m = 1 - rho(J) for the discrete-time rate model:\n        r_{t+1} = (1 - alpha) r_t + alpha * phi(W' r_t)\n    with local slope g at the fixed point and selective lesion fraction f applied\n    to off-diagonal elements of W to produce W'.\n    \"\"\"\n    # Apply selective loss to off-diagonal elements: W' = D + (1 - f) * (W - D)\n    D = np.diag(np.diag(W))\n    W_off = W - D\n    W_post = D + (1.0 - f) * W_off\n\n    # Jacobian of the linearized map: J = (1 - alpha) I + alpha * g * W_post\n    N = W.shape[0]\n    J = (1.0 - alpha) * np.eye(N) + alpha * g * W_post\n\n    # Spectral radius of J\n    eigvals = np.linalg.eigvals(J)\n    rho = np.max(np.abs(eigvals))\n\n    # Stability margin\n    m = 1.0 - float(rho)\n    return m\n\ndef solve():\n    # Define the fixed microanatomical connectivity matrix W (N=5)\n    W = np.array([\n        [0.00, 0.15, 0.05, 0.00, 0.20],\n        [0.15, 0.00, 0.10, 0.05, 0.00],\n        [0.05, 0.10, 0.00, 0.15, 0.05],\n        [0.00, 0.05, 0.15, 0.00, 0.10],\n        [0.20, 0.00, 0.05, 0.10, 0.00]\n    ], dtype=float)\n\n    alpha = 0.20\n\n    # Test suite: (g, f)\n    test_cases = [\n        (0.90, 0.00),  # Test 1\n        (0.90, 0.50),  # Test 2\n        (3.00, 0.00),  # Test 3\n        (3.00, 0.75),  # Test 4\n        (4.00, 1.00),  # Test 5\n    ]\n\n    results = []\n    for g, f in test_cases:\n        m = stability_margin(W, g, f, alpha)\n        results.append(f\"{m:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2721344"}]}