{"hands_on_practices": [{"introduction": "The rapid upswing of the action potential is driven by a massive, transient influx of sodium ions, causing a rapid depolarization of the membrane. This exercise provides a quantitative snapshot of this process by challenging you to calculate the net ionic current at a specific moment during the rising phase. By applying the parallel conductance model, you will see firsthand how the large sodium conductance dominates over other currents to produce the strong net inward current that serves as the engine for depolarization [@problem_id:2719330].", "problem": "A neuron is held under a voltage-clamp at membrane potential $V = -40\\,\\mathrm{mV}$ during the early rising phase of its action potential, when voltage-gated sodium and potassium channels are partially activated. At this instant, the measured maximal chord conductances are $g_{\\mathrm{Na}} = 20\\,\\mathrm{mS/cm^2}$, $g_{\\mathrm{K}} = 10\\,\\mathrm{mS/cm^2}$, and a leak conductance $g_{\\mathrm{L}} = 0.3\\,\\mathrm{mS/cm^2}$. The corresponding reversal potentials are $E_{\\mathrm{Na}} = +60\\,\\mathrm{mV}$, $E_{\\mathrm{K}} = -90\\,\\mathrm{mV}$, and $E_{\\mathrm{L}} = -65\\,\\mathrm{mV}$. Adopt the standard electrophysiological convention that outward positive charge movement is a positive current.\n\nStarting from basic principles about electrochemical driving forces and ohmic conductance, and without assuming any specific model of gating kinetics, compute the instantaneous net ionic current across the membrane at this voltage by appropriately combining the contributions of sodium, potassium, and leak pathways.\n\nExpress your final answer in microamperes per square centimeter and round your answer to four significant figures.", "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective. It presents a standard electrophysiological calculation based on the parallel conductance model of a neuronal membrane. The provided parameters are within a physiologically plausible range.\n\nThe fundamental principle for calculating the net ionic current across a membrane is that the membrane can be modeled as an electrical circuit with several parallel branches. Each branch corresponds to a specific type of ion channel (sodium, potassium, leak) and is characterized by a conductance and a reversal potential (electromotive force). The total current density, $I_{\\mathrm{net}}$, is the algebraic sum of the individual current densities for each ion type.\n\n$$I_{\\mathrm{net}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}}$$\n\nEach individual ionic current, $I_{\\mathrm{ion}}$, follows Ohm's law, where the current is the product of the ionic conductance, $g_{\\mathrm{ion}}$, and the electrochemical driving force. The driving force for an ion is the difference between the membrane potential, $V$, and the ion's Nernst or reversal potential, $E_{\\mathrm{ion}}$.\n\n$$I_{\\mathrm{ion}} = g_{\\mathrm{ion}} (V - E_{\\mathrm{ion}})$$\n\nThe problem specifies the electrophysiological convention where outward movement of positive charge is a positive current. This convention is consistent with the formula above. For a positive ion, if $V > E_{\\mathrm{ion}}$, the driving force is positive, leading to an outward flux of charge and thus a positive current.\n\nThe problem provides the following values:\nMembrane potential: $V = -40\\,\\mathrm{mV}$\nSodium conductance: $g_{\\mathrm{Na}} = 20\\,\\mathrm{mS/cm^2}$\nPotassium conductance: $g_{\\mathrm{K}} = 10\\,\\mathrm{mS/cm^2}$\nLeak conductance: $g_{\\mathrm{L}} = 0.3\\,\\mathrm{mS/cm^2}$\nSodium reversal potential: $E_{\\mathrm{Na}} = +60\\,\\mathrm{mV}$\nPotassium reversal potential: $E_{\\mathrm{K}} = -90\\,\\mathrm{mV}$\nLeak reversal potential: $E_{\\mathrm{L}} = -65\\,\\mathrm{mV}$\n\nThe problem asks for the net current density. The term \"maximal chord conductances\" for $g_{\\mathrm{Na}}$ and $g_{\\mathrm{K}}$ is interpreted as the instantaneous conductances at the moment of measurement, as any other interpretation would render the problem unsolvable without information about gating variables.\n\nThe expression for the net current density is:\n$$I_{\\mathrm{net}} = g_{\\mathrm{Na}} (V - E_{\\mathrm{Na}}) + g_{\\mathrm{K}} (V - E_{\\mathrm{K}}) + g_{\\mathrm{L}} (V - E_{\\mathrm{L}})$$\n\nWe now substitute the given numerical values. It is important to handle the units correctly. A current density is calculated from conductance density ($\\mathrm{S/cm^2}$) and potential ($\\mathrm{V}$). Here, the units are $\\mathrm{mS/cm^2}$ and $\\mathrm{mV}$. Let us analyze the product of these units:\n$$(1\\,\\mathrm{mS/cm^2}) \\times (1\\,\\mathrm{mV}) = (10^{-3}\\,\\mathrm{S/cm^2}) \\times (10^{-3}\\,\\mathrm{V}) = 10^{-6}\\,\\mathrm{A/cm^2} = 1\\,\\mathrm{\\mu A/cm^2}$$\nThus, by directly multiplying the given numerical values, the result will be in $\\mathrm{\\mu A/cm^2}$, which is the desired unit for the final answer.\n\nFirst, calculate the driving force for each ion:\nDriving force for $\\mathrm{Na}^+$: $V - E_{\\mathrm{Na}} = -40\\,\\mathrm{mV} - 60\\,\\mathrm{mV} = -100\\,\\mathrm{mV}$\nDriving force for $\\mathrm{K}^+$: $V - E_{\\mathrm{K}} = -40\\,\\mathrm{mV} - (-90\\,\\mathrm{mV}) = -40\\,\\mathrm{mV} + 90\\,\\mathrm{mV} = 50\\,\\mathrm{mV}$\nDriving force for leak: $V - E_{\\mathrm{L}} = -40\\,\\mathrm{mV} - (-65\\,\\mathrm{mV}) = -40\\,\\mathrm{mV} + 65\\,\\mathrm{mV} = 25\\,\\mathrm{mV}$\n\nNext, calculate the individual current densities:\nSodium current density: $I_{\\mathrm{Na}} = g_{\\mathrm{Na}} (V - E_{\\mathrm{Na}}) = (20\\,\\mathrm{mS/cm^2}) \\times (-100\\,\\mathrm{mV}) = -2000\\,\\mathrm{\\mu A/cm^2}$. The negative sign indicates a net inward flow of positive sodium ions.\nPotassium current density: $I_{\\mathrm{K}} = g_{\\mathrm{K}} (V - E_{\\mathrm{K}}) = (10\\,\\mathrm{mS/cm^2}) \\times (50\\,\\mathrm{mV}) = 500\\,\\mathrm{\\mu A/cm^2}$. The positive sign indicates a net outward flow of positive potassium ions.\nLeak current density: $I_{\\mathrm{L}} = g_{\\mathrm{L}} (V - E_{\\mathrm{L}}) = (0.3\\,\\mathrm{mS/cm^2}) \\times (25\\,\\mathrm{mV}) = 7.5\\,\\mathrm{\\mu A/cm^2}$. The positive sign indicates a net outward flow of positive charge.\n\nFinally, sum the individual current densities to find the net current density:\n$$I_{\\mathrm{net}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}} = -2000\\,\\mathrm{\\mu A/cm^2} + 500\\,\\mathrm{\\mu A/cm^2} + 7.5\\,\\mathrm{\\mu A/cm^2}$$\n$$I_{\\mathrm{net}} = -1492.5\\,\\mathrm{\\mu A/cm^2}$$\n\nThis result confirms the physiological state described. A large net inward (negative) current is responsible for the rapid depolarization during the rising phase of the action potential. This current is dominated by the influx of sodium ions, which overcomes the smaller outward potassium and leak currents.\n\nThe problem requires the answer to be rounded to four significant figures. The calculated value is $-1492.5$. Rounding this to four significant figures gives $-1493$.", "answer": "$$\\boxed{-1493}$$", "id": "2719330"}, {"introduction": "What stops the action potential from rising indefinitely towards the sodium reversal potential? This practice explores the principle of current balance that occurs at the very peak of the spike, where the membrane potential momentarily stops changing ($dV/dt=0$) [@problem_id:2719338]. You will calculate the peak voltage by setting the net ionic current to zero, an exercise which reveals that the peak potential is a weighted average of the various ionic reversal potentials, determined by the relative conductances of the ion channels at that precise instant.", "problem": "A voltage-clamped neuron with physiologically realistic sodium, potassium, and leak pathways is released into current clamp to generate a single action potential. At the instant of the spike apex, the time derivative of the membrane potential is zero and no externally injected current flows at that instant. Assume only ohmic sodium, potassium, and leak currents contribute at this moment, with reversal potentials $E_{\\mathrm{Na}} = +60$ mV, $E_{\\mathrm{K}} = -90$ mV, and $E_{\\mathrm{L}} = -65$ mV. Due to a loss-of-function mutation in the sodium channel and a concurrent upregulation of delayed-rectifier potassium channels, the instantaneous conductance ratio at the spike apex is $g_{\\mathrm{Na}} : g_{\\mathrm{K}} : g_{\\mathrm{L}} = 5 : 3 : 0.3$.\n\nUsing only first-principles current balance at the apex and standard biophysical definitions, compute the membrane potential at the spike apex, $V_{\\mathrm{peak}}$. Round your answer to four significant figures and express it in mV. Provide only the final numerical value for $V_{\\mathrm{peak}}$ in mV as your answer.", "solution": "The problem requires the calculation of the membrane potential at the apex of an action potential, denoted as $V_{\\mathrm{peak}}$. The analysis begins with the fundamental current balance equation for a single-compartment neuron, which is an application of Kirchhoff's current law to the cell membrane. The total membrane current, which is proportional to the rate of change of membrane potential $V_m$, is the sum of the externally injected current $I_{\\mathrm{ext}}$ and the total ionic current $I_{\\mathrm{ion}}$.\n\nThe membrane equation is given by:\n$$C_m \\frac{dV_m}{dt} = I_{\\mathrm{ext}} - I_{\\mathrm{ion}}$$\nwhere $C_m$ is the membrane capacitance.\n\nThe problem states that at the instant of the spike apex, the time derivative of the membrane potential is zero, $\\frac{dV_m}{dt} = 0$. It also specifies that no external current is injected at this instant, so $I_{\\mathrm{ext}} = 0$. Substituting these conditions into the membrane equation yields:\n$$C_m \\cdot 0 = 0 - I_{\\mathrm{ion}}$$\n$$I_{\\mathrm{ion}} = 0$$\n\nThis means that at the peak of the action potential, the sum of all ionic currents flowing across the membrane is zero. The problem specifies three contributing currents: a sodium current ($I_{\\mathrm{Na}}$), a potassium current ($I_{\\mathrm{K}}$), and a leak current ($I_{\\mathrm{L}}$). Therefore, the total ionic current is:\n$$I_{\\mathrm{ion}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}}$$\nSetting this sum to zero, we have:\n$$I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}} = 0$$\n\nThese currents are assumed to be ohmic, meaning each current $I_x$ follows the form $I_x = g_x (V_m - E_x)$, where $g_x$ is the instantaneous conductance for ion species $x$ and $E_x$ is its Nernst (reversal) potential. At the spike apex, the membrane potential is $V_{\\mathrm{peak}}$. The current balance equation thus becomes:\n$$g_{\\mathrm{Na}}(V_{\\mathrm{peak}} - E_{\\mathrm{Na}}) + g_{\\mathrm{K}}(V_{\\mathrm{peak}} - E_{\\mathrm{K}}) + g_{\\mathrm{L}}(V_{\\mathrm{peak}} - E_{\\mathrm{L}}) = 0$$\n\nWe must now solve this equation for $V_{\\mathrm{peak}}$. We expand the terms:\n$$g_{\\mathrm{Na}}V_{\\mathrm{peak}} - g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{K}}V_{\\mathrm{peak}} - g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{L}}V_{\\mathrm{peak}} - g_{\\mathrm{L}}E_{\\mathrm{L}} = 0$$\n\nGroup the terms containing $V_{\\mathrm{peak}}$:\n$$V_{\\mathrm{peak}}(g_{\\mathrm{Na}} + g_{\\mathrm{K}} + g_{\\mathrm{L}}) = g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{L}}E_{\\mathrm{L}}$$\n\nIsolating $V_{\\mathrm{peak}}$ gives the general expression:\n$$V_{\\mathrm{peak}} = \\frac{g_{\\mathrm{Na}}E_{\\mathrm{Na}} + g_{\\mathrm{K}}E_{\\mathrm{K}} + g_{\\mathrm{L}}E_{\\mathrm{L}}}{g_{\\mathrm{Na}} + g_{\\mathrm{K}} + g_{\\mathrm{L}}}$$\nThis shows that $V_{\\mathrm{peak}}$ is a weighted average of the reversal potentials, where the weights are the respective instantaneous conductances.\n\nThe problem provides the ratio of conductances at the spike apex: $g_{\\mathrm{Na}} : g_{\\mathrm{K}} : g_{\\mathrm{L}} = 5 : 3 : 0.3$. We can express the individual conductances in terms of a single proportionality constant, $k$:\n$$g_{\\mathrm{Na}} = 5k$$\n$$g_{\\mathrm{K}} = 3k$$\n$$g_{\\mathrm{L}} = 0.3k$$\nSubstituting these into the expression for $V_{\\mathrm{peak}}$:\n$$V_{\\mathrm{peak}} = \\frac{(5k)E_{\\mathrm{Na}} + (3k)E_{\\mathrm{K}} + (0.3k)E_{\\mathrm{L}}}{5k + 3k + 0.3k}$$\nThe constant $k$ is non-zero and can be factored out from both the numerator and the denominator, thus canceling out:\n$$V_{\\mathrm{peak}} = \\frac{k(5E_{\\mathrm{Na}} + 3E_{\\mathrm{K}} + 0.3E_{\\mathrm{L}})}{k(5 + 3 + 0.3)} = \\frac{5E_{\\mathrm{Na}} + 3E_{\\mathrm{K}} + 0.3E_{\\mathrm{L}}}{5 + 3 + 0.3}$$\nThis demonstrates that only the relative proportions of the conductances are required to determine the potential at which the net current is zero.\n\nNow, we substitute the given numerical values for the reversal potentials: $E_{\\mathrm{Na}} = +60$ mV, $E_{\\mathrm{K}} = -90$ mV, and $E_{\\mathrm{L}} = -65$ mV.\n$$V_{\\mathrm{peak}} = \\frac{5(60) + 3(-90) + 0.3(-65)}{5 + 3 + 0.3}$$\n\nCalculate the numerator:\n$$\n5 \\times 60 = 300 \\\\\n3 \\times (-90) = -270 \\\\\n0.3 \\times (-65) = -19.5 \\\\\n\\text{Numerator} = 300 - 270 - 19.5 = 30 - 19.5 = 10.5\n$$\n\nCalculate the denominator:\n$$\n\\text{Denominator} = 5 + 3 + 0.3 = 8.3\n$$\n\nThus, the value of $V_{\\mathrm{peak}}$ is:\n$$V_{\\mathrm{peak}} = \\frac{10.5}{8.3} \\approx 1.26506024... \\text{ mV}$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$V_{\\mathrm{peak}} \\approx 1.265 \\text{ mV}$$", "answer": "$$\\boxed{1.265}$$", "id": "2719338"}, {"introduction": "To truly grasp the dynamic interplay of ion channels over the entire course of an action potential, we can move from static calculations to a full simulation using the celebrated Hodgkin-Huxley model. This coding exercise challenges you to model the effects of a partial sodium channel block, simulating the action of a neurotoxin, on the action potential's amplitude and rise time. This \"virtual pharmacology\" experiment solidifies the crucial link between a specific channel's maximal conductance, $\\bar{g}_{\\text{Na}}$, and the macroscopic shape of the neural signal [@problem_id:2719381].", "problem": "Construct a program that predicts how reducing the maximal sodium conductance affects the action potential rise time and amplitude using a Hodgkin–Huxley (HH) single-compartment neuron model. Begin from the following fundamental base and well-tested formulas.\n\n1) Membrane dynamics. The membrane potential $V$ obeys the current balance\n$$ C_m \\frac{dV}{dt} = I_{\\text{inj}}(t) - I_{\\text{Na}}(V,m,h) - I_{\\text{K}}(V,n) - I_{\\text{L}}(V), $$\nwhere $C_m$ is the membrane capacitance and $I_{\\text{inj}}(t)$ is an externally injected current. The ionic currents are\n$$ I_{\\text{Na}} = \\bar{g}_{\\text{Na}} \\, m^3 h \\, (V - E_{\\text{Na}}), \\quad I_{\\text{K}} = \\bar{g}_{\\text{K}} \\, n^4 \\, (V - E_{\\text{K}}), \\quad I_{\\text{L}} = \\bar{g}_{\\text{L}} \\, (V - E_{\\text{L}}), $$\nwith $m, h, n$ being gating variables in $[0,1]$.\n\n2) Gating kinetics. Each gating variable $x \\in \\{m,h,n\\}$ evolves according to first-order kinetics\n$$ \\frac{dx}{dt} = \\alpha_x(V) \\, (1-x) - \\beta_x(V) \\, x. $$\nUse the classical Hodgkin–Huxley rate functions (all voltages in millivolts, time in milliseconds):\n- $$ \\alpha_m(V) = 0.1 \\cdot \\frac{V+40}{1 - e^{-(V+40)/10}}, \\quad \\beta_m(V) = 4 \\, e^{-(V+65)/18}, $$\n- $$ \\alpha_h(V) = 0.07 \\, e^{-(V+65)/20}, \\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}}, $$\n- $$ \\alpha_n(V) = 0.01 \\cdot \\frac{V+55}{1 - e^{-(V+55)/10}}, \\quad \\beta_n(V) = 0.125 \\, e^{-(V+65)/80}. $$\nFor numerical stability, when the expressions of the form $\\frac{x}{1-e^{-x/k}}$ encounter $x \\approx 0$, use the continuous limit obtained by L’Hôpital’s rule.\n\n3) Parameters and units. Use $C_m = 1$ microfarad per square centimeter ($\\mu$F/cm$^2$), $\\bar{g}_{\\text{Na}} = 120$ millisiemens per square centimeter (mS/cm$^2$), $\\bar{g}_{\\text{K}} = 36$ mS/cm$^2$, $\\bar{g}_{\\text{L}} = 0.3$ mS/cm$^2$, $E_{\\text{Na}} = 50$ millivolts (mV), $E_{\\text{K}} = -77$ mV, and $E_{\\text{L}} = -54.4$ mV. Initialize at $V(0) = -65$ mV and set $m(0), h(0), n(0)$ to their steady states at $V=-65$ mV, i.e., $x(0) = \\alpha_x(V)/(\\alpha_x(V)+\\beta_x(V))$.\n\n4) Stimulation protocol. Inject a square pulse current:\n- Amplitude $I_0 = 10$ microamperes per square centimeter ($\\mu$A/cm$^2$),\n- Onset time $t_{\\text{on}} = 10$ milliseconds (ms),\n- Offset time $t_{\\text{off}} = 11$ ms.\nOutside this interval, $I_{\\text{inj}}(t) = 0$.\n\n5) Numerical integration. Integrate from $t=0$ ms to $t=30$ ms with a fixed time step $\\Delta t = 0.01$ ms, using a stable, explicit method for ordinary differential equations. All calculations are to be done in the units stated above. Compute the resting potential $V_{\\text{rest}}$ as the time average of $V(t)$ over the interval $t \\in [5,10]$ ms.\n\n6) Measurement definitions. Define action potential amplitude and rise time as follows:\n- Amplitude $A$ equals the difference between the first peak voltage after stimulation and the resting voltage, i.e., $A = V_{\\text{peak}} - V_{\\text{rest}}$ (in mV).\n- Rise time $T_{\\text{rise}}$ equals the time difference between the moment the upstroke begins and the peak time (in ms). Operationally, detect the onset of the upstroke as the first time $t_{\\theta}$ at or after $t_{\\text{on}}$ where the numerical time derivative satisfies $\\frac{dV}{dt} \\ge s_{\\theta}$ with slope threshold $s_{\\theta} = 20$ mV/ms. Then $T_{\\text{rise}} = t_{\\text{peak}} - t_{\\theta}$, where $t_{\\text{peak}}$ is the time of the subsequent local maximum of $V(t)$ within $10$ ms after $t_{\\theta}$.\n- Spike existence criterion: only report an action potential if the detected peak satisfies $V_{\\text{peak}} \\ge 0$ mV. If no such peak is found, or no upstroke onset is detected, return the pair $[-1.0,-1.0]$ for that test case.\n\n7) Sodium channel block protocol. Model a partial block of sodium channels by scaling $\\bar{g}_{\\text{Na}}$ by a factor $s \\in (0,1]$, i.e., use $\\bar{g}_{\\text{Na,eff}} = s \\cdot \\bar{g}_{\\text{Na}}$.\n\nTest Suite:\n- Case $1$: $s = 1.0$ (no block).\n- Case $2$: $s = 0.5$ (fifty percent reduction).\n- Case $3$: $s = 0.2$ (strong reduction).\n- Case $4$: $s = 0.1$ (near-complete block).\n\nRequired Output:\n- For each case, compute $[A, T_{\\text{rise}}]$ where $A$ is in mV and $T_{\\text{rise}}$ is in ms, rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each case itself represented as a two-element list, in the order of the test suite above. For example, a valid output format is\n$$ [[A_1,T_{\\text{rise},1}],[A_2,T_{\\text{rise},2}],[A_3,T_{\\text{rise},3}],[A_4,T_{\\text{rise},4}]]. $$\nNo other text should be printed.", "solution": "We aim to predict how partial block of sodium channels, implemented as a reduction in the maximal sodium conductance $\\bar{g}_{\\text{Na}}$, affects the action potential rise time and amplitude. The solution proceeds from the Hodgkin–Huxley (HH) formalism, which is a well-tested, biophysically grounded model for the ionic basis of action potentials.\n\n1) Fundamental equations. The dynamics of the membrane potential $V$ follow the capacitive current balance\n$$ C_m \\frac{dV}{dt} = I_{\\text{inj}}(t) - I_{\\text{Na}}(V,m,h) - I_{\\text{K}}(V,n) - I_{\\text{L}}(V), $$\nwhere $C_m$ is the membrane capacitance per area, and $I_{\\text{inj}}(t)$ is an externally injected current density. The ionic currents are\n$$ I_{\\text{Na}} = \\bar{g}_{\\text{Na}} m^3 h (V - E_{\\text{Na}}), \\quad I_{\\text{K}} = \\bar{g}_{\\text{K}} n^4 (V - E_{\\text{K}}), \\quad I_{\\text{L}} = \\bar{g}_{\\text{L}} (V - E_{\\text{L}}). $$\nThe gating variables $m, h, n$ obey first-order kinetics with voltage-dependent rates:\n$$ \\frac{dx}{dt} = \\alpha_x(V) (1-x) - \\beta_x(V) x, \\quad x \\in \\{m,h,n\\}. $$\nThe rate functions are the classical Hodgkin–Huxley expressions:\n- $$ \\alpha_m(V) = 0.1 \\cdot \\frac{V+40}{1 - e^{-(V+40)/10}}, \\quad \\beta_m(V) = 4 \\, e^{-(V+65)/18}, $$\n- $$ \\alpha_h(V) = 0.07 \\, e^{-(V+65)/20}, \\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V+35)/10}}, $$\n- $$ \\alpha_n(V) = 0.01 \\cdot \\frac{V+55}{1 - e^{-(V+55)/10}}, \\quad \\beta_n(V) = 0.125 \\, e^{-(V+65)/80}. $$\nWhen denominators approach zero, we use the continuous limit via L’Hôpital’s rule, which yields finite values (e.g., for $\\alpha_m$ at $V=-40$ mV, the limiting value is $1.0$ ms$^{-1}$). This ensures numerical stability.\n\n2) Parameters and units. We use $C_m = 1$ $\\mu$F/cm$^2$, $\\bar{g}_{\\text{Na}} = 120$ mS/cm$^2$, $\\bar{g}_{\\text{K}} = 36$ mS/cm$^2$, $\\bar{g}_{\\text{L}} = 0.3$ mS/cm$^2$, $E_{\\text{Na}} = 50$ mV, $E_{\\text{K}} = -77$ mV, $E_{\\text{L}} = -54.4$ mV. The initial conditions are $V(0) = -65$ mV and $x(0) = \\alpha_x(V)/(\\alpha_x(V)+\\beta_x(V))$ for $x \\in \\{m,h,n\\}$ at $V=-65$ mV. The injected current is a square pulse with amplitude $I_0 = 10$ $\\mu$A/cm$^2$, turned on at $t_{\\text{on}}=10$ ms and turned off at $t_{\\text{off}}=11$ ms. We integrate from $t=0$ ms to $t=30$ ms with a fixed step $\\Delta t = 0.01$ ms.\n\n3) Numerical method. We use an explicit fixed-step integrator (forward Euler) appropriate for these time scales when $\\Delta t$ is sufficiently small relative to the fastest gating kinetics. At each step, we update $m, h, n$ using their differential equations and then update $V$ using the membrane equation. The injected current function $I_{\\text{inj}}(t)$ is piecewise constant as specified.\n\n4) Measurements. We compute the resting potential $V_{\\text{rest}}$ by averaging $V(t)$ over $t \\in [5,10]$ ms; this pre-stimulus window allows transients from initialization to decay. We detect the onset of the upstroke at the first time $t_{\\theta} \\ge t_{\\text{on}}$ where the finite-difference estimate of the derivative satisfies $\\frac{dV}{dt} \\ge s_{\\theta}$ with $s_{\\theta}=20$ mV/ms. We then search for the subsequent local maximum $V_{\\text{peak}}$ within $10$ ms after $t_{\\theta}$ and compute the amplitude $A = V_{\\text{peak}} - V_{\\text{rest}}$ and rise time $T_{\\text{rise}} = t_{\\text{peak}} - t_{\\theta}$. We declare a successful spike only if $V_{\\text{peak}} \\ge 0$ mV. If upstroke onset is not detected, the peak is not found, or $V_{\\text{peak}} < 0$ mV, we return the failure pair $[-1.0,-1.0]$.\n\n5) Modeling sodium channel block. A partial block is modeled by scaling the maximal sodium conductance as $\\bar{g}_{\\text{Na,eff}} = s \\cdot \\bar{g}_{\\text{Na}}$ with $s \\in (0,1]$. Reducing $s$ lowers the maximal inward sodium current $I_{\\text{Na}}$, which has two principal effects derived from the membrane equation:\n- It reduces $\\frac{dV}{dt}$ during the rising phase because the net inward current is smaller for a given $V$ and gating state, leading to a longer time to reach the peak. Thus, the rise time $T_{\\text{rise}}$ increases as $s$ decreases.\n- It reduces the attainable peak voltage because the sodium driving term $\\bar{g}_{\\text{Na}} m^3 h (V - E_{\\text{Na}})$ saturates at a lower value, while outward potassium and leak currents oppose depolarization. Consequently, the amplitude $A$ decreases with decreasing $s$, and for sufficiently small $s$ there may be no spike (fail criterion).\n\n6) Test suite and output. We evaluate four cases $s \\in \\{1.0, 0.5, 0.2, 0.1\\}$. For each, we simulate, measure $[A, T_{\\text{rise}}]$ in mV and ms, round to three decimal places, and output a single line containing the list\n$$ [[A_1,T_{\\text{rise},1}],[A_2,T_{\\text{rise},2}],[A_3,T_{\\text{rise},3}],[A_4,T_{\\text{rise},4}]]. $$\n\nThis algorithmic procedure directly instantiates the ionic basis of threshold and the phases of the action potential: the threshold crossing arises when the net inward sodium current exceeds outward currents to yield a positive $\\frac{dV}{dt}$ beyond a specified slope; the rising phase is dominated by the sodium activation variable $m$ with $h$ inactivation, the falling phase and undershoot are governed by delayed rectifier potassium activation $n$ and the return of $h$, and the amplitude and rise time are jointly determined by the interplay between $\\bar{g}_{\\text{Na}}$ and $\\bar{g}_{\\text{K}}$ as encoded in the differential equations. Reducing $\\bar{g}_{\\text{Na}}$ therefore predictably slows the upstroke and reduces the peak, and at sufficiently strong block prevents spike initiation under the fixed stimulus.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef vtrap(x, y):\n    # Safe evaluation of x / (1 - exp(-x/y)) with limit as x->0 being y\n    # Using series: as x->0, 1 - exp(-x/y) ~ x/y => ratio ~ y\n    # Implement a threshold to avoid numerical issues.\n    thresh = 1e-6\n    out = np.empty_like(x, dtype=float) if isinstance(x, np.ndarray) else None\n    if isinstance(x, np.ndarray):\n        mask = np.abs(x) < thresh\n        out[mask] = y\n        out[~mask] = x[~mask] / (1.0 - np.exp(-x[~mask] / y))\n        return out\n    else:\n        xv = float(x)\n        if abs(xv) < thresh:\n            return y\n        return xv / (1.0 - np.exp(-xv / y))\n\ndef alpha_m(V):\n    return 0.1 * vtrap(V + 40.0, 10.0)\n\ndef beta_m(V):\n    return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\ndef alpha_h(V):\n    return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\ndef beta_h(V):\n    return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n\ndef alpha_n(V):\n    return 0.01 * vtrap(V + 55.0, 10.0)\n\ndef beta_n(V):\n    return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\ndef hh_simulation(gNa_scale,\n                  T=30.0, dt=0.01,\n                  Cm=1.0,\n                  gNa_base=120.0, gK=36.0, gL=0.3,\n                  ENa=50.0, EK=-77.0, EL=-54.4,\n                  I0=10.0, ton=10.0, toff=11.0):\n    # Time vector\n    nsteps = int(np.round(T / dt)) + 1\n    t = np.linspace(0.0, T, nsteps)\n    # Allocate\n    V = np.zeros(nsteps, dtype=float)\n    m = np.zeros(nsteps, dtype=float)\n    h = np.zeros(nsteps, dtype=float)\n    n = np.zeros(nsteps, dtype=float)\n    # Initial conditions\n    V[0] = -65.0\n    am = alpha_m(V[0]); bm = beta_m(V[0])\n    ah = alpha_h(V[0]); bh = beta_h(V[0])\n    an = alpha_n(V[0]); bn = beta_n(V[0])\n    m[0] = am / (am + bm)\n    h[0] = ah / (ah + bh)\n    n[0] = an / (an + bn)\n\n    gNa = gNa_base * gNa_scale\n\n    # Injected current as function\n    def I_inj(time):\n        return I0 if (time >= ton and time <= toff) else 0.0\n\n    # Forward Euler integration\n    for i in range(nsteps - 1):\n        Vi = V[i]\n        mi = m[i]\n        hi = h[i]\n        ni = n[i]\n\n        Ina = gNa * (mi**3) * hi * (Vi - ENa)\n        Ik = gK * (ni**4) * (Vi - EK)\n        Il = gL * (Vi - EL)\n        Iion = Ina + Ik + Il\n\n        dVdt = (I_inj(t[i]) - Iion) / Cm\n\n        am = alpha_m(Vi); bm = beta_m(Vi)\n        ah = alpha_h(Vi); bh = beta_h(Vi)\n        an = alpha_n(Vi); bn = beta_n(Vi)\n\n        dmdt = am * (1.0 - mi) - bm * mi\n        dhdt = ah * (1.0 - hi) - bh * hi\n        dndt = an * (1.0 - ni) - bn * ni\n\n        V[i+1] = Vi + dt * dVdt\n        m[i+1] = mi + dt * dmdt\n        h[i+1] = hi + dt * dhdt\n        n[i+1] = ni + dt * dndt\n\n        # Clamp gating variables to [0,1] to avoid numeric drift\n        if m[i+1] < 0.0: m[i+1] = 0.0\n        if m[i+1] > 1.0: m[i+1] = 1.0\n        if h[i+1] < 0.0: h[i+1] = 0.0\n        if h[i+1] > 1.0: h[i+1] = 1.0\n        if n[i+1] < 0.0: n[i+1] = 0.0\n        if n[i+1] > 1.0: n[i+1] = 1.0\n\n    # Compute resting potential as mean over [5,10] ms\n    rest_start = 5.0\n    rest_end = 10.0\n    idx_rest = np.where((t >= rest_start) & (t <= rest_end))[0]\n    Vrest = float(np.mean(V[idx_rest])) if idx_rest.size > 0 else float(V[0])\n\n    # Compute derivative dV/dt by central difference\n    dVdt_num = np.zeros_like(V)\n    dVdt_num[1:-1] = (V[2:] - V[:-2]) / (2.0 * dt)\n    dVdt_num[0] = (V[1] - V[0]) / dt\n    dVdt_num[-1] = (V[-1] - V[-2]) / dt\n\n    # Detect upstroke onset after ton using slope threshold\n    slope_thresh = 20.0  # mV/ms\n    start_idx = np.searchsorted(t, ton, side='left')\n    onset_idx_candidates = np.where((dVdt_num >= slope_thresh) & (np.arange(nsteps) >= start_idx))[0]\n    if onset_idx_candidates.size == 0:\n        return -1.0, -1.0\n    onset_idx = int(onset_idx_candidates[0])\n    t_onset = t[onset_idx]\n\n    # Find peak within 10 ms after onset\n    peak_window_ms = 10.0\n    end_time = t_onset + peak_window_ms\n    end_idx = np.searchsorted(t, end_time, side='right')\n    if end_idx <= onset_idx + 1:\n        return -1.0, -1.0\n    seg = V[onset_idx:end_idx]\n    peak_rel_idx = int(np.argmax(seg))\n    peak_idx = onset_idx + peak_rel_idx\n    Vpeak = float(V[peak_idx])\n    t_peak = float(t[peak_idx])\n\n    # Spike existence criterion: require overshoot to >= 0 mV\n    if Vpeak < 0.0:\n        return -1.0, -1.0\n\n    amplitude = Vpeak - Vrest\n    rise_time = t_peak - t_onset\n    return amplitude, rise_time\n\ndef solve():\n    # Define the test cases from the problem statement: gNa scaling factors\n    test_cases = [1.0, 0.5, 0.2, 0.1]\n\n    results = []\n    for scale in test_cases:\n        amp, rise = hh_simulation(scale)\n        # Round to three decimals as required\n        amp_rounded = round(amp, 3)\n        rise_rounded = round(rise, 3)\n        results.append([amp_rounded, rise_rounded])\n\n    # Final print statement in the exact required format.\n    # Produce a single line: list of [amplitude, rise_time] pairs.\n    # Ensure there is no extra text.\n    # Convert to string manually to avoid spaces variability\n    out = \"[\" + \",\".join(f\"[{pair[0]},{pair[1]}]\" for pair in results) + \"]\"\n    print(out)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2719381"}]}