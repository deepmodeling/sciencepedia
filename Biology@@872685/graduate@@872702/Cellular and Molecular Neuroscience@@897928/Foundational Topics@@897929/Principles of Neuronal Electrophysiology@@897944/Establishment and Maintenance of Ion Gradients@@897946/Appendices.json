{"hands_on_practices": [{"introduction": "The resting membrane potential ($V_m$) is not a fixed value but a dynamic steady state determined by ion concentration gradients and relative permeabilities. This practice delves into the Goldman-Hodgkin-Katz (GHK) equation, the cornerstone model for predicting $V_m$. By first deriving the GHK equation from fundamental Nernst-Planck principles and then applying it to a physiologically relevant scenario, you will gain a quantitative understanding of how the neuron's electrical state is exquisitely sensitive to changes in the extracellular ionic environment, such as the hyperkalemia explored here [@problem_id:2710812].", "problem": "A spherical neuron at temperature $T=310\\,\\mathrm{K}$ is permeable at rest to three monovalent ions: potassium ($\\text{K}^+$), sodium ($\\text{Na}^+$), and chloride ($\\text{Cl}^-$). The intracellular concentrations are $[K^+]_i=140\\,\\mathrm{mM}$, $[Na^+]_i=12\\,\\mathrm{mM}$, and $[Cl^-]_i=5\\,\\mathrm{mM}$. Initially, the extracellular concentrations are $[K^+]_o=3\\,\\mathrm{mM}$, $[Na^+]_o=145\\,\\mathrm{mM}$, and $[Cl^-]_o=120\\,\\mathrm{mM}$. After a perturbation, only the extracellular potassium concentration changes to $[K^+]_o=8\\,\\mathrm{mM}$, while all other concentrations remain fixed. Assume that permeabilities remain at their resting values, with relative permeabilities $P_K:P_{Na}:P_{Cl}=1:0.05:0.45$, that activities equal concentrations, and that the membrane is thin with a spatially constant electric field across it. Let $R$ be the universal gas constant and $F$ be the Faraday constant.\n\nStarting from the Nernst–Planck flux equation for each ionic species and the constant-field approximation, derive the constant-field expression for the steady-state membrane potential $V_m$ (the Goldman–Hodgkin–Katz (GHK) voltage relationship) for these three monovalent ions, making clear how the sign of valence enters the expression. Then, using your derived expression, compute the new steady-state membrane potential after the perturbation and the initial steady-state membrane potential before the perturbation, and report the change \n$$\\Delta V_m \\equiv V_m^{\\text{new}}-V_m^{\\text{old}}.$$\n\nUse $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and $F=96485.33212\\,\\mathrm{C\\,mol^{-1}}$. Express your final numerical answer for $\\Delta V_m$ in $\\mathrm{mV}$ and round to three significant figures.", "solution": "The problem is first validated for scientific soundness, completeness, and clarity.\n\n**Step 1: Extract Givens**\n- **System**: Spherical neuron at temperature $T=310\\,\\mathrm{K}$.\n- **Ions (monovalent)**: Potassium ($\\text{K}^+$, $z=+1$), Sodium ($\\text{Na}^+$, $z=+1$), Chloride ($\\text{Cl}^-$, $z=-1$).\n- **Initial Concentrations (State \"old\")**:\n  - Intracellular: $[K^+]_i=140\\,\\mathrm{mM}$, $[Na^+]_i=12\\,\\mathrm{mM}$, $[Cl^-]_i=5\\,\\mathrm{mM}$.\n  - Extracellular: $[K^+]_o=3\\,\\mathrm{mM}$, $[Na^+]_o=145\\,\\mathrm{mM}$, $[Cl^-]_o=120\\,\\mathrm{mM}$.\n- **Perturbed Concentrations (State \"new\")**:\n  - Extracellular potassium $[K^+]_o$ changes to $8\\,\\mathrm{mM}$. All other concentrations remain fixed.\n- **Permeabilities**: Relative permeabilities are constant, $P_K:P_{Na}:P_{Cl}=1:0.05:0.45$.\n- **Assumptions**: Activities are equal to concentrations; constant electric field across a thin membrane.\n- **Constants**: $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $F=96485.33212\\,\\mathrm{C\\,mol^{-1}}$.\n- **Objective**: Derive the Goldman–Hodgkin–Katz (GHK) voltage equation for $V_m$ and compute the change $\\Delta V_m = V_m^{\\text{new}} - V_m^{\\text{old}}$, providing a numerical answer in $\\mathrm{mV}$ rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of electrophysiology, using the Nernst-Planck and GHK models, which are standard in the field. The provided ionic concentrations and temperature are physiologically realistic for a mammalian neuron. The problem is well-posed, self-contained, and all data required for a unique solution are provided. The objective is clearly stated, and the assumptions are explicit. There are no contradictions, ambiguities, or factual errors.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation of the Goldman–Hodgkin–Katz (GHK) Voltage Equation**\nThe flux of an ionic species $S$ across a membrane is described by the Nernst–Planck equation, which accounts for diffusion due to a concentration gradient and drift due to an electric field. Let the membrane lie between $x=0$ (extracellular side) and $x=L$ (intracellular side). The membrane potential is $V_m = \\phi_{in} - \\phi_{out} = \\phi(L) - \\phi(0)$. The Nernst-Planck equation for the flux density $j_S$ of ion $S$ with valence $z_S$ is:\n$$j_S(x) = -D_S \\left( \\frac{dC_S(x)}{dx} + \\frac{z_S F}{RT} C_S(x) \\frac{d\\phi(x)}{dx} \\right)$$\nHere, $D_S$ is the diffusion coefficient of the ion in the membrane, $C_S(x)$ is its concentration at position $x$, $\\phi(x)$ is the electric potential, $R$ is the universal gas constant, $T$ is the absolute temperature, and $F$ is the Faraday constant.\n\nThe constant-field approximation assumes the electric field $E = -d\\phi/dx$ is constant across the membrane. Thus, $E = \\frac{\\phi(0) - \\phi(L)}{L} = \\frac{-\\left(\\phi(L) - \\phi(0)\\right)}{L} = -\\frac{V_m}{L}$. So, $\\frac{d\\phi}{dx} = \\frac{V_m}{L}$. The equation becomes:\n$$j_S = -D_S \\left( \\frac{dC_S}{dx} + \\frac{z_S F V_m}{RT L} C_S \\right)$$\nIn steady state, the flux $j_S$ must be constant for $x \\in [0, L]$. We can rearrange this first-order linear ordinary differential equation and solve it. Using an integrating factor $e^{\\frac{z_S F V_m}{RTL}x}$, we get:\n$$\\frac{d}{dx} \\left( C_S(x) \\exp\\left(\\frac{z_S F V_m x}{RTL}\\right) \\right) = -\\frac{j_S}{D_S} \\exp\\left(\\frac{z_S F V_m x}{RTL}\\right)$$\nIntegrating from $x=0$ (outside) to $x=L$ (inside) with boundary conditions $C_S(0)=[S]_o$ and $C_S(L)=[S]_i$:\n$$\\int_0^L \\frac{d}{dx} \\left( C_S(x) \\exp\\left(\\frac{z_S F V_m x}{RTL}\\right) \\right) dx = -\\frac{j_S}{D_S} \\int_0^L \\exp\\left(\\frac{z_S F V_m x}{RTL}\\right) dx$$\n$$\\left[ C_S(x) \\exp\\left(\\frac{z_S F V_m x}{RTL}\\right) \\right]_0^L = -\\frac{j_S}{D_S} \\left[ \\frac{RTL}{z_S F V_m} \\exp\\left(\\frac{z_S F V_m x}{RTL}\\right) \\right]_0^L$$\n$$[S]_i \\exp\\left(\\frac{z_S F V_m}{RT}\\right) - [S]_o = -\\frac{j_S RTL}{D_S z_S F V_m} \\left( \\exp\\left(\\frac{z_S F V_m}{RT}\\right) - 1 \\right)$$\nSolving for the flux $j_S$ and defining the permeability as $P_S = D_S/L$:\n$$j_S = P_S \\frac{z_S F V_m}{RT} \\frac{[S]_o - [S]_i \\exp\\left(\\frac{z_S F V_m}{RT}\\right)}{1 - \\exp\\left(\\frac{z_S F V_m}{RT}\\right)}$$\nAt steady state, the total transmembrane electric current density $I_{tot}$ is zero. The current carried by each ion is $I_S = z_S F j_S$.\n$$I_{tot} = \\sum_S I_S = F \\sum_S z_S j_S = 0 \\implies \\sum_S z_S j_S = 0$$\nFor the ions $\\text{K}^+$, $\\text{Na}^+$, and $\\text{Cl}^-$, this condition is $z_K j_K + z_{Na} j_{Na} + z_{Cl} j_{Cl} = 0$. With $z_K=+1$, $z_{Na}=+1$, and $z_{Cl}=-1$, this becomes $j_K + j_{Na} - j_{Cl} = 0$.\nLet's substitute the flux expression for each ion. To simplify, we manipulate the expression to have a common denominator. Multiplying the numerator and denominator by $\\exp\\left(-\\frac{z_S F V_m}{RT}\\right)$:\n$$j_S = P_S \\frac{z_S F V_m}{RT} \\frac{[S]_o \\exp\\left(-\\frac{z_S F V_m}{RT}\\right) - [S]_i}{\\exp\\left(-\\frac{z_S F V_m}{RT}\\right) - 1}$$\nFor cations ($z_S=+1$, e.g., $\\text{K}^+, \\text{Na}^+$):\n$$j_{cat} = P_{cat} \\frac{F V_m}{RT} \\frac{[cat]_o \\exp\\left(-\\frac{F V_m}{RT}\\right) - [cat]_i}{\\exp\\left(-\\frac{F V_m}{RT}\\right) - 1}$$\nFor anions ($z_S=-1$, e.g., $\\text{Cl}^-$):\n$$j_{anion} = P_{anion} \\frac{-F V_m}{RT} \\frac{[anion]_o \\exp\\left(\\frac{F V_m}{RT}\\right) - [anion]_i}{\\exp\\left(\\frac{F V_m}{RT}\\right) - 1}$$\nThe crucial step demonstrating the effect of valence sign is to rewrite the anion flux to match the form of the cation flux. For the $\\text{Cl}^-$ term, we have:\n$$-j_{Cl} = P_{Cl} \\frac{F V_m}{RT} \\frac{[Cl]_o \\exp\\left(\\frac{F V_m}{RT}\\right) - [Cl]_i}{\\exp\\left(\\frac{F V_m}{RT}\\right) - 1} = P_{Cl} \\frac{F V_m}{RT} \\frac{[Cl]_i \\exp\\left(-\\frac{F V_m}{RT}\\right) - [Cl]_o}{\\exp\\left(-\\frac{F V_m}{RT}\\right) - 1}$$\nNow, $j_K + j_{Na} = j_{Cl}$, which is equivalent to $j_K + j_{Na} + (-j_{Cl}) = 0$. Using the unified expressions:\n$$\\frac{F V_m}{RT \\left(\\exp\\left(-\\frac{F V_m}{RT}\\right) - 1\\right)} \\left[ P_K\\left([K]_o e^{-\\frac{FV_m}{RT}} - [K]_i\\right) + P_{Na}\\left([Na]_o e^{-\\frac{FV_m}{RT}} - [Na]_i\\right) + P_{Cl}\\left([Cl]_i e^{-\\frac{FV_m}{RT}} - [Cl]_o\\right) \\right] = 0$$\nAssuming $V_m \\neq 0$, the term in the square brackets must be zero.\n$$e^{-\\frac{FV_m}{RT}} \\left( P_K[K]_o + P_{Na}[Na]_o + P_{Cl}[Cl]_i \\right) = \\left( P_K[K]_i + P_{Na}[Na]_i + P_{Cl}[Cl]_o \\right)$$\nSolving for $V_m$:\n$$V_m = \\frac{RT}{F} \\ln \\left( \\frac{P_K[K]_o + P_{Na}[Na]_o + P_{Cl}[Cl]_i}{P_K[K]_i + P_{Na}[Na]_i + P_{Cl}[Cl]_o} \\right)$$\nThis is the Goldman–Hodgkin–Katz voltage equation. Note how the negative valence of chloride ($z_{Cl}=-1$) results in its intracellular concentration $[Cl]_i$ appearing in the numerator and its extracellular concentration $[Cl]_o$ in the denominator, the reverse of the cations.\n\n**Calculation of the Change in Membrane Potential**\nThe change in membrane potential $\\Delta V_m$ is given by $\\Delta V_m = V_m^{\\text{new}} - V_m^{\\text{old}}$. Using the derived GHK equation:\n$$V_m^{\\text{old}} = \\frac{RT}{F} \\ln \\left( \\frac{P_K[K]_o^{\\text{old}} + P_{Na}[Na]_o + P_{Cl}[Cl]_i}{P_K[K]_i + P_{Na}[Na]_i + P_{Cl}[Cl]_o} \\right)$$\n$$V_m^{\\text{new}} = \\frac{RT}{F} \\ln \\left( \\frac{P_K[K]_o^{\\text{new}} + P_{Na}[Na]_o + P_{Cl}[Cl]_i}{P_K[K]_i + P_{Na}[Na]_i + P_{Cl}[Cl]_o} \\right)$$\nThe denominator is identical in both expressions. Let $N_{old}$ be the numerator in the old state and $N_{new}$ be the numerator in the new state, and $D$ be the common denominator.\n$$\\Delta V_m = \\frac{RT}{F} \\left( \\ln\\left(\\frac{N_{new}}{D}\\right) - \\ln\\left(\\frac{N_{old}}{D}\\right) \\right) = \\frac{RT}{F} \\ln\\left(\\frac{N_{new}}{N_{old}}\\right)$$\nWe can use the relative permeabilities directly: $P_K=1$, $P_{Na}=0.05$, $P_{Cl}=0.45$. The concentrations are in $\\mathrm{mM}$.\n$N_{old} = P_K[K]_o^{\\text{old}} + P_{Na}[Na]_o + P_{Cl}[Cl]_i = (1)(3) + (0.05)(145) + (0.45)(5) = 3 + 7.25 + 2.25 = 12.5$.\n$N_{new} = P_K[K]_o^{\\text{new}} + P_{Na}[Na]_o + P_{Cl}[Cl]_i = (1)(8) + (0.05)(145) + (0.45)(5) = 8 + 7.25 + 2.25 = 17.5$.\nNow we compute the thermal voltage term, $\\frac{RT}{F}$:\n$$\\frac{RT}{F} = \\frac{(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) (310\\,\\mathrm{K})}{96485.33212\\,\\mathrm{C\\,mol^{-1}}} \\approx 0.0267073\\,\\mathrm{V} = 26.7073\\,\\mathrm{mV}$$\nFinally, we calculate $\\Delta V_m$:\n$$\\Delta V_m = (26.7073\\,\\mathrm{mV}) \\ln\\left(\\frac{17.5}{12.5}\\right) = (26.7073\\,\\mathrm{mV}) \\ln(1.4)$$\n$$\\Delta V_m \\approx (26.7073\\,\\mathrm{mV}) (0.336472) \\approx 8.98865\\,\\mathrm{mV}$$\nRounding to three significant figures as required, we obtain $\\Delta V_m = 8.99\\,\\mathrm{mV}$.", "answer": "$$ \\boxed{8.99} $$", "id": "2710812"}, {"introduction": "It is a foundational concept in neurophysiology that significant changes in membrane potential are achieved by the movement of a surprisingly small number of ions. This exercise provides a tangible sense of this scale by treating the neuronal membrane as a capacitor. You will calculate the exact number of ions required to produce a large depolarization and compare this to the total intracellular ion pool, revealing the remarkable efficiency of electrical signaling and why ion pumps can easily maintain concentration gradients over long periods [@problem_id:2710834].", "problem": "A spherical neuron at rest maintains a high intracellular potassium ion concentration and can be modeled electrically as a capacitor. Consider a neuron whose total membrane capacitance is $C = 20\\,\\mathrm{pF}$ that undergoes a depolarization of $\\Delta V = 100\\,\\mathrm{mV}$. Assume that the specific membrane capacitance is $C_m = 1.0\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$, that all of the capacitance arises from the plasma membrane surrounding a spherical soma (ignore neurites), and that the intracellular potassium concentration is $[K^+]_i = 140\\,\\mathrm{mM}$. Treat each potassium ion as carrying a charge equal in magnitude to the elementary charge.\n\nUsing only fundamental physical definitions and well-established biophysical facts, determine the fraction of the intracellular potassium pool that must redistribute across the membrane to produce the stated depolarization. Use the elementary charge $q_e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$ and Avogadro’s constant $N_A = 6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1}$. Express your final answer as a unitless decimal fraction and round to $3$ significant figures.", "solution": "The problem as stated is subjected to validation.\n\nGivens extracted verbatim are:\n- Total membrane capacitance: $C = 20\\,\\mathrm{pF}$\n- Depolarization: $\\Delta V = 100\\,\\mathrm{mV}$\n- Specific membrane capacitance: $C_m = 1.0\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$\n- Intracellular potassium concentration: $[K^+]_i = 140\\,\\mathrm{mM}$\n- Neuron geometry: spherical soma, no neurites\n- Charge carrier: potassium ion, with charge magnitude equal to the elementary charge $q_e$\n- Elementary charge: $q_e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n- Avogadro’s constant: $N_A = 6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n- Required output: The fraction of the intracellular potassium pool that redistributes, rounded to $3$ significant figures.\n\nThe problem is scientifically grounded, well-posed, and objective. It is based on the fundamental definition of capacitance and standard biophysical models of a neuron. The provided values are biophysically realistic. The problem is self-contained and logically consistent, providing all necessary information to derive a unique, meaningful solution. It does not violate any principles of physics, chemistry, or mathematics. Therefore, the problem is deemed valid and a solution will be provided.\n\nThe objective is to find the fraction $f$ of intracellular potassium ions that must move across the membrane to cause the given depolarization. This fraction is the ratio of the number of ions moved, $N_{moved}$, to the total number of potassium ions initially inside the cell, $N_{total}$.\n$$f = \\frac{N_{moved}}{N_{total}}$$\nThe solution will be executed in steps:\n$1$. Calculate the total charge $\\Delta Q$ that must be redistributed to achieve the depolarization $\\Delta V$.\n$2$. Calculate the number of potassium ions, $N_{moved}$, corresponding to this charge $\\Delta Q$.\n$3$. Calculate the volume of the neuron, $V_{cell}$, from its capacitance properties.\n$4$. Calculate the total number of potassium ions, $N_{total}$, initially present in this volume.\n$5$. Compute the final fraction $f$.\n\nFor consistency and correctness, all calculations will use base SI units. First, we convert the given parameters.\n- Total capacitance: $C = 20\\,\\mathrm{pF} = 20 \\times 10^{-12}\\,\\mathrm{F}$\n- Voltage change: $\\Delta V = 100\\,\\mathrm{mV} = 100 \\times 10^{-3}\\,\\mathrm{V} = 0.1\\,\\mathrm{V}$\n- Specific membrane capacitance: $C_m = 1.0\\,\\frac{\\mu\\mathrm{F}}{\\mathrm{cm}^2} = 1.0 \\times 10^{-6}\\,\\frac{\\mathrm{F}}{(10^{-2}\\,\\mathrm{m})^2} = 1.0 \\times 10^{-2}\\,\\mathrm{F} \\cdot \\mathrm{m}^{-2}$\n- Intracellular concentration: $[K^+]_i = 140\\,\\mathrm{mM} = 140 \\times 10^{-3}\\,\\frac{\\mathrm{mol}}{\\mathrm{L}} = 140 \\times 10^{-3}\\,\\frac{\\mathrm{mol}}{10^{-3}\\,\\mathrm{m}^3} = 140\\,\\mathrm{mol} \\cdot \\mathrm{m}^{-3}$\n\nStep 1: Calculate the charge moved, $\\Delta Q$.\nFrom the definition of capacitance, $C = Q/V$, the change in charge $\\Delta Q$ corresponding to a voltage change $\\Delta V$ is:\n$$\\Delta Q = C \\Delta V$$\nSubstituting the values:\n$$\\Delta Q = (20 \\times 10^{-12}\\,\\mathrm{F}) \\times (0.1\\,\\mathrm{V}) = 2 \\times 10^{-12}\\,\\mathrm{C}$$\n\nStep 2: Calculate the number of ions moved, $N_{moved}$.\nEach potassium ion carries a single elementary charge, $q_e$. The total number of ions moved is $\\Delta Q$ divided by $q_e$.\n$$N_{moved} = \\frac{\\Delta Q}{q_e}$$\nUsing the given value for $q_e$:\n$$N_{moved} = \\frac{2 \\times 10^{-12}\\,\\mathrm{C}}{1.602 \\times 10^{-19}\\,\\mathrm{C}} \\approx 1.2484 \\times 10^7\\,\\text{ions}$$\n\nStep 3: Calculate the volume of the neuron, $V_{cell}$.\nThe total capacitance $C$ is the product of the specific capacitance $C_m$ and the surface area $A$ of the membrane.\n$$C = C_m A \\implies A = \\frac{C}{C_m}$$\n$$A = \\frac{20 \\times 10^{-12}\\,\\mathrm{F}}{1.0 \\times 10^{-2}\\,\\mathrm{F} \\cdot \\mathrm{m}^{-2}} = 2.0 \\times 10^{-9}\\,\\mathrm{m}^2$$\nThe neuron is a sphere, so its surface area is $A = 4\\pi r^2$, where $r$ is the radius. We can find $r$:\n$$r = \\sqrt{\\frac{A}{4\\pi}} = \\sqrt{\\frac{2.0 \\times 10^{-9}\\,\\mathrm{m}^2}{4\\pi}} \\approx 1.2616 \\times 10^{-5}\\,\\mathrm{m}$$\nThe volume of a sphere is $V_{cell} = \\frac{4}{3}\\pi r^3$.\n$$V_{cell} = \\frac{4}{3}\\pi (1.2616 \\times 10^{-5}\\,\\mathrm{m})^3 \\approx 8.4103 \\times 10^{-15}\\,\\mathrm{m}^3$$\n\nStep 4: Calculate the total number of intracellular potassium ions, $N_{total}$.\nThe total number of moles of $K^+$ ions, $n_{total}$, is the product of the intracellular concentration $[K^+]_i$ and the cell volume $V_{cell}$.\n$$n_{total} = [K^+]_i \\times V_{cell}$$\n$$n_{total} = (140\\,\\mathrm{mol} \\cdot \\mathrm{m}^{-3}) \\times (8.4103 \\times 10^{-15}\\,\\mathrm{m}^3) \\approx 1.1774 \\times 10^{-12}\\,\\mathrm{mol}$$\nTo find the total number of ions, $N_{total}$, we multiply the number of moles by Avogadro's constant, $N_A$.\n$$N_{total} = n_{total} \\times N_A$$\n$$N_{total} = (1.1774 \\times 10^{-12}\\,\\mathrm{mol}) \\times (6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1}) \\approx 7.090 \\times 10^{11}\\,\\text{ions}$$\n\nStep 5: Compute the fraction $f$.\nFinally, the fraction of the potassium pool that redistributes is the ratio of $N_{moved}$ to $N_{total}$.\n$$f = \\frac{N_{moved}}{N_{total}} = \\frac{1.2484 \\times 10^7}{7.090 \\times 10^{11}} \\approx 1.7608 \\times 10^{-5}$$\nThe problem requires the answer to be rounded to $3$ significant figures.\n$$f \\approx 1.76 \\times 10^{-5}$$\nThis calculation demonstrates that only a minuscule fraction of the total available ions needs to move to generate significant changes in membrane potential, a fundamental concept in neurophysiology.", "answer": "$$ \\boxed{1.76 \\times 10^{-5}} $$", "id": "2710834"}, {"introduction": "Moving beyond steady-state potentials, this practice explores the dynamic nature of ion gradients during intense neural activity, as seen in pathological states like seizures. Here, you will construct a dynamic model from first principles of mass conservation to simulate the accumulation of extracellular potassium ($[K^+]_e$) over time. This exercise bridges the gap between single-neuron biophysics (ion efflux per spike) and emergent network phenomena, providing hands-on experience in building and numerically solving a differential equation to describe a complex physiological process [@problem_id:2710830].", "problem": "You are to model the extracellular potassium concentration, denoted by $[K^+]_e(t)$ with units of millimolar (mM), in a well-mixed local microdomain of brain tissue during a seizure-like event. Your model must begin from conservation of mass applied to the extracellular space (ECS), where ionic content changes arise from sources (neuronal $K^+$ efflux per action potential) and sinks (clearance mechanisms). You must derive the governing ordinary differential equation from the following fundamental bases and definitions:\n- Conservation of mass for a well-mixed control volume: the time rate of change of the amount of a species in the volume equals the inflow minus the outflow (including reactive or transport removal), divided by the volume to obtain concentration dynamics.\n- Definition of spike-driven release: each neuron releases a fixed amount of potassium per spike, and the population produces spikes at a defined rate.\n- Definition of extracellular space (ECS) volume fraction: the ECS volume equals the tissue volume times the ECS fraction.\n- First-order kinetics for independent clearance processes: assume that two independent linear clearance processes act on $[K^+]_e$, driven by deviation from a baseline level.\n\nYour model must use the following interpretation of parameters:\n- A local tissue volume $V_{\\text{tissue}}$ (in liters), and an extracellular volume fraction $\\alpha$ (dimensionless), so that the extracellular volume is $V_{\\text{ECS}} = \\alpha V_{\\text{tissue}}$.\n- A population of $N$ identical neurons, each emitting $s_K$ moles of $\\mathrm{K}^+$ per spike, with a firing rate $r(t)$ in hertz (spikes per second per neuron).\n- Two independent first-order clearance processes characterized by rate constants $k_{\\text{pump}}$ and $k_{\\text{diff}}$ (both in $\\mathrm{s}^{-1}$), acting on the deviation of $[K^+]_e$ from a baseline concentration $[K^+]_{e,0}$ (in mM).\n- A seizure-like input defined by a piecewise-constant firing rate: $r(t) = r_0$ for $0 \\le t \\le T_{\\text{event}}$, and $r(t) = 0$ otherwise.\n\nFrom these, derive the time evolution equation for $[K^+]_e(t)$ using mass conservation and the assumptions given, taking care to express the release source term in consistent concentration-time units using the extracellular volume. Implement a numerical integration to compute the time course. You must:\n- Use a fixed time step of $\\Delta t = 0.001$ s.\n- Simulate over a total duration of $T_{\\text{total}} = 20$ s.\n- Initialize at the baseline $[K^+]_e(0) = [K^+]_{e,0}$.\n- Report, for each test case, the maximum value of $[K^+]_e(t)$ over the entire simulation window, expressed in millimolar (mM), rounded to three decimal places.\n\nUnits and conversions:\n- $s_K$ is in moles per spike (mol/spike), $r(t)$ is in $\\mathrm{s}^{-1}$, $N$ is dimensionless (count), and $V_{\\text{ECS}}$ is in liters (L). The source term must therefore be expressed in $\\mathrm{mM}/\\mathrm{s}$, using $1\\,\\mathrm{M} = 1000\\,\\mathrm{mM}$.\n\nTest suite (use these exact parameter sets; all numbers are provided in base units and must be used exactly as given):\n- Common parameters for all cases:\n  - $V_{\\text{tissue}} = 1\\times 10^{-7}$ L\n  - $N = 10000$\n  - $s_K = 2\\times 10^{-17}$ mol/spike\n  - $[K^+]_{e,0} = 3$ mM\n  - $T_{\\text{event}} = 10$ s\n  - $T_{\\text{total}} = 20$ s\n  - $\\Delta t = 0.001$ s\n- Case $1$ (happy path):\n  - $\\alpha = 0.2$\n  - $r_0 = 50$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{pump}} = 0.3$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{diff}} = 0.2$ $\\mathrm{s}^{-1}$\n- Case $2$ (reduced ECS volume fraction):\n  - $\\alpha = 0.12$\n  - $r_0 = 50$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{pump}} = 0.3$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{diff}} = 0.2$ $\\mathrm{s}^{-1}$\n- Case $3$ (enhanced clearance):\n  - $\\alpha = 0.2$\n  - $r_0 = 50$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{pump}} = 0.8$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{diff}} = 0.7$ $\\mathrm{s}^{-1}$\n- Case $4$ (no firing, baseline stability check):\n  - $\\alpha = 0.2$\n  - $r_0 = 0$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{pump}} = 0.3$ $\\mathrm{s}^{-1}$\n  - $k_{\\text{diff}} = 0.2$ $\\mathrm{s}^{-1}$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be a float equal to the peak $[K^+]_e$ in mM over the simulation for the corresponding test case, rounded to three decimal places and ordered as Cases $1$ through $4$.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\n### Step 1: Extract Givens\nThe following quantities and conditions are provided:\n- Dependent variable: Extracellular potassium concentration, $[K^+]_e(t)$ (mM).\n- Tissue volume: $V_{\\text{tissue}}$ (L).\n- Extracellular volume fraction: $\\alpha$ (dimensionless).\n- Extracellular volume: $V_{\\text{ECS}} = \\alpha V_{\\text{tissue}}$ (L).\n- Number of neurons: $N$ (dimensionless).\n- Potassium release per spike: $s_K$ (mol/spike).\n- Firing rate per neuron: $r(t)$ ($\\mathrm{s}^{-1}$).\n- Clearance rate constant (pump): $k_{\\text{pump}}$ ($\\mathrm{s}^{-1}$).\n- Clearance rate constant (diffusion): $k_{\\text{diff}}$ ($\\mathrm{s}^{-1}$).\n- Baseline extracellular potassium concentration: $[K^+]_{e,0}$ (mM).\n- Firing rate function: $r(t) = r_0$ for $0 \\le t \\le T_{\\text{event}}$, and $r(t) = 0$ otherwise.\n- Numerical integration time step: $\\Delta t = 0.001$ s.\n- Total simulation duration: $T_{\\text{total}} = 20$ s.\n- Initial condition: $[K^+]_e(0) = [K^+]_{e,0}$.\n- Unit conversion: $1\\,\\mathrm{M} = 1000\\,\\mathrm{mM}$.\n- Common parameters: $V_{\\text{tissue}} = 1\\times 10^{-7}$ L, $N = 10000$, $s_K = 2\\times 10^{-17}$ mol/spike, $[K^+]_{e,0} = 3$ mM, $T_{\\text{event}} = 10$ s, $T_{\\text{total}} = 20$ s, $\\Delta t = 0.001$ s.\n- Case-specific parameters:\n    - Case $1$: $\\alpha = 0.2$, $r_0 = 50$ $\\mathrm{s}^{-1}$, $k_{\\text{pump}} = 0.3$ $\\mathrm{s}^{-1}$, $k_{\\text{diff}} = 0.2$ $\\mathrm{s}^{-1}$.\n    - Case $2$: $\\alpha = 0.12$, $r_0 = 50$ $\\mathrm{s}^{-1}$, $k_{\\text{pump}} = 0.3$ $\\mathrm{s}^{-1}$, $k_{\\text{diff}} = 0.2$ $\\mathrm{s}^{-1}$.\n    - Case $3$: $\\alpha = 0.2$, $r_0 = 50$ $\\mathrm{s}^{-1}$, $k_{\\text{pump}} = 0.8$ $\\mathrm{s}^{-1}$, $k_{\\text{diff}} = 0.7$ $\\mathrm{s}^{-1}$.\n    - Case $4$: $\\alpha = 0.2$, $r_0 = 0$ $\\mathrm{s}^{-1}$, $k_{\\text{pump}} = 0.3$ $\\mathrm{s}^{-1}$, $k_{\\text{diff}} = 0.2$ $\\mathrm{s}^{-1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the required criteria.\n1.  **Scientifically Grounded**: The model is based on the principle of mass conservation in a well-mixed compartment, with source and sink terms governed by standard biophysical assumptions (spike-driven release, first-order clearance kinetics). This is a fundamental and widely accepted approach in computational neuroscience. The parameters are within a plausible range for a simplified neural microdomain model.\n2.  **Well-Posed**: The problem requires the derivation and numerical solution of a first-order linear ordinary differential equation with a given initial condition and a piecewise-constant forcing function. Such a problem is well-posed, admitting a unique and stable solution. The specification of the numerical integration method and its parameters ensures a deterministic output.\n3.  **Objective**: The problem is formulated using precise, unambiguous mathematical and scientific language. It is devoid of subjective or opinion-based statements.\n4.  **Complete and Consistent**: All parameters, initial conditions, and constraints required to derive the model and perform the simulation are provided. The units are specified and allow for a dimensionally consistent derivation. No contradictions are present.\n\n### Step 3: Verdict and Action\nThe problem is scientifically valid, well-posed, and complete. It does not violate any of the specified criteria for invalidity. Therefore, I will proceed with providing a complete solution.\n\n### Derivation of the Governing Equation\nThe core principle is the conservation of mass for potassium ions in the extracellular volume $V_{\\text{ECS}}$. The time rate of change of the potassium concentration $[K^+]_e(t)$ is the sum of a source term (inflow from neuronal spiking) and a sink term (clearance), both expressed in units of concentration per unit time ($\\mathrm{mM} \\cdot \\mathrm{s}^{-1}$).\n\nLet us denote $[K^+]_e(t)$ by the variable $K(t)$ for notational simplicity. The governing ordinary differential equation (ODE) is:\n$$\n\\frac{dK(t)}{dt} = J(t) - C(t)\n$$\nwhere $J(t)$ is the source term and $C(t)$ is the clearance term.\n\n**1. Source Term, $J(t)$**\nThe source of potassium is the efflux from $N$ neurons, each firing at a rate of $r(t)$ and releasing $s_K$ moles of $K^+$ per spike.\n- Total number of spikes per second: $N \\cdot r(t)$ [spikes $\\cdot$ $\\mathrm{s}^{-1}$].\n- Total molar flux of potassium into the ECS: $N \\cdot r(t) \\cdot s_K$ [mol $\\cdot$ $\\mathrm{s}^{-1}$].\nTo convert this molar flux into a rate of change of concentration in the volume $V_{\\text{ECS}}$, we divide by the volume and convert units from Molar (mol/L) to milliMolar (mM).\n- Rate of concentration change in M/s: $\\frac{N \\cdot r(t) \\cdot s_K}{V_{\\text{ECS}}} = \\frac{N \\cdot r(t) \\cdot s_K}{\\alpha V_{\\text{tissue}}}$ [M $\\cdot$ $\\mathrm{s}^{-1}$].\n- Rate of concentration change in mM/s: $J(t) = 1000 \\cdot \\frac{N \\cdot r(t) \\cdot s_K}{\\alpha V_{\\text{tissue}}}$ [mM $\\cdot$ $\\mathrm{s}^{-1}$].\nThe firing rate $r(t)$ is piecewise constant, so $J(t)$ is also piecewise constant:\n$$\nJ(t) =\n\\begin{cases}\nJ_0 = 1000 \\cdot \\frac{N \\cdot r_0 \\cdot s_K}{\\alpha V_{\\text{tissue}}} & \\text{for } 0 \\le t \\le T_{\\text{event}} \\\\\n0 & \\text{for } t > T_{\\text{event}}\n\\end{cases}\n$$\n\n**2. Clearance Term, $C(t)$**\nClearance is accomplished by two independent first-order processes, with rate constants $k_{\\text{pump}}$ and $k_{\\text{diff}}$. The total clearance rate constant is $k_{\\text{tot}} = k_{\\text{pump}} + k_{\\text{diff}}$. The clearance rate is proportional to the deviation of the current concentration $K(t)$ from the baseline level $[K^+]_{e,0}$. Let us denote the baseline $[K^+]_{e,0}$ as $K_{\\text{base}}$.\n- Clearance term: $C(t) = k_{\\text{tot}} \\cdot (K(t) - K_{\\text{base}})$ [mM $\\cdot$ $\\mathrm{s}^{-1}$].\n\n**3. Complete ODE**\nCombining the source and clearance terms, we obtain the final governing equation:\n$$\n\\frac{dK(t)}{dt} = J(t) - (k_{\\text{pump}} + k_{\\text{diff}}) \\cdot (K(t) - K_{\\text{base}})\n$$\nwith the initial condition $K(0) = K_{\\text{base}}$.\n\n### Numerical Solution Method\nThe problem requires a numerical solution using a fixed time step $\\Delta t$. We will employ the first-order forward Euler method. We discretize time as $t_i = i \\cdot \\Delta t$, and let $K_i = K(t_i)$. The derivative is approximated as $\\frac{dK}{dt} \\approx \\frac{K_{i+1} - K_i}{\\Delta t}$.\nSubstituting this into the ODE yields the iterative update rule:\n$$\n\\frac{K_{i+1} - K_i}{\\Delta t} = J(t_i) - k_{\\text{tot}} \\cdot (K_i - K_{\\text{base}})\n$$\nSolving for $K_{i+1}$:\n$$\nK_{i+1} = K_i + \\Delta t \\cdot \\left[ J(t_i) - (k_{\\text{pump}} + k_{\\text{diff}}) \\cdot (K_i - K_{\\text{base}}) \\right]\n$$\nThis formula is applied iteratively, starting from the initial condition $K_0 = K_{\\text{base}}$, to compute the concentration profile $K(t)$ over the interval $[0, T_{\\text{total}}]$. For each simulation case, the maximum value of the computed array $\\{K_i\\}$ is determined.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and numerically solves the ODE for extracellular potassium dynamics\n    during a seizure-like event, reporting the peak concentration for several test cases.\n    \"\"\"\n\n    # --- Common Parameters ---\n    V_tissue = 1e-7  # L\n    N = 10000        # Number of neurons\n    s_K = 2e-17      # mol/spike\n    K_e0 = 3.0       # mM (baseline concentration)\n    T_event = 10.0   # s (duration of high firing rate)\n    T_total = 20.0   # s (total simulation time)\n    dt = 0.001       # s (time step for integration)\n\n    # --- Test Case Definitions ---\n    # Structure: (alpha, r0, k_pump, k_diff)\n    test_cases = [\n        (0.2, 50.0, 0.3, 0.2),  # Case 1: Happy path\n        (0.12, 50.0, 0.3, 0.2), # Case 2: Reduced ECS volume fraction\n        (0.2, 50.0, 0.8, 0.7),  # Case 3: Enhanced clearance\n        (0.2, 0.0, 0.3, 0.2),   # Case 4: No firing (baseline stability)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        alpha, r0, k_pump, k_diff = case\n\n        # --- Simulation Logic ---\n        # Setup time array\n        time_points = np.arange(0, T_total + dt, dt)\n        num_steps = len(time_points)\n\n        # Initialize concentration array for K_e\n        K_e = np.zeros(num_steps)\n        K_e[0] = K_e0\n\n        # Pre-calculate constant factors\n        # The source term, J0, in mM/s\n        # J0 = 1000 * (N * r0 * s_K) / (alpha * V_tissue)\n        # Note: 1000 converts M/s to mM/s\n        if alpha > 0 and V_tissue > 0:\n            source_term_constant = 1000.0 * (N * r0 * s_K) / (alpha * V_tissue)\n        else:\n            source_term_constant = 0.0\n            \n        # Total clearance rate constant\n        k_total = k_pump + k_diff\n\n        # Forward Euler Integration\n        for i in range(num_steps - 1):\n            # Determine the source term J(t) based on the current time\n            if time_points[i]  T_event:\n                J_t = source_term_constant\n            else:\n                J_t = 0.0\n\n            # Calculate the derivative dK/dt\n            # dK/dt = J(t) - k_total * (K_e(t) - K_e0)\n            dK_dt = J_t - k_total * (K_e[i] - K_e0)\n\n            # Update concentration for the next time step\n            K_e[i + 1] = K_e[i] + dt * dK_dt\n\n        # Find the maximum concentration over the simulation window\n        max_K_e = np.max(K_e)\n\n        # Round to three decimal places and store the result\n        results.append(round(max_K_e, 3))\n\n    # --- Final Output Formatting ---\n    print(f\"[{','.join(map(str, [f'{r:.3f}' for r in results]))}]\")\n\nsolve()\n```", "id": "2710830"}]}