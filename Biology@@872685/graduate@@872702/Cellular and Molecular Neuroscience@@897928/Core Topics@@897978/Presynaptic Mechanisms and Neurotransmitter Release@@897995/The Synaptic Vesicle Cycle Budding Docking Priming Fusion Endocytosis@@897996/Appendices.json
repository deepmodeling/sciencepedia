{"hands_on_practices": [{"introduction": "Understanding neurotransmitter release begins with a simple but powerful premise: release is a probabilistic process drawing from a finite pool of 'readily releasable' vesicles. This exercise challenges you to build a model of synaptic vesicle depletion from the ground up, using only first principles of probability. By deriving the expected number of vesicles released during a train of stimuli, you will gain a fundamental appreciation for how the readily releasable pool (RRP) size and release probability ($p$) dictate synaptic output, providing a crucial theoretical foundation for interpreting experimental data. [@problem_id:2767720]", "problem": "A central synapse contains a readily releasable pool (RRP) of primed synaptic vesicles of size $R_0$ at time $t=0$. A presynaptic train of action potentials is delivered at frequency $f$, comprising $N$ spikes over duration $T = N/f$. Assume the following biologically grounded conditions derived from the synaptic vesicle cycle: (i) vesicles in the RRP are in a primed state and can undergo fusion upon arrival of an action potential; (ii) each action potential elicits fusion of any given primed vesicle with probability $p$ that is constant across spikes and vesicles (no short-term facilitation or depression of $p$); (iii) after fusion, a vesicle is removed from the RRP and cannot fuse again within the train; (iv) there is no replenishment from the reserve pool via docking and priming during the train (endocytosis and re-priming are negligible on the timescale $T$). Using only first principles from probability theory and these mechanistic assumptions about the synaptic vesicle cycle, derive the expected depletion of the RRP after $N$ spikes. Express your final answer as a single closed-form analytic expression in terms of $R_0$, $p$, and $N$, and report it in units of vesicles. No numerical evaluation is required.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded, well-posed, objective, and internally consistent. It represents a standard, simplified model of synaptic vesicle pool dynamics, which is a core topic in cellular and molecular neuroscience. We may thus proceed with the formal derivation.\n\nThe objective is to derive the expected depletion of the readily releasable pool (RRP) of synaptic vesicles after a train of $N$ action potentials. Let the initial size of the RRP be $R_0$. The total depletion, which we denote by the random variable $D$, is the total number of vesicles that undergo fusion during the train of $N$ spikes. We seek to compute the expectation of $D$, denoted as $E[D]$.\n\nLet us consider the set of $R_0$ vesicles initially present in the RRP. We can label these vesicles from $i=1$ to $i=R_0$. For each vesicle $i$, let us define an indicator random variable $F_i$ such that:\n$$\nF_i =\n\\begin{cases}\n1 & \\text{if vesicle } i \\text{ fuses during the } N \\text{ spikes} \\\\\n0 & \\text{if vesicle } i \\text{ does not fuse during the } N \\text{ spikes}\n\\end{cases}\n$$\nThe total number of fused vesicles, $D$, is the sum of these indicator variables over all vesicles in the initial pool:\n$$ D = \\sum_{i=1}^{R_0} F_i $$\nBy the linearity of expectation, the expected total depletion is the sum of the expectations of the individual indicator variables:\n$$ E[D] = E\\left[\\sum_{i=1}^{R_0} F_i\\right] = \\sum_{i=1}^{R_0} E[F_i] $$\nThe expectation of an indicator random variable is equal to the probability of the event it indicates. Therefore, $E[F_i] = P(F_i=1)$, where $P(F_i=1)$ is the probability that vesicle $i$ fuses at some point during the train of $N$ spikes.\n\nAccording to the problem's assumption (ii), the probability of fusion, $p$, is constant for any given primed vesicle and for each action potential. All vesicles in the RRP are functionally identical in this model. Consequently, the probability of fusion for any single vesicle $i$ during the train, $P(F_i=1)$, is the same for all $i \\in \\{1, 2, \\dots, R_0\\}$. Let us denote this common probability as $P_{\\text{fuse}}$. The expression for the expected depletion simplifies to:\n$$ E[D] = \\sum_{i=1}^{R_0} P_{\\text{fuse}} = R_0 \\cdot P_{\\text{fuse}} $$\nOur task is now reduced to calculating $P_{\\text{fuse}}$. It is more direct to first calculate the complementary probability, $P_{\\text{survive}}$, which is the probability that a single vesicle does *not* fuse during the entire train of $N$ spikes. A vesicle fuses if it has not survived. Thus, $P_{\\text{fuse}} = 1 - P_{\\text{survive}}$.\n\nLet us consider a single vesicle from the initial RRP. At the first spike, the probability that this vesicle fuses is $p$. The probability that it does not fuse is $1-p$.\nIf the vesicle does not fuse at the first spike, it remains in the primed RRP. At the second spike, the probability that it fuses is again $p$, and the probability that it survives this second spike is again $1-p$. This process repeats for all $N$ spikes.\n\nA vesicle survives the entire train of $N$ spikes if and only if it survives the first spike, AND the second spike, ..., AND the $N$-th spike. The outcome for a vesicle at each spike is an independent event, conditional on its survival up to that point. The probability of a vesicle surviving the entire train is the product of the probabilities of it surviving each individual spike:\n$$ P_{\\text{survive}} = \\underbrace{(1-p) \\times (1-p) \\times \\dots \\times (1-p)}_{N \\text{ times}} = (1-p)^N $$\nNow, we can find the probability $P_{\\text{fuse}}$ that a vesicle fuses at some point during the train. This event is the complement of the vesicle surviving the entire train.\n$$ P_{\\text{fuse}} = 1 - P_{\\text{survive}} = 1 - (1-p)^N $$\nFinally, we substitute this expression for $P_{\\text{fuse}}$ back into our equation for the expected depletion $E[D]$:\n$$ E[D] = R_0 \\cdot \\left(1 - (1-p)^N\\right) $$\nThis is the closed-form analytic expression for the expected depletion of the RRP in units of vesicles. It is derived directly from first principles of probability and the explicit assumptions of the synaptic vesicle cycle model provided.", "answer": "$$\n\\boxed{R_0 \\left(1 - (1-p)^N\\right)}\n$$", "id": "2767720"}, {"introduction": "While theoretical models provide essential intuition, their true power is realized when they connect to experimental measurements. This practice bridges that gap by exploring a classic electrophysiological technique used to estimate key synaptic parameters: cumulative EPSC analysis. You will first derive the mathematical justification for the back-extrapolation method under high-frequency stimulation, and then apply it to a hypothetical dataset to calculate the readily releasable pool (RRP) size, initial release probability ($p$), and the vesicle replenishment rate. [@problem_id:2767708]", "problem": "A central approach to estimating the size of the readily releasable pool (RRP) of synaptic vesicles and the initial release probability in excitatory synapses is cumulative excitatory postsynaptic current (EPSC) analysis during high-frequency stimulation. Consider a synapse stimulated with a train of $50$ stimuli at $100\\,\\mathrm{Hz}$, while postsynaptic receptor saturation and desensitization have been pharmacologically minimized and the driving force held constant. The EPSC for each stimulus is integrated to obtain the charge per EPSC, denoted $Q_i$ for the $i$-th EPSC. The cumulative charge is defined as $C(N) = \\sum_{i=1}^{N} Q_i$. A linear regression of $C(N)$ versus stimulus number $N$ restricted to the late steady-depressing phase (stimuli $26$ through $50$) yields a line with slope $m = 0.210\\,\\mathrm{pC/stimulus}$ and back-extrapolated $y$-intercept $b = 5.40\\,\\mathrm{pC}$. The first EPSC charge is measured as $Q_1 = 1.52\\,\\mathrm{pC}$. The average quantal charge per vesicle is independently calibrated as $q = 0.270\\,\\mathrm{pC/vesicle}$.\n\nStarting from the quantal hypothesis and a mass balance for a single homogeneous readily releasable pool, justify the validity of the back-extrapolation method under high-frequency stimulation by deriving the relationship between the cumulative plotâ€™s late linear regime and the RRP at train onset. Use the following modeling assumptions explicitly in your reasoning:\n\n- The synapse contains a homogeneous readily releasable pool of $N$ vesicles at train onset, each releasing independently with per-stimulus release probability $p$ and quantal charge $q$, so that $Q_i \\approx p q R_i$, where $R_i$ is the number of vesicles available immediately before stimulus $i$.\n- Vesicle replenishment into the readily releasable pool occurs between stimuli at an average rate that becomes constant in the late phase under high-frequency stimulation.\n- In the late phase, release per stimulus equals replenishment per stimulus (steady state), and the cumulative plot becomes linear with slope equal to the replenishment contribution per stimulus.\n- Any residual steady-state occupancy of the readily releasable pool just before stimuli in the late phase is small compared to the pool at train onset under the chosen frequency, allowing the standard back-extrapolation approximation.\n\nUsing these premises:\n\n1) Derive why the back-extrapolated $y$-intercept of the late linear fit approximates the total charge initially contained in the readily releasable pool at train onset.\n\n2) Compute the readily releasable pool size in vesicles from the given regression parameters and $q$.\n\n3) Compute the initial per-stimulus release probability $p$ from $Q_1$ and the estimated RRP charge.\n\n4) Compute the steady-state replenishment rate in vesicles per second from the slope and $q$.\n\nExpress the readily releasable pool size in vesicles. Round your final reported answer to three significant figures. Do not include any units inside the final answer box; however, for all intermediate results, use appropriate physical units (e.g., $\\mathrm{pC}$, $\\mathrm{vesicles}$, $\\mathrm{vesicles/s}$). For $p$, express it as a decimal (not a percentage).", "solution": "The problem is valid as it is scientifically grounded in the principles of synaptic physiology, well-posed with sufficient data and clear assumptions, and stated objectively. We can proceed with a formal solution.\n\nThe problem asks for a derivation to justify the back-extrapolation method for estimating the size of the readily releasable pool (RRP) of synaptic vesicles, and then to compute several key synaptic parameters.\n\n1) Derivation of the back-extrapolation method's validity.\n\nLet $N_0$ be the initial number of vesicles in the readily releasable pool (RRP) at the start of the stimulation train ($t=0$). Let $p$ be the probability of release for each vesicle in the RRP upon the arrival of a single action potential (stimulus). Let $q$ be the quantal charge, i.e., the charge corresponding to the fusion of a single vesicle. Let $r$ be the number of vesicles replenished into the RRP during one inter-stimulus interval. We assume $p$ and $r$ are constant during the high-frequency train, as per the standard model simplified for this analysis.\n\nLet $R_i$ be the number of vesicles in the RRP immediately before the $i$-th stimulus. The initial condition is $R_1 = N_0$.\nThe charge released by the $i$-th stimulus, $Q_i$, is given by the quantal hypothesis:\n$$ Q_i = q p R_i $$\nBetween stimulus $i$ and $i+1$, the RRP is depleted by release and refilled by replenishment. The number of vesicles in the pool before the next stimulus, $R_{i+1}$, is described by the mass-balance difference equation:\n$$ R_{i+1} = R_i - pR_i + r = (1-p)R_i + r $$\nThis is a linear first-order non-homogeneous difference equation. Its solution, with the initial condition $R_1 = N_0$, is:\n$$ R_i = (N_0 - \\frac{r}{p})(1-p)^{i-1} + \\frac{r}{p} $$\nSubstituting this into the equation for $Q_i$:\n$$ Q_i = qp \\left[ (N_0 - \\frac{r}{p})(1-p)^{i-1} + \\frac{r}{p} \\right] = qp(N_0 - \\frac{r}{p})(1-p)^{i-1} + qr $$\nThe cumulative charge after $N$ stimuli, $C(N)$, is the sum of the individual EPSC charges:\n$$ C(N) = \\sum_{i=1}^{N} Q_i = \\sum_{i=1}^{N} \\left[ qp(N_0 - \\frac{r}{p})(1-p)^{i-1} + qr \\right] $$\nThis sum can be split into two parts:\n$$ C(N) = qp(N_0 - \\frac{r}{p}) \\sum_{i=1}^{N} (1-p)^{i-1} + \\sum_{i=1}^{N} qr $$\nThe first sum is a geometric series. Evaluating the sums gives:\n$$ C(N) = qp(N_0 - \\frac{r}{p}) \\frac{1-(1-p)^N}{1-(1-p)} + Nqr $$\n$$ C(N) = q(N_0 - \\frac{r}{p})[1-(1-p)^N] + Nqr $$\nThe problem states that a linear regression is performed on the late, steady-depressing phase of the $C(N)$ versus $N$ plot. In this phase, for large $N$, the term $(1-p)^N$ approaches zero, as $0 < p < 1$. The equation for $C(N)$ thus approaches a linear asymptote:\n$$ C_{asym}(N) = \\lim_{N\\to\\infty, (1-p)^N\\to 0} C(N) \\approx q(N_0 - \\frac{r}{p})(1) + Nqr $$\n$$ C_{asym}(N) = (qr)N + q(N_0 - \\frac{r}{p}) $$\nThis is the equation of a straight line, $y = mx+b$, where the stimulus number $N$ is the independent variable. By comparing terms, we can identify the slope and y-intercept of this asymptotic line:\n- The slope is $m = qr$. This is the charge replenished and then released per stimulus interval in the steady state.\n- The y-intercept is $b = q(N_0 - \\frac{r}{p})$.\n\nThe term $R_{ss} = r/p$ represents the steady-state number of vesicles in the RRP (where release $pR_{ss}$ balances replenishment $r$). So, the intercept can be written as $b = qN_0 - qR_{ss}$. This means the back-extrapolated intercept is an estimate of the initial RRP charge ($qN_0$) minus the charge of the residual steady-state pool ($qR_{ss}$).\n\nThe problem provides a critical modeling assumption: \"Any residual steady-state occupancy of the readily releasable pool... is small compared to the pool at train onset\". This translates to $R_{ss} \\ll N_0$. Consequently, the charge of the steady-state pool is negligible compared to the charge of the initial pool: $qR_{ss} \\ll qN_0$.\nUnder this specific approximation, the intercept $b$ becomes a direct estimate of the total charge of the initial RRP:\n$$ b = qN_0 - qR_{ss} \\approx qN_0 $$\nThis completes the justification. The back-extrapolated y-intercept provides an estimate of the total charge of the initial RRP, provided the steady-state pool size is negligible.\n\n2) Compute the readily releasable pool size ($N_0$) in vesicles.\n\nFrom the derived approximation $b \\approx qN_0$, we can calculate the RRP size $N_0$.\nGiven: $b = 5.40\\,\\mathrm{pC}$ and $q = 0.270\\,\\mathrm{pC/vesicle}$.\n$$ N_0 \\approx \\frac{b}{q} = \\frac{5.40\\,\\mathrm{pC}}{0.270\\,\\mathrm{pC/vesicle}} = 20\\,\\mathrm{vesicles} $$\nThe problem requests the final answer rounded to three significant figures.\n\n3) Compute the initial per-stimulus release probability ($p$).\n\nThe charge of the first EPSC is given by $Q_1 = q p R_1$. Since $R_1=N_0$, we have $Q_1 = q p N_0 = p(qN_0)$.\nUsing the approximation $qN_0 \\approx b$, we get $Q_1 \\approx p b$.\nWe can solve for $p$:\n$$ p \\approx \\frac{Q_1}{b} $$\nGiven: $Q_1 = 1.52\\,\\mathrm{pC}$ and $b = 5.40\\,\\mathrm{pC}$.\n$$ p \\approx \\frac{1.52\\,\\mathrm{pC}}{5.40\\,\\mathrm{pC}} \\approx 0.28148... $$\nSo, the initial release probability is approximately $0.281$.\n\n4) Compute the steady-state replenishment rate in vesicles per second.\n\nFrom the derivation in part (1), the slope of the late linear fit is $m = qr$, where $r$ is the replenishment rate in vesicles per inter-stimulus interval.\nGiven: $m = 0.210\\,\\mathrm{pC/stimulus}$ and $q = 0.270\\,\\mathrm{pC/vesicle}$.\n$$ r = \\frac{m}{q} = \\frac{0.210\\,\\mathrm{pC/stimulus}}{0.270\\,\\mathrm{pC/vesicle}} = \\frac{7}{9} \\approx 0.778\\,\\mathrm{vesicles/stimulus} $$\nThe stimulation frequency is $f = 100\\,\\mathrm{Hz}$. The replenishment rate per second, $r_{rate}$, is the rate per interval multiplied by the number of intervals per second ($f$).\n$$ r_{rate} = r \\times f = (\\frac{7}{9}\\,\\mathrm{vesicles/interval}) \\times (100\\,\\mathrm{intervals/s}) = \\frac{700}{9}\\,\\mathrm{vesicles/s} \\approx 77.8\\,\\mathrm{vesicles/s} $$\n\nThe question asks for the readily releasable pool size in vesicles, rounded to three significant figures, as the final answer.\n$N_0 = 20$. Expressed to three significant figures, this is $20.0$.", "answer": "$$\n\\boxed{20.0}\n$$", "id": "2767708"}, {"introduction": "Modern neuroscience increasingly relies on computational methods to dissect complex biological processes. This exercise introduces you to kinetic modeling of the entire synaptic vesicle cycle, as visualized by pH-sensitive fluorescent reporters like pHluorin. Starting from a two-compartment ordinary differential equation (ODE) model, you will derive its analytical solution and use it to perform a parameter-fitting task on simulated experimental data, estimating the rates of exocytosis ($k_{\\mathrm{exo}}$) and endocytosis ($k_{\\mathrm{endo}}$). [@problem_id:2767742]", "problem": "You are given a simplified, biophysically motivated two-compartment model of synaptic vesicle cycling measured by a pH-sensitive Green Fluorescent Protein (GFP) reporter (pHluorin). The model abstracts vesicle dynamics into an internal, acidic and non-fluorescent pool and a plasma-membrane surface, neutral and fluorescent pool. The internalization and externalization processes correspond to endocytosis and exocytosis, respectively. Assume bleaching correction has already been applied to the fluorescence trace.\n\nBase the derivation on the following foundational principles and definitions:\n- Law of mass action for first-order transitions between two compartments.\n- Conservation of total vesicles in the two compartments over the observation timescale in the absence of synthesis and degradation.\n- Linear proportionality between the number of vesicles in the surface (neutral) compartment and measured fluorescence in pHluorin imaging under constant optical conditions.\n\nDefinitions:\n- Let $R(t)$ denote the expected number of vesicles in the surface (neutral, fluorescent) compartment at time $t$.\n- Let $I(t)$ denote the expected number of vesicles in the internal (acidic, non-fluorescent) compartment at time $t$.\n- Let $T$ denote the conserved total vesicle count, so $T = R(t) + I(t)$ for all $t$ in the experiment.\n- Let $k_{\\mathrm{exo}}$ denote the constant exocytosis rate (in $\\mathrm{s}^{-1}$) during a stimulus window and zero outside it.\n- Let $k_{\\mathrm{endo}}$ denote the constant endocytosis rate (in $\\mathrm{s}^{-1}$) at all times.\n- Assume the measured fluorescence $F(t)$ is proportional to $R(t)$ with proportionality $1$ after bleaching correction, i.e., $F(t) = R(t)$ in arbitrary, dimensionless fluorescence units.\n\nModel hypotheses to be used as the fundamental starting point (do not use any shortcut formulas):\n- During any interval when exocytosis is active with a constant rate $k_{\\mathrm{exo}}$, the dynamics follow the ordinary differential equation (ODE):\n$$\n\\frac{dR}{dt} = k_{\\mathrm{exo}} I(t) - k_{\\mathrm{endo}} R(t)\n$$\nwith $I(t) = T - R(t)$.\n- During any interval when exocytosis is inactive, the ODE reduces to:\n$$\n\\frac{dR}{dt} = -k_{\\mathrm{endo}} R(t)\n$$\n- The solution must be continuous at switching times.\n- The initial condition is $R(0) = 0$.\n\nYour computational task:\n- Derive from the principles above a forward model that maps parameters $\\{k_{\\mathrm{exo}}, k_{\\mathrm{endo}}\\}$, stimulus timing $\\{t_{\\mathrm{on}}, t_{\\mathrm{off}}\\}$, total $T$, and a time grid $\\{t_i\\}_{i=1}^N$ to a predicted fluorescence trace $\\{\\hat{F}(t_i)\\}_{i=1}^N$.\n- Given a noisy fluorescence trace $\\{F(t_i)\\}_{i=1}^N$ generated by the model plus independent, identically distributed Gaussian noise of zero mean and known standard deviation $\\sigma$, estimate $\\{k_{\\mathrm{exo}}, k_{\\mathrm{endo}}\\}$ by minimizing the Sum of Squared Errors (SSE) between $\\{\\hat{F}(t_i)\\}$ and $\\{F(t_i)\\}$.\n- Constrain both rates to be nonnegative.\n- Express the final answers for rates in $\\mathrm{s}^{-1}$ rounded to three decimal places.\n\nTest suite specification:\nFor each test case, synthesize the fluorescence trace by first computing the noise-free trace from the model with the true parameters and then adding Gaussian noise with the specified seed and standard deviation. Use the following shared settings for all test cases:\n- Time grid: $t_i = i \\,\\Delta t$ for $i = 0, 1, \\dots, N$ with $\\Delta t = 0.05\\,\\mathrm{s}$, final time $t_N = 10.00\\,\\mathrm{s}$.\n- Initial condition: $R(0) = 0$.\n- Total vesicles: $T = 1$ (dimensionless).\n- Stimulus window: exocytosis is active with constant $k_{\\mathrm{exo}}$ for $t \\in [t_{\\mathrm{on}}, t_{\\mathrm{off}}]$ and inactive outside this window.\n- Noise model: additive Gaussian noise $\\mathcal{N}(0, \\sigma^2)$ with the specified $\\sigma$ and seed.\n\nProvide three test cases:\n- Case A (typical rates): $t_{\\mathrm{on}} = 1.00\\,\\mathrm{s}$, $t_{\\mathrm{off}} = 3.00\\,\\mathrm{s}$, $k_{\\mathrm{exo}}^{\\mathrm{true}} = 1.20\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{endo}}^{\\mathrm{true}} = 0.60\\,\\mathrm{s}^{-1}$, $\\sigma = 0.01$, random seed $13$.\n- Case B (slow endocytosis): $t_{\\mathrm{on}} = 1.00\\,\\mathrm{s}$, $t_{\\mathrm{off}} = 3.00\\,\\mathrm{s}$, $k_{\\mathrm{exo}}^{\\mathrm{true}} = 0.80\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{endo}}^{\\mathrm{true}} = 0.15\\,\\mathrm{s}^{-1}$, $\\sigma = 0.01$, random seed $42$.\n- Case C (fast endocytosis): $t_{\\mathrm{on}} = 1.00\\,\\mathrm{s}$, $t_{\\mathrm{off}} = 3.00\\,\\mathrm{s}$, $k_{\\mathrm{exo}}^{\\mathrm{true}} = 0.60\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{endo}}^{\\mathrm{true}} = 2.00\\,\\mathrm{s}^{-1}$, $\\sigma = 0.01$, random seed $7$.\n\nYour program must:\n- Construct the time grid from the specification above.\n- For each test case, synthesize the noisy fluorescence trace exactly as specified (including the random seed), then fit $k_{\\mathrm{exo}}$ and $k_{\\mathrm{endo}}$ by nonlinear least squares with nonnegativity constraints, using the derived forward model without numerical integration (use the analytic, piecewise-constant-coefficient ODE solutions implied by the principles).\n- Return the fitted parameters for each case.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of three items, where each item is a two-element list $[k_{\\mathrm{exo}}, k_{\\mathrm{endo}}]$ for one test case. All numbers must be rounded to three decimal places and implicitly in $\\mathrm{s}^{-1}$, for example:\n[[kexo_A,kendo_A],[kexo_B,kendo_B],[kexo_C,kendo_C]]", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in the principles of chemical kinetics and biophysics, represents a well-posed parameter estimation task, and is formulated with objective, unambiguous language. All necessary conditions, parameters, and definitions for a unique solution are provided. We may therefore proceed with the derivation and solution.\n\nThe task is to first derive an analytical forward model for the fluorescence signal $F(t)$, which is proportional to the number of vesicles on the cell surface, $R(t)$, and then use this model to estimate the kinetic rates $k_{\\mathrm{exo}}$ and $k_{\\mathrm{endo}}$ from noisy data.\n\nThe dynamics of $R(t)$ are described by piecewise-constant coefficient linear ordinary differential equations (ODEs). We will solve the system for three distinct time intervals.\n\n1.  **Pre-stimulus Interval: $t \\in [0, t_{\\mathrm{on}}]$**\n    In this interval, exocytosis is inactive ($k_{\\mathrm{exo}} = 0$). The governing ODE is:\n    $$\n    \\frac{dR}{dt} = -k_{\\mathrm{endo}} R(t)\n    $$\n    The initial condition is given as $R(0) = 0$. The unique solution to this homogeneous first-order ODE with a zero initial condition is a constant zero function.\n    $$\n    R_1(t) = 0 \\quad \\text{for } t \\in [0, t_{\\mathrm{on}}]\n    $$\n    At the onset of stimulation, we have $R(t_{\\mathrm{on}}) = 0$.\n\n2.  **Stimulus Interval: $t \\in (t_{\\mathrm{on}}, t_{\\mathrm{off}}]$**\n    During stimulation, both exocytosis and endocytosis are active. The governing ODE is:\n    $$\n    \\frac{dR}{dt} = k_{\\mathrm{exo}} I(t) - k_{\\mathrm{endo}} R(t)\n    $$\n    Using the conservation principle $I(t) = T - R(t)$, we obtain a non-homogeneous linear first-order ODE for $R(t)$:\n    $$\n    \\frac{dR}{dt} = k_{\\mathrm{exo}} (T - R(t)) - k_{\\mathrm{endo}} R(t) = k_{\\mathrm{exo}} T - (k_{\\mathrm{exo}} + k_{\\mathrm{endo}}) R(t)\n    $$\n    Let $k_{\\mathrm{sum}} = k_{\\mathrm{exo}} + k_{\\mathrm{endo}}$. The equation is $\\frac{dR}{dt} + k_{\\mathrm{sum}} R(t) = k_{\\mathrm{exo}} T$. The general solution is the sum of a particular solution and the homogeneous solution. The steady-state (particular) solution is $R_{\\mathrm{p}} = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}}$. The homogeneous solution is $R_{\\mathrm{h}}(t) = C e^{-k_{\\mathrm{sum}} (t - t_{\\mathrm{on}})}$. The general solution is:\n    $$\n    R_2(t) = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} + C e^{-k_{\\mathrm{sum}} (t - t_{\\mathrm{on}})}\n    $$\n    We enforce continuity at $t = t_{\\mathrm{on}}$, such that $R_2(t_{\\mathrm{on}}) = R_1(t_{\\mathrm{on}}) = 0$.\n    $$\n    0 = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} + C \\implies C = -\\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}}\n    $$\n    Thus, the solution in this interval is:\n    $$\n    R_2(t) = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} \\left(1 - e^{-k_{\\mathrm{sum}} (t - t_{\\mathrm{on}})}\\right) \\quad \\text{for } t \\in (t_{\\mathrm{on}}, t_{\\mathrm{off}}]\n    $$\n\n3.  **Post-stimulus Interval: $t \\in (t_{\\mathrm{off}}, \\infty)$**\n    After the stimulus ceases, exocytosis is again inactive ($k_{\\mathrm{exo}} = 0$), and the ODE returns to its homogeneous form:\n    $$\n    \\frac{dR}{dt} = -k_{\\mathrm{endo}} R(t)\n    $$\n    The general solution is $R_3(t) = C' e^{-k_{\\mathrm{endo}} (t - t_{\\mathrm{off}})}$. The constant $C'$ is determined by the continuity condition at $t = t_{\\mathrm{off}}$, which requires $R_3(t_{\\mathrm{off}}) = R_2(t_{\\mathrm{off}})$.\n    Let $R_{\\mathrm{off}} = R_2(t_{\\mathrm{off}}) = \\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{sum}}} \\left(1 - e^{-k_{\\mathrm{sum}} (t_{\\mathrm{off}} - t_{\\mathrm{on}})}\\right)$.\n    Then $C' = R_{\\mathrm{off}}$. The solution is:\n    $$\n    R_3(t) = R_{\\mathrm{off}} \\cdot e^{-k_{\\mathrm{endo}} (t - t_{\\mathrm{off}})} \\quad \\text{for } t > t_{\\mathrm{off}}\n    $$\n\n**Summary of the Forward Model**\nThe complete analytical model for the expected fluorescence trace $\\hat{F}(t) = R(t)$ is given by the piecewise function:\n$$\n\\hat{F}(t; k_{\\mathrm{exo}}, k_{\\mathrm{endo}}) =\n\\begin{cases}\n0 & 0 \\le t \\le t_{\\mathrm{on}} \\\\\n\\frac{k_{\\mathrm{exo}} T}{k_{\\mathrm{exo}} + k_{\\mathrm{endo}}} \\left(1 - e^{-(k_{\\mathrm{exo}} + k_{\\mathrm{endo}}) (t - t_{\\mathrm{on}})}\\right) & t_{\\mathrm{on}} < t \\le t_{\\mathrm{off}} \\\\\nR_{\\mathrm{off}} \\cdot e^{-k_{\\mathrm{endo}} (t - t_{\\mathrm{off}})} & t > t_{\\mathrm{off}}\n\\end{cases}\n$$\nwhere $R_{\\mathrm{off}} = \\hat{F}(t_{\\mathrm{off}})$.\n\n**Parameter Estimation**\nTo estimate the parameters $\\{k_{\\mathrm{exo}}, k_{\\mathrm{endo}}\\}$ from a noisy data trace $\\{F(t_i)\\}$, we minimize the Sum of Squared Errors (SSE) between the model prediction $\\{\\hat{F}(t_i)\\}$ and the data. The objective function $L$ is:\n$$\nL(k_{\\mathrm{exo}}, k_{\\mathrm{endo}}) = \\sum_{i} \\left(\\hat{F}(t_i; k_{\\mathrm{exo}}, k_{\\mathrm{endo}}) - F(t_i)\\right)^2\n$$\nThis is a nonlinear optimization problem, which we solve numerically subject to the physical constraints $k_{\\mathrm{exo}} \\ge 0$ and $k_{\\mathrm{endo}} \\ge 0$.\n\n**Computational Strategy**\nThe solution is implemented in Python. For each test case:\n1.  A noisy fluorescence trace is synthesized by computing the true trace using the derived analytical model with the given parameters, and adding Gaussian noise $\\mathcal{N}(0, \\sigma^2)$ with the specified random seed.\n2.  The `scipy.optimize.minimize` function with the `L-BFGS-B` algorithm is used to find the values of $k_{\\mathrm{exo}}$ and $k_{\\mathrm{endo}}$ that minimize the SSE objective function. This algorithm is chosen for its efficiency and its ability to handle box constraints (i.e., $k_{\\mathrm{exo}} \\ge 0, k_{\\mathrm{endo}} \\ge 0$).\n3.  The estimated parameters are rounded to three decimal places and formatted as specified.\nThis procedure is repeated for all three test cases provided in the problem description.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the vesicle cycle modeling problem by deriving a forward model,\n    synthesizing noisy data, and fitting parameters via least squares.\n    \"\"\"\n\n    # Define shared settings from the problem statement.\n    dt = 0.05\n    t_final = 10.0\n    t_values = np.linspace(0.0, t_final, int(t_final / dt) + 1)\n    T_vesicles = 1.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'Case A',\n            't_on': 1.00, 't_off': 3.00,\n            'k_exo_true': 1.20, 'k_endo_true': 0.60,\n            'sigma': 0.01, 'seed': 13\n        },\n        {\n            'name': 'Case B',\n            't_on': 1.00, 't_off': 3.00,\n            'k_exo_true': 0.80, 'k_endo_true': 0.15,\n            'sigma': 0.01, 'seed': 42\n        },\n        {\n            'name': 'Case C',\n            't_on': 1.00, 't_off': 3.00,\n            'k_exo_true': 0.60, 'k_endo_true': 2.00,\n            'sigma': 0.01, 'seed': 7\n        },\n    ]\n\n    # Store results for final output\n    results = []\n\n    for case in test_cases:\n        t_on = case['t_on']\n        t_off = case['t_off']\n\n        def forward_model(params, t):\n            \"\"\"\n            Computes the fluorescence trace based on the analytical solution.\n            \"\"\"\n            k_exo, k_endo = params\n            \n            # The optimizer bounds should prevent negative rates, but as a safeguard:\n            if k_exo  0 or k_endo  0:\n                return np.full_like(t, np.inf)\n\n            F_hat = np.zeros_like(t, dtype=float)\n\n            # --- During stimulus phase ---\n            stim_mask = (t > t_on)  (t = t_off)\n            t_stim = t[stim_mask]\n            k_sum = k_exo + k_endo\n            \n            # Use small epsilon to avoid division by zero\n            if k_sum > 1e-9:\n                R_inf_on = (k_exo * T_vesicles) / k_sum\n                F_hat[stim_mask] = R_inf_on * (1 - np.exp(-k_sum * (t_stim - t_on)))\n            else: # If k_sum is zero, rates are zero, so fluorescence is zero.\n                F_hat[stim_mask] = 0.0\n\n            # --- Post stimulus phase ---\n            post_stim_mask = t > t_off\n            t_post = t[post_stim_mask]\n            \n            # Value at the end of stimulation\n            if k_sum > 1e-9:\n                R_off_val = R_inf_on * (1 - np.exp(-k_sum * (t_off - t_on)))\n            else:\n                R_off_val = 0.0\n\n            # Calculate decay\n            if k_endo > 1e-9:\n                F_hat[post_stim_mask] = R_off_val * np.exp(-k_endo * (t_post - t_off))\n            else: # If k_endo is zero, fluorescence remains constant post-stimulus\n                F_hat[post_stim_mask] = R_off_val\n                \n            return F_hat\n\n        # Objective function for the optimizer (Sum of Squared Errors)\n        def sse_objective(params, t_data, f_data):\n            predicted_trace = forward_model(params, t_data)\n            return np.sum((predicted_trace - f_data)**2)\n\n        # 1. Synthesize noisy data\n        rng = np.random.default_rng(case['seed'])\n        true_params = [case['k_exo_true'], case['k_endo_true']]\n        true_trace = forward_model(true_params, t_values)\n        noise = rng.normal(loc=0.0, scale=case['sigma'], size=len(t_values))\n        noisy_trace = true_trace + noise\n\n        # 2. Fit the model to the noisy data\n        initial_guess = [1.0, 1.0]  # A reasonable starting point\n        bounds = [(0, None), (0, None)]  # Non-negativity constraints\n\n        opt_result = minimize(\n            sse_objective,\n            initial_guess,\n            args=(t_values, noisy_trace),\n            method='L-BFGS-B',\n            bounds=bounds,\n            options={'ftol': 1e-12, 'gtol': 1e-8} # Stricter tolerance for accuracy\n        )\n\n        k_exo_fit, k_endo_fit = opt_result.x\n        \n        # 3. Store rounded results\n        results.append([round(k_exo_fit, 3), round(k_endo_fit, 3)])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists will have spaces,\n    # so we construct the string manually.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2767742"}]}