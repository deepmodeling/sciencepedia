{"hands_on_practices": [{"introduction": "A direct and intuitive way to determine the presynaptic release probability, $p$, is to measure what fraction of the readily releasable pool (RRP) of vesicles is released by a single action potential. This exercise guides you through a classic experimental paradigm using hypertonic sucrose to estimate the total RRP size by measuring the total postsynaptic charge transfer. By comparing this to the charge evoked by a single action potential, you can compute a robust estimate of $p$ for a central synapse. [@problem_id:2740460]", "problem": "A cultured excitatory autapse is recorded under whole-cell voltage clamp at a holding potential of $-70$ mV. To quantify the readily releasable pool (RRP) of synaptic vesicles and link it to the presynaptic release probability $p$ for a single action potential, the following protocol is used.\n\n1. A brief hypertonic sucrose pulse ($500$ mM sucrose for $500$ ms) is applied to evoke calcium-independent fusion of the RRP. The net postsynaptic charge transfer (integral of the inward synaptic current above baseline) over the entire sucrose response is measured to be $Q_{\\text{suc}} = 1.20 \\times 10^{-10}$ C. The pulse duration is chosen such that replenishment during the pulse is negligible, and series resistance and leak are compensated such that the net synaptic charge is accurately measured.\n\n2. In the same cell, a single presynaptic action potential is evoked by a brief depolarizing command. The evoked excitatory postsynaptic current (EPSC) is integrated over a window that fully captures the synaptic current without contamination by subsequent events, yielding a charge $Q_{\\text{AP}} = 1.80 \\times 10^{-11}$ C. The interstimulus interval is made sufficiently long to avoid short-term plasticity interactions.\n\n3. Separately, miniature EPSCs (spontaneous, action-potential–independent events) are recorded in the presence of tetrodotoxin and a low-affinity competitive antagonist of $\\alpha$-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid (AMPA) receptors to promote linear summation and minimize receptor saturation/desensitization. The mean quantal charge is estimated as $q = 1.20 \\times 10^{-13}$ C.\n\nAssume the following widely accepted biophysical facts: hypertonic sucrose releases essentially all vesicles in the RRP with negligible replenishment over the integration window; within the timescale of a single action potential, replenishment is negligible; each vesicle fusion event contributes an identical quantal charge $q$ that is independent of the mode of release under these recording conditions; and postsynaptic responses sum linearly across vesicles.\n\nUnder these assumptions, compute the presynaptic release probability $p$ for a single action potential, defined as the probability that a vesicle in the RRP will be released by that action potential. Round your answer to four significant figures. Express your answer as a dimensionless decimal (no units).", "solution": "The problem is first subjected to rigorous validation. All provided information constitutes a well-defined, scientifically grounded problem in quantitative cellular neuroscience. The experimental paradigm described—using hypertonic sucrose to estimate the readily releasable pool (RRP) size and comparing it to the response evoked by a single action potential—is a standard and valid method. The given values for charge are physically realistic, and the assumptions (negligible replenishment, linear summation, uniform quantal size) are appropriate idealizations for formalizing the problem. Therefore, the problem is deemed valid, and we may proceed with the solution.\n\nThe fundamental principle underlying this problem is the quantal hypothesis of neurotransmitter release. This hypothesis states that neurotransmitter is released in discrete packets, or quanta, each corresponding to the fusion of a single synaptic vesicle. The postsynaptic response is the sum of the responses to individual quanta. Under the given experimental conditions, where postsynaptic receptor saturation and desensitization are minimized, we can assume a linear relationship between the number of released vesicles and the total postsynaptic charge transfer.\n\nLet $q$ be the mean quantal charge, representing the postsynaptic charge transfer resulting from the fusion of a single vesicle.\nThe problem provides $q = 1.20 \\times 10^{-13}$ C.\n\nThe readily releasable pool (RRP), denoted by its size $N_{\\text{RRP}}$, is the set of synaptic vesicles that are docked and primed at the presynaptic active zone, ready for immediate fusion. The experimental protocol uses a hypertonic sucrose pulse, which is assumed to cause the fusion of all vesicles in the RRP, and only those vesicles. The total charge measured during this pulse, $Q_{\\text{suc}}$, is therefore the product of the RRP size and the quantal charge.\n$$Q_{\\text{suc}} = N_{\\text{RRP}} \\cdot q$$\nFrom this relationship, we can determine the size of the RRP:\n$$N_{\\text{RRP}} = \\frac{Q_{\\text{suc}}}{q}$$\nUsing the provided values:\n$$N_{\\text{RRP}} = \\frac{1.20 \\times 10^{-10} \\text{ C}}{1.20 \\times 10^{-13} \\text{ C}} = 1000$$\nThus, the readily releasable pool contains $1000$ vesicles.\n\nNext, we consider the response to a single presynaptic action potential (AP). The total charge transfer evoked by one AP, $Q_{\\text{AP}}$, is the product of the number of vesicles released by that AP, which we denote as $N_{\\text{AP}}$, and the quantal charge $q$.\n$$Q_{\\text{AP}} = N_{\\text{AP}} \\cdot q$$\nThe value $Q_{\\text{AP}}$ is typically an average over many trials, so $N_{\\text{AP}}$ represents the mean number of vesicles released per AP. We can calculate this number:\n$$N_{\\text{AP}} = \\frac{Q_{\\text{AP}}}{q}$$\nUsing the provided values:\n$$N_{\\text{AP}} = \\frac{1.80 \\times 10^{-11} \\text{ C}}{1.20 \\times 10^{-13} \\text{ C}} = \\frac{1.8}{1.2} \\times 10^{2} = 1.5 \\times 100 = 150$$\nOn average, a single action potential triggers the release of $150$ vesicles.\n\nThe problem requires us to compute the presynaptic release probability, $p$. This is defined as the probability that any single vesicle within the RRP will be released by an action potential. The release process can be modeled as a series of independent Bernoulli trials, one for each vesicle in the RRP. The number of vesicles released by an AP, $N_{\\text{AP}}$, is therefore the expected outcome of this process. It is given by the product of the total number of available vesicles ($N_{\\text{RRP}}$) and the probability of release for each one ($p$).\n$$N_{\\text{AP}} = N_{\\text{RRP}} \\cdot p$$\nWe can now solve for the release probability $p$:\n$$p = \\frac{N_{\\text{AP}}}{N_{\\text{RRP}}}$$\nSubstituting the expressions for $N_{\\text{AP}}$ and $N_{\\text{RRP}}$ in terms of the measured charges:\n$$p = \\frac{\\left(\\frac{Q_{\\text{AP}}}{q}\\right)}{\\left(\\frac{Q_{\\text{suc}}}{q}\\right)}$$\nThe quantal charge $q$ cancels, yielding a direct relationship between the release probability and the experimentally measured charges:\n$$p = \\frac{Q_{\\text{AP}}}{Q_{\\text{suc}}}$$\nThis result is conceptually clear: the release probability is the fraction of the RRP that is released by a single action potential, as measured by the ratio of their respective total charges.\n\nWe can now substitute the given numerical values into this final expression:\n$$p = \\frac{1.80 \\times 10^{-11} \\text{ C}}{1.20 \\times 10^{-10} \\text{ C}} = \\frac{1.80}{12.0} = 0.15$$\nThe problem demands the answer be rounded to four significant figures. Therefore, we express the result as $0.1500$.\nThis value for release probability is typical for many central excitatory synapses, confirming the consistency of the problem's parameters with known neurophysiological data.", "answer": "$$\\boxed{0.1500}$$", "id": "2740460"}, {"introduction": "The fundamental principle of estimating release probability as the ratio of single-stimulus release to total pool size is applicable across different experimental modalities. This problem shifts the perspective from the postsynaptic side to the presynaptic terminal, using membrane capacitance measurements to directly track vesicle fusion. By comparing the capacitance jump from a single action potential to that from an RRP-depleting stimulus, you will see how biophysical principles provide a consistent view of release probability. [@problem_id:2740479]", "problem": "A large endocrine-like nerve terminal from the posterior pituitary is voltage clamped with a phase-tracking lock-in to measure whole-terminal membrane capacitance during controlled depolarizations. Assume the following well-tested biophysical facts and definitions:\n- The membrane specific capacitance is approximately constant and equal to $c_{m} = 1.0 \\,\\mu\\mathrm{F}/\\mathrm{cm}^{2}$.\n- Exocytosis adds the vesicular membrane area to the plasma membrane, increasing the whole-terminal capacitance in proportion to the added membrane area.\n- For a spherical vesicle of radius $r$, the membrane area is $A_{\\mathrm{ves}} = 4 \\pi r^{2}$, and the corresponding capacitance increment per fused vesicle is $c_{\\mathrm{ves}} = c_{m} \\, A_{\\mathrm{ves}}$.\n- The readily releasable pool (RRP) is the set of vesicles that can fuse rapidly upon depolarization, and for a single stimulus with independent fusion of RRP vesicles, the presynaptic release probability $p$ is the expected fraction of RRP vesicles that fuse.\n\nIn this experiment, large dense-core vesicles in the terminal can be approximated as spheres with radius $r = 100 \\,\\mathrm{nm}$. Two capacitance protocols are applied, and capacitance changes are sampled $10 \\,\\mathrm{ms}$ after the end of each stimulus to minimize endocytic contributions:\n\n1. An action potential-like depolarization evokes an exocytic capacitance jump of $\\Delta C_{\\mathrm{AP}} = 76.8 \\,\\mathrm{fF}$.\n2. A depleting $100 \\,\\mathrm{ms}$ depolarization evokes an exocytic capacitance jump of $\\Delta C_{\\max} = 480 \\,\\mathrm{fF}$ that is assumed to deplete the RRP.\n\nAssume that each fused vesicle fully flattens into the plasma membrane (so its entire surface area contributes to the capacitance increase), that the specific capacitance $c_{m}$ applies equally to plasma and vesicular membranes, and that the $10 \\,\\mathrm{ms}$ sampling time is short enough to neglect membrane retrieval. Using only the facts above and first principles, compute the presynaptic release probability $p$ for a single action potential relative to the RRP. Express your final answer as a dimensionless decimal and round your answer to four significant figures.", "solution": "The problem has been subjected to rigorous validation and is found to be scientifically grounded, self-contained, and well-posed. All provided parameters and definitions are consistent with established principles in cellular biophysics and electrophysiology. The task is a straightforward application of these principles. We may proceed to the solution.\n\nThe fundamental principle is that the total change in membrane capacitance, $\\Delta C$, is directly proportional to the number of exocytosed vesicles, $N_{\\text{fused}}$, because each fusion event adds a discrete quantum of membrane area to the cell surface. The problem explicitly states this relationship. The total capacitance change is the product of the number of fused vesicles and the capacitance contribution of a single vesicle, $c_{\\text{ves}}$.\n$$ \\Delta C = N_{\\text{fused}} \\cdot c_{\\text{ves}} $$\n\nThis relationship applies to both experimental protocols described.\n\nFirst, for the action potential-like depolarization, the measured capacitance jump is $\\Delta C_{\\mathrm{AP}} = 76.8 \\,\\mathrm{fF}$. This corresponds to the fusion of $N_{\\mathrm{AP}}$ vesicles.\n$$ \\Delta C_{\\mathrm{AP}} = N_{\\mathrm{AP}} \\cdot c_{\\text{ves}} $$\n\nSecond, for the depleting depolarization, the measured capacitance jump is $\\Delta C_{\\max} = 480 \\,\\mathrm{fF}$. This stimulus is assumed to cause the fusion of all vesicles in the readily releasable pool (RRP). Therefore, the number of vesicles fused, $N_{\\max}$, is equal to the total number of vesicles in the RRP, which we denote as $N_{\\mathrm{RRP}}$.\n$$ \\Delta C_{\\max} = N_{\\mathrm{RRP}} \\cdot c_{\\text{ves}} $$\n\nThe presynaptic release probability, $p$, for a single stimulus is defined as the expected fraction of RRP vesicles that fuse. For a single action potential, this is the ratio of the number of vesicles released by the action potential, $N_{\\mathrm{AP}}$, to the total number of vesicles in the RRP, $N_{\\mathrm{RRP}}$.\n$$ p = \\frac{N_{\\mathrm{AP}}}{N_{\\mathrm{RRP}}} $$\n\nTo compute $p$, we can first express $N_{\\mathrm{AP}}$ and $N_{\\mathrm{RRP}}$ in terms of the measured capacitances from our earlier equations:\n$$ N_{\\mathrm{AP}} = \\frac{\\Delta C_{\\mathrm{AP}}}{c_{\\text{ves}}} $$\n$$ N_{\\mathrm{RRP}} = \\frac{\\Delta C_{\\max}}{c_{\\text{ves}}} $$\n\nNow, we substitute these expressions into the equation for the release probability $p$:\n$$ p = \\frac{\\left(\\frac{\\Delta C_{\\mathrm{AP}}}{c_{\\text{ves}}}\\right)}{\\left(\\frac{\\Delta C_{\\max}}{c_{\\text{ves}}}\\right)} $$\n\nA competent student would immediately recognize that the term for the single-vesicle capacitance, $c_{\\text{ves}}$, cancels from the numerator and the denominator. This simplifies the problem significantly, revealing that the release probability can be determined directly from the ratio of the capacitance changes. The information regarding vesicle radius, $r$, and specific membrane capacitance, $c_m$, is therefore extraneous to the most direct solution path.\n$$ p = \\frac{\\Delta C_{\\mathrm{AP}}}{\\Delta C_{\\max}} $$\n\nWe are given the numerical values $\\Delta C_{\\mathrm{AP}} = 76.8 \\,\\mathrm{fF}$ and $\\Delta C_{\\max} = 480 \\,\\mathrm{fF}$. A simple substitution yields the value of $p$.\n$$ p = \\frac{76.8}{480} $$\nThe calculation is elementary:\n$$ p = 0.16 $$\n\nThe problem requires the final answer to be expressed as a dimensionless decimal rounded to four significant figures. The calculated value of $0.16$ is exact. To adhere to the specified precision, we must write it with four significant figures.\n$$ p = 0.1600 $$\nThis result indicates that a single action potential causes the release of, on average, $16\\%$ of the vesicles in the readily releasable pool.", "answer": "$$\\boxed{0.1600}$$", "id": "2740479"}, {"introduction": "Moving beyond single-point estimates, variance-mean analysis is a powerful statistical technique for dissecting the core parameters of synaptic transmission: the number of release sites ($N$), the quantal size ($q$), and the release probability ($p$). This exercise involves deriving the parabolic relationship between the mean and variance of synaptic responses that arises from the binomial nature of release. You will then apply this theoretical insight to analyze experimental data, demonstrating how to extract the synapse's invariant properties by observing its behavior across different release probabilities. [@problem_id:2740477]", "problem": "You are given a theoretical framework for synaptic transmission in which vesicular release at a single synapse follows a binomial process. The number of readily releasable vesicles is $N$, the probability that any vesicle releases upon an action potential is $p$, and each vesicle produces an identical postsynaptic quantal current of amplitude $q$ in arbitrary units. Measured synaptic current amplitudes are corrupted by independent, additive, zero-mean noise with variance $\\sigma_n^2$, with no other sources of noise. Assume vesicle releases are independent and identically distributed, and that the noise is independent of presynaptic release. Under these assumptions, for repeated trials at a fixed extracellular calcium level, denote by $\\mu$ the mean amplitude across trials and by $v$ the variance across trials. Across different calcium levels, $p$ may change, but $N$, $q$, and $\\sigma_n^2$ remain constant.\n\nTask 1 (derivation): Starting only from the definitions of the binomial distribution and the linearity of expectation and variance for independent random variables, derive an explicit analytical relationship between the variance $v$ and the mean $\\mu$ that holds when $p$ varies while $N$, $q$, and $\\sigma_n^2$ are fixed. Show that this relationship is a quadratic function of $\\mu$ with coefficients that depend only on $N$, $q$, and $\\sigma_n^2$.\n\nTask 2 (estimation): Design an algorithm that, given a finite set of measured pairs $\\{(\\mu_i, v_i)\\}_{i=1}^M$ collected at different calcium levels (and thus different $p_i$), estimates $N$, $q$, and $\\sigma_n^2$ by fitting the variance–mean relationship you derived in Task 1. Your estimator must enforce the physically consistent constraints $q \\ge 0$, $N > 0$ (equivalently, a concave-down quadratic), and $\\sigma_n^2 \\ge 0$. Use a least-squares approach that fits a quadratic in $\\mu$ to the $(\\mu_i,v_i)$ data under these constraints, and then maps the fitted quadratic coefficients to estimates of $N$, $q$, and $\\sigma_n^2$. Express $N$, $q$, and $\\sigma_n^2$ as real-valued outputs (do not round to integers), each rounded to six decimal places.\n\nTest suite: Apply your estimator to the following three datasets. Each dataset lists $(\\mu,v)$ pairs in arbitrary current units; each pair corresponds to a distinct calcium level. The underlying $N$, $q$, and $\\sigma_n^2$ used to generate these data are held fixed within each dataset but are not to be used directly by your estimator (they are provided only to justify scientific plausibility). Your program must only use the $(\\mu,v)$ pairs.\n\n- Dataset A (general case; underlying $N = 50$, $q = 0.4$, $\\sigma_n^2 = 0.02$), pairs:\n  $ (\\mu,v) \\in \\{(2.0, 0.74), (4.0, 1.3), (10.0, 2.02), (16.0, 1.3), (18.0, 0.74)\\} $.\n\n- Dataset B (large $N$, small $q$; underlying $N = 200$, $q = 0.05$, $\\sigma_n^2 = 0.005$), pairs:\n  $ (\\mu,v) \\in \\{(0.5, 0.02875), (2.5, 0.09875), (5.0, 0.13), (7.5, 0.09875), (9.5, 0.02875)\\} $.\n\n- Dataset C (boundary including near-deterministic release; underlying $N = 5$, $q = 1.2$, $\\sigma_n^2 = 0.1$), pairs:\n  $ (\\mu,v) \\in \\{(0.6, 0.748), (3.0, 1.9), (5.4, 0.748), (6.0, 0.1)\\} $.\n\nProgram requirements:\n- Implement the estimator described in Task 2 and apply it to each dataset independently to obtain $(\\hat{N},\\hat{q},\\widehat{\\sigma_n^2})$.\n- The final output must be a single line containing a list of three sublists, one per dataset, in the order A, B, C. Each sublist must be of the form $[\\hat{N},\\hat{q},\\widehat{\\sigma_n^2}]$, where each entry is a float rounded to six decimal places.\n- Final output format: a single line with a comma-separated list enclosed in square brackets, with the three sublists inside, for example $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$. Do not include any units or percentage signs; all values are in arbitrary units.\n\nAngle units are not applicable. Percentages must not be used; probabilities are implicit within the model and are not reported. The answer types are floats only, rounded to six decimal places, and the final output line must match the specified format exactly.", "solution": "The problem presented is a valid and well-posed exercise in quantitative neuroscience, specifically in the application of quantal analysis. It is scientifically grounded in the canonical binomial model of synaptic transmission, is mathematically self-contained, and uses objective, unambiguous language. We shall proceed with the derivation and then the design of the estimation algorithm.\n\n### Task 1: Derivation of the Variance-Mean Relationship\n\nThe problem begins with fundamental assumptions about synaptic transmission. Let $k$ be the random variable for the number of vesicles released upon a single action potential. This process is modeled as a binomial distribution, $k \\sim \\text{Binomial}(N, p)$, where $N$ is the total number of readily releasable vesicles and $p$ is the probability of release for any individual vesicle.\n\nThe mean and variance of the binomial random variable $k$ are given by its standard definitions:\n$$ E[k] = Np $$\n$$ Var(k) = Np(1-p) $$\n\nEach released vesicle contributes a quantal current of amplitude $q$. The total current from all released vesicles is thus $k \\cdot q$. The measured synaptic current amplitude, which we denote as the random variable $A$, is the sum of this synaptic current and an independent, additive noise term, $\\eta$.\n$$ A = k \\cdot q + \\eta $$\nThe noise $\\eta$ is specified to have a mean of zero and a variance of $\\sigma_n^2$.\n$$ E[\\eta] = 0 $$\n$$ Var(\\eta) = \\sigma_n^2 $$\n\nWe are tasked to find the relationship between the mean of the measured amplitude, $\\mu = E[A]$, and its variance, $v = Var(A)$.\n\nFirst, we calculate the mean amplitude $\\mu$. By the linearity of expectation:\n$$ \\mu = E[A] = E[k \\cdot q + \\eta] = E[k \\cdot q] + E[\\eta] $$\nSince $q$ is a constant, it can be factored out of the expectation:\n$$ \\mu = q \\cdot E[k] + E[\\eta] $$\nSubstituting the known expectations for $k$ and $\\eta$:\n$$ \\mu = q(Np) + 0 = Npq $$\n\nNext, we calculate the variance of the amplitude, $v$. The problem states that vesicle release and the noise process are independent. Consequently, the random variables $k$ and $\\eta$ are independent. This implies that $k \\cdot q$ and $\\eta$ are also independent. For independent random variables, the variance of the sum is the sum of the variances:\n$$ v = Var(A) = Var(k \\cdot q + \\eta) = Var(k \\cdot q) + Var(\\eta) $$\nUsing the property $Var(c X) = c^2 Var(X)$ for a constant $c$:\n$$ Var(k \\cdot q) = q^2 Var(k) $$\nSubstituting the known variances for $k$ and $\\eta$:\n$$ v = q^2 (Np(1-p)) + \\sigma_n^2 $$\n\nWe now have two equations relating the observables $\\mu$ and $v$ to the underlying parameters, including the variable $p$:\n1.  $\\mu = Npq$\n2.  $v = Npq^2(1-p) + \\sigma_n^2$\n\nTo find a relationship between $v$ and $\\mu$ that is independent of $p$, we must eliminate $p$. From equation (1), we solve for $p$:\n$$ p = \\frac{\\mu}{Nq} $$\nThis expression is valid for $0 \\le \\mu \\le Nq$, which corresponds to the physical range $0 \\le p \\le 1$.\n\nWe substitute this expression for $p$ into equation (2):\n$$ v = Nq^2 \\left(\\frac{\\mu}{Nq}\\right) \\left(1 - \\frac{\\mu}{Nq}\\right) + \\sigma_n^2 $$\nSimplifying the expression:\n$$ v = q\\mu \\left(1 - \\frac{\\mu}{Nq}\\right) + \\sigma_n^2 $$\n$$ v = q\\mu - \\frac{q\\mu^2}{Nq} + \\sigma_n^2 $$\n$$ v = q\\mu - \\frac{\\mu^2}{N} + \\sigma_n^2 $$\n\nFinally, we arrange this into the form of a quadratic function of $\\mu$, $v(\\mu) = a\\mu^2 + b\\mu + c$:\n$$ v(\\mu) = \\left(-\\frac{1}{N}\\right)\\mu^2 + (q)\\mu + (\\sigma_n^2) $$\nThis completes the derivation. The relationship is a parabolic function of $\\mu$. The coefficients of this quadratic depend only on the fixed parameters $N$, $q$, and $\\sigma_n^2$, as required:\n$$ a = -\\frac{1}{N} $$\n$$ b = q $$\n$$ c = \\sigma_n^2 $$\n\n### Task 2: Estimation Algorithm Design\n\nThe goal is to estimate $N$, $q$, and $\\sigma_n^2$ from a set of experimental data points $\\{(\\mu_i, v_i)\\}_{i=1}^M$. Based on the derived relationship, we can fit a quadratic model to this data. The problem demands a least-squares approach while enforcing physical consistency constraints:\n-   $N > 0$ (number of vesicles must be positive)\n-   $q \\ge 0$ (quantal size is non-negative)\n-   $\\sigma_n^2 \\ge 0$ (variance is non-negative)\n\nThese constraints on the physical parameters translate to constraints on the quadratic coefficients $(a, b, c)$:\n-   $a = -1/N \\implies a < 0$ (the parabola must be concave-down)\n-   $b = q \\implies b \\ge 0$\n-   $c = \\sigma_n^2 \\implies c \\ge 0$\n\nWe must solve a constrained linear least-squares problem. For each data point $(\\mu_i, v_i)$, we have the equation $v_i \\approx a\\mu_i^2 + b\\mu_i + c$. This system can be expressed in matrix form as $\\mathbf{X\\beta} \\approx \\mathbf{v}$, where:\n$$ \\mathbf{X} = \\begin{pmatrix} \\mu_1^2 & \\mu_1 & 1 \\\\ \\mu_2^2 & \\mu_2 & 1 \\\\ \\vdots & \\vdots & \\vdots \\\\ \\mu_M^2 & \\mu_M & 1 \\end{pmatrix}, \\quad \\mathbf{\\beta} = \\begin{pmatrix} a \\\\ b \\\\ c \\end{pmatrix}, \\quad \\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ \\vdots \\\\ v_M \\end{pmatrix} $$\n\nThe objective is to find the vector $\\hat{\\mathbf{\\beta}} = [\\hat{a}, \\hat{b}, \\hat{c}]^T$ that minimizes the sum of squared errors, $||\\mathbf{X\\beta} - \\mathbf{v}||_2^2$, subject to the constraints $\\hat{a} \\le 0$, $\\hat{b} \\ge 0$, and $\\hat{c} \\ge 0$. Note that the strict inequality $a < 0$ is implemented as $a \\le 0$, where the boundary case $a=0$ corresponds to the physical limit of an infinite vesicle pool ($N \\to \\infty$).\n\nThis constrained optimization problem can be solved using standard numerical libraries. We will use the `scipy.optimize.lsq_linear` function, which is designed for this purpose. The bounds on the coefficient vector $\\mathbf{\\beta}$ are specified as `lower_bounds = [-infinity, 0, 0]` and `upper_bounds = [0, +infinity, +infinity]`.\n\nOnce the optimal coefficients $(\\hat{a}, \\hat{b}, \\hat{c})$ are found, the estimates for the physical parameters are determined by inverting the mapping:\n$$ \\hat{N} = -\\frac{1}{\\hat{a}} $$\n$$ \\hat{q} = \\hat{b} $$\n$$ \\widehat{\\sigma_n^2} = \\hat{c} $$\n\nThe algorithm is as follows:\n1.  For each provided dataset of $(\\mu, v)$ pairs.\n2.  Construct the design matrix $\\mathbf{X}$ and the observation vector $\\mathbf{v}$.\n3.  Use `scipy.optimize.lsq_linear` to solve for the coefficients $\\mathbf{\\beta} = [a,b,c]^T$ with the bounds $([-\\infty, 0, 0], [0, \\infty, \\infty])$.\n4.  From the resulting coefficients $(\\hat{a}, \\hat{b}, \\hat{c})$, calculate the physical parameter estimates $(\\hat{N}, \\hat{q}, \\widehat{\\sigma_n^2})$.\n5.  Round the estimates to six decimal places as required.\n6.  Collect the results for all datasets and format them into the specified output string.\n\nThe provided test data are perfectly consistent with the model, meaning the data points lie exactly on a parabola. In such a scenario, the unconstrained ordinary least-squares solution would coincide with the constrained one. However, adherence to the problem specification requires the explicit use of a constrained estimation method.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Solves the quantal analysis problem for the given datasets.\n    \n    This function implements a constrained least-squares fitting procedure to estimate\n    the parameters of the binomial model of synaptic transmission (N, q, sigma_n^2)\n    from variance-mean data.\n    \"\"\"\n    \n    test_cases = [\n        # Dataset A (general case; underlying N=50, q=0.4, sigma_n^2=0.02)\n        [\n            (2.0, 0.74),\n            (4.0, 1.3),\n            (10.0, 2.02),\n            (16.0, 1.3),\n            (18.0, 0.74),\n        ],\n        # Dataset B (large N, small q; underlying N=200, q=0.05, sigma_n^2=0.005)\n        [\n            (0.5, 0.02875),\n            (2.5, 0.09875),\n            (5.0, 0.13),\n            (7.5, 0.09875),\n            (9.5, 0.02875),\n        ],\n        # Dataset C (boundary including near-deterministic release; underlying N=5, q=1.2, sigma_n^2=0.1)\n        [\n            (0.6, 0.748),\n            (3.0, 1.9),\n            (5.4, 0.748),\n            (6.0, 0.1),\n        ],\n    ]\n\n    all_results = []\n\n    for dataset in test_cases:\n        data_array = np.array(dataset)\n        mu = data_array[:, 0]\n        v = data_array[:, 1]\n        \n        # We are fitting the model v = a*mu^2 + b*mu + c\n        # The design matrix X has columns [mu^2, mu, 1]\n        X = np.vstack([mu**2, mu, np.ones(len(mu))]).T\n        \n        # We need to find the coefficients beta = [a, b, c]\n        \n        # The physical constraints are:\n        # N > 0  => a = -1/N < 0\n        # q >= 0 => b >= 0\n        # sigma_n^2 >= 0 => c >= 0\n        # This translates to bounds on the coefficients [a, b, c].\n        bounds = ([-np.inf, 0, 0], [0, np.inf, np.inf])\n        \n        # Use constrained linear least-squares from SciPy\n        result = lsq_linear(X, v, bounds=bounds)\n        a_hat, b_hat, c_hat = result.x\n        \n        # Convert fitted coefficients back to physical parameters\n        # N_hat = -1 / a_hat\n        # q_hat = b_hat\n        # sigma_n2_hat = c_hat\n        \n        # Handle the edge case where a_hat is numerically zero (implying N -> infinity)\n        if np.isclose(a_hat, 0):\n            N_hat = np.inf\n        else:\n            N_hat = -1.0 / a_hat\n            \n        q_hat = b_hat\n        sigma_n2_hat = c_hat\n        \n        estimated_params = [N_hat, q_hat, sigma_n2_hat]\n        all_results.append(estimated_params)\n\n    # Format the final output string as specified\n    formatted_sublists = []\n    for res in all_results:\n        # Round each parameter to six decimal places\n        N_r, q_r, s_r = res[0], res[1], res[2]\n        sublist_str = f\"[{N_r:.6f},{q_r:.6f},{s_r:.6f}]\"\n        formatted_sublists.append(sublist_str)\n        \n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2740477"}]}