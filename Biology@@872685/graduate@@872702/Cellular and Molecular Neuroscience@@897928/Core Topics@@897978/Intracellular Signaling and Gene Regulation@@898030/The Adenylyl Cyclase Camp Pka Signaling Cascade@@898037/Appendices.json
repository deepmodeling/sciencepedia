{"hands_on_practices": [{"introduction": "The concentration of cyclic AMP ($cAMP$) is the central currency of the signaling cascade, and its steady-state level is determined by a tug-of-war between synthesis by adenylyl cyclases (ACs) and degradation by phosphodiesterases (PDEs). This exercise challenges you to quantify this balance by applying the principles of mass-action kinetics. By modeling PDE activity with the classic Michaelis-Menten equation, you will derive the steady-state cAMP concentration in a scenario with multiple degrading enzymes, a common situation in real neurons [@problem_id:2761780].", "problem": "A well-stirred neuronal compartment maintains cyclic adenosine monophosphate (cAMP) at steady state through a balance between production by adenylyl cyclase (AC) and degradation by phosphodiesterases (PDEs). Assume that AC produces cAMP at a constant, zero-order rate that does not depend on cAMP concentration, and each PDE isoform catalyzes cAMP hydrolysis following Michaelis–Menten kinetics. There are no other sources or sinks for cAMP, and the compartment volume is constant.\n\nTwo PDE isoforms are present with the following kinetic parameters:\n- Isoform 1: maximum velocity $V_{\\max,1} = 0.80$ in units of micromolar per second and Michaelis constant $K_{M,1} = 2.00$ in units of micromolar.\n- Isoform 2: maximum velocity $V_{\\max,2} = 0.60$ in units of micromolar per second and Michaelis constant $K_{M,2} = 10.0$ in units of micromolar.\n\nThe AC production rate is $v_{\\mathrm{AC}} = 0.50$ in units of micromolar per second.\n\nUsing mass balance at steady state and Michaelis–Menten kinetics for PDE-mediated degradation, derive and solve for the steady-state cAMP concentration, denoted $[{\\mathrm{cAMP}}]$, in the compartment.\n\nExpress your final answer in micromolar and round your answer to four significant figures.", "solution": "The problem statement is first subjected to validation.\n\nGivens are extracted verbatim:\n- System: A well-stirred neuronal compartment at steady state.\n- Production: Adenylyl cyclase (AC) produces cAMP at a constant, zero-order rate $v_{\\mathrm{AC}} = 0.50$ micromolar per second.\n- Degradation: Two phosphodiesterase (PDE) isoforms degrade cAMP via Michaelis–Menten kinetics.\n- PDE Isoform 1 parameters: $V_{\\max,1} = 0.80$ micromolar per second, $K_{M,1} = 2.00$ micromolar.\n- PDE Isoform 2 parameters: $V_{\\max,2} = 0.60$ micromolar per second, $K_{M,2} = 10.0$ micromolar.\n- Constraint: No other sources or sinks for cAMP.\n- Objective: Find the steady-state cAMP concentration, $[{\\mathrm{cAMP}}]$.\n\nValidation verdict: The problem is scientifically grounded, employing standard principles of chemical kinetics (mass balance and Michaelis–Menten enzyme kinetics). It is well-posed, with all necessary parameters provided and a clear objective. The language is precise and objective. The setup is self-contained and free of contradictions or scientifically unsound premises. Therefore, the problem is deemed valid and a solution will be provided.\n\nThe fundamental principle governing the concentration of cyclic adenosine monophosphate, denoted as $[\\mathrm{cAMP}]$, is the law of mass action. The rate of change of $[\\mathrm{cAMP}]$ is the difference between its rate of production and its rate of degradation.\n\n$$\n\\frac{d[\\mathrm{cAMP}]}{dt} = v_{\\mathrm{production}} - v_{\\mathrm{degradation}}\n$$\n\nAt steady state, the concentration does not change over time, so $\\frac{d[\\mathrm{cAMP}]}{dt} = 0$. This implies that the rate of production must equal the rate of degradation.\n\n$$\nv_{\\mathrm{production}} = v_{\\mathrm{degradation}}\n$$\n\nThe production of cAMP is catalyzed by adenylyl cyclase (AC) at a constant, zero-order rate, $v_{\\mathrm{AC}}$. The degradation is catalyzed by two distinct phosphodiesterase (PDE) isoforms, and the total degradation rate is the sum of the rates of each isoform. Both isoforms follow Michaelis–Menten kinetics.\n\nLet $C$ represent the steady-state concentration $[\\mathrm{cAMP}]$. The steady-state condition is expressed as:\n$$\nv_{\\mathrm{AC}} = v_{\\mathrm{PDE},1} + v_{\\mathrm{PDE},2}\n$$\nSubstituting the Michaelis–Menten equation for each PDE isoform, we have:\n$$\nv_{\\mathrm{AC}} = \\frac{V_{\\max,1} C}{K_{M,1} + C} + \\frac{V_{\\max,2} C}{K_{M,2} + C}\n$$\nTo solve for $C$, we must rearrange this equation into a polynomial form. We begin by combining the terms on the right-hand side over a common denominator:\n$$\nv_{\\mathrm{AC}} = \\frac{V_{\\max,1} C (K_{M,2} + C) + V_{\\max,2} C (K_{M,1} + C)}{(K_{M,1} + C)(K_{M,2} + C)}\n$$\nMultiplying both sides by the denominator yields:\n$$\nv_{\\mathrm{AC}} (K_{M,1} + C)(K_{M,2} + C) = V_{\\max,1} C (K_{M,2} + C) + V_{\\max,2} C (K_{M,1} + C)\n$$\nExpanding both sides of the equation:\n$$\nv_{\\mathrm{AC}} (K_{M,1} K_{M,2} + (K_{M,1} + K_{M,2})C + C^2) = V_{\\max,1} K_{M,2} C + V_{\\max,1} C^2 + V_{\\max,2} K_{M,1} C + V_{\\max,2} C^2\n$$\nWe collect terms to form a standard quadratic equation of the form $aC^2 + bC + c = 0$.\n$$\n(v_{\\mathrm{AC}}) C^2 + (v_{\\mathrm{AC}}(K_{M,1} + K_{M,2})) C + v_{\\mathrm{AC}} K_{M,1} K_{M,2} = (V_{\\max,1} + V_{\\max,2}) C^2 + (V_{\\max,1} K_{M,2} + V_{\\max,2} K_{M,1}) C\n$$\nRearranging gives:\n$$\n(v_{\\mathrm{AC}} - V_{\\max,1} - V_{\\max,2}) C^2 + (v_{\\mathrm{AC}}(K_{M,1} + K_{M,2}) - V_{\\max,1} K_{M,2} - V_{\\max,2} K_{M,1}) C + v_{\\mathrm{AC}} K_{M,1} K_{M,2} = 0\n$$\nNow, we substitute the given numerical values into the coefficients of this quadratic equation. The units are consistent, so we may proceed with the dimensionless values.\nGiven:\n$v_{\\mathrm{AC}} = 0.50$\n$V_{\\max,1} = 0.80$, $K_{M,1} = 2.00$\n$V_{\\max,2} = 0.60$, $K_{M,2} = 10.0$\n\nThe coefficients are calculated as:\nCoefficient $a$:\n$$\na = v_{\\mathrm{AC}} - V_{\\max,1} - V_{\\max,2} = 0.50 - 0.80 - 0.60 = -0.90\n$$\nCoefficient $b$:\n$$\nb = v_{\\mathrm{AC}}(K_{M,1} + K_{M,2}) - (V_{\\max,1} K_{M,2} + V_{\\max,2} K_{M,1}) = 0.50(2.00 + 10.0) - (0.80 \\times 10.0 + 0.60 \\times 2.00)\n$$\n$$\nb = 0.50(12.0) - (8.00 + 1.20) = 6.0 - 9.20 = -3.20\n$$\nCoefficient $c$:\n$$\nc = v_{\\mathrm{AC}} K_{M,1} K_{M,2} = 0.50 \\times 2.00 \\times 10.0 = 10.0\n$$\nThe resulting quadratic equation for $C$ is:\n$$\n-0.90 C^2 - 3.20 C + 10.0 = 0\n$$\nMultiplying by $-1$ for convenience:\n$$\n0.90 C^2 + 3.20 C - 10.0 = 0\n$$\nWe solve for $C$ using the quadratic formula, $C = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nC = \\frac{-3.20 \\pm \\sqrt{(3.20)^2 - 4(0.90)(-10.0)}}{2(0.90)}\n$$\n$$\nC = \\frac{-3.20 \\pm \\sqrt{10.24 + 36.0}}{1.80}\n$$\n$$\nC = \\frac{-3.20 \\pm \\sqrt{46.24}}{1.80}\n$$\nThe square root is $\\sqrt{46.24} = 6.80$.\n$$\nC = \\frac{-3.20 \\pm 6.80}{1.80}\n$$\nThis gives two possible mathematical solutions for $C$:\n$$\nC_1 = \\frac{-3.20 + 6.80}{1.80} = \\frac{3.60}{1.80} = 2.00\n$$\n$$\nC_2 = \\frac{-3.20 - 6.80}{1.80} = \\frac{-10.0}{1.80} \\approx -5.56\n$$\nConcentration must be a non-negative quantity. Therefore, the second solution, $C_2$, is physically unrealistic and must be discarded. The only valid solution is $C = 2.00 \\, \\mu\\text{M}$.\n\nTo verify this solution, we substitute $C = 2.00$ back into the original rate balance equation:\nTotal degradation rate $v_{\\mathrm{PDE}} = \\frac{0.80 \\times 2.00}{2.00 + 2.00} + \\frac{0.60 \\times 2.00}{10.0 + 2.00} = \\frac{1.60}{4.00} + \\frac{1.20}{12.0} = 0.40 + 0.10 = 0.50 \\, \\mu\\text{M/s}$.\nThis matches the production rate $v_{\\mathrm{AC}} = 0.50 \\, \\mu\\text{M/s}$, confirming the correctness of the solution.\n\nThe problem requires the answer to be expressed to four significant figures. The exact answer is $2$. Thus, we write it as $2.000$.", "answer": "$$\\boxed{2.000}$$", "id": "2761780"}, {"introduction": "Biological signaling pathways are rarely simple, linear cascades; they are intricate networks regulated by feedback loops that enable complex behaviors like adaptation and homeostasis. In this practice, you will analyze a model of the cAMP pathway that incorporates two critical negative feedback mechanisms: PKA-mediated receptor desensitization and PKA-enhanced PDE activity. This exercise will guide you through the process of using dynamical systems theory to determine the stability of the system and to demonstrate how these feedback loops confer perfect adaptation to sustained stimuli, a hallmark of robust biological circuits [@problem_id:2761693].", "problem": "A neurotransmitter activates a G protein-coupled receptor (GPCR), which stimulates adenylyl cyclase (AC) to produce cyclic adenosine monophosphate (cAMP). The cAMP activates protein kinase A (PKA), which exerts two feedback effects: it phosphorylates and thereby desensitizes the GPCR, and it increases the maximal activity of cAMP-degrading phosphodiesterase (PDE). Consider the following minimal, biophysically grounded model for the cytosolic cAMP concentration $x(t)$ under a constant agonist input $u$:\n\n- The active receptor fraction is $r(u,p)=\\dfrac{s(u)}{1+\\beta p}$, where $s(u)=\\dfrac{u}{K_{R}+u}$ represents ligand-occupancy saturation, $p \\in [0,1]$ is the active fraction of PKA, and $\\beta \\ge 0$ quantifies PKA-dependent desensitization.\n- cAMP production by AC is $v_{a} r(u,p)$, where $v_{a} > 0$ is a maximal rate constant.\n- cAMP degradation by PDE is $v_{d0}\\bigl(1+\\alpha p\\bigr)\\dfrac{x}{K_{M}+x}$, where $v_{d0} > 0$ is a baseline maximal rate constant, $\\alpha \\ge 0$ quantifies PKA-dependent PDE activation, and $K_{M} > 0$ is the Michaelis constant.\n- PKA activation is fast relative to $x(t)$ and follows a cooperative Hill relation $p(x)=\\dfrac{x^{n}}{K_{P}^{n}+x^{n}}$ with Hill coefficient $n \\ge 1$ and half-activation $K_{P} > 0$.\n\nThus, the cAMP dynamics are\n$$\n\\frac{dx}{dt}=v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)}-v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}.\n$$\n\nTasks:\n1) Derive the steady-state condition for $x^{\\ast}$ as a function of $u$ and the parameters by setting $\\dfrac{dx}{dt}=0$.\n\n2) Using only the signs and monotonicity implied by the biochemical definitions above, derive a necessary condition on the steady-state slope $\\dfrac{d}{dx}\\left[v_{a}\\dfrac{s(u)}{1+\\beta p(x)}-v_{d0}\\left(1+\\alpha p(x)\\right)\\dfrac{x}{K_{M}+x}\\right]$ for the existence of multiple steady states in a one-dimensional system, and evaluate whether this condition can be satisfied for $\\alpha \\ge 0$, $\\beta \\ge 0$, $n \\ge 1$ with all rate and affinity parameters positive. Conclude whether bistability is possible in this minimal model.\n\n3) Using the implicit function theorem, express the steady-state sensitivity $\\dfrac{dx^{\\ast}}{du}$ in terms of partial derivatives of the right-hand side with respect to $u$ and $x$, and then evaluate the limit of $\\dfrac{dx^{\\ast}}{du}$ as $u \\to \\infty$ (the receptor-occupancy saturated regime). Provide your final answer as the closed-form expression for $\\displaystyle \\lim_{u \\to \\infty} \\frac{dx^{\\ast}}{du}$.", "solution": "The problem presents a dynamical system for the concentration of cyclic adenosine monophosphate (cAMP), denoted by $x(t)$, which is governed by the ordinary differential equation:\n$$\n\\frac{dx}{dt} = v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)} - v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}\n$$\nAll parameters $v_a, v_{d0}, K_R, K_M, K_P$ are positive, and the feedback strengths $\\alpha, \\beta$ are non-negative. The Hill coefficient $n \\ge 1$. The agonist input $u$ is a non-negative constant.\n\nThe problem is scientifically grounded, well-posed, objective, and self-contained, presenting a standard problem in biochemical systems analysis. The model uses established kinetic forms (Michaelis-Menten, Hill function) to describe a well-known signaling pathway. The tasks are precise mathematical questions about the properties of this model. Therefore, the problem is valid, and we proceed with the solution.\n\nLet the right-hand side of the differential equation be denoted by $F(x, u)$.\n$$\nF(x, u) = v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)} - v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}\n$$\n\n**1) Steady-State Condition**\n\nThe steady-state concentration, $x^{\\ast}$, is found by setting the rate of change of $x$ to zero, i.e., $\\frac{dx}{dt} = 0$. This yields the condition $F(x^{\\ast}, u) = 0$.\n$$\nv_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x^{\\ast})} - v_{d0}\\,\\bigl(1+\\alpha\\,p(x^{\\ast})\\bigr)\\,\\frac{x^{\\ast}}{K_{M}+x^{\\ast}} = 0\n$$\nThis equation can be rewritten to express the balance between production and degradation at steady state:\n$$\nv_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x^{\\ast})} = v_{d0}\\,\\bigl(1+\\alpha\\,p(x^{\\ast})\\bigr)\\,\\frac{x^{\\ast}}{K_{M}+x^{\\ast}}\n$$\nwhere $s(u) = \\frac{u}{K_R + u}$ and $p(x^{\\ast}) = \\frac{(x^{\\ast})^{n}}{K_P^{n}+(x^{\\ast})^{n}}$. This is an implicit equation that defines the steady-state concentration $x^{\\ast}$ as a function of the input $u$ and the system parameters.\n\n**2) Analysis of Multiple Steady States (Bistability)**\n\nIn a one-dimensional system described by $\\frac{dx}{dt} = F(x, u)$, the existence of multiple steady states requires the equation $F(x, u) = 0$ to have multiple solutions for $x$. For a continuous function $F(x, u)$, this implies that the function must be non-monotonic with respect to $x$. A necessary condition for such non-monotonicity is the existence of at least one point $x_0 > 0$ where the derivative of $F(x, u)$ with respect to $x$ changes sign. Specifically, to have a region of negative slope giving rise to an unstable steady state flanked by stable ones, there must exist some $x_0$ such that the slope is positive: $\\frac{\\partial F}{\\partial x}\\Big|_{x=x_0} > 0$.\n\nWe will now calculate this derivative. Let us differentiate the two terms of $F(x, u)$ separately. First, the derivative of the PKA activation function $p(x)$ is required:\n$$\np'(x) = \\frac{d}{dx}\\left(\\frac{x^{n}}{K_{P}^{n}+x^{n}}\\right) = \\frac{n x^{n-1}(K_{P}^{n}+x^{n}) - x^{n}(n x^{n-1})}{(K_{P}^{n}+x^{n})^2} = \\frac{n K_{P}^{n} x^{n-1}}{(K_{P}^{n}+x^{n})^2}\n$$\nSince $n \\ge 1$ and all parameters are positive, $p'(x) \\ge 0$ for all $x \\ge 0$.\n\nThe derivative of the production term with respect to $x$ is:\n$$\n\\frac{\\partial}{\\partial x}\\left(v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)}\\right) = v_{a} s(u) \\frac{-\\beta p'(x)}{(1+\\beta p(x))^2} = -v_{a} s(u) \\frac{\\beta p'(x)}{(1+\\beta p(x))^2}\n$$\nGiven that $v_a > 0$, $s(u) \\ge 0$, $\\beta \\ge 0$, and $p'(x) \\ge 0$, this term is always non-positive ($\\le 0$).\n\nThe derivative of the degradation term with respect to $x$ is:\n$$\n\\frac{\\partial}{\\partial x}\\left(v_{d0}\\,\\bigl(1+\\alpha\\,p(x)\\bigr)\\,\\frac{x}{K_{M}+x}\\right) = v_{d0} \\left[ \\left(\\frac{d}{dx}(1+\\alpha p(x))\\right) \\frac{x}{K_M+x} + (1+\\alpha p(x)) \\left(\\frac{d}{dx}\\frac{x}{K_M+x}\\right) \\right]\n$$\nUsing the product rule and the quotient rule for the Michaelis-Menten term $\\frac{d}{dx}\\frac{x}{K_M+x} = \\frac{K_M}{(K_M+x)^2}$, we get:\n$$\n= v_{d0} \\left[ \\alpha p'(x) \\frac{x}{K_M+x} + (1+\\alpha p(x)) \\frac{K_M}{(K_M+x)^2} \\right]\n$$\nGiven that $v_{d0}>0$, $\\alpha \\ge 0$, $p'(x) \\ge 0$, $x \\ge 0$, $p(x) \\ge 0$, and $K_M > 0$, every component in this expression is non-negative. Thus, the derivative of the degradation term is always non-negative ($\\ge 0$).\n\nCombining these results, the total derivative of $F(x, u)$ with respect to $x$ is:\n$$\n\\frac{\\partial F}{\\partial x} = \\underbrace{-v_{a} s(u) \\frac{\\beta p'(x)}{(1+\\beta p(x))^2}}_{\\le 0} - \\underbrace{v_{d0} \\left[ \\alpha p'(x) \\frac{x}{K_M+x} + (1+\\alpha p(x)) \\frac{K_M}{(K_M+x)^2} \\right]}_{\\ge 0}\n$$\nThe derivative $\\frac{\\partial F}{\\partial x}$ is the sum of a non-positive term and a non-positive term (the negative of a non-negative term). Therefore, $\\frac{\\partial F}{\\partial x} \\le 0$ for all $x \\ge 0$ and for all valid parameter values.\n\nThe necessary condition for bistability, that $\\frac{\\partial F}{\\partial x} > 0$ for some $x$, can never be satisfied. The function $F(x, u)$ is monotonically non-increasing in $x$. For any $u > 0$, we have $F(0, u) = v_a s(u) > 0$ and $\\lim_{x\\to\\infty} F(x, u) = -\\infty$. A continuous, monotonically decreasing function can cross the x-axis at most once.\nConclusion: Bistability is impossible in this minimal model. The system possesses a single, globally stable steady state for any constant input $u$. The two feedback mechanisms described—receptor desensitization and PDE activation by PKA—are both instances of negative feedback on the cAMP concentration $x$, which precludes the possibility of multiple stable states.\n\n**3) Steady-State Sensitivity and its Limit**\n\nThe steady-state sensitivity of cAMP concentration to the agonist input is given by the derivative $\\frac{dx^{\\ast}}{du}$. We use the implicit function theorem on the steady-state condition $F(x^{\\ast}, u) = 0$. Differentiating this identity with respect to $u$ gives:\n$$\n\\frac{\\partial F}{\\partial x}\\frac{dx^{\\ast}}{du} + \\frac{\\partial F}{\\partial u} = 0 \\implies \\frac{dx^{\\ast}}{du} = -\\frac{\\partial F / \\partial u}{\\partial F / \\partial x}\n$$\nWe have already computed the denominator $\\frac{\\partial F}{\\partial x}$. The numerator is the partial derivative of $F(x, u)$ with respect to $u$:\n$$\n\\frac{\\partial F}{\\partial u} = \\frac{\\partial}{\\partial u} \\left(v_{a}\\,\\frac{s(u)}{1+\\beta\\,p(x)}\\right) = \\frac{v_a}{1+\\beta p(x)} \\frac{ds}{du}\n$$\nThe derivative of the saturation function $s(u) = \\frac{u}{K_R+u}$ is:\n$$\n\\frac{ds}{du} = \\frac{1(K_R+u) - u(1)}{(K_R+u)^2} = \\frac{K_R}{(K_R+u)^2}\n$$\nSo, the partial derivative with respect to $u$ is:\n$$\n\\frac{\\partial F}{\\partial u} = \\frac{v_a K_R}{(1+\\beta p(x))(K_R+u)^2}\n$$\nSubstituting these expressions into the formula for $\\frac{dx^{\\ast}}{du}$ (evaluated at the steady state $x=x^{\\ast}$):\n$$\n\\frac{dx^{\\ast}}{du} = - \\frac{\\frac{v_a K_R}{(1+\\beta p(x^{\\ast}))(K_R+u)^2}}{-v_{a} s(u) \\frac{\\beta p'(x^{\\ast})}{(1+\\beta p(x^{\\ast}))^2} - v_{d0} \\left[ \\alpha p'(x^{\\ast}) \\frac{x^{\\ast}}{K_M+x^{\\ast}} + (1+\\alpha p(x^{\\ast})) \\frac{K_M}{(K_M+x^{\\ast})^2} \\right]}\n$$\nWe seek the limit of this expression as $u \\to \\infty$. Let us analyze the behavior of its components in this limit.\nAs $u \\to \\infty$, the saturation function $s(u) = \\frac{u}{K_R+u} \\to 1$.\nThe steady-state concentration $x^{\\ast}$ will approach a finite limit, $x_{\\infty}^{\\ast}$, which is the unique positive solution to the steady-state equation with $s(u)=1$:\n$$\nv_{a}\\,\\frac{1}{1+\\beta\\,p(x_{\\infty}^{\\ast})} = v_{d0}\\,\\bigl(1+\\alpha\\,p(x_{\\infty}^{\\ast})\\bigr)\\,\\frac{x_{\\infty}^{\\ast}}{K_{M}+x_{\\infty}^{\\ast}}\n$$\nNow, let's evaluate the limit of the numerator and denominator of the expression for $\\frac{dx^{\\ast}}{du}$.\n\nLimit of the numerator term (from $\\frac{\\partial F}{\\partial u}$):\n$$\n\\lim_{u \\to \\infty} \\frac{v_a K_R}{(1+\\beta p(x^{\\ast}))(K_R+u)^2} = \\frac{v_a K_R}{(1+\\beta p(x_{\\infty}^{\\ast})) \\cdot \\lim_{u \\to \\infty}(K_R+u)^2} = 0\n$$\nsince the denominator tends to infinity while the other factors approach finite constants.\n\nLimit of the denominator term (the negative of $\\frac{\\partial F}{\\partial x}$):\n$$\n\\lim_{u \\to \\infty} \\left( v_{a} s(u) \\frac{\\beta p'(x^{\\ast})}{(1+\\beta p(x^{\\ast}))^2} + v_{d0} \\left[ \\alpha p'(x^{\\ast}) \\frac{x^{\\ast}}{K_M+x^{\\ast}} + (1+\\alpha p(x^{\\ast})) \\frac{K_M}{(K_M+x^{\\ast})^2} \\right] \\right)\n$$\nAs $u \\to \\infty$, $x^{\\ast} \\to x_{\\infty}^{\\ast}$ and $s(u) \\to 1$. The denominator approaches a finite, positive constant $C$:\n$$\nC = v_{a} \\frac{\\beta p'(x_{\\infty}^{\\ast})}{(1+\\beta p(x_{\\infty}^{\\ast}))^2} + v_{d0} \\left[ \\alpha p'(x_{\\infty}^{\\ast}) \\frac{x_{\\infty}^{\\ast}}{K_M+x_{\\infty}^{\\ast}} + (1+\\alpha p(x_{\\infty}^{\\ast})) \\frac{K_M}{(K_M+x_{\\infty}^{\\ast})^2} \\right] > 0\n$$\nThe value is strictly positive because we have shown $\\frac{\\partial F}{\\partial x} < 0$ for a stable steady state when $x > 0$.\n\nTherefore, the limit of the sensitivity is:\n$$\n\\lim_{u \\to \\infty} \\frac{dx^{\\ast}}{du} = \\frac{0}{C} = 0\n$$\nThis result is biologically intuitive: as the agonist concentration becomes very large, the receptors become fully saturated ($s(u) \\to 1$). Further increases in agonist concentration have a diminishing effect on receptor activation, and thus a vanishingly small effect on the downstream cAMP concentration. The system's sensitivity to the input approaches zero.", "answer": "$$\\boxed{0}$$", "id": "2761693"}, {"introduction": "Our mathematical models often treat concentrations as continuous variables, governed by deterministic ordinary differential equations. While powerful, this view breaks down in the minuscule volumes of compartments like dendritic spines, where low molecule numbers make signaling inherently random, or stochastic. This computational practice challenges you to step from the deterministic world into the stochastic one by implementing the celebrated Gillespie algorithm [@problem_id:2761842]. By simulating the birth and death of individual cAMP molecules, you will directly compare the noisy reality of a single stochastic trajectory to the smooth, average behavior predicted by the deterministic model, gaining a tangible understanding of intrinsic noise in cellular signaling.", "problem": "You are to implement a quantitative comparison between stochastic and deterministic predictions for cyclic adenosine monophosphate (cAMP) pulses in dendritic spines by modeling adenylyl cyclase and phosphodiesterase dynamics. The stochastic model must be simulated using the Gillespie direct algorithm, and the deterministic prediction must be computed from the mass-action ordinary differential equation for a birth–death process. The biological system is summarized as follows: active adenylyl cyclase ($\\mathrm{AC}^\\ast$) catalyzes cAMP synthesis during a fixed stimulus window, and phosphodiesterase ($\\mathrm{PDE}$) degrades cAMP continuously. Adenosine triphosphate (ATP) is abundant, so its concentration can be treated as constant, making cAMP synthesis effectively first-order in $\\mathrm{AC}^\\ast$ only. Although protein kinase A (PKA) is not explicitly simulated here, the cAMP pulse comparison is a meaningful proxy for downstream PKA activation.\n\nFundamental base and core definitions:\n- Chemical Master Equation (CME) with mass-action propensities for a well-mixed volume: reaction hazards are proportional to reactant counts with proportionality constants derived from kinetic rates. The Gillespie direct algorithm samples reaction times from an exponential distribution with total hazard equal to the sum of propensities and selects the next reaction by categorical sampling proportional to individual propensities.\n- Deterministic limit of the CME under the law of large numbers gives an ordinary differential equation (ODE) for the concentration $C(t)$ of cAMP.\n- Avogadro constant $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n- Concentration–count conversion in a volume $V$ (in liters): if $N$ is the molecule count of cAMP, then the concentration in micromolar is $C_{\\mu\\mathrm{M}} = \\dfrac{N}{N_A V} \\times 10^6$.\n\nModel specification:\n- Species: cAMP molecule count $N_{\\mathrm{cAMP}}(t)$.\n- Parameters: active cyclase count $N_{\\mathrm{AC}^\\ast}$ (dimensionless, molecules), catalytic rate $k_{\\mathrm{cat}}$ (in $\\mathrm{s^{-1}}$ per $\\mathrm{AC}^\\ast$), degradation rate $k_{\\mathrm{deg}}$ (in $\\mathrm{s^{-1}}$), stimulus duration $T_{\\mathrm{pulse}}$ (in $\\mathrm{s}$), simulation horizon $T_{\\mathrm{end}}$ (in $\\mathrm{s}$), and compartment volume $V$ (in $\\mathrm{L}$).\n- Reactions and propensities:\n  1. Synthesis during the pulse window $t \\in [0, T_{\\mathrm{pulse}})$: \n     $$\\varnothing \\xrightarrow{\\mathrm{AC}^\\ast} \\mathrm{cAMP}, \\quad a_1(t) = k_{\\mathrm{cat}}\\, N_{\\mathrm{AC}^\\ast} \\quad \\text{for } t < T_{\\mathrm{pulse}}, \\quad a_1(t)=0 \\text{ for } t \\ge T_{\\mathrm{pulse}}.$$\n  2. Degradation for all $t$:\n     $$\\mathrm{cAMP} \\xrightarrow{\\mathrm{PDE}} \\varnothing, \\quad a_2(t) = k_{\\mathrm{deg}}\\, N_{\\mathrm{cAMP}}(t).$$\n\nDeterministic prediction:\n- Let $C(t)$ be the cAMP concentration in micromolar. During the pulse ($0 \\le t \\le T_{\\mathrm{pulse}}$), \n  $$\\frac{dC}{dt} = r - k_{\\mathrm{deg}} C, \\quad r = \\frac{k_{\\mathrm{cat}}\\, N_{\\mathrm{AC}^\\ast}}{N_A V} \\times 10^6.$$\n  With initial condition $C(0)=0$, the solution during the pulse is\n  $$C(t) = \\frac{r}{k_{\\mathrm{deg}}}\\left(1 - e^{-k_{\\mathrm{deg}} t}\\right).$$\n  After the pulse ($t \\ge T_{\\mathrm{pulse}}$), synthesis ceases and $C(t)$ decays exponentially. The deterministic peak occurs at $t = T_{\\mathrm{pulse}}$:\n  $$C_{\\mathrm{det,peak}} = \\frac{r}{k_{\\mathrm{deg}}}\\left(1 - e^{-k_{\\mathrm{deg}} T_{\\mathrm{pulse}}}\\right).$$\n\nStochastic prediction:\n- Use the Gillespie direct algorithm with piecewise-constant propensities. Simulate two phases:\n  - Phase $1$: for $t < T_{\\mathrm{pulse}}$, use $a_1 = k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}$ and $a_2 = k_{\\mathrm{deg}} N_{\\mathrm{cAMP}}$ as above. If a sampled inter-reaction time would cross $T_{\\mathrm{pulse}}$, advance time to $T_{\\mathrm{pulse}}$ without applying a reaction, then enter Phase $2$.\n  - Phase $2$: for $t \\in [T_{\\mathrm{pulse}}, T_{\\mathrm{end}}]$, set $a_1=0$ and continue with only degradation events.\n- Track the stochastic peak concentration $C_{\\mathrm{stoch,peak}}$ by monitoring $N_{\\mathrm{cAMP}}$ over time and converting to micromolar using the formula above. Because no synthesis occurs after $T_{\\mathrm{pulse}}$, the peak must occur at or before $T_{\\mathrm{pulse}}$.\n\nTask:\n- For each parameter set below, compute the ratio \n  $$R = \\frac{C_{\\mathrm{stoch,peak}}}{C_{\\mathrm{det,peak}}}.$$\n- Initialization: $N_{\\mathrm{cAMP}}(0) = 0$ and $C(0)=0$.\n- Randomness: use a pseudo-random number generator seeded with $1729$ for reproducibility; for example, you may offset the seed by the test case index $i$ as $1729 + i$ to obtain per-case reproducible streams.\n- Units: time in seconds ($\\mathrm{s}$), volume in liters ($\\mathrm{L}$), rates in per second ($\\mathrm{s^{-1}}$), and concentration in micromolar ($\\mu\\mathrm{M}$).\n- Output: for each test case, output the ratio $R$ as a decimal float rounded to six decimal places.\n\nTest suite (four cases):\n1. Typical small spine:\n   - $N_{\\mathrm{AC}^\\ast} = 50$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-16}\\ \\mathrm{L}$.\n2. Very small spine (stronger intrinsic noise), scaled $\\mathrm{AC}^\\ast$ to maintain similar deterministic drive per volume:\n   - $N_{\\mathrm{AC}^\\ast} = 10$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 2.0\\times 10^{-17}\\ \\mathrm{L}$.\n3. Large spine-like compartment (law-of-large-numbers regime), scaled $\\mathrm{AC}^\\ast$:\n   - $N_{\\mathrm{AC}^\\ast} = 500$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 2\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.5\\ \\mathrm{s}$, $T_{\\mathrm{end}}=3.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-15}\\ \\mathrm{L}$.\n4. Fast degradation, brief pulse (boundary condition with small expected peaks):\n   - $N_{\\mathrm{AC}^\\ast} = 50$, $k_{\\mathrm{cat}} = 20\\ \\mathrm{s^{-1}}$, $k_{\\mathrm{deg}} = 10\\ \\mathrm{s^{-1}}$, $T_{\\mathrm{pulse}}=0.1\\ \\mathrm{s}$, $T_{\\mathrm{end}}=1.0\\ \\mathrm{s}$, $V = 1.0\\times 10^{-16}\\ \\mathrm{L}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"), where each $r_i$ is the ratio $R$ for test case $i$, rounded to six decimal places. No additional text should be printed.", "solution": "The problem requires a quantitative comparison between the deterministic and stochastic predictions for the peak concentration of cyclic adenosine monophosphate (cAMP) in a cellular microcompartment. This will be accomplished by, first, calculating the peak concentration from the analytical solution to the mass-action ordinary differential equation (ODE) and, second, simulating a single trajectory using the Gillespie stochastic simulation algorithm (SSA) to find the stochastic peak. The ratio of these two peak values serves as a metric for the magnitude of stochastic fluctuations, or intrinsic noise, in the system.\n\nThe validation of the problem statement confirms that it is scientifically sound, well-posed, and objective. It provides a complete and consistent set of definitions, parameters, and physical constants necessary for a rigorous solution. The model is a canonical birth-death process, a fundamental construct in stochastic chemical kinetics, applied to a biologically relevant signaling pathway. We may therefore proceed to the solution.\n\nThe analysis is divided into two primary parts: the deterministic model and the stochastic model.\n\n**Deterministic Model**\n\nUnder the law of large numbers, for a system with a large number of molecules, the stochastic chemical master equation converges to a set of deterministic rate equations. For this system, the concentration of cAMP, denoted by $C(t)$ in units of micromolar ($\\mu\\mathrm{M}$), is governed by a linear first-order ordinary differential equation.\n\nDuring the stimulus window, $t \\in [0, T_{\\mathrm{pulse}}]$, cAMP is synthesized at a constant rate and degraded at a rate proportional to its current concentration. The governing equation is:\n$$\n\\frac{dC}{dt} = r - k_{\\mathrm{deg}} C(t)\n$$\nHere, $k_{\\mathrm{deg}}$ is the first-order degradation rate constant (in $\\mathrm{s^{-1}}$). The term $r$ represents the constant synthesis rate, expressed in $\\mu\\mathrm{M} \\cdot \\mathrm{s^{-1}}$. It is derived from the microscopic parameters: the number of active adenylyl cyclase molecules, $N_{\\mathrm{AC}^\\ast}$; the catalytic rate per enzyme, $k_{\\mathrm{cat}}$ (in $\\mathrm{s^{-1}}$); the compartment volume, $V$ (in $\\mathrm{L}$); and the Avogadro constant, $N_A$. The conversion from molecule production rate to concentration change rate yields:\n$$\nr = \\frac{k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}}{N_A V} \\times 10^6\n$$\nThe factor of $10^6$ converts the concentration from $\\mathrm{mol \\cdot L^{-1}}$ to $\\mu\\mathrm{mol \\cdot L^{-1}}$ ($\\mu\\mathrm{M}$).\n\nWith the initial condition $C(0) = 0$, the solution to this ODE is:\n$$\nC(t) = \\frac{r}{k_{\\mathrm{deg}}} \\left(1 - e^{-k_{\\mathrm{deg}} t}\\right)\n$$\nSince the synthesis rate $r$ is positive and constant for $t \\in [0, T_{\\mathrm{pulse}}]$, the concentration $C(t)$ is a monotonically increasing function throughout this interval. Consequently, the deterministic peak concentration, $C_{\\mathrm{det,peak}}$, is achieved precisely at the end of the stimulus pulse, at $t = T_{\\mathrm{pulse}}$.\n$$\nC_{\\mathrm{det,peak}} = C(T_{\\mathrm{pulse}}) = \\frac{r}{k_{\\mathrm{deg}}} \\left(1 - e^{-k_{\\mathrm{deg}} T_{\\mathrm{pulse}}}\\right)\n$$\nFor $t > T_{\\mathrm{pulse}}$, the synthesis term $r$ becomes zero, and the concentration decays exponentially from its value at $T_{\\mathrm{pulse}}$.\n\n**Stochastic Model**\n\nIn the stochastic framework, we model the discrete number of cAMP molecules, $N_{\\mathrm{cAMP}}(t)$. The system evolves through a sequence of chemical reactions, each occurring at a random time. This is a classic birth-death process.\n\nThe reactions and their corresponding mass-action propensities, $a_j$, are:\n1.  **Synthesis (Birth)**: $\\varnothing \\xrightarrow{\\mathrm{AC}^\\ast} \\mathrm{cAMP}$. This represents the creation of a cAMP molecule. The propensity is time-dependent:\n    $$\n    a_1(t) = \\begin{cases} k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast} & \\text{if } t < T_{\\mathrm{pulse}} \\\\ 0 & \\text{if } t \\ge T_{\\mathrm{pulse}} \\end{cases}\n    $$\n    This is a zero-order reaction with respect to cAMP, as its rate does not depend on $N_{\\mathrm{cAMP}}$.\n\n2.  **Degradation (Death)**: $\\mathrm{cAMP} \\xrightarrow{\\mathrm{PDE}} \\varnothing$. This represents the degradation of a cAMP molecule. The propensity is:\n    $$\n    a_2(t) = k_{\\mathrm{deg}} N_{\\mathrm{cAMP}}(t)\n    $$\n    This is a first-order reaction, with the rate proportional to the number of reactant molecules.\n\nThe simulation of this stochastic process will be performed using the Gillespie direct algorithm. At any given time $t$ with state $N_{\\mathrm{cAMP}}(t)$, the algorithm proceeds as follows:\n1.  Calculate the propensities for all possible reactions, $a_1$ and $a_2$.\n2.  Calculate the total propensity, $a_0 = a_1 + a_2$.\n3.  Sample the time until the next reaction, $\\tau$, from an exponential distribution with rate $a_0$:\n    $$\n    \\tau = -\\frac{\\ln(u_1)}{a_0}\n    $$\n    where $u_1$ is a random number drawn from a uniform distribution on $(0, 1)$.\n4.  Determine which reaction occurs. Reaction $j$ is chosen with probability $a_j / a_0$. This is done by drawing a second uniform random number, $u_2$, and finding the smallest integer $j$ such that $\\sum_{i=1}^{j} a_i \\ge u_2 a_0$. For our two-reaction system, if $u_2 a_0 \\le a_1$, reaction $1$ occurs; otherwise, reaction $2$ occurs.\n5.  Update the system state according to the chosen reaction ($N_{\\mathrm{cAMP}} \\rightarrow N_{\\mathrm{cAMP}}+1$ for synthesis, $N_{\\mathrm{cAMP}} \\rightarrow N_{\\mathrm{cAMP}}-1$ for degradation) and advance the time to $t + \\tau$.\n\nA specific modification is required to handle the time-dependent synthesis rate. The simulation proceeds with $a_1 = k_{\\mathrm{cat}} N_{\\mathrm{AC}^\\ast}$ until the sampled time step $\\tau$ would advance the clock past $T_{\\mathrm{pulse}}$. That is, if $t + \\tau \\ge T_{\\mathrm{pulse}}$, the algorithm instead advances time directly to $t=T_{\\mathrm{pulse}}$ without executing a reaction, and then continues the simulation with $a_1$ permanently set to $0$.\n\nThe stochastic peak, $C_{\\mathrm{stoch,peak}}$, is determined by tracking the maximum number of cAMP molecules, $N_{\\mathrm{peak}}$, observed during the simulation. Since creation events cease at $t=T_{\\mathrm{pulse}}$, the number of molecules can only decrease thereafter. Thus, the peak number of molecules must occur at or before $t=T_{\\mathrm{pulse}}$. It is sufficient to simulate the system up to $T_{\\mathrm{pulse}}$, recording the maximum value of $N_{\\mathrm{cAMP}}$ encountered. This maximum count, $N_{\\mathrm{peak}}$, is then converted to a concentration:\n$$\nC_{\\mathrm{stoch,peak}} = \\frac{N_{\\mathrm{peak}}}{N_A V} \\times 10^6\n$$\n\n**Calculation of the Ratio**\n\nFor each parameter set provided in the test suite, we will first compute $C_{\\mathrm{det,peak}}$ using its analytical formula. Then, we will execute a single Gillespie simulation, seeded for reproducibility, to find $C_{\\mathrm{stoch,peak}}$. The final result is the ratio:\n$$\nR = \\frac{C_{\\mathrm{stoch,peak}}}{C_{\\mathrm{det,peak}}}\n$$\nThis ratio quantifies the deviation of the stochastic peak from the deterministic average. A ratio greater than $1$ indicates that this particular stochastic trajectory peaked higher than the mean-field prediction, and vice versa. The magnitude of $|R-1|$ is expected to be larger for systems with smaller volumes and fewer molecules, where intrinsic noise has a more pronounced effect.", "answer": "[1.042211,1.157815,1.006456,1.066467]", "id": "2761842"}]}