{"hands_on_practices": [{"introduction": "Understanding how intracellular buffers shape calcium signals begins with the fundamentals of binding chemistry. This exercise challenges you to derive the relationship between free calcium concentration and the fraction of a bound buffer from first principles—the law of mass action and mass conservation. Mastering this calculation is key to appreciating how endogenous buffers and exogenous indicators report on, and simultaneously alter, the calcium signals they are meant to measure [@problem_id:2746473].", "problem": "A neuron’s cytosol contains a mobile calcium-binding buffer with a single binding site that binds calcium ion $\\mathrm{Ca^{2+}}$ according to a one-to-one reversible reaction at thermodynamic equilibrium. Let the free buffer concentration be $[B]$, the calcium-bound buffer concentration be $[BC]$, the total buffer concentration be $B_T$, and the free calcium concentration be $[\\mathrm{Ca}^{2+}]_f$. The binding equilibrium is characterized by the dissociation constant $K_d$ defined by the law of mass action. Assume no cooperativity, a single class of sites, and that $[\\mathrm{Ca}^{2+}]_f$ is controlled externally (for example, by clamped calcium microdomain conditions), so that buffer binding does not alter $[\\mathrm{Ca}^{2+}]_f$.\n\nStarting only from the definition of the dissociation constant by the law of mass action and conservation of mass for the buffer, derive an expression for the bound fraction $f_B \\equiv [BC]/B_T$ as a function of $[\\mathrm{Ca}^{2+}]_f$ and $K_d$. Then evaluate this fraction for $B_T = 50\\,\\mu\\mathrm{M}$, $K_d = 200\\,\\mathrm{nM}$ at two free calcium levels: $[\\mathrm{Ca}^{2+}]_f = 100\\,\\mathrm{nM}$ and $[\\mathrm{Ca}^{2+}]_f = 1\\,\\mu\\mathrm{M}$. \n\nReport your two numerical results for $f_B$ as a two-entry row vector in the order $\\big(100\\,\\mathrm{nM},\\,1\\,\\mu\\mathrm{M}\\big)$. Express your final answer as a dimensionless fraction and round to four significant figures.", "solution": "The problem as stated constitutes a valid and well-posed exercise in fundamental biophysical chemistry. It is scientifically grounded, internally consistent, and requires the application of first principles. We will proceed with the derivation and subsequent calculation.\n\nThe problem describes a reversible binding reaction between a buffer, $B$, and a calcium ion, $\\mathrm{Ca^{2+}}$, to form a complex, $BC$. The reaction is represented as:\n$$\nB + \\mathrm{Ca^{2+}} \\rightleftharpoons BC\n$$\nThis reaction is governed by two fundamental principles: the law of mass action at equilibrium and the conservation of mass for the buffer species.\n\n$1$. The Law of Mass Action:\nThe equilibrium state is characterized by the dissociation constant, $K_d$, which is defined as:\n$$\nK_d = \\frac{[B] [\\mathrm{Ca}^{2+}]_f}{[BC]}\n$$\nHere, $[B]$ is the concentration of the free buffer, $[\\mathrm{Ca}^{2+}]_f$ is the concentration of free calcium ions, and $[BC]$ is the concentration of the calcium-bound buffer.\n\n$2$. Conservation of Mass:\nThe total concentration of the buffer, $B_T$, is the sum of the concentrations of its free and bound forms:\n$$\nB_T = [B] + [BC]\n$$\n\nThe objective is to derive an expression for the bound fraction, $f_B$, defined as the ratio of the bound buffer concentration to the total buffer concentration:\n$$\nf_B \\equiv \\frac{[BC]}{B_T}\n$$\nThis expression must be in terms of $[\\mathrm{Ca}^{2+}]_f$ and $K_d$.\n\nWe begin by rearranging the mass conservation equation to express the free buffer concentration, $[B]$, in terms of $B_T$ and $[BC]$:\n$$\n[B] = B_T - [BC]\n$$\nNext, we substitute this expression for $[B]$ into the equation for the dissociation constant $K_d$:\n$$\nK_d = \\frac{(B_T - [BC]) [\\mathrm{Ca}^{2+}]_f}{[BC]}\n$$\nThis equation establishes a relationship between the concentrations, the free calcium level, and the dissociation constant. Our goal is to solve for the ratio $\\frac{[BC]}{B_T}$. To do this, we perform algebraic manipulation. First, multiply both sides by $[BC]$:\n$$\nK_d [BC] = (B_T - [BC]) [\\mathrm{Ca}^{2+}]_f\n$$\nDistribute the term $[\\mathrm{Ca}^{2+}]_f$ on the right-hand side:\n$$\nK_d [BC] = B_T [\\mathrm{Ca}^{2+}]_f - [BC] [\\mathrm{Ca}^{2+}]_f\n$$\nTo solve for $[BC]$, we gather all terms containing $[BC]$ on one side of the equation:\n$$\nK_d [BC] + [BC] [\\mathrm{Ca}^{2+}]_f = B_T [\\mathrm{Ca}^{2+}]_f\n$$\nFactor out $[BC]$ from the left-hand side:\n$$\n[BC] (K_d + [\\mathrm{Ca}^{2+}]_f) = B_T [\\mathrm{Ca}^{2+}]_f\n$$\nFinally, to obtain the desired bound fraction $f_B = \\frac{[BC]}{B_T}$, we divide both sides by $B_T$ and by the term $(K_d + [\\mathrm{Ca}^{2+}]_f)$:\n$$\nf_B = \\frac{[BC]}{B_T} = \\frac{[\\mathrm{Ca}^{2+}]_f}{K_d + [\\mathrm{Ca}^{2+}]_f}\n$$\nThis is the required expression for the bound fraction. It is a specific instance of the Hill-Langmuir equation for a system with a single class of non-cooperative binding sites. It is important to note that the total buffer concentration, $B_T$, does not appear in the final formula for the fraction $f_B$. Thus, the given value $B_T = 50\\,\\mu\\mathrm{M}$ is irrelevant for this calculation.\n\nNow, we evaluate this expression for the given numerical values. The dissociation constant is $K_d = 200\\,\\mathrm{nM}$. We must evaluate $f_B$ at two different free calcium concentrations.\n\nCase 1: $[\\mathrm{Ca}^{2+}]_f = 100\\,\\mathrm{nM}$\nSubstituting the values into the derived expression:\n$$\nf_B = \\frac{100\\,\\mathrm{nM}}{200\\,\\mathrm{nM} + 100\\,\\mathrm{nM}} = \\frac{100}{300} = \\frac{1}{3}\n$$\nExpressed as a decimal rounded to four significant figures, this is $0.3333$.\n\nCase 2: $[\\mathrm{Ca}^{2+}]_f = 1\\,\\mu\\mathrm{M}$\nFirst, we must ensure consistent units. We convert $1\\,\\mu\\mathrm{M}$ to nanomolars: $1\\,\\mu\\mathrm{M} = 1000\\,\\mathrm{nM}$.\nSubstituting the values:\n$$\nf_B = \\frac{1000\\,\\mathrm{nM}}{200\\,\\mathrm{nM} + 1000\\,\\mathrm{nM}} = \\frac{1000}{1200} = \\frac{10}{12} = \\frac{5}{6}\n$$\nExpressed as a decimal rounded to four significant figures, this is $0.8333$.\n\nThe final answer should be reported as a two-entry row vector containing these two results in the specified order.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3333 & 0.8333 \\end{pmatrix}}\n$$", "id": "2746473"}, {"introduction": "Beyond simple buffering, the regulation of intracellular $Ca^{2+}$ relies on the dynamic interplay of pumps and leaks across organellar membranes, which establish a non-equilibrium steady state. This practice models the balance of fluxes across the endoplasmic reticulum (ER) membrane, pitting the active transport by SERCA pumps against passive leak. By calculating the steady-state luminal $Ca^{2+}$ concentration, you will gain a quantitative understanding of how cells maintain the high-calcium ER store that is critical for versatile signaling [@problem_id:2746401].", "problem": "A single-compartment neuronal endoplasmic reticulum (ER) is separated from the cytosol by a membrane across which calcium ions are transported. Assume the cytosolic free calcium concentration is clamped at a constant value by powerful extrusion and buffering mechanisms. Let the cytosolic free calcium concentration be $[\\mathrm{Ca}^{2+}]_{\\mathrm{cyt}} = 0.2~\\mu\\mathrm{M}$. The Sarco/Endoplasmic Reticulum Calcium Adenosine Triphosphatase (SERCA) pumps calcium from cytosol into the ER lumen with uptake flux density $J_{\\mathrm{SERCA}}$ that depends on cytosolic calcium via cooperative binding, and the passive leak flux density $J_{\\mathrm{leak}}$ carries calcium from the ER lumen back to the cytosol, driven by the concentration difference. Use the following biophysically standard constitutive relations for the flux densities per unit membrane area:\n- SERCA uptake: $J_{\\mathrm{SERCA}} = V_{\\max} \\dfrac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}$,\n- Passive leak: $J_{\\mathrm{leak}} = P_{\\mathrm{leak}} \\left( [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} \\right)$,\n\nwhere $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$ is the free calcium concentration in the ER lumen. All concentrations entering the flux formulas must be expressed in $\\mathrm{mol}~\\mathrm{m}^{-3}$. The parameters are:\n- Maximum SERCA uptake $V_{\\max} = 1.6 \\times 10^{-8}~\\mathrm{mol}~\\mathrm{m}^{-2}~\\mathrm{s}^{-1}$,\n- Half-activation constant $K = 0.3~\\mu\\mathrm{M}$,\n- Hill coefficient $n = 2$,\n- Passive permeability $P_{\\mathrm{leak}} = 1.0 \\times 10^{-8}~\\mathrm{m}~\\mathrm{s}^{-1}$.\n\nAssume steady state with no net accumulation of calcium in the ER (i.e., the membrane fluxes balance). Starting from mass conservation at the membrane and the definitions above, derive and compute the steady-state $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$. Express your final numerical answer in $\\mu\\mathrm{M}$ and round your answer to four significant figures.", "solution": "The problem as stated is a well-posed exercise in biophysical modeling and is scientifically sound. All necessary parameters and conditions are provided for a unique solution. We shall proceed with the derivation.\n\nThe fundamental principle is the conservation of mass. At steady state, the net flux of calcium ions across the endoplasmic reticulum (ER) membrane is zero. This means the influx into the ER must exactly balance the efflux from the ER. The influx is mediated by the SERCA pump, with flux density $J_{\\mathrm{SERCA}}$, and the efflux is a passive leak, with flux density $J_{\\mathrm{leak}}$. The steady-state condition is therefore:\n$$\nJ_{\\mathrm{SERCA}} = J_{\\mathrm{leak}}\n$$\nThe problem provides the constitutive relations for these fluxes:\n$$\nJ_{\\mathrm{SERCA}} = V_{\\max} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}\n$$\n$$\nJ_{\\mathrm{leak}} = P_{\\mathrm{leak}} \\left( [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} \\right)\n$$\nHere, $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}$ is the cytosolic free calcium concentration, $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$ is the free calcium concentration in the ER lumen, $V_{\\max}$ is the maximum SERCA pump rate, $K$ is the half-activation constant for SERCA, $n$ is the Hill coefficient, and $P_{\\mathrm{leak}}$ is the leak permeability of the membrane.\n\nBy substituting these expressions into the steady-state balance equation, we obtain:\n$$\nV_{\\max} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}} = P_{\\mathrm{leak}} \\left( [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} \\right)\n$$\nOur objective is to determine the steady-state value of $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$. We rearrange the equation to solve for this variable. First, divide by $P_{\\mathrm{leak}}$:\n$$\n\\frac{V_{\\max}}{P_{\\mathrm{leak}}} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}} = [ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} - [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}\n$$\nNext, we isolate $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$ by adding $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}$ to both sides:\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} = [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} + \\frac{V_{\\max}}{P_{\\mathrm{leak}}} \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}\n$$\nThis is the symbolic solution for the steady-state ER calcium concentration.\n\nWe must now perform the numerical calculation. A critical point is the handling of units. The problem specifies that concentrations must be in SI units of $\\mathrm{mol}~\\mathrm{m}^{-3}$ within the flux equations. The given concentration values are in micromolar ($\\mu\\mathrm{M}$). The conversion is $1~\\mu\\mathrm{M} = 10^{-6}~\\mathrm{mol}~\\mathrm{L}^{-1} = 10^{-6}~\\mathrm{mol}~(10^{-3}~\\mathrm{m}^3)^{-1} = 10^{-3}~\\mathrm{mol}~\\mathrm{m}^{-3}$.\n\nThe given parameters are:\n- $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}} = 0.2~\\mu\\mathrm{M} = 0.2 \\times 10^{-3}~\\mathrm{mol}~\\mathrm{m}^{-3}$\n- $K = 0.3~\\mu\\mathrm{M} = 0.3 \\times 10^{-3}~\\mathrm{mol}~\\mathrm{m}^{-3}$\n- $n = 2$\n- $V_{\\max} = 1.6 \\times 10^{-8}~\\mathrm{mol}~\\mathrm{m}^{-2}~\\mathrm{s}^{-1}$\n- $P_{\\mathrm{leak}} = 1.0 \\times 10^{-8}~\\mathrm{m}~\\mathrm{s}^{-1}$\n\nLet us first evaluate the dimensionless Hill term, $\\mathcal{H} = \\frac{[ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}{K^{n} + [ \\mathrm{Ca}^{2+} ]_{\\mathrm{cyt}}^{n}}$. Since this is a ratio of terms with the same units, we can use the values in $\\mu\\mathrm{M}$ directly:\n$$\n\\mathcal{H} = \\frac{(0.2)^{2}}{(0.3)^{2} + (0.2)^{2}} = \\frac{0.04}{0.09 + 0.04} = \\frac{0.04}{0.13} = \\frac{4}{13}\n$$\nNext, we evaluate the term $\\frac{V_{\\max}}{P_{\\mathrm{leak}}}$:\n$$\n\\frac{V_{\\max}}{P_{\\mathrm{leak}}} = \\frac{1.6 \\times 10^{-8}~\\mathrm{mol}~\\mathrm{m}^{-2}~\\mathrm{s}^{-1}}{1.0 \\times 10^{-8}~\\mathrm{m}~\\mathrm{s}^{-1}} = 1.6~\\mathrm{mol}~\\mathrm{m}^{-3}\n$$\nThe units of this term are correctly that of a concentration, confirming the dimensional consistency of our derived symbolic expression.\n\nNow we substitute these values into the equation for $[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}}$, ensuring all terms are in SI units ($\\mathrm{mol}~\\mathrm{m}^{-3}$):\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} = (0.2 \\times 10^{-3}) + (1.6) \\times \\left(\\frac{4}{13}\\right)\n$$\nAll terms are in $\\mathrm{mol}~\\mathrm{m}^{-3}$.\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} = 0.0002 + \\frac{6.4}{13} \\approx 0.0002 + 0.49230769\n$$\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} \\approx 0.49250769~\\mathrm{mol}~\\mathrm{m}^{-3}\n$$\nThe problem requires the final answer in $\\mu\\mathrm{M}$. We use the conversion factor $1~\\mathrm{mol}~\\mathrm{m}^{-3} = 10^3~\\mu\\mathrm{M}$.\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} \\approx 0.49250769 \\times 10^3~\\mu\\mathrm{M} = 492.50769~\\mu\\mathrm{M}\n$$\nFinally, we round the answer to four significant figures as requested:\n$$\n[ \\mathrm{Ca}^{2+} ]_{\\mathrm{ER}} \\approx 492.5~\\mu\\mathrm{M}\n$$\nThis result is biophysically plausible, as ER luminal calcium concentrations are typically in the range of hundreds of micromolars, whereas resting cytosolic levels are orders of magnitude lower.", "answer": "$$\\boxed{492.5}$$", "id": "2746401"}, {"introduction": "To capture the complexity of neuronal calcium signaling, we often turn to computational models that integrate multiple processes across different cellular compartments. This advanced practice guides you through building and analyzing a two-compartment model of a neuron, accounting for $Ca^{2+}$ influx, extrusion, buffering, and diffusion between the soma and dendrite. By performing a sensitivity analysis, you will develop practical skills in identifying which biophysical parameters most critically control the amplitude and duration of calcium transients, a powerful technique for understanding complex biological systems [@problem_id:2746415].", "problem": "You are asked to write a complete, runnable program that performs a local, one-at-a-time sensitivity analysis on peak amplitude and decay time of cytosolic calcium concentration in a two-compartment neuronal model. The two compartments represent soma and dendrite, with diffusive coupling between them. The aim is to identify, for each provided parameter set, which single parameter most strongly influences each of the two metrics: peak amplitude and decay time in the soma.\n\nFundamental base and model formulation:\n- Start from mass balance in each compartment: rate of change equals sum of sources and sinks. Use Fick's law for inter-compartmental diffusion, and first-order kinetics for extrusion by membrane pumps such as Plasma Membrane Calcium ATPase (PMCA) and Sodium-Calcium Exchanger (NCX). Represent fast buffering by a constant buffering capacity that reduces the effective free calcium change.\n- Let $c_s(t)$ and $c_d(t)$ denote free cytosolic calcium concentration in the soma and dendrite, respectively, in micromolar (denoted $\\mu$M). Let $c_0$ be the resting free calcium level, in $\\mu$M.\n- Let $J_{\\text{in},s}(t)$ and $J_{\\text{in},d}(t)$ be external calcium influxes into soma and dendrite, respectively, modeling a brief opening of Voltage-Gated Calcium Channels (VGCC). Use an $\\alpha$-function time course $g(t)$ with a single parameter $\\tau_{\\text{in}}$ to shape the influx: $$g(t) = \\begin{cases}\\dfrac{t}{\\tau_{\\text{in}}}\\exp\\!\\left(1-\\dfrac{t}{\\tau_{\\text{in}}}\\right), & t \\ge 0 \\\\ 0, & t < 0\\end{cases}$$ which has unitless peak $1$ at $t=\\tau_{\\text{in}}$. Then set $$J_{\\text{in},s}(t) = V_{\\text{in},s}\\, g(t), \\quad J_{\\text{in},d}(t) = V_{\\text{in},d}\\, g(t),$$ where $V_{\\text{in},s}$ and $V_{\\text{in},d}$ are influx amplitudes in $\\mu$M/s.\n- Let $k_{\\text{out},s}$ and $k_{\\text{out},d}$ be first-order extrusion rate constants (in s$^{-1}$), modeling PMCA and NCX as $J_{\\text{out},x} = k_{\\text{out},x}\\,(c_x - c_0)$ for compartment $x\\in\\{s,d\\}$.\n- Let $\\kappa_s$ and $\\kappa_d$ be dimensionless buffering capacities for soma and dendrite, respectively. Fast buffering reduces effective time derivatives by a factor $(1+\\kappa_x)$ in each compartment.\n- Let $D_{sd}$ be the effective diffusive coupling rate (in s$^{-1}$) between compartments, generating fluxes $J_{\\text{diff},s} = D_{sd}\\,(c_d - c_s)$ and $J_{\\text{diff},d} = D_{sd}\\,(c_s - c_d)$.\n- The resulting system is\n$$\\frac{dc_s}{dt} = \\frac{1}{1+\\kappa_s}\\left[J_{\\text{in},s}(t) - k_{\\text{out},s}\\,\\big(c_s-c_0\\big) + D_{sd}\\,\\big(c_d - c_s\\big)\\right],$$\n$$\\frac{dc_d}{dt} = \\frac{1}{1+\\kappa_d}\\left[J_{\\text{in},d}(t) - k_{\\text{out},d}\\,\\big(c_d-c_0\\big) + D_{sd}\\,\\big(c_s - c_d\\big)\\right],$$\nwith initial condition $c_s(0)=c_d(0)=c_0$.\n\nMetrics to compute from the soma trace $c_s(t)$:\n- Peak amplitude above baseline: $$A = \\max_{t\\in[0,T_{\\max}]} c_s(t) - c_0,$$ expressed in $\\mu$M.\n- Decay time to a fraction $1/e$ of the peak: If the peak occurs at time $t_{\\text{peak}}$ with amplitude $A$, then set a threshold $c_{\\text{thr}} = c_0 + A/e$. The decay time is $$\\tau_{\\text{decay}} = t_{\\text{cross}} - t_{\\text{peak}},$$ where $t_{\\text{cross}}$ is the first time $t\\ge t_{\\text{peak}}$ such that $c_s(t) \\le c_{\\text{thr}}$. Express $\\tau_{\\text{decay}}$ in seconds. If the threshold is not reached within the simulation horizon $[0,T_{\\max}]$, treat this as not measurable.\n\nSensitivity definition:\n- For a scalar metric $M$ (either $A$ or $\\tau_{\\text{decay}}$) and a parameter $p$, define the dimensionless local sensitivity coefficient as $$S_M(p) = \\frac{p}{M}\\,\\frac{dM}{dp},$$ approximated numerically by a central finite difference with a small relative perturbation $\\delta>0$:\n$$S_M(p) \\approx \\frac{p}{M(p)}\\cdot \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,p} = \\frac{M\\big(p(1+\\delta)\\big) - M\\big(p(1-\\delta)\\big)}{2\\,\\delta\\,M(p)}.$$\nCompute one-at-a-time sensitivities by perturbing a single parameter and holding the others fixed at baseline.\n\nSimulation protocol and constants:\n- Use $c_0 = 0.1\\,\\mu\\text{M}$ (write this as $c_0 = 0.1$ in the code, since concentrations are in $\\mu$M).\n- Use $\\tau_{\\text{in}} = 0.02\\,\\text{s}$ (write this as `tau_in = 0.02`).\n- Simulate on $[0,T_{\\max}]$ with $T_{\\max} = 4.0\\,\\text{s}$ (write this as $T_{\\max} = 4.0$).\n- Use a relative perturbation $\\delta = 0.05$ (write this as $\\delta = 0.05$).\n- Use initial conditions $c_s(0)=c_d(0)=c_0$.\n\nParameter vector and indexing:\n- The parameter vector is ordered as $$\\mathbf{p} = \\big[V_{\\text{in},s},\\, V_{\\text{in},d},\\, k_{\\text{out},s},\\, k_{\\text{out},d},\\, \\kappa_s,\\, \\kappa_d,\\, D_{sd}\\big].$$\n- Use zero-based indexing: index $0$ for $V_{\\text{in},s}$, $1$ for $V_{\\text{in},d}$, $2$ for $k_{\\text{out},s}$, $3$ for $k_{\\text{out},d}$, $4$ for $\\kappa_s$, $5$ for $\\kappa_d$, $6$ for $D_{sd}$.\n\nTest suite:\nProvide the following four baseline parameter sets (all concentrations in $\\mu$M, times in s):\n- Case $1$: $[6.0,\\,3.0,\\,3.0,\\,3.0,\\,20.0,\\,20.0,\\,1.0]$.\n- Case $2$: $[6.0,\\,6.0,\\,3.5,\\,3.5,\\,60.0,\\,60.0,\\,10.0]$.\n- Case $3$: $[6.0,\\,3.0,\\,3.0,\\,3.0,\\,300.0,\\,50.0,\\,1.0]$.\n- Case $4$: $[6.0,\\,3.0,\\,3.0,\\,0.5,\\,80.0,\\,50.0,\\,2.0]$.\n\nRequired tasks for your program:\n- For each test case, simulate the model, compute the soma peak amplitude $A$ and the decay time $\\tau_{\\text{decay}}$ as defined above.\n- Compute the one-at-a-time, dimensionless local sensitivities $S_A(p_i)$ and $S_{\\tau}(p_i)$ for all seven parameters $p_i$ using the central difference approximation with $\\delta$.\n- Identify, for each metric, the index $i$ of the single parameter with the largest absolute sensitivity magnitude.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list of integers. Concatenate, for each test case in the order given above, two integers: first the index of the parameter with the largest $|S_A|$, then the index of the parameter with the largest $|S_{\\tau}|$. For example, the output should have the form $$[i_{A,1},i_{\\tau,1},i_{A,2},i_{\\tau,2},i_{A,3},i_{\\tau,3},i_{A,4},i_{\\tau,4}],$$ where each $i$ is an integer index in $\\{0,1,2,3,4,5,6\\}$.", "solution": "This problem requires implementing a numerical sensitivity analysis. The overall procedure is as follows: \n1. A function is created to solve the system of two coupled ordinary differential equations (ODEs) for a given parameter vector using a numerical solver like `scipy.integrate.solve_ivp`. \n2. A second function takes the simulation output (the somatic calcium trace $c_s(t)$) and calculates the two required metrics: peak amplitude $A$ and decay time $\\tau_{\\text{decay}}$. \n3. For each of the four test cases, the baseline metrics ($A_{\\text{base}}, \\tau_{\\text{decay},\\text{base}}$) are computed using the unperturbed parameters. \n4. To calculate sensitivities, each of the seven parameters $p_i$ is perturbed one at a time, creating two new parameter sets: one with $p_i(1+\\delta)$ and one with $p_i(1-\\delta)$. \n5. The model is simulated for both perturbed sets, and the metrics ($A^+, \\tau_{\\text{decay}}^+$ and $A^-, \\tau_{\\text{decay}}^-$) are computed. \n6. The dimensionless sensitivity coefficients, $S_A(p_i)$ and $S_{\\tau}(p_i)$, are approximated using the central finite difference formula: $S_M(p_i) \\approx (M^+ - M^-) / (2 \\delta M_{\\text{base}})$. \n7. After computing all sensitivities, the absolute values are compared to find the index of the parameter that has the largest impact on each metric. \n8. This process is repeated for all four test cases, and the resulting eight indices are collected for the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Performs a one-at-a-time sensitivity analysis on a two-compartment neuronal\n    calcium model for four different parameter sets.\n    \"\"\"\n\n    # --- Define constants and test cases ---\n    c0 = 0.1  # Resting [Ca2+], uM\n    tau_in = 0.02  # Influx time constant, s\n    t_max = 4.0  # Simulation time horizon, s\n    delta = 0.05  # Relative perturbation for sensitivity analysis\n\n    test_cases = [\n        [6.0, 3.0, 3.0, 3.0, 20.0, 20.0, 1.0],   # Case 1\n        [6.0, 6.0, 3.5, 3.5, 60.0, 60.0, 10.0],  # Case 2\n        [6.0, 3.0, 3.0, 3.0, 300.0, 50.0, 1.0],  # Case 3\n        [6.0, 3.0, 3.0, 0.5, 80.0, 50.0, 2.0],   # Case 4\n    ]\n\n    # --- Helper function for influx time course ---\n    def influx_g(t):\n        if t < 0:\n            return 0.0\n        # The alpha-function is implemented such that its peak is 1.\n        # This requires the factor exp(1-t/tau_in)\n        return (t / tau_in) * np.exp(1 - t / tau_in)\n\n    # --- ODE system definition ---\n    def model(t, y, params):\n        cs, cd = y\n        v_in_s, v_in_d, k_out_s, k_out_d, kappa_s, kappa_d, d_sd = params\n        \n        g_t = influx_g(t)\n        \n        # dcs/dt\n        dcs_dt = (1 / (1 + kappa_s)) * (\n            v_in_s * g_t - k_out_s * (cs - c0) + d_sd * (cd - cs)\n        )\n        # dcd/dt\n        dcd_dt = (1 / (1 + kappa_d)) * (\n            v_in_d * g_t - k_out_d * (cd - c0) + d_sd * (cs - cd)\n        )\n        \n        return [dcs_dt, dcd_dt]\n\n    # --- Function to run simulation and compute metrics ---\n    def get_metrics(current_params):\n        sol = solve_ivp(\n            model,\n            [0, t_max],\n            [c0, c0],\n            args=(current_params,),\n            dense_output=True,\n            method='RK45',\n            t_eval=np.linspace(0, t_max, 2000) # Ensure sufficient time resolution\n        )\n        t = sol.t\n        cs = sol.y[0]\n\n        # Metric 1: Peak amplitude A\n        if len(cs) == 0:\n            return np.nan, np.nan\n        \n        peak_idx = np.argmax(cs)\n        t_peak = t[peak_idx]\n        c_peak = cs[peak_idx]\n        amplitude = c_peak - c0\n\n        # Metric 2: Decay time tau_decay\n        if amplitude <= 0: # Should not happen with positive influx\n            return amplitude, np.nan\n            \n        threshold = c0 + amplitude / np.e\n        \n        # Find first time t >= t_peak where cs(t) <= threshold\n        decay_indices = np.where((t >= t_peak) & (cs <= threshold))[0]\n        \n        if len(decay_indices) == 0:\n            # Threshold not reached\n            tau_decay = np.nan\n        else:\n            t_cross_idx = decay_indices[0]\n            \n            # Linear interpolation for better accuracy\n            if t_cross_idx > 0:\n                t1, c1 = t[t_cross_idx - 1], cs[t_cross_idx - 1]\n                t2, c2 = t[t_cross_idx], cs[t_cross_idx]\n                if c1 - c2 > 1e-9: # Avoid division by zero\n                    t_cross = t1 + (t2 - t1) * (threshold - c1) / (c2 - c1)\n                else:\n                    t_cross = t2\n            else:\n                 t_cross = t[t_cross_idx]\n            \n            tau_decay = t_cross - t_peak\n\n        return amplitude, tau_decay\n\n    # --- Main analysis loop ---\n    final_results = []\n    \n    for base_params in test_cases:\n        # Calculate baseline metrics\n        A_base, tau_base = get_metrics(base_params)\n\n        sens_A = []\n        sens_tau = []\n\n        for i in range(len(base_params)):\n            # Perturb parameter p_i\n            p_val = base_params[i]\n            \n            # Positive perturbation\n            params_plus = list(base_params)\n            params_plus[i] = p_val * (1 + delta)\n            A_plus, tau_plus = get_metrics(params_plus)\n\n            # Negative perturbation\n            params_minus = list(base_params)\n            params_minus[i] = p_val * (1 - delta)\n            A_minus, tau_minus = get_metrics(params_minus)\n            \n            # Calculate sensitivity for Amplitude\n            if A_base > 1e-9 and not np.isnan(A_plus) and not np.isnan(A_minus):\n                s_A = (A_plus - A_minus) / (2 * delta * A_base)\n            else:\n                s_A = 0.0\n            sens_A.append(s_A)\n\n            # Calculate sensitivity for Decay Time\n            if tau_base > 1e-9 and not np.isnan(tau_plus) and not np.isnan(tau_minus):\n                s_tau = (tau_plus - tau_minus) / (2 * delta * tau_base)\n            else:\n                s_tau = 0.0 # If baseline or perturbed is invalid, sensitivity is zero\n            sens_tau.append(s_tau)\n\n        # Find index of parameter with max absolute sensitivity\n        # Use np.nanargmax to handle potential NaNs safely, though logic above avoids them\n        idx_max_sens_A = np.argmax(np.abs(sens_A))\n        idx_max_sens_tau = np.argmax(np.abs(sens_tau))\n        \n        final_results.extend([idx_max_sens_A, idx_max_sens_tau])\n\n    # --- Format and print final output ---\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\nsolve()\n```", "id": "2746415"}]}