{"hands_on_practices": [{"introduction": "Understanding the dynamics of sex determination begins with mastering the inheritance patterns of the chromosomes that define sex. In the common XX/XY system, males inherit their single X chromosome exclusively from their mothers, while females inherit one from each parent. This exercise [@problem_id:2849906] challenges you to formalize this fundamental process by deriving the expected genotype frequencies in an offspring generation, providing a crucial mathematical foundation for analyzing any X-linked trait.", "problem": "In a species with an XX/XY sex determination system, consider a single X-linked locus with two alleles, denoted by $A$ and $a$. Let $p_{f}$ be the frequency of allele $A$ among $X$ chromosomes in adult females and $p_{m}$ be the frequency of allele $A$ among $X$ chromosomes in adult males in the parental generation. Assume the following conditions, which are the standard assumptions of the Hardy–Weinberg model for random mating: (i) random mating between males and females, (ii) meiosis with equal segregation of alleles, (iii) males produce $X$-bearing and $Y$-bearing gametes with equal probability, (iv) no mutation, no migration, and no selection, and (v) all matings are equally likely and contribute equally to the zygote pool.\n\nUsing only these assumptions and the definition of an XX/XY system (females are $XX$ and males are $XY$), derive the expected genotype frequencies among zygotes after one generation of random mating, expressed separately for female offspring (genotypes $AA$, $Aa$, and $aa$) and male offspring (hemizygous genotypes $A$ and $a$). Express your final answer in terms of $p_{f}$ and $p_{m}$ only, and present the five frequencies in the following order as a single row vector: female $AA$, female $Aa$, female $aa$, male $A$, male $a$. No numerical approximation is required; provide an exact algebraic expression. Do not include any units in your answer.", "solution": "The problem statement is subjected to validation.\n\nGivens:\n1.  Sex determination system: $XX$ (female) / $XY$ (male).\n2.  Locus: Single, X-linked, with two alleles, $A$ and $a$.\n3.  Allele frequencies in parental generation:\n    - $p_{f}$: frequency of allele $A$ among $X$ chromosomes in adult females.\n    - $p_{m}$: frequency of allele $A$ among $X$ chromosomes in adult males.\n4.  Assumptions (Hardy–Weinberg model):\n    - (i) Random mating.\n    - (ii) Equal segregation of alleles.\n    - (iii) Males produce $X$-bearing and $Y$-bearing gametes with equal probability.\n    - (iv) No mutation, migration, or selection.\n    - (v) All matings are equally likely and contribute equally to the zygote pool.\n\nValidation Verdict:\nThe problem is valid. It is a standard, well-posed problem in population genetics that is scientifically grounded and objectively formulated. It requires the application of fundamental principles of Mendelian inheritance to a sex-linked locus. The provided information is complete and consistent, allowing for a unique derivation of the requested genotype frequencies. We shall proceed with the derivation.\n\nThe core principle is that offspring genotypes are determined by the random union of gametes from the parental generation. We must first determine the frequencies of alleles in the gametes produced by the male and female populations.\n\nStep 1: Determine Gamete Frequencies\nFemales are of genotype $XX$. The frequency of allele $A$ on their $X$ chromosomes is given as $p_{f}$, and the frequency of allele $a$ is therefore $1 - p_{f}$. Due to the principle of segregation (ii), the eggs (female gametes) produced will carry allele $A$ with frequency $p_{f}$ and allele $a$ with frequency $1 - p_{f}$.\n- Frequency of $A$ in eggs: $p_{f}$\n- Frequency of $a$ in eggs: $1 - p_{f}$\n\nMales are of genotype $XY$. Their single $X$ chromosome carries either allele $A$ or $a$. The frequency of allele $A$ among males is given as $p_{m}$, so the frequency of males with genotype $A$ (more precisely, $X^{A}Y$) is $p_{m}$. The frequency of males with genotype $a$ (i.e., $X^{a}Y$) is $1 - p_{m}$. Males produce two types of gametes in equal numbers (iii): $X$-bearing sperm and $Y$-bearing sperm. The allele carried by an $X$-bearing sperm is the one from the male's own $X$ chromosome.\n- Frequency of $X$-bearing sperm carrying $A$: $p_{m}$\n- Frequency of $X$-bearing sperm carrying $a$: $1 - p_{m}$\n- $Y$-bearing sperm do not carry this locus.\n\nStep 2: Calculate Genotype Frequencies in Offspring\nThe genotype frequencies in the next generation are found by considering the random union of eggs and sperm, as dictated by the assumption of random mating (i). We must consider female and male offspring separately.\n\nFemale Offspring ($XX$):\nA female offspring inherits one $X$ chromosome from her mother (egg) and one $X$ chromosome from her father (sperm). The frequencies of the three possible female genotypes ($AA$, $Aa$, $aa$) are calculated as follows:\n- The probability of a female zygote having genotype $AA$ is the product of the probability that the egg carries $A$ and the probability that the $X$-bearing sperm carries $A$.\n  Frequency($AA$ female) = (Freq. of $A$ in eggs) $\\times$ (Freq. of $A$ in $X$-sperm) = $p_{f} \\times p_{m}$\n- The probability of a female zygote having genotype $aa$ is the product of the probability that the egg carries $a$ and the probability that the $X$-bearing sperm carries $a$.\n  Frequency($aa$ female) = (Freq. of $a$ in eggs) $\\times$ (Freq. of $a$ in $X$-sperm) = $(1 - p_{f})(1 - p_{m})$\n- A female zygote can have genotype $Aa$ in two ways: an $A$ egg fertilized by an $a$ sperm, or an $a$ egg fertilized by an $A$ sperm. The total probability is the sum of the probabilities of these two mutually exclusive events.\n  Frequency($Aa$ female) = (Freq. of $A$ in eggs)(Freq. of $a$ in $X$-sperm) + (Freq. of $a$ in eggs)(Freq. of $A$ in $X$-sperm)\n  $= p_{f}(1 - p_{m}) + (1 - p_{f})p_{m}$\n  $= p_{f} - p_{f}p_{m} + p_{m} - p_{f}p_{m}$\n  $= p_{f} + p_{m} - 2p_{f}p_{m}$\n\nAs a check, the sum of female genotype frequencies must be $1$:\n$p_{f}p_{m} + (p_{f} + p_{m} - 2p_{f}p_{m}) + (1 - p_{f})(1 - p_{m}) = p_{f}p_{m} + p_{f} + p_{m} - 2p_{f}p_{m} + 1 - p_{f} - p_{m} + p_{f}p_{m} = 1$. The calculation is consistent.\n\nMale Offspring ($XY$):\nA male offspring inherits his single $X$ chromosome from his mother (egg) and a $Y$ chromosome from his father (sperm). Therefore, the allele on his $X$ chromosome is determined exclusively by the allele present in the egg from which he was conceived.\n- The probability of a male zygote having genotype $A$ (hemizygous) is equal to the frequency of eggs carrying the $A$ allele.\n  Frequency($A$ male) = Freq. of $A$ in eggs = $p_{f}$\n- The probability of a male zygote having genotype $a$ (hemizygous) is equal to the frequency of eggs carrying the $a$ allele.\n  Frequency($a$ male) = Freq. of $a$ in eggs = $1 - p_{f}$\n\nAs a check, the sum of male genotype frequencies must be $1$:\n$p_{f} + (1 - p_{f}) = 1$. The calculation is consistent.\n\nThe problem requires the five frequencies to be presented as a single row vector in the order: female $AA$, female $Aa$, female $aa$, male $A$, male $a$. Based on the derivation, these frequencies are:\n1.  Female $AA$: $p_{f}p_{m}$\n2.  Female $Aa$: $p_{f} + p_{m} - 2p_{f}p_{m}$\n3.  Female $aa$: $(1 - p_{f})(1 - p_{m})$\n4.  Male $A$: $p_{f}$\n5.  Male $a$: $1 - p_{f}$\n\nThis concludes the derivation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_{f} p_{m} & p_{f} + p_{m} - 2 p_{f} p_{m} & (1-p_{f})(1-p_{m}) & p_{f} & 1-p_{f}\n\\end{pmatrix}\n}\n$$", "id": "2849906"}, {"introduction": "Genetic analysis in practice often involves distinguishing between multiple plausible hypotheses that could explain an observed biological pattern. For traits expressed in only one sex (a phenomenon known as sex-limited expression), it can be particularly difficult to discern whether the underlying causal gene resides on a sex chromosome or an autosome. This practice [@problem_id:2849995] equips you with a powerful statistical framework—likelihood-based model comparison—to quantitatively weigh the evidence for these competing models using pedigree data, enabling you to make an evidence-based conclusion about the mode of inheritance.", "problem": "A research team suspects that a male-limited trait (expressed only in males) in a vertebrate species is due either to an autosomal allele or to an X-chromosome allele. They assemble pedigrees ascertained through affected fathers and unrelated unaffected mothers from the same large, randomly mating population. Assume the following:\n\n- The trait is fully penetrant in males who carry at least one copy of the causal allele and is never expressed in females (male-limited expression).\n- There are no new mutations, no phenocopies, and Mendelian segregation holds.\n- Each affected father is a heterozygote under the autosomal model and a hemizygote under the X-linked model.\n- The population frequency of carrier mothers (heterozygous for the autosomal allele under the autosomal model; heterozygous for the X-linked allele under the X-linked model) is known from independent screening to be $c_A = 0.02$ under the autosomal model and $c_X = 0.02$ under the X-linked model.\n\nFor each nuclear family, the number of sons and the number of affected sons are recorded as follows (families are independent):\n\n- Family $1$: $s_1 = 3$ sons, $a_1 = 2$ affected sons.\n- Family $2$: $s_2 = 2$ sons, $a_2 = 1$ affected son.\n- Family $3$: $s_3 = 4$ sons, $a_3 = 2$ affected sons.\n- Family $4$: $s_4 = 1$ son, $a_4 = 0$ affected sons.\n- Family $5$: $s_5 = 3$ sons, $a_5 = 1$ affected son.\n- Family $6$: $s_6 = 2$ sons, $a_6 = 2$ affected sons.\n\nStarting only from the principles of Mendelian segregation and the stated male-limited penetrance, derive the per-family likelihood under:\n\n- Model $A$ (autosomal, male-limited): the affected father is autosomal heterozygote; the mother is a carrier with probability $c_A$ and a non-carrier with probability $1 - c_A$.\n- Model $X$ (X-linked, male-limited): the affected father is $X$-hemizygote; the mother is a carrier with probability $c_X$ and a non-carrier with probability $1 - c_X$.\n\nThen, using these likelihoods, compute the joint likelihoods $L_A$ and $L_X$ across all families and the natural log-likelihood ratio\n$$\\ln \\Lambda = \\ln L_A - \\ln L_X.$$\nReport the numerical value of $\\ln \\Lambda$ rounded to four significant figures. The final answer must be a single real number (dimensionless).", "solution": "We proceed from Mendelian segregation and the stated male-limited penetrance.\n\nUnder Model $A$ (autosomal, male-limited):\n- The affected father is an autosomal heterozygote. For a son, if the mother is a non-carrier (probability $1 - c_A$), the probability the son inherits the allele from the father is $1/2$, and because the trait is male-limited with full penetrance, the son is affected with probability $1/2$. If the mother is a carrier (probability $c_A$), the father is heterozygous and the mother is heterozygous; a son is unaffected only if he is $aa$, which occurs with probability $1/4$, so the son is affected with probability $3/4$. Conditional on the mother’s carrier status, sons are independent given the standard binomial sampling.\n- Therefore, for a family with $s$ sons and $a$ affected sons, the per-family likelihood under Model $A$ is a mixture:\n$$\nL_{A,\\text{family}} = (1 - c_A)\\,\\binom{s}{a}\\left(\\frac{1}{2}\\right)^{a}\\left(\\frac{1}{2}\\right)^{s-a} \\;+\\; c_A\\,\\binom{s}{a}\\left(\\frac{3}{4}\\right)^{a}\\left(\\frac{1}{4}\\right)^{s-a}.\n$$\n\nUnder Model $X$ (X-linked, male-limited):\n- The affected father is $X$-hemizygous and contributes the $Y$ chromosome to all sons; thus, sons cannot inherit the paternal $X$ allele. If the mother is a non-carrier (probability $1 - c_X$), then no son can be affected, so the probability of $a=0$ affected sons out of $s$ sons is $1$ and the probability of $a>0$ affected sons is $0$. If the mother is a carrier (probability $c_X$), each son has probability $1/2$ of inheriting the maternal mutant $X$, and hence of being affected (male-limited with full penetrance). Conditional on the mother’s carrier status, sons are independent.\n- Therefore, for a family with $s$ sons and $a$ affected sons, the per-family likelihood under Model $X$ is:\n$$\nL_{X,\\text{family}} = (1 - c_X)\\,\\mathbf{1}\\{a = 0\\} \\;+\\; c_X\\,\\binom{s}{a}\\left(\\frac{1}{2}\\right)^{a}\\left(\\frac{1}{2}\\right)^{s-a} \\;=\\; (1 - c_X)\\,\\mathbf{1}\\{a = 0\\} \\;+\\; c_X\\,\\binom{s}{a}\\left(\\frac{1}{2}\\right)^{s}.\n$$\n\nWe are given $c_A = 0.02$ and $c_X = 0.02$.\n\nCompute per-family likelihoods for each family:\n\n- Family $1$: $s_1 = 3$, $a_1 = 2$, $\\binom{3}{2} = 3$, $\\left(\\frac{1}{2}\\right)^{3} = 0.125$.\n  - Model $A$: \n    $$\n    L_{A,1} = (1 - 0.02)\\cdot 3\\cdot 0.125 + 0.02\\cdot 3 \\cdot \\left(\\frac{3}{4}\\right)^{2}\\left(\\frac{1}{4}\\right)^{1} \\\\\n    = 0.98 \\cdot 0.375 + 0.02 \\cdot 3 \\cdot \\frac{9}{16}\\cdot \\frac{1}{4} \\\\\n    = 0.3675 + 0.0084375 = 0.3759375.\n    $$\n  - Model $X$:\n    $$\n    L_{X,1} = 0 \\;+\\; 0.02 \\cdot 3 \\cdot 0.125 = 0.0075.\n    $$\n\n- Family $2$: $s_2 = 2$, $a_2 = 1$, $\\binom{2}{1} = 2$, $\\left(\\frac{1}{2}\\right)^{2} = 0.25$.\n  - Model $A$:\n    $$\n    L_{A,2} = 0.98 \\cdot 2 \\cdot 0.25 + 0.02 \\cdot 2 \\cdot \\left(\\frac{3}{4}\\right)^{1}\\left(\\frac{1}{4}\\right)^{1} \\\\\n    = 0.98 \\cdot 0.5 + 0.04 \\cdot \\frac{3}{16} \\\\\n    = 0.49 + 0.0075 = 0.4975.\n    $$\n  - Model $X$:\n    $$\n    L_{X,2} = 0 \\;+\\; 0.02 \\cdot 2 \\cdot 0.25 = 0.01.\n    $$\n\n- Family $3$: $s_3 = 4$, $a_3 = 2$, $\\binom{4}{2} = 6$, $\\left(\\frac{1}{2}\\right)^{4} = 0.0625$.\n  - Model $A$:\n    $$\n    L_{A,3} = 0.98 \\cdot 6 \\cdot 0.0625 + 0.02 \\cdot 6 \\cdot \\left(\\frac{3}{4}\\right)^{2}\\left(\\frac{1}{4}\\right)^{2} \\\\\n    = 0.98 \\cdot 0.375 + 0.02 \\cdot 6 \\cdot \\frac{9}{16}\\cdot \\frac{1}{16} \\\\\n    = 0.3675 + 0.00421875 = 0.37171875.\n    $$\n  - Model $X$:\n    $$\n    L_{X,3} = 0 \\;+\\; 0.02 \\cdot 6 \\cdot 0.0625 = 0.0075.\n    $$\n\n- Family $4$: $s_4 = 1$, $a_4 = 0$, $\\binom{1}{0} = 1$, $\\left(\\frac{1}{2}\\right)^{1} = 0.5$.\n  - Model $A$:\n    $$\n    L_{A,4} = 0.98 \\cdot 1 \\cdot 0.5 + 0.02 \\cdot 1 \\cdot \\left(\\frac{3}{4}\\right)^{0}\\left(\\frac{1}{4}\\right)^{1} \\\\\n    = 0.49 + 0.005 = 0.495.\n    $$\n  - Model $X$:\n    $$\n    L_{X,4} = (1 - 0.02)\\cdot 1 + 0.02 \\cdot 1 \\cdot 0.5 = 0.98 + 0.01 = 0.99.\n    $$\n\n- Family $5$: $s_5 = 3$, $a_5 = 1$, $\\binom{3}{1} = 3$, $\\left(\\frac{1}{2}\\right)^{3} = 0.125$.\n  - Model $A$:\n    $$\n    L_{A,5} = 0.98 \\cdot 3 \\cdot 0.125 + 0.02 \\cdot 3 \\cdot \\left(\\frac{3}{4}\\right)^{1}\\left(\\frac{1}{4}\\right)^{2} \\\\\n    = 0.3675 + 0.0028125 = 0.3703125.\n    $$\n  - Model $X$:\n    $$\n    L_{X,5} = 0 \\;+\\; 0.02 \\cdot 3 \\cdot 0.125 = 0.0075.\n    $$\n\n- Family $6$: $s_6 = 2$, $a_6 = 2$, $\\binom{2}{2} = 1$, $\\left(\\frac{1}{2}\\right)^{2} = 0.25$.\n  - Model $A$:\n    $$\n    L_{A,6} = 0.98 \\cdot 1 \\cdot 0.25 + 0.02 \\cdot 1 \\cdot \\left(\\frac{3}{4}\\right)^{2}\\left(\\frac{1}{4}\\right)^{0} \\\\\n    = 0.245 + 0.01125 = 0.25625.\n    $$\n  - Model $X$:\n    $$\n    L_{X,6} = 0 \\;+\\; 0.02 \\cdot 1 \\cdot 0.25 = 0.005.\n    $$\n\nAssuming independence across families, the joint likelihoods are products:\n$$\nL_A = \\prod_{i=1}^{6} L_{A,i}, \\qquad L_X = \\prod_{i=1}^{6} L_{X,i}.\n$$\nIt is numerically stable to compute $\\ln \\Lambda = \\sum_{i=1}^{6} \\ln\\left(\\frac{L_{A,i}}{L_{X,i}}\\right)$.\n\nCompute per-family likelihood ratios $R_i = \\frac{L_{A,i}}{L_{X,i}}$:\n- Family $1$: $R_1 = \\frac{0.3759375}{0.0075} = 50.125$.\n- Family $2$: $R_2 = \\frac{0.4975}{0.01} = 49.75$.\n- Family $3$: $R_3 = \\frac{0.37171875}{0.0075} = 49.5625$.\n- Family $4$: $R_4 = \\frac{0.495}{0.99} = 0.5$.\n- Family $5$: $R_5 = \\frac{0.3703125}{0.0075} = 49.375$.\n- Family $6$: $R_6 = \\frac{0.25625}{0.005} = 51.25$.\n\nThus,\n$$\n\\ln \\Lambda = \\sum_{i=1}^{6} \\ln R_i = \\ln 50.125 + \\ln 49.75 + \\ln 49.5625 + \\ln 0.5 + \\ln 49.375 + \\ln 51.25.\n$$\nEvaluating,\n$$\n\\ln 50.125 \\approx 3.9145198856,\\;\n\\ln 49.75 \\approx 3.9070104637,\\;\n\\ln 49.5625 \\approx 3.9032345000,\n$$\n$$\n\\ln 0.5 \\approx -0.6931471806,\\;\n\\ln 49.375 \\approx 3.8994442230,\\;\n\\ln 51.25 \\approx 3.9367156170.\n$$\nSumming,\n$$\n\\ln \\Lambda \\approx 18.8677775088.\n$$\n\nRounded to four significant figures, the requested value is $18.87$.", "answer": "$$\\boxed{18.87}$$", "id": "2849995"}, {"introduction": "Sex determination systems can be exploited by \"selfish\" genetic elements that violate Mendelian laws to enhance their own transmission, a phenomenon known as meiotic drive. An X-chromosome driver, for instance, can bias sperm production to favor itself, leading to a surplus of daughters and potentially threatening the entire population's viability by creating a shortage of males. This advanced computational exercise [@problem_id:2849925] guides you through building a population model from first principles to simulate these dynamics, allowing you to explore the critical interplay between genetics, ecology, and the risk of population extinction.", "problem": "You are to implement and analyze a deterministic, discrete-time, sex-structured population model for a species with an XX/XY sex determination system under the introduction of an X-drive meiotic drive element. The model must integrate the following fundamental bases from genetics and population dynamics: (i) in an XX/XY system, males are heterogametic and the sex of zygotes is determined by the paternal sex chromosome; (ii) Mendelian segregation applies in females, whereas the drive element in males biases the probability that an X chromosome is transmitted; (iii) a finite male mating capacity limits the fraction of females that are fertilized; and (iv) Beverton–Holt density dependence regulates recruitment. Your task is to compute the minimal per-female fecundity that avoids population collapse for several parameter sets, and output these minimal fecundity values as floats.\n\nModel ingredients and definitions:\n- Time is discrete in generations indexed by $t \\in \\{0,1,2,\\dots\\}$.\n- Let $N_f(t)$ and $N_m(t)$ denote the adult female and male counts at generation $t$, respectively.\n- Let the adult female genotype counts at generation $t$ be $F_{DD}(t)$, $F_{DN}(t)$, and $F_{NN}(t)$ for genotypes $X^D X^D$, $X^D X$, and $X X$, respectively, so that $N_f(t) = F_{DD}(t) + F_{DN}(t) + F_{NN}(t)$.\n- Let the adult male genotype counts at generation $t$ be $M_D(t)$ and $M_N(t)$ for genotypes $X^D Y$ and $X Y$, respectively, so that $N_m(t) = M_D(t) + M_N(t)$.\n- Let $c > 0$ denote male mating capacity (number of females a single male can fertilize per generation), $b \\ge 0$ the per-female fecundity (eggs per fertilized female), $\\alpha \\ge 0$ the Beverton–Holt crowding parameter, and $d \\in [0.5,1]$ the meiotic drive bias in $X^D Y$ males (probability an $X^D$ is transmitted rather than $Y$). Non-drive males ($X Y$) transmit $X$ with probability $0.5$ and $Y$ with probability $0.5$.\n\nAt each generation $t$:\n- The fraction of females that are fertilized is\n$$\n\\phi_t = \n\\begin{cases}\n\\min\\left\\{1,\\; c \\, \\dfrac{N_m(t)}{N_f(t)}\\right\\}, & \\text{if } N_f(t) > 0, \\\\\n0, & \\text{if } N_f(t) = 0.\n\\end{cases}\n$$\n- The total number of zygotes before density regulation is\n$$\nE_t = b \\, \\phi_t \\, N_f(t).\n$$\n- Let the female genotype frequencies be $f_{DD}(t) = \\dfrac{F_{DD}(t)}{N_f(t)}$, $f_{DN}(t) = \\dfrac{F_{DN}(t)}{N_f(t)}$, $f_{NN}(t) = \\dfrac{F_{NN}(t)}{N_f(t)}$ when $N_f(t) > 0$ (otherwise defined as $0$). Let the male genotype frequencies be $m_D(t) = \\dfrac{M_D(t)}{N_m(t)}$ and $m_N(t) = \\dfrac{M_N(t)}{N_m(t)}$ when $N_m(t) > 0$ (otherwise defined as $0$).\n- Female meiosis is Mendelian: the probability that a random egg carries $X^D$ is\n$$\np^{(m)}_{X^D}(t) = f_{DD}(t) + \\dfrac{1}{2} f_{DN}(t),\n$$\nand hence $p^{(m)}_{X}(t) = 1 - p^{(m)}_{X^D}(t)$ is the probability the egg carries the non-drive $X$.\n- Male meiosis: the probability that a random sperm is $X^D$ equals\n$$\np^{(f)}_{X^D}(t) = m_D(t) \\, d,\n$$\nthe probability a sperm is non-drive $X$ equals\n$$\np^{(f)}_{X}(t) = m_N(t) \\cdot \\dfrac{1}{2},\n$$\nand the probability a sperm is $Y$ equals\n$$\np^{(f)}_{Y}(t) = 1 - \\left(p^{(f)}_{X^D}(t) + p^{(f)}_{X}(t)\\right) = m_D(t)\\,(1-d) + m_N(t)\\cdot \\dfrac{1}{2}.\n$$\n- Expected zygote genotype counts before density regulation are given by the product of egg and sperm type probabilities times $E_t$:\n    - Daughters ($X$ from father, $X$ from mother):\n        - $X^D X^D$: $E_{DD}(t) = E_t \\, p^{(f)}_{X^D}(t)\\, p^{(m)}_{X^D}(t)$.\n        - $X^D X$: $E_{DN}(t) = E_t \\left[p^{(f)}_{X^D}(t)\\, p^{(m)}_{X}(t) + p^{(f)}_{X}(t)\\, p^{(m)}_{X^D}(t)\\right]$.\n        - $X X$: $E_{NN}(t) = E_t \\, p^{(f)}_{X}(t)\\, p^{(m)}_{X}(t)$.\n    - Sons ($Y$ from father, $X$ from mother):\n        - $X^D Y$: $E_{M_D}(t) = E_t \\, p^{(f)}_{Y}(t) \\, p^{(m)}_{X^D}(t)$.\n        - $X Y$: $E_{M_N}(t) = E_t \\, p^{(f)}_{Y}(t) \\, p^{(m)}_{X}(t)$.\n- Beverton–Holt density dependence scales zygote counts by\n$$\ns_t = \\dfrac{1}{1 + \\alpha \\left(N_f(t) + N_m(t)\\right)}.\n$$\n- Adults at $t+1$ are\n$$\nF_{DD}(t+1) = s_t \\, E_{DD}(t),\\quad F_{DN}(t+1) = s_t \\, E_{DN}(t),\\quad F_{NN}(t+1) = s_t \\, E_{NN}(t),\n$$\n$$\nM_D(t+1) = s_t \\, E_{M_D}(t),\\quad M_N(t+1) = s_t \\, E_{M_N}(t).\n$$\n\nExtinction and persistence criteria:\n- Declare extinction if at any $t$ either $N_f(t) < \\varepsilon$ or $N_m(t) < \\varepsilon$, in which case no further reproduction occurs; use $\\varepsilon = 10^{-12}$.\n- Declare persistence at horizon $T$ if the final total $N_f(T) + N_m(T) \\ge \\eta$ with $\\eta = 1.0$.\n\nObjective:\n- For each parameter set, compute the minimal fecundity value $b^\\star$ such that the population persists at horizon $T$. Assume monotonicity of persistence with respect to $b$ and determine $b^\\star$ by binary search to within absolute tolerance $\\delta = 10^{-6}$. Use bracketing by exponentially increasing an upper bound $b_{\\text{hi}}$ starting from $b_{\\text{lo}} = 0$ and $b_{\\text{hi}} = 1$ until persistence is achieved or until $b_{\\text{hi}}$ exceeds $B_{\\max} = 10^3$. If persistence is not achieved by $B_{\\max}$, return $B_{\\max}$ as the value.\n\nInitial conditions for all test cases:\n- At $t = 0$, set $F_{NN}(0) = N_f(0)$, $F_{DD}(0) = 0$, $F_{DN}(0) = 0$.\n- At $t = 0$, set $M_D(0) = q_0 \\, N_m(0)$ and $M_N(0) = \\left(1-q_0\\right) N_m(0)$.\n\nTest suite (each line is one parameter set $(c,\\alpha,d,q_0,N_f(0),N_m(0),T)$):\n- Case A: $(2.0,\\; 0.01,\\; 0.95,\\; 0.2,\\; 500,\\; 500,\\; 200)$.\n- Case B: $(0.5,\\; 0.01,\\; 0.95,\\; 0.2,\\; 500,\\; 500,\\; 200)$.\n- Case C: $(2.0,\\; 0.05,\\; 0.95,\\; 0.2,\\; 500,\\; 500,\\; 200)$.\n- Case D: $(2.0,\\; 0.01,\\; 0.6,\\; 0.2,\\; 500,\\; 500,\\; 200)$.\n\nYour program must:\n- Implement the above recursion exactly.\n- For each test case, compute $b^\\star$ to absolute tolerance $\\delta = 10^{-6}$ using the bracketing and binary search rules specified.\n- Produce a single line of output containing a list of the four $b^\\star$ values as decimal floats rounded to exactly $6$ digits after the decimal point, in the order A, B, C, D.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[bA,bB,bC,bD]\").", "solution": "The problem statement is subjected to validation and is determined to be valid. It is scientifically grounded, well-posed, and objective. It provides a complete and consistent specification for a deterministic, discrete-time population genetics model. The model correctly integrates fundamental principles, including XX/XY sex determination, Mendelian and non-Mendelian (meiotic drive) inheritance, mate limitation via a Holling Type I functional response, and Beverton–Holt density-dependent regulation. The objective is to find a critical parameter value, the minimal per-female fecundity $b^\\star$ required for population persistence, using a precisely defined numerical search algorithm. The problem is thus a standard exercise in mathematical biology and computational science.\n\nThe solution is approached by first constructing a function to simulate the population dynamics according to the provided recurrence relations. This function, which we may call `check_persistence`, takes a set of parameters $(c, \\alpha, d, q_0, N_f(0), N_m(0), T)$ and a trial fecundity value $b$ as input. It then iterates the population state for $T$ generations.\n\nThe state of the population at any time $t$ is fully described by the counts of five genotypes: three female ($F_{DD}(t)$, $F_{DN}(t)$, $F_{NN}(t)$) and two male ($M_D(t)$, $M_N(t)$). The simulation begins with the specified initial conditions at $t=0$:\n$$F_{DD}(0)=0, \\quad F_{DN}(0)=0, \\quad F_{NN}(0)=N_f(0)$$\n$$M_D(0)=q_0 N_m(0), \\quad M_N(0)=(1-q_0) N_m(0)$$\n\nIn each generation $t$ of the simulation, the following steps are executed:\n1.  Total adult female $N_f(t)$ and male $N_m(t)$ populations are calculated by summing the respective genotype counts.\n2.  An extinction check is performed. If $N_f(t) < \\varepsilon$ or $N_m(t) < \\varepsilon$ (with $\\varepsilon = 10^{-12}$), the population is considered extinct, and the simulation terminates, returning a `False` (non-persistence) verdict.\n3.  The fraction of fertilized females, $\\phi_t$, is calculated, accounting for mate limitation:\n    $$\\phi_t = \\min\\left\\{1,\\; c \\, \\dfrac{N_m(t)}{N_f(t)}\\right\\}$$\n    where care is taken to handle the case $N_f(t)=0$, for which $\\phi_t=0$.\n4.  The total number of zygotes produced, $E_t$, is $E_t = b \\, \\phi_t \\, N_f(t)$.\n5.  Genotype frequencies for both sexes are computed. For $N_f(t) > 0$, $f_{DD}(t) = F_{DD}(t)/N_f(t)$, and so on. If a total count is zero, the corresponding frequencies are taken to be zero.\n6.  The frequencies of $X^D$ and $X$ gametes from females ($p^{(m)}_{X^D}(t)$, $p^{(m)}_{X}(t)$) and $X^D$, $X$, and $Y$ gametes from males ($p^{(f)}_{X^D}(t)$, $p^{(f)}_{X}(t)$, $p^{(f)}_{Y}(t)$) are calculated based on these frequencies and the rules of Mendelian segregation (in females and $XY$ males) and meiotic drive (in $X^D Y$ males with bias $d$).\n7.  The expected counts of zygotes of each genotype ($E_{DD}$, $E_{DN}$, $E_{NN}$, $E_{M_D}$, $E_{M_N}$) are calculated by multiplying the total zygote count $E_t$ by the appropriate products of gamete frequencies.\n8.  Density-dependent survival is applied via the Beverton–Holt scaling factor $s_t = (1 + \\alpha (N_f(t) + N_m(t)))^{-1}$.\n9.  The adult counts for the next generation, $t+1$, are found by multiplying the expected zygote counts by the survival factor $s_t$. For example, $F_{DD}(t+1) = s_t E_{DD}(t)$.\n\nAfter iterating for $T$ generations without triggering the extinction condition, the simulation checks for persistence. The population is deemed persistent if the final total population $N_f(T) + N_m(T) \\ge \\eta$, where $\\eta=1.0$. The `check_persistence` function returns `True` in this case.\n\nTo find the minimal fecundity $b^\\star$, a numerical search procedure is implemented for each test case. This procedure assumes that persistence is a monotonically increasing function of $b$, a biologically plausible assumption. The search consists of two phases:\n1.  **Bracketing**: An interval $[b_{\\text{lo}}, b_{\\text{hi}}]$ must be found such that `check_persistence` returns `False` for $b_{\\text{lo}}$ and `True` for $b_{\\text{hi}}$. The search starts with $b_{\\text{lo}}=0$ and $b_{\\text{hi}}=1$. If persistence is not achieved at $b_{\\text{hi}}$, this upper bound is exponentially increased (e.g., $b_{\\text{hi}} \\leftarrow 2 \\cdot b_{\\text{hi}}$), with $b_{\\text{lo}}$ tracking the old $b_{\\text{hi}}$, until persistence is observed. A special case is handled where persistence is not achieved even for $b=B_{\\max}=10^3$, in which case $B_{\\max}$ is returned as the result.\n2.  **Binary Search (Bisection)**: Once a valid bracket $[b_{\\text{lo}}, b_{\\text{hi}}]$ is established, the interval is repeatedly bisected. The midpoint $b_{\\text{mid}} = (b_{\\text{lo}} + b_{\\text{hi}})/2$ is tested. If it results in persistence, the new interval becomes $[b_{\\text{lo}}, b_{\\text{mid}}]$; otherwise, it becomes $[b_{\\text{mid}}, b_{\\text{hi}}]$. This continues until the interval width $b_{\\text{hi}} - b_{\\text{lo}}$ is less than the specified tolerance $\\delta = 10^{-6}$. The final estimate for $b^\\star$ is the midpoint of the final interval.\n\nThis entire algorithm is implemented in Python, adhering to the specified environment. The process is repeated for each of the four test cases, and the resulting values for $b^\\star$ are collected, formatted to six decimal places, and printed in the required list format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef check_persistence(b, params):\n    \"\"\"\n    Simulates the population dynamics for a given fecundity b and parameters.\n    Returns True for persistence, False for extinction.\n    \"\"\"\n    c, alpha, d, q0, Nf0, Nm0, T = params\n    epsilon = 1e-12\n    eta = 1.0\n\n    # Initial genotype counts at t=0\n    F_DD = 0.0\n    F_DN = 0.0\n    F_NN = float(Nf0)\n    M_D = q0 * float(Nm0)\n    M_N = (1.0 - q0) * float(Nm0)\n\n    for t in range(T):\n        Nf_t = F_DD + F_DN + F_NN\n        Nm_t = M_D + M_N\n\n        if Nf_t < epsilon or Nm_t < epsilon:\n            return False\n\n        # Fraction of females fertilized\n        if Nf_t > 0:\n            phi_t = min(1.0, c * Nm_t / Nf_t)\n        else: # Should not happen due to check above, but for robustness\n            phi_t = 0.0\n\n        # Total zygotes\n        E_t = b * phi_t * Nf_t\n\n        # Genotype frequencies\n        f_DD = F_DD / Nf_t\n        f_DN = F_DN / Nf_t\n        f_NN = F_NN / Nf_t\n        \n        if Nm_t > 0:\n            m_D = M_D / Nm_t\n            m_N = M_N / Nm_t\n        else: # Should not happen due to check above\n            m_D, m_N = 0.0, 0.0\n\n        # Gamete probabilities\n        # (m) from mothers (eggs)\n        p_m_XD = f_DD + 0.5 * f_DN\n        p_m_X = f_NN + 0.5 * f_DN # or 1.0 - p_m_XD\n        \n        # (f) from fathers (sperm)\n        p_f_XD = m_D * d\n        p_f_X = m_N * 0.5\n        p_f_Y = m_D * (1.0 - d) + m_N * 0.5 # or 1.0 - (p_f_XD + p_f_X)\n\n        # Expected zygote counts\n        E_DD = E_t * p_f_XD * p_m_XD\n        E_DN = E_t * (p_f_XD * p_m_X + p_f_X * p_m_XD)\n        E_NN = E_t * p_f_X * p_m_X\n        E_M_D = E_t * p_f_Y * p_m_XD\n        E_M_N = E_t * p_f_Y * p_m_X\n\n        # Beverton-Holt density dependence\n        s_t = 1.0 / (1.0 + alpha * (Nf_t + Nm_t))\n\n        # Update adult counts for t+1\n        F_DD = s_t * E_DD\n        F_DN = s_t * E_DN\n        F_NN = s_t * E_NN\n        M_D = s_t * E_M_D\n        M_N = s_t * E_M_N\n\n    # Final check at horizon T\n    Nf_T = F_DD + F_DN + F_NN\n    Nm_T = M_D + M_N\n    \n    return (Nf_T + Nm_T) >= eta\n\ndef find_b_star(params):\n    \"\"\"\n    Finds the minimal fecundity b* for persistence using binary search.\n    \"\"\"\n    B_max = 1000.0\n    delta = 1e-6\n\n    # Check persistence at B_max. If it fails, the answer is B_max.\n    if not check_persistence(B_max, params):\n        return B_max\n\n    # Find a bracket [b_lo, b_hi] where b_lo fails and b_hi succeeds.\n    b_lo, b_hi = 0.0, 1.0\n    \n    # Exponentially increase b_hi until persistence is found.\n    # This loop will terminate because we know B_max persists.\n    while not check_persistence(b_hi, params):\n        b_lo = b_hi\n        b_hi = min(b_hi * 2.0, B_max) # Ensure we don't overshoot B_max\n\n    # Binary search for b* within the bracket [b_lo, b_hi]\n    while (b_hi - b_lo) > delta:\n        b_mid = b_lo + (b_hi - b_lo) / 2.0\n        if check_persistence(b_mid, params):\n            b_hi = b_mid\n        else:\n            b_lo = b_mid\n            \n    return (b_lo + b_hi) / 2.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # (c, alpha, d, q0, Nf0, Nm0, T)\n    test_cases = [\n        (2.0, 0.01, 0.95, 0.2, 500, 500, 200),  # Case A\n        (0.5, 0.01, 0.95, 0.2, 500, 500, 200),  # Case B\n        (2.0, 0.05, 0.95, 0.2, 500, 500, 200),  # Case C\n        (2.0, 0.01, 0.6, 0.2, 500, 500, 200),   # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        b_star = find_b_star(case)\n        results.append(b_star)\n\n    # Format results to 6 decimal places and print\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2849925"}]}