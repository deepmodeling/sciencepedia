{"hands_on_practices": [{"introduction": "A successful microarray experiment relies on the precise execution of multiple steps, from RNA labeling to hybridization and scanning. This practice challenges you to act as an experimental diagnostician. By analyzing a rich set of quality control data from a hypothetical experiment and reasoning from the first principles of hybridization physics, you will pinpoint the primary failure mode, a crucial skill for interpreting complex biological data and troubleshooting real-world experiments. [@problem_id:2805354]", "problem": "A two-color complementary Deoxyribonucleic Acid (cDNA) microarray experiment is conducted with Cyanine 3 (Cy3) and Cyanine 5 (Cy5) labeling. Consider the following foundational relationships and control outcomes.\n\nFoundational base. In the linear, non-saturated regime of hybridization, the expected fluorescence intensity for dye $d \\in \\{3,5\\}$ on a given probe is modeled by\n$$\nI_d(C) \\approx G_d \\,\\phi_d \\,\\alpha_d \\,N_{\\max}\\,\\frac{K C}{1 + K C} + B_d,\n$$\nwhere $C$ is target concentration, $K$ is an effective equilibrium association constant (probe-specific, assumed dye-independent), $G_d$ is the detector gain for dye $d$, $\\phi_d$ is the dye quantum yield, $\\alpha_d$ is the labeling specific activity (dyes per nucleotide incorporated), $N_{\\max}$ is the maximum binding capacity, and $B_d$ is the local background. In the low-occupancy regime where $K C \\ll 1$, $I_d(C)$ is approximately proportional to $C$:\n$$\nI_d(C) \\approx \\left( G_d \\,\\phi_d \\,\\alpha_d \\,N_{\\max}\\,K \\right) C + B_d.\n$$\nThus, for equal concentrations of targets in both channels on the same probe, the Cy5-to-Cy3 ratio in the linear regime is expected to be constant and equal to\n$$\n\\frac{I_5 - B_5}{I_3 - B_3} \\approx \\frac{G_5 \\,\\phi_5 \\,\\alpha_5}{G_3 \\,\\phi_3 \\,\\alpha_3}.\n$$\n\nControls and observations.\n1. External spike-in ladder L_eq: Equal concentrations of exogenous control transcripts were added to both channels at $C \\in \\{0,\\,0.05,\\,0.15,\\,0.5,\\,1.5,\\,5,\\,15\\}\\,\\mathrm{pM}$. For the mid-range $C \\in [0.15,\\,5]\\,\\mathrm{pM}$, regressions of $\\log_{10}(I_d - B_d)$ versus $\\log_{10}(C)$ yield slopes of $0.99 \\pm 0.03$ (Cy3) and $0.98 \\pm 0.04$ (Cy5). The median $\\log_2$-ratio across L_eq controls, $\\log_2\\!\\left(\\frac{I_5 - B_5}{I_3 - B_3}\\right)$, is approximately constant at $-1.07 \\pm 0.08$ over the entire mid-range.\n2. External spike-in ladder L_4x: A second spike-in set was added at a $4\\times$ higher concentration to the Cy5 channel relative to Cy3 (expected $\\log_2$-ratio $= +2.00$). The observed median $\\log_2$-ratio for L_4x is $+0.95 \\pm 0.10$.\n3. Negative controls ($C=0$) yield median $(I_d - B_d)$ near zero for both dyes with comparable background noise; the lower quartile-to-upper quartile spread is $< 5\\%$ of the mid-range L_eq signal.\n4. Perfect-match (PM) and mismatch (MM) probe controls show median $\\frac{I_{\\mathrm{PM},d} - B_d}{I_{\\mathrm{MM},d} - B_d} \\approx 4.5$ for both dyes in the mid-range, indicating strong specificity.\n5. Scanner diagnostics: A step-wedge calibration slide scanned at the same settings yields per-channel linearity with coefficient of determination $R^2 > 0.999$ over $> 3$ orders of magnitude and a Cy5-to-Cy3 scale factor within $5\\%$ of the instrument’s nominal calibration. On the experimental arrays, the fraction of saturated pixels per spot is $< 0.1\\%$ for all spike-ins.\n6. Spatial diagnostics: Coefficients of variation across print-tip groups for L_eq mid-range signals are $< 7\\%$ and show no spatial clustering. Housekeeping controls and endogenous genes exhibit a median $\\log_2$ Cy5/Cy3 ratio near $-1.0$ similar to spike-ins.\n7. RNA integrity controls (e.g., $3^{\\prime}/5^{\\prime}$ ratios for reference genes) are near $1.0 \\pm 0.1$.\n\nTask. Using only the model and observations above, reason from first principles to identify the primary failure mode that explains the inconsistent spike-in recovery (i.e., the systematic deviation of observed from expected ratios). Which of the following is most strongly supported?\n\nA. Labeling failure, specifically reduced Cy5 specific activity $\\alpha_5$ (e.g., degraded dye or poor incorporation), causing a dye-specific multiplicative bias independent of $C$.\n\nB. Hybridization failure due to suboptimal stringency (elevated non-specific binding), altering effective $K$ and increasing background, thereby distorting ratios.\n\nC. Scanning failure dominated by detector nonlinearity or saturation, compressing high-end signals and distorting ratios.\n\nD. Printing/spotting defect leading to spatially localized loss of material as the dominant error source.", "solution": "The core task is to identify the physical cause of a systematic bias in the observed log-ratios. The relationship between the observed log-ratio ($M$), the true concentration log-ratio, and the systematic dye bias ($D$) is given by:\n$$ M = \\log_2\\left(\\frac{I_5 - B_5}{I_3 - B_3}\\right) \\approx \\log_2\\left(\\frac{C_5}{C_3}\\right) + \\log_2\\left(\\frac{G_5 \\phi_5 \\alpha_5}{G_3 \\phi_3 \\alpha_3}\\right) = \\log_2\\left(\\frac{C_5}{C_3}\\right) + D $$\n1.  **Estimate the Dye Bias (D):** From Observation 1 (L_eq controls), the concentrations are equal ($C_5 = C_3$), so the true log-ratio $\\log_2(C_5/C_3)$ is 0. The observed median log-ratio is $M_{eq} = -1.07$. Therefore, the systematic dye bias is estimated as $D \\approx -1.07$. This indicates the Cy5 signal is globally about $2^{-1.07} \\approx 47.6\\%$ as efficient as the Cy3 signal.\n2.  **Test for Consistency:** From Observation 2 (L_4x controls), the Cy5 concentration is $4\\times$ the Cy3 concentration, so the true log-ratio is $\\log_2(4) = +2.00$. The predicted observed log-ratio is $M_{4x,pred} \\approx \\log_2(4) + D \\approx 2.00 - 1.07 = +0.93$. This predicted value is consistent with the experimentally observed value of $M_{4x,obs} = +0.95 \\pm 0.10$. This confirms the problem is a global, multiplicative bias represented by $D$.\n3.  **Evaluate Options based on Controls:**\n    *   **A (Labeling Failure):** A reduced specific activity for the Cy5 dye ($\\alpha_5$) would decrease the term $\\frac{G_5 \\phi_5 \\alpha_5}{G_3 \\phi_3 \\alpha_3}$, creating a constant negative offset $D$. This is a global, multiplicative effect independent of concentration, which perfectly matches all observations, including the linearity of the spike-in response (Observation 1) and the consistent bias in housekeeping genes (Observation 6). This is a strong candidate.\n    *   **B (Hybridization Failure):** Poor hybridization stringency would increase non-specific binding, which is an additive error. This would compromise specificity (contradicted by Observation 4) and disrupt linearity, especially at low concentrations (contradicted by Observation 1).\n    *   **C (Scanning Failure):** Detector nonlinearity or saturation is explicitly ruled out by scanner diagnostics (Observation 5). Such an error would also be intensity-dependent, not a constant multiplicative factor, contradicting the constant offset observed.\n    *   **D (Printing Defect):** This would cause spatially localized artifacts, which are ruled out by spatial diagnostics showing no clustering and low variation (Observation 6).\n\nThe evidence points conclusively to a global, multiplicative issue specific to the Cy5 channel, best explained by a failure in the labeling step.", "answer": "$$\\boxed{A}$$", "id": "2805354"}, {"introduction": "In two-color microarray experiments, systematic differences in the properties of the Cy3 and Cy5 fluorescent dyes can introduce an intensity-dependent bias, confounding the true biological signal. Normalization techniques like Locally Weighted Scatterplot Smoothing (LOWESS) are designed to correct this. This exercise provides a hands-on calculation to quantify the residual bias after a hypothetical LOWESS normalization, enhancing your understanding of how these essential data-cleaning procedures are evaluated. [@problem_id:2805484]", "problem": "A two-color deoxyribonucleic acid (DNA) microarray experiment yields Cy5 (red) and Cy3 (green) fluorescence intensities for probe spots. For each spot indexed by $i \\in \\{1,\\dots,N\\}$, define the log-ratio and average log-intensity as $M_i = \\log_{2}(R_i) - \\log_{2}(G_i)$ and $A_i = \\tfrac{1}{2}\\left(\\log_{2}(R_i) + \\log_{2}(G_i)\\right)$. In practice, intensity-dependent dye-bias causes systematic dependence of $M_i$ on $A_i$, which is removed by regressing $M$ on $A$ via Locally Weighted Scatterplot Smoothing (LOWESS) and using the residuals as normalized log-ratios. Consider a dataset of $N=10{,}000$ probe spots. A LOWESS fit has been obtained and, for the purpose of computation with aggregated statistics, is well-approximated by a global quadratic function $\\hat{m}(a) = \\alpha + \\beta a + \\gamma a^{2}$ with coefficients $\\alpha = 0.02$, $\\beta = -0.004$, and $\\gamma = 0.0003$. You are provided the following exact aggregated sums over all spots:\n- $\\sum_{i=1}^{N} A_i = 100{,}000$,\n- $\\sum_{i=1}^{N} A_i^{2} = 1{,}022{,}500$,\n- $\\sum_{i=1}^{N} A_i^{3} = 10{,}675{,}000$,\n- $\\sum_{i=1}^{N} M_i = 108.75$,\n- $\\sum_{i=1}^{N} A_i M_i = 1{,}133.0$.\nUsing only these summaries and the stated LOWESS approximation, compute a single quantitative measure of residual intensity-dependent bias after normalization defined as the Ordinary Least Squares (OLS) slope $b_{\\mathrm{res}}$ of the regression of the normalized residuals on $A$ (i.e., the best linear slope of residuals versus $A$). Report the numerical value of $b_{\\mathrm{res}}$ as a dimensionless pure number, rounded to four significant figures.", "solution": "The goal is to find the Ordinary Least Squares (OLS) slope, $b_{\\mathrm{res}}$, of the regression of the normalized residuals, $E_i$, on the average log-intensities, $A_i$.\n\n1.  **Define the Residuals:** The residual for the $i$-th spot, $E_i$, is the difference between the observed log-ratio $M_i$ and the predicted value from the quadratic approximation of the LOWESS fit, $\\hat{M}_i = \\alpha + \\beta A_i + \\gamma A_i^2$.\n    $$E_i = M_i - (\\alpha + \\beta A_i + \\gamma A_i^2)$$\n\n2.  **OLS Slope Formula:** The OLS slope for regressing a variable $Y$ on $X$ is:\n    $$b = \\frac{\\left(\\sum X_i Y_i\\right) - \\frac{1}{N}\\left(\\sum X_i\\right)\\left(\\sum Y_i\\right)}{\\left(\\sum X_i^2\\right) - \\frac{1}{N}\\left(\\sum X_i\\right)^2}$$\n    Here, $Y_i = E_i$ and $X_i = A_i$. We need to compute the terms $\\sum E_i$ and $\\sum A_i E_i$.\n\n3.  **Compute $\\sum E_i$:**\n    $$ \\sum_{i=1}^{N} E_i = \\sum M_i - N\\alpha - \\beta \\sum A_i - \\gamma \\sum A_i^2 $$\n    Substituting the given values ($N=10{,}000$, $\\alpha=0.02$, $\\beta=-0.004$, $\\gamma=0.0003$, $\\sum M_i=108.75$, $\\sum A_i=100{,}000$, $\\sum A_i^2=1{,}022{,}500$):\n    $$ \\sum E_i = 108.75 - (10{,}000)(0.02) - (-0.004)(100{,}000) - (0.0003)(1{,}022{,}500) $$\n    $$ = 108.75 - 200 + 400 - 306.75 = 2.0 $$\n\n4.  **Compute $\\sum A_i E_i$:**\n    $$ \\sum_{i=1}^{N} A_i E_i = \\sum A_i M_i - \\alpha \\sum A_i - \\beta \\sum A_i^2 - \\gamma \\sum A_i^3 $$\n    Substituting the given values ($\\sum A_i M_i=1{,}133.0$, $\\sum A_i^3=10{,}675{,}000$):\n    $$ \\sum A_i E_i = 1{,}133.0 - (0.02)(100{,}000) - (-0.004)(1{,}022{,}500) - (0.0003)(10{,}675{,}000) $$\n    $$ = 1{,}133.0 - 2{,}000 + 4{,}090 - 3{,}202.5 = 20.5 $$\n\n5.  **Calculate the Slope $b_{\\mathrm{res}}$:**\n    *   Numerator: $(\\sum A_i E_i) - \\frac{1}{N}(\\sum A_i)(\\sum E_i) = 20.5 - \\frac{1}{10{,}000}(100{,}000)(2.0) = 20.5 - 20 = 0.5$.\n    *   Denominator: $(\\sum A_i^2) - \\frac{1}{N}(\\sum A_i)^2 = 1{,}022{,}500 - \\frac{1}{10{,}000}(100{,}000)^2 = 1{,}022{,}500 - 1{,}000{,}000 = 22{,}500$.\n    *   Slope: $b_{\\mathrm{res}} = \\frac{0.5}{22{,}500} = \\frac{1}{45{,}000} \\approx 0.000022222...$\n\n6.  **Final Answer:** Rounding to four significant figures gives $0.00002222$.", "answer": "$$\\boxed{0.00002222}$$", "id": "2805484"}, {"introduction": "Oligonucleotide arrays use multiple probes to measure the expression of a single gene, but some probes can yield aberrant signals due to issues like cross-hybridization. It is therefore critical to use robust statistical methods that are not skewed by these outliers when summarizing probe-level data into a single gene expression value. This practice walks you through one iteration of Tukey's median polish, a foundational robust algorithm used in methods like RMA, to give you a concrete understanding of how outlier-resistant summarization is achieved. [@problem_id:2805472]", "problem": "In oligonucleotide Deoxyribonucleic Acid (DNA) microarray summarization for a single probeset, the Robust Multi-array Average (RMA) framework models the log-transformed probe intensities by an additive decomposition. Consider the robust additive model for a probeset measured across multiple arrays,\n$$\ny_{ij} \\;=\\; \\mu \\;+\\; \\alpha_i \\;+\\; \\beta_j \\;+\\; \\varepsilon_{ij},\n$$\nwhere $y_{ij}$ is the $\\log_{2}$-transformed intensity for probe $i$ on array $j$, $\\mu$ is the overall level, $\\alpha_i$ is the probe effect, $\\beta_j$ is the chip effect for array $j$ (the summarized expression for that array), and $\\varepsilon_{ij}$ is an error term. Tukey’s median polish is a robust procedure that iteratively estimates $(\\mu, \\{\\alpha_i\\}, \\{\\beta_j\\})$ by alternating median subtractions over rows and columns to mitigate the influence of outliers, consistent with the additivity implied by the $\\log_{2}$ transform.\n\nExplain median polish summarization in this context from the robust additive modeling perspective, and then perform a single iteration of the standard median polish updates (row step followed by column step) on the following $\\log_{2}$ intensity matrix for a single probeset across $3$ arrays:\n$$\nY \\;=\\;\n\\begin{pmatrix}\n8.10 & 8.70 & 9.20 \\\\\n7.95 & 8.40 & 9.05 \\\\\n8.60 & 9.10 & 9.50\n\\end{pmatrix}.\n$$\nUse the following conventions for this iteration:\n- Initialize all effects at zero: $\\mu = 0$, $\\alpha_i = 0$ for all $i$, and $\\beta_j = 0$ for all $j$.\n- Row step: for each row $i$, subtract the median of the current row from every entry in that row and add it to $\\alpha_i$. After completing all rows, center the probe effects by subtracting their median from every $\\alpha_i$ and add that median to $\\mu$.\n- Column step: for each column $j$, subtract the median of the current column from every entry in that column and add it to $\\beta_j$. After completing all columns, center the chip effects by subtracting their median from every $\\beta_j$ and add that median to $\\mu$.\n- Use the usual definition of the median; for an even number of values, take the average of the two middle values.\n\nReport the updated chip effect for array $3$, that is $\\beta_3$, after this single iteration. Express your answer in $\\log_{2}$ intensity units and round your answer to four significant figures.", "solution": "The problem asks for an explanation of median polish and the execution of one iteration of the algorithm on the given matrix.\n\n**Explanation:**\nThe additive model $y_{ij} = \\mu + \\alpha_i + \\beta_j + \\varepsilon_{ij}$ decomposes the $\\log_{2}$-transformed intensity $y_{ij}$ into a global average $\\mu$, a probe-specific effect $\\alpha_i$ (representing its intrinsic affinity), an array-specific effect $\\beta_j$ (the summarized expression value for that array), and a residual error $\\varepsilon_{ij}$. The log transformation is critical as it makes an additive model appropriate for data where errors are often multiplicative. Median polish is a robust method for fitting this model. Unlike standard least-squares regression, which is sensitive to outliers, median polish iteratively subtracts medians from rows and columns. This process minimizes the sum of absolute residuals ($\\sum |\\varepsilon_{ij}|$), providing estimates for the effects that are resistant to aberrant probe intensities.\n\n**Calculation of One Iteration:**\nWe start with the data matrix $Y$ as the initial residual matrix, and all effects set to zero.\n$$ Y = R^{(0)} = \\begin{pmatrix} 8.10 & 8.70 & 9.20 \\\\ 7.95 & 8.40 & 9.05 \\\\ 8.60 & 9.10 & 9.50 \\end{pmatrix}, \\quad \\mu=0, \\alpha = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\beta = \\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix} $$\n\n**1. Row Step:**\n*   **Row 1:** Median is 8.70. Subtract 8.70 from the row. Update $\\alpha_1 \\leftarrow 0 + 8.70 = 8.70$.\n*   **Row 2:** Median is 8.40. Subtract 8.40 from the row. Update $\\alpha_2 \\leftarrow 0 + 8.40 = 8.40$.\n*   **Row 3:** Median is 9.10. Subtract 9.10 from the row. Update $\\alpha_3 \\leftarrow 0 + 9.10 = 9.10$.\nThe matrix becomes:\n$$ R' = \\begin{pmatrix} -0.60 & 0 & 0.50 \\\\ -0.45 & 0 & 0.65 \\\\ -0.50 & 0 & 0.40 \\end{pmatrix} $$\n*   **Center Probe Effects:** The probe effects are now $\\alpha = \\{8.70, 8.40, 9.10\\}$. The median is 8.70. We add this to $\\mu$ ($\\mu \\leftarrow 0 + 8.70 = 8.70$) and subtract it from each $\\alpha_i$:\n    *   $\\alpha_1 \\leftarrow 8.70 - 8.70 = 0$\n    *   $\\alpha_2 \\leftarrow 8.40 - 8.70 = -0.30$\n    *   $\\alpha_3 \\leftarrow 9.10 - 8.70 = 0.40$\n\n**2. Column Step (on matrix $R'$):**\n*   **Column 1:** Values are $\\{-0.60, -0.45, -0.50\\}$. Median is -0.50. Subtract -0.50 from the column. Update $\\beta_1 \\leftarrow 0 + (-0.50) = -0.50$.\n*   **Column 2:** Values are $\\{0, 0, 0\\}$. Median is 0. Subtract 0 from the column. Update $\\beta_2 \\leftarrow 0 + 0 = 0$.\n*   **Column 3:** Values are $\\{0.50, 0.65, 0.40\\}$. Median is 0.50. Subtract 0.50 from the column. Update $\\beta_3 \\leftarrow 0 + 0.50 = 0.50$.\n*   **Center Chip Effects:** The chip effects are now $\\beta = \\{-0.50, 0, 0.50\\}$. The median is 0. We add this to $\\mu$ ($\\mu \\leftarrow 8.70 + 0 = 8.70$) and subtract it from each $\\beta_j$. Since the median is 0, the $\\beta_j$ values do not change.\n    *   $\\beta_1 = -0.50$\n    *   $\\beta_2 = 0$\n    *   $\\beta_3 = 0.50$\n\nThe updated chip effect for array 3 is $\\beta_3 = 0.50$. Rounded to four significant figures, this is $0.5000$.", "answer": "$$\\boxed{0.5000}$$", "id": "2805472"}]}