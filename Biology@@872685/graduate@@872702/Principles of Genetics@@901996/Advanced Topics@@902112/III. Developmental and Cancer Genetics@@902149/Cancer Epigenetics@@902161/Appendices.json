{"hands_on_practices": [{"introduction": "The stability of epigenetic marks like DNA methylation is a dynamic balance between faithful maintenance during cell division and active enzymatic removal. This exercise models these two distinct processes—passive demethylation due to replication-coupled maintenance errors and active enzymatic demethylation—using discrete recurrence relations and continuous differential equations, respectively. By deriving and comparing these models, you will gain a quantitative understanding of how methylation patterns can erode over time, a process often dysregulated in cancer, and practice translating biological mechanisms into mathematical frameworks [@problem_id:2794335].", "problem": "In the context of cancer epigenetics, consider the genome-wide fraction of fully methylated cytosine-phosphate-guanine (CpG) dyads, denoted by $m_t$, measured immediately after the maintenance methylation step at the end of cell cycle $t$. Assume the following fundamental bases:\n- Deoxyribonucleic acid (DNA) replication is semiconservative, producing $2$ daughter copies per pre-replication copy.\n- Maintenance methylation is performed by DNA methyltransferase $1$ (DNMT1), which copies methylation onto the nascent strand at hemimethylated dyads. Let $\\epsilon \\in [0,1)$ be the per-dyad failure probability of DNMT1 on each hemimethylated dyad at each replication (no de novo methylation).\n- Active demethylation refers to enzymatic loss of methyl marks outside of replication, and at the population level its kinetics are governed by first-order mass-action loss with respect to the abundance of fully methylated dyads.\n- The cell cycle duration is $T_c$ (time units), the cell population is large (law of large numbers), and selection, cell death, and locus-specific effects are negligible on the time-scale considered.\n\nTasks:\n- Using only the assumptions above, derive a closed-form recurrence for the passive demethylation-only scenario (no active demethylation) that maps $m_t$ to $m_{t+1}$ across a single cell cycle.\n- Using only the assumptions above, write the deterministic continuous-time model and its solution for the active demethylation-only scenario (no replication), starting from $m(0)$.\n- Define an “equivalent” active demethylation rate constant $k_{\\text{demeth}}$ (units: inverse time) as the unique nonnegative constant such that the active-only model reduces the methylation fraction across a single cell cycle of length $T_c$ by the same multiplicative factor as the passive-only model with maintenance failure probability $\\epsilon$. Derive a closed-form analytic expression for $k_{\\text{demeth}}$ in terms of $\\epsilon$ and $T_c$.\n\nExpress $k_{\\text{demeth}}$ in inverse units of $T_c$. The final answer must be a single closed-form expression. Do not include units in your final boxed answer.", "solution": "The problem as stated is scientifically grounded, internally consistent, and well-posed. It requires the application of fundamental principles of reaction kinetics and discrete-time dynamics to model methylation inheritance. We will execute the derivation as follows.\n\nThe problem is structured into three tasks. We address each in sequence.\n\nFirst, we derive the recurrence relation for the passive demethylation-only scenario. Let $m_t$ be the fraction of CpG dyads that are fully methylated at the end of cell cycle $t$. We assume the state of the system is fully described by this single variable. The cycle consists of replication followed by maintenance methylation.\n$1$. During semiconservative DNA replication, a fully methylated dyad gives rise to two hemimethylated daughter dyads. A dyad that is not fully methylated is assumed to replicate into daughter dyads that are also not fully methylated. Consequently, in a large population, the fraction of dyads that are hemimethylated immediately following replication is $m_t$. The remaining fraction, $1 - m_t$, consists of unmethylated dyads which are not substrates for maintenance methylation.\n$2$. The maintenance methylation process, executed by DNMT1, acts upon the hemimethylated dyads. The probability of successful methylation of the nascent strand at a hemimethylated dyad is $1 - \\epsilon$, where $\\epsilon \\in [0,1)$ is the per-dyad failure probability. A successful event restores the fully methylated state.\nThe fraction of dyads that become fully methylated by the end of cycle $t+1$, denoted $m_{t+1}$, is therefore the fraction of hemimethylated dyads available after replication, $m_t$, multiplied by the probability of successful maintenance, $1-\\epsilon$.\nThus, the recurrence relation is:\n$$m_{t+1} = (1 - \\epsilon) m_t$$\n\nSecond, we formulate the continuous-time model for the active demethylation-only scenario. In this case, there is no replication. Let $m(t)$ represent the fraction of fully methylated dyads at time $t$. The problem states that its dynamics are governed by first-order mass-action loss. This translates to a rate of change, $\\frac{dm(t)}{dt}$, that is proportional to the current fraction $m(t)$.\nThe governing ordinary differential equation is:\n$$ \\frac{dm(t)}{dt} = -k_{\\text{demeth}} m(t) $$\nwhere $k_{\\text{demeth}}$ is the non-negative rate constant for active demethylation. This is a separable first-order linear differential equation. To find the solution starting from an initial condition $m(0)$ at $t=0$, we integrate:\n$$ \\int_{m(0)}^{m(t)} \\frac{d\\mu}{\\mu} = \\int_{0}^{t} -k_{\\text{demeth}} d\\tau $$\nThis yields:\n$$ \\ln(m(t)) - \\ln(m(0)) = -k_{\\text{demeth}} t $$\n$$ \\ln\\left(\\frac{m(t)}{m(0)}\\right) = -k_{\\text{demeth}} t $$\nExponentiating both sides gives the solution for $m(t)$:\n$$ m(t) = m(0) \\exp(-k_{\\text{demeth}} t) $$\n\nThird, we derive the expression for an \"equivalent\" active demethylation rate constant $k_{\\text{demeth}}$. This equivalence is defined by the condition that both the passive and active models result in the same multiplicative reduction in methylation fraction over a single cell cycle of duration $T_c$.\nFor the passive demethylation model, the multiplicative reduction factor over one cycle is obtained from the recurrence relation:\n$$ \\frac{m_{t+1}}{m_t} = 1 - \\epsilon $$\nFor the active demethylation model, the multiplicative reduction factor over a time interval of length $T_c$ is found from its solution:\n$$ \\frac{m(T_c)}{m(0)} = \\frac{m(0) \\exp(-k_{\\text{demeth}} T_c)}{m(0)} = \\exp(-k_{\\text{demeth}} T_c) $$\nEquating these two factors establishes the condition for equivalence:\n$$ \\exp(-k_{\\text{demeth}} T_c) = 1 - \\epsilon $$\nTo solve for $k_{\\text{demeth}}$, we take the natural logarithm of both sides of the equation:\n$$ \\ln\\left(\\exp(-k_{\\text{demeth}} T_c)\\right) = \\ln(1 - \\epsilon) $$\n$$ -k_{\\text{demeth}} T_c = \\ln(1 - \\epsilon) $$\nFinally, isolating $k_{\\text{demeth}}$ yields the closed-form analytic expression:\n$$ k_{\\text{demeth}} = -\\frac{\\ln(1 - \\epsilon)}{T_c} $$\nThis expression is dimensionally correct, with units of inverse time. Since $\\epsilon \\in [0, 1)$, it follows that $1 - \\epsilon \\in (0, 1]$, making $\\ln(1 - \\epsilon)$ a non-positive value. The negative sign in the expression ensures that $k_{\\text{demeth}} \\ge 0$, consistent with its definition as a physical rate constant.", "answer": "$$\\boxed{-\\frac{\\ln(1 - \\epsilon)}{T_c}}$$", "id": "2794335"}, {"introduction": "A key discovery in cancer biology is the role of \"oncometabolites,\" molecules produced by mutated enzymes that drive cancer progression. The oncometabolite 2-hydroxyglutarate (2-HG), resulting from mutant isocitrate dehydrogenase (IDH) enzymes, potently inhibits Ten-Eleven Translocation (TET) enzymes, which are critical for active DNA demethylation. This practice applies the principles of Michaelis-Menten enzyme kinetics to a scenario of competitive inhibition. By calculating the reduction in TET enzyme activity, you will directly quantify how a metabolic alteration can lead to widespread epigenetic dysregulation and a hypermethylation phenotype characteristic of certain cancers [@problem_id:2794383].", "problem": "A Ten-Eleven Translocation (TET) dioxygenase catalyzes the oxidation of 5-methylcytosine (5mC) toward demethylation in an ordered bi-substrate reaction with 5mC and alpha-ketoglutarate ($\\alpha$-ketoglutarate). In an isocitrate dehydrogenase (IDH)-mutant context, the oncometabolite 2-hydroxyglutarate (2-HG) accumulates and inhibits TET by competing with $\\alpha$-ketoglutarate. At a fixed, non-saturating $\\alpha$-ketoglutarate level, this inhibition can be represented as an apparent competitive inhibition with respect to the effective $5\\text{mC}$ substrate, characterized by an apparent inhibition constant $K_{i}^{\\mathrm{app}}$ defined at that $\\alpha$-ketoglutarate concentration.\n\nAssume standard steady-state Michaelis–Menten kinetics with competitive inhibition with respect to the effective $5\\text{mC}$ substrate. You are given the following experimentally determined parameters under a defined nuclear milieu:\n- Maximal catalytic rate $V_{\\max} = 12\\,\\mathrm{fmol}\\,\\mathrm{min}^{-1}$.\n- Michaelis constant for effective $5\\text{mC}$, $K_{m} = 2\\,\\mu\\mathrm{M}$.\n- Effective $5\\text{mC}$ substrate concentration, $\\left[5\\mathrm{mC}\\right] = 1\\,\\mu\\mathrm{M}$.\n- 2-hydroxyglutarate concentration, $\\left[2\\text{-}\\mathrm{HG}\\right] = 500\\,\\mu\\mathrm{M}$.\n- Apparent competitive inhibition constant with respect to the effective $5\\text{mC}$, $K_{i}^{\\mathrm{app}} = 100\\,\\mu\\mathrm{M}$.\n\nStarting from the steady-state assumption and the definition of competitive inhibition with respect to the effective $5\\text{mC}$ substrate, compute the fractional catalytic activity $v/V_{\\max}$ under these conditions.\n\nReport only the fractional activity as an exact simplified fraction with no units. Do not provide explanatory text in your final answer. You may assume that a reduction in $v/V_{\\max}$ corresponds proportionally to a reduction in the demethylation flux through TET.", "solution": "The problem statement has been evaluated and is deemed valid. It presents a well-posed problem in enzyme kinetics, grounded in a recognized biological context. The problem provides a simplified but explicitly defined model—apparent competitive inhibition with respect to the 5-methylcytosine substrate—and supplies all necessary parameters for a unique solution. The instruction to use this simplified model overrides the complexities of the true bi-substrate mechanism, a common and legitimate practice in quantitative biological problems to test understanding of a specific model. We proceed with the solution based on the provided framework.\n\nThe velocity, $v$, of an enzyme-catalyzed reaction in the presence of a competitive inhibitor is described by the Michaelis-Menten equation, modified to account for the inhibitor's effect. The substrate, $S$, and inhibitor, $I$, compete for the enzyme's active site. This competition effectively increases the Michaelis constant, $K_m$, by a factor of $(1 + [I]/K_i)$, where $[I]$ is the inhibitor concentration and $K_i$ is the inhibition constant.\n\nThe equation for the reaction velocity under competitive inhibition is:\n$$v = \\frac{V_{\\max} [S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]}$$\nHere, $V_{\\max}$ is the maximal velocity, $[S]$ is the substrate concentration, and $K_m$ is the Michaelis constant for the substrate.\n\nThe problem asks for the fractional catalytic activity, which is the ratio of the inhibited velocity $v$ to the maximal velocity $V_{\\max}$. We can obtain an expression for this ratio, $v/V_{\\max}$, by dividing both sides of the equation by $V_{\\max}$:\n$$\\frac{v}{V_{\\max}} = \\frac{[S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]}$$\n\nThe problem provides the following parameters based on the specified model of apparent competitive inhibition with respect to the effective 5mC substrate:\n- Substrate: effective 5-methylcytosine, $S = 5\\mathrm{mC}$\n- Substrate concentration: $[S] = \\left[5\\mathrm{mC}\\right] = 1\\,\\mu\\mathrm{M}$\n- Michaelis constant for substrate: $K_m = 2\\,\\mu\\mathrm{M}$\n- Inhibitor: 2-hydroxyglutarate, $I = 2\\text{-}\\mathrm{HG}$\n- Inhibitor concentration: $[I] = \\left[2\\text{-}\\mathrm{HG}\\right] = 500\\,\\mu\\mathrm{M}$\n- Apparent inhibition constant: $K_i = K_{i}^{\\mathrm{app}} = 100\\,\\mu\\mathrm{M}$\n\nWe substitute these values into the expression for the fractional activity. The concentration units ($\\mu\\mathrm{M}$) are consistent and will cancel, yielding a dimensionless fraction as required.\n\n$$\\frac{v}{V_{\\max}} = \\frac{1}{2 \\left(1 + \\frac{500}{100}\\right) + 1}$$\n\nFirst, we simplify the term inside the parentheses, which represents the factor by which the apparent $K_m$ is increased:\n$$1 + \\frac{500}{100} = 1 + 5 = 6$$\n\nNow, we substitute this result back into the denominator of the main expression:\n$$\\frac{v}{V_{\\max}} = \\frac{1}{2(6) + 1}$$\n\nPerforming the multiplication and addition in the denominator:\n$$2(6) + 1 = 12 + 1 = 13$$\n\nTherefore, the fractional catalytic activity is:\n$$\\frac{v}{V_{\\max}} = \\frac{1}{13}$$\n\nThis result represents the fraction of the maximal catalytic rate at which the TET enzyme operates under the specified concentrations of substrate (5mC) and inhibitor (2-HG).", "answer": "$$\\boxed{\\frac{1}{13}}$$", "id": "2794383"}, {"introduction": "Modern single-cell technologies like scATAC-seq allow us to map the chromatin accessibility landscape cell by cell, revealing immense heterogeneity within tumors. A central challenge is to distill this high-dimensional data into meaningful biological concepts. This computational exercise introduces the concept of \"epigenetic entropy,\" which applies principles from information theory to quantify the plasticity or uncertainty of a cell's regulatory state. By implementing the calculation of epigenetic entropy and correlating it with cancer-relevant phenotypes, you will practice a cutting-edge analytical technique used to link the epigenome's state to cell behavior at single-cell resolution [@problem_id:2794361].", "problem": "You are given a conceptual framework rooted in the Central Dogma of Molecular Biology and epigenetic regulation in cancer: chromatin accessibility modulates transcriptional potential and is measurable at regulatory elements (peaks) per cell by assays such as Assay for Transposase-Accessible Chromatin using sequencing (ATAC-seq). You will formalize a per-cell epigenetic entropy from first principles of probability and information theory and then quantify its linear associations with proxies of proliferation and drug resistance. Your task is to write a program that implements the following, demonstrates correctness on a provided test suite, and outputs the required summary metrics.\n\nStart from the following foundational base:\n- The Central Dogma of Molecular Biology asserts directional information flow from deoxyribonucleic acid to ribonucleic acid to protein, and chromatin state is a regulatory layer modulating this flow.\n- A count matrix of accessibility can be interpreted as sampling from an underlying categorical distribution across regulatory states. For a cell, if accessibility is dispersed across many peaks, the uncertainty about regulatory choice is higher than if accessibility is concentrated at a few peaks.\n- Shannon entropy quantifies uncertainty of a discrete distribution and is defined in information theory for a probability vector.\n\nDefinitions to be implemented:\n1. Let $X \\in \\mathbb{R}_{\\ge 0}^{N \\times M}$ denote a nonnegative matrix with $N$ cells and $M$ peaks, where entry $x_{i j}$ is the accessibility count of peak $j$ in cell $i$.\n2. To obtain valid cell-specific categorical probabilities and to handle $0$ counts robustly, use additive Dirichlet smoothing with parameter $\\alpha \\in \\mathbb{R}_{>0}$: define for each cell $i$ and peak $j$ the smoothed probability\n   $$p_{i j} \\coloneqq \\frac{x_{i j} + \\alpha}{\\sum_{k=1}^{M} (x_{i k} + \\alpha)}.$$\n   Note that for any $i$, $\\sum_{j=1}^{M} p_{i j} = 1$ if $\\alpha > 0$.\n3. For each cell $i$, define the per-cell epigenetic entropy (base $e$) as the Shannon entropy of the smoothed distribution normalized by its maximum possible value for $M$ outcomes:\n   $$H_i \\coloneqq \\frac{-\\sum_{j=1}^{M} p_{i j} \\ln(p_{i j})}{\\ln(M)},$$\n   where $\\ln(\\cdot)$ is the natural logarithm, ensuring $H_i \\in [0,1]$.\n4. Given a continuous proliferation score vector $s \\in \\mathbb{R}^{N}$ and a binary drug resistance phenotype vector $r \\in \\{0,1\\}^{N}$ for the same $N$ cells, quantify linear associations using the Pearson product-moment correlation coefficient:\n   $$\\rho(H,s) \\coloneqq \\frac{\\sum_{i=1}^{N} (H_i - \\bar{H})(s_i - \\bar{s})}{\\sqrt{\\sum_{i=1}^{N} (H_i - \\bar{H})^2} \\sqrt{\\sum_{i=1}^{N} (s_i - \\bar{s})^2}},$$\n   $$\\rho(H,r) \\coloneqq \\frac{\\sum_{i=1}^{N} (H_i - \\bar{H})(r_i - \\bar{r})}{\\sqrt{\\sum_{i=1}^{N} (H_i - \\bar{H})^2} \\sqrt{\\sum_{i=1}^{N} (r_i - \\bar{r})^2}},$$\n   which for binary $r$ is the point-biserial correlation. Here $\\bar{H}$, $\\bar{s}$, and $\\bar{r}$ denote sample means.\n\nInputs to implement and test:\n- You must implement the above definitions exactly for the following test suite consisting of three cases, each specifying $X$, $\\alpha$, $s$, and $r$. No physical units are involved; all quantities are dimensionless real numbers.\n\nTest Suite:\n- Case $1$:\n  - $X^{(1)} = \\begin{bmatrix} 5 & 0 & 0 & 0 \\\\ 1 & 1 & 1 & 1 \\\\ 0 & 0 & 5 & 0 \\end{bmatrix}$, with $N=3$, $M=4$.\n  - $\\alpha^{(1)} = 0.5$.\n  - $s^{(1)} = \\begin{bmatrix} 0.2 & 0.8 & 0.5 \\end{bmatrix}^\\top$.\n  - $r^{(1)} = \\begin{bmatrix} 0 & 1 & 0 \\end{bmatrix}^\\top$.\n- Case $2$:\n  - $X^{(2)} = \\begin{bmatrix} 0 & 0 & 0 \\\\ 10 & 0 & 0 \\end{bmatrix}$, with $N=2$, $M=3$.\n  - $\\alpha^{(2)} = 0.01$.\n  - $s^{(2)} = \\begin{bmatrix} 0.0 & 1.0 \\end{bmatrix}^\\top$.\n  - $r^{(2)} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}^\\top$.\n- Case $3$:\n  - $X^{(3)} = \\begin{bmatrix} 3 & 3 & 3 & 3 & 3 \\\\ 10 & 0 & 0 & 0 & 0 \\\\ 2 & 2 & 0 & 0 & 0 \\\\ 0 & 5 & 0 & 5 & 0 \\\\ 0 & 0 & 0 & 0 & 0 \\end{bmatrix}$, with $N=5$, $M=5$.\n  - $\\alpha^{(3)} = 1.0$.\n  - $s^{(3)} = \\begin{bmatrix} 0.9 & 0.1 & 0.5 & 0.7 & 0.95 \\end{bmatrix}^\\top$.\n  - $r^{(3)} = \\begin{bmatrix} 0 & 1 & 0 & 0 & 0 \\end{bmatrix}^\\top$.\n\nRequired computations and outputs:\n- For each case $c \\in \\{1,2,3\\}$, compute the vector $H^{(c)} = \\begin{bmatrix} H_1^{(c)}, \\dots, H_{N^{(c)}}^{(c)} \\end{bmatrix}^\\top$, then compute the following three summary metrics:\n  - The mean normalized epigenetic entropy $\\mu^{(c)} \\coloneqq \\frac{1}{N^{(c)}} \\sum_{i=1}^{N^{(c)}} H_i^{(c)}$.\n  - The Pearson correlation $\\rho^{(c)}_{\\text{prolif}} \\coloneqq \\rho\\!\\left(H^{(c)}, s^{(c)}\\right)$.\n  - The Pearson correlation $\\rho^{(c)}_{\\text{drug}} \\coloneqq \\rho\\!\\left(H^{(c)}, r^{(c)}\\right)$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n  $\\left[\\mu^{(1)}, \\rho^{(1)}_{\\text{prolif}}, \\rho^{(1)}_{\\text{drug}}, \\mu^{(2)}, \\rho^{(2)}_{\\text{prolif}}, \\rho^{(2)}_{\\text{drug}}, \\mu^{(3)}, \\rho^{(3)}_{\\text{prolif}}, \\rho^{(3)}_{\\text{drug}}\\right]$.\n- All outputs must be real numbers (floating point). No additional text or formatting is allowed.\n\nDesign constraints:\n- Implementations must follow the above definitions exactly.\n- Handle edge cases implied by the test suite (e.g., rows of zeros) using the stipulated smoothing with $\\alpha > 0$ so that denominators are nonzero and probabilities strictly positive.\n- The angle unit and physical units are not applicable here.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded, mathematically well-posed, and contains all necessary information for a unique and verifiable solution. The conceptual framework, rooted in cancer epigenetics and information theory, is sound. The definitions are precise and logically consistent. We proceed with the derivation and implementation of the solution.\n\nThe task is to compute, for three distinct cases, a set of metrics derived from a count matrix $X$, a proliferation score vector $s$, and a drug resistance vector $r$. The process involves three main computational stages: (1) calculation of a per-cell probability distribution over regulatory peaks, (2) calculation of a normalized per-cell epigenetic entropy, and (3) calculation of summary statistics, including mean entropy and its correlation with the given cellular phenotypes.\n\nLet us detail each computational stage.\n\n**1. Per-Cell Smoothed Probability Distribution**\n\nGiven a non-negative count matrix $X \\in \\mathbb{R}_{\\ge 0}^{N \\times M}$, where $N$ is the number of cells and $M$ is the number of regulatory peaks, the first step is to convert the raw counts for each cell into a valid probability distribution. The problem specifies the use of additive Dirichlet smoothing with a parameter $\\alpha \\in \\mathbb{R}_{>0}$. This technique addresses the issue of zero counts, which would otherwise lead to undefined logarithms in the subsequent entropy calculation.\n\nFor each cell $i$, corresponding to row $i$ of the matrix $X$, and for each peak $j$, the smoothed probability $p_{ij}$ is defined as:\n$$p_{i j} \\coloneqq \\frac{x_{i j} + \\alpha}{\\sum_{k=1}^{M} (x_{i k} + \\alpha)}$$\nThe denominator is the sum of all smoothed counts for cell $i$. This can be expressed as $(\\sum_{k=1}^{M} x_{ik}) + M\\alpha$. Since $\\alpha > 0$ and $x_{ij} \\ge 0$, the numerator is always positive. The denominator is also always positive, as $M \\ge 1$ (in the test cases, $M \\ge 3$) and $\\alpha > 0$. Consequently, $p_{ij} > 0$ for all $i, j$, and for any given cell $i$, the probabilities sum to unity: $\\sum_{j=1}^{M} p_{ij} = 1$. This yields a valid probability vector $\\mathbf{p}_i = [p_{i1}, p_{i2}, \\dots, p_{iM}]$ for each cell.\n\n**2. Per-Cell Normalized Epigenetic Entropy**\n\nThe uncertainty or dispersion of each cell's regulatory state is quantified using Shannon entropy. For each cell $i$, the epigenetic entropy $H_i$ is calculated based on its probability vector $\\mathbf{p}_i$. The formula provided uses the natural logarithm (base $e$) and normalizes the result by the maximum possible entropy for a discrete distribution with $M$ outcomes, which is $\\ln(M)$. This normalization constrains the entropy to the interval $[0,1]$, facilitating comparisons across different systems.\n\nThe normalized per-cell epigenetic entropy $H_i$ is defined as:\n$$H_i \\coloneqq \\frac{-\\sum_{j=1}^{M} p_{i j} \\ln(p_{i j})}{\\ln(M)}$$\nA value of $H_i=1$ corresponds to a uniform distribution of accessibility across all $M$ peaks (maximum uncertainty), while a value of $H_i$ approaching $0$ corresponds to accessibility being highly concentrated at a single peak (minimum uncertainty). The vector $H \\in \\mathbb{R}^N$ is formed by these per-cell entropy values.\n\n**3. Summary Metrics: Mean and Correlation**\n\nFinally, for each case, three summary metrics are computed from the entropy vector $H$ and the given phenotype vectors $s$ (proliferation) and $r$ (drug resistance).\n\na. **Mean Normalized Epigenetic Entropy ($\\mu$)**: This is the arithmetic mean of the per-cell entropy values, providing a single summary of the average regulatory uncertainty in the cell population.\n$$\\mu \\coloneqq \\frac{1}{N} \\sum_{i=1}^{N} H_i$$\n\nb. **Pearson Correlation ($\\rho$)**: The linear association between the epigenetic entropy $H$ and the phenotype vectors $s$ and $r$ is quantified using the Pearson product-moment correlation coefficient. For two vectors $A = [A_1, \\dots, A_N]^\\top$ and $B = [B_1, \\dots, B_N]^\\top$, the correlation $\\rho(A, B)$ is given by:\n$$\\rho(A,B) \\coloneqq \\frac{\\sum_{i=1}^{N} (A_i - \\bar{A})(B_i - \\bar{B})}{\\sqrt{\\sum_{i=1}^{N} (A_i - \\bar{A})^2} \\sqrt{\\sum_{i=1}^{N} (B_i - \\bar{B})^2}}$$\nwhere $\\bar{A}$ and $\\bar{B}$ are the sample means. This formula is applied to compute $\\rho_{\\text{prolif}} \\coloneqq \\rho(H, s)$ and $\\rho_{\\text{drug}} \\coloneqq \\rho(H, r)$. When one vector is binary, as is the case for $r$, this is known as the point-biserial correlation coefficient.\n\nThese calculations are performed for each of the three test cases provided. The implementation should be robust and handle the arithmetic with sufficient floating-point precision. The use of a numerical library such as `numpy` is highly advisable for efficient and accurate vector and matrix operations.\n\nFor example, in Test Case 1, we have $X^{(1)} = \\begin{bmatrix} 5 & 0 & 0 & 0 \\\\ 1 & 1 & 1 & 1 \\\\ 0 & 0 & 5 & 0 \\end{bmatrix}$, $N=3$, $M=4$, and $\\alpha^{(1)} = 0.5$.\nFor cell 1, the counts are $[5, 0, 0, 0]$. The smoothed counts are $[5.5, 0.5, 0.5, 0.5]$. The sum is $7.0$. The probability vector is $\\mathbf{p}_1 = [5.5/7, 0.5/7, 0.5/7, 0.5/7]$. The resulting entropy is $H_1 \\approx 0.5446$.\nFor cell 2, the counts are $[1, 1, 1, 1]$. The smoothed counts are $[1.5, 1.5, 1.5, 1.5]$. The sum is $6.0$. The probability vector is $\\mathbf{p}_2 = [0.25, 0.25, 0.25, 0.25]$, which is uniform. This leads to the maximum possible normalized entropy, $H_2=1.0$.\nBy symmetry, $H_3=H_1$. The entropy vector is $H^{(1)} \\approx [0.5446, 1.0, 0.5446]^\\top$. From this vector and the supplied $s^{(1)}$ and $r^{(1)}$, the summary metrics are calculated. The mean is $\\mu^{(1)} \\approx 0.6964$. The correlation with $s^{(1)}$ is $\\rho^{(1)}_{\\text{prolif}} \\approx 0.8660$. The correlation with $r^{(1)}$ is $\\rho^{(1)}_{\\text{drug}} = 1.0$. The implementation will generalize this process for all cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the cancer epigenetics problem for a given test suite.\n    Implements calculations for epigenetic entropy and its correlation with\n    phenotypes according to the provided mathematical definitions.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"X\": np.array([[5, 0, 0, 0], [1, 1, 1, 1], [0, 0, 5, 0]], dtype=float),\n            \"alpha\": 0.5,\n            \"s\": np.array([0.2, 0.8, 0.5], dtype=float),\n            \"r\": np.array([0, 1, 0], dtype=float),\n        },\n        {\n            \"X\": np.array([[0, 0, 0], [10, 0, 0]], dtype=float),\n            \"alpha\": 0.01,\n            \"s\": np.array([0.0, 1.0], dtype=float),\n            \"r\": np.array([1, 0], dtype=float),\n        },\n        {\n            \"X\": np.array([[3, 3, 3, 3, 3], [10, 0, 0, 0, 0], [2, 2, 0, 0, 0], [0, 5, 0, 5, 0], [0, 0, 0, 0, 0]], dtype=float),\n            \"alpha\": 1.0,\n            \"s\": np.array([0.9, 0.1, 0.5, 0.7, 0.95], dtype=float),\n            \"r\": np.array([0, 1, 0, 0, 0], dtype=float),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        X = case[\"X\"]\n        alpha = case[\"alpha\"]\n        s = case[\"s\"]\n        r = case[\"r\"]\n\n        N, M = X.shape\n\n        # 1. Calculate smoothed probability matrix P\n        # Additive Dirichlet smoothing\n        X_smoothed = X + alpha\n        \n        # Normalize each row to sum to 1\n        row_sums = X_smoothed.sum(axis=1, keepdims=True)\n        P = X_smoothed / row_sums\n\n        # 2. Calculate per-cell normalized epigenetic entropy H\n        # Calculate Shannon entropy for each cell (row)\n        # The use of PlogP = P * log(P) is safe because smoothing ensures P > 0.\n        shannon_entropy_unnormalized = -np.sum(P * np.log(P), axis=1)\n        \n        # Normalize by the maximum possible entropy, log(M)\n        # Handle M=1 case to avoid log(1)=0 division, although not in test suite.\n        if M > 1:\n            H = shannon_entropy_unnormalized / np.log(M)\n        else:\n            # If M=1, probability is 1, entropy is 0.\n            H = np.zeros(N)\n\n        # 3. Compute summary metrics\n        # Mean normalized epigenetic entropy\n        mu = np.mean(H)\n        \n        # Pearson correlation with proliferation score s\n        # np.corrcoef returns a 2x2 matrix, the correlation is at [0, 1]\n        rho_prolif = np.corrcoef(H, s)[0, 1]\n        \n        # Pearson correlation with drug resistance phenotype r\n        rho_drug = np.corrcoef(H, r)[0, 1]\n        \n        # In the case of only two data points (N=2), if one vector is not constant,\n        # the correlation will be exactly -1 or 1.\n        # Handle potential NaN if a vector has zero variance (not in test suite)\n        if np.isnan(rho_prolif): rho_prolif = 0.0\n        if np.isnan(rho_drug): rho_drug = 0.0\n        \n        all_results.extend([mu, rho_prolif, rho_drug])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2794361"}]}