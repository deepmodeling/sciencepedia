{"hands_on_practices": [{"introduction": "To build a strong understanding of molecular evolution, we begin with the fundamental quantities: the proportion of synonymous differences per synonymous site ($p_S$) and nonsynonymous differences per nonsynonymous site ($p_N$). This exercise guides you through the direct calculation of these values from raw alignment data, along with the \"naive\" estimate of $\\omega$ that results. While this approach overlooks the complexities of multiple substitutions, mastering this foundational calculation is the essential first step toward appreciating more sophisticated models. [@problem_id:2844396]", "problem": "A pairwise alignment of a protein-coding gene between two species spans $100$ codons, for a total of $300$ nucleotide positions. Under the standard genetic code, the gene is annotated with $230$ synonymous sites and $70$ nonsynonymous sites, where a “site” is counted fractionally according to the genetic-code degeneracy and then summed across the gene. In the alignment, there are $70$ observed synonymous differences and $21$ observed nonsynonymous differences.\n\nStarting from the foundational definitions that, in the absence of multiple-hit correction, the observed per-site divergence in each site class equals the number of observed differences divided by the number of sites in that class, and that the nonsynonymous-to-synonymous rate ratio (often denoted $d_{N}/d_{S}$ or $\\omega$) is defined as the ratio of the nonsynonymous substitution rate to the synonymous substitution rate, compute the following quantities without multiple-hit correction:\n- the synonymous divergence per synonymous site, $p_{S}$,\n- the nonsynonymous divergence per nonsynonymous site, $p_{N}$,\n- and the naive rate ratio $\\omega = d_{N}/d_{S}$ using $d_{S}=p_{S}$ and $d_{N}=p_{N}$.\n\nReport all three values as exact rational numbers with no rounding. Provide your final result as a row vector $\\big(p_{S},\\,p_{N},\\,\\omega\\big)$.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens.\n- Length of alignment: $100$ codons, total of $300$ nucleotide positions.\n- Number of synonymous sites: $S = 230$.\n- Number of nonsynonymous sites: $N = 70$.\n- Number of observed synonymous differences: $S_d = 70$.\n- Number of observed nonsynonymous differences: $N_d = 21$.\n- Definition of per-site divergence (without multiple-hit correction): number of observed differences divided by the number of sites in that class. This corresponds to $p_S$ and $p_N$.\n- Definition of nonsynonymous-to-synonymous rate ratio: $\\omega = d_{N}/d_{S}$.\n- Condition for calculation: use the naive assumption that $d_{S}=p_{S}$ and $d_{N}=p_{N}$.\n- Required output: three quantities, $p_S$, $p_N$, and $\\omega$, reported as exact rational numbers in a row vector.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, as it concerns the fundamental concepts of molecular evolution, specifically the calculation of substitution rates. The concepts of synonymous sites ($S$), nonsynonymous sites ($N$), synonymous differences ($S_d$), and nonsynonymous differences ($N_d$) are standard in the field. The provided data are internally consistent; the total number of sites is $S + N = 230 + 70 = 300$, which matches the total number of nucleotide positions in a sequence of $100$ codons ($100 \\text{ codons} \\times 3 \\text{ nucleotides/codon} = 300$). The problem is well-posed, providing all necessary definitions and data to compute a unique solution. The instruction to forgo multiple-hit correction is a valid simplifying assumption for an introductory problem, leading to the calculation of \"p-distance\" for each site class. The problem is objective and contains no ambiguities.\n\nStep 3: Verdict and Action.\nThe problem is valid. The solution will proceed.\n\nThe problem requires the computation of three quantities related to sequence divergence: the synonymous divergence per synonymous site ($p_S$), the nonsynonymous divergence per nonsynonymous site ($p_N$), and the ratio of these rates under a simplifying assumption ($\\omega$).\n\nThe given quantities are:\n- Number of synonymous sites, $S = 230$.\n- Number of nonsynonymous sites, $N = 70$.\n- Number of observed synonymous differences, $S_d = 70$.\n- Number of observed nonsynonymous differences, $N_d = 21$.\n\nThe problem defines the observed per-site divergence for each class as the number of observed differences divided by the number of sites in that class. This gives the definitions for $p_S$ and $p_N$.\n\nFirst, we calculate the synonymous divergence per synonymous site, $p_S$. This is the proportion of synonymous sites that show a difference between the two sequences.\n$$p_S = \\frac{S_d}{S}$$\nSubstituting the given values:\n$$p_S = \\frac{70}{230}$$\nThis fraction can be simplified by dividing the numerator and denominator by their greatest common divisor, which is $10$.\n$$p_S = \\frac{7}{23}$$\n\nSecond, we calculate the nonsynonymous divergence per nonsynonymous site, $p_N$. This is the proportion of nonsynonymous sites at which a difference is observed.\n$$p_N = \\frac{N_d}{N}$$\nSubstituting the given values:\n$$p_N = \\frac{21}{70}$$\nThis fraction can be simplified by dividing the numerator and denominator by their greatest common divisor, which is $7$.\n$$p_N = \\frac{3}{10}$$\n\nThird, we compute the ratio $\\omega = d_N/d_S$. The problem explicitly states to use the naive approximation where the substitution rates $d_N$ and $d_S$ are taken to be equal to the observed divergences $p_N$ and $p_S$, respectively. This simplification ignores the possibility of multiple substitutions occurring at the same site, which would cause an underestimation of the true evolutionary distance, but we must follow the problem's directive.\nTherefore, we set $d_N = p_N$ and $d_S = p_S$. The ratio $\\omega$ is then:\n$$\\omega = \\frac{d_N}{d_S} = \\frac{p_N}{p_S}$$\nSubstituting the previously calculated values for $p_N$ and $p_S$:\n$$\\omega = \\frac{3/10}{7/23}$$\nTo simplify this complex fraction, we multiply the numerator by the reciprocal of the denominator:\n$$\\omega = \\frac{3}{10} \\times \\frac{23}{7} = \\frac{3 \\times 23}{10 \\times 7} = \\frac{69}{70}$$\n\nThe three quantities are $p_S = \\frac{7}{23}$, $p_N = \\frac{3}{10}$, and $\\omega = \\frac{69}{70}$. The problem asks for these to be reported as a row vector $\\big(p_{S},\\,p_{N},\\,\\omega\\big)$.\nThe final result is the vector containing these three exact rational numbers.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{7}{23}  \\frac{3}{10}  \\frac{69}{70} \\end{pmatrix}}$$", "id": "2844396"}, {"introduction": "Observed differences often underestimate the true evolutionary distance, as multiple substitutions at the same site are invisible to simple counting methods. This exercise introduces the Jukes-Cantor (JC69) model, a foundational method for correcting for such multiple hits. By applying this correction to a dataset representing a highly diverged pair of sequences, you will not only practice the mechanics of the model but also confront one of its critical limitations: the problem of saturation, where divergence estimates become unreliable. [@problem_id:2844360]", "problem": "Two orthologous protein-coding sequences have been aligned and sites have been partitioned into synonymous sites and nonsynonymous sites. Let $p_{S}$ denote the observed proportion of nucleotide differences between the two sequences at synonymous sites, and let $p_{N}$ denote the observed proportion at nonsynonymous sites. You are told that $p_{S} = 0.30$ and $p_{N} = 0.05$ for this pair, and that the pair represents a highly diverged comparison.\n\nAssume the single-parameter Jukes–Cantor model (JC69) holds independently on the synonymous-site class and the nonsynonymous-site class. Start from the continuous-time Markov chain (CTMC) representation of JC69: each nucleotide changes to any other nucleotide with equal instantaneous rate, the total rate of leaving a nucleotide state is constant, and the stationary distribution is uniform. From this base, derive the transformation that maps an observed mismatch proportion $p$ to the expected number of substitutions per site $d$ under JC69, and use it to compute the synonymous divergence $d_{S}$ from $p_{S}$ and the nonsynonymous divergence $d_{N}$ from $p_{N}$. Then compute the rate ratio $\\omega = d_{N} / d_{S}$ and briefly evaluate whether $\\omega$ is likely to be reliable given the stated divergence and modeling assumptions.\n\nReport only the numerical value of $\\omega$ as your final answer, rounded to four significant figures. The final answer is unitless. All intermediate reasoning should be shown in your solution, but only the rounded $\\omega$ should be reported as the final answer.", "solution": "The problem is valid. It is a scientifically grounded, well-posed, and objective problem from the field of molecular evolution. All necessary data and model specifications are provided to derive a unique solution based on established principles.\n\nThe task is to compute the ratio $\\omega = d_N / d_S$ using the Jukes-Cantor $1969$ (JC69) model. First, we must derive the transformation that maps an observed proportion of different sites, $p$, to the expected number of substitutions per site, $d$.\n\nThe JC69 model assumes that the instantaneous rate of substitution from any nucleotide to any other specific nucleotide is a constant, $\\alpha$. The rate matrix $Q$ describing this continuous-time Markov process is:\n$$\nQ = \\alpha \\begin{pmatrix}\n-3  1  1  1 \\\\\n1  -3  1  1 \\\\\n1  1  -3  1 \\\\\n1  1  1  -3\n\\end{pmatrix}\n$$\nThe model implies a uniform stationary distribution of nucleotides, $\\pi_i = 1/4$ for $i \\in \\{A, C, G, T\\}$. The total rate of substitution for a single lineage is $3\\alpha$. The evolutionary distance, $d$, between two sequences that diverged from a common ancestor at time $t$ ago is the expected number of substitutions per site along both lineages, which is $d = 2 \\times (3\\alpha t) = 6\\alpha t$.\n\nLet $p(t)$ be the proportion of sites that differ between the two sequences at time $t$. The change in this proportion can be described by a differential equation. A site where nucleotides are the same becomes different if a substitution occurs in either lineage, happening at a total rate of $2 \\times 3\\alpha = 6\\alpha$. A site where nucleotides are different becomes the same if a nucleotide in one lineage mutates to match the nucleotide in the other, happening at a total rate of $2 \\times \\alpha = 2\\alpha$.\nThus, the rate of change of $p$ is:\n$$ \\frac{dp}{dt} = (1 - p) \\cdot (6\\alpha) - p \\cdot (2\\alpha) = 6\\alpha - 8\\alpha p $$\nSolving this linear first-order differential equation with the initial condition $p(0) = 0$ yields:\n$$ p(t) = \\frac{3}{4} \\left(1 - \\exp(-8\\alpha t)\\right) $$\nTo express $p$ in terms of the distance $d$, we substitute $t = d/(6\\alpha)$:\n$$ p = \\frac{3}{4} \\left(1 - \\exp\\left(-8\\alpha \\frac{d}{6\\alpha}\\right)\\right) = \\frac{3}{4} \\left(1 - \\exp\\left(-\\frac{4}{3}d\\right)\\right) $$\nThis equation connects the observable proportion of differences, $p$, to the evolutionary distance, $d$. We must invert this to find $d$ as a function of $p$:\n$$ \\frac{4}{3}p = 1 - \\exp\\left(-\\frac{4}{3}d\\right) $$\n$$ \\exp\\left(-\\frac{4}{3}d\\right) = 1 - \\frac{4}{3}p $$\n$$ -\\frac{4}{3}d = \\ln\\left(1 - \\frac{4}{3}p\\right) $$\n$$ d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p\\right) $$\nThis is the required transformation, which is valid for $p  3/4$.\n\nWe are given $p_S = 0.30$ and $p_N = 0.05$. We apply the derived formula to each class of sites.\n\nFor synonymous sites:\n$$ d_S = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p_S\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}(0.30)\\right) = -\\frac{3}{4} \\ln(1 - 0.40) = -\\frac{3}{4} \\ln(0.60) $$\nNumerically, $d_S \\approx -0.75 \\times (-0.5108256) \\approx 0.383119$.\n\nFor nonsynonymous sites:\n$$ d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p_N\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}(0.05)\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{0.20}{3}\\right) = -\\frac{3}{4} \\ln\\left(\\frac{14}{15}\\right) $$\nNumerically, $d_N \\approx -0.75 \\times (-0.0689929) \\approx 0.0517446$.\n\nThe ratio $\\omega$ is then computed:\n$$ \\omega = \\frac{d_N}{d_S} \\approx \\frac{0.0517446}{0.383119} \\approx 0.135061 $$\n\nFinally, we briefly evaluate the reliability of this estimate. The value of $p_S = 0.30$ indicates significant divergence. As $p$ approaches the saturation point of $3/4$, the variance of the distance estimate $d$ increases dramatically. This means that small sampling errors in the estimation of $p_S$ will be greatly amplified in the calculation of $d_S$. Since $d_S$ is the denominator in the $\\omega$ ratio, the resulting $\\omega$ estimate will have high variance and thus low reliability. Furthermore, the JC69 model is known to be a severe oversimplification of biological reality, as it ignores biases in base composition and substitution types (e.g., transition/transversion bias). Model misspecification introduces systematic error, which becomes more pronounced at higher divergence levels. Therefore, the calculated value of $\\omega$ is likely to be an unreliable estimate of the true selective pressure, primarily due to the high saturation at synonymous sites and the use of an overly simplistic model.\n\nRounding the result to four significant figures gives $\\omega \\approx 0.1351$.", "answer": "$$\\boxed{0.1351}$$", "id": "2844360"}, {"introduction": "A single $\\omega$ value for an entire gene assumes that every site evolves under the same selective pressure, a simplification that is rarely true in nature. This thought experiment challenges you to explore the consequences of this averaging by modeling a gene with distinct classes of sites under different selection regimes. By deriving the site-averaged $\\bar{\\omega}$, you will gain a crucial insight into why this value can mask important underlying signals, such as positive selection acting on a small subset of sites. [@problem_id:2844378]", "problem": "A protein-coding locus is modeled with two site classes that differ in their ratio of nonsynonymous to synonymous substitution rates, where the ratio of nonsynonymous to synonymous substitution rates is defined as $dN/dS$ (commonly denoted $\\omega$). Class $1$ comprises a proportion $p$ of sites with $\\omega_1 = 0.1$ (strong purifying selection), and class $2$ comprises a proportion $1 - p$ of sites with $\\omega_2 = 2.0$ (positive selection). Assume that the synonymous substitution rate per synonymous site, $dS$, is the same across site classes, that the per-site opportunities for synonymous change are comparable between classes, and that the aggregate across-site $dN/dS$ is defined as the expected nonsynonymous substitutions per nonsynonymous site divided by the expected synonymous substitutions per synonymous site, computed by pooling over sites.\n\nUsing only the definitions above and the notion of expectation under a mixture of site classes, derive the across-site average $dN/dS$, denoted $\\bar{\\omega}$, as a simplified function of $p$. Then, briefly explain why this across-site average can fail to reveal the presence of positive selection acting at a subset of sites in this model. Report only the simplified analytic expression for $\\bar{\\omega}$ as your final answer. No numerical rounding is required.", "solution": "The problem requires the derivation of the across-site average ratio of nonsynonymous to synonymous substitution rates, $\\bar{\\omega}$, for a protein-coding locus with two classes of sites.\n\nFirst, we formalize the given information and definitions.\nThe locus consists of two site classes.\nClass $1$: A proportion $p$ of sites are under strong purifying selection with a rate ratio $\\omega_1 = \\frac{dN_1}{dS_1} = 0.1$.\nClass $2$: A proportion $1-p$ of sites are under positive selection with a rate ratio $\\omega_2 = \\frac{dN_2}{dS_2} = 2.0$.\n\nHere, $dN_i$ is the rate of nonsynonymous substitution per nonsynonymous site for class $i$, and $dS_i$ is the rate of synonymous substitution per synonymous site for class $i$. A crucial simplifying assumption is provided: the synonymous substitution rate is identical across all sites, which means $dS_1 = dS_2 = dS$ for some constant rate $dS$.\n\nFrom the definitions of $\\omega_1$ and $\\omega_2$, we can express the nonsynonymous rates for each class in terms of the common synonymous rate $dS$:\n$$ dN_1 = \\omega_1 \\cdot dS_1 = 0.1 \\cdot dS $$\n$$ dN_2 = \\omega_2 \\cdot dS_2 = 2.0 \\cdot dS $$\n\nThe problem defines the aggregate across-site average, $\\bar{\\omega}$, as the ratio of the expected nonsynonymous substitution rate per nonsynonymous site, $E[dN]$, to the expected synonymous substitution rate per synonymous site, $E[dS]$, where the expectation is taken over the distribution of site classes.\n\nThe expected nonsynonymous substitution rate, $E[dN]$, is the weighted average of the rates from the two classes, with weights given by their proportions:\n$$ E[dN] = p \\cdot dN_1 + (1-p) \\cdot dN_2 $$\nSubstituting the expressions for $dN_1$ and $dN_2$:\n$$ E[dN] = p \\cdot (0.1 \\cdot dS) + (1-p) \\cdot (2.0 \\cdot dS) $$\nFactoring out the common term $dS$:\n$$ E[dN] = dS \\cdot [0.1p + 2.0(1-p)] $$\n\nThe expected synonymous substitution rate, $E[dS]$, is calculated similarly:\n$$ E[dS] = p \\cdot dS_1 + (1-p) \\cdot dS_2 $$\nSince $dS_1 = dS_2 = dS$:\n$$ E[dS] = p \\cdot dS + (1-p) \\cdot dS = (p + 1 - p) \\cdot dS = dS $$\nThis result is logical: if the rate is constant across all sites, its expected value is simply that constant.\n\nNow, we construct the aggregate ratio $\\bar{\\omega}$ as defined:\n$$ \\bar{\\omega} = \\frac{E[dN]}{E[dS]} = \\frac{dS \\cdot [0.1p + 2.0(1-p)]}{dS} $$\nThe unknown rate $dS$ cancels from the numerator and denominator, which is a necessary condition for a well-posed problem. This yields:\n$$ \\bar{\\omega} = 0.1p + 2.0(1-p) $$\nSimplifying this expression provides the final function of $p$:\n$$ \\bar{\\omega} = 0.1p + 2.0 - 2.0p $$\n$$ \\bar{\\omega} = 2.0 - 1.9p $$\n\nThe second part of the problem asks why this average, $\\bar{\\omega}$, can fail to reveal the presence of positive selection. Positive selection is typically inferred when the rate ratio is greater than $1$. In this model, class $2$ sites are unequivocally under positive selection because $\\omega_2 = 2.0  1$. However, the site-averaged measure $\\bar{\\omega}$ may be less than or equal to $1$, thus masking this signal.\n\nThis occurs when the contribution from the sites under purifying selection (class $1$, with $\\omega_1 = 0.1  1$) dominates the average. The value of $\\bar{\\omega}$ will be less than $1$ if:\n$$ 2.0 - 1.9p  1 $$\n$$ 1.0  1.9p $$\n$$ p  \\frac{1.0}{1.9} \\approx 0.526 $$\n\nTherefore, if the proportion $p$ of sites under strong purifying selection is greater than approximately $52.6\\%$, the site-averaged $\\bar{\\omega}$ will be less than $1$. For instance, if $p = 0.8$, meaning $80\\%$ of sites are under purifying selection, the average $\\bar{\\omega}$ would be $2.0 - 1.9(0.8) = 2.0 - 1.52 = 0.48$. An observed value of $\\bar{\\omega} = 0.48$ would lead to the naive conclusion that the entire gene is under purifying selection, completely failing to detect the $20\\%$ of sites that are evolving under strong positive selection. This demonstrates a fundamental limitation of using a single, averaged $\\omega$ value for a gene or locus that is heterogeneous in its evolutionary pressures. The averaging process obscures the underlying heterogeneity, particularly when a minority of sites are under a selective pressure that opposes the majority.", "answer": "$$\\boxed{2.0 - 1.9p}$$", "id": "2844378"}]}