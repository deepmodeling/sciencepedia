{"hands_on_practices": [{"introduction": "Understanding speciation requires moving beyond qualitative descriptions of reproductive barriers to their quantitative measurement. This practice introduces a standard framework for dissecting the total reproductive isolation between two species into contributions from sequential life stages, from mating encounters to offspring viability. By analyzing hypothetical experimental data, you will apply a multiplicative model to calculate both stage-specific and cumulative isolation, a core skill for empirical studies in evolutionary biology [@problem_id:2839957].", "problem": "A comparative crossing experiment quantifies the strength of prezygotic and postzygotic reproductive barriers between two species relative to a conspecific baseline. Use the following foundational definitions.\n\n1. Stage-specific reproductive isolation (Reproductive Isolation, RI) at a given stage is defined as the proportional reduction in the heterospecific transition probability relative to the conspecific baseline transition probability at that same stage. If $p_{\\mathrm{H},i}$ is the heterospecific probability of progressing through stage $i$ (conditional on having reached stage $i$) and $p_{\\mathrm{C},i}$ is the corresponding conspecific baseline probability, then the isolation component at stage $i$ is $I_i = 1 - \\dfrac{p_{\\mathrm{H},i}}{p_{\\mathrm{C},i}}$.\n2. The cumulative reproductive isolation across stages is defined multiplicatively as $I_{\\mathrm{total}} = 1 - \\prod_{i} (1 - I_i)$, which is equivalent to one minus the product of the heterospecific-to-conspecific transition ratios across all stages.\n\nYou are provided with the following counts from standardized assays:\n\n- Heterospecific (interspecific) series: mating attempts $100$, copulations $60$, fertilizations $10$, viable offspring $4$.\n- Conspecific baseline series: mating attempts $100$, copulations $95$, fertilizations $90$, viable offspring $85$.\n\nDefine four stages and compute their isolation components using the above framework:\n- Mating (encounter/opportunity): from baseline opportunity to mating attempts.\n- Copulation (premating behavioral/mechanical): from attempts to copulations.\n- Gametic (postmating prezygotic): from copulations to fertilizations.\n- Intrinsic viability (postzygotic): from fertilizations to viable offspring.\n\nThen compute the cumulative isolation $I_{\\mathrm{total}}$ using the multiplicative framework.\n\nReport only the cumulative isolation $I_{\\mathrm{total}}$ as a unitless decimal rounded to four significant figures.", "solution": "The problem defines four discrete stages in the reproductive process and requires the calculation of stage-specific and cumulative reproductive isolation. Let subscript $H$ denote the heterospecific cross and $C$ denote the conspecific cross. The count data for each stage transition is as follows:\n\n- Heterospecific series:\n  - Initial mating attempts: $N_{\\mathrm{attempts, H}} = 100$\n  - Copulations: $N_{\\mathrm{copulations, H}} = 60$\n  - Fertilizations: $N_{\\mathrm{fertilizations, H}} = 10$\n  - Viable offspring: $N_{\\mathrm{offspring, H}} = 4$\n\n- Conspecific series:\n  - Initial mating attempts: $N_{\\mathrm{attempts, C}} = 100$\n  - Copulations: $N_{\\mathrm{copulations, C}} = 95$\n  - Fertilizations: $N_{\\mathrm{fertilizations, C}} = 90$\n  - Viable offspring: $N_{\\mathrm{offspring, C}} = 85$\n\nThe transition probability for a given stage $i$, $p_i$, is the ratio of the number of individuals successfully completing the stage to the number of individuals entering the stage.\n\nThe four stages are defined as:\n1.  **Mating ($I_1$)**: From baseline opportunity to mating attempts.\n2.  **Copulation ($I_2$)**: From attempts to copulations.\n3.  **Gametic ($I_3$)**: From copulations to fertilizations.\n4.  **Intrinsic viability ($I_4$)**: From fertilizations to viable offspring.\n\nWe first calculate the conditional transition probabilities ($p_{\\mathrm{H},i}$ and $p_{\\mathrm{C},i}$) for each stage $i$.\n\n**Stage 1: Mating**\nThe problem defines this stage as the transition from a \"baseline opportunity\" to \"mating attempts\". The number of mating attempts for both series is given as $100$. Let the unstated number of baseline opportunities be $N_{opp}$. As this initial condition is identical for both experimental series, the probabilities are $p_{\\mathrm{H},1} = \\frac{100}{N_{opp}}$ and $p_{\\mathrm{C},1} = \\frac{100}{N_{opp}}$. The ratio $\\frac{p_{\\mathrm{H},1}}{p_{\\mathrm{C},1}} = 1$. The isolation component is $I_1 = 1 - \\frac{p_{\\mathrm{H},1}}{p_{\\mathrm{C},1}} = 1 - 1 = 0$. This indicates no isolation at this stage, as expected from a controlled experimental design.\n\n**Stage 2: Copulation**\nThis is the probability of copulation, given a mating attempt.\n$$ p_{\\mathrm{H},2} = \\frac{N_{\\mathrm{copulations, H}}}{N_{\\mathrm{attempts, H}}} = \\frac{60}{100} = 0.6 $$\n$$ p_{\\mathrm{C},2} = \\frac{N_{\\mathrm{copulations, C}}}{N_{\\mathrm{attempts, C}}} = \\frac{95}{100} = 0.95 $$\n\n**Stage 3: Gametic**\nThis is the probability of fertilization, given a copulation.\n$$ p_{\\mathrm{H},3} = \\frac{N_{\\mathrm{fertilizations, H}}}{N_{\\mathrm{copulations, H}}} = \\frac{10}{60} = \\frac{1}{6} $$\n$$ p_{\\mathrm{C},3} = \\frac{N_{\\mathrm{fertilizations, C}}}{N_{\\mathrm{copulations, C}}} = \\frac{90}{95} = \\frac{18}{19} $$\n\n**Stage 4: Intrinsic Viability**\nThis is the probability of producing a viable offspring, given a fertilization.\n$$ p_{\\mathrm{H},4} = \\frac{N_{\\mathrm{offspring, H}}}{N_{\\mathrm{fertilizations, H}}} = \\frac{4}{10} = 0.4 $$\n$$ p_{\\mathrm{C},4} = \\frac{N_{\\mathrm{offspring, C}}}{N_{\\mathrm{fertilizations, C}}} = \\frac{85}{90} = \\frac{17}{18} $$\n\nThe cumulative reproductive isolation, $I_{\\mathrm{total}}$, is defined as:\n$$ I_{\\mathrm{total}} = 1 - \\prod_{i=1}^{4} (1 - I_i) $$\nwhere $I_i = 1 - \\frac{p_{\\mathrm{H},i}}{p_{\\mathrm{C},i}}$. This means $(1 - I_i) = \\frac{p_{\\mathrm{H},i}}{p_{\\mathrm{C},i}}$.\nTherefore, the formula for cumulative isolation can be expressed as:\n$$ I_{\\mathrm{total}} = 1 - \\left( \\frac{p_{\\mathrm{H},1}}{p_{\\mathrm{C},1}} \\times \\frac{p_{\\mathrm{H},2}}{p_{\\mathrm{C},2}} \\times \\frac{p_{\\mathrm{H},3}}{p_{\\mathrm{C},3}} \\times \\frac{p_{\\mathrm{H},4}}{p_{\\mathrm{C},4}} \\right) $$\nThe product of the ratios of conditional probabilities is equivalent to the ratio of the total probabilities of success across all stages. Let $P_H$ and $P_C$ be the total probabilities of producing a viable offspring from a baseline opportunity.\n$$ P_{\\mathrm{H}} = p_{\\mathrm{H},1} \\times p_{\\mathrm{H},2} \\times p_{\\mathrm{H},3} \\times p_{\\mathrm{H},4} = \\frac{100}{N_{opp}} \\times \\frac{60}{100} \\times \\frac{10}{60} \\times \\frac{4}{10} = \\frac{4}{N_{opp}} $$\n$$ P_{\\mathrm{C}} = p_{\\mathrm{C},1} \\times p_{\\mathrm{C},2} \\times p_{\\mathrm{C},3} \\times p_{\\mathrm{C},4} = \\frac{100}{N_{opp}} \\times \\frac{95}{100} \\times \\frac{90}{95} \\times \\frac{85}{90} = \\frac{85}{N_{opp}} $$\nThe product term in the equation for $I_{\\mathrm{total}}$ simplifies to:\n$$ \\prod_{i=1}^{4} (1 - I_i) = \\frac{P_H}{P_C} = \\frac{4/N_{opp}}{85/N_{opp}} = \\frac{4}{85} $$\nThis result can also be obtained by simply taking the ratio of the final number of viable offspring, since the initial number of opportunities was the same for both series.\n\nNow we compute the final value for $I_{\\mathrm{total}}$:\n$$ I_{\\mathrm{total}} = 1 - \\frac{4}{85} = \\frac{85 - 4}{85} = \\frac{81}{85} $$\nConverting this fraction to a decimal gives:\n$$ I_{\\mathrm{total}} = 0.952941176... $$\nThe problem requires the answer to be rounded to four significant figures. The fifth significant figure is $4$, so we do not round up the fourth digit.\n$$ I_{\\mathrm{total}} \\approx 0.9529 $$\nThis value represents a $95.29\\%$ reduction in reproductive success for the heterospecific cross relative to the conspecific baseline.", "answer": "$$\\boxed{0.9529}$$", "id": "2839957"}, {"introduction": "Reproductive barriers are not always symmetrical; the outcome of a cross can depend strongly on which species acts as the mother or father. This exercise explores the consequences of such asymmetry, a phenomenon often related to Haldane's rule and cytonuclear interactions. You will derive an index from first principles to quantify the directionality of gene flow resulting from asymmetric postzygotic viability, providing insight into how patterns of introgression between species can become biased [@problem_id:2839865].", "problem": "Two incipient species $A$ and $B$ co-occur and occasionally engage in heterospecific matings. Consider only nuclear genes. Assume equal census sizes, equal sex ratios, uniform encounter rates, and no sex bias in mating attempts. There is no prezygotic isolation asymmetry: the probability that a given interspecific encounter results in a successful mating is identical in both reciprocal directions and denoted by $s$ (so $s$ applies equally to $A\\!\\female \\times B\\!\\male$ and $B\\!\\female \\times A\\!\\male$). However, there is postzygotic isolation manifested as reduced survival of first filial generation ($F_{1}$) zygotes to reproductive maturity, which depends on cross direction: viability of $A\\!\\female \\times B\\!\\male$ $F_{1}$ is $0.2$, while viability of $B\\!\\female \\times A\\!\\male$ $F_{1}$ is $0.7$.\n\nAssume that $F_{1}$ offspring are philopatric to the maternal species’ habitat, so that they subsequently mate and backcross within the maternal species’ gene pool. In one generation, define the effective directional nuclear gene flow rates $m_{A \\to B}$ and $m_{B \\to A}$ to be proportional to the expected number of viable $F_{1}$ offspring produced by the corresponding reciprocal cross that then reproduce in the recipient species’ population. Specifically, $m_{A \\to B}$ is determined by $B\\!\\female \\times A\\!\\male$ production of viable $F_{1}$ that remain and reproduce in $B$, and $m_{B \\to A}$ is determined by $A\\!\\female \\times B\\!\\male$ viable $F_{1}$ that remain and reproduce in $A$. You may assume equal $F_{1}$ fertilities across directions and that each viable $F_{1}$ contributes, on average, an equal expected number of successful gametes to the backcrossed population, so that relative differences in $m_{A \\to B}$ and $m_{B \\to A}$ arise solely from the prezygotic mating probability $s$ and postzygotic viability.\n\nUsing the foundational definitions that prezygotic isolation scales the probability of heterospecific mating and postzygotic isolation scales the survival of hybrid $F_{1}$, derive from first principles an expression for the directionality asymmetry index\n$$\nD \\equiv \\frac{m_{A \\to B} - m_{B \\to A}}{m_{A \\to B} + m_{B \\to A}},\n$$\nand then compute its value given the reciprocal cross viabilities above. Express the final answer as an exact fraction (no units). In your derivation, justify how prezygotic and postzygotic components enter $m_{A \\to B}$ and $m_{B \\to A}$, and briefly explain how the sign of $D$ encodes expected directionality of gene flow.", "solution": "The problem asks for the derivation and calculation of a directionality asymmetry index, $D$, for gene flow between two incipient species, designated $A$ and $B$. The index is defined as:\n$$\nD \\equiv \\frac{m_{A \\to B} - m_{B \\to A}}{m_{A \\to B} + m_{B \\to A}}\n$$\nwhere $m_{A \\to B}$ is the effective rate of nuclear gene flow from species $A$ to species $B$, and $m_{B \\to A}$ is the rate in the opposite direction.\n\nAccording to the problem statement, gene flow is mediated by the production of first filial generation ($F_1$) hybrids, which are philopatric to the maternal species' habitat and subsequently backcross into the maternal gene pool. The effective gene flow rate is proportional to the expected number of viable $F_1$ offspring that reach reproductive maturity. This number is a product of two sequential stages: the probability of a successful heterospecific mating (a prezygotic isolation component) and the subsequent survival probability of the resulting hybrid zygotes to adulthood (a postzygotic isolation component).\n\nLet us formalize the expressions for the gene flow rates. The problem states that a single prezygotic isolation parameter, $s$, represents the probability of a successful mating for any given interspecific encounter. There is no prezygotic asymmetry, so $s$ applies to both reciprocal crosses: $A\\!\\female \\times B\\!\\male$ and $B\\!\\female \\times A\\!\\male$. Postzygotic isolation is manifested as differential viability of $F_1$ offspring, which is direction-dependent. Let $v_{AB}$ be the viability of $F_1$ offspring from an $A\\!\\female \\times B\\!\\male$ cross, and $v_{BA}$ be the viability of $F_1$ offspring from a $B\\!\\female \\times A\\!\\male$ cross.\n\nThe rate of gene flow from species $B$ to species $A$, denoted $m_{B \\to A}$, is mediated by males of species $B$ mating with females of species $A$ ($A\\!\\female \\times B\\!\\male$). The resulting $F_1$ hybrids are raised within the maternal species' ($A$) population and backcross to it. The rate $m_{B \\to A}$ is therefore proportional to the product of the prezygotic success of this cross and the postzygotic viability of its offspring.\n$$\nm_{B \\to A} \\propto s \\cdot v_{AB}\n$$\nLet $C$ be the constant of proportionality, which encapsulates factors such as population sizes, encounter rates, and baseline fecundity, all of which are stated to be equal or symmetric for the two species. Thus, we can write:\n$$\nm_{B \\to A} = C \\cdot s \\cdot v_{AB}\n$$\n\nConversely, the rate of gene flow from species $A$ to species $B$, denoted $m_{A \\to B}$, is mediated by males of species $A$ mating with females of species $B$ ($B\\!\\female \\times A\\!\\male$). The resulting $F_1$ hybrids are raised within the maternal species' ($B$) population and backcross to it. The rate $m_{A \\to B}$ is therefore proportional to the product of the prezygotic success of this cross and the postzygotic viability of its offspring.\n$$\nm_{A \\to B} \\propto s \\cdot v_{BA}\n$$\nUsing the same constant of proportionality $C$, we have:\n$$\nm_{A \\to B} = C \\cdot s \\cdot v_{BA}\n$$\n\nNow we substitute these expressions for the gene flow rates into the definition of the asymmetry index $D$:\n$$\nD = \\frac{(C \\cdot s \\cdot v_{BA}) - (C \\cdot s \\cdot v_{AB})}{(C \\cdot s \\cdot v_{BA}) + (C \\cdot s \\cdot v_{AB})}\n$$\nThe term $C \\cdot s$ is a common factor in both the numerator and the denominator. Since there are interspecific matings ($s > 0$) and the species exist ($C > 0$), this factor is non-zero and can be cancelled:\n$$\nD = \\frac{C \\cdot s \\cdot (v_{BA} - v_{AB})}{C \\cdot s \\cdot (v_{BA} + v_{AB})} = \\frac{v_{BA} - v_{AB}}{v_{BA} + v_{AB}}\n$$\nThis is the derived expression for the directionality asymmetry index. It demonstrates that, under the condition of symmetric prezygotic isolation, the asymmetry of gene flow is determined exclusively by the asymmetry in postzygotic viabilities of the reciprocal $F_1$ hybrids. The prezygotic barrier, $s$, scales both directional gene flow rates equally and thus does not contribute to the normalized asymmetry.\n\nThe sign of $D$ indicates the dominant direction of gene flow.\n- If $D > 0$, then $m_{A \\to B} > m_{B \\to A}$, and net gene flow is biased from species $A$ to species $B$.\n- If $D < 0$, then $m_{A \\to B} < m_{B \\to A}$, and net gene flow is biased from species $B$ to species $A$.\n- If $D = 0$, then $m_{A \\to B} = m_{B \\to A}$, and gene flow is symmetric. This occurs if and only if $v_{BA} = v_{AB}$.\n\nWe are given the following values for the postzygotic viabilities:\n- Viability of $A\\!\\female \\times B\\!\\male$ $F_1$ is $v_{AB} = 0.2$.\n- Viability of $B\\!\\female \\times A\\!\\male$ $F_1$ is $v_{BA} = 0.7$.\n\nSubstituting these numerical values into our derived expression for $D$:\n$$\nD = \\frac{0.7 - 0.2}{0.7 + 0.2} = \\frac{0.5}{0.9}\n$$\nTo express this as an exact fraction, we write:\n$$\nD = \\frac{5/10}{9/10} = \\frac{5}{9}\n$$\nSince $D = 5/9 > 0$, the net gene flow is predominantly from species $A$ into species $B$. This is a direct consequence of the higher viability ($0.7$) of the $F_1$ hybrids ($B\\!\\female \\times A\\!\\male$) that mediate this direction of introgression compared to the lower viability ($0.2$) of the reciprocal hybrids ($A\\!\\female \\times B\\!\\male$).", "answer": "$$\n\\boxed{\\frac{5}{9}}\n$$", "id": "2839865"}, {"introduction": "The process of speciation is rarely uniform across the genome; some regions may be resistant to gene flow due to the presence of barrier loci, while others remain porous. This practice simulates a core task in evolutionary genomics: inferring this heterogeneous landscape of divergence from population genetic data. You will develop and apply a simplified isolation-with-migration model to estimate the proportion of the genome affected by reproductive barriers, connecting abstract concepts of isolation to tangible patterns in DNA sequence variation [@problem_id:2839960].", "problem": "A program must infer parameters of a simplified isolation-with-migration model with heterogeneous migration across loci from joint site class spectra, and then quantify the implied distribution of barrier strengths. The biological context is that prezygotic and postzygotic reproductive isolating mechanisms reduce effective interspecific migration at some genomic regions relative to others. The computational task is framed purely in mathematical terms using a mixture model on site classes, with all necessary definitions provided.\n\nDefinitions and modeling assumptions:\n- Consider a joint site class spectrum aggregated into four mutually exclusive and exhaustive categories for two taxa: shared polymorphisms, private polymorphisms in population $1$, private polymorphisms in population $2$, and fixed differences. Let the observed counts be the vector $\\mathbf{C} = [C_{\\mathrm{S}}, C_{\\mathrm{P1}}, C_{\\mathrm{P2}}, C_{\\mathrm{D}}]$ with total $N = C_{\\mathrm{S}} + C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}$.\n- Under an isolation-with-migration scenario with heterogeneous migration across loci, model heterogeneity as a two-class mixture over loci:\n  1. High-migration class (panmictic limit): expected site class probabilities $\\mathbf{v}_{\\mathrm{H}} = [1, 0, 0, 0]$.\n  2. Barrier class (no migration, long-term isolation limit but allowing segregating variation): expected site class probabilities\n     $$\\mathbf{v}_{\\mathrm{B}}(\\phi) = \\left[0,\\ \\frac{\\phi}{2},\\ \\frac{\\phi}{2},\\ 1 - \\phi\\right],$$\n     where $\\phi \\in [0,1]$ parameterizes the proportion of non-shared variation that is polymorphic rather than fixed. Larger $\\phi$ indicates proportionally more private polymorphism relative to fixed differences within the barrier class.\n- Let $w \\in [0,1]$ be the mixture weight for the high-migration class, so that the barrier class has weight $(1 - w)$. The expected site class probabilities are\n  $$\\mathbf{p}(w,\\phi) = w \\cdot \\mathbf{v}_{\\mathrm{H}} + (1 - w)\\cdot \\mathbf{v}_{\\mathrm{B}}(\\phi) = \\left[w,\\ (1 - w)\\frac{\\phi}{2},\\ (1 - w)\\frac{\\phi}{2},\\ (1 - w)(1 - \\phi)\\right].$$\n- Assume sites are independent and identically distributed and that the observed counts $\\mathbf{C}$ are drawn from a multinomial distribution with total $N$ and category probabilities $\\mathbf{p}(w,\\phi)$. This composite-likelihood approximation is a standard starting point in site frequency spectrum analysis.\n\nEstimation objective:\n- For each provided test case $\\mathbf{C}$, estimate the maximum likelihood parameters $(\\widehat{w}, \\widehat{\\phi})$ by maximizing the multinomial likelihood, or equivalently the log-likelihood\n  $$\\ell(w,\\phi \\mid \\mathbf{C}) = C_{\\mathrm{S}}\\log p_{\\mathrm{S}} + C_{\\mathrm{P1}}\\log p_{\\mathrm{P1}} + C_{\\mathrm{P2}}\\log p_{\\mathrm{P2}} + C_{\\mathrm{D}}\\log p_{\\mathrm{D}},$$\n  subject to $w \\in [0,1]$, $\\phi \\in [0,1]$, and $p_{\\mathrm{S}} + p_{\\mathrm{P1}} + p_{\\mathrm{P2}} + p_{\\mathrm{D}} = 1$ as specified above.\n- Interpret the distribution of barrier strengths across loci as a Bernoulli random variable $B$ with support $\\{0,1\\}$, where $B = 0$ denotes high-migration loci (no barrier) and $B = 1$ denotes barrier loci (complete reduction of migration). Under the mixture, the distribution is $P(B=1) = 1 - w$ and $P(B=0) = w$. Report the mean and variance of $B$:\n  $$\\mathbb{E}[B] = 1 - w,\\quad \\mathrm{Var}(B) = w(1 - w).$$\n\nBoundary conventions:\n- If $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}} = 0$ (that is, only shared polymorphisms observed), define $\\widehat{w} = 1$ and set $\\widehat{\\phi} = 0$ by continuity.\n- If $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} > 0$ and $C_{\\mathrm{D}} = 0$, define $\\widehat{\\phi} = 1$.\n- If $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} = 0$ and $C_{\\mathrm{D}} > 0$, define $\\widehat{\\phi} = 0$.\n\nTest suite:\n- Use the following four test cases, each with total sites $N = 1000$:\n  1. $\\mathbf{C}^{(1)} = \\left[800, 80, 70, 50\\right]$.\n  2. $\\mathbf{C}^{(2)} = \\left[400, 200, 190, 210\\right]$.\n  3. $\\mathbf{C}^{(3)} = \\left[50, 250, 260, 440\\right]$.\n  4. $\\mathbf{C}^{(4)} = \\left[1000, 0, 0, 0\\right]$.\n\nRequired computations:\n- For each test case $\\mathbf{C}^{(k)}$, compute $(\\widehat{w}^{(k)}, \\widehat{\\phi}^{(k)})$ that maximize the multinomial likelihood under the model. Then compute the corresponding barrier mean and variance $\\left(\\mathbb{E}[B]^{(k)}, \\mathrm{Var}(B)^{(k)}\\right)$ using the formulas above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a Python-style list of lists. For each test case $k \\in \\{1,2,3,4\\}$, output the list $\\left[\\widehat{w}^{(k)}, \\widehat{\\phi}^{(k)}, \\mathbb{E}[B]^{(k)}, \\mathrm{Var}(B)^{(k)}\\right]$ with each value rounded to six decimal places. Concatenate these lists, in order of the test suite above, inside a single outer list. For example: \"[[0.123456,0.654321,0.876544,0.108721],[...],[...],[...]]\".", "solution": "The objective is to find the parameters $(\\widehat{w}, \\widehat{\\phi})$ that maximize the multinomial log-likelihood function. We substitute the model probabilities into the log-likelihood expression:\n$$ \\ell(w,\\phi) = C_{\\mathrm{S}}\\log(w) + C_{\\mathrm{P1}}\\log\\left((1 - w)\\frac{\\phi}{2}\\right) + C_{\\mathrm{P2}}\\log\\left((1 - w)\\frac{\\phi}{2}\\right) + C_{\\mathrm{D}}\\log((1 - w)(1 - \\phi)) $$\nUsing the properties of logarithms, we can expand and regroup the terms:\n$$ \\ell(w,\\phi) = C_{\\mathrm{S}}\\log(w) + (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\left[\\log(1 - w) + \\log(\\phi) - \\log(2)\\right] + C_{\\mathrm{D}}\\left[\\log(1 - w) + \\log(1 - \\phi)\\right] $$\nCombining terms involving $w$ and $\\phi$:\n$$ \\ell(w,\\phi) = \\left[ C_{\\mathrm{S}}\\log(w) + (C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}})\\log(1-w) \\right] + \\left[ (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(\\phi) + C_{\\mathrm{D}}\\log(1-\\phi) \\right] - (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(2) $$\nFor maximization, we can ignore the constant term $-(C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(2)$. The remaining function is separable, meaning we can maximize the part involving $w$ and the part involving $\\phi$ independently.\n\nLet $L_w(w) = C_{\\mathrm{S}}\\log(w) + (C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}})\\log(1-w)$.\nTo find the maximum, we take the derivative with respect to $w$ and set it to zero:\n$$ \\frac{dL_w}{dw} = \\frac{C_{\\mathrm{S}}}{w} - \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}}{1-w} = 0 $$\n$$ C_{\\mathrm{S}}(1-w) = w(C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}) $$\n$$ C_{\\mathrm{S}} = w(C_{\\mathrm{S}} + C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}) = wN $$\nThe maximum likelihood estimate for $w$ is therefore:\n$$ \\widehat{w} = \\frac{C_{\\mathrm{S}}}{N} $$\n\nLet $L_\\phi(\\phi) = (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})\\log(\\phi) + C_{\\mathrm{D}}\\log(1-\\phi)$.\nTo find the maximum, we take the derivative with respect to $\\phi$ and set it to zero:\n$$ \\frac{dL_\\phi}{d\\phi} = \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}}}{\\phi} - \\frac{C_{\\mathrm{D}}}{1-\\phi} = 0 $$\n$$ (C_{\\mathrm{P1}} + C_{\\mathrm{P2}})(1-\\phi) = C_{\\mathrm{D}}\\phi $$\n$$ C_{\\mathrm{P1}} + C_{\\mathrm{P2}} = \\phi(C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}) $$\nThe maximum likelihood estimate for $\\phi$ is:\n$$ \\widehat{\\phi} = \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}}}{C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}}} $$\nThese analytical solutions are valid when the denominators are non-zero. The provided boundary conditions handle the edge cases.\n- If $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}} = 0$, then $C_S=N$, so $\\widehat{w}=N/N=1$. The denominator for $\\widehat{\\phi}$ is $0$, making it undefined. The problem stipulates $\\widehat{\\phi}=0$ in this case.\n- If $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} > 0$ and $C_{\\mathrm{D}} = 0$, our formula gives $\\widehat{\\phi} = \\frac{C_{\\mathrm{P1}} + C_{\\mathrm{P2}}}{C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + 0} = 1$, which matches the convention.\n- If $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} = 0$ and $C_{\\mathrm{D}} > 0$, our formula gives $\\widehat{\\phi} = \\frac{0}{0 + C_{\\mathrm{D}}} = 0$, which also matches the convention.\n\nThe derived quantities are computed from the estimated parameters:\n$$ \\mathbb{E}[B] = 1 - \\widehat{w} $$\n$$ \\mathrm{Var}(B) = \\widehat{w}(1 - \\widehat{w}) $$\n\n**Computations for Test Cases**\n\nFor each test case $\\mathbf{C}^{(k)} = [C_{\\mathrm{S}}, C_{\\mathrm{P1}}, C_{\\mathrm{P2}}, C_{\\mathrm{D}}]$ with $N=1000$:\n\n1.  **$\\mathbf{C}^{(1)} = [800, 80, 70, 50]$**\n    - $\\widehat{w}^{(1)} = \\frac{800}{1000} = 0.8$\n    - $\\widehat{\\phi}^{(1)} = \\frac{80 + 70}{80 + 70 + 50} = \\frac{150}{200} = 0.75$\n    - $\\mathbb{E}[B]^{(1)} = 1 - 0.8 = 0.2$\n    - $\\mathrm{Var}(B)^{(1)} = 0.8 \\times (1 - 0.8) = 0.16$\n    - Result: $[0.8, 0.75, 0.2, 0.16]$\n\n2.  **$\\mathbf{C}^{(2)} = [400, 200, 190, 210]$**\n    - $\\widehat{w}^{(2)} = \\frac{400}{1000} = 0.4$\n    - $\\widehat{\\phi}^{(2)} = \\frac{200 + 190}{200 + 190 + 210} = \\frac{390}{600} = 0.65$\n    - $\\mathbb{E}[B]^{(2)} = 1 - 0.4 = 0.6$\n    - $\\mathrm{Var}(B)^{(2)} = 0.4 \\times (1 - 0.4) = 0.24$\n    - Result: $[0.4, 0.65, 0.6, 0.24]$\n\n3.  **$\\mathbf{C}^{(3)} = [50, 250, 260, 440]$**\n    - $\\widehat{w}^{(3)} = \\frac{50}{1000} = 0.05$\n    - $\\widehat{\\phi}^{(3)} = \\frac{250 + 260}{250 + 260 + 440} = \\frac{510}{950} \\approx 0.536842$\n    - $\\mathbb{E}[B]^{(3)} = 1 - 0.05 = 0.95$\n    - $\\mathrm{Var}(B)^{(3)} = 0.05 \\times (1 - 0.05) = 0.0475$\n    - Result: $[0.05, 0.536842, 0.95, 0.0475]$\n\n4.  **$\\mathbf{C}^{(4)} = [1000, 0, 0, 0]$**\n    - Here, $C_{\\mathrm{P1}} + C_{\\mathrm{P2}} + C_{\\mathrm{D}} = 0$. We apply the first boundary condition.\n    - $\\widehat{w}^{(4)} = 1.0$\n    - $\\widehat{\\phi}^{(4)} = 0.0$\n    - $\\mathbb{E}[B]^{(4)} = 1 - 1.0 = 0.0$\n    - $\\mathrm{Var}(B)^{(4)} = 1.0 \\times (1 - 1.0) = 0.0$\n    - Result: $[1.0, 0.0, 0.0, 0.0]$\n\nThe implementation will follow this logic to compute and format the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes maximum likelihood estimates for a simplified isolation-with-migration model\n    and derived barrier strength statistics for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # C_S, C_P1, C_P2, C_D\n        (800, 80, 70, 50),\n        (400, 200, 190, 210),\n        (50, 250, 260, 440),\n        (1000, 0, 0, 0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        c_s, c_p1, c_p2, c_d = case\n        n = c_s + c_p1 + c_p2 + c_d\n\n        c_non_shared = c_p1 + c_p2 + c_d\n\n        if c_non_shared == 0:\n            # This corresponds to boundary condition 1: C_P1 + C_P2 + C_D = 0\n            # Then N = C_S, so w_hat = C_S / N = 1.\n            # phi_hat is non-identifiable, set to 0 by convention.\n            w_hat = 1.0\n            phi_hat = 0.0\n        else:\n            # General case for MLEs derived in the solution\n            w_hat = c_s / n\n            \n            c_priv_poly = c_p1 + c_p2\n            phi_hat = c_priv_poly / c_non_shared\n            # This general formula correctly handles boundary conditions 2 and 3:\n            # If C_D = 0, phi_hat = c_priv_poly / c_priv_poly = 1.\n            # If c_priv_poly = 0, phi_hat = 0 / C_D = 0.\n\n        # Calculate the mean and variance of the barrier strength distribution\n        mean_b = 1.0 - w_hat\n        var_b = w_hat * (1.0 - w_hat)\n        \n        result_tuple = (w_hat, phi_hat, mean_b, var_b)\n        all_results.append(result_tuple)\n\n    # Format the results into a single string as required.\n    # Each sublist is formatted as a string without spaces, e.g., \"[v1,v2,v3,v4]\".\n    # Each value is formatted to six decimal places.\n    list_of_strings = [\n        f\"[{','.join(f'{val:.6f}' for val in result)}]\" for result in all_results\n    ]\n    \n    # The final output is a string representation of a list of these string-lists.\n    final_output_string = f\"[{','.join(list_of_strings)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2839960"}]}