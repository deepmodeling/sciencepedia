{"hands_on_practices": [{"introduction": "Understanding gene expression begins with a clear grasp of the physical relationship between a gene's primary transcript and its final, mature form. This fundamental exercise challenges you to calculate the lengths of a precursor messenger RNA (pre-mRNA) and its corresponding mature mRNA based on a simple gene model. By working through this calculation, you will solidify your understanding of how introns are removed during splicing to produce a compact, protein-coding message. [@problem_id:2946374]", "problem": "A single eukaryotic gene has three annotated exons with lengths $[100, 150, 200]$ nucleotides (nt) and two annotated introns with lengths $[1000, 500]$ nt. Assume that transcription by RNA polymerase II produces a precursor messenger ribonucleic acid (pre-mRNA) that includes all exonic and intronic sequences, and that messenger ribonucleic acid (mRNA) maturation removes introns by precise exon–exon ligation without altering exon lengths. Ignore the $5^{\\prime}$ cap and the $3^{\\prime}$ polyadenosine tail (that is, do not include non-templated additions in the mature mRNA length).\n\nStarting only from the following foundational facts:\n- In the Central Dogma of molecular biology, deoxyribonucleic acid (DNA) is transcribed into RNA; for protein-coding genes, the primary transcript (pre-mRNA) contains both exons and introns.\n- Exons are the transcribed segments retained in the mature mRNA; introns are the transcribed segments removed by splicing.\n- In the absence of alternative splicing and without RNA editing or end trimming, the mature mRNA body length (excluding the $5^{\\prime}$ cap and the $3^{\\prime}$ polyadenosine tail) equals the sum of exon lengths, and the pre-mRNA length equals the sum of exon and intron lengths.\n\nDerive expressions for the pre-mRNA length and the mature mRNA length in terms of the given exon and intron lengths, and compute their numerical values. Report both lengths in nucleotides. Present your final answer as a two-entry row vector $\\big[L_{\\text{pre}},\\,L_{\\text{mature}}\\big]$. No rounding is required.", "solution": "The problem is subjected to rigorous validation.\n\nStep 1: Extract Givens.\n- A single eukaryotic gene possesses $3$ exons.\n- The lengths of the exons are given as a set $E = \\{100, 150, 200\\}$ nucleotides (nt).\n- The gene possesses $2$ introns.\n- The lengths of the introns are given as a set $I = \\{1000, 500\\}$ nt.\n- The initial transcript is a precursor messenger ribonucleic acid (pre-mRNA) that includes all exonic and intronic sequences.\n- The mature messenger ribonucleic acid (mRNA) is formed by the removal of all introns and precise ligation of exons, with exon lengths remaining unchanged.\n- The $5^{\\prime}$ cap and $3^{\\prime}$ polyadenosine tail are to be excluded from all length calculations.\n- Foundational Principle 1: The pre-mRNA transcript contains both exons and introns.\n- Foundational Principle 2: Exons are retained in mature mRNA; introns are removed.\n- Foundational Principle 3: The length of the mature mRNA body is the sum of exon lengths. The length of the pre-mRNA is the sum of all exon and intron lengths.\n- The objective is to derive expressions for the pre-mRNA length, denoted $L_{\\text{pre}}$, and the mature mRNA length, denoted $L_{\\text{mature}}$, and to compute their numerical values. The result is to be presented as a two-entry row vector.\n\nStep 2: Validate Using Extracted Givens.\nThe problem statement is evaluated for validity.\n- **Scientifically Grounded:** The problem describes the canonical process of transcription and splicing of a eukaryotic gene, a fundamental concept in molecular and cell biology. The provided lengths for exons and introns are biologically plausible. The foundational facts are correct representations of established principles. The problem is scientifically sound.\n- **Well-Posed:** All necessary data (exon lengths, intron lengths) and definitions are explicitly provided. The assumptions, such as ignoring the cap and tail and assuming no alternative splicing, create a clear and solvable model. A unique solution exists. The problem is well-posed.\n- **Objective:** The problem is stated using precise, quantitative, and unbiased language. There are no subjective or ambiguous terms.\n\nStep 3: Verdict and Action.\nThe problem is scientifically grounded, well-posed, objective, and internally consistent. It is deemed **valid**. A solution will be derived.\n\nThe derivation proceeds from the foundational principles provided. Let the set of exon lengths be $\\{E_i\\}_{i=1}^{N_e}$, where $N_e$ is the number of exons. Let the set of intron lengths be $\\{I_j\\}_{j=1}^{N_i}$, where $N_i$ is the number of introns.\n\nBased on the problem statement, the length of the precursor messenger RNA, $L_{\\text{pre}}$, is defined as the total length of the transcribed region, which includes all exons and introns. Therefore, its length is the sum of the lengths of all individual exons and introns.\n$$L_{\\text{pre}} = \\sum_{i=1}^{N_e} E_i + \\sum_{j=1}^{N_i} I_j$$\n\nThe length of the mature messenger RNA, $L_{\\text{mature}}$, is defined as the length of the transcript after the process of splicing, which removes all intronic sequences. The mature mRNA consists only of the ligated exons.\n$$L_{\\text{mature}} = \\sum_{i=1}^{N_e} E_i$$\n\nThe problem provides the specific values for the exon and intron lengths.\nFor the exons, $N_e = 3$, and the lengths are $E_1 = 100$ nt, $E_2 = 150$ nt, and $E_3 = 200$ nt.\nFor the introns, $N_i = 2$, and the lengths are $I_1 = 1000$ nt and $I_2 = 500$ nt.\n\nFirst, we compute the total length of the exons, which corresponds to the length of the mature mRNA.\n$$L_{\\text{mature}} = \\sum_{i=1}^{3} E_i = E_1 + E_2 + E_3$$\n$$L_{\\text{mature}} = 100 + 150 + 200 = 450 \\text{ nt}$$\n\nNext, we compute the total length of the introns. Let this be $L_{\\text{introns}}$.\n$$L_{\\text{introns}} = \\sum_{j=1}^{2} I_j = I_1 + I_2$$\n$$L_{\\text{introns}} = 1000 + 500 = 1500 \\text{ nt}$$\n\nFinally, we compute the length of the pre-mRNA by summing the total length of exons and the total length of introns.\n$$L_{\\text{pre}} = L_{\\text{mature}} + L_{\\text{introns}}$$\n$$L_{\\text{pre}} = 450 + 1500 = 1950 \\text{ nt}$$\n\nThe computed values are $L_{\\text{pre}} = 1950$ nt and $L_{\\text{mature}} = 450$ nt. The problem requires the result to be presented as a two-entry row vector $\\begin{pmatrix} L_{\\text{pre}} & L_{\\text{mature}} \\end{pmatrix}$.\n\nThus, the final vector is $\\begin{pmatrix} 1950 & 450 \\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 1950 & 450 \\end{pmatrix}}$$", "id": "2946374"}, {"introduction": "While the basic model of splicing involves simply removing all introns, the reality is a highly regulated process governed by specific sequence signals and a complex molecular machine, the spliceosome. This exercise moves beyond simple calculation to explore the functional consequences of a mutation in a critical splice site signal, a scenario frequently encountered in the study of genetic disorders. You will apply your knowledge of splice site recognition, cryptic splice sites, and splicing regulatory elements to predict the molecular outcome of this mutation, developing critical thinking skills for diagnosing splicing defects. [@problem_id:2946319]", "problem": "You are analyzing a human pre-messenger RNA (pre-mRNA) containing a canonical $5'$ donor of a $\\text{GT-AG}$ intron (genomic DNA notation), which in the RNA corresponds to a $5'$ splice site beginning with $\\text{GU}$ at positions $+1$ and $+2$. In a wild-type allele, the local sequence context around the exon–intron junction of exon $3$ conforms to the mammalian $5'$ splice site consensus in the following simplified representation (positions relative to the exon–intron boundary are indicated by negative for exonic and positive for intronic coordinates):\n- Exon $3$ positions $-3$ to $-1$: $5'$-C A G-$3'$\n- Intron $3$ positions $+1$ to $+6$: $5'$-G U A A G U-$3'$\nThus, the wild-type junction is schematized as C A G|G U A A G U, where “|” marks the exon–intron boundary.\n\nA patient carries a point mutation changing the invariant $+1$ guanine to adenine in genomic DNA, i.e., $\\text{G}\\to\\text{A}$ at $+1$. In the pre-mRNA, this converts the initial $5'$ splice site dinucleotide from $\\text{GU}$ to $\\text{AU}$ at positions $+1$ and $+2$ relative to the exon–intron junction.\n\nTwo nearby $5'$ splice-site-like motifs are present:\n- An exonic cryptic donor located $8$ nucleotides upstream of the canonical junction (i.e., centered at position $-8$) with sequence $5'$-C A G|G U G A G U-$3'$, where “|” indicates a potential cryptic exon–intron boundary within exon $3$. This site is flanked by multiple exonic splicing enhancer (ESE) motifs (e.g., $5'$-G A A G A A-$3'$ repeats) known to recruit serine/arginine-rich (SR) proteins.\n- An intronic cryptic donor located $15$ nucleotides downstream (positions $+15$ to $+20$) with sequence $5'$-C A G|G U U A C U-$3'$, but overlapped by an exonic/intronic splicing silencer motif bound by heterogeneous nuclear ribonucleoprotein A1 (hnRNP A1).\n\nAssume the following well-tested facts: (i) $5'$ splice site recognition in metazoans initiates by Watson–Crick base pairing between the $5'$ end of U1 small nuclear ribonucleoprotein (U1 snRNP; the RNA component is U1 small nuclear RNA (snRNA)) and the pre-mRNA positions $+1$ through approximately $+6$, with a near-invariant requirement for $\\text{G}$ at $+1$ and $\\text{U}$ at $+2$; (ii) SR proteins bound to ESEs stabilize U1 snRNP recruitment, whereas hnRNP A1 bound to silencers antagonizes it; and (iii) exon definition in mammalian cells couples recognition of both splice sites flanking an exon but still requires an adequately recognized donor.\n\nWhich option best describes the expected consequences of the $+1$ $\\text{G}\\to\\text{A}$ mutation on U1 snRNP binding and splicing outcome, including the likelihood of cryptic donor usage and its coding consequence?\n\nA. The $+1$ $\\text{G}\\to\\text{A}$ substitution abolishes productive U1 snRNP pairing at the canonical donor, shifting initial recognition to the exonic cryptic donor at $-8$ (C A G|G U G A G U), whose $\\text{GU}$ at $+1,+2$ and flanking ESE-bound SR proteins favor its selection. The mRNA will lack the last $8$ nucleotides of exon $3$, inducing a frameshift and likely nonsense-mediated decay.\n\nB. U1 snRNP can maintain binding at the canonical donor via a tolerated wobble at $+1$ (A–U), so splicing proceeds largely normally with only minor efficiency loss; cryptic donors are not activated, and the coding sequence remains unchanged.\n\nC. The mutation increases U1 snRNP affinity for the intronic cryptic donor at $+15$ due to its proximity to the $5'$ cap, promoting selection of the intronic cryptic donor and yielding partial intron retention in the mRNA.\n\nD. Because exon definition requires an intact donor, the spliceosome bypasses exon $3$ entirely, causing exon $3$ skipping as the dominant outcome rather than activating any nearby cryptic donors, leading to an in-frame exon skip if exon $3$ length is divisible by $3$.\n\nE. U6 small nuclear RNA (snRNA) compensates for impaired U1 snRNP recognition at an early stage, restoring normal use of the canonical donor; splicing and coding sequence remain unchanged.", "solution": "The problem statement must first be validated for scientific soundness and logical consistency.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n1.  **System**: A human pre-messenger RNA (pre-mRNA) with a canonical $5'$ donor of a $\\text{GT-AG}$ intron.\n2.  **Wild-Type (WT) Splice Site**: The junction between exon $3$ and intron $3$ is described as C A G|G U A A G U, where '|' is the exon-intron boundary. The exonic part is $5'$-C A G-$3'$ (positions $-3$ to $-1$) and the intronic part is $5'$-G U A A G U-$3'$ (positions $+1$ to $+6$). The canonical $\\text{GU}$ dinucleotide is at positions $+1$ and $+2$.\n3.  **Mutation**: A point mutation in the genomic DNA results in a $\\text{G}\\to\\text{A}$ change at the $+1$ intronic position. In the pre-mRNA, this changes the $5'$ splice site dinucleotide from $\\text{GU}$ to $\\text{AU}$.\n4.  **Cryptic Splice Site 1 (Exonic)**: Located at position $-8$. Its sequence is $5'$-C A G|G U G A G U-$3'$. It is flanked by exonic splicing enhancer (ESE) motifs, which recruit serine/arginine-rich (SR) proteins.\n5.  **Cryptic Splice Site 2 (Intronic)**: Located at position $+15$. Its sequence is $5'$-C A G|G U U A C U-$3'$. It is overlapped by a splicing silencer motif bound by heterogeneous nuclear ribonucleoprotein A1 (hnRNP A1).\n6.  **Established Facts**:\n    (i) $5'$ splice site recognition requires base pairing between U1 snRNA and pre-mRNA positions $+1$ through $\\approx +6$, with a \"near-invariant requirement for $\\text{G}$ at $+1$ and $\\text{U}$ at $+2$.\"\n    (ii) SR proteins recruiting to ESEs stabilize U1 snRNP binding. hnRNP A1 recruiting to silencers antagonizes it.\n    (iii) Exon definition requires a recognized donor site.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the required criteria:\n-   **Scientifically Grounded**: The problem describes the fundamental process of pre-mRNA splicing in metazoans, including the roles of consensus splice site sequences ($\\text{GU-AG}$ rule), the U1 snRNP, cryptic splice sites, and cis-regulatory elements (ESEs and splicing silencers) with their trans-acting factors (SR proteins and hnRNPs). The described mutation ($\\text{G}\\to\\text{A}$ at the $+1$ position of a donor site) is a classic example of a mutation that disrupts splicing. All provided facts are consistent with established principles of molecular and cell biology.\n-   **Well-Posed**: The problem sets up a clear \"what-if\" scenario: a specific mutation in a well-defined molecular context. It asks for the most likely consequence based on a given set of rules. This allows for a logical deduction of a single best answer.\n-   **Objective**: The language is technical, precise, and devoid of subjectivity. Terms like \"$+1$ position\", \"U1 snRNP\", and \"ESE\" have unambiguous meanings in the field.\n\nThe problem statement does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, and well-posed.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation of Solution\nThe task is to predict the molecular consequences of the $+1$ $\\text{G}\\to\\text{A}$ mutation at the canonical $5'$ splice donor site of intron $3$.\n\n1.  **Effect on the Canonical Splice Site**: The mutation changes the sequence at the exon-intron junction from C A G|**G** U A A G U to C A G|**A** U A A G U. According to Fact (i), recognition of the $5'$ splice site is initiated by base-pairing with the U1 snRNA, and there is a \"near-invariant requirement\" for a guanine ($\\text{G}$) at the $+1$ position. The $5'$ end of U1 snRNA, which performs this recognition, has a consensus sequence $5'$-A U A C C U U...$3'$. It pairs with the splice donor site as follows in the wild-type case:\n    $$\n    \\text{pre-mRNA} \\quad 5' \\quad \\dots \\text{A G} | \\mathbf{G U A A G U} \\quad \\dots \\quad 3' \\\\\n    \\qquad \\qquad \\qquad \\qquad \\quad || |.| || \\\\\n    \\text{U1 snRNA} \\quad 3' \\quad \\dots \\text{U C C A U A} \\quad \\dots \\quad 5'\n    $$\n    The crucial $\\text{G}$ at $+1$ forms a canonical Watson-Crick base pair with a cytosine ($\\text{C}$) in the U1 snRNA. The mutation to adenine ($\\text{A}$) at $+1$ would create an A-C mismatch, which severely destabilizes the U1 snRNA:pre-mRNA duplex. This effectively abolishes productive U1 snRNP binding at the canonical donor site.\n\n2.  **Evaluation of Alternative (Cryptic) Splice Sites**: With the canonical site inactivated, the splicing machinery will scan the local sequence for alternative sites that can be recognized by U1 snRNP. The problem presents two such sites:\n    -   **Exonic Cryptic Donor at $-8$**: Sequence is $5'$-C A G|G U G A G U-$3'$. This site contains the essential $\\text{GU}$ dinucleotide at its potential $+1$ and $+2$ positions, making it recognizable by U1 snRNP. Critically, it is flanked by ESEs that recruit SR proteins. According to Fact (ii), SR proteins *stabilize* U1 snRNP recruitment. This site is therefore not only a potential substrate but is also actively promoted.\n    -   **Intronic Cryptic Donor at $+15$**: Sequence is $5'$-C A G|G U U A C U-$3'$. This site also contains the essential $\\text{GU}$ dinucleotide. However, it is overlapped by a splicing silencer motif bound by hnRNP A1. According to Fact (ii), hnRNP A1 *antagonizes* U1 snRNP recruitment. This site is therefore actively repressed.\n\n3.  **Selection of the Most Likely Splice Site**: Comparing the two cryptic sites, the exonic donor at $-8$ is strongly favored. It has the correct core sequence and is located in a context of positive regulation (enhancers). The intronic donor at $+15$, despite having the core sequence, is in a context of negative regulation (silencers). Therefore, the splicing machinery is most likely to select the cryptic donor at $-8$.\n\n4.  **Consequences on mRNA and Protein**: Splicing at the $-8$ cryptic site means the cut is made $8$ nucleotides upstream of the original exon-intron boundary. These $8$ nucleotides, which belong to exon $3$ in the wild-type transcript, are now treated as part of the intron and are removed. The resulting mature mRNA will have an exon $3$ that is shortened by $8$ nucleotides at its $3'$ end.\n    A deletion of $8$ nucleotides is not a multiple of $3$ ($8 \\pmod 3 = 2$). This will cause a frameshift in the translation of the mRNA downstream of the mutation. A frameshift almost invariably leads to the creation of a premature termination codon (PTC). An mRNA containing a PTC is recognized by the cell's surveillance machinery and targeted for degradation via the nonsense-mediated decay (NMD) pathway.\n\n### Evaluation of Options\n\n**A. The $+1$ $\\text{G}\\to\\text{A}$ substitution abolishes productive U1 snRNP pairing at the canonical donor, shifting initial recognition to the exonic cryptic donor at $-8$ (C A G|G U G A G U), whose $\\text{GU}$ at $+1,+2$ and flanking ESE-bound SR proteins favor its selection. The mRNA will lack the last $8$ nucleotides of exon $3$, inducing a frameshift and likely nonsense-mediated decay.**\nThis statement is fully consistent with our derivation. It correctly identifies the inactivation of the canonical site, the selection of the enhanced exonic cryptic site over the repressed intronic one, the resulting deletion of $8$ nucleotides from exon $3$, and the downstream consequences of a frameshift and NMD.\n**Verdict: Correct.**\n\n**B. U1 snRNP can maintain binding at the canonical donor via a tolerated wobble at $+1$ (A–U), so splicing proceeds largely normally with only minor efficiency loss; cryptic donors are not activated, and the coding sequence remains unchanged.**\nThis is incorrect. The pairing at position $+1$ is with a cytosine in U1 snRNA, not a uracil. The resulting A-C mismatch is not a wobble pair and is highly disruptive. The problem explicitly states a \"near-invariant requirement for $\\text{G}$ at $+1$,\" contradicting the idea that an A would be tolerated. Splicing will be severely impaired, not proceed normally.\n**Verdict: Incorrect.**\n\n**C. The mutation increases U1 snRNP affinity for the intronic cryptic donor at $+15$ due to its proximity to the $5'$ cap, promoting selection of the intronic cryptic donor and yielding partial intron retention in the mRNA.**\nThis is incorrect. First, proximity to the $5'$ cap is not a primary factor for splice site choice in this context. Second, and more importantly, the intronic cryptic site is bound by the repressor protein hnRNP A1, which *antagonizes* U1 snRNP binding. Its selection is therefore highly unlikely.\n**Verdict: Incorrect.**\n\n**D. Because exon definition requires an intact donor, the spliceosome bypasses exon $3$ entirely, causing exon $3$ skipping as the dominant outcome rather than activating any nearby cryptic donors, leading to an in-frame exon skip if exon $3$ length is divisible by $3$.**\nWhile exon skipping is a possible outcome of splice site mutations, it is not the *most likely* outcome when a strong, positively regulated cryptic splice site is available, as is the case here with the site at $-8$. The problem is constructed to highlight the competition between cryptic sites. The presence of an ESE-flanked cryptic donor makes its activation a more probable event than complete exon skipping. The option's claim that cryptic donors are not activated is a strong assertion that contradicts the provided information.\n**Verdict: Incorrect.**\n\n**E. U6 small nuclear RNA (snRNA) compensates for impaired U1 snRNP recognition at an early stage, restoring normal use of the canonical donor; splicing and coding sequence remain unchanged.**\nThis misrepresents the temporal order of spliceosome assembly. U1 snRNP carries out the initial recognition of the $5'$ splice site. U6 snRNA is a component of the catalytic core that acts much later in the process, after U1 has bound and been subsequently displaced. U6 cannot \"compensate\" for a failure in the initial U1 binding step. If U1 does not bind, the pathway is aborted at that site before U6 becomes involved.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2946319"}, {"introduction": "The ultimate goal of studying splicing is often to understand how its regulation and misregulation affect cellular function, which requires quantitative measurement of splicing outcomes. This advanced practice bridges theory with modern experimental analysis by tasking you with designing a computational pipeline to analyze RNA sequencing (RNA-seq) data. You will develop an algorithm to quantify a 'Percent Spliced In' ($\\Psi$) value for a cassette exon, learning how split-read alignments provide direct evidence for specific splicing isoforms and how to transform this raw data into a meaningful biological metric. [@problem_id:2946390]", "problem": "You are tasked with designing and implementing a principled, self-contained computational pipeline that, given abstracted alignments from RNA sequencing (RNA-seq), detects exon-exon junctions using split reads and quantifies the percent spliced in, denoted by the Greek letter $\\Psi$, for a single alternative cassette exon event. Your design must be grounded in fundamental biological definitions and observations and be implemented as a complete, runnable program.\n\nStart from the following fundamental base for molecular and cell biology:\n\n- Precursor messenger ribonucleic acid (pre-messenger RNA) produced from deoxyribonucleic acid (DNA) contains exons (retained in mature messenger RNA) and introns (removed by splicing).\n- A cassette exon is an exon that may be either included or skipped in the mature messenger RNA. For a three-exon configuration with an upstream exon $\\mathrm{E1}$, a variable cassette exon $\\mathrm{E2}$, and a downstream exon $\\mathrm{E3}$, inclusion generates junctions $\\mathrm{E1}\\to\\mathrm{E2}$ and $\\mathrm{E2}\\to\\mathrm{E3}$, while exclusion (skipping $\\mathrm{E2}$) generates the junction $\\mathrm{E1}\\to\\mathrm{E3}$.\n- In RNA sequencing (RNA-seq), split reads (reads with two or more discontiguous alignment blocks) identify exon-exon junctions and thus evidence of specific splicing choices.\n\nYour program must implement the following abstract representation and rules:\n\n- Coordinates are zero-based, half-open genomic intervals: an exon $\\mathrm{E}$ is represented by $[s, e)$ with $e > s$. A read alignment is an ordered list of one or more genomic blocks $(s_i, e_i)$, each with $e_i > s_i$, representing contiguous exonic alignment. A split read has at least two blocks.\n- A junction supported by a read is the ordered pair $(e_i, s_{i+1})$ formed by two consecutive exonic blocks $(s_i, e_i)$ and $(s_{i+1}, e_{i+1})$. A junction matches $\\mathrm{E}A\\to\\mathrm{E}B$ if $e_i$ equals the end of exon $\\mathrm{E}A$ and $s_{i+1}$ equals the start of exon $\\mathrm{E}B$, and both blocks are entirely within the corresponding exon intervals.\n- To reduce spurious signals, enforce a minimum anchor length $k$: a read supports a junction only if the lengths of both flanking blocks adjacent to the junction are at least $k$ nucleotides. Formally, for blocks $(s_i, e_i)$ and $(s_{i+1}, e_{i+1})$, both $(e_i - s_i) \\ge k$ and $(e_{i+1} - s_{i+1}) \\ge k$ must hold.\n\nYour task is to:\n\n1. Detect and count split-read support for the three junctions of interest for a cassette exon event: $\\mathrm{E1}\\to\\mathrm{E2}$, $\\mathrm{E2}\\to\\mathrm{E3}$, and $\\mathrm{E1}\\to\\mathrm{E3}$, after applying the anchor length filter $k$.\n2. Using only these counts and first principles connecting read counts to isoform abundances, derive a robust estimator for the percent spliced in $\\Psi \\in [0,1]$ that balances the two inclusion-supporting junctions and appropriately contrasts them with the skipping junction. In the case where there is no evidence for any junction (the denominator of your estimator would be $0$), define $\\Psi$ to be $0$.\n3. Implement the algorithm and apply it to the test suite below.\n4. Output the results as a single line containing a comma-separated list enclosed in square brackets, with each numeric value rounded to $6$ decimal places. Express $\\Psi$ as a decimal number (not a percentage).\n\nDefinitions for all test cases:\n\n- Each test case is a triple containing exons, reads, and anchor length $k$.\n- Exons are provided as a mapping $\\{\\mathrm{E1}:[s_1,e_1), \\mathrm{E2}:[s_2,e_2), \\mathrm{E3}:[s_3,e_3)\\}$.\n- Reads are a list of alignments, where each alignment is a list of blocks $[(s_1,e_1), (s_2,e_2), \\dots]$.\n\nTest suite to implement and evaluate:\n\n- Test case $1$ (happy path, mixed inclusion and skipping; anchor threshold $k = 8$):\n  - Exons: $\\mathrm{E1}:[100,200)$, $\\mathrm{E2}:[300,360)$, $\\mathrm{E3}:[500,580)$.\n  - Reads:\n    - Inclusion $\\mathrm{E1}\\to\\mathrm{E2}$ candidates:\n      - $[(180,200),(300,330)]$\n      - $[(150,200),(300,320)]$\n      - $[(190,200),(300,308)]$\n      - $[(170,200),(300,312)]$\n      - $[(193,200),(300,305)]$ (insufficient left anchor, should not count)\n    - Inclusion $\\mathrm{E2}\\to\\mathrm{E3}$ candidates:\n      - $[(340,360),(500,540)]$\n      - $[(300,360),(500,508)]$\n      - $[(350,360),(500,507)]$ (insufficient right anchor, should not count)\n    - Exclusion (skipping) $\\mathrm{E1}\\to\\mathrm{E3}$ candidates:\n      - $[(190,200),(500,530)]$\n      - $[(180,200),(500,510)]$\n    - Long read spanning both inclusion junctions:\n      - $[(150,200),(300,360),(500,540)]$\n- Test case $2$ (boundary: only skipping evidence; anchor threshold $k = 8$):\n  - Exons: $\\mathrm{E1}:[100,200)$, $\\mathrm{E2}:[300,360)$, $\\mathrm{E3}:[500,580)$.\n  - Reads:\n    - Skipping:\n      - $[(190,200),(500,535)]$\n      - $[(150,200),(500,520)]$\n      - $[(199,200),(500,508)]$ (insufficient left anchor, should not count)\n- Test case $3$ (boundary: only inclusion evidence; anchor threshold $k = 10$):\n  - Exons: $\\mathrm{E1}:[1000,1100)$, $\\mathrm{E2}:[1200,1280)$, $\\mathrm{E3}:[1400,1500)$.\n  - Reads:\n    - $\\mathrm{E1}\\to\\mathrm{E2}$:\n      - $[(1080,1100),(1200,1230)]$\n      - $[(1050,1100),(1200,1215)]$\n    - $\\mathrm{E2}\\to\\mathrm{E3}$:\n      - $[(1260,1280),(1400,1450)]$\n      - $[(1200,1280),(1400,1415)]$\n      - $[(1220,1280),(1400,1415)]$\n      - $[(1240,1280),(1400,1430)]$\n    - Long read spanning both:\n      - $[(1040,1100),(1200,1280),(1400,1450)]$\n- Test case $4$ (imbalanced inclusion junctions with competing skipping; anchor threshold $k = 12$):\n  - Exons: $\\mathrm{E1}:[200,280)$, $\\mathrm{E2}:[400,460)$, $\\mathrm{E3}:[600,690)$.\n  - Reads:\n    - $\\mathrm{E1}\\to\\mathrm{E2}$:\n      - $[(260,280),(400,430)]$\n      - $[(240,280),(400,412)]$\n      - $[(268,280),(400,420)]$\n      - $[(230,280),(400,413)]$\n    - $\\mathrm{E2}\\to\\mathrm{E3}$:\n      - $[(448,460),(600,609)]$ (insufficient right anchor, should not count)\n    - $\\mathrm{E1}\\to\\mathrm{E3}$:\n      - $[(260,280),(600,640)]$\n      - $[(268,280),(600,612)]$\n      - $[(250,280),(600,615)]$\n- Test case $5$ (edge: no junction evidence at all; anchor threshold $k = 8$):\n  - Exons: $\\mathrm{E1}:[100,150)$, $\\mathrm{E2}:[200,240)$, $\\mathrm{E3}:[300,350)$.\n  - Reads (all single-block, not split):\n    - $[(120,140)]$\n    - $[(205,220)]$\n    - $[(320,340)]$\n\nFinal output format:\n\n- Your program should produce a single line of output containing a Python-style list of the $\\Psi$ values for the test cases, in order, each rounded to $6$ decimal places, with no spaces, for example: $[0.123456,0.000000,1.000000]$.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It provides a formal, albeit simplified, model of a canonical problem in computational transcriptomics: the quantification of alternative splicing from RNA sequencing data. All necessary definitions, data, and constraints are provided, allowing for the derivation and implementation of a unique, verifiable solution. We shall therefore proceed.\n\nThe task is to compute the Percent Spliced In, denoted by $\\Psi$, for a cassette exon event. This requires quantifying the relative abundance of two mature mRNA isoforms: one that includes the cassette exon ($\\mathrm{E2}$) and one that skips it. RNA sequencing provides the data in the form of reads, and split reads in particular provide direct evidence for the exon-exon junctions that define these isoforms.\n\nLet the three exons be the upstream exon $\\mathrm{E1} = [s_1, e_1)$, the cassette exon $\\mathrm{E2} = [s_2, e_2)$, and the downstream exon $\\mathrm{E3} = [s_3, e_3)$.\nThere are three exon-exon junctions of interest:\n$1$. The inclusion junction between $\\mathrm{E1}$ and $\\mathrm{E2}$, defined by the genomic coordinates $(e_1, s_2)$.\n$2$. The inclusion junction between $\\mathrm{E2}$ and $\\mathrm{E3}$, defined by the genomic coordinates $(e_2, s_3)$.\n$3$. The exclusion (or skipping) junction between $\\mathrm{E1}$ and $\\mathrm{E3}$, defined by the genomic coordinates $(e_1, s_3)$.\n\nLet $N_{12}$, $N_{23}$, and $N_{13}$ be the number of filtered split reads supporting each of these respective junctions. A read supports a junction if it meets two criteria: ($i$) its blocks flanking the junction are fully contained within the corresponding exons, and ($ii$) the length of each of these two flanking blocks is at least the minimum anchor length, $k$.\n\nThe abundance of the inclusion isoform is evidenced by reads spanning either the $\\mathrm{E1}\\to\\mathrm{E2}$ junction or the $\\mathrm{E2}\\to\\mathrm{E3}$ junction. The abundance of the skipping isoform is evidenced by reads spanning the $\\mathrm{E1}\\to\\mathrm{E3}$ junction. A robust estimator for the abundance of the inclusion isoform, which we shall denote $I$, must \"balance\" the evidence from the two inclusion junctions. This is standard practice to account for potential biases in RNA fragmentation and sequencing coverage. A simple and effective approach is to use the arithmetic mean of the two counts. Thus, the effective count for the inclusion isoform is:\n$$I = \\frac{N_{12} + N_{23}}{2}$$\nThe count for the skipping isoform, denoted $S$, is directly given by the count of the skipping junction:\n$$S = N_{13}$$\nThe Percent Spliced In, $\\Psi$, is the ratio of the inclusion isoform's abundance to the total abundance of both isoforms. Using our count-based proxies:\n$$\\Psi = \\frac{I}{I + S} = \\frac{\\frac{N_{12} + N_{23}}{2}}{\\frac{N_{12} + N_{23}}{2} + N_{13}}$$\nThis simplifies to:\n$$\\Psi = \\frac{N_{12} + N_{23}}{N_{12} + N_{23} + 2 \\cdot N_{13}}$$\nIn the special case where the denominator is zero (i.e., $N_{12} = 0$, $N_{23} = 0$, and $N_{13} = 0$), there is no evidence for splicing at this locus. As per the problem specification, $\\Psi$ is defined to be $0$ in this scenario. Our formula correctly handles this, as a denominator of $0$ implies a numerator of $0$, and we explicitly define the outcome of this indeterminate form as $0$.\n\nThe algorithm to calculate $\\Psi$ for a given test case (comprising exon definitions, a list of reads, and an anchor length $k$) is as follows:\nStep $1$: Initialize three counters to zero: $N_{12} = 0$, $N_{23} = 0$, $N_{13} = 0$.\nStep $2$: Extract the genomic coordinates for the three exons: $s_1, e_1, s_2, e_2, s_3, e_3$.\nStep $3$: Define the coordinates of the three target junctions: $J_{12} = (e_1, s_2)$, $J_{23} = (e_2, s_3)$, and $J_{13} = (e_1, s_3)$.\nStep $4$: For each read in the input list:\n    a. A read is a list of one or more alignment blocks, $[(b_1^s, b_1^e), (b_2^s, b_2^e), \\dots]$. If the read has fewer than two blocks, it is not a split read and is ignored.\n    b. Iterate through all adjacent pairs of blocks in the read. For each pair of blocks $(b_i^s, b_i^e)$ and $(b_{i+1}^s, b_{i+1}^e)$, an observed junction $J_{obs} = (b_i^e, b_{i+1}^s)$ is formed.\n    c. Apply the anchor length filter: check if $(b_i^e - b_i^s) \\ge k$ and $(b_{i+1}^e - b_{i+1}^s) \\ge k$. If not, this junction is discarded.\n    d. If the anchor filter is passed, check if $J_{obs}$ matches one of the target junctions and if the corresponding blocks are contained within the correct exons:\n        i. If $J_{obs} = J_{12}$, and block $i$ is within $\\mathrm{E1}$ (i.e., $b_i^s \\ge s_1$ and $b_i^e \\le e_1$), and block $i+1$ is within $\\mathrm{E2}$ (i.e., $b_{i+1}^s \\ge s_2$ and $b_{i+1}^e \\le e_2$), increment $N_{12}$.\n        ii. If $J_{obs} = J_{23}$, and block $i$ is within $\\mathrm{E2}$ (i.e., $b_i^s \\ge s_2$ and $b_i^e \\le e_2$), and block $i+1$ is within $\\mathrm{E3}$ (i.e., $b_{i+1}^s \\ge s_3$ and $b_{i+1}^e \\le e_3$), increment $N_{23}$.\n        iii. If $J_{obs} = J_{13}$, and block $i$ is within $\\mathrm{E1}$ (i.e., $b_i^s \\ge s_1$ and $b_i^e \\le e_1$), and block $i+1$ is within $\\mathrm{E3}$ (i.e., $b_{i+1}^s \\ge s_3$ and $b_{i+1}^e \\le e_3$), increment $N_{13}$.\nStep $5$: After processing all reads, calculate the total denominator $D = N_{12} + N_{23} + 2 \\cdot N_{13}$.\nStep $6$: If $D = 0$, set $\\Psi = 0$. Otherwise, calculate $\\Psi = (N_{12} + N_{23}) / D$.\nStep $7$: The resulting $\\Psi$ value is the solution for the test case.\n\nThis procedure constitutes a complete and robust pipeline for the specified task. The implementation will systematically apply this logic to each of the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and calculate Psi values.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        ({\n            \"exons\": {\"E1\": [100, 200], \"E2\": [300, 360], \"E3\": [500, 580]},\n            \"reads\": [\n                [(180, 200), (300, 330)],\n                [(150, 200), (300, 320)],\n                [(190, 200), (300, 308)],\n                [(170, 200), (300, 312)],\n                [(193, 200), (300, 305)],\n                [(340, 360), (500, 540)],\n                [(300, 360), (500, 508)],\n                [(350, 360), (500, 507)],\n                [(190, 200), (500, 530)],\n                [(180, 200), (500, 510)],\n                [(150, 200), (300, 360), (500, 540)],\n            ],\n            \"k\": 8\n        }),\n        # Test case 2\n        ({\n            \"exons\": {\"E1\": [100, 200], \"E2\": [300, 360], \"E3\": [500, 580]},\n            \"reads\": [\n                [(190, 200), (500, 535)],\n                [(150, 200), (500, 520)],\n                [(199, 200), (500, 508)],\n            ],\n            \"k\": 8\n        }),\n        # Test case 3\n        ({\n            \"exons\": {\"E1\": [1000, 1100], \"E2\": [1200, 1280], \"E3\": [1400, 1500]},\n            \"reads\": [\n                [(1080, 1100), (1200, 1230)],\n                [(1050, 1100), (1200, 1215)],\n                [(1260, 1280), (1400, 1450)],\n                [(1200, 1280), (1400, 1415)],\n                [(1220, 1280), (1400, 1415)],\n                [(1240, 1280), (1400, 1430)],\n                [(1040, 1100), (1200, 1280), (1400, 1450)],\n            ],\n            \"k\": 10\n        }),\n        # Test case 4\n        ({\n            \"exons\": {\"E1\": [200, 280], \"E2\": [400, 460], \"E3\": [600, 690]},\n            \"reads\": [\n                [(260, 280), (400, 430)],\n                [(240, 280), (400, 412)],\n                [(268, 280), (400, 420)],\n                [(230, 280), (400, 413)],\n                [(448, 460), (600, 609)],\n                [(260, 280), (600, 640)],\n                [(268, 280), (600, 612)],\n                [(250, 280), (600, 615)],\n            ],\n            \"k\": 12\n        }),\n        # Test case 5\n        ({\n            \"exons\": {\"E1\": [100, 150], \"E2\": [200, 240], \"E3\": [300, 350]},\n            \"reads\": [\n                [(120, 140)],\n                [(205, 220)],\n                [(320, 340)],\n            ],\n            \"k\": 8\n        })\n    ]\n\n    results = []\n    \n    def calculate_psi_for_case(case):\n        exons = case[\"exons\"]\n        reads = case[\"reads\"]\n        k = case[\"k\"]\n\n        e1_s, e1_e = exons[\"E1\"]\n        e2_s, e2_e = exons[\"E2\"]\n        e3_s, e3_e = exons[\"E3\"]\n        \n        # Define the target junctions as tuples of (end_coord, start_coord)\n        j12 = (e1_e, e2_s)\n        j23 = (e2_e, e3_s)\n        j13 = (e1_e, e3_s)\n\n        # Initialize junction counts\n        n12, n23, n13 = 0, 0, 0\n        \n        for read_blocks in reads:\n            # A read must be split (at least 2 blocks) to support a junction\n            if len(read_blocks)  2:\n                continue\n\n            # Iterate over adjacent blocks to find junctions\n            for i in range(len(read_blocks) - 1):\n                block1_s, block1_e = read_blocks[i]\n                block2_s, block2_e = read_blocks[i+1]\n                \n                # Apply the minimum anchor length filter\n                if (block1_e - block1_s)  k or (block2_e - block2_s)  k:\n                    continue\n                    \n                observed_junction = (block1_e, block2_s)\n                \n                # Check for E1->E2 junction\n                if observed_junction == j12:\n                    # Check for correct block containment within E1 and E2\n                    if (block1_s >= e1_s and block1_e = e1_e) and \\\n                       (block2_s >= e2_s and block2_e = e2_e):\n                        n12 += 1\n                        \n                # Check for E2->E3 junction\n                elif observed_junction == j23:\n                    # Check for correct block containment within E2 and E3\n                    if (block1_s >= e2_s and block1_e = e2_e) and \\\n                       (block2_s >= e3_s and block2_e = e3_e):\n                        n23 += 1\n                \n                # Check for E1->E3 (skipping) junction\n                elif observed_junction == j13:\n                    # Check for correct block containment within E1 and E3\n                    if (block1_s >= e1_s and block1_e = e1_e) and \\\n                       (block2_s >= e3_s and block2_e = e3_e):\n                        n13 += 1\n\n        # Calculate Psi based on the derived formula\n        numerator = n12 + n23\n        denominator = n12 + n23 + 2 * n13\n        \n        if denominator == 0:\n            psi = 0.0\n        else:\n            psi = numerator / denominator\n            \n        return psi\n\n    for case in test_cases:\n        psi_value = calculate_psi_for_case(case)\n        # Format the result to 6 decimal places, as required.\n        results.append(f\"{psi_value:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2946390"}]}