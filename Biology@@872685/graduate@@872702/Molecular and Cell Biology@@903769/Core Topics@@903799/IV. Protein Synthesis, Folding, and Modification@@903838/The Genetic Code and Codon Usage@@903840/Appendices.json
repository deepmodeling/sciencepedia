{"hands_on_practices": [{"introduction": "The genetic code is often taught as a universal constant, but nature is rich with exceptions that have significant evolutionary and bioinformatic implications. This exercise explores the practical challenge of interpreting genes from organisms with variant genetic codes, such as mitochondria [@problem_id:2965828]. By applying principles of probability, you will quantify the expected error that arises when a standard code is mistakenly used, providing a tangible understanding of the impact of these code variations on genome annotation.", "problem": "A vertebrate mitochondrial genome uses a variant genetic code in which the messenger RNA (mRNA) codon UGA encodes tryptophan rather than signaling translation termination. Consider a protein-coding gene that truly consists of exactly $N$ sense codons followed by a single termination codon under the mitochondrial code (so there are no termination codons among these $N$ sense codons under the mitochondrial code). A nuclear genome annotation pipeline erroneously used the standard code (in which UGA is a stop codon) to annotate this gene from the same mRNA sequence. Assume the following:\n\n- The Central Dogma applies: codons in mRNA are translated into amino acids by transfer RNA (tRNA) adaptors following the applicable codon table.\n- Under the mitochondrial code for this lineage, UGA encodes tryptophan and UAA/UAG encode stops; all other codon assignments match the standard code.\n- Along the true $N$-codon coding region, codons are independently and identically distributed. The amino acid tryptophan has marginal frequency $q$ among the $N$ positions, and conditional on tryptophan, the codon is UGA with probability $p$ and UGG with probability $1-p$; no other codons encode tryptophan in this system.\n- Aside from UGA, no other standard-code stop codon occurs among the $N$ sense codons (consistent with the true mitochondrial coding region assumption).\n\nWhen the standard code is used in error, translation is predicted to terminate at the first encountered UGA among the $N$ codons. Let $\\Delta$ denote the number of amino acid residues that are present in the true mitochondrial translation but absent from the standard-code annotation, that is, the difference in lengths (mitochondrial minus standard) of the annotated polypeptides. Derive from first principles an exact analytic expression for the expected value $\\mathbb{E}[\\Delta]$ as a function of $N$, $p$, and $q$, and then evaluate it numerically for $N=300$, $p=0.7$, and $q=0.015$. Round your numerical answer to four significant figures. Report only the final numerical value; no units are required.", "solution": "The Central Dogma specifies that codons in messenger RNA (mRNA) are decoded into amino acids by transfer RNA (tRNA) according to the genetic code. In the standard code, UGA is a termination signal, whereas in the specified mitochondrial code, UGA encodes tryptophan. Therefore, if an annotation pipeline uses the standard code on a mitochondrial gene, it will prematurely terminate translation at the first UGA encountered within the true coding region.\n\nLet the true mitochondrial protein contain exactly $N$ amino acids before the genuine stop codon. Under the erroneous standard-code annotation, the predicted polypeptide length equals the number of consecutive non-UGA codons from the start until the first UGA (or $N$ if no UGA occurs among the $N$ positions).\n\nDefine the per-codon probability that a given position is UGA within the true coding region. Tryptophan has marginal frequency $q$, and conditional on tryptophan, the codon is UGA with probability $p$. No other codon encodes tryptophan. Thus, the probability that any given codon is UGA is\n$$\nr \\equiv \\Pr(\\text{UGA}) = p\\,q.\n$$\nAssume codons are independent and identically distributed along the $N$ positions. Let $X$ be the number of consecutive non-UGA codons before the first UGA when scanning from the start, truncated at $N$:\n$$\nX \\equiv \\min\\{\\text{number of non-UGA codons before the first UGA},\\, N\\}.\n$$\nUnder the standard-code annotation, the predicted polypeptide length is $X$, while the true mitochondrial length is $N$. Therefore, the number of residues missing is\n$$\n\\Delta = N - X.\n$$\nWe seek $\\mathbb{E}[\\Delta] = N - \\mathbb{E}[X]$.\n\nTo compute $\\mathbb{E}[X]$, note that the count of consecutive non-UGA codons before the first UGA (without truncation) is a geometric random variable (failures before first success) with success probability $r$; its tail probabilities satisfy\n$$\n\\Pr(X \\ge k) = \\Pr(\\text{no UGA in the first }k\\text{ codons}) = (1-r)^{k},\n$$\nfor $k \\in \\{0,1,2,\\dots\\}$, with truncation at $N$. Using the tail-sum formula for a nonnegative integer-valued random variable truncated at $N$,\n$$\n\\mathbb{E}[X] = \\sum_{k=1}^{N} \\Pr(X \\ge k) = \\sum_{k=1}^{N} (1-r)^{k}.\n$$\nEvaluating the geometric series yields\n$$\n\\mathbb{E}[X] = \\frac{(1-r)\\left(1 - (1-r)^{N}\\right)}{r}.\n$$\nTherefore,\n$$\n\\mathbb{E}[\\Delta] = N - \\mathbb{E}[X] = N - \\frac{(1-r)\\left(1 - (1-r)^{N}\\right)}{r},\n$$\nwith $r = p\\,q$. Substituting $r = p\\,q$ gives the requested analytic expression:\n$$\n\\mathbb{E}[\\Delta] = N - \\frac{\\bigl(1 - p q\\bigr)\\left(1 - \\bigl(1 - p q\\bigr)^{N}\\right)}{p q}.\n$$\n\nNow evaluate numerically for $N=300$, $p=0.7$, and $q=0.015$:\n- Compute $r = p q = 0.7 \\times 0.015 = 0.0105$, so $1-r = 0.9895$.\n- Compute $(1-r)^{N} = 0.9895^{300}$. Using $\\ln(0.9895) \\approx -0.0105555$, we have\n$$\n(1-r)^{N} \\approx \\exp\\!\\bigl(300 \\times \\ln(0.9895)\\bigr) \\approx \\exp(-3.16665) \\approx 0.04215.\n$$\n- Then\n$$\n(1-r)\\left(1 - (1-r)^{N}\\right) \\approx 0.9895 \\times (1 - 0.04215) = 0.9895 \\times 0.95785 \\approx 0.947792575.\n$$\n- Divide by $r$:\n$$\n\\frac{(1-r)\\left(1 - (1-r)^{N}\\right)}{r} \\approx \\frac{0.947792575}{0.0105} \\approx 90.2659595.\n$$\n- Finally,\n$$\n\\mathbb{E}[\\Delta] \\approx 300 - 90.2659595 \\approx 209.7340405.\n$$\n\nRounding to four significant figures gives $209.7$.", "answer": "$$\\boxed{209.7}$$", "id": "2965828"}, {"introduction": "The choice among synonymous codons is a key determinant of translation speed, a phenomenon largely governed by the availability of corresponding tRNA molecules. This practice moves from a static view of the code to a dynamic model of translation elongation, linking cellular physiology to the mechanics of protein synthesis [@problem_id:2965810]. You will calculate how changes in the cellular environment, reflected in the charging levels of tRNA isoacceptors, can alter codon-specific translation rates and create \"bottlenecks\" in protein production.", "problem": "A protein-coding messenger ribonucleic acid (mRNA) contains three synonymous codons for a particular amino acid, labeled codon A, codon B, and codon C. These codons are decoded by three Transfer Ribonucleic Acid (tRNA) isoacceptors, labeled isoacceptor $i \\in \\{1,2,3\\}$, each carrying the same amino acid but with distinct anticodons and decoding proficiencies for each codon. Let the total cellular concentrations of the isoacceptors be $C_{1}=2.0$ $\\mu$M, $C_{2}=1.5$ $\\mu$M, and $C_{3}=1.0$ $\\mu$M. The charged (aminoacylated) fractions under baseline condition are $f_{1}^{(0)}=0.90$, $f_{2}^{(0)}=0.85$, $f_{3}^{(0)}=0.95$, and under a stress condition are $f_{1}^{(1)}=0.50$, $f_{2}^{(1)}=0.30$, $f_{3}^{(1)}=0.80$. The decoding proficiency coefficients (dimensionless, reflecting codon-anticodon matching and kinetics) for each codon $c \\in \\{\\text{A},\\text{B},\\text{C}\\}$ with each isoacceptor $i$ are:\n- Codon A: $P_{\\text{A},1}=1.0$, $P_{\\text{A},2}=0.70$, $P_{\\text{A},3}=0.10$.\n- Codon B: $P_{\\text{B},1}=0.00$, $P_{\\text{B},2}=1.00$, $P_{\\text{B},3}=0.60$.\n- Codon C: $P_{\\text{C},1}=0.80$, $P_{\\text{C},2}=0.00$, $P_{\\text{C},3}=1.00$.\n\nAssume the following foundational principles: during translation elongation, the waiting time at a codon is dominated by the arrival and successful selection of a cognate charged tRNA; the arrival rate contributed by a given isoacceptor is proportional to its charged concentration $C_{i} f_{i}$; and when multiple isoacceptors can decode a codon, their contributions to the per-codon arrival rate add linearly, weighted by codon-specific decoding proficiencies $P_{c,i}$. The mean dwell time at a codon is inversely proportional to its elongation rate.\n\nStarting from these principles, derive a usable expression for the relative elongation rate of each codon in terms of $C_{i}$, $f_{i}$, and $P_{c,i}$; compute the per-codon fold-change in elongation rate $F_{c}$ from baseline to stress; identify the codons that are “sensitive,” defined as those with $F_{c} < 0.70$; and finally compute the maximum fold-increase in mean dwell time across the three codons, which by definition is $\\max_{c}\\left(1/F_{c}\\right)$. Report only this maximum fold-increase as your final answer, as a unitless ratio, rounded to four significant figures.", "solution": "The core mechanistic base is that the elongation step at a codon is limited by the arrival and successful selection of a cognate charged Transfer Ribonucleic Acid (tRNA). Under mass-action kinetics, the contribution to the arrival rate from isoacceptor $i$ is proportional to its charged concentration, which is $C_{i} f_{i}$, multiplied by an efficiency factor that captures codon-anticodon matching and kinetic proficiency. When multiple isoacceptors can decode the same codon, their contributions to the total arrival rate add linearly.\n\nLet the elongation rate at codon $c$ be $r_{c}$. By the above principles, we can write\n$$\nr_{c} = k \\sum_{i=1}^{3} P_{c,i}\\, C_{i}\\, f_{i},\n$$\nwhere $k$ is a proportionality constant common to all codons under a given condition (reflecting, for example, a shared on-rate scale), $P_{c,i}$ are the given decoding proficiency coefficients, $C_{i}$ are isoacceptor concentrations, and $f_{i}$ are the charged fractions under the condition of interest. The mean dwell time $\\tau_{c}$ at codon $c$ is inversely proportional to $r_{c}$, i.e., $\\tau_{c} \\propto 1/r_{c}$.\n\nWe are asked to compute the fold-change in elongation rate from baseline $(0)$ to stress $(1)$ for each codon:\n$$\nF_{c} \\equiv \\frac{r_{c}^{(1)}}{r_{c}^{(0)}} = \\frac{k \\sum_{i} P_{c,i}\\, C_{i}\\, f_{i}^{(1)}}{k \\sum_{i} P_{c,i}\\, C_{i}\\, f_{i}^{(0)}} = \\frac{\\sum_{i} P_{c,i}\\, C_{i}\\, f_{i}^{(1)}}{\\sum_{i} P_{c,i}\\, C_{i}\\, f_{i}^{(0)}},\n$$\nwhere the unknown constant $k$ cancels. The corresponding fold-change in mean dwell time is $1/F_{c}$.\n\nFirst compute the charged concentrations $C_{i} f_{i}$ under baseline and stress:\n- Baseline: $C_{1} f_{1}^{(0)} = 2.0 \\times 0.90 = 1.80$, $C_{2} f_{2}^{(0)} = 1.50 \\times 0.85 = 1.275$, $C_{3} f_{3}^{(0)} = 1.00 \\times 0.95 = 0.95$.\n- Stress: $C_{1} f_{1}^{(1)} = 2.0 \\times 0.50 = 1.00$, $C_{2} f_{2}^{(1)} = 1.50 \\times 0.30 = 0.45$, $C_{3} f_{3}^{(1)} = 1.00 \\times 0.80 = 0.80$.\n\nNext compute the effective sums $\\sum_{i} P_{c,i}\\, C_{i}\\, f_{i}$ for each codon and condition.\n\nFor codon A, with $P_{\\text{A},1}=1.0$, $P_{\\text{A},2}=0.70$, $P_{\\text{A},3}=0.10$:\n- Baseline:\n$$\nS_{\\text{A}}^{(0)} = 1.0 \\times 1.80 + 0.70 \\times 1.275 + 0.10 \\times 0.95 = 1.80 + 0.8925 + 0.095 = 2.7875.\n$$\n- Stress:\n$$\nS_{\\text{A}}^{(1)} = 1.0 \\times 1.00 + 0.70 \\times 0.45 + 0.10 \\times 0.80 = 1.00 + 0.315 + 0.08 = 1.395.\n$$\nThus\n$$\nF_{\\text{A}} = \\frac{1.395}{2.7875} = \\frac{558}{1115} \\approx 0.50045.\n$$\n\nFor codon B, with $P_{\\text{B},1}=0.00$, $P_{\\text{B},2}=1.00$, $P_{\\text{B},3}=0.60$:\n- Baseline:\n$$\nS_{\\text{B}}^{(0)} = 0.00 \\times 1.80 + 1.00 \\times 1.275 + 0.60 \\times 0.95 = 1.275 + 0.57 = 1.845.\n$$\n- Stress:\n$$\nS_{\\text{B}}^{(1)} = 0.00 \\times 1.00 + 1.00 \\times 0.45 + 0.60 \\times 0.80 = 0.45 + 0.48 = 0.93.\n$$\nThus\n$$\nF_{\\text{B}} = \\frac{0.93}{1.845} = \\frac{62}{123} \\approx 0.50407.\n$$\n\nFor codon C, with $P_{\\text{C},1}=0.80$, $P_{\\text{C},2}=0.00$, $P_{\\text{C},3}=1.00$:\n- Baseline:\n$$\nS_{\\text{C}}^{(0)} = 0.80 \\times 1.80 + 0.00 \\times 1.275 + 1.00 \\times 0.95 = 1.44 + 0.95 = 2.39.\n$$\n- Stress:\n$$\nS_{\\text{C}}^{(1)} = 0.80 \\times 1.00 + 0.00 \\times 0.45 + 1.00 \\times 0.80 = 0.80 + 0.80 = 1.60.\n$$\nThus\n$$\nF_{\\text{C}} = \\frac{1.60}{2.39} = \\frac{160}{239} \\approx 0.66946.\n$$\n\nIdentify sensitive codons as those with $F_{c} < 0.70$. We have $F_{\\text{A}} \\approx 0.50045$, $F_{\\text{B}} \\approx 0.50407$, and $F_{\\text{C}} \\approx 0.66946$, so all three codons A, B, and C are sensitive.\n\nThe mean dwell time fold-change for each codon is $1/F_{c}$:\n$$\n\\frac{1}{F_{\\text{A}}} = \\frac{1115}{558} \\approx 1.99821,\\quad \\frac{1}{F_{\\text{B}}} = \\frac{123}{62} \\approx 1.98387,\\quad \\frac{1}{F_{\\text{C}}} = \\frac{239}{160} = 1.49375.\n$$\nThe maximum fold-increase in mean dwell time across the three codons is therefore\n$$\n\\max_{c}\\left(\\frac{1}{F_{c}}\\right) = \\frac{1115}{558} \\approx 1.99821.\n$$\n\nRounded to four significant figures, the requested unitless ratio is $1.998$.", "answer": "$$\\boxed{1.998}$$", "id": "2965810"}, {"introduction": "A deep understanding of codon usage culminates in the ability to engineer genes for predictable and optimal expression, a central goal of synthetic biology. This final practice challenges you to move from analysis to synthesis by designing an optimal coding sequence [@problem_id:2965766]. By tackling this constrained optimization problem, you will engage with a powerful computational approach used to navigate the vast space of synonymous sequences and create a gene that maximizes translation efficiency while adhering to other critical design constraints.", "problem": "You are given a formal model of synonymous codon selection for a fixed amino acid sequence under host-specific translational preferences. The central dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein) implies that a protein’s primary sequence (amino acids) can be encoded by multiple nucleotide sequences due to degeneracy of the genetic code. In a simple kinetic approximation of translation elongation, each codon-specific elongation step is treated as an independent event with an expected dwell time inversely proportional to a codon’s effective elongation rate. For a codon with host preference weight $w$ and cognate transfer ribonucleic acid (tRNA) abundance $a$, the effective elongation rate is $r = w \\cdot a$ and the expected dwell time is $t = 1 / r$. For a coding sequence of length $n$ codons, with a chosen codon $c_i$ at position $i \\in \\{1,\\dots,n\\}$, the total expected elongation time is\n$$\nT = \\sum_{i=1}^{n} \\frac{1}{w(c_i)\\, a(c_i)}.\n$$\nThe objective is to minimize $T$ over all synonymous codon choices that encode the given amino acid sequence, subject to two global sequence-level constraints:\n- A guanine-cytosine (GC) content fraction constraint: the fraction of nucleotides in the entire coding sequence that are either $G$ or $C$ must lie within a specified closed interval $[g_{\\min}, g_{\\max}]$.\n- A forbidden motif constraint: a specified nucleotide substring $M$ (over the alphabet $\\{A,C,G,T\\}$) must not appear anywhere as a contiguous substring of the concatenated nucleotide sequence.\n\nAssume the standard genetic code mapping from amino acids to their synonymous codons, but you are only required to consider amino acids and codons explicitly listed in each test case. For each test case below, you are given:\n- An amino acid sequence (a string over the one-letter amino acid alphabet).\n- A host codon preference mapping $w(\\text{codon})$ with values in $(0,1]$.\n- A tRNA abundance mapping $a(\\text{codon})$ with positive real values.\n- A GC content bound $[g_{\\min}, g_{\\max}]$ where both endpoints are real numbers with $0 \\le g_{\\min} \\le g_{\\max} \\le 1$.\n- A forbidden motif $M$ (a string over $\\{A,C,G,T\\}$).\n\nYour program must, for each test case, compute an optimal coding sequence that minimizes $T$ while satisfying both constraints. If multiple optimal sequences exist, any one is acceptable so long as it satisfies the constraints.\n\nPrecise interpretation and requirements:\n- Let the total nucleotide length be $L = 3n$ for a peptide of length $n$. The GC count constraint is enforced as an integer bound on the number of $G$ or $C$ nucleotides: the count must lie in the interval $[\\lceil g_{\\min} \\cdot L \\rceil,\\ \\lfloor g_{\\max} \\cdot L \\rfloor]$.\n- The motif $M$ must not occur as a contiguous substring in the final concatenated nucleotide sequence. All matching is case-sensitive using uppercase letters.\n- The objective value $T$ is the sum of per-codon times $1/(w \\cdot a)$ as specified above.\n\nYour output for each test case must be a triple consisting of:\n- The minimal expected total elongation time $T^\\star$ as a decimal float rounded to exactly six digits after the decimal point.\n- The realized GC fraction as a decimal float rounded to exactly four digits after the decimal point.\n- A boolean indicating whether the forbidden motif is absent (this must be true for any acceptable solution).\n\nAggregate the results for all test cases into a single flat list in the following exact format: a single line containing a bracketed, comma-separated list with no spaces, concatenating the triples of all test cases in order, for example: \"[t1,gc1,b1,t2,gc2,b2,t3,gc3,b3]\". Do not include any units in the output.\n\nTest suite:\n- Test case $1$:\n    - Amino acid sequence: \"AKG\".\n    - Host codon preference weights $w(\\cdot)$:\n        - Alanine (A): GCT:$0.20$, GCC:$0.30$, GCA:$0.25$, GCG:$0.25$.\n        - Lysine (K): AAA:$0.55$, AAG:$0.45$.\n        - Glycine (G): GGT:$0.18$, GGC:$0.32$, GGA:$0.20$, GGG:$0.30$.\n    - tRNA abundances $a(\\cdot)$:\n        - GCT:$0.90$, GCC:$1.40$, GCA:$1.00$, GCG:$0.80$.\n        - AAA:$1.20$, AAG:$0.70$.\n        - GGT:$1.10$, GGC:$1.50$, GGA:$0.90$, GGG:$1.00$.\n    - GC bounds: $[g_{\\min}, g_{\\max}] = [0.4, 0.7]$.\n    - Forbidden motif $M = \\text{\"CGCG\"}$.\n\n- Test case $2$:\n    - Amino acid sequence: \"DP\".\n    - Host codon preference weights $w(\\cdot)$:\n        - Aspartic acid (D): GAT:$0.60$, GAC:$0.40$.\n        - Proline (P): CCT:$0.30$, CCC:$0.20$, CCA:$0.25$, CCG:$0.25$.\n    - tRNA abundances $a(\\cdot)$:\n        - GAT:$0.80$, GAC:$1.40$.\n        - CCT:$1.20$, CCC:$1.00$, CCA:$0.90$, CCG:$1.30$.\n    - GC bounds: $[g_{\\min}, g_{\\max}] = [0.66, 1.0]$.\n    - Forbidden motif $M = \\text{\"GATC\"}$.\n\n- Test case $3$:\n    - Amino acid sequence: \"SRS\".\n    - Host codon preference weights $w(\\cdot)$:\n        - Serine (S): TCT:$0.15$, TCC:$0.20$, TCA:$0.15$, TCG:$0.20$, AGT:$0.15$, AGC:$0.15$.\n        - Arginine (R): CGT:$0.18$, CGC:$0.22$, CGA:$0.12$, CGG:$0.22$, AGA:$0.12$, AGG:$0.14$.\n    - tRNA abundances $a(\\cdot)$:\n        - Serine codons: TCT:$1.00$, TCC:$1.30$, TCA:$0.90$, TCG:$1.20$, AGT:$0.80$, AGC:$1.10$.\n        - Arginine codons: CGT:$1.10$, CGC:$1.30$, CGA:$0.90$, CGG:$1.40$, AGA:$0.85$, AGG:$1.00$.\n    - GC bounds: $[g_{\\min}, g_{\\max}] = [0.5, 0.6]$.\n    - Forbidden motif $M = \\text{\"AGAG\"}$.\n\nScientific basis and assumptions to be used:\n- The Central Dogma and the standard genetic code underlie the mapping from amino acids to codons.\n- Empirically, codon-specific elongation rates correlate with both host codon usage/availability and cognate tRNA abundances; the simplified model $r = w \\cdot a$ is a widely used first-order approximation for expected rate scaling.\n- Under independence of elongation steps, expected total time is additive across codons as $T = \\sum_i 1/r_i$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"). No user input is required. All computations must be deterministic. Express all real-valued outputs as decimals rounded as specified; do not include any percentage signs or physical units.", "solution": "The problem presented is a constrained optimization task, a canonical problem in the field of synthetic biology, specifically in the design of synthetic genes for heterologous expression. The objective is to determine a nucleotide coding sequence for a given amino acid sequence that minimizes the total expected translation elongation time, subject to constraints on guanine-cytosine (GC) content and the absence of a forbidden nucleotide motif. This problem is scientifically well-grounded and can be solved algorithmically.\n\nThe problem can be modeled as finding a shortest path in a directed acyclic graph (DAG). The nodes in this graph represent the states of the sequence synthesis process, and the edges represent the addition of a new codon. Dynamic programming is the standard and most effective technique for solving such a problem.\n\nLet the given amino acid sequence be $A = (A_1, A_2, \\dots, A_n)$ of length $n$. For each amino acid $A_i$, there is a set of synonymous codons $C(A_i)$. For each codon $c$, we are given its host preference weight $w(c)$ and cognate tRNA abundance $a(c)$. The time contribution of a codon $c$ is $t(c) = 1 / (w(c) \\cdot a(c))$. We also define $\\text{gc}(c)$ as the number of G or C nucleotides in codon $c$.\n\nTo apply dynamic programming, we define a state by the information required to make future decisions and verify constraints. A state must capture:\n1.  The position $i$ in the amino acid sequence that has been encoded.\n2.  The cumulative GC count $g$ of the nucleotide sequence constructed so far.\n3.  The suffix $s$ of the constructed nucleotide sequence. This is necessary to check for the formation of the forbidden motif $M$. The required length of this suffix is $|M|-1$.\n\nLet $DP(i, g, s)$ be the minimum possible total elongation time for a nucleotide sequence encoding the first $i$ amino acids of the target protein, such that the sequence has a total of $g$ GC nucleotides and its suffix of length $\\min(3i, |M|-1)$ is the string $s$.\n\nThe DP state transitions are defined by the choice of codon for the next amino acid. To compute the values for step $i$, we use the computed values from step $i-1$. The recurrence relation is as follows:\n\n$$\nDP(i, g, s) = \\min_{(g', s', c)} \\{ DP(i-1, g', s') + t(c) \\}\n$$\n\nThe minimization is performed over all valid antecedent states $(i-1, g', s')$ and all synonymous codons $c \\in C(A_i)$ that can transition to the state $(i, g, s)$. A transition is valid if:\n1.  The new GC count is correct: $g = g' + \\text{gc}(c)$.\n2.  Appending codon $c$ to a sequence ending with suffix $s'$ does not create the forbidden motif $M$. That is, $M$ is not a substring of $s' + c$.\n3.  The new suffix $s$ is correctly derived: $s = (s' + c)[-|M|+1:]$, where the notation indicates taking the last $|M|-1$ characters.\n\nThe base case for the recursion is at $i=0$ (before encoding any amino acid):\n$$\nDP(0, 0, \\text{''}) = 0\n$$\nAll other $DP(0, g, s)$ values are initialized to infinity to indicate they are unreachable.\n\nThe algorithm proceeds by iteratively computing the DP table for $i=1, 2, \\dots, n$. After the table for $i=n$ is fully populated, the final step is to find the overall minimum time that satisfies the global GC content constraint. Let the total length of the nucleotide sequence be $L = 3n$. The number of GC bases must be in the integer interval $[G_{\\min}, G_{\\max}]$, where $G_{\\min} = \\lceil g_{\\min} \\cdot L \\rceil$ and $G_{\\max} = \\lfloor g_{\\max} \\cdot L \\rfloor$.\n\nThe minimal total elongation time $T^\\star$ is then given by:\n$$\nT^\\star = \\min_{s, g \\in [G_{\\min}, G_{\\max}]} \\{ DP(n, g, s) \\}\n$$\nThe optimal nucleotide sequence itself can be reconstructed by storing back-pointers during the DP computation, which record the choice of codon that led to each minimal state.\n\nBy systematically exploring all valid codon combinations and their associated costs, this dynamic programming approach guarantees finding the globally optimal solution. The complexity is proportional to the number of states and transitions, which is approximately $O(n \\cdot (3n) \\cdot 4^{|M|-1} \\cdot |C_{\\max}|)$, where $|C_{\\max}|$ is the maximum number of synonymous codons for any amino acid. Given the small parameters in the test cases, this approach is computationally feasible.", "answer": "[5.979435,0.6667,true,4.563492,0.6667,true,15.563331,0.5556,true]", "id": "2965766"}]}