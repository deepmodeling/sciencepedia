{"hands_on_practices": [{"introduction": "Signaling pathways like the Ras-MAPK cascade are more than simple linear relays; they are sophisticated information processors. A core mechanism for this processing is the covalent modification cycle, where a protein is reversibly switched between active and inactive states by opposing enzymes. This exercise [@problem_id:2961613] delves into the foundational Goldbeter-Koshland model, which elegantly demonstrates how such a cycle, governed by Michaelis-Menten kinetics, can generate an ultrasensitive or switch-like response. By deriving this model, you will gain insight into how the MEK-ERK module can convert a graded input signal into a decisive, all-or-none output.", "problem": "In a covalent modification cycle modeling extracellular signal-regulated kinase (ERK) activation, extracellular signal-regulated kinase kinase (MEK) catalyzes the phosphorylation of ERK to its active, doubly phosphorylated form, and dual-specificity phosphatases (DUSPs) catalyze dephosphorylation back to the inactive form. Let the conserved total ERK concentration be $S_{T}$ and define the dimensionless active fraction $R \\equiv [\\mathrm{ERK}^{\\ast}]/S_{T}$, where $R \\in [0,1]$. Under the quasi-steady-state approximation for the enzyme–substrate complexes and assuming Michaelis–Menten kinetics for each enzyme, the forward and reverse rates are, respectively,\n$$\nv_{1}(R) \\;=\\; \\frac{V_{1}\\,(1 - R)}{K_{1} + 1 - R}\n\\quad\\text{and}\\quad\nv_{2}(R) \\;=\\; \\frac{V_{2}\\,R}{K_{2} + R},\n$$\nwhere $V_{1} \\equiv k_{\\mathrm{cat},1} E_{1,T}$ and $V_{2} \\equiv k_{\\mathrm{cat},2} E_{2,T}$ are the maximal velocities of MEK and DUSPs, and $K_{1} \\equiv K_{m,1}/S_{T}$, $K_{2} \\equiv K_{m,2}/S_{T}$ are the dimensionless Michaelis parameters. Starting only from mass conservation, the ordinary differential equation $dR/dt \\,=\\, v_{1}(R) - v_{2}(R)$, and the quasi-steady-state justification for $v_{1}$ and $v_{2}$ above, derive the exact closed-form steady-state solution $R^{\\ast}$ satisfying $v_{1}(R^{\\ast}) = v_{2}(R^{\\ast})$ and $0 \\le R^{\\ast} \\le 1$. Your final expression must be a single algebraic formula in terms of $V_{1}$, $V_{2}$, $K_{1}$, and $K_{2}$, with the correct quadratic branch explicitly chosen so that $R^{\\ast}$ is biologically admissible ($0 \\le R^{\\ast} \\le 1$) for all admissible parameters. Do not introduce any further approximations.\n\nThen, using biochemical features of ERK phosphorylation by MEK and dephosphorylation by dual-specificity phosphatases (DUSPs), state the parameter regime, in terms of the relative magnitudes of $K_{1}$, $K_{2}$ compared to $1$ and the relative size of $V_{1}$ versus $V_{2}$, under which the steady-state input–output relation $R^{\\ast}(V_{1},V_{2},K_{1},K_{2})$ is expected to display order $0$ ultrasensitivity, and justify your statement from first principles. The final numerical or analytic answer you report must be the single closed-form expression you derived for $R^{\\ast}$ without units. No rounding is required.", "solution": "The problem requires the derivation of the steady-state fraction of active ERK, denoted by $R^{\\ast}$, and an analysis of the parameter regime leading to ultrasensitivity. The validation confirms the problem is well-posed and scientifically grounded in the principles of enzyme kinetics and cell signaling.\n\nFirst, we derive the expression for the steady-state active fraction, $R^{\\ast}$. The steady state is defined by the condition where the rate of phosphorylation, $v_{1}$, equals the rate of dephosphorylation, $v_{2}$.\nThe given rate equations are:\n$$ v_{1}(R) = \\frac{V_{1}\\,(1 - R)}{K_{1} + 1 - R} $$\n$$ v_{2}(R) = \\frac{V_{2}\\,R}{K_{2} + R} $$\nAt steady state, $R = R^{\\ast}$ and $v_{1}(R^{\\ast}) = v_{2}(R^{\\ast})$.\n$$ \\frac{V_{1}\\,(1 - R^{\\ast})}{K_{1} + 1 - R^{\\ast}} = \\frac{V_{2}\\,R^{\\ast}}{K_{2} + R^{\\ast}} $$\nTo solve for $R^{\\ast}$, we cross-multiply to eliminate the denominators:\n$$ V_{1}(1 - R^{\\ast})(K_{2} + R^{\\ast}) = V_{2}R^{\\ast}(K_{1} + 1 - R^{\\ast}) $$\nExpanding both sides of the equation:\n$$ V_{1}(K_{2} + R^{\\ast} - K_{2}R^{\\ast} - (R^{\\ast})^2) = V_{2}(K_{1}R^{\\ast} + R^{\\ast} - (R^{\\ast})^2) $$\n$$ V_{1}K_{2} + V_{1}(1 - K_{2})R^{\\ast} - V_{1}(R^{\\ast})^2 = V_{2}(1 + K_{1})R^{\\ast} - V_{2}(R^{\\ast})^2 $$\nThis equation is rearranged into a standard quadratic form, $a(R^{\\ast})^2 + bR^{\\ast} + c = 0$:\n$$ (V_{2} - V_{1})(R^{\\ast})^2 + [V_{1}(1 - K_{2}) - V_{2}(1 + K_{1})]R^{\\ast} + V_{1}K_{2} = 0 $$\nThe coefficients of the quadratic equation are:\n$a = V_{2} - V_{1}$\n$b = V_{1}(1 - K_{2}) - V_{2}(1 + K_{1}) = V_{1} - V_{1}K_{2} - V_{2} - V_{2}K_{1}$\n$c = V_{1}K_{2}$\nThe solutions for $R^{\\ast}$ are given by the quadratic formula:\n$$ R^{\\ast} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\nWe must select the physically admissible root, which must satisfy $0 \\leq R^{\\ast} \\leq 1$ for all valid, non-negative parameter values ($V_1, V_2, K_1, K_2 > 0$). We can determine the correct sign by examining limiting cases.\nConsider the case where the kinase activity is zero, $V_{1} \\to 0$. We expect the substrate to be fully inactive, so $R^{\\ast} \\to 0$. In this limit, the coefficients become $a \\to V_2$, $b \\to -V_2(1+K_1)$, and $c \\to 0$. The quadratic equation simplifies to $V_{2}(R^{\\ast})^2 - V_{2}(1+K_{1})R^{\\ast} = 0$, which has solutions $R^{\\ast}=0$ and $R^{\\ast}=1+K_1$. Since $K_1>0$, the only admissible solution is $R^{\\ast}=0$. The quadratic formula gives $R^{\\ast} \\to \\frac{V_2(1+K_1) \\pm \\sqrt{V_2^2(1+K_1)^2}}{2V_2} = \\frac{1+K_1 \\pm (1+K_1)}{2}$. The minus sign yields $0$, while the plus sign yields $1+K_1$. Thus, we must choose the minus sign.\n\nConsider the case where the phosphatase activity is zero, $V_{2} \\to 0$. We expect the substrate to be fully active, so $R^{\\ast} \\to 1$. In this limit, the coefficients become $a \\to -V_1$, $b \\to V_1(1-K_2)$, and $c \\to V_1K_2$. The equation becomes $-V_1(R^{\\ast})^2 + V_1(1-K_2)R^{\\ast} + V_1K_2 = 0$, which simplifies to $(R^{\\ast})^2 - (1-K_2)R^{\\ast} - K_2 = 0$. This factors as $(R^{\\ast}-1)(R^{\\ast}+K_2)=0$, with solutions $R^{\\ast}=1$ and $R^{\\ast}=-K_2$. The only admissible solution is $R^{\\ast}=1$. The quadratic formula gives $R^{\\ast} \\to \\frac{-V_1(1-K_2) \\pm \\sqrt{V_1^2(1-K_2)^2 - 4(-V_1)(V_1K_2)}}{2(-V_1)} = \\frac{-(1-K_2) \\pm \\sqrt{(1-K_2)^2+4K_2}}{-2} = \\frac{-(1-K_2) \\pm \\sqrt{(1+K_2)^2}}{-2} = \\frac{-(1-K_2) \\pm (1+K_2)}{-2}$. The minus sign yields $\\frac{-1+K_2-1-K_2}{-2} = 1$, while the plus sign yields $\\frac{-1+K_2+1+K_2}{-2} = -K_2$. Again, we must choose the minus sign.\n\nTherefore, the unique, biologically admissible steady-state solution is:\n$$ R^{\\ast} = \\frac{-b - \\sqrt{b^2 - 4ac}}{2a} $$\nSubstituting the expressions for $a$, $b$, and $c$:\n$$ R^{\\ast} = \\frac{V_{2}(1+K_{1}) - V_{1}(1-K_{2}) - \\sqrt{\\left(V_{1}(1-K_{2}) - V_{2}(1+K_{1})\\right)^2 - 4(V_{2}-V_{1})V_{1}K_{2}}}{2(V_{2}-V_{1})} $$\nThis exact closed-form expression is valid for all admissible parameter values.\n\nNext, we address the conditions for order-$0$ ultrasensitivity. This phenomenon arises when the enzymes operate in their saturated, or zero-order, kinetic regimes.\nThe kinase, MEK, acts on inactive ERK, whose dimensionless concentration is $1-R$. MEK is saturated when its substrate concentration is much greater than its Michaelis constant, i.e., $S_{T}(1-R) \\gg K_{m,1}$. In dimensionless terms, this is $1-R \\gg K_1$.\nThe phosphatase, DUSP, acts on active ERK, whose dimensionless concentration is $R$. DUSP is saturated when $S_{T}R \\gg K_{m,2}$, which in dimensionless terms is $R \\gg K_2$.\nFor both enzymes to be simultaneously saturated, the system must satisfy $K_1 \\ll 1-R$ and $K_2 \\ll R$. This is possible only if $R$ is not close to $0$ or $1$, which in turn requires the dimensionless Michaelis parameters to be small compared to $1$:\n$$ K_{1} \\ll 1 \\quad \\text{and} \\quad K_{2} \\ll 1 $$\nUnder these conditions, the rate laws approximate to zero-order kinetics over a significant range of $R$.\nWhen $1-R \\gg K_1$, the forward rate $v_1(R) = \\frac{V_1(1-R)}{K_1+1-R} \\approx \\frac{V_1(1-R)}{1-R} = V_1$.\nWhen $R \\gg K_2$, the reverse rate $v_2(R) = \\frac{V_2 R}{K_2+R} \\approx \\frac{V_2 R}{R} = V_2$.\nAt steady state, $v_1 \\approx v_2$, which implies $V_1 \\approx V_2$. This establishes the region where the system response is most sensitive.\nIf $V_1 < V_2$, the net dephosphorylation rate is high, driving the system to a state where $R^{\\ast}$ is very small. In this OFF state, the DUSP is no longer saturated ($R^{\\ast} \\sim K_2$), but MEK remains saturated. The rates balance at a low $R^{\\ast}$ value.\nIf $V_1 > V_2$, the net phosphorylation rate is high, driving the system to a state where $R^{\\ast}$ is close to $1$. In this ON state, MEK is no longer saturated ($(1-R^{\\ast}) \\sim K_1$), but DUSP is saturated. The rates balance at a high $R^{\\ast}$ value.\nThe transition between the OFF state ($R^{\\ast} \\approx 0$) and the ON state ($R^{\\ast} \\approx 1$) occurs over a very narrow range of the stimulus (e.g., $V_1$) centered around the point $V_1 = V_2$. This sharp, switch-like transition is the hallmark of zero-order ultrasensitivity.\nIn summary, the parameter regime for order-$0$ ultrasensitivity is characterized by:\n1.  $K_1 \\ll 1$ and $K_2 \\ll 1$: Both enzymes have the potential to be saturated by their respective substrates, as their Michaelis constants are much smaller than the total substrate concentration $S_T$.\n2.  $V_1$ is comparable to $V_2$: The switching behavior is centered around the point where the maximal enzymatic capacities are balanced.", "answer": "$$\\boxed{\\frac{V_{2}(1+K_{1}) - V_{1}(1-K_{2}) - \\sqrt{\\left(V_{1}(1-K_{2}) - V_{2}(1+K_{1})\\right)^2 - 4(V_{2}-V_{1})V_{1}K_{2}}}{2(V_{2}-V_{1})}}$$", "id": "2961613"}, {"introduction": "Once ERK is activated, often in a switch-like manner, its ability to regulate cellular fate depends critically on its location. For ERK to fulfill its primary role as a regulator of gene expression, it must translocate from the cytoplasm into the nucleus to access its target transcription factors. This practice [@problem_id:2961663] challenges you to build a quantitative model of this nucleocytoplasmic shuttling. By calculating the steady-state distribution of phosphorylated ERK and its impact on gene induction, you will explore how the kinetics of protein transport act as a critical control layer that shapes the ultimate functional output of the Ras-MAPK cascade.", "problem": "A common control point in the Ras–Mitogen-Activated Protein Kinase (Ras–MAPK) signaling cascade is the nuclear translocation of phosphorylated Extracellular Signal-Regulated Kinase (phosphorylated ERK, pERK), which regulates transcriptional programs. Consider a two-compartment transport model for pERK shuttling between cytoplasm and nucleus with import and export governed by first-order mass-action kinetics. Let cytoplasmic pERK concentration be $C(t)$ and nuclear pERK concentration be $N(t)$. The import flux into the nucleus is proportional to $C(t)$ with rate constant $k_{\\mathrm{in}}$ and the export flux back to the cytoplasm is proportional to $N(t)$ with rate constant $k_{\\mathrm{out}}$. Assume that upstream signaling maintains a constant average pERK concentration across the two compartments, and that the nuclear and cytoplasmic volumes are equal. Specifically, the average concentration constraint is $S = \\frac{C(t) + N(t)}{2}$, with $S$ constant in time due to balanced phosphorylation and dephosphorylation under sustained signaling.\n\nDownstream gene induction is modeled as a Hill-type activation by nuclear pERK:\n$$I(N) = V_{\\max}\\,\\frac{N^{h}}{K^{h} + N^{h}},$$\nwhere $V_{\\max}$ is the maximal induction rate, $K$ is the apparent half-activation constant, and $h$ is the Hill coefficient.\n\nYou are given the following parameters for a baseline condition of sustained Ras–MAPK activation:\n- $k_{\\mathrm{in}} = 1.2\\,\\mathrm{min}^{-1}$,\n- $k_{\\mathrm{out}} = 0.8\\,\\mathrm{min}^{-1}$,\n- $S = 150\\,\\mathrm{nM}$,\n- $V_{\\max} = 1.0$ arbitrary units of induction per minute,\n- $K = 75\\,\\mathrm{nM}$,\n- $h = 2$.\n\nUsing only first principles of mass-action transport at steady state and conservation of average concentration across equal volumes, and the Hill-form activation above, determine the fold-change in the steady-state gene induction rate when the nuclear export rate constant is doubled to $2\\,k_{\\mathrm{out}}$, while $k_{\\mathrm{in}}$, $S$, $V_{\\max}$, $K$, and $h$ are held fixed.\n\nReport the fold-change as a pure number without units, rounding your final answer to four significant figures.", "solution": "The problem describes a two-compartment model for the nucleocytoplasmic shuttling of phosphorylated ERK (pERK). We are tasked with finding the fold-change in a downstream gene induction rate at steady state when the nuclear export rate constant is perturbed. The problem is scientifically grounded, well-posed, and all necessary parameters are provided for a quantitative solution.\n\nFirst, we establish the mathematical model for the system. Let $N(t)$ be the nuclear concentration of pERK and $C(t)$ be the cytoplasmic concentration. The transport is governed by first-order mass-action kinetics. The rate of change of nuclear pERK concentration is given by the balance of import and export fluxes. Assuming equal volumes for the nucleus and cytoplasm, the dynamics are described by the ordinary differential equation:\n$$ \\frac{dN(t)}{dt} = k_{\\mathrm{in}}C(t) - k_{\\mathrm{out}}N(t) $$\nwhere $k_{\\mathrm{in}}$ is the import rate constant and $k_{\\mathrm{out}}$ is the export rate constant.\n\nThe problem states a conservation constraint: the average concentration across the two compartments, $S$, is constant.\n$$ S = \\frac{C(t) + N(t)}{2} $$\nThis implies a constant total concentration: $C(t) + N(t) = 2S$. We can use this to eliminate $C(t)$ from the rate equation:\n$$ C(t) = 2S - N(t) $$\nSubstituting this into the differential equation gives:\n$$ \\frac{dN(t)}{dt} = k_{\\mathrm{in}}(2S - N(t)) - k_{\\mathrm{out}}N(t) $$\n\nTo find the steady-state concentration of nuclear pERK, denoted $N_{ss}$, we set the time derivative to zero, $\\frac{dN}{dt} = 0$:\n$$ k_{\\mathrm{in}}(2S - N_{ss}) - k_{\\mathrm{out}}N_{ss} = 0 $$\n$$ 2Sk_{\\mathrm{in}} - k_{\\mathrm{in}}N_{ss} = k_{\\mathrm{out}}N_{ss} $$\nSolving for $N_{ss}$, we obtain a general expression for the steady-state nuclear pERK concentration:\n$$ 2Sk_{\\mathrm{in}} = (k_{\\mathrm{in}} + k_{\\mathrm{out}})N_{ss} $$\n$$ N_{ss} = \\frac{2Sk_{\\mathrm{in}}}{k_{\\mathrm{in}} + k_{\\mathrm{out}}} $$\n\nWe now calculate $N_{ss}$ for the two conditions specified.\n\nCondition 1 (Baseline):\nThe parameters are $k_{\\mathrm{in},1} = 1.2\\,\\mathrm{min}^{-1}$, $k_{\\mathrm{out},1} = 0.8\\,\\mathrm{min}^{-1}$, and $S = 150\\,\\mathrm{nM}$.\n$$ N_{ss,1} = \\frac{2(150\\,\\mathrm{nM})(1.2\\,\\mathrm{min}^{-1})}{1.2\\,\\mathrm{min}^{-1} + 0.8\\,\\mathrm{min}^{-1}} = \\frac{360}{2.0}\\,\\mathrm{nM} = 180\\,\\mathrm{nM} $$\n\nCondition 2 (Perturbed):\nThe nuclear export rate constant is doubled, so $k_{\\mathrm{out},2} = 2 \\times k_{\\mathrm{out},1} = 2 \\times 0.8\\,\\mathrm{min}^{-1} = 1.6\\,\\mathrm{min}^{-1}$. All other parameters are unchanged, so $k_{\\mathrm{in},2} = 1.2\\,\\mathrm{min}^{-1}$ and $S = 150\\,\\mathrm{nM}$.\n$$ N_{ss,2} = \\frac{2(150\\,\\mathrm{nM})(1.2\\,\\mathrm{min}^{-1})}{1.2\\,\\mathrm{min}^{-1} + 1.6\\,\\mathrm{min}^{-1}} = \\frac{360}{2.8}\\,\\mathrm{nM} = \\frac{900}{7}\\,\\mathrm{nM} $$\n\nThe gene induction rate, $I(N)$, is described by a Hill equation:\n$$ I(N) = V_{\\max}\\,\\frac{N^{h}}{K^{h} + N^{h}} $$\nwith $V_{\\max} = 1.0$, $K = 75\\,\\mathrm{nM}$, and $h = 2$.\n\nThe fold-change is the ratio of the steady-state induction rate under Condition 2 to that under Condition 1, i.e., $\\frac{I_{ss,2}}{I_{ss,1}}$.\n$$ \\frac{I_{ss,2}}{I_{ss,1}} = \\frac{V_{\\max}\\,\\frac{N_{ss,2}^{h}}{K^{h} + N_{ss,2}^{h}}}{V_{\\max}\\,\\frac{N_{ss,1}^{h}}{K^{h} + N_{ss,1}^{h}}} = \\frac{\\frac{N_{ss,2}^{h}}{K^{h} + N_{ss,2}^{h}}}{\\frac{N_{ss,1}^{h}}{K^{h} + N_{ss,1}^{h}}} $$\nThis expression can be simplified by dividing the numerator and denominator of each Hill function by $K^h$:\n$$ \\frac{I_{ss,2}}{I_{ss,1}} = \\frac{\\frac{(N_{ss,2}/K)^{h}}{1 + (N_{ss,2}/K)^{h}}}{\\frac{(N_{ss,1}/K)^{h}}{1 + (N_{ss,1}/K)^{h}}} $$\nLet's calculate the ratios $N_{ss}/K$ for each condition.\nFor Condition 1:\n$$ \\frac{N_{ss,1}}{K} = \\frac{180\\,\\mathrm{nM}}{75\\,\\mathrm{nM}} = \\frac{12}{5} $$\nFor Condition 2:\n$$ \\frac{N_{ss,2}}{K} = \\frac{(900/7)\\,\\mathrm{nM}}{75\\,\\mathrm{nM}} = \\frac{900}{7 \\times 75} = \\frac{12}{7} $$\nNow we can evaluate the components of the fold-change ratio, with $h=2$:\n$$ I_{ss,1} \\propto \\frac{(N_{ss,1}/K)^2}{1+(N_{ss,1}/K)^2} = \\frac{(12/5)^2}{1+(12/5)^2} = \\frac{144/25}{1 + 144/25} = \\frac{144/25}{(25+144)/25} = \\frac{144}{169} $$\n$$ I_{ss,2} \\propto \\frac{(N_{ss,2}/K)^2}{1+(N_{ss,2}/K)^2} = \\frac{(12/7)^2}{1+(12/7)^2} = \\frac{144/49}{1 + 144/49} = \\frac{144/49}{(49+144)/49} = \\frac{144}{193} $$\nThe fold-change is the ratio of these values:\n$$ \\text{Fold-change} = \\frac{I_{ss,2}}{I_{ss,1}} = \\frac{144/193}{144/169} = \\frac{169}{193} $$\nTo obtain the final numerical answer, we perform the division and round to four significant figures:\n$$ \\frac{169}{193} \\approx 0.875647668... \\approx 0.8756 $$\nDoubling the nuclear export rate constant results in a decrease in the steady-state gene induction rate to approximately $87.56\\%$ of its baseline value.", "answer": "$$\\boxed{0.8756}$$", "id": "2961663"}, {"introduction": "The theoretical properties of signaling cascades, such as the ultrasensitivity explored previously, are ultimately tested and quantified through experimentation. When we measure the output of the Ras-MAPK pathway (e.g., ERK phosphorylation) as a function of input stimulus (e.g., growth factor concentration), the result is a dose-response curve that encapsulates the system's integrated behavior. This hands-on computational problem [@problem_id:2961642] guides you through the essential task of fitting a Hill model to such data. You will learn to extract key parameters like the half-maximal effective concentration ($EC_{50}$) and Hill coefficient ($n$), providing a quantitative description of the pathway's potency and cooperativity, and to assess the statistical confidence in your estimates.", "problem": "You are studying the Epidermal Growth Factor (EGF)-activated Ras-Mitogen-Activated Protein Kinase (Ras-MAPK) signaling cascade by measuring the steady-state fraction of phosphorylated extracellular signal-regulated kinase (ERK) as a function of extracellular ligand concentration. Assume the following foundational base that is routinely used for receptor-mediated signaling with cooperative activation: (i) receptor-ligand binding follows the law of mass action, (ii) the signaling output at steady state is a monotonic function of the fraction of occupied or activated receptor and its downstream cooperative steps, and (iii) measurement noise across doses is independent, identically distributed, Gaussian with constant variance. Under these assumptions, a cooperative activation model consistent with the fraction of activated Ras and the ensuing ERK phosphorylation maps ligand concentration $c$ to a response $y(c)$ using a saturable, monotonic, and cooperative function with four parameters: a basal response $B$ (unitless fraction), a maximal response $T$ (unitless fraction), a half-maximal effective concentration $EC_{50}$ (in nM), and a Hill coefficient $n$ (unitless, $n>0$). The parameter $EC_{50}$ is defined as the concentration $c$ at which the response is halfway between $B$ and $T$. Nonlinear regression under Gaussian noise implies that the maximum likelihood estimates of the parameters minimize the sum of squared residuals.\n\nTask: For each dataset below, fit a cooperative activation model consistent with points (i)–(iii) and with parameters ($B,T,EC_{50},n$) to the provided dose-response data by nonlinear least squares. Then, using the asymptotic normal approximation of the parameter estimates, compute a two-sided $0.95$ confidence interval for $EC_{50}$ from the estimated parameter covariance (use a Student $t$ distribution quantile with degrees of freedom equal to the number of data points minus the number of parameters). The final results must be reported in nanomolar (nM).\n\nDatasets (each response is the steady-state fraction of phosphorylated ERK, unitless):\n\n- Dataset A (EGF in a canonical epithelial line; “happy path” with broad coverage)\n  - Concentrations in nM: $0$, $0.1$, $0.3$, $1$, $3$, $10$, $30$.\n  - Responses (unitless): $0.050$, $0.077$, $0.130$, $0.328$, $0.605$, $0.843$, $0.911$.\n\n- Dataset B (Nerve Growth Factor-like cooperative regime in a Ras-dependent context)\n  - Concentrations in nM: $0$, $0.01$, $0.03$, $0.1$, $0.3$, $1$, $3$, $10$.\n  - Responses (unitless): $0.020$, $0.0208$, $0.0272$, $0.096$, $0.380$, $0.694$, $0.739$, $0.743$.\n\n- Dataset C (mutant with shallow dose sensitivity; incomplete saturation within tested range)\n  - Concentrations in nM: $0$, $1$, $3$, $10$, $30$, $100$.\n  - Responses (unitless): $0.100$, $0.157$, $0.203$, $0.295$, $0.382$, $0.484$.\n\n- Dataset D (near-zero basal response; broader dynamic range and higher $EC_{50}$)\n  - Concentrations in nM: $0$, $5$, $10$, $30$, $50$, $100$, $300$.\n  - Responses (unitless): $0.000$, $0.033$, $0.086$, $0.314$, $0.503$, $0.743$, $0.930$.\n\nRequirements and constraints for fitting:\n- Use a four-parameter cooperative activation model with parameters ($B,T,EC_{50},n$) such that $0 \\le B \\le T \\le 1$, $EC_{50} > 0$ in nM, and $n \\in (0,5]$.\n- Use nonlinear least squares to estimate all four parameters simultaneously.\n- Use the Jacobian-based asymptotic covariance of the parameter estimates to compute the standard error of $EC_{50}$, and form a two-sided $0.95$ confidence interval using a Student $t$ quantile with degrees of freedom $N-4$, where $N$ is the number of data points in the dataset.\n- Express $EC_{50}$ and its confidence interval bounds in nM as floating-point numbers.\n- Round all reported numeric outputs to $4$ significant figures.\n\nTest suite and expected output:\n- The program must process all four datasets A–D as a fixed test suite.\n- For each dataset, compute and return a triple containing the estimated $EC_{50}$ (in nM) and the lower and upper bounds of its two-sided $0.95$ confidence interval (in nM), each rounded to $4$ significant figures.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each dataset’s triple enclosed in its own bracket and ordered as $[A,B,C,D]$. For example, the format must be exactly like $[[a\\_1,a\\_2,a\\_3],[b\\_1,b\\_2,b\\_3],[c\\_1,c\\_2,c\\_3],[d\\_1,d\\_2,d\\_3]]$, where each $a\\_i$, $b\\_i$, $c\\_i$, $d\\_i$ is a floating-point number in nM rounded to $4$ significant figures. No additional text may be printed.", "solution": "We connect the biological mechanism of the Ras-Mitogen-Activated Protein Kinase (Ras-MAPK) cascade to a cooperative dose-response model using first principles. The receptor-ligand interaction is governed by the law of mass action: the fraction of occupied receptors increases monotonically with ligand concentration $c$. Downstream recruitment and activation steps in Ras-MAPK can manifest cooperativity, effectively yielding a response that depends on $c$ through a sigmoidal transformation with an exponent $n$. At steady state, a minimal and widely used mapping consistent with these principles is a saturable, monotonic function with parameters for basal activity $B$, maximal activity $T$, a half-maximal concentration $EC_{50}$, and a Hill coefficient $n$ controlling apparent cooperativity. The half-maximal effective concentration $EC_{50}$ is defined by the condition that the response is halfway between $B$ and $T$.\n\nFrom the statistical perspective, assume independent, identically distributed Gaussian noise with constant variance across concentrations; then the maximum likelihood estimates of parameters minimize the sum of squared residuals. Therefore, nonlinear least squares is an appropriate estimator. Let the model be denoted as\n$$\ny(c; \\theta) \\equiv B + (T - B)\\,\\frac{c^{n}}{EC_{50}^{n} + c^{n}},\n$$\nwith parameter vector $\\theta = (B, T, EC_{50}, n)$. The constraints $0 \\le B \\le T \\le 1$, $EC_{50} > 0$, and $n \\in (0,5]$ enforce biological realism (responses are fractions, concentrations are positive, and cooperativity is finite and positive).\n\nGiven data $\\{(c_i, y_i)\\}_{i=1}^{N}$, the nonlinear least-squares estimator solves\n$$\n\\hat{\\theta} = \\arg\\min_{\\theta} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\theta)\\right]^2.\n$$\nUnder standard regularity conditions, $\\hat{\\theta}$ is asymptotically normal with covariance approximated by the inverse of the observed Fisher information. The Gauss–Newton approximation yields\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\theta}) \\approx s^2 \\left(J^\\top J\\right)^{-1},\n$$\nwhere $J$ is the Jacobian matrix with entries\n$$\nJ_{i,k} = \\frac{\\partial y(c_i;\\theta)}{\\partial \\theta_k}\\Bigg|_{\\theta=\\hat{\\theta}},\n$$\nand $s^2$ is the residual variance estimator\n$$\ns^2 = \\frac{1}{N - p} \\sum_{i=1}^{N} \\left[y_i - y(c_i;\\hat{\\theta})\\right]^2,\n$$\nwith $p=4$ the number of parameters. Many software implementations of nonlinear least squares, including trust-region reflective algorithms, compute an estimate of $\\left(J^\\top J\\right)^{-1}$ and scale it by $s^2$ to produce an estimate of the parameter covariance matrix.\n\nTo compute a two-sided $0.95$ confidence interval for $EC_{50}$, extract the variance estimate of the $EC_{50}$ component, $\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})$, as the corresponding diagonal entry of the covariance matrix. The standard error is\n$$\n\\mathrm{SE}(\\widehat{EC_{50}}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{EC_{50}})}.\n$$\nWith degrees of freedom $\\nu = N - p$, the two-sided confidence interval at level $0.95$ is\n$$\n\\widehat{EC_{50}} \\pm t_{1 - \\alpha/2,\\,\\nu}\\ \\mathrm{SE}(\\widehat{EC_{50}}),\n$$\nwhere $\\alpha = 1 - 0.95 = 0.05$, and $t_{1 - \\alpha/2,\\,\\nu}$ is the $(1 - \\alpha/2)$ quantile of the Student $t$ distribution with $\\nu$ degrees of freedom.\n\nAlgorithmic plan for each dataset:\n1. Assemble the vectors of concentrations $c_i$ (in nM) and responses $y_i$ (unitless).\n2. Fit the four-parameter model $y(c;\\theta)$ by nonlinear least squares with bound constraints $0 \\le B \\le 1$, $0 \\le T \\le 1$, $EC_{50} \\in (0, \\infty)$, and $n \\in (0,5]$. An effective initialization is $B$ at the minimum observed response, $T$ at the maximum observed response, $EC_{50}$ at the median of the positive concentrations, and $n$ at $1$.\n3. Obtain the Jacobian-based parameter covariance matrix and compute the standard error of $\\widehat{EC_{50}}$.\n4. With $\\nu = N - 4$, compute $t_{1 - 0.025,\\,\\nu}$ and form the two-sided $0.95$ confidence interval for $EC_{50}$.\n5. Express the point estimate and interval bounds in nM and round each to $4$ significant figures.\n6. Output a single line with four triples in order $[A,B,C,D]$ using the format $[[a_1,a_2,a_3],[b_1,b_2,b_3],[c_1,c_2,c_3],[d_1,d_2,d_3]]$ where, for each dataset, the triple is $[\\widehat{EC_{50}}, \\mathrm{CI}_{\\mathrm{low}}, \\mathrm{CI}_{\\mathrm{high}}]$.\n\nThe provided datasets cover complementary regimes important for Ras-MAPK signaling inference: a typical sigmoidal response with good dynamic range, a highly cooperative regime with sub-nanomolar sensitivity, a shallow slope with incomplete saturation that challenges identifiability, and a near-zero basal regime spanning over two orders of magnitude in concentration. The nonlinear regression with bounds and asymptotic covariance computation together produce scientifically meaningful $EC_{50}$ estimates with confidence intervals, all in nanomolar units, suitable for comparing signaling sensitivities across conditions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import t as student_t\n\ndef hill_response(c, B, T, EC50, n):\n    # Cooperative activation model, c in nM, responses unitless\n    # Ensure safe power for zero concentration: c**n is 0 when c=0 and n>0\n    return B + (T - B) * (np.power(c, n)) / (np.power(EC50, n) + np.power(c, n))\n\ndef fit_hill_and_ci(c, y):\n    c = np.asarray(c, dtype=float)\n    y = np.asarray(y, dtype=float)\n\n    # Initial guesses\n    B0 = float(np.clip(np.min(y), 0.0, 1.0))\n    T0 = float(np.clip(np.max(y), 0.0, 1.0))\n    # Avoid EC50 initialization at 0 due to zero concentrations; use median of positive concentrations\n    positive_c = c[c > 0]\n    EC500 = float(np.median(positive_c)) if positive_c.size > 0 else 1.0\n    n0 = 1.0\n\n    p0 = [B0, T0, EC500, n0]\n\n    # Bounds: 0 <= B <= 1, 0 <= T <= 1, EC50 in (1e-12, 1e9], n in (1e-6, 5]\n    # Also enforce B <= T by using independent bounds and relying on optimizer; data typically ensure B<=T.\n    lower_bounds = [0.0, 0.0, 1e-12, 1e-6]\n    upper_bounds = [1.0, 1.0, 1e9, 5.0]\n\n    # Fit\n    popt, pcov = curve_fit(\n        hill_response, c, y,\n        p0=p0, bounds=(lower_bounds, upper_bounds),\n        method='trf', max_nfev=10000\n    )\n\n    # Degrees of freedom\n    N = y.size\n    p = 4\n    dof = max(N - p, 1)\n\n    # curve_fit with absolute_sigma=False scales pcov by reduced chi^2 internally,\n    # but we will keep it as provided (already scaled) for standard errors.\n    # Extract standard error for EC50\n    se = np.sqrt(np.diag(pcov))\n    se_ec50 = float(se[2])\n\n    ec50_hat = float(popt[2])\n\n    # Two-sided 95% CI using Student t\n    alpha = 0.05\n    tcrit = float(student_t.ppf(1 - alpha/2.0, dof))\n    ci_low = ec50_hat - tcrit * se_ec50\n    ci_high = ec50_hat + tcrit * se_ec50\n\n    # Enforce positivity for CI bounds (biologically EC50 > 0)\n    ci_low = max(ci_low, 0.0)\n\n    return ec50_hat, ci_low, ci_high\n\ndef round_sig(x, sig=4):\n    if x == 0 or not np.isfinite(x):\n        return \"0\"\n    # Use general format with specified significant digits\n    return f\"{x:.{sig}g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Dataset A\n    c_A = np.array([0.0, 0.1, 0.3, 1.0, 3.0, 10.0, 30.0], dtype=float)\n    y_A = np.array([0.050, 0.077, 0.130, 0.328, 0.605, 0.843, 0.911], dtype=float)\n\n    # Dataset B\n    c_B = np.array([0.0, 0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0], dtype=float)\n    y_B = np.array([0.020, 0.0208, 0.0272, 0.096, 0.380, 0.694, 0.739, 0.743], dtype=float)\n\n    # Dataset C\n    c_C = np.array([0.0, 1.0, 3.0, 10.0, 30.0, 100.0], dtype=float)\n    y_C = np.array([0.100, 0.157, 0.203, 0.295, 0.382, 0.484], dtype=float)\n\n    # Dataset D\n    c_D = np.array([0.0, 5.0, 10.0, 30.0, 50.0, 100.0, 300.0], dtype=float)\n    y_D = np.array([0.000, 0.033, 0.086, 0.314, 0.503, 0.743, 0.930], dtype=float)\n\n    test_cases = [\n        (c_A, y_A),\n        (c_B, y_B),\n        (c_C, y_C),\n        (c_D, y_D),\n    ]\n\n    results = []\n    for c, y in test_cases:\n        ec50_hat, ci_low, ci_high = fit_hill_and_ci(c, y)\n        # Round to 4 significant figures as strings\n        results.append([round_sig(ec50_hat, 4), round_sig(ci_low, 4), round_sig(ci_high, 4)])\n\n    # Final print statement in the exact required format.\n    # Ensure single-line, nested list with comma-separated values.\n    formatted = \"[\" + \",\".join(\"[\" + \",\".join(map(str, triple)) + \"]\" for triple in results) + \"]\"\n    print(formatted)\n\nsolve()\n```", "id": "2961642"}]}