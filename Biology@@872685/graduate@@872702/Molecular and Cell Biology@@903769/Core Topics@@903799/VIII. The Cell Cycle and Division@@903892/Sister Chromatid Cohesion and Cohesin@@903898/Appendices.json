{"hands_on_practices": [{"introduction": "Understanding the function of molecular machines like cohesin begins with dissecting their power source: the ATP hydrolysis cycle. This exercise challenges you to predict the system-wide consequences of a specific biochemical defect—a mutation that blocks ATP hydrolysis but not ATP binding. By working through this scenario [@problem_id:2964819], you will build a crucial mental model connecting the elementary steps of cohesin's motor activity to its essential in vivo functions, including chromosome loading, loop extrusion, and dynamic turnover.", "problem": "A Structural Maintenance of Chromosomes (SMC) family adenosine triphosphatase (ATPase) within cohesin uses an ATP-driven mechanochemical cycle to load onto DNA, extrude loops, and dynamically exchange on and off chromatin. Consider a Walker B mutation in Smc3 that abolishes ATP hydrolysis while retaining ATP binding and head engagement. Assume the following foundational facts: (i) ATP binding promotes SMC head engagement and DNA gripping with the loader Nipped-B-like protein (NIPBL, also called Scc2), (ii) at least $1$ ATP hydrolysis event per cycle is required to complete productive topological loading (DNA entrapment) and to transition between gripping and slipping states central to loop extrusion, and (iii) non-nucleolytic release mediated by Wings apart-like protein (Wapl) requires an ATP hydrolysis-dependent head disengagement step. Using a minimal kinetic schema in which productive loading frequency scales with a hydrolysis-dependent rate $k_{\\mathrm{load}}$, loop extrusion velocity $v$ scales with the ATP turnover rate $k_{\\mathrm{cat}}$, and residence time on chromatin $\\tau$ scales inversely with an ATP hydrolysis-dependent off-rate $k_{\\mathrm{off}}$ via $\\tau \\approx 1/k_{\\mathrm{off}}$, predict the qualitative direction of change in vivo for the following observables relative to wild type: (a) loading frequency, (b) loop extrusion velocity, and (c) chromatin residence time. Choose the best single option.\n\nA. Loading frequency decreases; loop extrusion velocity approaches zero; residence time increases.\n\nB. Loading frequency increases; loop extrusion velocity increases; residence time decreases.\n\nC. Loading frequency is unchanged; loop extrusion velocity approaches zero; residence time is unchanged.\n\nD. Loading frequency decreases; loop extrusion velocity is unchanged; residence time decreases.\n\nE. Loading frequency increases; loop extrusion velocity approaches zero; residence time increases.", "solution": "The problem statement will be validated before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\nThe problem provides the following information:\n1.  **System**: A Structural Maintenance of Chromosomes (SMC) family adenosine triphosphatase (ATPase), specifically the cohesin complex.\n2.  **Function**: The complex uses an ATP-driven mechanochemical cycle for three key processes: loading onto DNA, extruding DNA loops, and dynamic exchange on and off chromatin.\n3.  **Perturbation**: A Walker B mutation in the Smc3 subunit.\n4.  **Consequence of Mutation**: This mutation abolishes ATP hydrolysis but preserves ATP binding and SMC head engagement.\n5.  **Premise (i)**: ATP binding is necessary for SMC head engagement and for gripping DNA in conjunction with the loader protein NIPBL (Scc2).\n6.  **Premise (ii)**: A minimum of one ($1$) ATP hydrolysis event per cycle is essential for two processes: (a) completing productive topological loading (i.e., DNA entrapment) and (b) transitioning between gripping and slipping states, which is fundamental to loop extrusion.\n7.  **Premise (iii)**: The Wapl-mediated release of cohesin from chromatin (non-nucleolytic release) is dependent on an ATP hydrolysis-driven head disengagement step.\n8.  **Kinetic Model**:\n    *   Productive loading frequency is proportional to a hydrolysis-dependent rate, $k_{\\mathrm{load}}$.\n    *   Loop extrusion velocity, $v$, is proportional to the ATP turnover rate, $k_{\\mathrm{cat}}$.\n    *   Chromatin residence time, $\\tau$, is approximately the inverse of an ATP hydrolysis-dependent off-rate, $k_{\\mathrm{off}}$, such that $\\tau \\approx 1/k_{\\mathrm{off}}$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is assessed against the required criteria:\n*   **Scientific Grounding**: The problem is rooted in established principles of molecular and cell biology concerning the function of the cohesin complex. The roles of ATP binding and hydrolysis, the Walker B motif, loading and release factors (NIPBL, Wapl), and the process of loop extrusion are all consistent with current scientific literature. The described mutation is a standard experimental tool for investigating ATPase mechanisms. The problem is scientifically sound.\n*   **Well-Posedness**: The problem defines a specific perturbation (the mutation) and its direct biochemical effect (no hydrolysis). It then asks for the qualitative effects on three clearly defined observables based on a set of explicit premises and a simplified kinetic model. This structure allows for a unique and logical solution to be derived.\n*   **Objectivity**: The language is technical, precise, and devoid of subjective or ambiguous terminology.\n*   **Completeness and Consistency**: The problem is self-contained. It provides all necessary axioms—the \"foundational facts\" and the \"minimal kinetic schema\"—to deduce the answer without requiring external information that would contradict the setup. The premises are internally consistent.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is a well-formulated question in molecular biophysics. I will proceed with the derivation of the solution.\n\n### Solution Derivation\n\nThe central element of this problem is the specified mutation in the Walker B motif of Smc3, which results in the abolishment of ATP hydrolysis while retaining the capacity for ATP binding and subsequent head engagement. The complex is therefore arrested in an ATP-bound, head-engaged conformation. We will analyze the consequences for each of the three specified observables based on the provided premises.\n\n**1. Analysis of Loading Frequency**\nThe problem states that productive loading frequency scales with a hydrolysis-dependent rate $k_{\\mathrm{load}}$. Furthermore, premise (ii) explicitly states that \"at least $1$ ATP hydrolysis event per cycle is required to complete productive topological loading\". Since the mutation abolishes ATP hydrolysis, the cycle cannot proceed past the initial ATP-bound, head-engaged state to achieve topological entrapment of DNA. The rate-limiting step for productive loading, which requires hydrolysis, has its rate constant effectively reduced to zero. Consequently, the rate of productive loading, $k_{\\mathrm{load}}$, must decrease precipitously. While an initial, non-productive association with DNA might occur (premise (i)), the conversion of this state into a topologically loaded complex is blocked. Therefore, the overall loading frequency decreases.\n\n**2. Analysis of Loop Extrusion Velocity**\nThe problem defines that the loop extrusion velocity, $v$, scales with the ATP turnover rate, $k_{\\mathrm{cat}}$. The ATP turnover rate is the rate of the full cycle: ATP binding, hydrolysis, and product release. The mutation halts the cycle at the hydrolysis step. This means the cycle cannot be completed, so the turnover rate $k_{\\mathrm{cat}}$ becomes zero. As $v$ is proportional to $k_{\\mathrm{cat}}$, the loop extrusion velocity $v$ must approach zero. This conclusion is reinforced by premise (ii), which indicates that the state transitions necessary for loop extrusion are dependent on ATP hydrolysis. Without hydrolysis, the complex is locked in a static DNA-gripping state and cannot perform the iterative steps of the extrusion process.\n\n**3. Analysis of Chromatin Residence Time**\nThe residence time on chromatin, $\\tau$, is given by the relation $\\tau \\approx 1/k_{\\mathrm{off}}$, where $k_{\\mathrm{off}}$ is an ATP hydrolysis-dependent off-rate. Premise (iii) establishes that the primary mechanism for cohesin release from chromatin, mediated by Wapl, requires an ATP hydrolysis-dependent step for SMC head disengagement. By abolishing ATP hydrolysis, the mutation prevents this head disengagement and thus blocks the Wapl-mediated release pathway. This causes the off-rate, $k_{\\mathrm{off}}$, to approach zero. As a result, the residence time $\\tau$, being inversely proportional to $k_{\\mathrm{off}}$, will increase dramatically, theoretically approaching infinity. The mutant cohesin complex becomes trapped on the chromatin.\n\n**Summary of Predictions:**\n*   (a) Loading frequency: Decreases.\n*   (b) Loop extrusion velocity: Approaches zero.\n*   (c) Chromatin residence time: Increases.\n\n### Evaluation of Options\n\n*   **A. Loading frequency decreases; loop extrusion velocity approaches zero; residence time increases.** This option perfectly matches the derived consequences for all three observables. **Correct**.\n\n*   **B. Loading frequency increases; loop extrusion velocity increases; residence time decreases.** This option is incorrect for all three observables. The lack of ATP hydrolysis blocks all these processes or, in the case of residence time, has the opposite effect. **Incorrect**.\n\n*   **C. Loading frequency is unchanged; loop extrusion velocity approaches zero; residence time is unchanged.** This option is incorrect regarding loading frequency and residence time. Productive loading is hydrolysis-dependent, and the blockage of release significantly increases residence time. **Incorrect**.\n\n*   **D. Loading frequency decreases; loop extrusion velocity is unchanged; residence time decreases.** This option is incorrect regarding loop extrusion velocity and residence time. Velocity depends on ATP turnover, and residence time is increased, not decreased. **Incorrect**.\n\n*   **E. Loading frequency increases; loop extrusion velocity approaches zero; residence time increases.** This option incorrectly states that loading frequency increases. It conflates the initial DNA binding and head engagement (which may be stabilized by the ATP-bound state) with the overall frequency of *productive* topological loading, which is strictly dependent on hydrolysis and is therefore blocked. **Incorrect**.\n\nBased on this rigorous analysis, only option A is consistent with the provided model of cohesin function and the effects of the specified mutation.", "answer": "$$\\boxed{A}$$", "id": "2964819"}, {"introduction": "After understanding cohesin's ATPase engine, we can model how this motor activity gives rise to large-scale chromosome architecture. This problem asks you to develop a simple but powerful biophysical model of loop extrusion, treating it as a stochastic process limited by cohesin's residence time on chromatin [@problem_id:2964790]. By deriving the relationship between microscopic motor properties and the expected size of a chromatin loop, you will gain insight into how dynamic molecular events sculpt the stable, kilobase-scale domains observed in genome-wide experiments.", "problem": "A single cohesin complex is hypothesized to generate chromatin loops by active loop extrusion while topologically embracing the chromatin fiber. Consider the following minimal, lifetime-limited loop extrusion model appropriate for a single extruding cohesin complex on interphase chromatin: while bound, the cohesin extrudes at a constant linear speed $v$ along one chromatin arm (one-sided extrusion), starting from zero loop size at binding, and stops extrusion upon dissociation. Assume:\n- Binding lifetimes are independent and identically distributed across events and are exponentially distributed with mean $\\tau$ (i.e., a memoryless unbinding process consistent with a Poisson dissociation hazard).\n- There are no impermeable barriers within the relevant scale so that loop size is limited by dissociation rather than boundary encounters.\n- The High-throughput Chromosome Conformation Capture (Hi-C) observed characteristic Topologically Associating Domain (TAD) size reflects the expected loop size under this lifetime-limited regime.\n\nStarting from these assumptions and fundamental definitions of expectation for random variables, derive an expression for the expected loop length in terms of $v$ and $\\tau$, and then use it to infer the cohesin mean lifetime $\\tau$ given the following empirically grounded values:\n- Extrusion speed $v = 1.2$ kilobases per second.\n- Characteristic Hi-C TAD size $L_{\\text{obs}} = 480$ kilobases.\n\nTreat the characteristic TAD size as the expected loop length under the model. Compute the numerical value of $\\tau$ implied by these observations. Round your final result to three significant figures and express the answer in seconds. Do not include units in your final boxed answer.", "solution": "The problem presents a simplified, yet scientifically grounded, model for chromatin loop extrusion by a single cohesin complex. It is well-posed, with all necessary parameters and assumptions clearly stated. The task is to first derive the expected loop size under the given stochastic model and then use this result to infer a model parameter from empirical data. The problem is valid, and we shall proceed with its solution.\n\nLet $T$ be the random variable representing the lifetime of the cohesin complex on chromatin. The problem states that $T$ is exponentially distributed with a mean of $\\tau$. The probability density function (PDF) of $T$ is given by:\n$$\np(t) = \n\\begin{cases} \n\\frac{1}{\\tau} \\exp\\left(-\\frac{t}{\\tau}\\right) & \\text{for } t \\ge 0 \\\\\n0 & \\text{for } t < 0\n\\end{cases}\n$$\nThe cohesin complex extrudes a DNA loop at a constant linear speed $v$, starting from a loop of size zero. The extrusion is one-sided, so the length of the loop at time $t$ is $L(t) = v \\cdot t$. Since the process terminates upon dissociation at time $T$, the final loop length, $L$, is a random variable determined by the value of $T$: $L = vT$.\n\nWe are tasked to derive the expected loop length, $E[L]$, starting from the fundamental definition of expectation for a continuous random variable.\n$$\nE[L] = E[vT] = \\int_{0}^{\\infty} L(t) p(t) \\,dt\n$$\nSubstituting the expressions for $L(t) = vt$ and $p(t)$:\n$$\nE[L] = \\int_{0}^{\\infty} (vt) \\left( \\frac{1}{\\tau} \\exp\\left(-\\frac{t}{\\tau}\\right) \\right) \\,dt\n$$\nSince $v$ and $\\frac{1}{\\tau}$ are constants, we can factor them out of the integral:\n$$\nE[L] = \\frac{v}{\\tau} \\int_{0}^{\\infty} t \\exp\\left(-\\frac{t}{\\tau}\\right) \\,dt\n$$\nTo solve this integral, we use integration by parts, which states $\\int u \\,d w = u w - \\int w \\,du$. We choose $u = t$ and $d w = \\exp\\left(-\\frac{t}{\\tau}\\right) dt$. This gives $du = dt$ and $w = \\int \\exp\\left(-\\frac{t}{\\tau}\\right) dt = -\\tau \\exp\\left(-\\frac{t}{\\tau}\\right)$. Applying the formula:\n$$\n\\int_{0}^{\\infty} t \\exp\\left(-\\frac{t}{\\tau}\\right) \\,dt = \\left[ t \\left(-\\tau \\exp\\left(-\\frac{t}{\\tau}\\right)\\right) \\right]_{0}^{\\infty} - \\int_{0}^{\\infty} \\left(-\\tau \\exp\\left(-\\frac{t}{\\tau}\\right)\\right) \\,dt\n$$\nThe boundary term is evaluated as:\n$$\n\\left[ -t\\tau \\exp\\left(-\\frac{t}{\\tau}\\right) \\right]_{0}^{\\infty} = \\lim_{t \\to \\infty} \\left(-t\\tau \\exp\\left(-\\frac{t}{\\tau}\\right)\\right) - (0) = 0\n$$\nThe limit is $0$ because the exponential function decays to zero much faster than the linear function $t$ grows. This leaves us with the second term:\n$$\n- \\int_{0}^{\\infty} \\left(-\\tau \\exp\\left(-\\frac{t}{\\tau}\\right)\\right) \\,dt = \\tau \\int_{0}^{\\infty} \\exp\\left(-\\frac{t}{\\tau}\\right) \\,dt\n$$\nThis definite integral evaluates to:\n$$\n\\tau \\left[ -\\tau \\exp\\left(-\\frac{t}{\\tau}\\right) \\right]_{0}^{\\infty} = \\tau \\left( (0) - \\left(-\\tau \\exp(0)\\right) \\right) = \\tau(0 - (-\\tau)) = \\tau^2\n$$\nSubstituting this result back into our expression for $E[L]$:\n$$\nE[L] = \\frac{v}{\\tau} (\\tau^2) = v\\tau\n$$\nThis is the derived expression for the expected loop length. As a check, note that $E[L] = E[vT] = vE[T]$. Since $E[T] = \\tau$ for an exponential distribution with rate parameter $1/\\tau$, the result is correct.\n\nThe problem posits that the characteristic Hi-C TAD size, $L_{\\text{obs}}$, corresponds to this expected loop length:\n$$\nL_{\\text{obs}} = E[L] = v\\tau\n$$\nWe are to infer the cohesin mean lifetime, $\\tau$, using the provided empirical values:\n- $v = 1.2$ kilobases per second.\n- $L_{\\text{obs}} = 480$ kilobases.\n\nWe rearrange the equation to solve for $\\tau$:\n$$\n\\tau = \\frac{L_{\\text{obs}}}{v}\n$$\nNow, substitute the numerical values:\n$$\n\\tau = \\frac{480 \\text{ kb}}{1.2 \\text{ kb/s}}\n$$\nThe units of kilobases (kb) cancel, yielding a result in seconds (s).\n$$\n\\tau = \\frac{480}{1.2} \\text{ s} = \\frac{4800}{12} \\text{ s} = 400 \\text{ s}\n$$\nThe question specifies that the final result must be rounded to three significant figures. The number $400$ can be written in scientific notation as $4.00 \\times 10^2$, which demonstrates it has three significant figures. Thus, the value of $400$ is already in the required format.", "answer": "$$\\boxed{400}$$", "id": "2964790"}, {"introduction": "The final step in connecting mechanism to function is to analyze the experimental data that reveals cohesin's impact on genome architecture. This practice provides a hands-on introduction to the computational analysis of chromosome contact maps, data typically generated by techniques like Hi-C [@problem_id:2964851]. You will implement a method to quantify the strength of domain boundaries and use statistical testing to rigorously evaluate the central hypothesis that cohesin is required for their maintenance, bridging the gap between molecular theory and data-driven discovery.", "problem": "You are given multiple replicate chromosome contact matrices representing locus-locus contact frequencies before and after depletion of the Cohesin complex. The goal is to formalize and compute an insulation-based boundary strength at specified candidate indices, then test whether boundary strength decreases upon Cohesin depletion using a one-sided paired test across matched replicates with multiple hypothesis correction across indices.\n\nFoundational definitions:\n- Let a chromosome contact map be represented by a symmetric matrix $C \\in \\mathbb{R}_{\\ge 0}^{N \\times N}$ with $C_{ab} = C_{ba}$ denoting the contact frequency between bins $a$ and $b$, where $0 \\le a,b \\le N-1$.\n- For a bin index $i$ and a positive integer window radius $w$, define the crossing-sum $S_i(C; w)$ as the total contact frequency in the window that crosses the vertical partition between bins $i$ and $i+1$:\n$$\nS_i(C; w) \\equiv \\sum_{a = \\max(0,\\, i-w+1)}^{i} \\;\\; \\sum_{b = i+1}^{\\min(N-1,\\, i+w)} C_{ab}.\n$$\n- For numerical stability, define a pseudocount $\\varepsilon > 0$ and the stabilized log-crossing $X_i(C; w, \\varepsilon) \\equiv \\ln\\!\\big(S_i(C; w) + \\varepsilon\\big)$.\n- For a flank size $d \\in \\mathbb{N}$, define the boundary strength at index $i$ as the contrast between the average log-crossing of the flanks and the log-crossing at the center:\n$$\nB_i(C; w, d, \\varepsilon) \\equiv \\frac{1}{2}\\left(\\frac{1}{d}\\sum_{k=1}^{d} X_{i-k}(C; w, \\varepsilon) + \\frac{1}{d}\\sum_{k=1}^{d} X_{i+k}(C; w, \\varepsilon)\\right) - X_i(C; w, \\varepsilon).\n$$\n- Eligibility: For $B_i(C; w, d, \\varepsilon)$ to be well-defined without edge clipping, $i$ must satisfy $i - d \\ge w - 1$ and $i + d \\le N - 1 - w$. Only such $i$ are eligible for hypothesis testing.\n\nStatistical testing across matched replicates:\n- Suppose we have $R$ matched replicate contact matrices for the control condition (before Cohesin depletion), $\\{C^{\\text{pre}}_r\\}_{r=1}^{R}$, and $R$ matched replicate contact matrices for the experimental condition (after Cohesin depletion), $\\{C^{\\text{post}}_r\\}_{r=1}^{R}$. For each eligible index $i$, compute paired replicate boundary strengths in each condition and form the differences\n$$\nD_{i,r} \\equiv B_i\\!\\left(C^{\\text{post}}_r; w, d, \\varepsilon\\right) - B_i\\!\\left(C^{\\text{pre}}_r; w, d, \\varepsilon\\right), \\quad r = 1,\\dots,R.\n$$\n- Perform a one-sided paired $t$-test for each eligible $i$ to assess the null hypothesis $H_0: \\mu_i \\ge 0$ against the alternative $H_1: \\mu_i &lt; 0$, where $\\mu_i$ is the population mean of $D_{i,r}$. Let $\\bar{D}_i$ be the sample mean of $\\{D_{i,r}\\}_{r=1}^{R}$ and $s_i$ be the sample standard deviation with $R-1$ degrees of freedom. The test statistic is\n$$\nt_i \\equiv \\frac{\\bar{D}_i}{s_i / \\sqrt{R}}.\n$$\nIf $s_i = 0$, define the one-sided $p$-value by the conservative rule: if $\\bar{D}_i &lt; 0$ then $p_i = 0$, if $\\bar{D}_i = 0$ then $p_i = 0.5$, and if $\\bar{D}_i &gt; 0$ then $p_i = 1$. Otherwise, when $s_i &gt; 0$, define $p_i$ as the cumulative distribution function of the Student $t$-distribution with $R-1$ degrees of freedom evaluated at $t_i$:\n$$\np_i \\equiv F_{t_{R-1}}(t_i).\n$$\n- Across the $m$ eligible indices in the candidate set, correct for multiple hypothesis testing using the Benjamini–Hochberg procedure at a false discovery rate level $\\alpha \\in (0,1)$. Let the $m$ $p$-values be sorted in ascending order $p_{(1)} \\le \\dots \\le p_{(m)}$. Find\n$$\nk^\\star \\equiv \\max\\left\\{ k \\in \\{1,\\dots,m\\} \\,\\middle|\\, p_{(k)} \\le \\frac{k}{m}\\alpha \\right\\},\n$$\nif such $k^\\star$ exists; otherwise, no hypotheses are rejected. Reject all hypotheses with $p_i \\le p_{(k^\\star)}$. Report the total number of rejections.\n\nYour task:\n- Implement the above definitions and statistical testing for each provided test case.\n- For each test case, output a single integer: the number of candidate indices declared significant (i.e., boundary strength decreased after Cohesin depletion) after Benjamini–Hochberg correction at the specified $\\alpha$.\n- Aggregate the results across all test cases into a single line as a comma-separated list enclosed in square brackets.\n\nTest suite:\nFor each test case, you are given:\n- The list of candidate boundary indices $\\mathcal{I}$ (zero-based).\n- Lists of matched replicate matrices before and after Cohesin depletion.\n- The parameters $w$, $d$, $\\varepsilon$, and $\\alpha$.\n\nAll matrices are symmetric with nonnegative entries and small sizes to allow direct implementation.\n\nTest case 1 (happy path, clear decrease at one interior boundary):\n- $N = 8$, $R = 4$, $\\mathcal{I} = [3, 1, 6]$, $w = 2$, $d = 1$, $\\varepsilon = 10^{-6}$, $\\alpha = 0.1$.\n- For each replicate $r \\in \\{1,2,3,4\\}$, define baseline contacts $C_{ab} = 10$ for all $a &lt; b$, with symmetry $C_{ba} = C_{ab}$ and $C_{aa} = 0$. Modify only the four crossing cells of the partition at $i = 3$: the cells $(2,4)$, $(2,5)$, $(3,4)$, $(3,5)$.\n    - Replicate 1: pre values set to $2$, post values set to $20$ at those four cells.\n    - Replicate 2: pre values set to $3$, post values set to $19$ at those four cells.\n    - Replicate 3: pre values set to $2.5$, post values set to $18$ at those four cells.\n    - Replicate 4: pre values set to $3.5$, post values set to $21$ at those four cells.\n- All other matrix entries remain at the baseline $10$.\n\nTest case 2 (eligibility boundary condition and no change):\n- $N = 7$, $R = 3$, $\\mathcal{I} = [1, 5, 3]$, $w = 2$, $d = 2$, $\\varepsilon = 10^{-6}$, $\\alpha = 0.2$.\n- For each replicate $r \\in \\{1,2,3\\}$ and both conditions (pre and post), set all off-diagonal entries to $10$, enforce symmetry, and set $C_{aa} = 0$. There is no difference between conditions. Indices that do not satisfy the eligibility constraints must be excluded from testing.\n\nTest case 3 (boundary strength increases, not decreases):\n- $N = 6$, $R = 4$, $\\mathcal{I} = [2, 3]$, $w = 1$, $d = 1$, $\\varepsilon = 10^{-6}$, $\\alpha = 0.05$.\n- For each replicate $r \\in \\{1,2,3,4\\}$, set a baseline of $5$ for all off-diagonal entries, symmetric with $C_{aa} = 0$. Modify only the single crossing cell at the partition $i = 3$ with $w = 1$, which is $(3,4)$:\n    - Pre: $(3,4) = (4,3) = 5$ (baseline).\n    - Post: $(3,4) = (4,3) = 1$ (reduced crossing), all others remain baseline.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where each result is the integer number of significant decreases in boundary strength discovered for the corresponding test case.", "solution": "The problem statement is subjected to rigorous validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\nThe problem provides the following definitions and procedures:\n- A chromosome contact map is a symmetric matrix $C \\in \\mathbb{R}_{\\ge 0}^{N \\times N}$.\n- The crossing-sum at index $i$ with window radius $w$ is $S_i(C; w) \\equiv \\sum_{a = \\max(0,\\, i-w+1)}^{i} \\;\\; \\sum_{b = i+1}^{\\min(N-1,\\, i+w)} C_{ab}$.\n- The stabilized log-crossing is $X_i(C; w, \\varepsilon) \\equiv \\ln\\!\\big(S_i(C; w) + \\varepsilon\\big)$ for a pseudocount $\\varepsilon > 0$.\n- The boundary strength at index $i$ with flank size $d$ is $B_i(C; w, d, \\varepsilon) \\equiv \\frac{1}{2}\\left(\\frac{1}{d}\\sum_{k=1}^{d} X_{i-k}(C; w, \\varepsilon) + \\frac{1}{d}\\sum_{k=1}^{d} X_{i+k}(C; w, \\varepsilon)\\right) - X_i(C; w, \\varepsilon)$.\n- An index $i$ is eligible for testing if and only if $i - d \\ge w - 1$ and $i + d \\le N - 1 - w$.\n- For $R$ matched replicates of pre- and post-depletion matrices, $\\{C^{\\text{pre}}_r\\}_{r=1}^{R}$ and $\\{C^{\\text{post}}_r\\}_{r=1}^{R}$, the paired difference is $D_{i,r} \\equiv B_i\\!\\left(C^{\\text{post}}_r\\right) - B_i\\!\\left(C^{\\text{pre}}_r\\right)$.\n- A one-sided paired $t$-test is performed on the differences $\\{D_{i,r}\\}_{r=1}^R$ for each eligible index $i$ to test $H_0: \\mu_i \\ge 0$ against $H_1: \\mu_i < 0$.\n- The test statistic is $t_i \\equiv \\frac{\\bar{D}_i}{s_i / \\sqrt{R}}$, where $\\bar{D}_i$ and $s_i$ are the sample mean and sample standard deviation.\n- The $p$-value $p_i$ is calculated from the cumulative distribution function of the Student's $t$-distribution, $F_{t_{R-1}}(t_i)$, with special handling for the case $s_i=0$.\n- Multiple hypothesis testing across $m$ eligible indices is corrected using the Benjamini–Hochberg procedure at a false discovery rate $\\alpha$, with the specific rule to find $k^\\star \\equiv \\max\\left\\{ k \\in \\{1,\\dots,m\\} \\,\\middle|\\, p_{(k)} \\le \\frac{k}{m}\\alpha \\right\\}$ and reject all hypotheses with $p_i \\le p_{(k^\\star)}$.\n- Three specific test cases are provided with all parameters and data generation rules.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded:** The problem is rooted in the established biological context of chromosome architecture. The protein complex Cohesin is known to be a primary driver of topologically associating domains (TADs). The concept of an \"insulation score\" or \"boundary strength\" is a standard method for quantifying TAD boundaries from chromosome conformation capture data (like Hi-C). The hypothesis that Cohesin depletion weakens these boundaries (i.e., decreases their strength) is a central tenet in the field. The provided formulas are a reasonable and explicit formalization of these concepts.\n- **Well-Posed and Objective:** The problem is mathematically rigorous. All terms are explicitly defined with precise formulas. The statistical procedure, including handling of edge cases ($s_i=0$) and multiple testing correction, is specified without ambiguity. The problem is stated in objective, formal language.\n- **Completeness and Consistency:** The problem is self-contained. Each test case includes all necessary parameters ($N, R, \\mathcal{I}, w, d, \\varepsilon, \\alpha$) and unambiguous instructions for constructing the input matrices. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a well-defined, scientifically sound, and computationally tractable problem. A solution will be provided.\n\n### Principle-Based Design of the Solution\nThe task is to implement the specified computational pipeline to determine the number of genomic boundaries whose strength significantly decreases upon Cohesin depletion across multiple test scenarios. The solution is constructed by systematically implementing the provided definitions.\n\n1.  **Eligibility Filtering:** For each test case, the list of candidate indices $\\mathcal{I}$ is first filtered to retain only those indices $i$ that are \"eligible\" for boundary strength calculation without edge artifacts. An index $i$ is eligible if it satisfies the dual conditions $i - d \\ge w - 1$ and $i + d \\le N - 1 - w$, where $N$ is the matrix dimension, $w$ is the window radius, and $d$ is the flank size. If no indices are eligible, the analysis for that test case terminates with zero significant findings.\n\n2.  **Boundary Strength Calculation:** The core of the analysis is the function $B_i(C; w, d, \\varepsilon)$, which quantifies the boundary strength. Its computation is hierarchical:\n    - First, the crossing-sum $S_i(C; w)$ is calculated for a given matrix $C$, index $i$, and window $w$. This sum represents the total contact frequency across the partition at $i$ within a specified diamond-shaped region. The summation is performed over matrix elements $C_{ab}$ where $a \\in [\\max(0,\\, i-w+1), i]$ and $b \\in [i+1, \\min(N-1,\\, i+w)]$.\n    - Second, the stabilized log-crossing $X_i(C; w, \\varepsilon) = \\ln(S_i(C; w) + \\varepsilon)$ is computed. The logarithm transforms the highly skewed contact frequencies, and the pseudocount $\\varepsilon$ ensures numerical stability for small or zero sums.\n    - Finally, the boundary strength $B_i$ is computed as the difference between the average log-crossing of the flanking regions and the log-crossing at the center: $B_i = \\frac{1}{2d} \\sum_{k=1}^{d} (X_{i-k} + X_{i+k}) - X_i$. A high positive value indicates strong insulation (a good boundary), as crossing at $i$ is low compared to its neighborhood.\n\n3.  **Paired Statistical Testing:** For each eligible index $i$, we assess the change in boundary strength between the 'pre' and 'post' Cohesin depletion conditions.\n    - For each replicate $r \\in \\{1,\\dots,R\\}$, the paired difference $D_{i,r} = B_i(C^{\\text{post}}_r) - B_i(C^{\\text{pre}}_r)$ is calculated. A negative value for $D_{i,r}$ indicates a decrease in boundary strength for that replicate.\n    - The set of differences $\\{D_{i,r}\\}_{r=1}^R$ is then subjected to a one-sided paired $t$-test. The null hypothesis $H_0: \\mu_i \\ge 0$ (no decrease in mean boundary strength) is tested against the alternative $H_1: \\mu_i < 0$ (a decrease in mean boundary strength).\n    - The sample mean $\\bar{D}_i$ and sample standard deviation $s_i$ (with $R-1$ degrees of freedom) are computed.\n    - A special rule handles the case where $s_i=0$: if $\\bar{D}_i < 0$, $p_i=0$; if $\\bar{D}_i = 0$, $p_i=0.5$; if $\\bar{D}_i > 0$, $p_i=1$.\n    - If $s_i > 0$, the $t$-statistic $t_i = \\bar{D}_i / (s_i / \\sqrt{R})$ is computed, and the $p$-value $p_i$ is obtained from the cumulative distribution function of the Student's $t$-distribution with $R-1$ degrees of freedom, $p_i = F_{t_{R-1}}(t_i)$.\n\n4.  **Multiple Hypothesis Correction:** The set of $p$-values $\\{p_i\\}$ for all $m$ eligible indices must be corrected for multiple comparisons. The Benjamini–Hochberg (BH) procedure is applied at a specified false discovery rate $\\alpha$.\n    - The $m$ p-values are sorted in ascending order: $p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$.\n    - The largest integer $k^\\star$ is found such that $p_{(k^\\star)} \\le \\frac{k^\\star}{m}\\alpha$.\n    - If such a $k^\\star$ exists, the significance threshold is set to $p_{(k^\\star)}$. The final result is the count of all original (unsorted) $p$-values, $p_i$, that are less than or equal to this threshold. If no such $k^\\star$ exists, no hypotheses are rejected, and the count is zero.\n\nThis structured, principle-based approach ensures a correct and robust implementation of the specified biological data analysis problem.", "answer": "[1,0,0]", "id": "2964851"}]}