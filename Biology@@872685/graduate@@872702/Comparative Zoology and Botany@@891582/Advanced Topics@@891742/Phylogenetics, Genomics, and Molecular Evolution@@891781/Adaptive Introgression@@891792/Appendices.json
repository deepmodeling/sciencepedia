{"hands_on_practices": [{"introduction": "One of the most fundamental tasks in the study of adaptive introgression is its initial detection from genome-wide data. The four-taxon ABBA-BABA test, or D-statistic, provides a powerful framework for this by testing for a significant excess of shared derived alleles between non-sister taxa. This exercise ([@problem_id:2544491]) provides hands-on practice in calculating the D-statistic and, crucially, estimating its statistical significance using the block jackknife procedure to account for linkage among sites.", "problem": "A four-taxon test for adaptive introgression is conducted using genome-wide biallelic Single Nucleotide Polymorphisms (SNPs) arranged into non-overlapping physical blocks to account for linkage. The taxa are arranged as $\\left(P_{1},P_{2},P_{3};O\\right)$, where $O$ is an outgroup. Under the null hypothesis of no introgression and only Incomplete Lineage Sorting (ILS), the expected counts of the site-patterns $\\mathrm{ABBA}$ and $\\mathrm{BABA}$ are equal. The D-statistic quantifies asymmetry in these counts. The genome is partitioned into $B=50$ equal-length blocks for block-resampling.\n\nAcross the full dataset, the total counts are $\\mathrm{ABBA}=320$ and $\\mathrm{BABA}=280$. The delete-one block-jackknife (leaving out one block at a time) is performed to assess uncertainty. Let $\\hat{D}_{(-b)}$ denote the D-statistic computed from the data with block $b$ removed, and let $\\bar{D}_{\\mathrm{LOO}}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$ be the mean of the leave-one-out estimates. From the $B=50$ leave-one-out replicates, the sum of squared deviations is observed to be\n$$\n\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}.\n$$\n\nUsing only fundamental definitions underlying the $\\mathrm{ABBA}$–$\\mathrm{BABA}$ framework and the delete-one jackknife, do the following:\n- Derive the expression for the genome-wide D-statistic from the total counts and compute its value.\n- Starting from the definition of the delete-one jackknife variance estimator, derive the estimator in terms of $B$ and the leave-one-out deviations, then compute the jackknife standard error and the corresponding $Z$-score for testing the null hypothesis that $D=0$.\n\nReport your final answer as a row matrix $\\left[D,\\;Z\\right]$, where both entries are rounded to four significant figures and expressed as pure decimals (no units).", "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains all necessary information for a complete solution. It describes a standard application of the D-statistic (ABBA-BABA test) combined with a block jackknife procedure for variance estimation, which are established methods in population genomics. The provided data are consistent and plausible. We will therefore proceed with a full derivation and computation.\n\nFirst, we derive and compute the genome-wide D-statistic, denoted as $\\hat{D}$. This statistic quantifies the asymmetry between the counts of two alternative gene tree topologies, represented by $\\mathrm{ABBA}$ and $\\mathrm{BABA}$ site patterns. Let $n_{\\mathrm{ABBA}}$ and $n_{\\mathrm{BABA}}$ be the total counts of these patterns over the entire genome. The D-statistic is defined as the normalized difference of these counts:\n$$\n\\hat{D} = \\frac{n_{\\mathrm{ABBA}} - n_{\\mathrm{BABA}}}{n_{\\mathrm{ABBA}} + n_{\\mathrm{BABA}}}\n$$\nThe problem provides the total counts: $n_{\\mathrm{ABBA}} = 320$ and $n_{\\mathrm{BABA}} = 280$. Substituting these values into the formula yields:\n$$\n\\hat{D} = \\frac{320 - 280}{320 + 280} = \\frac{40}{600} = \\frac{1}{15}\n$$\nThe numerical value is $\\hat{D} \\approx 0.066667$.\n\nNext, we address the uncertainty estimation and hypothesis testing using the delete-one block jackknife. We are asked to derive the variance estimator. Let $\\hat{D}$ be the statistic computed from the full dataset of $B$ blocks, and let $\\hat{D}_{(-b)}$ be the statistic recomputed with block $b$ omitted. The jackknife pseudo-values, $J_b$, are defined for each block $b \\in \\{1, 2, ..., B\\}$ as:\n$$\nJ_b = B \\hat{D} - (B-1)\\hat{D}_{(-b)}\n$$\nThe jackknife variance estimator for $\\hat{D}$ is given by the sample variance of the pseudo-values divided by the number of blocks $B$:\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} (J_b - \\bar{J})^2\n$$\nwhere $\\bar{J}$ is the mean of the pseudo-values, $\\bar{J} = \\frac{1}{B}\\sum_{b=1}^{B} J_b$. To proceed, we express this variance in terms of the leave-one-out estimates $\\hat{D}_{(-b)}$. First, we find the mean pseudo-value $\\bar{J}$:\n$$\n\\bar{J} = \\frac{1}{B} \\sum_{b=1}^{B} [B \\hat{D} - (B-1)\\hat{D}_{(-b)}] = B \\hat{D} - \\frac{B-1}{B} \\sum_{b=1}^{B} \\hat{D}_{(-b)} = B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\n$$\nwhere $\\bar{D}_{\\mathrm{LOO}} = \\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$ is the mean of the leave-one-out estimates. The deviation of a single pseudo-value from the mean is:\n$$\nJ_b - \\bar{J} = \\left[B \\hat{D} - (B-1)\\hat{D}_{(-b)}\\right] - \\left[B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\\right] = -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})\n$$\nSubstituting this result into the variance formula:\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} \\left[ -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}}) \\right]^2 = \\frac{(B-1)^2}{B(B-1)} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\nThis simplifies to the desired expression for the delete-one jackknife variance estimator:\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{B-1}{B} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\nWith this derived, we can now compute its value. We are given $B=50$ and the sum of squared deviations $\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}$.\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{50-1}{50} (2.296 \\times 10^{-4}) = \\frac{49}{50} (2.296 \\times 10^{-4}) = 0.98 \\times 2.296 \\times 10^{-4} = 2.25008 \\times 10^{-4}\n$$\nThe jackknife standard error, $\\mathrm{SE}_J(\\hat{D})$, is the square root of the variance:\n$$\n\\mathrm{SE}_J(\\hat{D}) = \\sqrt{\\widehat{\\mathrm{Var}}_{J}(\\hat{D})} = \\sqrt{2.25008 \\times 10^{-4}} \\approx 0.01500027\n$$\nFinally, we calculate the $Z$-score for testing the null hypothesis $H_0: D=0$. The $Z$-score is the ratio of the estimated statistic to its standard error:\n$$\nZ = \\frac{\\hat{D} - D_{H_0}}{\\mathrm{SE}_J(\\hat{D})} = \\frac{\\hat{D}}{\\mathrm{SE}_J(\\hat{D})}\n$$\nUsing the computed values for $\\hat{D}$ and $\\mathrm{SE}_J(\\hat{D})$:\n$$\nZ = \\frac{1/15}{0.01500027} \\approx \\frac{0.066666...}{0.01500027} \\approx 4.44439\n$$\nThe problem requires the final answer to be reported as a row matrix $[D, Z]$ with both values rounded to four significant figures.\n$D = 0.066666... \\approx 0.06667$\n$Z = 4.44439... \\approx 4.444$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06667 & 4.444\n\\end{pmatrix}\n}\n$$", "id": "2544491"}, {"introduction": "After detecting introgression, the next question is often about the evolutionary fate of the transferred genetic material. If an introgressed allele is beneficial, it can sweep through the recipient population, and modeling this process is key to understanding the 'adaptive' component of adaptive introgression. This practice ([@problem_id:2544560]) challenges you to derive from first principles the classic logistic growth trajectory of an advantageous allele, a cornerstone model in population genetics that describes its increase in frequency over time.", "problem": "An introgressed allele $A$ conferring high-altitude tolerance has entered two distinct taxa through adaptive introgression: a montane mammal and an alpine grass. After a brief hybridization pulse at time $t=0$, the allele is present in the recipient population at frequency $p_{0} \\in (0,1)$. Thereafter, the population is large, randomly mating, and closed (no migration), so that genetic drift and further gene flow are negligible. Assume that selection acts additively on Malthusian fitness in continuous time: each copy of allele $A$ contributes an additive increase $s>0$ to the per-capita growth rate, so that genotype Malthusian fitnesses are $r_{AA}=2s$, $r_{Aa}=s$, and $r_{aa}=0$. Assume Hardy–Weinberg genotype proportions at each instant due to random mating and that the continuous-time deterministic selection dynamics apply.\n\nUsing only these assumptions and the definition of the continuous-time selection (replicator) dynamics for genotype frequencies—namely that genotype frequency $x_{i}$ changes according to $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$, where $\\bar{r}$ is the mean Malthusian fitness—derive from first principles the expected allele frequency trajectory $p(t)$ for $t \\ge 0$ with initial condition $p(0)=p_{0}$. Then, define the time to half-fixation $t_{1/2}$ as the time at which $p(t)=\\frac{1}{2}$, and determine $t_{1/2}$ in terms of $s$ and $p_{0}$. Treat time $t$ in units of generations and $s$ as a per-generation Malthusian selection coefficient. Provide your final answers as closed-form analytic expressions for $p(t)$ and $t_{1/2}$. No numerical rounding is required.", "solution": "The problem statement will first be subjected to a rigorous validation procedure before any attempt at a solution is made.\n\n### Step 1: Extract Givens\nThe explicit information provided in the problem statement is as follows:\n- An introgressed allele is denoted by $A$.\n- Hybridization occurs at time $t=0$.\n- The initial frequency of allele $A$ is $p(0) = p_{0}$, where $p_{0} \\in (0,1)$.\n- The population is large, randomly mating, and closed, such that genetic drift and migration are negligible.\n- Selection acts additively on Malthusian fitness in continuous time.\n- The additive increase in per-capita growth rate for each copy of allele $A$ is $s>0$.\n- Genotype Malthusian fitnesses are specified as: $r_{AA}=2s$, $r_{Aa}=s$, and $r_{aa}=0$.\n- Hardy–Weinberg genotype proportions are assumed at each instant.\n- The dynamics of genotype frequency $x_{i}$ are governed by the differential equation $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$, where $\\bar{r}$ is the mean Malthusian fitness.\n- The task is to derive the allele frequency trajectory $p(t)$ for $t \\ge 0$.\n- The task includes defining and determining the time to half-fixation, $t_{1/2}$, where $p(t_{1/2})=\\frac{1}{2}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria.\n\n- **Scientifically Grounded:** The problem is a classic application of deterministic population genetics theory. The continuous-time replicator equation, Malthusian fitness, additive selection, and the Hardy-Weinberg principle are fundamental and well-established concepts in theoretical biology. The scenario of adaptive introgression is a known evolutionary process. The problem is scientifically sound.\n- **Well-Posed:** The problem provides a well-defined initial value problem based on a first-order ordinary differential equation. It provides all necessary parameters ($p_0$, $s$) and functional forms (fitnesses, dynamics) to derive a unique solution for $p(t)$ and subsequently $t_{1/2}$. The problem is well-posed.\n- **Objective:** The problem is stated using precise, formal, and objective mathematical and biological terminology. It contains no subjective or opinion-based statements.\n- **Incomplete or Contradictory Setup:** The problem provides a complete set of assumptions and definitions required for its solution. There are no internal contradictions.\n- **Unrealistic or Infeasible:** The model is an idealization, as all models are, but it is not scientifically implausible or physically impossible. It represents a standard limiting case in population genetics theory.\n- **Other Flaws:** The problem is not metaphorical, trivial, or tautological. It requires a rigorous derivation from first principles, which is a substantive exercise.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard, well-posed problem in mathematical population genetics. I will now proceed with the derivation of the solution.\n\nThe task is to derive the trajectory of the allele frequency $p(t)$ from first principles. We are given the dynamics for genotype frequencies, so we must first relate the change in allele frequency, $\\dot{p}$, to the change in genotype frequencies.\n\nThe frequency of allele $A$, denoted by $p$, is related to the frequencies of genotypes $AA$ and $Aa$ (denoted $x_{AA}$ and $x_{Aa}$, respectively) by the relation:\n$$\np = x_{AA} + \\frac{1}{2}x_{Aa}\n$$\nThe problem assumes Hardy-Weinberg proportions hold at all times due to random mating. This means the genotype frequencies can be expressed in terms of the allele frequency $p$ and its alternative $q=1-p$:\n$$\nx_{AA} = p^2 \\quad , \\quad x_{Aa} = 2p(1-p) \\quad , \\quad x_{aa} = (1-p)^2\n$$\nThe mean Malthusian fitness of the population, $\\bar{r}$, is the average of the genotype fitnesses weighted by their frequencies:\n$$\n\\bar{r} = x_{AA}r_{AA} + x_{Aa}r_{Aa} + x_{aa}r_{aa}\n$$\nSubstituting the Hardy-Weinberg proportions and the given fitness values ($r_{AA}=2s$, $r_{Aa}=s$, $r_{aa}=0$):\n$$\n\\bar{r} = p^2(2s) + 2p(1-p)(s) + (1-p)^2(0) = 2sp^2 + 2sp - 2sp^2 = 2sp\n$$\nThis linear relationship between mean fitness and allele frequency is a characteristic property of additive selection.\n\nNow, we derive the differential equation for $p(t)$. We differentiate the expression for $p$ with respect to time $t$:\n$$\n\\dot{p} = \\frac{dp}{dt} = \\frac{d}{dt}\\left(x_{AA} + \\frac{1}{2}x_{Aa}\\right) = \\dot{x}_{AA} + \\frac{1}{2}\\dot{x}_{Aa}\n$$\nWe substitute the given replicator dynamics, $\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$:\n$$\n\\dot{p} = x_{AA}(r_{AA} - \\bar{r}) + \\frac{1}{2}x_{Aa}(r_{Aa} - \\bar{r})\n$$\nNow, substitute the Hardy-Weinberg proportions and the expressions for fitnesses and mean fitness:\n$$\n\\dot{p} = p^2(2s - 2sp) + \\frac{1}{2}[2p(1-p)](s - 2sp)\n$$\nFactor out common terms:\n$$\n\\dot{p} = p^2(2s(1-p)) + p(1-p)(s(1-2p))\n$$\nWe can factor out $sp(1-p)$ from both terms:\n$$\n\\dot{p} = sp(1-p)[2p + (1-2p)]\n$$\nThe term in the square brackets simplifies to $1$:\n$$\n\\dot{p} = sp(1-p)\n$$\nThis is the logistic differential equation for the allele frequency under additive selection. To find $p(t)$, we must solve this equation with the initial condition $p(0)=p_0$. This is a separable equation:\n$$\n\\frac{dp}{p(1-p)} = s \\, dt\n$$\nWe integrate both sides. The left-hand side is integrated using partial fraction decomposition. We let $\\frac{1}{p(1-p)} = \\frac{C_1}{p} + \\frac{C_2}{1-p}$. This gives $1 = C_1(1-p) + C_2 p$, which yields $C_1=1$ and $C_2=1$.\n$$\n\\int \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = \\int s \\, dt\n$$\nPerforming the integration gives:\n$$\n\\ln|p| - \\ln|1-p| = st + K\n$$\nwhere $K$ is the constant of integration. Since $p \\in (0,1)$, the absolute values are not necessary.\n$$\n\\ln\\left(\\frac{p}{1-p}\\right) = st + K\n$$\nThis quantity, $\\ln(p/(1-p))$, is the logit of the frequency $p$. To find $K$, we apply the initial condition $p(0)=p_0$:\n$$\n\\ln\\left(\\frac{p_0}{1-p_0}\\right) = s(0) + K \\implies K = \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\nSubstituting $K$ back into the equation:\n$$\n\\ln\\left(\\frac{p(t)}{1-p(t)}\\right) = st + \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\nTo solve for $p(t)$, we first exponentiate both sides:\n$$\n\\frac{p(t)}{1-p(t)} = \\exp\\left(st + \\ln\\left(\\frac{p_0}{1-p_0}\\right)\\right) = \\exp(st) \\exp\\left(\\ln\\left(\\frac{p_0}{1-p_0}\\right)\\right) = \\frac{p_0}{1-p_0}\\exp(st)\n$$\nLet this right-hand side be $Z(t)$. Then $p(t) = Z(t)(1-p(t)) = Z(t) - Z(t)p(t)$.\n$$\np(t)(1+Z(t)) = Z(t) \\implies p(t) = \\frac{Z(t)}{1+Z(t)}\n$$\nSubstituting the expression for $Z(t)$:\n$$\np(t) = \\frac{\\frac{p_0}{1-p_0}\\exp(st)}{1 + \\frac{p_0}{1-p_0}\\exp(st)}\n$$\nMultiplying the numerator and denominator by $(1-p_0)$ simplifies the expression to its final form:\n$$\np(t) = \\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)}\n$$\nThis is the first required result.\n\nNext, we must find the time to half-fixation, $t_{1/2}$, defined as the time when $p(t_{1/2}) = \\frac{1}{2}$. We set our solution for $p(t)$ equal to $\\frac{1}{2}$:\n$$\n\\frac{1}{2} = \\frac{p_0 \\exp(st_{1/2})}{(1-p_0) + p_0 \\exp(st_{1/2})}\n$$\nCross-multiplying gives:\n$$\n(1-p_0) + p_0 \\exp(st_{1/2}) = 2 p_0 \\exp(st_{1/2})\n$$\nRearranging to solve for the exponential term:\n$$\n1-p_0 = 2 p_0 \\exp(st_{1/2}) - p_0 \\exp(st_{1/2}) = p_0 \\exp(st_{1/2})\n$$\n$$\n\\exp(st_{1/2}) = \\frac{1-p_0}{p_0}\n$$\nTaking the natural logarithm of both sides:\n$$\nst_{1/2} = \\ln\\left(\\frac{1-p_0}{p_0}\\right)\n$$\nFinally, solving for $t_{1/2}$:\n$$\nt_{1/2} = \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n$$\nThis expression can also be written as $t_{1/2} = -\\frac{1}{s}\\ln\\left(\\frac{p_0}{1-p_0}\\right)$. Note that for $p_0 < \\frac{1}{2}$, the argument of the logarithm is greater than $1$, so $t_{1/2} > 0$. If $p_0 = \\frac{1}{2}$, $t_{1/2} = 0$, as expected. This completes the derivation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)} & \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2544560"}, {"introduction": "Adaptive introgression involves the transfer of entire chromosomal segments, or 'tracts', whose lengths are shaped by recombination over generations. The distribution of these tract lengths provides a rich signal for inferring the timing and strength of past admixture events. This advanced exercise ([@problem_id:2688969]) first guides you through deriving the neutral expectation for tract lengths and then extends the model to show how positive selection can skew this distribution, causing longer, beneficial tracts to be overrepresented in the population.", "problem": "Consider a single-pulse admixture model in which a donor population contributed ancestry to a recipient population exactly $T$ generations ago. Assume a continuous genome with genetic map measured in Morgans, a uniform per-generation crossover rate $r$ per Morgan per generation, independent recombination across generations, and no gene conversion. Focus on a single chromosome in a present-day sampled haplotype descended from the admixture event.\n\nPart A (neutral tracts): Using only the following foundational facts: (i) crossovers along the genome in a single meiosis form a spatial Poisson process with rate $r$ per Morgan; (ii) across $T$ generations along a lineage, superposition of independent Poisson processes yields another Poisson process whose rate is the sum of the individual rates; and (iii) the distances between successive points in a Poisson process are independent and identically distributed exponential random variables, derive the distribution of the length $L$ of a contiguous donor-ancestry tract observed today under neutrality. Explicitly identify the probability density function of $L$ and its mean as functions of $r$ and $T$.\n\nPart B (selection favoring longer tracts): Now suppose there is selection that favors introgressed tracts in a way that increases the relative weight of longer tracts. Specifically, assume that along any tract of length $L$ (in Morgans), the number $K$ of introgressed donor-specific beneficial sites is Poisson with mean $\\mu L$, where $\\mu$ is the density (per Morgan) of such sites. Each beneficial site that remains introgressed and is carried by the haplotype multiplies fitness by a factor $(1+s)$ independently, with $s > 0$, and fitness effects are multiplicative across sites. Assume that, at the time of sampling, the probability of sampling a haplotype is proportional to its expected multiplicative fitness with respect to these sites. Under the additional assumption that $rT > \\mu \\ln(1+s)$ (so that the resulting distribution is normalizable), derive the reweighted tract-length density and compute its mean in closed form.\n\nAnswer specification: Provide as your final answer a single closed-form analytic expression for the mean tract length under the selection model in Part B as a function of $r$, $T$, $\\mu$, and $s$. Do not include any units in your final answer. No numerical rounding is required.", "solution": "The problem as stated is scientifically grounded, self-contained, and well-posed, permitting a rigorous solution. We shall proceed with the derivation.\n\nFirst, the problem must be validated.\n**Givens:**\n- A single-pulse admixture model occurring $T$ generations ago.\n- Continuous genome with map distance in Morgans.\n- Uniform per-generation crossover rate $r$ per Morgan.\n- Crossovers in a single meiosis form a spatial Poisson process with rate $r$ per Morgan.\n- Superposition of $T$ independent Poisson processes (for each generation's meiosis) results in a Poisson process with a rate equal to the sum of individual rates.\n- Distances between successive points in a Poisson process are independent and identically distributed (i.i.d.) exponential random variables.\n- $L$: length of a contiguous donor-ancestry tract in Morgans.\n- Part A requires derivation of the distribution of $L$ under neutrality.\n- Part B introduces selection.\n- $K$: number of introgressed donor-specific beneficial sites on a tract of length $L$.\n- $K \\sim \\text{Poisson}(\\mu L)$, where $\\mu$ is the density of such sites per Morgan.\n- Fitness multiplier per beneficial site is $(1+s)$, with $s > 0$.\n- Fitness effects are multiplicative across sites.\n- At sampling, the probability of sampling a haplotype is proportional to its expected multiplicative fitness.\n- The condition $rT > \\mu \\ln(1+s)$ is given for Part B.\n\n**Validation Verdict:**\nThe problem is valid. It describes a standard model of admixture dynamics in population genetics. The assumptions (Poisson crossovers, exponential tract lengths) are foundational to the field. Part B introduces a tractable model of selection. While a minor ambiguity exists in the phrase \"expected multiplicative fitness,\" the provided constraint $rT > \\mu \\ln(1+s)$ serves as a clear directive for the intended interpretation. This resolves the potential for ill-posedness, and the problem can be solved unambiguously under this interpretation.\n\n**Part A: Neutral Tract Length Distribution**\n\nWe are given that crossover events along a chromosome in a single meiosis follow a Poisson process with rate $r$ per Morgan. An ancestral donor tract is broken up by a crossover event in any of the $T$ generations separating the admixed ancestor from the present-day sample. The breakpoints that disrupt the donor tract are the result of the superposition of $T$ independent Poisson processes, each with rate $r$. The resulting cumulative process of breakpoints is therefore also a Poisson process with a rate $\\lambda_0$ equal to the sum of the individual rates:\n$$\n\\lambda_0 = \\sum_{i=1}^{T} r = rT\n$$\nThe length of a contiguous tract of donor ancestry, $L$, is the distance from its starting point to the first breakpoint. According to the properties of a Poisson process, the distance between successive events (or from an arbitrary starting point to the first event) follows an exponential distribution. The rate parameter of this exponential distribution is the rate of the Poisson process, $\\lambda_0$.\n\nTherefore, the length $L$ of a neutral donor tract is an exponential random variable with rate $\\lambda_0 = rT$.\nIts probability density function (PDF), $p_{neutral}(L)$, is given by:\n$$\np_{neutral}(L) = \\lambda_0 \\exp(-\\lambda_0 L) = rT \\exp(-rT L) \\quad \\text{for } L \\ge 0\n$$\nThe mean of an exponential distribution with rate $\\lambda_0$ is $1/\\lambda_0$. Thus, the mean neutral tract length is:\n$$\nE[L]_{neutral} = \\frac{1}{\\lambda_0} = \\frac{1}{rT}\n$$\n\n**Part B: Tract Length Distribution under Selection**\n\nNow we introduce selection. The number of beneficial sites, $K$, on a tract of length $L$ is a random variable following a Poisson distribution with mean $\\mu L$:\n$$\nP(K=k|L) = \\frac{(\\mu L)^k}{k!} \\exp(-\\mu L)\n$$\nThe total fitness of a haplotype with $K$ such sites is $W = (1+s)^K$, as the effects are multiplicative. The problem states that the sampling probability is proportional to the *expected* multiplicative fitness for a given tract length $L$. Let us denote this weighting factor as $W(L)$.\n\nThere is a subtle ambiguity in how to interpret \"expected multiplicative fitness\". A literal interpretation would be to compute $E[W|L] = E[(1+s)^K|L]$. A second interpretation is to use the fitness corresponding to the expected number of sites, $W(L) = (1+s)^{E[K|L]}$. The provided constraint $rT > \\mu \\ln(1+s)$ is key.\n\nIf we use the first, literal interpretation:\n$E[(1+s)^K | L]$ is the probability generating function of a Poisson($\\mu L$) random variable evaluated at $z=1+s$. The PGF is $G(z) = \\exp(\\lambda(z-1))$. Thus,\n$W(L) = E[(1+s)^K | L] = \\exp(\\mu L((1+s)-1)) = \\exp(\\mu L s)$.\nThe reweighted density would be proportional to $\\exp(-rT L) \\exp(\\mu L s) = \\exp(-(rT - \\mu s)L)$. The condition for this distribution to be normalizable (i.e., for the integral over $L \\in [0, \\infty)$ to converge) would be $rT - \\mu s > 0$.\n\nHowever, the problem specifies the condition $rT > \\mu \\ln(1+s)$. This condition arises from the second interpretation. Let us use the fitness based on the expected number of sites, $E[K|L] = \\mu L$:\n$$\nW(L) = (1+s)^{E[K|L]} = (1+s)^{\\mu L} = \\exp(\\ln((1+s)^{\\mu L})) = \\exp(\\mu L \\ln(1+s))\n$$\nThis interpretation, though formally an approximation (replacing $E[f(K)]$ with $f(E[K])$), is clearly the one intended by the problem setter, as evidenced by the provided constraint. We proceed with this weighting function.\n\nThe new, unnormalized probability density function for tract length under selection, $p'_{sel}(L)$, is the product of the neutral density and the fitness weight $W(L)$:\n$$\np'_{sel}(L) \\propto p_{neutral}(L) \\times W(L)\n$$\n(We can ignore the normalization constant $rT$ of the neutral PDF for now, as we will re-normalize).\n$$\np'_{sel}(L) \\propto \\exp(-rT L) \\times \\exp(\\mu L \\ln(1+s))\n$$\n$$\np'_{sel}(L) \\propto \\exp(-(rT - \\mu \\ln(1+s)) L)\n$$\nThis is the functional form of an exponential distribution. Let us define the new rate parameter $\\lambda_{sel}$:\n$$\n\\lambda_{sel} = rT - \\mu \\ln(1+s)\n$$\nThe condition $rT > \\mu \\ln(1+s)$ ensures that $\\lambda_{sel} > 0$, which is required for a valid, normalizable probability distribution on $L \\in [0, \\infty)$.\n\nThe normalized probability density function under selection is therefore:\n$$\np_{sel}(L) = \\lambda_{sel} \\exp(-\\lambda_{sel} L)\n$$\nThis is an exponential distribution with rate $\\lambda_{sel}$. The mean of this distribution is the reciprocal of its rate parameter.\n\nThe mean tract length under this selection model, $E[L]_{sel}$, is:\n$$\nE[L]_{sel} = \\frac{1}{\\lambda_{sel}} = \\frac{1}{rT - \\mu \\ln(1+s)}\n$$\nThis is the final closed-form expression required.", "answer": "$$\n\\boxed{\\frac{1}{rT - \\mu \\ln(1+s)}}\n$$", "id": "2688969"}]}