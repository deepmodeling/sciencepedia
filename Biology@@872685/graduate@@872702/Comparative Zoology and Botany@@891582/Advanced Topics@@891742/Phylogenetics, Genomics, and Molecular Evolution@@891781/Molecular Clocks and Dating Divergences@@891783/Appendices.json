{"hands_on_practices": [{"introduction": "The raw percentage of differing sites between two sequences is a direct but often misleading measure of their evolutionary separation, as multiple substitutions at the same site can obscure the true extent of divergence. This exercise [@problem_id:2590767] provides hands-on practice with the fundamental process of applying a substitution model—in this case, the Kimura 2-parameter (K80) model—to correct for these unobserved changes and calculate a more accurate genetic distance. You will then apply the strict molecular clock equation, $D = 2rT$, to convert this corrected distance into a tangible estimate of divergence time.", "problem": "You are studying a pair of orthologous nuclear genes sampled from two independently evolving lineages, one plant and one animal, to compare divergence patterns in comparative botany and zoology. From a high-quality alignment of very large length, the observed proportion of nucleotide differences is $p = 0.12$. Assume that nucleotide base frequencies are equal and that substitutions follow the Kimura two-parameter (K80) model, in which transitions and transversions occur at different instantaneous rates but bases are otherwise treated symmetrically. The transition-to-transversion rate ratio is given as $\\kappa = 2$, and the alignment is long enough that the realized transition-to-transversion ratio among observed differences approximates the underlying rate ratio. \n\nUnder a strict molecular clock, the per-lineage substitution rate is $r = 0.004$ substitutions per site per million years (Myr), constant through time in each lineage and independent between the two lineages.\n\nUsing only fundamental definitions and well-tested formulas, proceed as follows:\n- Partition the observed proportion of differences $p$ into the estimated proportions of transitions $P$ and transversions $Q$ by invoking the assumption that the realized transition-to-transversion ratio among observed differences is $\\kappa:1$.\n- Apply the Kimura two-parameter correction to obtain the expected number of substitutions per site $D_{K80}$ from $P$ and $Q$ while ensuring the parameter domain is satisfied so that the correction is defined.\n- Use the strict molecular clock relation between pairwise corrected distance and time to convert $D_{K80}$ to a divergence time $T$.\n\nCompute the divergence time $T$ and report your final answer rounded to four significant figures. Express $T$ in Myr.", "solution": "The problem presented is a standard exercise in molecular phylogenetics, requiring the application of established models to estimate divergence time. I shall first validate its premises before proceeding to a systematic solution.\n\nThe givens are as follows:\n- The observed proportion of nucleotide differences between two sequences is $p = 0.12$.\n- The model for nucleotide substitution is the Kimura two-parameter (K80) model.\n- Base frequencies are assumed to be equal, i.e., $0.25$ for each nucleotide.\n- The transition-to-transversion rate ratio is $\\kappa = 2$.\n- The realized ratio of observed transitions ($P$) to observed transversions ($Q$) is assumed to be equal to the rate ratio, so $P/Q = \\kappa = 2$.\n- The per-lineage substitution rate, assumed constant under a strict molecular clock, is $r = 0.004$ substitutions per site per million years (Myr).\n- The two lineages are evolving independently.\n- The final answer for divergence time, $T$, must be in Myr and rounded to four significant figures.\n\nThe problem is scientifically grounded, using the well-established K80 model and the concept of a molecular clock. It is well-posed, providing all necessary parameters and a clear, logical path to a unique solution. The language is objective and the values provided ($p=0.12$, $\\kappa=2$, $r=0.004$) are within plausible ranges for biological data. There are no logical contradictions, missing data, or scientifically unsound premises. I therefore judge the problem to be valid and will proceed with the derivation.\n\nThe procedure is executed in three stages as directed.\n\nFirst, we partition the total proportion of observed differences, $p$, into the proportion of transitional differences, $P$, and the proportion of transversional differences, $Q$. We are given two conditions:\n1. The sum of the proportions equals the total observed difference: $p = P + Q$.\n2. The ratio of observed transitions to transversions is given by $\\kappa$: $\\frac{P}{Q} = \\kappa$.\n\nSubstituting the given values, $p = 0.12$ and $\\kappa = 2$:\n$$\nP + Q = 0.12\n$$\n$$\n\\frac{P}{Q} = 2 \\implies P = 2Q\n$$\nWe substitute the second equation into the first:\n$$\n2Q + Q = 0.12 \\implies 3Q = 0.12\n$$\nSolving for $Q$ yields:\n$$\nQ = \\frac{0.12}{3} = 0.04\n$$\nWith $Q$ determined, we find $P$:\n$$\nP = 2Q = 2(0.04) = 0.08\n$$\nThus, the observed proportion of differences is partitioned into $P = 0.08$ (transitions) and $Q = 0.04$ (transversions). A simple check confirms $P + Q = 0.08 + 0.04 = 0.12$, which is correct.\n\nSecond, we apply the Kimura two-parameter (K80) correction to estimate the number of substitutions per site, $D_{K80}$. The formula for the K80 distance is:\n$$\nD_{K80} = -\\frac{1}{2}\\ln(1 - 2P - Q) - \\frac{1}{4}\\ln(1 - 2Q)\n$$\nThis correction accounts for multiple substitutions occurring at the same site, which cause the observed difference $p$ to underestimate the true evolutionary distance. Before applying this formula, we must verify that its arguments are well-defined, specifically that the arguments of the natural logarithm are positive.\nCondition 1: $1 - 2P - Q  0$\n$$\n1 - 2(0.08) - 0.04 = 1 - 0.16 - 0.04 = 1 - 0.20 = 0.80\n$$\nSince $0.80  0$, this condition is satisfied.\nCondition 2: $1 - 2Q  0$\n$$\n1 - 2(0.04) = 1 - 0.08 = 0.92\n$$\nSince $0.92  0$, this condition is also satisfied. The K80 correction is therefore applicable.\n\nWe now substitute the values of $P$ and $Q$ into the K80 formula:\n$$\nD_{K80} = -\\frac{1}{2}\\ln(0.80) - \\frac{1}{4}\\ln(0.92)\n$$\nWe compute the numerical value for $D_{K80}$:\n$$\nD_{K80} \\approx -\\frac{1}{2}(-0.22314355) - \\frac{1}{4}(-0.08338161)\n$$\n$$\nD_{K80} \\approx 0.111571775 + 0.0208454025\n$$\n$$\nD_{K80} \\approx 0.1324171775\n$$\nThis value $D_{K80}$ represents the total estimated number of substitutions per site that have accumulated between the two sequences since their last common ancestor.\n\nThird, we use the strict molecular clock hypothesis to convert this genetic distance into a divergence time, $T$. The total distance $D$ between two sequences is the sum of the substitutions accumulated along each of the two lineages from their common ancestor. If $r$ is the substitution rate per lineage per unit time, and $T$ is the time since divergence, the distance accumulated in each lineage is $r \\times T$. Since there are two such lineages, the total distance is:\n$$\nD = 2rT\n$$\nWe solve for the divergence time $T$:\n$$\nT = \\frac{D}{2r}\n$$\nUsing our calculated distance $D_{K80}$ and the given rate $r = 0.004$ substitutions per site per Myr:\n$$\nT = \\frac{0.1324171775}{2 \\times 0.004} = \\frac{0.1324171775}{0.008}\n$$\n$$\nT \\approx 16.5521471875 \\text{ Myr}\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\nT \\approx 16.55 \\text{ Myr}\n$$\nThis is the estimated time since the plant and animal lineages diverged from their last common ancestor, based on the provided data and model.", "answer": "$$\n\\boxed{16.55}\n$$", "id": "2590767"}, {"introduction": "While calculating a single divergence time is useful, the ultimate goal of many molecular dating studies is to produce a time-calibrated phylogeny for a group of taxa. This exercise [@problem_id:2590673] bridges the gap between pairwise distances and a complete time-tree. Using a matrix of corrected distances, you will explore how the assumption of a strict molecular clock implies an ultrametric tree structure and apply the method of least squares to simultaneously infer the best-fitting branching pattern and the ages of the nodes.", "problem": "A comparative dataset of four closely related taxa in a zoological clade is analyzed using a corrected sequence divergence under the Jukes–Cantor (JC69) model (Jukes–Cantor 1969 (JC69)). The corrected pairwise distances $D_{ij}$ are measured in substitutions per site. Assume a strict molecular clock with a known substitution rate $r$ (substitutions per site per million years) that is constant along all lineages.\n\nFundamental facts to use:\n- Under a strict molecular clock, each branch accumulates substitutions at a constant rate $r$ per lineage per unit time.\n- The corrected distance $D_{ij}$ approximates the expected total number of substitutions per site along the unique path connecting taxa $i$ and $j$ on the tree, which is the sum of branch lengths on that path.\n- An ultrametric tree is one in which the total time from the root to each tip is equal.\n\nYou are given the following data and assumptions:\n- The known strict clock rate is $r = 0.005$.\n- The observed symmetric distance matrix entries are:\n  - $D_{AB} = 0.0618$, $D_{AC} = 0.1420$, $D_{AD} = 0.1450$,\n  - $D_{BC} = 0.1400$, $D_{BD} = 0.1440$, $D_{CD} = 0.0552$.\n- Consider only fully resolved rooted binary trees on taxa $\\{A,B,C,D\\}$ having two sister-pairs (cherries). For each candidate rooted topology, the three node ages are the two internal clade ages (the ages of the two sister-pair most recent common ancestors) and the root age.\n\nTasks:\n1. Using the fundamental facts above and without invoking any pre-derived “shortcut” formulas, write the model-predicted pairwise distances for a given candidate topology as linear functions of the unknown node ages and the known rate $r$. Carefully justify why these predictions hold from first principles.\n2. For each of the three possible rooted topologies with two cherries, construct the unweighted least-squares criterion that compares the observed distances $D_{ij}$ to the model-predicted distances. Derive the closed-form least-squares estimators of the node ages under the strict clock for a fixed topology, and write the resulting minimized sum of squared residuals as a function of the observed distances for that topology.\n3. Evaluate the minimized sum of squared residuals for each of the three topologies, select the topology with the smallest value, and report its least-squares node-age estimates.\n4. From the selected topology, extract the estimated root age (in millions of years).\n\nExpress the final answer as the estimated root age in $\\text{Myr}$ (millions of years) and round to four significant figures. Provide only the single numerical value asked for as your final answer.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extracted Givens\n- Taxa: A set of four taxa $\\{A, B, C, D\\}$.\n- Model: Jukes–Cantor (JC69) corrected sequence divergence.\n- Distances: Pairwise distances $D_{ij}$ are measured in substitutions per site.\n- Clock: A strict molecular clock with a constant rate $r$ along all lineages.\n- Clock Rate: $r = 0.005$ substitutions per site per million years.\n- Distance Matrix entries:\n  - $D_{AB} = 0.0618$\n  - $D_{AC} = 0.1420$\n  - $D_{AD} = 0.1450$\n  - $D_{BC} = 0.1400$\n  - $D_{BD} = 0.1440$\n  - $D_{CD} = 0.0552$\n- Topology Constraint: The analysis is restricted to fully resolved rooted binary trees on $\\{A,B,C,D\\}$ with two sister-pairs (cherries).\n- Definitions:\n  - The corrected distance $D_{ij}$ is the sum of branch lengths (in substitutions per site) on the path connecting taxa $i$ and $j$.\n  - A strict clock implies an ultrametric tree where branch length is the product of time and rate.\n  - Node ages are defined as the ages of the two internal clades and the root age.\n\nStep 2: Validation Using Extracted Givens\nThe problem is scientifically grounded, employing standard principles of molecular phylogenetics such as the strict molecular clock model, distance-based methods, and least-squares estimation for tree parameterization. It is well-posed, providing a complete set of data and a clear objective, allowing for a unique solution via the specified procedure. The problem is objective, framed in precise, formal language without subjective or speculative content. It is a textbook exercise in computational biology, free of scientific unsoundness, ambiguity, or missing information. The number of data points (six distances) is greater than the number of free parameters for a given topology under a strict clock (three node ages), making the use of a least-squares criterion appropriate and necessary.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe solution proceeds by executing the four tasks outlined in the problem statement.\n\nTask 1: Model-Predicted Distances\nFor a set of four taxa $\\{A, B, C, D\\}$, there are three possible fully resolved rooted binary topologies containing two sister-pairs:\n1. Topology 1: $((A,B),(C,D))$\n2. Topology 2: $((A,C),(B,D))$\n3. Topology 3: $((A,D),(B,C))$\n\nLet us consider a general topology of this form, denoted $((i,j),(k,l))$. Let $t_{ij}$ be the age (in millions of years, Myr) of the most recent common ancestor (MRCA) of taxa $i$ and $j$. Let $t_{kl}$ be the age of the MRCA of taxa $k$ and $l$. Let $t_{root}$ be the age of the root of the tree, which is the MRCA of all four taxa. By definition, $t_{root}  t_{ij}$ and $t_{root}  t_{kl}$. Time is measured backwards from the present (time $t=0$).\n\nUnder a strict molecular clock, the evolutionary distance (number of substitutions per site) between any two nodes on the tree is the product of the time separating them and the substitution rate $r$. The total distance $D_{ij}$ between two terminal taxa $i$ and $j$ is the sum of the lengths of the branches on the unique path connecting them.\n\nFor the topology $((i,j),(k,l))$, the path between taxon $i$ and taxon $j$ goes from the present ($t=0$) up to their MRCA at time $t_{ij}$ and back to the present. The total time duration of this path is $t_{ij} + t_{ij} = 2t_{ij}$. Therefore, the model-predicted distance is $\\hat{D}_{ij} = r \\times (2t_{ij}) = 2rt_{ij}$. Similarly, for the other sister-pair, $\\hat{D}_{kl} = 2rt_{kl}$.\n\nThe path between a taxon from the first pair (e.g., $i$) and a taxon from the second pair (e.g., $k$) goes from the present up to the root at time $t_{root}$ and back to the present. The total time duration of this path is $t_{root} + t_{root} = 2t_{root}$. Thus, for any cross-pair comparison, the predicted distance is the same: $\\hat{D}_{ik} = \\hat{D}_{il} = \\hat{D}_{jk} = \\hat{D}_{jl} = 2rt_{root}$.\n\nThese equations provide the model-predicted pairwise distances as linear functions of the unknown node ages for any given candidate topology.\n\nTask 2: Least-Squares Criterion and Estimators\nThe unweighted least-squares criterion, $S$, is the sum of the squared differences between the observed distances $D_{ij}$ and the model-predicted distances $\\hat{D}_{ij}$. For the general topology $((i,j),(k,l))$, this is:\n$$S = (D_{ij} - 2rt_{ij})^2 + (D_{kl} - 2rt_{kl})^2 + (D_{ik} - 2rt_{root})^2 + (D_{il} - 2rt_{root})^2 + (D_{jk} - 2rt_{root})^2 + (D_{jl} - 2rt_{root})^2$$\nTo find the least-squares estimators for the node ages, we must minimize $S$ with respect to $t_{ij}$, $t_{kl}$, and $t_{root}$ by setting the partial derivatives to zero.\n\nThe parameters are decoupled.\n$\\frac{\\partial S}{\\partial t_{ij}} = 2(D_{ij} - 2rt_{ij})(-2r) = 0 \\implies \\hat{t}_{ij} = \\frac{D_{ij}}{2r}$\n$\\frac{\\partial S}{\\partial t_{kl}} = 2(D_{kl} - 2rt_{kl})(-2r) = 0 \\implies \\hat{t}_{kl} = \\frac{D_{kl}}{2r}$\n\nFor the root age:\n$\\frac{\\partial S}{\\partial t_{root}} = 2(D_{ik} - 2rt_{root})(-2r) + 2(D_{il} - 2rt_{root})(-2r) + 2(D_{jk} - 2rt_{root})(-2r) + 2(D_{jl} - 2rt_{root})(-2r) = 0$\nThis simplifies to:\n$(D_{ik} - 2rt_{root}) + (D_{il} - 2rt_{root}) + (D_{jk} - 2rt_{root}) + (D_{jl} - 2rt_{root}) = 0$\n$D_{ik} + D_{il} + D_{jk} + D_{jl} = 4 \\times (2rt_{root}) = 8rt_{root}$\n$\\hat{t}_{root} = \\frac{D_{ik} + D_{il} + D_{jk} + D_{jl}}{8r}$\n\nThe minimized sum of squared residuals, $S^*$, is found by substituting these estimators back into the expression for $S$. The first two terms, $(D_{ij} - 2r\\hat{t}_{ij})^2$ and $(D_{kl} - 2r\\hat{t}_{kl})^2$, become zero. The remaining sum is:\n$S^* = (D_{ik} - \\bar{D}_{cross})^2 + (D_{il} - \\bar{D}_{cross})^2 + (D_{jk} - \\bar{D}_{cross})^2 + (D_{jl} - \\bar{D}_{cross})^2$\nwhere $\\bar{D}_{cross} = 2r\\hat{t}_{root} = \\frac{D_{ik} + D_{il} + D_{jk} + D_{jl}}{4}$ is the arithmetic mean of the four \"across-pairs\" distances. Thus, $S^*$ is the sum of squared deviations of the across-pairs distances from their mean.\n\nTask 3: Evaluation and Selection\nWe now calculate $S^*$ for each of the three possible topologies using the provided distance data.\n\nTopology 1: $((A,B),(C,D))$\nThe across-pairs distances are $\\{D_{AC}, D_{AD}, D_{BC}, D_{BD}\\}$.\n$D_{AC} = 0.1420$, $D_{AD} = 0.1450$, $D_{BC} = 0.1400$, $D_{BD} = 0.1440$.\nThe mean of these distances is:\n$\\bar{D}_{cross,1} = \\frac{0.1420 + 0.1450 + 0.1400 + 0.1440}{4} = \\frac{0.5710}{4} = 0.14275$.\nThe minimized sum of squares is:\n$S_1^* = (0.1420 - 0.14275)^2 + (0.1450 - 0.14275)^2 + (0.1400 - 0.14275)^2 + (0.1440 - 0.14275)^2$\n$S_1^* = (-0.00075)^2 + (0.00225)^2 + (-0.00275)^2 + (0.00125)^2$\n$S_1^* = 0.0000005625 + 0.0000050625 + 0.0000075625 + 0.0000015625 = 0.00001475 = 1.475 \\times 10^{-5}$.\n\nTopology 2: $((A,C),(B,D))$\nThe across-pairs distances are $\\{D_{AB}, D_{AD}, D_{CB}, D_{CD}\\}$. Note that $D_{CB} = D_{BC}$.\n$D_{AB} = 0.0618$, $D_{AD} = 0.1450$, $D_{BC} = 0.1400$, $D_{CD} = 0.0552$.\nThe mean is:\n$\\bar{D}_{cross,2} = \\frac{0.0618 + 0.1450 + 0.1400 + 0.0552}{4} = \\frac{0.4020}{4} = 0.1005$.\n$S_2^* = (0.0618 - 0.1005)^2 + (0.1450 - 0.1005)^2 + (0.1400 - 0.1005)^2 + (0.0552 - 0.1005)^2$\n$S_2^* = (-0.0387)^2 + (0.0445)^2 + (0.0395)^2 + (-0.0453)^2$\n$S_2^* = 0.00149769 + 0.00198025 + 0.00156025 + 0.00205209 = 0.00709028$.\n\nTopology 3: $((A,D),(B,C))$\nThe across-pairs distances are $\\{D_{AB}, D_{AC}, D_{DB}, D_{DC}\\}$. Note that $D_{DB}=D_{BD}$ and $D_{DC}=D_{CD}$.\n$D_{AB} = 0.0618$, $D_{AC} = 0.1420$, $D_{BD} = 0.1440$, $D_{CD} = 0.0552$.\nThe mean is:\n$\\bar{D}_{cross,3} = \\frac{0.0618 + 0.1420 + 0.1440 + 0.0552}{4} = \\frac{0.4030}{4} = 0.10075$.\n$S_3^* = (0.0618 - 0.10075)^2 + (0.1420 - 0.10075)^2 + (0.1440 - 0.10075)^2 + (0.0552 - 0.10075)^2$\n$S_3^* = (-0.03895)^2 + (0.04125)^2 + (0.04325)^2 + (-0.04555)^2$\n$S_3^* = 0.0015171025 + 0.0017015625 + 0.0018705625 + 0.0020748025 = 0.00716403$.\n\nComparing the minimized sums of squares:\n$S_1^* = 1.475 \\times 10^{-5}$\n$S_2^* \\approx 7.09 \\times 10^{-3}$\n$S_3^* \\approx 7.16 \\times 10^{-3}$\nSince $S_1^*$ is dramatically smaller than $S_2^*$ and $S_3^*$, the topology $((A,B),(C,D))$ provides the best fit to the data under the strict clock model.\n\nThe least-squares node-age estimates for this topology are:\n$\\hat{t}_{AB} = \\frac{D_{AB}}{2r} = \\frac{0.0618}{2 \\times 0.005} = \\frac{0.0618}{0.01} = 6.18 \\, \\text{Myr}$\n$\\hat{t}_{CD} = \\frac{D_{CD}}{2r} = \\frac{0.0552}{2 \\times 0.005} = \\frac{0.0552}{0.01} = 5.52 \\, \\text{Myr}$\n$\\hat{t}_{root} = \\hat{t}_{ABCD} = \\frac{D_{AC} + D_{AD} + D_{BC} + D_{BD}}{8r} = \\frac{0.5710}{8 \\times 0.005} = \\frac{0.5710}{0.04} = 14.275 \\, \\text{Myr}$\n\nTask 4: Extract Estimated Root Age\nThe estimated root age for the selected topology $((A,B),(C,D))$ is $\\hat{t}_{ABCD}$.\n$\\hat{t}_{ABCD} = 14.275 \\, \\text{Myr}$.\nThe problem requires this value to be rounded to four significant figures.\n$14.275 \\approx 14.28$.", "answer": "$$\\boxed{14.28}$$", "id": "2590673"}, {"introduction": "The assumption of a single, constant rate of evolution across all lineages—the strict molecular clock—is a powerful simplification, but one that is frequently violated in real datasets. This advanced practice [@problem_id:2590771] challenges you to think like a practicing phylogeneticist faced with rate heterogeneity by designing a Bayesian model comparison to determine if a strict, local, or relaxed clock model best explains the data. This exercise emphasizes the critical importance of proper prior specification and the use of marginal likelihoods to rigorously select the most appropriate model for dating divergences.", "problem": "A comparative dataset comprises an orthologous nuclear gene alignment from $n = 62$ taxa, spanning multiple flowering plant clades and multiple insect orders, with an algal outgroup. Three independent fossil calibrations provide hard minima: the crown angiosperm node has a minimum of $t_{\\min,1} = 125$ million years, the crown holometabolous insects node has $t_{\\min,2} = 315$ million years, and the metazoan–viridiplantae split has $t_{\\min,3} = 600$ million years. A likelihood ratio test of a strict molecular clock rejects clocklike evolution at $p  0.001$. You are tasked with designing a statistically coherent model selection strategy to compare three clock models: strict clock, a two-partition local clock (plants versus insects), and an Uncorrelated Lognormal (UCLN) relaxed clock, using marginal likelihoods estimated by stepping-stone sampling. Your design must specify the estimation strategy and all necessary priors to ensure that marginal likelihoods are well-defined and comparable across models, and it must adhere to good practice in Bayesian divergence-time inference.\n\nFoundational facts and definitions you may rely on include: Bayes’ theorem $p(M \\mid y) \\propto p(y \\mid M)\\,p(M)$ for model $M$ and data $y$, the definition of marginal likelihood as the integral of the likelihood against the prior over all parameters and trees, and that stepping-stone sampling estimates marginal likelihoods by bridging between the prior and posterior through power posteriors. You may also assume standard substitution models and tree priors are available. Do not assume any shortcut formulas beyond these definitions.\n\nWhich option best specifies a valid and defensible strategy?\n\nA. Fix the maximum likelihood topology and branch lengths once, and compute Akaike Information Criterion through Markov chain Monte Carlo (AICM) on the posterior samples under each clock model. Use improper Jeffreys’ priors for clock rates to avoid influencing the posterior. For calibrations, impose hard bounds equal to the fossil minima and no upper bounds. Because the strict clock is rejected, exclude it from marginal likelihood estimation. For stepping-stone sampling, use $K = 10$ stones with evenly spaced powers and $5 \\times 10^{4}$ iterations per stone.\n\nB. For each model, integrate over tree topologies and node times using the same substitution process (General Time Reversible with among-site rate heterogeneity, denoted General Time Reversible plus Gamma, GTR+$\\Gamma$) and the same calibrated birth–death tree prior with sampling. Assign Dirichlet priors to exchangeabilities and base frequencies, an exponential prior to the gamma shape parameter, and a proper calibrated birth–death prior on the time tree with fossil calibrations implemented as offset lognormal priors: for calibration $i \\in \\{1,2,3\\}$, $t_{i} \\sim \\text{Lognormal}(\\mu_{i}, \\sigma_{i})$ with an offset at $t_{\\min,i}$ and finite $\\mu_{i}, \\sigma_{i}$. For the strict clock, place a lognormal prior on the mean rate $r \\sim \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$. For the two-partition local clock, define two disjoint monophyletic partitions a priori (plants versus insects), assign independent lognormal priors to partition-specific rates $r_{1}, r_{2}$, and place a weakly informative hierarchical prior $\\log r_{j} \\sim \\mathcal{N}(\\mu_{r}, \\tau^{2})$ with proper priors on $\\mu_{r}$ and $\\tau$. For the Uncorrelated Lognormal relaxed clock (UCLN), assign branch-specific rates $r_{b}$ independently as lognormal with mean parameter $\\mu_{r}$ and standard deviation parameter $\\sigma_{r}$ on the log scale, with $r_{b} \\stackrel{\\text{i.i.d.}}{\\sim} \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$, and proper hyperpriors such as $\\mu_{r} \\sim \\text{Normal}(\\mu_{0}, \\sigma_{0}^{2})$ truncated to positive rates and $\\sigma_{r} \\sim \\text{HalfCauchy}(\\lambda)$. Estimate marginal likelihoods via stepping-stone sampling with $K = 64$ stones, using powers given by quantiles of a $\\text{Beta}(\\alpha,1)$ distribution with $\\alpha = 0.3$ to concentrate stones near the prior, and run $2 \\times 10^{6}$ iterations per stone with $25\\%$ burn-in, in at least $2$ independent replicates per model, assessing mixing and effective sample sizes. Use equal model priors $p(M)$ and compare models with Bayes factors computed from the estimated marginal likelihoods.\n\nC. Use stepping-stone sampling under each model with $K = 12$ stones and powers spaced linearly in $[0,1]$. For UCLN, model branch rates as independent gamma-distributed variables with a shared variance parameter $\\sigma^{2}$, and place an improper prior $p(\\sigma) \\propto 1/\\sigma$ to avoid over-regularization. For the local clock, estimate the plant versus insect partition from the posterior tree at each stepping stone to reflect uncertainty in partitions. For calibrations, impose hard bounds by fixing node ages at their fossil minima to stabilize the chain. Use a uniform prior on the mean clock rate over $(0,\\infty)$.\n\nD. Implement power posterior sampling but use the posterior predictive distribution from a preliminary strict clock run as the prior for the final runs to stabilize estimation. For all models, center normal priors for clock rates at the maximum likelihood estimate with a small variance to improve convergence. For the local clock, allow the number of local clocks to be estimated with a Poisson prior on the number of partitions, but restrict partitions to those with posterior clade probability exceeding $0.95$ computed from the full data. Compute Bayes factors using the harmonic mean estimator to cross-check stepping-stone estimates and choose the model with the smallest posterior mean deviance.", "solution": "The problem statement is a valid exercise in designing a Bayesian phylogenetic model selection experiment. It is scientifically grounded, well-posed, and objective. It provides a realistic scenario involving molecular clock dating, a common task in evolutionary biology. All provided data and constraints are consistent and sufficient for evaluating the proposed strategies. I will therefore proceed with a full analysis.\n\nThe goal is to compare three molecular clock models—a strict clock, a two-partition local clock, and an Uncorrelated Lognormal (UCLN) relaxed clock—using Bayes factors derived from marginal likelihood estimates. The marginal likelihood $p(y \\mid M)$ for a model $M$ and data $y$ is defined as the integral of the likelihood over the prior distribution of all model parameters $\\theta$:\n$$\np(y \\mid M) = \\int p(y \\mid \\theta, M) \\, p(\\theta \\mid M) \\, d\\theta\n$$\nA Bayes factor, $K_{12} = p(y \\mid M_1) / p(y \\mid M_2)$, quantifies the evidence provided by the data for model $M_1$ versus model $M_2$. For this comparison to be statistically valid, two conditions are paramount:\n$1$. The priors $p(\\theta \\mid M)$ for all parameters in each model must be **proper**, meaning they integrate to a finite value (conventionally $1$). Improper priors lead to undefined marginal likelihoods and, consequently, arbitrary Bayes factors.\n$2$. The priors for parameters shared across models (e.g., the substitution model, the tree prior) must be identical to ensure that any difference in marginal likelihoods reflects the fit of the clock model itself, not differences in other model components.\n\nThe rejection of the strict clock by a likelihood ratio test ($p  0.001$) is a frequentist result. In a Bayesian framework, it is not grounds for excluding the model from comparison. Instead, the strict clock serves as a crucial baseline or null hypothesis against which the evidence for more complex models is weighed. The magnitude of the Bayes factor will quantify precisely how much better the relaxed clock models fit the data.\n\nStepping-stone sampling is a robust method for estimating marginal likelihoods. Its accuracy depends on the number of \"stones\" (power posteriors) used to bridge the prior and the posterior, the placement of these stones, and the length of the simulation run for each stone to ensure convergence. Best practices suggest using a large number of stones, concentrating them near the prior (e.g., by spacing the powers $\\beta$ according to quantiles of a $\\text{Beta}(\\alpha, 1)$ distribution with $\\alpha  1$), and running long MCMC chains with convergence diagnostics.\n\nFossil calibrations are best incorporated as \"soft\" probabilistic priors (e.g., offset lognormal or exponential distributions) on node ages rather than hard bounds. This approach properly reflects the inherent uncertainty that a fossil provides a minimum age, but the true age could be older.\n\nWith these principles established, I will evaluate each option.\n\nA. Fix the maximum likelihood topology and branch lengths once, and compute Akaike Information Criterion through Markov chain Monte Carlo (AICM) on the posterior samples under each clock model. Use improper Jeffreys’ priors for clock rates to avoid influencing the posterior. For calibrations, impose hard bounds equal to the fossil minima and no upper bounds. Because the strict clock is rejected, exclude it from marginal likelihood estimation. For stepping-stone sampling, use $K = 10$ stones with evenly spaced powers and $5 \\times 10^{4}$ iterations per stone.\n\nThis option contains multiple severe methodological flaws.\n$1$. Bayesian inference is designed to integrate over uncertainty. Fixing the topology and branch lengths to a single maximum likelihood estimate discards all information about uncertainty in the tree structure and divergence times, which is a primary motivation for using a Bayesian approach.\n$2$. The problem explicitly requires comparison via marginal likelihoods for Bayes factors. AICM is a different method for model selection based on information criteria, not marginal likelihoods.\n$3$. The use of improper Jeffreys' priors is a critical error. Marginal likelihoods are not defined for models with improper priors, making Bayes factor calculation impossible.\n$4$. Imposing hard lower bounds with no upper bound (i.e., a uniform prior from $t_{\\min}$ to $\\infty$) is also an improper prior, compounding the previous error.\n$5$. Excluding the strict clock based on an LRT result is poor practice in a Bayesian context. The purpose of model comparison is to quantify the evidence for or against all candidate models, including the simplest one.\n$6$. The proposed stepping-stone setup ($K=10$ stones, linear spacing) is suboptimal and less accurate than modern alternatives.\n**Verdict**: Incorrect.\n\nB. For each model, integrate over tree topologies and node times using the same substitution process (General Time Reversible with among-site rate heterogeneity, denoted General Time Reversible plus Gamma, GTR+$\\Gamma$) and the same calibrated birth–death tree prior with sampling. Assign Dirichlet priors to exchangeabilities and base frequencies, an exponential prior to the gamma shape parameter, and a proper calibrated birth–death prior on the time tree with fossil calibrations implemented as offset lognormal priors: for calibration $i \\in \\{1,2,3\\}$, $t_{i} \\sim \\text{Lognormal}(\\mu_{i}, \\sigma_{i})$ with an offset at $t_{\\min,i}$ and finite $\\mu_{i}, \\sigma_{i}$. For the strict clock, place a lognormal prior on the mean rate $r \\sim \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$. For the two-partition local clock, define two disjoint monophyletic partitions a priori (plants versus insects), assign independent lognormal priors to partition-specific rates $r_{1}, r_{2}$, and place a weakly informative hierarchical prior $\\log r_{j} \\sim \\mathcal{N}(\\mu_{r}, \\tau^{2})$ with proper priors on $\\mu_{r}$ and $\\tau$. For the Uncorrelated Lognormal relaxed clock (UCLN), assign branch-specific rates $r_{b}$ independently as lognormal with mean parameter $\\mu_{r}$ and standard deviation parameter $\\sigma_{r}$ on the log scale, with $r_{b} \\stackrel{\\text{i.i.d.}}{\\sim} \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$, and proper hyperpriors such as $\\mu_{r} \\sim \\text{Normal}(\\mu_{0}, \\sigma_{0}^{2})$ truncated to positive rates and $\\sigma_{r} \\sim \\text{HalfCauchy}(\\lambda)$. Estimate marginal likelihoods via stepping-stone sampling with $K = 64$ stones, using powers given by quantiles of a $\\text{Beta}(\\alpha,1)$ distribution with $\\alpha = 0.3$ to concentrate stones near the prior, and run $2 \\times 10^{6}$ iterations per stone with $25\\%$ burn-in, in at least $2$ independent replicates per model, assessing mixing and effective sample sizes. Use equal model priors $p(M)$ and compare models with Bayes factors computed from the estimated marginal likelihoods.\n\nThis option describes a state-of-the-art and statistically rigorous approach.\n$1$. It correctly specifies integrating over tree topologies and node times.\n$2$. It uses consistent, proper, and standard priors for all shared parameters (substitution model, tree prior).\n$3$. The implementation of fossil calibrations using offset lognormal distributions is best practice, correctly modeling \"soft\" bounds.\n$4$. The prior specifications for all three clock models (strict, local, UCLN) are appropriate, using proper and weakly informative distributions. The description of the hierarchical structure for the local clock and UCLN models is correct. The use of a Half-Cauchy prior for a variance parameter is a modern, well-regarded choice.\n$5$. The stepping-stone sampling strategy is a textbook example of best practice: a high number of stones ($K=64$), power-spacing concentrated near the prior ($\\text{Beta}(0.3, 1)$), long runs with burn-in, multiple replicates, and\nconvergence checks (ESS).\n$6$. The final step of calculating Bayes factors from the estimated marginal likelihoods under equal model priors is the correct conclusion to the described procedure.\n**Verdict**: Correct.\n\nC. Use stepping-stone sampling under each model with $K = 12$ stones and powers spaced linearly in $[0,1]$. For UCLN, model branch rates as independent gamma-distributed variables with a shared variance parameter $\\sigma^{2}$, and place an improper prior $p(\\sigma) \\propto 1/\\sigma$ to avoid over-regularization. For the local clock, estimate the plant versus insect partition from the posterior tree at each stepping stone to reflect uncertainty in partitions. For calibrations, impose hard bounds by fixing node ages at their fossil minima to stabilize the chain. Use a uniform prior on the mean clock rate over $(0,\\infty)$.\n\nThis option is fundamentally flawed.\n$1$. It proposes two separate improper priors: $p(\\sigma) \\propto 1/\\sigma$ for the UCLN variance and a uniform prior on $(0, \\infty)$ for the mean clock rate. As established, improper priors make marginal likelihood estimation invalid.\n$2$. It mis-specifies the requested UCLN clock as an \"Uncorrelated Gamma\" model. While this is a possible model, it is not what was asked to be compared.\n$3$. It conflates a fixed-partition local clock with a much more complex model where partitions are estimated. This changes the model being tested and poses significant challenges for marginal likelihood estimation.\n$4$. Fixing node ages to fossil minima is a poor and statistically unsound practice that ignores uncertainty and can severely bias results.\n$5$. The stepping-stone setup ($K=12$, linear spacing) is suboptimal.\n**Verdict**: Incorrect.\n\nD. Implement power posterior sampling but use the posterior predictive distribution from a preliminary strict clock run as the prior for the final runs to stabilize estimation. For all models, center normal priors for clock rates at the maximum likelihood estimate with a small variance to improve convergence. For the local clock, allow the number of local clocks to be estimated with a Poisson prior on the number of partitions, but restrict partitions to those with posterior clade probability exceeding $0.95$ computed from the full data. Compute Bayes factors using the harmonic mean estimator to cross-check stepping-stone estimates and choose the model with the smallest posterior mean deviance.\n\nThis option recommends several statistically problematic or incorrect procedures.\n$1$. Using a posterior distribution from a preliminary analysis as the prior for a final analysis constitutes \"using the data twice\". This invalidates the philosophical basis of Bayesian model comparison, as the priors no longer represent *a priori* belief. The resulting Bayes factors would be uninterpretable in the standard way.\n$2$. Similarly, centering priors on maximum likelihood estimates derived from the same data biases the analysis in favor of models whose point estimates are close to the overall maximum likelihood, and artificially inflates their marginal likelihoods.\n$3$. It proposes a \"random local clock\" model where the number of partitions is estimated, which is not the two-partition model specified in the problem statement.\n$4$. It suggests using the harmonic mean estimator. This estimator is notoriously unreliable and known to have infinite variance, almost always producing grossly overestimated values for the marginal likelihood. It is not a valid method for cross-checking and has been deprecated in favor of methods like stepping-stone sampling.\n$5$. It concludes by suggesting choosing the model based on the Deviance Information Criterion (DIC, implied by \"posterior mean deviance\"), which contradicts the problem's explicit instruction to use marginal likelihoods and Bayes factors.\n**Verdict**: Incorrect.\n\nBased on this analysis, Option B is the only one that describes a coherent, valid, and defensible strategy that aligns with modern best practices in Bayesian phylogenetics. It correctly specifies the use of proper priors, appropriate calibration methods, and a robust implementation of stepping-stone sampling for marginal likelihood estimation.", "answer": "$$\\boxed{B}$$", "id": "2590771"}]}