{"hands_on_practices": [{"introduction": "A primary challenge in studying cis-regulatory evolution is to identify functional transcription factor binding sites within the vast non-coding genome. This exercise guides you through the construction of a Position Weight Matrix (PWM), a foundational probabilistic model for representing sequence motifs. By deriving and applying a log-likelihood ratio score [@problem_id:2554054], you will practice the essential bioinformatic skill of distinguishing potential regulatory sequences from the genomic background.", "problem": "In the study of cis-regulatory evolution in development across plant lineages, one often models transcription factor binding preferences using a Position Weight Matrix (PWM) estimated from experimentally validated binding sites conserved across species. Consider a developmental transcription factor with a conserved motif of length $L=6$. From $N=20$ aligned binding site instances sampled from enhancers active in early floral development across multiple angiosperms, you obtained the following per-position nucleotide counts (each position sums to $N$):\n\n- Position $1$: $A:10,\\,C:2,\\,G:3,\\,T:5$.\n- Position $2$: $A:1,\\,C:14,\\,G:3,\\,T:2$.\n- Position $3$: $A:4,\\,C:5,\\,G:8,\\,T:3$.\n- Position $4$: $A:15,\\,C:1,\\,G:2,\\,T:2$.\n- Position $5$: $A:2,\\,C:2,\\,G:12,\\,T:4$.\n- Position $6$: $A:3,\\,C:6,\\,G:4,\\,T:7$.\n\nAssume the standard PWM independence model across positions and apply Bayesian smoothing with a symmetric pseudocount $\\alpha=0.5$ for each nucleotide at each position. The genomic background in these enhancer regions is modeled as an independent and identically distributed (order-$0$) process with base frequencies $q_A=0.34$, $q_C=0.16$, $q_G=0.16$, and $q_T=0.34$.\n\nTasks:\n1) Define a Position Weight Matrix (PWM) in mathematical terms under these assumptions, starting from the aligned counts and the pseudocount $\\alpha$.\n2) Starting from the definitions of the likelihood of a sequence under the PWM independence model and under the background model, and using only fundamental probability rules, derive a closed-form expression for the log-likelihood ratio score for a length-$L$ candidate sequence $S=b_1 b_2 \\dots b_L$.\n3) Using your derived expression, compute the log-likelihood ratio score for the candidate sequence $S=\\text{ACGAGT}$ under the above PWM and background model. Use the natural logarithm $\\ln$.\n\nRound your final numerical answer to four significant figures. Do not include any units in your final answer.", "solution": "We begin from core definitions used in probabilistic modeling of transcription factor binding preferences and genomic background composition.\n\nDefinition of a Position Weight Matrix (PWM) with Bayesian smoothing:\n- Let $n_{b,i}$ denote the observed count of base $b \\in \\{A,C,G,T\\}$ at position $i \\in \\{1,\\dots,L\\}$ across $N$ aligned binding site instances, with $\\sum_{b} n_{b,i} = N$ for each $i$.\n- Under a multinomial model with the independence assumption across columns, the position-specific base probabilities are estimated with a symmetric Dirichlet prior of concentration $\\alpha>0$ for each base. The posterior mean (or equivalently, the maximum a posteriori estimate under a symmetric prior up to normalization) gives the PWM entries:\n$$\np_{b,i} \\;=\\; \\frac{n_{b,i} + \\alpha}{\\sum_{b'} n_{b',i} + 4\\alpha} \\;=\\; \\frac{n_{b,i} + \\alpha}{N + 4\\alpha}.\n$$\nThis defines the PWM as the collection $\\{p_{b,i}\\}_{b\\in\\{A,C,G,T\\},\\, i=1,\\dots,L}$.\n\nLog-likelihood ratio derivation:\n- Under the PWM independence model, the likelihood of a sequence $S=b_1 b_2 \\dots b_L$ is\n$$\nP(S \\mid \\text{PWM}) \\;=\\; \\prod_{i=1}^{L} p_{b_i,i}.\n$$\n- Under the order-$0$ background model with base frequencies $q_b$ (independent and identically distributed across positions),\n$$\nP(S \\mid \\text{bg}) \\;=\\; \\prod_{i=1}^{L} q_{b_i}.\n$$\n- The log-likelihood ratio (LLR) score is defined as\n$$\n\\text{LLR}(S) \\;=\\; \\ln\\!\\left(\\frac{P(S \\mid \\text{PWM})}{P(S \\mid \\text{bg})}\\right)\n\\;=\\; \\ln\\!\\left( \\prod_{i=1}^{L} \\frac{p_{b_i,i}}{q_{b_i}} \\right)\n\\;=\\; \\sum_{i=1}^{L} \\ln\\!\\left( \\frac{p_{b_i,i}}{q_{b_i}} \\right).\n$$\n\nParameter instantiation for the given data:\n- Here, $L=6$, $N=20$, and $\\alpha=0.5$, so $N+4\\alpha = 20 + 4\\times 0.5 = 22$.\n- Compute the PWM entries needed for $S=\\text{ACGAGT}$, i.e., the bases at positions $1$ through $6$ are $b_1=A$, $b_2=C$, $b_3=G$, $b_4=A$, $b_5=G$, $b_6=T$.\n\nFor each required $(b_i,i)$:\n- Position $1$, $b_1=A$: $n_{A,1}=10$, so $p_{A,1} = \\frac{10+0.5}{22} = \\frac{10.5}{22}$.\n- Position $2$, $b_2=C$: $n_{C,2}=14$, so $p_{C,2} = \\frac{14+0.5}{22} = \\frac{14.5}{22}$.\n- Position $3$, $b_3=G$: $n_{G,3}=8$, so $p_{G,3} = \\frac{8+0.5}{22} = \\frac{8.5}{22}$.\n- Position $4$, $b_4=A$: $n_{A,4}=15$, so $p_{A,4} = \\frac{15+0.5}{22} = \\frac{15.5}{22}$.\n- Position $5$, $b_5=G$: $n_{G,5}=12$, so $p_{G,5} = \\frac{12+0.5}{22} = \\frac{12.5}{22}$.\n- Position $6$, $b_6=T$: $n_{T,6}=7$, so $p_{T,6} = \\frac{7+0.5}{22} = \\frac{7.5}{22}$.\n\nBackground frequencies are $q_A=0.34$, $q_C=0.16$, $q_G=0.16$, $q_T=0.34$.\n\nThus, the LLR becomes\n$$\n\\text{LLR}(S) \\;=\\; \\sum_{i=1}^{6} \\ln\\!\\left( \\frac{p_{b_i,i}}{q_{b_i}} \\right)\n\\;=\\; \\ln\\!\\left(\\frac{10.5/22}{0.34}\\right)\n+ \\ln\\!\\left(\\frac{14.5/22}{0.16}\\right)\n+ \\ln\\!\\left(\\frac{8.5/22}{0.16}\\right)\n+ \\ln\\!\\left(\\frac{15.5/22}{0.34}\\right)\n+ \\ln\\!\\left(\\frac{12.5/22}{0.16}\\right)\n+ \\ln\\!\\left(\\frac{7.5/22}{0.34}\\right).\n$$\n\nFor numerical stability and clarity, rewrite each term as a ratio of integers where possible:\n- $\\frac{10.5/22}{0.34} = \\frac{10.5}{22} \\cdot \\frac{100}{34} = \\frac{1050}{748}$.\n- $\\frac{14.5/22}{0.16} = \\frac{1450}{352} = \\frac{725}{176}$.\n- $\\frac{8.5/22}{0.16} = \\frac{850}{352} = \\frac{425}{176}$.\n- $\\frac{15.5/22}{0.34} = \\frac{1550}{748} = \\frac{775}{374}$.\n- $\\frac{12.5/22}{0.16} = \\frac{1250}{352} = \\frac{625}{176}$.\n- $\\frac{7.5/22}{0.34} = \\frac{750}{748}$.\n\nTherefore,\n$$\n\\text{LLR}(S)\n= \\ln\\!\\left(\\frac{1050}{748}\\right)\n+ \\ln\\!\\left(\\frac{725}{176}\\right)\n+ \\ln\\!\\left(\\frac{425}{176}\\right)\n+ \\ln\\!\\left(\\frac{775}{374}\\right)\n+ \\ln\\!\\left(\\frac{625}{176}\\right)\n+ \\ln\\!\\left(\\frac{750}{748}\\right).\n$$\nUsing $\\ln(a/b)=\\ln a - \\ln b$ and known logarithms (or direct evaluation), we compute each contribution:\n- $\\ln\\!\\left(\\frac{1050}{748}\\right) \\approx 0.339142465$.\n- $\\ln\\!\\left(\\frac{725}{176}\\right) \\approx 1.415687660$.\n- $\\ln\\!\\left(\\frac{425}{176}\\right) \\approx 0.881605174$.\n- $\\ln\\!\\left(\\frac{775}{374}\\right) \\approx 0.728607231$.\n- $\\ln\\!\\left(\\frac{625}{176}\\right) \\approx 1.267267654$.\n- $\\ln\\!\\left(\\frac{750}{748}\\right) \\approx 0.002670229$.\n\nSumming,\n$$\n\\text{LLR}(S) \\approx 0.339142465 + 1.415687660 + 0.881605174 + 0.728607231 + 1.267267654 + 0.002670229 \\approx 4.634980413.\n$$\n\nRounding to four significant figures gives $4.635$.", "answer": "$$\\boxed{4.635}$$", "id": "2554054"}, {"introduction": "The evolution of development is profoundly shaped by the modular architecture of gene regulation. This practice explores how mutations in different types of cis-regulatory elements—a tissue-specific enhancer versus a core promoter—can have dramatically different consequences for organismal phenotype and fitness. By modeling gene expression levels against developmental thresholds [@problem_id:2554032], you will gain a quantitative understanding of concepts like pleiotropy, modularity, and haploinsufficiency, which dictate the evolutionary accessibility of different mutations.", "problem": "A diploid organism uses modular cis-regulatory architecture to control a developmental gene $G$ that is expressed in $3$ tissues, $T_1$, $T_2$, and $T_3$. The gene has $3$ tissue-specific enhancers, $E_1$, $E_2$, and $E_3$, each driving expression in only its respective tissue, and a single core promoter $P$ required for transcription initiation in all tissues. Expression from the two alleles is assumed to add linearly in cis. The Central Dogma (Deoxyribonucleic Acid (DNA) $\\to$ Ribonucleic Acid (RNA) $\\to$ protein) and the definition of cis-regulatory modules imply that enhancers act in a tissue-restricted manner, whereas the core promoter contributes to transcription in all contexts.\n\nNormalize total wild-type biallelic expression in each tissue to $E_i^{\\mathrm{WT}} = 1$. Expression from a single intact allele contributes $0.5$, and a loss-of-function (LOF) cis-regulatory lesion on an allele eliminates that allele’s contribution where it acts. For each tissue $i \\in \\{1,2,3\\}$, proper function requires that total expression $E_i$ meets a tissue-specific threshold $\\theta_i$; if $E_i \\ge \\theta_i$, the tissue-specific fitness component is $f_i = 1$, and if $E_i < \\theta_i$, the component is $f_i = 1 - k_i$, where $k_i$ is the fractional penalty for impaired function. Overall relative fitness is multiplicative, $W = \\prod_{i=1}^{3} f_i$. Assume $\\theta_1 = 0.3$, $\\theta_2 = 0.7$, $\\theta_3 = 0.5$, and $k_1 = 0.2$, $k_2 = 0.5$, $k_3 = 0.4$.\n\nConsider two new LOF mutations introduced on a single allele: (a) a mutation that disrupts only enhancer $E_1$, and (b) a mutation that disrupts core promoter $P$ on that allele. Using the definitions above and standard population-genetic definitions in which the selection coefficient against a new mutation is approximated by $s \\approx 1 - W_{\\mathrm{het}}$ (where $W_{\\mathrm{het}}$ is the relative fitness of the heterozygote bearing the new mutation when rare), reason from these first principles to predict the phenotypic scope and relative selection coefficients for the two mutation classes.\n\nWhich option best matches the quantitative and qualitative predictions?\n\nA. The $E_1$ enhancer LOF heterozygote has $E_1 = 0.5$, $E_2 = 1$, $E_3 = 1$, exceeding all thresholds, so $W_{\\mathrm{het}} = 1$ and $s \\approx 0$. Its homozygote specifically fails in $T_1$ but not other tissues. The core promoter $P$ LOF heterozygote has $E_1 = 0.5$, $E_2 = 0.5$, $E_3 = 0.5$, so only $T_2$ falls below threshold, giving $W_{\\mathrm{het}} = 1 \\times (1 - 0.5) \\times 1 = 0.5$ and $s \\approx 0.5$; the homozygote is pleiotropically severe across all tissues.\n\nB. The $E_1$ enhancer LOF heterozygote incurs a halving of expression that halves fitness in $T_1$, giving $s \\approx 0.5$, while $P$ LOF heterozygotes are buffered by other enhancers, so $s \\approx 0$.\n\nC. Both enhancer and promoter LOF heterozygotes have $s \\approx 0.5$ because both reduce transcription, but promoter LOF homozygotes are milder than enhancer LOF homozygotes due to compensatory enhancer activity.\n\nD. Because $E_1$ controls an essential tissue, $E_1$ enhancer LOF heterozygotes experience stronger selection with $s \\approx 0.8$, whereas promoter LOF affects only one allele and is mostly recessive with $s \\approx 0$.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- Organism: Diploid.\n- Gene: $G$, expressed in $3$ tissues ($T_1, T_2, T_3$).\n- Cis-regulatory elements: $3$ tissue-specific enhancers ($E_1, E_2, E_3$) and $1$ core promoter ($P$).\n- Element functions: $E_i$ drives expression in tissue $T_i$ only. $P$ is required for transcription in all tissues.\n- Expression model: Biallelic expression adds linearly. A single wild-type (WT) allele contributes $0.5$ to expression in a given tissue. Total WT biallelic expression is normalized to $E_i^{\\mathrm{WT}} = 1$ in each tissue.\n- Mutation effect: A loss-of-function (LOF) lesion on an allele eliminates that allele's expression contribution where the element acts.\n- Fitness model:\n    - Tissue-specific fitness component $f_i = 1$ if total expression $E_i \\ge \\theta_i$.\n    - Tissue-specific fitness component $f_i = 1 - k_i$ if $E_i < \\theta_i$.\n    - Overall relative fitness $W = \\prod_{i=1}^{3} f_i$.\n- Parameters:\n    - Expression thresholds: $\\theta_1 = 0.3$, $\\theta_2 = 0.7$, $\\theta_3 = 0.5$.\n    - Fitness penalties: $k_1 = 0.2$, $k_2 = 0.5$, $k_3 = 0.4$.\n- New mutations: Two LOF mutations on a single allele are considered: (a) disrupts $E_1$ only; (b) disrupts $P$.\n- Selection coefficient: $s \\approx 1 - W_{\\mathrm{het}}$, where $W_{\\mathrm{het}}$ is the relative fitness of a heterozygote.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard, simplified model of gene regulation and its fitness consequences used in evolutionary and developmental biology.\n- **Scientifically Grounded**: The model is based on established principles of molecular genetics, including the distinct roles of enhancers and promoters, modular gene regulation, and dominance/recessivity arising from expression thresholds (haploinsufficiency). All concepts are standard.\n- **Well-Posed**: The problem is specified with all necessary quantitative parameters and clear definitions. A unique solution can be derived through direct calculation.\n- **Objective**: The language is precise and quantitative, avoiding any subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined exercise in applying first principles of genetics and population genetics. The solution will now be derived.\n\nThe task is to determine the fitness of heterozygotes for two different mutations and compare them. The wild-type genotype has a relative fitness of $W_{\\mathrm{WT}}=1$. We calculate the fitness $W_{\\mathrm{het}}$ for each heterozygote genotype, which consists of one wild-type allele and one mutant allele. The selection coefficient is then approximated as $s \\approx 1 - W_{\\mathrm{het}}$.\n\n**Case (a): Heterozygote for an $E_1$ enhancer LOF mutation**\n\nThis individual has one wild-type allele (WT) and one allele with a non-functional enhancer $E_1$ ($E_1$-LOF).\n\n1.  **Expression in Tissue $T_1$**: Expression is driven by enhancer $E_1$.\n    - The WT allele contributes $0.5$.\n    - The $E_1$-LOF allele's enhancer $E_1$ is non-functional, so it contributes $0$.\n    - Total expression: $E_1 = 0.5 + 0 = 0.5$.\n\n2.  **Expression in Tissue $T_2$**: Expression is driven by enhancer $E_2$.\n    - The WT allele contributes $0.5$.\n    - The $E_1$-LOF allele has a functional $E_2$ and $P$, so it contributes $0.5$.\n    - Total expression: $E_2 = 0.5 + 0.5 = 1.0$.\n\n3.  **Expression in Tissue $T_3$**: Expression is driven by enhancer $E_3$.\n    - The WT allele contributes $0.5$.\n    - The $E_1$-LOF allele has a functional $E_3$ and $P$, so it contributes $0.5$.\n    - Total expression: $E_3 = 0.5 + 0.5 = 1.0$.\n\nNow, we evaluate fitness by comparing expression levels to their thresholds:\n- For $T_1$: $E_1 = 0.5$. Threshold $\\theta_1 = 0.3$. Since $E_1 \\ge \\theta_1$, the fitness component is $f_1 = 1$.\n- For $T_2$: $E_2 = 1.0$. Threshold $\\theta_2 = 0.7$. Since $E_2 \\ge \\theta_2$, the fitness component is $f_2 = 1$.\n- For $T_3$: $E_3 = 1.0$. Threshold $\\theta_3 = 0.5$. Since $E_3 \\ge \\theta_3$, the fitness component is $f_3 = 1$.\n\nThe overall relative fitness of the $E_1$-LOF heterozygote is:\n$$W_{\\mathrm{het}, E1} = f_1 \\times f_2 \\times f_3 = 1 \\times 1 \\times 1 = 1$$\nThe selection coefficient against this mutation is:\n$$s_{E1} \\approx 1 - W_{\\mathrm{het}, E1} = 1 - 1 = 0$$\nThis mutation is completely recessive. A homozygote ($E_1$-LOF/$E_1$-LOF) would have $E_1 = 0$, failing the threshold in $T_1$, but would have normal expression ($E_2=1$, $E_3=1$) in other tissues. Thus, its phenotypic effect is tissue-specific.\n\n**Case (b): Heterozygote for a core promoter $P$ LOF mutation**\n\nThis individual has one wild-type allele (WT) and one allele with a non-functional promoter $P$ ($P$-LOF). The core promoter is required for transcription initiation in all tissues. Therefore, the $P$-LOF allele is a null allele, producing no gene product in any tissue.\n\n1.  **Expression in Tissue $T_1$**:\n    - The WT allele contributes $0.5$.\n    - The $P$-LOF allele contributes $0$.\n    - Total expression: $E_1 = 0.5 + 0 = 0.5$.\n\n2.  **Expression in Tissue $T_2$**:\n    - The WT allele contributes $0.5$.\n    - The $P$-LOF allele contributes $0$.\n    - Total expression: $E_2 = 0.5 + 0 = 0.5$.\n\n3.  **Expression in Tissue $T_3$**:\n    - The WT allele contributes $0.5$.\n    - The $P$-LOF allele contributes $0$.\n    - Total expression: $E_3 = 0.5 + 0 = 0.5$.\n\nNow, we evaluate fitness by comparing these expression levels to their thresholds:\n- For $T_1$: $E_1 = 0.5$. Threshold $\\theta_1 = 0.3$. Since $E_1 \\ge \\theta_1$, the fitness component is $f_1 = 1$.\n- For $T_2$: $E_2 = 0.5$. Threshold $\\theta_2 = 0.7$. Since $E_2 < \\theta_2$, the fitness component is $f_2 = 1 - k_2 = 1 - 0.5 = 0.5$.\n- For $T_3$: $E_3 = 0.5$. Threshold $\\theta_3 = 0.5$. Since $E_3 \\ge \\theta_3$, the fitness component is $f_3 = 1$.\n\nThe overall relative fitness of the $P$-LOF heterozygote is:\n$$W_{\\mathrm{het}, P} = f_1 \\times f_2 \\times f_3 = 1 \\times 0.5 \\times 1 = 0.5$$\nThe selection coefficient against this mutation is:\n$$s_{P} \\approx 1 - W_{\\mathrm{het}, P} = 1 - 0.5 = 0.5$$\nThis mutation is semi-dominant (not recessive), causing a substantial fitness reduction in the heterozygous state due to haploinsufficiency in tissue $T_2$. Its effect on expression is pleiotropic (occurs in all tissues). A homozygote ($P$-LOF/$P$-LOF) would have zero expression in all three tissues, leading to severe, global defects.\n\n### Option-by-Option Analysis\n\n**A. The $E_1$ enhancer LOF heterozygote has $E_1 = 0.5$, $E_2 = 1$, $E_3 = 1$, exceeding all thresholds, so $W_{\\mathrm{het}} = 1$ and $s \\approx 0$. Its homozygote specifically fails in $T_1$ but not other tissues. The core promoter $P$ LOF heterozygote has $E_1 = 0.5$, $E_2 = 0.5$, $E_3 = 0.5$, so only $T_2$ falls below threshold, giving $W_{\\mathrm{het}} = 1 \\times (1 - 0.5) \\times 1 = 0.5$ and $s \\approx 0.5$; the homozygote is pleiotropically severe across all tissues.**\n- This option provides a complete and accurate summary of the derived results. The expression levels, threshold comparisons, fitness values, selection coefficients, and phenotypic scope for both heterozygotes and homozygotes are all correct according to our calculations.\n- **Verdict: Correct**\n\n**B. The $E_1$ enhancer LOF heterozygote incurs a halving of expression that halves fitness in $T_1$, giving $s \\approx 0.5$, while $P$ LOF heterozygotes are buffered by other enhancers, so $s \\approx 0$.**\n- The first part is incorrect. A halving of expression in $T_1$ ($E_1=0.5$) does not cause a fitness penalty, as the expression remains above the threshold ($\\theta_1 = 0.3$). Thus, $s_{E1} \\approx 0$, not $0.5$.\n- The second part is incorrect. The $P$-LOF heterozygote is not \"buffered\". It suffers a fitness cost because expression in $T_2$ ($E_2=0.5$) falls below the high threshold ($\\theta_2 = 0.7$). Thus, $s_P \\approx 0.5$, not $0$.\n- **Verdict: Incorrect**\n\n**C. Both enhancer and promoter LOF heterozygotes have $s \\approx 0.5$ because both reduce transcription, but promoter LOF homozygotes are milder than enhancer LOF homozygotes due to compensatory enhancer activity.**\n- The first part is incorrect. Only the promoter LOF heterozygote has $s \\approx 0.5$; the enhancer LOF heterozygote has $s \\approx 0$.\n- The second part is factually inverted. A promoter LOF homozygote is a complete null with zero expression in all tissues, making it far more severe than an enhancer LOF homozygote, which has a tissue-specific defect.\n- **Verdict: Incorrect**\n\n**D. Because $E_1$ controls an essential tissue, $E_1$ enhancer LOF heterozygotes experience stronger selection with $s \\approx 0.8$, whereas promoter LOF affects only one allele and is mostly recessive with $s \\approx 0$.**\n- The first part is incorrect. Our calculation shows $s_{E1} \\approx 0$. There is no basis for claiming stronger selection or the value $s \\approx 0.8$.\n- The second part is incorrect. The promoter LOF is not \"mostly recessive\". It is semi-dominant with $s_P \\approx 0.5$.\n- **Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2554032"}, {"introduction": "Understanding the evolutionary fate of a new cis-regulatory variant requires synthesizing its molecular function with population-level processes. This culminating practice asks you to model the complete evolutionary trajectory of an allele that alters developmental timing, a common target of regulatory evolution. You will derive a fitness function from a developmental cost model and then simulate the allele's frequency change under selection [@problem_id:2554085], providing a powerful, hands-on integration of developmental genetics, quantitative genetics, and population dynamics.", "problem": "You will model fitness consequences of mistimed gene expression timing caused by cis-regulatory enhancer variants and simulate deterministic allele-frequency dynamics under viability selection in a large, randomly mating population. Use the following fundamental bases: (i) the Central Dogma mapping where cis-regulatory changes alter the timing of gene expression during development and thereby affect phenotype, (ii) a developmental cost-to-fitness mapping, and (iii) Hardy–Weinberg equilibrium (HWE) with viability selection in discrete generations.\n\nModel assumptions and definitions:\n- Developmental time is scaled to a unit interval, so it is dimensionless. Let the optimal expression time be $\\,\\tau^{\\star}\\in[0,1]$ and the baseline (ancestral) expression time be $\\,\\tau_0\\in[0,1]$.\n- A single biallelic enhancer locus has alleles $\\,A\\,$ (ancestral) and $\\,a\\,$ (derived). The derived allele shifts the mean expression time by a signed amount $\\,\\delta\\,$ relative to $\\,A$. Dominance is parameterized by $\\,h\\in[0,1]$ so that genotype mean expression times are\n  - $\\,\\mu_{AA}=\\tau_0$,\n  - $\\,\\mu_{Aa}=\\tau_0+h\\,\\delta$,\n  - $\\,\\mu_{aa}=\\tau_0+\\delta$.\n- Developmental cost is quadratic around the optimum: $\\,C(\\tau)=c\\,(\\tau-\\tau^{\\star})^2\\,$ with $\\,c>0\\,$. Fitness maps from cost as $\\,W(\\tau)=\\exp(-C(\\tau))=\\exp\\big(-c(\\tau-\\tau^{\\star})^2\\big)$.\n- Developmental noise in timing is modeled as $\\,X_g\\sim\\mathcal{N}(\\mu_g,\\sigma^2)$ for genotype $\\,g\\in\\{AA,Aa,aa\\}$, so expected genotype fitness is\n  $$\\bar{W}_g=\\mathbb{E}\\big[\\exp\\big(-c(X_g-\\tau^{\\star})^2\\big)\\big].$$\n\nTask 1. Starting from the above definitions, derive a closed-form expression for $\\,\\bar{W}_g\\,$ in terms of $\\,\\mu_g,\\tau^{\\star},c,\\sigma$.\n\nTask 2. Using HWE with viability selection, let $\\,p_t\\,$ denote the frequency of allele $\\,a\\,$ in generation $\\,t$. With genotype viabilities $\\,w_{11}=\\bar{W}_{AA},\\,w_{12}=\\bar{W}_{Aa},\\,w_{22}=\\bar{W}_{aa}$, and $\\,q_t=1-p_t$, compute\n- the mean fitness $\\,\\bar{w}_t=q_t^2 w_{11}+2p_t q_t w_{12}+p_t^2 w_{22}$,\n- the allele-frequency update\n  $$p_{t+1}=\\frac{p_t^2 w_{22}+p_t q_t w_{12}}{\\bar{w}_t}.$$\n\nTask 3. Implement a program that, for each test case, computes the final allele frequency $\\,p_G\\,$ after $\\,G\\,$ generations of deterministic viability selection starting from initial frequency $\\,p_0\\,$. All times are dimensionless; no physical units are involved. Return each $\\,p_G\\,$ as a float rounded to six decimal places.\n\nTest suite:\nEach test case is a tuple $(\\tau^{\\star},\\tau_0,\\delta,h,c,\\sigma,p_0,G)$ with the following specific values.\n- Case A (beneficial additive shift toward the optimum):\n  - $(0.5,\\,0.55,\\,-0.05,\\,0.5,\\,100,\\,0.02,\\,0.1,\\,50)$\n- Case B (overdominance due to overshoot, stable polymorphism):\n  - $(0.5,\\,0.46,\\,0.1,\\,0.5,\\,100,\\,0.02,\\,0.1,\\,200)$\n- Case C (baseline already optimal; any shift is deleterious):\n  - $(0.5,\\,0.5,\\,0.05,\\,0.5,\\,100,\\,0.02,\\,0.5,\\,50)$\n- Case D (neutral variant with zero effect size):\n  - $(0.5,\\,0.6,\\,0.0,\\,0.5,\\,100,\\,0.02,\\,0.37,\\,100)$\n- Case E (beneficial recessive, slow response):\n  - $(0.5,\\,0.56,\\,-0.06,\\,0.0,\\,100,\\,0.02,\\,0.01,\\,500)$\n- Case F (high developmental noise weakens selection):\n  - $(0.5,\\,0.6,\\,-0.1,\\,0.5,\\,100,\\,0.1,\\,0.1,\\,50)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces, in the same order as the test suite (for example, \"[0.123456,0.234567,0.345678,0.456789,0.567890,0.678901]\"). Each numeric result must be rounded to six decimal places (decimal format), with no additional text printed.", "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in established principles of population and quantitative genetics, well-posed with all necessary information provided, and stated objectively using precise mathematical language. There are no contradictions, ambiguities, or factual inaccuracies. We may therefore proceed with the solution.\n\nThe problem requires a three-part solution: first, the derivation of a closed-form expression for genotype fitness; second, the acknowledgment of the population-genetic model; and third, the implementation of a simulation based on these components.\n\n**Task 1: Derivation of Expected Genotype Fitness $\\bar{W}_g$**\n\nThe expected fitness for a genotype $g$, denoted $\\bar{W}_g$, is the expectation of the fitness function $W(X_g) = \\exp(-c(X_g-\\tau^{\\star})^2)$ over the distribution of the developmental timing phenotype $X_g$. The phenotype $X_g$ is modeled as a random variable following a normal distribution, $X_g \\sim \\mathcal{N}(\\mu_g, \\sigma^2)$, where $\\mu_g$ is the mean expression time for genotype $g$ and $\\sigma^2$ is the variance due to developmental noise.\n\nThe expectation is given by the integral:\n$$ \\bar{W}_g = \\mathbb{E}\\big[\\exp(-c(X_g - \\tau^{\\star})^2)\\big] = \\int_{-\\infty}^{\\infty} \\exp(-c(x - \\tau^{\\star})^2) \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu_g)^2}{2\\sigma^2}\\right) dx $$\nTo evaluate this integral, we combine the terms in the exponent. The argument of the exponential function is a quadratic in $x$:\n$$ -c(x - \\tau^{\\star})^2 - \\frac{(x - \\mu_g)^2}{2\\sigma^2} = -c(x^2 - 2x\\tau^{\\star} + (\\tau^{\\star})^2) - \\frac{1}{2\\sigma^2}(x^2 - 2x\\mu_g + \\mu_g^2) $$\n$$ = -\\left(c + \\frac{1}{2\\sigma^2}\\right)x^2 + 2\\left(c\\tau^{\\star} + \\frac{\\mu_g}{2\\sigma^2}\\right)x - \\left(c(\\tau^{\\star})^2 + \\frac{\\mu_g^2}{2\\sigma^2}\\right) $$\nLet's complete the square for the terms involving $x$. The expression is of the form $-Ax^2 + Bx - D$. We rewrite this as $-A(x-M)^2 + K$, where $M = B/(2A)$ and $K = B^2/(4A) - D$.\n\nThe coefficients are:\n$$ A = c + \\frac{1}{2\\sigma^2} = \\frac{1 + 2c\\sigma^2}{2\\sigma^2} $$\n$$ B = 2\\left(c\\tau^{\\star} + \\frac{\\mu_g}{2\\sigma^2}\\right) = \\frac{2c\\sigma^2\\tau^{\\star} + \\mu_g}{\\sigma^2} $$\n$$ D = c(\\tau^{\\star})^2 + \\frac{\\mu_g^2}{2\\sigma^2} $$\nThe constant term $K$ in the exponent simplifies as follows:\n$$ K = \\frac{B^2}{4A} - D = \\frac{\\left(\\frac{2c\\sigma^2\\tau^{\\star} + \\mu_g}{\\sigma^2}\\right)^2}{4\\left(\\frac{1 + 2c\\sigma^2}{2\\sigma^2}\\right)} - \\left(c(\\tau^{\\star})^2 + \\frac{\\mu_g^2}{2\\sigma^2}\\right) $$\n$$ = \\frac{(2c\\sigma^2\\tau^{\\star} + \\mu_g)^2}{2\\sigma^2(1 + 2c\\sigma^2)} - \\frac{c(\\tau^{\\star})^2 \\cdot 2\\sigma^2(1 + 2c\\sigma^2) + \\mu_g^2(1 + 2c\\sigma^2)}{2\\sigma^2(1 + 2c\\sigma^2)} $$\nThe numerator of this expression is:\n$$ (4c^2\\sigma^4(\\tau^{\\star})^2 + 4c\\sigma^2\\mu_g\\tau^{\\star} + \\mu_g^2) - (2c\\sigma^2(\\tau^{\\star})^2 + 4c^2\\sigma^4(\\tau^{\\star})^2 + \\mu_g^2 + 2c\\sigma^2\\mu_g^2) $$\n$$ = 4c\\sigma^2\\mu_g\\tau^{\\star} - 2c\\sigma^2(\\tau^{\\star})^2 - 2c\\sigma^2\\mu_g^2 = -2c\\sigma^2(\\mu_g^2 - 2\\mu_g\\tau^{\\star} + (\\tau^{\\star})^2) = -2c\\sigma^2(\\mu_g - \\tau^{\\star})^2 $$\nSo, the term $K$ is:\n$$ K = \\frac{-2c\\sigma^2(\\mu_g - \\tau^{\\star})^2}{2\\sigma^2(1 + 2c\\sigma^2)} = -\\frac{c(\\mu_g - \\tau^{\\star})^2}{1 + 2c\\sigma^2} $$\nThe integral now becomes:\n$$ \\bar{W}_g = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\int_{-\\infty}^{\\infty} \\exp(-A(x-M)^2) \\exp(K) dx $$\n$$ = \\frac{\\exp(K)}{\\sqrt{2\\pi\\sigma^2}} \\int_{-\\infty}^{\\infty} \\exp(-A(x-M)^2) dx $$\nThe remaining integral is a standard Gaussian integral, $\\int_{-\\infty}^{\\infty} e^{-A(x-M)^2}dx = \\sqrt{\\pi/A}$.\n$$ \\bar{W}_g = \\frac{\\exp(K)}{\\sqrt{2\\pi\\sigma^2}} \\sqrt{\\frac{\\pi}{A}} = \\frac{\\exp(K)}{\\sqrt{2\\sigma^2 A}} $$\nSubstituting the expressions for $A$ and $K$:\n$$ \\sqrt{2\\sigma^2 A} = \\sqrt{2\\sigma^2 \\left(\\frac{1+2c\\sigma^2}{2\\sigma^2}\\right)} = \\sqrt{1+2c\\sigma^2} $$\nThe final closed-form expression for the expected genotype fitness is:\n$$ \\bar{W}_g = \\frac{1}{\\sqrt{1+2c\\sigma^2}} \\exp\\left( -\\frac{c(\\mu_g - \\tau^{\\star})^2}{1+2c\\sigma^2} \\right) $$\nThis expression will be used to calculate the viabilities $w_{11}$, $w_{12}$, and $w_{22}$.\n\n**Task 2: Population Genetic Model**\n\nThe problem specifies a standard model of viability selection in a large, randomly mating diploid population. The allele frequencies change across discrete generations. Given the frequency of allele $a$ as $p_t$ in generation $t$, and the frequency of allele $A$ as $q_t = 1-p_t$, the genotype frequencies under Hardy-Weinberg proportions are $q_t^2$ for $AA$, $2p_tq_t$ for $Aa$, and $p_t^2$ for $aa$.\n\nThe viabilities of the genotypes are given by their expected fitnesses, calculated in Task 1:\n- $w_{11} = \\bar{W}_{AA}$\n- $w_{12} = \\bar{W}_{Aa}$\n- $w_{22} = \\bar{W}_{aa}$\n\nThe mean fitness of the population in generation $t$ is the weighted average of the genotype viabilities:\n$$ \\bar{w}_t=q_t^2 w_{11}+2p_t q_t w_{12}+p_t^2 w_{22} $$\nThe frequency of allele $a$ in the next generation, $p_{t+1}$, is found by considering the proportion of $a$ alleles among the surviving population. This leads to the standard recurrence relation provided in the problem:\n$$ p_{t+1}=\\frac{p_t^2 w_{22}+p_t q_t w_{12}}{\\bar{w}_t} $$\nThese formulas are correct and form the basis for the simulation in Task 3.\n\n**Task 3: Computational Implementation**\n\nThe objective is to find the frequency of allele $a$, denoted $p_G$, after $G$ generations, starting from an initial frequency $p_0$. This is achieved by iterating the recurrence relation for $p_t$ for $G$ steps.\n\nThe algorithm for a single test case $(\\tau^{\\star}, \\tau_0, \\delta, h, c, \\sigma, p_0, G)$ is as follows:\n1.  Calculate the mean expression times for the three genotypes using their definitions:\n    - $\\mu_{AA} = \\tau_0$\n    - $\\mu_{Aa} = \\tau_0 + h\\delta$\n    - $\\mu_{aa} = \\tau_0 + \\delta$\n2.  Calculate the constant absolute viabilities $w_{11}$, $w_{12}$, and $w_{22}$ using the derived formula for $\\bar{W}_g$ with the corresponding mean phenotypes $\\mu_{AA}$, $\\mu_{Aa}$, and $\\mu_{aa}$.\n3.  Initialize the allele frequency $p \\leftarrow p_0$.\n4.  Execute a loop $G$ times (from generation $t=0$ to $t=G-1$):\n    a. Let $q = 1 - p$.\n    b. Compute the mean population fitness: $\\bar{w} = q^2 w_{11} + 2pq w_{12} + p^2 w_{22}$.\n    c. Update the allele frequency for the next generation: $p \\leftarrow (p^2 w_{22} + pq w_{12}) / \\bar{w}$.\n5.  The final value of $p$ is the result, $p_G$. This procedure is repeated for each test case provided in the problem statement. The final results are presented in the specified format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (tau_star, tau_0, delta, h, c, sigma, p0, G)\n    test_cases = [\n        # Case A: beneficial additive shift toward the optimum\n        (0.5, 0.55, -0.05, 0.5, 100, 0.02, 0.1, 50),\n        # Case B: overdominance due to overshoot, stable polymorphism\n        (0.5, 0.46, 0.1, 0.5, 100, 0.02, 0.1, 200),\n        # Case C: baseline already optimal; any shift is deleterious\n        (0.5, 0.5, 0.05, 0.5, 100, 0.02, 0.5, 50),\n        # Case D: neutral variant with zero effect size\n        (0.5, 0.6, 0.0, 0.5, 100, 0.02, 0.37, 100),\n        # Case E: beneficial recessive, slow response\n        (0.5, 0.56, -0.06, 0.0, 100, 0.02, 0.01, 500),\n        # Case F: high developmental noise weakens selection\n        (0.5, 0.6, -0.1, 0.5, 100, 0.1, 0.1, 50),\n    ]\n\n    results = []\n    for case in test_cases:\n        p_G = run_simulation(*case)\n        results.append(p_G)\n    \n    # Format and print the final output as specified.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_expected_fitness(mu_genotype, tau_star, c, sigma):\n    \"\"\"\n    Calculates the expected fitness for a genotype using the derived closed-form expression.\n    \n    Args:\n        mu_genotype (float): Mean expression time for the genotype.\n        tau_star (float): Optimal expression time.\n        c (float): Strength of selection (cost parameter).\n        sigma (float): Standard deviation of developmental noise.\n\n    Returns:\n        float: The expected absolute fitness (viability) of the genotype.\n    \"\"\"\n    # Common denominator in both the prefactor and the exponent\n    denom = 1.0 + 2.0 * c * sigma**2\n    \n    # Prefactor from the integral\n    prefactor = 1.0 / np.sqrt(denom)\n    \n    # Exponent term\n    exponent = -c * (mu_genotype - tau_star)**2 / denom\n    \n    return prefactor * np.exp(exponent)\n\ndef run_simulation(tau_star, tau_0, delta, h, c, sigma, p0, G):\n    \"\"\"\n    Simulates allele frequency dynamics under viability selection for G generations.\n\n    Args:\n        tau_star (float): Optimal expression time.\n        tau_0 (float): Baseline (ancestral) expression time.\n        delta (float): Effect of the derived allele.\n        h (float): Dominance coefficient.\n        c (float): Strength of selection.\n        sigma (float): Standard deviation of developmental noise.\n        p0 (float): Initial frequency of the derived allele 'a'.\n        G (int): Number of generations to simulate.\n\n    Returns:\n        float: The frequency of allele 'a' after G generations.\n    \"\"\"\n    # 1. Calculate mean expression times for each genotype\n    mu_AA = tau_0\n    mu_Aa = tau_0 + h * delta\n    mu_aa = tau_0 + delta\n\n    # 2. Calculate the absolute viabilities for each genotype\n    w_11 = calculate_expected_fitness(mu_AA, tau_star, c, sigma)\n    w_12 = calculate_expected_fitness(mu_Aa, tau_star, c, sigma)\n    w_22 = calculate_expected_fitness(mu_aa, tau_star, c, sigma)\n\n    # 3. Initialize allele frequency\n    p = p0\n\n    # 4. Iterate for G generations\n    for _ in range(G):\n        q = 1.0 - p\n        \n        # Calculate mean population fitness\n        mean_w = q**2 * w_11 + 2 * p * q * w_12 + p**2 * w_22\n        \n        # This check is for numerical stability, though unlikely to be triggered with given parameters.\n        if mean_w == 0:\n            break\n        \n        # Update allele frequency using the standard recurrence equation\n        p_numerator = p**2 * w_22 + p * q * w_12\n        p = p_numerator / mean_w\n        \n    return p\n\n# Execute the main function\nsolve()\n```", "id": "2554085"}]}