{"hands_on_practices": [{"introduction": "The concept of deep homology extends beyond the conservation of individual genes to the conservation of the underlying logic of regulatory circuits. This exercise explores this idea using the genetic toggle switch, a common network motif for making binary cell fate decisions in both animals and plants. By analyzing a mathematical model of this switch, you will derive the precise conditions required for it to function, demonstrating how an abstract quantitative principle can be the target of selection and conservation across kingdoms. [@problem_id:2564696]", "problem": "In both angiosperm shoot meristems and bilaterian embryonic organizers, pairs of transcription factors mutually repress each other to specify alternative fates. Assume that in each lineage this regulatory module can be captured by the same nondimensionalized ordinary differential equation (ODE) toggle system with Hill-type repression:\n$$\n\\frac{dX}{d\\tau}=\\frac{\\alpha}{1+Y^{n}}-X,\\qquad \\frac{dY}{d\\tau}=\\frac{\\alpha}{1+X^{n}}-Y,\n$$\nwhere $X$ and $Y$ are dimensionless concentrations, $\\tau$ is dimensionless time, $\\alpha>0$ is a dimensionless control parameter proportional to the ratio of maximal synthesis to degradation, and $n>1$ is the Hill coefficient reflecting the cooperativity of repression. These equations arise by nondimensionalizing the dimensional model\n$$\n\\frac{dx}{dt}=\\frac{s}{1+(y/K)^{n}}-d\\,x,\\qquad \\frac{dy}{dt}=\\frac{s}{1+(x/K)^{n}}-d\\,y,\n$$\nusing $X=x/K$, $Y=y/K$, and $\\tau=d\\,t$, so that $\\alpha=s/(dK)$.\n\nStarting from these equations and standard definitions of steady states and linear stability (via the Jacobian and its eigenvalues), derive from first principles the critical value $\\alpha_{c}(n)$ at which the symmetric steady state loses stability to antisymmetric perturbations, marking the onset of bistability in this toggle module. Then explain why the existence of the same analytic threshold across taxa constitutes evidence for deep-homologous logic across animal and plant body plans.\n\nProvide only the closed-form analytic expression for $\\alpha_{c}(n)$ as your final answer. This quantity is dimensionless; no units are to be reported. Do not round; report the exact expression.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It describes a canonical model in systems biology, the genetic toggle switch, and poses a standard question of stability analysis. The parameters and equations are clearly defined. The conceptual tie-in to deep homology is a legitimate topic in evolutionary developmental biology. Therefore, the problem is valid, and we shall proceed with the derivation.\n\nThe system of ordinary differential equations is given by:\n$$\n\\frac{dX}{d\\tau} = f(X,Y) = \\frac{\\alpha}{1+Y^{n}} - X\n$$\n$$\n\\frac{dY}{d\\tau} = g(X,Y) = \\frac{\\alpha}{1+X^{n}} - Y\n$$\nwhere $X$ and $Y$ are dimensionless concentrations, $\\tau$ is dimensionless time, and the parameters $\\alpha > 0$ and $n > 1$ represent the effective synthesis rate and cooperativity, respectively.\n\nFirst, we must identify the steady states $(X^{*}, Y^{*})$ of the system by setting the time derivatives to zero:\n$$\n\\frac{dX}{d\\tau} = 0 \\implies X^{*} = \\frac{\\alpha}{1+(Y^{*})^{n}}\n$$\n$$\n\\frac{dY}{d\\tau} = 0 \\implies Y^{*} = \\frac{\\alpha}{1+(X^{*})^{n}}\n$$\nWe are specifically interested in the stability of the *symmetric* steady state, where $X^{*} = Y^{*}$. Let us denote this common concentration as $Z$. Substituting $X^{*} = Y^{*} = Z$ into either equation yields a single equation for $Z$:\n$$\nZ = \\frac{\\alpha}{1+Z^{n}}\n$$\nThis equation implicitly defines the concentration $Z$ of the symmetric steady state for a given $\\alpha$ and $n$.\n\nTo analyze the linear stability of this steady state, we must compute the Jacobian matrix of the system, $J$, evaluated at this point. The Jacobian matrix is defined as:\n$$\nJ(X,Y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial X} & \\frac{\\partial f}{\\partial Y} \\\\ \\frac{\\partial g}{\\partial X} & \\frac{\\partial g}{\\partial Y} \\end{pmatrix}\n$$\nThe required partial derivatives are:\n$$\n\\frac{\\partial f}{\\partial X} = -1\n$$\n$$\n\\frac{\\partial f}{\\partial Y} = \\frac{\\partial}{\\partial Y} \\left( \\alpha (1+Y^{n})^{-1} \\right) = -\\alpha (1+Y^{n})^{-2} (n Y^{n-1}) = \\frac{-\\alpha n Y^{n-1}}{(1+Y^{n})^{2}}\n$$\n$$\n\\frac{\\partial g}{\\partial X} = \\frac{\\partial}{\\partial X} \\left( \\alpha (1+X^{n})^{-1} \\right) = -\\alpha (1+X^{n})^{-2} (n X^{n-1}) = \\frac{-\\alpha n X^{n-1}}{(1+X^{n})^{2}}\n$$\n$$\n\\frac{\\partial g}{\\partial Y} = -1\n$$\nThus, the Jacobian matrix is:\n$$\nJ(X,Y) = \\begin{pmatrix} -1 & \\frac{-\\alpha n Y^{n-1}}{(1+Y^{n})^{2}} \\\\ \\frac{-\\alpha n X^{n-1}}{(1+X^{n})^{2}} & -1 \\end{pmatrix}\n$$\nWe evaluate this matrix at the symmetric steady state $(Z, Z)$:\n$$\nJ_{sym} = J(Z,Z) = \\begin{pmatrix} -1 & \\frac{-\\alpha n Z^{n-1}}{(1+Z^{n})^{2}} \\\\ \\frac{-\\alpha n Z^{n-1}}{(1+Z^{n})^{2}} & -1 \\end{pmatrix}\n$$\nLet us simplify the off-diagonal term using the steady-state relationship $\\alpha = Z(1+Z^{n})$. Let the magnitude of the off-diagonal terms be $b$:\n$$\nb = \\frac{\\alpha n Z^{n-1}}{(1+Z^{n})^{2}} = \\frac{Z(1+Z^{n}) n Z^{n-1}}{(1+Z^{n})^{2}} = \\frac{n Z^{n}}{1+Z^{n}}\n$$\nThe Jacobian at the symmetric steady state then becomes:\n$$\nJ_{sym} = \\begin{pmatrix} -1 & -b \\\\ -b & -1 \\end{pmatrix}\n$$\nThe stability of the steady state is determined by the eigenvalues, $\\lambda$, of this matrix. The eigenvalues are the roots of the characteristic equation $\\det(J_{sym} - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -1-\\lambda & -b \\\\ -b & -1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1-\\lambda)^{2} - (-b)^{2} = 0\n$$\n$$\n(1+\\lambda)^{2} - b^{2} = 0\n$$\n$$\n( (1+\\lambda) - b ) ( (1+\\lambda) + b ) = 0\n$$\nThis yields two eigenvalues:\n$$\n\\lambda_{1} = b - 1\n$$\n$$\n\\lambda_{2} = -b - 1\n$$\nSince $n > 1$ and $Z > 0$, the term $b = \\frac{n Z^{n}}{1+Z^{n}}$ must be positive. Therefore, the eigenvalue $\\lambda_{2} = -b-1$ is always negative. This eigenvalue corresponds to perturbations that are symmetric (i.e., $\\delta X = \\delta Y$). The system is always stable to such perturbations.\n\nThe stability of the symmetric steady state is therefore determined entirely by the sign of $\\lambda_{1} = b-1$. This eigenvalue corresponds to antisymmetric perturbations (i.e., $\\delta X = -\\delta Y$), which lead to the two distinct stable states of the toggle switch. The symmetric state is stable if $\\lambda_{1} < 0$, which requires $b < 1$. It loses stability when $\\lambda_{1} = 0$, which occurs precisely when $b = 1$. This condition marks the critical point (a pitchfork bifurcation) where the single symmetric state becomes unstable and two new, stable, asymmetric states emerge. This is the onset of bistability.\n\nThe critical condition is thus $b = 1$. Let us find the value of $Z$ at this critical point, denoted $Z_{c}$:\n$$\nb = \\frac{n Z_{c}^{n}}{1+Z_{c}^{n}} = 1\n$$\n$$\nn Z_{c}^{n} = 1 + Z_{c}^{n}\n$$\n$$\n(n-1)Z_{c}^{n} = 1\n$$\n$$\nZ_{c}^{n} = \\frac{1}{n-1}\n$$\nTaking the $n$-th root, we find the critical concentration:\n$$\nZ_{c} = \\left(\\frac{1}{n-1}\\right)^{\\frac{1}{n}} = (n-1)^{-\\frac{1}{n}}\n$$\nWe seek the critical value of the control parameter, $\\alpha_{c}$, at which this occurs. We use the steady-state equation evaluated at the critical point: $\\alpha_{c} = Z_{c}(1+Z_{c}^{n})$.\nSubstituting the expressions for $Z_{c}$ and $Z_{c}^{n}$:\n$$\n\\alpha_{c}(n) = Z_{c}\\left(1 + \\frac{1}{n-1}\\right) = (n-1)^{-\\frac{1}{n}} \\left(\\frac{n-1+1}{n-1}\\right)\n$$\n$$\n\\alpha_{c}(n) = (n-1)^{-\\frac{1}{n}} \\left(\\frac{n}{n-1}\\right)\n$$\nCombining the terms with base $(n-1)$:\n$$\n\\alpha_{c}(n) = n (n-1)^{-1} (n-1)^{-\\frac{1}{n}} = n (n-1)^{-(1+\\frac{1}{n})}\n$$\n$$\n\\alpha_{c}(n) = n (n-1)^{-\\frac{n+1}{n}}\n$$\nThis is the closed-form analytic expression for the critical value of $\\alpha$ as a function of the Hill coefficient $n$.\n\nThe existence of such an analytic threshold, derived from the fundamental logic of mutual repression, provides a powerful lens for comparative biology. The term \"deep homology\" extends beyond the conservation of genes to the conservation of the underlying developmental processes and regulatory network motifs. The toggle switch represents such a motif. Its function—creating a binary decision—depends not on the specific identity of the transcription factors $X$ and $Y$ but on the structure of their interaction (mutual repression) and the quantitative satisfaction of a mathematical condition for bistability. The threshold $\\alpha > \\alpha_{c}(n)$ defines the parameter regime where this function is possible.\n\nIf functionally analogous but phylogenetically distant systems, such as those controlling cell fate in plant meristems and animal embryos, are found to operate according to this same quantitative principle, it implies a profound evolutionary convergence or conservation. Evolution, acting on vastly different molecular components in lineages separated by over a billion years, has apparently tuned the relevant biochemical parameters (synthesis rates, degradation rates, binding cooperativity) to satisfy the same abstract, non-obvious mathematical inequality. This suggests that the \"logic\" of the regulatory circuit itself—a specific solution to the problem of generating binary fates—is the object of selection. The shared analytic threshold for function, $\\alpha_{c}(n)$, is a signature of this shared logic, providing strong evidence for homology at the level of the developmental algorithm, or \"deep-homologous logic,\" rather than just at the level of genes or gross morphology.", "answer": "$$\\boxed{n (n-1)^{-\\frac{n+1}{n}}}$$", "id": "2564696"}, {"introduction": "Moving from abstract models to empirical tests, a central challenge is to rigorously assess the functional conservation of regulatory elements in their native context. This problem guides you through designing a state-of-the-art experiment using CRISPR-Cas9 to swap a regulatory enhancer between mouse and fly at its endogenous genomic locus. This 'hands-on' thought experiment hones the critical thinking needed to isolate the function of a single regulatory component and test the deep homology of the surrounding genomic architecture. [@problem_id:2564636]", "problem": "In comparative zoology and botany, deep homology refers to the conservation of gene regulatory networks across distantly related body plans, even when morphologies differ. A central test is whether a cis-regulatory enhancer from one species can functionally substitute for its ortholog at the endogenous locus in another species. Consider the following framework: the Central Dogma of molecular biology states that DNA is transcribed into RNA and translated into protein, and for spatial and temporal specificity of transcription, cis-regulatory modules (enhancers) integrate transcription factor inputs through sequence-specific binding sites to modulate promoter activity. In Hox gene clusters, conserved anterior–posterior expression domains are established by regulatory architecture that includes enhancers, insulators, and three-dimensional genome topology constrained within Topologically Associating Domains (TADs). Assume that orthology of enhancers can be established by conserved synteny and shared motif content rather than strict sequence identity. Your task is to identify, from the options below, the most rigorous Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)-based cross-species enhancer swap experiment that would directly test whether Hox regulatory architecture is functionally conserved across phyla, and to recognize the appropriate predictions and controls that follow from first principles. The design should isolate enhancer function, avoid position effects, respect local chromatin topology, and provide quantitative, spatially resolved readouts of gene function.\n\nWhich option best satisfies these criteria?\n\nA. Use CRISPR-associated protein 9 (Cas9) and homology-directed repair (HDR) to perform a scarless replacement of a defined, necessary Hox enhancer at its endogenous locus in Drosophila with the orthologous mouse enhancer, preserving enhancer orientation and distance to the promoter within the same Topologically Associating Domain (TAD). Include a reciprocal swap at the orthologous mouse locus. Use single-copy edits confirmed by whole-genome sequencing, and allele-specific reporters to distinguish the edited allele from the wild type. Quantify spatial expression with single-molecule RNA fluorescence in situ hybridization (RNA-FISH), assess transcription factor occupancy by Chromatin Immunoprecipitation followed by sequencing (ChIP-seq), and test phenotypic rescue in a sensitized mutant background. Include controls: species-matched enhancer replacement (positive control), size-matched non-orthologous enhancer (negative control), and a scrambled enhancer of identical base composition (negative control). Predict that if regulatory architecture is conserved, the cross-species enhancer will drive expression domain boundaries within approximately $10\\%$ of the wild-type positions along the anterior–posterior axis and rescue segment identity defects, while maintaining appropriate three-dimensional contacts as measured by chromosome conformation capture.\n\nB. Generate transgenic Drosophila embryos carrying a multicopy plasmid with the mouse Hox enhancer driving Green Fluorescent Protein (GFP) under a heterologous minimal promoter inserted at a random genomic location. If GFP is expressed in any axial domain, conclude that regulatory architecture is conserved. No reciprocal experiment or endogenous locus replacement is needed, and bulk RNA sequencing suffices to quantify conservation without spatial analysis.\n\nC. Replace the Drosophila Hox coding sequence with the mouse Hox coding sequence using CRISPR-Cas9, leaving all Drosophila enhancers intact. If the mouse coding sequence rescues Drosophila segment identity phenotypes, conclude that Hox regulatory architecture is conserved across species. Enhancer manipulations are unnecessary because coding-region rescue demonstrates deep homology.\n\nD. Use CRISPR-Cas9 to insert the mouse enhancer into the Drosophila genome at a safe-harbor site outside the Hox cluster, while deleting the endogenous Hox enhancer. Measure overall Hox mRNA levels by bulk quantitative polymerase chain reaction (qPCR) from whole embryos at a single time point. If total mRNA is within $2$-fold of wild type, interpret this as functional conservation, because the enhancer still increases transcription even if the location differs.\n\nE. Test cross-kingdom conservation by replacing a Drosophila Hox enhancer with a plant KNOX gene enhancer at the endogenous locus. If any change in Drosophila Hox expression is detected by immunostaining at $24$ hours, conclude that deep homology of Hox regulatory architecture extends across animals and plants, rendering animal–animal comparisons unnecessary.\n\nSelect the best option.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Concept**: Deep homology is the conservation of gene regulatory networks across distantly related body plans.\n- **Test**: A functional substitution of a cis-regulatory enhancer from one species for its ortholog at the endogenous locus in another.\n- **Biological Framework**: Central Dogma (DNA $\\rightarrow$ RNA $\\rightarrow$ protein); enhancers integrate transcription factor (TF) inputs to modulate promoter activity for spatio-temporal gene expression.\n- **Model System**: Hox gene clusters, where expression domains are set by a regulatory architecture involving enhancers, insulators, and 3D genome topology (Topologically Associating Domains, or TADs).\n- **Assumption**: Enhancer orthology is determined by conserved synteny and shared motif content, not strict sequence identity.\n- **Task**: Identify the most rigorous CRISPR-based cross-species enhancer swap experiment to test the functional conservation of Hox regulatory architecture across phyla.\n- **Experimental Design Criteria**:\n    1. Isolate enhancer function.\n    2. Avoid position effects.\n    3. Respect local chromatin topology.\n    4. Provide quantitative, spatially resolved readouts of gene function.\n    5. Include appropriate predictions and controls.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. It accurately describes established principles in molecular, evolutionary, and developmental biology, including deep homology, the function of cis-regulatory elements, the structure of Hox gene regulation, and the application of modern genomic and gene-editing techniques like CRISPR-Cas9. The question is well-posed, asking for the evaluation of experimental designs against a clear and rigorous set of criteria. The language is objective and precise. The problem is self-contained and does not suffer from contradictions or missing information. The proposed scenario is a realistic, albeit challenging, representation of cutting-edge research in the field.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It presents a sophisticated and correct challenge in experimental design. I will proceed with a full analysis of the provided options.\n\n**Solution Derivation and Option Analysis**\n\nThe task demands identification of the most rigorous experimental design to test the functional conservation of a *regulatory architecture*. This implies that the experiment must preserve the native context of the regulatory element as much as possible, as architecture is defined by the relationships between components. The core of such an experiment must be a precise replacement of the element of interest (the enhancer) at its endogenous genomic locus, minimizing all other perturbations. The readouts must be sensitive enough to detect subtle, spatially-defined changes in gene expression, which is the key function of Hox gene enhancers.\n\n**Analysis of Option A**\nThis option proposes a scarless replacement of a *Drosophila* Hox enhancer with its mouse ortholog at the endogenous locus using CRISPR-associated protein 9 (Cas9) and homology-directed repair (HDR).\n- **`endogenous locus` replacement**: This is the most crucial feature. It directly tests the enhancer's function within its native chromatin environment, including its interaction with the correct promoter, insulators, and 3D contacts within the Topologically Associating Domain (TAD). This methodology correctly addresses criteria to avoid position effects and respect local chromatin topology.\n- **`scarless` replacement and preservation of `orientation` and `distance`**: These details demonstrate a high level of experimental rigor, ensuring that the only variable is the enhancer sequence itself, not artifacts of the editing process or changes in genome geometry.\n- **`reciprocal swap`**: Performing the experiment in both host organisms (*Drosophila* and mouse) provides the strongest possible evidence for conserved function.\n- **Readouts**: The use of single-molecule RNA fluorescence in situ hybridization (smFISH or RNA-FISH) provides the necessary quantitative and spatially resolved expression data (criterion $4$). Chromatin Immunoprecipitation followed by sequencing (ChIP-seq) directly probes the mechanism—whether host transcription factors bind the foreign enhancer. Phenotypic rescue assesses function at the organismal level. This is a multi-layered, comprehensive approach.\n- **Controls**: The inclusion of a species-matched positive control, a non-orthologous negative control, and a scrambled sequence negative control is exemplary. This allows for unambiguous attribution of any observed function to the specific, conserved regulatory information in the orthologous enhancer.\n- **Predictions**: The predictions are specific, quantitative (e.g., expression domain boundaries within $10\\%$), and mechanistically grounded, reflecting a clear hypothesis.\n**Verdict:** **Correct**. This option describes the \"gold standard\" experiment that satisfies all criteria for rigor, precision, and comprehensive analysis stated in the problem.\n\n**Analysis of Option B**\nThis option proposes generating transgenic *Drosophila* with a plasmid carrying the mouse enhancer and a reporter gene, inserted randomly.\n- **`random genomic location`**: This is a fundamental flaw. It completely fails to test the enhancer in its native architectural context. The expression will be subject to \"position effects\" from the surrounding chromatin at the insertion site, making the results uninterpretable with respect to the original Hox locus.\n- **`multicopy plasmid`**: This introduces gene dosage artifacts, another serious confounder.\n- **`heterologous minimal promoter`**: This decouples the enhancer from its native cognate promoter, failing to test a potentially conserved aspect of the regulatory architecture.\n- **`bulk RNA sequencing`**: This readout is not spatially resolved and is therefore inadequate for assessing the primary function of Hox enhancers, which is to create precise spatial patterns of expression.\n- **Conclusion logic**: Concluding conservation based on \"any axial domain\" expression is an unacceptably low standard of evidence.\n**Verdict:** **Incorrect**. This design is primitive and suffers from multiple, disqualifying flaws.\n\n**Analysis of Option C**\nThis option proposes replacing the *Drosophila* Hox *coding sequence* (the protein-coding part of the gene) with the mouse ortholog.\n- **Target of manipulation**: This experiment tests the functional conservation of the Hox *protein*, not the cis-regulatory architecture (the enhancers). The question explicitly asks to test the *regulatory architecture*. Therefore, this experiment, while potentially interesting for other reasons, does not address the question posed.\n- **Logical error**: The conclusion that regulatory architecture is conserved is a non-sequitur. The experiment provides no information about enhancer function.\n**Verdict:** **Incorrect**. This option fundamentally misunderstands the distinction between cis-regulatory elements and protein-coding genes and fails to test the specified hypothesis.\n\n**Analysis of Option D**\nThis option proposes inserting the mouse enhancer at a \"safe-harbor\" site while deleting the endogenous enhancer.\n- **`safe-harbor site`**: Although an improvement over a random insertion, this still removes the enhancer from its native TAD and its correct proximity and orientation to the target promoter. It fails to test the enhancer's function as part of the endogenous architecture, thus violating criterion $3$. The three-dimensional looping and interactions that define the architecture are lost.\n- **Readout**: The use of bulk quantitative polymerase chain reaction (qPCR) is, like bulk RNA-seq, spatially blind. It cannot measure the precision of expression domains, which is the critical functional output. Measuring total mRNA levels is a crude proxy that misses the essential biological function.\n- **Interpretation**: A $2$-fold change in total mRNA is a simplistic metric that ignores all spatial information and would not constitute a rigorous demonstration of conserved patterning function.\n**Verdict:** **Incorrect**. This design fails to test the enhancer in its proper context and uses an inadequate measurement technique.\n\n**Analysis of Option E**\nThis option proposes a cross-kingdom swap, replacing a *Drosophila* Hox enhancer with a plant *KNOX* gene enhancer.\n- **Scientific premise**: This is scientifically unsound. While *KNOX* and *Hox* genes both involve homeodomains, plants (Plantae) and animals (Animalia) have been evolving independently for over a billion years. Their transcriptional regulatory networks, including the transcription factors and the DNA sequence motifs they bind, are not conserved. Such an experiment is not a test of \"deep homology\" as the term is meaningfully used for animal phyla, but rather a speculation based on a superficial analogy. There is no a priori reason to expect functional compatibility.\n- **Experimental rigor**: The criterion for success, \"any change in Drosophila Hox expression,\" is vague and uninformative. A disruption of expression is the most likely outcome, and it proves nothing about conservation.\n- **Conclusion**: The conclusion that this would render animal-animal comparisons unnecessary is illogical and contrary to all established principles of evolutionary biology.\n**Verdict:** **Incorrect**. This option is based on a flawed scientific premise and represents a poorly conceived experiment.\n\nIn summary, Option A is the only one that describes a scientifically rigorous, methodologically sound, and comprehensive experiment that directly addresses the question of conserved regulatory architecture, meeting all the specified criteria.", "answer": "$$\\boxed{A}$$", "id": "2564636"}, {"introduction": "While the previous exercises focused on analyzing a known module or component, a key task in comparative genomics is the discovery of new candidate deep homologous modules from large datasets. This practice puts you in the role of a computational biologist, asking you to design and implement an algorithm that sifts through a gene regulatory network annotated with phylogenetic information. Your goal is to systematically identify conserved subgraphs, providing a powerful, hypothesis-generating tool that bridges the gap between comparative data and experimental validation. [@problem_id:2564709]", "problem": "A gene regulatory network is modeled as a directed graph $G = (V,E)$ over a finite taxa set $T$. Each node $v \\in V$ is annotated with a taxa-presence set $P_V(v) \\subseteq T$ indicating the taxa in which an orthologous gene is present. Each directed edge $e = (u \\rightarrow w) \\in E$ is annotated with a taxa-presence set $P_E(e) \\subseteq T$ indicating the taxa in which that regulatory interaction is present. For any node subset $V_H \\subseteq V$, define the induced subgraph $H = (V_H, E_H)$ where $E_H = \\{ (u \\rightarrow w) \\in E \\mid u \\in V_H, w \\in V_H \\}$. Define the support of a subgraph $H$ as\n$$\n\\mathrm{supp}(H) = \\left( \\bigcap_{v \\in V_H} P_V(v) \\right) \\cap \\left( \\bigcap_{e \\in E_H} P_E(e) \\right),\n$$\nwith the convention that $\\bigcap \\emptyset = T$. A subgraph $H$ is $k$-conserved if $|\\mathrm{supp}(H)| \\ge k$. A subgraph $H$ is connected if its underlying undirected graph is connected. A $k$-conserved module is a connected induced subgraph that is $k$-conserved. A $k$-conserved module is maximal if no node $x \\in V \\setminus V_H$ can be added to form the induced subgraph on $V_H \\cup \\{x\\}$ that remains $k$-conserved.\n\nUsing the fundamental anti-monotonicity of set intersection cardinality, namely that for any family of sets $\\{A_i\\}_{i=1}^m$ and any additional set $B$, it holds that $|\\bigcap_{i=1}^m A_i \\cap B| \\le |\\bigcap_{i=1}^m A_i|$, design and implement a deterministic lexicographic-greedy algorithm to enumerate candidate deep-homologous modules as follows:\n\n- For each seed node $s \\in V$ with $|P_V(s)| \\ge k$, initialize $V_H \\leftarrow \\{s\\}$.\n- Repeatedly attempt to add one node at a time from the set of candidate neighbors $C = \\{ x \\in V \\setminus V_H \\mid \\exists v \\in V_H \\text{ with } (x \\rightarrow v) \\in E \\text{ or } (v \\rightarrow x) \\in E \\}$, scanning nodes in strictly increasing order of their integer identifiers. For a candidate $x \\in C$, let $V_H' = V_H \\cup \\{x\\}$ and $H' = (V_H', E_{H'})$ be the induced subgraph. If $|\\mathrm{supp}(H')| \\ge k$, accept the addition by setting $V_H \\leftarrow V_H'$ and restart scanning from the smallest identifier in the updated candidate set. If no candidate node can be added without violating the threshold, stop; the final induced subgraph on $V_H$ is the module derived from seed $s$.\n- After processing all seeds, deduplicate modules by their node sets to obtain the set of distinct maximal modules produced by this lexicographic-greedy procedure.\n\nImplement this exact algorithm and apply it to the following test suite. Each test case provides $T$, $V$, $E$ (with presence sets), and $k$. Node identifiers are nonnegative integers. Presence sets are specified by taxa names. The underlying undirected connectivity criterion must be used to test connectedness during the greedy additions as defined by the candidate neighbor construction. The output for each test case is the total number of distinct maximal $k$-conserved modules produced by the algorithm. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[1,2,3]\").\n\nTest Suite:\n\n- Case $1$ (happy path):\n  - $T = \\{\\mathrm{A}, \\mathrm{B}, \\mathrm{C}, \\mathrm{D}\\}$.\n  - $V = \\{0,1,2,3,4,5\\}$ with node presence:\n    - $P_V(0) = \\{\\mathrm{A},\\mathrm{B},\\mathrm{C},\\mathrm{D}\\}$,\n    - $P_V(1) = \\{\\mathrm{A},\\mathrm{B},\\mathrm{C}\\}$,\n    - $P_V(2) = \\{\\mathrm{A},\\mathrm{C},\\mathrm{D}\\}$,\n    - $P_V(3) = \\{\\mathrm{B},\\mathrm{C}\\}$,\n    - $P_V(4) = \\{\\mathrm{A},\\mathrm{D}\\}$,\n    - $P_V(5) = \\{\\mathrm{C},\\mathrm{D}\\}$.\n  - Directed edges with presence:\n    - $(0 \\rightarrow 1): \\{\\mathrm{A},\\mathrm{B},\\mathrm{C}\\}$,\n    - $(1 \\rightarrow 2): \\{\\mathrm{A},\\mathrm{C}\\}$,\n    - $(2 \\rightarrow 3): \\{\\mathrm{C}\\}$,\n    - $(0 \\rightarrow 4): \\{\\mathrm{A},\\mathrm{D}\\}$,\n    - $(4 \\rightarrow 2): \\{\\mathrm{A},\\mathrm{D}\\}$,\n    - $(5 \\rightarrow 2): \\{\\mathrm{C},\\mathrm{D}\\}$,\n    - $(3 \\rightarrow 5): \\{\\mathrm{C}\\}$,\n    - $(1 \\rightarrow 3): \\{\\mathrm{B},\\mathrm{C}\\}$,\n    - $(4 \\rightarrow 5): \\{\\mathrm{D}\\}$.\n  - Threshold $k = 2$.\n\n- Case $2$ (boundary on conservation stringency):\n  - Same $T$, $V$, and $E$ as Case $1$.\n  - Threshold $k = 3$.\n\n- Case $3$ (edge case with only a singleton module):\n  - $T = \\{\\mathrm{A}, \\mathrm{B}\\}$.\n  - $V = \\{0,1,2\\}$ with node presence:\n    - $P_V(0) = \\{\\mathrm{A},\\mathrm{B}\\}$,\n    - $P_V(1) = \\{\\mathrm{A}\\}$,\n    - $P_V(2) = \\{\\mathrm{B}\\}$.\n  - Directed edges with presence:\n    - $(0 \\rightarrow 1): \\{\\mathrm{A}\\}$,\n    - $(0 \\rightarrow 2): \\{\\mathrm{B}\\}$.\n  - Threshold $k = 2$.\n\nYour program must compute, for each test case, the number of distinct maximal $k$-conserved modules found by the specified algorithm, and print a single line containing these three integers in order as a comma-separated list enclosed in square brackets.", "solution": "The problem statement has been rigorously analyzed and is deemed valid. It is scientifically grounded in the domain of computational systems biology, specifically concerning the identification of conserved gene regulatory modules. The problem is mathematically well-posed, providing unambiguous definitions for all components—the graph model, node and edge annotations, the support metric $\\mathrm{supp}(H)$, and the property of being a $k$-conserved module. All necessary data and constraints for the test cases are provided, forming a self-contained and solvable computational task. The specified algorithm is deterministic, ensuring a unique solution.\n\nThe task is to implement a specific lexicographic-greedy algorithm for identifying candidate deep-homologous modules in a gene regulatory network. The fundamental principle underpinning this greedy approach is the anti-monotonicity of set intersection cardinality. For a family of sets $\\{A_i\\}$, the cardinality of their intersection cannot increase when a new set $B$ is added to the intersection: $|\\bigcap A_i \\cap B| \\le |\\bigcap A_i|$. In the context of the problem, the support of a subgraph $H'$, $\\mathrm{supp}(H')$, is the intersection of presence sets of its nodes and edges. If we extend a subgraph $H$ to a larger subgraph $H''$ by adding nodes or edges, the support of $H''$ is an intersection over a larger collection of sets. Consequently, $\\mathrm{supp}(H'') \\subseteq \\mathrm{supp}(H)$, which implies $|\\mathrm{supp}(H'')| \\le |\\mathrm{supp}(H)|$. This property ensures that if a potential subgraph formed by adding a new node fails the $k$-conservation test (i.e., its support is too small), no further expansion of that subgraph can ever satisfy the criterion. This validates the greedy strategy of terminating an expansion path once the conservation threshold is violated.\n\nThe algorithm will be implemented following these structured steps:\n\n1.  **Data Representation**: The taxa set $T$ and all presence sets ($P_V(v)$ for nodes $v \\in V$ and $P_E(e)$ for edges $e \\in E$) will be represented as `set` objects in Python for efficient intersection operations. The graph $G=(V, E)$ will be stored using an adjacency structure that allows efficient lookup of all neighbors of a node (both incoming and outgoing), as required for identifying candidate nodes for module expansion.\n\n2.  **Seed Identification**: The algorithm initiates a search process from each \"seed\" node. A node $s \\in V$ is a valid seed if it forms a $k$-conserved module by itself. A single-node induced subgraph $H_s$ on $V_H=\\{s\\}$ has an empty edge set $E_H=\\emptyset$. By the convention that an empty intersection yields the universal set $T$, the support is $\\mathrm{supp}(H_s) = P_V(s) \\cap T = P_V(s)$. Thus, a node $s$ is a valid seed if and only if $|P_V(s)| \\ge k$. All such seed nodes will be identified and processed in increasing order of their integer identifiers to ensure deterministic behavior, though the problem does not mandate a specific order for processing seeds.\n\n3.  **Greedy Module Expansion**: For each seed node $s$, a module is grown iteratively.\n    - **Initialization**: The module is initialized with the node set $V_H = \\{s\\}$, and its support is `supp_H` $= P_V(s)$.\n    - **Iteration**: The algorithm enters a loop that continues as long as the module can be expanded. In each iteration, it identifies a set of candidate nodes $C$. A node $x \\in V \\setminus V_H$ is a candidate if it is adjacent to at least one node currently in the module $V_H$. This construction ensures that the resulting module remains connected.\n    - **Candidate Evaluation**: The candidates in $C$ are evaluated in strictly increasing lexicographical order of their integer identifiers. For each candidate $x$, a prospective new module $H'$ on the vertex set $V'_H = V_H \\cup \\{x\\}$ is considered. Its support is calculated efficiently by taking the current module's support, `supp_H`, and intersecting it with the presence set of the new node, $P_V(x)$, and the presence sets of all newly induced edges. These new edges are those connecting $x$ to nodes already in $V_H$.\n    - **Acceptance and Restart**: If the support of the prospective module, $|\\mathrm{supp}(H')|$, is greater than or equal to the threshold $k$, the candidate $x$ is accepted. The module is updated ($V_H \\leftarrow V'_H$, `supp_H` $\\leftarrow \\mathrm{supp}(H')$), and the candidate evaluation loop is immediately restarted with the new, larger module. This \"first-fit\" greedy choice is key to the algorithm's definition.\n    - **Termination**: If a full pass through all sorted candidates yields no node that can be added without violating the $k$-conservation criterion, the expansion loop for the current seed terminates. The resulting module $V_H$ is considered maximal as per the algorithm's definition.\n\n4.  **Deduplication and Final Count**: The set of nodes for each generated module is stored. Since different seeds may lead to the same final module, these sets are stored in a manner that allows for automatic deduplication, for instance, by adding `frozenset` representations of the node sets to a master `set`. The final result for each test case is the total count of unique modules found.\n\nThis detailed, principle-based design will be translated into a Python program that precisely adheres to the specified logic and data, thereby guaranteeing a correct solution to the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define, run, and print results for all test cases.\n    \"\"\"\n    \n    # Test Case 1\n    case1 = {\n        \"T\": {\"A\", \"B\", \"C\", \"D\"},\n        \"V\": list(range(6)),\n        \"P_V\": [\n            {\"A\", \"B\", \"C\", \"D\"},  # Node 0\n            {\"A\", \"B\", \"C\"},      # Node 1\n            {\"A\", \"C\", \"D\"},      # Node 2\n            {\"B\", \"C\"},           # Node 3\n            {\"A\", \"D\"},           # Node 4\n            {\"C\", \"D\"},           # Node 5\n        ],\n        \"E\": {\n            (0, 1): {\"A\", \"B\", \"C\"},\n            (1, 2): {\"A\", \"C\"},\n            (2, 3): {\"C\"},\n            (0, 4): {\"A\", \"D\"},\n            (4, 2): {\"A\", \"D\"},\n            (5, 2): {\"C\", \"D\"},\n            (3, 5): {\"C\"},\n            (1, 3): {\"B\", \"C\"},\n            (4, 5): {\"D\"},\n        },\n        \"k\": 2,\n    }\n\n    # Test Case 2\n    case2 = {\n        \"T\": case1[\"T\"],\n        \"V\": case1[\"V\"],\n        \"P_V\": case1[\"P_V\"],\n        \"E\": case1[\"E\"],\n        \"k\": 3,\n    }\n\n    # Test Case 3\n    case3 = {\n        \"T\": {\"A\", \"B\"},\n        \"V\": list(range(3)),\n        \"P_V\": [\n            {\"A\", \"B\"},  # Node 0\n            {\"A\"},      # Node 1\n            {\"B\"},      # Node 2\n        ],\n        \"E\": {\n            (0, 1): {\"A\"},\n            (0, 2): {\"B\"},\n        },\n        \"k\": 2,\n    }\n\n    test_cases = [case1, case2, case3]\n    results = []\n\n    for case in test_cases:\n        result = find_modules(case[\"T\"], case[\"V\"], case[\"P_V\"], case[\"E\"], case[\"k\"])\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef find_modules(T, V_ids, P_V, E, k):\n    \"\"\"\n    Implements the specified lexicographic-greedy algorithm to find k-conserved modules.\n    \n    Args:\n        T (set): The set of all taxa.\n        V_ids (list): A list of integer node identifiers.\n        P_V (list): A list where P_V[i] is the presence set for node i.\n        E (dict): A dictionary where keys are edge tuples (u, v) and values are presence sets.\n        k (int): The conservation threshold.\n    \n    Returns:\n        int: The number of distinct maximal k-conserved modules found.\n    \"\"\"\n    \n    all_neighbors = {v: set() for v in V_ids}\n    for u, w in E:\n        all_neighbors[u].add(w)\n        all_neighbors[w].add(u)\n\n    found_modules = set()\n\n    seed_nodes = sorted([v for v in V_ids if len(P_V[v]) >= k])\n\n    for seed in seed_nodes:\n        V_H = {seed}\n        current_support = P_V[seed]\n\n        while True:\n            added_node_in_iteration = False\n            \n            candidate_neighbors = set()\n            for node in V_H:\n                candidate_neighbors.update(all_neighbors[node])\n            candidate_neighbors -= V_H\n            \n            sorted_candidates = sorted(list(candidate_neighbors))\n            \n            for candidate in sorted_candidates:\n                # Calculate the support for the potential new module\n                potential_support = current_support  P_V[candidate]\n                \n                # If potential support is already too small, no need to check edges\n                if len(potential_support)  k:\n                    continue\n\n                for node_in_module in V_H:\n                    if (node_in_module, candidate) in E:\n                        potential_support = E[(node_in_module, candidate)]\n                    if (candidate, node_in_module) in E:\n                        potential_support = E[(candidate, node_in_module)]\n                \n                if len(potential_support) >= k:\n                    V_H.add(candidate)\n                    current_support = potential_support\n                    added_node_in_iteration = True\n                    break  # Restart candidate search with the new_V_H\n            \n            if not added_node_in_iteration:\n                break  # Module is maximal for this seed, stop expansion\n\n        found_modules.add(frozenset(V_H))\n\n    return len(found_modules)\n\nsolve()\n```", "id": "2564709"}]}