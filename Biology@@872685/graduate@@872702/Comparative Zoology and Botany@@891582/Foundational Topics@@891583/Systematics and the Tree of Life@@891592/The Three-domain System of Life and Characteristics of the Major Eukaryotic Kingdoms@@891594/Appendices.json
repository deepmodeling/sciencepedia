{"hands_on_practices": [{"introduction": "The ability to reconstruct evolutionary history from molecular data is a cornerstone of modern biology. This exercise guides you through a foundational method, transforming raw sequence differences into a phylogenetic tree. By applying the Jukes-Cantor correction and the Neighbor-Joining algorithm [@problem_id:2618756], you will practice the essential steps of translating genetic distance into a hypothesis of evolutionary relationships, a key skill for interpreting data within the three-domain framework.", "problem": "A laboratory has estimated uncorrected pairwise proportion-of-difference distances ($p$-distances) among six taxa based on conserved ribosomal RNA sequence alignments: three archaeal taxa ($A_1$, $A_2$, $A_3$), two bacterial taxa ($B_1$, $B_2$), and one eukaryotic taxon ($E_1$). Assume site independence, stationarity, and time-reversibility of substitutions. Use the following uncorrected $p$-distances (all pairwise distances not listed are determined by symmetry and zero self-distance):\n\n- Within Archaea: $p(A_i,A_j)=0.10$ for all distinct $i,j \\in \\{1,2,3\\}$.\n- Within Bacteria: $p(B_1,B_2)=0.08$.\n- Archaea–Bacteria: $p(A_i,B_j)=0.24$ for all $i \\in \\{1,2,3\\}$ and $j \\in \\{1,2\\}$.\n- Archaea–Eukarya: $p(A_i,E_1)=0.15$ for all $i \\in \\{1,2,3\\}$.\n- Bacteria–Eukarya: $p(B_j,E_1)=0.30$ for all $j \\in \\{1,2\\}$.\n\nTask:\n\n1) Apply the Jukes–Cantor $1969$ (JC69) correction to each $p$-distance to obtain a corrected distance matrix $\\{D_{ij}\\}$ suitable for distance-based phylogenetic inference.\n\n2) Using $\\{D_{ij}\\}$, infer a neighbor-joining (NJ) tree with estimated branch lengths. Base your steps on first principles for distance corrections under a continuous-time, homogeneous, memoryless substitution process and on the neighbor-joining criterion that minimizes total tree length by iteratively joining pairs according to the standard $Q$-matrix rule.\n\n3) From your inferred NJ tree, compute the total tree length $L_{\\mathrm{total}}$ as the sum of all branch lengths (in substitutions per site). Report $L_{\\mathrm{total}}$ in substitutions per site, rounded to four significant figures.\n\nAnswer form: Provide a single real-valued number for $L_{\\mathrm{total}}$, rounded to four significant figures. Express the number in substitutions per site. Do not include any units or symbols in your final boxed answer.", "solution": "The problem requires the inference of a phylogenetic tree using the neighbor-joining (NJ) algorithm on a set of Jukes-Cantor corrected distances, and the calculation of the total tree length. The analysis will be conducted with rigor, following the specified methods without deviation.\n\nStep 1: Problem Validation\nThe provided problem statement is self-contained, scientifically grounded in established principles of molecular phylogenetics (p-distances, Jukes-Cantor model, neighbor-joining algorithm), and is objectively formulated. The givens consist of a set of uncorrected pairwise distances ($p$) among six taxa: three Archaea ($A_1, A_2, A_3$), two Bacteria ($B_1, B_2$), and one Eukaryote ($E_1$). The provided $p$-distances are all less than $\\frac{3}{4}$, the theoretical limit for the Jukes-Cantor (JC69) correction, thus ensuring the distances are mathematically well-defined. The problem is valid. We proceed to the solution.\n\nStep 2: Jukes-Cantor (JC69) Correction\nThe first task is to convert the uncorrected proportion-of-difference distances ($p$) into corrected genetic distances ($D$). The JC69 model assumes equal base frequencies and equal substitution rates. The corrected distance, representing the expected number of substitutions per site, is given by the formula:\n$$D = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p\\right)$$\nWe apply this correction to each given $p$-distance.\n\n1.  Within Archaea: $p(A_i, A_j) = 0.10$.\n    $$D_{A_i, A_j} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.10\\right) = -\\frac{3}{4} \\ln\\left(\\frac{2.6}{3}\\right) \\approx 0.1073315$$\n2.  Within Bacteria: $p(B_1, B_2) = 0.08$.\n    $$D_{B_1, B_2} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.08\\right) = -\\frac{3}{4} \\ln\\left(\\frac{2.68}{3}\\right) \\approx 0.0846060$$\n3.  Archaea–Bacteria: $p(A_i, B_j) = 0.24$.\n    $$D_{A_i, B_j} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.24\\right) = -\\frac{3}{4} \\ln\\left(1 - 0.32\\right) = -\\frac{3}{4} \\ln(0.68) \\approx 0.2892602$$\n4.  Archaea–Eukarya: $p(A_i, E_1) = 0.15$.\n    $$D_{A_i, E_1} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.15\\right) = -\\frac{3}{4} \\ln\\left(1 - 0.20\\right) = -\\frac{3}{4} \\ln(0.80) \\approx 0.1673590$$\n5.  Bacteria–Eukarya: $p(B_j, E_1) = 0.30$.\n    $$D_{B_j, E_1} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.30\\right) = -\\frac{3}{4} \\ln\\left(1 - 0.40\\right) = -\\frac{3}{4} \\ln(0.60) \\approx 0.3831034$$\n\nThis yields the initial symmetric distance matrix $\\{D_{ij}\\}$ for the set of $N=6$ taxa $T = \\{A_1, A_2, A_3, B_1, B_2, E_1\\}$.\n\nStep 3: Neighbor-Joining (NJ) Algorithm\n\nThe NJ algorithm is an iterative process that joins pairs of taxa to minimize total tree length. At each step, for a set of $n$ current taxa, we compute the $Q$-matrix:\n$$Q_{ij} = (n-2)D_{ij} - \\sum_{k=1}^{n} D_{ik} - \\sum_{k=1}^{n} D_{jk}$$\nThe pair $(i, j)$ that minimizes $Q_{ij}$ is joined into a new node.\n\n**Iteration 1: $n=6$**\nFirst, we compute the sum of distances from each taxon to all others, $S_i = \\sum_{k \\in T} D_{ik}$. Due to symmetry:\n$S_A = S_{A_1} = S_{A_2} = S_{A_3} = 2 \\times D_{A_i,A_j} + 2 \\times D_{A_i,B_j} + D_{A_i,E_1} \\approx 2(0.10733) + 2(0.28926) + 0.16736 = 0.96054$\n$S_B = S_{B_1} = S_{B_2} = 3 \\times D_{A_i,B_j} + D_{B_1,B_2} + D_{B_j,E_1} \\approx 3(0.28926) + 0.08461 + 0.38310 = 1.33549$\n$S_E = S_{E_1} = 3 \\times D_{A_i,E_1} + 2 \\times D_{B_j,E_1} \\approx 3(0.16736) + 2(0.38310) = 1.26828$\n\nWe find the minimum of $Q_{ij} = 4D_{ij} - S_i - S_j$:\n$Q_{A_1,A_2} = 4(0.10733) - 2(0.96054) = -1.49202$\n$Q_{B_1,B_2} = 4(0.08461) - 2(1.33549) = -2.33254$\n$Q_{A_1,E_1} = 4(0.16736) - 0.96054 - 1.26828 = -1.55938$\n$Q_{A_1,B_1} = 4(0.28926) - 0.96054 - 1.33549 = -1.13899$\n$Q_{B_1,E_1} = 4(0.38310) - 1.33549 - 1.26828 = -1.07137$\n\nThe minimum is $Q_{B_1, B_2}$. We join $B_1$ and $B_2$ into a new node $U_1$. The branch lengths from $U_1$ to its descendants are:\n$L(B_1, U_1) = \\frac{1}{2} D_{B_1,B_2} + \\frac{1}{2(n-2)}(S_{B_1} - S_{B_2}) = \\frac{1}{2} D_{B_1,B_2} \\approx \\frac{0.084606}{2} = 0.042303$\n$L(B_2, U_1) = D_{B_1,B_2} - L(B_1, U_1) = 0.042303$\n\n**Iteration 2: $n=5$**\nThe new set of taxa is $T' = \\{A_1, A_2, A_3, E_1, U_1\\}$. We compute new distances to $U_1$:\n$D(k, U_1) = \\frac{1}{2}(D(k, B_1) + D(k, B_2) - D_{B_1,B_2})$\n$D(A_i, U_1) = \\frac{1}{2}(2 \\times 0.2892602 - 0.0846060) = 0.2469572$\n$D(E_1, U_1) = \\frac{1}{2}(2 \\times 0.3831034 - 0.0846060) = 0.3408004$\n\nWith the new distance matrix for $T'$, we re-calculate sums $S'_i$ and the $Q$-matrix for $n=5$. The minimum $Q_{ij}$ value reveals a tie between any pair $(A_i, E_1)$ and $(A_i, U_1)$. We break the tie by choosing the pair with the smaller distance: $D(A_i, E_1) \\approx 0.16736$ is smaller than $D(A_i, U_1) \\approx 0.24696$. We join $A_1$ and $E_1$ into a new node $U_2$.\nBranch lengths are calculated using the sums $S'_A \\approx 0.62898$ and $S'_E \\approx 0.84288$:\n$L(A_1, U_2) = \\frac{1}{2}D_{A_1,E_1} + \\frac{1}{2(n-2)}(S'_A - S'_E) \\approx \\frac{0.167359}{2} + \\frac{0.62898 - 0.84288}{6} \\approx 0.048030$\n$L(E_1, U_2) = D_{A_1,E_1} - L(A_1, U_2) \\approx 0.167359 - 0.048030 = 0.119329$\n\n**Iteration 3: $n=4$**\nTaxa: $T'' = \\{A_2, A_3, U_1, U_2\\}$. New distances to $U_2$:\n$D(A_2, U_2) = \\frac{1}{2}(D_{A_2,A_1} + D_{A_2,E_1} - D_{A_1,E_1}) = \\frac{1}{2}D_{A_1,A_2} \\approx 0.053666$\n$D(A_3, U_2) = D(A_2, U_2)$\n$D(U_1, U_2) = \\frac{1}{2}(D_{U_1,A_1} + D_{U_1,E_1} - D_{A_1,E_1}) \\approx \\frac{1}{2}(0.24696+0.34080-0.16736) = 0.21020$\nAgain, we compute the $Q$-matrix. The minimum is a tie. Applying the tie-break rule (smallest distance, $D(A_2, U_2)$), we join $A_2$ and $U_2$ into a new node $U_3$. Calculation of branch lengths gives:\n$L(A_2, U_3) \\approx 0.049439$\n$L(U_2, U_3) = D_{A_2,U_2} - L(A_2, U_3) \\approx 0.053666 - 0.049439 = 0.004227$\n\n**Iteration 4: $n=3$**\nThe final set of taxa is $\\{A_3, U_1, U_3\\}$. For $n=3$, the algorithm terminates by joining the three remaining nodes to a central node $U_C$. The three terminal branch lengths are calculated as:\n$L(i, U_C) = \\frac{1}{2}(D_{ij} + D_{ik} - D_{jk})$\nThe necessary distances are: $D(A_3, U_1) \\approx 0.24696$; $D(A_3, U_3) \\approx D_{A_1,A_2}/2 = 0.053666$; and $D(U_1, U_3) \\approx 0.20175$.\n$L(A_3, U_C) = \\frac{1}{2}(0.24696 + 0.053666 - 0.20175) \\approx 0.049438$\n$L(U_1, U_C) = \\frac{1}{2}(0.24696 + 0.20175 - 0.053666) \\approx 0.19752$\n$L(U_3, U_C) = \\frac{1}{2}(0.053666 + 0.20175 - 0.24696) \\approx 0.004228$\n\nStep 4: Total Tree Length Calculation\nThe total tree length, $L_{\\mathrm{total}}$, is the sum of all $2n-3 = 2(6)-3=9$ branch lengths in the unrooted tree.\nThe branches are:\n1.  $L(B_1, U_1) \\approx 0.042303$\n2.  $L(B_2, U_1) \\approx 0.042303$\n3.  $L(A_1, U_2) \\approx 0.048030$\n4.  $L(E_1, U_2) \\approx 0.119329$\n5.  $L(A_2, U_3) \\approx 0.049439$\n6.  $L(A_3, U_C) \\approx 0.049438$\n7.  $L(U_2, U_3) \\approx 0.004227$ (internal branch)\n8.  $L(U_3, U_C) \\approx 0.004228$ (internal branch)\n9.  $L(U_1, U_C) \\approx 0.197522$ (internal branch)\n\nSumming these values:\n$L_{\\mathrm{total}} \\approx 2(0.042303) + (0.048030 + 0.119329) + 0.049439 + 0.049438 + 0.004227 + 0.004228 + 0.197522$\n$L_{\\mathrm{total}} \\approx 0.084606 + 0.167359 + 0.098877 + 0.008455 + 0.197522$\n$L_{\\mathrm{total}} \\approx 0.556819$\n\nRounding to four significant figures, the total tree length is $0.5568$ substitutions per site. The topology inferred is $((B_1,B_2):U_1, (A_3, (A_2, (A_1,E_1):U_2):U_3):U_C)$, which indicates that, based on these ribosomal RNA sequences, the Eukaryote taxon $E_1$ is nested within the Archaea, making the Archaea paraphyletic. This is a known biological hypothesis (the eocyte hypothesis).", "answer": "$$\\boxed{0.5568}$$", "id": "2618756"}, {"introduction": "The evolutionary history of an organism is not always perfectly mirrored by the history of its individual genes, a phenomenon particularly relevant when studying the deep splits between domains like Archaea and Bacteria. Horizontal Gene Transfer (HGT) can move genetic material between distant lineages, creating incongruence between gene and species trees. This practice challenges you to act as a phylogenetic detective, reconciling conflicting gene trees with a consensus species tree by identifying the minimum number of HGT events [@problem_id:2618693] required to explain the observed data.", "problem": "A comparative genomics study within the framework of the three-domain system of life (Archaea, Bacteria, Eukarya) focuses here on the two prokaryotic domains, Archaea and Bacteria, to quantify horizontal gene transfer (HGT) as a source of gene tree–species tree incongruence. You are given $3$ single-copy gene families sampled from $12$ prokaryotic taxa: six archaeal taxa (A1, A2, A3, A4, A5, A6) and six bacterial taxa (B1, B2, B3, B4, B5, B6). For each gene family, a rooted, fully resolved gene tree is inferred. The consensus species tree is rooted and consists of two unresolved (polytomous) sister clades, one containing all Archaea and the other all Bacteria; that is, the only enforced constraint is that all archaeal taxa must be monophyletic and all bacterial taxa must be monophyletic, consistent with the three-domain system’s separation of Archaea and Bacteria. Assume the following foundational constraints:\n- Each gene family is present as a single orthologous copy in every taxon (no gene duplication and no gene loss).\n- The only allowed source of incongruence relative to the species tree is horizontal gene transfer (HGT) between contemporaneous lineages.\n- Within-domain branching order in the species tree is unresolved, so no within-domain topology constraints need to be satisfied.\n\nThe rooted gene trees (Newick format, with the root implied by the outermost set of parentheses) are:\n- Gene family $G_1$: ((A1,(A2,(A3,A5))),((B1,(B2,(B3,B4))),(A4,(B5,B6))));\n- Gene family $G_2$: ((B5,(A1,(A3,(A4,(A5,A6))))),(((B1,B2),(B3,(B4,B6))),A2));\n- Gene family $G_3$: (((B1,(B2,B3)),(A1,(A2,(A3,A4)))),((B4,(B5,B6)),(A5,A6)));\n\nStarting from core definitions of species trees versus gene trees and the assumption of single-copy orthology, determine the minimal total number of horizontal gene transfer events required to reconcile all three gene trees simultaneously with the consensus species tree described above. Report your answer as a single integer with no units. If any rounding were needed, the instruction would be to round to a specified number of significant figures, but here no rounding is necessary.", "solution": "The task is to determine the minimum total number of horizontal gene transfer (HGT) events required to reconcile $3$ gene trees, denoted $G_1$, $G_2$, and $G_3$, with a specified consensus species tree. The analysis involves $12$ prokaryotic taxa, comprising six from domain Archaea ($A_1, A_2, A_3, A_4, A_5, A_6$) and six from domain Bacteria ($B_1, B_2, B_3, B_4, B_5, B_6$).\n\nThe fundamental constraint imposed by the species tree is the monophyly of Archaea and Bacteria. This means the species tree has a root that separates all archaeal taxa into one clade and all bacterial taxa into another sister clade. The internal branching order within each domain-specific clade is unresolved and thus irrelevant. A gene tree is congruent with this species tree if, and only if, its root also separates the set of all archaeal leaves from the set of all bacterial leaves.\n\nAccording to the problem statement, HGT is the sole mechanism responsible for any incongruence between a gene tree and the species tree. Gene duplication and loss are explicitly excluded. Therefore, any topological feature in a gene tree that violates the strict domain-level monophyly must be explained by invoking the minimum possible number of HGT events. An HGT event is required to explain the presence of a taxon or a clade from one domain nested within a clade of the other domain.\n\nWe will now analyze each of the $3$ gene trees to quantify the number of HGT events required for reconciliation.\n\nAnalysis of Gene Tree $G_1$:\nThe topology of gene tree $G_1$ is given in Newick format as `((A1,(A2,(A3,A5))),((B1,(B2,(B3,B4))),(A4,(B5,B6))));`.\nThe root of this tree splits the taxa into two main clades. The first clade, `(A1,(A2,(A3,A5)))`, is purely archaeal and thus congruent with the species tree.\nThe second main clade is `((B1,(B2,(B3,B4))),(A4,(B5,B6)))`. This clade is mixed. It contains the archaeal taxon $A_4$ along with all six bacterial taxa. Specifically, within this clade, the subclade `(A4,(B5,B6))` shows taxon $A_4$ as sister to the bacterial clade `(B5,B6)`. This implies that the gene in $A_4$ shares a more recent common ancestor with the genes in $B_5$ and $B_6$ than with the other archaeal genes in the sample. Such a topology is a definitive signature of HGT. To reconcile this tree, the lineage leading to the gene in $A_4$ must be moved out of the bacterial group. This \"prune and regraft\" operation corresponds to a single HGT event. After accounting for this one event, the remainder of the tree topology is consistent with the species tree.\nTherefore, the minimum number of HGT events for $G_1$ is $N_1 = 1$.\n\nAnalysis of Gene Tree $G_2$:\nThe topology of gene tree $G_2$ is `((B5,(A1,(A3,(A4,(A5,A6))))),(((B1,B2),(B3,(B4,B6))),A2));`.\nThe root of $G_2$ splits the taxa into two clades, both of which are mixed.\nThe first clade, `(B5,(A1,(A3,(A4,(A5,A6)))))`, consists of the bacterial taxon $B_5$ and an otherwise purely archaeal group `(A1,(A3,(A4,(A5,A6)))))`. The placement of $B_5$ as a sister taxon to a large archaeal clade is incongruent. It signifies an HGT event involving the $B_5$ lineage. This requires $1$ HGT event to resolve.\nThe second clade, `(((B1,B2),(B3,(B4,B6))),A2)`, consists of the archaeal taxon $A_2$ and an otherwise purely bacterial group `((B1,B2),(B3,(B4,B6)))`. The placement of $A_2$ as a sister taxon to this bacterial clade is also incongruent and requires a second, independent HGT event to resolve.\nSince these two incongruences occur in disjoint parts of the gene tree, they represent distinct events. The minimal reconciliation cost is the sum of the events required for each part.\nTherefore, the minimum number of HGT events for $G_2$ is $N_2 = 1 + 1 = 2$.\n\nAnalysis of Gene Tree $G_3$:\nThe topology of gene tree $G_3$ is `(((B1,(B2,B3)),(A1,(A2,(A3,A4)))),((B4,(B5,B6)),(A5,A6)));`.\nSimilar to $G_2$, the root of $G_3$ splits the taxa into two mixed clades.\nThe first clade is `((B1,(B2,B3)),(A1,(A2,(A3,A4))))`. This clade is composed of two pure subclades: a bacterial one, `(B1,(B2,B3))`, and an archaeal one, `(A1,(A2,(A3,A4)))`. The sister-group relationship between a purely bacterial clade and a purely archaeal clade is a direct violation of the species tree, which dictates that their last common ancestors are separated by the root of the tree of life. This topology is explained by an HGT event between the ancestral lineage of `{B1, B2, B3}` and the ancestral lineage of `{A1, A2, A3, A4}`. This accounts for $1$ HGT event.\nThe second clade, `((B4,(B5,B6)),(A5,A6))`, presents a perfectly analogous situation. It is composed of a purely bacterial subclade `(B4,(B5,B6))` and a purely archaeal subclade `(A5,A6)`. Their sister relationship requires another HGT event between their respective ancestral lineages.\nThese two HGT events are required to explain the structure of the two disjoint primary clades of the gene tree.\nTherefore, the minimum number of HGT events for $G_3$ is $N_3 = 1 + 1 = 2$.\n\nTotal Number of HGT Events:\nThe minimal total number of HGT events required to reconcile all three gene trees is the sum of the minimal numbers for each tree.\n$N_{total} = N_1 + N_2 + N_3 = 1 + 2 + 2 = 5$.", "answer": "$$\\boxed{5}$$", "id": "2618693"}, {"introduction": "While phylogenetic trees provide a static snapshot of evolutionary history, the underlying processes are dynamic and complex. This advanced practice moves from inference to simulation, challenging you to model the co-evolution of organisms from different domains (Bacteria and Fungi). By implementing and analyzing a system of differential equations [@problem_id:2618774], you will explore how ecological pressures, mutation, and Horizontal Gene Transfer interact to drive the spread of antibiotic resistance in a population.", "problem": "You will model a two-genotype bacterial population from Domain Bacteria interacting with a fungal population from Domain Eukarya via fungal antimicrobial secondary metabolite production. The goal is to derive, implement, and numerically solve a deterministic system in continuous time that captures the joint effects of density-regulated bacterial growth, antimicrobial-mediated mortality, mutation, and Horizontal Gene Transfer (HGT). Then, you will compute the final fraction of resistant bacteria at a specified final time for a small suite of parameter sets that exercise general behavior and edge cases. The setup intentionally excludes Domain Archaea to focus on the interdomain interaction between Bacteria and Fungi within the three-domain system.\n\nStart from the following foundational bases and definitions from population biology and microbial ecology:\n- Logistic growth for per-capita net birth rate due to resource limitation: if the scaled densities of two bacterial genotypes sum to $x(t) + y(t)$, the net density-dependent factor is $1 - (x(t) + y(t))$.\n- Mass-action kinetics for encounters and conversions: the flux of conversion events between two entities is proportional to the product of their densities.\n- Mutation modeled as a first-order process: conversion of one genotype to another occurs at a per-capita rate constant multiplied by the source density.\n- Fungal metabolite dynamics governed by production and decay: production at a constant rate by a fixed fungal biomass and first-order decay.\n\nLet $x(t)$ denote the scaled density of antibiotic-sensitive bacteria and $y(t)$ the scaled density of antibiotic-resistant bacteria, both scaled to a common carrying capacity so that $x(t), y(t) \\in [0,1]$. Let $A(t)$ denote the dimensionless concentration of fungal antimicrobial metabolite. The fungi are modeled implicitly via constant biomass that drives metabolite production.\n\nAssume:\n- Baseline bacterial Malthusian growth rate $r$ for sensitive bacteria.\n- Resistant bacteria pay a growth-rate cost $c$ so their baseline rate is $r(1 - c)$.\n- Baseline non-antimicrobial mortality $d_0$ applies to both genotypes.\n- Antimicrobial mortality scales linearly with concentration $A(t)$ with coefficient $k$ for sensitive bacteria; resistance reduces this mortality by a fractional efficacy $\\varepsilon \\in [0,1]$ for resistant bacteria, so their antimicrobial mortality coefficient is $(1 - \\varepsilon)k$.\n- Horizontal Gene Transfer (HGT) converts sensitive to resistant at mass-action rate $\\beta x(t)y(t)$.\n- Point mutation converts sensitive to resistant at per-capita rate $\\mu x(t)$, and resistant to sensitive at per-capita rate $\\nu y(t)$.\n- Fungal metabolite is produced at rate $pF$ by a fixed fungal biomass $F$, and decays at rate $d A(t)$.\n\nFrom these bases, derive the system\n\n$$\n\\begin{aligned}\n\\frac{dx}{dt} &= r x\\left(1 - (x+y)\\right) - d_0 x - k A x - \\beta x y - \\mu x + \\nu y, \\\\\n\\frac{dy}{dt} &= r (1 - c) y\\left(1 - (x+y)\\right) - d_0 y - (1 - \\varepsilon) k A y + \\beta x y + \\mu x - \\nu y, \\\\\n\\frac{dA}{dt} &= p F - d A.\n\\end{aligned}\n$$\n\nAll parameters are nonnegative, and $x(0) \\ge 0$, $y(0) \\ge 0$, $A(0) \\ge 0$. You may assume the system remains in the nonnegative orthant for the parameter values used below.\n\nYour task:\n- Implement a program that, for each parameter set in the test suite, integrates the above system from $t=0$ to $t=T$ numerically and returns the final resistant fraction\n\n$$\nf_R(T) = \\begin{cases}\n\\frac{y(T)}{x(T)+y(T)}, & \\text{if } x(T)+y(T) > 0,\\\\\n0, & \\text{if } x(T)+y(T) = 0.\n\\end{cases}\n$$\n\n- Use deterministic numerical integration with a reasonable method for stiff or nonstiff systems.\n- For each test case, round the resulting $f_R(T)$ to exactly $6$ decimal places using standard rounding to nearest, with halves rounded away from zero.\n- Aggregate all results into a single line of output as a comma-separated Python-style list, for example $[a,b,c]$, with no spaces.\n\nAngle units are not applicable. No physical units are required because the model is fully nondimensional.\n\nTest suite (each tuple is $(r, d_0, k, \\beta, \\mu, \\nu, c, \\varepsilon, p, d, F, x(0), y(0), A(0), T)$):\n- Case $1$ (general coexistence with HGT and mutation, moderate antimicrobial): $(1.0, 0.1, 1.0, 5.0, 1.0\\times 10^{-5}, 0.0, 0.05, 0.9, 0.5, 0.5, 1.0, 1.0\\times 10^{-6}, 1.0\\times 10^{-6}, 0.0, 50.0)$.\n- Case $2$ (boundary: no HGT, no mutation, no initial resistant bacteria): $(1.0, 0.1, 1.0, 0.0, 0.0, 0.0, 0.05, 0.9, 0.5, 0.5, 1.0, 1.0\\times 10^{-6}, 0.0, 0.0, 50.0)$.\n- Case $3$ (high antimicrobial pressure, moderate HGT, small mutation, higher resistance cost): $(1.0, 0.1, 1.0, 0.1, 1.0\\times 10^{-6}, 0.0, 0.3, 0.9, 1.0, 0.5, 2.0, 1.0\\times 10^{-6}, 1.0\\times 10^{-6}, 0.0, 100.0)$.\n- Case $4$ (low antimicrobial pressure, HGT present, small mutation, moderate cost): $(1.0, 0.1, 1.0, 1.0, 1.0\\times 10^{-6}, 0.0, 0.1, 0.9, 0.5, 0.5, 0.2, 1.0\\times 10^{-6}, 1.0\\times 10^{-6}, 0.0, 100.0)$.\n\nProgram requirements:\n- Implement the numerical solver and compute $f_R(T)$ for each case.\n- Output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[0.123456,0.000000,0.987654,0.111111]$).", "solution": "The problem as stated is subjected to rigorous validation and is determined to be valid. It is scientifically grounded, drawing upon foundational principles of microbial ecology and population genetics such as logistic growth, mass-action kinetics for Horizontal Gene Transfer (HGT), and first-order kinetics for mutation and mortality. The problem's context, contrasting Domain Bacteria with Domain Eukarya, is consistent with the established three-domain system of life. The formulation of the system of ordinary differential equations (ODEs),\n$$\n\\begin{aligned}\n\\frac{dx}{dt} &= r x\\left(1 - (x+y)\\right) - d_0 x - k A x - \\beta x y - \\mu x + \\nu y, \\\\\n\\frac{dy}{dt} &= r (1 - c) y\\left(1 - (x+y)\\right) - d_0 y - (1 - \\varepsilon) k A y + \\beta x y + \\mu x - \\nu y, \\\\\n\\frac{dA}{dt} &= p F - d A,\n\\end{aligned}\n$$\ncorrectly translates the described biological interactions into a mathematical model. The problem is well-posed, providing a complete set of initial conditions and parameters for each test case, which guarantees a unique solution to the initial value problem under the standard Picard-Lindelöf theorem for existence and uniqueness. The language used is objective and mathematically precise. We may therefore proceed with the solution.\n\nThe solution methodology involves the numerical integration of this system of ODEs for each specified parameter set. The procedure is as follows:\n\n$1$. System Representation: The three-dimensional state of the system is represented by a vector $\\mathbf{u}(t) = [x(t), y(t), A(t)]^T$. The dynamics are governed by the vector-valued function $\\frac{d\\mathbf{u}}{dt} = \\mathbf{f}(t, \\mathbf{u}, \\mathbf{p})$, where $\\mathbf{p}$ is the vector of parameters $(r, d_0, k, \\beta, \\mu, \\nu, c, \\varepsilon, p, d, F)$. A Python function is implemented to compute $\\mathbf{f}$ for a given state $\\mathbf{u}$ and time $t$.\n\n$2$. Numerical Integration: The SciPy library function `scipy.integrate.solve_ivp` is employed to solve the initial value problem. This function is a high-level wrapper for various modern ODE solvers. We select the `LSODA` method, which is an adaptive solver from the ODEPACK suite. It automatically detects whether the problem is stiff or non-stiff and switches between an Adams method (for non-stiff parts) and a Backward Differentiation Formula (BDF) method (for stiff parts). This robustness is suitable for ecological models that may exhibit dynamics across different time scales, for instance, fast population growth versus slow mutation.\n\n$3$. Execution for Test Cases: For each of the $4$ test cases provided, we define the initial state vector $\\mathbf{u}(0) = [x(0), y(0), A(0)]$ and the integration time interval $[0, T]$. The solver is then invoked with the option `t_eval=[T]` to efficiently compute the state vector $\\mathbf{u}(T) = [x(T), y(T), A(T)]$ precisely at the final time $T$.\n\n$4$. Calculation of Resistant Fraction: Upon obtaining the final state, the fraction of resistant bacteria, $f_R(T)$, is computed using the formula defined in the problem:\n$$\nf_R(T) = \\begin{cases}\n\\frac{y(T)}{x(T)+y(T)}, & \\text{if } x(T)+y(T) > 0,\\\\\n0, & \\text{if } x(T)+y(T) = 0.\n\\end{cases}\n$$\nThis conditional form is necessary to prevent division-by-zero errors in the case of total population extinction, a possibility in such models. The assumption that the system remains in the non-negative orthant ensures that $x(t) \\ge 0$ and $y(t) \\ge 0$.\n\n$5$. Output Formatting: As per the problem specification, the computed value of $f_R(T)$ must be rounded to exactly $6$ decimal places. Standard rounding functions in Python (`round()`) and NumPy (`numpy.round()`) implement \"round half to even,\" which contradicts the requirement of \"round halves away from zero.\" Therefore, a custom rounding implementation is used. For a non-negative value $v$ and a precision of $n$ decimal places, the rounding is achieved by computing $\\text{floor}(v \\times 10^n + 0.5) / 10^n$. The final results for all test cases are then formatted to $6$ decimal places and aggregated into a single comma-separated list enclosed in square brackets.\n\n```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve_and_format():\n    \"\"\"\n    Solves the given ODE system for microbial dynamics for a suite of test cases.\n    \"\"\"\n    # Test suite format:\n    # (r, d_0, k, beta, mu, nu, c, eps, p, d, F, x0, y0, A0, T)\n    test_cases = [\n        (1.0, 0.1, 1.0, 5.0, 1.0e-5, 0.0, 0.05, 0.9, 0.5, 0.5, 1.0, 1.0e-6, 1.0e-6, 0.0, 50.0),\n        (1.0, 0.1, 1.0, 0.0, 0.0, 0.0, 0.05, 0.9, 0.5, 0.5, 1.0, 1.0e-6, 0.0, 0.0, 50.0),\n        (1.0, 0.1, 1.0, 0.1, 1.0e-6, 0.0, 0.3, 0.9, 1.0, 0.5, 2.0, 1.0e-6, 1.0e-6, 0.0, 100.0),\n        (1.0, 0.1, 1.0, 1.0, 1.0e-6, 0.0, 0.1, 0.9, 0.5, 0.5, 0.2, 1.0e-6, 1.0e-6, 0.0, 100.0),\n    ]\n\n    results = []\n\n    def ode_system(t, u, r, d0, k, beta, mu, nu, c, eps, p, d, F):\n        \"\"\"\n        Defines the system of ordinary differential equations.\n        u = [x, y, A]\n        \"\"\"\n        x, y, A = u\n        \n        # To avoid numerical issues with very small negative values from solver steps\n        x = max(0, x)\n        y = max(0, y)\n\n        total_density = x + y\n        logistic_factor = 1.0 - total_density\n\n        dxdt = r * x * logistic_factor - d0 * x - k * A * x - beta * x * y - mu * x + nu * y\n        dydt = r * (1.0 - c) * y * logistic_factor - d0 * y - (1.0 - eps) * k * A * y + beta * x * y + mu * x - nu * y\n        dAdt = p * F - d * A\n\n        return [dxdt, dydt, dAdt]\n\n    for case in test_cases:\n        r, d0, k, beta, mu, nu, c, eps, p, d, F, x0, y0, A0, T = case\n        \n        u0 = [x0, y0, A0]\n        t_span = [0, T]\n        params = (r, d0, k, beta, mu, nu, c, eps, p, d, F)\n\n        sol = solve_ivp(\n            ode_system,\n            t_span,\n            u0,\n            args=params,\n            method='LSODA',\n            t_eval=[T],\n            atol=1e-9,\n            rtol=1e-9\n        )\n\n        xT, yT, _ = sol.y[:, 0]\n        \n        total_bacterial_density = xT + yT\n        \n        if total_bacterial_density > 1e-12:\n            fR_T = yT / total_bacterial_density\n        else:\n            fR_T = 0.0\n\n        # Round to 6 decimal places, with halves rounded away from zero.\n        rounded_fR_T = np.floor(fR_T * 1e6 + 0.5) / 1e6\n\n        results.append(rounded_fR_T)\n\n    # The problem asks for the list itself, not a printout of it.\n    # The final output will be constructed from these results.\n    return f\"[{','.join([f'{res:.6f}' for res in results])}]\"\n\n# The following is just for generating the answer string, not part of the required output.\n# final_answer_string = solve_and_format()\n# print(final_answer_string)\n# Result: [0.984534,0.000000,0.999997,0.370163]\n```", "answer": "[0.984534,0.000000,0.999997,0.370163]", "id": "2618774"}]}