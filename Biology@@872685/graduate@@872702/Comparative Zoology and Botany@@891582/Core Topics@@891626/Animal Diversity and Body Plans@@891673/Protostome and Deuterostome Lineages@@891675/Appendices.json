{"hands_on_practices": [{"introduction": "The classic distinction between protostome spiral cleavage and deuterostome radial cleavage originates in the orientation of the mitotic spindle in early blastomeres. This practice delves into the biophysical underpinnings of this process, moving beyond simple description to quantitative modeling [@problem_id:2606641]. By deriving the equilibrium spindle angle from first principles of cortical force generation and torque balance, you will gain a deeper, mechanistic understanding of how cellular geometry and cytoskeletal anisotropies conspire to produce these divergent developmental patterns.", "problem": "A single-cell embryo undergoes its first cleavage. In animals, cleavage orientation is constrained by cytoskeletal geometry at the blastomere cortex and by yolk distribution. Many protostome lineages exhibit spiral cleavage, typically oblique to the animal–vegetal axis with a defined chirality, whereas many deuterostome lineages exhibit radial cleavage aligned to the animal–vegetal axis. Consider a simplified, biophysically grounded model for a spherical blastomere approximated by a circular cortex in the equatorial plane. A bipolar mitotic spindle is oriented by cortical pulling forces generated by astral microtubules and dynein, and its orientation is characterized by an angle $\\theta$ measured from the animal–vegetal axis (taken as $\\phi_{y} = 0$). Assume the following:\n\n1) The local cortical traction per unit arc length at polar angle $\\psi$ has a baseline isotropic magnitude and a small anisotropic second-harmonic component, consistent with a bipolar spindle’s even symmetry: for a cytoskeletal anisotropy aligned at angle $\\phi_{c}$ (set by actomyosin architecture and chirality cues), the traction density is $f_{c}(\\psi) = f_{c0}\\left[1 + \\alpha \\cos\\big(2(\\psi - \\phi_{c})\\big)\\right]$ with $0  \\alpha \\ll 1$. For yolk-coupled anisotropy aligned at $\\phi_{y}$, write similarly $f_{y}(\\psi) = f_{y0}\\left[1 + \\beta \\cos\\big(2(\\psi - \\phi_{y})\\big)\\right]$ with $0  \\beta \\ll 1$.\n\n2) Each cortical element at angle $\\psi$ exerts an orienting torque on the spindle that is proportional to the local traction amplitude multiplied by a geometric kernel that respects spindle bipolar symmetry. Modeling the astral anchoring energy as proportional to $\\cos^{2}(\\theta - \\psi)$, and using force–torque balance at the cortex, the leading-order torque per unit arc length scales as $\\sin\\big(2(\\theta - \\psi)\\big)$.\n\n3) The total torque about the cell center is the line integral over the cortex of the sum of cytoskeletal and yolk contributions, each weighted by its coupling coefficient. Denote the effective couplings $k_{c}$ and $k_{y}$, and the cell radius by $R$. Work to leading order in $\\alpha$ and $\\beta$, keeping only terms that survive the angular average over $\\psi \\in [0,2\\pi)$.\n\nUsing only the above physical premises and the requirement of static equilibrium ($\\text{net torque} = 0$), derive from first principles the closed-form analytic expression for the stable equilibrium orientation $\\theta^{\\ast}$ in terms of the second-harmonic strengths and axes $\\{A,\\phi_{c}\\}$ and $\\{B,\\phi_{y}\\}$, where $A$ and $B$ are proportional to $k_{c} f_{c0}\\alpha R$ and $k_{y} f_{y0}\\beta R$, respectively. Then evaluate the predicted difference in cleavage angle between a spiral-like protostome case and a radial-like deuterostome case defined by:\n\n- Spiral-like (protostome): $\\phi_{c} = \\frac{\\pi}{4}$ (dextral offset), $\\phi_{y} = 0$, with $k_{c} f_{c0}\\alpha = 20 \\times 0.2$ and $k_{y} f_{y0}\\beta = 10 \\times 0.1$.\n- Radial-like (deuterostome): $\\phi_{c} = 0$, $\\phi_{y} = 0$, with the same $k_{c} f_{c0}\\alpha$ and $k_{y} f_{y0}\\beta$ as above.\n\nReport the quantity $\\Delta \\theta = \\theta^{\\ast}_{\\text{spiral}} - \\theta^{\\ast}_{\\text{radial}}$ in radians, rounded to four significant figures. Express the final answer as a single real number. Do not include units in your final boxed answer, but take care to state the unit in your derivation and adhere to the rounding specification here.", "solution": "The problem statement must first be validated for scientific soundness, self-consistency, and objectivity.\n\nStep 1: Extracted Givens\n-   Model: A single-cell embryo is modeled as a circular cortex of radius $R$ in the equatorial plane.\n-   Spindle Orientation: The mitotic spindle orientation is given by an angle $\\theta$ relative to the animal-vegetal axis, which is defined at angle $\\phi_{y} = 0$.\n-   Cytoskeletal Traction Density: $f_{c}(\\psi) = f_{c0}\\left[1 + \\alpha \\cos\\big(2(\\psi - \\phi_{c})\\big)\\right]$, with anisotropy axis $\\phi_{c}$ and strength $0  \\alpha \\ll 1$.\n-   Yolk-Coupled Traction Density: $f_{y}(\\psi) = f_{y0}\\left[1 + \\beta \\cos\\big(2(\\psi - \\phi_{y})\\big)\\right]$, with anisotropy axis $\\phi_{y}$ and strength $0  \\beta \\ll 1$. The animal-vegetal axis is given as $\\phi_{y}=0$.\n-   Torque Kernel: The orienting torque per unit arc length at cortical angle $\\psi$ is proportional to the local traction multiplied by a geometric kernel that scales as $\\sin\\big(2(\\theta - \\psi)\\big)$.\n-   Total Torque: The net torque is the integral over the cortex of the sum of cytoskeletal and yolk contributions, weighted by effective couplings $k_c$ and $k_y$.\n-   Equilibrium Condition: Static equilibrium requires the net torque to be zero, $\\tau(\\theta^*) = 0$.\n-   Approximation: Analysis must be to leading order in $\\alpha$ and $\\beta$.\n-   Parameter Definitions: $A \\propto k_{c} f_{c0}\\alpha R$ and $B \\propto k_{y} f_{y0}\\beta R$.\n-   Task 1: Derive the closed-form analytic expression for the stable equilibrium orientation $\\theta^{\\ast}$.\n-   Task 2: Calculate $\\Delta \\theta = \\theta^{\\ast}_{\\text{spiral}} - \\theta^{\\ast}_{\\text{radial}}$ for two specific cases.\n-   Spiral-like case: $\\phi_{c} = \\frac{\\pi}{4}$, $\\phi_{y} = 0$, $k_{c} f_{c0}\\alpha = 4$, $k_{y} f_{y0}\\beta = 1$.\n-   Radial-like case: $\\phi_{c} = 0$, $\\phi_{y} = 0$, $k_{c} f_{c0}\\alpha = 4$, $k_{y} f_{y0}\\beta = 1$.\n-   Final Answer Format: A single real number for $\\Delta\\theta$ in radians, rounded to four significant figures.\n\nStep 2: Validation\nThe problem is scientifically grounded, employing a standard biophysical modeling approach for cell mechanics (cortical forces, torque balance, Fourier-series representation of anisotropies). The mathematical structure is well-posed, providing a clear path from first principles to a solvable equation. The premises are objective, self-contained, and consistent. The problem does not violate any of the invalidity criteria.\n\nVerdict: The problem is valid. Proceeding with solution.\n\nThe total torque $\\tau(\\theta)$ on the spindle is the sum of contributions from the cytoskeleton and yolk distribution, integrated over the entire circular cortex. The torque element $d\\tau$ generated by a cortical segment of arc length $ds = R d\\psi$ at angle $\\psi$ is the sum of the weighted tractions multiplied by the torque kernel.\n\n$$\nd\\tau = \\left[ k_c f_c(\\psi) + k_y f_y(\\psi) \\right] \\sin(2(\\theta - \\psi)) R d\\psi\n$$\n\nThe total torque is the integral of $d\\tau$ over $\\psi$ from $0$ to $2\\pi$.\n$$\n\\tau(\\theta) = R \\int_0^{2\\pi} \\left[ k_c f_{c0}\\left(1 + \\alpha \\cos(2(\\psi - \\phi_{c}))\\right) + k_y f_{y0}\\left(1 + \\beta \\cos(2(\\psi - \\phi_{y}))\\right) \\right] \\sin(2(\\theta - \\psi)) d\\psi\n$$\nWe analyze the integral term by term. The isotropic components (proportional to $1$) contribute:\n$$\n\\int_0^{2\\pi} (k_c f_{c0} + k_y f_{y0}) \\sin(2(\\theta - \\psi)) d\\psi = (k_c f_{c0} + k_y f_{y0}) \\left[ \\frac{1}{2}\\cos(2(\\theta - \\psi)) \\right]_0^{2\\pi} = 0\n$$\nAs expected, an isotropic force distribution exerts no net orienting torque. The anisotropic components, which are of leading order in $\\alpha$ and $\\beta$, provide the net torque. Let's evaluate the cytoskeletal contribution:\n$$\n\\tau_c(\\theta) = k_c f_{c0} \\alpha R \\int_0^{2\\pi} \\cos(2(\\psi - \\phi_c)) \\sin(2(\\theta - \\psi)) d\\psi\n$$\nUsing the trigonometric identity $\\cos A \\sin B = \\frac{1}{2}(\\sin(A+B) - \\sin(A-B))$, with $A = 2\\psi - 2\\phi_c$ and $B = 2\\theta - 2\\psi$:\n$$\n\\begin{align*}\n\\cos(2(\\psi - \\phi_c)) \\sin(2(\\theta - \\psi)) = \\frac{1}{2} \\left[ \\sin( (2\\psi - 2\\phi_c) + (2\\theta - 2\\psi) ) - \\sin( (2\\psi - 2\\phi_c) - (2\\theta - 2\\psi) ) \\right] \\\\\n= \\frac{1}{2} \\left[ \\sin(2\\theta - 2\\phi_c) - \\sin(4\\psi - 2\\theta - 2\\phi_c) \\right]\n\\end{align*}\n$$\nThe integral becomes:\n$$\n\\int_0^{2\\pi} \\frac{1}{2} \\left[ \\sin(2\\theta - 2\\phi_c) - \\sin(4\\psi - 2\\theta - 2\\phi_c) \\right] d\\psi\n$$\nThe integral of $\\sin(4\\psi - \\text{const})$ over $[0, 2\\pi)$ is zero. The first term is constant with respect to $\\psi$.\n$$\n\\tau_c(\\theta) = k_c f_{c0} \\alpha R \\left( \\frac{1}{2} \\cdot 2\\pi \\sin(2\\theta - 2\\phi_c) \\right) = \\pi R (k_c f_{c0} \\alpha) \\sin(2(\\theta - \\phi_c))\n$$\nBy analogy, the yolk contribution is:\n$$\n\\tau_y(\\theta) = \\pi R (k_y f_{y0} \\beta) \\sin(2(\\theta - \\phi_y))\n$$\nThe total torque is $\\tau(\\theta) = \\tau_c(\\theta) + \\tau_y(\\theta)$. Let's define the effective anisotropy strengths $A' = k_c f_{c0} \\alpha$ and $B' = k_y f_{y0} \\beta$. These are proportional to $A$ and $B$ from the problem statement, and since we will set the total torque to zero, any common proportionality constant will cancel.\n$$\n\\tau(\\theta) = \\pi R \\left[ A' \\sin(2(\\theta - \\phi_c)) + B' \\sin(2(\\theta - \\phi_y)) \\right]\n$$\nFor static equilibrium, $\\tau(\\theta^*) = 0$:\n$$\nA' \\sin(2(\\theta^* - \\phi_c)) + B' \\sin(2(\\theta^* - \\phi_y)) = 0\n$$\nExpanding the sine terms:\n$$\nA'(\\sin(2\\theta^*)\\cos(2\\phi_c) - \\cos(2\\theta^*)\\sin(2\\phi_c)) + B'(\\sin(2\\theta^*)\\cos(2\\phi_y) - \\cos(2\\theta^*)\\sin(2\\phi_y)) = 0\n$$\nGrouping by $\\sin(2\\theta^*)$ and $\\cos(2\\theta^*)$:\n$$\n\\sin(2\\theta^*)[A'\\cos(2\\phi_c) + B'\\cos(2\\phi_y)] = \\cos(2\\theta^*)[A'\\sin(2\\phi_c) + B'\\sin(2\\phi_y)]\n$$\nThis gives the general expression for the equilibrium angles $\\theta^*$:\n$$\n\\tan(2\\theta^*) = \\frac{A' \\sin(2\\phi_c) + B' \\sin(2\\phi_y)}{A' \\cos(2\\phi_c) + B' \\cos(2\\phi_y)}\n$$\nThis is the required closed-form expression. For a stable equilibrium, the potential energy $U(\\theta) = -\\int \\tau(\\theta) d\\theta$ must be at a minimum, which requires $d^2U/d\\theta^2 > 0$. This is equivalent to $d\\tau/d\\theta  0$.\n$$\n\\frac{d\\tau}{d\\theta} = 2\\pi R \\left[ A' \\cos(2(\\theta - \\phi_c)) + B' \\cos(2(\\theta - \\phi_y)) \\right]\n$$\nLet $S = A' \\sin(2\\phi_c) + B' \\sin(2\\phi_y)$ and $C = A' \\cos(2\\phi_c) + B' \\cos(2\\phi_y)$. The equilibrium condition is $\\tan(2\\theta^*) = S/C$. The stability condition is $d\\tau/d\\theta  0$. The expression for $d\\tau/d\\theta$ can be rewritten as $2\\pi R [C \\cos(2\\theta) + S \\sin(2\\theta)]$.\nThe two families of solutions for $2\\theta^*$ are separated by $\\pi$. Let $\\Phi = \\text{atan2}(S, C)$, the principal angle. The solutions are $2\\theta^* = \\Phi$ and $2\\theta^* = \\Phi + \\pi$.\nAt $2\\theta^* = \\Phi$, we have $\\cos(2\\theta^*) \\propto C$ and $\\sin(2\\theta^*) \\propto S$. The term $C\\cos(2\\theta^*) + S\\sin(2\\theta^*) \\propto C^2+S^2 > 0$, so $d\\tau/d\\theta > 0$. This is an unstable equilibrium.\nAt $2\\theta^* = \\Phi + \\pi$, we have $\\cos(2\\theta^*) \\propto -C$ and $\\sin(2\\theta^*) \\propto -S$. The term $C\\cos(2\\theta^*) + S\\sin(2\\theta^*) \\propto -(C^2+S^2)  0$, so $d\\tau/d\\theta  0$. This is the stable equilibrium.\nThus, the stable orientation is given by $2\\theta^* = \\text{atan2}(S, C) + \\pi$.\n\nNow we evaluate for the two cases given.\n1.  Radial-like (deuterostome):\n    Parameters: $\\phi_c = 0$, $\\phi_y = 0$, $A' = 4$, $B' = 1$.\n    $S_{\\text{radial}} = 4 \\sin(0) + 1 \\sin(0) = 0$.\n    $C_{\\text{radial}} = 4 \\cos(0) + 1 \\cos(0) = 4 + 1 = 5$.\n    $\\tan(2\\theta^*_{\\text{radial}}) = 0/5 = 0$.\n    The angle $\\Phi_{\\text{radial}} = \\text{atan2}(0, 5) = 0$.\n    The stable solution is $2\\theta^*_{\\text{radial}} = 0 + \\pi = \\pi$.\n    Therefore, $\\theta^*_{\\text{radial}} = \\frac{\\pi}{2}$.\n\n2.  Spiral-like (protostome):\n    Parameters: $\\phi_c = \\frac{\\pi}{4}$, $\\phi_y = 0$, $A' = 4$, $B' = 1$.\n    $S_{\\text{spiral}} = 4 \\sin(2 \\cdot \\frac{\\pi}{4}) + 1 \\sin(0) = 4 \\sin(\\frac{\\pi}{2}) = 4$.\n    $C_{\\text{spiral}} = 4 \\cos(2 \\cdot \\frac{\\pi}{4}) + 1 \\cos(0) = 4 \\cos(\\frac{\\pi}{2}) + 1 = 1$.\n    $\\tan(2\\theta^*_{\\text{spiral}}) = 4/1 = 4$.\n    The angle $\\Phi_{\\text{spiral}} = \\text{atan2}(4, 1) = \\arctan(4)$.\n    The stable solution is $2\\theta^*_{\\text{spiral}} = \\arctan(4) + \\pi$.\n    Therefore, $\\theta^*_{\\text{spiral}} = \\frac{1}{2}(\\arctan(4) + \\pi) = \\frac{1}{2}\\arctan(4) + \\frac{\\pi}{2}$.\n\nThe required difference is $\\Delta \\theta = \\theta^{\\ast}_{\\text{spiral}} - \\theta^{\\ast}_{\\text{radial}}$.\n$$\n\\Delta\\theta = \\left( \\frac{1}{2}\\arctan(4) + \\frac{\\pi}{2} \\right) - \\frac{\\pi}{2} = \\frac{1}{2}\\arctan(4)\n$$\nWe now compute the numerical value in radians.\n$$\n\\arctan(4) \\approx 1.32581766~\\text{rad}\n$$\n$$\n\\Delta\\theta = \\frac{1}{2} \\times 1.32581766 \\approx 0.66290883~\\text{rad}\n$$\nRounding to four significant figures gives $0.6629$.", "answer": "$$\\boxed{0.6629}$$", "id": "2606641"}, {"introduction": "The fate of the blastopore—whether it contributes to the mouth (protostomy) or anus (deuterostomy)—is another canonical, yet often oversimplified, distinction. This exercise challenges you to move from textbook definitions to the practicalities of scientific inquiry by designing a modern fate-mapping experiment [@problem_id:2606745]. Evaluating the proposed experimental plans will sharpen your ability to identify the components of a rigorous, falsifiable test, including precise cell labeling, appropriate molecular markers like $FoxA$ and $Cdx$, and essential controls.", "problem": "You are asked to design and critically assess a fate-mapping experiment to test how the blastopore contributes to the mouth and anus in two bilaterian embryos: a lophotrochozoan annelid (for example, a marine polychaete) and an enteropneust hemichordate. You have access to a photoconvertible fluorescent protein whose emission spectrum can be irreversibly shifted from green to red by a focused violet light exposure of wavelength $405$ nanometers, expressed broadly after microinjection of messenger ribonucleic acid (mRNA) at the zygote stage. You can image embryos by confocal laser scanning microscopy (CLSM) and assess oral and anal epithelia by whole-mount in situ hybridization (WMISH) for canonical markers (for example, $FoxA$ for oral or pharyngeal ectoderm and $Cdx$ for hindgut and anal ectoderm). You can photoconvert at defined developmental times, including the onset of gastrulation (time $t_g$), the time of mouth opening (time $t_m$), and the time of anus opening (time $t_a$). Your goal is to rigorously test whether cells lining the blastopore at gastrulation contribute predominantly to the mouth in the lophotrochozoan and predominantly to the anus in the hemichordate.\n\nFoundational base you may invoke includes: the definition of a blastopore as the site of gastrulation opening; the operational meaning of fate mapping as labeling a cohort of cells at time $t_g$ and determining their descendants at later times $t_m$ and $t_a$; and the conventional distinction between protostomes and deuterostomes, in which blastopore-derived lineage contributions are predicted to favor the mouth in protostomes and the anus in deuterostomes, respectively. No other specialized results are assumed.\n\nWhich option below describes a scientifically rigorous, falsifiable experimental design and prediction set that would validly test the stated hypothesis in both taxa?\n\nA. Inject photoconvertible protein mRNA and photoconvert the entire vegetal hemisphere at a cleavage stage well before gastrulation. Track red fluorescence at time $t_m$ and time $t_a$ and infer contributions by proximity to the original vegetal region, concluding that the blastopore contributes to the mouth in both taxa if red cells are seen near the oral field at time $t_m$.\n\nB. Inject photoconvertible protein mRNA to achieve broad expression by time $t_g$. At time $t_g$, photoconvert a narrow continuous ring of cells precisely at the blastopore rim in each embryo using a scanned $405$ nanometer beam, leaving neighboring ectoderm unconverted. Include negative controls by photoconverting a non-rim ectodermal patch at the same stage and sham-irradiated siblings. At time $t_m$ and time $t_a$, quantify the fraction of photoconverted (red) cells that co-localize with oral versus anal epithelia using $FoxA$ and $Cdx$ expression, computing indices $I_{\\text{mouth}} = N_{\\text{red} \\cap \\text{mouth}}/N_{\\text{mouth}}$ and $I_{\\text{anus}} = N_{\\text{red} \\cap \\text{anus}}/N_{\\text{anus}}$. Perform a time-shifted conversion at a late gastrula stage to assess dynamics of rim cell contributions. Predict that, if conventional deuterostomy applies in the hemichordate, $I_{\\text{anus}} \\gg I_{\\text{mouth}}$, whereas in the lophotrochozoan consistent with protostomy, $I_{\\text{mouth}} \\gg I_{\\text{anus}}$. Treat mixed or inverted outcomes as evidence against the respective conventional expectation.\n\nC. At a late larval stage after mouth formation is evident, photoconvert cells in the stomodeal invagination region and track whether these cells are found near the blastopore scar in fixed specimens; infer blastopore fate from this relationship without additional markers.\n\nD. At time $t_g$, photoconvert only the center of the blastopore (not the rim) in both species. Do not use molecular markers; instead, rely on serial CLSM images to see whether any red cells are visible in the mouth. If red cells are not seen in the mouth at time $t_m$, conclude that both taxa are deuterostomes, and omit controls to avoid phototoxicity confounds because photoconversion is brief.", "solution": "The problem statement provides a clear, scientifically grounded, and well-posed question in the field of evolutionary developmental biology. It outlines a testable hypothesis concerning the fate of the blastopore in protostome and deuterostome lineages, providing a realistic set of modern molecular and imaging tools. The givens are sufficient and consistent. The problem is valid. We will now proceed to evaluate the proposed experimental designs.\n\nA rigorous fate-mapping experiment designed to test the stated hypothesis must adhere to several fundamental principles of experimental design:\n1.  **Spatial and Temporal Specificity**: The labeling of cells must be restricted precisely to the population of interest—the cells of the blastopore rim—and at the correct developmental stage, which is the onset of gastrulation ($t_g$).\n2.  **Unambiguous Lineage Tracing and Fate Identification**: The fate of the labeled cells must be determined without ambiguity. This requires a stable cell label (the photoconverted protein) and an independent, definitive method for identifying the resulting tissues of interest (the mouth and anus), for which molecular markers such as $FoxA$ and $Cdx$ are the appropriate standard.\n3.  **Inclusion of Proper Controls**: The experiment must include negative controls to account for artifacts. At minimum, a control for the specificity of labeling (e.g., labeling a non-blastoporal region) and a control for the effects of the experimental manipulation itself (e.g., sham-irradiated embryos to test for phototoxicity) are required.\n4.  **Quantitative Analysis**: Observations should be quantified to allow for objective comparison and statistical testing. Simply reporting the presence or absence of labeled cells is insufficient.\n5.  **Falsifiability**: The experimental predictions must be formulated such that the results can either support or refute the initial hypothesis.\n\nWe will now evaluate each option against these criteria.\n\n**Option A**: Inject photoconvertible protein mRNA and photoconvert the entire vegetal hemisphere at a cleavage stage well before gastrulation. Track red fluorescence at time $t_m$ and time $t_a$ and infer contributions by proximity to the original vegetal region, concluding that the blastopore contributes to the mouth in both taxa if red cells are seen near the oral field at time $t_m$.\n\nThis design is fundamentally flawed.\n- **Specificity**: Labeling the \"entire vegetal hemisphere\" at a \"cleavage stage\" is grossly imprecise. The blastopore as a structure does not yet exist, and this large labeled territory includes precursors to many tissues, not just the blastopore rim. The experiment therefore does not test the fate of the blastopore.\n- **Readout**: \"Inferring contributions by proximity\" is a vague, non-quantitative, and unreliable method. Cell migration during morphogenesis is complex; final proximity does not prove direct lineage. It also fails to use the provided molecular markers for rigorous tissue identification.\n- **Conclusion**: The proposed logic for drawing a conclusion is unsound. Given the large initial labeled area, finding labeled cells near the mouth is a highly probable but uninformative outcome.\n\n**Verdict**: Incorrect. This experimental design lacks the necessary precision and rigor, and would not yield interpretable data to test the hypothesis.\n\n**Option B**: Inject photoconvertible protein mRNA to achieve broad expression by time $t_g$. At time $t_g$, photoconvert a narrow continuous ring of cells precisely at the blastopore rim in each embryo using a scanned $405$ nanometer beam, leaving neighboring ectoderm unconverted. Include negative controls by photoconverting a non-rim ectodermal patch at the same stage and sham-irradiated siblings. At time $t_m$ and time $t_a$, quantify the fraction of photoconverted (red) cells that co-localize with oral versus anal epithelia using $FoxA$ and $Cdx$ expression, computing indices $I_{\\text{mouth}} = N_{\\text{red} \\cap \\text{mouth}}/N_{\\text{mouth}}$ and $I_{\\text{anus}} = N_{\\text{red} \\cap \\text{anus}}/N_{\\text{anus}}$. Perform a time-shifted conversion at a late gastrula stage to assess dynamics of rim cell contributions. Predict that, if conventional deuterostomy applies in the hemichordate, $I_{\\text{anus}} \\gg I_{\\text{mouth}}$, whereas in the lophotrochozoan consistent with protostomy, $I_{\\text{mouth}} \\gg I_{\\text{anus}}$. Treat mixed or inverted outcomes as evidence against the respective conventional expectation.\n\nThis design is exemplary and meets all criteria for a rigorous experiment.\n- **Specificity**: Labeling is performed on a \"narrow continuous ring of cells precisely at the blastopore rim\" at the correct time, $t_g$. This is the exact cell population and stage of interest.\n- **Controls**: It correctly includes two essential controls: a negative control for labeling specificity (\"non-rim ectodermal patch\") and a sham control for phototoxicity and handling artifacts (\"sham-irradiated siblings\").\n- **Readout**: It employs the correct method for fate identification: co-localization of the lineage tracer (red fluorescence) with definitive molecular markers ($FoxA$ for mouth and $Cdx$ for anus).\n- **Quantification**: It proposes a quantitative approach by calculating indices ($I_{\\text{mouth}}$ and $I_{\\text{anus}}$) to measure the contribution of the labeled cells to the final structures. This allows for objective comparison.\n- **Falsifiability**: It makes clear, falsifiable predictions based on the conventional protostome/deuterostome models and correctly interprets contradictory results as evidence against those models.\n- **Additional Rigor**: The proposal to perform a time-shifted experiment demonstrates a sophisticated understanding of developmental dynamics.\n\n**Verdict**: Correct. This option describes a scientifically rigorous, well-controlled, and quantitative experiment capable of definitively testing the stated hypothesis.\n\n**Option C**: At a late larval stage after mouth formation is evident, photoconvert cells in the stomodeal invagination region and track whether these cells are found near the blastopore scar in fixed specimens; infer blastopore fate from this relationship without additional markers.\n\nThis design is based on a fundamental misunderstanding of fate mapping.\n- **Principle**: Fate mapping is a prospective (forward-in-time) analysis, used to determine what a group of cells will become. This option proposes a retrospective (backward-in-time) analysis, labeling cells in a developed structure (the mouth) and attempting to infer their origin. A photoconversion label is static; it cannot be used to trace a cell’s history backward.\n- **Timing and Readout**: Labeling occurs \"after mouth formation is evident,\" which is too late to map the fate of the blastopore. Relying on a \"blastopore scar\" is unreliable, and the explicit omission of molecular markers removes any hope of rigor.\n\n**Verdict**: Incorrect. The proposed method is conceptually invalid for a fate-mapping experiment.\n\n**Option D**: At time $t_g$, photoconvert only the center of the blastopore (not the rim) in both species. Do not use molecular markers; instead, rely on serial CLSM images to see whether any red cells are visible in the mouth. If red cells are not seen in the mouth at time $t_m$, conclude that both taxa are deuterostomes, and omit controls to avoid phototoxicity confounds because photoconversion is brief.\n\nThis design is a catalogue of poor scientific practices.\n- **Specificity**: Labeling the \"center of the blastopore\" targets the involuting endomesoderm, not the blastopore rim cells that are central to the protostomy/deuterostomy question regarding ectodermal openings.\n- **Controls**: The explicit decision to \"omit controls\" is an unforgivable violation of the scientific method. The justification provided—that brief exposure avoids phototoxicity—is a mere assumption that must itself be tested. Without controls, any result is uninterpretable. A negative result (no red cells) could be due to cell death, not developmental fate.\n- **Readout**: The refusal to use molecular markers in favor of purely morphological identification is a step backward in terms of precision and objectivity.\n- **Logic**: The conclusion that \"if red cells are not seen in the mouth..., conclude that both taxa are deuterostomes\" is a logical fallacy (an argument from ignorance). The absence of cells in the mouth does not prove they contributed to the anus; they could have died or contributed to other tissues entirely.\n\n**Verdict**: Incorrect. This design is scientifically unsound, lacks controls, uses inadequate methods, and relies on flawed logic.", "answer": "$$\\boxed{B}$$", "id": "2606745"}, {"introduction": "Modern phylogenomics provides a powerful lens for re-evaluating the deepest branches of the animal tree, often revealing a more complex picture than classical models suggest. This practice puts you at the computational heart of this endeavor, tasking you with evaluating competing hypotheses for the placement of the enigmatic Xenacoelomorpha using a site-heterogeneous substitution model [@problem_id:2606724]. By implementing the calculation of a Bayes factor from per-site likelihoods, you will gain direct experience with the quantitative framework used to weigh evidence in cutting-edge evolutionary research.", "problem": "You will evaluate two competing phylogenetic hypotheses about the placement of Xenacoelomorpha relative to Ambulacraria in the context of Bilateria: hypothesis $H_1$ places Xenacoelomorpha as sister to Ambulacraria within Deuterostomia, and hypothesis $H_2$ places Xenacoelomorpha outside of Deuterostomia. You are given simplified data for a site-heterogeneous substitution model represented as a finite mixture of $K$ site-classes with fixed mixture weights. The site-heterogeneous assumption means that each alignment site is generated by one of $K$ classes, with class $k$ used with probability $w_k$, where the weight vector $w = (w_1,\\dots,w_K)$ satisfies $w_k \\ge 0$ and $\\sum_{k=1}^{K} w_k = 1$. For each site $i \\in \\{1,\\dots,S\\}$ and class $k \\in \\{1,\\dots,K\\}$, you are provided the per-site, per-class likelihood $L_{ik}^{(h)} = p(d_i \\mid \\text{class } k, H_h)$ under hypothesis $H_h$, where $h \\in \\{1,2\\}$ and $d_i$ denotes the observed site $i$ character pattern.\n\nYour task is to compute the Bayes factor (BF) comparing $H_1$ to $H_2$ under this mixture model using only the given likelihoods and fixed mixture weights. Use the following fundamental base:\n- Bayes theorem and the definition of Bayes factor (BF): the Bayes factor comparing $H_1$ to $H_2$ is $BF_{12} = \\dfrac{p(D \\mid H_1)}{p(D \\mid H_2)}$, where $D$ is the full alignment data.\n- Under independence of sites given the model, the model evidence (marginal likelihood) under hypothesis $H_h$ with fixed mixture weights $w$ for a site-heterogeneous mixture is\n$$\np(D \\mid H_h, w) = \\prod_{i=1}^{S} \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\nYou must compute the natural logarithm of the Bayes factor,\n$$\n\\ln BF_{12} = \\ln p(D \\mid H_1, w) - \\ln p(D \\mid H_2, w),\n$$\nfor each provided test dataset. For numerical stability, you should avoid underflow by accumulating logarithms of the per-site mixture sums; that is, compute\n$$\n\\ln p(D \\mid H_h, w) = \\sum_{i=1}^{S} \\ln\\!\\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\n\nInput for each test dataset consists of:\n- The number of site-classes $K$.\n- The mixture weight vector $w = (w_1,\\dots,w_K)$.\n- For each site $i \\in \\{1,\\dots,S\\}$, two vectors of length $K$: the class-conditional likelihoods under $H_1$, $[L_{i1}^{(1)},\\dots,L_{iK}^{(1)}]$, and under $H_2$, $[L_{i1}^{(2)},\\dots,L_{iK}^{(2)}]$.\n\nYour program must compute, for each dataset, the scalar value $\\ln BF_{12}$ and output the results for all datasets on a single line as a comma-separated list enclosed in square brackets. Express each value rounded to six decimal places. No units are required. Angles are not involved. Percentages must not be used.\n\nTest suite:\n- Dataset A (balanced site-heterogeneity; mixed signal):\n  - $K = 3$\n  - $w = [\\,0.5,\\,0.3,\\,0.2\\,]$\n  - $S = 4$ sites with $H_1$ and $H_2$ class-conditional likelihoods:\n    - Site $1$: $H_1 = [\\,0.9,\\,0.6,\\,0.4\\,]$, $H_2 = [\\,0.3,\\,0.5,\\,0.4\\,]$\n    - Site $2$: $H_1 = [\\,0.2,\\,0.3,\\,0.2\\,]$, $H_2 = [\\,0.4,\\,0.5,\\,0.4\\,]$\n    - Site $3$: $H_1 = [\\,0.6,\\,0.6,\\,0.6\\,]$, $H_2 = [\\,0.6,\\,0.6,\\,0.6\\,]$\n    - Site $4$: $H_1 = [\\,0.7,\\,0.2,\\,0.2\\,]$, $H_2 = [\\,0.4,\\,0.2,\\,0.2\\,]$\n- Dataset B (extreme site-heterogeneity; dominant class favors $H_2$; boundary-like weights):\n  - $K = 3$\n  - $w = [\\,0.95,\\,0.04,\\,0.01\\,]$\n  - $S = 4$ sites:\n    - Site $1$: $H_1 = [\\,0.2,\\,0.9,\\,0.9\\,]$, $H_2 = [\\,0.8,\\,0.1,\\,0.1\\,]$\n    - Site $2$: $H_1 = [\\,0.1,\\,0.9,\\,0.9\\,]$, $H_2 = [\\,0.7,\\,0.1,\\,0.1\\,]$\n    - Site $3$: $H_1 = [\\,0.5,\\,0.6,\\,0.6\\,]$, $H_2 = [\\,0.5,\\,0.6,\\,0.6\\,]$\n    - Site $4$: $H_1 = [\\,0.3,\\,0.2,\\,0.2\\,]$, $H_2 = [\\,0.6,\\,0.2,\\,0.2\\,]$\n- Dataset C (uniform site-heterogeneity; one decisive site for $H_1$):\n  - $K = 3$\n  - $w = [\\,0.3333333333333333,\\,0.3333333333333333,\\,0.3333333333333333\\,]$\n  - $S = 3$ sites:\n    - Site $1$: $H_1 = [\\,0.99,\\,0.99,\\,0.99\\,]$, $H_2 = [\\,0.01,\\,0.01,\\,0.01\\,]$\n    - Site $2$: $H_1 = [\\,0.5,\\,0.01,\\,0.5\\,]$, $H_2 = [\\,0.5,\\,0.99,\\,0.5\\,]$\n    - Site $3$: $H_1 = [\\,0.5,\\,0.5,\\,0.5\\,]$, $H_2 = [\\,0.5,\\,0.5,\\,0.5\\,]$\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where $r_j$ is the $\\ln BF_{12}$ value for dataset $j$ rounded to six decimal places.", "solution": "We begin from Bayes theorem and the definition of Bayes factor (BF). For two hypotheses $H_1$ and $H_2$ and data $D$, the Bayes factor comparing $H_1$ to $H_2$ is defined as\n$$\nBF_{12} = \\frac{p(D \\mid H_1)}{p(D \\mid H_2)}.\n$$\nThe natural logarithm of the Bayes factor is then\n$$\n\\ln BF_{12} = \\ln p(D \\mid H_1) - \\ln p(D \\mid H_2).\n$$\nIn our setting, the site-heterogeneous model is a finite mixture with $K$ classes and fixed mixture weights $w = (w_1,\\dots,w_K)$ where $w_k \\ge 0$ and $\\sum_{k=1}^{K} w_k = 1$. Each site $i \\in \\{1,\\dots,S\\}$ has class-conditional likelihoods $L_{ik}^{(h)} = p(d_i \\mid \\text{class } k, H_h)$ under hypothesis $H_h$.\n\nAssuming conditional independence of sites given the model, the model evidence (marginal likelihood) under hypothesis $H_h$ with fixed $w$ is\n$$\np(D \\mid H_h, w) = \\prod_{i=1}^{S} \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\nTaking natural logarithms to avoid underflow and to transform products into sums, we obtain\n$$\n\\ln p(D \\mid H_h, w) = \\sum_{i=1}^{S} \\ln \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)} \\right).\n$$\nTherefore, the desired quantity is\n$$\n\\ln BF_{12} = \\sum_{i=1}^{S} \\left[ \\ln \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(1)} \\right) - \\ln \\left( \\sum_{k=1}^{K} w_k \\, L_{ik}^{(2)} \\right) \\right].\n$$\n\nPrinciple-based algorithmic design:\n1. For each dataset, read $K$, the weight vector $w$, and the per-site, per-class likelihood arrays under $H_1$ and $H_2$. Ensure all likelihoods $L_{ik}^{(h)}$ and weights $w_k$ are strictly positive with $\\sum_{k} w_k = 1$ (as provided).\n2. For each site $i$, compute the mixture likelihood under each hypothesis as $M_i^{(h)} = \\sum_{k=1}^{K} w_k \\, L_{ik}^{(h)}$.\n3. To maintain numerical stability, especially for products of many small terms, accumulate $\\ln M_i^{(h)}$ rather than $M_i^{(h)}$ themselves. Although the mixture inner sum is not a product, it may involve small addends; if needed, one can compute $\\ln M_i^{(h)}$ using a stable transformation:\n   - Write $M_i^{(h)} = \\sum_{k=1}^{K} \\exp(\\ln w_k + \\ln L_{ik}^{(h)})$.\n   - Then use the log-sum-exp technique:\n     $$\n     \\ln M_i^{(h)} = m + \\ln \\left( \\sum_{k=1}^{K} \\exp\\left( (\\ln w_k + \\ln L_{ik}^{(h)}) - m \\right) \\right),\n     $$\n     where $m = \\max_{k} (\\ln w_k + \\ln L_{ik}^{(h)})$.\n   This guarantees stability when the terms span several orders of magnitude.\n4. Sum $\\ln M_i^{(1)}$ over sites to obtain $\\ln p(D \\mid H_1, w)$, and similarly for $H_2$ to obtain $\\ln p(D \\mid H_2, w)$.\n5. Compute $\\ln BF_{12}$ as the difference of these sums.\n6. Round each resulting $\\ln BF_{12}$ to six decimal places and output all dataset results on one line in the required format.\n\nScientific interpretation within the comparative zoology context:\n- A positive value of $\\ln BF_{12}$ indicates that the data, under the specified site-heterogeneous mixture, provide support for $H_1$ (Xenacoelomorpha as sister to Ambulacraria within Deuterostomia) relative to $H_2$.\n- A negative value indicates support for $H_2$ (Xenacoelomorpha placed outside Deuterostomia).\n- The magnitude of $\\lvert \\ln BF_{12} \\rvert$ reflects the strength of evidence under the mixture model.\n\nApplying the method to the provided test suite:\n- Dataset A uses balanced weights and mixed signals across sites; the result is expected to be mildly positive (favoring $H_1$) because several sites have higher mixture likelihood under $H_1$.\n- Dataset B uses boundary-like weights where the dominant class strongly favors $H_2$; the result is expected to be strongly negative.\n- Dataset C uses uniform weights with one decisive site for $H_1$ and one site favoring $H_2$ in a single class; the result is expected to be strongly positive due to the decisive site under $H_1$.\n\nThe implementation follows the steps above exactly, using the log-sum-exp technique to ensure robustness, and prints the three $\\ln BF_{12}$ values rounded to six decimals as a single bracketed list.", "answer": "```python\nimport numpy as np\n\ndef logsumexp(a: np.ndarray) - float:\n    \"\"\"\n    Compute log(sum(exp(a))) in a numerically stable way.\n    \"\"\"\n    m = np.max(a)\n    return float(m + np.log(np.sum(np.exp(a - m))))\n\ndef log_marginal_likelihood(weights: np.ndarray, lik_matrix: np.ndarray) - float:\n    \"\"\"\n    Compute log p(D | H, w) for a site-heterogeneous mixture with fixed weights.\n\n    weights: shape (K,), strictly positive, sum to 1.\n    lik_matrix: shape (S, K), per-site, per-class likelihoods under a hypothesis.\n    \"\"\"\n    # Precompute log-weights\n    log_w = np.log(weights)\n    total = 0.0\n    for i in range(lik_matrix.shape[0]):\n        # log of mixture sum for site i: log(sum_k w_k * L_{ik})\n        log_terms = log_w + np.log(lik_matrix[i, :])\n        total += logsumexp(log_terms)\n    return total\n\ndef ln_bayes_factor(weights: np.ndarray, lik_h1: np.ndarray, lik_h2: np.ndarray) - float:\n    \"\"\"\n    Compute ln BF_12 = ln p(D|H1,w) - ln p(D|H2,w)\n    \"\"\"\n    ln_p_h1 = log_marginal_likelihood(weights, lik_h1)\n    ln_p_h2 = log_marginal_likelihood(weights, lik_h2)\n    return ln_p_h1 - ln_p_h2\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Dataset A\n    w_A = np.array([0.5, 0.3, 0.2], dtype=float)\n    H1_A = np.array([\n        [0.9, 0.6, 0.4],  # Site 1\n        [0.2, 0.3, 0.2],  # Site 2\n        [0.6, 0.6, 0.6],  # Site 3\n        [0.7, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n    H2_A = np.array([\n        [0.3, 0.5, 0.4],  # Site 1\n        [0.4, 0.5, 0.4],  # Site 2\n        [0.6, 0.6, 0.6],  # Site 3\n        [0.4, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n\n    # Dataset B\n    w_B = np.array([0.95, 0.04, 0.01], dtype=float)\n    H1_B = np.array([\n        [0.2, 0.9, 0.9],  # Site 1\n        [0.1, 0.9, 0.9],  # Site 2\n        [0.5, 0.6, 0.6],  # Site 3\n        [0.3, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n    H2_B = np.array([\n        [0.8, 0.1, 0.1],  # Site 1\n        [0.7, 0.1, 0.1],  # Site 2\n        [0.5, 0.6, 0.6],  # Site 3\n        [0.6, 0.2, 0.2],  # Site 4\n    ], dtype=float)\n\n    # Dataset C\n    w_C = np.array([0.3333333333333333, 0.3333333333333333, 0.3333333333333333], dtype=float)\n    H1_C = np.array([\n        [0.99, 0.99, 0.99],  # Site 1\n        [0.5,  0.01, 0.5 ],  # Site 2\n        [0.5,  0.5,  0.5 ],  # Site 3\n    ], dtype=float)\n    H2_C = np.array([\n        [0.01, 0.01, 0.01],  # Site 1\n        [0.5,  0.99, 0.5 ],  # Site 2\n        [0.5,  0.5,  0.5 ],  # Site 3\n    ], dtype=float)\n\n    test_cases = [\n        (w_A, H1_A, H2_A),\n        (w_B, H1_B, H2_B),\n        (w_C, H1_C, H2_C),\n    ]\n\n    results = []\n    for weights, lik_h1, lik_h2 in test_cases:\n        ln_bf = ln_bayes_factor(weights, lik_h1, lik_h2)\n        results.append(f\"{ln_bf:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2606724"}]}