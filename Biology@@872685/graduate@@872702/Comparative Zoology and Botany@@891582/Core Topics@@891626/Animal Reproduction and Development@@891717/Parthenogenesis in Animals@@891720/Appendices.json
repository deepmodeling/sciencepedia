{"hands_on_practices": [{"introduction": "Understanding the evolutionary trajectory of a parthenogenetic lineage begins with its most fundamental genetic consequence: the change in heterozygosity from one generation to the next. This first exercise challenges you to derive this relationship from first principles for central fusion automixis, a common mechanism in animals. By linking the meiotic recombination rate ($r$) to the probability of retaining heterozygosity, you will build a foundational model for predicting the genetic structure of automictic populations [@problem_id:2595264].", "problem": "In a diploid animal lineage exhibiting central fusion automixis, consider a single bivalent carrying a locus with two alleles, $A$ and $a$, such that the mother is initially heterozygous $A/a$ at that locus. Assume the standard tetrad model of meiosis with no chromatid interference and normal disjunction, and that diploidy is restored by central fusion, meaning one haploid product from each of the two first-division dyads fuses to form the offspring’s nucleus. Let the recombination fraction between the locus and its centromere be $r$ in the sense of ordered tetrad analysis (i.e., the standard locus–centromere recombination distance).\n\nStarting from fundamental definitions of first-division segregation and second-division segregation and the classical ordered tetrad framework, derive a closed-form expression in terms of $r$ for the probability that the diploid parthenogenetic offspring retains heterozygosity at the locus after one generation of central fusion automixis. Express your final answer as a single analytic expression in $r$. No numerical evaluation or rounding is required.", "solution": "The problem requires the derivation of the probability that an offspring produced by central fusion automixis retains the heterozygosity of its mother at a given locus. We begin by analyzing the meiotic process and segregation patterns.\n\nThe mother is diploid and heterozygous at a locus with alleles $A$ and $a$. Her genotype is $A/a$. Prior to meiosis, DNA replication occurs, so the bivalent for the homologous pair of chromosomes contains four chromatids. One replicated chromosome consists of two sister chromatids, both carrying allele $A$, and the other consists of two sister chromatids, both carrying allele $a$.\n\nThe genetic outcome of meiosis depends on whether a crossover occurs between the locus and its centromere. This gives rise to two segregation patterns for the alleles:\n\n1.  **First-Division Segregation (FDS)**: This pattern occurs when there is no crossover between the locus and the centromere. During anaphase I, the homologous chromosomes separate. One secondary meiocyte receives the replicated chromosome with two $A$ chromatids, and the other receives the replicated chromosome with two $a$ chromatids. The alleles $A$ and $a$ segregate at the first meiotic division.\n\n2.  **Second-Division Segregation (SDS)**: This pattern occurs when there is a single crossover between the locus and the centromere. As a result of the crossover, each replicated chromosome entering anaphase I is now heterozygous, carrying one chromatid with allele $A$ and one with allele $a$. Therefore, the alleles $A$ and $a$ do not segregate until the second meiotic division, when sister chromatids separate.\n\nThe problem provides the recombination fraction $r$ between the locus and the centromere, defined in the context of ordered tetrad analysis. In this framework, the recombination fraction $r$ is equal to half the frequency of tetrads showing second-division segregation. This is because an SDS tetrad contains two recombinant and two non-recombinant products out of four.\nLet $P(\\text{FDS})$ and $P(\\text{SDS})$ be the probabilities of FDS and SDS patterns occurring, respectively. From the definition of $r$:\n$$r = \\frac{1}{2} P(\\text{SDS})$$\nThis implies:\n$$P(\\text{SDS}) = 2r$$\nSince FDS and SDS are the only two possibilities for a single locus:\n$$P(\\text{FDS}) = 1 - P(\\text{SDS}) = 1 - 2r$$\nThis model is valid for recombination fractions $r$ such that $0 \\le r \\le \\frac{1}{2}$, which ensures $P(\\text{SDS}) \\le 1$.\n\nNext, we analyze the consequences of central fusion automixis for each segregation pattern. Central fusion is defined as the fusion of one haploid product from each of the two dyads formed at the end of meiosis I.\n\n**Case 1: FDS occurs (with probability $1 - 2r$)**\nAt the end of meiosis I, one dyad contains two chromatids of type $A$, and the other dyad contains two chromatids of type $a$.\n- The first dyad undergoes meiosis II, producing two haploid nuclei, both with genotype $A$.\n- The second dyad undergoes meiosis II, producing two haploid nuclei, both with genotype $a$.\nCentral fusion involves fusing one nucleus from the first dyad's products (which must be $A$) with one nucleus from the second dyad's products (which must be $a$). The resulting diploid offspring will have the genotype $A/a$.\nTherefore, if FDS occurs, the offspring is guaranteed to be heterozygous. The probability of retaining heterozygosity, given FDS, is $1$.\n$$P(\\text{Heterozygous} | \\text{FDS}) = 1$$\n\n**Case 2: SDS occurs (with probability $2r$)**\nAt the end of meiosis I, due to the crossover, both dyads are heterozygous. Each dyad contains one chromatid of type $A$ and one of type $a$.\n- The first dyad undergoes meiosis II, producing one haploid nucleus with genotype $A$ and one with genotype $a$. The probability of randomly selecting an $A$ nucleus is $\\frac{1}{2}$, and the probability of selecting an $a$ nucleus is $\\frac{1}{2}$.\n- Similarly, the second dyad's meiotic products are one $A$ nucleus and one $a$ nucleus. The selection probabilities are also $\\frac{1}{2}$ for $A$ and $\\frac{1}{2}$ for $a$.\nCentral fusion combines one random nucleus from the first lineage and one from the second. The possible genotypes of the offspring are:\n- $A/A$: by fusing an $A$ nucleus from the first dyad and an $A$ nucleus from the second. The probability is $P(A_1 \\cap A_2) = P(A_1)P(A_2) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n- $a/a$: by fusing an $a$ nucleus from the first dyad and an $a$ nucleus from the second. The probability is $P(a_1 \\cap a_2) = P(a_1)P(a_2) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n- $A/a$: by fusing an $A$ from the first and an $a$ from the second, or an $a$ from the first and an $A$ from the second. The probability is $P(A_1 \\cap a_2) + P(a_1 \\cap A_2) = (\\frac{1}{2} \\times \\frac{1}{2}) + (\\frac{1}{2} \\times \\frac{1}{2}) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$.\nTherefore, if SDS occurs, the probability that the offspring is heterozygous is $\\frac{1}{2}$.\n$$P(\\text{Heterozygous} | \\text{SDS}) = \\frac{1}{2}$$\n\n**Total Probability of Retaining Heterozygosity**\nWe can now calculate the total probability of the offspring being heterozygous, $P(\\text{Het})$, by applying the law of total probability:\n$$P(\\text{Het}) = P(\\text{Het} | \\text{FDS}) \\cdot P(\\text{FDS}) + P(\\text{Het} | \\text{SDS}) \\cdot P(\\text{SDS})$$\nSubstituting the values we have derived:\n$$P(\\text{Het}) = (1) \\cdot (1 - 2r) + \\left(\\frac{1}{2}\\right) \\cdot (2r)$$\n$$P(\\text{Het}) = 1 - 2r + r$$\n$$P(\\text{Het}) = 1 - r$$\nThis is the closed-form expression for the probability that the parthenogenetic offspring retains heterozygosity at the locus after one generation of central fusion automixis.", "answer": "$$\\boxed{1-r}$$", "id": "2595264"}, {"introduction": "While parthenogenesis has profound genetic consequences, its persistence and spread in nature are governed by ecological and evolutionary dynamics. This practice explores the conditions for invasion by a parthenogenesis-inducing symbiont, a common scenario in arthropods. You will use invasion analysis to derive the critical fitness cost ($c$) that can be tolerated for a given symbiont transmission rate ($t$), illustrating the classic trade-off between the 'two-fold cost of sex' and the costs of asexual reproduction [@problem_id:2595272].", "problem": "In many arthropods, maternally inherited bacteria can induce thelytokous parthenogenesis in their hosts. Consider a panmictic, discrete-generation host population at demographic equilibrium with equal numbers of daughters and sons among sexually reproducing hosts. Assume that in the resident sexual population, each female produces on average $1$ adult daughter and $1$ adult son per generation (so the average number of adult daughters per mother is $1$), consistent with Fisher’s equal-investment principle under density regulation.\n\nA rare maternally inherited symbiont appears that induces thelytokous parthenogenesis in infected females. An infected female produces only daughters, and each daughter independently inherits the symbiont from her mother with probability $t \\in (0,1]$. Infection imposes a multiplicative fitness cost $c \\in [0,1)$ on infected females such that, relative to an uninfected sexual female, the total number of viable adult offspring produced by an infected female is reduced by a factor of $(1-c)$. There is no paternal or horizontal transmission, mating is not required for infected females, and density regulation continues to maintain the resident demographic equilibrium as the symbiont remains rare.\n\nStarting only from these fundamental principles and definitions (maternally inherited transmission, equal sex ratio equilibrium in sexuals, and demographic equilibrium implying one adult daughter per sexual mother on average), derive the closed-form expression for the critical cost function $c^{*}(t)$ such that the symbiont increases in frequency from rarity if and only if $c < c^{*}(t)$. Provide $c^{*}(t)$ as a single analytic expression. No numerical approximation is required and no units are involved.", "solution": "The problem requires the derivation of a critical cost function $c^{*}(t)$ for the invasion of a parthenogenesis-inducing symbiont. The invasion analysis will be based on comparing the reproductive rate of the rare infected lineage to that of the resident uninfected lineage.\n\nLet us define the per-capita, per-generation growth rate of a lineage as the average number of female offspring produced by a single female that survive to reproductive age and belong to the same lineage. The symbiont will successfully invade (i.e., increase in frequency when rare) if the growth rate of the infected female lineage, $\\lambda_{I}$, is greater than the growth rate of the resident uninfected (sexual) female lineage, $\\lambda_{U}$. The condition for invasion is $\\lambda_{I} > \\lambda_{U}$.\n\nFirst, we determine the growth rate of the resident uninfected lineage, $\\lambda_{U}$. The problem states that the host population is at a demographic equilibrium where a sexual female produces, on average, $1$ adult daughter. This implies that each uninfected mother exactly replaces herself in the next generation in terms of female offspring. Therefore, the growth rate of the uninfected female lineage is:\n$$\n\\lambda_{U} = 1\n$$\n\nNext, we must determine the growth rate of the infected lineage, $\\lambda_{I}$. This is the expected number of infected daughters produced by a single infected female. We can calculate this as follows:\n\n1.  An uninfected sexual female produces $1$ adult daughter and $1$ adult son. Her total number of viable adult offspring is therefore $1 + 1 = 2$.\n2.  The problem states that infection imposes a multiplicative fitness cost $c \\in [0,1)$, reducing the total number of viable adult offspring by a factor of $(1-c)$ relative to an uninfected female. So, the total number of adult offspring produced by an infected female is $2(1-c)$.\n3.  Infected females are thelytokous and produce only daughters. Thus, an infected female produces $2(1-c)$ adult daughters.\n4.  The symbiont is transmitted vertically from mother to daughter with a probability $t \\in (0,1]$. Therefore, the expected number of *infected* daughters produced by an infected mother is the total number of daughters multiplied by the transmission probability.\n\nThis gives the per-capita growth rate for the infected lineage:\n$$\n\\lambda_{I} = (2(1-c)) \\times t = 2t(1-c)\n$$\n\nThe condition for the symbiont to increase in frequency from rarity is $\\lambda_{I} > \\lambda_{U}$. Substituting the expressions for the growth rates, we get:\n$$\n2t(1-c) > 1\n$$\nThis inequality shows that the symbiont invades if the cost of infection, $c$, is sufficiently low. The problem asks for the critical cost, $c^{*}(t)$, such that invasion occurs if and only if $c < c^{*}(t)$. This critical value is found at the boundary where the inequality becomes an equality, representing the point where the infected lineage has the same growth rate as the uninfected lineage.\n$$\n2t(1-c^{*}(t)) = 1\n$$\nWe now solve this equation for $c^{*}(t)$ to obtain the critical cost function.\n$$\n1 - c^{*}(t) = \\frac{1}{2t}\n$$\n$$\nc^{*}(t) = 1 - \\frac{1}{2t}\n$$\nThis expression is the critical cost. If the actual cost $c$ is less than $c^{*}(t)$, the per-capita growth rate of the infected lineage will be greater than $1$, and the symbiont will spread. If $c$ is greater than or equal to $c^{*}(t)$, the symbiont will not spread. For invasion to be possible at all with a non-negative cost ($c \\ge 0$), we must have $c^{*}(t) > 0$, which implies $1 - \\frac{1}{2t} > 0$, or $t > \\frac{1}{2}$. If the transmission efficiency $t$ is not greater than $\\frac{1}{2}$, the symbiont cannot overcome the cost of males even if the direct fitness cost $c$ is zero. The derived expression for $c^{*}(t)$ correctly accounts for this threshold behavior across the entire domain of $t$.", "answer": "$$\n\\boxed{1 - \\frac{1}{2t}}\n$$", "id": "2595272"}, {"introduction": "Parthenogenetic development begins with a critical cellular event: the activation of the oocyte in the absence of a sperm, a process typically driven by specific patterns of intracellular calcium ($\\mathrm{Ca}^{2+}$) signaling. This final hands-on practice guides you through building a computational biophysical model to simulate these calcium dynamics. By doing so, you will predict whether an artificial stimulus can successfully trigger oocyte activation, bridging the gap between molecular physiology and organismal reproduction [@problem_id:2595294].", "problem": "Construct a minimal, biophysically grounded model of calcium-induced calcium release in an animal oocyte to predict conditions for exit from metaphase arrest without fertilization. Your derivation must begin from mass balance and well-tested kinetic motifs for channel gating and pumping, and culminate in a computational implementation that decides, from simulated cytosolic calcium time series, whether the activation stimulus is sufficient to trigger exit. The final program must numerically solve the model and evaluate a decision criterion across a specified test suite, producing a single-line output exactly as described at the end.\n\nBiophysical and mathematical foundations to use:\n- Let the cytosolic free calcium concentration be denoted by $c$ in units of $\\mu \\mathrm{M}$ and the fraction of non-inactivated channels by $h$ (dimensionless, $0 \\le h \\le 1$). Let the endoplasmic reticulum (ER) act as the intracellular calcium store, with $c_{\\mathrm{ER}}$ representing its free calcium concentration in $\\mu \\mathrm{M}$.\n- Assume calcium flux balance for the cytosol: time rate of change $\\frac{dc}{dt}$ equals ER-to-cytosol release flux plus ER leak minus pump uptake into ER plus plasma membrane influx minus plasma membrane efflux. Time is in seconds.\n- Represent inositol $1,4,5$-trisphosphate (IP3) receptor channel opening by a product of an activation gate at quasi-steady state and an inactivation gate $h$ following first-order relaxation. Use Hill-type steady-state activation and an inactivation gate that relaxes toward a calcium-dependent steady-state with a calcium-dependent time constant; these are standard approximations derived from the De Young–Keizer formalism.\n- Conserve total intracellular calcium up to plasma membrane exchange by expressing $c_{\\mathrm{ER}}$ via a volume-ratio constraint $c_{\\mathrm{ER}} = \\frac{c_0 - c}{c_1}$, where $c_0$ is the total free calcium equivalent (in $\\mu \\mathrm{M}$) and $c_1$ is the cytosol-to-ER volume ratio (dimensionless). This conservation is respected by internal fluxes and only violated by plasma membrane influx and efflux terms.\n\nUsing these foundations, construct the following minimal model with fixed parameter values unless varied in the test suite:\n- Cytosolic calcium dynamics:\n$$\n\\frac{dc}{dt} = J_{\\mathrm{chan}}(c,h,i) + J_{\\mathrm{leak}}(c,i) - J_{\\mathrm{pump}}(c) + J_{\\mathrm{in}} - k_{\\mathrm{out}}\\,c,\n$$\nwhere $i$ denotes the IP3 concentration in $\\mu \\mathrm{M}$, $J_{\\mathrm{in}}$ is a constant influx in $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$, and $k_{\\mathrm{out}}$ is the first-order efflux rate in $\\mathrm{s}^{-1}$.\n- Channel-mediated release and ER leak:\n$$\nJ_{\\mathrm{chan}} = v_1\\,m_{\\infty}(c,i)^3\\,h^3\\,(c_{\\mathrm{ER}} - c),\\quad\nJ_{\\mathrm{leak}} = v_2\\,(c_{\\mathrm{ER}} - c),\n$$\nwith\n$$\nm_{\\infty}(c,i) = \\frac{i}{i + d_1}\\cdot \\frac{c}{c + d_5},\\quad c_{\\mathrm{ER}} = \\frac{c_0 - c}{c_1}.\n$$\n- Pump uptake into ER (Sarco/Endoplasmic Reticulum Calcium Adenosine Triphosphatase (SERCA)):\n$$\nJ_{\\mathrm{pump}} = v_3\\,\\frac{c^2}{k_p^2 + c^2}.\n$$\n- Channel inactivation gate:\n$$\n\\frac{dh}{dt} = \\frac{h_{\\infty}(c,i) - h}{\\tau_h(c,i)},\\quad\nh_{\\infty}(c,i) = \\frac{Q_2(i)}{Q_2(i) + c},\\quad\n\\tau_h(c,i) = \\frac{1}{a_2\\,(Q_2(i) + c)},\n$$\nwhere $Q_2(i) = d_2\\,\\frac{i + d_1}{i + d_3}$.\n- Fixed default parameters (units in parentheses) for animal oocytes:\n  - $c_0 = 2.0$ ($\\mu \\mathrm{M}$), $c_1 = 0.185$ (dimensionless).\n  - $v_1 = 6.0$ ($\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$), $v_2 = 0.11$ ($\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$), $v_3 = 0.9$ ($\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$), $k_p = 0.1$ ($\\mu \\mathrm{M}$).\n  - $a_2 = 0.2$ ($\\mu \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$), $d_1 = 0.13$ ($\\mu \\mathrm{M}$), $d_2 = 1.049$ ($\\mu \\mathrm{M}$), $d_3 = 0.943$ ($\\mu \\mathrm{M}$), $d_5 = 0.082$ ($\\mu \\mathrm{M}$).\n  - $k_{\\mathrm{out}} = 0.02$ ($\\mathrm{s}^{-1}$) unless varied.\n  - Initial conditions: $c(0) = 0.1$ ($\\mu \\mathrm{M}$), $h(0) = h_{\\infty}(c(0),i)$.\n- Treat IP3 concentration $i$ and plasma membrane calcium influx $J_{\\mathrm{in}}$ as proxies for artificial parthenogenetic stimuli (e.g., ionophore, strontium).\n\nActivation criterion for metaphase exit without fertilization:\n- It is well-supported that repetitive calcium transients trigger exit from metaphase arrest in animal oocytes. Define success if either of the following holds over a simulation window of length $T_{\\mathrm{end}}$ (in seconds):\n  - At least $N_{\\min}$ distinct peaks in $c(t)$ with peak values strictly greater than a threshold $c_{\\mathrm{thr}}$ (in $\\mu \\mathrm{M}$), or\n  - The time-integrated excess calcium above $c_{\\mathrm{base}}$ exceeds an area threshold $A_{\\min}$:\n  $$\n  \\int_{0}^{T_{\\mathrm{end}}} \\max\\{c(t) - c_{\\mathrm{base}},\\,0\\}\\,dt \\ge A_{\\min}.\n  $$\n- Use $T_{\\mathrm{end}} = 1500$ ($\\mathrm{s}$), $N_{\\min} = 3$, $c_{\\mathrm{thr}} = 0.4$ ($\\mu \\mathrm{M}$), $c_{\\mathrm{base}} = 0.3$ ($\\mu \\mathrm{M}$), and $A_{\\min} = 60$ ($\\mu \\mathrm{M}\\cdot \\mathrm{s}$).\n- Peaks must be separated by at least $\\Delta t_{\\min} = 20$ ($\\mathrm{s}$) to be counted as distinct.\n\nNumerical requirements:\n- Integrate the system for $t \\in [0, T_{\\mathrm{end}}]$ using a suitable ordinary differential equation solver with absolute tolerance at most $10^{-9}$ and relative tolerance at most $10^{-6}$. Express time in seconds and concentration in $\\mu \\mathrm{M}$.\n- Compute the number of peaks and the area criterion as specified. The decision per test case is a boolean: true if the activation criterion is satisfied, false otherwise.\n\nTest suite:\n- Each test case specifies a tuple $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}})$ with units as above; all other parameters remain at defaults. Use the following $5$ cases:\n  - Case $1$: $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.5, 0.9, 0.02, 0.02)$.\n  - Case $2$: $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.2, 0.9, 0.02, 0.02)$.\n  - Case $3$: $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.5, 2.0, 0.02, 0.02)$.\n  - Case $4$: $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (1.0, 0.9, 0.02, 0.02)$.\n  - Case $5$: $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}}) = (0.5, 0.9, 0.0, 0.1)$.\n- For each case, simulate and output a boolean indicating whether the activation criterion is satisfied.\n\nFinal output format:\n- Your program should produce a single line of output containing a comma-separated Python-style list of booleans corresponding to the $5$ cases, in the same order as listed, e.g., \"[True,False,True,False,True]\". No additional text or whitespace is permitted in the output.", "solution": "The problem statement has been systematically evaluated against the criteria of scientific soundness, mathematical consistency, and objectivity. The proposed model is a well-established representation of intracellular calcium dynamics, based on the Li-Rinzel simplification of the De Young–Keizer model for the inositol $1,4,5$-trisphosphate (IP3) receptor. All parameters, initial conditions, simulation protocols, and evaluation criteria are specified unambiguously. The problem is therefore deemed valid, and a solution is constructed as follows.\n\nThe problem requires constructing and simulating a biophysical model for calcium dynamics in an animal oocyte to determine if parthenogenetic activation occurs under various stimulus conditions. The model is formulated as a system of two coupled ordinary differential equations (ODEs), which represents an initial value problem (IVP).\n\nThe state variables of the system are the cytosolic free calcium concentration, $c(t)$, and the fraction of non-inactivated IP3 receptor channels, $h(t)$. The system is described by the following equations:\n$$\n\\frac{dc}{dt} = J_{\\mathrm{chan}}(c,h,i) + J_{\\mathrm{leak}}(c,i) - J_{\\mathrm{pump}}(c) + J_{\\mathrm{in}} - k_{\\mathrm{out}}\\,c\n$$\n$$\n\\frac{dh}{dt} = \\frac{h_{\\infty}(c,i) - h}{\\tau_h(c,i)}\n$$\n\nThese equations are based on the principle of mass balance for cytosolic calcium. Each term represents a distinct biophysical process:\n\n1.  **ER-to-Cytosol Fluxes**:\n    -   $J_{\\mathrm{chan}} = v_1\\,m_{\\infty}(c,i)^3\\,h^3\\,(c_{\\mathrm{ER}} - c)$: This term represents calcium-induced calcium release (CICR) from the endoplasmic reticulum (ER) through IP3 receptor channels. The flux is proportional to the concentration gradient $(c_{\\mathrm{ER}} - c)$. The channel gating is a product of a fast activation process, $m_{\\infty}$, and a slow inactivation process, $h$. The activation gate $m_{\\infty}(c,i) = \\frac{i}{i + d_1}\\cdot \\frac{c}{c + d_5}$ depends on both the stimulus $i$ (IP3 concentration) and cytosolic calcium $c$, creating a positive feedback loop essential for excitability. The inactivation gate $h$ closes the channel at high calcium concentrations, providing the negative feedback required for oscillatory dynamics. The powers of $3$ are as specified in the problem statement. The ER calcium concentration, $c_{\\mathrm{ER}}$, is related to the cytosolic concentration $c$ via the conservation law $c_{\\mathrm{ER}} = (c_0 - c)/c_1$, where $c_0$ is the total system calcium and $c_1$ is the cytosol-to-ER volume ratio.\n    -   $J_{\\mathrm{leak}} = v_2\\,(c_{\\mathrm{ER}} - c)$: This is a passive leak of calcium from the ER into the cytosol, driven by the same concentration gradient.\n\n2.  **Cytosol-to-ER Flux**:\n    -   $J_{\\mathrm{pump}} = v_3\\,\\frac{c^2}{k_p^2 + c^2}$: This term models the active transport of calcium from the cytosol back into the ER by SERCA pumps. It is described by a Hill equation, indicating cooperative binding of calcium to the pump. This process is the primary mechanism for restoring low basal calcium levels after a transient.\n\n3.  **Plasma Membrane Fluxes**:\n    -   $J_{\\mathrm{in}} - k_{\\mathrm{out}}\\,c$: These terms represent calcium exchange with the extracellular environment. $J_{\\mathrm{in}}$ is a constant influx, while $k_{\\mathrm{out}}\\,c$ is a first-order efflux, representing extrusion by pumps like the PMCA.\n\n4.  **Inactivation Gate Dynamics**:\n    -   The ODE for $h$ describes its relaxation towards a calcium-dependent steady state $h_{\\infty}(c,i) = \\frac{Q_2(i)}{Q_2(i) + c}$ with a time constant $\\tau_h(c,i) = \\frac{1}{a_2\\,(Q_2(i) + c)}$. The function $Q_2(i) = d_2\\,\\frac{i + d_1}{i + d_3}$ encapsulates the modulatory effect of IP3 on the inactivation process. This slow negative feedback is crucial for generating sustained oscillations.\n\nThe solution strategy involves the following steps for each test case:\n1.  **Initialization**: The parameters for the specific test case $(i, v_3, J_{\\mathrm{in}}, k_{\\mathrm{out}})$ are set. The initial state vector $[c(0), h(0)]$ is determined. $c(0) = 0.1\\,\\mu\\mathrm{M}$ is fixed, and $h(0)$ is calculated as $h_{\\infty}(c(0), i)$ to ensure the inactivation gate starts at its quasi-steady state.\n2.  **Numerical Integration**: The system of ODEs is numerically solved over the time interval $[0, T_{\\mathrm{end}}]$ with $T_{\\mathrm{end}} = 1500\\,\\mathrm{s}$. We use the `solve_ivp` function from the `scipy.integrate` library, which is a robust solver for initial value problems. To ensure accuracy and stability, especially given the potential for stiffness, the 'LSODA' method is chosen. Tolerances are set to $rtol=10^{-6}$ and $atol=10^{-9}$ as required. The solution is evaluated at a fine grid of time points to allow for accurate subsequent analysis.\n3.  **Evaluation of Activation Criteria**: The resulting time series for $c(t)$ is analyzed to determine if metaphase exit is triggered. This decision is based on two criteria:\n    -   **Peak Count**: The number of distinct calcium peaks exceeding a threshold $c_{\\mathrm{thr}} = 0.4\\,\\mu\\mathrm{M}$ is counted. The `find_peaks` function from `scipy.signal` is used for this purpose. A minimum temporal separation of $\\Delta t_{\\min} = 20\\,\\mathrm{s}$ is enforced to count peaks as distinct. If the count is at least $N_{\\min}=3$, this criterion is met.\n    -   **Integrated Calcium**: The time-integrated excess calcium above a baseline $c_{\\mathrm{base}} = 0.3\\,\\mu\\mathrm{M}$ is computed using the trapezoidal rule (`numpy.trapz`). If this integral, $\\int_{0}^{T_{\\mathrm{end}}} \\max\\{c(t) - c_{\\mathrm{base}},\\,0\\}\\,dt$, exceeds the threshold $A_{\\min} = 60\\,\\mu\\mathrm{M}\\cdot\\mathrm{s}$, this criterion is met.\n4.  **Decision**: A test case results in successful activation if either the peak count criterion or the integrated calcium criterion is satisfied. The final output is a boolean value (`True` or `False`) for each case.\n\nThe provided Python code implements this complete workflow. It defines the model equations, sets up the parameters for each test case, calls the ODE solver, and applies the decision logic to the simulation results, producing the final list of booleans in the specified format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Solves the calcium dynamics model for oocyte activation and evaluates\n    the activation criteria across a suite of test cases.\n    \"\"\"\n\n    # Default model parameters\n    default_params = {\n        'c0': 2.0,    # muM\n        'c1': 0.185,  # dimensionless\n        'v1': 6.0,    # muM/s\n        'v2': 0.11,   # muM/s\n        'kp': 0.1,    # muM\n        'a2': 0.2,    # 1/(muM*s)\n        'd1': 0.13,   # muM\n        'd2': 1.049,  # muM\n        'd3': 0.943,  # muM\n        'd5': 0.082,  # muM\n    }\n\n    # Test cases: (i, v3, J_in, k_out)\n    test_cases = [\n        (0.5, 0.9, 0.02, 0.02),\n        (0.2, 0.9, 0.02, 0.02),\n        (0.5, 2.0, 0.02, 0.02),\n        (1.0, 0.9, 0.02, 0.02),\n        (0.5, 0.9, 0.0, 0.1),\n    ]\n\n    # Activation criterion parameters\n    T_end = 1500.0         # s\n    N_min = 3              # count\n    c_thr = 0.4            # muM\n    delta_t_min = 20.0     # s\n    c_base = 0.3           # muM\n    A_min = 60.0           # muM*s\n\n    # Initial condition for cytosolic calcium\n    c_initial = 0.1        # muM\n\n    # Time points for ODE solver output\n    t_eval_step = 0.5      # s\n    t_eval = np.arange(0, T_end + t_eval_step, t_eval_step)\n\n    results = []\n    for case in test_cases:\n        i, v3_case, J_in_case, k_out_case = case\n\n        params = default_params.copy()\n        params['i'] = i\n        params['v3'] = v3_case\n        params['J_in'] = J_in_case\n        params['k_out'] = k_out_case\n\n        # Calculate initial h based on steady-state at t=0\n        Q2_initial = params['d2'] * (i + params['d1']) / (i + params['d3'])\n        h_initial = Q2_initial / (Q2_initial + c_initial)\n        \n        y0 = [c_initial, h_initial]\n\n        # Numerically integrate the system of ODEs\n        sol = solve_ivp(\n            model_rhs, \n            (0, T_end), \n            y0, \n            args=(params,), \n            t_eval=t_eval, \n            method='LSODA', # Robust for potentially stiff problems\n            rtol=1e-6, \n            atol=1e-9\n        )\n        \n        t = sol.t\n        c_series = sol.y[0]\n\n        # --- Evaluate activation criteria ---\n\n        # 1. Peak count criterion\n        distance_samples = int(delta_t_min / t_eval_step)\n        peaks, _ = find_peaks(c_series, height=c_thr, distance=distance_samples)\n        num_peaks = len(peaks)\n        peak_criterion_met = (num_peaks >= N_min)\n\n        # 2. Integrated calcium criterion\n        integrand = np.maximum(c_series - c_base, 0)\n        area = np.trapz(integrand, t)\n        area_criterion_met = (area >= A_min)\n\n        # Final decision for the case\n        activation_achieved = peak_criterion_met or area_criterion_met\n        results.append(activation_achieved)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef model_rhs(t, y, params):\n    \"\"\"\n    Defines the right-hand side of the ODE system for calcium dynamics.\n    \"\"\"\n    c, h = y\n    \n    # Unpack parameters\n    i = params['i']\n    c0, c1 = params['c0'], params['c1']\n    v1, v2, v3, kp = params['v1'], params['v2'], params['v3'], params['kp']\n    a2, d1, d2, d3, d5 = params['a2'], params['d1'], params['d2'], params['d3'], params['d5']\n    J_in, k_out = params['J_in'], params['k_out']\n    \n    # Algebraic relations\n    c_ER = (c0 - c) / c1\n    \n    # Positive feedback activation\n    m_inf = (i / (i + d1)) * (c / (c + d5))\n    \n    # Inactivation dynamics\n    Q2 = d2 * (i + d1) / (i + d3)\n    h_inf = Q2 / (Q2 + c)\n    tau_h = 1.0 / (a2 * (Q2 + c))\n    \n    # Fluxes\n    J_chan = v1 * (m_inf**3) * (h**3) * (c_ER - c)\n    J_leak = v2 * (c_ER - c)\n    J_pump = v3 * (c**2) / (kp**2 + c**2)\n    \n    # Derivatives\n    dcdt = J_chan + J_leak - J_pump + J_in - k_out * c\n    dhdt = (h_inf - h) / tau_h\n    \n    return [dcdt, dhdt]\n\nsolve()\n```", "id": "2595294"}]}