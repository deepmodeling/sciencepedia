{"hands_on_practices": [{"introduction": "The concept of $\\mathrm{p}K_\\mathrm{a}$ is fundamental to predicting the behavior of acids and bases in solution. This practice moves beyond simply identifying acids as 'strong' or 'weak' and challenges you to use $\\mathrm{p}K_\\mathrm{a}$ values quantitatively. By calculating the equilibrium constant for a proton transfer reaction, you will develop a deeper intuition for how the relative acidity of two species dictates the thermodynamic favorability and direction of the reaction, a core principle governing countless biochemical processes. [@problem_id:2772450]", "problem": "A cytosolic microenvironment is modeled as an ideal aqueous solution at $25\\,^{\\circ}\\mathrm{C}$ in which proton transfer between conjugate acid-base pairs determines buffer directionality. Consider the proton transfer reaction\n$\\ce{NH4^+ + CH3COO^- => NH3 + CH3COOH}$,\nwhich interconverts the conjugate acid-base pairs $\\ce{NH4^+}/\\ce{NH3}$ and $\\ce{CH3COOH}/\\ce{CH3COO^-}$. You are given the acid dissociation constants via their negative base-$10$ logarithms (the $\\mathrm{p}K_\\mathrm{a}$ values): $\\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+}) = 9.25$ and $\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH}) = 4.76$, both at $25\\,^{\\circ}\\mathrm{C}$. Assume the ionic strength is sufficiently low that activity coefficients are approximately $1$, so that activities equal concentrations.\n\nStarting only from the fundamental definitions of the acid dissociation constant $K_\\mathrm{a}$ for aqueous acids and the equilibrium constant $K$ for a chemical reaction, derive an expression for the equilibrium constant $K$ of the reaction $\\ce{NH4^+ + CH3COO^- => NH3 + CH3COOH}$ in terms of the acid dissociation constants of the participating acids. Then evaluate $K$ numerically using the provided $\\mathrm{p}K_\\mathrm{a}$ values.\n\nExpress your final numerical answer as a dimensionless number rounded to $3$ significant figures.", "solution": "The task is to derive an expression for the equilibrium constant, $K$, for the proton transfer reaction:\n$$ \\ce{NH4^+ + CH3COO^- => NH3 + CH3COOH} $$\nand subsequently to calculate its numerical value at $25\\,^{\\circ}\\mathrm{C}$.\n\nAccording to the fundamental definition of the equilibrium constant for a reaction in an ideal aqueous solution, where activities are approximated by molar concentrations, $K$ is expressed as:\n$$ K = \\frac{[\\ce{NH3}][\\ce{CH3COOH}]}{[\\ce{NH4^+}][\\ce{CH3COO^-}]} $$\nThis expression can be separated into a product of two concentration ratios:\n$$ K = \\left( \\frac{[\\ce{NH3}]}{[\\ce{NH4^+}]} \\right) \\left( \\frac{[\\ce{CH3COOH}]}{[\\ce{CH3COO^-}]} \\right) $$\n\nTo proceed with the derivation, we must introduce the definitions of the acid dissociation constants, $K_\\mathrm{a}$, for the two conjugate acid-base pairs involved.\n\nFirst, consider the acid dissociation of the ammonium ion, $\\ce{NH4^+}$, which is the acid in the $\\ce{NH4^+}/\\ce{NH3}$ pair:\n$$ \\ce{NH4^+ (aq) + H2O (l) => NH3 (aq) + H3O^+ (aq)} $$\nThe corresponding acid dissociation constant, which we denote as $K_{\\mathrm{a},1}$, is given by:\n$$ K_{\\mathrm{a},1} = K_\\mathrm{a}(\\ce{NH4^+}) = \\frac{[\\ce{NH3}][\\ce{H3O^+}]}{[\\ce{NH4^+}]} $$\nFrom this equation, we can express the first ratio needed for our expression for $K$:\n$$ \\frac{[\\ce{NH3}]}{[\\ce{NH4^+}]} = \\frac{K_\\mathrm{a}(\\ce{NH4^+})}{[\\ce{H3O^+}]} $$\n\nSecond, consider the acid dissociation of acetic acid, $\\ce{CH3COOH}$, which is the acid in the $\\ce{CH3COOH}/\\ce{CH3COO^-}$ pair:\n$$ \\ce{CH3COOH (aq) + H2O (l) => CH3COO^- (aq) + H3O^+ (aq)} $$\nThe corresponding acid dissociation constant, which we denote as $K_{\\mathrm{a},2}$, is given by:\n$$ K_{\\mathrm{a},2} = K_\\mathrm{a}(\\ce{CH3COOH}) = \\frac{[\\ce{CH3COO^-}][\\ce{H3O^+}]}{[\\ce{CH3COOH}]} $$\nFrom this equation, we can express the reciprocal of the second ratio needed for our expression for $K$:\n$$ \\frac{[\\ce{CH3COO^-}]}{[\\ce{CH3COOH}]} = \\frac{K_\\mathrm{a}(\\ce{CH3COOH})}{[\\ce{H3O^+}]} $$\nBy inverting this expression, we obtain the second ratio:\n$$ \\frac{[\\ce{CH3COOH}]}{[\\ce{CH3COO^-}]} = \\frac{[\\ce{H3O^+}]}{K_\\mathrm{a}(\\ce{CH3COOH})} $$\n\nNow, substitute the expressions for the two ratios back into the equation for the overall equilibrium constant $K$:\n$$ K = \\left( \\frac{K_\\mathrm{a}(\\ce{NH4^+})}{[\\ce{H3O^+}]} \\right) \\left( \\frac{[\\ce{H3O^+}]}{K_\\mathrm{a}(\\ce{CH3COOH})} \\right) $$\nThe concentration of the hydronium ion, $[\\ce{H3O^+}]$, appears in both the numerator and the denominator and therefore cancels. This leads to the final, derived expression for $K$ in terms of the individual acid dissociation constants:\n$$ K = \\frac{K_\\mathrm{a}(\\ce{NH4^+})}{K_\\mathrm{a}(\\ce{CH3COOH})} $$\nThis result is consistent with combining chemical equilibria: the overall reaction is equivalent to the dissociation of $\\ce{NH4^+}$ and the reverse of the dissociation of $\\ce{CH3COOH}$. The equilibrium constant is therefore the product of $K_\\mathrm{a}(\\ce{NH4^+})$ and $1/K_\\mathrm{a}(\\ce{CH3COOH})$.\n\nTo evaluate $K$ numerically, we use the provided $\\mathrm{p}K_\\mathrm{a}$ values: $\\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+}) = 9.25$ and $\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH}) = 4.76$. The definition of $\\mathrm{p}K_\\mathrm{a}$ is $\\mathrm{p}K_\\mathrm{a} = -\\log_{10}(K_\\mathrm{a})$, which implies $K_\\mathrm{a} = 10^{-\\mathrm{p}K_\\mathrm{a}}$.\n\nWe can express $K$ in terms of the $\\mathrm{p}K_\\mathrm{a}$ values:\n$$ K = \\frac{10^{-\\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+})}}{10^{-\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH})}} = 10^{\\mathrm{p}K_\\mathrm{a}(\\ce{CH3COOH}) - \\mathrm{p}K_\\mathrm{a}(\\ce{NH4^+})} $$\nSubstituting the given numerical values:\n$$ K = 10^{4.76 - 9.25} = 10^{-4.49} $$\nThe calculation yields:\n$$ K \\approx 3.2359365 \\times 10^{-5} $$\nThe problem requires that the final answer is rounded to $3$ significant figures.\n$$ K \\approx 3.24 \\times 10^{-5} $$\nThe value of $K$ is significantly less than $1$, which indicates that at equilibrium, the reactants ($\\ce{NH4^+}$ and $\\ce{CH3COO^-}$) are heavily favored over the products ($\\ce{NH3}$ and $\\ce{CH3COOH}$). This is expected, as the reaction involves the transfer of a proton from a weaker acid ($\\ce{NH4^+}$, with a higher $\\mathrm{p}K_\\mathrm{a}$) to the conjugate base of a stronger acid ($\\ce{CH3COOH}$, with a lower $\\mathrm{p}K_\\mathrm{a}$), which is a thermodynamically unfavorable process.", "answer": "$$\n\\boxed{3.24 \\times 10^{-5}}\n$$", "id": "2772450"}, {"introduction": "Biochemical reactions occur in the crowded and ion-rich environment of the cytosol, which is far from an ideal solution. This exercise highlights the critical distinction between concentration and chemical activity. You will quantify the error introduced by applying the common Henderson-Hasselbalch equation—which often implicitly assumes ideal behavior—to a physiological buffer system at high ionic strength, revealing the importance of electrostatic interactions in modulating buffer pH. [@problem_id:2772446]", "problem": "A cytosol-mimicking buffer consists of equimolar sodium dihydrogen phosphate and disodium hydrogen phosphate, so that the conjugate acid–base pair is $\\mathrm{H_{2}PO_{4}^{-}}$ and $\\mathrm{HPO_{4}^{2-}}$ at analytical concentrations $c_{\\mathrm{H_{2}PO_{4}^{-}}} = c_{\\mathrm{HPO_{4}^{2-}}}$ in a medium whose ionic strength is clamped at $I = 0.200\\ \\mathrm{M}$ by an inert supporting electrolyte. The temperature is $25^{\\circ}\\mathrm{C}$. Assume the thermodynamic acid dissociation constant (defined in terms of activities) is used, and neglect the contributions of $\\mathrm{H^{+}}$ and $\\mathrm{OH^{-}}$ to $I$.\n\nStarting only from the definitions of activity $a_{i} = \\gamma_{i} c_{i}$, the thermodynamic acid dissociation constant $K_\\mathrm{a}$ for a monoprotic acid, and the definition of $\\mathrm{pH}$, quantify the signed error $\\Delta \\mathrm{pH}$ introduced by replacing activities with concentrations in the Henderson–Hasselbalch relationship for this phosphate buffer at the stated ionic strength, where\n- $\\Delta \\mathrm{pH} \\equiv \\mathrm{pH}_{\\text{conc}} - \\mathrm{pH}_{\\text{act}}$,\n- $z_{\\mathrm{H_{2}PO_{4}^{-}}} = -1$ and $z_{\\mathrm{HPO_{4}^{2-}}} = -2$,\n- single-ion activity coefficients at ionic strength $I$ are described by the Davies equation\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right),\n$$\nwith $A = 0.509$ at $25^{\\circ}\\mathrm{C}$.\n\nExpress your final answer for $\\Delta \\mathrm{pH}$ as a signed decimal number in pH units (dimensionless), rounded to four significant figures.", "solution": "The goal is to compute the difference between the $\\mathrm{pH}$ predicted by a concentration-only substitution and the $\\mathrm{pH}$ predicted by the correct activity-based expression for the conjugate pair $\\mathrm{H_{2}PO_{4}^{-}}/\\mathrm{HPO_{4}^{2-}}$ at fixed ionic strength.\n\nBegin from the thermodynamic definition for the dissociation of a monoprotic acid $\\mathrm{HA} \\rightleftharpoons \\mathrm{H^{+}} + \\mathrm{A^{-}}$,\n$$\nK_\\mathrm{a} \\equiv \\frac{a_{\\mathrm{H^{+}}}\\, a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}, \\quad \\text{with} \\quad a_{i} = \\gamma_{i} c_{i}.\n$$\nBy definition, \n$$\n\\mathrm{pH} \\equiv -\\log_{10} a_{\\mathrm{H^{+}}}, \\quad \\mathrm{p}K_\\mathrm{a} \\equiv -\\log_{10} K_\\mathrm{a}.\n$$\nTaking $\\log_{10}$ of the $K_\\mathrm{a}$ expression and rearranging gives\n$$\n-\\log_{10} a_{\\mathrm{H^{+}}} = -\\log_{10} K_\\mathrm{a} + \\log_{10}\\!\\left(\\frac{a_{\\mathrm{HA}}}{a_{\\mathrm{A^{-}}}}\\right),\n$$\nwhich yields the activity-based Henderson–Hasselbalch form\n$$\n\\mathrm{pH}_{\\text{act}} = \\mathrm{p}K_\\mathrm{a} + \\log_{10}\\!\\left(\\frac{a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}\\right).\n$$\nIf, instead of activities, one substitutes concentrations, the predicted $\\mathrm{pH}$ would be\n$$\n\\mathrm{pH}_{\\text{conc}} = \\mathrm{p}K_\\mathrm{a} + \\log_{10}\\!\\left(\\frac{c_{\\mathrm{A^{-}}}}{c_{\\mathrm{HA}}}\\right).\n$$\nTherefore, the signed error is\n$$\n\\Delta \\mathrm{pH} \\equiv \\mathrm{pH}_{\\text{conc}} - \\mathrm{pH}_{\\text{act}} \n= \\log_{10}\\!\\left(\\frac{c_{\\mathrm{A^{-}}}}{c_{\\mathrm{HA}}}\\right) - \\log_{10}\\!\\left(\\frac{a_{\\mathrm{A^{-}}}}{a_{\\mathrm{HA}}}\\right)\n= -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{A^{-}}}}{\\gamma_{\\mathrm{HA}}}\\right).\n$$\nFor the phosphate buffer, identify $\\mathrm{A^{-}} \\equiv \\mathrm{HPO_{4}^{2-}}$ and $\\mathrm{HA} \\equiv \\mathrm{H_{2}PO_{4}^{-}}$. Under the stated condition $c_{\\mathrm{HPO_{4}^{2-}}} = c_{\\mathrm{H_{2}PO_{4}^{-}}}$, the concentration ratio cancels, so the error depends only on the ratio of single-ion activity coefficients:\n$$\n\\Delta \\mathrm{pH} = -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right).\n$$\n\nNext, compute the activity coefficients at $I = 0.200$ using the Davies equation,\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I \\right), \\quad A = 0.509.\n$$\nEvaluate the ionic-strength-dependent bracket term symbolically, then numerically:\n$$\nB(I) \\equiv \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\, I, \\quad \\text{so that} \\quad \\log_{10}\\gamma_{i} = -A z_{i}^{2} B(I).\n$$\nAt $I = 0.200$,\n$$\n\\frac{\\sqrt{I}}{1+\\sqrt{I}} \\approx 0.3090169944, \\quad 0.3\\, I = 0.3 \\times 0.200 = 0.060.\n$$\nNumerically,\n$$\nB(0.200) \\approx 0.3090169944 - 0.060 = 0.2490169944.\n$$\nThus,\n$$\n\\log_{10}\\gamma_{i} = -A z_{i}^{2} B(0.200) \\approx -0.509 \\times z_{i}^{2} \\times 0.2490169944.\n$$\nFor $\\mathrm{H_{2}PO_{4}^{-}}$ with $z = -1$,\n$$\n\\log_{10}\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}} \\approx -0.509 \\times 1 \\times 0.2490169944 = -0.1267496501.\n$$\nFor $\\mathrm{HPO_{4}^{2-}}$ with $z = -2$,\n$$\n\\log_{10}\\gamma_{\\mathrm{HPO_{4}^{2-}}} \\approx -0.509 \\times 4 \\times 0.2490169944 = -0.5069986004.\n$$\nThe logarithm of their ratio is\n$$\n\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right) = \\log_{10}\\gamma_{\\mathrm{HPO_{4}^{2-}}} - \\log_{10}\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}} \\approx -0.5069986004 - (-0.1267496501) = -0.3802489503.\n$$\nHence, the signed error is\n$$\n\\Delta \\mathrm{pH} = -\\log_{10}\\!\\left(\\frac{\\gamma_{\\mathrm{HPO_{4}^{2-}}}}{\\gamma_{\\mathrm{H_{2}PO_{4}^{-}}}}\\right) \\approx -(-0.3802489503) = 0.3802489503.\n$$\nInterpreting the sign, $\\Delta \\mathrm{pH}  0$ indicates that using concentrations instead of activities overestimates $\\mathrm{pH}$ for this buffer at $I = 0.200$. Rounding to four significant figures gives\n$$\n\\Delta \\mathrm{pH} \\approx 0.3802.\n$$", "answer": "$$\\boxed{0.3802}$$", "id": "2772446"}, {"introduction": "Maintaining a stable intracellular pH is a dynamic, energy-consuming process, not a simple static equilibrium. This advanced practice integrates multiple concepts to build a computational model of cellular pH homeostasis. By describing ion transporter kinetics with mass-action and Michaelis-Menten models, you will solve for the steady-state intracellular pH that results from the balance of metabolic acid production and active transport, providing a systems-level perspective on physiological pH regulation. [@problem_id:2772402]", "problem": "You must write a complete and runnable program that computes steady-state cytosolic acidity (expressed as pH) by enforcing mass and charge balance under transporter-mediated proton-equivalent fluxes. The transport processes are the sodium/proton exchanger, the chloride/bicarbonate exchanger, and the vacuolar-type adenosine triphosphatase proton pump. Your program must implement the following scientific foundations and modeling assumptions, and then solve the steady-state problem numerically for a small test suite.\n\nFoundational base to be used (derive from these, do not assume any additional shortcut formulas):\n- Acid-base equilibrium for the carbon dioxide/bicarbonate system: assume rapid equilibration of carbon dioxide across the membrane and the Henderson–Hasselbalch relation with fixed carbon dioxide partial pressure. With carbon dioxide solubility coefficient $\\alpha_{\\mathrm{CO_2}}$ and partial pressure $P_{\\mathrm{CO_2}}$, extracellular and intracellular bicarbonate concentrations satisfy\n  $$\\mathrm{pH} = \\mathrm{p}K_\\mathrm{a} + \\log_{10}\\left(\\frac{[\\mathrm{HCO_3^-}]}{\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}}\\right).$$\n  Hence, given $\\mathrm{pH}$, $[\\mathrm{HCO_3^-}]$ is determined by $[\\mathrm{HCO_3^-}] = \\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}} \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_\\mathrm{a}}$. All concentrations in this problem are to be treated in $\\mathrm{mM}$ and $\\mathrm{pH}$ is unitless.\n\n- Reversible mass-action kinetics for electroneutral $1:1$ exchangers: for a general exchanger $A_{\\mathrm{out}} + B_{\\mathrm{in}} \\rightleftharpoons A_{\\mathrm{in}} + B_{\\mathrm{out}}$, the net molar flux density is proportional to the difference in the products of the driving reactant concentrations on each side:\n  $$J = g\\left([A]_{\\mathrm{out}}[B]_{\\mathrm{in}} - [A]_{\\mathrm{in}}[B]_{\\mathrm{out}}\\right),$$\n  where $g$ is a phenomenological conductance-like coefficient with appropriate units. Apply this law to the sodium/proton exchanger ($\\mathrm{Na^+/H^+}$, exchanging one extracellular $\\mathrm{Na^+}$ for one intracellular $\\mathrm{H^+}$) and to the chloride/bicarbonate exchanger ($\\mathrm{Cl^-/HCO_3^-}$, exchanging one extracellular $\\mathrm{Cl^-}$ for one intracellular $\\mathrm{HCO_3^-}$). Assume both exchangers are electroneutral and unaffected directly by the membrane potential.\n\n- Saturable active transport for the vacuolar-type adenosine triphosphatase proton pump: model the outward proton pumping as a Michaelis–Menten-like process depending on intracellular free proton concentration,\n  $$J_{\\mathrm{V}} = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}}{K + [\\mathrm{H^+}]_{\\mathrm{in}}}.$$\n\n- Proton-equivalent mass balance at steady state: define the sign convention that a positive value of a contribution increases intracellular free proton concentration. Let $J_{\\mathrm{met}}$ be a constant intracellular proton production rate (metabolic acid load). Let $J_{\\mathrm{NHE}}$ denote the net $\\mathrm{Na^+/H^+}$ exchange molar flux density defined by the mass-action model with $A=\\mathrm{Na^+}$ and $B=\\mathrm{H^+}$, and let $J_{\\mathrm{AE}}$ denote the net $\\mathrm{Cl^-/HCO_3^-}$ exchange molar flux density defined by the mass-action model with $A=\\mathrm{Cl^-}$ and $B=\\mathrm{HCO_3^-}$. Because $\\mathrm{Na^+/H^+}$ exports $\\mathrm{H^+}$ when it runs forward and the vacuolar-type adenosine triphosphatase exports $\\mathrm{H^+}$, while $\\mathrm{Cl^-/HCO_3^-}$ imports base that neutralizes one proton per bicarbonate entering, the steady-state condition is\n  $$0 = J_{\\mathrm{met}} - J_{\\mathrm{NHE}} - J_{\\mathrm{V}} - J_{\\mathrm{AE}},$$\n  where $J_{\\mathrm{AE}}$ is understood as the bicarbonate influx defined by the chloride/bicarbonate exchanger mass-action term (so that it reduces intracellular proton concentration when positive).\n\n- Cytosolic electroneutrality: include a single, non-reactive, impermeant intracellular anion $[\\mathrm{A^-}]_{\\mathrm{in}}$ to capture fixed negative charge (proteins and metabolites). You must enforce the algebraic charge balance\n  $$[\\mathrm{Na^+}]_{\\mathrm{in}} + [\\mathrm{K^+}]_{\\mathrm{in}} + [\\mathrm{H^+}]_{\\mathrm{in}} = [\\mathrm{Cl^-}]_{\\mathrm{in}} + [\\mathrm{HCO_3^-}]_{\\mathrm{in}} + [\\mathrm{A^-}]_{\\mathrm{in}},$$\n  and you must compute $[\\mathrm{A^-}]_{\\mathrm{in}}$ from this relation after determining the steady-state $\\mathrm{pH}_{\\mathrm{in}}$. No osmotic balance is to be solved; treat all stated concentrations as parameters or algebraically implied variables from the above relations. Do not model or output the membrane potential.\n\nNumerical details to implement:\n- Use the Henderson–Hasselbalch relation above with $\\mathrm{p}K_\\mathrm{a} = 6.1$ (unitless), $\\alpha_{\\mathrm{CO_2}} = 0.03$ (in $\\mathrm{mM/mmHg}$), and $P_{\\mathrm{CO_2}} = 40$ (in $\\mathrm{mmHg}$) unless specified otherwise. Use $\\mathrm{pH}$ to compute $[\\mathrm{H^+}]$ via $[\\mathrm{H^+}] = 10^{-\\mathrm{pH}} \\times 1000$ to express $[\\mathrm{H^+}]$ in $\\mathrm{mM}$.\n\n- For each test case, compute the intracellular $\\mathrm{pH}$ by solving the steady-state equation for $\\mathrm{pH}_{\\mathrm{in}}$ in a physically plausible interval. You must find a real root in the interval $\\mathrm{pH}_{\\mathrm{in}} \\in [5.5, 8.8]$ if possible; if the end values do not bracket a root, search for a bracket within that interval by sampling and then apply a robust bracketed root-finder. After finding $\\mathrm{pH}_{\\mathrm{in}}$, compute $[\\mathrm{A^-}]_{\\mathrm{in}}$ using the electroneutrality equation. You do not need to print $[\\mathrm{A^-}]_{\\mathrm{in}}$, but your implementation must compute it internally to validate the charge balance.\n\nTest suite (all concentrations in $\\mathrm{mM}$ unless units are explicitly stated; $\\mathrm{pH}$ is unitless):\n- Constants common to all test cases:\n  - $[\\mathrm{Na^+}]_{\\mathrm{out}} = 140$, $[\\mathrm{Na^+}]_{\\mathrm{in}} = 12$, $[\\mathrm{Cl^-}]_{\\mathrm{out}} = 110$, $[\\mathrm{Cl^-}]_{\\mathrm{in}} = 15$, $[\\mathrm{K^+}]_{\\mathrm{in}} = 140$, $\\alpha_{\\mathrm{CO_2}} = 0.03$ (in $\\mathrm{mM/mmHg}$), $P_{\\mathrm{CO_2}} = 40$ (in $\\mathrm{mmHg}$), $\\mathrm{p}K_\\mathrm{a} = 6.1$ (unitless).\n- Case $1$ (happy path): extracellular $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$.\n- Case $2$ (acidic extracellular boundary): extracellular $\\mathrm{pH}_{\\mathrm{out}} = 6.80$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$.\n- Case $3$ (vacuolar-type adenosine triphosphatase inhibited): extracellular $\\mathrm{pH}_{\\mathrm{out}} = 7.40$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 5\\times 10^{-6}$, $V_{\\max} = 0$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$.\n- Case $4$ (enhanced bicarbonate exchange with alkaline outside): extracellular $\\mathrm{pH}_{\\mathrm{out}} = 7.60$, $g_{\\mathrm{NHE}} = 5\\times 10^{-3}$, $g_{\\mathrm{AE}} = 2\\times 10^{-5}$, $V_{\\max} = 1\\times 10^{-4}$, $K = 1\\times 10^{-4}$, $J_{\\mathrm{met}} = 1\\times 10^{-6}$.\n\nRequired final output format:\n- Your program must produce a single line containing a Python-style list literal with the intracellular $\\mathrm{pH}$ values for the four test cases in order, each rounded to exactly four decimal places (unitless), for example, in the form \"[7.2105,7.0031,7.1120,7.3562]\". No other text should be printed.\n\nNotes:\n- All computations must be in $\\mathrm{mM}$ for concentrations, $\\mathrm{mmHg}$ for $P_{\\mathrm{CO_2}}$, and $\\mathrm{pH}$ is unitless.\n- Do not use any biological \"shortcuts\" beyond the principles stated. Implement the mass-action and Michaelis–Menten kinetic forms as given and enforce the conservation law and electroneutrality.", "solution": "The problem requires finding the steady-state intracellular pH ($\\mathrm{pH}_{\\mathrm{in}}$) by solving a nonlinear equation that represents the balance of proton-equivalent fluxes. The total flux, $F(\\mathrm{pH}_{\\mathrm{in}})$, must be zero at steady state:\n$$F(\\mathrm{pH}_{\\mathrm{in}}) = J_{\\mathrm{met}} - J_{\\mathrm{NHE}}(\\mathrm{pH}_{\\mathrm{in}}) - J_{\\mathrm{V}}(\\mathrm{pH}_{\\mathrm{in}}) - J_{\\mathrm{AE}}(\\mathrm{pH}_{\\mathrm{in}}) = 0$$\nwhere $J_{\\mathrm{met}}$ is the constant metabolic acid production, and $J_{\\mathrm{NHE}}$, $J_{\\mathrm{V}}$, and $J_{\\mathrm{AE}}$ are the proton-equivalent export fluxes from the three transporters. Let $x = \\mathrm{pH}_{\\mathrm{in}}$.\n\nThe components of the equation are defined as functions of $x$:\nFirst, intracellular concentrations that depend on $x$ are established using the provided constants ($\\mathrm{p}K_\\mathrm{a}=6.1$, $\\alpha_{\\mathrm{CO_2}}=0.03$, $P_{\\mathrm{CO_2}}=40$):\n- Intracellular proton concentration (in mM): $[\\mathrm{H^+}]_{\\mathrm{in}}(x) = 1000 \\cdot 10^{-x}$\n- Intracellular bicarbonate concentration (in mM): $[\\mathrm{HCO_3^-}]_{\\mathrm{in}}(x) = (\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}) \\cdot 10^{x - \\mathrm{p}K_\\mathrm{a}}$\n\nExtracellular concentrations are constant for each test case, determined by the given $\\mathrm{pH}_{\\mathrm{out}}$:\n- Extracellular proton concentration (in mM): $[\\mathrm{H^+}]_{\\mathrm{out}} = 1000 \\cdot 10^{-\\mathrm{pH}_{\\mathrm{out}}}$\n- Extracellular bicarbonate concentration (in mM): $[\\mathrm{HCO_3^-}]_{\\mathrm{out}} = (\\alpha_{\\mathrm{CO_2}} P_{\\mathrm{CO_2}}) \\cdot 10^{\\mathrm{pH}_{\\mathrm{out}} - \\mathrm{p}K_\\mathrm{a}}$\n\nNext, the three transporter fluxes are defined as functions of $x$:\n1.  **NHE flux ($J_{\\mathrm{NHE}}$):** This is the net export of $\\mathrm{H^+}$ via the $\\mathrm{Na^+/H^+}$ exchanger, modeled by mass-action kinetics.\n    $$J_{\\mathrm{NHE}}(x) = g_{\\mathrm{NHE}} \\left( [\\mathrm{Na^+}]_{\\mathrm{out}}[\\mathrm{H^+}]_{\\mathrm{in}}(x) - [\\mathrm{Na^+}]_{\\mathrm{in}}[\\mathrm{H^+}]_{\\mathrm{out}} \\right)$$\n2.  **V-ATPase flux ($J_{\\mathrm{V}}$):** This is the net export of $\\mathrm{H^+}$ via the proton pump, modeled by Michaelis-Menten kinetics.\n    $$J_{\\mathrm{V}}(x) = V_{\\max} \\frac{[\\mathrm{H^+}]_{\\mathrm{in}}(x)}{K + [\\mathrm{H^+}]_{\\mathrm{in}}(x)}$$\n3.  **AE flux ($J_{\\mathrm{AE}}$):** This represents the proton-equivalent export flux due to bicarbonate influx via the $\\mathrm{Cl^-/HCO_3^-}$ exchanger. The problem specifies this as a bicarbonate influx, so the mass-action law for the reaction $\\mathrm{Cl^-_{in}} + \\mathrm{HCO_3^-_{out}} \\rightleftharpoons \\mathrm{Cl^-_{out}} + \\mathrm{HCO_3^-_{in}}$ is used.\n    $$J_{\\mathrm{AE}}(x) = g_{\\mathrm{AE}} \\left( [\\mathrm{Cl^-}]_{\\mathrm{in}}[\\mathrm{HCO_3^-}]_{\\mathrm{out}} - [\\mathrm{Cl^-}]_{\\mathrm{out}}[\\mathrm{HCO_3^-}]_{\\mathrm{in}}(x) \\right)$$\n\nFor each test case, the specific parameters are substituted into these expressions to define the function $F(x)$. Since $F(x)$ is a monotonic function of $x$ on the specified domain, its root can be reliably found using a numerical bracketed root-finding algorithm (e.g., Brent's method) within the interval $x \\in [5.5, 8.8]$. The provided code implements this procedure to calculate the steady-state $\\mathrm{pH}_{\\mathrm{in}}$ for each of the four cases. After finding the root, the concentration of the impermeant anion, $[\\mathrm{A^-}]_{\\mathrm{in}}$, is calculated using the electroneutrality equation to complete the model, although this value is not part of the required output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the steady-state intracellular pH for a cell model with three\n    primary ion transporters, solving a nonlinear equation for proton balance.\n    \"\"\"\n\n    # Common parameters for all test cases as specified in the problem.\n    # All concentrations are in mM.\n    common_params = {\n        'na_out': 140.0,\n        'na_in': 12.0,\n        'cl_out': 110.0,\n        'cl_in': 15.0,\n        'k_in': 140.0,\n        'alpha_co2': 0.03,  # mM/mmHg\n        'p_co2': 40.0,      # mmHg\n        'pka': 6.1,\n    }\n\n    # Test cases with their specific parameters.\n    test_cases = [\n        # Case 1: Happy path\n        {'ph_out': 7.40, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 2: Acidic extracellular boundary\n        {'ph_out': 6.80, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 3: V-ATPase inhibited\n        {'ph_out': 7.40, 'g_nhe': 5e-3, 'g_ae': 5e-6, 'v_max': 0.0, 'k_pump': 1e-4, 'j_met': 1e-6},\n        # Case 4: Enhanced bicarbonate exchange with alkaline outside\n        {'ph_out': 7.60, 'g_nhe': 5e-3, 'g_ae': 2e-5, 'v_max': 1e-4, 'k_pump': 1e-4, 'j_met': 1e-6},\n    ]\n\n    results = []\n    \n    # pH range for root finding\n    ph_search_bracket = [5.5, 8.8]\n\n    for case_params in test_cases:\n        params = {**common_params, **case_params}\n\n        # Pre-calculate constants that depend on extracellular pH\n        h_out = 1000.0 * (10**(-params['ph_out']))\n        co2_product = params['alpha_co2'] * params['p_co2']\n        bicarb_out = co2_product * (10**(params['ph_out'] - params['pka']))\n\n        def balance_function(ph_in):\n            \"\"\"\n            This function represents the steady-state proton balance equation F(pH_in) = 0.\n            We solve for the root of this function.\n            F(pH_in) = J_met - J_NHE - J_V - J_AE = 0\n            \"\"\"\n            # Calculate intracellular concentrations based on ph_in\n            h_in = 1000.0 * (10**(-ph_in))\n            bicarb_in = co2_product * (10**(ph_in - params['pka']))\n\n            # Calculate flux for Na+/H+ exchanger (J_NHE)\n            j_nhe = params['g_nhe'] * (params['na_out'] * h_in - params['na_in'] * h_out)\n\n            # Calculate flux for V-ATPase proton pump (J_V)\n            j_v = params['v_max'] * h_in / (params['k_pump'] + h_in)\n\n            # Calculate flux for Cl-/HCO3- exchanger (J_AE), defined as bicarbonate influx\n            j_ae = params['g_ae'] * (params['cl_in'] * bicarb_out - params['cl_out'] * bicarb_in)\n            \n            return params['j_met'] - j_nhe - j_v - j_ae\n\n        # Solve for ph_in using a robust bracketed root-finder.\n        # The balance_function is monotonic, so brentq is highly reliable.\n        sol = root_scalar(balance_function, bracket=ph_search_bracket, method='brentq')\n        ph_in_steady_state = sol.root\n        results.append(ph_in_steady_state)\n\n        # Internal validation: Compute the required fixed anion concentration [A-]_in\n        # to ensure charge balance, as per the problem description. This is not for output.\n        h_in_final = 1000.0 * (10**(-ph_in_steady_state))\n        bicarb_in_final = co2_product * (10**(ph_in_steady_state - params['pka']))\n        a_in_final = (params['na_in'] + params['k_in'] + h_in_final) - \\\n                     (params['cl_in'] + bicarb_in_final)\n        # For a physically valid model, a_in_final should be positive.\n\n    # Format the output as a single line string according to the specification.\n    output_str = \"[\" + \",\".join(f\"{res:.4f}\" for res in results) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2772402"}]}