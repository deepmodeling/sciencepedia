{"hands_on_practices": [{"introduction": "The intrinsic strength of a hydrogen bond is often discussed in terms of gas-phase enthalpy, but in biological systems, these bonds exist within the competitive solvent environment of water. This exercise provides practice in connecting a macroscopic, experimentally measurable quantity—the equilibrium constant ($K$) for association—to the standard Gibbs free energy change ($\\Delta G^{\\circ}$). By performing this calculation, you will gain a quantitative appreciation for how solvent competition modulates the effective strength of hydrogen bonds that are critical for molecular recognition [@problem_id:2848206].", "problem": "In a dilute aqueous solution at temperature $T = 298 \\, \\mathrm{K}$, a phenolic hydrogen-bond donor ($\\mathrm{D}$) and a carbonyl oxygen acceptor ($\\mathrm{A}$) form a $1{:}1$ $\\mathrm{O-H \\cdots O}$ hydrogen-bonded complex ($\\mathrm{DA}$) according to the association reaction $\\mathrm{D} + \\mathrm{A} \\rightleftharpoons \\mathrm{DA}$. The experimentally determined equilibrium constant referenced to the standard concentration $c^{\\circ} = 1 \\, \\mathrm{M}$ is $K = 12.00$ (dimensionless). Using only fundamental thermodynamic definitions for chemical potentials, activities, and standard-state Gibbs free energy changes, determine the standard Gibbs free energy change $\\Delta G^{\\circ}$ for the association reaction at $T = 298 \\, \\mathrm{K}$. Express your final numerical result in $\\mathrm{kJ \\, mol^{-1}}$ and round your answer to four significant figures. Then, briefly interpret whether the magnitude you obtained is characteristic of a weak, moderate, or strong hydrogen-bond interaction in liquid water and what that implies about solvent competition.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is rooted in the fundamental principles of chemical thermodynamics and provides all necessary information to determine a unique and meaningful solution. We will therefore proceed with a rigorous derivation and calculation.\n\nThe central task is to determine the standard Gibbs free energy change, $\\Delta G^{\\circ}$, for the association reaction $\\mathrm{D} + \\mathrm{A} \\rightleftharpoons \\mathrm{DA}$ from the given equilibrium constant, $K$.\n\nThe chemical potential, $\\mu_i$, of a species $i$ in a dilute solution is given by the relation:\n$$\n\\mu_i = \\mu_i^{\\circ} + RT \\ln a_i\n$$\nwhere $\\mu_i^{\\circ}$ is the standard chemical potential, $R$ is the ideal gas constant, $T$ is the absolute temperature, and $a_i$ is the activity of species $i$. For a dilute solution, the activity is approximated by the ratio of the molar concentration, $[i]$, to the standard concentration, $c^{\\circ}$:\n$$\na_i \\approx \\frac{[i]}{c^{\\circ}}\n$$\nThe Gibbs free energy change, $\\Delta G$, for the reaction is the sum of the chemical potentials of the products minus the sum of the chemical potentials of the reactants, weighted by their stoichiometric coefficients (which are all $1$ in this case):\n$$\n\\Delta G = \\mu_{\\mathrm{DA}} - (\\mu_{\\mathrm{D}} + \\mu_{\\mathrm{A}})\n$$\nSubstituting the expression for chemical potential for each species:\n$$\n\\Delta G = (\\mu_{\\mathrm{DA}}^{\\circ} + RT \\ln a_{\\mathrm{DA}}) - ((\\mu_{\\mathrm{D}}^{\\circ} + RT \\ln a_{\\mathrm{D}}) + (\\mu_{\\mathrm{A}}^{\\circ} + RT \\ln a_{\\mathrm{A}}))\n$$\nThis expression can be rearranged by grouping the standard potential terms and the logarithmic terms:\n$$\n\\Delta G = (\\mu_{\\mathrm{DA}}^{\\circ} - \\mu_{\\mathrm{D}}^{\\circ} - \\mu_{\\mathrm{A}}^{\\circ}) + RT (\\ln a_{\\mathrm{DA}} - \\ln a_{\\mathrm{D}} - \\ln a_{\\mathrm{A}})\n$$\nThe first term in parentheses is, by definition, the standard Gibbs free energy change for the reaction, $\\Delta G^{\\circ}$:\n$$\n\\Delta G^{\\circ} = \\mu_{\\mathrm{DA}}^{\\circ} - \\mu_{\\mathrm{D}}^{\\circ} - \\mu_{\\mathrm{A}}^{\\circ}\n$$\nThe logarithmic terms can be combined into a single logarithm:\n$$\n\\Delta G = \\Delta G^{\\circ} + RT \\ln \\left( \\frac{a_{\\mathrm{DA}}}{a_{\\mathrm{D}} a_{\\mathrm{A}}} \\right)\n$$\nThe argument of the logarithm is the reaction quotient, $Q$. At chemical equilibrium, the Gibbs free energy change is zero ($\\Delta G = 0$), and the reaction quotient is equal to the equilibrium constant, $K$.\n$$\n0 = \\Delta G^{\\circ} + RT \\ln K\n$$\nThis yields the fundamental relationship between the standard Gibbs free energy change and the equilibrium constant:\n$$\n\\Delta G^{\\circ} = -RT \\ln K\n$$\nThe problem provides the necessary values:\n- Ideal gas constant, $R = 8.314\\ \\mathrm{J\\,K^{-1}mol^{-1}}$\n- Absolute temperature, $T = 298\\ \\mathrm{K}$\n- Equilibrium constant, $K = 12.00$\n\nWe can now substitute these values into the equation:\n$$\n\\Delta G^{\\circ} = - (8.314\\ \\mathrm{J\\,K^{-1}mol^{-1}}) \\times (298\\ \\mathrm{K}) \\times \\ln(12.00)\n$$\nFirst, we calculate the natural logarithm of $12.00$:\n$$\n\\ln(12.00) \\approx 2.4849066\n$$\nNow, we compute the product:\n$$\n\\Delta G^{\\circ} \\approx - (8.314 \\times 298) \\times 2.4849066\\ \\mathrm{J\\,mol^{-1}}\n$$\n$$\n\\Delta G^{\\circ} \\approx - (2477.572) \\times 2.4849066\\ \\mathrm{J\\,mol^{-1}}\n$$\n$$\n\\Delta G^{\\circ} \\approx -6156.66\\ \\mathrm{J\\,mol^{-1}}\n$$\nThe problem requires the result to be expressed in units of $\\mathrm{kJ\\,mol^{-1}}$. We perform the conversion:\n$$\n\\Delta G^{\\circ} \\approx -6156.66\\ \\mathrm{J\\,mol^{-1}} \\times \\frac{1\\ \\mathrm{kJ}}{1000\\ \\mathrm{J}} = -6.15666\\ \\mathrm{kJ\\,mol^{-1}}\n$$\nFinally, we round the result to four significant figures as instructed:\n$$\n\\Delta G^{\\circ} = -6.157\\ \\mathrm{kJ\\,mol^{-1}}\n$$\n\nFor the interpretation:\nThe negative sign of $\\Delta G^{\\circ}$ indicates that the formation of the hydrogen-bonded complex $\\mathrm{DA}$ is spontaneous under standard conditions ($1\\ \\mathrm{M}$ concentrations of all species) at $298\\ \\mathrm{K}$.\n\nThe magnitude of this value, approximately $-6.16\\ \\mathrm{kJ\\,mol^{-1}}$, is characteristic of a **weak** hydrogen-bond interaction in the context of an aqueous solution. This may seem counterintuitive, as the intrinsic enthalpy of an O–H$\\cdots$O hydrogen bond in the gas phase is typically in the range of $-20$ to $-25\\ \\mathrm{kJ\\,mol^{-1}}$ (a moderate strength). The key distinction is the presence of water as a solvent. The measured $\\Delta G^{\\circ}$ is a **net** free energy change for the transfer of the donor and acceptor from a fully solvated state into a complex. The process involves an energetically costly step: breaking the hydrogen bonds that the donor ($\\mathrm{D}$) and acceptor ($\\mathrm{A}$) have formed with the surrounding water molecules. The formation of the new D–A hydrogen bond must be only slightly more favorable than the sum of the D–water and A–water interactions it replaces. This phenomenon is known as **solvent competition**. The small magnitude of $\\Delta G^{\\circ}$ demonstrates that competition from the aqueous solvent is very strong and almost completely offsets the intrinsic stability of the D-A complex. In biological systems, such weak, readily reversible interactions are fundamental to the dynamic processes of life, such as enzyme-substrate binding and nucleic acid hybridization.", "answer": "$$\n\\boxed{-6.157}\n$$", "id": "2848206"}, {"introduction": "The notion that a neutral $\\mathrm{pH}$ is universally $7.0$ is a simplification that holds only at a specific reference temperature. Neutrality is fundamentally an electrostatic condition where the activities of hydronium and hydroxide ions are equal. This practice uses the van 't Hoff equation to demonstrate how the autoionization of water, an endothermic process, shifts with temperature, thereby changing the $\\mathrm{pH}$ of neutrality—a vital concept for studying biochemical processes under non-standard conditions [@problem_id:2848219].", "problem": "In ultra-pure liquid water, the autoprotolysis (self-ionization) equilibrium is\n$$2\\,\\mathrm{H_2O(l)} \\rightleftharpoons \\mathrm{H_3O^+(aq)} + \\mathrm{OH^-(aq)}.$$\nDefine the thermodynamic ion product of water as the equilibrium constant in terms of activities,\n$$K_w(T) \\equiv a_{\\mathrm{H_3O^+}}\\,a_{\\mathrm{OH^-}},$$\nwith the activity of the solvent water taken as unity by convention. The operational definition of acidity is the activity-based acidity function\n$$\\mathrm{pH} \\equiv -\\log_{10}\\!\\left(a_{\\mathrm{H_3O^+}}\\right),$$\nand neutrality is defined by the electrostatic condition of equal proton and hydroxide activities in pure water, $a_{\\mathrm{H_3O^+}} = a_{\\mathrm{OH^-}}$, at vanishing ionic strength where activity coefficients approach unity.\n\nOver modest temperature intervals, the temperature dependence of an equilibrium constant with temperature-independent standard reaction enthalpy $\\Delta H^\\circ$ is governed by the differential van ’t Hoff relation\n$$\\frac{d\\ln K}{dT}=\\frac{\\Delta H^\\circ}{R\\,T^2},$$\nwhere $R$ is the universal gas constant.\n\nAssume the following data, which are applicable for ultra-pure water between $T_1=298.15\\ \\mathrm{K}$ and $T_2=310.15\\ \\mathrm{K}$:\n- $pK_w(T_1)=14.0000$,\n- $\\Delta H^\\circ=\\;55.83\\ \\mathrm{kJ\\,mol^{-1}}$ (assumed constant over this range),\n- $R=8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nUsing only the definitions and relations stated above, and assuming activities equal concentrations in the infinite dilution limit of pure water, compute the neutral $\\mathrm{pH}$ of pure water at $T_2=310.15\\ \\mathrm{K}$. Round your final numerical result to four significant figures. Express the final $\\mathrm{pH}$ value as a pure number without units.\n\nThen, based on first principles and the sign of $\\Delta H^\\circ$ together with the definition of neutrality, explain succinctly why $\\mathrm{pH} = 7$ is not the neutral point at all temperatures.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of chemical thermodynamics, it is well-posed with a complete and consistent set of data and definitions, and it is expressed in objective, formal language free of any of the specified flaws. We may proceed to the solution.\n\nThe problem requires two distinct outputs: first, a numerical calculation of the neutral $\\mathrm{pH}$ of pure water at a temperature $T_2 = 310.15\\ \\mathrm{K}$, and second, a conceptual explanation for why the neutral $\\mathrm{pH}$ point is not universally equal to $7$.\n\nWe begin with the calculation. The temperature dependence of the equilibrium constant, in this case the ion product of water $K_w$, is given by the differential van ’t Hoff relation:\n$$ \\frac{d\\ln K_w}{dT}=\\frac{\\Delta H^\\circ}{R\\,T^2} $$\nHere, $\\Delta H^\\circ$ is the standard enthalpy of reaction, $R$ is the universal gas constant, and $T$ is the absolute temperature. The problem assumes $\\Delta H^\\circ$ is constant over the temperature interval from $T_1 = 298.15\\ \\mathrm{K}$ to $T_2 = 310.15\\ \\mathrm{K}$. We can therefore integrate this equation between the limits of $T_1$ and $T_2$:\n$$ \\int_{\\ln K_w(T_1)}^{\\ln K_w(T_2)} d\\ln K_w = \\int_{T_1}^{T_2} \\frac{\\Delta H^\\circ}{R\\,T^2} dT $$\n$$ \\ln K_w(T_2) - \\ln K_w(T_1) = \\frac{\\Delta H^\\circ}{R} \\int_{T_1}^{T_2} T^{-2} dT $$\nEvaluating the integral gives the integrated van 't Hoff equation:\n$$ \\ln\\left(\\frac{K_w(T_2)}{K_w(T_1)}\\right) = \\frac{\\Delta H^\\circ}{R} \\left[ -\\frac{1}{T} \\right]_{T_1}^{T_2} = \\frac{\\Delta H^\\circ}{R} \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) $$\nIt is more convenient to work with the $pX \\equiv -\\log_{10}(X)$ operator. The relationship between the natural logarithm and the base-$10$ logarithm is $\\ln(X) = \\ln(10) \\log_{10}(X)$, which implies $\\ln(K_w) = -\\ln(10) \\cdot pK_w$. Substituting this into the integrated equation yields:\n$$ -\\ln(10) \\cdot pK_w(T_2) - (-\\ln(10) \\cdot pK_w(T_1)) = \\frac{\\Delta H^\\circ}{R} \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) $$\nDividing by $-\\ln(10)$ and rearranging gives an expression for $pK_w(T_2)$:\n$$ pK_w(T_2) = pK_w(T_1) - \\frac{\\Delta H^\\circ}{R \\ln(10)} \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) $$\nThe condition for neutrality in pure water is defined by equal activities of the hydronium and hydroxide ions: $a_{\\mathrm{H_3O^+}} = a_{\\mathrm{OH^-}}$. Substituting this into the definition of the ion product, $K_w = a_{\\mathrm{H_3O^+}} a_{\\mathrm{OH^-}}$, we find that at neutrality, $K_w = (a_{\\mathrm{H_3O^+}})_{\\text{neutral}}^2$. We can relate this to $\\mathrm{pH}$ by taking the negative base-$10$ logarithm of both sides:\n$$ pK_w = -\\log_{10}\\left((a_{\\mathrm{H_3O^+}})_{\\text{neutral}}^2\\right) = -2\\log_{10}\\left((a_{\\mathrm{H_3O^+}})_{\\text{neutral}}\\right) $$\nFrom the definition $\\mathrm{pH} \\equiv -\\log_{10}(a_{\\mathrm{H_3O^+}})$, it follows that at neutrality:\n$$ pK_w = 2 \\cdot \\mathrm{pH}_{\\text{neutral}} \\implies \\mathrm{pH}_{\\text{neutral}} = \\frac{1}{2} pK_w $$\nThis fundamental result demonstrates that the neutral $\\mathrm{pH}$ is half the value of $pK_w$ at any given temperature. To find the neutral $\\mathrm{pH}$ at $T_2$, we first compute $pK_w(T_2)$ and then divide by $2$.\n$$ \\mathrm{pH}_{\\text{neutral}}(T_2) = \\frac{1}{2} pK_w(T_2) = \\frac{1}{2} \\left[ pK_w(T_1) - \\frac{\\Delta H^\\circ}{R \\ln(10)} \\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) \\right] $$\nWe now substitute the given numerical values: $pK_w(T_1) = 14.0000$; $\\Delta H^\\circ = 55.83\\ \\mathrm{kJ\\,mol^{-1}} = 55830\\ \\mathrm{J\\,mol^{-1}}$; $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$; $T_1 = 298.15\\ \\mathrm{K}$; and $T_2 = 310.15\\ \\mathrm{K}$.\nFirst, we evaluate the constant term:\n$$ \\frac{\\Delta H^\\circ}{R \\ln(10)} = \\frac{55830\\ \\mathrm{J\\,mol^{-1}}}{8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times \\ln(10)} \\approx 2916.196\\ \\mathrm{K} $$\nNext, the temperature-dependent term:\n$$ \\frac{1}{T_1} - \\frac{1}{T_2} = \\frac{1}{298.15\\ \\mathrm{K}} - \\frac{1}{310.15\\ \\mathrm{K}} \\approx 0.000129809\\ \\mathrm{K}^{-1} $$\nUsing these values, we calculate $pK_w(T_2)$:\n$$ pK_w(T_2) \\approx 14.0000 - (2916.196\\ \\mathrm{K}) \\times (0.000129809\\ \\mathrm{K}^{-1}) \\approx 14.0000 - 0.37855 \\approx 13.62145 $$\nThe neutral $\\mathrm{pH}$ at $T_2$ is therefore:\n$$ \\mathrm{pH}_{\\text{neutral}}(T_2) = \\frac{1}{2} pK_w(T_2) \\approx \\frac{13.62145}{2} \\approx 6.810725 $$\nRounding this result to four significant figures, as instructed, yields $6.811$.\n\nFor the second part, we explain why neutral $\\mathrm{pH}$ is not a constant value of $7$.\nThe neutrality of pure water is a thermodynamic state defined by the electrostatic condition $a_{\\mathrm{H_3O^+}} = a_{\\mathrm{OH^-}}$, not by the operational value $\\mathrm{pH} = 7$. As established, this physical condition implies that $\\mathrm{pH}_{\\text{neutral}} = \\frac{1}{2}pK_w$. The value of $pK_w$ is only equal to $14.0000$ at a specific reference temperature, which is $T \\approx 298.15\\ \\mathrm{K}$ ($25^\\circ \\mathrm{C}$).\nThe autoprotolysis reaction, $2\\,\\mathrm{H_2O(l)} \\rightleftharpoons \\mathrm{H_3O^+(aq)} + \\mathrm{OH^-(aq)}$, is an equilibrium process whose constant $K_w$ is temperature-dependent. This dependence is governed by the sign of the standard reaction enthalpy, $\\Delta H^\\circ$. The problem gives $\\Delta H^\\circ = 55.83\\ \\mathrm{kJ\\,mol^{-1}}$, which is positive. This signifies that the autoprotolysis of water is an endothermic process.\nAccording to Le Châtelier's principle—or, more formally, the van 't Hoff equation—an increase in temperature for an endothermic reaction will shift the equilibrium position to the right, favoring the formation of products. Therefore, as temperature rises, the equilibrium activities of $\\mathrm{H_3O^+}$ and $\\mathrm{OH^-}$ both increase. This leads to an increase in the value of the ion product, $K_w$.\nAn increase in $K_w$ necessarily causes a decrease in $pK_w$, because $pK_w = -\\log_{10}(K_w)$. Since the neutral $\\mathrm{pH}$ is directly proportional to $pK_w$ via $\\mathrm{pH}_{\\text{neutral}} = \\frac{1}{2}pK_w$, a decrease in $pK_w$ results in a decrease in the neutral $\\mathrm{pH}$.\nThus, the value $\\mathrm{pH} = 7$ is the neutral point only at or very near $T=298.15\\ \\mathrm{K}$. For temperatures above this value, such as the $T_2=310.15\\ \\mathrm{K}$ in this problem, $K_w > 10^{-14}$, $pK_w < 14$, and the neutral $\\mathrm{pH}$ is less than $7$. Conversely, for temperatures below $298.15\\ \\mathrm{K}$, the neutral $\\mathrm{pH}$ is greater than $7$.", "answer": "$$\n\\boxed{6.811}\n$$", "id": "2848219"}, {"introduction": "The hydrogen bond network in water is not a static lattice but a constantly fluctuating, dynamic system where bonds break and re-form on a picosecond timescale. This advanced computational practice moves beyond static thermodynamic descriptions to the heart of water's dynamics. By implementing an analysis of a molecular dynamics trajectory, you will learn how to use time correlation functions to extract a key kinetic parameter—the mean hydrogen bond lifetime—which is fundamental to understanding diffusion, solvation dynamics, and proton transport in water [@problem_id:2848216].", "problem": "You are given a discrete-time representation of hydrogen-bonding events extracted from a Molecular Dynamics (MD) trajectory of liquid water. For each donor–acceptor molecular pair, and for each sampled time frame, you have a binary indicator that encodes whether a hydrogen bond exists at that instant. Let $P$ be the number of pairs, let $N$ be the number of frames, and let $\\Delta t$ be the uniform time step between frames expressed in picoseconds (ps). Define $h_{p}(i) \\in \\{0,1\\}$ as the indicator at frame index $i \\in \\{0,1,\\dots,N-1\\}$ for pair $p \\in \\{1,2,\\dots,P\\}$. Averages denoted by $\\langle \\cdot \\rangle$ refer to the combined average over all eligible time origins and all pairs.\n\nYour tasks are as follows:\n- Define the intermittent hydrogen bond correlation function $C_{I}(t)$ based on the binary indicator process $h_{p}(i)$, and formulate a computable discrete-time estimator for $t = k \\Delta t$ with integer lag $k \\geq 0$.\n- Define the continuous survival correlation function $C_{C}(t)$ that encodes the probability that a hydrogen bond present at a time origin survives continuously without breaking up to time $t$, and formulate a computable discrete-time estimator for $t = k \\Delta t$ with integer lag $k \\geq 0$.\n- Using only $C_{C}(t)$, compute the mean continuous hydrogen-bond lifetime $\\tau$ via an integral of $C_{C}(t)$. Because the data are discrete and finite, you must approximate the integral by a left Riemann sum that excludes the $k=0$ term:\n$$\n\\tau \\equiv \\int_{0}^{\\infty} C_{C}(t)\\, dt \\approx \\sum_{k=1}^{K_{\\max}} C_{C}(k \\Delta t)\\,\\Delta t,\n$$\nwhere $K_{\\max} = N - 1$. If, for any lag $k$, normalization would involve division by zero due to the absence of any hydrogen bonds at eligible time origins, you must define the corresponding contribution to be $0$.\n\nFundamental base and definitions to use:\n- The binary indicator $h_{p}(i)$ is defined as $h_{p}(i) = 1$ if a hydrogen bond exists for pair $p$ at frame $i$, and $h_{p}(i) = 0$ otherwise.\n- The intermittent correlation function is defined by\n$$\nC_{I}(t) = \\frac{\\langle h(0)\\,h(t)\\rangle}{\\langle h \\rangle},\n$$\nwhich in discrete form at $t=k\\Delta t$ is estimated by\n$$\n\\widehat{C}_{I}(k\\Delta t) = \\frac{\\sum_{p=1}^{P}\\sum_{i=0}^{N-1-k} h_{p}(i)\\,h_{p}(i+k)}{\\sum_{p=1}^{P}\\sum_{i=0}^{N-1-k} h_{p}(i)}.\n$$\n- The continuous survival correlation function is defined by\n$$\nC_{C}(t) = \\frac{\\left\\langle h(0)\\,\\prod_{m=1}^{\\lfloor t/\\Delta t \\rfloor} h(m\\Delta t)\\right\\rangle}{\\langle h \\rangle},\n$$\nwhich in discrete form at $t=k\\Delta t$ is estimated by\n$$\n\\widehat{C}_{C}(k\\Delta t) = \\frac{\\sum_{p=1}^{P}\\sum_{i=0}^{N-1-k} \\left[\\prod_{m=0}^{k} h_{p}(i+m)\\right]}{\\sum_{p=1}^{P}\\sum_{i=0}^{N-1-k} h_{p}(i)}.\n$$\nIn both estimators, the sums over $i$ are restricted to indices for which $i+k \\leq N-1$ to avoid invalid time origins near the end of the trajectory. If the denominator is $0$, define the estimator to be $0$.\n\nInput specification:\n- There is no external input. The program must use the following embedded test suite. Each test case consists of a time step $\\Delta t$ (in ps) and a $P \\times N$ binary matrix of indicators.\n\nTest suite:\n- Test case $1$ (happy path, mixed on–off dynamics): $\\Delta t = 0.5$ ps, $P = 2$, $N = 10$, with\n  - Pair $1$: $[1,1,1,0,0,1,1,0,1,0]$\n  - Pair $2$: $[0,1,1,0,1,0,0,1,0,0]$\n- Test case $2$ (edge case, no bonds ever): $\\Delta t = 0.2$ ps, $P = 3$, $N = 8$, with\n  - Pair $1$: $[0,0,0,0,0,0,0,0]$\n  - Pair $2$: $[0,0,0,0,0,0,0,0]$\n  - Pair $3$: $[0,0,0,0,0,0,0,0]$\n- Test case $3$ (boundary, bonds never break within window): $\\Delta t = 0.5$ ps, $P = 1$, $N = 6$, with\n  - Pair $1$: $[1,1,1,1,1,1]$\n- Test case $4$ (edge case, alternating presence precludes survival): $\\Delta t = 0.1$ ps, $P = 1$, $N = 10$, with\n  - Pair $1$: $[1,0,1,0,1,0,1,0,1,0]$\n\nRequired computations and output:\n- For each test case, compute the mean continuous hydrogen-bond lifetime $\\tau$ in picoseconds using the discrete estimator\n$$\n\\tau \\approx \\sum_{k=1}^{N-1} \\widehat{C}_{C}(k\\Delta t)\\,\\Delta t,\n$$\nwith the conventions stated above.\n- Express each $\\tau$ in picoseconds, rounded to $3$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\tau_{1},\\tau_{2},\\tau_{3},\\tau_{4}]$), with no additional text. Units are not printed; they are implicitly picoseconds as specified above.", "solution": "The problem requires the computation of the mean continuous hydrogen-bond lifetime, $\\tau$, from a discrete-time representation of hydrogen-bonding events. The calculation must be performed for several provided test cases. The entire process must adhere strictly to the definitions and computational procedures specified.\n\nThe validation of the problem statement confirms that it is scientifically grounded, well-posed, and objective. It is based on standard principles of statistical mechanics used for analyzing time-series data from molecular dynamics simulations. All definitions, variables, and computational constraints are provided explicitly and are internally consistent. The problem is therefore deemed valid and a solution can be formulated.\n\nThe primary quantity to be computed is the mean continuous lifetime, $\\tau$, which is defined as the integral of the continuous survival correlation function, $C_C(t)$. The problem specifies a discrete approximation for this integral. Our procedure is as follows:\n\nFirst, we must evaluate the discrete estimator for the continuous survival correlation function, $\\widehat{C}_{C}(k\\Delta t)$, for each integer time lag $k$ from $1$ to $N-1$. The definition provided is:\n$$\n\\widehat{C}_{C}(k\\Delta t) = \\frac{N(k)}{D(k)} = \\frac{\\sum_{p=1}^{P}\\sum_{i=0}^{N-1-k} \\left[\\prod_{m=0}^{k} h_{p}(i+m)\\right]}{\\sum_{p=1}^{P}\\sum_{i=0}^{N-1-k} h_{p}(i)}\n$$\nwhere $h_p(i)$ is the binary indicator ($1$ for bond, $0$ for no bond) for pair $p$ at time frame $i$, $P$ is the number of pairs, $N$ is the number of frames, and $\\Delta t$ is the time step. The summation over time origins $i$ is limited to $N-1-k$ to ensure that the time index $i+k$ does not exceed the maximum frame index $N-1$.\n\nThe numerator, $N(k)$, counts the total number of instances where a hydrogen bond, formed at frame $i$, persists continuously through to frame $i+k$. The product term, $\\prod_{m=0}^{k} h_{p}(i+m)$, is equal to $1$ if and only if $h_{p}(i)=1, h_{p}(i+1)=1, \\dots, h_{p}(i+k)=1$. Otherwise, it is $0$. This term thus acts as a detector for continuously bonded segments of length at least $k+1$ frames starting at time $i$.\n\nThe denominator, $D(k)$, represents the number of hydrogen bonds that exist at any of the eligible time origins, $i \\in \\{0, 1, \\dots, N-1-k\\}$. This serves as the normalization factor, representing the total population of bonds at the start of intervals of duration $k\\Delta t$.\n\nThe problem specifies that if the denominator $D(k)$ is zero for any lag $k$, then the value of $\\widehat{C}_{C}(k\\Delta t)$ must be defined as $0$. This convention is crucial for cases where no hydrogen bonds are present.\n\nSecond, using the computed values of $\\widehat{C}_{C}(k\\Delta t)$, we calculate the mean continuous lifetime, $\\tau$, using the provided discrete summation formula. This formula approximates the integral $\\int_{0}^{\\infty} C_{C}(t)\\, dt$ with a left Riemann sum that explicitly excludes the $k=0$ term:\n$$\n\\tau \\approx \\Delta t \\sum_{k=1}^{N-1} \\widehat{C}_{C}(k \\Delta t)\n$$\nThe summation ranges from $k=1$ to $k=N-1$. For each test case, we will compute the set of values $\\{\\widehat{C}_{C}(k\\Delta t)\\}_{k=1}^{N-1}$ and then evaluate the sum to find $\\tau$.\n\nThe implementation will proceed by iterating through each required lag $k \\in \\{1, 2, \\dots, N-1\\}$. For each $k$, the numerator $N(k)$ and denominator $D(k)$ will be calculated by iterating through all pairs $p \\in \\{1, \\dots, P\\}$ and all valid time origins $i \\in \\{0, \\dots, N-1-k\\}$. The ratio will be computed, handling the case of $D(k)=0$. The resulting values will be summed and multiplied by $\\Delta t$ to yield the final value for $\\tau$. The result for each test case will be rounded to $3$ decimal places as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the hydrogen bond lifetime problem for the given test suite.\n    \"\"\"\n    test_cases = [\n        (0.5, np.array([\n            [1, 1, 1, 0, 0, 1, 1, 0, 1, 0],\n            [0, 1, 1, 0, 1, 0, 0, 1, 0, 0]\n        ])),\n        (0.2, np.array([\n            [0, 0, 0, 0, 0, 0, 0, 0],\n            [0, 0, 0, 0, 0, 0, 0, 0],\n            [0, 0, 0, 0, 0, 0, 0, 0]\n        ])),\n        (0.5, np.array([\n            [1, 1, 1, 1, 1, 1]\n        ])),\n        (0.1, np.array([\n            [1, 0, 1, 0, 1, 0, 1, 0, 1, 0]\n        ]))\n    ]\n\n    results = []\n    \n    for dt, h_matrix in test_cases:\n        if h_matrix.ndim == 1:\n            h_matrix = h_matrix.reshape(1, -1)\n        \n        P, N = h_matrix.shape\n        \n        # K_max = N - 1 as specified. The sum for tau starts at k=1.\n        k_max = N - 1\n        \n        # This will store the sum of C_c(k*dt) for k from 1 to N-1.\n        c_c_sum = 0.0\n\n        for k in range(1, k_max + 1):\n            # The number of valid time origins ends at N-1-k.\n            num_time_origins = N - k\n            \n            numerator_k = 0\n            denominator_k = 0\n            \n            # Sum over all pairs\n            for p in range(P):\n                # Sum over all eligible time origins i\n                for i in range(num_time_origins):\n                    # Denominator contribution: h_p(i)\n                    denominator_k += h_matrix[p, i]\n                    \n                    # Numerator contribution: Product of h_p(i+m) from m=0 to k\n                    # This checks if the bond segment h[p, i:i+k+1] is all 1s.\n                    if np.all(h_matrix[p, i : i + k + 1] == 1):\n                        numerator_k += 1\n\n            if denominator_k == 0:\n                c_c_k = 0.0\n            else:\n                c_c_k = numerator_k / denominator_k\n            \n            c_c_sum += c_c_k\n            \n        tau = dt * c_c_sum\n        results.append(round(tau, 3))\n        \n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2848216"}]}