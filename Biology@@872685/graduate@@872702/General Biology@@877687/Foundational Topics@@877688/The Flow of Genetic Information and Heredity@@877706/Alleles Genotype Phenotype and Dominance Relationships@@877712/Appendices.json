{"hands_on_practices": [{"introduction": "This first exercise provides a practical entry point into the foundational quantitative genetic model of gene action. By taking observed phenotypic means for three genotypes at a single locus, you will learn to partition these values into the core parameters of the model: the additive effect ($a$) and the dominance deviation ($d$) [@problem_id:2773485]. This decomposition is the essential first step for understanding the genetic architecture of a trait and predicting its response to selection.", "problem": "A single autosomal locus with two alleles, denoted $A$ and $a$, influences a quantitative trait measured in controlled, common-garden conditions such that environmental effects are homogeneous across genotypes. The observed genotype-specific phenotypic means (which in this setting can be taken as the genotypic values) are: $AA: 10$ trait units, $Aa: 8$ trait units, and $aa: 4$ trait units.\n\nUsing the foundational quantitative-genetic decomposition of a single-locus genotypic value into an additive component and a dominance deviation in the sense of Fisher’s 1918 formulation, proceed as follows:\n\n- Starting from the core definitions that (i) the midpoint between the two homozygote genotypic values anchors the reference scale for gene action at the locus, and (ii) the additive effect $a$ represents the symmetric half-distance separating the homozygote genotypic values about this midpoint, while the dominance deviation $d$ represents the deviation of the heterozygote genotypic value from that midpoint, derive expressions for $a$ and $d$ purely in terms of the three observed genotypic means.\n\n- Define the phenotypic dominance coefficient $h$ as $h = d/a$, with the sign convention that $a$ takes the sign of the higher-valued homozygote relative to the midpoint.\n\nCompute the numerical values of $a$, $d$, and $h$ from the data. Express $a$ and $d$ in trait units and $h$ as dimensionless. Report your final result as the ordered triple $\\left(a, d, h\\right)$ with exact values (no rounding), and provide it as a single row in the form $\\left(a, d, h\\right)$ in your final answer.", "solution": "The problem statement is subjected to critical validation.\n\nStep 1: Extract Givens.\n- Locus: A single autosomal locus.\n- Alleles: $A$ and $a$.\n- Genotypic values (phenotypic means in a controlled environment): $G_{AA} = 10$, $G_{Aa} = 8$, $G_{aa} = 4$.\n- Definition of midpoint ($M$): The midpoint between the two homozygote genotypic values.\n- Definition of additive effect ($a$): The symmetric half-distance separating the homozygote genotypic values about the midpoint. The sign of $a$ is determined by the sign of the higher-valued homozygote's deviation from the midpoint.\n- Definition of dominance deviation ($d$): The deviation of the heterozygote genotypic value from the midpoint.\n- Definition of phenotypic dominance coefficient ($h$): $h = d/a$.\n- Task: Derive expressions for $a$ and $d$ in terms of the genotypic means, then compute the numerical values for the ordered triple $\\left(a, d, h\\right)$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, being based on the foundational Fisherian model of quantitative genetics for a single locus. It is well-posed, providing all necessary data ($G_{AA}$, $G_{Aa}$, $G_{aa}$) and clear, standard definitions for the parameters to be calculated ($a$, $d$, $h$). The language is objective and precise. The problem is self-contained, consistent, and does not violate any fundamental principles of genetics or mathematics. It is a standard, formalizable problem in its field.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A complete solution will be provided.\n\nThe analysis proceeds from the definitions provided. Let the genotypic values for the genotypes $AA$, $Aa$, and $aa$ be denoted by $G_{AA}$, $G_{Aa}$, and $G_{aa}$, respectively. The given values are $G_{AA}=10$, $G_{Aa}=8$, and $G_{aa}=4$.\n\nThe core of the model is the definition of a reference point on the scale of trait measurement. This reference is the midpoint, $M$, between the genotypic values of the two homozygotes, $G_{AA}$ and $G_{aa}$. Its definition is:\n$$M = \\frac{G_{AA} + G_{aa}}{2}$$\n\nThe additive effect, $a$, is defined as the half-distance between the homozygote values. This means the genotypic values of the homozygotes can be represented symmetrically around the midpoint $M$. Let us assign the higher-valued homozygote, $G_{AA}$, to be at a distance $+a$ from $M$, and the lower-valued homozygote, $G_{aa}$, to be at a distance $-a$ from $M$. This is consistent with the sign convention given.\n$$G_{AA} = M + a$$\n$$G_{aa} = M - a$$\nTo derive an expression for $a$ in terms of the genotypic values, we can subtract the second equation from the first:\n$$G_{AA} - G_{aa} = (M + a) - (M - a) = 2a$$\nSolving for $a$ yields the desired expression:\n$$a = \\frac{G_{AA} - G_{aa}}{2}$$\n\nThe dominance deviation, $d$, is defined as the deviation of the heterozygote's genotypic value, $G_{Aa}$, from the same midpoint, $M$.\n$$d = G_{Aa} - M$$\nSubstituting the expression for $M$:\n$$d = G_{Aa} - \\frac{G_{AA} + G_{aa}}{2}$$\nThis completes the derivation of the expressions for $a$ and $d$ purely in terms of the observed genotypic means.\n\nNow, we compute the numerical values for these parameters using the provided data: $G_{AA}=10$, $G_{Aa}=8$, and $G_{aa}=4$.\n\nFirst, we calculate the midpoint $M$:\n$$M = \\frac{10 + 4}{2} = \\frac{14}{2} = 7$$\n\nNext, we calculate the additive effect $a$:\n$$a = \\frac{10 - 4}{2} = \\frac{6}{2} = 3$$\nThe units for $a$ are trait units. The sign is positive, as required, because the higher-valued homozygote ($G_{AA}=10$) is above the midpoint ($M=7$).\n\nThen, we calculate the dominance deviation $d$:\n$$d = G_{Aa} - M = 8 - 7 = 1$$\nThe units for $d$ are also trait units.\n\nFinally, we compute the phenotypic dominance coefficient, $h$, which is defined as the ratio of the dominance deviation to the additive effect:\n$$h = \\frac{d}{a}$$\nSubstituting the computed values for $d$ and $a$:\n$$h = \\frac{1}{3}$$\nThis coefficient is a dimensionless quantity that describes the degree of dominance. A value of $h=0$ indicates no dominance (additivity), $h=1$ indicates complete dominance of allele $A$, and $h=-1$ indicates complete dominance of allele $a$. Here, $h=1/3$ signifies partial dominance of the allele $A$ (the allele associated with the higher phenotypic value).\n\nThe required result is the ordered triple $\\left(a, d, h\\right)$.\nThe calculated values are $a=3$, $d=1$, and $h=1/3$.\nTherefore, the ordered triple is $(3, 1, 1/3)$.", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 1 & \\frac{1}{3} \\end{pmatrix}}$$", "id": "2773485"}, {"introduction": "Moving from abstract parameters to concrete mechanisms, this practice explores how dominance effects can emerge from underlying molecular biology. You will model a common scenario in genetics: a dominant-negative mutation in a multimeric protein, where a single faulty subunit can disable the entire complex [@problem_id:2773440]. This exercise demonstrates how principles of probability and random assembly can directly predict the phenotype of a heterozygote and quantify the degree of dominance.", "problem": "A gene encodes a homotetrameric enzyme whose activity requires a fully wild-type tetramer: a single mutant subunit within a tetramer renders that tetramer inactive. Consider a diploid cell carrying two alleles at this locus: the wild-type allele $A$ produces wild-type subunits, and the mutant allele $a$ produces mutant subunits that incorporate into tetramers but abolish activity if present in any subunit position. Assume that, within any given genotype, the two alleles are transcribed and translated equally, that a very large pool of subunits exists prior to assembly, and that tetramers form by random assembly from this pool without positional bias. Let $p$ denote the probability that a randomly chosen subunit in the pool is wild-type.\n\nStarting only from the core definitions of genotype–phenotype mapping under random assembly and the binomial distribution for independent trials, derive an expression for the fraction of active tetramers as a function of $p$. Then specialize this expression to the three genotypes $AA$, $Aa$, and $aa$ by identifying the appropriate value of $p$ for each genotype under the equal-expression assumption.\n\nFinally, using the quantitative genetics scaling in which the activity phenotype is $f_{AA} = 1$ for $AA$ and $f_{aa} = 0$ for $aa$, define the dominance coefficient $h$ of the mutant allele for this activity trait as\n$$\nh \\equiv \\frac{f_{Aa} - f_{aa}}{f_{AA} - f_{aa}}.\n$$\nCompute $h$ exactly. Report your final answer for $h$ as an exact fraction. No rounding is required. Your final answer must be a single number.", "solution": "The problem statement is subjected to validation before any attempt at a solution is made.\n\nFirst, the givens of the problem are extracted verbatim:\n- A gene encodes a homotetrameric enzyme.\n- Activity requires a fully wild-type tetramer.\n- A single mutant subunit within a tetramer renders that tetramer inactive.\n- The organism is a diploid cell.\n- Wild-type allele is $A$, producing wild-type subunits.\n- Mutant allele is $a$, producing mutant subunits that incorporate into tetramers but abolish activity.\n- Within any given genotype, the two alleles are transcribed and translated equally.\n- A very large pool of subunits exists prior to assembly.\n- Tetramers form by random assembly from this pool without positional bias.\n- $p$ denotes the probability that a randomly chosen subunit in the pool is wild-type.\n- The phenotypes for the genotypes $AA$ and $aa$ are scaled such that $f_{AA} = 1$ and $f_{aa} = 0$.\n- The dominance coefficient $h$ is defined as $h \\equiv \\frac{f_{Aa} - f_{aa}}{f_{AA} - f_{aa}}$.\n\nSecond, these givens are validated against the required criteria.\n- **Scientific Grounding**: The problem describes a classic case of a dominant-negative mutation, where a mutant protein product interferes with the function of the wild-type product. The model of random subunit assembly is a standard and valid simplification used in genetics to understand genotype-phenotype relationships. The problem is scientifically sound.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information, including the genetic setup, the mechanism of enzyme inactivation, the assumptions of random assembly and equal expression, and a precise quantitative definition of the phenotype and the dominance coefficient. A unique solution is derivable from the premises.\n- **Objectivity**: The language is precise and objective, free from ambiguity or subjective claims.\n\nThe problem is self-contained, consistent, and scientifically grounded. It does not violate any of the specified invalidity criteria. Therefore, the problem is deemed valid and a solution will be derived.\n\nThe task is to compute the dominance coefficient, $h$. This requires determining the phenotype of the heterozygote, $f_{Aa}$, which is the fraction of active enzymes in an $Aa$ individual.\n\nLet us first derive a general expression for the fraction of active tetramers as a function of $p$, the probability that a randomly chosen subunit is wild-type. A tetramer consists of $4$ subunits. The assembly process is described as random selection from a large pool, which means the selection of each of the $4$ subunits can be treated as an independent event.\n\nFor a tetramer to be active, all $4$ of its constituent subunits must be wild-type. The probability of selecting one wild-type subunit is $p$. Since the selections are independent, the probability of selecting $4$ consecutive wild-type subunits is the product of their individual probabilities.\nLet $F_{active}$ be the fraction of active tetramers.\n$$F_{active}(p) = p \\times p \\times p \\times p = p^{4}$$\nThis corresponds to the term for $k=4$ successful trials in a binomial distribution with $n=4$ trials, where a \"success\" is the selection of a wild-type subunit: $\\binom{4}{4}p^{4}(1-p)^{4-4} = p^{4}$.\n\nNext, we must determine the value of $p$ for each of the three genotypes: $AA$, $Aa$, and $aa$. The problem states that the two alleles are transcribed and translated equally. This implies that the composition of the subunit pool directly reflects the allelic ratio in the genotype.\n- For genotype $AA$: Both alleles are $A$. Therefore, only wild-type subunits are produced. The pool of subunits consists of $100\\%$ wild-type subunits. The probability of choosing a wild-type subunit is $p_{AA} = 1$.\n- For genotype $aa$: Both alleles are $a$. Therefore, only mutant subunits are produced. The pool consists of $0\\%$ wild-type subunits. The probability of choosing a wild-type subunit is $p_{aa} = 0$.\n- For genotype $Aa$: One allele is $A$ and one is $a$. With equal expression, the pool of subunits will be composed of $50\\%$ wild-type and $50\\%$ mutant subunits. The probability of choosing a wild-type subunit is $p_{Aa} = \\frac{1}{2}$.\n\nNow, we can compute the phenotype, $f$, for each genotype using the expression $F_{active} = p^{4}$. The phenotype $f$ is defined as the fraction of active enzyme.\n- For genotype $AA$: $f_{AA} = (p_{AA})^{4} = 1^{4} = 1$. This is consistent with the problem's given scaling.\n- For genotype $aa$: $f_{aa} = (p_{aa})^{4} = 0^{4} = 0$. This is also consistent with the given scaling.\n- For genotype $Aa$: $f_{Aa} = (p_{Aa})^{4} = \\left(\\frac{1}{2}\\right)^{4} = \\frac{1^{4}}{2^{4}} = \\frac{1}{16}$.\n\nFinally, we compute the dominance coefficient, $h$, using the provided definition:\n$$\nh \\equiv \\frac{f_{Aa} - f_{aa}}{f_{AA} - f_{aa}}\n$$\nSubstituting the calculated phenotypic values:\n$$h = \\frac{\\frac{1}{16} - 0}{1 - 0}$$\n$$h = \\frac{1}{16}$$\nOn the defined scale, $h=0$ corresponds to complete dominance of the mutant allele ($a$) and $h=1$ corresponds to complete recessivity (i.e., dominance of the wild-type allele $A$). Our calculated value $h = 1/16$ is very close to 0, which confirms that the mutant allele is strongly dominant, as expected for a dominant-negative mechanism. The exact value is $\\frac{1}{16}$.", "answer": "$$\n\\boxed{\\frac{1}{16}}\n$$", "id": "2773440"}, {"introduction": "This final practice transitions from a static view of genetic variance to a dynamic one, exploring how selection alters the genetic architecture of a trait over time. You will construct a simulation to see firsthand how natural selection, by changing allele frequencies, can convert non-heritable dominance variance ($V_D$) into heritable additive variance ($V_A$) [@problem_id:2773462]. This reveals a key concept in evolutionary theory: dominance can act as a hidden reservoir of genetic variation that can be tapped by selection.", "problem": "Construct a deterministic, single-locus simulation that quantifies how dominance variance is converted into additive variance as allele frequency changes under viability selection. Consider one biallelic locus with alleles $A$ and $a$, random mating, nonoverlapping generations, and infinite population size. The fundamental base you must use consists of: the Hardy–Weinberg equilibrium (HWE) law, the standard viability selection recursion, and Fisher’s partitioning of genetic variance by defining additive genetic values as the best linear predictor of genotypic values from allele content.\n\nDefinitions and modeling assumptions to be used:\n- Let the allele frequency of $A$ in generation $t$ be $p_t \\in [0,1]$, and $q_t = 1 - p_t$.\n- Under Hardy–Weinberg equilibrium, the zygotic genotype frequencies at $p_t$ are $f_{AA}=p_t^2$, $f_{Aa}=2 p_t q_t$, and $f_{aa}=q_t^2$.\n- Viability selection is parameterized by a selection coefficient $s \\ge 0$ and a dominance coefficient $h \\in \\mathbb{R}$, with relative fitnesses $W_{AA}=1+s$, $W_{Aa}=1+h s$, and $W_{aa}=1$.\n- Denote genotypic trait values by $Y_{AA}=+a$, $Y_{Aa}=d$, and $Y_{aa}=-a$, for fixed real numbers $a>0$ and $d \\in \\mathbb{R}$; these values describe phenotype mapping and are independent of the fitness parameters.\n- The additive genetic value for a genotype is defined as the predicted value from the weighted least squares regression of the genotypic value $Y$ on the number of $A$ alleles $X \\in \\{0,1,2\\}$ using the current genotype frequencies as weights; the dominance deviation is the residual. The additive variance $V_A$ is the variance of additive genetic values across genotypes with weights given by the current genotype frequencies; the dominance variance $V_D$ is the variance of dominance deviations under the same weights. These definitions are to be applied to the Hardy–Weinberg zygote genotype frequencies at the current allele frequency $p_t$.\n\nSelection and frequency recursion to implement:\n- Given $p_t$, compute HWE zygote genotype frequencies $f_{AA}$, $f_{Aa}$, $f_{aa}$.\n- Compute mean fitness $\\overline{W}_t = f_{AA} W_{AA} + f_{Aa} W_{Aa} + f_{aa} W_{aa}$.\n- Compute post-selection genotype frequencies $f'_{ij} = f_{ij} W_{ij} / \\overline{W}_t$.\n- Compute the next-generation allele frequency $p_{t+1} = f'_{AA} + \\tfrac{1}{2} f'_{Aa}$, and then assume random mating restores HWE at $p_{t+1}$ before selection acts again.\n\nVariance computation to implement at each generation $t$:\n- Let $X_{aa}=0$, $X_{Aa}=1$, $X_{AA}=2$. With weights $(f_{aa}, f_{Aa}, f_{AA})$ and values $(Y_{aa}, Y_{Aa}, Y_{AA})$, compute the weighted means $\\mu_X$ and $\\mu_Y$, the weighted variance $\\mathrm{Var}(X)$, and the weighted covariance $\\mathrm{Cov}(X,Y)$. The regression slope is $\\beta_1 = \\mathrm{Cov}(X,Y)/\\mathrm{Var}(X)$ when $\\mathrm{Var}(X) > 0$ and undefined otherwise; in the latter case, set the additive and dominance variances to $0$ by definition because the genotype distribution is degenerate. The intercept is $\\beta_0 = \\mu_Y - \\beta_1 \\mu_X$. Predicted values are $\\widehat{Y}_{aa}=\\beta_0 + \\beta_1 X_{aa}$, $\\widehat{Y}_{Aa}=\\beta_0 + \\beta_1 X_{Aa}$, and $\\widehat{Y}_{AA}=\\beta_0 + \\beta_1 X_{AA}$. The additive genetic values are $A_{ij}=\\widehat{Y}_{ij} - \\mu_Y$, and dominance deviations are $D_{ij}=Y_{ij} - \\widehat{Y}_{ij}$. Then $V_A = \\sum_{ij} f_{ij} A_{ij}^2$ and $V_D = \\sum_{ij} f_{ij} D_{ij}^2$.\n- Use HWE zygote frequencies at $p_t$ for computing $V_A$ and $V_D$ at generation $t$; do not use post-selection genotype frequencies for the variance partition.\n\nTarget quantity to output for each test case:\n- Define the dominance-to-additive conversion index over $T$ generations as\n$$\nC(T) \\equiv \n\\begin{cases}\n\\dfrac{\\max_{0 \\le t \\le T} V_A(p_t) - V_A(p_0)}{V_D(p_0)}, & \\text{if } V_D(p_0) > 0, \\\\\n0.0, & \\text{if } V_D(p_0) = 0,\n\\end{cases}\n$$\nwhere $p_{t+1}$ is generated from $p_t$ by the selection recursion above. This index quantifies the maximal increase in additive variance attributable to allele-frequency change along the trajectory, scaled by the initial dominance variance. All variance computations are on the HWE zygotes at the corresponding $p_t$.\n\nImplementation requirements:\n- Your program must implement the recursion and variance partition exactly as specified.\n- For numerical stability, if $\\mathrm{Var}(X) \\le 10^{-15}$ at any step, set $V_A=0$ and $V_D=0$ for that step.\n- Use real-valued arithmetic.\n\nTest suite:\nProvide results for the following parameter sets, each given as a tuple $(T, p_0, s, h, a, d)$:\n- Case $1$: $(100,\\, 0.5,\\, 0.1,\\, 0.5,\\, 1.0,\\, 0.0)$\n- Case $2$: $(200,\\, 0.1,\\, 0.2,\\, 0.0,\\, 1.0,\\, 0.5)$\n- Case $3$: $(100,\\, 0.01,\\, 0.5,\\, 1.0,\\, 1.0,\\, 1.0)$\n- Case $4$: $(100,\\, 0.4,\\, 0.0,\\, 0.5,\\, 1.0,\\, 0.7)$\n- Case $5$: $(150,\\, 0.7,\\, 0.1,\\, 0.25,\\, 1.0,\\, 0.8)$\n\nFinal output format:\n- Your program should produce a single line of output containing the five conversion indices for Cases $1$ through $5$, in order, as a comma-separated list enclosed in square brackets, each rounded to six decimal places (for example, $[0.123456,0.000000,0.987654,0.314159,0.271828]$). No other text should be printed.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the fundamental principles of population and quantitative genetics, well-posed with a clear and deterministic set of instructions, and formulated with objective, unambiguous language. It presents a standard, albeit computationally intensive, exercise in modeling the dynamics of genetic variance under selection. We shall proceed with the solution.\n\nThe objective is to compute a \"dominance-to-additive conversion index,\" $C(T)$, which quantifies the increase in additive genetic variance ($V_A$) along a selection trajectory, scaled by the initial dominance variance ($V_D$). This requires simulating allele frequency change over $T$ generations and partitioning the genetic variance at each step.\n\nFirst, we establish the analytical expressions for the variance components. The problem defines additive and dominance variance based on a weighted least-squares regression of genotypic values ($Y$) on the count of allele $A$ ($X$). The genotypic values are $Y_{AA}=+a$, $Y_{Aa}=d$, and $Y_{aa}=-a$, and the allele counts are $X_{AA}=2$, $X_{Aa}=1$, and $X_{aa}=0$. At an allele frequency $p$ for allele $A$ and $q=1-p$ for allele $a$, the Hardy-Weinberg genotype frequencies are $f_{AA}=p^2$, $f_{Aa}=2pq$, and $f_{aa}=q^2$.\n\nThe regression is weighted by these frequencies. The key statistics for this regression are:\n-  The mean allele count: $\\mu_X = \\sum f_{ij} X_{ij} = 2(p^2) + 1(2pq) + 0(q^2) = 2p$.\n-  The variance of allele count: $\\mathrm{Var}(X) = \\sum f_{ij} (X_{ij} - \\mu_X)^2 = 2pq$.\n-  The mean genotypic value: $\\mu_Y = \\sum f_{ij} Y_{ij} = a(p^2) + d(2pq) - a(q^2) = a(p-q) + 2dpq$.\n-  The covariance: $\\mathrm{Cov}(X,Y) = \\sum f_{ij} (X_{ij} - \\mu_X)(Y_{ij} - \\mu_Y) = 2pq(a + d(q-p))$.\n\nThe slope of the regression of $Y$ on $X$ is the average effect of an allele substitution, denoted by $\\alpha$:\n$$ \\alpha = \\beta_1 = \\frac{\\mathrm{Cov}(X,Y)}{\\mathrm{Var}(X)} = \\frac{2pq(a + d(q-p))}{2pq} = a + d(q-p) = a + d(1-2p) $$\nThis expression is valid when $\\mathrm{Var}(X) = 2pq > 0$. If $p=0$ or $p=1$, $\\mathrm{Var}(X)=0$, and by the problem's definition, both variance components are zero. The problem specifies a numerical tolerance for this condition: if $\\mathrm{Var}(X) \\le 10^{-15}$, we set $V_A = 0$ and $V_D = 0$.\n\nThe additive genetic variance, $V_A$, is the variance of the predicted values from the regression. A standard result from quantitative genetics gives this as:\n$$ V_A = 2pq \\alpha^2 = 2pq(a + d(1-2p))^2 $$\nThe dominance variance, $V_D$, is the variance of the residuals (dominance deviations). After algebraic simplification, this variance is given by:\n$$ V_D = (2pqd)^2 $$\nThese analytical formulas are computationally more efficient than performing a full regression at each step and are used in the implementation. Note that $V_D$ is non-zero only if $d \\neq 0$ and $p,q \\in (0,1)$.\n\nNext, we define the recursion for the allele frequency $p_t$. Selection acts on the genotypes according to their relative fitnesses: $W_{AA}=1+s$, $W_{Aa}=1+hs$, and $W_{aa}=1$. The mean fitness of the population at generation $t$ is:\n$$ \\overline{W}_t = p_t^2 W_{AA} + 2p_t q_t W_{Aa} + q_t^2 W_{aa} = 1 + sp_t^2 + 2hsp_t q_t = 1 + sp_t(p_t + 2hq_t) $$\nThe frequency of allele $A$ in the next generation, $p_{t+1}$, after selection and random mating is given by:\n$$ p_{t+1} = \\frac{p_t^2 W_{AA} + p_t q_t W_{Aa}}{\\overline{W}_t} = \\frac{p_t(p_t(1+s) + q_t(1+hs))}{\\overline{W}_t} $$\nThe change in allele frequency per generation, $\\Delta p_t = p_{t+1} - p_t$, can be expressed as:\n$$ \\Delta p_t = \\frac{p_t q_t}{\\overline{W}_t} [p_t(W_{AA}-W_{Aa}) + q_t(W_{Aa}-W_{aa})] = \\frac{p_t q_t s}{\\overline{W}_t} [p_t(1-h) + q_t h] $$\n\nThe simulation proceeds as follows for each test case $(T, p_0, s, h, a, d)$:\n1.  First, check for trivial cases. If the initial dominance variance $V_D(p_0) = (2p_0q_0d)^2$ is zero (or below the numerical threshold), which occurs if $d=0$ or $p_0 \\in \\{0, 1\\}$, then the conversion index $C(T)$ is defined as $0.0$. Similarly, if the selection coefficient $s=0$, allele frequencies do not change, so $p_t=p_0$ for all $t$. This means $V_A(p_t) = V_A(p_0)$ for all $t$, making the numerator of $C(T)$ zero, so $C(T)=0$.\n2.  If the case is non-trivial, calculate the initial variances $V_A(p_0)$ and $V_D(p_0)$. Initialize a variable `max_Va` to $V_A(p_0)$.\n3.  Iterate for $t$ from $0$ to $T-1$. In each iteration, update the current allele frequency $p_t$ to $p_{t+1}$ using the $\\Delta p_t$ formula.\n4.  For each new frequency $p_{t+1}$, compute the corresponding additive variance $V_A(p_{t+1})$.\n5.  Update `max_Va` if the newly computed $V_A(p_{t+1})$ is greater than the current `max_Va`. The loop must properly handle boundary conditions where $p$ reaches $0$ or $1$, at which point frequency change ceases.\n6.  After $T$ generations, the simulation is complete. The target index is calculated as:\n$$ C(T) = \\frac{\\max_{0 \\le t \\le T} V_A(p_t) - V_A(p_0)}{V_D(p_0)} $$\nwhere $\\max_{0 \\le t \\le T} V_A(p_t)$ is the final value of `max_Va`.\n\nThis procedure is implemented for each of the five test cases provided. The final output is a list of the computed $C(T)$ values, rounded as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef _run_simulation(params):\n    \"\"\"\n    Runs a single-locus, deterministic population genetics simulation.\n\n    Args:\n        params (tuple): A tuple containing (T, p0, s, h, a, d).\n\n    Returns:\n        float: The dominance-to-additive conversion index C(T).\n    \"\"\"\n    T, p0, s, h, a, d = params\n\n    # Calculate initial additive and dominance variances at p0.\n    p, q = p0, 1.0 - p0\n    Va_0 = 0.0\n    Vd_0 = 0.0\n    \n    var_x = 2.0 * p * q\n    if var_x > 1.0e-15:\n        alpha_0 = a + d * (q - p)\n        Va_0 = var_x * alpha_0**2\n        if d != 0.0:\n            Vd_0 = (var_x * d)**2\n\n    # According to the definition of C(T), if Vd_0 is zero, the index is 0.\n    # This covers cases where d=0, p0=0, or p0=1.\n    if Vd_0 == 0.0:\n        return 0.0\n    \n    # If s=0, there is no selection, p does not change, so max(V_A) = V_A(p0).\n    # The numerator of C(T) becomes zero.\n    if s == 0.0:\n        return 0.0\n\n    # Initialize simulation\n    max_Va = Va_0\n    p_current = p0\n    \n    # Loop for T generations\n    for _ in range(T):\n        p, q = p_current, 1.0 - p_current\n\n        # If allele is fixed or lost, no further change occurs.\n        if p <= 0.0 or p >= 1.0:\n            break\n        \n        # Update allele frequency based on selection\n        # Fitness values are >= 1 since s>=0. Thus mean_w is safe from being zero.\n        mean_w = 1.0 + s * p * (p + 2.0 * h * q)\n        delta_p = (p * q * s * (p * (1.0 - h) + q * h)) / mean_w\n        p_current += delta_p\n        # Clip to maintain bounds due to potential floating-point inaccuracies\n        p_current = np.clip(p_current, 0.0, 1.0)\n        \n        # Calculate new additive variance at the new frequency\n        p_new, q_new = p_current, 1.0 - p_current\n        va_new = 0.0\n        var_x_new = 2.0 * p_new * q_new\n        if var_x_new > 1.0e-15:\n            alpha_new = a + d * (q_new - p_new)\n            va_new = var_x_new * alpha_new**2\n\n        # Update the maximum additive variance found so far\n        if va_new > max_Va:\n            max_Va = va_new\n            \n    # Calculate the final conversion index C(T)\n    C_T = (max_Va - Va_0) / Vd_0\n    \n    return C_T\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (T, p0, s, h, a, d)\n        (100, 0.5, 0.1, 0.5, 1.0, 0.0),    # Case 1\n        (200, 0.1, 0.2, 0.0, 1.0, 0.5),    # Case 2\n        (100, 0.01, 0.5, 1.0, 1.0, 1.0),   # Case 3\n        (100, 0.4, 0.0, 0.5, 1.0, 0.7),    # Case 4\n        (150, 0.7, 0.1, 0.25, 1.0, 0.8),   # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _run_simulation(case)\n        results.append(f\"{result:.6f}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2773462"}]}