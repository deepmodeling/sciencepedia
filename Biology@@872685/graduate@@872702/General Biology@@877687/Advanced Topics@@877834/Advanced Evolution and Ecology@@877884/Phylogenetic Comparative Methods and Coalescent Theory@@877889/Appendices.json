{"hands_on_practices": [{"introduction": "A central challenge in modern phylogenomics is that the evolutionary history of an individual gene may not always match the branching history of the species that carry it. This discordance, often due to a process called incomplete lineage sorting (ILS), can be modeled using the multispecies coalescent framework. This exercise guides you through a first-principles derivation to quantify the expected amount of gene tree discordance as a function of the species tree's internode branch length, providing a foundational understanding of how population genetic processes shape patterns across the tree of life [@problem_id:2823645].", "problem": "Consider a rooted three-taxon species tree with topology $((A,B),C)$ in which species $A$ and $B$ diverge, followed by an internode of length $T$ generations before the lineage leading to $(A,B)$ coalesces with $C$. Assume a neutral constant-size population along each branch with effective population size $N_e$, a single sampled lineage per species, instantaneous speciation events, and no post-divergence migration. Work under the standard Multispecies Coalescent (MSC) model.\n\nStarting from the fundamental facts that (i) the waiting time to coalescence of two lineages in a single panmictic population of constant effective size $N_e$ is exponentially distributed with rate $1/(2N_e)$ in generations, and (ii) when three lineages enter the same ancestral population, the next coalescent event chooses any of the $\\binom{3}{2}$ pairs with equal probability, derive from first principles the expected fraction of gene trees that are topologically discordant with the species tree as a function of the dimensionless internode length $\\tau$. First compute the coalescent-unit internode length $\\tau = T/(2N_e)$ for the parameter values $N_e = 750{,}000$ and $T = 1{,}200{,}000$ generations. Then compute the expected fraction of discordant gene trees.\n\nReport your final answer as a row vector containing, in order, the value of $\\tau$ and the expected discordant fraction. Round each reported number to four significant figures. No units are required.", "solution": "The problem is subjected to validation before any solution is attempted.\n\nStep 1: Extraction of Givens.\n- Species tree topology: $((A,B),C)$.\n- Internode length: $T$ generations.\n- Effective population size: $N_e$, constant along all branches.\n- Sampling scheme: A single lineage per species.\n- Speciation model: Instantaneous events.\n- Migration: No post-divergence gene flow.\n- Model: Standard Multispecies Coalescent (MSC).\n- Fundamental fact (i): The waiting time to coalescence for two lineages in a constant-size population $N_e$ is exponentially distributed with rate $1/(2N_e)$ in generations.\n- Fundamental fact (ii): For three lineages entering an ancestral population, any of the $\\binom{3}{2}$ pairs coalesces first with equal probability.\n- Definition of dimensionless internode length: $\\tau = T/(2N_e)$.\n- Parameter values for calculation: $N_e = 750{,}000$ and $T = 1{,}200{,}000$ generations.\n- Required output: The value of $\\tau$ and the expected fraction of discordant gene trees, rounded to four significant figures.\n\nStep 2: Validation.\n- Scientific Groundedness: The problem is a canonical example within the field of coalescent theory. It is based on the standard Multispecies Coalescent model, which is a cornerstone of modern phylogenetics and population genetics. The assumptions and provided facts are fundamental to the theory. The problem is scientifically sound.\n- Well-Posedness: The problem provides all necessary parameters, definitions, and a clear objective. It is structured to have a unique, stable, and meaningful solution.\n- Objectivity: The problem is stated in precise, quantitative terms, free of subjective or ambiguous language.\n\nStep 3: Verdict.\nThe problem is valid as it is scientifically grounded, well-posed, and objective. It does not violate any of the specified criteria for invalidity. A solution will be derived.\n\nDerivation from first principles:\nThe species tree topology is given as $((A,B),C)$, which indicates that species $A$ and $B$ are sister taxa, and their common ancestor shares a common ancestor with species $C$. We trace the lineages of single gene copies sampled from each of the three species ($A$, $B$, and $C$) backward in time.\n\nThe lineages from $A$ and $B$ enter their common ancestral population. This ancestral population persists for an internode duration of $T$ generations. We define the internode length in coalescent units as $\\tau = T / (2N_e)$, where one coalescent time unit equals $2N_e$ generations. According to the problem statement, the waiting time for the two lineages to coalesce is exponentially distributed with a rate parameter of $1/(2N_e)$ generations$^{-1}$. In coalescent time units, the rate parameter is $1$.\n\nThere are two mutually exclusive events that can occur within this internode of length $\\tau$:\n1. The lineages from $A$ and $B$ coalesce within the internode.\n2. The lineages from $A$ and $B$ fail to coalesce within the internode.\n\nLet us analyze the probability of each event. The probability that coalescence occurs by time $\\tau$ is given by the cumulative distribution function (CDF) of the exponential distribution with rate $1$, evaluated at $\\tau$:\n$$P(\\text{coalescence in internode}) = \\int_0^\\tau \\exp(-t) dt = \\left[ -\\exp(-t) \\right]_0^\\tau = 1 - \\exp(-\\tau)$$\nIf the lineages from $A$ and $B$ coalesce, the resulting gene tree will have the topology $((A,B),C)$. This topology is congruent, or concordant, with the species tree.\n\nThe probability that the lineages from $A$ and $B$ do not coalesce within the internode is the complementary probability:\n$$P(\\text{no coalescence in internode}) = 1 - P(\\text{coalescence in internode}) = 1 - (1 - \\exp(-\\tau)) = \\exp(-\\tau)$$\nIf the two lineages fail to coalesce, then at time $T$ in the past (or $\\tau$ in coalescent units), three distinct lineages—the ancestor of the $A$ sample, the ancestor of the $B$ sample, and the ancestor of the $C$ sample—enter the deeper ancestral population common to all three species.\n\nAccording to the problem's premises, when three lineages are present in a single panmictic population, the next coalescent event involves any of the $\\binom{3}{2} = 3$ possible pairs of lineages with equal probability. The pairs are $(A,B)$, $(A,C)$, and $(B,C)$. The probability for any specific pair to coalesce first is $\\frac{1}{3}$.\n- If the pair $(A,B)$ coalesces first, the resulting gene tree is $((A,B),C)$. This is a concordant topology. This occurs with conditional probability $\\frac{1}{3}$.\n- If the pair $(A,C)$ coalesces first, the resulting gene tree is $((A,C),B)$. This is a discordant topology. This occurs with conditional probability $\\frac{1}{3}$.\n- If the pair $(B,C)$ coalesces first, the resulting gene tree is $((B,C),A)$. This is also a discordant topology. This occurs with conditional probability $\\frac{1}{3}$.\n\nA discordant gene tree arises only if the lineages from $A$ and $B$ do not coalesce in the internode, *and* the first coalescence event in the deeper ancestral population involves either the $(A,C)$ or $(B,C)$ pair.\n\nThe total probability of observing a discordant gene tree is the sum of the probabilities of these two outcomes:\n$$P(\\text{discordant}) = P(\\text{no coalescence in internode}) \\times \\left( P((A,C) \\text{ coalesces first}) + P((B,C) \\text{ coalesces first}) \\right)$$\n$$P(\\text{discordant}) = \\exp(-\\tau) \\times \\left( \\frac{1}{3} + \\frac{1}{3} \\right)$$\n$$P(\\text{discordant}) = \\frac{2}{3}\\exp(-\\tau)$$\nThis is the general formula for the expected fraction of discordant gene trees for this three-taxon case.\n\nNext, we perform the numerical calculations as required.\nFirst, we compute the dimensionless internode length $\\tau$ using the provided parameters $N_e = 750{,}000$ and $T = 1{,}200{,}000$:\n$$\\tau = \\frac{T}{2N_e} = \\frac{1{,}200{,}000}{2 \\times 750{,}000} = \\frac{1{,}200{,}000}{1{,}500{,}000} = \\frac{12}{15} = \\frac{4}{5} = 0.8$$\n\nSecond, we compute the expected fraction of discordant gene trees for this value of $\\tau$:\n$$P(\\text{discordant}) = \\frac{2}{3}\\exp(-0.8)$$\nUsing the value $\\exp(-0.8) \\approx 0.44932896$, we have:\n$$P(\\text{discordant}) \\approx \\frac{2}{3} \\times 0.44932896 \\approx 0.29955264$$\n\nThe problem requires rounding each number to four significant figures.\n- For $\\tau = 0.8$, four significant figures gives $0.8000$.\n- For $P(\\text{discordant}) \\approx 0.29955264$, rounding to four significant figures gives $0.2996$.\n\nThe final answer is a row vector containing these two values in order.", "answer": "$$\\boxed{\\begin{pmatrix} 0.8000 & 0.2996 \\end{pmatrix}}$$", "id": "2823645"}, {"introduction": "Having understood the processes that generate phylogenetic patterns, we now turn to the methods used to infer them. Model-based inference, particularly using the criterion of maximum likelihood, is the cornerstone of modern phylogenetics. This practice demystifies the computational \"black box\" by having you manually calculate the likelihood of observed character data on a small tree using Felsenstein's pruning algorithm, the elegant and efficient engine for this task [@problem_id:2823628].", "problem": "Consider a binary discrete character evolving along a rooted three-taxon phylogeny under a continuous-time Markov chain (CTMC) with state space $\\{0,1\\}$. The instantaneous rate matrix is\n$$\nQ \\;=\\; \\begin{pmatrix}\n-1 & 1 \\\\\n1 & -1\n\\end{pmatrix},\n$$\nso that changes occur at rate $1$ per unit time and rows sum to zero. The rooted tree topology and branch lengths (in time units) are given in Newick form as `((A:0.3,B:0.3):0.2,C:0.5)`, which is ultrametric with root height $0.5$. The observed tip states are $A=1$, $B=0$, and $C=1$. Assume the prior distribution at the root (the root prior) is $\\pi = (\\pi_0,\\pi_1) = (0.7,0.3)$, where $\\pi_i$ is the prior probability that the root is in state $i$.\n\nUsing first principles for CTMCs and the dynamic-programming pruning algorithm for phylogenetic likelihood, compute the likelihood of the observed tip data given the tree, the rate matrix $Q$, and the root prior $\\pi$. That is, compute the scalar $L = \\Pr(\\text{data} \\mid \\text{tree},Q,\\pi)$ by propagating conditional likelihoods from the tips to the root and multiplying by the root prior at the end.\n\nExpress your final numerical answer as a single real number and round your answer to four significant figures.", "solution": "This problem requires the computation of the likelihood of observed character states on a phylogeny, a standard procedure in computational phylogenetics. The problem is well-posed and contains all necessary information. We will solve this by applying Felsenstein's pruning algorithm.\n\nFirst, we must formalize the problem components. The state space is $\\{0, 1\\}$. The instantaneous rate matrix is given as\n$$\nQ = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\nThe tree topology is specified in Newick format as `((A:0.3,B:0.3):0.2,C:0.5)`. Let us denote the root of the tree as $R$ and the internal node that is the parent of tips $A$ and $B$ as $N$. The structure is: $R$ is the parent of $N$ and $C$; $N$ is the parent of $A$ and $B$. The branch lengths are the time durations of evolution along those branches:\n- Branch from $N$ to $A$: $t_A = 0.3$\n- Branch from $N$ to $B$: $t_B = 0.3$\n- Branch from $R$ to $N$: $t_N = 0.2$\n- Branch from $R$ to $C$: $t_C = 0.5$\nThe observed states at the tips are $s_A=1$, $s_B=0$, and $s_C=1$.\nThe prior probability distribution for the state at the root $R$ is $\\pi = (\\pi_0, \\pi_1) = (0.7, 0.3)$.\n\nThe core of the calculation is the transition probability matrix $P(t) = \\exp(Qt)$, where $P_{ij}(t)$ is the probability of transitioning from state $i$ to state $j$ in time $t$. For the given symmetric rate matrix $Q$, the transition probabilities are well-known. We can derive them through matrix exponentiation. The eigenvalues of $Q$ are $\\lambda_1 = 0$ and $\\lambda_2 = -2$. The matrix of transition probabilities is:\n$$\nP(t) = \\begin{pmatrix} P_{00}(t) & P_{01}(t) \\\\ P_{10}(t) & P_{11}(t) \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1+\\exp(-2t) & 1-\\exp(-2t) \\\\ 1-\\exp(-2t) & 1+\\exp(-2t) \\end{pmatrix}\n$$\nSo, the probability of remaining in the same state is $P_{00}(t) = P_{11}(t) = \\frac{1}{2}(1 + \\exp(-2t))$, and the probability of changing state is $P_{01}(t) = P_{10}(t) = \\frac{1}{2}(1 - \\exp(-2t))$.\n\nThe pruning algorithm computes the likelihood by recursively calculating conditional likelihood vectors at each node, moving from the tips to the root. For any node $u$, the conditional likelihood vector is $L(u) = (L_0(u), L_1(u))$, where $L_i(u)$ is the probability of the observed data in the clade descending from $u$, given that the state at $u$ is $i$.\n\n1.  Initialization at the tips:\n    For a tip node with an observed state $s$, the conditional likelihood is $1$ for that state and $0$ for all others.\n    - Tip $A$ has state $1$: $L(A) = (L_0(A), L_1(A)) = (0, 1)$\n    - Tip $B$ has state $0$: $L(B) = (L_0(B), L_1(B)) = (1, 0)$\n    - Tip $C$ has state $1$: $L(C) = (L_0(C), L_1(C)) = (0, 1)$\n\n2.  Compute conditional likelihoods at internal node $N$:\n    Node $N$ is the parent of tips $A$ and $B$. For each state $i \\in \\{0, 1\\}$ at node $N$, we compute $L_i(N)$ using the likelihoods from its children:\n    $$\n    L_i(N) = \\left( \\sum_{j \\in \\{0,1\\}} P_{ij}(t_A) L_j(A) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{ik}(t_B) L_k(B) \\right)\n    $$\n    With $t_A = 0.3$ and $t_B = 0.3$:\n    - The first term is $P_{i0}(0.3)L_0(A) + P_{i1}(0.3)L_1(A) = P_{i0}(0.3) \\cdot 0 + P_{i1}(0.3) \\cdot 1 = P_{i1}(0.3)$.\n    - The second term is $P_{i0}(0.3)L_0(B) + P_{i1}(0.3)L_1(B) = P_{i0}(0.3) \\cdot 1 + P_{i1}(0.3) \\cdot 0 = P_{i0}(0.3)$.\n    Thus, $L_i(N) = P_{i1}(0.3) P_{i0}(0.3)$.\n    For $i=0$: $L_0(N) = P_{01}(0.3)P_{00}(0.3) = \\frac{1}{2}(1-\\exp(-0.6)) \\cdot \\frac{1}{2}(1+\\exp(-0.6)) = \\frac{1}{4}(1 - \\exp(-1.2))$.\n    For $i=1$: $L_1(N) = P_{11}(0.3)P_{10}(0.3) = \\frac{1}{2}(1+\\exp(-0.6)) \\cdot \\frac{1}{2}(1-\\exp(-0.6)) = \\frac{1}{4}(1 - \\exp(-1.2))$.\n    So, the vector is $L(N) = \\left( \\frac{1}{4}(1 - \\exp(-1.2)), \\frac{1}{4}(1 - \\exp(-1.2)) \\right)$.\n\n3.  Compute conditional likelihoods at the root $R$:\n    Node $R$ is the parent of node $N$ and tip $C$. For each state $i \\in \\{0, 1\\}$ at the root, we compute the conditional likelihood of the entire dataset, $L_{\\text{data}|i} \\equiv \\Pr(\\text{data} | \\text{state of } R = i)$.\n    $$\n    L_{\\text{data}|i} = \\left( \\sum_{j \\in \\{0,1\\}} P_{ij}(t_N) L_j(N) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{ik}(t_C) L_k(C) \\right)\n    $$\n    With $t_N = 0.2$ and $t_C = 0.5$:\n    - The second term is $P_{i0}(0.5)L_0(C) + P_{i1}(0.5)L_1(C) = P_{i0}(0.5) \\cdot 0 + P_{i1}(0.5) \\cdot 1 = P_{i1}(0.5)$.\n    - For the first term, since $L_0(N) = L_1(N) = \\frac{1}{4}(1 - \\exp(-1.2))$, we have:\n      $\\sum_{j} P_{ij}(0.2) L_j(N) = L_0(N) P_{i0}(0.2) + L_1(N) P_{i1}(0.2) = L_0(N) (P_{i0}(0.2) + P_{i1}(0.2))$.\n      Since $\\sum_j P_{ij}(t) = 1$ for any $i, t$, this simplifies to $L_0(N) \\cdot 1 = \\frac{1}{4}(1 - \\exp(-1.2))$.\n\n    Now we assemble the conditional likelihoods at the root:\n    For $i=0$:\n    $L_{\\text{data}|0} = \\left( \\frac{1}{4}(1 - \\exp(-1.2)) \\right) \\cdot P_{01}(0.5) = \\frac{1}{4}(1 - \\exp(-1.2)) \\cdot \\frac{1}{2}(1 - \\exp(-1.0)) = \\frac{1}{8}(1 - \\exp(-1.2))(1 - \\exp(-1.0))$.\n    For $i=1$:\n    $L_{\\text{data}|1} = \\left( \\frac{1}{4}(1 - \\exp(-1.2)) \\right) \\cdot P_{11}(0.5) = \\frac{1}{4}(1 - \\exp(-1.2)) \\cdot \\frac{1}{2}(1 + \\exp(-1.0)) = \\frac{1}{8}(1 - \\exp(-1.2))(1 + \\exp(-1.0))$.\n\n4.  Compute the total likelihood $L$:\n    Finally, we find the total likelihood by averaging the conditional likelihoods over the root prior distribution $\\pi = (\\pi_0, \\pi_1) = (0.7, 0.3)$.\n    $$\n    L = \\sum_{i \\in \\{0,1\\}} \\pi_i L_{\\text{data}|i} = \\pi_0 L_{\\text{data}|0} + \\pi_1 L_{\\text{data}|1}\n    $$\n    $$\n    L = 0.7 \\cdot \\frac{1}{8}(1 - \\exp(-1.2))(1 - \\exp(-1.0)) + 0.3 \\cdot \\frac{1}{8}(1 - \\exp(-1.2))(1 + \\exp(-1.0))\n    $$\n    We factor out the common term $\\frac{1}{8}(1 - \\exp(-1.2))$:\n    $$\n    L = \\frac{1}{8}(1 - \\exp(-1.2)) \\left[ 0.7(1 - \\exp(-1.0)) + 0.3(1 + \\exp(-1.0)) \\right]\n    $$\n    Simplifying the term in the brackets:\n    $$\n    [0.7 - 0.7\\exp(-1.0) + 0.3 + 0.3\\exp(-1.0)] = [1.0 - 0.4\\exp(-1.0)]\n    $$\n    Thus, the final analytical expression for the likelihood is:\n    $$\n    L = \\frac{1}{8}(1 - \\exp(-1.2))(1 - 0.4\\exp(-1.0))\n    $$\n\n5.  Numerical calculation:\n    We now substitute the numerical values for the exponential functions.\n    $\\exp(-1.0) \\approx 0.367879$\n    $\\exp(-1.2) \\approx 0.301194$\n    $$\n    L \\approx \\frac{1}{8}(1 - 0.301194)(1 - 0.4 \\cdot 0.367879)\n    $$\n    $$\n    L \\approx \\frac{1}{8}(0.698806)(1 - 0.147152)\n    $$\n    $$\n    L \\approx \\frac{1}{8}(0.698806)(0.852848)\n    $$\n    $$\n    L \\approx 0.125 \\cdot 0.596001 \\approx 0.0745001\n    $$\n    Rounding to four significant figures, the likelihood is $0.07450$.", "answer": "$$\\boxed{0.07450}$$", "id": "2823628"}, {"introduction": "Once a species phylogeny is inferred, it becomes a powerful tool for testing evolutionary hypotheses, but it also presents a statistical challenge: species are not independent data points due to their shared ancestry. This practice tackles this issue head-on by guiding you through the derivation of Phylogenetic Independent Contrasts (PICs), a foundational method for \"removing\" the effect of shared history from comparative data. By working through a simple example under a Brownian motion model, you will see how correlated trait values can be transformed into a set of independent variables suitable for standard statistical analyses [@problem_id:2823608].", "problem": "Consider a rooted ultrametric phylogeny with $3$ taxa, $A$, $B$, and $C$. Let node $1$ be the most recent common ancestor of $A$ and $B$, and let node $2$ be the root. The branch lengths are as follows: from node $1$ to $A$ is $t$, from node $1$ to $B$ is $t$, from node $2$ to node $1$ is $s$, and from node $2$ to $C$ is $s + t$, so that each root-to-tip path has total length $s + t$. A continuous trait evolves along the tree according to a Brownian Motion (BM) model with rate parameter $\\sigma^{2}$ per unit branch length: over any branch of length $b$, the increment in the trait value is a mean-zero normal random variable with variance $\\sigma^{2} b$, and increments on disjoint branches are independent.\n\nYou observe the trait at the tips, denoted $X_{A}$, $X_{B}$, and $X_{C}$. Using only the BM assumptions above and the fact that, for independent normal observations with known variances, the minimum-variance unbiased linear estimator of a common mean is the inverse-variance weighted average, carry out the following:\n\n$1.$ Derive the minimum-variance unbiased linear estimator $\\hat{X}_{1}$ of the ancestral state at node $1$ in terms of $X_{A}$ and $X_{B}$, and compute its estimation variance $\\operatorname{Var}(\\hat{X}_{1} \\mid X_{1})$.\n\n$2.$ Treat $\\hat{X}_{1}$ as an observation on the lineage leading to node $1$ with the estimation variance obtained in part $1$. Using $\\hat{X}_{1}$ and $X_{C}$, derive the minimum-variance unbiased linear estimator $\\hat{X}_{2}$ of the state at node $2$ and its estimation variance $\\operatorname{Var}(\\hat{X}_{2} \\mid X_{2})$.\n\n$3.$ Define two phylogenetically independent contrasts (PIC): the descendant contrast at node $1$, $U_{1} = \\dfrac{X_{A} - X_{B}}{\\sqrt{V_{1}}}$, and the root contrast at node $2$, $U_{2} = \\dfrac{\\hat{X}_{1} - X_{C}}{\\sqrt{V_{2}}}$, where $V_{1}$ and $V_{2}$ are the appropriate denominators equal to the total variance of the respective numerators expressed in units of branch length (do not include the factor $\\sigma^{2}$ in $V_{1}$ or $V_{2}$). Derive $V_{1}$ and $V_{2}$ from first principles using the BM model and your results from parts $1$ and $2$.\n\n$4.$ Under the BM model, compute $\\operatorname{Var}(U_{1})$ and $\\operatorname{Var}(U_{2})$ and show that they are equal and do not depend on $s$ or $t$.\n\nProvide as your final answer the common value of $\\operatorname{Var}(U_{1})$ and $\\operatorname{Var}(U_{2})$ as a single closed-form expression in terms of $\\sigma^{2}$. Do not include any units. No numerical rounding is required.", "solution": "The problem statement is scientifically grounded, internally consistent, and well-posed. It presents a standard, albeit simplified, exercise in phylogenetic comparative methods, specifically ancestral state reconstruction and the derivation of phylogenetic independent contrasts under a Brownian Motion model. All necessary parameters and conditions are provided for a unique mathematical solution. We will proceed with the derivation as requested, addressing each of the four parts in sequence.\n\nUnder the Brownian Motion (BM) model, the change in a trait value along a branch of length $b$ is a random variable drawn from a normal distribution with mean $0$ and variance $\\sigma^2 b$. Changes on disjoint branches are independent. Let $X_i$ denote the trait value at node or tip $i$.\n\nPart $1$: Derivation of the estimator for the state at node $1$, $\\hat{X}_{1}$, and its variance.\nNode $1$ is the common ancestor of tips $A$ and $B$. The branches from node $1$ to $A$ and from node $1$ to $B$ are disjoint, each with length $t$. Therefore, conditional on the state at node $1$, $X_{1}$, the trait values at the tips are independent normal random variables:\n$$X_{A} \\mid X_{1} \\sim N(X_{1}, \\sigma^{2} t)$$\n$$X_{B} \\mid X_{1} \\sim N(X_{1}, \\sigma^{2} t)$$\nWe are given that the minimum-variance unbiased linear estimator (MVUE) of a common mean from independent normal observations is the inverse-variance weighted average. The variances of the observations $X_{A}$ and $X_{B}$ (conditional on the mean $X_{1}$) are $v_A = \\sigma^2 t$ and $v_B = \\sigma^2 t$. The corresponding weights are $w_A = 1/v_A = 1/(\\sigma^2 t)$ and $w_B = 1/v_B = 1/(\\sigma^2 t)$.\nThe estimator $\\hat{X}_{1}$ is therefore:\n$$\\hat{X}_{1} = \\frac{w_{A} X_{A} + w_{B} X_{B}}{w_{A} + w_{B}} = \\frac{\\frac{1}{\\sigma^{2} t} X_{A} + \\frac{1}{\\sigma^{2} t} X_{B}}{\\frac{1}{\\sigma^{2} t} + \\frac{1}{\\sigma^{2} t}} = \\frac{X_{A} + X_{B}}{2}$$\nThe estimation variance, $\\operatorname{Var}(\\hat{X}_{1} \\mid X_{1})$, is the variance of this estimator conditional on the true value $X_{1}$. This is given by the formula $1/\\sum w_i$.\n$$\\operatorname{Var}(\\hat{X}_{1} \\mid X_{1}) = \\frac{1}{w_{A} + w_{B}} = \\frac{1}{\\frac{1}{\\sigma^{2} t} + \\frac{1}{\\sigma^{2} t}} = \\frac{1}{2/(\\sigma^{2} t)} = \\frac{\\sigma^{2} t}{2}$$\n\nPart $2$: Derivation of the estimator for the state at the root (node $2$), $\\hat{X}_{2}$, and its variance.\nWe estimate the root state $X_{2}$ using the tip observation $X_{C}$ and the estimated state $\\hat{X}_{1}$. These two pieces of information are independent because they descend from the root along disjoint paths. We must determine their respective variances conditional on $X_2$.\nFor tip $C$, the branch from the root has length $s+t$. Thus, the variance of $X_{C}$ conditional on $X_{2}$ is:\n$$\\operatorname{Var}(X_{C} \\mid X_{2}) = \\sigma^{2} (s+t)$$\nFor the estimated state $\\hat{X}_{1}$, we must account for both the evolutionary variance from the root to node $1$ (branch length $s$) and the estimation variance of $\\hat{X}_{1}$ relative to $X_{1}$ (from Part $1$). The total effective variance of $\\hat{X}_{1}$ as an observation of $X_{2}$ is the sum of these variances, as they arise from independent processes:\n$$\\operatorname{Var}(\\hat{X}_{1} \\mid X_{2}) = \\operatorname{Var}((\\hat{X}_{1} - X_{1}) + (X_{1} - X_{2}) \\mid X_{2}) = \\operatorname{Var}(\\hat{X}_{1} - X_{1}) + \\operatorname{Var}(X_{1} - X_{2})$$\n$$ \\operatorname{Var}(\\hat{X}_{1} \\mid X_{2}) = \\operatorname{Var}(\\hat{X}_{1} \\mid X_{1}) + \\sigma^{2} s = \\frac{\\sigma^{2} t}{2} + \\sigma^{2} s = \\sigma^{2} \\left(s + \\frac{t}{2}\\right) $$\nNow, we find the MVUE $\\hat{X}_{2}$ by taking the inverse-variance weighted average of $\\hat{X}_{1}$ and $X_{C}$. The weights are $w_{\\hat{X}_1} = 1/(\\sigma^2(s + t/2))$ and $w_{X_C} = 1/(\\sigma^2(s+t))$.\n$$\\hat{X}_{2} = \\frac{w_{\\hat{X}_1} \\hat{X}_{1} + w_{X_C} X_{C}}{w_{\\hat{X}_1} + w_{X_C}} = \\frac{\\frac{\\hat{X}_{1}}{\\sigma^{2} (s + t/2)} + \\frac{X_{C}}{\\sigma^{2}(s+t)}}{\\frac{1}{\\sigma^{2} (s + t/2)} + \\frac{1}{\\sigma^{2}(s+t)}} = \\frac{\\frac{\\hat{X}_{1}}{s + t/2} + \\frac{X_{C}}{s+t}}{\\frac{1}{s + t/2} + \\frac{1}{s+t}}$$\nThe estimation variance $\\operatorname{Var}(\\hat{X}_{2} \\mid X_{2})$ is:\n$$\\operatorname{Var}(\\hat{X}_{2} \\mid X_{2}) = \\frac{1}{w_{\\hat{X}_1} + w_{X_C}} = \\frac{1}{\\frac{1}{\\sigma^{2}(s+t/2)} + \\frac{1}{\\sigma^{2}(s+t)}} = \\sigma^{2} \\frac{(s+t/2)(s+t)}{s+t+s+t/2} = \\sigma^{2} \\frac{(s+t/2)(s+t)}{2s + 3t/2}$$\n\nPart $3$: Derivation of the variance denominators $V_{1}$ and $V_{2}$.\nThe term $V_1$ is defined such that $\\sigma^2 V_1 = \\operatorname{Var}(X_A - X_B)$. The difference $X_A - X_B$ can be written in terms of the independent evolutionary changes $\\epsilon_A \\sim N(0, \\sigma^2 t)$ and $\\epsilon_B \\sim N(0, \\sigma^2 t)$ along the branches from node $1$:\n$$X_A - X_B = (X_1 + \\epsilon_A) - (X_1 + \\epsilon_B) = \\epsilon_A - \\epsilon_B$$\nThe variance is:\n$$\\operatorname{Var}(X_A - X_B) = \\operatorname{Var}(\\epsilon_A) + \\operatorname{Var}(\\epsilon_B) = \\sigma^2 t + \\sigma^2 t = 2\\sigma^2 t$$\nBy definition, $\\sigma^2 V_1 = 2\\sigma^2 t$, which gives:\n$$V_1 = 2t$$\nThe term $V_2$ is defined such that $\\sigma^2 V_2 = \\operatorname{Var}(\\hat{X}_1 - X_C)$. This is the variance of the difference between our two independent observations used to estimate $X_2$. The variance of a difference of independent random variables is the sum of their variances.\n$$\\operatorname{Var}(\\hat{X}_1 - X_C) = \\operatorname{Var}((\\hat{X}_1 - X_2) - (X_C - X_2)) = \\operatorname{Var}(\\hat{X}_1 - X_2) + \\operatorname{Var}(X_C - X_2)$$\nUsing the conditional variances derived in Part $2$:\n$$\\operatorname{Var}(\\hat{X}_1 - X_C) = \\operatorname{Var}(\\hat{X}_1 \\mid X_2) + \\operatorname{Var}(X_C \\mid X_2) = \\sigma^{2} \\left(s + \\frac{t}{2}\\right) + \\sigma^{2}(s+t)$$\n$$\\operatorname{Var}(\\hat{X}_1 - X_C) = \\sigma^{2} \\left(2s + \\frac{3t}{2}\\right)$$\nBy definition, $\\sigma^2 V_2 = \\sigma^{2} (2s + 3t/2)$, which gives:\n$$V_2 = 2s + \\frac{3t}{2}$$\n\nPart $4$: Computation of the variances of the phylogenetically independent contrasts.\nThe first contrast is $U_{1} = \\frac{X_{A} - X_{B}}{\\sqrt{V_{1}}}$. Its variance is:\n$$\\operatorname{Var}(U_{1}) = \\operatorname{Var}\\left(\\frac{X_{A} - X_{B}}{\\sqrt{V_{1}}}\\right) = \\frac{1}{V_1} \\operatorname{Var}(X_{A} - X_{B})$$\nUsing the result from Part $3$, $\\operatorname{Var}(X_A - X_B) = \\sigma^2 V_1 = 2\\sigma^2 t$ and $V_1 = 2t$:\n$$\\operatorname{Var}(U_{1}) = \\frac{1}{2t} (2\\sigma^2 t) = \\sigma^2$$\nThe second contrast is $U_{2} = \\frac{\\hat{X}_{1} - X_{C}}{\\sqrt{V_{2}}}$. Its variance is:\n$$\\operatorname{Var}(U_{2}) = \\operatorname{Var}\\left(\\frac{\\hat{X}_{1} - X_{C}}{\\sqrt{V_{2}}}\\right) = \\frac{1}{V_2} \\operatorname{Var}(\\hat{X}_{1} - X_{C})$$\nUsing the result from Part $3$, $\\operatorname{Var}(\\hat{X}_1 - X_C) = \\sigma^2 V_2 = \\sigma^2 (2s + 3t/2)$ and $V_2 = 2s + 3t/2$:\n$$\\operatorname{Var}(U_{2}) = \\frac{1}{2s + 3t/2} \\left( \\sigma^2 \\left(2s + \\frac{3t}{2}\\right) \\right) = \\sigma^2$$\nAs demonstrated, $\\operatorname{Var}(U_{1}) = \\operatorname{Var}(U_{2}) = \\sigma^2$. The variances of the standardized contrasts are equal to each other and to the BM rate parameter $\\sigma^2$. This value is a constant that does not depend on the branch length parameters $s$ or $t$. This outcome is the central property of phylogenetic independent contrasts: they transform correlated trait data into a set of independent and identically distributed variables whose variance is directly related to the evolutionary rate.", "answer": "$$\\boxed{\\sigma^{2}}$$", "id": "2823608"}]}