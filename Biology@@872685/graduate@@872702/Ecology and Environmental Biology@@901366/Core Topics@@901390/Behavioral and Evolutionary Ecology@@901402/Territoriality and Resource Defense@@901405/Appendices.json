{"hands_on_practices": [{"introduction": "At its core, territoriality is an economic problem of resource allocation. This practice immerses you in this fundamental concept by tasking you with building and solving a cost-benefit model from first principles. You will determine the optimal time a nectar-feeding bird should dedicate to defending its territory by balancing the energetic gains from improved foraging against the costs of patrolling and the risk of injury [@problem_id:2537303]. This exercise provides essential practice in applying optimality theory, a cornerstone of behavioral ecology, and honing your skills in using calculus to solve biological trade-offs.", "problem": "A territorial nectar-feeding bird faces a daily allocation problem between territorial defense (patrolling and repelling intruders) and foraging. Assume the individual maximizes expected net daily energy gain subject to a finite time budget, a standard optimality principle in behavioral ecology: choose the time allocated to defense, denoted by $t_{d}$ (in $\\mathrm{h}$), to maximize net energy intake (in $\\mathrm{kJ}$) over a day of length $T$.\n\nYou are given the following empirically grounded components and parameters:\n\n- Time budget: $T = 24\\,\\mathrm{h}$, so foraging time is $t_{f} = T - t_{d}$.\n- Patrol cost: energetic cost per hour of defense is $c_{p} = 40\\,\\mathrm{kJ\\,h^{-1}}$.\n- Baseline foraging rate without defense is $b_{0} = 100\\,\\mathrm{kJ\\,h^{-1}}$.\n- Defense improves the realized foraging rate by reducing resource loss to intruders with diminishing returns; the defended foraging rate is\n  $$b(t_{d}) = b_{0} + \\alpha \\left(1 - \\exp(-\\beta t_{d})\\right),$$\n  with $\\alpha = 60\\,\\mathrm{kJ\\,h^{-1}}$ and $\\beta = 0.2\\,\\mathrm{h^{-1}}$.\n- Injury risk: expected number of contests increases linearly with defense time as $\\lambda(t_{d}) = \\lambda_{0}\\, t_{d}$ with $\\lambda_{0} = 0.05\\,\\mathrm{h^{-1}}$. Each contest entails an expected injury loss of $E = 500\\,\\mathrm{kJ}$, so the expected injury loss over the day is $E\\,\\lambda(t_{d})$.\n\nUnder a simple additive payoff model, the expected net daily energy payoff is\n$$P(t_{d}) \\;=\\; b(t_{d})\\,(T - t_{d}) \\;-\\; c_{p}\\,t_{d} \\;-\\; E\\,\\lambda(t_{d}).$$\n\nCompute the optimal daily allocation to defense $t_{d}^{\\star}$ that maximizes $P(t_{d})$, subject to $0 \\le t_{d} \\le T$. Round your answer to three significant figures and express it in hours.", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens.\n- Total time budget: $T = 24\\,\\mathrm{h}$\n- Time allocated to defense: $t_{d}$ (in $\\mathrm{h}$)\n- Time allocated to foraging: $t_{f} = T - t_{d}$\n- Patrol cost per hour: $c_{p} = 40\\,\\mathrm{kJ\\,h^{-1}}$\n- Baseline foraging rate: $b_{0} = 100\\,\\mathrm{kJ\\,h^{-1}}$\n- Defended foraging rate function: $b(t_{d}) = b_{0} + \\alpha (1 - \\exp(-\\beta t_{d}))$\n- Parameter for foraging gain: $\\alpha = 60\\,\\mathrm{kJ\\,h^{-1}}$\n- Parameter for diminishing returns: $\\beta = 0.2\\,\\mathrm{h^{-1}}$\n- Expected number of contests function: $\\lambda(t_{d}) = \\lambda_{0}\\, t_{d}$\n- Parameter for contest rate: $\\lambda_{0} = 0.05\\,\\mathrm{h^{-1}}$\n- Expected injury loss per contest: $E = 500\\,\\mathrm{kJ}$\n- Expected net daily energy payoff function: $P(t_{d}) = b(t_{d})\\,(T - t_{d}) - c_{p}\\,t_{d} - E\\,\\lambda(t_{d})$\n- Constraint: $0 \\le t_{d} \\le T$\n- Objective: Find the optimal defense time $t_{d}^{\\star}$ that maximizes $P(t_{d})$.\n- Required precision: Round answer to three significant figures.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is a standard optimization exercise in the field of behavioral ecology. It is scientifically grounded in optimality theory, a core principle in this discipline. The mathematical model is well-posed, using continuous and differentiable functions (exponential and linear terms) which are common for modeling biological trade-offs with diminishing returns and linear costs. All parameters and functions are explicitly defined, and the units are dimensionally consistent. For example, the product $b(t_d)(T-t_d)$ yields units of energy ($\\mathrm{kJ\\,h^{-1}} \\times \\mathrm{h} = \\mathrm{kJ}$), as do all other terms in the payoff function. The problem is self-contained, objective, and does not violate any fundamental principles of mathematics or science. It requires a standard application of differential calculus to find the maximum of a function over a closed interval.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A solution will be derived.\n\nThe objective is to find the value of $t_{d}$ in the interval $[0, T]$ that maximizes the expected net daily energy payoff, $P(t_{d})$. The payoff function is given by:\n$$P(t_{d}) = b(t_{d})\\,(T - t_{d}) - c_{p}\\,t_{d} - E\\,\\lambda(t_{d})$$\nWe substitute the expressions for $b(t_{d})$ and $\\lambda(t_{d})$:\n$$P(t_{d}) = \\left[b_{0} + \\alpha \\left(1 - \\exp(-\\beta t_{d})\\right)\\right](T - t_{d}) - c_{p}\\,t_{d} - E\\,\\lambda_{0}\\,t_{d}$$\nTo find the maximum, we must compute the first derivative of $P(t_{d})$ with respect to $t_{d}$ and set it to zero. First, let us group the linear terms in $t_{d}$:\n$$P(t_{d}) = \\left(b_{0} + \\alpha\\right)(T - t_{d}) - \\alpha(T - t_{d})\\exp(-\\beta t_{d}) - (c_{p} + E \\lambda_{0})t_{d}$$\nNow, we differentiate $P(t_{d})$ with respect to $t_{d}$, using the product rule for the term $-\\alpha(T - t_{d})\\exp(-\\beta t_{d})$:\n$$\\frac{dP}{dt_{d}} = -(b_{0} + \\alpha) - \\alpha\\left[(-1)\\exp(-\\beta t_{d}) + (T - t_{d})(-\\beta\\exp(-\\beta t_{d}))\\right] - (c_{p} + E \\lambda_{0})$$\nSimplifying the expression:\n$$\\frac{dP}{dt_{d}} = -(b_{0} + \\alpha) + \\alpha\\exp(-\\beta t_{d}) + \\alpha\\beta(T - t_{d})\\exp(-\\beta t_{d}) - (c_{p} + E \\lambda_{0})$$\nFactoring out the term $\\alpha\\exp(-\\beta t_{d})$:\n$$\\frac{dP}{dt_{d}} = \\alpha\\exp(-\\beta t_{d}) \\left[1 + \\beta(T - t_{d})\\right] - (b_{0} + \\alpha + c_{p} + E \\lambda_{0})$$\nTo find the critical points, we set the derivative to zero:\n$$\\alpha\\exp(-\\beta t_{d}^{\\star}) \\left[1 + \\beta(T - t_{d}^{\\star})\\right] = b_{0} + \\alpha + c_{p} + E \\lambda_{0}$$\nThis is the optimality condition. To verify that a solution $t_{d}^{\\star}$ corresponds to a maximum, we check the sign of the second derivative, $P''(t_d)$.\n$$P''(t_d) = \\frac{d^{2}P}{dt_{d}^{2}} = \\alpha \\left\\{ (-\\beta \\exp(-\\beta t_d))[1 + \\beta(T-t_d)] + (\\exp(-\\beta t_d))(-\\beta) \\right\\}$$\n$$P''(t_d) = -\\alpha \\beta \\exp(-\\beta t_d) \\left[ 1 + \\beta(T-t_d) + 1 \\right]$$\n$$P''(t_d) = -\\alpha \\beta \\exp(-\\beta t_d) \\left[ 2 + \\beta T - \\beta t_d \\right]$$\nGiven that $\\alpha > 0$, $\\beta > 0$, and $\\exp(-\\beta t_d) > 0$, the sign of $P''(t_d)$ is determined by the term in the brackets. The parameters are $T=24$, $\\beta=0.2$. Thus, $2 + \\beta T = 2 + 0.2 \\times 24 = 2 + 4.8 = 6.8$. The term becomes $6.8 - 0.2 t_d$. For any $t_d$ in the valid range $[0, 24]$, this term is positive ($6.8 - 0.2 \\times 24 = 6.8 - 4.8 = 2 > 0$). Therefore, $P''(t_d)$ is always negative on the domain of interest. This confirms the function $P(t_d)$ is strictly concave, and the critical point is a unique global maximum.\n\nWe now solve the optimality condition for $t_{d}^{\\star}$ by first substituting the given numerical values:\n- $T = 24$\n- $c_{p} = 40$\n- $b_{0} = 100$\n- $\\alpha = 60$\n- $\\beta = 0.2$\n- $\\lambda_{0} = 0.05$\n- $E = 500$\nThe right side of the optimality condition is:\n$$b_{0} + \\alpha + c_{p} + E \\lambda_{0} = 100 + 60 + 40 + (500)(0.05) = 200 + 25 = 225$$\nThe equation becomes:\n$$60 \\exp(-0.2 t_{d}^{\\star}) \\left[1 + 0.2(24 - t_{d}^{\\star})\\right] = 225$$\n$$\\exp(-0.2 t_{d}^{\\star}) \\left[1 + 4.8 - 0.2 t_{d}^{\\star}\\right] = \\frac{225}{60}$$\n$$\\exp(-0.2 t_{d}^{\\star}) \\left[5.8 - 0.2 t_{d}^{\\star}\\right] = 3.75$$\nThis is a transcendental equation for $t_{d}^{\\star}$ that cannot be solved analytically using elementary functions. We must use a numerical method. Let $f(t_d) = \\exp(-0.2 t_d) (5.8 - 0.2 t_d) - 3.75$. We search for the root of $f(t_d) = 0$ in the interval $[0, 24]$.\nAt $t_d = 0$, $f(0) = \\exp(0)(5.8) - 3.75 = 2.05 > 0$.\nAt $t_d = T=24$, $f(24) = \\exp(-4.8)(5.8 - 4.8) - 3.75 = \\exp(-4.8) - 3.75 < 0$.\nSince the function is continuous and changes sign, a root exists in the interval. As $P''(t_d)<0$, $P'(t_d)$ is monotonically decreasing, so this root is unique.\nUsing a numerical solver (e.g., Newton's method or a bisection method), we find the solution:\n$$t_{d}^{\\star} \\approx 1.85135\\,\\mathrm{h}$$\nThe problem requires the answer to be rounded to three significant figures.\n$$t_{d}^{\\star} \\approx 1.85\\,\\mathrm{h}$$\nThis value lies within the valid domain $[0, 24]$, and represents the optimal time allocation to defense that maximizes the bird's net daily energy gain.", "answer": "$$ \\boxed{1.85} $$", "id": "2537303"}, {"introduction": "Moving from the decisions of a single individual to broader ecological patterns, this problem explores how territorial behavior scales with organismal traits and environmental conditions. You will derive a predictive scaling law for territory area based on fundamental principles, including the metabolic theory of ecology (Kleiber's Law) and the equilibrium condition where energy intake meets metabolic demand [@problem_id:2537336]. This practice is a classic example of how simple models can generate powerful, testable predictions about how territory size should systematically vary with body mass and resource density across different species and habitats.", "problem": "A territorial vertebrate species defends exclusive areas such that, on average, each territory holder meets its daily energy requirements from resources within its defended area. Consider a single species in a homogeneous habitat where resource density is denoted by $R$ (energy per unit area), individual body mass is $M$, and territory area is $T$. Assume the following foundational, well-tested principles and definitions apply over the range of conditions considered:\n\n- The daily metabolic energy requirement scales with body mass as $E(M) = k M^{\\beta}$ with $\\beta = 3/4$ (Kleiber’s law), where $k$ is a constant for the species and habitat.\n- The assimilable energy intake rate per unit area is proportional to resource density in this regime, so that expected daily assimilable energy from a territory of area $T$ is $a R T$, where $a$ is a constant that bundles encounter efficiency, assimilation efficiency, and time available for foraging. Over the changes considered, $a$ can be treated as independent of $M$ and $R$.\n- Territory area adjusts such that expected intake balances requirement at equilibrium, that is, $a R T = E(M)$.\n\nStarting from these assumptions and no others, derive how $T$ scales with $M$ and $R$. Then, using the derived scaling, compute the expected multiplicative change in territory area when resource density is halved (i.e., multiplied by $0.5$) and body mass increases by a factor of $1.2$. Express your final answer as a single dimensionless multiplicative factor, rounded to four significant figures. Do not include units in your final answer.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\nStep 1: Extract Givens.\nThe givens are listed verbatim as provided in the problem statement.\n- Resource density: $R$ (energy per unit area)\n- Individual body mass: $M$\n- Territory area: $T$\n- Daily metabolic energy requirement: $E(M) = k M^{\\beta}$\n- Scaling exponent for metabolism: $\\beta = 3/4$\n- Constant for metabolic requirement: $k$\n- Expected daily assimilable energy from a territory: $a R T$\n- Constant for energy intake: $a$\n- Equilibrium condition: $a R T = E(M)$\n- The task is to derive the scaling of $T$ with $M$ and $R$.\n- The task is to compute the multiplicative change in $T$ when $R$ is changed by a factor of $0.5$ and $M$ is changed by a factor of $1.2$.\n- The final answer must be a dimensionless factor rounded to four significant figures.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on fundamental and well-accepted principles of metabolic ecology, namely Kleiber's law for metabolic scaling ($E \\propto M^{3/4}$) and the general ecological principle that territory size is determined by the balance between energy requirements and resource availability. These are not speculative claims.\n- **Well-Posed**: The problem provides a closed system of equations and variables. The relationships are clearly defined, leading to a derivable scaling law and a computable, unique numerical answer.\n- **Objective**: The language is precise and quantitative, free of any subjectivity or ambiguity.\n- **Flaw Analysis**:\n  - The problem does not violate any scientific principles; it applies them.\n  - It is a formalizable problem central to the topic of ecological territoriality.\n  - The setup is complete and internally consistent; all necessary information is provided.\n  - The assumptions, while simplifications of reality, are standard and plausible for ecological modeling.\n  - The problem is well-structured and admits a unique, stable solution.\n  - The problem is neither trivial nor pseudo-profound; it requires a straightforward but non-obvious derivation.\n  - The model and its predictions are, in principle, verifiable against empirical data.\n\nStep 3: Verdict and Action.\nThe problem statement is valid. It is scientifically sound, well-posed, objective, and complete. I will proceed with the solution.\n\nThe solution is derived from the given equilibrium condition, which states that the expected energy intake from a territory must equal the animal's metabolic energy requirement. This is expressed as:\n$$a R T = E(M)$$\nThe problem provides the specific form for the daily metabolic energy requirement, $E(M)$, according to Kleiber's law:\n$$E(M) = k M^{\\beta}$$\nwith the exponent given as $\\beta = 3/4$. Substituting this expression for $E(M)$ into the equilibrium equation yields:\n$$a R T = k M^{3/4}$$\nThe first task is to derive how territory area, $T$, scales with body mass, $M$, and resource density, $R$. To achieve this, we must algebraically isolate $T$ on one side of the equation. Dividing both sides by the product $a R$ gives:\n$$T = \\frac{k M^{3/4}}{a R}$$\nSince $k$ and $a$ are defined as constants, we can express this as a proportionality:\n$$T \\propto M^{3/4} R^{-1}$$\nThis is the scaling relationship for territory area. It shows that territory area increases with body mass to the power of $3/4$ and is inversely proportional to the resource density.\n\nThe second task is to compute the multiplicative change in territory area, $T$, for a specified change in $M$ and $R$. Let the initial state be defined by variables $(T_1, M_1, R_1)$ and the final state by $(T_2, M_2, R_2)$. The multiplicative change in territory area is the ratio $T_2 / T_1$.\nUsing the derived relationship for both states:\n$$T_1 = \\frac{k}{a} M_1^{3/4} R_1^{-1}$$\n$$T_2 = \\frac{k}{a} M_2^{3/4} R_2^{-1}$$\nThe ratio is then:\n$$\\frac{T_2}{T_1} = \\frac{\\frac{k}{a} M_2^{3/4} R_2^{-1}}{\\frac{k}{a} M_1^{3/4} R_1^{-1}}$$\nThe constant term $\\frac{k}{a}$ cancels, leaving:\n$$\\frac{T_2}{T_1} = \\frac{M_2^{3/4} R_2^{-1}}{M_1^{3/4} R_1^{-1}} = \\left(\\frac{M_2}{M_1}\\right)^{3/4} \\left(\\frac{R_2}{R_1}\\right)^{-1} = \\left(\\frac{M_2}{M_1}\\right)^{3/4} \\left(\\frac{R_1}{R_2}\\right)$$\nThe problem specifies the changes: body mass increases by a factor of $1.2$, and resource density is halved. This translates to:\n$$\\frac{M_2}{M_1} = 1.2$$\n$$\\frac{R_2}{R_1} = 0.5$$\nSubstituting these factors into the expression for the ratio $\\frac{T_2}{T_1}$:\n$$\\frac{T_2}{T_1} = (1.2)^{3/4} \\left(\\frac{1}{0.5}\\right) = (1.2)^{3/4} \\times 2$$\nNow, we must compute the numerical value of this expression.\n$$(1.2)^{3/4} = (1.2)^{0.75} \\approx 1.1465315$$\nMultiplying this result by $2$:\n$$\\frac{T_2}{T_1} \\approx 1.1465315 \\times 2 \\approx 2.293063$$\nThe problem requires the answer to be rounded to four significant figures. The fifth significant digit is $0$, so we round down.\nThe final multiplicative factor is $2.293$.", "answer": "$$\n\\boxed{2.293}\n$$", "id": "2537336"}, {"introduction": "Real-world landscapes are rarely uniform; resources are often clumped into valuable hotspots, and the presence of competitors creates a complex spatial puzzle. This final practice challenges you to tackle this complexity head-on with a computational approach to territory design [@problem_id:2537343]. By implementing an algorithm to search for an optimal territory polygon, you will integrate concepts of resource value, defense costs, and competitor exclusion in a spatially explicit context. This exercise bridges the gap between abstract theory and applied spatial ecology, developing your skills in computational modeling and geometric optimization.", "problem": "Consider a focal territorial organism that selects a contiguous defended area in a plane to maximize a cost–benefit trade-off under competitor exclusion. You are given the positions of the focal organism’s den (nest), point-like resource hotspots with associated values, and competitor core locations with circular exclusion buffers. The organism’s defended area must be a simple polygon that contains the den, and it is assumed to be the convex hull of the den together with a chosen subset of hotspots, reflecting minimal patrol cost for enclosing those points.\n\nFundamental base and definitions:\n- The net payoff of a territory polygon $T$ is $J(T) = \\sum_{i=1}^{n} v_i \\,\\mathbf{1}\\{h_i \\in T\\} - k \\, L(T)$, where $h_i \\in \\mathbb{R}^2$ is the position of hotspot $i$, $v_i \\in \\mathbb{R}_{\\ge 0}$ is its value measured in Resource Units (RU), $k \\in \\mathbb{R}_{>0}$ is the perimeter cost coefficient in RU per meter, $L(T)$ is the perimeter of $T$ in meters, and $\\mathbf{1}\\{\\cdot\\}$ is the indicator function with boundary inclusion, that is, points on $\\partial T$ are counted as contained. All distances are measured in meters.\n- Competitor cores impose exclusion zones. For competitor $j$ at position $c_j \\in \\mathbb{R}^2$ with exclusion radius $r_j \\in \\mathbb{R}_{>0}$, the defended polygon $T$ is feasible only if it does not intersect or touch the closed disc $D(c_j, r_j) = \\{x \\in \\mathbb{R}^2 : \\|x - c_j\\|_2 \\le r_j\\}$. Equivalently, the minimum Euclidean distance from $c_j$ to $T$ must strictly exceed $r_j$; if $c_j \\in T$ or the minimum distance from $c_j$ to any point on $\\partial T$ is $\\le r_j$, then $T$ is infeasible.\n- Feasible territory set: For any subset $S \\subseteq \\{1,\\dots,n\\}$ of hotspot indices, define the candidate polygon $T_S$ as the convex hull of $\\{N\\} \\cup \\{h_i : i \\in S\\}$, where $N \\in \\mathbb{R}^2$ is the den position. If $|\\mathrm{CH}(\\{N\\} \\cup \\{h_i : i \\in S\\})| \\ge 3$, then $T_S$ is a proper polygon with perimeter $L(T_S)$ given by the sum of edge lengths in meters. If $|\\mathrm{CH}(\\cdot)| < 3$, treat $T_S$ as degenerate with zero defended area and define $L(T_S) = 0$; in this case, a hotspot is counted as captured only if it lies exactly on the degenerate object (the single point or the line segment).\n- Objective: Among all subsets $S \\subseteq \\{1,\\dots,n\\}$ whose $T_S$ is feasible with respect to all competitor discs, select $S^\\star$ that maximizes $J(T_{S})$. Ties must be broken deterministically by the following rule: if $J(T_{S_1}) = J(T_{S_2})$ up to a tolerance of $\\varepsilon = 10^{-9}$, prefer the one with smaller $L(T_{S})$; if still tied within the same tolerance, prefer the one with lexicographically smaller sorted list of captured hotspot indices (i.e., all $i$ with $h_i \\in T_S$, including any incidentally enclosed points not in $S$).\n\nRequired implementation approach:\n- You must implement an exhaustive search over all subsets $S \\subseteq \\{1,\\dots,n\\}$, compute $T_S$ as described, test feasibility against competitor discs, calculate $J(T_S)$, and select the optimal according to the tie-breaking rule. Geometric predicates must include boundary cases with an absolute tolerance $\\varepsilon = 10^{-9}$ as specified.\n- Use the convex hull construction to define candidate polygons. Use Euclidean distances in meters. Treat boundary inclusion for resource capture and boundary exclusion for competitor buffers (intersection or tangency to any $D(c_j, r_j)$ is infeasible).\n- Express the final numerical answers, one per test case, as floats in Resource Units (RU), each rounded to six decimal places.\n\nTest suite and inputs:\nFor all cases below, the den position is $N = (0.0, 0.0)$ meters. The set of $n = 8$ hotspots is common to all cases, with indices $i \\in \\{0,1,2,3,4,5,6,7\\}$, positions $h_i = (x_i, y_i)$ in meters, and values $v_i$ in RU as follows:\n- $i = 0$: $h_0 = (2.0, 1.0)$, $v_0 = 10.0$.\n- $i = 1$: $h_1 = (3.0, 0.0)$, $v_1 = 8.0$.\n- $i = 2$: $h_2 = (2.5, 1.5)$, $v_2 = 7.0$.\n- $i = 3$: $h_3 = (-1.0, -0.5)$, $v_3 = 3.0$.\n- $i = 4$: $h_4 = (4.0, 0.0)$, $v_4 = 6.0$.\n- $i = 5$: $h_5 = (0.5, 3.0)$, $v_5 = 5.0$.\n- $i = 6$: $h_6 = (5.0, 2.0)$, $v_6 = 9.0$.\n- $i = 7$: $h_7 = (-2.0, 2.0)$, $v_7 = 4.0$.\n\nProvide solutions for the following four cases:\n- Case A (happy path): perimeter cost $k = 2.0$ RU/m; one competitor $c_0 = (6.0, 1.0)$ meters with radius $r_0 = 1.0$ meters.\n- Case B (high perimeter penalty): perimeter cost $k = 5.0$ RU/m; one competitor $c_0 = (6.0, 1.0)$ meters with radius $r_0 = 1.0$ meters.\n- Case C (competitor near a hotspot cluster): perimeter cost $k = 2.0$ RU/m; two competitors: $c_0 = (6.0, 1.0)$ meters with radius $r_0 = 1.0$ meters, and $c_1 = (2.8, 0.7)$ meters with radius $r_1 = 0.6$ meters.\n- Case D (low perimeter penalty, additional competitor constraint): perimeter cost $k = 0.5$ RU/m; two competitors: $c_0 = (6.0, 1.0)$ meters with radius $r_0 = 1.0$ meters, and $c_1 = (3.5, 0.5)$ meters with radius $r_1 = 0.7$ meters.\n\nFinal output format:\nYour program should produce a single line of output containing the optimal net payoffs for Cases A, B, C, and D, in that order, as a comma-separated list enclosed in square brackets. Each entry must be a float rounded to six decimal places in Resource Units (RU), for example, $[12.345678,9.876543, \\dots]$.", "solution": "The problem requires finding an optimal territorial polygon by maximizing a net payoff function, which balances the value of captured resources against the cost associated with the territory's perimeter. The territory is defined as the convex hull of the organism's den and a chosen subset of resource hotspots. This optimization is constrained by competitor exclusion zones, which the territory must not intersect.\n\nThe problem, having been validated as well-posed and scientifically grounded within the framework of theoretical ecology, admits a solution via exhaustive search. Given the small number of hotspots, $n=8$, the total number of candidate territories, corresponding to the power set of hotspots, is $2^8 = 256$. This search space is computationally tractable.\n\nThe algorithm proceeds as follows for each test case provided:\n\n1.  **Iteration over Subsets**: We generate all $2^8$ subsets $S$ of the set of hotspot indices $\\{0, 1, \\dots, 7\\}$. For each subset, we define a candidate territory $T_S$. The empty set $S = \\emptyset$ is included, yielding a baseline territory consisting of only the den $N$.\n\n2.  **Territory Construction**: The candidate territory $T_S$ is the convex hull of the point set $\\{N\\} \\cup \\{h_i : i \\in S\\}$.\n    *   **Non-degenerate Case**: If the point set contains at least $3$ non-collinear points, its convex hull constitutes a simple polygon. We use a standard computational geometry algorithm, provided by the `scipy.spatial.ConvexHull` library function, to determine the vertices of this polygon. The perimeter $L(T_S)$ is then the sum of the lengths of the polygon's edges.\n    *   **Degenerate Case**: If the convex hull of the point set has fewer than $3$ vertices (i.e., the points are collinear or coincident), the problem defines the territory as a degenerate object (a single point or a line segment). For such cases, the perimeter is explicitly defined to be $L(T_S) = 0$.\n\n3.  **Feasibility Analysis**: Each candidate territory $T_S$ must be evaluated against all competitor exclusion zones. A territory is deemed feasible if and only if it maintains a strict positive distance from every closed competitor disc $D(c_j, r_j)$. This means the minimum Euclidean distance from a competitor's center $c_j$ to any point in the territory $T_S$ must be strictly greater than the competitor's exclusion radius $r_j$.\n    *   The minimum distance from an external point $c_j$ to a convex polygon $T_S$ is the smallest of the distances from $c_j$ to the vertices and edges of $T_S$. If $c_j$ is inside $T_S$, this distance is $0$.\n    *   For degenerate territories, the check involves calculating the minimum distance from $c_j$ to the point or line segment.\n    *   Any territory for which this condition, $\\min_{p \\in T_S} \\|c_j - p\\|_2 > r_j$, is violated for any competitor $j$ is discarded.\n\n4.  **Net Payoff Calculation**: For each feasible territory, the net payoff $J(T_S)$ is computed according to the formula $J(T_S) = V_S - k \\cdot L(T_S)$.\n    *   The total resource value, $V_S$, is the sum of values $v_i$ for all hotspots $h_i$ that are captured by the territory. A hotspot is captured if it lies inside or on the boundary of $T_S$. This check is performed for all $n=8$ hotspots, regardless of whether they were in the generating set $S$.\n    *   The perimeter cost is the product of the perimeter $L(T_S)$ and the cost coefficient $k$.\n\n5.  **Optimal Selection**: The algorithm maintains a record of the best solution found thus far, initialized with the baseline case of the den-only territory (which has a payoff of $J=0$). Each new feasible solution is compared against the current optimum, and an update is performed based on the specified hierarchical tie-breaking protocol:\n    a. The primary criterion is the maximization of the net payoff $J(T_S)$.\n    b. If payoffs are equal within a tolerance of $\\varepsilon = 10^{-9}$, the territory with the smaller perimeter $L(T_S)$ is preferred.\n    c. If both payoff and perimeter are tied, the tie is broken by selecting the solution whose sorted list of captured hotspot indices is lexicographically smaller.\n\nThis exhaustive evaluation guarantees that the final selected territory is the unique optimum according to the problem's criteria. The net payoff of this optimal territory is the final answer for each case.", "answer": "$$ \\boxed{[11.085885, 0.000000, 5.633975, 41.970597]} $$", "id": "2537343"}]}