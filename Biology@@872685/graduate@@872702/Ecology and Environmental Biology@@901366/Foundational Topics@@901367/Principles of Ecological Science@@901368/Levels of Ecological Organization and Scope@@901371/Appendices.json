{"hands_on_practices": [{"introduction": "A cornerstone of ecology is understanding how the characteristics of individuals scale up to determine the dynamics of the entire population. This practice uses a stage-structured matrix model, a powerful tool for this purpose. By translating individual-level vital rates like survival, growth, and fecundity into a projection matrix, you will predict the long-term growth rate and stable structure of a population, which are classic emergent properties at the population level of organization [@problem_id:2502393].", "problem": "A stage-structured population is monitored at the population level (an ecological level of organization) with three life stages: seedling ($L$), juvenile ($J$), and adult ($A$). The census interval is one year. Individuals can remain in their current stage or grow to the next stage between censuses; there is no retrogression. Adults reproduce, and their offspring enter the seedling stage by the next census. The following annual vital rates are estimated from long-term demographic data:\n\n- Seedling stasis: a seedling remains a seedling with probability $0.4$.\n- Seedling growth: a seedling becomes a juvenile with probability $0.3$.\n- Juvenile stasis: a juvenile remains a juvenile with probability $0.6$.\n- Juvenile growth: a juvenile becomes an adult with probability $0.2$.\n- Adult stasis (survival): an adult remains an adult with probability $0.8$.\n- Fecundity: each adult produces an average of $4$ recruits that survive to be counted as seedlings at the next census; juveniles and seedlings do not reproduce.\n\n1) Using only the core definition that the next-year population vector $\\mathbf{n}_{t+1}$ is given by the stage projection matrix $\\mathbf{A}$ applied to the current population vector $\\mathbf{n}_{t}$ via $\\mathbf{n}_{t+1}=\\mathbf{A}\\mathbf{n}_{t}$, and that an entry $a_{ij}$ of $\\mathbf{A}$ is the expected number of stage-$i$ individuals at time $t+1$ produced by one stage-$j$ individual at time $t$, construct the $3\\times 3$ Lefkovitch matrix $\\mathbf{A}$ with stage order $(L,J,A)$.\n\n2) From first principles of linear population models and the Perron–Frobenius theorem for nonnegative primitive matrices, compute the dominant eigenvalue $\\lambda$ of $\\mathbf{A}$, which is the asymptotic per-year multiplicative growth rate of the population. Round your final numerical answer for $\\lambda$ to four significant figures. Express $\\lambda$ as a dimensionless per-year multiplier.\n\n3) Determine the stable stage distribution (the right eigenvector associated with $\\lambda$, normalized to sum to $1$) and the reproductive value vector (the left eigenvector associated with $\\lambda$, normalized so that the adult reproductive value equals $1$). Briefly interpret these vectors in ecological terms, linking them to the population-level scope of inference.\n\nOnly the numerical value of $\\lambda$ is required as the final answer. All intermediate steps and interpretations must be shown in your solution.", "solution": "The problem presented is a standard exercise in linear population dynamics, specifically concerning stage-structured models. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We shall proceed with the analysis.\n\nThe problem requires a three-part solution: $1$) construction of the stage projection matrix, $2$) calculation of its dominant eigenvalue, and $3$) determination and interpretation of the associated right and left eigenvectors.\n\nPart 1: Construction of the Lefkovitch Matrix $\\mathbf{A}$\n\nThe population is structured into three stages: seedling ($L$), juvenile ($J$), and adult ($A$). The state of the population at time $t$ is given by the vector $\\mathbf{n}_{t} = \\begin{pmatrix} n_L(t) \\\\ n_J(t) \\\\ n_A(t) \\end{pmatrix}$. The dynamics are governed by the linear recurrence relation $\\mathbf{n}_{t+1} = \\mathbf{A} \\mathbf{n}_{t}$, where $\\mathbf{A}$ is the $3 \\times 3$ Lefkovitch matrix. The entry $a_{ij}$ of $\\mathbf{A}$ represents the per-capita contribution of individuals in stage $j$ at time $t$ to stage $i$ at time $t+1$. The stage order is specified as ($L, J, A$).\n\nWe construct the matrix $\\mathbf{A}$ using the provided vital rates:\n-   $a_{11}$: Contribution from seedling to seedling. This is the seedling stasis probability, given as $0.4$.\n-   $a_{12}$: Contribution from juvenile to seedling. Juveniles do not reproduce, so this entry is $0$.\n-   $a_{13}$: Contribution from adult to seedling. This is the fecundity, given as an average of $4$ new seedlings per adult.\n-   $a_{21}$: Contribution from seedling to juvenile. This is the seedling growth probability, given as $0.3$.\n-   $a_{22}$: Contribution from juvenile to juvenile. This is the juvenile stasis probability, given as $0.6$.\n-   $a_{23}$: Contribution from adult to juvenile. There is no retrogression, so adults cannot become juveniles. This entry is $0$.\n-   $a_{31}$: Contribution from seedling to adult. Seedlings must pass through the juvenile stage, so they cannot become adults in a single time step. This entry is $0$.\n-   $a_{32}$: Contribution from juvenile to adult. This is the juvenile growth probability, given as $0.2$.\n-   $a_{33}$: Contribution from adult to adult. This is the adult stasis (survival) probability, given as $0.8$.\n\nCombining these entries, the Lefkovitch matrix $\\mathbf{A}$ is:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix}\n$$\n\nPart 2: Calculation of the Dominant Eigenvalue $\\lambda$\n\nThe long-term asymptotic growth rate of the population is given by the dominant eigenvalue of $\\mathbf{A}$. The eigenvalues $\\lambda$ are the roots of the characteristic equation, $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix.\n\n$$\n\\det\\left( \\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = 0\n$$\n$$\n\\det\\begin{pmatrix} 0.4-\\lambda  0  4 \\\\ 0.3  0.6-\\lambda  0 \\\\ 0  0.2  0.8-\\lambda \\end{pmatrix} = 0\n$$\nWe compute the determinant using cofactor expansion along the first row:\n$$\n(0.4-\\lambda) \\begin{vmatrix} 0.6-\\lambda  0 \\\\ 0.2  0.8-\\lambda \\end{vmatrix} - 0 \\cdot \\begin{vmatrix} 0.3  0 \\\\ 0  0.8-\\lambda \\end{vmatrix} + 4 \\cdot \\begin{vmatrix} 0.3  0.6-\\lambda \\\\ 0  0.2 \\end{vmatrix} = 0\n$$\n$$\n(0.4-\\lambda)((0.6-\\lambda)(0.8-\\lambda) - 0) + 4((0.3)(0.2) - 0) = 0\n$$\n$$\n(0.4-\\lambda)(0.48 - 1.4\\lambda + \\lambda^2) + 0.24 = 0\n$$\n$$\n0.192 - 0.56\\lambda + 0.4\\lambda^2 - 0.48\\lambda + 1.4\\lambda^2 - \\lambda^3 + 0.24 = 0\n$$\nThis simplifies to the characteristic polynomial:\n$$\n-\\lambda^3 + 1.8\\lambda^2 - 1.04\\lambda + 0.432 = 0\n$$\nOr, multiplying by $-1$:\n$$\n\\lambda^3 - 1.8\\lambda^2 + 1.04\\lambda - 0.432 = 0\n$$\nThe matrix $\\mathbf{A}$ is non-negative and primitive (as $\\mathbf{A}^2$ has all strictly positive entries), so the Perron-Frobenius theorem guarantees the existence of a unique, simple, real, and positive eigenvalue $\\lambda_1$ which is strictly greater in magnitude than all other eigenvalues. This $\\lambda_1$ is the asymptotic population growth rate. The cubic equation must be solved numerically. The real root is found to be:\n$$\n\\lambda \\approx 1.2428\n$$\nThe other two roots are a complex conjugate pair with magnitude less than $\\lambda$. Rounding to four significant figures as requested, the dominant eigenvalue is $1.243$.\n\nPart 3: Stable Stage Distribution and Reproductive Value\n\nThe stable stage distribution is the right eigenvector $\\mathbf{w}$ corresponding to the dominant eigenvalue $\\lambda$. It satisfies $\\mathbf{A}\\mathbf{w} = \\lambda\\mathbf{w}$. The components of $\\mathbf{w}$ represent the stable proportions of individuals in each stage.\n$$\n\\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix} \\begin{pmatrix} w_L \\\\ w_J \\\\ w_A \\end{pmatrix} = \\lambda \\begin{pmatrix} w_L \\\\ w_J \\\\ w_A \\end{pmatrix}\n$$\nThis yields a system of linear equations. We can solve for the ratios of the components. For instance, from the third row, $0.2w_J + 0.8w_A = \\lambda w_A$, which gives $w_J = \\frac{\\lambda - 0.8}{0.2} w_A$. Using $\\lambda \\approx 1.2428$, we find $w_J \\approx 2.214 w_A$. From the second row, $0.3w_L + 0.6w_J = \\lambda w_J$, which gives $w_L = \\frac{\\lambda - 0.6}{0.3} w_J$. This gives $w_L \\approx 2.143 w_J \\approx 4.745 w_A$. The eigenvector is proportional to $\\begin{pmatrix} 4.745 \\\\ 2.214 \\\\ 1 \\end{pmatrix}$. Normalizing so the components sum to $1$:\n$$\n\\mathbf{w} = \\frac{1}{4.745 + 2.214 + 1} \\begin{pmatrix} 4.745 \\\\ 2.214 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.596 \\\\ 0.278 \\\\ 0.126 \\end{pmatrix}\n$$\nEcologically, this vector describes the population's structure at equilibrium: it will consist of approximately $59.6\\%$ seedlings, $27.8\\%$ juveniles, and $12.6\\%$ adults. This is a population-level emergent property.\n\nThe reproductive value vector is the left eigenvector $\\mathbf{v}$ corresponding to $\\lambda$. It satisfies $\\mathbf{v}^T\\mathbf{A} = \\lambda\\mathbf{v}^T$. The components measure the relative contribution of an individual in each stage to future population growth.\n$$\n\\begin{pmatrix} v_L  v_J  v_A \\end{pmatrix} \\begin{pmatrix} 0.4  0  4 \\\\ 0.3  0.6  0 \\\\ 0  0.2  0.8 \\end{pmatrix} = \\lambda \\begin{pmatrix} v_L  v_J  v_A \\end{pmatrix}\n$$\nThis gives another system of equations. Normalizing such that the reproductive value of an adult is $1$ ($v_A = 1$), we use the second equation: $0.6v_J + 0.2v_A = \\lambda v_J$, which gives $v_J = \\frac{0.2}{\\lambda - 0.6} v_A \\approx 0.311$. From the third equation: $4v_L + 0.8v_A = \\lambda v_A$, which gives $v_L = \\frac{\\lambda - 0.8}{4} v_A \\approx 0.111$.\nThe reproductive value vector is:\n$$\n\\mathbf{v} = \\begin{pmatrix} 0.111 \\\\ 0.311 \\\\ 1 \\end{pmatrix}\n$$\nEcologically, a juvenile is worth about $31.1\\%$ of an adult, and a seedling is worth about $11.1\\%$ of an adult, in terms of their respective expected contributions to future generations. This reflects the probability of surviving and reaching the reproductive adult stage. This, too, is a population-level concept, determined by the life history trade-offs across all stages.\n\nThe final required answer is the numerical value of the dominant eigenvalue $\\lambda$.\n$$\n\\lambda \\approx 1.243\n$$", "answer": "$$\\boxed{1.243}$$", "id": "2502393"}, {"introduction": "Ecological data are often collected across heterogeneous landscapes, where underlying environmental factors can obscure the true relationships we seek to understand. This exercise presents a scenario of Simpson's paradox, where an association observed within distinct groups reverses when the groups are combined. You will dissect this statistical illusion by calculating associations at different scopes and learn how to resolve the paradox using a causal framework, highlighting the critical role of accounting for confounding variables at the landscape level [@problem_id:2502384].", "problem": "In a field study at the community level within two distinct landscape strata, a focal bird species is surveyed for presence across two habitat types. The two landscape strata, denoted $S \\in \\{A,B\\}$, differ in abiotic conditions and accessibility, which also influences sampling effort. Within each stratum, the two habitat types are $H \\in \\{\\text{Forest}, \\text{Meadow}\\}$. The response variable is species presence, $Y \\in \\{1,0\\}$, recorded per quadrat. The counts below are totals across independent quadrats within each stratum and habitat:\n\n- Stratum $S=A$: Forest has $19$ presences and $1$ absence; Meadow has $900$ presences and $100$ absences.\n- Stratum $S=B$: Forest has $60$ presences and $940$ absences; Meadow has $1$ presence and $19$ absences.\n\nAssume that $S$ causally influences both habitat allocation $H$ (via accessibility and availability) and species presence $Y$ (via abiotic conditions), and that $H$ may causally influence $Y$. You will evaluate species–habitat association at the population level within and across strata and then reconcile any paradox using a causal Directed Acyclic Graph (DAG).\n\nTasks:\n\n1. Using the definition that the odds ratio comparing $\\text{Forest}$ to $\\text{Meadow}$ is the ratio of the odds of $Y=1$ in $\\text{Forest}$ to the odds of $Y=1$ in $\\text{Meadow}$, compute the stratum-specific odds ratios for $S=A$ and $S=B$.\n2. Aggregate the data across strata and compute the marginal odds ratio comparing $\\text{Forest}$ to $\\text{Meadow}$. Determine whether the direction of association reverses relative to both stratum-specific associations, thereby demonstrating Simpson’s paradox.\n3. Specify a causal Directed Acyclic Graph with nodes $S$, $H$, and $Y$ that is consistent with the verbal assumptions above. From first principles of causal identification, state the minimal sufficient adjustment set for estimating the causal effect of $H$ on $Y$.\n4. Under the assumption that a common causal odds ratio holds across strata after appropriate adjustment dictated by your DAG, compute a single, stratum-adjusted odds ratio comparing $\\text{Forest}$ to $\\text{Meadow}$, using a consistent stratified estimator. Round your final adjusted odds ratio to four significant figures and report it as a pure number with no units.\n\nOnly the value from Task $4$ should be provided as your final answer.", "solution": "The problem requires a systematic analysis of count data from an ecological study to evaluate species-habitat association, demonstrate Simpson's paradox, and resolve it using principles of causal inference. The analysis proceeds in four steps.\n\nFirst, we define our notation. Let $Y \\in \\{1, 0\\}$ denote species presence and absence, respectively. Let $H \\in \\{\\text{Forest}, \\text{Meadow}\\}$ be the habitat type. The study is stratified by landscape stratum $S \\in \\{A, B\\}$. For each stratum $i \\in \\{A, B\\}$, the data can be represented in a $2 \\times 2$ contingency table:\n- $a_i$: Count of presences ($Y=1$) in Forest ($H=\\text{Forest}$).\n- $b_i$: Count of absences ($Y=0$) in Forest ($H=\\text{Forest}$).\n- $c_i$: Count of presences ($Y=1$) in Meadow ($H=\\text{Meadow}$).\n- $d_i$: Count of absences ($Y=0$) in Meadow ($H=\\text{Meadow}$).\n\nThe odds of presence for a given habitat is defined as the ratio of presences to absences. The odds ratio ($OR$) comparing Forest to Meadow is the ratio of their respective odds.\n$$ OR = \\frac{\\text{Odds}(Y=1|H=\\text{Forest})}{\\text{Odds}(Y=1|H=\\text{Meadow})} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n\nTask 1: Compute stratum-specific odds ratios.\nFor Stratum $A$, the data are $a_A = 19$, $b_A = 1$, $c_A = 900$, and $d_A = 100$.\nThe odds ratio for Stratum $A$ is:\n$$ OR_A = \\frac{a_A d_A}{b_A c_A} = \\frac{19 \\times 100}{1 \\times 900} = \\frac{1900}{900} = \\frac{19}{9} $$\nSince $OR_A \\approx 2.11  1$, there is a positive association between Forest habitat and species presence in Stratum $A$.\n\nFor Stratum $B$, the data are $a_B = 60$, $b_B = 940$, $c_B = 1$, and $d_B = 19$.\nThe odds ratio for Stratum $B$ is:\n$$ OR_B = \\frac{a_B d_B}{b_B c_B} = \\frac{60 \\times 19}{940 \\times 1} = \\frac{1140}{940} = \\frac{114}{94} = \\frac{57}{47} $$\nSince $OR_B \\approx 1.21  1$, there is also a positive association in Stratum $B$.\n\nTask 2: Compute the marginal odds ratio and demonstrate Simpson's paradox.\nTo compute the marginal odds ratio, we aggregate the data across both strata.\nTotal count in Forest: $a = a_A + a_B = 19 + 60 = 79$ presences; $b = b_A + b_B = 1 + 940 = 941$ absences.\nTotal count in Meadow: $c = c_A + c_B = 900 + 1 = 901$ presences; $d = d_A + d_B = 100 + 19 = 119$ absences.\nThe marginal odds ratio, $OR_M$, is computed from this aggregated table:\n$$ OR_M = \\frac{a d}{b c} = \\frac{79 \\times 119}{941 \\times 901} = \\frac{9401}{847841} $$\nNumerically, $OR_M \\approx 0.011$. This value is less than $1$, indicating a negative association between Forest habitat and species presence when data are aggregated. The association has reversed direction compared to the stratum-specific associations ($OR_A  1$ and $OR_B  1$). This reversal is the definition of Simpson's paradox.\n\nTask 3: Specify the causal Directed Acyclic Graph (DAG) and adjustment set.\nThe problem statement provides the causal relationships:\n1. $S$ causally influences $H$ ($S \\to H$).\n2. $S$ causally influences $Y$ ($S \\to Y$).\n3. $H$ may causally influence $Y$ ($H \\to Y$).\nThese relationships define a DAG where $S$ is a common cause of $H$ and $Y$:\n$$ H \\leftarrow S \\to Y $$\nThe path $H \\leftarrow S \\to Y$ is a non-causal \"backdoor\" path from $H$ to $Y$ that induces a spurious correlation. To estimate the causal effect of $H$ on $Y$ (the path $H \\to Y$), this backdoor path must be blocked by conditioning on the confounding variable, $S$. Thus, the minimal sufficient adjustment set is $\\{S\\}$. This justifies the use of a stratified analysis.\n\nTask 4: Compute the stratum-adjusted odds ratio.\nTo obtain a single estimate of the odds ratio for the effect of $H$ on $Y$ that is adjusted for the confounding by $S$, we use the Mantel-Haenszel estimator. This estimator computes a weighted average of the stratum-specific odds ratios. The formula is:\n$$ OR_{MH} = \\frac{\\sum_{i=A,B} \\frac{a_i d_i}{n_i}}{\\sum_{i=A,B} \\frac{b_i c_i}{n_i}} $$\nwhere $n_i = a_i + b_i + c_i + d_i$ is the total sample size in stratum $i$.\n\nFirst, we find the total sample sizes for each stratum:\n$n_A = 19 + 1 + 900 + 100 = 1020$.\n$n_B = 60 + 940 + 1 + 19 = 1020$.\n\nNow, we calculate the numerator and denominator of the $OR_{MH}$ formula:\nNumerator:\n$$ \\sum_{i} \\frac{a_i d_i}{n_i} = \\frac{19 \\times 100}{1020} + \\frac{60 \\times 19}{1020} = \\frac{1900}{1020} + \\frac{1140}{1020} = \\frac{3040}{1020} $$\nDenominator:\n$$ \\sum_{i} \\frac{b_i c_i}{n_i} = \\frac{1 \\times 900}{1020} + \\frac{940 \\times 1}{1020} = \\frac{900}{1020} + \\frac{940}{1020} = \\frac{1840}{1020} $$\nThe Mantel-Haenszel odds ratio is the ratio of these two quantities:\n$$ OR_{MH} = \\frac{3040/1020}{1840/1020} = \\frac{3040}{1840} = \\frac{304}{184} = \\frac{38}{23} $$\nThe exact value of the adjusted odds ratio is $\\frac{38}{23}$. Converting this to a decimal gives approximately $1.6521739$. Rounding to four significant figures, as requested, yields $1.652$. This adjusted odds ratio is greater than $1$, which is consistent with the stratum-specific analyses and represents the estimate of the causal effect of Forest habitat on species presence odds, having controlled for the confounding effect of Stratum $S$.", "answer": "$$\\boxed{1.652}$$", "id": "2502384"}, {"introduction": "Modeling how organisms move through a landscape is fundamental to predicting population persistence, gene flow, and species distributions. The choice of model, however, depends critically on the ecological level of organization being considered. This computational practice directly contrasts two influential approaches: the Least-Cost Path, which represents the optimal route for a single individual, and Electrical Circuit Theory, which captures the collective, multi-path flow of a population. By implementing both, you will gain a practical understanding of how shifting the organizational scope from the individual to the population yields different, and complementary, insights into landscape connectivity [@problem_id:2502429].", "problem": "You are given a discrete landscape represented as a two-dimensional raster of nonnegative movement costs, along with two habitat patches represented as disjoint sets of raster cells. Your task is to implement, from first principles, two connectivity predictions corresponding to different levels of ecological organization and scope, and then compute paired outputs across a small test suite of landscapes.\n\nEcological interpretation and levels of organization:\n- At the individual-level, an organism that minimizes its cumulative movement cost follows a path that approximately minimizes the sum of local movement costs weighted by step lengths. This is operationalized as the Least-Cost Path (LCP), a path on a weighted grid graph with edge weights given by the cost of traversing between adjacent cells. Under an exponential dispersal kernel, the predicted per-capita movement probability from a source patch to a destination patch can be modeled as $P_{\\mathrm{LCP}} = \\exp(-\\alpha \\, C_{\\min})$, where $C_{\\min}$ is the cumulative cost of the least-cost path and $\\alpha gt; 0$ is a scale parameter.\n- At the population-level (metapopulation connectivity), a large ensemble of individuals disperses via many possible routes through the landscape. Electrical Circuit Theory (ECT) provides a principled representation of this multi-path flow based on the equivalence between random walks and resistor networks. Construct a resistor network by assigning each graph edge a conductance equal to the inverse of its traversal cost. Fix the electric potential of all cells in the source patch to $1$ and all cells in the destination patch to $0$, and solve the resulting Dirichlet boundary value problem implied by Ohm’s Law (OL) and Kirchhoff’s Current Law (KCL). The total current leaving the source patch equals the equivalent conductance $C_{\\mathrm{eq}}$ between the two patches. A bounded movement probability consistent with higher-level flow can then be modeled as $P_{\\mathrm{ECT}} = 1 - \\exp(-\\beta \\, C_{\\mathrm{eq}})$ with $\\beta gt; 0$.\n\nFoundational base for your implementation:\n- Represent the raster as a weighted undirected graph where each valid cell is a node and edges connect $8$-neighbors (horizontal, vertical, and diagonal). The length of horizontal and vertical steps is $1$, and the length of diagonal steps is $\\sqrt{2}$.\n- The traversal cost for moving from cell $i$ with cost $c_i$ to an adjacent cell $j$ with cost $c_j$ over a step of length $\\ell_{ij}$ is the arithmetic mean cost multiplied by step length, i.e., $(c_i + c_j)/2 \\cdot \\ell_{ij}$. If either $c_i$ or $c_j$ is not finite, the edge is omitted.\n- Least-Cost Path (LCP): Compute the minimal cumulative cost $C_{\\min}$ from any source-cell to any destination-cell using Dijkstra’s algorithm on the above graph, treating all source cells as multi-sources with initial distance $0$. If no path exists, define $C_{\\min} = +\\infty$ and $P_{\\mathrm{LCP}} = 0$ by convention.\n- Electrical Circuit Theory (ECT): Assign each edge a conductance $g_{ij} = 1 / \\left( (c_i + c_j)/2 \\cdot \\ell_{ij} \\right)$. Impose Dirichlet potentials $V=1$ on the source-patch cells and $V=0$ on the destination-patch cells; all other valid cells are unknowns. Let $L$ denote the graph Laplacian assembled from the conductances. Solve the linear system for interior-node potentials implied by KCL at each interior node $u$: $\\sum_{v} g_{uv} (V_u - V_v) = 0$, where the sum is over neighbors $v$ of $u$, and $V_v$ is known for boundary nodes. The equivalent conductance $C_{\\mathrm{eq}}$ equals the total current leaving the source boundary, $C_{\\mathrm{eq}} = \\sum_{s \\in S} \\sum_{v \\sim s} g_{sv} (V_s - V_v)$ with $V_s=1$. If there is no path connecting source and destination components, then $C_{\\mathrm{eq}} = 0$ and $P_{\\mathrm{ECT}} = 0$ by convention.\n\nGraph construction and numerical details:\n- Use $8$-neighbor connectivity with step lengths $1$ (orthogonal) and $\\sqrt{2}$ (diagonal).\n- A cell is valid if and only if its cost is finite. Edges incident on any invalid cell are omitted.\n- For LCP, run multi-source Dijkstra and terminate once any destination cell is popped from the priority queue to obtain $C_{\\min}$.\n- For ECT, assemble the sparse Laplacian for valid cells, apply Dirichlet constraints on the two patches, and solve the reduced linear system for interior potentials. Then compute $C_{\\mathrm{eq}}$ as the total current leaving the source patch.\n\nPredicted movement probabilities to compute:\n- $P_{\\mathrm{LCP}} = \\exp(-\\alpha \\, C_{\\min})$ if $C_{\\min}$ is finite, and $0$ otherwise.\n- $P_{\\mathrm{ECT}} = 1 - \\exp(-\\beta \\, C_{\\mathrm{eq}})$.\n\nAngles are not required in this problem. No physical units are required; all costs are in abstract cost units, and distances in cell-length units.\n\nTest Suite:\nImplement your program to compute $[P_{\\mathrm{LCP}}, P_{\\mathrm{ECT}}]$ for each of the following test cases. All coordinates are zero-based $(\\text{row}, \\text{col})$.\n\n- Case A (general landscape, single-cell patches, connected):\n  - Raster of size $5 \\times 5$ with costs\n    $\n    \\begin{bmatrix}\n    1  1  2  2  3 \\\\\n    1  2  2  3  3 \\\\\n    2  2  3  4  4 \\\\\n    2  3  4  5  5 \\\\\n    3  4  5  5  6\n    \\end{bmatrix}\n    $\n  - Source patch $S = \\{(0,0)\\}$, destination patch $T = \\{(4,4)\\}$.\n  - Parameters: $\\alpha = 0.2$, $\\beta = 1$.\n- Case B (boundary condition with adjacent patches on uniform landscape):\n  - Raster of size $3 \\times 3$ with all entries equal to $1$.\n  - Source patch $S = \\{(1,1)\\}$, destination patch $T = \\{(1,2)\\}$.\n  - Parameters: $\\alpha = 1$, $\\beta = 1$.\n- Case C (complete disconnection by an impassable barrier):\n  - Raster of size $5 \\times 5$ with all entries equal to $1$ except the entire middle row has $+\\infty$ (impassable), i.e., for all columns $j$, cell $(2,j)$ has cost $+\\infty$.\n  - Source patch $S = \\{(0,0), (0,4)\\}$, destination patch $T = \\{(4,0), (4,4)\\}$.\n  - Parameters: $\\alpha = 1$, $\\beta = 1$.\n- Case D (two parallel corridors; multi-cell patches):\n  - Raster of size $6 \\times 6$ initialized to $10$, then set the costs of rows $1$ and $4$ to $1$ for all columns, leaving other cells at $10$.\n  - Source patch $S = \\{(1,0), (4,0)\\}$, destination patch $T = \\{(1,5), (4,5)\\}$.\n  - Parameters: $\\alpha = 0.5$, $\\beta = 1$.\n\nRequired program behavior:\n- Hard-code the above test suite into your program.\n- For each case, compute $P_{\\mathrm{LCP}}$ and $P_{\\mathrm{ECT}}$ exactly as specified above.\n- Round each probability to $6$ decimal places using standard rounding.\n- Final Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result should itself be a two-element list. For example, the output must be of the form\n  $\n  \\left[ [p\\_1, q\\_1], [p\\_2, q\\_2], [p\\_3, q\\_3], [p\\_4, q\\_4] \\right]\n  $\n  where $p_k$ and $q_k$ are the rounded values of $P_{\\mathrm{LCP}}$ and $P_{\\mathrm{ECT}}$ for case $k$ in the order A, B, C, D.", "solution": "The problem statement has been rigorously analyzed and is deemed valid. It is scientifically grounded in established principles of landscape ecology, well-posed with all necessary information for a unique solution, and objectively formulated. The problem requires the implementation of two distinct ecological connectivity models—Least-Cost Path (LCP) and Electrical Circuit Theory (ECT)—to be applied to a series of test landscapes. The solution proceeds by first constructing a graph representation of the landscape, then applying the specified algorithms for each model.\n\nFirst, the landscape raster is transformed into a weighted undirected graph $G = (V, E)$, where the set of nodes $V$ corresponds to the raster cells with finite movement cost, and edges $E$ connect adjacent nodes. Connectivity is defined by an $8$-neighbor (Moore) neighborhood. For any two adjacent cells $i$ and $j$ with respective costs $c_i$ and $c_j$, an edge $(i, j)$ exists in $E$. The traversal cost $w_{ij}$ assigned to this edge is given by the formula $w_{ij} = \\frac{c_i + c_j}{2} \\ell_{ij}$, where $\\ell_{ij}$ is the Euclidean distance between cell centers. $\\ell_{ij}=1$ for horizontal and vertical neighbors, and $\\ell_{ij}=\\sqrt{2}$ for diagonal neighbors. If either $c_i$ or $c_j$ is infinite, no edge is created between the cells, effectively representing an impassable barrier.\n\nThe first model, representing individual-level movement, is the Least-Cost Path (LCP). The cumulative cost of the minimal-cost path, $C_{\\min}$, between the source patch $S$ and the destination patch $T$ is computed. This is a classic shortest path problem on a graph with non-negative edge weights, for which Dijkstra's algorithm is employed. To account for multi-cell patches, a multi-source variant of Dijkstra's algorithm is used. The distances to all nodes in the source patch $S$ are initialized to $0$, and all other distances are initialized to $\\infty$. The algorithm proceeds by iteratively exploring the graph, always extending the path from the node with the lowest current cumulative cost. The search terminates as soon as the first node belonging to the destination patch $T$ is finalized (i.e., extracted from the priority queue), yielding $C_{\\min}$. If the priority queue is exhausted before any destination node is reached, it signifies that $S$ and $T$ are disconnected, and $C_{\\min}$ is taken to be $\\infty$. The movement probability is then calculated as $P_{\\mathrm{LCP}} = \\exp(-\\alpha \\, C_{\\min})$, with the convention that $P_{\\mathrm{LCP}}=0$ if $C_{\\min} = \\infty$.\n\nThe second model, representing population-level connectivity, is based on Electrical Circuit Theory (ECT). This model considers all possible paths between the source and destination patches simultaneously. The landscape graph $G$ is interpreted as a resistor network. The conductance $g_{ij}$ of an edge $(i, j)$ is the reciprocal of its traversal cost: $g_{ij} = 1/w_{ij}$. A Dirichlet boundary value problem is established by setting the electric potential of all nodes in the source patch $S$ to $V_S=1$ and all nodes in the destination patch $T$ to $V_T=0$. The potentials of all other (interior) nodes are unknown.\n\nAccording to Kirchhoff's Current Law (KCL), the net current flow at any interior node $u$ must be zero. This condition leads to a system of linear equations:\n$$\n\\sum_{v \\sim u} g_{uv} (V_u - V_v) = 0\n$$\nwhere the sum is over all neighbors $v$ of $u$. This system can be rearranged for all interior nodes $u \\in I$ to form a matrix equation $A\\mathbf{x} = \\mathbf{b}$. Here, $\\mathbf{x}$ is the vector of unknown potentials for the interior nodes. The matrix $A$ is a submatrix of the graph Laplacian, corresponding to the interior nodes. For an interior node $u_i$, the diagonal entry $A_{ii}$ is the sum of conductances of all incident edges, $A_{ii} = \\sum_{v \\sim u_i} g_{u_i v}$. The off-diagonal entry $A_{ij}$ for an adjacent interior node $u_j$ is $-g_{u_i u_j}$. The vector $\\mathbf{b}$ accounts for the fixed potentials of the boundary nodes (source patch), where $b_i = \\sum_{s \\in S, s \\sim u_i} g_{u_i s} V_s = \\sum_{s \\in S, s \\sim u_i} g_{u_i s}$.\n\nThis sparse linear system is solved for the vector of interior potentials $\\mathbf{x}$. Before solving, a connectivity check (e.g., Breadth-First Search) is performed from the source patch. If the destination patch is unreachable, the patches are electrically disconnected, and the equivalent conductance $C_{\\mathrm{eq}}$ is $0$. Otherwise, after solving for the potentials of all nodes, the equivalent conductance $C_{\\mathrm{eq}}$ of the network is computed as the total current flowing out of the source patch:\n$$\nC_{\\mathrm{eq}} = \\sum_{s \\in S} \\sum_{v \\sim s} g_{sv} (V_s - V_v)\n$$\nFinally, the population-level movement probability is calculated as $P_{\\mathrm{ECT}} = 1 - \\exp(-\\beta \\, C_{\\mathrm{eq}})$. For all cases, numerical results are rounded to $6$ decimal places as required.", "answer": "[[0.147171,0.511391],[0.367879,0.527633],[0.0,0.0],[0.082085,0.72901]]", "id": "2502429"}]}