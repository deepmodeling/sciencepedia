{"hands_on_practices": [{"introduction": "The cornerstone of organismal energetics is quantifying the rate at which animals use energy. This exercise guides you through the foundational technique of indirect calorimetry, the primary method for measuring metabolic rate in living animals. By working from first principles [@problem_id:2516305], you will convert raw gas exchange data—oxygen consumption and the respiratory quotient ($RQ$)—into the universal currency of power, the watt, providing a crucial link between biochemistry and whole-organism physiology.", "problem": "A small endothermic mammal at rest has a measured oxygen consumption rate of $0.5\\ \\mathrm{mL\\ O_2\\ g^{-1}\\ h^{-1}}$ and a respiratory quotient (RQ) of $0.8$. Its body mass is $0.3\\ \\mathrm{kg}$. Using indirect calorimetry from first principles, compute its basal metabolic rate (BMR) in watts by treating the metabolized substrates as a mixture of carbohydrate and fat with negligible protein contribution. Use the following foundational information and assumptions:\n\n- The respiratory quotient is defined as $\\text{RQ} = \\dot{V}_{\\mathrm{CO_2}}/\\dot{V}_{\\mathrm{O_2}}$.\n- For complete oxidation of representative substrates at standard conditions:\n  - Glucose: $\\mathrm{C_6H_{12}O_6} + 6\\,\\mathrm{O_2} \\to 6\\,\\mathrm{CO_2} + 6\\,\\mathrm{H_2O}$ with standard enthalpy of combustion $\\Delta H_{\\mathrm{c,glc}} = -2803\\ \\mathrm{kJ\\ mol^{-1}}$.\n  - Palmitic acid: $\\mathrm{C_{16}H_{32}O_2} + 23\\,\\mathrm{O_2} \\to 16\\,\\mathrm{CO_2} + 16\\,\\mathrm{H_2O}$ with standard enthalpy of combustion $\\Delta H_{\\mathrm{c,pal}} = -9980\\ \\mathrm{kJ\\ mol^{-1}}$.\n- Assume the observed $RQ$ arises from an instantaneous mixture of glucose and palmitic acid oxidation that is internally consistent with the given stoichiometries (neglect protein and nitrogen balance).\n- Use the molar volume of an ideal gas at standard temperature and pressure, dry (STPD), $V_m = 22.414\\ \\mathrm{L\\ mol^{-1}}$.\n- Take $1\\ \\mathrm{W} = 1\\ \\mathrm{J\\ s^{-1}}$.\n\nThen, compare the measured BMR to the prediction from an allometric model $B_{\\mathrm{pred}} = 0.07\\, m^{0.72}$, where $B_{\\mathrm{pred}}$ is in $\\mathrm{W}$ and $m$ is body mass in grams. Let $B_{\\mathrm{meas}}$ denote the BMR you compute from the gas exchange data. Report the ratio $r = B_{\\mathrm{meas}}/B_{\\mathrm{pred}}$ as a unitless decimal. Round your final reported ratio to three significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and self-contained. It requires the application of first principles of indirect calorimetry to determine the basal metabolic rate ($B_{\\mathrm{meas}}$) from gas exchange data and compare it to a prediction from an allometric model ($B_{\\mathrm{pred}}$). The data provided are sufficient and consistent. Therefore, I will proceed with a full solution.\n\nThe core principle of indirect calorimetry is that the heat produced by an organism is directly proportional to the amount of oxygen consumed. The exact proportionality constant, known as the oxycaloric equivalent, depends on the chemical nature of the substrate being oxidized. The respiratory quotient ($RQ$), defined as the ratio of the volume of carbon dioxide produced ($\\dot{V}_{\\mathrm{CO_2}}$) to the volume of oxygen consumed ($\\dot{V}_{\\mathrm{O_2}}$), allows us to determine the mix of substrates being metabolized.\n\nFirst, we determine the $RQ$ for the complete oxidation of the two representative substrates provided: glucose ($\\mathrm{C_6H_{12}O_6}$) and palmitic acid ($\\mathrm{C_{16}H_{32}O_2}$). According to the law of Avogadro, the ratio of volumes of gases at the same temperature and pressure is equal to the ratio of their molar amounts.\nFor glucose:\n$$ \\mathrm{C_6H_{12}O_6} + 6\\,\\mathrm{O_2} \\to 6\\,\\mathrm{CO_2} + 6\\,\\mathrm{H_2O} $$\n$$ RQ_{\\mathrm{glc}} = \\frac{6 \\text{ mol } \\mathrm{CO_2}}{6 \\text{ mol } \\mathrm{O_2}} = 1.0 $$\nFor palmitic acid:\n$$ \\mathrm{C_{16}H_{32}O_2} + 23\\,\\mathrm{O_2} \\to 16\\,\\mathrm{CO_2} + 16\\,\\mathrm{H_2O} $$\n$$ RQ_{\\mathrm{pal}} = \\frac{16 \\text{ mol } \\mathrm{CO_2}}{23 \\text{ mol } \\mathrm{O_2}} \\approx 0.6957 $$\nThe measured $RQ$ of the mammal is $0.8$. We assume this results from a mixture of glucose and fat oxidation, neglecting protein. Let $f$ be the fraction of oxygen consumption dedicated to carbohydrate oxidation, and $(1-f)$ be the fraction for fat oxidation. The total $RQ$ is the weighted average:\n$$ RQ = f \\cdot RQ_{\\mathrm{glc}} + (1-f) \\cdot RQ_{\\mathrm{pal}} $$\nSubstituting the known values:\n$$ 0.8 = f \\cdot (1.0) + (1-f) \\cdot \\left(\\frac{16}{23}\\right) $$\n$$ 0.8 = f + \\frac{16}{23} - \\frac{16}{23}f $$\n$$ 0.8 - \\frac{16}{23} = f \\left(1 - \\frac{16}{23}\\right) $$\n$$ \\frac{4}{5} - \\frac{16}{23} = f \\left(\\frac{7}{23}\\right) $$\n$$ \\frac{92 - 80}{115} = f \\left(\\frac{7}{23}\\right) $$\n$$ \\frac{12}{115} = f \\left(\\frac{7}{23}\\right) $$\nSolving for $f$:\n$$ f = \\frac{12}{115} \\cdot \\frac{23}{7} = \\frac{12}{5 \\cdot 23} \\cdot \\frac{23}{7} = \\frac{12}{35} $$\nThus, $\\frac{12}{35}$ of the consumed oxygen is used for glucose oxidation and $(1-f) = \\frac{23}{35}$ is used for palmitic acid oxidation.\n\nNext, we calculate the energy released per mole of oxygen for each substrate. The metabolic process is exothermic, so the enthalpy of reaction is negative. The energy released is the absolute value of this enthalpy.\nFor glucose, $|\\Delta H_{\\mathrm{c,glc}}| = 2803\\ \\mathrm{kJ}$ for $6$ moles of $\\mathrm{O_2}$ consumed.\n$$ E_{\\mathrm{glc}} = \\frac{2803 \\ \\mathrm{kJ}}{6 \\ \\mathrm{mol \\ O_2}} $$\nFor palmitic acid, $|\\Delta H_{\\mathrm{c,pal}}| = 9980\\ \\mathrm{kJ}$ for $23$ moles of $\\mathrm{O_2}$ consumed.\n$$ E_{\\mathrm{pal}} = \\frac{9980 \\ \\mathrm{kJ}}{23 \\ \\mathrm{mol \\ O_2}} $$\nThe average energy released per mole of oxygen for the observed $RQ$ is the weighted average:\n$$ E_{\\mathrm{avg/mol}} = f \\cdot E_{\\mathrm{glc}} + (1-f) \\cdot E_{\\mathrm{pal}} $$\n$$ E_{\\mathrm{avg/mol}} = \\left(\\frac{12}{35}\\right) \\left(\\frac{2803}{6}\\right) + \\left(\\frac{23}{35}\\right) \\left(\\frac{9980}{23}\\right) = \\frac{2 \\cdot 2803}{35} + \\frac{9980}{35} = \\frac{5606 + 9980}{35} = \\frac{15586}{35} \\ \\mathrm{kJ\\ mol^{-1}} $$\nTo find the oxycaloric equivalent in terms of energy per volume, we use the molar volume of an ideal gas at STPD, $V_m = 22.414\\ \\mathrm{L\\ mol^{-1}}$.\n$$ K_{\\mathrm{O_2}} = \\frac{E_{\\mathrm{avg/mol}}}{V_m} = \\frac{15586/35 \\ \\mathrm{kJ\\ mol^{-1}}}{22.414\\ \\mathrm{L\\ mol^{-1}}} = \\frac{15586}{35 \\cdot 22.414} \\ \\mathrm{kJ\\ L^{-1}} $$\nNow, we calculate the mammal's total rate of oxygen consumption, $\\dot{V}_{\\mathrm{O_2}}$. The mass of the mammal is $m = 0.3\\ \\mathrm{kg} = 300\\ \\mathrm{g}$. The specific rate is $0.5\\ \\mathrm{mL\\ O_2\\ g^{-1}\\ h^{-1}}$.\n$$ \\dot{V}_{\\mathrm{O_2}} = (0.5\\ \\mathrm{mL\\ O_2\\ g^{-1}\\ h^{-1}}) \\cdot (300\\ \\mathrm{g}) = 150\\ \\mathrm{mL\\ h^{-1}} $$\nTo calculate the metabolic rate in watts ($1\\ \\mathrm{W} = 1\\ \\mathrm{J\\ s^{-1}}$), we must convert units consistently.\n$$ \\dot{V}_{\\mathrm{O_2}} = 150 \\ \\frac{\\mathrm{mL}}{\\mathrm{h}} \\cdot \\frac{1\\ \\mathrm{L}}{1000\\ \\mathrm{mL}} \\cdot \\frac{1\\ \\mathrm{h}}{3600\\ \\mathrm{s}} = \\frac{150}{3600000} \\ \\mathrm{L\\ s^{-1}} = \\frac{1}{24000} \\ \\mathrm{L\\ s^{-1}} $$\nThe measured basal metabolic rate, $B_{\\mathrm{meas}}$, is the product of the oxygen consumption rate and the oxycaloric equivalent. We also convert from $\\mathrm{kJ}$ to $\\mathrm{J}$.\n$$ B_{\\mathrm{meas}} = \\dot{V}_{\\mathrm{O_2}} \\cdot K_{\\mathrm{O_2}} = \\left(\\frac{1}{24000} \\ \\mathrm{L\\ s^{-1}}\\right) \\cdot \\left(\\frac{15586}{35 \\cdot 22.414} \\ \\mathrm{kJ\\ L^{-1}}\\right) \\cdot \\left(\\frac{1000\\ \\mathrm{J}}{1\\ \\mathrm{kJ}}\\right) $$\n$$ B_{\\mathrm{meas}} = \\frac{15586 \\cdot 1000}{24000 \\cdot 35 \\cdot 22.414} \\ \\mathrm{W} = \\frac{15586}{24 \\cdot 35 \\cdot 22.414} \\ \\mathrm{W} = \\frac{15586}{840 \\cdot 22.414} \\ \\mathrm{W} \\approx 0.82781 \\ \\mathrm{W} $$\nNext, we compute the predicted BMR, $B_{\\mathrm{pred}}$, using the given allometric model $B_{\\mathrm{pred}} = 0.07\\, m^{0.72}$, where mass $m$ must be in grams.\n$$ m = 300\\ \\mathrm{g} $$\n$$ B_{\\mathrm{pred}} = 0.07 \\cdot (300)^{0.72} \\ \\mathrm{W} $$\n$$ B_{\\mathrm{pred}} = 0.07 \\cdot \\exp(0.72 \\cdot \\ln(300)) \\ \\mathrm{W} \\approx 0.07 \\cdot \\exp(0.72 \\cdot 5.70378) \\ \\mathrm{W} \\approx 0.07 \\cdot \\exp(4.10672) \\ \\mathrm{W} $$\n$$ B_{\\mathrm{pred}} \\approx 0.07 \\cdot 60.74516 \\ \\mathrm{W} \\approx 4.25216 \\ \\mathrm{W} $$\nFinally, we compute the ratio $r = B_{\\mathrm{meas}}/B_{\\mathrm{pred}}$ and round to three significant figures.\n$$ r = \\frac{B_{\\mathrm{meas}}}{B_{\\mathrm{pred}}} = \\frac{0.82781\\ \\mathrm{W}}{4.25216\\ \\mathrm{W}} \\approx 0.194679 $$\nRounding to three significant figures gives:\n$$ r \\approx 0.195 $$", "answer": "$$ \\boxed{0.195} $$", "id": "2516305"}, {"introduction": "Once we can measure an animal's metabolic rate, we can begin to model how it must adjust its energy expenditure to cope with environmental challenges. This practice applies the first law of thermodynamics to a fundamental problem for any endotherm: staying warm in the cold. You will use a simple but powerful biophysical model [@problem_id:2516303] to calculate the precise energetic cost of maintaining a constant body temperature below the thermoneutral zone, developing a core intuition for the energetic trade-offs that shape animal ecology and evolution.", "problem": "A small endothermic mammal remains at rest for an entire day in calm, dry air. Its body temperature is regulated at a constant core value of $T_{b} = 37\\ \\mathrm{^{\\circ}C}$, while the ambient air temperature is $T_{a} = 5\\ \\mathrm{^{\\circ}C}$. The animal’s minimal dry thermal conductance (aggregating radiative and convective heat transfer under maximal insulation) is $C_{\\min} = 0.2\\ \\mathrm{W\\,K^{-1}}$. Its basal metabolic rate (the minimal metabolic heat production in the thermoneutral state) is $BMR = 1.5\\ \\mathrm{W}$.\n\nUsing only conservation of energy for the body as a control volume at steady state and the phenomenological fact that, under dry conditions, sensible heat loss is proportional to the core-to-environment temperature difference via a thermal conductance, determine the total metabolic energy expended over $24\\ \\mathrm{h}$ to maintain $T_{b}$ constant under these conditions. Assume negligible evaporative heat loss and negligible external mechanical work, and assume that the animal can adjust its metabolism as needed but cannot operate below $BMR$. Express your final answer in $\\mathrm{kJ}$ and round to four significant figures.", "solution": "The problem requires the determination of total metabolic energy expenditure for an endothermic mammal over a $24$-hour period under specific environmental conditions. The fundamental principle governing this system is the first law of thermodynamics, or conservation of energy, applied to the animal as a control volume at steady state.\n\nThe problem states that the animal’s core body temperature, $T_{b}$, is constant. This signifies a steady-state condition where the rate of change of stored energy in the body is zero. The energy balance for the animal can be expressed as:\n$$\\frac{dE_{storage}}{dt} = H_{M} - H_{loss} - P_{work}$$\nwhere $H_{M}$ is the rate of metabolic heat production, $H_{loss}$ is the rate of heat loss to the environment, and $P_{work}$ is the rate of external mechanical work done by the animal.\nGiven steady state, $\\frac{dE_{storage}}{dt} = 0$. The problem also specifies that external mechanical work is negligible, so $P_{work} = 0$. This simplifies the energy balance equation to:\n$$H_{M} = H_{loss}$$\nThis means that to maintain a constant body temperature, the rate of metabolic heat generation must be exactly equal to the rate of heat loss.\n\nThe problem states that sensible heat loss is proportional to the core-to-environment temperature difference. This physically corresponds to a combined form of Newton's law of cooling and the Stefan-Boltzmann law (for radiation, linearized for small temperature differences), and is expressed as:\n$$H_{loss} = C \\cdot (T_{b} - T_{a})$$\nHere, $C$ is the thermal conductance, $T_{b} = 37\\ \\mathrm{^{\\circ}C}$ is the core body temperature, and $T_{a} = 5\\ \\mathrm{^{\\circ}C}$ is the ambient air temperature. In a cold environment (i.e., when $T_{a}$ is below the animal's lower critical temperature), the animal will minimize its heat loss by maximizing its insulation. This corresponds to using the minimal dry thermal conductance, $C_{\\min} = 0.2\\ \\mathrm{W\\,K^{-1}}$.\n\nThe temperature difference is $\\Delta T = T_{b} - T_{a} = 37\\ \\mathrm{^{\\circ}C} - 5\\ \\mathrm{^{\\circ}C} = 32\\ \\mathrm{^{\\circ}C}$. A temperature difference in degrees Celsius is numerically equal to a temperature difference in Kelvin, so $\\Delta T = 32\\ \\mathrm{K}$.\n\nWe can now calculate the rate of heat loss from the animal to the environment:\n$$H_{loss} = C_{\\min} \\cdot (T_{b} - T_{a}) = (0.2\\ \\mathrm{W\\,K^{-1}}) \\cdot (32\\ \\mathrm{K}) = 6.4\\ \\mathrm{W}$$\n\nFrom the steady-state energy balance, the required metabolic rate $H_{M}$ must be equal to this heat loss rate:\n$$H_{M} = 6.4\\ \\mathrm{W}$$\n\nWe must check this against the animal's basal metabolic rate, $BMR = 1.5\\ \\mathrm{W}$. The BMR represents the minimum metabolic rate of a resting animal in its thermoneutral zone. The problem states the animal cannot operate below this rate. Since our calculated required metabolic rate $H_{M} = 6.4\\ \\mathrm{W}$ is greater than $BMR$, this is a physiologically valid state. The animal must elevate its metabolism to $6.4\\ \\mathrm{W}$ to compensate for the heat loss and maintain its body temperature.\n\nThe total metabolic energy, $E_{total}$, expended over a time interval $\\Delta t$ is the product of the metabolic power ($H_{M}$) and the time duration.\n$$E_{total} = H_{M} \\times \\Delta t$$\nThe time interval is $\\Delta t = 24\\ \\mathrm{h}$. To maintain consistency of units, we convert hours to seconds, noting that $1\\ \\mathrm{W} = 1\\ \\mathrm{J\\,s^{-1}}$.\n$$\\Delta t = 24\\ \\mathrm{h} \\times 60\\ \\mathrm{min\\,h^{-1}} \\times 60\\ \\mathrm{s\\,min^{-1}} = 86400\\ \\mathrm{s}$$\n\nNow, we compute the total energy in Joules:\n$$E_{total} = (6.4\\ \\mathrm{J\\,s^{-1}}) \\times (86400\\ \\mathrm{s}) = 552960\\ \\mathrm{J}$$\n\nThe problem requires the final answer in kilojoules ($\\mathrm{kJ}$), rounded to four significant figures.\n$$E_{total} = \\frac{552960\\ \\mathrm{J}}{1000\\ \\mathrm{J\\,kJ^{-1}}} = 552.96\\ \\mathrm{kJ}$$\n\nRounding to four significant figures, we obtain:\n$$E_{total} \\approx 553.0\\ \\mathrm{kJ}$$", "answer": "$$\\boxed{553.0}$$", "id": "2516303"}, {"introduction": "The principles of heat balance can be scaled up from a single animal in one environment to predict large-scale ecological patterns. This capstone practice challenges you to synthesize the concepts of metabolic cost and physiological limits into a mechanistic species distribution model. By implementing this model [@problem_id:2516337], you will predict an organism's viable geographic range based on its physiology and explore how that range might shift under a future climate scenario, demonstrating the profound link between organismal energetics and global biogeography.", "problem": "You are asked to implement a complete, runnable program that computes energetic feasibility and predicts range limits for a hypothetical endothermic organism using provided climate grids under a current and a future climate. The derivation must be based on first principles of heat balance and fundamental, well-tested allometric scaling. The organism is assumed to maintain a constant deep-body temperature. The task is to predict which grid cells are energetically feasible under both the coldest and hottest representative months, for two climates, and then to aggregate counts of feasible cells. The final program must produce a single-line output string as specified.\n\nFundamental base you must use:\n- Steady-state heat balance: metabolic heat production equals the sum of dry heat exchange and evaporative cooling required to maintain constant body temperature. For an endotherm at steady state, the balance can be written in terms of rates (in watts). Dry heat exchange is governed by Newton’s law of cooling: it is proportional to the temperature gradient between the body and the environment with proportionality given by a thermal conductance.\n- Allometric scaling of basal metabolic rate (BMR) and minimal thermal conductance: basal metabolic power scales with body mass to the three-quarters power, and minimal dry thermal conductance scales with body mass to the two-thirds power. These are well-tested empirical relationships suitable as a foundation here.\n- Constraints:\n  - There is a maximum sustained metabolic power over a day, represented as a multiple of basal metabolic rate, arising from sustainable aerobic scope.\n  - There is a daily intake ceiling represented as a multiple of basal metabolic rate over a day.\n  - There is a maximum evaporative cooling capacity, also represented as a multiple of basal metabolic rate.\n\nRequired model ingredients to implement:\n- Let body mass be $m$ in $\\mathrm{kg}$, and deep-body temperature be $T_b$ in $\\mathrm{^\\circ C}$.\n- Let basal metabolic power be $B(m) = b_0 \\, m^{3/4}$ in $\\mathrm{W}$, where $b_0$ is a constant in $\\mathrm{W\\;kg^{-3/4}}$.\n- Let minimal dry thermal conductance be $C(m) = c_0 \\, m^{2/3}$ in $\\mathrm{W\\,^\\circ C^{-1}}$, where $c_0$ is a constant in $\\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$.\n- Let the maximum sustained metabolic power be $M_{\\max} = e_{\\max} \\, B(m)$ in $\\mathrm{W}$, where $e_{\\max}$ is dimensionless.\n- Let the maximum evaporative cooling capacity be $E_{\\max} = e_{\\mathrm{evap}} \\, B(m)$ in $\\mathrm{W}$, where $e_{\\mathrm{evap}}$ is dimensionless.\n- Let the maximum daily assimilable energy be $E_{\\mathrm{intake,max}} = e_{\\mathrm{intake}} \\, B(m) \\, t_d$ in $\\mathrm{J}$, where $e_{\\mathrm{intake}}$ is dimensionless and $t_d$ is the length of the day in seconds.\n- For the cold representative month with ambient temperature $T_{\\mathrm{cold}}$ in $\\mathrm{^\\circ C}$, use steady-state heat balance with Newton’s law of cooling to determine the sustained metabolic power needed to hold $T_b$ over the entire day. The sustained metabolic power cannot be less than $B(m)$. The daily energetic requirement is the sustained power times $t_d$, and feasibility demands it does not exceed $E_{\\mathrm{intake,max}}$ and the sustained power does not exceed $M_{\\max}$.\n- For the hot representative month with ambient temperature $T_{\\mathrm{hot}}$ in $\\mathrm{^\\circ C}$, compute the required evaporative cooling rate at steady state when aiming to maintain $T_b$ while producing at least basal metabolic power. Feasibility requires that the evaporative cooling needed does not exceed $E_{\\max}$.\n\nClimates:\n- The grids are $3 \\times 3$ arrays of monthly mean ambient temperatures in $\\mathrm{^\\circ C}$:\n  - Current cold-month grid $T_{\\mathrm{cold}}^{\\mathrm{cur}}$:\n    - Row $1$: $[5,8,6]$\n    - Row $2$: $[10,12,11]$\n    - Row $3$: $[15,17,14]$\n  - Current hot-month grid $T_{\\mathrm{hot}}^{\\mathrm{cur}}$:\n    - Row $1$: $[25,27,26]$\n    - Row $2$: $[30,32,31]$\n    - Row $3$: $[38,40,39]$\n  - Future cold-month grid $T_{\\mathrm{cold}}^{\\mathrm{fut}}$:\n    - Row $1$: $[7,10,8]$\n    - Row $2$: $[12,14,13]$\n    - Row $3$: $[17,19,16]$\n  - Future hot-month grid $T_{\\mathrm{hot}}^{\\mathrm{fut}}$:\n    - Row $1$: $[26,28,27]$\n    - Row $2$: $[32,34,33]$\n    - Row $3$: $[40,42,41]$\n\nConstants and units:\n- Use $t_d = 86400$ seconds for the length of one day.\n- All temperatures are in $\\mathrm{^\\circ C}$.\n- Power is in $\\mathrm{W}$ and daily energy is in $\\mathrm{J}$.\n\nTest suite (three organism parameter sets):\n- Case $1$ (small mammal, moderate scope and intake):\n  - $m = 0.1 \\ \\mathrm{kg}$, $T_b = 37 \\ \\mathrm{^\\circ C}$,\n  - $b_0 = 3.4 \\ \\mathrm{W\\,kg^{-3/4}}$, $c_0 = 0.5 \\ \\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$,\n  - $e_{\\max} = 7$, $e_{\\mathrm{evap}} = 3$, $e_{\\mathrm{intake}} = 6$.\n- Case $2$ (larger mammal, similar scope and intake):\n  - $m = 5.0 \\ \\mathrm{kg}$, $T_b = 37 \\ \\mathrm{^\\circ C}$,\n  - $b_0 = 3.4 \\ \\mathrm{W\\,kg^{-3/4}}$, $c_0 = 0.5 \\ \\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$,\n  - $e_{\\max} = 7$, $e_{\\mathrm{evap}} = 3$, $e_{\\mathrm{intake}} = 6$.\n- Case $3$ (small mammal with low intake capacity):\n  - $m = 0.1 \\ \\mathrm{kg}$, $T_b = 37 \\ \\mathrm{^\\circ C}$,\n  - $b_0 = 3.4 \\ \\mathrm{W\\,kg^{-3/4}}$, $c_0 = 0.5 \\ \\mathrm{W\\,^\\circ C^{-1}\\,kg^{-2/3}}$,\n  - $e_{\\max} = 7$, $e_{\\mathrm{evap}} = 3$, $e_{\\mathrm{intake}} = 2$.\n\nFeasibility rule per grid cell:\n- A grid cell is feasible if and only if the organism is energetically feasible in both the cold-month and the hot-month conditions for that cell, under the rules implied by steady-state heat balance, Newton’s law of cooling, and the constraints described above.\n\nRequired outputs and units:\n- For each test case, compute four integers:\n  - $N_{\\mathrm{cur}}$: the number of feasible cells under the current climate,\n  - $N_{\\mathrm{fut}}$: the number of feasible cells under the future climate,\n  - $N_{\\mathrm{gain}}$: the number of cells infeasible in current but feasible in future,\n  - $N_{\\mathrm{loss}}$: the number of cells feasible in current but infeasible in future.\n- All four values are pure counts (unitless integers).\n\nFinal output format:\n- Your program should produce a single line of output containing an outer list of three inner lists, one per test case, each inner list containing the four integers in the order $[N_{\\mathrm{cur}},N_{\\mathrm{fut}},N_{\\mathrm{gain}},N_{\\mathrm{loss}}]$.\n- The output must have no spaces anywhere. For example, a syntactically correct shape is $[[1,2,0,0],[9,9,0,0],[0,3,3,0]]$ (this is only an example shape; do not reuse these numbers).\n\nAngle units are not applicable. Percentages are not used. Ensure all computations adhere to the physical units specified above and that your implementation follows from the stated fundamental principles rather than any unprovided shortcut formulas.", "solution": "The problem statement is valid. It is scientifically grounded in the fundamental principles of organismal bioenergetics and thermoregulation, including steady-state heat balance, Newton's law of cooling, and established allometric scaling laws. The problem is well-posed, providing all necessary parameters, constants, and unambiguous, quantitative rules for determining energetic feasibility. The setup is self-contained, objective, and free from internal contradictions or factual inaccuracies. We may therefore proceed with a formal derivation and solution.\n\nThe core of the problem is to determine, for each grid cell, whether a hypothetical endotherm can maintain its deep-body temperature $T_b$ given the ambient temperatures of the coldest ($T_{\\mathrm{cold}}$) and hottest ($T_{\\mathrm{hot}}$) months, subject to physiological constraints. A cell is habitable only if the organism is feasible under both thermal scenarios.\n\nFirst, we establish the organism's fundamental physiological parameters based on its body mass, $m$.\nThe basal metabolic power, $B$, is given by the allometric relation:\n$$B(m) = b_0 \\, m^{3/4}$$\nThe minimal dry thermal conductance, $C$, which measures the rate of non-evaporative heat exchange with the environment per degree of temperature difference, is given by:\n$$C(m) = c_0 \\, m^{2/3}$$\nThese base parameters, $B$ and $C$, are used to define the organism's physiological limits. The maximum sustained metabolic power is $M_{\\max} = e_{\\max} \\, B$. The maximum capacity for evaporative cooling is $E_{\\max} = e_{\\mathrm{evap}} \\, B$. The maximum daily energy intake is $E_{\\mathrm{intake,max}} = e_{\\mathrm{intake}} \\, B \\, t_d$, where $t_d$ is the number of seconds in a day ($86400 \\, \\mathrm{s}$).\n\nSecond, we derive the feasibility condition for cold environments, where the ambient temperature is $T_a = T_{\\mathrm{cold}}$. To maintain a constant body temperature $T_b$, the organism must generate metabolic heat to offset the dry heat loss to the environment. According to Newton's law of cooling, this dry heat loss is $H_{\\text{dry}} = C \\cdot (T_b - T_a)$. Assuming negligible evaporative cooling in the cold (a standard simplifying assumption for conditions below thermoneutrality), the required metabolic power, $M_{\\mathrm{req,cold}}$, must balance this loss: $M_{\\mathrm{req,cold}} = C \\cdot (T_b - T_{\\mathrm{cold}})$. However, an endotherm's metabolic rate cannot fall below its basal level, $B$. Therefore, the actual metabolic power sustained in the cold, $M_{\\mathrm{cold}}$, is:\n$$M_{\\mathrm{cold}} = \\max(B, C \\cdot (T_b - T_{\\mathrm{cold}}))$$\nFor the organism to be viable, this required metabolic power must not exceed its maximum sustained metabolic power, $M_{\\max}$. Additionally, the total energy required over a day, $E_{\\mathrm{daily}} = M_{\\mathrm{cold}} \\cdot t_d$, must not exceed the maximum daily assimilable energy, $E_{\\mathrm{intake,max}}$. These two constraints can be expressed as:\n$$M_{\\mathrm{cold}} \\le M_{\\max} = e_{\\max} \\, B$$\n$$M_{\\mathrm{cold}} \\cdot t_d \\le E_{\\mathrm{intake,max}} = e_{\\mathrm{intake}} \\, B \\, t_d \\implies M_{\\mathrm{cold}} \\le e_{\\mathrm{intake}} \\, B$$\nCombining these, the necessary condition for feasibility in the cold is:\n$$M_{\\mathrm{cold}} \\le \\min(e_{\\max}, e_{\\mathrm{intake}}) \\cdot B$$\nSubstituting the expression for $M_{\\mathrm{cold}}$, the full condition becomes:\n$$\\max(B, C \\cdot (T_b - T_{\\mathrm{cold}})) \\le \\min(e_{\\max}, e_{\\mathrm{intake}}) \\cdot B$$\n\nThird, we derive the feasibility condition for hot environments, where $T_a = T_{\\mathrm{hot}}$. In this case, dry heat loss is reduced and may even become a heat gain if $T_{\\mathrm{hot}} > T_b$. The organism must dissipate its metabolic heat. The problem specifies we should calculate the required evaporative cooling while the organism is at its basal metabolic rate, $M=B$, as this represents the minimum heat load it must handle. The steady-state heat balance equation is $M = H_{\\text{dry}} + E_{\\text{evap}}$, which gives $E_{\\text{evap}} = M - H_{\\text{dry}}$. The required evaporative cooling, $E_{\\mathrm{req,hot}}$, is thus:\n$$E_{\\mathrm{req,hot}} = B - C \\cdot (T_b - T_{\\mathrm{hot}})$$\nIf this expression is negative (i.e., if $T_{\\mathrm{hot}}$ is low enough that dry heat loss exceeds basal heat production), no evaporative cooling is needed, so the required amount is $0$. Hence, we must use:\n$$E_{\\mathrm{req,hot}} = \\max(0, B - C \\cdot (T_b - T_{\\mathrm{hot}}))$$\nFor the organism to be viable, this required cooling must not exceed its physiological maximum, $E_{\\max}$. The feasibility condition for the hot month is:\n$$E_{\\mathrm{req,hot}} \\le E_{\\max} = e_{\\mathrm{evap}} \\cdot B$$\nSubstituting the expression for $E_{\\mathrm{req,hot}}$, the full condition is:\n$$\\max(0, B - C \\cdot (T_b - T_{\\mathrm{hot}})) \\le e_{\\mathrm{evap}} \\cdot B$$\n\nFinally, we synthesize these conditions to predict the organism's range. For each of the three test cases, we first calculate the organism-specific parameters $B$ and $C$. Then, for each of the $9$ grid cells, we apply the feasibility rules for both the current and future climates.\nA boolean matrix of feasibility, $F^{\\mathrm{cur}}$, is computed for the current climate, where an element $F^{\\mathrm{cur}}_{ij}$ is true if and only if the cell $(i,j)$ is feasible in both its cold month ($T^{\\mathrm{cur}}_{\\mathrm{cold}, ij}$) and hot month ($T^{\\mathrm{cur}}_{\\mathrm{hot}, ij}$). A similar matrix, $F^{\\mathrm{fut}}$, is computed for the future climate.\nFrom these matrices, the required counts are calculated:\n- $N_{\\mathrm{cur}} = \\sum_{i,j} F^{\\mathrm{cur}}_{ij}$ (number of feasible cells in current climate)\n- $N_{\\mathrm{fut}} = \\sum_{i,j} F^{\\mathrm{fut}}_{ij}$ (number of feasible cells in future climate)\n- $N_{\\mathrm{gain}} = \\sum_{i,j} (\\neg F^{\\mathrm{cur}}_{ij} \\land F^{\\mathrm{fut}}_{ij})$ (cells gained)\n- $N_{\\mathrm{loss}} = \\sum_{i,j} (F^{\\mathrm{cur}}_{ij} \\land \\neg F^{\\mathrm{fut}}_{ij})$ (cells lost)\n\nThis procedure is implemented for each of the three organismal parameter sets provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes energetic feasibility and range limits for an endothermic organism\n    based on first principles of heat balance and allometric scaling.\n    \"\"\"\n\n    # Climate Grids\n    T_cold_cur = np.array([\n        [5, 8, 6],\n        [10, 12, 11],\n        [15, 17, 14]\n    ], dtype=float)\n\n    T_hot_cur = np.array([\n        [25, 27, 26],\n        [30, 32, 31],\n        [38, 40, 39]\n    ], dtype=float)\n\n    T_cold_fut = np.array([\n        [7, 10, 8],\n        [12, 14, 13],\n        [17, 19, 16]\n    ], dtype=float)\n\n    T_hot_fut = np.array([\n        [26, 28, 27],\n        [32, 34, 33],\n        [40, 42, 41]\n    ], dtype=float)\n\n    # Test suite: (m, T_b, b0, c0, e_max, e_evap, e_intake)\n    test_cases = [\n        # Case 1: small mammal, moderate scope and intake\n        (0.1, 37.0, 3.4, 0.5, 7.0, 3.0, 6.0),\n        # Case 2: larger mammal, similar scope and intake\n        (5.0, 37.0, 3.4, 0.5, 7.0, 3.0, 6.0),\n        # Case 3: small mammal with low intake capacity\n        (0.1, 37.0, 3.4, 0.5, 7.0, 3.0, 2.0)\n    ]\n\n    # Global constants\n    # t_d = 86400  # seconds in a day. Not explicitly needed if we work with powers.\n\n    all_results = []\n\n    for case in test_cases:\n        m, T_b, b0, c0, e_max, e_evap, e_intake = case\n\n        # --- Step 1: Calculate organism-specific parameters ---\n        # Basal Metabolic Power (W)\n        B = b0 * (m ** (3/4))\n        # Minimal Dry Thermal Conductance (W/°C)\n        C = c0 * (m ** (2/3))\n\n        def is_cell_feasible(T_cold, T_hot):\n            \"\"\"Checks feasibility for a single cell given its cold/hot month temps.\"\"\"\n            \n            # --- Step 2: Check cold month feasibility ---\n            # Required metabolic power to offset dry heat loss, not falling below BMR\n            M_cold_req = np.maximum(B, C * (T_b - T_cold))\n            \n            # Cold feasibility constraints:\n            # 1. Sustained power does not exceed max aerobic scope (M_max = e_max * B)\n            # 2. Daily energy requirement does not exceed max intake (M_cold <= e_intake * B)\n            cold_limit_factor = min(e_max, e_intake)\n            is_feasible_cold = (M_cold_req <= cold_limit_factor * B)\n\n            # --- Step 3: Check hot month feasibility ---\n            # Required evaporative cooling at basal metabolic rate\n            E_req_hot = np.maximum(0, B - C * (T_b - T_hot))\n\n            # Hot feasibility constraint: required cooling does not exceed max capacity\n            is_feasible_hot = (E_req_hot <= e_evap * B)\n\n            # Cell is feasible if and only if both conditions are met\n            return is_feasible_cold and is_feasible_hot\n\n        # --- Step 4: Compute feasibility grids ---\n        is_feasible_cur = np.zeros_like(T_cold_cur, dtype=bool)\n        is_feasible_fut = np.zeros_like(T_cold_fut, dtype=bool)\n\n        for i in range(T_cold_cur.shape[0]):\n            for j in range(T_cold_cur.shape[1]):\n                is_feasible_cur[i, j] = is_cell_feasible(T_cold_cur[i, j], T_hot_cur[i, j])\n                is_feasible_fut[i, j] = is_cell_feasible(T_cold_fut[i, j], T_hot_fut[i, j])\n\n        # --- Step 5: Aggregate results ---\n        N_cur = np.sum(is_feasible_cur)\n        N_fut = np.sum(is_feasible_fut)\n        \n        # N_gain: cells that are NOT feasible in current but ARE in future\n        N_gain = np.sum(np.logical_and(np.logical_not(is_feasible_cur), is_feasible_fut))\n        \n        # N_loss: cells that ARE feasible in current but ARE NOT in future\n        N_loss = np.sum(np.logical_and(is_feasible_cur, np.logical_not(is_feasible_fut)))\n        \n        all_results.append([N_cur, N_fut, N_gain, N_loss])\n\n    # --- Step 6: Format output ---\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2516337"}]}