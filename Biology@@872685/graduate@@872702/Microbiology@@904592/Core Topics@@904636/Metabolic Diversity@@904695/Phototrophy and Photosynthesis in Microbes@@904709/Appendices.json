{"hands_on_practices": [{"introduction": "This exercise delves into the fundamental energetic constraints of oxygenic photosynthesis by bridging quantum mechanics and thermodynamics. You will calculate the absolute theoretical minimum number of photons required to split water and produce NADPH, based on the energy of light and the electrochemical potential difference of the overall reaction. By comparing this ideal thermodynamic limit to the known photon requirement of the natural Z-scheme, this practice [@problem_id:2521563] illuminates the inherent trade-offs between efficiency and mechanism in biological energy conversion and provides a deeper appreciation for why the two-photosystem architecture evolved.", "problem": "In oxygenic phototrophic microbes, the Z-scheme employs two reaction centers that absorb predominantly at wavelengths near Photosystem II (PSII) $\\lambda_{\\mathrm{PSII}} = 680\\,\\mathrm{nm}$ and Photosystem I (PSI) $\\lambda_{\\mathrm{PSI}} = 700\\,\\mathrm{nm}$. Consider the net light-driven redox transformation under standard biochemical conditions at $\\mathrm{pH}\\,7$:\n$$2\\,\\mathrm{H_2O} + 2\\,\\mathrm{NADP^+} \\longrightarrow \\mathrm{O_2} + 2\\,\\mathrm{NADPH} + 2\\,\\mathrm{H^+},$$\nwhich corresponds to moving $4$ electrons from water to nicotinamide adenine dinucleotide phosphate (NADP$^+$). Assume the following well-tested standard reduction potentials at $\\mathrm{pH}\\,7$: for the $\\mathrm{O_2}/\\mathrm{H_2O}$ couple, $E^{\\circ\\prime}_{\\mathrm{O_2}/\\mathrm{H_2O}} = +0.815\\,\\mathrm{V}$; for the $\\mathrm{NADP^+}/\\mathrm{NADPH}$ couple, $E^{\\circ\\prime}_{\\mathrm{NADP^+}/\\mathrm{NADPH}} = -0.324\\,\\mathrm{V}$. Use the fundamental photon relation between energy and wavelength, and the thermodynamic relation connecting redox potentials to Gibbs free energy, together with these physical constants: Planck constant $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$, speed of light $c = 2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}}$, Avogadro constant $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$, and Faraday constant $F = 96485\\,\\mathrm{C\\,mol^{-1}}$.\n\nStarting only from these foundations and the physical constraint that a single absorbed photon in a reaction center can at most drive a single charge-separation event corresponding to transfer of $1$ electron, derive an estimate for the theoretical minimum number of photons required to evolve $1$ molecule of $\\mathrm{O_2}$ and reduce $2$ molecules of NADP$^+$ to NADPH. Use photon wavelengths $680\\,\\mathrm{nm}$ and $700\\,\\mathrm{nm}$ to quantify photon energies, and express intermediate energetic quantities in $\\mathrm{kJ\\,mol^{-1}}$. Then, briefly compare this theoretical minimum to the canonical requirement of $8$–$10$ photons in the natural Z-scheme, explaining the origin of any discrepancy in terms of first principles. Report as your final answer only the theoretical minimum number of photons (a pure number, no units). No rounding instruction is needed for the final answer.", "solution": "The problem requires the derivation of the theoretical minimum number of photons needed to drive the oxygenic photosynthesis reaction that evolves one molecule of $\\mathrm{O_2}$ and reduces two molecules of $\\mathrm{NADP^+}$. The derivation must be based on first principles of thermodynamics and quantum mechanics, using the provided data and adhering to the specified physical constraint.\n\nFirst, we must determine the total energy required to drive the given net reaction under standard biochemical conditions ($\\mathrm{pH}\\,7$). The reaction is:\n$$2\\,\\mathrm{H_2O} + 2\\,\\mathrm{NADP^+} \\longrightarrow \\mathrm{O_2} + 2\\,\\mathrm{NADPH} + 2\\,\\mathrm{H^+}$$\nThis is a redox reaction. The change in standard Gibbs free energy, $\\Delta G^{\\circ\\prime}$, is related to the change in standard reduction potential, $\\Delta E^{\\circ\\prime}$, by the equation:\n$$\\Delta G^{\\circ\\prime} = -nF\\Delta E^{\\circ\\prime}$$\nwhere $n$ is the number of moles of electrons transferred, and $F$ is the Faraday constant.\n\nThe overall reaction can be broken down into two half-reactions. The electron donor is water ($\\mathrm{H_2O}$), and the electron acceptor is $\\mathrm{NADP^+}$.\nThe standard reduction potential for the acceptor ($\\mathrm{NADP^+}/\\mathrm{NADPH}$ couple) is $E^{\\circ\\prime}_{\\mathrm{acceptor}} = E^{\\circ\\prime}_{\\mathrm{NADP^+}/\\mathrm{NADPH}} = -0.324\\,\\mathrm{V}$.\nThe standard reduction potential for the donor ($\\mathrm{O_2}/\\mathrm{H_2O}$ couple) is $E^{\\circ\\prime}_{\\mathrm{donor}} = E^{\\circ\\prime}_{\\mathrm{O_2}/\\mathrm{H_2O}} = +0.815\\,\\mathrm{V}$.\n\nThe overall change in standard potential for the reaction is the potential of the species being reduced (cathode) minus the potential of the species being oxidized (anode):\n$$\\Delta E^{\\circ\\prime} = E^{\\circ\\prime}_{\\mathrm{acceptor}} - E^{\\circ\\prime}_{\\mathrm{donor}} = -0.324\\,\\mathrm{V} - (+0.815\\,\\mathrm{V}) = -1.139\\,\\mathrm{V}$$\nThe problem states that $n=4$ electrons are transferred for the evolution of one molecule of $\\mathrm{O_2}$. Using the Faraday constant $F = 96485\\,\\mathrm{C\\,mol^{-1}}$, we can calculate the required Gibbs free energy change. Note that $1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$.\n$$\\Delta G^{\\circ\\prime} = -(4\\,\\mathrm{mol})(96485\\,\\mathrm{C\\,mol^{-1}})(-1.139\\,\\mathrm{V})$$\n$$\\Delta G^{\\circ\\prime} = 439600.94\\,\\mathrm{J\\,mol^{-1}} \\approx 439.6\\,\\mathrm{kJ\\,mol^{-1}}$$\nThis is the minimum energy that must be supplied by light to drive the synthesis of one mole of $\\mathrm{O_2}$.\n\nNext, we calculate the energy supplied by the photons. The energy of one mole of photons (one Einstein) is given by the Planck-Einstein relation:\n$$E_{\\mathrm{mole}} = \\frac{N_{\\mathrm{A}}hc}{\\lambda}$$\nwhere $N_{\\mathrm{A}}$ is the Avogadro constant, $h$ is the Planck constant, $c$ is the speed of light, and $\\lambda$ is the wavelength. The problem provides two wavelengths, $\\lambda_{\\mathrm{PSII}} = 680\\,\\mathrm{nm}$ and $\\lambda_{\\mathrm{PSI}} = 700\\,\\mathrm{nm}$. To determine a theoretical minimum number of photons, we must consider the least energetic photons, which correspond to the longest wavelength, $\\lambda = 700 \\times 10^{-9}\\,\\mathrm{m}$.\n$$E_{\\mathrm{mole}, 700} = \\frac{(6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}})(6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s})(2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}})}{700 \\times 10^{-9}\\,\\mathrm{m}}$$\n$$E_{\\mathrm{mole}, 700} \\approx 170849\\,\\mathrm{J\\,mol^{-1}} \\approx 170.8\\,\\mathrm{kJ\\,mol^{-1}}$$\nFor completeness, for $\\lambda = 680 \\times 10^{-9}\\,\\mathrm{m}$:\n$$E_{\\mathrm{mole}, 680} \\approx 175924\\,\\mathrm{J\\,mol^{-1}} \\approx 175.9\\,\\mathrm{kJ\\,mol^{-1}}$$\n\nThe problem includes the critical physical constraint: \"a single absorbed photon in a reaction center can at most drive a single charge-separation event corresponding to transfer of $1$ electron\". This implies a one-to-one relationship between photons absorbed and electrons transferred. Since the overall reaction requires the transfer of $n=4$ electrons, the theoretical minimum number of photons must be at least $4$.\n\nWe must verify if this is energetically feasible. This requires checking if the energy of a single photon is sufficient to drive a single electron across the entire potential gradient. The total energy required per mole of reaction is $\\Delta G^{\\circ\\prime} \\approx 439.6\\,\\mathrm{kJ\\,mol^{-1}}$ for $n=4$ moles of electrons. The energy required per mole of electrons is:\n$$\\frac{\\Delta G^{\\circ\\prime}}{n} = \\frac{439.6\\,\\mathrm{kJ\\,mol^{-1}}}{4\\,\\mathrm{mol}} = 109.9\\,\\mathrm{kJ\\,mol^{-1}}$$\nThe energy supplied by one mole of the least energetic photons ($\\lambda = 700\\,\\mathrm{nm}$) is $E_{\\mathrm{mole}, 700} \\approx 170.8\\,\\mathrm{kJ\\,mol^{-1}}$. Since $170.8\\,\\mathrm{kJ\\,mol^{-1}} > 109.9\\,\\mathrm{kJ\\,mol^{-1}}$, the energy of a single $700\\,\\mathrm{nm}$ photon is more than sufficient to provide the energy needed to move a single electron from water to $\\mathrm{NADP^+}$.\n\nTherefore, given the constraint that one photon moves one electron, and the reaction requires moving four electrons, the theoretical minimum number of photons is precisely $4$.\n\nThe problem also asks to compare this theoretical minimum of $4$ photons to the canonical experimental value of $8$–$10$ photons. The discrepancy arises from the distinction between a thermodynamic limit and a mechanistic reality. Our calculation of a $4$-photon minimum assumes a hypothetical photosystem capable of using one photon to drive an electron over the entire potential difference of $1.139\\,\\mathrm{V}$. Such a large potential gap is difficult to bridge in a single photochemical step.\n\nThe natural Z-scheme circumvents this by splitting the process into two smaller, sequential photochemical steps, at Photosystem II (PSII) and Photosystem I (PSI). In this mechanism:\n1.  One photon is absorbed by PSII to excite an electron from the oxygen-evolving complex to a higher energy level.\n2.  The electron then loses some energy as it passes through the cytochrome $b_6f$ complex.\n3.  A second photon is absorbed by PSI to re-excite the same electron to a very high energy level, sufficient to reduce $\\mathrm{NADP^+}$.\n\nThus, each electron requires two photons to complete its journey from $\\mathrm{H_2O}$ to $\\mathrm{NADPH}$. Since the net reaction involves $4$ electrons, the mechanistic minimum based on the Z-scheme is $4\\,\\mathrm{electrons} \\times 2\\,\\mathrm{photons/electron} = 8$ photons. The range of $8$–$10$ photons observed in nature accounts for further inefficiencies not considered in an ideal model, such as non-productive photon absorption (energy lost as heat or fluorescence) and diversion of electrons to alternative pathways (e.g., cyclic photophosphorylation). The value of $8$ represents a perfect quantum yield for the two-step mechanism, while the thermodynamic minimum of $4$ represents a hypothetical, single-step perfect quantum yield.", "answer": "$$\\boxed{4}$$", "id": "2521563"}, {"introduction": "Building on the concept of capturing light energy, we now turn to its conversion into the cell's universal energy currency, ATP. Photosynthetic electron transport generates a proton motive force ($\\Delta p$), an electrochemical gradient across the membrane. This practice [@problem_id:2521582] establishes the direct quantitative relationship between the magnitude of the $\\Delta p$, the thermodynamic cost of ATP synthesis ($\\Delta G_{\\mathrm{ATP}}$), and the proton-to-ATP stoichiometry of the ATP synthase enzyme, providing a tangible application of Peter Mitchell's chemiosmotic theory.", "problem": "A unicellular phototrophic bacterium uses light-driven electron transport to generate a proton motive force (pmf) across its cytoplasmic membrane, which is then used by the membrane rotary enzyme adenosine triphosphate (ATP) synthase to produce adenosine triphosphate (ATP). The pmf is the electrochemical potential difference for protons, traditionally expressed as an electrical potential in volts that combines the membrane electrical potential difference and the transmembrane pH gradient into a single quantity. Assume that synthesizing one molecule of ATP under the given cellular conditions requires a standard transformed free energy change of $\\Delta G_{\\mathrm{ATP}}=50\\,\\mathrm{kJ\\,mol^{-1}}$, that the stoichiometry of the ATP synthase is $n=3.3$ protons per ATP, and that the temperature is $T=298\\,\\mathrm{K}$. Neglect activity coefficient effects and assume that the minimum requirement for ATP synthesis is achieved when the free energy available from translocating $n$ protons down the pmf exactly matches $\\Delta G_{\\mathrm{ATP}}$. Use the Faraday constant $F=96485\\,\\mathrm{C\\,mol^{-1}}$ and the gas constant $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nStarting from first principles of chemiosmotic coupling and the definition of the proton motive force as the electrochemical potential difference for protons, derive an expression for the minimum magnitude of the proton motive force, $\\Delta p_{\\min}$, required to drive ATP synthesis in terms of $\\Delta G_{\\mathrm{ATP}}$, $n$, and $F$. Then evaluate this minimum for the given numerical values and report the result as an electrical potential in millivolts. Round your numerical answer to three significant figures and express it in millivolts. Additionally, in words, briefly explain how $\\Delta p_{\\min}$ depends on $n$ (no numerical result is required for this qualitative explanation).", "solution": "We begin from the first principles of thermodynamics as applied to chemiosmotic coupling. The synthesis of one mole of adenosine triphosphate (ATP) is an endergonic process that requires a Gibbs free energy input of $\\Delta G_{\\mathrm{ATP}}$. In the context of photophosphorylation or oxidative phosphorylation, this energy is supplied by the translocation of protons ($H^+$) down their electrochemical potential gradient across a membrane. This gradient is the proton motive force (pmf).\n\nLet $\\Delta \\tilde{\\mu}_{H^+}$ be the electrochemical potential difference for protons across the membrane, defined as the energy released when one mole of protons moves from the high-potential region (periplasm or outside) to the low-potential region (cytoplasm or inside). The total free energy made available by the translocation of $n$ moles of protons is thus $n \\Delta \\tilde{\\mu}_{H^+}$.\n\nThe problem states that the minimum requirement for ATP synthesis is achieved when the free energy available from proton translocation exactly matches the free energy required for ATP synthesis. This establishes the following energy balance equation:\n$$ n \\Delta \\tilde{\\mu}_{H^+} = \\Delta G_{\\mathrm{ATP}} $$\nThe problem defines the proton motive force, $\\Delta p$, as the electrochemical potential difference expressed in units of electrical potential (volts). The conversion between energy per mole ($\\Delta \\tilde{\\mu}_{H^+}$) and electrical potential ($\\Delta p$) is mediated by the Faraday constant, $F$, which represents the electric charge per mole of elementary charges. For protons, which have a charge of $+1$, the relationship is:\n$$ \\Delta p = \\frac{\\Delta \\tilde{\\mu}_{H^+}}{F} $$\nFrom this definition, we can express the electrochemical potential difference in terms of the pmf:\n$$ \\Delta \\tilde{\\mu}_{H^+} = F \\Delta p $$\nWe are interested in the minimum magnitude of the pmf, which we denote as $\\Delta p_{\\min}$. Substituting the expression for $\\Delta \\tilde{\\mu}_{H^+}$ into the energy balance equation gives:\n$$ n F \\Delta p_{\\min} = \\Delta G_{\\mathrm{ATP}} $$\nSolving for $\\Delta p_{\\min}$, we arrive at the desired expression:\n$$ \\Delta p_{\\min} = \\frac{\\Delta G_{\\mathrm{ATP}}}{nF} $$\nThis expression provides the minimum proton motive force required to drive ATP synthesis in terms of the thermodynamic cost of synthesis, $\\Delta G_{\\mathrm{ATP}}$, the proton-per-ATP stoichiometry, $n$, and the Faraday constant, $F$. The provided temperature $T$ and gas constant $R$ would be necessary to decompose $\\Delta p$ into its constituent parts—the membrane electrical potential $\\Delta\\psi$ and the pH gradient $\\Delta\\text{pH}$—but are not required for this derivation based on the specified variables.\n\nNext, we evaluate this expression using the given numerical values.\nThe standard transformed free energy change for ATP synthesis is $\\Delta G_{\\mathrm{ATP}} = 50\\,\\mathrm{kJ\\,mol^{-1}}$. We must convert this to SI base units for consistency.\n$$ \\Delta G_{\\mathrm{ATP}} = 50\\,\\mathrm{kJ\\,mol^{-1}} = 50 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}} $$\nThe other given values are the stoichiometry $n = 3.3$ and the Faraday constant $F = 96485\\,\\mathrm{C\\,mol^{-1}}$.\nSubstituting these values into our derived formula for $\\Delta p_{\\min}$:\n$$ \\Delta p_{\\min} = \\frac{50 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}}{3.3 \\times 96485\\,\\mathrm{C\\,mol^{-1}}} $$\nThe calculation proceeds as:\n$$ \\Delta p_{\\min} \\approx \\frac{50000}{318300.5}\\,\\mathrm{J\\,C^{-1}} \\approx 0.157085\\,\\mathrm{V} $$\nThe result is in volts ($V$), as $1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$. The problem requires the answer to be expressed in millivolts ($mV$). We perform the conversion:\n$$ \\Delta p_{\\min} \\approx 0.157085\\,\\mathrm{V} \\times 1000\\,\\mathrm{mV\\,V^{-1}} \\approx 157.085\\,\\mathrm{mV} $$\nRounding this result to three significant figures, we obtain the minimum required proton motive force:\n$$ \\Delta p_{\\min} \\approx 157\\,\\mathrm{mV} $$\n\nFinally, we are asked to explain the dependence of $\\Delta p_{\\min}$ on the stoichiometry $n$. Our derived expression is $\\Delta p_{\\min} = \\frac{\\Delta G_{\\mathrm{ATP}}}{nF}$. Since $\\Delta G_{\\mathrm{ATP}}$ and $F$ are treated as constants in this context, the minimum required proton motive force $\\Delta p_{\\min}$ is inversely proportional to the stoichiometry $n$. A larger value for $n$ means that more protons are translocated to synthesize one molecule of ATP. This implies that the energetic \"load\" is distributed over a larger number of protons. Consequently, the energy required from each individual proton is smaller, which translates to a smaller required driving force, or a lower minimum proton motive force, $\\Delta p_{\\min}$. Conversely, if the ATP synthase is less efficient and uses fewer protons (a smaller $n$) to make one ATP, each proton must contribute more energy to overcome the $\\Delta G_{\\mathrm{ATP}}$ barrier, thus necessitating a larger magnitude for the proton motive force.", "answer": "$$ \\boxed{157} $$", "id": "2521582"}, {"introduction": "This final practice integrates the preceding principles into a cohesive metabolic model, reflecting the challenges a real cyanobacterium faces in managing its energy budget. The cell must dynamically balance its production of ATP and NADPH to meet the precise demands of carbon fixation, a task achieved by partitioning electron flow between linear and cyclic pathways. In this exercise [@problem_id:2521591], you will translate the stoichiometric rules of electron transport into a computational algorithm, creating a predictive tool that determines how a cell should allocate photon resources—a foundational skill in systems biology and metabolic engineering.", "problem": "You are tasked with building a minimal stoichiometric allocator for cyanobacterial photometabolism that, given an absorbed photon supply and a carbon fixation demand, computes the achievable adenosine triphosphate (ATP) and nicotinamide adenine dinucleotide phosphate (NADPH) production rates and determines whether cyclic electron flow must be used. Your allocator must be derived from the following foundational, well-tested facts of oxygenic photosynthesis in cyanobacteria and must not assume any additional shortcuts beyond what can be logically derived from them.\n\nFundamental base to use:\n- In linear electron flow through Photosystem II (PSII) and Photosystem I (PSI), two electrons reduce one nicotinamide adenine dinucleotide phosphate (NADP) to one NADPH. This requires two photochemical excitations per electron (one in PSII and one in PSI), so one NADPH formation requires $4$ photons.\n- For two electrons transferred from water to NADP in linear flow, water oxidation releases $2$ protons to the lumen at PSII, and the cytochrome $\\mathrm{b}_{6}\\mathrm{f}$ complex translocates $4$ additional protons to the lumen via the Q-cycle. Thus, per two electrons transferred (that is, per one NADPH formed), the lumen gains $6$ protons.\n- In cyclic electron flow around PSI, electrons are excited by PSI and cycled back through the cytochrome $\\mathrm{b}_{6}\\mathrm{f}$ complex without net NADPH formation or water oxidation. For two electrons cycled, the cytochrome $\\mathrm{b}_{6}\\mathrm{f}$ complex translocates $4$ protons to the lumen. Photochemically, one photon at PSI is required per electron; thus, two photons drive the cyclic translocation of $4$ protons.\n- The chloroplast or cyanobacterial ATP synthase couples proton motive force to ATP synthesis with an effective stoichiometry of $4$ protons per ATP synthesized.\n\nCarbon fixation demand model:\n- The Calvin–Benson–Bassham cycle consumes $3$ ATP and $2$ NADPH per carbon dioxide fixed. Let the gross fixation demand be $r_{\\mathrm{CO2}}$ in units of molecules per second per cell. The additional ATP-only load from processes such as a carbon concentrating mechanism, transport, or maintenance is $A_{\\mathrm{extra}}$ in molecules per second per cell.\n\nAvailable resource:\n- Let $P$ denote the total number of absorbed photons per second per cell available to the light reactions.\n\nAllocation assumptions and objective:\n- Photons allocated to linear electron flow generate both ATP and NADPH as dictated by the above stoichiometries. Photons allocated to cyclic electron flow generate ATP only. No other sources or sinks are considered. If photons are insufficient to meet demands, your allocator should prioritize meeting the NADPH demand by assigning photons to linear electron flow first. Only if the NADPH demand is fully met should photons be assigned to cyclic electron flow to supplement ATP production. If photons remain after all demands are met, they are considered unused. If photons are insufficient to meet the NADPH demand, do not allocate any photons to cyclic electron flow.\n- Define a binary indicator that is true if and only if a strictly positive number of photons are allocated to cyclic electron flow under the above strategy.\n\nYour tasks:\n- From the fundamental base, derive expressions for the per-photon yields of ATP and NADPH in linear electron flow, and the per-photon yield of ATP in cyclic electron flow. Then derive an algorithm that, given $P$, $r_{\\mathrm{CO2}}$, and $A_{\\mathrm{extra}}$, computes the achieved ATP production rate and NADPH production rate (both in molecules per second per cell) under the stated priority and allocation rules, together with the binary indicator of whether cyclic electron flow is engaged.\n- Implement this algorithm as a complete, runnable program as specified below.\n\nUnits and numerical output:\n- All input parameters $P$, $r_{\\mathrm{CO2}}$, and $A_{\\mathrm{extra}}$ are implicitly in molecules per second per cell, with photons for $P$ and molecules for $r_{\\mathrm{CO2}}$ and $A_{\\mathrm{extra}}$. Your program must output ATP and NADPH production rates in molecules per second per cell. Numerical results must be rounded to exactly three decimal places. The boolean indicator must be either true or false as a programming-language boolean.\n\nTest suite:\n- Your program must compute results for the following test cases, each a tuple $\\left(P, r_{\\mathrm{CO2}}, A_{\\mathrm{extra}}\\right)$:\n  - Case $1$: $\\left(1000, 50, 0\\right)$.\n  - Case $2$: $\\left(500, 50, 40\\right)$.\n  - Case $3$: $\\left(300, 50, 0\\right)$.\n  - Case $4$: $\\left(180, 20, 10\\right)$.\n  - Case $5$: $\\left(240, 30, 20\\right)$.\n  - Case $6$: $\\left(200, 0, 50\\right)$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a list of the form $\\left[\\text{ATP}, \\text{NADPH}, \\text{cyclic}\\right]$. For example: $\\left[\\left[\\text{ATP}_{1}, \\text{NADPH}_{1}, \\text{cyclic}_{1}\\right], \\ldots, \\left[\\text{ATP}_{6}, \\text{NADPH}_{6}, \\text{cyclic}_{6}\\right]\\right]$. Ensure the two rates are rounded to exactly three decimal places and the boolean is a language-native boolean literal.", "solution": "The task is to construct a stoichiometric model for a cyanobacterial cell that, given an influx of photons $P$, a carbon fixation demand $r_{\\mathrm{CO2}}$, and an auxiliary ATP demand $A_{\\mathrm{extra}}$, calculates the achievable production rates of adenosine triphosphate (ATP) and nicotinamide adenine dinucleotide phosphate (NADPH). The model must adhere to a specified resource allocation strategy.\n\nFirst, we must derive the per-photon yields of ATP and NADPH for the two modes of photosynthetic electron flow: linear electron flow (LEF) and cyclic electron flow (CEF).\n\n**Derivation of Stoichiometric Yields**\n\nThe provided fundamental data are used to derive these yields. All rates are implicitly per cell per second.\n\n*   **Linear Electron Flow (LEF):**\n    In LEF, electrons flow from water through Photosystem II (PSII) and Photosystem I (PSI) to NADP$^+$.\n    1.  **NADPH Yield:** The formation of one molecule of NADPH requires the transfer of two electrons, with each electron's transport through both photosystems requiring two photochemical excitations. Thus, $4$ photons are consumed per NADPH produced. The per-photon yield of NADPH in LEF, denoted $\\phi_{\\text{NADPH, LEF}}$, is:\n        $$\\phi_{\\text{NADPH, LEF}} = \\frac{1 \\text{ NADPH}}{4 \\text{ photons}} = 0.25$$\n    2.  **ATP Yield:** The transfer of two electrons (i.e., the formation of one NADPH) is coupled to the translocation of a total of $6$ protons (H$^+$) into the thylakoid lumen: $2$ from water oxidation at PSII and $4$ via the Q-cycle at the cytochrome b$_6$f complex. The ATP synthase enzyme synthesizes $1$ ATP for every $4$ protons that pass through it. Therefore, the formation of $1$ NADPH results in the production of:\n        $$\\frac{6 \\text{ H}^+}{4 \\text{ H}^+ / \\text{ATP}} = 1.5 \\text{ ATP}$$\n        Since these $1.5$ ATP molecules are generated by the same $4$ photons that produced the NADPH, the per-photon yield of ATP in LEF, denoted $\\phi_{\\text{ATP, LEF}}$, is:\n        $$\\phi_{\\text{ATP, LEF}} = \\frac{1.5 \\text{ ATP}}{4 \\text{ photons}} = 0.375$$\n\n*   **Cyclic Electron Flow (CEF):**\n    In CEF, electrons are cycled around PSI and the cytochrome b$_6$f complex, leading to proton translocation without net NADPH production.\n    1.  **NADPH Yield:** By definition, CEF does not produce NADPH.\n        $$\\phi_{\\text{NADPH, CEF}} = 0$$\n    2.  **ATP Yield:** For every two electrons passed through the cycle, which requires $2$ photons (one per electron at PSI), the Q-cycle translocates $4$ protons. These protons can generate:\n        $$\\frac{4 \\text{ H}^+}{4 \\text{ H}^+ / \\text{ATP}} = 1 \\text{ ATP}$$\n        Therefore, $2$ photons in CEF produce $1$ ATP. The per-photon yield of ATP in CEF, denoted $\\phi_{\\text{ATP, CEF}}$, is:\n        $$\\phi_{\\text{ATP, CEF}} = \\frac{1 \\text{ ATP}}{2 \\text{ photons}} = 0.5$$\n\n**Algorithmic Design of the Photon Allocator**\n\nThe allocation algorithm distributes the total available photons, $P$, between LEF and CEF based on metabolic demands and a specified priority scheme.\n\n**Step 1: Quantify Metabolic Demands**\nThe total demands for NADPH and ATP are calculated from the carbon fixation rate, $r_{\\mathrm{CO2}}$, and the additional ATP load, $A_{\\mathrm{extra}}$.\n*   **NADPH Demand ($D_{\\text{NADPH}}$):** The Calvin-Benson-Bassham cycle consumes $2$ NADPH per CO$_2$ fixed.\n    $$D_{\\text{NADPH}} = 2 \\cdot r_{\\mathrm{CO2}}$$\n*   **ATP Demand ($D_{\\text{ATP}}$):** The cycle consumes $3$ ATP per CO$_2$, plus the additional load.\n    $$D_{\\text{ATP}} = 3 \\cdot r_{\\mathrm{CO2}} + A_{\\text{extra}}$$\n\n**Step 2: Prioritized Allocation to Linear Electron Flow**\nThe problem mandates prioritizing NADPH production. Since only LEF produces NADPH, photons are first allocated to LEF to satisfy $D_{\\text{NADPH}}$.\n*   The number of photons required for LEF to meet this demand, $P_{\\text{LEF,req}}$, is:\n    $$P_{\\text{LEF,req}} = \\frac{D_{\\text{NADPH}}}{\\phi_{\\text{NADPH, LEF}}} = \\frac{2 \\cdot r_{\\mathrm{CO2}}}{0.25} = 8 \\cdot r_{\\mathrm{CO2}}$$\n*   The actual number of photons allocated to LEF, $P_{\\text{LEF}}$, is limited by the total available photon supply, $P$.\n    $$P_{\\text{LEF}} = \\min(P, P_{\\text{LEF,req}})$$\n*   The resulting NADPH production, $R_{\\text{NADPH}}$, and co-production of ATP from LEF, $R_{\\text{ATP,LEF}}$, are:\n    $$R_{\\text{NADPH}} = P_{\\text{LEF}} \\cdot \\phi_{\\text{NADPH, LEF}} = 0.25 \\cdot P_{\\text{LEF}}$$\n    $$R_{\\text{ATP,LEF}} = P_{\\text{LEF}} \\cdot \\phi_{\\text{ATP, LEF}} = 0.375 \\cdot P_{\\text{LEF}}$$\n\n**Step 3: Allocation of Remaining Photons to Cyclic Electron Flow**\nIf photons remain after the LEF allocation and there is still an outstanding ATP deficit, these photons are directed to CEF.\n*   The number of remaining photons, $P_{\\text{rem}}$, is:\n    $$P_{\\text{rem}} = P - P_{\\text{LEF}}$$\n*   The remaining ATP demand, $D_{\\text{ATP,rem}}$, after accounting for the ATP produced by LEF, is:\n    $$D_{\\text{ATP,rem}} = \\max(0, D_{\\text{ATP}} - R_{\\text{ATP,LEF}})$$\n*   CEF is engaged only if both $P_{\\text{rem}} > 0$ and $D_{\\text{ATP,rem}} > 0$. The photons required for CEF to meet this remaining ATP demand, $P_{\\text{CEF,req}}$, would be:\n    $$P_{\\text{CEF,req}} = \\frac{D_{\\text{ATP,rem}}}{\\phi_{\\text{ATP, CEF}}} = \\frac{D_{\\text{ATP,rem}}}{0.5} = 2 \\cdot D_{\\text{ATP,rem}}$$\n*   The actual photons allocated to CEF, $P_{\\text{CEF}}$, are limited by the remaining supply.\n    $$P_{\\text{CEF}} = \\min(P_{\\text{rem}}, P_{\\text{CEF,req}})$$\n\n**Step 4: Final Output Calculation**\nThe final production rates are the sum of contributions from both pathways. The `cyclic` indicator is determined by whether CEF was active.\n*   The ATP produced by CEF, $R_{\\text{ATP,CEF}}$, is:\n    $$R_{\\text{ATP,CEF}} = P_{\\text{CEF}} \\cdot \\phi_{\\text{ATP, CEF}} = 0.5 \\cdot P_{\\text{CEF}}$$\n*   The total achieved ATP production rate, $R_{\\text{ATP}}$, is:\n    $$R_{\\text{ATP}} = R_{\\text{ATP,LEF}} + R_{\\text{ATP,CEF}}$$\n*   The total NADPH rate, $R_{\\text{NADPH}}$, is simply the amount produced by LEF.\n*   The binary indicator for cyclic flow, `cyclic`, is true if and only if a non-zero quantity of photons was allocated to CEF:\n    $$\\text{cyclic} = (P_{\\text{CEF}} > 0)$$\n\nThese derived expressions form a complete algorithm for computing the required outputs from the given inputs.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes achievable ATP and NADPH production rates for cyanobacterial\n    photometabolism based on a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (P, r_CO2, A_extra)\n        (1000, 50, 0),\n        (500, 50, 40),\n        (300, 50, 0),\n        (180, 20, 10),\n        (240, 30, 20),\n        (200, 0, 50),\n    ]\n\n    # These stoichiometric yields are derived from the problem statement.\n    # Yields are in units of (molecules/photon).\n    # Linear Electron Flow (LEF)\n    # 1 NADPH / 4 photons\n    phi_nadph_lef = 0.25\n    # (6 H+ / 1 NADPH) * (1 ATP / 4 H+) / (4 photons / 1 NADPH) = 1.5 / 4 ATP/photon\n    phi_atp_lef = 0.375\n    \n    # Cyclic Electron Flow (CEF)\n    # (4 H+ / 2 photons) * (1 ATP / 4 H+) = 1 / 2 ATP/photon\n    phi_atp_cef = 0.5\n\n    results_data = []\n    for case in test_cases:\n        P, r_co2, a_extra = case\n\n        # Step 1: Calculate total metabolic demands for ATP and NADPH.\n        # Demand is in molecules/sec/cell.\n        demand_nadph = 2 * r_co2\n        demand_atp = 3 * r_co2 + a_extra\n\n        # Step 2: Allocate photons to LEF to meet NADPH demand (Priority 1).\n        # Since phi_nadph_lef is 0.25, photons required is demand / 0.25 = 4 * demand.\n        photons_for_lef_demand = demand_nadph / phi_nadph_lef\n        # Actual allocation is limited by total available photons.\n        photons_for_lef_actual = min(P, photons_for_lef_demand)\n\n        # Step 3: Calculate production from the LEF allocation.\n        prod_nadph = photons_for_lef_actual * phi_nadph_lef\n        prod_atp_from_lef = photons_for_lef_actual * phi_atp_lef\n\n        # Step 4: Determine if CEF is needed and possible.\n        photons_remaining = P - photons_for_lef_actual\n        demand_atp_remaining = max(0, demand_atp - prod_atp_from_lef)\n        \n        photons_for_cef_actual = 0.0\n        # CEF is engaged only if there are remaining photons AND a remaining ATP deficit.\n        if photons_remaining > 0 and demand_atp_remaining > 0:\n            # Calculate photons needed for CEF to meet the remaining ATP demand.\n            photons_for_cef_demand = demand_atp_remaining / phi_atp_cef\n            # Actual allocation is limited by the remaining photons.\n            photons_for_cef_actual = min(photons_remaining, photons_for_cef_demand)\n\n        # Step 5: Calculate final production rates and the cyclic flow indicator.\n        prod_atp_from_cef = photons_for_cef_actual * phi_atp_cef\n        total_prod_atp = prod_atp_from_lef + prod_atp_from_cef\n        total_prod_nadph = prod_nadph\n        is_cyclic = (photons_for_cef_actual > 0)\n        \n        # Append the calculated results for this case.\n        # Numbers are not rounded yet; rounding is for final formatting.\n        results_data.append([total_prod_atp, total_prod_nadph, is_cyclic])\n\n    # Format the final output string according to the problem specification.\n    # Each result [ATP, NADPH, cyclic] needs specific formatting.\n    # Rates must be rounded to exactly three decimal places.\n    # The boolean must be a language-native literal (True/False).\n    formatted_results = []\n    for res in results_data:\n        atp, nadph, cyclic = res\n        # f-string formats the numbers and directly inserts the boolean's string representation.\n        formatted_results.append(f\"[{atp:.3f}, {nadph:.3f}, {str(cyclic).lower()}]\")\n\n    # Final print statement must produce a single line in the required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2521591"}]}