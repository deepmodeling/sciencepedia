{"hands_on_practices": [{"introduction": "A primary challenge in microbial ecology is to distill the immense complexity of a community into meaningful quantitative metrics. This exercise guides you through the calculation of two fundamental diversity measures: the Shannon index, which quantifies the uncertainty in community composition, and the corresponding effective number of species. By applying these concepts to a hypothetical gut microbiome, you will practice linking these abstract indices to the vital ecological principle of functional redundancy, developing a deeper intuition for how community structure relates to ecosystem stability. [@problem_id:2538719]", "problem": "A healthy adult stool sample is profiled by 16S ribosomal ribonucleic acid amplicon sequencing, and the relative abundances across eight metabolically distinct gut bacterial guilds are estimated as the vector $\\big(0.35,\\,0.08,\\,0.12,\\,0.10,\\,0.07,\\,0.06,\\,0.04,\\,0.18\\big)$, representing the following groups in order: Bacteroides-like carbohydrate generalists, Prevotella-like saccharolytics, Faecalibacterium-like butyrate producers, Ruminococcus-like fiber degraders, Roseburia-like butyrate producers, Blautia-like butyrate producers, Akkermansia-like mucin degraders, and a pooled rare guild. Assume that these eight categories exhaustively partition the community and that the natural logarithm is used for entropy.\n\nUsing only foundational definitions from information theory and diversity theory, compute the Shannon diversity index of this community and the corresponding effective number of species (the Hill number of order $1$). Then, briefly interpret how the two values jointly inform expectations about functional redundancy of short-chain fatty acid production versus mucin degradation across this normal human gut microbiota.\n\nExpress both requested quantities as dimensionless numbers. Round your numerical answers to four significant figures. Your final reported answer should be the ordered pair of the two numbers in the order specified above.", "solution": "The supplied problem will first be subjected to rigorous validation.\n\nStep 1: Extract Givens.\nThe problem provides the following information:\n- A vector of relative abundances for $S=8$ distinct gut bacterial guilds: $\\vec{p} = \\big(0.35,\\,0.08,\\,0.12,\\,0.10,\\,0.07,\\,0.06,\\,0.04,\\,0.18\\big)$.\n- The guilds are identified as: $1$. Bacteroides-like carbohydrate generalists, $2$. Prevotella-like saccharolytics, $3$. Faecalibacterium-like butyrate producers, $4$. Ruminococcus-like fiber degraders, $5$. Roseburia-like butyrate producers, $6$. Blautia-like butyrate producers, $7$. Akkermansia-like mucin degraders, and $8$. a pooled rare guild.\n- An assumption is made that these $8$ categories exhaustively partition the community.\n- A specification is given that the natural logarithm, $\\ln$, is to be used for entropy calculations.\n- The task is to compute two quantities: the Shannon diversity index ($H$) and the corresponding effective number of species (Hill number of order $1$, denoted $^1D$).\n- A final task is to interpret how these values relate to functional redundancy for short-chain fatty acid (SCFA) production versus mucin degradation.\n- Final numerical answers are to be rounded to four significant figures and presented as an ordered pair.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is assessed for validity.\n- The problem is scientifically grounded. It utilizes standard concepts from microbial ecology (16S rRNA profiling, bacterial guilds, functional redundancy) and information theory (Shannon diversity, Hill numbers). The data and biological context are realistic.\n- The problem is well-posed. The input data is a vector of relative abundances, and the desired outputs are well-defined mathematical functions of this vector.\n- The problem is self-contained and consistent. An essential check is that the relative abundances sum to unity, confirming the \"exhaustive partition\" claim. The sum is $0.35 + 0.08 + 0.12 + 0.10 + 0.07 + 0.06 + 0.04 + 0.18 = 1.00$. This condition is satisfied. The problem is free of contradictions.\n- The problem uses precise, objective language and requires no subjective interpretation to compute the primary quantities.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be furnished.\n\nThe first quantity to be computed is the Shannon diversity index, $H$. This index measures the uncertainty (entropy) in predicting the identity of an individual randomly selected from the community. Its definition, using the natural logarithm as specified, is:\n$$H = - \\sum_{i=1}^{S} p_i \\ln(p_i)$$\nwhere $S$ is the number of guilds (richness) and $p_i$ is the relative abundance of the $i$-th guild. Here, $S=8$ and the values of $p_i$ are given by the vector $\\vec{p}$.\n\nSubstituting the given abundances:\n$$H = - \\big[ 0.35 \\ln(0.35) + 0.08 \\ln(0.08) + 0.12 \\ln(0.12) + 0.10 \\ln(0.10) + 0.07 \\ln(0.07) + 0.06 \\ln(0.06) + 0.04 \\ln(0.04) + 0.18 \\ln(0.18) \\big]$$\nThe individual terms are calculated:\n$0.35 \\ln(0.35) \\approx -0.367437$\n$0.08 \\ln(0.08) \\approx -0.202058$\n$0.12 \\ln(0.12) \\approx -0.254431$\n$0.10 \\ln(0.10) \\approx -0.230259$\n$0.07 \\ln(0.07) \\approx -0.186148$\n$0.06 \\ln(0.06) \\approx -0.168805$\n$0.04 \\ln(0.04) \\approx -0.128755$\n$0.18 \\ln(0.18) \\approx -0.308664$\n\nThe sum of these terms is approximately $-1.846557$. Therefore, the Shannon index is:\n$$H = -(-1.846557) \\approx 1.846557$$\nRounding to four significant figures, $H \\approx 1.847$.\n\nThe second quantity is the effective number of species, which corresponds to the Hill number of order $q=1$, denoted $^1D$. The general formula for Hill numbers is $^qD = \\left( \\sum_{i=1}^{S} p_i^q \\right)^{\\frac{1}{1-q}}$. For the special case of $q=1$, the Hill number is defined as the limit as $q \\to 1$, which is the exponential of the Shannon index:\n$$^1D = \\exp(H)$$\nThis quantity, also known as \"true diversity\", converts the Shannon index back to an intuitive unit of an \"equivalent number of equally abundant species\". Using the unrounded value of $H$ for precision:\n$$^1D = \\exp(1.846557) \\approx 6.33758$$\nRounding to four significant figures, $^1D \\approx 6.338$.\n\nFinally, the interpretation of these values in the context of functional redundancy is required. The Shannon index $H \\approx 1.847$ and corresponding effective number of species $^1D \\approx 6.338$ indicate a relatively high diversity. The community consists of $S=8$ guilds but is as diverse as a community with approximately $6.34$ equally abundant guilds. This implies moderate evenness.\n\nTo assess functional redundancy, we map key functions to the guilds:\n1.  **SCFA production**: This function is distributed across multiple guilds. Specifically, butyrate, a key SCFA, is produced by *Faecalibacterium*-like ($p_3=0.12$), *Roseburia*-like ($p_5=0.07$), and *Blautia*-like ($p_6=0.06$) guilds. The total relative abundance dedicated to this function is substantial, at $0.12 + 0.07 + 0.06 = 0.25$. The distribution of this single function across three distinct guilds implies high functional redundancy. The loss of one of these guilds could be compensated for by the others, preserving the overall functional capacity.\n2.  **Mucin degradation**: This function is explicitly assigned to a single guild, *Akkermansia*-like mucin degraders, which is present at a low relative abundance of $p_7=0.04$. The concentration of this critical function into a single, low-abundance guild implies low functional redundancy. A decline in this specific population would likely lead to a direct and significant impairment of mucin degradation, as no other guild is listed as a primary performer of this role.\n\nIn conclusion, although the overall community diversity is high ($^1D/S = 6.338/8 \\approx 0.79$), the functional organization is not uniform. The system exhibits high redundancy for SCFA production but is fragile with respect to mucin degradation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.847  6.338\n\\end{pmatrix}\n}\n$$", "id": "2538719"}, {"introduction": "Comparing microbial communities is as important as characterizing them individually, but the conclusions drawn depend heavily on the chosen metric. This practice explores the critical distinction between taxonomic (Bray-Curtis) and phylogenetic (weighted UniFrac) beta diversity measures through a set of carefully designed scenarios. By analyzing how each metric responds to different types of community shifts, you will gain a crucial understanding of their respective sensitivities and biases, a skill essential for rigorously interpreting microbiome data. [@problem_id:2538705]", "problem": "A research team investigates diet-induced changes in the normal human gut microbiota using amplicon sequencing of the 16S ribosomal ribonucleic acid (rRNA) gene to derive Amplicon Sequence Variants (ASVs). They compute taxonomic beta diversity with Bray–Curtis dissimilarity and phylogenetic beta diversity with weighted UniFrac distance. Assume both metrics are computed on relative abundances (each sample’s ASV abundances sum to $1$) and that the phylogenetic tree is ultrametric and strictly bifurcating. Consider a simplified community with two major clades: a Bacteroidota clade with three closely related ASVs (denoted $B_1$, $B_2$, $B_3$) and a Firmicutes clade with one ASV (denoted $F_1$). The phylogeny has a deep split between Bacteroidota and Firmicutes. Within the Bacteroidota clade, $B_1$, $B_2$, and $B_3$ are separated by short internal and terminal branches relative to the deep split. Let the deep split have total branch length on each side of approximately $0.8$, while internal branches within the Bacteroidota clade have lengths on the order of $0.05$ to $0.1$.\n\nBaseline community $S_0$ has the following relative abundances: $B_1 = 0.15$, $B_2 = 0.15$, $B_3 = 0.20$, $F_1 = 0.50$.\n\nTwo distinct diets are introduced:\n\n- Scenario $S_1$ (fiber-enriched diet, within-clade reconfiguration): $B_1 = 0.05$, $B_2 = 0.05$, $B_3 = 0.40$, $F_1 = 0.50$. This keeps the total Bacteroidota proportion at $0.50$ but redistributes abundances among $B_1$, $B_2$, and $B_3$.\n\n- Scenario $S_2$ (high-fat diet, cross-clade shift): $B_1 = 0.10$, $B_2 = 0.10$, $B_3 = 0.10$, $F_1 = 0.70$. This increases the Firmicutes proportion at the expense of Bacteroidota.\n\nAssume all other ASVs are absent or negligible. The team asks how the sensitivity of Bray–Curtis versus weighted UniFrac differs across these scenarios, where “sensitivity” means the magnitude of the beta-diversity distance between $S_0$ and the post-diet community.\n\nWhich of the following statements are correct?\n\nA. For Scenario $S_1$, Bray–Curtis dissimilarity between $S_0$ and $S_1$ exceeds weighted UniFrac because the turnover occurs within a shallow, tightly related Bacteroidota clade, leaving deep branches shared, so phylogenetic dissimilarity remains relatively small.\n\nB. For Scenario $S_2$, weighted UniFrac between $S_0$ and $S_2$ exceeds Bray–Curtis (for equal-magnitude abundance shifts) because abundance is reallocated across a deep clade boundary, emphasizing long branch-length differences.\n\nC. If a diet changes only total microbial biomass but preserves the within-sample relative-abundance vector (e.g., all counts double while proportions remain identical), both Bray–Curtis and weighted UniFrac will increase.\n\nD. Because both Bray–Curtis and weighted UniFrac are abundance-weighted, they are equally sensitive to any composition change in relative-abundance space, regardless of phylogeny.\n\nE. On a star phylogeny with equal branch lengths (all ASVs attached directly to the root with the same edge length) and using relative abundances, weighted UniFrac becomes a constant multiple of Bray–Curtis, implying identical sensitivity ordering across samples in that special case.\n\nSelect all that apply.", "solution": "We proceed from first principles in community ecology and phylogenetics.\n\nFoundational definitions:\n- Beta diversity quantifies pairwise dissimilarity between communities as a function of their compositions. For communities represented as vectors of nonnegative abundances, distances are computed on either taxon space (taxonomic beta diversity) or on a phylogenetic tree (phylogenetic beta diversity).\n- Bray–Curtis dissimilarity is a taxon-based, abundance-weighted dissimilarity. For two relative-abundance vectors $\\mathbf{p} = (p_i)$ and $\\mathbf{q} = (q_i)$ over the same ASVs with $\\sum_i p_i = \\sum_i q_i = 1$, the Bray–Curtis dissimilarity is\n$$\n\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) \\;=\\; \\frac{\\sum_i |p_i - q_i|}{\\sum_i (p_i + q_i)} \\;=\\; \\frac{1}{2}\\sum_i |p_i - q_i| \\;,\n$$\nsince $\\sum_i (p_i + q_i) = 2$.\n- Weighted UniFrac is a phylogeny-based, abundance-weighted dissimilarity. Let $\\mathcal{E}$ denote the set of edges in the phylogenetic tree, with branch length $L_e$ for edge $e \\in \\mathcal{E}$. Let $P_e(\\mathbf{p})$ be the fraction of the community’s total relative abundance that descends from edge $e$. The weighted UniFrac distance is\n$$\n\\mathrm{wUF}(\\mathbf{p},\\mathbf{q}) \\;=\\; \\sum_{e \\in \\mathcal{E}} L_e \\,\\big| P_e(\\mathbf{p}) - P_e(\\mathbf{q}) \\big| \\;.\n$$\nThis definition places larger weight on differences that occur along deeper or longer branches.\n\nWe now analyze each scenario and option.\n\nPart 1: Compute or compare $\\mathrm{BC}$ for $S_0$ versus $S_1$ and $S_0$ versus $S_2$.\n\nFor $S_0 \\to S_1$, the absolute differences by ASV are:\n- $|B_1: 0.15 - 0.05| = 0.10$\n- $|B_2: 0.15 - 0.05| = 0.10$\n- $|B_3: 0.20 - 0.40| = 0.20$\n- $|F_1: 0.50 - 0.50| = 0$\nSum of absolute differences is $0.40$. Therefore,\n$$\n\\mathrm{BC}(S_0,S_1) = \\frac{1}{2} \\times 0.40 = 0.20 \\;.\n$$\n\nFor $S_0 \\to S_2$, the absolute differences by ASV are:\n- $|B_1: 0.15 - 0.10| = 0.05$\n- $|B_2: 0.15 - 0.10| = 0.05$\n- $|B_3: 0.20 - 0.10| = 0.10$\n- $|F_1: 0.50 - 0.70| = 0.20$\nSum again is $0.40$, so\n$$\n\\mathrm{BC}(S_0,S_2) = \\frac{1}{2} \\times 0.40 = 0.20 \\;.\n$$\nThus, for these particular redistributions of equal $L^1$ magnitude in taxon space, Bray–Curtis yields the same value in both scenarios.\n\nPart 2: Compare $\\mathrm{wUF}$ qualitatively using the tree.\n\nKey principle for weighted UniFrac: Edges that define deep splits (large $L_e$) contribute strongly if the cumulative abundance descending those edges changes between samples. Shallow, within-clade shuffles alter $P_e$ primarily on short internal or terminal edges (small $L_e$), generating smaller contributions.\n\n- Scenario $S_1$ is a within-Bacteroidota reconfiguration that keeps the total Bacteroidota abundance at $0.50$ in both $S_0$ and $S_1$. Along the deep edges that partition Bacteroidota versus Firmicutes, $P_e(S_0)$ and $P_e(S_1)$ are identical (approximately $0.50$ versus $0.50$ for the Bacteroidota side and $0.50$ versus $0.50$ for the Firmicutes side). Therefore, the terms $L_e |P_e(S_0) - P_e(S_1)|$ on deep edges are $0$, and only shallow edges within the Bacteroidota subtree contribute. Because those $L_e$ are small (order $0.05$ to $0.1$), the overall $\\mathrm{wUF}(S_0,S_1)$ will be relatively small compared to the $\\mathrm{BC}(S_0,S_1) = 0.20$.\n\n- Scenario $S_2$ shifts $0.20$ of relative abundance from Bacteroidota to Firmicutes. On the deep Bacteroidota-versus-Firmicutes edges (with $L_e \\approx 0.8$ on each side), $|P_e(S_0) - P_e(S_2)|$ is substantial (approximately $0.20$ change on the Firmicutes side and $0.20$ on the Bacteroidota side, depending on edge orientation), each scaled by a large $L_e$. Consequently, deep edges contribute large terms to $\\mathrm{wUF}$. Although $\\mathrm{BC}(S_0,S_2) = 0.20$ (same as $S_1$), $\\mathrm{wUF}(S_0,S_2)$ will exceed $\\mathrm{wUF}(S_0,S_1)$ and typically exceed $\\mathrm{BC}(S_0,S_2)$ for equal-magnitude redistributions because the deep branch lengths amplify cross-clade shifts.\n\nWith these principles, evaluate each option:\n\nOption A: “For Scenario $S_1$, Bray–Curtis exceeds weighted UniFrac because turnover is within a shallow clade; deep branches are shared.” This aligns with the analysis. In $S_1$, deep-edge contributions to $\\mathrm{wUF}$ are $0$; only small $L_e$ edges within Bacteroidota contribute, giving a small $\\mathrm{wUF}$, while $\\mathrm{BC} = 0.20$. Verdict: Correct.\n\nOption B: “For Scenario $S_2$, weighted UniFrac exceeds Bray–Curtis (for equal-magnitude abundance shifts) due to cross-clade reallocations emphasizing long branches.” This matches the deep-edge amplification in $\\mathrm{wUF}$; for this $S_2$, deep edges dominate and produce a larger phylogenetic distance than the taxon-only distance of $0.20$. Verdict: Correct.\n\nOption C: “Changing only biomass while preserving the relative-abundance vector increases both metrics.” By definition, both metrics here are computed on relative abundances normalized to sum to $1$. If only total biomass changes and proportions remain identical, then $\\mathbf{p} = \\mathbf{q}$, implying $\\sum_i |p_i - q_i| = 0$ and $P_e(\\mathbf{p}) = P_e(\\mathbf{q})$ for all $e$, hence $\\mathrm{BC} = 0$ and $\\mathrm{wUF} = 0$. Verdict: Incorrect.\n\nOption D: “They are equally sensitive to any change because both are abundance-weighted.” Weighting by abundance alone does not guarantee equal sensitivity; weighted UniFrac also weights differences by branch length $L_e$ and aggregates at the level of edges, not just leaves, thus emphasizing cross-clade shifts and de-emphasizing within-clade reshuffling. As shown, $S_1$ and $S_2$ have identical $\\mathrm{BC}$ but different $\\mathrm{wUF}$, and $\\mathrm{wUF}$ can be smaller than or greater than $\\mathrm{BC}$ depending on phylogenetic depth of change. Verdict: Incorrect.\n\nOption E: “On a star phylogeny with equal branch lengths and relative abundances, weighted UniFrac becomes a constant multiple of Bray–Curtis, implying identical sensitivity ordering.” On a star tree where each ASV is attached directly to the root with identical length $L$, each edge corresponds to a single ASV and $P_e(\\mathbf{p}) = p_i$. Then\n$$\n\\mathrm{wUF}(\\mathbf{p},\\mathbf{q}) \\;=\\; \\sum_i L\\,|p_i - q_i| \\;=\\; L \\sum_i |p_i - q_i| \\;.\n$$\nMeanwhile,\n$$\n\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) \\;=\\; \\tfrac{1}{2}\\sum_i |p_i - q_i| \\;.\n$$\nThus $\\mathrm{wUF} = (2L)\\,\\mathrm{BC}$, a constant multiple independent of $\\mathbf{p}$ and $\\mathbf{q}$. Any constant multiple preserves ordering and sensitivity ranking. Verdict: Correct.\n\nSummary: Options A, B, and E are correct; C and D are incorrect.", "answer": "$$\\boxed{ABE}$$", "id": "2538705"}, {"introduction": "To truly understand the normal human microbiota, we must move beyond static snapshots to model its dynamic behavior. This hands-on practice challenges you to construct and simulate a mathematical model of a crucial metabolic interaction: the cross-feeding of lactate between two key gut commensals. By implementing a system of ordinary differential equations based on fundamental kinetic principles, you will gain practical experience in computational systems biology and explore how inter-species dependencies contribute to the stability of the gut ecosystem. [@problem_id:2538739]", "problem": "Consider a minimal, mass-balanced cross-feeding model of two anaerobic gut commensals within the normal human microbiota: a Bifidobacterium population (producer) that converts available carbohydrate to lactate, and Eubacterium hallii (also classified as Anaerobutyricum hallii; consumer) that converts lactate to butyrate. Assume a well-mixed, constant-volume lumen segment with negligible spatial gradients. The goal is to mathematically analyze stability of lactate with respect to accumulation under different parameter regimes by simulating the system of ordinary differential equations and deciding whether lactate remains below a specified threshold. All concentrations must be expressed in millimolar (mM), all biomass densities in grams per liter (g/L), and time in hours (h). The final decision for each test case must be reported as a Boolean on whether the lactate concentration at the final simulation time is below the specified threshold in mM. The final output must be a single line containing a Python list literal with these Booleans, with no additional text.\n\nFundamental base. Use the following well-tested biological and physical principles:\n- Mass conservation at the compartment scale for each state variable.\n- Saturable growth kinetics on limiting substrate (Monod law), logistic constraints for carrying capacity, and first-order death.\n- First-order removal (washout/absorption) for small metabolites.\n\nModel states and units:\n- $X_B$ (g/L): Bifidobacterium biomass density.\n- $X_H$ (g/L): Eubacterium hallii biomass density.\n- $L$ (mM): lactate concentration.\n- $B_u$ (mM): butyrate concentration.\n\nParameters and units:\n- $\\mu_B$ ($\\mathrm{h}^{-1}$): maximum specific growth rate of Bifidobacterium under carbohydrate excess.\n- $\\mu_H$ ($\\mathrm{h}^{-1}$): maximum specific growth rate of Eubacterium hallii on lactate.\n- $K_B$ (g/L): carrying capacity for Bifidobacterium.\n- $K_H$ (g/L): carrying capacity for Eubacterium hallii.\n- $K_L$ (mM): Monod half-saturation constant for lactate uptake/growth by Eubacterium hallii.\n- $d_B$ ($\\mathrm{h}^{-1}$), $d_H$ ($\\mathrm{h}^{-1}$): first-order death rates for Bifidobacterium and Eubacterium hallii, respectively.\n- $k_{\\mathrm{out}}$ ($\\mathrm{h}^{-1}$): first-order removal rate for dissolved metabolites (lactate and butyrate).\n- $y_{L|B}$ (mM/g): lactate produced per gram of Bifidobacterium biomass formed.\n- $Y_{X|L}$ (g/mM): Eubacterium hallii biomass formed per millimole of lactate consumed.\n- $y_{B_u|L}$ (mM/mM): butyrate produced per millimole of lactate consumed.\n- $T_{\\max}$ (h): simulation horizon.\n- $L_{\\mathrm{thr}}$ (mM): lactate threshold used to define stability.\n\nDynamics. Let $g_B$ (g/(L·h)) denote the instantaneous Bifidobacterium biomass formation rate and $g_H$ (g/(L·h)) the Eubacterium hallii biomass formation rate. Use logistic constraints on biomass growth and Monod dependence on lactate for Eubacterium hallii:\n- $g_B = \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B$,\n- $g_H = \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H$.\n\nLet lactate production by Bifidobacterium be proportional to its biomass formation ($y_{L|B} g_B$), and lactate consumption by Eubacterium hallii be proportional to its biomass formation with yield $Y_{X|L}$, so that lactate consumption rate is $\\dfrac{1}{Y_{X|L}} g_H$. Butyrate production is proportional to lactate consumption with yield $y_{B_u|L}$. Include first-order death for both populations and first-order removal for both metabolites. The resulting system is:\n$$\n\\begin{aligned}\n\\dfrac{dX_B}{dt} = g_B - d_B X_B, \\\\\n\\dfrac{dX_H}{dt} = g_H - d_H X_H, \\\\\n\\dfrac{dL}{dt} = y_{L|B} g_B - \\dfrac{1}{Y_{X|L}} g_H - k_{\\mathrm{out}} L, \\\\\n\\dfrac{dB_u}{dt} = y_{B_u|L} \\left(\\dfrac{1}{Y_{X|L}} g_H\\right) - k_{\\mathrm{out}} B_u.\n\\end{aligned}\n$$\n\nInitial conditions at $t = 0$:\n- $X_B(0) = X_{B,0}$ (g/L),\n- $X_H(0) = X_{H,0}$ (g/L),\n- $L(0) = L_0$ (mM),\n- $B_u(0) = B_{u,0}$ (mM).\n\nStability criterion to lactate accumulation. A test case is deemed stable if and only if the final-time lactate is below threshold:\n$$\n\\text{stable} \\iff L(T_{\\max}) \\le L_{\\mathrm{thr}}.\n$$\nReport the decision as a Boolean for each test case. No angles are involved. All rates are per hour, all concentrations in millimolar, and all biomasses in grams per liter.\n\nImplementation requirements:\n- Numerically integrate the system from $t = 0$ to $t = T_{\\max}$ using any suitable explicit method with adaptive step size (for example, Runge–Kutta of order $4$ or $5$). Ensure non-negativity in rate evaluations by using $\\max$ with $0$ for state variables used inside the rate laws.\n- Use the parameter sets given below without modification.\n- Express the final decisions as a Python list literal string on a single line, e.g., $[\\text{True},\\text{False},\\dots]$.\n\nFixed parameters common to all test cases unless otherwise specified:\n- $K_B = 2.0$ g/L,\n- $K_H = 1.5$ g/L,\n- $d_B = 0.05$ $\\mathrm{h}^{-1}$,\n- $d_H = 0.05$ $\\mathrm{h}^{-1}$,\n- $k_{\\mathrm{out}} = 0.05$ $\\mathrm{h}^{-1}$,\n- $Y_{X|L} = 0.05$ g/mM,\n- $y_{B_u|L} = 0.5$ mM/mM,\n- $T_{\\max} = 200.0$ h,\n- $L_{\\mathrm{thr}} = 10.0$ mM.\n\nTest suite. Simulate the four parameter sets below, each providing a self-consistent and biologically plausible regime. For each, produce a Boolean decision using the stability criterion above.\n\n- Case $1$ (baseline happy path; expected to be stable): $X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.05$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.50$ $\\mathrm{h}^{-1}$, $K_L = 1.0$ mM, $y_{L|B} = 20.0$ mM/g.\n- Case $2$ (no consumer; boundary case for accumulation): $X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.0$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.50$ $\\mathrm{h}^{-1}$, $K_L = 1.0$ mM, $y_{L|B} = 20.0$ mM/g.\n- Case $3$ (high consumer capacity; strong scavenging): $X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.10$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.80$ $\\mathrm{h}^{-1}$, $K_H = 3.0$ g/L, $K_L = 1.0$ mM, $y_{L|B} = 25.0$ mM/g.\n- Case $4$ (low lactate affinity; consumer struggles at low lactate): $X_{B,0} = 0.1$ g/L, $X_{H,0} = 0.05$ g/L, $L_0 = 1.0$ mM, $B_{u,0} = 0.0$ mM, $\\mu_B = 0.30$ $\\mathrm{h}^{-1}$, $\\mu_H = 0.50$ $\\mathrm{h}^{-1}$, $K_L = 50.0$ mM, $y_{L|B} = 20.0$ mM/g.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{True},\\text{False},\\text{True},\\text{False}]$), corresponding to Cases $1$ through $4$ in order.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n\nState Variables:\n- $X_B$ (g/L): Bifidobacterium biomass density.\n- $X_H$ (g/L): Eubacterium hallii biomass density.\n- $L$ (mM): lactate concentration.\n- $B_u$ (mM): butyrate concentration.\n\nParameters:\n- $\\mu_B$ ($\\mathrm{h}^{-1}$): max specific growth rate of Bifidobacterium.\n- $\\mu_H$ ($\\mathrm{h}^{-1}$): max specific growth rate of Eubacterium hallii.\n- $K_B$ (g/L): carrying capacity for Bifidobacterium.\n- $K_H$ (g/L): carrying capacity for Eubacterium hallii.\n- $K_L$ (mM): Monod constant for lactate uptake.\n- $d_B$ ($\\mathrm{h}^{-1}$), $d_H$ ($\\mathrm{h}^{-1}$): death rates.\n- $k_{\\mathrm{out}}$ ($\\mathrm{h}^{-1}$): metabolite removal rate.\n- $y_{L|B}$ (mM/g): lactate yield from Bifidobacterium biomass.\n- $Y_{X|L}$ (g/mM): Eubacterium hallii biomass yield on lactate.\n- $y_{B_u|L}$ (mM/mM): butyrate yield from lactate.\n- $T_{\\max}$ (h): simulation horizon.\n- $L_{\\mathrm{thr}}$ (mM): lactate threshold.\n\nDynamics:\nInstantaneous growth rates:\n- $g_B = \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B$\n- $g_H = \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H$\n\nSystem of Ordinary Differential Equations (ODEs):\n$$\n\\begin{aligned}\n\\dfrac{dX_B}{dt} = g_B - d_B X_B \\\\\n\\dfrac{dX_H}{dt} = g_H - d_H X_H \\\\\n\\dfrac{dL}{dt} = y_{L|B} g_B - \\dfrac{1}{Y_{X|L}} g_H - k_{\\mathrm{out}} L \\\\\n\\dfrac{dB_u}{dt} = y_{B_u|L} \\left(\\dfrac{1}{Y_{X|L}} g_H\\right) - k_{\\mathrm{out}} B_u\n\\end{aligned}\n$$\n\nInitial Conditions:\n$X_B(0) = X_{B,0}$, $X_H(0) = X_{H,0}$, $L(0) = L_0$, $B_u(0) = B_{u,0}$.\n\nStability Criterion:\n$\\text{stable} \\iff L(T_{\\max}) \\le L_{\\mathrm{thr}}$.\n\nFixed Parameters:\n$K_B = 2.0$ g/L, $K_H = 1.5$ g/L, $d_B = 0.05$ $\\mathrm{h}^{-1}$, $d_H = 0.05$ $\\mathrm{h}^{-1}$, $k_{\\mathrm{out}} = 0.05$ $\\mathrm{h}^{-1}$, $Y_{X|L} = 0.05$ g/mM, $y_{B_u|L} = 0.5$ mM/mM, $T_{\\max} = 200.0$ h, $L_{\\mathrm{thr}} = 10.0$ mM.\n\nTest Cases:\n- Case $1$: $X_{B,0} = 0.1$, $X_{H,0} = 0.05$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.50$, $K_L = 1.0$, $y_{L|B} = 20.0$.\n- Case $2$: $X_{B,0} = 0.1$, $X_{H,0} = 0.0$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.50$, $K_L = 1.0$, $y_{L|B} = 20.0$.\n- Case $3$: $X_{B,0} = 0.1$, $X_{H,0} = 0.10$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.80$, $K_H = 3.0$, $K_L = 1.0$, $y_{L|B} = 25.0$.\n- Case $4$: $X_{B,0} = 0.1$, $X_{H,0} = 0.05$, $L_0 = 1.0$, $B_{u,0} = 0.0$, $\\mu_B = 0.30$, $\\mu_H = 0.50$, $K_L = 50.0$, $y_{L|B} = 20.0$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is analyzed for validity:\n1.  **Scientifically Grounded**: The model is based on established principles of microbial population dynamics: logistic growth for resource-limited populations and Monod kinetics for substrate-limited growth. These are standard in mathematical ecology and systems biology. The model describes a plausible cross-feeding interaction within the gut microbiota. It is scientifically sound.\n2.  **Well-Posed**: The problem is an initial value problem (IVP) for a system of ordinary differential equations. The rate functions are continuous and locally Lipschitz, which guarantees the existence and uniqueness of a solution for a given set of initial conditions and parameters. The task is to find the state at a specific time $T_{\\max}$ and apply a clear decision criterion. The problem is well-posed.\n3.  **Objective**: The problem is stated in precise mathematical and quantitative terms. All parameters, variables, and criteria are defined objectively. There is no subjective language.\n4.  **Completeness and Consistency**: All necessary parameters and initial conditions are provided for each test case. The units are consistent. There are no contradictions.\n5.  **Feasibility**: The parameter values are within biologically plausible ranges for microbial metabolism and growth. The simulation is computationally feasible.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a well-defined, scientifically grounded, and solvable problem in computational systems biology. A solution will be provided.\n\n**Solution Methodology**\n\nThe problem requires the numerical integration of a system of four coupled, non-linear ordinary differential equations. This constitutes an initial value problem (IVP), which can be expressed in vector form as $\\dfrac{d\\mathbf{y}}{dt} = f(t, \\mathbf{y}, \\mathbf{p})$, where $\\mathbf{y}(t)$ is the state vector and $\\mathbf{p}$ is the parameter vector.\n\nThe state vector is defined as:\n$$\n\\mathbf{y}(t) = \\begin{bmatrix} X_B(t) \\\\ X_H(t) \\\\ L(t) \\\\ B_u(t) \\end{bmatrix}\n$$\n\nThe system of ODEs is given by:\n$$\n\\begin{aligned}\n\\dfrac{dX_B}{dt} = \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B - d_B X_B \\\\\n\\dfrac{dX_H}{dt} = \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H - d_H X_H \\\\\n\\dfrac{dL}{dt} = y_{L|B} \\left[ \\mu_B \\left(1 - \\dfrac{X_B}{K_B}\\right) X_B \\right] - \\dfrac{1}{Y_{X|L}} \\left[ \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H \\right] - k_{\\mathrm{out}} L \\\\\n\\dfrac{dB_u}{dt} = \\dfrac{y_{B_u|L}}{Y_{X|L}} \\left[ \\mu_H \\dfrac{L}{K_L + L} \\left(1 - \\dfrac{X_H}{K_H}\\right) X_H \\right] - k_{\\mathrm{out}} B_u\n\\end{aligned}\n$$\n\nTo solve this system, a numerical ODE solver is required. The `scipy.integrate.solve_ivp` function from the SciPy library is suitable for this task. It provides several integration methods, including an explicit Runge-Kutta method of order $5(4)$ (Dormand-Prince, `RK45`), which uses adaptive step sizing to control the local error. This method is robust and efficient for non-stiff problems like the one presented.\n\nThe implementation will proceed as follows:\n$1$. A Python function will be defined to represent the right-hand side of the ODE system, $f(t, \\mathbf{y}, \\mathbf{p})$. This function will take the current time $t$, the state vector $\\mathbf{y}$, and a collection of parameters $\\mathbf{p}$ as input, and return the vector of derivatives $\\dfrac{d\\mathbf{y}}{dt}$. As per the problem's requirement, non-negativity of state variables will be enforced within this function using $\\max(0, \\cdot)$ before they are used in rate calculations to prevent numerical artifacts.\n\n$2$. For each of the four test cases, the corresponding initial conditions $\\mathbf{y}(0) = [X_{B,0}, X_{H,0}, L_0, B_{u,0}]^T$ and parameter set will be assembled.\n\n$3$. `scipy.integrate.solve_ivp` will be called with the ODE function, the time interval $[0, T_{\\max}]$, the initial condition vector $\\mathbf{y}(0)$, the specified method (`RK45`), and the parameter set.\n\n$4$. Upon completion of the integration, the final state vector $\\mathbf{y}(T_{\\max})$ will be retrieved. The lactate concentration $L(T_{\\max})$ corresponds to the third element of this vector.\n\n$5$. The stability criterion $L(T_{\\max}) \\le L_{\\mathrm{thr}}$ will be evaluated. The result, a Boolean value (`True` for stable, `False` for unstable), will be stored for each case.\n\n$6$. Finally, the list of Boolean results for all four cases will be formatted into the specified string format: a Python list literal enclosed in square brackets.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the cross-feeding microbial dynamics problem for the given test cases.\n    \"\"\"\n\n    # Fixed parameters common to all test cases\n    fixed_params = {\n        'K_B': 2.0,      # g/L\n        'K_H': 1.5,      # g/L\n        'd_B': 0.05,     # h^-1\n        'd_H': 0.05,     # h^-1\n        'k_out': 0.05,   # h^-1\n        'Y_X|L': 0.05,   # g/mM\n        'y_Bu|L': 0.5,   # mM/mM\n        'T_max': 200.0,  # h\n        'L_thr': 10.0,   # mM\n    }\n\n    # Test suite: four parameter sets\n    test_cases = [\n        # Case 1: baseline happy path\n        {\n            'X_B0': 0.1, 'X_H0': 0.05, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.50, 'K_L': 1.0, 'y_L|B': 20.0\n        },\n        # Case 2: no consumer\n        {\n            'X_B0': 0.1, 'X_H0': 0.0, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.50, 'K_L': 1.0, 'y_L|B': 20.0\n        },\n        # Case 3: high consumer capacity\n        {\n            'X_B0': 0.1, 'X_H0': 0.10, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.80, 'K_H': 3.0, 'K_L': 1.0, 'y_L|B': 25.0\n        },\n        # Case 4: low lactate affinity\n        {\n            'X_B0': 0.1, 'X_H0': 0.05, 'L0': 1.0, 'Bu0': 0.0,\n            'mu_B': 0.30, 'mu_H': 0.50, 'K_L': 50.0, 'y_L|B': 20.0\n        },\n    ]\n\n    def ode_system(t, y, p):\n        \"\"\"\n        Defines the system of ordinary differential equations for the microbial model.\n        Args:\n            t (float): Time.\n            y (array-like): State vector [X_B, X_H, L, B_u].\n            p (dict): Dictionary of parameters.\n\n        Returns:\n            list: The vector of derivatives [dX_B/dt, dX_H/dt, dL/dt, dB_u/dt].\n        \"\"\"\n        X_B, X_H, L, B_u = y\n\n        # Enforce non-negativity for rate calculations as per problem specification\n        X_B_nn = max(0, X_B)\n        X_H_nn = max(0, X_H)\n        L_nn = max(0, L)\n\n        # Instantaneous biomass formation rates\n        g_B = p['mu_B'] * (1 - X_B_nn / p['K_B']) * X_B_nn\n        g_H = p['mu_H'] * (L_nn / (p['K_L'] + L_nn)) * (1 - X_H_nn / p['K_H']) * X_H_nn\n\n        # Differential equations\n        dX_B_dt = g_B - p['d_B'] * X_B\n        dX_H_dt = g_H - p['d_H'] * X_H\n        dL_dt = p['y_L|B'] * g_B - (1 / p['Y_X|L']) * g_H - p['k_out'] * L\n        dB_u_dt = p['y_Bu|L'] * (1 / p['Y_X|L']) * g_H - p['k_out'] * B_u\n        \n        return [dX_B_dt, dX_H_dt, dL_dt, dB_u_dt]\n\n    results = []\n    \n    for case_params in test_cases:\n        # Combine fixed and case-specific parameters\n        params = fixed_params.copy()\n        params.update(case_params)\n\n        # Initial conditions\n        y0 = [params['X_B0'], params['X_H0'], params['L0'], params['Bu0']]\n        \n        # Time span for integration\n        t_span = [0, params['T_max']]\n\n        # Numerically integrate the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=t_span,\n            y0=y0,\n            method='RK45',\n            args=(params,),\n            dense_output=True\n        )\n        \n        # Get the final lactate concentration\n        final_lactate_concentration = sol.y[2, -1]\n        \n        # Apply the stability criterion\n        is_stable = final_lactate_concentration = params['L_thr']\n        results.append(is_stable)\n\n    # Format the final output as a Python list literal string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2538739"}]}