{"hands_on_practices": [{"introduction": "The foundation of metabolic engineering rests upon the immutable laws of conservation. Before designing complex genetic circuits or optimizing enzyme kinetics, we must first ask: what is the absolute maximum amount of product that can be formed from a given substrate? This exercise [@problem_id:2506619] challenges you to apply the fundamental principles of atom and redox balancing to determine the maximum theoretical yield of a bioproduct. Mastering this skill is essential for evaluating the feasibility of proposed metabolic routes and setting a 'gold standard' for pathway efficiency.", "problem": "A bioprocess engineer is evaluating anaerobic production of $n$-butanol $\\left(\\mathrm{C_{4}H_{10}O}\\right)$ from glucose $\\left(\\mathrm{C_{6}H_{12}O_{6}}\\right)$ in an aqueous medium with no external electron acceptor and negligible biomass formation. Byproducts are restricted to carbon dioxide $\\left(\\mathrm{CO_{2}}\\right)$, water $\\left(\\mathrm{H_{2}O}\\right)$, and dihydrogen $\\left(\\mathrm{H_{2}}\\right)$. The system must obey conservation of atoms and total reducing equivalents (electrons). Treat dihydrogen as carrying $2$ reducing equivalents per mole, and treat water and carbon dioxide as having zero net reducing equivalents. All species are neutral, so charge balance is implicitly satisfied.\n\nYou are given $3$ candidate overall routes:\n- Route A: $\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 2\\,\\mathrm{CO_{2}} + \\mathrm{H_{2}O}$.\n- Route B: $\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + \\mathrm{CO_{2}} + 2\\,\\mathrm{H_{2}}$.\n- Route C: $\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 3\\,\\mathrm{CO} + 2\\,\\mathrm{H_{2}O}$.\n\nTasks:\n1. Using atom mapping, test each route for conservation of carbon, hydrogen, and oxygen atoms, and for conservation of total reducing equivalents. Eliminate routes that violate any conservation law.\n2. For the admissible byproduct set $\\left\\{\\mathrm{CO_{2}},\\mathrm{H_{2}O},\\mathrm{H_{2}}\\right\\}$, consider the general overall reaction\n$$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\nu_{b}\\,\\mathrm{C_{4}H_{10}O} + \\nu_{c}\\,\\mathrm{CO_{2}} + \\nu_{h}\\,\\mathrm{H_{2}O} + \\nu_{H_{2}}\\,\\mathrm{H_{2}},$$\nwith unknown nonnegative stoichiometric coefficients $\\nu_{b}, \\nu_{c}, \\nu_{h}, \\nu_{H_{2}} \\ge 0$. Derive elemental balances for carbon, hydrogen, and oxygen, and an overall redox balance based on conservation of reducing equivalents. Using these constraints, determine the maximum possible molar yield $\\nu_{b}^{\\max}$ of $n$-butanol (in mol per mol glucose).\n3. Compute the corresponding maximum mass yield $Y_{P/S}^{\\max}$ in grams of $n$-butanol per gram of glucose using the atomic weights $M(\\mathrm{C})=12.01$, $M(\\mathrm{H})=1.008$, $M(\\mathrm{O})=16.00$ (units: grams per mole). Express your final numerical answer as grams of $n$-butanol per gram of glucose, rounded to $4$ significant figures.\n\nYour final reported answer must be the single value of $Y_{P/S}^{\\max}$ as specified in task $3$.", "solution": "The solution is structured into three parts as per the problem tasks.\n\nFirst, the three candidate reaction routes are validated by examining the conservation of atoms (Carbon, Hydrogen, Oxygen) and reducing equivalents. The degree of reduction, $\\gamma$, for a molecule $\\mathrm{C}_{a}\\mathrm{H}_{b}\\mathrm{O}_{c}\\mathrm{N}_{d}$ is given by $\\gamma = 4a + b - 2c - 3d$. For the species in this problem, all are uncharged and contain no nitrogen. The total number of available electrons, which we term reducing equivalents (RE), for one mole of a substance is its degree of reduction.\nFor the substrate, glucose ($\\mathrm{C_{6}H_{12}O_{6}}$): $\\gamma_{\\text{glucose}} = 4(6) + 12 - 2(6) = 24$.\nFor the product, $n$-butanol ($\\mathrm{C_{4}H_{10}O}$): $\\gamma_{\\text{butanol}} = 4(4) + 10 - 2(1) = 24$.\nThe problem defines the RE for the byproducts:\n$\\mathrm{CO_{2}}$: $\\gamma_{\\mathrm{CO_{2}}} = 0$.\n$\\mathrm{H_{2}O}$: $\\gamma_{\\mathrm{H_{2}O}} = 0$.\n$\\mathrm{H_{2}}$: $\\gamma_{\\mathrm{H_{2}}} = 2$.\n\nRoute A: $\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 2\\,\\mathrm{CO_{2}} + \\mathrm{H_{2}O}$\n- Carbon (C) balance: $6 \\rightarrow 4 + 2(1) = 6$. Satisfied.\n- Hydrogen (H) balance: $12 \\rightarrow 10 + 2(1) = 12$. Satisfied.\n- Oxygen (O) balance: $6 \\rightarrow 1 + 2(2) + 1 = 6$. Satisfied.\n- Reducing Equivalent (RE) balance: $24 \\rightarrow 1(24) + 2(0) + 1(0) = 24$. Satisfied.\nConclusion: Route A is valid.\n\nRoute B: $\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + \\mathrm{CO_{2}} + 2\\,\\mathrm{H_{2}}$\n- Carbon (C) balance: $6 \\rightarrow 4 + 1 = 5$. Violated.\nConclusion: Route B is invalid.\n\nRoute C: $\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 3\\,\\mathrm{CO} + 2\\,\\mathrm{H_{2}O}$\n- Carbon (C) balance: $6 \\rightarrow 4 + 3(1) = 7$. Violated.\nConclusion: Route C is invalid.\n\nSecond, the maximum possible molar yield of $n$-butanol, $\\nu_{b}^{\\max}$, is determined. The general stoichiometric equation is:\n$$1\\,\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\nu_{b}\\,\\mathrm{C_{4}H_{10}O} + \\nu_{c}\\,\\mathrm{CO_{2}} + \\nu_{h}\\,\\mathrm{H_{2}O} + \\nu_{H_{2}}\\,\\mathrm{H_{2}}$$\nThe system of linear equations from the atom balances, based on $1$ mole of glucose consumed:\n- C balance: $6 = 4\\nu_{b} + \\nu_{c}$  (1)\n- H balance: $12 = 10\\nu_{b} + 2\\nu_{h} + 2\\nu_{H_{2}}$  (2)\n- O balance: $6 = \\nu_{b} + 2\\nu_{c} + \\nu_{h}$  (3)\n\nThe stoichiometric coefficients are constrained to be non-negative: $\\nu_{b} \\ge 0$, $\\nu_{c} \\ge 0$, $\\nu_{h} \\ge 0$, $\\nu_{H_{2}} \\ge 0$. We express the byproduct coefficients as functions of the product yield $\\nu_{b}$.\nFrom (1): $\\nu_{c} = 6 - 4\\nu_{b}$\nSubstitute into (3): $6 = \\nu_{b} + 2(6 - 4\\nu_{b}) + \\nu_{h} \\implies 6 = \\nu_{b} + 12 - 8\\nu_{b} + \\nu_{h} \\implies \\nu_{h} = 7\\nu_{b} - 6$.\nSubstitute $\\nu_{h}$ into the simplified H balance equation (from (2), dividing by 2): $6 = 5\\nu_{b} + \\nu_{h} + \\nu_{H_{2}}$.\n$6 = 5\\nu_{b} + (7\\nu_{b} - 6) + \\nu_{H_{2}} \\implies \\nu_{H_{2}} = 12 - 12\\nu_{b}$.\n\nNow apply the non-negativity constraints:\n1. $\\nu_{b} \\ge 0$ (given)\n2. $\\nu_{c} = 6 - 4\\nu_{b} \\ge 0 \\implies \\nu_{b} \\le 1.5$\n3. $\\nu_{h} = 7\\nu_{b} - 6 \\ge 0 \\implies \\nu_{b} \\ge 6/7$\n4. $\\nu_{H_{2}} = 12 - 12\\nu_{b} \\ge 0 \\implies \\nu_{b} \\le 1$\n\nCombining these inequalities, the feasible range for $\\nu_{b}$ is $\\frac{6}{7} \\le \\nu_{b} \\le 1$.\nThe maximum possible value is $\\nu_{b}^{\\max} = 1$.\n\nThird, the maximum mass yield, $Y_{P/S}^{\\max}$, is computed. The molar masses ($M$) are calculated using the provided atomic weights: $M(\\mathrm{C})=12.01\\,\\text{g/mol}$, $M(\\mathrm{H})=1.008\\,\\text{g/mol}$, $M(\\mathrm{O})=16.00\\,\\text{g/mol}$.\nMolar mass of glucose, $M_{\\text{glucose}}$ ($\\mathrm{C_{6}H_{12}O_{6}}$):\n$$M_{\\text{glucose}} = 6 \\times 12.01 + 12 \\times 1.008 + 6 \\times 16.00 = 72.06 + 12.096 + 96.00 = 180.156\\,\\text{g/mol}$$\nMolar mass of $n$-butanol, $M_{\\text{butanol}}$ ($\\mathrm{C_{4}H_{10}O}$):\n$$M_{\\text{butanol}} = 4 \\times 12.01 + 10 \\times 1.008 + 1 \\times 16.00 = 48.04 + 10.080 + 16.00 = 74.120\\,\\text{g/mol}$$\nThe maximum mass yield is given by:\n$$Y_{P/S}^{\\max} = \\nu_{b}^{\\max} \\frac{M_{\\text{butanol}}}{M_{\\text{glucose}}}$$\nSubstituting the values:\n$$Y_{P/S}^{\\max} = 1 \\times \\frac{74.120}{180.156} \\approx 0.4114134\\,\\text{g/g}$$\nRounding to $4$ significant figures as required, the result is $0.4114$.", "answer": "$$\n\\boxed{0.4114}\n$$", "id": "2506619"}, {"introduction": "While stoichiometric analysis defines the theoretical limits of production, the actual flux through a pathway is governed by the kinetics of its constituent enzymes. A pathway is only as fast as its slowest step. This practice [@problem_id:2506550] bridges the gap between stoichiometry and kinetics, asking you to calculate the in-situ catalytic capacity of each enzyme in a linear pathway using Michaelis-Menten kinetics. By identifying the rate-limiting step, you will learn a critical skill for diagnosing metabolic bottlenecks and prioritizing targets for protein engineering and expression tuning.", "problem": "An engineered bacterium is constructed to produce a target molecule through a strictly linear, four-step pathway. Each step is catalyzed by a single-substrate enzyme with no allosteric regulation and negligible product inhibition under the operating conditions. The cell is in a steady physiological state with measured intracellular substrate concentrations for the substrate of each step, and each enzyme follows the classical Michaelis–Menten mechanism under the quasi-steady-state assumption for the enzyme–substrate complex. Assume that the total enzyme reported is catalytically competent, that each step is effectively irreversible, and that the specific flux of the pathway at steady state cannot exceed the slowest step’s attainable rate under the given conditions. The enzyme total abundances are reported per gram dry weight (gDW).\n\nFor steps $i \\in \\{1,2,3,4\\}$ the following parameters are measured:\n- Step 1: total enzyme abundance $E_{t,1} = 0.030~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},1} = 120~\\text{s}^{-1}$, Michaelis constant $K_{M,1} = 0.20~\\text{mM}$, substrate concentration $S_{1} = 1.00~\\text{mM}$.\n- Step 2: total enzyme abundance $E_{t,2} = 0.015~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},2} = 200~\\text{s}^{-1}$, Michaelis constant $K_{M,2} = 0.050~\\text{mM}$, substrate concentration $S_{2} = 0.100~\\text{mM}$.\n- Step 3: total enzyme abundance $E_{t,3} = 0.040~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},3} = 50~\\text{s}^{-1}$, Michaelis constant $K_{M,3} = 0.50~\\text{mM}$, substrate concentration $S_{3} = 0.250~\\text{mM}$.\n- Step 4: total enzyme abundance $E_{t,4} = 0.010~\\mu\\text{mol}~\\text{gDW}^{-1}$, catalytic turnover $k_{\\text{cat},4} = 500~\\text{s}^{-1}$, Michaelis constant $K_{M,4} = 0.20~\\text{mM}$, substrate concentration $S_{4} = 1.00~\\text{mM}$.\n\nUsing only fundamental definitions of Michaelis–Menten kinetics and steady-state pathway throughput constraints derived from mass conservation, compute the enzyme-limited maximal specific pathway flux under these conditions, expressed in $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$. Round your answer to three significant figures. You may not assume any additional parameters beyond those stated, and you must justify the units used from first principles as part of your derivation in the solution. Although you should reason about which step constrains throughput, report only the numerical value of the maximal specific flux in the units requested.", "solution": "The specific flux per gram dry weight (gDW), denoted $J$ (units $\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$), for an enzyme following Michaelis-Menten kinetics is given by the equation:\n$$\nJ \\;=\\; k_{\\text{cat}} E_{t}\\, \\frac{S}{K_{M} + S}\n$$\nHere, $k_{\\text{cat}}$ is the turnover number ($\\text{s}^{-1}$), $E_{t}$ is the total enzyme abundance per gDW ($\\text{mol}~\\text{gDW}^{-1}$), and $S$ and $K_M$ are the substrate concentration and Michaelis constant, respectively. The saturation term $\\frac{S}{K_{M}+S}$ is dimensionless.\n\nFor a linear pathway at steady state, the overall flux cannot exceed the capacity of its slowest step. Therefore, the maximal specific pathway flux is the minimum of the individual step capacities ($J_i$):\n$$\nJ_{\\text{max}} \\;=\\; \\min_{i \\in \\{1,2,3,4\\}} \\{J_i\\}\n$$\n\nWe compute the capacity for each step in $\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$.\n\nStep 1:\n$$\nJ_{1} = (120~\\text{s}^{-1}) (0.030~\\mu\\text{mol}~\\text{gDW}^{-1}) \\left( \\frac{1.00~\\text{mM}}{0.20~\\text{mM} + 1.00~\\text{mM}} \\right) = 3.6 \\times \\frac{1.00}{1.20} = 3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}\n$$\n\nStep 2:\n$$\nJ_{2} = (200~\\text{s}^{-1}) (0.015~\\mu\\text{mol}~\\text{gDW}^{-1}) \\left( \\frac{0.100~\\text{mM}}{0.050~\\text{mM} + 0.100~\\text{mM}} \\right) = 3.0 \\times \\frac{0.100}{0.150} = 2.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}\n$$\n\nStep 3:\n$$\nJ_{3} = (50~\\text{s}^{-1}) (0.040~\\mu\\text{mol}~\\text{gDW}^{-1}) \\left( \\frac{0.250~\\text{mM}}{0.50~\\text{mM} + 0.250~\\text{mM}} \\right) = 2.0 \\times \\frac{0.250}{0.750} = \\frac{2}{3}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}\n$$\n\nStep 4:\n$$\nJ_{4} = (500~\\text{s}^{-1}) (0.010~\\mu\\text{mol}~\\text{gDW}^{-1}) \\left( \\frac{1.00~\\text{mM}}{0.20~\\text{mM} + 1.00~\\text{mM}} \\right) = 5.0 \\times \\frac{1.00}{1.20} = \\frac{25}{6}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}\n$$\n\nNow, we convert the units from $\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$ to $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$. The conversion factor is $\\frac{1~\\text{mmol}}{1000~\\mu\\text{mol}} \\times \\frac{3600~\\text{s}}{1~\\text{h}} = 3.6$.\n\n$J_{1} = 3.0 \\times 3.6 = 10.8~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$\n$J_{2} = 2.0 \\times 3.6 = 7.2~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$\n$J_{3} = \\frac{2}{3} \\times 3.6 = 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$\n$J_{4} = \\frac{25}{6} \\times 3.6 = 15.0~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$\n\nCollecting the step capacities:\n$$\nJ_{1} = 10.8,\\quad J_{2} = 7.2,\\quad J_{3} = 2.4,\\quad J_{4} = 15.0.\n$$\nThe rate-limiting step is the one with the minimum capacity.\n$$\nJ_{\\text{max}} \\;=\\; \\min\\{10.8,\\, 7.2,\\, 2.4,\\, 15.0\\} \\;=\\; 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\nRounding to three significant figures gives $2.40$. The constraining step is step 3.", "answer": "$$\\boxed{2.40}$$", "id": "2506550"}, {"introduction": "Real metabolic systems are not simple linear pathways but complex, interconnected networks with competing objectives. This computational exercise [@problem_id:2506613] introduces you to Flux Balance Analysis (FBA), the workhorse algorithm for predicting metabolic phenotypes from network stoichiometry under a given physiological objective. You will also implement Flux Variability Analysis (FVA) to explore the full range of metabolic behaviors consistent with optimal performance, a powerful technique for understanding network robustness and identifying alternative production strategies.", "problem": "A metabolic network for microbial bioproduction is modeled using steady-state mass conservation (stoichiometric mass balance) and linear optimization. The foundational base is mass balance at steady state and flux bounds: every internal metabolite has no net accumulation, so the flux vector $\\mathbf{v} \\in \\mathbb{R}^n$ must satisfy $S \\mathbf{v} = \\mathbf{0}$, where $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix, and each reaction flux $v_i$ is constrained by lower and upper bounds. This base, together with linear objective functions, underlies Flux Balance Analysis (FBA). Alternate optima are characterized using Flux Variability Analysis (FVA), which computes allowable ranges of individual fluxes while maintaining the optimal objective value within a small tolerance. Your program must implement these principles to compare optimal solutions under different objectives and to quantify alternate optima via FVA.\n\nNetwork specification. Internal metabolites are $\\{\\text{Glc}, \\text{Pyr}, \\text{ATP}, \\text{O2}, \\text{CO2}, \\text{Lac}\\}$. Reactions (all irreversible) and their flux indices are:\n- $v_1$: glucose uptake, $\\text{Glc}_e \\rightarrow \\text{Glc}$, index $0$.\n- $v_2$: glycolysis, $\\text{Glc} \\rightarrow 2\\,\\text{Pyr} + 2\\,\\text{ATP}$, index $1$.\n- $v_3$: respiration A, $\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$, index $2$.\n- $v_{10}$: respiration B (duplicate of respiration A), $\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$, index $3$.\n- $v_4$: fermentation A, $\\text{Pyr} \\rightarrow \\text{Lac}$, index $4$.\n- $v_{11}$: fermentation B (duplicate of fermentation A), $\\text{Pyr} \\rightarrow \\text{Lac}$, index $5$.\n- $v_5$: adenosine triphosphate (ATP) hydrolysis demand, $\\text{ATP} \\rightarrow \\varnothing$, index $6$.\n- $v_6$: biomass formation (sink), $2\\,\\text{Pyr} + 10\\,\\text{ATP} \\rightarrow \\varnothing$, index $7$.\n- $v_7$: oxygen uptake, $\\text{O2}_e \\rightarrow \\text{O2}$, index $8$.\n- $v_8$: carbon dioxide export, $\\text{CO2} \\rightarrow \\varnothing$, index $9$.\n- $v_9$: lactate export, $\\text{Lac} \\rightarrow \\varnothing$, index $10$.\n\nSteady-state stoichiometric mass balances $S \\mathbf{v} = \\mathbf{0}$ for the internal metabolites, written as linear equations, are:\n- Glc: $+1\\,v_1 - 1\\,v_2 = 0$.\n- Pyr: $+2\\,v_2 - 1\\,v_3 - 1\\,v_{10} - 1\\,v_4 - 1\\,v_{11} - 2\\,v_6 = 0$.\n- ATP: $+2\\,v_2 + 12.5\\,v_3 + 12.5\\,v_{10} - 1\\,v_5 - 10\\,v_6 = 0$.\n- O2: $+1\\,v_7 - 2.5\\,v_3 - 2.5\\,v_{10} = 0$.\n- CO2: $+3\\,v_3 + 3\\,v_{10} - 1\\,v_8 = 0$.\n- Lac: $+1\\,v_4 + 1\\,v_{11} - 1\\,v_9 = 0$.\n\nFlux bounds. All reactions are irreversible with lower bounds $0$. Exchange reactions have finite upper bounds as follows:\n- $0 \\le v_1 \\le G_{\\max}$ for glucose uptake.\n- $0 \\le v_7 \\le O_{\\max}$ for oxygen uptake.\n- All other reactions have upper bounds $+\\infty$.\n\nObjectives. You must compute the following, each formulated as a linear program:\n1. Biomass maximization: maximize $v_6$.\n2. ATP yield maximization: maximize $v_5$.\n3. Minimal total flux at maximal growth: first find the maximal biomass $v_6^\\star$ from objective (1), then minimize the total flux $\\sum_{i=1}^{n} |v_i|$ subject to $S \\mathbf{v} = \\mathbf{0}$, bounds as above, and $v_6 \\ge v_6^\\star - \\epsilon$. Because all reactions are irreversible, $|v_i| = v_i$, so the objective reduces to minimizing $\\sum_{i=1}^{n} v_i$.\n\nFlux Variability Analysis (FVA). For each objective above, after obtaining the optimal objective value $z^\\star$, characterize alternate optima by computing, for each target flux $v_j$ in the set $\\{v_3, v_{10}, v_4, v_{11}\\}$, the minimum and maximum feasible values of $v_j$ subject to $S \\mathbf{v} = \\mathbf{0}$, bounds, and the constraint that the objective remains optimal within tolerance $\\epsilon$. Implement this by adding the inequality $-c^\\top \\mathbf{v} \\le -z^\\star + \\epsilon$ when the objective is to maximize $c^\\top \\mathbf{v}$. For the minimal total flux objective, add both $v_6 \\ge v_6^\\star - \\epsilon$ and $\\sum_{i=1}^{n} v_i \\le T^\\star + \\epsilon$, where $T^\\star$ is the minimal total flux found under that constraint.\n\nNumerical tolerance and units. Use tolerance $\\epsilon = 10^{-7}$. Express all fluxes in millimoles per gram dry weight per hour, that is, in $\\text{mmol}\\,\\text{gDW}^{-1}\\,\\text{h}^{-1}$. Round all reported numbers to six decimal places.\n\nTest suite. Solve the above for the following parameter sets $(G_{\\max}, O_{\\max})$:\n- Case $1$: $(G_{\\max}, O_{\\max}) = (10, 100)$.\n- Case $2$: $(G_{\\max}, O_{\\max}) = (10, 8)$.\n- Case $3$: $(G_{\\max}, O_{\\max}) = (10, 0)$.\n\nRequired final output format. Your program should produce a single line of output containing a single list that concatenates, for each case in order, the following values in this exact order:\n- Biomass optimum $v_6^\\star$.\n- ATP optimum $v_5^\\star$.\n- Minimal total flux $T^\\star$ at $v_6 \\ge v_6^\\star - \\epsilon$.\n- FVA under biomass optimum: $[v_3^{\\min}, v_3^{\\max}, v_{10}^{\\min}, v_{10}^{\\max}, v_4^{\\min}, v_4^{\\max}, v_{11}^{\\min}, v_{11}^{\\max}]$.\n- FVA under ATP optimum: the same eight values in the same order.\n- FVA under minimal total flux optimum: the same eight values in the same order.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,\\dots]$), with each number rounded to six decimals as specified. No other text should be printed.", "solution": "The solution is found by applying linear programming (LP). The metabolic network's state is described by a flux vector $\\mathbf{v} \\in \\mathbb{R}^{11}$ with components indexed 0 to 10. These indices correspond to the reactions as defined in the problem: $v_0$ represents reaction $v_1$ (glucose uptake), $v_1$ is $v_2$ (glycolysis),..., $v_6$ is $v_5$ (ATP demand), $v_7$ is $v_6$ (biomass formation), and so on.\n\nThe core of the model is the steady-state mass balance equation, $S \\mathbf{v} = \\mathbf{0}$, where $S$ is the $6 \\times 11$ stoichiometric matrix derived from the problem's mass balance equations. All fluxes are irreversible ($v_i \\ge 0$) and subject to uptake constraints on glucose ($v_0 \\le G_{\\max}$) and oxygen ($v_8 \\le O_{\\max}$).\n\nEach task is formulated as a distinct LP problem. Since standard LP solvers perform minimization, maximizing an objective $c^\\top \\mathbf{v}$ is achieved by minimizing $-c^\\top \\mathbf{v}$.\n\n1.  **Biomass Maximization**: The objective is to maximize the biomass formation flux, $v_6$ (flux index 7). The LP minimizes $-v_7$. The optimal value is $v_6^\\star$.\n\n2.  **ATP Yield Maximization**: The objective is to maximize the ATP hydrolysis flux, $v_5$ (flux index 6). The LP minimizes $-v_6$. The optimal value is $v_5^\\star$.\n\n3.  **Minimal Total Flux at Maximal Growth**: This is a two-step optimization. First, the maximal biomass flux, $v_6^\\star$, is found. Second, a new LP is solved to minimize the total flux, $\\sum v_i$, with an added constraint to ensure near-optimal biomass production: $v_6 \\ge v_6^\\star - \\epsilon$ (where $v_6$ is flux index 7). The optimal value is $T^\\star$.\n\n**Flux Variability Analysis (FVA)** is performed for each of the three optimal states. For a given optimal objective value $z^\\star$, a constraint is added to the LP problem to enforce that the objective remains near-optimal. Then, for each target flux $v_j$ (specifically fluxes with indices 2, 3, 4, and 5, which correspond to reactions $v_3, v_{10}, v_4$, and $v_{11}$, respectively), we find its minimum and maximum possible values by solving two LPs.\n\n-   **FVA for Biomass Optimum**: The constraint $v_6 \\ge v_6^\\star - \\epsilon$ is added.\n-   **FVA for ATP Optimum**: The constraint $v_5 \\ge v_5^\\star - \\epsilon$ is added.\n-   **FVA for Minimal Total Flux**: Two constraints are added: $v_6 \\ge v_6^\\star - \\epsilon$ and $\\sum v_i \\le T^\\star + \\epsilon$.\n\nFor each of these constrained systems, we iterate through the target fluxes, setting the objective to first minimize $v_j$ and then maximize $v_j$ to find the allowable flux range $[v_j^{\\min}, v_j^{\\max}]$. The entire procedure is implemented algorithmically for each test case. All numerical results are rounded to six decimal places.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of Flux Balance Analysis (FBA) and Flux Variability Analysis (FVA)\n    problems for a given metabolic network model.\n    \"\"\"\n    \n    # Define the test cases (G_max, O_max)\n    test_cases = [\n        (10.0, 100.0),  # Case 1\n        (10.0, 8.0),    # Case 2\n        (10.0, 0.0)     # Case 3\n    ]\n\n    # Stoichiometric matrix S (6 metabolites x 11 reactions)\n    # Rows: Glc, Pyr, ATP, O2, CO2, Lac\n    # Columns: v1, v2, v3, v10, v4, v11, v5, v6, v7, v8, v9 (indices 0-10)\n    S = np.array([\n        # v1(0), v2(1), v3(2), v10(3), v4(4), v11(5), v5(6), v6(7), v7(8), v8(9), v9(10)\n        [  1,    -1,     0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0],  # Glc\n        [  0,     2,    -1.0,   -1.0,   -1.0,   -1.0,    0.0,   -2.0,    0.0,    0.0,    0.0],  # Pyr\n        [  0,     2,    12.5,   12.5,    0.0,    0.0,   -1.0,  -10.0,    0.0,    0.0,    0.0],  # ATP\n        [  0,     0,    -2.5,   -2.5,    0.0,    0.0,    0.0,    0.0,    1.0,    0.0,    0.0],  # O2\n        [  0,     0,     3.0,    3.0,    0.0,    0.0,    0.0,    0.0,    0.0,   -1.0,    0.0],  # CO2\n        [  0,     0,     0.0,    0.0,    1.0,    1.0,    0.0,    0.0,    0.0,    0.0,   -1.0],  # Lac\n    ])\n    b_eq = np.zeros(S.shape[0])\n    num_fluxes = S.shape[1]\n    \n    # Numerical tolerance\n    epsilon = 1e-7\n\n    # FVA target flux indices (0-based): v3, v10, v4, v11\n    fva_flux_indices = [2, 3, 4, 5]\n\n    all_results = []\n\n    def run_fva(S_mat, b_eq_vec, bounds_list, A_ub_mat, b_ub_vec):\n        \"\"\"Helper function to perform FVA for a given constrained system.\"\"\"\n        fva_results = []\n        for idx in fva_flux_indices:\n            c = np.zeros(num_fluxes)\n            \n            # Minimize flux v_j\n            c[idx] = 1.0\n            res_min = linprog(c, A_eq=S_mat, b_eq=b_eq_vec, A_ub=A_ub_mat, b_ub=b_ub_vec, bounds=bounds_list, method='highs')\n            min_val = res_min.fun if res_min.success else 0.0\n            \n            # Maximize flux v_j by minimizing -v_j\n            c[idx] = -1.0\n            res_max = linprog(c, A_eq=S_mat, b_eq=b_eq_vec, A_ub=A_ub_mat, b_ub=b_ub_vec, bounds=bounds_list, method='highs')\n            max_val = -res_max.fun if res_max.success else 0.0\n\n            fva_results.extend([min_val, max_val])\n        return fva_results\n\n    for G_max, O_max in test_cases:\n        case_results = []\n        bounds = [(0, None)] * num_fluxes\n        bounds[0] = (0, G_max)  # v1 (glucose uptake, index 0)\n        bounds[8] = (0, O_max)  # v7 (oxygen uptake, index 8)\n\n        # 1. Biomass maximization (objective: max v6, index 7)\n        c_biomass = np.zeros(num_fluxes)\n        c_biomass[7] = -1\n        res_biomass = linprog(c_biomass, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        v6_star = -res_biomass.fun if res_biomass.success else 0.0\n        case_results.append(v6_star)\n        \n        # 2. ATP yield maximization (objective: max v5, index 6)\n        c_atp = np.zeros(num_fluxes)\n        c_atp[6] = -1\n        res_atp = linprog(c_atp, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        v5_star = -res_atp.fun if res_atp.success else 0.0\n        case_results.append(v5_star)\n\n        # 3. Minimal total flux at maximal growth\n        A_ub_minflux = np.zeros((1, num_fluxes))\n        A_ub_minflux[0, 7] = -1  # -v_6 = -(v6_star - epsilon) => v_6 >= v6_star - epsilon\n        b_ub_minflux = [-(v6_star - epsilon)]\n        c_totalflux = np.ones(num_fluxes)\n        res_totalflux = linprog(c_totalflux, A_eq=S, b_eq=b_eq, A_ub=A_ub_minflux, b_ub=b_ub_minflux, bounds=bounds, method='highs')\n        T_star = res_totalflux.fun if res_totalflux.success else 0.0\n        case_results.append(T_star)\n\n        # 4. FVA for Biomass Optimum\n        A_ub_fva1 = np.zeros((1, num_fluxes))\n        A_ub_fva1[0, 7] = -1    # v_6 >= v6_star - epsilon\n        b_ub_fva1 = [-(v6_star - epsilon)]\n        fva_biomass_results = run_fva(S, b_eq, bounds, A_ub_fva1, b_ub_fva1)\n        case_results.extend(fva_biomass_results)\n\n        # 5. FVA for ATP Optimum\n        A_ub_fva2 = np.zeros((1, num_fluxes))\n        A_ub_fva2[0, 6] = -1    # v_5 >= v5_star - epsilon\n        b_ub_fva2 = [-(v5_star - epsilon)]\n        fva_atp_results = run_fva(S, b_eq, bounds, A_ub_fva2, b_ub_fva2)\n        case_results.extend(fva_atp_results)\n        \n        # 6. FVA for Minimal Total Flux Optimum\n        A_ub_fva3 = np.zeros((2, num_fluxes))\n        A_ub_fva3[0, 7] = -1        # v_6 >= v6_star - epsilon\n        A_ub_fva3[1, :] = 1         # sum(v_i) = T_star + epsilon\n        b_ub_fva3 = [-(v6_star - epsilon), T_star + epsilon]\n        fva_totalflux_results = run_fva(S, b_eq, bounds, A_ub_fva3, b_ub_fva3)\n        case_results.extend(fva_totalflux_results)\n\n        all_results.extend(case_results)\n        \n    # Format and print the final output\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```", "id": "2506613"}]}