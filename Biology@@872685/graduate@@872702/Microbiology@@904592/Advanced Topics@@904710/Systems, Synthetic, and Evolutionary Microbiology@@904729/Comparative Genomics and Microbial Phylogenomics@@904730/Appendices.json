{"hands_on_practices": [{"introduction": "Any phylogenomic analysis begins with raw sequencing data, whose reliability is paramount. This exercise provides a quantitative framework for understanding how data quality, as measured by Phred scores, directly impacts the accuracy of downstream inferences like variant calling. By deriving the expected number of false positives from first principles, you will gain a crucial intuition for why stringent quality filtering is an essential and non-negotiable step in modern comparative genomics [@problem_id:2483725].", "problem": "A comparative microbial phylogenomics study aims to identify single-nucleotide variants (SNVs) across $N$ clonal bacterial isolates with a shared core genome alignment of length $L$ base pairs, using next-generation sequencing (NGS) reads. Each site in each isolate is covered by exactly $D$ independent reads whose base calls are filtered by a minimum Phred quality score threshold $Q_{\\mathrm{th}}$. Assume perfect mapping, no genuine biological variation (the isolates are truly identical), and that sequencing errors at retained bases are independent across reads and isolates with per-base error probability $p_{\\mathrm{err}}$ determined by the Phred transformation $Q=-10\\log_{10}(p_{\\mathrm{err}})$. A naive site-level variant discovery procedure flags a site as variable if at least one read in at least one isolate reports a base different from the (true) reference base at that site.\n\nStarting from the definition of the Phred quality score and basic probability rules, derive the expected number of false positive variant sites $E_{\\mathrm{FP}}(Q_{\\mathrm{th}})$ as a function of $L$, $N$, $D$, and $p_{\\mathrm{err}}(Q_{\\mathrm{th}})$, and then simplify it in the small-error limit appropriate for stringent filtering, where $N D\\,p_{\\mathrm{err}}(Q_{\\mathrm{th}})\\ll 1$. Using this result, compute the ratio\n$$\nR \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}\n$$\nunder the same $L$, $N$, and $D$. Provide your final answer for $R$ as a single number (dimensionless). Do not round.", "solution": "The problem statement is first subjected to methodical validation.\n\nGivens are extracted verbatim:\n- $N$: number of clonal bacterial isolates.\n- $L$: length of the core genome alignment in base pairs.\n- $D$: number of independent reads covering each site in each isolate.\n- $Q_{\\mathrm{th}}$: a minimum Phred quality score threshold.\n- Assumption: perfect mapping.\n- Assumption: no genuine biological variation (isolates are truly identical).\n- Assumption: sequencing errors at retained bases are independent across reads and isolates.\n- $p_{\\mathrm{err}}$: per-base error probability.\n- Definition: Phred score $Q = -10\\log_{10}(p_{\\mathrm{err}})$.\n- Variant discovery rule: a site is flagged as variable if at least one read in at least one isolate reports a base different from the true reference base.\n- Task 1: Derive the expected number of false positive variant sites $E_{\\mathrm{FP}}(Q_{\\mathrm{th}})$ as a function of $L$, $N$, $D$, and $p_{\\mathrm{err}}(Q_{\\mathrm{th}})$.\n- Task 2: Simplify this expression in the small-error limit where $N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}) \\ll 1$.\n- Task 3: Compute the ratio $R \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}$ using the simplified result.\n\nValidation Verdict:\nThe problem is valid. It is scientifically grounded in the principles of genomics and bioinformatics, specifically the statistical modeling of sequencing errors. The concepts of Phred scores, single-nucleotide variants, and false positive rates are standard in the field. The problem is well-posed, with all necessary parameters and assumptions clearly defined to construct a probabilistic model. The language is objective and precise. The assumptions, such as constant read depth and absence of true variation, are common idealizations used to establish a baseline error model. The problem is a non-trivial application of probability theory and requires logical derivation, not mere recitation of facts.\n\nSolution Derivation:\nWe begin by formalizing the per-base error probability, $p_{\\mathrm{err}}$, as a function of the Phred quality score threshold, $Q_{\\mathrm{th}}$. The problem defines $Q = -10\\log_{10}(p_{\\mathrm{err}})$. Solving for $p_{\\mathrm{err}}$ yields:\n$$\n\\log_{10}(p_{\\mathrm{err}}) = -\\frac{Q}{10}\n$$\n$$\np_{\\mathrm{err}}(Q) = 10^{-Q/10}\n$$\nFor a given threshold $Q_{\\mathrm{th}}$, we denote the error probability as $p_{\\mathrm{err}} \\equiv p_{\\mathrm{err}}(Q_{\\mathrm{th}})$. From the problem statement, all retained bases are assumed to have this error probability.\n\nThe probability of a single base call being correct (i.e., not an error) is $1 - p_{\\mathrm{err}}$.\nConsider a single genomic site. This site is covered by $D$ reads in each of the $N$ isolates, for a total of $N \\times D$ reads. The problem states that sequencing errors are independent across reads and isolates.\n\nA site is flagged as a false positive variant if at least one of the $N \\times D$ reads covering that site reports an erroneous base. It is simpler to calculate the probability of the complementary event: that the site is *not* flagged as a variant. This occurs if and only if all $N \\times D$ reads covering that site are correct.\n\nThe probability that all $N \\times D$ reads are correct, due to their independence, is the product of their individual probabilities of being correct:\n$$\nP(\\text{no error at site}) = (1 - p_{\\mathrm{err}})^{N D}\n$$\nThe probability that a site is flagged as a false positive, $P_{\\mathrm{FP}}$, is therefore:\n$$\nP_{\\mathrm{FP}} = 1 - P(\\text{no error at site}) = 1 - (1 - p_{\\mathrm{err}})^{N D}\n$$\nThe total number of false positive sites, a random variable, is the sum of Bernoulli trials over the $L$ sites in the alignment. Assuming errors are independent across sites, the expected number of false positive sites, $E_{\\mathrm{FP}}$, is the total number of sites $L$ multiplied by the probability of a single site being a false positive:\n$$\nE_{\\mathrm{FP}}(Q_{\\mathrm{th}}) = L \\cdot P_{\\mathrm{FP}} = L \\left(1 - (1 - p_{\\mathrm{err}}(Q_{\\mathrm{th}}))^{N D}\\right)\n$$\nThis is the complete expression for the expected number of false positives.\n\nNext, we simplify this expression in the small-error limit, where $N D p_{\\mathrm{err}} \\ll 1$. This condition allows us to use the first-order binomial approximation, $(1-x)^k \\approx 1 - kx$ for $|kx| \\ll 1$. Here, we identify $x = p_{\\mathrm{err}}$ and $k = N D$. The given condition $ND p_{\\mathrm{err}} \\ll 1$ ensures the validity of this approximation.\nApplying this to our expression for $P_{\\mathrm{FP}}$:\n$$\n(1 - p_{\\mathrm{err}})^{N D} \\approx 1 - N D p_{\\mathrm{err}}\n$$\nSubstituting this back into the formula for $E_{\\mathrm{FP}}$:\n$$\nE_{\\mathrm{FP}}(Q_{\\mathrm{th}}) \\approx L (1 - (1 - N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}))) = L (1 - 1 + N D p_{\\mathrm{err}}(Q_{\\mathrm{th}})) = L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}})\n$$\nThis simplified result states that the expected number of false positives is approximately the total number of sequenced bases ($L \\times N \\times D$) multiplied by the error rate per base.\n\nThe problem instructs us to use this simplified result to compute the ratio $R \\equiv \\frac{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=20)}{E_{\\mathrm{FP}}(Q_{\\mathrm{th}}=30)}$.\nUsing the approximation, we have:\n$$\nR = \\frac{L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}=20)}{L N D p_{\\mathrm{err}}(Q_{\\mathrm{th}}=30)}\n$$\nThe terms $L$, $N$, and $D$ cancel, leaving:\n$$\nR = \\frac{p_{\\mathrm{err}}(20)}{p_{\\mathrm{err}}(30)}\n$$\nWe now calculate the specific error probabilities for $Q=20$ and $Q=30$:\nFor $Q_{\\mathrm{th}} = 20$:\n$$\np_{\\mathrm{err}}(20) = 10^{-20/10} = 10^{-2} = 0.01\n$$\nFor $Q_{\\mathrm{th}} = 30$:\n$$\np_{\\mathrm{err}}(30) = 10^{-30/10} = 10^{-3} = 0.001\n$$\nSubstituting these values into the expression for $R$:\n$$\nR = \\frac{10^{-2}}{10^{-3}} = 10^{-2 - (-3)} = 10^1 = 10\n$$\nThe instruction to use the simplified model is crucial, as it renders the ratio independent of the parameters $L$, $N$, and $D$, yielding a single numerical answer. The ratio indicates that a quality threshold of $Q=20$ is expected to produce $10$ times more false positive variant sites than a threshold of $Q=30$, under the assumptions of this model.", "answer": "$$\n\\boxed{10}\n$$", "id": "2483725"}, {"introduction": "Different genomic datasets, such as core-genome single nucleotide polymorphisms versus accessory gene content, can imply different evolutionary histories, leading to conflicting phylogenetic trees. To rigorously investigate these conflicts—which can signal complex biological processes like horizontal gene transfer—we need a formal method to measure the dissimilarity between tree topologies. This practice introduces the Robinson-Foulds (RF) distance, a foundational metric for this purpose, by asking you to represent trees as sets of bipartitions and quantify their discordance [@problem_id:2483696].", "problem": "You are comparing phylogenomic reconstructions for a set of microbial genomes to assess topological discordance between a core-genome tree and an accessory gene-content tree. Let the fixed taxon set be $X=\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$, representing $8$ labeled bacterial genomes. Each unrooted, fully bifurcating phylogenetic tree on $X$ can be represented by the set of its nontrivial bipartitions (splits), where each internal edge induces exactly one bipartition of $X$ into two disjoint, nonempty parts of size at least $2$.\n\nTree $\\;T_{1}\\;$ (core-genome) induces the following set of nontrivial splits:\n$$\n\\Sigma(T_{1})=\\Big\\{\n\\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}, \n$$\n$$\n\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\}\n\\Big\\}.\n$$\n\nTree $\\;T_{2}\\;$ (accessory gene-content) induces the following set of nontrivial splits:\n$$\n\\Sigma(T_{2})=\\Big\\{\n\\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\;\n\\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\},\\;\n\\{\\text{C},\\text{D}\\}\\mid\\{\\text{A},\\text{B},\\text{E},\\text{F},\\text{G},\\text{H}\\},\n$$\n$$\n\\{\\text{E},\\text{F}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{G},\\text{H}\\},\\;\n\\{\\text{A},\\text{B},\\text{G},\\text{H}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F}\\}\n\\Big\\}.\n$$\n\nStarting from the definition that each internal edge of an unrooted phylogenetic tree on a fixed taxon set induces one nontrivial split, and that the topological dissimilarity between two trees can be quantified by differences between their split sets, formally define the unweighted Robinson–Foulds (RF) distance for unrooted trees on the same taxon set. Then compute the RF distance $d_{\\mathrm{RF}}(T_{1},T_{2})$ for the two trees given above. Do not use any normalized variant; report the unweighted RF distance as a single integer. No rounding is necessary.", "solution": "The problem is first validated.\n\n**Step 1: Extract Givens**\n- Taxon set: $X=\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$, representing $8$ labeled genomes.\n- Trees are unrooted and fully bifurcating.\n- Each internal edge induces one nontrivial bipartition (split) of $X$ into two disjoint, nonempty parts of size at least $2$.\n- Split set for Tree $T_{1}$: $\\Sigma(T_{1})=\\Big\\{ \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}, \\; \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\} \\Big\\}$.\n- Split set for Tree $T_{2}$: $\\Sigma(T_{2})=\\Big\\{ \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\},\\; \\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\},\\; \\{\\text{C},\\text{D}\\}\\mid\\{\\text{A},\\text{B},\\text{E},\\text{F},\\text{G},\\text{H}\\}, \\; \\{\\text{E},\\text{F}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{G},\\text{H}\\},\\; \\{\\text{A},\\text{B},\\text{G},\\text{H}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F}\\} \\Big\\}$.\n- Task: Formally define the unweighted Robinson–Foulds distance, $d_{\\mathrm{RF}}$, and compute $d_{\\mathrm{RF}}(T_{1},T_{2})$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the field of phylogenetics and combinatorics. The use of splits to represent tree topology and the Robinson–Foulds metric are standard concepts in comparative genomics. For an unrooted, fully bifurcating tree on $n$ taxa, the number of internal edges, and thus the number of nontrivial splits, is $n-3$. Here, $n=8$, so there must be $8-3=5$ nontrivial splits. The givens provide $|\\Sigma(T_1)| = 5$ and $|\\Sigma(T_2)| = 5$, which is consistent. The problem is well-posed, objective, and contains all necessary information for a unique solution. No flaws are detected.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution will proceed.\n\nThe task requires the formal definition of the unweighted Robinson–Foulds (RF) distance and its computation for the given trees $T_1$ and $T_2$.\n\nLet $T_1$ and $T_2$ be two unrooted phylogenetic trees on a common taxon set $X$. Let $\\Sigma(T_1)$ and $\\Sigma(T_2)$ denote the sets of nontrivial bipartitions (splits) induced by the internal edges of $T_1$ and $T_2$, respectively. A bipartition of $X$ is a pair of disjoint, nonempty sets $\\{A, B\\}$ such that $A \\cup B = X$. The RF distance, $d_{\\mathrm{RF}}(T_1, T_2)$, is defined as the cardinality of the symmetric difference of the two split sets:\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1) \\Delta \\Sigma(T_2)|$$\nThe symmetric difference of two sets $S_1$ and $S_2$ is the set of elements which are in either of the sets, but not in their intersection, defined as $S_1 \\Delta S_2 = (S_1 \\setminus S_2) \\cup (S_2 \\setminus S_1)$. The cardinality of the symmetric difference can be calculated as:\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1) \\setminus \\Sigma(T_2)| + |\\Sigma(T_2) \\setminus \\Sigma(T_1)|$$\nThis is equivalent to the total number of splits minus twice the number of common splits:\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1)| + |\\Sigma(T_2)| - 2|\\Sigma(T_1) \\cap \\Sigma(T_2)|$$\nThe problem provides the taxon set $X$ with $|X|=8$ and the split sets $\\Sigma(T_1)$ and $\\Sigma(T_2)$, both of which correctly contain $n-3 = 8-3=5$ splits. We must find the intersection, $\\Sigma(T_1) \\cap \\Sigma(T_2)$.\n\nIt is critical to recognize that a bipartition $\\{A\\} \\mid \\{B\\}$ is an unordered pair of sets, and is therefore identical to the bipartition $\\{B\\} \\mid \\{A\\}$, where $B = X \\setminus A$.\n\nThe set of splits for $T_1$ is:\n$\\Sigma(T_1) = \\Big\\{ s_{1,1}, s_{1,2}, s_{1,3}, s_{1,4}, s_{1,5} \\Big\\}$, where:\n$s_{1,1} = \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,2} = \\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,3} = \\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,4} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\}$\n$s_{1,5} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\}$\n\nThe set of splits for $T_2$ is:\n$\\Sigma(T_2) = \\Big\\{ s_{2,1}, s_{2,2}, s_{2,3}, s_{2,4}, s_{2,5} \\Big\\}$, where:\n$s_{2,1} = \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{2,2} = \\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}$\n$s_{2,3} = \\{\\text{C},\\text{D}\\}\\mid\\{\\text{A},\\text{B},\\text{E},\\text{F},\\text{G},\\text{H}\\}$\n$s_{2,4} = \\{\\text{E},\\text{F}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{G},\\text{H}\\}$\n$s_{2,5} = \\{\\text{A},\\text{B},\\text{G},\\text{H}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F}\\}$\n\nWe now identify the common splits, $\\Sigma(T_1) \\cap \\Sigma(T_2)$:\n1.  Comparing $s_{1,1}$ with splits in $\\Sigma(T_2)$:\n    The split $s_{1,1} = \\{\\text{A},\\text{B}\\}\\mid\\{\\text{C},\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$ is identical to $s_{2,1}$. This is one common split.\n2.  Comparing $s_{1,2}$ with splits in $\\Sigma(T_2)$:\n    The split $s_{1,2} = \\{\\text{A},\\text{B},\\text{C}\\}\\mid\\{\\text{D},\\text{E},\\text{F},\\text{G},\\text{H}\\}$ does not match any split in $\\Sigma(T_2)$.\n3.  Comparing $s_{1,3}$ with splits in $\\Sigma(T_2)$:\n    The split $s_{1,3} = \\{\\text{A},\\text{B},\\text{C},\\text{D}\\}\\mid\\{\\text{E},\\text{F},\\text{G},\\text{H}\\}$ does not match any split in $\\Sigma(T_2)$.\n4.  Comparing $s_{1,4}$ with splits in $\\Sigma(T_2)$:\n    The split $s_{1,4} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E}\\}\\mid\\{\\text{F},\\text{G},\\text{H}\\}$ does not match any split in $\\Sigma(T_2)$.\n5.  Comparing $s_{1,5}$ with splits in $\\Sigma(T_2)$:\n    The split $s_{1,5} = \\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}\\mid\\{\\text{G},\\text{H}\\}$ is identical to $s_{2,2} = \\{\\text{G},\\text{H}\\}\\mid\\{\\text{A},\\text{B},\\text{C},\\text{D},\\text{E},\\text{F}\\}$, since a bipartition is an unordered pair of sets. This is the second common split.\n\nThe set of common splits is $\\Sigma(T_1) \\cap \\Sigma(T_2) = \\{s_{1,1}, s_{1,5}\\} = \\{s_{2,1}, s_{2,2}\\}$. The cardinality of the intersection is $|\\Sigma(T_1) \\cap \\Sigma(T_2)|=2$.\n\nThe number of splits unique to $T_1$ is $|\\Sigma(T_1) \\setminus \\Sigma(T_2)| = |\\Sigma(T_1)| - |\\Sigma(T_1) \\cap \\Sigma(T_2)| = 5 - 2 = 3$. These splits are $\\{s_{1,2}, s_{1,3}, s_{1,4}\\}$.\nThe number of splits unique to $T_2$ is $|\\Sigma(T_2) \\setminus \\Sigma(T_1)| = |\\Sigma(T_2)| - |\\Sigma(T_1) \\cap \\Sigma(T_2)| = 5 - 2 = 3$. These splits are $\\{s_{2,3}, s_{2,4}, s_{2,5}\\}$.\n\nThe Robinson–Foulds distance is the sum of these quantities:\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1) \\setminus \\Sigma(T_2)| + |\\Sigma(T_2) \\setminus \\Sigma(T_1)| = 3 + 3 = 6$$\nAlternatively, using the other formula:\n$$d_{\\mathrm{RF}}(T_1, T_2) = |\\Sigma(T_1)| + |\\Sigma(T_2)| - 2|\\Sigma(T_1) \\cap \\Sigma(T_2)| = 5 + 5 - 2(2) = 10 - 4 = 6$$\nThe unweighted Robinson–Foulds distance between $T_1$ and $T_2$ is $6$.", "answer": "$$\n\\boxed{6}\n$$", "id": "2483696"}, {"introduction": "This exercise simulates a complete, albeit simplified, comparative genomics workflow, integrating several key concepts into a single narrative. You will begin with microbial gene content data, a common source for inferring relationships, and translate it into a matrix of pairwise evolutionary distances. From there, you will reconstruct a phylogeny using the classic Neighbor-Joining algorithm and, finally, assess its congruence with a reference tree using the Robinson-Foulds distance, providing a capstone practice in data processing, tree-building, and topological comparison [@problem_id:2483707].", "problem": "A set of four bacterial genomes $S_{1}, S_{2}, S_{3}, S_{4}$ have been analyzed for accessory gene content across six gene families $f_{1}, f_{2}, f_{3}, f_{4}, f_{5}, f_{6}$. The accessory gene presence ($1$) or absence ($0$) vectors are:\n- $S_1$: (1,1,0,0,1,0)\n- $S_2$: (1,1,0,0,1,1)\n- $S_3$: (0,0,1,1,0,1)\n- $S_4$: (0,0,1,1,1,1)\n\nStarting from first principles in comparative genomics and phylogenomics, do the following:\n1. Using the definition of the Hamming distance as the number of positions at which two binary vectors differ, compute the pairwise accessory gene content distances $d(S_{i}, S_{j})$ for all unordered pairs $\\{i,j\\} \\subset \\{1,2,3,4\\}$.\n2. From the resulting distance matrix, infer an unrooted phylogeny using the neighbor-joining (NJ) algorithm. Clearly state the resulting unrooted topology on the labeled leaves $S_{1}, S_{2}, S_{3}, S_{4}$.\n3. A reference core genome single-nucleotide polymorphism (SNP) maximum likelihood (ML) tree on the same taxa is given by the unrooted Newick topology `((S1,S3),(S2,S4))`. Treating both trees as unrooted and fully resolved on the same leaf set, compute the Robinson–Foulds (RF) distance.\n\nReport the RF distance as an exact integer with no units. No rounding is required.", "solution": "The problem is divided into three parts which must be addressed in sequence. First, we compute a distance matrix based on accessory gene content. Second, we infer a phylogeny from this matrix using the Neighbor-Joining algorithm. Third, we compare the inferred phylogeny to a reference phylogeny using the Robinson-Foulds distance. The problem is well-posed and scientifically grounded in the principles of comparative genomics and phylogenomics.\n\nThe set of four bacterial genomes is $S = \\{S_{1}, S_{2}, S_{3}, S_{4}\\}$. The accessory gene content is represented by binary vectors of length $6$, where $1$ denotes presence and $0$ denotes absence. The vectors are:\n$v_{1} = (1,1,0,0,1,0)$ for genome $S_{1}$\n$v_{2} = (1,1,0,0,1,1)$ for genome $S_{2}$\n$v_{3} = (0,0,1,1,0,1)$ for genome $S_{3}$\n$v_{4} = (0,0,1,1,1,1)$ for genome $S_{4}$\n\nPart 1: Pairwise Distance Calculation\nThe problem specifies the use of the Hamming distance, $d(S_{i}, S_{j})$, which is the number of positions at which the corresponding vectors $v_{i}$ and $v_{j}$ differ. We compute this for all $\\binom{4}{2} = 6$ unordered pairs of genomes.\n\n$d(S_{1}, S_{2})$: Compare $v_1=(1,1,0,0,1,0)$ and $v_2=(1,1,0,0,1,1)$. They differ only in the $6^{th}$ position. Thus, $d(S_{1}, S_{2}) = 1$.\n\n$d(S_{1}, S_{3})$: Compare $v_1=(1,1,0,0,1,0)$ and $v_3=(0,0,1,1,0,1)$. They differ in positions $1, 2, 3, 4, 5, 6$. Thus, $d(S_{1}, S_{3}) = 6$.\n\n$d(S_{1}, S_{4})$: Compare $v_1=(1,1,0,0,1,0)$ and $v_4=(0,0,1,1,1,1)$. They differ in positions $1, 2, 3, 4, 6$. Thus, $d(S_{1}, S_{4}) = 5$.\n\n$d(S_{2}, S_{3})$: Compare $v_2=(1,1,0,0,1,1)$ and $v_3=(0,0,1,1,0,1)$. They differ in positions $1, 2, 3, 4, 5$. Thus, $d(S_{2}, S_{3}) = 5$.\n\n$d(S_{2}, S_{4})$: Compare $v_2=(1,1,0,0,1,1)$ and $v_4=(0,0,1,1,1,1)$. They differ in positions $1, 2, 3, 4$. Thus, $d(S_{2}, S_{4}) = 4$.\n\n$d(S_{3}, S_{4})$: Compare $v_3=(0,0,1,1,0,1)$ and $v_4=(0,0,1,1,1,1)$. They differ only in the $5^{th}$ position. Thus, $d(S_{3}, S_{4}) = 1$.\n\nThis yields the symmetric distance matrix $D$:\n$$\nD = \\begin{pmatrix}\n0 & 1 & 6 & 5 \\\\\n1 & 0 & 5 & 4 \\\\\n6 & 5 & 0 & 1 \\\\\n5 & 4 & 1 & 0\n\\end{pmatrix}\n$$\nwhere rows and columns are indexed by $S_1, S_2, S_3, S_4$.\n\nPart 2: Neighbor-Joining (NJ) Tree Inference\nThe NJ algorithm aims to find pairs of taxa that are neighbors in the tree. It iteratively joins the closest neighbors based on a rate-corrected distance criterion. For a set of $n$ taxa, the algorithm proceeds as follows.\nFirst, for each taxon $i$, we compute its net divergence, $r_i$, from all other taxa: $r_i = \\sum_{k=1}^{n} d(S_i, S_k)$.\nFor our case with $n=4$:\n$r_{1} = d(S_{1}, S_{2}) + d(S_{1}, S_{3}) + d(S_{1}, S_{4}) = 1 + 6 + 5 = 12$\n$r_{2} = d(S_{2}, S_{1}) + d(S_{2}, S_{3}) + d(S_{2}, S_{4}) = 1 + 5 + 4 = 10$\n$r_{3} = d(S_{3}, S_{1}) + d(S_{3}, S_{2}) + d(S_{3}, S_{4}) = 6 + 5 + 1 = 12$\n$r_{4} = d(S_{4}, S_{1}) + d(S_{4}, S_{2}) + d(S_{4}, S_{3}) = 5 + 4 + 1 = 10$\n\nNext, we compute the NJ matrix $Q$, where $Q_{ij} = (n-2)d(S_i, S_j) - r_i - r_j$. For $n=4$, this becomes $Q_{ij} = 2d(S_i, S_j) - r_i - r_j$. The algorithm identifies the pair $(i, j)$ that minimizes $Q_{ij}$.\n$Q_{12} = 2d(S_{1}, S_{2}) - r_{1} - r_{2} = 2(1) - 12 - 10 = -20$\n$Q_{13} = 2d(S_{1}, S_{3}) - r_{1} - r_{3} = 2(6) - 12 - 12 = -12$\n$Q_{14} = 2d(S_{1}, S_{4}) - r_{1} - r_{4} = 2(5) - 12 - 10 = -12$\n$Q_{23} = 2d(S_{2}, S_{3}) - r_{2} - r_{3} = 2(5) - 10 - 12 = -12$\n$Q_{24} = 2d(S_{2}, S_{4}) - r_{2} - r_{4} = 2(4) - 10 - 10 = -12$\n$Q_{34} = 2d(S_{3}, S_{4}) - r_{3} - r_{4} = 2(1) - 12 - 10 = -20$\n\nThe minimum value in the $Q$ matrix is $-20$, which corresponds to pairs $(S_1, S_2)$ and $(S_3, S_4)$. In the standard NJ algorithm, any of the pairs that yield the minimum $Q$ value can be chosen to be joined. The algorithm selects such a pair, say $(S_1, S_2)$, as the first set of neighbors. For an unrooted tree of $4$ taxa, once one pair of neighbors is identified, the topology is fully determined. If $S_1$ and $S_2$ are neighbors, then $S_3$ and $S_4$ must also be neighbors, forming the other branch of the unrooted tree. The same conclusion is reached if we first select the pair $(S_3, S_4)$. Therefore, the Neighbor-Joining algorithm infers a topology where $S_1$ is clustered with $S_2$, and $S_3$ is clustered with $S_4$.\nThe resulting unrooted topology, let us call it $T_{NJ}$, can be written in Newick format as `((S1,S2),(S3,S4))`.\n\nPart 3: Robinson–Foulds (RF) Distance Calculation\nWe are asked to compute the RF distance between the inferred tree $T_{NJ}$ and the given reference tree, $T_{Ref}$.\n$T_{NJ}$ topology: `((S1,S2),(S3,S4))`\n$T_{Ref}$ topology: `((S1,S3),(S2,S4))`\n\nThe RF distance measures the dissimilarity between two phylogenetic trees on the same set of leaves. It is defined as the number of nontrivial bipartitions (or splits) of the leaves that are found in one tree but not the other. For a fully resolved (bifurcating) unrooted tree with $n$ leaves, there are $n-3$ internal edges, and each internal edge corresponds to one nontrivial bipartition of the leaves.\n\nIn our case, $n=4$, so each tree has $n-3 = 4-3 = 1$ internal edge and thus defines exactly one nontrivial bipartition.\nLet's identify the bipartition for each tree.\nFor $T_{NJ} = ((S1,S2),(S3,S4))$, removing the single internal edge separates the leaves into two sets: $\\{S1, S2\\}$ and $\\{S3, S4\\}$. The bipartition is $\\{\\{S1, S2\\}, \\{S3, S4\\}\\}$. Let's denote the set of bipartitions for $T_{NJ}$ as $B(T_{NJ})$. So, $B(T_{NJ}) = \\{\\{\\{S1, S2\\}, \\{S3, S4\\}\\}\\}$.\n\nFor $T_{Ref} = ((S1,S3),(S2,S4))$, removing the single internal edge separates the leaves into two sets: $\\{S1, S3\\}$ and $\\{S2, S4\\}$. The bipartition is $\\{\\{S1, S3\\}, \\{S2, S4\\}\\}$. Let's denote the set of bipartitions for $T_{Ref}$ as $B(T_{Ref})$. So, $B(T_{Ref}) = \\{\\{\\{S1, S3\\}, \\{S2, S4\\}\\}\\}$.\n\nThe RF distance is the size of the symmetric difference of these two sets of bipartitions:\n$d_{RF}(T_{NJ}, T_{Ref}) = |B(T_{NJ}) \\setminus B(T_{Ref})| + |B(T_{Ref}) \\setminus B(T_{NJ})|$.\n\nThe bipartition $\\{\\{S1, S2\\}, \\{S3, S4\\}\\}$ from $T_{NJ}$ is not present in $T_{Ref}$. So, $|B(T_{NJ}) \\setminus B(T_{Ref})| = 1$.\nThe bipartition $\\{\\{S1, S3\\}, \\{S2, S4\\}\\}$ from $T_{Ref}$ is not present in $T_{NJ}$. So, $|B(T_{Ref}) \\setminus B(T_{NJ})| = 1$.\n\nThe RF distance is the sum of these counts: $d_{RF} = 1 + 1 = 2$.", "answer": "$$\\boxed{2}$$", "id": "2483707"}]}