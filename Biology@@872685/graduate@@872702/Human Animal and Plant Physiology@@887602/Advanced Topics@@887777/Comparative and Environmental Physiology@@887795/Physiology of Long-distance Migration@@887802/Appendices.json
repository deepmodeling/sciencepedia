{"hands_on_practices": [{"introduction": "Understanding the energetic cost of flight begins with accurately measuring the rate of oxygen consumption ($\\dot V\\!O_2$), which acts as a proxy for the metabolic engine's fuel burn rate. The Fick principle provides a direct method for this measurement, rooted in the law of mass conservation, by relating metabolic rate to systemic blood flow and the difference in oxygen content between arterial and venous blood. This exercise [@problem_id:2595934] will give you practice in applying this fundamental physiological equation to determine the mass-specific metabolic rate of a bird in sustained flight.", "problem": "A small migratory bird in sustained flapping flight is studied under steady-state conditions at altitude where arterial and mixed-venous blood oxygen contents have been measured. Assume that over the time window of interest there is no net accumulation of oxygen in body stores, that the mixed-venous sample represents the flow-weighted average returning from all tissues, and that oxygen content measurements already reflect both hemoglobin-bound and dissolved oxygen. Using conservation of mass across the systemic circulation, determine the mass-specific whole-body rate of oxygen consumption during flight.\n\nGiven:\n- Cardiac output (systemic blood flow): $Q = 350\\,\\mathrm{mL\\,min^{-1}}$.\n- Arterial oxygen content: $C_{a\\mathrm{O}_2} = 200\\,\\mathrm{mL\\,L^{-1}}$.\n- Mixed-venous oxygen content: $C_{v\\mathrm{O}_2} = 140\\,\\mathrm{mL\\,L^{-1}}$.\n- Body mass: $m = 0.6\\,\\mathrm{kg}$.\n\nCompute the mass-specific oxygen consumption rate $\\dot V\\!O_{2,\\mathrm{mass}}$ in $\\mathrm{mL\\,kg^{-1}\\,min^{-1}}$. Express your final answer in $\\mathrm{mL\\,kg^{-1}\\,min^{-1}}$. Provide the exact value; do not round.", "solution": "The problem statement is assessed and found to be valid. It is a well-posed problem in physiology, grounded in the fundamental principle of mass conservation, with a self-contained and consistent set of givens. The objective is to compute the mass-specific rate of oxygen consumption for a bird in flight.\n\nThe calculation is based on the Fick principle, which relates the whole-body rate of oxygen consumption, denoted as $\\dot V\\!O_2$, to the systemic blood flow (cardiac output, $Q$) and the difference between the oxygen content of arterial blood ($C_{a\\mathrm{O}_2}$) and mixed-venous blood ($C_{v\\mathrm{O}_2}$). The principle is a direct application of conservation of mass, asserting that the rate of oxygen uptake by the tissues equals the rate of oxygen delivery in arterial blood minus the rate of oxygen return in venous blood. Under the stated steady-state conditions, this relationship is expressed by the equation:\n$$ \\dot V\\!O_2 = Q \\times (C_{a\\mathrm{O}_2} - C_{v\\mathrm{O}_2}) $$\nThe provided data are:\n- Cardiac output: $Q = 350\\,\\mathrm{mL\\,min^{-1}}$\n- Arterial oxygen content: $C_{a\\mathrm{O}_2} = 200\\,\\mathrm{mL\\,L^{-1}}$\n- Mixed-venous oxygen content: $C_{v\\mathrm{O}_2} = 140\\,\\mathrm{mL\\,L^{-1}}$\n- Body mass: $m = 0.6\\,\\mathrm{kg}$\n\nBefore proceeding with calculation, it is mandatory to ensure consistency of units. The cardiac output $Q$ is given in milliliters per minute ($\\mathrm{mL\\,min^{-1}}$), whereas the oxygen contents $C_{a\\mathrm{O}_2}$ and $C_{v\\mathrm{O}_2}$ are given in milliliters of $\\mathrm{O}_2$ per liter of blood ($\\mathrm{mL\\,L^{-1}}$). The volume units for blood flow and blood volume in the content measurement are inconsistent. We must convert one to match the other. We will convert the cardiac output from $\\mathrm{mL\\,min^{-1}}$ to $\\mathrm{L\\,min^{-1}}$.\nSince $1\\,\\mathrm{L} = 1000\\,\\mathrm{mL}$, the cardiac output is:\n$$ Q = 350\\,\\mathrm{mL\\,min^{-1}} = \\frac{350}{1000}\\,\\mathrm{L\\,min^{-1}} = 0.35\\,\\mathrm{L\\,min^{-1}} $$\nNow, we can compute the arterial-venous oxygen difference:\n$$ C_{a\\mathrm{O}_2} - C_{v\\mathrm{O}_2} = (200 - 140)\\,\\mathrm{mL\\,L^{-1}} = 60\\,\\mathrm{mL\\,L^{-1}} $$\nThis value represents that for every liter of blood passing through the systemic circulation, $60\\,\\mathrm{mL}$ of oxygen is extracted by the tissues.\n\nWe can now calculate the total whole-body oxygen consumption rate, $\\dot V\\!O_2$.\n$$ \\dot V\\!O_2 = (0.35\\,\\mathrm{L\\,min^{-1}}) \\times (60\\,\\mathrm{mL\\,L^{-1}}) $$\nThe units $\\mathrm{L}$ will cancel, yielding a result in $\\mathrm{mL\\,min^{-1}}$.\n$$ \\dot V\\!O_2 = 0.35 \\times 60\\,\\mathrm{mL\\,min^{-1}} = 21\\,\\mathrm{mL\\,min^{-1}} $$\nThis is the total volume of oxygen consumed by the entire organism per minute.\n\nThe problem asks for the mass-specific oxygen consumption rate, denoted here as $\\dot V\\!O_{2,\\mathrm{mass}}$. This is obtained by normalizing the whole-body rate by the body mass, $m$.\n$$ \\dot V\\!O_{2,\\mathrm{mass}} = \\frac{\\dot V\\!O_2}{m} $$\nSubstituting the calculated value for $\\dot V\\!O_2$ and the given value for $m$:\n$$ \\dot V\\!O_{2,\\mathrm{mass}} = \\frac{21\\,\\mathrm{mL\\,min^{-1}}}{0.6\\,\\mathrm{kg}} $$\nThe calculation is straightforward:\n$$ \\dot V\\!O_{2,\\mathrm{mass}} = \\frac{21}{0.6}\\,\\mathrm{mL\\,kg^{-1}\\,min^{-1}} = \\frac{210}{6}\\,\\mathrm{mL\\,kg^{-1}\\,min^{-1}} = 35\\,\\mathrm{mL\\,kg^{-1}\\,min^{-1}} $$\nThe result is an exact integer, as required. This value represents the volume of oxygen in milliliters consumed per kilogram of body mass per minute.", "answer": "$$\n\\boxed{35}\n$$", "id": "2595934"}, {"introduction": "While knowing the metabolic rate at a single speed is useful, a migrating animal must choose its speed to optimize its journey. The metabolic power required for flight is not constant but varies with airspeed, typically described by a U-shaped curve. This practice [@problem_id:2595962] challenges you to use calculus to find two critical, but distinct, optimal speeds from an empirical power model: the speed that minimizes energy use per unit time (maximizing flight duration), $v_{mp}$, and the speed that minimizes energy use per unit distance (maximizing flight range), $v_{mr}$.", "problem": "A free-flying migratory bird of mass $m = 0.7\\,\\mathrm{kg}$ maintains steady, level flight at airspeed $v$ against aerodynamic forces. Let the net metabolic power required for flight be given empirically by\n$$\nP(v) \\;=\\; \\frac{0.6}{v} \\;+\\; 0.02\\,v^{3} \\;+\\; 1.2\\,v\n$$\nin International System of Units (SI units), where $P$ is in watts and $v$ is in meters per second. Using only fundamental definitions, determine:\n- the speed that minimizes the power requirement, and\n- the speed that minimizes the cost of transport.\n\nFor the purpose of this problem, use the definition that the cost of transport is the metabolic energy expended per unit body weight per unit distance traveled. Assume steady, level, unaccelerated flight, and neglect changes in kinetic and potential energy. Express each optimal speed in $\\mathrm{m\\,s^{-1}}$ and round each to three significant figures. State only the two speeds requested; do not report any other quantities. You may denote gravitational acceleration by $g$, but you do not need to substitute a numerical value for $g$ because it cancels in the minimization for the cost of transport under the stated assumptions.", "solution": "The problem is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Mass of the bird: $m = 0.7\\,\\mathrm{kg}$\n- Flight condition: steady, level flight at airspeed $v$.\n- Metabolic power function: $P(v) \\;=\\; \\frac{0.6}{v} \\;+\\; 0.02\\,v^{3} \\;+\\; 1.2\\,v$\n- Units: $P$ is in watts (W), $v$ is in meters per second ($\\mathrm{m\\,s^{-1}}$).\n- Task 1: Determine the speed that minimizes the power requirement.\n- Task 2: Determine the speed that minimizes the cost of transport.\n- Definition of Cost of Transport (COT): metabolic energy expended per unit body weight per unit distance traveled.\n- Assumptions: steady, level, unaccelerated flight; neglect changes in kinetic and potential energy.\n- Final answer requirements: Express speeds in $\\mathrm{m\\,s^{-1}}$, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The provided power function, $P(v) = Av^{-1} + Bv^3 + Cv$, is a standard empirical model used in the study of animal flight energetics. The terms correspond to induced power (proportional to $v^{-1}$), parasite power (proportional to $v^3$), and profile power (proportional to $v$) or a component of basal metabolism dependent on flight muscles. This is a scientifically sound and established model.\n- **Well-Posed:** The problem asks to find the minima of two well-defined, differentiable functions of speed $v$. The existence of such minima can be determined using standard calculus techniques (finding critical points and checking the second derivative). The problem is uniquely solvable.\n- **Objective:** The problem is stated using precise, quantitative language without subjective or ambiguous terms.\n- **Completeness and Consistency:** All necessary information is provided. The function for power is given, and the definition for cost of transport is clearly stated. There are no contradictions in the provided data.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically grounded, well-posed, objective, and complete. It is therefore **valid**. A solution will be derived.\n\nThe solution proceeds in two parts as requested.\n\n**Part 1: Speed for Minimum Power ($v_{mp}$)**\n\nThe metabolic power $P$ as a function of airspeed $v$ is given by:\n$$P(v) = \\frac{0.6}{v} + 0.02\\,v^{3} + 1.2\\,v$$\nTo find the speed that minimizes this power requirement, we must find the derivative of $P(v)$ with respect to $v$ and set it to zero. This identifies the critical points of the function.\n$$ \\frac{dP}{dv} = \\frac{d}{dv} \\left( 0.6\\,v^{-1} + 0.02\\,v^{3} + 1.2\\,v \\right) $$\n$$ \\frac{dP}{dv} = -0.6\\,v^{-2} + 3(0.02)v^{2} + 1.2 $$\n$$ \\frac{dP}{dv} = -\\frac{0.6}{v^2} + 0.06\\,v^2 + 1.2 $$\nSetting the derivative to zero to find the extremum:\n$$ -\\frac{0.6}{v^2} + 0.06\\,v^2 + 1.2 = 0 $$\nSince flight speed $v$ must be positive, we can multiply the entire equation by $v^2$:\n$$ -0.6 + 0.06\\,v^4 + 1.2\\,v^2 = 0 $$\nRearranging gives a quartic equation in $v$, which is a quadratic equation in $v^2$:\n$$ 0.06\\,v^4 + 1.2\\,v^2 - 0.6 = 0 $$\nLet $x = v^2$. The equation becomes:\n$$ 0.06\\,x^2 + 1.2\\,x - 0.6 = 0 $$\nWe solve for $x$ using the quadratic formula, $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a = 0.06$, $b = 1.2$, and $c = -0.6$:\n$$ x = \\frac{-1.2 \\pm \\sqrt{(1.2)^2 - 4(0.06)(-0.6)}}{2(0.06)} $$\n$$ x = \\frac{-1.2 \\pm \\sqrt{1.44 + 0.144}}{0.12} $$\n$$ x = \\frac{-1.2 \\pm \\sqrt{1.584}}{0.12} $$\nSince $x = v^2$, it must be a positive real number. Therefore, we take the positive root:\n$$ v^2 = x = \\frac{-1.2 + \\sqrt{1.584}}{0.12} $$\nCalculating the numerical value:\n$$ v^2 \\approx \\frac{-1.2 + 1.25857}{0.12} \\approx \\frac{0.05857}{0.12} \\approx 0.48808 $$\n$$ v = \\sqrt{0.48808} \\approx 0.6986\\,\\mathrm{m\\,s^{-1}} $$\nTo confirm this is a minimum, we check the sign of the second derivative, $\\frac{d^2P}{dv^2}$:\n$$ \\frac{d^2P}{dv^2} = \\frac{d}{dv} \\left( -0.6\\,v^{-2} + 0.06\\,v^2 + 1.2 \\right) = 1.2\\,v^{-3} + 0.12\\,v = \\frac{1.2}{v^3} + 0.12\\,v $$\nFor any positive $v$, both terms are positive, so $\\frac{d^2P}{dv^2} > 0$. The extremum is a minimum.\nRounding to three significant figures, the speed for minimum power is $v_{mp} \\approx 0.699\\,\\mathrm{m\\,s^{-1}}$.\n\n**Part 2: Speed for Minimum Cost of Transport ($v_{mr}$)**\n\nThe Cost of Transport (COT) is defined as the metabolic energy $E$ expended per unit body weight $W$ per unit distance traveled $d$:\n$$ \\mathrm{COT} = \\frac{E}{W \\cdot d} $$\nFor steady flight at speed $v$ over a time interval $t$, the energy expended is $E = P(v) \\cdot t$ and the distance traveled is $d = v \\cdot t$. The body weight is $W = m \\cdot g$, where $m$ is the mass and $g$ is the acceleration due to gravity.\nSubstituting these into the COT definition:\n$$ \\mathrm{COT}(v) = \\frac{P(v) \\cdot t}{(m \\cdot g) \\cdot (v \\cdot t)} = \\frac{P(v)}{mgv} $$\nTo find the speed that minimizes the COT, we need to find the minimum of the function $\\mathrm{COT}(v)$. Since $m$ and $g$ are positive constants, minimizing $\\mathrm{COT}(v)$ is equivalent to minimizing the function $C(v) = \\frac{P(v)}{v}$.\n$$ C(v) = \\frac{1}{v} \\left( \\frac{0.6}{v} + 0.02\\,v^{3} + 1.2\\,v \\right) $$\n$$ C(v) = \\frac{0.6}{v^2} + 0.02\\,v^2 + 1.2 = 0.6\\,v^{-2} + 0.02\\,v^2 + 1.2 $$\nTo find the minimum, we differentiate $C(v)$ with respect to $v$ and set the result to zero:\n$$ \\frac{dC}{dv} = \\frac{d}{dv} \\left( 0.6\\,v^{-2} + 0.02\\,v^2 + 1.2 \\right) $$\n$$ \\frac{dC}{dv} = -2(0.6)v^{-3} + 2(0.02)v = -1.2\\,v^{-3} + 0.04\\,v $$\nSetting the derivative to zero:\n$$ - \\frac{1.2}{v^3} + 0.04\\,v = 0 $$\n$$ 0.04\\,v = \\frac{1.2}{v^3} $$\n$$ 0.04\\,v^4 = 1.2 $$\n$$ v^4 = \\frac{1.2}{0.04} = 30 $$\n$$ v = (30)^{1/4} $$\nCalculating the numerical value:\n$$ v \\approx 2.3403\\,\\mathrm{m\\,s^{-1}} $$\nTo confirm a minimum, we check the second derivative, $\\frac{d^2C}{dv^2}$:\n$$ \\frac{d^2C}{dv^2} = \\frac{d}{dv} \\left( -1.2\\,v^{-3} + 0.04\\,v \\right) = 3.6\\,v^{-4} + 0.04 = \\frac{3.6}{v^4} + 0.04 $$\nFor any positive $v$, $\\frac{d^2C}{dv^2}$ is positive, so the extremum is a minimum.\nRounding to three significant figures, the speed for minimum cost of transport is $v_{mr} \\approx 2.34\\,\\mathrm{m\\,s^{-1}}$.\n\nThe two requested speeds are approximately $0.699\\,\\mathrm{m\\,s^{-1}}$ and $2.34\\,\\mathrm{m\\,s^{-1}}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.699  2.34\n\\end{pmatrix}\n}\n$$", "id": "2595962"}, {"introduction": "Directly measuring metabolic rate or assuming a constant optimal speed for a wild, migrating animal over its entire journey is often impractical. The heart rate method offers a powerful solution, using a lab-derived calibration to estimate oxygen consumption from heart rate data logged in the field. This advanced computational practice [@problem_id:2595955] guides you through a full data analysis workflow, from fitting a linear model to calibration data to integrating a complex, long-term heart rate signal to calculate the total energetic cost of an entire migratory bout.", "problem": "You are given laboratory calibration data linking heart rate (HR) to the volume rate of oxygen consumption ($\\dot V O_2$) for individual animals, and you must apply these calibrations to synthetic field heart rate time series over a continuous migratory bout of duration $48\\,\\mathrm{h}$. Your task is to estimate total energy expenditure by integrating predicted oxygen consumption over time and converting oxygen to energy using a fixed energy equivalent per liter of oxygen. Use only fundamentals: the linearity between cardiac activity and oxygen consumption in a submaximal range as an empirical approximation derived by least-squares fitting, conservation of mass for oxygen flux, and time integration of a rate. Treat $\\dot V O_2$ as non-negative due to the non-negativity of gas fluxes.\n\nFundamental bases to use:\n- Mass balance for oxygen: instantaneous metabolic energy rate is proportional to the rate of oxygen consumption.\n- Empirical linear approximation in the tested range: fit a first-order model mapping heart rate to oxygen consumption using ordinary least squares on the provided laboratory pairs.\n- Time integration: total oxygen consumed is the time integral of $\\dot V O_2(t)$; total energy is oxygen consumed times the oxygen energy equivalent.\n\nGeneral computational procedure to implement for each test case:\n1. Fit a first-order model mapping heart rate in $\\mathrm{bpm}$ to $\\dot V O_2$ in $\\mathrm{L\\,min^{-1}}$ using ordinary least squares on the provided laboratory calibration pairs. Do not assume any intercept or slope a priori; estimate them from the data.\n2. Synthesize a $48\\,\\mathrm{h}$ heart rate time series at fixed sampling interval $\\Delta t = 60\\,\\mathrm{s}$ using the specified deterministic rule:\n   - Let $t$ denote elapsed time in minutes, with $t \\in \\{0,1,2,\\dots,2880-1\\}$.\n   - The baseline-plus-oscillation model is\n     $$\\mathrm{HR}(t) = H_{\\mathrm{base}} + A_{\\mathrm{circ}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{1440} + \\phi\\Big) + A_{\\mathrm{fast}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{P_{\\mathrm{fast}}}\\Big),$$\n     where the arguments of $\\sin$ are in radians, $H_{\\mathrm{base}}$ is in $\\mathrm{bpm}$, $A_{\\mathrm{circ}}$ and $A_{\\mathrm{fast}}$ are in $\\mathrm{bpm}$, $P_{\\mathrm{fast}}$ is in minutes, and $\\phi$ is in radians.\n   - Apply any specified override intervals: for each interval $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$ in minutes, set $\\mathrm{HR}(t)$ to the provided constant override value (in $\\mathrm{bpm}$) for all integer $t$ in that interval.\n   - Apply any specified missing intervals: for each interval $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$ in minutes, set $\\mathrm{HR}(t)$ to missing. Then perform linear interpolation over time to fill missing values using adjacent non-missing neighbors. If missing values occur at the beginning or end of the series, fill them with the nearest available non-missing value.\n3. Using the fitted first-order model, predict $\\dot V O_2(t)$ in $\\mathrm{L\\,min^{-1}}$ from $\\mathrm{HR}(t)$ for each minute. Enforce the physical constraint $\\dot V O_2(t) \\ge 0$ by clipping negative predictions to $0$.\n4. Compute total oxygen consumed over $48\\,\\mathrm{h}$ by discrete-time integration with $\\Delta t = 60\\,\\mathrm{s}$ (that is, $\\Delta t = 1\\,\\mathrm{min}$):\n   $$V_{\\mathrm{O_2,tot}} = \\sum_{t=0}^{2880-1} \\dot V O_2(t)\\,\\Delta t_{\\mathrm{min}},$$\n   where $\\Delta t_{\\mathrm{min}} = 1\\,\\mathrm{min}$.\n5. Convert to total energy expenditure using the oxygen energy equivalent $E_{\\mathrm{O_2}}$ (in $\\mathrm{kJ\\,L^{-1}}$):\n   $$E_{\\mathrm{tot}} = V_{\\mathrm{O_2,tot}} \\times E_{\\mathrm{O_2}} \\quad \\text{in } \\mathrm{kJ}.$$\n6. Report each test caseâ€™s $E_{\\mathrm{tot}}$ as a floating-point number in $\\mathrm{kJ}$ rounded to exactly three decimal places.\n\nAngle unit requirement: all trigonometric arguments are in radians.\n\nOutput format requirement: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x,y,z]\"), in the order of the test cases below.\n\nTest suite (three cases):\n\n- Test case $1$ (small migratory shorebird):\n  - Laboratory calibration pairs $(\\mathrm{HR}, \\dot V O_2)$ with $\\mathrm{HR}$ in $\\mathrm{bpm}$ and $\\dot V O_2$ in $\\mathrm{L\\,min^{-1}}$:\n    $$\\{(360,0.20),(400,0.28),(440,0.37),(480,0.47),(520,0.58),(560,0.70)\\}.$$\n  - Oxygen energy equivalent: $E_{\\mathrm{O_2}} = 20.1\\,\\mathrm{kJ\\,L^{-1}}$.\n  - Time series parameters: $H_{\\mathrm{base}}=420\\,\\mathrm{bpm}$, $A_{\\mathrm{circ}}=40\\,\\mathrm{bpm}$, $A_{\\mathrm{fast}}=20\\,\\mathrm{bpm}$, $P_{\\mathrm{fast}}=30\\,\\mathrm{min}$, $\\phi=0\\,\\mathrm{rad}$.\n  - Overrides: none.\n  - Missing intervals (minutes, inclusive of start and exclusive of end): $[360,370)$ and $[2160,2170)$.\n\n- Test case $2$ (adult seal with bradycardic dives):\n  - Laboratory calibration pairs $(\\mathrm{HR}, \\dot V O_2)$ with $\\mathrm{HR}$ in $\\mathrm{bpm}$ and $\\dot V O_2$ in $\\mathrm{L\\,min^{-1}}$:\n    $$\\{(40,0.30),(50,0.45),(60,0.62),(70,0.80),(80,1.00),(90,1.22)\\}.$$\n  - Oxygen energy equivalent: $E_{\\mathrm{O_2}} = 19.6\\,\\mathrm{kJ\\,L^{-1}}$.\n  - Time series parameters: $H_{\\mathrm{base}}=55\\,\\mathrm{bpm}$, $A_{\\mathrm{circ}}=10\\,\\mathrm{bpm}$, $A_{\\mathrm{fast}}=15\\,\\mathrm{bpm}$, $P_{\\mathrm{fast}}=45\\,\\mathrm{min}$, $\\phi=\\pi/6\\,\\mathrm{rad}$.\n  - Overrides (minutes, inclusive of start and exclusive of end, constant $\\mathrm{HR}$ in $\\mathrm{bpm}$):\n    - $[300,310)$ with override $\\mathrm{HR}=15$,\n    - $[1140,1150)$ with override $\\mathrm{HR}=15$,\n    - $[1500,1510)$ with override $\\mathrm{HR}=15$,\n    - $[2220,2230)$ with override $\\mathrm{HR}=15$.\n  - Missing intervals: $[720,780)$.\n\n- Test case $3$ (migrating salmon):\n  - Laboratory calibration pairs $(\\mathrm{HR}, \\dot V O_2)$ with $\\mathrm{HR}$ in $\\mathrm{bpm}$ and $\\dot V O_2$ in $\\mathrm{L\\,min^{-1}}$:\n    $$\\{(30,0.08),(40,0.11),(50,0.15),(60,0.20),(70,0.26),(80,0.33)\\}.$$\n  - Oxygen energy equivalent: $E_{\\mathrm{O_2}} = 20.9\\,\\mathrm{kJ\\,L^{-1}}$.\n  - Time series parameters: $H_{\\mathrm{base}}=50\\,\\mathrm{bpm}$, $A_{\\mathrm{circ}}=8\\,\\mathrm{bpm}$, $A_{\\mathrm{fast}}=10\\,\\mathrm{bpm}$, $P_{\\mathrm{fast}}=20\\,\\mathrm{min}$, $\\phi=\\pi/4\\,\\mathrm{rad}$.\n  - Overrides:\n    - $[1440,1460)$ with override $\\mathrm{HR}=20$.\n  - Missing intervals: none.\n\nIntegration and units:\n- Use $\\Delta t = 60\\,\\mathrm{s} = 1\\,\\mathrm{min}$.\n- Express each final energy expenditure in $\\mathrm{kJ}$, rounded to exactly three decimal places.\n\nYour program should produce a single line of output containing the three rounded energy expenditures in order as a comma-separated list enclosed in square brackets, for example, \"[e1,e2,e3]\".", "solution": "The problem statement has been submitted for validation.\n\nStep 1: Extract Givens\nThe problem provides the following data and procedures for each of three test cases:\n1.  A set of laboratory calibration pairs of heart rate ($\\mathrm{HR}$ in $\\mathrm{bpm}$) and volume rate of oxygen consumption ($\\dot V O_2$ in $\\mathrm{L\\,min^{-1}}$).\n2.  An oxygen energy equivalent, $E_{\\mathrm{O_2}}$, in $\\mathrm{kJ\\,L^{-1}}$.\n3.  Parameters for a deterministic heart rate time series model over a duration of $48\\,\\mathrm{h}$ with a time step of $\\Delta t = 1\\,\\mathrm{min}$. The model is:\n    $$\\mathrm{HR}(t) = H_{\\mathrm{base}} + A_{\\mathrm{circ}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{1440} + \\phi\\Big) + A_{\\mathrm{fast}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{P_{\\mathrm{fast}}}\\Big)$$\n    where $t$ is time in minutes.\n4.  A set of override intervals $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$, during which $\\mathrm{HR}(t)$ is set to a specified constant value.\n5.  A set of missing data intervals $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$, which are to be filled via linear interpolation.\n6.  The explicit computational procedure:\n    a. Fit a first-order model, $\\dot V O_2 = m \\cdot \\mathrm{HR} + c$, using ordinary least squares on the calibration data.\n    b. Synthesize the $\\mathrm{HR}(t)$ time series for $t \\in \\{0, 1, \\dots, 2879\\}$.\n    c. Apply overrides, then fill missing data intervals.\n    d. Predict $\\dot V O_2(t)$ from the final $\\mathrm{HR}(t)$ series using the fitted model.\n    e. Enforce the non-negativity constraint by clipping predicted $\\dot V O_2(t)$ values at $0$.\n    f. Compute total oxygen consumed, $V_{\\mathrm{O_2,tot}}$, by discrete time integration: $V_{\\mathrm{O_2,tot}} = \\sum_{t=0}^{2879} \\dot V O_2(t)\\,\\cdot (1\\,\\mathrm{min})$.\n    g. Compute total energy expenditure, $E_{\\mathrm{tot}}$, as $E_{\\mathrm{tot}} = V_{\\mathrm{O_2,tot}} \\times E_{\\mathrm{O_2}}$.\n    h. Report $E_{\\mathrm{tot}}$ in $\\mathrm{kJ}$, rounded to three decimal places.\n\nThe specific parameters for all three test cases (shorebird, seal, salmon) are provided in full detail.\n\nStep 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on core principles of physiological bioenergetics. The relationship between heart rate and oxygen consumption (a proxy for metabolic rate) is a cornerstone of ecological physiology, often termed the \"heart rate method.\" The use of a linear model is a standard empirical approximation. The conversion from oxygen volume to energy via an oxycaloric equivalent is a fundamental application of stoichiometry and thermodynamics in biology. The parameters provided for the different species are physiologically plausible. The problem is scientifically sound.\n- **Well-Posed**: The problem is exceptionally well-posed. It provides all necessary data, specifies a deterministic computational algorithm, and defines all terms and boundary conditions, including the handling of missing data. This structure ensures that a unique and stable solution exists for each test case.\n- **Objective**: The problem statement is purely quantitative and procedural. It is free of any subjective, ambiguous, or opinion-based language.\n- **Completeness and Consistency**: The problem is self-contained and internally consistent. All required parameters are specified for each test case, and units are used consistently throughout ($\\mathrm{bpm}$, $\\mathrm{L\\,min^{-1}}$, $\\mathrm{min}$, $\\mathrm{h}$, $\\mathrm{kJ\\,L^{-1}}$).\n- **Other Flaws**: The problem is not trivial, as it requires the correct implementation and sequencing of several distinct computational tasks (regression, time series synthesis, data imputation, integration). It is not metaphorical, unfeasible, or unverifiable.\n\nStep 3: Verdict and Action\nThe problem is valid. It is a well-structured exercise in computational bioenergetics that adheres to established scientific principles. A solution will be provided.\n\nThe solution proceeds by precisely implementing the specified computational procedure for each test case.\n\n**1. Estimation of the $\\dot V O_2$-HR Relationship**\nFor each animal, we are given a set of $n$ calibration data points $(\\mathrm{HR}_i, \\dot V O_{2,i})$. We approximate the relationship between these variables with a first-order polynomial, or linear model:\n$$ \\dot V O_2(\\mathrm{HR}) = m \\cdot \\mathrm{HR} + c $$\nThe parameters, slope $m$ and intercept $c$, are determined using ordinary least squares (OLS) regression. OLS minimizes the sum of the squared residuals between the observed oxygen consumption rates and the rates predicted by the model. The explicit formulas for $m$ and $c$ are:\n$$ m = \\frac{n(\\sum \\mathrm{HR}_i \\dot V O_{2,i}) - (\\sum \\mathrm{HR}_i)(\\sum \\dot V O_{2,i})}{n(\\sum \\mathrm{HR}_i^2) - (\\sum \\mathrm{HR}_i)^2} $$\n$$ c = \\bar{\\dot V O_2} - m \\cdot \\overline{\\mathrm{HR}} $$\nwhere $\\bar{\\dot V O_2}$ and $\\overline{\\mathrm{HR}}$ are the sample means. Computationally, this is efficiently handled by numerical libraries.\n\n**2. Synthesis of the Heart Rate Time Series**\nA discrete time vector $t$ is generated for the $48\\,\\mathrm{h}$ migratory bout. The total duration is $48\\,\\mathrm{h} \\times 60\\,\\mathrm{min\\,h^{-1}} = 2880\\,\\mathrm{min}$. With a time step of $\\Delta t=1\\,\\mathrm{min}$, the time vector is $t = \\{0, 1, 2, \\dots, 2879\\}$.\nThe heart rate at each time point, $\\mathrm{HR}(t)$, is calculated using the provided deterministic model:\n$$ \\mathrm{HR}(t) = H_{\\mathrm{base}} + A_{\\mathrm{circ}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{T_{\\mathrm{day}}} + \\phi\\Big) + A_{\\mathrm{fast}} \\,\\sin\\!\\Big(2\\pi\\,\\frac{t}{P_{\\mathrm{fast}}}\\Big) $$\nwhere the period of the circadian rhythm is $T_{\\mathrm{day}} = 1440\\,\\mathrm{min}$ (i.e., $24\\,\\mathrm{h}$). All parameters ($H_{\\mathrm{base}}$, $A_{\\mathrm{circ}}$, $A_{\\mathrm{fast}}$, $P_{\\mathrm{fast}}$, $\\phi$) are specified for each case.\n\n**3. Data Preprocessing: Overrides and Missing Values**\nThe synthesized $\\mathrm{HR}(t)$ series is modified according to the problem specification.\n- **Overrides**: For each specified interval $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$, the values of $\\mathrm{HR}(t)$ for $t$ from $t_{\\mathrm{start}}$ to $t_{\\mathrm{end}}-1$ are replaced with the given constant override value. This step must precede the handling of missing data.\n- **Missing Values**: For each interval $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$, the values of $\\mathrm{HR}(t)$ are marked as missing (e.g., using a `NaN` flag). Subsequently, these missing values are filled using linear interpolation based on the adjacent non-missing data points. For missing segments at the beginning or end of the time series, a constant value equal to the nearest valid data point is used for extrapolation, a standard behavior of numerical interpolation routines.\n\n**4. Prediction of Oxygen Consumption Rate**\nUsing the final, processed $\\mathrm{HR}(t)$ time series and the parameters $m$ and $c$ from the OLS fit, the instantaneous oxygen consumption rate, $\\dot V O_2(t)$, is predicted for each time point:\n$$ \\dot V O_2^{\\text{pred}}(t) = m \\cdot \\mathrm{HR}(t) + c $$\nA critical physical constraint is that oxygen consumption cannot be negative. Therefore, any predicted negative values are clipped to zero:\n$$ \\dot V O_2(t) = \\max(0, \\dot V O_2^{\\text{pred}}(t)) $$\n\n**5. Integration of Total Oxygen Consumption**\nThe total volume of oxygen consumed over the entire $48\\,\\mathrm{h}$ period, $V_{\\mathrm{O_2,tot}}$, is the definite integral of the rate $\\dot V O_2(t)$ over time. For discrete time series with a constant time step $\\Delta t$, this integral is approximated by a Riemann sum:\n$$ V_{\\mathrm{O_2,tot}} = \\int_{0}^{2880} \\dot V O_2(t) \\,dt \\approx \\sum_{t=0}^{2879} \\dot V O_2(t) \\cdot \\Delta t $$\nGiven $\\Delta t = 1\\,\\mathrm{min}$, the total volume in liters is simply the sum of all $\\dot V O_2(t)$ values (in $\\mathrm{L\\,min^{-1}}$).\n$$ V_{\\mathrm{O_2,tot}} [\\mathrm{L}] = \\sum_{t=0}^{2879} \\dot V O_2(t) [\\mathrm{L\\,min^{-1}}] \\cdot (1\\,\\mathrm{min}) $$\n\n**6. Calculation of Total Energy Expenditure**\nThe final step is to convert the total volume of oxygen consumed into total energy expenditure, $E_{\\mathrm{tot}}$, using the provided species-specific oxycaloric equivalent, $E_{\\mathrm{O_2}}$ (in $\\mathrm{kJ\\,L^{-1}}$). This is a direct application of the law of conservation of energy as applied to metabolic processes:\n$$ E_{\\mathrm{tot}} [\\mathrm{kJ}] = V_{\\mathrm{O_2,tot}} [\\mathrm{L}] \\times E_{\\mathrm{O_2}} [\\mathrm{kJ\\,L^{-1}}] $$\nThe final result for each case is rounded to three decimal places as required.\nThis complete procedure is applied independently to each of the three test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for total energy expenditure for three test cases based on\n    laboratory calibration data and synthetic field heart rate time series.\n    \"\"\"\n    \n    test_cases = [\n        # Test case 1 (small migratory shorebird)\n        {\n            \"name\": \"shorebird\",\n            \"calibration_hr\": np.array([360, 400, 440, 480, 520, 560]),\n            \"calibration_vo2\": np.array([0.20, 0.28, 0.37, 0.47, 0.58, 0.70]),\n            \"e_o2\": 20.1,\n            \"ts_params\": {\"h_base\": 420, \"a_circ\": 40, \"a_fast\": 20, \"p_fast\": 30, \"phi\": 0},\n            \"overrides\": [],\n            \"missing\": [(360, 370), (2160, 2170)],\n        },\n        # Test case 2 (adult seal with bradycardic dives)\n        {\n            \"name\": \"seal\",\n            \"calibration_hr\": np.array([40, 50, 60, 70, 80, 90]),\n            \"calibration_vo2\": np.array([0.30, 0.45, 0.62, 0.80, 1.00, 1.22]),\n            \"e_o2\": 19.6,\n            \"ts_params\": {\"h_base\": 55, \"a_circ\": 10, \"a_fast\": 15, \"p_fast\": 45, \"phi\": np.pi / 6},\n            \"overrides\": [\n                (300, 310, 15),\n                (1140, 1150, 15),\n                (1500, 1510, 15),\n                (2220, 2230, 15),\n            ],\n            \"missing\": [(720, 780)],\n        },\n        # Test case 3 (migrating salmon)\n        {\n            \"name\": \"salmon\",\n            \"calibration_hr\": np.array([30, 40, 50, 60, 70, 80]),\n            \"calibration_vo2\": np.array([0.08, 0.11, 0.15, 0.20, 0.26, 0.33]),\n            \"e_o2\": 20.9,\n            \"ts_params\": {\"h_base\": 50, \"a_circ\": 8, \"a_fast\": 10, \"p_fast\": 20, \"phi\": np.pi / 4},\n            \"overrides\": [(1440, 1460, 20)],\n            \"missing\": [],\n        },\n    ]\n\n    results = []\n    \n    # Constants for time series generation\n    duration_min = 48 * 60\n    t = np.arange(duration_min, dtype=float) # time in minutes\n    t_day_period = 1440.0 # minutes in 24 hours\n\n    for case in test_cases:\n        # Step 1: Fit a first-order model using ordinary least squares\n        hr_calib = case[\"calibration_hr\"]\n        vo2_calib = case[\"calibration_vo2\"]\n        m, c = np.polyfit(hr_calib, vo2_calib, 1)\n\n        # Step 2: Synthesize the heart rate time series\n        params = case[\"ts_params\"]\n        h_base = params[\"h_base\"]\n        a_circ = params[\"a_circ\"]\n        a_fast = params[\"a_fast\"]\n        p_fast = params[\"p_fast\"]\n        phi = params[\"phi\"]\n        \n        hr_series = (h_base +\n                     a_circ * np.sin(2 * np.pi * t / t_day_period + phi) +\n                     a_fast * np.sin(2 * np.pi * t / p_fast))\n\n        # Step 3: Apply overrides and handle missing data\n        # Apply overrides first\n        for start, end, val in case[\"overrides\"]:\n            hr_series[start:end] = val\n            \n        # Mark missing intervals with NaN\n        if case[\"missing\"]:\n            for start, end in case[\"missing\"]:\n                hr_series[start:end] = np.nan\n            \n            # Perform linear interpolation to fill NaN values\n            is_nan = np.isnan(hr_series)\n            non_nan_indices = np.where(~is_nan)[0]\n            non_nan_values = hr_series[~is_nan]\n            nan_indices = np.where(is_nan)[0]\n            hr_series[is_nan] = np.interp(nan_indices, non_nan_indices, non_nan_values)\n\n        # Step 3: Predict VO2 from HR\n        vo2_predicted = m * hr_series + c\n        \n        # Enforce non-negativity constraint\n        vo2_final = np.maximum(0, vo2_predicted)\n\n        # Step 4: Compute total oxygen consumed by discrete-time integration\n        # Since delta_t is 1 min, the total volume is the sum of the rates\n        v_o2_total = np.sum(vo2_final)\n\n        # Step 5: Convert to total energy expenditure\n        e_total = v_o2_total * case[\"e_o2\"]\n\n        # Step 6: Round to three decimal places and store\n        results.append(round(e_total, 3))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2595955"}]}