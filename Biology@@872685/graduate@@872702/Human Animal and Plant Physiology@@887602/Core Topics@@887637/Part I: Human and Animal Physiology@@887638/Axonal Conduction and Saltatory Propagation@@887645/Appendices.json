{"hands_on_practices": [{"introduction": "To understand how signals travel along an axon, we first model a small patch of its membrane as a simple electrical circuit. This foundational exercise [@problem_id:2550631] guides you through deriving the basic passive electrical properties—capacitance and resistance—from the axon's geometry. By combining these, you will calculate the membrane time constant, $\\tau_m$, and discover a fundamental principle about how it relates to the axon's physical dimensions.", "problem": "An unmyelinated axon is well approximated by a right circular cylinder of radius $a$. The membrane can be modeled, per unit area, as a pure capacitance with specific membrane capacitance $c_m$ (in $\\mathrm{F}\\,\\mathrm{m}^{-2}$) in parallel with an ohmic conductance with specific membrane conductance $g_m$ (in $\\mathrm{S}\\,\\mathrm{m}^{-2}$). Consider a unit length of the axon along its long axis, and treat the membrane elements across this unit length as being connected in parallel with respect to transmembrane current.\n\nStarting only from the definitions that (i) capacitance across a membrane patch is $C = c_m \\times \\text{area}$, (ii) conductance across a membrane patch is $G = g_m \\times \\text{area}$, (iii) resistance is the reciprocal of conductance, and (iv) the area of the lateral surface of a cylinder per unit length is its circumference, use geometry and these definitions to derive expressions for the per-unit-length membrane capacitance $c_m^{\\ell}$, the per-unit-length membrane resistance $r_m^{\\ell}$, and the membrane resistance–capacitance time constant per unit length $\\tau_m = r_m^{\\ell} c_m^{\\ell}$. Your derivation should make explicit any geometric dependence and then simplify to reveal any parameter independence that emerges.\n\nThen, for a specific axon with radius $a = 0.80\\,\\mu\\mathrm{m}$, specific membrane capacitance $c_m = 0.010\\,\\mathrm{F}\\,\\mathrm{m}^{-2}$, and specific membrane conductance $g_m = 1.20\\,\\mathrm{S}\\,\\mathrm{m}^{-2}$ at a fixed temperature, evaluate the numerical value of $\\tau_m$ implied by your derived expression. Express the final answer in $\\mathrm{s}$, and round your answer to four significant figures. Only the numerical value should be provided as the final answer.", "solution": "The problem statement presented is valid. It is scientifically grounded in the principles of biophysical modeling of neurons, specifically cable theory. The definitions, parameters, and objectives are well-posed, objective, and internally consistent, allowing for a rigorous derivation and calculation.\n\nWe begin by establishing the geometry of the system. The axon is modeled as a right circular cylinder of radius $a$. The problem asks for per-unit-length parameters. Consider a differential segment of the axon of length $\\Delta z$. The lateral surface area of this cylindrical segment is given by $A = 2\\pi a \\Delta z$. The problem defines the area per unit length as the circumference, which is $2\\pi a$.\n\nFirst, we derive the expression for the per-unit-length membrane capacitance, $c_m^{\\ell}$. According to the provided definition (i), the total capacitance $C$ of a membrane patch is the product of the specific membrane capacitance $c_m$ and the area of the patch. For our segment of length $\\Delta z$, the capacitance is:\n$$C_{\\Delta z} = c_m \\times A = c_m (2\\pi a \\Delta z)$$\nThe per-unit-length capacitance, denoted $c_m^{\\ell}$, is the capacitance of the segment divided by its length.\n$$c_m^{\\ell} = \\frac{C_{\\Delta z}}{\\Delta z} = \\frac{c_m (2\\pi a \\Delta z)}{\\Delta z}$$\nThis simplifies to:\n$$c_m^{\\ell} = 2\\pi a c_m$$\nThe units of $c_m^{\\ell}$ are $(\\mathrm{F}\\,\\mathrm{m}^{-2}) \\times \\mathrm{m} = \\mathrm{F}\\,\\mathrm{m}^{-1}$, which is appropriate for capacitance per unit length.\n\nNext, we derive the expression for the per-unit-length membrane resistance, $r_m^{\\ell}$. According to definition (ii), the total conductance $G$ of a membrane patch is the product of the specific membrane conductance $g_m$ and the area. For the segment of length $\\Delta z$, the membrane conductance is:\n$$G_{\\Delta z} = g_m \\times A = g_m (2\\pi a \\Delta z)$$\nThe membrane elements are connected in parallel along the length of the axon. The total resistance of this segment, $R_{\\Delta z}$, is the reciprocal of its conductance, as per definition (iii):\n$$R_{\\Delta z} = \\frac{1}{G_{\\Delta z}} = \\frac{1}{g_m (2\\pi a \\Delta z)}$$\nThe per-unit-length resistance, $r_m^{\\ell}$, is defined in cable theory such that the resistance of a short segment of length $\\Delta z$ is $R_{\\Delta z} = \\frac{r_m^{\\ell}}{\\Delta z}$. This definition reflects that as the length of the segment increases, more parallel paths for current are available, and thus the total resistance decreases. Equating the two expressions for $R_{\\Delta z}$:\n$$\\frac{r_m^{\\ell}}{\\Delta z} = \\frac{1}{g_m (2\\pi a \\Delta z)}$$\nSolving for $r_m^{\\ell}$ yields:\n$$r_m^{\\ell} = \\frac{1}{2\\pi a g_m}$$\nThe units of $r_m^{\\ell}$ are $1 / (\\mathrm{m} \\times \\mathrm{S}\\,\\mathrm{m}^{-2}) = 1 / (\\mathrm{S}\\,\\mathrm{m}^{-1}) = \\Omega \\cdot \\mathrm{m}$, which is correct for resistance-length product.\n\nNow, we derive the membrane time constant, $\\tau_m$, defined as $\\tau_m = r_m^{\\ell} c_m^{\\ell}$. Substituting the expressions we derived for $r_m^{\\ell}$ and $c_m^{\\ell}$:\n$$\\tau_m = \\left(\\frac{1}{2\\pi a g_m}\\right) \\times \\left(2\\pi a c_m\\right)$$\nThe geometric factor $2\\pi a$, which depends on the axon radius, cancels out:\n$$\\tau_m = \\frac{c_m}{g_m}$$\nThis is a fundamental result. The membrane time constant is an intrinsic property of the membrane material, independent of the axon's geometry (radius $a$). It depends only on the specific membrane capacitance and specific membrane conductance.\n\nFinally, we are required to evaluate the numerical value of $\\tau_m$ for the given parameters: $c_m = 0.010\\,\\mathrm{F}\\,\\mathrm{m}^{-2}$ and $g_m = 1.20\\,\\mathrm{S}\\,\\mathrm{m}^{-2}$. The value of the radius, $a = 0.80\\,\\mu\\mathrm{m}$, is not needed for this calculation, as demonstrated by our derivation.\n$$\\tau_m = \\frac{0.010\\,\\mathrm{F}\\,\\mathrm{m}^{-2}}{1.20\\,\\mathrm{S}\\,\\mathrm{m}^{-2}}$$\nThe units simplify to seconds, as $\\mathrm{F}/\\mathrm{S} = (\\mathrm{C}/\\mathrm{V}) / (\\mathrm{A}/\\mathrm{V}) = (\\mathrm{C}/\\mathrm{V}) / ((\\mathrm{C}/\\mathrm{s})/\\mathrm{V}) = \\mathrm{s}$.\nPerforming the calculation:\n$$\\tau_m = \\frac{0.010}{1.20} \\, \\mathrm{s} \\approx 0.0083333... \\, \\mathrm{s}$$\nThe problem specifies rounding the answer to four significant figures. Therefore, the numerical value is $0.008333$.", "answer": "$$\\boxed{0.008333}$$", "id": "2550631"}, {"introduction": "Having established the temporal response of a membrane patch, we now explore how a voltage change spreads spatially along the axon's length. This practice [@problem_id:2550641] challenges you to apply principles of current conservation to derive the steady-state cable equation, a cornerstone of neurophysiology. From this, you will determine the axonal length constant, $\\lambda$, which quantifies the efficiency of passive voltage spread and is crucial for understanding both subthreshold integration and the propagation of action potentials.", "problem": "An unmyelinated cylindrical axon of radius $a$ is embedded in an effectively isopotential extracellular bath. The intracellular medium has resistivity $\\rho_i$ (in $\\Omega\\cdot\\mathrm{m}$), and the membrane behaves as a passive, linear leak with specific membrane conductance $g_m$ (in $\\mathrm{S}\\cdot\\mathrm{m}^{-2}$). The transmembrane potential difference is $V(x)$, defined relative to the extracellular potential. Assume steady-state conditions (no time dependence) and one-dimensional axial spread of voltage along $x$.\n\nStarting from current conservation along the cable and Ohm’s law for both axial and membrane currents, derive the one-dimensional steady relation that governs $V(x)$ and obtain the axonal length constant $\\lambda$ as a function of the intrinsic parameters $\\rho_i$, $a$, and $g_m$. You may treat the membrane current per unit area as $j_m = g_m V$ and the axial current density as $\\mathbf{j}_i = -\\frac{1}{\\rho_i}\\nabla V$.\n\nNext, evaluate the length constant numerically for an unmyelinated axon with $a = 0.50\\,\\mu\\mathrm{m}$, $\\rho_i = 0.70\\,\\Omega\\cdot\\mathrm{m}$, and $g_m = 1.50\\,\\mathrm{S}\\cdot\\mathrm{m}^{-2}$. Express the final length constant in millimeters and round your answer to three significant figures.", "solution": "The problem statement is found to be scientifically grounded, well-posed, and complete. It presents a standard problem in biophysical cable theory. We will therefore proceed with its solution.\n\nThe objective is to derive the steady-state cable equation for the transmembrane potential $V(x)$ and determine the characteristic length constant $\\lambda$. The derivation begins from the principle of current conservation in- a small, cylindrical segment of the axon of length $\\Delta x$.\n\nLet the radius of the axon be $a$. The cross-sectional area for axial current flow is $A = \\pi a^2$. The intracellular medium has resistivity $\\rho_i$. The axial current, $I_i(x)$, is related to the axial electric field by Ohm's law. In one dimension, the axial current density is $j_{i,x} = -\\frac{1}{\\rho_i}\\frac{dV}{dx}$. The total axial current is the product of the current density and the cross-sectional area:\n$$I_i(x) = A \\cdot j_{i,x} = (\\pi a^2) \\left(-\\frac{1}{\\rho_i}\\frac{dV}{dx}\\right) = -\\frac{\\pi a^2}{\\rho_i}\\frac{dV}{dx}$$\n\nThe current that leaks out across the membrane is the membrane current, $I_m$. The membrane has a specific conductance $g_m$ (conductance per unit area). The membrane current density, $j_m$, is given by $j_m = g_m V(x)$, where $V(x)$ is the transmembrane potential. For a segment of the axon of length $\\Delta x$, the membrane surface area is $\\Delta A_m = 2\\pi a \\Delta x$. The total current leaking out through this segment is:\n$$\\Delta I_m = j_m \\cdot \\Delta A_m = g_m V(x) \\cdot (2\\pi a \\Delta x)$$\nIn the limit $\\Delta x \\to 0$, we define the membrane current per unit length, $i_m$, as:\n$$i_m(x) = \\frac{dI_m}{dx} = 2\\pi a g_m V(x)$$\n\nUnder steady-state conditions, there is no accumulation of charge. By Kirchhoff's current law, the change in axial current over the segment $\\Delta x$ must be equal to the current leaking out through the membrane of that segment.\n$$I_i(x) - I_i(x + \\Delta x) = \\Delta I_m$$\nDividing by $\\Delta x$ and taking the limit as $\\Delta x \\to 0$, we get:\n$$-\\frac{dI_i}{dx} = i_m$$\n\nNow, we substitute the expressions for $I_i(x)$ and $i_m(x)$ into this conservation equation. First, we differentiate the expression for $I_i(x)$ with respect to $x$:\n$$\\frac{dI_i}{dx} = \\frac{d}{dx}\\left(-\\frac{\\pi a^2}{\\rho_i}\\frac{dV}{dx}\\right) = -\\frac{\\pi a^2}{\\rho_i}\\frac{d^2V}{dx^2}$$\nSubstituting this and the expression for $i_m$ into the conservation law gives:\n$$-\\left(-\\frac{\\pi a^2}{\\rho_i}\\frac{d^2V}{dx^2}\\right) = 2\\pi a g_m V(x)$$\n$$\\frac{\\pi a^2}{\\rho_i}\\frac{d^2V}{dx^2} = 2\\pi a g_m V(x)$$\n\nThis is the second-order ordinary differential equation that governs the steady-state potential $V(x)$. We rearrange it to the standard form of the cable equation. Divide both sides by $2\\pi a g_m$:\n$$\\frac{a}{2 \\rho_i g_m} \\frac{d^2V}{dx^2} = V(x)$$\nOr,\n$$\\frac{a}{2 \\rho_i g_m} \\frac{d^2V}{dx^2} - V(x) = 0$$\nThe canonical form of the steady-state cable equation is written as $\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$. By comparing our derived equation with this canonical form, we can identify the square of the length constant, $\\lambda^2$, as:\n$$\\lambda^2 = \\frac{a}{2 \\rho_i g_m}$$\nTherefore, the axonal length constant $\\lambda$ is given by the expression:\n$$\\lambda = \\sqrt{\\frac{a}{2 \\rho_i g_m}}$$\nThis completes the first part of the problem.\n\nFor the second part, we must evaluate this expression numerically using the provided data. The parameters are:\n- Axon radius: $a = 0.50\\,\\mu\\mathrm{m} = 0.50 \\times 10^{-6}\\,\\mathrm{m}$\n- Intracellular resistivity: $\\rho_i = 0.70\\,\\Omega\\cdot\\mathrm{m}$\n- Specific membrane conductance: $g_m = 1.50\\,\\mathrm{S}\\cdot\\mathrm{m}^{-2}$\n\nSubstitute these values into the expression for $\\lambda$:\n$$\\lambda = \\sqrt{\\frac{0.50 \\times 10^{-6}\\,\\mathrm{m}}{2 \\cdot (0.70\\,\\Omega\\cdot\\mathrm{m}) \\cdot (1.50\\,\\mathrm{S}\\cdot\\mathrm{m}^{-2})}}$$\nFirst, we compute the value of the denominator:\n$$2 \\times 0.70 \\times 1.50 = 2.10\\,\\Omega\\cdot\\mathrm{S}\\cdot\\mathrm{m}^{-1} = 2.10\\,\\mathrm{m}^{-1}$$\nNow, we compute $\\lambda$:\n$$\\lambda = \\sqrt{\\frac{0.50 \\times 10^{-6}\\,\\mathrm{m}}{2.10\\,\\mathrm{m}^{-1}}} = \\sqrt{0.238095... \\times 10^{-6}\\,\\mathrm{m}^2}$$\n$$\\lambda = 0.48795... \\times 10^{-3}\\,\\mathrm{m}$$\nThe problem requires the answer to be expressed in millimeters. Since $1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$, we have:\n$$\\lambda = 0.48795...\\,\\mathrm{mm}$$\nFinally, we round the result to three significant figures, as requested.\n$$\\lambda \\approx 0.488\\,\\mathrm{mm}$$", "answer": "$$\\boxed{0.488}$$", "id": "2550641"}, {"introduction": "While passive cable properties govern signal decay, reliable long-distance communication in myelinated axons depends on active regeneration at the nodes of Ranvier. This advanced practice [@problem_id:2550628] models saltatory conduction as a node-to-node sequence, incorporating active regeneration, threshold, and refractoriness. Your task is to develop a computational method to determine the 'safety factor' of propagation, providing a quantitative understanding of the conditions required to prevent conduction failure and ensure the fidelity of the neural code.", "problem": "A myelinated axon conducts an Action Potential (AP) saltatorily from node to node. Model each internode as a passive cable segment that attenuates nodal depolarization by a fixed factor $a \\in (0,1)$, so that a depolarization $V_{\\text{out},j}$ produced at node $j$ arrives at node $j+1$ as $V_{\\text{in},j+1} = a \\, V_{\\text{out},j}$. Near threshold, approximate nodal spike initiation by a linearized regenerative gain: when the incoming depolarization at node $j$ exceeds threshold by $x_j = V_{\\text{in},j} - V_{\\text{th}} \\ge 0$, the node produces an output $V_{\\text{out},j} = S \\, r \\, k \\, x_j$, where $S$ is a dimensionless safety factor to be chosen, $r \\in (0,1]$ represents the fraction of available fast sodium conductance due to refractoriness after a prior spike, and $k  0$ is a dimensionless linearized gain constant reflecting nodal excitability. Assume refractoriness follows first-order recovery with time constant $\\tau_{\\text{rec}}$ and stimulation period $T$, so that the availability fraction is $r(T) = 1 - \\exp\\left(- T / \\tau_{\\text{rec}} \\right)$. Let $V_{\\text{th}}  0$ be the nodal threshold above rest and let the initial input to the first node be $V_{\\text{in},1}$ with $x_1 = V_{\\text{in},1} - V_{\\text{th}}  0$.\n\nUsing the passive cable attenuation and the linearized nodal mapping, derive from first principles the recurrence for the excess over threshold at successive nodes and obtain a numerical method to compute the minimal safety factor $S_{\\min}$ such that an AP initiated at node $1$ does not fail for $N$ consecutive internodes (i.e., the input to node $N+1$ remains at or above threshold). Your derivation must begin from the cable attenuation $V(L) = V(0) \\exp(-L/\\lambda)$ and first-order recovery of channel availability, and it must explicitly define all variables used. You must not assume any specialized shortcut formulas for saltatory conduction; use only the definitions and standard linearization near threshold.\n\nMathematically, let $x_j = V_{\\text{in},j} - V_{\\text{th}}$ denote the excess depolarization at node $j$. Show that $x_{j+1} = g \\, x_j - V_{\\text{th}}$, where $g = a \\, r \\, k \\, S$, and then solve for the minimal $S$ that ensures $x_{N+1} \\ge 0$. When $g \\ne 1$, the closed-form expression for $x_{N+1}$ is\n$$\nx_{N+1} = g^{N} x_1 - V_{\\text{th}} \\, \\frac{1 - g^{N}}{1 - g} \\, ,\n$$\nand when $g = 1$, the limit yields\n$$\nx_{N+1} = x_1 - N \\, V_{\\text{th}} \\, .\n$$\nUse these relations to design a robust root-finding algorithm for $g$ (and hence $S$) that is valid for all $g  0$, including the neighborhood of $g = 1$.\n\nPhysical and numerical units: $V_{\\text{th}}$ and $V_{\\text{in},1}$ must be provided in $\\mathrm{mV}$, $T$ and $\\tau_{\\text{rec}}$ in $\\mathrm{ms}$, and the safety factor $S$ is dimensionless. Your program must output $S_{\\min}$ as a dimensionless float rounded to six decimal places.\n\nTest suite and required output: For each of the following parameter sets, compute the minimal safety factor $S_{\\min}$ that prevents conduction failure over $N$ consecutive internodes. In each tuple, the parameters are ordered as $(N, a, V_{\\text{th}}\\,\\mathrm{[mV]}, V_{\\text{in},1}\\,\\mathrm{[mV]}, k, T\\,\\mathrm{[ms]}, \\tau_{\\text{rec}}\\,\\mathrm{[ms]})$.\n\n- Test $1$: $(5, 0.3, 15, 20, 2.0, 3.0, 2.0)$\n- Test $2$: $(10, 0.8, 10, 12, 1.2, 2.0, 1.5)$\n- Test $3$: $(3, 0.5, 10, 10.5, 1.5, 1.0, 3.0)$\n- Test $4$: $(4, 0.6, 12, 13, 1.1, 0.5, 2.5)$\n- Test $5$: $(7, 0.7, 8, 64, 0.9, 4.0, 1.0)$\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[s1,s2,s3,s4,s5]\"), where each $s_i$ is the computed $S_{\\min}$ for test $i$, rounded to six decimal places and expressed as a dimensionless float with no units.", "solution": "The problem requires the derivation of a numerical method to find the minimal safety factor, $S_{\\min}$, for successful saltatory conduction of an action potential across $N$ nodes of Ranvier. The derivation must be from first principles, based on the provided biophysical models.\n\nFirst, we establish the mathematical framework by defining all variables.\n-   $V_{\\text{in},j}$ is the input depolarization at node $j$, relative to the resting potential.\n-   $V_{\\text{out},j}$ is the output depolarization from node $j$.\n-   $V_{\\text{th}}  0$ is the constant firing threshold depolarization at each node.\n-   $x_j = V_{\\text{in},j} - V_{\\text{th}}$ is the excess depolarization above threshold at node $j$. Propagation requires $x_j \\ge 0$ for the node to fire.\n-   $a \\in (0,1)$ is the passive attenuation factor of the internodal segment.\n-   $S$ is the dimensionless safety factor.\n-   $k  0$ is a dimensionless constant representing the linearized excitability of the node.\n-   $r$ is the fraction of available sodium conductance, representing refractoriness.\n-   $T$ is the period of stimulation, and $\\tau_{\\text{rec}}$ is the time constant for recovery from refractoriness.\n-   $N$ is the number of internodes the action potential must traverse.\n\nThe derivation proceeds in three stages: modeling the system's components, deriving the recurrence relation for depolarization, and formulating the numerical problem to find $S_{\\min}$.\n\n**1. Component Models**\n\nThe problem provides three fundamental relations:\n\n-   **Internodal Attenuation:** The voltage passively attenuates along the myelinated internode from node $j$ to $j+1$. This is given by:\n    $$ V_{\\text{in},j+1} = a V_{\\text{out},j} $$\n    This relation is a discrete representation of the continuous cable equation, $V(L) = V(0) \\exp(-L/\\lambda)$, where $a$ corresponds to $\\exp(-L/\\lambda)$ for an internode of length $L$ and space constant $\\lambda$.\n\n-   **Nodal Spike Generation:** An active, regenerative response occurs at the node. For an input $V_{\\text{in},j}$ that meets or exceeds the threshold $V_{\\text{th}}$ (i.e., $x_j \\ge 0$), the node generates an output depolarization. This process is approximated by a linear relationship:\n    $$ V_{\\text{out},j} = S \\, r \\, k \\, x_j $$\n    This is a linearization of the complex, nonlinear ionic dynamics of spike generation around the firing threshold.\n\n-   **Refractoriness:** The availability of sodium channels, $r$, recovers following a spike. This is modeled as a first-order process. The governing differential equation for the fraction of non-refractory channels, $r(t)$, is $\\frac{dr}{dt} = (1-r)/\\tau_{\\text{rec}}$. Assuming a spike at $t=0$ sets $r(0)=0$, integration over a period $T$ yields the availability for the next spike:\n    $$ r(T) = 1 - \\exp(-T / \\tau_{\\text{rec}}) $$\n    For a constant stimulation period $T$, $r$ is constant for all nodes $j \\ge 1$.\n\n**2. Derivation of the Recurrence Relation**\n\nWe seek a recurrence relation for the excess depolarization, $x_j$. By definition, $x_{j+1} = V_{\\text{in},j+1} - V_{\\text{th}}$.\n\nSubstitute the internodal attenuation relation, $V_{\\text{in},j+1} = a V_{\\text{out},j}$:\n$$ x_{j+1} = a V_{\\text{out},j} - V_{\\text{th}} $$\nNext, substitute the nodal spike generation model, $V_{\\text{out},j} = S r k x_j$, under the condition that $x_j \\ge 0$:\n$$ x_{j+1} = a (S r k x_j) - V_{\\text{th}} $$\nTo simplify this expression, we introduce the composite gain parameter, $g$:\n$$ g = a \\, S \\, r \\, k $$\nThe recurrence relation is thus:\n$$ x_{j+1} = g x_j - V_{\\text{th}} $$\nThis linear recurrence describes the evolution of the suprathreshold depolarization from one node to the next. The system is stable if $g$ is sufficiently large to counteract the \"subtraction\" of $V_{\\text{th}}$ at each step.\n\n**3. Solution for Minimal Safety Factor $S_{\\min}$**\n\nSuccessful conduction across $N$ internodes implies that an action potential is generated at nodes $1, 2, \\ldots, N+1$. The critical condition for failure is at the input to node $N+1$. Conduction succeeds if $V_{\\text{in},N+1} \\ge V_{\\text{th}}$, which is equivalent to $x_{N+1} \\ge 0$. The minimal safety factor, $S_{\\min}$, corresponds to the case where $x_{N+1}=0$.\n\nThe recurrence $x_{j+1} = g x_j - V_{\\text{th}}$ can be solved by iteration:\n$x_2 = g x_1 - V_{\\text{th}}$\n$x_3 = g x_2 - V_{\\text{th}} = g(g x_1 - V_{\\text{th}}) - V_{\\text{th}} = g^2 x_1 - V_{\\text{th}}(g+1)$\nInductively, this leads to:\n$$ x_{j+1} = g^j x_1 - V_{\\text{th}} \\sum_{i=0}^{j-1} g^i $$\nThe summation is a geometric series. For $g \\neq 1$, $\\sum_{i=0}^{j-1} g^i = \\frac{g^j-1}{g-1}$. For $g=1$, the sum is $j$.\nSetting $j=N$, we obtain the expressions for $x_{N+1}$ provided in the problem statement:\n$$ x_{N+1} = \\begin{cases} g^N x_1 - V_{\\text{th}} \\frac{g^N-1}{g-1}  \\text{if } g \\neq 1 \\\\ x_1 - N V_{\\text{th}}  \\text{if } g = 1 \\end{cases} $$\nTo find the minimal safety factor, we must find the value of $g$, let us call it $g_{\\text{sol}}$, that satisfies $x_{N+1}=0$. This is a root-finding problem for the equation:\n$$ f(g) = g^N x_1 - V_{\\text{th}} \\left(\\sum_{i=0}^{N-1} g^i\\right) = 0 $$\nAs shown in the validation, a unique positive root $g_{\\text{sol}}$ exists for any valid set of parameters.\n\n**4. Numerical Algorithm Design**\n\nThe equation $f(g)=0$ is nonlinear. A numerical root-finding algorithm is required. Brent's method is an excellent choice as it combines the robustness of bisection with the speed of secant methods.\n\nA critical aspect of the implementation is the numerically stable evaluation of the geometric series sum, $\\sum_{i=0}^{N-1} g^i$. While the closed-form formula $\\frac{g^N-1}{g-1}$ is correct, it is numerically unstable near $g=1$ due to catastrophic cancellation. The problem is avoided entirely by evaluating the sum as a polynomial $P(g) = g^{N-1} + g^{N-2} + \\dots + g + 1$. A standard numerical library function for polynomial evaluation, such as `numpy.polyval`, is ideal for this purpose as it is efficient and robust for all values of $g$. The coefficients of this polynomial are all $1$.\n\nThe algorithm is as follows:\n1.  For a given set of parameters $(N, a, V_{\\text{th}}, V_{\\text{in},1}, k, T, \\tau_{\\text{rec}})$, calculate the initial excess depolarization $x_1 = V_{\\text{in},1} - V_{\\text{th}}$ and the refractory recovery fraction $r = 1 - \\exp(-T/\\tau_{\\text{rec}})$.\n2.  Define the objective function $f(g) = g^N x_1 - V_{\\text{th}} \\cdot \\text{polyval}(\\text{ones}(N), g)$.\n3.  Establish a search interval $[g_a, g_b]$ that brackets the root of $f(g)$.\n    -   The function value at $g=1$ is $f(1) = x_1 - N V_{\\text{th}}$.\n    -   If $f(1) = 0$, the root is $g_{\\text{sol}}=1$.\n    -   If $f(1)  0$, the root is in $(0,1)$, since $f(g) \\to -V_{\\text{th}}  0$ as $g \\to 0^+$. We set $[g_a, g_b] = [\\epsilon, 1]$, for a small $\\epsilon0$.\n    -   If $f(1)  0$, the root is in $(1, \\infty)$, since $f(g) \\to +\\infty$ as $g \\to \\infty$. We set $g_a=1$ and find an upper bound $g_b$ by searching, e.g., $g=2, 4, 8, \\dots$, until $f(g_b)  0$.\n4.  Use Brent's method (e.g., `scipy.optimize.brentq`) to find the root $g_{\\text{sol}}$ within the interval $[g_a, g_b]$.\n5.  Once $g_{\\text{sol}}$ is found, the minimal safety factor $S_{\\min}$ is computed by inverting the definition of $g$:\n    $$ S_{\\min} = \\frac{g_{\\text{sol}}}{a \\, k \\, r} = \\frac{g_{\\text{sol}}}{a \\, k \\, (1 - \\exp(-T / \\tau_{\\text{rec}}))} $$\nThis procedure yields a robust and accurate solution for $S_{\\min}$.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the minimal safety factor for saltatory conduction\n    across N internodes for a set of test cases.\n    \"\"\"\n\n    # Test cases: (N, a, V_th, V_in_1, k, T, tau_rec)\n    test_cases = [\n        (5, 0.3, 15, 20, 2.0, 3.0, 2.0),\n        (10, 0.8, 10, 12, 1.2, 2.0, 1.5),\n        (3, 0.5, 10, 10.5, 1.5, 1.0, 3.0),\n        (4, 0.6, 12, 13, 1.1, 0.5, 2.5),\n        (7, 0.7, 8, 64, 0.9, 4.0, 1.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N, a_param, V_th, V_in_1, k, T, tau_rec = case\n\n        # 1. Calculate preliminary constants\n        x1 = V_in_1 - V_th\n        if x1 = 0:\n            # Propagation fails at the first node, S_min is infinite.\n            # This case is excluded by the problem statement (x1  0).\n            # For robustness, we could handle it, but we follow the spec.\n            pass\n\n        r = 1 - np.exp(-T / tau_rec)\n        \n        # Denominator for final S_min calculation. Must be non-zero.\n        # Problem constraints (a, k, T, tau_rec  0) ensure this.\n        gain_constant = a_param * k * r\n\n        # 2. Define the objective function f(g) = 0\n        # We need to solve for g in: g^N * x1 - V_th * (1 + g + ... + g^(N-1)) = 0\n        # The geometric series sum is evaluated robustly using numpy.polyval.\n        poly_coeffs = np.ones(N)\n        def objective_func(g):\n            geom_sum = np.polyval(poly_coeffs, g)\n            return g**N * x1 - V_th * geom_sum\n\n        # 3. Find the root g_sol\n        # Check the special case g=1\n        f_at_1 = objective_func(1.0)\n\n        if np.isclose(f_at_1, 0):\n            g_sol = 1.0\n        else:\n            # 4. Establish a search interval [g_a, g_b] for the root-finder\n            if f_at_1  0:\n                # Root is in (0, 1). f(g) is negative near g=0.\n                g_a, g_b = 1e-9, 1.0\n            else: # f_at_1  0\n                # Root is in (1, inf).\n                g_a = 1.0\n                g_b = 2.0\n                # Find an upper bound for the root\n                while objective_func(g_b)  0:\n                    g_b *= 2.0\n                    if g_b  1e12: # Safety break\n                        raise RuntimeError(\"Failed to bracket the root. Check parameters.\")\n            \n            # 5. Use Brent's method to find the root\n            g_sol = brentq(objective_func, g_a, g_b)\n\n        # 6. Calculate S_min from g_sol\n        S_min = g_sol / gain_constant\n        \n        results.append(f\"{S_min:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2550628"}]}