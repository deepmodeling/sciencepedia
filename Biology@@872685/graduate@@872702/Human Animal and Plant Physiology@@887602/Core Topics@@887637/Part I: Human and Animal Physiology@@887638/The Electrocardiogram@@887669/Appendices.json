{"hands_on_practices": [{"introduction": "The heart's electrical activity during ventricular depolarization can be summarized by a single vector, the Mean Electrical Axis (MEA). The projections of this vector onto the axes of the different ECG leads determine the morphology of the QRS complex. This exercise provides foundational practice in vectorcardiography by challenging you to compute the MEA from measured QRS deflections in two orthogonal leads, a critical skill for ECG interpretation. [@problem_id:2615350]", "problem": "A standard 12-lead electrocardiogram (electrocardiogram (ECG)) is recorded at paper speed $25\\,\\mathrm{mm\\,s^{-1}}$ and calibration $10\\,\\mathrm{mm\\,mV^{-1}}$. In the frontal plane, you extract net QRS deflections (algebraic R amplitude minus the sum of the absolute Q and S amplitudes) from the limb leads as follows:\n\n- Lead I: peak amplitudes relative to the isoelectric baseline are $Q = 1.0\\,\\mathrm{mm}$ below baseline, $R = 11.0\\,\\mathrm{mm}$ above baseline, and $S = 2.0\\,\\mathrm{mm}$ below baseline.\n- Lead aVF (augmented voltage foot): peak amplitudes relative to the isoelectric baseline are $Q = 0.0\\,\\mathrm{mm}$, $R = 3.0\\,\\mathrm{mm}$ above baseline, and $S = 10.0\\,\\mathrm{mm}$ below baseline.\n\nTreat the mean frontal-plane QRS electrical axis (mean electrical axis (MEA)) as a fixed vector during the QRS interval whose projections onto the lead axes generate the measured net QRS deflections. Assume equal gain and linear response across leads so that relative amplitudes are preserved between leads I and aVF. Use the conventional hexaxial reference in which lead I is aligned with $0^\\circ$ and lead aVF with $+90^\\circ$, with angles increasing counterclockwise.\n\nTasks:\n1. Compute the MEA in the frontal plane in degrees by inferring the vector orientation from the measured net deflections in lead I and lead aVF. State the sign (positive or negative) of the angle according to the stated convention.\n2. Using commonly accepted thresholds, classify the axis as one of: normal (between $-30^\\circ$ and $+90^\\circ$), left axis deviation (between $-30^\\circ$ and $-90^\\circ$), or right axis deviation (between $+90^\\circ$ and $+180^\\circ$). If the angle falls outside these ranges, note it as extreme axis deviation.\n\nExpress the MEA in degrees. Round your numerical angle to four significant figures. For grading, report only the MEA angle as your final numeric answer.", "solution": "The problem requires the calculation and classification of the mean frontal-plane QRS electrical axis (MEA) from electrocardiogram (ECG) data.\n\nFirst, we must validate the problem statement.\nThe givens are:\n- Paper speed: $25\\,\\mathrm{mm\\,s^{-1}}$\n- Calibration: $10\\,\\mathrm{mm\\,mV^{-1}}$\n- Lead I deflections: $Q = 1.0\\,\\mathrm{mm}$, $R = 11.0\\,\\mathrm{mm}$, $S = 2.0\\,\\mathrm{mm}$\n- Lead aVF deflections: $Q = 0.0\\,\\mathrm{mm}$, $R = 3.0\\,\\mathrm{mm}$, $S = 10.0\\,\\mathrm{mm}$\n- Definition of net QRS deflection: Algebraic R-wave amplitude minus the sum of the absolute Q-wave and S-wave amplitudes.\n- Coordinate system: Lead I axis at $0^\\circ$, Lead aVF axis at $+90^\\circ$.\n- Task: Compute MEA in degrees and classify it.\n- Precision: Round final angle to four significant figures.\n\nThe problem is scientifically grounded, as it describes the standard vectorcardiographic approach to determining the heart's electrical axis. The provided values are physiologically plausible. The problem is well-posed, self-contained, and provides all necessary information to compute a unique solution for the angle. The information on paper speed and calibration, while not required for calculating the angle (which depends only on the ratio of deflections), does not create a contradiction and is standard contextual data for an ECG recording. Therefore, the problem is deemed valid.\n\nWe proceed to the solution.\n\nStep 1: Calculate the net QRS deflection for each lead. The net deflection, let us denote it by $V_{net}$, is given by the formula based on the amplitudes of the $Q$, $R$, and $S$ waves:\n$$V_{net} = R_{amp} - (|Q_{amp}| + |S_{amp}|)$$\nThe amplitudes are given in millimeters ($mm$).\n\nFor Lead I:\nThe amplitudes are $R_I = 11.0\\,\\mathrm{mm}$, $Q_I = 1.0\\,\\mathrm{mm}$, and $S_I = 2.0\\,\\mathrm{mm}$.\nThe net deflection in Lead I, $V_I$, is:\n$$V_I = 11.0 - (1.0 + 2.0) = 11.0 - 3.0 = 8.0\\,\\mathrm{mm}$$\n\nFor Lead aVF:\nThe amplitudes are $R_{aVF} = 3.0\\,\\mathrm{mm}$, $Q_{aVF} = 0.0\\,\\mathrm{mm}$, and $S_{aVF} = 10.0\\,\\mathrm{mm}$.\nThe net deflection in Lead aVF, $V_{aVF}$, is:\n$$V_{aVF} = 3.0 - (0.0 + 10.0) = 3.0 - 10.0 = -7.0\\,\\mathrm{mm}$$\n\nStep 2: Determine the components of the MEA vector.\nThe problem states that the MEA can be treated as a vector whose projections onto the lead axes correspond to the net deflections. The conventional hexaxial reference system places the Lead I axis at $0^\\circ$ and the Lead aVF axis at $+90^\\circ$. This configuration establishes a standard two-dimensional Cartesian coordinate system where the x-component of the MEA vector is the net deflection in Lead I, and the y-component is the net deflection in Lead aVF.\nLet the MEA vector be $\\vec{M}$ with components $(M_x, M_y)$.\n$$M_x = V_I = 8.0$$\n$$M_y = V_{aVF} = -7.0$$\nThe components are unitless in this context as we are only concerned with their ratio to find the angle. The units of millimeters cancel out.\n\nStep 3: Calculate the angle of the MEA vector.\nThe angle $\\theta$ of a vector with components $(M_x, M_y)$ is found using the arctangent function. The angle is measured counterclockwise from the positive x-axis (the Lead I axis).\n$$\\theta = \\arctan\\left(\\frac{M_y}{M_x}\\right)$$\nSubstituting the component values:\n$$\\theta = \\arctan\\left(\\frac{-7.0}{8.0}\\right) = \\arctan(-0.875)$$\nThe calculation must be performed in degrees:\n$$\\theta \\approx -41.185925...^\\circ$$\nThe problem requires rounding to four significant figures.\n$$\\theta \\approx -41.19^\\circ$$\nThe vector has a positive x-component and a negative y-component, placing it in the fourth quadrant, which is consistent with the negative angle calculated.\n\nStep 4: Classify the calculated axis.\nThe clinically accepted ranges for axis classification are provided:\n- Normal axis: $-30^\\circ \\le \\theta \\le +90^\\circ$\n- Left axis deviation (LAD): $-90^\\circ \\le \\theta < -30^\\circ$\n- Right axis deviation (RAD): $+90^\\circ < \\theta \\le +180^\\circ$\n- Extreme axis deviation: outside the above ranges (i.e., $-180^\\circ \\le \\theta < -90^\\circ$)\n\nThe calculated MEA is $\\theta \\approx -41.19^\\circ$. This value satisfies the condition $-90^\\circ \\le -41.19^\\circ < -30^\\circ$.\nTherefore, the electrical axis is classified as Left Axis Deviation (LAD).\n\nThe problem asks for only the numerical angle in degrees as the final answer.", "answer": "$$\\boxed{-41.19}$$", "id": "2615350"}, {"introduction": "The accuracy of any ECG analysis, including the determination of the electrical axis, is contingent upon the correct placement of the recording electrodes. An electrode swap systematically alters the recorded signals based on the fundamental definitions of the limb and augmented leads. This practice problem explores the consequences of a common technical error, requiring you to derive the resulting ECG pattern and calculate the erroneous axis, thereby reinforcing your understanding of the lead system and its potential pitfalls. [@problem_id:2615374]", "problem": "A three-electrode limb system records the frontal-plane electrocardiogram. Let the instantaneous potentials at the right arm, left arm, and left leg electrodes be denoted by $V_{R}(t)$, $V_{L}(t)$, and $V_{F}(t)$, respectively. The standard limb leads are defined by the potential differences $L_{I}(t) = V_{L}(t) - V_{R}(t)$, $L_{II}(t) = V_{F}(t) - V_{R}(t)$, and $L_{III}(t) = V_{F}(t) - V_{L}(t)$, and the augmented leads are defined using the Wilson central terminal $V_{W}(t) = \\left(V_{R}(t)+V_{L}(t)+V_{F}(t)\\right)/3$ by $aVR(t) = V_{R}(t) - V_{W}(t)$, $aVL(t) = V_{L}(t) - V_{W}(t)$, and $aVF(t) = V_{F}(t) - V_{W}(t)$. Assume that the mean QRS vector in the frontal plane has constant magnitude $A > 0$ and true axis $\\theta$ (in degrees), measured with $0^{\\circ}$ along the positive direction of Lead $I$ and $+90^{\\circ}$ directed inferiorly. Under the usual linear vector model for the frontal plane, the projections of the mean QRS onto the three standard limb-lead axes are $L_{I} = A \\cos(\\theta)$, $L_{II} = A \\cos(\\theta - 60^{\\circ})$, and $L_{III} = A \\cos(\\theta - 120^{\\circ})$, consistent with Einthoven’s law.\nNow suppose that the right arm and left leg electrodes are accidentally interchanged at the skin (right arm electrode is placed on the left leg location and left leg electrode is placed on the right arm location), while the left arm electrode remains correctly placed. An interpreter, unaware of the swap, uses the measured $L_{I}$ and $aVF$ from this misconnected recording to infer the mean frontal QRS axis by the conventional Cartesian method that treats the $L_{I}$ and $aVF$ measurements as proportional to the horizontal and vertical components of the mean QRS vector, respectively, and determines the axis as the corresponding polar angle.\nUsing only the core definitions above and the assumption that the Wilson central terminal is the average of the three limb potentials, first derive the algebraic effect of the right arm–left leg swap on the measured limb and augmented leads in terms of the true $L_{I}$ and $L_{II}$. Then, for a heart with true frontal-plane mean QRS axis $\\theta = 30^{\\circ}$ and arbitrary $A>0$, compute the single numerical value of the apparent mean frontal QRS axis (in degrees) that the interpreter would report from the misconnected $L_{I}$ and $aVF$. Use the conventional principal value in the interval $[-180^{\\circ}, 180^{\\circ})$. Express your final answer in degrees. \nIn your derivation, identify the major diagnostic pitfalls that could arise from this specific electrode swap when interpreting rhythm and axis from the misconnected tracing. The final answer must be the single angle value only.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It describes a physically realistic scenario of electrode misplacement in electrocardiography and provides all necessary formal definitions to derive a unique solution. The problem is valid.\n\nThe core of the problem is to determine the quantitative effect of an electrode swap on the measured electrocardiogram (ECG) leads and the resulting misinterpretation of the cardiac axis. Let the true, physiological potentials at the right arm, left arm, and left leg be $V_{R}$, $V_{L}$, and $V_{F}$, respectively. The problem statement indicates a swap of the right arm (RA) and left leg (LL) electrodes. This means the potential measured by the ECG machine at its RA input terminal is actually $V_{F}$, and the potential at its LL input terminal is actually $V_{R}$. The left arm (LA) electrode is correctly placed.\n\nLet the measured potentials at the machine's input terminals be denoted by a prime:\n$V'_{R} = V_{F}$\n$V'_{L} = V_{L}$\n$V'_{F} = V_{R}$\n\nThe machine calculates the standard and augmented leads based on these swapped input potentials. We derive the expressions for these measured leads (denoted with a prime) in terms of the true leads.\n\nThe true standard limb leads are defined as:\n$L_{I} = V_{L} - V_{R}$\n$L_{II} = V_{F} - V_{R}$\n$L_{III} = V_{F} - V_{L}$\nFrom these definitions, Einthoven's Law, $L_{I} + L_{III} = L_{II}$, follows directly. We can express $L_{III}$ as $L_{III} = L_{II} - L_{I}$.\n\nThe measured standard leads are:\n$L'_{I} = V'_{L} - V'_{R} = V_{L} - V_{F} = -(V_{F} - V_{L}) = -L_{III}$.\nUsing Einthoven's Law, this becomes $L'_{I} = -(L_{II} - L_{I}) = L_{I} - L_{II}$.\n$L'_{II} = V'_{F} - V'_{R} = V_{R} - V_{F} = -(V_{F} - V_{R}) = -L_{II}$.\n$L'_{III} = V'_{F} - V'_{L} = V_{R} - V_{L} = -(V_{L} - V_{R}) = -L_{I}$.\n\nNext, we derive the expressions for the measured augmented leads. First, we examine the Wilson central terminal, defined as $V_{W} = \\frac{1}{3}(V_{R} + V_{L} + V_{F})$. The machine calculates a measured central terminal $V'_{W}$:\n$V'_{W} = \\frac{1}{3}(V'_{R} + V'_{L} + V'_{F}) = \\frac{1}{3}(V_{F} + V_{L} + V_{R}) = V_{W}$.\nThe Wilson central terminal is invariant under any permutation of the limb potentials.\n\nThe true augmented leads are:\n$aVR = V_{R} - V_{W}$\n$aVL = V_{L} - V_{W}$\n$aVF = V_{F} - V_{W}$\n\nThe measured augmented leads are:\n$aVR' = V'_{R} - V'_{W} = V_{F} - V_{W} = aVF$.\n$aVL' = V'_{L} - V'_{W} = V_{L} - V_{W} = aVL$.\n$aVF' = V'_{F} - V'_{W} = V_{R} - V_{W} = aVR$.\nThis swap of the RA and LL electrodes results in the measured leads $aVR'$ and $aVF'$ being swapped versions of the true $aVF$ and $aVR$, while $aVL$ is unaffected.\n\nThe problem states that an interpreter, unaware of the swap, uses the measured $L'_{I}$ and $aVF'$ to determine the mean QRS axis. The interpreter treats $L'_{I}$ as the horizontal component ($x$-axis) and $aVF'$ as the vertical component ($y$-axis) of the cardiac vector. To compute the apparent axis, we must express $L'_{I}$ and $aVF'$ in terms of the true fundamental leads $L_{I}$ and $L_{II}$.\n\nWe already have $L'_{I} = L_{I} - L_{II}$.\nFor $aVF'$, we have $aVF' = aVR$. We must express the true $aVR$ in terms of $L_I$ and $L_{II}$ using the provided definition of $V_W$.\n$aVR = V_{R} - V_{W} = V_{R} - \\frac{1}{3}(V_{R} + V_{L} + V_{F})$\nTo express $V_{L}$ and $V_{F}$ in terms of $L_{I}$, $L_{II}$, and $V_R$, we use:\n$V_{L} = L_{I} + V_{R}$\n$V_{F} = L_{II} + V_{R}$\nSubstituting these into the expression for $aVR$:\n$aVR = V_{R} - \\frac{1}{3}(V_{R} + (L_{I} + V_{R}) + (L_{II} + V_{R}))$\n$aVR = V_{R} - \\frac{1}{3}(3V_{R} + L_{I} + L_{II}) = V_{R} - V_{R} - \\frac{1}{3}(L_{I} + L_{II})$\n$aVR = -\\frac{1}{3}(L_{I} + L_{II})$\n\nSo, the vector components used by the interpreter are proportional to:\nHorizontal component: $x \\propto L'_{I} = L_{I} - L_{II}$\nVertical component: $y \\propto aVF' = aVR = -\\frac{1}{3}(L_{I} + L_{II})$\n\nNow, we compute these values for a true mean QRS axis $\\theta = 30^{\\circ}$. The projections onto the standard limb lead axes are given by:\n$L_{I} = A \\cos(\\theta) = A \\cos(30^{\\circ}) = A \\frac{\\sqrt{3}}{2}$\n$L_{II} = A \\cos(\\theta - 60^{\\circ}) = A \\cos(30^{\\circ} - 60^{\\circ}) = A \\cos(-30^{\\circ}) = A \\frac{\\sqrt{3}}{2}$\n\nSubstituting these into our expressions for the measured components:\n$x \\propto L'_{I} = A \\frac{\\sqrt{3}}{2} - A \\frac{\\sqrt{3}}{2} = 0$\n$y \\propto aVF' = -\\frac{1}{3}\\left(A \\frac{\\sqrt{3}}{2} + A \\frac{\\sqrt{3}}{2}\\right) = -\\frac{1}{3}(A\\sqrt{3}) = -A\\frac{\\sqrt{3}}{3}$\n\nThe interpreter determines the apparent axis $\\theta_{app}$ as the polar angle corresponding to the vector $(x, y)$. The vector has a horizontal component of $0$ and a vertical component that is negative (since $A>0$). In the standard frontal plane ECG axis system, the horizontal axis corresponds to lead I ($0^{\\circ}$) and the vertical axis corresponds to lead aVF ($+90^{\\circ}$ is directed inferiorly). A positive value on the $aVF$ axis corresponds to a downward direction. Our calculated vertical component $y$ is negative, which means the vector component points upward. A vector with a zero horizontal component and an upward vertical component points directly along the negative aVF axis. The direction of the negative aVF axis is $+90^{\\circ} - 180^{\\circ} = -90^{\\circ}$.\n\nThus, the apparent mean frontal QRS axis is $-90^{\\circ}$.\n\nThe diagnostic pitfalls arising from this error are severe. A true normal axis of $+30^{\\circ}$ is misinterpreted as an extreme axis deviation of $-90^{\\circ}$. More dangerously, this specific swap can mimic a completed inferior myocardial infarction. A normal heart with a $+30^{\\circ}$ axis has positive QRS complexes in leads II, III, and aVF. From our derivation, the measured leads are $L'_{II} = -L_{II}$, $L'_{III} = -L_{I}$, and $aVF' = aVR$. For a normal axis, true $L_I$ and $L_{II}$ are positive, and true $aVR$ is negative. Therefore, the interpreter sees negative QRS complexes in the leads labeled 'II', 'III', and 'aVF'. This pattern is the classic signature for inferior infarction. Furthermore, the true $aVF$ is positive, but it is recorded in the 'aVR' channel ($aVR' = aVF$). An upright P-wave and QRS complex in the lead labeled 'aVR' is a highly specific clue for this electrode reversal (or dextrocardia), and its presence should immediately trigger a check of electrode placement. Ignoring this clue leads to profound diagnostic error.", "answer": "$$\\boxed{-90}$$", "id": "2615374"}, {"introduction": "The duration of the QRS complex is a direct measure of the time required for the ventricles to depolarize. This duration is governed by the speed at which the activation wavefront propagates through the myocardium, a process that is inherently anisotropic. This computational exercise allows you to model this phenomenon, exploring how specific changes in conduction velocity along different fiber axes impact the total ventricular activation time, thus providing deeper insight into the biophysical basis of the QRS complex. [@problem_id:2615372]", "problem": "You are to implement a program that models how the duration of the QRS complex in the Electrocardiogram (ECG) changes when transverse conduction velocity is reduced by a specified factor in a simplified three-dimensional ventricular model. Start from a physically grounded approximation: the ventricular myocardium is modeled as a homogeneous orthotropic excitable medium occupying a rectangular cuboid with side lengths $L_x$, $L_y$, and $L_z$ (in meters), aligned respectively with fiber-longitudinal (apex–base), fiber-transverse (circumferential), and transmural (radial) axes. Conduction velocities are constant and given by $v_x$, $v_y$, and $v_z$ (in meters per second) along these axes. A single focal activation begins at the geometric center of the cuboid at time $t=0$. The QRS duration is approximated by the ventricular activation time, defined as the maximum activation arrival time within the cuboid.\n\nFundamental base and modeling assumptions:\n- In a homogeneous medium with constant speed, wavefronts obey Huygens’ principle, and for isotropy the set of points reachable by time $t$ is a sphere of radius $v\\, t$. In a homogeneous orthotropic medium with principal conduction velocities $v_x$, $v_y$, and $v_z$, the reachable set generalizes to an ellipsoid with semi-axes $v_x t$, $v_y t$, and $v_z t$ aligned with the principal axes. Equivalently, for a point at offset $(x,y,z)$ from the initiation site, the earliest arrival time $T(x,y,z)$ satisfies the eikonal relation for orthotropic media, which yields an ellipsoidal wavefront in this coordinate system. The last-activated point in a rectangular cuboid centered at the origin is a corner; thus the ventricular activation time equals the earliest arrival time to a corner.\n- The transverse conduction velocity is reduced by $50\\%$, i.e., $v_y$ is replaced by $0.5\\, v_y$, while $v_x$ and $v_z$ remain unchanged.\n- All lengths are in meters and all velocities are in meters per second. You must express the change in QRS duration (new minus baseline) in milliseconds as real numbers.\n\nTask:\n- For each test case, compute the baseline QRS duration $T_0$ as the maximum of the arrival times over the cuboid. Then compute the new QRS duration $T_1$ after replacing $v_y$ by $0.5\\, v_y$. Report the change $\\Delta T = (T_1 - T_0)$ in milliseconds.\n- Angle units are not applicable in this problem.\n- Your results must be floats, rounded to exactly three decimal places.\n\nTest suite:\nProvide results for the following four parameter sets, each specified as $(L_x, L_y, L_z, v_x, v_y, v_z)$ with $L_x$, $L_y$, $L_z$ in meters and $v_x$, $v_y$, $v_z$ in meters per second.\n1. $(0.09, 0.04, 0.01, 0.6, 0.2, 0.2)$\n2. $(0.06, 0.06, 0.01, 0.7, 0.7, 0.7)$\n3. $(0.10, 0.02, 0.006, 0.7, 0.3, 0.25)$\n4. $(0.08, 0.08, 0.012, 0.6, 0.3, 0.25)$\n\nDetailed requirements to ensure scientific realism and reproducibility:\n- Use the orthotropic ellipsoidal propagation model rooted in Huygens’ principle and the eikonal approximation as the fundamental base for determining arrival times from the central focus.\n- Let the geometric center be the origin $(0,0,0)$ and corners at $(\\pm L_x/2, \\pm L_y/2, \\pm L_z/2)$.\n- Compute the baseline ventricular activation time as the earliest arrival time to a corner of the cuboid, and likewise after the transverse velocity reduction.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[1.234,5.678,9.012]\"), where the entries are the four values of $\\Delta T$ in milliseconds, rounded to three decimal places, in the same order as the test suite.", "solution": "We formalize the relationship between conduction velocities and activation times using the eikonal approximation for homogeneous orthotropic media. The key scientific principles are:\n\n1. Huygens’ principle in excitable media: For a homogeneous isotropic medium with constant conduction velocity $v$, the wavefront at time $t$ is the sphere of radius $v t$ centered at the initiation site. This implies that the earliest arrival time to a point at Euclidean distance $r$ is $T = r / v$.\n\n2. Orthotropic generalization: In a homogeneous orthotropic medium with principal axes aligned to $(x,y,z)$ and constant conduction velocities $(v_x, v_y, v_z)$ along those axes, the wavefront at time $t$ is an ellipsoid centered at the initiation site with semi-axes $(v_x t, v_y t, v_z t)$. This follows from the eikonal equation specialized to orthotropy, where the arrival time $T(x,y,z)$ satisfies an anisotropic metric. Geometrically, the reachable set within time $t$ is the set of points $(x,y,z)$ obeying\n$$\n\\left(\\frac{x}{v_x t}\\right)^2 + \\left(\\frac{y}{v_y t}\\right)^2 + \\left(\\frac{z}{v_z t}\\right)^2 \\le 1.\n$$\nSolving for the first-passage time to a point $(x,y,z)$ yields the earliest arrival time\n$$\nT(x,y,z) \\;=\\; \\sqrt{\\left(\\frac{x}{v_x}\\right)^2 + \\left(\\frac{y}{v_y}\\right)^2 + \\left(\\frac{z}{v_z}\\right)^2}.\n$$\n\n3. Ventricular activation time approximation: If the myocardium occupies a rectangular cuboid centered at the origin with half-lengths $(L_x/2, L_y/2, L_z/2)$ and activation initiates at the center at time $t=0$, then the last-activated point is a farthest point in the anisotropic metric induced by the ellipsoidal wavefront. For a cuboid aligned with the principal axes, this farthest point is a corner at $(\\pm L_x/2, \\pm L_y/2, \\pm L_z/2)$. Hence the ventricular activation time (which we approximate as the QRS duration) equals\n$$\nT_{\\max} \\;=\\; T\\!\\left(\\tfrac{L_x}{2}, \\tfrac{L_y}{2}, \\tfrac{L_z}{2}\\right) \n\\;=\\; \\sqrt{\\left(\\frac{L_x}{2 v_x}\\right)^2 + \\left(\\frac{L_y}{2 v_y}\\right)^2 + \\left(\\frac{L_z}{2 v_z}\\right)^2 }.\n$$\n\n4. Perturbation to transverse velocity: Reducing the transverse velocity by $50\\%$ replaces $v_y$ by $v_y' = 0.5\\, v_y$. Defining\n$$\nA \\;=\\; \\frac{L_x}{2 v_x}, \\quad B \\;=\\; \\frac{L_y}{2 v_y}, \\quad C \\;=\\; \\frac{L_z}{2 v_z},\n$$\nwe have the baseline activation time\n$$\nT_0 \\;=\\; \\sqrt{A^2 + B^2 + C^2},\n$$\nand after the reduction,\n$$\nB' \\;=\\; \\frac{L_y}{2 v_y'} \\;=\\; \\frac{L_y}{2 \\cdot 0.5 v_y} \\;=\\; 2 B, \\qquad\nT_1 \\;=\\; \\sqrt{A^2 + (2B)^2 + C^2}.\n$$\nTherefore, the change in QRS duration is\n$$\n\\Delta T \\;=\\; T_1 - T_0,\n$$\nwhich we convert to milliseconds by multiplying by $1000$.\n\nAlgorithmic design:\n- For each test case $(L_x, L_y, L_z, v_x, v_y, v_z)$, compute $A$, $B$, and $C$ as above.\n- Compute $T_0$ and $T_1$ via the displayed equations.\n- Compute $\\Delta T = (T_1 - T_0) \\times 1000$ to express in milliseconds.\n- Round to exactly three decimal places.\n- Aggregate the four results in order and print as a single bracketed, comma-separated list with no spaces.\n\nThis approach directly encodes the principles of wavefront propagation under orthotropic conduction and yields a physically interpretable change in ventricular activation time (and thus QRS duration) when transverse conduction is slowed by half.\n\nWe now apply this method to the specified test suite:\n1. $(L_x, L_y, L_z, v_x, v_y, v_z) = (0.09, 0.04, 0.01, 0.6, 0.2, 0.2)$.\n2. $(L_x, L_y, L_z, v_x, v_y, v_z) = (0.06, 0.06, 0.01, 0.7, 0.7, 0.7)$.\n3. $(L_x, L_y, L_z, v_x, v_y, v_z) = (0.10, 0.02, 0.006, 0.7, 0.3, 0.25)$.\n4. $(L_x, L_y, L_z, v_x, v_y, v_z) = (0.08, 0.08, 0.012, 0.6, 0.3, 0.25)$.\n\nThe program will compute and output the list $[\\Delta T_1, \\Delta T_2, \\Delta T_3, \\Delta T_4]$ in milliseconds, each rounded to three decimals, in that order.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef ventricular_activation_time(Lx, Ly, Lz, vx, vy, vz):\n    \"\"\"\n    Compute ventricular activation time (approx QRS) for a rectangular cuboid\n    with center activation, under orthotropic conduction:\n    T = sqrt( (Lx/(2*vx))^2 + (Ly/(2*vy))^2 + (Lz/(2*vz))^2 )\n    \"\"\"\n    A = Lx / (2.0 * vx)\n    B = Ly / (2.0 * vy)\n    C = Lz / (2.0 * vz)\n    return float(np.sqrt(A*A + B*B + C*C))\n\ndef delta_qrs_ms_when_transverse_halved(Lx, Ly, Lz, vx, vy, vz):\n    \"\"\"\n    Compute change in QRS duration (ms) when vy is reduced by 50% (vy' = 0.5*vy),\n    with vx and vz unchanged.\n    \"\"\"\n    T0 = ventricular_activation_time(Lx, Ly, Lz, vx, vy, vz)\n    T1 = ventricular_activation_time(Lx, Ly, Lz, vx, 0.5 * vy, vz)\n    delta_ms = (T1 - T0) * 1000.0\n    return delta_ms\n\ndef solve():\n    # Define the test cases from the problem statement:\n    # Each tuple is (Lx, Ly, Lz, vx, vy, vz).\n    test_cases = [\n        (0.09, 0.04, 0.01, 0.6, 0.2, 0.2),\n        (0.06, 0.06, 0.01, 0.7, 0.7, 0.7),\n        (0.10, 0.02, 0.006, 0.7, 0.3, 0.25),\n        (0.08, 0.08, 0.012, 0.6, 0.3, 0.25),\n    ]\n\n    results = []\n    for (Lx, Ly, Lz, vx, vy, vz) in test_cases:\n        delta = delta_qrs_ms_when_transverse_halved(Lx, Ly, Lz, vx, vy, vz)\n        # Round to exactly three decimals\n        results.append(round(delta + 1e-12, 3))  # tiny epsilon to stabilize rounding\n\n    # Format as required: a single line with a bracketed, comma-separated list, no spaces.\n    formatted = \"[\" + \",\".join(f\"{val:.3f}\" for val in results) + \"]\"\n    print(formatted)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2615372"}]}