{"hands_on_practices": [{"introduction": "A central question in pharmacology is how the molecular affinity of a hormone for its receptor translates into a physiological response. The operational model of agonism provides a powerful framework for this, explaining why a drug's potency, measured by the half-maximal effective concentration ($EC_{50}$), is not just a property of the drug itself, but an emergent property of the drug-receptor-tissue system. This exercise [@problem_id:2580019] will guide you through a key derivation that quantitatively links a receptor's affinity ($K_A$) to the observed potency ($EC_{50}$) via the system's intrinsic signaling efficiency, often termed \"receptor reserve\" ($\\tau$).", "problem": "A pharmacological system contains a ligand-gated receptor that couples to an effector to produce a measurable response. Let the agonist be denoted by $A$, with equilibrium dissociation constant $K_A$ (affinity parameter), and let the receptor–effector coupling efficiency and receptor reserve be summarized by a dimensionless transducer parameter $\\tau$ (receptor reserve). The system-level maximal capacity for response is $E_{\\max}$ (the response limit set by the tissue/assay). Consider the widely used operational model of agonism (single-site, unit Hill slope), which connects receptor occupancy and stimulus–response coupling into the dose–response function\n$$\nE([A]) \\;=\\; \\frac{E_{\\max}\\,\\tau\\,[A]}{K_A \\;+\\; (1+\\tau)\\,[A]}\\,.\n$$\nBy definition, the observed maximal response for this agonist in this system is $E_{\\text{obs,max}} \\equiv \\lim_{[A]\\to\\infty} E([A])$, and the half-maximal effective concentration (EC50) is the concentration $[A]$ that yields $E([A]) = \\tfrac{1}{2}\\,E_{\\text{obs,max}}$.\n\nStarting strictly from the model above and these definitions, derive a closed-form expression for $\\mathrm{EC}_{50}$ in terms of $K_A$ and $\\tau$. From first principles, explain why and how the receptor reserve $\\tau$ compresses potency relative to affinity, and state mechanistically grounded conditions under which potency does not track affinity across tissues or experimental conditions (for example, when two preparations share the same $K_A$ but differ in $\\mathrm{EC}_{50}$). Your final reported answer must be the analytic expression for $\\mathrm{EC}_{50}$ as a function of $K_A$ and $\\tau$. Do not include units in your final answer. If you choose to evaluate any limiting cases, keep them symbolic. No rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. It is based on the established operational model of agonism introduced by Black and Leff, a fundamental concept in quantitative pharmacology. We will proceed with a rigorous derivation based on the provided definitions.\n\nThe objective is to derive an expression for the half-maximal effective concentration, $\\mathrm{EC}_{50}$, from the given dose-response function:\n$$E([A]) = \\frac{E_{\\max}\\,\\tau\\,[A]}{K_A + (1+\\tau)\\,[A]}$$\nHere, $[A]$ is the agonist concentration, $K_A$ is the equilibrium dissociation constant, $\\tau$ is the transducer parameter, and $E_{\\max}$ is the system's maximum possible response.\n\nFirst, we must determine the observed maximal response, $E_{\\text{obs,max}}$, which is defined as the limit of the response function as $[A]$ approaches infinity.\n$$E_{\\text{obs,max}} \\equiv \\lim_{[A]\\to\\infty} E([A]) = \\lim_{[A]\\to\\infty} \\frac{E_{\\max}\\,\\tau\\,[A]}{K_A + (1+\\tau)\\,[A]}$$\nTo evaluate this limit, we divide both the numerator and the denominator by $[A]$:\n$$E_{\\text{obs,max}} = \\lim_{[A]\\to\\infty} \\frac{E_{\\max}\\,\\tau}{\\frac{K_A}{[A]} + (1+\\tau)}$$\nAs $[A] \\to \\infty$, the term $\\frac{K_A}{[A]}$ approaches $0$. Therefore, the limit is:\n$$E_{\\text{obs,max}} = \\frac{E_{\\max}\\,\\tau}{0 + (1+\\tau)} = \\frac{E_{\\max}\\,\\tau}{1+\\tau}$$\nThis expression represents the maximum response achievable by the agonist in this specific system, which may be less than the theoretical system maximum $E_{\\max}$ if the agonist is a partial agonist (corresponding to a scenario where $\\tau$ is not sufficiently large to saturate the response capacity).\n\nNext, we use the definition of $\\mathrm{EC}_{50}$: the concentration of agonist that produces a response equal to one-half of the observed maximum, i.e., $E(\\mathrm{EC}_{50}) = \\frac{1}{2}E_{\\text{obs,max}}$. We substitute the expressions for $E([A])$ and $E_{\\text{obs,max}}$ into this defining equation:\n$$\\frac{E_{\\max}\\,\\tau\\,\\mathrm{EC}_{50}}{K_A + (1+\\tau)\\,\\mathrm{EC}_{50}} = \\frac{1}{2} \\left( \\frac{E_{\\max}\\,\\tau}{1+\\tau} \\right)$$\nAssuming the agonist elicits a response, both $\\tau$ and $E_{\\max}$ are non-zero quantities, allowing for the cancellation of the term $E_{\\max}\\,\\tau$ from both sides of the equation:\n$$\\frac{\\mathrm{EC}_{50}}{K_A + (1+\\tau)\\,\\mathrm{EC}_{50}} = \\frac{1}{2(1+\\tau)}$$\nTo solve for $\\mathrm{EC}_{50}$, we perform cross-multiplication:\n$$2(1+\\tau)\\,\\mathrm{EC}_{50} = K_A + (1+\\tau)\\,\\mathrm{EC}_{50}$$\nWe then isolate the terms containing $\\mathrm{EC}_{50}$:\n$$2(1+\\tau)\\,\\mathrm{EC}_{50} - (1+\\tau)\\,\\mathrm{EC}_{50} = K_A$$\n$$(2(1+\\tau) - (1+\\tau))\\,\\mathrm{EC}_{50} = K_A$$\n$$(1+\\tau)\\,\\mathrm{EC}_{50} = K_A$$\nFinally, dividing by $(1+\\tau)$ yields the closed-form expression for $\\mathrm{EC}_{50}$:\n$$\\mathrm{EC}_{50} = \\frac{K_A}{1+\\tau}$$\nThis is the required analytical expression.\n\nNow, we must explain the relationship between potency ($\\mathrm{EC}_{50}$) and affinity ($K_A$). Potency is inversely related to $\\mathrm{EC}_{50}$ (a smaller $\\mathrm{EC}_{50}$ indicates higher potency), while affinity is inversely related to $K_A$ (a smaller $K_A$ indicates higher affinity). The transducer parameter $\\tau$ is a measure of receptor reserve and signaling efficiency; by definition, $\\tau \\ge 0$.\nThe derived expression $\\mathrm{EC}_{50} = K_A / (1+\\tau)$ shows that for any system with a non-zero receptor reserve ($\\tau  0$), we have $1+\\tau  1$, which implies that $\\mathrm{EC}_{50}  K_A$. This means the concentration required to elicit a half-maximal *response* is lower than the concentration required to achieve half-maximal receptor *occupancy*. The receptor reserve, embodied by $\\tau$, effectively amplifies the signal generated by receptor binding. A highly efficient system (large $\\tau$) requires only a small fraction of receptors to be occupied to produce a substantial response, thus shifting the dose-response curve to the left of the binding curve and increasing the apparent potency of the agonist. The phrase \"compresses potency relative to affinity\" refers to this phenomenon where the numerical value of $\\mathrm{EC}_{50}$ is \"compressed\" to be smaller than $K_A$. The magnitude of this effect is dictated by the factor $(1+\\tau)$.\n\nLastly, we address the conditions under which potency does not track affinity. The derived formula shows that $\\mathrm{EC}_{50}$ is a function of two parameters: $K_A$, which is a property of the drug-receptor interaction, and $\\tau$, which is a property of the biological system (e.g., cell, tissue). The problem gives an example of two preparations sharing the same $K_A$ but differing in $\\mathrm{EC}_{50}$. This situation arises when a single agonist (constant $K_A$) is tested in two different systems, say System $1$ and System $2$, with different transducer parameters $\\tau_1$ and $\\tau_2$. The potencies will be:\n$$\\mathrm{EC}_{50,1} = \\frac{K_A}{1+\\tau_1} \\quad \\text{and} \\quad \\mathrm{EC}_{50,2} = \\frac{K_A}{1+\\tau_2}$$\nIf $\\tau_1 \\neq \\tau_2$, then it is necessary that $\\mathrm{EC}_{50,1} \\neq \\mathrm{EC}_{50,2}$, even though the agonist's affinity for the receptor, $K_A$, is identical in both systems.\nMechanistically, $\\tau$ reflects factors such as receptor density and the efficiency of the downstream signal transduction cascade. These properties are highly variable across different biological contexts. Therefore, potency ($\\mathrm{EC}_{50}$) will fail to track affinity ($K_A$) when comparing:\n1.  Different tissues or cell types, which naturally express different levels of receptors and signaling components.\n2.  The same tissue in different physiological or pathological states (e.g., disease-induced changes in receptor expression).\n3.  Experimental preparations where the receptor population has been artificially altered, for example by partial irreversible antagonism, which reduces the effective value of $\\tau$.\nIn conclusion, affinity is a characteristic of the molecular interaction between a drug and its target receptor, whereas potency is an emergent, system-dependent property that reflects both this affinity and the downstream signal amplification capacity of the cellular environment.", "answer": "$$\\boxed{\\frac{K_A}{1+\\tau}}$$", "id": "2580019"}, {"introduction": "Cellular responses are rarely governed by a single input; instead, they are the result of integrating multiple, often opposing, signals. A prime example is the dual control of adenylyl cyclase by stimulatory G-proteins (Gαs) and inhibitory G-proteins (Gαi), which allows for precise tuning of the cyclic AMP (cAMP) second messenger system. This practice [@problem_id:2579984] challenges you to model this competitive regulation from first principles, deriving the effective activity of the enzyme and calculating the resulting steady-state cAMP level in the face of conflicting regulatory inputs.", "problem": "A single isoform of adenylyl cyclase (AC) in a vertebrate cell is modulated by the stimulatory heterotrimeric guanine nucleotide-binding protein alpha subunit (Gαs) and the inhibitory alpha subunit (Gαi). Both Gαs and Gαi bind competitively and mutually exclusively to the same regulatory site on AC, rapidly equilibrating relative to catalysis. The catalytic conversion of adenosine triphosphate (ATP) to cyclic adenosine monophosphate (cAMP) by AC follows Michaelis–Menten kinetics, and cAMP is degraded by a phosphodiesterase (PDE) that follows first-order kinetics. Assume the ATP concentration is saturating relative to the Michaelis constant so that the instantaneous cAMP production rate equals an effective maximal velocity. Using only the core definitions of mass-action binding and Michaelis–Menten kinetics, derive from first principles an ordinary differential equation for the cAMP concentration and the steady-state cAMP concentration in terms of the microscopic binding and catalytic parameters and the active Gαs and Gαi concentrations. Then, evaluate the steady-state concentration numerically for the parameter set below.\n\nAssumptions and data:\n- ATP is saturating, so production occurs at an effective maximal velocity that depends on the regulatory state.\n- AC exists in three mutually exclusive regulatory states: unbound, Gαs-bound, or Gαi-bound, each with its own maximal velocity.\n- Binding is described by rapid equilibrium mass-action with dissociation constants.\n- cAMP degradation is first-order.\n\nParameter values:\n- Basal maximal velocity when unbound: $V_{\\max,0} = 0.05 \\,\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$.\n- Maximal velocity when Gαs-bound: $V_{\\max,s} = 0.50 \\,\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$.\n- Maximal velocity when Gαi-bound: $V_{\\max,i} = 0.01 \\,\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$.\n- Dissociation constant for Gαs binding to AC: $K_{s} = 100 \\,\\mathrm{nM}$.\n- Dissociation constant for Gαi binding to AC: $K_{i} = 50 \\,\\mathrm{nM}$.\n- Concentration of active Gαs: $S = 200 \\,\\mathrm{nM}$.\n- Concentration of active Gαi: $I = 150 \\,\\mathrm{nM}$.\n- First-order rate constant for PDE-mediated cAMP degradation: $k_{\\mathrm{deg}} = 0.03 \\,\\mathrm{s}^{-1}$.\n\nTasks:\n- Starting from mass-action binding and Michaelis–Menten definitions, derive an expression for the effective maximal velocity as a function of the fractional occupancy of AC by Gαs and Gαi under competitive binding.\n- Write the ordinary differential equation governing cAMP concentration and solve for the steady state.\n- Compute the steady-state cAMP concentration using the numerical values above.\n\nExpress the final concentration in $\\mu \\mathrm{M}$. Round your numerical answer to four significant figures.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on standard models of competitive ligand binding and enzyme kinetics, specifically mass-action equilibrium and Michaelis-Menten theory under substrate saturation. All necessary parameters are provided, and there are no internal contradictions. Therefore, we proceed to a full solution.\n\nLet $[AC]$, $[AC \\cdot S]$, and $[AC \\cdot I]$ denote the molar concentrations of the free adenylyl cyclase enzyme, the enzyme bound to the stimulatory G-protein subunit $S$ (G$\\alpha$s), and the enzyme bound to the inhibitory G-protein subunit $I$ (G$\\alpha$i), respectively. The total concentration of the enzyme, $[AC]_{T}$, is conserved:\n$$\n[AC]_{T} = [AC] + [AC \\cdot S] + [AC \\cdot I]\n$$\nThe problem specifies that the competitive and mutually exclusive binding of $S$ and $I$ to $AC$ is in rapid equilibrium relative to the catalytic step. This equilibrium is described by the dissociation constants $K_s$ and $K_i$:\n$$\nAC + S \\rightleftharpoons AC \\cdot S \\quad \\text{with} \\quad K_s = \\frac{[AC][S]}{[AC \\cdot S]}\n$$\n$$\nAC + I \\rightleftharpoons AC \\cdot I \\quad \\text{with} \\quad K_i = \\frac{[AC][I]}{[AC \\cdot I]}\n$$\nFrom these relations, we can express the concentrations of the bound enzyme species in terms of the free enzyme concentration, $[AC]$:\n$$\n[AC \\cdot S] = \\frac{[AC][S]}{K_s}\n$$\n$$\n[AC \\cdot I] = \\frac{[AC][I]}{K_i}\n$$\nSubstituting these expressions into the enzyme conservation equation gives:\n$$\n[AC]_{T} = [AC] + \\frac{[AC][S]}{K_s} + \\frac{[AC][I]}{K_i} = [AC] \\left( 1 + \\frac{[S]}{K_s} + \\frac{[I]}{K_i} \\right)\n$$\nThe fraction of enzyme in each state is defined as $f_0 = \\frac{[AC]}{[AC]_T}$, $f_s = \\frac{[AC \\cdot S]}{[AC]_T}$, and $f_i = \\frac{[AC \\cdot I]}{[AC]_T}$. These fractions can be derived as follows:\n$$\nf_0 = \\frac{1}{1 + \\frac{[S]}{K_s} + \\frac{[I]}{K_i}}\n$$\n$$\nf_s = \\frac{[AC \\cdot S]}{[AC]_T} = \\frac{[AC][S]/K_s}{[AC]_T} = f_0 \\frac{[S]}{K_s} = \\frac{\\frac{[S]}{K_s}}{1 + \\frac{[S]}{K_s} + \\frac{[I]}{K_i}}\n$$\n$$\nf_i = \\frac{[AC \\cdot I]}{[AC]_T} = \\frac{[AC][I]/K_i}{[AC]_T} = f_0 \\frac{[I]}{K_i} = \\frac{\\frac{[I]}{K_i}}{1 + \\frac{[S]}{K_s} + \\frac{[I]}{K_i}}\n$$\nThe rate of cAMP production is stated to occur at an effective maximal velocity because the substrate, ATP, is saturating. This effective velocity, which we denote $V_{\\text{prod}}$, is the weighted sum of the maximal velocities of the three distinct enzyme states ($V_{\\max,0}$, $V_{\\max,s}$, $V_{\\max,i}$), where the weights are their respective fractional populations.\n$$\nV_{\\text{prod}} = f_0 V_{\\max,0} + f_s V_{\\max,s} + f_i V_{\\max,i}\n$$\nSubstituting the fractional occupancy expressions yields the total production rate as a function of the concentrations of the regulatory proteins:\n$$\nV_{\\text{prod}} = \\frac{V_{\\max,0} + V_{\\max,s} \\frac{[S]}{K_s} + V_{\\max,i} \\frac{[I]}{K_i}}{1 + \\frac{[S]}{K_s} + \\frac{[I]}{K_i}}\n$$\nThe dynamics of the cAMP concentration, denoted by $[C]$, are governed by an ordinary differential equation (ODE) that balances its production and degradation. The degradation is a first-order process with rate constant $k_{\\text{deg}}$. The ODE is:\n$$\n\\frac{d[C]}{dt} = V_{\\text{prod}} - k_{\\text{deg}}[C]\n$$\nAt steady state, the concentration of cAMP is constant, so $\\frac{d[C]}{dt} = 0$. We can solve for the steady-state concentration, $[C]_{ss}$:\n$$\n0 = V_{\\text{prod}} - k_{\\text{deg}}[C]_{ss} \\implies [C]_{ss} = \\frac{V_{\\text{prod}}}{k_{\\text{deg}}}\n$$\nSubstituting the full expression for $V_{\\text{prod}}$ gives the complete analytical solution:\n$$\n[C]_{ss} = \\frac{1}{k_{\\text{deg}}} \\left( \\frac{V_{\\max,0} + V_{\\max,s} \\frac{[S]}{K_s} + V_{\\max,i} \\frac{[I]}{K_i}}{1 + \\frac{[S]}{K_s} + \\frac{[I]}{K_i}} \\right)\n$$\nNow, we must evaluate this expression numerically using the provided parameters:\n$V_{\\max,0} = 0.05 \\,\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$, $V_{\\max,s} = 0.50 \\,\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$, $V_{\\max,i} = 0.01 \\,\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$, $K_{s} = 100 \\,\\mathrm{nM}$, $K_{i} = 50 \\,\\mathrm{nM}$, $[S] = 200 \\,\\mathrm{nM}$, $[I] = 150 \\,\\mathrm{nM}$, and $k_{\\mathrm{deg}} = 0.03 \\,\\mathrm{s}^{-1}$.\n\nFirst, we compute the dimensionless ratios describing the saturation of the binding sites:\n$$\n\\frac{[S]}{K_s} = \\frac{200 \\,\\mathrm{nM}}{100 \\,\\mathrm{nM}} = 2\n$$\n$$\n\\frac{[I]}{K_i} = \\frac{150 \\,\\mathrm{nM}}{50 \\,\\mathrm{nM}} = 3\n$$\nNext, we calculate the effective production rate, $V_{\\text{prod}}$. All velocity terms have units of $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$.\n$$\nV_{\\text{prod}} = \\frac{0.05 + (0.50)(2) + (0.01)(3)}{1 + 2 + 3} = \\frac{0.05 + 1.00 + 0.03}{6} = \\frac{1.08}{6} = 0.18 \\,\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}\n$$\nFinally, we calculate the steady-state cAMP concentration, $[C]_{ss}$. The units are consistent: $(\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}) / (\\mathrm{s}^{-1}) = \\mu \\mathrm{M}$.\n$$\n[C]_{ss} = \\frac{0.18}{0.03} = 6 \\,\\mu \\mathrm{M}\n$$\nThe problem requires a numerical answer rounded to four significant figures. Therefore, the final result is $6.000 \\,\\mu \\mathrm{M}$.", "answer": "$$\n\\boxed{6.000}\n$$", "id": "2579984"}, {"introduction": "The complexity of signaling pathways, which involve dynamic processes like receptor desensitization, internalization, and spatially distinct signaling, often necessitates the use of computational tools. Ordinary differential equation (ODE) models are essential for capturing these time-dependent behaviors and for estimating kinetic parameters that are not directly measurable. This advanced exercise [@problem_id:2579988] puts you in the role of a quantitative modeler, tasking you with building, calibrating, and using a multi-compartment model of GPCR signaling to dissect the contribution of endosomal signaling, a frontier topic in receptor biology.", "problem": "You are given a mechanistic modeling task grounded in receptor signaling and arrestin-mediated desensitization for a G protein-coupled receptor (GPCR). Use the law of mass action and linear ordinary differential equations to formulate and solve the model described below, then perform parameter estimation and a derived prediction. The program you write must be a complete, runnable program that carries out the entire workflow and prints the requested outputs as specified.\n\nContext and model specification:\n- The receptor is activated by a step of agonist at time $t=0$, and signaling proceeds through cyclic adenosine monophosphate (cAMP) production. Beta-arrestin binds to the active receptor at the plasma membrane and mediates internalization to an endosomal compartment, where signaling may continue.\n- Use the following state variables:\n  - $R_p(t)$: active receptor at the plasma membrane.\n  - $R_{pA}(t)$: arrestin-bound receptor at the plasma membrane.\n  - $R_e(t)$: active receptor in the endosome.\n  - $c(t)$: cAMP concentration.\n- Production rates:\n  - Plasma membrane cAMP production rate $v_p(t) = \\beta_p R_p(t)$.\n  - Endosomal cAMP production rate $v_e(t) = \\beta_e R_e(t)$.\n- Degradation:\n  - cAMP is degraded with a first-order rate constant $k_{\\mathrm{deg}}$.\n- Dynamics (law of mass action):\n  - $R_p(t)$ decreases by arrestin association and by deactivation with respective rate constants $k_{\\mathrm{on}}[A]$ and $k_{\\mathrm{off}}$.\n  - $R_{pA}(t)$ increases by arrestin association and decreases by internalization with rate constant $k_{\\mathrm{int}}$.\n  - $R_e(t)$ increases by internalization from $R_{pA}(t)$ and decreases by deactivation with rate constant $k_{\\mathrm{off},e}$.\n  - $c(t)$ increases by $v_p(t) + v_e(t)$ and decreases by $k_{\\mathrm{deg}} c(t)$.\n- Initial conditions at $t=0$:\n  - $R_p(0) = R_0$, $R_{pA}(0) = 0$, $R_e(0) = 0$, $c(0) = 0$.\n\nMathematical formulation to implement:\n- Use the following system, where $[A]$ is the arrestin concentration:\n$$\n\\frac{dR_p}{dt} = - k_{\\mathrm{on}} [A] R_p - k_{\\mathrm{off}} R_p,\n\\quad\n\\frac{dR_{pA}}{dt} = k_{\\mathrm{on}} [A] R_p - k_{\\mathrm{int}} R_{pA},\n$$\n$$\n\\frac{dR_e}{dt} = k_{\\mathrm{int}} R_{pA} - k_{\\mathrm{off},e} R_e,\n\\quad\n\\frac{dc}{dt} = \\beta_p R_p + \\beta_e R_e - k_{\\mathrm{deg}} c.\n$$\n\nKnown constants (use these values exactly):\n- $R_0 = 1.0$ (arbitrary unit of receptor concentration).\n- $\\beta_p = 5.0\\,\\mathrm{nM}\\cdot \\mathrm{s}^{-1}$ per receptor unit.\n- $\\beta_e = 3.0\\,\\mathrm{nM}\\cdot \\mathrm{s}^{-1}$ per receptor unit.\n- $k_{\\mathrm{off}} = 0.02\\,\\mathrm{s}^{-1}$.\n- $k_{\\mathrm{int}} = 0.05\\,\\mathrm{s}^{-1}$.\n- $k_{\\mathrm{off},e} = 0.01\\,\\mathrm{s}^{-1}$.\n- $k_{\\mathrm{deg}} = 0.3\\,\\mathrm{s}^{-1}$.\n\nData and fitting protocol:\n- The arrestin concentration $[A]$ takes two values: baseline $[A]_b = 1$ (arbitrary unit) and an overexpression value $[A]_o = \\alpha$ (arbitrary unit), with $\\alpha$ specified per test case below.\n- The time grid for measurements is\n  $$\n  \\mathcal{T} = [\\,0,\\,10,\\,20,\\,40,\\,60,\\,90,\\,120,\\,180\\,] \\text{ seconds}.\n  $$\n- For each test case, synthetic \"observed\" cAMP data must be generated by numerically integrating the model using the provided ground-truth arrestin association rate $k_{\\mathrm{on}}^{\\star}$ for both $[A]_b$ and $[A]_o$, sampled at $\\mathcal{T}$.\n- Using these two synthetic datasets (baseline and overexpression), estimate $k_{\\mathrm{on}}$ by minimizing the sum of squared residuals across both datasets at the shared time points $\\mathcal{T}$. The decision variable is only $k_{\\mathrm{on}}$. Treat $[A]_b$ and $[A]_o$ as known constants for each condition. Use nonnegative constraints for $k_{\\mathrm{on}}$.\n\nDerived prediction:\n- Define the degree of endosomal signaling over a window $[0, T]$ as the fraction\n  $$\n  \\Phi(T) = \\frac{\\int_{0}^{T} v_e(t)\\,dt}{\\int_{0}^{T} \\left(v_p(t)+v_e(t)\\right)\\,dt},\n  $$\n  computed under the overexpression condition $[A]_o$. Compute $\\Phi(T)$ by augmenting the system with the integral states $s_e(t)$ and $s_{\\mathrm{tot}}(t)$ governed by\n  $$\n  \\frac{ds_e}{dt} = v_e(t), \\quad \\frac{ds_{\\mathrm{tot}}}{dt} = v_p(t)+v_e(t),\n  $$\n  with $s_e(0)=0$ and $s_{\\mathrm{tot}}(0)=0$, so that $\\Phi(T) = s_e(T)/s_{\\mathrm{tot}}(T)$.\n\nUnits and output:\n- Report the estimated arrestin association rate $k_{\\mathrm{on}}$ in $\\mathrm{s}^{-1}$ per arbitrary unit of arrestin concentration, rounded to $6$ decimal places.\n- Report each degree of endosomal signaling $\\Phi(T)$ as a unitless decimal in $[0,1]$, rounded to $6$ decimal places.\n\nTest suite:\n- Use the three test cases below. For each case $i$, generate data using $k_{\\mathrm{on}}^{\\star}$ and fit $k_{\\mathrm{on}}$ as described, then compute $\\Phi(T_i)$ for the specified $T_i$ under overexpression $[A]_o$.\n  - Case $1$: $\\alpha=5$, $k_{\\mathrm{on}}^{\\star}=0.08\\,\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$, $T_1=180\\,\\mathrm{s}$.\n  - Case $2$: $\\alpha=2$, $k_{\\mathrm{on}}^{\\star}=0.05\\,\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$, $T_2=120\\,\\mathrm{s}$.\n  - Case $3$: $\\alpha=8$, $k_{\\mathrm{on}}^{\\star}=0.12\\,\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$, $T_3=60\\,\\mathrm{s}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets:\n  $$\n  [\\,k_1,\\,\\Phi(T_1),\\,k_2,\\,\\Phi(T_2),\\,k_3,\\,\\Phi(T_3)\\,],\n  $$\n  where $k_i$ is the estimated $k_{\\mathrm{on}}$ for case $i$ (in $\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$) rounded to $6$ decimal places, and $\\Phi(T_i)$ is the corresponding endosomal fraction rounded to $6$ decimal places. No other text should be printed.", "solution": "The problem is well-posed and valid. It presents a standard task in quantitative systems pharmacology: the formulation, calibration, and analysis of a mechanistic model based on ordinary differential equations (ODEs). The model describes G protein-coupled receptor (GPCR) signaling, desensitization, and trafficking, which are fundamental processes in cell biology. All parameters, initial conditions, and procedures are specified with sufficient clarity and scientific realism to permit a unique and meaningful solution. There are no contradictions, ambiguities, or violations of scientific principles.\n\nThe solution proceeds systematically through three main stages for each test case: synthetic data generation, parameter estimation, and prediction of a derived biological quantity.\n\nThe core of the model is the following system of four coupled linear first-order ODEs, which describe the time evolution of the concentrations of active receptor at the plasma membrane ($R_p$), arrestin-bound plasma membrane receptor ($R_{pA}$), active endosomal receptor ($R_e$), and cyclic adenosine monophosphate ($c$):\n$$\n\\frac{dR_p}{dt} = - (k_{\\mathrm{on}} [A] + k_{\\mathrm{off}}) R_p\n$$\n$$\n\\frac{dR_{pA}}{dt} = k_{\\mathrm{on}} [A] R_p - k_{\\mathrm{int}} R_{pA}\n$$\n$$\n\\frac{dR_e}{dt} = k_{\\mathrm{int}} R_{pA} - k_{\\mathrm{off},e} R_e\n$$\n$$\n\\frac{dc}{dt} = \\beta_p R_p + \\beta_e R_e - k_{\\mathrm{deg}} c\n$$\nThe system is subject to the initial conditions $R_p(0) = R_0 = 1.0$, and $R_{pA}(0) = R_e(0) = c(0) = 0$.\n\n**1. Synthetic Data Generation**\nFor each test case, we first generate synthetic \"experimental\" data. This is a common procedure known as a \"twin experiment\" used to validate parameter estimation methods. We numerically integrate the $4$-state ODE system using the provided ground-truth arrestin association rate, $k_{\\mathrm{on}}^{\\star}$. This is done for two distinct conditions: a baseline arrestin level, $[A]_b = 1.0$, and an overexpression level, $[A]_o = \\alpha$. The resulting cAMP concentration, $c(t)$, is sampled at the specified time points $\\mathcal{T} = [\\,0,\\,10,\\,20,\\,40,\\,60,\\,90,\\,120,\\,180\\,]\\,\\mathrm{s}$. These two sets of time-course data form the basis for the subsequent parameter estimation. The numerical integration is performed using the `solve_ivp` function from the `scipy.integrate` library, a robust tool for solving initial value problems.\n\n**2. Parameter Estimation**\nThe next step is to estimate the parameter $k_{\\mathrm{on}}$ using the synthetic data generated in the previous step. This is framed as a nonlinear least-squares optimization problem. The goal is to find the value of $k_{\\mathrm{on}}$ that minimizes the sum of squared residuals (SSR) between the model's predicted cAMP concentrations and the synthetic data. The objective function is:\n$$\n\\mathrm{SSR}(k_{\\mathrm{on}}) = \\sum_{t \\in \\mathcal{T}} \\left(c_{\\mathrm{sim}}(t; k_{\\mathrm{on}}, [A]_b) - c_{\\mathrm{obs}}(t; k_{\\mathrm{on}}^{\\star}, [A]_b)\\right)^2 + \\sum_{t \\in \\mathcal{T}} \\left(c_{\\mathrm{sim}}(t; k_{\\mathrm{on}}, [A]_o) - c_{\\mathrm{obs}}(t; k_{\\mathrm{on}}^{\\star}, [A]_o)\\right)^2\n$$\nHere, $c_{\\mathrm{sim}}$ denotes the cAMP concentration produced by the model for a candidate $k_{\\mathrm{on}}$, and $c_{\\mathrm{obs}}$ is the synthetic data. The minimization is performed over both the baseline and overexpression datasets simultaneously to robustly constrain the parameter. We use the `minimize` function from `scipy.optimize`, with the L-BFGS-B algorithm, which accommodates the physical constraint that the rate constant must be non-negative, i.e., $k_{\\mathrm{on}} \\ge 0$. As the data are generated from the same model structure being fitted, we expect the estimated $k_{\\mathrm{on}}$ to be nearly identical to the ground-truth $k_{\\mathrm{on}}^{\\star}$.\n\n**3. Prediction of Endosomal Signaling Fraction**\nWith the estimated value of $k_{\\mathrm{on}}$ (henceforth denoted $k_{\\mathrm{on,est}}$), we compute the fraction of total signaling that originates from the endosomal compartment, $\\Phi(T)$. This metric is defined as:\n$$\n\\Phi(T) = \\frac{\\int_{0}^{T} v_e(t)\\,dt}{\\int_{0}^{T} \\left(v_p(t)+v_e(t)\\right)\\,dt} = \\frac{\\int_{0}^{T} \\beta_e R_e(t)\\,dt}{\\int_{0}^{T} \\left(\\beta_p R_p(t) + \\beta_e R_e(t)\\right)\\,dt}\n$$\nTo compute these integrals accurately, we augment the original ODE system with two additional states: $s_e(t) = \\int_0^t v_e(\\tau) d\\tau$ and $s_{\\mathrm{tot}}(t) = \\int_0^t (v_p(\\tau)+v_e(\\tau)) d\\tau$. Their dynamics are given by:\n$$\n\\frac{ds_e}{dt} = v_e(t) = \\beta_e R_e(t)\n$$\n$$\n\\frac{ds_{\\mathrm{tot}}}{dt} = v_p(t)+v_e(t) = \\beta_p R_p(t) + \\beta_e R_e(t)\n$$\nwith initial conditions $s_e(0)=0$ and $s_{\\mathrm{tot}}(0)=0$. We integrate this augmented $6$-state system from $t=0$ to the specified time $T_i$ for each case, using the estimated parameter $k_{\\mathrm{on,est}}$ and the overexpression condition $[A]_o = \\alpha$. The desired fraction is then simply the ratio of the final values of the integral states: $\\Phi(T_i) = s_e(T_i) / s_{\\mathrm{tot}}(T_i)$. The denominator $s_{\\mathrm{tot}}(T_i)$ is guaranteed to be non-zero for $T_i  0$ because signaling from the plasma membrane begins immediately at $t=0$.\n\nThis entire computational workflow is implemented for each of the three test cases, and the final results are formatted as requested.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the GPCR signaling model problem by generating synthetic data,\n    fitting the arrestin association rate k_on, and predicting the endosomal\n    signaling fraction for three test cases.\n    \"\"\"\n    # Known constants, as specified in the problem\n    params_const = {\n        'R0': 1.0,          # Initial active receptor concentration\n        'beta_p': 5.0,      # Plasma membrane cAMP production rate coeff\n        'beta_e': 3.0,      # Endosomal cAMP production rate coeff\n        'k_off': 0.02,      # Receptor deactivation rate\n        'k_int': 0.05,      # Internalization rate\n        'k_off_e': 0.01,    # Endosomal receptor deactivation rate\n        'k_deg': 0.3,       # cAMP degradation rate\n    }\n\n    # Time points for data sampling\n    T_grid = np.array([0., 10., 20., 40., 60., 90., 120., 180.])\n    \n    # Baseline arrestin concentration\n    A_b = 1.0\n\n    # Test cases\n    test_cases = [\n        {'alpha': 5.0, 'k_on_star': 0.08, 'T': 180.0, 'case_id': 1},\n        {'alpha': 2.0, 'k_on_star': 0.05, 'T': 120.0, 'case_id': 2},\n        {'alpha': 8.0, 'k_on_star': 0.12, 'T': 60.0, 'case_id': 3},\n    ]\n\n    final_results = []\n\n    # ODE system function for the 4-state model (fitting)\n    def ode_system_4_states(t, y, k_on, A_val, p):\n        Rp, RpA, Re, c = y\n        dRp_dt = -(k_on * A_val + p['k_off']) * Rp\n        dRpA_dt = k_on * A_val * Rp - p['k_int'] * RpA\n        dRe_dt = p['k_int'] * RpA - p['k_off_e'] * Re\n        dc_dt = p['beta_p'] * Rp + p['beta_e'] * Re - p['k_deg'] * c\n        return [dRp_dt, dRpA_dt, dRe_dt, dc_dt]\n\n    # ODE system function for the 6-state model (prediction)\n    def ode_system_6_states(t, y, k_on, A_val, p):\n        Rp, RpA, Re, c, se, stot = y\n        dRp_dt = -(k_on * A_val + p['k_off']) * Rp\n        dRpA_dt = k_on * A_val * Rp - p['k_int'] * RpA\n        dRe_dt = p['k_int'] * RpA - p['k_off_e'] * Re\n        dc_dt = p['beta_p'] * Rp + p['beta_e'] * Re - p['k_deg'] * c\n        dse_dt = p['beta_e'] * Re\n        dstot_dt = p['beta_p'] * Rp + p['beta_e'] * Re\n        return [dRp_dt, dRpA_dt, dRe_dt, dc_dt, dse_dt, dstot_dt]\n\n    for case in test_cases:\n        alpha = case['alpha']\n        k_on_star = case['k_on_star']\n        T_final = case['T']\n        A_o = alpha\n\n        # 1. Generate Synthetic Data\n        y0_4_states = [params_const['R0'], 0, 0, 0]\n        \n        # Baseline data\n        sol_b_true = solve_ivp(\n            ode_system_4_states, (0, T_grid.max()), y0_4_states,\n            args=(k_on_star, A_b, params_const), t_eval=T_grid, dense_output=True\n        )\n        c_obs_b = sol_b_true.y[3]\n\n        # Overexpression data\n        sol_o_true = solve_ivp(\n            ode_system_4_states, (0, T_grid.max()), y0_4_states,\n            args=(k_on_star, A_o, params_const), t_eval=T_grid, dense_output=True\n        )\n        c_obs_o = sol_o_true.y[3]\n\n        # 2. Parameter Estimation\n        def objective_function(k_on_candidate):\n            k_on_val = k_on_candidate[0]\n            \n            # Simulate baseline\n            sol_b_sim = solve_ivp(\n                ode_system_4_states, (0, T_grid.max()), y0_4_states,\n                args=(k_on_val, A_b, params_const), t_eval=T_grid\n            )\n            c_sim_b = sol_b_sim.y[3]\n\n            # Simulate overexpression\n            sol_o_sim = solve_ivp(\n                ode_system_4_states, (0, T_grid.max()), y0_4_states,\n                args=(k_on_val, A_o, params_const), t_eval=T_grid\n            )\n            c_sim_o = sol_o_sim.y[3]\n            \n            # Sum of squared residuals\n            ssr = np.sum((c_sim_b - c_obs_b)**2) + np.sum((c_sim_o - c_obs_o)**2)\n            return ssr\n        \n        # Initial guess for the optimizer\n        k_on_initial_guess = [0.1]\n        # Bounds for k_on (must be non-negative)\n        bounds = [(0, None)]\n\n        opt_result = minimize(\n            objective_function, k_on_initial_guess, method='L-BFGS-B', bounds=bounds\n        )\n        k_on_estimated = opt_result.x[0]\n\n        # 3. Prediction of Endosomal Signaling Fraction\n        y0_6_states = [params_const['R0'], 0, 0, 0, 0, 0]\n\n        sol_phi = solve_ivp(\n            ode_system_6_states, (0, T_final), y0_6_states,\n            args=(k_on_estimated, A_o, params_const), dense_output=True\n        )\n\n        final_state = sol_phi.y[:, -1]\n        s_e_final = final_state[4]\n        s_tot_final = final_state[5]\n        \n        phi = s_e_final / s_tot_final if s_tot_final != 0 else 0.0\n        \n        # Append results for this case\n        final_results.extend([k_on_estimated, phi])\n\n    # Print a single line of output with all results, formatted to 6 decimal places.\n    print(f\"[{','.join(f'{x:.6f}' for x in final_results)}]\")\n\nsolve()\n```", "id": "2579988"}]}