{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will analyze a classic example of inter-organ metabolic cooperation: the Cori cycle. This vital pathway illustrates the liver's central role in maintaining systemic glucose homeostasis by recycling lactate produced by anaerobic tissues, such as muscle during intense exercise. This exercise challenges you to perform a detailed energetic bookkeeping for the entire cycle, quantifying the ATP yield in muscle against the ATP cost of gluconeogenesis in the liver. By calculating the net energy balance [@problem_id:2573745], you will gain a deeper appreciation for why this essential physiological process incurs a net metabolic cost to the organism.", "problem": "A human engages in brief, intense exercise in which skeletal muscle operates anaerobically and converts circulating glucose to lactate. The lactate is exported to the liver, which is in a gluconeogenic state and synthesizes glucose that is returned to the muscle. This constitutes one turn of the Cori cycle. Using mass balance, redox balance, and energy bookkeeping grounded in well-tested pathway stoichiometries, derive the net organism-level adenosine triphosphate (ATP) cost of operating the Cori cycle per mole of glucose cycled from liver to muscle and back as lactate.\n\nAssumptions:\n- All reactions occur under standard biochemical conditions at cytosolic pH $7.0$.\n- Transport costs between tissues are negligible.\n- Count one guanosine triphosphate (GTP) hydrolyzed as one ATP equivalent (one high-energy phosphate bond).\n- Nicotinamide adenine dinucleotide (NADH) produced by hepatic lactate oxidation is available to support gluconeogenic reductions; do not credit any oxidative phosphorylation.\n- Use the following widely accepted net stoichiometries as foundational facts:\n  - Anaerobic glycolysis in muscle (glucose to lactate):\n    $$\\mathrm{glucose} + 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} \\rightarrow 2\\,\\mathrm{lactate} + 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O}.$$\n  - Lactate dehydrogenase (reversible):\n    $$\\mathrm{lactate} + \\mathrm{NAD^+} \\leftrightarrow \\mathrm{pyruvate} + \\mathrm{NADH} + \\mathrm{H^+}.$$\n  - Hepatic gluconeogenesis from pyruvate to glucose consumes high-energy phosphates at pyruvate carboxylase, phosphoenolpyruvate carboxykinase, and phosphoglycerate kinase and requires reducing equivalents at glyceraldehyde-$3$-phosphate dehydrogenase; in aggregate for $2$ pyruvate to $1$ glucose it uses $4$ ATP, $2$ GTP, and $2$ NADH.\n\nTask:\n- Starting from the above foundations and enforcing conservation of carbon, charge, and reducing equivalents, sum the muscle and liver reactions to obtain the overall organism-level balance for one mole of glucose cycled through the Cori cycle.\n- From this overall balance, compute the net number of ATP equivalents consumed per mole of glucose cycled.\n\nAnswer format:\n- Express the final result as a single number representing moles of ATP equivalents per mole of glucose cycled. No rounding is necessary.", "solution": "The problem requires the derivation of the net organism-level adenosine triphosphate (ATP) cost for one turn of the Cori cycle. This will be accomplished by analyzing the stoichiometry of the processes in the muscle and the liver, and then summing them to find the overall net reaction and its associated energy cost. The analysis will adhere strictly to the provided stoichiometries and assumptions, including mass balance, redox balance, and energy bookkeeping where $1$ mole of guanosine triphosphate (GTP) is considered equivalent to $1$ mole of ATP.\n\nFirst, we analyze the metabolic process occurring in the skeletal muscle. During intense exercise, the muscle operates anaerobically, converting glucose to lactate. The problem provides the net reaction for this process:\n$$ \\mathrm{glucose} + 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} \\rightarrow 2\\,\\mathrm{lactate} + 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O} $$\nFrom this stoichiometry, we observe that for each mole of $\\mathrm{glucose}$ consumed, the muscle tissue produces a net of $2$ moles of $\\mathrm{ATP}$. The $2$ moles of lactate produced are then transported to the liver.\n\nSecond, we analyze the metabolic process occurring in the liver, which is in a gluconeogenic state. The liver takes up the $2$ moles of lactate from the circulation and synthesizes $1$ mole of $\\mathrm{glucose}$. This conversion can be considered in two sequential stages:\n1.  The oxidation of lactate to pyruvate, catalyzed by lactate dehydrogenase. For $2$ moles of lactate, this reaction is:\n    $$ 2\\,\\mathrm{lactate} + 2\\,\\mathrm{NAD^+} \\rightarrow 2\\,\\mathrm{pyruvate} + 2\\,\\mathrm{NADH} + 2\\,\\mathrm{H^+} $$\n    This reaction produces $2$ moles of the reducing equivalent $\\mathrm{NADH}$.\n\n2.  The synthesis of glucose from pyruvate (gluconeogenesis). The problem states that the conversion of $2$ moles of pyruvate into $1$ mole of $\\mathrm{glucose}$ consumes $4$ moles of $\\mathrm{ATP}$, $2$ moles of $\\mathrm{GTP}$, and $2$ moles of $\\mathrm{NADH}$.\n\nCombining these two stages for the overall process in the liver (from $2$ lactate to $1$ glucose), we can account for the redox balance. The $2$ moles of $\\mathrm{NADH}$ produced in the first stage are consumed in the second stage. As specified in the problem, this internal balancing means there is no net production or consumption of $\\mathrm{NADH}$ by the liver for the overall transformation of lactate to glucose, and no interaction with oxidative phosphorylation is considered.\nThe net energetic cost in the liver is therefore the sum of the high-energy phosphate bonds hydrolyzed. Using the given equivalence of $1\\,\\mathrm{GTP} = 1\\,\\mathrm{ATP}$, the total cost is calculated as:\n$$ \\text{Hepatic Cost} = 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} = 4\\,\\text{ATP equivalents} + 2\\,\\text{ATP equivalents} = 6\\,\\text{ATP equivalents} $$\nThus, the liver consumes a net of $6$ moles of ATP equivalents to regenerate $1$ mole of $\\mathrm{glucose}$ from the $2$ moles of lactate supplied by the muscle. The net reaction for the liver can be written as:\n$$ 2\\,\\mathrm{lactate} + 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow \\mathrm{glucose} + 4\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 6\\,\\mathrm{P_i} $$\n(Water and proton balance is omitted as it does not affect the ATP calculation).\n\nFinally, to determine the net cost for the entire organism for one complete Cori cycle, we sum the energetic balance of the muscle and the liver. The cycle consists of $\\mathrm{glucose}$ being converted to $\\mathrm{lactate}$ in the muscle and $\\mathrm{lactate}$ being converted back to $\\mathrm{glucose}$ in the liver.\n-   ATP production in muscle: $+2$ moles of $\\mathrm{ATP}$\n-   ATP equivalent consumption in liver: $-6$ moles of $\\mathrm{ATP}$ equivalents\n\nThe net organism-level change in ATP equivalents is the sum of these two values:\n$$ \\text{Net ATP equivalent change} = (+2\\,\\mathrm{ATP}) + (-6\\,\\text{ATP equivalents}) = -4\\,\\text{ATP equivalents} $$\nThe negative sign indicates a net consumption of ATP equivalents by the organism. Therefore, the net cost of operating one turn of the Cori cycle is $4$ moles of ATP equivalents per mole of glucose cycled.\n\nTo formalize this, we sum the net reactions for the muscle and liver:\nMuscle: $\\mathrm{glucose} + 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} \\rightarrow 2\\,\\mathrm{lactate} + 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O}$\nLiver: $2\\,\\mathrm{lactate} + 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow \\mathrm{glucose} + 4\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 6\\,\\mathrm{P_i}$\nSumming these two equations and canceling the terms that appear on both sides ($\\mathrm{glucose}$ and $2\\,\\mathrm{lactate}$), we get the overall net reaction for the cycle:\n$$ 2\\,\\mathrm{ADP} + 2\\,\\mathrm{P_i} + 4\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow 2\\,\\mathrm{ATP} + 2\\,\\mathrm{H_2O} + 4\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 6\\,\\mathrm{P_i} $$\nSimplifying this equation by canceling like terms on opposite sides yields:\n$$ 2\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} \\rightarrow 2\\,\\mathrm{ADP} + 2\\,\\mathrm{GDP} + 4\\,\\mathrm{P_i} + 2\\,\\mathrm{H_2O} $$\nThis final net reaction shows that the overall process of the Cori cycle is the hydrolysis of $2$ moles of $\\mathrm{ATP}$ and $2$ moles of $\\mathrm{GTP}$. The total cost in ATP equivalents is the sum of these high-energy phosphate bonds consumed:\n$$ \\text{Net Cost} = 2\\,\\mathrm{ATP} + 2\\,\\mathrm{GTP} = 2 + 2 = 4\\,\\text{ATP equivalents} $$\nThe net cost to the organism for running the Cori cycle is $4$ ATP equivalents per mole of glucose cycled.", "answer": "$$\\boxed{4}$$", "id": "2573745"}, {"introduction": "Moving from the stoichiometry of defined cycles, we now turn to the principles of metabolic regulation and flux partitioning. The liver must constantly make decisions about the fate of incoming nutrients, and a critical branch point occurs in fatty acid metabolism. This exercise [@problem_id:2573686] presents a scenario where you must predict the consequences of inhibiting Carnitine Palmitoyltransferase 1 (CPT1), the gatekeeper for fatty acid entry into mitochondria. This practice will hone your qualitative reasoning skills, forcing you to deduce how inhibiting $\\beta$-oxidation shunts fatty acids towards re-esterification and export as VLDL triglycerides, a key concept in understanding both normal physiology and pathologies like non-alcoholic fatty liver disease.", "problem": "A human subject in the post-absorptive to early-fasted state has elevated delivery of non-esterified long-chain fatty acids to the liver. Consider the following steady-state flux partition of hepatic long-chain fatty acyl-coenzyme A: let $J_{\\text{in}}$ be the influx of long-chain fatty acids into hepatocytes; $J_{\\text{mit}}$ be the flux of long-chain fatty acyl-coenzyme A into mitochondria for $\\beta$-oxidation via Carnitine Palmitoyltransferase 1 (CPT1); $J_{\\text{TG}}$ be the flux of long-chain fatty acyl-coenzyme A into re-esterification to triglyceride destined for Very Low Density Lipoprotein (VLDL) secretion; and $J_{\\text{other}}$ summarize all minor fates. Assume peroxisomal oxidation and $J_{\\text{other}}$ are small and unchanged over the time frame considered, and that apolipoprotein B availability and microsomal triglyceride transfer protein activity are not rate limiting. In the fasting state, mitochondrial acetyl-coenzyme A produced by $\\beta$-oxidation is a principal substrate for hepatic ketogenesis.\n\nAn acute, liver-targeted CPT1 inhibitor is administered that selectively lowers $J_{\\text{mit}}$ without altering adipose lipolysis or plasma long-chain fatty acid supply, and without directly affecting apolipoprotein synthesis. Using flux conservation and the requirement for mitochondrial entry for $\\beta$-oxidation, predict the most likely direction of change in hepatic ketone body output and VLDL triglyceride secretion during the acute effect window, and justify based on the partitioning of $J_{\\text{in}}$ among fates.\n\nWhich option best captures the expected paired response?\n\nA. Ketogenesis decreases; VLDL triglyceride secretion increases.\n\nB. Ketogenesis decreases; VLDL triglyceride secretion decreases.\n\nC. Ketogenesis increases; VLDL triglyceride secretion decreases.\n\nD. Ketogenesis increases; VLDL triglyceride secretion increases.", "solution": "The problem statement will first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n- **State**: Human subject in post-absorptive to early-fasted state.\n- **Input Flux**: Elevated delivery of non-esterified long-chain fatty acids (LCFA) to the liver.\n- **Flux Definitions**:\n    - $J_{\\text{in}}$: Influx of LCFA into hepatocytes.\n    - $J_{\\text{mit}}$: Flux of long-chain fatty acyl-coenzyme A (LCFA-CoA) into mitochondria for $\\beta$-oxidation via Carnitine Palmitoyltransferase 1 (CPT1).\n    - $J_{\\text{TG}}$: Flux of LCFA-CoA into re-esterification to triglyceride (TG) for Very Low Density Lipoprotein (VLDL) secretion.\n    - $J_{\\text{other}}$: Flux into all other minor fates.\n- **Assumptions & Conditions**:\n    1. A steady-state flux partition is considered.\n    2. Peroxisomal oxidation and $J_{\\text{other}}$ are small and unchanged.\n    3. Apolipoprotein B (apoB) availability and microsomal triglyceride transfer protein (MTP) activity are not rate limiting for VLDL secretion.\n    4. In the fasting state, mitochondrial acetyl-coenzyme A from $\\beta$-oxidation is a principal substrate for hepatic ketogenesis.\n- **Intervention**: An acute, liver-targeted CPT1 inhibitor is administered.\n- **Effects of Intervention**:\n    1. Selectively lowers $J_{\\text{mit}}$.\n    2. Does not alter adipose lipolysis or plasma LCFA supply (implying $J_{\\text{in}}$ is constant).\n    3. Does not directly affect apolipoprotein synthesis.\n- **Question**: Predict the direction of change in hepatic ketone body output and VLDL triglyceride secretion.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria.\n- **Scientific Grounding**: The problem is well-grounded in the established principles of hepatic lipid metabolism. The partitioning of fatty acyl-CoA between mitochondrial $\\beta$-oxidation (controlled by CPT1) and esterification into triglycerides is a central, well-understood regulatory node in liver physiology. The link between fatty acid oxidation, acetyl-CoA production, and ketogenesis is a fundamental concept. The assumptions are standard and appropriate for creating a solvable, focused problem.\n- **Well-Posedness**: The problem is well-posed. Given the constraints (constant influx, constant minor fates, specific inhibition of one pathway), the principle of mass conservation dictates a unique qualitative outcome for the remaining major pathway.\n- **Objectivity**: The problem is stated in objective, technical language, free from ambiguity or subjective elements.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, logically consistent, and well-posed. It presents a valid scenario in metabolic physiology. Therefore, a solution will be derived.\n\n### Derivation\nThe core of this problem lies in the principle of conservation of metabolic flux. In a steady state, the total influx of a substrate into a metabolic pool must equal the total efflux from that pool. Here, the substrate is the pool of long-chain fatty acyl-coenzyme A (LCFA-CoA) within the hepatocyte.\n\nThe total influx is given by $J_{\\text{in}}$, the rate of uptake of LCFA from plasma and their subsequent activation to LCFA-CoA. The total efflux is the sum of the fluxes into all possible downstream pathways. According to the problem statement, the major fates are mitochondrial oxidation and triglyceride synthesis.\n\nWe can write the flux balance equation for the LCFA-CoA pool as:\n$$J_{\\text{in}} = J_{\\text{mit}} + J_{\\text{TG}} + J_{\\text{other}}$$\n\nThe problem describes an acute change from an initial steady state (before inhibitor) to a new steady state (after inhibitor). Let us denote the pre-inhibitor state with subscript $1$ and the post-inhibitor state with subscript $2$.\n\nFor the initial state:\n$$J_{\\text{in},1} = J_{\\text{mit},1} + J_{\\text{TG},1} + J_{\\text{other},1}$$\nFor the final state:\n$$J_{\\text{in},2} = J_{\\text{mit},2} + J_{\\text{TG},2} + J_{\\text{other},2}$$\n\nWe apply the conditions given in the problem:\n1.  The supply of LCFA is unchanged, thus the influx is constant: $J_{\\text{in},1} = J_{\\text{in},2} = J_{\\text{in}}$.\n2.  The minor fates are unchanged: $J_{\\text{other},1} = J_{\\text{other},2} = J_{\\text{other}}$.\n3.  The CPT1 inhibitor selectively lowers the flux into mitochondria: $J_{\\text{mit},2}  J_{\\text{mit},1}$.\n\nSubstituting the constant terms, our two state equations become:\n$$J_{\\text{in}} = J_{\\text{mit},1} + J_{\\text{TG},1} + J_{\\text{other}}$$\n$$J_{\\text{in}} = J_{\\text{mit},2} + J_{\\text{TG},2} + J_{\\text{other}}$$\n\nBy equating these two expressions for $J_{\\text{in}}$, we get:\n$$J_{\\text{mit},1} + J_{\\text{TG},1} + J_{\\text{other}} = J_{\\text{mit},2} + J_{\\text{TG},2} + J_{\\text{other}}$$\nSubtracting the constant term $J_{\\text{other}}$ from both sides yields:\n$$J_{\\text{mit},1} + J_{\\text{TG},1} = J_{\\text{mit},2} + J_{\\text{TG},2}$$\nWe can rearrange this equation to find the change in $J_{\\text{TG}}$:\n$$J_{\\text{TG},2} - J_{\\text{TG},1} = J_{\\text{mit},1} - J_{\\text{mit},2}$$\n\nSince the inhibitor lowers the mitochondrial flux, we have $J_{\\text{mit},1} > J_{\\text{mit},2}$, which means the term on the right-hand side, $J_{\\text{mit},1} - J_{\\text{mit},2}$, must be a positive quantity.\nTherefore, it follows that:\n$J_{\\text{TG},2} - J_{\\text{TG},1} > 0 \\implies J_{\\text{TG},2} > J_{\\text{TG},1}$\nThis demonstrates that the flux of LCFA-CoA into triglyceride synthesis, $J_{\\text{TG}}$, must increase to compensate for the decrease in mitochondrial oxidation flux. The problem states that apoB and MTP activity are not rate-limiting, which means the liver has sufficient capacity to package and secrete these newly synthesized triglycerides as VLDL particles. Consequently, an increase in $J_{\\text{TG}}$ leads directly to an **increase in VLDL triglyceride secretion**.\n\nNext, we evaluate the effect on ketogenesis. The problem states that mitochondrial acetyl-CoA produced by $\\beta$-oxidation is the principal substrate for hepatic ketogenesis.\n1.  The flux of LCFA-CoA into mitochondria for $\\beta$-oxidation is $J_{\\text{mit}}$.\n2.  The CPT1 inhibitor directly and selectively decreases $J_{\\text{mit}}$.\n3.  A decrease in $J_{\\text{mit}}$ means a decrease in the rate of mitochondrial $\\beta$-oxidation.\n4.  A decrease in $\\beta$-oxidation leads to a decreased rate of production of its end product, acetyl-CoA.\n5.  Since acetyl-CoA is the substrate for ketogenesis, a reduced supply of acetyl-CoA will necessarily lead to a reduced rate of ketone body synthesis.\n\nTherefore, hepatic **ketogenesis decreases**.\n\nCombining these two results, the expected paired response is a decrease in ketogenesis and an increase in VLDL triglyceride secretion.\n\n### Option-by-Option Analysis\n- **A. Ketogenesis decreases; VLDL triglyceride secretion increases.**\nThis option matches our derived conclusion. The inhibition of CPT1 reduces the substrate (acetyl-CoA) for ketogenesis, thus decreasing it. The blocked fatty acyl-CoA is re-routed towards esterification, increasing triglyceride synthesis and subsequent VLDL secretion. **Correct**.\n\n- **B. Ketogenesis decreases; VLDL triglyceride secretion decreases.**\nThe first part is correct. The second part is incorrect. A decrease in VLDL secretion would imply that total fatty acid utilization by the liver has decreased, which contradicts the condition of constant fatty acid influx ($J_{\\text{in}}$) and the principle of flux conservation. The flux must be redirected, not simply lost. **Incorrect**.\n\n- **C. Ketogenesis increases; VLDL triglyceride secretion decreases.**\nThe first part is incorrect. Ketogenesis cannot increase when the supply of its substrate from fatty acid oxidation is being pharmacologically blocked. The second part is also incorrect, for the reason stated in the analysis of option B. **Incorrect**.\n\n- **D. Ketogenesis increases; VLDL triglyceride secretion increases.**\nThe first part is incorrect. As explained, ketogenesis must decrease. The second part is correct, but since the overall paired response is incorrect, the option is invalid. **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2573686"}, {"introduction": "As a capstone practice, we transition from qualitative reasoning about individual pathways to the quantitative modeling of an entire metabolic network. This problem introduces Flux Balance Analysis (FBA), a powerful computational framework used in systems biology to predict steady-state reaction rates across a complex network based on stoichiometric constraints and a defined biological objective. In this hands-on exercise [@problem_id:2573750], you will implement an FBA model for a simplified hepatic network to simulate distinct physiological states, such as the fed/glycolytic state and the fasting/ketogenic state. By optimizing for specific metabolic outputs, you will gain practical experience in how systems-level properties of the liver emerge from the interaction of its component pathways.", "problem": "You are given a small, mass-balanced network that captures core carbon flows of human hepatic metabolism under cytosolic and mitochondrial steady state. Use Flux Balance Analysis (FBA) to compute optimal steady-state fluxes under fed and fasting constraints for three distinct scenarios. Base your reasoning and implementation on the following foundational principles: (i) conservation of mass at steady state, expressed as $S \\, v = 0$ where $S$ is the stoichiometric matrix and $v$ is the vector of reaction fluxes, (ii) reaction reversibility encoded in lower and upper bounds on $v$, and (iii) linear optimization of a biologically motivated objective function. Ensure all fluxes are expressed in millimoles per gram dry weight per hour (mmol gDW$^{-1}$ h$^{-1}$) and report the final numerical outputs rounded to three decimal places.\n\nMetabolites (internal, state vector rows in order): $\\mathrm{GLU}$ (cytosolic glucose), $\\mathrm{G6P}$ (glucose $6$-phosphate), $\\mathrm{PYR}$ (pyruvate), $\\mathrm{LAC}$ (lactate), $\\mathrm{OAA}$ (oxaloacetate), $\\mathrm{ACCOA}$ (acetyl coenzyme A), $\\mathrm{AcAc}$ (acetoacetate).\n\nReactions (columns, flux vector $v$ indices $r0$ through $r13$):\n- $r0$: $\\varnothing \\rightarrow \\mathrm{GLU}$ (glucose uptake exchange; import).\n- $r1$: $\\mathrm{GLU} \\rightarrow \\varnothing$ (glucose export exchange; export).\n- $r2$: $\\mathrm{GLU} \\leftrightarrow \\mathrm{G6P}$ (reversible isomerization/phosphorylation lump).\n- $r3$: $\\mathrm{G6P} \\rightarrow 2\\,\\mathrm{PYR}$ (glycolysis lump).\n- $r4$: $\\mathrm{PYR} \\leftrightarrow \\mathrm{LAC}$ (lactate dehydrogenase, reversible).\n- $r5$: $\\varnothing \\rightarrow \\mathrm{LAC}$ (lactate uptake exchange; import).\n- $r6$: $\\mathrm{LAC} \\rightarrow \\varnothing$ (lactate export exchange; export).\n- $r7$: $\\mathrm{PYR} \\rightarrow \\mathrm{OAA}$ (pyruvate carboxylase).\n- $r8$: $2\\,\\mathrm{PYR} \\rightarrow \\mathrm{GLU}$ (gluconeogenesis lump).\n- $r9$: $\\mathrm{PYR} \\rightarrow \\mathrm{ACCOA}$ (pyruvate dehydrogenase).\n- $r10$: $\\varnothing \\rightarrow \\mathrm{ACCOA}$ (acetyl coenzyme A source from fatty acid beta-oxidation).\n- $r11$: $2\\,\\mathrm{ACCOA} \\rightarrow \\mathrm{AcAc}$ (ketogenesis).\n- $r12$: $\\mathrm{AcAc} \\rightarrow \\varnothing$ (acetoacetate export exchange).\n- $r13$: $\\mathrm{ACCOA} \\rightarrow \\varnothing$ (acetyl coenzyme A oxidation sink, proxy for tricarboxylic acid cycle (TCA) oxidation).\n\nStoichiometric matrix $S \\in \\mathbb{R}^{7 \\times 14}$, rows in the metabolite order above and columns in the reaction order above:\n$$\nS =\n\\begin{bmatrix}\n+1  -1  -1  0  0  0  0  0  +1  0  0  0  0  0 \\\\\n0  0  +1  -1  0  0  0  0  0  0  0  0  0  0 \\\\\n0  0  0  +2  -1  0  0  -1  -2  -1  0  0  0  0 \\\\\n0  0  0  0  +1  +1  -1  0  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  +1  0  0  0  0  0  0 \\\\\n0  0  0  0  0  0  0  0  0  +1  +1  -2  0  -1 \\\\\n0  0  0  0  0  0  0  0  0  0  0  +1  -1  0\n\\end{bmatrix}.\n$$\n\nBounds for each reaction $rj$ are given by lower bound $\\ell_j$ and upper bound $u_j$. The following general bounds apply unless overridden by scenario-specific constraints:\n- $r2$ and $r4$ are reversible: $\\ell_{2} = -10^3$, $u_{2} = +10^3$; $\\ell_{4} = -10^3$, $u_{4} = +10^3$.\n- All other internal metabolic and exchange reactions are irreversible forward: $\\ell_{j} = 0$, $u_{j} = +10^3$ for $j \\in \\{0,1,3,5,6,7,8,9,10,11,12,13\\}$, except where scenario bounds below further restrict them.\n\nYou must solve three scenarios by linear optimization subject to $S \\, v = 0$ and the bounds. In each scenario, the objective is a linear functional $c^\\top v$ to be maximized.\n\nScenario definitions and test suite (all flux capacities in mmol gDW$^{-1}$ h$^{-1}$):\n- Scenario A (Fed, glycolytic, happy path): $u_{0} = 10$, $u_{1} = 0$, $u_{5} = 0$, $u_{10} = 0$. Maximize lactate export: maximize $v_{6}$.\n- Scenario B (Fasting, gluconeogenic, reversible edge case): $u_{0} = 0$, $u_{1} = 10^3$, $u_{5} = 12$, $u_{10} = 0$. Maximize glucose export: maximize $v_{1}$.\n- Scenario C (Fasting, ketogenic, stoichiometric boundary): $u_{0} = 0$, $u_{1} = 0$, $u_{5} = 0$, $u_{10} = 20$. Maximize acetoacetate export: maximize $v_{12}$.\n\nImplementation requirements:\n- Use the steady-state constraint $S \\, v = 0$ and the bounds to formulate a linear program for each scenario.\n- Compute the optimal objective value for each scenario. Express each computed optimal value in mmol gDW$^{-1}$ h$^{-1}$, rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_A,x_B,x_C]$), where $x_A$, $x_B$, and $x_C$ are the optimal objective values for Scenarios A, B, and C, respectively, in that order.\n\nNotes:\n- Use Flux Balance Analysis (FBA) with linear programming, where the objective is to maximize $c^\\top v$.\n- Define gram dry weight (gDW) as the standard biomass-normalized unit in constraint-based modeling.\n- Ensure scientific realism by respecting irreversibility where specified and not violating mass balance.", "solution": "The problem presented is a standard application of Flux Balance Analysis (FBA), which is formalized as a linear programming (LP) problem. The objective is to determine the optimal steady-state flux distribution $v$ in a given metabolic network that maximizes a specified biological objective. The core constraints of the system are the law of conservation of mass at steady state and the thermodynamic and capacity constraints on reaction fluxes.\n\nThe LP formulation for each scenario is:\nMaximize: $c^\\top v$\nSubject to:\n$1$. $S \\, v = 0$ (steady-state mass balance)\n$2$. $\\ell \\le v \\le u$ (flux bounds)\n\nHere, $v \\in \\mathbb{R}^{14}$ is the vector of fluxes for reactions $r0$ through $r13$, $S \\in \\mathbb{R}^{7 \\times 14}$ is the given stoichiometric matrix, and $\\ell, u \\in \\mathbb{R}^{14}$ are the vectors of lower and upper bounds on the fluxes, respectively. The vector $c \\in \\mathbb{R}^{14}$ defines the linear objective function. We solve this for three distinct scenarios.\n\nThe general bounds are defined for all fluxes $v_j$ where $j \\in \\{0, 1, \\dots, 13\\}$. The reversible reactions $r2$ and $r4$ have bounds $[\\ell_j, u_j] = [-10^3, 10^3]$. All other reactions are irreversible, with general bounds $[\\ell_j, u_j] = [0, 10^3]$. These general bounds are modified by scenario-specific constraints.\n\nScenario A: Fed State, Glycolytic\nThe objective is to maximize lactate export, which corresponds to maximizing the flux $v_6$. The objective function is therefore $c^\\top v = v_6$.\nThe specific constraints for this scenario are:\n- Glucose uptake capacity: $v_0 \\le 10$ mmol gDW$^{-1}$ h$^{-1}$. Thus, the bounds for $v_0$ are $[0, 10]$.\n- No glucose export: $v_1 = 0$. The bounds for $v_1$ are $[0, 0]$.\n- No lactate uptake: $v_5 = 0$. The bounds for $v_5$ are $[0, 0]$.\n- No acetyl-CoA from fatty acids: $v_{10} = 0$. The bounds for $v_{10}$ are $[0, 0]$.\n\nThe optimal metabolic pathway to maximize lactate export from glucose is glycolysis. The stoichiometric path is $\\mathrm{GLU} \\rightarrow \\mathrm{G6P} \\rightarrow 2\\,\\mathrm{PYR} \\rightarrow 2\\,\\mathrm{LAC}$. Mass balance analysis shows that for every $1$ mole of glucose consumed, $2$ moles of lactate can be produced.\nWith a maximum glucose uptake $v_0 = 10$, the system can achieve a maximum lactate production flux.\n- Steady state for GLU: $v_0 - v_1 - v_2 + v_8 = 0$. Given $v_0=10$, $v_1 = 0$, and assuming no gluconeogenesis ($v_8=0$), we have $v_2 = 10$.\n- Steady state for G6P: $v_2 - v_3 = 0 \\implies v_3 = 10$.\n- Steady state for PYR: $2v_3 - v_4 - \\dots = 0$. This gives $2 \\times 10 = 20$ units of pyruvate flux.\n- Steady state for LAC: $v_4 + v_5 - v_6 = 0$. The $20$ units of pyruvate flux are converted to lactate ($v_4 = 20$), and with no lactate uptake ($v_5=0$), the export flux $v_6$ must equal $20$.\nThe optimal objective value is therefore $20.000$ mmol gDW$^{-1}$ h$^{-1}$.\n\nScenario B: Fasting State, Gluconeogenic\nThe objective is to maximize glucose export, which corresponds to maximizing the flux $v_1$. The objective function is $c^\\top v = v_1$.\nThe specific constraints are:\n- No glucose uptake: $v_0 = 0$. Bounds for $v_0$ are $[0, 0]$.\n- Lactate uptake capacity: $v_5 \\le 12$ mmol gDW$^{-1}$ h$^{-1}$. Bounds for $v_5$ are $[0, 12]$.\n- No acetyl-CoA from fatty acids: $v_{10} = 0$. Bounds for $v_{10}$ are $[0, 0]$.\n\nTo maximize glucose export, the liver utilizes gluconeogenesis, converting precursors like lactate into glucose. The pathway is essentially the reverse of glycolysis: $2\\,\\mathrm{LAC} \\rightarrow 2\\,\\mathrm{PYR} \\rightarrow \\mathrm{GLU}$.\nWith a maximum lactate uptake $v_5 = 12$, the system can support a corresponding glucose production flux.\n- To utilize the imported lactate, the reversible reaction $r4$ must run in reverse ($\\mathrm{LAC} \\rightarrow \\mathrm{PYR}$), so $v_4$ will be negative. Steady state for LAC: $v_4 + v_5 - v_6 = 0$. To maximize glucose output, no lactate should be re-exported ($v_6=0$), so $v_4 = -v_5 = -12$.\n- The flux $v_4 = -12$ indicates a production of $12$ units of pyruvate flux.\n- This pyruvate is used for gluconeogenesis via reaction $r8: 2\\,\\mathrm{PYR} \\rightarrow \\mathrm{GLU}$. The rate of this reaction is limited by the availability of pyruvate. $v_8 = 12 / 2 = 6$.\n- Steady state for GLU: $v_0 - v_1 - v_2 + v_8 = 0$. With $v_0=0$ and $v_2=0$ (glycolysis is inactive), we have $-v_1 + v_8 = 0$, which implies $v_1 = v_8 = 6$.\nThe optimal objective value is $6.000$ mmol gDW$^{-1}$ h$^{-1}$.\n\nScenario C: Fasting State, Ketogenic\nThe objective is to maximize acetoacetate export, which is the flux $v_{12}$. The objective function is $c^\\top v = v_{12}$.\nThe specific constraints are:\n- No glucose exchange: $v_0 = 0$, $v_1 = 0$.\n- No lactate uptake: $v_5 = 0$.\n- Acetyl-CoA source from fatty acid oxidation: $v_{10} \\le 20$ mmol gDW$^{-1}$ h$^{-1}$. Bounds for $v_{10}$ are $[0, 20]$.\n\nIn this state, the liver performs ketogenesis, converting acetyl-CoA from fatty acid breakdown into ketone bodies like acetoacetate. The pathway is $2\\,\\mathrm{ACCOA} \\rightarrow \\mathrm{AcAc}$.\n- The maximum available acetyl-CoA from fatty acid oxidation is $v_{10} = 20$.\n- Steady state for ACCOA: $v_9 + v_{10} - 2v_{11} - v_{13} = 0$. With no carbohydrate inputs, pyruvate-related fluxes are zero ($v_9=0$). This gives $20 - 2v_{11} - v_{13} = 0$.\n- Steady state for AcAc: $v_{11} - v_{12} = 0 \\implies v_{11} = v_{12}$.\n- To maximize $v_{12}$, one must maximize $v_{11}$. This is achieved by minimizing the flux sink $v_{13}$ (TCA cycle oxidation). The minimum for $v_{13}$ is $0$.\n- Setting $v_{13} = 0$, the acetyl-CoA balance becomes $20 - 2v_{11} = 0$, which yields $v_{11} = 10$.\n- Therefore, the maximal export flux is $v_{12} = v_{11} = 10$.\nThe optimal objective value is $10.000$ mmol gDW$^{-1}$ h$^{-1}$.\n\nIn summary, the optimal values for the objective functions in Scenarios A, B, and C are $20.000$, $6.000$, and $10.000$ mmol gDW$^{-1}$ h$^{-1}$, respectively.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a Flux Balance Analysis problem for a simplified hepatic metabolic network\n    under three different physiological scenarios.\n    \"\"\"\n    # Stoichiometric matrix S (7 metabolites x 14 reactions)\n    # Metabolites: GLU, G6P, PYR, LAC, OAA, ACCOA, AcAc\n    # Reactions: r0-r13\n    S = np.array([\n        # r0, r1, r2, r3, r4, r5, r6, r7, r8,   r9, r10, r11, r12, r13\n        [+1, -1, -1,  0,  0,  0,  0,  0, +1,   0,   0,   0,   0,   0],  # GLU\n        [ 0,  0, +1, -1,  0,  0,  0,  0,  0,   0,   0,   0,   0,   0],  # G6P\n        [ 0,  0,  0, +2, -1,  0,  0, -1, -2,  -1,   0,   0,   0,   0],  # PYR\n        [ 0,  0,  0,  0, +1, +1, -1,  0,  0,   0,   0,   0,   0,   0],  # LAC\n        [ 0,  0,  0,  0,  0,  0,  0, +1,  0,   0,   0,   0,   0,   0],  # OAA\n        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  +1,  +1,  -2,   0,  -1],  # ACCOA\n        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,   0,   0,  +1,  -1,   0],  # AcAc\n    ])\n\n    num_reactions = 14\n    inf = 1000  # A large number to represent infinity for flux bounds\n\n    # Define base bounds for the 14 reactions (r0 to r13).\n    # All are irreversible (0, inf) except for r2 and r4 which are reversible.\n    base_bounds = [(0, inf) for _ in range(num_reactions)]\n    base_bounds[2] = (-inf, inf)  # r2 is reversible\n    base_bounds[4] = (-inf, inf)  # r4 is reversible\n\n    # Define the three scenarios as test cases. Each case specifies:\n    # - a name for identification\n    # - the index of the flux to be maximized in the objective function\n    # - a dictionary of bounds to override the base_bounds\n    test_cases = [\n        {   # Scenario A: Fed, glycolytic\n            'name': 'A',\n            'obj_idx': 6,  # Maximize v6 (Lactate export)\n            'bounds_overrides': {\n                0: (0, 10), # r0: GLU uptake limit\n                1: (0, 0),  # r1: No GLU export\n                5: (0, 0),  # r5: No LAC uptake\n                10: (0, 0) # r10: No ACCOA from FA\n            }\n        },\n        {   # Scenario B: Fasting, gluconeogenic\n            'name': 'B',\n            'obj_idx': 1,  # Maximize v1 (Glucose export)\n            'bounds_overrides': {\n                0: (0, 0),   # r0: No GLU uptake\n                5: (0, 12),  # r5: LAC uptake limit\n                10: (0, 0)  # r10: No ACCOA from FA\n            }\n        },\n        {   # Scenario C: Fasting, ketogenic\n            'name': 'C',\n            'obj_idx': 12, # Maximize v12 (Acetoacetate export)\n            'bounds_overrides': {\n                0: (0, 0),   # r0: No GLU uptake\n                1: (0, 0),   # r1: No GLU export\n                5: (0, 0),   # r5: No LAC uptake\n                10: (0, 20)  # r10: ACCOA source limit\n            }\n        }\n    ]\n\n    results = []\n    # Right-hand side of the steady-state equation Sv = 0\n    b_eq = np.zeros(S.shape[0])\n\n    for case in test_cases:\n        # Objective function vector c. To maximize c'v, we minimize -c'v.\n        # The objective is to maximize a single flux, so c has -1 at that flux's index.\n        c = np.zeros(num_reactions)\n        c[case['obj_idx']] = -1\n\n        # Apply scenario-specific bounds\n        scenario_bounds = base_bounds.copy()\n        for idx, b in case['bounds_overrides'].items():\n            scenario_bounds[idx] = b\n\n        # Solve the linear programming problem\n        res = linprog(c=c,\n                      A_eq=S,\n                      b_eq=b_eq,\n                      bounds=scenario_bounds,\n                      method='highs')\n\n        if res.success:\n            # linprog minimizes, so the maximum value is the negative of the result\n            optimal_value = -res.fun\n            results.append(optimal_value)\n        else:\n            # Handle cases where solver fails, though not expected for this problem\n            results.append(np.nan)\n\n    # Format the final output string as specified: [val_A,val_B,val_C]\n    # with each value rounded to three decimal places.\n    print(f\"[{','.join(f'{val:.3f}' for val in results)}]\")\n\nsolve()\n```", "id": "2573750"}]}