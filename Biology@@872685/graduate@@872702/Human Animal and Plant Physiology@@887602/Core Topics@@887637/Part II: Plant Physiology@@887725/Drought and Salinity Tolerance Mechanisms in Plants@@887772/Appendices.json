{"hands_on_practices": [{"introduction": "Under saline conditions, maintaining cellular ion homeostasis is a primary challenge. This practice delves into the fundamental biophysics of ion transport by applying the Nernst equation to a plant root cell [@problem_id:2563981]. By calculating the equilibrium potentials for both potassium and sodium, you will be able to quantify the electrochemical driving forces that govern their passive movement, providing a crucial foundation for understanding why active transport is essential for survival in saline environments.", "problem": "A root epidermal cell of a halophytic plant is exposed to saline soil solution. Assume the membrane is selectively permeable to monovalent cations and that activities can be approximated by concentrations (ideal dilute solution). At thermodynamic equilibrium for each ion, the electrochemical potential across the plasma membrane must be equal on both sides, i.e., for an ion of valence $z$, the equality of electrochemical potential $\\mu$ between cytosol and apoplast satisfies $\\mu^{\\circ} + RT \\ln a_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = \\mu^{\\circ} + RT \\ln a_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}}$, where $R$ is the universal gas constant, $T$ is absolute temperature, $F$ is the Faraday constant, $a$ is activity, and $\\psi$ is the electric potential. Under the ideal dilute approximation, take $a \\approx [\\cdot]$, the molar concentration.\n\nGiven:\n- Temperature $T = 298.15\\ \\mathrm{K}$,\n- Universal gas constant $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$,\n- Faraday constant $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$,\n- Valence $z = +1$ for both $\\mathrm{K}^{+}$ and $\\mathrm{Na}^{+}$,\n- Cytosolic concentrations $[\\mathrm{K}^{+}]_{\\mathrm{in}} = 100\\ \\mathrm{mM}$ and $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 20\\ \\mathrm{mM}$,\n- Apoplastic concentrations $[\\mathrm{K}^{+}]_{\\mathrm{out}} = 10\\ \\mathrm{mM}$ and $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 200\\ \\mathrm{mM}$,\n- Membrane potential (cytosol relative to apoplast) $V_{m} = -120\\ \\mathrm{mV}$.\n\nTasks:\n1. From the equality of electrochemical potentials, derive the equilibrium potential $E_{\\mathrm{ion}}$ for a monovalent cation in terms of $R$, $T$, $F$, and the ratio $[\\mathrm{out}]/[\\mathrm{in}]$.\n2. Compute the equilibrium potentials $E_{\\mathrm{K}}$ and $E_{\\mathrm{Na}}$ (express each in $\\mathrm{mV}$).\n3. Using the driving force $\\Delta V_{\\mathrm{ion}} = V_{m} - E_{\\mathrm{ion}}$, infer the direction of the passive flux (inward to cytosol or outward to apoplast) for $\\mathrm{K}^{+}$ and $\\mathrm{Na}^{+}$ at the given $V_{m}$.\n4. Let $r$ be the ratio of the magnitudes of the passive electrochemical driving forces for $\\mathrm{Na}^{+}$ and $\\mathrm{K}^{+}$, defined by $r = \\dfrac{|\\Delta V_{\\mathrm{Na}}|}{|\\Delta V_{\\mathrm{K}}|}$. Report $r$ as the final numeric answer. Round your final numeric answer to four significant figures. The ratio $r$ is dimensionless.\n\nExpress all intermediate equilibrium potentials in $\\mathrm{mV}$, but report only the final ratio $r$ as the answer.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Problem Validation**\n\n**Step 1: Extracted Givens**\n- Fundamental Principle: Equality of electrochemical potential at equilibrium, $\\mu^{\\circ} + RT \\ln a_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = \\mu^{\\circ} + RT \\ln a_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}}$.\n- Approximation: $a \\approx [\\cdot]$ (activity is approximated by molar concentration).\n- Constants:\n    - Temperature, $T = 298.15\\ \\mathrm{K}$.\n    - Universal gas constant, $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n    - Faraday constant, $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$.\n- Ion Properties:\n    - Valence for $\\mathrm{K}^{+}$ and $\\mathrm{Na}^{+}$ is $z = +1$.\n- Conditions:\n    - Cytosolic concentrations: $[\\mathrm{K}^{+}]_{\\mathrm{in}} = 100\\ \\mathrm{mM}$, $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 20\\ \\mathrm{mM}$.\n    - Apoplastic concentrations: $[\\mathrm{K}^{+}]_{\\mathrm{out}} = 10\\ \\mathrm{mM}$, $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 200\\ \\mathrm{mM}$.\n    - Membrane potential, $V_{m} = \\psi_{\\mathrm{in}} - \\psi_{\\mathrm{out}} = -120\\ \\mathrm{mV}$.\n- Definitions:\n    - Equilibrium potential, $E_{\\mathrm{ion}}$.\n    - Driving force, $\\Delta V_{\\mathrm{ion}} = V_{m} - E_{\\mathrm{ion}}$.\n    - Ratio of driving forces, $r = \\dfrac{|\\Delta V_{\\mathrm{Na}}|}{|\\Delta V_{\\mathrm{K}}|}$.\n- Tasks:\n    1. Derive the expression for $E_{\\mathrm{ion}}$.\n    2. Compute numerical values for $E_{\\mathrm{K}}$ and $E_{\\mathrm{Na}}$.\n    3. Infer the direction of passive ion flux for $\\mathrm{K}^{+}$ and $\\mathrm{Na}^{+}$.\n    4. Compute the numerical value of $r$, rounded to four significant figures.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is assessed against the required criteria.\n- **Scientifically Grounded:** The problem is based on the Nernst equation, a fundamental principle of electrochemistry and biophysics. The provided values for temperature, ion concentrations, and membrane potential are physiologically realistic for a halophytic plant cell under saline conditions. The context is appropriate for the specified field of plant physiology.\n- **Well-Posed:** The problem provides all necessary data and definitions. The tasks are clearly stated and structured logically, leading to a unique and stable solution.\n- **Objective:** The problem is formulated using precise, quantitative language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is determined to be **valid**. It is self-contained, scientifically sound, and well-posed. A rigorous solution can be constructed.\n\n**Solution**\n\n**Task 1: Derivation of the Equilibrium Potential ($E_{\\mathrm{ion}}$)**\nThe condition for thermodynamic equilibrium for an ion across a membrane is the equality of its electrochemical potential on both sides.\n$$ \\mu^{\\circ} + RT \\ln a_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = \\mu^{\\circ} + RT \\ln a_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}} $$\nThe standard chemical potential, $\\mu^{\\circ}$, is identical on both sides and is eliminated. Using the given approximation that activity $a$ can be replaced by molar concentration $[\\cdot]$, we have:\n$$ RT \\ln [\\mathrm{ion}]_{\\mathrm{in}} + z F \\psi_{\\mathrm{in}} = RT \\ln [\\mathrm{ion}]_{\\mathrm{out}} + z F \\psi_{\\mathrm{out}} $$\nThe equilibrium potential, $E_{\\mathrm{ion}}$, is defined as the potential difference across the membrane, $\\psi_{\\mathrm{in}} - \\psi_{\\mathrm{out}}$, at which there is no net flux of the ion. We rearrange the equation to solve for this difference:\n$$ z F (\\psi_{\\mathrm{in}} - \\psi_{\\mathrm{out}}) = RT \\ln [\\mathrm{ion}]_{\\mathrm{out}} - RT \\ln [\\mathrm{ion}]_{\\mathrm{in}} $$\n$$ z F E_{\\mathrm{ion}} = RT \\ln \\left( \\frac{[\\mathrm{ion}]_{\\mathrm{out}}}{[\\mathrm{ion}]_{\\mathrm{in}}} \\right) $$\nThis yields the Nernst equation for the equilibrium potential:\n$$ E_{\\mathrm{ion}} = \\frac{RT}{zF} \\ln \\left( \\frac{[\\mathrm{ion}]_{\\mathrm{out}}}{[\\mathrm{ion}]_{\\mathrm{in}}} \\right) $$\nFor a monovalent cation, the valence $z$ is $+1$, so the expression becomes:\n$$ E_{\\mathrm{ion}} = \\frac{RT}{F} \\ln \\left( \\frac{[\\mathrm{ion}]_{\\mathrm{out}}}{[\\mathrm{ion}]_{\\mathrm{in}}} \\right) $$\n\n**Task 2: Computation of Equilibrium Potentials ($E_{\\mathrm{K}}$ and $E_{\\mathrm{Na}}$)**\nFirst, we calculate the value of the term $\\frac{RT}{F}$ using the provided constants.\n$$ \\frac{RT}{F} = \\frac{(8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) (298.15\\ \\mathrm{K})}{96485.33212\\ \\mathrm{C\\,mol^{-1}}} \\approx 0.02569257\\ \\mathrm{V} $$\nThis is equivalent to $25.69257\\ \\mathrm{mV}$. We will use this value for subsequent calculations.\n\nFor potassium ($\\mathrm{K}^{+}$), where $[\\mathrm{K}^{+}]_{\\mathrm{out}} = 10\\ \\mathrm{mM}$ and $[\\mathrm{K}^{+}]_{\\mathrm{in}} = 100\\ \\mathrm{mM}$:\n$$ E_{\\mathrm{K}} = \\frac{RT}{F} \\ln \\left( \\frac{[\\mathrm{K}^{+}]_{\\mathrm{out}}}{[\\mathrm{K}^{+}]_{\\mathrm{in}}} \\right) = (25.69257\\ \\mathrm{mV}) \\ln \\left( \\frac{10}{100} \\right) = (25.69257\\ \\mathrm{mV}) \\ln(0.1) $$\n$$ E_{\\mathrm{K}} \\approx (25.69257\\ \\mathrm{mV}) \\times (-2.302585) \\approx -59.1563\\ \\mathrm{mV} $$\n\nFor sodium ($\\mathrm{Na}^{+}$), where $[\\mathrm{Na}^{+}]_{\\mathrm{out}} = 200\\ \\mathrm{mM}$ and $[\\mathrm{Na}^{+}]_{\\mathrm{in}} = 20\\ \\mathrm{mM}$:\n$$ E_{\\mathrm{Na}} = \\frac{RT}{F} \\ln \\left( \\frac{[\\mathrm{Na}^{+}]_{\\mathrm{out}}}{[\\mathrm{Na}^{+}]_{\\mathrm{in}}} \\right) = (25.69257\\ \\mathrm{mV}) \\ln \\left( \\frac{200}{20} \\right) = (25.69257\\ \\mathrm{mV}) \\ln(10) $$\n$$ E_{\\mathrm{Na}} \\approx (25.69257\\ \\mathrm{mV}) \\times (2.302585) \\approx +59.1563\\ \\mathrm{mV} $$\nThe equilibrium potentials are $E_{\\mathrm{K}} \\approx -59.16\\ \\mathrm{mV}$ and $E_{\\mathrm{Na}} \\approx +59.16\\ \\mathrm{mV}$.\n\n**Task 3: Inference of Passive Flux Direction**\nThe electrochemical driving force for an ion is given by $\\Delta V_{\\mathrm{ion}} = V_{m} - E_{\\mathrm{ion}}$. Passive flux occurs down the electrochemical potential gradient. For a cation ($z>0$), a negative driving force ($\\Delta V_{\\mathrm{ion}} < 0$) signifies that the net flux is directed inward, into the cytosol. A positive driving force ($\\Delta V_{\\mathrm{ion}} > 0$) signifies an outward flux. The given membrane potential is $V_{m} = -120\\ \\mathrm{mV}$.\n\nFor $\\mathrm{K}^{+}$:\n$$ \\Delta V_{\\mathrm{K}} = V_{m} - E_{\\mathrm{K}} = (-120\\ \\mathrm{mV}) - (-59.1563\\ \\mathrm{mV}) = -60.8437\\ \\mathrm{mV} $$\nSince $\\Delta V_{\\mathrm{K}} < 0$, the passive flux of $\\mathrm{K}^{+}$ is **inward** (into the cytosol).\n\nFor $\\mathrm{Na}^{+}$:\n$$ \\Delta V_{\\mathrm{Na}} = V_{m} - E_{\\mathrm{Na}} = (-120\\ \\mathrm{mV}) - (59.1563\\ \\mathrm{mV}) = -179.1563\\ \\mathrm{mV} $$\nSince $\\Delta V_{\\mathrm{Na}} < 0$, the passive flux of $\\mathrm{Na}^{+}$ is also **inward** (into the cytosol).\n\n**Task 4: Calculation of the Ratio $r$**\nThe ratio $r$ is defined as the magnitude of the driving force for $\\mathrm{Na}^{+}$ divided by the magnitude of the driving force for $\\mathrm{K}^{+}$.\n$$ r = \\frac{|\\Delta V_{\\mathrm{Na}}|}{|\\Delta V_{\\mathrm{K}}|} $$\nUsing the values calculated in the previous step:\n$$ r = \\frac{|-179.1563\\ \\mathrm{mV}|}{|-60.8437\\ \\mathrm{mV}|} = \\frac{179.1563}{60.8437} \\approx 2.944895 $$\nThe problem requires rounding the final numeric answer to four significant figures.\n$$ r \\approx 2.945 $$\nThis ratio is dimensionless, as it is a ratio of two quantities with the same units.", "answer": "$$\n\\boxed{2.945}\n$$", "id": "2563981"}, {"introduction": "A key strategy for maintaining turgor under water stress is osmotic adjustment through the accumulation of compatible solutes. This exercise provides a quantitative look at this process by focusing on proline, a common osmoprotectant [@problem_id:2564001]. You will first use the van 't Hoff relation to determine the concentration of proline needed to achieve a target osmotic potential, and then calculate the substantial carbon and energy cost of its synthesis, highlighting the critical trade-offs between tolerance and resource allocation.", "problem": "A mesophyll cell of a drought-stressed plant accumulates the compatible solute proline in its cytosol to lower its osmotic potential and thus retain water. Assume the cytosolic solution behaves ideally at the scale relevant for osmotic pressure, and that proline behaves as a non-electrolyte with effective osmotic coefficient near unity under these conditions. The target is to achieve an osmotic adjustment of magnitude $0.5\\ \\mathrm{MPa}$ at $25^{\\circ}\\mathrm{C}$ entirely by the accumulation of proline. Take the universal gas constant as $R = 0.008314\\ \\mathrm{MPa\\ L\\ mol^{-1}\\ K^{-1}}$.\n\nIn addition to finding the required intracellular proline concentration, estimate the associated carbon cost under the following explicit biochemical assumptions about the predominant glutamate pathway of proline biosynthesis in plants:\n- Per mole of proline synthesized from glutamate, the pathway consumes $1$ mole of adenosine triphosphate (ATP) and $2$ moles of reduced nicotinamide adenine dinucleotide phosphate (NADPH).\n- The five-carbon skeleton for proline is supplied from carbohydrate such that $1$ mole of glucose provides the carbon skeleton for $1$ mole of proline, with $1$ mole of carbon lost as carbon dioxide during conversion of hexose-derived intermediates to $\\alpha$-ketoglutarate (i.e., $6$ carbons in glucose $\\rightarrow 5$ carbons in proline $+ 1$ carbon in carbon dioxide).\n- Nicotinamide adenine dinucleotide phosphate (NADPH) is generated exclusively by the oxidative pentose phosphate pathway (OPPP), which yields $12$ moles of NADPH per mole of glucose fully oxidized to $6$ moles of carbon dioxide.\n- The single ATP required is furnished by complete mitochondrial oxidation of glucose, with an effective yield of $30$ moles of ATP per mole of glucose fully oxidized to $6$ moles of carbon dioxide.\n- Glucose used to supply energy and reducing power is in addition to the glucose supplying the carbon skeleton; there is no double-counting between these pools.\n\nTasks:\n- Using only fundamental thermodynamic reasoning appropriate for dilute solutions, determine the required intracellular proline concentration that produces an osmotic potential contribution of magnitude $0.5\\ \\mathrm{MPa}$ at $25^{\\circ}\\mathrm{C}$.\n- Using the biochemical stoichiometries above, compute the minimal glucose consumption per liter of cytosol required to synthesize and accumulate that concentration of proline, expressed as moles of glucose per liter.\n\nReport your final result as a row vector $\\big[C_{\\mathrm{pro}}\\ (\\mathrm{mol\\ L^{-1}}),\\ n_{\\mathrm{glc}}\\ (\\mathrm{mol\\ L^{-1}})\\big]$, where $C_{\\mathrm{pro}}$ is the required proline concentration and $n_{\\mathrm{glc}}$ is the corresponding glucose requirement. Round both entries to three significant figures.", "solution": "To determine the proline concentration required for a target osmotic adjustment, we use the well-tested thermodynamic description of osmotic potential for dilute, ideal solutions, which is equivalent to the van 't Hoff relation: the osmotic potential contribution of a non-electrolyte at concentration $C$ is given by\n$$\n\\Psi_{s} = - i R T C,\n$$\nwhere $i$ is the van 't Hoff factor, $R$ is the universal gas constant, $T$ is absolute temperature, and $C$ is the molar concentration of the solute. For proline acting as a non-electrolyte under these conditions, we take $i = 1$.\n\nThe target magnitude of osmotic adjustment is $|\\Psi_{s}| = 0.5\\ \\mathrm{MPa}$ at $T = 25^{\\circ}\\mathrm{C} = 298.15\\ \\mathrm{K}$. With $R = 0.008314\\ \\mathrm{MPa\\ L\\ mol^{-1}\\ K^{-1}}$, we solve for the required concentration $C_{\\mathrm{pro}}$:\n$$\n|\\Psi_{s}| = R T C_{\\mathrm{pro}} \\quad \\Longrightarrow \\quad C_{\\mathrm{pro}} = \\frac{|\\Psi_{s}|}{R T} = \\frac{0.5}{0.008314 \\times 298.15}.\n$$\nCompute the denominator:\n$$\nR T = 0.008314 \\times 298.15 \\approx 2.4789\\ \\mathrm{MPa\\ L\\ mol^{-1}}.\n$$\nThus,\n$$\nC_{\\mathrm{pro}} \\approx \\frac{0.5}{2.4789} \\approx 0.2017\\ \\mathrm{mol\\ L^{-1}}.\n$$\nRounding to three significant figures gives\n$$\nC_{\\mathrm{pro}} \\approx 0.202\\ \\mathrm{mol\\ L^{-1}}.\n$$\n\nNext, we estimate the glucose requirement per liter of cytosol to synthesize and accumulate $C_{\\mathrm{pro}}$ moles of proline per liter, using the stated stoichiometries.\n\nLet $n_{\\mathrm{pro}}$ be the moles of proline per liter; here $n_{\\mathrm{pro}} = C_{\\mathrm{pro}}$ because concentrations are per liter. The total glucose requirement per mole of proline, $g$ (in moles glucose per mole proline), is the sum of three independent contributions:\n- Carbon skeleton supply: by assumption, $1$ mole of glucose supplies the five-carbon skeleton for $1$ mole of proline (with $1$ carbon lost as carbon dioxide), contributing\n$$\ng_{\\mathrm{C}} = 1.\n$$\n- Reducing power: $2$ moles of nicotinamide adenine dinucleotide phosphate (NADPH) per mole of proline are needed. The oxidative pentose phosphate pathway yields $12$ moles of NADPH per mole of glucose fully oxidized to $6$ moles of carbon dioxide. Therefore, the glucose required for reducing power is\n$$\ng_{\\mathrm{NADPH}} = \\frac{2}{12} = \\frac{1}{6}.\n$$\n- Adenosine triphosphate (ATP): $1$ mole of ATP per mole of proline is needed. Complete oxidation of glucose yields $30$ moles of ATP per mole of glucose. Therefore, the glucose required for ATP is\n$$\ng_{\\mathrm{ATP}} = \\frac{1}{30}.\n$$\n\nSumming these contributions gives the total glucose per mole of proline:\n$$\ng = g_{\\mathrm{C}} + g_{\\mathrm{NADPH}} + g_{\\mathrm{ATP}} = 1 + \\frac{1}{6} + \\frac{1}{30} = 1 + 0.166\\overline{6} + 0.033\\overline{3} = 1.2.\n$$\n\nTherefore, the glucose requirement per liter is\n$$\nn_{\\mathrm{glc}} = g \\times n_{\\mathrm{pro}} = 1.2 \\times C_{\\mathrm{pro}} \\approx 1.2 \\times 0.2017 \\approx 0.24204\\ \\mathrm{mol\\ L^{-1}}.\n$$\nRounding to three significant figures:\n$$\nn_{\\mathrm{glc}} \\approx 0.242\\ \\mathrm{mol\\ L^{-1}}.\n$$\n\nCollecting the two quantities and expressing them in the requested format yields\n$$\n\\big[C_{\\mathrm{pro}}\\ (\\mathrm{mol\\ L^{-1}}),\\ n_{\\mathrm{glc}}\\ (\\mathrm{mol\\ L^{-1}})\\big] \\approx \\big[0.202,\\ 0.242\\big].\n$$", "answer": "$$\\boxed{\\begin{bmatrix}0.202 & 0.242\\end{bmatrix}}$$", "id": "2564001"}, {"introduction": "The integrity of the xylem water transport system is paramount for plant survival, yet it is vulnerable to failure via cavitation under severe water stress. This hands-on computational practice introduces the standard methodology for quantifying this vulnerability by fitting a Weibull function to experimental data on conductivity loss [@problem_id:2564037]. By analyzing these 'vulnerability curves', you will extract critical ecophysiological traits like the $P_{50}$ and hydraulic safety margins, which are essential for comparing the drought tolerance strategies of different plant species.", "problem": "You are given datasets of xylem water potential and the corresponding percent loss of conductivity in plant stems. The physiological context is the cohesion-tension mechanism of water transport in xylem conduits and the observed vulnerability of those conduits to cavitation under drought or osmotic stress. A widely used and well-tested phenomenological model for xylem vulnerability curves represents the cumulative failure of conduits by a Weibull function on water potential. Let $\\Psi$ denote xylem water potential in megapascals (MPa), with more negative values indicating stronger tension, and let $\\mathrm{PLC}(\\Psi)$ denote the percent loss of conductivity in percent units. Your task is to fit the two-parameter Weibull model to each dataset using nonlinear least squares and then compute two derived hydraulic metrics: the water potential at $50$ percent loss of conductivity, denoted $P_{50}$, and the magnitude of the local slope of $\\mathrm{PLC}(\\Psi)$ at $\\Psi = P_{50}$.\n\nThe model to fit is the standard two-parameter Weibull cumulative form for $\\Psi \\le 0$,\n$$\n\\mathrm{PLC}(\\Psi) \\;=\\; 100 \\,\\Big[1 - \\exp\\!\\big(-\\big(\\tfrac{-\\Psi}{\\lambda}\\big)^{k}\\big)\\Big],\n$$\nwith scale parameter $\\lambda > 0$ and shape parameter $k > 0$. After fitting $(\\lambda,k)$ by minimizing the sum of squared residuals between observed and modeled $\\mathrm{PLC}$, compute:\n- $P_{50}$, defined by solving $\\mathrm{PLC}(P_{50}) = 50$ for $\\Psi$, and report it in megapascals (MPa).\n- $S_{50}$, the magnitude of the derivative $\\big|\\tfrac{d\\,\\mathrm{PLC}}{d\\Psi}\\big|$ evaluated at $\\Psi = P_{50}$, and report it in percentage-points per MPa.\n\nFinally, given an externally specified seasonal minimum xylem water potential $\\Psi_{\\min}$ (in MPa) for each dataset, compute the hydraulic safety margin $\\mathrm{HSM} = \\Psi_{\\min} - P_{50}$ in megapascals (MPa). Positive $\\mathrm{HSM}$ indicates that the experienced minimum tension is less negative than $P_{50}$ (safer), while negative $\\mathrm{HSM}$ indicates that it is more negative than $P_{50}$ (riskier).\n\nYour program must implement the fitting and computations for the following test suite. Each test case supplies a set of pairs $(\\Psi_i, \\mathrm{PLC}_i)$ and a value $\\Psi_{\\min}$:\n\n- Test case $1$ (drought-tolerant, steep curve):\n  - $\\Psi$ values (MPa): $[-0.5,\\,-1.0,\\,-1.5,\\,-2.0,\\,-2.5,\\,-3.0,\\,-3.5,\\,-4.0,\\,-5.0,\\,-6.0]$.\n  - $\\mathrm{PLC}$ values (percent): $[0.3,\\,2.3,\\,7.6,\\,17.0,\\,30.5,\\,46.7,\\,63.2,\\,77.5,\\,94.6,\\,99.4]$.\n  - $\\Psi_{\\min}$ (MPa): $-2.9$.\n\n- Test case $2$ (isohydric-like, shallow curve):\n  - $\\Psi$ values (MPa): $[-0.3,\\,-0.6,\\,-0.9,\\,-1.2,\\,-1.5,\\,-1.8,\\,-2.1,\\,-2.4,\\,-3.0,\\,-3.6,\\,-4.5]$.\n  - $\\mathrm{PLC}$ values (percent): $[10.6,\\,21.3,\\,31.1,\\,40.1,\\,48.1,\\,55.1,\\,61.3,\\,66.7,\\,75.6,\\,82.1,\\,88.8]$.\n  - $\\Psi_{\\min}$ (MPa): $-1.7$.\n\n- Test case $3$ (salt-stressed, very steep curve):\n  - $\\Psi$ values (MPa): $[-0.5,\\,-1.0,\\,-1.5,\\,-2.0,\\,-2.2,\\,-2.4,\\,-2.6,\\,-3.0,\\,-3.5,\\,-4.0]$.\n  - $\\mathrm{PLC}$ values (percent): $[0.0,\\,0.8,\\,6.2,\\,23.6,\\,35.3,\\,48.9,\\,63.2,\\,87.0,\\,98.8,\\,100.0]$.\n  - $\\Psi_{\\min}$ (MPa): $-2.6$.\n\nAlgorithmic requirements and definitions to use:\n- Fit $(\\lambda,k)$ by minimizing $\\sum_i \\big(\\mathrm{PLC}_i - \\mathrm{PLC}(\\Psi_i;\\lambda,k)\\big)^2$ with the constraints $\\lambda > 0$ and $k > 0$.\n- Derive $P_{50}$ by solving $\\mathrm{PLC}(\\Psi) = 50$ under the above model using algebraic manipulation.\n- Compute the slope magnitude $S_{50} = \\big|\\tfrac{d\\,\\mathrm{PLC}}{d\\Psi}\\big|_{\\Psi=P_{50}}$ by differentiation of the model with respect to $\\Psi$.\n- Compute $\\mathrm{HSM} = \\Psi_{\\min} - P_{50}$.\n\nNumerical and unit specifications:\n- Report $P_{50}$ and $\\mathrm{HSM}$ in megapascals (MPa), rounded to three decimal places.\n- Report $S_{50}$ in percentage-points per MPa, rounded to three decimal places.\n- Angles are not involved in this problem.\n- Percentages in the input are already given in percent units; do not convert to fractions.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one list per test case, each inner list containing three floats in the order $[P_{50}, S_{50}, \\mathrm{HSM}]$, all rounded to three decimal places, enclosed in square brackets. For example, a valid output with two cases would look like $[[x_1,y_1,z_1],[x_2,y_2,z_2]]$ with each $x_j$, $y_j$, $z_j$ being floats formatted with exactly three digits after the decimal point.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It is scientifically grounded in the principles of plant hydraulics, specifically the cohesion-tension theory and the phenomenon of drought-induced xylem embolism. The model and metrics—the Weibull function for vulnerability curves, the $P_{50}$ value, the slope at this point $S_{50}$, and the hydraulic safety margin $\\mathrm{HSM}$—are standard and well-established in the field of plant ecophysiology. The problem is well-posed, objective, and contains all necessary information for a unique and meaningful solution. We may therefore proceed.\n\nThe solution requires a two-stage process: first, the analytical derivation of the required metrics in terms of the model parameters; second, the numerical implementation of a fitting procedure to find these parameters for each dataset, followed by computation of the metrics.\n\nThe specified phenomenological model is the two-parameter Weibull function, relating percent loss of conductivity, $\\mathrm{PLC}(\\Psi)$, to xylem water potential, $\\Psi$ (where $\\Psi \\le 0$):\n$$\n\\mathrm{PLC}(\\Psi) = 100 \\left[1 - \\exp\\left(-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right)\\right]\n$$\nThe parameters to be determined are the scale parameter $\\lambda > 0$ and the shape parameter $k > 0$.\n\nFirst, we derive the analytical expression for $P_{50}$, the water potential at which conductivity loss is $50\\%$. This is defined by the condition $\\mathrm{PLC}(P_{50}) = 50$.\n$$\n50 = 100 \\left[1 - \\exp\\left(-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right)\\right]\n$$\nDividing by $100$ and rearranging gives:\n$$\n0.5 = 1 - \\exp\\left(-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right)\n$$\n$$\n\\exp\\left(-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right) = 0.5\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k} = \\ln(0.5) = -\\ln(2)\n$$\nMultiplying by $-1$ and taking the $k$-th root:\n$$\n\\frac{-P_{50}}{\\lambda} = \\left(\\ln(2)\\right)^{1/k}\n$$\nSolving for $P_{50}$ yields the expression:\n$$\nP_{50} = -\\lambda \\left(\\ln(2)\\right)^{1/k}\n$$\nThis expression allows for the direct calculation of $P_{50}$ once $\\lambda$ and $k$ are known. As $\\lambda > 0$, $k > 0$, and $\\ln(2) > 0$, the value of $P_{50}$ will be negative, which is physically correct for water potential under tension.\n\nNext, we derive the expression for $S_{50}$, the magnitude of the slope of the vulnerability curve at $\\Psi = P_{50}$. We must first find the derivative $\\frac{d\\,\\mathrm{PLC}}{d\\Psi}$. Using the chain rule:\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = \\frac{d}{d\\Psi} \\left(100 - 100 \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right]\\right)\n$$\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = -100 \\cdot \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right] \\cdot \\frac{d}{d\\Psi}\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right]\n$$\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = -100 \\cdot \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right] \\cdot \\left(-k \\left(\\frac{-\\Psi}{\\lambda}\\right)^{k-1} \\cdot \\left(-\\frac{1}{\\lambda}\\right)\\right)\n$$\n$$\n\\frac{d\\,\\mathrm{PLC}}{d\\Psi} = -100 \\cdot \\frac{k}{\\lambda} \\left(\\frac{-\\Psi}{\\lambda}\\right)^{k-1} \\exp\\left[-\\left(\\frac{-\\Psi}{\\lambda}\\right)^{k}\\right]\n$$\nWe evaluate this derivative at $\\Psi = P_{50}$. At this point, we know from the derivation of $P_{50}$ that $\\exp\\left[-\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k}\\right] = 0.5$. Substituting this gives:\n$$\n\\left.\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = -100 \\cdot \\frac{k}{\\lambda} \\left(\\frac{-P_{50}}{\\lambda}\\right)^{k-1} \\cdot (0.5) = -50 \\frac{k}{\\lambda} \\left(\\frac{-P_{50}}{\\lambda}\\right)^{k-1}\n$$\nWe can simplify this further. From the $P_{50}$ derivation, we have $\\left(\\frac{-P_{50}}{\\lambda}\\right) = (\\ln(2))^{1/k}$.\n$$\n\\left.\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = -50 \\frac{k}{\\lambda} \\left( (\\ln(2))^{1/k} \\right)^{k-1} = -50 \\frac{k}{\\lambda} (\\ln(2))^{(k-1)/k} = -50 \\frac{k}{\\lambda} (\\ln(2))^{1 - 1/k}\n$$\nAn alternative, more elegant simplification uses the relationship $\\left(\\frac{-P_{50}}{\\lambda}\\right)^k = \\ln(2)$.\n$$\n\\left(\\frac{-P_{50}}{\\lambda}\\right)^{k-1} = \\frac{\\left(\\frac{-P_{50}}{\\lambda}\\right)^k}{\\left(\\frac{-P_{50}}{\\lambda}\\right)} = \\frac{\\ln(2)}{-P_{50}/\\lambda}\n$$\nSubstituting this into the expression for the slope:\n$$\n\\left.\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = -50 \\frac{k}{\\lambda} \\left(\\frac{\\ln(2)}{-P_{50}/\\lambda}\\right) = \\frac{-50 k \\ln(2)}{-P_{50}} = \\frac{50 k \\ln(2)}{P_{50}}\n$$\nSince $P_{50} < 0$, the slope is negative, as expected. The problem asks for the magnitude, $S_{50}$:\n$$\nS_{50} = \\left|\\frac{d\\,\\mathrm{PLC}}{d\\Psi}\\right|_{\\Psi=P_{50}} = \\left|\\frac{50 k \\ln(2)}{P_{50}}\\right| = \\frac{50 k \\ln(2)}{-P_{50}}\n$$\nFinally, the hydraulic safety margin, $\\mathrm{HSM}$, is computed directly as:\n$$\n\\mathrm{HSM} = \\Psi_{\\min} - P_{50}\n$$\n\nThe computational procedure involves fitting the parameters $(\\lambda, k)$ for each dataset by minimizing the sum of squared residuals, $\\sum_i (\\mathrm{PLC}_i - \\mathrm{PLC}(\\Psi_i; \\lambda, k))^2$. This is a nonlinear least-squares optimization problem, which will be solved numerically using the `scipy.optimize.curve_fit` function. This function requires the model, the independent variable data ($\\Psi_i$), the dependent variable data ($\\mathrm{PLC}_i$), and parameter bounds $(\\lambda > 0, k > 0)$. Once the optimal parameters $(\\hat{\\lambda}, \\hat{k})$ are obtained, they are substituted into the derived analytical expressions to compute $P_{50}$, $S_{50}$, and subsequently $\\mathrm{HSM}$. The final results are then formatted as specified.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the plant hydraulic vulnerability curve fitting problem for multiple test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"psi\": np.array([-0.5, -1.0, -1.5, -2.0, -2.5, -3.0, -3.5, -4.0, -5.0, -6.0]),\n            \"plc\": np.array([0.3, 2.3, 7.6, 17.0, 30.5, 46.7, 63.2, 77.5, 94.6, 99.4]),\n            \"psi_min\": -2.9,\n        },\n        {\n            \"psi\": np.array([-0.3, -0.6, -0.9, -1.2, -1.5, -1.8, -2.1, -2.4, -3.0, -3.6, -4.5]),\n            \"plc\": np.array([10.6, 21.3, 31.1, 40.1, 48.1, 55.1, 61.3, 66.7, 75.6, 82.1, 88.8]),\n            \"psi_min\": -1.7,\n        },\n        {\n            \"psi\": np.array([-0.5, -1.0, -1.5, -2.0, -2.2, -2.4, -2.6, -3.0, -3.5, -4.0]),\n            \"plc\": np.array([0.0, 0.8, 6.2, 23.6, 35.3, 48.9, 63.2, 87.0, 98.8, 100.0]),\n            \"psi_min\": -2.6,\n        },\n    ]\n\n    def weibull_plc(psi, lam, k):\n        \"\"\"\n        Calculates the Percent Loss of Conductivity (PLC) using the Weibull model.\n        psi: Xylem water potential (MPa, negative).\n        lam: Scale parameter (lambda > 0).\n        k: Shape parameter (k > 0).\n        \"\"\"\n        # To avoid RuntimeWarning for invalid values in power for negative psi,\n        # we work with -psi, which is positive.\n        psi_pos = -psi\n        return 100 * (1 - np.exp(-((psi_pos / lam) ** k)))\n\n    results_all_cases = []\n    \n    for case in test_cases:\n        psi_data = case[\"psi\"]\n        plc_data = case[\"plc\"]\n        psi_min = case[\"psi_min\"]\n\n        # Fit the model using non-linear least squares (scipy.optimize.curve_fit)\n        # We provide bounds to ensure lambda and k are positive.\n        # Initial guess p0 can help convergence but often is not necessary.\n        # A reasonable guess for lambda is related to -P50, and k is often between 1 and 10.\n        initial_guess = [3.0, 3.0]\n        bounds = ([1e-9, 1e-9], [np.inf, np.inf]) # Strictly positive parameters\n        \n        popt, _ = curve_fit(weibull_plc, psi_data, plc_data, p0=initial_guess, bounds=bounds)\n        lam_fit, k_fit = popt\n\n        # 1. Calculate P50\n        # P50 = -lambda * (ln(2))^(1/k)\n        p50 = -lam_fit * (np.log(2))**(1 / k_fit)\n\n        # 2. Calculate S50 (magnitude of slope at P50)\n        # S50 = (50 * k * ln(2)) / -P50\n        s50 = (50 * k_fit * np.log(2)) / -p50\n        \n        # 3. Calculate HSM (Hydraulic Safety Margin)\n        # HSM = Psi_min - P50\n        hsm = psi_min - p50\n\n        # Format results to three decimal places\n        p50_str = f'{p50:.3f}'\n        s50_str = f'{s50:.3f}'\n        hsm_str = f'{hsm:.3f}'\n        \n        results_all_cases.append(f'[{p50_str},{s50_str},{hsm_str}]')\n        \n    # Final print statement in the exact required format.\n    print(f'[{\",\".join(results_all_cases)}]')\n\nsolve()\n```", "id": "2564037"}]}