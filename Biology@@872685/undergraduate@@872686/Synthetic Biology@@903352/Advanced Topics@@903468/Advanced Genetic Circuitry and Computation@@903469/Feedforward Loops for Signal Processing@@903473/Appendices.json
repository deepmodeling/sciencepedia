{"hands_on_practices": [{"introduction": "The Incoherent Type-1 Feedforward Loop (I1-FFL) is a powerful network motif used to generate a transient pulse of an output in response to a sustained input signal. This exercise explores the core dynamics of this pulse-generating circuit, where a single input simultaneously initiates the production of both an output protein and its own repressor. By calculating the time at which the output concentration peaks, you will gain a quantitative understanding of how the interplay between production, degradation, and repression rates shapes the circuit's temporal response, a foundational skill in dynamic circuit design [@problem_id:2037511].", "problem": "A synthetic biologist is engineering a bacterial circuit designed to produce a transient pulse of an output protein, Z, in response to a sustained environmental signal. This is achieved using an Incoherent Type-1 Feedforward Loop (I1-FFL).\n\nThe circuit operates as follows: At time $t=0$, an inducer molecule is continuously supplied, initiating two processes simultaneously.\n1. The production of a repressor protein, Y, begins at a constant rate $\\beta_Y$.\n2. The production of the output protein, Z, begins at a constant rate $\\beta_Z$.\n\nBoth proteins, Y and Z, are subject to degradation through a first-order process, characterized by the same degradation rate constant $\\gamma$. The concentrations of Y and Z are both zero at $t=0$.\n\nThe \"feedforward\" interaction in the circuit dictates that the production of protein Z is instantly and completely shut off as soon as the concentration of the repressor protein Y reaches a specific threshold value, $K_Y$. For this circuit to function as intended, the parameters are chosen such that $K_Y < \\beta_Y / \\gamma$.\n\nFind an analytic expression for the time $t_{peak}$ at which the concentration of the output protein Z reaches its maximum value. Your answer should be expressed in terms of the given parameters $\\beta_Y$, $\\gamma$, and $K_Y$.", "solution": "Let $Y(t)$ and $Z(t)$ denote the concentrations of proteins Y and Z. Their dynamics before any shutoff are governed by first-order production and degradation:\n$$\n\\frac{dY}{dt}=\\beta_{Y}-\\gamma Y,\\quad Y(0)=0,\n$$\n$$\n\\frac{dZ}{dt}=\\beta_{Z}-\\gamma Z,\\quad Z(0)=0.\n$$\nSolving the linear ODE for $Y(t)$ gives\n$$\nY(t)=\\frac{\\beta_{Y}}{\\gamma}\\left(1-\\exp(-\\gamma t)\\right).\n$$\nDefine $t_{\\text{off}}$ as the first time at which $Y(t)$ reaches the threshold $K_{Y}$:\n$$\nY(t_{\\text{off}})=K_{Y}\\quad\\Longrightarrow\\quad \\frac{\\beta_{Y}}{\\gamma}\\left(1-\\exp(-\\gamma t_{\\text{off}})\\right)=K_{Y}.\n$$\nSolving for $t_{\\text{off}}$ yields\n$$\n\\exp(-\\gamma t_{\\text{off}})=1-\\frac{\\gamma K_{Y}}{\\beta_{Y}},\\quad t_{\\text{off}}=-\\frac{1}{\\gamma}\\ln\\!\\left(1-\\frac{\\gamma K_{Y}}{\\beta_{Y}}\\right)=\\frac{1}{\\gamma}\\ln\\!\\left(\\frac{\\beta_{Y}}{\\beta_{Y}-\\gamma K_{Y}}\\right).\n$$\nThe assumption $K_{Y}<\\beta_{Y}/\\gamma$ guarantees $0<1-\\gamma K_{Y}/\\beta_{Y}<1$, so $t_{\\text{off}}$ is finite and positive.\n\nFor $t<t_{\\text{off}}$, $Z$ follows\n$$\nZ(t)=\\frac{\\beta_{Z}}{\\gamma}\\left(1-\\exp(-\\gamma t)\\right),\n$$\nwhich is strictly increasing since $\\exp(-\\gamma t)>0$ implies\n$$\n\\frac{dZ}{dt}=\\beta_{Z}-\\gamma Z(t)=\\beta_{Z}\\exp(-\\gamma t)>0.\n$$\nAt $t=t_{\\text{off}}$, production of $Z$ is instantly shut off, so for $t>t_{\\text{off}}$ the dynamics become\n$$\n\\frac{dZ}{dt}=-\\gamma Z,\\quad Z(t)=Z(t_{\\text{off}})\\exp\\!\\left(-\\gamma\\,(t-t_{\\text{off}})\\right),\n$$\nwhich is strictly decreasing for $t>t_{\\text{off}}$. Therefore $Z(t)$ attains its unique maximum at the shutoff time:\n$$\nt_{\\text{peak}}=t_{\\text{off}}=\\frac{1}{\\gamma}\\ln\\!\\left(\\frac{\\beta_{Y}}{\\beta_{Y}-\\gamma K_{Y}}\\right).\n$$", "answer": "$$\\boxed{\\frac{1}{\\gamma}\\ln\\!\\left(\\frac{\\beta_{Y}}{\\beta_{Y}-\\gamma K_{Y}}\\right)}$$", "id": "2037511"}, {"introduction": "In contrast to pulse generation, the Coherent Type-1 Feedforward Loop (C1-FFL) with AND-gate logic is a classic architecture for creating a \"persistence detector,\" a circuit that filters out noisy or brief signals and responds only to a sustained input. This practice problem frames the concept within a practical troubleshooting scenario where a designed circuit is malfunctioning. By diagnosing why the circuit fails to ignore short pulses, you will develop a deeper intuition for how each parameter contributes to the system's time-delay function, particularly the critical role of activation thresholds in signal filtering [@problem_id:2037472].", "problem": "A synthetic biology research team has engineered a bacterium to function as a \"persistence detector\" using a genetic circuit. This circuit is designed to produce a green fluorescent protein (GFP) output, Z, only when an input chemical signal, S, is present for a sustained period. The circuit architecture is a coherent type 1 feedforward loop (C1-FFL). The mechanism is as follows:\n\n1.  The input signal molecule, S, causes the rapid expression of a transcription factor, protein X. We can assume the concentration of X is high when S is present and zero when S is absent.\n2.  Protein X activates the expression of a second transcription factor, protein Y. The rate of production of Y is dependent on the concentration of X.\n3.  The final output, protein Z (GFP), is expressed only when activated by *both* protein X and protein Y simultaneously, functioning as a logical AND gate.\n\nThe kinetic parameters of the system are defined as follows:\n-   $\\alpha_Y$: Maximum production rate of protein Y.\n-   $\\beta_Y$: Degradation rate of protein Y.\n-   $K_X$: Concentration of protein X required for half-maximal activation of gene Y.\n-   $\\alpha_Z$: Maximum production rate of protein Z.\n-   $\\beta_Z$: Degradation rate of protein Z.\n-   $K_{XZ}$: Concentration of protein X required for half-maximal activation of gene Z.\n-   $K_{YZ}$: Concentration of protein Y required for half-maximal activation of gene Z.\n\nThe circuit is designed such that there is a significant time delay between the appearance of X and the accumulation of Y to a concentration sufficient to activate Z. This ensures that only long pulses of the input signal S result in the production of Z.\n\nUpon testing their engineered bacteria, the team observes a malfunction. The circuit produces the GFP output (Z) in response to *any* pulse of the input signal S, regardless of how short its duration is. Which of the following single-parameter changes in the circuit's design is the most likely cause of this failure?\n\nA. A significant increase in $\\beta_Y$, the degradation rate of protein Y.\n\nB. A significant increase in $K_X$, the concentration of X required for half-maximal activation of gene Y.\n\nC. A significant decrease in $K_{YZ}$, the concentration of Y required for half-maximal activation of gene Z.\n\nD. A significant increase in $\\beta_Z$, the degradation rate of protein Z.\n\nE. A mutation that removes the binding site for X at the promoter of gene Z, changing the activation logic.", "solution": "We model the coherent type 1 feedforward loop with AND logic using standard transcriptional activation kinetics. Let $X$ be high during the input pulse (presence of $S$) and zero otherwise. The dynamics of $Y$ and $Z$ are written as\n$$\n\\frac{dY}{dt}=\\alpha_{Y} H_{X}(X)-\\beta_{Y} Y,\\qquad H_{X}(X)=\\frac{X}{K_{X}+X},\n$$\n$$\n\\frac{dZ}{dt}=\\alpha_{Z} H_{XZ}(X)\\,H_{YZ}(Y)-\\beta_{Z} Z,\\qquad H_{XZ}(X)=\\frac{X}{K_{XZ}+X},\\quad H_{YZ}(Y)=\\frac{Y}{K_{YZ}+Y}.\n$$\nWhen $S$ is applied as a pulse and $X$ rises rapidly to a high value $X_{\\text{on}}$ with $X_{\\text{on}}\\gg K_{X}$ and $X_{\\text{on}}\\gg K_{XZ}$, we have $H_{X}(X_{\\text{on}})\\approx 1$ and $H_{XZ}(X_{\\text{on}})\\approx 1$. Then the $Y$ dynamics during the pulse reduce to\n$$\n\\frac{dY}{dt}=\\alpha_{Y}-\\beta_{Y} Y,\n$$\nwith solution (starting from $Y(0)=0$)\n$$\nY(t)=Y_{\\text{ss}}\\left(1-\\exp(-\\beta_{Y} t)\\right),\\qquad Y_{\\text{ss}}=\\frac{\\alpha_{Y}}{\\beta_{Y}},\n$$\nso the characteristic rise time is $\\tau_{Y}=\\frac{1}{\\beta_{Y}}$. For short pulses with duration $T\\ll \\tau_{Y}$, the early-time approximation is\n$$\nY(t)\\approx \\left.\\frac{dY}{dt}\\right|_{t=0} t=\\alpha_{Y} t.\n$$\nThe AND gate condition for $Z$ production during the pulse simplifies to\n$$\n\\frac{dZ}{dt}\\approx \\alpha_{Z} H_{YZ}(Y(t))-\\beta_{Z} Z,\\quad \\text{with}\\quad H_{YZ}(Y(t))=\\frac{Y(t)}{K_{YZ}+Y(t)}.\n$$\nThus onset of $Z$ production is controlled by $Y(t)$ crossing a functional threshold governed by $K_{YZ}$. Define the characteristic time to reach $Y=K_{YZ}$ in the early-time regime:\n$$\nt^{*}:\\ Y(t^{*})=K_{YZ}\\ \\Rightarrow\\ t^{*}=\\frac{K_{YZ}}{\\alpha_{Y}}.\n$$\nTherefore:\n- A significant decrease in $K_{YZ}$ decreases $t^{*}$ proportionally, causing $H_{YZ}(Y(t))$ to approach order unity almost immediately after pulse onset. As a result, even very short pulses (any $T\\gtrsim t^{*}$) will produce $Z$, destroying persistence detection.\n- A significant increase in $\\beta_{Y}$ increases $\\tau_{Y}$ and reduces $Y(t)$ at any fixed short time, which increases $t^{*}$ and makes activation harder, not easier; this cannot cause immediate $Z$ production to any pulse.\n- A significant increase in $K_{X}$ decreases $H_{X}(X_{\\text{on}})$, reducing the effective production rate of $Y$ and increasing $t^{*}$; this also makes activation harder, not easier.\n- A significant increase in $\\beta_{Z}$ affects the decay of $Z$ but not the onset condition $H_{YZ}(Y)$; if anything, it would reduce observable $Z$ for short pulses, not create spurious early production.\n- Removing the $X$ binding site at the $Z$ promoter eliminates the AND gate, leaving $Z$ controlled only by $Y$: $\\frac{dZ}{dt}=\\alpha_{Z} H_{YZ}(Y)-\\beta_{Z} Z$. Since $Y$ accumulates slowly, short pulses still fail to produce $Z$; this does not explain immediate responses to any pulse.\n\nHence, the single-parameter change most consistent with immediate $Z$ production for any pulse duration is a significant decrease in $K_{YZ}$.", "answer": "$$\\boxed{C}$$", "id": "2037472"}, {"introduction": "Building on the concept of persistence detection, we can further analyze a circuit's signal processing capabilities by examining its response to periodic inputs. This exercise treats the C1-FFL persistence detector as a low-pass filter, a fundamental component in engineering that selectively passes signals below a certain cutoff frequency. Calculating the critical input frequency that allows a sustained output provides a quantitative measure of the circuit's filtering performance, directly linking the biochemical parameters of transcription and degradation to its function as a signal processing device [@problem_id:2037506].", "problem": "A synthetic biologist is designing a genetic circuit in bacteria intended to function as a \"persistence detector.\" The circuit should activate the production of an output protein, Z, only in response to a prolonged and continuous input signal. The chosen architecture is a Coherent Type-1 Feedforward Loop (C1-FFL).\n\nIn this C1-FFL, an input signaling molecule, X, acts as a transcription factor that activates the expression of a second transcription factor, Y. The production of the final output protein, Z, is controlled by an AND-gate logic, meaning its gene is expressed only when both X and Y are present and active.\n\nLet's model this system mathematically:\n1.  The input signal X is externally controlled and follows a periodic square-wave pattern with period $T$ and a 50% duty cycle. For each cycle, the signal is considered \"ON\" (present at a high, constant concentration) for $0 \\le t < T/2$ and \"OFF\" (absent) for $T/2 \\le t < T$.\n2.  The concentration of protein Y, denoted as $[Y]$, is initially zero. When the signal X is ON, Y is produced at a constant rate $\\beta_y$. When X is OFF, the production of Y ceases. Protein Y is continuously degraded and diluted at a rate proportional to its own concentration, with a first-order rate constant $\\alpha_y$.\n3.  The production of protein Z is triggered only when the signal X is ON **and** the concentration of protein Y, $[Y]$, exceeds a specific activation threshold, $K_{yz}$. When these conditions are met, Z is produced at a maximum rate $\\beta_z$. Protein Z is also subject to degradation and dilution with a rate constant $\\alpha_z$.\n4.  For the system to be functional, the parameters are such that the steady-state concentration of Y that would be reached under a continuous ON signal (i.e., $\\beta_y / \\alpha_y$) is greater than the activation threshold $K_{yz}$.\n\nA \"sustained response\" from the circuit is defined as the successful initiation of Z production during any given ON-pulse of the input signal X. This is only possible if the duration of the ON-pulse is long enough for the concentration of Y to build up from zero and reach its threshold $K_{yz}$.\n\nDetermine the critical frequency, $f_{crit}$, of the input signal. For any input frequency $f \\le f_{crit}$, the circuit will exhibit a sustained response. Express your answer as a single, closed-form analytic expression in terms of the parameters $\\alpha_y$, $\\beta_y$, and $K_{yz}$.", "solution": "During an ON pulse of the input X, protein Y obeys first-order production and degradation. The governing ordinary differential equation for $Y(t)$, with X ON, is:\n$$\n\\frac{dY}{dt}=\\beta_{y}-\\alpha_{y}Y.\n$$\nFor an ON pulse that starts with $Y(0)=0$ (as specified), the solution is obtained by solving the linear ODE with constant coefficients:\n$$\nY(t)=\\frac{\\beta_{y}}{\\alpha_{y}}\\left(1-\\exp(-\\alpha_{y}t)\\right).\n$$\nProduction of Z can begin only once $Y$ reaches the activation threshold $K_{yz}$ while X remains ON. Define $t_{\\text{th}}$ as the minimal ON time required for $Y$ to reach $K_{yz}$ starting from zero, i.e.,\n$$\nY(t_{\\text{th}})=K_{yz}.\n$$\nSubstituting the solution for $Y(t)$ gives:\n$$\n\\frac{\\beta_{y}}{\\alpha_{y}}\\left(1-\\exp(-\\alpha_{y}t_{\\text{th}})\\right)=K_{yz}.\n$$\nRearranging,\n$$\n\\exp(-\\alpha_{y}t_{\\text{th}})=1-\\frac{\\alpha_{y}K_{yz}}{\\beta_{y}},\n$$\nwhich, using the assumption $\\frac{\\beta_{y}}{\\alpha_{y}}>K_{yz}$ to ensure the right-hand side lies in $(0,1)$, yields\n$$\nt_{\\text{th}}=-\\frac{1}{\\alpha_{y}}\\ln\\!\\left(1-\\frac{\\alpha_{y}K_{yz}}{\\beta_{y}}\\right)=\\frac{1}{\\alpha_{y}}\\ln\\!\\left(\\frac{1}{1-\\frac{\\alpha_{y}K_{yz}}{\\beta_{y}}}\\right).\n$$\nThe square-wave input has a period $T$ with a 50 percent duty cycle, so the ON duration each cycle is $T/2$. A sustained response requires that the ON duration be at least $t_{\\text{th}}$:\n$$\n\\frac{T}{2}\\ge t_{\\text{th}} \\quad \\Longrightarrow \\quad T\\ge 2t_{\\text{th}}.\n$$\nDefining the critical period $T_{\\text{crit}}=2t_{\\text{th}}$, the corresponding critical frequency is\n$$\nf_{\\text{crit}}=\\frac{1}{T_{\\text{crit}}}=\\frac{1}{2t_{\\text{th}}}=\\frac{\\alpha_{y}}{2\\,\\ln\\!\\left(\\frac{1}{1-\\frac{\\alpha_{y}K_{yz}}{\\beta_{y}}}\\right)}.\n$$\nThis is a closed-form expression in terms of $\\alpha_{y}$, $\\beta_{y}$, and $K_{yz}$, valid under the stated condition $\\frac{\\beta_{y}}{\\alpha_{y}}>K_{yz}$.", "answer": "$$\\boxed{\\frac{\\alpha_{y}}{2\\,\\ln\\!\\left(\\frac{1}{1-\\frac{\\alpha_{y}K_{yz}}{\\beta_{y}}}\\right)}}$$", "id": "2037506"}]}