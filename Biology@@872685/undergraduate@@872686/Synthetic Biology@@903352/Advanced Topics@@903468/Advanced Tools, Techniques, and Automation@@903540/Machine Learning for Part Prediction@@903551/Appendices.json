{"hands_on_practices": [{"introduction": "One of the most fundamental models for linking a DNA sequence to its function is the Position-Weight Matrix (PWM). By assigning a score to each possible nucleotide at each position, a PWM allows us to calculate a quantitative prediction for properties like promoter strength. This exercise demonstrates how to use a PWM to perform an *in silico* mutational scan, a powerful computational technique to prioritize which single-base substitutions are most likely to enhance a part's activity before spending time and resources in the lab [@problem_id:2047881].", "problem": "In synthetic biology, predictive models are often used to estimate the strength of genetic parts, such as promoters, before they are synthesized in the lab. A common simple model for promoter strength is the Position-Weight Matrix (PWM). This model assigns a score to a Deoxyribonucleic Acid (DNA) sequence based on the contribution of each nucleotide (A, C, G, T) at each position. The total predicted activity, $S$, of a promoter is the sum of the scores for the bases at each position in its sequence.\n\nA bioengineer is working with a 5 base-pair (bp) wild-type (WT) promoter sequence: `5'-GATCA-3'`. They are using the following PWM to predict promoter activity, where the scores are unitless.\n\n**Position-Weight Matrix (PWM)**\n\n| Base | Pos 1 | Pos 2 | Pos 3 | Pos 4 | Pos 5 |\n| :--- | :---: |:---: |:---: |:---: |:---: |\n| A    | 0.1   | -1.5  | 0.8   | -1.2  | 0.5   |\n| C    | -0.5  | 0.5   | -0.8  | 1.0   | 0.1   |\n| G    | 1.2   | -1.0  | -0.5  | -0.5  | -1.0  |\n| T    | -1.0  | 1.5   | 0.4   | 0.5   | 1.2   |\n\nThe engineer decides to perform an *in silico* mutational scan to find mutations that might increase promoter strength. This involves systematically creating every possible single-base substitution in the WT sequence and calculating the resulting change in activity, $\\Delta S = S_{\\text{mutant}} - S_{\\text{WT}}$.\n\nYour task is to identify the single-base substitution that results in the largest *increase* in predicted activity. What is the value of this maximum positive $\\Delta S$?\n\nRound your final answer to two significant figures.", "solution": "The Position-Weight Matrix (PWM) model assigns a total score $S$ to a sequence by summing the positional contributions of the bases:\n$$\nS=\\sum_{i=1}^{5} w_{i}(b_{i}),\n$$\nwhere $w_{i}(b_{i})$ is the PWM score for base $b_{i}$ at position $i$. For a single-base substitution at position $i$ from wild-type base $b_{\\text{WT}}$ to mutant base $b_{\\text{mut}}$, the change in activity is\n$$\n\\Delta S=S_{\\text{mutant}}-S_{\\text{WT}}=w_{i}(b_{\\text{mut}})-w_{i}(b_{\\text{WT}}),\n$$\nsince all other positions remain unchanged.\n\nThe wild-type sequence is $5'\\text{-}GATCA\\text{-}3'$, so the bases at positions $1$ through $5$ are $G, A, T, C, A$ respectively. Using the PWM:\n\n- Position 1 (WT $G$ with score $1.2$): possible mutants $A, C, T$\n$$\n\\Delta S(A)=0.1-1.2=-1.1,\\quad \\Delta S(C)=-0.5-1.2=-1.7,\\quad \\Delta S(T)=-1.0-1.2=-2.2.\n$$\nMaximum at position 1 is $-1.1$ (no increase).\n\n- Position 2 (WT $A$ with score $-1.5$): possible mutants $C, G, T$\n$$\n\\Delta S(C)=0.5-(-1.5)=2.0,\\quad \\Delta S(G)=-1.0-(-1.5)=0.5,\\quad \\Delta S(T)=1.5-(-1.5)=3.0.\n$$\nMaximum at position 2 is $3.0$ (increase).\n\n- Position 3 (WT $T$ with score $0.4$): possible mutants $A, C, G$\n$$\n\\Delta S(A)=0.8-0.4=0.4,\\quad \\Delta S(C)=-0.8-0.4=-1.2,\\quad \\Delta S(G)=-0.5-0.4=-0.9.\n$$\nMaximum at position 3 is $0.4$ (increase).\n\n- Position 4 (WT $C$ with score $1.0$): possible mutants $A, G, T$\n$$\n\\Delta S(A)=-1.2-1.0=-2.2,\\quad \\Delta S(G)=-0.5-1.0=-1.5,\\quad \\Delta S(T)=0.5-1.0=-0.5.\n$$\nMaximum at position 4 is $-0.5$ (no increase).\n\n- Position 5 (WT $A$ with score $0.5$): possible mutants $C, G, T$\n$$\n\\Delta S(C)=0.1-0.5=-0.4,\\quad \\Delta S(G)=-1.0-0.5=-1.5,\\quad \\Delta S(T)=1.2-0.5=0.7.\n$$\nMaximum at position 5 is $0.7$ (increase).\n\nAcross all positions, the largest positive $\\Delta S$ is $3.0$ from the substitution $A \\to T$ at position $2$. Rounding to two significant figures gives $3.0$.", "answer": "$$\\boxed{3.0}$$", "id": "2047881"}, {"introduction": "Machine learning problems in synthetic biology often involve classification—predicting whether a sequence belongs to a certain functional class. However, there are many different algorithms to choose from, and it's important to understand how they work. This practice compares two common classifiers, K-Nearest Neighbors (KNN) and Logistic Regression, on the task of identifying transcriptional insulators based on a simple sequence feature, GC-content, allowing you to see how different models can yield different predictions for the same input [@problem_id:2047916].", "problem": "In synthetic biology, predicting the function of a DNA part from its sequence is a common task addressed by machine learning models. Consider the problem of classifying short DNA sequences as either transcriptional insulators (which block gene expression) or non-insulators. A simple feature that can be extracted from a DNA sequence is its GC-content, defined as the ratio of the number of guanine (G) and cytosine (C) bases to the total number of bases in the sequence.\n\nYou are given a small training dataset of five DNA sequences and their known classifications (Label 1 for insulator, Label 0 for non-insulator):\n-   Sequence 1: `AGCGCCGAGC` (Label: 1)\n-   Sequence 2: `ATTATATTAT` (Label: 0)\n-   Sequence 3: `TGAACTTA` (Label: 0)\n-   Sequence 4: `GGGCGGGC` (Label: 1)\n-   Sequence 5: `CACGTGTC` (Label: 1)\n\nYou are also given a pre-trained logistic regression model which predicts the probability that a sequence is an insulator based on its GC-content, $x$. The probability is given by the sigmoid function $P(y=1|x) = \\frac{1}{1 + \\exp(-(wx+b))}$, with trained parameters $w = 4.0$ and $b = -1.5$.\n\nYour task is to compare this logistic regression model with a K-Nearest Neighbors (KNN) classifier. Using GC-content as the single feature, you must predict the classification of a new test sequence:\n-   Test Sequence: `GATCCATAG`\n\nUsing a KNN model with $K=3$, the predicted probability of a class is the proportion of the $K$ nearest neighbors that belong to that class.\n\nCalculate the absolute difference between the probability that the test sequence is an insulator as predicted by the logistic regression model and the probability predicted by the KNN model. Report your answer rounded to three significant figures.", "solution": "We use GC-content $x$ defined as the ratio of the number of $G$ and $C$ bases to the total sequence length.\n\nCompute GC-content for the training sequences:\n- Sequence 1: length $10$, $G/C=8 \\Rightarrow x_{1}=\\frac{8}{10}=\\frac{4}{5}$, label $1$.\n- Sequence 2: length $10$, $G/C=0 \\Rightarrow x_{2}=0$, label $0$.\n- Sequence 3: length $8$, $G/C=2 \\Rightarrow x_{3}=\\frac{2}{8}=\\frac{1}{4}$, label $0$.\n- Sequence 4: length $8$, $G/C=8 \\Rightarrow x_{4}=1$, label $1$.\n- Sequence 5: length $8$, $G/C=5 \\Rightarrow x_{5}=\\frac{5}{8}$, label $1$.\n\nCompute GC-content for the test sequence GATCCATAG: length $9$, $G/C=4 \\Rightarrow x_{\\text{test}}=\\frac{4}{9}$.\n\nLogistic regression prediction with $P(y=1\\mid x)=\\frac{1}{1+\\exp(-(wx+b))}$, $w=4.0$, $b=-1.5$:\n$$\nz=w x_{\\text{test}}+b=4\\cdot \\frac{4}{9}-\\frac{3}{2}=\\frac{16}{9}-\\frac{3}{2}=\\frac{32-27}{18}=\\frac{5}{18},\n$$\n$$\nP_{\\text{log}}=\\frac{1}{1+\\exp\\!\\left(-\\frac{5}{18}\\right)}.\n$$\nNumerically, $\\exp\\!\\left(-\\frac{5}{18}\\right)\\approx 0.757465132$, hence\n$$\nP_{\\text{log}}=\\frac{1}{1+0.757465132}\\approx 0.569001332.\n$$\n\nKNN with $K=3$ uses distances in the $x$ feature: $d_{i}=|x_{i}-x_{\\text{test}}|$.\nCompute distances:\n$$\nd_{1}=\\left|\\frac{4}{5}-\\frac{4}{9}\\right|=\\frac{16}{45},\\quad\nd_{2}=\\left|0-\\frac{4}{9}\\right|=\\frac{4}{9},\\quad\nd_{3}=\\left|\\frac{1}{4}-\\frac{4}{9}\\right|=\\frac{7}{36},\\quad\nd_{4}=\\left|1-\\frac{4}{9}\\right|=\\frac{5}{9},\\quad\nd_{5}=\\left|\\frac{5}{8}-\\frac{4}{9}\\right|=\\frac{13}{72}.\n$$\nThe three nearest neighbors are Seqs 5, 3, 1 with labels $1,0,1$, so\n$$\nP_{\\text{KNN}}=\\frac{2}{3}.\n$$\n\nAbsolute difference:\n$$\n\\Delta=\\left|P_{\\text{log}}-P_{\\text{KNN}}\\right|=\\left|\\frac{1}{1+\\exp\\!\\left(-\\frac{5}{18}\\right)}-\\frac{2}{3}\\right|\\approx |0.569001332-0.666666667|\\approx 0.0976653.\n$$\nRounded to three significant figures: $0.0977$.", "answer": "$$\\boxed{0.0977}$$", "id": "2047916"}, {"introduction": "Building a predictive model is only the first step; we must also critically evaluate its performance to know if it's truly useful. This is especially crucial in biological discovery, where the variants we seek are often rare, leading to a class imbalance that can make simple accuracy a misleading metric. This exercise will guide you through calculating more robust evaluation metrics—precision, recall, and the F1-score—to get a true sense of a model's ability to identify rare, high-activity enzymes from a large library [@problem_id:2047917].", "problem": "A synthetic biology lab is using a machine learning model to screen a large, computationally generated library of enzyme variants. The primary goal is to efficiently identify rare variants that possess exceptionally high catalytic activity, which are costly and time-consuming to verify experimentally.\n\nTo evaluate the model's predictive power, it was tested on a library of 20,000 unique enzyme variants. Within this test set, it is known from exhaustive prior analysis that exactly 150 variants are \"high-activity\" (the positive class), and the remaining variants are \"low-activity\" (the negative class).\n\nWhen the classification model was applied to this test library, it produced the following results:\n- It correctly identified 120 of the high-activity variants.\n- It incorrectly classified 300 low-activity variants as being high-activity.\n\nSimple accuracy can be a misleading metric for performance, especially with such a strong class imbalance. A more robust metric is the F1-score for the positive class. The F1-score is defined as the harmonic mean of precision and recall. Precision is the fraction of predicted positives that are actually positive, and recall is the fraction of actual positives that are correctly identified.\n\nBased on the model's performance on the test library, calculate the F1-score for the \"high-activity\" class. Report your answer as a dimensionless decimal value rounded to three significant figures.", "solution": "We are given the total number of actual positives and the model’s classification results. Define the standard quantities:\n- True positives: $TP=120$.\n- False positives: $FP=300$.\n- Actual positives: $P=150$, hence false negatives $FN=P-TP=150-120=30$.\n\nPrecision for the positive class is defined as\n$$\\text{Precision}=\\frac{TP}{TP+FP}=\\frac{120}{120+300}=\\frac{120}{420}=\\frac{2}{7}.$$\n\nRecall for the positive class is defined as\n$$\\text{Recall}=\\frac{TP}{TP+FN}=\\frac{120}{120+30}=\\frac{120}{150}=\\frac{4}{5}.$$\n\nThe F1-score is the harmonic mean of precision and recall:\n$$F_{1}=\\frac{2\\cdot \\text{Precision}\\cdot \\text{Recall}}{\\text{Precision}+\\text{Recall}}=\\frac{2\\cdot \\frac{2}{7}\\cdot \\frac{4}{5}}{\\frac{2}{7}+\\frac{4}{5}}.$$\n\nCompute the numerator and denominator explicitly:\n$$\\text{Numerator}=2\\cdot \\frac{2}{7}\\cdot \\frac{4}{5}=\\frac{16}{35},\\quad \\text{Denominator}=\\frac{2}{7}+\\frac{4}{5}=\\frac{10}{35}+\\frac{28}{35}=\\frac{38}{35}.$$\n\nThus,\n$$F_{1}=\\frac{\\frac{16}{35}}{\\frac{38}{35}}=\\frac{16}{38}=\\frac{8}{19}.$$\n\nAs a decimal rounded to three significant figures,\n$$\\frac{8}{19}\\approx 0.4210526\\ldots \\rightarrow 0.421.$$", "answer": "$$\\boxed{0.421}$$", "id": "2047917"}]}