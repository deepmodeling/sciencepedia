{"hands_on_practices": [{"introduction": "Next-Generation Sequencing (NGS) generates sequence data at an unprecedented scale, but not all data is created equal. To assess reliability, every base call is assigned a quality score. This practice focuses on the Phred quality score ($Q$), the industry standard for quantifying the probability of a sequencing error. By working through this problem [@problem_id:2326400], you will learn to translate the logarithmic Phred score into a tangible error probability, building a crucial intuition for what quality metrics like $Q30$ signify for data integrity.", "problem": "In bioinformatics, Next-Generation Sequencing (NGS) technologies generate vast amounts of DNA sequence data. A crucial part of this process is assessing the quality of each base call (i.e., identifying whether a base is an A, C, G, or T). The Phred quality score, denoted by $Q$, is a widely used metric that quantifies the probability of an incorrect base call. This score is defined by the formula:\n$$Q = -10 \\log_{10}(P)$$\nwhere $P$ is the probability that the base call is incorrect.\n\nA common quality threshold used in sequencing analysis is a Phred score of 30, often referred to as $Q30$. If a specific base in a DNA sequence is assigned a Phred quality score of $Q=30$, what is the corresponding probability that this base call is an error? Express your answer as a decimal.", "solution": "The problem provides the relationship between the Phred quality score, $Q$, and the probability of an incorrect base call, $P$. The formula given is:\n$$Q = -10 \\log_{10}(P)$$\n\nWe are given a Phred score of $Q=30$ and asked to find the corresponding error probability, $P$. To do this, we need to rearrange the formula to solve for $P$.\n\nFirst, we substitute the given value of $Q$ into the equation:\n$$30 = -10 \\log_{10}(P)$$\n\nNext, we isolate the logarithm term. We can do this by dividing both sides of the equation by $-10$:\n$$\\frac{30}{-10} = \\log_{10}(P)$$\n$$-3 = \\log_{10}(P)$$\n\nNow, to solve for $P$, we need to convert this logarithmic equation into its equivalent exponential form. The definition of a base-10 logarithm is that if $y = \\log_{10}(x)$, then $x = 10^y$. Applying this to our equation, where $y = -3$ and $x = P$, we get:\n$$P = 10^{-3}$$\n\nFinally, we express this value as a decimal.\n$$P = \\frac{1}{10^{3}} = \\frac{1}{1000} = 0.001$$\n\nThus, a Phred quality score of $Q30$ corresponds to a 1 in 1000 chance of an incorrect base call, or an error probability of $0.001$.", "answer": "$$\\boxed{0.001}$$", "id": "2326400"}, {"introduction": "When analyzing the transcriptome, our primary interest is often messenger RNA (mRNA), which carries the blueprints for proteins. However, mRNA constitutes only a small fraction of the total RNA within a cell, which is overwhelmingly dominated by ribosomal RNA (rRNA). This exercise [@problem_id:2326391] demonstrates the critical importance of experimental design in RNA-Seq. Through a straightforward calculation, you will see why failing to remove rRNA would render a sequencing run almost useless for gene expression analysis, underscoring how a single preparatory step can dramatically alter the composition of your final dataset.", "problem": "A molecular biologist is conducting a gene expression study using RNA-sequencing (RNA-seq), a type of Next-Generation Sequencing (NGS), on a human cell culture. The standard protocol involves extracting total RNA, followed by a crucial step to deplete the highly abundant ribosomal RNA (rRNA) before constructing the sequencing library. This depletion is necessary to enrich for messenger RNA (mRNA), which typically constitutes a small fraction of the total RNA pool.\n\nAssume that in a typical human cell, the total RNA mass is composed of approximately 85% rRNA, 2% mRNA, and 13% other non-coding RNAs (like tRNA, snRNA, etc.). For the purpose of this problem, assume that during library preparation, all types of RNA molecules are fragmented and converted into sequenceable molecules with equal efficiency. This implies that the proportion of sequencing reads derived from a specific RNA type is directly proportional to its mass percentage in the sample being sequenced.\n\nThe researcher prepares two samples from the same cell culture. Sample A is prepared correctly, with an rRNA depletion kit that successfully removes 99.0% of the rRNA from the total RNA pool while leaving the mRNA and other RNA populations unaffected. For Sample B, the researcher accidentally omits the rRNA depletion step entirely.\n\nCalculate the expected fraction of sequencing reads that will map to mRNA transcripts for Sample B. Express your final answer as a decimal rounded to three significant figures.", "solution": "Let the initial total RNA mass fractions be denoted as follows: $f_{\\text{rRNA}} = 0.85$, $f_{\\text{mRNA}} = 0.02$, and $f_{\\text{other}} = 0.13$. By assumption, during library preparation all RNA types are converted to sequenceable molecules with equal efficiency, so the fraction of sequencing reads from a given RNA type equals its mass fraction in the sequenced sample.\n\nFor Sample B, there is no rRNA depletion, so the sequenced sample composition remains the initial composition. Therefore, the expected fraction of reads mapping to mRNA is\n$$\np_{\\text{mRNA}} = \\frac{f_{\\text{mRNA}}}{f_{\\text{rRNA}} + f_{\\text{mRNA}} + f_{\\text{other}}} = \\frac{0.02}{0.85 + 0.02 + 0.13} = \\frac{0.02}{1} = 0.02.\n$$\nRounding to three significant figures gives $0.0200$.", "answer": "$$\\boxed{0.0200}$$", "id": "2326391"}, {"introduction": "Ensuring the quality of NGS data extends beyond technical metrics to verifying the biological identity of the sample itself. Accidental cross-contamination between samples is a serious issue that can lead to erroneous conclusions. This advanced practice [@problem_id:2326372] illustrates a powerful bioinformatic solution to this problem. You will use naturally occurring genetic markers—Single Nucleotide Polymorphisms (SNPs)—as internal \"barcodes\" to detect and quantify the level of contamination from another individual's DNA, showcasing how genomic data can be cleverly used for its own quality control.", "problem": "A genomics research facility is conducting Whole-Genome Sequencing (WGS), a comprehensive method for analyzing entire genomes. A technician prepares a DNA library from a sample provided by a primary subject, denoted as Subject P. However, there is a concern that during sample handling, a small amount of DNA from another individual, Subject C, may have been accidentally introduced, leading to cross-contamination. Fortunately, both Subject P and Subject C have previously been genotyped for a set of known Single Nucleotide Polymorphisms (SNPs), which are variations at a single position in a DNA sequence.\n\nAfter sequencing the potentially contaminated sample, the resulting reads are aligned to the human reference genome. The read counts for specific alleles at four different SNP loci are recorded. The table below provides the known genotypes for Subject P and Subject C, along with the sequencing read counts observed at each locus from the mixed sample.\n\n| Locus ID | Genotype of Subject P | Genotype of Subject C | Allele 1 Read Count | Allele 2 Read Count |\n| :--- | :--- | :--- | :--- | :--- |\n| rs1801133 | G/G | A/A | G: 212 | A: 24 |\n| rs429358 | T/T | C/C | T: 185 | C: 20 |\n| rs7412 | C/T | C/C | C: 245 | T: 81 |\n| rs121912631| A/A | G/G | A: 251 | G: 28 |\n\nYour task is to determine the extent of the contamination. Calculate the proportion of sequencing reads in the sample that originates from the contaminating individual, Subject C. Base your calculation only on the loci that are unambiguously informative for distinguishing between the two subjects. Express your final answer as a decimal, rounded to three significant figures.", "solution": "Let $f$ denote the proportion of sequencing reads originating from the contaminant (Subject C). For any SNP where Subject P and Subject C are homozygous for different alleles, the contaminant-specific allele is unique to Subject C, and the expected fraction of reads carrying that allele equals $f$ (assuming negligible sequencing error and no allele-specific bias). If at such a locus the total read count is $n$ and the contaminant-allele count is $y$, then $y \\sim \\text{Binomial}(n,f)$ and the maximum-likelihood estimate is $\\hat{f}=\\frac{y}{n}$. Across multiple independent informative loci, the joint MLE is the ratio of the sum of contaminant-allele counts to the sum of total counts:\n$$\n\\hat{f}=\\frac{\\sum_{i} y_{i}}{\\sum_{i} n_{i}}.\n$$\n\nIdentify unambiguously informative loci as those where P and C are homozygous for different alleles:\n- rs1801133: P G/G, C A/A; counts: G: 212, A: 24. Here $y_{1}=24$, $n_{1}=212+24=236$.\n- rs429358: P T/T, C C/C; counts: T: 185, C: 20. Here $y_{2}=20$, $n_{2}=185+20=205$.\n- rs121912631: P A/A, C G/G; counts: A: 251, G: 28. Here $y_{3}=28$, $n_{3}=251+28=279$.\n\nThe locus rs7412 (P C/T, C C/C; counts C: 245, T: 81) is not unambiguously informative because both individuals share allele C; therefore it is excluded per the instruction to use only unambiguously informative loci.\n\nSum the informative counts:\n$$\n\\sum_{i} y_{i}=24+20+28=72,\\quad \\sum_{i} n_{i}=236+205+279=720.\n$$\nThus,\n$$\n\\hat{f}=\\frac{72}{720}=0.1.\n$$\n\nRounded to three significant figures, the contamination proportion is $0.100$.", "answer": "$$\\boxed{0.100}$$", "id": "2326372"}]}