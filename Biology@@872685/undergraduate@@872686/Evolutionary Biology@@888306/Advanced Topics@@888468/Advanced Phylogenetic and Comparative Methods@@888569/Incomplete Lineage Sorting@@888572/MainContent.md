## Introduction
The evolutionary history of species is often depicted as a branching tree, but the history of the genes within those species can tell a different, often conflicting, story. This conflict between gene trees and species trees, known as discordance, is a central puzzle in modern evolutionary biology. Far from being a mere error, much of this discordance is caused by a fundamental biological process: incomplete [lineage sorting](@entry_id:199904) (ILS). Understanding ILS is essential for accurately reconstructing the tree of life and interpreting genomic data.

This article provides a comprehensive overview of incomplete [lineage sorting](@entry_id:199904), explaining what it is, why it happens, and why it matters. It bridges the gap between the population-level process of [genetic drift](@entry_id:145594) and the macroevolutionary patterns we observe across species. You will learn how to think about evolution not as a single history, but as a collection of histories nested within one another.

The first chapter, "Principles and Mechanisms," will demystify the core process, explaining how [genetic drift](@entry_id:145594), population size, and the timing of speciation events interact to cause ILS. Following this, "Applications and Interdisciplinary Connections" explores the profound impact of ILS on [phylogenomics](@entry_id:137325), [species delimitation](@entry_id:176819), and our understanding of [trait evolution](@entry_id:169508). Finally, "Hands-On Practices" offers exercises to apply these concepts and solidify your understanding of how to interpret genomic patterns in light of ILS.

## Principles and Mechanisms

The evolutionary history of species, represented as a **[species tree](@entry_id:147678)**, depicts the branching pattern of speciation events that have led to the diversity of life. In contrast, a **[gene tree](@entry_id:143427)** represents the evolutionary history of a specific segment of the genome—a gene or locus—tracing the ancestry of alleles back to a single common ancestral molecule. A fundamental concept in modern evolutionary biology is that these two histories, while related, are not identical. The gene tree is nested within the species tree, but its topology can differ, a phenomenon known as **[gene tree](@entry_id:143427)-[species tree discordance](@entry_id:168924)**. One of the most important and ubiquitous causes of this discordance is **incomplete [lineage sorting](@entry_id:199904) (ILS)**. This chapter elucidates the principles and mechanisms governing this process.

### The Gene Tree Within the Species Tree

To comprehend incomplete [lineage sorting](@entry_id:199904), we must first clearly distinguish between a species tree and a [gene tree](@entry_id:143427). A [species tree](@entry_id:147678) illustrates the historical relationships among populations as they diverge and become reproductively isolated species. A [gene tree](@entry_id:143427), on the other hand, traces the genealogy of the alleles at a single locus. The lineages within a [gene tree](@entry_id:143427) are constrained by the species tree; for a gene lineage to be passed down, it must exist within an organism that is part of a species lineage.

The process that connects these two types of trees is **coalescence**. When we trace the ancestry of gene copies (alleles) backward in time from different individuals or species, we find that they eventually merge into common ancestral copies. This merging event is a [coalescence](@entry_id:147963). This process occurs *within* the ancestral populations that constitute the branches of the species tree [@problem_id:2726218].

Coalescence is fundamentally a [stochastic process](@entry_id:159502), governed by the principles of genetic drift. In a simple, idealized diploid population of constant **effective population size** ($N_e$), any two gene lineages have a probability of coalescing in any given generation of $1/(2N_e)$. This implies that the average time for two lineages to coalesce is $2N_e$ generations. This simple relationship reveals a critical insight: the larger the [effective population size](@entry_id:146802), the slower the rate of coalescence, and the longer it takes, on average, for gene lineages to find their common ancestor.

### The Core Mechanism of Incomplete Lineage Sorting

Incomplete [lineage sorting](@entry_id:199904) is the direct consequence of the stochastic nature of [coalescence](@entry_id:147963) operating across speciation events. For ILS to occur, a fundamental precondition must be met: the ancestral population must be polymorphic for the gene in question. That is, at least two distinct alleles must have coexisted in the population from which descendant species later evolved. If an ancestral population were fixed for a single allele, all descendant species would inherit that same allele, and the gene tree would trivially match the species tree [@problem_id:1940282].

ILS occurs when this [ancestral polymorphism](@entry_id:172529) is not fully "sorted" into separate lineages before the occurrence of subsequent speciation events. Consider a classic three-species scenario where the species tree is $((A,B),C)$. This means species A and B are [sister taxa](@entry_id:268528), having diverged from their common ancestor more recently than this ancestor diverged from the lineage leading to species C. The process of ILS leading to a discordant gene tree, for instance $((A,C),B)$, unfolds as follows [@problem_id:1940277]:

1.  **Ancestral Polymorphism:** In the common ancestor of all three species (A, B, and C), at least two alleles (let's call them `F1` and `F2`) exist for a given gene.
2.  **First Speciation Event:** The population splits, forming the lineage leading to species C and the lineage leading to the common ancestor of A and B. Crucially, the [ancestral polymorphism](@entry_id:172529) persists; the common ancestor of (A, B) inherits both the `F1` and `F2` alleles.
3.  **Second Speciation Event:** The common ancestor of (A, B) splits into the separate lineages leading to species A and species B. Because the coalescence of `F1` and `F2` lineages did not occur in the short time window between the two speciation events, both alleles are still present at the moment of this split.
4.  **Differential Fixation:** Through random [genetic drift](@entry_id:145594) in the newly formed species, the lineages sort independently. By chance, species A might lose the `F2` allele and become fixed for `F1`. Simultaneously, species B might lose the `F1` allele and become fixed for `F2`. If the outgroup species C had earlier lost `F2` and fixed `F1`, the resulting pattern of alleles across the species would be A=`F1`, B=`F2`, and C=`F1`.
5.  **Discordant Gene Tree:** A [phylogenetic analysis](@entry_id:172534) based on this gene would group species A and C together because they share the identical `F1` allele, yielding the gene tree $((A,C),B)$. This topology is discordant with the true [species tree](@entry_id:147678), $((A,B),C)$. The "sorting" of the ancestral gene lineages was "incomplete" within the branch of the [species tree](@entry_id:147678) corresponding to the common ancestor of A and B.

### Quantifying the Probability of ILS

The likelihood of ILS is not arbitrary; it can be quantified using the **Multispecies Coalescent (MSC) model**. The key parameter is the length of the internal branch of the species tree—the branch representing the common ancestral population of the sister species (e.g., the ancestor of A and B). The length of this branch is best measured not in years or generations alone, but in **coalescent units**, which scale time by the [effective population size](@entry_id:146802). For a diploid organism, the internal [branch length](@entry_id:177486), $t$, in coalescent units is given by:

$$ t = \frac{\tau}{2N_e} $$

where $\tau$ is the duration of the internal branch in generations and $N_e$ is the effective population size of that ancestral population.

This relationship immediately highlights the two factors that most directly promote ILS:

-   **A short time interval between speciation events ($\tau$):** A shorter $\tau$ results in a smaller value of $t$. This provides a shorter window for gene lineages to coalesce, thus increasing the probability that they will persist into the deeper ancestral population. A species tree with very short internal branches is a strong indicator of a high potential for ILS [@problem_id:1940306] [@problem_id:1940312].

-   **A large effective population size ($N_e$):** A larger $N_e$ also results in a smaller value of $t$. In large populations, [genetic drift](@entry_id:145594) is weaker, and it takes much longer for alleles to either fix or be lost. Consequently, [ancestral polymorphism](@entry_id:172529) is more likely to be maintained across speciation events, increasing the chance of ILS [@problem_id:1940294]. For example, if two groups of species had the same time between speciation events ($\tau = 200,000$ generations), but one had an ancestral $N_e$ of $10,000$ and the other an $N_e$ of $500,000$, the probability of ILS would be vastly greater—over 18,000 times higher—in the group with the larger ancestral population [@problem_id:1940294].

Using the MSC model, we can derive the precise probabilities for each of the three possible gene tree topologies for our $((A,B),C)$ species tree. The probability that the gene lineages from A and B *fail* to coalesce in the internal branch of length $t$ is $\exp(-t)$. If they fail to coalesce, three lineages (A, B, and C) enter the deep common ancestor, where any pair is equally likely to coalesce first. This leads to the following probabilities:

-   Probability of the concordant gene tree, $((A,B),C)$:
    $P_{((A,B),C)} = (1 - \exp(-t)) + \frac{1}{3}\exp(-t) = 1 - \frac{2}{3}\exp(-t)$

-   Probability of the first discordant gene tree, $((A,C),B)$:
    $P_{((A,C),B)} = \frac{1}{3}\exp(-t)$

-   Probability of the second discordant [gene tree](@entry_id:143427), $((B,C),A)$:
    $P_{((B,C),A)} = \frac{1}{3}\exp(-t)$

From these equations, a crucial property of pure ILS emerges: the two discordant gene tree topologies are predicted to occur with exactly equal probability [@problem_id:1940273]. This symmetry arises because, once the lineages fail to sort in the intermediate ancestor, their subsequent [coalescence](@entry_id:147963) in the deep ancestor is a random process where the identities 'A' and 'B' are exchangeable [@problem_id:1940273]. Furthermore, for any non-zero [branch length](@entry_id:177486) ($t > 0$), the concordant gene tree is always the single most probable topology. However, if the internal branch is very short (i.e., $t$ is close to zero), the probability of ILS, $\exp(-t)$, approaches 1, and the probabilities of all three topologies approach $\frac{1}{3}$. In such a scenario of rapid, successive speciation, a collection of 100 independent genes might yield approximately 34 concordant trees and 33 of each of the two discordant trees, demonstrating rampant discordance despite a well-defined species history [@problem_id:2726218].

### The Influence of Natural Selection on ILS

The neutral [coalescent model](@entry_id:173389) provides a powerful baseline, but the probability of ILS can be significantly altered by natural selection acting on a gene.

-   **Balancing Selection:** Some forms of selection, such as [overdominance](@entry_id:268017) ([heterozygote advantage](@entry_id:143056)) or [frequency-dependent selection](@entry_id:155870), can actively maintain [multiple alleles](@entry_id:143910) in a population for extremely long periods. This is known as **[balancing selection](@entry_id:150481)**. When [balancing selection](@entry_id:150481) is strong and long-acting, it can cause allelic lineages to persist for millions of years, easily spanning multiple speciation events. This phenomenon is called **[trans-species polymorphism](@entry_id:196940)**. For such genes, like those of the Major Histocompatibility Complex (MHC) in vertebrates, the [time to the most recent common ancestor](@entry_id:198405) of the alleles can predate the speciation events entirely. Consequently, gene trees for these loci are highly likely to be discordant with the [species tree](@entry_id:147678), as the alleles will group by ancient allelic type rather than by species [phylogeny](@entry_id:137790). A gene under long-term [balancing selection](@entry_id:150481) is therefore far more likely to produce a discordant tree than a neutrally evolving gene from the same species [@problem_id:1940323].

-   **Selective Sweeps:** In contrast, a **selective sweep** has the opposite effect. A sweep occurs when a new, highly advantageous mutation arises and rapidly sweeps to fixation in a population. This process, along with the linked DNA around it (a phenomenon called [genetic hitchhiking](@entry_id:165595)), purges almost all genetic variation at that locus. As a result, all copies of the gene in the population trace their ancestry back to a single, very recent common ancestor. If a [selective sweep](@entry_id:169307) occurs in an ancestral population shortly before it splits into two new species, it forces the gene lineages to coalesce recently, well after the divergence from any outgroup species. This dramatically *reduces* or eliminates the possibility of ILS for that specific gene, making its gene tree almost certain to be concordant with the [species tree](@entry_id:147678) [@problem_id:1940317].

### Distinguishing ILS from Introgression

While ILS is a primary cause of discordance, it is not the only one. **Introgression**, or [gene flow](@entry_id:140922) between species after they have diverged, can also create gene trees that conflict with the [species tree](@entry_id:147678). For example, if there is hybridization between species B and C in our $((A,B),C)$ scenario, genes can pass from C's gene pool to B's, or vice versa. A [phylogenetic analysis](@entry_id:172534) of such a gene might then group the alleles from B and C together, yielding a $((B,C),A)$ topology.

A key signature can help distinguish between pure ILS and [introgression](@entry_id:174858). As noted earlier, pure ILS predicts a symmetrical distribution of the two discordant [gene tree](@entry_id:143427) topologies ($P_{((A,C),B)} = P_{((B,C),A)}$). Introgression, however, is a directional process between specific pairs of species. If [introgression](@entry_id:174858) occurs between species B and C, it will specifically and systematically increase the frequency of the $((B,C),A)$ topology, while leaving the frequency of the $((A,C),B)$ topology at the low level expected from deep [coalescence](@entry_id:147963) alone. Therefore, observing a strong asymmetry in the frequencies of discordant gene trees across many loci—for instance, 20% of gene trees showing $((B,C),A)$ versus only 5% showing $((A,C),B)$—is strong evidence for [introgression](@entry_id:174858) between B and C rather than just ILS [@problem_id:1940300].

In summary, incomplete [lineage sorting](@entry_id:199904) is a fundamental consequence of genetic drift playing out across the backdrop of speciation. It is a null expectation for any set of genomes from closely related species, with its probability governed by ancestral population sizes and the timing of divergence events. Understanding its mechanisms, its quantitative behavior, and how it is modulated by other [evolutionary forces](@entry_id:273961) like selection and gene flow is essential for accurately reconstructing the tree of life.