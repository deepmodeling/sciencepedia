{"hands_on_practices": [{"introduction": "Before we can visualize a fitness landscape, we must first appreciate its sheer scale. The set of all possible genotypes, or \"genotype space,\" grows astronomically with the number of genetic loci, making it impossible for evolution to explore every option. This exercise [@problem_id:1434214] provides a foundational understanding of this combinatorial explosion, which is a critical first step in analyzing evolutionary pathways.", "problem": "In evolutionary and systems biology, a \"genotype space\" is the set of all possible genetic configurations for a given organism or system. Understanding the size of this space is a fundamental first step in analyzing concepts like fitness landscapes and evolutionary pathways.\n\nConsider a simplified model for the development of drug resistance in a virus. The resistance phenotype is determined by mutations at a specific number of locations, known as loci, within the viral genome. At each of these loci, we assume there are exactly two possible variants, or alleles: the original, susceptible \"wild-type\" allele and a new, resistant \"mutant\" allele. A system with two possible alleles at each locus is called biallelic. The virus's specific combination of alleles across all relevant loci defines its genotype.\n\nFirst, calculate the total number of unique genotypes possible for a simple viral strain where resistance is governed by $L_1 = 3$ independent biallelic loci.\n\nSecond, calculate the total number of unique genotypes for a more complex viral strain where resistance involves $L_2 = 10$ independent biallelic loci.\n\nYour final answer should be two integers, corresponding to the number of genotypes for the $L_1$ and $L_2$ cases, respectively.", "solution": "Each genotype is a choice of one allele at each locus. For a system with $L$ independent biallelic loci, each locus $i$ has $2$ possible alleles. By the rule of product, the total number of distinct genotypes is the product of the numbers of choices across loci:\n$$\nN(L)=\\prod_{i=1}^{L} 2=2^{L}.\n$$\nFor the simple strain with $L_{1}=3$ loci,\n$$\nN(L_{1})=2^{L_{1}}=2^{3}=8.\n$$\nFor the complex strain with $L_{2}=10$ loci,\n$$\nN(L_{2})=2^{L_{2}}=2^{10}=1024.\n$$\nThus the two requested genotype counts are $8$ and $1024$, respectively.", "answer": "$$\\boxed{\\begin{pmatrix}8  1024\\end{pmatrix}}$$", "id": "1434214"}, {"introduction": "A smooth landscape with a single peak implies predictable evolution, but real fitness landscapes are often \"rugged,\" containing numerous peaks and valleys that can trap adapting populations. This exercise [@problem_id:1434220] invites you to map out a small but complex landscape, identifying local fitness peaks and tracing all possible adaptive paths to the global optimum. By doing so, you will gain a concrete understanding of how landscape ruggedness can make evolutionary outcomes contingent on the specific path taken.", "problem": "In evolutionary systems biology, a fitness landscape is a mapping from a set of genotypes to their fitness values. Consider a simplified model of a haploid organism with 4 genetic loci, where each locus can have one of two alleles (represented by 0 or 1). A genotype can thus be represented by a 4-digit binary string, from '0000' (the wild-type) to '1111'. The fitness of each of the 16 possible genotypes, measured as a reproductive rate, is given in the table below.\n\n| Genotype | Fitness | Genotype | Fitness |\n| :------: | :-----: | :------: | :-----: |\n| 0000     | 1.0     | 1000     | 2.5     |\n| 0001     | 0.7     | 1001     | 2.2     |\n| 0010     | 2.8     | 1010     | 4.5     |\n| 0011     | 2.7     | 1011     | 7.0     |\n| 0100     | 0.8     | 1100     | 5.0     |\n| 0101     | 4.0     | 1101     | 3.5     |\n| 0110     | 1.5     | 1110     | 6.0     |\n| 0111     | 3.8     | 1111     | 8.0     |\n\nWe define the following terms:\n- A single-step mutation changes exactly one digit in the binary string (e.g., '1010' is a single-step mutant of '1011').\n- The \"global fitness peak\" is the genotype with the highest fitness value in the entire landscape.\n- A \"local fitness peak\" is a genotype that has a strictly greater fitness than all of its single-step mutant neighbors. The global peak is also considered a local peak.\n- An \"adaptive path\" is a sequence of genotypes, starting from an initial genotype and ending at a target genotype, where each subsequent genotype in the sequence is reached by a single-step mutation and has a strictly higher fitness value.\n\nLet $L$ be the total number of local fitness peaks in this landscape. Let $P$ be the number of distinct adaptive paths from the wild-type genotype '0000' to the global fitness peak.\n\nCalculate the ratio $P/L$, a metric that relates the predictability of evolution to the ruggedness of the landscape. Round your final answer to two significant figures.", "solution": "We treat genotypes as vertices of a 4-dimensional hypercube, with an edge between two genotypes if they differ by exactly one bit. Let $f(g)$ denote the fitness of genotype $g$. An adaptive step is an edge from $g$ to $h$ with Hamming distance $1$ and $f(h)f(g)$. The set of all adaptive steps defines a directed acyclic graph (DAG) oriented by increasing fitness. An adaptive path from $0000$ to $1111$ is then a directed path in this DAG from $0000$ to $1111$.\n\nFirst, identify the global peak by taking the maximum fitness in the table. The maximal value is $f(1111)=8.0$, so the global peak is $1111$.\n\nNext, count local peaks. A genotype $g$ is a local peak if for each of its four single-step neighbors $h$, $f(g)f(h)$. We check each genotype:\n\n- $0000$: neighbors $1000$ ($2.5$), $0100$ ($0.8$), $0010$ ($2.8$), $0001$ ($0.7$). Since $2.51.0$ and $2.81.0$, not a peak.\n- $0001$: neighbors $1001$ ($2.2$), $0101$ ($4.0$), $0011$ ($2.7$), $0000$ ($1.0$). Since several neighbors have higher fitness, not a peak.\n- $0010$: neighbors $1010$ ($4.5$), $0110$ ($1.5$), $0000$ ($1.0$), $0011$ ($2.7$). Since $4.52.8$, not a peak.\n- $0011$: neighbors $1011$ ($7.0$), $0111$ ($3.8$), $0001$ ($0.7$), $0010$ ($2.8$). Since $7.02.7$ and $3.82.7$ and $2.82.7$, not a peak.\n- $0100$: neighbors $1100$ ($5.0$), $0000$ ($1.0$), $0110$ ($1.5$), $0101$ ($4.0$). Since $5.00.8$ and $4.00.8$ and $1.50.8$ and $1.00.8$, not a peak.\n- $0101$: neighbors $1101$ ($3.5$), $0001$ ($0.7$), $0111$ ($3.8$), $0100$ ($0.8$). All neighbors have lower fitness: $4.03.5$, $4.00.7$, $4.03.8$, $4.00.8$. Thus $0101$ is a local peak.\n- $0110$: neighbors $1110$ ($6.0$), $0010$ ($2.8$), $0100$ ($0.8$), $0111$ ($3.8$). Since several neighbors have higher fitness, not a peak.\n- $0111$: neighbors $1111$ ($8.0$), $0011$ ($2.7$), $0101$ ($4.0$), $0110$ ($1.5$). Since $8.03.8$ and $4.03.8$, not a peak.\n- $1000$: neighbors $0000$ ($1.0$), $1100$ ($5.0$), $1010$ ($4.5$), $1001$ ($2.2$). Since $5.02.5$ and $4.52.5$, not a peak.\n- $1001$: neighbors $0001$ ($0.7$), $1101$ ($3.5$), $1011$ ($7.0$), $1000$ ($2.5$). Since $3.52.2$ and $7.02.2$ and $2.52.2$, not a peak.\n- $1010$: neighbors $0010$ ($2.8$), $1110$ ($6.0$), $1000$ ($2.5$), $1011$ ($7.0$). Since $6.04.5$ and $7.04.5$, not a peak.\n- $1011$: neighbors $0011$ ($2.7$), $1111$ ($8.0$), $1001$ ($2.2$), $1010$ ($4.5$). Since $8.07.0$, not a peak.\n- $1100$: neighbors $0100$ ($0.8$), $1000$ ($2.5$), $1110$ ($6.0$), $1101$ ($3.5$). Since $6.05.0$, not a peak.\n- $1101$: neighbors $0101$ ($4.0$), $1001$ ($2.2$), $1111$ ($8.0$), $1100$ ($5.0$). Since $4.03.5$, $8.03.5$, $5.03.5$, not a peak.\n- $1110$: neighbors $0110$ ($1.5$), $1010$ ($4.5$), $1100$ ($5.0$), $1111$ ($8.0$). Since $8.06.0$, not a peak.\n- $1111$: as the global maximum, all neighbors have lower fitness; it is a local peak.\n\nHence the total number of local peaks is $L=2$ (namely $0101$ and $1111$).\n\nNow count $P$, the number of adaptive paths from $0000$ to $1111$. Construct the DAG by listing out-edges (single-step neighbors of higher fitness) from nodes reachable from $0000$:\n\n- From $0000$ ($1.0$): to $1000$ ($2.5$), $0010$ ($2.8$).\n- From $1000$ ($2.5$): to $1100$ ($5.0$), $1010$ ($4.5$).\n- From $0010$ ($2.8$): to $1010$ ($4.5$).\n- From $1100$ ($5.0$): to $1110$ ($6.0$).\n- From $1010$ ($4.5$): to $1110$ ($6.0$), $1011$ ($7.0$).\n- From $1110$ ($6.0$): to $1111$ ($8.0$).\n- From $1011$ ($7.0$): to $1111$ ($8.0$).\n\nDefine $N(g)$ as the number of directed paths from genotype $g$ to $1111$ in this DAG. Using dynamic programming (topological order from higher fitness to lower within the reachable set), impose the terminal condition $N(1111)=1$, and for any other node $g$,\n$$\nN(g)=\\sum_{h:\\,h\\text{ is a single-step neighbor of }g,\\;f(h)f(g)} N(h).\n$$\nEvaluating from sinks upward:\n$$\nN(1111)=1,\\quad N(1110)=N(1111)=1,\\quad N(1011)=N(1111)=1,\n$$\n$$\nN(1010)=N(1110)+N(1011)=1+1=2,\\quad N(1100)=N(1110)=1,\n$$\n$$\nN(1000)=N(1100)+N(1010)=1+2=3,\\quad N(0010)=N(1010)=2,\n$$\n$$\nN(0000)=N(1000)+N(0010)=3+2=5.\n$$\nTherefore $P=5$.\n\nFinally, compute the ratio and round to two significant figures:\n$$\n\\frac{P}{L}=\\frac{5}{2}=2.5.\n$$\nThus, to two significant figures, the ratio is $2.5$.", "answer": "$$\\boxed{2.5}$$", "id": "1434220"}, {"introduction": "Fitness valleys, where intermediate mutations are deleterious, pose a major barrier to adaptation. How can a population cross such a valley to reach a higher fitness peak? This practice problem [@problem_id:1434174] explores a classic advantage of sexual reproduction, showing how recombination can assemble beneficial mutations from different individuals, providing a much faster route across a fitness valley compared to the sequential mutation required in asexual populations.", "problem": "Consider a large haploid population of size $N$ whose fitness depends on two genetic loci, A and B. The wild-type genotype is `ab` and has a fitness of 1. There are two single-mutant genotypes, `Ab` and `aB`, which are deleterious, each having a fitness of $1-s$, where $s$ is a small positive selection coefficient ($0  s \\ll 1$). The double-mutant genotype `AB` is highly advantageous. The mutation rate per locus per generation is $\\mu$, such that a mutates to A at rate $\\mu$ and b mutates to B at rate $\\mu$. We can assume that back mutations are negligible.\n\nWe wish to compare the expected time it takes for the first `AB` double mutant to arise and establish in an asexual population versus a sexual population, both of size $N$. For the sexual population, assume random mating and a recombination rate of $r$ between the two loci.\n\nTo simplify the analysis, make the following assumptions:\n1.  The populations have reached a mutation-selection equilibrium for the frequencies of the single mutants `Ab` and `aB`.\n2.  For the sexual population, the pathway to creating the `AB` genotype via recombination between single mutants is significantly faster than the pathway via sequential mutation. Therefore, you should only consider the recombination pathway for the sexual population's calculation.\n\nCalculate the ratio of the expected waiting time for the first `AB` mutant in the asexual population, $T_{asexual}$, to the expected waiting time in the sexual population, $T_{sexual}$. Express your answer as a symbolic expression in terms of the given parameters.", "solution": "Let $f_{Ab}$ and $f_{aB}$ denote the mutation-selection equilibrium frequencies of the deleterious single mutants in a large haploid population. For a deleterious allele with mutation rate $\\mu$ from wild type and selection coefficient $s$ against the mutant, and negligible back mutation, the standard mutation-selection balance gives\n$$\nf_{Ab} \\approx \\frac{\\mu}{s}, \\qquad f_{aB} \\approx \\frac{\\mu}{s},\n$$\nsince the inflow of mutants by mutation, of order $\\mu$, balances their removal by selection, of order $s f$, and $f_{ab} \\approx 1$ prior to the appearance of $AB$. Corrections due to recombination altering $f_{Ab}$ and $f_{aB}$ are of order $r (\\mu/s)^{2}$ and are negligible at leading order.\n\nAsexual population: The $AB$ genotype arises predominantly by a second mutation occurring in existing single mutants. Each $Ab$ individual mutates at the $B$ locus at rate $\\mu$, and each $aB$ mutates at the $A$ locus at rate $\\mu$. Thus, the per-generation production rate of $AB$ genotypes is\n$$\n\\lambda_{asexual} \\approx N \\mu f_{Ab} + N \\mu f_{aB} = N \\mu \\left(\\frac{\\mu}{s}\\right) + N \\mu \\left(\\frac{\\mu}{s}\\right) = \\frac{2 N \\mu^{2}}{s}.\n$$\n\nSexual population: Under random mating and recombination rate $r$ between loci, the change in $f_{AB}$ due to recombination is\n$$\n\\Delta f_{AB}\\big|_{rec} = r \\left(p_{A} p_{B} - f_{AB}\\right).\n$$\nBefore $AB$ appears, $f_{AB} \\approx 0$ and $p_{A} \\approx f_{Ab}$, $p_{B} \\approx f_{aB}$, so recombination produces new $AB$ at frequency\n$$\n\\Delta f_{AB}\\big|_{rec} \\approx r f_{Ab} f_{aB} \\approx r \\left(\\frac{\\mu}{s}\\right)^{2}.\n$$\nHence, the per-generation production rate of $AB$ genotypes is\n$$\n\\lambda_{sexual} \\approx N r \\left(\\frac{\\mu}{s}\\right)^{2} = \\frac{N r \\mu^{2}}{s^{2}}.\n$$\n\nEstablishment: Let $p_{est}$ be the probability that a newly formed $AB$ genotype establishes. This probability is the same in both populations, so it cancels in the ratio of expected waiting times. The expected waiting time to the first establishment is approximately the inverse of the rate of producing establishing $AB$, i.e., $T \\approx 1/(\\lambda p_{est})$. Therefore,\n$$\n\\frac{T_{asexual}}{T_{sexual}} = \\frac{\\lambda_{sexual}}{\\lambda_{asexual}} = \\frac{\\frac{N r \\mu^{2}}{s^{2}}}{\\frac{2 N \\mu^{2}}{s}} = \\frac{r}{2 s}.\n$$\nThis result uses assumption 2 by neglecting the sequential-mutation pathway in the sexual population and uses assumption 1 to set the single-mutant frequencies at mutation-selection balance.", "answer": "$$\\boxed{\\frac{r}{2 s}}$$", "id": "1434174"}]}