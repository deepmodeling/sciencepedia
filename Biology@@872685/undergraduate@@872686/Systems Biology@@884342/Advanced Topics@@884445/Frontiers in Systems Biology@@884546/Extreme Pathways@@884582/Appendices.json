{"hands_on_practices": [{"introduction": "To begin our hands-on exploration of extreme pathways, we will start with the simplest possible network topology: a linear, unbranched chain of reactions. This foundational exercise [@problem_id:1433391] demonstrates the direct relationship between a single, non-decomposable metabolic route and a single extreme pathway. Mastering this simple case provides the essential intuition needed to analyze more complex network structures.", "problem": "Consider a simple, unbranched metabolic pathway in a hypothetical microorganism. The pathway converts an external substrate, $S_{ext}$, into an external product, $P_{ext}$, through a series of four metabolites. The entire process is described by five irreversible reactions, each associated with a unique flux, $v$:\n\n1.  $v_{in}: S_{ext} \\rightarrow S$ (Substrate uptake)\n2.  $v_{1}: S \\rightarrow I_{1}$ (First enzymatic step)\n3.  $v_{2}: I_{1} \\rightarrow I_{2}$ (Second enzymatic step)\n4.  $v_{3}: I_{2} \\rightarrow P$ (Third enzymatic step)\n5.  $v_{out}: P \\rightarrow P_{ext}$ (Product secretion)\n\nThe metabolites within the system boundary, which are assumed to be at a steady state, are $S, I_1, I_2,$ and $P$. Extreme pathways are the fundamental, non-decomposable steady-state flux distributions of a metabolic network.\n\nDetermine the single extreme pathway for this metabolic network. Express your answer as a row matrix representing the flux vector $(v_{in}, v_{1}, v_{2}, v_{3}, v_{out})$, normalized such that the first component is 1.", "solution": "Define the internal metabolites in the chosen order as $S$, $I_{1}$, $I_{2}$, and $P$, and the reactions in the order $(v_{in}, v_{1}, v_{2}, v_{3}, v_{out})$. The stoichiometric matrix $S$ for the internal metabolites is\n$$\nS=\\begin{pmatrix}\n1  -1  0  0  0 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  -1  0 \\\\\n0  0  0  1  -1\n\\end{pmatrix}.\n$$\nAt steady state, the internal metabolite concentrations do not change, so the mass balance condition is\n$$\nS\\mathbf{v}=\\mathbf{0},\n$$\nwhere $\\mathbf{v}=[v_{in}, v_{1}, v_{2}, v_{3}, v_{out}]^{T}$. Additionally, all reactions are irreversible, so\n$$\nv_{in}\\geq 0,\\quad v_{1}\\geq 0,\\quad v_{2}\\geq 0,\\quad v_{3}\\geq 0,\\quad v_{out}\\geq 0.\n$$\nWriting the steady-state equations componentwise from $S\\mathbf{v}=\\mathbf{0}$ gives\n$$\nv_{in}-v_{1}=0,\\quad v_{1}-v_{2}=0,\\quad v_{2}-v_{3}=0,\\quad v_{3}-v_{out}=0.\n$$\nSolving these equalities yields\n$$\nv_{in}=v_{1}=v_{2}=v_{3}=v_{out}\\equiv t,\\quad t\\geq 0.\n$$\nThus the feasible steady-state flux cone under irreversibility is the nonnegative ray spanned by the vector\n$$\n\\begin{pmatrix} 1  1  1  1  1 \\end{pmatrix}.\n$$\nExtreme pathways are the extreme rays of this cone. Since the network is a single unbranched chain, there is exactly one extreme pathway given by this ray. Normalizing so that the first component equals $1$ gives the flux vector\n$$\n\\begin{pmatrix} 1  1  1  1  1 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 1  1  1  1  1 \\end{pmatrix}}$$", "id": "1433391"}, {"introduction": "Metabolic networks gain their versatility from branch points, which allow a cell to direct resources toward different outcomes based on its needs. This next practice [@problem_id:1433349] introduces a simple branch point where one metabolite is converted into two different products. By solving this problem, you will see how each independent route from input to output corresponds to a distinct extreme pathway, forming the boundaries of the system's production capabilities.", "problem": "Consider a simplified metabolic module within a microorganism designed for producing two distinct valuable compounds. The module operates under steady-state conditions and all its reactions are considered irreversible. The network consists of one uptake reaction and subsequent conversion pathways.\n\nThe set of reactions is defined as follows, where $A_{ext}$, $B_{ext}$, and $C_{ext}$ are external metabolites, while $A$, $B$, and $C$ are internal metabolites:\n-   Uptake flux ($v_1$): $A_{ext} \\rightarrow A$\n-   First branch ($v_2$): $A \\rightarrow B$\n-   Second branch ($v_3$): $A \\rightarrow C$\n-   Product 1 secretion ($v_4$): $B \\rightarrow B_{ext}$\n-   Product 2 secretion ($v_5$): $C \\rightarrow C_{ext}$\n\nThis network architecture has one input ($A_{ext}$), one branch point (metabolite $A$), and two distinct product outputs ($B_{ext}$ and $C_{ext}$).\n\nYour task is to determine the complete set of extreme pathways for this metabolic network. The resulting pathway vectors should be column vectors with fluxes ordered as $[v_1, v_2, v_3, v_4, v_5]^T$. Present the final set of extreme pathways as the columns of a single matrix. The order of the columns in the matrix does not matter.", "solution": "The first step in determining the extreme pathways of a metabolic network is to construct its stoichiometric matrix, $S$. The rows of this matrix correspond to the internal metabolites, and the columns correspond to the fluxes (reactions). In this problem, the internal metabolites are $A$, $B$, and $C$, and the fluxes are $v_1$ through $v_5$.\n\nThe changes in concentration for each internal metabolite are given by the following balance equations:\n-   Metabolite $A$: $dA/dt = v_1 - v_2 - v_3$\n-   Metabolite $B$: $dB/dt = v_2 - v_4$\n-   Metabolite $C$: $dC/dt = v_3 - v_5$\n\nThe stoichiometric matrix $S$ is constructed from the coefficients of the fluxes in these equations.\n\n$$\nS = \\begin{pmatrix}\n1  -1  -1  0  0 \\\\\n0  1  0  -1  0 \\\\\n0  0  1  0  -1\n\\end{pmatrix}\n$$\n\nThe system is at a steady state, which implies that the concentrations of the internal metabolites are constant. Mathematically, this is expressed as $S \\mathbf{v} = \\mathbf{0}$, where $\\mathbf{v}$ is the column vector of fluxes, $\\mathbf{v} = [v_1, v_2, v_3, v_4, v_5]^T$.\n\nThis matrix equation yields a system of linear equations:\n1.  $v_1 - v_2 - v_3 = 0$\n2.  $v_2 - v_4 = 0$\n3.  $v_3 - v_5 = 0$\n\nAdditionally, all reactions are irreversible, which imposes the non-negativity constraint: $v_i \\ge 0$ for $i = 1, 2, 3, 4, 5$.\n\nThe set of all flux vectors $\\mathbf{v}$ satisfying these conditions forms a convex polyhedral cone. The extreme pathways are the vectors that generate the edges of this cone. To find them, we need to find a basis for the null space of $S$ under the non-negativity constraint.\n\nFrom the system of equations, we can express some fluxes in terms of others:\n-   From equation (2): $v_2 = v_4$\n-   From equation (3): $v_3 = v_5$\n-   Substituting these into equation (1): $v_1 = v_2 + v_3 = v_4 + v_5$\n\nWe have 5 variables and 3 independent equations, so there are $5 - 3 = 2$ free variables. Let's choose $v_4$ and $v_5$ as our free variables. Let $v_4 = a$ and $v_5 = b$. Due to the irreversibility constraint, we must have $a \\ge 0$ and $b \\ge 0$.\n\nNow we can express the entire flux vector $\\mathbf{v}$ in terms of $a$ and $b$:\n-   $v_4 = a$\n-   $v_5 = b$\n-   $v_2 = v_4 = a$\n-   $v_3 = v_5 = b$\n-   $v_1 = v_4 + v_5 = a + b$\n\nSo, any valid flux vector $\\mathbf{v}$ can be written as:\n$$\n\\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\\\ v_4 \\\\ v_5 \\end{pmatrix} = \\begin{pmatrix} a+b \\\\ a \\\\ b \\\\ a \\\\ b \\end{pmatrix}\n$$\n\nWe can decompose this vector as a linear combination of two basis vectors:\n$$\n\\mathbf{v} = a \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix} + b \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nSince $a \\ge 0$ and $b \\ge 0$, any valid steady-state flux distribution is a non-negative linear combination of these two vectors. These two basis vectors are the extreme pathways, $p_1$ and $p_2$.\n\n-   Pathway 1 ($p_1$), by setting $a=1, b=0$:\n$$\np_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nThis pathway represents the flow of material from input $A_{ext}$ to output $B_{ext}$: $A_{ext} \\rightarrow A \\rightarrow B \\rightarrow B_{ext}$.\n\n-   Pathway 2 ($p_2$), by setting $a=0, b=1$:\n$$\np_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nThis pathway represents the flow of material from input $A_{ext}$ to output $C_{ext}$: $A_{ext} \\rightarrow A \\rightarrow C \\rightarrow C_{ext}$.\n\nThe problem asks for the set of extreme pathways to be presented as columns in a single matrix. Combining $p_1$ and $p_2$ gives the final answer.\n$$\nP = \\begin{pmatrix} p_1  p_2 \\end{pmatrix} = \\begin{pmatrix}\n1  1 \\\\\n1  0 \\\\\n0  1 \\\\\n1  0 \\\\\n0  1\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1 \\\\\n1  0 \\\\\n0  1 \\\\\n1  0 \\\\\n0  1\n\\end{pmatrix}\n}\n$$", "id": "1433349"}, {"introduction": "Building on the previous examples, we now tackle a more intricate network that features both converging and branching fluxes, along with non-trivial reaction stoichiometry. This problem [@problem_id:1433354] simulates a scenario where multiple substrates are utilized to create different products, requiring a more careful application of the steady-state mass balance principles. Calculating the extreme pathways for this system will solidify your understanding of how to decompose any complex network into its fundamental, independent modes of operation.", "problem": "Consider a simplified model of a metabolic network within a microorganism. The network involves four internal metabolites, denoted as A, B, C, and D. The system operates at a steady state, and all reactions are considered to be irreversible. The network consists of the following six reactions, with their associated fluxes $v_1$ through $v_6$:\n\n1.  $v_1$: An input flux that produces metabolite A.\n2.  $v_2$: An input flux that produces metabolite B.\n3.  $v_3$: $A + B \\rightarrow C$\n4.  $v_4$: $2A \\rightarrow D$\n5.  $v_5$: $C \\rightarrow$ (an output flux that consumes C)\n6.  $v_6$: $D \\rightarrow$ (an output flux that consumes D)\n\nDetermine the set of extreme pathways for this metabolic network. Extreme pathways are the fundamental, irreducible, steady-state flux distributions of the network.\n\nFor the final answer, present the set of extreme pathway vectors. Arrange these vectors as rows in a matrix, with the vectors ordered from top to bottom based on their lexicographical ordering (i.e., compare vectors by their first component, then their second if the first are equal, and so on). Each pathway vector should be in the form $[v_1, v_2, v_3, v_4, v_5, v_6]$.", "solution": "Define the internal metabolites as $A$, $B$, $C$, and $D$, and the irreversible reactions $v_{1}$ through $v_{6}$ as:\n- $v_{1}$: external input to $A$, stoichiometry for $A$: $+1$.\n- $v_{2}$: external input to $B$, stoichiometry for $B$: $+1$.\n- $v_{3}$: $A + B \\rightarrow C$, stoichiometry: $A:-1$, $B:-1$, $C:+1$.\n- $v_{4}$: $2A \\rightarrow D$, stoichiometry: $A:-2$, $D:+1$.\n- $v_{5}$: $C \\rightarrow$ external, stoichiometry for $C$: $-1$.\n- $v_{6}$: $D \\rightarrow$ external, stoichiometry for $D$: $-1$.\n\nThe steady-state constraints for internal metabolites give $S \\mathbf{v} = \\mathbf{0}$, with $\\mathbf{v} \\ge \\mathbf{0}$ due to irreversibility. Writing mass balances:\n$$\n\\begin{aligned}\nA:\\quad v_{1} - v_{3} - 2 v_{4} = 0,\\\\\nB:\\quad v_{2} - v_{3} = 0,\\\\\nC:\\quad v_{3} - v_{5} = 0,\\\\\nD:\\quad v_{4} - v_{6} = 0,\n\\end{aligned}\n$$\ntogether with $v_{i} \\ge 0$ for all $i$.\n\nSolve the linear system in terms of free nonnegative variables. From the equations,\n$$\nv_{2} = v_{3},\\quad v_{5} = v_{3},\\quad v_{6} = v_{4},\\quad v_{1} = v_{3} + 2 v_{4},\n$$\nso every feasible steady-state flux vector has the form\n$$\n\\mathbf{v} = [v_{3} + 2 v_{4},\\; v_{3},\\; v_{3},\\; v_{4},\\; v_{3},\\; v_{4}],\\quad v_{3} \\ge 0,\\; v_{4} \\ge 0.\n$$\nThis defines a pointed convex cone in $\\mathbb{R}^{6}$ generated by two nonnegative degrees of freedom $v_{3}$ and $v_{4}$. The extreme rays (extreme pathways) correspond to setting one free variable positive and the other zero, yielding irreducible steady-state flux distributions:\n- Set $v_{4} = 0$, $v_{3}  0$: $\\mathbf{v} = [1,\\,1,\\,1,\\,0,\\,1,\\,0]$ up to positive scaling.\n- Set $v_{3} = 0$, $v_{4}  0$: $\\mathbf{v} = [2,\\,0,\\,0,\\,1,\\,0,\\,1]$ up to positive scaling.\n\nThese two are irreducible and generate all feasible steady-state fluxes via nonnegative combinations; thus they are the extreme pathways. Ordering the vectors lexicographically (comparing first component, then second, etc.), $[1,\\,1,\\,1,\\,0,\\,1,\\,0]$ precedes $[2,\\,0,\\,0,\\,1,\\,0,\\,1]$.\n\nArranging them as rows in a matrix gives\n$$\n\\begin{pmatrix}\n1  1  1  0  1  0 \\\\\n2  0  0  1  0  1\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1  1  1  0  1  0 \\\\ 2  0  0  1  0  1\\end{pmatrix}}$$", "id": "1433354"}]}