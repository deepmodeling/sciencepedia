{"hands_on_practices": [{"introduction": "To begin our exploration of network control, we first need a solid grasp of what it means for a system to be 'fully controllable.' This exercise [@problem_id:1451352] provides a foundational example using a simple gene regulatory cascade, a common motif in biological networks. By translating this biological structure into a linear state-space model, you will apply the Kalman controllability rank condition to determine if an external input at the start of the cascade is sufficient to steer all protein concentrations to any desired level.", "problem": "In synthetic biology, engineers design gene regulatory networks to perform specific tasks. Consider a simple synthetic cascade built in a cell, consisting of two genes, which produce proteins B and C respectively. The concentration of protein B, denoted by $x_B(t)$, is controlled by an external chemical inducer whose concentration we can manipulate over time, represented by the input function $u(t)$. The production rate of protein B is directly proportional to this input. Protein B, in turn, acts as a transcriptional activator for the gene producing protein C, whose concentration is denoted by $x_C(t)$. The production rate of protein C is proportional to the concentration of protein B. Both proteins are subject to natural degradation, with rates proportional to their own concentrations.\n\nThe dynamics of the system can be modeled by the following set of linear ordinary differential equations:\n$$\n\\frac{dx_B}{dt} = k_1 u(t) - \\gamma_B x_B(t)\n$$\n$$\n\\frac{dx_C}{dt} = k_2 x_B(t) - \\gamma_C x_C(t)\n$$\n\nHere, $x_B(t)$ and $x_C(t)$ are the concentrations of proteins B and C. The parameters $k_1$ and $k_2$ are positive constants representing the strength of the input and the activation of C by B, respectively. The parameters $\\gamma_B > 0$ and $\\gamma_C > 0$ are the degradation rate constants for proteins B and C.\n\nThe system is defined as \"fully controllable\" if it is possible to drive the state of the system, represented by the vector of concentrations $(x_B, x_C)$, from any arbitrary initial state $(x_{B,0}, x_{C,0})$ to any arbitrary final state $(x_{B,f}, x_{C,f})$ in a finite amount of time by appropriately choosing the input function $u(t)$.\n\nUnder what condition is this two-protein system fully controllable?\n\nA. The system is always fully controllable, as long as all defined parameters ($k_1, k_2, \\gamma_B, \\gamma_C$) are positive.\n\nB. The system is never fully controllable because the external input $u(t)$ only directly influences the concentration of protein B.\n\nC. The system is fully controllable only if the degradation rates are identical, i.e., $\\gamma_B = \\gamma_C$.\n\nD. The system is fully controllable only if the activation strength $k_2$ is greater than the degradation rate $\\gamma_B$.\n\nE. The system is fully controllable only if the degradation rates are different, i.e., $\\gamma_B \\neq \\gamma_C$.", "solution": "We rewrite the system in standard linear state-space form. Let the state vector be $x(t) = \\begin{pmatrix} x_{B}(t) \\\\ x_{C}(t) \\end{pmatrix}$. Then the given dynamics\n$$\n\\frac{dx_{B}}{dt} = k_{1} u(t) - \\gamma_{B} x_{B}(t), \\qquad \\frac{dx_{C}}{dt} = k_{2} x_{B}(t) - \\gamma_{C} x_{C}(t)\n$$\ncan be written as\n$$\n\\dot{x}(t) = A x(t) + B u(t),\n$$\nwith\n$$\nA = \\begin{pmatrix} -\\gamma_{B} & 0 \\\\ k_{2} & -\\gamma_{C} \\end{pmatrix}, \\qquad B = \\begin{pmatrix} k_{1} \\\\ 0 \\end{pmatrix}.\n$$\nFor a single-input linear time-invariant system, the Kalman controllability condition states that the system is fully controllable if and only if the controllability matrix\n$$\n\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix}\n$$\nhas full rank equal to the state dimension (here, rank $2$). We compute\n$$\nAB = \\begin{pmatrix} -\\gamma_{B} & 0 \\\\ k_{2} & -\\gamma_{C} \\end{pmatrix} \\begin{pmatrix} k_{1} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -\\gamma_{B} k_{1} \\\\ k_{2} k_{1} \\end{pmatrix}.\n$$\nThus,\n$$\n\\mathcal{C} = \\begin{pmatrix} k_{1} & -\\gamma_{B} k_{1} \\\\ 0 & k_{2} k_{1} \\end{pmatrix}.\n$$\nThe rank of $\\mathcal{C}$ equals $2$ if and only if its determinant is nonzero. The determinant is\n$$\n\\det(\\mathcal{C}) = k_{1} \\cdot (k_{2} k_{1}) - (-\\gamma_{B} k_{1}) \\cdot 0 = k_{1}^{2} k_{2}.\n$$\nTherefore, the system is fully controllable if and only if $k_{1} \\neq 0$ and $k_{2} \\neq 0$. Given the problem assumption that $k_{1} > 0$ and $k_{2} > 0$, the determinant is strictly positive, and the system is fully controllable regardless of the values of $\\gamma_{B}$ and $\\gamma_{C}$. Hence the correct choice is that the system is always fully controllable under the stated positivity of parameters.", "answer": "$$\\boxed{A}$$", "id": "1451352"}, {"introduction": "While the ideal of full controllability is a useful starting point, many real-world systems are not entirely controllable from a single input. This practice [@problem_id:1451372] highlights a crucial limitation in network control dictated by the network's topology: you cannot influence nodes that are disconnected from your input signals. By analyzing a system composed of two independent pathways, you will learn to identify the 'controllable subspace' and quantify the precise extent of your influence over the network, shifting the question from a simple 'yes/no' to 'what parts of the system can I actually control?'.", "problem": "In systems biology, a common problem is to determine whether the state of a biological system can be fully controlled by external inputs. Consider a simplified model of two independent signaling pathways within a cell. The first pathway involves the concentrations of two proteins, $x_1(t)$ and $x_2(t)$, and the second pathway involves the concentrations of two other proteins, $x_3(t)$ and $x_4(t)$. The entire system's state is described by the vector $\\mathbf{x}(t) = [x_1(t), x_2(t), x_3(t), x_4(t)]^T$.\n\nThe dynamics of these protein concentrations are modeled by the following set of coupled linear ordinary differential equations:\n$$\n\\begin{aligned}\n\\frac{dx_1}{dt} &= -x_1 + x_2 + u(t) \\\\\n\\frac{dx_2}{dt} &= -x_1 - x_2 \\\\\n\\frac{dx_3}{dt} &= -x_3 \\\\\n\\frac{dx_4}{dt} &= x_3 - x_4\n\\end{aligned}\n$$\nHere, $u(t)$ represents an external control signal, such as the introduction of a drug, that directly influences the concentration of protein $x_1$. The system is classified as \"fully controllable\" if it is possible to drive the system from any initial state to any desired final state in finite time by manipulating the control input $u(t)$. The set of all states that can be reached from the origin is known as the controllable subspace.\n\nDetermine the dimension of the controllable subspace for this system. Your answer should be a single integer.", "solution": "We model the system in state-space form $\\dot{\\mathbf{x}} = A \\mathbf{x} + B u$, where $\\mathbf{x} = [x_{1}, x_{2}, x_{3}, x_{4}]^{T}$. From the given differential equations,\n$$\nA = \\begin{bmatrix}\n-1 & 1 & 0 & 0 \\\\\n-1 & -1 & 0 & 0 \\\\\n0 & 0 & -1 & 0 \\\\\n0 & 0 & 1 & -1\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{bmatrix}.\n$$\nThe controllable subspace is the span of the columns of the Kalman controllability matrix $\\mathcal{C} = [B, AB, A^{2}B, A^{3}B]$. We compute these columns explicitly.\n\nFirst, compute $AB$:\n$$\nAB = A \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\text{first column of } A = \\begin{bmatrix} -1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nNext, compute $A^{2}B = A(AB)$:\n$$\nA^{2}B = A \\begin{bmatrix} -1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix}\n-1 \\cdot (-1) + 1 \\cdot (-1) \\\\\n-1 \\cdot (-1) + (-1) \\cdot (-1) \\\\\n0 \\\\\n0\n\\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nThen compute $A^{3}B = A(A^{2}B)$:\n$$\nA^{3}B = A \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix}\n-1 \\cdot 0 + 1 \\cdot 2 \\\\\n-1 \\cdot 0 + (-1) \\cdot 2 \\\\\n0 \\\\\n0\n\\end{bmatrix} = \\begin{bmatrix} 2 \\\\ -2 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\nThus,\n$$\n\\mathcal{C} = \\begin{bmatrix}\n1 & -1 & 0 & 2 \\\\\n0 & -1 & 2 & -2 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{bmatrix}.\n$$\nAll columns of $\\mathcal{C}$ have zeros in the last two entries because $A$ is block diagonal between $\\{x_{1}, x_{2}\\}$ and $\\{x_{3}, x_{4}\\}$ and $B$ acts only on $x_{1}$. Therefore, the rank of $\\mathcal{C}$ is at most $2$. To determine the exact rank, observe that the first and third columns,\n$$\n\\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} \\quad \\text{and} \\quad \\begin{bmatrix} 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{bmatrix},\n$$\nare linearly independent. Hence $\\operatorname{rank}(\\mathcal{C}) = 2$. By the definition of the controllable subspace as the span of the columns of $\\mathcal{C}$, its dimension is $2$.", "answer": "$$\\boxed{2}$$", "id": "1451372"}, {"introduction": "Moving from influencing a system to understanding it, we now turn to the concept of observabilityâ€”the flip side of controllability. This problem [@problem_id:1451388] explores observability in the context of a convergent metabolic pathway, asking a critical experimental question: can we deduce the amounts of initial substrates just by measuring the final product? You will discover how specific symmetries in reaction rates can create 'blind spots', making it impossible to distinguish between different internal states from the output alone. This exercise underscores the importance of observability analysis in designing experiments and interpreting their results.", "problem": "A synthetic biologist is studying a simplified model of a convergent metabolic pathway. In this model, two distinct substrate molecules, $S_1$ and $S_2$, are converted into a common intermediate molecule, $I$. This intermediate is then subsequently converted into a final product, $P$. The pathway can be represented as:\n$S_1 \\xrightarrow{k_1} I$\n$S_2 \\xrightarrow{k_2} I$\n$I \\xrightarrow{k_3} P$\n\nAll reactions are modeled as first-order processes. Let $x_1(t)$, $x_2(t)$, $x_3(t)$, and $x_4(t)$ represent the concentrations of $S_1$, $S_2$, $I$, and $P$ at time $t$, respectively. The time evolution of these concentrations is governed by the following system of linear ordinary differential equations:\n$$\n\\begin{aligned}\n\\frac{dx_1}{dt} &= -k_1 x_1 \\\\\n\\frac{dx_2}{dt} &= -k_2 x_2 \\\\\n\\frac{dx_3}{dt} &= k_1 x_1 + k_2 x_2 - k_3 x_3 \\\\\n\\frac{dx_4}{dt} &= k_3 x_3\n\\end{aligned}\n$$\nThe rate constants $k_1$, $k_2$, and $k_3$ are all positive real numbers. In this experimental setup, it is known that the initial concentrations of the intermediate and the product are zero, i.e., $x_3(0) = 0$ and $x_4(0) = 0$. The biologist's measurement device can only track the concentration of the final product, $x_4(t)$, over time.\n\nFor a specific experiment, the reaction conditions are set such that the conversion rates of the two initial substrates are identical, meaning $k_1 = k_2$. Based on the continuous measurement of $x_4(t)$, is it possible to uniquely determine the initial concentration of the first substrate, $x_1(0)$?\n\nA. Yes, the system is fully observable regardless of the rate constants, so $x_1(0)$ can always be determined.\n\nB. No. While the sum of the initial substrate concentrations, $x_1(0) + x_2(0)$, can be determined, the individual values cannot be resolved from the measurement of $x_4(t)$.\n\nC. No, because the concentration of the product, $x_4(t)$, is completely independent of the initial substrate concentrations $x_1(0)$ and $x_2(0)$.\n\nD. Yes, because the condition $k_1=k_2$ introduces a symmetry that simplifies the system, making it easier to determine $x_1(0)$.", "solution": "We solve the state equations explicitly and express the measured output in terms of the initial conditions. First, since the substrate dynamics are decoupled and first order,\n$$\nx_{1}(t)=x_{1}(0)\\exp(-k_{1}t),\\qquad x_{2}(t)=x_{2}(0)\\exp(-k_{2}t).\n$$\nUsing $x_{4}'(t)=k_{3}x_{3}(t)$ and $x_{3}(0)=x_{4}(0)=0$, we differentiate once to eliminate $x_{3}$:\n$$\n\\frac{d}{dt}\\left(\\frac{x_{4}'}{k_{3}}\\right)=k_{1}x_{1}+k_{2}x_{2}-k_{3}\\frac{x_{4}'}{k_{3}},\n$$\nwhich gives the linear relation\n$$\nx_{4}''+k_{3}x_{4}'=k_{3}\\big(k_{1}x_{1}(0)\\exp(-k_{1}t)+k_{2}x_{2}(0)\\exp(-k_{2}t)\\big).\n$$\nDefine $y(t):=x_{4}(t)$ and $g(t):=y''(t)+k_{3}y'(t)$, which is computable from the continuous measurement of $y(t)$. Then\n$$\ng(t)=k_{3}k_{1}x_{1}(0)\\exp(-k_{1}t)+k_{3}k_{2}x_{2}(0)\\exp(-k_{2}t).\n$$\nIf $k_{1}\\neq k_{2}$, the right-hand side is a sum of exponentials with distinct exponents, and the representation is unique, so the coefficients $k_{3}k_{1}x_{1}(0)$ and $k_{3}k_{2}x_{2}(0)$ can be uniquely recovered and hence $x_{1}(0)$ and $x_{2}(0)$ are individually identifiable.\n\nIn the experiment of interest, $k_{1}=k_{2}=k$. Then\n$$\ng(t)=k_{3}k\\big(x_{1}(0)+x_{2}(0)\\big)\\exp(-kt),\n$$\nso only the sum $x_{1}(0)+x_{2}(0)$ appears. This shows directly that $y(t)$ depends on $x_{1}(0)$ and $x_{2}(0)$ only through their sum. To make this explicit, we can solve for $x_{3}$ and $x_{4}$. With $k_{1}=k_{2}=k$, write $a:=x_{1}(0)$ and $b:=x_{2}(0)$. Then $x_{1}(t)=a\\exp(-kt)$ and $x_{2}(t)=b\\exp(-kt)$, and\n$$\n\\frac{dx_{3}}{dt}=k(a+b)\\exp(-kt)-k_{3}x_{3},\\qquad x_{3}(0)=0.\n$$\nSolving,\n$$\nx_{3}(t)=\n\\begin{cases}\n\\dfrac{k(a+b)}{k-k_{3}}\\big(\\exp(-k_{3}t)-\\exp(-kt)\\big), & k\\neq k_{3}, \\\\\nk(a+b)\\,t\\,\\exp(-kt), & k=k_{3},\n\\end{cases}\n$$\nand thus\n$$\nx_{4}'(t)=k_{3}x_{3}(t),\\quad x_{4}(0)=0\\ \\Rightarrow\\\nx_{4}(t)=\n\\begin{cases}\n\\dfrac{k(a+b)}{k-k_{3}}\\big(1-\\exp(-k_{3}t)\\big)-\\dfrac{k_{3}(a+b)}{k-k_{3}}\\big(1-\\exp(-kt)\\big), & k\\neq k_{3}, \\\\\n(a+b)\\big(1-\\exp(-kt)-kt\\,\\exp(-kt)\\big), & k=k_{3}.\n\\end{cases}\n$$\nIn both subcases, $x_{4}(t)$ depends on $a$ and $b$ only through the sum $a+b=x_{1}(0)+x_{2}(0)$. Therefore, any two pairs $(x_{1}(0),x_{2}(0))$ and $(\\tilde{x}_{1}(0),\\tilde{x}_{2}(0))$ with the same sum produce identical $x_{4}(t)$. Consequently, $x_{1}(0)$ cannot be uniquely determined from $x_{4}(t)$ when $k_{1}=k_{2}$, although $x_{1}(0)+x_{2}(0)$ is identifiable.\n\nHence the correct choice is that only the sum is observable, not the individual initial concentrations.", "answer": "$$\\boxed{B}$$", "id": "1451388"}]}