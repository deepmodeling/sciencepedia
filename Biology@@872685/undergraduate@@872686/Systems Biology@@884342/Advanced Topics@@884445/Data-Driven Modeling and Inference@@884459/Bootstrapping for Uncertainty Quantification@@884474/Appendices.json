{"hands_on_practices": [{"introduction": "The first step in leveraging any new computational technique is learning to interpret its results. Bootstrapping generates a distribution of a statistic of interest, and the simplest way to summarize the uncertainty is by constructing a percentile confidence interval directly from this distribution. This exercise [@problem_id:1420137] provides a gentle entry point, focusing on how to extract a meaningful confidence interval from a pre-computed bootstrap analysis in the context of bacterial persistence, a key topic in microbiology.", "problem": "A systems biology researcher is investigating bacterial persistence, a phenomenon where a small fraction of a microbial population survives a lethal dose of an antibiotic. The researcher conducts an experiment with eight replicate cultures of *Escherichia coli*. Each culture is treated with a high concentration of ampicillin, and after a set period, the survival fraction is determined by counting the remaining Colony-Forming Units (CFUs). The following eight survival fractions were measured:\n$$ \\{1.72, 1.41, 1.55, 3.15, 1.63, 1.88, 1.39, 1.61\\} \\times 10^{-5} $$\nTo quantify the uncertainty in the estimation of the true mean survival fraction from this small and non-normally distributed dataset, a computational bootstrap analysis was performed. This analysis involved generating $B=10,000$ bootstrap resamples from the original data and calculating the mean of each resample. This created a distribution of 10,000 bootstrap means. After sorting these means in ascending order, key values from the sorted list were recorded. The values at specific ranks in the sorted list are as follows:\n- 250th value: $1.59 \\times 10^{-5}$\n- 500th value: $1.64 \\times 10^{-5}$\n- 9500th value: $2.31 \\times 10^{-5}$\n- 9750th value: $2.42 \\times 10^{-5}$\n\nUsing this information from the bootstrap analysis, determine the 90% confidence interval for the mean survival fraction using the percentile method. Provide the lower and upper bounds of this interval. Express your final answers for the lower and upper bounds in units of $10^{-5}$, and round each to three significant figures.", "solution": "We want a 90 percent confidence interval for the mean using the bootstrap percentile method. Let $B$ be the number of bootstrap resamples and let $\\{\\bar{x}^{*(1)},\\ldots,\\bar{x}^{*(B)}\\}$ denote the bootstrap means sorted in ascending order. For a two-sided percentile interval with nominal coverage $1-\\alpha=0.90$, the lower and upper bounds are taken at the empirical quantiles $p_{\\text{lower}}=\\alpha/2$ and $p_{\\text{upper}}=1-\\alpha/2$ of the sorted bootstrap distribution:\n$$\n\\text{CI}_{\\text{percentile}}=\\left[\\bar{x}^{*}_{(\\lfloor p_{\\text{lower}} B \\rfloor)}\\,,\\,\\bar{x}^{*}_{(\\lceil p_{\\text{upper}} B \\rceil)}\\right].\n$$\nHere $B=10000$ and $\\alpha=0.10$, so\n$$\np_{\\text{lower}}=0.05,\\quad p_{\\text{upper}}=0.95,\\quad p_{\\text{lower}} B=500,\\quad p_{\\text{upper}} B=9500.\n$$\nThe problem provides the exact sorted bootstrap values at these ranks:\n- 500th value (the 0.05 quantile): $1.64 \\times 10^{-5}$,\n- 9500th value (the 0.95 quantile): $2.31 \\times 10^{-5}$.\nTherefore, the 90 percent bootstrap percentile confidence interval for the mean survival fraction is\n$$\n\\left[1.64 \\times 10^{-5},\\,2.31 \\times 10^{-5}\\right].\n$$\nExpressing these bounds in units of $10^{-5}$ gives the pair $\\left(1.64,\\,2.31\\right)$, already to three significant figures.", "answer": "$$\\boxed{\\begin{pmatrix}1.64  2.31\\end{pmatrix}}$$", "id": "1420137"}, {"introduction": "After learning to interpret bootstrap results, the next logical step is to perform the calculations that produce a confidence interval. This practice moves from passive interpretation to active calculation, focusing on the mechanics of deriving an interval from a raw set of bootstrap replicates. By working with a concrete set of bootstrap values from a hypothetical quorum sensing experiment, you will gain hands-on experience with sorting data and applying percentile definitions to find the confidence bounds yourself [@problem_id:1420159], solidifying the link between the cloud of resampled estimates and the final reported interval.", "problem": "A systems biology researcher is investigating quorum sensing, a cell-to-cell communication mechanism in bacteria. They culture a strain of bacteria engineered to express Green Fluorescent Protein (GFP) under the control of a quorum-sensing-activated promoter. The researcher measures the mean GFP fluorescence at various cell densities.\n\nTo quantify the sensitivity of the quorum sensing circuit, the researcher defines an \"activation threshold\" as the cell density at which the mean GFP fluorescence reaches 50% of the maximum fluorescence observed in the experiment. To estimate the uncertainty of this activation threshold, a bootstrap analysis is performed. From the original experimental data, a large number of bootstrap samples are generated, and for each sample, the activation threshold is calculated. This process yields a distribution of bootstrap replicate values for the threshold.\n\nBelow are 20 bootstrap replicate values for the activation threshold, given in units of $10^7$ cells/mL:\n1.15, 1.21, 1.13, 1.19, 1.25, 1.14, 1.28, 1.17, 1.22, 1.16, 1.20, 1.12, 1.26, 1.30, 1.10, 1.18, 1.23, 1.27, 1.11, 1.24\n\nUsing this set of bootstrap replicates, calculate the width of the 95% percentile bootstrap confidence interval for the activation threshold. The value for a percentile $P$ should be determined by the following linear interpolation method:\n1.  Calculate the rank $R = p \\times (N-1) + 1$, where $p=P/100$ is the percentile (e.g., $p=0.025$ for the 2.5th percentile) and $N$ is the total number of data points.\n2.  Let $k = \\lfloor R \\rfloor$ be the integer part of the rank and $d = R - k$ be the fractional part.\n3.  The percentile value is $V = S_k + d \\times (S_{k+1} - S_k)$, where $S_k$ is the k-th value in the sorted list of data points (using 1-based indexing, so $S_1$ is the smallest value).\n\nExpress your final answer for the width of the confidence interval in cells/mL, rounded to three significant figures.", "solution": "We are given 20 bootstrap replicate values for the activation threshold (in units of $10^{7}$ cells/mL). To construct the 95 percent percentile bootstrap confidence interval, we compute the 2.5th and 97.5th percentiles using the specified linear interpolation method. Let $N=20$ and let the sorted replicates (ascending) be denoted by $S_{1},\\dots,S_{20}$.\n\nFirst, sort the data:\n$$\nS_{1}=1.10,\\ S_{2}=1.11,\\ S_{3}=1.12,\\ S_{4}=1.13,\\ S_{5}=1.14,\\ S_{6}=1.15,\\ S_{7}=1.16,\\ S_{8}=1.17,\\ S_{9}=1.18,\\ S_{10}=1.19,\n$$\n$$\nS_{11}=1.20,\\ S_{12}=1.21,\\ S_{13}=1.22,\\ S_{14}=1.23,\\ S_{15}=1.24,\\ S_{16}=1.25,\\ S_{17}=1.26,\\ S_{18}=1.27,\\ S_{19}=1.28,\\ S_{20}=1.30.\n$$\n\nFor the 2.5th percentile, take $p=0.025$. Using the given interpolation:\n$$\nR=p\\,(N-1)+1=0.025 \\times 19 + 1=1.475,\\quad k=\\lfloor R \\rfloor=1,\\quad d=R-k=0.475.\n$$\nThus,\n$$\nV_{2.5} = S_{1} + d\\,(S_{2}-S_{1}) = 1.10 + 0.475\\,(1.11-1.10) = 1.10 + 0.00475 = 1.10475.\n$$\n\nFor the 97.5th percentile, take $p=0.975$. Then\n$$\nR=p\\,(N-1)+1=0.975 \\times 19 + 1=19.525,\\quad k=\\lfloor R \\rfloor=19,\\quad d=R-k=0.525.\n$$\nThus,\n$$\nV_{97.5} = S_{19} + d\\,(S_{20}-S_{19}) = 1.28 + 0.525\\,(1.30-1.28) = 1.28 + 0.0105 = 1.2905.\n$$\n\nTherefore, the 95 percent confidence interval (in units of $10^{7}$ cells/mL) is\n$$\n[\\,1.10475,\\ 1.2905\\,].\n$$\nThe width in units of $10^{7}$ cells/mL is\n$$\n\\Delta = 1.2905 - 1.10475 = 0.18575.\n$$\n\nSince the original values are in units of $10^{7}$ cells/mL, the width in cells/mL is\n$$\nW = 0.18575 \\times 10^{7} = 1.8575 \\times 10^{6}\\ \\text{cells/mL}.\n$$\nRounded to three significant figures, this is\n$$\n1.86 \\times 10^{6}.\n$$", "answer": "$$\\boxed{1.86 \\times 10^{6}}$$", "id": "1420159"}, {"introduction": "A deeper understanding of bootstrapping reveals that for certain problems, the computational resampling process can be modeled analytically, leading to more efficient and exact solutions. This advanced problem [@problem_id:1420152] challenges you to explore this powerful connection in the context of a modern high-throughput experiment. You will see how bootstrapping a proportion—in this case, the fraction of neutral mutations from a Deep Mutational Scanning experiment—is mathematically equivalent to sampling from a Binomial distribution, a key insight that bridges nonparametric resampling with parametric statistics.", "problem": "A systems biology laboratory is investigating the functional consequences of single amino acid substitutions in a particular enzyme using Deep Mutational Scanning (DMS). This high-throughput experiment yields a continuous \"fitness score,\" $s$, for each mutation. A fitness score of $s=0$ indicates a neutral mutation (no effect on function), $s0$ indicates a deleterious mutation, and $s0$ indicates a beneficial mutation.\n\nDue to inherent experimental noise and the resolution of the assay, any mutation with a fitness score $s$ in the range $|s| \\le 0.05$ is considered to be functionally neutral. In a pilot experiment, the following 25 fitness scores were measured for 25 distinct mutations:\n$S = [-1.21, -0.99, -0.87, -0.65, -0.53, -0.48, -0.33, -0.29, -0.21, -0.15, -0.11, -0.08, -0.04, -0.02, 0.01, 0.03, 0.04, 0.07, 0.10, 0.14, 0.22, 0.35, 0.58, 0.91, 1.15]$\n\nTo quantify the statistical uncertainty of the proportion of neutral mutations based on this limited sample, you are tasked with performing a resampling analysis. Specifically, your goal is to determine the 95% confidence interval for the true fraction of neutral mutations. To achieve this, you should conceptualize the generation of $B=10000$ resampled datasets. Each resampled dataset is constructed by drawing 25 fitness scores *with replacement* from the original dataset $S$. For each of these $10000$ resampled datasets, one would compute the fraction of neutral mutations. The 95% confidence interval is then given by the 2.5th and 97.5th percentiles of the resulting distribution of these 10000 fractions.\n\nCalculate the lower and upper bounds of this 95% confidence interval. Report your answer as a pair of values, with the lower bound first, rounded to three significant figures.", "solution": "We first classify each fitness score $s \\in S$ as neutral if $|s| \\leq 0.05$. In the given list,\n$$S = [-1.21, -0.99, -0.87, -0.65, -0.53, -0.48, -0.33, -0.29, -0.21, -0.15, -0.11, -0.08, -0.04, -0.02, 0.01, 0.03, 0.04, 0.07, 0.10, 0.14, 0.22, 0.35, 0.58, 0.91, 1.15],$$\nthe neutral scores are $-0.04, -0.02, 0.01, 0.03, 0.04$, so the neutral count is $c=5$ out of $n=25$ total. The observed neutral fraction is\n$$\\hat{p} = \\frac{c}{n} = \\frac{5}{25} = 0.2.$$\n\nIn the bootstrap procedure, each resampled dataset is constructed by drawing $n=25$ scores with replacement from $S$. Each draw is from the empirical distribution that places mass $1/n$ on each observed score; hence the probability a draw is neutral equals $\\hat{p}$. Therefore, the number of neutral mutations $K$ in one bootstrap resample follows\n$$K \\sim \\operatorname{Binomial}(n, \\hat{p}), \\quad \\text{with } n=25, \\ \\hat{p}=0.2.$$\nThe bootstrap distribution of the neutral fraction is $K/n$. The $95$ percent bootstrap percentile interval corresponds to the $0.025$ and $0.975$ quantiles of $K/n$, i.e., values $k_{\\mathrm{L}}$ and $k_{\\mathrm{U}}$ such that\n$$\\Pr(K \\leq k_{\\mathrm{L}}) \\geq 0.025 \\ \\text{and} \\ \\Pr(K \\leq k_{\\mathrm{L}}-1)  0.025,$$\n$$\\Pr(K \\leq k_{\\mathrm{U}}) \\geq 0.975 \\ \\text{and} \\ \\Pr(K \\leq k_{\\mathrm{U}}-1)  0.975.$$\n\nThe binomial probabilities are\n$$\\Pr(K=k) = \\binom{25}{k} (0.2)^{k} (0.8)^{25-k}.$$\nCompute the lower tail using $P_{k}=\\Pr(K=k)$ and the recursion\n$$\\frac{P_{k+1}}{P_{k}} = \\frac{25-k}{k+1} \\cdot \\frac{0.2}{0.8} = \\frac{25-k}{k+1} \\cdot 0.25.$$\nStart from\n$$P_{0} = 0.8^{25} \\approx 0.003776,$$\n$$P_{1} = P_{0} \\cdot 25 \\cdot 0.25 \\approx 0.0236,$$\nso\n$$\\Pr(K \\leq 0) \\approx 0.003776  0.025,\\quad \\Pr(K \\leq 1) \\approx 0.003776 + 0.0236 = 0.0274 \\geq 0.025.$$\nThus $k_{\\mathrm{L}}=1$, giving the lower bound $k_{\\mathrm{L}}/n = 1/25 = 0.04$.\n\nFor the upper tail, continue cumulative sums:\n$$P_{2} = 3 P_{1} \\approx 0.0708,\\ \\ P_{3} \\approx 0.1356,\\ \\ P_{4} \\approx 0.1865,\\ \\ P_{5} \\approx 0.1958,$$\n$$P_{6} \\approx 0.1631,\\ \\ P_{7} \\approx 0.1107,\\ \\ P_{8} \\approx 0.06227,\\ \\ P_{9} \\approx 0.02941.$$\nCumulative probabilities:\n$$\\Pr(K \\leq 8) \\approx 0.9521  0.975,\\quad \\Pr(K \\leq 9) \\approx 0.9815 \\geq 0.975.$$\nHence $k_{\\mathrm{U}}=9$, giving the upper bound $k_{\\mathrm{U}}/n = 9/25 = 0.36$.\n\nTherefore, the $95$ confidence interval for the true fraction of neutral mutations, using the bootstrap percentile method described, is $[0.04, 0.36]$. Rounded to three significant figures, this is $[0.0400, 0.360]$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.0400  0.360 \\end{pmatrix}}$$", "id": "1420152"}]}