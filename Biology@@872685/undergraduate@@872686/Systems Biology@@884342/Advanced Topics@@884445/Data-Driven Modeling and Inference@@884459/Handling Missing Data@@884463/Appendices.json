{"hands_on_practices": [{"introduction": "The first step in tackling missing data is often to apply the simplest possible fix. Mean imputation, where a missing value is replaced by the average of observed values, is a foundational technique. This exercise [@problem_id:1437187] provides a concrete starting point, allowing you to perform this basic but essential calculation on a typical gene expression dataset.", "problem": "A research group is studying the transcriptional response of human cells to a novel therapeutic compound. They measured the expression levels of five key signaling genes (labeled G1, G2, G3, G4, G5) across four replicate cell cultures (labeled S1, S2, S3, S4). The data, represented as normalized expression units, are organized in a matrix where rows correspond to genes and columns correspond to replicates.\n\nDue to a smudge on the microarray slide, the expression value for gene G3 in replicate S3 could not be read. The recorded dataset is as follows, with 'X' denoting the missing value:\n\n- **G1:** [2.15, 2.30, 2.25, 2.18]\n- **G2:** [0.88, 0.95, 0.91, 1.02]\n- **G3:** [1.54, 1.71, X, 1.60]\n- **G4:** [3.40, 3.11, 3.25, 3.32]\n- **G5:** [0.45, 0.39, 0.41, 0.44]\n\nTo complete the dataset before further statistical analysis, the team decides to employ a basic data imputation technique. Your task is to calculate the value of 'X' using gene-wise mean imputation. This technique involves replacing the missing value for a specific gene with the arithmetic mean of the observed expression values for that same gene from all other replicates.\n\nCalculate the imputed expression value for gene G3 in replicate S3. Round your final answer to three significant figures.", "solution": "We use gene-wise mean imputation: replace the missing value by the arithmetic mean of the observed values for the same gene. For gene G3, the observed expression values are $1.54$, $1.71$, and $1.60$ across the available replicates.\n\nThe imputed value $X$ is computed as\n$$\nX=\\frac{1}{3}\\left(1.54+1.71+1.60\\right).\n$$\nFirst sum the observed values:\n$$\n1.54+1.71=3.25,\\quad 3.25+1.60=4.85.\n$$\nDivide by the number of observed values:\n$$\nX=\\frac{4.85}{3}=1.616\\overline{6}.\n$$\nRounding to three significant figures gives\n$$\nX\\approx 1.62.\n$$", "answer": "$$\\boxed{1.62}$$", "id": "1437187"}, {"introduction": "Choosing an imputation method is not a neutral decision; it can significantly influence the results of your analysis. This practice [@problem_id:1437170] moves beyond simple calculation to explore the downstream consequences of your choices. By comparing the outcomes of mean imputation versus a more sophisticated k-Nearest Neighbors (k-NN) approach, you will learn to quantify how different strategies can alter which genes are identified as significant, a critical skill for any data scientist.", "problem": "In a systems biology experiment investigating the cellular response to a new drug, a researcher measured the expression levels of five genes (A, B, C, D, E) across three control samples (C1, C2, C3) and three treated samples (T1, T2, T3). The resulting dataset contains some missing values, denoted by `NA`.\n\n| Gene | C1   | C2   | C3   | T1   | T2   | T3   |\n|:----:|:----:|:----:|:----:|:----:|:----:|:----:|\n| A    | 2.0  | 3.0  | 2.5  | 6.0  | 5.0  | 5.5  |\n| B    | 8.0  | 9.0  | 7.0  | 3.0  | NA   | 4.0  |\n| C    | 4.0  | 5.0  | 6.0  | 4.5  | 5.5  | 5.0  |\n| D    | 10.0 | 11.0 | NA   | 10.5 | 9.5  | 10.0 |\n| E    | 1.0  | 2.0  | 3.0  | 8.0  | 9.0  | NA   |\n\nTo assess the impact of missing data on the conclusions, you must compare two imputation strategies: mean imputation and k-Nearest Neighbors (k-NN) imputation.\n\n1.  **Mean Imputation**: For a given gene, any `NA` value is replaced by the arithmetic mean of the observed expression values for that gene across all other samples.\n2.  **k-Nearest Neighbors (k-NN) Imputation**: For this problem, use `k=1`. To impute a missing value for a gene, first identify its \"nearest neighbor\". The distance between two genes is defined as the Euclidean distance between their expression vectors, calculated *only* over the set of samples where both genes have observed values. The gene with the smallest distance is the nearest neighbor. If there is a tie for the nearest neighbor, select the gene that comes first in alphabetical order. The `NA` is then replaced by the expression value of this nearest neighbor in the sample corresponding to the `NA`.\n\nAfter imputation, a gene is classified as Significantly Differentially Expressed (SDE) if its Differential Expression Score (DES) exceeds a threshold. The DES is defined as the absolute difference between the mean expression in the treated group and the mean expression in the control group:\n$$\n\\text{DES} = |\\text{mean}(\\text{Treated}) - \\text{mean}(\\text{Control})|\n$$\nA gene is considered SDE if its $\\text{DES} > 3.7$.\n\nYour task is to calculate the Jaccard distance between the set of SDE genes identified using mean imputation ($S_{\\text{mean}}$) and the set of SDE genes identified using 1-NN imputation ($S_{\\text{1-NN}}$). The Jaccard distance is defined as:\n$$\nD_J(S_{\\text{mean}}, S_{\\text{1-NN}}) = 1 - \\frac{|S_{\\text{mean}} \\cap S_{\\text{1-NN}}|}{|S_{\\text{mean}} \\cup S_{\\text{1-NN}}|}\n$$\nExpress your final answer as a decimal rounded to three significant figures.", "solution": "We denote the control samples as $C1, C2, C3$ and the treated samples as $T1, T2, T3$. There are three missing values: $B(T2)$, $D(C3)$, and $E(T3)$.\n\nMean imputation:\nFor each affected gene, replace the missing value with the mean of its observed entries across all samples.\n\n- Gene $B$: observed values are $8.0, 9.0, 7.0, 3.0, 4.0$, so\n$$\n\\overline{B}_{\\text{obs}}=\\frac{8+9+7+3+4}{5}=\\frac{31}{5}=6.2,\\quad B(T2)\\leftarrow 6.2.\n$$\n- Gene $D$: observed values are $10.0, 11.0, 10.5, 9.5, 10.0$, so\n$$\n\\overline{D}_{\\text{obs}}=\\frac{10+11+10.5+9.5+10}{5}=\\frac{51}{5}=10.2,\\quad D(C3)\\leftarrow 10.2.\n$$\n- Gene $E$: observed values are $1.0, 2.0, 3.0, 8.0, 9.0$, so\n$$\n\\overline{E}_{\\text{obs}}=\\frac{1+2+3+8+9}{5}=\\frac{23}{5}=4.6,\\quad E(T3)\\leftarrow 4.6.\n$$\n\nCompute DES for each gene with mean imputation. For a gene $G$, with control mean $\\overline{G}_{C}$ and treated mean $\\overline{G}_{T}$,\n$$\n\\text{DES}(G)=|\\overline{G}_{T}-\\overline{G}_{C}|.\n$$\n- $A$: $\\overline{A}_{C}=\\frac{2.0+3.0+2.5}{3}=2.5$, $\\overline{A}_{T}=\\frac{6.0+5.0+5.5}{3}=5.5$, so $\\text{DES}(A)=|5.5-2.5|=3.0$.\n- $B$: $\\overline{B}_{C}=\\frac{8+9+7}{3}=8$, $\\overline{B}_{T}=\\frac{3.0+6.2+4.0}{3}=\\frac{13.2}{3}=4.4$, so $\\text{DES}(B)=|4.4-8|=3.6$.\n- $C$: $\\overline{C}_{C}=\\frac{4+5+6}{3}=5$, $\\overline{C}_{T}=\\frac{4.5+5.5+5.0}{3}=5$, so $\\text{DES}(C)=0$.\n- $D$: $\\overline{D}_{C}=\\frac{10.0+11.0+10.2}{3}=\\frac{31.2}{3}=10.4$, $\\overline{D}_{T}=\\frac{10.5+9.5+10.0}{3}=10$, so $\\text{DES}(D)=|10-10.4|=0.4$.\n- $E$: $\\overline{E}_{C}=\\frac{1+2+3}{3}=2$, $\\overline{E}_{T}=\\frac{8+9+4.6}{3}=\\frac{21.6}{3}=7.2$, so $\\text{DES}(E)=|7.2-2|=5.2$.\n\nWith threshold $3.7$, the SDE genes are those with $\\text{DES}>3.7$. Hence under mean imputation,\n$$\nS_{\\text{mean}}=\\{E\\}.\n$$\n\n1-NN imputation (with $k=1$):\nFor a gene with a missing value, identify its nearest neighbor by Euclidean distance over the intersection of observed samples. For genes $X$ and $Y$, using the set $S$ of samples where both are observed,\n$$\nd(X,Y)=\\sqrt{\\sum_{s\\in S}(x_{s}-y_{s})^{2}},\n$$\nand we compare using $d^{2}(X,Y)$.\n\n- For $B$ (missing at $T2$):\n    - $d^{2}(B,A)$ over $\\{C1,C2,C3,T1,T3\\}$:\n    $$\n    (8-2)^{2}+(9-3)^{2}+(7-2.5)^{2}+(3-6)^{2}+(4-5.5)^{2}=36+36+20.25+9+2.25=103.5.\n    $$\n    - $d^{2}(B,C)$ over $\\{C1,C2,C3,T1,T3\\}$:\n    $$\n    (8-4)^{2}+(9-5)^{2}+(7-6)^{2}+(3-4.5)^{2}+(4-5)^{2}=16+16+1+2.25+1=36.25.\n    $$\n    - $d^{2}(B,D)$ over $\\{C1,C2,T1,T3\\}$:\n    $$\n    (8-10)^{2}+(9-11)^{2}+(3-10.5)^{2}+(4-10)^{2}=4+4+56.25+36=100.25.\n    $$\n    - $d^{2}(B,E)$ over $\\{C1,C2,C3,T1\\}$:\n    $$\n    (8-1)^{2}+(9-2)^{2}+(7-3)^{2}+(3-8)^{2}=49+49+16+25=139.\n    $$\n    The minimum is $36.25$ with neighbor $C$, so $B(T2)\\leftarrow C(T2)=5.5$.\n\n- For $D$ (missing at $C3$):\n    - $d^{2}(D,A)$ over $\\{C1,C2,T1,T2,T3\\}$:\n    $$\n    (10-2)^{2}+(11-3)^{2}+(10.5-6)^{2}+(9.5-5)^{2}+(10-5.5)^{2}=64+64+20.25+20.25+20.25=188.75.\n    $$\n    - $d^{2}(D,B)$ over $\\{C1,C2,T1,T3\\}$:\n    $$\n    (10-8)^{2}+(11-9)^{2}+(10.5-3)^{2}+(10-4)^{2}=4+4+56.25+36=100.25.\n    $$\n    - $d^{2}(D,C)$ over $\\{C1,C2,T1,T2,T3\\}$:\n    $$\n    (10-4)^{2}+(11-5)^{2}+(10.5-4.5)^{2}+(9.5-5.5)^{2}+(10-5)^{2}=36+36+36+16+25=149.\n    $$\n    - $d^{2}(D,E)$ over $\\{C1,C2,T1,T2\\}$:\n    $$\n    (10-1)^{2}+(11-2)^{2}+(10.5-8)^{2}+(9.5-9)^{2}=81+81+6.25+0.25=168.5.\n    $$\n    The minimum is $100.25$ with neighbor $B$, so $D(C3)\\leftarrow B(C3)=7.0$.\n\n- For $E$ (missing at $T3$):\n    - $d^{2}(E,A)$ over $\\{C1,C2,C3,T1,T2\\}$:\n    $$\n    (1-2)^{2}+(2-3)^{2}+(3-2.5)^{2}+(8-6)^{2}+(9-5)^{2}=1+1+0.25+4+16=22.25.\n    $$\n    - $d^{2}(E,B)$ over $\\{C1,C2,C3,T1\\}$:\n    $$\n    (1-8)^{2}+(2-9)^{2}+(3-7)^{2}+(8-3)^{2}=49+49+16+25=139.\n    $$\n    - $d^{2}(E,C)$ over $\\{C1,C2,C3,T1,T2\\}$:\n    $$\n    (1-4)^{2}+(2-5)^{2}+(3-6)^{2}+(8-4.5)^{2}+(9-5.5)^{2}=9+9+9+12.25+12.25=51.5.\n    $$\n    - $d^{2}(E,D)$ over $\\{C1,C2,T1,T2\\}$:\n    $$\n    (1-10)^{2}+(2-11)^{2}+(8-10.5)^{2}+(9-9.5)^{2}=81+81+6.25+0.25=168.5.\n    $$\n    The minimum is $22.25$ with neighbor $A$, so $E(T3)\\leftarrow A(T3)=5.5$.\n\nCompute DES for each gene with 1-NN imputation:\n- $A$: unchanged, $\\overline{A}_{C}=2.5$, $\\overline{A}_{T}=5.5$, $\\text{DES}(A)=3.0$.\n- $B$: $\\overline{B}_{C}=8$, $\\overline{B}_{T}=\\frac{3.0+5.5+4.0}{3}=\\frac{12.5}{3}$, so\n$$\n\\text{DES}(B)=\\left|\\frac{12.5}{3}-8\\right|=\\left|\\,\\frac{12.5-24}{3}\\,\\right|=\\frac{11.5}{3}\\approx 3.833\\ldots\n$$\n- $C$: $\\text{DES}(C)=0$.\n- $D$: $\\overline{D}_{C}=\\frac{10+11+7}{3}=\\frac{28}{3}$, $\\overline{D}_{T}=10$, so\n$$\n\\text{DES}(D)=\\left|10-\\frac{28}{3}\\right|=\\frac{2}{3}\\approx 0.666\\ldots\n$$\n- $E$: $\\overline{E}_{C}=2$, $\\overline{E}_{T}=\\frac{8+9+5.5}{3}=\\frac{22.5}{3}=7.5$, so $\\text{DES}(E)=|7.5-2|=5.5$.\n\nWith threshold $3.7$, the SDE genes under 1-NN are\n$$\nS_{\\text{1-NN}}=\\{B,E\\}.\n$$\n\nJaccard distance:\n$$\nS_{\\text{mean}}=\\{E\\},\\quad S_{\\text{1-NN}}=\\{B,E\\},\\quad |S_{\\text{mean}}\\cap S_{\\text{1-NN}}|=1,\\quad |S_{\\text{mean}}\\cup S_{\\text{1-NN}}|=2.\n$$\nTherefore,\n$$\nD_{J}=1-\\frac{|S_{\\text{mean}}\\cap S_{\\text{1-NN}}|}{|S_{\\text{mean}}\\cup S_{\\text{1-NN}}|}=1-\\frac{1}{2}=\\frac{1}{2}=0.5.\n$$\nRounded to three significant figures, this is $0.500$.", "answer": "$$\\boxed{0.500}$$", "id": "1437170"}, {"introduction": "For dynamic systems measured over time, we can leverage our understanding of the underlying biological processes to make more intelligent imputations. This advanced exercise [@problem_id:1437209] introduces a powerful, model-based approach where missing data points and unknown model parameters are estimated simultaneously in an iterative loop. By working through this problem, you will engage with a sophisticated technique that bridges the gap between data completion and mechanistic modeling in systems biology.", "problem": "A systems biologist is studying a synthetic genetic toggle switch constructed in a bacterial host. The switch consists of two proteins, A and B, which mutually repress each other's synthesis. The dynamics of the protein concentrations, $A(t)$ and $B(t)$, are modeled by a system of Ordinary Differential Equations (ODEs). For computational analysis, the system is discretized using the forward Euler method with a time step $\\Delta t$:\n\n$A_{i+1} = A_i + \\Delta t \\left( \\frac{\\alpha_A}{1 + B_i^2} - \\delta A_i \\right)$\n$B_{i+1} = B_i + \\Delta t \\left( \\frac{\\alpha_B}{1 + A_i^2} - \\delta B_i \\right)$\n\nHere, $A_i$ and $B_i$ are the concentrations at time step $i$. The parameters $\\alpha_A$ and $\\alpha_B$ are the maximal production rates, and $\\delta$ is the degradation/dilution rate, which is assumed to be the same for both proteins. The concentrations are measured in nanomolars (nM) and time in hours.\n\nFrom previous experiments, the following parameters are considered known: $\\alpha_A = 20.0$, $\\delta = 0.5$, and the time step used is $\\Delta t = 1.0$. The production rate $\\alpha_B$ is unknown and needs to be estimated from experimental data.\n\nA time-series measurement was performed, yielding the following data:\n- At $t=0$ (i=0): $A_0 = 0.20$ nM, $B_0 = 4.0$ nM.\n- At $t=1$ (i=1): $A_1 = 1.50$ nM, $B_1 = 3.5$ nM.\n- At $t=2$ (i=2): $A_2 = 2.50$ nM. The measurement for $B_2$ was corrupted and is missing.\n\nTo address the missing data point and estimate the unknown parameter, you are to use a procedure called Coupled Imputation-Estimation (CIE). The procedure is iterative.\n\n**Initialization (Iteration k=0):**\n- The initial guess for the unknown parameter is $\\alpha_B^{(0)} = 10.0$.\n- The initial guess for the missing data point, $B_2^{(0)}$, is obtained by carrying forward the last valid observation: $B_2^{(0)} = B_1$.\n\n**Iterative Update (for k = 1, 2, ...):**\nEach iteration $k$ consists of two steps performed in sequence:\n\n1.  **Parameter Estimation:** A new estimate for the parameter, $\\alpha_B^{(k)}$, is calculated. This is done by finding the value of $\\alpha_B$ that minimizes the sum of squared errors for the B-dynamics across all available time intervals. The model for the B-dynamics can be rearranged as $\\frac{B_{i+1} - B_i}{\\Delta t} + \\delta B_i = \\alpha_B \\left( \\frac{1}{1 + A_i^2} \\right)$. Use the dataset, including the current imputed value for the missing point ($B_2^{(k-1)}$), to perform a linear least-squares fit to find the optimal $\\alpha_B^{(k)}$. The general solution for a model $y_j = c \\cdot x_j$ from a set of data points $(x_j, y_j)$ that minimizes $\\sum_j (y_j - c \\cdot x_j)^2$ is $c = \\frac{\\sum_j x_j y_j}{\\sum_j x_j^2}$.\n\n2.  **Data Imputation:** A new estimate for the missing data point, $B_2^{(k)}$, is calculated using the forward Euler equation for $B$ at step $i=1$, employing the newly updated parameter estimate $\\alpha_B^{(k)}$ from part (1) of this iteration.\n\nYour task is to calculate the imputed value for the missing concentration $B_2$ after two full iterations of the CIE algorithm. Express your final answer for this value, $B_2^{(2)}$, in nM, rounded to three significant figures.", "solution": "We use the forward Euler discretization for $B$:\n$$\nB_{i+1} = B_{i} + \\Delta t\\left(\\frac{\\alpha_{B}}{1 + A_{i}^{2}} - \\delta B_{i}\\right),\n$$\nand the rearranged linear form for parameter estimation:\n$$\n\\frac{B_{i+1} - B_{i}}{\\Delta t} + \\delta B_{i} = \\alpha_{B}\\left(\\frac{1}{1 + A_{i}^{2}}\\right).\n$$\nDefine $x_{i} = \\frac{1}{1 + A_{i}^{2}}$ and $y_{i} = \\frac{B_{i+1} - B_{i}}{\\Delta t} + \\delta B_{i}$. With $\\Delta t = 1$ and $\\delta = 0.5$, and data $A_{0} = 0.20$, $A_{1} = 1.50$, $B_{0} = 4.0$, $B_{1} = 3.5$, the required $x_{i}$ are\n$$\nx_{0} = \\frac{1}{1 + (0.20)^{2}} = \\frac{1}{1.04} = \\frac{25}{26},\\qquad\nx_{1} = \\frac{1}{1 + (1.50)^{2}} = \\frac{1}{3.25} = \\frac{4}{13}.\n$$\nInitialization gives $\\alpha_{B}^{(0)} = 10.0$ and $B_{2}^{(0)} = B_{1} = 3.5$.\n\nIteration $k=1$, parameter estimation: using $B_{2}^{(0)}$,\n$$\ny_{0} = (B_{1} - B_{0}) + \\delta B_{0} = (3.5 - 4.0) + 0.5\\cdot 4.0 = \\frac{3}{2},\n$$\n$$\ny_{1}^{(0)} = (B_{2}^{(0)} - B_{1}) + \\delta B_{1} = (3.5 - 3.5) + 0.5\\cdot 3.5 = \\frac{7}{4}.\n$$\nThe least-squares estimator for $\\alpha_{B}$ is\n$$\n\\alpha_{B}^{(1)} = \\frac{\\sum_{i=0}^{1} x_{i}y_{i}}{\\sum_{i=0}^{1} x_{i}^{2}}\n= \\frac{\\frac{25}{26}\\cdot\\frac{3}{2} + \\frac{4}{13}\\cdot\\frac{7}{4}}{\\left(\\frac{25}{26}\\right)^{2} + \\left(\\frac{4}{13}\\right)^{2}}\n= \\frac{\\frac{75}{52} + \\frac{7}{13}}{\\frac{625}{676} + \\frac{16}{169}}\n= \\frac{\\frac{103}{52}}{\\frac{689}{676}}\n= \\frac{103}{52}\\cdot\\frac{676}{689}\n= \\frac{1339}{689}.\n$$\nIteration $k=1$, data imputation at $i=1$:\n$$\nB_{2}^{(1)} = B_{1} + \\left(\\frac{\\alpha_{B}^{(1)}}{1 + A_{1}^{2}} - \\delta B_{1}\\right)\n= 3.5 + \\left(\\alpha_{B}^{(1)}\\cdot\\frac{4}{13} - 0.5\\cdot 3.5\\right)\n= \\frac{7}{4} + \\frac{1339}{689}\\cdot\\frac{4}{13}.\n$$\nUsing $\\frac{1339}{689}\\cdot\\frac{4}{13} = \\frac{5356}{8957}$ gives\n$$\nB_{2}^{(1)} = \\frac{7}{4} + \\frac{5356}{8957} = \\frac{84123}{35828}.\n$$\n\nIteration $k=2$, parameter estimation: with $B_{2}^{(1)}$,\n$$\ny_{1}^{(1)} = (B_{2}^{(1)} - B_{1}) + \\delta B_{1} = B_{2}^{(1)} - \\frac{7}{4} = \\alpha_{B}^{(1)}\\cdot\\frac{4}{13} = \\frac{5356}{8957}.\n$$\nThus\n$$\n\\alpha_{B}^{(2)} = \\frac{\\frac{25}{26}\\cdot\\frac{3}{2} + \\frac{4}{13}\\cdot\\frac{5356}{8957}}{\\left(\\frac{25}{26}\\right)^{2} + \\left(\\frac{4}{13}\\right)^{2}}\n= \\frac{\\frac{75}{52} + \\frac{21424}{116441}}{\\frac{689}{676}}\n= \\frac{\\frac{757471}{465764}}{\\frac{689}{676}}\n= \\frac{757471}{465764}\\cdot\\frac{676}{689}\n= \\frac{512050396}{320911396}.\n$$\nIteration $k=2$, data imputation:\n$$\nB_{2}^{(2)} = B_{1} + \\left(\\frac{\\alpha_{B}^{(2)}}{1 + A_{1}^{2}} - \\delta B_{1}\\right)\n= \\frac{7}{4} + \\alpha_{B}^{(2)}\\cdot\\frac{4}{13}\n= \\frac{7}{4} + \\frac{512050396}{1042962037}.\n$$\nNumerically, $\\frac{512050396}{1042962037} \\approx 0.490957846$, hence\n$$\nB_{2}^{(2)} \\approx 2.240957846.\n$$\nRounded to three significant figures, this yields $2.24$.", "answer": "$$\\boxed{2.24}$$", "id": "1437209"}]}