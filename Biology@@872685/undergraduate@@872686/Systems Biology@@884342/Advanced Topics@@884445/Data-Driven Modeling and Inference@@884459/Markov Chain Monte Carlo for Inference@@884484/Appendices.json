{"hands_on_practices": [{"introduction": "At the core of the Metropolis-Hastings algorithm is a simple probabilistic decision: should the simulation accept a newly proposed parameter value or stick with the current one? This exercise breaks down that fundamental mechanism by having you calculate the acceptance probability for a kinetic rate constant in a simple enzyme reaction model. Understanding this calculation is key to demystifying how MCMC algorithms explore the landscape of possible parameter values to find those that best explain the data. [@problem_id:1444253]", "problem": "A systems biologist is studying a simple enzymatic reaction where a substrate protein, S, is phosphorylated by a kinase to produce a product, P. The reaction is modeled as a first-order kinetic process. The concentration of the phosphorylated product, $[P](t)$, at time $t$ is described by the equation:\n$$[P](t) = [S]_0 (1 - \\exp(-kt))$$\nwhere $[S]_0$ is the initial concentration of the substrate S, and $k$ is the phosphorylation rate constant. The biologist aims to estimate the value of $k$ from experimental data using a Bayesian inference approach, specifically the Metropolis-Hastings Markov Chain Monte Carlo (MCMC) algorithm.\n\nThe experiment was performed with an initial substrate concentration of $[S]_0 = 1.0 \\, \\mu\\text{M}$. The concentration of the product P was measured at three different time points, yielding the following dataset:\n- At $t_1 = 1.0$ min, the measured concentration is $[P]_1 = 0.25 \\, \\mu\\text{M}$.\n- At $t_2 = 2.0$ min, the measured concentration is $[P]_2 = 0.45 \\, \\mu\\text{M}$.\n- At $t_3 = 5.0$ min, the measured concentration is $[P]_3 = 0.70 \\, \\mu\\text{M}$.\n\nThe measurement errors are assumed to be independent and to follow a Gaussian distribution with a mean of zero and a known standard deviation of $\\sigma = 0.05 \\, \\mu\\text{M}$. For the Bayesian analysis, a uniform prior distribution is chosen for the rate constant $k$ over the interval $[0, 1.0 \\, \\text{min}^{-1}]$.\n\nDuring one step of the MCMC simulation, the current state of the chain is $k_{current} = 0.30 \\, \\text{min}^{-1}$. A new candidate state is proposed, $k_{prop} = 0.35 \\, \\text{min}^{-1}$. Calculate the Metropolis-Hastings acceptance probability, $\\alpha$, for this proposed move. Round your final answer to three significant figures.", "solution": "We model the observations using independent Gaussian errors with known standard deviation $\\sigma$, so the likelihood for a given $k$ is\n$$\nL(k) = \\prod_{i=1}^{3} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\!\\left(-\\frac{\\left([P]_{i}-[P](t_{i};k)\\right)^{2}}{2\\sigma^{2}}\\right),\n$$\nwhere $[P](t;k) = [S]_{0}\\left(1-\\exp(-kt)\\right)$. The prior for $k$ is uniform on $[0,1]$, and both $k_{current}=0.30$ and $k_{prop}=0.35$ lie in this interval, so the prior ratio is $1$. Assuming a symmetric proposal (so the proposal density ratio is $1$), the Metropolis-Hastings acceptance probability is\n$$\n\\alpha = \\min\\!\\left(1,\\frac{L(k_{prop})}{L(k_{current})}\\right)\n= \\min\\!\\left(1,\\exp\\!\\left(-\\frac{\\sum_{i=1}^{3}\\left(r_{prop,i}^{2}-r_{curr,i}^{2}\\right)}{2\\sigma^{2}}\\right)\\right),\n$$\nwith residuals $r_{(\\cdot),i} = [P]_{i}-[P](t_{i};k_{(\\cdot)})$.\n\nUsing $[S]_{0}=1.0$, $\\sigma=0.05$, times $t_{1}=1.0$, $t_{2}=2.0$, $t_{3}=5.0$, and observations $[P]_{1}=0.25$, $[P]_{2}=0.45$, $[P]_{3}=0.70$, compute model predictions:\n- For $k_{current}=0.30$:\n$$\n[P](1;0.30)=1-\\exp(-0.30)=0.2591817793,\\quad\n[P](2;0.30)=1-\\exp(-0.60)=0.4511883639,\\quad\n[P](5;0.30)=1-\\exp(-1.50)=0.7768698399.\n$$\nResiduals and squares:\n$$\nr_{curr,1}=0.25-0.2591817793=-0.0091817793,\\quad r_{curr,1}^{2}\\approx 0.0000843051,\n$$\n$$\nr_{curr,2}=0.45-0.4511883639=-0.0011883639,\\quad r_{curr,2}^{2}\\approx 0.00000141221,\n$$\n$$\nr_{curr,3}=0.70-0.7768698399=-0.0768698399,\\quad r_{curr,3}^{2}\\approx 0.00590897229,\n$$\nso\n$$\n\\mathrm{SSE}_{current}=\\sum r_{curr,i}^{2}\\approx 0.00599468957.\n$$\n\n- For $k_{prop}=0.35$:\n$$\n[P](1;0.35)=1-\\exp(-0.35)=0.2953119103,\\quad\n[P](2;0.35)=1-\\exp(-0.70)=0.5034146962,\\quad\n[P](5;0.35)=1-\\exp(-1.75)=0.8262260565.\n$$\nResiduals and squares:\n$$\nr_{prop,1}=0.25-0.2953119103=-0.0453119103,\\quad r_{prop,1}^{2}\\approx 0.00205316922,\n$$\n$$\nr_{prop,2}=0.45-0.5034146962=-0.0534146962,\\quad r_{prop,2}^{2}\\approx 0.00285312977,\n$$\n$$\nr_{prop,3}=0.70-0.8262260565=-0.1262260565,\\quad r_{prop,3}^{2}\\approx 0.01593301734,\n$$\nso\n$$\n\\mathrm{SSE}_{prop}=\\sum r_{prop,i}^{2}\\approx 0.02083931633.\n$$\n\nThus\n$$\n\\Delta \\mathrm{SSE}=\\mathrm{SSE}_{prop}-\\mathrm{SSE}_{current}\\approx 0.01484462676,\\quad\n2\\sigma^{2}=2\\cdot(0.05)^{2}=0.005,\n$$\nand the likelihood ratio is\n$$\n\\frac{L(k_{prop})}{L(k_{current})}=\\exp\\!\\left(-\\frac{\\Delta \\mathrm{SSE}}{2\\sigma^{2}}\\right)\n=\\exp\\!\\left(-\\frac{0.01484462676}{0.005}\\right)=\\exp(-2.96892535)\\approx 0.0514.\n$$\nTherefore,\n$$\n\\alpha=\\min(1,0.0514)=0.0514,\n$$\nto three significant figures.", "answer": "$$\\boxed{0.0514}$$", "id": "1444253"}, {"introduction": "After running an MCMC simulation, we are left with thousands of parameter samples that form the posterior distribution. A critical step in the analysis is to examine the structure of this distribution, which often reveals hidden relationships between parameters. This practice guides you in quantifying the connection between the intrinsic growth rate $r$ and the carrying capacity $K$ in a logistic model, demonstrating how to diagnose potential model identifiability issues by calculating the correlation from posterior samples. [@problem_id:1444240]", "problem": "A systems biologist is studying the growth dynamics of a yeast culture. The population growth is modeled by the logistic equation:\n$$ \\frac{dN}{dt} = r N \\left(1 - \\frac{N}{K}\\right) $$\nwhere $N$ is the population size, $t$ is time, $r$ is the intrinsic growth rate, and $K$ is the carrying capacity of the environment.\n\nTo estimate the values of $r$ and $K$ from experimental data, the biologist performs a Bayesian inference using a Markov Chain Monte Carlo (MCMC) algorithm. This computational technique generates a sequence of parameter values (called samples) from the posterior probability distribution, which represents the updated beliefs about the parameters after observing the data. A key step in analyzing the MCMC output is to check for correlations between the estimated parameters, as strong correlations can indicate that the model is ill-conditioned or that the data is not very informative for distinguishing between the parameters' effects.\n\nThe MCMC simulation has produced a large number of samples for the pair $(r, K)$. For a quick analysis, the biologist randomly selects five of these samples:\n\n- Sample 1: ($r_1=0.55$, $K_1=980$)\n- Sample 2: ($r_2=0.48$, $K_2=1050$)\n- Sample 3: ($r_3=0.51$, $K_3=1010$)\n- Sample 4: ($r_4=0.60$, $K_4=950$)\n- Sample 5: ($r_5=0.45$, $K_5=1100$)\n\nThe unit of $r$ is hours$^{-1}$ and the unit of $K$ is thousands of cells.\n\nCalculate the sample Pearson correlation coefficient between the growth rate $r$ and the carrying capacity $K$ based on this subset of posterior samples. This coefficient provides a quantitative measure of the linear association between the two parameters. The final answer should be a dimensionless number. Round your final answer to three significant figures.", "solution": "The goal is to compute the sample Pearson correlation coefficient, $\\rho_{r,K}$, for the given five pairs of samples for the growth rate $r$ and carrying capacity $K$. The formula for the sample Pearson correlation coefficient between two variables $x$ and $y$ for a set of $n$ samples is:\n$$ \\rho_{x,y} = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}} $$\nIn our case, $x$ corresponds to the growth rate $r$, $y$ corresponds to the carrying capacity $K$, and the number of samples is $n=5$.\n\nFirst, we calculate the sample mean for $r$ and $K$.\nThe given samples for $r$ are $\\{0.55, 0.48, 0.51, 0.60, 0.45\\}$.\nThe sample mean of $r$ is:\n$$ \\bar{r} = \\frac{1}{5} \\sum_{i=1}^{5} r_i = \\frac{0.55 + 0.48 + 0.51 + 0.60 + 0.45}{5} = \\frac{2.59}{5} = 0.518 $$\n\nThe given samples for $K$ are $\\{980, 1050, 1010, 950, 1100\\}$.\nThe sample mean of $K$ is:\n$$ \\bar{K} = \\frac{1}{5} \\sum_{i=1}^{5} K_i = \\frac{980 + 1050 + 1010 + 950 + 1100}{5} = \\frac{5090}{5} = 1018 $$\n\nNext, we calculate the deviations from the mean for each sample, $(r_i - \\bar{r})$ and $(K_i - \\bar{K})$. We will also calculate the products of these deviations and the squares of these deviations.\n\nFor $i=1$:\n$r_1 - \\bar{r} = 0.55 - 0.518 = 0.032$\n$K_1 - \\bar{K} = 980 - 1018 = -38$\n$(r_1 - \\bar{r})(K_1 - \\bar{K}) = (0.032)(-38) = -1.216$\n$(r_1 - \\bar{r})^2 = (0.032)^2 = 0.001024$\n$(K_1 - \\bar{K})^2 = (-38)^2 = 1444$\n\nFor $i=2$:\n$r_2 - \\bar{r} = 0.48 - 0.518 = -0.038$\n$K_2 - \\bar{K} = 1050 - 1018 = 32$\n$(r_2 - \\bar{r})(K_2 - \\bar{K}) = (-0.038)(32) = -1.216$\n$(r_2 - \\bar{r})^2 = (-0.038)^2 = 0.001444$\n$(K_2 - \\bar{K})^2 = (32)^2 = 1024$\n\nFor $i=3$:\n$r_3 - \\bar{r} = 0.51 - 0.518 = -0.008$\n$K_3 - \\bar{K} = 1010 - 1018 = -8$\n$(r_3 - \\bar{r})(K_3 - \\bar{K}) = (-0.008)(-8) = 0.064$\n$(r_3 - \\bar{r})^2 = (-0.008)^2 = 0.000064$\n$(K_3 - \\bar{K})^2 = (-8)^2 = 64$\n\nFor $i=4$:\n$r_4 - \\bar{r} = 0.60 - 0.518 = 0.082$\n$K_4 - \\bar{K} = 950 - 1018 = -68$\n$(r_4 - \\bar{r})(K_4 - \\bar{K}) = (0.082)(-68) = -5.576$\n$(r_4 - \\bar{r})^2 = (0.082)^2 = 0.006724$\n$(K_4 - \\bar{K})^2 = (-68)^2 = 4624$\n\nFor $i=5$:\n$r_5 - \\bar{r} = 0.45 - 0.518 = -0.068$\n$K_5 - \\bar{K} = 1100 - 1018 = 82$\n$(r_5 - \\bar{r})(K_5 - \\bar{K}) = (-0.068)(82) = -5.576$\n$(r_5 - \\bar{r})^2 = (-0.068)^2 = 0.004624$\n$(K_5 - \\bar{K})^2 = (82)^2 = 6724$\n\nNow, we sum these quantities.\nThe numerator of the correlation coefficient is the sum of the products of deviations:\n$$ \\sum_{i=1}^{5} (r_i - \\bar{r})(K_i - \\bar{K}) = -1.216 - 1.216 + 0.064 - 5.576 - 5.576 = -13.52 $$\n\nThe terms in the denominator are the sums of the squared deviations:\n$$ \\sum_{i=1}^{5} (r_i - \\bar{r})^2 = 0.001024 + 0.001444 + 0.000064 + 0.006724 + 0.004624 = 0.01388 $$\n$$ \\sum_{i=1}^{5} (K_i - \\bar{K})^2 = 1444 + 1024 + 64 + 4624 + 6724 = 13880 $$\n\nNow, substitute these sums back into the correlation coefficient formula:\n$$ \\rho_{r,K} = \\frac{-13.52}{\\sqrt{0.01388 \\times 13880}} $$\n$$ \\rho_{r,K} = \\frac{-13.52}{\\sqrt{192.6544}} $$\n$$ \\rho_{r,K} = \\frac{-13.52}{13.8800144} \\approx -0.97406243... $$\n\nRounding the result to three significant figures, we get -0.974. The strong negative correlation suggests that, in this model and with this data, higher estimates of the growth rate $r$ are associated with lower estimates of the carrying capacity $K$, and vice-versa.", "answer": "$$\\boxed{-0.974}$$", "id": "1444240"}, {"introduction": "Inferring a model's parameters is useful only if the model itself is a credible description of the biological system. The posterior predictive check is a cornerstone of Bayesian model validation, allowing us to ask, \"Could my model have generated the data I actually observed?\" In this exercise, you will use parameter samples drawn from a posterior distribution to simulate new growth curves, providing a hands-on experience with this essential technique for assessing a model's adequacy and building confidence in your conclusions. [@problem_id:1444232]", "problem": "A systems biologist is studying the growth dynamics of a bacterial culture. The population size, $N(t)$, measured in thousands of cells, is hypothesized to follow a logistic growth model. The analytical solution to the logistic differential equation is given by:\n$$N(t) = \\frac{K N_0}{N_0 + (K - N_0) \\exp(-rt)}$$\nwhere $t$ is the time in hours, $N_0$ is the initial population size, $r$ is the intrinsic growth rate (in units of $\\text{hour}^{-1}$), and $K$ is the carrying capacity of the environment (in thousands of cells).\n\nThe experiment was started with an initial population of $N_0 = 10$ thousand cells. The population size was measured at several time points, yielding the following experimental data:\n\n| Time, $t$ (hours) | Population, $N(t)$ (thousands of cells) |\n|:-----------------:|:---------------------------------------:|\n| 10                | 70                                      |\n| 20                | 260                                     |\n| 30                | 510                                     |\n| 40                | 580                                     |\n\nTo infer the model parameters $r$ and $K$, the biologist performed a Bayesian analysis using a Markov Chain Monte Carlo (MCMC) algorithm. This process generated a posterior distribution representing the plausible values for $r$ and $K$ given the data. Below are three representative samples drawn from this MCMC posterior distribution:\n\n*   Sample 1: $(r_1, K_1) = (0.19 \\text{ hour}^{-1}, 610 \\text{ thousand cells})$\n*   Sample 2: $(r_2, K_2) = (0.21 \\text{ hour}^{-1}, 590 \\text{ thousand cells})$\n*   Sample 3: $(r_3, K_3) = (0.22 \\text{ hour}^{-1}, 580 \\text{ thousand cells})$\n\nYour task is to perform a posterior predictive check. This involves using the parameter samples from the posterior to simulate new growth curves and comparing them to the original experimental data. Based on your analysis, which of the following statements provides the most accurate assessment of the logistic growth model's adequacy for this dataset?\n\nA. The model provides a good fit. The observed data points are systematically captured within the range of trajectories simulated from the posterior distribution. This indicates that the model is flexible enough to explain the data, and the inferred parameters are consistent with the observations.\n\nB. The model is systematically biased and thus a poor fit. For instance, at $t=20$ hours, all simulated trajectories predict a population size greater than the observed data point of 260. This consistent discrepancy suggests the model cannot fully replicate the observed dynamics.\n\nC. The model is overfitting the data. The fact that the trajectory from Sample 1 almost perfectly matches the data points indicates that the MCMC procedure has found a single 'best' solution, ignoring the true uncertainty in the system.\n\nD. The posterior parameter samples are too varied, making the model non-predictive. The wide spread of the simulated trajectories indicates that the parameters $r$ and $K$ are not well-constrained by the data, and therefore the model cannot be used for reliable predictions.", "solution": "We are given the logistic solution\n$$\nN(t)=\\frac{K N_{0}}{N_{0}+(K-N_{0})\\exp(-r t)},\n$$\nwith $N_{0}=10$. For each posterior sample $(r_{i},K_{i})$, define the predictive trajectory\n$$\nN_{i}(t)=\\frac{K_{i} N_{0}}{N_{0}+(K_{i}-N_{0})\\exp(-r_{i} t)}.\n$$\nWe will compute $N_{i}(t)$ at $t\\in\\{10,20,30,40\\}$ and compare with the observed data $\\{70,260,510,580\\}$.\n\nSample 1: $(r_{1},K_{1})=(0.19,610)$.\nHere $K_{1}-N_{0}=600$ and $K_{1}N_{0}=6100$, so\n$$\nN_{1}(t)=\\frac{6100}{10+600\\exp(-0.19 t)}.\n$$\n- At $t=10$: $\\exp(-0.19\\cdot 10)=\\exp(-1.9)\\approx 0.149568$, denominator $\\approx 10+600\\cdot 0.149568=99.7408$, hence $N_{1}(10)\\approx 6100/99.7408\\approx 61.1$.\n- At $t=20$: $\\exp(-3.8)\\approx 0.022371$, denominator $\\approx 10+600\\cdot 0.022371=23.4226$, hence $N_{1}(20)\\approx 6100/23.4226\\approx 260.3$.\n- At $t=30$: $\\exp(-5.7)\\approx 0.003331$, denominator $\\approx 10+600\\cdot 0.003331=11.9986$, hence $N_{1}(30)\\approx 6100/11.9986\\approx 508.4$.\n- At $t=40$: $\\exp(-7.6)\\approx 0.000498$, denominator $\\approx 10+600\\cdot 0.000498=10.2988$, hence $N_{1}(40)\\approx 6100/10.2988\\approx 592.8$.\n\nSample 2: $(r_{2},K_{2})=(0.21,590)$.\nHere $K_{2}-N_{0}=580$ and $K_{2}N_{0}=5900$, so\n$$\nN_{2}(t)=\\frac{5900}{10+580\\exp(-0.21 t)}.\n$$\n- At $t=10$: $\\exp(-2.1)\\approx 0.122456$, denominator $\\approx 10+580\\cdot 0.122456=81.024$, hence $N_{2}(10)\\approx 5900/81.024\\approx 72.8$.\n- At $t=20$: $\\exp(-4.2)\\approx 0.014996$, denominator $\\approx 10+580\\cdot 0.014996=18.6977$, hence $N_{2}(20)\\approx 5900/18.6977\\approx 315.6$.\n- At $t=30$: $\\exp(-6.3)\\approx 0.001829$, denominator $\\approx 10+580\\cdot 0.001829=11.0608$, hence $N_{2}(30)\\approx 5900/11.0608\\approx 533.5$.\n- At $t=40$: $\\exp(-8.4)\\approx 0.000225$, denominator $\\approx 10+580\\cdot 0.000225=10.1305$, hence $N_{2}(40)\\approx 5900/10.1305\\approx 582.3$.\n\nSample 3: $(r_{3},K_{3})=(0.22,580)$.\nHere $K_{3}-N_{0}=570$ and $K_{3}N_{0}=5800$, so\n$$\nN_{3}(t)=\\frac{5800}{10+570\\exp(-0.22 t)}.\n$$\n- At $t=10$: $\\exp(-2.2)\\approx 0.110803$, denominator $\\approx 10+570\\cdot 0.110803=73.1577$, hence $N_{3}(10)\\approx 5800/73.1577\\approx 79.3$.\n- At $t=20$: $\\exp(-4.4)\\approx 0.012277$, denominator $\\approx 10+570\\cdot 0.012277=17.000$, hence $N_{3}(20)\\approx 5800/17.000\\approx 341.2$.\n- At $t=30$: $\\exp(-6.6)\\approx 0.001365$, denominator $\\approx 10+570\\cdot 0.001365=10.778$, hence $N_{3}(30)\\approx 5800/10.778\\approx 538.1$.\n- At $t=40$: $\\exp(-8.8)\\approx 0.000151$, denominator $\\approx 10+570\\cdot 0.000151=10.0859$, hence $N_{3}(40)\\approx 5800/10.0859\\approx 575.1$.\n\nComparison to observed data $(70,260,510,580)$ at $(10,20,30,40)$ hours:\n- At $t=10$: predictions are approximately $61.1$, $72.8$, $79.3$; the observed $70$ lies within this range.\n- At $t=20$: predictions are approximately $260.3$, $315.6$, $341.2$; the observed $260$ is at the lower edge, effectively within the range.\n- At $t=30$: predictions are approximately $508.4$, $533.5$, $538.1$; the observed $510$ lies within this range.\n- At $t=40$: predictions are approximately $592.8$, $582.3$, $575.1$; the observed $580$ lies within this range.\n\nTherefore, the posterior predictive trajectories based on the provided samples form an envelope that contains the observed data points across all time points. This supports the conclusion that the logistic model is adequate and captures the observed dynamics without systematic bias, without overfitting, and with a reasonably constrained posterior. Among the given statements, this corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1444232"}]}