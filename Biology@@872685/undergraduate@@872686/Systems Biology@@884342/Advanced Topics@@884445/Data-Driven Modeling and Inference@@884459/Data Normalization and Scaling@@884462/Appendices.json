{"hands_on_practices": [{"introduction": "Before applying any normalization algorithm, a crucial first step is to visually inspect your data for signs of systematic bias. This exercise simulates a common quality control check in proteomics, where you'll use summary statistics to assess whether entire sample distributions have shifted. Learning to identify such shifts, which often signal technical artifacts rather than true biological changes, is a foundational skill for deciding when and why normalization is necessary [@problem_id:1425847].", "problem": "A researcher in a systems biology lab is studying the effect of two new drug compounds on the proteome of a cancer cell line. The experiment involves four samples:\n- Sample A: Control cells (no drug treatment).\n- Sample B: Cells treated with Drug 1.\n- Sample C: Cells treated with Drug 2.\n- Sample D: A technical replicate of the Control cells.\n\nAfter performing a mass spectrometry analysis, the researcher obtains protein abundance data for thousands of proteins in each sample. A core assumption in this type of experiment is that the vast majority of proteins will not change their abundance level in response to the treatments, and thus the overall statistical distribution of protein abundances should be similar across all samples. Any systematic deviation is likely due to technical artifacts (e.g., variations in sample preparation or instrument sensitivity) that need to be corrected.\n\nTo perform an initial quality check, the researcher calculates the following summary statistics for the protein abundance distributions (in arbitrary fluorescence units) for each sample: Minimum, First Quartile (Q1), Median, Third Quartile (Q3), and Maximum.\n\n- **Sample A:** Min = 10.5, Q1 = 40.2, Median = 60.1, Q3 = 79.8, Max = 121.3\n- **Sample B:** Min = 50.1, Q1 = 80.5, Median = 100.2, Q3 = 120.6, Max = 160.4\n- **Sample C:** Min = 5.3, Q1 = 20.8, Median = 35.5, Q3 = 50.2, Max = 85.9\n- **Sample D:** Min = 11.2, Q1 = 41.1, Median = 61.3, Q3 = 80.7, Max = 125.0\n\nImagine creating a boxplot for each sample using these statistics. Based on the summary statistics and the core assumption of the experiment, which of the following is the most appropriate conclusion and subsequent course of action?\n\nA. The samples exhibit significant systematic shifts in their distributions, evidenced by the misaligned medians and quartiles. A data normalization step is required before comparing protein levels between samples.\n\nB. The large differences in medians between the treated samples (B and C) and the control (A) are likely due to the strong biological effects of the drugs. The data should be analyzed as is to capture these important changes.\n\nC. The primary issue is the presence of outliers, as suggested by the wide range between the minimum and maximum values in all samples. The data would be reliable after removing the most extreme high and low abundance proteins from each sample.\n\nD. Since the control sample (A) and its technical replicate (D) show very similar distributions, the measurement technique is reliable, and the data from all samples can be trusted for direct comparison without any adjustments.", "solution": "The core assumption states that the vast majority of proteins do not change abundance across conditions, so the overall distributions across samples should be aligned aside from random noise. This implies that, absent technical artifacts, summary distributional features such as quartiles and medians should be similar across samples.\n\nFirst, verify the technical replicate. Samples A and D show highly similar quartiles and medians, consistent with good reproducibility for the same condition. Compute the interquartile ranges (IQRs) to assess spread:\n$$\n\\mathrm{IQR}_{A}=Q3-Q1=79.8-40.2=39.6,\\quad \\mathrm{IQR}_{D}=80.7-41.1=39.6.\n$$\nThe medians are also close:\n$$\n\\mathrm{Median}_{A}=60.1,\\quad \\mathrm{Median}_{D}=61.3.\n$$\nThus, A and D align well, supporting measurement consistency for the control.\n\nNext, compare treated samples to the control. For Sample B:\n$$\n\\mathrm{IQR}_{B}=120.6-80.5=40.1\\approx \\mathrm{IQR}_{A},\n$$\nand for Sample C:\n$$\n\\mathrm{IQR}_{C}=50.2-20.8=29.4,\n$$\nwhich is somewhat smaller but still comparable. Crucially, the medians and quartiles of B and C are systematically shifted relative to A (and D). Compute the median shifts relative to A:\n$$\n\\Delta \\mathrm{Median}_{B-A}=100.2-60.1=40.1,\\quad \\Delta \\mathrm{Median}_{C-A}=35.5-60.1=-24.6.\n$$\nThe quartiles show similar shifts:\n$$\n\\Delta Q1_{B-A}=80.5-40.2=40.3,\\quad \\Delta Q3_{B-A}=120.6-79.8=40.8,\n$$\n$$\n\\Delta Q1_{C-A}=20.8-40.2=-19.4,\\quad \\Delta Q3_{C-A}=50.2-79.8=-29.6.\n$$\nThese approximately uniform offsets across quantiles indicate global, systematic shifts rather than localized changes affecting only a subset of proteins. Under the assumption that most proteins are unchanged biologically, such global shifts are more consistent with technical artifacts (for example, differences in sample loading, ionization efficiency, or instrument sensitivity) than genuine biological effects that would typically alter only a subset of proteins and not shift all quantiles coherently.\n\nOption B attributes the shifts to strong biological effects; however, a pervasive shift of the entire distribution in opposite directions for B and C contradicts the assumption that most proteins are unchanged and is characteristic of technical scaling/offset. Option C focuses on outliers, but the IQRs are similar for A, B, and D, and the principal discrepancy lies in location (medians and quartiles) rather than extreme values; thus, outlier removal does not address the root cause. Option D argues that because A and D agree, all samples are directly comparable; while A and D validate reproducibility for the control, the evident systematic shifts in B and C still necessitate correction to honor the core assumption.\n\nTherefore, the appropriate conclusion is that there are significant systematic shifts across samples requiring normalization (e.g., median-centering or quantile normalization) before comparing protein abundances between conditions.\n\nThe correct choice is A.", "answer": "$$\\boxed{A}$$", "id": "1425847"}, {"introduction": "One of the most common data transformation tasks is scaling, which adjusts the range of your data without changing the shape of its distribution. Min-max scaling, for example, is essential when preparing data for algorithms that are sensitive to the magnitude of input features. This practice provides a concrete, step-by-step calculation to help you master this fundamental technique and understand how to bring diverse measurements onto a common scale [@problem_id:1425867].", "problem": "In a systems biology experiment, the abundance of a specific protein is measured at five consecutive time points following a stimulus. The recorded abundance values, in arbitrary fluorescence units, are collected into a vector $x = [5, 10, 20, 25, 90]$. Before incorporating this data into a larger computational model, it is necessary to normalize it. You are tasked with performing min-max scaling to transform the data into the standardized range of $[-1, 1]$.\n\nThe general formula for min-max scaling a data point $x_i$ from an original dataset with minimum value $x_{\\min}$ and maximum value $x_{\\max}$ to a new range $[a, b]$ is:\n\n$$x'_{i} = a + \\frac{(x_i - x_{\\min})(b - a)}{x_{\\max} - x_{\\min}}$$\n\nCalculate the new vector $x'$ containing the scaled abundance values. Express your answer as a row vector of five exact fractions.", "solution": "We are given the data vector $x=[5, 10, 20, 25, 90]$ and asked to apply min-max scaling to the range $[-1, 1]$. The min-max formula is\n$$\nx'_{i} = a + \\frac{(x_i - x_{\\min})(b - a)}{x_{\\max} - x_{\\min}},\n$$\nwith $a=-1$, $b=1$, $x_{\\min}=5$, and $x_{\\max}=90$. Substituting these into the formula gives\n$$\nx'_{i} = -1 + \\frac{(x_i - 5)(1 - (-1))}{90 - 5} = -1 + \\frac{2(x_i - 5)}{85}.\n$$\nWe now compute each scaled value exactly:\n- For $x_{1}=5$: $x'_{1} = -1 + \\frac{2(5-5)}{85} = -1 + 0 = \\frac{-1}{1}$.\n- For $x_{2}=10$: $x'_{2} = -1 + \\frac{2(10-5)}{85} = -1 + \\frac{10}{85} = -1 + \\frac{2}{17} = \\frac{-15}{17}$.\n- For $x_{3}=20$: $x'_{3} = -1 + \\frac{2(20-5)}{85} = -1 + \\frac{30}{85} = -1 + \\frac{6}{17} = \\frac{-11}{17}$.\n- For $x_{4}=25$: $x'_{4} = -1 + \\frac{2(25-5)}{85} = -1 + \\frac{40}{85} = -1 + \\frac{8}{17} = \\frac{-9}{17}$.\n- For $x_{5}=90$: $x'_{5} = -1 + \\frac{2(90-5)}{85} = -1 + \\frac{170}{85} = -1 + 2 = \\frac{1}{1}$.\n\nThus, the scaled vector as exact fractions is\n$$\n\\begin{pmatrix}\n\\frac{-1}{1} & \\frac{-15}{17} & \\frac{-11}{17} & \\frac{-9}{17} & \\frac{1}{1}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{-1}{1} & \\frac{-15}{17} & \\frac{-11}{17} & \\frac{-9}{17} & \\frac{1}{1}\\end{pmatrix}}$$", "id": "1425867"}, {"introduction": "Normalization is a powerful tool, but it rests on critical assumptions that, if violated, can lead to incorrect conclusions. This exercise presents a cautionary tale where an improperly chosen reference gene creates the illusion of a significant biological effect where none exists. By working through the calculation yourself, you will gain a deeper appreciation for the importance of validating your normalization strategy and understanding its potential to create artifacts [@problem_id:1425895].", "problem": "A molecular biologist is investigating the effect of a new drug on a human cancer cell line. The goal is to determine if the drug alters the expression of a target gene, \"Gene X\". The experiment consists of two groups of cell cultures: a \"Control\" group that receives a placebo and a \"Treatment\" group that receives the drug.\n\nTo quantify gene expression, the biologist measures the abundance of messenger RNA (mRNA) transcripts for Gene X. As a standard practice for data normalization, the biologist also measures the expression of a gene believed to be a stable \"reference gene,\" called \"Gene R,\" which is not expected to change its expression level in response to the drug.\n\nAfter the experiment, the biologist obtains the following raw mRNA transcript counts (in arbitrary units) for three biological replicates in each group:\n\n| Group     | Replicate | Gene X (counts) | Gene R (counts) |\n|-----------|-----------|-----------------|-----------------|\n| Control   | 1         | 1260            | 310             |\n| Control   | 2         | 1240            | 290             |\n| Control   | 3         | 1250            | 300             |\n| Treatment | 1         | 1275            | 615             |\n| Treatment | 2         | 1225            | 585             |\n| Treatment | 3         | 1250            | 600             |\n\nThe normalization procedure chosen by the biologist is as follows:\n1. For each group (Control and Treatment), calculate the average expression level for both Gene X and Gene R across the three replicates.\n2. For each group, calculate the \"normalized expression\" of Gene X by dividing its average expression by the average expression of the reference Gene R.\n\nFinally, to determine the effect of the drug, the biologist calculates the fold-change by taking the ratio of the normalized expression of Gene X in the Treatment group to that in the Control group.\n\nBased on the data provided and the specified normalization procedure, calculate the apparent fold-change for Gene X. Report your answer as a single numerical value, rounded to three significant figures.", "solution": "The goal is to calculate the apparent fold-change of Gene X's expression, defined as the ratio of its normalized expression in the Treatment group to its normalized expression in the Control group.\n\nFirst, we calculate the average expression for each gene in each group.\n\nFor the Control group:\nThe raw counts for Gene X are 1260, 1240, and 1250.\nThe average expression of Gene X in the Control group, $\\langle X_{ctrl} \\rangle$, is:\n$$ \\langle X_{ctrl} \\rangle = \\frac{1260 + 1240 + 1250}{3} = \\frac{3750}{3} = 1250 $$\nThe raw counts for Gene R are 310, 290, and 300.\nThe average expression of Gene R in the Control group, $\\langle R_{ctrl} \\rangle$, is:\n$$ \\langle R_{ctrl} \\rangle = \\frac{310 + 290 + 300}{3} = \\frac{900}{3} = 300 $$\n\nFor the Treatment group:\nThe raw counts for Gene X are 1275, 1225, and 1250.\nThe average expression of Gene X in the Treatment group, $\\langle X_{treat} \\rangle$, is:\n$$ \\langle X_{treat} \\rangle = \\frac{1275 + 1225 + 1250}{3} = \\frac{3750}{3} = 1250 $$\nThe raw counts for Gene R are 615, 585, and 600.\nThe average expression of Gene R in the Treatment group, $\\langle R_{treat} \\rangle$, is:\n$$ \\langle R_{treat} \\rangle = \\frac{615 + 585 + 600}{3} = \\frac{1800}{3} = 600 $$\n\nNext, we perform the normalization for each group as specified. The normalized expression, $X_{norm}$, is calculated by dividing the average expression of Gene X by the average expression of Gene R.\n\nFor the Control group, the normalized expression of Gene X, $X_{norm, ctrl}$, is:\n$$ X_{norm, ctrl} = \\frac{\\langle X_{ctrl} \\rangle}{\\langle R_{ctrl} \\rangle} = \\frac{1250}{300} = \\frac{12.5}{3} \\approx 4.1667 $$\n\nFor the Treatment group, the normalized expression of Gene X, $X_{norm, treat}$, is:\n$$ X_{norm, treat} = \\frac{\\langle X_{treat} \\rangle}{\\langle R_{treat} \\rangle} = \\frac{1250}{600} = \\frac{12.5}{6} \\approx 2.0833 $$\n\nFinally, we calculate the apparent fold-change, which is the ratio of the normalized expression in the Treatment group to that in the Control group.\n\n$$ \\text{Fold-Change} = \\frac{X_{norm, treat}}{X_{norm, ctrl}} = \\frac{1250 / 600}{1250 / 300} = \\frac{1250}{600} \\times \\frac{300}{1250} = \\frac{300}{600} = 0.5 $$\n\nThe problem asks for the answer to be rounded to three significant figures.\n\n$$ \\text{Fold-Change} = 0.500 $$\n\nThis result suggests that the drug causes a 50% reduction in the expression of Gene X. However, a direct inspection of the raw data shows that the average expression of Gene X is identical in both groups (1250 units). The apparent change is an artifact created by the normalization procedure, because the \"reference\" Gene R was not stable and its expression doubled in the treatment group.", "answer": "$$\\boxed{0.500}$$", "id": "1425895"}]}