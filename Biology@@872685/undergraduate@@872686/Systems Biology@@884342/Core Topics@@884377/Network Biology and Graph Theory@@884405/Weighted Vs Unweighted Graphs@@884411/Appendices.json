{"hands_on_practices": [{"introduction": "The first step in analyzing a biological network is to translate it into a mathematical format. Adjacency matrices provide a fundamental way to represent the connections between nodes, but the level of detail they capture depends on whether the graph is weighted or unweighted. This exercise [@problem_id:1477790] will guide you through creating both representations for a simple signaling cascade, contrasting how a binary \"on/off\" connection differs from a quantitative measure of interaction strength.", "problem": "In systems biology, protein interaction networks are often represented as graphs. Consider a simple linear signaling cascade involving three proteins: P1, P2, and P3. In this cascade, protein P1 activates protein P2 through phosphorylation, and subsequently, protein P2 activates protein P3, also via phosphorylation. There are no other interactions, such as self-activation or reverse activation, among these three proteins.\n\nWe can model this system using two different graph representations:\n\n1.  An **unweighted, directed graph**, where an edge from protein $i$ to protein $j$ exists if and only if $i$ activates $j$.\n2.  A **weighted, directed graph**, where the weight of an edge from protein $i$ to protein $j$ represents the biochemical efficiency of the phosphorylation event. The efficiency of P1 activating P2 is $0.85$, and the efficiency of P2 activating P3 is $0.60$. An edge weight of zero implies no interaction.\n\nYour task is to determine the adjacency matrices for both representations. Let the unweighted adjacency matrix be $A_U$ and the weighted adjacency matrix be $A_W$. For both matrices, the rows and columns should correspond to the proteins in the order (P1, P2, P3). In an adjacency matrix for a directed graph, the entry in row $i$ and column $j$ represents the connection from node $i$ to node $j$.\n\nWhich of the following options correctly provides the pair of adjacency matrices $(A_U, A_W)$?\n\nA. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0.85 & 0 & 0.60 \\\\ 0 & 0.60 & 0 \\end{pmatrix}$\n\nB. $A_U = \\begin{pmatrix} 0 & 0 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0.85 & 0 & 0 \\\\ 0 & 0.60 & 0 \\end{pmatrix}$\n\nC. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0 & 0 & 0.60 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n\nD. $A_U = \\begin{pmatrix} 0 & 0.85 & 0 \\\\ 0 & 0 & 0.60 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n\nE. $A_U = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 0 & 0 \\end{pmatrix}, A_W = \\begin{pmatrix} 0 & 0.60 & 0 \\\\ 0 & 0 & 0.85 \\\\ 0 & 0 & 0 \\end{pmatrix}$", "solution": "In a directed adjacency matrix with node order $(\\text{P1}, \\text{P2}, \\text{P3})$, the entry $A_{ij}$ represents an edge from node $i$ to node $j$. For the unweighted case, $A_{ij}=1$ if there is an activation from $i$ to $j$, and $A_{ij}=0$ otherwise. For the weighted case, $A_{ij}$ equals the given efficiency for the activation from $i$ to $j$, and $A_{ij}=0$ if there is no interaction.\n\nThe signaling cascade specifies exactly two directed edges: $\\text{P1} \\rightarrow \\text{P2}$ and $\\text{P2} \\rightarrow \\text{P3}$, with no other interactions. Therefore, the unweighted adjacency matrix must have ones at positions $(1,2)$ and $(2,3)$ and zeros elsewhere:\n$$\nA_{U}=\\begin{pmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\nThe weighted adjacency matrix uses the given efficiencies, $0.85$ for $\\text{P1} \\rightarrow \\text{P2}$ and $0.60$ for $\\text{P2} \\rightarrow \\text{P3}$, at the same positions:\n$$\nA_{W}=\\begin{pmatrix}\n0 & 0.85 & 0 \\\\\n0 & 0 & 0.60 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\nComparing with the options, this pair matches option C exactly. Other options either include reverse or extra edges, swap weights, or swap the weighted and unweighted matrices.", "answer": "$$\\boxed{C}$$", "id": "1477790"}, {"introduction": "While weighted networks contain rich quantitative information, researchers often simplify them by applying a threshold to create an unweighted graph, making topological analysis easier. However, this simplification comes at a cost. This practice problem [@problem_id:1477778] asks you to critically evaluate the consequences of this common procedure, identifying the specific types of biological information that are permanently lost when converting a weighted gene co-expression network into a binary one.", "problem": "In systems biology, gene co-expression networks are used to infer functional relationships between genes based on their expression patterns across different conditions or samples. A common approach is to construct a weighted network where the nodes represent genes and the weight of the edge between any two genes is given by the Pearson correlation coefficient ($r$) calculated from their expression levels. The value of $r$ can range from -1 (perfect anti-correlation) to +1 (perfect positive correlation), with 0 indicating no linear correlation.\n\nA researcher has constructed such a weighted network. To focus on the strongest relationships and simplify the network's topology, the researcher decides to convert it into an unweighted (binary) network. This is done by applying a hard threshold: an edge is created between two genes if and only if the absolute value of their Pearson correlation coefficient, $|r|$, is greater than a threshold value of $T = 0.75$. If $|r| \\leq 0.75$, no edge is present.\n\nWhich of the following statements correctly describe the types of information that are irrecoverably lost when transitioning from the original weighted network to the new unweighted network? Select all that apply.\n\nA. The distinction between positive correlations (co-expression) and negative correlations (antagonistic regulation) for the gene pairs that remain connected.\n\nB. The total number of genes that were included in the initial analysis.\n\nC. The relative strength of the associations for gene pairs whose correlation $|r|$ is below the threshold $T$ (e.g., the ability to distinguish a pair with $r=0.5$ from a pair with $r=0.1$).\n\nD. The knowledge of whether a specific gene pair with a correlation of $r = -0.82$ is connected in the network.\n\nE. The ability to rank the connected gene pairs by their original correlation strength (e.g., to know that a pair with $|r|=0.98$ was more strongly correlated than a pair with $|r|=0.78$).", "solution": "Let there be genes indexed by $i,j$ and let the original weighted network assign each pair a Pearson correlation $r_{ij} \\in [-1,1]$. The thresholding creates an unweighted adjacency defined by\n$$\na_{ij}=\\begin{cases}\n1, & |r_{ij}|>T,\\\\\n0, & |r_{ij}|\\leq T,\n\\end{cases}\n$$\nwith $T=0.75$. This mapping depends only on $|r_{ij}|$ and collapses all values above $T$ to $1$ and all values at or below $T$ to $0$.\n\nEvaluate each statement in terms of information lost under the many-to-one mapping $r_{ij}\\mapsto a_{ij}$:\n\nA. For pairs with $a_{ij}=1$, the sign $\\operatorname{sgn}(r_{ij})$ is not encoded because $a_{ij}$ depends only on $|r_{ij}|$. For example, $r_{ij}=0.80$ and $r_{ij}=-0.80$ both yield $a_{ij}=1$. Hence the distinction between positive and negative correlations among connected pairs is irrecoverably lost. A is correct.\n\nB. The number of genes equals the number of nodes, which is unchanged by edge thresholding. Nodes are not removed by the stated operation; isolated nodes may appear but the node count remains the same. Therefore the total number of genes is not lost. B is incorrect.\n\nC. For pairs with $a_{ij}=0$, the original $r_{ij}$ could be any value in the interval $[-T,T]$. Distinctions such as $r_{ij}=0.50$ versus $r_{ij}=0.10$ are collapsed to the same binary outcome $a_{ij}=0$ and cannot be recovered. C is correct.\n\nD. For a pair with $r=-0.82$, since $|r|=0.82>T$, the unweighted network will have $a=1$ for that pair. The presence of this edge is preserved in the thresholded network; thus this information is not lost. D is incorrect.\n\nE. Among pairs with $a_{ij}=1$, the original values $|r_{ij}|$ lie in $(T,1]$, but all such values map to the same binary state. Therefore it is impossible to rank connected pairs by their original correlation strengths using only $a_{ij}$. E is correct.\n\nThus, the irrecoverably lost information comprises A, C, and E.", "answer": "$$\\boxed{ACE}$$", "id": "1477778"}, {"introduction": "The true power of weighted graphs lies in their ability to support more sophisticated and realistic models of biological dynamics. By incorporating quantitative data as edge weights, we can move from simple connectivity maps to predictive models of system behavior. This advanced problem [@problem_id:1477791] challenges you to model a signaling pathway as a random walk, calculating how the predicted signal propagation time differs dramatically when using a simple unweighted model versus a weighted model informed by biochemical rate constants.", "problem": "A systems biologist is developing a computational model for an intracellular signaling pathway. The pathway can be simplified into a directed graph of four interacting proteins: a receptor (Node 1), two intermediate kinases (Node 2 and Node 3), and a target transcription factor (Node 4). The flow of the signal is represented by the following connections: from Node 1 to Node 2 and Node 3; from Node 2 to Node 3 and Node 4; and from Node 3 to Node 2 and Node 4.\n\nThe signaling process is modeled as a discrete-time random walk, where a signal packet originates at the receptor (Node 1) at time $t=0$. The process concludes when the signal first reaches the transcription factor (Node 4), which acts as an absorbing state. The biologist wants to compare two different models for the signal's propagation and quantify their disagreement.\n\n**Model A (Unweighted):** This is a naive model where the signal, at any given node, transitions to one of its connected downstream neighbors with equal probability.\n\n**Model B (Weighted):** This model incorporates biochemical kinetics. The probability of a signal transitioning from a node $u$ to a neighboring downstream node $v$ is proportional to the catalytic activity of the protein at node $v$. The activity is characterized by a rate constant $k_v$. The transition probability is thus given by $P_{u \\to v} = k_v / \\sum_{w \\in N(u)} k_w$, where $N(u)$ is the set of all downstream neighbors of $u$. For this pathway, the rate constants are given as: $k_2 = k$, $k_3 = 3k$, and $k_4 = 2k$ for some base rate $k$.\n\nYour task is to analyze the predictive divergence of these two models. Calculate the ratio $\\mathcal{R} = \\frac{\\langle T_{1 \\to 4} \\rangle_{\\text{A}}}{\\langle T_{1 \\to 4} \\rangle_{\\text{B}}}$, where $\\langle T_{1 \\to 4} \\rangle_{\\text{A}}$ and $\\langle T_{1 \\to 4} \\rangle_{\\text{B}}$ are the Mean First Passage Times (MFPT) for the signal to travel from Node 1 to Node 4 under Model A and Model B, respectively. Present your answer as an exact fraction.", "solution": "The problem asks for the ratio of the Mean First Passage Times (MFPT) from Node 1 to Node 4 for two different models of a random walk on a directed graph. Let $T_i$ denote the MFPT to reach the target Node 4, starting from Node $i$. By definition, the MFPT from the target node to itself is zero, so $T_4 = 0$.\n\nFor any non-target node $i$, the MFPT can be expressed as one plus the average of the MFPTs from its neighboring nodes, weighted by the transition probabilities. The general formula is:\n$$T_i = 1 + \\sum_{j \\in N(i)} P_{i \\to j} T_j$$\nwhere $N(i)$ is the set of downstream neighbors of node $i$ and $P_{i \\to j}$ is the probability of transitioning from node $i$ to node $j$.\n\nThe graph structure is as follows:\n- Node 1 has neighbors $N(1) = \\{2, 3\\}$.\n- Node 2 has neighbors $N(2) = \\{3, 4\\}$.\n- Node 3 has neighbors $N(3) = \\{2, 4\\}$.\n- Node 4 is the absorbing target.\n\nWe need to find $T_1$. To do this, we set up a system of linear equations for $T_1, T_2, T_3$:\n1.  $T_1 = 1 + P_{1 \\to 2} T_2 + P_{1 \\to 3} T_3$\n2.  $T_2 = 1 + P_{2 \\to 3} T_3 + P_{2 \\to 4} T_4 = 1 + P_{2 \\to 3} T_3$ (since $T_4=0$)\n3.  $T_3 = 1 + P_{3 \\to 2} T_2 + P_{3 \\to 4} T_4 = 1 + P_{3 \\to 2} T_2$ (since $T_4=0$)\n\nNow we solve this system for each model.\n\n**Model A: Unweighted Graph**\n\nIn this model, transitions to neighbors are equiprobable.\n- From Node 1 (2 neighbors): $P_{1 \\to 2} = 1/2$, $P_{1 \\to 3} = 1/2$.\n- From Node 2 (2 neighbors): $P_{2 \\to 3} = 1/2$, $P_{2 \\to 4} = 1/2$.\n- From Node 3 (2 neighbors): $P_{3 \\to 2} = 1/2$, $P_{3 \\to 4} = 1/2$.\n\nSubstituting these probabilities into the system of equations:\n2.  $T_2 = 1 + \\frac{1}{2} T_3$\n3.  $T_3 = 1 + \\frac{1}{2} T_2$\n\nThis is a system of two linear equations for $T_2$ and $T_3$. We substitute equation (3) into (2):\n$T_2 = 1 + \\frac{1}{2} \\left(1 + \\frac{1}{2} T_2\\right) = 1 + \\frac{1}{2} + \\frac{1}{4} T_2 = \\frac{3}{2} + \\frac{1}{4} T_2$\n$T_2 - \\frac{1}{4} T_2 = \\frac{3}{2} \\implies \\frac{3}{4} T_2 = \\frac{3}{2} \\implies T_2 = 2$.\n\nNow, we find $T_3$ using equation (3):\n$T_3 = 1 + \\frac{1}{2}(2) = 1 + 1 = 2$.\n\nFinally, we calculate $T_1$ using equation (1):\n$T_1 = 1 + \\frac{1}{2} T_2 + \\frac{1}{2} T_3 = 1 + \\frac{1}{2}(2) + \\frac{1}{2}(2) = 1 + 1 + 1 = 3$.\nSo, for Model A, $\\langle T_{1 \\to 4} \\rangle_{\\text{A}} = 3$.\n\n**Model B: Weighted Graph**\n\nThe transition probabilities $P_{u \\to v}$ are proportional to the rate constant $k_v$ of the target node. We are given $k_2=k$, $k_3=3k$, and $k_4=2k$.\n- From Node 1 ($N(1) = \\{2, 3\\}$): The normalization factor is $\\sum_{w \\in N(1)} k_w = k_2 + k_3 = k + 3k = 4k$.\n  $P_{1 \\to 2} = \\frac{k_2}{4k} = \\frac{k}{4k} = \\frac{1}{4}$.\n  $P_{1 \\to 3} = \\frac{k_3}{4k} = \\frac{3k}{4k} = \\frac{3}{4}$.\n\n- From Node 2 ($N(2) = \\{3, 4\\}$): The normalization factor is $\\sum_{w \\in N(2)} k_w = k_3 + k_4 = 3k + 2k = 5k$.\n  $P_{2 \\to 3} = \\frac{k_3}{5k} = \\frac{3k}{5k} = \\frac{3}{5}$.\n  $P_{2 \\to 4} = \\frac{k_4}{5k} = \\frac{2k}{5k} = \\frac{2}{5}$.\n\n- From Node 3 ($N(3) = \\{2, 4\\}$): The normalization factor is $\\sum_{w \\in N(3)} k_w = k_2 + k_4 = k + 2k = 3k$.\n  $P_{3 \\to 2} = \\frac{k_2}{3k} = \\frac{k}{3k} = \\frac{1}{3}$.\n  $P_{3 \\to 4} = \\frac{k_4}{3k} = \\frac{2k}{3k} = \\frac{2}{3}$.\n\nNow, we substitute these probabilities into our general system of equations:\n2.  $T_2 = 1 + P_{2 \\to 3} T_3 = 1 + \\frac{3}{5} T_3$\n3.  $T_3 = 1 + P_{3 \\to 2} T_2 = 1 + \\frac{1}{3} T_2$\n\nWe solve this new system for $T_2$ and $T_3$. Substitute (3) into (2):\n$T_2 = 1 + \\frac{3}{5} \\left(1 + \\frac{1}{3} T_2\\right) = 1 + \\frac{3}{5} + \\frac{1}{5} T_2 = \\frac{8}{5} + \\frac{1}{5} T_2$\n$T_2 - \\frac{1}{5} T_2 = \\frac{8}{5} \\implies \\frac{4}{5} T_2 = \\frac{8}{5} \\implies T_2 = 2$.\n\nUsing this value in equation (3) to find $T_3$:\n$T_3 = 1 + \\frac{1}{3}(2) = 1 + \\frac{2}{3} = \\frac{5}{3}$.\n\nFinally, we calculate $T_1$ for Model B using equation (1):\n$T_1 = 1 + P_{1 \\to 2} T_2 + P_{1 \\to 3} T_3 = 1 + \\frac{1}{4}(2) + \\frac{3}{4}\\left(\\frac{5}{3}\\right)$\n$T_1 = 1 + \\frac{2}{4} + \\frac{15}{12} = 1 + \\frac{1}{2} + \\frac{5}{4}$\n$T_1 = \\frac{4}{4} + \\frac{2}{4} + \\frac{5}{4} = \\frac{11}{4}$.\nSo, for Model B, $\\langle T_{1 \\to 4} \\rangle_{\\text{B}} = \\frac{11}{4}$.\n\n**Calculate the Ratio $\\mathcal{R}$**\n\nThe final step is to compute the ratio of the two MFPTs:\n$\\mathcal{R} = \\frac{\\langle T_{1 \\to 4} \\rangle_{\\text{A}}}{\\langle T_{1 \\to 4} \\rangle_{\\text{B}}} = \\frac{3}{\\frac{11}{4}} = 3 \\times \\frac{4}{11} = \\frac{12}{11}$.", "answer": "$$\\boxed{\\frac{12}{11}}$$", "id": "1477791"}]}