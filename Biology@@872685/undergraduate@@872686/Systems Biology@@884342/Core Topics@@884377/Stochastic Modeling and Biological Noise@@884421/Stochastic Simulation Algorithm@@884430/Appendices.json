{"hands_on_practices": [{"introduction": "The core of the Stochastic Simulation Algorithm lies in the concept of the propensity function, which quantifies the instantaneous probability rate of a given reaction. This exercise provides foundational practice in calculating propensities for a simple yet fundamental gene expression model, involving the production and degradation of mRNA. Mastering this step is essential, as the total propensity of the system determines the timing of the next molecular event [@problem_id:1468248].", "problem": "Consider a simplified stochastic model for the expression of a single gene within a cell. The model focuses on the number of molecules of a specific messenger Ribonucleic Acid (mRNA), denoted by $M$. Two reactions govern the dynamics of the mRNA population:\n\n1.  **Transcription**: An mRNA molecule is produced. This is a zeroth-order reaction of the form $\\emptyset \\rightarrow M$, which occurs with a constant propensity.\n2.  **Degradation**: An existing mRNA molecule is degraded. This is a first-order reaction of the form $M \\rightarrow \\emptyset$, with a stochastic rate constant.\n\nThe propensity of a reaction represents its instantaneous probability rate. At a particular moment, the state of the system is defined by the number of mRNA molecules, $n_M$.\n\nGiven the following parameters:\n- Constant production propensity: $k_p = 10.5 \\text{ s}^{-1}$\n- Degradation rate constant: $k_d = 0.12 \\text{ s}^{-1}$\n- Current number of mRNA molecules: $n_M = 150$\n\nCalculate the total propensity, $a_0$, of the system at this moment. The total propensity is a key quantity in stochastic simulation algorithms as it determines the time until the next reaction event. Express your answer in units of $\\text{s}^{-1}$, rounded to three significant figures.", "solution": "In the stochastic chemical kinetics framework (Gillespie), the propensity of each reaction is the instantaneous rate at which it occurs given the current state.\n\n- For the zeroth-order transcription reaction $\\emptyset \\rightarrow M$, the propensity is constant:\n$$\na_{\\text{prod}} = k_{p}.\n$$\n\n- For the first-order degradation reaction $M \\rightarrow \\emptyset$, the propensity is proportional to the current molecule count:\n$$\na_{\\text{deg}} = k_{d}\\, n_{M}.\n$$\n\nThe total propensity is the sum of all reaction propensities:\n$$\na_{0} = a_{\\text{prod}} + a_{\\text{deg}} = k_{p} + k_{d}\\, n_{M}.\n$$\n\nSubstituting the given values $k_{p} = 10.5\\,\\text{s}^{-1}$, $k_{d} = 0.12\\,\\text{s}^{-1}$, and $n_{M} = 150$, we obtain\n$$\na_{0} = 10.5 + 0.12 \\times 150 = 10.5 + 18.0 = 28.5.\n$$\n\nThus, the total propensity is $28.5\\,\\text{s}^{-1}$, which to three significant figures is $28.5$.", "answer": "$$\\boxed{28.5}$$", "id": "1468248"}, {"introduction": "After determining the propensity of every possible reaction, the next crucial step in the SSA is to probabilistically select which event will occur next. This practice delves into this selection process by modeling a common scenario in cell signaling: two enzymes competing for the same substrate. By calculating the probability of one reaction channel being chosen over another, you will gain a deeper understanding of how the algorithm simulates competition and choice at the molecular level [@problem_id:1468285].", "problem": "A cell contains a signaling protein $P$ that can be activated through phosphorylation. This phosphorylation can be catalyzed by two distinct enzymes, Kinase A ($K_A$) and Kinase B ($K_B$). The system is well-mixed and can be modeled by the following two elementary chemical reactions:\n\n1.  $P + K_A \\xrightarrow{c_A} P^* + K_A$\n2.  $P + K_B \\xrightarrow{c_B} P^* + K_B$\n\nHere, $P^*$ represents the phosphorylated (active) form of the protein. The reactions proceed with second-order rate constants $c_A$ and $c_B$, respectively. These constants encapsulate information about the reaction rate per pair of reactant molecules.\n\nAt a particular instant, the system contains $n_P$ molecules of the substrate protein $P$, $n_A$ molecules of Kinase A, and $n_B$ molecules of Kinase B.\n\nAssuming a stochastic description of these reactions, determine the probability that the very next reaction to occur in the system is the phosphorylation of a molecule of $P$ by a molecule of $K_A$. Express your answer as a symbolic expression in terms of $c_A$, $c_B$, $n_A$, and $n_B$.", "solution": "We adopt the stochastic chemical kinetics (Gillespie) framework. For an elementary bimolecular reaction between two distinct species $X$ and $Y$ with second-order rate constant $c$, the propensity function is the product of $c$ and the number of distinct reactant pairs, which is $n_{X}n_{Y}$. Therefore, the propensities of the two reaction channels are\n$$\na_{A}=c_{A}\\,n_{P}\\,n_{A},\\qquad a_{B}=c_{B}\\,n_{P}\\,n_{B}.\n$$\nThe total propensity is\n$$\na_{0}=a_{A}+a_{B}=c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}.\n$$\nBy the Gillespie theory, the probability that the next reaction to occur is a given channel equals that channelâ€™s propensity divided by the total propensity. Hence, the probability that the next reaction is phosphorylation by $K_{A}$ is\n$$\n\\frac{a_{A}}{a_{0}}=\\frac{c_{A}\\,n_{P}\\,n_{A}}{c_{A}\\,n_{P}\\,n_{A}+c_{B}\\,n_{P}\\,n_{B}}.\n$$\nFactoring out $n_{P}$ from numerator and denominator (assuming $n_{P}>0$ so that a reaction can occur) yields\n$$\n\\frac{c_{A}\\,n_{A}}{c_{A}\\,n_{A}+c_{B}\\,n_{B}}.\n$$\nThis expression depends only on $c_{A}$, $c_{B}$, $n_{A}$, and $n_{B}$, as required.", "answer": "$$\\boxed{\\frac{c_{A}n_{A}}{c_{A}n_{A}+c_{B}n_{B}}}$$", "id": "1468285"}, {"introduction": "Many biological processes, like protein maturation or signal transduction across compartments, are not instantaneous and involve inherent time delays. The standard SSA must be modified to accurately capture these dynamics. This advanced exercise challenges you to simulate a system with a delayed reaction, requiring you to manage a schedule of future events alongside the standard probabilistic selection of immediate reactions, a vital technique for building more sophisticated and realistic biological models [@problem_id:1468236].", "problem": "Consider a simplified model for the synthesis of a viral protein within a host cell. The system involves three species: a constant number of viral genomes ($S_1$), a precursor protein ($S_2$), and a mature, functional protein ($S_3$). The chemical reaction network is described by the following reactions:\n\n1.  **Transcription/Translation (R1):** $S_1 \\xrightarrow{c_1} S_2$. The precursor protein $S_2$ is produced at a constant rate. The propensity (hazard) of this reaction is $a_1 = c_1$.\n2.  **Maturation (R2):** $S_2 \\xrightarrow{k_2} S_3$. The precursor $S_2$ undergoes a conformational change to become the mature protein $S_3$. This process is not instantaneous; it has a fixed time delay of $\\tau$. When this reaction is selected to occur at time $t$, a molecule of $S_2$ is consumed immediately, but the corresponding molecule of $S_3$ appears only at time $t+\\tau$. The propensity for initiating this reaction is $a_2 = k_2 N_2$, where $N_2$ is the number of molecules of $S_2$.\n3.  **Degradation of Precursor (R3):** $S_2 \\xrightarrow{k_3} \\emptyset$. The precursor protein is degraded. The propensity is $a_3 = k_3 N_2$.\n4.  **Degradation of Mature Protein (R4):** $S_3 \\xrightarrow{k_4} \\emptyset$. The mature protein is degraded. The propensity is $a_4 = k_4 N_3$, where $N_3$ is the number of molecules of $S_3$.\n\nTo simulate this system, one must use a modification of the standard Stochastic Simulation Algorithm (SSA) to account for the time delay. An \"event\" is defined as any discrete change in the number of molecules in the system. This includes the firing of an instantaneous reaction (R1, R3, R4) as well as the completion (i.e., production of products) of a delayed reaction (R2).\n\nYou are given the following parameters and initial conditions:\n-   Initial time: $t=0$.\n-   Initial molecule counts: $N_2(0) = 0$, $N_3(0) = 0$.\n-   Rate constants: $c_1 = 10.0 \\text{ s}^{-1}$, $k_2 = 0.5 \\text{ s}^{-1}$, $k_3 = 0.2 \\text{ s}^{-1}$, $k_4 = 1.0 \\text{ s}^{-1}$.\n-   Time delay: $\\tau = 0.2 \\text{ s}$.\n\nYou are to perform a simulation for exactly **three** consecutive events, starting from $t=0$. The sequence of uniform random number pairs $(r_1, r_2)$ used to determine the time to the next reaction and the reaction index, respectively, is given as:\n-   For event 1: $(0.50, 0.40)$\n-   For event 2: $(0.30, 0.95)$\n-   For subsequent calculations if needed: $(0.10, 0.50)$\n\nDetermine the state of the system after these three events have occurred. Your answer should be the final number of molecules of the precursor protein ($N_2$), the final number of molecules of the mature protein ($N_3$), and the final time ($t$). Express the final time in seconds, rounded to four significant figures.", "solution": "We apply a delayed-reaction SSA. The instantaneous reaction waiting time is drawn by\n$$\n\\Delta t=\\frac{1}{a_{0}}\\ln\\!\\left(\\frac{1}{r_{1}}\\right),\n$$\nwith $a_{0}=a_{1}+a_{2}+a_{3}+a_{4}$, and the reaction index is chosen by finding the smallest $j$ such that $\\sum_{i=1}^{j}a_{i}\\geq r_{2}a_{0}$. For the delayed reaction R2, when it initiates at time $t$, one $S_{2}$ is consumed immediately and a completion event (adding one $S_{3}$) is scheduled at $t+\\tau$. The next event is always the earliest among an instantaneous reaction firing and the earliest scheduled completion.\n\nAt $t=0$, $N_{2}=0$, $N_{3}=0$. Hence $a_{1}=c_{1}$, $a_{2}=k_{2}N_{2}$, $a_{3}=k_{3}N_{2}$, $a_{4}=k_{4}N_{3}$.\n\nEvent 1 using $(r_{1},r_{2})=(0.50,0.40)$:\n- Initial propensities: $a_{1}=c_{1}=10$, $a_{2}=k_{2}N_{2}=0$, $a_{3}=k_{3}N_{2}=0$, $a_{4}=k_{4}N_{3}=0$, so $a_{0}=10$.\n- Time increment: \n$$\n\\Delta t_{1}=\\frac{1}{10}\\ln\\!\\left(\\frac{1}{0.50}\\right)=\\frac{\\ln 2}{10}.\n$$\n- Reaction choice: $r_{2}a_{0}=0.40\\times 10=4$. The cumulative sums are $a_{1}=10$, so R1 fires.\n- Update at $t_{1}=\\frac{\\ln 2}{10}$: $N_{2}\\to 1$, $N_{3}\\to 0$. No delayed completion is scheduled.\n\nEvent 2 using $(r_{1},r_{2})=(0.30,0.95)$:\n- Current propensities with $N_{2}=1$, $N_{3}=0$: $a_{1}=10$, $a_{2}=k_{2}N_{2}=0.5$, $a_{3}=k_{3}N_{2}=0.2$, $a_{4}=0$, so $a_{0}=10.7$.\n- Time increment:\n$$\n\\Delta t_{2}=\\frac{1}{10.7}\\ln\\!\\left(\\frac{1}{0.30}\\right)=\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right).\n$$\n- Reaction choice: $r_{2}a_{0}=0.95\\times 10.7=10.165$. Cumulative sums: $a_{1}=10<10.165$, $a_{1}+a_{2}=10.5>10.165$, hence R2 initiates.\n- Update at $t_{2}=t_{1}+\\Delta t_{2}=\\frac{\\ln 2}{10}+\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right)$: consume one $S_{2}$ so $N_{2}\\to 0$, $N_{3}\\to 0$. Schedule a completion at \n$$\nt_{\\text{comp}}=t_{2}+\\tau=\\frac{\\ln 2}{10}+\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right)+0.2.\n$$\n\nEvent 3: Compare the time to the next instantaneous reaction with the scheduled completion at $t_{\\text{comp}}$.\n- After event 2, $N_{2}=0$, $N_{3}=0$, so $a_{1}=10$, $a_{2}=0$, $a_{3}=0$, $a_{4}=0$, $a_{0}=10$. The candidate instantaneous-reaction increment from $t_{2}$ using the next pair $(r_{1},r_{2})=(0.10,0.50)$ would be\n$$\n\\Delta t_{\\text{cand}}=\\frac{1}{10}\\ln\\!\\left(\\frac{1}{0.10}\\right)=\\frac{1}{10}\\ln 10.\n$$\n- The scheduled completion arrives after $\\tau=0.2$ from $t_{2}$. Since $0.2<\\frac{1}{10}\\ln 10$, the next event is the delayed completion at $t_{\\text{comp}}$; no new random numbers are consumed for this completion.\n- Update at $t_{3}=t_{\\text{comp}}$: produce one $S_{3}$, so $N_{3}\\to 1$, with $N_{2}$ unchanged.\n\nNumerical evaluation for the final time:\n$$\nt_{3}=\\frac{\\ln 2}{10}+\\frac{1}{10.7}\\ln\\!\\left(\\frac{10}{3}\\right)+0.2\\approx 0.0693147+0.1125208+0.2\\approx 0.3818355,\n$$\nwhich rounds to four significant figures as $0.3818$.\n\nTherefore, after three events the state is $N_{2}=0$, $N_{3}=1$, $t=0.3818$ s.", "answer": "$$\\boxed{\\begin{pmatrix}0 & 1 & 0.3818\\end{pmatrix}}$$", "id": "1468236"}]}