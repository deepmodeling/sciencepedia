{"hands_on_practices": [{"introduction": "The core idea behind simulating dynamic biological systems is to approximate continuous change by taking small, discrete steps forward in time. This exercise provides a foundational, step-by-step application of the forward Euler method, the most straightforward numerical integration technique. By applying it to a simple two-step metabolic pathway, you will practice the fundamental mechanics of how a system of Ordinary Differential Equations (ODEs) is solved numerically, forming the basis for simulating more complex biological networks. [@problem_id:1455809]", "problem": "A simple metabolic pathway in a cell involves the conversion of substrate A into an intermediate B, which is then converted into a final product C. The dynamics of the concentrations of A and B, denoted as $S_A(t)$ and $S_B(t)$ respectively, can be modeled by a system of Ordinary Differential Equations (ODEs):\n$$\n\\frac{dS_A}{dt} = -k_1 S_A\n$$\n$$\n\\frac{dS_B}{dt} = k_1 S_A - k_2 S_B\n$$\nThe rate constants for the reactions are given as $k_1 = 0.5\\ \\text{s}^{-1}$ and $k_2 = 0.2\\ \\text{s}^{-1}$. At time $t=0$, the initial concentrations are $S_A(0) = 100.0\\ \\mu\\text{M}$ and $S_B(0) = 0.0\\ \\mu\\text{M}$.\n\nUsing the forward Euler method with a fixed time step of $\\Delta t = 0.1\\ \\text{s}$, calculate the approximate concentrations of substrate A and substrate B at time $t = 0.2\\ \\text{s}$.\n\nProvide your answers for $S_A(0.2)$ and $S_B(0.2)$ in this order. Express your final answer in $\\mu\\text{M}$, rounded to three significant figures.", "solution": "We are asked to approximate $S_{A}(t)$ and $S_{B}(t)$ at $t=0.2$ using the forward Euler method with time step $\\Delta t=0.1$. The ODE system is\n$$\n\\frac{dS_{A}}{dt}=-k_{1}S_{A}, \\quad \\frac{dS_{B}}{dt}=k_{1}S_{A}-k_{2}S_{B},\n$$\nwith $k_{1}=0.5$, $k_{2}=0.2$, and initial conditions $S_{A}(0)=100.0$, $S_{B}(0)=0.0$.\n\nThe forward Euler updates are\n$$\nS_{A}^{n+1}=S_{A}^{n}+\\Delta t\\left(-k_{1}S_{A}^{n}\\right)=S_{A}^{n}\\left(1-k_{1}\\Delta t\\right),\n$$\n$$\nS_{B}^{n+1}=S_{B}^{n}+\\Delta t\\left(k_{1}S_{A}^{n}-k_{2}S_{B}^{n}\\right),\n$$\nwhere $S_{A}^{n}\\approx S_{A}(n\\Delta t)$ and $S_{B}^{n}\\approx S_{B}(n\\Delta t)$.\n\nCompute the factor for $S_{A}$:\n$$\n1-k_{1}\\Delta t=1-0.5\\cdot 0.1=0.95.\n$$\n\nStep from $t=0$ to $t=0.1$:\n$$\nS_{A}^{1}=S_{A}^{0}\\cdot 0.95=100.0\\cdot 0.95=95.0,\n$$\n$$\nS_{B}^{1}=S_{B}^{0}+\\Delta t\\left(k_{1}S_{A}^{0}-k_{2}S_{B}^{0}\\right)=0.0+0.1\\left(0.5\\cdot 100.0-0.2\\cdot 0.0\\right)=0.1\\cdot 50.0=5.0.\n$$\n\nStep from $t=0.1$ to $t=0.2$:\n$$\nS_{A}^{2}=S_{A}^{1}\\cdot 0.95=95.0\\cdot 0.95=90.25,\n$$\n$$\nS_{B}^{2}=S_{B}^{1}+\\Delta t\\left(k_{1}S_{A}^{1}-k_{2}S_{B}^{1}\\right)=5.0+0.1\\left(0.5\\cdot 95.0-0.2\\cdot 5.0\\right).\n$$\nCompute the bracket:\n$$\n0.5\\cdot 95.0=47.5,\\quad 0.2\\cdot 5.0=1.0,\\quad 47.5-1.0=46.5,\n$$\nso\n$$\nS_{B}^{2}=5.0+0.1\\cdot 46.5=5.0+4.65=9.65.\n$$\n\nThus $S_{A}(0.2)\\approx 90.25$ and $S_{B}(0.2)\\approx 9.65$. Rounding to three significant figures gives $S_{A}(0.2)=90.3$ and $S_{B}(0.2)=9.65$.", "answer": "$$\\boxed{\\begin{pmatrix}90.3  9.65\\end{pmatrix}}$$", "id": "1455809"}, {"introduction": "While the forward Euler method is intuitive, its application is not without pitfalls. This practice problem demonstrates a critical challenge known as \"stiffness,\" which arises frequently in biological models where different processes occur at vastly different speeds. You will attempt to solve a stiff system representing a rapid biochemical reaction using a time step that is too large, leading to a physically nonsensical result. This hands-on experience with numerical instability is a crucial lesson in selecting appropriate time steps and methods for your simulations. [@problem_id:1455796]", "problem": "In a simplified model of a cellular signaling pathway, a protein A can be reversibly converted to its active form B. This process can be described by the elementary reaction:\n$$ A \\underset{k_r}{\\stackrel{k_f}{\\rightleftharpoons}} B $$\nThe rate of change of the concentrations of A and B, denoted as $C_A(t)$ and $C_B(t)$ respectively, are governed by the following system of coupled Ordinary Differential Equations (ODEs):\n$$ \\frac{dC_A}{dt} = -k_f C_A + k_r C_B $$\n$$ \\frac{dC_B}{dt} = k_f C_A - k_r C_B $$\nSuppose the forward rate constant $k_f = 100.0 \\text{ s}^{-1}$ and the reverse rate constant $k_r = 1.0 \\text{ s}^{-1}$. At time $t=0$, the initial concentrations are $C_A(0) = 1.00 \\text{ \\mu M}$ and $C_B(0) = 0.00 \\text{ \\mu M}$.\n\nYour task is to approximate the concentration of protein B at time $t = 0.06 \\text{ s}$ by applying the forward Euler method. Use a fixed time step of $h = 0.03 \\text{ s}$.\n\nExpress your final answer for the concentration of B in micromolars ($\\mu M$), rounded to three significant figures.", "solution": "We model the reversible conversion with the coupled ODEs\n$$\n\\frac{dC_{A}}{dt}=-k_{f}C_{A}+k_{r}C_{B}, \\qquad \\frac{dC_{B}}{dt}=k_{f}C_{A}-k_{r}C_{B},\n$$\nwith initial conditions $C_{A}(0)=1.00$ and $C_{B}(0)=0.00$, and parameters $k_{f}=100.0$ and $k_{r}=1.0$. The forward Euler method with fixed step size $h=0.03$ updates as\n$$\nC_{A}^{n+1}=C_{A}^{n}+h\\left(-k_{f}C_{A}^{n}+k_{r}C_{B}^{n}\\right), \\qquad\nC_{B}^{n+1}=C_{B}^{n}+h\\left(k_{f}C_{A}^{n}-k_{r}C_{B}^{n}\\right).\n$$\nWe take two steps to reach $t=0.06$.\n\nStep 1 (from $t=0$ to $t=0.03$): Using $C_{A}^{0}=1.00$, $C_{B}^{0}=0.00$,\n$$\n\\left.\\frac{dC_{A}}{dt}\\right|_{0}=-k_{f}C_{A}^{0}+k_{r}C_{B}^{0}=-100.0\\cdot 1.00+1.0\\cdot 0.00=-100.0,\n$$\n$$\n\\left.\\frac{dC_{B}}{dt}\\right|_{0}=k_{f}C_{A}^{0}-k_{r}C_{B}^{0}=100.0\\cdot 1.00-1.0\\cdot 0.00=100.0.\n$$\nThus,\n$$\nC_{A}^{1}=1.00+0.03\\cdot(-100.0)=1.00-3.00=-2.00,\n$$\n$$\nC_{B}^{1}=0.00+0.03\\cdot(100.0)=3.00.\n$$\n\nStep 2 (from $t=0.03$ to $t=0.06$): Using $C_{A}^{1}=-2.00$, $C_{B}^{1}=3.00$,\n$$\n\\left.\\frac{dC_{A}}{dt}\\right|_{1}=-k_{f}C_{A}^{1}+k_{r}C_{B}^{1}=-100.0\\cdot(-2.00)+1.0\\cdot 3.00=203.0,\n$$\n$$\n\\left.\\frac{dC_{B}}{dt}\\right|_{1}=k_{f}C_{A}^{1}-k_{r}C_{B}^{1}=100.0\\cdot(-2.00)-1.0\\cdot 3.00=-203.0.\n$$\nThus,\n$$\nC_{A}^{2}=-2.00+0.03\\cdot 203.0=-2.00+6.09=4.09,\n$$\n$$\nC_{B}^{2}=3.00+0.03\\cdot(-203.0)=3.00-6.09=-3.09.\n$$\nTherefore, the forward Euler approximation at $t=0.06$ gives $C_{B}(0.06)\\approx -3.09$. Rounded to three significant figures, the value is $-3.09$.", "answer": "$$\\boxed{-3.09}$$", "id": "1455796"}, {"introduction": "The instability demonstrated by the forward Euler method on stiff or challenging problems prompts the search for more robust algorithms. This exercise directly compares the forward Euler method, an \"explicit\" method, with the backward Euler method, a simple \"implicit\" method. By applying both to a pharmacokinetic model with a large time step, you will see firsthand how the implicit approach can maintain stability where the explicit one fails dramatically, illustrating a fundamental concept in numerical analysis. [@problem_id:1455807]", "problem": "A common problem in pharmacokinetics is modeling the concentration of a drug in a patient's body over time. A simple model treats the body as a single, well-mixed compartment. After an intravenous bolus injection, the drug concentration, $C(t)$, is observed to decrease over time due to metabolic elimination. This process can be described by the first-order ordinary differential equation (ODE):\n$$\n\\frac{dC}{dt} = -k_e C\n$$\nwhere $k_e$ is the elimination rate constant.\n\nSuppose a drug is administered such that its initial concentration is $C(0) = C_0 = 100.0$ mg/L, and its elimination rate constant is $k_e = 0.50$ hr⁻¹.\n\nYou are tasked with numerically estimating the drug concentration at time $t = 10.0$ hr using a time step of $\\Delta t = 5.0$ hr. To do this, you will perform two integration steps using two different numerical methods:\n\n1.  **The Forward (or Explicit) Euler Method**, defined by the update rule: $y_{n+1} = y_n + \\Delta t \\cdot f(t_n, y_n)$.\n2.  **The Backward (or Implicit) Euler Method**, defined by the update rule: $y_{n+1} = y_n + \\Delta t \\cdot f(t_{n+1}, y_{n+1})$.\n\nCalculate the estimated concentration $C(10.0 \\text{ hr})$ using the Forward Euler method, and the estimated concentration $C(10.0 \\text{ hr})$ using the Backward Euler method.\n\nProvide your two results, for the Forward and Backward Euler methods respectively, in mg/L. Round your final answers to three significant figures.", "solution": "The problem asks for the numerical solution of the ordinary differential equation (ODE) $\\frac{dC}{dt} = -k_e C$ at $t=10.0$ hr, using two steps of the Forward and Backward Euler methods.\n\nThe given parameters are:\n- Initial concentration: $C(0) = C_0 = 100.0$ mg/L\n- Elimination rate constant: $k_e = 0.50$ hr⁻¹\n- Time step: $\\Delta t = 5.0$ hr\n- Target time: $t = 10.0$ hr, which corresponds to two time steps since $2 \\times \\Delta t = 2 \\times 5.0 = 10.0$ hr.\n\nLet $C_n$ be the numerical approximation of the concentration $C(t_n)$ at time $t_n = n \\Delta t$. We start with $C_0 = 100.0$ mg/L at $t_0 = 0$. We need to find $C_2$. The function defining the ODE is $f(t, C) = -k_e C$.\n\n**1. Forward Euler Method Calculation**\n\nThe Forward Euler update rule is given by $C_{n+1} = C_n + \\Delta t \\cdot f(t_n, C_n)$.\nSubstituting our specific function, we have:\n$C_{n+1} = C_n + \\Delta t (-k_e C_n)$\n$C_{n+1} = C_n (1 - k_e \\Delta t)$\n\nFirst, we calculate the factor $(1 - k_e \\Delta t)$:\n$1 - k_e \\Delta t = 1 - (0.50 \\text{ hr}^{-1})(5.0 \\text{ hr}) = 1 - 2.5 = -1.5$\n\nNow we perform the two integration steps:\nStep 1 (calculating $C_1$ at $t_1 = 5.0$ hr):\n$C_1 = C_0 (1 - k_e \\Delta t) = (100.0 \\text{ mg/L}) \\times (-1.5) = -150.0 \\text{ mg/L}$\n\nStep 2 (calculating $C_2$ at $t_2 = 10.0$ hr):\n$C_2 = C_1 (1 - k_e \\Delta t) = (-150.0 \\text{ mg/L}) \\times (-1.5) = 225.0 \\text{ mg/L}$\n\nThe estimated concentration using the Forward Euler method is $225.0$ mg/L. Rounded to three significant figures, this is $225$ mg/L.\n\n**2. Backward Euler Method Calculation**\n\nThe Backward Euler update rule is given by $C_{n+1} = C_n + \\Delta t \\cdot f(t_{n+1}, C_{n+1})$.\nSubstituting our specific function, we have:\n$C_{n+1} = C_n + \\Delta t (-k_e C_{n+1})$\n\nThis is an implicit equation for $C_{n+1}$, so we must first solve for it algebraically:\n$C_{n+1} + \\Delta t k_e C_{n+1} = C_n$\n$C_{n+1} (1 + \\Delta t k_e) = C_n$\n$C_{n+1} = \\frac{C_n}{1 + k_e \\Delta t}$\n\nFirst, we calculate the denominator $(1 + k_e \\Delta t)$:\n$1 + k_e \\Delta t = 1 + (0.50 \\text{ hr}^{-1})(5.0 \\text{ hr}) = 1 + 2.5 = 3.5$\n\nNow we perform the two integration steps:\nStep 1 (calculating $C_1$ at $t_1 = 5.0$ hr):\n$C_1 = \\frac{C_0}{1 + k_e \\Delta t} = \\frac{100.0 \\text{ mg/L}}{3.5} \\approx 28.5714... \\text{ mg/L}$\n\nStep 2 (calculating $C_2$ at $t_2 = 10.0$ hr):\n$C_2 = \\frac{C_1}{1 + k_e \\Delta t} = \\frac{28.5714... \\text{ mg/L}}{3.5} \\approx 8.163265... \\text{ mg/L}$\n\nThe estimated concentration using the Backward Euler method is $8.163265...$ mg/L. Rounded to three significant figures, this is $8.16$ mg/L.\n\nThe final results are 225 mg/L for the Forward Euler method and 8.16 mg/L for the Backward Euler method.", "answer": "$$\\boxed{\\begin{pmatrix} 225  8.16 \\end{pmatrix}}$$", "id": "1455807"}]}