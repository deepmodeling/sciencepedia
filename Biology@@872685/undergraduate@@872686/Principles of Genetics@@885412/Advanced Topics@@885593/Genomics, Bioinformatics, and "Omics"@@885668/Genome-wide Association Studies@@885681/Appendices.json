{"hands_on_practices": [{"introduction": "Genome-Wide Association Studies (GWAS) are powerful, but their scale introduces a major statistical challenge: the multiple testing problem. When you perform millions of statistical tests, you are almost guaranteed to find some associations just by random chance. This exercise [@problem_id:1494362] introduces the Bonferroni correction, a fundamental method for adjusting your significance threshold to control for this flood of potential false positives and maintain scientific rigor.", "problem": "A team of geneticists is conducting a Genome-Wide Association Study (GWAS) to identify genetic markers associated with a newly discovered complex disorder. A GWAS involves scanning the genomes of many individuals to determine if any specific genetic variants are more frequent in people with the disease compared to a control group. The genetic variants being analyzed in this study are Single Nucleotide Polymorphisms (SNPs).\n\nIn this particular study, the researchers are simultaneously testing $m = 1,000,000$ independent SNPs for a statistical association with the disorder. Conventionally, for a single statistical test, a p-value threshold (alpha level) for significance is set at $\\alpha = 0.05$. However, performing such a large number of tests significantly inflates the probability of obtaining at least one \"false positive\" result (a Type I error) purely by chance.\n\nTo counteract this multiple testing problem, the research team decides to control the Family-Wise Error Rate (FWER), defined as the probability of making one or more Type I errors among all the tests performed. They aim to keep the FWER at or below 0.05. To achieve this, they will apply the Bonferroni correction to their significance threshold.\n\nGiven the number of independent SNPs being tested and the desired FWER, calculate the new, Bonferroni-corrected p-value threshold that a single SNP must meet to be considered statistically significant. Express your answer in scientific notation.", "solution": "The family-wise error rate under the Bonferroni procedure satisfies the Bonferroni inequality:\n$$\n\\text{FWER} \\leq \\sum_{i=1}^{m} \\alpha_{i}.\n$$\nIf each of the $m$ tests is conducted at the same per-test significance level $\\alpha^{*}$, then\n$$\n\\text{FWER} \\leq m \\alpha^{*}.\n$$\nTo control the FWER at the desired level $\\alpha$, choose $\\alpha^{*}$ such that\n$$\nm \\alpha^{*} \\leq \\alpha \\quad \\Rightarrow \\quad \\alpha^{*} = \\frac{\\alpha}{m}.\n$$\nWith $\\alpha = 0.05$ and $m = 1{,}000{,}000 = 10^{6}$, write $0.05 = 5 \\times 10^{-2}$ and compute\n$$\n\\alpha^{*} = \\frac{5 \\times 10^{-2}}{10^{6}} = 5 \\times 10^{-2-6} = 5 \\times 10^{-8}.\n$$\nThus, the Bonferroni-corrected p-value threshold is $5 \\times 10^{-8}$.", "answer": "$$\\boxed{5 \\times 10^{-8}}$$", "id": "1494362"}, {"introduction": "After correcting for multiple tests, researchers often find some genetic variants with extremely small p-values, indicating a strong statistical association. A common mistake is to assume that a smaller p-value automatically implies a larger biological effect on the trait being studied. This exercise [@problem_id:1494349] challenges that assumption, forcing you to think critically about the factors that influence a p-value—such as allele frequency and sample size—in addition to the actual effect size of the variant.", "problem": "A genetics student is analyzing the results from a large Genome-Wide Association Study (GWAS) for adult height. In the study, millions of Single Nucleotide Polymorphisms (SNPs) across the genome were tested for association with height in a cohort of 500,000 individuals. The student identifies two novel SNPs on different chromosomes that pass the threshold for genome-wide significance:\n\n- SNP-1 has a p-value of $1 \\times 10^{-12}$.\n- SNP-2 has a p-value of $1 \\times 10^{-30}$.\n\nBased on this, the student concludes that SNP-2 must have a larger biological effect on height than SNP-1 because its p-value is much smaller (more significant). Which of the following statements provides the most accurate reason why this conclusion is not necessarily valid?\n\nA. The p-value for SNP-2 is so small that it likely represents a statistical artifact caused by uncorrected population stratification, and therefore cannot be compared to the p-value of SNP-1.\n\nB. A p-value is the probability that the null hypothesis (of no association) is true; therefore, both p-values are so close to zero that any difference between them is meaningless for inferring biological effect.\n\nC. The statistical significance of an association (represented by the p-value) is a function of both the magnitude of the variant's effect and the statistical power to detect it. A very common SNP with a small effect can achieve a lower p-value in a large study than a rare SNP with a genuinely larger biological effect.\n\nD. SNP-2 must be in a region of high linkage disequilibrium (LD), meaning its p-value is inflated by the effects of many neighboring SNPs, whereas SNP-1 is likely the sole causal variant in its region.\n\nE. P-values below the conventional genome-wide significance threshold ($5 \\times 10^{-8}$) are all considered equally evidential, and scientific standards dictate that one should not interpret differences in the magnitude of p-values that are this statistically significant.", "solution": "The core of this problem is to understand what a p-value in a GWAS represents and what factors influence it. The student's error is a common misinterpretation: equating statistical significance directly with biological effect size.\n\nFirst, let's define the key terms. A p-value in this context is the probability of observing an association statistic (like a chi-squared value or a regression coefficient's Z-score) as extreme as, or more extreme than, the one actually observed, under the assumption that the null hypothesis is true. The null hypothesis ($H_0$) is that the SNP has no effect on the trait (height). A smaller p-value provides stronger evidence to reject the null hypothesis. Effect size, on the other hand, is a quantitative measure of the magnitude of the phenomenon, e.g., how many millimeters an allele of SNP-2 adds to height on average.\n\nThe critical point is that the test statistic, from which the p-value is derived, is not a pure function of the effect size. For a quantitative trait like height, the association is often tested using a linear regression model. The Z-score for a SNP's effect is approximately:\n$$ Z \\approx \\frac{\\beta}{\\text{SE}(\\beta)} $$\nwhere $\\beta$ is the estimated effect size and $\\text{SE}(\\beta)$ is its standard error.\n\nThe standard error is inversely proportional to the square root of the sample size ($N$) and is also dependent on the variance of the SNP, which is a function of its minor allele frequency (MAF). Specifically, $\\text{SE}(\\beta)$ is smaller for SNPs with higher MAF (i.e., common variants) and for larger sample sizes.\n$$ \\text{SE}(\\beta) \\propto \\frac{1}{\\sqrt{N \\times \\text{MAF} \\times (1-\\text{MAF})}} $$\nTherefore, the Z-score is approximately:\n$$ Z \\propto \\beta \\sqrt{N \\times \\text{MAF} \\times (1-\\text{MAF})} $$\nA more significant (smaller) p-value corresponds to a larger absolute Z-score. From this relationship, we can see that a large Z-score can be achieved in several ways:\n1.  A large effect size ($\\beta$).\n2.  A very large sample size ($N$).\n3.  A high Minor Allele Frequency (MAF approaching 0.5), which maximizes the term $\\text{MAF} \\times (1-\\text{MAF})$.\n\nIn our scenario, SNP-2 has a much smaller p-value than SNP-1. The student assumes this is because the effect size ($\\beta_2$) is much larger than $\\beta_1$. However, it is entirely possible that SNP-2 is a much more common variant (higher MAF) than SNP-1. For instance, SNP-2 might have a MAF of 0.40 and a small effect on height (e.g., adds 0.5 mm), while SNP-1 could be a rare variant with a MAF of 0.01 but have a much larger effect (e.g., adds 2 mm). In a very large study (N=500,000), the immense statistical power to detect the effect of the common SNP-2 could result in a more extreme p-value than that for the rare but more impactful SNP-1. Therefore, one cannot conclude that a smaller p-value implies a larger effect size without also considering the allele frequencies of the SNPs.\n\nNow let's evaluate the options:\n\nA. This is incorrect. While population stratification can cause false positives, there's no reason to assume it is the cause for one SNP and not the other, or that an extremely small p-value is more likely to be an artifact. Properly conducted GWAS correct for this. This is a possible confounder, but not the fundamental reason why p-value and effect size are not the same.\n\nB. This option contains a common and critical misinterpretation of the p-value. A p-value is P(data or more extreme | $H_0$), not P($H_0$ | data). Furthermore, the difference between a p-value of $10^{-12}$ and $10^{-30}$ is astronomically large and statistically very meaningful; it means the evidence against the null hypothesis is vastly stronger for SNP-2. The option is wrong on two counts.\n\nC. This option correctly identifies the relationship. It states that statistical significance (p-value) is influenced a combination of factors including effect size and statistical power (which itself depends on sample size and allele frequency). It correctly provides a scenario where a common variant with a small effect can yield a more significant p-value than a rare variant with a large effect. This is the most accurate explanation.\n\nD. This is a plausible but incorrect explanation. Linkage disequilibrium (LD) means that SNPs are inherited together. A significant SNP might be a \"tag\" for a true causal variant nearby. However, this doesn't explain the fundamental issue. Even if SNP-2 is just a tag, the p-value of both the tag and the true causal variant are subject to the same influences of effect size, MAF, and sample size. LD explains why the signal might not be at the causal variant, but it doesn't sever the connection between p-value, effect size, and allele frequency.\n\nE. This is factually incorrect. While $5 \\times 10^{-8}$ is a conventional *threshold* for declaring significance, it does not mean all p-values below it are equivalent. A p-value of $10^{-30}$ represents a vastly stronger rejection of the null hypothesis than a p-value of $10^{-9}$. The difference in magnitude is highly interpretable from a statistical evidence perspective.", "answer": "$$\\boxed{C}$$", "id": "1494349"}, {"introduction": "A successful GWAS identifies a handful of credible genetic associations, but what happens when a study reports tens of thousands of them? This scenario often points not to a groundbreaking biological discovery, but to a critical flaw in the experimental design. This practice problem [@problem_id:1494331] places you in the role of a data analyst tasked with diagnosing why a study produced an impossibly large number of significant results, highlighting how systematic biases, or \"batch effects,\" can create massive, misleading signals.", "problem": "A large research consortium is conducting a Genome-Wide Association Study (GWAS) to identify genetic variants associated with \"Aero-Metabolic Syndrome\" (AMS), a complex respiratory disease. The study design involves `10,000` cases recruited from a network of specialized respiratory clinics and `10,000` controls selected from a general population health registry. To manage the large sample size efficiently, the genotyping process was distributed. DNA samples from all `10,000` cases were processed and genotyped for millions of Single Nucleotide Polymorphisms (SNPs) using the \"BioArray v2.0\" platform at a central laboratory. Concurrently, DNA samples from all `10,000` controls were processed and genotyped using the \"GenoChip v3.5\" platform at a different facility.\n\nAfter the data from both platforms were merged and subjected to standard quality control, a statistical association test was performed for each SNP. The analysis revealed a striking result: tens of thousands of SNPs, distributed across every chromosome, showed a statistically significant association with AMS, far exceeding the typical findings for a complex disease GWAS.\n\nWhich of the following options provides the most plausible explanation for this genome-wide excess of significant associations?\n\nA. Population stratification: The case and control groups were drawn from populations with systematically different genetic ancestries, and these ancestry-related allele frequency differences are being misinterpreted as disease associations.\n\nB. Polygenic architecture: AMS is a highly polygenic disease, where its genetic risk is genuinely determined by the cumulative small effects of tens of thousands of common variants spread throughout the genome.\n\nC. Selection bias: Recruiting cases from specialized clinics resulted in a cohort with a more severe form of the disease, enriching for a large number of rare, high-impact variants not found in the general population controls.\n\nD. Systematic genotyping bias: The two different genotyping platforms have small, consistent, and platform-specific inaccuracies in allele measurement that, because they are perfectly correlated with the case-control labels, are creating widespread false-positive signals.\n\nE. Cryptic relatedness: The case group unknowingly contains a large number of closely related individuals, which violates the statistical assumption of sample independence and inflates association signals at loci shared within families.", "solution": "We formalize the per-SNP association test as either an allelic chi-square test or a logistic regression of case status on genotype. Let $Y \\in \\{0,1\\}$ denote case status, $G \\in \\{0,1,2\\}$ the coded genotype, and consider for each SNP the null hypothesis $H_{0}: \\beta_{G} = 0$ in the logistic model $\\ln\\left(\\frac{\\Pr(Y=1 \\mid G)}{\\Pr(Y=0 \\mid G)}\\right) = \\alpha + \\beta_{G} G$. Under correct model specification and no confounding, the score or Wald test statistic has an asymptotic $\\chi^{2}_{1}$ distribution under $H_{0}$, so $p$-values across the genome should be approximately uniform under the null aside from a small number of true associations in a complex disease.\n\nThe observed pattern is a genome-wide excess of significant associations across every chromosome with tens of thousands of SNPs reaching significance. Such a pervasive inflation indicates a systematic deviation from the null that affects a very large fraction of SNPs. We examine each option by linking it to the test behavior.\n\nOption B (polygenic architecture): In a highly polygenic trait, many variants have small true effects. The power to detect a SNP at a stringent genome-wide threshold $\\alpha_{GW}$ (e.g., $\\alpha_{GW} \\approx 5 \\times 10^{-8}$) depends on the noncentrality parameter $\\Lambda$ of the association test. For an additive test, a standard approximation gives $\\Lambda \\approx N_{\\text{eff}} \\cdot 2 p (1 - p) \\cdot (\\ln \\theta)^{2}$, where $p$ is the minor allele frequency, $\\theta$ is the per-allele odds ratio, and $N_{\\text{eff}}$ is an effective sample size function of the case and control counts. For realistic complex traits with small $\\ln \\theta$, even large $N_{\\text{eff}}$ yields limited power at $\\alpha_{GW}$. Therefore, polygenicity alone does not generate tens of thousands of genome-wide significant hits with this sample size; it yields a polygenic signal detectable by methods like LD score regression or polygenic scores, not ubiquitous single-SNP significance.\n\nOption C (selection bias toward severity): Recruiting more severe cases might enrich for rare, high-impact variants. Arrays primarily target common variants; rare, severe alleles are often poorly tagged. Moreover, such enrichment does not create consistent allele frequency differences at common SNPs across the entire genome; it would not yield widespread false positives at common variants.\n\nOption E (cryptic relatedness): Relatedness violates independence, affecting variance estimates and inflating the test statistic if unmodeled. However, this inflation typically depends on sharing patterns and is not uniform across all SNPs; in practice it produces a modest, genome-wide inflation factor and sometimes localized signals, not tens of thousands of significant associations across all chromosomes. Furthermore, relatedness reduces the effective sample size, which usually decreases, rather than massively increases, the number of genome-wide significant hits after proper standard errors are used.\n\nOption A (population stratification): Systematic ancestry differences between cases and controls induce genome-wide allele frequency differences due to demographic history rather than disease, inflating association statistics across many SNPs. If uncorrected, this can plausibly create widespread significance. However, standard GWAS pipelines include adjustment for principal components of ancestry, which typically mitigates most stratification. While A could explain broad inflation, the study design provides a more direct and stronger source of confounding.\n\nOption D (systematic genotyping bias from different platforms): Here, genotyping platform is perfectly confounded with phenotype: all cases on BioArray v2.0 and all controls on GenoChip v3.5. Let $B \\in \\{0,1\\}$ denote platform, with $B=1$ for cases and $B=0$ for controls. Let the true additive genotype be $G$, but the measured genotype be $\\tilde{G} = G + \\epsilon_{B}$, where $E[\\epsilon_{1}] \\neq E[\\epsilon_{0}]$ or the error distribution differs by platform due to differential calling, differential missingness, or probe chemistry. The expected difference in measured mean genotype between cases and controls is\n$$\nE[\\tilde{G} \\mid Y=1] - E[\\tilde{G} \\mid Y=0] = \\underbrace{E[G \\mid Y=1] - E[G \\mid Y=0]}_{\\Delta \\text{ (true effect)}} + \\underbrace{E[\\epsilon_{1}] - E[\\epsilon_{0}]}_{\\delta \\text{ (platform bias)}}.\n$$\nUnder the null for most SNPs, $\\Delta = 0$, but $\\delta \\neq 0$ whenever platform-specific calling bias exists. Because $B$ is perfectly collinear with $Y$, one cannot adjust for $B$ in the association model; omitted variable bias assigns platform-induced differences to the genotype coefficient, producing spurious associations. The test statistic for an allelic chi-square test is approximately\n$$\nT \\approx \\frac{\\left(\\hat{p}_{\\text{case}} - \\hat{p}_{\\text{control}}\\right)^{2}}{\\hat{V}},\n$$\nwhere $\\hat{p}_{\\text{case}}$ and $\\hat{p}_{\\text{control}}$ are observed allele frequencies and $\\hat{V}$ is the estimated variance under the null. If $\\hat{p}_{\\text{case}} - \\hat{p}_{\\text{control}} \\approx \\delta$ across many SNPs due to platform bias, then $T$ is inflated genome-wide. Unlike random non-differential measurement error, which attenuates associations, this is differential misclassification correlated with outcome status, which biases away from the null at many SNPs simultaneously, exactly matching the observed pattern of tens of thousands of significant hits across all chromosomes.\n\nGiven the specific design detail that all cases and controls were genotyped on different platforms at different facilities, systematic platform-specific genotyping bias that is perfectly correlated with case-control status is the most plausible and direct explanation for the genome-wide excess of significant associations.\n\nTherefore, the correct choice is D.", "answer": "$$\\boxed{D}$$", "id": "1494331"}]}