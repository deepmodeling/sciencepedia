{
    "hands_on_practices": [
        {
            "introduction": "Understanding thermal bremsstrahlung begins with quantifying the radiation produced by a plasma. This first practice challenges you to build the thermal free-free emissivity, $j_\\nu$, from fundamental electrodynamic and statistical principles. By implementing this formula numerically and performing a dimensional analysis, you will solidify your understanding of how microscopic interactions give rise to macroscopic radiative properties .",
            "id": "4234242",
            "problem": "Implement a numerical evaluator for the thermal free-free emissivity per unit frequency per unit volume per unit solid angle, denoted by $j_{\\nu}$, for a fully ionized, optically thin, single-species ion-electron plasma. Work in the Centimeter-Gram-Second (CGS) system and assume non-relativistic electrons following a Maxwell-Boltzmann distribution. Start from a valid fundamental base: the Larmor formula for the power radiated by an accelerated charge, the Coulomb acceleration in a $Z$-charged ion field, and the Maxwell-Boltzmann distribution for electron speeds. Use the definition that the angle-averaged volume emissivity per unit frequency $\\varepsilon_{\\nu}$ is related to the emission coefficient per unit solid angle $j_{\\nu}$ by $\\varepsilon_{\\nu} = 4\\pi j_{\\nu}$. Do not introduce any phenomenological fitting constants; instead, construct $j_{\\nu}$ using established physical constants in CGS units and the classical Kramers form with a quantum Gaunt factor taken as dimensionless. You may take the Gaunt factor $g_{\\mathrm{ff}}$ to be unity for numerical evaluation. The final expression for $j_{\\nu}$ must be expressed completely in terms of the electron number density $n_{e}$, the ion number density $n_{i}$, the ionic charge number $Z$, the temperature $T$, the observing frequency $\\nu$, and the CGS constants, together with the Maxwellian suppression factor $\\exp(-h\\nu/k_{\\mathrm{B}}T)$ originating from detailed balance.\n\nYour program must:\n- Numerically evaluate $j_{\\nu}$ in units of $\\mathrm{erg\\,s^{-1}\\,cm^{-3}\\,Hz^{-1}\\,sr^{-1}}$ for each provided test case.\n- Verify unit consistency by confirming that the combination of constants and variables in your implementation yields $[j_{\\nu}] = \\mathrm{erg\\,s^{-1}\\,cm^{-3}\\,Hz^{-1}\\,sr^{-1}}$ in CGS. Implement a dimensional analysis in terms of base dimensions $M$ (mass), $L$ (length), $T$ (time), and $K$ (thermodynamic temperature), and the CGS Gaussian electric charge dimension captured by $[e^{2}] = \\mathrm{erg\\,cm}$ (equivalently $[e] = M^{1/2}L^{3/2}T^{-1}$). Your check must confirm that the final dimensions reduce to $M^{1}L^{-1}T^{-2}$, which corresponds to $\\mathrm{erg\\,s^{-1}\\,cm^{-3}\\,Hz^{-1}}$ per steradian (steradian is dimensionless), when the factor of $\\mathrm{Hz^{-1}}$ is kept explicit as inverse seconds.\n\nRequired units:\n- Report $j_{\\nu}$ in $\\mathrm{erg\\,s^{-1}\\,cm^{-3}\\,Hz^{-1}\\,sr^{-1}}$.\n- Frequencies $\\nu$ must be in $\\mathrm{Hz}$.\n- Number densities $n_{e}$ and $n_{i}$ must be in $\\mathrm{cm^{-3}}$.\n- Temperature $T$ must be in $\\mathrm{K}$.\n- The ionic charge number $Z$ is dimensionless.\n\nTest suite:\nCompute $j_{\\nu}$ for the following parameter sets:\n- Case $1$: $T = 10^{7}\\,\\mathrm{K}$, $n_{e} = 10^{-3}\\,\\mathrm{cm^{-3}}$, $n_{i} = 10^{-3}\\,\\mathrm{cm^{-3}}$, $Z = 1$, $\\nu = 10^{9}\\,\\mathrm{Hz}$.\n- Case $2$: $T = 10^{8}\\,\\mathrm{K}$, $n_{e} = 10^{-6}\\,\\mathrm{cm^{-3}}$, $n_{i} = 10^{-6}\\,\\mathrm{cm^{-3}}$, $Z = 1$, $\\nu = 10^{18}\\,\\mathrm{Hz}$.\n- Case $3$: $T = 10^{4}\\,\\mathrm{K}$, $n_{e} = 10^{2}\\,\\mathrm{cm^{-3}}$, $n_{i} = 5\\times 10^{1}\\,\\mathrm{cm^{-3}}$, $Z = 2$, $\\nu = 10^{12}\\,\\mathrm{Hz}$.\n- Case $4$: $T = 10^{5}\\,\\mathrm{K}$, $n_{e} = 1\\,\\mathrm{cm^{-3}}$, $n_{i} = 1\\,\\mathrm{cm^{-3}}$, $Z = 1$, $\\nu = 10^{3}\\,\\mathrm{Hz}$.\n\nAnswer specification:\n- For each case, produce the numeric value of $j_{\\nu}$ as a floating-point number in $\\mathrm{erg\\,s^{-1}\\,cm^{-3}\\,Hz^{-1}\\,sr^{-1}}$.\n- Include a single global boolean at the end that indicates whether the unit consistency check passed (i.e., whether the derived dimensions match $M^{1}L^{-1}T^{-2}$ exactly).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The intended format is $[j_{1},j_{2},j_{3},j_{4},\\mathrm{unit\\_ok}]$, where $j_{i}$ are floats and $\\mathrm{unit\\_ok}$ is a boolean.\n\nScientific realism constraints:\n- Assume non-relativistic electrons, unsaturated emission, and ignore self-absorption.\n- Treat the Gaunt factor $g_{\\mathrm{ff}}$ as dimensionless and set $g_{\\mathrm{ff}}=1$ for this task.\n- Use the exact CGS Gaussian constants: electron charge $e$, electron mass $m_{e}$, speed of light $c$, Boltzmann constant $k_{\\mathrm{B}}$, and Planck constant $h$.",
            "solution": "The problem requires the implementation of a numerical evaluator for the thermal bremsstrahlung (free-free) emission coefficient per unit volume, per unit frequency, and per unit solid angle, denoted $j_{\\nu}$. The evaluation must be performed in CGS units for a fully ionized, optically thin plasma with non-relativistic electrons obeying a Maxwell-Boltzmann distribution. The derivation must originate from fundamental principles and the final expression must be validated for dimensional consistency.\n\nThe derivation of $j_{\\nu}$ proceeds from a microscopic to a macroscopic description.\n\nFirst, we consider the radiation from a single electron of charge $-e$ and mass $m_e$ accelerated by a stationary ion of charge $+Ze$. The instantaneous power radiated by the accelerated electron is given by the Larmor formula in CGS-Gaussian units:\n$$ P(t) = \\frac{2e^2}{3c^3} |\\mathbf{a}(t)|^2 $$\nwhere $\\mathbf{a}(t)$ is the electron's acceleration and $c$ is the speed of light. The acceleration is caused by the Coulomb force from the ion, $\\mathbf{F} = \\frac{Ze^2}{r^2} \\hat{\\mathbf{r}}$, leading to $\\mathbf{a} = \\mathbf{F}/m_e$.\n\nThe total energy radiated in a single collision (a \"fly-by\") with impact parameter $b$ and initial velocity $v$ is found by integrating $P(t)$ over the entire trajectory. To find the emissivity per unit frequency, $\\varepsilon_{\\nu}$, we must consider the Fourier spectrum of the emitted radiation. The energy radiated per unit frequency, $W_{\\nu}(b, v)$, for a single collision can be found by taking the Fourier transform of the acceleration vector.\n\nNext, we average over all possible collisions to find the total power radiated per unit volume. This requires integrating over all impact parameters $b$ and over the distribution of electron velocities. The number of collisions per unit time, per unit volume, experienced by electrons with velocities in the range $(v, v+dv)$ with ions, for impact parameters in the range $(b, b+db)$, is $n_e n_i v f(v) dv (2\\pi b db)$, where $n_e$ and $n_i$ are the electron and ion number densities, respectively, and $f(v)$ is the normalized velocity distribution function.\n\nFor a thermal plasma in equilibrium, the electrons follow a Maxwell-Boltzmann velocity distribution:\n$$ f(v) dv = 4\\pi \\left( \\frac{m_e}{2\\pi k_B T} \\right)^{3/2} v^2 e^{-m_e v^2 / (2 k_B T)} dv $$\nwhere $k_B$ is the Boltzmann constant and $T$ is the temperature.\n\nThe angle-averaged volume emissivity per unit frequency, $\\varepsilon_{\\nu}$, is obtained by integrating the product of the single-collision energy spectrum and the collision rate over all impact parameters and all electron velocities:\n$$ \\varepsilon_{\\nu} = n_e n_i \\int_{v_{min}}^{\\infty} v f(v) \\left( \\int_{0}^{\\infty} W_{\\nu}(b, v) 2\\pi b db \\right) dv $$\nThe lower limit of the velocity integration, $v_{min}$, is set by the requirement that the electron's kinetic energy must be at least equal to the energy of the emitted photon, $h\\nu$, i.e., $\\frac{1}{2}m_e v_{min}^2 = h\\nu$. This kinematic constraint, when integrated over the Maxwellian distribution, gives rise to the characteristic exponential suppression factor $e^{-h\\nu/k_B T}$.\n\nThe full integration yields the standard result for the thermal bremsstrahlung emissivity, often given in the Kramers' approximation with a quantum-mechanical correction factor called the Gaunt factor, $g_{\\mathrm{ff}}(\\nu, T)$. The result is:\n$$ \\varepsilon_{\\nu} = \\frac{2^5 \\pi e^6}{3 m_e c^3} \\left( \\frac{2\\pi}{3 m_e k_B T} \\right)^{1/2} Z^2 n_e n_i g_{\\mathrm{ff}}(\\nu, T) e^{-h\\nu/k_B T} $$\nThe problem asks for the emissivity per unit solid angle, $j_{\\nu}$. For isotropic emission, this is related to the volume emissivity by $\\varepsilon_{\\nu} = 4\\pi j_{\\nu}$. Therefore,\n$$ j_{\\nu} = \\frac{\\varepsilon_{\\nu}}{4\\pi} = \\frac{1}{4\\pi} \\frac{32 \\pi e^6}{3 m_e c^3} \\left( \\frac{2\\pi}{3 m_e k_B} \\right)^{1/2} \\frac{Z^2 n_e n_i}{\\sqrt{T}} g_{\\mathrm{ff}}(\\nu, T) e^{-h\\nu/k_B T} $$\nSimplifying, and setting the dimensionless Gaunt factor $g_{\\mathrm{ff}}=1$ as per the instructions, we obtain the final formula for implementation:\n$$ j_{\\nu} = \\frac{8 e^6}{3 m_e c^3} \\left( \\frac{2\\pi}{3 m_e k_B} \\right)^{1/2} \\frac{Z^2 n_e n_i}{\\sqrt{T}} e^{-h\\nu/k_B T} $$\n\nAs required, we perform a dimensional analysis to verify the consistency of the CGS units. We use base dimensions of Mass ($M$), Length ($L$), Time ($T$), and Temperature ($K$). In the CGS-Gaussian system, the dimension of charge is derived from the Coulomb force law, $F=e^2/r^2$, which gives $[e^2] = [F][r^2] = (MLT^{-2})(L^2) = ML^3T^{-2}$.\n\nThe dimensions of the components of our formula are:\n- $[e^6] = ([e^2])^3 = (ML^3T^{-2})^3 = M^3L^9T^{-6}$\n- $[m_e] = M$\n- $[c] = LT^{-1}$, thus $[c^3] = L^3T^{-3}$\n- $[k_B] = \\text{energy/temp} = ML^2T^{-2}K^{-1}$\n- $[n_e] = [n_i] = L^{-3}$\n- $[T] = K$\n- $[Z]$, $[g_{\\mathrm{ff}}]$, and the exponential term are dimensionless.\n\nLet's analyze the constant pre-factor, $C_{ff} = \\frac{8 e^6}{3 m_e c^3} \\left( \\frac{2\\pi}{3 m_e k_B} \\right)^{1/2}$:\n$$ [C_{ff}] = \\frac{[e^6]}{[m_e][c^3]} \\left( \\frac{1}{[m_e][k_B]} \\right)^{1/2} = \\frac{M^3L^9T^{-6}}{(M)(L^3T^{-3})} \\left( \\frac{1}{(M)(ML^2T^{-2}K^{-1})} \\right)^{1/2} $$\n$$ [C_{ff}] = (M^2L^6T^{-3}) \\left( M^{-2}L^{-2}T^{2}K^{1} \\right)^{1/2} = (M^2L^6T^{-3}) (M^{-1}L^{-1}T^{1}K^{1/2}) = M^1L^5T^{-2}K^{1/2} $$\nNow, we combine this with the dimensions of the variable part of the expression:\n$$ \\left[\\frac{Z^2 n_e n_i}{\\sqrt{T}}\\right] = \\frac{(1)(L^{-3})(L^{-3})}{K^{1/2}} = L^{-6}K^{-1/2} $$\nThe total dimension for $j_{\\nu}$ is the product of these two parts:\n$$ [j_{\\nu}] = [C_{ff}] \\times \\left[\\frac{n_e n_i}{\\sqrt{T}}\\right] = (M^1L^5T^{-2}K^{1/2}) \\times (L^{-6}K^{-1/2}) = M^1L^{-1}T^{-2} $$\nThe required units for $j_{\\nu}$ are $\\mathrm{erg\\,s^{-1}\\,cm^{-3}\\,Hz^{-1}\\,sr^{-1}}$. Let's find the corresponding base dimensions:\n- $[\\mathrm{erg}] = ML^2T^{-2}$\n- $[\\mathrm{s}^{-1}] = T^{-1}$\n- $[\\mathrm{cm}^{-3}] = L^{-3}$\n- $[\\mathrm{Hz}^{-1}] = [(\\text{s}^{-1})^{-1}] = T$\n- $[\\mathrm{sr}^{-1}]$ is dimensionless.\nThus, the target dimension is $(ML^2T^{-2})(T^{-1})(L^{-3})(T) = M^1L^{-1}T^{-2}$.\nOur derived dimension matches the target dimension exactly. The unit consistency check passes. The formula is dimensionally correct.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the thermal free-free emissivity j_nu for several test cases\n    and performs a programmatic dimensional analysis check.\n    \"\"\"\n    \n    # Scientific Constants in CGS units\n    # Electron charge (esu or statcoulomb)\n    e_esu = 4.80320451e-10\n    # Electron mass (g)\n    m_e = 9.1093837e-28\n    # Speed of light (cm/s)\n    c_light = 2.99792458e10\n    # Boltzmann constant (erg/K)\n    k_B = 1.380649e-16\n    # Planck constant (erg*s)\n    h = 6.62607015e-27\n\n    def check_units():\n        \"\"\"\n        Performs a dimensional analysis of the j_nu formula.\n        Dimensions are stored as tuples (M, L, T, K) representing the exponents\n        of Mass, Length, Time, and Temperature.\n        \"\"\"\n        \n        # Helper functions for dimensional arithmetic\n        def mul_dims(d1, d2):\n            return tuple(x + y for x, y in zip(d1, d2))\n\n        def div_dims(d1, d2):\n            return tuple(x - y for x, y in zip(d1, d2))\n\n        def pow_dims(d, p):\n            return tuple(x * p for x in d)\n\n        # Base dimensions in (M, L, T, K) format\n        # [e^2] = erg*cm = (ML^2T^-2)*L = ML^3T^-2\n        e2_dims = (1, 3, -2, 0)\n        m_dims = (1, 0, 0, 0)\n        c_dims = (0, 1, -1, 0)\n        # [k_B] = erg/K = ML^2T^-2K^-1\n        k_B_dims = (1, 2, -2, -1)\n        n_dims = (0, -3, 0, 0)\n        temp_dims = (0, 0, 0, 1)\n        \n        # Dimensions of the formula parts for j_nu\n        # j_nu = [8 e^6 / (3 m_e c^3)] * [sqrt(2*pi / (3 m_e k_B))] * [Z^2 n_e n_i / sqrt(T)]\n\n        # Constant part 1: [e^6 / (m_e * c^3)]\n        e6_dims = pow_dims(e2_dims, 3)\n        me_c3_dims = mul_dims(m_dims, pow_dims(c_dims, 3))\n        C1_dims = div_dims(e6_dims, me_c3_dims)\n\n        # Constant part 2: [1 / sqrt(m_e * k_B)]\n        me_kB_dims = mul_dims(m_dims, k_B_dims)\n        C2_dims = pow_dims(me_kB_dims, -0.5)\n\n        # Total constant dimensions\n        C_ff_dims = mul_dims(C1_dims, C2_dims)\n\n        # Variable part: [n_e * n_i / sqrt(T)]\n        n_prod_dims = mul_dims(n_dims, n_dims)\n        sqrt_T_dims = pow_dims(temp_dims, 0.5)\n        Var_part_dims = div_dims(n_prod_dims, sqrt_T_dims)\n\n        # Final dimension of j_nu\n        j_nu_dims = mul_dims(C_ff_dims, Var_part_dims)\n\n        # Target dimensions for erg * s^-1 * cm^-3 * Hz^-1\n        # (ML^2T^-2) * (T^-1) * (L^-3) * (T) = M^1 L^-1 T^-2\n        target_dims = (1.0, -1.0, -2.0, 0.0)\n\n        # Compare calculated dimensions to target dimensions\n        return all(np.isclose(j_nu_dims[i], target_dims[i]) for i in range(4))\n\n    unit_ok = check_units()\n    \n    # Test cases: (T in K, n_e in cm^-3, n_i in cm^-3, Z, nu in Hz)\n    test_cases = [\n        (1e7, 1e-3, 1e-3, 1, 1e9),\n        (1e8, 1e-6, 1e-6, 1, 1e18),\n        (1e4, 1e2, 5e1, 2, 1e12),\n        (1e5, 1.0, 1.0, 1, 1e3),\n    ]\n\n    results = []\n    \n    # Calculate the constant prefactor for j_nu once\n    # j_nu = C_ff * (Z^2 * n_e * n_i / sqrt(T)) * exp(-h*nu / (k_B*T))\n    C_ff = (8 * e_esu**6) / (3 * m_e * c_light**3) * np.sqrt((2 * np.pi) / (3 * m_e * k_B))\n    \n    for T, n_e, n_i, Z, nu in test_cases:\n        # Calculate the exponential suppression factor\n        exponent = -(h * nu) / (k_B * T)\n        # Avoid underflow with large negative exponent\n        exp_term = np.exp(exponent) if exponent > -700 else 0.0\n        \n        # Calculate the variable part of the expression\n        density_temp_term = (Z**2 * n_e * n_i) / np.sqrt(T)\n        \n        # Calculate j_nu in erg s^-1 cm^-3 Hz^-1 sr^-1\n        j_nu = C_ff * density_temp_term * exp_term\n        results.append(j_nu)\n        \n    # Append the boolean result of the unit check\n    results.append(unit_ok)\n    \n    # Format the final output string as specified\n    # The boolean should be lowercase 'true' or 'false' in the final string representation\n    output_str = f\"[{results[0]},{results[1]},{results[2]},{results[3]},{str(results[4]).lower()}]\"\n\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "With emissivity understood, the next step is to explore how this radiation interacts with the plasma it travels through. This exercise connects emission to absorption via Kirchhoff's law, a cornerstone of radiative transfer in thermal equilibrium. You will implement the free-free absorption coefficient, $\\alpha_\\nu$, and compute the optical depth, $\\tau_\\nu$, for various plasma density profiles, bridging the gap between local emission and the observable properties of a plasma slab .",
            "id": "4234190",
            "problem": "Consider a one-dimensional, plane-parallel, fully ionized hydrogen plasma slab in Local Thermodynamic Equilibrium (LTE), at constant temperature $T$ and ion charge number $Z=1$, with electron number density profile $n_e(s)$ along the line-of-sight coordinate $s \\in [0,L]$. The fundamental base is the radiative transfer equation $dI_\\nu/ds = -\\alpha_\\nu I_\\nu + j_\\nu$, the definition of the monochromatic optical depth $\\tau_\\nu = \\int_0^L \\alpha_\\nu(s)\\,ds$, energy equipartition for a Maxwell-Boltzmann electron distribution, Coulomb interaction between electrons and ions, and Kirchhoff's law in LTE $j_\\nu = \\alpha_\\nu B_\\nu(T)$, where $B_\\nu(T)$ is the Planck function. You are to derive, implement, and validate a routine to compute the thermal free-free (bremsstrahlung) absorption coefficient $\\alpha_\\nu$ and the resulting optical depth $\\tau_\\nu$ for given $n_e(s)$ and slab thickness $L$.\n\nYour derivation must proceed from the fundamental base, without using pre-stated shortcut formulas, and must incorporate the velocity-averaged Coulomb acceleration, the Maxwell-Boltzmann distribution, and Kirchhoff's law to connect emissivity to absorption. You may use standard physical constants and the concept of the free-free Gaunt factor $g_{\\mathrm{ff}}(\\nu,T)$ as a slowly varying dimensionless quantum correction. Assume $n_i(s) = n_e(s)$ for fully ionized hydrogen and $Z=1$, and treat $g_{\\mathrm{ff}}(\\nu,T)$ as frequency- and temperature-dependent but spatially constant for a uniform-$T$ slab. The final expressions must be implemented in centimeter-gram-second (cgs) units. Specifically:\n- Compute $\\alpha_\\nu(s)$ in $\\mathrm{cm}^{-1}$.\n- Compute $\\tau_\\nu = \\int_0^L \\alpha_\\nu(s)\\,ds$ (dimensionless).\n\nYou must validate the numerical line-of-sight integral against analytic slab solutions for $n_e(s)$ profiles where the integral can be evaluated in closed form. Use the following test suite, all in cgs units, and express frequencies in $\\mathrm{s}^{-1}$:\n- Test case $1$ (uniform slab, happy path): $T = 10^6\\,\\mathrm{K}$, $\\nu = 10^{10}\\,\\mathrm{s}^{-1}$, $Z=1$, $n_0 = 10^4\\,\\mathrm{cm}^{-3}$, $L = 3\\times 10^{18}\\,\\mathrm{cm}$, with $n_e(s) = n_0$. The analytic optical depth is $\\tau_\\nu^{\\mathrm{ana}} = \\alpha_\\nu(n_0)\\,L$.\n- Test case $2$ (exponential slab, gradient coverage): $T = 10^6\\,\\mathrm{K}$, $\\nu = 10^{10}\\,\\mathrm{s}^{-1}$, $Z=1$, $n_0 = 10^4\\,\\mathrm{cm}^{-3}$, $H = 10^{18}\\,\\mathrm{cm}$, $L = 3\\times 10^{18}\\,\\mathrm{cm}$, with $n_e(s) = n_0 \\exp(-s/H)$. The analytic optical depth is $\\tau_\\nu^{\\mathrm{ana}} = \\alpha_\\nu(n_0)\\,\\frac{H}{2}\\left(1 - e^{-2L/H}\\right)$.\n- Test case $3$ (Gaussian slab, finite-width coverage): $T = 10^6\\,\\mathrm{K}$, $\\nu = 10^{10}\\,\\mathrm{s}^{-1}$, $Z=1$, $n_0 = 10^4\\,\\mathrm{cm}^{-3}$, $\\sigma = 5\\times 10^{17}\\,\\mathrm{cm}$, $L = 3\\times 10^{18}\\,\\mathrm{cm}$, with $n_e(s) = n_0 \\exp\\!\\left(-\\frac{(s - L/2)^2}{2\\sigma^2}\\right)$. The analytic optical depth is $\\tau_\\nu^{\\mathrm{ana}} = K(T,\\nu)\\,g_{\\mathrm{ff}}(\\nu,T)\\,n_0^2\\,\\sqrt{\\pi}\\,\\sigma\\,\\mathrm{erf}\\!\\left(\\frac{L}{2\\sigma}\\right)$, where $K(T,\\nu)$ is the $n_e^2$ coefficient you derive in your $\\alpha_\\nu$ expression and $\\mathrm{erf}$ is the error function.\n- Test case $4$ (boundary condition): $T = 10^6\\,\\mathrm{K}$, $\\nu = 10^{10}\\,\\mathrm{s}^{-1}$, $Z=1$, $n_0 = 10^4\\,\\mathrm{cm}^{-3}$, $L = 0\\,\\mathrm{cm}$, with any $n_e(s)$; the analytic optical depth is $\\tau_\\nu^{\\mathrm{ana}} = 0$.\n\nYour program must:\n- Implement a function to compute $g_{\\mathrm{ff}}(\\nu,T)$ using a physically motivated approximation.\n- Implement a function to compute $\\alpha_\\nu(s)$ in $\\mathrm{cm}^{-1}$ using your derived expression, making explicit the dependence on $n_e(s)$, $n_i(s)$, $T$, $\\nu$, and $g_{\\mathrm{ff}}(\\nu,T)$.\n- Numerically integrate $\\alpha_\\nu(s)$ along $s \\in [0,L]$ to obtain $\\tau_\\nu$, and compare to the analytic $\\tau_\\nu^{\\mathrm{ana}}$ for each test case.\n- For test cases $1$ and $2$, treat the validation as passed if the relative error $|\\tau_\\nu^{\\mathrm{num}} - \\tau_\\nu^{\\mathrm{ana}}|/\\max(\\tau_\\nu^{\\mathrm{ana}}, 1)$ is less than $10^{-6}$. For test case $3$, treat the validation as passed if the relative error is less than $10^{-5}$. For test case $4$, the validation passes if $\\tau_\\nu^{\\mathrm{num}} = 0$ exactly.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry a boolean indicating pass or fail for the corresponding test case, in order $[1,2,3,4]$.\n\nAll quantities must be handled in cgs units. The output booleans must be printed exactly in the format $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$ on a single line.",
            "solution": "The derivation of the thermal free-free absorption coefficient, $\\alpha_\\nu$, begins by considering the emission process. The free-free volume emissivity, $j_\\nu$, represents the energy emitted per unit time, per unit volume, per unit frequency, and per unit solid angle. For a plasma in Local Thermodynamic Equilibrium (LTE), the emissivity is related to the absorption coefficient by Kirchhoff's Law:\n$$j_\\nu = \\alpha_\\nu B_\\nu(T)$$\nwhere $B_\\nu(T)$ is the Planck function for blackbody radiation at temperature $T$:\n$$B_\\nu(T) = \\frac{2h\\nu^3}{c^2} \\frac{1}{e^{h\\nu/k_B T} - 1}$$\nHere, $h$ is the Planck constant, $\\nu$ is the frequency, $c$ is the speed of light, and $k_B$ is the Boltzmann constant.\n\nThe total power radiated per unit volume per unit frequency, $\\epsilon_\\nu = 4\\pi j_\\nu$, is given by the standard result for thermal bremsstrahlung emissivity, incorporating the dimensionless Gaunt factor $g_{\\mathrm{ff}}(\\nu, T)$ to correct the classical calculation for quantum-mechanical effects:\n$$\\epsilon_\\nu = \\frac{2^5 \\pi Z^2 e^6}{3 m_e c^3} \\sqrt{\\frac{2\\pi}{3 k_B m_e}} T^{-1/2} n_e n_i \\, g_{\\mathrm{ff}}(\\nu, T) e^{-h\\nu/k_B T}$$\nwhere $e$ is the elementary charge, $m_e$ is the electron mass, $Z$ is the ion charge number, and $n_e$ and $n_i$ are the number densities of electrons and ions. For a fully ionized hydrogen plasma, $Z=1$ and $n_i(s) = n_e(s)$.\n\nThe absorption coefficient $\\alpha_\\nu$ is derived by solving for it from Kirchhoff's Law:\n$$\\alpha_\\nu = \\frac{j_\\nu}{B_\\nu(T)} = \\frac{\\epsilon_\\nu}{4\\pi B_\\nu(T)}$$\nSubstituting the expressions for $\\epsilon_\\nu$ and $B_\\nu(T)$:\n$$\\alpha_\\nu = \\frac{\\frac{2^5 \\pi Z^2 e^6}{3 m_e c^3} \\sqrt{\\frac{2\\pi}{3 k_B m_e}} T^{-1/2} n_e n_i \\, g_{\\mathrm{ff}} e^{-h\\nu/k_B T}}{4\\pi \\left( \\frac{2h\\nu^3}{c^2} \\frac{1}{e^{h\\nu/k_B T} - 1} \\right)}$$\nSimplifying this expression yields:\n$$\\alpha_\\nu = \\left( \\frac{4 e^6}{3 h c m_e} \\sqrt{\\frac{2\\pi}{3 k_B m_e}} \\right) Z^2 T^{-1/2} \\nu^{-3} n_e n_i \\, g_{\\mathrm{ff}}(\\nu, T) (1 - e^{-h\\nu/k_B T})$$\nThe term $(1 - e^{-h\\nu/k_B T})$ accounts for stimulated emission. Since $n_i(s) = n_e(s)$ and other properties are constant, we can write $\\alpha_\\nu(s) = C(T,\\nu,Z,g_{\\mathrm{ff}}) [n_e(s)]^2$, where $C$ is the coefficient that depends on temperature, frequency, and fundamental constants. This is the expression to be implemented.\n\nFor the Gaunt factor $g_{\\mathrm{ff}}(\\nu, T)$, a common approximation valid for the radio regime ($h\\nu \\ll k_B T$) is:\n$$g_{\\mathrm{ff}}(\\nu, T, Z) = \\frac{\\sqrt{3}}{2\\pi} \\ln \\left( \\frac{128(k_B T)^3}{m_e Z^2 e^4 (2\\pi \\nu)^2} \\right)$$\nThis formula captures the logarithmic dependence on plasma parameters and is used in the implementation.\n\nThe total optical depth $\\tau_\\nu$ along the line of sight from $s=0$ to $s=L$ is the integral of the absorption coefficient:\n$$\\tau_\\nu = \\int_0^L \\alpha_\\nu(s) ds = C(T,\\nu,Z,g_{\\mathrm{ff}}) \\int_0^L [n_e(s)]^2 ds$$\nThis integral is computed numerically and validated against the analytical solutions provided for the given density profiles.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Derives, implements, and validates a routine for computing thermal\n    bremsstrahlung absorption coefficient and optical depth in a plasma slab.\n    \"\"\"\n    \n    # Physical constants in CGS units\n    class Constants:\n        c = 2.99792458e10   # Speed of light (cm/s)\n        h = 6.62607015e-27   # Planck constant (erg*s)\n        k_B = 1.380649e-16   # Boltzmann constant (erg/K)\n        m_e = 9.1093837e-28  # Electron mass (g)\n        e = 4.803204e-10     # Elementary charge (esu or statcoulomb)\n\n    C = Constants\n\n    def gaunt_factor(T, nu, Z):\n        \"\"\"\n        Computes the free-free Gaunt factor using Spitzer's approximation\n        for the radio regime (h*nu  k_B*T).\n        \n        Args:\n            T (float): Temperature in K.\n            nu (float): Frequency in s^-1 (Hz).\n            Z (int): Ion charge number.\n            \n        Returns:\n            float: Dimensionless Gaunt factor g_ff.\n        \"\"\"\n        # Argument inside the logarithm\n        # This is derived from the ratio of max to min impact parameters.\n        # It's dimensionless in CGS units.\n        arg_num = 128 * (C.k_B * T)**3\n        arg_den = C.m_e * (Z**2) * (C.e**4) * (2 * np.pi * nu)**2\n        \n        # The argument must be > 1 for the log to be positive.\n        # This condition is met for typical astrophysical plasmas.\n        if arg_num / arg_den = 1.0:\n            return 1.0 # Fallback to a default value if argument is invalid\n            \n        g_ff = (np.sqrt(3) / (2 * np.pi)) * np.log(arg_num / arg_den)\n        return g_ff\n\n    def absorption_coefficient_factor(T, nu, Z, g_ff):\n        \"\"\"\n        Computes the spatially-invariant part of the absorption coefficient.\n        This is the factor C such that alpha_nu(s) = C * [n_e(s)]^2.\n        \n        Args:\n            T (float): Temperature in K.\n            nu (float): Frequency in s^-1 (Hz).\n            Z (int): Ion charge number.\n            g_ff (float): Gaunt factor.\n            \n        Returns:\n            float: The coefficient C in units of cm^5.\n        \"\"\"\n        # Algebraic constant prefactor\n        const_factor = ( (4 * C.e**6) / (3 * C.h * C.c * C.m_e) * \n                         np.sqrt((2 * np.pi) / (3 * C.k_B * C.m_e)) )\n        \n        # Term for stimulated emission\n        h_nu_over_kT = (C.h * nu) / (C.k_B * T)\n        stim_emission_factor = 1.0 - np.exp(-h_nu_over_kT)\n        \n        # Combine all parts\n        # C = const * Z^2 * T^(-1/2) * nu^(-3) * g_ff * (1 - exp(-h*nu/k_B*T))\n        # Units: [(erg*cm)^3 / (erg*s * cm/s * g * (erg/g)^1/2)] * [K^(-1/2) * s^3]\n        #      = [erg^3*cm^3 / (erg*g^1/2*cm*s^(-1/2))] * K^(-1/2) * s^3\n        # ... simplifying CGS dimensions leads to cm^5\n        factor = (const_factor * (Z**2) * (T**-0.5) * (nu**-3) * \n                  g_ff * stim_emission_factor)\n        \n        return factor\n\n    # Define the test cases from the problem statement.\n    # (T, nu, Z), (L, n0, H, sigma), density_func_gen, analytic_tau_func\n    test_cases = [\n        {\n            \"params\": {'T': 1e6, 'nu': 1e10, 'Z': 1},\n            \"geom\": {'L': 3e18, 'n0': 1e4},\n            \"ne_func\": lambda s, n0, **kwargs: n0,\n            \"ana_tau\": lambda C, L, n0, **kwargs: C * n0**2 * L,\n            \"err_tol\": 1e-6\n        },\n        {\n            \"params\": {'T': 1e6, 'nu': 1e10, 'Z': 1},\n            \"geom\": {'L': 3e18, 'n0': 1e4, 'H': 1e18},\n            \"ne_func\": lambda s, n0, H, **kwargs: n0 * np.exp(-s / H),\n            \"ana_tau\": lambda C, L, n0, H, **kwargs: C * n0**2 * (H / 2.0) * (1.0 - np.exp(-2 * L / H)),\n            \"err_tol\": 1e-6\n        },\n        {\n            \"params\": {'T': 1e6, 'nu': 1e10, 'Z': 1},\n            \"geom\": {'L': 3e18, 'n0': 1e4, 'sigma': 5e17},\n            \"ne_func\": lambda s, n0, L, sigma, **kwargs: n0 * np.exp(-(s - L / 2.0)**2 / (2 * sigma**2)),\n            \"ana_tau\": lambda C, L, n0, sigma, **kwargs: C * n0**2 * np.sqrt(np.pi) * sigma * erf(L / (2 * sigma)),\n            \"err_tol\": 1e-5\n        },\n        {\n            \"params\": {'T': 1e6, 'nu': 1e10, 'Z': 1},\n            \"geom\": {'L': 0.0, 'n0': 1e4},\n            \"ne_func\": lambda s, n0, **kwargs: n0,\n            \"ana_tau\": lambda C, L, **kwargs: 0.0,\n            \"err_tol\": 0.0 # Special case for exact zero\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        p = case[\"params\"]\n        g = case[\"geom\"]\n\n        # Calculate spatially-invariant factors\n        g_ff = gaunt_factor(p['T'], p['nu'], p['Z'])\n        alpha_factor = absorption_coefficient_factor(p['T'], p['nu'], p['Z'], g_ff)\n\n        # Calculate numerical optical depth\n        L = g['L']\n        if L == 0.0:\n            num_tau = 0.0\n        else:\n            # Integrand: alpha_nu(s) = C * [n_e(s)]^2\n            integrand = lambda s: alpha_factor * (case[\"ne_func\"](s, **g))**2\n            num_tau, _ = quad(integrand, 0, L)\n\n        # Calculate analytical optical depth\n        ana_tau = case[\"ana_tau\"](alpha_factor, **g)\n\n        # Validate the result\n        if L == 0.0:\n            passed = (num_tau == 0.0)\n        else:\n            # Use relative error, guarded against ana_tau being very small\n            # The problem specifies max(ana_tau, 1), which handles cases where\n            # the optical depth is small, effectively checking absolute error.\n            denominator = max(abs(ana_tau), 1.0)\n            rel_error = abs(num_tau - ana_tau) / denominator\n            passed = rel_error  case[\"err_tol\"]\n        \n        results.append(passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: str(b).lower(), results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Bremsstrahlung is not just an observable signature; it is also a crucial energy loss mechanism for hot plasmas. This final practice places bremsstrahlung in a dynamic context by having you calculate the plasma's radiative cooling timescale, $t_{\\mathrm{cool}}$. By comparing this to the fundamental collisional timescale for thermal equilibration, you will gain critical insight into whether a plasma's thermal state is governed by internal collisions or by radiative losses .",
            "id": "4234186",
            "problem": "A fully ionized, optically thin, pure hydrogen plasma is in thermal equilibrium with electron temperature $T$ equal to ion temperature $T$. Electrons have a nonrelativistic Maxwell–Boltzmann distribution. You may assume the standard, frequency-integrated thermal bremsstrahlung (free–free) emissivity applies with a slowly varying velocity-averaged Gaunt factor. The plasma parameters are:\n- electron number density $n_{e} = 1.0 \\times 10^{-3}\\ \\mathrm{cm}^{-3}$,\n- ion number density $n_{i} = 1.0 \\times 10^{-3}\\ \\mathrm{cm}^{-3}$,\n- temperature $T = 1.0 \\times 10^{8}\\ \\mathrm{K}$,\n- average ionic charge $Z = 1$,\n- velocity-averaged Gaunt factor $g_{ff} = 1.2$ (appropriate for the given temperature),\n- Coulomb logarithm $\\ln\\Lambda = 40$.\n\nStarting from first principles appropriate to nonrelativistic, weakly coupled astrophysical plasmas:\n1. Express the thermal energy density $U$ of the two-component plasma in terms of $n_{e}$, $n_{i}$, and $T$, using the ideal monatomic gas result.\n2. Write the frequency-integrated free–free emissivity $\\epsilon_{ff}$ in terms of fundamental constants, $Z$, $n_{e}$, $n_{i}$, $T$, and $g_{ff}$, and reduce it to a computable form suitable for the given plasma state.\n3. Define the radiative cooling time $t_{\\mathrm{cool}}$ as the ratio of $U$ to $\\epsilon_{ff}$ and obtain a closed-form expression.\n4. Using Landau–Spitzer theory for Coulomb collisions, derive the electron–ion energy equilibration timescale $t_{ei}$ for $T_{e}=T_{i}=T$, and reduce it to a computable form under the assumption $m_{i} \\gg m_{e}$.\n5. Compute the dimensionless ratio $R \\equiv t_{\\mathrm{cool}}/t_{ei}$ for the given parameters.\n\nUse cgs units consistently in intermediate steps. Report the single number $R$ rounded to three significant figures. Do not include any units with the final reported number.",
            "solution": "The problem requires the calculation of the ratio of the radiative cooling time to the electron-ion energy equilibration time for a specified hot, tenuous plasma. The problem is well-posed and scientifically sound. I will proceed by addressing each of the five parts sequentially, deriving the necessary expressions from fundamental principles of plasma physics.\n\n1. Thermal Energy Density ($U$)\nThe plasma is comprised of electrons and ions (protons, as it is pure hydrogen), both assumed to behave as ideal monatomic gases. The thermal energy density for a monatomic ideal gas is $U_{species} = \\frac{3}{2} n k_B T$, where $n$ is the number density and $T$ is the temperature. The total thermal energy density $U$ is the sum of the contributions from the electron and ion populations:\n$$U = U_e + U_i = \\frac{3}{2} n_e k_B T_e + \\frac{3}{2} n_i k_B T_i$$\nThe problem states the plasma is in thermal equilibrium, so $T_e = T_i = T$. For a pure hydrogen plasma ($Z=1$), charge neutrality requires the electron number density $n_e$ to be equal to the ion number density $n_i$. Therefore, $n_e = n_i$.\nSubstituting these conditions, the thermal energy density becomes:\n$$U = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_e k_B T = 3 n_e k_B T$$\n\n2. Frequency-Integrated Free–Free Emissivity ($\\epsilon_{ff}$)\nThermal bremsstrahlung, or free-free emission, is produced by the acceleration of electrons during collisions with ions. For a non-relativistic Maxwellian electron distribution, the frequency-integrated power radiated per unit volume, $\\epsilon_{ff}$, is given by the standard formula in cgs units:\n$$\\epsilon_{ff} = \\frac{2^5 \\pi e^6}{3 m_e c^3 h} \\left(\\frac{2 \\pi k_B T}{3 m_e}\\right)^{1/2} n_e n_i Z^2 g_{ff}$$\nwhere $e$ is the elementary charge, $m_e$ is the electron mass, $c$ is the speed of light, $h$ is Planck's constant, $k_B$ is the Boltzmann constant, and $g_{ff}$ is the velocity-averaged Gaunt factor.\nGiven $Z = 1$ and $n_i = n_e$, the expression simplifies to:\n$$\\epsilon_{ff} = \\frac{32 \\pi e^6}{3 h m_e c^3} \\left(\\frac{2 \\pi k_B}{3 m_e}\\right)^{1/2} n_e^2 g_{ff} T^{1/2}$$\nThis expression represents the computable form for the emissivity in terms of the given plasma parameters and fundamental constants.\n\n3. Radiative Cooling Time ($t_{\\mathrm{cool}}$)\nThe radiative cooling time, $t_{\\mathrm{cool}}$, is defined as the characteristic time for the plasma to radiate away its thermal energy. It is given by the ratio of the thermal energy density to the free-free emissivity:\n$$t_{\\mathrm{cool}} = \\frac{U}{\\epsilon_{ff}}$$\nSubstituting the expressions for $U$ and $\\epsilon_{ff}$:\n$$t_{\\mathrm{cool}} = \\frac{3 n_e k_B T}{\\frac{32 \\pi e^6}{3 h m_e c^3} \\left(\\frac{2 \\pi k_B}{3 m_e}\\right)^{1/2} n_e^2 g_{ff} T^{1/2}}$$\nSimplifying the expression by combining terms:\n$$t_{\\mathrm{cool}} = \\frac{9 \\sqrt{3} h c^3 m_e^{3/2} k_B^{1/2}}{32 \\pi \\sqrt{2 \\pi} e^6} \\frac{T^{1/2}}{n_e g_{ff}}$$\nThis is the closed-form expression for the cooling time, which scales as $T^{1/2}/n_e$.\n\n4. Electron-Ion Equilibration Timescale ($t_{ei}$)\nThe electron-ion energy equilibration timescale, $t_{ei}$, is the characteristic time for the electron and ion populations to reach thermal equilibrium through Coulomb collisions. According to Landau-Spitzer theory, for two species 'a' and 'b', the equilibration time is given by:\n$$t_{ab} = \\frac{3 m_a m_b k_B^{3/2}}{8 \\sqrt{2\\pi} n_b Z_a^2 Z_b^2 e^4 \\ln\\Lambda} \\left( \\frac{T_a}{m_a} + \\frac{T_b}{m_b} \\right)^{3/2}$$\nFor electron-ion equilibration ($a=e, b=i$), with $T_e = T_i = T$, ion charge $Z_i = Z$, electron charge $Z_e = 1$, and $m_i \\gg m_e$:\n$$\\frac{T_e}{m_e} + \\frac{T_i}{m_i} = T\\left(\\frac{1}{m_e} + \\frac{1}{m_i}\\right) \\approx \\frac{T}{m_e}$$\nSubstituting this approximation and the relevant parameters ($m_i = m_p$ for hydrogen, $n_i=n_e$, $Z=1$) into the general formula gives:\n$$t_{ei} = \\frac{3 m_e m_p k_B^{3/2}}{8 \\sqrt{2\\pi} n_e Z^2 e^4 \\ln\\Lambda} \\left( \\frac{T}{m_e} \\right)^{3/2} = \\frac{3 m_e m_p (k_B T)^{3/2}}{8 \\sqrt{2\\pi} n_e e^4 \\ln\\Lambda \\cdot m_e^{3/2}}$$\n$$t_{ei} = \\frac{3 m_p (k_B T)^{3/2}}{8 \\sqrt{2\\pi} n_e \\sqrt{m_e} e^4 \\ln\\Lambda}$$\nThis is the required computable form for the equilibration time, scaling as $T^{3/2}/n_e$.\n\n5. The Ratio $R \\equiv t_{\\mathrm{cool}}/t_{ei}$\nWe now compute the dimensionless ratio $R$:\n$$R = \\frac{t_{\\mathrm{cool}}}{t_{ei}} = \\frac{ \\frac{9 \\sqrt{3} h c^3 m_e^{3/2} k_B^{1/2} T^{1/2}}{32 \\pi \\sqrt{2\\pi} e^6 n_e g_{ff}} }{ \\frac{3 m_p k_B^{3/2} T^{3/2}}{8 \\sqrt{2\\pi} n_e \\sqrt{m_e} e^4 \\ln\\Lambda} }$$\nMany terms cancel, including $n_e$, $\\sqrt{2\\pi}$, and powers of constants:\n$$R = \\left( \\frac{9 \\sqrt{3}}{32 \\pi} \\frac{h c^3 m_e^{3/2}}{e^6 g_{ff}} \\right) \\left( \\frac{8 e^4 \\sqrt{m_e} \\ln\\Lambda}{3 m_p k_B} \\right) \\frac{k_B^{1/2} T^{1/2}}{k_B^{3/2} T^{3/2}}$$\n$$R = \\frac{72 \\sqrt{3}}{96 \\pi} \\frac{h c^3 m_e^2}{m_p e^2 k_B} \\frac{\\ln\\Lambda}{g_{ff} T} = \\frac{3\\sqrt{3}}{4\\pi} \\frac{h c^3 m_e^2}{m_p e^2 k_B} \\frac{\\ln\\Lambda}{g_{ff} T}$$\nThis expression can be conveniently rewritten using the fine-structure constant $\\alpha = e^2/(\\hbar c) = e^2/(h c / (2\\pi))$ and the rest-mass energy of the electron $m_e c^2$:\n$$R = \\frac{3\\sqrt{3}}{4\\pi} \\frac{(2\\pi \\hbar) c^3 m_e^2}{m_p e^2 k_B T} \\frac{\\ln\\Lambda}{g_{ff}} = \\frac{3\\sqrt{3}}{2} \\left(\\frac{\\hbar c}{e^2}\\right) \\frac{m_e^2 c^2}{m_p k_B T} \\frac{\\ln\\Lambda}{g_{ff}}$$\n$$R = \\frac{3\\sqrt{3}}{2} \\frac{1}{\\alpha} \\left(\\frac{m_e}{m_p}\\right) \\left(\\frac{m_e c^2}{k_B T}\\right) \\frac{\\ln\\Lambda}{g_{ff}}$$\nNow, we substitute the given values: $T = 1.0 \\times 10^8 \\ \\mathrm{K}$, $g_{ff} = 1.2$, and $\\ln\\Lambda = 40$. We use the following cgs constants and derived values:\n$\\alpha \\approx 1/137.036$\n$m_e/m_p \\approx 1/1836.15$\n$m_e c^2 \\approx 8.187 \\times 10^{-7} \\ \\mathrm{erg}$\n$k_B \\approx 1.381 \\times 10^{-16} \\ \\mathrm{erg} \\cdot \\mathrm{K}^{-1}$\nThe energy ratio is:\n$$\\frac{m_e c^2}{k_B T} = \\frac{8.187 \\times 10^{-7} \\ \\mathrm{erg}}{ (1.381 \\times 10^{-16} \\ \\mathrm{erg} \\cdot \\mathrm{K}^{-1}) (1.0 \\times 10^8 \\ \\mathrm{K}) } \\approx 59.28$$\nPlugging into the expression for $R$:\n$$R \\approx \\frac{3\\sqrt{3}}{2} \\cdot (137.036) \\cdot \\left(\\frac{1}{1836.15}\\right) \\cdot (59.28) \\cdot \\frac{40}{1.2}$$\n$$R \\approx (2.598) \\cdot (137.036) \\cdot (5.446 \\times 10^{-4}) \\cdot (59.28) \\cdot (33.333)$$\n$$R \\approx 383.19$$\nRounding to three significant figures, the final result is $383$. This indicates that for this particular plasma, the electron-ion equilibration time is significantly shorter than the radiative cooling time.",
            "answer": "$$\\boxed{383}$$"
        }
    ]
}