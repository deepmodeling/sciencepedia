{
    "hands_on_practices": [
        {
            "introduction": "磁声波的通用色散关系可能很复杂。然而，在许多天体物理环境中，例如日冕或吸积盘大气，等离子体贝塔值（$\\beta$）要么非常低，要么非常高。这项练习  要求你运用渐近分析，在至关重要的低$\\beta$极限下推导慢磁声波速度的简化形式，为解释磁主导等离子体中的观测数据提供一个强有力的工具。",
            "id": "4215368",
            "problem": "考虑一个由理想磁流体动力学（Magnetohydrodynamics (MHD)）描述的均匀、理想导电等离子体，其平衡态物理量 $p_{0}$、$\\rho_{0}$ 为常数，并存在一个沿 $\\hat{\\mathbf{z}}$ 方向的均匀磁场 $\\mathbf{B}_{0}$。假设在该平衡态附近存在小振幅扰动，其中速度扰动为 $\\delta \\mathbf{v}$，磁场扰动为 $\\delta \\mathbf{B}$，密度扰动为 $\\delta \\rho$，压力扰动为 $\\delta p$，所有扰动均以平面波形式 $\\propto \\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]$ 变化。设波矢 $\\mathbf{k}$ 位于 $x$-$z$ 平面内，与 $\\mathbf{B}_{0}$ 形成角度 $\\theta$，其中 $0 \\leq \\theta \\leq \\pi/2$。绝热声速为 $c_{s}^{2} = \\gamma p_{0}/\\rho_{0}$，其中 $\\gamma$ 为绝热指数，阿尔芬速度为 $v_{A}^{2} = B_{0}^{2}/(\\mu_0 \\rho_{0})$，其中 $\\mu_0$ 是真空磁导率。定义等离子体贝塔值为 $\\beta = p_{0} / (B_{0}^{2} / (2\\mu_0))$。在整个问题中，角度 $\\theta$ 以弧度为单位。\n\n从基本的理想磁流体力学（MHD）方程组出发：\n$\\partial_{t}\\rho + \\nabla\\cdot(\\rho \\mathbf{v}) = 0$,\n$\\rho \\partial_{t}\\mathbf{v} = -\\nabla p + \\frac{1}{\\mu_0}(\\nabla\\times\\mathbf{B})\\times\\mathbf{B}$,\n$\\partial_{t}\\mathbf{B} = \\nabla\\times(\\mathbf{v}\\times\\mathbf{B})$,\n$\\delta p = c_{s}^{2}\\delta \\rho$,\n围绕均匀平衡态进行线性化，推导出控制可压缩磁声波模式（快波和慢波）的色散关系。利用该色散关系，确定低等离子体贝塔值和高等离子体贝塔值的极限情况，并确定相速度的角度行为。\n\n最后，在低贝塔值极限 $\\beta \\ll 1$ 的情况下，给出由 $v_{A}$ 归一化的慢磁声波相速度 $v_{s}(\\theta)$ 的领头阶闭式解析表达式，该表达式是 $\\gamma$、$\\beta$ 和 $\\theta$ 的函数。你的最终答案必须是单一的闭式解析表达式。无需进行数值计算，最终表达式中不应包含单位。",
            "solution": "我们首先围绕一个由密度 $\\rho_{0}$、压力 $p_{0}$ 和磁场 $\\mathbf{B}_{0} = B_{0}\\hat{\\mathbf{z}}$ 表征的静态、均匀平衡态对理想磁流体力学（MHD）方程组进行线性化。平衡速度为 $\\mathbf{v}_0 = \\mathbf{0}$。扰动量用 $\\delta\\rho$、$\\delta p$、$\\delta \\mathbf{v}$ 和 $\\delta \\mathbf{B}$ 表示。\n\n线性化的理想MHD方程组为：\n1.  连续性方程：$\\partial_{t}(\\delta\\rho) + \\rho_{0}\\nabla\\cdot(\\delta\\mathbf{v}) = 0$\n2.  动量方程：$\\rho_{0}\\partial_{t}(\\delta\\mathbf{v}) = -\\nabla(\\delta p) + \\frac{1}{\\mu_0}(\\nabla\\times\\delta\\mathbf{B})\\times\\mathbf{B}_{0}$\n3.  感应方程：$\\partial_{t}(\\delta\\mathbf{B}) = \\nabla\\times(\\delta\\mathbf{v}\\times\\mathbf{B}_{0})$\n4.  绝热状态方程：$\\delta p = c_{s}^{2}\\delta\\rho$，其中 $c_{s}^{2} = \\gamma p_{0}/\\rho_{0}$。\n\n我们假设所有扰动量都具有平面波解，形式为 $\\propto \\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]$。这使我们可以用代数乘子替换微分算子：$\\partial_{t} \\rightarrow -i\\omega$ 和 $\\nabla \\rightarrow i\\mathbf{k}$。\n\n将此应用于线性化方程，得到：\n1.  $-i\\omega\\delta\\rho + i\\rho_{0}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) = 0 \\implies \\delta\\rho = \\frac{\\rho_{0}}{\\omega}(\\mathbf{k}\\cdot\\delta\\mathbf{v})$\n2.  $-i\\omega\\rho_{0}\\delta\\mathbf{v} = -i\\mathbf{k}\\delta p + \\frac{1}{\\mu_0}(i\\mathbf{k}\\times\\delta\\mathbf{B})\\times\\mathbf{B}_{0}$\n3.  $-i\\omega\\delta\\mathbf{B} = i\\mathbf{k}\\times(\\delta\\mathbf{v}\\times\\mathbf{B}_{0})$\n4.  $\\delta p = c_{s}^{2}\\delta\\rho = \\frac{c_{s}^{2}\\rho_{0}}{\\omega}(\\mathbf{k}\\cdot\\delta\\mathbf{v})$\n\n从感应方程(3)中，我们将 $\\delta\\mathbf{B}$ 用 $\\delta\\mathbf{v}$ 表示：\n$$ \\delta\\mathbf{B} = -\\frac{1}{\\omega}\\mathbf{k}\\times(\\delta\\mathbf{v}\\times\\mathbf{B}_{0}) = -\\frac{1}{\\omega}[(\\mathbf{k}\\cdot\\mathbf{B}_{0})\\delta\\mathbf{v} - (\\mathbf{k}\\cdot\\delta\\mathbf{v})\\mathbf{B}_{0}] $$\n现在，我们将 $\\delta p$ 和 $\\delta\\mathbf{B}$ 的表达式代入动量方程(2)：\n$$ \\omega\\rho_{0}\\delta\\mathbf{v} = \\mathbf{k}\\left(\\frac{c_{s}^{2}\\rho_{0}}{\\omega}(\\mathbf{k}\\cdot\\delta\\mathbf{v})\\right) - \\frac{1}{\\mu_0\\omega} ( \\mathbf{k} \\times [(\\mathbf{k}\\cdot\\mathbf{B}_{0})\\delta\\mathbf{v} - (\\mathbf{k}\\cdot\\delta\\mathbf{v})\\mathbf{B}_{0}] ) \\times \\mathbf{B}_{0} $$\n两边乘以 $\\omega$ 并重新整理，得到关于 $\\delta\\mathbf{v}$ 的波动方程：\n$$ \\omega^{2}\\rho_{0}\\delta\\mathbf{v} = c_{s}^{2}\\rho_{0}\\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) - \\frac{1}{\\mu_0} \\left[ \\mathbf{k}\\times((\\mathbf{k}\\cdot\\mathbf{B}_{0})\\delta\\mathbf{v}) - \\mathbf{k}\\times((\\mathbf{k}\\cdot\\delta\\mathbf{v})\\mathbf{B}_{0}) \\right]\\times\\mathbf{B}_{0} $$\n展开三重向量积并使用向量恒等式 $\\mathbf{A}\\times(\\mathbf{B}\\times\\mathbf{C}) = \\mathbf{B}(\\mathbf{A}\\cdot\\mathbf{C})-\\mathbf{C}(\\mathbf{A}\\cdot\\mathbf{B})$，我们得到：\n$$ \\omega^{2}\\rho_{0}\\delta\\mathbf{v} = c_{s}^{2}\\rho_{0}\\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) + (\\mathbf{k}\\cdot\\mathbf{B}_{0})^{2}\\frac{\\delta\\mathbf{v}}{\\mu_0} - (\\mathbf{k}\\cdot\\mathbf{B}_{0})\\frac{\\mathbf{B}_{0}}{\\mu_0}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) - (\\mathbf{k}\\cdot\\mathbf{B}_{0})\\frac{\\mathbf{k}}{\\mu_0}(\\delta\\mathbf{v}\\cdot\\mathbf{B}_{0}) + B_{0}^{2}\\frac{\\mathbf{k}}{\\mu_0}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) $$\n我们引入阿尔芬速度 $v_{A}^{2} = B_{0}^{2}/(\\mu_0 \\rho_{0})$ 并将整个方程除以 $\\rho_{0}$：\n$$ \\omega^{2}\\delta\\mathbf{v} = c_{s}^{2}\\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) + \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_{0})^{2}}{\\mu_0\\rho_{0}}\\delta\\mathbf{v} - \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_{0})\\mathbf{B}_{0}}{\\mu_0\\rho_{0}}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) - \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_{0})\\mathbf{k}}{\\mu_0\\rho_{0}}(\\delta\\mathbf{v}\\cdot\\mathbf{B}_{0}) + v_{A}^{2}\\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{v}) $$\n令 $v_{ph} = \\omega/k$ 为相速度。波矢 $\\mathbf{k}$ 与 $\\mathbf{B}_{0}$ 形成角度 $\\theta$，因此 $\\mathbf{k}\\cdot\\mathbf{B}_{0} = kB_{0}\\cos\\theta$。\n$$ v_{ph}^{2}\\delta\\mathbf{v} = c_{s}^{2}\\hat{\\mathbf{k}}(\\hat{\\mathbf{k}}\\cdot\\delta\\mathbf{v}) + v_{A}^{2}\\cos^{2}\\theta\\,\\delta\\mathbf{v} - v_{A}^{2}\\cos\\theta\\,\\hat{\\mathbf{B}}_{0}(\\hat{\\mathbf{k}}\\cdot\\delta\\mathbf{v}) - v_{A}^{2}\\cos\\theta\\,\\hat{\\mathbf{k}}(\\delta\\mathbf{v}\\cdot\\hat{\\mathbf{B}}_{0}) + v_{A}^{2}\\hat{\\mathbf{k}}(\\hat{\\mathbf{k}}\\cdot\\delta\\mathbf{v}) $$\n其中 $\\hat{\\mathbf{k}}=\\mathbf{k}/k$ 且 $\\hat{\\mathbf{B}}_{0}=\\mathbf{B}_{0}/B_{0}$。重新组合各项，得到：\n$$ (v_{ph}^{2} - v_{A}^{2}\\cos^{2}\\theta)\\delta\\mathbf{v} = (c_{s}^{2}+v_{A}^{2})\\hat{\\mathbf{k}}(\\hat{\\mathbf{k}}\\cdot\\delta\\mathbf{v}) - v_{A}^{2}\\cos\\theta[\\hat{\\mathbf{B}}_{0}(\\hat{\\mathbf{k}}\\cdot\\delta\\mathbf{v}) + \\hat{\\mathbf{k}}(\\delta\\mathbf{v}\\cdot\\hat{\\mathbf{B}}_{0})] $$\n该方程支持三种波模。一种是剪切阿尔芬波，它是不可压缩的，其扰动垂直于 $\\mathbf{k}$-$\\mathbf{B}_{0}$ 平面。其色散关系为 $v_{ph}^{2} = v_{A}^{2}\\cos^{2}\\theta$。另外两种是快磁声波和慢磁声波，它们是可压缩的，其极化在 $\\mathbf{k}$-$\\mathbf{B}_{0}$ 平面内。\n\n为了求出磁声波模式的色散关系，我们建立一个坐标系，其中 $\\mathbf{B}_{0}=B_{0}\\hat{\\mathbf{z}}$ 且 $\\mathbf{k}=k(\\sin\\theta\\hat{\\mathbf{x}} + \\cos\\theta\\hat{\\mathbf{z}})$。我们考虑在 $x$-$z$ 平面内的扰动 $\\delta\\mathbf{v}$，即 $\\delta\\mathbf{v} = \\delta v_{x}\\hat{\\mathbf{x}} + \\delta v_{z}\\hat{\\mathbf{z}}$。将波动方程投影到 $\\hat{\\mathbf{x}}$ 和 $\\hat{\\mathbf{z}}$ 轴上，得到一个关于 $\\delta v_{x}$ 和 $\\delta v_{z}$ 的 $2\\times2$ 线性方程组。该方程组有非平庸解的条件是其系数矩阵的行列式为零。经过计算，得到磁声波模式的色散关系：\n$$ v_{ph}^{4} - (v_{A}^{2} + c_{s}^{2})v_{ph}^{2} + v_{A}^{2}c_{s}^{2}\\cos^{2}\\theta = 0 $$\n这是一个关于 $v_{ph}^{2}$ 的二次方程。两个解分别对应快磁声波和慢磁声波模式：\n$$ v_{f,s}^{2} = \\frac{1}{2}\\left[ (v_{A}^{2} + c_{s}^{2}) \\pm \\sqrt{(v_{A}^{2} + c_{s}^{2})^{2} - 4v_{A}^{2}c_{s}^{2}\\cos^{2}\\theta} \\right] $$\n慢波模式对应负号。我们关心的是低贝塔值极限，即 $\\beta \\ll 1$。等离子体贝塔值定义为 $\\beta = p_{0} / (B_{0}^{2}/(2\\mu_0))$。我们可以通过 $\\beta$ 将 $c_{s}^{2}$ 和 $v_{A}^{2}$ 联系起来：\n$$ \\frac{c_{s}^{2}}{v_{A}^{2}} = \\frac{\\gamma p_{0}/\\rho_{0}}{B_{0}^{2}/(\\mu_0\\rho_{0})} = \\frac{\\gamma p_0 \\mu_0}{B_{0}^{2}} = \\frac{\\gamma}{2}\\frac{2 p_0 \\mu_0}{B_{0}^{2}} = \\frac{\\gamma\\beta}{2} $$\n条件 $\\beta \\ll 1$ 意味着 $c_{s}^{2} \\ll v_{A}^{2}$。我们来分析慢波模式的速度 $v_{s}^{2}$。\n$$ v_{s}^{2} = \\frac{1}{2}\\left[ (v_{A}^{2} + c_{s}^{2}) - \\sqrt{(v_{A}^{2} + c_{s}^{2})^{2} - 4v_{A}^{2}c_{s}^{2}\\cos^{2}\\theta} \\right] $$\n从表达式中提出因子 $v_{A}^{2}$：\n$$ v_{s}^{2} = \\frac{v_{A}^{2}}{2}\\left[ \\left(1 + \\frac{c_{s}^{2}}{v_{A}^{2}}\\right) - \\sqrt{\\left(1 + \\frac{c_{s}^{2}}{v_{A}^{2}}\\right)^{2} - 4\\frac{c_{s}^{2}}{v_{A}^{2}}\\cos^{2}\\theta} \\right] $$\n令 $\\epsilon = c_{s}^{2}/v_{A}^{2} = \\gamma\\beta/2$，这是一个小参数。\n$$ \\frac{v_{s}^{2}}{v_{A}^{2}} = \\frac{1}{2}\\left[ (1+\\epsilon) - \\sqrt{(1+\\epsilon)^{2} - 4\\epsilon\\cos^{2}\\theta} \\right] $$\n我们将平方根内的项展开到 $\\epsilon$ 的一阶：\n$$ \\sqrt{1+2\\epsilon+\\epsilon^2 - 4\\epsilon\\cos^{2}\\theta} \\approx \\sqrt{1+2\\epsilon(1-2\\cos^{2}\\theta)} $$\n对小量 $x$ 使用二项式近似 $\\sqrt{1+x} \\approx 1+x/2$：\n$$ \\approx 1 + \\frac{1}{2} \\left[ 2\\epsilon(1-2\\cos^{2}\\theta) \\right] = 1 + \\epsilon(1-2\\cos^{2}\\theta) $$\n将此代回 $v_{s}^{2}/v_{A}^{2}$ 的表达式中：\n$$ \\frac{v_{s}^{2}}{v_{A}^{2}} \\approx \\frac{1}{2} \\left[ (1+\\epsilon) - (1 + \\epsilon(1-2\\cos^{2}\\theta)) \\right] = \\frac{1}{2} [\\epsilon - \\epsilon + 2\\epsilon\\cos^{2}\\theta] = \\epsilon\\cos^{2}\\theta $$\n代回 $\\epsilon = \\gamma\\beta/2$：\n$$ \\frac{v_{s}^{2}}{v_{A}^{2}} = \\frac{\\gamma\\beta}{2}\\cos^{2}\\theta $$\n取平方根得到归一化的慢磁声波相速度：\n$$ \\frac{v_{s}(\\theta)}{v_{A}} = \\sqrt{\\frac{\\gamma\\beta}{2}}|\\cos\\theta| $$\n题目规定 $0 \\leq \\theta \\leq \\pi/2$，此时 $\\cos\\theta \\geq 0$。因此，$|\\cos\\theta| = \\cos\\theta$。\n最终的领头阶表达式为：\n$$ \\frac{v_{s}(\\theta)}{v_{A}} = \\sqrt{\\frac{\\gamma\\beta}{2}}\\cos\\theta $$\n这代表了一种沿磁力线传播的类声波，在低$\\beta$等离子体中，其速度远小于阿尔芬速度。",
            "answer": "$$ \\boxed{\\sqrt{\\frac{\\gamma \\beta}{2}} \\cos(\\theta)} $$"
        },
        {
            "introduction": "理解波速只是问题的一部分；更深层的物理洞察力来自于对驱动波动的恢复力的理解。在这个问题中 ，你将把洛伦兹力分解为两个基本组成部分：磁压力和磁张力。通过分析它们的相对贡献，你将为这些波如何通过磁化介质传播建立一个更直观的模型。",
            "id": "4215364",
            "problem": "一种由理想磁流体动力学 (MHD) 描述的均匀导电流体，其平衡质量密度为 $\\rho_{0}$，热压强为 $p_{0}$，并且存在一个均匀的背景磁场 $\\mathbf{B}_{0} = B_{0} \\hat{\\mathbf{z}}$。考虑声速为 $c_{s}$ 的小振幅绝热扰动，其具有平面波形式 $\\exp(i \\mathbf{k} \\cdot \\mathbf{r} - i \\omega t)$，其中波矢 $\\mathbf{k}$ 位于 $x$–$z$ 平面内，$\\mathbf{k} = k \\sin\\theta \\, \\hat{\\mathbf{x}} + k \\cos\\theta \\, \\hat{\\mathbf{z}}$，与 $\\mathbf{B}_{0}$ 成 $\\theta$ 角。设流体位移为 $\\boldsymbol{\\xi} = \\xi_{x} \\hat{\\mathbf{x}} + \\xi_{z} \\hat{\\mathbf{z}}$。\n\n从线性化的理想 MHD 方程（连续性、动量和感应方程）出发，并使用将线性化洛伦兹力分解为磁压梯度项和磁张力项的矢量恒等式，推导恢复力中磁压贡献的 $x$ 分量和磁张力贡献的 $x$ 分量关于 $k$、$\\theta$、$B_{0}$ 和 $\\xi_{x}$ 的表达式。然后，特别考虑快磁声模，确定在哪个传播角 $\\theta$ 下，沿着本征位移方向、作用于恢复加速度的 $x$ 方向磁压贡献和磁张力贡献的量值相等。\n\n以弧度表示最终角度，并提供一个精确值或一个闭合解析表达式。无需四舍五入。",
            "solution": "流体元的线性化运动方程由下式给出：\n$$\n\\rho_{0} \\frac{\\partial^2 \\boldsymbol{\\xi}}{\\partial t^2} = -\\nabla p_1 + \\mathbf{F}_L\n$$\n其中 $\\rho_0$ 是平衡质量密度，$\\boldsymbol{\\xi}$ 是流体位移，$p_1$ 是一阶压强扰动，$\\mathbf{F}_L$ 是线性化洛伦兹力密度。对于平面波扰动 $\\propto \\exp(i \\mathbf{k} \\cdot \\mathbf{r} - i \\omega t)$，时间导数 $\\frac{\\partial}{\\partial t}$ 变为 $-i\\omega$，梯度算子 $\\nabla$ 变为 $i\\mathbf{k}$。\n\n问题要求我们使用将洛伦兹力分解为磁压和磁张力的矢量恒等式。完整的洛伦兹力密度 $\\mathbf{j} \\times \\mathbf{B}$ 可写为：\n$$\n\\mathbf{j} \\times \\mathbf{B} = \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}) \\times \\mathbf{B} = -\\nabla\\left(\\frac{B^2}{2\\mu_0}\\right) + \\frac{1}{\\mu_0}(\\mathbf{B} \\cdot \\nabla)\\mathbf{B}\n$$\n右边的第一项是磁压力，第二项是磁张力。为了找到线性化版本，我们代入 $\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_1$ 并保留一阶项。鉴于 $\\mathbf{B}_0$ 是均匀且恒定的：\n- 线性化磁压力为 $\\mathbf{F}_{P1} = -\\nabla\\left(\\frac{\\mathbf{B}_0 \\cdot \\mathbf{B}_1}{\\mu_0}\\right)$。\n- 线性化磁张力为 $\\mathbf{F}_{T1} = \\frac{1}{\\mu_0}(\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{B}_1$。\n\n为了计算这些力，我们首先需要扰动磁场 $\\mathbf{B}_1$。根据理想 MHD 感应方程，对于理想导电流体，$\\mathbf{B}_1$ 由下式给出：\n$$\n\\mathbf{B}_1 = \\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0)\n$$\n给定 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 和 $\\boldsymbol{\\xi} = \\xi_x \\hat{\\mathbf{x}} + \\xi_z \\hat{\\mathbf{z}}$，叉积为：\n$$\n\\boldsymbol{\\xi} \\times \\mathbf{B}_0 = (\\xi_x \\hat{\\mathbf{x}} + \\xi_z \\hat{\\mathbf{z}}) \\times (B_0 \\hat{\\mathbf{z}}) = \\xi_x B_0 (\\hat{\\mathbf{x}} \\times \\hat{\\mathbf{z}}) = -\\xi_x B_0 \\hat{\\mathbf{y}}\n$$\n现在，我们取其旋度：\n$$\n\\mathbf{B}_1 = \\nabla \\times (-\\xi_x B_0 \\hat{\\mathbf{y}}) = -B_0 \\begin{vmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ \\partial_x & \\partial_y & \\partial_z \\\\ 0 & \\xi_x & 0 \\end{vmatrix} = -B_0 \\left( -\\frac{\\partial \\xi_x}{\\partial z} \\hat{\\mathbf{x}} + \\frac{\\partial \\xi_x}{\\partial x} \\hat{\\mathbf{z}} \\right) = B_0 \\left( \\frac{\\partial \\xi_x}{\\partial z} \\hat{\\mathbf{x}} - \\frac{\\partial \\xi_x}{\\partial x} \\hat{\\mathbf{z}} \\right)\n$$\n注意到 $\\mathbf{B}_1$ 仅取决于垂直于 $\\mathbf{B}_0$ 的位移分量 $\\xi_x$。这是因为平行位移 $\\xi_z$ 仅使流体沿磁力线滑动，这不会扰动一个均匀磁场。应用平面波形式 $\\nabla \\rightarrow i\\mathbf{k}$，其中 $\\mathbf{k} = k_x \\hat{\\mathbf{x}} + k_z \\hat{\\mathbf{z}}$ 且 $k_x = k \\sin\\theta$ 和 $k_z = k \\cos\\theta$：\n$$\n\\mathbf{B}_1 = B_0 (i k_z \\xi_x \\hat{\\mathbf{x}} - i k_x \\xi_x \\hat{\\mathbf{z}}) = i B_0 \\xi_x (k_z \\hat{\\mathbf{x}} - k_x \\hat{\\mathbf{z}})\n$$\n\n现在我们可以按要求计算磁力的 $x$ 分量。\n\n**1. 磁压贡献：**\n该力为 $\\mathbf{F}_{P1} = - \\nabla \\left( \\frac{\\mathbf{B}_0 \\cdot \\mathbf{B}_1}{\\mu_0} \\right)$。首先，计算标量积：\n$$\n\\mathbf{B}_0 \\cdot \\mathbf{B}_1 = (B_0 \\hat{\\mathbf{z}}) \\cdot [i B_0 \\xi_x (k_z \\hat{\\mathbf{x}} - k_x \\hat{\\mathbf{z}})] = -i k_x B_0^2 \\xi_x\n$$\n现在，应用梯度算子 $-i\\mathbf{k}$：\n$$\n\\mathbf{F}_{P1} = -i\\mathbf{k} \\left( \\frac{-i k_x B_0^2 \\xi_x}{\\mu_0} \\right) = -(i)(-i) \\frac{\\mathbf{k} k_x B_0^2 \\xi_x}{\\mu_0} = - \\frac{k_x B_0^2}{\\mu_0} (k_x \\hat{\\mathbf{x}} + k_z \\hat{\\mathbf{z}}) \\xi_x\n$$\n力中磁压贡献的 $x$ 分量为：\n$$\nF_{P1, x} = - \\frac{k_x^2 B_0^2}{\\mu_0} \\xi_x = - \\frac{k^2 B_0^2 \\sin^2\\theta}{\\mu_0} \\xi_x\n$$\n\n**2. 磁张力贡献：**\n该力为 $\\mathbf{F}_{T1} = \\frac{1}{\\mu_0}(\\mathbf{B}_0 \\cdot \\nabla)\\mathbf{B}_1$。算子 $(\\mathbf{B}_0 \\cdot \\nabla)$ 变为 $B_0 (i k_z)$：\n$$\n\\mathbf{F}_{T1} = \\frac{1}{\\mu_0} (i k_z B_0) \\mathbf{B}_1 = \\frac{i k_z B_0}{\\mu_0} [i B_0 \\xi_x (k_z \\hat{\\mathbf{x}} - k_x \\hat{\\mathbf{z}})] = -\\frac{k_z B_0^2 \\xi_x}{\\mu_0} (k_z \\hat{\\mathbf{x}} - k_x \\hat{\\mathbf{z}})\n$$\n力中磁张力贡献的 $x$ 分量为：\n$$\nF_{T1, x} = - \\frac{k_z^2 B_0^2}{\\mu_0} \\xi_x = - \\frac{k^2 B_0^2 \\cos^2\\theta}{\\mu_0} \\xi_x\n$$\n这些是磁力贡献的 $x$ 分量的表达式。它们都是恢复力，因此带有负号。\n\n**3. 量值相等的条件：**\n问题要求的是，对于快磁声模，在哪个角度 $\\theta$ 下，对恢复*加速度*的 $x$ 方向贡献的量值相等。加速度分量就是力分量除以密度 $\\rho_0$：\n$$\na_{P1, x} = \\frac{F_{P1, x}}{\\rho_0} = - \\frac{k^2 B_0^2 \\sin^2\\theta}{\\mu_0 \\rho_0} \\xi_x\n$$\n$$\na_{T1, x} = \\frac{F_{T1, x}}{\\rho_0} = - \\frac{k^2 B_0^2 \\cos^2\\theta}{\\mu_0 \\rho_0} \\xi_x\n$$\n它们的量值相等的条件是 $|a_{P1, x}| = |a_{T1, x}|$，这等价于 $|F_{P1, x}| = |F_{T1, x}|$。\n$$\n\\left| - \\frac{k^2 B_0^2 \\sin^2\\theta}{\\mu_0 \\rho_0} \\xi_x \\right| = \\left| - \\frac{k^2 B_0^2 \\cos^2\\theta}{\\mu_0 \\rho_0} \\xi_x \\right|\n$$\n“特别考虑快磁声模”和“本征位移”这两个表述至关重要，因为它确保了我们考虑的是一个物理波模，对于斜向传播角（$\\theta \\neq 0$），其位移分量 $\\xi_x$ 通常不为零。如果 $\\xi_x$ 为零，那么磁力贡献将平凡地为零且相等。对于一般角度下的快模，$\\xi_x \\neq 0$。此外，我们假设 $k \\neq 0$ 和 $B_0 \\neq 0$。因此我们可以消去公因子：\n$$\n\\sin^2\\theta = \\cos^2\\theta\n$$\n这可简化为：\n$$\n\\tan^2\\theta = 1 \\implies \\tan\\theta = \\pm 1\n$$\n传播角 $\\theta$ 是波矢 $\\mathbf{k}$ 与背景磁场 $\\mathbf{B}_0$ 之间的夹角。按照惯例，此角度通常限制在区间 $[0, \\frac{\\pi}{2}]$ 内，因为波的物理性质（例如其相速度）关于 $\\theta = \\frac{\\pi}{2}$ 和 $\\theta=0$ 是对称的。在此主区间内取解：\n$$\n\\tan\\theta = 1 \\implies \\theta = \\frac{\\pi}{4}\n$$\n在这个角度下，磁压和磁张力（以及加速度）的 $x$ 分量在量值上完全平衡。",
            "answer": "$$\\boxed{\\frac{\\pi}{4}}$$"
        },
        {
            "introduction": "弥合解析理论与实际应用之间的鸿沟是任何物理学家必备的关键技能。这项练习  将指导你从第一性原理出发，创建一个数值诊断工具。你不仅将重新推导色散关系，还将实现一个数值稳定的求解器，用以计算在不同等离子体环境下的快、慢磁声波速，这是模拟分析和观测数据解释的核心任务。",
            "id": "4215363",
            "problem": "您的任务是为由磁流体力学 (MHD) 描述的均匀理想等离子体中的磁声波设计并实现一个数值诊断程序。从第一性原理出发，您的任务是推导平面波微扰的可压缩波的色散关系，然后对几个指定的参数集数值计算快磁声波和慢磁声波的相速度。\n\n基本依据和物理模型：\n- 考虑理想 MHD，具有均匀的背景质量密度 $\\rho_0$、均匀的背景压力 $p_0$、均匀的背景磁场 $\\mathbf{B}_0$ 和零背景流速 $\\mathbf{v}_0=\\mathbf{0}$。\n- 使用理想 MHD 方程：连续性方程、包含各向同性压力和洛伦兹力的动量方程、感应方程以及绝热状态方程。通过 $c_s^2=\\gamma p_0/\\rho_0$ 定义绝热声速 $c_s$，其中 $\\gamma$ 是绝热指数；通过 $v_A = B_0/\\sqrt{\\mu_0 \\rho_0}$ 定义阿尔芬速度 $v_A$，其中 $\\mu_0$ 是真空磁导率，且 $B_0=\\lVert\\mathbf{B}_0\\rVert$。\n- 在均匀背景附近进行线性化，并假设平面波解正比于 $\\exp\\left[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)\\right]$，其中 $\\mathbf{k}$ 是波矢，$\\omega$ 是角频率，t 是时间。\n- 令 $\\theta$ 为 $\\mathbf{k}$ 和 $\\mathbf{B}_0$ 之间的夹角，定义为 $\\cos\\theta = (\\mathbf{k}\\cdot\\mathbf{B}_0)/(k B_0)$，其中 $k=\\lVert\\mathbf{k}\\rVert$。\n\n推导要求：\n- 从线性化方程出发，推导可压缩分支的标量特征方程，用相速度的平方 $x = (\\omega/k)^2$ 表示。您必须得出一个关于 $x$ 的多项式方程，该方程包含了快磁声模和慢磁声模。不要使用或假设任何快捷公式；该多项式必须通过从上述方程消去除 $x$ 以外的所有微扰变量得到。\n- 确保您的推导正确地分离了剪切阿尔芬模（它不属于要计算的可压缩分支），并专注于磁声模。\n\n数值方法要求：\n- 为得到的关于 $x = (\\omega/k)^2$ 的二次多项式实现一个数值稳定的求解器。这里的稳定性意味着避免灾难性抵消，并确保在包括低 $\\beta$ 区（其中 $c_s \\ll v_A$）、高 $\\beta$ 区（其中 $c_s \\gg v_A$）以及极限角度 $\\theta=0$ 和 $\\theta=\\pi/2$ 的各种条件下都能得到精确的根。\n- 从两个正实根 $x$ 计算相速度 $c_{\\text{fast}}=\\sqrt{x_{\\text{max}}}$ 和 $c_{\\text{slow}}=\\sqrt{x_{\\text{min}}}$，并排序以使 $c_{\\text{fast}} \\ge c_{\\text{slow}} \\ge 0$。\n\n单位与输出精度：\n- 所有输入的物理量必须采用国际单位制 (SI) 处理：$\\rho_0$ 单位为 $\\mathrm{kg/m^3}$，$p_0$ 单位为 $\\mathrm{Pa}$，$B_0$ 单位为 $\\mathrm{T}$，$k$ 单位为 $\\mathrm{m^{-1}}$。角度必须以弧度为单位。计算出的相速度必须以 $\\mathrm{m/s}$ 表示。\n- 对于每个测试用例，返回一个数值对 $\\left[c_{\\text{fast}},c_{\\text{slow}}\\right]$，并四舍五入到六位有效数字。\n\n测试套件：\n为以下参数集计算磁声波相速度，每个参数集以 $(\\rho_0, p_0, B_0, \\gamma, \\theta, k)$ 的形式给出：\n1. 声速和阿尔芬速度相当的理想情况：$\\left(10^{-6}\\,\\mathrm{kg/m^3},\\, 0.6\\,\\mathrm{Pa},\\, 10^{-3}\\,\\mathrm{T},\\, \\frac{5}{3},\\, \\frac{\\pi}{4}\\,\\mathrm{rad},\\, 1\\,\\mathrm{m^{-1}}\\right)$。\n2. 平行传播边界：$\\left(10^{-6}\\,\\mathrm{kg/m^3},\\, 0.6\\,\\mathrm{Pa},\\, 10^{-3}\\,\\mathrm{T},\\, \\frac{5}{3},\\, 0\\,\\mathrm{rad},\\, 1\\,\\mathrm{m^{-1}}\\right)$。\n3. 垂直传播边界：$\\left(10^{-6}\\,\\mathrm{kg/m^3},\\, 0.6\\,\\mathrm{Pa},\\, 10^{-3}\\,\\mathrm{T},\\, \\frac{5}{3},\\, \\frac{\\pi}{2}\\,\\mathrm{rad},\\, 1\\,\\mathrm{m^{-1}}\\right)$。\n4. 低 beta 区 ($c_s \\ll v_A$)：$\\left(10^{-6}\\,\\mathrm{kg/m^3},\\, 0.15\\,\\mathrm{Pa},\\, 3\\times 10^{-3}\\,\\mathrm{T},\\, \\frac{5}{3},\\, \\frac{\\pi}{6}\\,\\mathrm{rad},\\, 1\\,\\mathrm{m^{-1}}\\right)$。\n5. 高 beta 区 ($c_s \\gg v_A$)：$\\left(10^{-6}\\,\\mathrm{kg/m^3},\\, 2.4\\,\\mathrm{Pa},\\, 2\\times 10^{-4}\\,\\mathrm{T},\\, \\frac{5}{3},\\, 0.8\\,\\mathrm{rad},\\, 1\\,\\mathrm{m^{-1}}\\right)$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个元素是对应测试用例的双元素列表。例如，包含两个用例的输出应如下所示：$\\left[\\left[c_{\\text{fast},1},c_{\\text{slow},1}\\right],\\left[c_{\\text{fast},2},c_{\\text{slow},2}\\right]\\right]$。在您的实现中，将此打印为单行的 Python 列表字面量，不带任何额外文本。所有速度单位必须是 $\\mathrm{m/s}$，并四舍五入到六位有效数字。",
            "solution": "在理想磁流体力学 (MHD) 等离子体中推导和计算磁声波速度的问题是等离子体物理学中一个有效且适定的问题。它具有科学依据，是客观的，并且包含了求解所需的所有必要信息。\n\n### 第 1 部分：磁声波色散关系的推导\n\n推导始于理想 MHD 的基本方程，描述了密度为 $\\rho$、速度为 $\\mathbf{v}$、压力为 $p$、磁场为 $\\mathbf{B}$ 的等离子体。\n1.  连续性方程：$\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0$\n2.  动量方程：$\\rho \\left( \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right) = -\\nabla p + \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}) \\times \\mathbf{B}$\n3.  感应方程：$\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})$\n4.  绝热状态方程：$\\frac{d}{dt} (p \\rho^{-\\gamma}) = 0$\n\n我们考虑一个由 $\\rho_0$、$p_0$、$\\mathbf{B}_0$ 和 $\\mathbf{v}_0 = \\mathbf{0}$ 表征的均匀静态背景态。我们引入小微扰，令 $\\rho = \\rho_0 + \\rho_1$，$p = p_0 + p_1$，$\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_1$，且 $\\mathbf{v} = \\mathbf{v}_1$。通过仅保留微扰的一阶项来线性化 MHD 方程，可得：\n1.  $\\frac{\\partial \\rho_1}{\\partial t} + \\rho_0 \\nabla \\cdot \\mathbf{v}_1 = 0$\n2.  $\\rho_0 \\frac{\\partial \\mathbf{v}_1}{\\partial t} = -\\nabla p_1 + \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0$\n3.  $\\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0)$\n4.  $\\frac{\\partial p_1}{\\partial t} + \\mathbf{v}_1 \\cdot \\nabla p_0 = c_s^2 \\left( \\frac{\\partial \\rho_1}{\\partial t} + \\mathbf{v}_1 \\cdot \\nabla \\rho_0 \\right)$，其中 $c_s^2 = \\gamma p_0 / \\rho_0$。对于均匀背景，$\\nabla p_0 = \\mathbf{0}$ 且 $\\nabla \\rho_0 = \\mathbf{0}$，这简化为 $\\frac{\\partial p_1}{\\partial t} = c_s^2 \\frac{\\partial \\rho_1}{\\partial t}$。\n\n我们假设所有微擾量都具有平面波解，正比于 $\\exp[i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)]$。这将微分算子 $\\frac{\\partial}{\\partial t}$ 转换为 $-i\\omega$，$\\nabla$ 转换为 $i\\mathbf{k}$。线性化方程组变为一组代数方程：\n1.  $-i\\omega \\rho_1 + \\rho_0 (i\\mathbf{k} \\cdot \\mathbf{v}_1) = 0 \\implies \\omega\\rho_1 = \\rho_0 (\\mathbf{k} \\cdot \\mathbf{v}_1)$\n2.  $-i\\omega \\rho_0 \\mathbf{v}_1 = -i\\mathbf{k} p_1 + \\frac{1}{\\mu_0}(i\\mathbf{k} \\times \\mathbf{B}_1) \\times \\mathbf{B}_0$\n3.  $-i\\omega \\mathbf{B}_1 = i\\mathbf{k} \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0)$\n4.  $-i\\omega p_1 = c_s^2(-i\\omega\\rho_1) \\implies p_1 = c_s^2 \\rho_1$\n\n我们的目标是通过消去微扰变量 $\\rho_1$、$p_1$ 和 $\\mathbf{B}_1$ 来推导相速度 $\\omega/k$ 的方程。\n从（1）和（4）式，我们可以用 $\\mathbf{v}_1$ 表示 $p_1$：\n$p_1 = c_s^2 \\rho_1 = c_s^2 \\frac{\\rho_0}{\\omega}(\\mathbf{k}\\cdot\\mathbf{v}_1)$。\n从（3）式，我们用 $\\mathbf{v}_1$ 表示 $\\mathbf{B}_1$：\n$\\mathbf{B}_1 = -\\frac{1}{\\omega} \\mathbf{k} \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0) = \\frac{1}{\\omega}[(\\mathbf{k} \\cdot \\mathbf{v}_1)\\mathbf{B}_0 - (\\mathbf{k} \\cdot \\mathbf{B}_0)\\mathbf{v}_1]$。\n\n将这些代入动量方程（2）。首先，我们处理洛伦兹力项：\n$-i\\omega\\rho_0\\mathbf{v}_1 = -i\\mathbf{k} \\left(c_s^2 \\frac{\\rho_0}{\\omega}(\\mathbf{k}\\cdot\\mathbf{v}_1)\\right) + \\frac{i}{\\mu_0}(\\mathbf{k} \\times \\mathbf{B}_1) \\times \\mathbf{B}_0$\n$\\omega^2\\rho_0\\mathbf{v}_1 = c_s^2 \\rho_0 (\\mathbf{k}\\cdot\\mathbf{v}_1)\\mathbf{k} - \\frac{\\omega}{\\mu_0}(\\mathbf{k} \\times \\mathbf{B}_1) \\times \\mathbf{B}_0$\n代入 $\\mathbf{B}_1$ 的表达式：\n$\\omega^2\\rho_0\\mathbf{v}_1 = c_s^2 \\rho_0 (\\mathbf{k}\\cdot\\mathbf{v}_1)\\mathbf{k} - \\frac{1}{\\mu_0}(\\mathbf{k} \\times [(\\mathbf{k} \\cdot \\mathbf{v}_1)\\mathbf{B}_0 - (\\mathbf{k} \\cdot \\mathbf{B}_0)\\mathbf{v}_1]) \\times \\mathbf{B}_0$\n使用矢量恒等式 $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{C} = (\\mathbf{A} \\cdot \\mathbf{C})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{C})\\mathbf{A}$：\n$\\omega^2\\rho_0\\mathbf{v}_1 = c_s^2 \\rho_0 (\\mathbf{k}\\cdot\\mathbf{v}_1)\\mathbf{k} + \\frac{1}{\\mu_0}[ (\\mathbf{k}\\cdot\\mathbf{v}_1)(\\mathbf{k}\\cdot\\mathbf{B}_0)\\mathbf{B}_0 - (\\mathbf{k}\\cdot\\mathbf{v}_1)B_0^2\\mathbf{k} - (\\mathbf{k}\\cdot\\mathbf{B}_0)^2\\mathbf{v}_1 + (\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{v}_1\\cdot\\mathbf{B}_0)\\mathbf{k} ]$\n\n定义阿尔芬速度 $v_A$ 使得 $v_A^2 = B_0^2 / (\\mu_0 \\rho_0)$。除以 $\\rho_0$：\n$\\omega^2\\mathbf{v}_1 = c_s^2(\\mathbf{k}\\cdot\\mathbf{v}_1)\\mathbf{k} + v_A^2 [ \\frac{(\\mathbf{k}\\cdot\\mathbf{v}_1)(\\mathbf{k}\\cdot\\mathbf{B}_0)\\mathbf{B}_0}{B_0^2} - (\\mathbf{k}\\cdot\\mathbf{v}_1)\\mathbf{k} - \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)^2}{B_0^2}\\mathbf{v}_1 + \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{v}_1\\cdot\\mathbf{B}_0)}{B_0^2}\\mathbf{k} ]$\n重新整理各项，得到形式为 $\\mathbf{M} \\cdot \\mathbf{v}_1 = \\mathbf{0}$ 的方程：\n$\\left[\\omega^2 - v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)^2}{B_0^2}\\right]\\mathbf{v}_1 - (\\mathbf{k}\\cdot\\mathbf{v}_1) \\left[ (c_s^2 - v_A^2)\\mathbf{k} + v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)\\mathbf{B}_0}{B_0^2} \\right] - (\\mathbf{v}_1\\cdot\\mathbf{B}_0)\\left[v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)}{B_0^2}\\mathbf{k}\\right] = \\mathbf{0}$\n这是一个关于 $\\mathbf{v}_1$ 的一般矢量方程。通过选择坐标系可以识别出剪切阿尔芬模，但对于可压缩模，将此方程投影到 $\\mathbf{k}$ 和 $\\mathbf{B}_0$ 上更为简洁。这将为标量振幅 $(\\mathbf{k}\\cdot\\mathbf{v}_1)$ 和 $(\\mathbf{v}_1\\cdot\\mathbf{B}_0)$ 创建一个 $2 \\times 2$ 系统。\n\n令 $\\theta$ 为 $\\mathbf{k}$ 和 $\\mathbf{B}_0$ 之间的夹角，则 $\\mathbf{k}\\cdot\\mathbf{B}_0 = k B_0 \\cos\\theta$。\n$\\mathbf{v}_1$ 的系数是 $\\omega^2 - k^2 v_A^2 \\cos^2\\theta$。注意，$\\omega_A^2 = k^2 v_A^2 \\cos^2\\theta$ 是剪切阿尔芬频率的平方。\n该方程包含通过标量积 $(\\mathbf{k}\\cdot\\mathbf{v}_1)$ 和 $(\\mathbf{v}_1\\cdot\\mathbf{B}_0)$ 耦合的项。\n\n在投影前重新组合主矢量方程的各项可以简化问题：\n$\\left( \\omega^2 - k^2 v_A^2 \\cos^2\\theta\\right)\\mathbf{v}_1 = \\left[ (c_s^2+v_A^2) (\\mathbf{k}\\cdot\\mathbf{v}_1) - v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{v}_1\\cdot\\mathbf{B}_0)}{B_0^2} \\right] \\mathbf{k} - \\left[ v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{k}\\cdot\\mathbf{v}_1)}{B_0^2} \\right]\\mathbf{B}_0$\n\n与 $\\mathbf{k}$ 点积：\n$(\\omega^2 - k^2 v_A^2 \\cos^2\\theta)(\\mathbf{k}\\cdot\\mathbf{v}_1) = \\left[ (c_s^2+v_A^2) (\\mathbf{k}\\cdot\\mathbf{v}_1) - v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{v}_1\\cdot\\mathbf{B}_0)}{B_0^2} \\right] k^2 - \\left[ v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{k}\\cdot\\mathbf{v}_1)}{B_0^2} \\right](\\mathbf{k}\\cdot\\mathbf{B}_0)$\n收集 $(\\mathbf{k}\\cdot\\mathbf{v}_1)$ 和 $(\\mathbf{v}_1\\cdot\\mathbf{B}_0)$ 的系数：\n$\\left[\\omega^2 - k^2 v_A^2 \\cos^2\\theta - (c_s^2+v_A^2)k^2 + v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)^2}{B_0^2}\\right](\\mathbf{k}\\cdot\\mathbf{v}_1) + \\left[v_A^2\\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)}{B_0^2}k^2\\right](\\mathbf{v}_1\\cdot\\mathbf{B}_0) = 0$\n$\\left[\\omega^2 - k^2(c_s^2+v_A^2)\\right](\\mathbf{k}\\cdot\\mathbf{v}_1) + \\left[k^2 v_A^2 \\frac{k\\cos\\theta}{B_0}\\right](\\mathbf{v}_1\\cdot\\mathbf{B}_0) = 0$ (Eq. A)\n\n与 $\\mathbf{B}_0$ 点积：\n$(\\omega^2 - k^2 v_A^2 \\cos^2\\theta)(\\mathbf{v}_1\\cdot\\mathbf{B}_0) = \\left[ (c_s^2+v_A^2) (\\mathbf{k}\\cdot\\mathbf{v}_1) - v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{v}_1\\cdot\\mathbf{B}_0)}{B_0^2} \\right](\\mathbf{k}\\cdot\\mathbf{B}_0) - \\left[ v_A^2 \\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)(\\mathbf{k}\\cdot\\mathbf{v}_1)}{B_0^2} \\right]B_0^2$\n$\\left[\\omega^2 - k^2 v_A^2\\cos^2\\theta + v_A^2\\frac{(\\mathbf{k}\\cdot\\mathbf{B}_0)^2}{B_0^2}\\right](\\mathbf{v}_1\\cdot\\mathbf{B}_0) = \\left[ (c_s^2+v_A^2)(\\mathbf{k}\\cdot\\mathbf{B}_0) - v_A^2(\\mathbf{k}\\cdot\\mathbf{B}_0) \\right](\\mathbf{k}\\cdot\\mathbf{v}_1)$\n$\\omega^2(\\mathbf{v}_1\\cdot\\mathbf{B}_0) = \\left[c_s^2(\\mathbf{k}\\cdot\\mathbf{B}_0)\\right](\\mathbf{k}\\cdot\\mathbf{v}_1)$ (Eq. B)\n\n方程 (A) 和 (B) 构成了关于 $(\\mathbf{k}\\cdot\\mathbf{v}_1)$ 和 $(\\mathbf{v}_1\\cdot\\mathbf{B}_0)$ 的齐次方程组。如果系数行列式为零，则存在非平凡解。\n从 (B) 式，我们有 $(\\mathbf{v}_1\\cdot\\mathbf{B}_0) = \\frac{c_s^2(\\mathbf{k}\\cdot\\mathbf{B}_0)}{\\omega^2}(\\mathbf{k}\\cdot\\mathbf{v}_1)$。代入 (A) 式：\n$\\left[\\omega^2 - k^2(c_s^2+v_A^2)\\right](\\mathbf{k}\\cdot\\mathbf{v}_1) + \\left[k^2 v_A^2 \\frac{\\mathbf{k}\\cdot\\mathbf{B}_0}{B_0^2}\\right]\\left(\\frac{c_s^2(\\mathbf{k}\\cdot\\mathbf{B}_0)}{\\omega^2}(\\mathbf{k}\\cdot\\mathbf{v}_1)\\right) = 0$\n对于可压缩模，$\\mathbf{k}\\cdot\\mathbf{v}_1 \\neq 0$，所以我们可以除以它：\n$\\omega^2 - k^2(c_s^2+v_A^2) + \\frac{k^2 v_A^2 c_s^2 (\\mathbf{k}\\cdot\\mathbf{B}_0)^2}{\\omega^2 B_0^2} = 0$\n使用 $\\mathbf{k}\\cdot\\mathbf{B}_0 = k B_0 \\cos\\theta$ 并乘以 $\\omega^2$：\n$\\omega^4 - \\omega^2 k^2(c_s^2+v_A^2) + k^4 c_s^2 v_A^2 \\cos^2\\theta = 0$\n\n这就是特征方程。根据要求，我们寻求一个关于 $x = (\\omega/k)^2$ 的多项式，它代表相速度的平方。除以 $k^4$：\n$x^2 - x(c_s^2+v_A^2) + c_s^2 v_A^2 \\cos^2\\theta = 0$\n\n这就是所求的二次多项式。它的两个根 $x_{\\text{max}}$ 和 $x_{\\text{min}}$ 对应快磁声模和慢磁声模的相速度的平方。剪切阿尔芬模的色散关系为 $\\omega^2 = k^2 v_A^2 \\cos^2\\theta$，它与描述可压缩运动的该系统是解耦的。\n\n### 第 2 部分：数值解法\n\n该多项式形式为 $ax^2+bx+c=0$，其中 $a=1$，$b=-(c_s^2+v_A^2)$，$c=c_s^2 v_A^2 \\cos^2\\theta$。求根的标准二次公式为 $x = (-b \\pm \\sqrt{b^2-4ac})/(2a)$。直接实现此公式在计算较小的根时可能会遭遇灾难性抵消，因为这涉及到两个几乎相等的数相减，尤其是在低 beta 或高 beta 等离子体中，或者当 $\\theta \\approx \\pi/2$ 时。\n\n一种数值稳定的方法是首先计算绝对值较大的根，然后使用韦达定理找到另一个根。\n由于 $b  0$，绝对值最大的根是：\n$x_1 = x_{\\text{max}} = \\frac{-b + \\sqrt{b^2-4ac}}{2}$\n然后通过 $x_1 x_2 = c/a$ 找到另一个根：\n$x_2 = x_{\\text{min}} = \\frac{c}{x_1}$\n由于 $b^2 - 4ac = (c_s^2+v_A^2)^2 - 4c_s^2v_A^2\\cos^2\\theta = (c_s^2-v_A^2)^2 + 4c_s^2v_A^2\\sin^2\\theta \\ge 0$，根总是实数。由于根的和为 $c_s^2+v_A^2 > 0$ 且它们的積为 $c_s^2v_A^2\\cos^2\\theta \\ge 0$，所以两个根都是非负的。\n然后相速度计算为 $c_{\\text{fast}} = \\sqrt{x_{\\text{max}}}$ 和 $c_{\\text{slow}} = \\sqrt{x_{\\text{min}}}$。通过这种构造，可以保证 $c_{\\text{fast}} \\ge c_{\\text{slow}}$。\n该算法在所有参数范围内都是稳定的。例如，如果 $\\theta=\\pi/2$，则 $c=0$，得到 $x_{\\text{min}}=0$ 和 $x_{\\text{max}} = -b = c_s^2+v_A^2$，这是正确的。如果 $\\theta=0$，方程为 $x^2 - x(c_s^2+v_A^2) + c_s^2v_A^2=0$，其根为 $c_s^2$ 和 $v_A^2$。该算法能正确计算这些值。\n\n实现将根据给定参数计算 $c_s^2 = \\gamma p_0 / \\rho_0$ 和 $v_A^2 = B_0^2 / (\\mu_0 \\rho_0)$，然后使用稳定方法求解 $x$ 的二次方程，取平方根得到速度，并将输出格式化为六位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef format_sf(x, sf):\n    \"\"\"\n    Formats a number to a specified number of significant figures.\n\n    Args:\n        x (float): The number to format.\n        sf (int): The number of significant figures.\n\n    Returns:\n        str: The formatted number as a string.\n    \"\"\"\n    if x == 0:\n        return '0.0'\n    if np.isnan(x) or np.isinf(x):\n        return str(x)\n\n    # Determine the number of decimal places required\n    order_of_magnitude = np.floor(np.log10(np.abs(x)))\n    decimals = sf - 1 - int(order_of_magnitude)\n\n    if decimals >= 0:\n        # Use f-string for standard rounding and formatting\n        return f'{x:.{decimals}f}'\n    else:\n        # For numbers >= 10**sf, round to the correct integer place\n        factor = 10**(-decimals)\n        rounded_val = factor * round(x / factor)\n        return str(int(rounded_val))\n\ndef calculate_speeds(params):\n    \"\"\"\n    Calculates fast and slow magnetosonic phase speeds.\n\n    Args:\n        params (tuple): A tuple containing physical parameters\n                        (rho0, p0, B0, gamma, theta, k).\n\n    Returns:\n        tuple: A tuple containing (c_fast, c_slow).\n    \"\"\"\n    rho0, p0, B0, gamma, theta, _ = params\n    \n    # Fundamental constant\n    mu0 = 4 * np.pi * 1e-7  # Magnetic permeability of free space in SI units\n\n    # Calculate squared sound speed and Alfven speed\n    cs2 = gamma * p0 / rho0\n    va2 = B0**2 / (mu0 * rho0)\n\n    # Coefficients of the quadratic equation x^2 + (b/a)x + (c/a) = 0\n    # for x = (omega/k)^2\n    # In our case, a=1, so b is the coefficient of x, c is the constant term.\n    # The derived equation is: x^2 - x(cs^2+va^2) + cs^2*va^2*cos^2(theta) = 0\n    b_coeff = -(cs2 + va2)\n    c_coeff = cs2 * va2 * np.cos(theta)**2\n\n    # Numerically stable solution to the quadratic equation\n    # x = (-b_coeff +/- sqrt(b_coeff^2 - 4*c_coeff)) / 2\n    discriminant = b_coeff**2 - 4 * c_coeff\n    \n    # The discriminant is always non-negative: (cs^2-va^2)^2 + 4*cs^2*va^2*sin^2(theta)\n    # Ensure it's not negative due to floating point inaccuracies\n    if discriminant  0:\n        discriminant = 0\n    \n    # Calculate the larger root robustly\n    x_max = (-b_coeff + np.sqrt(discriminant)) / 2\n    \n    # Calculate the smaller root using Vieta's formula to avoid catastrophic cancellation\n    if x_max == 0:\n        # This case only happens if cs=0 and va=0, so v_slow is also 0.\n        x_min = 0.\n    else:\n        x_min = c_coeff / x_max\n\n    c_fast = np.sqrt(x_max)\n    c_slow = np.sqrt(x_min)\n    \n    return c_fast, c_slow\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite\n    and print the results in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (rho0, p0, B0, gamma, theta, k)\n    test_cases = [\n        (1e-6, 0.6, 1e-3, 5/3, np.pi/4, 1),\n        (1e-6, 0.6, 1e-3, 5/3, 0, 1),\n        (1e-6, 0.6, 1e-3, 5/3, np.pi/2, 1),\n        (1e-6, 0.15, 3e-3, 5/3, np.pi/6, 1),\n        (1e-6, 2.4, 2e-4, 5/3, 0.8, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        c_fast, c_slow = calculate_speeds(case)\n        \n        # Format results to six significant figures\n        cf_str = format_sf(c_fast, 6)\n        cs_str = format_sf(c_slow, 6)\n\n        results.append(f\"[{cf_str},{cs_str}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}