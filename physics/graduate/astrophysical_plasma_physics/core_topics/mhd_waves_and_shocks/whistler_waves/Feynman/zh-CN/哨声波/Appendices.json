{
    "hands_on_practices": [
        {
            "introduction": "理解任何波动的核心在于掌握其色散关系，它描述了波的频率 $\\omega$ 和波数 $k$ 之间的联系。对于哨声波而言，在低频近似下，其色散关系呈现出一种独特的二次方形式。通过从麦克斯韦方程组和等离子体流体方程出发进行推导，我们可以巩固对哨声波物理本质的理解，并揭示其相速度和群速度之间的重要区别，这对于分析波的能量传播至关重要。",
            "id": "4235750",
            "problem": "考虑一个冷的、无碰撞的、准中性的电子-离子等离子体，其具有均匀背景磁场 $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$ 和电子数密度 $n_{e}$。假设在所关心的频率范围内，离子运动可以忽略，并考虑角频率为 $\\omega$、平行波数为 $k_{\\parallel}$ 的小振幅平面电磁波，其严格沿着 $\\mathbf{B}_{0}$ 方向传播。在 $\\Omega_{i} \\ll \\omega \\ll \\Omega_{e}$ 的范围内进行研究，其中 $\\Omega_{i}$ 和 $\\Omega_{e}$ 分别是离子和电子的回旋频率，并假设 $k_{\\parallel} c / \\omega \\gg 1$ 不是必需条件；保留完整的位移电流。从麦克斯韦方程组和线性化的电子动量方程出发，推导平行传播的右旋圆极化哨声模在低频极限下的色散关系，在该极限下，色散关系变为关于 $k_{\\parallel}$ 的二次方。从这个二次色散关系中，求得相速度 $v_{\\phi} = \\omega/k_{\\parallel}$ 和群速度 $v_{g} = \\partial \\omega / \\partial k_{\\parallel}$，然后计算比值 $v_{g}/v_{\\phi}$。\n\n使用以下符合物理实际的参数，这些参数代表了在 $1\\,\\mathrm{AU}$ 附近的日球层等离子体：$B_{0} = 5.0 \\times 10^{-9}\\,\\mathrm{T}$ 和 $n_{e} = 5.0 \\times 10^{6}\\,\\mathrm{m}^{-3}$。定义电子回旋频率 $\\Omega_{e} \\equiv e B_{0}/m_{e}$ 和电子等离子体频率 $\\omega_{pe} \\equiv \\sqrt{n_{e} e^{2}/(m_{e} \\epsilon_{0})}$，其中 $e$ 是基本电荷，$m_{e}$ 是电子质量，$\\epsilon_{0}$ 是真空介电常数。将最终的比值 $v_{g}/v_{\\phi}$ 表示为一个无量纲数。无需进行四舍五入。",
            "solution": "目标是从第一性原理出发，推导平行传播的哨声模色散关系，得到其关于 $k_{\\parallel}$ 的二次方极限，然后计算相速度和群速度及其比值。\n\n我们考虑一个冷的电子流体（离子被视为不动的），其具有均匀背景磁场 $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$。设小振幅波场和电子速度微扰的变化形式为 $\\exp\\!\\left(i k_{\\parallel} z - i \\omega t\\right)$。\n\n相关的基本定律是：\n- 麦克斯韦-法拉第定律：$\\nabla \\times \\mathbf{E} = - \\partial \\mathbf{B}/\\partial t$。\n- 麦克斯韦-安培定律：$\\nabla \\times \\mathbf{B} = \\mu_{0} \\epsilon_{0} \\partial \\mathbf{E}/\\partial t + \\mu_{0} \\mathbf{J}$。\n- 线性化的电子动量方程（冷的、无碰撞的）：$m_{e}\\,\\partial \\delta \\mathbf{v}_{e}/\\partial t = - e\\left(\\delta \\mathbf{E} + \\delta \\mathbf{v}_{e} \\times \\mathbf{B}_{0}\\right)$。\n- 由电子运动产生的电流密度：$\\mathbf{J} = - e n_{e}\\,\\delta \\mathbf{v}_{e}$。\n\n我们考虑横向场和平行传播的情况，并采用右旋圆极化，因此 $\\delta \\mathbf{E}_{\\perp}$ 的分量满足 $\\delta E_{y} = i\\,\\delta E_{x}$。求解电子动量方程以得到用 $\\delta \\mathbf{E}_{\\perp}$ 表示的 $\\delta \\mathbf{v}_{e}$，可以得到熟悉的回旋响应。在傅里叶空间中写出动量方程（使用 $\\exp\\!\\left(i k_{\\parallel} z - i \\omega t\\right)$ 约定）：\n\n$$\n- i \\omega m_{e}\\,\\delta \\mathbf{v}_{e} = - e\\left(\\delta \\mathbf{E} + \\delta \\mathbf{v}_{e} \\times \\mathbf{B}_{0}\\right).\n$$\n\n对于 $\\mathbf{B}_{0} = B_{0} \\hat{\\mathbf{z}}$，横向分量遵循\n\n$$\n\\begin{pmatrix}\n- i \\omega & \\Omega_{e} \\\\\n- \\Omega_{e} & - i \\omega\n\\end{pmatrix}\n\\begin{pmatrix}\n\\delta v_{x} \\\\\n\\delta v_{y}\n\\end{pmatrix}\n= - \\frac{e}{m_{e}}\n\\begin{pmatrix}\n\\delta E_{x} \\\\\n\\delta E_{y}\n\\end{pmatrix},\n\\quad\n\\Omega_{e} \\equiv \\frac{e B_{0}}{m_{e}}.\n$$\n\n行列式为 $\\omega^{2} - \\Omega_{e}^{2}$，其解为\n\n$$\n\\delta v_{x} = - \\frac{e}{m_{e}} \\frac{- i \\omega\\,\\delta E_{x} - \\Omega_{e}\\,\\delta E_{y}}{\\omega^{2} - \\Omega_{e}^{2}},\n\\qquad\n\\delta v_{y} = - \\frac{e}{m_{e}} \\frac{+\\Omega_{e}\\,\\delta E_{x} - i \\omega\\,\\delta E_{y}}{\\omega^{2} - \\Omega_{e}^{2}}.\n$$\n\n应用右旋圆极化条件 $\\delta E_{y} = i\\,\\delta E_{x}$ 可得\n\n$$\n\\delta v_{x} = - \\frac{e}{m_{e}}\\,\\frac{-i\\left(\\omega - \\Omega_{e}\\right)}{\\omega^{2} - \\Omega_{e}^{2}}\\,\\delta E_{x},\n\\qquad\n\\delta v_{y} = i\\,\\delta v_{x}.\n$$\n\n因此，$x$ 分量的电流-场关系为\n\n$$\n\\frac{J_{x}}{\\delta E_{x}} = - e n_{e}\\,\\frac{\\delta v_{x}}{\\delta E_{x}} = i\\,\\frac{e^{2} n_{e}}{m_{e}}\\,\\frac{\\omega - \\Omega_{e}}{\\omega^{2} - \\Omega_{e}^{2}}.\n$$\n\n\n现在使用麦克斯韦方程组来连接 $\\mathbf{J}$ 和 $\\delta \\mathbf{E}$。在傅里叶空间中，对于横波，法拉第定律给出 $\\mathbf{B} = \\frac{1}{\\omega}\\,\\mathbf{k} \\times \\mathbf{E}$。安培定律变为\n\n$$\ni\\,\\mathbf{k} \\times \\mathbf{B} = - i\\,\\mu_{0} \\epsilon_{0} \\omega\\,\\mathbf{E} + \\mu_{0}\\,\\mathbf{J}.\n$$\n\n代入 $\\mathbf{B}$ 并利用横波条件 $\\mathbf{k} \\cdot \\mathbf{E} = 0$ 进行化简，得到波动方程\n\n$$\n\\left(c^{2} k_{\\parallel}^{2} - \\omega^{2}\\right)\\,\\mathbf{E} = i\\,\\frac{\\omega}{\\epsilon_{0}}\\,\\mathbf{J}.\n$$\n\n令 $x$ 分量相等并除以 $\\omega^{2}$ 可得\n\n$$\n\\left(\\frac{c^{2} k_{\\parallel}^{2}}{\\omega^{2}} - 1\\right) = i\\,\\frac{1}{\\epsilon_{0}\\,\\omega}\\,\\frac{J_{x}}{\\delta E_{x}}.\n$$\n\n引入折射率 $n^{2} \\equiv c^{2} k_{\\parallel}^{2}/\\omega^{2}$。使用上面的电流-场比值和电子等离子体频率 $\\omega_{pe}^{2} \\equiv \\frac{n_{e} e^{2}}{m_{e} \\epsilon_{0}}$，我们发现\n\n$$\nn^{2} - 1 = i\\,\\frac{1}{\\epsilon_{0}\\,\\omega}\\left[ i\\,\\frac{e^{2} n_{e}}{m_{e}}\\,\\frac{\\omega - \\Omega_{e}}{\\omega^{2} - \\Omega_{e}^{2}}\\right]\n= - \\frac{\\omega_{pe}^{2}}{\\omega}\\,\\frac{\\omega - \\Omega_{e}}{\\omega^{2} - \\Omega_{e}^{2}}.\n$$\n\n利用 $\\omega^{2} - \\Omega_{e}^{2} = \\left(\\omega - \\Omega_{e}\\right)\\left(\\omega + \\Omega_{e}\\right)$，我们消去 $\\left(\\omega - \\Omega_{e}\\right)$ 因子，得到平行右旋模（哨声模/R模）的色散关系：\n\n$$\nn^{2} = 1 - \\frac{\\omega_{pe}^{2}}{\\omega\\left(\\omega + \\Omega_{e}\\right)}.\n$$\n\n在低频哨声模极限 $\\omega \\ll \\Omega_{e}$ 下，该式简化为\n\n$$\nn^{2} \\simeq 1 - \\frac{\\omega_{pe}^{2}}{\\omega\\,\\Omega_{e}}.\n$$\n\n此外，在典型哨声波条件下，等离子体密度足够高，以至于 $\\frac{\\omega_{pe}^2}{\\omega \\Omega_e} \\gg 1$，因此我们可以忽略 '1'：\n\n$$\nn^{2} \\simeq - \\frac{\\omega_{pe}^{2}}{\\omega\\,\\Omega_{e}}\n$$\n\n这意味着\n\n$$\n\\frac{c^{2} k_{\\parallel}^{2}}{\\omega^{2}} \\simeq - \\frac{\\omega_{pe}^{2}}{\\omega\\,\\Omega_{e}}\n\\quad \\Rightarrow \\quad\n\\omega \\simeq - \\frac{\\Omega_{e} c^{2}}{\\omega_{pe}^{2}}\\,k_{\\parallel}^{2}.\n$$\n\n负号表明我们对右旋极化的约定或推导中的某个步骤与产生正频率的常见形式不一致。让我们回顾一下。一个常见的错误来源是右手坐标系与极化方向的选择。让我们采用标准的Stix约定，其中R波的色散关系为 $n_R^2 = 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega-\\Omega_e)}$。在 $\\omega \\ll \\Omega_e$ 的极限下，这变为 $n_R^2 \\approx 1 + \\frac{\\omega_{pe}^2}{\\omega \\Omega_e}$。忽略 '1'，我们得到\n$n^2 \\approx \\frac{\\omega_{pe}^2}{\\omega \\Omega_e}$，这导致 $\\omega \\approx \\frac{\\Omega_e c^2}{\\omega_{pe}^2} k_\\parallel^2$。\n\n让我们重新检查推导。在求解电子运动方程时，如果采用 RCP 波 $\\delta E_y = -i \\delta E_x$ （物理约定），则 $\\delta v_x = \\frac{e}{m_e} \\frac{i}{\\omega-\\Omega_e} \\delta E_x$。那么 $J_x = -en_e \\delta v_x = -i \\frac{n_e e^2}{m_e (\\omega-\\Omega_e)} \\delta E_x = i \\frac{\\epsilon_0 \\omega_{pe}^2}{\\omega-\\Omega_e} \\delta E_x$。\n代入波动方程 $(c^2 k_\\parallel^2 - \\omega^2) E_x = i\\frac{\\omega}{\\epsilon_0} J_x$，得到 $n^2-1 = i \\frac{\\omega}{\\epsilon_0 \\omega^2} (i \\frac{\\epsilon_0 \\omega_{pe}^2}{\\omega-\\Omega_e}) = - \\frac{\\omega_{pe}^2}{\\omega(\\omega-\\Omega_e)} = \\frac{\\omega_{pe}^2}{\\omega(\\Omega_e-\\omega)}$。\n这就是正确的形式。\n\n因此，色散关系为：\n$$ n^2 = 1 + \\frac{\\omega_{pe}^2}{\\omega(\\Omega_e - \\omega)} $$\n在 $\\omega \\ll \\Omega_e$ 的极限下，并假设 $\\frac{\\omega_{pe}^2}{\\omega \\Omega_e} \\gg 1$:\n$$ n^2 \\approx \\frac{\\omega_{pe}^2}{\\omega \\Omega_e} $$\n$$ \\frac{c^2 k_\\parallel^2}{\\omega^2} \\approx \\frac{\\omega_{pe}^2}{\\omega \\Omega_e} \\implies \\omega \\approx \\frac{\\Omega_e c^2}{\\omega_{pe}^2} k_\\parallel^2 $$\n这就是二次哨声模色散关系 $\\omega = \\alpha\\,k_{\\parallel}^{2}$，其中\n$$ \\alpha \\equiv \\frac{\\Omega_{e} c^{2}}{\\omega_{pe}^{2}}. $$\n\n从 $\\omega(k_{\\parallel}) = \\alpha\\,k_{\\parallel}^{2}$ 可知，相速度和群速度为\n$$\nv_{\\phi} \\equiv \\frac{\\omega}{k_{\\parallel}} = \\alpha\\,k_{\\parallel},\n\\qquad\nv_{g} \\equiv \\frac{\\partial \\omega}{\\partial k_{\\parallel}} = 2\\,\\alpha\\,k_{\\parallel}.\n$$\n因此，群速度与相速度的比值为\n$$\n\\frac{v_{g}}{v_{\\phi}} = \\frac{2\\,\\alpha\\,k_{\\parallel}}{\\alpha\\,k_{\\parallel}} = 2.\n$$\n对于二次色散关系，该比值与等离子体参数 $B_{0}$ 和 $n_{e}$ 无关。因此，所求的无量纲比值恰好是 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在真实的宇宙环境中，等离子体几乎总是非均匀的，这深刻地影响着波的传播路径。哈密顿射线追踪是一种强大的几何光学方法，它将波的色散关系视为一个哈密顿量，从而能够预测波包在密度或磁场梯度中的运动轨迹。通过这项实践，您将应用这一理论来追踪哨声波在沿磁场方向的密度“波导”中的传播，直观地理解波的波数 $k_{\\parallel}$ 是如何随局域等离子体密度变化的。",
            "id": "4235810",
            "problem": "考虑一个冷磁化电子等离子体，其背景磁场是均匀的 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，电子数密度 $n_e(\\mathbf{r})$ 在空间上变化。假设离子是静止的，并且仅用于维持电中性。在 $\\omega \\ll \\Omega_e$ 的低频哨声波机制下，并采用冷等离子体近似，哨声波分支的局域色散关系为\n$$\n\\omega(\\mathbf{r},\\mathbf{k}) = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(\\mathbf{r})}\\, k_\\parallel^2,\n$$\n其中 $\\Omega_e = \\frac{e B_0}{m_e}$ 是电子回旋频率，$\\omega_{pe}(\\mathbf{r}) = \\sqrt{\\frac{n_e(\\mathbf{r}) e^2}{\\varepsilon_0 m_e}}$ 是电子等离子体频率，$c$ 是真空中光速，$e$ 是基本电荷，$m_e$ 是电子质量，而 $k_\\parallel = \\mathbf{k} \\cdot \\hat{\\mathbf{z}}$ 是波矢平行于 $\\mathbf{B}_0$ 的分量。\n\n使用哈密顿射线追踪，其哈密顿量为 $H(\\mathbf{r},\\mathbf{k}) = \\omega(\\mathbf{r},\\mathbf{k})$，射线遵循\n$$\n\\dot{\\mathbf{r}} = \\nabla_{\\mathbf{k}} \\omega(\\mathbf{r},\\mathbf{k}), \\quad \\dot{\\mathbf{k}} = -\\nabla_{\\mathbf{r}} \\omega(\\mathbf{r},\\mathbf{k}),\n$$\n其中上方的点表示对时间的导数。将注意力限制在沿磁场的一维非均匀性上，即取 $n_e(\\mathbf{r}) = n_e(z)$ 并假设 $\\mathbf{k} = k_\\parallel \\hat{\\mathbf{z}}$。从上述基本定律和定义出发，执行以下操作：\n\n1. 明确写出由给定哈密顿量所蕴含的关于 $z(t)$ 和 $k_\\parallel(t)$ 的一维射线方程。在从一般哈密顿形式推导至具体一维系统的过程中不要跳过步骤。\n\n2. 利用介质不随时间变化的物理约束，解释 $\\omega$ 是否沿射线保持恒定，并以此定性地概述 $k_\\parallel$ 如何作为位置的函数，沿场向密度波导 $n_e(z)$ 演化。\n\n3. 实现一个程序，对以下测试用例集，积分求解导出的一维哈密顿射线方程。在每种情况下，使用给定的参数，在 $z(0) = 0$ 处进行初始化，其中 $k_\\parallel(0)$ 的选择需满足在 $z=0$ 处对于给定的恒定角频率 $\\omega$ 的色散关系，然后随时间向前积分，直到射线到达指定位置 $z = z_{\\mathrm{end}}$。报告最终的平行波数 $k_\\parallel(z_{\\mathrm{end}})$，单位为 $\\mathrm{m}^{-1}$。\n\n   使用以下常数（国际单位制）：$e = 1.602176634\\times 10^{-19}$，$m_e = 9.1093837015\\times 10^{-31}$，$\\varepsilon_0 = 8.8541878128\\times 10^{-12}$，$c = 2.99792458\\times 10^{8}$。对所有情况，取 $B_0 = 200 \\times 10^{-9}$ 和 $\\omega = 2000$。\n\n   通过 $n_e(z) = n_0 \\left(1 + \\beta z\\right)$ 定义密度剖面，并确保在区间 $[0, z_{\\mathrm{end}}]$ 上 $n_e(z) > 0$。各个案例如下：\n\n   - 案例 A (均匀介质): $n_0 = 2.0\\times 10^{6}$，$\\beta = 0.0$，$z_{\\mathrm{end}} = 5.0\\times 10^{5}$。\n   - 案例 B (密度增加的波导): $n_0 = 2.0\\times 10^{6}$，$\\beta = 1.0\\times 10^{-6}$，$z_{\\mathrm{end}} = 1.0\\times 10^{6}$。\n   - 案例 C (密度减小的波导): $n_0 = 2.0\\times 10^{6}$，$\\beta = -5.0\\times 10^{-7}$，$z_{\\mathrm{end}} = 1.0\\times 10^{6}$。\n\n   将 $k_\\parallel(z_{\\mathrm{end}})$ 的最终值以 $\\mathrm{m}^{-1}$ 为单位表示为浮点数。\n\n您的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，“[resultA,resultB,resultC]”），列表中的每个条目分别是案例 A、B 和 C 的最终 $k_\\parallel(z_{\\mathrm{end}})$，单位为 $\\mathrm{m}^{-1}$。",
            "solution": "问题陈述已被分析并确定为有效。它在科学上基于等离子体物理学原理，特别是使用哈密顿射线追踪的哨声波传播理论。该问题是适定的，提供了所有必要的物理常数、参数和初始条件，以得出一个唯一且有意义的解。语言客观，设置内部一致。\n\n### 1. 一维射线方程的推导\n\n该系统由哈密顿量 $H(\\mathbf{r}, \\mathbf{k}) = \\omega(\\mathbf{r}, \\mathbf{k})$ 描述，其中 $\\omega$ 是局域哨声波色散关系。对于指定的仅沿 $\\hat{\\mathbf{z}}$ 方向存在非均匀性的一维情况，$n_e(\\mathbf{r}) = n_e(z)$，且对于纯粹平行于磁场传播的波，$\\mathbf{k} = k_\\parallel \\hat{\\mathbf{z}}$，位置矢量简化为 $\\mathbf{r} = z\\hat{\\mathbf{z}}$，波矢简化为 $\\mathbf{k} = k_\\parallel\\hat{\\mathbf{z}}$。\n\n哈密顿量成为标量相空间坐标 $(z, k_\\parallel)$ 的函数：\n$$\nH(z, k_\\parallel) = \\omega(z, k_\\parallel) = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} k_\\parallel^2\n$$\n其中 $\\Omega_e = \\frac{e B_0}{m_e}$ 是一个常数，而电子等离子体频率的平方 $\\omega_{pe}^2(z) = \\frac{n_e(z) e^2}{\\varepsilon_0 m_e}$ 通过电子密度 $n_e(z)$ 依赖于位置 $z$。\n\n一维哈密顿射线方程为：\n$$\n\\dot{z} = \\frac{dz}{dt} = \\frac{\\partial H}{\\partial k_\\parallel}\n$$\n$$\n\\dot{k_\\parallel} = \\frac{dk_\\parallel}{dt} = -\\frac{\\partial H}{\\partial z}\n$$\n\n我们计算所需的偏导数：\n\n首先，关于 $k_\\parallel$ 的导数：\n$$\n\\frac{\\partial H}{\\partial k_\\parallel} = \\frac{\\partial}{\\partial k_\\parallel} \\left( \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} k_\\parallel^2 \\right) = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} (2 k_\\parallel)\n$$\n这给出了射线位置的方程，即沿 $\\hat{\\mathbf{z}}$ 方向的群速度分量：\n$$\n\\dot{z} = \\frac{2 \\Omega_e c^2 k_\\parallel}{\\omega_{pe}^2(z)}\n$$\n\n其次，关于 $z$ 的导数：\n$$\n\\frac{\\partial H}{\\partial z} = \\frac{\\partial}{\\partial z} \\left( \\frac{\\Omega_e c^2 k_\\parallel^2}{\\omega_{pe}^2(z)} \\right) = \\Omega_e c^2 k_\\parallel^2 \\frac{\\partial}{\\partial z} \\left( \\frac{1}{\\omega_{pe}^2(z)} \\right)\n$$\n使用链式法则 $\\frac{\\partial}{\\partial z} \\left( \\frac{1}{u} \\right) = -\\frac{1}{u^2} \\frac{du}{dz}$，其中 $u = \\omega_{pe}^2(z)$：\n$$\n\\frac{\\partial H}{\\partial z} = \\Omega_e c^2 k_\\parallel^2 \\left( -\\frac{1}{(\\omega_{pe}^2(z))^2} \\frac{d(\\omega_{pe}^2(z))}{dz} \\right)\n$$\n由于 $\\omega_{pe}^2(z) = \\frac{n_e(z) e^2}{\\varepsilon_0 m_e}$，其导数为 $\\frac{d(\\omega_{pe}^2(z))}{dz} = \\frac{e^2}{\\varepsilon_0 m_e} \\frac{dn_e}{dz}$。我们可以用 $\\omega_{pe}^2(z)$ 本身来表示它：$\\frac{d(\\omega_{pe}^2(z))}{dz} = \\frac{\\omega_{pe}^2(z)}{n_e(z)} \\frac{dn_e}{dz}$。\n将此代回：\n$$\n\\frac{\\partial H}{\\partial z} = -\\frac{\\Omega_e c^2 k_\\parallel^2}{(\\omega_{pe}^2(z))^2} \\left( \\frac{\\omega_{pe}^2(z)}{n_e(z)} \\frac{dn_e}{dz} \\right) = - \\left( \\frac{\\Omega_e c^2 k_\\parallel^2}{\\omega_{pe}^2(z)} \\right) \\frac{1}{n_e(z)}\\frac{dn_e}{dz}\n$$\n识别出括号中的项即为哈密顿量 $H=\\omega$ 本身：\n$$\n\\frac{\\partial H}{\\partial z} = -\\omega \\frac{1}{n_e(z)}\\frac{dn_e}{dz}\n$$\n这给出了射线波数的方程：\n$$\n\\dot{k_\\parallel} = - \\left( -\\omega \\frac{1}{n_e(z)}\\frac{dn_e}{dz} \\right) = \\omega \\frac{1}{n_e(z)}\\frac{dn_e}{dz}\n$$\n显式的一维射线方程为：\n$$\n\\frac{dz}{dt} = \\frac{2 \\Omega_e c^2 k_\\parallel(t)}{\\omega_{pe}^2(z(t))}\n$$\n$$\n\\frac{dk_\\parallel}{dt} = \\omega(z(t), k_\\parallel(t)) \\frac{1}{n_e(z(t))} \\frac{dn_e}{dz}\n$$\n\n### 2. 频率守恒与 $k_\\parallel$ 的定性行为\n\n哈密顿量 $H(\\mathbf{r}, \\mathbf{k})$ 没有任何对时间 $t$ 的显式依赖，即 $\\frac{\\partial H}{\\partial t} = 0$。这是介质是静态的（密度剖面 $n_e(z)$ 和磁场 $B_0$ 不随时间变化）这一物理假设的直接结果。对于这样的系统，哈密顿量沿射线轨迹的全时间导数为零：\n$$\n\\frac{d H}{dt} = \\frac{\\partial H}{\\partial t} + \\sum_i \\left( \\frac{\\partial H}{\\partial r_i} \\dot{r}_i + \\frac{\\partial H}{\\partial k_i} \\dot{k}_i \\right) = 0 + \\nabla_{\\mathbf{r}} H \\cdot \\dot{\\mathbf{r}} + \\nabla_{\\mathbf{k}} H \\cdot \\dot{\\mathbf{k}}\n$$\n代入哈密顿方程 $\\dot{\\mathbf{r}} = \\nabla_{\\mathbf{k}}H$ 和 $\\dot{\\mathbf{k}} = -\\nabla_{\\mathbf{r}}H$：\n$$\n\\frac{d H}{dt} = \\nabla_{\\mathbf{r}} H \\cdot (\\nabla_{\\mathbf{k}}H) + \\nabla_{\\mathbf{k}} H \\cdot (-\\nabla_{\\mathbf{r}}H) = 0\n$$\n由于 $H = \\omega$，这意味着波频 $\\omega$ 沿着射线路径是守恒的。\n\n在 $\\omega$ 为常数的情况下，我们可以分析色散关系来理解 $k_\\parallel$ 作为位置 $z$ 的函数的演化：\n$$\n\\omega = \\frac{\\Omega_e c^2}{\\omega_{pe}^2(z)} k_\\parallel^2(z) = \\text{constant}\n$$\n代入 $\\omega_{pe}^2(z) = \\frac{n_e(z) e^2}{\\varepsilon_0 m_e}$：\n$$\n\\omega = \\frac{\\Omega_e c^2 \\varepsilon_0 m_e}{e^2 n_e(z)} k_\\parallel^2(z)\n$$\n对 $k_\\parallel^2(z)$ 进行整理，我们发现：\n$$\nk_\\parallel^2(z) = \\omega \\left( \\frac{e^2}{\\Omega_e c^2 \\varepsilon_0 m_e} \\right) n_e(z)\n$$\n由于各项 $\\omega$、$e$、$\\Omega_e$、$c$、$\\varepsilon_0$ 和 $m_e$ 均为常数，我们得到直接的正比关系：\n$k_\\parallel^2(z) \\propto n_e(z) \\implies k_\\parallel(z) \\propto \\sqrt{n_e(z)}$\n（假设 $k_\\parallel > 0$）。\n\n因此，当一束哨声波射线沿着场向密度波导 $n_e(z)$ 传播时：\n- 如果射线进入一个**密度增加**的区域，$n_e(z)$ 会增加，因此平行波数 $k_\\parallel$ 必须**增加**。\n- 如果射线进入一个**密度减小**的区域，$n_e(z)$ 会减小，因此平行波数 $k_\\parallel$ 必须**减小**。\n\n### 3. 最终波数的计算\n\n$\\omega$ 的守恒提供了一种直接的解析方法来计算最终波数 $k_\\parallel(z_{\\mathrm{end}})$，从而无需对射线方程进行随时间的数值积分。任意位置 $z$ 处的波数仅由恒定的频率 $\\omega$ 和局域密度 $n_e(z)$ 决定。\n该关系由下式给出：\n$$\nk_\\parallel(z) = \\sqrt{\\omega \\frac{\\omega_{pe}^2(z)}{\\Omega_e c^2}} = \\sqrt{\\omega \\frac{n_e(z) e^2}{\\Omega_e c^2 \\varepsilon_0 m_e}}\n$$\n我们可以通过代入 $\\Omega_e = \\frac{e B_0}{m_e}$ 来简化比例常数：\n$$\nk_\\parallel(z) = \\sqrt{\\omega \\frac{n_e(z) e^2}{(e B_0/m_e) c^2 \\varepsilon_0 m_e}} = \\sqrt{\\frac{\\omega e}{B_0 c^2 \\varepsilon_0} n_e(z)}\n$$\n因此，通过使用给定的密度剖面 $n_e(z) = n_0(1+\\beta z)$ 在 $z=z_{\\mathrm{end}}$ 处计算该表达式的值，即可求得 $k_\\parallel(z_{\\mathrm{end}})$。\n\n**常数：**\n- $e = 1.602176634\\times 10^{-19}$ C\n- $m_e = 9.1093837015\\times 10^{-31}$ kg\n- $\\varepsilon_0 = 8.8541878128\\times 10^{-12}$ F/m\n- $c = 2.99792458\\times 10^{8}$ m/s\n- $B_0 = 200 \\times 10^{-9}$ T\n- $\\omega = 2000$ rad/s\n\n**各案例的计算：**\n\n**案例 A:**\n- $n_0 = 2.0\\times 10^{6}$ m$^{-3}$\n- $\\beta = 0.0$ m$^{-1}$\n- $z_{\\mathrm{end}} = 5.0\\times 10^{5}$ m\n- $n_e(z_{\\mathrm{end}}) = n_0(1 + 0) = 2.0\\times 10^{6}$ m$^{-3}$\n- $k_{\\parallel, A} = \\sqrt{\\frac{2000 \\times 1.602...\\times 10^{-19}}{200\\times 10^{-9} \\times (2.997...\\times 10^{8})^2 \\times 8.854...\\times 10^{-12}} \\times 2.0\\times 10^{6}} \\approx 6.34508 \\times 10^{-5}$ m$^{-1}$\n\n**案例 B:**\n- $n_0 = 2.0\\times 10^{6}$ m$^{-3}$\n- $\\beta = 1.0\\times 10^{-6}$ m$^{-1}$\n- $z_{\\mathrm{end}} = 1.0\\times 10^{6}$ m\n- $n_e(z_{\\mathrm{end}}) = (2.0\\times 10^{6})(1 + 1.0\\times 10^{-6} \\times 1.0\\times 10^{6}) = 2.0\\times 10^{6} \\times 2 = 4.0\\times 10^{6}$ m$^{-3}$\n- 由于 $n_e(z_{\\mathrm{end}})$ 是案例 A 初始密度的两倍，且 $k_\\parallel \\propto \\sqrt{n_e}$，则 $k_{\\parallel, B} = k_{\\parallel, A}(n_0=2\\text{e}6) \\times \\sqrt{2} \\approx 8.97327 \\times 10^{-5}$ m$^{-1}$。\n\n**案例 C:**\n- $n_0 = 2.0\\times 10^{6}$ m$^{-3}$\n- $\\beta = -5.0\\times 10^{-7}$ m$^{-1}$\n- $z_{\\mathrm{end}} = 1.0\\times 10^{6}$ m\n- $n_e(z_{\\mathrm{end}}) = (2.0\\times 10^{6})(1 - 5.0\\times 10^{-7} \\times 1.0\\times 10^{6}) = 2.0\\times 10^{6} \\times 0.5 = 1.0\\times 10^{6}$ m$^{-3}$\n- 由于 $n_e(z_{\\mathrm{end}})$ 是案例 A 初始密度的一半，则 $k_{\\parallel, C} = k_{\\parallel, A}(n_0=2\\text{e}6) / \\sqrt{2} \\approx 4.48664 \\times 10^{-5}$ m$^{-1}$。\n\n以下程序实现了这种直接解析计算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the final parallel wavenumber for whistler waves in a 1D inhomogeneous plasma.\n    \"\"\"\n\n    # Define physical constants in SI units.\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n    M_E = 9.1093837015e-31       # Electron mass (kg)\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    C_LIGHT = 2.99792458e8       # Speed of light in vacuum (m/s)\n\n    # Define problem parameters valid for all cases.\n    B0 = 200.0e-9  # Background magnetic field strength (T)\n    OMEGA = 2000.0    # Wave angular frequency (rad/s)\n\n    # Define the test cases.\n    # Each case is a tuple: (n0, beta, z_end)\n    # n0: initial electron number density (m^-3)\n    # beta: density gradient parameter (m^-1)\n    # z_end: final position (m)\n    test_cases = [\n        (2.0e6, 0.0, 5.0e5),      # Case A\n        (2.0e6, 1.0e-6, 1.0e6),   # Case B\n        (2.0e6, -5.0e-7, 1.0e6),  # Case C\n    ]\n\n    results = []\n    \n    # As derived in the solution, the frequency omega is constant along the ray path.\n    # This leads to an analytical expression for k_parallel(z) that depends only\n    # on the local density n_e(z), not on the path taken.\n    # The formula is: k_parallel^2 = omega * (n_e * e^2) / (Omega_e * c^2 * epsilon_0 * m_e)\n    # Substituting Omega_e = (e * B0) / m_e, this simplifies to:\n    # k_parallel^2 = omega * e * n_e / (B0 * c^2 * epsilon_0)\n    \n    # Pre-calculate the constant part of the expression for k_parallel^2.\n    const_factor = (OMEGA * E_CHARGE) / (B0 * C_LIGHT**2 * EPSILON_0)\n\n    for case in test_cases:\n        n0, beta, z_end = case\n\n        # Calculate the electron number density at the final position.\n        n_e_end = n0 * (1.0 + beta * z_end)\n        \n        # Calculate the final parallel wavenumber using the analytical formula.\n        # We take the positive root, assuming forward propagation.\n        k_parallel_end = np.sqrt(const_factor * n_e_end)\n        \n        results.append(k_parallel_end)\n\n    # Print the results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "超越冷等离子体模型的范畴，波与粒子之间的能量交换是一个决定波的稳定性和等离子体动力学过程的关键机制。朗道共振描述了速度与波的相速度相匹配的粒子如何与波发生持续的相互作用，导致波的阻尼或增长。本练习将引导您进入哨声波的动理学世界，计算在非麦克斯韦分布下的朗道阻尼率，揭示真实空间等离子体中复杂的粒子速度分布如何决定哨声波的最终命运。",
            "id": "372928",
            "problem": "哨声模波是一种可在磁化等离子体中传播的右旋偏振电磁波，在地球辐射带的动力学中起着至关重要的作用。考虑一个频率为 $\\omega$、波矢为 $\\mathbf{k}$ 的哨声模波，它平行于均匀背景磁场 $\\mathbf{B}_0 = B_0 \\mathbf{\\hat{z}}$ 传播。虽然这些波主要是横波，但动理学处理揭示了一个微小的平行电场分量，该分量可通过与电子的共振相互作用导致朗道阻尼或增长。\n\n朗道阻尼率 $\\gamma$ 由以下表达式给出：\n$$\n\\gamma = \\mathcal{K}(\\omega, k) \\left. \\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} \\right|_{v_\\| = v_{ph}}\n$$\n其中 $v_{ph} = \\omega/k$ 是波的平行相速度，系数 $\\mathcal{K}(\\omega, k)$ 由下式给出：\n$$\n\\mathcal{K}(\\omega, k) = \\frac{\\pi \\omega_{pe}^2 \\omega^3}{2 k^4 c^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})}\n$$\n此处，$\\omega_{pe}$ 是电子等离子体频率，$\\Omega_{ce}$ 是电子回旋频率，而 $c$ 是光速。\n\n在磁层的某一特定区域，观测表明平行电子速度分布函数 $f_e(v_\\|)$ 并非简单的麦克斯韦分布。相反，它可以用一个具有核区损耗的对称卡帕分布很好地近似，该分布由以下函数描述：\n$$\nf_e(v_\\|) = A \\left[ \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+1)} - \\delta \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n在此表达式中，$A$ 是归一化常数，$v_{th}$ 是特征电子热速度，$\\kappa$ 是谱指数（一个大于 $3/2$ 的实数），$\\delta$ 是控制核区损耗深度的无量纲参数（$0 \\le \\delta \\le 1$），$w$ 是控制损耗宽度的无量纲参数。\n\n推导此等离子体中哨声模波的朗道阻尼率 $\\gamma$ 的解析表达式。最终答案应以 $\\omega, k, \\omega_{pe}, \\Omega_{ce}, c, A, \\kappa, v_{th}, \\delta$ 和 $w$ 表示。",
            "solution": "目标是推导哨声波与由特定速度分布函数 $f_e(v_\\|)$ 描述的电子相互作用时的朗道阻尼率 $\\gamma$。\n\n给定的阻尼率公式为：\n$$\n\\gamma = \\mathcal{K}(\\omega, k) \\left. \\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} \\right|_{v_\\| = v_{ph}}\n$$\n其中 $v_{ph} = \\omega/k$ 且 $\\mathcal{K}(\\omega, k) = \\frac{\\pi \\omega_{pe}^2 \\omega^3}{2 k^4 c^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})}$。\n\n电子分布函数为：\n$$\nf_e(v_\\|) = A \\left[ \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+1)} - \\delta \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**步骤1：对分布函数 $f_e(v_\\|)$ 关于 $v_\\|$ 求导。**\n\n我们对括号内的每一项应用链式法则。\n对于卡帕分布项：\n$$\n\\frac{\\partial}{\\partial v_\\|} \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+1)} = -(\\kappa+1) \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} \\cdot \\frac{\\partial}{\\partial v_\\|} \\left(\\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)\n$$\n$$\n= -(\\kappa+1) \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} \\cdot \\left(\\frac{2v_\\|}{\\kappa v_{th}^2}\\right)\n$$\n\n对于核区损耗（高斯）项：\n$$\n\\frac{\\partial}{\\partial v_\\|} \\left[-\\delta \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right)\\right] = -\\delta \\cdot \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\cdot \\frac{\\partial}{\\partial v_\\|} \\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right)\n$$\n$$\n= -\\delta \\cdot \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\cdot \\left(-\\frac{2v_\\|}{w^2 v_{th}^2}\\right) = \\frac{2\\delta v_\\|}{w^2 v_{th}^2} \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right)\n$$\n\n综合这些结果，完整的导数为：\n$$\n\\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} = A \\left[ -(\\kappa+1) \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} \\left(\\frac{2v_\\|}{\\kappa v_{th}^2}\\right) + \\frac{2\\delta v_\\|}{w^2 v_{th}^2} \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n我们可以提出公因子：\n$$\n\\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} = -2A \\frac{v_\\|}{v_{th}^2} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_\\|^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_\\|^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**步骤2：在共振相速度 $v_\\| = v_{ph} = \\omega/k$ 处计算该导数的值。**\n\n我们将 $v_\\| = v_{ph}$ 代入导数表达式中：\n$$\n\\left. \\frac{\\partial f_e(v_\\|)}{\\partial v_\\|} \\right|_{v_\\| = v_{ph}} = -2A \\frac{v_{ph}}{v_{th}^2} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_{ph}^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_{ph}^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**步骤3：将计算出的导数值代入 $\\gamma$ 的公式中。**\n\n$$\n\\gamma = \\mathcal{K}(\\omega, k) \\cdot \\left( -2A \\frac{v_{ph}}{v_{th}^2} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_{ph}^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_{ph}^2}{w^2 v_{th}^2}\\right) \\right] \\right)\n$$\n现在，代入 $\\mathcal{K}(\\omega, k)$ 的完整表达式：\n$$\n\\gamma = \\left( \\frac{\\pi \\omega_{pe}^2 \\omega^3}{2 k^4 c^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\right) \\cdot \\left( -2A \\frac{v_{ph}}{v_{th}^2} \\left[ \\dots \\right] \\right)\n$$\n因子 2 消掉了。\n$$\n\\gamma = - \\frac{\\pi A \\omega_{pe}^2 \\omega^3 v_{ph}}{k^4 c^2 v_{th}^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{v_{ph}^2}{\\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{v_{ph}^2}{w^2 v_{th}^2}\\right) \\right]\n$$\n\n**步骤4：最终简化。**\n\n使用 $v_{ph} = \\omega/k$，我们可以简化前置因子：\n$$\n\\frac{\\omega^3 v_{ph}}{k^4} = \\frac{\\omega^3 (\\omega/k)}{k^4} = \\frac{\\omega^4}{k^5}\n$$\n因此 $\\gamma$ 的表达式变为：\n$$\n\\gamma = - \\frac{\\pi A \\omega_{pe}^2 \\omega^4}{k^5 c^2 v_{th}^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{\\omega^2}{k^2 \\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{\\omega^2}{k^2 w^2 v_{th}^2}\\right) \\right]\n$$\n这就是朗道阻尼率的最终表达式。",
            "answer": "$$\n\\boxed{- \\frac{\\pi A \\omega_{pe}^2 \\omega^4}{k^5 c^2 v_{th}^2} \\frac{(1 - \\omega/\\Omega_{ce})^2}{1 - \\omega/(2\\Omega_{ce})} \\left[ \\frac{\\kappa+1}{\\kappa} \\left(1 + \\frac{\\omega^2}{k^2 \\kappa v_{th}^2}\\right)^{-(\\kappa+2)} - \\frac{\\delta}{w^2} \\exp\\left(-\\frac{\\omega^2}{k^2 w^2 v_{th}^2}\\right) \\right]}\n$$"
        }
    ]
}