{
    "hands_on_practices": [
        {
            "introduction": "为了从根本上理解考林反发电机定理，我们的第一个实践练习将问题简化为一个局部的笛卡尔坐标系。这种简化使我们能够得到一个精确的解析解，该解清晰地揭示了流体运动（平流）和电阻效应（扩散）各自扮演的角色。通过这个基础练习，我们将直接看到为何轴对称流动仅能输运磁场，而磁场本身却因扩散而不可避免地衰减 。",
            "id": "4214211",
            "problem": "考虑轴对称磁流体动力学（MHD），其中子午面内的极向磁场可以由一个标量极向磁通函数 $\\Psi(x,y,t)$ 表示，使得在子午面的一个局部笛卡尔坐标片 $(x,y)$ 中，轴对称极向场由 $\\boldsymbol{B}_{\\mathrm{p}} = \\nabla \\times \\left(\\Psi \\,\\hat{\\boldsymbol{e}}_{\\phi}\\right)$ 给出。假设存在一个由流函数 $\\chi(x,y)$ 表示的给定的、稳定的、无散的子午环流 $\\boldsymbol{u}(x,y)$，其形式为 $\\boldsymbol{u} = \\left(\\partial_{y}\\chi,-\\partial_{x}\\chi\\right)$，以及一个均匀的磁扩散率 $\\eta > 0$。从 MHD 的感应方程和轴对称磁通函数表示法出发，推导 $\\Psi(x,y,t)$ 所遵循的标量演化方程，该方程包含由 $\\boldsymbol{u}$ 引起的平流和由 $\\eta$ 引起的扩散。\n\n为了评估子午环流如何在不产生 $\\Psi$ 的情况下重新分布它，求解在特定的稳定流函数 \n$$\\chi(x,y) = U\\,y,$$\n（其中 $U>0$ 为常数）下 $\\Psi$ 的演化。求解区域为 $x$ 和 $y$ 上的双周期域，与波数 $k>0$ 和 $m>0$ 兼容。施加初始条件\n$$\\Psi(x,y,0) = \\Psi_{0}\\,\\cos\\!\\left(k\\,x\\right)\\cos\\!\\left(m\\,y\\right),$$\n其中 $\\Psi_{0}$ 是一个实常数。\n\n将得到的 $\\Psi(x,y,t)$ 以 $x$、$y$、$t$、$U$、$k$、$m$、$\\eta$ 和 $\\Psi_{0}$ 的函数的闭合形式表示。最终答案必须是单个解析表达式。不需要四舍五入，最终表达式中不应包含物理单位。",
            "solution": "基本出发点是 MHD 感应方程，\n$$\n\\partial_{t}\\boldsymbol{B}=\\nabla\\times\\left(\\boldsymbol{u}\\times\\boldsymbol{B}\\right)+\\eta\\,\\nabla^{2}\\boldsymbol{B},\n$$\n其中 $\\eta$ 为均匀的磁扩散率。在轴对称情况下，极向磁场可以通过标量磁通函数 $\\Psi$ 表示为 $\\boldsymbol{B}_{\\mathrm{p}}=\\nabla\\times\\left(\\Psi\\,\\hat{\\boldsymbol{e}}_{\\phi}\\right)$。对于纯子午流 $\\boldsymbol{u}_{\\mathrm{p}}$（无环向分量），$\\Psi$ 的演化是解耦的，并遵循一个标量平流-扩散方程。这是通过将轴对称表示代入感应方程，投影到子午面上，并使用 $\\nabla\\cdot\\boldsymbol{u}_{\\mathrm{p}}=0$ 得出的。结果是\n$$\n\\partial_{t}\\Psi + \\boldsymbol{u}_{\\mathrm{p}}\\cdot\\nabla\\Psi = \\eta\\,\\nabla^{2}\\Psi,\n$$\n其中 $\\boldsymbol{u}_{\\mathrm{p}}$ 是子午环流。这个方程没有 $\\Psi$ 的源项，这与 Cowling 反发电机定理一致：轴对称流不能产生或维持轴对称磁场；它们只能重新分布已有的磁通，而扩散会将其耗散掉。\n\n我们现在指定给定的流函数 $\\chi(x,y)=U\\,y$，它产生了子午速度场\n$$\n\\boldsymbol{u}(x,y)=\\left(\\partial_{y}\\chi,-\\partial_{x}\\chi\\right)=\\left(U,\\,0\\right).\n$$\n因此，平流-扩散方程变为\n$$\n\\partial_{t}\\Psi + U\\,\\partial_{x}\\Psi = \\eta\\left(\\partial_{x}^{2}\\Psi+\\partial_{y}^{2}\\Psi\\right).\n$$\n求解域是双周期的，初始条件为\n$$\n\\Psi(x,y,0)=\\Psi_{0}\\,\\cos(kx)\\cos(my).\n$$\n\n这个具有常系数的线性偏微分方程可以通过变换到一个随动坐标系来求解，从而消除平流项。定义\n$$\n\\xi \\equiv x - U t,\n$$\n并写作 $\\Psi(x,y,t)=\\Phi(\\xi,y,t)$。使用链式法则，\n$$\n\\partial_{t}\\Psi = \\partial_{t}\\Phi - U\\,\\partial_{\\xi}\\Phi,\\quad \\partial_{x}\\Psi=\\partial_{\\xi}\\Phi,\\quad \\partial_{x}^{2}\\Psi=\\partial_{\\xi}^{2}\\Phi,\\quad \\partial_{y}^{2}\\Psi=\\partial_{y}^{2}\\Phi.\n$$\n将这些代入方程，得到\n$$\n\\left(\\partial_{t}\\Phi - U\\,\\partial_{\\xi}\\Phi\\right) + U\\,\\partial_{\\xi}\\Phi = \\eta\\left(\\partial_{\\xi}^{2}\\Phi+\\partial_{y}^{2}\\Phi\\right),\n$$\n这简化为纯扩散方程\n$$\n\\partial_{t}\\Phi = \\eta\\left(\\partial_{\\xi}^{2}\\Phi+\\partial_{y}^{2}\\Phi\\right).\n$$\n在随动坐标系中，$t=0$ 时的初始条件是 $\\Phi(\\xi,y,0)=\\Psi_{0}\\cos(k\\xi)\\cos(my)$，因为在 $t=0$ 时 $\\xi=x$。在一个周期域上，$\\cos(k\\xi)\\cos(my)$ 是拉普拉斯算子的特征函数，其特征值为 $-(k^{2}+m^{2})$，即\n$$\n\\left(\\partial_{\\xi}^{2}+\\partial_{y}^{2}\\right)\\left[\\cos(k\\xi)\\cos(my)\\right] = -\\left(k^{2}+m^{2}\\right)\\cos(k\\xi)\\cos(my).\n$$\n因此，扩散问题的解是振幅的简单指数衰减：\n$$\n\\Phi(\\xi,y,t) = \\Psi_{0}\\,\\exp\\!\\left[-\\eta\\left(k^{2}+m^{2}\\right)t\\right]\\cos(k\\xi)\\cos(my).\n$$\n使用 $\\xi=x-Ut$ 变换回实验室坐标 $(x,y)$，得到\n$$\n\\Psi(x,y,t) = \\Psi_{0}\\,\\exp\\!\\left[-\\eta\\left(k^{2}+m^{2}\\right)t\\right]\\cos\\!\\left(k\\left(x-Ut\\right)\\right)\\cos(my).\n$$\n\n这个显式解展现了与轴对称情况下的 Cowling 反发电机定理一致的两个基本特征：子午环流 $\\boldsymbol{u}=(U,0)$ 仅仅是平流输运该模式，使其在 $x$ 方向的相位移动了 $Ut$，而振幅以速率 $\\eta\\left(k^{2}+m^{2}\\right)$ 扩散性地衰减；没有可以放大 $\\Psi$ 的源项。平流造成的重新分布在平移的意义下保留了空间结构，而扩散则单调地减小其大小。\n\n因此，极向磁通函数的闭合形式演化如上所示。",
            "answer": "$$\\boxed{\\Psi_{0}\\,\\exp\\!\\left[-\\eta\\left(k^{2}+m^{2}\\right)t\\right]\\cos\\!\\left(k\\left(x-Ut\\right)\\right)\\cos\\!\\left(m y\\right)}$$"
        },
        {
            "introduction": "在理解了局域模型中的基本物理过程后，我们现在转向一个更符合天体物理实际的全局几何模型——球壳，这对于研究恒星和行星至关重要。本练习要求计算轴对称磁场因欧姆扩散而产生的自然衰减模式 。这项任务揭示了，在没有发电机机制的情况下，任何初始磁场都会分解为一系列以特定速率指数衰减的本征模式。",
            "id": "4214212",
            "problem": "考虑一个静止的导电、不可压缩流体，位于内半径为 $r_i$、外半径为 $r_o$ 的球壳中，其中 $0  r_i  r_o$。该球壳具有均匀的磁扩散率 $\\eta$，其两侧（$r  r_i$ 和 $r > r_o$）均为真空。假设系统具有轴对称性（方位角模数 $m = 0$），并且用磁矢量势的方位角分量 $A_\\phi(r,\\theta,t)$ 来表示极向磁场，因此磁场为 $\\boldsymbol{B} = \\nabla \\times \\left( A_\\phi \\,\\boldsymbol{e}_\\phi \\right)$。流体没有流动，因此磁场纯粹通过欧姆扩散演化。\n\n仅从库仑规范下的矢量势的电阻磁流体动力学（MHD）感应定律、球坐标中矢量拉普拉斯算子的定义以及无电流（真空）边界条件出发，完成以下任务：\n\n- 推导导电壳内 $A_\\phi(r,\\theta,t)$ 所满足的标量扩散方程。\n- 使用分离变量法，设 $A_\\phi(r,\\theta,t) = R(r)\\,\\Theta(\\theta)\\,\\exp(-\\lambda t)$，得到分离后的角向和径向本征值问题。确定角向本征函数及其本征值。\n- 通过在两个球形界面上强制磁场连续，施加与 $r  r_i$ 和 $r > r_o$ 区域真空的匹配条件。在 $r=r_i$ 和 $r=r_o$ 处推导关于 $R(r)$ 的齐次罗宾边界条件，该条件包含了外部/内部真空的信息。\n- 求解壳内的径向本征问题，并推导确定允许波数 $k$（定义为 $k^2 = \\lambda/\\eta$）的超越方程，适用于每个球谐阶数 $l \\ge 1$。\n- 因此，将轴对称本征模的衰减率表示为关于 $\\eta$ 和允许波数 $k$ 的单个封闭形式符号表达式。\n\n你的最终答案必须是衰减率 $\\lambda_{l n}$ 的单个符号表达式，用 $\\eta$ 和你通过边界值问题定义的允许径向波数 $k_{l n}$ 来表示。最终答案中不要包含单位。无需进行数值计算。",
            "solution": "该问题被验证为具有科学依据、良态且客观。这是一个天体物理磁流体动力学中的标准问题，涉及球形导体中磁场的欧姆衰减。衰减模式的推导是电阻磁流体动力学（MHD）原理的直接应用。\n\n出发点是对于具有均匀磁扩散率 $\\eta$ 和速度 $\\boldsymbol{v}$ 的流体的电阻 MHD 感应方程：\n$$ \\frac{\\partial \\boldsymbol{B}}{\\partial t} = \\nabla \\times (\\boldsymbol{v} \\times \\boldsymbol{B} - \\eta \\nabla \\times \\boldsymbol{B}) $$\n鉴于流体静止，$\\boldsymbol{v} = \\boldsymbol{0}$，方程简化为纯扩散方程：\n$$ \\frac{\\partial \\boldsymbol{B}}{\\partial t} = -\\eta \\nabla \\times (\\nabla \\times \\boldsymbol{B}) $$\n磁场 $\\boldsymbol{B}$ 是螺线场（$\\nabla \\cdot \\boldsymbol{B} = 0$），因此我们可以用矢量势 $\\boldsymbol{A}$ 来表示它，使得 $\\boldsymbol{B} = \\nabla \\times \\boldsymbol{A}$。将此代入扩散方程得到：\n$$ \\nabla \\times \\left( \\frac{\\partial \\boldsymbol{A}}{\\partial t} \\right) = -\\eta \\nabla \\times (\\nabla \\times (\\nabla \\times \\boldsymbol{A})) $$\n使用恒等式 $\\nabla \\times (\\nabla \\times \\boldsymbol{F}) = \\nabla(\\nabla \\cdot \\boldsymbol{F}) - \\nabla^2 \\boldsymbol{F}$ 并在库仑规范（$\\nabla \\cdot \\boldsymbol{A} = 0$）下，右侧变为 $\\eta \\nabla \\times (\\nabla^2 \\boldsymbol{A})$。\n$$ \\nabla \\times \\left( \\frac{\\partial \\boldsymbol{A}}{\\partial t} \\right) = \\nabla \\times (\\eta \\nabla^2 \\boldsymbol{A}) $$\n这意味着 $\\frac{\\partial \\boldsymbol{A}}{\\partial t} = \\eta \\nabla^2 \\boldsymbol{A} + \\nabla \\psi$，其中 $\\psi$ 是某个标量函数。通过规范选择，我们可以设 $\\psi=0$，从而得到矢量扩散方程：\n$$ \\frac{\\partial \\boldsymbol{A}}{\\partial t} = \\eta \\nabla^2 \\boldsymbol{A} $$\n问题指定了一个轴对称（$\\partial/\\partial\\phi=0$）、极向的磁场，它由一个纯环向的矢量势 $\\boldsymbol{A} = A_\\phi(r, \\theta, t) \\boldsymbol{e}_\\phi$ 生成。对于这种形式的 $\\boldsymbol{A}$，由于轴对称性，库仑规范条件 $\\nabla \\cdot \\boldsymbol{A} = 0$ 自动满足。在球坐标中，此类矢量场的矢量拉普拉斯算子 $\\nabla^2 \\boldsymbol{A}$ 的 $\\phi$ 分量是 $(\\nabla^2 \\boldsymbol{A})_\\phi = \\nabla^2 A_\\phi - \\frac{A_\\phi}{r^2 \\sin^2\\theta}$，其中 $\\nabla^2$ 是标量拉普拉斯算子。因此，在导电壳（$r_i \\le r \\le r_o$）内，标量函数 $A_\\phi(r,\\theta,t)$ 的控制偏微分方程是：\n$$ \\frac{\\partial A_\\phi}{\\partial t} = \\eta \\left( \\nabla^2 A_\\phi - \\frac{A_\\phi}{r^2 \\sin^2\\theta} \\right) $$\n在轴对称情况下，标量拉普拉斯算子为 $\\nabla^2 = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}(r^2 \\frac{\\partial}{\\partial r}) + \\frac{1}{r^2 \\sin\\theta}\\frac{\\partial}{\\partial\\theta}(\\sin\\theta \\frac{\\partial}{\\partial\\theta})$。\n\n我们使用分离变量法，假设解的形式为 $A_\\phi(r,\\theta,t) = R(r)\\Theta(\\theta)\\exp(-\\lambda t)$，其中 $\\lambda$ 是衰减率。将此代入偏微分方程得到：\n$$ -\\lambda R(r)\\Theta(\\theta) = \\eta \\left[ \\frac{\\Theta(\\theta)}{r^2}\\frac{d}{dr}\\left(r^2 \\frac{dR}{dr}\\right) + \\frac{R(r)}{r^2\\sin\\theta}\\frac{d}{d\\theta}\\left(\\sin\\theta \\frac{d\\Theta}{d\\theta}\\right) - \\frac{R(r)\\Theta(\\theta)}{r^2\\sin^2\\theta} \\right] $$\n两边同乘以 $\\frac{r^2}{\\eta R(r)\\Theta(\\theta)}$ 并重新整理，可分离径向和角向部分：\n$$ \\frac{1}{R(r)}\\frac{d}{dr}\\left(r^2 \\frac{dR}{dr}\\right) + \\frac{\\lambda}{\\eta}r^2 = -\\left[ \\frac{1}{\\Theta(\\theta)\\sin\\theta}\\frac{d}{d\\theta}\\left(\\sin\\theta \\frac{d\\Theta}{d\\theta}\\right) - \\frac{1}{\\sin^2\\theta} \\right] $$\n等式两边必须等于一个分离常数。角向方程为：\n$$ \\frac{1}{\\sin\\theta}\\frac{d}{d\\theta}\\left(\\sin\\theta \\frac{d\\Theta}{d\\theta}\\right) + \\left( C - \\frac{1}{\\sin^2\\theta} \\right) \\Theta = 0 $$\n这是方位角数 $m=1$ 的连带勒让德方程。对于物理上行为良好的解，分离常数必须是 $C=l(l+1)$，其中 $l \\ge 1$ 为整数。本征函数是第一类连带勒让德函数，$\\Theta(\\theta) = P_l^1(\\cos\\theta)$。$l=0$ 的情况是平凡的，因为 $P_0^1=0$。\n\n径向方程则变为：\n$$ \\frac{1}{R(r)}\\frac{d}{dr}\\left(r^2 \\frac{dR}{dr}\\right) + \\frac{\\lambda}{\\eta}r^2 = l(l+1) $$\n定义波数 $k$ 使得 $k^2 = \\lambda/\\eta$，我们得到球贝塞尔方程：\n$$ r^2 \\frac{d^2R}{dr^2} + 2r \\frac{dR}{dr} + \\left(k^2 r^2 - l(l+1)\\right) R = 0 $$\n通解是第一类和第二类球贝塞尔函数的线性组合：$R(r) = c_1 j_l(kr) + c_2 y_l(kr)$。\n\n接下来，我们建立边界条件。在真空区域（$r  r_i$ 和 $r > r_o$），电流为零，$\\boldsymbol{J} = \\nabla \\times \\boldsymbol{B} = \\boldsymbol{0}$。对于极向场，这意味着 $\\left(\\nabla^2 - \\frac{1}{r^2\\sin^2\\theta}\\right)A_\\phi = 0$。该方程的径向部分是 $\\frac{d}{dr}(r^2 \\frac{dR}{dr}) - l(l+1)R=0$，其通解为 $R_{\\text{vac}}(r) = c_3 r^l + c_4 r^{-(l+1)}$。\n对于内部真空区域（$r  r_i$），在 $r=0$ 处的正则性要求 $c_4=0$，所以 $A_\\phi^{\\text{in}} \\propto r^l P_l^1(\\cos\\theta)$。\n对于外部真空区域（$r > r_o$），在 $r\\to\\infty$ 处的正则性要求 $c_3=0$，所以 $A_\\phi^{\\text{out}} \\propto r^{-(l+1)} P_l^1(\\cos\\theta)$。\n\n在界面 $r=r_i$ 和 $r=r_o$ 处，没有表面电流意味着磁场 $\\boldsymbol{B}$ 必须是连续的。其分量为 $B_r = \\frac{1}{r\\sin\\theta}\\frac{\\partial}{\\partial\\theta}(A_\\phi \\sin\\theta)$ 和 $B_\\theta = -\\frac{1}{r}\\frac{\\partial}{\\partial r}(r A_\\phi)$。$\\boldsymbol{B}$ 的连续性要求 $A_\\phi$ 和 $\\frac{\\partial}{\\partial r}(r A_\\phi)$ 的连续性。忽略公共的角向因子，这些条件适用于径向函数。\n\n在内边界 $r=r_i$ 处：\n$R(r_i) = C_{\\text{in}}r_i^l$\n$\\frac{d}{dr}(rR)|_{r=r_i} = \\frac{d}{dr}(C_{\\text{in}}r^{l+1})|_{r=r_i} = (l+1)C_{\\text{in}}r_i^l$。\n代入 $C_{\\text{in}}$ 可得 $R(r_i)+r_i R'(r_i) = (l+1)R(r_i)$，简化为罗宾边界条件：\n$$ r_i \\frac{dR}{dr}(r_i) - l R(r_i) = 0 $$\n\n在外边界 $r=r_o$ 处：\n$R(r_o) = C_{\\text{out}}r_o^{-(l+1)}$\n$\\frac{d}{dr}(rR)|_{r=r_o} = \\frac{d}{dr}(C_{\\text{out}}r^{-l})|_{r=r_o} = -l C_{\\text{out}}r_o^{-l-1}$。\n代入 $C_{\\text{out}}$ 可得 $R(r_o)+r_o R'(r_o) = -l R(r_o)$，简化为：\n$$ r_o \\frac{dR}{dr}(r_o) + (l+1) R(r_o) = 0 $$\n\n我们将这两个边界条件应用于通解 $R(r) = c_1 j_l(kr) + c_2 y_l(kr)$。使用球贝塞尔函数的恒等式 $z f_l'(z) - l f_l(z) = -z f_{l+1}(z)$ 和 $z f_l'(z) + (l+1) f_l(z) = z f_{l-1}(z)$，其中 $f_l$ 是 $j_l$ 或 $y_l$，$z=kr$：\n在 $r=r_i$ 处的条件变为：$c_1[-kr_i j_{l+1}(kr_i)] + c_2[-kr_i y_{l+1}(kr_i)] = 0$，即\n$$ c_1 j_{l+1}(kr_i) + c_2 y_{l+1}(kr_i) = 0 $$\n在 $r=r_o$ 处的条件变为：$c_1[kr_o j_{l-1}(kr_o)] + c_2[kr_o y_{l-1}(kr_o)] = 0$，即\n$$ c_1 j_{l-1}(kr_o) + c_2 y_{l-1}(kr_o) = 0 $$\n为了使系数 $(c_1, c_2)$ 有非平凡解，该线性方程组的行列式必须为零。这得出了允许波数 $k$ 的超越本征值条件：\n$$ j_{l+1}(kr_i) y_{l-1}(kr_o) - j_{l-1}(kr_o) y_{l+1}(kr_i) = 0 $$\n对于每个整数多极阶数 $l \\ge 1$，该方程有可数无限个正根，我们将其记为 $k_{ln}$，其中 $n=1, 2, 3, \\dots$。每个 $k_{ln}$ 对应一个不同的径向本征模。\n\n最后，衰减率 $\\lambda$ 由关系式 $\\lambda = \\eta k^2$ 定义。因此，每个允许的波数 $k_{ln}$ 对应一个特定的衰减率 $\\lambda_{ln}$。这些衰减率的表达式由下式给出：\n$$ \\lambda_{ln} = \\eta k_{ln}^2 $$\n此表达式给出了第 $(l,n)$ 个轴对称极向磁场本征模的衰减率。",
            "answer": "$$\\boxed{\\eta k_{ln}^2}$$"
        },
        {
            "introduction": "虽然解析解功能强大，但许多现实场景过于复杂，无法手动求解。最后的这个实践练习将引入计算方法，要求你构建一个数值求解器来模拟磁场的演化 。这不仅使我们能够探索在更复杂的流动下磁场的行为，也提供了一个验证和可视化反发电机定理理论预测的有力工具，从而将理论与现代科学计算实践联系起来。",
            "id": "4214219",
            "problem": "考虑在具有给定的、不随时间变化的、轴对称流和有限磁扩散率的导电流体中的运动学磁流体动力学感应方程。其基本出发点是磁场 $\\,\\mathbf{B}\\,$ 的感应方程：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) + \\eta \\nabla^2 \\mathbf{B},\n$$\n该方程满足 $\\,\\nabla \\cdot \\mathbf{B} = 0\\,$ 条件，其中 $\\,\\mathbf{u}\\,$ 是速度场，$\\,\\eta  0\\,$ 是磁扩散率。对于球坐标 $\\, (r,\\theta,\\phi)\\,$ 中具有方位对称性（无 $\\,\\phi\\,$ 依赖）的轴对称场，$\\,\\mathbf{B}\\,$ 的极向分量可以由一个标量极向磁通函数 $\\,\\Psi(r,\\theta,t)\\,$ 表示。流被假定为轴对称且纯经向的，其给定分量为 $\\,u_r(r)\\,$ 和 $\\,u_\\theta(\\theta)\\,$。在运动学体系中，$\\,\\mathbf{u}\\,$ 是给定的并且不随时间演化。\n\n您的任务是：\n1. 从感应方程和轴对称的极向-环向分解出发，在球坐标中推导极向磁通函数 $\\,\\Psi(r,\\theta,t)\\,$ 的演化方程。您必须仅使用所提供的基本定律和核心定义，不得使用快捷公式。\n2. 使用推导出的方程，实现一个稳定的数值求解器，用于在球壳 $\\,r \\in [r_i,r_o]\\,$ 和极角 $\\,\\theta \\in [\\theta_{\\min},\\theta_{\\max}]\\,$ 上演化 $\\,\\Psi(r,\\theta,t)\\,$，并在所有边界上施加狄利克雷边界条件 $\\,\\Psi=0\\,$。对 $\\,r\\,$, $\\,\\theta\\,$ 和 $\\,t\\,$ 使用无量纲变量进行计算（无物理单位）。\n3. 采用以下区域和初始条件：\n   - $\\,r_i = 0.7\\,$, $\\,r_o = 1.0\\,$.\n   - $\\,\\theta_{\\min} = 0.05\\,$ 弧度, $\\,\\theta_{\\max} = \\pi - 0.05\\,$ 弧度。\n   - 初始极向磁通函数 $\\,\\Psi(r,\\theta,0) = r^2 \\sin^2 \\theta\\,$.\n4. 轴对称经向流分量规定如下：\n   - $\\,u_r(r) = \\alpha \\, r \\,(1-r)^2\\,$.\n   - $\\,u_\\theta(\\theta) = \\beta \\,\\sin\\theta\\,\\cos\\theta\\,$.\n   这里的 $\\,\\alpha\\,$ 和 $\\,\\beta\\,$ 是每个测试用例提供的无量纲振幅。\n5. 实现一个稳定且与 $\\,\\Psi\\,$ 的演化方程的对流-扩散特性相容的有限差分格式。对流项使用迎风离散化，扩散项使用中心差分。选择一个满足对流和扩散的 Courant-Friedrichs-Lewy (CFL) 约束的时间步长 $\\,\\Delta t\\,$。在每个时间步之后，在所有边界上强制执行 $\\,\\Psi=0\\,$。\n6. 对于每个测试用例，运行模拟直到指定的无量纲时间 $\\,T\\,$，并计算 $\\,M(T) = \\max_{(r,\\theta)} |\\Psi(r,\\theta,T)|\\,$。令 $\\,M(0)\\,$ 为初始条件的最大值。确定 $\\,M(T)\\,$ 是否保持在指定阈值 $\\,\\Psi_{\\mathrm{thr}} = \\gamma \\, M(0)\\,$ 之上，其中 $\\,\\gamma \\in (0,1)\\,$ 由每个测试用例提供。每个测试用例的答案必须是一个布尔值：如果 $\\,M(T) \\ge \\Psi_{\\mathrm{thr}}\\,$ 则为 $\\,\\text{True}\\,$，否则为 $\\,\\text{False}\\,$.\n7. 为以下测试套件提供结果，该套件探讨了不同的扩散率和流强度：\n   - 测试用例 1 (一般情况): $\\alpha = 0.10$, $\\beta = 0.10$, $\\eta = 10^{-2}$, $T = 1.0$, $\\gamma = 0.95$.\n   - 测试用例 2 (近理想导体，短时间): $\\alpha = 0.10$, $\\beta = 0.10$, $\\eta = 10^{-6}$, $T = 0.2$, $\\gamma = 0.99$.\n   - 测试用例 3 (强扩散): $\\alpha = 0.30$, $\\beta = 0.20$, $\\eta = 5 \\times 10^{-2}$, $T = 0.5$, $\\gamma = 0.90$.\n   - 测试用例 4 (长时间衰减): $\\alpha = 0.05$, $\\beta = 0.05$, $\\eta = 10^{-3}$, $T = 4.0$, $\\gamma = 0.60$.\n8. 网格分辨率：在 $\\,r\\,$ 方向上使用 $\\,N_r = 64\\,$ 个点，在 $\\,\\theta\\,$ 方向上使用 $\\,N_\\theta = 128\\,$ 个点，并在指定区间上均匀分布。\n9. 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,result4]”），其中每个结果是相应测试用例的布尔值。\n\n您的推导和实现必须与 Cowling 反发电机定理相符，即当 $\\,\\eta  0\\,$ 时，轴对称流无法无限期地维持轴对称场。然而，您的程序仍必须执行指定的显式数值演化，并返回任务 6 中定义的布尔结果。您推导中的所有变量都必须用 LaTeX 表示。所有量都是无量纲的；不使用也不报告任何物理单位。角度必须以弧度为单位。最终的程序必须是独立完整的，无需用户输入。",
            "solution": "用户提供了一个关于运动学磁流体动力学（MHD）的问题，涉及在给定的轴对称流中轴对称磁场的演化。我必须首先验证问题陈述的有效性，如果有效，则提供控制方程的完整推导和相应的数值求解器。\n\n### 第 1 步：提取给定条件\n- **控制方程**：磁场 $\\,\\mathbf{B}\\,$ 的 MHD 感应方程为 $\\,\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) + \\eta \\nabla^2 \\mathbf{B}\\,$.\n- **约束条件**：磁场是无散的，$\\,\\nabla \\cdot \\mathbf{B} = 0\\,$.\n- **参数**：$\\,\\eta  0\\,$ 是磁扩散率。\n- **对称性**：问题是轴对称的，意味着没有对方位坐标 $\\,\\phi\\,$ 的依赖。\n- **场表示**：极向磁场由一个标量磁通函数 $\\,\\Psi(r,\\theta,t)\\,$ 描述。\n- **流场**：速度场 $\\,\\mathbf{u}\\,$ 是给定的、不随时间变化、轴对称且纯经向的，其分量为 $\\,u_r(r) = \\alpha \\, r \\,(1-r)^2\\,$ 和 $\\,u_\\theta(\\theta) = \\beta \\,\\sin\\theta\\,\\cos\\theta\\,$.\n- **区域**：球壳，其中 $\\,r \\in [r_i, r_o] = [0.7, 1.0]\\,$ 且 $\\,\\theta \\in [\\theta_{\\min}, \\theta_{\\max}] = [0.05, \\pi - 0.05]\\,$ 弧度。\n- **初始条件**：$\\,\\Psi(r,\\theta,0) = r^2 \\sin^2 \\theta\\,$.\n- **边界条件**：在区域的所有边界上施加狄利克雷边界条件 $\\,\\Psi=0\\,$。\n- **数值格式**：有限差分法，对流项使用迎风离散化，扩散项使用中心差分，时间步长 $\\,\\Delta t\\,$ 满足 CFL 约束。\n- **网格分辨率**：半径方向 $\\,N_r = 64\\,$ 个点，极角方向 $\\,N_\\theta = 128\\,$ 个点。\n- **任务**：对于每个测试用例，模拟到时间 $\\,T\\,$，找到磁通函数的最大绝对值 $\\,M(T) = \\max|\\Psi(r,\\theta,T)|\\,$，并确定是否 $\\,M(T) \\ge \\gamma M(0)\\,$，其中 $\\,M(0) = \\max|\\Psi(r,\\theta,0)|\\,$.\n- **测试用例**：\n    1.  $\\alpha = 0.10$, $\\beta = 0.10$, $\\eta = 10^{-2}$, $T = 1.0$, $\\gamma = 0.95$.\n    2.  $\\alpha = 0.10$, $\\beta = 0.10$, $\\eta = 10^{-6}$, $T = 0.2$, $\\gamma = 0.99$.\n    3.  $\\alpha = 0.30$, $\\beta = 0.20$, $\\eta = 5 \\times 10^{-2}$, $T = 0.5$, $\\gamma = 0.90$.\n    4.  $\\alpha = 0.05$, $\\beta = 0.05$, $\\eta = 10^{-3}$, $T = 4.0$, $\\gamma = 0.60$.\n- **输出格式**：一个单行字符串，包含逗号分隔的布尔结果列表，例如 `[result1,result2,result3,result4]`。\n\n### 第 2 步：使用提取的给定条件进行验证\n1.  **科学依据**：该问题基于 MHD 感应方程，这是等离子体物理学的基本定律。极向-环向分解和极向磁通函数的概念是标准技术。该设置与 Cowling 反发电机定理一致，该定理指出轴对称流无法维持轴对称磁场。该问题在科学上是合理的。\n2.  **适定性**：该问题定义了一个具有明确初始和边界条件的抛物型偏微分方程（一个初边值问题）。流场是指定的。这种配置是适定的，允许唯一且稳定的解。\n3.  **客观性**：所有描述和任务都是定量和精确的，没有任何主观或含糊的语言。\n4.  **完整性**：提供了所有必要的参数、函数、区域规格和数值要求。该问题是独立完整的。\n5.  **一致性**：所提供的信息没有内部矛盾。\n\n### 第 3 步：结论与行动\n该问题有效。它是一个在计算天体物理学中适定且有科学依据的问题。我将继续进行推导和求解。\n\n---\n\n### 第 1 部分：$\\Psi(r,\\theta,t)$ 演化方程的推导\n\n推导从提供的基本方程和定义开始。对于轴对称系统，磁场 $\\,\\mathbf{B}\\,$ 可以分解为极向 ($\\,\\mathbf{B}_P\\,$) 和环向 ($\\,\\mathbf{B}_T\\,$) 分量。通过将极向场表示为矢量势的旋度，可以自动满足无散条件 $\\,\\nabla \\cdot \\mathbf{B} = 0\\,$。对于轴对称性，该矢量势只有一个方位角分量，$\\,\\mathbf{A} = A_\\phi(r,\\theta,t) \\hat{\\boldsymbol{\\phi}}\\,$。极向场则为 $\\,\\mathbf{B}_P = \\nabla \\times \\mathbf{A}\\,$。\n\n极向磁通函数 $\\,\\Psi(r,\\theta,t)\\,$ 通过矢量势分量 $\\,A_\\phi\\,$ 定义为 $\\,\\Psi = r \\sin\\theta \\, A_\\phi\\,$。因此，$\\,\\mathbf{A} = \\frac{\\Psi}{r \\sin\\theta} \\hat{\\boldsymbol{\\phi}}\\,$。\n\n在球坐标系 $\\,(r, \\theta, \\phi)\\,$ 中使用旋度算子，极向磁场的分量由 $\\,\\mathbf{B}_P = \\nabla \\times (\\frac{\\Psi}{r \\sin\\theta} \\hat{\\boldsymbol{\\phi}})\\,$ 推导得出。\n$$\nB_{P,r} = \\frac{1}{r \\sin\\theta} \\frac{\\partial}{\\partial\\theta} \\left(\\sin\\theta \\frac{\\Psi}{r \\sin\\theta}\\right) = \\frac{1}{r^2 \\sin\\theta} \\frac{\\partial\\Psi}{\\partial\\theta}\n$$\n$$\nB_{P,\\theta} = -\\frac{1}{r} \\frac{\\partial}{\\partial r} \\left(r \\frac{\\Psi}{r \\sin\\theta}\\right) = -\\frac{1}{r \\sin\\theta} \\frac{\\partial\\Psi}{\\partial r}\n$$\n由于从 $\\,\\Psi(r,\\theta,0) = r^2\\sin^2\\theta\\,$ 推导出的初始磁场是纯极向的，并且流是纯经向的，因此不会产生环向场 $\\,B_\\phi\\,$。环向分量的感应方程表明，$\\,\\frac{\\partial B_\\phi}{\\partial t}\\,$ 仅依赖于 $\\,B_\\phi\\,$ 及其导数（对于这种流场几何，不存在所谓的 $\\,\\omega$-效应）。由于 $\\,B_\\phi(t=0)=0\\,$，我们有 $\\,B_\\phi(t)=0\\,$ 在所有时间都成立。因此，总磁场始终是纯极向的，$\\,\\mathbf{B} = \\mathbf{B}_P\\,$。\n\n为了找到 $\\,\\Psi\\,$ 的演化方程，我们从法拉第定律 $\\,\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}\\,$ 开始，其中 $\\,\\mathbf{E}\\,$ 是电场。结合运动导体的一般化欧姆定律 $\\,\\mathbf{E} = -\\mathbf{u} \\times \\mathbf{B} + \\eta \\mathbf{J}\\,$，其中 $\\,\\mathbf{J} = \\frac{1}{\\mu_0}\\nabla\\times\\mathbf{B}\\,$（在国际单位制中），我们得到感应方程。提供的无量纲形式为 $\\,\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B} - \\eta \\nabla \\times \\mathbf{B})\\,$。\n\n代入 $\\,\\mathbf{B} = \\nabla \\times \\mathbf{A}\\,$:\n$$\n\\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{A}) = \\nabla \\times \\left(\\mathbf{u} \\times (\\nabla \\times \\mathbf{A}) - \\eta \\nabla \\times (\\nabla \\times \\mathbf{A})\\right)\n$$\n我们可以将时间导数移到旋度内部并重新排列，得到：\n$$\n\\nabla \\times \\left(\\frac{\\partial \\mathbf{A}}{\\partial t} - \\mathbf{u} \\times \\mathbf{B} + \\eta \\nabla \\times \\mathbf{B}\\right) = 0\n$$\n这意味着括号内的项是某个标量势的梯度，在适当的规范（韦尔规范）下可以设为零。取剩余矢量方程的 $\\,\\phi\\,$ 分量：\n$$\n\\frac{\\partial A_\\phi}{\\partial t} = (\\mathbf{u} \\times \\mathbf{B})_\\phi - \\eta (\\nabla \\times \\mathbf{B})_\\phi\n$$\n速度是纯经向的，$\\,\\mathbf{u} = u_r \\hat{\\mathbf{r}} + u_\\theta \\hat{\\boldsymbol{\\theta}}\\,$，而场是纯极向的，$\\,\\mathbf{B} = B_r \\hat{\\mathbf{r}} + B_\\theta \\hat{\\boldsymbol{\\theta}}\\,$。右侧的两项变为：\n1.  **对流项**: $(\\mathbf{u} \\times \\mathbf{B})_\\phi = u_r B_\\theta - u_\\theta B_r$。将 $\\,B_r\\,$ 和 $\\,B_\\theta\\,$ 用 $\\,\\Psi\\,$ 表示的表达式代入：\n    $$\n    u_r \\left(-\\frac{1}{r \\sin\\theta} \\frac{\\partial\\Psi}{\\partial r}\\right) - u_\\theta \\left(\\frac{1}{r^2 \\sin\\theta} \\frac{\\partial\\Psi}{\\partial\\theta}\\right) = -\\frac{1}{r \\sin\\theta} \\left(u_r \\frac{\\partial\\Psi}{\\partial r} + \\frac{u_\\theta}{r} \\frac{\\partial\\Psi}{\\partial\\theta}\\right) = -\\frac{1}{r \\sin\\theta} (\\mathbf{u} \\cdot \\nabla \\Psi)\n    $$\n2.  **扩散项**: $(\\nabla \\times \\mathbf{B})_\\phi$ 是电流密度的环向分量。\n    $$\n    (\\nabla \\times \\mathbf{B})_\\phi = \\frac{1}{r}\\left(\\frac{\\partial(r B_\\theta)}{\\partial r} - \\frac{\\partial B_r}{\\partial\\theta}\\right)\n    $$\n    代入场分量：\n    $$\n    (\\nabla \\times \\mathbf{B})_\\phi = \\frac{1}{r}\\left[\\frac{\\partial}{\\partial r}\\left(r \\left(-\\frac{1}{r\\sin\\theta}\\frac{\\partial\\Psi}{\\partial r}\\right)\\right) - \\frac{\\partial}{\\partial\\theta}\\left(\\frac{1}{r^2\\sin\\theta}\\frac{\\partial\\Psi}{\\partial\\theta}\\right)\\right] = -\\frac{1}{r\\sin\\theta}\\left[\\frac{\\partial^2\\Psi}{\\partial r^2} + \\frac{\\sin\\theta}{r^2}\\frac{\\partial}{\\partial\\theta}\\left(\\frac{1}{\\sin\\theta}\\frac{\\partial\\Psi}{\\partial\\theta}\\right)\\right]\n    $$\n    方括号中的算子是 Grad-Shafranov 算子，记为 $\\,\\Delta^*\\,$. 所以，$\\,(\\nabla \\times \\mathbf{B})_\\phi = -\\frac{1}{r\\sin\\theta} \\Delta^* \\Psi\\,$.\n\n将这些分量代入 $\\,\\frac{\\partial A_\\phi}{\\partial t}\\,$ 的方程中：\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{\\Psi}{r \\sin\\theta}\\right) = -\\frac{1}{r \\sin\\theta}(\\mathbf{u} \\cdot \\nabla \\Psi) - \\eta \\left(-\\frac{1}{r \\sin\\theta} \\Delta^* \\Psi \\right)\n$$\n两边乘以 $\\,r\\sin\\theta\\,$ 得到极向磁通函数 $\\,\\Psi\\,$ 的最终演化方程：\n$$\n\\frac{\\partial \\Psi}{\\partial t} = -(\\mathbf{u} \\cdot \\nabla \\Psi) + \\eta \\Delta^* \\Psi\n$$\n或者，完全展开为：\n$$\n\\frac{\\partial \\Psi}{\\partial t} = -u_r(r) \\frac{\\partial\\Psi}{\\partial r} - \\frac{u_\\theta(\\theta)}{r} \\frac{\\partial\\Psi}{\\partial\\theta} + \\eta \\left( \\frac{\\partial^2 \\Psi}{\\partial r^2} + \\frac{1}{r^2}\\frac{\\partial^2\\Psi}{\\partial\\theta^2} - \\frac{\\cot\\theta}{r^2} \\frac{\\partial\\Psi}{\\partial\\theta} \\right)\n$$\n这是一个关于 $\\,\\Psi\\,$ 的对流-扩散方程，我们将对其进行数值求解。\n\n### 第 2 部分：数值实现\n该方程使用有限差分格式在 $\\,(r, \\theta)\\,$ 的均匀网格上求解。我们使用一阶显式欧拉方法进行时间积分。空间导数按指定方式离散化：\n-   **对流项**（对流部分中的 $\\,\\frac{\\partial\\Psi}{\\partial r}, \\frac{\\partial\\Psi}{\\partial\\theta}\\,$）使用一阶迎风格式。差分方向取决于局部速度分量的符号以确保稳定性。\n-   **扩散项**（$\\,\\frac{\\partial^2\\Psi}{\\partial r^2}, \\frac{\\partial^2\\Psi}{\\partial\\theta^2}\\,$）使用二阶中心差分。\n-   $\\,\\Delta^*\\,$ 算子内的一阶导数 $\\,\\frac{\\partial\\Psi}{\\partial\\theta}\\,$ 也使用二阶中心差分。\n\n显式时间步进格式受对流和扩散的 Courant-Friedrichs-Lewy (CFL) 稳定性约束。时间步长 $\\,\\Delta t\\,$ 必须满足：\n$$\n\\Delta t \\le C \\cdot \\min\\left( \\left(\\frac{|u_r|_{\\max}}{\\Delta r} + \\frac{|u_\\theta/r|_{\\max}}{\\Delta \\theta}\\right)^{-1}, \\frac{1}{2\\eta\\left(\\frac{1}{(\\Delta r)^2} + \\frac{1}{(r_{\\min}\\Delta\\theta)^2}\\right)} \\right)\n$$\n其中 $\\,\\Delta r\\,$ 和 $\\,\\Delta\\theta\\,$ 是网格间距，$\\,C \\le 1\\,$ 是安全因子（在实现中选择 $\\,C=0.5\\,$）。\n\n模拟过程如下：\n1.  设置空间网格并用 $\\,\\Psi(r,\\theta,0) = r^2\\sin^2\\theta\\,$ 初始化 $\\,\\Psi\\,$ 场。\n2.  计算初始条件的最大值 $\\,M(0) = \\max|\\Psi(r,\\theta,0)|\\,$。\n3.  根据具体测试用例的参数确定稳定的时间步长 $\\,\\Delta t\\,$。\n4.  在时间上迭代：在每个步骤中，计算网格上的空间导数，计算演化方程的总右侧项，并更新 $\\,\\Psi\\,$ 场。\n5.  在每个时间步之后，在计算区域的所有四个边界上强制执行狄利克雷边界条件 $\\,\\Psi=0\\,$。\n6.  将系统演化到最终时间 $\\,T\\,$ 后，计算 $\\,M(T) = \\max|\\Psi(r,\\theta,T)|\\,$。\n7.  将 $\\,M(T)\\,$ 与阈值 $\\,\\Psi_{\\mathrm{thr}} = \\gamma M(0)\\,$ 进行比较，以获得最终的布尔结果。\n\n对所提供的四个测试用例中的每一个重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the axisymmetric kinematic dynamo problem for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (alpha, beta, eta, T, gamma)\n        (0.10, 0.10, 1e-2, 1.0, 0.95),\n        (0.10, 0.10, 1e-6, 0.2, 0.99),\n        (0.30, 0.20, 5e-2, 0.5, 0.90),\n        (0.05, 0.05, 1e-3, 4.0, 0.60),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(*case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(alpha, beta, eta, T, gamma):\n    \"\"\"\n    Performs a single simulation run for a given set of parameters.\n    \"\"\"\n    \n    # 1. Grid and Domain Setup\n    r_i, r_o = 0.7, 1.0\n    theta_min, theta_max = 0.05, np.pi - 0.05\n    N_r, N_theta = 64, 128\n\n    r = np.linspace(r_i, r_o, N_r)\n    theta = np.linspace(theta_min, theta_max, N_theta)\n    \n    dr = r[1] - r[0]\n    dtheta = theta[1] - theta[0]\n    \n    r_grid, theta_grid = np.meshgrid(r, theta, indexing='ij')\n\n    # 2. Initial Condition\n    Psi = r_grid**2 * np.sin(theta_grid)**2\n    M0 = np.max(np.abs(Psi))\n    if M0 == 0: M0 = 1.0 # Avoid division by zero, though not expected here.\n\n    # 3. Time Step Calculation (CFL condition)\n    u_r_vals = alpha * r * (1 - r)**2\n    u_theta_vals = beta * np.sin(theta) * np.cos(theta)\n    \n    max_ur = np.max(np.abs(u_r_vals))\n    # For u_theta/r, max is at min r for a given theta\n    max_utheta_over_r = np.max(np.abs(u_theta_vals)) / r_i if r_i > 0 else np.inf\n\n    # Advection time-step constraint\n    dt_adv_inv = max_ur / dr + max_utheta_over_r / dtheta\n    dt_adv = 1.0 / dt_adv_inv if dt_adv_inv > 0 else float('inf')\n\n    # Diffusion time-step constraint\n    dt_diff_inv = 2 * eta * (1/dr**2 + 1/(r_i*dtheta)**2) if eta > 0 else np.inf\n    dt_diff = 1.0 / dt_diff_inv if dt_diff_inv > 0 else float('inf')\n    \n    safety_factor = 0.5\n    dt = safety_factor * min(dt_adv, dt_diff)\n    \n    num_steps = int(np.ceil(T / dt))\n\n    # Pre-calculate velocity and other static grid-dependent fields\n    u_r = (alpha * r_grid * (1 - r_grid)**2)\n    u_theta = (beta * np.sin(theta_grid) * np.cos(theta_grid))\n    cot_theta_over_r2 = ( (np.cos(theta_grid) / np.sin(theta_grid)) / r_grid**2 )\n    one_over_r2 = (1 / r_grid**2)\n    one_over_r = (1 / r_grid)\n\n    # 4. Time Evolution Loop\n    for _ in range(num_steps):\n        Psi_old = Psi.copy()\n        \n        # Slices for interior points\n        Psi_c = Psi_old[1:-1, 1:-1]  # Center\n        Psi_w = Psi_old[1:-1, :-2]   # West (theta-)\n        Psi_e = Psi_old[1:-1, 2:]    # East (theta+)\n        Psi_s = Psi_old[:-2, 1:-1]   # South (r-)\n        Psi_n = Psi_old[2:, 1:-1]    # North (r+)\n\n        # Select interior velocity/grid fields\n        ur_int = u_r[1:-1, 1:-1]\n        uth_int = u_theta[1:-1, 1:-1]\n        cot_th_r2_int = cot_theta_over_r2[1:-1, 1:-1]\n        one_r2_int = one_over_r2[1:-1, 1:-1]\n        one_r_int = one_over_r[1:-1, 1:-1]\n\n        # --- Advection Terms (Upwind) ---\n        # dPsi/dr term\n        adv_r_pos = (Psi_c - Psi_s) / dr\n        adv_r_neg = (Psi_n - Psi_c) / dr\n        adv_r_term = -ur_int * np.where(ur_int > 0, adv_r_pos, adv_r_neg)\n\n        # dPsi/dtheta term\n        adv_th_pos = (Psi_c - Psi_w) / dtheta\n        adv_th_neg = (Psi_e - Psi_c) / dtheta\n        adv_th_term = -uth_int * one_r_int * np.where(uth_int > 0, adv_th_pos, adv_th_neg)\n\n        # --- Diffusion Terms (Centered) ---\n        d2Psi_dr2 = (Psi_n - 2*Psi_c + Psi_s) / dr**2\n        d2Psi_dth2 = (Psi_e - 2*Psi_c + Psi_w) / dtheta**2\n        dPsi_dth_c = (Psi_e - Psi_w) / (2 * dtheta)\n        \n        diff_term = eta * (d2Psi_dr2 + one_r2_int * d2Psi_dth2 - cot_th_r2_int * dPsi_dth_c)\n\n        # Update interior points\n        rhs = adv_r_term + adv_th_term + diff_term\n        Psi[1:-1, 1:-1] = Psi_c + dt * rhs\n        \n        # Enforce Dirichlet BCs \n        Psi[0, :] = 0.0\n        Psi[-1, :] = 0.0\n        Psi[:, 0] = 0.0\n        Psi[:, -1] = 0.0\n\n    # 5. Final Comparison\n    M_T = np.max(np.abs(Psi))\n    Psi_thr = gamma * M0\n    \n    return M_T >= Psi_thr\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}