{
    "hands_on_practices": [
        {
            "introduction": "The Sweet-Parker model serves as the foundational paradigm for understanding resistive magnetic reconnection. Before applying its famous scaling laws, it is essential to understand how they arise from the fundamental principles of magnetohydrodynamics. This practice guides you through the derivation of the key scalings for the inflow speed and the current sheet aspect ratio, starting from conservation laws and Maxwell's equations . By working through this derivation, you will gain a deeper insight into the self-consistent structure of the reconnection layer and critically evaluate how a background \"guide\" magnetic field impacts the dynamics of this process.",
            "id": "4220383",
            "problem": "Consider a two-dimensional, steady, incompressible resistive magnetohydrodynamic (MHD) current sheet of the Sweet–Parker type embedded in an astrophysical plasma of uniform mass density $\\rho$ and scalar resistivity $\\eta$ (both spatially constant). Let the sheet have half-length $L$ (along the $x$-direction) and half-thickness $\\delta$ (along the $y$-direction). The upstream magnetic field has a reversing in-plane component $B_0$ (along $\\hat{\\mathbf{x}}$) and a uniform out-of-plane guide field $B_g$ (along $\\hat{\\mathbf{z}}$), so that $\\mathbf{B}_{\\mathrm{up}} = B_0 \\,\\hat{\\mathbf{x}} + B_g \\,\\hat{\\mathbf{z}}$, with $B_0$ reversing sign across $y=0$ and $B_g$ independent of position. The inflow is along $\\pm \\hat{\\mathbf{y}}$, the outflow along $\\pm \\hat{\\mathbf{x}}$, and the reconnection electric field is along $\\hat{\\mathbf{z}}$. Assume negligible viscosity and that the upstream plasma is approximately at rest.\n\nStarting only from the steady Faraday’s law, the resistive MHD Ohm’s law, Ampère’s law, and the single-fluid momentum equation, and invoking order-of-magnitude consistency appropriate to Sweet–Parker geometry, derive the leading-order scalings for:\n- the inflow Alfvénic Mach number $M \\equiv v_{\\mathrm{in}}/V_{A0}$, where $V_{A0} \\equiv B_0/\\sqrt{\\mu_0 \\rho}$ is the Alfvén speed based on the reconnecting field $B_0$, and\n- the normalized current-sheet half-thickness $\\delta/L$,\n\nexpressed in terms of the Lundquist number $S \\equiv \\mu_0 L V_{A0}/\\eta$ defined using $B_0$. Determine whether a finite uniform guide field $B_g \\neq 0$ modifies these leading-order scalings.\n\nExpress your final answer as the pair $\\big(M,\\;\\delta/L\\big)$ in a single row matrix. Since the requested quantities are dimensionless, no units are required. Provide simplified symbolic expressions; no numerical evaluation or rounding is required.",
            "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in resistive magnetohydrodynamics, asking for a standard derivation of the Sweet–Parker reconnection model scalings. All necessary physical principles, variables, and constraints are provided. The problem is free of contradictions, ambiguities, and factual errors. We may proceed with the solution.\n\nThe derivation of the Sweet–Parker scaling relations rests on applying fundamental conservation laws and electromagnetic equations in an order-of-magnitude sense to the specified current sheet geometry. The system is a two-dimensional, steady-state current sheet of half-length $L$ and half-thickness $\\delta$. The analysis proceeds in four main steps.\n\nFirst, we apply the principle of mass conservation. For a steady, incompressible flow, the mass conservation equation is $\\nabla \\cdot \\mathbf{v} = 0$. Integrating over the volume of the reconnection layer (a rectangular box of dimensions $2L \\times 2\\delta$) and applying the divergence theorem implies that the mass flux entering the box must equal the mass flux exiting it. The plasma enters through the larger surfaces of area $\\sim L$ with an inflow speed $v_{\\mathrm{in}}$, and it exits through the smaller surfaces of area $\\sim \\delta$ with an outflow speed $v_{\\mathrm{out}}$. In an order-of-magnitude sense, this balance is expressed as:\n$$\n\\rho v_{\\mathrm{in}} L \\sim \\rho v_{\\mathrm{out}} \\delta\n$$\nwhere $\\rho$ is the uniform mass density. This simplifies to a key geometric constraint on the flow speeds and layer dimensions:\n$$\nv_{\\mathrm{in}} L \\sim v_{\\mathrm{out}} \\delta \\quad (1)\n$$\n\nSecond, we apply the single-fluid momentum equation to determine the outflow speed. The steady-state momentum equation for a fluid with negligible viscosity is:\n$$\n\\rho (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = -\\nabla P + \\mathbf{J} \\times \\mathbf{B}\n$$\nWe analyze the balance of forces along the outflow direction, which is the $x$-axis. The plasma is accelerated from being nearly at rest at the center of the sheet ($x=0$) to the speed $v_{\\mathrm{out}}$ at the end of the sheet ($x=L$). The inertial term is therefore of order $\\rho (\\mathbf{v} \\cdot \\nabla) v_x \\sim \\rho v_{\\mathrm{out}}^2 / L$. This acceleration is driven primarily by the plasma pressure gradient along the sheet. Upstream of the layer, the total pressure is the sum of the thermal pressure $P_{\\mathrm{up}}$ and the magnetic pressure, $P_{\\mathrm{mag,up}} = (B_0^2 + B_g^2) / (2\\mu_0)$. Inside the reconnection layer, the reconnecting field component $B_0$ has been annihilated, so the magnetic field is approximately just the guide field $B_g$. Assuming pressure balance across the inflow direction ($y$-axis), the plasma pressure inside the sheet, $P_{\\mathrm{sheet}}$, must rise to compensate for the loss of magnetic pressure from $B_0$:\n$$\nP_{\\mathrm{up}} + \\frac{B_0^2 + B_g^2}{2\\mu_0} \\approx P_{\\mathrm{sheet}} + \\frac{B_g^2}{2\\mu_0}\n$$\nThis implies a pressure enhancement within the sheet of $\\Delta P \\equiv P_{\\mathrm{sheet}} - P_{\\mathrm{up}} \\sim B_0^2 / (2\\mu_0)$. This enhanced pressure at the center of the sheet drops to approximately $P_{\\mathrm{up}}$ at the edges ($x \\sim L$), creating a pressure gradient force of order $|\\nabla P| \\sim \\Delta P/L \\sim B_0^2 / (2\\mu_0 L)$. Equating the inertial term with this pressure gradient force in the $x$-momentum equation yields:\n$$\n\\frac{\\rho v_{\\mathrm{out}}^2}{L} \\sim \\frac{B_0^2}{2\\mu_0 L}\n$$\nThis gives the scaling for the outflow speed:\n$$\nv_{\\mathrm{out}}^2 \\sim \\frac{B_0^2}{\\mu_0 \\rho} \\equiv V_{A0}^2 \\implies v_{\\mathrm{out}} \\sim V_{A0} \\quad (2)\n$$\nThe outflow speed is of the order of the Alfvén speed based on the reconnecting magnetic field, $B_0$. Note that the guide field $B_g$ contributes a uniform magnetic pressure component both inside and outside the sheet, and thus it does not contribute to the pressure gradient that drives the outflow. Consequently, $v_{\\mathrm{out}}$ is independent of $B_g$ at this order.\n\nThird, we utilize the laws of electromagnetism. Steady Faraday's law, $\\nabla \\times \\mathbf{E} = 0$, combined with the problem's two-dimensional nature ($\\partial/\\partial z=0$) and the specification that the reconnection electric field $\\mathbf{E}$ is in the $z$-direction, implies that $E_z$ must be spatially uniform. Let us denote this constant field by $E_0$. We next apply the resistive MHD Ohm's law, $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}$. This law takes different dominant balances in the ideal inflow region and the resistive diffusion region.\nIn the ideal inflow region, far from the sheet, the resistive term is negligible ($\\eta \\mathbf{J} \\approx 0$). Thus, $E_0 \\hat{\\mathbf{z}} \\approx -(\\mathbf{v} \\times \\mathbf{B})$. With $\\mathbf{v} \\approx v_{\\mathrm{in}} \\hat{\\mathbf{y}}$ and $\\mathbf{B}_{\\mathrm{up}} = B_0 \\hat{\\mathbf{x}} + B_g \\hat{\\mathbf{z}}$, the $z$-component of the cross product is $-(\\mathbf{v} \\times \\mathbf{B})_z = v_{\\mathrm{in}} B_0$. This gives a measure of the electric field:\n$$\nE_0 \\sim v_{\\mathrm{in}} B_0\n$$\nInside the diffusion region, at the magnetic null ($x=0, y=0$), the plasma flow speed is negligible ($\\mathbf{v} \\approx 0$), so Ohm's law simplifies to $\\mathbf{E} \\approx \\eta \\mathbf{J}$. This yields $E_0 \\sim \\eta J_z$. The current density $J_z$ is found from Ampère's law, $\\mu_0 \\mathbf{J} = \\nabla \\times \\mathbf{B}$. The dominant contribution to $J_z$ comes from the shear of the reconnecting field $B_x$ across the sheet thickness $2\\delta$: $J_z \\sim |\\partial B_x/\\partial y| \\sim B_0/\\delta$. Therefore, inside the sheet:\n$$\nE_0 \\sim \\eta \\frac{B_0}{\\mu_0 \\delta}\n$$\nEquating the two expressions for the constant reconnection electric field $E_0$ gives:\n$$\nv_{\\mathrm{in}} B_0 \\sim \\frac{\\eta B_0}{\\mu_0 \\delta} \\implies v_{\\mathrm{in}} \\sim \\frac{\\eta}{\\mu_0 \\delta} \\quad (3)\n$$\nThe guide field $B_g$ is uniform, so $\\nabla \\times (B_g \\hat{\\mathbf{z}}) = 0$, and it does not contribute to the current density $J_z$. Thus, this relation is also independent of $B_g$.\n\nFourth, we synthesize these results. We have a system of three scaling relations for the variables $v_{\\mathrm{in}}$, $v_{\\mathrm{out}}$, and $\\delta$.\nFrom (1) and (2): $v_{\\mathrm{in}} L \\sim V_{A0} \\delta$. Rearranging this gives a relationship between the current sheet aspect ratio and the inflow Alfvénic Mach number, $M \\equiv v_{\\mathrm{in}}/V_{A0}$:\n$$\n\\frac{\\delta}{L} \\sim \\frac{v_{\\mathrm{in}}}{V_{A0}} = M\n$$\nNow, substitute $\\delta \\sim L M$ into relation (3):\n$$\nv_{\\mathrm{in}} \\sim \\frac{\\eta}{\\mu_0 (L M)}\n$$\nReplacing $v_{\\mathrm{in}}$ with $M V_{A0}$ gives:\n$$\nM V_{A0} \\sim \\frac{\\eta}{\\mu_0 L M} \\implies M^2 \\sim \\frac{\\eta}{\\mu_0 L V_{A0}}\n$$\nWe recognize the inverse of the Lundquist number, $S \\equiv \\mu_0 L V_{A0} / \\eta$, on the right-hand side.\n$$\nM^2 \\sim S^{-1} \\implies M \\sim S^{-1/2}\n$$\nSince $\\delta/L \\sim M$, the scaling for the sheet aspect ratio is identical:\n$$\n\\frac{\\delta}{L} \\sim S^{-1/2}\n$$\nThese are the canonical Sweet–Parker scaling laws. Our analysis at each step has shown that the uniform guide field $B_g$ does not affect the pressure gradient driving the outflow, the current density associated with the reconnecting field, or the ideal MHD electric field. Therefore, a finite uniform guide field $B_g \\neq 0$ does not modify these leading-order scalings. The final answer is the pair of scalings for $M$ and $\\delta/L$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} S^{-1/2} & S^{-1/2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A major challenge in reconnection theory is explaining the rapid energy release observed in phenomena like solar flares, as the classic Sweet-Parker model predicts very slow reconnection rates in typical astrophysical plasmas. The plasmoid instability provides a critical breakthrough, demonstrating that long, thin Sweet-Parker-type current sheets become unstable above a critical Lundquist number $S_c$. This exercise allows you to apply this modern concept by calculating whether a given current sheet is susceptible to this instability, which fragments the sheet into a \"chain\" of magnetic islands, or plasmoids, and ultimately leads to much faster reconnection . This practice bridges the gap between the classic slow reconnection model and the onset of fast, turbulent reconnection regimes.",
            "id": "4220345",
            "problem": "A resistive magnetohydrodynamic current sheet of characteristic half-length $L$ forms in a coronal-like astrophysical plasma with magnetic field magnitude $B$, mass density $\\rho$, and uniform magnetic diffusivity $\\eta$. The resistive magnetohydrodynamic (MHD) induction equation is of the form $\\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) + \\eta \\nabla^{2} \\mathbf{B}$, with the vacuum permeability denoted by $\\mu_{0}$. The Alfvén speed is defined by $V_{A} = B/\\sqrt{\\mu_{0}\\rho}$. The dimensionless Lundquist number $S$ characterizes the ratio of magnetic advection to diffusion over the scale $L$. A Sweet–Parker current sheet becomes linearly unstable to the plasmoid instability once $S$ exceeds a critical value $S_{c}$, and the onset thickness $\\delta_{\\mathrm{onset}}$ is the Sweet–Parker thickness evaluated at $S = S_{c}$.\n\nUsing only these standard definitions and physical laws, determine whether the Sweet–Parker sheet is linearly unstable to plasmoid formation for the parameters\n$\\eta = 3\\,\\mathrm{m^{2}\\,s^{-1}}$, $L = 5.0 \\times 10^{7}\\,\\mathrm{m}$, $B = 3.0 \\times 10^{-2}\\,\\mathrm{T}$, $\\rho = 3.0 \\times 10^{-12}\\,\\mathrm{kg\\,m^{-3}}$, and $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$,\nassuming a critical Lundquist number $S_{c} = 1.0 \\times 10^{4}$ appropriate to order-unity magnetic Prandtl number. Adopt the convention that instability is indicated by $I=1$ if $S > S_{c}$ and $I=0$ otherwise. Then, compute the expected onset thickness $\\delta_{\\mathrm{onset}}$.\n\nRound $\\delta_{\\mathrm{onset}}$ to three significant figures. Express $\\delta_{\\mathrm{onset}}$ in meters. Provide your final answer as a row matrix $\\begin{pmatrix} I & \\delta_{\\mathrm{onset}} \\end{pmatrix}$.",
            "solution": "The problem statement will first be validated for correctness, consistency, and feasibility.\n\n### Step 1: Extract Givens\n- **Physical Quantities and Parameters:**\n    - Characteristic half-length of current sheet: $L$\n    - Magnetic field magnitude: $B$\n    - Mass density: $\\rho$\n    - Uniform magnetic diffusivity: $\\eta$\n    - Vacuum permeability: $\\mu_{0}$\n- **Equations and Definitions:**\n    - Resistive MHD induction equation: $\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) + \\eta \\nabla^{2} \\mathbf{B}$\n    - Alfvén speed: $V_{A} = \\frac{B}{\\sqrt{\\mu_{0}\\rho}}$\n    - Lundquist number: $S$ is the dimensionless ratio of magnetic advection to diffusion over scale $L$.\n    - Critical Lundquist number: $S_{c}$\n    - Onset thickness: $\\delta_{\\mathrm{onset}}$ is the Sweet–Parker thickness evaluated at $S = S_{c}$.\n- **Numerical Values:**\n    - $\\eta = 3\\,\\mathrm{m^{2}\\,s^{-1}}$\n    - $L = 5.0 \\times 10^{7}\\,\\mathrm{m}$\n    - $B = 3.0 \\times 10^{-2}\\,\\mathrm{T}$\n    - $\\rho = 3.0 \\times 10^{-12}\\,\\mathrm{kg\\,m^{-3}}$\n    - $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$\n    - $S_{c} = 1.0 \\times 10^{4}$\n- **Conditions and Tasks:**\n    - Instability indicator: $I=1$ if $S > S_{c}$ and $I=0$ otherwise.\n    - Determine the value of $I$.\n    - Compute the value of $\\delta_{\\mathrm{onset}}$.\n    - Round $\\delta_{\\mathrm{onset}}$ to three significant figures.\n    - Express the final answer as a row matrix $\\begin{pmatrix} I & \\delta_{\\mathrm{onset}} \\end{pmatrix}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness:** The problem is scientifically sound. It is based on the resistive magnetohydrodynamic (MHD) framework, specifically the Sweet–Parker model of magnetic reconnection and the subsequent plasmoid instability. These are standard, well-established concepts in astrophysical plasma physics. The governing equation and all definitions are correct. The given numerical values are physically plausible for a coronal plasma environment.\n2.  **Incomplete or Contradictory Setup:** The problem provides a qualitative description of the Lundquist number $S$ and refers to the \"Sweet–Parker thickness\" without providing explicit formulae. However, it explicitly states to use \"standard definitions and physical laws\". In the context of resistive MHD and Sweet-Parker theory, the Lundquist number is standardly defined as $S = L V_{A} / \\eta$, and the Sweet-Parker current sheet thickness is $\\delta_{\\mathrm{SP}} = L S^{-1/2}$. The problem's reliance on this expected background knowledge is appropriate for the specified context of a STEM professor and does not render it incomplete.\n3.  **Well-Posed and Objective:** The problem is well-posed, with a clear objective and a sufficient set of parameters to yield a unique solution for the requested quantities ($I$ and $\\delta_{\\mathrm{onset}}$). The language is objective and precise.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be developed.\n\nThe solution requires two primary calculations: first, the determination of the instability indicator $I$, which necessitates computing the system's Lundquist number $S$; second, the calculation of the onset thickness $\\delta_{\\mathrm{onset}}$.\n\n**1. Determination of the Instability Indicator $I$**\n\nThe instability indicator $I$ is $1$ if $S > S_{c}$ and $0$ otherwise. To find $I$, we must calculate the Lundquist number $S$ for the given parameters. The standard definition for the global Lundquist number based on the characteristic length $L$ and the Alfvén speed $V_{A}$ is:\n$$S = \\frac{L V_{A}}{\\eta}$$\nFirst, we calculate the Alfvén speed $V_{A}$ using its definition and the provided values:\n$$V_{A} = \\frac{B}{\\sqrt{\\mu_{0}\\rho}}$$\nSubstituting the given numerical values:\n$$V_{A} = \\frac{3.0 \\times 10^{-2}\\,\\mathrm{T}}{\\sqrt{(4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}) \\times (3.0 \\times 10^{-12}\\,\\mathrm{kg\\,m^{-3}})}}$$\n$$V_{A} = \\frac{3.0 \\times 10^{-2}}{\\sqrt{12\\pi \\times 10^{-19}}} = \\frac{3.0 \\times 10^{-2}}{\\sqrt{3.7699... \\times 10^{-18}}} \\, \\mathrm{m\\,s^{-1}}$$\n$$V_{A} \\approx \\frac{3.0 \\times 10^{-2}}{1.9416... \\times 10^{-9}} \\, \\mathrm{m\\,s^{-1}} \\approx 1.545... \\times 10^{7} \\, \\mathrm{m\\,s^{-1}}$$\nTo be precise, let's calculate $V_A^2$:\n$$V_A^2 = \\frac{B^2}{\\mu_0 \\rho} = \\frac{(3.0 \\times 10^{-2})^2}{(4\\pi \\times 10^{-7})(3.0 \\times 10^{-12})} = \\frac{9.0 \\times 10^{-4}}{12\\pi \\times 10^{-19}} = \\frac{3}{4\\pi} \\times 10^{15} \\, \\mathrm{m^2\\,s^{-2}}$$\n$$V_A^2 \\approx 0.2387 \\times 10^{15} = 2.387... \\times 10^{14} \\, \\mathrm{m^2\\,s^{-2}}$$\n$$V_A = \\sqrt{2.387... \\times 10^{14}} \\approx 1.545... \\times 10^7 \\, \\mathrm{m\\,s^{-1}}$$\nNow, we can calculate the Lundquist number $S$:\n$$S = \\frac{L V_{A}}{\\eta} = \\frac{(5.0 \\times 10^{7}\\,\\mathrm{m}) \\times (1.545... \\times 10^{7}\\,\\mathrm{m\\,s^{-1}})}{3\\,\\mathrm{m^{2}\\,s^{-1}}}$$\n$$S \\approx \\frac{7.725... \\times 10^{14}}{3} \\approx 2.575... \\times 10^{14}$$\nWe compare this value to the critical Lundquist number, $S_{c} = 1.0 \\times 10^{4}$.\nSince $S \\approx 2.58 \\times 10^{14}$ is vastly greater than $S_{c} = 1.0 \\times 10^{4}$, the condition $S > S_{c}$ is met.\nTherefore, the current sheet is unstable to the plasmoid instability, and the indicator is:\n$$I = 1$$\n\n**2. Calculation of the Onset Thickness $\\delta_{\\mathrm{onset}}$**\n\nThe problem defines $\\delta_{\\mathrm{onset}}$ as the Sweet–Parker thickness evaluated at the critical Lundquist number $S = S_{c}$. The standard formula for the Sweet-Parker thickness, $\\delta_{\\mathrm{SP}}$, as a function of the Lundquist number $S$ and the sheet half-length $L$ is:\n$$\\delta_{\\mathrm{SP}} = \\frac{L}{\\sqrt{S}} = L S^{-1/2}$$\nTo find the onset thickness, we substitute $S_{c}$ for $S$ in this formula:\n$$\\delta_{\\mathrm{onset}} = \\frac{L}{\\sqrt{S_{c}}}$$\nUsing the given values for $L$ and $S_{c}$:\n$$L = 5.0 \\times 10^{7}\\,\\mathrm{m}$$\n$$S_{c} = 1.0 \\times 10^{4}$$\nWe calculate $\\delta_{\\mathrm{onset}}$:\n$$\\delta_{\\mathrm{onset}} = \\frac{5.0 \\times 10^{7}\\,\\mathrm{m}}{\\sqrt{1.0 \\times 10^{4}}} = \\frac{5.0 \\times 10^{7}\\,\\mathrm{m}}{1.0 \\times 10^{2}}$$\n$$\\delta_{\\mathrm{onset}} = 5.0 \\times 10^{5}\\,\\mathrm{m}$$\nThe problem requires this value to be rounded to three significant figures.\n$$\\delta_{\\mathrm{onset}} = 5.00 \\times 10^{5}\\,\\mathrm{m}$$\n\nThe final answer is the row matrix $\\begin{pmatrix} I & \\delta_{\\mathrm{onset}} \\end{pmatrix}$.\nSubstituting the computed values:\n$$\\begin{pmatrix} 1 & 5.00 \\times 10^{5} \\end{pmatrix}$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 & 5.00 \\times 10^{5} \\end{pmatrix}}$$"
        },
        {
            "introduction": "While fluid models like MHD are excellent for describing the large-scale evolution of magnetic fields, they do not capture the kinetic-scale physics responsible for accelerating individual particles to high energies—a key observational signature of magnetic reconnection. This computational exercise delves into this microscopic realm using a test-particle approach. By numerically integrating particle trajectories in a prescribed reconnection field model, you will directly explore the mechanisms of particle energization, distinguishing between direct acceleration by the reconnection electric field and Fermi-type acceleration in the plasma flows . This hands-on simulation provides a tangible link between the abstract field configuration and the concrete process of particle heating and acceleration.",
            "id": "4220376",
            "problem": "Consider a non-relativistic, collisionless test-particle moving in a simplified two-dimensional magnetic reconnection configuration representative of astrophysical plasmas. The particle dynamics are governed by the Lorentz force starting from first principles. The model fields are steady in time and vary in space according to a canonical current-sheet form with a uniform guide field and a uniform reconnection electric field. The inflow of the ambient plasma generates a motional electric field through the usual cross-field relation. Your task is to implement a program that integrates the particle trajectory and computes the kinetic energy gain and the dominant acceleration mechanism for each of several parameter sets.\n\nFundamental base:\n- Start from the Lorentz force law, $m \\, d\\mathbf{v}/dt = q \\left( \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\right)$, and $d\\mathbf{r}/dt = \\mathbf{v}$, where $m$ is mass, $q$ is charge, $\\mathbf{v}$ is velocity, $\\mathbf{r}$ is position, $\\mathbf{E}$ is electric field, and $\\mathbf{B}$ is magnetic field.\n- The instantaneous rate of change of kinetic energy is $dW/dt = q \\, \\mathbf{E} \\cdot \\mathbf{v}$, with $W$ the kinetic energy.\n- The simplified reconnection magnetic field is $\\mathbf{B}(\\mathbf{r}) = B_0 \\tanh(y/L) \\, \\hat{\\mathbf{x}} + B_g \\, \\hat{\\mathbf{z}}$, where $B_0$ is the reconnecting field amplitude, $L$ is the current-sheet half-thickness, $y$ is the coordinate across the sheet, and $B_g$ is the uniform guide field.\n- The reconnection electric field is uniform and along $\\hat{\\mathbf{z}}$: $\\mathbf{E}_{\\mathrm{rec}} = E_0 \\, \\hat{\\mathbf{z}}$, with $E_0$ constant.\n- The background plasma inflow is $\\mathbf{V}_{\\mathrm{in}} = - V_{\\mathrm{in}} \\, \\hat{\\mathbf{y}}$. The motional electric field is defined by $\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = - \\mathbf{V}_{\\mathrm{in}} \\times \\mathbf{B}(\\mathbf{r})$. The total electric field is $\\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}) = \\mathbf{E}_{\\mathrm{rec}} + \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r})$.\n\nDefinitions and assumptions:\n- The particle is non-relativistic: $|\\mathbf{v}| \\ll c$, with $c$ the speed of light.\n- The fields are steady in time and vary only in space as given above.\n- The particle equations are integrated using an energy-conserving Boris algorithm suitable for Charged Particle Motion (CPM).\n- Magnetohydrodynamics (MHD) is not solved; this is a test-particle calculation in prescribed fields.\n\nMechanism identification:\n- Decompose the work done on the particle into two scalar contributions integrated over time: $\\Delta W_{\\mathrm{rec}} = \\int q \\, \\mathbf{E}_{\\mathrm{rec}} \\cdot \\mathbf{v} \\, dt$ and $\\Delta W_{\\mathrm{m}} = \\int q \\, \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}(t)) \\cdot \\mathbf{v} \\, dt$. The total kinetic energy change is $\\Delta W = W_{\\mathrm{final}} - W_{\\mathrm{initial}}$.\n- Define the dominant acceleration mechanism by comparing absolute contributions: if $|\\Delta W_{\\mathrm{rec}}| \\ge |\\Delta W_{\\mathrm{m}}|$, label as $0$ (direct reconnection electric field acceleration); otherwise label as $1$ (first-order Fermi-like acceleration via motional electric field).\n\nNumerical integration requirement:\n- Use the Boris pusher with time step $dt$ and total integration time $T$ for each case.\n- At each step, evaluate $\\mathbf{B}(\\mathbf{r})$, $\\mathbf{E}_{\\mathrm{rec}}$, and $\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r})$ at the current position.\n\nUnits and outputs:\n- All quantities are in International System of Units (SI) unless stated otherwise. Energies must be expressed in Joules ($\\mathrm{J}$).\n- Your program must output for each test case a list containing the kinetic energy gain and the mechanism label: $[\\Delta W, \\mathrm{label}]$, where $\\Delta W$ is a float in $\\mathrm{J}$ and $\\mathrm{label}$ is an integer.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\![\\Delta W_1,\\mathrm{label}_1],[\\Delta W_2,\\mathrm{label}_2],\\dots]\\!$). The brackets and commas must appear exactly once as described, with no additional text. Energies must be printed in $\\mathrm{J}$, as floats.\n\nTest suite:\nFor each case, provide $(q,m,B_0,B_g,L,E_0,V_{\\mathrm{in}},\\mathbf{r}_0,\\mathbf{v}_0,dt,T)$.\n\n- Case $1$ (electron, direct reconnection electric field dominant expected): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 9.109 \\times 10^{-31} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 0.0 \\, \\mathrm{T}$, $L = 1.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 1.0 \\times 10^{-3} \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 0.0 \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 100.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-9} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-6} \\, \\mathrm{s}$.\n- Case $2$ (electron, motional field dominant expected): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 9.109 \\times 10^{-31} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 5.0 \\times 10^{-5} \\, \\mathrm{T}$, $L = 1.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 0.0 \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 2.0 \\times 10^{3} \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 100.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-9} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-6} \\, \\mathrm{s}$.\n- Case $3$ (proton, mixed fields): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 1.673 \\times 10^{-27} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $L = 2.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 5.0 \\times 10^{-4} \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 3.0 \\times 10^{3} \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 200.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 50.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-7} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-5} \\, \\mathrm{s}$.\n- Case $4$ (electron, boundary condition far from neutral line): $q = 1.602 \\times 10^{-19} \\, \\mathrm{C}$, $m = 9.109 \\times 10^{-31} \\, \\mathrm{kg}$, $B_0 = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $B_g = 2.0 \\times 10^{-4} \\, \\mathrm{T}$, $L = 1.0 \\times 10^{3} \\, \\mathrm{m}$, $E_0 = 1.0 \\times 10^{-3} \\, \\mathrm{V/m}$, $V_{\\mathrm{in}} = 5.0 \\times 10^{2} \\, \\mathrm{m/s}$, $\\mathbf{r}_0 = (0.0 \\, \\mathrm{m}, 1000.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$, $\\mathbf{v}_0 = (10.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s}, 0.0 \\, \\mathrm{m/s})$, $dt = 1.0 \\times 10^{-9} \\, \\mathrm{s}$, $T = 5.0 \\times 10^{-6} \\, \\mathrm{s}$.\n\nAlgorithmic objectives:\n- Implement the Boris pusher consistent with the above fields.\n- For each case, compute $\\Delta W$ in $\\mathrm{J}$ and the mechanism label as defined.\n- Aggregate the outputs in a single line as specified.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of classical electrodynamics, mathematically well-posed as an initial value problem for a system of ordinary differential equations, and all provided information is self-contained, objective, and consistent.\n\nThe task is to simulate the trajectory of a non-relativistic test particle in a prescribed electromagnetic field configuration modeling magnetic reconnection and to analyze the particle's energy gain. The solution involves numerically integrating the equations of motion and calculating the work done by different components of the electric field.\n\nThe fundamental equation governing the particle's motion is the Lorentz force law:\n$$\nm \\frac{d\\mathbf{v}}{dt} = q \\left( \\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}) + \\mathbf{v} \\times \\mathbf{B}(\\mathbf{r}) \\right)\n$$\nwhere $m$ is the particle mass, $q$ is its charge, $\\mathbf{v}$ is its velocity, and $\\mathbf{r}$ is its position. The position is updated according to:\n$$\n\\frac{d\\mathbf{r}}{dt} = \\mathbf{v}\n$$\n\nThe electromagnetic fields are defined as follows. The magnetic field, $\\mathbf{B}$, consists of a reversing component in the $\\hat{\\mathbf{x}}$ direction and a uniform guide field in the $\\hat{\\mathbf{z}}$ direction:\n$$\n\\mathbf{B}(\\mathbf{r}) = B_0 \\tanh(y/L) \\, \\hat{\\mathbf{x}} + B_g \\, \\hat{\\mathbf{z}}\n$$\nHere, $B_0$ is the reconnecting field strength, $L$ is the half-thickness of the current sheet, $y$ is the coordinate across the sheet, and $B_g$ is the guide field strength.\n\nThe total electric field, $\\mathbf{E}_{\\mathrm{tot}}$, is the sum of a uniform reconnection electric field, $\\mathbf{E}_{\\mathrm{rec}}$, and a motional electric field, $\\mathbf{E}_{\\mathrm{m}}$, generated by plasma inflow.\nThe reconnection electric field is given by:\n$$\n\\mathbf{E}_{\\mathrm{rec}} = E_0 \\, \\hat{\\mathbf{z}}\n$$\nwhere $E_0$ is a constant. The motional field is induced by plasma flowing with velocity $\\mathbf{V}_{\\mathrm{in}} = -V_{\\mathrm{in}} \\hat{\\mathbf{y}}$ across the magnetic field:\n$$\n\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = - \\mathbf{V}_{\\mathrm{in}} \\times \\mathbf{B}(\\mathbf{r}) = -(-V_{\\mathrm{in}} \\hat{\\mathbf{y}}) \\times \\left(B_0 \\tanh(y/L) \\hat{\\mathbf{x}} + B_g \\hat{\\mathbf{z}}\\right)\n$$\nEvaluating the cross product yields:\n$$\n\\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = V_{\\mathrm{in}} B_g \\hat{\\mathbf{x}} - V_{\\mathrm{in}} B_0 \\tanh(y/L) \\hat{\\mathbf{z}}\n$$\nThe total electric field is therefore:\n$$\n\\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}) = \\mathbf{E}_{\\mathrm{rec}} + \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}) = (V_{\\mathrm{in}} B_g) \\hat{\\mathbf{x}} + \\left(E_0 - V_{\\mathrm{in}} B_0 \\tanh(y/L)\\right) \\hat{\\mathbf{z}}\n$$\n\nThe kinetic energy of the particle is $W = \\frac{1}{2} m |\\mathbf{v}|^2$. The rate of change of kinetic energy is given by the power delivered by the electric field:\n$$\n\\frac{dW}{dt} = q \\mathbf{E}_{\\mathrm{tot}} \\cdot \\mathbf{v}\n$$\nThe total change in kinetic energy, $\\Delta W$, over the integration time $T$ is the integral of this power. We decompose this change into contributions from the reconnection field, $\\Delta W_{\\mathrm{rec}}$, and the motional field, $\\Delta W_{\\mathrm{m}}$:\n$$\n\\Delta W_{\\mathrm{rec}} = \\int_0^T q \\, \\mathbf{E}_{\\mathrm{rec}} \\cdot \\mathbf{v}(t) \\, dt\n$$\n$$\n\\Delta W_{\\mathrm{m}} = \\int_0^T q \\, \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}(t)) \\cdot \\mathbf{v}(t) \\, dt\n$$\nThe dominant acceleration mechanism is determined by comparing the absolute magnitudes $|\\Delta W_{\\mathrm{rec}}|$ and $|\\Delta W_{\\mathrm{m}}|$. If $|\\Delta W_{\\mathrm{rec}}| \\ge |\\Delta W_{\\mathrm{m}}|$, the mechanism is labeled $0$; otherwise, it is labeled $1$.\n\nThe equations of motion are integrated numerically using the Boris algorithm, a second-order accurate and symplectic integrator well-suited for charged particle dynamics. The algorithm staggers velocity and position in time, with position $\\mathbf{r}^n$ evaluated at integer time steps $t_n = n \\, dt$ and velocity $\\mathbf{v}^{n-1/2}$ at half steps $t_{n-1/2} = (n-1/2) \\, dt$.\n\nThe integration procedure for a single time step from $t_n$ to $t_{n+1}$ is:\n1.  **Initial velocity adjustment**: Given initial conditions $\\mathbf{r}^0$ and $\\mathbf{v}^0$ at $t=0$, the velocity is first \"kicked back\" by half a time step to obtain $\\mathbf{v}^{-1/2}$, which is required to start the leapfrog integration:\n    $$\n    \\mathbf{v}^{-1/2} = \\mathbf{v}^0 - \\frac{1}{2} dt \\frac{q}{m} \\left( \\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}^0) + \\mathbf{v}^0 \\times \\mathbf{B}(\\mathbf{r}^0) \\right)\n    $$\n2.  **Main loop**: For each step $n=0, 1, \\dots, N-1$ where $N = T/dt$:\n    a. The electric and magnetic fields, $\\mathbf{E}_{\\mathrm{tot}}^n$ and $\\mathbf{B}^n$, are evaluated at the current position $\\mathbf{r}^n$.\n    b. A velocity $\\mathbf{v}^-$ is calculated by applying the first half of the electric acceleration to $\\mathbf{v}^{n-1/2}$:\n       $$\n       \\mathbf{v}^- = \\mathbf{v}^{n-1/2} + \\frac{q \\mathbf{E}_{\\mathrm{tot}}^n}{m} \\frac{dt}{2}\n       $$\n    c. The magnetic field rotation is applied to $\\mathbf{v}^-$. This involves defining intermediate vectors $\\mathbf{t} = \\frac{q \\mathbf{B}^n}{m} \\frac{dt}{2}$ and $\\mathbf{s} = \\frac{2\\mathbf{t}}{1 + |\\mathbf{t}|^2}$:\n       $$\n       \\mathbf{v}' = \\mathbf{v}^- + \\mathbf{v}^- \\times \\mathbf{t}\n       $$\n       $$\n       \\mathbf{v}^+ = \\mathbf{v}^- + \\mathbf{v}' \\times \\mathbf{s}\n       $$\n    d. The second half of the electric acceleration is applied to obtain the velocity at the next half step, $\\mathbf{v}^{n+1/2}$:\n       $$\n       \\mathbf{v}^{n+1/2} = \\mathbf{v}^+ + \\frac{q \\mathbf{E}_{\\mathrm{tot}}^n}{m} \\frac{dt}{2}\n       $$\n    e. The new position $\\mathbf{r}^{n+1}$ is calculated:\n       $$\n       \\mathbf{r}^{n+1} = \\mathbf{r}^n + \\mathbf{v}^{n+1/2} dt\n       $$\n    f. The work done during the interval $[t_n, t_{n+1}]$ by each electric field component is approximated and accumulated. The velocity $\\mathbf{v}^{n+1/2}$ is the average velocity over the interval, suitable for a midpoint rule quadrature:\n       $$\n       \\delta W_{\\mathrm{rec}}^n = q \\left( \\mathbf{E}_{\\mathrm{rec}} \\cdot \\mathbf{v}^{n+1/2} \\right) dt\n       $$\n       $$\n       \\delta W_{\\mathrm{m}}^n = q \\left( \\mathbf{E}_{\\mathrm{m}}(\\mathbf{r}^n) \\cdot \\mathbf{v}^{n+1/2} \\right) dt\n       $$\n       $\\Delta W_{\\mathrm{rec}}$ and $\\Delta W_{\\mathrm{m}}$ are updated by adding these increments.\n\n3.  **Finalization**: After $N$ steps, the final velocity at time $T$, $\\mathbf{v}^N$, is computed by a final half-step acceleration from $\\mathbf{v}^{N-1/2}$:\n    $$\n    \\mathbf{v}^N = \\mathbf{v}^{N-1/2} + \\frac{q \\mathbf{E}_{\\mathrm{tot}}(\\mathbf{r}^N)}{m} \\frac{dt}{2}\n    $$\n    The total kinetic energy gain is $\\Delta W = W_{\\mathrm{final}} - W_{\\mathrm{initial}} = \\frac{1}{2}m|\\mathbf{v}^N|^2 - \\frac{1}{2}m|\\mathbf{v}^0|^2$. This value of $\\Delta W$ serves as a check for the numerical integration, as it should equal $\\Delta W_{\\mathrm{rec}} + \\Delta W_{\\mathrm{m}}$.\n\nThis procedure is implemented for each test case to compute the required values $[\\Delta W, \\mathrm{label}]$.```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the test-particle motion problem for several magnetic reconnection scenarios.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: electron, direct reconnection electric field dominant expected\n        {\n            'q': 1.602e-19, 'm': 9.109e-31, 'B0': 1.0e-4, 'Bg': 0.0, 'L': 1.0e3,\n            'E0': 1.0e-3, 'Vin': 0.0, 'r0': (0.0, 0.0, 0.0), 'v0': (0.0, 0.0, 100.0),\n            'dt': 1.0e-9, 'T': 5.0e-6\n        },\n        # Case 2: electron, motional field dominant expected\n        {\n            'q': 1.602e-19, 'm': 9.109e-31, 'B0': 1.0e-4, 'Bg': 5.0e-5, 'L': 1.0e3,\n            'E0': 0.0, 'Vin': 2.0e3, 'r0': (0.0, 100.0, 0.0), 'v0': (0.0, 0.0, 0.0),\n            'dt': 1.0e-9, 'T': 5.0e-6\n        },\n        # Case 3: proton, mixed fields\n        {\n            'q': 1.602e-19, 'm': 1.673e-27, 'B0': 1.0e-4, 'Bg': 1.0e-4, 'L': 2.0e3,\n            'E0': 5.0e-4, 'Vin': 3.0e3, 'r0': (0.0, 200.0, 0.0), 'v0': (0.0, 0.0, 50.0),\n            'dt': 1.0e-7, 'T': 5.0e-5\n        },\n        # Case 4: electron, boundary condition far from neutral line\n        {\n            'q': 1.602e-19, 'm': 9.109e-31, 'B0': 1.0e-4, 'Bg': 2.0e-4, 'L': 1.0e3,\n            'E0': 1.0e-3, 'Vin': 5.0e2, 'r0': (0.0, 1000.0, 0.0), 'v0': (10.0, 0.0, 0.0),\n            'dt': 1.0e-9, 'T': 5.0e-6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format output as a list of lists with no spaces\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef run_simulation(q, m, B0, Bg, L, E0, Vin, r0, v0, dt, T):\n    \"\"\"\n    Integrates particle trajectory using Boris pusher and calculates energy gain.\n    \"\"\"\n    r = np.array(r0, dtype=float)\n    v = np.array(v0, dtype=float)\n    \n    num_steps = int(round(T / dt))\n\n    w_initial = 0.5 * m * np.dot(v, v)\n    dw_rec_total = 0.0\n    dw_m_total = 0.0\n\n    # Field calculation function\n    def get_fields(pos):\n        y = pos[1]\n        tanh_yL = np.tanh(y / L)\n        \n        B = np.array([B0 * tanh_yL, 0.0, Bg])\n        \n        E_rec = np.array([0.0, 0.0, E0])\n        \n        E_m = np.array([Vin * Bg, 0.0, -Vin * B0 * tanh_yL])\n        \n        E_tot = E_rec + E_m\n        \n        return B, E_rec, E_m, E_tot\n\n    # Initial half-step kick-back for velocity to start the leapfrog\n    B_init, _, _, E_init = get_fields(r)\n    a_init = (q / m) * (E_init + np.cross(v, B_init))\n    v = v - 0.5 * dt * a_init\n\n    # Main integration loop\n    for _ in range(num_steps):\n        B, E_rec, E_m, E_tot = get_fields(r)\n\n        # Boris algorithm\n        # 1. Electric field half-acceleration\n        v_minus = v + (q * E_tot / m) * (dt / 2.0)\n\n        # 2. Magnetic field rotation\n        t = (q * B / m) * (dt / 2.0)\n        t_mag_sq = np.dot(t, t)\n        s = 2.0 * t / (1.0 + t_mag_sq) if (1.0 + t_mag_sq) != 1.0 else 2.0 * t\n        \n        v_prime = v_minus + np.cross(v_minus, t)\n        v_plus = v_minus + np.cross(v_prime, s)\n\n        # 3. Second electric field half-acceleration\n        v_plus_half = v_plus + (q * E_tot / m) * (dt / 2.0)\n\n        # Accumulate work done by E-field components\n        dw_rec = q * np.dot(E_rec, v_plus_half) * dt\n        dw_m = q * np.dot(E_m, v_plus_half) * dt\n        dw_rec_total += dw_rec\n        dw_m_total += dw_m\n\n        # Update velocity and position for next step\n        v = v_plus_half\n        r = r + v * dt\n\n    # Final half-step to get velocity at the final integer time step\n    _, _, _, E_final = get_fields(r)\n    v_final = v + (q * E_final / m) * (dt / 2.0)\n\n    w_final = 0.5 * m * np.dot(v_final, v_final)\n    delta_w = w_final - w_initial\n\n    # Determine dominant mechanism\n    if abs(dw_rec_total) >= abs(dw_m_total):\n        label = 0\n    else:\n        label = 1\n\n    return [delta_w, label]\n\nif __name__ == \"__main__\":\n    solve()\n\n```",
            "answer": "```text\n[[8.01890334810011e-22,0],[1.282499596884695e-21,1],[2.007622616892557e-20,0],[2.096732386803259e-21,1]]\n```"
        }
    ]
}