{
    "hands_on_practices": [
        {
            "introduction": "动力学理论的基础是粒子分布函数，它包含了等离子体的所有统计信息。一项关键技能是从这种微观描述中提取宏观流体量，例如压力和温度。本练习通过要求您从麦克斯韦分布计算标量压力，并思考您所使用的无碰撞模型背后的物理假设，来实践这一基本过程。",
            "id": "4233992",
            "problem": "在天体物理等离子体物理学中，无碰撞动力学描述采用弗拉索夫方程，该方程在忽略二体碰撞的情况下，描述了单粒子分布函数在自洽电磁场作用下的演化。考虑太阳风中一个稳定、空间均匀的质子布居，其由各向同性的麦克斯韦分布建模\n$$\nf(\\boldsymbol{v}) \\;=\\; n_{0}\\,(\\pi\\,v_{th}^{2})^{-3/2}\\,\\exp\\!\\left(-\\frac{v^{2}}{v_{th}^{2}}\\right),\n$$\n其中 $n_{0}$ 是数密度，$m$ 是质子质量，$v_{th}$ 是热速度参数。从动力学理论中标量压强作为分布函数的各向同性速度二阶矩的定义出发，推导该麦克斯韦分布的标量压强 $p$（用 $m$，$n_{0}$ 和 $v_{th}$ 表示），并将结果表示为单个闭式解析表达式。然后，基于无碰撞弗拉索夫描述，确定在一个天文单位（AU）附近，该无碰撞处理方法对膨胀的太阳风仍然有效的、关于碰撞性和特征尺度的最小物理假设集。无需进行数值计算，最终表达式中也无需报告单位；以符号形式给出压强。",
            "solution": "该问题需要完成两个不同的任务：第一，为一个由各向同性麦克斯韦分布函数描述的质子布居推导标量压强 $p$；第二，确定在膨胀的太阳风中，使用无碰撞弗拉索夫方程有效的物理假设。\n\n首先，我们来推导标量压强 $p$。\n对于质量为 $m$ 的粒子种类，其压强张量 $\\mathbf{P}$ 的一般定义由其分布函数 $f(\\boldsymbol{v})$ 的二阶中心矩给出：\n$$\n\\mathbf{P} = m \\int (\\boldsymbol{v} - \\boldsymbol{u})(\\boldsymbol{v} - \\boldsymbol{u}) f(\\boldsymbol{v}) \\, d^3v\n$$\n其中 $\\boldsymbol{u}$ 是布居的平均（体）速度，定义为 $\\boldsymbol{u} = \\frac{1}{n} \\int \\boldsymbol{v} f(\\boldsymbol{v}) \\, d^3v$，其中 $n = \\int f(\\boldsymbol{v}) \\, d^3v$ 是数密度。\n\n给定的分布函数为\n$$\nf(\\boldsymbol{v}) = n_{0}\\,(\\pi\\,v_{th}^{2})^{-3/2}\\,\\exp\\!\\left(-\\frac{v^{2}}{v_{th}^{2}}\\right)\n$$\n其中 $v = |\\boldsymbol{v}|$。该函数是各向同性的，意味着它只依赖于速度的大小，而不依赖于其方向。它也是速度矢量分量的偶函数，即 $f(-\\boldsymbol{v}) = f(\\boldsymbol{v})$。平均速度 $\\boldsymbol{u}$ 是通过在整个速度空间上对 $\\boldsymbol{v}f(\\boldsymbol{v})$ 进行积分来计算的。由于被积函数 $\\boldsymbol{v}f(\\boldsymbol{v})$ 是 $\\boldsymbol{v}$ 的奇函数，其在整个速度空间的对称域上的积分为零。因此，体速度为 $\\boldsymbol{u} = \\boldsymbol{0}$。这与问题中描述的“稳定”布居（在其自身参考系中）相符。\n\n当 $\\boldsymbol{u} = \\boldsymbol{0}$ 时，压强张量简化为：\n$$\n\\mathbf{P} = m \\int \\boldsymbol{v}\\boldsymbol{v} f(\\boldsymbol{v}) \\, d^3v\n$$\n问题要求的是标量压强 $p$。对于各向同性分布，压强张量是对角的，且其对角分量相等：$P_{xx} = P_{yy} = P_{zz} = p$。标量压强通常定义为压强张量迹的三分之一：\n$$\np = \\frac{1}{3} \\text{Tr}(\\mathbf{P}) = \\frac{1}{3} \\sum_{i=1}^{3} P_{ii}\n$$\n代入 $\\mathbf{P}$ 的分量表达式：\n$$\np = \\frac{1}{3} m \\int (v_x^2 + v_y^2 + v_z^2) f(\\boldsymbol{v}) \\, d^3v = \\frac{m}{3} \\int v^2 f(\\boldsymbol{v}) \\, d^3v\n$$\n现在，我们将给定的麦克斯韦分布代入 $f(\\boldsymbol{v})$：\n$$\np = \\frac{m}{3} \\int v^2 \\left( n_{0}\\,(\\pi\\,v_{th}^{2})^{-3/2}\\,\\exp\\!\\left(-\\frac{v^{2}}{v_{th}^{2}}\\right) \\right) \\, d^3v\n$$\n我们可以将常数从积分中提出：\n$$\np = \\frac{m n_{0}}{3} (\\pi v_{th}^2)^{-3/2} \\int v^2 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, d^3v\n$$\n被积函数是球对称的。因此，我们可以在球速度坐标中计算该积分，其中体积元为 $d^3v = 4\\pi v^2 dv$：\n$$\n\\int v^2 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, d^3v = \\int_{0}^{\\infty} v^2 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) (4\\pi v^2) \\, dv = 4\\pi \\int_{0}^{\\infty} v^4 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, dv\n$$\n这是一个标准的高斯积分，形式为 $\\int_{0}^{\\infty} x^{2n} \\exp(-ax^2) dx = \\frac{(2n-1)!!}{2^{n+1} a^n} \\sqrt{\\frac{\\pi}{a}}$。在我们的例子中，$x=v$，$n=2$，并且 $a=1/v_{th}^2$。\n双阶乘是 $(2(2)-1)!! = 3!! = 3 \\cdot 1 = 3$。\n因此，该积分的计算结果为：\n$$\n\\int_{0}^{\\infty} v^4 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, dv = \\frac{3!!}{2^{2+1} (1/v_{th}^2)^2} \\sqrt{\\frac{\\pi}{1/v_{th}^2}} = \\frac{3}{8 v_{th}^{-4}} \\sqrt{\\pi v_{th}^2} = \\frac{3}{8} v_{th}^4 \\cdot v_{th} \\sqrt{\\pi} = \\frac{3 \\sqrt{\\pi}}{8} v_{th}^5\n$$\n将此结果代回压强的表达式中：\n$$\np = \\frac{m n_{0}}{3} (\\pi v_{th}^2)^{-3/2} \\left[ 4\\pi \\left( \\frac{3 \\sqrt{\\pi}}{8} v_{th}^5 \\right) \\right]\n$$\n让我们简化常数以及 $\\pi$ 和 $v_{th}$ 的幂：\n$$\np = \\left(\\frac{m n_{0}}{3}\\right) \\left(\\pi^{-3/2} v_{th}^{-3}\\right) \\left(\\frac{12\\pi \\sqrt{\\pi}}{8} v_{th}^5\\right)\n$$\n数值因子为 $\\frac{1}{3} \\cdot \\frac{12}{8} = \\frac{1}{3} \\cdot \\frac{3}{2} = \\frac{1}{2}$。\n$\\pi$ 的幂为 $\\pi^{-3/2} \\cdot \\pi^1 \\cdot \\pi^{1/2} = \\pi^{-3/2+1+1/2} = \\pi^0 = 1$。\n$v_{th}$ 的幂为 $v_{th}^{-3} \\cdot v_{th}^5 = v_{th}^2$。\n将这些项组合起来，得到标量压强的最终表达式：\n$$\np = \\frac{1}{2} m n_{0} v_{th}^2\n$$\n\n第二，我们确定在一个天文单位（AU）附近，无碰撞弗拉索夫处理方法对膨胀的太阳风有效的最小物理假设集。\n弗拉索夫方程描述了分布函数在平滑、长程、自洽电磁场影响下的动力学，同时明确忽略了短程粒子间相互作用（碰撞）的影响。“无碰撞”是一个近似，其有效性取决于物理尺度的分离。最小假设集可以陈述如下：\n\n1.  **长度的尺度分离**：所研究的等离子体现象的特征长度尺度 $L_{char}$ 必须远小于二体碰撞的平均自由程 $\\lambda_{mfp}$。对于膨胀太阳风的大尺度结构，特征长度是宏观量（如密度或温度）发生显著变化的尺度。该尺度与日心距离本身处于同一量级，因此 $L_{char} \\approx r$。所以，条件变为 $\\lambda_{mfp} \\gg r$。在 1 AU 附近的太阳风中，质子-质子碰撞平均自由程确实在 1 AU 或更大的量级，这使得无碰撞近似适合描述其全局膨胀。\n\n2.  **时间的尺度分离**：等效地，等离子体现象的特征时间尺度 $\\tau_{char}$ 必须远短于碰撞之间的平均时间 $\\tau_c$。对于太阳风膨胀，特征时间是膨胀时间，$\\tau_{char} \\approx L_{char}/U_{sw} \\approx r/U_{sw}$，其中 $U_{sw}$ 是太阳风的体速度。因此条件为 $\\tau_c \\gg r/U_{sw}$。由于 $\\tau_c = \\lambda_{mfp}/v_{th}$ 且通常 $v_{th} \\sim U_{sw}$，这个条件在很大程度上等同于长度尺度分离。\n\n3.  **集体行为的主导性**：弗拉索夫方程是一种平均场理论。其适用性要求等离子体的行为由长程场介导的集体相互作用主导，而不是由离散的二体碰撞主导。对于一个可被称为等离子体的系统，这是成立的，其定量表述为德拜球内的粒子数 $N_D$ 远大于一 ($N_D \\gg 1$)。德拜球的半径等于德拜长度 $\\lambda_D$。在 1 AU 附近的太阳风中，$N_D$ 极大（通常 $> 10^{10}$），因此这一基本假设得到了很好的满足。\n\n总之，对大尺度太阳风采用无碰撞弗拉索夫描述的关键理由是，等离子体足够热且足够稀薄，以至于抵抗库仑碰撞的平均自由程与系统本身的宏观尺度相当或更大。",
            "answer": "$$\\boxed{\\frac{1}{2} m n_{0} v_{th}^{2}}$$"
        },
        {
            "introduction": "弗拉索夫方程最重要的推论之一是朗道阻尼，即静电波在即使没有碰撞的情况下也会发生衰减。本练习将引导您通过求解弗拉索夫-泊松色散关系，来分析推导阻尼率。与更复杂的麦克斯韦分布不同，这里使用洛伦兹分布简化了所需的围道积分，使您能够专注于波-粒共振和解析延拓的核心概念。",
            "id": "364533",
            "problem": "**背景：** 在无碰撞、无磁化的等离子体中，纵向静电波（朗缪尔波）的色散由 Vlasov-Poisson 方程组描述。对于沿 $z$ 轴传播、波数为 $k$、复频率为 $\\omega$ 的波，其色散关系由下式给出：\n$$ \\epsilon(k, \\omega) = 1 + \\frac{\\omega_p^2}{k^2} \\int_C \\frac{\\frac{\\partial f_{0z}(v_z)}{\\partial v_z}}{v_z - \\frac{\\omega}{k}} dv_z = 0 $$\n此处，$\\omega_p = \\sqrt{\\frac{n_0 e^2}{m\\epsilon_0}}$ 是电子等离子体频率，其中 $n_0$ 是平衡电子数密度，$e$ 是元电荷，$m$ 是电子质量，$\\epsilon_0$ 是真空介电常数。函数 $f_{0z}(v_z)$ 是沿传播轴的一维平衡电子速度分布，归一化满足 $\\int_{-\\infty}^{\\infty} f_{0z}(v_z) dv_z = 1$。根据 Landau 对围道 $C$ 的规定，为求解初值问题，首先对 $\\text{Im}(\\omega) > 0$ 的情况沿实 $v_z$ 轴计算积分，然后将所得函数 $\\epsilon(k, \\omega)$ 解析延拓到整个复 $\\omega$ 平面，以寻找等离子体的本征模式。\n\n**问题：**\n考虑一个等离子体，其一维电子速度分布为洛伦兹分布（或柯西分布），由下式给出：\n$$ f_{0z}(v_z) = \\frac{a}{\\pi} \\frac{1}{v_z^2 + a^2} $$\n其中 $a > 0$ 是一个具有速度量纲的常数，它表征了分布的速度展宽。\n\n通过求解此特定分布的色散关系，确定具有正实频率 $\\omega_r(k) = \\text{Re}(\\omega) > 0$ 的波模的阻尼率 $\\gamma(k) = \\text{Im}(\\omega)$。您的推导必须涉及使用复围道积分计算色散关系中的积分。请用 $a$ 和 $k$ 表示您的答案。",
            "solution": "我们首先从洛伦兹色散关系开始：\n$$ \\epsilon(k, \\omega) = 1 + \\frac{\\omega_p^2}{k^2} \\int_C \\frac{\\frac{\\partial f_{0z}}{\\partial v_z}}{v_z - \\zeta} dv_z = 0 $$\n其中 $\\zeta = \\omega/k$ 是波的相速度。\n\n对于给定的洛伦兹分布 $f_{0z}(v_z) = \\frac{a}{\\pi(v_z^2 + a^2)}$，其导数为 $\\frac{\\partial f_{0z}}{\\partial v_z} = -\\frac{2a v_z}{\\pi(v_z^2 + a^2)^2}$。\n色散关系中的积分项为：\n$$ I(k, \\omega) = \\int_C \\frac{\\frac{\\partial f_{0z}}{\\partial v_z}}{v_z - \\zeta} dv_z $$\n根据朗道规则，我们为 $\\text{Im}(\\omega) > 0$（即 $\\text{Im}(\\zeta) > 0$）计算这个积分，然后对结果进行解析延拓。这个积分可以通过围道积分法计算。对于洛伦兹分布，有一个已知的积分结果：\n$$ \\int_C \\frac{\\frac{\\partial f_{0z}}{\\partial v_z}}{v_z - \\zeta} dv_z = -\\frac{1}{(\\zeta + ia)^2} $$\n这个结果是通过在复速度平面的上半平面闭合围道，并应用留数定理得到的，同时考虑到 $\\text{Im}(\\zeta) > 0$。\n\n将这个积分结果代入色散关系中，我们得到：\n$$ 1 + \\frac{\\omega_p^2}{k^2} \\left( -\\frac{1}{(\\zeta + ia)^2} \\right) = 0 $$\n整理得到：\n$$ 1 = \\frac{\\omega_p^2}{k^2 (\\zeta + ia)^2} $$\n$$ k^2 (\\zeta + ia)^2 = \\omega_p^2 $$\n用 $\\zeta = \\omega/k$ 代换回来：\n$$ k^2 (\\frac{\\omega}{k} + ia)^2 = \\omega_p^2 $$\n$$ (\\omega + iak)^2 = \\omega_p^2 $$\n对两边开方，得到两个解：\n$$ \\omega + iak = \\pm \\omega_p $$\n求解 $\\omega$：\n$$ \\omega = \\pm \\omega_p - iak $$\n我们得到两个模式。问题要求我们寻找具有正实频率的模式，即 $\\text{Re}(\\omega) > 0$。这个模式是：\n$$ \\omega(k) = \\omega_p - iak $$\n该模式的复频率 $\\omega(k)$ 由实部（振荡频率）和虚部（阻尼率或增长率）组成：\n$$ \\omega_r(k) = \\text{Re}(\\omega) = \\omega_p $$\n$$ \\gamma(k) = \\text{Im}(\\omega) = -ak $$\n因此，该波模的阻尼率是 $\\gamma(k) = -ak$。由于 $a > 0$ 和 $k > 0$，阻尼率是负值，表示波的振幅会随时间指数衰减。",
            "answer": "$$\\boxed{-ak}$$"
        },
        {
            "introduction": "虽然解析方法能提供深刻的物理洞察，但大多数真实的等离子体情景需要对弗拉索夫方程进行数值求解。本练习介绍了一种强大的数值技术——特征线法，它通过追溯粒子路径来求解弗拉索夫方程。您将实施此方法来处理一个随时间变化的“激波状”入流边界条件，从而亲身体验许多现代弗拉索夫求解器背后的核心逻辑。",
            "id": "4233976",
            "problem": "考虑一个单一粒子种类的一维单速静电 Vlasov 问题，其分布函数 $f(x,v,t)$ 满足无碰撞 Vlasov 方程\n$$\n\\frac{\\partial f}{\\partial t} + v\\,\\frac{\\partial f}{\\partial x} + \\frac{q}{m} E(x,t)\\,\\frac{\\partial f}{\\partial v} = 0,\n$$\n其中 $x$ 是位置，$v$ 是速度，$t$ 是时间，$q$ 是粒子电荷，$m$ 是粒子质量，$E(x,t)$ 是电场。假设存在一个由 $a=\\frac{q}{m}E$ 定义的恒定加速度 $a$，其中 $E$ 在空间和时间上是均匀的，因此 $a$ 是一个常数。计算域为 $x\\in[0,L]$，速度域为 $v\\in[v_{\\min},v_{\\max}]$。初始条件为对于所有 $x$ 和 $v$，$f(x,v,0)=0$。边界条件为：\n- 左侧 $x=0$ 处为流入边界：对于 $v>0$，$f(0,v,t)=f_{\\text{in}}(v,t)$。\n- 右侧 $x=L$ 处为边界：只有流出，即没有从 $x=L$ 流入的粒子，因此从 $x=L$ 进入的特征线不产生贡献。\n\n实现一个在 $x=0$ 处由随时间变化的分段麦克斯韦分布定义的激波状流入边界条件，\n$$\nf_{\\text{in}}(v,t)=\n\\begin{cases}\nM(v; U_{\\text{up}}, v_{\\text{th,up}}),  \\text{if } 0 \\le t  t_s \\\\\nM(v; U_{\\text{dn}}, v_{\\text{th,dn}}),  \\text{if } t_s \\le t\n\\end{cases}\n$$\n其中 $M(v;U,v_{\\text{th}}) = \\frac{1}{\\sqrt{2\\pi} v_{\\text{th}}} \\exp\\left(-\\frac{(v-U)^2}{2v_{\\text{th}}^2}\\right)$。$t_s$ 是激波到达边界的时刻。使用特征线法，计算在目标位置 $x_t=L/2$ 和最终时间 $t_f$ 的分布函数 $f(x_t, v, t_f)$。然后，通过对该分布函数进行数值积分，计算以下物理量：\n1.  数密度 $n = \\int f(x_t,v,t_f)dv$。\n2.  归一化平均速度 $u/U_{\\text{up}}$，其中 $u = \\frac{1}{n}\\int v f(x_t,v,t_f)dv$。\n3.  上游粒子数分数 $\\phi$，定义为源于上游条件 ($t  t_s$) 的粒子数与总粒子数的比值。\n\n您的答案应为一个包含 12 个浮点数的列表，对应于下方 `solve` 函数中定义的四个测试用例，每个测试用例输出 `(n, u/U_up, phi)` 三个值。",
            "solution": "所提出的问题是一个在恒定、外部施加的加速度下，一维无碰撞 Vlasov 方程的适定初边值问题。该问题具有科学依据，数学上一致，并且提供了获得唯一解所需的所有参数和条件。因此，该问题是有效的，我们可以着手求解。\n\nVlasov 方程描述了分布函数 $f(x,v,t)$ 在相空间中的演化：\n$$\n\\frac{\\partial f}{\\partial t} + v\\,\\frac{\\partial f}{\\partial x} + a\\,\\frac{\\partial f}{\\partial v} = 0\n$$\n其中 $a = \\frac{qE}{m}$ 是恒定的加速度。采用特征线法来求解该方程。该方法依赖于这样一个原理：分布函数 $f$ 沿着相空间中的粒子轨迹是恒定的。这些轨迹，即所谓的特征线，由以下常微分方程组决定：\n$$\n\\frac{dx}{dt} = v, \\quad \\frac{dv}{dt} = a\n$$\n对于恒定的加速度 $a$，对这些方程进行积分，可以得到一个在时间 $t_0$ 位于 $(x_0, v_0)$ 的粒子在时间 $t$ 的位置 $x(t)$ 和速度 $v(t)$：\n$$\nv(t) = v_0 + a(t-t_0), \\quad x(t) = x_0 + v_0(t-t_0) + \\frac{1}{2}a(t-t_0)^2\n$$\n为了找到在目标相空间点 $(x,v,t)$ 处 $f(x,v,t)$ 的值，我们沿时间反向追溯其特征线。$f$ 在 $(x,v,t)$ 处的值等于其在特征线起点处的值。起点可以位于 $t'=0$ 的初始域中，也可以位于某个时间 $s \\in [0,t)$ 的空间边界上。\n\n问题指定了零初始条件 $f(x,v,0)=0$ 和在 $x=L$ 处的仅流出条件。因此，$f(x,v,t)$ 的任何非零值都必须源于 $x=0$ 处的流入边界。我们的任务是，对于一个给定的点 $(x,v,t)$，确定其特征线是否在某个时间 $s \\in [0,t)$ 以流入速度 $v_b > 0$ 与边界 $x=0$ 相交。如果相交，则 $f(x,v,t) = f(0,v_b,s) = f_{\\text{in}}(v_b,s)$。否则，$f(x,v,t)=0$。\n\n设目标点为 $(x_t, v_t, t_f)$，对于本问题 $x_t = L/2$。设边界穿越点为 $(0, v_b, s)$。飞行时间为 $\\Delta = t_f-s$。关联这些点的特征线方程是：\n$$\nv_t = v_b + a\\Delta, \\quad x_t = v_b \\Delta + \\frac{1}{2}a\\Delta^2\n$$\n我们可以解这个方程组来求 $\\Delta$ 和 $v_b$。将第一个方程中的 $v_b = v_t - a\\Delta$ 代入第二个方程，得到一个关于 $\\Delta$ 的二次方程：\n$$\nx_t = (v_t - a\\Delta)\\Delta + \\frac{1}{2}a\\Delta^2 \\implies \\frac{1}{2}a\\Delta^2 - v_t\\Delta + x_t = 0\n$$\n解取决于 $a=0$ 还是 $a\\neq 0$。\n\n情况 1：$a=0$\n方程简化为 $-v_t\\Delta + x_t = 0$，得出 $\\Delta = x_t/v_t$。对于来自流入边界的有效物理轨迹，我们要求：\n1. $v_t > 0$：粒子必须从 $x=0$ 向 $x=x_t$ 移动。\n2. $0  \\Delta \\le t_f$：粒子必须在 $t=0$ 之后离开边界，并在 $t=t_f$ 或之前到达。\n边界速度为 $v_b = v_t$，按要求为正。\n\n情况 2：$a\\neq0$\n类功能关系为 $v_t^2 - v_b^2 = 2ax_t$。因为我们要求流入速度 $v_b > 0$，所以必须有 $v_b^2 = v_t^2 - 2ax_t > 0$。这给出了边界速度为 $v_b = \\sqrt{v_t^2 - 2ax_t}$。判别式 $D = v_t^2 - 2ax_t$ 必须为正。一旦求出 $v_b$，就可以从 $v_t = v_b + a\\Delta$ 唯一确定 $\\Delta$ 为 $\\Delta = (v_t - v_b)/a$。\n\n当 $a\\neq0$ 时，产生非零贡献的完备条件集是：\n1. $D = v_t^2 - 2ax_t > 0$：边界处必须存在实数正速度解。\n2. 计算 $v_b = \\sqrt{D}$ 和 $\\Delta = (v_t - v_b)/a$。\n3. $0  \\Delta \\le t_f$：渡越时间必须在物理上有意义。\n\n如果满足这些条件，则边界穿越时间为 $s=t_f-\\Delta$。然后，分布函数的值由分段流入边界条件确定：\n$$\nf_{\\text{in}}(v_b,s)=\n\\begin{cases}\nM(v_b; U_{\\text{up}}, v_{\\text{th,up}}),  \\text{if } 0 \\le s  t_s \\\\\nM(v_b; U_{\\text{dn}}, v_{\\text{th,dn}}),  \\text{if } t_s \\le s\n\\end{cases}\n$$\n有了在速度网格上计算 $f(x_t, v, t_f)$ 的方法，我们就可以通过数值积分（例如，梯形法则）来计算所需的宏观量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print the results.\n    \"\"\"\n    # Test Suite:\n    # (L, a, t_f, U_up, v_th_up, U_dn, v_th_dn, t_s, v_min, v_max, N_v)\n    test_cases = [\n        (1.0, 0.0, 0.5, 1.0, 0.1, 0.3, 0.3, 0.3, -2.0, 3.0, 800),\n        (1.0, 0.2, 0.5, 1.0, 0.1, 0.6, 0.25, 0.25, -2.0, 3.0, 800),\n        (1.0, 0.0, 0.05, 1.5, 0.05, 0.5, 0.2, 0.03, -2.0, 3.0, 800),\n        (1.0, -0.5, 0.5, 1.0, 0.1, 0.4, 0.3, 0.2, -2.0, 3.0, 800)\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = compute_for_case(*case)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    # Format to a reasonable number of decimal places for consistency.\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef maxwellian(v, U, v_th):\n    \"\"\"\n    Computes the Maxwellian distribution M(v; U, v_th) with n0=1.\n    \"\"\"\n    if v_th == 0:\n        return 0.0\n    norm = 1.0 / (np.sqrt(2.0 * np.pi) * v_th)\n    exponent = -((v - U)**2) / (2.0 * v_th**2)\n    return norm * np.exp(exponent)\n\ndef compute_for_case(L, a, t_f, U_up, v_th_up, U_dn, v_th_dn, t_s, v_min, v_max, N_v):\n    \"\"\"\n    Computes the density, mean velocity, and upstream fraction for a single test case.\n    \"\"\"\n    x = L / 2.0\n    v_grid, dv = np.linspace(v_min, v_max, N_v, retstep=True)\n\n    f_vals = np.zeros(N_v)\n    is_upstream = np.zeros(N_v, dtype=bool)\n\n    for i, v_t in enumerate(v_grid):\n        delta = -1.0\n        v_b = -1.0\n\n        if a == 0.0:\n            if v_t > 0:\n                delta_candidate = x / v_t\n                if 0  delta_candidate and delta_candidate = t_f:\n                    delta = delta_candidate\n                    v_b = v_t\n        else: # a != 0\n            discriminant = v_t**2 - 2 * a * x\n            if discriminant > 0:\n                v_b_candidate = np.sqrt(discriminant)\n                # This formulation for delta is robust for a != 0\n                delta_candidate = (v_t - v_b_candidate) / a\n                if 0  delta_candidate and delta_candidate = t_f:\n                    delta = delta_candidate\n                    v_b = v_b_candidate\n        \n        if delta > 0: # A valid characteristic was found\n            s = t_f - delta\n            if s  t_s:\n                f_vals[i] = maxwellian(v_b, U_up, v_th_up)\n                is_upstream[i] = True\n            else: # s >= t_s\n                f_vals[i] = maxwellian(v_b, U_dn, v_th_dn)\n\n    # Perform numerical integration\n    n_sum = np.sum(f_vals)\n    n = n_sum * dv\n    \n    if n  1e-15: # Effectively zero density\n        return 0.0, 0.0, 0.0\n\n    # Calculate mean velocity\n    n_u_moment = np.sum(v_grid * f_vals) * dv\n    u = n_u_moment / n\n    u_norm = u / U_up\n    \n    # Calculate upstream fraction\n    n_up_sum = np.sum(f_vals[is_upstream])\n    # phi is a ratio of integrals, dv cancels.\n    phi = n_up_sum / n_sum if n_sum > 0 else 0.0\n    \n    return n, u_norm, phi\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}