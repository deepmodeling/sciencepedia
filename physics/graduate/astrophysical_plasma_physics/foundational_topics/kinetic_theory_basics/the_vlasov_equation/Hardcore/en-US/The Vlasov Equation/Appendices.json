{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of kinetic theory is the ability to connect the microscopic description of a plasma, encapsulated by the distribution function $f(\\boldsymbol{x}, \\boldsymbol{v}, t)$, to its macroscopic, fluid-like properties. This first exercise provides essential practice in this procedure by guiding you to derive the scalar pressure—a second-order velocity moment—from a given Maxwellian distribution. Beyond the calculation, this problem  challenges you to consider the real-world applicability of the Vlasov equation by identifying the physical conditions under which this collisionless model is justified for a system like the solar wind.",
            "id": "4233992",
            "problem": "In astrophysical plasma physics, the collisionless kinetic description employs the Vlasov equation, which governs the evolution of the single-particle distribution function under self-consistent electromagnetic fields while neglecting binary collisions. Consider a stationary, spatially homogeneous proton population in the solar wind modeled by an isotropic Maxwellian distribution\n$$\nf(\\boldsymbol{v}) \\;=\\; n_{0}\\,(\\pi\\,v_{th}^{2})^{-3/2}\\,\\exp\\!\\left(-\\frac{v^{2}}{v_{th}^{2}}\\right),\n$$\nwhere $n_{0}$ is the number density, $m$ is the proton mass, and $v_{th}$ is the thermal speed parameter. Starting from the kinetic-theory definition of scalar pressure as the isotropic second velocity moment of the distribution function, derive the scalar pressure $p$ of this Maxwellian in terms of $m$, $n_{0}$, and $v_{th}$, and express the result as a single closed-form analytic expression. Then, based on the collisionless Vlasov description, identify the minimal set of physical assumptions on collisionality and characteristic scales under which this collisionless treatment remains valid for the expanding solar wind near one Astronomical Unit (AU). No numerical evaluation is required, and no units need to be reported in the final expression; provide the pressure symbolically.",
            "solution": "The problem requires two distinct tasks: first, to derive the scalar pressure $p$ for a proton population described by an isotropic Maxwellian distribution function, and second, to identify the physical assumptions that validate the use of the collisionless Vlasov equation for the expanding solar wind.\n\nFirst, we address the derivation of the scalar pressure $p$.\nThe general definition of the pressure tensor, $\\mathbf{P}$, for a particle species of mass $m$ is given by the second central moment of its distribution function $f(\\boldsymbol{v})$:\n$$\n\\mathbf{P} = m \\int (\\boldsymbol{v} - \\boldsymbol{u})(\\boldsymbol{v} - \\boldsymbol{u}) f(\\boldsymbol{v}) \\, d^3v\n$$\nwhere $\\boldsymbol{u}$ is the mean (bulk) velocity of the population, defined as $\\boldsymbol{u} = \\frac{1}{n} \\int \\boldsymbol{v} f(\\boldsymbol{v}) \\, d^3v$, with $n = \\int f(\\boldsymbol{v}) \\, d^3v$ being the number density.\n\nThe given distribution function is\n$$\nf(\\boldsymbol{v}) = n_{0}\\,(\\pi\\,v_{th}^{2})^{-3/2}\\,\\exp\\!\\left(-\\frac{v^{2}}{v_{th}^{2}}\\right)\n$$\nwhere $v = |\\boldsymbol{v}|$. This function is isotropic, meaning it depends only on the magnitude of the velocity, not its direction. It is also an even function of the velocity vector components, i.e., $f(-\\boldsymbol{v}) = f(\\boldsymbol{v})$. The mean velocity $\\boldsymbol{u}$ is calculated by integrating $\\boldsymbol{v}f(\\boldsymbol{v})$ over all of velocity space. Since the integrand $\\boldsymbol{v}f(\\boldsymbol{v})$ is an odd function of $\\boldsymbol{v}$, its integral over the symmetric domain of all velocity space is zero. Thus, the bulk velocity is $\\boldsymbol{u} = \\boldsymbol{0}$. This corresponds to the problem's description of a \"stationary\" population (in its own reference frame).\n\nWith $\\boldsymbol{u} = \\boldsymbol{0}$, the pressure tensor simplifies to:\n$$\n\\mathbf{P} = m \\int \\boldsymbol{v}\\boldsymbol{v} f(\\boldsymbol{v}) \\, d^3v\n$$\nThe problem asks for the scalar pressure $p$. For an isotropic distribution, the pressure tensor is diagonal and its diagonal components are equal: $P_{xx} = P_{yy} = P_{zz} = p$. The scalar pressure is conventionally defined as one-third of the trace of the pressure tensor:\n$$\np = \\frac{1}{3} \\text{Tr}(\\mathbf{P}) = \\frac{1}{3} \\sum_{i=1}^{3} P_{ii}\n$$\nSubstituting the expression for the components of $\\mathbf{P}$:\n$$\np = \\frac{1}{3} m \\int (v_x^2 + v_y^2 + v_z^2) f(\\boldsymbol{v}) \\, d^3v = \\frac{m}{3} \\int v^2 f(\\boldsymbol{v}) \\, d^3v\n$$\nNow, we substitute the given Maxwellian distribution for $f(\\boldsymbol{v})$:\n$$\np = \\frac{m}{3} \\int v^2 \\left( n_{0}\\,(\\pi\\,v_{th}^{2})^{-3/2}\\,\\exp\\!\\left(-\\frac{v^{2}}{v_{th}^{2}}\\right) \\right) \\, d^3v\n$$\nWe can pull the constants out of the integral:\n$$\np = \\frac{m n_{0}}{3} (\\pi v_{th}^2)^{-3/2} \\int v^2 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, d^3v\n$$\nThe integrand is spherically symmetric. Therefore, we can evaluate the integral in spherical velocity coordinates, where the volume element is $d^3v = 4\\pi v^2 dv$:\n$$\n\\int v^2 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, d^3v = \\int_{0}^{\\infty} v^2 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) (4\\pi v^2) \\, dv = 4\\pi \\int_{0}^{\\infty} v^4 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, dv\n$$\nThis is a standard Gaussian integral of the form $\\int_{0}^{\\infty} x^{2n} \\exp(-ax^2) dx = \\frac{(2n-1)!!}{2^{n+1} a^n} \\sqrt{\\frac{\\pi}{a}}$. In our case, $x=v$, $n=2$, and $a=1/v_{th}^2$.\nThe double factorial is $(2(2)-1)!! = 3!! = 3 \\cdot 1 = 3$.\nSo, the integral evaluates to:\n$$\n\\int_{0}^{\\infty} v^4 \\exp\\left(-\\frac{v^2}{v_{th}^2}\\right) \\, dv = \\frac{3!!}{2^{2+1} (1/v_{th}^2)^2} \\sqrt{\\frac{\\pi}{1/v_{th}^2}} = \\frac{3}{8 v_{th}^{-4}} \\sqrt{\\pi v_{th}^2} = \\frac{3}{8} v_{th}^4 \\cdot v_{th} \\sqrt{\\pi} = \\frac{3 \\sqrt{\\pi}}{8} v_{th}^5\n$$\nSubstituting this back into the expression for the pressure:\n$$\np = \\frac{m n_{0}}{3} (\\pi v_{th}^2)^{-3/2} \\left[ 4\\pi \\left( \\frac{3 \\sqrt{\\pi}}{8} v_{th}^5 \\right) \\right]\n$$\nLet's simplify the constants and powers of $\\pi$ and $v_{th}$:\n$$\np = \\left(\\frac{m n_{0}}{3}\\right) \\left(\\pi^{-3/2} v_{th}^{-3}\\right) \\left(\\frac{12\\pi \\sqrt{\\pi}}{8} v_{th}^5\\right)\n$$\nThe numerical factors are $\\frac{1}{3} \\cdot \\frac{12}{8} = \\frac{1}{3} \\cdot \\frac{3}{2} = \\frac{1}{2}$.\nThe powers of $\\pi$ are $\\pi^{-3/2} \\cdot \\pi^1 \\cdot \\pi^{1/2} = \\pi^{-3/2+1+1/2} = \\pi^0 = 1$.\nThe powers of $v_{th}$ are $v_{th}^{-3} \\cdot v_{th}^5 = v_{th}^2$.\nCombining these terms yields the final expression for the scalar pressure:\n$$\np = \\frac{1}{2} m n_{0} v_{th}^2\n$$\n\nSecond, we identify the minimal set of physical assumptions under which the collisionless Vlasov treatment is valid for the expanding solar wind near one Astronomical Unit (AU).\nThe Vlasov equation describes the dynamics of a distribution function under the influence of smooth, long-range, self-consistent electromagnetic fields, while explicitly neglecting the effects of short-range particle-particle interactions (collisions). The term \"collisionless\" is an approximation whose validity depends on the separation of physical scales. The minimal set of assumptions can be stated as follows:\n\n1.  **Scale Separation of Lengths**: The characteristic length scale of the plasma phenomena being studied, $L_{char}$, must be much smaller than the mean free path for binary collisions, $\\lambda_{mfp}$. For the large-scale structure of the expanding solar wind, the characteristic length is the scale over which macroscopic quantities (like density or temperature) vary significantly. This scale is on the order of the heliocentric distance itself, so $L_{char} \\approx r$. Therefore, the condition becomes $\\lambda_{mfp} \\gg r$. For the solar wind near $1$ AU, the proton-proton collisional mean free path is indeed on the order of $1$ AU or larger, making the collisionless approximation appropriate for describing its global expansion.\n\n2.  **Scale Separation of Times**: Equivalently, the characteristic timescale of the plasma phenomena, $\\tau_{char}$, must be much shorter than the mean time between collisions, $\\tau_c$. For solar wind expansion, the characteristic time is the expansion time, $\\tau_{char} \\approx L_{char}/U_{sw} \\approx r/U_{sw}$, where $U_{sw}$ is the bulk solar wind speed. The condition is thus $\\tau_c \\gg r/U_{sw}$. Since $\\tau_c = \\lambda_{mfp}/v_{th}$ and typically $v_{th} \\sim U_{sw}$, this condition is largely equivalent to the length scale separation.\n\n3.  **Dominance of Collective Behavior**: The Vlasov equation is a mean-field theory. Its applicability requires that the plasma's behavior is governed by collective interactions mediated by long-range fields, rather than by discrete binary encounters. This is true for a system that qualifies as a plasma, which is quantitatively expressed by the condition that the number of particles in a Debye sphere, $N_D$, is much greater than one ($N_D \\gg 1$). The Debye sphere has a radius equal to the Debye length, $\\lambda_D$. For the solar wind near $1$ AU, $N_D$ is extremely large (typically $ 10^{10}$), so this fundamental assumption is robustly satisfied.\n\nIn summary, the key justification for the collisionless Vlasov description of the solar wind on large scales is that the plasma is sufficiently hot and tenuous such that the mean free path against Coulomb collisions is comparable to or larger than the macroscopic scale of the system itself.",
            "answer": "$$\\boxed{\\frac{1}{2} m n_{0} v_{th}^{2}}$$"
        },
        {
            "introduction": "The Vlasov equation describes a time-reversible evolution, a fact with surprising and profound consequences that are not apparent in fluid models. This exercise  explores the plasma echo, a stunning demonstration of this reversibility where a macroscopic signal, seemingly erased by phase mixing, can be resurrected by a second perturbation. By tracing the evolution of phase-space structures, you will uncover the mechanism by which information is preserved in fine-grained velocity structures and can be recalled, providing deep insight into the nature of collisionless damping.",
            "id": "4233957",
            "problem": "Consider a collisionless, unmagnetized, one-dimensional, electrostatic plasma described by the Vlasov–Poisson system. Let the equilibrium distribution be spatially homogeneous and given by a smooth function $f_{0}(v)$ with number density $n_{0}=\\int_{-\\infty}^{\\infty} f_{0}(v)\\,dv$. The collisionless Vlasov equation for the distribution $f(x,v,t)$ and Poisson’s equation for the electric field $E(x,t)$ are\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + \\frac{e}{m} E(x,t)\\,\\frac{\\partial f}{\\partial v} = 0,\\qquad\n\\frac{\\partial E}{\\partial x} = \\frac{e}{\\varepsilon_{0}}\\left(\\int_{-\\infty}^{\\infty} f\\,dv - n_{0}\\right).\n$$\nAt time $t=0$, apply a very short electrostatic pulse with spatial dependence $\\cos(k_{1} x)$ and total (time-integrated) field strength $\\mathcal{E}_{1}=\\int E_{1}(t)\\,dt$, so that the impulse approximation is valid and the effect of the pulse is an instantaneous velocity kick $\\Delta v_{1}(x) = - (e/m)\\,\\mathcal{E}_{1}\\cos(k_{1} x)$. At time $t=\\tau0$, apply a second short pulse with spatial dependence $\\cos(k_{2} x)$ and total field strength $\\mathcal{E}_{2}$, giving a second kick $\\Delta v_{2}(x) = - (e/m)\\,\\mathcal{E}_{2}\\cos(k_{2} x)$. Assume both pulses are sufficiently weak that, between the pulses and after the second pulse, the subsequent evolution is dominated by ballistic phase mixing (free streaming) and any self-consistent fields generated by the linear responses are negligibly small compared with the impulsive kicks. Work consistently to the lowest nontrivial order in the pulse amplitudes that can produce a re-emergent macroscopic mode.\n\nTasks:\n$1.$ Using the Vlasov equation and the impulse approximation, write the distribution just after the first pulse, evolve it ballistically to time $t=\\tau^{-}$, then apply the second pulse at $t=\\tau$ retaining the cross-term that is second order in the pulse strengths and can seed a macroscopic response for $t\\tau$. Express the resulting phase dependence of this cross-term immediately after the second pulse.\n\n$2.$ Evolve that cross-term by free streaming for $t\\tau$, and determine the wave number $k_{\\mathrm{echo}}$ and the time $t_{\\mathrm{echo}}$ at which an $x$-dependent component of the charge density (and hence electric field) can re-emerge despite prior phase mixing. Your answer must be expressed in terms of $k_{1}$, $k_{2}$, and $\\tau$, and should be obtained by requiring that the velocity-dependent phase responsible for phase mixing cancels.\n\n$3.$ Briefly identify the physical mechanism that enables this re-emergence in a collisionless plasma, using first-principles reasoning about phase-space evolution under the Vlasov dynamics.\n\nWhich of the following options correctly states $k_{\\mathrm{echo}}$, $t_{\\mathrm{echo}}$, and the underlying mechanism?\n\nA. An echo reappears at wave number $k_{\\mathrm{echo}}=k_{2}-k_{1}$ at time $t_{\\mathrm{echo}}=\\tau\\,k_{2}/(k_{2}-k_{1}) \\tau$. It arises because ballistic phase mixing from the first kick shears the perturbation into fine phase-space filaments whose velocity-dependent phases are modulated by the second kick; at $t_{\\mathrm{echo}}$ the velocity-dependent phase cancels for the $k_{2}-k_{1}$ component, reconstructing a macroscopic mode. The effect is second order in the pulse strengths and vanishes if either pulse is absent.\n\nB. An echo reappears at wave number $k_{\\mathrm{echo}}=k_{1}+k_{2}$ at time $t_{\\mathrm{echo}}=\\tau\\,k_{2}/(k_{1}+k_{2})$, caused by direct nonlinear coupling in Poisson’s equation; it requires strong fields and disappears in the collisionless limit.\n\nC. An echo reappears at wave number $k_{\\mathrm{echo}}=k_{2}-k_{1}$ at time $t_{\\mathrm{echo}}=\\tau\\,(1+k_{1}/k_{2})$, due to Landau growth of an unstable mode seeded by the second pulse that overcomes earlier damping.\n\nD. No echo can occur in strictly collisionless Vlasov dynamics; any re-emergent macroscopic mode necessarily requires collisions to reverse Landau damping.\n\nSelect the single best option.",
            "solution": "The user wants me to solve a problem about plasma echoes in the Vlasov-Poisson system.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **System**: A collisionless, unmagnetized, one-dimensional, electrostatic plasma.\n- **Governing Equations**: The Vlasov–Poisson system:\n  $$ \\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + \\frac{e}{m} E(x,t)\\,\\frac{\\partial f}{\\partial v} = 0 $$\n  $$ \\frac{\\partial E}{\\partial x} = \\frac{e}{\\varepsilon_{0}}\\left(\\int_{-\\infty}^{\\infty} f\\,dv - n_{0}\\right) $$\n- **Equilibrium**: Spatially homogeneous distribution function $f_{0}(v)$ with number density $n_{0}=\\int_{-\\infty}^{\\infty} f_{0}(v)\\,dv$.\n- **Pulse 1 (at $t=0$)**: A very short electrostatic pulse.\n    - Spatial dependence: $\\cos(k_{1} x)$.\n    - Total time-integrated field strength: $\\mathcal{E}_{1}=\\int E_{1}(t)\\,dt$.\n    - Effect (impulse approximation): Instantaneous velocity kick $\\Delta v_{1}(x) = - (e/m)\\,\\mathcal{E}_{1}\\cos(k_{1} x)$.\n- **Pulse 2 (at $t=\\tau0$)**: A second short electrostatic pulse.\n    - Spatial dependence: $\\cos(k_{2} x)$.\n    - Total time-integrated field strength: $\\mathcal{E}_{2}$.\n    - Effect: Instantaneous velocity kick $\\Delta v_{2}(x) = - (e/m)\\,\\mathcal{E}_{2}\\cos(k_{2} x)$.\n- **Assumptions**:\n    1. Pulses are sufficiently weak (perturbative analysis is appropriate).\n    2. Between and after pulses, evolution is dominated by ballistic phase mixing (free streaming).\n    3. Self-consistent fields generated by linear responses are negligible compared to the impulsive kicks.\n- **Objective**: Work to the lowest nontrivial order in pulse amplitudes ($\\mathcal{E}_1, \\mathcal{E}_2$) that can produce a re-emergent macroscopic mode (an echo).\n- **Tasks**:\n    1. Find the phase dependence of the second-order cross-term in the distribution function just after the second pulse ($t=\\tau^{+}$).\n    2. Determine the echo wave number $k_{\\mathrm{echo}}$ and time $t_{\\mathrm{echo}}$ by canceling the velocity-dependent phase during free streaming for $t  \\tau$.\n    3. Identify the underlying physical mechanism.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem describes the phenomenon of plasma echoes, a well-established concept in kinetic plasma theory rooted in the Vlasov equation. The Vlasov-Poisson system is the standard model for this. The impulse approximation and the neglect of self-consistent fields for ballistic evolution are standard starting points for the theoretical treatment of echoes. The problem is fundamentally sound.\n- **Well-Posed**: The problem is well-posed. The initial state is defined, the perturbations are specified, and the assumptions on the dynamics are clear. This leads to a unique and meaningful solution for the echo time and wavenumber.\n- **Objective**: The language is precise and technical, free of subjective or ambiguous statements.\n\nThe problem statement has no scientific or factual unsoundness, is formalizable, self-contained, and describes a physically realistic (and experimentally verified) phenomenon. It is a standard textbook problem in advanced plasma physics.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. The solution process will proceed.\n\n### Solution Derivation\n\nThe distribution function prior to any perturbations is the equilibrium distribution $f(x,v,t0) = f_{0}(v)$.\n\n**1. Effect of the First Pulse and Subsequent Evolution**\n\nAt $t=0$, the first pulse imparts an instantaneous velocity kick $\\Delta v_{1}(x) = - (e/m)\\,\\mathcal{E}_{1}\\cos(k_{1} x)$. The distribution function immediately after the pulse, at $t=0^{+}$, is given by shifting the velocity argument of the pre-pulse distribution:\n$$ f(x,v,0^{+}) = f_{0}(v - \\Delta v_{1}(x)) $$\nSince the pulse is assumed to be weak, we can Taylor expand $f_{0}$ to first order in $\\Delta v_{1}$:\n$$ f(x,v,0^{+}) \\approx f_{0}(v) - \\Delta v_{1}(x) \\frac{\\partial f_{0}}{\\partial v} = f_{0}(v) + \\frac{e\\mathcal{E}_{1}}{m} \\cos(k_{1} x) \\frac{\\partial f_{0}}{\\partial v} $$\nLet's denote the perturbation as $\\delta f_{1}(x,v,0^{+}) = \\frac{e\\mathcal{E}_{1}}{m} \\cos(k_{1} x) \\frac{\\partial f_{0}}{\\partial v}$.\n\nBetween $t=0$ and $t=\\tau$, the particles undergo free streaming (ballistic motion), as governed by the collisionless Vlasov equation with $E=0$:\n$$ \\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = 0 $$\nThe solution to this equation is $f(x,v,t) = G(x-vt, v)$, where $G$ is determined by the initial condition at $t=0^{+}$. Thus, at a time $t=\\tau^{-}$ just before the second pulse:\n$$ f(x,v,\\tau^{-}) = f(x-v\\tau, v, 0^{+}) \\approx f_{0}(v) + \\frac{e\\mathcal{E}_{1}}{m} \\cos(k_{1}(x - v\\tau)) \\frac{\\partial f_{0}}{\\partial v} $$\nThe first-order perturbation has evolved to $\\delta f_{1}(x,v,\\tau^{-}) = \\frac{e\\mathcal{E}_{1}}{m} \\cos(k_{1}(x - v\\tau)) \\frac{\\partial f_{0}}{\\partial v}$. The initial macroscopic perturbation has phase mixed away, but the information is stored as a microscopic, velocity-dependent structure in the distribution function.\n\n**2. Effect of the Second Pulse (Task 1)**\n\nAt $t=\\tau$, the second pulse imparts a kick $\\Delta v_{2}(x) = - (e/m)\\,\\mathcal{E}_{2}\\cos(k_{2} x)$. The distribution at $t=\\tau^{+}$ is:\n$$ f(x,v,\\tau^{+}) = f(x, v-\\Delta v_{2}(x), \\tau^{-}) $$\nExpanding to first order in the weak kick $\\Delta v_{2}$:\n$$ f(x,v,\\tau^{+}) \\approx f(x,v,\\tau^{-}) - \\Delta v_{2}(x) \\frac{\\partial}{\\partial v}f(x,v,\\tau^{-}) $$\nSubstituting the expression for $f(x,v,\\tau^{-})$:\n$$ f(x,v,\\tau^{+}) \\approx \\left[ f_{0}(v) + \\delta f_{1}(x,v,\\tau^{-}) \\right] + \\frac{e\\mathcal{E}_{2}}{m}\\cos(k_{2}x) \\frac{\\partial}{\\partial v} \\left[ f_{0}(v) + \\delta f_{1}(x,v,\\tau^{-}) \\right] $$\nWe expand and keep terms up to second order in the pulse amplitudes $\\mathcal{E}_{1}, \\mathcal{E}_{2}$.\n$$ f(x,v,\\tau^{+}) \\approx f_{0}(v) + \\delta f_{1}(x,v,\\tau^{-}) + \\frac{e\\mathcal{E}_{2}}{m}\\cos(k_{2}x) \\frac{\\partial f_{0}}{\\partial v} + \\frac{e\\mathcal{E}_{2}}{m}\\cos(k_{2}x) \\frac{\\partial}{\\partial v}\\delta f_{1}(x,v,\\tau^{-}) $$\nThe first term is the equilibrium. The second and third terms are the first-order linear responses to each pulse. The fourth term is the second-order cross-term we are interested in, which can produce an echo:\n$$ \\delta f_{12}(x,v,\\tau^{+}) = \\frac{e\\mathcal{E}_{2}}{m}\\cos(k_{2}x) \\frac{\\partial}{\\partial v} \\left( \\frac{e\\mathcal{E}_{1}}{m} \\cos(k_{1}(x - v\\tau)) \\frac{\\partial f_{0}}{\\partial v} \\right) $$\n$$ \\delta f_{12}(x,v,\\tau^{+}) = \\left(\\frac{e}{m}\\right)^2 \\mathcal{E}_{1}\\mathcal{E}_{2} \\cos(k_{2}x) \\left[ k_{1}\\tau \\sin(k_{1}(x-v\\tau)) \\frac{\\partial f_{0}}{\\partial v} + \\cos(k_{1}(x-v\\tau)) \\frac{\\partial^{2} f_{0}}{\\partial v^{2}} \\right] $$\nTo analyze the phase structure (Task 1), we use trigonometric product-to-sum identities on the spatial terms:\n- $\\cos(k_{2}x) \\sin(k_{1}(x-v\\tau)) = \\frac{1}{2}\\left[ \\sin((k_{1}+k_{2})x - k_{1}v\\tau) + \\sin((k_{2}-k_{1})x + k_{1}v\\tau) \\right]$\n- $\\cos(k_{2}x) \\cos(k_{1}(x-v\\tau)) = \\frac{1}{2}\\left[ \\cos((k_{1}+k_{2})x - k_{1}v\\tau) + \\cos((k_{2}-k_{1})x + k_{1}v\\tau) \\right]$\n\nThe cross-term $\\delta f_{12}$ is a superposition of components with spatial wavenumbers $k_{1}+k_{2}$ and $k_{2}-k_{1}$. The phase dependence involves terms like $\\cos((k_{2}-k_{1})x + k_{1}v\\tau)$. This is the answer to Task 1.\n\n**3. Echo Formation (Task 2)**\n\nFor $t  \\tau$, the distribution evolves again by free streaming. Let $t' = t-\\tau  0$. A phase term of the form $\\Psi(x,v) = (kx + \\alpha v)$ at $t=\\tau^{+}$ becomes $\\Psi(x-vt', v) = k(x-vt') + \\alpha v = kx + (\\alpha - kt')v$ at time $t=\\tau+t'$.\nAn echo occurs if the velocity dependence of the phase cancels out, allowing particles of all velocities to contribute coherently to a macroscopic density perturbation.\n\nLet's examine the two wavenumber components:\n\n- **Component with wavenumber $k=k_{1}+k_{2}$**:\nThe phase at $t=\\tau^{+}$ is of the form $(k_{1}+k_{2})x - k_{1}v\\tau$.\nAt time $t=\\tau+t'$, the phase becomes $(k_{1}+k_{2})x - \\left[ (k_{1}+k_{2})t' + k_{1}\\tau \\right] v$.\nFor the phase to be independent of $v$, we require $(k_{1}+k_{2})t' + k_{1}\\tau = 0$. Since $k_{1}, k_{2}, \\tau, t'$ are all positive, this equation has no solution. This component does not produce an echo for $t\\tau$.\n\n- **Component with wavenumber $k=k_{2}-k_{1}$**:\nThe phase at $t=\\tau^{+}$ is of the form $(k_{2}-k_{1})x + k_{1}v\\tau$.\nAt time $t=\\tau+t'$, the phase becomes $(k_{2}-k_{1})x + \\left[ k_{1}\\tau - (k_{2}-k_{1})t' \\right] v$.\nFor the phase to be independent of $v$, the coefficient of $v$ must be zero:\n$$ k_{1}\\tau - (k_{2}-k_{1})t' = 0 $$\nSolving for $t' = t_{\\mathrm{echo}} - \\tau$:\n$$ t' = \\frac{k_{1}\\tau}{k_{2}-k_{1}} $$\nThe echo time $t_{\\mathrm{echo}}$ is therefore:\n$$ t_{\\mathrm{echo}} = \\tau + t' = \\tau + \\frac{k_{1}\\tau}{k_{2}-k_{1}} = \\tau \\left( \\frac{k_{2}-k_{1}+k_{1}}{k_{2}-k_{1}} \\right) = \\tau \\frac{k_{2}}{k_{2}-k_{1}} $$\nAt this time, a macroscopic density perturbation with wavenumber $k_{\\mathrm{echo}} = k_{2}-k_{1}$ re-emerges. For the echo to occur after the second pulse ($t_{\\mathrm{echo}}\\tau$), we must have $t'0$, which implies $k_{2}k_{1}$ (assuming positive $k_{1,2}$). This fulfills Task 2.\n\n**4. Physical Mechanism (Task 3)**\n\nThe physical mechanism for the plasma echo is a purely kinetic, collisionless phenomenon.\n1. The first pulse ($k_1$) creates a spatially periodic perturbation in the phase-space distribution function.\n2. Under free streaming, faster particles travel farther than slower ones, causing the initial macroscopic density perturbation to decay via phase mixing. The phase-space distribution develops fine-scale filaments, winding up like threads. The information of the initial perturbation is not lost but is stored in this fine-grained, velocity-dependent structure.\n3. The second pulse ($k_2$) provides a velocity modulation that acts on this already-filamented distribution. This modulation effectively \"re-labels\" the particles' velocities.\n4. The crucial step is the nonlinear interaction between the first perturbation's state at $t=\\tau$ and the second kick. This generates new spatial harmonics, notably at $k_{2}-k_{1}$.\n5. For the $k_{2}-k_{1}$ component, the combination of phase accrual before the second pulse and phase accrual after the second pulse can exactly cancel out at a specific later time, $t_{\\mathrm{echo}}$. This process is a \"phase un-mixing\" or rephasing.\n6. At $t_{\\mathrm{echo}}$, the phase-space filaments for the $k_{2}-k_{1}$ harmonic constructively interfere, momentarily reconstructing a macroscopic charge density perturbation (the echo), which in turn generates a macroscopic electric field. This process is reversible in the Vlasov limit; collisions would destroy the fine-grained phase information and prevent the echo. The effect is of second order $(\\mathcal{E}_1 \\mathcal{E}_2)$ as it requires both pulses to occur.\n\n### Option-by-Option Analysis\n\n- **A. An echo reappears at wave number $k_{\\mathrm{echo}}=k_{2}-k_{1}$ at time $t_{\\mathrm{echo}}=\\tau\\,k_{2}/(k_{2}-k_{1}) \\tau$. It arises because ballistic phase mixing from the first kick shears the perturbation into fine phase-space filaments whose velocity-dependent phases are modulated by the second kick; at $t_{\\mathrm{echo}}$ the velocity-dependent phase cancels for the $k_{2}-k_{1}$ component, reconstructing a macroscopic mode. The effect is second order in the pulse strengths and vanishes if either pulse is absent.**\n  - **Verdict**: Correct.\n  - **Justification**: This statement perfectly matches the results of our derivation for $k_{\\mathrm{echo}}$ and $t_{\\mathrm{echo}}$. The description of the physical mechanism involving phase mixing, filamentation, modulation by the second kick, and final rephasing is entirely accurate and corresponds to the standard understanding of plasma echoes. The assertion that the effect is second order is also correct.\n\n- **B. An echo reappears at wave number $k_{\\mathrm{echo}}=k_{1}+k_{2}$ at time $t_{\\mathrm{echo}}=\\tau\\,k_{2}/(k_{1}+k_{2})$, caused by direct nonlinear coupling in Poisson’s equation; it requires strong fields and disappears in the collisionless limit.**\n  - **Verdict**: Incorrect.\n  - **Justification**: The wave number and echo time are incorrect. Our derivation showed that the $k_1+k_2$ component does not rephase. The mechanism is also incorrect; the echo is a Vlasov kinetic effect, not a fluid-like nonlinearity from Poisson's equation, and it is a quintessentially collisionless phenomenon that is destroyed by collisions, not one that disappears in the collisionless limit. The echo is typically analyzed and observed in the weak field limit.\n\n- **C. An echo reappears at wave number $k_{\\mathrm{echo}}=k_{2}-k_{1}$ at time $t_{\\mathrm{echo}}=\\tau\\,(1+k_{1}/k_{2})$, due to Landau growth of an unstable mode seeded by the second pulse that overcomes earlier damping.**\n  - **Verdict**: Incorrect.\n  - **Justification**: While the wave number is correct, the formula for the echo time is wrong. $t_{\\mathrm{echo}}=\\tau\\,(1+k_{1}/k_{2}) = \\tau(k_2+k_1)/k_2 \\neq \\tau k_2/(k_2-k_1)$. The proposed mechanism is also incorrect. An echo is not an instability or Landau growth. It is the time-reversal and reconstruction of a phase-mixed perturbation, a process fundamentally different from the growth of an unstable wave-particle resonance.\n\n- **D. No echo can occur in strictly collisionless Vlasov dynamics; any re-emergent macroscopic mode necessarily requires collisions to reverse Landau damping.**\n  - **Verdict**: Incorrect.\n  - **Justification**: This statement is the antithesis of the correct physics. The echo is a hallmark of collisionless Vlasov dynamics, demonstrating the reversible nature of phase mixing (\"collisionless damping\") in the absence of dissipation. Collisions introduce irreversibility by destroying the fine-grained phase-space information required for the echo to form.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While analytical solutions to the Vlasov equation are invaluable, many real-world problems demand numerical approaches. This final hands-on practice  guides you through the implementation of a Vlasov solver using the method of characteristics, the most direct numerical translation of the equation's physical meaning. By tracking particle trajectories backward in time from a grid point to a boundary, you will compute the evolution of the distribution function in response to a time-varying inflow, gaining practical experience in one of the fundamental techniques of computational kinetic theory.",
            "id": "4233976",
            "problem": "Consider a one-dimensional, one-velocity electrostatic Vlasov problem for a single species with distribution function $f(x,v,t)$ that satisfies the collisionless Vlasov equation\n$$\n\\frac{\\partial f}{\\partial t} + v\\,\\frac{\\partial f}{\\partial x} + \\frac{q}{m} E(x,t)\\,\\frac{\\partial f}{\\partial v} = 0,\n$$\nwhere $x$ is position, $v$ is velocity, $t$ is time, $q$ is particle charge, $m$ is particle mass, and $E(x,t)$ is the electric field. Assume a constant acceleration $a$ defined by $a=\\frac{q}{m}E$, with $E$ uniform in space and time so that $a$ is constant. The computational domain is $x\\in[0,L]$, and the velocity domain is $v\\in[v_{\\min},v_{\\max}]$. The initial condition is $f(x,v,0)=0$ for all $x$ and $v$. Boundary conditions are:\n- Left inflow at $x=0$: $f(0,v,t)=f_{\\text{in}}(v,t)$ for $v0$.\n- Right boundary at $x=L$: outflow only, i.e., no inflow from $x=L$ so that characteristics entering from $x=L$ do not contribute.\n\nImplement a shock-like inflow boundary condition defined by a time-dependent piecewise Maxwellian at $x=0$,\n$$\nf_{\\text{in}}(v,t)=\n\\begin{cases}\nM(v;U_{\\text{up}},v_{\\text{th,up}}),  0\\le tt_s, \\\\\nM(v;U_{\\text{dn}},v_{\\text{th,dn}}),  t\\ge t_s,\n\\end{cases}\n$$\nwhere\n$$\nM(v;U,v_{\\text{th}})=\\frac{n_0}{\\sqrt{2\\pi}\\,v_{\\text{th}}}\\exp\\!\\left(-\\frac{(v-U)^2}{2 v_{\\text{th}}^2}\\right),\n$$\nwith $n_0$ a constant density scale. For this problem, all quantities are to be treated as dimensionless via normalization to suitable reference scales, so the program must compute and output dimensionless ratios. Specifically, you must use $n_0=1$ so that the Maxwellian is normalized to a unit density scale, and normalize mean velocities by the upstream bulk velocity $U_{\\text{up}}$.\n\nAnalyze the phase-space evolution using characteristics. For constant $a$, the characteristic equations are\n$$\n\\frac{dx}{dt} = v,\\quad \\frac{dv}{dt} = a,\n$$\nwith solutions\n$$\nv(t) = v_0 + a\\,t,\\quad x(t) = x_0 + v_0\\,t + \\frac{1}{2}a\\,t^2.\n$$\nYour algorithm should determine, for the phase point $(x,v,t)$, whether the backward characteristic intersects the inflow boundary at $x=0$ at some time $s\\in[0,t]$, and if so, evaluate $f(x,v,t)$ using the boundary value $f_{\\text{in}}(v_b,s)$, where $v_b$ is the velocity on the characteristic at the boundary-crossing time $s$. If the characteristic does not intersect $x=0$ within $[0,t]$, or if the velocity at the boundary-crossing time does not satisfy the inflow condition $v_b0$, then that phase point contributes zero due to the initial condition and outflow boundary. For constant $a$, the backward-in-time crossing condition at a target position $x$ and time $t$ reduces to finding $\\Delta=t-s$ that solves\n$$\n0 = x - v\\,\\Delta + \\frac{1}{2}a\\,\\Delta^2,\n$$\nwith $\\Delta\\in(0,t]$. For $a=0$, the solution is $\\Delta=x/v$ with the constraint $v0$ and $\\Delta\\in(0,t]$. For $a\\ne 0$, the quadratic admits up to two roots\n$$\n\\Delta = \\frac{v \\pm \\sqrt{v^2 - 2 a x}}{a},\n$$\nand the algorithm must select the smallest positive root within $(0,t]$.\n\nYour program must compute, for each test case specified below, three dimensionless quantities at the spatial midpoint $x=L/2$ and final time $t=t_f$:\n- The dimensionless number density $n(x=L/2,t=t_f)$ normalized by $n_0$:\n$$\nn = \\int_{v_{\\min}}^{v_{\\max}} f\\left(\\frac{L}{2},v,t_f\\right)\\,dv.\n$$\n- The dimensionless mean velocity $u(x=L/2,t=t_f)$ normalized by $U_{\\text{up}}$:\n$$\nu = \\frac{1}{n}\\int_{v_{\\min}}^{v_{\\max}} v\\,f\\left(\\frac{L}{2},v,t_f\\right)\\,dv,\\quad \\text{then report } \\frac{u}{U_{\\text{up}}}.\n$$\n- The fraction of the density at $x=L/2$ and $t=t_f$ that originates from the upstream inflow component ($0\\le st_s$):\n$$\n\\phi = \\frac{\\int_{v_{\\min}}^{v_{\\max}} f_{\\text{up}}\\left(\\frac{L}{2},v,t_f\\right)\\,dv}{\\int_{v_{\\min}}^{v_{\\max}} f\\left(\\frac{L}{2},v,t_f\\right)\\,dv},\n$$\nwhere $f_{\\text{up}}$ includes only those contributions with $st_s$.\n\nDiscretize the velocity integral over $[v_{\\min},v_{\\max}]$ using a uniform grid with $N_v$ points and approximate the integrals by sums. The program should not rely on any self-consistent field computation; use the prescribed constant $a$ and the characteristic method to sample the boundary inflow at $x=0$.\n\nTest Suite:\nProvide results for the following four test cases, each specified by $(L,a,t_f,U_{\\text{up}},v_{\\text{th,up}},U_{\\text{dn}},v_{\\text{th,dn}},t_s,v_{\\min},v_{\\max},N_v)$:\n- Case $1$: $(L=1.0,\\ a=0.0,\\ t_f=0.5,\\ U_{\\text{up}}=1.0,\\ v_{\\text{th,up}}=0.1,\\ U_{\\text{dn}}=0.3,\\ v_{\\text{th,dn}}=0.3,\\ t_s=0.3,\\ v_{\\min}=-2.0,\\ v_{\\max}=3.0,\\ N_v=800)$.\n- Case $2$: $(L=1.0,\\ a=0.2,\\ t_f=0.5,\\ U_{\\text{up}}=1.0,\\ v_{\\text{th,up}}=0.1,\\ U_{\\text{dn}}=0.6,\\ v_{\\text{th,dn}}=0.25,\\ t_s=0.25,\\ v_{\\min}=-2.0,\\ v_{\\max}=3.0,\\ N_v=800)$.\n- Case $3$: $(L=1.0,\\ a=0.0,\\ t_f=0.05,\\ U_{\\text{up}}=1.5,\\ v_{\\text{th,up}}=0.05,\\ U_{\\text{dn}}=0.5,\\ v_{\\text{th,dn}}=0.2,\\ t_s=0.03,\\ v_{\\min}=-2.0,\\ v_{\\max}=3.0,\\ N_v=800)$.\n- Case $4$: $(L=1.0,\\ a=-0.5,\\ t_f=0.5,\\ U_{\\text{up}}=1.0,\\ v_{\\text{th,up}}=0.1,\\ U_{\\text{dn}}=0.4,\\ v_{\\text{th,dn}}=0.3,\\ t_s=0.2,\\ v_{\\min}=-2.0,\\ v_{\\max}=3.0,\\ N_v=800)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[n_1,u_1,\\phi_1,n_2,u_2,\\phi_2,n_3,u_3,\\phi_3,n_4,u_4,\\phi_4]$, where the subscript $k$ corresponds to Case $k$. All reported quantities must be dimensionless as defined above. No units should be included in the output. The program must be self-contained and require no user input.",
            "solution": "The problem presented is a well-posed initial-boundary value problem for the one-dimensional collisionless Vlasov equation under a constant, externally-imposed acceleration. The problem is scientifically grounded, mathematically consistent, and all parameters and conditions required for a unique solution are provided. Therefore, the problem is valid and we may proceed with its solution.\n\nThe Vlasov equation describes the evolution of the distribution function $f(x,v,t)$ in phase space:\n$$\n\\frac{\\partial f}{\\partial t} + v\\,\\frac{\\partial f}{\\partial x} + a\\,\\frac{\\partial f}{\\partial v} = 0\n$$\nwhere $a = \\frac{qE}{m}$ is the constant acceleration. The method of characteristics is employed to solve this equation. This method relies on the principle that the distribution function $f$ is constant along the trajectories of particles in phase space. These trajectories, so-called characteristics, are governed by the ordinary differential equations:\n$$\n\\frac{dx}{dt} = v, \\quad \\frac{dv}{dt} = a\n$$\nFor a constant acceleration $a$, these equations are integrated to find the position $x(t)$ and velocity $v(t)$ of a particle that was at $(x_0, v_0)$ at time $t_0$:\n$$\nv(t) = v_0 + a(t-t_0), \\quad x(t) = x_0 + v_0(t-t_0) + \\frac{1}{2}a(t-t_0)^2\n$$\nTo find the value of $f(x,v,t)$ at a target phase-space point $(x,v,t)$, we trace its characteristic backward in time. The value of $f$ at $(x,v,t)$ is equal to its value at the origin of the characteristic. The origin can be either in the initial domain at $t'=0$ or on a spatial boundary at some time $s \\in [0,t)$.\n\nThe problem specifies a zero initial condition, $f(x,v,0)=0$, and an outflow-only condition at $x=L$. Therefore, any non-zero value of $f(x,v,t)$ must originate from the inflow boundary at $x=0$. Our task is to determine, for a given point $(x,v,t)$, if its characteristic intersects the boundary $x=0$ at some time $s \\in [0,t)$ with an inflow velocity $v_b  0$. If it does, then $f(x,v,t) = f(0,v_b,s) = f_{\\text{in}}(v_b,s)$. Otherwise, $f(x,v,t)=0$.\n\nLet the target point be $(x_t, v_t, t_f)$, where for this problem $x_t = L/2$. Let the boundary-crossing point be $(0, v_b, s)$. The time-of-flight is $\\Delta = t_f-s$. The characteristic equations relating these points are:\n$$\nv_t = v_b + a\\Delta, \\quad x_t = v_b \\Delta + \\frac{1}{2}a\\Delta^2\n$$\nWe can solve this system for $\\Delta$ and $v_b$. Substituting $v_b = v_t - a\\Delta$ from the first equation into the second gives a quadratic equation for $\\Delta$:\n$$\nx_t = (v_t - a\\Delta)\\Delta + \\frac{1}{2}a\\Delta^2 \\implies \\frac{1}{2}a\\Delta^2 - v_t\\Delta + x_t = 0\n$$\nThe solution depends on whether $a=0$ or $a\\neq 0$.\n\nCase 1: $a=0$\nThe equation simplifies to $-v_t\\Delta + x_t = 0$, yielding $\\Delta = x_t/v_t$. For a valid physical trajectory from the inflow boundary, we require:\n1. $v_t  0$: The particle must be moving from $x=0$ towards $x=x_t$.\n2. $0  \\Delta \\le t_f$: The particle must have left the boundary after $t=0$ and arrived at or before $t=t_f$.\nThe boundary velocity is $v_b = v_t$, which is positive as required.\n\nCase 2: $a\\neq0$\nThe quadratic equation for $\\Delta$ has solutions\n$$ \\Delta = \\frac{v_t \\pm \\sqrt{v_t^2 - 2ax_t}}{a} $$\nInstead of testing both roots, we can use a more physical approach. From the characteristic equations, we can derive the energy-like relation $v_t^2 - v_b^2 = 2ax_t$. Since we require an inflow velocity $v_b  0$, we must have $v_b^2 = v_t^2 - 2ax_t  0$. This gives the boundary velocity as $v_b = \\sqrt{v_t^2 - 2ax_t}$. The discriminant $D = v_t^2 - 2ax_t$ must be positive. Once $v_b$ is found, $\\Delta$ is uniquely determined from $v_t = v_b + a\\Delta$ as $\\Delta = (v_t - v_b)/a$.\n\nThe complete set of conditions for a non-zero contribution when $a\\neq0$ is:\n1. $D = v_t^2 - 2ax_t  0$: A real, positive-velocity solution at the boundary must exist.\n2. Calculate $v_b = \\sqrt{D}$ and $\\Delta = (v_t - v_b)/a$.\n3. $0  \\Delta \\le t_f$: The transit time must be physically meaningful.\n\nIf these conditions are met, the boundary crossing time is $s=t_f-\\Delta$. The value of the distribution function is then determined by the piecewise inflow boundary condition:\n$$\nf_{\\text{in}}(v_b,s)=\n\\begin{cases}\nM(v_b;U_{\\text{up}},v_{\\text{th,up}}),  0\\le st_s, \\\\\nM(v_b;U_{\\text{dn}},v_{\\text{th,dn}}),  s\\ge t_s,\n\\end{cases}\n$$\nwhere $M(v;U,v_{\\text{th}})=\\frac{n_0}{\\sqrt{2\\pi}\\,v_{\\text{th}}}\\exp\\!\\left(-\\frac{(v-U)^2}{2 v_{\\text{th}}^2}\\right)$ with $n_0=1$.\n\nThe final step is to compute the required physical quantities by numerically integrating over the velocity grid $v \\in [v_{\\min}, v_{\\max}]$ with $N_v$ points and spacing $\\Delta v$. The integrals are approximated by sums:\n- Number density (with $n_0=1$ normalization): $n = \\int f dv \\approx \\sum_i f(x_t, v_i, t_f) \\Delta v$.\n- Mean velocity: $u = \\frac{1}{n} \\int vf dv \\approx \\frac{1}{n} \\sum_i v_i f(x_t, v_i, t_f) \\Delta v$. We report $u/U_{\\text{up}}$.\n- Upstream density fraction: $\\phi = \\frac{\\int f_{\\text{up}} dv}{\\int f dv} \\approx \\frac{\\sum_{i \\in \\text{upstream}} f(x_t, v_i, t_f)}{\\sum_i f(x_t, v_i, t_f)}$, where the upstream sum is over contributions with $s  t_s$.\n\nThe algorithm is implemented for each test case by discretizing the velocity domain, applying the characteristic-based logic for each grid point $(x_t, v_i, t_f)$ to calculate $f(x_t, v_i, t_f)$, and then performing the summations to find $n$, $u/U_{\\text{up}}$, and $\\phi$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print the results.\n    \"\"\"\n    # Test Suite:\n    # (L, a, t_f, U_up, v_th_up, U_dn, v_th_dn, t_s, v_min, v_max, N_v)\n    test_cases = [\n        (1.0, 0.0, 0.5, 1.0, 0.1, 0.3, 0.3, 0.3, -2.0, 3.0, 800),\n        (1.0, 0.2, 0.5, 1.0, 0.1, 0.6, 0.25, 0.25, -2.0, 3.0, 800),\n        (1.0, 0.0, 0.05, 1.5, 0.05, 0.5, 0.2, 0.03, -2.0, 3.0, 800),\n        (1.0, -0.5, 0.5, 1.0, 0.1, 0.4, 0.3, 0.2, -2.0, 3.0, 800)\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = compute_for_case(*case)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    # Format to a reasonable number of decimal places for consistency.\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef maxwellian(v, U, v_th):\n    \"\"\"\n    Computes the Maxwellian distribution M(v; U, v_th) with n0=1.\n    \"\"\"\n    if v_th = 0:\n        return 0.0\n    norm = 1.0 / (np.sqrt(2.0 * np.pi) * v_th)\n    exponent = -((v - U)**2) / (2.0 * v_th**2)\n    return norm * np.exp(exponent)\n\ndef compute_for_case(L, a, t_f, U_up, v_th_up, U_dn, v_th_dn, t_s, v_min, v_max, N_v):\n    \"\"\"\n    Computes the density, mean velocity, and upstream fraction for a single test case.\n    \"\"\"\n    x = L / 2.0\n    v_grid, dv = np.linspace(v_min, v_max, N_v, retstep=True)\n\n    f_vals = np.zeros(N_v)\n    is_upstream = np.zeros(N_v, dtype=bool)\n\n    for i, v_t in enumerate(v_grid):\n        delta = -1.0\n        v_b = -1.0\n\n        if a == 0.0:\n            if v_t  0:\n                delta_candidate = x / v_t\n                if 0  delta_candidate = t_f:\n                    delta = delta_candidate\n                    v_b = v_t\n        else: # a != 0\n            discriminant = v_t**2 - 2 * a * x\n            if discriminant  0:\n                v_b_candidate = np.sqrt(discriminant)\n                # This formulation for delta is robust for a != 0\n                delta_candidate = (v_t - v_b_candidate) / a\n                if 0  delta_candidate = t_f:\n                    delta = delta_candidate\n                    v_b = v_b_candidate\n        \n        if delta  0: # A valid characteristic was found\n            s = t_f - delta\n            if s  t_s:\n                f_vals[i] = maxwellian(v_b, U_up, v_th_up)\n                is_upstream[i] = True\n            else: # s = t_s\n                f_vals[i] = maxwellian(v_b, U_dn, v_th_dn)\n\n    # Perform numerical integration\n    n_sum = np.sum(f_vals)\n    n = n_sum * dv\n    \n    if n  1e-15: # Effectively zero density\n        return 0.0, 0.0, 0.0\n\n    # Calculate mean velocity\n    n_u_moment = np.sum(v_grid * f_vals) * dv\n    u = n_u_moment / n\n    u_norm = u / U_up\n    \n    # Calculate upstream fraction\n    n_up_sum = np.sum(f_vals[is_upstream])\n    # phi is a ratio of integrals, dv cancels.\n    phi = n_up_sum / n_sum if n_sum > 0 else 0.0\n    \n    return n, u_norm, phi\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}