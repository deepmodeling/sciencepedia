{
    "hands_on_practices": [
        {
            "introduction": "在深入研究碰撞算符本身的复杂性之前，我们必须确认我们对一个基础分布函数的理解，即麦克斯韦分布，它是碰撞过程驱动等离子体达到的热力学平衡态。这项练习旨在验证麦克斯韦分布的归一化属性，通过在整个速度空间中对其进行积分，确保我们能准确地得到总数密度这一基本物理量。这项基础性的计算练习有助于巩固分布函数的数学形式与宏观物理量之间的联系。",
            "id": "4229584",
            "problem": "在空间均匀、各向同性、无漂移的单组分天体物理等离子体中，在数密度和能量固定的约束下，使熵极值化的稳态速度分布是麦克斯韦函数。对于质量为 $m$、标量温度为 $T$、数密度为 $n$ 的组分，考虑各向同性的麦克斯韦速度分布\n$$\nf_{M}(\\boldsymbol{v}) \\;=\\; n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right),\n$$\n其中 $v \\equiv |\\boldsymbol{v}|$。在动理学理论中，数密度的基本定义是\n$$\nn \\;=\\; \\int_{\\mathbb{R}^{3}} f(\\boldsymbol{v})\\,\\mathrm{d}^{3}v.\n$$\n陈述表达双体碰撞中粒子数守恒的归一化条件，此条件适用于玻尔兹曼碰撞算符和福克-普朗克碰撞算符。然后，从上述定义出发，显式地计算速度空间积分\n$$\nI \\;\\equiv\\; \\int_{\\mathbb{R}^{3}} f_{M}(\\boldsymbol{v})\\,\\mathrm{d}^{3}v\n$$\n对于给定的 $f_{M}(\\boldsymbol{v})$。请用 $n$, $m$, 和 $T$ 的封闭形式解析表达式来表示你对 $I$ 的最终答案。如果报告数值，则四舍五入到四位有效数字，并使用与 $n$ (数密度) 相同的单位表示，但更推荐使用符号表达式。",
            "solution": "所陈述的问题具有科学依据，提法恰当且客观。它提出了动理学理论中的一个标准练习：陈述碰撞算符的一个基本守恒定律，并验证麦克斯韦-玻尔兹曼分布的归一化。所有术语都是标准的且定义明确，其前提与统计力学和等离子体物理学的原理一致。所需的计算是一个标准的高斯积分。因此，该问题是有效的。\n\n该问题要求两个不同的项目：首先，是碰撞算符的归一化条件；其次，是计算一个特定的速度空间积分。\n\n第1部分：碰撞算符的归一化条件\n\n在动理学理论中，速度分布函数 $f(\\boldsymbol{r}, \\boldsymbol{v}, t)$ 的演化由动理学方程描述。对于空间均匀、无漂移且无外力的等离子体，该方程简化为\n$$\n\\frac{\\partial f(\\boldsymbol{v}, t)}{\\partial t} \\;=\\; C[f]\n$$\n其中 $C[f]$ 是碰撞算符，可以是玻尔兹曼算符、福克-普朗克算符或其他相关形式。\n\n数密度 $n$ 定义为分布函数在速度空间上的零阶矩：\n$$\nn \\;=\\; \\int_{\\mathbb{R}^{3}} f(\\boldsymbol{v}, t)\\,\\mathrm{d}^{3}v\n$$\n所考虑组分的总粒子数守恒意味着总数密度必须随时间保持恒定，即 $\\frac{\\mathrm{d}n}{\\mathrm{d}t} = 0$。对 $n$ 的定义取时间导数，并假设我们可以交换微分和积分的顺序，我们得到：\n$$\n\\frac{\\mathrm{d}n}{\\mathrm{d}t} \\;=\\; \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\mathbb{R}^{3}} f(\\boldsymbol{v}, t)\\,\\mathrm{d}^{3}v \\;=\\; \\int_{\\mathbb{R}^{3}} \\frac{\\partial f(\\boldsymbol{v}, t)}{\\partial t} \\,\\mathrm{d}^{3}v\n$$\n代入简化的动理学方程，我们得到：\n$$\n\\frac{\\mathrm{d}n}{\\mathrm{d}t} \\;=\\; \\int_{\\mathbb{R}^{3}} C[f] \\,\\mathrm{d}^{3}v\n$$\n因此，双体碰撞中粒子数守恒的条件是，碰撞算符在整个速度空间上的积分必须为零。这就是表达粒子数守恒的归一化条件。\n$$\n\\int_{\\mathbb{R}^{3}} C[f] \\,\\mathrm{d}^{3}v \\;=\\; 0\n$$\n这个条件对玻尔兹曼碰撞算符和福克-普朗克碰撞算符都成立。它们被精确地构造出来以守恒粒子数（以及动量和能量）。对于福克-普朗克算符，它可以写成速度空间中散度的形式，$C_{FP}[f] = -\\boldsymbol{\\nabla}_{\\boldsymbol{v}} \\cdot \\boldsymbol{J}_{\\boldsymbol{v}}$，其中 $\\boldsymbol{J}_{\\boldsymbol{v}}$ 是速度空间通量，只要通量 $\\boldsymbol{J}_{\\boldsymbol{v}}$（它依赖于 $f$ 及其导数）在 $|\\boldsymbol{v}| \\to \\infty$ 时足够快地趋于零，这个积分通过应用散度定理就会消失。\n\n第2部分：积分的计算\n\n任务的第二部分是显式地计算积分 $I$：\n$$\nI \\;\\equiv\\; \\int_{\\mathbb{R}^{3}} f_{M}(\\boldsymbol{v})\\,\\mathrm{d}^{3}v\n$$\n其中麦克斯韦分布函数 $f_{M}(\\boldsymbol{v})$ 给出如下：\n$$\nf_{M}(\\boldsymbol{v}) \\;=\\; n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right)\n$$\n在这里，温度 $T$ 的单位是能量，所以玻尔兹曼常数 $k_B$ 被隐式地包含在内。\n\n我们将 $f_{M}(\\boldsymbol{v})$ 的表达式代入 $I$ 的积分中：\n$$\nI \\;=\\; \\int_{\\mathbb{R}^{3}} n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right)\\,\\mathrm{d}^{3}v\n$$\n不依赖于积分变量 $\\boldsymbol{v}$ 的项可以从积分中提出：\n$$\nI \\;=\\; n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\int_{\\mathbb{R}^{3}} \\exp\\!\\left(-\\frac{m v^{2}}{2T}\\right)\\,\\mathrm{d}^{3}v\n$$\n让我们定义常数 $\\alpha \\equiv \\frac{m}{2T}$。积分变为：\n$$\nI \\;=\\; n \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\int_{\\mathbb{R}^{3}} \\exp(-\\alpha v^{2})\\,\\mathrm{d}^{3}v\n$$\n积分部分可以在笛卡尔坐标系中计算。我们写出 $\\mathrm{d}^{3}v = \\mathrm{d}v_x \\mathrm{d}v_y \\mathrm{d}v_z$ 和 $v^2 = v_x^2 + v_y^2 + v_z^2$。在 $\\mathbb{R}^3$ 上的积分可以分离为三个相同的一维高斯积分：\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-\\alpha v^{2})\\,\\mathrm{d}^{3}v \\;=\\; \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\exp(-\\alpha (v_x^2 + v_y^2 + v_z^2)) \\,\\mathrm{d}v_x \\mathrm{d}v_y \\mathrm{d}v_z\n$$\n$$\n\\;=\\; \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_x^2) \\,\\mathrm{d}v_x\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_y^2) \\,\\mathrm{d}v_y\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_z^2) \\,\\mathrm{d}v_z\\right)\n$$\n定积分 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\,\\mathrm{d}x$ 的值是一个标准结果，由 $\\sqrt{\\frac{\\pi}{a}}$ 给出。在我们的例子中，常数是 $\\alpha$，所以三个积分中的每一个都等于 $\\sqrt{\\frac{\\pi}{\\alpha}}$。\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-\\alpha v_i^2) \\,\\mathrm{d}v_i \\;=\\; \\sqrt{\\frac{\\pi}{\\alpha}} \\quad \\text{对于 } i = x, y, z\n$$\n因此，三维积分是这三个结果的乘积：\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-\\alpha v^{2})\\,\\mathrm{d}^{3}v \\;=\\; \\left(\\sqrt{\\frac{\\pi}{\\alpha}}\\right)^3 \\;=\\; \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}\n$$\n现在，我们将这个结果代回 $I$ 的表达式中：\n$$\nI \\;=\\; n \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}\n$$\n括号中的两项互为倒数，所以它们的乘积是 $1$：\n$$\nI \\;=\\; n \\cdot 1 \\;=\\; n\n$$\n这个计算证实了麦克斯韦分布 $f_M(\\boldsymbol{v})$ 在整个速度空间上的积分确实是数密度 $n$，这与问题陈述中提供的 $n$ 的初始定义是一致的。$f_M(\\boldsymbol{v})$ 定义中的常数前因子正是满足此条件所需的归一化常数。最终答案要求以封闭形式的解析表达式给出。",
            "answer": "$$\\boxed{n}$$"
        },
        {
            "introduction": "用于库仑碰撞的福克-普朗克算符的一个关键特征是库仑对数 $\\ln\\Lambda$ 的出现，它概括了在极大范围的碰撞参数内发生的小角度散射的物理过程。本练习提供了一个实际应用，引导您计算一个典型天体物理等离子体的 $\\ln\\Lambda$。通过这个过程，您将学习如何运用物理论证来设定使碰撞积分正则化的截断值，并体会到该理论因这一项的对数性质而具有的鲁棒性。",
            "id": "4229568",
            "problem": "在弱耦合、完全电离的非相对论性天体物理等离子体中，作为 Fokker-Planck 描述基础的小角度库仑碰撞会产生一个称为库仑对数的对数因子。在动力学理论的处理中，对碰撞参数的发散积分进行正则化后，会出现最大有效碰撞参数与最小有效碰撞参数之比的自然对数。最大碰撞参数由静电屏蔽决定，取为电子德拜长度 $\\,\\lambda_{D}\\,$；最小碰撞参数由经典90度偏转最近距离 $\\,b_{90}\\,$ 和电子热德布罗意波长 $\\,\\lambda_{\\mathrm{dB}}\\,$ 中的较大者决定。考虑一个类氢等离子体中的电子-电子碰撞，其电子数密度为 $\\,n = 10^{6}\\,\\mathrm{m}^{-3}\\,$，电子温度为 $\\,T = 10^{6}\\,\\mathrm{K}\\,$。\n\n从以下基本定义出发：\n- 电子德拜长度 $\\,\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n e^{2}}}\\,$。\n- 电子热速度 $\\,v_{\\mathrm{th}} = \\sqrt{\\frac{2 k_{B} T}{m_{e}}}\\,$。\n- 经典90度碰撞参数 $\\,b_{90} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} m_{e} v_{\\mathrm{th}}^{2}}\\,$。\n- 电子热德布罗意波长 $\\,\\lambda_{\\mathrm{dB}} = \\frac{\\hbar}{m_{e} v_{\\mathrm{th}}}\\,$。\n\n使用具有物理动机的截断值 $\\,b_{\\min} = \\max\\!\\left(b_{90}, \\lambda_{\\mathrm{dB}}\\right)\\,$ 和 $\\,b_{\\max} = \\lambda_{D}\\,$ 来计算库仑对数 $\\,\\ln\\Lambda = \\ln\\!\\left(\\frac{b_{\\max}}{b_{\\min}}\\right)\\,$。将最终结果表示为一个无量纲数，并四舍五入到四位有效数字。此外，在你的推理过程中，评估 $\\,b_{90}\\,$ 和 $\\,\\lambda_{\\mathrm{dB}}\\,$ 中哪一个决定了 $\\,b_{\\min}\\,$，并定性解释 $\\,\\ln\\Lambda\\,$ 对任一截断值的适度变化的敏感程度。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n问题陈述中提供了以下信息：\n- 等离子体条件：弱耦合、完全电离的非相对论性天体物理等离子体（类氢）。\n- 电子数密度：$n = 10^{6}\\,\\mathrm{m}^{-3}$\n- 电子温度：$T = 10^{6}\\,\\mathrm{K}$\n- 电子德拜长度定义：$\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n e^{2}}}$\n- 电子热速度定义：$v_{\\mathrm{th}} = \\sqrt{\\frac{2 k_{B} T}{m_{e}}}$\n- 经典90度碰撞参数定义：$b_{90} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} m_{e} v_{\\mathrm{th}}^{2}}$\n- 电子热德布罗意波长定义：$\\lambda_{\\mathrm{dB}} = \\frac{\\hbar}{m_{e} v_{\\mathrm{th}}}$\n- 最大碰撞参数（截断值）：$b_{\\max} = \\lambda_{D}$\n- 最小碰撞参数（截断值）：$b_{\\min} = \\max\\!\\left(b_{90}, \\lambda_{\\mathrm{dB}}\\right)$\n- 库仑对数定义：$\\ln\\Lambda = \\ln\\!\\left(\\frac{b_{\\max}}{b_{\\min}}\\right)$\n\n**步骤2：使用提取的已知条件进行验证**\n根据以下验证标准对问题进行评估：\n1.  **科学依据：** 该问题描述了库仑对数的计算，这是等离子体动力学理论中的一个基本概念。给出的 $\\lambda_D$、$v_{\\mathrm{th}}$、$b_{90}$ 和 $\\lambda_{\\mathrm{dB}}$ 的定义是标准且正确的。截断值 $b_{\\max}$ 和 $b_{\\min}$ 的物理动机是碰撞理论中用于正则化发散积分的既定程序。\n2.  **适定性：** 所有必要的物理常数都是已知的，所有必需的参数（$n$, $T$）和函数形式都已明确给出。任务定义清晰，可以得出一个唯一的数值答案。\n3.  **客观性：** 问题以明确的、定量的语言表述，没有主观断言。\n4.  **一致性与可行性：** 给定的参数 $n = 10^{6}\\,\\mathrm{m}^{-3}$ 和 $T = 10^{6}\\,\\mathrm{K}$ 对于像日冕或温热星系际介质这样的天体物理环境是合理的。“非相对论性”条件必须检查。电子热速度为 $v_{\\mathrm{th}} = \\sqrt{2 k_B T / m_e} \\approx \\sqrt{2 (1.38 \\times 10^{-23} \\text{ J/K}) (10^6 \\text{ K}) / (9.11 \\times 10^{-31} \\text{ kg})} \\approx 5.5 \\times 10^6 \\text{ m/s}$。这大约是光速 $c$ 的 $1.8\\%$，因此非相对论性处理是合理的。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。它在科学上是合理的、适定的且内部一致的。将提供解答。\n\n任务是针对给定的等离子体参数计算库仑对数 $\\ln\\Lambda = \\ln(b_{\\max}/b_{\\min})$。这需要计算截断值 $b_{\\max} = \\lambda_D$ 和 $b_{\\min} = \\max(b_{90}, \\lambda_{\\mathrm{dB}})$ 的值。我们将使用以下基本常数值：\n- 真空介电常数，$\\epsilon_{0} \\approx 8.854 \\times 10^{-12}\\,\\mathrm{F \\cdot m^{-1}}$\n- 玻尔兹曼常数，$k_{B} \\approx 1.381 \\times 10^{-23}\\,\\mathrm{J \\cdot K^{-1}}$\n- 基本电荷，$e \\approx 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n- 电子质量，$m_{e} \\approx 9.109 \\times 10^{-31}\\,\\mathrm{kg}$\n- 约化普朗克常数，$\\hbar \\approx 1.055 \\times 10^{-34}\\,\\mathrm{J \\cdot s}$\n\n首先，我们计算电子热速度 $v_{\\mathrm{th}}$：\n$$v_{\\mathrm{th}} = \\sqrt{\\frac{2 k_{B} T}{m_{e}}} = \\sqrt{\\frac{2 (1.381 \\times 10^{-23}) (10^{6})}{9.109 \\times 10^{-31}}} \\approx 5.506 \\times 10^{6} \\, \\mathrm{m \\cdot s^{-1}}$$\n现在，我们可以计算这些长度尺度。\n\n最大碰撞参数 $b_{\\max}$ 是电子德拜长度 $\\lambda_D$：\n$$\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n e^{2}}} = \\sqrt{\\frac{(8.854 \\times 10^{-12}) (1.381 \\times 10^{-23}) (10^{6})}{(10^{6}) (1.602 \\times 10^{-19})^{2}}} \\approx \\sqrt{\\frac{1.222 \\times 10^{-28}}{2.566 \\times 10^{-32}}} \\approx \\sqrt{4762} \\approx 69.01 \\, \\mathrm{m}$$\n所以，$b_{\\max} \\approx 69.01 \\, \\mathrm{m}$。\n\n接下来，我们计算最小碰撞参数 $b_{\\min}$ 的两个可能尺度。\n经典90度碰撞参数 $b_{90}$ 可以通过代入 $m_{e} v_{\\mathrm{th}}^2 = 2 k_B T$ 来简化：\n$$b_{90} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} m_{e} v_{\\mathrm{th}}^{2}} = \\frac{e^{2}}{4 \\pi \\epsilon_{0} (2 k_{B} T)} = \\frac{e^2}{8 \\pi \\epsilon_0 k_B T}$$\n$$b_{90} = \\frac{(1.602 \\times 10^{-19})^2}{8 \\pi (8.854 \\times 10^{-12}) (1.381 \\times 10^{-23}) (10^6)} \\approx \\frac{2.566 \\times 10^{-38}}{3.072 \\times 10^{-27}} \\approx 8.356 \\times 10^{-12} \\, \\mathrm{m}$$\n\n电子热德布罗意波长 $\\lambda_{\\mathrm{dB}}$：\n$$\\lambda_{\\mathrm{dB}} = \\frac{\\hbar}{m_{e} v_{\\mathrm{th}}} = \\frac{1.055 \\times 10^{-34}}{(9.109 \\times 10^{-31}) (5.506 \\times 10^{6})} \\approx \\frac{1.055 \\times 10^{-34}}{5.015 \\times 10^{-24}} \\approx 2.104 \\times 10^{-11} \\, \\mathrm{m}$$\n\n现在我们通过比较 $b_{90}$ 和 $\\lambda_{\\mathrm{dB}}$ 来确定 $b_{\\min}$：\n$b_{90} \\approx 8.356 \\times 10^{-12}\\,\\mathrm{m}$\n$\\lambda_{\\mathrm{dB}} \\approx 2.104 \\times 10^{-11}\\,\\mathrm{m}$\n由于 $2.104 \\times 10^{-11} > 8.356 \\times 10^{-12}$，我们有 $\\lambda_{\\mathrm{dB}} > b_{90}$。\n因此，最小碰撞参数由量子力学尺度决定：\n$$b_{\\min} = \\max(b_{90}, \\lambda_{\\mathrm{dB}}) = \\lambda_{\\mathrm{dB}} \\approx 2.104 \\times 10^{-11} \\, \\mathrm{m}$$\n这表明，对于典型热能下的碰撞，量子衍射效应比经典大角度散射图像更重要。这是热、稀薄等离子体的特征。经典和量子区域之间的转变发生在温度 $T_c$ 处，此时 $b_{90} \\approx \\lambda_{\\mathrm{dB}}$，计算得出 $T_c = m_e c^2 \\alpha^2 / (2 k_B) \\approx 1.57 \\times 10^5\\,\\mathrm{K}$，其中 $\\alpha$ 是精细结构常数。由于给定温度 $T = 10^6\\,\\mathrm{K}$ 大于 $T_c$，我们的发现与理论是一致的。\n\n我们现在可以计算对数的宗量 $\\Lambda$：\n$$\\Lambda = \\frac{b_{\\max}}{b_{\\min}} = \\frac{\\lambda_{D}}{\\lambda_{\\mathrm{dB}}} \\approx \\frac{69.01}{2.104 \\times 10^{-11}} \\approx 3.280 \\times 10^{12}$$\n最后，我们计算库仑对数 $\\ln\\Lambda$：\n$$\\ln\\Lambda = \\ln(3.280 \\times 10^{12}) \\approx 28.82$$\n四舍五入到四位有效数字，得到值 $28.82$。\n\n关于 $\\ln\\Lambda$ 对截断值的定性敏感性：对数函数的使用是关键。令 $\\ln\\Lambda = f(\\Lambda) = \\ln(b_{\\max}/b_{\\min})$。任一截断值变化一个因子 $k$ 将使 $\\Lambda$ 变化一个因子 $k$ 或 $1/k$。对数的新值将是 $\\ln(k\\Lambda) = \\ln(k) + \\ln(\\Lambda)$ 或 $\\ln(\\Lambda/k) = \\ln(\\Lambda) - \\ln(k)$。对于典型的等离子体，$\\Lambda$ 是一个非常大的数，因此 $\\ln\\Lambda$ 是一个中等大小的数（通常在10到30之间）。$\\Lambda$ 的一个数量级（因子 $k=10$）的变化只会导致 $\\ln\\Lambda$ 发生 $\\ln(10) \\approx 2.3$ 的加性变化。考虑到本例中 $\\ln\\Lambda \\approx 28.82$，截断值中如此大的不确定性也只会使结果改变不到 $10\\%$。这种对数不敏感性使得库仑对数成为一个稳健的参数，从而证明了使用有物理动机的、数量级上的碰撞参数截断估计是合理的。",
            "answer": "$$\\boxed{28.82}$$"
        },
        {
            "introduction": "从连续理论走向计算实践会带来新的挑战，其中最主要的是如何保持基本守恒定律。朗道碰撞算符能够精确地保持动量和能量守恒，任何可靠的数值模拟都必须反映这一特性。这项高级练习通过展示如何在离散的有限体积框架内强制执行这些守恒定律，从而弥合了理论与实践之间的鸿沟，这是开发稳健的动力学模拟程序的一项关键技术。",
            "id": "4229587",
            "problem": "考虑朗道碰撞算子，它是速度空间中库仑相互作用的福克-普朗克（FP）碰撞算子。设 $f(\\mathbf{v},t)$ 为单种粒子分布函数，$\\mathbf{v} \\in \\mathbb{R}^3$ 为速度。朗道算子 $Q_{\\mathrm{L}}[f]$ 在速度空间中可以写成散度形式 $Q_{\\mathrm{L}}[f] = \\nabla_{\\mathbf{v}} \\cdot \\mathbf{J}[f]$，其中 $\\mathbf{J}[f]$ 是一个碰撞通量，它通过一个称为朗道张量的对称张量双线性地依赖于 $f$。朗道算子中双体碰撞的一个基本性质是碰撞不变量的精确守恒：粒子数、动量和动能。对于任何衰减足够快的 $f$，其连续形式满足 $\\int \\phi(\\mathbf{v}) \\, Q_{\\mathrm{L}}[f](\\mathbf{v}) \\, d^3\\mathbf{v} = 0$，其中 $\\phi(\\mathbf{v}) \\in \\left\\{ 1, \\mathbf{v}, \\tfrac{1}{2} \\lvert \\mathbf{v} \\rvert^2 \\right\\}$。\n\n您的任务是解释如何在朗道算子的离散速度空间有限体积格式中强制实现动量和能量守恒，并写出相应的离散约束条件。然后，您必须实现这些约束，并在几个离散网格上对其强制执行情况进行数值测试。\n\n从以下基本出发点开始：\n- 朗道算子 $Q_{\\mathrm{L}}[f]$ 是速度空间中的一个散度：$Q_{\\mathrm{L}}[f] = \\nabla_{\\mathbf{v}} \\cdot \\mathbf{J}[f]$。\n- 碰撞不变量 $1$、$\\mathbf{v}$ 和 $\\tfrac{1}{2}\\lvert \\mathbf{v} \\rvert^2$ 是守恒的：对于每个不变量 $\\phi$，都有 $\\int \\phi(\\mathbf{v}) \\, Q_{\\mathrm{L}}[f] \\, d^3\\mathbf{v} = 0$。\n- 在笛卡尔速度网格上的有限体积离散化中，离散散度定理将 $\\nabla_{\\mathbf{v}}\\cdot \\mathbf{J}$ 在单元上的积分转换为跨单元面的通量之和。\n\n离散化模型。考虑一个速度空间中的笛卡尔网格，其维度为 $d \\in \\{1,2,3\\}$，形状为 $(n_1,\\ldots,n_d)$。设单元中心的速度为 $\\mathbf{v}_j \\in \\mathbb{R}^d$，其中 $j$ 是单元的索引。设定向内部面（界面）的集合由 $e$ 索引，每个面沿着一个坐标方向连接一个左单元 $L(e)$ 和一个右单元 $R(e)$。用 $s_e$ 表示带符号的标量面通量，其值等于面 $e$ 上的离散碰撞通量与出射法向量的点积再乘以面的面积。单元 $j$ 中碰撞项的半离散有限体积更新可以抽象为\n$$ Q_j \\, \\Delta V_j = \\sum_{e \\in \\mathcal{F}(j)} \\sigma_{j,e} \\, s_e, $$\n其中 $\\Delta V_j$ 是速度空间中的单元体积，$\\mathcal{F}(j)$ 是与单元 $j$ 相邻的面集合，$\\sigma_{j,e} \\in \\{-1,+1\\}$ 给出面 $e$ 相对于单元 $j$ 的方向。这确保了如果 $e$ 和 $\\bar{e}$ 是具有相反方向的同一个几何面，则 $s_e = - s_{\\bar{e}}$。假设在域边界处的边界通量为零（例如，在 $\\lvert \\mathbf{v} \\rvert$ 很大时衰减为零）。\n\n使用离散散度定理，证明动量和能量守恒对面通量 $\\{s_e\\}$ 施加了以下线性约束：\n- 对于每个分量 $\\alpha = 1,\\ldots,d$ 的动量守恒：\n$$ \\sum_{e} \\Delta v_{e,\\alpha} \\, s_e = 0, $$\n其中 $\\Delta v_{e,\\alpha} = v_{R(e),\\alpha} - v_{L(e),\\alpha}$ 是速度的第 $\\alpha$ 个分量跨过面 $e$ 的差值。\n- 能量守恒：\n$$ \\sum_{e} \\Delta \\varepsilon_e \\, s_e = 0, \\quad \\text{其中} \\quad \\Delta \\varepsilon_e = \\tfrac{1}{2} \\left( \\lvert \\mathbf{v}_{R(e)} \\rvert^2 - \\lvert \\mathbf{v}_{L(e)} \\rvert^2 \\right) $$\n\n通过堆叠 $d$ 个动量行和随后的能量行，构造约束矩阵 $C \\in \\mathbb{R}^{(d+1) \\times E}$，其中 $E$ 是内部面的数量。离散约束则为 $C \\, \\mathbf{s} = \\mathbf{0}$，其中 $\\mathbf{s} \\in \\mathbb{R}^E$ 是面通量向量。\n\n强制执行策略。在实际格式中，一个初步的面通量 $\\mathbf{s}^{\\mathrm{raw}}$（来自所选的 $\\mathbf{J}$ 的离散化）可能不严格满足 $C\\,\\mathbf{s}^{\\mathrm{raw}}=\\mathbf{0}$。一个强制执行约束的最小校正是通过向 $C$ 的零空间进行正交投影来找到的，即\n$$ \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{s}^{\\mathrm{raw}} - \\mathbf{P} \\, \\mathbf{s}^{\\mathrm{raw}}, $$\n其中 $\\mathbf{P}$ 是到 $C^\\top$ 列空间的正交投影算子。等价地，如果 $C = U \\Sigma V^\\top$ 是奇异值分解，那么在面通量空间中，到 $C^\\top$ 列空间的投影算子是 $\\mathbf{P} = V_r V_r^\\top$，其中 $V_r$ 汇集了与非零奇异值相关的右奇异向量。那么根据构造，$C \\, \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{0}$。\n\n实现任务。编写一个完整的程序，该程序：\n1. 为以下每个测试套件构建 $\\mathbf{v}_j$ 和内部面。速度必须以 $\\mathrm{m/s}$ 表示。使用对称中心化的笛卡尔坐标 $\\mathbf{v}_j = \\left( x_1, \\ldots, x_d \\right)$，其中 $x_i = \\Delta u_i \\left( k_i - \\tfrac{n_i - 1}{2} \\right)$，对于 $k_i \\in \\{0,\\ldots,n_i-1\\}$，以及给定的间距 $\\Delta u_i$（单位为 $\\mathrm{m/s}$）。\n2. 从 $\\Delta \\mathbf{v}_e$ 和 $\\Delta \\varepsilon_e$ 构建约束矩阵 $C$。\n3. 为每个测试用例生成一个可复现的随机原始面通量向量 $\\mathbf{s}^{\\mathrm{raw}}$。\n4. 将 $\\mathbf{s}^{\\mathrm{raw}}$ 投影到 $\\mathrm{null}(C)$ 上以获得 $\\mathbf{s}^{\\mathrm{cons}}$。\n5. 计算残差 $\\lVert C \\, \\mathbf{s}^{\\mathrm{cons}} \\rVert_2$（单位与面通量大小一致；以无量纲浮点数形式报告）。\n6. 按规定输出残差。\n\n测试套件（每个用例指定 $(n_1,\\ldots,n_d)$、间距 $(\\Delta u_1,\\ldots,\\Delta u_d)$（单位为 $\\mathrm{m/s}$）和一个随机种子）：\n- 用例1（常规 $3\\mathrm{D}$ 正常路径）：$(2,2,2)$，间距 $(1.0\\times 10^5, 1.0\\times 10^5, 1.0\\times 10^5)$，种子 $42$。\n- 用例2（$1\\mathrm{D}$ 线，类边界情况）：$(3)$，间距 $(5.0\\times 10^4)$，种子 $7$。\n- 用例3（退化的单单元边界情况）：$(1,1,1)$，间距 $(1.0\\times 10^5, 1.0\\times 10^5, 1.0\\times 10^5)$，种子 $0$。\n- 用例4（$2\\mathrm{D}$ 各向异性间距）：$(2,3)$，间距 $(1.5\\times 10^5, 0.8\\times 10^5)$，种子 $100$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{结果1},\\text{结果2},\\text{结果3},\\text{结果4}]$），其中每个 $\\text{结果}$ 是相应情况下以浮点数表示的残差 $\\lVert C \\, \\mathbf{s}^{\\mathrm{cons}} \\rVert_2$。本问题不涉及角度。不涉及百分比。输出是无量纲的，因为它是应用于离散化内部面通量向量的线性约束的范数。",
            "solution": "该问题要求我们首先为朗道碰撞算子的有限体积离散化推导动量和能量的离散守恒定律，然后实现一个数值程序来强制执行这些约束。\n\n首先，我们将推导离散守恒约束。连续朗道算子 $Q_{\\mathrm{L}}[f] = \\nabla_{\\mathbf{v}} \\cdot \\mathbf{J}[f]$ 守恒某个量 $\\phi(\\mathbf{v})$，如果该量在整个速度空间上的总量不因碰撞而改变。这表示为 $\\int \\phi(\\mathbf{v}) \\, Q_{\\mathrm{L}}[f](\\mathbf{v}) \\, d^3\\mathbf{v} = 0$。使用散度定理并假设通量 $\\mathbf{J}[f]$ 在无穷远处消失，该积分变为 $\\int \\nabla_{\\mathbf{v}} \\cdot (\\phi \\mathbf{J}) \\, d^3\\mathbf{v} - \\int \\mathbf{J} \\cdot \\nabla_{\\mathbf{v}} \\phi \\, d^3\\mathbf{v} = 0$。第一项为零。因此，守恒等价于 $\\int \\mathbf{J}[f] \\cdot \\nabla_{\\mathbf{v}} \\phi \\, d^3\\mathbf{v} = 0$。给定的碰撞不变量是 $\\phi(\\mathbf{v}) \\in \\{1, \\mathbf{v}, \\frac{1}{2}|\\mathbf{v}|^2\\}$。\n\n在笛卡尔速度网格上的有限体积格式中，计算域被划分为由 $j$ 索引的单元。量 $\\phi$ 的总变化的离散等价形式是所有单元内变化的总和：\n$$ \\frac{d}{dt} \\sum_j \\phi(\\mathbf{v}_j) n_j = \\sum_j \\phi_j Q_j \\Delta V_j $$\n其中 $\\phi_j = \\phi(\\mathbf{v}_j)$，$Q_j$ 是单元 $j$ 中的离散碰撞算子，$\\Delta V_j$ 是单元体积。为了守恒，这个总和必须为零。问题陈述，单元 $j$ 的半离散更新由其相邻面 $e \\in \\mathcal{F}(j)$ 的总和给出：\n$$ Q_j \\Delta V_j = \\sum_{e \\in \\mathcal{F}(j)} \\sigma_{j,e} \\, s_e $$\n其中 $s_e$ 是穿过面 $e$ 的标量通量，$\\sigma_{j,e}$ 是一个符号因子。我们采用一个约定，其中面集合 $\\{e\\}$ 对每个内部界面只包含一个唯一的条目，其方向定义为从“左”单元 $L(e)$ 到“右”单元 $R(e)$。通量 $s_e$ 接着被定义为如果它从 $L(e)$ 流向 $R(e)$ 则为正。据此，单元 $L(e)$ 的更新包含一个项 $-s_e$（通量流出），而单元 $R(e)$ 的更新包含一个项 $+s_e$（通量流入）。\n\n总变化是 $\\sum_j \\phi_j Q_j \\Delta V_j$。我们可以将这个对单元的求和重排为对唯一内部面的求和。每个面 $e$ 由两个单元 $L(e)$ 和 $R(e)$ 共享。它对总和的贡献是：\n$$ \\phi_{L(e)} (\\text{term for } e \\text{ in } Q_{L(e)}\\Delta V_{L(e)}) + \\phi_{R(e)} (\\text{term for } e \\text{ in } Q_{R(e)}\\Delta V_{R(e)}) = \\phi_{L(e)} (-s_e) + \\phi_{R(e)} (+s_e) = s_e (\\phi_{R(e)} - \\phi_{L(e)}) $$\n这是分部求和的离散形式，类似于散度定理。边界通量为零的假设确保了没有边界项出现。因此，量 $\\phi$ 的离散守恒定律是：\n$$ \\sum_{e} s_e (\\phi_{R(e)} - \\phi_{L(e)}) = 0 $$\n其中求和是对所有唯一的内部面进行的。\n\n现在我们将这个一般结果应用于特定的不变量。\n粒子数守恒：$\\phi(\\mathbf{v}) = 1$。条件是 $\\sum_e s_e (1 - 1) = 0$，这永远成立。这证实了算子的散度形式内啝地守恒粒子数。\n\n动量守恒：$\\phi(\\mathbf{v}) = \\mathbf{v}$。这是一个矢量，所以我们考虑每个分量 $\\phi_\\alpha(\\mathbf{v}) = v_\\alpha$，对于 $\\alpha = 1, \\ldots, d$。每个分量的守恒条件是：\n$$ \\sum_{e} s_e (v_{R(e),\\alpha} - v_{L(e),\\alpha}) = 0 $$\n定义 $\\Delta v_{e,\\alpha} = v_{R(e),\\alpha} - v_{L(e),\\alpha}$，这就变成了 $\\sum_{e} \\Delta v_{e,\\alpha} s_e = 0$，这就是所要求的动量约束。\n\n能量守恒：$\\phi(\\mathbf{v}) = \\frac{1}{2} |\\mathbf{v}|^2$。条件为：\n$$ \\sum_{e} s_e \\left( \\frac{1}{2} |\\mathbf{v}_{R(e)}|^2 - \\frac{1}{2} |\\mathbf{v}_{L(e)}|^2 \\right) = 0 $$\n定义 $\\Delta \\varepsilon_e = \\frac{1}{2} (|\\mathbf{v}_{R(e)}|^2 - |\\mathbf{v}_{L(e)}|^2)$，这就变成了 $\\sum_{e} \\Delta \\varepsilon_e s_e = 0$，即所要求的能量约束。\n\n这 $d+1$ 个关于面通量向量 $\\mathbf{s} \\in \\mathbb{R}^E$ 的线性约束可以写成矩阵形式 $C \\mathbf{s} = \\mathbf{0}$，其中 $C \\in \\mathbb{R}^{(d+1) \\times E}$ 是约束矩阵。$C$ 的行由系数 $\\Delta v_{e,\\alpha}$ 和 $\\Delta \\varepsilon_e$ 构成。\n\n其次，我们讨论强制执行策略。一个数值格式可能会产生一组不满足约束的原始通量 $\\mathbf{s}^{\\mathrm{raw}}$，即 $C \\mathbf{s}^{\\mathrm{raw}} \\neq \\mathbf{0}$。我们需要找到一个校正后的通量向量 $\\mathbf{s}^{\\mathrm{cons}}$，它“接近”于 $\\mathbf{s}^{\\mathrm{raw}}$ 并且满足 $C \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{0}$。向量 $\\mathbf{s}^{\\mathrm{cons}}$ 必须位于 $C$ 的零空间中，记为 $\\mathrm{null}(C)$。在一个子空间中寻找最近向量的问题通过正交投影来解决。\n\n通量空间 $\\mathbb{R}^E$ 可以分解为 $C$ 的行空间（记为 $\\mathcal{R}(C^\\top)$）与其零空间（$\\mathrm{null}(C)$）的正交和。任何向量 $\\mathbf{s}^{\\mathrm{raw}}$ 都可以唯一地写成 $\\mathbf{s}^{\\mathrm{raw}} = \\mathbf{s}_{\\mathcal{R}} + \\mathbf{s}_{\\mathcal{N}}$，其中 $\\mathbf{s}_{\\mathcal{R}} \\in \\mathcal{R}(C^\\top)$ 且 $\\mathbf{s}_{\\mathcal{N}} \\in \\mathrm{null}(C)$。所期望的守恒通量就是 $\\mathbf{s}^{\\mathrm{raw}}$ 在零空间中的分量：$\\mathbf{s}^{\\mathrm{cons}} = \\mathbf{s}_{\\mathcal{N}}$。\n\n为了计算这个投影，我们使用约束矩阵的奇异值分解（SVD）：$C = U \\Sigma V^\\top$。$V$ 的列构成了 $\\mathbb{R}^E$ 的一个标准正交基。如果 $C$ 的秩为 $r$，那么 $V$ 的前 $r$ 列（记为 $V_r$）张成 $\\mathcal{R}(C^\\top)$，而剩下的 $E-r$ 列（记为 $V_n$）张成 $\\mathrm{null}(C)$。\n到 $\\mathrm{null}(C)$ 的正交投影算子是 $P_{\\mathrm{null}} = V_n V_n^\\top$。\n因此，守恒通量向量是通过将原始通量向量投影到零空间上来获得的：\n$$ \\mathbf{s}^{\\mathrm{cons}} = P_{\\mathrm{null}} \\, \\mathbf{s}^{\\mathrm{raw}} = (V_n V_n^\\top) \\mathbf{s}^{\\mathrm{raw}} $$\n根据构造，$C \\mathbf{s}^{\\mathrm{cons}} = C (V_n V_n^\\top \\mathbf{s}^{\\mathrm{raw}})$。由于 $V_n$ 的列是 $\\mathrm{null}(C)$ 的一组基，我们有 $C V_n = \\mathbf{0}$。因此，$C \\mathbf{s}^{\\mathrm{cons}} = \\mathbf{0}$，约束在机器精度范围内得到满足。程序将实现此过程，为各种网格配置构造矩阵 $C$，生成一个随机的 $\\mathbf{s}^{\\mathrm{raw}}$，使用 SVD 计算 $\\mathbf{s}^{\\mathrm{cons}}$，并验证残差范数 $\\lVert C \\mathbf{s}^{\\mathrm{cons}} \\rVert_2$ 是否可忽略不计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Constructs and enforces conservation constraints for a discretized Landau operator.\n\n    For several test cases, this function:\n    1. Sets up a Cartesian velocity grid.\n    2. Identifies all interior cell faces.\n    3. Builds the constraint matrix 'C' for momentum and energy conservation.\n    4. Generates a random raw flux vector 's_raw'.\n    5. Projects 's_raw' onto the null space of 'C' to get a conserved flux 's_cons'.\n    6. Calculates the L2 norm of the residual 'C @ s_cons' to verify constraint satisfaction.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: 3D, (2,2,2) grid, isotropic spacing, seed 42\n        {'shape': (2, 2, 2), 'spacings': (1.0e5, 1.0e5, 1.0e5), 'seed': 42},\n        # Case 2: 1D, (3,) grid, seed 7\n        {'shape': (3,), 'spacings': (5.0e4,), 'seed': 7},\n        # Case 3: 3D, single cell (1,1,1) grid, seed 0\n        {'shape': (1, 1, 1), 'spacings': (1.0e5, 1.0e5, 1.0e5), 'seed': 0},\n        # Case 4: 2D, (2,3) grid, anisotropic spacing, seed 100\n        {'shape': (2, 3), 'spacings': (1.5e5, 0.8e5), 'seed': 100},\n    ]\n\n    results = []\n    for case in test_cases:\n        n_dims = case['shape']\n        spacings = case['spacings']\n        seed = case['seed']\n        d = len(n_dims)\n\n        # 1. Construct cell-centered velocities v_j\n        axis_coords = []\n        for i in range(d):\n            k_i = np.arange(n_dims[i])\n            x_i = spacings[i] * (k_i - (n_dims[i] - 1) / 2.0)\n            axis_coords.append(x_i)\n        \n        grid = np.meshgrid(*axis_coords, indexing='ij')\n        # Each element of grid is a (n1, n2, ...) array for one coordinate\n        # Stack them to get a single (d, n1, n2, ...) array\n        grid_stacked = np.stack(grid, axis=0)\n        # Reshape to (d, N_cells) and transpose to (N_cells, d)\n        velocities = grid_stacked.reshape(d, -1).T\n        num_cells = velocities.shape[0]\n        \n        # Edge case: single cell grids have no interior faces\n        if num_cells == 1:\n            results.append(0.0)\n            continue\n\n        # 2. Build the list of interior faces\n        faces = []\n        cell_indices_grid = np.arange(num_cells).reshape(n_dims)\n\n        for dim_idx in range(d):\n            # A face exists between cell(k_i) and cell(k_i+1) along dimension i\n            # Create slices to select all \"left\" and \"right\" cells along this dim\n            left_slice = [slice(None)] * d\n            left_slice[dim_idx] = slice(None, -1)\n            \n            right_slice = [slice(None)] * d\n            right_slice[dim_idx] = slice(1, None)\n\n            left_cell_indices = cell_indices_grid[tuple(left_slice)].flatten()\n            right_cell_indices = cell_indices_grid[tuple(right_slice)].flatten()\n\n            for l_idx, r_idx in zip(left_cell_indices, right_cell_indices):\n                faces.append((l_idx, r_idx))\n        \n        num_faces = len(faces)\n\n        # 3. Build the constraint matrix C\n        C = np.zeros((d + 1, num_faces))\n\n        for e, (l_idx, r_idx) in enumerate(faces):\n            v_L = velocities[l_idx]\n            v_R = velocities[r_idx]\n\n            # Momentum constraints (d rows)\n            delta_v = v_R - v_L\n            C[0:d, e] = delta_v\n\n            # Energy constraint (1 row)\n            delta_eps = 0.5 * (np.dot(v_R, v_R) - np.dot(v_L, v_L))\n            C[d, e] = delta_eps\n            \n        # 4. Generate a random raw flux vector s_raw\n        rng = np.random.default_rng(seed)\n        s_raw = rng.random(num_faces)\n\n        # 5. Project s_raw onto the null space of C to get s_cons\n        if num_faces == 0:\n            residual = 0.0\n        else:\n            # U, S, Vh = C.svd()\n            # Vh is the transpose of the matrix of right singular vectors\n            U, S, Vh = scipy.linalg.svd(C, full_matrices=False)\n            \n            # Determine rank by finding non-zero singular values with a tolerance\n            tol = S[0] * max(C.shape) * np.finfo(S.dtype).eps if S.size > 0 else 0\n            rank = np.sum(S > tol)\n\n            # The rows of Vh form an orthonormal basis. The last (E-r) rows\n            # span the null space of C.\n            Vn_T = Vh[rank:] # These rows are an orthonormal basis for null(C)\n\n            # Project s_raw onto the null space.\n            # Projector P_null = Vn @ Vn.T = Vn_T.T @ Vn_T\n            if rank == num_faces: # Null space is trivial\n                 s_cons = np.zeros_like(s_raw)\n            else:\n                 s_cons = Vn_T.T @ (Vn_T @ s_raw)\n\n            # 6. Compute the residual norm ||C @ s_cons||_2\n            residual_vector = C @ s_cons\n            residual = np.linalg.norm(residual_vector)\n            \n        results.append(residual)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}