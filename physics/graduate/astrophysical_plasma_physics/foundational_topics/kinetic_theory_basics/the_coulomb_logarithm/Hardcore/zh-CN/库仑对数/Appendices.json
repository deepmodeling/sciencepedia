{
    "hands_on_practices": [
        {
            "introduction": "库仑对数的核心思想源于对带电粒子间基本相互作用的理解。为了掌握这一概念，我们必须首先回到单个二体碰撞的动力学。这项练习将引导你从牛顿第二定律和守恒定律出发，推导出卢瑟福散射中散射角$\\theta$的精确表达式。通过这个从第一性原理出发的推导，你将亲身体会到为何碰撞参数$b$的积分中会出现对数发散，并为理解为何需要引入物理截断（即库仑对数的来源）打下坚实的理论基础。",
            "id": "3961433",
            "problem": "一束带电荷 $q_1$、质量为 $m_1$ 的单能点粒子，与带电荷 $q_2$、质量为 $m_2$ 的静止点靶发生弹性散射。将相互作用视为纯粹的中心力作用，并由库仑势 $V(r) = \\frac{q_1 q_2}{4 \\pi \\varepsilon_0 r}$ 决定，其中 $\\varepsilon_0$ 是真空介电常数。在质心参考系中进行计算，使用约化质量 $\\mu = \\frac{m_1 m_2}{m_1 + m_2}$ 和无穷远处的相对速度 $v$。入射轨迹的碰撞参数为 $b$，其总能量 $E$ 和角动量 $L$ 由其渐近运动确定。\n\n从中心力情况下的牛顿第二定律以及能量和角动量守恒定律出发，推导散射角 $\\theta$ 作为 $b$、$v$、$q_1$、$q_2$ 和 $\\mu$ 的函数，过程中不使用任何预先推导出的散射公式。然后，使用你得到的精确表达式，定义产生 $\\theta = \\frac{\\pi}{2}$ 的碰撞参数 $b_{90}$，并通过对精确结果进行受控展开，验证当 $b \\gg b_{90}$ 时的小角度近似 $\\theta \\approx \\frac{2 b_{90}}{b}$。将最终的精确散射角 $\\theta$ 表示为包含 $b$、$v$、$q_1$、$q_2$、$\\mu$ 和 $\\varepsilon_0$ 的单个闭合形式符号表达式。散射角 $\\theta$ 是无量纲的；不需要进行数值近似或舍入。",
            "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n-   **束粒子：** 电荷 $q_1$，质量 $m_1$。\n-   **靶粒子：** 静止，电荷 $q_2$，质量 $m_2$。\n-   **相互作用：** 弹性散射，纯粹中心力。\n-   **势能：** $V(r) = \\frac{q_1 q_2}{4 \\pi \\varepsilon_0 r}$。\n-   **参考系：** 质心（CM）参考系。\n-   **约化质量：** $\\mu = \\frac{m_1 m_2}{m_1 + m_2}$。\n-   **无穷远处相对速度：** $v$。\n-   **碰撞参数：** $b$。\n-   **总能量（渐近）：** $E$。\n-   **角动量（渐近）：** $L$。\n-   **任务1：** 推导散射角 $\\theta$ 作为 $b, v, q_1, q_2, \\mu, \\varepsilon_0$ 的函数。\n-   **任务2：** 定义散射角为 $\\theta = \\frac{\\pi}{2}$ 时的 $b_{90}$。\n-   **任务3：** 验证当 $b \\gg b_{90}$ 时的小角度近似 $\\theta \\approx \\frac{2 b_{90}}{b}$。\n-   **约束条件：** 从牛顿第二定律和守恒定律出发，不使用预先推导的散射公式。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准评估问题。\n-   **科学基础：** 该问题描述了库仑（或卢瑟福）散射，这是经典力学和电磁学中一个基本且成熟的课题。势能、约化质量的使用以及质心参考系都是标准且正确的。\n-   **适定性：** 这是一个适定问题。它要求在给定一组完整的初始条件下，从第一性原理出发推导一个标准物理量（$\\theta$）。解是唯一且稳定的。\n-   **客观性：** 语言精确、客观。所有术语均为物理学标准术语。\n-   **完备性与一致性：** 问题提供了确定散射角所需的所有参数（$q_1, m_1, q_2, m_2, v, b, \\varepsilon_0$）。量 $E$ 和 $L$ 由渐近条件定义，并与 $v$ 和 $b$ 一致。没有矛盾之处。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的推导过程。\n\n我们在质心（CM）参考系中开始推导，在该参考系中，二体问题简化为一个质量为约化质量 $\\mu = \\frac{m_1 m_2}{m_1 + m_2}$ 的粒子在中心势 $V(r) = \\frac{k}{r}$ 中运动的单体问题，为方便起见，我们定义常数 $k = \\frac{q_1 q_2}{4 \\pi \\varepsilon_0}$。粒子的位置由极坐标 $(r, \\phi)$ 描述。\n\n运动由总能量 $E$ 和角动量 $L$ 的守恒定律决定。这些量由 $r \\to \\infty$ 时的初始条件确定，此时势能 $V(r) \\to 0$，相对速度为 $v$。\n在无穷远处，总能量纯粹是动能：\n$$E = \\frac{1}{2}\\mu v^2$$\n在整个相互作用过程中，角动量是恒定的。在无穷远处，轨迹是一条直线，速度为 $v$，与原点的垂直距离为 $b$（碰撞参数）。因此，角动量的大小为：\n$$L = \\mu v b$$\n对于轨迹上的任意点，能量守恒表示为：\n$$E = \\frac{1}{2}\\mu \\left(\\dot{r}^2 + r^2 \\dot{\\phi}^2\\right) + V(r)$$\n其中 $\\dot{r} = \\frac{dr}{dt}$ 且 $\\dot{\\phi} = \\frac{d\\phi}{dt}$。\n根据角动量守恒 $L = \\mu r^2 \\dot{\\phi}$，我们可以写出 $\\dot{\\phi} = \\frac{L}{\\mu r^2}$。将其代入能量方程得到：\n$$\\frac{1}{2}\\mu v^2 = \\frac{1}{2}\\mu \\dot{r}^2 + \\frac{L^2}{2\\mu r^2} + \\frac{k}{r}$$\n我们可以解出 $\\dot{r}$：\n$$\\dot{r} = \\frac{dr}{dt} = \\pm \\sqrt{\\frac{2}{\\mu}\\left(E - \\frac{L^2}{2\\mu r^2} - \\frac{k}{r}\\right)}$$\n为了找到轨迹 $r(\\phi)$，我们计算导数 $\\frac{dr}{d\\phi}$：\n$$\\frac{dr}{d\\phi} = \\frac{dr/dt}{d\\phi/dt} = \\frac{\\dot{r}}{\\dot{\\phi}} = \\frac{\\pm \\sqrt{\\frac{2}{\\mu}\\left(E - \\frac{L^2}{2\\mu r^2} - \\frac{k}{r}\\right)}}{L/(\\mu r^2)}$$\n更方便的方法是求出 $\\frac{d\\phi}{dr}$ 并积分。我们来计算粒子从最近点 $r_{min}$ 运动到无穷远处所扫过的角度。在 $r_{min}$ 处，径向速度 $\\dot{r}=0$。从能量方程可得：\n$$E = \\frac{L^2}{2\\mu r_{min}^2} + \\frac{k}{r_{min}}$$\n从 $r_{min}$ 到 $\\infty$ 的角度变化由以下积分给出：\n$$\\Delta\\phi = \\int_{r_{min}}^{\\infty} \\frac{d\\phi}{dr} dr = \\int_{r_{min}}^{\\infty} \\frac{L/(\\mu r^2)}{\\sqrt{\\frac{2}{\\mu}\\left(E - \\frac{L^2}{2\\mu r^2} - \\frac{k}{r}\\right)}} dr$$\n代入 $E = \\frac{1}{2}\\mu v^2$ 和 $L = \\mu v b$：\n$$\\Delta\\phi = \\int_{r_{min}}^{\\infty} \\frac{b}{r^2 \\sqrt{1 - \\frac{b^2}{r^2} - \\frac{2k}{\\mu v^2 r}}} dr$$\n为了求解这个积分，我们进行换元，$u = \\frac{1}{r}$，所以 $du = -\\frac{1}{r^2} dr$。积分限从 $(r_{min}, \\infty)$ 变为 $(u_{max}, 0)$，其中 $u_{max} = \\frac{1}{r_{min}}$。\n$$\\Delta\\phi = \\int_{u_{max}}^{0} \\frac{b(-du)}{\\sqrt{1 - b^2 u^2 - \\frac{2k}{\\mu v^2} u}} = \\int_{0}^{u_{max}} \\frac{b \\, du}{\\sqrt{1 - b^2 u^2 - \\frac{2k}{\\mu v^2} u}}$$\n积分上限 $u_{max}$ 是使根号下表达式为零的 $u$ 值，对应于 $\\dot{r}=0$。我们对根号下关于 $u$ 的二次式进行配方：\n$$1 - \\left(b^2 u^2 + \\frac{2k}{\\mu v^2}u \\right) = 1 + \\left(\\frac{k}{\\mu v^2 b}\\right)^2 - \\left(b u + \\frac{k}{\\mu v^2 b}\\right)^2$$\n积分变为：\n$$\\Delta\\phi = \\int_{0}^{u_{max}} \\frac{b \\, du}{\\sqrt{\\left(1 + \\left(\\frac{k}{\\mu v^2 b}\\right)^2\\right) - \\left(b u + \\frac{k}{\\mu v^2 b}\\right)^2}}$$\n这是一个形如 $\\int \\frac{dx}{\\sqrt{a^2-x^2}}$ 的标准积分，其结果为 $\\arcsin(x/a)$。\n设 $z = b u + \\frac{k}{\\mu v^2 b}$。则 $dz = b \\, du$。积分为：\n$$\\Delta\\phi = \\left[ \\arcsin\\left( \\frac{b u + \\frac{k}{\\mu v^2 b}}{\\sqrt{1 + \\left(\\frac{k}{\\mu v^2 b}\\right)^2}} \\right) \\right]_{u=0}^{u=u_{max}}$$\n在上限 $u=u_{max}$ 处，原始根号下的项为零，这意味着配方后的平方项为零。$\\arcsin$ 函数的自变量为 $1$，因此其值为 $\\frac{\\pi}{2}$。在下限 $u=0$ 处：\n$$\\Delta\\phi = \\frac{\\pi}{2} - \\arcsin\\left( \\frac{k/(\\mu v^2 b)}{\\sqrt{1 + \\left(\\frac{k}{\\mu v^2 b}\\right)^2}} \\right)$$\n使用恒等式 $\\arcsin(x) + \\arccos(x) = \\frac{\\pi}{2}$，我们得到：\n$$\\Delta\\phi = \\arccos\\left( \\frac{k/(\\mu v^2 b)}{\\sqrt{1 + \\left(\\frac{k}{\\mu v^2 b}\\right)^2}} \\right)$$\n轨迹关于最近点是对称的。从入射渐近线到出射渐近线，矢径扫过的总角度为 $\\Phi = 2\\Delta\\phi$。\n散射角 $\\theta$ 是初始和最终运动方向之间的夹角。\n对于排斥力（$k  0$），粒子被偏转开。几何关系表明 $\\theta = \\pi - \\Phi = \\pi - 2\\Delta\\phi$。\n对于吸引力（$k  0$），粒子被拉向中心。几何关系表明 $\\theta = \\Phi - \\pi = 2\\Delta\\phi - \\pi$。\n我们来考虑这两种情况。设 $\\alpha = \\frac{k}{\\mu v^2 b}$。我们可以写出 $\\Delta\\phi = \\arccos\\left(\\frac{\\alpha}{\\sqrt{1+\\alpha^2}}\\right)$。\n一个三角恒等式表明，如果 $\\tan(\\psi) = \\alpha$，那么 $\\cos(\\psi) = \\frac{1}{\\sqrt{1+\\alpha^2}}$ 且 $\\sin(\\psi) = \\frac{\\alpha}{\\sqrt{1+\\alpha^2}}$。因此，$\\frac{\\alpha}{\\sqrt{1+\\alpha^2}} = \\sin(\\psi)$。\n所以，$\\Delta\\phi = \\arccos(\\sin(\\psi)) = \\frac{\\pi}{2} - \\psi = \\frac{\\pi}{2} - \\arctan(\\alpha)$。\n对于排斥力（$k>0$，所以 $\\alpha>0$）：\n$$\\theta = \\pi - 2\\left(\\frac{\\pi}{2} - \\arctan(\\alpha)\\right) = 2\\arctan(\\alpha)$$\n对于吸引力（$k0$，所以 $\\alpha0$）：\n$$\\theta = 2\\left(\\frac{\\pi}{2} - \\arctan(\\alpha)\\right) - \\pi = -2\\arctan(\\alpha) = 2\\arctan(-\\alpha)$$\n在两种情况下，由于物理散射角 $\\theta$ 被定义为在 $[0, \\pi]$ 范围内的正值，表达式为 $\\theta = 2\\arctan(|\\alpha|)$。\n将 $\\alpha$ 和 $k$ 代回：\n$$\\theta = 2\\arctan\\left(\\frac{|k|}{\\mu v^2 b}\\right) = 2\\arctan\\left(\\frac{|q_1 q_2|}{4 \\pi \\varepsilon_0 \\mu v^2 b}\\right)$$\n这就是推导出的精确散射角的表达式。\n\n现在，我们按要求执行后续任务。\n首先，我们定义产生散射角 $\\theta = \\frac{\\pi}{2}$ 的碰撞参数 $b_{90}$。\n$$\\frac{\\pi}{2} = 2\\arctan\\left(\\frac{|q_1 q_2|}{4 \\pi \\varepsilon_0 \\mu v^2 b_{90}}\\right)$$\n$$\\frac{\\pi}{4} = \\arctan\\left(\\frac{|q_1 q_2|}{4 \\pi \\varepsilon_0 \\mu v^2 b_{90}}\\right)$$\n对两边应用正切函数：\n$$\\tan\\left(\\frac{\\pi}{4}\\right) = 1 = \\frac{|q_1 q_2|}{4 \\pi \\varepsilon_0 \\mu v^2 b_{90}}$$\n解出 $b_{90}$：\n$$b_{90} = \\frac{|q_1 q_2|}{4 \\pi \\varepsilon_0 \\mu v^2}$$\n其次，我们验证 $b \\gg b_{90}$ 时的小角度近似。这个条件意味着反正切函数的自变量很小。令 $x = \\frac{|q_1 q_2|}{4 \\pi \\varepsilon_0 \\mu v^2 b}$。使用 $b_{90}$ 的定义，我们可以写出 $x = \\frac{b_{90}}{b}$。\n条件 $b \\gg b_{90}$ 意味着 $x \\ll 1$。\n精确散射角为 $\\theta = 2\\arctan(x)$。\n对于小的 $x$ 值，$\\arctan(x)$ 的泰勒级数展开为 $\\arctan(x) \\approx x - \\frac{x^3}{3} + \\dots$。\n对于 $x \\ll 1$，取一阶近似，我们有 $\\arctan(x) \\approx x$。\n因此，在此极限下散射角为：\n$$\\theta \\approx 2x = 2\\frac{b_{90}}{b}$$\n这通过对精确结果进行受控展开，完成了对小角度近似的验证。最终的散射角符号表达式是最初推导出的那个。",
            "answer": "$$\\boxed{2\\arctan\\left(\\frac{|q_1 q_2|}{4 \\pi \\varepsilon_0 \\mu v^2 b}\\right)}$$"
        },
        {
            "introduction": "在理解了散射积分的对数特性后，下一步便是如何在一个真实的等离子体环境中将其转化为一个有限的、有物理意义的量。这需要我们引入合理的物理截断来限定积分范围。这项练习是一项综合性的计算实践，要求你推导并编写程序来计算不同天体物理等离子体环境下的库仑对数。通过亲手实现从德拜长度到德布罗意波长的各种物理截断，你将不仅掌握$\\ln\\Lambda$的计算方法，更能深刻理解其在不同物理机制（如经典与量子、稀薄与稠密）主导下的行为。",
            "id": "4230074",
            "problem": "你的任务是，使用具有物理依据的截断方法，推导、实现和数值评估天体物理等离子体中电子-离子碰撞的库仑对数。你的程序必须为每个测试用例计算一个无量纲量，并将结果汇总为单一指定格式。\n\n推导必须从适用于天体物理等离子体物理学的第一性原理出发。从以下经过充分检验的基础开始：\n- 用于描述电子和离子之间长程库仑势导致的带电粒子偏转的 Rutherford 散射框架。\n- 由静电屏蔽产生的大碰撞参数截断，该屏蔽通过从线性化 Poisson–Boltzmann 理论推导出的德拜长度来建模。\n- 由大角度散射的经典最近距离或量子力学德布罗意波长产生的小碰撞参数截断。\n\n定义物理背景和各物理量如下：\n- 考虑电子-离子二体碰撞，其中折合质量近似为电子质量，因此电子动力学主导相对运动。设离子电荷态为 $Z$（无量纲）。\n- 最大有效碰撞参数由电子的德拜长度 $\\lambda_{\\mathrm{D}}$ 决定，该长度是在电子数密度为 $n_{\\mathrm{e}}$、电子温度为 $T_{\\mathrm{e}}$ 的准中性等离子体中通过线性响应推导得出。\n- 最小有效碰撞参数取经典 $90^\\circ$ 散射碰撞参数 $b_{90}$ 和基于电子德布罗意波长的尺度 $b_{\\mathrm{q}}$ 中的较大者。\n\n你的任务：\n1. 从库仑势的 Rutherford 散射描述和德拜屏蔽概念出发，推导弱耦合等离子体中电子-离子动量转移截面积分的渐近形式，并证明其可简化为一个无量纲因子，该因子对数地依赖于大尺度截断与小尺度截断之比。确定这些截断在物理上有依据的表达式，用 $n_{\\mathrm{e}}$、$T_{\\mathrm{e}}$、$Z$ 和相对速度 $v$ 表示。\n2. 提出一个算法，给定 $(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v)$，使用国际单位制 (SI) 中的以下定义来计算库仑对数。以下列表中的每个符号都必须使用所述表达式来实现：\n   - 德拜长度：$\\lambda_{\\mathrm{D}} = \\sqrt{\\dfrac{\\varepsilon_{0} k_{\\mathrm{B}} T_{\\mathrm{e}}}{n_{\\mathrm{e}} e^{2}}}$。\n   - 经典最小值：$b_{90} = \\dfrac{Z e^{2}}{4 \\pi \\varepsilon_{0} m_{\\mathrm{e}} v^{2}}$。\n   - 量子最小值：$b_{\\mathrm{q}} = \\dfrac{\\hbar}{2 m_{\\mathrm{e}} v}$。\n   - 有效最小值：$b_{\\min} = \\max\\!\\left(b_{90}, b_{\\mathrm{q}}\\right)$。\n   - 有效最大值：$b_{\\max} = \\lambda_{\\mathrm{D}}$。\n   - 库仑对数：如果 $b_{\\min} \\ge b_{\\max}$，返回 $0$；否则计算 $\\ln\\!\\Lambda = \\ln\\!\\left(\\dfrac{b_{\\max}}{b_{\\min}}\\right)$。\n3. 实现一个程序，为以下五个测试用例评估库仑对数。每个测试用例都提供元组 $(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v)$。如果 $v=0$，你必须使用电子热速度 $v = \\sqrt{\\dfrac{2 k_{\\mathrm{B}} T_{\\mathrm{e}}}{m_{\\mathrm{e}}}}$；否则，直接使用给定的 $v$。所有输入均采用 SI 单位：$n_e$ 单位为 $\\mathrm{m}^{-3}$，$T_e$ 单位为 $\\mathrm{K}$，$Z$ 为无量纲量，$v$ 单位为 $\\mathrm{m\\,s^{-1}}$。\n   - 案例 A（稀薄暖等离子体，代表星际介质）：$(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v) = \\left(10^{6}, 10^{4}, 1, 0\\right)$。\n   - 案例 B（极稠密且冷，受屏蔽限制，预期饱和于零）：$(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v) = \\left(10^{26}, 10, 1, 0\\right)$。\n   - 案例 C（热、极稀薄等离子体，代表星系团内介质）：$(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v) = \\left(10^{3}, 10^{8}, 1, 0\\right)$。\n   - 案例 D（高速下量子截断占主导地位）：$(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v) = \\left(10^{12}, 10^{6}, 1, 2.99792458 \\times 10^{7}\\right)$。\n   - 案例 E（重离子电荷态效应）：$(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v) = \\left(10^{14}, 10^{5}, 26, 0\\right)$。\n4. 数值单位和格式要求：\n   - 在整个计算过程中使用 SI 单位。\n   - 库仑对数是无量纲的；报告每个值时四舍五入到六位小数。\n   - 你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，按案例 A 到 E 的顺序排列，例如 $[\\ell_{A},\\ell_{B},\\ell_{C},\\ell_{D},\\ell_{E}]$，其中每个 $\\ell_{i}$ 是一个四舍五入到六位小数的十进制浮点数。\n\n你的最终答案必须是一个完整的、可运行的程序，该程序为上述测试套件计算并打印指定的输出，无需任何外部输入。输出中不允许包含中间文本或额外的行。计算必须在科学上与弱耦合、非相对论性库仑散射和静电屏蔽的假设保持一致。",
            "solution": "该问题要求推导并实现库仑对数 $\\ln \\Lambda$。这是等离子体物理学中的一个基本量，用于表征大量小角度散射事件的累积效应。\n\n**1. 从第一性原理推导**\n\n我们考虑一个质量为 $m_{\\mathrm{e}}$、电荷为 $-e$ 的电子，以相对速度 $v$ 经过一个电荷为 $+Ze$ 的准静态离子。相互作用由库仑势决定。在 Rutherford 散射框架中，电子的路径是一条双曲线。散射角 $\\theta$ 是初始速度矢量和最终速度矢量之间的夹角，它依赖于碰撞参数 $b$。碰撞参数是离子与电子初始速度矢量之间的垂直距离。\n\n等离子体中的扩散或能量交换速率通常由大量远距离、小角度碰撞的累积效应主导，而非罕见的、近距离、大角度碰撞。单次碰撞中，电子垂直于其初始运动方向的动量变化 $\\Delta p_{\\perp}$ 是一个关键量。对于纯库仑势，其表达式为：\n$$\n\\Delta p_{\\perp} = \\frac{Z e^2}{2 \\pi \\varepsilon_{0} v b}\n$$\n许多输运系数，如碰撞频率或电阻率，都与均方动量转移率成正比。为了计算这个值，需要将单次碰撞的效应对所有可能的碰撞参数进行积分。在路径长度 $dL$ 内，一个电子遇到的碰撞参数在 $b$ 和 $b+db$ 之间的离子数目由离子密度 $n_{\\mathrm{i}}$ 乘以圆柱壳层的体积 $(2 \\pi b \\, db) dL$ 给出。对于电荷为 $Z$ 的准中性等离子体，我们有 $n_{\\mathrm{e}} = Z n_{\\mathrm{i}}$。总效应与对碰撞参数 $b$ 的积分成正比：\n$$\n\\text{Total Effect} \\propto \\int (\\Delta p_{\\perp})^2 \\cdot (2 \\pi b \\, db) \\propto \\int \\left( \\frac{1}{b^2} \\right) b \\, db = \\int \\frac{db}{b}\n$$\n这个积分是对数发散的；当 $b \\to 0$ 和 $b \\to \\infty$ 时，它会趋于无穷大。这个非物理的结果被称为库仑灾难，其产生原因是纯 $1/r$ 势具有无限的作用范围并且在 $r=0$ 处无限强。在真实的等离子体中，物理效应为该积分在小碰撞参数和大碰撞参数两端都提供了自然的截断。\n\n**2. 截断：$b_{\\max}$ 和 $b_{\\min}$**\n\n**大碰撞参数截断 ($b_{\\max}$):**\n大 $b$ 处的发散问题可以通过考虑等离子体中的电荷会自行重排以屏蔽任何给定电荷的静电势来解决。一个测试电荷（离子）被一团移动电荷（主要是电子）云包围，这团电荷云在远距离处部分抵消了其电场。根据线性化 Poisson-Boltzmann 理论，裸库仑势 $\\phi(r) \\propto 1/r$ 被修正为屏蔽的 Debye-Hückel (或 Yukawa) 势：\n$$\n\\phi(r) \\propto \\frac{1}{r} e^{-r/\\lambda_{\\mathrm{D}}}\n$$\n其中 $\\lambda_{\\mathrm{D}}$ 是德拜长度。对于距离 $r \\gg \\lambda_{\\mathrm{D}}$，电势被指数级抑制。这有效地在德拜长度之外截断了库仑相互作用。因此，将最大有效碰撞参数 $b_{\\max}$ 设置为电子德拜长度是具有物理依据的。对于电子数密度为 $n_{\\mathrm{e}}$、电子温度为 $T_{\\mathrm{e}}$ 的等离子体，德拜长度由下式给出：\n$$\nb_{\\max} = \\lambda_{\\mathrm{D}} = \\sqrt{\\frac{\\varepsilon_{0} k_{\\mathrm{B}} T_{\\mathrm{e}}}{n_{\\mathrm{e}} e^{2}}}\n$$\n这里，$\\varepsilon_{0}$ 是真空介电常数，而 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n\n**小碰撞参数截断 ($b_{\\min}$):**\n小 $b$ 处的发散对应于导致大角度散射的近距离碰撞。这个问题可以通过两个不同的物理考虑来解决。\n\n**a) 经典截断 ($b_{90}$):** 对于非常小的碰撞参数，散射角 $\\theta$ 变得很大，用于推导积分形式的小角度近似失效。碰撞不再是一个小微扰。一种标准的经典方法是将最小碰撞参数设置为能够引起大角度（$90^{\\circ}$）散射的值。这个碰撞参数 $b_{90}$ 代表了“弱”经典碰撞与“强”经典碰撞之间的界限。对于 $90^\\circ$ 散射，最近垂直距离等于碰撞参数。此时，初始动能与势能大小相当。$b_{90}$ 的具体值由下式给出：\n$$\nb_{90} = \\frac{Z e^{2}}{4 \\pi \\varepsilon_{0} m_{\\mathrm{e}} v^{2}}\n$$\n\n**b) 量子力学截断 ($b_{\\mathrm{q}}$):** 从量子力学的角度来看，电子不能被局域化到比其热德布罗意波长 $\\lambda_{\\mathrm{deB}} = h/(m_{\\mathrm{e}}v)$ 更小的区域。当经典最近距离变得小于 $\\lambda_{\\mathrm{deB}}$ 时，波状的衍射效应将主导经典散射，经典轨道概念也随之失效。不确定性原理规定了粒子位置可以被定义的根本限制。因此，量子力学截断的一个常见选择与德布罗意波长有关。问题中将此截断指定为：\n$$\nb_{\\mathrm{q}} = \\frac{\\hbar}{2 m_{\\mathrm{e}} v}\n$$\n其中 $\\hbar = h/(2\\pi)$ 是约化普朗克常数。\n\n**有效最小碰撞参数 ($b_{\\min}$):**\n在小碰撞参数下的实际物理截断将是先发生的那一个，即取两个尺度中的较大者。如果 $b_{90}$ 较大，那么在大角度散射发生前，量子效应尚不重要。如果 $b_{\\mathrm{q}}  b_{90}$，那么在经典强碰撞发生之前，粒子的波性就已经使相互作用变得模糊。因此，有效最小碰撞参数是两者中的最大值：\n$$\nb_{\\min} = \\max(b_{90}, b_{\\mathrm{q}})\n$$\n\n**3. 库仑对数与最终算法**\n\n有了这些具有物理依据的截断，发散的积分就变为有限值：\n$$\n\\int_{b_{\\min}}^{b_{\\max}} \\frac{db}{b} = \\left[ \\ln(b) \\right]_{b_{\\min}}^{b_{\\max}} = \\ln\\left(\\frac{b_{\\max}}{b_{\\min}}\\right)\n$$\n这个无量纲量就是库仑对数，通常表示为 $\\ln\\Lambda$，其中 $\\Lambda = b_{\\max}/b_{\\min}$。它代表库仑碰撞中最大有效碰撞参数与最小有效碰撞参数之比。其基础理论适用于弱耦合等离子体，其中 $\\Lambda \\gg 1$，意味着近距离碰撞和集体屏蔽距离之间存在很大的尺度分离。如果计算得出 $b_{\\min} \\ge b_{\\max}$，则表明等离子体是强耦合的，推导所依据的假设失效，“多次弱碰撞”的概念也不再适用。在这种情况下，库仑对数达到饱和，按照惯例，其值通常取一个小数或直接取 $0$，正如问题陈述中所指定的那样。\n\n用于计算给定参数集 $(n_{\\mathrm{e}}, T_{\\mathrm{e}}, Z, v)$ 下 $\\ln\\Lambda$ 的完整算法如下：\n1.  确定相关的电子速度 $v$。如果输入 $v$ 为 $0$，则使用热速度 $v_{\\mathrm{th}} = \\sqrt{2 k_{\\mathrm{B}} T_{\\mathrm{e}} / m_{\\mathrm{e}}}$。否则，使用给定的 $v$。\n2.  使用给定公式计算最大碰撞参数 $b_{\\max} = \\lambda_{\\mathrm{D}}$。\n3.  使用给定公式和步骤 1 中得到的速度 $v$ 计算经典最小碰撞参数 $b_{90}$。\n4.  使用给定公式和步骤 1 中得到的速度 $v$ 计算量子最小碰撞参数 $b_{\\mathrm{q}}$。\n5.  确定有效最小碰撞参数 $b_{\\min} = \\max(b_{90}, b_{\\mathrm{q}})$。\n6.  比较截断值。如果 $b_{\\min} \\ge b_{\\max}$，则库仑对数为 $0$。\n7.  否则，计算库仑对数 $\\ln \\Lambda = \\ln(b_{\\max}/b_{\\min})$。\n该流程提供了一种在广泛物理条件下评估等离子体输运系数中主要对数项的稳健方法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Coulomb logarithm for electron-ion collisions in astrophysical\n    plasmas for a set of test cases.\n    \"\"\"\n    # Define physical constants in SI units.\n    e = 1.602176634e-19  # Elementary charge in C\n    m_e = 9.1093837015e-31 # Electron mass in kg\n    k_B = 1.380649e-23     # Boltzmann constant in J/K\n    epsilon_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    hbar = 1.054571817e-34  # Reduced Planck constant in J·s\n\n    # Define the test cases as tuples (n_e, T_e, Z, v_in).\n    # n_e: electron number density (m^-3)\n    # T_e: electron temperature (K)\n    # Z: ion charge state (dimensionless)\n    # v_in: relative speed (m/s), 0 indicates thermal speed should be used.\n    test_cases = [\n        (1.0e6, 1.0e4, 1, 0.0),                     # Case A: Interstellar medium\n        (1.0e26, 10.0, 1, 0.0),                    # Case B: Dense, cold (strong coupling limit)\n        (1.0e3, 1.0e8, 1, 0.0),                     # Case C: Intracluster medium\n        (1.0e12, 1.0e6, 1, 2.99792458e7),           # Case D: High speed (quantum cutoff)\n        (1.0e14, 1.0e5, 26, 0.0),                   # Case E: Heavy ion effect\n    ]\n\n    results = []\n    for n_e, T_e, Z, v_in in test_cases:\n        # Step 1: Determine the electron speed.\n        if v_in == 0.0:\n            # Avoid division by zero if T_e is 0, though not in test cases.\n            if T_e == 0.0:\n                v = 0.0\n            else:\n                # Use mean thermal speed for collisions: v_th = sqrt(2*k_B*T_e/m_e)\n                v = np.sqrt(2.0 * k_B * T_e / m_e)\n        else:\n            v = v_in\n\n        # If speed is zero, cutoffs are infinite/undefined. In a physical context,\n        # this would mean no collisions. The logarithm is ill-defined,\n        # but 0 is a reasonable result as the ratio of cutoffs is not  1.\n        if v == 0.0:\n            coulomb_log = 0.0\n            results.append(f\"{coulomb_log:.6f}\")\n            continue\n\n        # Step 2: Calculate the maximum impact parameter (Debye length).\n        # Handle potential division by zero for n_e, although not in test cases.\n        if n_e == 0.0:\n             b_max = np.inf\n        else:\n             b_max = np.sqrt(epsilon_0 * k_B * T_e / (n_e * e**2))\n\n        # Step 3: Calculate the classical minimum impact parameter (for 90-degree scatter).\n        b_90 = (Z * e**2) / (4.0 * np.pi * epsilon_0 * m_e * v**2)\n\n        # Step 4: Calculate the quantum mechanical minimum impact parameter.\n        b_q = hbar / (2.0 * m_e * v)\n\n        # Step 5: Determine the effective minimum impact parameter.\n        b_min = max(b_90, b_q)\n\n        # Step 6  7: Compare cutoffs and compute the Coulomb logarithm.\n        if b_min >= b_max:\n            # This occurs in strongly coupled plasmas where the underlying theory breaks down.\n            # The logarithm is saturated, and by convention is set to 0.\n            coulomb_log = 0.0\n        else:\n            coulomb_log = np.log(b_max / b_min)\n\n        # Ensure non-negative result, although log(ratio  1) is always positive.\n        if coulomb_log  0:\n            coulomb_log = 0.0\n\n        results.append(f\"{coulomb_log:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "计算出库仑对数本身并非最终目的，其真正的威力在于它能够连接微观碰撞过程与宏观输运现象。这项高级练习将带你进入磁化等离子体动力学的前沿，挑战你从朗之万方程出发，推导平行和垂直于磁场方向的粒子扩散系数$D_{\\parallel}$和$D_{\\perp}$。通过这个过程，你将清晰地看到，封装在碰撞频率$\\nu$中的库仑对数$\\ln\\Lambda$是如何决定性地影响各向异性输运的，这对于理解天体物理和聚变等离子体中的粒子与能量约束至关重要。",
            "id": "3961456",
            "problem": "考虑一个单组分、完全电离的等离子体，由质量为 $m$、电荷为 $q=Ze$、数密度为 $n$、温度为 $T$ 的粒子组成，该等离子体置于均匀磁场 $\\mathbf{B}=B \\,\\hat{\\mathbf{z}}$ 中。假设粒子间相互作用以屏蔽库仑（Rutherford）散射为主，因此小角度偏转累积产生速度空间扩散和阻力，其特征是碰撞频率为 $\\nu$，该频率依赖于库仑对数 $\\ln \\Lambda$。令回旋频率为 $\\Omega=|q|B/m$。在导心排序机制下进行研究，其中碰撞频率远小于回旋频率，即 $\\nu \\ll \\Omega$，并且快速的回旋运动被渐近消除，以获得缓慢的导心动力学。\n\n从第一性原理出发——即粒子运动的洛伦兹力定律和与温度 $T$ 下的热力学涨落-耗散相一致的库仑碰撞的随机表示——推导导心在平行和垂直于磁场方向上的长时间、构型空间扩散系数，分别记为 $D_{\\parallel}$ 和 $D_{\\perp}$。您的推导必须：\n\n- 从粒子速度在 $\\mathbf{B}$ 和库仑碰撞共同作用下的时间演化开始，并证明使用速率为 $\\nu$ 的线性、各向同性阻力以及由温度 $T$ 下的热平衡固定的零均值、$\\delta$相关的随机力的合理性。\n- 阐明导心近似如何通过对快速回旋相位和周期性拉莫尔位移进行平均来分离出缓慢的扩散运动。\n- 在平衡状态下使用统计平稳假设，将扩散张量与速度自相关联系起来，并在 $\\nu \\ll \\Omega$ 的极限下评估平行和垂直分量。\n\n将您的最终答案表示为 $D_{\\parallel}$ 和 $D_{\\perp}$ 关于 $m$、$k_B$、$T$、$\\nu$ 和 $\\Omega$ 的闭式解析表达式。您可以将 $\\nu$ 保留为符号形式。如果您选择使用包含 $\\ln \\Lambda$ 的库仑碰撞估计来写出 $\\nu$，请清楚地说明您所做的任何简化假设（例如，麦克斯韦背景下的自碰撞），并在必要时将常数保持为符号形式。最终答案必须以单个行矩阵的形式提供这两个扩散系数。无需进行数值计算。",
            "solution": "该问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一且有意义的解。这是一个等离子体动理学理论中的标准问题，需要应用已确立的原理，如洛伦兹力、碰撞的 Langevin 模型、涨落-耗散定理以及导心近似框架内的 Green-Kubo 关系。该问题被验证为合理且可解。\n\n一个质量为 $m$、电荷为 $q$ 的带电粒子在磁场 $\\mathbf{B}$ 中并受到碰撞的作用，其运动由关于粒子速度 $\\mathbf{v}$ 的 Langevin 方程描述：\n$$ m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B}) - \\mathbf{F}_{\\text{drag}} + \\mathbf{F}_{s}(t) $$\n问题规定，粒子间相互作用被建模为一个线性、各向同性的阻力 $\\mathbf{F}_{\\text{drag}} = m\\nu\\mathbf{v}$（其中 $\\nu$ 是一个恒定的碰撞频率）和一个零均值、$\\delta$相关的随机力 $\\mathbf{F}_s(t)$。这个 Langevin 模型是对更复杂的库仑碰撞 Fokker-Planck 方程的简化，但它抓住了速度空间扩散和阻力的核心物理。\n\n随机力 $\\mathbf{F}_s(t)$ 代表了来自单个碰撞的随机冲量。它被建模为一个平稳高斯白噪声过程，具有以下统计特性：\n$$ \\langle \\mathbf{F}_s(t) \\rangle = \\mathbf{0} $$\n$$ \\langle F_{s,i}(t) F_{s,j}(t') \\rangle = C \\delta_{ij} \\delta(t-t') $$\n其中 $i,j$ 是笛卡尔坐标指数，$\\delta_{ij}$ 是克罗内克 $\\delta$ 函数，$\\delta(t-t')$ 是狄拉克 $\\delta$ 函数。常数 $C$ 决定了噪声的强度。\n\n涨落-耗散定理规定了阻力（耗散，以 $\\nu$ 为特征）和随机力（涨落，以 $C$ 为特征）之间的关系，以确保系统能够弛豫到并维持在温度 $T$ 的热平衡状态。处于平衡状态的系统必须满足能量均分定理，即对于每个自由度 $i$，$\\langle \\frac{1}{2}mv_i^2 \\rangle = \\frac{1}{2}k_B T$。\n为了确定 $C$，我们可以分析与我们的 Langevin 方程相对应的 Fokker-Planck 方程。对于单个速度分量（例如 $v_z$），在没有磁场的情况下，方程为 $\\frac{\\partial f}{\\partial t} + \\frac{\\partial}{\\partial v_z}(-\\nu v_z f) = D_v \\frac{\\partial^2 f}{\\partial v_z^2}$，其中 $D_v$ 是速度空间扩散系数。稳态解（$\\frac{\\partial f}{\\partial t}=0$）为 $f(v_z) \\propto \\exp(-\\frac{\\nu v_z^2}{2D_v})$。这必须与 Maxwell-Boltzmann 分布 $f(v_z) \\propto \\exp(-\\frac{m v_z^2}{2k_B T})$ 相匹配。比较指数部分，得到速度空间中的爱因斯坦关系式：$D_v = \\frac{\\nu k_B T}{m}$。速度空间扩散系数与随机力项 $\\mathbf{A}(t) = \\mathbf{F}_s(t)/m$ 的强度通过 $2D_v = \\int_{-\\infty}^{\\infty} \\langle A_z(\\tau) A_z(0) \\rangle d\\tau$ 相关联。如果 $\\langle A_z(t) A_z(t') \\rangle = C_A \\delta(t-t')$，那么 $2D_v = C_A$，这意味着 $C_A = \\frac{2\\nu k_B T}{m}$。力的相关的强度则为 $C = m^2 C_A = 2m\\nu k_B T$。这正确地确定了随机力的振幅。\n\n当 $\\mathbf{B} = B\\hat{\\mathbf{z}}$ 且 $\\mathbf{A}(t) = \\mathbf{F}_s(t)/m$ 时，Langevin 方程变为：\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m}(\\mathbf{v} \\times \\mathbf{B}) - \\nu\\mathbf{v} + \\mathbf{A}(t) $$\n构型空间扩散张量 $\\mathbf{D}$ 由 Green-Kubo 公式给出，该公式将其与统计平稳状态下速度自相关函数（VAF）的积分联系起来：\n$$ \\mathbf{D} = \\int_0^\\infty \\langle \\mathbf{v}(t) \\otimes \\mathbf{v}(0) \\rangle dt $$\n问题要求的是导心的扩散。粒子的位置 $\\mathbf{r}$ 可以分解为导心位置 $\\mathbf{R}$ 和拉莫尔半径矢量 $\\boldsymbol{\\rho}$：$\\mathbf{r}(t) = \\mathbf{R}(t) + \\boldsymbol{\\rho}(t)$。位移为 $\\Delta\\mathbf{r}(t) = \\Delta\\mathbf{R}(t) + \\Delta\\boldsymbol{\\rho}(t)$。由 $\\boldsymbol{\\rho}(t)$ 描述的回旋运动是周期性的，其频率为 $\\Omega=|q|B/m$。在长时间极限 $t \\to \\infty$ 下，由回旋运动引起的位移 $\\Delta\\boldsymbol{\\rho}(t)$ 是有界的，而导心位移 $\\Delta\\mathbf{R}(t)$ 则呈扩散式增长。因此，粒子的长时间均方位移主要由其导心的均方位移决定，$\\langle |\\Delta\\mathbf{r}(t)|^2 \\rangle \\approx \\langle |\\Delta\\mathbf{R}(t)|^2 \\rangle$。因此，导心的扩散系数与粒子本身的扩散系数相同。\n\n我们现在计算 $\\mathbf{D}$ 的分量。令 $s = \\text{sgn}(q)$。\n平行运动与磁场解耦：\n$$ \\frac{dv_z}{dt} = -\\nu v_z + A_z(t) $$\n乘以 $v_z(0)$ 并求平均得到 $\\frac{d}{dt}\\langle v_z(t)v_z(0) \\rangle = -\\nu \\langle v_z(t)v_z(0) \\rangle$。对于 $t  0$，解为 $\\langle v_z(t)v_z(0) \\rangle = \\langle v_z(0)^2 \\rangle e^{-\\nu t}$。根据能量均分定理，$\\langle v_z(0)^2 \\rangle = k_B T / m$。平行方向的速度自相关函数（VAF）为：\n$$ \\langle v_z(t)v_z(0) \\rangle = \\frac{k_B T}{m} e^{-\\nu t} $$\n平行扩散系数 $D_{\\parallel} = D_{zz}$ 是此 VAF 的时间积分：\n$$ D_{\\parallel} = \\int_0^\\infty \\frac{k_B T}{m} e^{-\\nu t} dt = \\frac{k_B T}{m} \\left[ -\\frac{1}{\\nu} e^{-\\nu t} \\right]_0^\\infty = \\frac{k_B T}{m\\nu} $$\n\n垂直运动由以下耦合方程描述：\n$$ \\frac{dv_x}{dt} = s\\Omega v_y - \\nu v_x + A_x(t) $$\n$$ \\frac{dv_y}{dt} = -s\\Omega v_x - \\nu v_y + A_y(t) $$\n我们引入复速度 $v_\\perp(t) = v_x(t) + i v_y(t)$。方程合并为：\n$$ \\frac{dv_\\perp}{dt} = -is\\Omega v_\\perp - \\nu v_\\perp + A_\\perp(t) \\quad \\implies \\quad \\frac{dv_\\perp}{dt} + (\\nu + is\\Omega)v_\\perp = A_\\perp(t) $$\n其中 $A_\\perp = A_x + iA_y$。这个复变量的 VAF 为 $\\langle v_\\perp(t) v_\\perp^*(0) \\rangle = \\langle v_\\perp(0)^2 \\rangle e^{-(\\nu+is\\Omega)t}$。\n这里 $\\langle |v_\\perp|^2 \\rangle = \\langle v_x^2 + v_y^2 \\rangle = \\frac{k_B T}{m} + \\frac{k_B T}{m} = \\frac{2k_B T}{m}$。\n我们需要的 VAF 是实分量的，例如 $\\langle v_x(t)v_x(0) \\rangle$。我们注意到 $\\langle v_\\perp(t)v_\\perp^*(0) \\rangle = \\langle (v_x(t)+iv_y(t))(v_x(0)-iv_y(0)) \\rangle$。由于回旋对称性，$\\langle v_x(t)v_x(0) \\rangle = \\langle v_y(t)v_y(0) \\rangle$ 且 $\\langle v_x(t)v_y(0) \\rangle = -\\langle v_y(t)v_x(0) \\rangle$。因此，$\\text{Re}[\\langle v_\\perp(t)v_\\perp^*(0) \\rangle] = 2\\langle v_x(t)v_x(0) \\rangle$。\n$$ \\langle v_x(t)v_x(0) \\rangle = \\frac{1}{2} \\text{Re} \\left[ \\frac{2k_B T}{m} e^{-(\\nu+is\\Omega)t} \\right] = \\frac{k_B T}{m} e^{-\\nu t} \\text{Re}[e^{-is\\Omega t}] = \\frac{k_B T}{m} e^{-\\nu t} \\cos(s\\Omega t) $$\n由于 $\\cos$ 是偶函数，这等于 $\\frac{k_B T}{m} e^{-\\nu t} \\cos(\\Omega t)$。\n\n垂直扩散系数 $D_{\\perp} = D_{xx}$ 是此 VAF 的积分：\n$$ D_{\\perp} = \\int_0^\\infty \\frac{k_B T}{m} e^{-\\nu t} \\cos(\\Omega t) dt $$\n这是一个标准积分，结果为：\n$$ D_{\\perp} = \\frac{k_B T}{m} \\frac{\\nu}{\\nu^2 + \\Omega^2} $$\n在 Langevin 模型内，这个表达式是精确的。问题指定了导心排序机制，$\\nu \\ll \\Omega$。将此极限应用于我们的结果：\n平行扩散系数 $D_{\\parallel} = \\frac{k_B T}{m\\nu}$ 与 $\\Omega$ 无关，因此不受此极限的影响。\n在此极限下，垂直扩散系数变为：\n$$ D_{\\perp} = \\frac{k_B T}{m} \\frac{\\nu}{\\nu^2 + \\Omega^2} \\approx \\frac{k_B T}{m} \\frac{\\nu}{\\Omega^2} = \\frac{k_B T \\nu}{m \\Omega^2} $$\n这个结果表明，垂直扩散被磁场强烈抑制，其标度为 $1/B^2$（因为 $\\Omega \\propto B$），并且与碰撞频率成正比，因为每次碰撞都允许一个与拉莫尔半径相当的随机步长。\n\n碰撞频率 $\\nu$ 本身取决于等离子体参数。对于麦克斯韦等离子体中的自碰撞，一个标准的估计是 $\\nu \\propto n Z^4 (\\ln \\Lambda) m^{-1/2} (k_B T)^{-3/2}$，其中 $\\ln\\Lambda$ 是库仑对数。然而，根据问题陈述，我们将 $\\nu$ 保留为符号形式。\n\n在 $\\nu \\ll \\Omega$ 极限下，扩散系数的最终表达式为：\n平行方向：$D_{\\parallel} = \\frac{k_B T}{m\\nu}$\n垂直方向：$D_{\\perp} = \\frac{k_B T \\nu}{m \\Omega^2}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k_B T}{m \\nu}  \\frac{k_B T \\nu}{m \\Omega^2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}