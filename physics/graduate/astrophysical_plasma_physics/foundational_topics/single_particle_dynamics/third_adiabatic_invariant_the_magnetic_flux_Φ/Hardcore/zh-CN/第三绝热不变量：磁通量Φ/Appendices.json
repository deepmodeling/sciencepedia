{
    "hands_on_practices": [
        {
            "introduction": "要理解绝热不变量，首先要学会在关键物理场景中计算它们。这项练习聚焦于一个典型例子：一个带电粒子被捕获在偶极磁场中，这是行星磁层物理学的基础。通过计算第三绝热不变量 $\\Phi$，我们将这个抽象概念与麦克伊尔文 L 参数（McIlwain L-parameter）联系起来，后者是空间物理研究中一个实用的坐标。",
            "id": "571938",
            "problem": "一个非相对论性的带电粒子被捕获在一个静态点磁偶极子的磁场中。偶极矩的方向使得在球坐标系 $(r, \\theta, \\phi)$ 中的磁场没有方位角分量，$\\vec{B} = B_r(r, \\theta)\\hat{r} + B_\\theta(r, \\theta)\\hat{\\theta}$。在磁赤道（$\\theta = \\pi/2$）处，参考径向距离为 $R_0$ 时的磁场强度记为 $B_0$。\n\n在这个偶极子场中，磁力线由方程 $r = L R_0 \\sin^2\\theta$ 描述，其中 $L$ 是无量纲的 McIlwain L-参数，它标记了一组特定的被称为 L-壳层的嵌套磁面。\n\n一个被捕获粒子的引导中心沿着一条磁力线在两个磁镜点之间进行快速的反弹运动，并同时在方位角（$\\phi$）方向上缓慢漂移。这种组合运动将粒子限制在一个漂移壳层上，对于这个轴对称场，这个漂移壳层是由其 L-参数指定的磁力线旋转而成的曲面。\n\n第三绝热不变量，或称磁通量不变量 $\\Phi$，是粒子漂移壳层所包围的总磁通量。如果磁场在比粒子漂移周期慢得多的时间尺度上变化，这个量是近似守恒的。\n\n对于一个被捕获在由参数 $L$ 表征的漂移壳层上的粒子，计算第三绝热不变量 $\\Phi$。用 $L$、$B_0$ 和 $R_0$ 来表示你的答案。\n\n作为参考，该偶极子场的磁矢势，用给定参数表示为 $\\vec{A}(r, \\theta) = \\frac{B_0 R_0^3}{r^2} \\sin\\theta \\, \\hat{\\phi}$。",
            "solution": "1. 在轴对称场中，可以定义极向磁通函数 $\\Psi(r,\\theta)$ 如下：\n   $$\\vec B=\\nabla\\times\\bigl(\\Psi\\,\\hat\\phi\\bigr)\n     =\\nabla\\Psi\\times\\nabla\\phi\\,, $$\n   并将其与矢势的 $\\phi$ 分量通过以下方式联系起来：\n   $$A_\\phi=\\frac{\\Psi}{r\\sin\\theta}\\,. $$\n\n2. 给定\n   $$\\vec A(r,\\theta)=A_\\phi\\,\\hat\\phi\n     =\\frac{B_0R_0^3}{r^2}\\sin\\theta\\;\\hat\\phi,$$\n   我们有\n   $$\\Psi(r,\\theta)\n     =r\\sin\\theta\\;A_\\phi\n     =r\\sin\\theta\\;\\frac{B_0R_0^3}{r^2}\\sin\\theta\n     =B_0R_0^3\\,\\frac{\\sin^2\\theta}{r}\\,. $$\n\n3. 沿着一个 $L$ 恒定的偶极子磁力线，$r=L\\,R_0\\sin^2\\theta$，所以\n   $$\\Psi(L)\n     =B_0R_0^3\\,\\frac{\\sin^2\\theta}{L\\,R_0\\sin^2\\theta}\n     =\\frac{B_0R_0^2}{L}\\,. $$\n\n4. 漂移壳层所包围的总磁通量（第三不变量）是\n   $$\\Phi=2\\pi\\,\\Psi(L)\n           =2\\pi\\,\\frac{B_0R_0^2}{L}\\,. $$",
            "answer": "$$\\boxed{\\frac{2\\pi B_0R_0^2}{L}}$$"
        },
        {
            "introduction": "在学会计算磁通量不变量之后，下一步是利用其守恒性来预测粒子在缓慢变化的磁场中的行为。这个问题提出了一个经典的天体物理学情景：一颗行星的磁场在漫长的地质年代中逐渐减弱。这项练习展示了第三绝热不变量的预测能力，使我们无需解复杂的运动方程就能确定粒子的新轨道。",
            "id": "1236751",
            "problem": "一个带电粒子被捕获在行星磁层中，该磁层可以很好地用磁矩为 $\\vec{\\mathcal{M}}$ 的纯偶极子磁场来近似。该粒子执行三种不同的周期性运动：围绕磁力线的快速回旋运动、在磁镜点之间的中速反弹运动，以及围绕行星的缓慢方位漂移运动。对于磁场的缓慢变化，这些运动中的每一种都有一个相关的绝热不变量。\n\n我们感兴趣的是与慢速漂移运动相关的第三绝热不变量 $\\Phi$。对于偶极场，这个不变量可以定义为穿过粒子漂移轨道外部赤道平面区域的总磁通量。对于在赤道附近反射的粒子，其漂移轨道可以近似为赤道平面上半径为 $R$ 的圆。因此，该不变量由以下积分给出：\n$$\n\\Phi = \\int_R^\\infty B_{eq}(r) (2\\pi r) dr\n$$\n其中 $B_{eq}(r)$ 是赤道平面上距离偶极子中心径向距离为 $r$ 处的磁场大小。赤道平面上的磁场大小由下式给出：\n$$\nB_{eq}(r) = \\frac{\\mu_0 \\mathcal{M}}{4\\pi r^3}\n$$\n其中 $\\mathcal{M}$ 是行星磁偶极矩的大小，$\\mu_0$ 是真空磁导率。\n\n最初，粒子位于一个稳定的漂移壳上，该漂移壳在半径 $R_0$ 处与赤道平面相交，而行星的磁矩为 $\\mathcal{M}_0$。在一个比粒子漂移周期长得多的非常长的时间尺度上，行星的内部发电机效应减弱，导致其磁偶极矩绝热地减小到一个新值 $\\mathcal{M}_f = \\frac{1}{2}\\mathcal{M}_0$。\n\n假设第三绝热不变量 $\\Phi$ 在此过程中守恒，请导出一个用初始半径 $R_0$ 表示粒子漂移壳新赤道半径 $R_f$ 的表达式。",
            "solution": "我们从第三绝热不变量在赤道平面上的定义开始，\n$$\n\\Phi=\\int_R^\\infty B_{eq}(r)\\,(2\\pi r)\\,dr.\n$$\n代入偶极场 \n$$\nB_{eq}(r)=\\frac{\\mu_0\\,\\mathcal{M}}{4\\pi\\,r^3}\n$$\n得到\n$$\n\\Phi=\\int_R^\\infty\\frac{\\mu_0\\,\\mathcal{M}}{4\\pi\\,r^3}(2\\pi r)\\,dr\n=\\frac{\\mu_0\\,\\mathcal{M}}{2}\\int_R^\\infty r^{-2}\\,dr.\n$$\n计算积分：\n$$\n\\int_R^\\infty r^{-2}\\,dr=\\Bigl[-r^{-1}\\Bigr]_R^\\infty=\\frac{1}{R},\n$$\n所以\n$$\n\\Phi=\\frac{\\mu_0\\,\\mathcal{M}}{2R}.\n$$\n$\\Phi$ 守恒意味着\n$$\n\\frac{\\mu_0\\,\\mathcal{M}_0}{2R_0}\n=\\frac{\\mu_0\\,\\mathcal{M}_f}{2R_f},\n$$\n因此\n$$\n\\frac{\\mathcal{M}_0}{R_0}=\\frac{\\mathcal{M}_f}{R_f}\n\\quad\\Rightarrow\\quad\nR_f=R_0\\,\\frac{\\mathcal{M}_f}{\\mathcal{M}_0}.\n$$\n对于 $\\mathcal{M}_f=\\tfrac12\\mathcal{M}_0$，我们发现\n$$\nR_f=R_0\\cdot\\frac{\\tfrac12\\mathcal{M}_0}{\\mathcal{M}_0}\n=\\frac{R_0}{2}.\n$$",
            "answer": "$$\\boxed{\\frac{R_0}{2}}$$"
        },
        {
            "introduction": "要真正掌握磁通量的概念，必须将其与电磁学的基本原理联系起来，并能够在各种情况下进行计算。这最后一个练习从解析公式转向计算方法，挑战你利用斯托克斯定理从磁矢量势 $\\mathbf{A}$ 计算磁通量 $\\Phi$。通过为不同的磁场模型实现这一计算，你将在计算等离子体物理方面获得实用技能，并对第三绝热不变量的理论基础有更深的理解。",
            "id": "4234365",
            "problem": "考虑一个带电粒子在行星磁层赤道平面内，在一个轴对称、静磁场中进行缓慢的方位角引导中心漂移。在回旋和弹跳运动远快于方位角漂移的时间尺度分离下，第三绝热不变量是粒子漂移轮廓所包围的磁通量，记为 $\\Phi$。目标是仅使用经典电磁学的基本定义和经过充分检验的事实，为给定的轴对称场模型和赤道漂移轮廓半径计算 $\\Phi$。\n\n你必须构建一个完整的程序，对于给定的在赤道平面上定义的轴向分量为 $B_z(r)$ 的轴对称磁场模型，该程序返回穿过由圆形漂移路径界定的半径为 $R$ 的平面圆盘的磁通量 $\\Phi$。计算必须从第一性原理出发：利用满足 $\\nabla \\times \\mathbf{A} = \\mathbf{B}$ 的磁矢量势 $\\mathbf{A}$ 的存在性，并在轴对称条件下应用斯托克斯定理，将 $\\Phi$ 的评估简化为在半径为 $R$ 的圆形回路上定义的量。不允许使用任何启发式捷径；必须从基本定律和定义开始。\n\n物理单位：所有数值通量输出均以韦伯（特斯拉·平方米）表示。程序必须生成浮点数。此问题中无需报告角度。\n\n测试套件和模型规范：\n- 赤道磁场是轴对称的，其轴向分量 $B_z(r)$ 仅取决于柱坐标半径 $r$。\n- 为 $B_z(r)$ 实现两个科学上合理的模型：\n  1. 均匀轴向场：$B_z(r) = B_0$，其中 $B_0$ 是以特斯拉为单位的常数。\n  2. 一个随半径衰减的局部、有限、轴对称的轴向场：$B_z(r) = \\dfrac{B_0}{\\left(1 + \\left(\\dfrac{r}{a}\\right)^2\\right)^{3/2}}$，其中 $B_0$ 的单位是特斯拉，$a$ 的单位是米。这种函数形式在 $r=0$ 处是有限的，并在 $r$ 很大时以 $r^{-3}$ 的形式衰减，这会产生有限的总通量，并与局部电流系统产生的静磁场相一致。\n\n你的程序必须根据上述定义为以下每个测试用例计算 $\\Phi$，并将每个值以韦伯为单位的浮点数形式返回：\n- 用例 1（正常路径，均匀场）：$B_0 = 3.0 \\times 10^{-5}$ T, $R = 1.0 \\times 10^{6}$ m。\n- 用例 2（中等半径，局域场）：$B_0 = 5.0 \\times 10^{-5}$ T, $a = 3.0 \\times 10^{6}$ m, $R = a$。\n- 用例 3（边界情况，零半径，局域场）：$B_0 = 5.0 \\times 10^{-5}$ T, $a = 3.0 \\times 10^{6}$ m, $R = 0$。\n- 用例 4（大半径，接近饱和，局域场）：$B_0 = 5.0 \\times 10^{-5}$ T, $a = 3.0 \\times 10^{6}$ m, $R = 3.0 \\times 10^{7}$ m。\n- 用例 5（附加均匀场用例）：$B_0 = 1.0 \\times 10^{-5}$ T, $R = 5.0 \\times 10^{5}$ m。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如：\"[result1,result2,result3]\"。\n- 每个列表元素必须是韦伯单位的浮点数，格式化为六位有效数字（例如，\"1.23457e+03\" 或 \"0.000123456\"）。\n\n任务是为每个用例从第一性原理实现 $\\Phi$ 的计算，并以指定的单行格式输出数值结果。程序不应从用户读取任何输入；它必须是自包含的。",
            "solution": "问题要求计算穿过轴对称静磁场 $\\mathbf{B}$ 赤道平面内半径为 $R$ 的圆形圆盘的磁通量 $\\Phi$。计算必须从基本原理推导得出，即磁矢量势 $\\mathbf{A}$ 的定义和斯托克斯定理，而不是通过直接对磁场进行积分。\n\n**1. 基本定义与原理**\n\n穿过以边界曲线 $\\mathcal{C} = \\partial S$ 为界的开放曲面 $S$ 的磁通量 $\\Phi$ 定义为磁场 $\\mathbf{B}$ 的面积分：\n$$\n\\Phi = \\int_S \\mathbf{B} \\cdot d\\mathbf{S}\n$$\n其中 $d\\mathbf{S}$ 是矢量面元。\n\n在静磁学中，磁场是无散的，$\\nabla \\cdot \\mathbf{B} = 0$，这保证了它可以表示为磁矢量势 $\\mathbf{A}$ 的旋度：\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A}\n$$\n将此代入通量的定义中，得到：\n$$\n\\Phi = \\int_S (\\nabla \\times \\mathbf{A}) \\cdot d\\mathbf{S}\n$$\n根据斯托克斯定理，矢量场旋度的面积分等于该矢量场沿闭合边界曲线 $\\mathcal{C}$ 的线积分：\n$$\n\\Phi = \\oint_{\\mathcal{C}} \\mathbf{A} \\cdot d\\mathbf{l}\n$$\n该关系是计算的强制起点。\n\n**2. 赤道平面内轴对称场的推导**\n\n问题指定了一个轴对称磁场，该磁场关于 $z$ 轴的旋转对称。我们在柱坐标系 $(r, \\phi, z)$ 中进行计算。对于轴对称系统，方便选择一个规范，使得矢量势只有一个方位角分量，$\\mathbf{A} = A_\\phi(r, z) \\hat{\\mathbf{\\phi}}$。\n\n该矢量势的旋度为：\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A} = \\nabla \\times (A_\\phi \\hat{\\mathbf{\\phi}}) = -\\frac{\\partial A_\\phi}{\\partial z} \\hat{\\mathbf{r}} + \\frac{1}{r}\\frac{\\partial (r A_\\phi)}{\\partial r} \\hat{\\mathbf{z}}\n$$\n因此，磁场分量为 $B_r(r, z) = -\\frac{\\partial A_\\phi}{\\partial z}$ 和 $B_z(r, z) = \\frac{1}{r}\\frac{\\partial (r A_\\phi)}{\\partial r}$。\n\n问题指出，在赤道平面（$z=0$）中，磁场纯粹是轴向的：$\\mathbf{B}(r, \\phi, 0) = B_z(r) \\hat{\\mathbf{z}}$。这意味着在该平面内径向分量 $B_r$ 为零。根据我们对 $B_r$ 的表达式，这意味着：\n$$\nB_r(r, 0) = -\\left.\\frac{\\partial A_\\phi}{\\partial z}\\right|_{z=0} = 0\n$$\n此条件与赤道平面是产生该场的电流的对称平面相一致。我们的分析仅限于该平面，其中 $A_\\phi$ 可被视为仅是 $r$ 的函数，即 $A_\\phi(r) \\equiv A_\\phi(r, z=0)$。\n\n在赤道平面内，$B_z$ 和 $A_\\phi$ 之间的关系变成一个常微分方程：\n$$\nB_z(r) = \\frac{1}{r}\\frac{d(r A_\\phi(r))}{dr}\n$$\n我们可以通过重新排列并从轴（$r'=0$）积分到任意半径 $r$ 来求解 $A_\\phi(r)$：\n$$\nr' B_z(r') = \\frac{d(r' A_\\phi(r'))}{dr'}\n$$\n$$\n\\int_0^r r' B_z(r') dr' = \\int_0^r \\frac{d(r' A_\\phi(r'))}{dr'} dr' = [r' A_\\phi(r')]_0^r = r A_\\phi(r)\n$$\n其中我们施加了物理边界条件，即当 $r' \\to 0$ 时，$r'A_\\phi(r') \\to 0$。求解 $A_\\phi(r)$：\n$$\nA_\\phi(r) = \\frac{1}{r} \\int_0^r r' B_z(r') dr'\n$$\n现在，我们计算穿过赤道平面内半径为 $R$ 的圆形圆盘的通量 $\\Phi$。边界 $\\mathcal{C}$ 是一个半径为 $R$ 的圆。线元为 $d\\mathbf{l} = R\\,d\\phi\\,\\hat{\\mathbf{\\phi}}$。沿此路径的矢量势为 $\\mathbf{A}(R) = A_\\phi(R)\\,\\hat{\\mathbf{\\phi}}$。通量的线积分为：\n$$\n\\Phi = \\oint_{\\mathcal{C}} \\mathbf{A} \\cdot d\\mathbf{l} = \\int_0^{2\\pi} (A_\\phi(R)\\,\\hat{\\mathbf{\\phi}}) \\cdot (R\\,d\\phi\\,\\hat{\\mathbf{\\phi}}) = \\int_0^{2\\pi} R\\,A_\\phi(R)\\,d\\phi\n$$\n由于 $A_\\phi(R)$ 沿圆形路径是常数，我们有：\n$$\n\\Phi = 2\\pi R A_\\phi(R)\n$$\n代入我们对 $A_\\phi(R)$ 的表达式：\n$$\n\\Phi = 2\\pi R \\left( \\frac{1}{R} \\int_0^R r' B_z(r') dr' \\right) = 2\\pi \\int_0^R B_z(r') r' dr'\n$$\n这个最终表达式允许我们在给定赤道平面内轴向磁场分量 $B_z(r)$ 的情况下计算磁通量 $\\Phi$。\n\n**3. 对特定场模型的应用**\n\n我们现在将此通用公式应用于所提供的两个模型。\n\n**模型 1：均匀场**\n给定 $B_z(r) = B_0$，一个常数。\n$$\n\\Phi = 2\\pi \\int_0^R (B_0) r' dr' = 2\\pi B_0 \\left[ \\frac{r'^2}{2} \\right]_0^R = \\pi B_0 R^2\n$$\n这得到了一个基本结果，即通量是均匀场强与圆盘面积 $\\pi R^2$ 的乘积。\n\n**模型 2：局域场**\n给定 $B_z(r) = \\dfrac{B_0}{\\left(1 + \\left(\\frac{r}{a}\\right)^2\\right)^{3/2}}$。\n$$\n\\Phi = 2\\pi \\int_0^R \\frac{B_0}{\\left(1 + \\left(\\frac{r'}{a}\\right)^2\\right)^{3/2}} r' dr'\n$$\n为求解此积分，我们进行换元。令 $u = 1 + (r'/a)^2$。微分为 $du = \\frac{2r'}{a^2} dr'$，这给出 $r' dr' = \\frac{a^2}{2} du$。积分上下限变为 $u(0)=1$ 和 $u(R) = 1 + (R/a)^2$。\n$$\n\\Phi = 2\\pi B_0 \\int_{1}^{1+(R/a)^2} \\frac{1}{u^{3/2}} \\left(\\frac{a^2}{2} du\\right) = \\pi B_0 a^2 \\int_{1}^{1+(R/a)^2} u^{-3/2} du\n$$\n$$\n\\Phi = \\pi B_0 a^2 \\left[ \\frac{u^{-1/2}}{-1/2} \\right]_{1}^{1+(R/a)^2} = -2\\pi B_0 a^2 \\left[ u^{-1/2} \\right]_{1}^{1+(R/a)^2}\n$$\n$$\n\\Phi = -2\\pi B_0 a^2 \\left( \\frac{1}{\\sqrt{1 + (R/a)^2}} - 1 \\right)\n$$\n$$\n\\Phi = 2\\pi B_0 a^2 \\left( 1 - \\frac{1}{\\sqrt{1 + (R/a)^2}} \\right)\n$$\n该解析表达式将用于涉及局域场模型的计算。\n\n**4. 实现**\n\n推导出的公式，即均匀场的 $\\Phi = \\pi B_0 R^2$ 和局域场的 $\\Phi = 2\\pi B_0 a^2 \\left( 1 - \\left(1 + (R/a)^2\\right)^{-1/2} \\right)$，被以编程方式实现，以计算指定测试用例的通量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the magnetic flux for a set of test cases based on two field models,\n    derived from first principles using Stokes' theorem.\n    \"\"\"\n\n    def format_result(value):\n        \"\"\"Formats a floating-point number to six significant digits in scientific notation.\"\"\"\n        if value == 0.0:\n            return \"0.00000e+00\"\n        return f\"{value:.5e}\"\n\n    def phi_uniform(B0, R):\n        \"\"\"\n        Computes magnetic flux for a uniform axial magnetic field B_z(r) = B0.\n        Formula: Phi = pi * B0 * R^2\n        \n        Args:\n            B0 (float): Constant magnetic field strength in Tesla.\n            R (float): Radius of the circular drift path in meters.\n        \n        Returns:\n            float: Magnetic flux in Webers.\n        \"\"\"\n        return np.pi * B0 * R**2\n\n    def phi_localized(B0, a, R):\n        \"\"\"\n        Computes magnetic flux for a localized axial magnetic field\n        B_z(r) = B0 / (1 + (r/a)^2)^(3/2).\n        Formula: Phi = 2 * pi * B0 * a^2 * (1 - 1/sqrt(1 + (R/a)^2))\n        \n        Args:\n            B0 (float): Magnetic field strength parameter in Tesla.\n            a (float): Radial scale length in meters.\n            R (float): Radius of the circular drift path in meters.\n        \n        Returns:\n            float: Magnetic flux in Webers.\n        \"\"\"\n        if R == 0:\n            return 0.0\n        \n        # To avoid division by zero if a=0, though not in test cases\n        if a == 0:\n            return 0.0\n\n        ratio_sq = (R / a)**2\n        term = 1.0 / np.sqrt(1.0 + ratio_sq)\n        return 2.0 * np.pi * B0 * a**2 * (1.0 - term)\n\n    # Test suite and model specifications from the problem statement.\n    # Each tuple represents a test case with its parameters.\n    # The first element of the tuple is the model name ('uniform' or 'localized').\n    test_cases = [\n        # Case 1 (happy path, uniform): B0 = 3.0e-5 T, R = 1.0e6 m.\n        ('uniform', {'B0': 3.0e-5, 'R': 1.0e6}),\n        # Case 2 (moderate radius, localized): B0 = 5.0e-5 T, a = 3.0e6 m, R = a.\n        ('localized', {'B0': 5.0e-5, 'a': 3.0e6, 'R': 3.0e6}),\n        # Case 3 (edge case, zero radius, localized): B0 = 5.0e-5 T, a = 3.0e6 m, R = 0.\n        ('localized', {'B0': 5.0e-5, 'a': 3.0e6, 'R': 0.0}),\n        # Case 4 (large radius, near saturation, localized): B0 = 5.0e-5 T, a = 3.0e6 m, R = 3.0e7 m.\n        ('localized', {'B0': 5.0e-5, 'a': 3.0e6, 'R': 3.0e7}),\n        # Case 5 (additional uniform case): B0 = 1.0e-5 T, R = 5.0e5 m.\n        ('uniform', {'B0': 1.0e-5, 'R': 5.0e5}),\n    ]\n\n    results = []\n    for model, params in test_cases:\n        if model == 'uniform':\n            flux = phi_uniform(params['B0'], params['R'])\n        elif model == 'localized':\n            flux = phi_localized(params['B0'], params['a'], params['R'])\n        else:\n            # This case should not be reached with the current setup.\n            raise ValueError(f\"Unknown model: {model}\")\n        \n        results.append(flux)\n\n    formatted_results = [format_result(res) for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}