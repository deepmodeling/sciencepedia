{
    "hands_on_practices": [
        {
            "introduction": "磁矩 $\\mu$ 的守恒对于粒子在空间变化磁场中的动力学有直接影响。这个实践问题  提供了一个应用 $\\mu$ 不变性的基础练习，用于确定当粒子穿过磁场梯度时，其垂直速度和梯度-$B$漂移如何演化。掌握这种计算对于理解行星磁层和日冕环等环境中的粒子俘获和输运至关重要。",
            "id": "4215537",
            "problem": "考虑一个非相对论性的、电荷为 $q$、质量为 $m$ 的单电荷离子，该离子位于一个代表日冕环的磁化天体物理等离子体中。磁感应场为 $\\boldsymbol{B}(x) = B(x)\\,\\hat{\\boldsymbol{z}}$，其中 $B(x)$ 随横向坐标 $x$ 缓慢单调变化，$\\hat{\\boldsymbol{z}}$ 是一个固定的单位向量。假设该场是静磁场，并且在空间上是缓变的，其精确含义是离子的拉莫尔半径和回旋周期远小于 $B(x)$ 的特征尺度，因此导心理论适用。离子的导心通过某种外部施加的横场漂移（例如，由外部施加的电场（E）产生的漂移）绝热地从 $x=x_{0}$ 输运到 $x=x_{1}$，穿过梯度区，且电场（E）没有任何平行于 $\\boldsymbol{B}$ 的分量；因此磁力不对粒子做功。\n\n在 $x=x_{0}$ 处，离子的垂直速度为 $v_{\\perp 0}$，场强大小为 $B_{0} \\equiv B(x_{0})$。在最终位置的局域磁场大小为 $B_{1} \\equiv B(x_{1})$。梯度是均匀的，$\\partial B/\\partial x = \\alpha > 0$，因此 $B(x_{1}) = B_{0} + \\alpha\\,(x_{1}-x_{0})$。你可以假设在运动过程中，第一绝热不变量（磁矩）是守恒的。\n\n仅从带电粒子在静磁场中的基本运动定律和在所述条件下第一绝热不变量守恒出发，推导：\n\n1. 用 $v_{\\perp 0}$、$B_{0}$ 和 $B(x_{1})$ 表示的最终位置垂直速度 $v_{\\perp}(x_{1})$ 的表达式。\n2. 对于几何结构为 $\\boldsymbol{B}(x) = B(x)\\,\\hat{\\boldsymbol{z}}$ 且 $\\nabla B = \\alpha\\,\\hat{\\boldsymbol{x}}$ 的情况，在 $x_{1}$ 处与在 $x_{0}$ 处的梯度B漂移速度大小之比的表达式。\n\n将你的最终答案表示为一个行矩阵，按顺序包含上面推导出的两个解析表达式。不需要进行数值计算。如果你选择进行数值计算，请以米/秒为单位报告任何速度，并四舍五入到四位有效数字。",
            "solution": "所述问题在科学上基于天体物理等离子体物理学的原理，特别是导心理论。该问题提法恰当，有足够的信息来推导所要求的量，并且没有矛盾或含糊之处。在标准等离子体模型的背景下，其前提是物理上现实的。因此，该问题是有效的，并将提供解答。\n\n根据要求，分析分两部分进行。\n\n### 第1部分：垂直速度 $v_{\\perp}(x_{1})$ 的推导\n\n问题陈述，在粒子运动过程中，第一绝热不变量，即磁矩 $\\mu$，是守恒的。带电粒子在磁场中回旋的磁矩由其垂直动能与磁场强度之比给出：\n$$ \\mu = \\frac{\\frac{1}{2} m v_{\\perp}^2}{B} $$\n其中 $m$ 是粒子的质量，$v_{\\perp}$ 是其垂直于磁场 $\\boldsymbol{B}$ 的速度，$B=|\\boldsymbol{B}|$ 是磁场的大小。\n\n$\\mu$ 的守恒意味着其在初始位置 $x_{0}$ 的值等于其在最终位置 $x_{1}$ 的值。\n设初始状态用下标 $0$ 表示，最终状态用下标 $1$ 表示。已知条件是：\n-   在 $x=x_{0}$ 处：垂直速度为 $v_{\\perp 0}$，磁场大小为 $B_{0} = B(x_{0})$。\n-   在 $x=x_{1}$ 处：垂直速度为 $v_{\\perp}(x_{1})$，磁场大小为 $B(x_{1})$。\n\n初始位置的磁矩是：\n$$ \\mu_{0} = \\frac{m v_{\\perp 0}^2}{2 B_{0}} $$\n最终位置的磁矩是：\n$$ \\mu_{1} = \\frac{m (v_{\\perp}(x_{1}))^2}{2 B(x_{1})} $$\n\n根据绝热不变量原理，$\\mu_{0} = \\mu_{1}$：\n$$ \\frac{m v_{\\perp 0}^2}{2 B_{0}} = \\frac{m (v_{\\perp}(x_{1}))^2}{2 B(x_{1})} $$\n两边消去 $\\frac{m}{2}$ 项，得到：\n$$ \\frac{v_{\\perp 0}^2}{B_{0}} = \\frac{(v_{\\perp}(x_{1}))^2}{B(x_{1})} $$\n我们现在可以解出最终的垂直速度 $v_{\\perp}(x_{1})$：\n$$ (v_{\\perp}(x_{1}))^2 = v_{\\perp 0}^2 \\frac{B(x_{1})}{B_{0}} $$\n取平方根（速度为非负值）得到所需的表达式：\n$$ v_{\\perp}(x_{1}) = v_{\\perp 0} \\sqrt{\\frac{B(x_{1})}{B_{0}}} $$\n这个结果表明，当离子进入磁场更强的区域时，其垂直速度会增加，从而使比率 $\\frac{v_{\\perp}^2}{B}$ 保持恒定。\n\n### 第2部分：梯度B漂移速度之比\n\n梯度B漂移速度 $\\boldsymbol{v}_{\\nabla B}$ 是导心在非均匀磁场中经历的一种基本漂移。它由以下公式给出：\n$$ \\boldsymbol{v}_{\\nabla B} = \\frac{\\mu}{q} \\frac{\\boldsymbol{B} \\times \\nabla B}{B^2} $$\n其中 $q$ 是粒子的电荷。代入 $\\mu$ 的表达式：\n$$ \\boldsymbol{v}_{\\nabla B} = \\frac{1}{q} \\left( \\frac{m v_{\\perp}^2}{2 B} \\right) \\frac{\\boldsymbol{B} \\times \\nabla B}{B^2} = \\frac{m v_{\\perp}^2}{2 q} \\frac{\\boldsymbol{B} \\times \\nabla B}{B^3} $$\n对于这一部分，问题指明了磁场及其梯度的几何结构：\n$$ \\boldsymbol{B}(x) = B(x)\\,\\hat{\\boldsymbol{z}} $$\n$$ \\nabla B = \\alpha\\,\\hat{\\boldsymbol{x}} \\quad (\\text{其中 } \\alpha \\text{ 是一个正常数}) $$\n首先，我们计算叉积 $\\boldsymbol{B} \\times \\nabla B$：\n$$ \\boldsymbol{B} \\times \\nabla B = \\left( B(x)\\,\\hat{\\boldsymbol{z}} \\right) \\times \\left( \\alpha\\,\\hat{\\boldsymbol{x}} \\right) = \\alpha B(x) (\\hat{\\boldsymbol{z}} \\times \\hat{\\boldsymbol{x}}) = \\alpha B(x)\\,\\hat{\\boldsymbol{y}} $$\n现在，将此结果代回 $\\boldsymbol{v}_{\\nabla B}$ 的表达式中：\n$$ \\boldsymbol{v}_{\\nabla B} = \\frac{m v_{\\perp}^2}{2 q} \\frac{\\alpha B(x)\\,\\hat{\\boldsymbol{y}}}{(B(x))^3} = \\frac{m v_{\\perp}^2 \\alpha}{2 q (B(x))^2}\\,\\hat{\\boldsymbol{y}} $$\n梯度B漂移速度的大小，我们记为 $v_{\\nabla B}$，是标量系数的绝对值：\n$$ v_{\\nabla B}(x) = |\\boldsymbol{v}_{\\nabla B}| = \\left| \\frac{m v_{\\perp}^2 \\alpha}{2 q (B(x))^2} \\right| = \\frac{m v_{\\perp}^2 \\alpha}{2 |q| (B(x))^2} $$\n因为 $m$、$\\alpha$ 和 $v_{\\perp}^2$ 是非负的。\n\n我们需要求出在 $x_{1}$ 处与在 $x_{0}$ 处此漂移的大小之比。\n在位置 $x_{0}$ 处：\n$$ v_{\\nabla B, 0} = \\frac{m v_{\\perp 0}^2 \\alpha}{2 |q| B_{0}^2} $$\n在位置 $x_{1}$ 处：\n$$ v_{\\nabla B, 1} = \\frac{m (v_{\\perp}(x_{1}))^2 \\alpha}{2 |q| (B(x_{1}))^2} $$\n比值为：\n$$ \\frac{v_{\\nabla B, 1}}{v_{\\nabla B, 0}} = \\frac{\\frac{m (v_{\\perp}(x_{1}))^2 \\alpha}{2 |q| (B(x_{1}))^2}}{\\frac{m v_{\\perp 0}^2 \\alpha}{2 |q| B_{0}^2}} $$\n消去常数项 $\\frac{m \\alpha}{2 |q|}$，我们得到：\n$$ \\frac{v_{\\nabla B, 1}}{v_{\\nabla B, 0}} = \\frac{(v_{\\perp}(x_{1}))^2 / (B(x_{1}))^2}{v_{\\perp 0}^2 / B_{0}^2} = \\left( \\frac{v_{\\perp}(x_{1})}{v_{\\perp 0}} \\right)^2 \\left( \\frac{B_{0}}{B(x_{1})} \\right)^2 $$\n从第1部分，我们有关系式 $(v_{\\perp}(x_{1}))^2 = v_{\\perp 0}^2 \\frac{B(x_{1})}{B_{0}}$。将其代入比值中：\n$$ \\frac{v_{\\nabla B, 1}}{v_{\\nabla B, 0}} = \\frac{v_{\\perp 0}^2 \\frac{B(x_{1})}{B_{0}}}{v_{\\perp 0}^2} \\left( \\frac{B_{0}}{B(x_{1})} \\right)^2 = \\frac{B(x_{1})}{B_{0}} \\frac{B_{0}^2}{(B(x_{1}))^2} = \\frac{B_{0}}{B(x_{1})} $$\n因此，梯度B漂移速度之比与磁场强度之比成反比。\n\n所求的两个表达式是：\n1.  $v_{\\perp}(x_{1}) = v_{\\perp 0} \\sqrt{\\frac{B(x_{1})}{B_{0}}}$\n2.  $\\frac{v_{\\nabla B, 1}}{v_{\\nabla B, 0}} = \\frac{B_{0}}{B(x_{1})}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} v_{\\perp 0} \\sqrt{\\frac{B(x_{1})}{B_{0}}}  \\frac{B_{0}}{B(x_{1})} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "绝热理论的一个关键方面是理解哪些物理过程能够保持不变量，而哪些过程会破坏它。这个练习  挑战您批判性地思考平行电场（它会改变粒子的总能量）的影响。通过分析其潜在的动力学机制，您将阐明平行和垂直能量交换之间的关键区别，并巩固您对 $\\mu$ 守恒所需条件的理解。",
            "id": "4215564",
            "problem": "一个电荷为 $q$、静止质量为 $m$ 的带电粒子在磁化的天体物理等离子体中运动，其中磁场 $\\mathbf{B}(\\mathbf{x},t)$ 的大小 $B$ 沿着磁场线在特征长度 $L$ 上平滑变化，并可能在特征时间尺度 $\\tau$ 上随时间变化。存在一个电场 $\\mathbf{E}(\\mathbf{x},t)$，其平行于磁场的分量 $E_{\\parallel} \\equiv \\mathbf{E}\\cdot \\hat{\\mathbf{b}}$（其中 $\\hat{\\mathbf{b}} \\equiv \\mathbf{B}/B$）非零且缓慢变化，而垂直分量 $E_{\\perp}$ 在 $|E_{\\perp}|\\ll v_{\\perp} B$ 的意义上可以忽略，并且在回旋频率附近没有显著的功率。粒子的回旋运动频率为 $\\Omega \\equiv |q|B/m$（为简洁起见，使用非相对论性记法），其回旋半径为 $\\rho \\equiv v_{\\perp}/\\Omega$，并且绝热序关系成立：$\\epsilon \\equiv \\rho/L \\ll 1$ 且 $\\Omega \\tau \\gg 1$。假设场足够平滑，使得引导中心理论适用，并且碰撞和辐射反作用可以忽略不计。\n\n仅从洛伦兹力定律 $m\\,d\\mathbf{v}/dt = q(\\mathbf{E}+\\mathbf{v}\\times \\mathbf{B})$、能量平衡 $d( \\tfrac{1}{2} m v^2)/dt = q\\,\\mathbf{v}\\cdot \\mathbf{E}$ 以及当外部参数缓慢变化时，与快速周期性自由度相关的作量积分是一个绝热不变量这一普遍原理出发，推断一个对粒子做功的缓慢变化的 $E_{\\parallel}$ 如何影响与回旋运动相关的第一个绝热不变量。特别地，考虑一个粒子在存在沿场线坐标 $s$ 定义的静电势 $\\Phi(s)$（因此 $E_{\\parallel}=-\\partial \\Phi/\\partial s$）且 $E_{\\perp}\\approx 0$ 的情况下，从磁场为 $B_1$ 的区域移动到磁场更强的区域 $B_2B_1$。\n\n在上述序关系下，以下哪个陈述是正确的？选择所有适用的选项。\n\nA. 在 $\\epsilon$ 的主导阶且当 $\\Omega \\tau \\gg 1$ 时，尽管 $q E_{\\parallel} v_{\\parallel}$ 改变了粒子的动能，但第一个绝热不变量仍然守恒，因为功被限制在平行自由度上，不改变快速回旋运动的作量。\n\nB. 任何非零的 $E_{\\parallel}$ 都会导致第一个绝热不变量以 $\\propto E_{\\parallel} v_{\\parallel}/B$ 的速率长期增长，因为总动能的增加必然会增加磁矩。\n\nC. 在时变场中，第一个绝热不变量的改变是通过法拉第定律由 $\\partial \\mathbf{B}/\\partial t$ 感应出的垂直电场或通过回旋共振涨落发生的；缓慢变化的 $E_{\\parallel}$ 本身不会破坏回旋运动的绝热不变性。\n\nD. 在具有静态 $E_{\\parallel}(s)=-\\partial \\Phi/\\partial s$ 的静态非均匀磁场 $B(s)$ 中，相对于 $E_{\\parallel}=0$ 的情况，磁镜点的位置通常会移动，但只要 $\\rho/L \\ll 1$，第一个绝热不变量沿轨道保持守恒。\n\nE. 对于相对论性粒子，任何非零 $E_{\\parallel}\\neq 0$ 的存在都会破坏第一个绝热不变量的守恒，即使场是静态且缓慢变化的，因为 $E_{\\parallel}$ 改变了总能量。",
            "solution": "问题要求评估关于缓慢变化的平行电场 $E_{\\parallel}$ 对磁化等离子体中带电粒子的第一个绝热不变量 $\\mu$ 的影响的几个陈述。分析将首先在指定条件下推导 $\\mu$ 的变化率，然后用这个结果来评估每个陈述。\n\n第一个绝热不变量，或称磁矩 $\\mu$，定义为与粒子回旋运动相关的动能与磁场强度之比：\n$$\n\\mu \\equiv \\frac{K_{\\perp}}{B} = \\frac{\\frac{1}{2} m v_{\\perp}^2}{B}\n$$\n其中 $K_{\\perp}$ 是垂直于磁场 $\\mathbf{B}$ 方向上的动能，$v_{\\perp}$ 是粒子在垂直平面上的速率，$m$ 是粒子质量，$B$ 是磁场的大小。\n\n我们希望计算 $\\mu$ 沿粒子轨道的全时间导数。使用链式法则，我们有：\n$$\n\\frac{d\\mu}{dt} = \\frac{d}{dt}\\left(\\frac{K_{\\perp}}{B}\\right) = \\frac{1}{B}\\frac{dK_{\\perp}}{dt} - \\frac{K_{\\perp}}{B^2}\\frac{dB}{dt}\n$$\n为了继续，我们需要 $\\frac{dK_{\\perp}}{dt}$ 和 $\\frac{dB}{dt}$ 的表达式。\n\n粒子引导中心所经历的磁场强度的全时间导数由随流导数给出：\n$$\n\\frac{dB}{dt} = \\frac{\\partial B}{\\partial t} + \\mathbf{v}_G \\cdot \\nabla B\n$$\n其中 $\\mathbf{v}_G$ 是引导中心速度。在绝热近似的主导阶，引导中心速度由其平行分量主导，$\\mathbf{v}_G \\approx v_{\\parallel}\\hat{\\mathbf{b}}$，其中 $\\hat{\\mathbf{b}}=\\mathbf{B}/B$。因此，\n$$\n\\frac{dB}{dt} \\approx \\frac{\\partial B}{\\partial t} + v_{\\parallel} \\hat{\\mathbf{b}} \\cdot \\nabla B = \\frac{\\partial B}{\\partial t} + v_{\\parallel} \\nabla_{\\parallel} B\n$$\n其中 $\\nabla_{\\parallel}$ 表示沿磁场的梯度分量。\n\n接下来，我们求垂直动能的变化率 $\\frac{dK_{\\perp}}{dt}$。粒子的总动能是 $K = K_{\\perp} + K_{\\parallel}$，其中 $K_{\\parallel} = \\frac{1}{2} m v_{\\parallel}^2$。总动能的变化率由电场做的功给出，如问题所述：\n$$\n\\frac{dK}{dt} = q \\mathbf{v} \\cdot \\mathbf{E} = q (v_{\\parallel} \\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}) \\cdot (E_{\\parallel}\\hat{\\mathbf{b}} + \\mathbf{E}_{\\perp}) = q v_{\\parallel} E_{\\parallel} + q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}\n$$\n我们可以写出 $\\frac{dK_{\\perp}}{dt} = \\frac{dK}{dt} - \\frac{dK_{\\parallel}}{dt}$。平行动能的变化率是 $\\frac{dK_{\\parallel}}{dt} = m v_{\\parallel} \\frac{dv_{\\parallel}}{dt}$。运动方程的平行分量，在一个回旋轨道上取平均，即为引导中心的平行运动方程：\n$$\nm \\frac{dv_{\\parallel}}{dt} = q E_{\\parallel} - \\mu \\nabla_{\\parallel} B + \\text{higher order terms}\n$$\n这个方程描述了平行速度如何因平行电场和磁镜力（$-\\mu \\nabla_{\\parallel} B$）而变化。因此，\n$$\n\\frac{dK_{\\parallel}}{dt} = v_{\\parallel} \\left( m \\frac{dv_{\\parallel}}{dt} \\right) = q v_{\\parallel} E_{\\parallel} - \\mu v_{\\parallel} \\nabla_{\\parallel} B\n$$\n现在，我们可以求出 $\\frac{dK_{\\perp}}{dt}$：\n$$\n\\frac{dK_{\\perp}}{dt} = \\frac{dK}{dt} - \\frac{dK_{\\parallel}}{dt} = (q v_{\\parallel} E_{\\parallel} + q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}) - (q v_{\\parallel} E_{\\parallel} - \\mu v_{\\parallel} \\nabla_{\\parallel} B)\n$$\n包含 $E_{\\parallel}$ 的项完全抵消：\n$$\n\\frac{dK_{\\perp}}{dt} = q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} + \\mu v_{\\parallel} \\nabla_{\\parallel} B\n$$\n这个关键结果表明，在主导阶上，由平行电场做的功 $q v_{\\parallel} E_{\\parallel}$ 只改变平行动能，而不影响垂直动能。$K_{\\perp}$ 的变化是由于任何垂直电场做的功以及当粒子在空间变化的磁场中运动时，通过磁镜力在平行和垂直运动之间转换的能量。\n\n将我们关于 $\\frac{dK_{\\perp}}{dt}$ 和 $\\frac{dB}{dt}$ 的表达式代入 $\\frac{d\\mu}{dt}$ 的方程中：\n$$\n\\frac{d\\mu}{dt} = \\frac{1}{B}(q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} + \\mu v_{\\parallel} \\nabla_{\\parallel} B) - \\frac{\\mu B}{B^2}\\left(\\frac{\\partial B}{\\partial t} + v_{\\parallel} \\nabla_{\\parallel} B\\right)\n$$\n$$\n\\frac{d\\mu}{dt} = \\frac{q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}}{B} + \\frac{\\mu v_{\\parallel} \\nabla_{\\parallel} B}{B} - \\frac{\\mu}{B}\\frac{\\partial B}{\\partial t} - \\frac{\\mu v_{\\parallel} \\nabla_{\\parallel} B}{B}\n$$\n包含 $v_{\\parallel}\\nabla_{\\parallel}B$ 的项抵消，剩下：\n$$\n\\frac{d\\mu}{dt} = \\frac{q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}}{B} - \\frac{\\mu}{B}\\frac{\\partial B}{\\partial t}\n$$\n对快速回旋运动进行平均，$\\langle \\frac{d\\mu}{dt} \\rangle$ 由回旋平均的垂直功和与 $\\frac{\\partial B}{\\partial t}$ 相关的感应电场决定。问题陈述 $\\mathbf{E}_{\\perp}$ 在回旋频率附近没有显著功率，这意味着 $\\langle q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp} \\rangle \\approx 0$。如果场是静态的（$\\frac{\\partial B}{\\partial t} = 0$），那么 $\\frac{d\\mu}{dt}=0$。\n关键的发现是 $\\frac{d\\mu}{dt}$ 的表达式不包含 $E_{\\parallel}$。因此，一个缓慢变化的平行电场本身不会破坏第一个绝热不变量 $\\mu$ 的守恒性。\n\n有了这个理解，我们来评估每个选项。\n\nA. 这个陈述与我们的推导完全一致。$E_{\\parallel}$ 做的功通过改变 $K_{\\parallel}$ 来改变总动能，但在主导阶上，它不改变 $K_{\\perp}$。由于 $\\mu$ 是 $K_{\\perp}$ 和 $B$ 的函数，并且与回旋运动的作量成正比，所以它保持守恒。条件 $\\epsilon \\equiv \\rho/L \\ll 1$ 和 $\\Omega \\tau \\gg 1$ 是标准的绝热条件。\n结论：**正确**。\n\nB. 这个陈述基于一个错误的前提。总动能（$K = K_{\\perp} + K_{\\parallel}$）的增加并不必然导致 $K_{\\perp}$ 的增加，因此也不必然增加 $\\mu$。如推导所示，来自 $E_{\\parallel}$ 的能量增益被导入到 $K_{\\parallel}$ 中，而不是 $K_{\\perp}$。我们最终的 $d\\mu/dt$ 表达式中没有与 $E_{\\parallel}$ 成正比的项。\n结论：**不正确**。\n\nC. 这个陈述准确地总结了 $\\mu$ 可以改变的方式。在我们推导的 $d\\mu/dt$ 方程中，项 $-\\frac{\\mu}{B}\\frac{\\partial B}{\\partial t}$ 解释了来自时变 $\\mathbf{B}$ 的感应电场（电子感应加速）。项 $\\frac{q \\mathbf{v}_{\\perp} \\cdot \\mathbf{E}_{\\perp}}{B}$ 解释了由于任何其他垂直电场引起的变化，如果这些电场与回旋运动共振（回旋共振），则最为有效。该陈述正确地得出结论，即缓慢变化的 $E_{\\parallel}$ 本身不是破坏 $\\mu$ 守恒的原因。\n结论：**正确**。\n\nD. 这个选项描述了一个具有静态场（$E_{\\perp} \\approx 0$, $\\partial/\\partial t = 0$）的特定情景。在这种情况下，我们推导的方程得出 $d\\mu/dt = 0$，所以 $\\mu$ 是守恒的。粒子在静电势 $\\Phi(s)$ 中的能量守恒由其总能量 $W = K + q\\Phi(s) = K_{\\perp} + K_{\\parallel} + q\\Phi(s)$ 的守恒给出。由于 $\\mu=K_{\\perp}/B$ 是常数，我们可以写成 $W = \\mu B(s) + \\frac{1}{2}m v_{\\parallel}^2(s) + q\\Phi(s)$。磁镜点 $s_m$ 由条件 $v_{\\parallel}(s_m)=0$ 定义。因此，磁镜点必须满足 $W = \\mu B(s_m) + q\\Phi(s_m)$。在没有平行电场的情况下（$\\Phi(s)=\\text{constant}$，比如 $0$），磁镜点 $s_{m0}$ 出现在动能 $K_0=\\mu B(s_{m0})$ 的地方。磁镜点的条件明确地依赖于电势 $\\Phi(s)$，因此 $E_{\\parallel}$ 的存在通常会使其位置发生移动。该陈述完全正确。\n结论：**正确**。\n\nE. 这个陈述将问题扩展到相对论性粒子。相对论性的第一个绝热不变量是 $\\mu_r = p_{\\perp}^2 / B$，其中 $p_{\\perp}$ 是垂直动量。虽然 $E_{\\parallel}$ 场确实改变了粒子的总能量，从而改变了其相对论因子 $\\gamma$，但平行力不对垂直运动做功的基本几何论证仍然有效。总能量的变化本身不足以成为破坏绝热不变性的条件。更严格的相对论推导证实，在相同的绝热条件下，即使存在缓慢变化的 $E_{\\parallel}$，$\\mu_r$ 仍然守恒。该选项中提出的推理是有缺陷的，就像选项 B 一样。\n结论：**不正确**。",
            "answer": "$$\n\\boxed{ACD}\n$$"
        },
        {
            "introduction": "虽然解析理论提供了基础，但数值模拟为可视化和验证物理原理提供了一种强有力的方式。在这个计算实践  中，您将实现一个粒子推进算法来追踪质子的运动，并直接计算其随时间变化的磁矩。这种动手实践的方法将使您能够观察到在缓慢变化的场中 $\\mu$ 的近乎完美的守恒，并见证当场变化过快时其守恒性的破坏，从而弥合抽象理论与具体动力学之间的鸿沟。",
            "id": "4215562",
            "problem": "在给定的电磁场中运动的单个带电粒子受洛伦兹力定律支配，这是经典电动力学和力学的基本定律。目标是通过与粒子模拟（PIC）方法一致的数值检验粒子积分，计算第一绝热不变量（即磁矩，记为 $\\mu(t)$）的时间序列，并评估在各种场变化下 $\\mu(t)$ 保持恒定的程度。\n\n从基本原理出发，粒子遵循以下运动方程\n$$\nm\\,\\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right), \\quad \\frac{d\\mathbf{r}}{dt} = \\mathbf{v},\n$$\n其中 $m$ 是粒子质量，$q$ 是粒子电荷，$\\mathbf{v}$ 是速度，$\\mathbf{r}$ 是位置，$\\mathbf{E}$ 是电场，$\\mathbf{B}$ 是磁场。磁矩 $\\mu(t)$ 是根据粒子相对于局部磁场的瞬时运动计算的，并且必须从相对于瞬时磁场强度的动能垂直分量中提取。数值积分器必须对场进行时间中心化，以避免虚假的能量增益或损失，这与广泛使用的 PIC 和检验粒子方案一致。\n\n您必须为洛伦兹力更新实现一个时间中心化的旋转-加速算法（Boris 方法）。磁矩 $\\mu(t)$ 应在每个时间步中根据粒子的瞬时速度和磁场计算，方法是使用速度分解，将其分解为平行和垂直于磁场方向的分量。然后，应通过计算一个量化其恒定性的标量度量来评估 $\\mu(t)$ 的绝热不变性。任何三角函数参数都必须使用弧度。\n\n您的程序必须：\n- 在空间均匀但随时间变化的场 $\\mathbf{E}(t)$ 和 $\\mathbf{B}(t)$ 中，对电荷为 $q = +e$、质量为 $m = m_{\\mathrm{p}}$ 的单个质子进行积分。\n- 使用以下常数和初始条件：\n  - $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$，\n  - $m = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$，\n  - 基准磁场强度 $B_0 = 1.0 \\times 10^{-7}\\ \\mathrm{T}$，\n  - 时间步长 $\\Delta t = 1.0 \\times 10^{-3}\\ \\mathrm{s}$，\n  - 总积分时间 $T = 10.0\\ \\mathrm{s}$，\n  - 初始位置 $\\mathbf{r}(0) = (0,0,0)\\ \\mathrm{m}$，\n  - 初始速度 $\\mathbf{v}(0) = (v_{\\perp 0}, 0, v_{\\parallel 0})\\ \\mathrm{m/s}$，其中 $v_{\\perp 0} = 1.0 \\times 10^{5}\\ \\mathrm{m/s}$ 且 $v_{\\parallel 0} = 5.0 \\times 10^{4}\\ \\mathrm{m/s}$。\n- 在每一步中，为了更新速度，应在 $t + \\Delta t/2$ 对场进行时间中心化。\n\n将每个测试用例的场定义为\n$$\n\\mathbf{B}(t) = B_0 \\left[1 + \\epsilon \\sin(\\omega t)\\right]\\ \\hat{\\mathbf{z}},\n\\quad\n\\mathbf{E}(t) = E_0\\ \\hat{\\mathbf{x}},\n$$\n其中 $\\epsilon$ 是无量纲振幅，$\\omega$ 是角频率（单位为 $\\mathrm{rad/s}$），$E_0$ 是电场强度（单位为 $\\mathrm{V/m}$）。正弦函数中的角度必须以弧度为单位。\n\n按如下方式根据瞬时速度和磁场计算磁矩 $\\mu(t)$：将 $\\mathbf{v}(t)$ 分解为平行和垂直于 $\\mathbf{B}(t)$ 的分量，形成垂直动能，并使用瞬时磁场强度来获得 $\\mu(t)$。根据时间序列 $\\mu(t)$，为每个测试用例计算相对于初始值的最大相对偏差，\n$$\n\\delta_{\\max} = \\max_{t \\in [0,T]} \\left| \\frac{\\mu(t) - \\mu(0)}{\\mu(0)} \\right|.\n$$\n这个 $\\delta_{\\max}$ 是一个无量纲标量，它量化了在给定的场变化下 $\\mu$ 作为绝热不变量的程度。\n\n实现以下参数值 $(\\epsilon, \\omega, E_0)$ 的测试套件，以探测不同的物理区域：\n- 测试 1（静态场，无电场）：$(\\epsilon = 0.0,\\ \\omega = 0.0,\\ E_0 = 0.0)$，\n- 测试 2（缓慢变化，无电场）：$(\\epsilon = 0.05,\\ \\omega = 0.5,\\ E_0 = 0.0)$，\n- 测试 3（缓慢变化，小垂直电场）：$(\\epsilon = 0.05,\\ \\omega = 0.5,\\ E_0 = 1.0 \\times 10^{-3})$，\n- 测试 4（快速变化，无电场）：$(\\epsilon = 0.3,\\ \\omega = 20.0,\\ E_0 = 0.0)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如\n$$\n[\\delta_{\\max,1}, \\delta_{\\max,2}, \\delta_{\\max,3}, \\delta_{\\max,4}],\n$$\n其中每个条目是相应测试用例的最大相对偏差。输出是无量纲浮点数。不应打印任何其他文本。所有物理量必须按指定单位处理，角度以弧度为单位。该算法不得依赖任何外部输入或文件，并且必须是完全自包含的。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上植根于经典力学和电磁学，提供了所有必要信息，是适定的，并且在计算上是可行的。该问题是计算等离子体物理学中的一个标准的、非平凡的练习。\n\n任务是模拟一个质子在指定的时变电磁场中的轨迹，并评估其磁矩 $\\mu(t)$（即第一绝热不变量）的守恒性。$\\mu(t)$ 的恒定性由其与初始值的最大相对偏差 $\\delta_{\\max}$ 来量化。\n\n粒子的运动由洛伦兹力定律支配，这是一个关于位置 $\\mathbf{r}$ 和速度 $\\mathbf{v}$ 的一阶常微分方程组：\n$$\n\\frac{d\\mathbf{r}}{dt} = \\mathbf{v}\n$$\n$$\nm\\,\\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E}(t) + \\mathbf{v} \\times \\mathbf{B}(t)\\right)\n$$\n此处，$m$ 和 $q$ 是质子的质量和电荷。电场 $\\mathbf{E}(t) = E_0\\ \\hat{\\mathbf{x}}$ 和磁场 $\\mathbf{B}(t) = B_0 \\left[1 + \\epsilon \\sin(\\omega t)\\right]\\ \\hat{\\mathbf{z}}$ 是空间均匀的，但可能随时间变化。\n\n为了对这些方程进行数值积分，我们采用 Boris 算法，这是一种在等离子体模拟中广泛使用且稳健的方法。它是一种二阶精度的蛙跳积分器，以其优异的长期稳定性和守恒特性而闻名。问题指明，用于速度更新的场应在时间步的中点 $t_{n+1/2} = t_n + \\Delta t/2$ 进行评估。这导致从时间 $t_n$ 的速度 $\\mathbf{v}^n$ 更新到时间 $t_{n+1}$ 的速度 $\\mathbf{v}^{n+1}$ 的过程如下：\n\n设 $\\mathbf{r}^n$ 和 $\\mathbf{v}^n$ 为时间 $t_n$ 时的位置和速度。\n1.  在半步时间点评估场：$\\mathbf{E}^{n+1/2} = \\mathbf{E}(t_n + \\Delta t/2)$ 和 $\\mathbf{B}^{n+1/2} = \\mathbf{B}(t_n + \\Delta t/2)$。\n2.  执行由电场引起的第一个半步加速：\n    $$\n    \\mathbf{v}_1 = \\mathbf{v}^n + \\frac{q \\mathbf{E}^{n+1/2}}{m} \\frac{\\Delta t}{2}\n    $$\n3.  执行由磁场引起的整步旋转。这是 Boris 方法的核心：\n    $$\n    \\mathbf{h} = \\frac{q \\mathbf{B}^{n+1/2}}{m} \\frac{\\Delta t}{2}\n    $$\n    $$\n    \\mathbf{s} = \\frac{2\\mathbf{h}}{1 + |\\mathbf{h}|^2}\n    $$\n    $$\n    \\mathbf{v}_2 = \\mathbf{v}_1 + \\left( \\mathbf{v}_1 + (\\mathbf{v}_1 \\times \\mathbf{h}) \\right) \\times \\mathbf{s}\n    $$\n4.  执行由电场引起的第二个半步加速：\n    $$\n    \\mathbf{v}^{n+1} = \\mathbf{v}_2 + \\frac{q \\mathbf{E}^{n+1/2}}{m} \\frac{\\Delta t}{2}\n    $$\n5.  更新位置。为了保持二阶精度，我们使用梯形法则，对步长开始和结束时的速度进行平均：\n    $$\n    \\mathbf{r}^{n+1} = \\mathbf{r}^n + \\frac{\\mathbf{v}^n + \\mathbf{v}^{n+1}}{2} \\Delta t\n    $$\n在总积分时间 $T$ 内，对每个时间步 $\\Delta t$ 重复此序列。\n\n在每个时间步 $t_n$，当状态 $(\\mathbf{r}^n, \\mathbf{v}^n)$ 已知后，我们计算瞬时磁矩 $\\mu(t_n)$。磁矩定义为粒子的垂直动能 $W_{\\perp}$ 与磁场强度 $B$ 的比值：\n$$\n\\mu(t) = \\frac{W_{\\perp}(t)}{B(t)} = \\frac{\\frac{1}{2} m v_{\\perp}^2(t)}{B(t)}\n$$\n要计算 $\\mu(t_n)$，我们首先需要垂直于磁场方向的速度分量。给定 $\\mathbf{v}(t_n)$ 和 $\\mathbf{B}(t_n)$：\n1.  计算沿磁场方向的单位矢量：$\\hat{\\mathbf{b}}(t_n) = \\mathbf{B}(t_n) / |\\mathbf{B}(t_n)|$。\n2.  将速度矢量 $\\mathbf{v}(t_n)$ 分解为平行和垂直于 $\\mathbf{B}(t_n)$ 的分量：\n    $$\n    v_{\\parallel}(t_n) = \\mathbf{v}(t_n) \\cdot \\hat{\\mathbf{b}}(t_n)\n    $$\n    $$\n    \\mathbf{v}_{\\parallel}(t_n) = v_{\\parallel}(t_n) \\hat{\\mathbf{b}}(t_n)\n    $$\n    $$\n    \\mathbf{v}_{\\perp}(t_n) = \\mathbf{v}(t_n) - \\mathbf{v}_{\\parallel}(t_n)\n    $$\n3.  计算垂直速度的平方，$v_{\\perp}^2(t_n) = |\\mathbf{v}_{\\perp}(t_n)|^2$。\n4.  使用上述公式计算磁矩。\n\n收集 $t_n \\in [0, T]$ 的整个 $\\mu(t_n)$ 时间序列。第一绝热不变量定理指出，如果电磁场相对于粒子的回旋周期变化缓慢，则 $\\mu$ 近似恒定。为了量化这种后验守恒的程度，我们计算在模拟时间内的最大相对偏差 $\\delta_{\\max}$：\n$$\n\\delta_{\\max} = \\max_{t \\in [0,T]} \\left| \\frac{\\mu(t) - \\mu(0)}{\\mu(0)} \\right|\n$$\n为所提供的四个测试用例计算这个无量纲度量，这些测试用例旨在探测不同的物理区域：静态情况（绝热）、慢场变化（绝热）、带电场的慢变化（测试漂移效应）和快场变化（非绝热）。最终输出是这四个用例的 $\\delta_{\\max}$ 值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the charged particle motion problem, computes the magnetic moment time series,\n    and finds the maximum relative deviation for several test cases.\n    \"\"\"\n\n    # Physical constants\n    Q = 1.602176634e-19  # Proton charge in Coulombs\n    M = 1.67262192369e-27 # Proton mass in kg\n    Q_OVER_M = Q / M\n\n    # Simulation parameters\n    B0 = 1.0e-7          # Baseline magnetic field in Tesla\n    DT = 1.0e-3          # Time step in seconds\n    T_TOTAL = 10.0       # Total integration time in seconds\n    R0 = np.array([0.0, 0.0, 0.0]) # Initial position (m)\n    V_PERP0 = 1.0e5      # Initial perpendicular velocity (m/s)\n    V_PARA0 = 5.0e4      # Initial parallel velocity (m/s)\n    V0 = np.array([V_PERP0, 0.0, V_PARA0]) # Initial velocity vector (m/s)\n\n    # Test cases parameters (epsilon, omega, E0)\n    test_cases = [\n        (0.0, 0.0, 0.0),            # Test 1: Static B, no E\n        (0.05, 0.5, 0.0),           # Test 2: Slow B variation, no E\n        (0.05, 0.5, 1.0e-3),        # Test 3: Slow B variation, with E\n        (0.3, 20.0, 0.0),           # Test 4: Rapid B variation, no E\n    ]\n\n    results = []\n    \n    num_steps = int(T_TOTAL / DT)\n\n    for case in test_cases:\n        epsilon, omega, e0 = case\n\n        # Initialize state variables\n        r = R0.copy()\n        v = V0.copy()\n        t = 0.0\n        \n        mu_series = []\n\n        # --- Calculate mu(0) ---\n        # B-field at t=0\n        b_vec_t0 = np.array([0.0, 0.0, B0 * (1.0 + epsilon * np.sin(omega * 0.0))])\n        b_mag_t0 = np.linalg.norm(b_vec_t0)\n\n        # Decompose initial velocity\n        b_hat_t0 = b_vec_t0 / b_mag_t0 if b_mag_t0  0 else np.array([0.0, 0.0, 1.0])\n        v_para_mag_t0 = np.dot(v, b_hat_t0)\n        v_perp_sq_t0 = np.dot(v, v) - v_para_mag_t0**2\n        \n        # Magnetic moment at t=0\n        mu0 = 0.5 * M * v_perp_sq_t0 / b_mag_t0 if b_mag_t0  0 else 0.0\n        mu_series.append(mu0)\n\n        # --- Time integration loop ---\n        for i in range(num_steps):\n            # Time at step n and n+1/2\n            t_n = i * DT\n            t_half = t_n + DT / 2.0\n            \n            # Fields evaluated at t_half for Boris push\n            e_field = np.array([e0, 0.0, 0.0])\n            b_field = np.array([0.0, 0.0, B0 * (1.0 + epsilon * np.sin(omega * t_half))])\n            \n            # --- Boris Algorithm ---\n            # 1. First half-step E-acceleration\n            v1 = v + (Q_OVER_M * e_field) * (DT / 2.0)\n            \n            # 2. B-field rotation\n            h = (Q_OVER_M * b_field) * (DT / 2.0)\n            h_mag_sq = np.dot(h, h)\n            s = 2.0 * h / (1.0 + h_mag_sq)\n            \n            v_prime = v1 + np.cross(v1, h)\n            v2 = v1 + np.cross(v_prime, s)\n            \n            # 3. Second half-step E-acceleration\n            v_new = v2 + (Q_OVER_M * e_field) * (DT / 2.0)\n            \n            # 4. Position update (Trapezoidal rule)\n            r = r + (v + v_new) / 2.0 * DT\n            \n            # Update velocity for next step\n            v = v_new\n            \n            # Update time\n            t = t_n + DT\n            \n            # --- Magnetic Moment Calculation at time t ---\n            # B-field at time t\n            b_vec_t = np.array([0.0, 0.0, B0 * (1.0 + epsilon * np.sin(omega * t))])\n            b_mag_t = np.linalg.norm(b_vec_t)\n            \n            # Decompose velocity\n            if b_mag_t  0:\n                b_hat_t = b_vec_t / b_mag_t\n                v_para_mag_t = np.dot(v, b_hat_t)\n                v_perp_sq_t = np.dot(v, v) - v_para_mag_t**2\n                mu_t = 0.5 * M * v_perp_sq_t / b_mag_t\n            else: # Handle case of zero B-field\n                mu_t = 0.0\n            \n            mu_series.append(mu_t)\n\n        # --- Compute max relative deviation ---\n        mu_series_np = np.array(mu_series)\n        \n        if mu0 == 0.0:\n            # If initial mu is zero, relative error is not well-defined.\n            # A non-zero mu later would be infinite relative error.\n            # A zero mu later is zero absolute error. Max absolute should be used.\n            # Assuming mu0  0 for this problem as per initial conditions.\n            delta_max = np.max(np.abs(mu_series_np)) if np.max(np.abs(mu_series_np))  0 else 0.0\n        else:\n            relative_deviation = np.abs((mu_series_np - mu0) / mu0)\n            delta_max = np.max(relative_deviation)\n        \n        results.append(delta_max)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}