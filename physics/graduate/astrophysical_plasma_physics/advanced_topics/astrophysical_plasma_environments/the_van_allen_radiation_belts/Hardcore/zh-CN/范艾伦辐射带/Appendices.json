{
    "hands_on_practices": [
        {
            "introduction": "为了研究范艾伦辐射带中的被捕获粒子，我们首先需要一个能够描述其运动范围的坐标系。这项实践将指导你推导偶极磁场中磁力线的方程，并计算出关键的麦克伊尔文L参数，它是描述辐射带空间结构的基础。",
            "id": "4233593",
            "problem": "考虑将地磁场近似为一个以地球为中心、与自转轴对齐的真空磁偶极子。设球极坐标为 $(r,\\theta,\\phi)$，其中余纬 $\\theta$ 从磁极开始测量，磁纬 $\\lambda$ 定义为 $\\lambda=\\frac{\\pi}{2}-\\theta$。该偶极磁场在球坐标系中的分量为\n$$B_{r}=\\frac{2\\mathcal{M}\\cos\\theta}{r^{3}},\\quad B_{\\theta}=\\frac{\\mathcal{M}\\sin\\theta}{r^{3}},\\quad B_{\\phi}=0,$$\n其中 $\\mathcal{M}$ 是偶极矩的大小。磁感线是处处与 $\\mathbf{B}$ 相切的曲线。McIlwain $L$ 参数（也称为 $L$-壳层）定义为某条磁感线的赤道穿越距离（以地球平均半径 $R_{E}$ 为单位），即对于该磁感线有 $L\\equiv r_{\\mathrm{eq}}/R_{E}$。\n\n任务：\n1. 从磁感线的切线与 $\\mathbf{B}$ 平行的条件出发，推导偶极磁感线上 $r(\\theta)$ 所遵循的微分方程，并对其进行积分，得到 $r$ 和 $\\lambda$ 之间的显式关系。用赤道穿越距离和 $R_{E}$ 表示积分常数，从而用 McIlwain $L$ 参数表达磁感线关系。\n2. 内磁层中的一个点位于地心距离 $r=3R_{E}$ 和磁纬 $\\lambda=30^{\\circ}$ 处。使用你推导出的关系，计算通过该点的磁感线的 McIlwain $L$ 值。在适当的地方使用角度制来计算三角函数。你的最终答案应表示为一个无单位的纯数，无需四舍五入。\n3. 通过使用你计算出的 $L$ 值来确定该磁感线的赤道穿越距离 $r_{\\mathrm{eq}}$，并确认 $r$、$ \\lambda$ 和 $r_{\\mathrm{eq}}$ 之间的关系在给定点成立，从而验证与赤道映射的一致性。\n\n你最终报告的答案必须仅为 $L$ 的值（无量纲）。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。将地球磁场模型化为偶极子是磁层物理学中一个标准且有效的近似。问题陈述提供了所有必要的信息和定义，可以得出一个唯一且有意义的解。\n\n**任务1：磁感线方程的推导**\n\n磁感线是空间中处处与磁场矢量 $\\mathbf{B}$ 相切的曲线。设沿磁感线的无穷小位移矢量在球坐标系中为 $d\\mathbf{l} = dr\\,\\hat{\\mathbf{r}} + r\\,d\\theta\\,\\hat{\\boldsymbol{\\theta}} + r\\sin\\theta\\,d\\phi\\,\\hat{\\boldsymbol{\\phi}}$。$d\\mathbf{l}$ 与 $\\mathbf{B} = B_r\\,\\hat{\\mathbf{r}} + B_\\theta\\,\\hat{\\boldsymbol{\\theta}} + B_\\phi\\,\\hat{\\boldsymbol{\\phi}}$ 平行的条件意味着它们相应分量的比值为常数：\n$$\n\\frac{dr}{B_r} = \\frac{r\\,d\\theta}{B_\\theta} = \\frac{r\\sin\\theta\\,d\\phi}{B_\\phi}\n$$\n问题陈述偶极磁场分量为 $B_{r}=\\frac{2\\mathcal{M}\\cos\\theta}{r^{3}}$，$B_{\\theta}=\\frac{\\mathcal{M}\\sin\\theta}{r^{3}}$ 和 $B_{\\phi}=0$。由于 $B_\\phi = 0$，关系式 $\\frac{r\\sin\\theta\\,d\\phi}{B_\\phi}$ 意味着对于有限位移 $d\\phi=0$。这意味着磁感线位于子午面（$\\phi$ 为常数的平面）内。\n\n我们考虑 $r$ 和 $\\theta$ 分量之间的关系：\n$$\n\\frac{dr}{B_r} = \\frac{r\\,d\\theta}{B_\\theta}\n$$\n代入 $B_r$ 和 $B_\\theta$ 的表达式：\n$$\n\\frac{dr}{\\left(\\frac{2\\mathcal{M}\\cos\\theta}{r^{3}}\\right)} = \\frac{r\\,d\\theta}{\\left(\\frac{\\mathcal{M}\\sin\\theta}{r^{3}}\\right)}\n$$\n分母中的 $\\mathcal{M}$ 和 $r^3$ 项相消，方程简化为：\n$$\n\\frac{dr}{2\\cos\\theta} = \\frac{r\\,d\\theta}{\\sin\\theta}\n$$\n这是一个可分离的一阶常微分方程。我们重新整理它以分离变量 $r$ 和 $\\theta$：\n$$\n\\frac{dr}{r} = 2\\frac{\\cos\\theta}{\\sin\\theta}\\,d\\theta\n$$\n我们对两边进行积分：\n$$\n\\int \\frac{dr}{r} = \\int 2\\frac{\\cos\\theta}{\\sin\\theta}\\,d\\theta\n$$\n积分得到：\n$$\n\\ln(r) = 2\\ln(\\sin\\theta) + C\n$$\n其中 $C$ 是积分常数。注意，由于在北半球 $r>0$ 且 $\\sin\\theta \\ge 0$（并且我们可以通过对称性扩展），我们可以省略绝对值符号。利用对数的性质重新整理：\n$$\n\\ln(r) = \\ln(\\sin^2\\theta) + C\n$$\n对两边取指数，得到磁感线的通式：\n$$\nr = \\exp(\\ln(\\sin^2\\theta) + C) = \\exp(C) \\sin^2\\theta\n$$\n我们定义一个新常数 $C_0 = \\exp(C)$。磁感线方程为 $r = C_0 \\sin^2\\theta$。\n\n现在我们将其与磁纬 $\\lambda$ 和 McIlwain $L$ 参数联系起来。给定 $\\lambda = \\frac{\\pi}{2} - \\theta$，这意味着 $\\theta = \\frac{\\pi}{2} - \\lambda$。将其代入方程：\n$$\nr = C_0 \\sin^2\\left(\\frac{\\pi}{2} - \\lambda\\right) = C_0 \\cos^2\\lambda\n$$\n常数 $C_0$ 可以通过考虑磁感线的赤道穿越来确定。在磁赤道处，$\\lambda=0$ 且 $r=r_{\\mathrm{eq}}$。将这些值代入我们的方程：\n$$\nr_{\\mathrm{eq}} = C_0 \\cos^2(0) = C_0 (1)^2 = C_0\n$$\n因此，积分常数 $C_0$ 就是赤道穿越距离 $r_{\\mathrm{eq}}$。磁感线方程为：\n$$\nr = r_{\\mathrm{eq}} \\cos^2\\lambda\n$$\n最后，我们使用 McIlwain $L$ 参数的定义，$L \\equiv r_{\\mathrm{eq}}/R_E$，其中 $R_E$ 是地球的平均半径。这给出 $r_{\\mathrm{eq}} = L R_E$。将其代入磁感线方程，得到所需的关系式：\n$$\nr = L R_E \\cos^2\\lambda\n$$\n\n**任务2：L值的计算**\n\n给定磁层中的一个点，其地心距离 $r = 3R_E$，磁纬 $\\lambda = 30^{\\circ}$。我们使用任务1中推导的方程来求解通过该点的磁感线的 $L$ 值。\n方程为 $r = L R_E \\cos^2\\lambda$。我们可以重新整理它来求解 $L$：\n$$\nL = \\frac{r}{R_E \\cos^2\\lambda}\n$$\n代入给定值 $r=3R_E$ 和 $\\lambda=30^{\\circ}$：\n$$\nL = \\frac{3R_E}{R_E \\cos^2(30^{\\circ})} = \\frac{3}{\\cos^2(30^{\\circ})}\n$$\n$\\cos(30^{\\circ})$ 的值是 $\\frac{\\sqrt{3}}{2}$。因此，$\\cos^2(30^{\\circ}) = \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = \\frac{3}{4}$。\n将此值代入 $L$ 的表达式：\n$$\nL = \\frac{3}{\\frac{3}{4}} = 3 \\times \\frac{4}{3} = 4\n$$\n该磁感线的 McIlwain $L$ 值为 4。\n\n**任务3：一致性验证**\n\n我们需要验证与赤道映射的一致性。\n从任务2中，我们发现通过 $(r=3R_E, \\lambda=30^{\\circ})$ 的磁感线的 $L$ 值为 $L=4$。\n使用 $L$ 参数的定义，我们求出这条磁感线的赤道穿越距离 $r_{\\mathrm{eq}}$：\n$$\nL = \\frac{r_{\\mathrm{eq}}}{R_E} \\implies r_{\\mathrm{eq}} = L R_E = 4 R_E\n$$\n现在我们检查通用磁感线方程 $r = r_{\\mathrm{eq}}\\cos^2\\lambda$ 是否对给定点 $(r=3R_E, \\lambda=30^{\\circ})$ 和计算出的 $r_{\\mathrm{eq}} = 4R_E$ 成立。\n我们将 $r_{\\mathrm{eq}}$ 和 $\\lambda$ 代入方程的右侧：\n$$\nr_{\\mathrm{eq}}\\cos^2\\lambda = (4R_E)\\cos^2(30^{\\circ})\n$$\n如前所算，$\\cos^2(30^{\\circ}) = \\frac{3}{4}$。\n$$\nr_{\\mathrm{eq}}\\cos^2\\lambda = (4R_E) \\left(\\frac{3}{4}\\right) = 3R_E\n$$\n这个结果 $3R_E$ 正是该点的给定径向距离 $r$。关系式 $r = r_{\\mathrm{eq}}\\cos^2\\lambda$ 成立，证实了我们计算的一致性。\n最终要求的答案是 $L$ 的数值。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "辐射带中粒子的能量会因磁场变化而显著改变，这对于理解空间天气至关重要。通过应用第一绝热不变量 $\\mu$ 的守恒，本练习将带你探索一种核心的粒子能量增长机制——感应加速（betatron acceleration），并定量计算其能量增益。",
            "id": "4233598",
            "problem": "一个被困在 Van Allen 辐射带中封闭漂移壳上的高能电子，其所处的 McIlwain L参数（L）保持不变，而该壳层处的赤道磁场强度（用 $B_{eq}$ 表示）在一个时间尺度 $\\tau$ 内缓慢单调增加。该时间尺度 $\\tau$ 相对于电子的回旋周期而言很长，但相对于其碰撞散射时间而言很短。假设不存在平行电场，且导心理论适用，因此在演化过程中第一绝热不变量（磁矩）是守恒的。仅使用带电粒子在磁化等离子体中运动的基本原理，确定电子的垂直动能 $E_{\\perp}$ 如何响应赤道处磁场的一个小的分数增量 $\\Delta B$。然后，对于固定L壳层上赤道磁场的分数增加量为 $\\Delta B / B_{eq} = 0.20$ 的情况，计算垂直能量的乘法电子感应加速能量增益因子，定义为 $E_{\\perp,f}/E_{\\perp,i}$，其中下标 $i$ 和 $f$ 分别表示初始和最终状态。请将最终答案表示为一个纯数，无需四舍五入。",
            "solution": "该问题要求分析在缓慢变化的磁场影响下，Van Allen 辐射带中高能电子的运动。在进行求解之前，首先对问题陈述进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 一个高能电子被困在一个封闭的漂移壳上。\n- McIlwain L参数 $L$ 是固定的。\n- 该壳层处的赤道磁场强度用 $B_{eq}$ 表示。\n- $B_{eq}$ 在时间尺度 $\\tau$ 内缓慢单调增加。\n- $\\tau$ 相对于电子的回旋周期而言很长。\n- $\\tau$ 相对于电子的碰撞散射时间而言很短。\n- 不存在平行电场。\n- 导心理论适用。\n- 第一绝热不变量（磁矩）$\\mu$ 是守恒的。\n- 第一个任务是确定垂直动能 $E_{\\perp}$ 如何响应赤道磁场的一个小的分数增量 $\\Delta B$。\n- 第二个任务是计算当分数增加量为 $\\Delta B / B_{eq} = 0.20$ 时，乘法电子感应加速能量增益因子 $E_{\\perp,f}/E_{\\perp,i}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。\n- **科学合理性**：该问题描述了磁层中带电粒子的电子感应加速，这是等离子体天体物理学中的一个基本过程。关键条件——磁场相对于回旋周期变化缓慢——是第一绝热不变量守恒的标准要求。所有前提都与等离子体物理学和导心理论的既定原理相符。\n- **提法恰当性**：该问题给出了足够的信息以得出一个唯一解。磁矩守恒为所关心的量（$E_{\\perp}$ 和 $B_{eq}$）之间提供了直接而明确的关系。\n- **客观性**：该问题使用了磁层物理学中的精确、标准术语进行陈述，没有主观或模糊的语言。\n\n**结论：该问题被认定为有效。**\n\n### 解题过程\n\n求解过程基于问题中所述的基本原理：第一绝热不变量（或称磁矩）$\\mu$ 的守恒。该原理之所以成立，是因为磁场变化的时间尺度远大于粒子的回旋周期，使得这种变化相对于回旋运动是“绝热的”。\n\n对于一个带电粒子，其磁矩 $\\mu$ 定义为其垂直于磁场的动能 $E_{\\perp}$ 与局域磁场强度 $B$ 的比值：\n$$\n\\mu = \\frac{E_{\\perp}}{B}\n$$\n其中 $E_{\\perp} = \\frac{1}{2}mv_{\\perp}^2$，$m$ 是电子质量，$v_{\\perp}$ 是其速度垂直于磁场矢量的分量。\n\n$\\mu$ 的守恒意味着这个比率在系统的整个演化过程中保持不变。因此，垂直动能 $E_{\\perp}$ 必须与磁场强度 $B$ 成正比变化。\n$$\nE_{\\perp} = \\mu B \\implies E_{\\perp} \\propto B\n$$\n这直接回答了问题的第一部分。对于磁场的一个微小变化，从 $B$ 变为 $B + \\Delta B$，垂直能量从 $E_{\\perp}$ 变为 $E_{\\perp} + \\Delta E_{\\perp}$。上述关系意味着其分数变化是相等的：\n$$\n\\frac{\\Delta E_{\\perp}}{E_{\\perp}} = \\frac{\\Delta B}{B}\n$$\n这种能量增加机制被称为电子感应加速（betatron acceleration）。\n\n对于问题的第二部分，我们比较电子的初始状态（下标 $i$）和最终状态（下标 $f$）。问题指明变化发生在赤道磁场 $B_{eq}$ 中。磁矩守恒表示为：\n$$\n\\mu = \\frac{E_{\\perp,i}}{B_{eq,i}} = \\frac{E_{\\perp,f}}{B_{eq,f}}\n$$\n此处，$E_{\\perp,i}$ 和 $B_{eq,i}$ 分别是初始垂直动能和初始赤道磁场，$E_{\\perp,f}$ 和 $B_{eq,f}$ 是它们的最终值。我们需要计算乘法电子感应加速能量增益因子，定义为比率 $E_{\\perp,f}/E_{\\perp,i}$。重新整理守恒方程可得：\n$$\n\\frac{E_{\\perp,f}}{E_{\\perp,i}} = \\frac{B_{eq,f}}{B_{eq,i}}\n$$\n问题陈述赤道磁场的分数增加量为 $0.20$。该分数增加量是相对于初始场强定义的：\n$$\n\\frac{\\Delta B}{B_{eq}} = \\frac{B_{eq,f} - B_{eq,i}}{B_{eq,i}} = 0.20\n$$\n我们可以解此方程，求出最终与初始磁场强度之比：\n$$\n\\frac{B_{eq,f}}{B_{eq,i}} - 1 = 0.20\n$$\n$$\n\\frac{B_{eq,f}}{B_{eq,i}} = 1 + 0.20 = 1.20\n$$\n将此结果代入能量增益因子的表达式中，我们得到：\n$$\n\\frac{E_{\\perp,f}}{E_{\\perp,i}} = 1.20\n$$\n因此，赤道磁场强度增加 $20\\%$ 会导致电子的垂直动能增加 $20\\%$。乘法能量增益因子为 $1.20$。",
            "answer": "$$\n\\boxed{1.20}\n$$"
        },
        {
            "introduction": "从单个粒子动力学到粒子群的宏观行为，是理解辐射带的关键一步。这项综合实践将引导你建立一个描述粒子径向扩散和损失的一维演化模型，并求解该模型以预测在空间天气事件后，辐射带电子的分布将如何随时间演变。",
            "id": "4233594",
            "problem": "考虑外范艾伦辐射带中的电子，这些电子受到来自等离子体片的亚暴相关注入事件的影响。设相空间密度 (PSD) 为 $f(L,t)$，其在第一和第二绝热不变量固定的情况下定义，其中 $L$ 是 McIlwain $L$壳参数，$t$ 是时间。从适用于天体物理等离子体物理学和磁层动力学的基本原理出发：Liouville 定理、引导中心不变量，以及导致第三不变量径向输运的随机波-粒子相互作用。推导一个关于 $f(L,t)$ 的一维演化方程，该方程能够捕捉由磁流体动力学超低频 (ULF) 波（此处定义为 Ultra Low Frequency (ULF) waves）驱动的径向扩散物理过程，并包含一个表示向大气损失锥内投掷角散射的有限损失项。在您的推导中，明确说明将完整问题简化为在 $L$ 和 $t$ 上的一维偏微分方程所做的假设，该方程适用于脉冲注入位置周围一个狭窄的 $L$ 值范围。\n\n将亚暴相关的注入事件建模为一个在 $t=0$ 时刻，集中在 $L \\approx 6$ 处的脉冲源，并假设这使得初始 PSD 具有一个在 $L=6$ 附近急剧局域化的分布。在注入点附近径向扩散系数空间均匀以及损失时间尺度空间均匀的简化假设下，对于一个有效无界的 $L$ 域，求出 $t>0$ 时 $f(L,t)$ 的闭合形式表达式。您必须：\n- 证明将完整的相空间演化简化为在 $L$ 上带损失的一维扩散的合理性。\n- 确定适用于脉冲初始条件的格林函数解结构。\n- 给出 $f(L,t)$ 的最终表达式，用注入幅度 $A$、扩散系数 $D_{\\mathrm{LL}}$、损失时间尺度 $\\tau$、注入位置 $L_0$ 以及评估点和时间 $(L,t)$ 表示。\n\n数值实现要求：\n- 将 $f(L,t)$ 视为无量纲量（归一化的 PSD），$L$ 视为无量纲的 $L$壳，$t$ 的单位为小时，$D_{\\mathrm{LL}}$ 的单位为 $L^2/\\mathrm{hour}$，$\\tau$ 的单位为小时。\n- 使用一个在 $t=0$ 时刻以 $L_0=6.0$ 为中心、幅度为 $A$ 的脉冲初始条件，并在指定的 $(L,t)$ 值处计算 $f(L,t)$。\n- 对于数值，将所有常数和参数表示为浮点数。\n\n测试套件：\n对以下六组参数集，评估所推导的 $f(L,t)$ 表达式，每组参数指定为 $(D_{\\mathrm{LL}},\\tau,A,L_0,L_{\\mathrm{eval}},t_{\\mathrm{eval}})$，单位如上所述：\n- 情况 1：$(0.02,12.0,1.0,6.0,5.5,2.0)$。\n- 情况 2：$(0.05,1000.0,1.0,6.0,7.0,1.5)$。\n- 情况 3：$(0.001,0.5,1.0,6.0,6.0,1.0)$。\n- 情况 4：$(0.01,10.0,1.0,6.0,6.2,0.01)$。\n- 情况 5：$(0.03,8.0,1.0,6.0,8.0,3.0)$。\n- 情况 6：$(0.005,20.0,0.5,6.0,5.9,4.0)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个条目等于对应情况下 $f(L_{\\mathrm{eval}},t_{\\mathrm{eval}})$ 的值，四舍五入到六位小数（例如，$[0.123456,0.654321,0.000001]$）。不允许有其他输出。未使用角度，因此不需要角度单位。所有时间必须以小时为单位处理，所有扩散系数以 $L^2/\\mathrm{hour}$ 为单位处理。",
            "solution": "该问题要求推导并求解地球外辐射带中电子相空间密度 (PSD) 的一维演化方程，该方程考虑了径向扩散和粒子损失。这是磁层等离子体物理学中的一个经典问题。\n\n**1. 基本原理**\n\n相空间中粒子分布的演化由玻尔兹曼方程控制。对于磁层中的无碰撞等离子体，该方程简化为相空间密度 $f(\\mathbf{r}, \\mathbf{p}, t)$ 的弗拉索夫方程：\n$$\n\\frac{\\partial f}{\\partial t} + \\mathbf{v} \\cdot \\nabla_{\\mathbf{r}} f + q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\nabla_{\\mathbf{p}} f = 0\n$$\n其中 $\\mathbf{r}$ 是位置，$\\mathbf{p}$ 是动量，$t$ 是时间，$\\mathbf{v}$ 是速度，$q$ 是电荷，$\\mathbf{E}$ 和 $\\mathbf{B}$ 分别是电场和磁场。Liouville 定理是该方程在哈密顿系统下的一个推论，它指出 PSD 沿着相空间中的粒子轨迹是守恒的 ($df/dt = 0$)。\n\n对于被行星磁场捕获的粒子，将坐标从 $(\\mathbf{r}, \\mathbf{p})$ 变换为基于绝热不变量的坐标系会很方便。绝热不变量是与粒子运动的三个周期性分量相关的近似守恒量：\n1.  第一绝热不变量 $\\mu$，与粒子围绕磁力线的快速回旋运动有关。\n2.  第二绝热不变量 $J$，与粒子在磁镜点之间的弹跳运动有关。\n3.  第三绝热不变量 $\\Phi_d$，与粒子围绕地球的缓慢漂移运动有关。McIlwain $L$壳参数是该不变量的一个代表，在偶极场中 $\\Phi_d \\propto 1/L$。\n\n在这些坐标中，PSD 表示为 $f(\\mu, J, L, t)$。如果所有不变量都完全守恒，那么对于给定的粒子布居，$f$ 将是一个常数。然而，波-粒子相互作用可以破坏这些不变量，导致相空间中的输运。\n\n**2. 一维径向扩散方程的推导**\n\n当与波的相互作用导致不变量发生微小、随机的变化时，PSD 的演化不再由简单的弗拉索夫方程描述，而是由一个福克-普朗克方程描述，该方程解释了随机输运。其一般形式为：\n$$\n\\frac{\\partial f}{\\partial t} = \\sum_{i,j} \\frac{\\partial}{\\partial \\alpha_i} \\left( D_{ij} \\frac{\\partial f}{\\partial \\alpha_j} \\right) - \\mathcal{L} + \\mathcal{S}\n$$\n其中 $\\alpha_i, \\alpha_j \\in \\{\\mu, J, L\\}$ 是不变量坐标，$D_{ij}$ 是扩散张量的元素，$\\mathcal{L}$ 是损失算符，$\\mathcal{S}$ 是源算符。\n\n问题要求我们将这个一般方程简化为 $L$ 和 $t$ 的一维方程。这种简化基于以下假设是合理的：\n\n*   **固定的粒子布居**：我们考虑在固定的第一和第二不变量 $\\mu$ 和 $J$ 下的 PSD。这意味着我们正在分析一个特定的电子布居（例如，在给定的 $L$壳上具有固定能量和赤道投掷角的电子）。这从我们的直接考虑中排除了 $\\mu$ 和 $J$ 方向的扩散，使得 $f$ 成为函数 $f(L,t)$。\n*   **径向扩散的主导作用**：问题指明径向输运是由磁流体动力学超低频 (ULF) 波驱动的。这些波的频率与粒子漂移频率（分钟到数十分钟量级）相当。与这些波的共振相互作用主要破坏第三绝热不变量，导致粒子跨 $L$壳扩散。我们假设这是主要的输运机制。\n*   **简化的损失项**：由其他波（例如，哨声模合声波或嘶声波）引起的投掷角散射会破坏 $\\mu$ 和 $J$，将粒子散射到大气损失锥中。我们将这个过程简化为单个损失项 $\\mathcal{L} = f/\\tau$，而不是对复杂的投掷角空间扩散进行建模，其中 $\\tau$ 是一个特征损失时间尺度。如果粒子沉降的时间尺度远快于从损失锥中反向散射出来的时间尺度，这是一个有效的近似。\n*   **简化的扩散算符**：径向扩散通量守恒的正式表达式会导出一个形如 $L^2 \\frac{\\partial}{\\partial L} \\left( \\frac{D_{LL}}{L^2} \\frac{\\partial f}{\\partial L} \\right)$ 的项。然而，问题指定分析是针对“狭窄的 $L$ 范围”，并假设“空间均匀的径向扩散系数” ($D_{LL}$)。在这种局部近似下，几何因子 $L^2$ 被视为常数，可以被吸收到一个有效的扩散系数中，从而将算符简化为 $D_{LL} \\frac{\\partial^2 f}{\\partial L^2}$。\n\n基于这些理由和假设（$D_{LL}$ 和 $\\tau$ 为常数），完整的福克-普朗克方程简化为关于 $f(L,t)$ 的一维反应-扩散方程：\n$$\n\\frac{\\partial f}{\\partial t} = D_{LL} \\frac{\\partial^2 f}{\\partial L^2} - \\frac{f}{\\tau} + S(L,t)\n$$\n其中 $S(L,t)$ 是一个源项。\n\n**3. 脉冲源的解**\n\n问题要求解出亚暴相关注入后的解，该注入被建模为“在 $t=0$ 时刻，集中在 $L \\approx 6$ 处的脉冲源”。这对应于一个瞬时源，它为 $t > 0$ 时的演化设定了初始条件。我们将其建模为：\n$$\nf(L, t=0^+) = A \\, \\delta(L-L_0)\n$$\n其中 $A$ 是注入的幅度，$L_0 = 6.0$ 是注入位置，$\\delta(\\cdot)$ 是狄拉克 $\\delta$ 函数。对于 $t > 0$，源项 $S(L,t)$ 为零，我们必须求解齐次偏微分方程：\n$$\n\\frac{\\partial f}{\\partial t} = D_{LL} \\frac{\\partial^2 f}{\\partial L^2} - \\frac{f}{\\tau}\n$$\n这是一个标准的线性偏微分方程。我们可以通过代换 $f(L,t) = g(L,t) e^{-t/\\tau}$ 来简化它。对该式求导并代入偏微分方程，我们发现损失项相互抵消：\n$$\n\\left(\\frac{\\partial g}{\\partial t} e^{-t/\\tau} - \\frac{g}{\\tau} e^{-t/\\tau}\\right) = D_{LL} \\left(\\frac{\\partial^2 g}{\\partial L^2} e^{-t/\\tau}\\right) - \\frac{g e^{-t/\\tau}}{\\tau}\n$$\n$$\n\\implies \\frac{\\partial g}{\\partial t} = D_{LL} \\frac{\\partial^2 g}{\\partial L^2}\n$$\n这是标准的热传导或扩散方程。$g$ 的初始条件是 $g(L,0) = f(L,0) e^0 = A \\, \\delta(L-L_0)$。\n\n对于 $\\delta$ 函数初始条件，在无界域 ($-\\infty  L  \\infty$) 上的热传导方程的解是其格林函数，即一个高斯函数：\n$$\ng(L,t) = \\frac{A}{\\sqrt{4 \\pi D_{LL} t}} \\exp\\left( -\\frac{(L-L_0)^2}{4 D_{LL} t} \\right)\n$$\n指数项描述了初始脉冲的扩散性展宽，而前置因子确保了总粒子数 $\\int g(L,t) \\, dL = A$ 的守恒。\n\n最后，我们通过乘以衰减因子 $e^{-t/\\tau}$ 将其变换回原始函数 $f(L,t)$。\n\n**4. $f(L,t)$ 的最终表达式**\n\n脉冲注入后，相空间密度 $f(L,t)$ 的闭合形式表达式是扩散解和损失项的乘积：\n$$\nf(L,t) = \\frac{A}{\\sqrt{4 \\pi D_{LL} t}} \\exp\\left( -\\frac{(L-L_0)^2}{4 D_{LL} t} \\right) e^{-t/\\tau}\n$$\n这可以合并为一个表达式：\n$$\nf(L,t) = \\frac{A}{\\sqrt{4 \\pi D_{LL} t}} \\exp\\left( -\\frac{(L-L_0)^2}{4 D_{LL} t} - \\frac{t}{\\tau} \\right)\n$$\n给定注入幅度 $A$、注入位置 $L_0$、径向扩散系数 $D_{LL}$ 和损失时间尺度 $\\tau$，该方程提供了在任何评估点 $(L,t)$ 的 PSD。现在将对该解进行数值实现，以评估给定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the phase space density f(L,t) for electrons in the \n    Van Allen belts modeled by a 1D reaction-diffusion equation.\n    \n    The solution is based on the Green's function for the diffusion equation\n    with an exponential loss term, corresponding to an impulsive initial\n    injection. The formula is:\n    f(L,t) = (A / sqrt(4*pi*D_LL*t)) * exp( -((L-L0)^2 / (4*D_LL*t)) - (t/tau) )\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (D_LL, tau, A, L0, L_eval, t_eval)\n    test_cases = [\n        # (D_LL [L^2/hour], tau [hour], A [dimensionless], L0 [L-shell], L_eval [L-shell], t_eval [hour])\n        (0.02, 12.0, 1.0, 6.0, 5.5, 2.0),\n        (0.05, 1000.0, 1.0, 6.0, 7.0, 1.5),\n        (0.001, 0.5, 1.0, 6.0, 6.0, 1.0),\n        (0.01, 10.0, 1.0, 6.0, 6.2, 0.01),\n        (0.03, 8.0, 1.0, 6.0, 8.0, 3.0),\n        (0.005, 20.0, 0.5, 6.0, 5.9, 4.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        D_LL, tau, A, L0, L_eval, t_eval = case\n\n        # Ensure t_eval is positive to avoid division by zero or domain errors.\n        if t_eval == 0:\n            # For t=0, the solution is a delta function, infinite at L=L0 and 0 elsewhere.\n            # Here, we treat very small positive times as finite. If t is exactly 0 and L!=L0, f=0.\n            # Given L=6.2 and L0=6.0, if t_eval=0, f would be 0.\n            # The problem gives a small positive t_eval=0.01, so this check is for robustness.\n            if L_eval == L0:\n                # Mathematically infinite, but for practical computation, it's ill-defined.\n                # In this context, we can consider the limit, but returning 0 or a very large number are options.\n                # As per problem constraints, a numerical answer is expected. Let's return a placeholder for this edge case.\n                # Given problem context, t > 0 is implied for the evolution.\n                f_Lt = 0.0 \n            else:\n                f_Lt = 0.0\n            results.append(f\"{f_Lt:.6f}\")\n            continue\n            \n        # Calculate the denominator of the pre-factor\n        prefactor_denom = np.sqrt(4.0 * np.pi * D_LL * t_eval)\n        \n        # Calculate the pre-factor\n        prefactor = A / prefactor_denom\n        \n        # Calculate the spatial part of the exponential argument\n        exp_arg_spatial = -((L_eval - L0)**2) / (4.0 * D_LL * t_eval)\n        \n        # Calculate the temporal loss part of the exponential argument\n        exp_arg_loss = -t_eval / tau\n        \n        # Calculate the full exponential term\n        exp_term = np.exp(exp_arg_spatial + exp_arg_loss)\n        \n        # Calculate the final phase space density\n        f_Lt = prefactor * exp_term\n        \n        # Format the result to six decimal places and append to the list\n        results.append(f\"{f_Lt:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}