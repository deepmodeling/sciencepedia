{
    "hands_on_practices": [
        {
            "introduction": "范艾伦辐射带的核心是地球磁场对带电粒子形成的“磁笼”效应。要理解粒子的囚禁和运动，我们首先需要一种方法来描述这个磁场的几何结构。这项练习将通过推导偶极磁场的磁力线方程，并计算一个关键坐标——麦克伊尔文L壳参数（McIlwain L-shell parameter），来为您打下磁层物理学的基础。通过这个实践，您将学会如何将磁力线的物理概念转化为一个量化的、用于组织和分析辐射带数据的坐标系统 。",
            "id": "4233593",
            "problem": "考虑地磁场可近似为一个以地球为中心、与自转轴对齐的真空磁偶极子。设球极坐标为 $(r,\\theta,\\phi)$，其中余纬 $\\theta$ 从磁极量起，磁纬 $\\lambda$ 定义为 $\\lambda=\\frac{\\pi}{2}-\\theta$。该偶极磁场在球坐标系中的分量为\n$$B_{r}=\\frac{2\\mathcal{M}\\cos\\theta}{r^{3}},\\quad B_{\\theta}=\\frac{\\mathcal{M}\\sin\\theta}{r^{3}},\\quad B_{\\phi}=0,$$\n其中 $\\mathcal{M}$ 是偶极矩的大小。磁力线是处处与 $\\mathbf{B}$ 相切的曲线。McIlwain $L$ 参数（也称为 $L$ 壳层）定义为某条磁力线的赤道穿越距离，以地球平均半径 $R_{E}$ 为单位，即对该磁力线有 $L\\equiv r_{\\mathrm{eq}}/R_{E}$。\n\n任务：\n1. 从磁力线切线平行于 $\\mathbf{B}$ 的条件出发，推导偶极磁力线所满足的关于 $r(\\theta)$ 的微分方程，并对其积分，得到 $r$ 和 $\\lambda$ 之间的显式关系。用赤道穿越距离和 $R_{E}$ 来确定积分常数，从而用 McIlwain $L$ 参数表示磁力线关系。\n2. 内磁层中的一个点位于地心距离 $r=3R_{E}$ 和磁纬 $\\lambda=30^{\\circ}$ 处。使用你推导的关系，计算穿过该点的磁力线的 McIlwain $L$ 值。在适当情况下使用角度制计算三角函数。最终答案表示为一个无单位的纯数，无需四舍五入。\n3. 使用你计算出的 $L$ 值确定该磁力线的赤道穿越距离 $r_{\\mathrm{eq}}$，并通过确认在给定点 $r$、$\\lambda$ 和 $r_{\\mathrm{eq}}$ 之间的关系成立，来验证与赤道映射的一致性。\n\n你最终报告的答案必须仅为 $L$ 的值（无量纲）。",
            "solution": "该问题经核实具有科学依据、提法得当且客观。将地球磁场模拟为偶极子是磁层物理学中一个标准的、有效的近似。问题陈述提供了所有必要的信息和定义，足以得出一个唯一且有意义的解。\n\n**任务1：磁力线方程的推导**\n\n磁力线是空间中处处与磁场矢量 $\\mathbf{B}$ 相切的曲线。设沿磁力线在球坐标系中的一个无穷小位移矢量为 $d\\mathbf{l} = dr\\,\\hat{\\mathbf{r}} + r\\,d\\theta\\,\\hat{\\boldsymbol{\\theta}} + r\\sin\\theta\\,d\\phi\\,\\hat{\\boldsymbol{\\phi}}$。$d\\mathbf{l}$ 平行于 $\\mathbf{B} = B_r\\,\\hat{\\mathbf{r}} + B_\\theta\\,\\hat{\\boldsymbol{\\theta}} + B_\\phi\\,\\hat{\\boldsymbol{\\phi}}$ 的条件意味着它们对应分量的比值为常数：\n$$\n\\frac{dr}{B_r} = \\frac{r\\,d\\theta}{B_\\theta} = \\frac{r\\sin\\theta\\,d\\phi}{B_\\phi}\n$$\n问题陈述指出偶极磁场分量为 $B_{r}=\\frac{2\\mathcal{M}\\cos\\theta}{r^{3}}$、$B_{\\theta}=\\frac{\\mathcal{M}\\sin\\theta}{r^{3}}$ 和 $B_{\\phi}=0$。由于 $B_\\phi = 0$，关系式 $\\frac{r\\sin\\theta\\,d\\phi}{B_\\phi}$ 意味着对于有限位移 $d\\phi=0$。这表示磁力线位于子午面内（$\\phi$ 为常数的平面）。\n\n我们考虑 $r$ 和 $\\theta$ 分量之间的关系：\n$$\n\\frac{dr}{B_r} = \\frac{r\\,d\\theta}{B_\\theta}\n$$\n代入 $B_r$ 和 $B_\\theta$ 的表达式：\n$$\n\\frac{dr}{\\left(\\frac{2\\mathcal{M}\\cos\\theta}{r^{3}}\\right)} = \\frac{r\\,d\\theta}{\\left(\\frac{\\mathcal{M}\\sin\\theta}{r^{3}}\\right)}\n$$\n$\\mathcal{M}$ 和 $r^3$ 项从分母中消去，方程简化为：\n$$\n\\frac{dr}{2\\cos\\theta} = \\frac{r\\,d\\theta}{\\sin\\theta}\n$$\n这是一个可分离的一阶常微分方程。我们重新整理以分离变量 $r$ 和 $\\theta$：\n$$\n\\frac{dr}{r} = 2\\frac{\\cos\\theta}{\\sin\\theta}\\,d\\theta\n$$\n我们对两边进行积分：\n$$\n\\int \\frac{dr}{r} = \\int 2\\frac{\\cos\\theta}{\\sin\\theta}\\,d\\theta\n$$\n积分得到：\n$$\n\\ln(r) = 2\\ln(\\sin\\theta) + C\n$$\n其中 $C$ 是积分常数。请注意，由于在北半球 $r>0$ 且 $\\sin\\theta \\ge 0$（我们可以通过对称性进行推广），因此可以省略绝对值符号。利用对数的性质重新整理：\n$$\n\\ln(r) = \\ln(\\sin^2\\theta) + C\n$$\n对两边取指数，得到磁力线的通解方程：\n$$\nr = \\exp(\\ln(\\sin^2\\theta) + C) = \\exp(C) \\sin^2\\theta\n$$\n让我们定义一个新常数 $C_0 = \\exp(C)$。磁力线方程为 $r = C_0 \\sin^2\\theta$。\n\n现在我们将其与磁纬 $\\lambda$ 和 McIlwain $L$ 参数联系起来。给定 $\\lambda = \\frac{\\pi}{2} - \\theta$，这意味着 $\\theta = \\frac{\\pi}{2} - \\lambda$。将此代入方程：\n$$\nr = C_0 \\sin^2\\left(\\frac{\\pi}{2} - \\lambda\\right) = C_0 \\cos^2\\lambda\n$$\n常数 $C_0$ 可以通过考虑磁力线的赤道穿越来确定。在磁赤道处，$\\lambda=0$ 且 $r=r_{\\mathrm{eq}}$。将这些值代入我们的方程：\n$$\nr_{\\mathrm{eq}} = C_0 \\cos^2(0) = C_0 (1)^2 = C_0\n$$\n因此，积分常数 $C_0$ 就是赤道穿越距离 $r_{\\mathrm{eq}}$。磁力线方程为：\n$$\nr = r_{\\mathrm{eq}} \\cos^2\\lambda\n$$\n最后，我们使用 McIlwain $L$ 参数的定义，$L \\equiv r_{\\mathrm{eq}}/R_E$，其中 $R_E$ 是地球的平均半径。这得到 $r_{\\mathrm{eq}} = L R_E$。将此代入磁力线方程，得到所需的关系式：\n$$\nr = L R_E \\cos^2\\lambda\n$$\n\n**任务2：L值的计算**\n\n给定磁层中的一个点，其地心距离 $r = 3R_E$，磁纬 $\\lambda = 30^{\\circ}$。我们使用任务1中推导的方程来求解穿过此点的磁力线的 $L$ 值。\n方程为 $r = L R_E \\cos^2\\lambda$。我们可以重新整理它来求解 $L$：\n$$\nL = \\frac{r}{R_E \\cos^2\\lambda}\n$$\n代入给定值 $r=3R_E$ 和 $\\lambda=30^{\\circ}$：\n$$\nL = \\frac{3R_E}{R_E \\cos^2(30^{\\circ})} = \\frac{3}{\\cos^2(30^{\\circ})}\n$$\n$\\cos(30^{\\circ})$ 的值为 $\\frac{\\sqrt{3}}{2}$。因此，$\\cos^2(30^{\\circ}) = \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = \\frac{3}{4}$。\n将此值代入 $L$ 的表达式中：\n$$\nL = \\frac{3}{\\frac{3}{4}} = 3 \\times \\frac{4}{3} = 4\n$$\n该磁力线的 McIlwain $L$ 值为 $4$。\n\n**任务3：一致性验证**\n\n我们需要验证与赤道映射的一致性。\n从任务2中，我们发现穿过 $(r=3R_E, \\lambda=30^{\\circ})$ 的磁力线的 $L$ 值为 $L=4$。\n使用 $L$ 参数的定义，我们求出该磁力线的赤道穿越距离 $r_{\\mathrm{eq}}$：\n$$\nL = \\frac{r_{\\mathrm{eq}}}{R_E} \\implies r_{\\mathrm{eq}} = L R_E = 4 R_E\n$$\n现在我们检查通用磁力线方程 $r = r_{\\mathrm{eq}}\\cos^2\\lambda$ 对于给定点 $(r=3R_E, \\lambda=30^{\\circ})$ 和计算出的 $r_{\\mathrm{eq}} = 4R_E$ 是否成立。\n我们将 $r_{\\mathrm{eq}}$ 和 $\\lambda$ 代入方程的右边：\n$$\nr_{\\mathrm{eq}}\\cos^2\\lambda = (4R_E)\\cos^2(30^{\\circ})\n$$\n如前所算，$\\cos^2(30^{\\circ}) = \\frac{3}{4}$。\n$$\nr_{\\mathrm{eq}}\\cos^2\\lambda = (4R_E) \\left(\\frac{3}{4}\\right) = 3R_E\n$$\n这个结果 $3R_E$ 正是该点的给定径向距离 $r$。关系式 $r = r_{\\mathrm{eq}}\\cos^2\\lambda$ 成立，证实了我们计算的一致性。\n所要求的最终答案是 $L$ 的数值。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "辐射带中的粒子是如何被加速到如此高的能量的？“绝热加速”是其中的关键机制之一，它发生在磁场缓慢变化的过程中。本练习将聚焦于“电子回旋加速”（betatron acceleration）过程，这是由第一绝热不变量（磁矩 $\\mu$）守恒所导致的垂直能量增加。通过计算磁场增强后电子获得的能量增益，您将具体理解磁层环境的宏观变化如何直接转化为微观粒子的能量增长 。",
            "id": "4233598",
            "problem": "一个被困在范艾伦辐射带闭合漂移壳层上的高能电子，其麦克伊尔文L参数（L）保持不变，而该壳层处的赤道磁场强度（用 $B_{eq}$ 表示）在一个时间尺度 $\\tau$ 内缓慢单调增加。该时间尺度 $\\tau$ 远大于电子的回旋周期，但远小于其碰撞散射时间。假设没有平行电场，且导心理论适用，因此在演化过程中第一绝热不变量（磁矩）是守恒的。仅使用带电粒子在磁化等离子体中运动的基本原理，确定电子的垂直动能 $E_{\\perp}$ 如何响应赤道处磁场的一个小的分数增量 $\\Delta B$。然后，对于固定L壳层上的赤道磁场分数增量为 $\\Delta B / B_{eq} = 0.20$ 的情况，计算垂直能量的乘法感应加速能量增益因子，定义为 $E_{\\perp,f}/E_{\\perp,i}$，其中下标 $i$ 和 $f$ 分别表示初始和最终状态。将最终答案表示为一个纯数字，无需四舍五入。",
            "solution": "该问题要求分析在缓慢变化的磁场影响下，范艾伦辐射带中高能电子的运动。在进行求解之前，需要对问题陈述进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 一个高能电子被困在一个闭合漂移壳上。\n- 麦克伊尔文L参数 $L$ 是固定的。\n- 壳层处的赤道磁场强度用 $B_{eq}$ 表示。\n- $B_{eq}$ 在一个时间尺度 $\\tau$ 内缓慢单调增加。\n- $\\tau$ 远大于电子的回旋周期。\n- $\\tau$ 远小于电子的碰撞散射时间。\n- 没有平行电场。\n- 导心理论适用。\n- 第一绝热不变量（磁矩）$\\mu$ 是守恒的。\n- 第一个任务是确定垂直动能 $E_{\\perp}$ 如何响应赤道磁场的一个小的分数增量 $\\Delta B$。\n- 第二个任务是计算当分数增量 $\\Delta B / B_{eq} = 0.20$ 时，乘法感应加速能量增益因子 $E_{\\perp,f}/E_{\\perp,i}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。\n- **科学合理性**：该问题描述了磁层中带电粒子的感应加速，这是等离子体天体物理学中的一个基本过程。关键条件——磁场相对于回旋周期的缓慢变化——是第一绝热不变量守恒的标准要求。所有前提都与等离子体物理学和导心理论的既定原理一致。\n- **提法恰当性**：问题给出了足够的信息以得出一个唯一解。磁矩守恒为我们关心的量（$E_{\\perp}$ 和 $B_{eq}$）之间提供了直接而明确的关系。\n- **客观性**：问题使用了磁层物理学中精确、标准的术语进行陈述，没有主观或含糊不清的语言。\n\n**结论：** 该问题被认定为有效。\n\n### 解题过程\n\n解题过程基于问题中陈述的基本原理：第一绝热不变量（即磁矩 $\\mu$）守恒。该原理成立的原因是，磁场变化的时间尺度远大于粒子的回旋周期，使得这种变化相对于回旋运动是“绝热的”。\n\n带电粒子的磁矩 $\\mu$ 定义为其垂直于磁场的动能 $E_{\\perp}$ 与局域磁场强度 $B$ 的比值：\n$$\n\\mu = \\frac{E_{\\perp}}{B}\n$$\n其中 $E_{\\perp} = \\frac{1}{2}mv_{\\perp}^2$，$m$ 是电子质量，$v_{\\perp}$ 是其速度垂直于磁场矢量的分量。\n\n$\\mu$ 守恒意味着这个比值在系统的整个演化过程中保持不变。因此，垂直动能 $E_{\\perp}$ 必须与磁场强度 $B$ 成正比变化。\n$$\nE_{\\perp} = \\mu B \\implies E_{\\perp} \\propto B\n$$\n这直接回答了问题的第一部分。对于磁场的一个小变化，从 $B$ 变为 $B + \\Delta B$，垂直能量从 $E_{\\perp}$ 变为 $E_{\\perp} + \\Delta E_{\\perp}$。这种关系意味着它们的分数变化是相等的：\n$$\n\\frac{\\Delta E_{\\perp}}{E_{\\perp}} = \\frac{\\Delta B}{B}\n$$\n这种能量增加机制被称为感应加速。\n\n对于问题的第二部分，我们比较电子的初始状态（下标 $i$）和最终状态（下标 $f$）。问题指明变化发生在赤道磁场 $B_{eq}$ 中。磁矩守恒表示为：\n$$\n\\mu = \\frac{E_{\\perp,i}}{B_{eq,i}} = \\frac{E_{\\perp,f}}{B_{eq,f}}\n$$\n这里，$E_{\\perp,i}$ 和 $B_{eq,i}$ 分别是初始垂直动能和初始赤道磁场，$E_{\\perp,f}$ 和 $B_{eq,f}$ 是它们的最终值。我们需要计算乘法感应加速能量增益因子，定义为比值 $E_{\\perp,f}/E_{\\perp,i}$。重新整理守恒方程可得：\n$$\n\\frac{E_{\\perp,f}}{E_{\\perp,i}} = \\frac{B_{eq,f}}{B_{eq,i}}\n$$\n问题陈述赤道磁场的分数增量为 $0.20$。这个分数增量是相对于初始场强定义的：\n$$\n\\frac{\\Delta B}{B_{eq}} = \\frac{B_{eq,f} - B_{eq,i}}{B_{eq,i}} = 0.20\n$$\n我们可以解这个方程，得到最终磁场强度与初始磁场强度之比：\n$$\n\\frac{B_{eq,f}}{B_{eq,i}} - 1 = 0.20\n$$\n$$\n\\frac{B_{eq,f}}{B_{eq,i}} = 1 + 0.20 = 1.20\n$$\n将此结果代入能量增益因子的表达式，我们得到：\n$$\n\\frac{E_{\\perp,f}}{E_{\\perp,i}} = 1.20\n$$\n因此，赤道磁场强度增加 $20\\%$ 会导致电子的垂直动能增加 $20\\%$。乘法能量增益因子为 $1.20$。",
            "answer": "$$\n\\boxed{1.20}\n$$"
        },
        {
            "introduction": "从单粒子行为转向整个粒子群的宏观动力学，是理解辐射带动态演化的关键一步。这项高级实践将引导您模拟辐射带的一个核心过程：径向扩散。您将从基本物理原理出发，推导出一个描述粒子在L壳中扩散和损失的一维演化方程，并为一次典型的亚暴注入事件建立一个解析模型。通过编码实现这个模型，您将亲身体验如何运用理论物理和计算方法来预测和解释范艾伦辐射带的结构、填充与耗散过程 。",
            "id": "4233594",
            "problem": "考虑外范艾伦辐射带中的电子，它们受到来自等离子体片的亚暴注入事件的影响。设相空间密度（PSD）$f(L,t)$ 定义在固定的第一和第二绝热不变量下，其中 $L$ 是麦克伊尔文 $L$ 壳参数，$t$ 是时间。从适用于天体物理等离子体物理学和磁层动力学的基本原理出发：刘维尔定理、导心不变量，以及引起第三不变量径向输运的随机波-粒子相互作用。推导一个关于 $f(L,t)$ 的一维演化方程，该方程能够描述由磁流体动力学超低频（ULF）波驱动的径向扩散物理过程，并包含一个表示投掷角散射进入大气损失锥的有限损失项。在您的推导中，明确说明将完整问题简化为关于 $L$ 和 $t$ 的一维偏微分方程的假设，该方程适用于脉冲注入位置周围一个狭窄的 $L$ 值范围。\n\n将一次亚暴注入事件建模为一个在 $t=0$ 时刻发生、集中在 $L \\approx 6$ 处的脉冲源，并假设这会用一个在 $L=6$ 附近急剧局域化的分布来初始化相空间密度。在注入点邻域内径向扩散系数空间均匀以及损失时间尺度空间均匀的简化假设下，获得在有效无界 $L$ 域上当 $t>0$ 时 $f(L,t)$ 的闭式表达式。您必须：\n- 论证将完整相空间演化简化为含损失项的 $L$ 空间一维扩散的合理性。\n- 确定适用于脉冲初始条件的格林函数解的结构。\n- 得出一个用注入幅度 $A$、扩散系数 $D_{\\mathrm{LL}}$、损失时间尺度 $\\tau$、注入位置 $L_0$ 以及评估点和时间 $(L,t)$ 表示的 $f(L,t)$ 的最终表达式。\n\n数值实现要求：\n- 将 $f(L,t)$ 视为无量纲量（归一化的PSD），$L$ 视为无量纲的 $L$ 壳，$t$ 的单位为小时，$D_{\\mathrm{LL}}$ 的单位为 $L^2/\\mathrm{小时}$，$\\tau$ 的单位为小时。\n- 使用一个在 $t=0$ 时刻、以 $L_0=6.0$ 为中心、幅度为 $A$ 的脉冲初始条件，并在指定的 $(L,t)$ 值处计算 $f(L,t)$。\n- 对于数值，将所有常数和参数表示为浮点数。\n\n测试组：\n评估所推导的 $f(L,t)$ 表达式在以下六个参数集下的值，每个参数集指定为 $(D_{\\mathrm{LL}},\\tau,A,L_0,L_{\\mathrm{eval}},t_{\\mathrm{eval}})$，单位如上所述：\n- 情况 1：$(0.02,12.0,1.0,6.0,5.5,2.0)$。\n- 情况 2：$(0.05,1000.0,1.0,6.0,7.0,1.5)$。\n- 情况 3：$(0.001,0.5,1.0,6.0,6.0,1.0)$。\n- 情况 4：$(0.01,10.0,1.0,6.0,6.2,0.01)$。\n- 情况 5：$(0.03,8.0,1.0,6.0,8.0,3.0)$。\n- 情况 6：$(0.005,20.0,0.5,6.0,5.9,4.0)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个条目等于对应情况下 $f(L_{\\mathrm{eval}},t_{\\mathrm{eval}})$ 的值，四舍五入到六位小数（例如，$[0.123456,0.654321,0.000001]$）。不允许有其他输出。未使用角度，因此不需要角度单位。所有时间必须以小时为单位处理，所有扩散系数必须以 $L^2/\\mathrm{小时}$ 为单位处理。",
            "solution": "该问题要求推导并求解地球外辐射带中电子相空间密度（PSD）的一维演化方程，该方程考虑了径向扩散和粒子损失。这是磁层等离子体物理学中的一个经典问题。\n\n**1. 基本原理**\n\n相空间中粒子分布的演化由玻尔兹曼方程控制。对于磁层中的无碰撞等离子体，该方程简化为相空间密度 $f(\\mathbf{r}, \\mathbf{p}, t)$ 的弗拉索夫方程：\n$$\n\\frac{\\partial f}{\\partial t} + \\mathbf{v} \\cdot \\nabla_{\\mathbf{r}} f + q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\nabla_{\\mathbf{p}} f = 0\n$$\n其中 $\\mathbf{r}$ 是位置，$\\mathbf{p}$ 是动量，$t$ 是时间，$\\mathbf{v}$ 是速度，$q$ 是电荷，$\\mathbf{E}$ 和 $\\mathbf{B}$ 分别是电场和磁场。刘维尔定理是该方程在哈密顿系统下的一个推论，它指出相空间密度沿粒子在相空间中的轨迹是守恒的（$df/dt = 0$）。\n\n对于被行星磁场捕获的粒子，方便的做法是从 $(\\mathbf{r}, \\mathbf{p})$ 坐标转换到一组基于绝热不变量的坐标。绝热不变量是与粒子运动的三个周期性分量相关的近似守恒量：\n1.  第一绝热不变量 $\\mu$，与粒子围绕磁力线的快速回旋运动有关。\n2.  第二绝热不变量 $J$，与粒子在磁镜点之间的反弹运动有关。\n3.  第三绝热不变量 $\\Phi_d$，与粒子围绕地球的缓慢漂移运动有关。麦克伊尔文 $L$ 壳参数是它的一个代表，在偶极子场中 $\\Phi_d \\propto 1/L$。\n\n在这些坐标系中，相空间密度表示为 $f(\\mu, J, L, t)$。如果所有不变量都完全守恒，那么对于给定的粒子群，$f$ 将是一个常数。然而，波-粒子相互作用可以破坏这些不变量，导致相空间中的输运。\n\n**2. 一维径向扩散方程的推导**\n\n当与波的相互作用引起不变量的微小随机变化时，相空间密度的演化不再由简单的弗拉索夫方程描述，而是由考虑了随机输运的福克-普朗克方程描述。其一般形式为：\n$$\n\\frac{\\partial f}{\\partial t} = \\sum_{i,j} \\frac{\\partial}{\\partial \\alpha_i} \\left( D_{ij} \\frac{\\partial f}{\\partial \\alpha_j} \\right) - \\mathcal{L} + \\mathcal{S}\n$$\n其中 $\\alpha_i, \\alpha_j \\in \\{\\mu, J, L\\}$ 是不变量坐标，$D_{ij}$ 是扩散张量的元素，$\\mathcal{L}$ 是损失算子，$\\mathcal{S}$ 是源算子。\n\n该问题要求我们将这个通用方程简化为关于 $L$ 和 $t$ 的一维方程。这种简化基于以下假设是合理的：\n\n*   **固定的粒子群**：我们在固定的第一和第二不变量 $\\mu$ 和 $J$ 下考虑相空间密度。这意味着我们正在分析一个特定的电子群体（例如，在给定的 $L$ 壳上具有固定能量和赤道投掷角的电子）。这排除了我们对 $\\mu$ 和 $J$ 空间扩散的直接考虑，使 $f$ 成为函数 $f(L,t)$。\n*   **径向扩散占主导地位**：问题指明径向输运是由磁流体动力学超低频（ULF）波驱动的。这些波的频率与粒子的漂移频率（数分钟到数十分钟）相当。与这些波的共振相互作用主要破坏第三绝热不变量，导致粒子跨 $L$ 壳扩散。我们假设这是主导的输运机制。\n*   **简化的损失项**：由其他波（如哨声模合声波或嘶声波）引起的投掷角散射会破坏 $\\mu$ 和 $J$，将粒子散射到大气损失锥中。我们不对此复杂的投掷角空间扩散过程进行建模，而是将其简化为一个单一的损失项 $\\mathcal{L} = f/\\tau$，其中 $\\tau$ 是一个特征损失时间尺度。如果沉降的时间尺度远快于从损失锥中反向散射出来的时间尺度，这是一个有效的近似。\n*   **简化的扩散算子**：径向扩散通量守恒的正式表达式会导出一个形如 $L^2 \\frac{\\partial}{\\partial L} \\left( \\frac{D_{LL}}{L^2} \\frac{\\partial f}{\\partial L} \\right)$ 的项。然而，问题指明分析是针对一个“狭窄的 $L$ 范围”，并假设“径向扩散系数在空间上是均匀的”($D_{LL}$)。在这种局域近似下，几何因子 $L^2$ 被视为常数，并可以被吸收到一个有效的扩散系数中，从而将算子简化为 $D_{LL} \\frac{\\partial^2 f}{\\partial L^2}$。\n\n有了这些理由和假设（常数 $D_{LL}$ 和 $\\tau$），完整的福克-普朗克方程简化为关于 $f(L,t)$ 的一维反应扩散方程：\n$$\n\\frac{\\partial f}{\\partial t} = D_{LL} \\frac{\\partial^2 f}{\\partial L^2} - \\frac{f}{\\tau} + S(L,t)\n$$\n其中 $S(L,t)$ 是一个源项。\n\n**3. 脉冲源的解**\n\n问题要求解出一次亚暴注入后的解，该注入被建模为一个“在 $t=0$ 时刻发生、集中在 $L \\approx 6$ 处的脉冲源”。这对应于一个瞬时源，它为 $t > 0$ 时的演化设定了初始条件。我们将其建模为：\n$$\nf(L, t=0^+) = A \\, \\delta(L-L_0)\n$$\n其中 $A$ 是注入的幅度，$L_0 = 6.0$ 是注入位置，$\\delta(\\cdot)$ 是狄拉克δ函数。对于 $t > 0$，源项 $S(L,t)$ 为零，我们必须求解齐次偏微分方程：\n$$\n\\frac{\\partial f}{\\partial t} = D_{LL} \\frac{\\partial^2 f}{\\partial L^2} - \\frac{f}{\\tau}\n$$\n这是一个标准的线性偏微分方程。我们可以通过代换 $f(L,t) = g(L,t) e^{-t/\\tau}$ 来简化它。求导并代入偏微分方程，我们发现损失项被消除了：\n$$\n\\left(\\frac{\\partial g}{\\partial t} e^{-t/\\tau} - \\frac{g}{\\tau} e^{-t/\\tau}\\right) = D_{LL} \\left(\\frac{\\partial^2 g}{\\partial L^2} e^{-t/\\tau}\\right) - \\frac{g e^{-t/\\tau}}{\\tau}\n$$\n$$\n\\implies \\frac{\\partial g}{\\partial t} = D_{LL} \\frac{\\partial^2 g}{\\partial L^2}\n$$\n这是标准的热传导或扩散方程。$g$ 的初始条件是 $g(L,0) = f(L,0) e^0 = A \\, \\delta(L-L_0)$。\n\n对于δ函数初始条件，热传导方程在无界域 ($-\\infty  L  \\infty$) 上的解是它的格林函数，即一个高斯函数：\n$$\ng(L,t) = \\frac{A}{\\sqrt{4 \\pi D_{LL} t}} \\exp\\left( -\\frac{(L-L_0)^2}{4 D_{LL} t} \\right)\n$$\n指数项描述了初始脉冲的扩散性传播，而前置因子确保了总量 $\\int g(L,t) \\, dL = A$ 的守恒。\n\n最后，我们通过乘以衰减因子 $e^{-t/\\tau}$ 转换回原始函数 $f(L,t)$。\n\n**4. $f(L,t)$ 的最终表达式**\n\n脉冲注入后相空间密度 $f(L,t)$ 的闭式表达式是扩散解与损失项的乘积：\n$$\nf(L,t) = \\frac{A}{\\sqrt{4 \\pi D_{LL} t}} \\exp\\left( -\\frac{(L-L_0)^2}{4 D_{LL} t} \\right) e^{-t/\\tau}\n$$\n这可以合并成一个单一的表达式：\n$$\nf(L,t) = \\frac{A}{\\sqrt{4 \\pi D_{LL} t}} \\exp\\left( -\\frac{(L-L_0)^2}{4 D_{LL} t} - \\frac{t}{\\tau} \\right)\n$$\n该方程给定了注入幅度 $A$、注入位置 $L_0$、径向扩散系数 $D_{LL}$ 和损失时间尺度 $\\tau$ 的情况下，在任何评估点 $(L,t)$ 处的相空间密度。现在将对该解进行数值实现，以评估给定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the phase space density f(L,t) for electrons in the \n    Van Allen belts modeled by a 1D reaction-diffusion equation.\n    \n    The solution is based on the Green's function for the diffusion equation\n    with an exponential loss term, corresponding to an impulsive initial\n    injection. The formula is:\n    f(L,t) = (A / sqrt(4*pi*D_LL*t)) * exp( -((L-L0)^2 / (4*D_LL*t)) - (t/tau) )\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (D_LL, tau, A, L0, L_eval, t_eval)\n    test_cases = [\n        # (D_LL [L^2/hour], tau [hour], A [dimensionless], L0 [L-shell], L_eval [L-shell], t_eval [hour])\n        (0.02, 12.0, 1.0, 6.0, 5.5, 2.0),\n        (0.05, 1000.0, 1.0, 6.0, 7.0, 1.5),\n        (0.001, 0.5, 1.0, 6.0, 6.0, 1.0),\n        (0.01, 10.0, 1.0, 6.0, 6.2, 0.01),\n        (0.03, 8.0, 1.0, 6.0, 8.0, 3.0),\n        (0.005, 20.0, 0.5, 6.0, 5.9, 4.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        D_LL, tau, A, L0, L_eval, t_eval = case\n\n        # Ensure t_eval is positive to avoid division by zero or domain errors.\n        if t_eval == 0:\n            # For t=0, the solution is a delta function, infinite at L=L0 and 0 elsewhere.\n            # Here, we treat very small positive times as finite. If t is exactly 0 and L!=L0, f=0.\n            # Given L=6.2 and L0=6.0, if t_eval=0, f would be 0.\n            # The problem gives a small positive t_eval=0.01, so this check is for robustness.\n            results.append(\"0.000000\") # As per standard interpretation of delta function away from center.\n            continue\n            \n        # Calculate the denominator of the pre-factor\n        prefactor_denom = np.sqrt(4.0 * np.pi * D_LL * t_eval)\n        \n        # Calculate the pre-factor\n        prefactor = A / prefactor_denom\n        \n        # Calculate the spatial part of the exponential argument\n        exp_arg_spatial = -((L_eval - L0)**2) / (4.0 * D_LL * t_eval)\n        \n        # Calculate the temporal loss part of the exponential argument\n        exp_arg_loss = -t_eval / tau\n        \n        # Calculate the full exponential term\n        exp_term = np.exp(exp_arg_spatial + exp_arg_loss)\n        \n        # Calculate the final phase space density\n        f_Lt = prefactor * exp_term\n        \n        # Format the result to six decimal places and append to the list\n        results.append(f\"{f_Lt:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}