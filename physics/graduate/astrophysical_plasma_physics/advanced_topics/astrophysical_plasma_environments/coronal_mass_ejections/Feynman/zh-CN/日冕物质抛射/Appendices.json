{
    "hands_on_practices": [
        {
            "introduction": "日冕物质抛射（CME）的能量储存在日冕磁场中，尤其是在非势场（non-potential field）结构中。本练习  介绍了一种从光球层矢量磁图诊断活动区爆发潜力的核心方法。通过计算与观测到的垂直磁场分量相对应的势场（能量最低态），并将其与观测到的水平磁场进行比较，我们可以估算可供爆发释放的自由磁能和磁剪切角，这些是预测CME是否可能发生的关键指标。",
            "id": "4211614",
            "problem": "一个光球矢量磁像图在矩形笛卡尔网格上提供了观测到的磁场分量：在 $z=0$ 处的水平分量 $B_x^{\\mathrm{obs}}(x_i,y_j)$ 和 $B_y^{\\mathrm{obs}}(x_i,y_j)$，以及垂直分量 $B_z^{\\mathrm{obs}}(x_i,y_j)$。考虑在半空间 $z0$ 中的势场，其由静磁条件 $\\nabla \\times \\mathbf{B}= \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$ 定义，边界条件为 $B_z(x,y,0)=B_z^{\\mathrm{obs}}(x,y)$。使用标量势 $\\Phi$ 使得 $\\mathbf{B}=-\\nabla \\Phi$ 和 $\\nabla^2 \\Phi = 0$，势场在 $z=0$ 处的水平分量可以在空间傅里叶域中从 $B_z^{\\mathrm{obs}}$ 获得。对于每个水平波数 $(k_x,k_y)$，其中 $k=\\sqrt{k_x^2+k_y^2}$，当 $k\\neq 0$ 时，关系式为 $B_x^{\\mathrm{pot}}(k_x,k_y)=-\\mathrm{i}\\,(k_x/k)\\,B_z(k_x,k_y)$ 和 $B_y^{\\mathrm{pot}}(k_x,k_y)=-\\mathrm{i}\\,(k_y/k)\\,B_z(k_x,k_y)$；当 $k=0$ 时，$B_x^{\\mathrm{pot}}=B_y^{\\mathrm{pot}}=0$。快速傅里叶逆变换 (FFT) 得到 $B_x^{\\mathrm{pot}}(x_i,y_j)$ 和 $B_y^{\\mathrm{pot}}(x_i,y_j)$。\n\n将每个像素点的剪切角定义为观测到的水平场矢量与势场水平场矢量之间的夹角，\n$$\n\\psi(x_i,y_j)=\\arccos\\left(\\frac{B_x^{\\mathrm{obs}}B_x^{\\mathrm{pot}}+B_y^{\\mathrm{obs}}B_y^{\\mathrm{pot}}}{\\sqrt{\\left(B_x^{\\mathrm{obs}}\\right)^2+\\left(B_y^{\\mathrm{obs}}\\right)^2}\\,\\sqrt{\\left(B_x^{\\mathrm{pot}}\\right)^2+\\left(B_y^{\\mathrm{pot}}\\right)^2}}\\right),\n$$\n仅在两个水平场强度都超过阈值 $b_{\\min}$ 时计算，以避免除以零和数值奇异点。设平均剪切角为所有有效像素的算术平均值。平均剪切角以弧度表示。\n\n作为表面自由磁能的代理量，使用光球层上观测到的水平场与势场水平场之间的差异，定义在一个特征厚度 $h$ 上的柱积分能量密度，\n$$\nu_{\\mathrm{free}}(x_i,y_j) = \\frac{1}{2\\mu_0} \\left[\\left(B_x^{\\mathrm{obs}}-B_x^{\\mathrm{pot}}\\right)^2+\\left(B_y^{\\mathrm{obs}}-B_y^{\\mathrm{pot}}\\right)^2\\right]\\,h,\n$$\n其中 $\\mu_0$ 是真空磁导率。于是，总自由能代理量为\n$$\nE_{\\mathrm{free}}=\\sum_{i,j} u_{\\mathrm{free}}(x_i,y_j)\\,\\Delta x\\,\\Delta y,\n$$\n必须以焦耳为单位报告。为了评估该区域是否接近日冕物质抛射 (CME) 的爆发阈值，如果 $E_{\\mathrm{free}}\\ge E_{\\mathrm{th}}$ 且平均剪切角 $\\bar{\\psi}\\ge \\psi_{\\mathrm{th}}$，则声明该区域为“接近阈值”，其中 $E_{\\mathrm{th}}$ 和 $\\psi_{\\mathrm{th}}$ 是指定的常数。\n\n仅从上述静磁原理和定义出发，实现傅里叶域势场推导，并为以下测试套件计算平均剪切角和总自由能代理量。使用给定的真空磁导率 $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{N/A^2}$、特征厚度 $h$、像素间距 $\\Delta x$ 和 $\\Delta y$，以及剪切阈值 $b_{\\min}$。所有磁场单位为特斯拉，距离单位为米，角度单位为弧度，能量单位为焦耳。使用给定的爆发阈值 $E_{\\mathrm{th}}$ 和 $\\psi_{\\mathrm{th}}$。\n\n测试套件参数和磁像图：\n\n- 公共参数：\n  - 像素间距: $\\Delta x=\\Delta y=10^{6}\\ \\mathrm{m}$。\n  - 柱厚度: $h=5\\times 10^{6}\\ \\mathrm{m}$。\n  - 剪切计算阈值: $b_{\\min}=10^{-3}\\ \\mathrm{T}$。\n  - 爆发阈值: $E_{\\mathrm{th}}=10^{24}\\ \\mathrm{J}$ 和 $\\psi_{\\mathrm{th}}=0.5\\ \\mathrm{rad}$。\n\n- 测试用例 1 (“双极，剪切”)：\n  - $B_z^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0.05  0.05  -0.05  -0.05\\\\\n    0.05  0.05  -0.05  -0.05\\\\\n    0.05  0.05  -0.05  -0.05\\\\\n    0.05  0.05  -0.05  -0.05\n    \\end{bmatrix}\n    $$\n  - $B_x^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0.05  0.05  0.05  0.05\\\\\n    0.05  0.05  0.05  0.05\\\\\n    -0.05  -0.05  -0.05  -0.05\\\\\n    -0.05  -0.05  -0.05  -0.05\n    \\end{bmatrix}\n    $$\n  - $B_y^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0.05  0.05  -0.05  -0.05\\\\\n    0.05  0.05  -0.05  -0.05\\\\\n    0.05  0.05  -0.05  -0.05\\\\\n    0.05  0.05  -0.05  -0.05\n    \\end{bmatrix}\n    $$\n\n- 测试用例 2 (“均匀，低剪切”)：\n  - $B_z^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0.02  0.02  0.02  0.02\\\\\n    0.02  0.02  0.02  0.02\\\\\n    0.02  0.02  0.02  0.02\\\\\n    0.02  0.02  0.02  0.02\n    \\end{bmatrix}\n    $$\n  - $B_x^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0  0  0  0\\\\\n    0  0  0  0\\\\\n    0  0  0  0\\\\\n    0  0  0  0\n    \\end{bmatrix}\n    $$\n  - $B_y^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0  0  0  0\\\\\n    0  0  0  0\\\\\n    0  0  0  0\\\\\n    0  0  0  0\n    \\end{bmatrix}\n    $$\n\n- 测试用例 3 (“近阈值，强横向场”)：\n  - $B_z^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0.02  0.00  -0.02  0.00\\\\\n    0.00  0.02  0.00  -0.02\\\\\n    -0.02  0.00  0.02  0.00\\\\\n    0.00  -0.02  0.00  0.02\n    \\end{bmatrix}\n    $$\n  - $B_x^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0.18  0.18  0.18  0.18\\\\\n    0.18  0.18  0.18  0.18\\\\\n    0.18  0.18  0.18  0.18\\\\\n    0.18  0.18  0.18  0.18\n    \\end{bmatrix}\n    $$\n  - $B_y^{\\mathrm{obs}}$:\n    $$\n    \\begin{bmatrix}\n    0.00  0.00  0.00  0.00\\\\\n    0.00  0.00  0.00  0.00\\\\\n    0.00  0.00  0.00  0.00\\\\\n    0.00  0.00  0.00  0.00\n    \\end{bmatrix}\n    $$\n\n您的程序必须：\n- 通过上述傅里叶域势场方法，使用 $\\Delta x$ 和 $\\Delta y$ 来构建单位为 $\\mathrm{rad/m}$ 的正确波数，从 $B_z^{\\mathrm{obs}}$ 计算 $B_x^{\\mathrm{pot}}$ 和 $B_y^{\\mathrm{pot}}$。\n- 计算平均剪切角 $\\bar{\\psi}$（单位为弧度），仅对满足 $\\sqrt{\\left(B_x^{\\mathrm{obs}}\\right)^2+\\left(B_y^{\\mathrm{obs}}\\right)^2}b_{\\min}$ 和 $\\sqrt{\\left(B_x^{\\mathrm{pot}}\\right)^2+\\left(B_y^{\\mathrm{pot}}\\right)^2}b_{\\min}$ 的像素进行平均。如果没有像素满足此条件，则设 $\\bar{\\psi}=0$。\n- 使用给定的 $\\mu_0$、$h$、$\\Delta x$ 和 $\\Delta y$ 计算总自由能代理量 $E_{\\mathrm{free}}$（单位为焦耳）。\n- 如果 $E_{\\mathrm{free}}\\ge E_{\\mathrm{th}}$ 且 $\\bar{\\psi}\\ge \\psi_{\\mathrm{th}}$，则将布尔值“接近阈值”评估为真，否则为假。\n\n最终输出格式：\n- 生成单行内容，包含一个用方括号括起来的、逗号分隔的三个测试用例的结果列表。每个测试用例的结果本身是一个包含三项的列表：平均剪切角（四舍五入到6位小数，单位为弧度），总自由能代理量（四舍五入到3位有效数字，单位为焦耳），以及布尔值“接近阈值”。例如，输出应类似于 $[[\\bar{\\psi}_1,E_{\\mathrm{free},1},\\mathrm{bool}_1],[\\bar{\\psi}_2,E_{\\mathrm{free},2},\\mathrm{bool}_2],[\\bar{\\psi}_3,E_{\\mathrm{free},3},\\mathrm{bool}_3]]$，并按规定进行数值舍入。",
            "solution": "推导和算法源于静磁学基本原理和经过充分检验的定义。在静磁近似中，光球磁场被视作稳态场，因此 $\\partial \\mathbf{B}/\\partial t=\\mathbf{0}$。使用真空或低频极限下的麦克斯韦方程组，可得 $\\nabla \\cdot \\mathbf{B}=\\mathbf{0}$，并且对于势场，不存在电流意味着 $\\nabla \\times \\mathbf{B}=\\mathbf{0}$。这两个关系保证了 $\\mathbf{B}$ 可由标量势 $\\Phi$ 通过 $\\mathbf{B}=-\\nabla \\Phi$ 导出，并且 $\\Phi$ 满足拉普拉斯方程 $\\nabla^2 \\Phi=0$。\n\n考虑半空间 $z0$，其边界条件为 $B_z(x,y,0)=B_z^{\\mathrm{obs}}(x,y)$，且当 $z\\to +\\infty$ 时 $\\Phi$ 衰减。对边界场进行二维空间傅里叶变换，将 $B_z(k_x,k_y,0)$ 定义为波数 $(k_x,k_y)$ 处的傅里叶振幅。对于每个 $(k_x,k_y)$，$\\nabla^2 \\Phi=0$ 的通解是 $\\Phi(k_x,k_y,z)=\\Phi(k_x,k_y,0)\\,\\mathrm{e}^{-k z}$，其中 $k=\\sqrt{k_x^2+k_y^2}$，并选择衰减分支以确保在无穷远处的物理行为。边界处的垂直场为 $B_z(k_x,k_y,0)=-\\partial \\Phi/\\partial z|_{z=0}=k\\,\\Phi(k_x,k_y,0)$，因此当 $k\\neq 0$ 时 $\\Phi(k_x,k_y,0)=B_z(k_x,k_y,0)/k$。边界处的水平场分量可从 $\\mathbf{B}=-\\nabla \\Phi$ 得出：\n$$\nB_x(k_x,k_y,0)=-\\frac{\\partial \\Phi}{\\partial x}=-\\mathrm{i}k_x\\,\\Phi(k_x,k_y,0)=-\\mathrm{i}\\frac{k_x}{k}\\,B_z(k_x,k_y,0),\n$$\n$$\nB_y(k_x,k_y,0)=-\\frac{\\partial \\Phi}{\\partial y}=-\\mathrm{i}k_y\\,\\Phi(k_x,k_y,0)=-\\mathrm{i}\\frac{k_y}{k}\\,B_z(k_x,k_y,0),\n$$\n按照惯例，对于零波数模式 $k=0$，有 $B_x=B_y=0$，因为在此处 $\\Phi$ 是不确定的，并且物理相关的均匀模式不会产生水平场。对 $B_x(k_x,k_y,0)$ 和 $B_y(k_x,k_y,0)$ 应用二维快速傅里叶逆变换 (FFT) 可得到实空间中的水平势场 $B_x^{\\mathrm{pot}}(x_i,y_j)$ 和 $B_y^{\\mathrm{pot}}(x_i,y_j)$。\n\n每个像素的剪切角由观测到的横向矢量 $\\mathbf{B}_t^{\\mathrm{obs}}=\\left(B_x^{\\mathrm{obs}},B_y^{\\mathrm{obs}}\\right)$ 与势场横向矢量 $\\mathbf{B}_t^{\\mathrm{pot}}=\\left(B_x^{\\mathrm{pot}},B_y^{\\mathrm{pot}}\\right)$ 之间的夹角定义：\n$$\n\\psi(x_i,y_j)=\\arccos\\left(\\frac{\\mathbf{B}_t^{\\mathrm{obs}}\\cdot \\mathbf{B}_t^{\\mathrm{pot}}}{\\left\\|\\mathbf{B}_t^{\\mathrm{obs}}\\right\\|\\,\\left\\|\\mathbf{B}_t^{\\mathrm{pot}}\\right\\|}\\right)=\\arccos\\left(\\frac{B_x^{\\mathrm{obs}}B_x^{\\mathrm{pot}}+B_y^{\\mathrm{obs}}B_y^{\\mathrm{pot}}}{\\sqrt{\\left(B_x^{\\mathrm{obs}}\\right)^2+\\left(B_y^{\\mathrm{obs}}\\right)^2}\\,\\sqrt{\\left(B_x^{\\mathrm{pot}}\\right)^2+\\left(B_y^{\\mathrm{pot}}\\right)^2}}\\right).\n$$\n为确保数值稳定性，仅使用具有足够强横向场的像素，特别是那些满足 $\\left\\|\\mathbf{B}_t^{\\mathrm{obs}}\\right\\|b_{\\min}$ 和 $\\left\\|\\mathbf{B}_t^{\\mathrm{pot}}\\right\\|b_{\\min}$ 的像素。平均剪切角 $\\bar{\\psi}$ 是有效像素上的简单算术平均值。如果没有像素满足该标准，则按惯例设 $\\bar{\\psi}=0$。\n\n对于自由能代理量，静磁极限下的磁能密度为 $u=B^2/(2\\mu_0)$。由于势场在给定法向分量的情况下使磁能最小化，一个常用的光球自由能密度代理量采用了边界处的横向场差异：\n$$\nu_{\\mathrm{free}}(x_i,y_j)=\\frac{1}{2\\mu_0}\\left\\|\\mathbf{B}_t^{\\mathrm{obs}}-\\mathbf{B}_t^{\\mathrm{pot}}\\right\\|^2\\,h=\\frac{1}{2\\mu_0}\\left[\\left(B_x^{\\mathrm{obs}}-B_x^{\\mathrm{pot}}\\right)^2+\\left(B_y^{\\mathrm{obs}}-B_y^{\\mathrm{pot}}\\right)^2\\right]\\,h,\n$$\n其中 $h$ 是一个特征柱厚度，光球横向应力被认为在此厚度上合理分布。总自由能代理量通过在像素面积为 $\\Delta A=\\Delta x\\,\\Delta y$ 的离散网格上求和得到：\n$$\nE_{\\mathrm{free}}=\\sum_{i,j} u_{\\mathrm{free}}(x_i,y_j)\\,\\Delta A.\n$$\n当 $B$ 的单位是特斯拉，$\\mu_0$ 的单位是 $\\mathrm{N/A^2}$，$h$ 的单位是米，$\\Delta A$ 的单位是 $\\mathrm{m^2}$ 时，这将得到以焦耳为单位的能量。\n\n爆发阈值评估被编码为一个使用经验阈值 $E_{\\mathrm{th}}$ 和 $\\psi_{\\mathrm{th}}$ 的逻辑测试：如果 $E_{\\mathrm{free}}\\ge E_{\\mathrm{th}}$ 且 $\\bar{\\psi}\\ge \\psi_{\\mathrm{th}}$，该区域被视为“接近阈值”；否则，则不是。虽然这不能保证爆发，但它反映了显著的非势性（剪切）和自由能同时存在，这在观测上与许多活动区中增加的爆发潜力相关。\n\n算法实现细节：\n- 使用具有物理间距的 FFT 约定构建波数：$k_x=2\\pi\\,\\mathrm{fftfreq}(N_x,\\Delta x)$ 和 $k_y=2\\pi\\,\\mathrm{fftfreq}(N_y,\\Delta y)$，然后在一个能感知索引的 $(N_y,N_x)$ 网格上形成 $k=\\sqrt{k_x^2+k_y^2}$。这确保了傅里叶域关系在量纲上是一致的，单位为 $\\mathrm{rad/m}$。\n- 使用上述公式计算 $B_x^{\\mathrm{pot}}(k_x,k_y)$ 和 $B_y^{\\mathrm{pot}}(k_x,k_y)$，通过将 $k=0$ 模式显式地设置为零来处理。\n- 应用傅里叶逆变换得到 $B_x^{\\mathrm{pot}}(x_i,y_j)$ 和 $B_y^{\\mathrm{pot}}(x_i,y_j)$，并取其实部，因为物理场是实数。\n- 对于剪切角，计算每个像素的点积和模，将余弦函数的参数裁剪到区间 $[-1,1]$ 内以避免计算舍入问题，并在有效像素掩码上计算 $\\arccos$。\n- 对于能量代理量，计算每个像素的横向差异的平方，乘以 $(1/(2\\mu_0))\\,h$，然后在乘以像素面积 $\\Delta x\\,\\Delta y$ 后对整个网格求和。\n- 应用阈值逻辑并为每个测试用例准备输出：平均剪切角（四舍五入到6位小数，单位弧度），总自由能代理量（四舍五入到3位有效数字，单位焦耳），以及布尔标志。\n\n该测试套件探讨了不同的情况：一个带有施加剪切的双极分布，用以检验势场和角度的计算；一个均匀的低剪切情况，作为横向场消失时的边界条件测试；以及一个近阈值的强横向场情况，旨在产生接近 $E_{\\mathrm{th}}$ 且具有可观剪切的自由能代理量。最终程序以指定的单行格式汇集结果，确保了在能够执行 FFT 和数组计算的现代编程环境中的普适性。",
            "answer": "```python\nimport numpy as np\nimport math\n\n# Constants\nMU0 = 4.0 * math.pi * 1e-7  # vacuum permeability in N/A^2\n\ndef fft_potential_horizontal(Bz, dx, dy):\n    \"\"\"\n    Compute horizontal potential field components at z=0 from Bz using FFT.\n\n    Parameters:\n        Bz: 2D numpy array (ny, nx) of observed vertical magnetic field (Tesla)\n        dx: pixel spacing in x (m)\n        dy: pixel spacing in y (m)\n\n    Returns:\n        Bx_pot, By_pot: 2D numpy arrays (ny, nx) of horizontal potential field (Tesla)\n    \"\"\"\n    ny, nx = Bz.shape\n    # Forward FFT of Bz\n    Bz_k = np.fft.fft2(Bz)\n\n    # Wavenumber arrays (rad/m)\n    kx = 2.0 * math.pi * np.fft.fftfreq(nx, d=dx)\n    ky = 2.0 * math.pi * np.fft.fftfreq(ny, d=dy)\n    KY, KX = np.meshgrid(ky, kx, indexing='ij')  # shapes (ny, nx)\n\n    K = np.sqrt(KX**2 + KY**2)\n\n    # Avoid division by zero at K=0\n    nonzero = K != 0.0\n    Bx_k = np.zeros_like(Bz_k, dtype=complex)\n    By_k = np.zeros_like(Bz_k, dtype=complex)\n\n    # Apply Fourier-domain relations: Bx = -i (kx/k) Bz, By = -i (ky/k) Bz\n    Bx_k[nonzero] = -1j * (KX[nonzero] / K[nonzero]) * Bz_k[nonzero]\n    By_k[nonzero] = -1j * (KY[nonzero] / K[nonzero]) * Bz_k[nonzero]\n\n    # Inverse FFT to real space\n    Bx_pot = np.fft.ifft2(Bx_k).real\n    By_pot = np.fft.ifft2(By_k).real\n\n    return Bx_pot, By_pot\n\ndef mean_shear_angle(Bx_obs, By_obs, Bx_pot, By_pot, bmin=1e-3):\n    \"\"\"\n    Compute mean shear angle between observed and potential horizontal fields.\n\n    Parameters:\n        Bx_obs, By_obs: observed horizontal field components (Tesla)\n        Bx_pot, By_pot: potential horizontal field components (Tesla)\n        bmin: threshold for valid magnitude (Tesla)\n\n    Returns:\n        mean_angle: mean shear angle over valid pixels (radians)\n    \"\"\"\n    # Magnitudes\n    obs_mag = np.sqrt(Bx_obs**2 + By_obs**2)\n    pot_mag = np.sqrt(Bx_pot**2 + By_pot**2)\n    valid = (obs_mag  bmin)  (pot_mag  bmin)\n\n    if not np.any(valid):\n        return 0.0\n\n    # Dot product and cosine\n    dot = Bx_obs * Bx_pot + By_obs * By_pot\n    denom = obs_mag * pot_mag\n    cosang = np.zeros_like(dot)\n    cosang[valid] = dot[valid] / denom[valid]\n    # Numerical safety\n    cosang = np.clip(cosang, -1.0, 1.0)\n    angles = np.arccos(cosang[valid])\n\n    mean_angle = float(np.mean(angles))\n    return mean_angle\n\ndef free_energy_proxy(Bx_obs, By_obs, Bx_pot, By_pot, dx, dy, h, mu0=MU0):\n    \"\"\"\n    Compute total free energy proxy from transverse field difference.\n\n    Parameters:\n        Bx_obs, By_obs: observed horizontal field components (Tesla)\n        Bx_pot, By_pot: potential horizontal field components (Tesla)\n        dx, dy: pixel spacing (m)\n        h: column thickness (m)\n        mu0: vacuum permeability (N/A^2)\n\n    Returns:\n        E_free: total free energy proxy (Joules)\n    \"\"\"\n    dBx = Bx_obs - Bx_pot\n    dBy = By_obs - By_pot\n    delta_sq = dBx**2 + dBy**2  # Tesla^2\n    u_surface = (0.5 / mu0) * delta_sq * h  # J/m^2\n    pixel_area = dx * dy  # m^2\n    E_free = float(np.sum(u_surface) * pixel_area)  # Joules\n    return E_free\n\ndef round_sig(x, sig=3):\n    \"\"\"\n    Round to given significant figures, returning a float.\n    \"\"\"\n    if x == 0 or not math.isfinite(x):\n        return float(x)\n    sign = 1.0 if x = 0 else -1.0\n    x_abs = abs(x)\n    p = sig - 1 - int(math.floor(math.log10(x_abs)))\n    return float(round(sign * x_abs, p))\n\ndef solve():\n    # Common parameters\n    dx = 1e6  # m\n    dy = 1e6  # m\n    h = 5e6   # m\n    bmin = 1e-3  # Tesla\n    E_th = 1e24  # Joules\n    psi_th = 0.5 # radians\n\n    # Test case 1: bipolar, sheared\n    Bz1 = np.array([\n        [0.05, 0.05, -0.05, -0.05],\n        [0.05, 0.05, -0.05, -0.05],\n        [0.05, 0.05, -0.05, -0.05],\n        [0.05, 0.05, -0.05, -0.05]\n    ], dtype=float)\n    Bx_obs1 = np.array([\n        [0.05, 0.05, 0.05, 0.05],\n        [0.05, 0.05, 0.05, 0.05],\n        [-0.05, -0.05, -0.05, -0.05],\n        [-0.05, -0.05, -0.05, -0.05]\n    ], dtype=float)\n    By_obs1 = np.array([\n        [0.05, 0.05, -0.05, -0.05],\n        [0.05, 0.05, -0.05, -0.05],\n        [0.05, 0.05, -0.05, -0.05],\n        [0.05, 0.05, -0.05, -0.05]\n    ], dtype=float)\n\n    # Test case 2: uniform, low shear\n    Bz2 = np.full((4,4), 0.02, dtype=float)\n    Bx_obs2 = np.zeros((4,4), dtype=float)\n    By_obs2 = np.zeros((4,4), dtype=float)\n\n    # Test case 3: near-threshold, strong transverse\n    Bz3 = np.array([\n        [0.02, 0.00, -0.02, 0.00],\n        [0.00, 0.02, 0.00, -0.02],\n        [-0.02, 0.00, 0.02, 0.00],\n        [0.00, -0.02, 0.00, 0.02]\n    ], dtype=float)\n    Bx_obs3 = np.full((4,4), 0.18, dtype=float)\n    By_obs3 = np.zeros((4,4), dtype=float)\n\n    test_cases = [\n        (Bz1, Bx_obs1, By_obs1),\n        (Bz2, Bx_obs2, By_obs2),\n        (Bz3, Bx_obs3, By_obs3),\n    ]\n\n    results = []\n    for Bz, Bx_obs, By_obs in test_cases:\n        # Potential field horizontal components\n        Bx_pot, By_pot = fft_potential_horizontal(Bz, dx, dy)\n        # Mean shear angle\n        psi_mean = mean_shear_angle(Bx_obs, By_obs, Bx_pot, By_pot, bmin=bmin)\n        # Total free energy proxy\n        E_free = free_energy_proxy(Bx_obs, By_obs, Bx_pot, By_pot, dx, dy, h, mu0=MU0)\n        # Threshold evaluation\n        near_threshold = (E_free = E_th) and (psi_mean = psi_th)\n        # Rounding\n        psi_mean_rounded = float(round(psi_mean, 6))\n        E_free_rounded = round_sig(E_free, sig=3)\n        results.append([psi_mean_rounded, E_free_rounded, near_threshold])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "一旦CME爆发，其能量会转化为等离子体团的动能和克服太阳引力所需的势能。本练习  让你扮演一名太阳物理学家的角色，对一次观测到的CME进行全面的能量收支分析。通过利用白光日冕仪数据反演出的电子数和测量的速度，你将计算出CME的质量、动能、引力势能增量以及释放的磁能，从而定量地揭示驱动爆发的主要能源。",
            "id": "4211618",
            "problem": "一台白光日冕仪观测到一次日冕物质抛射（CME）。对汤姆孙散射亮度的视线方向反演得出，在CME体积内的总电子数为 $N_e = 5.0\\times 10^{38}$。采用日冕成分，其中氦的相对数量丰度为 $A_{\\mathrm{He}} = 0.10$（氢和氦都完全电离），并使用该成分所对应的每个电子的平均质量。在天空平面中测得的CME整体速度为 $v = 1.0\\times 10^{6}\\ \\mathrm{m\\,s^{-1}}$。爆发从质心高度 $R_0 = 1.2\\,R_\\odot$ 处启动，其中 $R_\\odot = 6.96\\times 10^{8}\\ \\mathrm{m}$。使用牛顿引力以及太阳质量参数 $G M_\\odot = 1.327\\times 10^{20}\\ \\mathrm{m^3\\,s^{-2}}$ 来估计相对于无穷远的引力势能变化。爆发前的磁结构近似为一个体积为 $V = 5.0\\times 10^{25}\\ \\mathrm{m^3}$ 的均匀场磁通量绳，由于磁重联，其平均场强从 $B_0 = 15\\ \\mathrm{G}$ 减小到 $B_1 = 5\\ \\mathrm{G}$，其中 $1\\ \\mathrm{G} = 10^{-4}\\ \\mathrm{T}$，真空磁导率为 $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$。假设在局域重联区域之外为准理想磁流体力学（MHD），并在进行机械能收支比较时忽略非热粒子能量和辐射。\n\n根据第一性原理和经过充分检验的公式，对此事件的CME质量、动能、引力势能变化和磁能释放进行定量和定性区分。哪个选项与物理原理和给定数据最一致？\n\nA. 使用电子数和依赖于成分的每个电子的平均质量，得出 $M \\approx 1.0\\times 10^{12}\\ \\mathrm{kg}$。动能 $E_k$ 约为 $5.0\\times 10^{23}\\ \\mathrm{J}$，在 $R_0 = 1.2\\,R_\\odot$ 处发射的引力势能变化 $\\Delta U_g$ 约为 $1.6\\times 10^{23}\\ \\mathrm{J}$，因磁场在体积 $V$ 内减小而释放的磁能 $\\Delta E_{\\mathrm{mag}}$ 约为 $4.0\\times 10^{25}\\ \\mathrm{J}$，该能量在机械能中占主导地位。质量由汤姆孙散射电子和成分约束，$E_k$ 由 $M$ 和 $v$ 约束，$\\Delta U_g$ 由 $G M_\\odot$、$M$ 和 $R_0$ 约束，$\\Delta E_{\\mathrm{mag}}$ 由在体积 $V$ 上积分的磁能密度减少量约束。\n\nB. 引力势能变化在能量收支中占主导地位：$\\Delta U_g \\sim 4\\times 10^{25}\\ \\mathrm{J}$，超过了 $E_k$ 和 $\\Delta E_{\\mathrm{mag}}$。CME质量可以取为 $M = m_p N_e$ 而不做氦校正，且磁能释放与机械能相比可以忽略不计。\n\nC. 对于给定的参数，动能和磁能释放大致相等，因为 $v$ 接近 $R_0$ 处的太阳逃逸速度，所以 $E_k \\sim 4\\times 10^{25}\\ \\mathrm{J}$。如果 $v  v_{\\mathrm{esc}}$，引力势能变化为零，并且质量与亮度成正比，无需成分校正。\n\nD. 磁能释放应估计为 $\\Delta E_{\\mathrm{mag}} \\simeq (B_0 - B_1)\\,V/\\mu_0$，其值约为 $\\sim 10^{23}\\ \\mathrm{J}$，与 $E_k$ 相当。CME中的能量守恒意味着，当忽略热量和辐射时，有精确的等式 $\\Delta E_{\\mathrm{mag}} = E_k + \\Delta U_g$。",
            "solution": "用户提供了一个天体物理等离子体物理领域的问题，具体涉及日冕物质抛射（CME）的能量学。我的任务是首先验证问题陈述的有效性，如果有效，则推导解决方案并评估给出的选项。\n\n### 问题验证\n\n我将首先提取给定的参数和条件，然后基于科学原理评估问题陈述的有效性。\n\n**步骤1：提取给定条件**\n-   总电子数：$N_e = 5.0\\times 10^{38}$\n-   氦相对数量丰度：$A_{\\mathrm{He}} = \\frac{N_{\\mathrm{He}}}{N_{\\mathrm{H}}} = 0.10$\n-   等离子体成分：氢和氦，均完全电离。\n-   CME整体速度（天空平面）：$v = 1.0\\times 10^{6}\\ \\mathrm{m\\,s^{-1}}$\n-   发射质心高度：$R_0 = 1.2\\,R_\\odot$\n-   太阳半径：$R_\\odot = 6.96\\times 10^{8}\\ \\mathrm{m}$\n-   太阳质量参数：$G M_\\odot = 1.327\\times 10^{20}\\ \\mathrm{m^3\\,s^{-2}}$\n-   爆发前体积：$V = 5.0\\times 10^{25}\\ \\mathrm{m^3}$\n-   初始平均磁场：$B_0 = 15\\ \\mathrm{G}$\n-   最终平均磁场：$B_1 = 5\\ \\mathrm{G}$\n-   高斯到特斯拉转换：$1\\ \\mathrm{G} = 10^{-4}\\ \\mathrm{T}$\n-   真空磁导率：$\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$\n-   假设：牛顿引力，准理想磁流体力学，在机械能收支比较中忽略非热粒子和辐射。\n\n**步骤2：使用提取的给定条件进行验证**\n-   **科学依据**：该问题是太阳物理和磁层物理学的核心问题。它采用了标准的、公认的原理：用汤姆孙散射估算质量，用牛顿力学计算动能和势能，用电磁学计算磁能。提供的CME参数数值（$N_e$, $v$, $B_0$等）在物理上是现实的，并且在大型爆发事件的观测范围内。\n-   **适定性**：问题陈述清晰，提供了计算所需量（质量、动能、势能变化、磁能释放）的所有必要数据和常数。问题没有歧义。\n-   **客观性**：问题是定量的，用精确的科学语言表达，没有主观性或偏见。\n-   **其他缺陷**：问题没有违反任何其他导致无效的标准。它不是不完整的、矛盾的、不切实际的、病态的或微不足道的。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。我现在将继续进行解答推导。\n\n### 解答推导\n\n我将计算四个我们感兴趣的量：CME质量（$M$）、动能（$E_k$）、引力势能变化（$\\Delta U_g$）和磁能释放（$\\Delta E_{\\mathrm{mag}}$）。\n\n**1. CME质量（$M$）**\nCME的总质量是其组成粒子质量的总和：质子（$N_\\mathrm{H}$）、氦核（$N_\\mathrm{He}$）和电子（$N_e$）。等离子体是完全电离的。\n总电子数由 $N_e = 1 \\cdot N_{\\mathrm{H}} + 2 \\cdot N_{\\mathrm{He}}$ 给出。\n氦丰度为 $A_{\\mathrm{He}} = N_{\\mathrm{He}}/N_{\\mathrm{H}} = 0.10$，所以 $N_{\\mathrm{He}} = 0.10 N_{\\mathrm{H}}$。\n将此代入$N_e$的方程：\n$N_e = N_{\\mathrm{H}} + 2(0.10 N_{\\mathrm{H}}) = 1.20 N_{\\mathrm{H}}$。\n由此，我们找到氢核和氦核的数量：\n$N_{\\mathrm{H}} = \\frac{N_e}{1.20} = \\frac{5.0\\times 10^{38}}{1.20} \\approx 4.167\\times 10^{38}$。\n$N_{\\mathrm{He}} = 0.10 N_{\\mathrm{H}} = \\frac{0.10 N_e}{1.20} \\approx 4.167\\times 10^{37}$。\n\n总质量 $M$ 为 $M = N_{\\mathrm{H}}m_p + N_{\\mathrm{He}}m_\\alpha + N_e m_e$，其中 $m_p \\approx 1.6726\\times 10^{-27}\\ \\mathrm{kg}$ 是质子质量，$m_\\alpha \\approx 6.6447\\times 10^{-27}\\ \\mathrm{kg}$ 是alpha粒子（氦核）质量，$m_e \\approx 9.109\\times 10^{-31}\\ \\mathrm{kg}$ 是电子质量。按照标准做法，电子质量的贡献可以忽略不计，以简化计算。\n$M \\approx N_{\\mathrm{H}} m_p + N_{\\mathrm{He}} m_\\alpha = (\\frac{N_e}{1.20})m_p + (\\frac{0.10 N_e}{1.20})m_\\alpha$\n$M = \\frac{N_e}{1.20}(m_p + 0.10 m_\\alpha)$\n$M = \\frac{5.0\\times 10^{38}}{1.20} (1.6726\\times 10^{-27}\\ \\mathrm{kg} + 0.10 \\times 6.6447\\times 10^{-27}\\ \\mathrm{kg})$\n$M = (4.167\\times 10^{38}) \\times (1.6726\\times 10^{-27} + 0.66447\\times 10^{-27})\\ \\mathrm{kg}$\n$M = (4.167\\times 10^{38}) \\times (2.3371\\times 10^{-27})\\ \\mathrm{kg}$\n$M \\approx 9.74\\times 10^{11}\\ \\mathrm{kg}$。\n这个值非常接近 $1.0\\times 10^{12}\\ \\mathrm{kg}$。\n\n**2. 动能（$E_k$）**\n动能由公式 $E_k = \\frac{1}{2}Mv^2$ 给出。\n使用计算出的质量 $M \\approx 9.74\\times 10^{11}\\ \\mathrm{kg}$ 和给定的速度 $v = 1.0\\times 10^{6}\\ \\mathrm{m\\,s^{-1}}$：\n$E_k = \\frac{1}{2} (9.74\\times 10^{11}\\ \\mathrm{kg}) (1.0\\times 10^{6}\\ \\mathrm{m\\,s^{-1}})^2$\n$E_k = 0.5 \\times (9.74\\times 10^{11}) \\times (1.0\\times 10^{12})\\ \\mathrm{J}$\n$E_k = 4.87\\times 10^{23}\\ \\mathrm{J}$。\n这个值非常接近 $5.0\\times 10^{23}\\ \\mathrm{J}$。\n\n**3. 引力势能变化（$\\Delta U_g$）**\n问题要求计算相对于无穷远的引力势能变化。这是将质量 $M$ 从其发射高度 $R_0$ 移动到 $r=\\infty$ 所需的能量。\n初始势能： $U_{g,i} = -\\frac{G M_\\odot M}{R_0}$。\n最终势能： $U_{g,f}(r\\to\\infty) = 0$。\n变化量为 $\\Delta U_g = U_{g,f} - U_{g,i} = \\frac{G M_\\odot M}{R_0}$。\n给定 $G M_\\odot = 1.327\\times 10^{20}\\ \\mathrm{m^3\\,s^{-2}}$。\n发射高度为 $R_0 = 1.2\\,R_\\odot = 1.2 \\times (6.96\\times 10^{8}\\ \\mathrm{m}) = 8.352\\times 10^{8}\\ \\mathrm{m}$。\n$\\Delta U_g = \\frac{(1.327\\times 10^{20}\\ \\mathrm{m^3\\,s^{-2}}) (9.74\\times 10^{11}\\ \\mathrm{kg})}{8.352\\times 10^{8}\\ \\mathrm{m}}$\n$\\Delta U_g = \\frac{1.292\\times 10^{32}}{8.352\\times 10^{8}}\\ \\mathrm{J}$\n$\\Delta U_g \\approx 1.547\\times 10^{23}\\ \\mathrm{J}$。\n这个值非常接近 $1.6\\times 10^{23}\\ \\mathrm{J}$。\n\n**4. 磁能释放（$\\Delta E_{\\mathrm{mag}}$）**\n在体积 $V$ 中，具有均匀磁场 $B$ 的储存磁能为 $E_B = \\frac{B^2}{2\\mu_0} V$。\n释放的磁能是这种储存能量的减少量：\n$\\Delta E_{\\mathrm{mag}} = E_{B,0} - E_{B,1} = \\frac{B_0^2 V}{2\\mu_0} - \\frac{B_1^2 V}{2\\mu_0} = \\frac{(B_0^2 - B_1^2)V}{2\\mu_0}$。\n首先，将磁场转换为国际单位制（特斯拉）：\n$B_0 = 15\\ \\mathrm{G} = 15 \\times 10^{-4}\\ \\mathrm{T} = 1.5\\times 10^{-3}\\ \\mathrm{T}$\n$B_1 = 5\\ \\mathrm{G} = 5 \\times 10^{-4}\\ \\mathrm{T} = 0.5\\times 10^{-3}\\ \\mathrm{T}$\n$B_0^2 = (1.5\\times 10^{-3})^2\\ \\mathrm{T}^2 = 2.25\\times 10^{-6}\\ \\mathrm{T}^2$\n$B_1^2 = (0.5\\times 10^{-3})^2\\ \\mathrm{T}^2 = 0.25\\times 10^{-6}\\ \\mathrm{T}^2$\n$B_0^2 - B_1^2 = (2.25 - 0.25)\\times 10^{-6}\\ \\mathrm{T}^2 = 2.0\\times 10^{-6}\\ \\mathrm{T}^2$。\n现在，计算 $\\Delta E_{\\mathrm{mag}}$：\n$\\Delta E_{\\mathrm{mag}} = \\frac{(2.0\\times 10^{-6}\\ \\mathrm{T}^2)(5.0\\times 10^{25}\\ \\mathrm{m}^3)}{2(4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}})}$\n$\\Delta E_{\\mathrm{mag}} = \\frac{1.0\\times 10^{20}}{8\\pi\\times 10^{-7}}\\ \\mathrm{J} = \\frac{1}{8\\pi}\\times 10^{27}\\ \\mathrm{J}$\n$\\Delta E_{\\mathrm{mag}} \\approx \\frac{1}{25.13}\\times 10^{27}\\ \\mathrm{J} \\approx 0.0398\\times 10^{27}\\ \\mathrm{J}$\n$\\Delta E_{\\mathrm{mag}} \\approx 3.98\\times 10^{25}\\ \\mathrm{J}$。\n这个值非常接近 $4.0\\times 10^{25}\\ \\mathrm{J}$。\n\n**能量比较**\n-   动能：$E_k \\approx 4.9\\times 10^{23}\\ \\mathrm{J}$\n-   引力势能变化：$\\Delta U_g \\approx 1.5\\times 10^{23}\\ \\mathrm{J}$\n-   磁能释放：$\\Delta E_{\\mathrm{mag}} \\approx 4.0\\times 10^{25}\\ \\mathrm{J}$\n释放的磁能比动能和引力势能变化都大约大两个数量级。这是像CME这样的磁驱动爆发的一个标志。\n\n### 逐项分析\n\n**A. 使用电子数和依赖于成分的每个电子的平均质量，得出 $M \\approx 1.0\\times 10^{12}\\ \\mathrm{kg}$。动能 $E_k$ 约为 $5.0\\times 10^{23}\\ \\mathrm{J}$，在 $R_0 = 1.2\\,R_\\odot$ 处发射的引力势能变化 $\\Delta U_g$ 约为 $1.6\\times 10^{23}\\ \\mathrm{J}$，因磁场在体积 $V$ 内减小而释放的磁能 $\\Delta E_{\\mathrm{mag}}$ 约为 $4.0\\times 10^{25}\\ \\mathrm{J}$，该能量在机械能中占主导地位。质量由汤姆孙散射电子和成分约束，$E_k$ 由 $M$ 和 $v$ 约束，$\\Delta U_g$ 由 $G M_\\odot$、$M$ 和 $R_0$ 约束，$\\Delta E_{\\mathrm{mag}}$ 由在体积 $V$ 上积分的磁能密度减少量约束。**\n-   计算出的 $M$、$E_k$、$\\Delta U_g$ 和 $\\Delta E_{\\mathrm{mag}}$ 的值都与此选项中陈述的值非常吻合（在舍入误差范围内）。\n-   定性陈述 $\\Delta E_{\\mathrm{mag}}$ “在机械能中占主导地位”是正确的，因为 $4.0\\times 10^{25}\\ \\mathrm{J}$ 远大于 $E_k + \\Delta U_g \\approx 6.4\\times 10^{23}\\ \\mathrm{J}$ 的总和。\n-   关于每个量如何被约束的描述在物理上是正确的。\n-   结论：**正确**。\n\n**B. 引力势能变化在能量收支中占主导地位：$\\Delta U_g \\sim 4\\times 10^{25}\\ \\mathrm{J}$，超过了 $E_k$ 和 $\\Delta E_{\\mathrm{mag}}$。CME质量可以取为 $M = m_p N_e$ 而不做氦校正，且磁能释放与机械能相比可以忽略不计。**\n-   此选项错误地将 $\\Delta U_g$ 等同于为 $\\Delta E_{\\mathrm{mag}}$ 计算出的值。我的计算表明 $\\Delta U_g \\approx 1.5\\times 10^{23}\\ \\mathrm{J}$。\n-   $\\Delta U_g$ 占主导地位的说法是错误的；$\\Delta E_{\\mathrm{mag}}$ 占主导地位。\n-   磁能可以忽略不计的断言与事实相反。\n-   建议在质量计算中忽略氦会引入一个不可忽略的误差（约15%），并且与问题明确提供氦丰度相矛盾。\n-   结论：**错误**。\n\n**C. 对于给定的参数，动能和磁能释放大致相等，因为 $v$ 接近 $R_0$ 处的太阳逃逸速度，所以 $E_k \\sim 4\\times 10^{25}\\ \\mathrm{J}$。如果 $v  v_{\\mathrm{esc}}$，引力势能变化为零，并且质量与亮度成正比，无需成分校正。**\n-   声称 $E_k \\approx \\Delta E_{\\mathrm{mag}}$ 是错误的。它们相差约80倍。\n-   计算出的 $E_k$ 约为 $5\\times 10^{23}\\ \\mathrm{J}$，而不是 $4\\times 10^{25}\\ \\mathrm{J}$。\n-   提供的推理是有缺陷的。在 $R_0$ 处的逃逸速度为 $v_{\\mathrm{esc}} = \\sqrt{2GM_\\odot/R_0} \\approx 5.6\\times 10^5\\ \\mathrm{m\\,s^{-1}}$。条件 $v \\approx v_{\\mathrm{esc}}$ 将意味着 $E_k \\approx \\Delta U_g$，而不是 $E_k \\approx \\Delta E_{\\mathrm{mag}}$。\n-   声称如果 $v  v_{\\mathrm{esc}}$，$\\Delta U_g$ 就为零，这是对势能的一个基本误解。$\\Delta U_g$ 是从 $R_0$ 逃离引力所需的固定能量成本；它不依赖于物体的速度。\n-   结论：**错误**。\n\n**D. 磁能释放应估计为 $\\Delta E_{\\mathrm{mag}} \\simeq (B_0 - B_1)\\,V/\\mu_0$，其值约为 $\\sim 10^{23}\\ \\mathrm{J}$，与 $E_k$ 相当。CME中的能量守恒意味着，当忽略热量和辐射时，有精确的等式 $\\Delta E_{\\mathrm{mag}} = E_k + \\Delta U_g$。**\n-   公式 $\\Delta E_{\\mathrm{mag}} \\simeq (B_0 - B_1)\\,V/\\mu_0$ 在量纲上和物理上都是不正确的。磁能密度与 $B^2$ 成正比，因此能量释放取决于 $B^2$ 的变化。\n-   声称的结果 $\\sim 10^{23}\\ \\mathrm{J}$ 与所提供的错误公式和正确公式都不一致。它也比正确计算的值小两个数量级。\n-   虽然能量守恒方程在其理想化形式下是正确的，但在这里它被用来支持 $\\Delta E_{\\mathrm{mag}}$ 与 $E_k$ 相当的错误论断。实际上，可用磁能与机械能之间的巨大差异是一个关键的物理特征，这意味着其他能量通道（热、辐射、非热粒子），在比较中被忽略了，是显著的。\n-   结论：**错误**。\n\n基于详细的推导和分析，选项A是唯一在定量上准确且在物理上合理的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "CME离开日冕后，其在行星际空间中的传播对于空间天气预报至关重要，因为它决定了到达地球的时间和速度。本练习  从牛顿第二定律和流体动力学拖曳定律出发，引导你推导描述CME与背景太阳风相互作用的运动方程。通过建立这个简化但物理上合理的模型，你将深入理解影响CME在行星际空间加速或减速的关键物理过程。",
            "id": "4211589",
            "problem": "观测到，一个日冕物质抛射（CME）在超过几个太阳半径的日球层中径向传播时，主要通过气动阻力与周围的太阳风相互作用。假设CME质心以瞬时速度 $v(t)$ 在稳定的、径向向外的太阳风中进行一维径向运动，太阳风的速度为 $w$，质量密度为 $\\rho(r)$，其中 $r$ 是日心距。在这些距离上，与气动阻力相比，忽略太阳引力和洛伦兹力。CME的质量 $m$ 为常数，具有适用于高雷诺数流的有效阻力系数 $C_D$，以及垂直于运动方向的有效横截面积 $A(r)$。CME与周围介质之间的相对流动适用标准的平方阻力定律。\n\n仅从牛顿第二定律和高雷诺数流的平方阻力定律出发，推导出一维运动方程，用 $v(t)$、$w$、$m$、$\\rho(r)$ 和 $A(r)$ 表示 $v(t)$ 的运动，并明确指出在 $vw$ 和 $vw$ 情况下阻力项的符号。然后，使用自相似膨胀模型 $A(r)=\\pi(\\lambda r)^2$ 和太阳风密度模型 $\\rho(r)=\\rho_0(r_0/r)^2$，其中 $\\lambda$、$\\rho_0$ 和 $r_0$ 均为常数，推导拖曳参数 $\\gamma=\\frac{C_D \\rho(r) A(r)}{2m}$ 的表达式。",
            "solution": "根据牛顿第二定律，一个质量为 $m$ 的物体的运动方程是 $m \\frac{dv}{dt} = F_{\\mathrm{net}}$，其中 $v$ 是物体的速度，$F_{\\mathrm{net}}$ 是作用在物体上的净力。在本问题中，我们忽略引力和洛伦兹力，只考虑气动阻力 $F_{\\mathrm{drag}}$。\n\n高雷诺数流的标准平方阻力定律指出，阻力与流体密度 $\\rho$、物体的横截面积 $A$ 以及物体与流体之间的相对速度 $v_{\\mathrm{rel}}$ 的平方成正比。阻力的方向与相对速度的方向相反。相对速度定义为 $v_{\\mathrm{rel}} = v - w$，其中 $v$ 是CME的速度，$w$ 是背景太阳风的速度。\n\n因此，阻力可以表示为：\n$$\nF_{\\mathrm{drag}} = -\\frac{1}{2} C_D \\rho A |v_{\\mathrm{rel}}| v_{\\mathrm{rel}} = -\\frac{1}{2} C_D \\rho A |v - w| (v - w)\n$$\n其中 $C_D$ 是无量纲的阻力系数。这个表达式确保了力的方向总是与相对运动相反。\n\n我们将这个表达式分解为两种情况：\n1.  **$v > w$（CME比太阳风快）**：此时 $v - w > 0$，所以 $|v - w| = v - w$。阻力为负（减速力）：\n    $$\n    F_{\\mathrm{drag}} = -\\frac{1}{2} C_D \\rho(r) A(r) (v - w)^2\n    $$\n2.  **$v  w$（CME比太阳风慢）**：此时 $v - w  0$，所以 $|v - w| = -(v - w) = w - v$。阻力为正（加速力）：\n    $$\n    F_{\\mathrm{drag}} = -\\frac{1}{2} C_D \\rho(r) A(r) (-(v-w))(v - w) = \\frac{1}{2} C_D \\rho(r) A(r) (v - w)^2 = \\frac{1}{2} C_D \\rho(r) A(r) (w - v)^2\n    $$\n\nCME的运动方程为 $m \\frac{dv}{dt} = F_{\\mathrm{drag}}$。\n问题中给出了自相似膨胀模型 $A(r) = \\pi (\\lambda r)^2$ 和太阳风密度模型 $\\rho(r) = \\rho_0 (r_0/r)^2$。我们将这些代入阻力项的系数中。\n$$\n\\rho(r) A(r) = \\left( \\rho_0 \\frac{r_0^2}{r^2} \\right) (\\pi \\lambda^2 r^2) = \\pi \\lambda^2 \\rho_0 r_0^2\n$$\n我们发现，乘积 $\\rho(r)A(r)$ 是一个与距离 $r$ 无关的常数。\n\n因此，我们可以定义一个恒定的拖曳参数 $\\gamma$：\n$$\n\\gamma = \\frac{C_D \\rho(r) A(r)}{2m} = \\frac{C_D \\pi \\lambda^2 \\rho_0 r_0^2}{2m}\n$$\n这个参数 $\\gamma$ 的单位是（长度）$^{-1}$，它概括了CME与太阳风相互作用的强度。\n\n利用这个参数，CME的完整运动方程可以简洁地写成：\n$$\n\\frac{dv}{dt} = \\frac{F_{\\mathrm{drag}}}{m} = -\\frac{C_D \\rho A}{2m} |v-w|(v-w) = -\\gamma |v-w|(v-w)\n$$\n或者，分情况写为：\n$$\n\\frac{dv}{dt} = -\\gamma (v - w)^2 \\quad (\\text{当 } v > w)\n$$\n$$\n\\frac{dv}{dt} = \\gamma (w - v)^2 \\quad (\\text{当 } v  w)\n$$\n在这两种情况下，CME的速度 $v$ 都会渐近地趋向于背景太阳风的速度 $w$。",
            "answer": "$$ \\boxed{\\frac{C_D \\pi \\lambda^2 \\rho_0 r_0^2}{2m}} $$"
        }
    ]
}