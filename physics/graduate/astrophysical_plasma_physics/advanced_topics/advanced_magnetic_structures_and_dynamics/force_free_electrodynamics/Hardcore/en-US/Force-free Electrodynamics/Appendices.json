{
    "hands_on_practices": [
        {
            "introduction": "Force-Free Electrodynamics (FFE) provides a powerful closure for Maxwell's equations in highly magnetized plasmas by specifying the current required to maintain a zero Lorentz force. This first exercise is a foundational derivation, tasking you with expressing the electric current density $\\mathbf{J}$ purely in terms of the electromagnetic fields $\\mathbf{E}$, $\\mathbf{B}$, and their spatial derivatives . Mastering this derivation is key to understanding how the ideal plasma's behavior is encapsulated within the structure of the electromagnetic fields themselves.",
            "id": "4215822",
            "problem": "Consider an astrophysical magnetosphere modeled within Force-Free Electrodynamics (FFE). Work in Heaviside–Lorentz units where $c=1$ and $\\varepsilon_{0}=\\mu_{0}=1$. Let the electromagnetic fields be smooth functions $\\mathbf{E}(\\mathbf{x},t)$ and $\\mathbf{B}(\\mathbf{x},t)$ defined on a simply connected region, such that at an initial time $t_{0}$ they satisfy $\\,\\mathbf{E}\\cdot\\mathbf{B}=0\\,$ and $\\,\\mathbf{B}^{2}\\mathbf{E}^{2}$ everywhere. Assume there are no external material sources beyond those implied self-consistently by the fields. The time evolution is governed by Maxwell’s equations in vacuum,\n$$\n\\partial_{t}\\mathbf{B}=-\\nabla\\times\\mathbf{E},\\qquad\n\\partial_{t}\\mathbf{E}=\\nabla\\times\\mathbf{B}-\\mathbf{J},\\qquad\n\\nabla\\cdot\\mathbf{B}=0,\\qquad\n\\nabla\\cdot\\mathbf{E}=\\rho_{e},\n$$\nand the force-free condition that the electromagnetic Lorentz force density vanishes,\n$$\n\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}\\times\\mathbf{B}=\\mathbf{0},\\qquad \\mathbf{E}\\cdot\\mathbf{B}=0,\n$$\nfor all subsequent times during which the solution remains force-free.\n\nStarting only from these laws and definitions, and requiring that the constraint $\\mathbf{E}\\cdot\\mathbf{B}=0$ is preserved by the time evolution, derive a closed-form expression for the current density $\\mathbf{J}(\\mathbf{x},t)$ in terms of $\\mathbf{E}(\\mathbf{x},t)$, $\\mathbf{B}(\\mathbf{x},t)$, and their spatial derivatives. Your final expression must be written purely as an instantaneous functional $\\mathbf{J}[\\mathbf{E},\\mathbf{B}]$ containing no time derivatives.\n\nProvide your final answer as a single vector expression. No numerical evaluation is required, and no units should be included in the final boxed expression.",
            "solution": "The problem statement is critically validated and found to be valid. It is scientifically grounded in the established theory of Force-Free Electrodynamics (FFE), is mathematically well-posed, and is stated objectively and without ambiguity. All necessary physical laws, definitions, and constraints are provided to permit a rigorous derivation.\n\nThe objective is to derive an expression for the electric current density $\\mathbf{J}$ as an instantaneous functional of the electric field $\\mathbf{E}$, the magnetic field $\\mathbf{B}$, and their spatial derivatives. The derivation will proceed from the fundamental equations of FFE provided.\n\nThe current density vector $\\mathbf{J}$ can be decomposed into components parallel and perpendicular to the local magnetic field $\\mathbf{B}$:\n$$\n\\mathbf{J} = \\mathbf{J}_{\\parallel} + \\mathbf{J}_{\\perp}\n$$\nwhere $\\mathbf{J}_{\\parallel}$ is parallel to $\\mathbf{B}$ and $\\mathbf{J}_{\\perp}$ is perpendicular to $\\mathbf{B}$. We will derive expressions for these two components separately.\n\nFirst, we determine the perpendicular component $\\mathbf{J}_{\\perp}$. The force-free condition is given as:\n$$\n\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}\\times\\mathbf{B}=\\mathbf{0}\n$$\nwhere $\\rho_{e}$ is the electric charge density. Substituting the decomposed current, we get:\n$$\n\\rho_{e}\\,\\mathbf{E}+(\\mathbf{J}_{\\parallel} + \\mathbf{J}_{\\perp})\\times\\mathbf{B}=\\mathbf{0}\n$$\nSince $\\mathbf{J}_{\\parallel}$ is parallel to $\\mathbf{B}$, their cross product is zero: $\\mathbf{J}_{\\parallel} \\times \\mathbf{B} = \\mathbf{0}$. The equation simplifies to:\n$$\n\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}_{\\perp}\\times\\mathbf{B}=\\mathbf{0}\n$$\nTo solve for $\\mathbf{J}_{\\perp}$, we take the cross product of this equation with $\\mathbf{B}$:\n$$\n(\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = \\mathbf{0}\n$$\n$$\n\\rho_{e}(\\mathbf{E}\\times\\mathbf{B}) + (\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = \\mathbf{0}\n$$\nWe use the vector triple product identity $\\mathbf{a}\\times(\\mathbf{b}\\times\\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$. Applying this to the second term:\n$$\n(\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = \\mathbf{B}(\\mathbf{J}_{\\perp}\\cdot\\mathbf{B}) - \\mathbf{J}_{\\perp}(\\mathbf{B}\\cdot\\mathbf{B})\n$$\nBy definition, $\\mathbf{J}_{\\perp}$ is perpendicular to $\\mathbf{B}$, so $\\mathbf{J}_{\\perp}\\cdot\\mathbf{B}=0$. The identity simplifies to:\n$$\n(\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = -\\mathbf{J}_{\\perp}B^{2}\n$$\nwhere $B^{2} = \\mathbf{B}\\cdot\\mathbf{B}$. Substituting this back into the equation for $\\mathbf{J}_{\\perp}$:\n$$\n\\rho_{e}(\\mathbf{E}\\times\\mathbf{B}) - \\mathbf{J}_{\\perp}B^{2} = \\mathbf{0}\n$$\nSolving for $\\mathbf{J}_{\\perp}$, we find:\n$$\n\\mathbf{J}_{\\perp} = \\frac{\\rho_{e}}{B^{2}}(\\mathbf{E}\\times\\mathbf{B})\n$$\nThis component is the charge drift current, perpendicular to both $\\mathbf{E}$ and $\\mathbf{B}$. The problem states that $\\mathbf{B}^{2}\\mathbf{E}^{2}$ and since $\\mathbf{E}\\cdot\\mathbf{B}=0$, this implies $\\mathbf{B}\\neq\\mathbf{0}$, so $B^{2}$ is strictly positive and the expression is well-defined.\n\nNext, we determine the parallel component $\\mathbf{J}_{\\parallel}$. This component is related to the constraint that the orthogonality condition $\\mathbf{E}\\cdot\\mathbf{B}=0$ is preserved in time. This implies that its time derivative must be zero:\n$$\n\\frac{\\partial}{\\partial t}(\\mathbf{E}\\cdot\\mathbf{B}) = 0\n$$\nUsing the product rule for differentiation:\n$$\n\\left(\\frac{\\partial \\mathbf{E}}{\\partial t}\\right)\\cdot\\mathbf{B} + \\mathbf{E}\\cdot\\left(\\frac{\\partial \\mathbf{B}}{\\partial t}\\right) = 0\n$$\nWe now substitute Maxwell's equations, $\\partial_{t}\\mathbf{E}=\\nabla\\times\\mathbf{B}-\\mathbf{J}$ and $\\partial_{t}\\mathbf{B}=-\\nabla\\times\\mathbf{E}$:\n$$\n(\\nabla\\times\\mathbf{B}-\\mathbf{J})\\cdot\\mathbf{B} + \\mathbf{E}\\cdot(-\\nabla\\times\\mathbf{E}) = 0\n$$\nDistributing the dot products:\n$$\n(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{J}\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E}) = 0\n$$\nThis equation allows us to solve for the projection of the total current $\\mathbf{J}$ onto the magnetic field $\\mathbf{B}$:\n$$\n\\mathbf{J}\\cdot\\mathbf{B} = (\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})\n$$\nThe parallel component $\\mathbf{J}_{\\parallel}$ is the projection of $\\mathbf{J}$ onto the direction of $\\mathbf{B}$, which is given by:\n$$\n\\mathbf{J}_{\\parallel} = \\frac{(\\mathbf{J}\\cdot\\mathbf{B})}{B^{2}}\\mathbf{B}\n$$\nSubstituting the expression for $\\mathbf{J}\\cdot\\mathbf{B}$:\n$$\n\\mathbf{J}_{\\parallel} = \\frac{(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})}{B^{2}}\\mathbf{B}\n$$\nNow we assemble the total current $\\mathbf{J} = \\mathbf{J}_{\\parallel} + \\mathbf{J}_{\\perp}$:\n$$\n\\mathbf{J} = \\frac{(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})}{B^{2}}\\mathbf{B} + \\frac{\\rho_{e}}{B^{2}}(\\mathbf{E}\\times\\mathbf{B})\n$$\nThe problem requires the final expression to be in terms of $\\mathbf{E}$, $\\mathbf{B}$, and their spatial derivatives only. The expression above still contains the charge density $\\rho_{e}$. We eliminate it using Gauss's law from the provided set of Maxwell's equations:\n$$\n\\rho_{e} = \\nabla\\cdot\\mathbf{E}\n$$\nSubstituting this into the expression for $\\mathbf{J}$ yields the final result:\n$$\n\\mathbf{J} = \\frac{(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})}{B^{2}}\\mathbf{B} + \\frac{(\\nabla\\cdot\\mathbf{E})}{B^{2}}(\\mathbf{E}\\times\\mathbf{B})\n$$\nThis expression gives the current density $\\mathbf{J}$ as an instantaneous functional of the electromagnetic fields and their spatial derivatives, with no explicit time derivatives, as required.",
            "answer": "$$\n\\boxed{\\frac{(\\nabla \\times \\mathbf{B}) \\cdot \\mathbf{B} - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})}{B^2} \\mathbf{B} + \\frac{(\\nabla \\cdot \\mathbf{E})}{B^2}(\\mathbf{E} \\times \\mathbf{B})}\n$$"
        },
        {
            "introduction": "With the governing equations of FFE established, we can explore the system's dynamic properties by studying how it responds to small perturbations. This practice involves linearizing the FFE equations around a simple background state to derive the dispersion relations for wave propagation, distinguishing between modes traveling parallel and perpendicular to the magnetic field . This analysis reveals the characteristic speeds of the system and highlights the profound differences between wave propagation in a force-free medium versus a vacuum, introducing the distinct behaviors of fast and Alfvén modes.",
            "id": "4215774",
            "problem": "Consider the equations of electromagnetism in Heaviside–Lorentz units with the speed of light set to unity, $c=1$. A magnetically dominated, collisionless plasma in the force-free regime satisfies the force-free conditions $E^{2}  B^{2}$ and $\\mathbf{E} \\cdot \\mathbf{B} = 0$, and its dynamical closure can be written in terms of the electromagnetic fields as a current density\n$$\n\\mathbf{J} \\equiv \\frac{(\\nabla \\cdot \\mathbf{E})\\,\\mathbf{E} \\times \\mathbf{B}}{B^{2}} + \\frac{\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}) - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})}{B^{2}}\\,\\mathbf{B}.\n$$\nElectrodynamics is governed by Maxwell’s equations\n$$\n\\partial_{t} \\mathbf{B} = - \\nabla \\times \\mathbf{E}, \\quad \\partial_{t} \\mathbf{E} = \\nabla \\times \\mathbf{B} - \\mathbf{J}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\nabla \\cdot \\mathbf{E} = \\rho_{e},\n$$\nwith the force-free condition maintaining $\\mathbf{E} \\cdot \\mathbf{B} = 0$ at all times.\n\nLinearize this system about a uniform background with $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$ and $\\mathbf{E}_{0} = \\mathbf{0}$, and consider small-amplitude plane-wave perturbations $\\delta \\mathbf{E}$ and $\\delta \\mathbf{B}$ of the form $\\propto \\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{x} - i\\,\\omega t\\right)$. Work to first order in the perturbations and use only the fundamental relations above. Derive the dispersion relations for modes whose wavevector is (i) parallel to the background magnetic field, $\\mathbf{k} \\parallel \\mathbf{B}_{0}$, and (ii) perpendicular to the background magnetic field, $\\mathbf{k} \\perp \\mathbf{B}_{0}$. From these, identify the characteristic cones (phase speeds) for the propagating families of perturbations in the force-free system and compare them with those of vacuum electrodynamics.\n\nExpress the final answer as the four characteristic phase speeds in a single row matrix,\n$$\nv_{\\parallel,\\mathrm{fast}},\\; v_{\\parallel,\\mathrm{Alfv\\acute{e}n}},\\; v_{\\perp,\\mathrm{fast}},\\; v_{\\perp,\\mathrm{Alfv\\acute{e}n}},\n$$\nin units where $c=1$. No rounding is required.",
            "solution": "The problem asks for the dispersion relations and characteristic phase speeds of small-amplitude plane waves in a force-free plasma, for wavevectors parallel and perpendicular to a uniform background magnetic field. The system is described by Maxwell's equations and a specific closure for the current density $\\mathbf{J}$.\n\nFirst, we linearize the system around the static, uniform background state $\\mathbf{E}_{0} = \\mathbf{0}$ and $\\mathbf{B}_{0} = B_{0}\\hat{\\mathbf{z}}$. We consider first-order perturbations of the form $\\delta\\mathbf{E}$ and $\\delta\\mathbf{B}$ such that the total fields are $\\mathbf{E} = \\mathbf{E}_{0} + \\delta\\mathbf{E} = \\delta\\mathbf{E}$ and $\\mathbf{B} = \\mathbf{B}_{0} + \\delta\\mathbf{B}$. For plane-wave perturbations proportional to $\\exp(i\\,\\mathbf{k}\\cdot\\mathbf{x} - i\\,\\omega t)$, the differential operators become algebraic: $\\partial_{t} \\rightarrow -i\\omega$ and $\\nabla \\rightarrow i\\mathbf{k}$.\n\nMaxwell's equations, to first order in the perturbations, are:\nFaraday's Law: $-i\\omega\\delta\\mathbf{B} = -i\\mathbf{k} \\times \\delta\\mathbf{E} \\implies \\omega\\delta\\mathbf{B} = \\mathbf{k} \\times \\delta\\mathbf{E}$.\nGauss's Law for Magnetism: $i\\mathbf{k} \\cdot \\delta\\mathbf{B} = 0$, which is automatically satisfied by Faraday's Law since $\\mathbf{k} \\cdot (\\mathbf{k} \\times \\delta\\mathbf{E}) = 0$.\nAmpere-Maxwell Law: $-i\\omega\\delta\\mathbf{E} = i\\mathbf{k} \\times \\delta\\mathbf{B} - \\delta\\mathbf{J}$.\n\nNext, we linearize the current density $\\mathbf{J}$. The expression provided is:\n$$\n\\mathbf{J} = \\frac{(\\nabla \\cdot \\mathbf{E})\\,\\mathbf{E} \\times \\mathbf{B}}{B^{2}} + \\frac{\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}) - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})}{B^{2}}\\,\\mathbf{B}\n$$\nThe zeroth-order current is $\\mathbf{J}_0 = \\mathbf{0}$ because $\\mathbf{E}_0 = \\mathbf{0}$ and the background magnetic field $\\mathbf{B}_0$ is uniform, so $\\nabla \\times \\mathbf{B}_0 = \\mathbf{0}$. We need to find the first-order perturbation $\\delta\\mathbf{J}$.\nLet's analyze the two terms in $\\mathbf{J}$ separately.\nThe first term, $\\mathbf{J}_1 = \\frac{(\\nabla \\cdot \\mathbf{E})\\,\\mathbf{E} \\times \\mathbf{B}}{B^{2}}$, contains products of fields. Since $\\mathbf{E}_0 = \\mathbf{0}$, both $\\nabla \\cdot \\mathbf{E}_0 = 0$ and $\\mathbf{E}_0 \\times \\mathbf{B}_0 = \\mathbf{0}$. The first-order perturbation of a product of quantities that are zero at zeroth order is zero. Thus, $\\delta\\mathbf{J}_1 = \\mathbf{0}$.\nThe second term is $\\mathbf{J}_2 = \\frac{N_2}{B^2} \\mathbf{B}$, where $N_2 = \\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}) - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})$. The zeroth-order part is $N_{2,0} = \\mathbf{B}_0 \\cdot (\\nabla \\times \\mathbf{B}_0) - \\mathbf{E}_0 \\cdot (\\nabla \\times \\mathbf{E}_0) = 0$. The first-order perturbation is $\\delta\\mathbf{J}_2 = \\frac{\\delta N_2}{B_0^2} \\mathbf{B}_0 + \\frac{N_{2,0}}{B_0^2} \\delta\\mathbf{B} = \\frac{\\delta N_2}{B_0^2} \\mathbf{B}_0$.\nWe compute $\\delta N_2$:\n$\\delta N_2 = \\delta(\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B})) - \\delta(\\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E}))$.\n$\\delta(\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B})) = \\delta\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}_0) + \\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B}) = \\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B})$ since $\\nabla \\times \\mathbf{B}_0 = \\mathbf{0}$.\n$\\delta(\\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})) = \\delta\\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E}_0) + \\mathbf{E}_0 \\cdot (\\nabla \\times \\delta\\mathbf{E}) = 0$ since $\\mathbf{E}_0 = \\mathbf{0}$.\nThus, $\\delta N_2 = \\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B})$.\nThe linearized current is $\\delta\\mathbf{J} = \\frac{\\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B})}{B_0^2} \\mathbf{B}_0$.\nSubstituting the plane-wave form, $\\nabla \\to i\\mathbf{k}$, we get:\n$$\n\\delta\\mathbf{J} = \\frac{\\mathbf{B}_0 \\cdot (i\\mathbf{k} \\times \\delta\\mathbf{B})}{B_0^2} \\mathbf{B}_0\n$$\nThe problem states that the force-free condition $\\mathbf{E} \\cdot \\mathbf{B} = 0$ is maintained. Linearizing this gives $\\delta\\mathbf{E} \\cdot \\mathbf{B}_0 + \\mathbf{E}_0 \\cdot \\delta\\mathbf{B} = 0$. Since $\\mathbf{E}_0 = \\mathbf{0}$, we have the crucial constraint $\\delta\\mathbf{E} \\cdot \\mathbf{B}_0 = 0$. For $\\mathbf{B}_0 = B_0\\hat{\\mathbf{z}}$, this implies $\\delta E_z = 0$, meaning the electric field perturbation is purely transverse to the background magnetic field.\n\nNow, we combine the linearized equations. From Faraday's law, $\\delta\\mathbf{B} = (\\mathbf{k} \\times \\delta\\mathbf{E})/\\omega$. Substituting this into Ampere's law:\n$$\n-i\\omega \\delta\\mathbf{E} = i\\mathbf{k} \\times \\left(\\frac{\\mathbf{k} \\times \\delta\\mathbf{E}}{\\omega}\\right) - \\delta\\mathbf{J}\n$$\n$$\n-\\omega^2 \\delta\\mathbf{E} = \\mathbf{k} \\times (\\mathbf{k} \\times \\delta\\mathbf{E}) + i\\omega\\delta\\mathbf{J} = \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) - k^2\\delta\\mathbf{E} + i\\omega\\delta\\mathbf{J}\n$$\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) - i\\omega\\delta\\mathbf{J} = 0\n$$\nNext, we express $\\delta\\mathbf{J}$ in terms of $\\delta\\mathbf{E}$:\n$$\ni\\omega\\delta\\mathbf{J} = i\\omega \\frac{\\mathbf{B}_0 \\cdot (i\\mathbf{k} \\times \\frac{\\mathbf{k}\\times\\delta\\mathbf{E}}{\\omega})}{B_0^2} \\mathbf{B}_0 = -\\frac{1}{B_0^2} \\left[ \\mathbf{B}_0 \\cdot \\left(\\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) - k^2\\delta\\mathbf{E}\\right) \\right] \\mathbf{B}_0\n$$\nUsing $\\delta\\mathbf{E} \\cdot \\mathbf{B}_0 = 0$, this simplifies to:\n$$\ni\\omega\\delta\\mathbf{J} = -\\frac{(\\mathbf{B}_0 \\cdot \\mathbf{k})(\\mathbf{k}\\cdot\\delta\\mathbf{E})}{B_0^2} \\mathbf{B}_0\n$$\nThe general wave equation is therefore:\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) + \\frac{(\\mathbf{B}_0 \\cdot \\mathbf{k})(\\mathbf{k}\\cdot\\delta\\mathbf{E})}{B_0^2} \\mathbf{B}_0 = 0\n$$\nWe now analyze the two specific cases.\n\nCase (i): Parallel propagation, $\\mathbf{k} \\parallel \\mathbf{B}_{0}$.\nLet $\\mathbf{k} = k\\hat{\\mathbf{z}}$. Then $\\mathbf{B}_0 = B_0\\hat{\\mathbf{z}}$.\nThe condition $\\delta E_z = 0$ implies $\\mathbf{k} \\cdot \\delta\\mathbf{E} = 0$. The wave is purely transverse.\nThe general wave equation simplifies significantly:\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(0) + \\frac{(kB_0)(0)}{B_0^2}\\mathbf{B}_0 = 0 \\implies (\\omega^2 - k^2)\\delta\\mathbf{E} = 0\n$$\nFor a non-trivial solution ($\\delta\\mathbf{E} \\neq \\mathbf{0}$), we must have $\\omega^2 - k^2 = 0$, which gives the dispersion relation $\\omega^2 = k^2$.\nThe phase speed is $v_p = |\\omega/k| = 1$ (in units of $c$). This relation holds for two independent transverse polarizations of $\\delta\\mathbf{E}$ (e.g., in the $\\hat{\\mathbf{x}}$ and $\\hat{\\mathbf{y}}$ directions). In force-free electrodynamics, both the Alfvén wave and the fast wave propagating along the magnetic field travel at the speed of light. They become degenerate.\nThus, $v_{\\parallel,\\mathrm{fast}} = 1$ and $v_{\\parallel,\\mathrm{Alfv\\acute{e}n}} = 1$.\n\nCase (ii): Perpendicular propagation, $\\mathbf{k} \\perp \\mathbf{B}_{0}$.\nLet $\\mathbf{k} = k\\hat{\\mathbf{x}}$. Then $\\mathbf{B}_0 = B_0\\hat{\\mathbf{z}}$.\nIn this case, $\\mathbf{B}_0 \\cdot \\mathbf{k} = 0$. The third term in the general wave equation vanishes.\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) = 0\n$$\nWe have $\\delta\\mathbf{E} = \\delta E_x \\hat{\\mathbf{x}} + \\delta E_y \\hat{\\mathbf{y}}$ (since $\\delta E_z=0$). Also, $\\mathbf{k} = k\\hat{\\mathbf{x}}$.\nThe term $\\mathbf{k}\\cdot\\delta\\mathbf{E} = k\\delta E_x$. Substituting these into the equation:\n$$\n(\\omega^2 - k^2)(\\delta E_x \\hat{\\mathbf{x}} + \\delta E_y \\hat{\\mathbf{y}}) + (k\\hat{\\mathbf{x}})(k\\delta E_x) = 0\n$$\nWe separate this into components:\nx-component: $(\\omega^2 - k^2)\\delta E_x + k^2\\delta E_x = 0 \\implies \\omega^2\\delta E_x = 0$.\ny-component: $(\\omega^2 - k^2)\\delta E_y = 0$.\nThis system yields two distinct modes:\n\nMode 1 (Alfvén mode): For a non-trivial solution with $\\delta E_x \\neq 0$, we must have $\\omega^2 = 0$. This implies $\\delta E_y=0$. The dispersion relation is $\\omega=0$, corresponding to a phase speed $v_{p} = 0$. This is a non-propagating, static structure, representing the perpendicular limit of the shear Alfvén wave. The electric field is longitudinal ($\\delta\\mathbf{E} \\parallel \\mathbf{k}$). Thus, $v_{\\perp,\\mathrm{Alfv\\acute{e}n}}=0$.\n\nMode 2 (Fast mode): For a non-trivial solution with $\\delta E_y \\neq 0$, we must have $\\omega^2 - k^2 = 0$. This implies $\\delta E_x=0$. The dispersion relation is $\\omega^2 = k^2$, giving a phase speed $v_{p}=1$. In this mode, the electric field is transverse to both the wavevector and the background magnetic field ($\\delta\\mathbf{E} \\perp \\mathbf{k}$ and $\\delta\\mathbf{E} \\perp \\mathbf{B}_0$). This is the fast magnetosonic wave in the force-free limit. Thus, $v_{\\perp,\\mathrm{fast}}=1$.\n\nIn summary, the four characteristic phase speeds are:\n$v_{\\parallel,\\mathrm{fast}} = 1$\n$v_{\\parallel,\\mathrm{Alfv\\acute{e}n}} = 1$\n$v_{\\perp,\\mathrm{fast}} = 1$\n$v_{\\perp,\\mathrm{Alfv\\acute{e}n}} = 0$\n\nComparison with Vacuum Electrodynamics:\nIn vacuum, all electromagnetic waves propagate at the speed of light, $v_p=1$, regardless of their direction. The force-free fast modes derived here also propagate at $v_p=1$, behaving like vacuum waves. The significant difference lies in the Alfvén mode, which is a feature of the plasma medium. It propagates at $v_p=1$ along the magnetic field but becomes a stationary structure ($v_p=0$) for propagation perpendicular to the field, introducing anisotropy not present in a vacuum.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Bridging the gap between theory and application, this final practice delves into the world of numerical simulations, where theoretical constraints must be actively enforced. You will design and analyze a numerical \"limiter,\" an essential algorithm in FFE codes that ensures the magnetic dominance condition ($B^2 \\gt E^2$) is always met . This exercise provides hands-on experience with the practical challenges of computational astrophysics and requires a careful analysis of how such numerical tools impact fundamental physical quantities like energy and characteristic propagation speeds.",
            "id": "4215824",
            "problem": "You are asked to design, analyze, and implement a numerical limiter for Force-Free Electrodynamics (FFE) that enforces the magnetically dominated constraint. The limiter must act on the electric field by rescaling its magnitude whenever the electric field approaches the magnetic field in strength, while leaving the magnetic field unchanged. You will derive the limiter from first principles and quantify its impact on conserved quantities and characteristic speeds.\n\nFundamental base and definitions:\n- The force-free constraints require $E \\cdot B = 0$ and $B^2 - E^2  0$, where $E$ and $B$ are the electric and magnetic field vectors, and $E^2 = E \\cdot E$, $B^2 = B \\cdot B$.\n- In units where the speed of light is $c=1$ and using Gaussian-Heaviside units, the electromagnetic energy density is $u = \\frac{1}{2}\\left(E^2 + B^2\\right)$ and the Poynting vector is $S = E \\times B$.\n- The drift speed associated with the advective transport of the electromagnetic fields in FFE is defined by $v_d = \\frac{\\lVert E \\times B \\rVert}{B^2}$.\n- The energy flow speed of the electromagnetic field is defined by $v_S = \\frac{\\lVert S \\rVert}{u} = \\frac{\\lVert E \\times B \\rVert}{\\frac{1}{2}\\left(E^2 + B^2\\right)}$.\n\nLimiter design task:\n- Derive, from the requirement $B^2 - E'^2 \\ge \\epsilon B^2$ with a fixed safety margin $0  \\epsilon \\ll 1$, a rescaling policy $E' = s E$ with a scalar $s \\le 1$ that minimally modifies $E$ to satisfy the constraint whenever it is violated or imminently violated, and leaves $E$ unchanged otherwise. The limiter must preserve the direction of $E$ and leave $B$ unchanged.\n- Show that if $E \\cdot B = 0$ before limiting, then $E' \\cdot B = 0$ after limiting.\n\nImpact analysis:\n- Derive the ratio of electromagnetic energy densities $r_u = \\frac{u'}{u}$ after applying the limiter, where $u' = \\frac{1}{2}\\left(E'^2 + B^2\\right)$.\n- Derive the effect of the limiter on the drift speed $v_d$ and the energy flow speed $v_S$, expressing $v_d'$ and $v_S'$ in terms of $s$, $E$, and $B$.\n- Based on your derivations, explain whether the limiter is energy-conserving and how it alters characteristic speeds that depend on $E$ and $B$. Your analysis should be consistent with the above definitions and must not assume any specialized FFE characteristic formulas beyond these base definitions.\n\nAlgorithmic requirements:\n- Implement the limiter and the derived diagnostics in a complete, runnable program that takes no input and uses the fixed test suite below.\n- For each test case, compute and return the following in order:\n  1. A boolean indicating whether rescaling was applied.\n  2. The energy ratio $r_u = \\frac{u'}{u}$ (dimensionless).\n  3. The drift speed before limiting $v_d$ (dimensionless).\n  4. The drift speed after limiting $v_d'$ (dimensionless).\n  5. The energy flow speed before limiting $v_S$ (dimensionless).\n  6. The energy flow speed after limiting $v_S'$ (dimensionless).\n\nAll quantities are dimensionless in units with $c=1$. Angles do not appear. Your program must compute exactly these six quantities per test case.\n\nTest suite:\nUse the following five test cases, each specified by $(E_x,E_y,E_z)$, $(B_x,B_y,B_z)$, and the safety margin $\\epsilon$:\n- Case 1 (magnetically dominated, no limiting expected): $E=(0,\\,\\frac{1}{\\sqrt{2}},\\,0)$, $B=(0,\\,0,\\,1)$, $\\epsilon=10^{-3}$.\n- Case 2 (near-threshold but below, no limiting expected): $E=\\left(0,\\,\\sqrt{0.9985},\\,0\\right)$, $B=(0,\\,0,\\,1)$, $\\epsilon=10^{-3}$.\n- Case 3 (slight violation, limiting expected): $E=\\left(0,\\,\\sqrt{1.001},\\,0\\right)$, $B=(0,\\,0,\\,1)$, $\\epsilon=10^{-3}$.\n- Case 4 (zero electric field): $E=(0,\\,0,\\,0)$, $B=(0,\\,0,\\,1)$, $\\epsilon=10^{-3}$.\n- Case 5 (strong magnetic field, magnetically dominated): $E=(0,\\,1.5,\\,0)$, $B=(0,\\,0,\\,2.0)$, $\\epsilon=10^{-3}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is itself a comma-separated list enclosed in square brackets, in the same order as the test suite. For example, the outer structure must look like $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$ with no spaces.",
            "solution": "The problem presented is a valid and well-posed exercise in computational relativistic electrodynamics. It is scientifically grounded in the principles of force-free electrodynamics (FFE), a widely used approximation in modern astrophysics for modeling the magnetospheres of compact objects like pulsars and black holes. The problem is objective, self-contained, and all terms are clearly defined. I will proceed with a full derivation and analysis.\n\n### 1. Derivation of the Numerical Limiter\n\nThe purpose of the limiter is to enforce the magnetic dominance condition, $B^2 - E^2  0$, which is fundamental to FFE. Numerically, it is prudent to enforce a slightly stricter version, $B^2 - E^2 \\ge \\epsilon B^2$, for a small, dimensionless safety margin $0  \\epsilon \\ll 1$. This prevents the state from reaching the singular limit $E^2 = B^2$ where the Lorentz invariant $B^2-E^2$ vanishes.\n\nThe limiter is designed to act on the electric field $E$ via a rescaling $E' = s E$ with a scalar factor $s \\le 1$, leaving the magnetic field $B$ unchanged. The goal is to find the value of $s$ that minimally modifies $E$ (i.e., keeps $s$ as close to $1$ as possible) while satisfying the constraint.\n\nThe modified electric field squared is $E'^2 = (sE) \\cdot (sE) = s^2 E^2$. Substituting this into the desired constraint gives:\n$$\nB^2 - s^2 E^2 \\ge \\epsilon B^2\n$$\nRearranging this inequality to solve for $s^2$, assuming $E^2  0$:\n$$\ns^2 E^2 \\le B^2 - \\epsilon B^2\n$$\n$$\ns^2 \\le (1-\\epsilon)\\frac{B^2}{E^2}\n$$\nThe limiter should only be active if the initial state violates or is on the verge of violating the constraint. The condition for limiter activation is therefore $B^2 - E^2  \\epsilon B^2$, which is equivalent to $E^2  (1-\\epsilon)B^2$.\n\nLet's define the maximum allowed squared electric field magnitude as $E^2_{max} = (1-\\epsilon)B^2$.\n- If the initial state satisfies $E^2 \\le E^2_{max}$, no modification is needed. To leave $E$ unchanged, we must set $s=1$.\n- If the initial state violates this, $E^2  E^2_{max}$, we must rescale $E$. To minimally alter $E$, we choose the largest possible $s$ that satisfies the constraint. This corresponds to making the inequality an equality: $s^2 = \\frac{E^2_{max}}{E^2}$.\n\nCombining these two cases, the scaling factor $s$ is given by:\n$$\ns = \\begin{cases}\n    \\sqrt{\\frac{(1-\\epsilon)B^2}{E^2}}  \\text{if } E^2  (1-\\epsilon)B^2 \\\\\n    1  \\text{if } E^2 \\le (1-\\epsilon)B^2\n\\end{cases}\n$$\nThis can be expressed compactly as $s = \\min\\left(1, \\sqrt{\\frac{(1-\\epsilon)B^2}{E^2}}\\right)$, with care taken for the case $E^2=0$. If $E=0$, then $E^2=0 \\le (1-\\epsilon)B^2$ (assuming $B^2 \\ge 0, \\epsilon  1$), so $s=1$ and $E'=E=0$, which is correct.\n\n### 2. Preservation of Field Orthogonality\n\nAnother fundamental FFE constraint is $E \\cdot B = 0$. The limiter must preserve this condition. Given an initial state where $E \\cdot B = 0$, the dot product for the modified field $E'$ is:\n$$\nE' \\cdot B = (sE) \\cdot B = s (E \\cdot B)\n$$\nSince $E \\cdot B = 0$, it follows that $E' \\cdot B = s(0) = 0$. The limiter correctly preserves the orthogonality of the electric and magnetic fields.\n\n### 3. Impact Analysis of the Limiter\n\nWe now analyze the effect of the limiter on key physical quantities. When limiting is applied, $s  1$; otherwise, $s=1$ and all quantities are unchanged.\n\n**3.1. Electromagnetic Energy Density**\n\nThe initial and final energy densities are:\n$$\nu = \\frac{1}{2}(E^2 + B^2)\n$$\n$$\nu' = \\frac{1}{2}(E'^2 + B^2) = \\frac{1}{2}(s^2 E^2 + B^2)\n$$\nThe ratio of the energy densities, $r_u = u'/u$, is:\n$$\nr_u = \\frac{\\frac{1}{2}(s^2 E^2 + B^2)}{\\frac{1}{2}(E^2 + B^2)} = \\frac{s^2 E^2 + B^2}{E^2 + B^2}\n$$\nSince $s \\le 1$, it follows that $s^2 \\le 1$. Thus, $s^2 E^2 + B^2 \\le E^2 + B^2$, which implies $r_u \\le 1$. The equality $r_u=1$ holds only if $s=1$ (no limiting) or if $E=0$. When the limiter is active ($s1$ and $E \\ne 0$), $r_u  1$. This shows that the **limiter is not energy-conserving; it is dissipative with respect to the electromagnetic field energy**.\n\n**3.2. Drift Speed**\n\nThe drift speed $v_d$ represents the velocity of the magnetic field lines. The initial and final drift speeds are:\n$$\nv_d = \\frac{\\lVert E \\times B \\rVert}{B^2}\n$$\n$$\nv_d' = \\frac{\\lVert E' \\times B \\rVert}{B^2}\n$$\nThe new Poynting vector is $S' = E' \\times B = (sE) \\times B = s(E \\times B)$. Its magnitude is $\\lVert S' \\rVert = |s| \\lVert E \\times B \\rVert$. Since $s \\ge 0$, this is $s \\lVert E \\times B \\rVert$.\nSubstituting this into the expression for $v_d'$:\n$$\nv_d' = \\frac{s \\lVert E \\times B \\rVert}{B^2} = s v_d\n$$\nThe drift speed is scaled directly by the factor $s$. Since $s \\le 1$, the limiter always reduces or maintains the drift speed, $v_d' \\le v_d$. This action is crucial for numerical stability, as it prevents the field line velocity from exceeding the speed of light.\n\n**3.3. Energy Flow Speed**\n\nThe energy flow speed $v_S$ is the speed at which electromagnetic energy propagates. The initial and final speeds are:\n$$\nv_S = \\frac{\\lVert S \\rVert}{u} = \\frac{\\lVert E \\times B \\rVert}{\\frac{1}{2}(E^2 + B^2)}\n$$\n$$\nv_S' = \\frac{\\lVert S' \\rVert}{u'} = \\frac{s \\lVert E \\times B \\rVert}{\\frac{1}{2}(s^2 E^2 + B^2)}\n$$\nWe can express $v_S'$ in terms of $v_S$. From the definition of $v_S$, we have $\\lVert E \\times B \\rVert = v_S \\cdot u = v_S \\cdot \\frac{1}{2}(E^2 + B^2)$. Substituting this into the expression for $v_S'$:\n$$\nv_S' = \\frac{s \\left(v_S \\cdot \\frac{1}{2}(E^2 + B^2)\\right)}{\\frac{1}{2}(s^2 E^2 + B^2)} = v_S \\left( \\frac{s(E^2 + B^2)}{s^2 E^2 + B^2} \\right)\n$$\nThe scaling factor for $v_S$ is $\\frac{s(E^2 + B^2)}{s^2 E^2 + B^2}$. As shown in the thought process, this factor is monotonically increasing with $s$ and is equal to $1$ for $s=1$. Since $s \\le 1$, the factor is also $\\le 1$. Therefore, $v_S' \\le v_S$. The limiter reduces or maintains the energy flow speed.\n\n### 4. Summary of Analysis\n\nThe derived limiter $E' = sE$ is a minimal modification that enforces the magnetic dominance condition $B^2-E'^2 \\ge \\epsilon B^2$. It is non-energy-conserving, dissipating electromagnetic energy whenever it is activated ($r_u  1$). This dissipated energy, in a complete physical system, would be transferred to the plasma, causing heating. Both the drift speed ($v_d$) and the energy flow speed ($v_S$) are reduced (or maintained). This reduction of characteristic speeds is a stabilizing effect, preventing them from becoming superluminal and thereby ensuring the causality of the numerical solution. It is an essential component for robust numerical simulations of force-free electrodynamics.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the force-free electrodynamics limiter problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        {'E': np.array([0., 1. / np.sqrt(2), 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., np.sqrt(0.9985), 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., np.sqrt(1.001), 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., 0., 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., 1.5, 0.]), 'B': np.array([0., 0., 2.0]), 'epsilon': 1e-3},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E = case['E']\n        B = case['B']\n        epsilon = case['epsilon']\n\n        E2 = np.dot(E, E)\n        B2 = np.dot(B, B)\n\n        # Condition for applying the limiter\n        # The threshold for E^2 is (1-epsilon)*B^2\n        E2_max = (1.0 - epsilon) * B2\n        \n        rescaling_applied = E2 > E2_max\n\n        # Calculate the scaling factor s\n        if rescaling_applied:\n            # E2 must be > 0 if rescaling is applied, so no division by zero here.\n            s = np.sqrt(E2_max / E2)\n        else:\n            s = 1.0\n\n        # Calculate initial (pre-limiter) quantities\n        u = 0.5 * (E2 + B2)\n        E_cross_B = np.cross(E, B)\n        norm_S = np.linalg.norm(E_cross_B)\n\n        vd = norm_S / B2 if B2 > 0 else 0.0\n        vS = norm_S / u if u > 0 else 0.0\n\n        # Calculate final (post-limiter) quantities\n        s2 = s * s\n        E2_p = s2 * E2\n        u_p = 0.5 * (E2_p + B2)\n        norm_S_p = s * norm_S\n\n        r_u = u_p / u if u > 0 else 1.0\n        \n        vd_p = s * vd\n        vS_p = norm_S_p / u_p if u_p > 0 else 0.0\n\n        # Assemble the results for this case\n        case_result = [\n            rescaling_applied,\n            r_u,\n            vd,\n            vd_p,\n            vS,\n            vS_p\n        ]\n        all_results.append(case_result)\n\n    # Format the final output string as per requirements\n    case_results_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(case_results_str)}]\")\n\nsolve()\n\n```"
        }
    ]
}