{
    "hands_on_practices": [
        {
            "introduction": "无力场电动力学理论的基石在于电流密度并非外部给定，而是由电磁场自身通过麦克斯韦方程组和无力场条件自洽地决定。本练习将指导你从这些第一性原理出发，推导出这一关键的闭合关系，即电流密度 $J$ 如何表示为电磁场 $E$ 和 $B$ 及其空间导数的函数。掌握这一推导 () 对于理解无力场磁层的结构至关重要。",
            "id": "4215822",
            "problem": "考虑一个在无力电动力学（FFE）框架下建模的天体物理磁层。使用亥维赛-洛伦兹单位制，其中 $c=1$ 且 $\\varepsilon_{0}=\\mu_{0}=1$。设电磁场为定义在单连通区域上的光滑函数 $\\mathbf{E}(\\mathbf{x},t)$ 和 $\\mathbf{B}(\\mathbf{x},t)$，使得在初始时刻 $t_{0}$，处处满足 $\\,\\mathbf{E}\\cdot\\mathbf{B}=0\\,$ 和 $\\,\\mathbf{B}^{2}>\\mathbf{E}^{2}$。假设除了由场自洽地蕴含的源之外，不存在外部物质源。其时间演化由真空中的麦克斯韦方程组决定，\n$$\n\\partial_{t}\\mathbf{B}=-\\nabla\\times\\mathbf{E},\\qquad\n\\partial_{t}\\mathbf{E}=\\nabla\\times\\mathbf{B}-\\mathbf{J},\\qquad\n\\nabla\\cdot\\mathbf{B}=0,\\qquad\n\\nabla\\cdot\\mathbf{E}=\\rho_{e},\n$$\n以及电磁洛伦兹力密度为零的无力条件，\n$$\n\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}\\times\\mathbf{B}=\\mathbf{0},\\qquad \\mathbf{E}\\cdot\\mathbf{B}=0,\n$$\n在解保持无力性质的所有后续时刻均成立。\n\n仅从这些定律和定义出发，并要求约束条件 $\\mathbf{E}\\cdot\\mathbf{B}=0$ 在时间演化中保持不变，推导电流密度 $\\mathbf{J}(\\mathbf{x},t)$ 关于 $\\mathbf{E}(\\mathbf{x},t)$、$\\mathbf{B}(\\mathbf{x},t)$ 及其空间导数的闭合形式表达式。你的最终表达式必须纯粹写成一个不含时间导数的瞬时泛函 $\\mathbf{J}[\\mathbf{E},\\mathbf{B}]$。\n\n请以单个矢量表达式的形式给出最终答案。不需要进行数值计算，最终方框内的表达式不应包含单位。",
            "solution": "该问题陈述经过严格验证，确认有效。它在已建立的无力电动力学（FFE）理论中具有坚实的科学基础，在数学上是适定的，并且陈述客观、无歧义。所有必需的物理定律、定义和约束条件均已提供，足以进行严格的推导。\n\n目标是推导电流密度 $\\mathbf{J}$ 作为电场 $\\mathbf{E}$、磁场 $\\mathbf{B}$ 及其空间导数的瞬时泛函表达式。推导将从所给出的 FFE 基本方程出发。\n\n电流密度矢量 $\\mathbf{J}$ 可以分解为平行于和垂直于局部磁场 $\\mathbf{B}$ 的分量：\n$$\n\\mathbf{J} = \\mathbf{J}_{\\parallel} + \\mathbf{J}_{\\perp}\n$$\n其中 $\\mathbf{J}_{\\parallel}$ 平行于 $\\mathbf{B}$，而 $\\mathbf{J}_{\\perp}$ 垂直于 $\\mathbf{B}$。我们将分别推导这两个分量的表达式。\n\n首先，我们确定垂直分量 $\\mathbf{J}_{\\perp}$。无力条件给出为：\n$$\n\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}\\times\\mathbf{B}=\\mathbf{0}\n$$\n其中 $\\rho_{e}$ 是电荷密度。代入分解后的电流，我们得到：\n$$\n\\rho_{e}\\,\\mathbf{E}+(\\mathbf{J}_{\\parallel} + \\mathbf{J}_{\\perp})\\times\\mathbf{B}=\\mathbf{0}\n$$\n由于 $\\mathbf{J}_{\\parallel}$ 平行于 $\\mathbf{B}$，它们的叉积为零：$\\mathbf{J}_{\\parallel} \\times \\mathbf{B} = \\mathbf{0}$。方程简化为：\n$$\n\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}_{\\perp}\\times\\mathbf{B}=\\mathbf{0}\n$$\n为了求解 $\\mathbf{J}_{\\perp}$，我们将此方程与 $\\mathbf{B}$ 作叉积：\n$$\n(\\rho_{e}\\,\\mathbf{E}+\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = \\mathbf{0}\n$$\n$$\n\\rho_{e}(\\mathbf{E}\\times\\mathbf{B}) + (\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = \\mathbf{0}\n$$\n我们使用矢量三重积恒等式 $\\mathbf{a}\\times(\\mathbf{b}\\times\\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$。将其应用于第二项：\n$$\n(\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = \\mathbf{B}(\\mathbf{J}_{\\perp}\\cdot\\mathbf{B}) - \\mathbf{J}_{\\perp}(\\mathbf{B}\\cdot\\mathbf{B})\n$$\n根据定义，$\\mathbf{J}_{\\perp}$ 垂直于 $\\mathbf{B}$，所以 $\\mathbf{J}_{\\perp}\\cdot\\mathbf{B}=0$。该恒等式简化为：\n$$\n(\\mathbf{J}_{\\perp}\\times\\mathbf{B})\\times\\mathbf{B} = -\\mathbf{J}_{\\perp}B^{2}\n$$\n其中 $B^{2} = \\mathbf{B}\\cdot\\mathbf{B}$。将此代回关于 $\\mathbf{J}_{\\perp}$ 的方程中：\n$$\n\\rho_{e}(\\mathbf{E}\\times\\mathbf{B}) - \\mathbf{J}_{\\perp}B^{2} = \\mathbf{0}\n$$\n解出 $\\mathbf{J}_{\\perp}$，我们得到：\n$$\n\\mathbf{J}_{\\perp} = \\frac{\\rho_{e}}{B^{2}}(\\mathbf{E}\\times\\mathbf{B})\n$$\n该分量是电荷漂移电流，同时垂直于 $\\mathbf{E}$ 和 $\\mathbf{B}$。问题陈述 $\\mathbf{B}^{2}>\\mathbf{E}^{2}$ 并且由于 $\\mathbf{E}\\cdot\\mathbf{B}=0$，这意味着 $\\mathbf{B}\\neq\\mathbf{0}$，因此 $B^{2}$ 严格为正，该表达式是良定义的。\n\n接下来，我们确定平行分量 $\\mathbf{J}_{\\parallel}$。该分量与正交条件 $\\mathbf{E}\\cdot\\mathbf{B}=0$ 随时间保持不变的约束相关。这意味着其时间导数必须为零：\n$$\n\\frac{\\partial}{\\partial t}(\\mathbf{E}\\cdot\\mathbf{B}) = 0\n$$\n使用微分的乘积法则：\n$$\n\\left(\\frac{\\partial \\mathbf{E}}{\\partial t}\\right)\\cdot\\mathbf{B} + \\mathbf{E}\\cdot\\left(\\frac{\\partial \\mathbf{B}}{\\partial t}\\right) = 0\n$$\n现在我们代入麦克斯韦方程组，$\\partial_{t}\\mathbf{E}=\\nabla\\times\\mathbf{B}-\\mathbf{J}$ 和 $\\partial_{t}\\mathbf{B}=-\\nabla\\times\\mathbf{E}$：\n$$\n(\\nabla\\times\\mathbf{B}-\\mathbf{J})\\cdot\\mathbf{B} + \\mathbf{E}\\cdot(-\\nabla\\times\\mathbf{E}) = 0\n$$\n展开点积：\n$$\n(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{J}\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E}) = 0\n$$\n该方程允许我们求解总电流 $\\mathbf{J}$ 在磁场 $\\mathbf{B}$ 上的投影：\n$$\n\\mathbf{J}\\cdot\\mathbf{B} = (\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})\n$$\n平行分量 $\\mathbf{J}_{\\parallel}$ 是 $\\mathbf{J}$ 在 $\\mathbf{B}$ 方向上的投影，由下式给出：\n$$\n\\mathbf{J}_{\\parallel} = \\frac{(\\mathbf{J}\\cdot\\mathbf{B})}{B^{2}}\\mathbf{B}\n$$\n代入 $\\mathbf{J}\\cdot\\mathbf{B}$ 的表达式：\n$$\n\\mathbf{J}_{\\parallel} = \\frac{(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})}{B^{2}}\\mathbf{B}\n$$\n现在我们组合总电流 $\\mathbf{J} = \\mathbf{J}_{\\parallel} + \\mathbf{J}_{\\perp}$：\n$$\n\\mathbf{J} = \\frac{(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})}{B^{2}}\\mathbf{B} + \\frac{\\rho_{e}}{B^{2}}(\\mathbf{E}\\times\\mathbf{B})\n$$\n问题要求最终表达式仅用 $\\mathbf{E}$、$\\mathbf{B}$ 及其空间导数表示。上述表达式仍包含电荷密度 $\\rho_{e}$。我们使用所给麦克斯韦方程组中的高斯定律来消去它：\n$$\n\\rho_{e} = \\nabla\\cdot\\mathbf{E}\n$$\n将此代入 $\\mathbf{J}$ 的表达式，得到最终结果：\n$$\n\\mathbf{J} = \\frac{(\\nabla\\times\\mathbf{B})\\cdot\\mathbf{B} - \\mathbf{E}\\cdot(\\nabla\\times\\mathbf{E})}{B^{2}}\\mathbf{B} + \\frac{(\\nabla\\cdot\\mathbf{E})}{B^{2}}(\\mathbf{E}\\times\\mathbf{B})\n$$\n此表达式给出了电流密度 $\\mathbf{J}$ 作为电磁场及其空间导数的瞬时泛函，不含显式的时间导数，符合要求。",
            "answer": "$$\n\\boxed{\\frac{(\\nabla \\times \\mathbf{B}) \\cdot \\mathbf{B} - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})}{B^2} \\mathbf{B} + \\frac{(\\nabla \\cdot \\mathbf{E})}{B^2}(\\mathbf{E} \\times \\mathbf{B})}\n$$"
        },
        {
            "introduction": "在建立了无力场电动力学的自洽方程组后，下一步是探究其动力学特性。本练习通过对无力场方程进行线性化，来推导等离子体中波动传播的色散关系，并与真空中的电磁波进行对比。这项分析 () 将揭示无力场环境如何改变波的传播特性，这对于理解天体物理磁层中的因果关系和信号传播速度至关重要。",
            "id": "4215774",
            "problem": "考虑在亥维赛-洛伦兹（Heaviside–Lorentz）单位制中的电磁学方程，其中光速设为1，即 $c=1$。一个处于无力状态下的磁主导、无碰撞等离子体满足无力条件 $B^2 > E^2$ 和 $\\mathbf{E} \\cdot \\mathbf{B} = 0$，其动力学闭合可以用电磁场表示为电流密度\n$$\n\\mathbf{J} \\equiv \\frac{(\\nabla \\cdot \\mathbf{E})\\,\\mathbf{E} \\times \\mathbf{B}}{B^{2}} + \\frac{\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}) - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})}{B^{2}}\\,\\mathbf{B}.\n$$\n电动力学由麦克斯韦方程组所描述\n$$\n\\partial_{t} \\mathbf{B} = - \\nabla \\times \\mathbf{E}, \\quad \\partial_{t} \\mathbf{E} = \\nabla \\times \\mathbf{B} - \\mathbf{J}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\nabla \\cdot \\mathbf{E} = \\rho_{e},\n$$\n其中无力条件使得 $\\mathbf{E} \\cdot \\mathbf{B} = 0$ 始终成立。\n\n将此系统在均匀背景 $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$ 和 $\\mathbf{E}_{0} = \\mathbf{0}$ 周围进行线性化，并考虑形式为 $\\propto \\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{x} - i\\,\\omega t\\right)$ 的小振幅平面波微扰 $\\delta \\mathbf{E}$ 和 $\\delta \\mathbf{B}$。计算到微扰的一阶，并仅使用上述基本关系。推导当波矢 (i) 平行于背景磁场（$\\mathbf{k} \\parallel \\mathbf{B}_{0}$）和 (ii) 垂直于背景磁场（$\\mathbf{k} \\perp \\mathbf{B}_{0}$）时，各模式的色散关系。从这些关系中，确定无力系统中传播的微扰族的特征锥（相速度），并将它们与真空电动力学中的情况进行比较。\n\n将最终答案表示为一个单行矩阵，其中包含四个特征相速度，\n$$\nv_{\\parallel,\\text{fast}},\\; v_{\\parallel,\\text{Alfvén}},\\; v_{\\perp,\\text{fast}},\\; v_{\\perp,\\text{Alfvén}},\n$$\n单位为 $c=1$。无需四舍五入。",
            "solution": "该问题要求解在无力等离子体中，当波矢平行和垂直于均匀背景磁场时，小振幅平面波的色散关系和特征相速度。该系统由麦克斯韦方程组和电流密度 $\\mathbf{J}$ 的特定闭合关系所描述。\n\n首先，我们在静态均匀背景态 $\\mathbf{E}_{0} = \\mathbf{0}$ 和 $\\mathbf{B}_{0} = B_{0}\\hat{\\mathbf{z}}$ 周围对系统进行线性化。我们考虑一阶微扰 $\\delta\\mathbf{E}$ 和 $\\delta\\mathbf{B}$，使得总场为 $\\mathbf{E} = \\mathbf{E}_{0} + \\delta\\mathbf{E} = \\delta\\mathbf{E}$ 和 $\\mathbf{B} = \\mathbf{B}_{0} + \\delta\\mathbf{B}$。对于正比于 $\\exp(i\\,\\mathbf{k}\\cdot\\mathbf{x} - i\\,\\omega t)$ 的平面波微扰，微分算符变为代数形式：$\\partial_{t} \\rightarrow -i\\omega$ 和 $\\nabla \\rightarrow i\\mathbf{k}$。\n\n麦克斯韦方程组在一阶微扰下为：\n法拉第定律：$-i\\omega\\delta\\mathbf{B} = -i\\mathbf{k} \\times \\delta\\mathbf{E} \\implies \\omega\\delta\\mathbf{B} = \\mathbf{k} \\times \\delta\\mathbf{E}$。\n磁高斯定律：$i\\mathbf{k} \\cdot \\delta\\mathbf{B} = 0$，由于 $\\mathbf{k} \\cdot (\\mathbf{k} \\times \\delta\\mathbf{E}) = 0$，法拉第定律自动满足此式。\n安培-麦克斯韦定律：$-i\\omega\\delta\\mathbf{E} = i\\mathbf{k} \\times \\delta\\mathbf{B} - \\delta\\mathbf{J}$。\n\n接下来，我们对电流密度 $\\mathbf{J}$ 进行线性化。给出的表达式是：\n$$\n\\mathbf{J} = \\frac{(\\nabla \\cdot \\mathbf{E})\\,\\mathbf{E} \\times \\mathbf{B}}{B^{2}} + \\frac{\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}) - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})}{B^{2}}\\,\\mathbf{B}\n$$\n零阶电流为 $\\mathbf{J}_0 = \\mathbf{0}$，因为 $\\mathbf{E}_0 = \\mathbf{0}$ 且背景磁场 $\\mathbf{B}_0$ 是均匀的，所以 $\\nabla \\times \\mathbf{B}_0 = \\mathbf{0}$。我们需要求一阶微扰 $\\delta\\mathbf{J}$。\n我们分别分析 $\\mathbf{J}$ 中的两项。\n第一项 $\\mathbf{J}_1 = \\frac{(\\nabla \\cdot \\mathbf{E})\\,\\mathbf{E} \\times \\mathbf{B}}{B^{2}}$ 包含场的乘积。由于 $\\mathbf{E}_0 = \\mathbf{0}$，所以 $\\nabla \\cdot \\mathbf{E}_0 = 0$ 和 $\\mathbf{E}_0 \\times \\mathbf{B}_0 = \\mathbf{0}$ 都成立。零阶时为零的量的乘积，其一阶微扰为零。因此，$\\delta\\mathbf{J}_1 = \\mathbf{0}$。\n第二项是 $\\mathbf{J}_2 = \\frac{N_2}{B^2} \\mathbf{B}$，其中 $N_2 = \\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}) - \\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})$。其零阶部分为 $N_{2,0} = \\mathbf{B}_0 \\cdot (\\nabla \\times \\mathbf{B}_0) - \\mathbf{E}_0 \\cdot (\\nabla \\times \\mathbf{E}_0) = 0$。一阶微扰为 $\\delta\\mathbf{J}_2 = \\frac{\\delta N_2}{B_0^2} \\mathbf{B}_0 + \\frac{N_{2,0}}{B_0^2} \\delta\\mathbf{B} = \\frac{\\delta N_2}{B_0^2} \\mathbf{B}_0$。\n我们计算 $\\delta N_2$：\n$\\delta N_2 = \\delta(\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B})) - \\delta(\\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E}))$。\n$\\delta(\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B})) = \\delta\\mathbf{B} \\cdot (\\nabla \\times \\mathbf{B}_0) + \\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B}) = \\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B})$ 因为 $\\nabla \\times \\mathbf{B}_0 = \\mathbf{0}$。\n$\\delta(\\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E})) = \\delta\\mathbf{E} \\cdot (\\nabla \\times \\mathbf{E}_0) + \\mathbf{E}_0 \\cdot (\\nabla \\times \\delta\\mathbf{E}) = 0$ 因为 $\\mathbf{E}_0 = \\mathbf{0}$。\n因此，$\\delta N_2 = \\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B})$。\n线性化的电流为 $\\delta\\mathbf{J} = \\frac{\\mathbf{B}_0 \\cdot (\\nabla \\times \\delta\\mathbf{B})}{B_0^2} \\mathbf{B}_0$。\n代入平面波形式 $\\nabla \\to i\\mathbf{k}$，我们得到：\n$$\n\\delta\\mathbf{J} = \\frac{\\mathbf{B}_0 \\cdot (i\\mathbf{k} \\times \\delta\\mathbf{B})}{B_0^2} \\mathbf{B}_0\n$$\n题目指出，无力条件 $\\mathbf{E} \\cdot \\mathbf{B} = 0$ 始终维持。对其进行线性化得到 $\\delta\\mathbf{E} \\cdot \\mathbf{B}_0 + \\mathbf{E}_0 \\cdot \\delta\\mathbf{B} = 0$。由于 $\\mathbf{E}_0 = \\mathbf{0}$，我们得到关键约束 $\\delta\\mathbf{E} \\cdot \\mathbf{B}_0 = 0$。对于 $\\mathbf{B}_0 = B_0\\hat{\\mathbf{z}}$，这意味着 $\\delta E_z = 0$，即电场微扰完全垂直于背景磁场。\n\n现在，我们组合这些线性化方程。由法拉第定律，$\\delta\\mathbf{B} = (\\mathbf{k} \\times \\delta\\mathbf{E})/\\omega$。将此代入安培定律：\n$$\n-i\\omega \\delta\\mathbf{E} = i\\mathbf{k} \\times \\left(\\frac{\\mathbf{k} \\times \\delta\\mathbf{E}}{\\omega}\\right) - \\delta\\mathbf{J}\n$$\n$$\n-\\omega^2 \\delta\\mathbf{E} = \\mathbf{k} \\times (\\mathbf{k} \\times \\delta\\mathbf{E}) + i\\omega\\delta\\mathbf{J} = \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) - k^2\\delta\\mathbf{E} + i\\omega\\delta\\mathbf{J}\n$$\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) - i\\omega\\delta\\mathbf{J} = 0\n$$\n接下来，我们用 $\\delta\\mathbf{E}$ 表示 $\\delta\\mathbf{J}$：\n$$\ni\\omega\\delta\\mathbf{J} = i\\omega \\frac{\\mathbf{B}_0 \\cdot (i\\mathbf{k} \\times \\frac{\\mathbf{k}\\times\\delta\\mathbf{E}}{\\omega})}{B_0^2} \\mathbf{B}_0 = -\\frac{1}{B_0^2} \\left[ \\mathbf{B}_0 \\cdot \\left(\\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) - k^2\\delta\\mathbf{E}\\right) \\right] \\mathbf{B}_0\n$$\n使用 $\\delta\\mathbf{E} \\cdot \\mathbf{B}_0 = 0$，上式简化为：\n$$\ni\\omega\\delta\\mathbf{J} = -\\frac{(\\mathbf{B}_0 \\cdot \\mathbf{k})(\\mathbf{k}\\cdot\\delta\\mathbf{E})}{B_0^2} \\mathbf{B}_0\n$$\n因此，通用的波动方程是：\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) + \\frac{(\\mathbf{B}_0 \\cdot \\mathbf{k})(\\mathbf{k}\\cdot\\delta\\mathbf{E})}{B_0^2} \\mathbf{B}_0 = 0\n$$\n我们现在分析两种具体情况。\n\n情况 (i)：平行传播，$\\mathbf{k} \\parallel \\mathbf{B}_{0}$。\n令 $\\mathbf{k} = k\\hat{\\mathbf{z}}$。则 $\\mathbf{B}_0 = B_0\\hat{\\mathbf{z}}$。\n条件 $\\delta E_z = 0$ 意味着 $\\mathbf{k} \\cdot \\delta\\mathbf{E} = 0$。该波是纯横波。\n通用波动方程显著简化为：\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(0) + \\frac{(kB_0)(0)}{B_0^2}\\mathbf{B}_0 = 0 \\implies (\\omega^2 - k^2)\\delta\\mathbf{E} = 0\n$$\n对于非平凡解（$\\delta\\mathbf{E} \\neq \\mathbf{0}$），必须有 $\\omega^2 - k^2 = 0$，这给出色散关系 $\\omega^2 = k^2$。\n相速度为 $v_p = |\\omega/k| = 1$（以 $c$ 为单位）。该关系对 $\\delta\\mathbf{E}$ 的两个独立横向极化（例如，在 $\\hat{\\mathbf{x}}$ 和 $\\hat{\\mathbf{y}}$ 方向）均成立。在无力电动力学中，沿磁场传播的阿尔芬（Alfvén）波和快波都以光速传播。它们是简并的。\n因此，$v_{\\parallel,\\text{fast}} = 1$ 和 $v_{\\parallel,\\text{Alfvén}} = 1$。\n\n情况 (ii)：垂直传播，$\\mathbf{k} \\perp \\mathbf{B}_{0}$。\n令 $\\mathbf{k} = k\\hat{\\mathbf{x}}$。则 $\\mathbf{B}_0 = B_0\\hat{\\mathbf{z}}$。\n在这种情况下，$\\mathbf{B}_0 \\cdot \\mathbf{k} = 0$。通用波动方程中的第三项消失。\n$$\n(\\omega^2 - k^2)\\delta\\mathbf{E} + \\mathbf{k}(\\mathbf{k}\\cdot\\delta\\mathbf{E}) = 0\n$$\n我们有 $\\delta\\mathbf{E} = \\delta E_x \\hat{\\mathbf{x}} + \\delta E_y \\hat{\\mathbf{y}}$（因为 $\\delta E_z=0$）。并且，$\\mathbf{k} = k\\hat{\\mathbf{x}}$。\n项 $\\mathbf{k}\\cdot\\delta\\mathbf{E} = k\\delta E_x$。将这些代入方程：\n$$\n(\\omega^2 - k^2)(\\delta E_x \\hat{\\mathbf{x}} + \\delta E_y \\hat{\\mathbf{y}}) + (k\\hat{\\mathbf{x}})(k\\delta E_x) = 0\n$$\n我们将其分解为分量：\nx分量：$(\\omega^2 - k^2)\\delta E_x + k^2\\delta E_x = 0 \\implies \\omega^2\\delta E_x = 0$。\ny分量：$(\\omega^2 - k^2)\\delta E_y = 0$。\n该系统产生两种不同的模式：\n\n模式 1（阿尔芬模式）：对于 $\\delta E_x \\neq 0$ 的非平凡解，必须有 $\\omega^2 = 0$。这意味着 $\\delta E_y=0$。色散关系为 $\\omega=0$，对应的相速度为 $v_{p} = 0$。这是一个不传播的静态结构，代表了剪切阿尔芬波的垂直极限。电场是纵向的（$\\delta\\mathbf{E} \\parallel \\mathbf{k}$）。因此，$v_{\\perp,\\text{Alfvén}}=0$。\n\n模式 2（快模式）：对于 $\\delta E_y \\neq 0$ 的非平凡解，必须有 $\\omega^2 - k^2 = 0$。这意味着 $\\delta E_x=0$。色散关系为 $\\omega^2 = k^2$，相速度为 $v_{p}=1$。在这种模式下，电场同时垂直于波矢和背景磁场（$\\delta\\mathbf{E} \\perp \\mathbf{k}$ 和 $\\delta\\mathbf{E} \\perp \\mathbf{B}_0$）。这是无力极限下的快磁声波。因此，$v_{\\perp,\\text{fast}}=1$。\n\n总而言之，四个特征相速度是：\n$v_{\\parallel,\\text{fast}} = 1$\n$v_{\\parallel,\\text{Alfvén}} = 1$\n$v_{\\perp,\\text{fast}} = 1$\n$v_{\\perp,\\text{Alfvén}} = 0$\n\n与真空电动力学的比较：\n在真空中，所有电磁波都以光速 $v_p=1$ 传播，无论其方向如何。这里推导出的无力快模式也以 $v_p=1$ 传播，其行为类似于真空波。显著的区别在于阿尔芬模式，这是等离子体介质的一个特征。它沿磁场以 $v_p=1$ 传播，但对于垂直于场的传播，则变为一个静态结构（$v_p=0$），从而引入了真空中不存在的各向异性。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本练习将理论推向计算天体物理的实践前沿。在数值求解无力场电动力学方程时，一个核心挑战是确保物理约束条件 $B^2 - E^2 \\gt 0$ 始终成立，否则模拟将变得不稳定。此练习要求你设计并分析一个“限制器” ()，它是一种在数值相对论和无力场模拟中用于强制执行物理约束的常用技术，从而保证数值解的稳定性和物理实在性。",
            "id": "4215824",
            "problem": "您需要为无力电动力学（Force-Free Electrodynamics, FFE）设计、分析并实现一个数值限制器，以强制执行磁场主导约束。该限制器必须在电场强度接近磁场强度时，通过重新缩放电场的大小来作用于电场，同时保持磁场不变。您将从第一性原理出发推导该限制器，并量化其对守恒量和特征速度的影响。\n\n基本基础和定义：\n- 无力场约束要求 $E \\cdot B = 0$ 和 $B^2 - E^2 > 0$，其中 $E$ 和 $B$ 是电场和磁场矢量，且 $E^2 = E \\cdot E$，$B^2 = B \\cdot B$。\n- 在使用光速 $c=1$ 的单位制和 Gaussian-Heaviside 单位制下，电磁能量密度为 $u = \\frac{1}{2}\\left(E^2 + B^2\\right)$，坡印亭矢量为 $S = E \\times B$。\n- 在 FFE 中，与电磁场平流输运相关的漂移速度定义为 $v_d = \\frac{\\lVert E \\times B \\rVert}{B^2}$。\n- 电磁场的能流速度定义为 $v_S = \\frac{\\lVert S \\rVert}{u} = \\frac{\\lVert E \\times B \\rVert}{\\frac{1}{2}\\left(E^2 + B^2\\right)}$。\n\n限制器设计任务：\n- 根据要求 $B^2 - E'^2 \\ge \\epsilon B^2$（其中有一个固定的安全裕度 $0  \\epsilon \\ll 1$），推导出一个重新缩放策略 $E' = s E$（其中标量 $s \\le 1$），该策略在约束被违反或即将被违反时，以最小的程度修改 $E$ 以满足约束，否则保持 $E$ 不变。该限制器必须保持 $E$ 的方向，并保持 $B$ 不变。\n- 证明如果限制前 $E \\cdot B = 0$，那么限制后 $E' \\cdot B = 0$。\n\n影响分析：\n- 推导施加限制器后电磁能量密度的比率 $r_u = \\frac{u'}{u}$，其中 $u' = \\frac{1}{2}\\left(E'^2 + B^2\\right)$。\n- 推导限制器对漂移速度 $v_d$ 和能流速度 $v_S$ 的影响，用 $s$、$E$ 和 $B$ 表示 $v_d'$ 和 $v_S'$。\n- 根据您的推导，解释该限制器是否能量守恒，以及它如何改变依赖于 $E$ 和 $B$ 的特征速度。您的分析必须与上述定义一致，并且除了这些基本定义之外，不得假设任何专门的 FFE 特征公式。\n\n算法要求：\n- 在一个完整的、可运行的程序中实现该限制器和推导出的诊断方法。该程序不接受任何输入，并使用下述固定的测试套件。\n- 对于每个测试用例，按顺序计算并返回以下内容：\n  1. 一个布尔值，表示是否应用了重新缩放。\n  2. 能量比率 $r_u = \\frac{u'}{u}$（无量纲）。\n  3. 限制前的漂移速度 $v_d$（无量纲）。\n  4. 限制后的漂移速度 $v_d'$（无量纲）。\n  5. 限制前的能流速度 $v_S$（无量纲）。\n  6. 限制后的能流速度 $v_S'$（无量纲）。\n\n所有量在 $c=1$ 的单位制下都是无量纲的。角度不出现。您的程序必须为每个测试用例精确计算这六个量。\n\n测试套件：\n使用以下五个测试用例，每个用例由 $(E_x,E_y,E_z)$、$(B_x,B_y,B_z)$ 和安全裕度 $\\epsilon$ 指定：\n- 用例1（磁场主导，预计不进行限制）：$E=(0,\\,\\frac{1}{\\sqrt{2}},\\,0)$，$B=(0,\\,0,\\,1)$，$\\epsilon=10^{-3}$。\n- 用例2（接近阈值但低于阈值，预计不进行限制）：$E=\\left(0,\\,\\sqrt{0.9985},\\,0\\right)$，$B=(0,\\,0,\\,1)$，$\\epsilon=10^{-3}$。\n- 用例3（轻微违反，预计进行限制）：$E=\\left(0,\\,\\sqrt{1.001},\\,0\\right)$，$B=(0,\\,0,\\,1)$，$\\epsilon=10^{-3}$。\n- 用例4（零电场）：$E=(0,\\,0,\\,0)$，$B=(0,\\,0,\\,1)$，$\\epsilon=10^{-3}$。\n- 用例5（强磁场，磁场主导）：$E=(0,\\,1.5,\\,0)$，$B=(0,\\,0,\\,2.0)$，$\\epsilon=10^{-3}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身也是一个用方括号括起来的逗号分隔列表，顺序与测试套件相同。例如，外部结构必须是 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$ 的形式，不含空格。",
            "solution": "所提出的问题是计算相对论电动力学中一个有效且适定的练习。它在科学上植根于无力电动力学（FFE）的原理，这是现代天体物理学中广泛使用的一种近似方法，用于模拟脉冲星和黑洞等致密天体的磁层。该问题是客观、独立的，所有术语都得到了明确定义。我将进行全面的推导和分析。\n\n### 1. 数值限制器的推导\n\n限制器的目的是强制执行磁场主导条件 $B^2 - E^2 > 0$，这是 FFE 的基础。在数值上，明智的做法是强制执行一个稍微更严格的版本，$B^2 - E^2 \\ge \\epsilon B^2$，其中 $0  \\epsilon \\ll 1$ 是一个小的无量纲安全裕度。这可以防止状态达到洛伦兹不变量 $B^2-E^2$ 为零的奇异极限 $E^2 = B^2$。\n\n该限制器旨在通过使用标量因子 $s \\le 1$ 进行重新缩放 $E' = s E$ 来作用于电场 $E$，同时保持磁场 $B$ 不变。目标是找到 $s$ 的值，以便在满足约束的同时最小程度地修改 $E$（即，使 $s$ 尽可能接近 1）。\n\n修改后的电场平方为 $E'^2 = (sE) \\cdot (sE) = s^2 E^2$。将其代入所需约束条件，得到：\n$$\nB^2 - s^2 E^2 \\ge \\epsilon B^2\n$$\n假设 $E^2 > 0$，重新整理这个不等式以求解 $s^2$：\n$$\ns^2 E^2 \\le B^2 - \\epsilon B^2\n$$\n$$\ns^2 \\le (1-\\epsilon)\\frac{B^2}{E^2}\n$$\n只有当初始状态违反或即将违反约束时，限制器才应被激活。因此，限制器激活的条件是 $B^2 - E^2  \\epsilon B^2$，这等价于 $E^2 > (1-\\epsilon)B^2$。\n\n我们定义允许的最大电场平方值为 $E^2_{max} = (1-\\epsilon)B^2$。\n- 如果初始状态满足 $E^2 \\le E^2_{max}$，则无需修改。为了保持 $E$ 不变，我们必须设置 $s=1$。\n- 如果初始状态违反了此条件，$E^2 > E^2_{max}$，我们必须重新缩放 $E$。为了最小程度地改变 $E$，我们选择满足约束的可能的最大 $s$ 值。这对应于将不等式变为等式：$s^2 = \\frac{E^2_{max}}{E^2}$。\n\n结合这两种情况，缩放因子 $s$ 由以下公式给出：\n$$\ns = \\begin{cases}\n    \\sqrt{\\frac{(1-\\epsilon)B^2}{E^2}}  \\text{if } E^2 > (1-\\epsilon)B^2 \\\\\n    1  \\text{if } E^2 \\le (1-\\epsilon)B^2\n\\end{cases}\n$$\n这可以紧凑地表示为 $s = \\min\\left(1, \\sqrt{\\frac{(1-\\epsilon)B^2}{E^2}}\\right)$，并注意处理 $E^2=0$ 的情况。如果 $E=0$，那么 $E^2=0 \\le (1-\\epsilon)B^2$（假设 $B^2 \\ge 0, \\epsilon  1$），所以 $s=1$ 且 $E'=E=0$，这是正确的。\n\n### 2. 场正交性的保持\n\n另一个基本的 FFE 约束是 $E \\cdot B = 0$。限制器必须保持此条件。给定一个初始状态 $E \\cdot B = 0$，修改后场 $E'$ 的点积为：\n$$\nE' \\cdot B = (sE) \\cdot B = s (E \\cdot B)\n$$\n由于 $E \\cdot B = 0$，因此 $E' \\cdot B = s(0) = 0$。限制器正确地保持了电场和磁场的正交性。\n\n### 3. 限制器的影响分析\n\n我们现在分析限制器对关键物理量的影响。当应用限制时，$s  1$；否则，$s=1$ 且所有量都保持不变。\n\n**3.1. 电磁能量密度**\n\n初始和最终的能量密度为：\n$$\nu = \\frac{1}{2}(E^2 + B^2)\n$$\n$$\nu' = \\frac{1}{2}(E'^2 + B^2) = \\frac{1}{2}(s^2 E^2 + B^2)\n$$\n能量密度的比率 $r_u = u'/u$ 为：\n$$\nr_u = \\frac{\\frac{1}{2}(s^2 E^2 + B^2)}{\\frac{1}{2}(E^2 + B^2)} = \\frac{s^2 E^2 + B^2}{E^2 + B^2}\n$$\n由于 $s \\le 1$，因此 $s^2 \\le 1$。于是，$s^2 E^2 + B^2 \\le E^2 + B^2$，这意味着 $r_u \\le 1$。等式 $r_u=1$ 仅在 $s=1$（无限制）或 $E=0$ 时成立。当限制器激活时（$s1$ 且 $E \\ne 0$），$r_u  1$。这表明**该限制器不是能量守恒的；它对电磁场能量是耗散的**。\n\n**3.2. 漂移速度**\n\n漂移速度 $v_d$ 代表磁力线的速度。初始和最终的漂移速度为：\n$$\nv_d = \\frac{\\lVert E \\times B \\rVert}{B^2}\n$$\n$$\nv_d' = \\frac{\\lVert E' \\times B \\rVert}{B^2}\n$$\n新的坡印亭矢量是 $S' = E' \\times B = (sE) \\times B = s(E \\times B)$。其大小为 $\\lVert S' \\rVert = |s| \\lVert E \\times B \\rVert$。由于 $s \\ge 0$，这等于 $s \\lVert E \\times B \\rVert$。\n将此代入 $v_d'$ 的表达式中：\n$$\nv_d' = \\frac{s \\lVert E \\times B \\rVert}{B^2} = s v_d\n$$\n漂移速度直接按因子 $s$ 进行缩放。由于 $s \\le 1$，限制器总是减小或维持漂移速度，$v_d' \\le v_d$。这一作用对于数值稳定性至关重要，因为它防止了场线速度超过光速。\n\n**3.3. 能流速度**\n\n能流速度 $v_S$ 是电磁能量传播的速度。初始和最终的速度为：\n$$\nv_S = \\frac{\\lVert S \\rVert}{u} = \\frac{\\lVert E \\times B \\rVert}{\\frac{1}{2}(E^2 + B^2)}\n$$\n$$\nv_S' = \\frac{\\lVert S' \\rVert}{u'} = \\frac{s \\lVert E \\times B \\rVert}{\\frac{1}{2}(s^2 E^2 + B^2)}\n$$\n我们可以用 $v_S$ 来表示 $v_S'$。根据 $v_S$ 的定义，我们有 $\\lVert E \\times B \\rVert = v_S \\cdot u = v_S \\cdot \\frac{1}{2}(E^2 + B^2)$。将此代入 $v_S'$ 的表达式中：\n$$\nv_S' = v_S \\left( \\frac{s(E^2 + B^2)}{s^2 E^2 + B^2} \\right)\n$$\n$v_S$ 的缩放因子是 $\\frac{s(E^2 + B^2)}{s^2 E^2 + B^2}$。如思考过程所示，该因子随 $s$ 单调递增，并在 $s=1$ 时等于 1。由于 $s \\le 1$，该因子也 $\\le 1$。因此，$v_S' \\le v_S$。限制器会减小或维持能流速度。\n\n### 4. 分析总结\n\n推导出的限制器 $E' = sE$ 是一种最小化的修改，它强制执行磁场主导条件 $B^2-E'^2 \\ge \\epsilon B^2$。它是非能量守恒的，在激活时会耗散电磁能量（$r_u  1$）。在一个完整的物理系统中，这些耗散的能量会转移到等离子体中，导致加热。漂移速度（$v_d$）和能流速度（$v_S$）都会被减小（或维持）。这种特征速度的降低具有稳定作用，防止它们变得超光速，从而保证了数值解的因果性。它是稳健的无力电动力学数值模拟中一个必不可少的组成部分。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the force-free electrodynamics limiter problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        {'E': np.array([0., 1. / np.sqrt(2), 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., np.sqrt(0.9985), 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., np.sqrt(1.001), 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., 0., 0.]), 'B': np.array([0., 0., 1.]), 'epsilon': 1e-3},\n        {'E': np.array([0., 1.5, 0.]), 'B': np.array([0., 0., 2.0]), 'epsilon': 1e-3},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E = case['E']\n        B = case['B']\n        epsilon = case['epsilon']\n\n        E2 = np.dot(E, E)\n        B2 = np.dot(B, B)\n\n        # Condition for applying the limiter\n        # The threshold for E^2 is (1-epsilon)*B^2\n        E2_max = (1.0 - epsilon) * B2\n        \n        rescaling_applied = E2  E2_max\n\n        # Calculate the scaling factor s\n        if rescaling_applied:\n            # E2 must be  0 if rescaling is applied, so no division by zero here.\n            s = np.sqrt(E2_max / E2)\n        else:\n            s = 1.0\n\n        # Calculate initial (pre-limiter) quantities\n        u = 0.5 * (E2 + B2)\n        E_cross_B = np.cross(E, B)\n        norm_S = np.linalg.norm(E_cross_B)\n\n        vd = norm_S / B2 if B2  0 else 0.0\n        vS = norm_S / u if u  0 else 0.0\n\n        # Calculate final (post-limiter) quantities\n        s2 = s * s\n        E2_p = s2 * E2\n        u_p = 0.5 * (E2_p + B2)\n        norm_S_p = s * norm_S\n\n        r_u = u_p / u if u  0 else 1.0\n        \n        vd_p = s * vd\n        vS_p = norm_S_p / u_p if u_p  0 else 0.0\n\n        # Assemble the results for this case\n        case_result = [\n            rescaling_applied,\n            r_u,\n            vd,\n            vd_p,\n            vS,\n            vS_p\n        ]\n        all_results.append(case_result)\n\n    # Format the final output string as per requirements\n    case_results_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(case_results_str)}]\")\n\nsolve()\n\n```"
        }
    ]
}