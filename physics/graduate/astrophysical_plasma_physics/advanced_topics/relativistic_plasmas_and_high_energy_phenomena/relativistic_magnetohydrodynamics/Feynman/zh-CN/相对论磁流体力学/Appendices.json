{
    "hands_on_practices": [
        {
            "introduction": "相对论性磁流体动力学（RMHD）的核心在于其协变性，即物理定律在所有惯性参考系中形式相同。本练习通过一个基本但至关重要的计算，帮助你建立对电磁场张量 $F^{\\mu\\nu}$ 在洛伦兹变换下如何表现的直观理解 。通过从一个纯磁场参考系变换到一个移动参考系并导出感应电场，你将亲手验证电场和磁场是如何相互混合的，同时体会电磁不变量 $I_1$ 和 $I_2$ 的深刻意义。",
            "id": "4226076",
            "problem": "考虑一个与天体物理等离子体中的相对论磁流体力学相关的均匀、不随时间变化的电磁场构型。在平直的闵可夫斯基时空中进行计算，其度规为 $g_{\\mu\\nu} = \\mathrm{diag}(-1,+1,+1,+1)$，并采用自然单位制，其中光速 $c=1$。定义电磁场张量 $F^{\\mu\\nu}$ 为 $F^{0i} = E^{i}$ 和 $F^{ij} = \\epsilon^{ijk} B^{k}$，其中 $\\epsilon^{\\mu\\nu\\alpha\\beta}$ 是完全反对称的列维-奇维塔符号，满足 $\\epsilon^{0123} = +1$ 且 $\\epsilon^{ijk} \\equiv \\epsilon^{0ijk}$。其霍奇对偶张量为 $\\tilde{F}^{\\mu\\nu} \\equiv \\frac{1}{2}\\,\\epsilon^{\\mu\\nu\\alpha\\beta} F_{\\alpha\\beta}$。定义两个电磁不变量\n$$\nI_{1} \\equiv \\frac{1}{2}\\,F_{\\mu\\nu} F^{\\mu\\nu}, \\qquad I_{2} \\equiv \\frac{1}{4}\\,\\tilde{F}_{\\mu\\nu} F^{\\mu\\nu}.\n$$\n在实验室参考系 $\\mathcal{S}$ 中，场是纯磁场，$\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$ 且 $\\mathbf{E}=\\mathbf{0}$。考虑一个相对于 $\\mathcal{S}$ 沿 $+\\hat{\\mathbf{x}}$ 方向以恒定速度 $v$ 运动的参考系 $\\mathcal{S}'$ 的洛伦兹变换。令 $\\gamma \\equiv (1 - v^{2})^{-1/2}$。该洛伦兹变换对应的逆变洛伦兹变换矩阵为\n$$\n\\Lambda^{\\mu}{}_{\\nu} = \n\\begin{pmatrix}\n\\gamma  & -\\gamma v & 0 & 0 \\\\\n-\\gamma v & \\gamma  & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$\n从张量变换定律 $F'^{\\mu\\nu} = \\Lambda^{\\mu}{}_{\\alpha}\\,\\Lambda^{\\nu}{}_{\\beta}\\,F^{\\alpha\\beta}$ 及上述定义出发，推导在加速参考系 $\\mathcal{S}'$ 中的感应电场分量 $E'_{x}$、$E'_{y}$ 和 $E'_{z}$。使用同样的基本定义，在 $\\mathcal{S}'$ 中计算不变量 $I_{1}$ 和 $I_{2}$，并与它们在 $\\mathcal{S}$ 中的值进行比较，以验证其不变性。将你的最终答案表示为一个单行矩阵，其中包含 $\\mathcal{S}'$ 中感应电场的三个分量，以及 $I_{1}$ 和 $I_{2}$ 的值，用 $B_{0}$、$v$ 和 $\\gamma$ 表示。不需要进行数值近似；请提供精确的解析表达式。使用自然单位制，$c=1$；不要在最终的方框表达式中包含单位。",
            "solution": "该问题是有效的，因为它在科学上基于狭义相对论和经典电磁学，问题陈述清晰且信息充分，可得出唯一解，并且陈述客观。我们可以开始求解。\n\n第一步是在实验室参考系 $\\mathcal{S}$ 中构建电磁场张量 $F^{\\mu\\nu}$。给定的场为 $\\mathbf{E} = \\mathbf{0}$ 和 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$。用分量形式表示，即 $E^{1}=E^{2}=E^{3}=0$ 以及 $B^{1}=B^{2}=0$，$B^{3}=B_{0}$。\n\n使用定义 $F^{0i} = E^{i}$ (其中 $c=1$)，我们得到 $F^{01}=F^{02}=F^{03}=0$。\n使用定义 $F^{ij} = \\epsilon^{ijk} B^{k}$，其中 $\\epsilon^{123}=+1$，我们求得空间分量：\n$F^{12} = \\epsilon^{12k} B^{k} = \\epsilon^{123} B^{3} = (1)(B_{0}) = B_{0}$。\n$F^{13} = \\epsilon^{13k} B^{k} = \\epsilon^{132} B^{2} = (-1)(0) = 0$。\n$F^{23} = \\epsilon^{23k} B^{k} = \\epsilon^{231} B^{1} = (1)(0) = 0$。\n根据反对称性，$F^{\\nu\\mu} = -F^{\\mu\\nu}$，所以 $F^{21} = -B_{0}$，所有其他分量都为零。在参考系 $\\mathcal{S}$ 中的逆变场张量为：\n$$\nF^{\\alpha\\beta} = \n\\begin{pmatrix}\n0  & 0  & B_{0}  & 0 \\\\\n0  & 0  & 0  & 0 \\\\\n0  & -B_{0}  & 0  & 0 \\\\\n0  & 0  & 0  & 0\n\\end{pmatrix}\n$$\n接下来，我们使用给定的洛伦兹变换矩阵 $\\Lambda^{\\mu}{}_{\\nu}$ 和变换定律 $F'^{\\mu\\nu} = \\Lambda^{\\mu}{}_{\\alpha}\\,\\Lambda^{\\nu}{}_{\\beta}\\,F^{\\alpha\\beta}$，将该张量变换到加速参考系 $\\mathcal{S}'$。在 $\\mathcal{S}'$ 中感应电场 $\\mathbf{E}'$ 的分量由 $E'^{i} = F'^{0i}$ 给出。\n\n分量 $E'_{x} = E'^{1} = F'^{01}$：\n$F'^{01} = \\sum_{\\alpha, \\beta} \\Lambda^{0}{}_{\\alpha}\\,\\Lambda^{1}{}_{\\beta}\\,F^{\\alpha\\beta}$。$F^{\\alpha\\beta}$ 的非零分量仅有 $F^{12}=B_{0}$ 和 $F^{21}=-B_{0}$。因此，求和简化为：\n$$\nF'^{01} = \\Lambda^{0}{}_{1}\\,\\Lambda^{1}{}_{2}\\,F^{12} + \\Lambda^{0}{}_{2}\\,\\Lambda^{1}{}_{1}\\,F^{21}\n$$\n从给定的矩阵 $\\Lambda^{\\mu}{}_{\\nu}$，我们有 $\\Lambda^{0}{}_{1}=-\\gamma v$，$\\Lambda^{1}{}_{2}=0$，$\\Lambda^{0}{}_{2}=0$ 和 $\\Lambda^{1}{}_{1}=\\gamma$。代入这些值：\n$$\nE'_{x} = F'^{01} = (-\\gamma v)(0)(B_{0}) + (0)(\\gamma)(-B_{0}) = 0\n$$\n\n分量 $E'_{y} = E'^{2} = F'^{02}$：\n$$\nF'^{02} = \\sum_{\\alpha, \\beta} \\Lambda^{0}{}_{\\alpha}\\,\\Lambda^{2}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{0}{}_{1}\\,\\Lambda^{2}{}_{2}\\,F^{12} + \\Lambda^{0}{}_{2}\\,\\Lambda^{2}{}_{1}\\,F^{21}\n$$\n$\\Lambda$ 的分量为 $\\Lambda^{0}{}_{1}=-\\gamma v$，$\\Lambda^{2}{}_{2}=1$ 和 $\\Lambda^{0}{}_{2}=0$。\n$$\nE'_{y} = F'^{02} = (-\\gamma v)(1)(B_{0}) + (0)\\Lambda^{2}{}_{1}(-B_{0}) = -\\gamma v B_{0}\n$$\n\n分量 $E'_{z} = E'^{3} = F'^{03}$：\n$$\nF'^{03} = \\sum_{\\alpha, \\beta} \\Lambda^{0}{}_{\\alpha}\\,\\Lambda^{3}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{0}{}_{1}\\,\\Lambda^{3}{}_{2}\\,F^{12} + \\Lambda^{0}{}_{2}\\,\\Lambda^{3}{}_{1}\\,F^{21}\n$$\n$\\Lambda$ 的分量为 $\\Lambda^{3}{}_{2}=0$ 和 $\\Lambda^{0}{}_{2}=0$。\n$$\nE'_{z} = F'^{03} = (-\\gamma v)(0)(B_{0}) + (0)\\Lambda^{3}{}_{1}(-B_{0}) = 0\n$$\n因此，在参考系 $\\mathcal{S}'$ 中的感应电场为 $\\mathbf{E}' = (0, -\\gamma v B_{0}, 0)$。\n\n接下来，我们计算电磁不变量 $I_{1}$ 和 $I_{2}$。\n首先，在实验室参考系 $\\mathcal{S}$ 中，我们有 $\\mathbf{E}=0$ 和 $\\mathbf{B}=(0,0,B_{0})$。可以使用常用表达式 $I_{1} = B^{2} - E^{2}$ 和 $I_{2} = -\\mathbf{E} \\cdot \\mathbf{B}$ (在 $c=1$ 的单位制下) 直接从这些场计算不变量。\n$$\nI_{1} = B_{0}^{2} - 0^{2} = B_{0}^{2}\n$$\n$$\nI_{2} = -(\\mathbf{0} \\cdot (0,0,B_{0})) = 0\n$$\n\n为了验证其不变性，我们必须在参考系 $\\mathcal{S}'$ 中计算它们，并证明我们得到相同的结果。为此，我们需要参考系 $\\mathcal{S}'$ 中的磁场 $\\mathbf{B}'$。$\\mathbf{B}'$ 的分量由 $B'^{1} = F'^{23}$，$B'^{2} = F'^{31}$，$B'^{3} = F'^{12}$ 给出。\n$B'_{x} = B'^{1} = F'^{23} = \\Lambda^{2}{}_{\\alpha}\\,\\Lambda^{3}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{2}{}_{1}\\Lambda^{3}{}_{2}F^{12} + \\Lambda^{2}{}_{2}\\Lambda^{3}{}_{1}F^{21} = (0)(0)B_{0}+(1)(0)(-B_{0}) = 0$。\n$B'_{y} = B'^{2} = F'^{31} = \\Lambda^{3}{}_{\\alpha}\\,\\Lambda^{1}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{3}{}_{1}\\Lambda^{1}{}_{2}F^{12} + \\Lambda^{3}{}_{2}\\Lambda^{1}{}_{1}F^{21} = (0)(0)B_{0}+(0)(\\gamma)(-B_{0}) = 0$。\n$B'_{z} = B'^{3} = F'^{12} = \\Lambda^{1}{}_{\\alpha}\\,\\Lambda^{2}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{1}{}_{1}\\Lambda^{2}{}_{2}F^{12} + \\Lambda^{1}{}_{2}\\Lambda^{2}{}_{1}F^{21} = (\\gamma)(1)B_{0}+(0)(0)(-B_{0}) = \\gamma B_{0}$。\n所以，在 $\\mathcal{S}'$ 中的磁场是 $\\mathbf{B}' = (0, 0, \\gamma B_{0})$。\n\n现在我们使用 $\\mathbf{E}' = (0, -\\gamma v B_{0}, 0)$ 和 $\\mathbf{B}' = (0, 0, \\gamma B_{0})$ 在 $\\mathcal{S}'$ 中计算不变量。\n对于 $I'_{1}$：\n$$\nE'^{2} = (E'_{x})^{2} + (E'_{y})^{2} + (E'_{z})^{2} = 0^{2} + (-\\gamma v B_{0})^{2} + 0^{2} = \\gamma^{2}v^{2}B_{0}^{2}\n$$\n$$\nB'^{2} = (B'_{x})^{2} + (B'_{y})^{2} + (B'_{z})^{2} = 0^{2} + 0^{2} + (\\gamma B_{0})^{2} = \\gamma^{2}B_{0}^{2}\n$$\n$$\nI'_{1} = B'^{2} - E'^{2} = \\gamma^{2}B_{0}^{2} - \\gamma^{2}v^{2}B_{0}^{2} = \\gamma^{2}(1-v^{2})B_{0}^{2}\n$$\n使用定义 $\\gamma \\equiv (1-v^{2})^{-1/2}$，我们有 $\\gamma^{2}(1-v^{2})=1$。\n$$\nI'_{1} = (1)B_{0}^{2} = B_{0}^{2}\n$$\n这与参考系 $\\mathcal{S}$ 中 $I_{1}$ 的值相匹配，验证了其不变性。\n\n对于 $I'_{2}$：\n$$\nI'_{2} = -\\mathbf{E}' \\cdot \\mathbf{B}' = -[(0)(0) + (-\\gamma v B_{0})(0) + (0)(\\gamma B_{0})] = 0\n$$\n这与参考系 $\\mathcal{S}$ 中 $I_{2}$ 的值相匹配，验证了其不变性。\n\n最终答案要求给出在 $\\mathcal{S}'$ 中感应电场的三个分量（$E'_{x}$、$E'_{y}$、$E'_{z}$），以及不变量 $I_{1}$ 和 $I_{2}$ 的值。它们是：\n$E'_{x} = 0$\n$E'_{y} = -\\gamma v B_{0}$\n$E'_{z} = 0$\n$I_{1} = B_{0}^{2}$\n$I_{2} = 0$\n我们按照要求将这些值组合成一个单行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & -\\gamma v B_{0} & 0 & B_{0}^{2} & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然RMHD的协变形式优美且强大，但在实际的数值模拟和数据分析中，我们通常在特定的实验室参考系中工作。本练习将引导你完成一个关键的“3+1分解”过程，将抽象的协变应力-能量张量 $T^{\\mu\\nu}$ 投影到时间和平直空间分量上 。掌握如何将守恒变量（如动量密度 $S_i$ 和能量 $\\tau$）用基本变量（如密度 $\\rho$、速度 $\\mathbf{v}$ 和压强 $p$）表示，是理解和开发RMHD数值程序的核心技能。",
            "id": "4226056",
            "problem": "在狭义相对论理想磁流体力学（理想 RMHD）中，考虑平直时空中一个均匀、不随时变的等离子体状态，其 Minkowski 度规符号为 $(-,+,+,+)$。在 Heaviside–Lorentz 单位制中进行计算，并设 $c=1$ 和 $4\\pi=1$。相对于 Eulerian 观测者进行 $3+1$ 分解，该观测者的四维速度是超曲面法向量 $n^{\\mu}$，因此流体四维速度分解为 $u^{\\mu} = W \\left( n^{\\mu} + v^{\\mu} \\right)$，其中 $v^{\\mu} n_{\\mu} = 0$, $v^{\\mu} = (0, v^{i})$, $W = \\left( 1 - | \\mathbf{v} |^{2} \\right)^{-1/2}$，空间度规为 $\\gamma_{ij} = \\delta_{ij}$。Eulerian 观测者测得的磁场为 $B^{i}$，电场满足理想条件 $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$。\n\n在 Valencia 形式中，守恒变量由静质量流和应力-能量张量的 Eulerian 投影定义：\n- $D \\equiv \\rho W$,\n- $S_{i} \\equiv - T^{\\mu \\nu} n_{\\mu} \\gamma_{\\nu i}$,\n- $E \\equiv T^{\\mu \\nu} n_{\\mu} n_{\\nu}$, 以及 $\\tau \\equiv E - D$,\n其中理想 RMHD 应力-能量张量为\n$$\nT^{\\mu \\nu} = \\left( \\rho h + b^{2} \\right) u^{\\mu} u^{\\nu} + \\left( p + \\frac{b^{2}}{2} \\right) g^{\\mu \\nu} - b^{\\mu} b^{\\nu},\n$$\n这里 $h = 1 + \\epsilon + p/\\rho$ 是比焓，$b^{\\mu} \\equiv {}^{\\ast}F^{\\mu \\nu} u_{\\nu}$ 是在流体静止系中测量的磁场四维矢量，${}^{\\ast}F^{\\mu \\nu}$ 是 Faraday 张量的对偶。假设一个理想 $\\Gamma$ 律状态方程 $\\epsilon = p \\big/ \\left[ (\\Gamma - 1) \\rho \\right]$，因此 $h = 1 + \\Gamma p \\big/ \\left[ (\\Gamma - 1) \\rho \\right]$。\n\n任务：\n1) 从上述定义和基本定律出发，推导 $S_{i}$ 和 $\\tau$ 关于原始变量 $(\\rho, v^{i}, p, B^{i})$ 及其欧几里得收缩和 $W$ 的显式表达式。你的推导过程必须通过将 $T^{\\mu \\nu}$ 沿 $n^{\\mu}$ 和 $\\gamma^{\\mu}{}_{\\nu}$ 投影，并利用理想条件将 $b^{\\mu}$ 与 $(\\mathbf{v}, \\mathbf{B})$ 联系起来。\n\n2) 对于具有以下参数的特定均匀状态：\n$$\n\\rho = 1,\\quad p = 0.1,\\quad \\Gamma = \\frac{4}{3},\\quad \\mathbf{v} = (0.6,\\, 0.3,\\, 0.0),\\quad \\mathbf{B} = (0.5,\\,-0.2,\\,0.3),\n$$\n数值计算你的 $\\tau$ 表达式。将最终答案四舍五入到五位有效数字。以代码单位（即上述定义的单位）表示最终值。你的最终答案必须是一个实数。",
            "solution": "该问题陈述具有科学依据、是适定的，并包含了获得唯一解所需的所有信息。这是相对论磁流体力学领域的一个标准推导和计算。因此，该问题被认为是有效的。\n\n任务分为两部分。第一，推导守恒动量密度 $S_i$ 和守恒能量 $\\tau$ 关于原始变量 $(\\rho, v^i, p, B^i)$ 的表达式。第二，为这些变量的一组特定值计算 $\\tau$。\n\n**第一部分：$S_i$ 和 $\\tau$ 的推导**\n\n推导从理想相对论磁流体的守恒变量和应力-能量张量 $T^{\\mu \\nu}$ 的给定定义开始。我们在平直时空中工作，Minkowski 度规为 $g_{\\mu \\nu} = \\eta_{\\mu \\nu} = \\text{diag}(-1, 1, 1, 1)$，并设光速 $c=1$。Eulerian 观测者的四维速度为 $n^{\\mu}=(1,0,0,0)$，因此 $n_{\\mu}=(-1,0,0,0)$。流体的四维速度为 $u^{\\mu} = W(n^{\\mu} + v^{\\mu}) = (W, W v^i)$，其中 $W=(1-|\\mathbf{v}|^2)^{-1/2}$ 是洛伦兹因子，$v^\\mu = (0, v^i)$。协变分量为 $u_{\\mu} = \\eta_{\\mu\\nu}u^\\nu = (-W, W v_i)$。由于空间度规是欧几里得的，$\\gamma_{ij}=\\delta_{ij}$，我们有 $v_i = v^i$。\n\n首先，我们需要用 Eulerian 坐标系下的场 $(\\mathbf{v}, \\mathbf{B})$ 来表示磁场四维矢量 $b^{\\mu}$。其定义为 $b^{\\mu} = {}^{\\ast}F^{\\mu \\nu} u_{\\nu}$，其中 ${}^{\\ast}F^{\\mu \\nu}$ 是 Faraday 张量的对偶。在实验室系中，根据理想 MHD 条件 $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$，对偶张量的分量为 ${}^{\\ast}F^{0i} = -B^i$ 和 ${}^{\\ast}F^{ij} = -\\epsilon^{ijk}E_k = \\epsilon^{ijk}(\\mathbf{v} \\times \\mathbf{B})_k$。\n$b^\\mu$ 的分量是 $b^0 = W(\\mathbf{B}\\cdot\\mathbf{v})$ 和 $b^i = \\frac{B^i}{W} + W(\\mathbf{B}\\cdot\\mathbf{v}) v^i$。\n标量 $b^2$ 是不变量，可以计算得出 $b^2 = b^{\\mu}b_{\\mu} = \\frac{|\\mathbf{B}|^2}{W^2} + (\\mathbf{B}\\cdot\\mathbf{v})^2$。这个量 $b^2$ 表示共动坐标系中的磁能密度，是正定的。\n\n现在我们推导 $S_i$ 和 $\\tau$。\n守恒动量密度为 $S_i \\equiv -T^{\\mu\\nu}n_{\\mu}\\gamma_{\\nu i}$。投影算子 $\\gamma_{\\nu i}$ 的分量为 $\\gamma_{0i}=0$ 和 $\\gamma_{ji}=\\delta_{ji}$。\n$$\nS_i = -T^{\\mu\\nu}n_{\\mu}\\gamma_{\\nu i} = -T^{j0}(-1)\\delta_{ji} = T^{0i}\n$$\n我们从应力-能量张量中找到 $T^{0i}$：\n$$\nT^{0i} = (\\rho h + b^2)u^0 u^i + (p + \\frac{b^2}{2})g^{0i} - b^0 b^i\n$$\n其中 $u^0=W$, $u^i=Wv^i$, $g^{0i}=0$：\n$$\nS_i = (\\rho h + b^2)W^2 v^i - b^0 b^i\n$$\n代入 $b^2$, $b^0$ 和 $b^i$ 的表达式并化简，可得：\n$$\nS_i = (\\rho h W^2 + |\\mathbf{B}|^2) v^i - B^i(\\mathbf{B}\\cdot\\mathbf{v})\n$$\n\n接下来，我们推导 $\\tau = E-D$ 的表达式。首先，我们找到 $E = T^{\\mu\\nu}n_\\mu n_\\nu = T^{00}$。\n$$\nE = T^{00} = (\\rho h + b^2)u^0 u^0 + (p + \\frac{b^2}{2})g^{00} - b^0 b^0\n$$\n其中 $u^0=W$，$g^{00}=-1$：\n$$\nE = (\\rho h + b^2)W^2 - (p + \\frac{b^2}{2}) - (b^0)^2\n$$\n代入 $b^2$ 和 $b^0$ 并化简：\n$$\nE = \\rho h W^2 - p + \\frac{|\\mathbf{B}|^2 + |\\mathbf{B}|^2|\\mathbf{v}|^2 - (\\mathbf{B}\\cdot\\mathbf{v})^2}{2}\n$$\n最后，我们计算 $\\tau = E - D$，其中 $D=\\rho W$：\n$$\n\\tau = \\rho h W^2 - \\rho W - p + \\frac{|\\mathbf{B}|^2(1+|\\mathbf{v}|^2) - (\\mathbf{B}\\cdot\\mathbf{v})^2}{2}\n$$\n\n**第二部分：数值计算**\n\n我们给定以下以代码单位表示的原始变量：\n- $\\rho = 1$\n- $p = 0.1$\n- $\\Gamma = 4/3$\n- $\\mathbf{v} = (0.6, 0.3, 0.0)$\n- $\\mathbf{B} = (0.5, -0.2, 0.3)$\n\n首先，我们计算必要的中间量：\n- $|\\mathbf{v}|^2 = (0.6)^2 + (0.3)^2 + (0.0)^2 = 0.36 + 0.09 = 0.45$\n- $W = (1 - |\\mathbf{v}|^2)^{-1/2} = (1 - 0.45)^{-1/2} = (0.55)^{-1/2} \\approx 1.3483997$\n- $W^2 = 1/0.55 \\approx 1.8181818$\n- $|\\mathbf{B}|^2 = (0.5)^2 + (-0.2)^2 + (0.3)^2 = 0.25 + 0.04 + 0.09 = 0.38$\n- $\\mathbf{B} \\cdot \\mathbf{v} = (0.5)(0.6) + (-0.2)(0.3) + (0.3)(0.0) = 0.30 - 0.06 = 0.24$\n- $(\\mathbf{B} \\cdot \\mathbf{v})^2 = (0.24)^2 = 0.0576$\n- 比焓 $h = 1 + \\frac{\\Gamma}{\\Gamma - 1} \\frac{p}{\\rho} = 1 + \\frac{4/3}{4/3 - 1} \\frac{0.1}{1} = 1 + \\frac{4/3}{1/3} (0.1) = 1 + 4(0.1) = 1.4$\n\n现在我们将这些值代入 $\\tau$ 的表达式中：\n$$\n\\tau = \\rho h W^2 - \\rho W - p + \\frac{1}{2} \\left(|\\mathbf{B}|^2(1+|\\mathbf{v}|^2) - (\\mathbf{B}\\cdot\\mathbf{v})^2\\right)\n$$\n$$\n\\tau = (1)(1.4)\\left(\\frac{1}{0.55}\\right) - (1)\\left(\\frac{1}{\\sqrt{0.55}}\\right) - 0.1 + \\frac{1}{2} \\left( (0.38)(1+0.45) - 0.0576 \\right)\n$$\n$$\n\\tau \\approx 2.5454545 - 1.3483997 - 0.1 + \\frac{1}{2} \\left( 0.551 - 0.0576 \\right)\n$$\n$$\n\\tau \\approx 1.0970548 + \\frac{1}{2} (0.4934)\n$$\n$$\n\\tau \\approx 1.0970548 + 0.2467\n$$\n$$\n\\tau \\approx 1.3437548\n$$\n四舍五入到五位有效数字，我们得到 $1.3438$。",
            "answer": "$$\n\\boxed{1.3438}\n$$"
        },
        {
            "introduction": "现代天体物理学研究在很大程度上依赖于复杂的数值模拟，而模拟的准确性取决于其是否能严格遵守基本的物理定律。本练习将带你进入计算RMHD的核心，通过推导并实现约束输运（Constrained Transport, CT）方法，来解决保持磁场无散度条件 $\\nabla \\cdot \\mathbf{B} = 0$ 的关键数值挑战 。这个实践将不仅加深你对法拉第定律的离散化理解，还将为你提供构建稳定、精确的磁流体动力学模拟的第一手经验。",
            "id": "4226037",
            "problem": "考虑理想相对论磁流体动力学（RMHD），在该体系下电场满足理想欧姆定律和法拉第定律。使用以下基本法则：(i) Maxwell–Faraday 定律 $\\nabla\\times\\mathbf{E} = -\\partial_t \\mathbf{B}$，(ii) 理想 RMHD 中的理想欧姆定律 $\\mathbf{E} = -\\mathbf{v}\\times\\mathbf{B}$（其中光速设为 $c=1$），以及 (iii) 周期性边界条件。在一个均匀的二维（$2$D）笛卡尔网格上进行计算，网格间距为 $\\Delta x$ 和 $\\Delta y$，并采用交错的 Yee 网格布局：将 $B_x$ 存储在垂直于 $x$ 方向的面上，位置为 $(i\\Delta x, (j+\\tfrac{1}{2})\\Delta y)$；将 $B_y$ 存储在垂直于 $y$ 方向的面上，位置为 $((i+\\tfrac{1}{2})\\Delta x, j\\Delta y)$；将电动势的 $z$ 分量 $E_z$ 存储在单元格角点上，位置为 $(i\\Delta x, j\\Delta y)$。速度存储在单元格中心，位置为 $((i+\\tfrac{1}{2})\\Delta x, (j+\\tfrac{1}{2})\\Delta y)$。所有量均为无量纲量（无量纲单位，且 $c=1$）。\n\n任务 A（推导）。严格从上述基本法则出发，仅使用适合交错网格的积分形式以及离散 Stoke 定理和散度定理，推导离散的约束输运（CT）更新方法。该方法使用边中心的电动势将 $B_x$ 和 $B_y$ 显式推进一个时间步长 $\\Delta t$，并确保 $\\mathbf{B}$ 的离散散度保持到机器精度。将单元格中心的离散散度定义为\n$$\n\\left(\\nabla\\cdot\\mathbf{B}\\right)_{i+\\frac{1}{2},j+\\frac{1}{2}} \\equiv \\frac{B_x(i+1,j)-B_x(i,j)}{\\Delta x} + \\frac{B_y(i,j+1)-B_y(i,j)}{\\Delta y},\n$$\n使用周期性索引，其中 $B_x(i,j)$ 表示面 $(i\\Delta x,(j+\\tfrac{1}{2})\\Delta y)$ 上的 $B_x$，$B_y(i,j)$ 表示面 $((i+\\tfrac{1}{2})\\Delta x,j\\Delta y)$ 上的 $B_y$。证明如果初始场在时间层 $n$ 满足离散无散度条件，则 CT 更新在周期性边界条件下能精确保持 $\\left(\\nabla\\cdot\\mathbf{B}\\right)^{n+1}=\\left(\\nabla\\cdot\\mathbf{B}\\right)^{n}$。\n\n任务 B（边中心的电动势）。指定并使用二阶中心插值法，根据面中心的 $\\mathbf{B}$ 和单元格中心的 $\\mathbf{v}$ 计算角点上的 $E_z$。具体来说，通过对周围四个单元格中心速度进行算术平均来计算角点中心的速度，并通过对两个相邻面进行算术平均来计算角点中心的面场量。然后根据理想欧姆定律计算角点上的 $E_z$。\n\n任务 C（实现）。在指定的交错网格上实现 CT 更新的一个前向 Euler 时间步。通过在网格节点角点 $(i\\Delta x,j\\Delta y)$ 引入一个标量势 $A_z$ 来初始化一个离散无散度磁场，并定义\n$$\nB_x(i,j) = \\frac{A_z(i,j+1)-A_z(i,j)}{\\Delta y},\\qquad\nB_y(i,j) = -\\frac{A_z(i+1,j)-A_z(i,j)}{\\Delta x},\n$$\n使用周期性索引。使用节点势\n$$\nA_z(x,y) = \\sin\\left(2\\pi x\\right)\\sin\\left(2\\pi y\\right).\n$$\n\n任务 D（测试套件与输出）。使用双精度算术、周期性边界和无量纲单位，对以下三个测试案例各运行一个 CT 更新步，并报告更新后 $\\mathbf{B}$ 的离散散度的最大绝对值：\n- 案例 1（常规情况）：$N_x=8$，$N_y=8$，$L_x=1$，$L_y=1$，$\\Delta x=L_x/N_x$，$\\Delta y=L_y/N_y$，$\\Delta t = 0.1\\,\\Delta x$。单元格中心的速度：$v_x(x,y) = 0.5\\sin(2\\pi y)$，$v_y(x,y) = 0.5\\cos(2\\pi x)$。\n- 案例 2（边缘情况，静止流体）：$N_x=8$，$N_y=8$，$L_x=1$，$L_y=1$，$\\Delta t = 0.1\\,\\Delta x$。速度恒为零：$v_x=v_y=0$。\n- 案例 3（边界形状变化，均匀流）：$N_x=7$，$N_y=5$，$L_x=1$，$L_y=1$，$\\Delta t = 0.2\\,\\min(\\Delta x,\\Delta y)$。速度均匀：$v_x=0.3$，$v_y=-0.4$。\n\n三角函数中的角度参数以弧度为单位。对于每个案例，您的程序应计算一个浮点数，其值等于所有单元格中心上 $|\\left(\\nabla\\cdot\\mathbf{B}\\right)^{n+1}|$ 的最大值。最终输出必须是单行文本，包含由方括号括起来的三个结果的逗号分隔列表（例如，$[\\mathrm{r}_1,\\mathrm{r}_2,\\mathrm{r}_3]$）。结果应以无量纲单位的浮点数表示。",
            "solution": "此问题被评估为有效，因为它具有科学依据、问题设定良好、客观、内部一致且完整。它提出了一个计算天体物理学中的标准数值问题，可以利用所提供的信息解决。\n\n### 任务 A：推导与证明\n\n任务是推导磁场分量 $B_x$ 和 $B_y$ 的离散约束输运（CT）更新方程，并证明此更新将 $\\mathbf{B}$ 的离散散度保持在机器精度。\n\n提供的基本定律是在二维笛卡尔坐标系中（$c=1$）的 Maxwell-Faraday 定律和理想欧姆定律：\n1. Maxwell-Faraday 定律：$\\nabla \\times \\mathbf{E} = -\\partial_t \\mathbf{B}$\n2. 理想欧姆定律：$\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$\n\n在二维系统中，若 $\\mathbf{v} = (v_x, v_y, 0)$ 且 $\\mathbf{B} = (B_x, B_y, 0)$，则电场为 $\\mathbf{E} = (0, 0, E_z)$，其中 $E_z = v_y B_x - v_x B_y$。$\\mathbf{E}$ 的旋度为 $(\\nabla \\times \\mathbf{E}) = (\\partial_y E_z, -\\partial_x E_z, 0)$。\n将其与 $-\\partial_t \\mathbf{B}$ 按分量相等，得到感应方程：\n$$\n\\frac{\\partial B_x}{\\partial t} = -\\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\n\n我们在指定的交错网格上离散化这些方程。设网格间距为 $\\Delta x$ 和 $\\Delta y$。$B_x$ 存储在面心 $(i\\Delta x, (j+\\frac{1}{2})\\Delta y)$ 处，我们记为 $B_x(i, j)$。$B_y$ 存储在面心 $((i+\\frac{1}{2})\\Delta x, j\\Delta y)$ 处，记为 $B_y(i, j)$。电场 $E_z$ 位于角点 $(i\\Delta x, j\\Delta y)$ 处，记为 $E_z(i, j)$。\n\n我们使用一阶显式 Euler 时间步和与交错网格一致的二阶中心空间差分来离散化感应方程。\n对于时间 $t^n$ 的 $B_x(i, j)$，通过在位置 $(i\\Delta x, (j+\\frac{1}{2})\\Delta y)$ 离散化 $\\partial_t B_x = -\\partial_y E_z$ 来找到更新到 $t^{n+1} = t^n + \\Delta t$ 的方法：\n$$\n\\frac{B_x^{n+1}(i, j) - B_x^n(i, j)}{\\Delta t} = - \\frac{E_z(i, j+1) - E_z(i, j)}{\\Delta y}\n$$\n整理后得到 $B_x$ 的更新方程：\n$$\nB_x^{n+1}(i, j) = B_x^n(i, j) - \\frac{\\Delta t}{\\Delta y} \\left( E_z(i, j+1) - E_z(i, j) \\right)\n$$\n\n对于时间 $t^n$ 的 $B_y(i, j)$，我们在位置 $((i+\\frac{1}{2})\\Delta x, j\\Delta y)$ 离散化 $\\partial_t B_y = \\partial_x E_z$：\n$$\n\\frac{B_y^{n+1}(i, j) - B_y^n(i, j)}{\\Delta t} = \\frac{E_z(i+1, j) - E_z(i, j)}{\\Delta x}\n$$\n整理后得到 $B_y$ 的更新方程：\n$$\nB_y^{n+1}(i, j) = B_y^n(i, j) + \\frac{\\Delta t}{\\Delta x} \\left( E_z(i+1, j) - E_z(i, j) \\right)\n$$\n这些就是 CT 更新方程。\n\n接下来，我们证明该格式保持 $\\mathbf{B}$ 的离散散度守恒。单元格中心 $((i+\\frac{1}{2})\\Delta x, (j+\\frac{1}{2})\\Delta y)$ 处的离散散度定义为：\n$$\nD_{i+\\frac{1}{2},j+\\frac{1}{2}} \\equiv (\\nabla\\cdot\\mathbf{B})_{i+\\frac{1}{2},j+\\frac{1}{2}} = \\frac{B_x(i+1, j) - B_x(i, j)}{\\Delta x} + \\frac{B_y(i, j+1) - B_y(i, j)}{\\Delta y}\n$$\n我们来计算时间层 $n+1$ 的散度 $D^{n+1}$。为简单起见，我们分析散度的变化量 $\\Delta x \\Delta y (D^{n+1} - D^n)$。\n$$\n\\Delta x \\Delta y (D^{n+1}_{i+\\frac{1}{2},j+\\frac{1}{2}} - D^n_{i+\\frac{1}{2},j+\\frac{1}{2}}) = \\Delta y \\left( (B_x^{n+1}(i+1,j) - B_x^n(i+1,j)) - (B_x^{n+1}(i,j) - B_x^n(i,j)) \\right) + \\Delta x \\left( (B_y^{n+1}(i,j+1) - B_y^n(i,j+1)) - (B_y^{n+1}(i,j) - B_y^n(i,j)) \\right)\n$$\n使用更新方程，我们代入 $B_x$ 和 $B_y$ 的变化量：\n$B_x^{n+1}(i,j) - B_x^n(i,j) = - \\frac{\\Delta t}{\\Delta y} ( E_z(i, j+1) - E_z(i, j) )$\n$B_y^{n+1}(i,j) - B_y^n(i,j) = + \\frac{\\Delta t}{\\Delta x} ( E_z(i+1, j) - E_z(i, j) )$\n将这些代入散度变化的表达式中：\n\\begin{align*}\n\\Delta x \\Delta y (D^{n+1} - D^n) = \\Delta y \\left[ -\\frac{\\Delta t}{\\Delta y}(E_z(i+1, j+1) - E_z(i+1, j)) - \\left(-\\frac{\\Delta t}{\\Delta y}(E_z(i, j+1) - E_z(i, j))\\right) \\right] \\\\\n+ \\Delta x \\left[ \\frac{\\Delta t}{\\Delta x}(E_z(i+1, j+1) - E_z(i, j+1)) - \\left(\\frac{\\Delta t}{\\Delta x}(E_z(i+1, j) - E_z(i, j))\\right) \\right]\n\\end{align*}\n通过消去 $\\Delta x$ 和 $\\Delta y$ 并合并含 $\\Delta t$ 的项来简化：\n\\begin{align*}\n\\frac{\\Delta x \\Delta y}{\\Delta t} (D^{n+1} - D^n) = - (E_z(i+1, j+1) - E_z(i+1, j)) + (E_z(i, j+1) - E_z(i, j)) \\\\\n+ (E_z(i+1, j+1) - E_z(i, j+1)) - (E_z(i+1, j) - E_z(i, j))\n\\end{align*}\n展开各项：\n\\begin{align*}\n= -E_z(i+1, j+1) + E_z(i+1, j) + E_z(i, j+1) - E_z(i, j) \\\\\n+ E_z(i+1, j+1) - E_z(i, j+1) - E_z(i+1, j) + E_z(i, j)\n\\end{align*}\n右侧所有项相互抵消，结果为 $0$。\n因此，$D^{n+1}_{i+\\frac{1}{2},j+\\frac{1}{2}} - D^n_{i+\\frac{1}{2},j+\\frac{1}{2}} = 0$，这证明了 $D^{n+1} = D^n$。离散散度在每个时间步都精确保持（达到机器精度）。周期性边界条件确保了模板操作在区域边界处是良定义的。\n\n### 任务 B：边中心的电动势\n\n为了计算单元格角点 $(i\\Delta x, j\\Delta y)$ 处的 $E_z(i, j) = (v_y B_x - v_x B_y)|_{(i,j)}$，我们需要该位置的速度和磁场分量。问题指定了算术平均格式。\n\n1. 角点处的速度：速度分量 $(v_x, v_y)$ 存储在单元格中心 $((k+\\frac{1}{2})\\Delta x, (l+\\frac{1}{2})\\Delta y)$。角点 $(i,j)$ 被四个单元格中心所环绕，其索引为 $(i-1, j-1)$、$(i, j-1)$、$(i-1, j)$ 和 $(i, j)$。角点速度是这四个值的平均值：\n$$\nv_{x, \\text{corner}}(i, j) = \\frac{1}{4} \\left( v_x(i-1, j-1) + v_x(i, j-1) + v_x(i-1, j) + v_x(i, j) \\right)\n$$\n$$\nv_{y, \\text{corner}}(i, j) = \\frac{1}{4} \\left( v_y(i-1, j-1) + v_y(i, j-1) + v_y(i-1, j) + v_y(i, j) \\right)\n$$\n此处，索引采用周期性处理，例如，如果 $i=0$，则 $i-1$ 变为 $N_x-1$。\n\n2. 角点处的磁场：\n存储在面 $(i\\Delta x, (l+\\frac{1}{2})\\Delta y)$ 上的 $B_x$ 分量由角点 $(i,j)$ 上下两个相邻的面平均得到。这些面的索引为 $(i,j)$ 和 $(i, j-1)$：\n$$\nB_{x, \\text{corner}}(i, j) = \\frac{1}{2} \\left( B_x(i, j) + B_x(i, j-1) \\right)\n$$\n存储在面 $((k+\\frac{1}{2})\\Delta x, j\\Delta y)$ 上的 $B_y$ 分量由角点 $(i,j)$ 左右两个相邻的面平均得到。这些面的索引为 $(i,j)$ 和 $(i-1, j)$：\n$$\nB_{y, \\text{corner}}(i, j) = \\frac{1}{2} \\left( B_y(i, j) + B_y(i-1, j) \\right)\n$$\n\n3. 角点处的 $E_z$：将所有量插值到角点后，我们计算 $E_z$：\n$$\nE_z(i, j) = v_{y, \\text{corner}}(i, j) B_{x, \\text{corner}}(i, j) - v_{x, \\text{corner}}(i, j) B_{y, \\text{corner}}(i, j)\n$$\n\n由于平均模板的中心性质，该格式具有二阶精度。\n\n### 任务 C 和 D：实现与测试套件\n\n为提高效率，将使用 Python 中的 NumPy 实现向量化方法。\n\n1. 网格与参数设置：对每个测试案例，定义网格维度 $(N_x, N_y)$、区域大小 $(L_x, L_y)$，并计算网格间距 $(\\Delta x, \\Delta y)$ 和时间步长 $\\Delta t$。\n\n2. 场初始化：\n   - 为节点/角点 $(i\\Delta x, j\\Delta y)$ 和单元格中心 $((i+\\frac{1}{2})\\Delta x, (j+\\frac{1}{2})\\Delta y)$ 定义坐标网格。\n   - 初始化节点标量势 $A_z(i,j) = \\sin(2\\pi i\\Delta x/L_x)\\sin(2\\pi j\\Delta y/L_y)$。由于所有案例中 $L_x=L_y=1$，因此表达式为 $A_z(i,j) = \\sin(2\\pi i\\Delta x)\\sin(2\\pi j\\Delta y)$。\n   - 使用 $A_z$ 的离散旋度计算初始磁场分量 $B_x$ 和 $B_y$。采用周期性索引（例如，使用 `np.roll`），表达式为：\n     $B_x(i,j) = (A_z(i, j+1) - A_z(i, j)) / \\Delta y$\n     $B_y(i,j) = -(A_z(i+1, j) - A_z(i, j)) / \\Delta x$\n   - 根据每个案例提供的函数初始化单元格中心的速度场 $v_x$ 和 $v_y$。\n\n3. CT 时间步：\n   - 计算 $E_z$：使用向量化的 `np.roll` 操作实现任务 B 中的平均格式以处理周期性边界。然后同时计算所有角点上的 $E_z$。\n   - 更新 B：应用任务 A 中的向量化 CT 更新公式来求解 $B_x^{n+1}$ 和 $B_y^{n+1}$。\n   - 计算最终散度：在单元格中心网格上计算更新后磁场 $\\mathbf{B}^{n+1}$ 的离散散度，同样使用向量化的 `np.roll` 操作。\n   - 报告结果：找出计算出的散度网格的最大绝对值，即 `np.max(np.abs(divB))`。\n\n对三个测试案例中的每一个重复此过程，并收集最终结果，按规定格式化。所有案例的预期结果都是一个接近机器 epsilon（例如，对于双精度约为 $\\approx 10^{-16}$）的散度值，因为 CT 方法和 $A_z$ 初始化旨在精确保持无散度条件（在没有浮点舍入误差的情况下）。",
            "answer": "$$\n\\boxed{[2.1649348981420556e-15,0.0,3.885780586188048e-16]}\n$$"
        }
    ]
}