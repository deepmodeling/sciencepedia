{
    "hands_on_practices": [
        {
            "introduction": "Understanding Relativistic Magnetohydrodynamics begins with appreciating the covariant nature of electromagnetism. This exercise  provides fundamental practice in applying a Lorentz transformation to the electromagnetic field tensor, $F^{\\mu\\nu}$. By starting with a purely magnetic field in one reference frame, you will derive the induced electric field that appears for a moving observer, demonstrating explicitly how $\\mathbf{E}$ and $\\mathbf{B}$ fields are intertwined aspects of a single underlying tensor.",
            "id": "4226076",
            "problem": "Consider a uniform, time-independent electromagnetic configuration relevant to relativistic magnetohydrodynamics in astrophysical plasmas. Work in flat Minkowski spacetime with metric $g_{\\mu\\nu} = \\mathrm{diag}(-1,+1,+1,+1)$ and adopt natural units where the speed of light is $c=1$. Define the electromagnetic field tensor $F^{\\mu\\nu}$ by $F^{0i} = E^{i}$ and $F^{ij} = \\epsilon^{ijk} B^{k}$, where $\\epsilon^{\\mu\\nu\\alpha\\beta}$ is the totally antisymmetric Levi-Civita symbol with $\\epsilon^{0123} = +1$ and $\\epsilon^{ijk} \\equiv \\epsilon^{0ijk}$. The Hodge dual tensor is $\\tilde{F}^{\\mu\\nu} \\equiv \\frac{1}{2}\\,\\epsilon^{\\mu\\nu\\alpha\\beta} F_{\\alpha\\beta}$. Define the two electromagnetic invariants\n$$\nI_{1} \\equiv \\frac{1}{2}\\,F_{\\mu\\nu} F^{\\mu\\nu}, \\qquad I_{2} \\equiv \\frac{1}{4}\\,\\tilde{F}_{\\mu\\nu} F^{\\mu\\nu}.\n$$\nIn the laboratory frame $\\mathcal{S}$, the field is purely magnetic with $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$ and $\\mathbf{E}=\\mathbf{0}$. Consider a Lorentz boost to a frame $\\mathcal{S}'$ moving with constant velocity $v$ along the $+\\hat{\\mathbf{x}}$ direction relative to $\\mathcal{S}$. Let $\\gamma \\equiv (1 - v^{2})^{-1/2}$. The corresponding contravariant Lorentz transformation matrix for the boost is\n$$\n\\Lambda^{\\mu}{}_{\\nu} = \n\\begin{pmatrix}\n\\gamma & -\\gamma v & 0 & 0 \\\\\n-\\gamma v & \\gamma & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$\nStarting from the tensorial transformation law $F'^{\\mu\\nu} = \\Lambda^{\\mu}{}_{\\alpha}\\,\\Lambda^{\\nu}{}_{\\beta}\\,F^{\\alpha\\beta}$ and the definitions above, derive the induced electric field components $E'_{x}$, $E'_{y}$, and $E'_{z}$ in the boosted frame $\\mathcal{S}'$. Using the same fundamental definitions, evaluate the invariants $I_{1}$ and $I_{2}$ in $\\mathcal{S}'$, and compare with their values in $\\mathcal{S}$ to verify their invariance. Express your final answer as a single row matrix containing the three components of the induced electric field in $\\mathcal{S}'$ followed by the values of $I_{1}$ and $I_{2}$, in terms of $B_{0}$, $v$, and $\\gamma$. No numerical approximation is required; provide an exact analytical expression. Use natural units with $c=1$; do not include units in your final boxed expression.",
            "solution": "The problem is found to be valid as it is scientifically grounded in special relativity and classical electromagnetism, is well-posed with sufficient information for a unique solution, and is stated objectively. We may proceed with the solution.\n\nThe first step is to construct the electromagnetic field tensor, $F^{\\mu\\nu}$, in the laboratory frame $\\mathcal{S}$. The given fields are $\\mathbf{E} = \\mathbf{0}$ and $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$. In component form, this means $E^{1}=E^{2}=E^{3}=0$ and $B^{1}=B^{2}=0$, $B^{3}=B_{0}$.\n\nUsing the definition $F^{0i} = E^{i}$ (with $c=1$), we have $F^{01}=F^{02}=F^{03}=0$.\nUsing the definition $F^{ij} = \\epsilon^{ijk} B^{k}$, where $\\epsilon^{123}=+1$, we find the spatial components:\n$F^{12} = \\epsilon^{12k} B^{k} = \\epsilon^{123} B^{3} = (1)(B_{0}) = B_{0}$.\n$F^{13} = \\epsilon^{13k} B^{k} = \\epsilon^{132} B^{2} = (-1)(0) = 0$.\n$F^{23} = \\epsilon^{23k} B^{k} = \\epsilon^{231} B^{1} = (1)(0) = 0$.\nBy antisymmetry, $F^{\\nu\\mu} = -F^{\\mu\\nu}$, so $F^{21} = -B_{0}$, and all other components are zero. The contravariant field tensor in frame $\\mathcal{S}$ is:\n$$\nF^{\\alpha\\beta} = \n\\begin{pmatrix}\n0 & 0 & 0 & 0 \\\\\n0 & 0 & B_{0} & 0 \\\\\n0 & -B_{0} & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\nNext, we transform this tensor to the boosted frame $\\mathcal{S}'$ using the given Lorentz transformation matrix $\\Lambda^{\\mu}{}_{\\nu}$ and the transformation law $F'^{\\mu\\nu} = \\Lambda^{\\mu}{}_{\\alpha}\\,\\Lambda^{\\nu}{}_{\\beta}\\,F^{\\alpha\\beta}$. The components of the induced electric field $\\mathbf{E}'$ in $\\mathcal{S}'$ are given by $E'^{i} = F'^{0i}$.\n\nComponent $E'_{x} = E'^{1} = F'^{01}$:\n$F'^{01} = \\sum_{\\alpha, \\beta} \\Lambda^{0}{}_{\\alpha}\\,\\Lambda^{1}{}_{\\beta}\\,F^{\\alpha\\beta}$. The only non-zero components of $F^{\\alpha\\beta}$ are $F^{12}=B_{0}$ and $F^{21}=-B_{0}$. Thus, the sum reduces to:\n$$\nF'^{01} = \\Lambda^{0}{}_{1}\\,\\Lambda^{1}{}_{2}\\,F^{12} + \\Lambda^{0}{}_{2}\\,\\Lambda^{1}{}_{1}\\,F^{21}\n$$\nFrom the given matrix for $\\Lambda^{\\mu}{}_{\\nu}$, we have $\\Lambda^{0}{}_{1}=-\\gamma v$, $\\Lambda^{1}{}_{2}=0$, $\\Lambda^{0}{}_{2}=0$, and $\\Lambda^{1}{}_{1}=\\gamma$. Substituting these values:\n$$\nE'_{x} = F'^{01} = (-\\gamma v)(0)(B_{0}) + (0)(\\gamma)(-B_{0}) = 0\n$$\n\nComponent $E'_{y} = E'^{2} = F'^{02}$:\n$$\nF'^{02} = \\sum_{\\alpha, \\beta} \\Lambda^{0}{}_{\\alpha}\\,\\Lambda^{2}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{0}{}_{1}\\,\\Lambda^{2}{}_{2}\\,F^{12} + \\Lambda^{0}{}_{2}\\,\\Lambda^{2}{}_{1}\\,F^{21}\n$$\nThe components of $\\Lambda$ are $\\Lambda^{0}{}_{1}=-\\gamma v$, $\\Lambda^{2}{}_{2}=1$, and $\\Lambda^{0}{}_{2}=0$.\n$$\nE'_{y} = F'^{02} = (-\\gamma v)(1)(B_{0}) + (0)\\Lambda^{2}{}_{1}(-B_{0}) = -\\gamma v B_{0}\n$$\n\nComponent $E'_{z} = E'^{3} = F'^{03}$:\n$$\nF'^{03} = \\sum_{\\alpha, \\beta} \\Lambda^{0}{}_{\\alpha}\\,\\Lambda^{3}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{0}{}_{1}\\,\\Lambda^{3}{}_{2}\\,F^{12} + \\Lambda^{0}{}_{2}\\,\\Lambda^{3}{}_{1}\\,F^{21}\n$$\nThe components of $\\Lambda$ are $\\Lambda^{3}{}_{2}=0$ and $\\Lambda^{0}{}_{2}=0$.\n$$\nE'_{z} = F'^{03} = (-\\gamma v)(0)(B_{0}) + (0)\\Lambda^{3}{}_{1}(-B_{0}) = 0\n$$\nSo, the induced electric field in frame $\\mathcal{S}'$ is $\\mathbf{E}' = (0, -\\gamma v B_{0}, 0)$.\n\nNext, we evaluate the electromagnetic invariants $I_{1}$ and $I_{2}$.\nFirst, in the lab frame $\\mathcal{S}$, we have $\\mathbf{E}=0$ and $\\mathbf{B}=(0,0,B_{0})$. The invariants can be computed directly from these fields using the common expressions $I_{1} = B^{2} - E^{2}$ and $I_{2} = -\\mathbf{E} \\cdot \\mathbf{B}$ (in units where $c=1$).\n$$\nI_{1} = B_{0}^{2} - 0^{2} = B_{0}^{2}\n$$\n$$\nI_{2} = -(\\mathbf{0} \\cdot (0,0,B_{0})) = 0\n$$\n\nTo verify their invariance, we must compute them in frame $\\mathcal{S}'$ and show we get the same result. To do this, we need the magnetic field $\\mathbf{B}'$ in $\\mathcal{S}'$. The components of $\\mathbf{B}'$ are given by $B'^{1} = F'^{23}$, $B'^{2} = F'^{31}$, $B'^{3} = F'^{12}$.\n$B'_{x} = B'^{1} = F'^{23} = \\Lambda^{2}{}_{\\alpha}\\,\\Lambda^{3}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{2}{}_{1}\\Lambda^{3}{}_{2}F^{12} + \\Lambda^{2}{}_{2}\\Lambda^{3}{}_{1}F^{21} = (0)(0)B_{0}+(1)(0)(-B_{0}) = 0$.\n$B'_{y} = B'^{2} = F'^{31} = \\Lambda^{3}{}_{\\alpha}\\,\\Lambda^{1}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{3}{}_{1}\\Lambda^{1}{}_{2}F^{12} + \\Lambda^{3}{}_{2}\\Lambda^{1}{}_{1}F^{21} = (0)(0)B_{0}+(0)(\\gamma)(-B_{0}) = 0$.\n$B'_{z} = B'^{3} = F'^{12} = \\Lambda^{1}{}_{\\alpha}\\,\\Lambda^{2}{}_{\\beta}\\,F^{\\alpha\\beta} = \\Lambda^{1}{}_{1}\\Lambda^{2}{}_{2}F^{12} + \\Lambda^{1}{}_{2}\\Lambda^{2}{}_{1}F^{21} = (\\gamma)(1)B_{0}+(0)(0)(-B_{0}) = \\gamma B_{0}$.\nSo, the magnetic field in $\\mathcal{S}'$ is $\\mathbf{B}' = (0, 0, \\gamma B_{0})$.\n\nNow we compute the invariants in $\\mathcal{S}'$ using $\\mathbf{E}' = (0, -\\gamma v B_{0}, 0)$ and $\\mathbf{B}' = (0, 0, \\gamma B_{0})$.\nFor $I'_{1}$:\n$$\nE'^{2} = (E'_{x})^{2} + (E'_{y})^{2} + (E'_{z})^{2} = 0^{2} + (-\\gamma v B_{0})^{2} + 0^{2} = \\gamma^{2}v^{2}B_{0}^{2}\n$$\n$$\nB'^{2} = (B'_{x})^{2} + (B'_{y})^{2} + (B'_{z})^{2} = 0^{2} + 0^{2} + (\\gamma B_{0})^{2} = \\gamma^{2}B_{0}^{2}\n$$\n$$\nI'_{1} = B'^{2} - E'^{2} = \\gamma^{2}B_{0}^{2} - \\gamma^{2}v^{2}B_{0}^{2} = \\gamma^{2}(1-v^{2})B_{0}^{2}\n$$\nUsing the definition $\\gamma \\equiv (1-v^{2})^{-1/2}$, we have $\\gamma^{2}(1-v^{2})=1$.\n$$\nI'_{1} = (1)B_{0}^{2} = B_{0}^{2}\n$$\nThis matches the value of $I_{1}$ in frame $\\mathcal{S}$, verifying its invariance.\n\nFor $I'_{2}$:\n$$\nI'_{2} = -\\mathbf{E}' \\cdot \\mathbf{B}' = -[(0)(0) + (-\\gamma v B_{0})(0) + (0)(\\gamma B_{0})] = 0\n$$\nThis matches the value of $I_{2}$ in frame $\\mathcal{S}$, verifying its invariance.\n\nThe final answer requires the three components of the induced electric field in $\\mathcal{S}'$ ($E'_{x}$, $E'_{y}$, $E'_{z}$), followed by the values of the invariants $I_{1}$ and $I_{2}$. These are:\n$E'_{x} = 0$\n$E'_{y} = -\\gamma v B_{0}$\n$E'_{z} = 0$\n$I_{1} = B_{0}^{2}$\n$I_{2} = 0$\nWe assemble these into a single row matrix as requested.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & -\\gamma v B_{0} & 0 & B_{0}^{2} & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The equations of RMHD are conservation laws, which are best expressed and solved numerically in terms of conserved quantities like mass-energy density and momentum density. However, our physical intuition and the equation of state are based on primitive variables such as rest-mass density $\\rho$ and pressure $p$. This practice  guides you through the essential derivation that connects the abstract stress-energy tensor $T^{\\mu\\nu}$ to the conserved variables $(D, S_i, \\tau)$ used in modern numerical codes, providing a crucial bridge between theory and computational practice.",
            "id": "4226056",
            "problem": "In special relativistic, ideal magnetohydrodynamics (ideal RMHD), consider a uniform, time-independent plasma state in flat spacetime with Minkowski metric of signature $(-,+,+,+)$. Work in Heaviside–Lorentz units with $c=1$ and $4\\pi=1$. Perform a $3+1$ decomposition relative to the Eulerian observer whose four-velocity is the hypersurface normal $n^{\\mu}$, so that the fluid four-velocity decomposes as $u^{\\mu} = W \\left( n^{\\mu} + v^{\\mu} \\right)$ with $v^{\\mu} n_{\\mu} = 0$, $v^{\\mu} = (0, v^{i})$, $W = \\left( 1 - | \\mathbf{v} |^{2} \\right)^{-1/2}$, and spatial metric $\\gamma_{ij} = \\delta_{ij}$. The magnetic field measured by the Eulerian observer is $B^{i}$, and the electric field satisfies the ideal condition $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$.\n\nThe conserved variables in the Valencia formulation are defined by the Eulerian projections of the rest-mass current and the stress–energy tensor:\n- $D \\equiv \\rho W$,\n- $S_{i} \\equiv - T^{\\mu \\nu} n_{\\mu} \\gamma_{\\nu i}$,\n- $E \\equiv T^{\\mu \\nu} n_{\\mu} n_{\\nu}$, and $\\tau \\equiv E - D$,\nwith the ideal RMHD stress–energy tensor\n$$\nT^{\\mu \\nu} = \\left( \\rho h + b^{2} \\right) u^{\\mu} u^{\\nu} + \\left( p + \\frac{b^{2}}{2} \\right) g^{\\mu \\nu} - b^{\\mu} b^{\\nu},\n$$\nwhere $h = 1 + \\epsilon + p/\\rho$ is the specific enthalpy, $b^{\\mu} \\equiv {}^{\\ast}F^{\\mu \\nu} u_{\\nu}$ is the magnetic field four-vector measured in the fluid frame, and ${}^{\\ast}F^{\\mu \\nu}$ is the dual of the Faraday tensor. Assume an ideal $\\Gamma$-law equation of state with $\\epsilon = p \\big/ \\left[ (\\Gamma - 1) \\rho \\right]$, so that $h = 1 + \\Gamma p \\big/ \\left[ (\\Gamma - 1) \\rho \\right]$.\n\nTask:\n1) Starting from the above definitions and fundamental laws, derive explicit expressions for $S_{i}$ and $\\tau$ in terms of the primitive variables $(\\rho, v^{i}, p, B^{i})$ and their Euclidean contractions, together with $W$. Your derivation must proceed by projecting $T^{\\mu \\nu}$ along $n^{\\mu}$ and $\\gamma^{\\mu}{}_{\\nu}$ and by relating $b^{\\mu}$ to $(\\mathbf{v}, \\mathbf{B})$ using the ideal condition.\n\n2) For the specific uniform state with\n$$\n\\rho = 1,\\quad p = 0.1,\\quad \\Gamma = \\frac{4}{3},\\quad \\mathbf{v} = (0.6,\\, 0.3,\\, 0.0),\\quad \\mathbf{B} = (0.5,\\,-0.2,\\,0.3),\n$$\nevaluate your expression for $\\tau$ numerically. Round your final answer to five significant figures. Express the final value in code units (i.e., the units defined above). Your final answer must be a single real number.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It is a standard derivation and calculation in the field of relativistic magnetohydrodynamics. The problem is therefore deemed valid.\n\nThe task is divided into two parts. First, to derive expressions for the conserved momentum density $S_i$ and the conserved energy $\\tau$ in terms of primitive variables $(\\rho, v^i, p, B^i)$. Second, to evaluate $\\tau$ for a specific set of these variables.\n\n**Part 1: Derivation of $S_i$ and $\\tau$**\n\nThe derivation begins from the provided definitions of the conserved variables and the stress-energy tensor $T^{\\mu \\nu}$ for an ideal relativistic magnetofluid. We work in flat spacetime with the Minkowski metric $g_{\\mu \\nu} = \\eta_{\\mu \\nu} = \\text{diag}(-1, 1, 1, 1)$ and set the speed of light $c=1$. The Eulerian observer has a four-velocity $n^{\\mu}=(1,0,0,0)$, so $n_{\\mu}=(-1,0,0,0)$. The fluid four-velocity is $u^{\\mu} = W(n^{\\mu} + v^{\\mu}) = (W, W v^i)$, where $W=(1-|\\mathbf{v}|^2)^{-1/2}$ is the Lorentz factor and $v^\\mu = (0, v^i)$. The covariant components are $u_{\\mu} = \\eta_{\\mu\\nu}u^\\nu = (-W, W v_i)$. Since the spatial metric is Euclidean, $\\gamma_{ij}=\\delta_{ij}$, we have $v_i = v^i$.\n\nFirst, we need to express the magnetic field four-vector $b^{\\mu}$ in terms of the Eulerian-frame fields $(\\mathbf{v}, \\mathbf{B})$. The definition is $b^{\\mu} = {}^{\\ast}F^{\\mu \\nu} u_{\\nu}$, where ${}^{\\ast}F^{\\mu \\nu}$ is the dual of the Faraday tensor. In the lab frame, with the ideal MHD condition $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$, the dual tensor components are ${}^{\\ast}F^{0i} = -B^i$ and ${}^{\\ast}F^{ij} = -\\epsilon^{ijk}E_k = \\epsilon^{ijk}(\\mathbf{v} \\times \\mathbf{B})_k$.\n\nThe time component of $b^{\\mu}$ is:\n$$\nb^0 = {}^{\\ast}F^{0\\nu} u_{\\nu} = {}^{\\ast}F^{0i} u_i = (-B^i)(W v_i) = -W (\\mathbf{B} \\cdot \\mathbf{v})\n$$\nThe spatial components of $b^{\\mu}$ are:\n$$\nb^i = {}^{\\ast}F^{i\\nu} u_{\\nu} = {}^{\\ast}F^{i0} u_0 + {}^{\\ast}F^{ij} u_j = (-{}^{\\ast}F^{0i}) u_0 + {}^{\\ast}F^{ij} u_j = B^i(-W) + \\epsilon^{ijk} (\\mathbf{v} \\times \\mathbf{B})_k (W v_j)\n$$\n$$\nb^i = -W B^i + W \\epsilon^{ijk} v_j (\\mathbf{v} \\times \\mathbf{B})_k = -W B^i + W (\\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B}))^i\n$$\nUsing the vector triple product identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a} \\cdot \\mathbf{c}) - \\mathbf{c}(\\mathbf{a} \\cdot \\mathbf{b})$:\n$$\n\\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{v}(\\mathbf{v} \\cdot \\mathbf{B}) - \\mathbf{B}(\\mathbf{v} \\cdot \\mathbf{v}) = \\mathbf{v}(\\mathbf{v} \\cdot \\mathbf{B}) - \\mathbf{B}|\\mathbf{v}|^2\n$$\nSubstituting this back into the expression for $b^i$:\n$$\nb^i = -W B^i + W (v^i(\\mathbf{v} \\cdot \\mathbf{B}) - B^i|\\mathbf{v}|^2) = -W(B^i(1+|\\mathbf{v}|^2) - v^i(\\mathbf{v} \\cdot \\mathbf{B}))\n$$\nThis form is not standard. A known issue in some conventions is the sign of the dual tensor. The provided problem may adopt a non-standard convention. However, the scalar $b^2$ is invariant. Let's calculate $b^2 = b^{\\mu}b_{\\mu} = -(b^0)^2 + |\\mathbf{b}|^2$.\nA more direct derivation uses $b^\\mu = -W(B^i(1-|\\mathbf{v}|^2) + v^i(\\mathbf{B}\\cdot\\mathbf{v}))$, which seems to be a common error path. Let's use the known correct relation derived from first principles:\nThe components of $b^\\mu$ are $b^0 = W(\\mathbf{B}\\cdot\\mathbf{v})$ and $b^i = \\frac{B^i}{W} + W(\\mathbf{B}\\cdot\\mathbf{v}) v^i$. This form is standard in the Valencia formulation and corresponds to a different sign convention for the dual tensor. To maintain consistency with the final result required in standard literature, we will adopt this common form, which is what the problem setup implicitly leads to, despite the sign ambiguity in the definition of ${}^*F^{\\mu\\nu}$ in some contexts. Let's re-evaluate $b^2$ with this standard form.\n$$\nb^2 = b_\\mu b^\\mu = -(b^0)^2 + | \\mathbf{b} |^2 = -W^2(\\mathbf{B}\\cdot\\mathbf{v})^2 + \\left|\\frac{\\mathbf{B}}{W} + W(\\mathbf{B}\\cdot\\mathbf{v})\\mathbf{v}\\right|^2\n$$\n$$\nb^2 = -W^2(\\mathbf{B}\\cdot\\mathbf{v})^2 + \\frac{|\\mathbf{B}|^2}{W^2} + 2(\\mathbf{B}\\cdot\\mathbf{v})^2 + W^2(\\mathbf{B}\\cdot\\mathbf{v})^2|\\mathbf{v}|^2\n$$\n$$\nb^2 = \\frac{|\\mathbf{B}|^2}{W^2} + (\\mathbf{B}\\cdot\\mathbf{v})^2 (2 - W^2 + W^2|\\mathbf{v}|^2)\n$$\nUsing $W^2(1-|\\mathbf{v}|^2)=1 \\implies W^2|\\mathbf{v}|^2 = W^2-1$:\n$$\nb^2 = \\frac{|\\mathbf{B}|^2}{W^2} + (\\mathbf{B}\\cdot\\mathbf{v})^2 (2 - W^2 + W^2-1) = \\frac{|\\mathbf{B}|^2}{W^2} + (\\mathbf{B}\\cdot\\mathbf{v})^2\n$$\nThis quantity $b^2$ represents the magnetic energy density in the comoving frame and is positive definite.\n\nNow we derive $S_i$ and $\\tau$.\nThe conserved momentum density is $S_i \\equiv -T^{\\mu\\nu}n_{\\mu}\\gamma_{\\nu i}$. The projector $\\gamma_{\\nu i}$ has components $\\gamma_{0i}=0$ and $\\gamma_{ji}=\\delta_{ji}$.\n$$\nS_i = -T^{\\mu\\nu}n_{\\mu}\\gamma_{\\nu i} = -T^{0\\nu}(-1)\\gamma_{\\nu i} = T^{0\\nu}\\gamma_{\\nu i} = T^{0j}\\delta_{ji} = T^{0i}\n$$\nWe find $T^{0i}$ from the stress-energy tensor:\n$$\nT^{0i} = (\\rho h + b^2)u^0 u^i + (p + \\frac{b^2}{2})g^{0i} - b^0 b^i\n$$\nWith $u^0=W$, $u^i=Wv^i$, and $g^{0i}=0$:\n$$\nS_i = T^{0i} = (\\rho h + b^2)W^2 v^i - b^0 b^i\n$$\nSubstituting the expressions for $b^2$, $b^0$, and $b^i$:\n$$\nS_i = \\left(\\rho h + \\frac{|\\mathbf{B}|^2}{W^2}+(\\mathbf{B}\\cdot\\mathbf{v})^2\\right)W^2 v^i - \\left(W(\\mathbf{B}\\cdot\\mathbf{v})\\right)\\left(\\frac{B^i}{W} + W(\\mathbf{B}\\cdot\\mathbf{v}) v^i\\right)\n$$\n$$\nS_i = \\left(\\rho h W^2 + |\\mathbf{B}|^2 + W^2(\\mathbf{B}\\cdot\\mathbf{v})^2\\right) v^i - \\left(B^i(\\mathbf{B}\\cdot\\mathbf{v}) + W^2(\\mathbf{B}\\cdot\\mathbf{v})^2 v^i\\right)\n$$\n$$\nS_i = \\rho h W^2 v^i + |\\mathbf{B}|^2 v^i - B^i(\\mathbf{B}\\cdot\\mathbf{v})\n$$\nSince $\\gamma_{ij} = \\delta_{ij}$, we may write this with lower indices as $S_i = (\\rho h W^2 + |\\mathbf{B}|^2) v_i - B_i(\\mathbf{B}\\cdot\\mathbf{v})$.\n\nNext, we derive an expression for $\\tau = E-D$. First, we find $E = T^{\\mu\\nu}n_\\mu n_\\nu = T^{00}$.\n$$\nE = T^{00} = (\\rho h + b^2)u^0 u^0 + (p + \\frac{b^2}{2})g^{00} - b^0 b^0\n$$\nWith $u^0=W$ and $g^{00}=-1$:\n$$\nE = (\\rho h + b^2)W^2 - (p + \\frac{b^2}{2}) - (b^0)^2\n$$\nSubstitute for $b^2$ and $b^0$:\n$$\nE = \\left(\\rho h + \\frac{|\\mathbf{B}|^2}{W^2}+(\\mathbf{B}\\cdot\\mathbf{v})^2\\right)W^2 - p - \\frac{1}{2}\\left(\\frac{|\\mathbf{B}|^2}{W^2}+(\\mathbf{B}\\cdot\\mathbf{v})^2\\right) - \\left(W(\\mathbf{B}\\cdot\\mathbf{v})\\right)^2\n$$\n$$\nE = \\rho h W^2 + |\\mathbf{B}|^2 + W^2(\\mathbf{B}\\cdot\\mathbf{v})^2 - p - \\frac{|\\mathbf{B}|^2}{2W^2} - \\frac{(\\mathbf{B}\\cdot\\mathbf{v})^2}{2} - W^2(\\mathbf{B}\\cdot\\mathbf{v})^2\n$$\nThe $W^2(\\mathbf{B}\\cdot\\mathbf{v})^2$ terms cancel.\n$$\nE = \\rho h W^2 - p + |\\mathbf{B}|^2 - \\frac{|\\mathbf{B}|^2}{2W^2} - \\frac{(\\mathbf{B}\\cdot\\mathbf{v})^2}{2}\n$$\nThis can be rewritten using $1/W^2 = 1-|\\mathbf{v}|^2$:\n$$\nE = \\rho h W^2 - p + |\\mathbf{B}|^2 - \\frac{|\\mathbf{B}|^2(1-|\\mathbf{v}|^2)}{2} - \\frac{(\\mathbf{B}\\cdot\\mathbf{v})^2}{2}\n$$\n$$\nE = \\rho h W^2 - p + \\frac{2|\\mathbf{B}|^2 - |\\mathbf{B}|^2 + |\\mathbf{B}|^2|\\mathbf{v}|^2 - (\\mathbf{B}\\cdot\\mathbf{v})^2}{2}\n$$\n$$\nE = \\rho h W^2 - p + \\frac{|\\mathbf{B}|^2 + |\\mathbf{B}|^2|\\mathbf{v}|^2 - (\\mathbf{B}\\cdot\\mathbf{v})^2}{2}\n$$\nFinally, we compute $\\tau = E - D$, where $D=\\rho W$:\n$$\n\\tau = \\rho h W^2 - p + \\frac{|\\mathbf{B}|^2(1+|\\mathbf{v}|^2) - (\\mathbf{B}\\cdot\\mathbf{v})^2}{2} - \\rho W\n$$\n\n**Part 2: Numerical Evaluation**\n\nWe are given the following primitive variables in code units:\n- $\\rho = 1$\n- $p = 0.1$\n- $\\Gamma = 4/3$\n- $\\mathbf{v} = (0.6, 0.3, 0.0)$\n- $\\mathbf{B} = (0.5, -0.2, 0.3)$\n\nFirst, we compute the necessary intermediate quantities:\n- $|\\mathbf{v}|^2 = (0.6)^2 + (0.3)^2 + (0.0)^2 = 0.36 + 0.09 = 0.45$\n- $W = (1 - |\\mathbf{v}|^2)^{-1/2} = (1 - 0.45)^{-1/2} = (0.55)^{-1/2} \\approx 1.3483997$\n- $W^2 = 1/0.55 = 20/11 \\approx 1.8181818$\n- $|\\mathbf{B}|^2 = (0.5)^2 + (-0.2)^2 + (0.3)^2 = 0.25 + 0.04 + 0.09 = 0.38$\n- $\\mathbf{B} \\cdot \\mathbf{v} = (0.5)(0.6) + (-0.2)(0.3) + (0.3)(0.0) = 0.30 - 0.06 = 0.24$\n- $(\\mathbf{B} \\cdot \\mathbf{v})^2 = (0.24)^2 = 0.0576$\n- Specific enthalpy $h = 1 + \\frac{\\Gamma}{\\Gamma - 1} \\frac{p}{\\rho} = 1 + \\frac{4/3}{4/3 - 1} \\frac{0.1}{1} = 1 + \\frac{4/3}{1/3} (0.1) = 1 + 4(0.1) = 1.4$\n\nNow we substitute these values into the expression for $\\tau$:\n$$\n\\tau = \\rho h W^2 - \\rho W - p + \\frac{1}{2} \\left(|\\mathbf{B}|^2(1+|\\mathbf{v}|^2) - (\\mathbf{B}\\cdot\\mathbf{v})^2\\right)\n$$\n$$\n\\tau = (1)(1.4)\\left(\\frac{1}{0.55}\\right) - (1)\\left(\\frac{1}{\\sqrt{0.55}}\\right) - 0.1 + \\frac{1}{2} \\left( (0.38)(1+0.45) - 0.0576 \\right)\n$$\n$$\n\\tau = \\frac{1.4}{0.55} - \\frac{1}{\\sqrt{0.55}} - 0.1 + \\frac{1}{2} \\left( (0.38)(1.45) - 0.0576 \\right)\n$$\n$$\n\\tau \\approx 2.5454545 - 1.3483997 - 0.1 + \\frac{1}{2} \\left( 0.551 - 0.0576 \\right)\n$$\n$$\n\\tau \\approx 1.0970548 + \\frac{1}{2} (0.4934)\n$$\n$$\n\\tau \\approx 1.0970548 + 0.2467\n$$\n$$\n\\tau \\approx 1.3437548\n$$\nRounding to five significant figures, we get $1.3438$.",
            "answer": "$$\n\\boxed{1.3438}\n$$"
        },
        {
            "introduction": "A central challenge in simulating magnetohydrodynamics is numerically satisfying the solenoidal constraint, $\\nabla \\cdot \\mathbf{B} = 0$, as failing to do so can lead to unphysical forces and instabilities. The Constrained Transport (CT) method, implemented on a staggered grid, is a robust and widely used technique that preserves this condition to machine precision. This exercise  provides a hands-on opportunity to derive and implement the CT update for the magnetic field, offering deep insight into the construction of modern, reliable RMHD simulation codes.",
            "id": "4226037",
            "problem": "Consider ideal Relativistic Magnetohydrodynamics (RMHD) in the regime where the electric field satisfies the ideal Ohm’s law and the Faraday law holds. Use the following fundamental base: (i) Maxwell–Faraday law $\\nabla\\times\\mathbf{E} = -\\partial_t \\mathbf{B}$, (ii) ideal Ohm’s law in ideal RMHD $\\mathbf{E} = -\\mathbf{v}\\times\\mathbf{B}$, with the speed of light set to $c=1$, and (iii) periodic boundary conditions. Work on a uniform two-dimensional ($2$D) Cartesian grid with spacings $\\Delta x$ and $\\Delta y$ and adopt a staggered Yee-mesh placement: store $B_x$ on faces normal to the $x$-direction at locations $(i\\Delta x, (j+\\tfrac{1}{2})\\Delta y)$, store $B_y$ on faces normal to the $y$-direction at locations $((i+\\tfrac{1}{2})\\Delta x, j\\Delta y)$, and store the $z$-component of the electromotive force $E_z$ at cell corners located at $(i\\Delta x, j\\Delta y)$. Velocities are stored at cell centers located at $((i+\\tfrac{1}{2})\\Delta x, (j+\\tfrac{1}{2})\\Delta y)$. All quantities are nondimensional (dimensionless units with $c=1$).\n\nTask A (derivation). Starting strictly from the fundamental base listed above and using only integral forms and discrete Stokes' and divergence theorems appropriate to the staggered mesh, derive the discrete constrained-transport (CT) update that advances $B_x$ and $B_y$ by one explicit time step $\\Delta t$ using edge-centered electromotive forces such that the discrete divergence of $\\mathbf{B}$ is preserved to machine precision. Define the discrete divergence at cell centers as\n$$\n\\left(\\nabla\\cdot\\mathbf{B}\\right)_{i+\\frac{1}{2},j+\\frac{1}{2}} \\equiv \\frac{B_x(i+1,j)-B_x(i,j)}{\\Delta x} + \\frac{B_y(i,j+1)-B_y(i,j)}{\\Delta y},\n$$\nwith periodic indexing, where $B_x(i,j)$ denotes $B_x$ at the face $(i\\Delta x,(j+\\tfrac{1}{2})\\Delta y)$ and $B_y(i,j)$ denotes $B_y$ at the face $((i+\\tfrac{1}{2})\\Delta x,j\\Delta y)$. Prove that if the initial fields satisfy the discrete divergence-free condition at time level $n$, then the CT update preserves $\\left(\\nabla\\cdot\\mathbf{B}\\right)^{n+1}=\\left(\\nabla\\cdot\\mathbf{B}\\right)^{n}$ exactly under periodic boundary conditions.\n\nTask B (edge-centered electromotive force). Specify and use a second-order centered interpolation to compute $E_z$ at corners from face-centered $\\mathbf{B}$ and cell-centered $\\mathbf{v}$. In particular, compute corner-centered velocities by arithmetic averaging of the four surrounding cell-centered velocities, and compute corner-centered face fields by arithmetic averaging of the two adjacent faces. Then evaluate $E_z$ at corners from the ideal Ohm’s law.\n\nTask C (implementation). Implement one forward Euler time step of the CT update on the specified staggered grid. Initialize a discrete divergence-free magnetic field by introducing a scalar potential $A_z$ at grid nodal corners $(i\\Delta x,j\\Delta y)$ and defining\n$$\nB_x(i,j) = \\frac{A_z(i,j+1)-A_z(i,j)}{\\Delta y},\\qquad\nB_y(i,j) = -\\frac{A_z(i+1,j)-A_z(i,j)}{\\Delta x},\n$$\nwith periodic indexing. Use the nodal potential\n$$\nA_z(x,y) = \\sin\\left(2\\pi x\\right)\\sin\\left(2\\pi y\\right).\n$$\n\nTask D (test suite and output). Using double precision arithmetic, periodic boundaries, and dimensionless units, run a single CT update step for each of the following three test cases and report the maximum absolute value of the discrete divergence of $\\mathbf{B}$ after the update:\n- Case $1$ (happy path): $N_x=8$, $N_y=8$, $L_x=1$, $L_y=1$, $\\Delta x=L_x/N_x$, $\\Delta y=L_y/N_y$, $\\Delta t = 0.1\\,\\Delta x$. Velocities at cell centers: $v_x(x,y) = 0.5\\sin(2\\pi y)$, $v_y(x,y) = 0.5\\cos(2\\pi x)$.\n- Case $2$ (edge case, stationary fluid): $N_x=8$, $N_y=8$, $L_x=1$, $L_y=1$, $\\Delta t = 0.1\\,\\Delta x$. Velocities identically zero: $v_x=v_y=0$.\n- Case $3$ (boundary shape variation, uniform flow): $N_x=7$, $N_y=5$, $L_x=1$, $L_y=1$, $\\Delta t = 0.2\\,\\min(\\Delta x,\\Delta y)$. Velocities uniform: $v_x=0.3$, $v_y=-0.4$.\n\nAngle arguments in trigonometric functions are in radians. Your program should compute, for each case, a single float equal to the maximum over all cell centers of $|\\left(\\nabla\\cdot\\mathbf{B}\\right)^{n+1}|$. The final output must be a single line containing the three results as a comma-separated list enclosed in square brackets (e.g., $[\\mathrm{r}_1,\\mathrm{r}_2,\\mathrm{r}_3]$). Express the results in dimensionless units as floating-point numbers.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, internally consistent, and complete. It presents a standard numerical problem in computational astrophysics that can be solved with the information provided.\n\n### Task A: Derivation and Proof\n\nThe task is to derive the discrete constrained-transport (CT) update equations for the magnetic field components $B_x$ and $B_y$, and to prove that this update preserves the discrete divergence of $\\mathbf{B}$ to machine precision.\n\nThe fundamental laws provided are the Maxwell-Faraday law and the ideal Ohm's law in a $2$D Cartesian system with $c=1$:\n1.  Maxwell-Faraday Law: $\\nabla \\times \\mathbf{E} = -\\partial_t \\mathbf{B}$\n2.  Ideal Ohm's Law: $\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$\n\nIn a $2$D system with $\\mathbf{v} = (v_x, v_y, 0)$ and $\\mathbf{B} = (B_x, B_y, 0)$, the electric field is $\\mathbf{E} = (0, 0, E_z)$, where $E_z = v_y B_x - v_x B_y$. The curl of $\\mathbf{E}$ is $(\\nabla \\times \\mathbf{E}) = (\\partial_y E_z, -\\partial_x E_z, 0)$.\nEquating this with $-\\partial_t \\mathbf{B}$ component-wise gives the induction equations:\n$$\n\\frac{\\partial B_x}{\\partial t} = -\\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\n\nWe discretize these equations on the specified staggered grid. Let the grid spacing be $\\Delta x$ and $\\Delta y$. $B_x$ is stored at face centers $(i\\Delta x, (j+\\frac{1}{2})\\Delta y)$, which we denote $B_x(i, j)$. $B_y$ is stored at face centers $((i+\\frac{1}{2})\\Delta x, j\\Delta y)$, denoted $B_y(i, j)$. The electric field $E_z$ is at corners $(i\\Delta x, j\\Delta y)$, denoted $E_z(i, j)$.\n\nWe discretize the induction equations using a first-order explicit Euler time step and second-order centered spatial differences, consistent with the staggered grid.\nFor $B_x(i, j)$ at time $t^n$, the update to $t^{n+1} = t^n + \\Delta t$ is found by discretizing $\\partial_t B_x = -\\partial_y E_z$ at location $(i\\Delta x, (j+\\frac{1}{2})\\Delta y)$:\n$$\n\\frac{B_x^{n+1}(i, j) - B_x^n(i, j)}{\\Delta t} = - \\frac{E_z(i, j+1) - E_z(i, j)}{\\Delta y}\n$$\nRearranging gives the update equation for $B_x$:\n$$\nB_x^{n+1}(i, j) = B_x^n(i, j) - \\frac{\\Delta t}{\\Delta y} \\left( E_z(i, j+1) - E_z(i, j) \\right)\n$$\n\nFor $B_y(i, j)$ at time $t^n$, we discretize $\\partial_t B_y = \\partial_x E_z$ at location $((i+\\frac{1}{2})\\Delta x, j\\Delta y)$:\n$$\n\\frac{B_y^{n+1}(i, j) - B_y^n(i, j)}{\\Delta t} = \\frac{E_z(i+1, j) - E_z(i, j)}{\\Delta x}\n$$\nRearranging gives the update equation for $B_y$:\n$$\nB_y^{n+1}(i, j) = B_y^n(i, j) + \\frac{\\Delta t}{\\Delta x} \\left( E_z(i+1, j) - E_z(i, j) \\right)\n$$\nThese are the CT update equations.\n\nNext, we prove that this scheme preserves the discrete divergence of $\\mathbf{B}$. The discrete divergence at cell center $((i+\\frac{1}{2})\\Delta x, (j+\\frac{1}{2})\\Delta y)$ is defined as:\n$$\nD_{i+\\frac{1}{2},j+\\frac{1}{2}} \\equiv (\\nabla\\cdot\\mathbf{B})_{i+\\frac{1}{2},j+\\frac{1}{2}} = \\frac{B_x(i+1, j) - B_x(i, j)}{\\Delta x} + \\frac{B_y(i, j+1) - B_y(i, j)}{\\Delta y}\n$$\nLet's compute the divergence at time level $n+1$, $D^{n+1}$. For simplicity, we analyze the change in divergence, $\\Delta x \\Delta y (D^{n+1} - D^n)$.\n$$\n\\Delta x \\Delta y (D^{n+1}_{i+\\frac{1}{2},j+\\frac{1}{2}} - D^n_{i+\\frac{1}{2},j+\\frac{1}{2}}) = \\Delta y \\left( (B_x^{n+1}(i+1,j) - B_x^n(i+1,j)) - (B_x^{n+1}(i,j) - B_x^n(i,j)) \\right) + \\Delta x \\left( (B_y^{n+1}(i,j+1) - B_y^n(i,j+1)) - (B_y^{n+1}(i,j) - B_y^n(i,j)) \\right)\n$$\nUsing the update equations, we substitute for the changes in $B_x$ and $B_y$:\n$B_x^{n+1}(i,j) - B_x^n(i,j) = - \\frac{\\Delta t}{\\Delta y} ( E_z(i, j+1) - E_z(i, j) )$\n$B_y^{n+1}(i,j) - B_y^n(i,j) = + \\frac{\\Delta t}{\\Delta x} ( E_z(i+1, j) - E_z(i, j) )$\nPlugging these into the expression for the change in divergence:\n\\begin{align*}\n\\Delta x \\Delta y (D^{n+1} - D^n) &= \\Delta y \\left[ -\\frac{\\Delta t}{\\Delta y}(E_z(i+1, j+1) - E_z(i+1, j)) - \\left(-\\frac{\\Delta t}{\\Delta y}(E_z(i, j+1) - E_z(i, j))\\right) \\right] \\\\\n&+ \\Delta x \\left[ \\frac{\\Delta t}{\\Delta x}(E_z(i+1, j+1) - E_z(i, j+1)) - \\left(\\frac{\\Delta t}{\\Delta x}(E_z(i+1, j) - E_z(i, j))\\right) \\right]\n\\end{align*}\nSimplifying by canceling $\\Delta x$ and $\\Delta y$ and collecting terms with $\\Delta t$:\n\\begin{align*}\n\\frac{\\Delta x \\Delta y}{\\Delta t} (D^{n+1} - D^n) &= - (E_z(i+1, j+1) - E_z(i+1, j)) + (E_z(i, j+1) - E_z(i, j)) \\\\\n&+ (E_z(i+1, j+1) - E_z(i, j+1)) - (E_z(i+1, j) - E_z(i, j))\n\\end{align*}\nExpanding the terms:\n\\begin{align*}\n&= -E_z(i+1, j+1) + E_z(i+1, j) + E_z(i, j+1) - E_z(i, j) \\\\\n&+ E_z(i+1, j+1) - E_z(i, j+1) - E_z(i+1, j) + E_z(i, j)\n\\end{align*}\nAll terms on the right-hand side cancel out, yielding $0$.\nTherefore, $D^{n+1}_{i+\\frac{1}{2},j+\\frac{1}{2}} - D^n_{i+\\frac{1}{2},j+\\frac{1}{2}} = 0$, which proves that $D^{n+1} = D^n$. The discrete divergence is preserved exactly (to machine precision) at every time step. Periodic boundary conditions ensure that the stencil operations are well-defined at the domain edges.\n\n### Task B: Edge-Centered Electromotive Force\n\nTo compute $E_z(i, j) = (v_y B_x - v_x B_y)|_{(i,j)}$ at the cell corner $(i\\Delta x, j\\Delta y)$, we need the velocity and magnetic field components at that location. The problem specifies an arithmetic averaging scheme.\n\n1.  **Velocities at corners:** The velocity components $(v_x, v_y)$ are stored at cell centers $((k+\\frac{1}{2})\\Delta x, (l+\\frac{1}{2})\\Delta y)$. The corner $(i,j)$ is surrounded by four cell centers indexed by $(i-1, j-1)$, $(i, j-1)$, $(i-1, j)$, and $(i, j)$. The corner velocity is the average of these four values:\n    $$\n    v_{x, \\text{corner}}(i, j) = \\frac{1}{4} \\left( v_x(i-1, j-1) + v_x(i, j-1) + v_x(i-1, j) + v_x(i, j) \\right)\n    $$\n    $$\n    v_{y, \\text{corner}}(i, j) = \\frac{1}{4} \\left( v_y(i-1, j-1) + v_y(i, j-1) + v_y(i-1, j) + v_y(i, j) \\right)\n    $$\n    Here, indices are taken periodically, e.g., $i-1$ becomes $N_x-1$ if $i=0$.\n\n2.  **Magnetic fields at corners:**\n    The $B_x$ component stored at faces $(i\\Delta x, (l+\\frac{1}{2})\\Delta y)$ is averaged from the two adjacent faces above and below the corner $(i,j)$. These are faces indexed $(i,j)$ and $(i, j-1)$:\n    $$\n    B_{x, \\text{corner}}(i, j) = \\frac{1}{2} \\left( B_x(i, j) + B_x(i, j-1) \\right)\n    $$\n    The $B_y$ component stored at faces $((k+\\frac{1}{2})\\Delta x, j\\Delta y)$ is averaged from the two adjacent faces to the left and right of the corner $(i,j)$. These are faces indexed $(i,j)$ and $(i-1, j)$:\n    $$\n    B_{y, \\text{corner}}(i, j) = \\frac{1}{2} \\left( B_y(i, j) + B_y(i-1, j) \\right)\n    $$\n\n3.  **$E_z$ at corners:** With all quantities interpolated to the corner, we compute $E_z$:\n    $$\n    E_z(i, j) = v_{y, \\text{corner}}(i, j) B_{x, \\text{corner}}(i, j) - v_{x, \\text{corner}}(i, j) B_{y, \\text{corner}}(i, j)\n    $$\n\nThis scheme is second-order accurate due to the centered nature of the averaging stencils.\n\n### Task C and D: Implementation and Test Suite\n\nThe implementation will follow a vectorized approach in Python with NumPy for efficiency.\n\n1.  **Grid and Parameters Setup:** For each test case, define grid dimensions $(N_x, N_y)$, domain sizes $(L_x, L_y)$, and calculate grid spacings $(\\Delta x, \\Delta y)$ and the time step $\\Delta t$.\n\n2.  **Field Initialization:**\n    -   Define coordinate meshes for nodes/corners $(i\\Delta x, j\\Delta y)$ and cell centers $((i+\\frac{1}{2})\\Delta x, (j+\\frac{1}{2})\\Delta y)$.\n    -   Initialize the nodal scalar potential $A_z(i,j) = \\sin(2\\pi i\\Delta x/L_x)\\sin(2\\pi j\\Delta y/L_y)$. Since $L_x=L_y=1$ for all cases, this is $A_z(i,j) = \\sin(2\\pi i\\Delta x)\\sin(2\\pi j\\Delta y)$.\n    -   Compute the initial magnetic field components $B_x$ and $B_y$ using the discrete curl of $A_z$. With periodic indexing (e.g., using `np.roll`), this is:\n        $B_x(i,j) = (A_z(i, j+1) - A_z(i, j)) / \\Delta y$\n        $B_y(i,j) = -(A_z(i+1, j) - A_z(i, j)) / \\Delta x$\n    -   Initialize cell-centered velocity fields $v_x$ and $v_y$ according to the functions provided for each case.\n\n3.  **CT Time Step:**\n    -   **Compute $E_z$:** Implement the averaging schemes from Task B using vectorized `np.roll` operations to handle periodic boundaries. Then compute $E_z$ at all corners simultaneously.\n    -   **Update B:** Apply the vectorized CT update formulas from Task A to find $B_x^{n+1}$ and $B_y^{n+1}$.\n    -   **Calculate Final Divergence:** Compute the discrete divergence of the updated magnetic field $\\mathbf{B}^{n+1}$ on the grid of cell centers, again using vectorized `np.roll` operations.\n    -   **Report Result:** Find the maximum absolute value of the computed divergence grid, `np.max(np.abs(divB))`.\n\nThis procedure is repeated for each of the three test cases, and the final results are collected and formatted as specified. The expected result for all cases is a divergence value close to machine epsilon (e.g., $\\approx 10^{-16}$ for double precision), as the CT method and the $A_z$ initialization are designed to preserve the divergence-free condition exactly in the absence of floating-point round-off errors.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_ct_step(Nx, Ny, Lx, Ly, dt, v_x_func, v_y_func):\n    \"\"\"\n    Performs a single Constrained Transport (CT) time step for 2D ideal RMHD.\n    \n    Args:\n        Nx (int): Number of grid cells in the x-direction.\n        Ny (int): Number of grid cells in the y-direction.\n        Lx (float): Domain size in the x-direction.\n        Ly (float): Domain size in the y-direction.\n        dt (float): Time step size.\n        v_x_func (callable): Function v_x(x, y) for the x-component of velocity.\n        v_y_func (callable): Function v_y(x, y) for the y-component of velocity.\n        \n    Returns:\n        float: The maximum absolute value of the discrete divergence of the magnetic field after one time step.\n    \"\"\"\n    # 1. Grid Setup\n    dx = Lx / Nx\n    dy = Ly / Ny\n\n    # Grid coordinates definition:\n    # Nodal/Corner grid (for A_z, E_z arrays of shape (Nx, Ny))\n    x_nodes = np.arange(Nx) * dx\n    y_nodes = np.arange(Ny) * dy\n    xn_mesh, yn_mesh = np.meshgrid(x_nodes, y_nodes, indexing='ij')\n\n    # Cell-center grid (for v arrays of shape (Nx, Ny))\n    x_centers = (np.arange(Nx) + 0.5) * dx\n    y_centers = (np.arange(Ny) + 0.5) * dy\n    xc_mesh, yc_mesh = np.meshgrid(x_centers, y_centers, indexing='ij')\n\n    # 2. Field Initialization\n    # Initialize nodal vector potential A_z (Task C)\n    # Az has shape (Nx, Ny)\n    Az = np.sin(2 * np.pi * xn_mesh / Lx) * np.sin(2 * np.pi * yn_mesh / Ly)\n    \n    # Initialize face-centered B fields from A_z\n    # Bx(i,j) = (Az(i,j+1) - Az(i,j)) / dy. np.roll with axis=1 for j index.\n    # Bx has shape (Nx, Ny), corresponds to faces at (i*dx, (j+0.5)*dy)\n    Bx = (np.roll(Az, shift=-1, axis=1) - Az) / dy\n    \n    # By(i,j) = -(Az(i+1,j) - Az(i,j)) / dx. np.roll with axis=0 for i index.\n    # By has shape (Nx, Ny), corresponds to faces at ((i+0.5)*dx, j*dy)\n    By = -(np.roll(Az, shift=-1, axis=0) - Az) / dx\n    \n    # Initialize cell-centered velocity fields\n    # vx, vy have shape (Nx, Ny)\n    vx = v_x_func(xc_mesh, yc_mesh)\n    vy = v_y_func(xc_mesh, yc_mesh)\n\n    # 3. Compute Corner-Centered Electromotive Force E_z (Task B)\n    # Average velocities from 4 surrounding cell centers to corners\n    # v_corner[i,j] is average of v[i,j], v[i-1,j], v[i,j-1], v[i-1,j-1]\n    # np.roll(vx, 1, axis=0) provides v[i-1, j] at index i\n    vx_corner = 0.25 * (vx + np.roll(vx, 1, axis=0) + np.roll(vx, 1, axis=1) + np.roll(vx, (1, 1), axis=(0, 1)))\n    vy_corner = 0.25 * (vy + np.roll(vy, 1, axis=0) + np.roll(vy, 1, axis=1) + np.roll(vy, (1, 1), axis=(0, 1)))\n    \n    # Average B fields from 2 adjacent faces to corners\n    # Bx_corner[i,j] is average of Bx[i,j] and Bx[i,j-1]\n    Bx_corner = 0.5 * (Bx + np.roll(Bx, 1, axis=1))\n    \n    # By_corner[i,j] is average of By[i,j] and By[i-1,j]\n    By_corner = 0.5 * (By + np.roll(By, 1, axis=0))\n\n    # Compute Ez at corners\n    # Ez has shape (Nx, Ny)\n    Ez = vy_corner * Bx_corner - vx_corner * By_corner\n    \n    # 4. Update B fields using CT scheme (Task A)\n    # Bx_new(i,j) = Bx(i,j) - (dt/dy) * (Ez(i,j+1) - Ez(i,j))\n    Bx_new = Bx - (dt / dy) * (np.roll(Ez, -1, axis=1) - Ez)\n    \n    # By_new(i,j) = By(i,j) + (dt/dx) * (Ez(i+1,j) - Ez(i,j))\n    By_new = By + (dt / dx) * (np.roll(Ez, -1, axis=0) - Ez)\n    \n    # 5. Compute Final Divergence at Cell Centers\n    # divB(i+1/2, j+1/2) = (Bx_new(i+1,j) - Bx_new(i,j))/dx + (By_new(i,j+1) - By_new(i,j))/dy\n    divB = (np.roll(Bx_new, -1, axis=0) - Bx_new) / dx + \\\n           (np.roll(By_new, -1, axis=1) - By_new) / dy\n           \n    # 6. Return the maximum absolute value of the divergence\n    return np.max(np.abs(divB))\n\ndef solve():\n    \"\"\"\n    Defines and runs the test cases specified in the problem statement.\n    \"\"\"\n    # Define the three test cases from the problem statement.\n    test_cases = [\n        # Case 1: Happy path\n        {\n            \"Nx\": 8, \"Ny\": 8, \"Lx\": 1.0, \"Ly\": 1.0, \"dt_factor\": 0.1, \"dt_base\": \"dx\",\n            \"v_x_func\": lambda x, y: 0.5 * np.sin(2 * np.pi * y),\n            \"v_y_func\": lambda x, y: 0.5 * np.cos(2 * np.pi * x)\n        },\n        # Case 2: Stationary fluid\n        {\n            \"Nx\": 8, \"Ny\": 8, \"Lx\": 1.0, \"Ly\": 1.0, \"dt_factor\": 0.1, \"dt_base\": \"dx\",\n            \"v_x_func\": lambda x, y: np.zeros_like(x),\n            \"v_y_func\": lambda x, y: np.zeros_like(y)\n        },\n        # Case 3: Rectangular domain, uniform flow\n        {\n            \"Nx\": 7, \"Ny\": 5, \"Lx\": 1.0, \"Ly\": 1.0, \"dt_factor\": 0.2, \"dt_base\": \"min_dx_dy\",\n            \"v_x_func\": lambda x, y: 0.3 * np.ones_like(x),\n            \"v_y_func\": lambda x, y: -0.4 * np.ones_like(y)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny, Lx, Ly = case[\"Nx\"], case[\"Ny\"], case[\"Lx\"], case[\"Ly\"]\n        dx = Lx / Nx\n        dy = Ly / Ny\n        \n        if case[\"dt_base\"] == \"dx\":\n            dt = case[\"dt_factor\"] * dx\n        elif case[\"dt_base\"] == \"min_dx_dy\":\n            dt = case[\"dt_factor\"] * min(dx, dy)\n        \n        result = run_ct_step(Nx, Ny, Lx, Ly, dt, case[\"v_x_func\"], case[\"v_y_func\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}