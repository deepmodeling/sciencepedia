{
    "hands_on_practices": [
        {
            "introduction": "粒子-网格（PIC）模拟的一个核心要素是粒子与网格之间的信息交换。本练习聚焦于将粒子电荷分配到网格节点上最常用的方法之一。云中粒子（CIC）或一阶权重方案通过减少与更简单方案（如最近邻网格点法）相关的高频噪声，在计算成本和准确性之间取得了良好的平衡。通过这项实践 ()，你将掌握如何将连续的粒子相空间映射到离散的网格上，这是构建求解麦克斯韦方程组所需电荷密度 $\\rho$ 的基础步骤。",
            "id": "4222896",
            "problem": "考虑一个天体物理对等离子体的一维静电粒子模拟（PIC），该模拟在均匀网格上进行，网格中心位于 $x_i = i\\,\\Delta x$ 位置，其中 $\\Delta x$ 是网格间距， $i$ 是整数。一个电荷为 $q$ 的粒子严格位于两个相邻的网格中心 $x_i$（左）和 $x_{i+1}$（右）之间。设粒子的局域坐标（从左侧网格中心算起）为 $x \\in [0, \\Delta x]$，因此其绝对位置为 $x_p = x_i + x$，与右侧中心的距离为 $\\Delta x - x$。\n\n在云中网格（CIC）电荷分配方案中，分配到网格点的电荷由最近网格点（NGP）形函数与自身的卷积决定。NGP 形函数 $S_0(x)$ 定义为：当 $|x| \\le \\Delta x/2$ 时，$S_0(x) = 1$；否则 $S_0(x) = 0$。CIC 形函数 $S_1(x)$ 定义为卷积 $S_1 = S_0 * S_0$，并经过适当归一化，使得 $S_1(x)$ 的紧支撑宽度为 $2\\,\\Delta x$，并且与分配到网格的电荷守恒一致。\n\n从这些定义以及电荷分配过程中的局域电荷守恒要求（即，对于位于两个网格中心之间的粒子，分配到左侧和右侧中心的权重之和等于 $1$）出发，推导分配给左侧和右侧网格中心的云中网格权重 $w_L$ 和 $w_R$，将其表示为局域坐标 $x$ 和网格间距 $\\Delta x$ 的函数。然后，将分配到左侧和右侧中心的电荷 $Q_L$ 和 $Q_R$ 分别用 $q$、$x$ 和 $\\Delta x$ 表示。\n\n将你的最终答案表示为一个包含 $\\{w_L, w_R, Q_L, Q_R\\}$ 四个量的闭合形式单行矩阵。不需要进行数值计算。",
            "solution": "首先将根据既定标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：天体物理对等离子体的一维静电粒子模拟（PIC）。\n- **网格**：一个均匀网格，网格中心位于 $x_i = i\\,\\Delta x$ 位置，其中 $\\Delta x$ 是网格间距，$i$ 是整数。\n- **粒子**：一个电荷为 $q$ 的单个粒子。\n- **粒子位置**：粒子位于绝对位置 $x_p = x_i + x$，其中 $x_i$ 是左侧网格中心的位置，$x_{i+1}$ 是右侧网格中心的位置，$x$ 是从左侧网格中心测量的局域坐标，且 $x \\in [0, \\Delta x]$。\n- **最近网格点 (NGP) 形函数**：$S_0(x)$ 定义为：当 $|x| \\le \\Delta x/2$ 时，$S_0(x) = 1$；否则 $S_0(x) = 0$。\n- **云中网格 (CIC) 形函数**：$S_1(x)$ 定义为卷积 $S_1 = S_0 * S_0$，并经过适当归一化。\n- **约束条件**：局域电荷守恒要求分配到左侧和右侧网格中心的权重之和为1：$w_L + w_R = 1$。\n- **目标**：推导左侧和右侧网格中心的CIC权重 $w_L$ 和 $w_R$，以及相应的分配电荷 $Q_L$ 和 $Q_R$，并将它们表示为 $q$、$x$ 和 $\\Delta x$ 的函数。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了云中网格（CIC）或一阶电荷分配方案，这是计算等离子体物理和天体物理学中的一项基本且标准的技术，尤其是在PIC模拟中。将CIC形函数定义为两个NGP（零阶）形函数的卷积是标准的教科书内容。该问题牢固地建立在计算物理学的既定原理之上。\n- **适定性**：问题陈述清晰，提供了所有必要的定义和约束条件。形函数的定义和守恒约束导致了权重和分配电荷的唯一且有意义的解。\n- **客观性**：问题以精确、正式且无偏见的科学语言陈述。\n- **其他缺陷**：该问题在科学上不是不健全、不完整、矛盾或不适定的。它是指定领域中的一个标准推导问题。\n\n### 步驟3：結論與行動\n该问题被认定为 **有效**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n云中网格（CIC）方案，也称为一阶方案（$p=1$），使用一个形函数 $S_1(y)$，该函数可以通过最近网格点（NGP）或零阶形函数 $S_0(y)$ 与自身的卷积来推导。NGP形函数是一个以原点为中心的矩形函数或“顶帽”函数：\n$$\nS_0(y) = \n\\begin{cases} \n1  \\text{if } |y| \\le \\frac{\\Delta x}{2} \\\\\n0  \\text{if } |y|  \\frac{\\Delta x}{2}\n\\end{cases}\n$$\n为获得未归一化的CIC形函数（我们记作 $S_{1,u}(y)$）的卷积由下式给出：\n$$\nS_{1,u}(y) = (S_0 * S_0)(y) = \\int_{-\\infty}^{\\infty} S_0(z) S_0(y-z) dz\n$$\n仅当 $S_0(z)$ 和 $S_0(y-z)$ 都非零时，被积函数才非零。这要求 $|z| \\le \\frac{\\Delta x}{2}$ 和 $|y-z| \\le \\frac{\\Delta x}{2}$。第二个条件等价于 $y - \\frac{\\Delta x}{2} \\le z \\le y + \\frac{\\Delta x}{2}$。因此，只有当 $z$ 在区间 $[-\\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$ 和 $[y - \\frac{\\Delta x}{2}, y + \\frac{\\Delta x}{2}]$ 的交集中时，积分才非零。积分的值是该交集区域的长度。\n\n我们分析 $y$ 在不同范围内的重叠情况：\n1.  对于 $|y| \\ge \\Delta x$，两个区间没有重叠。因此，$S_{1,u}(y) = 0$。\n2.  对于 $0 \\le y \\le \\Delta x$，$z$ 的交集区间是 $[y - \\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$。该区间的长度为 $\\frac{\\Delta x}{2} - (y - \\frac{\\Delta x}{2}) = \\Delta x - y$。所以，$S_{1,u}(y) = \\Delta x - y$。\n3.  对于 $-\\Delta x \\le y  0$，$z$ 的交集区间是 $[-\\frac{\\Delta x}{2}, y + \\frac{\\Delta x}{2}]$。该区间的长度为 $(y + \\frac{\\Delta x}{2}) - (-\\frac{\\Delta x}{2}) = y + \\Delta x$。所以，$S_{1,u}(y) = y + \\Delta x$。\n\n结合这些结果，我们可以将未归一化的CIC形函数写成一个单一表达式：\n$$\nS_{1,u}(y) = \n\\begin{cases} \n\\Delta x - |y|  \\text{if } |y| \\le \\Delta x \\\\\n0  \\text{if } |y|  \\Delta x\n\\end{cases}\n$$\n这是一个在 $[- \\Delta x, \\Delta x]$ 上有支撑的三角函数，基底宽度为 $2\\Delta x$，在 $y=0$ 处有峰值 $\\Delta x$。\n\n对于电荷守恒的分配方案，形函数必须满足单位分解性质，即其在粒子位置处（相对于所有相互作用的网格点）的值之和必须等于 $1$。一个位于位置 $x_p = x_i + x$（其中 $x \\in [0, \\Delta x]$）的粒子仅与网格点 $x_i$ 和 $x_{i+1}$ 相互作用。未归一化形函数之和为：\n$$\nS_{1,u}(x_p - x_i) + S_{1,u}(x_p - x_{i+1}) = S_{1,u}(x) + S_{1,u}(x - \\Delta x)\n$$\n使用我们推导出的 $S_{1,u}(y)$ 表达式：\n- 由于 $x \\in [0, \\Delta x]$，我们有 $S_{1,u}(x) = \\Delta x - x$。\n- 由于 $x - \\Delta x \\in [-\\Delta x, 0]$，我们有 $S_{1,u}(x - \\Delta x) = (x - \\Delta x) + \\Delta x = x$。\n总和为 $(\\Delta x - x) + x = \\Delta x$。为满足单位分解，我们必须将形函数除以这个总和 $\\Delta x$ 来进行归一化。归一化后的CIC形函数，我们称之为 $W(y)$，是：\n$$\nW(y) = \\frac{S_{1,u}(y)}{\\Delta x} = \n\\begin{cases} \n1 - \\frac{|y|}{\\Delta x}  \\text{if } |y| \\le \\Delta x \\\\\n0  \\text{if } |y|  \\Delta x\n\\end{cases}\n$$\n权重 $w_L$ 和 $w_R$ 分别是这个归一化形函数在粒子相对于左侧和右侧网格中心的位置处的值。\n\n粒子位于绝对位置 $x_p = x_i + x$，其中 $x \\in [0, \\Delta x]$ 是相对于左侧网格中心 $x_i$ 的局域坐标。\n分配给左侧网格中心 $x_i$ 的权重是 $w_L$：\n$$\nw_L = W(x_p - x_i) = W(x)\n$$\n由于 $x \\ge 0$，所以 $|x| = x$。因此，\n$$\nw_L = 1 - \\frac{x}{\\Delta x}\n$$\n分配给右侧网格中心 $x_{i+1} = x_i + \\Delta x$ 的权重是 $w_R$：\n$$\nw_R = W(x_p - x_{i+1}) = W(x - \\Delta x)\n$$\n由于 $x \\in [0, \\Delta x]$，自变量 $y = x - \\Delta x$ 在范围 $[-\\Delta x, 0]$ 内。因此，$|y| = |x - \\Delta x| = -(x - \\Delta x) = \\Delta x - x$。因此，\n$$\nw_R = 1 - \\frac{|x-\\Delta x|}{\\Delta x} = 1 - \\frac{\\Delta x - x}{\\Delta x} = 1 - \\left(1 - \\frac{x}{\\Delta x}\\right) = \\frac{x}{\\Delta x}\n$$\n我们可以验证电荷守恒约束：$w_L + w_R = (1 - \\frac{x}{\\Delta x}) + \\frac{x}{\\Delta x} = 1$。这是一致的。\n\n分配到左侧和右侧网格中心的电荷 $Q_L$ 和 $Q_R$ 是粒子的电荷 $q$ 乘以各自的权重：\n分配到左侧中心 $x_i$ 的电荷是：\n$$\nQ_L = q \\cdot w_L = q \\left(1 - \\frac{x}{\\Delta x}\\right)\n$$\n分配到右侧中心 $x_{i+1}$ 的电荷是：\n$$\nQ_R = q \\cdot w_R = q \\frac{x}{\\Delta x}\n$$\n最终答案要求将这四个量——$w_L$、$w_R$、$Q_L$、$Q_R$——放在一个单行矩阵中。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 - \\frac{x}{\\Delta x}  \\frac{x}{\\Delta x}  q \\left(1 - \\frac{x}{\\Delta x}\\right)  q \\frac{x}{\\Delta x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在我们了解了如何分配电荷之后，一个自然而然的问题是：需要多少粒子才能准确地表示等离子体？本练习将深入探讨PIC模拟的统计特性。用有限数量的宏粒子来表示连续的流体，会不可避免地引入粒子噪声，这是PIC方法的一个内在特征。通过运用中心极限定理，我们可以估算沉积在网格上的电荷密度的涨落，从而理解噪声的来源和大小。完成此项实践 () 后，你将对计算成本（粒子数 $N_p$）与模拟保真度之间的权衡关系有定量的理解，并学会如何选择 $N_p$ 以达到预设的精度目标 $\\epsilon$。",
            "id": "4222907",
            "problem": "考虑一个一维、静电、无碰撞的均匀等离子体，其平均电荷密度为 $\\rho_{0}$，使用质点网格 (Particle-In-Cell, PIC) 方法进行解析。空间网格具有均匀间距 $\\Delta x$，每个网格单元初始包含 $N_{p}$ 个相同的宏粒子，每个宏粒子携带的电荷为 $q_{p}$，其选择方式使得每个网格单元的平均电荷等于 $\\rho_{0} \\Delta x$。PIC 的电荷分配使用一阶 B 样条（cloud-in-cell）形状函数，该函数根据粒子在相邻网格单元中的位置，将粒子电荷的线性加权部分分配给任意网格节点。假设每个网格单元内宏粒子的瞬时位置是独立的，并且在网格单元上均匀分布。\n\n我们关注位于两个相邻网格单元交界处的一个网格节点。在给定的时间步长，分配给该节点的总电荷是来自两个相邻网格单元中 $2 N_{p}$ 个粒子的贡献之和，每个贡献都通过 cloud-in-cell 规则根据粒子的位置计算得出。利用中心极限定理和粒子位置的独立性，推导由于粒子噪声引起的节点上沉积电荷的分数均方根误差（标准差除以平均值），并通过强制要求此分数误差不超过一个预设目标 $\\epsilon$，求出所需的每个网格单元最少粒子数 $N_{p}$ 的精确解析表达式。\n\n请用含 $\\epsilon$ 的单个封闭形式表达式来表示你的最终答案。不需要进行数值近似。如果在中间步骤中出现任何物理单位，请确保它们能够相消，从而使最终表达式为无量纲。不要引入任何未从 PIC 电荷分配、独立均匀样本概率和中心极限定理等第一性原理推导出的简化公式。",
            "solution": "该问题要求推导每个网格单元所需的最少粒子数 $N_p$，以使沉积在网格节点上的电荷的分数均方根 (RMS) 误差低于某一阈值 $\\epsilon$。推导必须基于质点网格 (PIC) 方法的第一性原理，特别是 cloud-in-cell (CIC) 电荷分配方案，以及使用中心极限定理的统计分析。\n\n设一维网格的节点位于位置 $x_j = j \\Delta x$，其中 $j$ 是整数，$\\Delta x$ 是均匀的网格间距。我们关注单个网格节点，在不失一般性的前提下，可将其置于原点 $x_j=0$。此节点位于两个相邻网格单元的交界处：左侧单元 L 覆盖区间 $[-\\Delta x, 0]$，右侧单元 R 覆盖区间 $[0, \\Delta x]$。每个单元包含 $N_p$ 个宏粒子。因此，来自这两个单元的总共 $2N_p$ 个粒子可以为 $x_j=0$ 处的节点贡献电荷。\n\n电荷分配使用一阶 B 样条，或称 cloud-in-cell (CIC) 形状函数 $S(u)$。对于位于位置 $x_p$ 的粒子和位于 $x_j$ 的网格节点，分配给该节点的粒子电荷的分数由 $S(x_p - x_j)$ 给出。函数 $S(u)$ 是一个三角形函数，定义如下：\n$$\nS(u) =\n\\begin{cases}\n    1 - \\frac{|u|}{\\Delta x}  \\text{if } |u| \\leq \\Delta x \\\\\n    0  \\text{if } |u|  \\Delta x\n\\end{cases}\n$$\n位于位置 $x_k$、带有电荷 $q_p$ 的单个粒子 $k$ 在节点 $x_j$ 上沉积的电荷为 $Q_k = q_p S(x_k - x_j)$。\n\n问题陈述，粒子的瞬时位置在其各自的网格单元内是独立的且均匀分布的。我们来分析单个粒子对 $x_j=0$ 处节点的电荷贡献。\n\n考虑右侧单元 R 中的一个粒子，其位置 $x$ 是在 $[0, \\Delta x]$ 上均匀分布的随机变量。其概率密度函数为 $p(x) = 1/\\Delta x$，$x \\in [0, \\Delta x]$。该粒子对 $x_j=0$ 处节点贡献的电荷是一个随机变量 $Q_{part}$：\n$$\nQ_{part}(x) = q_p S(x - 0) = q_p S(x) = q_p \\left(1 - \\frac{x}{\\Delta x}\\right)\n$$\n我们计算此贡献的平均值（期望值）$E[Q_{part}]$：\n$$\n\\mu_{part} = E[Q_{part}] = \\int_{0}^{\\Delta x} Q_{part}(x) p(x) dx = \\int_{0}^{\\Delta x} q_p \\left(1 - \\frac{x}{\\Delta x}\\right) \\frac{1}{\\Delta x} dx\n$$\n$$\n\\mu_{part} = \\frac{q_p}{\\Delta x} \\left[ x - \\frac{x^2}{2\\Delta x} \\right]_{0}^{\\Delta x} = \\frac{q_p}{\\Delta x} \\left( \\Delta x - \\frac{(\\Delta x)^2}{2\\Delta x} \\right) = \\frac{q_p}{2}\n$$\n接下来，我们计算方差 $\\text{Var}(Q_{part}) = E[Q_{part}^2] - (E[Q_{part}])^2$。首先，我们求出贡献平方的平均值：\n$$\nE[Q_{part}^2] = \\int_{0}^{\\Delta x} [Q_{part}(x)]^2 p(x) dx = \\int_{0}^{\\Delta x} q_p^2 \\left(1 - \\frac{x}{\\Delta x}\\right)^2 \\frac{1}{\\Delta x} dx\n$$\n$$\nE[Q_{part}^2] = \\frac{q_p^2}{\\Delta x} \\int_{0}^{\\Delta x} \\left(1 - \\frac{2x}{\\Delta x} + \\frac{x^2}{(\\Delta x)^2}\\right) dx = \\frac{q_p^2}{\\Delta x} \\left[ x - \\frac{x^2}{\\Delta x} + \\frac{x^3}{3(\\Delta x)^2} \\right]_{0}^{\\Delta x}\n$$\n$$\nE[Q_{part}^2] = \\frac{q_p^2}{\\Delta x} \\left( \\Delta x - \\Delta x + \\frac{\\Delta x}{3} \\right) = \\frac{q_p^2}{3}\n$$\n因此，单个粒子贡献的方差为：\n$$\n\\sigma_{part}^2 = \\text{Var}(Q_{part}) = E[Q_{part}^2] - \\mu_{part}^2 = \\frac{q_p^2}{3} - \\left(\\frac{q_p}{2}\\right)^2 = q_p^2 \\left(\\frac{1}{3} - \\frac{1}{4}\\right) = \\frac{q_p^2}{12}\n$$\n左侧单元 L 中的一个粒子，其位置 $x$ 在 $[-\\Delta x, 0]$ 上均匀分布。它对 $x_j=0$ 处节点的贡献为 $Q_{part}(x) = q_p S(x) = q_p(1 - |x|/\\Delta x) = q_p(1 + x/\\Delta x)$。根据对称性，其平均值和方差的计算结果与之前相同：$\\mu_{part} = q_p/2$ 且 $\\sigma_{part}^2 = q_p^2/12$。\n\n节点上的总电荷 $Q_{node}$ 是来自两个相邻网格单元中 $2N_p$ 个独立粒子的贡献之和。中心极限定理关注的是此类和的分布。该定理的一个关键基础是和的平均值与方差如何与单个随机变量的属性相关联。\n和的平均值是平均值的和：\n$$\n\\mu_{node} = E[Q_{node}] = \\sum_{k=1}^{2N_p} E[Q_{part, k}] = 2N_p \\cdot \\mu_{part} = 2N_p \\left(\\frac{q_p}{2}\\right) = N_p q_p\n$$\n由于粒子位置是独立的，和的方差是方差的和：\n$$\n\\sigma_{node}^2 = \\text{Var}(Q_{node}) = \\sum_{k=1}^{2N_p} \\text{Var}(Q_{part, k}) = 2N_p \\cdot \\sigma_{part}^2 = 2N_p \\left(\\frac{q_p^2}{12}\\right) = \\frac{N_p q_p^2}{6}\n$$\n节点上电荷的标准差是方差的平方根：\n$$\n\\sigma_{node} = \\sqrt{\\frac{N_p q_p^2}{6}} = q_p \\sqrt{\\frac{N_p}{6}}\n$$\n问题将分数均方根误差定义为标准差与平均值的比值，$\\sigma_{node}/\\mu_{node}$：\n$$\n\\frac{\\sigma_{node}}{\\mu_{node}} = \\frac{q_p \\sqrt{\\frac{N_p}{6}}}{N_p q_p} = \\frac{1}{\\sqrt{N_p}\\sqrt{6}} = \\frac{1}{\\sqrt{6N_p}}\n$$\n此分数误差是由离散粒子噪声引起的。我们得到的条件是此误差不得超过一个预设的目标值 $\\epsilon$：\n$$\n\\frac{1}{\\sqrt{6N_p}} \\le \\epsilon\n$$\n为了找到满足此条件的每个网格单元的最少粒子数 $N_p$，我们求解 $N_p$。对不等式两边进行平方（由于两边均为正，这是允许的）得到：\n$$\n\\frac{1}{6N_p} \\le \\epsilon^2\n$$\n重新整理各项以求解 $N_p$：\n$$\n1 \\le 6N_p \\epsilon^2\n$$\n$$\nN_p \\ge \\frac{1}{6\\epsilon^2}\n$$\n所需的每个网格单元的最少粒子数是在该不等式的极限处获得的。",
            "answer": "$$\\boxed{\\frac{1}{6\\epsilon^2}}$$"
        },
        {
            "introduction": "本练习将我们的视野从算法细节扩展到为特定天体物理问题设计模拟的整体策略。它将磁化等离子体的基本物理原理与关键数值参数的选择联系起来。为了准确捕捉无碰撞激波等现象，模拟必须解析等离子体组分的特征长度和时间尺度，例如离子惯性长度 $d_i$ 和离子回旋周期 $2\\pi/\\omega_{ci}$，而这些尺度直接源于基本的运动方程。这项实践 () 让你亲身体验如何将天体物理环境（如星际介质）的物理参数，转化为构建有效且具有物理意义的PIC模拟所需的具体数值参数（$\\Delta x$ 和 $\\Delta t$）。",
            "id": "4222899",
            "problem": "对无碰撞、磁化的星际激波进行的粒子模拟 (PIC) 必须解析离子尺度的动力学，以捕捉回旋运动和霍尔效应介导的色散。考虑一个均匀的上游等离子体，由电荷大小为 $e$、质量为 $m_i$ 的单电离氢离子组成。上游磁场为 $B_0$，离子数密度为 $n$。为了选择能够解析离子尺度物理过程的网格间距和时间步长，您必须首先从第一性原理出发，确定特征离子回旋频率和离子惯性长度。\n\n仅从牛顿-洛伦兹方程、麦克斯韦方程组和数密度的定义出发，完成以下任务：\n\n1. 对于在均匀磁场 $\\,B_0\\,$ 中回旋且无电场的非相对论性离子，推导其离子回旋角频率 $\\,\\omega_{ci}\\,$ 的表达式。清楚地说明将方程简化为具有明确定义角频率的匀速圆周运动所需的任何假设。\n\n2. 对于在具有固定的、中和的电子背景的准中性等离子体中的小振幅纵向振荡，推导冷离子等离子体角频率 $\\,\\omega_{pi}\\,$ 的表达式。使用离子运动方程和高斯定律，获得一个关于离子位移的闭合方程，并确定 $\\,\\omega_{pi}\\,$。然后，使用麦克斯韦方程组，说明与离子惯性相关的电磁趋肤深度如何产生一个特征长度尺度 $\\,d_i\\,$，并用 $\\,\\omega_{pi}\\,$ 和 $\\,c\\,$ 表示它。\n\n3. 使用您推导出的表达式，对代表弥散星际介质的以下上游参数，数值计算 $\\,\\omega_{ci}\\,$ 和 $\\,d_i\\,$：\n- $B_0 = 5\\,\\mu\\text{G}$,\n- $n = 1\\,\\text{cm}^{-3}$,\n- $m_i = m_p$ (质子质量).\n\n使用常数 $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$、$m_p = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$、$c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$ 和 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$。在计算前，将 $\\,\\mu\\text{G}\\,$ 转换为特斯拉，将 $\\,\\text{cm}^{-3}\\,$ 转换为 $\\,\\text{m}^{-3}\\,$。将 $\\,\\omega_{ci}\\,$ 以 $\\text{rad}\\,\\text{s}^{-1}$ 为单位表示，$\\,d_i\\,$ 以 $\\text{km}$ 为单位表示。将您的答案四舍五入到三位有效数字。\n\n将您的最终答案以单行向量 $\\big[\\omega_{ci},\\, d_i\\big]$ 的形式给出。",
            "solution": "经验证，此问题具有科学依据、提法明确且客观。提供了所有必要信息，所要求的任务是等离子体物理学中的标准推导和计算。我将开始解答。\n\n解答按照题目要求分为三个部分。\n\n### 第 1 部分：离子回旋角频率 ($\\omega_{ci}$) 的推导\n\n我们从单个离子（电荷为 $q$，质量为 $m_i$）在电场 $\\vec{E}$ 和磁场 $\\vec{B}$ 中以速度 $\\vec{v}$ 运动的牛顿-洛伦兹方程开始：\n$$\nm_i \\frac{d\\vec{v}}{dt} = q(\\vec{E} + \\vec{v} \\times \\vec{B})\n$$\n问题考虑的是单电离氢离子，因此其电荷为 $q = +e$。题目指定了均匀磁场 $\\vec{B} = \\vec{B}_0$ 且无电场 $\\vec{E} = 0$。运动方程简化为：\n$$\nm_i \\frac{d\\vec{v}}{dt} = e(\\vec{v} \\times \\vec{B}_0)\n$$\n让我们将坐标系对齐，使磁场沿 $z$ 轴方向，即 $\\vec{B}_0 = B_0 \\hat{k}$。速度矢量为 $\\vec{v} = v_x \\hat{i} + v_y \\hat{j} + v_z \\hat{k}$。叉积为：\n$$\n\\vec{v} \\times \\vec{B}_0 = (v_x \\hat{i} + v_y \\hat{j} + v_z \\hat{k}) \\times (B_0 \\hat{k}) = v_x B_0 (\\hat{i} \\times \\hat{k}) + v_y B_0 (\\hat{j} \\times \\hat{k}) = -v_x B_0 \\hat{j} + v_y B_0 \\hat{i}\n$$\n将运动方程写成分量形式：\n\\begin{align*}\nm_i \\frac{dv_x}{dt} = e v_y B_0 \\quad (1) \\\\\nm_i \\frac{dv_y}{dt} = -e v_x B_0 \\quad (2) \\\\\nm_i \\frac{dv_z}{dt} = 0 \\quad (3)\n\\end{align*}\n方程 $(3)$ 意味着 $v_z$ 是常数。平行于磁场的运动不受影响。\n\n为了求解垂直运动的耦合方程，我们对时间微分方程 $(1)$：\n$$\nm_i \\frac{d^2v_x}{dt^2} = e B_0 \\frac{dv_y}{dt}\n$$\n将方程 $(2)$ 中的 $\\frac{dv_y}{dt}$ 代入：\n$$\nm_i \\frac{d^2v_x}{dt^2} = e B_0 \\left(-\\frac{e v_x B_0}{m_i}\\right) = -\\frac{e^2 B_0^2}{m_i} v_x\n$$\n重新整理这个方程，得到简谐振子的标准形式：\n$$\n\\frac{d^2v_x}{dt^2} + \\left(\\frac{e B_0}{m_i}\\right)^2 v_x = 0\n$$\n这个振荡的角频率被确定为离子回旋角频率 $\\omega_{ci}$：\n$$\n\\omega_{ci} = \\frac{e B_0}{m_i}\n$$\n问题指定了电荷大小 $e$，但对于带正电的离子，我们使用 $+e$。\n\n此推导所需的假设，特别是为了得到匀速圆周运动，是：\n1.  磁场 $\\vec{B}_0$ 在空间上是均匀的，且不随时间变化。\n2.  没有其他力作用于离子上，例如电场或碰撞。\n3.  离子的运动是非相对论性的 ($|\\vec{v}| \\ll c$)，因此其质量 $m_i$ 被视为常数。\n4.  为使轨迹是圆形（匀速圆周运动）而不是螺旋线，平行于磁场的初始速度分量必须为零，即 $v_z(t=0) = 0$。\n\n### 第 2 部分：离子等离子体角频率 ($\\omega_{pi}$) 和惯性长度 ($d_i$) 的推导\n\n首先，我们推导 $\\omega_{pi}$ 的表达式。我们考虑一维等离子体中的小振幅纵向振荡。背景电子被假设为固定的，提供一个均匀的中和电荷密度。\n在平衡状态下，离子密度为 $n_{i0} = n$，电子密度为 $n_{e0} = n$。设处于平衡位置 $x_0$ 的离子发生了一个小位移 $\\xi(x_0, t)$。离子的线性化运动方程为：\n$$\nm_i \\frac{\\partial^2 \\xi}{\\partial t^2} = e E\n$$\n其中 $E$ 是由电荷分离产生的自洽电场。\n\n离子数密度受到扰动，变为 $n_i = n_{i0} + n_{i1}$。线性化的离子连续性方程是：\n$$\n\\frac{\\partial n_{i1}}{\\partial t} + n_{i0} \\frac{\\partial v_i}{\\partial x} = 0\n$$\n由于 $v_i = \\frac{\\partial \\xi}{\\partial t}$ 且 $n_{i0}=n$，我们有 $\\frac{\\partial n_{i1}}{\\partial t} = -n \\frac{\\partial^2 \\xi}{\\partial x \\partial t}$。对时间积分，得到离子密度的扰动为：\n$$\nn_{i1} = -n \\frac{\\partial \\xi}{\\partial x}\n$$\n局域净电荷密度为 $\\rho = e(n_i - n_e) = e((n+n_{i1}) - n) = e n_{i1}$。使用 $n_{i1}$ 的表达式：\n$$\n\\rho = -ne \\frac{\\partial \\xi}{\\partial x}\n$$\n一维高斯定律为 $\\frac{\\partial E}{\\partial x} = \\frac{\\rho}{\\varepsilon_0}$。代入 $\\rho$：\n$$\n\\frac{\\partial E}{\\partial x} = -\\frac{ne}{\\varepsilon_0} \\frac{\\partial \\xi}{\\partial x}\n$$\n对 $x$ 积分（并假设当 $\\xi=0$ 时 $E=0$），得到电场：\n$$\nE = -\\frac{ne}{\\varepsilon_0} \\xi\n$$\n将此电场代回离子运动方程：\n$$\nm_i \\frac{\\partial^2 \\xi}{\\partial t^2} = e \\left(-\\frac{ne}{\\varepsilon_0} \\xi\\right) = -\\frac{ne^2}{\\varepsilon_0} \\xi\n$$\n这可以写为：\n$$\n\\frac{\\partial^2 \\xi}{\\partial t^2} + \\frac{ne^2}{m_i \\varepsilon_0} \\xi = 0\n$$\n这是简谐运动的方程。角频率的平方是 $\\xi$ 项的系数。这定义了离子等离子体角频率 $\\omega_{pi}$：\n$$\n\\omega_{pi}^2 = \\frac{ne^2}{m_i \\varepsilon_0} \\implies \\omega_{pi} = \\sqrt{\\frac{ne^2}{m_i \\varepsilon_0}}\n$$\n\n接下来，我们推导离子惯性长度 $d_i$。这个长度尺度源于考虑载流子惯性对电磁场的屏蔽效应。从麦克斯韦方程组出发，在电流密度为 $\\vec{J}$ 的介质中的一般波动方程为：\n$$\n\\nabla \\times (\\nabla \\times \\vec{E}) = -\\mu_0 \\frac{\\partial \\vec{J}}{\\partial t} - \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E}$，并考虑 $\\nabla \\cdot \\vec{E} = 0$ 的横波，方程简化为：\n$$\n\\nabla^2 \\vec{E} = \\mu_0 \\frac{\\partial \\vec{J}}{\\partial t} + \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\n电流是由离子运动引起的，$\\vec{J} = \\vec{J}_i = n e \\vec{v}_i$。线性化的离子动量方程是 $m_i \\frac{\\partial \\vec{v}_i}{\\partial t} = e \\vec{E}$。电流密度的变化率为：\n$$\n\\frac{\\partial \\vec{J}_i}{\\partial t} = n e \\frac{\\partial \\vec{v}_i}{\\partial t} = \\frac{ne^2}{m_i} \\vec{E} = \\varepsilon_0 \\omega_{pi}^2 \\vec{E}\n$$\n将此代入波动方程得到：\n$$\n\\nabla^2 \\vec{E} = \\mu_0 (\\varepsilon_0 \\omega_{pi}^2 \\vec{E}) + \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\n使用关系式 $c^2=1/(\\mu_0 \\varepsilon_0)$，上式变为：\n$$\n\\nabla^2 \\vec{E} - \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2} = \\frac{\\omega_{pi}^2}{c^2} \\vec{E}\n$$\n趋肤深度是静态或极低频场穿透等离子体的特征长度尺度。在极限 $\\frac{\\partial}{\\partial t} \\to 0$ 下，方程变为：\n$$\n\\nabla^2 \\vec{E} = \\frac{\\omega_{pi}^2}{c^2} \\vec{E}\n$$\n对于一维问题，$\\frac{d^2 E}{dx^2} = \\frac{1}{(c/\\omega_{pi})^2} E$。解的形式为 $E(x) = E_0 \\exp(-x / \\lambda)$，其中衰减长度（趋肤深度）为 $\\lambda = c/\\omega_{pi}$。这个特征长度尺度被定义为离子惯性长度 $d_i$。\n$$\nd_i = \\frac{c}{\\omega_{pi}}\n$$\n\n### 第 3 部分：数值计算\n\n给定以下参数和常数：\n- $B_0 = 5\\,\\mu\\text{G} = 5 \\times 10^{-6}\\,\\text{G} \\times (10^{-4}\\,\\text{T}/\\text{G}) = 5 \\times 10^{-10}\\,\\text{T}$\n- $n = 1\\,\\text{cm}^{-3} = 1\\,\\text{cm}^{-3} \\times (100\\,\\text{cm}/\\text{m})^3 = 10^6\\,\\text{m}^{-3}$\n- $m_i = m_p = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$\n- $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n- $c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$\n\n首先，我们计算离子回旋频率 $\\omega_{ci}$：\n$$\n\\omega_{ci} = \\frac{e B_0}{m_p} = \\frac{(1.602176634 \\times 10^{-19}\\,\\text{C}) (5 \\times 10^{-10}\\,\\text{T})}{1.67262192369 \\times 10^{-27}\\,\\text{kg}}\n$$\n$$\n\\omega_{ci} \\approx 0.047895\\,\\text{rad}\\,\\text{s}^{-1}\n$$\n四舍五入到三位有效数字，我们得到 $\\omega_{ci} = 0.0479\\,\\text{rad}\\,\\text{s}^{-1}$。\n\n接下来，我们计算离子惯性长度 $d_i$。我们首先需要离子等离子体频率 $\\omega_{pi}$：\n$$\n\\omega_{pi}^2 = \\frac{n e^2}{m_p \\varepsilon_0} = \\frac{(10^6\\,\\text{m}^{-3}) (1.602176634 \\times 10^{-19}\\,\\text{C})^2}{(1.67262192369 \\times 10^{-27}\\,\\text{kg}) (8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1})}\n$$\n$$\n\\omega_{pi}^2 \\approx \\frac{2.56697 \\times 10^{-32}}{1.48074 \\times 10^{-38}} \\approx 1.73359 \\times 10^{6}\\,(\\text{rad}\\,\\text{s}^{-1})^2\n$$\n$$\n\\omega_{pi} = \\sqrt{1.73359 \\times 10^{6}} \\approx 1316.66\\,\\text{rad}\\,\\text{s}^{-1}\n$$\n现在我们可以计算离子惯性长度 $d_i$：\n$$\nd_i = \\frac{c}{\\omega_{pi}} = \\frac{2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}}{1316.66\\,\\text{rad}\\,\\text{s}^{-1}} \\approx 227702\\,\\text{m}\n$$\n转换为千米：\n$$\nd_i \\approx 227.702\\,\\text{km}\n$$\n四舍五入到三位有效数字，我们得到 $d_i = 228\\,\\text{km}$。\n\n最终所求的量是 $\\omega_{ci} = 0.0479\\,\\text{rad}\\,\\text{s}^{-1}$ 和 $d_i = 228\\,\\text{km}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0479  228 \\end{pmatrix} } $$"
        }
    ]
}