{
    "hands_on_practices": [
        {
            "introduction": "粒子-网格（PIC）方法的核心在于其混合本质，即通过网格来计算连续的场，同时追踪离散的粒子。一个基本的操作是将粒子的物理量（如电荷）分配到周围的网格点上。本练习将引导您从第一性原理出发，推导“云中单元”（CIC）电荷分配方案，这是最常用的一阶权重方案之一，它在计算效率和减少由离散粒子引起的非物理自作用力之间取得了良好的平衡。",
            "id": "4222896",
            "problem": "考虑一个一维静电粒子云网格（PIC）模拟，该模拟研究的是天体物理中的对等离子体。模拟在一个均匀网格上进行，网格单元中心的位置为 $x_i = i\\,\\Delta x$，其中 $\\Delta x$ 是网格间距， $i$ 是一个整数。一个电荷量为 $q$ 的粒子严格位于两个相邻的单元中心 $x_i$（左）和 $x_{i+1}$（右）之间。设粒子的局部坐标为 $x \\in [0, \\Delta x]$，该坐标是从左侧单元中心测量的，因此其绝对位置为 $x_p = x_i + x$，与右侧中心的距离为 $\\Delta x - x$。\n\n在云中云（CIC）电荷分配方案中，分配到格点的电荷由最近格点（NGP）形状函数与其自身的卷积确定。NGP 形状函数 $S_0(x)$ 定义为：当 $|x| \\le \\Delta x/2$ 时，$S_0(x) = 1$；否则 $S_0(x) = 0$。CIC 形状函数 $S_1(x)$ 定义为卷积 $S_1 = S_0 * S_0$，并经过适当归一化，使得 $S_1(x)$ 具有宽度为 $2\\,\\Delta x$ 的紧支撑，并且与电荷在格点上的分配过程中的电荷守恒相一致。\n\n从这些定义以及电荷分配过程中的局部电荷守恒要求（即，位于两个中心之间的粒子，其分配到左右两个中心的权重之和等于 1）出发，推导分配到左侧和右侧单元中心的云中云权重 $w_L$ 和 $w_R$，使其分别表示为局部坐标 $x$ 和网格间距 $\\Delta x$ 的函数。然后，用 $q$、$x$ 和 $\\Delta x$ 表示在左侧和右侧中心上沉积的电荷 $Q_L$ 和 $Q_R$。\n\n将您的最终答案表示为一个单行矩阵，其中包含四个量 $\\{w_L, w_R, Q_L, Q_R\\}$ 的闭合形式。不需要进行数值计算。",
            "solution": "首先将根据既定标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：一维静电粒子云网格（PIC）模拟，研究天体物理中的对等离子体。\n- **网格**：一个均匀网格，单元中心位置为 $x_i = i\\,\\Delta x$，其中 $\\Delta x$ 是网格间距， $i$ 是一个整数。\n- **粒子**：一个电荷量为 $q$ 的单个粒子。\n- **粒子位置**：粒子位于绝对位置 $x_p = x_i + x$ 处，其中 $x_i$ 是左侧单元中心的位置， $x_{i+1}$ 是右侧单元中心的位置， $x$ 是从左侧单元中心测量的局部坐标，且 $x \\in [0, \\Delta x]$。\n- **最近格点（NGP）形状函数**：$S_0(x)$ 定义为：当 $|x| \\le \\Delta x/2$ 时，$S_0(x) = 1$；否则 $S_0(x) = 0$。\n- **云中云（CIC）形状函数**：$S_1(x)$ 定义为卷积 $S_1 = S_0 * S_0$，并经过适当归一化。\n- **约束**：局部电荷守恒要求分配给左侧和右侧单元中心的权重之和为1：$w_L + w_R = 1$。\n- **目标**：推导左侧和右侧单元中心的 CIC 权重 $w_L$ 和 $w_R$，以及相应的沉积电荷 $Q_L$ 和 $Q_R$，使其表示为 $q$、$x$ 和 $\\Delta x$ 的函数。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了云中云（CIC）或一阶电荷分配方案，这是计算等离子体物理学和天体物理学中的一项基本且标准的技术，尤其是在 PIC 模拟中。将 CIC 形状函数定义为两个 NGP（零阶）形状函数的卷积是标准的教科书内容。该问题牢固地植根于计算物理学的既定原理。\n- **适定性**：问题陈述清晰，提供了所有必要的定义和约束。形状函数的定义和守恒约束能够导出一个唯一且有意义的权重和沉积电荷解。\n- **客观性**：问题以精确、正式且无偏见的科学语言陈述。\n- **其他缺陷**：该问题在科学上没有不健全、不完整、自相矛盾或不适定的地方。它是指定领域中的一个标准推导问题。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n云中云（CIC）方案，也称为一阶方案（$p=1$），使用一个形状函数 $S_1(y)$，该函数可以通过最近格点（NGP）或零阶形状函数 $S_0(y)$ 与其自身的卷积来推导。NGP 形状函数是一个以原点为中心的矩形函数或“顶帽”函数：\n$$\nS_0(y) = \n\\begin{cases} \n1,  \\text{if } |y| \\le \\frac{\\Delta x}{2} \\\\\n0,  \\text{if } |y| > \\frac{\\Delta x}{2}\n\\end{cases}\n$$\n用于获得未归一化 CIC 形状函数的卷积（我们记为 $S_{1,u}(y)$）由下式给出：\n$$\nS_{1,u}(y) = (S_0 * S_0)(y) = \\int_{-\\infty}^{\\infty} S_0(z) S_0(y-z) dz\n$$\n被积函数仅在 $S_0(z)$ 和 $S_0(y-z)$ 均非零时才非零。这要求 $|z| \\le \\frac{\\Delta x}{2}$ 和 $|y-z| \\le \\frac{\\Delta x}{2}$。第二个条件等价于 $y - \\frac{\\Delta x}{2} \\le z \\le y + \\frac{\\Delta x}{2}$。因此，积分仅在 $z$ 位于区间 $[-\\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$ 和 $[y - \\frac{\\Delta x}{2}, y + \\frac{\\Delta x}{2}]$ 的交集内时才非零。积分的值是该交集区域的长度。\n\n我们针对 $y$ 的不同范围分析重叠部分：\n1.  对于 $|y| \\ge \\Delta x$，这两个区间没有重叠。因此，$S_{1,u}(y) = 0$。\n2.  对于 $0 \\le y  \\Delta x$，$z$ 的交集区间是 $[y - \\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$。该区间的长度为 $\\frac{\\Delta x}{2} - (y - \\frac{\\Delta x}{2}) = \\Delta x - y$。所以，$S_{1,u}(y) = \\Delta x - y$。\n3.  对于 $-\\Delta x  y  0$，$z$ 的交集区间是 $[-\\frac{\\Delta x}{2}, y + \\frac{\\Delta x}{2}]$。该区间的长度为 $(y + \\frac{\\Delta x}{2}) - (-\\frac{\\Delta x}{2}) = y + \\Delta x$。所以，$S_{1,u}(y) = y + \\Delta x$。\n\n综合这些结果，我们可以将未归一化的 CIC 形状函数写成一个单一表达式：\n$$\nS_{1,u}(y) = \n\\begin{cases} \n\\Delta x - |y|,  \\text{if } |y| \\le \\Delta x \\\\\n0,  \\text{if } |y| > \\Delta x\n\\end{cases}\n$$\n这是一个在 $[- \\Delta x, \\Delta x]$ 上有支撑的三角形函数，其基底宽度为 $2\\Delta x$，在 $y=0$ 处的峰值为 $\\Delta x$。\n\n对于电荷守恒的分配方案，形状函数必须满足单位分解性质，即在粒子位置处，相对于所有相互作用的格点计算的函数值之和必须等于1。位于位置 $x_p = x_i + x$ 且 $x \\in [0, \\Delta x]$ 的粒子仅与格点 $x_i$ 和 $x_{i+1}$ 相互作用。未归一化的形状函数之和为：\n$$\nS_{1,u}(x_p - x_i) + S_{1,u}(x_p - x_{i+1}) = S_{1,u}(x) + S_{1,u}(x - \\Delta x)\n$$\n使用我们推导出的 $S_{1,u}(y)$ 表达式：\n- 由于 $x \\in [0, \\Delta x]$，我们有 $S_{1,u}(x) = \\Delta x - x$。\n- 由于 $x - \\Delta x \\in [-\\Delta x, 0]$，我们有 $S_{1,u}(x - \\Delta x) = (x - \\Delta x) + \\Delta x = x$。\n和为 $(\\Delta x - x) + x = \\Delta x$。为了满足单位分解性质，我们必须将形状函数除以这个和 $\\Delta x$ 来进行归一化。归一化后的 CIC 形状函数，我们称之为 $W(y)$，是：\n$$\nW(y) = \\frac{S_{1,u}(y)}{\\Delta x} = \n\\begin{cases} \n1 - \\frac{|y|}{\\Delta x},  \\text{if } |y| \\le \\Delta x \\\\\n0,  \\text{if } |y| > \\Delta x\n\\end{cases}\n$$\n权重 $w_L$ 和 $w_R$ 分别是此归一化形状函数在粒子相对于左侧和右侧格点中心的位置处的值。\n\n粒子位于绝对位置 $x_p = x_i + x$，其中 $x \\in [0, \\Delta x]$ 是相对于左侧格点中心 $x_i$ 的局部坐标。\n分配给左侧格点中心 $x_i$ 的权重为 $w_L$：\n$$\nw_L = W(x_p - x_i) = W(x)\n$$\n由于 $x \\ge 0$，所以 $|x| = x$。因此，\n$$\nw_L = 1 - \\frac{x}{\\Delta x}\n$$\n分配给右侧格点中心 $x_{i+1} = x_i + \\Delta x$ 的权重为 $w_R$：\n$$\nw_R = W(x_p - x_{i+1}) = W(x - \\Delta x)\n$$\n由于 $x \\in [0, \\Delta x]$，自变量 $y = x - \\Delta x$ 在范围 $[-\\Delta x, 0]$ 内。因此， $|y| = |x - \\Delta x| = -(x - \\Delta x) = \\Delta x - x$。因此，\n$$\nw_R = 1 - \\frac{|x-\\Delta x|}{\\Delta x} = 1 - \\frac{\\Delta x - x}{\\Delta x} = 1 - \\left(1 - \\frac{x}{\\Delta x}\\right) = \\frac{x}{\\Delta x}\n$$\n我们可以验证电荷守恒约束：$w_L + w_R = (1 - \\frac{x}{\\Delta x}) + \\frac{x}{\\Delta x} = 1$。这与要求一致。\n\n在左侧和右侧单元中心沉积的电荷 $Q_L$ 和 $Q_R$ 是粒子的电荷 $q$ 乘以各自的权重：\n在左侧中心 $x_i$ 沉积的电荷是：\n$$\nQ_L = q \\cdot w_L = q \\left(1 - \\frac{x}{\\Delta x}\\right)\n$$\n在右侧中心 $x_{i+1}$ 沉积的电荷是：\n$$\nQ_R = q \\cdot w_R = q \\frac{x}{\\Delta x}\n$$\n最终答案要求将这四个量——$w_L$、$w_R$、$Q_L$、$Q_R$——写在一个单行矩阵中。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 - \\frac{x}{\\Delta x}  \\frac{x}{\\Delta x}  q \\left(1 - \\frac{x}{\\Delta x}\\right)  q \\frac{x}{\\Delta x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在PIC模拟中，我们使用的是代表大量真实粒子的“宏粒子”，因此粒子数量是有限的。这种离散性不可避免地会在计算出的电荷和电流密度中引入统计涨落，即“粒子噪声”。本练习将通过统计学方法，分析粒子位置的随机性如何导致网格点上电荷密度的误差，并推导出为达到特定信噪比所需的每单元最小粒子数（$N_p$）。 理解并控制这种噪声对于确保模拟结果的物理真实性至关重要。",
            "id": "4222907",
            "problem": "考虑一个由质点网格(PIC)方法求解的一维、静电、无碰撞、均匀等离子体，其平均电荷密度为 $\\rho_{0}$。空间网格具有均匀间距 $\\Delta x$，每个网格单元初始包含 $N_{p}$ 个相同的宏观粒子，每个宏观粒子携带的电荷为 $q_{p}$，其选择使得每个单元的平均电荷等于 $\\rho_{0} \\Delta x$。PIC的电荷分配采用一阶B样条（云中网格）形函数，该函数根据粒子在相邻网格单元中的位置，将其电荷的线性加权分数分配给任意网格节点。假设每个网格单元内宏观粒子的瞬时位置是独立的，并在该单元上均匀分布。\n\n我们关注位于两个相邻网格单元交界面上的单个网格节点。在给定的时间步长，分配给该节点的总电荷是来自两个相邻网格单元中 $2 N_{p}$ 个粒子的贡献之和，每个贡献都根据粒子的位置通过云中网格规则计算。使用中心极限定理和粒子位置的独立性，推导由于粒子噪声引起的节点上沉积电荷的分数均方根误差（标准差除以平均值），并通过强制该分数误差不超过预设目标 $\\epsilon$，求得所需的每个网格单元最少粒子数 $N_{p}$ 的精确解析表达式。\n\n将您的最终答案表示为关于 $\\epsilon$ 的单个闭式表达式。不需要进行数值近似。如果在中间步骤中出现任何物理单位，请确保它们能够相消，从而使最终表达式为无量纲的。不要引入任何未从PIC电荷分配、独立均匀样本的概率论以及中心极限定理的第一性原理推导出的快捷公式。",
            "solution": "该问题要求推导每个网格单元所需的最少粒子数 $N_p$，以使沉积在网格节点上的电荷的分数均方根(RMS)误差低于某个阈值 $\\epsilon$。该推导必须基于质点网格(PIC)方法的第一性原理，特别是云中网格(CIC)电荷分配方案，以及使用中心极限定理的统计分析。\n\n设一维网格的节点位于位置 $x_j = j \\Delta x$，其中 $j$ 是整数，$\\Delta x$ 是均匀的网格间距。我们关注单个网格节点，为不失一般性，可将其置于原点 $x_j=0$。该节点位于两个相邻网格单元的交界面上：左单元(Cell L)覆盖区间 $[-\\Delta x, 0]$，右单元(Cell R)覆盖区间 $[0, \\Delta x]$。每个单元包含 $N_p$ 个宏观粒子。因此，来自这两个单元的总共 $2N_p$ 个粒子可以向位于 $x_j=0$ 的节点贡献电荷。\n\n电荷分配使用一阶B样条，或称云中网格(CIC)形函数 $S(u)$。对于位置为 $x_p$ 的粒子和位置为 $x_j$ 的网格节点，分配给该节点的粒子电荷分数为 $S(x_p - x_j)$。函数 $S(u)$ 是一个三角形函数，定义如下：\n$$\nS(u) =\n\\begin{cases}\n    1 - \\frac{|u|}{\\Delta x},  \\text{if } |u| \\leq \\Delta x \\\\\n    0,  \\text{if } |u| > \\Delta x\n\\end{cases}\n$$\n位于位置 $x_k$、携带电荷 $q_p$ 的单个粒子 $k$ 在节点 $x_j$ 上沉积的电荷为 $Q_k = q_p S(x_k - x_j)$。\n\n问题陈述，粒子在其各自单元内的瞬时位置是独立的且均匀分布的。我们来分析单个粒子对节点 $x_j=0$ 的电荷贡献。\n\n考虑一个在右单元(Cell R)中的粒子，其位置 $x$ 是一个在 $[0, \\Delta x]$ 上均匀分布的随机变量。其概率密度函数为 $p(x) = 1/\\Delta x$ (对于 $x \\in [0, \\Delta x]$)。该粒子对节点 $x_j=0$ 贡献的电荷是一个随机变量 $Q_{part}$：\n$$\nQ_{part}(x) = q_p S(x - 0) = q_p S(x) = q_p \\left(1 - \\frac{x}{\\Delta x}\\right)\n$$\n我们计算该贡献的平均值（期望值）$E[Q_{part}]$：\n$$\n\\mu_{part} = E[Q_{part}] = \\int_{0}^{\\Delta x} Q_{part}(x) p(x) dx = \\int_{0}^{\\Delta x} q_p \\left(1 - \\frac{x}{\\Delta x}\\right) \\frac{1}{\\Delta x} dx\n$$\n$$\n\\mu_{part} = \\frac{q_p}{\\Delta x} \\left[ x - \\frac{x^2}{2\\Delta x} \\right]_{0}^{\\Delta x} = \\frac{q_p}{\\Delta x} \\left( \\Delta x - \\frac{(\\Delta x)^2}{2\\Delta x} \\right) = \\frac{q_p}{2}\n$$\n接下来，我们计算方差 $\\text{Var}(Q_{part}) = E[Q_{part}^2] - (E[Q_{part}])^2$。首先，我们求出贡献的平方的平均值：\n$$\nE[Q_{part}^2] = \\int_{0}^{\\Delta x} [Q_{part}(x)]^2 p(x) dx = \\int_{0}^{\\Delta x} q_p^2 \\left(1 - \\frac{x}{\\Delta x}\\right)^2 \\frac{1}{\\Delta x} dx\n$$\n$$\nE[Q_{part}^2] = \\frac{q_p^2}{\\Delta x} \\int_{0}^{\\Delta x} \\left(1 - \\frac{2x}{\\Delta x} + \\frac{x^2}{(\\Delta x)^2}\\right) dx = \\frac{q_p^2}{\\Delta x} \\left[ x - \\frac{x^2}{\\Delta x} + \\frac{x^3}{3(\\Delta x)^2} \\right]_{0}^{\\Delta x}\n$$\n$$\nE[Q_{part}^2] = \\frac{q_p^2}{\\Delta x} \\left( \\Delta x - \\Delta x + \\frac{\\Delta x}{3} \\right) = \\frac{q_p^2}{3}\n$$\n因此，单个粒子贡献的方差为：\n$$\n\\sigma_{part}^2 = \\text{Var}(Q_{part}) = E[Q_{part}^2] - \\mu_{part}^2 = \\frac{q_p^2}{3} - \\left(\\frac{q_p}{2}\\right)^2 = q_p^2 \\left(\\frac{1}{3} - \\frac{1}{4}\\right) = \\frac{q_p^2}{12}\n$$\n一个在左单元(Cell L)中的粒子，其位置 $x$ 在 $[-\\Delta x, 0]$ 上均匀分布。它对节点 $x_j=0$ 的贡献是 $Q_{part}(x) = q_p S(x) = q_p(1 - |x|/\\Delta x) = q_p(1 + x/\\Delta x)$。根据对称性，平均值和方差的计算得出相同的结果：$\\mu_{part} = q_p/2$ 和 $\\sigma_{part}^2 = q_p^2/12$。\n\n节点上的总电荷 $Q_{node}$ 是来自两个相邻单元中 $2N_p$ 个独立粒子的贡献之和。中心极限定理涉及此类和的分布。该定理的一个关键基础是，和的平均值和方差如何与单个随机变量的属性相关联。\n和的平均值是平均值的和：\n$$\n\\mu_{node} = E[Q_{node}] = \\sum_{k=1}^{2N_p} E[Q_{part, k}] = 2N_p \\cdot \\mu_{part} = 2N_p \\left(\\frac{q_p}{2}\\right) = N_p q_p\n$$\n由于粒子位置是独立的，和的方差是方差的和：\n$$\n\\sigma_{node}^2 = \\text{Var}(Q_{node}) = \\sum_{k=1}^{2N_p} \\text{Var}(Q_{part, k}) = 2N_p \\cdot \\sigma_{part}^2 = 2N_p \\left(\\frac{q_p^2}{12}\\right) = \\frac{N_p q_p^2}{6}\n$$\n节点上电荷的标准差是方差的平方根：\n$$\n\\sigma_{node} = \\sqrt{\\frac{N_p q_p^2}{6}} = q_p \\sqrt{\\frac{N_p}{6}}\n$$\n问题将分数均方根误差定义为标准差与平均值的比值，$\\sigma_{node}/\\mu_{node}$：\n$$\n\\frac{\\sigma_{node}}{\\mu_{node}} = \\frac{q_p \\sqrt{\\frac{N_p}{6}}}{N_p q_p} = \\frac{1}{\\sqrt{N_p}\\sqrt{6}} = \\frac{1}{\\sqrt{6N_p}}\n$$\n这个分数误差是由于离散的粒子噪声造成的。我们得到的条件是，这个误差不得超过预设的目标值 $\\epsilon$：\n$$\n\\frac{1}{\\sqrt{6N_p}} \\le \\epsilon\n$$\n为了找到满足此条件的每个网格单元的最少粒子数 $N_p$，我们求解 $N_p$。将不等式两边平方（由于两边均为正，这是允许的）得到：\n$$\n\\frac{1}{6N_p} \\le \\epsilon^2\n$$\n重新整理各项以求解 $N_p$：\n$$\n1 \\le 6N_p \\epsilon^2\n$$\n$$\nN_p \\ge \\frac{1}{6\\epsilon^2}\n$$\n所需的每个网格单元的最少粒子数是在该不等式的极限处获得的。",
            "answer": "$$\\boxed{\\frac{1}{6\\epsilon^2}}$$"
        },
        {
            "introduction": "一个成功的PIC模拟不仅需要精确的算法和足够的粒子数，其网格间距和时间步长还必须能够解析所研究现象的关键物理尺度。如果网格太粗或时间步长太大，重要的物理过程（如等离子体振荡或粒子回旋运动）将被平均掉，从而导致非物理的结果。本练习将指导您从基本物理定律出发，推导等离子体中的两个关键尺度——离子回旋频率和离子惯性长度，并为典型的天体物理环境计算它们的数值，从而为设定模拟参数提供物理依据。",
            "id": "4222899",
            "problem": "一项对无碰撞、磁化的星际激波进行的粒子模拟 (PIC) 必须解析离子尺度的动力学，以捕捉回旋运动和霍尔效应介导的色散。考虑一个由单电离氢离子组成的均匀上游等离子体，离子的电荷量为 $e$，质量为 $m_i$。上游磁场为 $B_0$，离子数密度为 $n$。为了选择能够解析离子尺度物理过程的网格间距和时间步长，您必须首先从第一性原理出发，确定特征离子回旋频率和离子惯性长度。\n\n仅从 Newton-Lorentz 方程、Maxwell 方程组和数密度的定义出发，完成以下任务：\n\n1. 推导在无电场的均匀磁场 $\\,B_0\\,$ 中回旋的非相对论性离子的回旋角频率 $\\,\\omega_{ci}\\,$ 的表达式。清楚地说明将方程简化为具有明确定义角频率的匀速圆周运动所需的任何假设。\n\n2. 对于一个具有固定的、用于中和的电子背景的准中性等离子体中的小振幅纵向振荡，推导冷离子等离子体角频率 $\\,\\omega_{pi}\\,$ 的表达式。使用离子运动方程和 Gauss 定理，获得一个关于离子位移的闭合方程，并由此确定 $\\,\\omega_{pi}\\,$。然后，使用 Maxwell 方程组，说明与离子惯性相关的电磁趋肤深度如何产生一个特征长度尺度 $\\,d_i\\,$，并用 $\\,\\omega_{pi}\\,$ 和 $\\,c\\,$ 表示它。\n\n3. 使用您推导的表达式，为以下代表弥散星际介质的上游参数，数值计算 $\\,\\omega_{ci}\\,$ 和 $\\,d_i\\,$：\n- $B_0 = 5\\,\\mu\\text{G}$,\n- $n = 1\\,\\text{cm}^{-3}$,\n- $m_i = m_p$ (质子质量)。\n\n使用常数 $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$，$m_p = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$，$c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$，以及 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$。在计算之前，将 $\\,\\mu\\text{G}\\,$ 转换为特斯拉，将 $\\,\\text{cm}^{-3}\\,$ 转换为 $\\,\\text{m}^{-3}\\,$。将 $\\,\\omega_{ci}\\,$ 以 $\\text{rad}\\,\\text{s}^{-1}$ 为单位表示，将 $\\,d_i\\,$ 以 $\\text{km}$ 为单位表示。将您的答案四舍五入到三位有效数字。\n\n以单个行向量 $\\big[\\omega_{ci},\\, d_i\\big]$ 的形式给出您的最终答案。",
            "solution": "经验证，该问题具有科学依据、提法恰当且客观。提供了所有必要的信息，所要求的任务是等离子体物理学中的标准推导和计算。我将开始解答。\n\n按照题目要求，解答分为三个部分。\n\n### 第1部分：离子回旋角频率 ($\\omega_{ci}$) 的推导\n\n我们从一个电荷为 $q$、质量为 $m_i$ 的单个离子在电场 $\\vec{E}$ 和磁场 $\\vec{B}$ 中以速度 $\\vec{v}$ 运动的 Newton-Lorentz 方程开始：\n$$\nm_i \\frac{d\\vec{v}}{dt} = q(\\vec{E} + \\vec{v} \\times \\vec{B})\n$$\n问题考虑的是单电离氢离子，因此其电荷为 $q = +e$。题目指定了均匀磁场 $\\vec{B} = \\vec{B}_0$ 和无电场 $\\vec{E} = 0$。运动方程简化为：\n$$\nm_i \\frac{d\\vec{v}}{dt} = e(\\vec{v} \\times \\vec{B}_0)\n$$\n让我们建立坐标系，使磁场沿 $z$ 轴方向，即 $\\vec{B}_0 = B_0 \\hat{k}$。速度矢量为 $\\vec{v} = v_x \\hat{i} + v_y \\hat{j} + v_z \\hat{k}$。叉积为：\n$$\n\\vec{v} \\times \\vec{B}_0 = (v_x \\hat{i} + v_y \\hat{j} + v_z \\hat{k}) \\times (B_0 \\hat{k}) = v_x B_0 (\\hat{i} \\times \\hat{k}) + v_y B_0 (\\hat{j} \\times \\hat{k}) = -v_x B_0 \\hat{j} + v_y B_0 \\hat{i}\n$$\n将运动方程写成分量形式：\n\\begin{align*}\nm_i \\frac{dv_x}{dt} = e v_y B_0 \\quad (1) \\\\\nm_i \\frac{dv_y}{dt} = -e v_x B_0 \\quad (2) \\\\\nm_i \\frac{dv_z}{dt} = 0 \\quad (3)\n\\end{align*}\n方程 $(3)$ 表明 $v_z$ 是一个常数。平行于磁场的运动不受影响。\n\n为了求解垂直运动的耦合方程，我们对式 $(1)$ 关于时间求导：\n$$\nm_i \\frac{d^2v_x}{dt^2} = e B_0 \\frac{dv_y}{dt}\n$$\n将式 $(2)$ 中的 $\\frac{dv_y}{dt}$ 代入：\n$$\nm_i \\frac{d^2v_x}{dt^2} = e B_0 \\left(-\\frac{e v_x B_0}{m_i}\\right) = -\\frac{e^2 B_0^2}{m_i} v_x\n$$\n整理此方程得到简谐振子的标准形式：\n$$\n\\frac{d^2v_x}{dt^2} + \\left(\\frac{e B_0}{m_i}\\right)^2 v_x = 0\n$$\n该振荡的角频率被确定为离子回旋角频率 $\\omega_{ci}$：\n$$\n\\omega_{ci} = \\frac{e B_0}{m_i}\n$$\n问题指定了电荷量 $e$，但对于带正电的离子，我们使用 $+e$。\n\n此推导所需的假设，特别是为了获得匀速圆周运动，包括：\n1.  磁场 $\\vec{B}_0$ 在空间上是均匀的，且不随时间变化。\n2.  没有其他力作用在离子上，例如电场或碰撞。\n3.  离子的运动是非相对论性的 ($|\\vec{v}| \\ll c$)，因此其质量 $m_i$ 被视为常数。\n4.  为了使轨迹为圆形（匀速圆周运动）而非螺旋线，平行于磁场的初速度分量必须为零，即 $v_z(t=0) = 0$。\n\n### 第2部分：离子等离子体角频率 ($\\omega_{pi}$) 和惯性长度 ($d_i$) 的推导\n\n首先，我们推导 $\\omega_{pi}$ 的表达式。我们考虑一维等离子体中的小振幅纵向振荡。假设背景电子是固定的，提供一个均匀的中和电荷密度。\n在平衡状态下，离子密度为 $n_{i0} = n$，电子密度为 $n_{e0} = n$。设处于平衡位置 $x_0$ 的离子发生了微小位移 $\\xi(x_0, t)$。离子的线性化运动方程为：\n$$\nm_i \\frac{\\partial^2 \\xi}{\\partial t^2} = e E\n$$\n其中 $E$ 是由电荷分离产生的自洽电场。\n\n离子数密度受到扰动变为 $n_i = n_{i0} + n_{i1}$。线性化的离子连续性方程为：\n$$\n\\frac{\\partial n_{i1}}{\\partial t} + n_{i0} \\frac{\\partial v_i}{\\partial x} = 0\n$$\n当 $v_i = \\frac{\\partial \\xi}{\\partial t}$ 且 $n_{i0}=n$ 时，我们有 $\\frac{\\partial n_{i1}}{\\partial t} = -n \\frac{\\partial^2 \\xi}{\\partial x \\partial t}$。对时间积分，得到离子密度扰动：\n$$\nn_{i1} = -n \\frac{\\partial \\xi}{\\partial x}\n$$\n局部净电荷密度为 $\\rho = e(n_i - n_e) = e((n+n_{i1}) - n) = e n_{i1}$。使用 $n_{i1}$ 的表达式：\n$$\n\\rho = -ne \\frac{\\partial \\xi}{\\partial x}\n$$\n一维 Gauss 定理为 $\\frac{\\partial E}{\\partial x} = \\frac{\\rho}{\\varepsilon_0}$。代入 $\\rho$：\n$$\n\\frac{\\partial E}{\\partial x} = -\\frac{ne}{\\varepsilon_0} \\frac{\\partial \\xi}{\\partial x}\n$$\n对 $x$ 积分（并假设当 $\\xi=0$ 时 $E=0$），得到电场：\n$$\nE = -\\frac{ne}{\\varepsilon_0} \\xi\n$$\n将此电场代回离子运动方程：\n$$\nm_i \\frac{\\partial^2 \\xi}{\\partial t^2} = e \\left(-\\frac{ne}{\\varepsilon_0} \\xi\\right) = -\\frac{ne^2}{\\varepsilon_0} \\xi\n$$\n这可以写成：\n$$\n\\frac{\\partial^2 \\xi}{\\partial t^2} + \\frac{ne^2}{m_i \\varepsilon_0} \\xi = 0\n$$\n这是简谐运动的方程。角频率的平方是 $\\xi$ 项的系数。这定义了离子等离子体角频率 $\\omega_{pi}$：\n$$\n\\omega_{pi}^2 = \\frac{ne^2}{m_i \\varepsilon_0} \\implies \\omega_{pi} = \\sqrt{\\frac{ne^2}{m_i \\varepsilon_0}}\n$$\n\n接下来，我们推导离子惯性长度 $d_i$。这个长度尺度源于考虑载流子惯性对电磁场的屏蔽效应。从 Maxwell 方程组出发，在电流密度为 $\\vec{J}$ 的介质中的一般波动方程是：\n$$\n\\nabla \\times (\\nabla \\times \\vec{E}) = -\\mu_0 \\frac{\\partial \\vec{J}}{\\partial t} - \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E}$，并考虑横波（其中 $\\nabla \\cdot \\vec{E} = 0$），方程简化为：\n$$\n\\nabla^2 \\vec{E} = \\mu_0 \\frac{\\partial \\vec{J}}{\\partial t} + \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\n电流是由离子运动引起的，$\\vec{J} = \\vec{J}_i = n e \\vec{v}_i$。线性化的离子动量方程为 $m_i \\frac{\\partial \\vec{v}_i}{\\partial t} = e \\vec{E}$。电流密度的变化率为：\n$$\n\\frac{\\partial \\vec{J}_i}{\\partial t} = n e \\frac{\\partial \\vec{v}_i}{\\partial t} = \\frac{ne^2}{m_i} \\vec{E} = \\varepsilon_0 \\omega_{pi}^2 \\vec{E}\n$$\n将此代入波动方程得到：\n$$\n\\nabla^2 \\vec{E} = \\mu_0 (\\varepsilon_0 \\omega_{pi}^2 \\vec{E}) + \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2}\n$$\n使用关系式 $c^2=1/(\\mu_0 \\varepsilon_0)$，上式变为：\n$$\n\\nabla^2 \\vec{E} - \\frac{1}{c^2} \\frac{\\partial^2 \\vec{E}}{\\partial t^2} = \\frac{\\omega_{pi}^2}{c^2} \\vec{E}\n$$\n趋肤深度是静场或极低频场穿透等离子体的特征长度尺度。在 $\\frac{\\partial}{\\partial t} \\to 0$ 的极限下，方程变为：\n$$\n\\nabla^2 \\vec{E} = \\frac{\\omega_{pi}^2}{c^2} \\vec{E}\n$$\n对于一维问题，$\\frac{d^2 E}{dx^2} = \\frac{1}{(c/\\omega_{pi})^2} E$。其解的形式为 $E(x) = E_0 \\exp(-x / \\lambda)$，其中衰减长度（趋肤深度）为 $\\lambda = c/\\omega_{pi}$。这个特征长度尺度被定义为离子惯性长度 $d_i$。\n$$\nd_i = \\frac{c}{\\omega_{pi}}\n$$\n\n### 第3部分：数值计算\n\n我们已知以下参数和常数：\n- $B_0 = 5\\,\\mu\\text{G} = 5 \\times 10^{-6}\\,\\text{G} \\times (10^{-4}\\,\\text{T}/\\text{G}) = 5 \\times 10^{-10}\\,\\text{T}$\n- $n = 1\\,\\text{cm}^{-3} = 1\\,\\text{cm}^{-3} \\times (100\\,\\text{cm}/\\text{m})^3 = 10^6\\,\\text{m}^{-3}$\n- $m_i = m_p = 1.67262192369 \\times 10^{-27}\\,\\text{kg}$\n- $e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n- $c = 2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$\n\n首先，我们计算离子回旋频率 $\\omega_{ci}$：\n$$\n\\omega_{ci} = \\frac{e B_0}{m_p} = \\frac{(1.602176634 \\times 10^{-19}\\,\\text{C}) (5 \\times 10^{-10}\\,\\text{T})}{1.67262192369 \\times 10^{-27}\\,\\text{kg}}\n$$\n$$\n\\omega_{ci} \\approx 0.047895\\,\\text{rad}\\,\\text{s}^{-1}\n$$\n四舍五入到三位有效数字，我们得到 $\\omega_{ci} = 0.0479\\,\\text{rad}\\,\\text{s}^{-1}$。\n\n接下来，我们计算离子惯性长度 $d_i$。我们首先需要离子等离子体频率 $\\omega_{pi}$：\n$$\n\\omega_{pi}^2 = \\frac{n e^2}{m_p \\varepsilon_0} = \\frac{(10^6\\,\\text{m}^{-3}) (1.602176634 \\times 10^{-19}\\,\\text{C})^2}{(1.67262192369 \\times 10^{-27}\\,\\text{kg}) (8.8541878128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1})}\n$$\n$$\n\\omega_{pi}^2 \\approx \\frac{2.56697 \\times 10^{-32}}{1.48074 \\times 10^{-38}} \\approx 1.73359 \\times 10^{6}\\,(\\text{rad}\\,\\text{s}^{-1})^2\n$$\n$$\n\\omega_{pi} = \\sqrt{1.73359 \\times 10^{6}} \\approx 1316.66\\,\\text{rad}\\,\\text{s}^{-1}\n$$\n现在我们可以计算离子惯性长度 $d_i$：\n$$\nd_i = \\frac{c}{\\omega_{pi}} = \\frac{2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}}{1316.66\\,\\text{rad}\\,\\text{s}^{-1}} \\approx 227702\\,\\text{m}\n$$\n转换为千米：\n$$\nd_i \\approx 227.702\\,\\text{km}\n$$\n四舍五入到三位有效数字，我们得到 $d_i = 228\\,\\text{km}$。\n\n最终要求的量是 $\\omega_{ci} = 0.0479\\,\\text{rad}\\,\\text{s}^{-1}$ 和 $d_i = 228\\,\\text{km}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0479  228 \\end{pmatrix} } $$"
        }
    ]
}