{
    "hands_on_practices": [
        {
            "introduction": "The Fokker-Planck equation describes the evolution of a particle distribution, but a complete model requires physically meaningful boundary conditions. These conditions are not mere mathematical formalities; they represent crucial physical processes like particle loss or the absence of a source at a specific velocity. This practice  challenges you to connect the abstract diffusion equation to a concrete physical scenario by deriving the appropriate boundary conditions from first principles, a fundamental skill for setting up and solving problems in kinetic theory.",
            "id": "4225198",
            "problem": "Consider a spatially homogeneous, isotropic astrophysical plasma in which resonant wave–particle interactions produce quasilinear diffusion in velocity space. Let the isotropic distribution function be $f(v,t)$, where $v$ is the particle speed and $t$ is time. In the random-phase, weak-turbulence limit of quasilinear theory, the isotropic velocity-space evolution of $f$ can be modeled by a Fokker–Planck equation of the form\n$$\n\\frac{\\partial f}{\\partial t} \\;=\\; \\frac{1}{v^{2}}\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right],\n$$\nwhere $D(v)>0$ is a smooth diffusion coefficient set by the spectrum of the turbulent waves. Define the total particle number in the bounded speed domain $v\\in[0,v_{\\mathrm{esc}}]$ by\n$$\nN(t)\\;=\\;\\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,f(v,t)\\,dv,\n$$\nand suppose there are no volumetric sources or sinks of particles within $0<v<v_{\\mathrm{esc}}$, but particles that reach $v=v_{\\mathrm{esc}}$ are lost (escape) to the ambient medium. Let the net escape be externally specified by a constant outward particle flux $\\Phi_{\\mathrm{esc}}>0$ across the spherical surface in velocity space at $v=v_{\\mathrm{esc}}$, so that $dN/dt=-\\Phi_{\\mathrm{esc}}$.\n\nGiven these conditions, choose the boundary conditions at $v=0$ and $v=v_{\\mathrm{esc}}$ that are physically consistent with:\n- regularity and isotropy at $v=0$ (no artificial source or sink at the origin of velocity space),\n- the specified escape flux $\\Phi_{\\mathrm{esc}}$ at $v=v_{\\mathrm{esc}}$,\n- particle number balance $dN/dt=-\\Phi_{\\mathrm{esc}}$ obtained from the governing equation.\n\nWhich option correctly captures these boundary conditions?\n\nA. Dirichlet conditions $f(0,t)=0$ and $f(v_{\\mathrm{esc}},t)=0$.\n\nB. Regularity at the origin enforced by $\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}=0$, and a flux boundary at escape,\n$$\n-\\,4\\pi\\,v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;\\Phi_{\\mathrm{esc}}.\n$$\n\nC. No-flux (reflecting) conditions at both ends,\n$$\n\\lim_{v\\to 0}\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\;=\\;0,\\qquad v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;0.\n$$\n\nD. Radiation-type boundary at escape,\n$$\n-\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;\\alpha\\,f(v_{\\mathrm{esc}},t),\\quad \\alpha>0,\n$$\nand finite but nonzero slope at the origin, $\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}\\neq 0$.",
            "solution": "The user wants me to identify the correct boundary conditions for a given Fokker-Planck equation describing quasilinear diffusion in velocity space.\n\nThe problem statement has been validated and is sound. I will now proceed with the solution.\n\nThe evolution of the isotropic particle distribution function $f(v,t)$ is governed by the Fokker–Planck equation:\n$$\n\\frac{\\partial f}{\\partial t} \\;=\\; \\frac{1}{v^{2}}\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]\n$$\nwhere $v$ is the particle speed, $t$ is time, and $D(v)$ is the diffusion coefficient. The domain is $v \\in [0, v_{\\mathrm{esc}}]$.\n\nThe total number of particles $N(t)$ in this domain is given by:\n$$\nN(t)\\;=\\;\\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,f(v,t)\\,dv\n$$\nTo find the boundary conditions consistent with the physical constraints, we must first relate the rate of change of $N(t)$ to the governing equation. We differentiate $N(t)$ with respect to time:\n$$\n\\frac{dN}{dt} = \\frac{d}{dt} \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,f(v,t)\\,dv\n$$\nSince the integration limits are constant, the time derivative can be moved inside the integral:\n$$\n\\frac{dN}{dt} = \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,\\frac{\\partial f}{\\partial t}\\,dv\n$$\nSubstituting the Fokker–Planck equation for $\\frac{\\partial f}{\\partial t}$:\n$$\n\\frac{dN}{dt} = \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,v^{2}\\,\\left(\\frac{1}{v^{2}}\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]\\right)\\,dv\n$$\nThe $v^2$ terms cancel, leaving:\n$$\n\\frac{dN}{dt} = \\int_{0}^{v_{\\mathrm{esc}}} 4\\pi\\,\\frac{\\partial}{\\partial v}\\!\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]\\,dv\n$$\nUsing the Fundamental Theorem of Calculus to evaluate the integral of the perfect derivative:\n$$\n\\frac{dN}{dt} = 4\\pi\\,\\left[\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\,\\right]_{v=0}^{v=v_{\\mathrm{esc}}} = 4\\pi \\left( \\left. v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}} - \\lim_{v\\to 0} \\left[ v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right] \\right)\n$$\nThis equation represents the overall particle number balance.\n\nThe particle flux in velocity space, $\\Phi(v,t)$, is the rate at which particles cross a spherical surface of radius $v$. It is defined in relation to the diffusive current $J_v = -D(v) \\frac{\\partial f}{\\partial v}$ as $\\Phi(v,t) = 4\\pi v^2 J_v$. So,\n$$\n\\Phi(v,t) = -4\\pi\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\n$$\nIn terms of this flux, the rate of change of the particle number is:\n$$\n\\frac{dN}{dt} = - \\left( \\Phi(v_{\\mathrm{esc}},t) - \\Phi(0,t) \\right)\n$$\nwhere $\\Phi(0,t) = \\lim_{v\\to 0} \\Phi(v,t)$. This equation shows that the change in particle number is the flux into the domain at $v=0$ minus the flux out of the domain at $v=v_{\\mathrm{esc}}$.\n\nNow, we apply the physical conditions given in the problem.\n\n1.  **Regularity and isotropy at $v=0$ (no source or sink at the origin):** The origin of velocity space $v=0$ is not a special source or sink of particles. This means the particle flux at the origin must be zero: $\\Phi(0,t) = 0$. Mathematically:\n    $$\n    \\lim_{v\\to 0} \\left( -4\\pi\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right) = 0\n    $$\n    For an isotropic and regular (smooth) distribution function at the origin, its Taylor series expansion in $v$ can only contain even powers, i.e., $f(v,t) = a_0(t) + a_2(t)v^2 + O(v^4)$. This implies that the derivative with respect to $v$ vanishes at the origin:\n    $$\n    \\left.\\frac{\\partial f}{\\partial v}\\right|_{v=0} = 0\n    $$\n    This condition is sufficient to ensure zero flux at the origin, as $D(v)$ is smooth and thus finite at $v=0$.\n\n2.  **Specified escape flux at $v=v_{\\mathrm{esc}}$:** The problem states there is a constant outward particle flux $\\Phi_{\\mathrm{esc}} > 0$ at the boundary $v=v_{\\mathrm{esc}}$. This means the flux at this boundary must be equal to $\\Phi_{\\mathrm{esc}}$:\n    $$\n    \\Phi(v_{\\mathrm{esc}},t) = \\Phi_{\\mathrm{esc}}\n    $$\n    Substituting the definition of the flux, we get the boundary condition at $v=v_{\\mathrm{esc}}$:\n    $$\n    -\\,4\\pi\\,v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}} = \\Phi_{\\mathrm{esc}}\n    $$\n\n3.  **Consistency with $dN/dt = -\\Phi_{\\mathrm{esc}}$:** Let's check if our derived boundary conditions are consistent with the overall particle balance. Using our boundary conditions $\\Phi(0,t)=0$ and $\\Phi(v_{\\mathrm{esc}},t)=\\Phi_{\\mathrm{esc}}$ in the equation for $dN/dt$:\n    $$\n    \\frac{dN}{dt} = - (\\Phi_{\\mathrm{esc}} - 0) = -\\Phi_{\\mathrm{esc}}\n    $$\n    This perfectly matches the condition given in the problem.\n\nSo, the two physically consistent boundary conditions are:\n- At $v=0$: $\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}=0$\n- At $v=v_{\\mathrm{esc}}$: $-\\,4\\pi\\,v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}} = \\Phi_{\\mathrm{esc}}$\n\nNow we evaluate the given options.\n\n**A. Dirichlet conditions $f(0,t)=0$ and $f(v_{\\mathrm{esc}},t)=0$.**\nThe condition $f(v_{\\mathrm{esc}},t)=0$ is an absorbing boundary condition. It does not directly enforce a constant flux $\\Phi_{\\mathrm{esc}}$. The flux would depend on the gradient $\\partial f / \\partial v$ at the boundary, which is determined by the solution itself and is not guaranteed to be constant. The condition $f(0,t)=0$ is not required for regularity and could imply a source at the origin if $\\partial f/\\partial v|_{v=0} > 0$, contradicting the no-source condition. **Incorrect**.\n\n**B. Regularity at the origin enforced by $\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}=0$, and a flux boundary at escape,**\n$$\n-\\,4\\pi\\,v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;\\Phi_{\\mathrm{esc}}.\n$$\nThe condition at $v=0$ correctly represents the regularity and no-flux requirement at the origin. The condition at $v=v_{\\mathrm{esc}}$ is the mathematical statement that the particle flux equals the specified constant $\\Phi_{\\mathrm{esc}}$. These are precisely the conditions derived from first principles. **Correct**.\n\n**C. No-flux (reflecting) conditions at both ends,**\n$$\n\\lim_{v\\to 0}\\,v^{2}\\,D(v)\\,\\frac{\\partial f}{\\partial v}\\;=\\;0,\\qquad v_{\\mathrm{esc}}^{2}\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;0.\n$$\nThe condition at $v=0$ is a valid no-flux condition. However, the condition at $v=v_{\\mathrm{esc}}$ implies that the flux at the escape boundary is zero, i.e., $\\Phi(v_{\\mathrm{esc}},t)=0$. This is a reflecting boundary, which conserves particles within the domain ($dN/dt = 0$). This contradicts the problem statement that particles escape with a flux $\\Phi_{\\mathrm{esc}}>0$ and $dN/dt = -\\Phi_{\\mathrm{esc}}$. **Incorrect**.\n\n**D. Radiation-type boundary at escape,**\n$$\n-\\,D(v_{\\mathrm{esc}})\\,\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=v_{\\mathrm{esc}}}\\;=\\;\\alpha\\,f(v_{\\mathrm{esc}},t),\\quad \\alpha>0,\n$$\n**and finite but nonzero slope at the origin, $\\left.\\dfrac{\\partial f}{\\partial v}\\right|_{v=0}\\neq 0$.**\nA nonzero slope at the origin, $\\left.\\frac{\\partial f}{\\partial v}\\right|_{v=0}\\neq 0$, violates the regularity condition for an isotropic distribution, implying a cusp at $v=0$. This would generally lead to a source or sink at the origin, which is forbidden. The radiation-type condition at $v=v_{\\mathrm{esc}}$ implies a flux $\\Phi(v_{\\mathrm{esc}},t) = 4\\pi v_{\\mathrm{esc}}^2 \\alpha f(v_{\\mathrm{esc}},t)$. For this flux to be a constant $\\Phi_{\\mathrm{esc}}$, $f(v_{\\mathrm{esc}},t)$ would have to be constant, which is not generally true for a time-evolving system. This condition does not enforce a constant escape flux. **Incorrect**.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "A key goal of kinetic theory is to predict the evolution of macroscopic quantities, such as current density or pressure, from the underlying microscopic dynamics of the particle distribution function. This exercise  provides a classic example of this connection by asking you to calculate the relaxation of an electric current due to pitch-angle scattering. You will practice the powerful technique of taking moments of the kinetic equation to derive a law for a macroscopic observable, directly linking the quasilinear diffusion coefficient to a measurable decay time.",
            "id": "4225141",
            "problem": "Consider a spatially uniform, magnetized astrophysical plasma with a straight, uniform magnetic field. Electrons are assumed to be gyrotropic and to occupy a thin shell in speed space at fixed speed $v$, so their distribution function can be written as $g(\\mu,t)$, where $\\mu \\equiv v_{\\parallel}/v \\in [-1,1]$ is the pitch-angle cosine. The plasma is weakly turbulent with small-amplitude, parallel-propagating waves that resonantly scatter electrons in pitch angle. In the weak turbulence limit, QuasiLinear (QL) theory reduces the kinetic evolution in pitch-angle cosine to a Fokker–Planck (FP) diffusion equation of the form\n$$\n\\frac{\\partial g}{\\partial t} = \\frac{\\partial}{\\partial \\mu}\\left[(1-\\mu^{2})\\,D_{0}\\,\\frac{\\partial g}{\\partial \\mu}\\right],\n$$\nwhere $D_{0}$ is a positive constant parameterizing the pitch-angle diffusion strength. There are no sources or sinks, and the pitch-angle flux vanishes at the boundaries, so that $(1-\\mu^{2})\\,\\partial g/\\partial \\mu = 0$ at $\\mu = \\pm 1$. The initial pitch-angle distribution is normalized and given by\n$$\ng(\\mu,0) = \\frac{1}{2}\\left(1 + 3A\\,\\mu\\right),\n$$\nwith $|A|<1$, so that $\\int_{-1}^{1} g(\\mu,0)\\,d\\mu = 1$. The electron number density is $n_{e}$ and the elementary charge is $e$.\n\nDefine the parallel current density\n$$\nj(t) \\equiv -\\,e\\,n_{e}\\,v \\int_{-1}^{1} \\mu\\,g(\\mu,t)\\,d\\mu.\n$$\nStarting from the FP equation above and the stated boundary conditions, derive the temporal evolution of $j(t)$ and determine the time $\\tau_{1/2}$ at which the current density has relaxed to one half of its initial value, $j(\\tau_{1/2}) = \\frac{1}{2}j(0)$. Express your final answer as a closed-form expression in terms of $D_{0}$ only. No numerical evaluation is required, and no rounding is necessary. Provide your answer without units in the final boxed expression.",
            "solution": "The problem asks for the time $\\tau_{1/2}$ at which the parallel current density $j(t)$ decays to half of its initial value. The current density is defined as:\n$$\nj(t) = -e\\,n_{e}\\,v \\int_{-1}^{1} \\mu\\,g(\\mu,t)\\,d\\mu\n$$\nwhere $e$ is the elementary charge, $n_e$ is the electron number density, $v$ is the electron speed, and $g(\\mu,t)$ is the pitch-angle distribution function. The evolution of $g(\\mu,t)$ is governed by the Fokker-Planck (FP) equation:\n$$\n\\frac{\\partial g}{\\partial t} = \\frac{\\partial}{\\partial \\mu}\\left[(1-\\mu^{2})\\,D_{0}\\,\\frac{\\partial g}{\\partial \\mu}\\right]\n$$\nwith no-flux boundary conditions $(1-\\mu^{2})\\,\\partial g/\\partial \\mu = 0$ at $\\mu = \\pm 1$.\n\nLet's define the first moment of the distribution function as $M_1(t)$:\n$$\nM_1(t) \\equiv \\int_{-1}^{1} \\mu\\,g(\\mu,t)\\,d\\mu\n$$\nThe current density is directly proportional to this moment: $j(t) = -e\\,n_{e}\\,v\\,M_1(t)$. To find the temporal evolution of $j(t)$, we can determine the evolution of $M_1(t)$. We differentiate $M_1(t)$ with respect to time:\n$$\n\\frac{dM_1}{dt} = \\frac{d}{dt} \\int_{-1}^{1} \\mu\\,g(\\mu,t)\\,d\\mu = \\int_{-1}^{1} \\mu\\,\\frac{\\partial g}{\\partial t}\\,d\\mu\n$$\nSubstitute the FP equation for $\\partial g/\\partial t$:\n$$\n\\frac{dM_1}{dt} = \\int_{-1}^{1} \\mu\\,\\frac{\\partial}{\\partial \\mu}\\left[D_{0}(1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu}\\right]\\,d\\mu\n$$\nWe perform integration by parts, $\\int u\\,dv = [uv] - \\int v\\,du$, with $u = \\mu$ and $dv = \\frac{\\partial}{\\partial \\mu}\\left[D_{0}(1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu}\\right]\\,d\\mu$. This gives $du = d\\mu$ and $v = D_{0}(1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu}$.\n$$\n\\frac{dM_1}{dt} = \\left[ \\mu\\,D_{0}(1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu} \\right]_{-1}^{1} - \\int_{-1}^{1} D_{0}(1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu}\\,d\\mu\n$$\nThe boundary term vanishes because the factor $(1-\\mu^2)$ is zero at $\\mu = \\pm 1$. This is consistent with the stated no-flux boundary conditions.\n$$\n\\frac{dM_1}{dt} = -D_{0} \\int_{-1}^{1} (1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu}\\,d\\mu\n$$\nWe apply integration by parts a second time to the remaining integral. Let $u = (1-\\mu^2)$ and $dv = (\\partial g/\\partial \\mu)\\,d\\mu$. This gives $du = -2\\mu\\,d\\mu$ and $v = g(\\mu,t)$.\n$$\n\\int_{-1}^{1} (1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu}\\,d\\mu = \\left[ (1-\\mu^2)g(\\mu,t) \\right]_{-1}^{1} - \\int_{-1}^{1} g(\\mu,t)\\,(-2\\mu)\\,d\\mu\n$$\nAgain, the boundary term is zero.\n$$\n\\int_{-1}^{1} (1-\\mu^{2})\\,\\frac{\\partial g}{\\partial \\mu}\\,d\\mu = 2 \\int_{-1}^{1} \\mu\\,g(\\mu,t)\\,d\\mu = 2\\,M_1(t)\n$$\nSubstituting this result back into the equation for $dM_1/dt$:\n$$\n\\frac{dM_1}{dt} = -D_{0} \\left( 2\\,M_1(t) \\right) = -2\\,D_{0}\\,M_1(t)\n$$\nThis is a first-order linear ordinary differential equation for $M_1(t)$. The solution is an exponential decay:\n$$\nM_1(t) = M_1(0)\\,\\exp(-2\\,D_{0}\\,t)\n$$\nWe find the initial value $M_1(0)$ from the initial distribution $g(\\mu,0) = \\frac{1}{2}(1 + 3A\\,\\mu)$:\n$$\nM_1(0) = \\int_{-1}^{1} \\mu\\,g(\\mu,0)\\,d\\mu = \\int_{-1}^{1} \\mu\\,\\frac{1}{2}(1 + 3A\\,\\mu)\\,d\\mu\n$$\n$$\nM_1(0) = \\frac{1}{2}\\int_{-1}^{1} (\\mu + 3A\\,\\mu^2)\\,d\\mu = \\frac{1}{2} \\left[ \\frac{\\mu^2}{2} + 3A\\,\\frac{\\mu^3}{3} \\right]_{-1}^{1} = \\frac{1}{2} \\left[ \\frac{\\mu^2}{2} + A\\,\\mu^3 \\right]_{-1}^{1}\n$$\n$$\nM_1(0) = \\frac{1}{2} \\left( \\left(\\frac{1}{2} + A\\right) - \\left(\\frac{(-1)^2}{2} + A(-1)^3\\right) \\right) = \\frac{1}{2} \\left( \\left(\\frac{1}{2} + A\\right) - \\left(\\frac{1}{2} - A\\right) \\right) = \\frac{1}{2}(2A) = A\n$$\nSo, the time evolution of the first moment is $M_1(t) = A\\,\\exp(-2\\,D_{0}\\,t)$. The current density is therefore:\n$$\nj(t) = -e\\,n_{e}\\,v\\,A\\,\\exp(-2\\,D_{0}\\,t)\n$$\nThe initial current density is $j(0) = -e\\,n_{e}\\,v\\,A$. We need to find the time $\\tau_{1/2}$ such that $j(\\tau_{1/2}) = \\frac{1}{2}j(0)$. Assuming $A \\neq 0$ (otherwise $j(t)=0$ for all $t$), we can write:\n$$\n-e\\,n_{e}\\,v\\,A\\,\\exp(-2\\,D_{0}\\,\\tau_{1/2}) = \\frac{1}{2}(-e\\,n_{e}\\,v\\,A)\n$$\nDividing both sides by $-e\\,n_{e}\\,v\\,A$:\n$$\n\\exp(-2\\,D_{0}\\,\\tau_{1/2}) = \\frac{1}{2}\n$$\nTaking the natural logarithm of both sides:\n$$\n-2\\,D_{0}\\,\\tau_{1/2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\nFinally, solving for $\\tau_{1/2}$:\n$$\n\\tau_{1/2} = \\frac{\\ln(2)}{2\\,D_{0}}\n$$\nThis is the time at which the current density relaxes to one half of its initial value. It depends only on the diffusion coefficient parameter $D_0$.",
            "answer": "$$\\boxed{\\frac{\\ln(2)}{2 D_0}}$$"
        },
        {
            "introduction": "While analytical solutions offer profound insight, most real-world plasma physics problems are tackled with numerical simulations. This final practice  guides you through the process of building a numerical solver for the quasilinear diffusion equation, translating the continuous partial differential equation into a discrete algorithm. By implementing a conservative finite-volume scheme and verifying its properties, you will gain invaluable hands-on experience with the methods that form the backbone of modern computational plasma physics.",
            "id": "4225149",
            "problem": "Consider a spatially homogeneous, weakly turbulent, collisionless astrophysical plasma in which resonant wave–particle interactions lead to quasilinear diffusion in one-dimensional velocity space. Under Quasilinear Theory (QLT), the evolution of the gyro-averaged, pitch-angle integrated distribution function is modeled by a Fokker–Planck-type diffusion equation in velocity space. Let the distribution function be denoted by $f(v,t)$, where $v$ is the one-dimensional velocity coordinate normalized to a thermal speed and $t$ is time normalized to a characteristic scattering time, so that all quantities are dimensionless. The governing equation is\n$$\n\\frac{\\partial f(v,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial v} \\left[ D(v) \\,\\frac{\\partial f(v,t)}{\\partial v} \\right]\n$$\nwith zero diffusive flux boundary conditions at the domain endpoints $v_{\\min}$ and $v_{\\max}$,\n$$\n\\left. -\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right|_{v=v_{\\min}} \\;=\\; 0, \\qquad \\left. -\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\right|_{v=v_{\\max}} \\;=\\; 0.\n$$\nYou must design and implement a conservative finite-volume discretization in $v$ on a uniform grid and advance the solution in time using an explicit scheme. The finite-volume update must be constructed from interface fluxes $F_{i+\\frac{1}{2}}$ that are consistent with the continuous flux $F \\equiv -\\,D(v)\\,\\partial f/\\partial v$. Let the grid have $N$ points with uniform spacing $\\Delta v$ on the interval $[v_{\\min},v_{\\max}]$, and denote cell-centered values by $f_i^n \\approx f(v_i,t^n)$. The interface diffusion coefficient $D_{i+\\frac{1}{2}}$ must be computed from adjacent cell-centered values using the arithmetic average, and the interface diffusive flux must be computed using a centered difference for the gradient. The boundary conditions must be imposed by zero fluxes at the domain boundaries. The fully discrete finite-volume update is required to be of the form\n$$\nf_i^{n+1} \\;=\\; f_i^{n} \\;-\\; \\frac{\\Delta t}{\\Delta v} \\,\\Big( F_{i+\\frac{1}{2}}^{n} \\;-\\; F_{i-\\frac{1}{2}}^{n} \\Big),\n$$\nwith\n$$\nF_{i+\\frac{1}{2}}^{n} \\;=\\; -\\,D_{i+\\frac{1}{2}} \\,\\frac{f_{i+1}^{n} - f_{i}^{n}}{\\Delta v}, \\qquad D_{i+\\frac{1}{2}} \\;=\\; \\frac{D_i + D_{i+1}}{2}.\n$$\nTo ensure numerical stability and positivity for explicit diffusion, the time step must satisfy a sufficient condition based on the maximum of $D(v)$ over the domain,\n$$\n\\Delta t \\;\\le\\; \\frac{\\Delta v^2}{2 \\,\\max_{v \\in [v_{\\min},v_{\\max}]} D(v)}.\n$$\nYour program must implement this scheme and run the following test suite, each test being described by a set of parameters. All quantities are dimensionless, so no physical units are required.\n\nTest Suite:\n- Test case $1$ (mass conservation under constant diffusion):\n  - Domain endpoints: $v_{\\min} = -\\,4$, $v_{\\max} = 4$.\n  - Grid: $N = 201$ uniformly spaced points, so $\\Delta v = (v_{\\max} - v_{\\min})/(N-1)$.\n  - Initial condition: $f_0(v) = \\exp(-\\,v^2)$.\n  - Diffusion coefficient: $D(v) = D_0$ with $D_0 = 0.1$.\n  - Time step: $\\Delta t = 0.5 \\,\\Delta v^2 / D_0$.\n  - Number of time steps: $n_{\\text{steps}} = 250$.\n  - Boundary conditions: zero flux at $v_{\\min}$ and $v_{\\max}$.\n  - Output for this test: the relative mass deviation after evolution,\n    $$\n    R_1 \\;=\\; \\frac{M_{\\text{final}} - M_{\\text{initial}}}{M_{\\text{initial}}},\n    \\quad \\text{where} \\quad\n    M = \\sum_{i=0}^{N-1} f_i \\,\\Delta v.\n    $$\n- Test case $2$ (zero-flux boundary enforcement under velocity-dependent diffusion):\n  - Domain endpoints: $v_{\\min} = -\\,4$, $v_{\\max} = 4$.\n  - Grid: $N = 201$ uniformly spaced points.\n  - Initial condition: $f_0(v) = \\exp\\!\\big(-\\,(v-1)^2\\big)$.\n  - Diffusion coefficient: $D(v) = \\dfrac{D_0}{1+v^2}$ with $D_0 = 0.2$.\n  - Time step: $\\Delta t = 0.45 \\,\\Delta v^2 / \\max_v D(v)$.\n  - Number of time steps: $n_{\\text{steps}} = 1$.\n  - Boundary conditions: zero flux at $v_{\\min}$ and $v_{\\max}$.\n  - Output for this test: the mean absolute value of the boundary fluxes computed by the scheme at the two domain boundaries in the performed step,\n    $$\n    R_2 \\;=\\; \\frac{1}{2}\\,\\Big( \\big|F_{-\\frac{1}{2}}\\big| \\;+\\; \\big|F_{N-\\frac{1}{2}}\\big| \\Big),\n    $$\n    where $F_{-\\frac{1}{2}}$ and $F_{N-\\frac{1}{2}}$ denote the left and right boundary fluxes respectively. Under perfect enforcement they should be $0$, and numerically they should be very close to $0$.\n- Test case $3$ (positivity under strongly inhomogeneous diffusion):\n  - Domain endpoints: $v_{\\min} = -\\,4$, $v_{\\max} = 4$.\n  - Grid: $N = 201$ uniformly spaced points.\n  - Initial condition: top-hat profile $f_0(v) = 1$ for $\\lvert v \\rvert \\le 1$ and $f_0(v) = 0$ otherwise.\n  - Diffusion coefficient: $D(v) = D_0\\,v^2$ with $D_0 = 0.05$.\n  - Time step: $\\Delta t = 0.9 \\,\\Delta v^2 \\big/ \\big(2 \\,\\max_v D(v)\\big)$.\n  - Number of time steps: $n_{\\text{steps}} = 300$.\n  - Boundary conditions: zero flux at $v_{\\min}$ and $v_{\\max}$.\n  - Output for this test: a boolean $R_3$ indicating whether $f_i^{n} \\ge 0$ for all grid points after evolution.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[R_1, R_2, R_3]$. For example, the output should look like $[r_1,r_2,r_3]$, where $r_1$ and $r_2$ are floating-point numbers and $r_3$ is a boolean.",
            "solution": "The user has provided a problem that requires the design and implementation of a numerical scheme to solve the one-dimensional quasilinear diffusion equation, which models wave-particle interactions in a collisionless astrophysical plasma. The problem is scientifically grounded, well-posed, and provides all necessary information to construct a unique, verifiable solution. The problem is valid.\n\nThe governing partial differential equation (PDE) for the distribution function $f(v,t)$ is:\n$$\n\\frac{\\partial f(v,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial v} \\left[ D(v) \\,\\frac{\\partial f(v,t)}{\\partial v} \\right]\n$$\nThis equation is defined on a one-dimensional velocity domain $v \\in [v_{\\min}, v_{\\max}]$. The boundary conditions are of the zero-flux (Neumann) type, meaning that no particles escape the domain:\n$$\nF(v) \\equiv -\\,D(v)\\,\\frac{\\partial f}{\\partial v} \\bigg|_{v=v_{\\min}, v_{\\max}} \\;=\\; 0\n$$\nTo solve this equation numerically, we will implement the specified finite-volume method.\n\n**1. Discretization**\n\nThe continuous velocity domain $[v_{\\min}, v_{\\max}]$ is discretized into $N$ points, $v_i$, with uniform spacing $\\Delta v$. These points are treated as the centers of $N$ control volumes (or cells). The grid points are given by:\n$$\nv_i \\;=\\; v_{\\min} \\,+\\, i\\,\\Delta v, \\qquad \\text{for } i = 0, 1, \\dots, N-1\n$$\nwhere the grid spacing is $\\Delta v = (v_{\\max} - v_{\\min}) / (N-1)$. The cell $C_i$ associated with the point $v_i$ is the interval $[v_i - \\Delta v/2, v_i + \\Delta v/2]$. The discrete value $f_i^n$ represents the cell-averaged value of the distribution function in cell $C_i$ at time $t^n = n\\,\\Delta t$.\n\nThe finite-volume method is derived by integrating the PDE over a control volume $C_i$:\n$$\n\\int_{v_i - \\Delta v/2}^{v_i + \\Delta v/2} \\frac{\\partial f}{\\partial t} \\, dv \\;=\\; \\int_{v_i - \\Delta v/2}^{v_i + \\Delta v/2} \\frac{\\partial}{\\partial v} \\left[ D(v) \\frac{\\partial f}{\\partial v} \\right] \\, dv\n$$\nApproximating the time derivative and applying the fundamental theorem of calculus to the right-hand side yields:\n$$\n\\Delta v \\frac{f_i^{n+1} - f_i^n}{\\Delta t} \\;\\approx\\; \\left[ -D \\frac{\\partial f}{\\partial v} \\right]_{v_i + \\Delta v/2} - \\left[ -D \\frac{\\partial f}{\\partial v} \\right]_{v_i - \\Delta v/2}\n$$\nThe terms on the right are the diffusive fluxes $F$ at the cell interfaces. Let $F_{i+1/2}^n$ denote the flux at the interface between cell $i$ and cell $i+1$, located at $v = v_i + \\Delta v/2$. The equation becomes:\n$$\n\\frac{f_i^{n+1} - f_i^n}{\\Delta t} \\;=\\; \\frac{F_{i+1/2}^n - F_{i-1/2}^n}{\\Delta v}\n$$\nRearranging gives the explicit time-update formula specified in the problem:\n$$\nf_i^{n+1} \\;=\\; f_i^n \\,-\\, \\frac{\\Delta t}{\\Delta v} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right)\n$$\nThis update rule holds for the interior cells, i.e., for $i = 1, \\dots, N-2$. Special care is required for the boundary cells $i=0$ and $i=N-1$.\n\n**2. Flux Calculation and Boundary Conditions**\n\nThe problem specifies how to approximate the fluxes at the interfaces. The flux $F_{i+1/2}^n$ is computed using a centered difference for the gradient and an arithmetic average for the diffusion coefficient:\n$$\nF_{i+1/2}^n \\;=\\; -D_{i+1/2} \\frac{f_{i+1}^n - f_i^n}{\\Delta v}, \\quad \\text{where} \\quad D_{i+1/2} = \\frac{D(v_i) + D(v_{i+1})}{2} = \\frac{D_i + D_{i+1}}{2}\n$$\nThis formula applies to the internal interfaces for $i = 0, \\dots, N-2$.\n\nThe zero-flux boundary conditions are imposed at the edges of the full numerical domain, which are at $v_0 - \\Delta v/2$ and $v_{N-1} + \\Delta v/2$. These correspond to the locations of the fluxes $F_{-1/2}$ and $F_{N-1/2}$. The condition is enforced by setting these boundary fluxes to zero for all time steps $n$:\n$$\nF_{-1/2}^n \\;=\\; 0, \\qquad F_{N-1/2}^n \\;=\\; 0\n$$\nWith these boundary fluxes, the update rules for the first and last cells become:\n- For $i=0$: $f_0^{n+1} = f_0^n - \\frac{\\Delta t}{\\Delta v} \\left( F_{1/2}^n - F_{-1/2}^n \\right) = f_0^n - \\frac{\\Delta t}{\\Delta v} F_{1/2}^n$\n- For $i=N-1$: $f_{N-1}^{n+1} = f_{N-1}^n - \\frac{\\Delta t}{\\Delta v} \\left( F_{N-1/2}^n - F_{N-3/2}^n \\right) = f_{N-1}^n + \\frac{\\Delta t}{\\Delta v} F_{N-3/2}^n$\n\n**3. Time Step and Stability**\n\nThe explicit scheme is conditionally stable. The problem provides a sufficient condition for stability and positivity:\n$$\n\\Delta t \\;\\le\\; \\frac{\\Delta v^2}{2 \\max_{v \\in [v_{\\min},v_{\\max}]} D(v)}\n$$\nEach test case specifies a time step $\\Delta t$ that adheres to this criterion.\n\n**4. Implementation of Test Cases**\n\nThe numerical scheme is implemented in a Python function that executes the time-stepping loop. This function is then called for each of the three test cases with the specified parameters.\n\n- **Test Case 1 (Mass Conservation):** The total mass is defined as $M = \\int f(v,t) dv$, approximated numerically by the sum $M \\approx \\sum_{i=0}^{N-1} f_i \\Delta v$. A conservative numerical scheme should preserve this quantity to within machine precision. The relative mass deviation $R_1 = (M_{\\text{final}} - M_{\\text{initial}}) / M_{\\text{initial}}$ is calculated after $n_{\\text{steps}} = 250$.\n\n- **Test Case 2 (Boundary Flux Enforcement):** The scheme imposes zero flux at the boundaries by setting $F_{-1/2}$ and $F_{N-1/2}$ to $0$ directly. The output $R_2$ is the mean absolute value of these imposed fluxes: $R_2 = \\frac{1}{2}(\\lvert F_{-1/2} \\rvert + \\lvert F_{N-1/2} \\rvert)$. By design, this value is exactly $0$.\n\n- **Test Case 3 (Positivity):** The distribution function $f(v,t)$ is a probability density and must remain non-negative. The chosen time step respects the stability condition, which is also sufficient to ensure positivity. The simulation is run for $n_{\\text{steps}} = 300$, and the final distribution $f_i^{n_{\\text{steps}}}$ is checked for non-negativity at all grid points. The boolean result $R_3$ will be `True` if all $f_i \\ge 0$. A small floating-point tolerance is used in the check to account for potential round-off errors.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(v_min, v_max, N, f0_func, D_func, dt, n_steps):\n    \"\"\"\n    Solves the 1D quasilinear diffusion equation using a finite-volume scheme.\n\n    Args:\n        v_min (float): Minimum velocity in the domain.\n        v_max (float): Maximum velocity in the domain.\n        N (int): Number of grid points.\n        f0_func (callable): Function to compute the initial distribution f(v).\n        D_func (callable): Function to compute the diffusion coefficient D(v).\n        dt (float): Time step.\n        n_steps (int): Number of time steps to perform.\n\n    Returns:\n        tuple[np.ndarray, np.ndarray]: A tuple containing the initial and final\n                                       distribution functions.\n    \"\"\"\n    # 1. Grid setup\n    v = np.linspace(v_min, v_max, N)\n    dv = v[1] - v[0]\n\n    # 2. Initialization\n    f = f0_func(v)\n    f_initial = f.copy()\n    D_v = D_func(v)\n\n    # 3. Time evolution loop\n    for _ in range(n_steps):\n        # Calculate diffusion coefficients at cell interfaces (D_{i+1/2})\n        D_interface = (D_v[:-1] + D_v[1:]) / 2.0\n        \n        # Calculate diffusive fluxes at internal interfaces (F_{i+1/2} for i=0..N-2)\n        F_internal = -D_interface * (f[1:] - f[:-1]) / dv\n        \n        # Assemble the full flux array, including boundary fluxes\n        # F represents [F_{-1/2}, F_{1/2}, ..., F_{N-3/2}, F_{N-1/2}]\n        F = np.zeros(N + 1)\n        F[1:-1] = F_internal\n        \n        # Impose zero-flux boundary conditions\n        F[0] = 0.0\n        F[-1] = 0.0\n        \n        # Calculate the divergence of the flux at cell centers\n        # flux_diff[i] = F_{i+1/2} - F_{i-1/2}\n        flux_diff = F[1:] - F[:-1]\n        \n        # Update the distribution function using an explicit time step\n        f = f - (dt / dv) * flux_diff\n\n    return f_initial, f\n\ndef solve():\n    \"\"\"\n    Runs the full test suite and prints the final results.\n    \"\"\"\n    results = []\n\n    # Test Case 1: Mass conservation\n    v_min1, v_max1 = -4.0, 4.0\n    N1 = 201\n    dv1 = (v_max1 - v_min1) / (N1 - 1)\n    f0_func1 = lambda v: np.exp(-v**2)\n    D0_1 = 0.1\n    D_func1 = lambda v: np.full_like(v, D0_1)\n    dt1 = 0.5 * dv1**2 / D0_1\n    n_steps1 = 250\n\n    f_initial1, f_final1 = run_simulation(\n        v_min1, v_max1, N1, f0_func1, D_func1, dt1, n_steps1\n    )\n    M_initial1 = np.sum(f_initial1) * dv1\n    M_final1 = np.sum(f_final1) * dv1\n    R1 = (M_final1 - M_initial1) / M_initial1\n    results.append(R1)\n\n    # Test Case 2: Zero-flux boundary enforcement\n    # The scheme imposes F_{-1/2} = 0 and F_{N-1/2} = 0 by definition.\n    # The output is the mean absolute value of these fluxes.\n    F_left_boundary = 0.0\n    F_right_boundary = 0.0\n    R2 = 0.5 * (np.abs(F_left_boundary) + np.abs(F_right_boundary))\n    results.append(R2)\n\n    # Test Case 3: Positivity\n    v_min3, v_max3 = -4.0, 4.0\n    N3 = 201\n    v3 = np.linspace(v_min3, v_max3, N3)\n    dv3 = v3[1] - v3[0]\n    f0_func3 = lambda v: np.where(np.abs(v) <= 1, 1.0, 0.0)\n    D0_3 = 0.05\n    D_func3 = lambda v: D0_3 * v**2\n    D_v3 = D_func3(v3)\n    max_D3 = np.max(D_v3)\n    dt3 = 0.9 * dv3**2 / (2 * max_D3)\n    n_steps3 = 300\n\n    _, f_final3 = run_simulation(\n        v_min3, v_max3, N3, f0_func3, D_func3, dt3, n_steps3\n    )\n    # Check if all values are non-negative, allowing for small floating-point errors\n    R3 = bool(np.all(f_final3 >= -1e-15))\n    results.append(R3)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{results[0]},{results[1]},{results[2]}]\")\n\nsolve()\n```"
        }
    ]
}