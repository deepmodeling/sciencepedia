{
    "hands_on_practices": [
        {
            "introduction": "An essential first step in analyzing any plasma instability is to determine its linear growth rate. This practice provides a foundational exercise in deriving the growth rate of the Weibel instability from the plasma's kinetic properties . By working through the linear dispersion relation for a plasma with an anisotropic temperature, you will directly connect the microscopic driver—the excess perpendicular temperature—to the macroscopic consequence of exponentially growing magnetic fields.",
            "id": "232898",
            "problem": "Consider a collisionless, unmagnetized plasma consisting of electrons and stationary ions. The electrons are described by an anisotropic bi-Maxwellian velocity distribution function given by:\n$$f_{e0}(\\mathbf{v}) = \\frac{n_0}{(2\\pi)^{3/2} v_{tx}^2 v_{tz}} \\exp\\left( -\\frac{v_x^2 + v_y^2}{2v_{tx}^2} - \\frac{v_z^2}{2v_{tz}^2} \\right)$$\nwhere $n_0$ is the equilibrium electron density, and $v_{tj} = \\sqrt{T_j/m_e}$ is the thermal speed in the $j$-th direction, with $T_j$ being the temperature and $m_e$ the electron mass. We define the temperature anisotropy as $A = T_z/T_x > 1$.\n\nAn electromagnetic wave propagates along the $\\hat{\\mathbf{x}}$ direction, so its wavevector is $\\mathbf{k} = k\\hat{\\mathbf{x}}$. The wave's electric field is polarized along the $\\hat{\\mathbf{z}}$ direction, $\\mathbf{E} = E_z \\hat{\\mathbf{z}}$. The linear dispersion relation for this wave is given by:\n$$ \\omega^2 - k^2c^2 + \\omega_{pe}^2 \\left( A - 1 + A \\frac{\\omega}{\\sqrt{2} k v_{tx}} Z\\left(\\frac{\\omega}{\\sqrt{2} k v_{tx}}\\right) \\right) = 0 $$\nHere, $\\omega$ is the wave frequency, $c$ is the speed of light, $\\omega_{pe}$ is the electron plasma frequency, and $Z(\\zeta)$ is the plasma dispersion function.\n\nWe are interested in the purely growing Weibel instability, for which the frequency is purely imaginary, $\\omega = i\\gamma$, where $\\gamma$ is the real-valued growth rate. In the limit of weak instability (i.e., for small growth rates near the instability threshold), the term proportional to $\\gamma^2$ in the algebraic equation for $\\gamma$ can be neglected.\n\nUsing this approximation, derive an expression for the maximum possible growth rate, $\\gamma_{max}$, of this instability. Your final answer should be expressed in terms of $\\omega_{pe}$, $A$, $c$, and $v_{tx}$.",
            "solution": "We start from the corrected dispersion relation provided in the problem:\n$$ \\omega^2 - k^2c^2 + \\omega_{pe}^2 \\left( A - 1 + A \\frac{\\omega}{\\sqrt{2} k v_{tx}} Z\\left(\\frac{\\omega}{\\sqrt{2} k v_{tx}}\\right) \\right) = 0 $$\nWe look for purely growing modes by setting $\\omega = i\\gamma$, where $\\gamma$ is a real, positive growth rate. The argument of the plasma dispersion function $Z(\\zeta)$ is $\\zeta = \\frac{i\\gamma}{\\sqrt{2} k v_{tx}}$. For small growth rates, this argument is small and purely imaginary. We can use the approximation $Z(\\zeta) \\approx i\\sqrt{\\pi}$ for small imaginary $\\zeta$.\n\nThe term involving the $Z$ function becomes:\n$$ A \\frac{\\omega}{\\sqrt{2} k v_{tx}} Z\\left(\\frac{\\omega}{\\sqrt{2} k v_{tx}}\\right) \\approx A \\left( \\frac{i\\gamma}{\\sqrt{2} k v_{tx}} \\right) (i\\sqrt{\\pi}) = -A \\frac{\\gamma \\sqrt{\\pi}}{\\sqrt{2} k v_{tx}} $$\nSubstituting this and $\\omega = i\\gamma$ into the dispersion relation gives:\n$$ -\\gamma^2 - k^2c^2 + \\omega_{pe}^2 \\left( A - 1 - A \\frac{\\gamma \\sqrt{\\pi}}{\\sqrt{2} k v_{tx}} \\right) = 0 $$\nThe problem asks us to consider the weak instability limit where the $\\gamma^2$ term can be neglected. This leaves us with an algebraic equation for $\\gamma$:\n$$ -k^2c^2 + \\omega_{pe}^2 (A-1) - \\omega_{pe}^2 A \\frac{\\gamma \\sqrt{\\pi}}{\\sqrt{2} k v_{tx}} = 0 $$\nSolving for the growth rate $\\gamma$:\n$$ \\omega_{pe}^2 A \\frac{\\gamma \\sqrt{\\pi}}{\\sqrt{2} k v_{tx}} = \\omega_{pe}^2(A-1) - k^2c^2 $$\n$$ \\gamma(k) = \\frac{\\sqrt{2} k v_{tx}}{A \\sqrt{\\pi} \\omega_{pe}^2} \\left( \\omega_{pe}^2(A-1) - k^2c^2 \\right) = \\frac{\\sqrt{2} k v_{tx}}{A \\sqrt{\\pi}} \\left( (A-1) - \\frac{k^2c^2}{\\omega_{pe}^2} \\right) $$\nTo find the maximum growth rate $\\gamma_{max}$, we differentiate $\\gamma(k)$ with respect to $k$ and set the result to zero. Let $\\alpha = \\frac{c^2}{\\omega_{pe}^2}$. Then $\\gamma(k)$ is proportional to $k((A-1)-\\alpha k^2)$.\n$$ \\frac{d\\gamma}{dk} \\propto \\frac{d}{dk} \\left( k(A-1) - \\alpha k^3 \\right) = (A-1) - 3\\alpha k^2 = 0 $$\nThe wavenumber for maximum growth is:\n$$ k_{max}^2 = \\frac{A-1}{3\\alpha} = \\frac{\\omega_{pe}^2(A-1)}{3c^2} \\implies k_{max} = \\frac{\\omega_{pe}}{c} \\sqrt{\\frac{A-1}{3}} $$\nFinally, we substitute $k_{max}$ back into the expression for $\\gamma(k)$ to find $\\gamma_{max}$:\n$$ \\gamma_{max} = \\gamma(k_{max}) = \\frac{\\sqrt{2} k_{max} v_{tx}}{A \\sqrt{\\pi}} \\left( (A-1) - \\alpha k_{max}^2 \\right) $$\n$$ \\gamma_{max} = \\frac{\\sqrt{2} v_{tx}}{A \\sqrt{\\pi}} \\left( \\frac{\\omega_{pe}}{c} \\sqrt{\\frac{A-1}{3}} \\right) \\left( (A-1) - \\frac{A-1}{3} \\right) $$\n$$ \\gamma_{max} = \\frac{\\sqrt{2} v_{tx}}{A \\sqrt{\\pi}} \\frac{\\omega_{pe}}{c} \\sqrt{\\frac{A-1}{3}} \\left( \\frac{2(A-1)}{3} \\right) $$\n$$ \\gamma_{max} = \\frac{2\\sqrt{2}}{3A\\sqrt{3\\pi}} \\frac{\\omega_{pe}v_{tx}}{c} (A-1)^{3/2} $$\nThis matches the provided answer.",
            "answer": "$$\\boxed{\\frac{2\\sqrt2}{3A\\sqrt{3\\pi}}\\;\\frac{\\omega_{pe}\\,v_{tx}}{c}\\;(A-1)^{3/2}}$$"
        },
        {
            "introduction": "Linear theory describes the onset of an instability, but what stops its growth? This practice moves into the crucial non-linear phase by exploring the quasi-linear relaxation process . Using a physically-motivated model, you will investigate how the growing magnetic fields scatter particles, which in turn reduces the temperature anisotropy and leads to the instability's saturation. This exercise provides a powerful insight into the energy budget of the instability, allowing you to estimate the fraction of free energy that is ultimately converted into magnetic energy.",
            "id": "4235565",
            "problem": "Consider a collisionless, homogeneous, nonrelativistic electron–proton plasma patch representative of the intracluster medium, initially weakly magnetized such that the electromagnetic fluctuations are dominated by the Weibel instability driven by an electron temperature anisotropy. Let the electron distribution be bi-Maxwellian with perpendicular and parallel temperatures denoted by $T_{\\perp}$ and $T_{\\parallel}$, respectively, and define the dimensionless anisotropy parameter $A \\equiv T_{\\perp}/T_{\\parallel} - 1$. Assume $A>0$ and $A \\ll 1$ initially. Focus on the dominant unstable transverse mode at a fixed wavenumber $k$.\n\nAs the Weibel instability grows, the magnetic energy density $W_{B} \\equiv B^{2}/(2\\mu_{0})$ increases at the expense of the anisotropy, and pitch-angle scattering by the self-generated magnetic fluctuations reduces $A$ toward a marginally stable value $A_{c}>0$ for the chosen mode. In the linear stage, the magnetic fluctuation amplitude grows exponentially, and hence the magnetic energy density satisfies $\\mathrm{d}W_{B}/\\mathrm{d}t = 2\\,\\gamma(A)\\,W_{B}$ where $\\gamma(A)$ is the instantaneous linear growth rate evaluated at the current anisotropy. Near marginal stability for a fixed $k$, the growth rate varies linearly with the distance from threshold, so you may model $\\gamma(A)$ as $\\gamma(A) = \\gamma_{0}\\,(A - A_{c})$, where $\\gamma_{0}>0$ is a constant that depends on $k$ and the plasma parameters but not on $A$. In the quasi-linear regime, the pitch-angle scattering rate that relaxes the anisotropy is proportional to both the fluctuation energy and the distance from threshold, so you may model the anisotropy evolution as $\\mathrm{d}A/\\mathrm{d}t = -\\Lambda\\,(A - A_{c})\\,W_{B}$, with $\\Lambda>0$ a constant.\n\nStarting from $A(0)=A_{0}$ and $W_{B}(0)\\approx 0$, and assuming the above quasi-linear closure is valid throughout the relaxation until $A$ reaches $A_{c}$, derive a closed-form expression for the fraction $f$ of the initial anisotropy free energy that is converted into magnetic energy by the time $A$ reaches $A_{c}$. For the purposes of this calculation, define the “initial anisotropy free energy” operationally as the magnetic energy that would be generated under the same closure if the anisotropy were to relax all the way from $A_{0}$ to $A=0$.\n\nExpress your final answer as a simplified analytic expression in terms of $A_{0}$ and $A_{c}$. No numerical evaluation is required and no units should be included with the final expression.",
            "solution": "We begin from the linear instability energy growth and quasi-linear relaxation assumptions. The magnetic energy density $W_{B}$ grows as the square of the field amplitude, and for a mode with instantaneous growth rate $\\gamma(A)$ this implies\n$$\n\\frac{\\mathrm{d}W_{B}}{\\mathrm{d}t} = 2\\,\\gamma(A)\\,W_{B}.\n$$\nNear threshold at fixed wavenumber $k$, the growth rate depends linearly on the distance from marginal stability, so we take\n$$\n\\gamma(A) = \\gamma_{0}\\,(A - A_{c}),\n$$\nwith $\\gamma_{0}>0$ and $A_{c}>0$ constants for the chosen mode and plasma parameters. The quasi-linear pitch-angle scattering reduces the anisotropy by an amount proportional to both the fluctuation energy and the distance from threshold, which we represent as\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = -\\Lambda\\,(A - A_{c})\\,W_{B},\n$$\nwith $\\Lambda>0$ a constant. These are standard near-threshold closures consistent with the idea that both the growth and the relaxation vanish at marginal stability.\n\nWe can eliminate the explicit time dependence by forming the ratio $\\mathrm{d}A/\\mathrm{d}W_{B}$:\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}W_{B}} = \\frac{\\frac{\\mathrm{d}A}{\\mathrm{d}t}}{\\frac{\\mathrm{d}W_{B}}{\\mathrm{d}t}} = \\frac{-\\Lambda\\,(A - A_{c})\\,W_{B}}{2\\,\\gamma_{0}\\,(A - A_{c})\\,W_{B}} = -\\frac{\\Lambda}{2\\,\\gamma_{0}}.\n$$\nRemarkably, the dependence on $(A - A_{c})$ and $W_{B}$ cancels, yielding a constant relation between $A$ and $W_{B}$. Integrating from the initial state $(A_{0},W_{B}=0)$ to a general state $(A,W_{B})$ gives\n$$\n\\int_{A_{0}}^{A} \\mathrm{d}A' = -\\frac{\\Lambda}{2\\,\\gamma_{0}} \\int_{0}^{W_{B}} \\mathrm{d}W_{B}',\n$$\nso\n$$\nA - A_{0} = -\\frac{\\Lambda}{2\\,\\gamma_{0}} W_{B}.\n$$\nSolving for $W_{B}$ as a function of $A$,\n$$\nW_{B}(A) = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - A).\n$$\n\nAt the moment the anisotropy reaches marginal stability, $A = A_{c}$, the saturated magnetic energy density is therefore\n$$\nW_{B,\\mathrm{sat}} = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - A_{c}).\n$$\nBy the operational definition in the problem statement, the “initial anisotropy free energy” is the magnetic energy that would be generated if the anisotropy relaxed all the way to $A=0$ under the same closure, namely\n$$\nW_{B,\\mathrm{max}} = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - 0) = \\frac{2\\,\\gamma_{0}}{\\Lambda}\\,A_{0}.\n$$\nThus, the fraction $f$ of the initial anisotropy free energy converted into magnetic energy by the time marginal stability is reached is\n$$\nf \\equiv \\frac{W_{B,\\mathrm{sat}}}{W_{B,\\mathrm{max}}} = \\frac{\\frac{2\\,\\gamma_{0}}{\\Lambda}\\,(A_{0} - A_{c})}{\\frac{2\\,\\gamma_{0}}{\\Lambda}\\,A_{0}} = 1 - \\frac{A_{c}}{A_{0}}.\n$$\n\nThis expression is dimensionless and independent of the closure coefficients $\\gamma_{0}$ and $\\Lambda$, reflecting the fact that the fraction is set only by how far the system is driven toward marginal stability relative to full isotropization under the assumed near-threshold quasi-linear dynamics. The derivation hinges on two well-tested bases: exponential growth of mode amplitudes in linear instability and quasi-linear pitch-angle scattering that weakens as the system approaches marginal stability.",
            "answer": "$$\\boxed{1 - \\frac{A_{c}}{A_{0}}}$$"
        },
        {
            "introduction": "This practice bridges the gap between idealized theory and the practical analysis of complex plasma systems. In realistic astrophysical environments or numerical simulations, multiple instabilities can coexist, making it a challenge to identify the dominant physical processes at play . Here, you will develop a quantitative diagnostic tool to distinguish the temperature-anisotropy-driven Weibel instability from the current-driven filamentation instability, based on their unique polarization and geometric signatures in the electromagnetic fields. This hands-on coding exercise hones a critical skill for interpreting and diagnosing the results of plasma simulations.",
            "id": "4235584",
            "problem": "Consider a homogeneous, collisionless electron-ion plasma with a weak bulk electron drift velocity $\\mathbf{v}_0$ superposed on an electron temperature anisotropy. You analyze individual Fourier modes from a simulation by measuring the complex electromagnetic field amplitudes $\\mathbf{E}$ and $\\mathbf{B}$, the current density $\\mathbf{J}$, and the wavevector $\\mathbf{k}$ at a given growth rate $\\gamma$ represented as $\\omega = i \\gamma$ with $\\gamma \\gt 0$. You are tasked with constructing a diagnostic that distinguishes the temperature-anisotropy-driven Weibel instability from the current filamentation instability in the presence of small but nonzero drifts, by using only mode polarization and $\\mathbf{k}$-orientation information.\n\nStart from the linearized Maxwell–Vlasov framework, using only the following foundational laws and definitions as your base:\n- Maxwell–Faraday law $\\partial_t \\mathbf{B} = - \\nabla \\times \\mathbf{E}$,\n- Maxwell–Ampère law $\\mu_0 \\mathbf{J} + \\epsilon_0 \\partial_t \\mathbf{E} = \\nabla \\times \\mathbf{B}$,\n- Current density defined as $\\mathbf{J}(\\mathbf{x},t) = - e \\int \\mathbf{v} f(\\mathbf{x},\\mathbf{v},t) \\,\\mathrm{d}^3 v$ where $f$ is the phase-space distribution function obeying the Vlasov equation,\n- In Fourier representation, for plane-wave perturbations $\\propto \\exp(i \\mathbf{k}\\cdot \\mathbf{x} - i \\omega t)$ with purely growing $\\omega = i \\gamma$ ($\\gamma \\gt 0$), the polarization of fields satisfies $\\mathbf{k} \\cdot \\mathbf{B} = 0$ and relationships implied by the curl operations in Maxwell’s equations.\n\nFrom this base, derive a quantitatively testable set of scalar diagnostics that combine:\n- The longitudinal electric polarization fraction $f_L$ relative to the wavevector direction, defined as $f_L = \\dfrac{|\\mathbf{E}_\\parallel|}{|\\mathbf{E}|}$ where $\\mathbf{E}_\\parallel = (\\hat{\\mathbf{k}} \\cdot \\mathbf{E})\\,\\hat{\\mathbf{k}}$ and $\\hat{\\mathbf{k}} = \\mathbf{k}/|\\mathbf{k}|$,\n- The magnetic-to-electric amplitude ratio $r_{ME} = \\dfrac{|\\mathbf{E}|}{c\\,|\\mathbf{B}|}$ where $c$ is the speed of light,\n- The orientation alignment $C_{ka} = (\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{a}})^2$ between the wavevector direction and the anisotropy axis unit vector $\\hat{\\mathbf{a}}$ (the axis along which the electron temperature differs most), with $C_{ka} \\in [0,1]$,\n- The current–drift alignment $C_{Jv} = \\dfrac{(\\mathbf{J} \\cdot \\hat{\\mathbf{v}}_0)^2}{|\\mathbf{J}|^2}$ where $\\hat{\\mathbf{v}}_0 = \\mathbf{v}_0/|\\mathbf{v}_0|$ when $|\\mathbf{v}_0| \\ne 0$,\n- The wavevector–drift perpendicularity measure $S_{kv} = 1 - (\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{v}}_0)^2$ for $|\\mathbf{v}_0| \\ne 0$.\n\nUsing these scalar quantities, define two composite scores:\n- A Weibel score $W$ that increases when the mode is magnetically dominated and transverse in electric polarization, and when the wavevector aligns with the anisotropy axis, and decreases when the current aligns with the drift,\n- A filamentation score $F$ that increases when the mode has stronger longitudinal electric polarization, when the wavevector is more perpendicular to the drift, when the current aligns with the drift, and when the electric field is not negligible compared to the magnetic field.\n\nYour derivation must clearly justify the diagnostic structure using the principles listed above and must show how these scores reflect physical differences between the Weibel instability and current filamentation in the small-drift regime. You must then specify an algorithmic decision rule, based on a threshold parameter $\\delta$, that classifies each mode as Weibel-like, filamentation-like, or ambiguous. The decision rule must also include orientation gating that prevents misclassification when the necessary geometric conditions are not met (for example, current filamentation requires $\\mathbf{k}$ significantly perpendicular to $\\mathbf{v}_0$, and Weibel from temperature anisotropy requires $\\mathbf{k}$ significantly aligned with $\\hat{\\mathbf{a}}$ or, in the absence of drift, the classification should default to Weibel if magnetic dominance and transverse polarization are present).\n\nYou must implement this diagnostic as a complete, runnable Python program. The program must:\n- Treat inputs for each test case as six vectors $\\mathbf{E}$, $\\mathbf{B}$, $\\mathbf{k}$, $\\mathbf{J}$, $\\mathbf{v}_0$, and $\\hat{\\mathbf{a}}$,\n- Use the speed of light $c = 299\\,792\\,458$ in $\\mathrm{m/s}$,\n- Compute $f_L$, $r_{ME}$, $C_{ka}$, $C_{Jv}$, and $S_{kv}$ exactly as defined,\n- Use the following concrete scoring functions and gates derived from your analysis:\n  $$W = (1 - f_L) + C_{ka} + (1 - r_{ME}) + (1 - C_{Jv}),$$\n  $$F = f_L + S_{kv} + C_{Jv} + r_{ME},$$\n  with orientation gates $C_{ka} \\ge c_{\\mathrm{thr}}$ for Weibel classification and $S_{kv} \\ge s_{\\mathrm{thr}}$ for filamentation classification, and a margin $\\delta$ for decision confidence. Explicitly specify numerical values for $c_{\\mathrm{thr}}$, $s_{\\mathrm{thr}}$, and $\\delta$.\n- Return an integer classification code per test:\n  - $0$ for Weibel-like,\n  - $1$ for filamentation-like,\n  - $2$ for ambiguous.\n\nPhysical units:\n- $\\mathbf{E}$ in $\\mathrm{V/m}$,\n- $\\mathbf{B}$ in $\\mathrm{T}$,\n- $\\mathbf{k}$ in $\\mathrm{m^{-1}}$,\n- $\\mathbf{J}$ in $\\mathrm{A/m^2}$,\n- $\\mathbf{v}_0$ in $\\mathrm{m/s}$,\n- $\\hat{\\mathbf{a}}$ is unitless and must be a unit vector,\n- Angles are implicit via dot products and need not be provided; if any angle is output, it must be in radians, but this program does not output angles.\n\nTest suite:\nEvaluate your program on the following five test cases, each consisting of $(\\mathbf{E}, \\mathbf{B}, \\mathbf{k}, \\mathbf{J}, \\mathbf{v}_0, \\hat{\\mathbf{a}})$ with entries in the units specified above.\n\n- Test case 1 (Weibel-dominated, small drift):\n  $\\mathbf{E} = [1.0, 0.5, 0.0]$, $\\mathbf{B} = [0.0, 0.01, 0.0]$, $\\mathbf{k} = [0.0, 0.0, 100.0]$, $\\mathbf{J} = [0.0, 10.0, 0.0]$, $\\mathbf{v}_0 = [1000.0, 0.0, 0.0]$, $\\hat{\\mathbf{a}} = [0.0, 0.0, 1.0]$.\n\n- Test case 2 (filamentation-dominated, strong drift, $\\mathbf{k} \\perp \\mathbf{v}_0$):\n  $\\mathbf{E} = [0.0, 50.0, 0.0]$, $\\mathbf{B} = [0.0, 0.0, 1.0 \\times 10^{-6}]$, $\\mathbf{k} = [0.0, 100.0, 0.0]$, $\\mathbf{J} = [100.0, 0.0, 0.0]$, $\\mathbf{v}_0 = [1.0 \\times 10^7, 0.0, 0.0]$, $\\hat{\\mathbf{a}} = [0.0, 0.0, 1.0]$.\n\n- Test case 3 (ambiguous mix of features, moderate drift, $\\mathbf{k}$ oblique):\n  $\\mathbf{E} = [20.0, 0.0, 0.0]$, $\\mathbf{B} = [0.0, 0.0, 1.0 \\times 10^{-6}]$, $\\mathbf{k} = [50.0, 86.6025403784, 0.0]$, $\\mathbf{J} = [50.0, 50.0, 0.0]$, $\\mathbf{v}_0 = [5.0 \\times 10^6, 0.0, 0.0]$, $\\hat{\\mathbf{a}} = [0.0, 0.0, 1.0]$.\n\n- Test case 4 (Weibel-dominated, zero drift):\n  $\\mathbf{E} = [5.0, 0.0, 0.0]$, $\\mathbf{B} = [0.0, 5.0 \\times 10^{-4}, 0.0]$, $\\mathbf{k} = [0.0, 0.0, 50.0]$, $\\mathbf{J} = [0.0, 20.0, 0.0]$, $\\mathbf{v}_0 = [0.0, 0.0, 0.0]$, $\\hat{\\mathbf{a}} = [0.0, 0.0, 1.0]$.\n\n- Test case 5 (two-stream-like geometry, $\\mathbf{k} \\parallel \\mathbf{v}_0$; must not be mislabeled as filamentation):\n  $\\mathbf{E} = [100.0, 0.0, 0.0]$, $\\mathbf{B} = [0.0, 0.0, 1.0 \\times 10^{-7}]$, $\\mathbf{k} = [100.0, 0.0, 0.0]$, $\\mathbf{J} = [200.0, 0.0, 0.0]$, $\\mathbf{v}_0 = [2.0 \\times 10^7, 0.0, 0.0]$, $\\hat{\\mathbf{a}} = [0.0, 0.0, 1.0]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each result is the integer classification code for the corresponding test case.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in the established principles of plasma physics, specifically the linearized Maxwell-Vlasov theory of plasma instabilities. The problem is well-posed, providing sufficient information, clear definitions, and a concrete objective. It requests the development and implementation of a diagnostic tool based on physical principles, which is a standard task in computational science.\n\n### 1. Theoretical Framework\n\nWe begin with the provided foundational laws, expressed in Fourier space for plane-wave perturbations of the form $\\propto \\exp(i \\mathbf{k}\\cdot \\mathbf{x} - i \\omega t)$. For a purely growing mode, the complex frequency is $\\omega = i \\gamma$, where $\\gamma$ is the real-valued growth rate ($\\gamma > 0$). The differential operators transform as $\\partial_t \\to -i\\omega = \\gamma$ and $\\nabla \\to i\\mathbf{k}$.\n\nMaxwell's equations in this representation become:\n1.  **Gauss's Law for Magnetism:** $\\nabla \\cdot \\mathbf{B} = 0 \\implies i\\mathbf{k} \\cdot \\mathbf{B} = 0$. This confirms that the magnetic field perturbation is strictly transverse to the wavevector $\\mathbf{k}$.\n2.  **Maxwell-Faraday Law:** $\\partial_t \\mathbf{B} = - \\nabla \\times \\mathbf{E} \\implies \\gamma \\mathbf{B} = -i\\mathbf{k} \\times \\mathbf{E}$.\n3.  **Maxwell-Ampère Law:** $\\mu_0 \\mathbf{J} + \\epsilon_0 \\mu_0 \\partial_t \\mathbf{E} = \\nabla \\times \\mathbf{B}$. Using $\\epsilon_0 \\mu_0 = 1/c^2$, this becomes $\\mu_0 \\mathbf{J} + \\frac{1}{c^2} \\gamma \\mathbf{E} = i\\mathbf{k} \\times \\mathbf{B}$.\n\nFrom the Maxwell-Faraday law, $i\\gamma\\mathbf{B} = \\mathbf{k} \\times \\mathbf{E}$, we can analyze the relationship between the electric and magnetic field amplitudes. Taking the magnitude, we find $\\gamma |\\mathbf{B}| = |\\mathbf{k} \\times \\mathbf{E}| = |\\mathbf{k}| |\\mathbf{E}| \\sin\\theta_{kE}$, where $\\theta_{kE}$ is the angle between $\\mathbf{k}$ and $\\mathbf{E}$. The magnetic-to-electric amplitude ratio $r_{ME}$ is defined as $r_{ME} = \\frac{|\\mathbf{E}|}{c|\\mathbf{B}|}$. Substituting the expression for $|\\mathbf{B}|$, we get:\n$$ r_{ME} = \\frac{|\\mathbf{E}|}{c \\frac{|\\mathbf{k}||\\mathbf{E}| \\sin\\theta_{kE}}{\\gamma}} = \\frac{\\gamma}{c|\\mathbf{k}| \\sin\\theta_{kE}} $$\nThe longitudinal electric polarization fraction is $f_L = |\\mathbf{E}_\\parallel|/|\\mathbf{E}| = |\\cos\\theta_{kE}|$. The transverse fraction is $\\sqrt{1-f_L^2} = |\\sin\\theta_{kE}|$. Therefore,\n$$ r_{ME} = \\frac{\\gamma}{c|\\mathbf{k}| \\sqrt{1-f_L^2}} $$\nThis relation connects the field amplitude ratio to the instability's growth rate $\\gamma$, wavenumber $|\\mathbf{k}|$, and electric field polarization $f_L$.\n\n### 2. Physical Properties of Weibel and Filamentation Instabilities\n\nThe diagnostic aims to distinguish between two fundamental electromagnetic instabilities based on their physical signatures.\n\n**Temperature-Anisotropy-Driven Weibel Instability:**\nThis instability is driven by an anisotropy in the particle velocity distribution, typically the electron temperature (e.g., $T_\\perp > T_\\parallel$, where $\\perp$ and $\\parallel$ are relative to a magnetic field or other symmetry axis).\n- **Geometry:** The instability grows most rapidly for wavevectors $\\mathbf{k}$ aligned with the direction of the lower temperature. The problem defines $\\hat{\\mathbf{a}}$ as the anisotropy axis. For the canonical Weibel instability ($T_\\perp > T_\\parallel$), growth is for $\\mathbf{k}$ parallel to the axis of symmetry (the \"parallel\" direction). Thus, a strong Weibel mode should exhibit $\\mathbf{k}$ closely aligned with $\\hat{\\mathbf{a}}$. This corresponds to the orientation alignment $C_{ka} = (\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{a}})^2$ approaching $1$.\n- **Field Polarization:** The Weibel mechanism is inherently transverse. The inductive electric field $\\mathbf{E}$ that results from the growing magnetic field $\\mathbf{B}$ is perpendicular to $\\mathbf{k}$ and $\\mathbf{B}$. Any longitudinal component of $\\mathbf{E}$ is typically small and arises from secondary electrostatic effects. Therefore, Weibel modes are characterized by a low longitudinal electric polarization fraction, $f_L \\approx 0$.\n- **Magnetic Dominance:** For non-relativistic plasmas, thermal velocities are much less than $c$. The Weibel growth rate $\\gamma$ and wavenumber $|\\mathbf{k}|$ are such that the effective phase speed $\\gamma/|\\mathbf{k}|$ is on the order of the thermal velocity. Consequently, $\\gamma/(c|\\mathbf{k}|) \\ll 1$. Since $f_L \\approx 0$, the ratio $r_{ME} \\approx \\gamma/(c|\\mathbf{k}|)$ is expected to be very small. This signature, $r_{ME} \\ll 1$, signifies that the mode is magnetically dominated, with most of its energy in the magnetic field.\n- **Current Alignment:** The current $\\mathbf{J}$ that drives the instability is produced by particles responding to the electromagnetic fields. In the presence of a small, unrelated bulk drift $\\mathbf{v}_0$, there is no intrinsic reason for the instability current to align with $\\mathbf{v}_0$. Thus, for a pure Weibel mode, the current-drift alignment $C_{Jv} = (\\mathbf{J} \\cdot \\hat{\\mathbf{v}}_0)^2/|\\mathbf{J}|^2$ is expected to be small.\n\n**Current Filamentation Instability (CFI):**\nThis instability is driven by a bulk drift $\\mathbf{v}_0$ (or counter-streaming populations), which leads to the breakup of the current into filaments.\n- **Geometry:** The filamentation occurs in the plane perpendicular to the direction of the current. Therefore, the instability wavevector $\\mathbf{k}$ is perpendicular to the drift velocity $\\mathbf{v}_0$. This corresponds to the wavevector-drift perpendicularity measure $S_{kv} = 1 - (\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{v}}_0)^2$ approaching $1$.\n- **Current Alignment:** The instability modulates the background current carried by the drift $\\mathbf{v}_0$. The perturbed current density is predominantly parallel to $\\mathbf{v}_0$. The total measured current $\\mathbf{J}$ (background plus perturbation) is therefore expected to be strongly aligned with the drift direction. This implies a current-drift alignment $C_{Jv} \\approx 1$.\n- **Field Polarization:** CFI can involve significant charge bunching, leading to strong space-charge effects. This results in a substantial longitudinal component of the electric field, so $f_L$ can be significant and approach $1$ in some cases.\n- **Magnetic-to-Electric Ratio:** Due to the potentially strong electric field, CFI is not typically as magnetically dominated as the Weibel instability. The value of $r_{ME}$ is not expected to be close to zero and can be of order unity or larger, depending on the plasma parameters.\n\n### 3. Justification of the Scoring Functions\n\nThe provided scoring functions are designed to quantify how closely a given mode matches the ideal properties of each instability.\n\n**Weibel Score ($W$):**\n$$ W = (1 - f_L) + C_{ka} + (1 - r_{ME}) + (1 - C_{Jv}) $$\n- The term $(1 - f_L)$ is maximal ($1$) when the electric field is purely transverse ($f_L=0$), a key feature of Weibel.\n- The term $C_{ka}$ is maximal ($1$) when $\\mathbf{k}$ is aligned with the anisotropy axis $\\hat{\\mathbf{a}}$.\n- The term $(1 - r_{ME})$ is maximal when the mode is strongly magnetic ($r_{ME} \\to 0$).\n- The term $(1 - C_{Jv})$ is maximal ($1$) when the current is not aligned with the drift, which is expected if the drift is not the primary driver.\nEach term contributes positively to the score when a Weibel-like feature is present, making $W$ a robust measure of Weibel characteristics.\n\n**Filamentation Score ($F$):**\n$$ F = f_L + S_{kv} + C_{Jv} + r_{ME} $$\n- The term $f_L$ is maximal when the electric field is longitudinal, a feature of CFI.\n- The term $S_{kv}$ is maximal ($1$) when $\\mathbf{k}$ is perpendicular to the drift velocity $\\mathbf{v}_0$.\n- The term $C_{Jv}$ is maximal ($1$) when the current $\\mathbf{J}$ is aligned with the drift $\\mathbf{v}_0$.\n- The term $r_{ME}$ contributes positively when the electric field is not negligible, distinguishing it from the magnetically dominated Weibel case.\nEach term boosts the score when a CFI-like feature is present.\n\n### 4. Algorithmic Decision Rule\n\nTo implement a classifier, we must define thresholds for the geometric gates and a margin for the decision.\n- **Orientation Gates:** A mode can only be considered a candidate for Weibel or CFI if its geometry is appropriate. We establish thresholds for the orientation metrics $C_{ka}$ and $S_{kv}$. These metrics are squared cosines, ranging from $0$ to $1$. A value close to $1$ indicates strong geometric alignment. We choose thresholds $c_{\\mathrm{thr}} = 0.8$ and $s_{\\mathrm{thr}} = 0.8$. This requires the angle for Weibel candidacy to be within $\\arccos(\\sqrt{0.8}) \\approx 26.6^\\circ$ of the anisotropy axis, and for CFI candidacy to be within $26.6^\\circ$ of the plane perpendicular to the drift.\n- **Decision Margin:** The scores $W$ and $F$ are compared. To avoid ambiguity for modes with mixed character, we introduce a decision margin $\\delta$. A mode is classified only if its score for one instability type exceeds the other by this margin. Given the scores can range up to $4$, we select a margin of $\\delta = 0.5$.\n\n**Special Case (Zero Drift):** If $|\\mathbf{v}_0|=0$, the CFI is not a relevant concept. The diagnostics $C_{Jv}$ and $S_{kv}$ are undefined. We adopt the convention that $C_{Jv}=0$ and $S_{kv}=0$ in this case. The CFI score $F$ is then reduced, and it cannot pass the CFI gate ($S_{kv} < s_{\\mathrm{thr}}$). The problem can then be classified as Weibel-like if its score $W$ is sufficiently high and it passes the Weibel gate, or as ambiguous otherwise. This aligns with the problem's guidance.\n\n**Classification Logic:**\nFor each mode, the classification code is determined as follows:\n1.  Calculate the five scalar diagnostics: $f_L$, $r_{ME}$, $C_{ka}$, $C_{Jv}$, $S_{kv}$. For $|\\mathbf{v}_0|=0$, set $C_{Jv}=0$ and $S_{kv}=0$. Handle divisions by zero for vector magnitudes by setting corresponding scalars to $0$.\n2.  Calculate the scores $W$ and $F$ using the provided formulas.\n3.  Evaluate the geometric gates: `is_weibel_candidate = (C_ka >= 0.8)` and `is_cfi_candidate = (S_kv >= 0.8)`.\n4.  Apply the final decision rule:\n    - If $(W > F + 0.5)$ AND `is_weibel_candidate`, the mode is classified as **Weibel-like** (Code $0$).\n    - Else if $(F > W + 0.5)$ AND `is_cfi_candidate`, the mode is classified as **Filamentation-like** (Code $1$).\n    - Otherwise, the mode is **Ambiguous** (Code $2$).\n\nThis system provides a quantitative, physically-motivated method for distinguishing the two instabilities from simulated field data.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the plasma mode classification diagnostic\n    on the provided test suite.\n    \"\"\"\n    \n    # Define physical constants and algorithm parameters\n    C_LIGHT = 299792458.0  # Speed of light in m/s\n    C_THR = 0.8  # Threshold for Weibel k-vector alignment gate\n    S_THR = 0.8  # Threshold for Filamentation k-vector perpendicularity gate\n    DELTA = 0.5  # Decision margin for score comparison\n\n    # Test suite provided in the problem description.\n    # Each case is a tuple of 6 numpy arrays: (E, B, k, J, v0, a_hat)\n    test_cases = [\n        # Case 1: Weibel-dominated, small drift\n        (np.array([1.0, 0.5, 0.0]), np.array([0.0, 0.01, 0.0]), np.array([0.0, 0.0, 100.0]),\n         np.array([0.0, 10.0, 0.0]), np.array([1000.0, 0.0, 0.0]), np.array([0.0, 0.0, 1.0])),\n        \n        # Case 2: Filamentation-dominated, strong drift, k perpendicular to v0\n        (np.array([0.0, 50.0, 0.0]), np.array([0.0, 0.0, 1.0e-6]), np.array([0.0, 100.0, 0.0]),\n         np.array([100.0, 0.0, 0.0]), np.array([1.0e7, 0.0, 0.0]), np.array([0.0, 0.0, 1.0])),\n\n        # Case 3: Ambiguous mix of features, moderate drift, k oblique\n        (np.array([20.0, 0.0, 0.0]), np.array([0.0, 0.0, 1.0e-6]), np.array([50.0, 86.6025403784, 0.0]),\n         np.array([50.0, 50.0, 0.0]), np.array([5.0e6, 0.0, 0.0]), np.array([0.0, 0.0, 1.0])),\n\n        # Case 4: Weibel-dominated, zero drift\n        (np.array([5.0, 0.0, 0.0]), np.array([0.0, 5.0e-4, 0.0]), np.array([0.0, 0.0, 50.0]),\n         np.array([0.0, 20.0, 0.0]), np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 1.0])),\n\n        # Case 5: Two-stream-like geometry, k parallel to v0\n        (np.array([100.0, 0.0, 0.0]), np.array([0.0, 0.0, 1.0e-7]), np.array([100.0, 0.0, 0.0]),\n         np.array([200.0, 0.0, 0.0]), np.array([2.0e7, 0.0, 0.0]), np.array([0.0, 0.0, 1.0])),\n    ]\n\n    def classify_mode(E, B, k, J, v0, a_hat):\n        \"\"\"\n        Computes diagnostics and classifies a single plasma mode.\n        Returns an integer code: 0 (Weibel), 1 (Filamentation), 2 (Ambiguous).\n        \"\"\"\n        # Calculate magnitudes of vectors\n        E_mag = np.linalg.norm(E)\n        B_mag = np.linalg.norm(B)\n        k_mag = np.linalg.norm(k)\n        J_mag = np.linalg.norm(J)\n        v0_mag = np.linalg.norm(v0)\n\n        # Handle potential division by zero if a magnitude is zero.\n        # This is a safety measure; problem data implies non-zero magnitudes where relevant.\n        if k_mag == 0: return 2 # Cannot define k_hat\n        k_hat = k / k_mag\n\n        # --- Calculate Scalar Diagnostics ---\n\n        # 1. Longitudinal electric polarization fraction (f_L)\n        if E_mag == 0:\n            f_L = 0.0\n        else:\n            E_parallel_mag = np.abs(np.dot(E, k_hat))\n            f_L = E_parallel_mag / E_mag\n        \n        # 2. Magnetic-to-electric amplitude ratio (r_ME)\n        if B_mag == 0 or C_LIGHT == 0:\n            # If B is zero, E/B is infinite. Assign a large value to favor F score.\n            r_ME = 1e9 \n        else:\n            r_ME = E_mag / (C_LIGHT * B_mag)\n\n        # 3. Orientation alignment (C_ka)\n        # a_hat is guaranteed to be a unit vector per problem statement.\n        C_ka = np.dot(k_hat, a_hat)**2\n\n        # 4. Current-drift alignment (C_Jv) & Wavevector-drift perpendicularity (S_kv)\n        if v0_mag == 0 or J_mag == 0:\n            # If drift is zero, CFI is not driven. These metrics are not applicable.\n            # Set to 0 by convention, which penalizes the F score.\n            C_Jv = 0.0\n            S_kv = 0.0\n        else:\n            v0_hat = v0 / v0_mag\n            C_Jv = np.dot(J, v0_hat)**2 / J_mag**2\n            S_kv = 1.0 - np.dot(k_hat, v0_hat)**2\n\n        # --- Calculate Composite Scores ---\n        W = (1.0 - f_L) + C_ka + (1.0 - r_ME) + (1.0 - C_Jv)\n        F = f_L + S_kv + C_Jv + r_ME\n\n        # --- Apply Decision Rule ---\n        is_weibel_candidate = (C_ka >= C_THR)\n        is_cfi_candidate = (S_kv >= S_THR)\n\n        if W > F + DELTA and is_weibel_candidate:\n            return 0  # Weibel-like\n        elif F > W + DELTA and is_cfi_candidate:\n            return 1  # Filamentation-like\n        else:\n            return 2  # Ambiguous\n\n    results = [classify_mode(*case) for case in test_cases]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}