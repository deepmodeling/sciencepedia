{
    "hands_on_practices": [
        {
            "introduction": "Understanding how gate voltage controls the semiconductor surface begins with mastering the electrostatics within the depletion region. This foundational exercise guides you through a first-principles derivation of the surface electric field using Poisson's equation under the depletion approximation, a critical tool in the analytical modeling of MOS devices. By working from the ground up, you will solidify your grasp of the relationship between charge, electric field, and potential in a biased MOS capacitor .",
            "id": "3749056",
            "problem": "A Metal–Oxide–Semiconductor (MOS) capacitor consisting of silicon dioxide on uniformly doped p-type silicon is biased so that the semiconductor is in depletion and the surface potential is positive relative to the neutral bulk. Let the coordinate $x$ be defined with $x=0$ at the silicon surface and $x0$ directed into the semiconductor. Assume the depletion approximation (mobile carriers negligible within the depletion region), a uniform acceptor concentration $N_A$ in the silicon, no fixed charge at the oxide–silicon interface, and that the electric field vanishes at the edge of depletion. Starting from Poisson’s equation and appropriate boundary conditions, derive an expression for the electric field profile $E(x)$ in the depleted silicon and obtain the relationship between the surface electric field $E_s$ and the surface potential $\\psi_s$. Then evaluate $E_s$ numerically for the parameters $N_A = 1.0 \\times 10^{17}\\ \\text{cm}^{-3}$, $\\psi_s = +0.50\\ \\text{V}$, silicon relative permittivity $\\varepsilon_r = 11.7$, vacuum permittivity $\\varepsilon_0 = 8.854 \\times 10^{-12}\\ \\text{F/m}$, and elementary charge $q = 1.602 \\times 10^{-19}\\ \\text{C}$. Briefly justify the sign of $E_s$ under the stated coordinate convention when $\\psi_s  0$ on p-type silicon. Express your final numerical value of $E_s$ in $\\text{V/cm}$ and round your answer to three significant figures. Do not use any pre-derived depletion-region formulas; base your derivation on Poisson’s equation, continuity of the electric field, and electrostatic definitions.",
            "solution": "The problem is found to be valid as it is scientifically grounded in the principles of semiconductor physics, well-posed with a complete and consistent set of givens, and stated in objective, formal language. The provided parameters are physically realistic for a silicon-based Metal-Oxide-Semiconductor (MOS) capacitor. We may therefore proceed with the derivation and calculation.\n\nThe analysis begins with the one-dimensional Poisson’s equation, which relates the electrostatic potential, $\\psi(x)$, to the local space charge density, $\\rho(x)$, within the semiconductor:\n$$ \\frac{d^2 \\psi(x)}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon_{Si}} $$\nHere, $x$ is the spatial coordinate with $x=0$ at the silicon surface and $x0$ into the semiconductor bulk, and $\\varepsilon_{Si}$ is the permittivity of silicon, given by $\\varepsilon_{Si} = \\varepsilon_r \\varepsilon_0$, where $\\varepsilon_r$ is the relative permittivity of silicon and $\\varepsilon_0$ is the vacuum permittivity.\n\nThe problem specifies uniformly doped p-type silicon with an acceptor concentration of $N_A$. Under depletion conditions, mobile charge carriers (holes) are repelled from the surface, leaving behind a region of fixed, negatively charged ionized acceptor atoms. Within the depletion approximation, the space charge density in the depletion region, which extends from $x=0$ to a width $x=W$, is constant and given by:\n$$ \\rho(x) = -q N_A \\quad \\text{for } 0 \\le x \\le W $$\nwhere $q$ is the elementary charge. For $xW$, the semiconductor is neutral, so $\\rho(x)=0$.\n\nSubstituting this charge density into Poisson's equation for the depletion region ($0 \\le x \\le W$):\n$$ \\frac{d^2 \\psi(x)}{dx^2} = -\\frac{-q N_A}{\\varepsilon_{Si}} = \\frac{q N_A}{\\varepsilon_{Si}} $$\n\nThe electric field $E(x)$ is defined as the negative gradient of the potential:\n$$ E(x) = -\\frac{d\\psi(x)}{dx} $$\nDifferentiating this expression with respect to $x$ gives $\\frac{dE(x)}{dx} = -\\frac{d^2\\psi(x)}{dx^2}$. Combining this with Poisson’s equation yields Gauss's law in differential form:\n$$ \\frac{dE(x)}{dx} = -\\left(\\frac{q N_A}{\\varepsilon_{Si}}\\right) = -\\frac{q N_A}{\\varepsilon_{Si}} $$\nTo find the electric field profile $E(x)$, we integrate this equation. The problem states that the electric field vanishes at the edge of the depletion region, which provides the boundary condition $E(W)=0$. Integrating from an arbitrary point $x$ within the depletion region to the edge $W$:\n$$ \\int_x^W \\frac{dE(x')}{dx'} dx' = E(W) - E(x) = \\int_x^W \\left(-\\frac{q N_A}{\\varepsilon_{Si}}\\right) dx' $$\n$$ 0 - E(x) = -\\frac{q N_A}{\\varepsilon_{Si}} (W-x) $$\nThis yields the expression for the electric field profile in the depletion region:\n$$ E(x) = \\frac{q N_A}{\\varepsilon_{Si}} (W-x) \\quad \\text{for } 0 \\le x \\le W $$\n\nThe surface electric field, $E_s$, is the field at $x=0$:\n$$ E_s = E(0) = \\frac{q N_A W}{\\varepsilon_{Si}} $$\n\nNext, to find the relationship between $E_s$ and the surface potential $\\psi_s$, we must find the potential profile $\\psi(x)$ by integrating the electric field. From the definition $E(x) = -d\\psi(x)/dx$, we have:\n$$ \\frac{d\\psi(x)}{dx} = -E(x) = -\\frac{q N_A}{\\varepsilon_{Si}} (W-x) $$\nThe surface potential $\\psi_s$ is defined relative to the neutral bulk. We can set the potential in the neutral bulk ($x \\ge W$) to zero as a reference, so our second boundary condition is $\\psi(W) = 0$. Integrating from $x$ to $W$:\n$$ \\int_x^W \\frac{d\\psi(x')}{dx'} dx' = \\psi(W) - \\psi(x) = \\int_x^W \\left(-\\frac{q N_A}{\\varepsilon_{Si}} (W-x')\\right) dx' $$\n$$ 0 - \\psi(x) = -\\frac{q N_A}{\\varepsilon_{Si}} \\left[ Wx' - \\frac{(x')^2}{2} \\right]_x^W $$\n$$ -\\psi(x) = -\\frac{q N_A}{\\varepsilon_{Si}} \\left( \\left(W^2 - \\frac{W^2}{2}\\right) - \\left(Wx - \\frac{x^2}{2}\\right) \\right) $$\n$$ -\\psi(x) = -\\frac{q N_A}{\\varepsilon_{Si}} \\left( \\frac{W^2}{2} - Wx + \\frac{x^2}{2} \\right) = -\\frac{q N_A}{2\\varepsilon_{Si}}(W-x)^2 $$\nThe potential profile is thus:\n$$ \\psi(x) = \\frac{q N_A}{2\\varepsilon_{Si}}(W-x)^2 $$\nThe surface potential $\\psi_s$ is the potential at $x=0$:\n$$ \\psi_s = \\psi(0) = \\frac{q N_A W^2}{2\\varepsilon_{Si}} $$\nAs required by the problem statement, for p-type depletion, $\\psi_s  0$.\n\nWe now have two expressions, one for $E_s$ and one for $\\psi_s$, both in terms of the depletion width $W$:\n$$(1) \\quad E_s = \\frac{q N_A W}{\\varepsilon_{Si}}$$\n$$(2) \\quad \\psi_s = \\frac{q N_A W^2}{2\\varepsilon_{Si}}$$\nTo find the relationship between $E_s$ and $\\psi_s$, we can eliminate $W$. From equation (1), $W = \\frac{\\varepsilon_{Si} E_s}{q N_A}$. Substituting this into equation (2):\n$$ \\psi_s = \\frac{q N_A}{2\\varepsilon_{Si}} \\left( \\frac{\\varepsilon_{Si} E_s}{q N_A} \\right)^2 = \\frac{q N_A}{2\\varepsilon_{Si}} \\frac{\\varepsilon_{Si}^2 E_s^2}{q^2 N_A^2} = \\frac{\\varepsilon_{Si} E_s^2}{2qN_A} $$\nSolving for $E_s$:\n$$ E_s^2 = \\frac{2qN_A\\psi_s}{\\varepsilon_{Si}} \\implies E_s = \\sqrt{\\frac{2qN_A\\psi_s}{\\varepsilon_{Si}}} $$\nThe positive root is chosen because, as derived, $E_s$ is positive.\n\nNow, we evaluate $E_s$ numerically. To obtain the result in units of $\\text{V/cm}$, we will perform the calculation using a consistent set of units (cm, V, C).\nThe given parameters are:\n$N_A = 1.0 \\times 10^{17}\\ \\text{cm}^{-3}$\n$\\psi_s = 0.50\\ \\text{V}$\n$q = 1.602 \\times 10^{-19}\\ \\text{C}$\n$\\varepsilon_r = 11.7$\n$\\varepsilon_0 = 8.854 \\times 10^{-12}\\ \\text{F/m} = 8.854 \\times 10^{-14}\\ \\text{F/cm}$\n\nThe permittivity of silicon is:\n$\\varepsilon_{Si} = \\varepsilon_r \\varepsilon_0 = 11.7 \\times (8.854 \\times 10^{-14}\\ \\text{F/cm}) = 1.035938 \\times 10^{-12}\\ \\text{F/cm}$\n\nSubstituting these values into the expression for $E_s$:\n$$ E_s = \\sqrt{\\frac{2(1.602 \\times 10^{-19}\\ \\text{C})(1.0 \\times 10^{17}\\ \\text{cm}^{-3})(0.50\\ \\text{V})}{1.035938 \\times 10^{-12}\\ \\text{F/cm}}} $$\n$$ E_s = \\sqrt{\\frac{1.602 \\times 10^{-2}\\ \\text{C}\\cdot\\text{V}\\cdot\\text{cm}^{-3}}{1.035938 \\times 10^{-12}\\ \\text{F/cm}}} $$\nNoting that $\\text{C}\\cdot\\text{V} = \\text{J}$ and $\\text{F} = \\text{C/V}$, the units inside the square root are $\\frac{\\text{C}\\cdot\\text{V}}{\\text{F}\\cdot\\text{cm}^2} = \\frac{\\text{V}^2}{\\text{cm}^2}$.\n$$ E_s = \\sqrt{1.546416 \\times 10^{10}\\ \\text{V}^2/\\text{cm}^2} $$\n$$ E_s \\approx 1.24355 \\times 10^5\\ \\text{V/cm} $$\nRounding to three significant figures, we get $E_s = 1.24 \\times 10^5\\ \\text{V/cm}$.\n\nFinally, a brief justification for the sign of $E_s$:\nThe problem specifies a p-type semiconductor and a coordinate system where $x0$ points into the semiconductor. The surface potential is given as positive, $\\psi_s  0$, relative to the neutral bulk where the potential is taken as zero. The electric field vector points in the direction of decreasing potential. Since the potential decreases from $\\psi_s  0$ at the surface ($x=0$) to $0$ in the bulk ($x \\ge W$), the potential is a decreasing function of $x$. Therefore, the electric field must point in the direction of increasing $x$, i.e., the $+x$ direction. An electric field vector in the $+x$ direction has a positive component $E_x$. Consequently, the surface electric field $E_s = E(x=0)$ must be positive. This is consistent with our derived field profile $E(x) = \\frac{qN_A}{\\varepsilon_{Si}}(W-x)$, which is positive for $0 \\le x  W$.",
            "answer": "$$ \\boxed{1.24 \\times 10^5} $$"
        },
        {
            "introduction": "While the depletion approximation is a powerful simplification, a skilled physicist or engineer must also understand its boundaries of validity. This practice provides a quantitative method to assess this approximation by comparing the calculated depletion width, $W_d$, to the intrinsic screening length of the semiconductor, the Debye length $L_D$. This comparison  builds a deeper intuition for the underlying carrier physics and highlights when a more rigorous model is necessary.",
            "id": "3749027",
            "problem": "Consider a one-dimensional Silicon Metal-Oxide-Semiconductor (MOS) capacitor with a uniformly doped p-type silicon substrate under a positive gate bias such that the surface is driven just to the onset of strong inversion. Assume complete ionization, nondegenerate statistics, and thermal equilibrium in the bulk. The substrate acceptor concentration is $N_A$, and the temperature is $T$. Starting from Poisson’s equation and the Boltzmann relation for carrier statistics, derive from first principles expressions for the bulk Debye screening length and the maximum depletion width at the onset of strong inversion, where the surface potential equals twice the bulk Fermi potential. Using those expressions, form the dimensionless ratio $R = W_d/L_D$ and evaluate it numerically for $N_A = 1.0\\times 10^{17}\\ \\mathrm{cm}^{-3}$ and $T = 300\\ \\mathrm{K}$. Take the intrinsic carrier concentration of silicon at $T=300\\ \\mathrm{K}$ to be $n_i = 1.0\\times 10^{10}\\ \\mathrm{cm}^{-3}$. Use $q$ for the elementary charge and $k_B$ for the Boltzmann constant as needed, but ensure unit consistency. Round your final answer for $R$ to four significant figures. Provide the final answer as a single dimensionless number.",
            "solution": "The problem asks for the derivation of the bulk Debye length ($L_D$) and the maximum depletion width ($W_d$), followed by the calculation of their ratio $R = W_d/L_D$ for a specific case. The derivations must start from first principles, namely Poisson's equation and Boltzmann carrier statistics.\n\nLet the electrostatic potential be $\\phi(x)$, with the reference potential in the bulk silicon set to zero, i.e., $\\phi(\\infty) = 0$. The position $x=0$ corresponds to the Si-SiO$_2$ interface.\n\nFirst, we determine the bulk Fermi potential, $\\phi_f$. For a uniformly p-doped semiconductor with acceptor concentration $N_A$, assuming complete ionization, the hole concentration in the neutral bulk is $p_0 = N_A$. The system is in thermal equilibrium, so the mass-action law $n_0 p_0 = n_i^2$ holds, where $n_0$ is the electron concentration in the bulk and $n_i$ is the intrinsic carrier concentration. Thus, $n_0 = n_i^2 / N_A$.\n\nThe hole and electron concentrations can also be expressed in relation to the intrinsic Fermi level $E_i$ and the Fermi level $E_F$:\n$$p_0 = n_i \\exp\\left(\\frac{E_i - E_F}{k_B T}\\right)$$\n$$n_0 = n_i \\exp\\left(\\frac{E_F - E_i}{k_B T}\\right)$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. The bulk Fermi potential, $\\phi_f$, is defined as the potential difference corresponding to the energy difference between the intrinsic level and the Fermi level in the bulk, divided by the elementary charge $q$:\n$$\\phi_f = \\frac{E_i - E_F}{q}$$\nSubstituting this definition into the expression for $p_0$ and using $p_0=N_A$:\n$$N_A = n_i \\exp\\left(\\frac{q \\phi_f}{k_B T}\\right)$$\nSolving for $\\phi_f$, we obtain:\n$$\\phi_f = \\frac{k_B T}{q} \\ln\\left(\\frac{N_A}{n_i}\\right)$$\nSince $N_A  n_i$ for a p-type substrate, $\\phi_f$ is positive.\n\nNext, we derive the expression for the bulk Debye screening length, $L_D$. This length characterizes the screening of small potential variations in the neutral bulk. We start with the one-dimensional Poisson's equation:\n$$\\frac{d^2\\phi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon_{Si}}$$\nwhere $\\epsilon_{Si}$ is the permittivity of silicon and $\\rho(x)$ is the net space charge density, given by $\\rho(x) = q(p(x) - n(x) - N_A)$. The carrier concentrations $p(x)$ and $n(x)$ depend on the local potential $\\phi(x)$ according to Boltzmann statistics:\n$$p(x) = p_0 \\exp\\left(-\\frac{q\\phi(x)}{k_B T}\\right) \\quad \\text{and} \\quad n(x) = n_0 \\exp\\left(\\frac{q\\phi(x)}{k_B T}\\right)$$\nFor small potential perturbations in the bulk, $|\\frac{q\\phi}{k_B T}| \\ll 1$, we can linearize the exponential terms: $p(x) \\approx p_0(1 - \\frac{q\\phi}{k_B T})$ and $n(x) \\approx n_0(1 + \\frac{q\\phi}{k_B T})$. The charge density becomes:\n$$\\rho \\approx q\\left(p_0\\left(1 - \\frac{q\\phi}{k_B T}\\right) - n_0\\left(1 + \\frac{q\\phi}{k_B T}\\right) - N_A\\right)$$\nUsing the bulk neutrality condition $p_0 - n_0 = N_A$, this simplifies to:\n$$\\rho \\approx -\\frac{q^2}{k_B T}(p_0 + n_0)\\phi$$\nFor a p-type substrate with $N_A = 10^{17}\\ \\mathrm{cm}^{-3}$ and $n_i = 10^{10}\\ \\mathrm{cm}^{-3}$, we have $p_0 = 10^{17}\\ \\mathrm{cm}^{-3}$ and $n_0 = 10^3\\ \\mathrm{cm}^{-3}$. Clearly, $p_0 \\gg n_0$, so we can approximate $p_0+n_0 \\approx p_0 = N_A$. The charge density is then $\\rho \\approx -\\frac{q^2 N_A}{k_B T}\\phi$.\nSubstituting this into Poisson's equation gives the linearized equation:\n$$\\frac{d^2\\phi}{dx^2} \\approx \\frac{q^2 N_A}{\\epsilon_{Si} k_B T}\\phi$$\nThis is a standard second-order differential equation of the form $\\frac{d^2\\phi}{dx^2} = \\frac{1}{L_D^2}\\phi$. By comparison, we identify the square of the Debye length as:\n$$L_D^2 = \\frac{\\epsilon_{Si} k_B T}{q^2 N_A}$$\nThus, the bulk Debye length is:\n$$L_D = \\sqrt{\\frac{\\epsilon_{Si} k_B T}{q^2 N_A}}$$\n\nNow, we derive the expression for the maximum depletion width, $W_d$. This is typically derived using the depletion approximation. Under a positive gate bias, a depletion region forms near the surface ($0 \\le x \\le W_d$) where mobile holes have been pushed away, leaving behind fixed, negatively charged acceptor ions. In the depletion approximation, we assume that the charge density in this region is constant and equal to $\\rho(x) = -qN_A$ for $0 \\le x \\le W_d$, and $\\rho(x) = 0$ for $x  W_d$.\nPoisson's equation inside the depletion region is:\n$$\\frac{d^2\\phi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon_{Si}} = \\frac{q N_A}{\\epsilon_{Si}}$$\nWe integrate this equation twice with the boundary conditions that the electric field and potential at the edge of the depletion region are zero (matching the neutral bulk): $E(W_d) = -\\frac{d\\phi}{dx}|_{x=W_d} = 0$ and $\\phi(W_d)=0$.\nIntegrating once from $x$ to $W_d$ gives the electric field $E(x)$:\n$$-\\frac{d\\phi}{dx} = E(x) = \\int_{W_d}^{x} \\frac{q N_A}{\\epsilon_{Si}} dx' = -\\frac{q N_A}{\\epsilon_{Si}}(W_d - x)$$\nIntegrating a second time from $x$ to $W_d$ gives the potential $\\phi(x)$:\n$$\\phi(x) - \\phi(W_d) = \\int_{x}^{W_d} E(x') dx' = \\int_{x}^{W_d} \\frac{q N_A}{\\epsilon_{Si}}(W_d - x') dx'$$\n$$\\phi(x) = \\frac{q N_A}{\\epsilon_{Si}} \\left[ W_d x' - \\frac{(x')^2}{2} \\right]_x^{W_d} = \\frac{q N_A}{\\epsilon_{Si}} \\left( \\left(W_d^2 - \\frac{W_d^2}{2}\\right) - \\left(W_d x - \\frac{x^2}{2}\\right) \\right) = \\frac{q N_A}{2\\epsilon_{Si}} (W_d-x)^2$$\nThe surface potential, $\\phi_s$, is the potential at $x=0$:\n$$\\phi_s = \\phi(0) = \\frac{q N_A W_d^2}{2\\epsilon_{Si}}$$\nThe problem states that strong inversion is reached when the surface potential is twice the bulk Fermi potential, i.e., $\\phi_s = 2\\phi_f$. At this point, the depletion width reaches its maximum value, $W_d$. Setting $\\phi_s = 2\\phi_f$:\n$$2\\phi_f = \\frac{q N_A W_d^2}{2\\epsilon_{Si}}$$\nSolving for $W_d$:\n$$W_d = \\sqrt{\\frac{4\\epsilon_{Si}\\phi_f}{q N_A}}$$\n\nFinally, we form the dimensionless ratio $R = W_d/L_D$:\n$$R = \\frac{\\sqrt{\\frac{4\\epsilon_{Si}\\phi_f}{q N_A}}}{\\sqrt{\\frac{\\epsilon_{Si} k_B T}{q^2 N_A}}} = \\sqrt{\\frac{4\\epsilon_{Si}\\phi_f}{q N_A} \\cdot \\frac{q^2 N_A}{\\epsilon_{Si} k_B T}} = \\sqrt{\\frac{4q\\phi_f}{k_B T}}$$\nNow we substitute the expression for $\\phi_f = \\frac{k_B T}{q} \\ln\\left(\\frac{N_A}{n_i}\\right)$:\n$$R = \\sqrt{\\frac{4q}{k_B T} \\cdot \\left(\\frac{k_B T}{q} \\ln\\left(\\frac{N_A}{n_i}\\right)\\right)} = \\sqrt{4 \\ln\\left(\\frac{N_A}{n_i}\\right)} = 2\\sqrt{\\ln\\left(\\frac{N_A}{n_i}\\right)}$$\n\nNow we evaluate this expression numerically with the given values:\n$N_A = 1.0 \\times 10^{17}\\ \\mathrm{cm}^{-3}$\n$n_i = 1.0 \\times 10^{10}\\ \\mathrm{cm}^{-3}$\nThe ratio inside the logarithm is:\n$$\\frac{N_A}{n_i} = \\frac{1.0 \\times 10^{17}}{1.0 \\times 10^{10}} = 10^7$$\nThe dimensionless ratio $R$ is:\n$$R = 2\\sqrt{\\ln(10^7)} = 2\\sqrt{7 \\ln(10)}$$\nUsing the value $\\ln(10) \\approx 2.302585$:\n$$R \\approx 2\\sqrt{7 \\times 2.302585} = 2\\sqrt{16.118095} \\approx 2 \\times 4.014735 \\approx 8.02947$$\nRounding the result to four significant figures, we get $8.029$.",
            "answer": "$$\\boxed{8.029}$$"
        },
        {
            "introduction": "Moving from idealized one-dimensional models to more realistic device behavior requires computational tools. This practice challenges you to implement a numerical solver for the full nonlinear Poisson-Boltzmann equation, a more accurate description of the semiconductor charge than the simple depletion approximation. This allows you to explore the effects of a non-uniform oxide thickness—a common process variation—on the surface potential profile along the device channel .",
            "id": "3749022",
            "problem": "Consider a two-dimensional Metal-Oxide-Semiconductor (MOS) cross-section with lateral coordinate $y$ along the gate length and vertical coordinate $x$ normal to the interface. The oxide thickness $t_{\\mathrm{ox}}(y)$ varies laterally under the gate, while the silicon substrate is uniformly doped as a p-type semiconductor with acceptor concentration $N_{\\mathrm{A}}$. Assume electrostatic equilibrium and neglect fixed interface charges. The oxide region contains no free charge and is therefore governed by the Laplace equation, while the semiconductor region contains mobile carriers and ionized dopants, governed by the Poisson equation with Boltzmann statistics.\n\nFundamental base:\n- Maxwell's equations in electrostatics imply Gauss's law and the definition of electric displacement. In differential form, Gauss's law is $\\nabla \\cdot \\mathbf{D} = \\rho$, where $\\mathbf{D} = \\varepsilon \\mathbf{E}$ and $\\mathbf{E} = -\\nabla \\psi$. In regions with no free charge, $\\rho = 0$, so the potential satisfies the Laplace equation $\\nabla^2 \\psi = 0$. In regions with charge, the potential satisfies the Poisson equation $\\nabla^2 \\psi = -\\rho/\\varepsilon$.\n- In the oxide, the potential obeys $\\nabla^2 \\psi_{\\mathrm{ox}} = 0$ with boundary conditions $\\psi_{\\mathrm{ox}}(y, t_{\\mathrm{ox}}(y)) = V_{\\mathrm{G}}$ (gate metal held at gate voltage) and $\\psi_{\\mathrm{ox}}(y, 0) = \\psi_{\\mathrm{s}}(y)$ (continuity of potential at the interface). Under the thin-oxide approximation, the solution is locally one-dimensional in $x$ and linear, so the vertical electric field in the oxide at the interface is $E_{\\mathrm{ox}}(y) = \\left(V_{\\mathrm{G}} - V_{\\mathrm{fb}} - \\psi_{\\mathrm{s}}(y)\\right)/t_{\\mathrm{ox}}(y)$, where $V_{\\mathrm{fb}}$ is the flatband voltage.\n- In the semiconductor, the Poisson equation with Boltzmann statistics for electrons and holes and uniform, fully ionized acceptor dopants yields an exact relation between the surface electric field $E_{\\mathrm{si}}(y)$ and the surface potential $\\psi_{\\mathrm{s}}(y)$:\n$$\n\\varepsilon_{\\mathrm{si}} E_{\\mathrm{si}}^2(y) = 2 \\varepsilon_{\\mathrm{si}} q N_{\\mathrm{A}} V_{\\mathrm{T}} \\left( e^{-\\psi_{\\mathrm{s}}(y)/V_{\\mathrm{T}}} + \\frac{\\psi_{\\mathrm{s}}(y)}{V_{\\mathrm{T}}} - 1 \\right) + 2 \\varepsilon_{\\mathrm{si}} q \\frac{n_{\\mathrm{i}}^2}{N_{\\mathrm{A}}} V_{\\mathrm{T}} \\left( e^{\\psi_{\\mathrm{s}}(y)/V_{\\mathrm{T}}} - \\frac{\\psi_{\\mathrm{s}}(y)}{V_{\\mathrm{T}}} - 1 \\right),\n$$\nwhere $q$ is the elementary charge, $n_{\\mathrm{i}}$ is the intrinsic carrier concentration, $V_{\\mathrm{T}} = k_{\\mathrm{B}} T / q$ is the thermal voltage, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $\\varepsilon_{\\mathrm{si}}$ is the permittivity of silicon. The net semiconductor surface charge per unit area is $Q_{\\mathrm{s}}(y) = -\\varepsilon_{\\mathrm{si}} E_{\\mathrm{si}}(y)$, with $Q_{\\mathrm{s}}(y)$ negative for depletion and inversion ($\\psi_{\\mathrm{s}}(y)  0$) and positive for accumulation ($\\psi_{\\mathrm{s}}(y)  0$).\n- Continuity of normal electric displacement at the oxide-semiconductor interface (no free charge at the interface) imposes $\\varepsilon_{\\mathrm{ox}} E_{\\mathrm{ox}}(y) = \\varepsilon_{\\mathrm{si}} E_{\\mathrm{si}}(y)$, where $\\varepsilon_{\\mathrm{ox}}$ is the permittivity of silicon dioxide. Combining the oxide Laplace solution and semiconductor Poisson solution gives a nonlinear constraint on $\\psi_{\\mathrm{s}}(y)$ at each lateral position $y$:\n$$\n\\frac{\\varepsilon_{\\mathrm{ox}}}{t_{\\mathrm{ox}}(y)} \\left( V_{\\mathrm{G}} - V_{\\mathrm{fb}} - \\psi_{\\mathrm{s}}(y) \\right) + Q_{\\mathrm{s}}(\\psi_{\\mathrm{s}}(y)) = 0,\n$$\nwith\n$$\nQ_{\\mathrm{s}}(\\psi) = -\\operatorname{sgn}(\\psi) \\sqrt{A \\left( e^{-\\psi/V_{\\mathrm{T}}} + \\frac{\\psi}{V_{\\mathrm{T}}} - 1 \\right) + B \\left( e^{\\psi/V_{\\mathrm{T}}} - \\frac{\\psi}{V_{\\mathrm{T}}} - 1 \\right)},\n$$\nwhere\n$$\nA = 2 \\varepsilon_{\\mathrm{si}} q N_{\\mathrm{A}} V_{\\mathrm{T}}, \\quad B = 2 \\varepsilon_{\\mathrm{si}} q \\frac{n_{\\mathrm{i}}^2}{N_{\\mathrm{A}}} V_{\\mathrm{T}}.\n$$\n\nTask:\nImplement a program that, for a set of specified lateral oxide thickness profiles $t_{\\mathrm{ox}}(y)$ along the gate of length $L_{\\mathrm{g}}$, computes the spatial variation of the surface potential $\\psi_{\\mathrm{s}}(y)$ by solving the above nonlinear equation independently at each $y$ (quasi-two-dimensional Laplace-Poisson approximation). Use a uniform sampling of $y$ with $N_{y}$ points from $y=0$ to $y=L_{\\mathrm{g}}$. The computed $\\psi_{\\mathrm{s}}(y)$ must be expressed in volts (V), rounded to six decimal places.\n\nPhysical constants and units:\n- Use $\\varepsilon_{0} = 8.854 \\times 10^{-12}$ F/m, $q = 1.602 \\times 10^{-19}$ C, $k_{\\mathrm{B}} = 1.381 \\times 10^{-23}$ J/K.\n- Use $\\varepsilon_{\\mathrm{ox}} = 3.9 \\varepsilon_{0}$ and $\\varepsilon_{\\mathrm{si}} = 11.7 \\varepsilon_{0}$.\n- Use $n_{\\mathrm{i}} = 1.45 \\times 10^{16}$ m$^{-3}$ and $T = 300$ K.\n- All lengths must be in meters (m), voltages in volts (V), concentrations in m$^{-3}$.\n\nTest suite:\nFor all cases, use $N_{y} = 21$ and $V_{\\mathrm{fb}} = 0$ V. For each case, define $t_{\\mathrm{ox}}(y)$ as indicated and compute the list of $\\psi_{\\mathrm{s}}(y)$ values at the $21$ uniformly spaced $y$-locations.\n\n- Case $1$ (uniform oxide, moderate inversion):\n    - $L_{\\mathrm{g}} = 1.0 \\times 10^{-6}$ m,\n    - $t_{0} = 2.0 \\times 10^{-9}$ m,\n    - $t_{\\mathrm{ox}}(y) = t_{0}$,\n    - $V_{\\mathrm{G}} = 1.0$ V,\n    - $N_{\\mathrm{A}} = 1.0 \\times 10^{23}$ m$^{-3}$.\n\n- Case $2$ (sinusoidal variation, moderate inversion):\n    - $L_{\\mathrm{g}} = 1.0 \\times 10^{-6}$ m,\n    - $t_{0} = 2.0 \\times 10^{-9}$ m,\n    - $t_{\\mathrm{ox}}(y) = t_{0} \\left( 1 + 0.5 \\sin\\left( \\frac{2 \\pi y}{L_{\\mathrm{g}}} \\right) \\right)$,\n    - $V_{\\mathrm{G}} = 1.0$ V,\n    - $N_{\\mathrm{A}} = 1.0 \\times 10^{23}$ m$^{-3}$.\n\n- Case $3$ (linear wedge, strong inversion):\n    - $L_{\\mathrm{g}} = 1.0 \\times 10^{-6}$ m,\n    - $t_{\\mathrm{ox}}(y) = 1.5 \\times 10^{-9} + \\left( 3.0 \\times 10^{-9} - 1.5 \\times 10^{-9} \\right) \\frac{y}{L_{\\mathrm{g}}}$ m,\n    - $V_{\\mathrm{G}} = 2.0$ V,\n    - $N_{\\mathrm{A}} = 1.0 \\times 10^{23}$ m$^{-3}$.\n\n- Case $4$ (cosine variation, accumulation):\n    - $L_{\\mathrm{g}} = 1.0 \\times 10^{-6}$ m,\n    - $t_{0} = 2.0 \\times 10^{-9}$ m,\n    - $t_{\\mathrm{ox}}(y) = t_{0} \\left( 1 + 0.3 \\cos\\left( \\frac{\\pi y}{L_{\\mathrm{g}}} \\right) \\right)$,\n    - $V_{\\mathrm{G}} = -0.5$ V,\n    - $N_{\\mathrm{A}} = 1.0 \\times 10^{23}$ m$^{-3}$.\n\nAlgorithmic requirement:\n- At each $y$, solve the scalar nonlinear equation\n$$\nF(\\psi_{\\mathrm{s}}(y)) = \\frac{\\varepsilon_{\\mathrm{ox}}}{t_{\\mathrm{ox}}(y)} \\left( V_{\\mathrm{G}} - V_{\\mathrm{fb}} - \\psi_{\\mathrm{s}}(y) \\right) + Q_{\\mathrm{s}}(\\psi_{\\mathrm{s}}(y)) = 0\n$$\nfor $\\psi_{\\mathrm{s}}(y)$ using a robust root-finding method (for example, bisection with an automatically determined bracket that ensures a sign change). The solution must be found to a tolerance of $10^{-9}$ V in the root of $F$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the $21$ computed $\\psi_{\\mathrm{s}}(y)$ values (in volts, rounded to six decimal places) at uniformly spaced $y$ along the gate length from $0$ to $L_{\\mathrm{g}}$. For example, the output structure must be of the form\n$$\n[\\,[\\psi_{1,1},\\psi_{1,2},\\dots,\\psi_{1,21}],\\,[\\psi_{2,1},\\dots,\\psi_{2,21}],\\,[\\psi_{3,1},\\dots,\\psi_{3,21}],\\,[\\psi_{4,1},\\dots,\\psi_{4,21}]\\,],\n$$\nprinted as a single line with numeric entries rounded to six decimal places and expressed in volts.",
            "solution": "The problem requires the computation of the surface potential profile, $\\psi_{\\mathrm{s}}(y)$, along the channel of a Metal-Oxide-Semiconductor (MOS) device with a laterally varying oxide thickness, $t_{\\mathrm{ox}}(y)$. This is achieved by solving a nonlinear electrostatic equation at discrete points along the lateral dimension $y$. The provided model simplifies the two-dimensional electrostatics using a quasi-2D approximation, where at each lateral position $y$, the problem reduces to a one-dimensional problem in the direction $x$ perpendicular to the gate.\n\nThe core of the problem is to solve the charge balance equation at the oxide-semiconductor interface. This equation results from the continuity of the normal component of the electric displacement field, $\\mathbf{D}$. Given the assumption of no charge at the interface, this continuity is expressed as $\\varepsilon_{\\mathrm{ox}} E_{\\mathrm{ox}}(y) = \\varepsilon_{\\mathrm{si}} E_{\\mathrm{si}}(y)$, where $E_{\\mathrm{ox}}(y)$ and $E_{\\mathrm{si}}(y)$ are the vertical electric fields at the interface ($x=0$) in the oxide and semiconductor, respectively, and $\\varepsilon_{\\mathrm{ox}}$ and $\\varepsilon_{\\mathrm{si}}$ are their corresponding dielectric permittivities.\n\nUnder the thin-oxide approximation, the electric field in the oxide is given by $E_{\\mathrm{ox}}(y) = \\frac{V_{\\mathrm{G}} - V_{\\mathrm{fb}} - \\psi_{\\mathrm{s}}(y)}{t_{\\mathrm{ox}}(y)}$, where $V_{\\mathrm{G}}$ is the applied gate voltage, $V_{\\mathrm{fb}}$ is the flatband voltage, and $\\psi_{\\mathrm{s}}(y)$ is the surface potential. The total charge per unit area in the semiconductor, $Q_{\\mathrm{s}}$, is related to the surface electric field by Gauss's law: $Q_{\\mathrm{s}}(y) = -\\varepsilon_{\\mathrm{si}} E_{\\mathrm{si}}(y)$. Substituting these into the continuity condition yields the nonlinear equation for $\\psi_{\\mathrm{s}}(y)$:\n$$\nF(\\psi_{\\mathrm{s}}(y)) = \\frac{\\varepsilon_{\\mathrm{ox}}}{t_{\\mathrm{ox}}(y)} \\left( V_{\\mathrm{G}} - V_{\\mathrm{fb}} - \\psi_{\\mathrm{s}}(y) \\right) + Q_{\\mathrm{s}}(\\psi_{\\mathrm{s}}(y)) = 0\n$$\nThe semiconductor charge $Q_{\\mathrm{s}}$ is itself a complicated, nonlinear function of the surface potential $\\psi_{\\mathrm{s}}$, derived from integrating the Poisson-Boltzmann equation:\n$$\nQ_{\\mathrm{s}}(\\psi) = -\\operatorname{sgn}(\\psi) \\sqrt{A \\left( e^{-\\psi/V_{\\mathrm{T}}} + \\frac{\\psi}{V_{\\mathrm{T}}} - 1 \\right) + B \\left( e^{\\psi/V_{\\mathrm{T}}} - \\frac{\\psi}{V_{\\mathrm{T}}} - 1 \\right)}\n$$\nwhere $\\psi$ here stands for $\\psi_{\\mathrm{s}}(y)$. The constants are $A = 2 \\varepsilon_{\\mathrm{si}} q N_{\\mathrm{A}} V_{\\mathrm{T}}$ and $B = 2 \\varepsilon_{\\mathrm{si}} q \\frac{n_{\\mathrm{i}}^2}{N_{\\mathrm{A}}} V_{\\mathrm{T}}$, with $q$ being the elementary charge, $N_{\\mathrm{A}}$ the acceptor concentration, $n_{\\mathrm{i}}$ the intrinsic carrier concentration, and $V_{\\mathrm{T}} = k_{\\mathrm{B}} T / q$ the thermal voltage at temperature $T$.\n\nThe task is to solve the equation $F(\\psi_{\\mathrm{s}}) = 0$ for $\\psi_{\\mathrm{s}}$ at $N_y=21$ uniformly spaced points $y \\in [0, L_{\\mathrm{g}}]$ for four different scenarios defined by the oxide thickness profile $t_{\\mathrm{ox}}(y)$ and gate voltage $V_{\\mathrm{G}}$.\n\nOur computational strategy is as follows:\nFirst, all physical constants are defined in SI units. The thermal voltage $V_{\\mathrm{T}}$ and the coefficients $A$ and $B$ are pre-calculated.\n\nSecond, we implement a function to evaluate $Q_{\\mathrm{s}}(\\psi)$. Special care is taken to ensure numerical stability. The expressions $e^{u} - u - 1$ and $e^{-u} + u - 1$ for $u = \\psi/V_{\\mathrm{T}}$ can suffer from catastrophic cancellation when $u$ is close to $0$. We use the `numpy.expm1` function, which computes $e^x - 1$ accurately, to reformulate these expressions. For a positive argument $x$, we compute $e^x - x - 1$ as `np.expm1(x) - x`. This avoids the subtraction of two nearly equal numbers. For a negative argument, the expression is numerically stable as is. The function handles the special case $\\psi=0$ where $Q_{\\mathrm{s}}(0)=0$.\n\nThird, we implement a function that represents the equation to be solved, $F(\\psi_{\\mathrm{s}})$. This function takes $\\psi_{\\mathrm{s}}$ as an input along with the local parameters $t_{\\mathrm{ox}}(y)$, $V_{\\mathrm{G}}$, $V_{\\mathrm{fb}}$, and $N_{\\mathrm{A}}$.\n\nFourth, for each point $y$, we solve $F(\\psi_{\\mathrm{s}}) = 0$ using a robust numerical root-finding algorithm. We use `scipy.optimize.brentq`, which combines bisection, secant, and inverse quadratic interpolation methods. This method requires a bracket $[a, b]$ where $F(a)$ and $F(b)$ have opposite signs. We can determine such a bracket by analyzing the behavior of $F(\\psi_{\\mathrm{s}})$. The function $F(\\psi_{\\mathrm{s}})$ is strictly monotonically decreasing. For an effective gate voltage $V'_{\\mathrm{G}} = V_{\\mathrm{G}} - V_{\\mathrm{fb}}  0$, the solution $\\psi_{\\mathrm{s}}$ must be positive. We can show that $F(V'_{\\mathrm{G}}) = Q_{\\mathrm{s}}(V'_{\\mathrm{G}})  0$ and for a small negative potential like $\\psi_{\\mathrm{s}} = -V_{\\mathrm{T}}$, $F(-V_{\\mathrm{T}})$ is positive. Thus, a valid bracket is $[-V_{\\mathrm{T}}, V'_{\\mathrm{G}}]$. Conversely, for $V'_{\\mathrm{G}}  0$, the solution $\\psi_{\\mathrm{s}}$ is negative. $F(V'_{\\mathrm{G}})$ is positive, and for $\\psi_{\\mathrm{s}} = V_{\\mathrm{T}}$, $F(V_{\\mathrm{T}})$ is negative. Thus, $[V'_{\\mathrm{G}}, V_{\\mathrm{T}}]$ is a valid bracket. This automatic bracketing strategy ensures a robust solution. The case $V'_{\\mathrm{G}} = 0$ yields the trivial solution $\\psi_{\\mathrm{s}} = 0$.\n\nFinally, the main program logic iterates through each of the four test cases. For each case, it discretizes the gate length $L_{\\mathrm{g}}$ into $N_y$ points, calculates the corresponding $t_{\\mathrm{ox}}(y)$ at each point, and then calls the root-finding procedure to compute $\\psi_{\\mathrm{s}}(y)$. The resulting lists of potentials are collected and formatted into a single string as specified in the problem statement, with each value rounded to six decimal places.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the surface potential profile psi_s(y) for a MOS device\n    with varying oxide thickness by solving the nonlinear charge balance equation.\n    \"\"\"\n    # Physical constants in SI units\n    EPS0 = 8.854e-12  # F/m (Vacuum permittivity)\n    Q = 1.602e-19     # C (Elementary charge)\n    KB = 1.381e-23    # J/K (Boltzmann constant)\n    T = 300.0         # K (Absolute temperature)\n    \n    # Material properties\n    EPS_SI = 11.7 * EPS0  # Permittivity of Silicon\n    EPS_OX = 3.9 * EPS0   # Permittivity of Silicon Dioxide\n    N_I = 1.45e16         # m^-3 (Intrinsic carrier concentration in Si at 300K)\n\n    # Derived constants\n    VT = KB * T / Q  # Thermal voltage, approx 0.02587 V\n\n    # Test suite definition\n    test_cases = [\n        {\n            \"Lg\": 1.0e-6,\n            \"t_ox_func\": lambda y, t0, Lg: t0,\n            \"t0\": 2.0e-9,\n            \"Vg\": 1.0,\n            \"Na\": 1.0e23,\n            \"Vfb\": 0.0,\n            \"Ny\": 21,\n        },\n        {\n            \"Lg\": 1.0e-6,\n            \"t_ox_func\": lambda y, t0, Lg: t0 * (1 + 0.5 * np.sin(2 * np.pi * y / Lg)),\n            \"t0\": 2.0e-9,\n            \"Vg\": 1.0,\n            \"Na\": 1.0e23,\n            \"Vfb\": 0.0,\n            \"Ny\": 21,\n        },\n        {\n            \"Lg\": 1.0e-6,\n            \"t_ox_func\": lambda y, t0, Lg: 1.5e-9 + (3.0e-9 - 1.5e-9) * y / Lg,\n            \"t0\": 0, # Not used for this case\n            \"Vg\": 2.0,\n            \"Na\": 1.0e23,\n            \"Vfb\": 0.0,\n            \"Ny\": 21,\n        },\n        {\n            \"Lg\": 1.0e-6,\n            \"t_ox_func\": lambda y, t0, Lg: t0 * (1 + 0.3 * np.cos(np.pi * y / Lg)),\n            \"t0\": 2.0e-9,\n            \"Vg\": -0.5,\n            \"Na\": 1.0e23,\n            \"Vfb\": 0.0,\n            \"Ny\": 21,\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        Lg = case[\"Lg\"]\n        t_ox_func = case[\"t_ox_func\"]\n        t0 = case[\"t0\"]\n        Vg = case[\"Vg\"]\n        Na = case[\"Na\"]\n        Vfb = case[\"Vfb\"]\n        Ny = case[\"Ny\"]\n\n        y_coords = np.linspace(0, Lg, Ny)\n        psi_s_values = []\n\n        # Coefficients for Qs calculation, dependent on Na\n        A = 2 * EPS_SI * Q * Na * VT\n        B = 2 * EPS_SI * Q * (N_I**2 / Na) * VT\n\n        def Qs(psi):\n            if psi == 0:\n                return 0.0\n            \n            arg = psi / VT\n            \n            # Use numerically stable forms to avoid catastrophic cancellation\n            if arg > 0: # psi > 0 (depletion/inversion)\n                term_A_inner = np.exp(-arg) + arg - 1.0\n                term_B_inner = np.expm1(arg) - arg\n            else: # psi  0 (accumulation)\n                term_A_inner = np.expm1(-arg) + arg\n                term_B_inner = np.exp(arg) - arg - 1.0\n            \n            sqrt_term = A * term_A_inner + B * term_B_inner\n            # Should always be non-negative, but defensive check for safety\n            if sqrt_term  0:\n                sqrt_term = 0\n            \n            return -np.sign(psi) * np.sqrt(sqrt_term)\n\n        for y in y_coords:\n            t_ox_y = t_ox_func(y, t0, Lg)\n            C_ox = EPS_OX / t_ox_y\n            \n            V_prime_G = Vg - Vfb\n\n            def F(psi_s):\n                return C_ox * (V_prime_G - psi_s) + Qs(psi_s)\n\n            # Special case for Vg = Vfb\n            if V_prime_G == 0:\n                psi_s_root = 0.0\n            else:\n                # Determine a robust search bracket\n                if V_prime_G > 0:\n                    a, b = -VT, V_prime_G\n                else: # V_prime_G  0\n                    a, b = V_prime_G, VT\n                \n                # Check if bracket is valid, expand if necessary\n                # This ensures F(a) and F(b) have opposite signs\n                if F(a) * F(b) >= 0:\n                    if V_prime_G > 0:\n                       a,b = -2.0, V_prime_G + 1.0\n                    else:\n                       a,b = V_prime_G -1.0, 2.0\n\n                psi_s_root = brentq(F, a, b, xtol=1e-9)\n            \n            psi_s_values.append(psi_s_root)\n        \n        all_results.append(psi_s_values)\n\n    # Format the final output string\n    case_strings = []\n    for case_result in all_results:\n        val_strings = [f\"{val:.6f}\" for val in case_result]\n        case_strings.append(f\"[{','.join(val_strings)}]\")\n    \n    final_output = f\"[[{','.join([f'{val:.6f}' for val in all_results[0]])}],[{','.join([f'{val:.6f}' for val in all_results[1]])}],[{','.join([f'{val:.6f}' for val in all_results[2]])}],[{','.join([f'{val:.6f}' for val in all_results[3]])}]]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}