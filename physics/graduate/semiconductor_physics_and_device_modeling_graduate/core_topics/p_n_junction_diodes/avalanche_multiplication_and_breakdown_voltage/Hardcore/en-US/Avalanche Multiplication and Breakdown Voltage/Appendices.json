{
    "hands_on_practices": [
        {
            "introduction": "Understanding avalanche multiplication begins with its mathematical foundation. This first practice challenges you to derive the relationship between the microscopic process of impact ionization, described by the coefficient $\\alpha(E)$, and the macroscopic avalanche multiplication factor, $M$. By starting from first principles, you will establish the crucial identity that the total number of ionization events is simply $M-1$ and see how $M$ emerges from integrating the ionization rate over the carrier's path.",
            "id": "3729268",
            "problem": "A one-dimensional intrinsic region of thickness $W$ in a reverse-biased $p$-$i$-$n$ diode is subject to a spatially uniform electric field $E$. Consider electron injection at $x=0$ and collection at $x=W$. Assume the following physical model:\n- The electron impact ionization coefficient $\\alpha(E)$ is defined as the expected number of electron-initiated ionization events per unit length per traversing electron in the local electric field $E$.\n- Holes do not ionize (hole ionization coefficient $\\beta(E)=0$).\n- There is no recombination, trapping, or dead-space effect; once created, each electron drifts in the $+x$ direction and obeys the same ionization statistics as any other electron at the same position.\n- Ionization events are locally uncorrelated in the sense that, within a small segment of length $\\mathrm{d}x$, the expected number of ionizations produced by $n$ electrons is $n\\,\\alpha(E)\\,\\mathrm{d}x$.\n\nLet $n_{e}(x)$ denote the expected number of electrons crossing a cross-section at position $x$ per single injected primary electron at $x=0$. The avalanche multiplication factor $M$ is defined as the expected number of electrons collected at $x=W$ per injected primary electron, i.e., $M=n_{e}(W)$.\n\nStarting only from the above definitions and assumptions, derive the relation between the average total number of ionization events per primary electron and $M$, and show how it is equal to an integral of $\\alpha(E)$ weighted by the electron flux $n_{e}(x)$ over the carrier path. Then, for the special case of a spatially uniform field with constant $\\alpha(E)=\\alpha_{0}$, evaluate this integral in closed form to obtain an explicit expression for the average number of ionization events per primary electron as a function of $\\alpha_{0}$ and $W$.\n\nExpress your final answer as a single closed-form analytic expression in terms of $\\alpha_{0}$ and $W$. The final expression is dimensionless; do not include units.",
            "solution": "The problem asks for the derivation of the average total number of ionization events per primary electron in a one-dimensional region of a reverse-biased $p$-$i$-$n$ diode, under a set of simplifying assumptions. The final goal is to express this quantity as a closed-form function of the electron ionization coefficient, $\\alpha_{0}$, and the region thickness, $W$, for the special case of a uniform electric field.\n\nLet $n_{e}(x)$ be the expected number of electrons crossing a plane at position $x \\in [0, W]$, resulting from a single primary electron injected at $x=0$. According to the problem statement, a single electron is injected at $x=0$, so we have the initial condition $n_{e}(0) = 1$.\n\nConsider an infinitesimal segment of the region from $x$ to $x+\\mathrm{d}x$. The expected number of electrons entering this segment is $n_{e}(x)$. Based on the provided physical model, the expected number of new ionization events created by these $n_{e}(x)$ electrons traversing the distance $\\mathrm{d}x$ is given by $n_{e}(x) \\alpha(E) \\mathrm{d}x$. Each ionization event produces a new electron-hole pair. Since we are only considering electrons (hole ionization coefficient $\\beta(E)=0$), each event adds one electron to the electron flux. The change in the expected number of electrons, $\\mathrm{d}n_{e}(x) = n_{e}(x+\\mathrm{d}x) - n_{e}(x)$, is therefore equal to the expected number of new electrons generated in the segment $\\mathrm{d}x$.\n\nThis leads to the differential equation governing the electron flux:\n$$ \\mathrm{d}n_{e}(x) = n_{e}(x) \\alpha(E) \\mathrm{d}x $$\n$$ \\frac{\\mathrm{d}n_{e}}{\\mathrm{d}x} = n_{e}(x) \\alpha(E) $$\n\nThe problem requires us to find the average total number of ionization events per primary electron, which we denote as $N_{ion}$. The number of ionization events occurring in the infinitesimal segment $\\mathrm{d}x$ at position $x$ is $\\mathrm{d}N_{ion} = n_{e}(x)\\alpha(E)\\mathrm{d}x$. To find the total number of events over the entire region of thickness $W$, we must integrate this quantity from $x=0$ to $x=W$:\n$$ N_{ion} = \\int_{0}^{W} n_{e}(x) \\alpha(E) \\mathrm{d}x $$\nThis expression shows that the average total number of ionization events is equal to the integral of the ionization coefficient $\\alpha(E)$ weighted by the electron flux $n_e(x)$ over the carrier path, as requested by the problem.\n\nNext, we derive the relation between $N_{ion}$ and the avalanche multiplication factor $M$. From our differential equation, we have $n_{e}(x) \\alpha(E) \\mathrm{d}x = \\mathrm{d}n_{e}$. Substituting this into the integral for $N_{ion}$:\n$$ N_{ion} = \\int_{x=0}^{x=W} \\mathrm{d}n_{e} = \\int_{n_{e}(0)}^{n_{e}(W)} \\mathrm{d}n_{e} $$\nEvaluating this simple integral gives:\n$$ N_{ion} = n_{e}(W) - n_{e}(0) $$\nBy definition, the avalanche multiplication factor is $M = n_{e}(W)$, and a single primary electron is injected, so $n_{e}(0)=1$. Substituting these values, we obtain the direct relation between the total number of ionization events and the multiplication factor:\n$$ N_{ion} = M - 1 $$\nThis relation is intuitive: the total number of electrons collected at the end, $M$, consists of the original injected electron plus all the electrons generated through ionization. The number of generated electrons is $M-1$, and since each ionization event creates one new electron, this is also the total number of ionization events.\n\nFinally, we are asked to evaluate the average number of ionization events for the special case of a spatially uniform electric field $E$. In this case, the electron ionization coefficient $\\alpha(E)$ is a constant, which we denote by $\\alpha_{0}$. The differential equation for $n_{e}(x)$ becomes:\n$$ \\frac{\\mathrm{d}n_{e}}{\\mathrm{d}x} = \\alpha_{0} n_{e}(x) $$\nThis is a first-order linear homogeneous ordinary differential equation with constant coefficients. We solve it by separation of variables, subject to the initial condition $n_{e}(0)=1$:\n$$ \\int_{n_e(0)}^{n_{e}(x)} \\frac{\\mathrm{d}n'_{e}}{n'_{e}} = \\int_{0}^{x} \\alpha_{0} \\mathrm{d}x' $$\n$$ \\ln\\left(\\frac{n_{e}(x)}{n_{e}(0)}\\right) = \\alpha_{0} x $$\nGiven $n_{e}(0)=1$, we have $\\ln(n_{e}(x)) = \\alpha_{0} x$. Exponentiating both sides yields the electron flux profile:\n$$ n_{e}(x) = \\exp(\\alpha_{0} x) $$\nThe problem asks for the explicit evaluation of the integral for $N_{ion}$ for this case. We substitute the expression for $n_{e}(x)$ and $\\alpha(E)=\\alpha_0$ into the integral formulation for $N_{ion}$:\n$$ N_{ion} = \\int_{0}^{W} n_{e}(x) \\alpha_{0} \\mathrm{d}x = \\int_{0}^{W} \\exp(\\alpha_{0} x) \\alpha_0 \\mathrm{d}x $$\nWe can now evaluate this definite integral:\n$$ N_{ion} = \\alpha_{0} \\int_{0}^{W} \\exp(\\alpha_{0} x) \\mathrm{d}x = \\alpha_{0} \\left[ \\frac{1}{\\alpha_{0}} \\exp(\\alpha_{0} x) \\right]_{0}^{W} $$\n$$ N_{ion} = \\left[ \\exp(\\alpha_{0} x) \\right]_{0}^{W} = \\exp(\\alpha_{0} W) - \\exp(\\alpha_{0} \\cdot 0) $$\n$$ N_{ion} = \\exp(\\alpha_{0} W) - 1 $$\nThis is the closed-form expression for the average number of ionization events per primary electron as a function of $\\alpha_{0}$ and $W$. This result is consistent with our earlier finding that $N_{ion} = M-1$, since for this case, $M = n_{e}(W) = \\exp(\\alpha_{0} W)$.",
            "answer": "$$ \\boxed{\\exp(\\alpha_{0} W) - 1} $$"
        },
        {
            "introduction": "While analytical derivations provide essential physical insight, real semiconductor devices often feature non-uniform electric fields that require numerical solutions. This practice takes the theoretical framework developed in the previous exercise  and applies it to a more realistic p-i-n diode model, accounting for the effect of residual space charge on the field profile. You will implement a 1D solver to compute the multiplication factor $M(V)$, developing essential computational skills and learning how to validate a numerical model against a known analytical solution.",
            "id": "3729253",
            "problem": "Consider a reverse-biased Positive-type–Intrinsic–Negative-type (p-i-n) diode modeled as a one-dimensional (1D) structure consisting solely of an intrinsic region of width $w$ flanked by heavily doped contacts that fully deplete the intrinsic region. Assume the intrinsic region has a uniform net space charge density associated with a residual net doping $N_{\\text{net}}$ (donors positive, acceptors negative), silicon permittivity $\\varepsilon_{\\text{Si}}$, and the elementary charge $q$. A local impact ionization coefficient model for electrons is given by $\\alpha(E) = A \\exp\\!\\left(-\\dfrac{B}{E}\\right)$, where $E$ is the magnitude of the electric field, $A$ has units of $1/\\text{m}$, and $B$ has units of $\\text{V}/\\text{m}$. The avalanche multiplication factor for electron injection at the $p$-side is denoted $M(V)$ at applied reverse bias $V$.\n\nYour task is to implement a self-contained program that, for specified parameters, computes $M(V)$ for the general nonuniform field in the intrinsic region by:\n- Determining the electric field profile $E(x)$ in the intrinsic region for a given applied reverse bias $V$ and uniform $N_{\\text{net}}$, using one-dimensional electrostatics and appropriate boundary conditions that satisfy the total voltage drop across the intrinsic region.\n- Computing the electron-initiated avalanche multiplication $M(V)$ based on the local model of impact ionization along the carrier trajectory through the intrinsic region.\n\nYou must also validate the numerical $M(V)$ against an analytical solution for the special case of a uniform field (that is, $N_{\\text{net}} = 0$), and estimate an effective breakdown voltage under a specified multiplication criterion using both analytical and numerical approaches in the uniform-field case.\n\nFundamental bases you must use:\n- One-dimensional electrostatics, relating the spatial derivative of the electric field to the space charge via $\\dfrac{\\mathrm{d}E}{\\mathrm{d}x} = \\dfrac{\\rho(x)}{\\varepsilon}$, with $\\rho(x) = q N_{\\text{net}}$ for uniform residual doping.\n- The local, electron-only avalanche multiplication model for the mean carrier number evolution along the path, where the mean multiplication factor along the transport direction satisfies a first-order linear ordinary differential equation driven by $\\alpha(E)$, and its solution is the path-ordered exponential of the local ionization coefficient integrated over the intrinsic region.\n\nParameter values, physical units, and test suite:\n- Use silicon permittivity $\\varepsilon_{\\text{Si}} = 11.7\\,\\varepsilon_0$, where $\\varepsilon_0 = 8.854\\,187\\,817\\times 10^{-12}\\,\\text{F}/\\text{m}$, expressed in $\\text{F}/\\text{m}$.\n- Use elementary charge $q = 1.602\\,176\\,634\\times 10^{-19}\\,\\text{C}$, expressed in $\\text{C}$.\n- Use intrinsic region width $w = 10\\,\\mu\\text{m} = 10\\times 10^{-6}\\,\\text{m}$, expressed in $\\text{m}$.\n- Use electron impact ionization parameters $A = 7\\times 10^{7}\\,\\text{m}^{-1}$ and $B = 1.2\\times 10^{8}\\,\\text{V}/\\text{m}$.\n- Assume temperature is fixed so that $\\alpha(E)$ depends only on $E$ as given.\n- Define an effective breakdown criterion as the voltage at which $M(V)$ reaches $M_{\\text{target}} = 10$ (dimensionless).\n\nYou must implement the following four test cases:\n1. Uniform-field validation case: $N_{\\text{net}} = 0$ and $V = 200\\,\\text{V}$. Compute the numerical $M_{\\text{num}}(V)$ and compare it to the analytical uniform-field $M_{\\text{ana}}(V)$ derived from first principles under the assumption of $N_{\\text{net}} = 0$. Report a boolean indicating whether the relative difference $\\left|\\dfrac{M_{\\text{num}}(V) - M_{\\text{ana}}(V)}{M_{\\text{ana}}(V)}\\right|$ is less than $10^{-9}$.\n2. Low-voltage uniform-field magnitude: $N_{\\text{net}} = 0$ and $V = 10\\,\\text{V}$. Compute and report the numerical $M_{\\text{num}}(V)$ as a float (dimensionless).\n3. Slightly nonuniform field case: $N_{\\text{net}} = 1.0\\times 10^{20}\\,\\text{m}^{-3}$ and $V = 200\\,\\text{V}$. Compute and report the numerical $M_{\\text{num}}(V)$ as a float (dimensionless).\n4. Effective breakdown voltage validation under the uniform-field assumption: For $N_{\\text{net}} = 0$, find analytically the voltage $V_{\\text{bd,ana}}$ such that $M(V_{\\text{bd,ana}}) = M_{\\text{target}}$ and, independently, find numerically (by monotone root-bracketing and bisection on $V$) a voltage $V_{\\text{bd,num}}$ such that $M(V_{\\text{bd,num}}) = M_{\\text{target}}$. Report a boolean indicating whether the relative difference $\\left|\\dfrac{V_{\\text{bd,num}} - V_{\\text{bd,ana}}}{V_{\\text{bd,ana}}}\\right|$ is less than $10^{-9}$.\n\nAngle units are not used. All physical quantities must be handled in their specified International System of Units (SI units). The avalanche multiplication $M(V)$ is dimensionless.\n\nFinal output format:\n- Your program should produce a single line of output containing the results of the four test cases as a comma-separated list enclosed in square brackets, in the following order: $[$boolean for Test $1$, float for Test $2$, float for Test $3$, boolean for Test $4]$. For example, the output format must be exactly of the form $[r_1,r_2,r_3,r_4]$.\n\nScientific realism and constraints:\n- Ensure that computed fields $E(x)$ are physically consistent with the specified $V$, $w$, $q$, $\\varepsilon_{\\text{Si}}$, and $N_{\\text{net}}$.\n- Ensure numerical integrations are sufficiently accurate to resolve $M(V)$ for the given parameters.\n- Avoid any external inputs; all parameters are fixed as specified.\n\nThe solution must be derived from the stated fundamental bases, must be scientifically plausible, and must be algorithmically implementable using a modern programming language. The final answers for each test case must be of type boolean or float as specified, and the final output must adhere exactly to the specified single-line format.",
            "solution": "The problem requires the calculation of the avalanche multiplication factor, $M(V)$, in a one-dimensional reverse-biased p-i-n diode. The solution involves determining the electric field profile across the intrinsic region and then integrating the impact ionization coefficient along the carrier path. The problem also mandates validation of the numerical model against analytical solutions in specific cases. All physical quantities are given in SI units.\n\nThe fundamental physical constants and material parameters are:\n-   Elementary charge: $q = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n-   Permittivity of free space: $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\,\\text{F}/\\text{m}$\n-   Silicon relative permittivity: $11.7$ (dimensionless), so $\\varepsilon_{\\text{Si}} = 11.7 \\varepsilon_0$\n-   Intrinsic region width: $w = 10 \\times 10^{-6}\\,\\text{m}$\n-   Electron impact ionization parameters: $A = 7 \\times 10^{7}\\,\\text{m}^{-1}$ and $B = 1.2 \\times 10^{8}\\,\\text{V}/\\text{m}$\n-   Breakdown criterion: $M_{\\text{target}} = 10$\n\n**1. Electric Field Profile, $E(x)$**\n\nThe electric field profile $E(x)$ within the intrinsic region (from $x=0$ at the p-side to $x=w$ at the n-side) is determined by the one-dimensional Poisson's equation. Let $E(x)$ be the magnitude of the electric field, which points in the $-x$ direction for a reverse-biased p-i-n diode. Poisson's equation is:\n$$ \\frac{dE_x}{dx} = \\frac{\\rho(x)}{\\varepsilon_{\\text{Si}}} $$\nwhere $E_x(x) = -E(x)$ is the field component and $\\rho(x) = q N_{\\text{net}}$ is the uniform space charge density. Thus,\n$$ \\frac{d(-E(x))}{dx} = \\frac{q N_{\\text{net}}}{\\varepsilon_{\\text{Si}}} \\implies \\frac{dE}{dx} = -\\frac{q N_{\\text{net}}}{\\varepsilon_{\\text{Si}}} $$\nIntegrating with respect to $x$ yields a linear electric field profile:\n$$ E(x) = E(0) - \\left(\\frac{q N_{\\text{net}}}{\\varepsilon_{\\text{Si}}}\\right) x $$\nThe unknown boundary value $E(0)$ is found by constraining the total voltage drop across the intrinsic region to be the applied reverse bias $V$. This neglects the built-in potential, a valid simplification for large reverse biases as specified by the problem.\n$$ \\int_0^w E(x) dx = V $$\n$$ \\int_0^w \\left[ E(0) - \\left(\\frac{q N_{\\text{net}}}{\\varepsilon_{\\text{Si}}}\\right) x \\right] dx = E(0)w - \\frac{q N_{\\text{net}}}{\\varepsilon_{\\text{Si}}} \\frac{w^2}{2} = V $$\nSolving for $E(0)$:\n$$ E(0) = \\frac{V}{w} + \\frac{q N_{\\text{net}} w}{2\\varepsilon_{\\text{Si}}} $$\nSubstituting this back into the expression for $E(x)$:\n$$ E(x) = \\left(\\frac{V}{w} + \\frac{q N_{\\text{net}} w}{2\\varepsilon_{\\text{Si}}}\\right) - \\frac{q N_{\\text{net}}}{\\varepsilon_{\\text{Si}}} x = \\frac{V}{w} + \\frac{q N_{\\text{net}}}{\\varepsilon_{\\text{Si}}} \\left(\\frac{w}{2} - x\\right) $$\nThis expression defines the electric field magnitude at any position $x$ in the intrinsic region for a given applied voltage $V$ and net doping $N_{\\text{net}}$.\n\n**Special Case: Uniform Field**\nFor a truly intrinsic layer with no residual doping ($N_{\\text{net}} = 0$), the electric field becomes uniform:\n$$ E(x) = \\frac{V}{w} $$\n\n**2. Avalanche Multiplication Factor, $M(V)$**\n\nThe problem specifies electron-only impact ionization, initiated by electrons injected at the p-side ($x=0$). The multiplication factor $M(V)$ is given by the exponential of the integrated ionization coefficient along the electron's path:\n$$ M(V) = \\exp\\left( \\int_0^w \\alpha(E(x)) dx \\right) $$\nwhere the local ionization coefficient is $\\alpha(E) = A \\exp(-B/E)$. The integral to be computed is:\n$$ I_M(V) = \\int_0^w A \\exp\\left( -\\frac{B}{E(x)} \\right) dx $$\nso that $M(V) = \\exp(I_M(V))$. For the general case of a non-uniform field, this integral must be evaluated numerically.\n\n**3. Analytical Solution for the Uniform Field Case ($N_{\\text{net}} = 0$)**\n\nWhen $N_{\\text{net}} = 0$, $E(x) = V/w$ is constant. The integral $I_M(V)$ simplifies significantly:\n$$ I_M(V) = \\int_0^w A \\exp\\left( -\\frac{B}{V/w} \\right) dx = A \\exp\\left( -\\frac{Bw}{V} \\right) \\int_0^w dx = Aw \\exp\\left( -\\frac{Bw}{V} \\right) $$\nThe analytical expression for the multiplication factor is therefore:\n$$ M_{\\text{ana}}(V) = \\exp\\left( Aw \\exp\\left( -\\frac{Bw}{V} \\right) \\right) $$\nThis closed-form solution is used for validation in Test Case $1$ and Test Case $4$.\n\n**4. Analytical Breakdown Voltage for the Uniform Field Case**\n\nThe effective breakdown voltage, $V_{\\text{bd,ana}}$, is defined as the voltage at which $M(V)$ reaches a target value $M_{\\text{target}}$. We solve for $V$ in the equation $M_{\\text{ana}}(V) = M_{\\text{target}}$:\n$$ \\exp\\left( Aw \\exp\\left( -\\frac{Bw}{V_{\\text{bd,ana}}} \\right) \\right) = M_{\\text{target}} $$\nTaking the natural logarithm of both sides twice:\n$$ Aw \\exp\\left( -\\frac{Bw}{V_{\\text{bd,ana}}} \\right) = \\ln(M_{\\text{target}}) $$\n$$ \\exp\\left( -\\frac{Bw}{V_{\\text{bd,ana}}} \\right) = \\frac{\\ln(M_{\\text{target}})}{Aw} $$\n$$ -\\frac{Bw}{V_{\\text{bd,ana}}} = \\ln\\left( \\frac{\\ln(M_{\\text{target}})}{Aw} \\right) $$\nSolving for $V_{\\text{bd,ana}}$:\n$$ V_{\\text{bd,ana}} = \\frac{-Bw}{\\ln\\left( \\frac{\\ln(M_{\\text{target}})}{Aw} \\right)} = \\frac{Bw}{\\ln\\left( \\frac{Aw}{\\ln(M_{\\text{target}})} \\right)} $$\nThis formula provides the analytical breakdown voltage for Test Case $4$.\n\n**5. Numerical Implementation Plan**\n\nA single function will compute $M(V)$ for any given $V$ and $N_{\\text{net}}$. This function will first compute the parameters for the linear field profile $E(x)$. It will then define the integrand function, $\\alpha(E(x))$, and use a high-precision numerical quadrature routine (`scipy.integrate.quad`) to evaluate the integral $I_M(V)$. The returned value will be $\\exp(I_M(V))$. For numerical stability and accuracy, the integration tolerance will be set to a small value (e.g., $10^{-14}$).\n\nFor Test Case $4$, a numerical root-finding algorithm (`scipy.optimize.brentq`) will be used to find the voltage $V_{\\text{bd,num}}$ that solves the equation $M_{\\text{num}}(V) - M_{\\text{target}} = 0$. This requires defining a function that computes the difference for a given $V$ and finding its root within a suitable voltage bracket. The monotonicity of $M(V)$ ensures a unique root.\n\n**Execution of Test Cases:**\n\n-   **Test Case 1 ($V=200\\,\\text{V}, N_{\\text{net}}=0$):** $M_{\\text{num}}(200)$ is computed using the numerical integration of $\\alpha$ over a constant field $E = 200/w$. $M_{\\text{ana}}(200)$ is computed using the analytical formula. The relative difference is checked against the tolerance $10^{-9}$.\n\n-   **Test Case 2 ($V=10\\,\\text{V}, N_{\\text{net}}=0$):** $M_{\\text{num}}(10)$ is computed by the numerical routine and reported as a float.\n\n-   **Test Case 3 ($V=200\\,\\text{V}, N_{\\text{net}}=10^{20}\\,\\text{m}^{-3}$):** The non-uniform field $E(x)$ is calculated, and $M_{\\text{num}}(200)$ is computed via numerical integration of $\\alpha(E(x))$ and reported as a float.\n\n-   **Test Case 4 ($N_{\\text{net}}=0, M=10$):** $V_{\\text{bd,ana}}$ is calculated using its analytical formula. $V_{\\text{bd,num}}$ is found using the numerical root-finder on the function $M_{\\text{num}}(V, 0) - 10$. The relative difference between the two voltages is checked against the tolerance $10^{-9}$.\n\nThis structured approach, combining analytical derivation with high-precision numerical methods, will provide accurate and verifiable results for all test cases as required by the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes avalanche multiplication and breakdown voltage for a p-i-n diode.\n    \"\"\"\n    # --- Constants and Device Parameters ---\n    eps0 = 8.854187817e-12  # F/m\n    q = 1.602176634e-19    # C\n    eps_si = 11.7 * eps0   # F/m\n    w = 10e-6              # m\n    A = 7e7                # 1/m\n    B = 1.2e8              # V/m\n    M_target = 10.0        # dimensionless\n\n    def get_M_numerical(V, N_net):\n        \"\"\"\n        Computes the numerical multiplication factor M for a given voltage V and doping N_net.\n        \"\"\"\n        if V = 0:\n            return 1.0\n\n        # Calculate electric field profile E(x) = E0 - term_N * x\n        # where E0 = E(0)\n        term_N = q * N_net / eps_si\n        E0 = V / w + term_N * w / 2\n\n        # Define the integrand for the multiplication integral\n        def alpha_integrand(x):\n            E_x = E0 - term_N * x\n            # The field should be positive throughout the device for the given parameters.\n            # This check is a safeguard.\n            if E_x = 0:\n                return 0.0\n            return A * np.exp(-B / E_x)\n\n        # Numerically integrate alpha(E(x)) from x=0 to x=w\n        # Set high precision for accurate validation\n        integral_val, _ = quad(alpha_integrand, 0, w, epsabs=1e-14, epsrel=1e-14)\n        \n        # Avalanche multiplication factor M = exp(integral)\n        return np.exp(integral_val)\n\n    def get_M_analytical_uniform(V):\n        \"\"\"\n        Computes the analytical multiplication factor M for the uniform field case (N_net=0).\n        \"\"\"\n        if V = 0:\n            return 1.0\n        # M_ana = exp(A * w * exp(-B * w / V))\n        return np.exp(A * w * np.exp(-B * w / V))\n\n    results = []\n    \n    # --- Test Case 1: Uniform-field validation ---\n    V1, N_net1 = 200.0, 0.0\n    M_num1 = get_M_numerical(V1, N_net1)\n    M_ana1 = get_M_analytical_uniform(V1)\n    rel_diff1 = abs(M_num1 - M_ana1) / M_ana1\n    results.append(rel_diff1  1e-9)\n\n    # --- Test Case 2: Low-voltage uniform-field magnitude ---\n    V2, N_net2 = 10.0, 0.0\n    M_num2 = get_M_numerical(V2, N_net2)\n    results.append(M_num2)\n\n    # --- Test Case 3: Slightly nonuniform field case ---\n    V3, N_net3 = 200.0, 1.0e20\n    M_num3 = get_M_numerical(V3, N_net3)\n    results.append(M_num3)\n\n    # --- Test Case 4: Effective breakdown voltage validation ---\n    # Analytical breakdown voltage formula for uniform field\n    V_bd_ana = (B * w) / np.log(A * w / np.log(M_target))\n\n    # Numerical breakdown voltage via root finding\n    def root_func(V):\n        # M_num(V) must equal M_target. We seek the root of their difference.\n        return get_M_numerical(V, 0.0) - M_target\n\n    # Bracket [200, 220] is known to contain the root, as M(200)10 and M(220)10\n    V_bd_num = brentq(root_func, 200.0, 220.0, xtol=1e-14, rtol=1e-14)\n    \n    rel_diff4 = abs(V_bd_num - V_bd_ana) / V_bd_ana\n    results.append(rel_diff4  1e-9)\n\n    # --- Final Output ---\n    # Format: [boolean, float, float, boolean]\n    # Convert booleans to lowercase 'true'/'false' for clarity, though not strictly required\n    # Python's str(True) is 'True', which is fine as per analysis.\n    formatted_results = []\n    for r in results:\n        if isinstance(r, bool):\n            formatted_results.append(str(r))\n        else:\n            formatted_results.append(f\"{r:.15g}\") # Ensure good precision for floats\n    \n    # Re-evaluating the output format requirement. It asks for [r_1,r_2,r_3,r_4].\n    # str() is sufficient and directly matches the logic. Let's use it.\n    final_output_string = \",\".join(map(str, results))\n    print(f\"[{final_output_string}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A physical model is only as good as its parameters, which must be determined from experimental data. This final practice closes the loop between theory, simulation, and experiment by showing you how to perform parameter extraction. Using a set of measured breakdown voltage data, you will linearize the avalanche breakdown condition and apply linear regression to estimate the empirical parameters $A$ and $B$ of the impact ionization model, including an assessment of their statistical confidence.",
            "id": "3729277",
            "problem": "Consider a family of one-sided abrupt semiconductor junctions where avalanche breakdown is initiated by electrons. Assume the electric field across the depletion region is spatially uniform at breakdown. The electron impact ionization coefficient is modeled by a widely used empirical relation that depends on the electric field, and the avalanche breakdown occurs when the expected number of ionization events over the depletion width equals unity. Using these foundations, derive a relationship between the breakdown voltage, the depletion width, and the unknown parameters characterizing the ionization coefficient. Then transform this relationship into a linear regression form suitable for estimating the unknown parameters and their confidence intervals from measured data. Implement this estimation and confidence interval assessment as a complete program.\n\nYou must adhere to the following assumptions and requirements:\n\n- Base physical principles:\n  - Avalanche breakdown occurs when the integral of the electron impact ionization coefficient over the depletion region equals unity, under the assumption of electron-initiated multiplication and spatially uniform electric field. Let the depletion width be denoted by $W$ and the breakdown voltage by $V_{\\mathrm{B}}$, so the electric field magnitude is $E = V_{\\mathrm{B}}/W$.\n  - The electron impact ionization coefficient depends on the electric field as a monotonic function with two unknown parameters, $A$ and $B$, that must be estimated from data.\n- Transform the breakdown criterion into a linear regression involving $A$ and $B$, using only these base principles and definitions.\n- Use Ordinary Least Squares (OLS) to estimate the linear model parameters, then infer $A$ and $B$ from the fitted linear parameters.\n- Compute two-sided confidence intervals at a confidence level of $95\\%$ for both $A$ and $B$, using the Student's $t$-distribution with appropriate degrees of freedom.\n- Units:\n  - All given depletion widths $W$ are in meters, all breakdown voltages $V_{\\mathrm{B}}$ are in volts.\n  - Express the final estimated $A$ in inverse meters ($\\mathrm{m}^{-1}$) and $B$ in volts per meter ($\\mathrm{V}/\\mathrm{m}$).\n  - Confidence intervals for $A$ and $B$ must be reported in the same units, respectively.\n- Numerical outputs:\n  - For each test case, your program must output a list of six floating-point numbers: $[A_{\\text{hat}}, B_{\\text{hat}}, A_{\\text{low}}, A_{\\text{high}}, B_{\\text{low}}, B_{\\text{high}}]$, where the “hat” denotes the OLS-based point estimate and “low/high” denote the endpoints of the two-sided $95\\%$ confidence interval.\n- Final output format:\n  - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the six-number list for one test case (e.g., $[[a_1,b_1,\\ldots],[a_2,b_2,\\ldots],[a_3,b_3,\\ldots]]$).\n\nTest Suite (use exactly these values):\n- Test Case $1$ (general case, multiple widths):\n  - $W = [1.0 \\times 10^{-6}, 1.5 \\times 10^{-6}, 2.0 \\times 10^{-6}, 2.5 \\times 10^{-6}, 3.0 \\times 10^{-6}]$ (meters)\n  - $V_{\\mathrm{B}} = [44.3, 55.0, 67.2, 76.1, 89.6]$ (volts)\n- Test Case $2$ (boundary case with $A W$ near unity):\n  - $W = [1.1 \\times 10^{-7}, 1.3 \\times 10^{-7}, 1.6 \\times 10^{-7}, 2.0 \\times 10^{-7}]$ (meters)\n  - $V_{\\mathrm{B}} = [118.0, 48.7, 34.5, 28.3]$ (volts)\n- Test Case $3$ (outlier case):\n  - $W = [0.8 \\times 10^{-6}, 1.1 \\times 10^{-6}, 1.6 \\times 10^{-6}, 2.2 \\times 10^{-6}]$ (meters)\n  - $V_{\\mathrm{B}} = [38.9, 60.0, 57.2, 70.5]$ (volts)\n\nYour program should implement the linear transformation derived from the breakdown condition, fit the linear model by OLS for each test case, compute the two-sided $95\\%$ confidence intervals via the Student's $t$-distribution, transform the intercept-based confidence interval correctly into a confidence interval for $A$, and print a single line in the exact format specified above. All computations must be carried out in International System of Units; no unit conversions are required beyond using the given meters and volts directly. No angles are involved in this problem.",
            "solution": "The objective is to estimate the physical parameters $A$ and $B$ of an empirical model for the electron impact ionization coefficient in a semiconductor, based on measured breakdown voltage ($V_{\\mathrm{B}}$) and depletion width ($W$) data. This involves deriving a linear model from the physical principles of avalanche breakdown, applying Ordinary Least Squares (OLS) regression to estimate the model coefficients, and calculating the $95\\%$ confidence intervals for the physical parameters $A$ and $B$.\n\nThe derivation and algorithmic design proceed as follows:\n\n**1. Physical Model and Linearization**\n\nThe problem is founded on three core principles and definitions:\n1.  The avalanche breakdown condition for electron-initiated multiplication is given by the ionization integral equating to unity:\n    $$ \\int_0^W \\alpha_n(E) \\,dx = 1 $$\n    where $\\alpha_n$ is the electron impact ionization coefficient and $W$ is the depletion width.\n2.  The electric field $E$ across the depletion region is assumed to be spatially uniform, given by:\n    $$ E = \\frac{V_{\\mathrm{B}}}{W} $$\n    where $V_{\\mathrm{B}}$ is the breakdown voltage.\n3.  The ionization coefficient $\\alpha_n(E)$ is described by the widely used two-parameter empirical model, Chynoweth's Law:\n    $$ \\alpha_n(E) = A \\exp\\left(-\\frac{B}{E}\\right) $$\n    where $A$ and $B$ are the unknown parameters to be estimated.\n\nUnder the uniform field assumption, $E$ is constant with respect to the integration variable $x$. Therefore, the breakdown condition simplifies to:\n$$ \\alpha_n(E) \\int_0^W \\,dx = 1 \\implies A \\exp\\left(-\\frac{B}{E}\\right) W = 1 $$\nThis single equation relates the measurable quantities ($W$, $V_{\\mathrm{B}}$) to the unknown parameters ($A$, $B$). To estimate $A$ and $B$ using linear regression, we must transform this non-linear equation into a linear form. This is achieved by taking the natural logarithm of both sides:\n$$ \\ln\\left(A W \\exp\\left(-\\frac{B}{E}\\right)\\right) = \\ln(1) $$\n$$ \\ln(A) + \\ln(W) - \\frac{B}{E} = 0 $$\nRearranging this equation to match the standard linear form $y = mx+c$:\n$$ \\ln(W) = \\frac{B}{E} - \\ln(A) $$\nSubstituting $E = V_{\\mathrm{B}}/W$, we arrive at the final linear model:\n$$ \\ln(W) = B \\left(\\frac{W}{V_{\\mathrm{B}}}\\right) - \\ln(A) $$\nThis equation is in the form of a straight line, where we can define:\n-   Dependent variable: $y = \\ln(W)$\n-   Independent variable: $x = W/V_{\\mathrm{B}}$\n-   Slope: $m = B$\n-   Intercept: $c = -\\ln(A)$\n\n**2. Parameter Estimation via Ordinary Least Squares (OLS)**\n\nGiven a set of $n$ data points $(W_i, V_{\\mathrm{B},i})$, we first transform them into $(x_i, y_i)$ pairs. OLS regression is then used to find the slope $\\hat{m}$ and intercept $\\hat{c}$ that minimize the sum of squared residuals. The standard OLS estimators are:\n$$ \\hat{m} = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2} $$\n$$ \\hat{c} = \\bar{y} - \\hat{m}\\bar{x} $$\nwhere $\\bar{x}$ and $\\bar{y}$ are the sample means of the transformed data.\n\nFrom these fitted linear coefficients, the point estimates for the physical parameters $A$ and $B$ are:\n$$ \\hat{B} = \\hat{m} $$\n$$ \\hat{A} = \\exp(-\\hat{c}) $$\n\n**3. Confidence Interval Assessment**\n\nTo assess the uncertainty in our estimates, we compute the two-sided $95\\%$ confidence intervals. This requires the standard errors of the OLS estimates and the critical value from the Student's $t$-distribution. The degrees of freedom for the regression are $\\nu = n-p$, where $n$ is the number of data points and $p=2$ is the number of estimated parameters (slope and intercept). Thus, $\\nu = n-2$.\n\nThe standard error of the regression, $s_e$, is calculated from the sum of squared residuals:\n$$ s_e = \\sqrt{\\frac{1}{n-2} \\sum_{i=1}^n (y_i - (\\hat{m}x_i + \\hat{c}))^2} $$\nThe standard errors for the slope ($\\hat{m}$) and intercept ($\\hat{c}$) are then:\n$$ se(\\hat{m}) = \\frac{s_e}{\\sqrt{\\sum(x_i - \\bar{x})^2}} $$\n$$ se(\\hat{c}) = s_e \\sqrt{\\frac{1}{n} + \\frac{\\bar{x}^2}{\\sum(x_i - \\bar{x})^2}} $$\nThe $95\\%$ confidence interval for a parameter $\\theta$ is $[\\hat{\\theta} \\mp t_{0.975, n-2} \\cdot se(\\hat{\\theta})]$, where $t_{0.975, n-2}$ is the upper critical value of the $t$-distribution for a probability of $0.975$.\n\n**Confidence Interval for B:**\nSince $\\hat{B} = \\hat{m}$, the confidence interval for $B$ is identical to the confidence interval for the slope $m$:\n$$ [B_{\\text{low}}, B_{\\text{high}}] = [\\hat{m} - t_{0.975, n-2} \\cdot se(\\hat{m}), \\quad \\hat{m} + t_{0.975, n-2} \\cdot se(\\hat{m})] $$\n\n**Confidence Interval for A:**\nThe parameter $A$ is a non-linear function of the intercept, $A = \\exp(-c)$. We find the confidence interval for $A$ by transforming the endpoints of the confidence interval for $c$. Let the interval for $c$ be $[c_{\\text{low}}, c_{\\text{high}}]$. Since the function $f(c) = \\exp(-c)$ is monotonically decreasing, the upper bound for $A$ corresponds to the lower bound for $c$, and vice versa:\n$$ c_{\\text{low}} = \\hat{c} - t_{0.975, n-2} \\cdot se(\\hat{c}) $$\n$$ c_{\\text{high}} = \\hat{c} + t_{0.975, n-2} \\cdot se(\\hat{c}) $$\n$$ A_{\\text{low}} = \\exp(-c_{\\text{high}}) $$\n$$ A_{\\text{high}} = \\exp(-c_{\\text{low}}) $$\nThe resulting confidence interval for $A$ is $[A_{\\text{low}}, A_{\\text{high}}]$.\n\nThe overall algorithm is implemented for each test case to compute the six required values: $[\\hat{A}, \\hat{B}, A_{\\text{low}}, A_{\\text{high}}, B_{\\text{low}}, B_{\\text{high}}]$. All calculations are performed using the provided data in their given SI units (meters and volts), resulting in final units of $\\mathrm{m}^{-1}$ for $A$ and $\\mathrm{V}/\\mathrm{m}$ for $B$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves for the avalanche breakdown parameters A and B and their 95% CIs\n    for a series of test cases based on measured breakdown data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"W\": np.array([1.0e-6, 1.5e-6, 2.0e-6, 2.5e-6, 3.0e-6]),\n            \"V_B\": np.array([44.3, 55.0, 67.2, 76.1, 89.6])\n        },\n        {\n            \"W\": np.array([1.1e-7, 1.3e-7, 1.6e-7, 2.0e-7]),\n            \"V_B\": np.array([118.0, 48.7, 34.5, 28.3])\n        },\n        {\n            \"W\": np.array([0.8e-6, 1.1e-6, 1.6e-6, 2.2e-6]),\n            \"V_B\": np.array([38.9, 60.0, 57.2, 70.5])\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        W = case[\"W\"]\n        V_B = case[\"V_B\"]\n        \n        n = len(W)\n        if n = 2:\n            # Not enough data points for regression with 2 parameters\n            # and subsequent confidence interval calculation (df=n-2 would be =0).\n            # This case is not in the test suite but is handled for robustness.\n            all_results.append([float('nan')] * 6)\n            continue\n\n        # 1. Transform data for linear regression\n        # y = ln(W), x = W/V_B\n        x = W / V_B\n        y = np.log(W)\n        \n        # 2. Perform Ordinary Least Squares (OLS) regression\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n        \n        ss_xx = np.sum((x - x_mean)**2)\n        ss_xy = np.sum((x - x_mean) * (y - y_mean))\n        \n        # Estimate slope (m_hat) and intercept (c_hat)\n        m_hat = ss_xy / ss_xx\n        c_hat = y_mean - m_hat * x_mean\n        \n        # 3. Estimate physical parameters A and B\n        # B_hat = m_hat\n        # A_hat = exp(-c_hat)\n        B_hat = m_hat\n        A_hat = np.exp(-c_hat)\n        \n        # 4. Calculate confidence intervals\n        # Degrees of freedom for t-distribution\n        dof = n - 2\n        \n        # Critical t-value for 95% confidence\n        # ppf(0.975) gives the t-value for a two-sided test\n        t_crit = stats.t.ppf(0.975, dof)\n        \n        # Calculate standard error of the regression\n        y_pred = m_hat * x + c_hat\n        residuals = y - y_pred\n        s_e = np.sqrt(np.sum(residuals**2) / dof)\n        \n        # Standard error of the slope (m) and intercept (c)\n        se_m = s_e / np.sqrt(ss_xx)\n        se_c = s_e * np.sqrt(1/n + x_mean**2 / ss_xx)\n        \n        # Confidence interval for B (from slope m)\n        B_margin = t_crit * se_m\n        B_low = B_hat - B_margin\n        B_high = B_hat + B_margin\n        \n        # Confidence interval for A (by transforming CI of intercept c)\n        c_margin = t_crit * se_c\n        c_low = c_hat - c_margin\n        c_high = c_hat + c_margin\n        \n        # A = exp(-c), which is a monotonically decreasing function.\n        # So A_low corresponds to c_high and A_high corresponds to c_low.\n        A_low = np.exp(-c_high)\n        A_high = np.exp(-c_low)\n        \n        result_for_case = [A_hat, B_hat, A_low, A_high, B_low, B_high]\n        all_results.append(result_for_case)\n\n    # Final print statement in the exact required format: [[...],[...],...]\n    # Using str() and replace() to get the comma-separated format without spaces.\n    final_output_string = str(all_results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}