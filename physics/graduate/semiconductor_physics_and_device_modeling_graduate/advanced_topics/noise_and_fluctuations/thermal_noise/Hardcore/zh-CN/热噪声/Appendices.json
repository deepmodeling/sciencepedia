{
    "hands_on_practices": [
        {
            "introduction": "任何耗散元件都会因电荷载流子的热运动而产生热噪声，这是电子系统中噪声的一个基本来源。本练习将引导你从最基本的无源元件——电阻器——出发，应用约翰逊-奈奎斯特（Johnson-Nyquist）噪声理论。通过这个实践，你将掌握如何从功率谱密度（PSD）出发，计算在给定带宽下电阻两端的总均方根（RMS）噪声电压，这是所有噪声分析的基础 。",
            "id": "4304678",
            "problem": "一个处于热平衡状态的无源电阻器，由于载流子的热骚动，会表现出随机的电压波动。考虑一个阻值为 $R=1\\,\\text{k}\\Omega$ 的电阻器，其温度保持在 $T=300\\,\\text{K}$。其电压通过一个理想的线性时不变砖墙滤波器进行观测，该滤波器的幅频响应在单边频率区间 $0 \\le f \\le B$ 内为1，在其他频率处为0，其中 $B=100\\,\\text{kHz}$ 是平坦测量带宽。假设在感兴趣的频带内处于经典状态，即 $h f \\ll k_B T$，将电阻器的热噪声在该频带内视作白噪声，并使用单边功率谱密度进行描述。\n\n从 Johnson–Nyquist 定理和电压噪声功率谱密度的定义出发，并利用均方噪声与通过线性时不变系统的谱积分之间的关系，推导出滤波器输出端的均方根输出噪声电压。使用玻尔兹曼常数的值 $k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$，并忽略任何负载或额外的噪声源。\n\n计算最终的数值，并以微伏为单位表示。将您的答案四舍五入到四位有效数字。",
            "solution": "问题要求计算连接到处于热平衡状态的电阻器上的理想滤波器输出端的均方根（RMS）噪声电压。推导从 Johnson–Nyquist 定理开始，该定理描述了由电阻器产生的热噪声。\n\n首先，我们来验证问题的陈述。\n已知条件如下：\n- 电阻值：$R = 1\\,\\text{k}\\Omega = 1000\\,\\Omega$\n- 温度：$T = 300\\,\\text{K}$\n- 滤波器类型：理想线性时不变（LTI）砖墙滤波器\n- 滤波器幅频响应：$|H(f)| = 1$ 对于 $0 \\le f \\le B$ 且 $|H(f)| = 0$ 对于 $f > B$\n- 测量带宽：$B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n- 物理常数：玻尔兹曼常数，$k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$\n- 假设：系统处于经典状态，其中 $hf \\ll k_B T$。\n- 假设：电阻器的热噪声在感兴趣的频带内是白噪声。\n- 假设：使用单边功率谱密度进行描述。\n- 目标：推导并计算 RMS 输出噪声电压 $v_{\\text{rms}}$ 的数值，以微伏为单位，并四舍五入到四位有效数字。\n\n该问题具有科学依据，提法恰当且客观。物理参数是现实的，并且对于给定的温度和频率范围，经典近似是有效的。问题陈述是完整的且内部一致。因此，该问题是有效的，我们可以继续进行求解。\n\n根据 Johnson–Nyquist 定理，一个在绝对温度 $T$ 下的电阻 $R$ 的热噪声可以被建模为一个噪声电压源。问题指定使用单边功率谱密度（PSD），它描述了噪声功率在正频率上的分布。对于处于经典状态的电阻器，其单边电压噪声功率谱密度（记为 $S_v(f)$）是白噪声（即不随频率变化），由下式给出：\n$$ S_v(f) = 4 k_B T R $$\n$S_v(f)$ 的单位是伏特平方每赫兹（$\\text{V}^2/\\text{Hz}$）。\n\n该噪声电压通过一个频率响应为 $H(f)$ 的理想 LTI 滤波器。输出电压的功率谱密度 $S_{out}(f)$ 与输入功率谱密度 $S_v(f)$ 的关系如下式所示：\n$$ S_{out}(f) = |H(f)|^2 S_v(f) $$\n\n输出端的均方电压 $\\langle v_{out}^2 \\rangle$ 是通过对输出功率谱密度在所有频率上积分得到的。由于我们使用的是单边功率谱密度，积分从 $f=0$ 到 $f=\\infty$ 进行：\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} S_{out}(f) \\, df = \\int_{0}^{\\infty} |H(f)|^2 S_v(f) \\, df $$\n\n现在，我们代入 $S_v(f)$ 和 $|H(f)|$ 的表达式。噪声功率谱密度为 $S_v(f) = 4 k_B T R$。该滤波器是一个理想砖墙滤波器，其幅频响应为：当 $0 \\le f \\le B$ 时 $|H(f)| = 1$，当 $f > B$ 时 $|H(f)| = 0$。因此，$|H(f)|^2$ 是一个矩形函数：\n$$\n|H(f)|^2 =\n\\begin{cases}\n1  \\text{for } 0 \\le f \\le B \\\\\n0  \\text{for } f > B\n\\end{cases}\n$$\n\n将这些代入均方输出电压的积分中：\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} |H(f)|^2 (4 k_B T R) \\, df $$\n由于 $4 k_B T R$ 是一个常数，我们可以将其从积分中提出：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\int_{0}^{\\infty} |H(f)|^2 \\, df $$\n我们现在使用滤波器的响应定义来计算该积分：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\left( \\int_{0}^{B} 1 \\, df + \\int_{B}^{\\infty} 0 \\, df \\right) $$\n第二个积分为零。第一个积分的计算结果为：\n$$ \\int_{0}^{B} 1 \\, df = [f]_{0}^{B} = B - 0 = B $$\n因此，均方输出噪声电压为：\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R B $$\n\n问题要求的是均方根（RMS）输出噪声电压 $v_{\\text{rms}}$，即均方电压的平方根：\n$$ v_{\\text{rms}} = \\sqrt{\\langle v_{out}^2 \\rangle} = \\sqrt{4 k_B T R B} $$\n\n现在，我们将给定的数值代入此表达式：\n- $k_B = 1.380649 \\times 10^{-23}\\,\\text{J}/\\text{K}$\n- $T = 300\\,\\text{K}$\n- $R = 1000\\,\\Omega$\n- $B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n\n$$ v_{\\text{rms}} = \\sqrt{4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5} $$\n我们来计算平方根内的值：\n$$ 4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5 = 4 \\times 1.380649 \\times 3 \\times 10^{-23} \\times 10^2 \\times 10^3 \\times 10^5 $$\n$$ = 12 \\times 1.380649 \\times 10^{-23+2+3+5} = 16.567788 \\times 10^{-13} $$\n为了方便开方，可以将其写成更方便的形式：\n$$ 1.6567788 \\times 10^{-12} \\,\\text{V}^2 $$\n现在我们取平方根：\n$$ v_{\\text{rms}} = \\sqrt{1.6567788 \\times 10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} = \\sqrt{1.6567788} \\times \\sqrt{10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} \\approx 1.28715919 \\times 10^{-6} \\,\\text{V} $$\n\n问题要求结果以微伏（$\\mu\\text{V}$）表示，其中 $1\\,\\mu\\text{V} = 10^{-6}\\,\\text{V}$。\n$$ v_{\\text{rms}} \\approx 1.28715919 \\,\\mu\\text{V} $$\n最后，我们将结果四舍五入到四位有效数字。第五位有效数字是 1，因此我们向下舍入。\n$$ v_{\\text{rms}} \\approx 1.287 \\,\\mu\\text{V} $$\n这就是最终的数值答案。",
            "answer": "$$\n\\boxed{1.287}\n$$"
        },
        {
            "introduction": "在掌握了无源元件的噪声计算后，我们将注意力转向现代电子学的核心——有源器件，特别是MOSFET。为了在电路层面上方便地分析和比较晶体管的噪声性能，工程师们发展了“输入参考噪声”这一关键概念。本练习  将指导你推导MOSFET的输入参考栅极电压噪声谱密度，从而将沟道内部的物理噪声源与一个等效到栅极的、更便于电路分析的电压源联系起来。",
            "id": "3782300",
            "problem": "一个在绝对温度 $T$ 下工作于强反型和饱和区的金属氧化物半导体场效应晶体管 (MOSFET) 会表现出沟道热噪声。在一个低频闪烁噪声机制和高频感应栅极噪声可忽略不计的中频范围内，该噪声可被建模为一个与输出并联的白噪声漏极电流源。假设栅极漏电流可忽略不计，因此栅极端是纯电容性且无噪声的，并忽略串联电阻。设跨导由工作点附近的 $g_{m}=\\partial I_{D}/\\partial V_{GS}$ 定义。沟道热噪声源于微观载流子动量弛豫，并受涨落耗散定理的约束，其中无量纲过剩噪声因子 $\\gamma$ 用于计入分布式沟道和速度分布的影响。\n\n将输入等效栅极电压噪声功率谱密度 (PSD) $S_{v_{g}}(f)$ 定义为一个与栅极串联的等效小电压源的功率谱密度，该电压源通过无噪声的小信号跨导 $g_m$，产生与内在沟道热噪声源相同的漏极电流噪声功率谱密度。仅使用小信号线性化、针对耗散沟道的涨落耗散观点以及通过漏极等效性定义的输入等效噪声，推导出一个用玻尔兹曼常数 $k_{B}$、绝对温度 $T$、过剩噪声因子 $\\gamma$ 和跨导 $g_{m}$ 表示的 $S_{v_{g}}(f)$ 的闭式解析表达式。\n\n将您的最终结果表示为单一的解析表达式。无需进行数值计算。",
            "solution": "问题陈述的解析和验证如下。\n\n**已知条件：**\n- 一个 MOSFET 工作在绝对温度 $T$ 下的强反型和饱和区。\n- 噪声源是沟道热噪声，在中频范围内建模为一个白噪声漏极电流源。\n- 假设：栅极漏电流可忽略，栅极无噪声，串联电阻可忽略。\n- 定义：跨导 $g_{m}=\\partial I_{D}/\\partial V_{GS}$；无量纲过剩噪声因子 $\\gamma$。\n- 输入等效栅极电压噪声功率谱密度 (PSD) $S_{v_{g}}(f)$ 被定义为一个与栅极串联的等效电压源的 PSD，该电压源产生的漏极电流噪声 PSD 与内在沟道热噪声相同。\n- 推导必须使用小信号线性化、涨落耗散观点和输入等效噪声的定义。\n\n**验证：**\n1.  **科学依据：** 该问题基于 MOSFET 沟道热噪声的标准且成熟的 Johnson-Nyquist 模型，该模型是涨落耗散定理的直接推论。使用跨导 $g_m$ 和过剩噪声因子 $\\gamma$ 是半导体器件建模中的标准做法。输入等效噪声的概念是模拟电路分析中的一项基本技术。该问题在科学上是合理的。\n2.  **良构性：** 该问题是良构的。它要求用一组明确定义的参数（$k_B$、$T$、$\\gamma$、$g_m$）来表示一个特定的量 $S_{v_{g}}(f)$。推导方法受到明确约束，确保了通往解的唯一路径。\n3.  **客观性：** 语言是技术性的、精确的，没有主观性或歧义。所有术语都是电子学和物理学领域的标准术语。\n4.  **完整性与一致性：** 该问题提供了所有必要的信息，并清楚地说明了其简化假设（例如，中频范围、可忽略的寄生电阻）。不存在任何矛盾。\n\n**结论：** 该问题是有效的，并且可以按所述方式求解。\n\n**求解推导：**\n问题要求推导输入等效栅极电压噪声功率谱密度 $S_{v_{g}}(f)$。该推导分两个主要步骤进行：首先，建立输出漏极电流噪声 PSD 的表达式；其次，将此噪声折算回栅极处的等效噪声源。\n\n根据涨落耗散定理，任何处于温度 $T$ 下热平衡状态的耗散元件都会表现出热噪声。对于一个电阻为 $R$ 的简单电阻器，这体现为一个电压噪声源，其 PSD 为 $S_v(f) = 4k_BTR$，或一个电流噪声源，其 PSD 为 $S_i(f) = 4k_BT/R = 4k_BTG$，其中 $G$ 是电导，$k_B$ 是玻尔兹曼常数。这种噪声是“白色的”，意味着其 PSD 在很宽的频率范围内与频率 $f$ 无关。\n\n在一个工作于饱和区的 MOSFET 中，沟道是一个分布式阻性元件，其中载流子（电子或空穴）处于随机热运动中。这种运动引起漏极电流的涨落，从而构成了沟道热噪声。问题陈述该噪声被建模为一个与漏源两端并联的电流源。此漏极电流噪声的功率谱密度 $S_{i_d}(f)$ 由一个修正形式的 Nyquist 公式给出。饱和沟道的有效产噪电导被证明与跨导 $g_m$ 成正比，而不是使用输出电导 $g_{ds}$。其表达式为：\n$$\nS_{i_d}(f) = 4 k_B T \\gamma g_m\n$$\n此处，$\\gamma$ 是无量纲过剩噪声因子，它计入了沿沟道的不均匀电势和电荷分布，以及可能的热载流子效应。对于饱和区的长沟道 MOSFET，理论预测 $\\gamma = 2/3$。在指定的中频范围内，该噪声是白噪声。\n\n下一步是找到等效的输入参考电压噪声 $v_g$。根据定义，这是一个与现已无噪声的晶体管的栅极串联放置的虚拟电压噪声源，它在漏极产生的噪声电流与原始的内在噪声源完全相同。\n\n使用 MOSFET 的小信号模型，由小信号栅极电压 $v_g$ 产生的漏极电流 $i_{d,out}$ 可由下式给出：\n$$\ni_{d,out} = g_m v_g\n$$\n问题指定在该变换中跨导 $g_m$ 被认为是无噪声的。为了关联功率谱密度，我们使用线性时不变系统的一个性质：输出 PSD 等于输入 PSD 乘以传递函数幅度的平方。在这种情况下，从输入电压噪声到输出电流噪声的传递函数是 $g_m$。因此，由输入等效源产生的输出电流的 PSD 为：\n$$\nS_{i_{d,out}}(f) = |g_m|^2 S_{v_g}(f) = g_m^2 S_{v_g}(f)\n$$\n根据输入等效噪声的定义，此输出噪声 PSD 必须等于内在漏极电流噪声 PSD，$S_{i_d}(f)$。\n$$\nS_{i_{d,out}}(f) = S_{i_d}(f)\n$$\n代入两个 PSD 的表达式：\n$$\ng_m^2 S_{v_g}(f) = 4 k_B T \\gamma g_m\n$$\n为了求得输入等效栅极电压噪声 PSD，$S_{v_g}(f)$，我们通过将两边同除以 $g_m^2$ 来求解。由于对于一个正常工作的晶体管，$g_m > 0$，这是一个有效的操作。\n$$\nS_{v_g}(f) = \\frac{4 k_B T \\gamma g_m}{g_m^2}\n$$\n简化表达式得到最终结果：\n$$\nS_{v_g}(f) = \\frac{4 k_B T \\gamma}{g_m}\n$$\n这就是在给定假设下，饱和区 MOSFET 的输入等效栅极电压噪声 PSD 的闭式解析表达式。结果与频率 $f$ 无关，这与白噪声模型一致。",
            "answer": "$$\n\\boxed{\\frac{4 k_{B} T \\gamma}{g_{m}}}\n$$"
        },
        {
            "introduction": "理论模型和计算是理解噪声的基础，但最终我们需要将它们与实际测量相结合。这个最终的实践练习构建了从理论到应用的桥梁。本练习  模拟了在半导体器件表征中的一个典型任务：从测量的噪声数据中提取关键的模型参数，即过剩噪声因子 $\\gamma$。你需要设计一种方法，在存在闪烁噪声（$1/f$ 噪声）等其他噪声源的情况下，准确地分离并量化沟道热噪声。",
            "id": "3782293",
            "problem": "您的任务是设计并实现一种基于原理的方法，使用紧凑晶体管模型从测量的漏极电流噪声谱中提取金属-氧化物-半导体场效应晶体管 (MOSFET) 的过剩沟道热噪声因子 $\\gamma$。该方法必须从涨落-耗散原理和针对线性导体的 Johnson-Nyquist 结果出发，并将小信号体系下的 MOSFET 沟道视为一个具有紧凑模型导出的小信号沟道电导的分布式电阻元件。您的方法必须论证选择频率窗口以从低频 $1/f$ 贡献和高频整形中分离出白热噪声的合理性，提供清晰的拟合策略，并强制施加具有物理意义的约束。最终的数值估计器必须实现为一个可复现的算法，并应用于给定的测试套件。\n\n使用以下科学基础作为您的起点，并且除了这些基础之外，不假定任何简化的器件噪声公式：\n- 线性导体的涨落-耗散定理：电流噪声功率谱密度与导纳的实部和绝对温度成正比。\n- 处于热平衡状态下导体的 Johnson-Nyquist 结果：白噪声与绝对温度和电导成比例。\n- 紧凑晶体管模型在工作偏置下提供了一个小信号沟道电导 $g_{\\mathrm{ch}}$。\n\n您的方法必须：\n- 定义一个 $\\gamma$ 的频域估计器，该估计器能移除已知的非热贡献，仅使用由频率窗口 $[f_{\\min}, f_{\\max}]$ 确定的白噪声频带，并产生一个非负估计值。\n- 论证跨频率的加权和聚合方法的合理性，并解释您的估计器如何通过 $g_{\\mathrm{ch}}$ 将导体的结果与 MOSFET 沟道联系起来。\n- 用明确的单位表示所有物理量，并确保量纲一致性。\n\n将您的估计器实现为一个遵循下述输出规范的程序，并将其应用于以下测试套件。对于每个测试用例，您将获得频率点数组、测量的漏极电流噪声谱密度数组，以及紧凑模型的沟道电导和无关参数。所有谱密度均为单边谱，单位为 $\\mathrm{A}^2/\\mathrm{Hz}$，频率单位为 $\\mathrm{Hz}$，电导单位为 $\\mathrm{S}$，温度单位为 $\\mathrm{K}$，$1/f$ 系数单位为 $\\mathrm{A}^2$。\n\n测试套件：\n- 用例 1（理想情况，室温，中等电导）：\n    - $T = 300\\,\\mathrm{K}$，$g_{\\mathrm{ch}} = 1.0\\times 10^{-2}\\,\\mathrm{S}$，$K = 2.0\\times 10^{-19}\\,\\mathrm{A}^2$，$S_{\\mathrm{floor}} = 0.0\\,\\mathrm{A}^2/\\mathrm{Hz}$，\n    - $f = [1.0\\times 10^{3},\\,3.0\\times 10^{3},\\,1.0\\times 10^{4},\\,3.0\\times 10^{4},\\,1.0\\times 10^{5},\\,3.0\\times 10^{5},\\,1.0\\times 10^{6}]$，\n    - $S_{I_d}(f) = [3.32542304\\times 10^{-22},\\,1.99208971\\times 10^{-22},\\,1.52542304\\times 10^{-22},\\,1.39208971\\times 10^{-22},\\,1.34542304\\times 10^{-22},\\,1.33208971\\times 10^{-22},\\,1.32742304\\times 10^{-22}]$，\n    - $f_{\\min} = 3.0\\times 10^{4}\\,\\mathrm{Hz}$，$f_{\\max} = 3.0\\times 10^{5}\\,\\mathrm{Hz}$。\n- 用例 2（窗口边界在低频段受 $1/f$ 噪声主导，室温，较小电导）：\n    - $T = 300\\,\\mathrm{K}$，$g_{\\mathrm{ch}} = 5.0\\times 10^{-3}\\,\\mathrm{S}$，$K = 1.0\\times 10^{-18}\\,\\mathrm{A}^2$，$S_{\\mathrm{floor}} = 0.0\\,\\mathrm{A}^2/\\mathrm{Hz}$，\n    - $f = [1.0\\times 10^{3},\\,3.0\\times 10^{3},\\,1.0\\times 10^{4},\\,3.0\\times 10^{4},\\,1.0\\times 10^{5},\\,3.0\\times 10^{5},\\,1.0\\times 10^{6}]$，\n    - $S_{I_d}(f) = [1.099406728\\times 10^{-21},\\,4.3274006133\\times 10^{-22},\\,1.99406728\\times 10^{-22},\\,1.3274346133\\times 10^{-22},\\,1.09406728\\times 10^{-22},\\,1.02740001333\\times 10^{-22},\\,1.00406728\\times 10^{-22}]$，\n    - $f_{\\min} = 3.0\\times 10^{5}\\,\\mathrm{Hz}$，$f_{\\max} = 1.0\\times 10^{6}\\,\\mathrm{Hz}$。\n- 用例 3（低温，较高电导）：\n    - $T = 77\\,\\mathrm{K}$，$g_{\\mathrm{ch}} = 2.0\\times 10^{-2}\\,\\mathrm{S}$，$K = 2.0\\times 10^{-19}\\,\\mathrm{A}^2$，$S_{\\mathrm{floor}} = 0.0\\,\\mathrm{A}^2/\\mathrm{Hz}$，\n    - $f = [1.0\\times 10^{3},\\,3.0\\times 10^{3},\\,1.0\\times 10^{4},\\,3.0\\times 10^{4},\\,1.0\\times 10^{5},\\,3.0\\times 10^{5},\\,1.0\\times 10^{6}]$，\n    - $S_{I_d}(f) = [3.7009596\\times 10^{-22},\\,2.36762627\\times 10^{-22},\\,1.9009596\\times 10^{-22},\\,1.76762627\\times 10^{-22},\\,1.7029596\\times 10^{-22},\\,1.70162627\\times 10^{-22},\\,1.7011596\\times 10^{-22}]$，\n    - $f_{\\min} = 3.0\\times 10^{4}\\,\\mathrm{Hz}$，$f_{\\max} = 3.0\\times 10^{5}\\,\\mathrm{Hz}$。\n- 用例 4（边缘情况：极小电导，已知仪器本底噪声）：\n    - $T = 300\\,\\mathrm{K}$，$g_{\\mathrm{ch}} = 1.0\\times 10^{-4}\\,\\mathrm{S}$，$K = 2.0\\times 10^{-19}\\,\\mathrm{A}^2$，$S_{\\mathrm{floor}} = 1.0\\times 10^{-25}\\,\\mathrm{A}^2/\\mathrm{Hz}$，\n    - $f = [1.0\\times 10^{3},\\,3.0\\times 10^{3},\\,1.0\\times 10^{4},\\,3.0\\times 10^{4},\\,1.0\\times 10^{5},\\,3.0\\times 10^{5},\\,1.0\\times 10^{6}]$，\n    - $S_{I_d}(f) = [2.009283894\\times 10^{-22},\\,6.67595056\\times 10^{-23},\\,2.009283894\\times 10^{-23},\\,7.5950564\\times 10^{-24},\\,2.9283894\\times 10^{-24},\\,1.5950561\\times 10^{-24},\\,1.1283894\\times 10^{-24}]$，\n    - $f_{\\min} = 3.0\\times 10^{5}\\,\\mathrm{Hz}$，$f_{\\max} = 1.0\\times 10^{6}\\,\\mathrm{Hz}$。\n\n您的程序必须：\n- 对于每个用例，仅使用满足 $f_{\\min} \\le f \\le f_{\\max}$ 的频率点。\n- 使用 $K$ 和 $S_{\\mathrm{floor}}$ 在选定频带内移除已知的非热贡献。\n- 利用跨频率样本的合理聚合方法，从得到的白噪声中构建一个非负的 $\\gamma$ 估计值。\n- 生成一行输出，其中包含一个用方括号括起来的、以逗号分隔的 $\\gamma$ 值列表。输出必须是纯数字浮点数，不带单位。\n\n所需单位和数值答案规范：\n- 所有中间计算必须遵守上述单位。\n- 最终报告的 $\\gamma$ 值为无量纲浮点数。\n- 此问题不涉及角度或百分比。",
            "solution": "用户要求一种从测量的噪声谱中提取 MOSFET 过剩沟道热噪声因子 $\\gamma$ 的方法。此方法必须从第一性原理推导，并实现为一种计算算法。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n\n问题提供了以下信息：\n- **基本原理**：\n    1. 线性导体的涨落-耗散定理：电流噪声功率谱密度 (PSD) 与导纳的实部和绝对温度成正比。\n    2. 处于热平衡状态下导体的 Johnson-Nyquist 结果：白噪声与绝对温度和电导成比例。\n- **模型框架**：\n    1. MOSFET 沟道在小信号体系下被视为一个分布式电阻元件。\n    2. 紧凑模型提供了小信号沟道电导 $g_{\\mathrm{ch}}$。\n- **方法要求**：\n    1. 定义一个非负 $\\gamma$ 的频域估计器。\n    2. 使用指定的频率窗口 $[f_{\\min}, f_{\\max}]$ 来分离白热噪声。\n    3. 移除已知的非热贡献（$1/f$ 噪声和噪声本底）。\n    4. 论证跨频率聚合方法的合理性。\n    5. 确保量纲一致性。\n- **物理常量和变量**：\n    - $T$: 绝对温度，单位为开尔文 ($\\mathrm{K}$)。\n    - $g_{\\mathrm{ch}}$: 小信号沟道电导，单位为西门子 ($\\mathrm{S}$)。\n    - $K$: 闪烁 ($1/f$) 噪声系数，单位为 $\\mathrm{A}^2$。\n    - $S_{\\mathrm{floor}}$: 系统噪声本底 PSD，单位为 $\\mathrm{A}^2/\\mathrm{Hz}$。\n    - $f$: 测量频率数组，单位为赫兹 ($\\mathrm{Hz}$)。\n    - $S_{I_d}(f)$: 测量的单边漏极电流噪声 PSD，单位为 $\\mathrm{A}^2/\\mathrm{Hz}$。\n    - $f_{\\min}, f_{\\max}$: 频率窗口边界，单位为 $\\mathrm{Hz}$。\n    - 玻尔兹曼常数是一个隐含的物理常量：$k_B \\approx 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n- **测试套件**：提供了四个测试用例，每个用例都带有上述变量的具体数值。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题基于涨落-耗散定理和 Johnson-Nyquist 噪声模型，这些是统计力学和电子学的基础。将总噪声建模为热噪声、闪烁 ($1/f$) 噪声和本底噪声分量之和是电子器件表征的标准做法。引入过剩噪声因子 $\\gamma$ 是一种成熟的方法，用于解释半导体器件中的非平衡效应。该问题在科学上是合理的。\n- **定义明确**：问题定义清晰。它要求从一组给定的数据和一个明确的物理模型中提取一个特定参数 $\\gamma$。每个用例都提供了所有必要的参数（$T$, $g_{\\mathrm{ch}}$, $K$, $S_{\\mathrm{floor}}$ 以及噪声谱本身），确保可以计算出唯一的解。\n- **客观性**：问题使用精确的技术语言并提供定量数据。要求的输出是一组特定格式的数值。没有歧义或依赖主观判断。\n\n该问题没有表现出任何无效性缺陷。它是完整的、一致的、科学上现实的并且是可解的。\n\n**步骤 3：结论与行动**\n\n此问题是**有效的**。将提供解决方案。\n\n**解决方案推导**\n\n该方法从所提供的基本原理发展而来。\n\n1.  **导体的基本噪声模型**：\n    Johnson-Nyquist 定理是涨落-耗散定理的一个推论，它指出处于热平衡状态的导体中热电流噪声的单边功率谱密度 (PSD) 由下式给出：\n    $$S_{I, \\text{thermal}}(f) = 4 k_B T G$$\n    其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$G$ 是电导。这种噪声是“白色”的，意味着其 PSD 与频率 $f$ 无关。\n\n2.  **推广至非平衡 MOSFET 沟道**：\n    由于存在高电场，偏置的 MOSFET 沟道是一个非平衡系统。Johnson-Nyquist 公式通过以下方式进行调整：\n    a. 用紧凑模型提供的小信号沟道电导 $g_{\\mathrm{ch}}$ 替代直流电导 $G$。\n    b. 引入一个无量纲的过剩噪声因子 $\\gamma$，以解释非平衡效应，例如热载流子，这些效应会使载流子的有效温度高于晶格温度 $T$。\n    因此，漏极电流的热噪声分量模型 $S_{I_d, \\text{thermal}}$ 变为：\n    $$S_{I_d, \\text{thermal}} = 4 k_B T \\gamma g_{\\mathrm{ch}}$$\n    我们的目标是从测量数据中确定 $\\gamma$。\n\n3.  **测量噪声的分解**：\n    测量的总漏极电流噪声 PSD $S_{I_d}(f)$ 被建模为不相关噪声源的总和。根据问题描述，此模型为：\n    $$S_{I_d}(f) = S_{I_d, \\text{thermal}} + S_{1/f}(f) + S_{\\text{floor}}$$\n    其中：\n    - $S_{I_d, \\text{thermal}}$ 是与频率无关的（白色）沟道热噪声，如上定义。\n    - $S_{1/f}(f) = K/f$ 是闪烁噪声，在低频时占主导地位。系数 $K$ 是已知的。\n    - $S_{\\text{floor}}$ 是来自测量系统的恒定背景噪声本底，也是已知的。\n\n4.  **分离热噪声分量**：\n    为了找到 $\\gamma$，我们必须首先估计 $S_{I_d, \\text{thermal}}$ 的值。我们可以重新排列总噪声模型，以求解每个频率点 $f_i$ 的白噪声分量：\n    $$(S_{\\text{white}})_i = S_{I_d}(f_i) - \\frac{K}{f_i} - S_{\\text{floor}}$$\n    此过程从总测量噪声中减去已知的非热贡献。\n\n5.  **频率窗口和聚合**：\n    问题指定了一个频率窗口 $[f_{\\min}, f_{\\max}]$。选择此窗口的频率要足够高，以最小化 $1/f$ 项的贡献，又要足够低，以避免高频滚降效应（例如，由器件或寄生电容引起的，此处未建模）。在此频带内，热噪声分量预计占主导地位且为常数。\n\n    设 $\\mathcal{F} = \\{f_i | f_{\\min} \\le f_i \\le f_{\\max}\\}$ 为指定窗口内的 $N$ 个频率点集合。对于每个 $f_i \\in \\mathcal{F}$，我们有一个估计值 $(S_{\\text{white}})_i$。由于真实的热噪声是白噪声，这些值理想情况下应该是相同的。由于测量不确定性，它们会有所波动。假设所有数据点的不确定性相同，最合理且统计上最稳健的真实常数值估计器是算术平均值。因此，我们对白热噪声 PSD 的最佳估计 $\\hat{S}_{\\text{white}}$ 是：\n    $$\\hat{S}_{\\text{white}} = \\frac{1}{N} \\sum_{f_i \\in \\mathcal{F}} (S_{\\text{white}})_i = \\frac{1}{N} \\sum_{f_i \\in \\mathcal{F}} \\left( S_{I_d}(f_i) - \\frac{K}{f_i} - S_{\\text{floor}} \\right)$$\n\n6.  **$\\gamma$ 的最终估计器**：\n    现在，我们将我们的实验估计值 $\\hat{S}_{\\text{white}}$ 与热噪声的理论模型相等：\n    $$\\hat{S}_{\\text{white}} = 4 k_B T \\gamma g_{\\mathrm{ch}}$$\n    求解 $\\gamma$ 得到估计器 $\\hat{\\gamma}$：\n    $$\\hat{\\gamma} = \\frac{\\hat{S}_{\\text{white}}}{4 k_B T g_{\\mathrm{ch}}}$$\n    问题要求对 $\\gamma$ 进行非负估计，这在物理上是必要的，因为它代表一个噪声功率比。因此，我们强制执行此约束：\n    $$\\hat{\\gamma} = \\max\\left(0, \\frac{\\hat{S}_{\\text{white}}}{4 k_B T g_{\\mathrm{ch}}}\\right)$$\n    此公式构成了所要求的基于原理的方法。\n\n7.  **量纲分析**：\n    - 分子：$\\hat{S}_{\\text{white}}$ 的单位是 $\\mathrm{A}^2/\\mathrm{Hz} = \\mathrm{A}^2 \\cdot \\mathrm{s}$。\n    - 分母：项 $4 k_B T g_{\\mathrm{ch}}$ 的单位是 $(\\mathrm{J/K}) \\cdot \\mathrm{K} \\cdot \\mathrm{S} = \\mathrm{J} \\cdot \\mathrm{S}$。由于 $1\\,\\mathrm{J} = 1\\,\\mathrm{V} \\cdot \\mathrm{C} = 1\\,\\mathrm{V} \\cdot \\mathrm{A} \\cdot \\mathrm{s}$，且 $1\\,\\mathrm{S} = 1\\,\\mathrm{A/V}$，单位变为 $(\\mathrm{V} \\cdot \\mathrm{A} \\cdot \\mathrm{s}) \\cdot (\\mathrm{A/V}) = \\mathrm{A}^2 \\cdot \\mathrm{s}$。\n    - 分子和分母的单位相同，证实 $\\hat{\\gamma}$ 是一个无量纲量，符合要求。\n\n**算法总结**\n对于每个测试用例：\n1.  识别落在指定频率窗口 $[f_{\\min}, f_{\\max}]$ 内的测量点 $(f_i, S_{I_d}(f_i))$。\n2.  对于这 $N$ 个点中的每一个，通过减去非热分量来计算估计的白噪声水平：$(S_{\\text{white}})_i = S_{I_d}(f_i) - K/f_i - S_{\\mathrm{floor}}$。\n3.  计算这些值的平均值，以获得白热噪声 PSD 的最终估计：$\\hat{S}_{\\text{white}} = \\frac{1}{N} \\sum (S_{\\text{white}})_i$。\n4.  计算基础热噪声分母：$D = 4 k_B T g_{\\mathrm{ch}}$。\n5.  计算过剩噪声因子为 $\\hat{\\gamma} = \\max(0, \\hat{S}_{\\text{white}} / D)$。\n6.  存储结果。处理完所有用例后，按规定格式化结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the excess channel thermal noise factor gamma for a suite of test cases.\n    \"\"\"\n    \n    # Define the Boltzmann constant in J/K\n    k_B = 1.380649e-23\n    \n    test_cases = [\n        {\n            \"T\": 300.0, \"g_ch\": 1.0e-2, \"K\": 2.0e-19, \"S_floor\": 0.0,\n            \"f\": np.array([1.0e3, 3.0e3, 1.0e4, 3.0e4, 1.0e5, 3.0e5, 1.0e6]),\n            \"S_id\": np.array([3.32542304e-22, 1.99208971e-22, 1.52542304e-22, 1.39208971e-22, 1.34542304e-22, 1.33208971e-22, 1.32742304e-22]),\n            \"f_min\": 3.0e4, \"f_max\": 3.0e5\n        },\n        {\n            \"T\": 300.0, \"g_ch\": 5.0e-3, \"K\": 1.0e-18, \"S_floor\": 0.0,\n            \"f\": np.array([1.0e3, 3.0e3, 1.0e4, 3.0e4, 1.0e5, 3.0e5, 1.0e6]),\n            \"S_id\": np.array([1.099406728e-21, 4.3274006133e-22, 1.99406728e-22, 1.3274346133e-22, 1.09406728e-22, 1.02740001333e-22, 1.00406728e-22]),\n            \"f_min\": 3.0e5, \"f_max\": 1.0e6\n        },\n        {\n            \"T\": 77.0, \"g_ch\": 2.0e-2, \"K\": 2.0e-19, \"S_floor\": 0.0,\n            \"f\": np.array([1.0e3, 3.0e3, 1.0e4, 3.0e4, 1.0e5, 3.0e5, 1.0e6]),\n            \"S_id\": np.array([3.7009596e-22, 2.36762627e-22, 1.9009596e-22, 1.76762627e-22, 1.7029596e-22, 1.70162627e-22, 1.7011596e-22]),\n            \"f_min\": 3.0e4, \"f_max\": 3.0e5\n        },\n        {\n            \"T\": 300.0, \"g_ch\": 1.0e-4, \"K\": 2.0e-19, \"S_floor\": 1.0e-25,\n            \"f\": np.array([1.0e3, 3.0e3, 1.0e4, 3.0e4, 1.0e5, 3.0e5, 1.0e6]),\n            \"S_id\": np.array([2.009283894e-22, 6.67595056e-23, 2.009283894e-23, 7.5950564e-24, 2.9283894e-24, 1.5950561e-24, 1.1283894e-24]),\n            \"f_min\": 3.0e5, \"f_max\": 1.0e6\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T = case[\"T\"]\n        g_ch = case[\"g_ch\"]\n        K = case[\"K\"]\n        S_floor = case[\"S_floor\"]\n        f_array = case[\"f\"]\n        S_id_array = case[\"S_id\"]\n        f_min = case[\"f_min\"]\n        f_max = case[\"f_max\"]\n\n        # 1. Identify measurement points within the frequency window [f_min, f_max]\n        indices = np.where((f_array >= f_min) & (f_array <= f_max))[0]\n        \n        if len(indices) == 0:\n            # If no points are in the window, gamma cannot be estimated.\n            # Based on the physical model, a value of 0 is a safe default.\n            gamma_estimate = 0.0\n        else:\n            f_window = f_array[indices]\n            S_id_window = S_id_array[indices]\n\n            # 2. Calculate the estimated white noise level for each point\n            S_1_over_f = K / f_window\n            S_white_samples = S_id_window - S_1_over_f - S_floor\n            \n            # 3. Average the samples to get the best estimate for the white noise PSD\n            S_white_estimate = np.mean(S_white_samples)\n\n            # 4. Calculate the base thermal noise denominator\n            S_id_thermal_base = 4 * k_B * T * g_ch\n\n            if S_id_thermal_base <= 0:\n                 # This case indicates T=0 or g_ch=0, physically unlikely here.\n                 # If extracted noise is positive, gamma is infinite.\n                 gamma_estimate = 0.0 if S_white_estimate <= 0 else float('inf')\n            else:\n                 # 5. Compute the excess noise factor\n                 gamma_estimate = S_white_estimate / S_id_thermal_base\n\n            # Enforce non-negativity as per problem requirement\n            gamma_estimate = max(0.0, gamma_estimate)\n        \n        results.append(gamma_estimate)\n\n    # Format the final output string\n    output_str = f\"[{','.join(f'{r:.12g}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}