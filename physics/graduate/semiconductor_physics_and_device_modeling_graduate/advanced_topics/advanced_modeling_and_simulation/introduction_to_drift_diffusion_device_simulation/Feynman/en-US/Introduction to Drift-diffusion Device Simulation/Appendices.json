{
    "hands_on_practices": [
        {
            "introduction": "At the heart of drift-diffusion simulation lies the charge continuity equation, a powerful expression of charge conservation. This first practice  provides a direct and tangible application of this principle. By working through a defined scenario, you will see how the spatial change in current density, $\\frac{dJ_n}{dx}$, is balanced by the local rates of carrier generation ($G_n$) and recombination ($R_n$), reinforcing the fundamental physics that governs device behavior.",
            "id": "3756297",
            "problem": "A one-dimensional silicon device occupies the domain $0 \\leq x \\leq L$ and is held at constant temperature, with negligible displacement current and no time-varying fields. The electron current density (conventional current contribution due to electrons) is prescribed by a spatial profile $J_n(x)$, and there is a known electron generation rate per unit volume $G_n(x)$. Assume all quantities are sufficiently smooth in $x$ and sources are stationary. Starting only from charge conservation and the definition of steady state, and treating recombination as a sink of electron number with rate $R_n(x)$, derive the expression for the recombination rate required to maintain steady state under the given $J_n(x)$ and $G_n(x)$.\n\nThe given profiles are\n$$J_n(x) = J_0 \\,\\exp\\!\\left(-\\frac{x}{\\lambda}\\right) + J_1 \\,\\sin\\!\\left(\\frac{\\pi x}{L}\\right), \\quad 0 \\le x \\le L,$$\nand\n$$G_n(x) = G_0 + G_1 \\,\\cos\\!\\left(\\frac{\\pi x}{L}\\right),$$\nwhere $J_0$ and $J_1$ are positive constants with units of $\\mathrm{A/m^2}$, $\\lambda$ and $L$ are positive length parameters, and $G_0$ and $G_1$ are nonnegative constants with units of $\\mathrm{m^{-3}\\,s^{-1}}$. Let $q$ denote the elementary charge.\n\nCompute the spatial divergence of the electron current and then determine the closed-form analytic expression for the recombination rate $R_n(x)$ that enforces steady state. Express your final result for $R_n(x)$ in terms of $J_0$, $J_1$, $\\lambda$, $L$, $G_0$, $G_1$, and $q$. If you present a numerical specialization, round your result to four significant figures. Express the recombination rate in $\\mathrm{m^{-3}\\,s^{-1}}$ when all parameters are in International System of Units (SI).",
            "solution": "The user wants me to solve a problem in semiconductor device physics, starting with a validation of the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **System**: A one-dimensional silicon device.\n*   **Domain**: The device occupies the spatial domain $0 \\leq x \\leq L$.\n*   **Thermodynamic Condition**: The temperature is constant.\n*   **Electromagnetic Conditions**: Displacement current is negligible, and there are no time-varying fields.\n*   **Electron Current Density**: $J_n(x) = J_0 \\exp\\left(-\\frac{x}{\\lambda}\\right) + J_1 \\sin\\left(\\frac{\\pi x}{L}\\right)$, where $J_0 > 0$ and $J_1 > 0$.\n*   **Electron Generation Rate**: $G_n(x) = G_0 + G_1 \\cos\\left(\\frac{\\pi x}{L}\\right)$, where $G_0 \\geq 0$ and $G_1 \\geq 0$.\n*   **System State**: The system is in steady state.\n*   **Physical Definitions**: Recombination is a sink for electron number with rate $R_n(x)$. The elementary charge is denoted by $q$.\n*   **Task**:\n    1.  Start from charge conservation and the definition of steady state.\n    2.  Derive the expression for the recombination rate $R_n(x)$.\n    3.  As an intermediate step, compute the spatial divergence of the electron current density, $\\frac{\\partial J_n}{\\partial x}$.\n    4.  Express the final result for $R_n(x)$ in terms of the given parameters.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding**: The problem is formulated around the electron continuity equation, a fundamental law of charge conservation in semiconductor physics. The context of drift-diffusion modeling is standard and scientifically sound. The specified functional forms for current density and generation rate, while specific, are mathematically well-behaved and physically plausible as approximations or model inputs. The problem is scientifically grounded.\n*   **Well-Posedness**: The problem asks for the determination of one quantity, $R_n(x)$, based on a governing physical law (continuity equation) and other specified quantities, $J_n(x)$ and $G_n(x)$. The relationship is direct and allows for a unique solution for $R_n(x)$. The problem is well-posed.\n*   **Objectivity**: The problem is stated using precise, standard terminology from physics and mathematics. It is free from subjective or ambiguous language.\n*   **Completeness and Consistency**: All necessary information (the governing principle, the state of the system, and all relevant functions and constants) is provided. There are no internal contradictions.\n*   **Realism and Feasibility**: The problem is a standard textbook-level problem in semiconductor device physics. It represents a simplified but instructive scenario. The parameters are symbolic, avoiding any potential for physically inconsistent numerical values.\n*   **Structure**: The problem is clearly structured with a defined goal and a suggested intermediate step, guiding a logical solution path.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid as it is scientifically sound, well-posed, objective, complete, consistent, and well-structured. I will proceed with the solution.\n\n### Solution Derivation\n\nThe fundamental principle governing the dynamics of charge carriers (in this case, electrons) is the continuity equation. The continuity equation for electrons expresses the law of conservation of electron number. In one dimension, it is given by:\n$$ \\frac{\\partial n(x,t)}{\\partial t} = \\frac{1}{q} \\frac{\\partial J_n(x,t)}{\\partial x} + G_n(x,t) - R_n(x,t) $$\nHere, $n(x,t)$ is the electron concentration, $J_n(x,t)$ is the electron current density (defined as a conventional current, hence carrying a positive sign for the divergence term), $q$ is the elementary charge, $G_n(x,t)$ is the electron generation rate per unit volume, and $R_n(x,t)$ is the electron recombination rate per unit volume.\n\nThe problem specifies that the system is in steady state. In steady state, all quantities are independent of time, so any partial derivative with respect to time is zero. Specifically, the electron concentration does not change with time:\n$$ \\frac{\\partial n(x,t)}{\\partial t} = 0 $$\nApplying this condition to the continuity equation simplifies it to:\n$$ 0 = \\frac{1}{q} \\frac{d J_n(x)}{dx} + G_n(x) - R_n(x) $$\nWe use ordinary derivatives since $x$ is the only independent variable.\n\nOur goal is to find the recombination rate, $R_n(x)$, that is required to maintain this steady state. We can rearrange the steady-state continuity equation to solve for $R_n(x)$:\n$$ R_n(x) = G_n(x) + \\frac{1}{q} \\frac{d J_n(x)}{dx} $$\nThis equation shows that for a steady state to exist, the local recombination rate must balance the local generation rate plus any net change in charge flow.\n\nThe problem directs us to first compute the spatial divergence of the electron current. In one dimension, this is the derivative $\\frac{d J_n(x)}{dx}$. The given electron current density is:\n$$ J_n(x) = J_0 \\exp\\left(-\\frac{x}{\\lambda}\\right) + J_1 \\sin\\left(\\frac{\\pi x}{L}\\right) $$\nWe differentiate $J_n(x)$ with respect to $x$:\n$$ \\frac{d J_n(x)}{dx} = \\frac{d}{dx} \\left[ J_0 \\exp\\left(-\\frac{x}{\\lambda}\\right) + J_1 \\sin\\left(\\frac{\\pi x}{L}\\right) \\right] $$\nApplying the rules of differentiation to each term:\n$$ \\frac{d}{dx} \\left( J_0 \\exp\\left(-\\frac{x}{\\lambda}\\right) \\right) = J_0 \\cdot \\exp\\left(-\\frac{x}{\\lambda}\\right) \\cdot \\left(-\\frac{1}{\\lambda}\\right) = -\\frac{J_0}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n$$ \\frac{d}{dx} \\left( J_1 \\sin\\left(\\frac{\\pi x}{L}\\right) \\right) = J_1 \\cdot \\cos\\left(\\frac{\\pi x}{L}\\right) \\cdot \\left(\\frac{\\pi}{L}\\right) = \\frac{J_1 \\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) $$\nCombining these results, the divergence of the current density is:\n$$ \\frac{d J_n(x)}{dx} = -\\frac{J_0}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) + \\frac{J_1 \\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) $$\nNow, we substitute this expression and the given generation rate, $G_n(x)$, into the equation for $R_n(x)$. The given generation rate is:\n$$ G_n(x) = G_0 + G_1 \\cos\\left(\\frac{\\pi x}{L}\\right) $$\nSubstituting into $R_n(x) = G_n(x) + \\frac{1}{q} \\frac{d J_n(x)}{dx}$:\n$$ R_n(x) = \\left( G_0 + G_1 \\cos\\left(\\frac{\\pi x}{L}\\right) \\right) + \\frac{1}{q} \\left( -\\frac{J_0}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) + \\frac{J_1 \\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) \\right) $$\nTo obtain the final closed-form expression, we group the terms:\n$$ R_n(x) = G_0 - \\frac{J_0}{q \\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) + G_1 \\cos\\left(\\frac{\\pi x}{L}\\right) + \\frac{J_1 \\pi}{q L} \\cos\\left(\\frac{\\pi x}{L}\\right) $$\nFactoring out the common $\\cos\\left(\\frac{\\pi x}{L}\\right)$ term:\n$$ R_n(x) = G_0 - \\frac{J_0}{q \\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) + \\left(G_1 + \\frac{J_1 \\pi}{q L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right) $$\nThis expression gives the required spatial profile of the net recombination rate $R_n(x)$ in units of $\\mathrm{m^{-3}\\,s^{-1}}$ that ensures the device remains in a steady state under the given current density and generation rate profiles. A physically valid recombination rate must be non-negative, $R_n(x) \\geq 0$, which imposes constraints on the parameters $J_0, J_1, \\lambda, L, G_0, G_1$ for all $x$ in the domain $[0, L]$. However, the problem only asks for the derivation of the expression, not for an analysis of these constraints.",
            "answer": "$$\\boxed{G_0 - \\frac{J_0}{q \\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) + \\left(G_1 + \\frac{J_1 \\pi}{q L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right)}$$"
        },
        {
            "introduction": "While the first exercise treated the net recombination rate ($R$) as a single quantity, in realistic simulations it is composed of several distinct physical mechanisms. This practice  delves into the details of the three most important processes: Shockley–Read–Hall (SRH), radiative, and Auger recombination. By calculating the rate of each, you will develop a quantitative understanding of how these mechanisms compete and contribute to the overall carrier lifetime in a semiconductor.",
            "id": "3756268",
            "problem": "Consider a one-dimensional, uniformly doped, quasi-neutral, steadily illuminated region of crystalline silicon at temperature $T = 300~\\text{K}$ within a drift-diffusion device simulation. The acceptor concentration is $N_{A} = 1.0 \\times 10^{16}~\\text{cm}^{-3}$, and all dopants are fully ionized. The intrinsic carrier concentration is $n_{i} = 1.0 \\times 10^{10}~\\text{cm}^{-3}$. A spatially uniform generation causes a steady-state excess $\\Delta n = \\Delta p = 5.0 \\times 10^{14}~\\text{cm}^{-3}$ in this region. Assume the region is large enough that $\\nabla \\cdot \\mathbf{J}_{n} = \\nabla \\cdot \\mathbf{J}_{p} = 0$ and $\\partial n/\\partial t = \\partial p/\\partial t = 0$.\n\nCarrier recombination is governed by three mechanisms: Shockley–Read–Hall recombination through a single trap, band-to-band radiative recombination, and Auger recombination. The Shockley–Read–Hall trap is located at energy $E_{t}$ such that $E_{t} - E_{i} = +0.20~\\text{eV}$, where $E_{i}$ is the intrinsic level. The electron and hole capture lifetimes are $\\tau_{n0} = 2.0~\\mu\\text{s}$ and $\\tau_{p0} = 0.50~\\mu\\text{s}$, respectively. The radiative recombination coefficient is $B = 1.0 \\times 10^{-14}~\\text{cm}^{3}\\,\\text{s}^{-1}$. The Auger coefficients are $C_{n} = 2.8 \\times 10^{-31}~\\text{cm}^{6}\\,\\text{s}^{-1}$ and $C_{p} = 1.0 \\times 10^{-31}~\\text{cm}^{6}\\,\\text{s}^{-1}$. Use Boltzmann statistics and $k_{B} = 8.617333262 \\times 10^{-5}~\\text{eV/K}$.\n\nStarting from the electron and hole continuity equations and the definitions of recombination-generation processes, derive the expressions needed and then compute:\n\n1. The total steady-state recombination rate $R = R_{\\text{SRH}} + R_{\\text{rad}} + R_{\\text{Aug}}$ in this region.\n2. The effective minority-electron lifetime $\\tau_{\\text{eff}}$ in this region, defined by $\\tau_{\\text{eff}} = \\Delta n / R$ under the given steady-state, uniform conditions.\n\nUse the steady-state carrier densities $n = n_{0} + \\Delta n$ and $p = p_{0} + \\Delta p$, where $p_{0} \\approx N_{A}$ and $n_{0} = n_{i}^{2} / p_{0}$. Express the radiative and Auger contributions in terms of $n$, $p$, and $n_{i}$. For Shockley–Read–Hall recombination, use the standard trap occupancy definitions $n_{1} = n_{i} \\exp\\!\\big((E_{t} - E_{i})/(k_{B} T)\\big)$ and $p_{1} = n_{i} \\exp\\!\\big(-(E_{t} - E_{i})/(k_{B} T)\\big)$.\n\nRound each of your final numerical results to four significant figures. Express the recombination rate $R$ in $\\text{cm}^{-3}\\,\\text{s}^{-1}$ and the lifetime $\\tau_{\\text{eff}}$ in microseconds. Provide your final answer as two numbers in a single row, in the order $\\{R,~\\tau_{\\text{eff}}\\}$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The given parameters for crystalline silicon at $T = 300~\\text{K}$ are physically realistic. The problem provides all necessary constants, definitions, and conditions to uniquely determine the required quantities. The use of steady-state ($\\partial/\\partial t = 0$) and spatial uniformity ($\\nabla \\cdot \\mathbf{J} = 0$) simplifies the continuity equation to a balance between generation and recombination, $G - R = 0$. The problem is a standard, albeit comprehensive, exercise in semiconductor physics and is therefore deemed valid.\n\nThe solution proceeds by first calculating all necessary carrier concentrations and intermediate parameters. Then, the rates for the three specified recombination mechanisms—Shockley–Read–Hall ($R_{\\text{SRH}}$), radiative ($R_{\\text{rad}}$), and Auger ($R_{\\text{Aug}}$)—are computed. The total recombination rate $R$ is the sum of these components. Finally, the effective minority-carrier lifetime $\\tau_{\\text{eff}}$ is calculated from its definition.\n\n**Step 1: Preliminary Calculations**\n\nFirst, we establish the carrier concentrations and other temperature-dependent parameters. The thermal energy at $T = 300~\\text{K}$ is:\n$$k_{B} T = (8.617333262 \\times 10^{-5}~\\text{eV/K}) \\times (300~\\text{K}) \\approx 0.025852~\\text{eV}$$\n\nThe material is p-type with an acceptor concentration of $N_{A} = 1.0 \\times 10^{16}~\\text{cm}^{-3}$. Assuming full ionization, the equilibrium majority carrier (hole) concentration is:\n$$p_{0} \\approx N_{A} = 1.0 \\times 10^{16}~\\text{cm}^{-3}$$\nThe equilibrium minority carrier (electron) concentration is found using the mass-action law, $n_0 p_0 = n_i^2$:\n$$n_{0} = \\frac{n_{i}^{2}}{p_{0}} = \\frac{(1.0 \\times 10^{10}~\\text{cm}^{-3})^{2}}{1.0 \\times 10^{16}~\\text{cm}^{-3}} = 1.0 \\times 10^{4}~\\text{cm}^{-3}$$\n\nUnder steady illumination, there is an excess carrier concentration of $\\Delta n = \\Delta p = 5.0 \\times 10^{14}~\\text{cm}^{-3}$. The total steady-state concentrations are:\n$$n = n_{0} + \\Delta n = 1.0 \\times 10^{4}~\\text{cm}^{-3} + 5.0 \\times 10^{14}~\\text{cm}^{-3} = 5.0001 \\times 10^{14}~\\text{cm}^{-3}$$\n$$p = p_{0} + \\Delta p = 1.0 \\times 10^{16}~\\text{cm}^{-3} + 5.0 \\times 10^{14}~\\text{cm}^{-3} = 1.05 \\times 10^{16}~\\text{cm}^{-3}$$\n\nFor the Shockley–Read–Hall calculation, we need the parameters $n_1$ and $p_1$, which depend on the trap energy level $E_t$. Given $E_{t} - E_{i} = 0.20~\\text{eV}$:\n$$n_{1} = n_{i} \\exp\\!\\left(\\frac{E_{t} - E_{i}}{k_{B} T}\\right) = (1.0 \\times 10^{10}) \\exp\\!\\left(\\frac{0.20}{0.025852}\\right) \\approx 2.290 \\times 10^{13}~\\text{cm}^{-3}$$\n$$p_{1} = n_{i} \\exp\\!\\left(-\\frac{E_{t} - E_{i}}{k_{B} T}\\right) = (1.0 \\times 10^{10}) \\exp\\!\\left(-\\frac{0.20}{0.025852}\\right) \\approx 4.367 \\times 10^{6}~\\text{cm}^{-3}$$\n\n**Step 2: Calculation of Recombination Rates**\n\nThe total net recombination rate $R$ is the sum of the three mechanism rates: $R = R_{\\text{SRH}} + R_{\\text{rad}} + R_{\\text{Aug}}$.\n\n**A. Shockley–Read–Hall (SRH) Recombination ($R_{\\text{SRH}}$)**\nThe SRH recombination rate is given by the expression:\n$$R_{\\text{SRH}} = \\frac{np - n_{i}^{2}}{\\tau_{p0}(n + n_{1}) + \\tau_{n0}(p + p_{1})}$$\nFirst, we compute the numerator and denominator terms.\nThe product $np - n_{i}^{2}$ is:\n$$np - n_{i}^{2} = (5.0001 \\times 10^{14})(1.05 \\times 10^{16}) - (1.0 \\times 10^{10})^{2} \\approx 5.2501 \\times 10^{30} - 1.0 \\times 10^{20} \\approx 5.250 \\times 10^{30}~\\text{cm}^{-6}$$\nThe denominator term is, with $\\tau_{p0} = 0.50 \\times 10^{-6}~\\text{s}$ and $\\tau_{n0} = 2.0 \\times 10^{-6}~\\text{s}$:\n$$\\tau_{p0}(n + n_{1}) = (0.50 \\times 10^{-6}) (5.0001 \\times 10^{14} + 2.290 \\times 10^{13}) \\approx 2.615 \\times 10^{8}~\\text{s}\\cdot\\text{cm}^{-3}$$\n$$\\tau_{n0}(p + p_{1}) = (2.0 \\times 10^{-6}) (1.05 \\times 10^{16} + 4.367 \\times 10^{6}) \\approx 2.100 \\times 10^{10}~\\text{s}\\cdot\\text{cm}^{-3}$$\nThe denominator is the sum of these two terms:\n$$D_{\\text{SRH}} \\approx 2.615 \\times 10^{8} + 2.100 \\times 10^{10} \\approx 2.126 \\times 10^{10}~\\text{s}\\cdot\\text{cm}^{-3}$$\nFinally, the SRH rate is:\n$$R_{\\text{SRH}} = \\frac{5.250 \\times 10^{30}~\\text{cm}^{-6}}{2.126 \\times 10^{10}~\\text{s}\\cdot\\text{cm}^{-3}} \\approx 2.469 \\times 10^{20}~\\text{cm}^{-3}\\,\\text{s}^{-1}$$\n\n**B. Radiative Recombination ($R_{\\text{rad}}$)**\nThe radiative recombination rate is:\n$$R_{\\text{rad}} = B (np - n_{i}^{2})$$\nUsing the given coefficient $B = 1.0 \\times 10^{-14}~\\text{cm}^{3}\\,\\text{s}^{-1}$:\n$$R_{\\text{rad}} = (1.0 \\times 10^{-14}~\\text{cm}^{3}\\,\\text{s}^{-1}) (5.250 \\times 10^{30}~\\text{cm}^{-6}) = 5.250 \\times 10^{16}~\\text{cm}^{-3}\\,\\text{s}^{-1}$$\n\n**C. Auger Recombination ($R_{\\text{Aug}}$)**\nThe Auger recombination rate is:\n$$R_{\\text{Aug}} = (C_{n} n + C_{p} p)(np - n_{i}^{2})$$\nUsing the given coefficients $C_{n} = 2.8 \\times 10^{-31}~\\text{cm}^{6}\\,\\text{s}^{-1}$ and $C_{p} = 1.0 \\times 10^{-31}~\\text{cm}^{6}\\,\\text{s}^{-1}$:\n$$C_{n} n = (2.8 \\times 10^{-31}) (5.0001 \\times 10^{14}) \\approx 1.400 \\times 10^{-16}~\\text{cm}^{3}\\,\\text{s}^{-1}$$\n$$C_{p} p = (1.0 \\times 10^{-31}) (1.05 \\times 10^{16}) = 1.050 \\times 10^{-15}~\\text{cm}^{3}\\,\\text{s}^{-1}$$\nThe prefactor is:\n$$C_{n} n + C_{p} p \\approx 1.400 \\times 10^{-16} + 1.050 \\times 10^{-15} = 1.190 \\times 10^{-15}~\\text{cm}^{3}\\,\\text{s}^{-1}$$\nThe Auger rate is:\n$$R_{\\text{Aug}} = (1.190 \\times 10^{-15}~\\text{cm}^{3}\\,\\text{s}^{-1}) (5.250 \\times 10^{30}~\\text{cm}^{-6}) \\approx 6.248 \\times 10^{15}~\\text{cm}^{-3}\\,\\text{s}^{-1}$$\n\n**Step 3: Total Recombination Rate and Effective Lifetime**\n\nThe total recombination rate $R$ is the sum of the individual rates:\n$$R = R_{\\text{SRH}} + R_{\\text{rad}} + R_{\\text{Aug}}$$\n$$R = (2.469 \\times 10^{20}) + (5.250 \\times 10^{16}) + (6.248 \\times 10^{15})$$\n$$R = (2.469 + 0.0005250 + 0.00006248) \\times 10^{20} \\approx 2.46988 \\times 10^{20}~\\text{cm}^{-3}\\,\\text{s}^{-1}$$\nRounding to four significant figures, the total recombination rate is:\n$$R = 2.470 \\times 10^{20}~\\text{cm}^{-3}\\,\\text{s}^{-1}$$\n\nThe effective minority-electron lifetime $\\tau_{\\text{eff}}$ is defined as $\\tau_{\\text{eff}} = \\Delta n / R$.\n$$\\tau_{\\text{eff}} = \\frac{5.0 \\times 10^{14}~\\text{cm}^{-3}}{2.46988 \\times 10^{20}~\\text{cm}^{-3}\\,\\text{s}^{-1}} \\approx 2.02439 \\times 10^{-6}~\\text{s}$$\nThe problem asks for the lifetime in microseconds ($1~\\mu\\text{s} = 10^{-6}~\\text{s}$).\n$$\\tau_{\\text{eff}} \\approx 2.02439~\\mu\\text{s}$$\nRounding to four significant figures, the effective lifetime is:\n$$\\tau_{\\text{eff}} = 2.024~\\mu\\text{s}$$\n\nThe final answers are the total recombination rate $R$ and the effective lifetime $\\tau_{\\text{eff}}$.",
            "answer": "$$\\boxed{(2.470 \\times 10^{20}, \\quad 2.024)}$$"
        },
        {
            "introduction": "The final step from physical theory to a working simulation involves translating the continuous drift-diffusion equations into a discrete form suitable for a computer. A naive discretization can lead to severe numerical errors, but the Scharfetter–Gummel (SG) scheme provides a robust and elegant solution. This hands-on coding practice  guides you through implementing this cornerstone of device simulation, allowing you to appreciate how it maintains physical accuracy and to verify its property of exact current conservation.",
            "id": "3756280",
            "problem": "Consider a one-dimensional, uniformly discretized semiconductor slab with $N$ nodes indexed by $k \\in \\{0,1,\\dots,N-1\\}$, spatial step size $\\Delta x$, and Dirichlet contacts at the boundaries $k=0$ and $k=N-1$. Work in a dimensionless normalization where the elementary charge $q$, thermal voltage $V_T$, and reference length are all equal to $1$, so that the diffusion coefficients and mobilities are related by the Einstein relation $D_n = \\mu_n$ and $D_p = \\mu_p$. Let the dimensionless electrostatic potential be $\\psi_k$, the electron density be $n_k$, and the hole density be $p_k$ at node $k$. Define the net Shockley–Read–Hall (SRH) recombination-generation rate at node $k$ as\n$$\nU_k = \\frac{n_k p_k - n_i^2}{\\tau_p (n_k + n_i) + \\tau_n (p_k + n_i)},\n$$\nwhere $n_i$ is the intrinsic carrier density (dimensionless), and $\\tau_n$, $\\tau_p$ are the electron and hole lifetimes (dimensionless time).\n\nStarting from the drift-diffusion model, the steady-state continuity equations for electrons and holes in one dimension are\n$$\n\\frac{\\partial J_n}{\\partial x} = G - R, \\quad \\frac{\\partial J_p}{\\partial x} = - (G - R),\n$$\nwith $G - R$ represented by $U(x)$, and the electron and hole current densities given by\n$$\nJ_n = D_n \\left( \\frac{\\partial n}{\\partial x} - n \\frac{\\partial \\psi}{\\partial x} \\right), \\quad\nJ_p = - D_p \\left( \\frac{\\partial p}{\\partial x} + p \\frac{\\partial \\psi}{\\partial x} \\right).\n$$\nDiscretize the electron and hole currents on the edges $(k,k+1)$ using the Scharfetter–Gummel (SG) exponential fitting scheme and construct the discrete steady-state residuals at interior nodes $k=1,2,\\dots,N-2$ as\n$$\nR_{n,k} = \\frac{J_{n,k+\\frac{1}{2}} - J_{n,k-\\frac{1}{2}}}{\\Delta x} - U_k, \\quad\nR_{p,k} = \\frac{J_{p,k+\\frac{1}{2}} - J_{p,k-\\frac{1}{2}}}{\\Delta x} + U_k,\n$$\nwhere $J_{n,k+\\frac{1}{2}}$ and $J_{p,k+\\frac{1}{2}}$ denote the electron and hole currents on edge $(k,k+1)$, respectively, and the boundary nodes $k=0$ and $k=N-1$ are excluded from the residual evaluation due to Dirichlet contacts.\n\nYour task is to write a complete, runnable program that:\n- Implements the Scharfetter–Gummel discretization of the currents on each edge using only the given physical base and definitions; do not assume any shortcut formulas beyond what can be derived from the given relations.\n- Computes the discrete residual vectors $\\{R_{n,k}\\}_{k=1}^{N-2}$ and $\\{R_{p,k}\\}_{k=1}^{N-2}$ for each test case.\n- Verifies exact discrete total current conservation in steady state by checking that the total current on all edges, defined as $J_{t,k+\\frac{1}{2}} = J_{n,k+\\frac{1}{2}} + J_{p,k+\\frac{1}{2}}$, is constant across $k$ within a specified numerical tolerance.\n\nDefine the numerical tolerance as $\\varepsilon = 10^{-10}$. For each test case, produce two boolean outputs:\n1. $b_{\\mathrm{res}}$: true if $\\max\\left(\\max_k |R_{n,k}|, \\max_k |R_{p,k}|\\right) \\le \\varepsilon$, otherwise false.\n2. $b_{\\mathrm{curr}}$: true if $\\max_{k} J_{t,k+\\frac{1}{2}} - \\min_{k} J_{t,k+\\frac{1}{2}} \\le \\varepsilon$, otherwise false.\n\nUse the following test suite with dimensionless parameters:\n- Test Case 1 (near-zero field equilibrium, smooth variation):\n    - $N = 6$, $\\Delta x = 0.1$.\n    - $\\psi = [-0.05, -0.03, -0.01, 0.01, 0.03, 0.05]$.\n    - $n_i = 1.0$, $n_k = n_i \\exp(\\psi_k)$, $p_k = n_i \\exp(-\\psi_k)$.\n    - $\\mu_n = 1.0$, $\\mu_p = 1.0$, $\\tau_n = 1.0$, $\\tau_p = 1.0$.\n- Test Case 2 (strong built-in field equilibrium, large potential differences):\n    - $N = 6$, $\\Delta x = 0.1$.\n    - $\\psi = [-2.0, -1.2, -0.4, 0.4, 1.2, 2.0]$.\n    - $n_i = 1.0$, $n_k = n_i \\exp(\\psi_k)$, $p_k = n_i \\exp(-\\psi_k)$.\n    - $\\mu_n = 1.0$, $\\mu_p = 1.0$, $\\tau_n = 1.0$, $\\tau_p = 1.0$.\n- Test Case 3 (zero field and uniform densities):\n    - $N = 6$, $\\Delta x = 0.1$.\n    - $\\psi = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$.\n    - $n_i = 1.0$, $n_k = 1.0$ for all $k$, $p_k = 1.0$ for all $k$.\n    - $\\mu_n = 1.0$, $\\mu_p = 1.0$, $\\tau_n = 1.0$, $\\tau_p = 1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[b_{\\mathrm{res}}, b_{\\mathrm{curr}}]$. For example, the output format must be exactly like\n$$\n[\\,[\\mathrm{True},\\mathrm{False}],\\,[\\mathrm{True},\\mathrm{True}],\\,[\\mathrm{False},\\mathrm{True}]\\,].\n$$\nNo physical units are involved because all quantities are dimensionless by construction. Angles do not appear. Percentages do not appear.",
            "solution": "The derivation begins from the steady-state drift-diffusion continuity equations in one dimension. With dimensionless normalization ($q=1$, $V_T=1$), the electron and hole currents are defined as\n$$\nJ_n = D_n \\left( \\frac{\\partial n}{\\partial x} - n \\frac{\\partial \\psi}{\\partial x} \\right), \\quad\nJ_p = - D_p \\left( \\frac{\\partial p}{\\partial x} + p \\frac{\\partial \\psi}{\\partial x} \\right),\n$$\nwhere the Einstein relation yields $D_n = \\mu_n$ and $D_p = \\mu_p$. The steady-state continuity equations are\n$$\n\\frac{\\partial J_n}{\\partial x} = U(x), \\qquad \\frac{\\partial J_p}{\\partial x} = -U(x),\n$$\nwhere $U(x)$ is the net recombination-generation rate, modeled here by the Shockley–Read–Hall expression\n$$\nU(x) = \\frac{n(x) p(x) - n_i^2}{\\tau_p (n(x) + n_i) + \\tau_n (p(x) + n_i)}.\n$$\n\nFor a finite volume discretization on a uniform grid, associate a control volume centered at each interior node $k$ with edges at $(k-\\frac{1}{2})$ and $(k+\\frac{1}{2})$. The discrete residuals are obtained by integrating the continuity equation over the control volume and dividing by the volume (length $\\Delta x$), which yields\n$$\nR_{n,k} = \\frac{J_{n,k+\\frac{1}{2}} - J_{n,k-\\frac{1}{2}}}{\\Delta x} - U_k, \\quad\nR_{p,k} = \\frac{J_{p,k+\\frac{1}{2}} - J_{p,k-\\frac{1}{2}}}{\\Delta x} + U_k,\n$$\nfor $k=1,2,\\dots,N-2$. Summing these residuals pointwise gives\n$$\nR_{n,k} + R_{p,k} = \\frac{(J_{n,k+\\frac{1}{2}} + J_{p,k+\\frac{1}{2}}) - (J_{n,k-\\frac{1}{2}} + J_{p,k-\\frac{1}{2}})}{\\Delta x} = \\frac{J_{t,k+\\frac{1}{2}} - J_{t,k-\\frac{1}{2}}}{\\Delta x},\n$$\nwhere $J_{t,k+\\frac{1}{2}} = J_{n,k+\\frac{1}{2}} + J_{p,k+\\frac{1}{2}}$ is the total current across edge $(k,k+1)$. Therefore, in steady state the discrete total current must be constant across all edges, independently of the recombination-generation details, which provides a robust verification of current conservation.\n\nTo discretize the currents $J_{n,k+\\frac{1}{2}}$ and $J_{p,k+\\frac{1}{2}}$ on each edge $(k,k+1)$, we use the Scharfetter–Gummel exponential fitting scheme. This scheme follows from solving the stationary drift-diffusion ordinary differential equations for $n(x)$ and $p(x)$ inside each edge under the assumption that $\\partial \\psi/\\partial x$ is constant on the edge and $J_n$ and $J_p$ are constant on the edge. Consider the electron equation on an edge of length $\\Delta x$ with left and right node values $n_L = n_k$, $n_R = n_{k+1}$ and potential difference $\\Delta \\psi = \\psi_{k+1} - \\psi_k$. The electron current is constant on the edge,\n$$\nJ_n = D_n \\left( \\frac{dn}{dx} - n \\frac{d\\psi}{dx} \\right),\n$$\nwith $\\frac{d\\psi}{dx} = \\Delta \\psi / \\Delta x$. The differential equation can be rearranged as\n$$\n\\frac{dn}{dx} - n \\frac{\\Delta \\psi}{\\Delta x} = \\frac{J_n}{D_n}.\n$$\nMultiplying by $\\exp\\left(-\\frac{\\Delta \\psi}{\\Delta x} x\\right)$ and integrating yields the edge solution that exactly preserves exponential boundary layers. Enforcing the boundary values $n(0) = n_L$, $n(\\Delta x) = n_R$ gives the closed-form flux relation\n$$\nJ_{n,k+\\frac{1}{2}} = \\frac{D_n}{\\Delta x} \\left[ B(\\Delta \\psi) \\, n_{k+1} - B(-\\Delta \\psi) \\, n_k \\right],\n$$\nwhere the Bernoulli function $B(\\xi)$ is defined by\n$$\nB(\\xi) = \\frac{\\xi}{e^{\\xi} - 1}.\n$$\nA similar derivation for holes, starting from\n$$\nJ_p = -D_p \\left( \\frac{dp}{dx} + p \\frac{d\\psi}{dx} \\right),\n$$\nyields\n$$\nJ_{p,k+\\frac{1}{2}} = -\\frac{D_p}{\\Delta x} \\left[ B(-\\Delta \\psi) \\, p_{k+1} - B(\\Delta \\psi) \\, p_k \\right].\n$$\nThese formulas are the Scharfetter–Gummel discretizations that guarantee monotonicity and exact preservation of equilibrium states. Two further identities ensure numerical robustness:\n- The Bernoulli function satisfies $B(-\\xi) = e^{\\xi} B(\\xi)$, which is useful for algebraic checks such as equilibrium currents.\n- For small arguments, the Bernoulli function has the Taylor expansion $B(\\xi) = 1 - \\frac{\\xi}{2} + \\frac{\\xi^2}{12} - \\frac{\\xi^4}{720} + \\dots$, which avoids loss of significance when $|\\xi|$ is very small.\n\nAlgorithmic steps:\n1. For each test case, construct arrays $\\psi_k$, $n_k$, $p_k$ for $k=0,\\dots,N-1$, and scalars $\\mu_n$, $\\mu_p$, $n_i$, $\\tau_n$, $\\tau_p$, and $\\Delta x$. Set $D_n = \\mu_n$, $D_p = \\mu_p$.\n2. For each edge $(k,k+1)$, compute $\\Delta \\psi = \\psi_{k+1} - \\psi_k$, evaluate $B(\\Delta \\psi)$ and $B(-\\Delta \\psi)$, and compute $J_{n,k+\\frac{1}{2}}$ and $J_{p,k+\\frac{1}{2}}$ using the SG formulas above.\n3. For each interior node $k=1,\\dots,N-2$, compute $U_k$ via the SRH expression, and then compute residuals\n$$\nR_{n,k} = \\frac{J_{n,k+\\frac{1}{2}} - J_{n,k-\\frac{1}{2}}}{\\Delta x} - U_k, \\quad\nR_{p,k} = \\frac{J_{p,k+\\frac{1}{2}} - J_{p,k-\\frac{1}{2}}}{\\Delta x} + U_k.\n$$\n4. Form the total current on each edge, $J_{t,k+\\frac{1}{2}} = J_{n,k+\\frac{1}{2}} + J_{p,k+\\frac{1}{2}}$, and check its constancy across all edges by computing the spread $\\max_k J_{t,k+\\frac{1}{2}} - \\min_k J_{t,k+\\frac{1}{2}}$.\n5. Using numerical tolerance $\\varepsilon = 10^{-10}$, set boolean outputs per test case:\n   - $b_{\\mathrm{res}}$ is true if $\\max\\left(\\max_k |R_{n,k}|, \\max_k |R_{p,k}|\\right) \\le \\varepsilon$.\n   - $b_{\\mathrm{curr}}$ is true if $\\max_k J_{t,k+\\frac{1}{2}} - \\min_k J_{t,k+\\frac{1}{2}} \\le \\varepsilon$.\n\nVerification and edge cases in the test suite:\n- In equilibrium with $n_k = n_i e^{\\psi_k}$ and $p_k = n_i e^{-\\psi_k}$, the SG scheme exactly yields $J_{n,k+\\frac{1}{2}} = 0$ and $J_{p,k+\\frac{1}{2}} = 0$ for all edges, since\n$$\nJ_{n,k+\\frac{1}{2}} = \\frac{D_n}{\\Delta x} \\left[ B(\\Delta \\psi) e^{\\psi_{k+1}} - B(-\\Delta \\psi) e^{\\psi_k} \\right]\n= \\frac{D_n e^{\\psi_k}}{\\Delta x} \\left[ B(\\Delta \\psi) e^{\\Delta \\psi} - B(-\\Delta \\psi) \\right] = 0,\n$$\nusing $B(-\\xi) = e^{\\xi} B(\\xi)$. Similarly, $J_{p,k+\\frac{1}{2}} = 0$. Therefore, $U_k = 0$ from the SRH model because $n_k p_k = n_i^2$ at equilibrium, and both residuals vanish identically, while the total current is constant (zero) across all edges. This holds both for small and large $\\Delta \\psi$, testing numerical stability of $B(\\xi)$ near zero and robustness under strong fields.\n- In the trivial zero-field case with uniform densities, $J_{n,k+\\frac{1}{2}} = 0$, $J_{p,k+\\frac{1}{2}} = 0$, $U_k = 0$, so residuals vanish and total current is identically constant.\n\nThe program implements these steps, uses a stable evaluation of the Bernoulli function for small arguments, applies the SG discretization, and returns, for each test case, a pair of booleans indicating whether the discrete residuals are within tolerance and whether the total current is conserved across edges within tolerance. The final output aggregates the pairs into a single list printed as a one-line string in the prescribed format.",
            "answer": "```python\nimport numpy as np\n\ndef bernoulli(x):\n    \"\"\"\n    Stable evaluation of the Bernoulli function B(x) = x / (exp(x) - 1).\n    Uses a Taylor expansion for small |x| to avoid loss of significance.\n    Supports numpy arrays.\n    \"\"\"\n    x = np.asarray(x, dtype=float)\n    out = np.empty_like(x)\n    small = np.abs(x) < 1e-13\n    # Taylor expansion up to x^4 term for better stability\n    xs = x[small]\n    out[small] = 1.0 - xs/2.0 + xs**2/12.0 - xs**4/720.0\n    # General case\n    not_small = ~small\n    xn = x[not_small]\n    out[not_small] = xn / (np.exp(xn) - 1.0)\n    return out\n\ndef sg_currents(psi, n, p, mu_n, mu_p, dx):\n    \"\"\"\n    Compute Scharfetter-Gummel edge currents for electrons and holes\n    on a uniform 1D grid.\n    psi, n, p: arrays of length N (node values)\n    mu_n, mu_p: scalar mobilities (dimensionless), with D = mu (Einstein relation, V_T=1)\n    dx: scalar grid spacing (dimensionless)\n    Returns:\n        Jn_edges, Jp_edges: arrays of length N-1 (edge currents between k and k+1)\n    \"\"\"\n    psi = np.asarray(psi, dtype=float)\n    n = np.asarray(n, dtype=float)\n    p = np.asarray(p, dtype=float)\n    N = psi.size\n    assert n.size == N and p.size == N\n    Dn = float(mu_n)\n    Dp = float(mu_p)\n    dpsi = psi[1:] - psi[:-1]  # length N-1\n    Bp = bernoulli(dpsi)\n    Bm = bernoulli(-dpsi)\n    # Electron SG flux: J_n = (D_n/dx) [ B(dpsi) * n_right - B(-dpsi) * n_left ]\n    Jn = (Dn / dx) * (Bp * n[1:] - Bm * n[:-1])\n    # Hole SG flux: J_p = -(D_p/dx) [ B(-dpsi) * p_right - B(dpsi) * p_left ]\n    Jp = -(Dp / dx) * (Bm * p[1:] - Bp * p[:-1])\n    return Jn, Jp\n\ndef srh_U(n, p, ni, tau_n, tau_p):\n    \"\"\"\n    Shockley-Read-Hall net recombination-generation rate (dimensionless).\n    U = (np - ni^2) / (tau_p (n + ni) + tau_n (p + ni))\n    \"\"\"\n    n = np.asarray(n, dtype=float)\n    p = np.asarray(p, dtype=float)\n    denom = tau_p * (n + ni) + tau_n * (p + ni)\n    # Avoid division by zero in pathological cases\n    # Here, parameters guarantee denom > 0.\n    return (n * p - ni**2) / denom\n\ndef compute_residuals(psi, n, p, mu_n, mu_p, dx, ni, tau_n, tau_p):\n    \"\"\"\n    Compute discrete residuals for electrons and holes at interior nodes.\n    Returns:\n        Rn, Rp: arrays of length N-2 (nodes 1..N-2),\n        J_total_edges: array of length N-1 (edge total currents)\n    \"\"\"\n    Jn_edges, Jp_edges = sg_currents(psi, n, p, mu_n, mu_p, dx)\n    U_nodes = srh_U(n, p, ni, tau_n, tau_p)\n    # Residuals at interior nodes k=1..N-2\n    # Rn_k = (Jn_right - Jn_left)/dx - U_k\n    # Rp_k = (Jp_right - Jp_left)/dx + U_k\n    Rn = (Jn_edges[1:] - Jn_edges[:-1]) / dx - U_nodes[1:-1]\n    Rp = (Jp_edges[1:] - Jp_edges[:-1]) / dx + U_nodes[1:-1]\n    J_total_edges = Jn_edges + Jp_edges\n    return Rn, Rp, J_total_edges\n\ndef verify_case(psi, n, p, mu_n, mu_p, dx, ni, tau_n, tau_p, tol=1e-10):\n    \"\"\"\n    For a given test case, compute residuals and verify:\n    - residuals are within tolerance,\n    - total current is constant across edges within tolerance.\n    Returns a pair of booleans: [res_ok, curr_ok].\n    \"\"\"\n    Rn, Rp, Jt = compute_residuals(psi, n, p, mu_n, mu_p, dx, ni, tau_n, tau_p)\n    max_res = max(np.max(np.abs(Rn)) if Rn.size > 0 else 0.0,\n                  np.max(np.abs(Rp)) if Rp.size > 0 else 0.0)\n    res_ok = (max_res <= tol)\n    spread = (np.max(Jt) - np.min(Jt)) if Jt.size > 0 else 0.0\n    curr_ok = (spread <= tol)\n    return [res_ok, curr_ok]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = []\n    # Test Case 1\n    N1 = 6\n    dx1 = 0.1\n    psi1 = np.array([-0.05, -0.03, -0.01, 0.01, 0.03, 0.05], dtype=float)\n    ni1 = 1.0\n    n1 = ni1 * np.exp(psi1)\n    p1 = ni1 * np.exp(-psi1)\n    mu_n1 = 1.0\n    mu_p1 = 1.0\n    tau_n1 = 1.0\n    tau_p1 = 1.0\n    test_cases.append((psi1, n1, p1, mu_n1, mu_p1, dx1, ni1, tau_n1, tau_p1))\n    # Test Case 2\n    N2 = 6\n    dx2 = 0.1\n    psi2 = np.array([-2.0, -1.2, -0.4, 0.4, 1.2, 2.0], dtype=float)\n    ni2 = 1.0\n    n2 = ni2 * np.exp(psi2)\n    p2 = ni2 * np.exp(-psi2)\n    mu_n2 = 1.0\n    mu_p2 = 1.0\n    tau_n2 = 1.0\n    tau_p2 = 1.0\n    test_cases.append((psi2, n2, p2, mu_n2, mu_p2, dx2, ni2, tau_n2, tau_p2))\n    # Test Case 3\n    N3 = 6\n    dx3 = 0.1\n    psi3 = np.zeros(N3, dtype=float)\n    ni3 = 1.0\n    n3 = np.ones(N3, dtype=float) * 1.0\n    p3 = np.ones(N3, dtype=float) * 1.0\n    mu_n3 = 1.0\n    mu_p3 = 1.0\n    tau_n3 = 1.0\n    tau_p3 = 1.0\n    test_cases.append((psi3, n3, p3, mu_n3, mu_p3, dx3, ni3, tau_n3, tau_p3))\n\n    results = []\n    for case in test_cases:\n        psi, n, p, mu_n, mu_p, dx, ni, tau_n, tau_p = case\n        res = verify_case(psi, n, p, mu_n, mu_p, dx, ni, tau_n, tau_p, tol=1e-10)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    # Each result is a pair [bool, bool]; aggregate into a single list.\n    # Ensure booleans are printed as True/False without quotes.\n    formatted = \"[\" + \",\".join(\"[\" + \",\".join(str(x) for x in pair) + \"]\" for pair in results) + \"]\"\n    print(formatted)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}