{
    "hands_on_practices": [
        {
            "introduction": "The core of the Newton-Raphson method lies in the Jacobian matrix, which quantifies the sensitivity of the governing equations to changes in the solution variables. This first practice challenges you to derive a key component of the Jacobian related to the highly nonlinear recombination-generation processes in a semiconductor. Mastering this type of analytical differentiation is fundamental to understanding and building robust device simulators. ",
            "id": "3761654",
            "problem": "Consider a non-degenerate semiconductor described by the drift-diffusion model and the coupled Poisson and carrier continuity equations. In a Newton–Raphson iteration for the fully coupled system, one requires Jacobian entries that contain partial derivatives of the net recombination–generation rate with respect to the electrostatic potential. Assume a single spatial point in a silicon-like material at temperature $T$ with thermal voltage $V_T = k_B T / q$. The electron density $n$ and hole density $p$ are related to the electrostatic potential $\\psi$ and the electron and hole quasi-Fermi potentials $\\varphi_n$ and $\\varphi_p$ by the Boltzmann relations\n$$\nn(\\psi) = n_i \\exp\\!\\left(\\frac{\\varphi_n - \\psi}{V_T}\\right), \\qquad\np(\\psi) = n_i \\exp\\!\\left(\\frac{\\psi - \\varphi_p}{V_T}\\right),\n$$\nwhere $n_i$ is the intrinsic carrier density and $\\varphi_n$, $\\varphi_p$ are treated as fixed with respect to $\\psi$ in the derivative to be computed. The total net recombination–generation rate is given by the sum of three mechanisms:\n$$\nR_{\\text{tot}}(n,p) = R_{\\text{SRH}}(n,p) + R_{\\text{rad}}(n,p) + R_{\\text{Aug}}(n,p),\n$$\nwith\n$$\nR_{\\text{SRH}}(n,p) = \\frac{n p - n_i^2}{\\tau_p (n + n_1) + \\tau_n (p + p_1)},\n$$\n$$\nR_{\\text{rad}}(n,p) = B \\left(n p - n_i^2\\right),\n$$\n$$\nR_{\\text{Aug}}(n,p) = \\left(C_n n + C_p p\\right)\\left(n p - n_i^2\\right).\n$$\nHere, $\\tau_n$ and $\\tau_p$ are the electron and hole Shockley–Read–Hall lifetimes, $B$ is the radiative recombination coefficient, and $C_n$, $C_p$ are the electron and hole Auger recombination coefficients. The quantities $n_1$ and $p_1$ are the Shockley–Read–Hall reference densities associated with a single dominant trap at energy $E_t$, defined by\n$$\nn_1 = n_i \\exp\\!\\left(\\frac{E_t - E_i}{k_B T}\\right), \\qquad p_1 = n_i \\exp\\!\\left(-\\frac{E_t - E_i}{k_B T}\\right),\n$$\nwhere $E_i$ is the intrinsic Fermi level. Assume $n_i$, $n_1$, $p_1$, $\\tau_n$, $\\tau_p$, $B$, $C_n$, $C_p$, $\\varphi_n$, and $\\varphi_p$ are constants with respect to $\\psi$ at the operating point.\n\nStarting from the fundamental carrier statistics and the functional definitions above, derive the closed-form analytic expression for the partial derivative $\\partial R_{\\text{tot}}/\\partial \\psi$ at fixed $\\varphi_n$ and $\\varphi_p$. Express your final answer as a single symbolic expression in terms of $n$, $p$, $n_i$, $n_1$, $p_1$, $\\tau_n$, $\\tau_p$, $B$, $C_n$, $C_p$, and $V_T$. No numerical evaluation is required.",
            "solution": "The Newton–Raphson linearization of the coupled Poisson and carrier continuity equations requires Jacobian entries involving derivatives of the net recombination–generation rate with respect to the electrostatic potential $\\psi$. The dependence of $R_{\\text{tot}}$ on $\\psi$ is mediated through the carrier densities $n(\\psi)$ and $p(\\psi)$, while the quasi-Fermi potentials $\\varphi_n$ and $\\varphi_p$ are held fixed when taking $\\partial/\\partial \\psi$ in this step.\n\nWe begin from the non-degenerate Boltzmann relations for the carrier densities,\n$$\nn(\\psi) = n_i \\exp\\!\\left(\\frac{\\varphi_n - \\psi}{V_T}\\right), \\qquad\np(\\psi) = n_i \\exp\\!\\left(\\frac{\\psi - \\varphi_p}{V_T}\\right),\n$$\nwhere $V_T = k_B T / q$ is the thermal voltage. Differentiating these expressions with respect to $\\psi$ while treating $\\varphi_n$ and $\\varphi_p$ as constants yields\n$$\n\\frac{\\partial n}{\\partial \\psi} = -\\frac{1}{V_T} n, \\qquad \\frac{\\partial p}{\\partial \\psi} = \\frac{1}{V_T} p.\n$$\nDefine the net excess product\n$$\nS(n,p) = n p - n_i^2,\n$$\nand the Shockley–Read–Hall denominator\n$$\nD(n,p) = \\tau_p (n + n_1) + \\tau_n (p + p_1).\n$$\nWith these, we write the three mechanisms as\n$$\nR_{\\text{SRH}} = \\frac{S}{D}, \\qquad R_{\\text{rad}} = B S, \\qquad R_{\\text{Aug}} = (C_n n + C_p p) S.\n$$\nWe first note a key property under the present differentiation: the product $n p$ is independent of $\\psi$ when $\\varphi_n$ and $\\varphi_p$ are held fixed. This follows from\n$$\nn p = n_i^2 \\exp\\!\\left(\\frac{\\varphi_n - \\psi}{V_T}\\right) \\exp\\!\\left(\\frac{\\psi - \\varphi_p}{V_T}\\right)\n= n_i^2 \\exp\\!\\left(\\frac{\\varphi_n - \\varphi_p}{V_T}\\right),\n$$\nso\n$$\n\\frac{\\partial}{\\partial \\psi} (n p) = 0 \\quad \\Rightarrow \\quad \\frac{\\partial S}{\\partial \\psi} = 0.\n$$\nWe next compute the derivative of $D(n,p)$ with respect to $\\psi$:\n$$\n\\frac{\\partial D}{\\partial \\psi} = \\tau_p \\frac{\\partial n}{\\partial \\psi} + \\tau_n \\frac{\\partial p}{\\partial \\psi}\n= \\tau_p \\left(-\\frac{n}{V_T}\\right) + \\tau_n \\left(\\frac{p}{V_T}\\right)\n= \\frac{-\\tau_p n + \\tau_n p}{V_T}.\n$$\nWith these preliminaries, we differentiate each recombination mechanism with respect to $\\psi$:\n\n$1.$ Shockley–Read–Hall term:\n$$\n\\frac{\\partial R_{\\text{SRH}}}{\\partial \\psi}\n= \\frac{\\partial}{\\partial \\psi}\\left(\\frac{S}{D}\\right)\n= \\frac{(\\partial S/\\partial \\psi) D - S (\\partial D/\\partial \\psi)}{D^2}\n= - \\frac{S}{D^2} \\frac{\\partial D}{\\partial \\psi}\n= -\\frac{S}{D^2} \\cdot \\frac{-\\tau_p n + \\tau_n p}{V_T}\n= \\frac{S}{V_T} \\cdot \\frac{\\tau_p n - \\tau_n p}{D^2}.\n$$\n\n$2.$ Radiative term:\n$$\n\\frac{\\partial R_{\\text{rad}}}{\\partial \\psi}\n= B \\frac{\\partial S}{\\partial \\psi} = 0.\n$$\n\n$3.$ Auger term:\n$$\n\\frac{\\partial R_{\\text{Aug}}}{\\partial \\psi}\n= \\frac{\\partial}{\\partial \\psi}\\left[(C_n n + C_p p) S\\right]\n= \\left(C_n \\frac{\\partial n}{\\partial \\psi} + C_p \\frac{\\partial p}{\\partial \\psi}\\right) S + (C_n n + C_p p) \\frac{\\partial S}{\\partial \\psi}.\n$$\nSince $\\partial S/\\partial \\psi = 0$, the second term vanishes, leaving\n$$\n\\frac{\\partial R_{\\text{Aug}}}{\\partial \\psi}\n= \\left(C_n \\left(-\\frac{n}{V_T}\\right) + C_p \\left(\\frac{p}{V_T}\\right)\\right) S\n= \\frac{S}{V_T} \\left(-C_n n + C_p p\\right).\n$$\n\nSumming the three contributions, we obtain the total derivative\n$$\n\\frac{\\partial R_{\\text{tot}}}{\\partial \\psi}\n= \\frac{\\partial R_{\\text{SRH}}}{\\partial \\psi}\n+ \\frac{\\partial R_{\\text{rad}}}{\\partial \\psi}\n+ \\frac{\\partial R_{\\text{Aug}}}{\\partial \\psi}\n= \\frac{S}{V_T} \\left[ \\frac{\\tau_p n - \\tau_n p}{D^2} + \\left(-C_n n + C_p p\\right) \\right].\n$$\nFinally, restoring $S = n p - n_i^2$ and $D = \\tau_p (n + n_1) + \\tau_n (p + p_1)$, the closed-form expression in terms of the given symbols is\n$$\n\\frac{\\partial R_{\\text{tot}}}{\\partial \\psi}\n= \\frac{n p - n_i^2}{V_T} \\left[ \\frac{\\tau_p n - \\tau_n p}{\\left(\\tau_p (n + n_1) + \\tau_n (p + p_1)\\right)^{2}} - C_n n + C_p p \\right].\n$$\nThis is the desired analytic expression for the Jacobian entry with respect to the electrostatic potential at fixed $\\varphi_n$ and $\\varphi_p$.",
            "answer": "$$\\boxed{\\frac{n p - n_i^2}{V_T} \\left[ \\frac{\\tau_p n - \\tau_n p}{\\left(\\tau_p (n + n_1) + \\tau_n (p + p_1)\\right)^{2}} - C_n n + C_p p \\right]}$$"
        },
        {
            "introduction": "Moving from continuous physics to a computational grid requires a robust discretization scheme, and the Scharfetter-Gummel method is a cornerstone of drift-diffusion simulation. This exercise focuses on the practical task of building the Jacobian matrix for the discretized system. You will derive a diagonal entry of the Jacobian, which demonstrates how the numerical scheme directly influences the structure of the linear system solved at each Newton iteration. ",
            "id": "3761662",
            "problem": "Consider isothermal electron transport in a one-dimensional semiconductor bar of uniform cross section under steady state. The coupled drift-diffusion and Poisson system is discretized on a uniform grid with spacing $\\Delta x$, with nodal indices $i \\in \\{1,2,\\dots,N\\}$. The unknowns at each node are the electrostatic potential $\\phi_{i}$ and the electron quasi-Fermi potential $\\varphi_{n,i}$, both measured in volts. Assume non-degenerate Maxwell–Boltzmann statistics so that the electron density satisfies\n$$\nn_{i} = n_{\\mathrm{ref}} \\exp\\!\\left(\\frac{\\varphi_{n,i} - \\phi_{i}}{V_{T}}\\right),\n$$\nwhere $n_{\\mathrm{ref}}$ is a position-independent reference density and $V_{T} = k_{B} T / q$ is the thermal voltage, with $k_{B}$ the Boltzmann constant, $T$ the temperature, and $q$ the elementary charge.\n\nThe electron current density is modeled by the classical drift-diffusion flux with an electric-field-dependent mobility $\\mu_{n}(E)$ given by\n$$\n\\mu_{n}(E) = \\frac{\\mu_{0}}{1 + \\frac{|E|}{E_{\\mathrm{sat}}}},\n$$\nwhere $\\mu_{0}$ is the low-field mobility and $E_{\\mathrm{sat}}$ is a characteristic saturation field. Assume the Einstein relation holds pointwise, $D_{n} = V_{T} \\mu_{n}$. Let the edge electric field be $E_{i+\\frac{1}{2}} = -(\\phi_{i+1}-\\phi_{i})/\\Delta x$, and define the edge diffusion coefficient $D_{n,i+\\frac{1}{2}} = V_{T}\\,\\mu_{n}(|E_{i+\\frac{1}{2}}|)$, which depends only on $\\phi_{i}$ and $\\phi_{i+1}$.\n\nDiscretize the electron current density across the interface at $i+\\frac{1}{2}$ using the Scharfetter–Gummel (SG) scheme:\n$$\nJ_{n,i+\\frac{1}{2}} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ n_{i+1}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - n_{i}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right],\n$$\nwhere $\\psi_{i+\\frac{1}{2}} = \\frac{\\phi_{i+1}-\\phi_{i}}{V_{T}}$ and $B(\\xi) = \\xi/(\\exp(\\xi)-1)$ for $\\xi \\neq 0$ with $B(0)=1$. The steady-state discrete electron continuity residual at node $i$ (neglecting generation-recombination) is\n$$\nR_{n,i} = J_{n,i+\\frac{1}{2}} - J_{n,i-\\frac{1}{2}}.\n$$\n\nIn a Newton–Raphson iteration for the coupled nonlinear system, form the Jacobian entry corresponding to the partial derivative of the electron continuity residual at node $i$ with respect to the electron quasi-Fermi potential at node $i$, namely\n$$\nJ_{ii}^{(n,\\varphi_{n})} \\equiv \\frac{\\partial R_{n,i}}{\\partial \\varphi_{n,i}},\n$$\nunder the standard Newton approximation that, for this partial derivative, all other nodal unknowns $\\{\\phi_{j}\\}_{j}$ and $\\{\\varphi_{n,j}\\}_{j \\neq i}$ are held fixed at their current iterate. In particular, treat $D_{n,i\\pm \\frac{1}{2}}$ and $B(\\pm \\psi_{i\\pm \\frac{1}{2}})$ as constants with respect to $\\varphi_{n,i}$.\n\nDerive and provide a single closed-form analytical expression for $J_{ii}^{(n,\\varphi_{n})}$ in terms of $q$, $\\Delta x$, $V_{T}$, $n_{i}$, $D_{n,i\\pm \\frac{1}{2}}$, and the Bernoulli functions evaluated at $\\pm \\psi_{i\\pm \\frac{1}{2}}$. Your final answer must be a single analytic expression. Do not include units in the final boxed answer.",
            "solution": "Our objective is to compute the Jacobian entry $J_{ii}^{(n,\\varphi_{n})}$, which is defined as the partial derivative of the discrete electron continuity residual at node $i$, $R_{n,i}$, with respect to the electron quasi-Fermi potential at the same node, $\\varphi_{n,i}$.\n$$\nJ_{ii}^{(n,\\varphi_{n})} \\equiv \\frac{\\partial R_{n,i}}{\\partial \\varphi_{n,i}}\n$$\nThe problem specifies that for this calculation, all other nodal unknowns—that is, $\\{\\phi_{j}\\}_{j}$ for all $j$ and $\\{\\varphi_{n,j}\\}_{j \\neq i}$—are to be held constant.\n\nFirst, we write the expression for the residual $R_{n,i}$. It is defined as the difference between the electron current densities at the interfaces surrounding node $i$:\n$$\nR_{n,i} = J_{n,i+\\frac{1}{2}} - J_{n,i-\\frac{1}{2}}\n$$\nThe current densities are given by the Scharfetter–Gummel (SG) scheme. Substituting the expressions for $J_{n,i+\\frac{1}{2}}$ and $J_{n,i-\\frac{1}{2}}$:\n$$\nR_{n,i} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ n_{i+1}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - n_{i}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right] - \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ n_{i}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - n_{i-1}\\,B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right]\n$$\nNow, we take the partial derivative of $R_{n,i}$ with respect to $\\varphi_{n,i}$:\n$$\n\\frac{\\partial R_{n,i}}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}} \\left( J_{n,i+\\frac{1}{2}} - J_{n,i-\\frac{1}{2}} \\right) = \\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} - \\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}}\n$$\nWe need to determine which terms in the expression for $R_{n,i}$ depend on $\\varphi_{n,i}$. According to the problem statement:\n-   The electrostatic potentials $\\phi_j$ are held constant. This implies that the normalized potential differences $\\psi_{i\\pm\\frac{1}{2}} = (\\phi_{i\\pm 1}-\\phi_i)/V_T$ are constant.\n-   As a consequence, the Bernoulli functions $B(\\pm\\psi_{i\\pm\\frac{1}{2}})$ are constant.\n-   The electric fields $E_{i\\pm\\frac{1}{2}} = -(\\phi_{i\\pm 1}-\\phi_i)/\\Delta x$ are also constant.\n-   Therefore, the diffusion coefficients $D_{n,i\\pm\\frac{1}{2}}$, which depend only on $|E_{i\\pm\\frac{1}{2}}|$, are treated as constants for this partial derivative.\n-   The electron quasi-Fermi potentials $\\varphi_{n,j}$ for $j \\neq i$ are held constant.\n\nThe only terms that depend on $\\varphi_{n,i}$ are the electron densities $n_j = n_{\\mathrm{ref}} \\exp((\\varphi_{n,j} - \\phi_j)/V_T)$. Specifically, only $n_i$ is a function of $\\varphi_{n,i}$. The densities $n_{i+1}$ and $n_{i-1}$ depend on $\\varphi_{n,i+1}$ and $\\varphi_{n,i-1}$ respectively, which are held constant.\n\nLet's find the derivative of $n_i$ with respect to $\\varphi_{n,i}$:\n$$\nn_i = n_{\\mathrm{ref}} \\exp\\left(\\frac{\\varphi_{n,i} - \\phi_i}{V_T}\\right)\n$$\n$$\n\\frac{\\partial n_i}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}} \\left[ n_{\\mathrm{ref}} \\exp\\left(\\frac{\\varphi_{n,i} - \\phi_i}{V_T}\\right) \\right] = n_{\\mathrm{ref}} \\exp\\left(\\frac{\\varphi_{n,i} - \\phi_i}{V_T}\\right) \\cdot \\frac{1}{V_T} = \\frac{n_i}{V_T}\n$$\nThe derivatives of the neighboring densities are zero:\n$$\n\\frac{\\partial n_{i+1}}{\\partial \\varphi_{n,i}} = 0 \\quad \\text{and} \\quad \\frac{\\partial n_{i-1}}{\\partial \\varphi_{n,i}} = 0\n$$\nNow we can compute the derivatives of the current components.\n\nFor $J_{n,i+\\frac{1}{2}}$:\n$$\n\\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}}\\left\\{ \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ n_{i+1}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - n_{i}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right] \\right\\}\n$$\nTreating $D_{n,i+\\frac{1}{2}}$, $B(\\psi_{i+\\frac{1}{2}})$, and $B(-\\psi_{i+\\frac{1}{2}})$ as constants, and using the chain rule:\n$$\n\\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ \\frac{\\partial n_{i+1}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - \\frac{\\partial n_{i}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right]\n$$\nSubstituting the derivatives of the densities:\n$$\n\\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x}\\left[ 0 \\cdot B\\!\\left(\\psi_{i+\\frac{1}{2}}\\right) - \\frac{n_i}{V_T}\\,B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right] = - \\frac{q\\,D_{n,i+\\frac{1}{2}}}{\\Delta x} \\frac{n_i}{V_T} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\n$$\n\nFor $J_{n,i-\\frac{1}{2}}$:\n$$\n\\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{\\partial}{\\partial \\varphi_{n,i}}\\left\\{ \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ n_{i}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - n_{i-1}\\,B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right] \\right\\}\n$$\nAgain, treating $D_{n,i-\\frac{1}{2}}$ and the Bernoulli functions as constants:\n$$\n\\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ \\frac{\\partial n_{i}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - \\frac{\\partial n_{i-1}}{\\partial \\varphi_{n,i}}\\,B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right]\n$$\nSubstituting the derivatives of the densities:\n$$\n\\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}} = \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x}\\left[ \\frac{n_i}{V_T}\\,B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) - 0 \\cdot B\\!\\left(-\\psi_{i-\\frac{1}{2}}\\right)\\right] = \\frac{q\\,D_{n,i-\\frac{1}{2}}}{\\Delta x} \\frac{n_i}{V_T} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right)\n$$\nFinally, we assemble the Jacobian entry $J_{ii}^{(n,\\varphi_{n})}$:\n$$\nJ_{ii}^{(n,\\varphi_{n})} = \\frac{\\partial J_{n,i+\\frac{1}{2}}}{\\partial \\varphi_{n,i}} - \\frac{\\partial J_{n,i-\\frac{1}{2}}}{\\partial \\varphi_{n,i}}\n$$\n$$\nJ_{ii}^{(n,\\varphi_{n})} = \\left(-\\frac{q\\,n_i}{V_T \\Delta x} D_{n,i+\\frac{1}{2}} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right)\\right) - \\left(\\frac{q\\,n_i}{V_T \\Delta x} D_{n,i-\\frac{1}{2}} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right)\\right)\n$$\nFactoring out the common term $-\\frac{q\\,n_i}{V_T \\Delta x}$ yields the final expression:\n$$\nJ_{ii}^{(n,\\varphi_{n})} = - \\frac{q\\,n_i}{V_T \\Delta x} \\left[ D_{n,i+\\frac{1}{2}} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right) + D_{n,i-\\frac{1}{2}} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) \\right]\n$$\nThis is the required closed-form analytical expression for the Jacobian element.",
            "answer": "$$\n\\boxed{- \\frac{q\\,n_i}{V_T \\Delta x} \\left[ D_{n,i+\\frac{1}{2}} B\\!\\left(-\\psi_{i+\\frac{1}{2}}\\right) + D_{n,i-\\frac{1}{2}} B\\!\\left(\\psi_{i-\\frac{1}{2}}\\right) \\right]}\n$$"
        },
        {
            "introduction": "A raw Newton-Raphson algorithm can easily fail by producing unphysical results or by diverging, so globalization strategies are essential for a robust and reliable solver. This final practice delves into this critical aspect of numerical simulation. You will derive and apply limits on the update step size to simultaneously enforce the physical constraint of positive carrier densities and the numerical requirement for convergent behavior, reflecting the real-world challenges of device simulation. ",
            "id": "3761661",
            "problem": "Consider a one-dimensional silicon diode modeled by the coupled drift-diffusion equations consisting of the Poisson equation and the electron and hole continuity equations. Let the unknown vector be $\\mathbf{y} = (\\psi, n, p)$, where $\\psi$ is the electrostatic potential, $n$ is the electron density, and $p$ is the hole density. The nonlinear system is written compactly as $\\mathbf{F}(\\mathbf{y}) = \\mathbf{0}$, where $\\mathbf{F}$ is the residual constructed from the partial differential equations (PDE) and boundary conditions. You are solving $\\mathbf{F}(\\mathbf{y}) = \\mathbf{0}$ by the Newton-Raphson (NR) method with damping, i.e., $\\mathbf{y}_{k+1} = \\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k}$, where $\\Delta \\mathbf{y}_{k}$ solves the linearized system $\\mathbf{J}_{k} \\Delta \\mathbf{y}_{k} = -\\mathbf{F}(\\mathbf{y}_{k})$ with $\\mathbf{J}_{k} = \\partial \\mathbf{F} / \\partial \\mathbf{y} \\big|_{\\mathbf{y}_k}$.\n\nTwo numerical pathologies commonly encountered are (i) violation of positivity of carrier densities and (ii) lack of global convergence due to insufficient decrease of the residual norm. To enforce robustness, impose the following safeguards simultaneously:\n- Positivity safeguard: for all spatial nodes $i$, require $n_{k+1,i} = n_{k,i} + \\alpha \\,\\Delta n_{k,i} \\geq 0$ and $p_{k+1,i} = p_{k,i} + \\alpha \\,\\Delta p_{k,i} \\geq 0$.\n- Sufficient decrease safeguard: assume the Jacobian $\\mathbf{J}(\\mathbf{y})$ is Lipschitz continuous with constant $L$ near $\\mathbf{y}_{k}$, and require the Armijo-type decrease $\\|\\mathbf{F}(\\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k})\\| \\leq (1 - c \\,\\alpha)\\,\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$ for a chosen constant $c \\in (0,1)$.\n\nAt the current iteration $k$, the computed Newton step components for the carrier densities at three representative nodes are:\n- $n_{k} = \\big(1.2 \\times 10^{16},\\, 8.0 \\times 10^{15},\\, 2.0 \\times 10^{14}\\big)$, $\\Delta n_{k} = \\big(-2.0 \\times 10^{16},\\, -1.0 \\times 10^{16},\\, 3.0 \\times 10^{15}\\big)$,\n- $p_{k} = \\big(3.0 \\times 10^{10},\\, 2.0 \\times 10^{10},\\, 1.0 \\times 10^{10}\\big)$, $\\Delta p_{k} = \\big(-1.0 \\times 10^{11},\\, 5.0 \\times 10^{9},\\, -2.0 \\times 10^{10}\\big)$.\n\nThe composite residual norm and step norm at $\\mathbf{y}_{k}$ are\n$\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = 1.5 \\times 10^{4}$ and $\\|\\Delta \\mathbf{y}_{k}\\|^{2} = 9.0 \\times 10^{4}$, respectively, and the Lipschitz constant of the Jacobian is $L = 2.0 \\times 10^{3}$. Use $c = 0.2$ in the sufficient decrease condition. Take the Euclidean norm $\\|\\cdot\\|$ throughout.\n\nStarting strictly from the definitions of the Newton-Raphson update and the Lipschitz continuity of the Jacobian, derive an explicit upper bound for the damping factor $\\alpha$ that ensures both positivity and sufficient decrease. Then, using the provided data, compute the largest admissible $\\alpha$.\n\nExpress your final $\\alpha$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The goal is to find the largest damping factor $\\alpha  0$ that simultaneously satisfies two safeguards for the Newton-Raphson update $\\mathbf{y}_{k+1} = \\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k}$.\n\n**1. Positivity Safeguard**\n\nThis safeguard requires the updated carrier densities, electron density $n$ and hole density $p$, to remain non-negative at all spatial nodes $i$.\nThe update equations for the densities are:\n$$n_{k+1,i} = n_{k,i} + \\alpha \\,\\Delta n_{k,i}$$\n$$p_{k+1,i} = p_{k,i} + \\alpha \\,\\Delta p_{k,i}$$\nThe positivity constraints are $n_{k+1,i} \\geq 0$ and $p_{k+1,i} \\geq 0$.\n\nFor the electron density, the constraint is $n_{k,i} + \\alpha \\,\\Delta n_{k,i} \\geq 0$.\n- If $\\Delta n_{k,i} \\geq 0$, since $n_{k,i} \\geq 0$ and we seek $\\alpha  0$, this inequality is always satisfied.\n- If $\\Delta n_{k,i}  0$, we must have $\\alpha \\,\\Delta n_{k,i} \\geq -n_{k,i}$. Since $\\Delta n_{k,i}$ is negative, dividing by it reverses the inequality sign:\n$$\\alpha \\leq \\frac{-n_{k,i}}{\\Delta n_{k,i}}$$\nThis provides an upper bound on $\\alpha$ for each node where the electron density update is negative. The same logic applies to the hole density $p$.\n\nTo ensure positivity for all nodes and for both carrier types, $\\alpha$ must be less than or equal to the minimum of all such upper bounds.\n$$\\alpha_{\\text{pos}} \\leq \\min \\left( \\min_{i | \\Delta n_{k,i}  0} \\left\\{ \\frac{-n_{k,i}}{\\Delta n_{k,i}} \\right\\}, \\min_{j | \\Delta p_{k,j}  0} \\left\\{ \\frac{-p_{k,j}}{\\Delta p_{k,j}} \\right\\} \\right)$$\n\nUsing the provided data:\nFor electron density $n$:\n- Node 1: $n_{k,1} = 1.2 \\times 10^{16}$, $\\Delta n_{k,1} = -2.0 \\times 10^{16}$. The update is negative. Upper bound: $\\alpha \\leq \\frac{-1.2 \\times 10^{16}}{-2.0 \\times 10^{16}} = 0.6$.\n- Node 2: $n_{k,2} = 8.0 \\times 10^{15}$, $\\Delta n_{k,2} = -1.0 \\times 10^{16}$. The update is negative. Upper bound: $\\alpha \\leq \\frac{-8.0 \\times 10^{15}}{-1.0 \\times 10^{16}} = 0.8$.\n- Node 3: $n_{k,3} = 2.0 \\times 10^{14}$, $\\Delta n_{k,3} = 3.0 \\times 10^{15}$. The update is positive, so no upper bound is imposed.\n\nFor hole density $p$:\n- Node 1: $p_{k,1} = 3.0 \\times 10^{10}$, $\\Delta p_{k,1} = -1.0 \\times 10^{11}$. The update is negative. Upper bound: $\\alpha \\leq \\frac{-3.0 \\times 10^{10}}{-1.0 \\times 10^{11}} = 0.3$.\n- Node 2: $p_{k,2} = 2.0 \\times 10^{10}$, $\\Delta p_{k,2} = 5.0 \\times 10^{9}$. The update is positive, so no upper bound is imposed.\n- Node 3: $p_{k,3} = 1.0 \\times 10^{10}$, $\\Delta p_{k,3} = -2.0 \\times 10^{10}$. The update is negative. Upper bound: $\\alpha \\leq \\frac{-1.0 \\times 10^{10}}{-2.0 \\times 10^{10}} = 0.5$.\n\nThe set of all upper bounds derived from the positivity constraint is $\\{0.6, 0.8, 0.3, 0.5\\}$. The most restrictive (smallest) bound is:\n$$\\alpha_{\\text{pos,max}} = \\min(0.6, 0.8, 0.3, 0.5) = 0.3$$\n\n**2. Sufficient Decrease Safeguard (Armijo-type condition)**\n\nThis safeguard requires that the norm of the residual decreases sufficiently at each step, as given by the Armijo-type condition:\n$$\\|\\mathbf{F}(\\mathbf{y}_{k} + \\alpha \\,\\Delta \\mathbf{y}_{k})\\| \\leq (1 - c \\,\\alpha)\\,\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\nfor some constant $c \\in (0,1)$.\n\nTo derive an upper bound on $\\alpha$ that guarantees this, we start from the Fundamental Theorem of Calculus for vector functions. Let $\\mathbf{s} = \\alpha \\Delta\\mathbf{y}_k$. Then\n$$\\mathbf{F}(\\mathbf{y}_{k} + \\mathbf{s}) - \\mathbf{F}(\\mathbf{y}_{k}) = \\int_0^1 \\mathbf{J}(\\mathbf{y}_k + t\\mathbf{s}) \\mathbf{s} \\, dt$$\nwhere $\\mathbf{J}$ is the Jacobian matrix $\\partial\\mathbf{F}/\\partial\\mathbf{y}$. Substituting $\\mathbf{s}$ and rearranging gives:\n$$\\mathbf{F}(\\mathbf{y}_{k} + \\alpha \\Delta\\mathbf{y}_k) = \\mathbf{F}(\\mathbf{y}_{k}) + \\alpha \\int_0^1 \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) \\Delta\\mathbf{y}_k \\, dt$$\nWe can add and subtract the term $\\alpha \\mathbf{J}(\\mathbf{y}_k) \\Delta\\mathbf{y}_k = \\alpha \\mathbf{J}_k \\Delta\\mathbf{y}_k$ inside the expression:\n$$\\mathbf{F}(\\mathbf{y}_{k+1}) = \\mathbf{F}(\\mathbf{y}_{k}) + \\alpha \\mathbf{J}_k \\Delta\\mathbf{y}_k + \\alpha \\int_0^1 \\left[ \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\right] \\Delta\\mathbf{y}_k \\, dt$$\nFrom the definition of the Newton step, $\\mathbf{J}_k \\Delta\\mathbf{y}_k = -\\mathbf{F}(\\mathbf{y}_k)$. Substituting this in, we get:\n$$\\mathbf{F}(\\mathbf{y}_{k+1}) = \\mathbf{F}(\\mathbf{y}_{k}) - \\alpha\\mathbf{F}(\\mathbf{y}_{k}) + \\mathbf{R}_k = (1-\\alpha)\\mathbf{F}(\\mathbf{y}_{k}) + \\mathbf{R}_k$$\nwhere the remainder term is $\\mathbf{R}_k = \\alpha \\int_0^1 \\left[ \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\right] \\Delta\\mathbf{y}_k \\, dt$.\n\nTaking the norm and using the triangle inequality:\n$$\\|\\mathbf{F}(\\mathbf{y}_{k+1})\\| \\leq \\|(1-\\alpha)\\mathbf{F}(\\mathbf{y}_{k})\\| + \\|\\mathbf{R}_k\\| = (1-\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| + \\|\\mathbf{R}_k\\|$$\nNow we bound the norm of the remainder term $\\|\\mathbf{R}_k\\|$:\n$$\\|\\mathbf{R}_k\\| \\leq \\alpha \\int_0^1 \\| \\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\| \\|\\Delta\\mathbf{y}_k\\| \\, dt$$\nUsing the Lipschitz continuity of the Jacobian, $\\|\\mathbf{J}(\\mathbf{y}) - \\mathbf{J}(\\mathbf{z})\\| \\leq L\\|\\mathbf{y}-\\mathbf{z}\\|$, with $\\mathbf{y} = \\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k$ and $\\mathbf{z}=\\mathbf{y}_k$:\n$$\\|\\mathbf{J}(\\mathbf{y}_k + t\\alpha\\Delta\\mathbf{y}_k) - \\mathbf{J}_k \\| \\leq L \\|t\\alpha\\Delta\\mathbf{y}_k\\| = L t \\alpha \\|\\Delta\\mathbf{y}_k\\|$$\nSubstituting this into the integral for $\\|\\mathbf{R}_k\\|$:\n$$\\|\\mathbf{R}_k\\| \\leq \\alpha \\int_0^1 (L t \\alpha \\|\\Delta\\mathbf{y}_k\\|) \\|\\Delta\\mathbf{y}_k\\| \\, dt = L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2 \\int_0^1 t \\, dt$$\nSince $\\int_0^1 t \\, dt = \\frac{1}{2}$, we have the bound:\n$$\\|\\mathbf{R}_k\\| \\leq \\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2$$\nOur inequality for $\\|\\mathbf{F}(\\mathbf{y}_{k+1})\\|$ becomes:\n$$\\|\\mathbf{F}(\\mathbf{y}_{k+1})\\| \\leq (1-\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| + \\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2$$\nTo satisfy the Armijo condition, we require this upper bound to be less than or equal to $(1-c\\alpha)\\|\\mathbf{F}(\\mathbf{y}_k)\\|$:\n$$(1-\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| + \\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2 \\leq (1-c\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\nRearranging the terms:\n$$\\frac{1}{2} L \\alpha^2 \\|\\Delta\\mathbf{y}_k\\|^2 \\leq (1-c\\alpha - (1-\\alpha))\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = (\\alpha-c\\alpha)\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = \\alpha(1-c)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\nAssuming $\\alpha  0$, we can divide by $\\alpha$:\n$$\\frac{1}{2} L \\alpha \\|\\Delta\\mathbf{y}_k\\|^2 \\leq (1-c)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|$$\nSolving for $\\alpha$ gives the upper bound from the sufficient decrease condition:\n$$\\alpha_{\\text{Armijo}} \\leq \\frac{2(1-c)\\|\\mathbf{F}(\\mathbf{y}_{k})\\|}{L\\|\\Delta\\mathbf{y}_k\\|^2}$$\n\nUsing the provided numerical values: $\\|\\mathbf{F}(\\mathbf{y}_{k})\\| = 1.5 \\times 10^{4}$, $\\|\\Delta \\mathbf{y}_{k}\\|^{2} = 9.0 \\times 10^{4}$, $L = 2.0 \\times 10^{3}$, and $c = 0.2$.\n$$\\alpha_{\\text{Armijo,max}} = \\frac{2(1-0.2)(1.5 \\times 10^{4})}{(2.0 \\times 10^{3})(9.0 \\times 10^{4})} = \\frac{2(0.8)(1.5 \\times 10^{4})}{1.8 \\times 10^{8}} = \\frac{2.4 \\times 10^{4}}{1.8 \\times 10^{8}}$$\n$$\\alpha_{\\text{Armijo,max}} = \\frac{2.4}{1.8} \\times 10^{-4} = \\frac{4}{3} \\times 10^{-4} \\approx 1.3333 \\times 10^{-4}$$\n\n**3. Final Admissible Damping Factor**\n\nThe largest admissible damping factor $\\alpha$ must satisfy both safeguards simultaneously. Therefore, it must be the minimum of the two derived upper bounds:\n$$\\alpha_{\\text{max}} = \\min(\\alpha_{\\text{pos,max}}, \\alpha_{\\text{Armijo,max}})$$\n$$\\alpha_{\\text{max}} = \\min(0.3, 1.3333 \\times 10^{-4}) = 1.3333 \\times 10^{-4}$$\nRounding the result to four significant figures gives $0.0001333$.",
            "answer": "$$\\boxed{0.0001333}$$"
        }
    ]
}