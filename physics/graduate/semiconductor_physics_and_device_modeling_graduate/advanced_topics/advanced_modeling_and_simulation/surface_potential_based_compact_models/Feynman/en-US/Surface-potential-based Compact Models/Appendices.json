{
    "hands_on_practices": [
        {
            "introduction": "A compact model's predictive power is only as strong as the parameters that define it. This practice bridges the gap between theoretical equations and experimental reality by guiding you through a fundamental parameter extraction procedure. By analyzing hypothetical Capacitance-Voltage (C-V) data measured at different frequencies, you will implement a numerical method to isolate and quantify the interface-trap capacitance ($C_{it}$), a critical non-ideality affecting device performance. This exercise  demonstrates how the surface potential, $\\psi_{s}$, serves as the crucial link between external measurements and the internal physical state of the MOS capacitor.",
            "id": "3776285",
            "problem": "You are tasked with designing and implementing a parameter extraction procedure to separate the interface-trap capacitance per unit area, denoted by $C_{it}$, from the depletion capacitance per unit area, denoted by $C_{d}$, using Capacitance–Voltage (C–V) data and a surface-potential-based inversion across bias and measurement frequency. Your program must use only the provided data and specified physical relations. The final outputs must be expressed in $\\mathrm{F/m^2}$.\n\nFundamental base:\n- For a Metal–Oxide–Semiconductor (MOS) capacitor on a uniformly doped $p$-type semiconductor, the one-dimensional Poisson equation and depletion approximation yield the depletion charge per unit area,\n$$Q_{d}(\\psi_{s}) = \\sqrt{2 q \\varepsilon_{s} N_{A} \\psi_{s}},$$\nwhere $q$ is the elementary charge, $\\varepsilon_{s}$ is the semiconductor permittivity, $N_{A}$ is the acceptor concentration, and $\\psi_{s}$ is the surface potential measured with respect to the bulk.\n- The small-signal depletion capacitance per unit area follows by differentiation,\n$$C_{d}(\\psi_{s}) = \\frac{d Q_{d}}{d \\psi_{s}} = \\frac{\\sqrt{2 q \\varepsilon_{s} N_{A}}}{2 \\sqrt{\\psi_{s}}}.$$\n- The measured gate capacitance per unit area under a given frequency is the series combination of the oxide capacitance per unit area, $C_{ox}$, and the effective semiconductor-side capacitance per unit area. Under high-frequency conditions (traps do not respond), the effective semiconductor-side capacitance equals $C_{d}(\\psi_{s})$, while under low-frequency conditions (traps respond), it equals $C_{d}(\\psi_{s}) + C_{it}(\\psi_{s})$. Denoting the measured capacitance per unit area as $C_{m}$,\n$$\\frac{1}{C_{m,\\text{HF}}} = \\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s})}, \\qquad \\frac{1}{C_{m,\\text{LF}}} = \\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s}) + C_{it}(\\psi_{s})}.$$\n- The gate bias–surface potential relation under high-frequency (negligible trap charge) is\n$$V_{g} = V_{fb} + \\psi_{s} + \\frac{Q_{d}(\\psi_{s})}{C_{ox}},$$\nwhere $V_{fb}$ is the flatband voltage. This relation is used to ensure scientific consistency across bias, but your extraction must pivot on inverting the surface potential from the measured high-frequency series capacitance.\n\nYour tasks:\n1. For each bias point, invert the surface potential $\\,\\psi_{s}\\,$ by solving the nonlinear equation\n$$\\left(\\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s})}\\right)^{-1} - C_{m,\\text{HF}} = 0,$$\nfor $\\,\\psi_{s} \\ge 0\\,$ (depletion/inversion regime).\n2. Using the inverted $\\,\\psi_{s}\\,$, compute $\\,C_{d}(\\psi_{s})\\,$ via the depletion formula above.\n3. From the low-frequency measurement, compute the effective parallel capacitance\n$$C_{\\parallel,\\text{LF}} = \\left(\\frac{1}{C_{m,\\text{LF}}} - \\frac{1}{C_{ox}}\\right)^{-1},$$\nand extract the interface-trap capacitance per unit area at that bias by\n$$C_{it}(\\psi_{s}) = C_{\\parallel,\\text{LF}} - C_{d}(\\psi_{s}).$$\n4. Repeat for all provided bias points and all cases in the test suite.\n\nUse constants:\n- Elementary charge $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$,\n- Vacuum permittivity $\\varepsilon_{0} = 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}$,\n- Silicon permittivity $\\varepsilon_{s} = 11.7 \\varepsilon_{0}$,\n- Oxide permittivity $\\varepsilon_{ox} = 3.9 \\varepsilon_{0}$,\n- Temperature $T = 300\\ \\mathrm{K}$ (thermodynamic contributions are not directly needed in this problem),\n- Oxide thickness $t_{ox} = 3.0 \\times 10^{-9}\\ \\mathrm{m}$, so $C_{ox} = \\varepsilon_{ox}/t_{ox}$,\n- Acceptor concentration $N_{A} = 1.0 \\times 10^{23}\\ \\mathrm{m^{-3}}$,\n- Flatband voltage $V_{fb} = -0.2\\ \\mathrm{V}$.\n\nTest suite:\nFor each case, you are given three gate biases $V_{g}$ with corresponding measured high-frequency and low-frequency capacitances per unit area. All capacitances are in $\\mathrm{F/m^2}$ and voltages in $\\mathrm{V}$.\n\n- Case 1 (moderate traps):\n    - Biases $[V_{g1}, V_{g2}, V_{g3}] = [-0.11454,\\ 0.18678,\\ 0.74190]$,\n    - Measured high-frequency $C_{m,\\text{HF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$,\n    - Measured low-frequency $C_{m,\\text{LF}}$ values: $[0.003526,\\ 0.002164,\\ 0.001718]$.\n- Case 2 (no traps, edge case):\n    - Biases $[V_{g1}, V_{g2}, V_{g3}] = [-0.11454,\\ 0.18678,\\ 0.74190]$,\n    - Measured high-frequency $C_{m,\\text{HF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$,\n    - Measured low-frequency $C_{m,\\text{LF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$.\n- Case 3 (stronger traps):\n    - Biases $[V_{g1}, V_{g2}, V_{g3}] = [-0.11454,\\ 0.18678,\\ 0.74190]$,\n    - Measured high-frequency $C_{m,\\text{HF}}$ values: $[0.003014,\\ 0.0014572,\\ 0.0009372]$,\n    - Measured low-frequency $C_{m,\\text{LF}}$ values: $[0.004385,\\ 0.003322,\\ 0.002979]$.\n\nRequired output:\n- Compute $C_{it}$ at each bias for each case, express each value in $\\mathrm{F/m^2}$, and round each to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated Python-style nested list, with three inner lists corresponding to the three cases and three elements in each inner list (e.g., $[[c_{11},c_{12},c_{13}],[c_{21},c_{22},c_{23}],[c_{31},c_{32},c_{33}]])$. No extra text should be printed.\n\nImplementation constraints:\n- You must implement the surface-potential inversion numerically for each bias point using the high-frequency series capacitance equation and the depletion capacitance formula.\n- All outputs must be in $\\mathrm{F/m^2}$.",
            "solution": "The problem has been validated and is deemed valid. It is scientifically grounded in the principles of MOS capacitor physics, specifically the high-frequency/low-frequency C-V method for characterizing interface traps. The problem is well-posed, providing all necessary physical constants, governing equations, and data sets for a unique solution to be determined. The instructions are clear, objective, and lead to a deterministic algorithmic procedure.\n\nThe goal is to extract the interface-trap capacitance per unit area, $C_{it}(\\psi_s)$, for a MOS capacitor at several gate bias points. This is achieved by leveraging the frequency-dependent response of interface traps to a small AC signal. At high frequencies, traps cannot respond, and the measured capacitance is a series combination of the oxide capacitance, $C_{ox}$, and the semiconductor depletion capacitance, $C_d$. At low frequencies, traps can follow the AC signal, adding their capacitance, $C_{it}$, in parallel with $C_d$.\n\nThe procedure commences by defining the physical constants and derived parameters.\nThe elementary charge is $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$.\nThe vacuum permittivity is $\\varepsilon_{0} = 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}$.\nThe relative permittivity of silicon is $\\kappa_s = 11.7$, so $\\varepsilon_{s} = \\kappa_s \\varepsilon_0$.\nThe relative permittivity of silicon dioxide is $\\kappa_{ox} = 3.9$, so $\\varepsilon_{ox} = \\kappa_{ox} \\varepsilon_0$.\nThe oxide thickness is $t_{ox} = 3.0 \\times 10^{-9}\\ \\mathrm{m}$.\nThe acceptor doping concentration is $N_{A} = 1.0 \\times 10^{23}\\ \\mathrm{m^{-3}}$.\n\nFrom these, we calculate the oxide capacitance per unit area:\n$$\nC_{ox} = \\frac{\\varepsilon_{ox}}{t_{ox}} = \\frac{3.9 \\times 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}}{3.0 \\times 10^{-9}\\ \\mathrm{m}} \\approx 0.01151\\ \\mathrm{F/m^2}\n$$\n\nThe core of the extraction method involves the following sequence of calculations for each bias point:\n\nStep 1: Inversion of Surface Potential, $\\psi_s$.\nThe surface potential, $\\psi_s$, is the key independent variable that determines the state of the semiconductor surface. It is not directly measured but must be inferred from the high-frequency capacitance, $C_{m,\\text{HF}}$. The relationship is given by the series capacitance formula:\n$$\nC_{m,\\text{HF}} = \\left(\\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s})}\\right)^{-1}\n$$\nThe depletion capacitance, $C_d(\\psi_s)$, within the depletion approximation, is given by:\n$$\nC_{d}(\\psi_{s}) = \\frac{\\sqrt{2 q \\varepsilon_{s} N_{A}}}{2 \\sqrt{\\psi_{s}}} = \\frac{\\gamma_d}{2 \\sqrt{\\psi_{s}}}\n$$\nwhere we define the constant body-effect parameter $\\gamma_d = \\sqrt{2 q \\varepsilon_{s} N_{A}}$. Combining these equations, we obtain a nonlinear equation for $\\psi_s$:\n$$\nf(\\psi_s) = \\left(\\frac{1}{C_{ox}} + \\frac{2\\sqrt{\\psi_s}}{\\gamma_d}\\right)^{-1} - C_{m,\\text{HF}} = 0\n$$\nSince the problem requires a numerical solution, we will implement a root-finding algorithm (e.g., Brent's method) to solve for $\\psi_s$ for each given $C_{m,\\text{HF}}$ value. The search for $\\psi_s$ is restricted to $\\psi_s > 0$, corresponding to depletion and inversion.\n\nStep 2: Calculation of Depletion Capacitance, $C_d(\\psi_s)$.\nOnce $\\psi_s$ is determined numerically from Step 1, the corresponding depletion capacitance can be calculated directly using its definition:\n$$\nC_{d}(\\psi_{s}) = \\frac{\\gamma_d}{2 \\sqrt{\\psi_s}}\n$$\nAlternatively, one can rearrange the high-frequency capacitance formula to find $C_d$ algebraically, which serves as a consistency check for the found $\\psi_s$:\n$$\nC_d = \\left(\\frac{1}{C_{m,\\text{HF}}} - \\frac{1}{C_{ox}}\\right)^{-1}\n$$\nThe numerical implementation will use the value of $C_d$ derived from the inverted $\\psi_s$ to maintain procedural correctness as per the problem structure.\n\nStep 3: Extraction of Interface-Trap Capacitance, $C_{it}(\\psi_s)$.\nThe low-frequency measured capacitance, $C_{m,\\text{LF}}$, includes the contribution from interface traps. The total semiconductor-side capacitance is $C_{d}(\\psi_s) + C_{it}(\\psi_s)$.\n$$\n\\frac{1}{C_{m,\\text{LF}}} = \\frac{1}{C_{ox}} + \\frac{1}{C_{d}(\\psi_{s}) + C_{it}(\\psi_{s})}\n$$\nFirst, we find the total parallel capacitance on the semiconductor side, which we denote as $C_{\\parallel,\\text{LF}}$:\n$$\nC_{\\parallel,\\text{LF}} = C_{d}(\\psi_{s}) + C_{it}(\\psi_{s}) = \\left(\\frac{1}{C_{m,\\text{LF}}} - \\frac{1}{C_{ox}}\\right)^{-1}\n$$\nFinally, by subtracting the known depletion capacitance $C_d(\\psi_s)$ (calculated in Step 2) from $C_{\\parallel,\\text{LF}}$, we extract the interface-trap capacitance:\n$$\nC_{it}(\\psi_{s}) = C_{\\parallel,\\text{LF}} - C_{d}(\\psi_{s})\n$$\nThis procedure is iterated over all bias points for each test case provided. The final value for $C_{it}$ is rounded to six decimal places as required.\nFor the edge case where no traps are present, $C_{m,\\text{HF}} = C_{m,\\text{LF}}$. This will result in $C_{\\parallel,\\text{LF}} = C_d(\\psi_s)$, yielding $C_{it}(\\psi_s) = 0$, as expected.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the interface-trap capacitance based on C-V data.\n    \"\"\"\n    # Physical Constants\n    Q = 1.602176634e-19  # Elementary charge in C\n    EPS_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    \n    # Material Properties\n    KAPPA_S = 11.7  # Relative permittivity of Silicon\n    KAPPA_OX = 3.9  # Relative permittivity of SiO2\n    T_OX = 3.0e-9  # Oxide thickness in m\n    N_A = 1.0e23   # Acceptor concentration in m^-3\n    \n    # Derived Constants\n    EPS_S = KAPPA_S * EPS_0\n    EPS_OX = KAPPA_OX * EPS_0\n    C_OX = EPS_OX / T_OX\n    \n    # Parameter group for C_d and Q_d calculations\n    GAMMA_D_SQ = 2 * Q * EPS_S * N_A\n    GAMMA_D = np.sqrt(GAMMA_D_SQ)\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1 (moderate traps)\n        {\n            \"biases\": [-0.11454, 0.18678, 0.74190],\n            \"cm_hf\": [0.003014, 0.0014572, 0.0009372],\n            \"cm_lf\": [0.003526, 0.002164, 0.001718]\n        },\n        # Case 2 (no traps, edge case)\n        {\n            \"biases\": [-0.11454, 0.18678, 0.74190],\n            \"cm_hf\": [0.003014, 0.0014572, 0.0009372],\n            \"cm_lf\": [0.003014, 0.0014572, 0.0009372]\n        },\n        # Case 3 (stronger traps)\n        {\n            \"biases\": [-0.11454, 0.18678, 0.74190],\n            \"cm_hf\": [0.003014, 0.0014572, 0.0009372],\n            \"cm_lf\": [0.004385, 0.003322, 0.002979]\n        }\n    ]\n    \n    overall_results = []\n\n    for case in test_cases:\n        case_results = []\n        for i in range(len(case[\"biases\"])):\n            cm_hf = case[\"cm_hf\"][i]\n            cm_lf = case[\"cm_lf\"][i]\n\n            # Step 1: Invert surface potential psi_s\n            # We need to solve f(psi_s) = 0 where\n            # f(psi_s) = (1/C_ox + 1/C_d(psi_s))^-1 - cm_hf = 0\n            # and C_d(psi_s) = gamma_d / (2 * sqrt(psi_s))\n            def get_cm_hf(psi_s):\n                if psi_s = 0:\n                    return C_OX # Avoid division by zero, return max capacitance\n                cd = GAMMA_D / (2 * np.sqrt(psi_s))\n                return (1/C_OX + 1/cd)**-1\n\n            def f_psi_s(psi_s):\n                return get_cm_hf(psi_s) - cm_hf\n            \n            # Use a numerical solver to find psi_s\n            # Lower bound is a small positive number to avoid singularity at psi_s=0\n            # Upper bound is a sufficiently large potential\n            try:\n                psi_s = brentq(f_psi_s, 1e-9, 5.0)\n            except ValueError:\n                # Handle cases where cm_hf is close to or greater than C_ox,\n                # which implies psi_s is very small or zero.\n                psi_s = 0.0\n\n            # Step 2: Compute C_d(psi_s)\n            if psi_s = 0:\n                # This case is not expected with the given data but handle for robustness\n                # In theory C_d -> infinity as psi_s -> 0, but the total capacitance is limited by C_ox\n                # We can calculate C_d via the algebraic relation\n                cd_val = (1/cm_hf - 1/C_OX)**-1\n            else:\n                cd_val = GAMMA_D / (2 * np.sqrt(psi_s))\n            \n            # Step 3: Compute C_it(psi_s)\n            # C_parallel_lf = (1/cm_lf - 1/C_ox)^-1\n            c_parallel_lf = (1/cm_lf - 1/C_OX)**-1\n            \n            # C_it = C_parallel_lf - C_d\n            cit_val = c_parallel_lf - cd_val\n            \n            # Ensure C_it is not negative due to numerical noise\n            if cit_val  0:\n                cit_val = 0.0\n\n            case_results.append(round(cit_val, 6))\n        \n        overall_results.append(case_results)\n\n    # Format the final output string as a Python-style nested list\n    print(f\"[{','.join(map(str, overall_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After learning to extract parameters from data, the next step is to build a complete current-voltage (I-V) model from first principles. This exercise challenges you to apply the surface-potential framework to a modern, three-dimensional FinFET architecture. You will construct a DC model by accounting for the combined gate control from the top and sidewalls, solving the core implicit equation for surface potential ($\\psi_s$) along the channel, and integrating the resulting inversion charge to compute the drain current. This practice  reinforces the central computational task of any surface-potential-based model and its application to non-planar device geometries.",
            "id": "3776249",
            "problem": "A tri-gate Fin Field-Effect Transistor (FinFET) can be modeled within the surface-potential-based compact modeling framework by combining the gate control from the top and sidewall gates and solving for the surface potential distribution along the channel. Consider a long-channel, isothermal, n-channel FinFET fabricated on a uniformly doped p-type silicon body. The fin has top width $W_{\\text{fin}}$ and height $H_{\\text{fin}}$, and the top gate and sidewall gates are separated from the silicon by silicon dioxide of thicknesses $t_{\\text{ox,top}}$ and $t_{\\text{ox,side}}$, respectively. All three gates are biased at the same gate-to-source voltage $V_{\\text{GS}}$, and the drain-to-source voltage is $V_{\\text{DS}}$. The source is at $0\\,\\text{V}$ and the drain at $V_{\\text{DS}}$. The flatband voltage is $V_{\\text{FB}}$. Assume uniform electron mobility $\\mu$, negligible series resistance, and negligible velocity saturation.\n\nStarting from the following fundamental base:\n\n- Gauss's law and boundary conditions at the oxide–semiconductor interface imply that the net semiconductor charge per unit length along the channel, denoted $Q_{s}^{\\ell}(x)$, satisfies\n$$\nQ_{s}^{\\ell}(x) = -C_{\\text{ox,eff}}^{\\ell}\\,\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}(x)\\big),\n$$\nwhere $C_{\\text{ox,eff}}^{\\ell}$ is the effective oxide capacitance per unit channel length that aggregates the top and sidewall contributions, and $\\psi_{s}(x)$ is the local surface potential at position $x$ along the channel.\n- The net semiconductor charge per unit length can be decomposed as\n$$\nQ_{s}^{\\ell}(x) = W_{\\text{eff}}\\,\\big(Q_{\\text{dep}}(\\psi_{s}(x)) + Q_{\\text{inv}}(\\psi_{s}(x),V(x))\\big),\n$$\nwhere $W_{\\text{eff}} = W_{\\text{fin}} + 2H_{\\text{fin}}$ is the effective perimeter controlling inversion, $Q_{\\text{dep}}$ is the depletion charge per unit area due to holes, and $Q_{\\text{inv}}$ is the inversion electron charge per unit area at the surface. The local channel potential is $V(x)$, with $V(0)=0$ and $V(L)=V_{\\text{DS}}$, and $L$ is the channel length.\n- The depletion charge per unit area $Q_{\\text{dep}}(\\psi_{s})$ follows from the one-dimensional Poisson–Boltzmann equation in the p-type body with acceptor density $N_{A}$, Boltzmann statistics, and the potential reference set in the quasi-neutral bulk. The inversion charge per unit area $Q_{\\text{inv}}(\\psi_{s},V)$ follows from the electron density at the surface and a physically motivated centroid approximation based on the Debye length.\n- The drain current can be obtained from the drift current relation under the charge-sheet approximation:\n$$\nI_{D} = \\frac{\\mu}{L}\\int_{0}^{V_{\\text{DS}}}\\big(-Q_{\\text{inv}}^{\\ell}(V)\\big)\\,\\mathrm{d}V,\n$$\nwhere $Q_{\\text{inv}}^{\\ell}(V) = W_{\\text{eff}}\\,Q_{\\text{inv}}(\\psi_{s}(V),V)$ and $\\psi_{s}(V)$ is the surface potential at the location where the local channel potential is $V$.\n\nUse the following modeling steps, expressed in purely mathematical and logical terms:\n\n1. Compute the effective oxide capacitance per unit channel length by an effective width approach that adds the top and sidewall contributions:\n$$\nC_{\\text{ox,eff}}^{\\ell} = \\varepsilon_{\\text{ox}}\\left(\\frac{W_{\\text{fin}}}{t_{\\text{ox,top}}} + \\frac{2H_{\\text{fin}}}{t_{\\text{ox,side}}}\\right),\n$$\nwhere $\\varepsilon_{\\text{ox}}$ is the permittivity of silicon dioxide.\n2. For each local channel potential $V\\in[0,V_{\\text{DS}}]$, solve the implicit surface-potential equation\n$$\nC_{\\text{ox,eff}}^{\\ell}\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}\\big) + W_{\\text{eff}}\\big(Q_{\\text{dep}}(\\psi_{s}) + Q_{\\text{inv}}(\\psi_{s},V)\\big) = 0\n$$\nfor $\\psi_{s}$.\n3. Use a depletion charge per unit area based on the one-dimensional Poisson–Boltzmann solution in p-type silicon at temperature $T$:\n$$\nQ_{\\text{dep}}(\\psi_{s}) = -\\sqrt{2\\,\\varepsilon_{\\text{si}}\\,q\\,N_{A}\\,\\phi_{t}}\\;\\sqrt{\\psi_{s}/\\phi_{t} + e^{-\\psi_{s}/\\phi_{t}} - 1},\n$$\nfor $\\psi_{s}\\ge 0$, and set $Q_{\\text{dep}}(\\psi_{s})=0$ for $\\psi_{s}0$, where $\\varepsilon_{\\text{si}}$ is the silicon permittivity, $q$ is the elementary charge, and $\\phi_{t} = k_{B}T/q$ is the thermal voltage with $k_{B}$ the Boltzmann constant.\n4. Use an inversion charge per unit area defined from the surface electron density and the Debye length centroid approximation:\n$$\nn_{s}(\\psi_{s},V) = \\frac{n_{i}^{2}}{N_{A}}\\,e^{(\\psi_{s}-V)/\\phi_{t}},\\quad L_{D}(\\psi_{s},V) = \\sqrt{\\frac{\\varepsilon_{\\text{si}}\\,\\phi_{t}}{q\\,n_{s}(\\psi_{s},V)}},\n$$\n$$\nQ_{\\text{inv}}(\\psi_{s},V) = -q\\,n_{s}(\\psi_{s},V)\\,L_{D}(\\psi_{s},V) = -\\sqrt{\\varepsilon_{\\text{si}}\\,q\\,n_{s}(\\psi_{s},V)\\,\\phi_{t}},\n$$\nwhere $n_{i}$ is the intrinsic carrier concentration of silicon.\n5. After determining $\\psi_{s}(V)$ over $V\\in[0,V_{\\text{DS}}]$, compute the drain current by numerical quadrature of the drift current relation.\n\nConstants to use:\n- Elementary charge $q = 1.602176634\\times 10^{-19}\\,\\text{C}$.\n- Vacuum permittivity $\\varepsilon_{0} = 8.854187817\\times 10^{-12}\\,\\text{F/m}$.\n- Silicon permittivity $\\varepsilon_{\\text{si}} = 11.7\\,\\varepsilon_{0}$.\n- Silicon dioxide permittivity $\\varepsilon_{\\text{ox}} = 3.9\\,\\varepsilon_{0}$.\n- Boltzmann constant $k_{B} = 1.380649\\times 10^{-23}\\,\\text{J/K}$.\n- Temperature $T = 300\\,\\text{K}$.\n- Intrinsic concentration $n_{i} = 1.45\\times 10^{16}\\,\\text{m}^{-3}$.\n\nYour task:\n- Implement a program that carries out the above modeling steps, solves for the surface potential distribution $\\psi_{s}(V)$ along the channel by root-finding for each local potential $V$, and computes $I_{D}$ by integrating the inversion charge along the channel using the drift relation.\n- Express the final drain current $I_{D}$ in amperes (A) as floating-point numbers.\n\nTest suite (each test case is a tuple of parameters in SI units):\n- Case 1 (general operation, near linear region): $(W_{\\text{fin}}=20\\times 10^{-9},\\,H_{\\text{fin}}=40\\times 10^{-9},\\,t_{\\text{ox,top}}=1.2\\times 10^{-9},\\,t_{\\text{ox,side}}=1.2\\times 10^{-9},\\,L=50\\times 10^{-9},\\,N_{A}=5.0\\times 10^{22},\\,\\mu=0.05,\\,V_{\\text{GS}}=0.8,\\,V_{\\text{DS}}=0.05,\\,V_{\\text{FB}}=0.0)$.\n- Case 2 (saturation-like high drain bias): $(W_{\\text{fin}}=20\\times 10^{-9},\\,H_{\\text{fin}}=40\\times 10^{-9},\\,t_{\\text{ox,top}}=1.2\\times 10^{-9},\\,t_{\\text{ox,side}}=1.2\\times 10^{-9},\\,L=50\\times 10^{-9},\\,N_{A}=5.0\\times 10^{22},\\,\\mu=0.05,\\,V_{\\text{GS}}=0.8,\\,V_{\\text{DS}}=0.8,\\,V_{\\text{FB}}=0.0)$.\n- Case 3 (subthreshold gate bias): $(W_{\\text{fin}}=20\\times 10^{-9},\\,H_{\\text{fin}}=40\\times 10^{-9},\\,t_{\\text{ox,top}}=1.2\\times 10^{-9},\\,t_{\\text{ox,side}}=1.2\\times 10^{-9},\\,L=50\\times 10^{-9},\\,N_{A}=5.0\\times 10^{22},\\,\\mu=0.05,\\,V_{\\text{GS}}=0.2,\\,V_{\\text{DS}}=0.8,\\,V_{\\text{FB}}=0.0)$.\n- Case 4 (sidewall-dominant geometry, different oxides): $(W_{\\text{fin}}=8\\times 10^{-9},\\,H_{\\text{fin}}=60\\times 10^{-9},\\,t_{\\text{ox,top}}=1.5\\times 10^{-9},\\,t_{\\text{ox,side}}=0.8\\times 10^{-9},\\,L=30\\times 10^{-9},\\,N_{A}=1.0\\times 10^{23},\\,\\mu=0.03,\\,V_{\\text{GS}}=0.8,\\,V_{\\text{DS}}=0.5,\\,V_{\\text{FB}}=0.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the computed drain currents for the four test cases as a comma-separated list enclosed in square brackets, for example, `[I1,I2,I3,I4]`. Each $I_{k}$ must be in amperes (A) as a floating-point number.",
            "solution": "The user has provided a problem statement that details a surface-potential-based compact model for a tri-gate FinFET and asks for an implementation to calculate the drain current for several test cases.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\nThe problem provides a comprehensive set of givens, including:\n- **Device structure and parameters:** FinFET geometry ($W_{\\text{fin}}$, $H_{\\text{fin}}$), oxide thicknesses ($t_{\\text{ox,top}}$, $t_{\\text{ox,side}}$), channel length ($L$).\n- **Material parameters:** Doping concentration ($N_{A}$), electron mobility ($\\mu$), intrinsic carrier concentration ($n_{i}$).\n- **Operating conditions:** Gate-to-source voltage ($V_{\\text{GS}}$), drain-to-source voltage ($V_{\\text{DS}}$), flatband voltage ($V_{\\text{FB}}$).\n- **Physical constants:** $q$, $\\varepsilon_0$, $\\varepsilon_{\\text{si}}$, $\\varepsilon_{\\text{ox}}$, $k_B$, $T$.\n- **Model equations:** A complete set of equations is provided for the effective oxide capacitance ($C_{\\text{ox,eff}}^{\\ell}$), the implicit surface potential equation, the depletion charge ($Q_{\\text{dep}}$), the inversion charge ($Q_{\\text{inv}}$), and the drain current ($I_D$) integral.\n- **Test cases:** Four distinct sets of parameters are provided to test the implementation.\n\n**Step 2: Validation of Givens**\nA critical examination of the givens leads to the following assessment:\n1.  **Scientifically Grounded:** The problem is firmly rooted in established semiconductor device physics. The use of a surface-potential-based model, the charge balance equation derived from Gauss's law, and the drift-current integral (Pao-Sah integral) are all standard concepts in MOSFET modeling. The specific expressions for depletion and inversion charge are physically motivated simplifications common in compact models (e.g., PSP, BSIM). The physical constants and parameter ranges are realistic for modern semiconductor devices.\n2.  **Well-Posed:** The core of the problem is to solve the a non-linear, implicit equation for the surface potential $\\psi_s$. An analysis of the implicit function, $F(\\psi_s) = C_{\\text{ox,eff}}^{\\ell}\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}\\big) + W_{\\text{eff}}\\big(Q_{\\text{dep}}(\\psi_{s}) + Q_{\\text{inv}}(\\psi_{s},V)\\big) = 0$, reveals that it is continuous and strictly monotonic with respect to $\\psi_s$. The function tends to $+\\infty$ as $\\psi_s \\to -\\infty$ and to $-\\infty$ as $\\psi_s \\to +\\infty$. Therefore, by the Intermediate Value Theorem, a unique root for $\\psi_s$ exists for any given set of physical parameters and local channel potential $V$. The subsequent integration to find the drain current is a standard numerical procedure on a well-behaved function.\n3.  **Objective:** The problem is stated in precise, quantitative, and unambiguous mathematical and physical terms, free from any subjective or biased language.\n4.  **Self-Contained and Consistent:** All necessary equations, parameters, and constants are provided. The modeling steps are logically ordered and internally consistent.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. It is a well-posed, scientifically sound, and self-contained task representative of a standard problem in computational nanoelectronics and compact model development. Therefore, a solution will be provided.\n\n### Solution Derivation\n\nThe solution follows the five modeling steps prescribed in the problem statement. The core of the task is to numerically compute the drain current integral:\n$$\nI_{D} = \\frac{\\mu}{L}\\int_{0}^{V_{\\text{DS}}}\\big(-Q_{\\text{inv}}^{\\ell}(V)\\big)\\,\\mathrm{d}V\n$$\nTo evaluate the integrand, $-Q_{\\text{inv}}^{\\ell}(V)$, at any given local channel potential $V \\in [0, V_{\\text{DS}}]$, we must first determine the corresponding surface potential, $\\psi_s(V)$.\n\n**1. Constants and Derived Parameters**\nFirst, we establish the physical constants and compute the thermal voltage $\\phi_t = k_B T / q$, silicon permittivity $\\varepsilon_{\\text{si}}$, and silicon dioxide permittivity $\\varepsilon_{\\text{ox}}$. For each test case, we compute the geometry-dependent parameters: the effective electrical width $W_{\\text{eff}}$ and the effective oxide capacitance per unit length $C_{\\text{ox,eff}}^{\\ell}$.\n$$\nW_{\\text{eff}} = W_{\\text{fin}} + 2H_{\\text{fin}}\n$$\n$$\nC_{\\text{ox,eff}}^{\\ell} = \\varepsilon_{\\text{ox}}\\left(\\frac{W_{\\text{fin}}}{t_{\\text{ox,top}}} + \\frac{2H_{\\text{fin}}}{t_{\\text{ox,side}}}\\right)\n$$\n\n**2. Surface Potential Calculation**\nThe surface potential $\\psi_s$ is determined by the charge balance equation, which equates the gate-controlled charge with the total semiconductor charge. This yields the implicit equation for $\\psi_s$:\n$$\nF(\\psi_s, V) = C_{\\text{ox,eff}}^{\\ell}\\big(V_{\\text{GS}} - V_{\\text{FB}} - \\psi_{s}\\big) + W_{\\text{eff}}\\big(Q_{\\text{dep}}(\\psi_{s}) + Q_{\\text{inv}}(\\psi_{s},V)\\big) = 0\n$$\nThe charge components are defined as:\n- Depletion charge per unit area, for $\\psi_s \\ge 0$:\n$$\nQ_{\\text{dep}}(\\psi_{s}) = -\\sqrt{2\\,\\varepsilon_{\\text{si}}\\,q\\,N_{A}\\,\\phi_{t}}\\;\\sqrt{\\psi_{s}/\\phi_{t} + e^{-\\psi_{s}/\\phi_{t}} - 1}\n$$\n- Inversion charge per unit area:\n$$\nQ_{\\text{inv}}(\\psi_{s},V) = -\\sqrt{\\varepsilon_{\\text{si}}\\,q\\,\\phi_{t}\\,\\frac{n_{i}^{2}}{N_{A}}} \\cdot e^{(\\psi_{s}-V)/(2\\phi_{t})}\n$$\nThis implicit equation $F(\\psi_s, V)=0$ must be solved numerically for $\\psi_s$ for each value of $V$ required by the numerical integration routine. As established in the validation, $F(\\psi_s, V)$ is a monotonic function of $\\psi_s$, making it ideally suited for a robust root-finding algorithm like the Brent-Dekker method.\n\n**3. Drain Current Integration**\nWith a method to find $\\psi_s(V)$, we can define the integrand for the drain current calculation:\n$$\n\\text{Integrand}(V) = -Q_{\\text{inv}}^{\\ell}(V) = -W_{\\text{eff}}\\,Q_{\\text{inv}}(\\psi_s(V), V)\n$$\nThe procedure to evaluate this integrand at a potential $V$ is:\na. Solve $F(\\psi_s, V) = 0$ to find the root $\\psi_s(V)$.\nb. Substitute this $\\psi_s(V)$ into the expression for $Q_{\\text{inv}}(\\psi_s, V)$.\nc. Multiply by $-W_{\\text{eff}}$.\n\nThe total drain current $I_D$ is then computed by performing a numerical quadrature (integration) of this integrand function over the interval $V \\in [0, V_{\\text{DS}}]$ and multiplying by the mobility-length factor $\\mu/L$. A standard adaptive quadrature algorithm, such as the one provided by SciPy's `quad` function, is suitable for this task.\n\n**4. Implementation Strategy**\nThe overall algorithm for each test case is a nested numerical procedure:\n- An **outer routine** performs the numerical integration of the channel charge with respect to the local potential $V$ from source ($0$) to drain ($V_{\\text{DS}}$).\n- An **inner routine**, called by the outer integration routine for each point $V$, performs a root-finding search to solve the implicit equation for the surface potential $\\psi_s(V)$.\n\nThis structured approach ensures a correct and robust implementation of the specified surface-potential-based model. The final program will encapsulate this logic, iterate through the given test cases, and produce the required formatted output.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve for the drain current in a FinFET for given test cases.\n    \"\"\"\n    # Physical Constants in SI units\n    Q = 1.602176634e-19  # Elementary charge (C)\n    EPS0 = 8.854187817e-12 # Vacuum permittivity (F/m)\n    KB = 1.380649e-23     # Boltzmann constant (J/K)\n    T = 300.0             # Temperature (K)\n    \n    # Material Parameters (Silicon)\n    NI = 1.45e16          # Intrinsic carrier concentration (m^-3) at 300K\n    EPS_SI_REL = 11.7     # Relative permittivity of Silicon\n    EPS_OX_REL = 3.9      # Relative permittivity of SiO2\n    \n    EPS_SI = EPS_SI_REL * EPS0\n    EPS_OX = EPS_OX_REL * EPS0\n    \n    # Derived Constants\n    PHI_T = KB * T / Q    # Thermal voltage (V)\n\n    # Test cases from the problem statement\n    # (W_fin, H_fin, t_ox_top, t_ox_side, L, N_A, mu, V_GS, V_DS, V_FB)\n    test_cases = [\n        (20e-9, 40e-9, 1.2e-9, 1.2e-9, 50e-9, 5.0e22, 0.05, 0.8, 0.05, 0.0),\n        (20e-9, 40e-9, 1.2e-9, 1.2e-9, 50e-9, 5.0e22, 0.05, 0.8, 0.8, 0.0),\n        (20e-9, 40e-9, 1.2e-9, 1.2e-9, 50e-9, 5.0e22, 0.05, 0.2, 0.8, 0.0),\n        (8e-9, 60e-9, 1.5e-9, 0.8e-9, 30e-9, 1.0e23, 0.03, 0.8, 0.5, 0.0),\n    ]\n\n    def compute_drain_current(params):\n        \"\"\"\n        Computes the drain current for a single set of device parameters.\n        \"\"\"\n        W_fin, H_fin, t_ox_top, t_ox_side, L, N_A, mu, V_GS, V_DS, V_FB = params\n\n        # Step 1: Compute effective width and capacitance\n        W_eff = W_fin + 2 * H_fin\n        C_ox_eff_l = EPS_OX * (W_fin / t_ox_top + 2 * H_fin / t_ox_side)\n\n        # Pre-calculate constant factors for charge models to optimize\n        q_dep_factor = -np.sqrt(2 * EPS_SI * Q * N_A * PHI_T)\n        q_inv_factor = -np.sqrt(EPS_SI * Q * PHI_T * (NI**2 / N_A))\n\n        # Step 3: Define depletion charge function Q_dep(psi_s)\n        def q_dep(psi_s):\n            if psi_s  0:\n                return 0.0\n            \n            # The term under the square root is always non-negative\n            term = psi_s / PHI_T + np.exp(-psi_s / PHI_T) - 1.0\n            return q_dep_factor * np.sqrt(term)\n\n        # Step 4: Define inversion charge function Q_inv(psi_s, V)\n        def q_inv(psi_s, V):\n            return q_inv_factor * np.exp((psi_s - V) / (2 * PHI_T))\n\n        # Step 2: Define the implicit equation F(psi_s, V) = 0\n        def implicit_eq(psi_s, V):\n            lhs = C_ox_eff_l * (V_GS - V_FB - psi_s)\n            rhs = W_eff * (q_dep(psi_s) + q_inv(psi_s, V))\n            return lhs + rhs\n\n        # Step 5: Define the integrand for the drain current integral\n        def integrand(V):\n            # Inner loop: find psi_s for a given V using a root-finder\n            try:\n                # A robust search interval for psi_s that brackets the root\n                psi_s_root = brentq(\n                    lambda psi: implicit_eq(psi, V),\n                    a=-1.0, \n                    b=V_GS - V_FB + 2.0 * PHI_T + 1.0\n                )\n            except ValueError:\n                # Brentq fails if the root is not bracketed. This indicates an issue.\n                # In this well-behaved problem, this should not happen.\n                return 0.0\n            \n            # Calculate total inversion charge per unit length\n            q_inv_l = W_eff * q_inv(psi_s_root, V)\n            return -q_inv_l\n\n        # Outer loop: numerically integrate the charge along the channel\n        integral_val, _ = quad(integrand, 0, V_DS)\n\n        # Final drain current\n        I_D = (mu / L) * integral_val\n        return I_D\n\n    results = []\n    for case in test_cases:\n        I_D = compute_drain_current(case)\n        results.append(I_D)\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Advanced compact models must often account for multi-physics interactions to be truly predictive. This final practice introduces the critical concept of electro-thermal feedback, or self-heating, where power dissipated as heat raises the device temperature, in turn altering its electrical characteristics. You will model this feedback loop by self-consistently solving for the steady-state temperature and analyzing its impact on the drain current ($I_D$) and output conductance ($g_{ds}$). This exercise  illustrates how to enhance the physical realism of a model, a crucial consideration for devices where power density is high.",
            "id": "3776283",
            "problem": "A long-channel Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) operating in the saturation region exhibits self-heating that couples the electrical and thermal domains. Consider a surface-potential-based compact modeling perspective in which the drain current in saturation arises from the gradual-channel approximation and channel charge governed by the surface potential. Assume strong inversion such that the channel is pinched off at the drain end with the surface potential pinned near twice the Fermi potential, leading to a current controlled by the inversion charge set by the gate overdrive. The device is thermally connected to the ambient through a finite thermal resistance.\n\nStarting from:\n- Charge-sheet formulation and drift-diffusion transport under the gradual-channel approximation.\n- Steady-state thermal balance modeled by a lumped thermal resistance.\n- Widely used temperature dependencies for mobility and threshold voltage that are valid over modest temperature excursions.\n\nDerive from first principles:\n1) The steady-state channel temperature in saturation as the fixed point of the electro-thermal feedback for a given thermal resistance.\n2) The resulting feedback on the drain current and the small-signal output conductance.\n\nUse the following physically justified modeling assumptions:\n- The low-field mobility has a power-law temperature dependence given by $\\mu(T) = \\mu_0 \\left( \\dfrac{T_0}{T} \\right)^m$, where $\\mu_0$ is the mobility at $T_0$ and $m$ is a positive exponent determined by phonon scattering.\n- The threshold voltage varies approximately linearly with temperature as $V_{th}(T) = V_{th0} - \\kappa \\left( T - T_0 \\right)$, where $\\kappa  0$ is a proportionality constant, and $V_{th0}$ is the threshold at $T_0$.\n- In strong inversion saturation, neglecting velocity saturation and drain-induced barrier lowering, the drain current at fixed temperature follows from integrating the inversion charge along the channel under the surface-potential framework to yield $I_0(T) = \\dfrac{1}{2} \\mu(T) C_{ox} \\dfrac{W}{L} \\left( V_G - V_{th}(T) \\right)^2$ for $V_G  V_{th}(T)$, and $I_0(T) = 0$ otherwise. Include channel length modulation using a linear factor $(1 + \\lambda V_{DS})$ with constant $\\lambda$.\n- The steady-state temperature satisfies the thermal fixed point $T = T_{amb} + R_{th} P$, where $P = V_{DS} I_D$ and $I_D$ is the saturation current including channel length modulation evaluated at $T$.\n- The small-signal output conductance is $g_{ds} = \\dfrac{d I_D}{d V_{DS}}$ at fixed gate voltage, including electro-thermal feedback. Use implicit differentiation of the steady-state thermal equation to obtain an expression that includes both the direct drain-voltage sensitivity at fixed temperature and the contribution via temperature change with $V_{DS}$.\n\nYour tasks:\n- From the stated bases, derive mathematically the equation for the steady-state temperature as a fixed point, and obtain an explicit formula for $g_{ds}$ in terms of partial derivatives of $I_D$ with respect to $T$ and $V_{DS}$ at fixed $T$.\n- Implement a robust numerical procedure to solve for $T$ and evaluate $I_D$ and $g_{ds}$ for the parameters in the test suite below.\n\nUse constants and variables in the units indicated:\n- Channel width $W$ in meters.\n- Channel length $L$ in meters.\n- Gate-oxide capacitance density $C_{ox}$ in farads per square meter.\n- Mobility parameters $\\mu_0$ in square meters per volt-second, $m$ unitless.\n- Threshold parameters $V_{th0}$ in volts, $\\kappa$ in volts per kelvin, $T_0$ in kelvin.\n- Ambient temperature $T_{amb}$ in kelvin.\n- Thermal resistance $R_{th}$ in kelvin per watt.\n- Gate and drain-source voltages $V_G, V_{DS}$ in volts.\n- Channel length modulation parameter $\\lambda$ in inverse volts.\n\nAngle units are not applicable. Express all temperatures in kelvin, currents in amperes, and conductances in siemens. For numerical output, round each value to exactly six decimal places.\n\nTest suite (each test case is an independent evaluation):\n- Case A (nominal self-heating): $W = 10 \\times 10^{-6}$, $L = 0.1 \\times 10^{-6}$, $C_{ox} = 1.5 \\times 10^{-2}$, $\\mu_0 = 0.05$, $m = 1.5$, $V_{th0} = 0.4$, $\\kappa = 1.5 \\times 10^{-3}$, $T_0 = 300$, $T_{amb} = 300$, $R_{th} = 5 \\times 10^{3}$, $V_G = 0.8$, $V_{DS} = 0.7$, $\\lambda = 0.05$.\n- Case B (negligible self-heating): $W = 10 \\times 10^{-6}$, $L = 0.1 \\times 10^{-6}$, $C_{ox} = 1.5 \\times 10^{-2}$, $\\mu_0 = 0.05$, $m = 1.5$, $V_{th0} = 0.4$, $\\kappa = 1.5 \\times 10^{-3}$, $T_0 = 300$, $T_{amb} = 300$, $R_{th} = 100$, $V_G = 0.7$, $V_{DS} = 0.5$, $\\lambda = 0.05$.\n- Case C (strong self-heating): $W = 10 \\times 10^{-6}$, $L = 0.1 \\times 10^{-6}$, $C_{ox} = 1.5 \\times 10^{-2}$, $\\mu_0 = 0.05$, $m = 1.5$, $V_{th0} = 0.4$, $\\kappa = 1.5 \\times 10^{-3}$, $T_0 = 300$, $T_{amb} = 300$, $R_{th} = 2 \\times 10^{4}$, $V_G = 0.9$, $V_{DS} = 1.0$, $\\lambda = 0.05$.\n- Case D (near saturation boundary with small overdrive): $W = 10 \\times 10^{-6}$, $L = 0.1 \\times 10^{-6}$, $C_{ox} = 1.5 \\times 10^{-2}$, $\\mu_0 = 0.05$, $m = 1.5$, $V_{th0} = 0.5$, $\\kappa = 1.5 \\times 10^{-3}$, $T_0 = 300$, $T_{amb} = 300$, $R_{th} = 10^{3}$, $V_G = 0.55$, $V_{DS} = 0.06$, $\\lambda = 0.05$.\n\nFor each test case, compute:\n- The steady-state temperature $T$ in kelvin.\n- The saturation drain current $I_D$ in amperes.\n- The small-signal output conductance $g_{ds}$ in siemens.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of four lists, each inner list corresponding to a test case in the order A, B, C, D and having the form $[T, I_D, g_{ds}]$, with each value rounded to six decimal places. For example: $[[300.000000,0.001234,0.000100],[\\dots],\\dots]$.",
            "solution": "The problem requires the derivation of the steady-state channel temperature and small-signal output conductance for a long-channel MOSFET operating in saturation, considering electro-thermal feedback. A numerical solution for specific parameter sets is then required.\n\n### **Problem Validation**\n**Step 1: Extracted Givens**\n-   Mobility model: $\\mu(T) = \\mu_0 \\left( \\dfrac{T_0}{T} \\right)^m$\n-   Threshold voltage model: $V_{th}(T) = V_{th0} - \\kappa \\left( T - T_0 \\right)$\n-   Saturation drain current model (including channel length modulation): $I_D(T, V_{DS}) = I_0(T) (1 + \\lambda V_{DS})$, where $I_0(T) = \\dfrac{1}{2} \\mu(T) C_{ox} \\dfrac{W}{L} \\left( V_G - V_{th}(T) \\right)^2$ for $V_G  V_{th}(T)$, and $I_0(T) = 0$ otherwise.\n-   Thermal model: $T = T_{amb} + R_{th} P$, with power dissipation $P = V_{DS} I_D$.\n-   Output conductance definition: $g_{ds} = \\dfrac{d I_D}{d V_{DS}}$ at fixed $V_G$.\n-   Four test cases with specific numerical values for all parameters ($W, L, C_{ox}, \\mu_0, m, V_{th0}, \\kappa, T_0, T_{amb}, R_{th}, V_G, V_{DS}, \\lambda$) are provided.\n\n**Step 2: Validation of Givens**\nThe problem statement is scientifically sound, well-posed, and objective.\n-   **Scientific Grounding**: The problem uses standard, first-order compact models for MOSFET behavior. The square-law saturation current, power-law mobility degradation, linear threshold voltage shift with temperature, and lumped thermal resistance are all cornerstone concepts taught in semiconductor device physics.\n-   **Well-Posedness**: The problem is clearly defined. It provides a complete system of coupled equations and asks for the derivation and numerical evaluation of specific quantities ($T, I_D, g_{ds}$). A unique, stable solution is expected for the given physical parameters.\n-   **Objectivity**: The problem is presented using precise mathematical and physical terminology, with no subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full derivation and solution are warranted.\n\n### **Theoretical Derivation**\n\n**1. Steady-State Temperature ($T$)**\n\nThe steady-state condition is achieved when the heat generated by the device is balanced by the heat dissipated to the ambient environment. This is captured by the given system of electro-thermal equations. We combine them to form a single, self-consistent equation for the channel temperature $T$.\n\nThe drain current $I_D$ is a function of temperature $T$:\n$$I_D(T) = \\frac{1}{2} C_{ox} \\frac{W}{L} (1 + \\lambda V_{DS}) \\left[ \\mu_0 \\left( \\frac{T_0}{T} \\right)^m \\right] \\left[ V_G - \\left(V_{th0} - \\kappa (T - T_0)\\right) \\right]^2$$\nThe power dissipation is $P(T) = V_{DS} I_D(T)$. The thermal balance equation is:\n$$T = T_{amb} + R_{th} P(T)$$\nSubstituting the expression for $P(T)$ gives the fixed-point equation for the steady-state temperature, which we will denote as $T_{ss}$:\n$$T_{ss} = T_{amb} + R_{th} V_{DS} \\left( \\frac{1}{2} C_{ox} \\frac{W}{L} (1 + \\lambda V_{DS}) \\left[ \\mu_0 \\left( \\frac{T_0}{T_{ss}} \\right)^m \\right] \\left[ V_G - V_{th0} + \\kappa (T_{ss} - T_0) \\right]^2 \\right)$$\nThis is a transcendental equation for $T_{ss}$ of the form $T_{ss} = F(T_{ss})$. It cannot be solved analytically and requires a numerical root-finding algorithm. We can define a function $G(T) = T - F(T)$ and find the root $T_{ss}$ such that $G(T_{ss}) = 0$.\n\n**2. Small-Signal Output Conductance ($g_{ds}$)**\n\nThe small-signal output conductance $g_{ds}$ is defined as the total derivative of the drain current $I_D$ with respect to the drain-source voltage $V_{DS}$, at a constant gate voltage $V_G$.\n$$g_{ds} = \\frac{d I_D}{d V_{DS}}$$\nSince $I_D$ depends on $V_{DS}$ both directly (through the $1 + \\lambda V_{DS}$ term) and indirectly through the temperature $T$ (since $T$ depends on power $P = V_{DS}I_D$), we must use the chain rule:\n$$g_{ds} = \\frac{\\partial I_D}{\\partial V_{DS}} \\bigg|_{T} + \\frac{\\partial I_D}{\\partial T} \\bigg|_{V_{DS}} \\frac{d T}{d V_{DS}}$$\nLet's derive each term:\n\n-   **Isothermal Conductance $\\left(\\frac{\\partial I_D}{\\partial V_{DS}} \\big|_{T}\\right)$**: This is the change in current with $V_{DS}$ if the temperature were held constant.\n    $$I_D(V_{DS}, T) = I_0(T) (1 + \\lambda V_{DS})$$\n    $$\\frac{\\partial I_D}{\\partial V_{DS}} \\bigg|_{T} = \\lambda I_0(T) = \\frac{\\lambda I_D}{1 + \\lambda V_{DS}}$$\n\n-   **Current Sensitivity to Temperature $\\left(\\frac{\\partial I_D}{\\partial T} \\big|_{V_{DS}}\\right)$**: This captures how current changes with temperature. It's convenient to use logarithmic differentiation on $I_D(T) = K \\cdot \\mu(T) \\cdot (V_G - V_{th}(T))^2$, where $K$ contains all terms independent of $T$.\n    $$\\ln I_D = \\ln K + \\ln \\mu(T) + 2 \\ln(V_G - V_{th}(T))$$\n    $$\\frac{1}{I_D} \\frac{\\partial I_D}{\\partial T} = \\frac{1}{\\mu} \\frac{d\\mu}{dT} + \\frac{2}{V_G - V_{th}(T)} \\frac{d(V_G-V_{th}(T))}{dT}$$\n    With $\\frac{d\\mu}{dT} = -m \\frac{\\mu}{T}$ and $\\frac{d(V_G-V_{th}(T))}{dT} = \\kappa$, this becomes:\n    $$\\frac{\\partial I_D}{\\partial T} = I_D \\left( \\frac{2\\kappa}{V_G - V_{th}(T)} - \\frac{m}{T} \\right)$$\n\n-   **Temperature Sensitivity to Voltage $\\left(\\frac{d T}{d V_{DS}}\\right)$**: This term is found by implicitly differentiating the thermal balance equation $T = T_{amb} + R_{th} V_{DS} I_D(V_{DS}, T)$ with respect to $V_{DS}$.\n    $$\\frac{dT}{dV_{DS}} = R_{th} \\frac{d(V_{DS}I_D)}{dV_{DS}} = R_{th} \\left( \\frac{\\partial(V_{DS}I_D)}{\\partial V_{DS}}\\bigg|_T + \\frac{\\partial(V_{DS}I_D)}{\\partial T}\\bigg|_{V_{DS}} \\frac{dT}{dV_{DS}} \\right)$$\n    $$\\frac{dT}{dV_{DS}} = R_{th} \\left( I_D + V_{DS}\\frac{\\partial I_D}{\\partial V_{DS}}\\bigg|_T + V_{DS}\\frac{\\partial I_D}{\\partial T}\\frac{dT}{dV_{DS}} \\right)$$\n    Solving for $\\frac{dT}{dV_{DS}}$:\n    $$\\frac{dT}{dV_{DS}} \\left( 1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T} \\right) = R_{th} \\left( I_D + V_{DS} \\frac{\\partial I_D}{\\partial V_{DS}}\\big|_T \\right)$$\n    $$\\frac{dT}{dV_{DS}} = \\frac{ R_{th} \\left( I_D + V_{DS} \\frac{\\partial I_D}{\\partial V_{DS}}\\big|_T \\right) }{ 1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T} }$$\n-   **Final Assembly of $g_{ds}$**: Substituting the expression for $\\frac{dT}{dV_{DS}}$ back into the chain rule expansion for $g_{ds}$:\n    $$g_{ds} = \\frac{\\partial I_D}{\\partial V_{DS}}\\bigg|_T + \\frac{\\partial I_D}{\\partial T} \\left( \\frac{R_{th} \\left( I_D + V_{DS} \\frac{\\partial I_D}{\\partial V_{DS}}\\big|_T \\right)}{1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T}} \\right)$$\n    Placing all terms over the common denominator $1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T}$:\n    $$g_{ds} = \\frac{ \\frac{\\partial I_D}{\\partial V_{DS}}\\big|_T \\left( 1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T} \\right) + \\frac{\\partial I_D}{\\partial T} R_{th} \\left( I_D + V_{DS} \\frac{\\partial I_D}{\\partial V_{DS}}\\big|_T \\right) }{ 1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T} }$$\n    The cross-terms in the numerator cancel: $-R_{th} V_{DS} \\frac{\\partial I_D}{\\partial V_{DS}}\\big|_T \\frac{\\partial I_D}{\\partial T} + R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T} \\frac{\\partial I_D}{\\partial V_{DS}}\\big|_T = 0$.\n    This simplifies to the final expression for the electro-thermal output conductance:\n    $$g_{ds} = \\frac{\\frac{\\partial I_D}{\\partial V_{DS}} \\bigg|_{T} + R_{th} I_D \\frac{\\partial I_D}{\\partial T}}{1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T}}$$\n    All quantities ($T, I_D$, and the partial derivatives) in this final expression are evaluated at the steady-state operating point. The denominator, $1 - R_{th} V_{DS} \\frac{\\partial I_D}{\\partial T}$, represents the electro-thermal feedback loop gain; if it approaches zero, thermal instability can occur.\n\n### **Numerical Implementation**\nThe numerical solution involves two main steps for each test case:\n1.  Solve the fixed-point equation $G(T) = T - T_{amb} - R_{th} V_{DS} I_D(T) = 0$ for the steady-state temperature $T_{ss}$ using a numerical root-finder like the Brent-Dekker method. A physically sensible search interval is $[T_{amb}, T_{max}]$, where $T_{max}$ is a sufficiently high temperature (e.g., $700$ K).\n2.  Substitute the obtained $T_{ss}$ back into the analytical expressions for $I_D$ and $g_{ds}$ to compute their numerical values.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state temperature, drain current, and output conductance\n    of a MOSFET with self-heating effects for a given set of test cases.\n    \"\"\"\n    # Test suite parameters:\n    # (W, L, C_ox, mu_0, m, V_th0, kappa, T_0, T_amb, R_th, V_G, V_DS, lambda)\n    # Units are SI: m, F/m^2, m^2/Vs, -, V, V/K, K, K, K/W, V, V, 1/V\n    test_cases = [\n        # Case A (nominal self-heating)\n        (10e-6, 0.1e-6, 1.5e-2, 0.05, 1.5, 0.4, 1.5e-3, 300, 300, 5e3, 0.8, 0.7, 0.05),\n        # Case B (negligible self-heating)\n        (10e-6, 0.1e-6, 1.5e-2, 0.05, 1.5, 0.4, 1.5e-3, 300, 300, 100, 0.7, 0.5, 0.05),\n        # Case C (strong self-heating)\n        (10e-6, 0.1e-6, 1.5e-2, 0.05, 1.5, 0.4, 1.5e-3, 300, 300, 2e4, 0.9, 1.0, 0.05),\n        # Case D (near saturation boundary with small overdrive)\n        (10e-6, 0.1e-6, 1.5e-2, 0.05, 1.5, 0.5, 1.5e-3, 300, 300, 1e3, 0.55, 0.06, 0.05),\n    ]\n\n    all_results_formatted = []\n\n    for case_params in test_cases:\n        W, L, Cox, mu0, m, Vth0, kappa, T0, Tamb, Rth, VG, VDS, lam = case_params\n\n        # --- Helper functions for physical models ---\n        def v_th(T):\n            \"\"\"Threshold voltage as a function of temperature.\"\"\"\n            return Vth0 - kappa * (T - T0)\n        \n        def mu(T):\n            \"\"\"Mobility as a function of temperature.\"\"\"\n            if T = 0: return 0.0\n            return mu0 * (T0 / T)**m\n        \n        def i_d(T):\n            \"\"\"Drain current as a function of temperature.\"\"\"\n            v_g_eff = VG - v_th(T)\n            if v_g_eff = 0:\n                return 0.0\n            \n            i0_T = 0.5 * mu(T) * Cox * (W / L) * v_g_eff**2\n            return i0_T * (1.0 + lam * VDS)\n\n        def thermal_balance_eq(T):\n            \"\"\"The fixed-point equation for temperature, T - f(T) = 0.\"\"\"\n            power = VDS * i_d(T)\n            return T - (Tamb + Rth * power)\n\n        # --- Step 1: Solve for steady-state temperature T_ss ---\n        try:\n            # A search range from ambient to a high temperature like 700 K is physically sound.\n            T_ss = brentq(thermal_balance_eq, a=Tamb, b=700.0)\n        except ValueError:\n            # Handle cases where the root is not bracketed (e.g., thermal runaway)\n            T_ss, I_D_ss, g_ds = np.nan, np.nan, np.nan\n        else:\n            # --- Step 2: Calculate I_D and g_ds at T_ss ---\n            I_D_ss = i_d(T_ss)\n            \n            V_g_eff_ss = VG - v_th(T_ss)\n            if V_g_eff_ss = 0:\n                g_ds = 0.0\n            else:\n                # Isothermal part: d(I_D)/d(V_DS) at constant T\n                if (1.0 + lam * VDS) == 0:\n                    i0_ss = 0.0\n                else:\n                    i0_ss = I_D_ss / (1.0 + lam * VDS)\n                dID_dVDS_const_T = lam * i0_ss\n\n                # Thermal sensitivity part: d(I_D)/d(T) at constant V_DS\n                if T_ss > 0:\n                    dID_dT_const_VDS = I_D_ss * ((2.0 * kappa / V_g_eff_ss) - (m / T_ss))\n                else:\n                    dID_dT_const_VDS = 0.0\n\n                # Assemble g_ds using the derived formula\n                numerator = dID_dVDS_const_T + Rth * I_D_ss * dID_dT_const_VDS\n                denominator = 1.0 - Rth * VDS * dID_dT_const_VDS\n                \n                g_ds = numerator / denominator if abs(denominator) > 1e-15 else np.inf\n        \n        # Format the results for the current case\n        case_result_str = f\"[{T_ss:.6f},{I_D_ss:.6f},{g_ds:.6f}]\"\n        all_results_formatted.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```"
        }
    ]
}