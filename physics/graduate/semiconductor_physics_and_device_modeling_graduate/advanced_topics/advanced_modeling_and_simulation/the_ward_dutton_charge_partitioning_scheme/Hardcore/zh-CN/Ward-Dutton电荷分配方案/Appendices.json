{
    "hands_on_practices": [
        {
            "introduction": "掌握 Ward-Dutton 电荷分配方案的第一步是直接应用其定义。本练习  将指导您为一个工作在线性区的长沟道 MOSFET，基于该方案的积分公式推导源极和漏极的终端电荷。通过这个基本计算，您将熟悉将沟道中的分布式电荷分配到各个终端的数学过程。",
            "id": "3781920",
            "problem": "考虑一个长沟道、准静态的 n 沟道金属-氧化物-半导体场效应晶体管 (MOSFET)，其沟道宽度为 $W$，长度为 $L$，单位面积的栅极氧化层电容为 $C_{ox}$。体电极（衬底）与源极相连，阈值电压为 $V_{th}$，并假定在所关心的偏置范围内与偏置无关。器件偏置的栅源电压 $V_{GS}$ 满足 $V_{GS} > V_{th}$（强反型），漏源电压 $V_{DS}$ 满足 $0  V_{DS}  V_{GS} - V_{th}$（线性区）。忽略速度饱和、沟道长度调制和短沟道效应，并假设沟道电势均匀下降。在这些条件下，沿沟道的电子准费米势近似呈线性，即 $V(x) = \\frac{V_{DS}}{L} x$，其中 $x \\in [0, L]$，$x$ 是从源极 ($x = 0$) 到漏极 ($x = L$) 的坐标。在强反型区，单位面积的局部反型电荷近似为 $q_{\\text{inv}}(x) = -C_{ox}\\left(V_{GS} - V_{th} - V(x)\\right)$。\n\n使用 Ward-Dutton 电荷分配方案，该方案通过与电荷守恒和互易性一致的线性权重函数对分布的沟道电荷进行加权来分配端电荷，源极和漏极的权重函数分别为 $w_{S}(x) = 1 - \\frac{x}{L}$ 和 $w_{D}(x) = \\frac{x}{L}$。端电荷 $Q_{S}$ 和 $Q_{D}$ 定义为通过将反型电荷密度与相应的权重函数相乘后在整个沟道面积上积分，从而分配给源极和漏极端子的准静态电荷。\n\n推导源极和漏极端电荷 $Q_{S}$ 和 $Q_{D}$ 作为 $V_{GS}$、$V_{DS}$、$V_{th}$、$W$、$L$ 和 $C_{ox}$ 的函数解析表达式，并明确显示其对 $V_{DS}$ 的依赖关系。最终答案以库仑为单位表示。您的最终答案必须是一个包含 $Q_{S}$ 和 $Q_{D}$ 的单一闭合形式表达式，无需进行数值计算或四舍五入。",
            "solution": "在尝试任何解答之前，题目陈述都经过了严格的验证过程。\n\n**问题验证**\n\n步骤 1：提取已知条件\n题目陈述中提供了以下信息：\n-   器件：长沟道、准静态的 n 沟道 MOSFET。\n-   尺寸：沟道宽度 $W$，沟道长度 $L$。\n-   氧化层电容：单位面积的栅极氧化层电容 $C_{ox}$。\n-   配置：体电极端子与源极相连。\n-   阈值电压：$V_{th}$，假定为常数。\n-   偏置条件：强反型 ($V_{GS} > V_{th}$) 和线性区 ($0  V_{DS}  V_{GS} - V_{th}$)。\n-   假设：忽略速度饱和、沟道长度调制和短沟道效应。沟道电势均匀下降。\n-   沟道电势模型：$V(x) = \\frac{V_{DS}}{L} x$，其中 $x \\in [0, L]$，$x=0$ 处为源极，$x=L$ 处为漏极。\n-   反型电荷模型：单位面积的局部反型电荷为 $q_{\\text{inv}}(x) = -C_{ox}\\left(V_{GS} - V_{th} - V(x)\\right)$。\n-   电荷分配方案：使用 Ward-Dutton 方案，源极权重函数为 $w_{S}(x) = 1 - \\frac{x}{L}$，漏极权重函数为 $w_{D}(x) = \\frac{x}{L}$。\n-   端电荷定义：源电荷 $Q_{S}$ 和漏电荷 $Q_{D}$ 通过对加权的反型电荷密度在沟道面积上积分得到。\n\n步骤 2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题基于长沟道 MOSFET 的标准、一阶、基于电荷的模型。缓变沟道近似、强反型区中的反型电荷表达式，以及使用线性权重函数的 Ward-Dutton 电荷分配方案，都是半导体器件物理和紧凑建模中公认的基本概念。该问题是科学合理的。\n-   **适定性：** 所需积分的所有必要函数（$q_{\\text{inv}}(x)$、$w_S(x)$、$w_D(x)$）和参数（$W$、$L$、$V_{GS}$、$V_{DS}$、$V_{th}$、$C_{ox}$）都已明确提供。该任务是积分学的直接应用，可以得出一个唯一且有意义的解析解。\n-   **客观性：** 该问题使用精确、明确的技术语言陈述。没有主观或定性的陈述。\n-   **其他缺陷：** 在其陈述的理论框架内，该问题没有矛盾、信息缺失或物理上不可能的条件。诸如线性电势分布之类的假设是此级别分析的标准简化，并与其他模型方程一致。\n\n步骤 3：结论与行动\n该问题被判定为 **有效**，因为其具有科学依据、适定、客观且内部一致。将推导求解。\n\n**端电荷的推导**\n\n源极端电荷 $Q_S$ 和漏极端电荷 $Q_D$ 的定义是，将分布的反型沟道电荷 $q_{\\text{inv}}(x)$ 分别乘以相应的 Ward-Dutton 权重函数 $w_S(x)$ 和 $w_D(x)$ 后，在整个沟道面积上进行积分。沟道面积是一个宽度为 $W$、长度为 $L$ 的矩形。由于电荷密度和权重函数仅沿沟道长度（$x$ 方向）变化，因此沿宽度（$y$ 方向）的积分只是引入了一个因子 $W$。\n\n定义如下：\n$$Q_S = \\int_{Area} q_{\\text{inv}}(x) w_S(x) \\,dA = W \\int_{0}^{L} q_{\\text{inv}}(x) w_S(x) \\,dx$$\n$$Q_D = \\int_{Area} q_{\\text{inv}}(x) w_D(x) \\,dA = W \\int_{0}^{L} q_{\\text{inv}}(x) w_D(x) \\,dx$$\n\n首先，我们将给定的 $q_{\\text{inv}}(x)$、$V(x)$、$w_S(x)$ 和 $w_D(x)$ 表达式代入这些积分中。\n单位面积的局部反型电荷为：\n$$q_{\\text{inv}}(x) = -C_{ox}\\left(V_{GS} - V_{th} - V(x)\\right) = -C_{ox}\\left(V_{GS} - V_{th} - \\frac{V_{DS}}{L}x\\right)$$\n\n**源电荷 ($Q_S$) 的计算**\n\n我们使用源极权重函数 $w_S(x) = 1 - \\frac{x}{L}$。$Q_S$ 的积分为：\n$$Q_S = W \\int_{0}^{L} \\left[-C_{ox}\\left(V_{GS} - V_{th} - \\frac{V_{DS}}{L}x\\right)\\right] \\left(1 - \\frac{x}{L}\\right) \\,dx$$\n我们可以将常数项 $-W C_{ox}$ 提到积分号外：\n$$Q_S = -W C_{ox} \\int_{0}^{L} \\left(V_{GS} - V_{th} - \\frac{V_{DS}}{L}x\\right) \\left(1 - \\frac{x}{L}\\right) \\,dx$$\n展开积分内的项：\n$$Q_S = -W C_{ox} \\int_{0}^{L} \\left[ (V_{GS} - V_{th}) - \\frac{(V_{GS} - V_{th})}{L}x - \\frac{V_{DS}}{L}x + \\frac{V_{DS}}{L^2}x^2 \\right] \\,dx$$\n对 $x$ 从 $0$ 到 $L$ 逐项积分：\n$$Q_S = -W C_{ox} \\left[ (V_{GS} - V_{th})x - \\frac{(V_{GS} - V_{th})}{L}\\frac{x^2}{2} - \\frac{V_{DS}}{L}\\frac{x^2}{2} + \\frac{V_{DS}}{L^2}\\frac{x^3}{3} \\right]_{0}^{L}$$\n在上下限 $x=L$ 和 $x=0$ 处计算表达式的值：\n$$Q_S = -W C_{ox} \\left( (V_{GS} - V_{th})L - \\frac{(V_{GS} - V_{th})}{L}\\frac{L^2}{2} - \\frac{V_{DS}}{L}\\frac{L^2}{2} + \\frac{V_{DS}}{L^2}\\frac{L^3}{3} \\right)$$\n通过消去含 $L$ 的项来简化表达式：\n$$Q_S = -W C_{ox} \\left( (V_{GS} - V_{th})L - \\frac{(V_{GS} - V_{th})L}{2} - \\frac{V_{DS}L}{2} + \\frac{V_{DS}L}{3} \\right)$$\n提出因子 $L$ 并合并同类项：\n$$Q_S = -W L C_{ox} \\left[ \\left(1 - \\frac{1}{2}\\right)(V_{GS} - V_{th}) + \\left(-\\frac{1}{2} + \\frac{1}{3}\\right)V_{DS} \\right]$$\n$$Q_S = -W L C_{ox} \\left[ \\frac{1}{2}(V_{GS} - V_{th}) - \\frac{1}{6}V_{DS} \\right]$$\n为了得到公分母，我们可以写成：\n$$Q_S = -W L C_{ox} \\left[ \\frac{3}{6}(V_{GS} - V_{th}) - \\frac{1}{6}V_{DS} \\right] = -\\frac{W L C_{ox}}{6} \\left[ 3(V_{GS} - V_{th}) - V_{DS} \\right]$$\n\n**漏电荷 ($Q_D$) 的计算**\n\n我们使用漏极权重函数 $w_D(x) = \\frac{x}{L}$。$Q_D$ 的积分为：\n$$Q_D = W \\int_{0}^{L} \\left[-C_{ox}\\left(V_{GS} - V_{th} - \\frac{V_{DS}}{L}x\\right)\\right] \\left(\\frac{x}{L}\\right) \\,dx$$\n将常数项提到积分号外：\n$$Q_D = -\\frac{W C_{ox}}{L} \\int_{0}^{L} \\left(V_{GS} - V_{th} - \\frac{V_{DS}}{L}x\\right) x \\,dx$$\n展开积分内的项：\n$$Q_D = -\\frac{W C_{ox}}{L} \\int_{0}^{L} \\left[ (V_{GS} - V_{th})x - \\frac{V_{DS}}{L}x^2 \\right] \\,dx$$\n对 $x$ 从 $0$ 到 $L$ 逐项积分：\n$$Q_D = -\\frac{W C_{ox}}{L} \\left[ (V_{GS} - V_{th})\\frac{x^2}{2} - \\frac{V_{DS}}{L}\\frac{x^3}{3} \\right]_{0}^{L}$$\n在上下限处计算表达式的值：\n$$Q_D = -\\frac{W C_{ox}}{L} \\left( (V_{GS} - V_{th})\\frac{L^2}{2} - \\frac{V_{DS}}{L}\\frac{L^3}{3} \\right)$$\n简化表达式：\n$$Q_D = -\\frac{W C_{ox}}{L} \\left( \\frac{L^2}{2}(V_{GS} - V_{th}) - \\frac{L^2}{3}V_{DS} \\right)$$\n提出因子 $L^2$ 并与前面的项相乘：\n$$Q_D = -W L C_{ox} \\left[ \\frac{1}{2}(V_{GS} - V_{th}) - \\frac{1}{3}V_{DS} \\right]$$\n为了得到公分母，我们可以写成：\n$$Q_D = -W L C_{ox} \\left[ \\frac{3}{6}(V_{GS} - V_{th}) - \\frac{2}{6}V_{DS} \\right] = -\\frac{W L C_{ox}}{6} \\left[ 3(V_{GS} - V_{th}) - 2V_{DS} \\right]$$\n\n推导出的 $Q_S$ 和 $Q_D$ 表达式是在指定的线性区偏置和长沟道近似下，分别分配给源极和漏极端子的准静态电荷。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} Q_S = -\\frac{WLC_{ox}}{6} \\left( 3(V_{GS} - V_{th}) - V_{DS} \\right) \\\\ Q_D = -\\frac{WLC_{ox}}{6} \\left( 3(V_{GS} - V_{th}) - 2V_{DS} \\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了如何计算分配的电荷之后，一个自然的问题是：为什么 Ward-Dutton 方案要采用这种特定的积分形式？本练习  通过将其与一个简化的、固定的分配模型进行对比，揭示了其背后的深刻物理原理——互易性。您将证明，只有 Ward-Dutton 方案能够确保跨电容 $C_{gd}$ 和 $C_{dg}$ 满足物理上必须的互易关系，从而突显其理论上的严谨性。",
            "id": "3781982",
            "problem": "考虑一个长沟道金属氧化物半导体场效应晶体管 (MOSFET)。假设准静态、强反型、渐变沟道近似成立，从而沟道静电势沿沟道从源极到漏极呈线性变化。设沟道坐标为 $x \\in [0, L]$，源极和漏极端电压分别为 $V_{s}$ 和 $V_{d}$，栅极电压为 $V_{g}$。沟道电势为 $V_{\\text{ch}}(x) = V_{s} + \\frac{x}{L}\\left(V_{d} - V_{s}\\right)$。单位面积的氧化层电容为 $C_{\\text{ox}}$，阈值电压为 $V_{\\text{th}}$。单位长度的局部沟道电荷密度由 $q(x) = C_{\\text{ox}}\\left(V_{g} - V_{\\text{th}} - V_{\\text{ch}}(x)\\right)$ 给出。总沟道电荷为 $Q_{\\text{ch}} = \\int_{0}^{L} q(x)\\,\\mathrm{d}x$，栅极电荷为 $Q_{g} = -Q_{\\text{ch}}$。\n\n定义小信号跨导电容为 $C_{ab} = \\frac{\\partial Q_{a}}{\\partial V_{b}}$，其中端点 $a, b \\in \\{g, s, d\\}$，且其他端电压保持不变。对于从能量函数推导出的静电系统，其互易性意味着 $C_{ab} = C_{ba}$。考虑源极和漏极之间的两种电荷分配方案：\n- 一种 ad hoc 方案，使用一个固定比例 $\\alpha \\in (0,1)$ 来分配漏极电荷 $Q_{d}^{\\text{adhoc}} = \\alpha\\,Q_{\\text{ch}}$ 和源极电荷 $Q_{s}^{\\text{adhoc}} = (1 - \\alpha)\\,Q_{\\text{ch}}$。\n- Ward-Dutton 电荷分配方案，其线性权重函数为 $w_{d}(x) = \\frac{x}{L}$ 和 $w_{s}(x) = 1 - \\frac{x}{L}$，因此 $Q_{d}^{\\text{WD}} = \\int_{0}^{L} \\frac{x}{L}\\,q(x)\\,\\mathrm{d}x$ 且 $Q_{s}^{\\text{WD}} = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right)q(x)\\,\\mathrm{d}x$。\n\n从这些定义和所述近似出发，推导两种方案下的栅-漏跨导电容 $C_{gd}$ 和 $C_{dg}$。然后计算 ad hoc 方案中与互易性的偏差，\n$$\\Delta_{gd}^{\\text{adhoc}} = C_{gd}^{\\text{adhoc}} - C_{dg}^{\\text{adhoc}},$$\n并说明 Ward-Dutton 方案对相同的偏差得出什么值。将最终偏差 $\\Delta_{gd}^{\\text{adhoc}}$ 表示为一个以法拉为单位的闭式解析表达式。不需要数值近似。",
            "solution": "该问题要求推导长沟道 MOSFET 中两种不同电荷分配方案的栅-漏跨导电容互易性偏差。我们首先验证问题陈述，然后进行分步推导。\n\n首先，我们解决问题陈述中的一个小歧义。符号 $C_{\\text{ox}}$ 被定义为单位面积的氧化层电容，而单位长度电荷密度 $q(x)$ 的公式在使用它时，其单位暗示为单位长度的电容。设 $C'_{\\text{ox}}$ 为单位面积的电容（单位为 $\\text{F}/\\text{m}^2$）。单位面积的电荷密度为 $q_{\\text{area}}(x) = C'_{\\text{ox}}(V_g - V_{\\text{th}} - V_{\\text{ch}}(x))$。为了获得单位长度的电荷密度 $q(x)$，必须对沟道宽度 $W$ 进行积分。假设宽度恒定，则 $q(x) = W q_{\\text{area}}(x) = W C'_{\\text{ox}}(V_g - V_{\\text{th}} - V_{\\text{ch}}(x))$。在本推导的其余部分，我们将符号 $C_{\\text{ox}}$ 解释为单位长度的电容，即 $C_{\\text{ox}} \\equiv W C'_{\\text{ox}}$，以确保与所给方程的量纲一致性。这是一维器件模型中的常见约定。\n\n我们的第一步是计算总沟道电荷 $Q_{\\text{ch}}$，它作为两种分配方案的基础。单位长度的局部沟道电荷密度由下式给出：\n$$q(x) = C_{\\text{ox}}\\left(V_{g} - V_{\\text{th}} - V_{\\text{ch}}(x)\\right)$$\n采用线性沟道电势近似：\n$$V_{\\text{ch}}(x) = V_{s} + \\frac{x}{L}\\left(V_{d} - V_{s}\\right)$$\n将 $V_{\\text{ch}}(x)$ 代入 $q(x)$ 的表达式：\n$$q(x) = C_{\\text{ox}}\\left[V_{g} - V_{\\text{th}} - \\left(V_{s} + \\frac{x}{L}(V_{d} - V_{s})\\right)\\right] = C_{\\text{ox}}\\left[(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{x}{L}(V_{d} - V_{s})\\right]$$\n总沟道电荷 $Q_{\\text{ch}}$ 是 $q(x)$ 沿沟道长度 $L$ 的积分：\n$$Q_{\\text{ch}} = \\int_{0}^{L} q(x)\\,\\mathrm{d}x = \\int_{0}^{L} C_{\\text{ox}}\\left[(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{x}{L}(V_{d} - V_{s})\\right]\\,\\mathrm{d}x$$\n$$Q_{\\text{ch}} = C_{\\text{ox}}\\left[(V_{g} - V_{\\text{th}} - V_{s})x - \\frac{x^2}{2L}(V_{d} - V_{s})\\right]_{0}^{L}$$\n$$Q_{\\text{ch}} = C_{\\text{ox}}\\left[L(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{L^2}{2L}(V_{d} - V_{s})\\right]$$\n$$Q_{\\text{ch}} = C_{\\text{ox}}L\\left[(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{1}{2}(V_{d} - V_{s})\\right] = C_{\\text{ox}}L\\left[V_{g} - V_{\\text{th}} - \\frac{V_{s} + V_{d}}{2}\\right]$$\n设 $C_{G, \\text{total}} = C_{\\text{ox}}L$ 为总栅极氧化层电容。则：\n$$Q_{\\text{ch}} = C_{G, \\text{total}}\\left(V_{g} - V_{\\text{th}} - \\frac{V_{s} + V_{d}}{2}\\right)$$\n栅极电荷为 $Q_{g} = -Q_{\\text{ch}}$。\n$$Q_{g} = -C_{G, \\text{total}}\\left(V_{g} - V_{\\text{th}} - \\frac{V_{s} + V_{d}}{2}\\right)$$\n跨导电容 $C_{gd}$ 定义为 $C_{gd} = \\frac{\\partial Q_{g}}{\\partial V_{d}}$。注意 $Q_g$ 的表达式与源-漏电荷分配方案无关。\n$$C_{gd} = \\frac{\\partial}{\\partial V_{d}}\\left[-C_{G, \\text{total}}\\left(V_{g} - V_{\\text{th}} - \\frac{V_{s} + V_{d}}{2}\\right)\\right] = -C_{G, \\text{total}}\\left(-\\frac{1}{2}\\right) = \\frac{C_{G, \\text{total}}}{2}$$\n因此，对于两种方案，都有 $C_{gd}^{\\text{adhoc}} = C_{gd}^{\\text{WD}} = \\frac{C_{\\text{ox}}L}{2}$。\n\n接下来，我们分析 ad hoc 分配方案。漏极电荷是总沟道电荷的一个固定比例 $\\alpha$：\n$$Q_{d}^{\\text{adhoc}} = \\alpha Q_{\\text{ch}} = \\alpha C_{G, \\text{total}}\\left(V_{g} - V_{\\text{th}} - \\frac{V_{s} + V_{d}}{2}\\right)$$\n相应的跨导电容 $C_{dg}^{\\text{adhoc}}$ 为：\n$$C_{dg}^{\\text{adhoc}} = \\frac{\\partial Q_{d}^{\\text{adhoc}}}{\\partial V_{g}} = \\frac{\\partial}{\\partial V_{g}}\\left[\\alpha C_{G, \\text{total}}\\left(V_{g} - V_{\\text{th}} - \\frac{V_{s} + V_{d}}{2}\\right)\\right] = \\alpha C_{G, \\text{total}} = \\alpha C_{\\text{ox}}L$$\nad hoc 方案的互易性偏差为：\n$$\\Delta_{gd}^{\\text{adhoc}} = C_{gd}^{\\text{adhoc}} - C_{dg}^{\\text{adhoc}} = \\frac{C_{\\text{ox}}L}{2} - \\alpha C_{\\text{ox}}L = C_{\\text{ox}}L\\left(\\frac{1}{2} - \\alpha\\right)$$\n由于 $\\alpha \\in (0,1)$，除非 $\\alpha = \\frac{1}{2}$，否则该偏差不为零。这表明任意的、固定的分配方案通常会违反互易性条件 $C_{gd} = C_{dg}$。\n\n现在，我们分析 Ward-Dutton 电荷分配方案。漏极电荷由局部沟道电荷密度的加权积分给出：\n$$Q_{d}^{\\text{WD}} = \\int_{0}^{L} w_{d}(x)\\,q(x)\\,\\mathrm{d}x = \\int_{0}^{L} \\frac{x}{L}\\,q(x)\\,\\mathrm{d}x$$\n代入 $q(x)$ 的表达式：\n$$Q_{d}^{\\text{WD}} = \\int_{0}^{L} \\frac{x}{L} C_{\\text{ox}}\\left[(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{x}{L}(V_{d} - V_{s})\\right]\\,\\mathrm{d}x$$\n$$Q_{d}^{\\text{WD}} = \\frac{C_{\\text{ox}}}{L} \\int_{0}^{L} \\left[x(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{x^2}{L}(V_{d} - V_{s})\\right]\\,\\mathrm{d}x$$\n$$Q_{d}^{\\text{WD}} = \\frac{C_{\\text{ox}}}{L}\\left[\\frac{x^2}{2}(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{x^3}{3L}(V_{d} - V_{s})\\right]_{0}^{L}$$\n$$Q_{d}^{\\text{WD}} = \\frac{C_{\\text{ox}}}{L}\\left[\\frac{L^2}{2}(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{L^3}{3L}(V_{d} - V_{s})\\right]$$\n$$Q_{d}^{\\text{WD}} = C_{\\text{ox}}L\\left[\\frac{1}{2}(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{1}{3}(V_{d} - V_{s})\\right]$$\n现在我们通过对 $V_g$ 求 $Q_{d}^{\\text{WD}}$ 的导数来计算跨导电容 $C_{dg}^{\\text{WD}}$：\n$$C_{dg}^{\\text{WD}} = \\frac{\\partial Q_{d}^{\\text{WD}}}{\\partial V_{g}} = \\frac{\\partial}{\\partial V_{g}}\\left[C_{\\text{ox}}L\\left(\\frac{1}{2}(V_{g} - V_{\\text{th}} - V_{s}) - \\frac{1}{3}(V_{d} - V_{s})\\right)\\right]$$\n$$C_{dg}^{\\text{WD}} = C_{\\text{ox}}L\\left(\\frac{1}{2}\\right) = \\frac{C_{\\text{ox}}L}{2}$$\nWard-Dutton 方案的互易性偏差为：\n$$\\Delta_{gd}^{\\text{WD}} = C_{gd}^{\\text{WD}} - C_{dg}^{\\text{WD}} = \\frac{C_{\\text{ox}}L}{2} - \\frac{C_{\\text{ox}}L}{2} = 0$$\n这表明，源于电荷输运物理原理的 Ward-Dutton 方案，保持了栅-漏和漏-栅跨导电容的互易性，这是物理上一致的器件模型的关键要求。\n\n问题要求 ad hoc 方案中偏差 $\\Delta_{gd}^{\\text{adhoc}}$ 的闭式表达式。根据我们的推导，结果是 $C_{\\text{ox}}L\\left(\\frac{1}{2} - \\alpha\\right)$。",
            "answer": "$$\\boxed{C_{\\text{ox}}L\\left(\\frac{1}{2} - \\alpha\\right)}$$"
        },
        {
            "introduction": "理论上的严谨性必须在实践中得到保证。本练习  将理论与计算实践联系起来，探讨在数值环境中实现 Ward-Dutton 模型时面临的挑战。您将学习到，尽管该方案在解析上是电荷守恒的，但数值积分会引入微小误差，并亲手设计一个校正算法来强制执行这一基本的物理定律，这对于构建稳定、精确的电路仿真器至关重要。",
            "id": "3781964",
            "problem": "考虑处于准静态长沟道状态下的金属-氧化物-半导体场效应晶体管 (MOSFET)。Ward-Dutton 电荷分配方案使用沿沟道坐标的线性权重将可动沟道电荷分配到源极和漏极之间，而电荷中性要求所有端电荷的代数和为零。您的任务是实现一个电荷守恒的数值测试，然后设计一个数值上鲁棒的校正方案，以消除由有限精度舍入和离散化引入的微小违背。\n\n基本依据：\n- 根据高斯定律和电荷中性，封闭静电系统中端电荷的代数和为零。在准静态操作下的 MOSFET 中，栅极、源极、漏极和体电荷的代数和必须为零。\n- Ward-Dutton 方案使用沿沟道和为一的线性权重来分配总可动沟道电荷，这在积分时能保持总电荷守恒。\n- 单位长度的可动沟道电荷可以通过电荷片近似，在稳态下使用沿沟道的物理上一致的线性电势分布来获得。\n\n建模假设和定义：\n- 设 $x \\in [0,L]$ 表示沟道坐标，其中 $x = 0$ 是源极端，$x = L$ 是漏极端。设 $W$ 为沟道宽度，$L$ 为沟道长度，单位均为 $\\text{m}$。\n- 将沟道电势定义为 $V(x) = V_{ds} \\, x / L$，其中 $V_{ds}$ 是漏源电压，单位为 $\\text{V}$。\n- 设 $C_{ox}$ 为单位面积的氧化层电容，单位为 $\\text{F} / \\text{m}^2$；设 $C_{dep}$ 为单位面积的有效耗尽层电容，单位为 $\\text{F}/\\text{m}^2$。设 $\\phi_f$ 为费米势，单位为 $\\text{V}$。\n- 设 $V_{gs}$ 为栅源电压，单位为 $\\text{V}$；$V_{th}$ 为阈值电压，单位为 $\\text{V}$。定义过驱动电压为 $V_{ov} = V_{gs} - V_{th}$。\n- 将单位长度的可动沟道电荷定义为\n$$\nq(x) = - C_{ox} \\, W \\, \\max\\left(0,\\, V_{ov} - V(x) \\right),\n$$\n其中负号表示在栅极为正时，电荷为电子电荷。\n- 将总可动沟道电荷定义为\n$$\nQ_{ch} = \\int_{0}^{L} q(x) \\, dx.\n$$\n- Ward-Dutton 源极和漏极的分配电荷为\n$$\nQ_{S} = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right) q(x) \\, dx, \\quad Q_{D} = \\int_{0}^{L} \\left(\\frac{x}{L}\\right) q(x) \\, dx.\n$$\n- 将栅极区域下方的体（衬底）耗尽电荷建模为\n$$\nQ_{dep} = C_{dep} \\, W \\, L \\, \\left(2 \\phi_f\\right),\n$$\n并分配端电荷\n$$\nQ_{G} = -\\left(Q_{ch} + Q_{dep}\\right), \\quad Q_{B} = + Q_{dep}.\n$$\n- 待测试的物理要求是电荷中性：\n$$\nQ_{G} + Q_{S} + Q_{D} + Q_{B} = 0,\n$$\n以 $\\text{C}$ 表示。\n\n数值任务：\n- 使用梯形法则在跨越 $[0,L]$ 的 $N$ 个点的均匀网格上实现数值积分，以计算 $Q_{ch}$、$Q_{S}$ 和 $Q_{D}$。\n- 在进行任何校正之前，计算残差\n$$\nR_{\\text{before}} = Q_{G} + Q_{S} + Q_{D} + Q_{B}\n$$\n单位为 $\\text{C}$。\n- 设计并实现一个校正方案，以消除由数值误差引起的对电荷中性的微小违背：\n    1. 重新归一化 Ward-Dutton 分配的源极和漏极电荷，通过用一个保持其比率的单一因子对 $Q_{S}$ 和 $Q_{D}$ 进行缩放，来精确强制满足 $Q_{S} + Q_{D} = Q_{ch}$。具体而言，如果 $Q_{S} + Q_{D} \\neq 0$，则按 $f = Q_{ch}/(Q_{S} + Q_{D})$ 进行缩放；否则，保持 $Q_{S}$ 和 $Q_{D}$ 不变。\n    2. 完成步骤1后，计算新的残差 $R_{1} = Q_{G} + Q_{S} + Q_{D} + Q_{B}$。仅对栅极电荷应用最终校正：设置 $Q_{G} \\leftarrow Q_{G} - R_{1}$，使得校正后的残差 $R_{\\text{after}} = Q_{G} + Q_{S} + Q_{D} + Q_{B} \\approx 0$（在浮点舍入误差范围内）。\n- 使用 $\\epsilon = 1 \\times 10^{-26}$ in $\\text{C}$ 的容差来评估成功：如果 $\\left| R_{\\text{after}} \\right| \\le \\epsilon$，则宣布测试成功。\n\n物理单位：\n- 所有电荷 $Q_{G}$、$Q_{S}$、$Q_{D}$、$Q_{B}$ 和残差 $R_{\\text{before}}$ 与 $R_{\\text{after}}$ 都必须以 $\\text{C}$ 计算和报告。\n\n测试套件：\n- 使用以下五个测试用例，每个用例由 $(W, L, C_{ox}, C_{dep}, \\phi_f, V_{gs}, V_{th}, V_{ds}, N)$ 指定：\n    1. 正常路径，中等反型和中等漏极偏压：\n       $(W = 1 \\times 10^{-6} \\,\\text{m},\\, L = 1 \\times 10^{-6} \\,\\text{m},\\, C_{ox} = 1 \\times 10^{-2} \\,\\text{F}/\\text{m}^{2},\\, C_{dep} = 2 \\times 10^{-3} \\,\\text{F}/\\text{m}^{2},\\, \\phi_f = 3 \\times 10^{-1} \\,\\text{V},\\, V_{gs} = 9 \\times 10^{-1} \\,\\text{V},\\, V_{th} = 6 \\times 10^{-1} \\,\\text{V},\\, V_{ds} = 2 \\times 10^{-1} \\,\\text{V},\\, N = 1001)$。\n    2. 漏极附近发生夹断，较大漏极偏压：\n       $(W = 1 \\times 10^{-6} \\,\\text{m},\\, L = 1 \\times 10^{-6} \\,\\text{m},\\, C_{ox} = 1 \\times 10^{-2} \\,\\text{F}/\\text{m}^{2},\\, C_{dep} = 2 \\times 10^{-3} \\,\\text{F}/\\text{m}^{2},\\, \\phi_f = 3 \\times 10^{-1} \\,\\text{V},\\, V_{gs} = 9 \\times 10^{-1} \\,\\text{V},\\, V_{th} = 6 \\times 10^{-1} \\,\\text{V},\\, V_{ds} = 5 \\times 10^{-1} \\,\\text{V},\\, N = 257)$。\n    3. 接近截止区，可动沟道电荷消失：\n       $(W = 1 \\times 10^{-6} \\,\\text{m},\\, L = 1 \\times 10^{-6} \\,\\text{m},\\, C_{ox} = 1 \\times 10^{-2} \\,\\text{F}/\\text{m}^{2},\\, C_{dep} = 2 \\times 10^{-3} \\,\\text{F}/\\text{m}^{2},\\, \\phi_f = 3 \\times 10^{-1} \\,\\text{V},\\, V_{gs} = 5.5 \\times 10^{-1} \\,\\text{V},\\, V_{th} = 6 \\times 10^{-1} \\,\\text{V},\\, V_{ds} = 2 \\times 10^{-1} \\,\\text{V},\\, N = 17)$。\n    4. 零漏极偏压对称性：\n       $(W = 1 \\times 10^{-6} \\,\\text{m},\\, L = 1 \\times 10^{-6} \\,\\text{m},\\, C_{ox} = 1 \\times 10^{-2} \\,\\text{F}/\\text{m}^{2},\\, C_{dep} = 2 \\times 10^{-3} \\,\\text{F}/\\text{m}^{2},\\, \\phi_f = 3 \\times 10^{-1} \\,\\text{V},\\, V_{gs} = 9 \\times 10^{-1} \\,\\text{V},\\, V_{th} = 6 \\times 10^{-1} \\,\\text{V},\\, V_{ds} = 0 \\,\\text{V},\\, N = 3)$。\n    5. 微小几何尺寸，绝对电荷值小：\n       $(W = 1 \\times 10^{-9} \\,\\text{m},\\, L = 1 \\times 10^{-9} \\,\\text{m},\\, C_{ox} = 1 \\times 10^{-2} \\,\\text{F}/\\text{m}^{2},\\, C_{dep} = 2 \\times 10^{-3} \\,\\text{F}/\\text{m}^{2},\\, \\phi_f = 3 \\times 10^{-1} \\,\\text{V},\\, V_{gs} = 9 \\times 10^{-1} \\,\\text{V},\\, V_{th} = 6 \\times 10^{-1} \\,\\text{V},\\, V_{ds} = 2 \\times 10^{-1} \\,\\text{V},\\, N = 5)$。\n\n程序输出规范：\n- 对于每个测试用例，计算并返回一个包含三个条目的列表：$[\\, |R_{\\text{before}}|,\\, |R_{\\text{after}}|,\\, \\text{pass\\_after} \\,]$，其中 $|R_{\\text{before}}|$ 和 $|R_{\\text{after}}|$ 是以 $\\text{C}$ 为单位的实数，$\\text{pass\\_after}$ 是一个布尔值，指示是否满足 $\\left| R_{\\text{after}} \\right|\\le \\epsilon$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个元素是对应一个测试用例的列表，例如\n$$\n[ [r_{b1}, r_{a1}, \\text{True}], [r_{b2}, r_{a2}, \\text{False}], \\ldots ].\n$$",
            "solution": "所提供的问题是计算物理和数值方法领域中的一个有效练习，特别是在半导体器件建模领域。它科学地基于 MOSFET 操作和静电学原理，问题提法适定，提供了所有必要信息，并且表述客观。任务是实现对 Ward-Dutton 电荷分配方案的数值测试，并应用一个已定义的校正算法来强制实现电荷守恒，而电荷守恒可能会因数值积分误差而被违背。\n\n被测试的基本物理原理是电荷中性。对于一个孤立的四端 MOSFET，栅极 ($Q_G$)、源极 ($Q_S$)、漏极 ($Q_D$) 和体 ($Q_B$) 端电荷的代数和必须为零：\n$$\nQ_{G} + Q_{S} + Q_{D} + Q_{B} = 0\n$$\n该问题定义了一个简化的长沟道 MOSFET 模型，其中端电荷是相互关联的。体电荷 $Q_B$ 被建模为存储在耗尽区中的电荷，$Q_B = Q_{dep}$，其中 $Q_{dep} = C_{dep} \\, W \\, L \\, (2 \\phi_f)$。根据电荷感应原理，栅极电荷 $Q_G$ 必须与它下方的总电荷大小相等、符号相反，总电荷包括可动沟道电荷 $Q_{ch}$ 和固定的耗尽电荷 $Q_{dep}$。因此，$Q_{G} = -(Q_{ch} + Q_{dep})$。将这些定义代入电荷中性方程，得到：\n$$\n-(Q_{ch} + Q_{dep}) + Q_S + Q_D + Q_{dep} = 0\n$$\n$$\nQ_S + Q_D - Q_{ch} = 0 \\implies Q_S + Q_D = Q_{ch}\n$$\n这表明，整个器件的电荷中性条件得到满足，当且仅当分配的源极和漏极电荷之和等于总可动沟道电荷。\n\nWard-Dutton 方案将分配的电荷 $Q_S$ 和 $Q_D$ 定义为单位长度可动电荷密度 $q(x)$ 的加权积分：\n$$\nQ_{S} = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right) q(x) \\, dx, \\quad Q_{D} = \\int_{0}^{L} \\left(\\frac{x}{L}\\right) q(x) \\, dx\n$$\n解析上，这些分配电荷之和精确等于总沟道电荷 $Q_{ch}$：\n$$\nQ_S + Q_D = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right) q(x) \\, dx + \\int_{0}^{L} \\left(\\frac{x}{L}\\right) q(x) \\, dx = \\int_{0}^{L} \\left[\\left(1 - \\frac{x}{L}\\right) + \\frac{x}{L}\\right] q(x) \\, dx = \\int_{0}^{L} q(x) \\, dx = Q_{ch}\n$$\n然而，当这三个不同的积分被数值计算时（例如使用梯形法则），会引入小的近似误差。这导致数值计算出的电荷（用上标 'num' 表示）并不完全满足守恒定律：$Q_S^{\\text{num}} + Q_D^{\\text{num}} \\neq Q_{ch}^{\\text{num}}$。本练习的目的是量化此数值误差，然后通过算法对其进行校正。\n\n求解过程首先实现数值模型。在沟道长度 $L$ 上（从 $x=0$ 到 $x=L$）建立一个包含 $N$ 个点的均匀网格。在每个网格点 $x_i$ 处，计算局部电势 $V(x_i) = V_{ds} \\, x_i / L$ 和局部可动电荷密度 $q(x_i) = -C_{ox}W \\max(0, V_{gs} - V_{th} - V(x_i))$。\n\n然后使用梯形法则在该网格上计算 $Q_{ch}$、$Q_S$ 和 $Q_D$ 的积分。\n$$\nQ_{ch}^{\\text{num}} = \\text{trapz}(q(x_i), x_i)\n$$\n$$\nQ_{S}^{\\text{num}} = \\text{trapz}\\left(\\left(1 - \\frac{x_i}{L}\\right) q(x_i), x_i\\right)\n$$\n$$\nQ_{D}^{\\text{num}} = \\text{trapz}\\left(\\left(\\frac{x_i}{L}\\right) q(x_i), x_i\\right)\n$$\n利用这些数值获得的值，计算端电荷：$Q_{dep}$ 根据其公式计算，$Q_B = Q_{dep}$，以及 $Q_G = -(Q_{ch}^{\\text{num}} + Q_{dep})$。然后求得初始残差 $R_{\\text{before}}$：\n$$\nR_{\\text{before}} = Q_G + Q_S^{\\text{num}} + Q_D^{\\text{num}} + Q_B = \\left(Q_S^{\\text{num}} + Q_D^{\\text{num}}\\right) - Q_{ch}^{\\text{num}}\n$$\n该残差是电荷分配中数值误差的直接度量。\n\n校正方案分两步应用。\n首先，将分配的电荷 $Q_S^{\\text{num}}$ 和 $Q_D^{\\text{num}}$ 重新归一化，以强制满足条件 $Q_S + Q_D = Q_{ch}$。计算一个缩放因子 $f$，即期望和与实际数值和的比率：\n$$\nf = \\frac{Q_{ch}^{\\text{num}}}{Q_S^{\\text{num}} + Q_D^{\\text{num}}}\n$$\n仅当分母非零时才执行此缩放。校正后的电荷为 $Q_{S,1} = f \\cdot Q_S^{\\text{num}}$ 和 $Q_{D,1} = f \\cdot Q_D^{\\text{num}}$。根据构造，在浮点精度范围内，$Q_{S,1} + Q_{D,1} = Q_{ch}^{\\text{num}}$。\n\n其次，对栅极电荷应用最终校正，以吸收任何剩余的浮点舍入误差。使用重新归一化后的源/漏电荷计算一个中间残差 $R_1$：\n$$\nR_1 = Q_G + Q_{S,1} + Q_{D,1} + Q_B\n$$\n解析上，这个 $R_1$ 应该为零，但由于浮点运算的顺序，数值上它可能是一个非常小的非零值。调整栅极电荷以抵消这个微小的残差：$Q_{G, \\text{final}} = Q_G - R_1$。\n\n用所有校正后的电荷计算出的最终残差 $R_{\\text{after}}$，在机器精度范围内将为零：\n$$\nR_{\\text{after}} = Q_{G, \\text{final}} + Q_{S,1} + Q_{D,1} + Q_B = (Q_G - R_1) + Q_{S,1} + Q_{D,1} + Q_B = R_1 - R_1 = 0\n$$\n然后将此最终残差的绝对值与容差 $\\epsilon = 1 \\times 10^{-26}\\,\\text{C}$ 进行比较，以宣布校正成功。这一全面的过程确保了数值计算出的电荷遵守电荷守恒这一基本物理定律，这是稳定和精确电路仿真的关键要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the MOSFET charge conservation problem for a given set of test cases.\n    \"\"\"\n    \n    # Test cases: (W, L, C_ox, C_dep, phi_f, V_gs, V_th, V_ds, N)\n    test_cases = [\n        # 1. Happy path, moderate inversion and moderate drain bias\n        (1e-6, 1e-6, 1e-2, 2e-3, 0.3, 0.9, 0.6, 0.2, 1001),\n        # 2. Pinch-off near the drain, larger drain bias\n        (1e-6, 1e-6, 1e-2, 2e-3, 0.3, 0.9, 0.6, 0.5, 257),\n        # 3. Near cutoff, mobile channel charge vanishes\n        (1e-6, 1e-6, 1e-2, 2e-3, 0.3, 0.55, 0.6, 0.2, 17),\n        # 4. Zero drain bias symmetry\n        (1e-6, 1e-6, 1e-2, 2e-3, 0.3, 0.9, 0.6, 0.0, 3),\n        # 5. Tiny geometry, small absolute charges\n        (1e-9, 1e-9, 1e-2, 2e-3, 0.3, 0.9, 0.6, 0.2, 5),\n    ]\n\n    epsilon = 1e-26  # Tolerance in Coulombs\n    results = []\n\n    for case in test_cases:\n        W, L, C_ox, C_dep, phi_f, V_gs, V_th, V_ds, N = case\n\n        # Overdrive voltage\n        V_ov = V_gs - V_th\n\n        # Create uniform spatial grid along the channel\n        x = np.linspace(0, L, N)\n\n        # Channel potential profile V(x)\n        # Avoid division by zero if L is zero, though not in test cases\n        V_x = V_ds * x / L if L != 0 else np.zeros_like(x)\n\n        # Mobile channel charge per unit length q(x)\n        # np.maximum handles the max(0, ...) operation element-wise\n        q_x = -C_ox * W * np.maximum(0, V_ov - V_x)\n\n        # Numerically integrate using the trapezoidal rule\n        # np.trapz(y, x) performs the integration\n        Q_ch_num = np.trapz(q_x, x)\n        \n        # Integrands for Ward-Dutton partitioning\n        source_integrand = (1 - x / L) * q_x if L != 0 else q_x\n        drain_integrand = (x / L) * q_x if L != 0 else np.zeros_like(x)\n        \n        Q_S_num = np.trapz(source_integrand, x)\n        Q_D_num = np.trapz(drain_integrand, x)\n        \n        # Calculate other terminal charges based on the numerical results\n        Q_dep_val = C_dep * W * L * (2 * phi_f)\n        Q_B = Q_dep_val\n        Q_G = -(Q_ch_num + Q_dep_val)\n        \n        # Compute the residual before correction\n        R_before = Q_G + Q_S_num + Q_D_num + Q_B\n        \n        # --- Correction Scheme ---\n        \n        # Step 1: Renormalize source and drain charges\n        Q_S_corrected = Q_S_num\n        Q_D_corrected = Q_D_num\n        \n        sum_QS_QD = Q_S_num + Q_D_num\n\n        # Avoid division by zero if total partitioned charge is zero (e.g., in cutoff)\n        if sum_QS_QD != 0:\n            f = Q_ch_num / sum_QS_QD\n            Q_S_corrected *= f\n            Q_D_corrected *= f\n\n        # Step 2: Correct gate charge\n        # Compute intermediate residual with corrected S/D charges\n        R_1 = Q_G + Q_S_corrected + Q_D_corrected + Q_B\n        \n        # Apply final correction to gate charge\n        Q_G_corrected = Q_G - R_1\n        \n        # Compute final residual after all corrections\n        R_after = Q_G_corrected + Q_S_corrected + Q_D_corrected + Q_B\n\n        # Check if the final residual is within tolerance\n        pass_after = abs(R_after) = epsilon\n        \n        # Append results for this case\n        results.append([abs(R_before), abs(R_after), pass_after])\n\n    # Final print statement in the exact required format.\n    # The str() call on each list correctly formats it with spaces, e.g., '[0.1, 0.0, True]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}