{
    "hands_on_practices": [
        {
            "introduction": "在任何技术计算机辅助设计（TCAD）仿真中，精确的边界条件都是求解偏微分方程组的必要前提。本练习将聚焦于TCAD的“主力军”——漂移-扩散模型，并探讨如何确定理想欧姆接触处的载流子浓度 。通过此实践，你将巩固对准费米能级、电荷中性和平衡态边界条件的理解，这是正确设置和解读经典器件仿真的关键一步。",
            "id": "3756648",
            "problem": "考虑一个在温度 $T=500\\,\\mathrm{K}$ 下对长沟道硅n沟道金属-氧化物-半导体场效应晶体管进行的二维技术计算机辅助设计 (TCAD) 漂移-扩散模型仿真。该器件在源极和漏极使用理想欧姆接触，并有一个理想栅极，施加的端点偏压为 $V_{GS}=0.7\\,\\mathrm{V}$、$V_{DS}=0.5\\,\\mathrm{V}$，源极电位为 $0\\,\\mathrm{V}$。源区为均匀n型掺杂，施主浓度为 $N_{D}=1.0\\times 10^{15}\\,\\mathrm{cm}^{-3}$ 且完全电离，受主浓度可忽略不计。接触点位于源区深处，该处的半导体可被假设为准中性。忽略带隙变窄效应和任何简并效应（假设为非简并的麦克斯韦-玻尔兹曼统计）。在此温度下，硅的本征载流子浓度为 $n_{i}=2.2\\times 10^{14}\\,\\mathrm{cm}^{-3}$。\n\n从包含泊松方程以及电子和空穴准费米势定义的漂移-扩散框架出发，分析源极处准中性欧姆接触边界条件的作用。仅使用载流子浓度、本征能级和准费米能级之间的基本关系以及局部电中性条件，确定源极欧姆接触处的电子浓度。在这些边界条件下，请明确论证端点偏压 $V_{GS}$ 和 $V_{DS}$ 是否会影响接触点局部浓度的计算。\n\n计算电子浓度的数值，并将答案四舍五入到四位有效数字。最终浓度以 $\\mathrm{cm}^{-3}$ 为单位表示。",
            "solution": "该问题被验证为具有科学依据、提法得当且客观。它基于半导体器件的标准漂移-扩散模型，并提供了一套完整且一致的参数，用于在指定条件下确定理想欧姆接触处的电子浓度。\n\n目标是求出硅n-MOSFET源极欧姆接触处的电子浓度 $n$。问题陈述该接触是理想的，且位于源区深处，在该区域半导体是准中性的。\n\n在非简并半导体中，电子 ($n$) 和空穴 ($p$) 浓度的基本关系由本征载流子浓度 $n_i$、静电势 $\\psi$ 以及电子和空穴的准费米势 $\\phi_n$ 和 $\\phi_p$ 分别给出。\n$$n = n_i \\exp\\left(\\frac{q(\\psi - \\phi_n)}{k_B T}\\right)$$\n$$p = n_i \\exp\\left(\\frac{q(\\phi_p - \\psi)}{k_B T}\\right)$$\n此处，$q$ 是元电荷，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n理想欧姆接触作为一个无限的载流子库，在边界处强制实现局部热平衡。在热平衡状态下，电子和空穴的准费米势相等，并且它们被钉扎在接触点所连接的端点的电势上。对于源极接触，这意味着：\n$$\\phi_n = \\phi_p = V_S$$\n问题指定源极电位为 $0\\,\\mathrm{V}$，因此 $V_S = 0\\,\\mathrm{V}$。所以，在源极接触处，$\\phi_n = \\phi_p = 0\\,\\mathrm{V}$。\n\n在此平衡条件下，可以求出电子和空穴浓度的乘积：\n$$np = \\left(n_i \\exp\\left(\\frac{q(\\psi - \\phi_n)}{k_B T}\\right)\\right) \\left(n_i \\exp\\left(\\frac{q(\\phi_p - \\psi)}{k_B T}\\right)\\right) = n_i^2 \\exp\\left(\\frac{q(\\phi_p - \\phi_n)}{k_B T}\\right)$$\n当 $\\phi_n = \\phi_p$ 时，指数项变为 $\\exp(0) = 1$，该关系式简化为热平衡下的质量作用定律：\n$$np = n_i^2$$\n\n为接触区指定的第二个条件是局部电中性。电荷密度 $\\rho$ 是来自可移动载流子（空穴和电子）和固定的电离掺杂物（施主 $N_D^+$ 和受主 $N_A^-$）的电荷总和。\n$$\\rho = q(p - n + N_D^+ - N_A^-)$$\n电中性条件要求 $\\rho = 0$。\n$$p - n + N_D^+ - N_A^- = 0$$\n问题指出源区掺杂有完全电离的施主，因此 $N_D^+ = N_D = 1.0 \\times 10^{15}\\,\\mathrm{cm}^{-3}$，并且受主可忽略不计，因此 $N_A^- \\approx 0$。于是电中性方程变为：\n$$p - n + N_D = 0 \\quad \\implies \\quad n - p = N_D$$\n\n我们现在得到一个关于两个未知浓度 $n$ 和 $p$ 的方程组：\n1. $n - p = N_D$\n2. $np = n_i^2$\n\n我们可以解此方程组求 $n$。从第一个方程，我们用 $n$ 表示 $p$：$p = n - N_D$。将此代入第二个方程得到：\n$$n(n - N_D) = n_i^2$$\n这可以重排为一个关于电子浓度 $n$ 的二次方程：\n$$n^2 - N_D n - n_i^2 = 0$$\n我们使用二次方程求根公式 $n = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来解此方程，其中 $a=1$，$b=-N_D$，$c=-n_i^2$：\n$$n = \\frac{N_D \\pm \\sqrt{(-N_D)^2 - 4(1)(-n_i^2)}}{2} = \\frac{N_D \\pm \\sqrt{N_D^2 + 4n_i^2}}{2}$$\n由于电子浓度 $n$ 必须是一个正的物理量，我们必须选择正根，因为 $\\sqrt{N_D^2 + 4n_i^2}  \\sqrt{N_D^2} = N_D$。\n$$n = \\frac{N_D + \\sqrt{N_D^2 + 4n_i^2}}{2} = \\frac{N_D}{2} + \\sqrt{\\left(\\frac{N_D}{2}\\right)^2 + n_i^2}$$\n\n这个关于 $n$ 的表达式仅取决于施主浓度 $N_D$ 和本征载流子浓度 $n_i$（其本身是温度 $T$ 的函数）。端点偏压 $V_{GS}$ 和 $V_{DS}$ 没有出现在这个方程中。这是因为该计算是针对理想源极接触*处*的边界条件，该接触点被假设处于局部热平衡状态。偏压 $V_{GS}=0.7\\,\\mathrm{V}$ 和 $V_{DS}=0.5\\,\\mathrm{V}$ 在器件的有源区（例如，沟道和漏区）内建立静电势和准费米能级的分裂，使其脱离平衡状态。然而，它们并不会改变源极接触点本身平衡边界条件的定义。因此，$V_{GS}$ 和 $V_{DS}$ 与计算源极接触处局部电子浓度无关。\n\n现在我们可以使用给定的数据计算 $n$ 的数值：\n$N_D = 1.0 \\times 10^{15}\\,\\mathrm{cm}^{-3}$\n$n_i = 2.2 \\times 10^{14}\\,\\mathrm{cm}^{-3}$ (在 $T=500\\,\\mathrm{K}$)\n\n将这些值代入推导出的公式：\n$$n = \\frac{1.0 \\times 10^{15}}{2} + \\sqrt{\\left(\\frac{1.0 \\times 10^{15}}{2}\\right)^2 + \\left(2.2 \\times 10^{14}\\right)^2}$$\n$$n = 0.5 \\times 10^{15} + \\sqrt{\\left(0.5 \\times 10^{15}\\right)^2 + \\left(0.22 \\times 10^{15}\\right)^2}$$\n$$n = \\left[0.5 + \\sqrt{(0.5)^2 + (0.22)^2}\\right] \\times 10^{15}$$\n$$n = \\left[0.5 + \\sqrt{0.25 + 0.0484}\\right] \\times 10^{15}$$\n$$n = \\left[0.5 + \\sqrt{0.2984}\\right] \\times 10^{15}$$\n$$n \\approx [0.5 + 0.54626002] \\times 10^{15}$$\n$$n \\approx 1.04626002 \\times 10^{15}\\,\\mathrm{cm}^{-3}$$\n按要求将结果四舍五入到四位有效数字：\n$$n \\approx 1.046 \\times 10^{15}\\,\\mathrm{cm}^{-3}$$",
            "answer": "$$\\boxed{1.046 \\times 10^{15}}$$"
        },
        {
            "introduction": "随着器件尺寸进入纳米尺度，经典模型逐渐失效，量子效应开始主导器件行为。本练习将引导你从第一性原理出发，推导弹道输运中的基本物理量——电导量子 。这一推导是理解Landauer-Büttiker形式论的基石，它为我们揭示了在极限尺寸的纳米器件中电流的流动方式，是连接经典与量子输运理论的桥梁。",
            "id": "3756678",
            "problem": "考虑一个弹道一维纳米线通道，在工艺计算机辅助设计（TCAD）建模假设下，连接到大的平衡库。源极和漏极库由费米函数 $f_{L}(E)$ 和 $f_{R}(E)$ 表征，其电化学势分别为 $\\mu_{L}$ 和 $\\mu_{R}$，并且纳米线在费米能级支持 $M$ 个横向模式。假设存在自旋简并，并且所有占据模式的透射率均为单位1。所施加的偏压是小且对称的，因此 $\\mu_{L} - \\mu_{R} = q V$，其中 $|V|$ 足够小以满足线性响应的条件。温度是有限但任意的。\n\n从基本定义（费米-狄拉克分布、群速度 $v(E)$ 和每个模式的一维态密度 $D(E)$）出发，并且不引用任何现成的输运公式，推导出在线性响应下净电流 $I$ 关于 $q$、$h$、$M$ 和 $V$ 的表达式，并由此获得每个完全透射、自旋简并模式的电导（电导量子）$G_{0}$。然后，使用2019年国际单位制（SI）常数的精确重新定义值 $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$ 和 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}$ 来计算 $G_{0}$ 的数值。\n\n最后，对于一个具有 $M = 3$ 个占据模式、在 $V = 10\\ \\mathrm{mV}$ 偏压下的纳米线，使用您推导的表达式来预测小偏压电流。将您的数值结果四舍五入到六位有效数字。电导以微西门子表示，电流以微安表示。最终答案必须是包含这两个数字的单个对象，按 $(G_{0}, I)$ 的顺序列出。",
            "solution": "首先，对问题陈述进行验证。\n\n步骤1：提取给定条件\n- 导体：弹道一维纳米线通道。\n- 建模背景：工艺计算机辅助设计 (TCAD)。\n- 接触：两个大的平衡库（源和漏）。\n- 库的属性：由费米函数 $f_{L}(E)$ 和 $f_{R}(E)$ 表征，其电化学势分别为 $\\mu_{L}$ 和 $\\mu_{R}$。\n- 纳米线属性：在费米能级支持 $M$ 个横向模式；存在自旋简并；所有占据模式的透射率为单位1。\n- 偏压条件：小且对称，因此 $\\mu_{L} - \\mu_{R} = q V$ 且 $|V|$ 足够小以满足线性响应。\n- 温度：有限但任意。\n- 任务1：从基本定义出发，推导在线性响应下净电流 $I$ 关于 $q$、$h$、$M$ 和 $V$ 的表达式。\n- 任务2：获得每个完全透射、自旋简并模式的电导 $G_{0}$。\n- 任务3：使用 $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$ 和 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}$ 计算 $G_0$ 的数值。\n- 任务4：对于一个具有 $M = 3$、在 $V = 10\\ \\mathrm{mV}$ 偏压下的纳米线，预测小偏压电流 $I$。\n- 任务5：将数值结果四舍五入到六位有效数字，电导以微西门子（$\\mu\\mathrm{S}$）表示，电流以微安（$\\mu\\mathrm{A}$）表示。最终答案应为单个对象 $(G_{0}, I)$。\n\n步骤2：使用提取的给定条件进行验证\n-   **科学基础**：该问题是介观物理学中的一个经典练习，将 Landauer-Büttiker 形式理论应用于一维弹道导体。费米-狄拉克统计、态密度、群速度和线性响应等概念是凝聚态物理和纳米电子学中的基本原理。该设置是量子输运的一个标准、经实验验证的模型。\n-   **良态问题**：问题定义明确。它提供了一套清晰的假设，并要求进行逐步推导，以得出特定的解析和数值结果。存在一个唯一的、稳定的、有意义的解。\n-   **客观性**：问题以精确的技术语言陈述，没有主观或含糊的术语。\n问题没有列出的缺陷。它在科学上是合理的、良态的、客观的、完整的，并且与指定领域相关。它需要实质性的推理，而不是微不足道或同义反复的。\n\n步骤3：结论和行动\n问题是有效的。将按要求推导解答。\n\n流过纳米线的净电流 $I$ 是从左侧库流向右侧的电流 $I_{L \\to R}$ 与从右侧库流向左侧的电流 $I_{R \\to L}$ 之间的差值。\n电流由电荷载流子的流动决定。能量区间 $dE$ 内的载流子数量是可用态密度与它们被占据概率的乘积。对于一维系统，单位长度上单个自旋通道和单个运动方向（例如，向右运动）的态密度（DOS）由 $D_{1D,\\rightarrow}(E) = D_{1D,\\rightarrow}(k) \\frac{dk}{dE}$ 给出。$k$空间中的态密度是 $D_{1D,\\rightarrow}(k) = \\frac{1}{2\\pi}$。群速度是 $v(E) = \\frac{1}{\\hbar}\\frac{dE}{dk}$，这意味着 $\\frac{dk}{dE} = \\frac{\\hbar}{v(E)}$。将这些结合起来，能量分辨的态密度是 $D_{1D,\\rightarrow}(E) = \\frac{1}{2\\pi} \\frac{\\hbar}{v(E)} = \\frac{1}{h v(E)}$，其中 $h = 2\\pi\\hbar$ 是普朗克常数。\n\n来自左侧库、在单个模式中单个自旋通道的电流贡献，是通过对电荷 $q$ 乘以载流子速度 $v(E)$ 再乘以占据态的分布进行积分得到的：\n$$dI_{L \\to R}^{\\text{spin}} = q \\cdot v(E) \\cdot D_{1D,\\rightarrow}(E) \\cdot f_L(E) dE$$\n这里，$f_L(E)$ 是左侧库的费米-狄拉克分布，它决定了态的占据情况。代入一维态密度的表达式，我们观察到一个关键的抵消：\n$$dI_{L \\to R}^{\\text{spin}} = q \\cdot v(E) \\cdot \\left(\\frac{1}{h v(E)}\\right) \\cdot f_L(E) dE = \\frac{q}{h} f_L(E) dE$$\n这个显著的结果表明，每个通道的电流贡献与编码在 $v(E)$ 中的材料特定能带结构无关。\n\n问题指明了自旋简并，因此每个模式有两个自旋通道。它还指出有 $M$ 个横向模式，每个模式的透射率都为1。因此，从左到右的总电流是：\n$$I_{L \\to R} = M \\cdot 2 \\cdot \\int_0^\\infty \\frac{q}{h} f_L(E) dE = \\frac{2qM}{h} \\int_0^\\infty f_L(E) dE$$\n类似地，从右到左的电流由右侧库填充：\n$$I_{R \\to L} = \\frac{2qM}{h} \\int_0^\\infty f_R(E) dE$$\n净电流 $I$ 是差值：\n$$I = I_{L \\to R} - I_{R \\to L} = \\frac{2qM}{h} \\int_0^\\infty [f_L(E) - f_R(E)] dE$$\n费米函数是 $f_L(E) = f(E-\\mu_L)$ 和 $f_R(E) = f(E-\\mu_R)$，其中 $f(x) = (1 + \\exp(x/k_B T))^{-1}$。给定外加偏压 $V$ 是小且对称的，有 $\\mu_L - \\mu_R = qV$。我们定义平衡费米能级为 $\\mu_0 = (\\mu_L + \\mu_R)/2$，这给出 $\\mu_L = \\mu_0 + qV/2$ 和 $\\mu_R = \\mu_0 - qV/2$。\n\n对于小偏压，我们可以使用费米函数 $f(E-\\mu)$ 关于化学势 $\\mu$ 在 $\\mu_0$ 附近的一阶泰勒展开来近似差值 $f_L(E) - f_R(E)$：\n$$f(E-\\mu) \\approx f(E-\\mu_0) + (\\mu - \\mu_0) \\frac{\\partial f(E-\\mu)}{\\partial \\mu}\\bigg|_{\\mu=\\mu_0}$$\n使用恒等式 $\\frac{\\partial f(E-\\mu)}{\\partial \\mu} = -\\frac{\\partial f(E-\\mu)}{\\partial E}$：\n$$f(E-\\mu) \\approx f(E-\\mu_0) - (\\mu - \\mu_0) \\frac{\\partial f(E-\\mu)}{\\partial E}\\bigg|_{\\mu=\\mu_0}$$\n将此应用于 $\\mu_L$ 和 $\\mu_R$：\n$$f_L(E) \\approx f(E-\\mu_0) - (\\mu_L - \\mu_0)\\frac{\\partial f}{\\partial E} = f(E-\\mu_0) - \\frac{qV}{2}\\frac{\\partial f}{\\partial E}$$\n$$f_R(E) \\approx f(E-\\mu_0) - (\\mu_R - \\mu_0)\\frac{\\partial f}{\\partial E} = f(E-\\mu_0) + \\frac{qV}{2}\\frac{\\partial f}{\\partial E}$$\n差值为：\n$$f_L(E) - f_R(E) \\approx -qV \\frac{\\partial f(E-\\mu_0)}{\\partial E}$$\n将此代回电流的积分中：\n$$I \\approx \\frac{2qM}{h} \\int_0^\\infty \\left(-qV \\frac{\\partial f}{\\partial E}\\right) dE = \\frac{2q^2MV}{h} \\int_0^\\infty \\left(-\\frac{\\partial f}{\\partial E}\\right) dE$$\n项 $-\\frac{\\partial f}{\\partial E}$ 是一个在 $E=\\mu_0$ 附近急剧峰值的函数，通常称为“费米窗口”。该函数在所有能量上的积分是单位1：\n$$\\int_{-\\infty}^\\infty \\left(-\\frac{\\partial f}{\\partial E}\\right) dE = [-f(E)]_{-\\infty}^\\infty = -f(\\infty) - (-f(-\\infty)) = 0 - (-1) = 1$$\n由于问题陈述 $M$ 个模式在费米能级得到支持，我们可以假设这些模式的能带边缘远低于 $\\mu_0$，因此从 $0$ 到 $\\infty$ 的积分捕捉了整个峰值。因此，$\\int_0^\\infty (-\\partial f/\\partial E) dE \\approx 1$。\n在线性响应区，净电流的表达式为：\n$$I = \\frac{2q^2M}{h} V$$\n电导 $G$ 是 $I/V$，所以 $G = \\frac{2q^2M}{h}$。\n\n通过设置 $M=1$ 可以找到每个完全透射、自旋简并模式的电导。这就是电导量子 $G_0$：\n$$G_0 = \\frac{2q^2}{h}$$\n\n现在，我们计算 $G_0$ 的数值。使用提供的 SI 值：\n$q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n$h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}$\n$$G_0 = \\frac{2 \\times (1.602176634 \\times 10^{-19}\\ \\mathrm{C})^{2}}{6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}} = \\frac{2 \\times 2.566970081... \\times 10^{-38}\\ \\mathrm{C}^2}{6.62607015 \\times 10^{-34}\\ \\mathrm{J \\cdot s}}$$\n$$G_0 = 7.748091729... \\times 10^{-5}\\ \\mathrm{A/V} = 7.748091729... \\times 10^{-5}\\ \\mathrm{S}$$\n以微西门子（$\\mu\\mathrm{S}$）表示并四舍五入到六位有效数字：\n$$G_0 = 77.4809\\ \\mu\\mathrm{S}$$\n\n最后，对于一个具有 $M=3$ 个模式，在 $V = 10\\ \\mathrm{mV} = 1.0 \\times 10^{-2}\\ \\mathrm{V}$ 偏压下的纳米线，电流为：\n$$I = M \\cdot G_0 \\cdot V = 3 \\times (7.748091729... \\times 10^{-5}\\ \\mathrm{S}) \\times (1.0 \\times 10^{-2}\\ \\mathrm{V})$$\n$$I = 2.324427518... \\times 10^{-6}\\ \\mathrm{A}$$\n以微安（$\\mu\\mathrm{A}$）表示并四舍五入到六位有效数字：\n$$I = 2.32443\\ \\mu\\mathrm{A}$$\n\n所要求的最终答案是数值对 $(G_0, I)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 77.4809  2.32443 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在建立了对量子输运的基本概念之后，本节的终极实践将带你构建一个真正的量子输运模拟器。你将亲手实现强大的非平衡格林函数（NEGF）方法，这是目前纳米晶体管量子效应模拟的工业和学术标准 。通过这个动手编程练习，你将把抽象的理论概念转化为一个可计算和分析能量分辨透射谱与电流的实用工具。",
            "id": "3756668",
            "problem": "一个长度为 $N$ 的一维、单带、最近邻紧束缚链代表一个由两个半无限电极接触的纳米电子通道。孤立链的哈密顿量 $H$ 是一个 $N \\times N$ 的三对角矩阵，其对角元为在位能 $\\epsilon$，最近邻格点间的非对角元为 $-t$。该链在格点 $1$ 处与源极接触，在格点 $N$ 处与漏极接触。在宽带极限下，电极被建模为不依赖于能量、局域在接触格点上的纯虚数自能。两个电极由其展宽参数 $\\Gamma_S$ 和 $\\Gamma_D$ 来表征。\n\n从稳态薛定谔方程、格林函数的矩阵预解式定义以及非平衡格林函数（NEGF）方法出发，推导一种计算方法，以获得在对称电压偏置下通过该链的能量分辨透射率和稳态电流。推导必须从基本原理开始，最终得到一个可实现的算法，而不是依赖于预先给出的简化公式。使用以下物理上标准的建模假设和常数：\n\n- 哈密顿量 $H$ 定义为：对于 $i \\in \\{1,\\dots,N\\}$，$H_{ii} = \\epsilon$；对于 $i \\in \\{1,\\dots,N-1\\}$，$H_{i,i+1} = H_{i+1,i} = -t$。\n- 源极和漏极的宽带自能分别局域在格点 $1$ 和 $N$ 上，并且是纯虚数，由参数 $\\Gamma_S$ 和 $\\Gamma_D$ 描述。\n- 自旋简并度等于 $2$。\n- 能量、跃迁参数、在位能和展宽参数的单位为电子伏特。输出电流必须以安培为单位表示。\n- 使用以下常数：元电荷 $q = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$，普朗克常数 $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\cdot s}$，以电子伏特表示的玻尔兹曼常数 $k_B = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$。\n- 使用对称偏置，化学势为 $\\mu_S = E_F + V/2$ 和 $\\mu_D = E_F - V/2$，其中 $V$ 是以伏特为单位的施加电压，在能量参数中其数值被解释为电子伏特。\n- 使用梯形法则在均匀能量网格上对能量分辨的电流贡献进行数值积分。在推迟格林函数的能量参数中引入一个小的正无穷小量 $\\eta$ 以确保数值稳定性，设 $\\eta = 10^{-12}\\,\\mathrm{eV}$。\n- 费米-狄拉克占据数为 $f(E,\\mu,T) = \\left(1 + \\exp\\left(\\frac{E - \\mu}{k_B T}\\right)\\right)^{-1}$，其中 $E$ 和 $\\mu$ 的单位是电子伏特，$T$ 的单位是开尔文。稳态下的朗道尔电流通过对乘以占据数之差的透射率进行积分来计算，并进行适当的单位转换以得到安培。\n\n将您的方法实现为一个完整的、可运行的程序，为以下参数集的测试套件计算电流。对于每种情况，使用指定的能量窗口 $[E_{\\min},E_{\\max}]$ 和网格点数 $n_E$。\n\n- 情况 1（一般情况）：$N=5$, $\\epsilon = 0.0\\,\\mathrm{eV}$, $t = 0.1\\,\\mathrm{eV}$, $\\Gamma_S = 0.05\\,\\mathrm{eV}$, $\\Gamma_D = 0.05\\,\\mathrm{eV}$, $E_F = 0.0\\,\\mathrm{eV}$, $V = 0.1\\,\\mathrm{V}$, $T = 300\\,\\mathrm{K}$, $E_{\\min} = -0.5\\,\\mathrm{eV}$, $E_{\\max} = 0.5\\,\\mathrm{eV}$, $n_E = 4001$。\n- 情况 2（弱电极展宽）：$N=5$, $\\epsilon = 0.0\\,\\mathrm{eV}$, $t = 0.1\\,\\mathrm{eV}$, $\\Gamma_S = 0.005\\,\\mathrm{eV}$, $\\Gamma_D = 0.005\\,\\mathrm{eV}$, $E_F = 0.0\\,\\mathrm{eV}$, $V = 0.1\\,\\mathrm{V}$, $T = 300\\,\\mathrm{K}$, $E_{\\min} = -0.5\\,\\mathrm{eV}$, $E_{\\max} = 0.5\\,\\mathrm{eV}$, $n_E = 4001$。\n- 情况 3（强电极展宽）：$N=5$, $\\epsilon = 0.0\\,\\mathrm{eV}$, $t = 0.1\\,\\mathrm{eV}$, $\\Gamma_S = 0.5\\,\\mathrm{eV}$, $\\Gamma_D = 0.5\\,\\mathrm{eV}$, $E_F = 0.0\\,\\mathrm{eV}$, $V = 0.1\\,\\mathrm{V}$, $T = 300\\,\\mathrm{K}$, $E_{\\min} = -1.0\\,\\mathrm{eV}$, $E_{\\max} = 1.0\\,\\mathrm{eV}$, $n_E = 4001$。\n- 情况 4（零偏压边界条件）：$N=5$, $\\epsilon = 0.0\\,\\mathrm{eV}$, $t = 0.1\\,\\mathrm{eV}$, $\\Gamma_S = 0.05\\,\\mathrm{eV}$, $\\Gamma_D = 0.05\\,\\mathrm{eV}$, $E_F = 0.0\\,\\mathrm{eV}$, $V = 0.0\\,\\mathrm{V}$, $T = 300\\,\\mathrm{K}$, $E_{\\min} = -0.5\\,\\mathrm{eV}$, $E_{\\max} = 0.5\\,\\mathrm{eV}$, $n_E = 4001$。\n- 情况 5（离谐振在位能）：$N=5$, $\\epsilon = 0.3\\,\\mathrm{eV}$, $t = 0.05\\,\\mathrm{eV}$, $\\Gamma_S = 0.05\\,\\mathrm{eV}$, $\\Gamma_D = 0.05\\,\\mathrm{eV}$, $E_F = 0.0\\,\\mathrm{eV}$, $V = 0.1\\,\\mathrm{V}$, $T = 300\\,\\mathrm{K}$, $E_{\\min} = -1.0\\,\\mathrm{eV}$, $E_{\\max} = 1.0\\,\\mathrm{eV}$, $n_E = 4001$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个条目是相应测试用例的电流（单位：安培），并格式化为具有六位有效数字的科学记数法（例如，$[1.234567\\mathrm{e}{-}8,3.210000\\mathrm{e}{-}9,\\dots]$）。不允许有其他输出。",
            "solution": "该问题是有效的。它提出了纳米电子器件建模领域中一个标准的、适定的问题，基于量子力学的既定原理和非平衡格林函数（NEGF）方法。所有必需的物理参数、常数和数值规格均已提供，并且没有内部矛盾或科学不准确之处。\n\n该解答是通过将 NEGF 方法应用于连接到两个半无限电极的分子线的一维紧束缚模型而推导出来的。推导过程从格林函数的基本定义开始，直至得到一个用于计算透射率和电流的可实现算法。\n\nNEGF 方法的核心对象是推迟格林函数 $G^R(E)$，它描述了系统对脉冲的响应。对于一个开放系统，它由一个由哈密顿量 $H$ 描述的中心器件区域（链）和耦合到外部电极（库）组成，其格林函数是一个有效、依赖能量的非厄米哈密顿量的预解式。它通过求解以下矩阵方程获得：\n$$\n\\left[ (E + i\\eta)I - H - \\Sigma^R(E) \\right] G^R(E) = I\n$$\n这里，$E$ 是载流子的能量，$I$ 是 $N \\times N$ 的单位矩阵，$\\eta$ 是一个正无穷小量（按规定为 $10^{-12}\\,\\mathrm{eV}$），以确保因果性和数值稳定性。对于长度为 $N$ 的最近邻紧束缚链，器件哈密顿量 $H$ 是一个 $N \\times N$ 的三对角矩阵：\n$$\nH = \\begin{pmatrix}\n\\epsilon  -t  0  \\dots  0 \\\\\n-t  \\epsilon  -t  \\dots  0 \\\\\n0  -t  \\epsilon  \\dots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  -t \\\\\n0  0  \\dots  -t  \\epsilon\n\\end{pmatrix}\n$$\n其中 $\\epsilon$ 是在位能，$-t$ 是相邻格点之间的跃迁参数。\n\n项 $\\Sigma^R(E)$ 是推迟自能，它包含了电极对器件的影响。它是源极（$S$）和漏极（$D$）自能之和：$\\Sigma^R(E) = \\Sigma^R_S(E) + \\Sigma^R_D(E)$。问题指定了宽带极限，其中自能被假定为不依赖于能量且为纯虚数。当电极在感兴趣的能量范围内具有平坦且宽的态密度时，此近似是有效的。自能局域在接触点上。对于连接到格点 $1$ 的源极和连接到格点 $N$ 的漏极，它们的矩阵表示为：\n$$\n(\\Sigma^R_S)_{ij} = -\\frac{i}{2}\\Gamma_S \\delta_{i1}\\delta_{j1}\n$$\n$$\n(\\Sigma^R_D)_{ij} = -\\frac{i}{2}\\Gamma_D \\delta_{iN}\\delta_{jN}\n$$\n其中 $\\Gamma_S$ 和 $\\Gamma_D$ 分别是量化与源极和漏极耦合强度的展宽参数。\n\n因此，推迟格林函数通过对每个能量 $E$ 的矩阵求逆得到：\n$$\nG^R(E) = \\left[ (E + i\\eta)I - H - \\Sigma^R_S - \\Sigma^R_D \\right]^{-1}\n$$\n通过器件的量子力学透射概率 $\\mathcal{T}(E)$ 由 Fisher-Lee 或 Caroli 公式给出：\n$$\n\\mathcal{T}(E) = \\text{Tr}\\left[ \\Gamma_S(E) G^R(E) \\Gamma_D(E) G^A(E) \\right]\n$$\n其中 $G^A(E) = [G^R(E)]^\\dagger$ 是超前格林函数。展宽矩阵 $\\Gamma_k$ 通过 $\\Gamma_k(E) = i[\\Sigma^R_k(E) - \\Sigma^A_k(E)] = i[\\Sigma^R_k(E) - (\\Sigma^R_k(E))^\\dagger]$ 与自能相关。对于指定的宽带自能，展宽矩阵不依赖于能量，并且只有一个非零元素：\n$$\n(\\Gamma_S)_{ij} = i \\left( -\\frac{i}{2}\\Gamma_S - \\left(-\\frac{i}{2}\\Gamma_S\\right)^\\dagger \\right) \\delta_{i1}\\delta_{j1} = i \\left( -\\frac{i}{2}\\Gamma_S - \\frac{i}{2}\\Gamma_S \\right) \\delta_{i1}\\delta_{j1} = \\Gamma_S \\delta_{i1}\\delta_{j1}\n$$\n$$\n(\\Gamma_D)_{ij} = \\Gamma_D \\delta_{iN}\\delta_{jN}\n$$\n将这些代入 $\\mathcal{T}(E)$ 的迹公式中：\n$$\n\\mathcal{T}(E) = \\text{Tr}\\left[ (\\Gamma_S |1\\rangle\\langle 1|) G^R (\\Gamma_D |N\\rangle\\langle N|) G^A \\right]\n$$\n其中 $|i\\rangle$ 是格点 $i$ 的基向量。迹的计算结果为：\n$$\n\\mathcal{T}(E) = \\Gamma_S \\Gamma_D \\langle 1|G^R|N\\rangle \\langle N|G^A|1\\rangle\n$$\n使用 $\\langle N|G^A|1\\rangle = (\\langle 1|G^R|N\\rangle)^*$ 和矩阵元表示法 $G^R_{ij} = \\langle i|G^R|j\\rangle$，我们得到透射率的具体公式：\n$$\n\\mathcal{T}(E) = \\Gamma_S \\Gamma_D |G^R_{1N}(E)|^2\n$$\n该公式表明，透射率与连接输入格点（$1$）和输出格点（$N$）的格林函数矩阵元的模的平方成正比。\n\n施加电压 $V$ 下的稳态电流 $I$ 使用朗道尔公式计算。电压在源极和漏极的化学势之间产生差异，即 $\\mu_S = E_F + V/2$ 和 $\\mu_D = E_F - V/2$。净电流源于电子流的不平衡，该不平衡由透射概率和两个电极的费米-狄拉克占据函数之差 $f(E, \\mu, T) = \\left(1 + \\exp\\left(\\frac{E - \\mu}{k_B T}\\right)\\right)^{-1}$ 加权。包含自旋简并度的因子 $2$，电流为：\n$$\nI = \\frac{2}{h} \\int_{-\\infty}^{\\infty} \\mathcal{T}(E) \\left[ f(E, \\mu_S, T) - f(E, \\mu_D, T) \\right] dE_{\\text{Joules}}\n$$\n问题规定能量单位为电子伏特（$eV$）。为获得以安培（$C/s$）为单位的电流，能量微分必须以焦耳为单位。由于 $1\\,\\mathrm{eV} = q \\cdot 1\\,\\mathrm{J/C}$，我们有 $dE_{\\text{Joules}} = q \\cdot dE_{\\text{eV}}$。将此代入积分，并使用国际单位制中的元电荷 $q$ 和普朗克常数 $h$：\n$$\nI = \\frac{2q^2}{h} \\int_{E_{\\min}}^{E_{\\max}} \\mathcal{T}(E) \\left[ f(E, \\mu_S, T) - f(E, \\mu_D, T) \\right] dE_{\\text{eV}}\n$$\n该积分在指定的能量网格上使用梯形法则进行数值计算。\n\n计算算法如下：\n1.  对于给定的一组参数（$N, \\epsilon, t, \\Gamma_S, \\Gamma_D, E_F, V, T, E_{\\min}, E_{\\max}, n_E$），构建常数 $N \\times N$ 哈密顿矩阵 $H$ 和自能矩阵 $\\Sigma_S$ 和 $\\Sigma_D$。\n2.  定义一个从 $E_{\\min}$到 $E_{\\max}$、包含 $n_E$ 个点的均匀能量网格 $E_j$。\n3.  对于网格上的每个能量 $E_j$：\n    a. 形成复数矩阵 $M(E_j) = (E_j + i\\eta)I - H - \\Sigma_S - \\Sigma_D$。\n    b. 计算其逆矩阵以获得推迟格林函数 $G^R(E_j) = M(E_j)^{-1}$。\n    c. 提取元素 $G^R_{1N}(E_j)$（在以0为基准索引的编程中，这是位于 `[0, N-1]` 的元素）。\n    d. 计算透射率 $\\mathcal{T}(E_j) = \\Gamma_S \\Gamma_D |G^R_{1N}(E_j)|^2$。\n4.  计算化学势 $\\mu_S = E_F + V/2$ 和 $\\mu_D = E_F - V/2$。\n5.  计算被积函数数组 $Y_j = \\mathcal{T}(E_j) [f(E_j, \\mu_S, T) - f(E_j, \\mu_D, T)]$。\n6.  使用梯形法则在能量网格 $E_j$ 上对 $Y_j$ 进行数值积分。\n7.  将结果乘以物理常数前置因子 $2q^2/h$，以获得以安培为单位的最终电流。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the steady-state current through a 1D tight-binding chain\n    using the Non-Equilibrium Green's Function (NEGF) formalism.\n    \"\"\"\n    # Physical constants\n    Q = 1.602176634e-19  # Elementary charge in Coulombs\n    H_PLANCK = 6.62607015e-34  # Planck constant in J*s\n    KB_EV = 8.617333262145e-5  # Boltzmann constant in eV/K\n    \n    # Numerical stability infinitesimal\n    ETA = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general case)\n        # N, eps, t, Gamma_S, Gamma_D, E_F, V, T, E_min, E_max, n_E\n        (5, 0.0, 0.1, 0.05, 0.05, 0.0, 0.1, 300, -0.5, 0.5, 4001),\n        # Case 2 (weak contact broadening)\n        (5, 0.0, 0.1, 0.005, 0.005, 0.0, 0.1, 300, -0.5, 0.5, 4001),\n        # Case 3 (strong contact broadening)\n        (5, 0.0, 0.1, 0.5, 0.5, 0.0, 0.1, 300, -1.0, 1.0, 4001),\n        # Case 4 (zero-bias boundary condition)\n        (5, 0.0, 0.1, 0.05, 0.05, 0.0, 0.0, 300, -0.5, 0.5, 4001),\n        # Case 5 (off-resonant onsite energy)\n        (5, 0.3, 0.05, 0.05, 0.05, 0.0, 0.1, 300, -1.0, 1.0, 4001)\n    ]\n\n    results = []\n    \n    def fermi_dirac(E, mu, T):\n        \"\"\"Calculates the Fermi-Dirac distribution function.\"\"\"\n        kBT = KB_EV * T\n        # T=0K is not in test cases, but handle it for robustness\n        if kBT == 0:\n            return np.where(E = mu, 1.0, 0.0)\n        # Clip argument to avoid floating point overflow in np.exp\n        arg = np.clip((E - mu) / kBT, -700, 700)\n        return 1.0 / (1.0 + np.exp(arg))\n\n    for case in test_cases:\n        N, eps, t, Gamma_S, Gamma_D, E_F, V, T, E_min, E_max, n_E = case\n\n        # Set up chemical potentials\n        mu_S = E_F + V / 2.0\n        mu_D = E_F - V / 2.0\n        \n        # Define uniform energy grid\n        E_grid = np.linspace(E_min, E_max, n_E)\n        \n        # Construct the device Hamiltonian H (N x N)\n        # H_ii = eps, H_{i,i+1} = H_{i+1,i} = -t\n        H = np.diag(np.full(N, eps)) + \\\n            np.diag(np.full(N - 1, -t), k=1) + \\\n            np.diag(np.full(N - 1, -t), k=-1)\n        \n        # Construct the self-energy matrices Sigma (N x N)\n        # Sigma_S is non-zero only at (1,1), Sigma_D only at (N,N)\n        Sigma_S = np.zeros((N, N), dtype=np.complex128)\n        Sigma_D = np.zeros((N, N), dtype=np.complex128)\n        Sigma_S[0, 0] = -0.5j * Gamma_S\n        Sigma_D[N-1, N-1] = -0.5j * Gamma_D\n        Sigma = Sigma_S + Sigma_D\n        \n        # Array to store transmission values for each energy\n        T_E = np.zeros(n_E)\n        \n        # Identity matrix for convenience\n        Id = np.identity(N, dtype=np.complex128)\n        \n        # Loop over each energy point to calculate transmission\n        for i, E in enumerate(E_grid):\n            # Calculate the retarded Green's function G^R\n            # G^R(E) = [ (E+i*eta)*I - H - Sigma(E) ]^-1\n            M = (E + 1j * ETA) * Id - H - Sigma\n            G_R = np.linalg.inv(M)\n            \n            # Calculate transmission T(E) = Tr[Gamma_S * G_R * Gamma_D * G_A]\n            # which simplifies to T(E) = Gamma_S * Gamma_D * |G_R(1,N)|^2\n            # Note: G_R[0, N-1] is the (1,N) element in 0-based indexing\n            T_E[i] = Gamma_S * Gamma_D * np.abs(G_R[0, N-1])**2\n            \n        # Define the integrand for the Landauer formula\n        f_S = fermi_dirac(E_grid, mu_S, T)\n        f_D = fermi_dirac(E_grid, mu_D, T)\n        integrand = T_E * (f_S - f_D)\n        \n        # Calculate current by numerical integration (trapezoidal rule)\n        # I = (2*q^2/h) * integral[ T(E) * (f_S - f_D) dE ]\n        # The integral is over energy in eV, so the unit conversion is handled\n        # by the prefactor 2*q^2/h.\n        current_integral = np.trapz(integrand, E_grid)\n        current = (2 * Q**2 / H_PLANCK) * current_integral\n        results.append(current)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6e}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}