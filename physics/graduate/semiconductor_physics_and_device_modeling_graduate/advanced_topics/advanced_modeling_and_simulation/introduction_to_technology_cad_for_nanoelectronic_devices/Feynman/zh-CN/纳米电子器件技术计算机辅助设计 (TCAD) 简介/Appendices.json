{
    "hands_on_practices": [
        {
            "introduction": "在任何技术计算机辅助设计（TCAD）仿真中，精确地定义器件边界是至关重要的一步。本练习将引导您分析理想欧姆接触处的边界条件，这是连接器件与外部电路的关键接口。通过应用电荷中性定律和质量作用定律等基本半导体物理原理，您将学会如何确定接触区域的载流子浓度，这是设置任何可靠的漂移-扩散模型仿真的基础。",
            "id": "3756648",
            "problem": "考虑在温度 $T=500\\,\\mathrm{K}$ 下，对一个长沟道硅 n 沟道金属-氧化物-半导体场效应晶体管进行的二维工艺计算机辅助设计 (TCAD) 漂移-扩散模拟。该器件在源极和漏极使用理想欧姆接触，并配有理想栅极，施加的端点偏压为 $V_{GS}=0.7\\,\\mathrm{V}$、$V_{DS}=0.5\\,\\mathrm{V}$，源极电位为 $0\\,\\mathrm{V}$。源区为 n 型均匀掺杂，完全电离的施主浓度为 $N_{D}=1.0\\times 10^{15}\\,\\mathrm{cm}^{-3}$，受主浓度可忽略不计。接触点位于源区深处，该处的半导体可被假定为准中性。忽略带隙变窄和任何简并效应（假定为非简并的麦克斯韦-玻尔兹曼统计）。使用此温度下硅的本征载流子浓度 $n_{i}=2.2\\times 10^{14}\\,\\mathrm{cm}^{-3}$。\n\n从包含泊松方程以及电子和空穴准费米势定义的漂移-扩散框架出发，分析源极处准中性欧姆接触边界条件的作用。仅使用载流子密度、本征能级和准费米能级之间的基本关系，以及局部电中性条件，确定源极欧姆接触处的电子浓度。明确论证在这些边界条件下，端点偏压 $V_{GS}$ 和 $V_{DS}$ 是否会影响接触点局部浓度的计算。\n\n将电子浓度计算为单个数值，并将您的答案四舍五入到四位有效数字。最终浓度以 $\\mathrm{cm}^{-3}$ 为单位表示。",
            "solution": "该问题经验证具有科学依据、提法恰当且客观。它基于半导体器件的标准漂移-扩散模型，并提供了一套完整且一致的参数，用以在指定条件下确定理想欧姆接触处的电子浓度。\n\n目标是求出硅 n-MOSFET 源极欧姆接触处的电子浓度 $n$。问题陈述该接触是理想的，且位于源区深处，该处的半导体是准中性的。\n\n在非简并半导体中，电子 ($n$) 和空穴 ($p$) 浓度的基本关系由本征载流子浓度 $n_i$、静电势 $\\psi$ 以及电子和空穴的准费米势 $\\phi_n$ 和 $\\phi_p$ 分别给出：\n$$n = n_i \\exp\\left(\\frac{q(\\psi - \\phi_n)}{k_B T}\\right)$$\n$$p = n_i \\exp\\left(\\frac{q(\\phi_p - \\psi)}{k_B T}\\right)$$\n这里，$q$ 是基本电荷，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n理想欧姆接触作为一个无限的载流子源，在边界处强制实现局部热平衡。在热平衡状态下，电子和空穴的准费米势相等，并且它们被钉扎在与之相连的端点的电势上。对于源极接触，这意味着：\n$$\\phi_n = \\phi_p = V_S$$\n问题指定源极电位为 $0\\,\\mathrm{V}$，因此 $V_S = 0\\,\\mathrm{V}$。所以，在源极接触处，$\\phi_n = \\phi_p = 0\\,\\mathrm{V}$。\n\n在此平衡条件下，可以求出电子和空穴浓度的乘积：\n$$np = \\left(n_i \\exp\\left(\\frac{q(\\psi - \\phi_n)}{k_B T}\\right)\\right) \\left(n_i \\exp\\left(\\frac{q(\\phi_p - \\psi)}{k_B T}\\right)\\right) = n_i^2 \\exp\\left(\\frac{q(\\phi_p - \\phi_n)}{k_B T}\\right)$$\n当 $\\phi_n = \\phi_p$ 时，指数项变为 $\\exp(0) = 1$，该关系简化为热平衡下的质量作用定律：\n$$np = n_i^2$$\n\n为接触区指定的第二个条件是局部电中性。电荷密度 $\\rho$ 是来自可动载流子（空穴和电子）和固定电离掺杂物（施主 $N_D^+$ 和受主 $N_A^-$）的电荷总和。\n$$\\rho = q(p - n + N_D^+ - N_A^-)$$\n电中性条件要求 $\\rho = 0$。\n$$p - n + N_D^+ - N_A^- = 0$$\n问题陈述源区掺杂有完全电离的施主，所以 $N_D^+ = N_D = 1.0 \\times 10^{15}\\,\\mathrm{cm}^{-3}$，并且受主可忽略不计，所以 $N_A^- \\approx 0$。因此，电中性方程变为：\n$$p - n + N_D = 0 \\quad \\implies \\quad n - p = N_D$$\n\n我们现在有一个包含两个未知浓度 $n$ 和 $p$ 的方程组：\n1. $n - p = N_D$\n2. $np = n_i^2$\n\n我们可以解这个方程组来求 $n$。从第一个方程中，我们用 $n$ 表示 $p$：$p = n - N_D$。将此代入第二个方程，得到：\n$$n(n - N_D) = n_i^2$$\n这可以整理成关于电子浓度 $n$ 的一个二次方程：\n$$n^2 - N_D n - n_i^2 = 0$$\n我们使用二次方程求根公式 $n = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来解此方程，其中 $a=1$，$b=-N_D$，$c=-n_i^2$：\n$$n = \\frac{N_D \\pm \\sqrt{(-N_D)^2 - 4(1)(-n_i^2)}}{2} = \\frac{N_D \\pm \\sqrt{N_D^2 + 4n_i^2}}{2}$$\n因为电子浓度 $n$ 必须是一个正的物理量，我们必须选择正根，因为 $\\sqrt{N_D^2 + 4n_i^2} > \\sqrt{N_D^2} = N_D$。\n$$n = \\frac{N_D + \\sqrt{N_D^2 + 4n_i^2}}{2} = \\frac{N_D}{2} + \\sqrt{\\left(\\frac{N_D}{2}\\right)^2 + n_i^2}$$\n\n这个 $n$ 的表达式仅取决于施主浓度 $N_D$ 和本征载流子浓度 $n_i$（其本身是温度 $T$ 的函数）。端点偏压 $V_{GS}$ 和 $V_{DS}$ 并未出现在此方程中。这是因为计算是针对理想源极接触*处*的边界条件，该接触被假定处于局部热平衡状态。偏压 $V_{GS}=0.7\\,\\mathrm{V}$ 和 $V_{DS}=0.5\\,\\mathrm{V}$ 在器件的有源区（例如沟道和漏区）内建立了静电势和准费米能级分裂，使其脱离平衡状态。然而，它们不会改变源极接触本身平衡边界条件的定义。因此，$V_{GS}$ 和 $V_{DS}$ 与计算源极接触处局部电子浓度无关。\n\n现在我们可以使用给定的数据计算 $n$ 的数值：\n$N_D = 1.0 \\times 10^{15}\\,\\mathrm{cm}^{-3}$\n在 $T=500\\,\\mathrm{K}$ 时，$n_i = 2.2 \\times 10^{14}\\,\\mathrm{cm}^{-3}$\n\n将这些值代入导出的公式：\n$$n = \\frac{1.0 \\times 10^{15}}{2} + \\sqrt{\\left(\\frac{1.0 \\times 10^{15}}{2}\\right)^2 + \\left(2.2 \\times 10^{14}\\right)^2}$$\n$$n = 0.5 \\times 10^{15} + \\sqrt{\\left(0.5 \\times 10^{15}\\right)^2 + \\left(0.22 \\times 10^{15}\\right)^2}$$\n$$n = \\left[0.5 + \\sqrt{(0.5)^2 + (0.22)^2}\\right] \\times 10^{15}$$\n$$n = \\left[0.5 + \\sqrt{0.25 + 0.0484}\\right] \\times 10^{15}$$\n$$n = \\left[0.5 + \\sqrt{0.2984}\\right] \\times 10^{15}$$\n$$n \\approx [0.5 + 0.54626002] \\times 10^{15}$$\n$$n \\approx 1.04626002 \\times 10^{15}\\,\\mathrm{cm}^{-3}$$\n按要求将结果四舍五入到四位有效数字：\n$$n \\approx 1.046 \\times 10^{15}\\,\\mathrm{cm}^{-3}$$",
            "answer": "$$\\boxed{1.046 \\times 10^{15}}$$"
        },
        {
            "introduction": "随着晶体管尺寸进入纳米尺度，经典和半经典的输运模型逐渐失效，量子效应开始主导器件的性能。本实践将指导您使用非平衡格林函数（NEGF）方法——现代纳米电子学中用于模拟量子输运的强大工具。通过为一个一维紧束缚链编写一个计算程序，您将亲手实现从微观哈密顿量到宏观透射谱和电流的计算，从而将抽象的量子输运理论转化为可执行的仿真代码。",
            "id": "3756668",
            "problem": "一个长度为 $N$ 的一维、单带、最近邻紧束缚链代表一个纳米电子通道，该通道由两个半无限大的电极库接触。孤立链的哈密顿量 $H$ 是一个 $N \\times N$ 的三对角矩阵，其对角线元素等于在位能 $\\epsilon$，最近邻之间的非对角线元素等于 $-t$。该链在格点 $1$ 处连接到源极，在格点 $N$ 处连接到漏极。在宽带极限下，电极库被建模为位于接触格点上的、不依赖于能量的、纯虚数的自能。这两个接触由其展宽参数 $\\Gamma_S$ 和 $\\Gamma_D$ 表征。\n\n从稳态薛定谔方程、格林函数的矩阵预解式定义以及非平衡格林函数（NEGF）形式主义出发，推导一种计算方法，以获得通过该链的能量分辨透射率以及在对称电压偏置下的稳态电流。推导必须从基本原理开始，并最终得到一个可实现的算法，不得依赖于任何预先给出的简化公式。使用以下物理上标准的建模假设和常数：\n\n- 哈密顿量 $H$ 定义为：对于 $i \\in \\{1,\\dots,N\\}$，$H_{ii} = \\epsilon$；对于 $i \\in \\{1,\\dots,N-1\\}$，$H_{i,i+1} = H_{i+1,i} = -t$。\n- 源极和漏极的宽带自能分别局域在格点 $1$ 和 $N$ 上，并且是纯虚数，由 $\\Gamma_S$ 和 $\\Gamma_D$ 参数化。\n- 自旋简并度等于 $2$。\n- 能量、跃迁、在位能和展宽参数以电子伏特为单位。输出电流必须以安培为单位表示。\n- 使用以下常数：基本电荷 $q = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$，普朗克常数 $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\cdot s}$，玻尔兹曼常数（电子伏特单位）$k_B = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$。\n- 使用对称偏置，化学势为 $\\mu_S = E_F + V/2$ 和 $\\mu_D = E_F - V/2$，其中 $V$ 是以伏特为单位的施加电压，在能量参数中数值上解释为电子伏特。\n- 使用梯形法则在均匀能量网格上对能量分辨的电流贡献进行数值积分。在推迟格林函数的能量参数中引入一个小的正无穷小量 $\\eta$ 以确保数值稳定性，设 $\\eta = 10^{-12}\\,\\mathrm{eV}$。\n- 费米-狄拉克占据数为 $f(E,\\mu,T) = \\left(1 + \\exp\\left(\\frac{E - \\mu}{k_B T}\\right)\\right)^{-1}$，其中 $E$ 和 $\\mu$ 以电子伏特为单位，T以开尔文为单位。稳態下的兰道尔电流通过对乘以占据数差异的透射率进行积分来计算，并进行正确的单位转换以得到安培。\n\n将您的方法实现为一个完整的、可运行的程序，为以下参数集的测试套件计算电流。对于每种情况，使用指定的能量窗口 $[E_{\\min},E_{\\max}]$ 和网格点数 $n_E$。\n\n- 情况 1（一般情况）：$N=5$，$\\epsilon = 0.0\\,\\mathrm{eV}$，$t = 0.1\\,\\mathrm{eV}$，$\\Gamma_S = 0.05\\,\\mathrm{eV}$，$\\Gamma_D = 0.05\\,\\mathrm{eV}$，$E_F = 0.0\\,\\mathrm{eV}$，$V = 0.1\\,\\mathrm{V}$，$T = 300\\,\\mathrm{K}$，$E_{\\min} = -0.5\\,\\mathrm{eV}$，$E_{\\max} = 0.5\\,\\mathrm{eV}$，$n_E = 4001$。\n- 情况 2（弱接触展宽）：$N=5$，$\\epsilon = 0.0\\,\\mathrm{eV}$，$t = 0.1\\,\\mathrm{eV}$，$\\Gamma_S = 0.005\\,\\mathrm{eV}$，$\\Gamma_D = 0.005\\,\\mathrm{eV}$，$E_F = 0.0\\,\\mathrm{eV}$，$V = 0.1\\,\\mathrm{V}$，$T = 300\\,\\mathrm{K}$，$E_{\\min} = -0.5\\,\\mathrm{eV}$，$E_{\\max} = 0.5\\,\\mathrm{eV}$，$n_E = 4001$。\n- 情况 3（强接触展宽）：$N=5$，$\\epsilon = 0.0\\,\\mathrm{eV}$，$t = 0.1\\,\\mathrm{eV}$，$\\Gamma_S = 0.5\\,\\mathrm{eV}$，$\\Gamma_D = 0.5\\,\\mathrm{eV}$，$E_F = 0.0\\,\\mathrm{eV}$，$V = 0.1\\,\\mathrm{V}$，$T = 300\\,\\mathrm{K}$，$E_{\\min} = -1.0\\,\\mathrm{eV}$，$E_{\\max} = 1.0\\,\\mathrm{eV}$，$n_E = 4001$。\n- 情况 4（零偏压边界条件）：$N=5$，$\\epsilon = 0.0\\,\\mathrm{eV}$，$t = 0.1\\,\\mathrm{eV}$，$\\Gamma_S = 0.05\\,\\mathrm{eV}$，$\\Gamma_D = 0.05\\,\\mathrm{eV}$，$E_F = 0.0\\,\\mathrm{eV}$，$V = 0.0\\,\\mathrm{V}$，$T = 300\\,\\mathrm{K}$，$E_{\\min} = -0.5\\,\\mathrm{eV}$，$E_{\\max} = 0.5\\,\\mathrm{eV}$，$n_E = 4001$。\n- 情况 5（离谐振在位能）：$N=5$，$\\epsilon = 0.3\\,\\mathrm{eV}$，$t = 0.05\\,\\mathrm{eV}$，$\\Gamma_S = 0.05\\,\\mathrm{eV}$，$\\Gamma_D = 0.05\\,\\mathrm{eV}$，$E_F = 0.0\\,\\mathrm{eV}$，$V = 0.1\\,\\mathrm{V}$，$T = 300\\,\\mathrm{K}$，$E_{\\min} = -1.0\\,\\mathrm{eV}$，$E_{\\max} = 1.0\\,\\mathrm{eV}$，$n_E = 4001$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个条目是对应测试用例的电流（以安培为单位），格式为六位有效数字的科学记数法（例如，$[1.234567\\mathrm{e}{-}8,3.210000\\mathrm{e}{-}9,\\dots]$）。不允许有其他输出。",
            "solution": "该问题是有效的。它提出了一个纳米电子器件建模领域的标准、适定问题，基于量子力学的既定原理和非平衡格林函数（NEGF）形式主义。所有必要的物理参数、常数和数值规格均已提供，并且没有内部矛盾或科学上的不准确之处。\n\n该解决方案是通过将NEGF形式主义应用于连接到两个半无限接觸點的分子导线的一维紧束缚模型而得出的。推导从格林函数的基本定义开始，直至得到一个用于计算透射率和电流的可实现算法。\n\nNEGF形式主义中的核心对象是推迟格林函数 $G^R(E)$，它描述了系统对脉冲的响应。对于一个开放系统，它由一个由哈密顿量 $H$ 描述的中心器件区域（链）和耦合到外部接触点（电极库）组成，其格林函数是一个有效的、依赖于能量的、非厄米哈密顿量的预解式。它是通过求解矩阵方程得到的：\n$$\n\\left[ (E + i\\eta)I - H - \\Sigma^R(E) \\right] G^R(E) = I\n$$\n在这里，$E$ 是载流子的能量，$I$ 是 $N \\times N$ 单位矩阵，$\\eta$ 是一个正无穷小量（按规定为 $10^{-12}\\,\\mathrm{eV}$），以确保因果性和数值稳定性。对于长度为 $N$ 的最近邻紧束缚链，器件哈密顿量 $H$ 是一个 $N \\times N$ 的三对角矩阵：\n$$\nH = \\begin{pmatrix}\n\\epsilon  -t  0  \\dots  0 \\\\\n-t  \\epsilon  -t  \\dots  0 \\\\\n0  -t  \\epsilon  \\dots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  -t \\\\\n0  0  \\dots  -t  \\epsilon\n\\end{pmatrix}\n$$\n其中 $\\epsilon$ 是在位能，$-t$ 是相邻格点之间的跃迁参数。\n\n$\\Sigma^R(E)$ 项是推迟自能，它概括了接触点对器件的影响。它是源极（S）和漏极（D）接触点自能的总和：$\\Sigma^R(E) = \\Sigma^R_S(E) + \\Sigma^R_D(E)$。问题指定了宽带极限，其中自能被假设为不依赖于能量且为纯虚数。当接触点在感兴趣的能量范围内具有平坦且宽的态密度时，这种近似是有效的。自能局域在接触点上。对于连接到格点 $1$ 的源极和连接到格点 $N$ 的漏极，它们的矩阵表示为：\n$$\n(\\Sigma^R_S)_{ij} = -\\frac{i}{2}\\Gamma_S \\delta_{i1}\\delta_{j1}\n$$\n$$\n(\\Sigma^R_D)_{ij} = -\\frac{i}{2}\\Gamma_D \\delta_{iN}\\delta_{jN}\n$$\n其中 $\\Gamma_S$ 和 $\\Gamma_D$ 是展宽参数，分别量化了与源极和漏极耦合的强度。\n\n因此，推迟格林函数可以通过对每个能量 $E$ 的矩阵求逆得到：\n$$\nG^R(E) = \\left[ (E + i\\eta)I - H - \\Sigma^R_S - \\Sigma^R_D \\right]^{-1}\n$$\n通过器件的量子力学透射概率 $\\mathcal{T}(E)$ 由 Fisher-Lee 或 Caroli 公式给出：\n$$\n\\mathcal{T}(E) = \\text{Tr}\\left[ \\Gamma_S(E) G^R(E) \\Gamma_D(E) G^A(E) \\right]\n$$\n其中 $G^A(E) = [G^R(E)]^\\dagger$ 是超前格林函数。展宽矩阵 $\\Gamma_k$ 与自能的关系为 $\\Gamma_k(E) = i[\\Sigma^R_k(E) - \\Sigma^A_k(E)] = i[\\Sigma^R_k(E) - (\\Sigma^R_k(E))^\\dagger]$。对于指定的宽带自能，展宽矩阵不依赖于能量，并且只有一个非零元素：\n$$\n(\\Gamma_S)_{ij} = i \\left( -\\frac{i}{2}\\Gamma_S - \\left(-\\frac{i}{2}\\Gamma_S\\right)^\\dagger \\right) \\delta_{i1}\\delta_{j1} = i \\left( -\\frac{i}{2}\\Gamma_S - \\frac{i}{2}\\Gamma_S \\right) \\delta_{i1}\\delta_{j1} = \\Gamma_S \\delta_{i1}\\delta_{j1}\n$$\n$$\n(\\Gamma_D)_{ij} = \\Gamma_D \\delta_{iN}\\delta_{jN}\n$$\n将这些代入 $\\mathcal{T}(E)$ 的迹公式：\n$$\n\\mathcal{T}(E) = \\text{Tr}\\left[ (\\Gamma_S |1\\rangle\\langle 1|) G^R (\\Gamma_D |N\\rangle\\langle N|) G^A \\right]\n$$\n其中 $|i\\rangle$ 是格点 $i$ 的基向量。该迹的计算结果为：\n$$\n\\mathcal{T}(E) = \\Gamma_S \\Gamma_D \\langle 1|G^R|N\\rangle \\langle N|G^A|1\\rangle\n$$\n使用 $\\langle N|G^A|1\\rangle = (\\langle 1|G^R|N\\rangle)^*$ 和矩阵元表示法 $G^R_{ij} = \\langle i|G^R|j\\rangle$，我们得到透射率的具体公式：\n$$\n\\mathcal{T}(E) = \\Gamma_S \\Gamma_D |G^R_{1N}(E)|^2\n$$\n该公式表明，透射率与连接输入格点（$1$）和输出格点（$N$）的格林函数矩阵元的模的平方成正比。\n\n在施加电压 $V$ 下的稳态电流 $I$ 使用兰道尔公式计算。电压在源极和漏极的化学势之间产生差异，$\\mu_S = E_F + V/2$ 和 $\\mu_D = E_F - V/2$。净电流源于电子流的不平衡，该不平衡由透射概率和两个接触点的费米-狄拉克占据函数之差加权，$f(E, \\mu, T) = \\left(1 + \\exp\\left(\\frac{E - \\mu}{k_B T}\\right)\\right)^{-1}$。包含自旋简并度因子 $2$，电流为：\n$$\nI = \\frac{2}{h} \\int_{-\\infty}^{\\infty} \\mathcal{T}(E) \\left[ f(E, \\mu_S, T) - f(E, \\mu_D, T) \\right] dE_{\\text{Joules}}\n$$\n问题规定能量单位为电子伏特（eV）。为了以安培（C/s）为单位获得电流，能量微分必须以焦耳为单位。由于 $1\\,\\mathrm{eV} = q \\cdot 1\\,\\mathrm{J/C}$，我们有 $dE_{\\text{Joules}} = q \\cdot dE_{\\text{eV}}$。将此代入积分，并使用国际单位制中的基本电荷 $q$ 和普朗克常数 $h$：\n$$\nI = \\frac{2q^2}{h} \\int_{E_{\\min}}^{E_{\\max}} \\mathcal{T}(E) \\left[ f(E, \\mu_S, T) - f(E, \\mu_D, T) \\right] dE_{\\text{eV}}\n$$\n该积分使用梯形法则在指定的能量网格上进行数值计算。\n\n计算算法如下：\n1. 对于一组给定的参数（$N, \\epsilon, t, \\Gamma_S, \\Gamma_D, E_F, V, T, E_{\\min}, E_{\\max}, n_E$），构建常数 $N \\times N$ 哈密顿矩阵 $H$ 和自能矩阵 $\\Sigma_S$ 和 $\\Sigma_D$。\n2. 定义一个从 $E_{\\min}$ 到 $E_{\\max}$ 的均匀能量网格 $E_j$，包含 $n_E$ 个点。\n3. 对于网格上的每个能量 $E_j$：\n    a. 构成复数矩阵 $M(E_j) = (E_j + i\\eta)I - H - \\Sigma_S - \\Sigma_D$。\n    b. 计算其逆矩阵以获得推迟格林函数 $G^R(E_j) = M(E_j)^{-1}$。\n    c. 提取元素 $G^R_{1N}(E_j)$（在0索引编程中，这是位于 `[0, N-1]` 的元素）。\n    d. 计算透射率 $\\mathcal{T}(E_j) = \\Gamma_S \\Gamma_D |G^R_{1N}(E_j)|^2$。\n4. 计算化学势 $\\mu_S = E_F + V/2$ 和 $\\mu_D = E_F - V/2$。\n5. 计算被积函数数组 $Y_j = \\mathcal{T}(E_j) [f(E_j, \\mu_S, T) - f(E_j, \\mu_D, T)]$。\n6. 使用梯形法则在能量网格 $E_j$ 上对 $Y_j$ 进行数值积分。\n7. 将结果乘以物理常数前因子 $2q^2/h$ 以获得以安培为单位的最终电流。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the steady-state current through a 1D tight-binding chain\n    using the Non-Equilibrium Green's Function (NEGF) formalism.\n    \"\"\"\n    # Physical constants\n    Q = 1.602176634e-19  # Elementary charge in Coulombs\n    H_PLANCK = 6.62607015e-34  # Planck constant in J*s\n    KB_EV = 8.617333262145e-5  # Boltzmann constant in eV/K\n    \n    # Numerical stability infinitesimal\n    ETA = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general case)\n        # N, eps, t, Gamma_S, Gamma_D, E_F, V, T, E_min, E_max, n_E\n        (5, 0.0, 0.1, 0.05, 0.05, 0.0, 0.1, 300, -0.5, 0.5, 4001),\n        # Case 2 (weak contact broadening)\n        (5, 0.0, 0.1, 0.005, 0.005, 0.0, 0.1, 300, -0.5, 0.5, 4001),\n        # Case 3 (strong contact broadening)\n        (5, 0.0, 0.1, 0.5, 0.5, 0.0, 0.1, 300, -1.0, 1.0, 4001),\n        # Case 4 (zero-bias boundary condition)\n        (5, 0.0, 0.1, 0.05, 0.05, 0.0, 0.0, 300, -0.5, 0.5, 4001),\n        # Case 5 (off-resonant onsite energy)\n        (5, 0.3, 0.05, 0.05, 0.05, 0.0, 0.1, 300, -1.0, 1.0, 4001)\n    ]\n\n    results = []\n    \n    def fermi_dirac(E, mu, T):\n        \"\"\"Calculates the Fermi-Dirac distribution function.\"\"\"\n        kBT = KB_EV * T\n        # T=0K is not in test cases, but handle it for robustness\n        if kBT == 0:\n            return np.where(E = mu, 1.0, 0.0)\n        # Clip argument to avoid floating point overflow in np.exp\n        arg = np.clip((E - mu) / kBT, -700, 700)\n        return 1.0 / (1.0 + np.exp(arg))\n\n    for case in test_cases:\n        N, eps, t, Gamma_S, Gamma_D, E_F, V, T, E_min, E_max, n_E = case\n\n        # Set up chemical potentials\n        mu_S = E_F + V / 2.0\n        mu_D = E_F - V / 2.0\n        \n        # Define uniform energy grid\n        E_grid = np.linspace(E_min, E_max, n_E)\n        \n        # Construct the device Hamiltonian H (N x N)\n        # H_ii = eps, H_{i,i+1} = H_{i+1,i} = -t\n        H = np.diag(np.full(N, eps)) + \\\n            np.diag(np.full(N - 1, -t), k=1) + \\\n            np.diag(np.full(N - 1, -t), k=-1)\n        \n        # Construct the self-energy matrices Sigma (N x N)\n        # Sigma_S is non-zero only at (1,1), Sigma_D only at (N,N)\n        Sigma_S = np.zeros((N, N), dtype=np.complex128)\n        Sigma_D = np.zeros((N, N), dtype=np.complex128)\n        Sigma_S[0, 0] = -0.5j * Gamma_S\n        Sigma_D[N-1, N-1] = -0.5j * Gamma_D\n        Sigma = Sigma_S + Sigma_D\n        \n        # Array to store transmission values for each energy\n        T_E = np.zeros(n_E)\n        \n        # Identity matrix for convenience\n        Id = np.identity(N, dtype=np.complex128)\n        \n        # Loop over each energy point to calculate transmission\n        for i, E in enumerate(E_grid):\n            # Calculate the retarded Green's function G^R\n            # G^R(E) = [ (E+i*eta)*I - H - Sigma(E) ]^-1\n            M = (E + 1j * ETA) * Id - H - Sigma\n            G_R = np.linalg.inv(M)\n            \n            # Calculate transmission T(E) = Tr[Gamma_S * G_R * Gamma_D * G_A]\n            # which simplifies to T(E) = Gamma_S * Gamma_D * |G_R(1,N)|^2\n            # Note: G_R[0, N-1] is the (1,N) element in 0-based indexing\n            T_E[i] = Gamma_S * Gamma_D * np.abs(G_R[0, N-1])**2\n            \n        # Define the integrand for the Landauer formula\n        f_S = fermi_dirac(E_grid, mu_S, T)\n        f_D = fermi_dirac(E_grid, mu_D, T)\n        integrand = T_E * (f_S - f_D)\n        \n        # Calculate current by numerical integration (trapezoidal rule)\n        # I = (2*q^2/h) * integral[ T(E) * (f_S - f_D) dE ]\n        # The integral is over energy in eV, so the unit conversion is handled\n        # by the prefactor 2*q^2/h.\n        current_integral = np.trapz(integrand, E_grid)\n        current = (2 * Q**2 / H_PLANCK) * current_integral\n        results.append(current)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6e}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在真实的纳米电子器件中，多种物理现象常常相互耦合，形成复杂的反馈回路，而自热效应就是一个典型的例子。电流通过沟道产生焦耳热，导致器件温度升高；而温度的升高又会通过声子散射等机制降低载流子迁移率，从而反过来影响电流的大小。本练习将引导您构建一个自洽模型来解决这一电热耦合问题，通过迭代求解，您将找到电流和温度同时满足电气和热学方程的稳定工作点，从而更精确地预测器件在高功耗下的实际性能。",
            "id": "3756633",
            "problem": "一个短沟道金属氧化物半导体场效应晶体管（MOSFET）在高漏极偏压下工作，工艺计算机辅助设计（TCAD）必须考虑电热耦合效应：漏极电流加热沟道，这会改变载流子迁移率，进而改变电流和热量。从电荷输运和能量平衡的第一性原理出发，推导并实现一个关于沟道温度和电流的自洽模型。\n\n使用以下基本原理。电荷输运由漂移电流密度和漂移速度描述，沟道被建模为一个均匀的高场平板。需要使用的基本关系如下：\n- 漂移电流密度定义：$$\\mathbf{J} = q n \\mu \\mathbf{E}$$ 其中 $q$ 是元电荷，$n$ 是载流子密度，$\\mu$ 是迁移率，$\\mathbf{E}$ 是电场。\n- 在强反型 MOSFET 沟道中，单位面积的反型层电荷为 $$Q_{\\text{inv}} = C_{\\text{ox}} (V_G - V_T)，$$ 其中 $C_{\\text{ox}}$ 是单位面积的氧化层电容，$V_G$ 是栅极电压，$V_T$ 是阈值电压。\n- 面载流子密度为 $$n_s = \\frac{Q_{\\text{inv}}}{q}。$$\n- 通过宽度为 $W$ 的均匀沟道的漏极电流为 $$I_D = W \\, q n_s \\, v_d，$$ 其中 $v_d$ 是沿沟道的漂移速度。\n- 高场下的漂移速度会饱和；使用一个与微观散射机制一致的广泛使用的经验关系来对此建模：$$v_d(T) = \\frac{\\mu(T) \\, E}{1 + \\mu(T) \\, E / v_{\\text{sat}}}，$$ 其中 $E$ 是平均沟道电场，$v_{\\text{sat}}$ 是饱和速度。\n- 反型层中迁移率的温度依赖性通过一个由声子散射启发的幂律模型来建模：$$\\mu(T) = \\mu_0 \\left(\\frac{T}{T_0}\\right)^{-m}，$$ 其中 $\\mu_0$ 是在 $T_0$ 时的参考迁移率，$m > 0$ 是温度指数。\n- 对于高漏极偏压下的短沟道器件，均匀沟道电场近似为 $$E = \\frac{V_D}{L}，$$ 其中 $V_D$ 是漏极电压，$L$ 是沟道长度。\n- 在集总热阻模型中，电热平衡为 $$T = T_{\\text{amb}} + R_{\\text{th}} P，$$ 其中 $T$ 是沟道温度，$T_{\\text{amb}}$ 是环境温度，$R_{\\text{th}}$ 是从沟道到环境的热阻，$P$ 是耗散功率。\n- 对于沟道中的焦耳热，$$P = I_D V_D。$$\n\n基于这些基础，构建关于未知沟道温度 $T$ 的自洽不动点问题：漏极电流 $I_D$ 通过 $\\mu(T)$ 和 $v_d(T)$ 依赖于 $T$，而 $T$ 通过功率耗散依赖于 $I_D$。建立并求解标量方程 $$f(T) = T_{\\text{amb}} + R_{\\text{th}} V_D I_D(T) - T = 0，$$ 其中 $$I_D(T) = W \\, C_{\\text{ox}} \\, (V_G - V_T) \\, v_d(T), \\quad v_d(T) = \\frac{\\mu_0 \\left(\\frac{T}{T_0}\\right)^{-m} \\, \\frac{V_D}{L}}{1 + \\frac{\\mu_0 \\left(\\frac{T}{T_0}\\right)^{-m} \\, \\frac{V_D}{L}}{v_{\\text{sat}}}}.$$ 如果 $V_G \\le V_T$，则取 $I_D(T) = 0$ 且 $T = T_{\\text{amb}}$。\n\n实现一个鲁棒的数值求解器（例如，单调二分法或阻尼不动点迭代），为每个测试用例找到唯一的具有物理意义的解 $T$（单位为开尔文）。然后计算相应的漏极电流 $I_D$（单位为安培）。\n\n单位和输出要求：\n- 以开尔文（$\\mathrm{K}$）表示沟道温度，以安培（$\\mathrm{A}$）表示漏极电流。\n- 每个浮点数结果报告时四舍五入到六位小数。\n- 你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中数值按测试套件的顺序交错排列为 $[T_1, I_{D,1}, T_2, I_{D,2}, \\dots]$。\n\n测试套件参数，涵盖典型、高热、近阈值和极端热阻场景：\n1. 案例A（典型高偏压，中等自热效应）：\n   - $W = 1.0 \\times 10^{-6} \\, \\mathrm{m}$, $L = 5.0 \\times 10^{-8} \\, \\mathrm{m}$, $C_{\\text{ox}} = 2.0 \\times 10^{-2} \\, \\mathrm{F/m^2}$,\n   - $\\mu_0 = 5.0 \\times 10^{-2} \\, \\mathrm{m^2/(V \\cdot s)}$, $T_0 = 300 \\, \\mathrm{K}$, $m = 1.5$, $v_{\\text{sat}} = 1.0 \\times 10^{5} \\, \\mathrm{m/s}$,\n   - $T_{\\text{amb}} = 300 \\, \\mathrm{K}$, $V_G = 0.9 \\, \\mathrm{V}$, $V_T = 0.3 \\, \\mathrm{V}$, $V_D = 0.7 \\, \\mathrm{V}$, $R_{\\text{th}} = 5.0 \\times 10^{3} \\, \\mathrm{K/W}$。\n2. 案例B（宽器件和更高偏压，强自热效应）：\n   - $W = 4.0 \\times 10^{-6} \\, \\mathrm{m}$, $L = 5.0 \\times 10^{-8} \\, \\mathrm{m}$, $C_{\\text{ox}} = 2.0 \\times 10^{-2} \\, \\mathrm{F/m^2}$,\n   - $\\mu_0 = 5.0 \\times 10^{-2} \\, \\mathrm{m^2/(V \\cdot s)}$, $T_0 = 300 \\, \\mathrm{K}$, $m = 1.5$, $v_{\\text{sat}} = 1.0 \\times 10^{5} \\, \\mathrm{m/s}$,\n   - $T_{\\text{amb}} = 300 \\, \\mathrm{K}$, $V_G = 1.2 \\, \\mathrm{V}$, $V_T = 0.3 \\, \\mathrm{V}$, $V_D = 1.0 \\, \\mathrm{V}$, $R_{\\text{th}} = 2.0 \\times 10^{4} \\, \\mathrm{K/W}$。\n3. 案例C（近阈值，极小发热，稳定性边界情况）：\n   - $W = 1.0 \\times 10^{-6} \\, \\mathrm{m}$, $L = 5.0 \\times 10^{-8} \\, \\mathrm{m}$, $C_{\\text{ox}} = 2.0 \\times 10^{-2} \\, \\mathrm{F/m^2}$,\n   - $\\mu_0 = 5.0 \\times 10^{-2} \\, \\mathrm{m^2/(V \\cdot s)}$, $T_0 = 300 \\, \\mathrm{K}$, $m = 1.5$, $v_{\\text{sat}} = 1.0 \\times 10^{5} \\, \\mathrm{m/s}$,\n   - $T_{\\text{amb}} = 300 \\, \\mathrm{K}$, $V_G = 0.31 \\, \\mathrm{V}$, $V_T = 0.3 \\, \\mathrm{V}$, $V_D = 0.7 \\, \\mathrm{V}$, $R_{\\text{th}} = 8.0 \\times 10^{4} \\, \\mathrm{K/W}$。\n4. 案例D（极端热阻，强耦合）：\n   - $W = 2.0 \\times 10^{-6} \\, \\mathrm{m}$, $L = 5.0 \\times 10^{-8} \\, \\mathrm{m}$, $C_{\\text{ox}} = 2.0 \\times 10^{-2} \\, \\mathrm{F/m^2}$,\n   - $\\mu_0 = 5.0 \\times 10^{-2} \\, \\mathrm{m^2/(V \\cdot s)}$, $T_0 = 300 \\, \\mathrm{K}$, $m = 1.5$, $v_{\\text{sat}} = 1.0 \\times 10^{5} \\, \\mathrm{m/s}$,\n   - $T_{\\text{amb}} = 300 \\, \\mathrm{K}$, $V_G = 1.0 \\, \\mathrm{V}$, $V_T = 0.3 \\, \\mathrm{V}$, $V_D = 1.2 \\, \\mathrm{V}$, $R_{\\text{th}} = 8.0 \\times 10^{4} \\, \\mathrm{K/W}$。\n\n你的程序必须为每个案例实现自洽求解器，并以精确格式输出单行结果：$$[T_A, I_{D,A}, T_B, I_{D,B}, T_C, I_{D,C}, T_D, I_{D,D}]$$ 所有值均为浮点数，四舍五入到六位小数，温度单位为 $\\mathrm{K}$，电流单位为 $\\mathrm{A}$。",
            "solution": "用户提供了一个关于短沟道 MOSFET 自洽电热建模的问题陈述。任务是验证此问题，如果有效，则提供一个合理的解决方案和相应的 Python 实现。\n\n### 步骤1：提取给定条件\n\n问题提供了一套用于分析的基本模型和参数：\n1.  **漂移电流密度**：$\\mathbf{J} = q n \\mu \\mathbf{E}$，其中 $q$ 是元电荷，$n$ 是载流子密度，$\\mu$ 是迁移率，$\\mathbf{E}$ 是电场。\n2.  **反型层电荷密度**：$Q_{\\text{inv}} = C_{\\text{ox}} (V_G - V_T)$，其中 $C_{\\text{ox}}$ 是单位面积的氧化层电容，$V_G$ 是栅极电压，$V_T$ 是阈值电压。\n3.  **面载流子密度**：$n_s = \\frac{Q_{\\text{inv}}}{q}$。\n4.  **漏极电流**：$I_D = W \\, q n_s \\, v_d$，其中 $W$ 是沟道宽度，$v_d$ 是载流子漂移速度。\n5.  **高场漂移速度**：$v_d(T) = \\frac{\\mu(T) \\, E}{1 + \\mu(T) \\, E / v_{\\text{sat}}}$，其中 $v_{\\text{sat}}$ 是饱和速度。\n6.  **随温度变化的迁移率**：$\\mu(T) = \\mu_0 \\left(\\frac{T}{T_0}\\right)^{-m}$，其中 $\\mu_0$ 是参考温度 $T_0$ 下的参考迁移率，$m$ 是温度指数。\n7.  **平均沟道电场**：$E = \\frac{V_D}{L}$，其中 $V_D$ 是漏极电压，$L$ 是沟道长度。\n8.  **电热平衡**：$T = T_{\\text{amb}} + R_{\\text{th}} P$，其中 $T$ 是沟道温度，$T_{\\text{amb}}$ 是环境温度，$R_{\\text{th}}$ 是热阻，$P$ 是耗散功率。\n9.  **焦耳热功率**：$P = I_D V_D$。\n10. **自洽方程**：求解 $T$ 使得 $f(T) = T_{\\text{amb}} + R_{\\text{th}} V_D I_D(T) - T = 0$。\n11. **截止状态条件**：如果 $V_G \\le V_T$，则 $I_D(T) = 0$ 且 $T = T_{\\text{amb}}$。\n12. **测试用例**：为 $W, L, C_{\\text{ox}}, \\mu_0, T_0, m, v_{\\text{sat}}, T_{\\text{amb}}, V_G, V_T, V_D, R_{\\text{th}}$ 提供了四组参数。所有单位均为国际单位制（SI）。\n\n### 步骤2：使用提取的给定条件进行验证\n\n-   **科学依据**：该问题建立在半导体器件物理学中标准且成熟的模型之上。漂移-扩散框架、强反型电荷模型、Caughey-Thomas 速度饱和模型、由声子散射引起的幂律迁移率退化以及集总元件热模型都是固态电子学导论和 TCAD 的基石。该问题在科学上是合理的。\n-   **适定性**：该问题要求解关于沟道温度 $T$ 的标量非线性方程 $f(T) = 0$。为了分析这一点，我们首先组合给定的表达式，得到漏极电流 $I_D$ 作为温度 $T$ 的函数。元电荷 $q$ 被消去：\n    $$ I_D = W q n_s v_d = W q \\left(\\frac{Q_{\\text{inv}}}{q}\\right) v_d = W Q_{\\text{inv}} v_d = W C_{\\text{ox}} (V_G - V_T) v_d(T) $$\n    温度依赖性如下：\n    -   对于 $T0$ 和 $m0$，$\\mu(T) = \\mu_0(T/T_0)^{-m}$ 是 $T$ 的严格递减函数。\n    -   $v_d(\\mu) = \\frac{\\mu E}{1 + \\mu E / v_{\\text{sat}}}$。其导数 $\\frac{dv_d}{d\\mu} = \\frac{E}{(1+\\mu E/v_{\\text{sat}})^2}  0$，所以 $v_d$ 是 $\\mu$ 的严格递增函数。\n    -   通过复合， $v_d(T)$ 以及因此的 $I_D(T)$ 都是温度 $T$ 的严格递减函数。\n    需要求解的方程是 $T = g(T)$，其中 $g(T) = T_{\\text{amb}} + R_{\\text{th}} V_D I_D(T)$。由于 $I_D(T)$ 是 $T$ 的正递减函数，$g(T)$ 也是 $T$ 的递减函数。我们来分析函数 $f(T) = g(T) - T$。\n    -   在物理下界 $T = T_{\\text{amb}}$ 处，我们有 $f(T_{\\text{amb}}) = g(T_{\\text{amb}}) - T_{\\text{amb}} = R_{\\text{th}} V_D I_D(T_{\\text{amb}})$。由于所有项都是非负的（如果 $V_G  V_T$ 则为正），所以 $f(T_{\\text{amb}}) \\ge 0$。\n    -   当 $T \\to \\infty$ 时，$\\mu(T) \\to 0$，这意味着 $v_d(T) \\to 0$ 且 $I_D(T) \\to 0$。因此，$\\lim_{T\\to\\infty} g(T) = T_{\\text{amb}}$。这意味着 $\\lim_{T\\to\\infty} f(T) = \\lim_{T\\to\\infty} (T_{\\text{amb}} - T) = -\\infty$。\n    -   函数 $f(T)$ 是连续且严格单调递减的，因为它的导数是 $f'(T) = g'(T) - 1$，并且由于 $g(T)$ 是递减的，$g'(T) \\le 0$，这保证了 $f'(T)  0$。\n    -   鉴于 $f(T)$ 是连续的，在 $T=T_{\\text{amb}}$ 处从一个非负值开始，并趋向于 $-\\infty$，根据介值定理，保证存在一个唯一的根 $T^* \\ge T_{\\text{amb}}$。因此，该问题是适定的。\n-   **客观性**：问题陈述完全是定量的和客观的，使用了明确的物理模型和数值参数。\n-   **完整性和一致性**：为每个案例提供了所有必要的参数。单位是一致的（国际单位制）。没有矛盾之处。\n-   **其他缺陷**：该问题没有其他缺陷，如不切实际、结构不良或过于简单。它代表了器件建模中的一个典型问题。\n\n### 步骤3：结论与行动\n\n问题陈述是 **有效的**。将基于推导出的自洽方程构建一个解决方案。\n\n### 求解推导\n\n问题的核心是求解关于沟道温度 $T$ 的非线性标量方程：\n$$ f(T) = T - \\left( T_{\\text{amb}} + R_{\\text{th}} V_D I_D(T) \\right) = 0 $$\n其中，随温度变化的漏极电流 $I_D(T)$ 可通过代入各分量方程得到：\n$$ I_D(T) = W \\, C_{\\text{ox}} \\, (V_G - V_T) \\, v_d(T) $$\n漂移速度 $v_d(T)$ 为：\n$$ v_d(T) = \\frac{\\mu(T) E}{1 + \\mu(T) E / v_{\\text{sat}}} $$\n其中迁移率 $\\mu(T)$ 和电场 $E$ 为：\n$$ \\mu(T) = \\mu_0 \\left(\\frac{T}{T_0}\\right)^{-m} \\quad \\text{and} \\quad E = \\frac{V_D}{L} $$\n如果 $V_G \\le V_T$，存在一个特殊情况。在这种情况下，反型层不形成，漏极电流为零（$I_D=0$），因此没有焦耳热（$P=0$）。沟道温度保持在环境温度，即 $T = T_{\\text{amb}}$。\n\n对于 $V_G  V_T$ 的情况，我们必须找到 $f(T)$ 的根。正如在验证阶段所确定的那样，保证存在一个唯一的解 $T^* \\ge T_{\\text{amb}}$。适用于此问题的鲁棒数值方法是二分法。\n\n**二分法算法：**\n1.  **定义要求解的函数**：令 $h(T) = T_{\\text{amb}} + R_{\\text{th}} V_D I_D(T) - T$。我们寻求 $h(T)=0$ 的根。\n2.  **建立搜索区间 $[T_a, T_b]$**：\n    -   一个合适的下界是 $T_a = T_{\\text{amb}}$。在此温度下，$h(T_a) = R_{\\text{th}} V_D I_D(T_{\\text{amb}}) \\ge 0$。\n    -   必须选择一个上界 $T_b$ 使得 $h(T_b)  0$。随着 $T$ 增加，$I_D(T)$ 减小，而 $-T$ 项占主导地位。一个足够大的温度，例如 $T_b = T_{\\text{amb}} + 1000 \\, \\mathrm{K}$，将确保对于任何实际参数，$h(T_b)$ 都是负的。\n3.  **迭代**：当区间宽度 $(T_b - T_a)$ 大于指定容差时：\n    a. 计算中点 $T_c = (T_a + T_b) / 2$。\n    b. 计算 $h(T_c)$。\n    c. 如果 $h(T_c)$ 与 $h(T_a)$ 同号（即 $h(T_a)h(T_c) > 0$），则根在 $[T_c, T_b]$ 内。更新 $T_a = T_c$。\n    d. 否则，根在 $[T_a, T_c]$ 内。更新 $T_b = T_c$。\n4.  **解**：收敛后的中点即为自洽温度 $T^*$。\n5.  **最终计算**：一旦找到 $T^*$，就使用 $I_D(T^*)$ 的表达式计算相应的漏极电流。\n\n此过程将应用于问题陈述中提供的四个测试用例。然后收集结果 $T^*$ 和 $I_D(T^*)$，并按要求格式化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the self-consistent electrothermal problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A (typical high-bias, modest self-heating)\n        {\n            'W': 1.0e-6, 'L': 5.0e-8, 'C_ox': 2.0e-2,\n            'mu_0': 5.0e-2, 'T_0': 300.0, 'm': 1.5, 'v_sat': 1.0e5,\n            'T_amb': 300.0, 'V_G': 0.9, 'V_T': 0.3, 'V_D': 0.7, 'R_th': 5.0e3\n        },\n        # Case B (wide device and higher bias, strong self-heating)\n        {\n            'W': 4.0e-6, 'L': 5.0e-8, 'C_ox': 2.0e-2,\n            'mu_0': 5.0e-2, 'T_0': 300.0, 'm': 1.5, 'v_sat': 1.0e5,\n            'T_amb': 300.0, 'V_G': 1.2, 'V_T': 0.3, 'V_D': 1.0, 'R_th': 2.0e4\n        },\n        # Case C (near-threshold, minimal heating, stability edge case)\n        {\n            'W': 1.0e-6, 'L': 5.0e-8, 'C_ox': 2.0e-2,\n            'mu_0': 5.0e-2, 'T_0': 300.0, 'm': 1.5, 'v_sat': 1.0e5,\n            'T_amb': 300.0, 'V_G': 0.31, 'V_T': 0.3, 'V_D': 0.7, 'R_th': 8.0e4\n        },\n        # Case D (extreme thermal resistance, strong coupling)\n        {\n            'W': 2.0e-6, 'L': 5.0e-8, 'C_ox': 2.0e-2,\n            'mu_0': 5.0e-2, 'T_0': 300.0, 'm': 1.5, 'v_sat': 1.0e5,\n            'T_amb': 300.0, 'V_G': 1.0, 'V_T': 0.3, 'V_D': 1.2, 'R_th': 8.0e4\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        T_sol, I_D_sol = solve_single_case(**params)\n        results.append(f\"{T_sol:.6f}\")\n        results.append(f\"{I_D_sol:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_single_case(W, L, C_ox, mu_0, T_0, m, v_sat, T_amb, V_G, V_T, V_D, R_th):\n    \"\"\"\n    Solves for the self-consistent temperature T and drain current I_D for a single device configuration.\n    \"\"\"\n    if V_G = V_T:\n        return T_amb, 0.0\n\n    # Electric field in the channel\n    E = V_D / L\n\n    def calculate_I_D(T):\n        \"\"\"Calculates drain current I_D as a function of temperature T.\"\"\"\n        if T = 0:\n            # Physical temperatures must be positive. Return a large number to guide bisection away.\n            return np.inf\n\n        # Temperature-dependent mobility\n        mu_T = mu_0 * (T / T_0)**(-m)\n        \n        # High-field drift velocity\n        numerator_vd = mu_T * E\n        denominator_vd = 1.0 + numerator_vd / v_sat\n        v_d = numerator_vd / denominator_vd\n        \n        # Drain current\n        I_D = W * C_ox * (V_G - V_T) * v_d\n        return I_D\n\n    def f(T):\n        \"\"\"The function f(T) = 0 we want to solve for T.\"\"\"\n        I_D_T = calculate_I_D(T)\n        P = I_D_T * V_D\n        # This is the function whose root we need to find: T_new(T) - T = 0\n        return T_amb + R_th * P - T\n\n    # Bisection method to find T\n    low_T = T_amb\n    # An upper bound certain to contain the root, as power dissipation decreases with T.\n    high_T = T_amb + 1000.0 \n    \n    # Check if a root exists in the bracket\n    if f(low_T)  0:\n        # This case happens if heating is negligible and numerical precision makes f(T_amb) slightly negative\n        return T_amb, calculate_I_D(T_amb)\n\n    # Perform bisection for a fixed number of iterations for guaranteed convergence to high precision\n    for _ in range(100): # 100 iterations are more than sufficient for double precision\n        mid_T = (low_T + high_T) / 2.0\n        if f(mid_T) > 0:\n            low_T = mid_T\n        else:\n            high_T = mid_T\n            \n    final_T = (low_T + high_T) / 2.0\n    final_I_D = calculate_I_D(final_T)\n    \n    return final_T, final_I_D\n\nsolve()\n```"
        }
    ]
}