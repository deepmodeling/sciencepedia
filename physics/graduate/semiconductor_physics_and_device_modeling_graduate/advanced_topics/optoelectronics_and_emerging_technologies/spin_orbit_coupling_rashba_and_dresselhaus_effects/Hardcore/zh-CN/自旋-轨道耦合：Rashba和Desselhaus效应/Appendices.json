{
    "hands_on_practices": [
        {
            "introduction": "在二维电子气中观察到的线性德雷斯尔豪斯（Dresselhaus）效应并非凭空产生，而是三维体材料的晶格对称性和量子限制效应共同作用的结果。本练习将引导你从体材料的立方（cubic-in-$k$）哈密顿量出发，推导出在[001]方向量子阱中至关重要的有效二维线性哈密顿量。通过这个实践，你将深刻理解量子限制如何改变自旋轨道相互作用的形式，并揭示出自旋劈裂的能量大小虽然是各向同性的，但其底层的有效磁场和自旋构型却具有明确的各向异性。",
            "id": "3774210",
            "problem": "考虑限制在沿晶体学 $[001]$ 方向生长的闪锌矿半导体量子阱 (QW) 中的二维电子气 (2DEG)。假设量子阱是对称的，因此结构反演不对称性可以忽略不计，且唯一的自旋轨道相互作用是由体反演不对称性（Dresselhaus 耦合）引起的。导带单粒子哈密顿量可以写成一个不依赖于自旋的动能项和一个由体反演不对称性产生的依赖于自旋的项之和。在体材料中，对于导带电子，关于波矢量的最低阶、依赖于自旋的 Dresselhaus 项是波矢量分量的三次项，并且可以用晶轴 $[100]$、$[010]$ 和 $[001]$ 来表示。在沿 $[001]$ 方向的强束缚下，由于对沿 $[001]$ 方向的量子化运动进行平均，面内有效 Dresselhaus 相互作用获得一个与面内波矢量呈线性的项。\n\n从这些基本事实出发，在量子阱的最低子带内（其中 $\\langle k_{z} \\rangle = 0$ 且 $\\langle k_{z}^{2} \\rangle \\neq 0$），推导关于面内波矢量分量 $k_{x}$ 和 $k_{y}$ 的线性阶的有效面内自旋相关哈密顿量，然后确定在固定面内波矢量大小 $k = \\sqrt{k_{x}^{2} + k_{y}^{2}}$ 时，两个自旋分辨分支之间的自旋劈裂 $\\Delta E(k,\\theta)$ 的角度依赖性。将面内极角 $\\theta$ 定义为 $k_{x} = k \\cos\\theta$ 和 $k_{y} = k \\sin\\theta$，其中 $\\theta$ 是从 $[100]$ 轴开始测量的弧度角。假设任何更高阶（三次）的面内项与线性项相比都可以忽略不计。\n\n您的任务是计算 $\\Delta E(k,\\theta)$ 的封闭形式解析表达式，用 $k$ 和由束缚产生的有效线性 Dresselhaus 系数 $\\beta$ 来表示。将最终答案表示为单个解析表达式。此外，在您的推导中定性地解释，即使能量劈裂的大小不依赖于 $\\theta$，与线性 Dresselhaus 耦合相关的有效场的对称性如何导致相对于 $[100]$ 和 $[010]$ 晶轴的二重各向异性。\n\n不需要数值计算。将最终答案表示为用 $k$ 和 $\\beta$ 表示的单个解析表达式。",
            "solution": "问题要求推导在沿 $[001]$ 方向生长的对称量子阱（QW）中二维电子气（2DEG）的有效面内线性 Dresselhaus 哈密顿量，并随后计算自旋劈裂 $\\Delta E$ 作为面内波矢量大小 $k$ 及其方向 $\\theta$ 的函数。\n\n出发点是体 Dresselhaus 哈密顿量，它描述了闪锌矿晶体中由体反演不对称性引起的自旋轨道相互作用。关于波矢量 $\\mathbf{k}=(k_x, k_y, k_z)$ 的最低阶（三次），该哈密顿量由下式给出：\n$$H_{D}^{(3)} = \\gamma_D \\left( \\sigma_x k_x (k_y^2 - k_z^2) + \\sigma_y k_y (k_z^2 - k_x^2) + \\sigma_z k_z (k_x^2 - k_y^2) \\right)$$\n此处，$\\gamma_D$ 是体 Dresselhaus 系数，$\\sigma_{x,y,z}$ 是泡利矩阵，且 $x, y, z$ 轴分别与晶体学方向 $[100]$、$[010]$ 和 $[001]$ 对齐。\n\n二维电子气是通过沿 $z$ 方向（$[001]$）的强束缚形成的。对于量子阱最低能量子带中的电子，其沿 $z$ 方向的运动是量子化的，而在 $x-y$ 平面内可以自由移动。有效的二维哈密顿量是通过对三维哈密顿量在量子阱基态波函数 $\\psi_0(z)$ 上进行平均得到的。这意味着我们将算符 $k_z$ 和 $k_z^2$ 替换为它们的期望值：$k_z \\rightarrow \\langle k_z \\rangle$ 和 $k_z^2 \\rightarrow \\langle k_z^2 \\rangle$。\n\n如题所述，量子阱是对称的。基态波函数 $\\psi_0(z)$ 是 $z$ 的偶函数。沿 $z$ 方向的动量算符为 $k_z = -i\\hbar^{-1}p_z = -i\\frac{\\partial}{\\partial z}$。因此，期望值 $\\langle k_z \\rangle$ 为零：\n$$\\langle k_z \\rangle = \\int_{-\\infty}^{\\infty} \\psi_0^*(z) \\left(-i\\frac{\\partial}{\\partial z}\\right) \\psi_0(z) dz = 0$$\n然而，$k_z^2$ 的期望值非零，并对应于束缚的动能：\n$$\\langle k_z^2 \\rangle = \\int_{-\\infty}^{\\infty} \\psi_0^*(z) \\left(-\\frac{\\partial^2}{\\partial z^2}\\right) \\psi_0(z) dz \\neq 0$$\n对 $H_D^{(3)}$ 关于 $z$ 方向的量子化运动取期望值，我们得到：\n$$H_{D, \\text{eff}} = \\gamma_D \\left( \\sigma_x k_x (k_y^2 - \\langle k_z^2 \\rangle) + \\sigma_y k_y (\\langle k_z^2 \\rangle - k_x^2) + \\sigma_z \\langle k_z \\rangle (k_x^2 - k_y^2) \\right)$$\n代入 $\\langle k_z \\rangle = 0$：\n$$H_{D, \\text{eff}} = \\gamma_D \\left( \\sigma_x k_x (k_y^2 - \\langle k_z^2 \\rangle) + \\sigma_y k_y (\\langle k_z^2 \\rangle - k_x^2) \\right)$$\n这个有效哈密顿量包含对面内波矢量分量 ($k_x$, $k_y$) 呈线性的项，以及呈三次方的项 ($k_x k_y^2$, $k_y k_x^2$)。题目指定我们要考虑 $k_x$ 和 $k_y$ 的线性阶有效哈密顿量，忽略面内的三次项。对于小的面内动量，这是一个有效的近似。线性部分，记为 $H_{D1}$，是：\n$$H_{D1} = \\gamma_D \\left( \\sigma_x k_x (-\\langle k_z^2 \\rangle) + \\sigma_y k_y (\\langle k_z^2 \\rangle) \\right) = \\gamma_D \\langle k_z^2 \\rangle (-k_x \\sigma_x + k_y \\sigma_y)$$\n我们将有效线性 Dresselhaus 系数 $\\beta$ 定义为 $\\beta = -\\gamma_D \\langle k_z^2 \\rangle$。因此，线性 Dresselhaus 效应的有效哈密顿量是：\n$$H_{D1} = \\beta (k_x \\sigma_x - k_y \\sigma_y)$$\n最低子带中电子的总单粒子哈密顿量，包括不依赖自旋的动能，为：\n$$H = H_0 + H_{D1} = \\frac{\\hbar^2 (k_x^2 + k_y^2)}{2m^*} I + \\beta (k_x \\sigma_x - k_y \\sigma_y)$$\n其中 $m^*$ 是电子有效质量，$I$ 是 $2 \\times 2$ 单位矩阵。使用泡利矩阵 $\\sigma_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$ 和 $\\sigma_y = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}$ 的矩阵表示，哈密顿量可以写成：\n$$H = \\begin{pmatrix} \\frac{\\hbar^2 k^2}{2m^*} & \\beta(k_x - ik_y) \\\\ \\beta(k_x + ik_y) & \\frac{\\hbar^2 k^2}{2m^*} \\end{pmatrix}$$\n其中 $k^2 = k_x^2 + k_y^2$。为了找到能量本征值 $E$，我们求解特征方程 $\\det(H - E I) = 0$：\n$$\\left( \\frac{\\hbar^2 k^2}{2m^*} - E \\right)^2 - \\beta^2(k_x - ik_y)(k_x + ik_y) = 0$$\n$$\\left( \\frac{\\hbar^2 k^2}{2m^*} - E \\right)^2 - \\beta^2(k_x^2 + k_y^2) = 0$$\n$$\\left( \\frac{\\hbar^2 k^2}{2m^*} - E \\right)^2 = \\beta^2 k^2$$\n对两边取平方根，得到：\n$$\\frac{\\hbar^2 k^2}{2m^*} - E = \\pm \\sqrt{\\beta^2 k^2} = \\pm |\\beta| k$$\n两个能量本征值，对应于两个自旋分辨的能量分支，为：\n$$E_{\\pm}(k) = \\frac{\\hbar^2 k^2}{2m^*} \\pm |\\beta| k$$\n自旋劈裂 $\\Delta E$ 是这两个能量之差：\n$$\\Delta E(k) = E_+ - E_- = \\left(\\frac{\\hbar^2 k^2}{2m^*} + |\\beta| k\\right) - \\left(\\frac{\\hbar^2 k^2}{2m^*} - |\\beta| k\\right) = 2|\\beta|k$$\n题目要求劈裂的角度依赖性，$\\Delta E(k, \\theta)$，其中 $k_x = k \\cos\\theta$ 且 $k_y = k \\sin\\theta$。如推导所示，线性 Dresselhaus 效应的自旋劈裂大小是各向同性的；它依赖于波矢量的大小 $k$，但不依赖于其方向 $\\theta$。\n\n现在，来定性解释一下各向异性。哈密顿量的自旋相关部分可以写成 $H_{D1} = \\mathbf{\\Omega}_D(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中 $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵的矢量，而 $\\mathbf{\\Omega}_D(\\mathbf{k})$ 是一个有效磁场矢量。从我们推导出的 $H_{D1}$，这个场是：\n$$\\mathbf{\\Omega}_D(\\mathbf{k}) = \\beta(k_x, -k_y, 0)$$\n在极坐标中，$\\mathbf{\\Omega}_D(k, \\theta) = \\beta k(\\cos\\theta, -\\sin\\theta, 0)$。\n这个有效场的大小是 $|\\mathbf{\\Omega}_D| = \\sqrt{(\\beta k_x)^2 + (\\beta (-k_y))^2} = \\sqrt{\\beta^2(k_x^2+k_y^2)} = |\\beta|k$。能量劈裂为 $\\Delta E = 2|\\mathbf{\\Omega}_D| = 2|\\beta|k$，是各向同性的。\n然而，决定自旋量子化轴的有效场 $\\mathbf{\\Omega}_D$ 的*方向*，高度依赖于电子动量 $\\mathbf{k}$ 的方向。这种方向依赖性，或称各向异性，是 Dresselhaus 效应的一个关键特征。\n当我们考察场矢量 $\\mathbf{\\Omega}_D$ 和动量矢量 $\\mathbf{k}=(k_x, k_y, 0)$ 之间的关系时，相对于 $[100]$ ($x$) 和 $[010]$ ($y$) 轴的“二重各向异性”就变得很明显。它们之间的夹角不是恒定的。让我们计算它们的点积：\n$$\\mathbf{\\Omega}_D \\cdot \\mathbf{k} = \\beta(k_x)(k_x) + \\beta(-k_y)(k_y) = \\beta(k_x^2 - k_y^2)$$\n使用极坐标，这变成：\n$$\\mathbf{\\Omega}_D \\cdot \\mathbf{k} = \\beta(k^2\\cos^2\\theta - k^2\\sin^2\\theta) = \\beta k^2 \\cos(2\\theta)$$\n$\\cos(2\\theta)$ 项揭示了二重各向异性。该项在 $\\theta$ 旋转 $\\pi$（即 $\\theta \\to \\theta+\\pi$）时保持不变，但在旋转 $\\pi/2$ 时则不然。当沿 $[001]$ 方向观察时，这种对称性低于底层晶格的四重对称性。非零的点积表明自旋量子化轴（平行于 $\\mathbf{\\Omega}_D$）通常不垂直于电子的动量 $\\mathbf{k}$。\n这种各向异性具有重要的物理后果。例如，对于沿 $[110]$ 或 $[1\\bar{1}0]$ 方向（$\\theta=\\pi/4$ 或 $\\theta=3\\pi/4$）运动的电子，$\\cos(2\\theta)=0$，因此 $\\mathbf{\\Omega}_D \\perp \\mathbf{k}$。对于沿晶轴 $[100]$ 或 $[010]$（$\\theta=0$ 或 $\\theta=\\pi/2$）运动的电子，$|\\cos(2\\theta)|=1$，且 $\\mathbf{\\Omega}_D$ 和 $\\mathbf{k}$ 之间的夹角最大。自旋构型的这种各向异性强烈影响自旋动力学，导致各向异性的自旋弛豫时间，这是自旋电子学中的一个关键现象。因此，尽管能量劈裂的大小是各向同性的，但底层的自旋结构具有明显的二重各向异性。",
            "answer": "$$\n\\boxed{2|\\beta|k}\n$$"
        },
        {
            "introduction": "在真实的半导体异质结中，由结构不对称性引起的拉什巴（Rashba）效应和由体反演不对称性引起的德雷斯尔豪斯（Dresselhaus）效应常常共存，它们的相互作用催生了丰富且可调控的自旋物理现象。本练习将探讨这两种效应产生的有效磁场之间的相长与相消干涉。通过找出当两种耦合强度相等（$\\alpha = \\beta$）时自旋劈裂消失的特定动量方向，你将揭示“持续性自旋螺旋”（persistent spin helix）态的形成机理，这是一种对实现无耗散的自旋信息传输和处理至关重要的量子态。",
            "id": "3774136",
            "problem": "一个限制在沿晶体学 $[001]$ 轴生长的闪锌矿半导体量子阱中的二维电子气 (2DEG)，由于结构反演不对称性和体反演不对称性而表现出自旋轨道相互作用。在有效质量近似下，该自旋轨道相互作用由一个作用于自旋的、依赖于面内动量的 $2 \\times 2$ 哈密顿量描述，该哈密顿量由泡利矩阵和波矢分量构成。考虑一个固定的面内波矢，其大小为 $k$，相对于 $[100]$ 轴的极角为 $\\phi$，因此其分量满足 $k_{x} = k \\cos \\phi$ 和 $k_{y} = k \\sin \\phi$。假设与线性项相比，立方 Dresselhaus 项可以忽略不计，并且 Rashba 和线性 Dresselhaus 耦合强度相等且为正，即 $\\alpha = \\beta > 0$。\n\n从适用于 $[001]$ 2DEG 的 Rashba 和线性 Dresselhaus 自旋轨道哈密顿量的标准形式出发，推导使两个自旋分辨分支之间的自旋分裂 $\\Delta E(\\phi)$ 消失时，角度 $\\phi$ 所需满足的条件。确定在区间 $[0, 2\\pi)$ 内所有使 $\\Delta E(\\phi) = 0$ 的角度 $\\phi$，并用弧度表示你的最终角度。然后，从与结构反演不对称性和体反演不对称性相关的等效自旋轨道场之间的相消干涉的角度，解释这些特殊方向的物理意义。\n\n你的最终答案必须是区间 $[0, 2\\pi)$ 内的角度列表，以弧度表示。无需四舍五入。",
            "solution": "该问题要求在 Rashba 和线性 Dresselhaus 耦合强度相等的条件下，找出二维电子气 (2DEG) 中电子运动的哪些特定方向能使由自旋轨道相互作用引起的自旋分裂消失。\n\n首先，我们建立理论框架。该系统是一个限制在沿 $[001]$ 方向生长的闪锌矿量子阱中的 2DEG。电子的面内波矢表示为 $\\mathbf{k} = (k_x, k_y)$，其分量为 $k_x = k \\cos \\phi$ 和 $k_y = k \\sin \\phi$，其中 $k = |\\mathbf{k}|$，$\\phi$ 是相对于 $[100]$ 轴的角度。\n\n自旋轨道相互作用哈密顿量 $H_{SO}$ 是由结构反演不对称性 (SIA) 引起的 Rashba 项 $H_R$ 和由体反演不对称性 (BIA) 引起的线性 Dresselhaus 项 $H_D$ 之和。对于沿 $[001]$ 方向生长的 2DEG，它们由以下公式给出：\n$$ H_R = \\alpha (\\sigma_x k_y - \\sigma_y k_x) $$\n$$ H_D = \\beta (\\sigma_x k_x - \\sigma_y k_y) $$\n其中 $\\alpha$ 和 $\\beta$ 分别是 Rashba 和 Dresselhaus 耦合系数，$\\sigma_x, \\sigma_y$ 是泡利自旋矩阵。\n\n总的自旋轨道哈密顿量是 $H_{SO} = H_R + H_D$ 之和：\n$$ H_{SO} = \\alpha (\\sigma_x k_y - \\sigma_y k_x) + \\beta (\\sigma_x k_x - \\sigma_y k_y) $$\n我们可以按泡利矩阵对各项进行分组：\n$$ H_{SO} = (\\alpha k_y + \\beta k_x) \\sigma_x - (\\alpha k_x + \\beta k_y) \\sigma_y $$\n这个哈密顿量可以表示为等效自旋轨道磁场矢量 $\\mathbf{\\Omega}_{SO}$ 与泡利矩阵矢量 $\\mathbf{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 的点积：\n$$ H_{SO} = \\mathbf{\\Omega}_{SO} \\cdot \\mathbf{\\sigma} $$\n其中等效场的分量为：\n$$ \\Omega_x = \\alpha k_y + \\beta k_x $$\n$$ \\Omega_y = -(\\alpha k_x + \\beta k_y) $$\n$$ \\Omega_z = 0 $$\n电子的总哈密顿量是 $H = \\frac{\\hbar^2 k^2}{2m^*}I + H_{SO}$，其中第一项是动能（$I$ 是 $2 \\times 2$ 单位矩阵，$m^*$ 是有效质量）。$H_{SO}$ 的本征值为 $\\pm |\\mathbf{\\Omega}_{SO}|$，其中 $|\\mathbf{\\Omega}_{SO}| = \\sqrt{\\Omega_x^2 + \\Omega_y^2}$。因此，总哈密顿量 $H$ 的本征值为：\n$$ E_{\\pm}(\\mathbf{k}) = \\frac{\\hbar^2 k^2}{2m^*} \\pm |\\mathbf{\\Omega}_{SO}| $$\n自旋分裂 $\\Delta E$ 是这两个自旋分辨分支之间的能量差：\n$$ \\Delta E(\\mathbf{k}) = E_+(\\mathbf{k}) - E_-(\\mathbf{k}) = 2 |\\mathbf{\\Omega}_{SO}| = 2 \\sqrt{(\\alpha k_y + \\beta k_x)^2 + (-(\\alpha k_x + \\beta k_y))^2} $$\n\n问题要求我们找到自旋分裂消失的条件，即 $\\Delta E(\\phi) = 0$。这当且仅当等效自旋轨道场的大小为零时发生，即 $|\\mathbf{\\Omega}_{SO}| = 0$。这要求其两个分量 $\\Omega_x$ 和 $\\Omega_y$ 同时为零：\n1. $\\alpha k_y + \\beta k_x = 0$\n2. $-(\\alpha k_x + \\beta k_y) = 0$\n这两个方程是线性相关的。我们使用问题陈述中给出的特定条件：$\\alpha = \\beta > 0$。将此代入第一个方程，得到：\n$$ \\alpha k_y + \\alpha k_x = 0 $$\n由于 $\\alpha > 0$，我们可以除以 $\\alpha$ 得到中心条件：\n$$ k_x + k_y = 0 $$\n现在，我们用极角 $\\phi$ 来表示这个条件。使用定义 $k_x = k \\cos \\phi$ 和 $k_y = k \\sin \\phi$，我们得到：\n$$ k \\cos \\phi + k \\sin \\phi = 0 $$\n对于运动的电子，波矢大小 $k$ 不为零（$k \\neq 0$），所以我们可以除以 $k$：\n$$ \\cos \\phi + \\sin \\phi = 0 $$\n$$ \\sin \\phi = -\\cos \\phi $$\n我们可以除以 $\\cos \\phi$，因为 $\\cos \\phi = 0$（这意味着 $\\phi = \\frac{\\pi}{2}$ 或 $\\phi = \\frac{3\\pi}{2}$）不满足该方程（因为此时 $\\sin \\phi$ 将是 $\\pm 1$，而不是 $0$）。这得到：\n$$ \\tan \\phi = -1 $$\n我们需要找到在区间 $[0, 2\\pi)$ 内 $\\phi$ 的所有解。正切函数在第二和第四象限等于 $-1$。$\\arctan(-1)$ 的主值是 $-\\frac{\\pi}{4}$。通解是 $\\phi = -\\frac{\\pi}{4} + n\\pi$，其中 $n$ 是任意整数。\n对于 $n=1$，我们在第二象限找到解：\n$$ \\phi_1 = -\\frac{\\pi}{4} + \\pi = \\frac{3\\pi}{4} $$\n对于 $n=2$，我们在第四象限找到解：\n$$ \\phi_2 = -\\frac{\\pi}{4} + 2\\pi = \\frac{7\\pi}{4} $$\n这些是在指定区间 $[0, 2\\pi)$ 内的仅有解。\n\n这个结果的物理解释是，当与 Rashba 和 Dresselhaus 效应相关的等效磁场发生相消干涉并完全抵消时，自旋分裂消失。总等效场 $\\mathbf{\\Omega}_{SO}$ 是 Rashba 场 $\\mathbf{\\Omega}_R = \\alpha(k_y, -k_x, 0)$ 和 Dresselhaus 场 $\\mathbf{\\Omega}_D = \\beta(k_x, -k_y, 0)$ 的矢量和。条件 $\\Delta E = 0$ 等价于 $\\mathbf{\\Omega}_{SO} = \\mathbf{\\Omega}_R + \\mathbf{\\Omega}_D = \\mathbf{0}$，这意味着 $\\mathbf{\\Omega}_R = -\\mathbf{\\Omega}_D$。\n给定 $\\alpha=\\beta$，这个矢量等式变为：\n$$ \\alpha(k_y, -k_x, 0) = -\\alpha(k_x, -k_y, 0) $$\n$$ \\alpha(k_y, -k_x, 0) = \\alpha(-k_x, k_y, 0) $$\n令分量相等，得到 $k_y = -k_x$，这正是我们推导出的条件。因此，对于沿着方向 $\\phi = \\frac{3\\pi}{4}$（$[\\bar{1}10]$ 晶向）和 $\\phi = \\frac{7\\pi}{4}$（$[1\\bar{1}0]$ 晶向）的电子动量矢量，由结构反演不对称性（Rashba）和体反演不对称性（Dresselhaus）产生的等效场大小相等、方向相反，导致净等效场为零，因此没有自旋分裂。对于这些特定的传播方向，两个自旋态保持简并。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3\\pi}{4}  \\frac{7\\pi}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "尽管有效质量近似为我们提供了强大的连续介质模型，但许多现代的数值模拟和理论研究都建立在离散的格点模型之上。本练习旨在将拉什巴（Rashba）自旋轨道耦合的物理图像转化为一个正方晶格上的紧束缚模型。你需要先从理论上推导出其布洛赫（Bloch）哈密顿量，然后通过编写程序来数值计算系统的能带结构和自旋纹理，从而将抽象的理论概念转化为具体的、可计算的物理量，为连接解析理论和计算物理研究铺平道路。",
            "id": "4303839",
            "problem": "考虑一个二维方格晶格上无相互作用的自旋-$\\tfrac{1}{2}$电子，该系统由一个紧束缚哈密顿量描述。此哈密顿量包含一个自旋无关的最近邻跃迁振幅 $t$，以及一个由结构反演不对称引起的最近邻 Rashba 自旋轨道耦合。在晶格费米子算符 $c_{i,s}$ 的基下进行计算，其中 $i$ 标记晶格格点，$s \\in \\{\\uparrow,\\downarrow\\}$ 标记自旋。请使用以下经过充分检验的基础出发点：\n\n- 最近邻跃迁的二次量子化紧束缚形式，泡利矩阵 $\\sigma_x$、$\\sigma_y$ 和 $\\sigma_z$ 的定义和性质，以及自旋-$\\tfrac{1}{2}$单位矩阵 $I_2$。\n- 离散平移不变性以及实空间晶格算符与动量空间算符之间的傅里叶变换关系，$c_{i,s} = \\tfrac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}_i} c_{\\mathbf{k},s}$，其中 $N$ 是晶格格点数。\n- 由结构反演不对称引起的 Rashba 机制，它耦合了自旋和晶格动量，使得产生的自旋依赖跃迁在波矢下是奇函数，并保持时间反演对称性。\n\n你的任务是：\n\n1. 从上述基础要素出发，推导方格晶格的动量空间布洛赫哈密顿量 $H(\\mathbf{k})$，包含自旋无关的跃迁振幅 $t$ 和 Rashba 自旋轨道耦合振幅 $t_R$，且限制在最近邻。在旋量基 $(c_{\\mathbf{k},\\uparrow}, c_{\\mathbf{k},\\downarrow})$ 中表示 $H(\\mathbf{k})$，并证明它可以写成通用的 $2 \\times 2$ 形式 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2 + \\mathbf{g}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中 $\\boldsymbol{\\sigma} = (\\sigma_x,\\sigma_y,\\sigma_z)$，而 $\\mathbf{g}(\\mathbf{k}) = (g_x(\\mathbf{k}), g_y(\\mathbf{k}), g_z(\\mathbf{k}))$ 由 Rashba 跃迁结构决定。请明确说明 $\\mathbf{g}(\\mathbf{k})$ 中关于 $\\mathbf{k}$ 的奇函数分量是如何从最近邻自旋依赖跃迁的傅里叶变换中产生的。\n\n2. 使用推导出的 $H(\\mathbf{k})$，设计一个数值计算程序来计算：\n   - 在方格晶格的第一布里渊区中，沿标准高对称路径 $\\Gamma \\rightarrow X \\rightarrow M \\rightarrow \\Gamma$ 的能带结构，其中 $\\Gamma = (0,0)$，$X = (\\pi,0)$，$M = (\\pi,\\pi)$。对每段路径使用相同数量的点进行采样，以在 $\\mathbf{k}$ 空间中形成一条折线。每段使用 $128$ 个点，总共采样 $384$ 个 $\\mathbf{k}$ 值（包括端点），并将所有量视为无量纲。\n   - 对于每个采样的 $\\mathbf{k}$，计算两个能带的能量 $E_-(\\mathbf{k})$ 和 $E_+(\\mathbf{k})$，并确定下能带 $E_-(\\mathbf{k})$。\n   - 对于每个 $\\mathbf{k}$ 处的下能带本征态，计算自旋期望值 $\\langle \\sigma_x \\rangle$、$\\langle \\sigma_y \\rangle$ 和 $\\langle \\sigma_z \\rangle$。如果在某个采样的 $\\mathbf{k}$ 处自旋分裂消失（由于 $\\mathbf{g}(\\mathbf{k}) = \\mathbf{0}$ 导致的简并），则将自旋期望值定义为零向量，以避免因简并点处旋量基的任意性而产生的模糊性。\n\n3. 对于每组参数 $(t, t_R)$，定义并计算沿路径的以下三个标量总结指标：\n   - 沿路径的最大能带分裂，$\\Delta_{\\max} = \\max_{\\mathbf{k}} \\left[ E_+(\\mathbf{k}) - E_-(\\mathbf{k}) \\right]$。\n   - 一个自旋-动量锁定关联，定义为路径上 $C(\\mathbf{k}) = \\hat{\\mathbf{s}}_-(\\mathbf{k}) \\cdot \\left( \\hat{\\mathbf{z}} \\times \\hat{\\mathbf{k}} \\right)$ 的平均值，其中 $\\hat{\\mathbf{s}}_-(\\mathbf{k})$ 是 $\\mathbf{k}$ 处下能带自旋期望值的单位向量（当自旋分裂消失时使用零向量），$\\hat{\\mathbf{z}}$ 是垂直于晶格平面的单位向量，$\\hat{\\mathbf{k}} = \\mathbf{k}/\\lVert \\mathbf{k} \\rVert$ 是 $\\mathbf{k}$ 方向的单位向量。在计算平均值时排除 $\\mathbf{k} = \\mathbf{0}$ 或将其贡献视为零。将所有采样点的平均值报告为单个浮点数。\n   - 沿路径的下能带平均自旋大小，$S_{\\mathrm{avg}} = \\frac{1}{N_{\\mathrm{samples}}} \\sum_{\\mathbf{k}} \\lVert \\langle \\boldsymbol{\\sigma} \\rangle_-(\\mathbf{k}) \\rVert$，在简并点处使用上述约定。\n\n4. 在一个单独的程序中实现你的推导和数值计算过程，该程序为以下测试套件中的每组参数计算第3项中的指标：\n   - $(t, t_R) = (1.0, 0.0)$，无 Rashba 耦合的边界情况。\n   - $(t, t_R) = (1.0, 0.2)$，代表性的正 Rashba 耦合。\n   - $(t, t_R) = (1.0, -0.2)$，代表性的负 Rashba 耦合。\n\n所有量均为无量纲；不需要物理单位。波矢使用弧度单位。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。对于每组参数，按 $\\Delta_{\\max}$、平均自旋-动量锁定关联和平均自旋大小的顺序列出三个浮点数，并将这三个三元组连接成一个扁平列表。例如，输出格式应为 $[\\Delta_{\\max}^{(1)},C^{(1)},S_{\\mathrm{avg}}^{(1)},\\Delta_{\\max}^{(2)},C^{(2)},S_{\\mathrm{avg}}^{(2)},\\Delta_{\\max}^{(3)},C^{(3)},S_{\\mathrm{avg}}^{(3)}]$。",
            "solution": "用户提供的问题已经过分析和验证。这是一个来自凝聚态物理领域的、良定的、有科学依据的客观问题。它没有任何验证清单中列出的缺陷。因此，下面提供一个完整的解决方案。\n\n### 1. 布洛赫哈密顿量的推导\n\n对于二维方格晶格上具有最近邻相互作用的无相互作用电子，其总哈密顿量 $H$ 可以写成一个自旋无关的跃迁项 $H_t$ 和一个 Rashba 自旋轨道耦合项 $H_R$ 的和：\n$$H = H_t + H_R$$\n我们将通过对每一项进行离散傅里叶变换来推导其动量空间表示，即布洛赫哈密顿量 $H(\\mathbf{k})$。我们在旋量基 $\\mathbf{c}_i^\\dagger = (c_{i,\\uparrow}^\\dagger, c_{i,\\downarrow}^\\dagger)$ 中进行计算，其中 $i$ 是晶格格点指数。为简单起见，设晶格常数 $a=1$。\n\n**自旋无关的跃迁 ($H_t$)**\n\n自旋无关的最近邻跃迁由下式描述：\n$$H_t = -t \\sum_{\\langle i,j \\rangle, s} (c_{i,s}^\\dagger c_{j,s} + \\text{h.c.})$$\n其中 $t$ 是跃迁振幅，$\\langle i,j \\rangle$ 表示对最近邻对求和，$s \\in \\{\\uparrow, \\downarrow\\}$ 是自旋指数。在旋量基中，这可以写成：\n$$H_t = -t \\sum_{\\langle i,j \\rangle} \\mathbf{c}_i^\\dagger I_2 \\mathbf{c}_j$$\n其中 $I_2$ 是自旋空间中的 $2 \\times 2$ 单位矩阵。\n格点 $i$ 的位置是 $\\mathbf{r}_i$，其最近邻位于 $\\mathbf{r}_i + \\boldsymbol{\\delta}$，其中 $\\boldsymbol{\\delta} \\in \\{\\pm \\hat{x}, \\pm \\hat{y}\\}$。我们可以将哈密顿量写成对格点 $i$ 和位移 $\\boldsymbol{\\delta}$ 的求和：\n$$H_t = -t \\sum_{i, \\boldsymbol{\\delta}} \\mathbf{c}_i^\\dagger I_2 \\mathbf{c}_{i+\\boldsymbol{\\delta}}$$\n我们使用傅里叶变换 $c_{i,s} = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}_i} c_{\\mathbf{k},s}$，这意味着 $\\mathbf{c}_i = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}_i} \\mathbf{c}_{\\mathbf{k}}$。将其代入 $H_t$ 的表达式，并使用恒等式 $\\frac{1}{N} \\sum_i e^{i(\\mathbf{k}-\\mathbf{k}')\\cdot\\mathbf{r}_i} = \\delta_{\\mathbf{k},\\mathbf{k}'}$，得到：\n$$H_t = \\sum_{\\mathbf{k}} \\mathbf{c}_{\\mathbf{k}}^\\dagger \\left( -t \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}} \\right) I_2 \\, \\mathbf{c}_{\\mathbf{k}}$$\n对于方格晶格，对最近邻矢量的求和为：\n$$\\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}} = e^{ik_x} + e^{-ik_x} + e^{ik_y} + e^{-ik_y} = 2(\\cos k_x + \\cos k_y)$$\n因此，跃迁项的动量空间表示为 $H_t(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2$，其中色散关系为：\n$$\\varepsilon(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)$$\n\n**Rashba自旋轨道耦合 ($H_R$)**\n\nRashba自旋轨道耦合源于结构反演不对称，并表现为一种自旋依赖的跃迁相互作用。对于从格点 $j$ 到格点 $i$ 的一次跃迁，相互作用正比于 $i t_R (\\boldsymbol{\\sigma} \\times \\hat{\\mathbf{d}}_{ij}) \\cdot \\hat{\\mathbf{z}}$，其中 $\\hat{\\mathbf{d}}_{ij}$ 是从格点 $i$ 到格点 $j$ 的单位向量，$\\hat{\\mathbf{z}}$ 是垂直于二维平面的单位向量。完整的最近邻 Rashba 哈密顿量为：\n$$H_R = i t_R \\sum_{\\langle i,j \\rangle} \\mathbf{c}_i^\\dagger (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{d}}_{ij})) \\mathbf{c}_j$$\n让我们分析每个邻居方向 $\\boldsymbol{\\delta} = \\hat{\\mathbf{d}}_{ij}$ 的跃迁矩阵：\n- 对于 $\\boldsymbol{\\delta} = \\hat{x}$：跃迁矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times \\hat{x})) = i t_R (\\boldsymbol{\\sigma} \\cdot \\hat{y}) = i t_R \\sigma_y$。\n- 对于 $\\boldsymbol{\\delta} = -\\hat{x}$：跃迁矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times (-\\hat{x}))) = -i t_R \\sigma_y$。\n- 对于 $\\boldsymbol{\\delta} = \\hat{y}$：跃迁矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times \\hat{y})) = i t_R (\\boldsymbol{\\sigma} \\cdot (-\\hat{x})) = -i t_R \\sigma_x$。\n- 对于 $\\boldsymbol{\\delta} = -\\hat{y}$：跃迁矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times (-\\hat{y}))) = i t_R \\sigma_x$。\n\n总的实空间哈密顿量可以写成 $H = \\sum_{i, \\boldsymbol{\\delta}} \\mathbf{c}_i^\\dagger T_{\\boldsymbol{\\delta}} \\mathbf{c}_{i+\\boldsymbol{\\delta}}$，其中 $T_{\\boldsymbol{\\delta}}$ 是对应位移 $\\boldsymbol{\\delta}$ 的总跃迁矩阵。布洛赫哈密顿量是其傅里叶变换 $H(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} T_{\\boldsymbol{\\delta}} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}}$。\n$H(\\mathbf{k}) = T_{\\hat{x}} e^{ik_x} + T_{-\\hat{x}} e^{-ik_x} + T_{\\hat{y}} e^{ik_y} + T_{-\\hat{y}} e^{-ik_y}$\n其中 $T_{\\boldsymbol{\\delta}} = -t I_2 + H_{R, \\boldsymbol{\\delta}}$，$H_{R, \\boldsymbol{\\delta}}$ 是 Rashba 部分。\n$$H(\\mathbf{k}) = (-t I_2 + i t_R \\sigma_y)e^{ik_x} + (-t I_2 - i t_R \\sigma_y)e^{-ik_x} + (-t I_2 - i t_R \\sigma_x)e^{ik_y} + (-t I_2 + i t_R \\sigma_x)e^{-ik_y}$$\n对各项进行分组：\n$$H(\\mathbf{k}) = -t(e^{ik_x} + e^{-ik_x} + e^{ik_y} + e^{-ik_y})I_2 + i t_R \\sigma_x (e^{-ik_y} - e^{ik_y}) + i t_R \\sigma_y (e^{ik_x} - e^{-ik_x})$$\n使用欧拉公式 $e^{i\\theta}-e^{-i\\theta} = 2i\\sin\\theta$：\n$$H(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)I_2 + i t_R \\sigma_x (-2i \\sin k_y) + i t_R \\sigma_y (2i \\sin k_x)$$\n$$H(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)I_2 + 2t_R \\sin(k_y) \\sigma_x - 2t_R \\sin(k_x) \\sigma_y$$\n这正是所要求的形式 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2 + \\mathbf{g}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中：\n- 自旋无关的色散关系：$\\varepsilon(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)$\n- 自旋轨道耦合矢量：$\\mathbf{g}(\\mathbf{k}) = (g_x(\\mathbf{k}), g_y(\\mathbf{k}), g_z(\\mathbf{k}))$\n  - $g_x(\\mathbf{k}) = 2t_R \\sin(k_y)$\n  - $g_y(\\mathbf{k}) = -2t_R \\sin(k_x)$\n  - $g_z(\\mathbf{k}) = 0$\n\n$\\mathbf{g}(\\mathbf{k})$ 矢量分量关于 $\\mathbf{k}$ 的奇函数特性源于对最近邻自旋依赖跃迁项的傅里叶变换。来自相反方向跃迁的相位因子 $e^{i k_x}$ 和 $e^{-i k_x}$ 结合形成 $\\sin(k_x)$，这是一个奇函数。这反映了自旋轨道相互作用必须在动量反演下为奇函数以保持时间反演对称性的要求。\n\n### 2. 数值程序和度量指标\n\n**能带结构和本征态**\n哈密顿量 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2 + \\mathbf{g}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$ 的本征值由下式给出：\n$$E_{\\pm}(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\pm |\\mathbf{g}(\\mathbf{k})|$$\n其中 $|\\mathbf{g}(\\mathbf{k})| = \\sqrt{g_x(\\mathbf{k})^2 + g_y(\\mathbf{k})^2 + g_z(\\mathbf{k})^2} = \\sqrt{(2t_R \\sin k_y)^2 + (-2t_R \\sin k_x)^2} = 2|t_R|\\sqrt{\\sin^2 k_x + \\sin^2 k_y}$。两个能带分别是 $E_+(\\mathbf{k})$（上能带）和 $E_-(\\mathbf{k})$（下能带）。\n\n$H(\\mathbf{k})$ 的本征向量是与矢量 $\\mathbf{g}(\\mathbf{k})$ 平行或反平行的旋量。对于一个本征态 $|\\psi\\rangle$，其自旋期望值为 $\\langle \\boldsymbol{\\sigma} \\rangle = \\langle \\psi | \\boldsymbol{\\sigma} | \\psi \\rangle$。对于对应于 $E_-(\\mathbf{k})$ 的下能带本征态，其自旋与 $\\mathbf{g}(\\mathbf{k})$ 反平行：\n$$\\langle \\boldsymbol{\\sigma} \\rangle_- (\\mathbf{k}) = -\\frac{\\mathbf{g}(\\mathbf{k})}{|\\mathbf{g}(\\mathbf{k})|}$$\n这是一个单位矢量，因此当 $|\\mathbf{g}(\\mathbf{k})| \\neq 0$ 时，其大小为 $\\lVert \\langle \\boldsymbol{\\sigma} \\rangle_- (\\mathbf{k}) \\rVert = 1$。当自旋分裂消失时，即 $|\\mathbf{g}(\\mathbf{k})| = 0$，能带发生简并，自旋基是任意的。根据问题陈述，我们在这些简并点将自旋期望值定义为零矢量：$\\langle \\boldsymbol{\\sigma} \\rangle_-(\\mathbf{k}) = \\mathbf{0}$。当 $k_x$ 和 $k_y$ 是 $\\pi$ 的整数倍时会发生简并，这包括高对称点 $\\Gamma=(0,0)$、$X=(\\pi,0)$ 和 $M=(\\pi,\\pi)$。\n\n**路径和度量指标**\n数值程序涉及沿路径 $\\Gamma \\rightarrow X \\rightarrow M \\rightarrow \\Gamma$ 对布里渊区进行采样。\n- 段 1: $\\Gamma=(0,0)$ 到 $X=(\\pi,0)$。\n- 段 2: $X=(\\pi,0)$ 到 $M=(\\pi,\\pi)$。\n- 段 3: $M=(\\pi,\\pi)$ 到 $\\Gamma=(0,0)$。\n每段用 $128$ 个点进行采样，总共 $384$ 个点。对于每个采样的 $\\mathbf{k}$ 点，我们计算本征值和下能带的自旋期望矢量。根据这些值，我们计算三个总结指标：\n\n1.  **最大能带分裂 ($\\Delta_{\\max}$):** 分裂为 $\\Delta(\\mathbf{k}) = E_+(\\mathbf{k}) - E_-(\\mathbf{k}) = 2|\\mathbf{g}(\\mathbf{k})|$。我们计算路径上所有点 $\\mathbf{k}$ 的这个值，并找出最大值。\n$$ \\Delta_{\\max} = \\max_{\\mathbf{k} \\text{ on path}} \\left[ 4|t_R|\\sqrt{\\sin^2 k_x + \\sin^2 k_y} \\right] $$\n\n2.  **自旋-动量锁定关联 ($C_{\\mathrm{avg}}$):** 这个指标量化了自旋纹理与动量方向的对齐程度。对于每个点 $\\mathbf{k}$，我们计算 $C(\\mathbf{k}) = \\hat{\\mathbf{s}}_-(\\mathbf{k}) \\cdot (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{k}})$，其中 $\\hat{\\mathbf{s}}_-(\\mathbf{k})$ 是下能带自旋期望值的单位向量，$\\hat{\\mathbf{z}}=(0,0,1)$，$\\hat{\\mathbf{k}} = \\mathbf{k}/\\lVert \\mathbf{k} \\rVert$。如果 $|\\mathbf{g}(\\mathbf{k})|=0$（简并）或 $\\mathbf{k}=\\mathbf{0}$，对平均值的贡献取为零。最终的指标是所有 $384$ 个采样点的平均值。\n\n3.  **平均自旋大小 ($S_{\\mathrm{avg}}$):** 这是沿路径的下能带自旋期望值大小的平均值。\n$$ S_{\\mathrm{avg}} = \\frac{1}{N_{\\mathrm{samples}}} \\sum_{\\mathbf{k}} \\lVert \\langle \\boldsymbol{\\sigma} \\rangle_-(\\mathbf{k}) \\rVert $$\n由于对于非简并点 $\\lVert \\langle \\boldsymbol{\\sigma} \\rangle_- \\rVert$ 为 $1$，而对于简并点为 $0$，该指标有效地测量了路径上采样的非简并点的比例。\n\n所提供的 Python 代码为给定的测试用例实现了此程序。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes summary metrics for a tight-binding model with Rashba\n    spin-orbit coupling on a 2D square lattice.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.0),   # No Rashba coupling\n        (1.0, 0.2),   # Positive Rashba coupling\n        (1.0, -0.2),  # Negative Rashba coupling\n    ]\n\n    all_results = []\n    \n    # K-path definition\n    N_POINTS_PER_SEGMENT = 128\n    GAMMA = np.array([0.0, 0.0])\n    X = np.array([np.pi, 0.0])\n    M = np.array([np.pi, np.pi])\n\n    path_G_X = np.linspace(GAMMA, X, N_POINTS_PER_SEGMENT, endpoint=True)\n    path_X_M = np.linspace(X, M, N_POINTS_PER_SEGMENT, endpoint=True)\n    path_M_G = np.linspace(M, GAMMA, N_POINTS_PER_SEGMENT, endpoint=True)\n    \n    # The full path contains 3 * 128 = 384 k-points\n    k_path = np.vstack([path_G_X, path_X_M, path_M_G])\n    \n    # Numerical tolerance for checking if a value is zero\n    TOL = 1e-12\n\n    for t, tR in test_cases:\n        \n        path_band_splittings = []\n        path_spin_locking_correlations = []\n        path_spin_magnitudes = []\n\n        for k in k_path:\n            kx, ky = k\n            \n            # g-vector components\n            g_x = 2.0 * tR * np.sin(ky)\n            g_y = -2.0 * tR * np.sin(kx)\n            g_vec = np.array([g_x, g_y, 0.0])\n            g_norm = np.linalg.norm(g_vec)\n\n            # Metric 1: Band Splitting\n            band_splitting = 2.0 * g_norm\n            path_band_splittings.append(band_splitting)\n\n            # Lower-band spin expectation vector\n            if g_norm  TOL:\n                # Degenerate case\n                spin_vec_minus = np.array([0.0, 0.0, 0.0])\n            else:\n                # Non-degenerate case\n                spin_vec_minus = -g_vec / g_norm\n            \n            # Metric 3: Spin Magnitude\n            spin_mag = np.linalg.norm(spin_vec_minus)\n            path_spin_magnitudes.append(spin_mag)\n                \n            # Metric 2: Spin-Momentum Locking Correlation C(k)\n            k_norm = np.linalg.norm(k)\n            \n            # C(k) is zero at degenerate points (g_norm ~ 0) or at k=0 (k_norm ~ 0)\n            if g_norm  TOL or k_norm  TOL:\n                C_k = 0.0\n            else:\n                s_hat_minus = spin_vec_minus # Already normalized\n                k_hat = k / k_norm\n                \n                # In 2D, z_hat x k_hat = (-k_hat_y, k_hat_x, 0)\n                z_cross_k_hat = np.array([-k_hat[1], k_hat[0], 0.0])\n                \n                C_k = np.dot(s_hat_minus, z_cross_k_hat)\n            \n            path_spin_locking_correlations.append(C_k)\n\n        # Calculate final metrics for the current test case\n        max_band_splitting = np.max(path_band_splittings)\n        avg_spin_locking = np.mean(path_spin_locking_correlations)\n        avg_spin_magnitude = np.mean(path_spin_magnitudes)\n        \n        all_results.extend([max_band_splitting, avg_spin_locking, avg_spin_magnitude])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}