{
    "hands_on_practices": [
        {
            "introduction": "This first exercise focuses on the foundational physics of the Franz-Keldysh effect in bulk semiconductors. By deriving and calculating the characteristic electro-optic energy, you will gain a quantitative understanding of the energy scale that governs both the below-gap absorption tail and the period of the oscillations above the bandgap. This calculation  is a cornerstone for analyzing any electro-absorption phenomenon.",
            "id": "3745688",
            "problem": "Consider bulk Indium Phosphide (InP) under a uniform static electric field $F$ applied along the growth direction. Near the fundamental band edge, interband optical absorption in a uniform field is governed by the effective-mass relative-motion Schrödinger equation for the electron-hole pair with reduced mass $m_r$ in a linear potential. Starting from the one-dimensional effective-mass Schrödinger equation for the relative coordinate $x$,\n$$\n-\\frac{\\hbar^{2}}{2 m_{r}}\\,\\frac{d^{2}\\psi(x)}{dx^{2}} - e F x\\,\\psi(x) = E\\,\\psi(x),\n$$\nwhere $E \\equiv \\hbar\\omega - E_g$ is the photon energy measured relative to the band edge $E_g$, derive the characteristic energy scale that sets the spacing of Franz–Keldysh (Keldysh) oscillations above $E_g$, expressed in terms of $e$, $F$, $\\hbar$, and $m_r$. Then evaluate this characteristic spacing for InP at photon energy $\\hbar\\omega = E_g + 100\\,\\mathrm{meV}$ with $m_r = 0.07\\,m_0$ and $F = 200\\,\\mathrm{kV/cm}$. Use $m_0 = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$, $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, and $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$. Treat the oscillation spacing as set by this characteristic energy scale and independent of the detuning to leading order. Round your final numerical answer to four significant figures and express it in $\\mathrm{meV}$.",
            "solution": "The problem asks for the characteristic energy scale of Franz-Keldysh oscillations in bulk Indium Phosphide (InP) under a uniform electric field $F$. This energy scale can be derived from the one-dimensional effective-mass Schrödinger equation for the electron-hole relative motion provided in the problem statement:\n$$\n-\\frac{\\hbar^{2}}{2 m_{r}}\\,\\frac{d^{2}\\psi(x)}{dx^{2}} - e F x\\,\\psi(x) = E\\,\\psi(x)\n$$\nHere, $E = \\hbar\\omega - E_g$ is the photon energy relative to the bandgap energy $E_g$, $m_r$ is the reduced mass of the electron-hole pair, $e$ is the elementary charge, and $\\hbar$ is the reduced Planck constant.\n\nFirst, we rearrange the Schrödinger equation into a more standard form:\n$$\n\\frac{d^{2}\\psi(x)}{dx^{2}} + \\frac{2 m_{r}}{\\hbar^{2}}(E + e F x)\\,\\psi(x) = 0\n$$\nThis is a second-order linear ordinary differential equation with a linearly varying coefficient. It can be transformed into the Airy differential equation, which has the canonical form $\\frac{d^2y(z)}{dz^2} - z y(z) = 0$. To do this, we introduce a dimensionless variable $z$ through a suitable change of variables. Let's define a new variable $u = x + \\frac{E}{eF}$. The equation becomes:\n$$\n\\frac{d^{2}\\psi}{du^{2}} + \\frac{2 m_{r} e F}{\\hbar^{2}} u\\,\\psi(u) = 0\n$$\nNow, we introduce a dimensionless variable $z$ by scaling $u$. Let $z = c u$, where $c$ is a scaling constant. Then $u=z/c$ and $\\frac{d}{du} = c \\frac{d}{dz}$, which implies $\\frac{d^2}{du^2} = c^2 \\frac{d^2}{dz^2}$. Substituting these into the equation gives:\n$$\nc^2 \\frac{d^{2}\\psi}{dz^{2}} + \\frac{2 m_{r} e F}{\\hbar^{2}} \\frac{z}{c}\\,\\psi(z) = 0\n$$\n$$\n\\frac{d^{2}\\psi}{dz^{2}} + \\frac{2 m_{r} e F}{c^3 \\hbar^{2}} z\\,\\psi(z) = 0\n$$\nTo match the standard Airy equation form (up to a sign), we can choose the coefficient of $z$ to be $\\pm 1$. Let's define a scaling factor based on the physical parameters. From the equation $\\frac{d^{2}\\psi}{du^{2}} + \\left(\\frac{2 m_{r} e F}{\\hbar^{2}}\\right) u\\,\\psi = 0$, we can identify a characteristic length scale, $L_F$, from the coefficient of $u$, which must have units of length$^{-3}$.\n$$\nL_F^{-3} = \\frac{2 m_{r} e F}{\\hbar^{2}} \\implies L_F = \\left(\\frac{\\hbar^2}{2 m_r e F}\\right)^{1/3}\n$$\nThe characteristic energy of the Franz-Keldysh effect, often denoted $\\hbar\\theta_F$, is the potential energy gained by a charge $e$ over this characteristic length $L_F$ in the electric field $F$.\n$$\n\\hbar\\theta_F = e F L_F = e F \\left(\\frac{\\hbar^2}{2 m_r e F}\\right)^{1/3}\n$$\nBy bringing the $eF$ term inside the cubic root, we obtain the final expression for the characteristic energy:\n$$\n\\hbar\\theta_F = \\left( (eF)^3 \\frac{\\hbar^2}{2 m_r e F} \\right)^{1/3} = \\left(\\frac{e^2 F^2 \\hbar^2}{2 m_r}\\right)^{1/3}\n$$\nThis energy $\\hbar\\theta_F$ sets the scale for the exponential absorption tail below the bandgap ($E  0$) and is of the order of the energy spacing between the Franz-Keldysh oscillations above the bandgap ($E > 0$). The problem asks for this characteristic energy scale as the spacing. The provided value of $E = \\hbar\\omega - E_g = 100\\,\\mathrm{meV}$ simply confirms that we are in the oscillatory regime above the band edge, but the characteristic energy scale itself is independent of $E$.\n\nNext, we evaluate this quantity numerically using the provided values in SI units:\n- Elementary charge, $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- Electric field, $F = 200\\,\\mathrm{kV/cm} = 200 \\times 10^3\\,\\mathrm{V} / (10^{-2}\\,\\mathrm{m}) = 2 \\times 10^7\\,\\mathrm{V/m}$\n- Reduced Planck constant, $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$\n- Reduced mass, $m_r = 0.07\\,m_0 = 0.07 \\times 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg} = 6.37656859 \\times 10^{-32}\\,\\mathrm{kg}$\n\nWe compute the term inside the cube root, $(\\hbar\\theta_F)^3$:\n$$\n(\\hbar\\theta_F)^3 = \\frac{e^2 F^2 \\hbar^2}{2 m_r} = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2 (2 \\times 10^7\\,\\mathrm{V/m})^2 (1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s})^2}{2 \\times (6.37656859 \\times 10^{-32}\\,\\mathrm{kg})}\n$$\nNumerator: $e^2 F^2 \\hbar^2 = (2.5669700 \\times 10^{-38}) \\times (4 \\times 10^{14}) \\times (1.1121173 \\times 10^{-68}) \\approx 1.1419134 \\times 10^{-91}\\,\\mathrm{J^4 s^2 m^{-2}}$\nDenominator: $2 m_r = 2 \\times 6.37656859 \\times 10^{-32}\\,\\mathrm{kg} = 1.2753137 \\times 10^{-31}\\,\\mathrm{kg}$\n$$\n(\\hbar\\theta_F)^3 = \\frac{1.1419134 \\times 10^{-91}}{1.2753137 \\times 10^{-31}} \\approx 8.953994 \\times 10^{-61}\\,\\mathrm{J^3}\n$$\nNow, we take the cube root to find the characteristic energy in Joules:\n$$\n\\hbar\\theta_F = (8.953994 \\times 10^{-61}\\,\\mathrm{J^3})^{1/3} \\approx 9.63850 \\times 10^{-21}\\,\\mathrm{J}\n$$\nFinally, we convert this energy to units of milli-electron-volts ($\\mathrm{meV}$) and round to four significant figures.\n$$\n1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J} \\implies 1\\,\\mathrm{meV} = 1.602176634 \\times 10^{-22}\\,\\mathrm{J}\n$$\n$$\n\\hbar\\theta_F (\\mathrm{in\\,meV}) = \\frac{9.63850 \\times 10^{-21}\\,\\mathrm{J}}{1.602176634 \\times 10^{-22}\\,\\mathrm{J/meV}} \\approx 60.15848\\,\\mathrm{meV}\n$$\nRounding to four significant figures, we get $60.16\\,\\mathrm{meV}$.",
            "answer": "$$\n\\boxed{60.16}\n$$"
        },
        {
            "introduction": "Moving from bulk materials to nanostructures, this practice explores the Quantum-Confined Stark Effect (QCSE) in a quantum well. You will use a physically intuitive model to estimate the critical electric field required to ionize an exciton, the bound electron-hole pair that dominates optical absorption in high-quality quantum wells. This exercise  demonstrates how material properties and quantum confinement dictate the field strength needed to modulate a material's optical properties.",
            "id": "3745684",
            "problem": "A narrow semiconductor quantum well that supports a bound electron–hole pair (an exciton) is subjected to a uniform electric field along the growth axis. Assume the well width is sufficiently small that the relative electron–hole motion is effectively two-dimensional in the plane, and that the Coulomb interaction is well described by the statically screened potential with dielectric permittivity $ \\varepsilon = \\varepsilon_{r} \\varepsilon_{0} $ and electron–hole reduced mass $ \\mu $ from the effective-mass approximation. Treat the exciton within the hydrogenic model for two dimensions and estimate the field at which ionization occurs by equating the electrostatic work across the characteristic in-plane size to the binding energy, i.e., $ e F_{c} a \\sim E_{b} $, where $ e $ is the elementary charge, $ F_{c} $ is the critical field, $ a $ is a characteristic exciton radius, and $ E_{b} $ is the exciton binding energy.\n\nUse only the following well-tested facts as your starting point:\n- The effective Bohr radius and effective Rydberg in the effective-mass approximation are $ a_{B}^{*} = \\dfrac{4 \\pi \\varepsilon \\hbar^{2}}{\\mu e^{2}} $ and $ R^{*} = \\dfrac{\\mu e^{4}}{2 (4 \\pi \\varepsilon)^{2} \\hbar^{2}} $, respectively.\n- For the ground state of an ideal two-dimensional exciton in a narrow quantum well, the binding energy and characteristic radius scale as $ E_{b} = 4 R^{*} $ and $ a = \\dfrac{a_{B}^{*}}{2} $.\n\nStarting from these facts and the ionization criterion $ e F_{c} a \\sim E_{b} $, derive a closed-form expression for $ F_{c} $ explicitly in terms of $ \\mu $, $ \\varepsilon $, $ e $, and $ \\hbar $. Your derivation should make clear how $ F_{c} $ scales with material parameters, thereby elucidating the material dependence relevant to the quantum-confined Stark effect (QCSE). Express the final field in SI units of volts per meter (V/m). Do not insert any numerical values; provide a symbolic expression only.",
            "solution": "The task is to derive an expression for the critical electric field, $F_c$, at which an exciton in a narrow quantum well ionizes. The problem provides an estimation criterion for this ionization process, which relates the work done by the electric field across the exciton's characteristic size to its binding energy.\n\nThe given ionization criterion is:\n$$e F_{c} a \\sim E_{b}$$\nwhere $e$ is the elementary charge, $a$ is the characteristic exciton radius, and $E_b$ is the exciton binding energy. We will treat the approximate relation `~` as an equality to derive a closed-form expression for $F_c$, as requested.\n$$e F_{c} a = E_{b}$$\nFrom this criterion, the critical field $F_c$ can be expressed as:\n$$F_c = \\frac{E_b}{e a}$$\n\nThe problem states that for an ideal two-dimensional exciton, the binding energy $E_b$ and characteristic radius $a$ are given by:\n$$E_{b} = 4 R^{*}$$\n$$a = \\frac{a_{B}^{*}}{2}$$\nHere, $R^*$ is the effective Rydberg energy and $a_{B}^{*}$ is the effective Bohr radius for the three-dimensional system, which are defined as:\n$$R^{*} = \\dfrac{\\mu e^{4}}{2 (4 \\pi \\varepsilon)^{2} \\hbar^{2}}$$\n$$a_{B}^{*} = \\dfrac{4 \\pi \\varepsilon \\hbar^{2}}{\\mu e^{2}}$$\nIn these expressions, $\\mu$ is the electron-hole reduced mass, $\\varepsilon$ is the dielectric permittivity of the material, and $\\hbar$ is the reduced Planck constant.\n\nSubstituting the expressions for $E_b$ and $a$ into the equation for $F_c$:\n$$F_c = \\frac{4 R^{*}}{e \\left(\\frac{a_{B}^{*}}{2}\\right)} = \\frac{8 R^{*}}{e a_{B}^{*}}$$\n\nTo express $F_c$ solely in terms of the fundamental parameters ($\\mu$, $\\varepsilon$, $e$, $\\hbar$), we substitute the definitions of $R^*$ and $a_B^*$. A more elegant intermediate step involves expressing $R^*$ in terms of $a_B^*$. By inspecting the definitions of $R^*$ and $a_B^*$, we can see that:\n$$R^{*} = \\frac{e^2}{8 \\pi \\varepsilon a_{B}^{*}}$$\nThis relation can be verified by substituting the expression for $a_B^*$ into the right-hand side:\n$$\\frac{e^2}{8 \\pi \\varepsilon} \\left( \\frac{1}{a_{B}^{*}} \\right) = \\frac{e^2}{8 \\pi \\varepsilon} \\left( \\frac{\\mu e^2}{4 \\pi \\varepsilon \\hbar^2} \\right) = \\frac{\\mu e^4}{32 \\pi^2 \\varepsilon^2 \\hbar^2} = \\frac{\\mu e^4}{2 (16 \\pi^2 \\varepsilon^2) \\hbar^2} = \\frac{\\mu e^4}{2 (4 \\pi \\varepsilon)^2 \\hbar^2} = R^{*}$$\nThe relation is confirmed to be correct.\n\nNow, we substitute this simplified expression for $R^*$ into our equation for $F_c$:\n$$F_c = \\frac{8}{e a_{B}^{*}} \\left( \\frac{e^2}{8 \\pi \\varepsilon a_{B}^{*}} \\right)$$\n$$F_c = \\frac{e}{\\pi \\varepsilon (a_{B}^{*})^2}$$\nThis intermediate result provides clear physical insight: the critical ionization field is proportional to the elementary charge and inversely proportional to the material's dielectric permittivity and the square of the effective Bohr radius.\n\nFinally, to obtain the expression in terms of the specified fundamental parameters, we substitute the definition of $a_{B}^{*}$ into this equation:\n$$F_c = \\frac{e}{\\pi \\varepsilon} \\left( \\frac{1}{\\frac{4 \\pi \\varepsilon \\hbar^{2}}{\\mu e^{2}}} \\right)^2$$\n$$F_c = \\frac{e}{\\pi \\varepsilon} \\left( \\frac{\\mu e^2}{4 \\pi \\varepsilon \\hbar^2} \\right)^2$$\nExpanding the squared term:\n$$F_c = \\frac{e}{\\pi \\varepsilon} \\frac{\\mu^2 e^4}{(4 \\pi \\varepsilon)^2 \\hbar^4} = \\frac{e}{\\pi \\varepsilon} \\frac{\\mu^2 e^4}{16 \\pi^2 \\varepsilon^2 \\hbar^4}$$\nCombining the terms yields the final expression for the critical field $F_c$:\n$$F_c = \\frac{\\mu^2 e^5}{16 \\pi^3 \\varepsilon^3 \\hbar^4}$$\nThis expression shows how the critical field for exciton ionization scales with the material parameters. Specifically, $F_c \\propto \\mu^2$ and $F_c \\propto \\varepsilon^{-3}$. Materials with a larger electron-hole reduced mass $\\mu$ form more tightly bound excitons, requiring a stronger field for ionization. Conversely, materials with a higher dielectric permittivity $\\varepsilon$ exhibit stronger screening of the Coulomb interaction, leading to a weakly bound exciton that is much more easily ionized by a weaker electric field. The dimensional analysis confirms that this expression yields units of electric field (Volts per meter).",
            "answer": "$$\\boxed{\\frac{\\mu^{2} e^{5}}{16 \\pi^{3} \\varepsilon^{3} \\hbar^{4}}}$$"
        },
        {
            "introduction": "This final practice bridges theory and practical application by guiding you through the construction of a computational model for the Franz-Keldysh effect. You will implement the Airy function-based spectrum and incorporate the crucial real-world effect of temperature-dependent broadening. By simulating the FKE spectrum and calculating the oscillation visibility under different conditions , you will develop skills essential for designing and predicting the performance of semiconductor electro-optic devices.",
            "id": "3745686",
            "problem": "You are asked to design and implement a computational model for the Franz-Keldysh effect (FKE), which is the electro-absorption modulation in a direct-gap semiconductor subjected to a uniform static electric field. The objective is to compute the temperature dependence of oscillation visibility in the FKE spectrum, using a phenomenological dephasing rate model. Your program must derive its modeling equations from a fundamental base, implement the resulting numerical model, and produce quantitative results for a specified test suite.\n\nStarting point and assumptions:\n- Consider a direct-gap semiconductor with two parabolic bands (conduction and valence), characterized by electron effective mass $m_e^\\ast$ and hole effective mass $m_h^\\ast$. The reduced mass is $\\mu = \\dfrac{m_e^\\ast m_h^\\ast}{m_e^\\ast + m_h^\\ast}$.\n- Assume a uniform and static electric field $F$ applied along one spatial direction, and model the linear optical response using interband transitions and the semiclassical acceleration theorem within the effective mass approximation.\n- Let the bandgap energy be $E_g$; photon energy is $E$ (expressed in $\\mathrm{eV}$).\n- Model dephasing as a phenomenological homogeneous broadening rate $\\gamma(T) = \\gamma_0 + a T$, with temperature $T$ expressed in $\\mathrm{K}$ and $\\gamma$ in $\\mathrm{s^{-1}}$.\n- In the time domain, dephasing enters as an exponential factor $\\exp(-\\gamma t)$ multiplying the interband polarization response; in the frequency (energy) domain, this corresponds to a convolution of the field-modified spectrum with a Lorentzian of half-width at half-maximum $\\Gamma = \\hbar \\gamma$, where $\\hbar$ is the reduced Planck constant.\n\nDefinitions and tasks:\n1. Derive from first principles a normalized field-modified spectral response function $S_0(E)$ that exhibits Franz-Keldysh oscillations above the band edge. Use the physically justified Airy-integral representation inherent to a uniform field in the effective mass approximation, and restrict to a one-dimensional model to obtain a tractable analytic form for $S_0(E)$ sufficient to capture oscillatory behavior. Express the characteristic electro-optic energy scale $E_F$ in terms of the applied field $F$, reduced mass $\\mu$, and fundamental constants. All energies in your computation must be expressed in $\\mathrm{eV}$.\n2. Incorporate dephasing by convolving $S_0(E)$ with a Lorentzian kernel $L(\\Delta E; \\Gamma)$, where $\\Gamma = \\hbar \\gamma(T)$ is expressed in $\\mathrm{eV}$ and $L(\\Delta E; \\Gamma) = \\dfrac{1}{\\pi}\\dfrac{\\Gamma}{\\Delta E^2 + \\Gamma^2}$.\n3. Define and compute the oscillation visibility $V$ over a specified energy window above the band edge. For a chosen window $[E_g + \\Delta E_{\\min}, E_g + \\Delta E_{\\max}]$, identify the first local maximum $S_{\\max}$ and the first subsequent local minimum $S_{\\min}$ of the broadened spectrum $S(E)$, and compute the visibility as $V = \\dfrac{S_{\\max} - S_{\\min}}{S_{\\max} + S_{\\min}}$. If a suitable pair $(S_{\\max}, S_{\\min})$ cannot be found within the window due to strong damping, define $V = 0.0$.\n4. Use the following fixed physical parameters (scientifically realistic and self-consistent):\n   - Bandgap: $E_g = 1.55\\,\\mathrm{eV}$.\n   - Electron effective mass: $m_e^\\ast = 0.067\\,m_0$.\n   - Hole effective mass: $m_h^\\ast = 0.45\\,m_0$.\n   - Free-electron mass: $m_0 = 9.10938356\\times 10^{-31}\\,\\mathrm{kg}$.\n   - Elementary charge: $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$.\n   - Reduced Planck constant: $\\hbar = 1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$ and $\\hbar = 6.582119569\\times 10^{-16}\\,\\mathrm{eV\\cdot s}$ (use consistent unit conversions).\n   - Dephasing parameters: $\\gamma_0 = 5.0\\times 10^{11}\\,\\mathrm{s^{-1}}$, $a = 2.0\\times 10^{9}\\,\\mathrm{s^{-1}\\cdot K^{-1}}$.\n   - Spectral energy grid: $E \\in [E_g - 0.05\\,\\mathrm{eV}, E_g + 0.25\\,\\mathrm{eV}]$ sampled uniformly with step $\\Delta E = 1.0\\times 10^{-3}\\,\\mathrm{eV}$.\n   - Visibility window: $\\Delta E_{\\min} = 0.01\\,\\mathrm{eV}$, $\\Delta E_{\\max} = 0.20\\,\\mathrm{eV}$.\n5. The Franz-Keldysh effect (FKE) oscillations are controlled by the electro-optic energy scale $E_F$ that depends on $F$ and $\\mu$. Derive $E_F$ and express it numerically in $\\mathrm{eV}$ as a function of $F$ (in $\\mathrm{V/m}$) and $\\mu$ (in $\\mathrm{kg}$).\n6. Implement your model to compute the visibility $V$ for the test suite below. Ensure numerical stability of peak detection in the specified window. If necessary, use a minimal peak prominence threshold that scales with the spectral median in the window. Explicitly state and justify any numerical thresholds or heuristics used.\n\nTest suite:\n- Case $1$ (happy path): $T = 77\\,\\mathrm{K}$, $F = 2.0\\times 10^{7}\\,\\mathrm{V/m}$, return $V$ as a float.\n- Case $2$ (high temperature): $T = 300\\,\\mathrm{K}$, $F = 2.0\\times 10^{7}\\,\\mathrm{V/m}$, return $V$ as a float.\n- Case $3$ (boundary low dephasing): $T = 0\\,\\mathrm{K}$, $F = 2.0\\times 10^{7}\\,\\mathrm{V/m}$, return $V$ as a float.\n- Case $4$ (strong field): $T = 300\\,\\mathrm{K}$, $F = 5.0\\times 10^{7}\\,\\mathrm{V/m}$, return $V$ as a float.\n\nFinal output specification:\n- Your program must produce a single line containing a comma-separated Python list of the four visibilities in the order of the test suite, for example $[v_1,v_2,v_3,v_4]$.\n- Each $v_i$ must be a floating-point number. No additional text or lines are permitted in the output.\n- All energies must be handled and reported in $\\mathrm{eV}$, dephasing rates in $\\mathrm{s^{-1}}$, electric fields in $\\mathrm{V/m}$, and temperature in $\\mathrm{K}$. The visibilities are dimensionless.",
            "solution": "The problem asks for the design and implementation of a computational model to calculate the temperature-dependent visibility of Franz-Keldysh oscillations in a direct-gap semiconductor. This requires deriving the physical model, implementing it numerically, and applying it to a specific set of test cases.\n\n### Principle-Based Design\n\nThe solution is developed by following a sequence of steps, starting from the fundamental quantum mechanics of an electron-hole pair in an electric field and culminating in a numerical algorithm to compute the desired observable, the oscillation visibility.\n\n#### 1. Ideal Spectral Response and Electro-Optic Energy\n\nThe Franz-Keldysh effect (FKE) modifies the optical absorption spectrum near the band edge of a semiconductor under an external electric field $F$. We begin with the one-dimensional effective mass Schrödinger equation for the relative motion of an electron-hole pair, with reduced mass $\\mu = \\frac{m_e^\\ast m_h^\\ast}{m_e^\\ast + m_h^\\ast}$, in the presence of the field:\n$$ -\\frac{\\hbar^2}{2\\mu} \\frac{d^2\\psi(z)}{dz^2} - eFz \\psi(z) = E_{rel} \\psi(z) $$\nHere, $z$ is the relative coordinate along the field, $e$ is the elementary charge, $\\hbar$ is the reduced Planck constant, and $E_{rel} = E - E_g$ is the energy of the absorbed photon $E$ relative to the semiconductor bandgap $E_g$.\n\nThis equation can be transformed into the standard form of the Airy differential equation, $y''(x) - xy(x) = 0$, by a change of variables. The physically appropriate, bounded solution is the Airy function of the first kind, $\\mathrm{Ai}(x)$. The argument $x$ is a dimensionless energy, given by:\n$$ x = \\frac{E_g - E}{E_F} $$\nThe term $E_F$ is the characteristic electro-optic energy, which sets the energy scale of the FKE. Its derivation from the change of variables yields:\n$$ E_F = \\left( \\frac{(eF\\hbar)^2}{2\\mu} \\right)^{1/3} $$\nThis crucial parameter dictates the period of the Franz-Keldysh oscillations.\n\nThe optical absorption is proportional to the field-modified joint density of states. A physically justified expression for the spectral response function $S_0(E)$, which is proportional to the imaginary part of the dielectric function, is given in terms of the Airy function and its first derivative:\n$$ S_0(E) = C \\left[ \\mathrm{Ai}'(x)^2 - x \\mathrm{Ai}(x)^2 \\right] $$\nwhere $C$ is a proportionality constant. For $E > E_g$, $x$ is negative, causing the Airy functions to oscillate and giving rise to the characteristic absorption oscillations above the bandgap. Since the final quantity, visibility, is a ratiometric measure, the constant $C$ can be set to $1$ without loss of generality. This function $S_0(E)$ represents the ideal, undamped spectral response.\n\n#### 2. Incorporation of Dephasing and Spectral Broadening\n\nIn a real system, scattering processes lead to dephasing, which shortens the coherence lifetime of the electron-hole pair. This is modeled phenomenologically by a temperature-dependent dephasing rate $\\gamma(T) = \\gamma_0 + aT$. In the energy domain, this lifetime limitation manifests as a spectral broadening. The broadened spectrum $S(E)$ is obtained by convolving the ideal spectrum $S_0(E)$ with a Lorentzian function $L(\\Delta E; \\Gamma)$, which is the Fourier transform of the exponential temporal decay:\n$$ S(E) = (S_0 * L)(E) = \\int_{-\\infty}^{\\infty} S_0(E') L(E - E'; \\Gamma) dE' $$\nThe Lorentzian kernel is defined as:\n$$ L(\\Delta E; \\Gamma) = \\frac{1}{\\pi} \\frac{\\Gamma}{\\Delta E^2 + \\Gamma^2} $$\nThe Half-Width at Half-Maximum (HWHM) of the broadening, $\\Gamma$, is directly related to the dephasing rate by $\\Gamma = \\hbar\\gamma(T)$, and must be expressed in units of energy (eV). This convolution smooths the sharp features of $S_0(E)$, reducing the amplitude of the oscillations, particularly at higher temperatures where $\\gamma(T)$ and thus $\\Gamma$ are larger.\n\n#### 3. Oscillation Visibility and Numerical Algorithm\n\nThe visibility $V$ quantifies the prominence of the oscillations. It is calculated within a specified energy window $[E_g + \\Delta E_{\\min}, E_g + \\Delta E_{\\max}]$. Within this window, we must identify the first local maximum $S_{\\max}$ and the first subsequent local minimum $S_{\\min}$ of the broadened spectrum $S(E)$. The visibility is then given by the Michelson contrast formula:\n$$ V = \\frac{S_{\\max} - S_{\\min}}{S_{\\max} + S_{\\min}} $$\nIf oscillations are so damped that a distinct maximum-minimum pair cannot be found, the visibility is defined to be $V=0.0$.\n\nThe algorithmic implementation proceeds as follows:\n1.  **Initialization**: Define all given physical constants ($m_0, e, \\hbar$), material parameters ($E_g, m_e^\\ast, m_h^\\ast$), and model parameters ($\\gamma_0, a$).\n2.  **Parameter Calculation**: For each test case $(T, F)$, calculate the derived parameters: the reduced mass $\\mu$, the electro-optic energy $E_F$ (in eV), and the broadening width $\\Gamma$ (in eV).\n3.  **Grid Setup**: Create a uniform energy grid $E$ with the specified range and step size $\\Delta E$.\n4.  **Ideal Spectrum Generation**: Calculate the ideal spectrum $S_0(E)$ on the grid using the `scipy.special.airy` function to obtain $\\mathrm{Ai}(x)$ and $\\mathrm{Ai}'(x)$.\n5.  **Broadening via Convolution**:\n    - Discretize the Lorentzian kernel $L(\\Delta E, \\Gamma)$ on an auxiliary grid with the same step size $\\Delta E$.\n    - Perform a numerical convolution of $S_0(E)$ and $L(\\Delta E, \\Gamma)$ using `numpy.convolve` with `mode='same'`. The result is scaled by the grid step $\\Delta E$ to correctly approximate the convolution integral.\n6.  **Visibility Computation**:\n    - Isolate the portion of the broadened spectrum $S(E)$ that falls within the visibility window.\n    - Use `scipy.signal.find_peaks` to locate maxima (on $S(E)$) and minima (on $-S(E)$). To ensure robustness against numerical noise, a prominence threshold is employed. The threshold is set to $1\\%$ of the median of the signal within the window, a heuristic that adaptively scales with the signal strength.\n    - Identify the first peak and the first subsequent valley. If this pair exists, calculate $V$. Otherwise, set $V=0.0$.\n7.  **Aggregation**: The calculated visibility values for all test cases are collected and formatted into the required output string.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import airy\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Solves the Franz-Keldysh effect problem by modeling the spectrum\n    and calculating oscillation visibility for a given set of test cases.\n    \"\"\"\n\n    # --- Physical Constants (as specified in the problem) ---\n    M0 = 9.10938356e-31        # Free-electron mass in kg\n    E_CHARGE = 1.602176634e-19 # Elementary charge in C\n    HBAR_JS = 1.054571817e-34    # Reduced Planck constant in J*s\n    HBAR_EVS = 6.582119569e-16  # Reduced Planck constant in eV*s\n\n    # --- Material and Model Parameters ---\n    EG = 1.55                  # Bandgap in eV\n    ME_STAR_FACTOR = 0.067     # Electron effective mass factor\n    MH_STAR_FACTOR = 0.45      # Hole effective mass factor\n    GAMMA0 = 5.0e11            # Dephasing parameter gamma_0 in s^-1\n    A_DEPHASING = 2.0e9        # Dephasing parameter 'a' in s^-1*K^-1\n\n    # --- Numerical Grid and Window Parameters ---\n    E_GRID_START_OFFSET = -0.05  # eV\n    E_GRID_END_OFFSET = 0.25     # eV\n    DE_GRID_STEP = 1.0e-3        # eV\n    VISIBILITY_WINDOW_MIN = 0.01 # eV above Eg\n    VISIBILITY_WINDOW_MAX = 0.20 # eV above Eg\n\n    def calculate_visibility(T, F):\n        \"\"\"\n        Calculates the Franz-Keldysh oscillation visibility for a given\n        temperature T (in K) and electric field F (in V/m).\n        \"\"\"\n        # 1. Calculate derived physical parameters\n        me_star = ME_STAR_FACTOR * M0\n        mh_star = MH_STAR_FACTOR * M0\n        mu = (me_star * mh_star) / (me_star + mh_star)\n\n        # Electro-optic energy E_F in Joules, then converted to eV\n        ef_j = ((E_CHARGE * F * HBAR_JS)**2 / (2 * mu))**(1/3.0)\n        ef_ev = ef_j / E_CHARGE\n\n        # Broadening parameter Gamma in eV\n        gamma_t = GAMMA0 + A_DEPHASING * T\n        gamma_ev = HBAR_EVS * gamma_t\n\n        # 2. Set up the energy grid\n        e_grid = np.arange(EG + E_GRID_START_OFFSET, EG + E_GRID_END_OFFSET, DE_GRID_STEP)\n\n        # 3. Calculate the ideal Franz-Keldysh spectrum S0(E)\n        x = (EG - e_grid) / ef_ev\n        ai, aip, _, _ = airy(x)\n        s0 = aip**2 - x * ai**2\n\n        # 4. Perform convolution with a Lorentzian kernel\n        # Kernel is defined over a fixed range, wide enough for all cases.\n        kernel_range = 0.05  # eV\n        kernel_e = np.arange(-kernel_range, kernel_range + DE_GRID_STEP, DE_GRID_STEP)\n        lorentzian_kernel = (1/np.pi) * gamma_ev / (kernel_e**2 + gamma_ev**2)\n        \n        s_broad = np.convolve(s0, lorentzian_kernel, mode='same') * DE_GRID_STEP\n\n        # 5. Compute visibility V\n        e_vis_min = EG + VISIBILITY_WINDOW_MIN\n        e_vis_max = EG + VISIBILITY_WINDOW_MAX\n\n        # Get indices for the visibility window\n        vis_indices = np.where((e_grid >= e_vis_min)  (e_grid = e_vis_max))[0]\n        if len(vis_indices)  3: # Need at least 3 points to find a peak\n            return 0.0\n            \n        s_window = s_broad[vis_indices]\n\n        # Heuristic for peak prominence:\n        # The prominence is set to 1% of the median signal strength in the window.\n        # This adaptive threshold reliably identifies physically significant\n        # oscillations while filtering numerical artifacts. The median is a\n        # robust measure, making the threshold insensitive to outliers.\n        median_signal = np.median(s_window)\n        prominence_threshold = 0.01 * median_signal if median_signal > 0 else None\n        \n        # Find the first maximum and the subsequent minimum\n        max_indices, _ = find_peaks(s_window, prominence=prominence_threshold)\n        min_indices, _ = find_peaks(-s_window, prominence=prominence_threshold)\n\n        if len(max_indices) == 0:\n            return 0.0\n\n        first_max_local_idx = max_indices[0]\n        subsequent_min_indices = min_indices[min_indices > first_max_local_idx]\n\n        if len(subsequent_min_indices) == 0:\n            return 0.0\n\n        first_min_local_idx = subsequent_min_indices[0]\n\n        s_max = s_window[first_max_local_idx]\n        s_min = s_window[first_min_local_idx]\n\n        if s_max + s_min = 1e-9: # Avoid division by zero/small numbers\n            return 0.0\n            \n        visibility = (s_max - s_min) / (s_max + s_min)\n        return visibility\n\n    # --- Test Suite Execution ---\n    test_cases = [\n        (77.0, 2.0e7),   # Case 1: happy path\n        (300.0, 2.0e7),  # Case 2: high temperature\n        (0.0, 2.0e7),    # Case 3: boundary low dephasing\n        (300.0, 5.0e7)   # Case 4: strong field\n    ]\n\n    results = []\n    for T, F in test_cases:\n        visibility = calculate_visibility(T, F)\n        results.append(visibility)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.7f}' for v in results)}]\")\n\nsolve()\n```"
        }
    ]
}