{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习是一个基础的“纸上推演”问题，旨在建立您对自热现象的物理直觉。我们将一个简化的、具有均匀热量生成的一维半导体区域作为模型，从第一性原理出发推导其稳态温度分布。通过求解这个典型案例的热方程 ，您将具体理解热量生成与热传导如何相互平衡并最终形成温度分布，以及几何和材料属性如何决定峰值温度。",
            "id": "3771070",
            "problem": "一个均匀偏置的半导体器件区域可以建模为一个一维（1D）晶体材料板，其在 $x$ 方向上的厚度为 $d$，其中 $0 \\le x \\le d$。在偏置下，局域焦耳热会产生均匀的体积生热密度 $q$（单位体积的功率）。假设声子主导的、与温度无关的热导率 $k$，无内部对流或辐射，并且两面都有完美的热接触，使得边界温度在 $x=0$ 和 $x=d$ 处固定为 $T_0$。在稳态下，温度场 $T(x)$ 是由热传导和内部生热之间的平衡产生的。\n\n仅从稳态热传导的能量守恒和 Fourier 热传导定律出发，推导板中的稳态温度分布 $T(x)$。然后，确定高于边界温度 $T_0$ 的最大温升，并以包含 $q$、$d$ 和 $k$ 的单一闭式解析表达式给出。以开尔文（K）表示最终的最大温升。中间量和最终表达式均不进行四舍五入。仅报告最大温升作为最终答案。",
            "solution": "首先将根据指定标准对用户提供的问题进行验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n- **系统**：一维（$1$D）晶体材料板。\n- **几何**：在 $x$ 方向上的厚度为 $d$，域为 $0 \\le x \\le d$。\n- **热源**：均匀的体积生热密度 $q$（单位体积的功率）。\n- **材料属性**：声子主导的、与温度无关的热导率 $k$。\n- **传热机制**：仅考虑传导；无内部对流或辐射。\n- **边界条件**：两面的温度是固定的。$T(x=0) = T_0$ 和 $T(x=d) = T_0$。\n- **状态**：稳态。\n- **目标**：从能量守恒和 Fourier 定律出发，推导稳态温度分布 $T(x)$。然后，确定高于 $T_0$ 的最大温升，记为 $\\Delta T_{max}$，并以包含 $q$、$d$ 和 $k$ 的单一闭式表达式给出。最终答案应为此最大温升。\n\n#### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是带有恒定源项的稳态热扩散方程的经典应用。这是传热学中的一个基本问题，其理论基础牢固地建立在热力学原理和 Fourier 热传导定律之上。这些假设（均匀材料、恒定的 $k$、恒定的 $q$、一维几何）是为获得用于教学和建模目的的解析解而采用的标准简化。该情景准确地模拟了半导体器件中自热效应的简化一阶近似。它是科学上合理的。\n2.  **适定性**：该问题提供了一个二阶常微分方程（由物理原理隐含）、两个边界条件（在 $x=0$ 和 $x=d$ 处的狄利克雷条件）以及所有必要的参数（$q$、$d$、$k$）。这构成了一个适定的边值问题，已知该问题有唯一且稳定的解。\n3.  **客观性**：问题陈述使用清晰、精确、客观的语言，是物理或工程教科书的典型风格。它没有歧义和主观论断。\n4.  **完整性与一致性**：该问题是自洽的。推导解答所需的所有信息都已提供。已知条件中没有矛盾。\n5.  **相关性**：该问题与 *半导体物理和器件建模* 领域内 *器件中的自热和电热耦合* 这一特定主题直接相关。\n\n#### 步骤3：结论与行动\n此问题有效。它科学上合理、适定，并且提供了所有必要的信息。现在开始求解过程。\n\n### 求解推导\n\n控制传热的基本原理是能量守恒。对于一个有热传导和内部热源的稳态系统，能量平衡要求从一个微分体积元传导出的净热量速率必须等于该体积内产生的热量速率。这由稳态热扩散方程表示。在一维情况下，该方程为：\n$$\n\\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) + q_{\\text{gen}} = 0\n$$\n其中 $T(x)$ 是温度场，$k$ 是热导率，$q_{\\text{gen}}$ 是体积生热率。项 $k \\frac{dT}{dx}$ 是基于 Fourier 热传导定律（$J_Q = -k \\nabla T$）的热通量。\n\n根据问题陈述，热导率 $k$ 是恒定的，体积生热密度 $q$ 是均匀的。因此，$q_{\\text{gen}} = q$。方程简化为：\n$$\nk \\frac{d^2T}{dx^2} + q = 0\n$$\n整理后得到关于温度 $T(x)$ 的二阶常微分方程：\n$$\n\\frac{d^2T}{dx^2} = -\\frac{q}{k}\n$$\n我们可以通过对 $x$ 积分两次来求解此方程。第一次积分得到温度梯度：\n$$\n\\frac{dT}{dx} = \\int \\left(-\\frac{q}{k}\\right) dx = -\\frac{q}{k}x + C_1\n$$\n其中 $C_1$ 是第一个积分常数。\n第二次积分得到温度分布 $T(x)$：\n$$\nT(x) = \\int \\left(-\\frac{q}{k}x + C_1\\right) dx = -\\frac{q}{2k}x^2 + C_1x + C_2\n$$\n其中 $C_2$ 是第二个积分常数。\n\n常数 $C_1$ 和 $C_2$ 通过应用给定的边界条件来确定：\n1.  在 $x=0$ 处，温度为 $T_0$：\n    $T(0) = T_0 = -\\frac{q}{2k}(0)^2 + C_1(0) + C_2 \\implies C_2 = T_0$。\n2.  在 $x=d$ 处，温度也为 $T_0$：\n    $T(d) = T_0 = -\\frac{q}{2k}d^2 + C_1d + T_0$。\n\n从第二个条件，我们可以解出 $C_1$：\n$$\n0 = -\\frac{q}{2k}d^2 + C_1d\n$$\n$$\nC_1d = \\frac{qd^2}{2k} \\implies C_1 = \\frac{qd}{2k}\n$$\n将 $C_1$ 和 $C_2$ 的表达式代回 $T(x)$ 的通解，我们得到稳态温度分布：\n$$\nT(x) = -\\frac{q}{2k}x^2 + \\left(\\frac{qd}{2k}\\right)x + T_0\n$$\n这个表达式可以因式分解，得到一个更直观的形式：\n$$\nT(x) = T_0 + \\frac{q}{2k}(dx - x^2) = T_0 + \\frac{qx(d-x)}{2k}\n$$\n该方程描述了一个抛物线形的温度分布，关于板的中心对称。\n\n下一步是求最高温度 $T_{max}$。最高温度将出现在温度梯度为零的位置 $x_{max}$，即 $\\frac{dT}{dx} = 0$。\n$$\n\\frac{dT}{dx} = -\\frac{q}{k}x + C_1 = -\\frac{q}{k}x + \\frac{qd}{2k}\n$$\n令导数为零：\n$$\n-\\frac{q}{k}x_{max} + \\frac{qd}{2k} = 0\n$$\n$$\n\\frac{q}{k}x_{max} = \\frac{qd}{2k} \\implies x_{max} = \\frac{d}{2}\n$$\n正如从问题的对称性所预期的，最高温度出现在板的中点。\n\n为了求得最高温度的值，我们将 $x = d/2$ 代入 $T(x)$ 的表达式中：\n$$\nT_{max} = T\\left(\\frac{d}{2}\\right) = T_0 + \\frac{q}{2k}\\left(d\\left(\\frac{d}{2}\\right) - \\left(\\frac{d}{2}\\right)^2\\right)\n$$\n$$\nT_{max} = T_0 + \\frac{q}{2k}\\left(\\frac{d^2}{2} - \\frac{d^2}{4}\\right)\n$$\n$$\nT_{max} = T_0 + \\frac{q}{2k}\\left(\\frac{d^2}{4}\\right)\n$$\n$$\nT_{max} = T_0 + \\frac{qd^2}{8k}\n$$\n问题要求的是高于边界温度 $T_0$ 的最大温升。这个量，$\\Delta T_{max}$，由下式给出：\n$$\n\\Delta T_{max} = T_{max} - T_0\n$$\n$$\n\\Delta T_{max} = \\left(T_0 + \\frac{qd^2}{8k}\\right) - T_0 = \\frac{qd^2}{8k}\n$$\n这就是关于给定参数 $q$、$d$ 和 $k$ 的最大温升的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{qd^2}{8k}}\n$$"
        },
        {
            "introduction": "这个练习将超越简单的热流分析，深入探讨电热反馈这一关键概念。您将分析一个电阻随温度变化的器件的稳定性，这在许多半导体元件中是常见情况。本练习  将指导您推导出热失控的临界条件，这是一种灾难性的失效模式，其中温度和功率耗散形成正反馈循环，导致无法控制的加热。",
            "id": "3770995",
            "problem": "一个两端半导体器件在标称参考温度 $T_{0}$ 附近表现出欧姆传导特性，其随温度变化的电阻在局部被建模为 $R(T) = R_{0}\\left[1 + \\alpha\\left(T - T_{0}\\right)\\right]$，其中 $R_{0}$ 是在 $T_{0}$ 时的电阻，$\\alpha$ 是电阻温度系数 (TCR)，单位为 $\\mathrm{K}^{-1}$。该器件由固定的端电压 $V$ 偏置，因此其电功率耗散为 $P(T) = V^{2}/R(T)$。该器件通过一个集总热阻 $R_{\\theta}$（单位 $\\mathrm{K}/\\mathrm{W}$）和一个集总热容 $C_{\\theta}$（单位 $\\mathrm{J}/\\mathrm{K}$）与温度为 $T_{\\mathrm{a}}$ 的恒温环境热耦合。器件温度 $T(t)$ 根据能量守恒和 Newton 冷却定律演变。\n\n从第一性原理出发，确定电热平衡的局部稳定性条件，并计算在固定端电压偏置下，器件将进入热失控的临界热阻 $R_{\\theta,\\mathrm{crit}}$。假设关于 $T_{0}$ 的小信号线性化是有效的（即，在 $T=T_{0}$ 处评估导数），并以 $V$、$R_{0}$ 和 $\\alpha$ 的单个闭式解析表达式形式给出您的最终答案。无需数值取整。以 $\\mathrm{K}/\\mathrm{W}$ 为单位给出 $R_{\\theta,\\mathrm{crit}}$ 的最终表达式。",
            "solution": "### 步骤 1：提取已知条件\n问题提供了以下信息：\n-   一个具有随温度变化电阻的两端半导体器件：$R(T) = R_{0}\\left[1 + \\alpha\\left(T - T_{0}\\right)\\right]$。\n-   $R_{0}$ 是在参考温度 $T_{0}$ 时的电阻。\n-   $\\alpha$ 是电阻温度系数 (TCR)，单位为 $\\mathrm{K}^{-1}$。\n-   器件处于固定的端电压偏置 $V$ 下。\n-   电功率耗散为 $P(T) = V^{2}/R(T)$。\n-   器件通过热阻 $R_{\\theta}$（$\\mathrm{K}/\\mathrm{W}$）和热容 $C_{\\theta}$（$\\mathrm{J}/\\mathrm{K}$）与温度为 $T_{\\mathrm{a}}$ 的环境耦合。\n-   器件温度 $T(t)$ 由能量守恒和 Newton 冷却定律决定。\n-   分析将在温度 $T_{0}$ 附近进行小信号线性化。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n-   **科学依据**：该问题描述了一个标准的电热反馈系统。电阻表达式 $R(T)$ 是在参考温度 $T_0$ 附近电阻对温度依赖性的有效一阶（线性）近似。功率耗散定律 $P(T) = V^2/R(T)$ 是欧姆定律。热模型是基于 Newton 冷却定律的集总元件模型，这是将器件作为单个实体分析其热行为的标准且有效的简化方法。热失控的概念是半导体器件中一个公认的现象。该问题具有科学合理性。\n-   **适定性**：该问题是适定的。它要求通过稳定性分析推导出一个特定的物理量，即临界热阻 $R_{\\theta,\\mathrm{crit}}$。分析的条件（在 $T_0$ 附近进行小信号线性化）已明确说明，确保在此框架内可以找到唯一且有意义的解。\n-   **客观性**：语言客观、定量，没有偏见或主观陈述。\n-   **完整性**：该问题提供了构建控制微分方程和执行稳定性分析所需的所有物理关系和参数（$R(T)$, $P(T)$, $R_{\\theta}$, $C_{\\theta}$）。它是自洽的。\n-   **一致性与可行性**：参数和关系在物理上和量纲上都是一致的。该场景是对电子元件中电热效应的真实表示。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。这是器件物理和工程学中的一个标准问题，可以使用第一性原理和线性化技术来解决。可以继续求解过程。\n\n### 解题推导\n器件的热行为由能量守恒原理决定。器件中存储的热能变化率等于流入其中的净功率。存储的热能是器件热容 $C_{\\theta}$ 及其温度 $T$ 的函数。该能量的变化率为 $C_{\\theta} \\frac{dT}{dt}$。流入器件的功率是电产生的功率 $P_{gen}(T)$，流出的功率是散发到环境中的热量 $P_{diss}(T)$。\n\n因此，能量平衡方程为：\n$$C_{\\theta} \\frac{dT}{dt} = P_{gen}(T) - P_{diss}(T)$$\n\n产生的功率由恒定电压偏置 $V$ 下的电功率耗散给出：\n$$P_{gen}(T) = \\frac{V^{2}}{R(T)} = \\frac{V^{2}}{R_{0}\\left[1 + \\alpha\\left(T - T_{0}\\right)\\right]}$$\n\n耗散的功率由通过热阻 $R_{\\theta}$ 的 Newton 冷却定律决定：\n$$P_{diss}(T) = \\frac{T - T_{\\mathrm{a}}}{R_{\\theta}}$$\n\n将这些代入能量平衡方程，得到器件温度的完整动态方程：\n$$C_{\\theta} \\frac{dT}{dt} = \\frac{V^{2}}{R_{0}\\left[1 + \\alpha\\left(T - T_{0}\\right)\\right]} - \\frac{T - T_{\\mathrm{a}}}{R_{\\theta}}$$\n\n通过检查系统对平衡温度 $T_{eq}$ 附近小扰动的响应来分析热稳定性。在平衡状态下，温度是恒定的（$\\frac{dT}{dt} = 0$），因此产生的功率等于耗散的功率：$P_{gen}(T_{eq}) = P_{diss}(T_{eq})$。\n\n为了分析局部稳定性，我们考虑在平衡点 $T_{eq}$ 附近的一个小温度扰动 $\\delta T(t)$，使得 $T(t) = T_{eq} + \\delta T(t)$。我们在 $T_{eq}$ 附近对动态方程进行线性化：\n$$C_{\\theta} \\frac{d(T_{eq} + \\delta T)}{dt} = P_{gen}(T_{eq} + \\delta T) - P_{diss}(T_{eq} + \\delta T)$$\n$$C_{\\theta} \\frac{d(\\delta T)}{dt} \\approx \\left[ P_{gen}(T_{eq}) + \\left. \\frac{dP_{gen}}{dT} \\right|_{T=T_{eq}} \\delta T \\right] - \\left[ P_{diss}(T_{eq}) + \\left. \\frac{dP_{diss}}{dT} \\right|_{T=T_{eq}} \\delta T \\right]$$\n\n由于 $P_{gen}(T_{eq}) = P_{diss}(T_{eq})$，这些项相互抵消，得到扰动的线性化方程：\n$$C_{\\theta} \\frac{d(\\delta T)}{dt} = \\left( \\left. \\frac{dP_{gen}}{dT} \\right|_{T=T_{eq}} - \\left. \\frac{dP_{diss}}{dT} \\right|_{T=T_{eq}} \\right) \\delta T$$\n\n为了使系统稳定，扰动 $\\delta T$ 必须随时间衰减至零。这要求右侧 $\\delta T$ 的系数为负。因此，局部稳定性的条件是：\n$$\\left. \\frac{dP_{gen}}{dT} \\right|_{T=T_{eq}} - \\left. \\frac{dP_{diss}}{dT} \\right|_{T=T_{eq}}  0 \\quad \\implies \\quad \\left. \\frac{dP_{gen}}{dT} \\right|_{T=T_{eq}}  \\left. \\frac{dP_{diss}}{dT} \\right|_{T=T_{eq}}$$\n这个条件意味着，为了保持稳定，温度的任何升高都必须导致散热的增加量大于产热的增加量。\n\n问题要求我们在参考温度 $T_{0}$ 处评估此条件。首先，我们计算产生功率的导数：\n$$\\frac{dP_{gen}}{dT} = \\frac{d}{dT} \\left( \\frac{V^{2}}{R_{0}\\left[1 + \\alpha\\left(T - T_{0}\\right)\\right]} \\right) = - \\frac{V^{2} (R_{0}\\alpha)}{\\left(R_{0}\\left[1 + \\alpha\\left(T - T_{0}\\right)\\right]\\right)^{2}} = - \\frac{V^{2}\\alpha}{R_{0}\\left[1 + \\alpha\\left(T - T_{0}\\right)\\right]^{2}}$$\n在 $T=T_{0}$ 处计算该值：\n$$\\left. \\frac{dP_{gen}}{dT} \\right|_{T=T_{0}} = - \\frac{V^{2}\\alpha}{R_{0}\\left[1 + \\alpha\\left(T_{0} - T_{0}\\right)\\right]^{2}} = - \\frac{\\alpha V^{2}}{R_{0}}$$\n\n接下来，我们计算耗散功率的导数：\n$$\\frac{dP_{diss}}{dT} = \\frac{d}{dT} \\left( \\frac{T - T_{\\mathrm{a}}}{R_{\\theta}} \\right) = \\frac{1}{R_{\\theta}}$$\n这个导数是恒定的。\n\n将这些导数代入稳定性条件：\n$$- \\frac{\\alpha V^{2}}{R_{0}}  \\frac{1}{R_{\\theta}}$$\n\n热失控是一种正反馈现象，其中温度的升高导致功率产生的更大幅度增加，从而引起灾难性的发热。当 $\\frac{dP_{gen}}{dT} > 0$ 时会发生这种情况，这要求电阻温度系数 $\\alpha$ 为负。为了得到一个具有物理意义的正临界热阻 $R_{\\theta,\\mathrm{crit}}$，我们必须有 $\\alpha  0$。\n\n热失控开始的临界条件是不稳定性的边界，此时不等式变为等式：\n$$\\left. \\frac{dP_{gen}}{dT} \\right|_{T=T_{0}} = \\left. \\frac{dP_{diss}}{dT} \\right|_{T=T_{0}}$$\n$$- \\frac{\\alpha V^{2}}{R_{0}} = \\frac{1}{R_{\\theta,\\mathrm{crit}}}$$\n\n求解临界热阻 $R_{\\theta,\\mathrm{crit}}$：\n$$R_{\\theta,\\mathrm{crit}} = - \\frac{R_{0}}{\\alpha V^{2}}$$\n\n如果实际热阻 $R_{\\theta}$ 大于此临界值，即 $R_{\\theta} > R_{\\theta,\\mathrm{crit}}$，则 $\\frac{1}{R_{\\theta}}  \\frac{1}{R_{\\theta,\\mathrm{crit}}}$。这意味着 $\\frac{1}{R_{\\theta}}  -\\frac{\\alpha V^2}{R_0}$，这违反了稳定性准则。因此，$R_{\\theta,\\mathrm{crit}}$ 确实是发生热失控的阈值。",
            "answer": "$$\\boxed{- \\frac{R_{0}}{\\alpha V^{2}}}$$"
        },
        {
            "introduction": "这最后一个练习是一个综合性的顶点实践，旨在连接解析理论与现代计算器件建模。您将开发一个数值求解器，用于模拟二维器件中耦合的电热行为，并考虑材料属性的温度依赖性。通过在一个迭代框架内实现有限差分法 ，您将直接获得宝贵的实践经验，深入理解支撑先进TCAD（技术计算机辅助设计）工具的核心方法，这些工具被广泛用于设计和优化真实的半导体器件。",
            "id": "3771058",
            "problem": "考虑一个宽度为 $L_x$、高度为 $L_y$ 的二维矩形半导体域。假设在稳态、准静态操作下，电场和热场通过自热效应耦合。电场和电流密度遵循基本的本构关系和守恒定律：$\\mathbf{E} = -\\nabla V$，$\\mathbf{J} = \\sigma(T)\\mathbf{E}$，以及 $\\nabla \\cdot \\mathbf{J} = 0$。焦耳热密度由 $q = \\mathbf{J}\\cdot\\mathbf{E} = \\sigma(T)\\|\\mathbf{E}\\|^2$ 给出。半导体中的温度场 $T$ 满足稳态热传导方程 $\\nabla\\cdot(k\\nabla T) + q = 0$，其中 $k$ 是（假定为常数且各向同性的）热导率。\n\n电导率由 $\\sigma(T) = q_e n \\mu(T)$ 建模，其中 $q_e$ 是电子电荷的大小，$n$ 是代表性的载流子（电子）密度，$\\mu(T)$ 是随温度变化的载流子迁移率，它遵循一个因声子散射而广泛使用的经验温度定律：$\\mu(T) = \\mu_{\\text{ref}}\\left(\\frac{T_{\\text{ref}}}{T}\\right)^\\alpha$。在此，$T_{\\text{ref}}$ 是参考温度，$\\mu_{\\text{ref}}$ 是在 $T_{\\text{ref}}$ 时的迁移率，$\\alpha$ 是一个捕获迁移率温度敏感性的正常数指数。\n\n电学问题的边界条件如下：左边界 $x=0$ 处的电势保持为 $V=0$，右边界 $x=L_x$ 处的电势保持为 $V=V_{\\text{app}}$，顶部和底部边界（$y=0$ 和 $y=L_y$）是电绝缘的，表示为在这些边界上 $\\partial V/\\partial y = 0$。热学问题的边界条件是所有边缘均为狄利克雷边界，即在 $x=0$、$x=L_x$、$y=0$ 和 $y=L_y$ 上 $T = T_{\\text{amb}}$，其中 $T_{\\text{amb}}$ 是环境温度。\n\n从上述基本定律出发，使用均匀网格上的有限差分法（Finite Difference Method, FDM）对两个偏微分方程（Partial Differential Equations, PDEs）进行离散化，网格在 $x$ 方向有 $N_x$ 个节点，在 $y$ 方向有 $N_y$ 个节点。对 $\\nabla \\cdot (\\sigma \\nabla V) = 0$ 使用通量守恒的离散化方法，通过调和平均将电导率置于单元面上：例如，$\\sigma_{i+\\frac{1}{2},j} = \\left( \\frac{1}{2}\\left(\\frac{1}{\\sigma_{i,j}} + \\frac{1}{\\sigma_{i+1,j}}\\right) \\right)^{-1}$。对于热方程，由于 $k$ 是常数，将 $\\nabla \\cdot (k \\nabla T) + q = 0$ 离散化为一个带源项的五点差分格式。\n\n定义一个迭代电热耦合方案：将各处的 $T$ 初始化为 $T_{\\text{amb}}$，计算 $\\mu(T)$ 进而计算 $\\sigma(T)$，求解电学PDE以获得 $V$，计算热源 $q = \\sigma(T)\\|\\mathbf{E}\\|^2$（其中 $\\mathbf{E} = -\\nabla V$），求解热学PDE得到 $T$，更新 $\\mu(T)$，并重复此过程直至收敛。当连续两次电热迭代之间整个域上的最大绝对温度变化小于容差 $\\varepsilon_T$ 时，应宣告收敛。对电学和热学PDE的求解均使用高斯-赛德尔（Gauss-Seidel, GS）松弛法，并为每个内部求解设置合理的停止准则。\n\n您必须实现一个完整、可运行的程序，该程序：\n- 使用物理常数 $q_e = 1.602176634 \\times 10^{-19}$ 和 $T_{\\text{ref}} = 300$。\n- 不接受用户输入，并使用下面提供的测试套件。\n- 对于每个测试用例，运行所述的迭代方案直至收敛，最大电热迭代次数为200次，并记录两个量：\n    1. $T_{\\max}$，域上的最终最高温度，以开尔文为单位，并四舍五入到五位小数。\n    2. $\\bar{\\mu}$，域上最终迁移率的空间平均值，以 $\\text{m}^2/(\\text{V}\\cdot\\text{s})$ 为单位，并四舍五入到五位小数。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个双元素列表 $[T_{\\max}, \\bar{\\mu}]$。\n\n您的解答中必须从第一性原理出发解释离散化过程。缩写词在首次使用时必须完整写出：偏微分方程（Partial Differential Equation, PDE）、有限差分法（Finite Difference Method, FDM）、高斯-赛德尔（Gauss-Seidel, GS）。\n\n使用以下测试套件。所有几何参数单位为米，电压单位为伏特，温度单位为开尔文，载流子密度单位为 $\\text{m}^{-3}$，迁移率单位为 $\\text{m}^2/(\\text{V}\\cdot\\text{s})$，热导率单位为 $\\text{W}/(\\text{m}\\cdot\\text{K})$，指数无单位：\n- 测试用例A（正常路径）：$(L_x, L_y, N_x, N_y, V_{\\text{app}}, k, \\mu_{\\text{ref}}, \\alpha, T_{\\text{amb}}, n) = (1\\times 10^{-6}, 1\\times 10^{-6}, 21, 21, 0.5, 100, 0.05, 1.5, 300, 5\\times 10^{20})$。\n- 测试用例B（强自热效应）：$(L_x, L_y, N_x, N_y, V_{\\text{app}}, k, \\mu_{\\text{ref}}, \\alpha, T_{\\text{amb}}, n) = (1\\times 10^{-6}, 1\\times 10^{-6}, 21, 21, 1.0, 80, 0.05, 2.0, 300, 5\\times 10^{20})$。\n- 测试用例C（近零加热，边缘情况）：$(L_x, L_y, N_x, N_y, V_{\\text{app}}, k, \\mu_{\\text{ref}}, \\alpha, T_{\\text{amb}}, n) = (1\\times 10^{-6}, 1\\times 10^{-6}, 21, 21, 1\\times 10^{-3}, 100, 0.05, 1.5, 300, 5\\times 10^{20})$。\n\n数值要求：\n- 电热温度收敛准则使用 $\\varepsilon_T = 10^{-8}$。\n- 内部GS求解器的容差对电势使用 $\\varepsilon_V = 10^{-10}$，对热场使用 $\\varepsilon_H = 10^{-8}$。\n- 为防止无限循环，每次内部求解最多使用500次GS迭代。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须包含三个元素，对应三个测试用例，每个元素必须是一个双元素列表 $[T_{\\max}, \\bar{\\mu}]$，例如，$[[300.00001,0.04876],[301.23456,0.04567],[300.00000,0.04999]]$。所有的 $T_{\\max}$ 值单位必须为开尔文，所有的 $\\bar{\\mu}$ 值单位必须为 $\\text{m}^2/(\\text{V}\\cdot\\text{s})$。",
            "solution": "该问题要求开发一个数值模拟程序，用于模拟二维矩形半导体器件的稳态电热行为。电学域和热学域之间的耦合是通过焦耳热建立的，其中电导率是温度依赖的。我们将使用均匀网格上的有限差分法（Finite Difference Method, FDM）求解偏微分方程（Partial Differential Equations, PDEs）的耦合系统，并采用迭代方案来处理非线性耦合。\n\n控制方程如下：\n1.  准静态电流连续性方程：$\\nabla \\cdot \\mathbf{J} = 0$，其中 $\\mathbf{J} = \\sigma(T)\\mathbf{E}$ 是电流密度，$\\sigma(T)$ 是随温度变化的电导率。由于电场表示为电势的负梯度，即 $\\mathbf{E} = -\\nabla V$，该方程变为一个变系数类泊松方程：$\\nabla \\cdot (\\sigma(T) \\nabla V) = 0$。\n2.  稳态热传导方程：$\\nabla \\cdot (k \\nabla T) + q = 0$，其中 $k$ 是常数热导率，$q$ 是单位体积的生热率。热源为焦耳热，由 $q = \\mathbf{J} \\cdot \\mathbf{E} = \\sigma(T) \\|\\mathbf{E}\\|^2 = \\sigma(T) \\|\\nabla V\\|^2$ 给出。\n\n电导率 $\\sigma(T)$ 的温度依赖性通过载流子迁移率 $\\mu(T)$ 建模，遵循 $\\sigma(T) = q_e n \\mu(T)$，其中 $q_e$ 是元电荷，$n$ 是载流子密度。用于声子散射的迁移率模型由 $\\mu(T) = \\mu_{\\text{ref}}\\left(T_{\\text{ref}}/T\\right)^\\alpha$ 给出。\n\n我们将域 $([0, L_x], [0, L_y])$ 离散化为一个 $N_x \\times N_y$ 个节点的均匀网格。网格点由 $(i, j)$ 索引，其中 $i \\in \\{0, \\dots, N_x-1\\}$ 且 $j \\in \\{0, \\dots, N_y-1\\}$。网格间距为 $\\Delta x = L_x / (N_x-1)$ 和 $\\Delta y = L_y / (N_y-1)$。\n\n**电学PDE的离散化**\n\n电势方程为 $\\frac{\\partial}{\\partial x}\\left(\\sigma \\frac{\\partial V}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(\\sigma \\frac{\\partial V}{\\partial y}\\right) = 0$。为确保电流守恒，我们对以每个节点 $(i, j)$ 为中心的控制体采用有限体积法。对该控制体上的PDE进行积分并应用散度定理可得：\n$$\n\\int_{S} (\\sigma \\nabla V) \\cdot d\\mathbf{A} = 0\n$$\n其中 $S$ 是控制体的表面。这表明流出该体积的净电流通量为零。使用中心差分近似控制体各面上的通量，我们得到内部节点 $(i, j)$ 的以下五点差分格式：\n$$\n\\left( \\sigma_{i+1/2,j} \\frac{V_{i+1,j} - V_{i,j}}{\\Delta x} \\right) \\Delta y - \\left( \\sigma_{i-1/2,j} \\frac{V_{i,j} - V_{i-1,j}}{\\Delta x} \\right) \\Delta y + \\left( \\sigma_{i,j+1/2} \\frac{V_{i,j+1} - V_{i,j}}{\\Delta y} \\right) \\Delta x - \\left( \\sigma_{i,j-1/2} \\frac{V_{i,j} - V_{i,j-1}}{\\Delta y} \\right) \\Delta x = 0\n$$\n问题指定在单元面上（例如，节点 $(i,j)$ 和 $(i+1,j)$ 之间）使用调和平均计算电导率：\n$$\n\\sigma_{i+1/2,j} = \\left( \\frac{1}{2}\\left(\\frac{1}{\\sigma_{i,j}} + \\frac{1}{\\sigma_{i+1,j}}\\right) \\right)^{-1} = \\frac{2\\sigma_{i,j}\\sigma_{i+1,j}}{\\sigma_{i,j}+\\sigma_{i+1,j}}\n$$\n这种平均对于正确处理不同电导率材料之间的界面至关重要。\n得到的线性系统使用高斯-赛德尔（Gauss-Seidel, GS）迭代法求解 $V_{i,j}$。内部节点 $(i,j)$ 的更新方程为：\n$$\nV_{i,j} = \\frac{\\frac{1}{\\Delta x^2}(\\sigma_{i+1/2,j}V_{i+1,j} + \\sigma_{i-1/2,j}V_{i-1,j}) + \\frac{1}{\\Delta y^2}(\\sigma_{i,j+1/2}V_{i,j+1} + \\sigma_{i,j-1/2}V_{i,j-1})}{\\frac{1}{\\Delta x^2}(\\sigma_{i+1/2,j} + \\sigma_{i-1/2,j}) + \\frac{1}{\\Delta y^2}(\\sigma_{i,j+1/2} + \\sigma_{i,j-1/2})}\n$$\n$V$ 的边界条件：\n-   在 $x=0$ ($V=0$) 和 $x=L_x$ ($V=V_{\\text{app}}$) 处为狄利克雷边界。这些节点（$i=0$ 和 $i=N_x-1$）的电势值是固定的。\n-   在 $y=0$ 和 $y=L_y$ 处为诺伊曼边界（绝缘），其中 $\\partial V/\\partial y = 0$。这意味着没有电流垂直流过这些边界。该条件通过使用虚拟节点来实现。对于边界 $j=0$，我们设置 $V_{i,-1} = V_{i,1}$。假设对称性，$\\sigma_{i,-1} = \\sigma_{i,1}$，这使得界面电导率 $\\sigma_{i,-1/2}$ 等于 $\\sigma_{i,1/2}$。$j=0$ 处的差分格式得以简化，GS更新方程变为：\n$$\nV_{i,0} = \\frac{\\frac{1}{\\Delta x^2}(\\sigma_{i+1/2,0}V_{i+1,0} + \\sigma_{i-1/2,0}V_{i-1,0}) + \\frac{2}{\\Delta y^2}\\sigma_{i,1/2}V_{i,1}}{\\frac{1}{\\Delta x^2}(\\sigma_{i+1/2,0} + \\sigma_{i-1/2,0}) + \\frac{2}{\\Delta y^2}\\sigma_{i,1/2}}\n$$\n类似的方程适用于 $j=N_y-1$。\n\n**热学PDE的离散化**\n\n热学方程为 $\\nabla \\cdot (k \\nabla T) + q = 0$。由于 $k$ 是常数，该方程简化为泊松方程 $k \\nabla^2 T + q = 0$。对拉普拉斯算子使用标准的五点差分格式，我们得到：\n$$\nk \\left( \\frac{T_{i+1,j} - 2T_{i,j} + T_{i-1,j}}{\\Delta x^2} + \\frac{T_{i,j+1} - 2T_{i,j} + T_{i,j-1}}{\\Delta y^2} \\right) + q_{i,j} = 0\n$$\n通过求解 $T_{i,j}$，可得到内部节点 $(i,j)$ 的GS更新方程：\n$$\nT_{i,j} = \\frac{\\frac{1}{\\Delta x^2}(T_{i+1,j} + T_{i-1,j}) + \\frac{1}{\\Delta y^2}(T_{i,j+1} + T_{i,j-1}) + \\frac{q_{i,j}}{k}}{2\\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2}\\right)}\n$$\n$T$ 的边界条件：所有边界都保持在恒定的环境温度 $T=T_{\\text{amb}}$。这些是狄利克雷条件，因此所有边界节点（$i=0, N_x-1$ 或 $j=0, N_y-1$）的温度值是固定的。GS求解器只更新内部节点。\n\n**焦耳热源项**\n\n热源 $q = \\sigma \\|\\mathbf{E}\\|^2$ 在求解电势场 $V$ 后计算。电场 $\\mathbf{E} = -\\nabla V = -(\\frac{\\partial V}{\\partial x}\\hat{\\imath} + \\frac{\\partial V}{\\partial y}\\hat{\\jmath})$ 对内部节点使用中心差分进行离散化：\n$$\n(E_x)_{i,j} = -\\frac{V_{i+1,j} - V_{i-1,j}}{2\\Delta x}, \\quad (E_y)_{i,j} = -\\frac{V_{i,j+1} - V_{i,j-1}}{2\\Delta y}\n$$\n在边界处，平行于边界的梯度分量使用单边差分，而法向分量根据其边界条件处理。例如，在绝缘边界 $y=0$ 和 $y=L_y$ 处，$(E_y)_{i,j}=0$。\n\n**迭代电热耦合方案**\n\n$\\sigma(T)$ 和 $T(q)$ 之间的非线性耦合使用块高斯-赛德尔或Gummel型迭代方案来解决：\n1.  将温度场 $T^{(0)}$ 在各处初始化为 $T_{\\text{amb}}$。\n2.  对于迭代 $m=1, 2, \\dots$：\n    a.  更新材料属性：对所有 $(i,j)$ 计算 $\\mu^{(m-1)}_{i,j} = \\mu(T^{(m-1)}_{i,j})$ 和 $\\sigma^{(m-1)}_{i,j} = \\sigma(T^{(m-1)}_{i,j})$。\n    b.  求解电学问题：使用 $\\sigma^{(m-1)}$，求解 $\\nabla \\cdot (\\sigma^{(m-1)} \\nabla V) = 0$ 以找到电势场 $V^{(m)}$。这通过一个内部GS迭代循环实现。\n    c.  计算热源：计算 $\\mathbf{E}^{(m)} = -\\nabla V^{(m)}$，然后计算焦耳热 $q^{(m)}_{i,j} = \\sigma^{(m-1)}_{i,j} \\|\\mathbf{E}^{(m)}_{i,j}\\|^2$。\n    d.  求解热学问题：使用 $q^{(m)}$，求解 $k \\nabla^2 T + q^{(m)} = 0$ 以找到新的温度场 $T^{(m)}$。这通过第二个内部GS迭代循环完成。\n    e.  检查收敛性：计算最大绝对温度变化 $\\Delta T_{\\max} = \\max_{i,j} |T^{(m)}_{i,j} - T^{(m-1)}_{i,j}|$。如果 $\\Delta T_{\\max}  \\varepsilon_T$，则方案已收敛。否则，继续下一次迭代。\n\n对每个测试用例重复此过程。收敛后，计算最高温度 $T_{\\max}$ 和最终迁移率的空间平均值 $\\bar{\\mu}$，并按要求格式化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the electrothermal simulation for the given test cases.\n    \"\"\"\n    \n    # Physical constants\n    Q_E = 1.602176634e-19  # Elementary charge in C\n    T_REF = 300.0          # Reference temperature in K\n\n    # Numerical parameters\n    MAX_ET_ITER = 200      # Max electrothermal iterations\n    EPSILON_T = 1e-8       # Electrothermal convergence tolerance for temperature\n    MAX_GS_ITER = 500      # Max Gauss-Seidel iterations for inner solves\n    EPSILON_V = 1e-10      # GS tolerance for potential\n    EPSILON_H = 1e-8       # GS tolerance for temperature\n\n    test_cases = [\n        # Test case A (happy path)\n        (1e-6, 1e-6, 21, 21, 0.5, 100.0, 0.05, 1.5, 300.0, 5e20),\n        # Test case B (strong self-heating)\n        (1e-6, 1e-6, 21, 21, 1.0, 80.0, 0.05, 2.0, 300.0, 5e20),\n        # Test case C (near-zero heating, edge case)\n        (1e-6, 1e-6, 21, 21, 1e-3, 100.0, 0.05, 1.5, 300.0, 5e20),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Lx, Ly, Nx, Ny, V_app, k, mu_ref, alpha, T_amb, n = case\n\n        # Grid setup\n        dx = Lx / (Nx - 1)\n        dy = Ly / (Ny - 1)\n        dx2 = dx**2\n        dy2 = dy**2\n\n        # Initialize fields\n        V = np.zeros((Nx, Ny))\n        T = np.full((Nx, Ny), T_amb)\n        \n        # Apply potential BCs\n        V[0, :] = 0.0\n        V[Nx - 1, :] = V_app\n\n        for et_iter in range(MAX_ET_ITER):\n            T_old_iter = np.copy(T)\n\n            # --- Update Material Properties ---\n            mu = mu_ref * (T_REF / T)**alpha\n            sigma = Q_E * n * mu\n\n            # --- Solve Electrical PDE for V using Gauss-Seidel ---\n            for gs_iter_v in range(MAX_GS_ITER):\n                V_old = np.copy(V)\n                \n                # Interior nodes\n                for i in range(1, Nx - 1):\n                    for j in range(1, Ny - 1):\n                        s_xp = 2 * sigma[i, j] * sigma[i + 1, j] / (sigma[i, j] + sigma[i + 1, j])\n                        s_xn = 2 * sigma[i, j] * sigma[i - 1, j] / (sigma[i, j] + sigma[i - 1, j])\n                        s_yp = 2 * sigma[i, j] * sigma[i, j + 1] / (sigma[i, j] + sigma[i, j + 1])\n                        s_yn = 2 * sigma[i, j] * sigma[i, j - 1] / (sigma[i, j] + sigma[i, j - 1])\n\n                        num = (s_xp * V[i + 1, j] + s_xn * V[i - 1, j]) / dx2 \\\n                            + (s_yp * V[i, j + 1] + s_yn * V[i, j - 1]) / dy2\n                        den = (s_xp + s_xn) / dx2 + (s_yp + s_yn) / dy2\n                        V[i, j] = num / den\n\n                # Neumann BCs at y=0 and y=Ny-1\n                for i in range(1, Nx - 1):\n                    # j = 0 (bottom)\n                    s_xp_0 = 2 * sigma[i, 0] * sigma[i + 1, 0] / (sigma[i, 0] + sigma[i + 1, 0])\n                    s_xn_0 = 2 * sigma[i, 0] * sigma[i - 1, 0] / (sigma[i, 0] + sigma[i-1, 0])\n                    s_yp_0 = 2 * sigma[i, 0] * sigma[i, 1] / (sigma[i, 0] + sigma[i, 1])\n                    \n                    num_0 = (s_xp_0 * V[i + 1, 0] + s_xn_0 * V[i - 1, 0]) / dx2 + (2 * s_yp_0 * V[i, 1]) / dy2\n                    den_0 = (s_xp_0 + s_xn_0) / dx2 + (2 * s_yp_0) / dy2\n                    V[i, 0] = num_0 / den_0\n\n                    # j = Ny-1 (top)\n                    j = Ny - 1\n                    s_xp_N = 2 * sigma[i, j] * sigma[i + 1, j] / (sigma[i, j] + sigma[i + 1, j])\n                    s_xn_N = 2 * sigma[i, j] * sigma[i - 1, j] / (sigma[i, j] + sigma[i - 1, j])\n                    s_yn_N = 2 * sigma[i, j] * sigma[i, j-1] / (sigma[i, j] + sigma[i, j-1])\n                    \n                    num_N = (s_xp_N * V[i + 1, j] + s_xn_N * V[i - 1, j]) / dx2 + (2 * s_yn_N * V[i, j - 1]) / dy2\n                    den_N = (s_xp_N + s_xn_N) / dx2 + (2 * s_yn_N) / dy2\n                    V[i, j] = num_N / den_N\n\n                if np.max(np.abs(V - V_old))  EPSILON_V:\n                    break\n            \n            # --- Compute Heat Generation q ---\n            Ex = np.zeros_like(V)\n            Ey = np.zeros_like(V)\n\n            # Central difference for interior\n            Ex[1:-1, :] = -(V[2:, :] - V[:-2, :]) / (2 * dx)\n            Ey[:, 1:-1] = -(V[:, 2:] - V[:, :-2]) / (2 * dy)\n            \n            # One-sided difference for x-boundaries\n            Ex[0, :] = -(V[1, :] - V[0, :]) / dx\n            Ex[-1, :] = -(V[-1, :] - V[-2, :]) / dx\n            \n            # Ey is zero on Neumann boundaries\n            Ey[:, 0] = 0\n            Ey[:, -1] = 0\n\n            q = sigma * (Ex**2 + Ey**2)\n\n            # --- Solve Thermal PDE for T using Gauss-Seidel ---\n            T_old_gs = np.copy(T) # Preserve BCs\n            for gs_iter_t in range(MAX_GS_ITER):\n                T_gs_prev_iter = np.copy(T)\n                \n                # Update only interior nodes\n                for i in range(1, Nx - 1):\n                    for j in range(1, Ny - 1):\n                        num = (T[i + 1, j] + T[i - 1, j]) / dx2 + \\\n                              (T[i, j + 1] + T[i, j - 1]) / dy2 + q[i, j] / k\n                        den = 2 * (1 / dx2 + 1 / dy2)\n                        T[i, j] = num / den\n\n                if np.max(np.abs(T - T_gs_prev_iter))  EPSILON_H:\n                    break\n            \n            # Reset borders to T_amb (Dirichlet BCs)\n            T[0, :] = T_amb\n            T[-1, :] = T_amb\n            T[:, 0] = T_amb\n            T[:, -1] = T_amb\n\n            # --- Check Electrothermal Convergence ---\n            max_T_change = np.max(np.abs(T - T_old_iter))\n            if max_T_change  EPSILON_T:\n                break\n        \n        # Final calculations after convergence\n        final_mu = mu_ref * (T_REF / T)**alpha\n        T_max = np.max(T)\n        mu_avg = np.mean(final_mu)\n        \n        results.append([round(T_max, 5), round(mu_avg, 5)])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}