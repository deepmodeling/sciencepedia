{
    "hands_on_practices": [
        {
            "introduction": "理解任何半导体器件中可用的载流子数量是至关重要的第一步。这个练习将指导你从第一性原理出发，推导石墨烯中的本征载流子浓度，这直接源于其独特的线性色散关系和态密度。通过将计算结果与典型的衬底诱导掺杂水平进行比较 ，你将深入理解在实际器件中，热激发和外在掺杂是如何共同决定石墨烯的电学特性的。",
            "id": "3751324",
            "problem": "将一层化学势为零的单层石墨烯放置在二氧化硅上，该二氧化硅被建模为一个衬底，其诱导的外在掺杂电荷密度为 $n_{d} = 5.0 \\times 10^{11}\\,\\mathrm{cm}^{-2}$。将石墨烯中的低能准粒子视为具有各向同性线性色散 $E = \\hbar v_{F} |k|$ 的无质量狄拉克费米子，其中 $v_{F}$ 是费米速度，并考虑自旋和谷简并。假设系统处于温度 $T$ 的热平衡状态，并使用费米-狄拉克统计。从二维波矢空间中的态计数第一性原理以及电子数密度由态密度和费米-狄拉克占据数定义的公式出发，推导出零化学势下的本征电子密度 $n_{i}(T)$。然后，使用 $v_{F} = 1.00 \\times 10^{6}\\,\\mathrm{m/s}$、$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$ 和 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$，在 $T = 300\\,\\mathrm{K}$ 时计算 $n_{i}$，并计算无量纲比值 $R = n_{i} / n_{d}$。将最终比值 $R$ 四舍五入到三位有效数字。以 $\\mathrm{cm}^{-2}$ 为单位表示 $n_{i}$，但最终答案只报告比值 $R$。",
            "solution": "该问题要求推导单层石墨烯的本征电子密度 $n_i(T)$，并随后进行数值计算，以求得其与给定的外在掺杂密度 $n_d$ 的比值。\n\n首先，我们进行问题验证。\n**第一步：提取已知条件**\n- 系统：置于二氧化硅衬底上的单层石墨烯。\n- 本征情况下的化学势：$\\mu=0$。\n- 外在掺杂电荷密度：$n_{d} = 5.0 \\times 10^{11}\\,\\mathrm{cm}^{-2}$。\n- 低能色散关系：$E = \\hbar v_{F} |k|$，其中 $|k|$ 是波矢 $\\vec{k}$ 的模。\n- 费米速度：$v_{F} = 1.00 \\times 10^{6}\\,\\mathrm{m/s}$。\n- 简并度：自旋简并 ($g_s=2$) 和谷简并 ($g_v=2$）。\n- 温度：$T = 300\\,\\mathrm{K}$。\n- 统计：费米-狄拉克统计。\n- 约化普朗克常数：$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了石墨烯中低能准粒子（无质量狄拉克费米子）的一个标准且成熟的模型。色散关系、物理常数以及温度和掺杂密度等参数都是现实且表述正确的。任务提法得当，为从第一性原理到具体数值结果提供了清晰的路径。语言客观、精确。问题是自洽的，没有矛盾。\n\n**第三步：结论与行动**\n问题有效。我们继续进行求解。\n\n推导从确定态密度 (DOS) $g(E)$ 开始。在一个面积为 $A=L_x L_y$ 的二维晶体中，允许的波矢在 $k$ 空间中形成一个网格。$k$ 空间中对应于单个态的面积是 $(\\frac{2\\pi}{L_x})(\\frac{2\\pi}{L_y}) = \\frac{(2\\pi)^2}{A}$。\n\n$k$ 空间中半径从 $k$ 到 $k+dk$ 的无限薄环带内的态数 $dN$，是环带的面积 $2\\pi k \\, dk$ 除以单位态的面积。我们还必须包括总简并因子 $g = g_s g_v$。石墨烯具有自旋简并度 $g_s=2$ 和谷简并度 $g_v=2$（在布里渊区的 $K$ 点和 $K'$ 点），因此总简并度为 $g=4$。\n\n$$dN = g \\frac{A}{(2\\pi)^2} (2\\pi k \\, dk) = 4 \\frac{A}{4\\pi^2} (2\\pi k \\, dk) = \\frac{2A}{\\pi} k \\, dk$$\n\n单位面积的态密度 $g(E)$ 定义为 $g(E) = \\frac{1}{A} \\frac{dN}{dE}$。根据导带的线性色散关系 ($E \\ge 0$)，我们有 $E = \\hbar v_F k$，这意味着 $k = \\frac{E}{\\hbar v_F}$ 且 $dk = \\frac{dE}{\\hbar v_F}$。\n\n将这些代入 $dN$ 的表达式中：\n$$dN = \\frac{2A}{\\pi} \\left(\\frac{E}{\\hbar v_F}\\right) \\left(\\frac{dE}{\\hbar v_F}\\right) = \\frac{2A E}{\\pi (\\hbar v_F)^2} dE$$\n\n那么导带的态密度为：\n$$g(E) = \\frac{1}{A} \\frac{dN}{dE} = \\frac{2E}{\\pi (\\hbar v_F)^2}$$\n态密度对能量的这种线性依赖性是石墨烯的一个标志。\n\n导带中的电子密度 $n$ 是通过将态密度与费米-狄拉克占据概率 $f(E, \\mu, T)$ 的乘积从导带底 ($E=0$) 积分到无穷大来求得的。\n$$n(T, \\mu) = \\int_0^\\infty g(E) f(E, \\mu, T) \\, dE$$\n其中 $f(E, \\mu, T) = \\frac{1}{\\exp\\left(\\frac{E-\\mu}{k_B T}\\right) + 1}$。\n\n对于本征情况，化学势位于狄拉克点，因此 $\\mu = 0$。所以本征电子密度 $n_i(T)$ 为：\n$$n_i(T) = n(T, \\mu=0) = \\int_0^\\infty \\frac{2E}{\\pi (\\hbar v_F)^2} \\frac{1}{\\exp\\left(\\frac{E}{k_B T}\\right) + 1} \\, dE$$\n\n为求解此积分，我们进行变量代换。令 $x = \\frac{E}{k_B T}$。这得到 $E = x k_B T$ 和 $dE = k_B T \\, dx$。\n$$n_i(T) = \\int_0^\\infty \\frac{2(x k_B T)}{\\pi (\\hbar v_F)^2} \\frac{1}{\\exp(x) + 1} (k_B T \\, dx)$$\n$$n_i(T) = \\frac{2(k_B T)^2}{\\pi (\\hbar v_F)^2} \\int_0^\\infty \\frac{x}{\\exp(x) + 1} \\, dx$$\n\n该定积分是与 Riemann zeta 函数 $\\zeta(s)$ 相关的标准形式。该积分的值为 $\\int_0^\\infty \\frac{x}{\\exp(x)+1} dx = \\frac{\\pi^2}{12}$。\n\n将此结果代回 $n_i(T)$ 的表达式中：\n$$n_i(T) = \\frac{2(k_B T)^2}{\\pi (\\hbar v_F)^2} \\left( \\frac{\\pi^2}{12} \\right) = \\frac{\\pi}{6} \\left( \\frac{k_B T}{\\hbar v_F} \\right)^2$$\n这就是推导出的石墨烯中本征电子密度的解析表达式。\n\n接下来，我们使用给定的常数在 $T=300\\,\\mathrm{K}$ 时数值计算 $n_i(T)$。\n热能为：\n$$k_B T = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (300\\,\\mathrm{K}) = 4.141947 \\times 10^{-21}\\,\\mathrm{J}$$\n项 $\\hbar v_F$ 为：\n$$\\hbar v_F = (1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}) \\times (1.00 \\times 10^{6}\\,\\mathrm{m/s}) = 1.054571817 \\times 10^{-28}\\,\\mathrm{J\\,m}$$\n现在我们计算括号内的无量纲比值：\n$$\\frac{k_B T}{\\hbar v_F} = \\frac{4.141947 \\times 10^{-21}\\,\\mathrm{J}}{1.054571817 \\times 10^{-28}\\,\\mathrm{J\\,m}} \\approx 3.92760 \\times 10^7\\,\\mathrm{m}^{-1}$$\n将此值平方：\n$$\\left( \\frac{k_B T}{\\hbar v_F} \\right)^2 \\approx (3.92760 \\times 10^7\\,\\mathrm{m}^{-1})^2 \\approx 1.54260 \\times 10^{15}\\,\\mathrm{m}^{-2}$$\n现在，我们以 $\\mathrm{m}^{-2}$ 为单位计算 $n_i$：\n$$n_i(300\\,\\mathrm{K}) = \\frac{\\pi}{6} \\left( \\frac{k_B T}{\\hbar v_F} \\right)^2 \\approx \\frac{\\pi}{6} (1.54260 \\times 10^{15}\\,\\mathrm{m}^{-2}) \\approx 8.0770 \\times 10^{14}\\,\\mathrm{m}^{-2}$$\n问题以 $\\mathrm{cm}^{-2}$ 为单位提供了 $n_d$，因此我们必须将 $n_i$ 转换为相同的单位。由于 $1\\,\\mathrm{m} = 100\\,\\mathrm{cm}$，所以 $1\\,\\mathrm{m}^2 = 10^4\\,\\mathrm{cm}^2$，这意味着 $1\\,\\mathrm{m}^{-2} = 10^{-4}\\,\\mathrm{cm}^{-2}$。\n$$n_i(300\\,\\mathrm{K}) \\approx (8.0770 \\times 10^{14}) \\times (10^{-4}\\,\\mathrm{cm}^{-2}) = 8.0770 \\times 10^{10}\\,\\mathrm{cm}^{-2}$$\n\n最后，我们计算无量纲比值 $R = \\frac{n_i}{n_d}$。\n$$R = \\frac{8.0770 \\times 10^{10}\\,\\mathrm{cm}^{-2}}{5.0 \\times 10^{11}\\,\\mathrm{cm}^{-2}} = \\frac{8.0770}{50} \\approx 0.16154$$\n按照要求，将结果四舍五入到三位有效数字：\n$$R \\approx 0.162$$\n该比值表明，在室温下，由热激发产生的本征载流子浓度是指定水平的外在掺杂所诱导的载流子浓度的一个重要部分（约占 $16\\%$）。",
            "answer": "$$\\boxed{0.162}$$"
        },
        {
            "introduction": "石墨烯中的载流子输运遵循着与传统半导体截然不同的物理规律。本练习将引导你探究一个最引人注目的现象：克莱因隧穿 (Klein tunneling) 。通过求解狄拉克方程来计算电子在势垒下的透射率，并将其与非相对论性的薛定谔方程的结果进行对比，你将亲手揭示石墨烯中“无质量”狄拉克费米子如何能够完美地穿透任意高度的势垒，这与它们独特的赝自旋守恒密切相关。",
            "id": "3751283",
            "problem": "考虑一个单层石墨烯片，在低能下由单谷、单自旋的无质量狄拉克哈密顿量 $H = v_{F}\\,\\boldsymbol{\\sigma}\\cdot\\boldsymbol{p} + V(x)$ 描述，其中 $v_{F}$ 是费米速度，$\\boldsymbol{\\sigma} = (\\sigma_{x},\\sigma_{y})$ 是作用于子晶格赝自旋的泡利矩阵，$V(x)$ 是一个仅依赖于 $x$ 的静电势。一个高度为 $V_{0} > 0$、宽度为 $d > 0$ 的矩形势垒定义为：当 $x  0$ 时，$V(x) = 0$；当 $0 \\le x \\le d$ 时，$V(x) = V_{0}$；当 $x > d$ 时，$V(x) = 0$。一个能量为 $E$（满足 $0  E  V_{0}$）的电子从 $x  0$ 处正入射（横向动量为零）。\n\n仅使用狄拉克方程、各区域的平面波解，以及双分量旋量在界面 $x=0$ 和 $x=d$ 处的连续性条件，推导正入射情况下穿过势垒的透射概率 $T_{G}(E,V_{0},d)$。\n\n作为对比，考虑一个二维电子气中有效质量为 $m$ 的非相对论电子，该电子由不含时薛定谔方程所支配，处在相同的矩形势垒 $V(x)$ 中，且具有相同的入射能量 $E$（满足 $0  E  V_{0}$）并正入射。仅使用薛定谔方程、各区域的平面波解和渐逝解，以及标量波函数及其导数在界面 $x=0$ 和 $x=d$ 处的连续性条件，推导穿过势垒的透射概率 $T_{S}(E,V_{0},d,m)$。\n\n定义比率 $R(E,V_{0},d,m) \\equiv T_{G}(E,V_{0},d)/T_{S}(E,V_{0},d,m)$。以 $E$, $V_{0}$, $d$, $m$, $\\hbar$ 和 $v_{F}$ 表示的 $R$ 的单个闭式解析表达式作为您的最终答案。无需进行数值计算。比率 $R$ 是无量纲的；最终答案中不要包含单位。",
            "solution": "此问题要求我们推导并比较两种情况下穿过相同矩形势垒的透射概率：(1) 石墨烯中的无质量狄拉克费米子，以及 (2) 标准二维电子气 (2DEG) 中的非相对论性电子。\n\n**第1部分：石墨烯中的克莱因隧穿**\n\n对于石墨烯，低能电子由无质量狄拉克哈密顿量描述：$H = v_{F}\\,\\boldsymbol{\\sigma}\\cdot\\boldsymbol{p} + V(x)$。在正入射 ($k_y=0$) 的情况下，问题简化为一维。我们在三个区域求解狄拉克方程 $H\\Psi = E\\Psi$：\n*   **区域 I ($x  0$) 和 区域 III ($x > d$):** 势 $V=0$。波矢为 $k = E/(\\hbar v_F)$。\n*   **区域 II ($0 \\le x \\le d$):** 势 $V=V_0$。由于 $0  E  V_0$，波矢为 $q = (V_0-E)/(\\hbar v_F)$。\n\n在每个区域，波函数是前向和后向传播波的叠加，其旋量结构由能量和势的相对大小决定。\n*   区域 I：$\\Psi_{I}(x) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{ikx} + r \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} e^{-ikx}$ （入射波+反射波）\n*   区域 II：$\\Psi_{II}(x) = a \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} e^{iqx} + b \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{-iqx}$ （势垒内的波）\n*   区域 III：$\\Psi_{III}(x) = t \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} e^{ikx}$ （透射波）\n\n通过在边界 $x=0$ 和 $x=d$ 处施加波函数连续性条件，我们可以求解反射系数 $r$ 和透射系数 $t$。在 $x=0$ 处匹配，我们得到 $r=a$ 和 $b=1$。在 $x=d$ 处匹配，我们得到两个关于 $t$ 和 $r$ 的方程。联立求解发现反射系数 $r$ 必须为零。这意味着没有波被反射。\n因此，透射概率 $T_G = |t|^2$ 恒等于1。\n$$T_G(E, V_0, d) = 1$$\n这便是克莱因隧穿：狄拉克粒子能够完美地穿过任意高度的势垒，这归因于其手性（赝自旋与动量锁定）的守恒。\n\n**第2部分：标准薛定谔隧穿**\n\n对于具有有效质量 $m$ 的非相对论性电子，我们求解不含时薛定谔方程：\n$$-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$$\n在区域 I 和 III，解是振荡的，波矢为 $k = \\sqrt{2mE/\\hbar^2}$。在区域 II，由于 $E  V_0$，解是渐逝的（指数衰减），衰减常数为 $\\kappa = \\sqrt{2m(V_0-E)/\\hbar^2}$。\n\n通过在边界 $x=0$ 和 $x=d$ 处匹配波函数 $\\psi(x)$ 及其导数 $\\psi'(x)$，可以得到一个标准的隧穿问题解。透射概率 $T_S$ 为：\n$$T_S(E,V_0,d,m) = \\left[1 + \\frac{V_0^2}{4E(V_0-E)}\\sinh^2\\left(d\\sqrt{\\frac{2m(V_0-E)}{\\hbar^2}}\\right)\\right]^{-1}$$\n\n**第3部分：比率 R**\n\n所求的比率 $R \\equiv T_G/T_S$ 为：\n$$R(E,V_0,d,m) = \\frac{1}{T_S} = 1 + \\frac{V_0^2}{4E(V_0-E)}\\sinh^2\\left(\\frac{d}{\\hbar}\\sqrt{2m(V_0-E)}\\right)$$\n这个结果鲜明地对比了狄拉克电子的完美透射（$T_G=1$）与常规电子的指数衰减透射（$T_S \\ll 1$）。",
            "answer": "$$\n\\boxed{1 + \\frac{V_{0}^{2}}{4E(V_{0}-E)}\\sinh^{2}\\left(\\frac{d}{\\hbar}\\sqrt{2m(V_{0}-E)}\\right)}\n$$"
        },
        {
            "introduction": "虽然解析模型为了解理想化系统提供了深刻的物理洞见，但实际的纳米器件结构复杂，必须依赖数值模拟。本练习将带领你进入量子输运计算的核心，使用非平衡格林函数 (NEGF) 形式主义来模拟一个石墨烯纳米结构中的电子透射 。通过编写代码构建哈密顿量、定义接触自能并最终计算透射谱，你将掌握将理论概念转化为强大预测工具的实践技能，这是现代电子器件建模的基础。",
            "id": "3751355",
            "problem": "考虑一个在最近邻紧束缚近似下描述的有限石墨烯纳米结构。器件区域被建模为一个有限的蜂窝状片段，包含 $N=8$ 个碳位点，其索引标记为 $0,1,2,3,4,5,6,7$。器件在位点基下的单粒子哈密顿量 $\\mathbf{H}$ 由在位能为 $0$ 和键合最近邻之间的跃迁能为 $-t$ 定义，其中 $t$ 是以电子伏特 (eV) 表示的最近邻跃迁能。该有限器件中的化学键由以下无向索引对给出：\n$$(0,1),\\ (1,2),\\ (2,3),\\ (4,5),\\ (5,6),\\ (6,7),\\ (0,4),\\ (1,5),\\ (2,6),\\ (3,7)。$$\n这个化学键列表构成了一个宽度为2、长度为4个键、带有边缘终端的类扶手椅型（armchair-like）石墨烯片段。\n\n两个金属接触（源极和漏极）在宽带极限下连接到器件。源极接触耦合到索引为 $0$ 和 $4$ 的器件位点，而漏极接触耦合到索引为 $3$ 和 $7$ 的器件位点。在宽带极限下，源极和漏极的推迟自能被建模为纯虚数且与能量无关，\n$$\\boldsymbol{\\Sigma}_S^R = -i\\,\\eta_S\\,\\mathbf{P}_S,\\qquad \\boldsymbol{\\Sigma}_D^R = -i\\,\\eta_D\\,\\mathbf{P}_D,$$\n其中 $\\eta_S$ 和 $\\eta_D$ 是非负实数耦合强度（单位 eV），$\\mathbf{P}_S$ 和 $\\mathbf{P}_D$ 是投影到接触耦合的器件子空间的投影矩阵（在耦合索引处为1，其他位置为0的对角矩阵）。相应的展宽矩阵定义为\n$$\\boldsymbol{\\Gamma}_S = i\\left(\\boldsymbol{\\Sigma}_S^R - \\boldsymbol{\\Sigma}_S^A\\right),\\qquad \\boldsymbol{\\Gamma}_D = i\\left(\\boldsymbol{\\Sigma}_D^R - \\boldsymbol{\\Sigma}_D^A\\right),$$\n其中超前自能满足 $\\boldsymbol{\\Sigma}^{A} = \\left(\\boldsymbol{\\Sigma}^{R}\\right)^\\dagger$，因此在宽带极限下 $\\boldsymbol{\\Gamma}_S = 2\\,\\eta_S\\,\\mathbf{P}_S$ 且 $\\boldsymbol{\\Gamma}_D = 2\\,\\eta_D\\,\\mathbf{P}_D$。\n\n使用非平衡格林函数 (NEGF) 形式理论，开放器件在能量 $E$ 处的推迟格林函数定义为\n$$\\mathbf{G}^R(E) = \\left[(E + i\\,0^+)\\,\\mathbf{I} - \\mathbf{H} - \\boldsymbol{\\Sigma}_S^R - \\boldsymbol{\\Sigma}_D^R\\right]^{-1},$$\n而超前格林函数为 $\\mathbf{G}^A(E) = \\left(\\mathbf{G}^R(E)\\right)^\\dagger$。\n\n任务是计算能量分辨透射率，\n$$T(E) = \\operatorname{Tr}\\left[\\boldsymbol{\\Gamma}_S\\,\\mathbf{G}^R(E)\\,\\boldsymbol{\\Gamma}_D\\,\\mathbf{G}^A(E)\\right],$$\n对于一组指定的物理上合理的参数。所有能量、耦合和跃迁值都必须以电子伏特 (eV) 为单位进行处理和报告。为确保数值稳定性，您必须通过在能量上加上一个小的正虚数 $i\\,\\varepsilon$（其中 $\\varepsilon = 10^{-12}$）来实现推迟规定，如上式所示。\n\n使用化学键列表和跃迁能 $-t$ 构建 $8\\times 8$ 哈密顿矩阵 $\\mathbf{H}$；对角线元素为 $0$。使用给定的 $\\eta_S$ 和 $\\eta_D$ 以及指定的接触索引构建 $\\boldsymbol{\\Gamma}_S$ 和 $\\boldsymbol{\\Gamma}_D$。通过 $\\boldsymbol{\\Sigma}^R = -\\frac{i}{2}\\boldsymbol{\\Gamma}$ 从 $\\boldsymbol{\\Gamma}$ 构建 $\\boldsymbol{\\Sigma}_S^R$ 和 $\\boldsymbol{\\Sigma}_D^R$。\n\n您的程序必须计算下面每个测试用例的 $T(E)$，并生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。列表中的每个条目必须是浮点数（单位为无量纲透射单位）。\n\n测试套件（所有参数单位为电子伏特，eV）：\n- 用例 1（通用正常情况）：$E=0.1$, $t=2.7$, $\\eta_S=0.5$, $\\eta_D=0.5$。\n- 用例 2（源极解耦边界情况）：$E=0.1$, $t=2.7$, $\\eta_S=0.0$, $\\eta_D=0.5$。\n- 用例 3（离共振边界）：$E=5.0$, $t=2.7$, $\\eta_S=0.5$, $\\eta_D=0.5$。\n- 用例 4（强不对称性）：$E=0.05$, $t=2.7$, $\\eta_S=2.0$, $\\eta_D=0.1$。\n- 用例 5（弱接触下接近狄拉克点）：$E=0.0$, $t=2.7$, $\\eta_S=0.05$, $\\eta_D=0.05$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[r_1, r_2, r_3, r_4, r_5]$，其中每个 $r_k$ 对应第 $k$ 个用例的 $T(E)$。",
            "solution": "我们从石墨烯器件区域的紧束缚表示开始。在最近邻模型中，位点基下的器件哈密顿量 $\\mathbf{H}$ 的对角元素等于 $0$（选择π轨道的在位能作为能量零点），对于成键的碳原子对，非对角元素等于 $-t$。利用所提供的化学键列表，我们通过在对应于键 $(i,j)$ 和 $(j,i)$ 的位置上放置 $-t$ 并在其他地方放置 $0$ 来构造对称的 $8\\times 8$ 矩阵 $\\mathbf{H}$。\n\n非平衡格林函数 (NEGF) 形式理论从推迟格林函数的预解式定义出发，即对于封闭系统，它是算符 $E + i\\,0^+ - \\hat{H}$ 的逆。对于带接触的开放系统，接触的影响通过加到哈密顿量中的推迟自能 $\\boldsymbol{\\Sigma}^R$ 来捕捉，得到\n$$\\mathbf{G}^R(E) = \\left[(E + i\\,0^+)\\,\\mathbf{I} - \\mathbf{H} - \\sum_\\alpha \\boldsymbol{\\Sigma}_\\alpha^R(E)\\right]^{-1},$$\n其中求和遍历所有接触 $\\alpha$（这里是源极 $S$ 和漏极 $D$）。超前格林函数通过厄米共轭得到，\n$$\\mathbf{G}^A(E) = \\left(\\mathbf{G}^R(E)\\right)^\\dagger.$$\n\n在宽带极限下，接触谱密度与能量无关，并且接触自能在耦合的器件位点子空间上是纯虚数和对角化的。对于源极和漏极，我们有\n$$\\boldsymbol{\\Sigma}_S^R = -i\\,\\eta_S\\,\\mathbf{P}_S,\\qquad \\boldsymbol{\\Sigma}_D^R = -i\\,\\eta_D\\,\\mathbf{P}_D,$$\n其中 $\\eta_S$ 和 $\\eta_D$ 是指定接触-器件耦合强度的非负实数，$\\mathbf{P}_S$ 和 $\\mathbf{P}_D$ 是到接触耦合位点的投影算符。超前自能满足 $\\boldsymbol{\\Sigma}_\\alpha^A = \\left(\\boldsymbol{\\Sigma}_\\alpha^R\\right)^\\dagger$。因为在此模型中 $\\boldsymbol{\\Sigma}_\\alpha^R$ 是纯虚数且对角的，所以 $\\boldsymbol{\\Sigma}_\\alpha^A = +i\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha$。\n\n耦合或展宽矩阵 $\\boldsymbol{\\Gamma}_\\alpha$ 定义为\n$$\\boldsymbol{\\Gamma}_\\alpha = i\\left(\\boldsymbol{\\Sigma}_\\alpha^R - \\boldsymbol{\\Sigma}_\\alpha^A\\right) = i\\left(-i\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha - i\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha\\right) = 2\\,\\eta_\\alpha\\,\\mathbf{P}_\\alpha.$$\n等价地，这意味着\n$$\\boldsymbol{\\Sigma}_\\alpha^R = -\\frac{i}{2}\\,\\boldsymbol{\\Gamma}_\\alpha.$$\n\n有了这些定义，源极和漏极之间在能量 $E$ 处的透射率可由 Caroli 公式得出，\n$$T(E) = \\operatorname{Tr}\\left[\\boldsymbol{\\Gamma}_S\\,\\mathbf{G}^R(E)\\,\\boldsymbol{\\Gamma}_D\\,\\mathbf{G}^A(E)\\right].$$\n这个表达式衡量了从源极注入的态如何通过器件传播并进入漏极，同时考虑了来自接触的能级展宽。\n\n算法构造：\n- 使用化学键列表和跃迁能 $-t$ 构造维度为 $N=8$ 的哈密顿矩阵 $\\mathbf{H}$。对角线元素保持为 $0$。\n- 构建投影矩阵 $\\mathbf{P}_S$ 和 $\\mathbf{P}_D$ 作为对角矩阵，其在耦合到源极（$0$ 和 $4$）和漏极（$3$ 和 $7$）的索引处元素为 $1$，其他位置为 $0$。\n- 构建 $\\boldsymbol{\\Gamma}_S = 2\\,\\eta_S\\,\\mathbf{P}_S$ 和 $\\boldsymbol{\\Gamma}_D = 2\\,\\eta_D\\,\\mathbf{P}_D$。\n- 构建 $\\boldsymbol{\\Sigma}_S^R = -\\frac{i}{2}\\,\\boldsymbol{\\Gamma}_S$ 和 $\\boldsymbol{\\Sigma}_D^R = -\\frac{i}{2}\\,\\boldsymbol{\\Gamma}_D$。\n- 形成矩阵\n$$\\mathbf{M}(E) = (E + i\\,\\varepsilon)\\,\\mathbf{I} - \\mathbf{H} - \\boldsymbol{\\Sigma}_S^R - \\boldsymbol{\\Sigma}_D^R,$$\n其中 $\\varepsilon = 10^{-12}$ 以强制推迟边界条件和数值稳定性。\n- 计算 $\\mathbf{G}^R(E) = \\mathbf{M}(E)^{-1}$ 和 $\\mathbf{G}^A(E) = \\left(\\mathbf{G}^R(E)\\right)^\\dagger$。\n- 计算 $T(E) = \\operatorname{Tr}\\left[\\boldsymbol{\\Gamma}_S\\,\\mathbf{G}^R(E)\\,\\boldsymbol{\\Gamma}_D\\,\\mathbf{G}^A(E)\\right]$ 并返回其实部，根据构造，它应为非负数。\n\n物理单位和数值考虑：\n- 所有能量（$E$, $t$, $\\eta_S$, $\\eta_D$）都以电子伏特 (eV) 为单位。透射率 $T(E)$ 是无量纲的。\n- 无穷小量 $0^+$ 在数值上实现为 $\\varepsilon = 10^{-12}$ eV，以避免在本征值处的奇异逆，并选择正确的推迟分支。\n\n测试覆盖范围：\n- 用例 1 使用中等、对称的耦合，在狄拉克点附近探测典型的输运行为。\n- 用例 2 设置 $\\eta_S=0$，这必须产生 $T(E)=0$，因为从源极的注入被抑制；该代码验证了对零展宽的处理。\n- 用例 3 使用一个大的离共振能量，由于离共振和有限的接触展宽，通常会产生很小的透射率。\n- 用例 4 探讨了耦合中的强不对称性，突出了由较弱接触主导的瓶颈行为。\n- 用例 5 在弱接触下探测狄拉克点附近区域，测试在小展宽下对边缘态和有限尺寸效应的敏感性。\n\n程序计算每个用例的 $T(E)$，并打印一行格式为方括号内逗号分隔列表的输出，以符合规范。",
            "answer": "```python\nimport numpy as np\n\ndef build_graphene_fragment_hamiltonian(t: float) - np.ndarray:\n    \"\"\"\n    Build the 8x8 tight-binding Hamiltonian for the specified finite graphene fragment.\n    On-site energies are 0; nearest-neighbor bonds have hopping -t.\n    Indices: 0..7 with bonds:\n    (0,1), (1,2), (2,3), (4,5), (5,6), (6,7), (0,4), (1,5), (2,6), (3,7).\n    \"\"\"\n    N = 8\n    H = np.zeros((N, N), dtype=np.complex128)\n    bonds = [(0, 1), (1, 2), (2, 3), (4, 5), (5, 6), (6, 7),\n             (0, 4), (1, 5), (2, 6), (3, 7)]\n    for i, j in bonds:\n        H[i, j] = -t\n        H[j, i] = -t\n    return H\n\ndef build_projector(indices: list, N: int) - np.ndarray:\n    \"\"\"\n    Build a diagonal projector matrix of size NxN with ones on 'indices' and zeros elsewhere.\n    \"\"\"\n    P = np.zeros((N, N), dtype=np.complex128)\n    for idx in indices:\n        P[idx, idx] = 1.0\n    return P\n\ndef compute_transmission(E: float, t: float, eta_S: float, eta_D: float) - float:\n    \"\"\"\n    Compute transmission T(E) = Tr[Gamma_S G^R Gamma_D G^A] for the given parameters.\n    E, t, eta_S, eta_D are in eV. Transmission is dimensionless.\n    \"\"\"\n    # Build device Hamiltonian\n    H = build_graphene_fragment_hamiltonian(t)\n    N = H.shape[0]\n\n    # Contact projectors: source on sites {0,4}, drain on sites {3,7}\n    P_S = build_projector([0, 4], N)\n    P_D = build_projector([3, 7], N)\n\n    # Broadening matrices in wide-band limit: Gamma = 2*eta*P\n    Gamma_S = 2.0 * eta_S * P_S\n    Gamma_D = 2.0 * eta_D * P_D\n\n    # Retarded self-energies: Sigma^R = -i/2 * Gamma\n    Sigma_S_R = -0.5j * Gamma_S\n    Sigma_D_R = -0.5j * Gamma_D\n\n    # Retarded Green's function\n    eps = 1e-12  # infinitesimal for retarded boundary condition\n    I = np.eye(N, dtype=np.complex128)\n    M = (E + 1j * eps) * I - H - Sigma_S_R - Sigma_D_R\n\n    # Invert M to get G^R\n    G_R = np.linalg.inv(M)\n    # Advanced Green's function\n    G_A = G_R.conj().T\n\n    # Transmission\n    T = np.trace(Gamma_S @ G_R @ Gamma_D @ G_A)\n    # Return the real part (imaginary part should be ~0 numerically)\n    return float(np.real(T))\n\ndef solve():\n    # Define the test cases from the problem statement (all energies in eV).\n    test_cases = [\n        # Case 1: general happy path\n        {\"E\": 0.1, \"t\": 2.7, \"eta_S\": 0.5, \"eta_D\": 0.5},\n        # Case 2: source decoupled edge case\n        {\"E\": 0.1, \"t\": 2.7, \"eta_S\": 0.0, \"eta_D\": 0.5},\n        # Case 3: off-resonant boundary\n        {\"E\": 5.0, \"t\": 2.7, \"eta_S\": 0.5, \"eta_D\": 0.5},\n        # Case 4: strong asymmetry\n        {\"E\": 0.05, \"t\": 2.7, \"eta_S\": 2.0, \"eta_D\": 0.1},\n        # Case 5: near Dirac point with weak contacts\n        {\"E\": 0.0, \"t\": 2.7, \"eta_S\": 0.05, \"eta_D\": 0.05},\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"E\"]\n        t = case[\"t\"]\n        eta_S = case[\"eta_S\"]\n        eta_D = case[\"eta_D\"]\n        result = compute_transmission(E, t, eta_S, eta_D)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}