{
    "hands_on_practices": [
        {
            "introduction": "The electric field profile within a photodiode's depletion region governs its performance, dictating carrier collection efficiency and transit time. In an Avalanche Photodiode (APD), this field is even more critical as it drives the impact ionization process. This first exercise challenges you to derive the electric field distribution from first principles using Poisson's equation for a realistic $p$-$i$-$n$ structure with non-ideal doping, providing a foundational understanding of how device design controls its internal electrostatics .",
            "id": "3765391",
            "problem": "A one-dimensional, abrupt $p$-$i$-$n$ silicon photodiode is reverse-biased so that the entire structure is depleted. The $p$ region ($p^{+}$) has uniform acceptor concentration $N_{A} = 2.0 \\times 10^{17}\\,\\mathrm{cm}^{-3}$, the $i$ region has width $W_{i} = 3.0\\,\\mu\\mathrm{m}$ with a uniform residual donor concentration $N_{B}^{i} = 5.0 \\times 10^{14}\\,\\mathrm{cm}^{-3}$, and the $n$ region is uniformly doped with donor concentration $N_{D} = 1.0 \\times 10^{16}\\,\\mathrm{cm}^{-3}$. The semiconductor permittivity is spatially uniform, and the system is operated under a reverse bias large enough that the depletion approximation holds throughout the device.\n\nUnder these conditions, the depletion region extends a distance $x_{p}$ into the $p$ side (to the left of the $p$-$i$ metallurgical junction) and a distance $x_{n}$ into the $n$ side (to the right of the $i$-$n$ metallurgical junction). Starting from Poisson’s equation and the continuity of the electric field at each metallurgical junction, derive the relation governing the partitioning between $x_{p}$ and $x_{n}$ for asymmetric doping. Then, using that relation, compute the depletion partition ratio $x_{n}/x_{p}$ for the given dopings. Report your numerical result for $x_{n}/x_{p}$ as a dimensionless number and round your answer to three significant figures.\n\nFinally, based on your derived field profile, state whether the electric field across the $i$ layer is uniform and, if it is not, provide the symbolic expression for how the field varies across the $i$ layer over a distance $W_{i}$ in terms of the relevant quantities. No numerical evaluation is required for this part. Express the field variation in volts per meter.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in semiconductor physics, well-posed, and objective. It presents a standard, albeit nuanced, problem in device modeling that can be solved using fundamental principles.\n\nLet us begin by establishing a coordinate system. Let the metallurgical $p$-$i$ junction be at $x=0$ and the metallurgical $i$-$n$ junction be at $x=W_{i}$. The depletion region in the $p$-type material extends from $x=-x_p$ to $x=0$. The intrinsic region is fully depleted and extends from $x=0$ to $x=W_i$. The depletion region in the $n$-type material extends from $x=W_i$ to $x=W_i+x_n$.\n\nAccording to the depletion approximation, the space charge density $\\rho(x)$ is given by:\n$$\n\\rho(x) =\n\\begin{cases}\n    -q N_{A} & \\text{for } -x_p < x < 0 \\\\\n    +q N_{B}^{i} & \\text{for } 0 < x < W_{i} \\\\\n    +q N_{D} & \\text{for } W_{i} < x < W_{i} + x_n \\\\\n    0 & \\text{otherwise}\n\\end{cases}\n$$\nwhere $q$ is the elementary charge.\n\nThe derivation proceeds from Poisson's equation, $\\frac{d\\mathcal{E}}{dx} = \\frac{\\rho(x)}{\\epsilon_s}$, where $\\mathcal{E}$ is the electric field and $\\epsilon_s$ is the semiconductor permittivity. We integrate this equation with the boundary conditions that the electric field is zero at the edges of the depletion region, i.e., $\\mathcal{E}(-x_p) = 0$ and $\\mathcal{E}(W_i + x_n) = 0$.\n\n1.  **Region 1: $p$-side ($-x_p < x < 0$)**\n    Integrating from the edge of the depletion region at $-x_p$:\n    $$ \\mathcal{E}(x) = \\int_{-x_p}^{x} \\frac{-q N_{A}}{\\epsilon_s} dx' = -\\frac{q N_{A}}{\\epsilon_s} (x + x_p) $$\n    The electric field at the $p$-$i$ junction ($x=0$) is $\\mathcal{E}(0^{-}) = -\\frac{q N_{A} x_p}{\\epsilon_s}$.\n\n2.  **Region 2: $i$-region ($0 < x < W_i$)**\n    The electric field must be continuous across the junction, so $\\mathcal{E}(0^{+}) = \\mathcal{E}(0^{-})$. Integrating from $x=0$:\n    $$ \\mathcal{E}(x) = \\mathcal{E}(0^{+}) + \\int_{0}^{x} \\frac{q N_{B}^{i}}{\\epsilon_s} dx' = -\\frac{q N_{A} x_p}{\\epsilon_s} + \\frac{q N_{B}^{i} x}{\\epsilon_s} = \\frac{q}{\\epsilon_s} (N_{B}^{i} x - N_{A} x_p) $$\n    The electric field at the $i$-$n$ junction ($x=W_i$) is $\\mathcal{E}(W_i^{-}) = \\frac{q}{\\epsilon_s} (N_{B}^{i} W_i - N_{A} x_p)$.\n\n3.  **Region 3: $n$-side ($W_i < x < W_i+x_n$)**\n    Again, continuity requires $\\mathcal{E}(W_i^{+}) = \\mathcal{E}(W_i^{-})$. Integrating from $x=W_i$:\n    $$ \\mathcal{E}(x) = \\mathcal{E}(W_i^{+}) + \\int_{W_i}^{x} \\frac{q N_{D}}{\\epsilon_s} dx' = \\frac{q}{\\epsilon_s} (N_{B}^{i} W_i - N_{A} x_p) + \\frac{q N_{D}}{\\epsilon_s} (x - W_i) $$\n\nNow, we apply the second boundary condition, $\\mathcal{E}(W_i + x_n) = 0$:\n$$ 0 = \\frac{q}{\\epsilon_s} (N_{B}^{i} W_i - N_{A} x_p) + \\frac{q N_{D}}{\\epsilon_s} ((W_i + x_n) - W_i) $$\n$$ 0 = \\frac{q}{\\epsilon_s} (N_{B}^{i} W_i - N_{A} x_p) + \\frac{q N_{D} x_n}{\\epsilon_s} $$\nMultiplying by $\\frac{\\epsilon_s}{q}$ yields the relation governing the charge balance:\n$$ N_{B}^{i} W_i - N_{A} x_p + N_{D} x_n = 0 $$\nThis can be rearranged to express the partitioning between the depletion widths $x_p$ and $x_n$:\n$$ N_{A} x_p - N_{D} x_n = N_{B}^{i} W_i $$\nThis is the derived relation requested by the problem. This result is equivalent to enforcing overall charge neutrality for the space charge region.\n\nNext, we are asked to compute the depletion partition ratio $x_n / x_p$. From the derived relation, we can write:\n$$ \\frac{x_n}{x_p} = \\frac{N_{A}}{N_{D}} - \\frac{N_{B}^{i} W_i}{N_{D} x_p} $$\nThis expression shows that the ratio $x_n / x_p$ is not constant but depends on the depletion width $x_p$, which in turn depends on the applied reverse bias. However, the problem asks for a single numerical result for \"the\" depletion partition ratio, given a \"large enough\" reverse bias. This implies we should consider the asymptotic limit of large reverse bias. For a large reverse bias, the total depletion width grows, meaning $x_p$ and $x_n$ become large. In this limit, the term containing the fixed charge of the $i$-region, $N_{B}^{i} W_i$, becomes negligible compared to the growing charge in the $p$ and $n$ regions, represented by $N_{A} x_p$ and $N_{D} x_n$.\nTherefore, for large $x_p$, the term $\\frac{N_{B}^{i} W_i}{N_{D} x_p} \\to 0$. The relation simplifies to the well-known approximation for a simple $p$-$n$ junction:\n$$ N_{A} x_p \\approx N_{D} x_n $$\nIn this limit, the depletion partition ratio becomes a constant determined by the doping concentrations:\n$$ \\frac{x_n}{x_p} \\approx \\frac{N_{A}}{N_{D}} $$\nUsing the given values:\n$N_{A} = 2.0 \\times 10^{17}\\,\\mathrm{cm}^{-3}$\n$N_{D} = 1.0 \\times 10^{16}\\,\\mathrm{cm}^{-3}$\n$$ \\frac{x_n}{x_p} \\approx \\frac{2.0 \\times 10^{17}}{1.0 \\times 10^{16}} = 20 $$\nRounding to three significant figures, the ratio is $20.0$.\n\nFinally, we must determine if the electric field across the $i$-layer is uniform. From our earlier derivation, the electric field in the $i$-layer ($0 < x < W_i$) is given by:\n$$ \\mathcal{E}(x) = \\frac{q}{\\epsilon_s} (N_{B}^{i} x - N_{A} x_p) $$\nA uniform field would have a constant value, meaning its derivative with respect to position would be zero. The derivative is:\n$$ \\frac{d\\mathcal{E}}{dx} = \\frac{q N_{B}^{i}}{\\epsilon_s} $$\nGiven that the residual donor concentration in the $i$-region is non-zero, $N_{B}^{i} = 5.0 \\times 10^{14}\\,\\mathrm{cm}^{-3}$, the slope $\\frac{d\\mathcal{E}}{dx}$ is a non-zero constant. Thus, the electric field is **not uniform** across the $i$-layer; it varies linearly with position $x$.\n\nThe symbolic expression for how the field varies across the $i$-layer (for $x$ from $0$ to $W_i$) is the expression for $\\mathcal{E}(x)$ itself:\n$$ \\mathcal{E}(x) = \\frac{q}{\\epsilon_s}(N_{B}^{i} x - N_{A} x_p) $$\nThis expression gives the electric field in units of volts per meter, provided all quantities ($q$, $\\epsilon_s$, $N_{B}^{i}$, $x$, $N_A$, $x_p$) are in consistent SI units.",
            "answer": "$$\n\\boxed{20.0}\n$$"
        },
        {
            "introduction": "Ideal device models provide a starting point, but real-world performance is often limited by defects. This practice focuses on quantifying a major source of dark current: thermal generation of carriers at the device's surfaces. By relating the macroscopic dark current to a microscopic parameter known as the surface recombination velocity, you will develop a practical model for surface leakage and explore how it scales with device geometry .",
            "id": "3765331",
            "problem": "Consider a reverse-biased silicon p-intrinsic-n (p-i-n) photodiode whose intrinsic region is fully depleted. The device has a square active area with side length $200\\ \\mu\\text{m}$, so the perimeter is $4 \\times 200\\ \\mu\\text{m}$. The sidewall interface surrounding the mesa exhibits surface states that can generate electron–hole pairs under reverse bias. Model the surface leakage by introducing an effective surface recombination (generation) velocity $S$ at the sidewall interface. Assume that, under depletion and low-injection conditions with traps near midgap, the net surface pair-generation rate per unit interface area scales with the intrinsic carrier concentration $n_i$ and $S$.\n\nStarting from fundamental carrier conservation and recombination–generation boundary principles, derive an expression for the surface contribution to the dark current in terms of the surface recombination velocity $S$, the intrinsic carrier concentration $n_i$, the depleted sidewall depth $W$, and the perimeter-to-area ratio $\\frac{P}{A}$ of the device. Then, evaluate the resulting surface dark current for the following parameters:\n- $n_i = 1.0 \\times 10^{10}\\ \\text{cm}^{-3}$ at $T = 300\\ \\text{K}$,\n- $S = 5.0 \\times 10^{4}\\ \\text{cm}\\,\\text{s}^{-1}$,\n- $W = 10\\ \\mu\\text{m}$,\n- Active area $A = (200\\ \\mu\\text{m}) \\times (200\\ \\mu\\text{m})$,\n- Perimeter $P = 4 \\times 200\\ \\mu\\text{m}$.\n\nRound your final answer to four significant figures and express it in nanoamperes (nA). Use the elementary charge $q$ symbolically in your derivation, and take $q$ at its defined value when computing the final numerical result. You may treat the surface generation as occurring uniformly along the depleted sidewall area.",
            "solution": "The problem asks for the derivation and calculation of the surface contribution to the dark current in a reverse-biased $p$-$i$-$n$ photodiode. The problem is scientifically grounded, well-posed, and contains sufficient information for a unique solution.\n\nThe dark current in a semiconductor device is the current that flows in the absence of illumination. In a reverse-biased photodiode, a primary source of dark current is the thermal generation of electron-hole pairs (EHPs) within the depletion region and at defective surfaces or interfaces. This problem directs us to consider only the contribution from the device's sidewall surface.\n\nThe generation of EHPs at a semiconductor surface is typically described by the Shockley-Read-Hall (SRH) recombination-generation theory, adapted for surface states. The problem provides a simplified model where the net surface generation rate per unit area, denoted as $G_s$, is proportional to the surface recombination (generation) velocity $S$ and the intrinsic carrier concentration $n_i$. This is a standard and valid approximation for a surface under strong depletion, where the concentrations of both electrons ($n$) and holes ($p$) are negligible compared to $n_i$. In this limit ($n, p \\ll n_i$), the SRH formula simplifies to a net generation rate. The magnitude of this rate is given by:\n$$G_s = S n_i$$\nThe units of $S$ are typically $\\text{cm}\\,\\text{s}^{-1}$ and the units of $n_i$ are $\\text{cm}^{-3}$, so the units of $G_s$ are $\\text{cm}^{-2}\\,\\text{s}^{-1}$, representing the number of EHPs generated per unit area per unit time.\n\nThis generation process occurs over the entire depleted surface of the device's sidewall. The geometry of this surface is a \"curtain\" with a length equal to the perimeter of the device, $P$, and a height equal to the depth of the depleted region, $W$. Therefore, the total area of the generating surface, $A_{surf}$, is:\n$$A_{surf} = P \\times W$$\n\nThe total rate of EHP generation from the surface, $\\mathcal{G}_{total}$, is the product of the generation rate per unit area, $G_s$, and the total surface area, $A_{surf}$:\n$$\\mathcal{G}_{total} = G_s \\times A_{surf} = (S n_i) \\times (P W)$$\nThis quantity, $\\mathcal{G}_{total}$, has units of $\\text{s}^{-1}$ and represents the total number of EHPs generated per second from the sidewall.\n\nEach EHP generated within the depletion region is separated by the high electric field and swept towards the contacts, with the electron moving to the n-side and the hole to the p-side. This movement of charge constitutes an electrical current. Since each EHP contributes one elementary charge, $q$, to the total charge flow, the resulting surface dark current, $I_{dark, surf}$, is the total generation rate multiplied by $q$:\n$$I_{dark, surf} = q \\cdot \\mathcal{G}_{total}$$\nSubstituting the expression for $\\mathcal{G}_{total}$, we arrive at the derived expression for the surface dark current:\n$$I_{dark, surf} = q S n_i P W$$\n\nThe problem asks for an expression in terms of the perimeter-to-area ratio, $P/A$. While the total current depends on the perimeter $P$, not the ratio $P/A$, it is instructive to consider the surface-generated dark current *density*, $J_{dark, surf}$, normalized to the device's active (optical) area, $A$. This figure of merit is useful for comparing devices of different sizes.\n$$J_{dark, surf} = \\frac{I_{dark, surf}}{A} = \\frac{q S n_i P W}{A} = q S n_i W \\left(\\frac{P}{A}\\right)$$\nThis expression highlights a key scaling law for mesa-isolated devices: as the device's lateral dimensions shrink, the perimeter-to-area ratio ($P/A$) increases (e.g., for a square device of side length $L$, $P/A = 4L/L^2 = 4/L$), causing the surface leakage current density to become a more dominant contribution to the total dark current. The expression for the total current can be written as $I_{dark, surf} = J_{dark, surf} \\times A$, which is consistent with our primary derivation. For the calculation, we will use the direct expression $I_{dark, surf} = q S n_i P W$.\n\nNow, we evaluate the numerical value of the surface dark current using the provided parameters. First, we ensure all units are consistent. We will use centimeters (cm) as the base unit for length.\n- Elementary charge: $q = 1.602176634 \\times 10^{-19}\\ \\text{C}$\n- Intrinsic carrier concentration: $n_i = 1.0 \\times 10^{10}\\ \\text{cm}^{-3}$\n- Surface recombination velocity: $S = 5.0 \\times 10^{4}\\ \\text{cm}\\,\\text{s}^{-1}$\n- Depleted sidewall depth: $W = 10\\ \\mu\\text{m} = 10 \\times 10^{-4}\\ \\text{cm} = 1.0 \\times 10^{-3}\\ \\text{cm}$\n- Perimeter: $P = 4 \\times 200\\ \\mu\\text{m} = 800\\ \\mu\\text{m} = 800 \\times 10^{-4}\\ \\text{cm} = 8.0 \\times 10^{-2}\\ \\text{cm}$\n\nSubstituting these values into the derived formula:\n$$I_{dark, surf} = (1.602176634 \\times 10^{-19}\\ \\text{C}) \\times (5.0 \\times 10^{4}\\ \\text{cm}\\,\\text{s}^{-1}) \\times (1.0 \\times 10^{10}\\ \\text{cm}^{-3}) \\times (8.0 \\times 10^{-2}\\ \\text{cm}) \\times (1.0 \\times 10^{-3}\\ \\text{cm})$$\nThe units combine as $\\text{C} \\times (\\text{cm}\\,\\text{s}^{-1}) \\times \\text{cm}^{-3} \\times \\text{cm} \\times \\text{cm} = \\text{C} \\cdot \\text{s}^{-1} = \\text{A}$ (Amperes), which is correct for current.\n\nLet's compute the numerical value:\n$$I_{dark, surf} = (1.602176634 \\times 5.0 \\times 1.0 \\times 8.0 \\times 1.0) \\times 10^{-19+4+10-2-3}\\ \\text{A}$$\n$$I_{dark, surf} = (64.08706536) \\times 10^{-10}\\ \\text{A}$$\n$$I_{dark, surf} = 6.408706536 \\times 10^{-9}\\ \\text{A}$$\nThe problem asks for the answer in nanoamperes (nA), where $1\\ \\text{nA} = 10^{-9}\\ \\text{A}$.\n$$I_{dark, surf} = 6.408706536\\ \\text{nA}$$\nFinally, we must round the result to four significant figures:\n$$I_{dark, surf} \\approx 6.409\\ \\text{nA}$$",
            "answer": "$$\n\\boxed{6.409}\n$$"
        },
        {
            "introduction": "Avalanche photodiodes achieve high sensitivity through internal gain ($M$), but this stochastic process introduces excess noise, quantified by the excess noise factor $F(M)$. This practice guides you through the process of extracting the fundamental ionization coefficient ratio, $k = \\beta/\\alpha$, by fitting experimental data to the seminal McIntyre noise formula. This exercise not only provides a key characterization skill but also prompts a deeper look into the physical limitations of the underlying local-field model .",
            "id": "3765395",
            "problem": "You are given noisy measurements of the excess noise factor $F(M)$ versus multiplication $M$ for avalanche photodiodes (APDs) under electron injection. The foundational base to use is the McIntyre excess noise model derived under the local ionization coefficient assumption and spatially uniform electric field in the multiplication region. For electron injection, the well-tested formula is\n$$\nF(M) = k\\,M + (1 - k)\\left(2 - \\frac{1}{M}\\right),\n$$\nwhere $k$ is the ratio of hole to electron ionization coefficients, $k = \\beta/\\alpha$, and $M$ is the mean multiplication factor. You must construct a method to extract $k$ from measured pairs $(M_i, F_i)$ by linear regression of a suitable linearization of the McIntyre formula. Discuss the role of nonlocal ionization effects (such as dead-space) on the uncertainty and potential bias of the extracted $k$.\n\nStarting from the given base, derive a linear regression procedure that uses transformed variables to estimate $k$ robustly. Your program must implement this estimator and compute $k$ for the provided test suite. In addition, your solution must explain the uncertainty sources, including the impact of departures from the local model on the estimator.\n\nAll results are dimensionless. Express the final numerical results as floating-point values rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[0.150000,0.400000,0.038500,0.200800]$.\n\nTest Suite:\n- Case $1$ (happy path, moderate $M$, slight measurement deviations): Given $M = [2, 3, 5, 10]$ and measured $F = [1.580, 1.860, 2.275, 3.120]$, estimate $k$.\n- Case $2$ (happy path, larger $M$, ideal data under the local model): Given $M = [3, 7, 12, 20]$ and measured $F = [2.2, 3.914285714, 5.95, 9.17]$, estimate $k$.\n- Case $3$ (nonlocal effect present, systematic reduction of $F(M)$ relative to the local model): Given $M = [2, 4, 8, 16]$ and measured $F = [1.4875, 1.778125, 2.06640625, 2.5087890625]$, estimate $k$.\n- Case $4$ (boundary-like regime with $M$ close to unity, slight measurement deviations): Given $M = [1.2, 1.5, 2.0, 3.0]$ and measured $F = [1.1633333, 1.3716667, 1.597, 1.9353333]$, estimate $k$.\n\nAlgorithmic output specification:\n- For each case, form the transformed variables $x_i = M_i - \\left(2 - \\frac{1}{M_i}\\right)$ and $y_i = F_i - \\left(2 - \\frac{1}{M_i}\\right)$, and then estimate $k$ via an ordinary least squares regression constrained through the origin, i.e.,\n$$\n\\hat{k} = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2}.\n$$\n- Aggregate the four estimated values $[\\hat{k}_1, \\hat{k}_2, \\hat{k}_3, \\hat{k}_4]$ into the final single-line output, rounded to six decimal places, as specified above.",
            "solution": "The problem requires the estimation of the ionization coefficient ratio, $k = \\beta/\\alpha$, for an avalanche photodiode (APD) from a set of noisy measurements of excess noise factor $F$ versus multiplication gain $M$. The analysis is to be based on the local McIntyre excess noise model for pure electron injection. Subsequently, the solution must discuss the physical limitations of this model, specifically the impact of nonlocal ionization effects.\n\nFirst, we must validate and formalize the estimation procedure. The given model is:\n$$\nF(M) = k\\,M + (1 - k)\\left(2 - \\frac{1}{M}\\right)\n$$\nwhere $F(M)$ is the excess noise factor, $M$ is the multiplication gain, and $k$ is the ratio of hole-to-electron ionization coefficients. The objective is to estimate $k$ from a series of measurement pairs $(M_i, F_i)$. To employ linear regression, we must linearize the model with respect to the parameter $k$. We can rearrange the equation by expanding the terms and collecting all terms containing $k$:\n$$\nF(M) = kM + 2 - \\frac{1}{M} - 2k + \\frac{k}{M}\n$$\nGrouping the terms multiplied by $k$:\n$$\nF(M) = k\\left(M - 2 + \\frac{1}{M}\\right) + \\left(2 - \\frac{1}{M}\\right)\n$$\nBy moving the non-$k$ term to the left-hand side, we obtain a linear relationship:\n$$\nF(M) - \\left(2 - \\frac{1}{M}\\right) = k\\left(M - 2 + \\frac{1}{M}\\right)\n$$\nThis equation is of the form $y = kx$, which represents a straight line passing through the origin. The problem statement correctly defines the transformed variables for a set of discrete measurements $(M_i, F_i)$:\n$$\ny_i = F_i - \\left(2 - \\frac{1}{M_i}\\right)\n$$\n$$\nx_i = M_i - \\left(2 - \\frac{1}{M_i}\\right) = M_i - 2 + \\frac{1}{M_i}\n$$\nFor a set of $N$ data points $(x_i, y_i)$, we seek the value of $k$ that best fits the model $y_i = kx_i + \\epsilon_i$, where $\\epsilon_i$ represents measurement noise and model error. The method of ordinary least squares (OLS) minimizes the sum of squared residuals, $S(k) = \\sum_{i=1}^{N} (y_i - kx_i)^2$. To find the minimum, we differentiate $S(k)$ with respect to $k$ and set the result to zero:\n$$\n\\frac{dS(\\hat{k})}{dk} = \\sum_{i=1}^{N} -2x_i(y_i - \\hat{k}x_i) = -2\\left(\\sum_{i=1}^{N} x_i y_i - \\hat{k}\\sum_{i=1}^{N} x_i^2\\right) = 0\n$$\nSolving for the estimator $\\hat{k}$ gives the formula specified in the problem:\n$$\n\\hat{k} = \\frac{\\sum_{i=1}^{N} x_i y_i}{\\sum_{i=1}^{N} x_i^2}\n$$\nThis is the OLS estimator for a linear regression model constrained to pass through the origin.\n\nA critical aspect of this problem is to address the limitations of the underlying physical model. The McIntyre formula is derived under the *local model* assumption. This model posits that the probability per unit length of an electron or hole causing an impact ionization event, characterized by ionization coefficients $\\alpha$ and $\\beta$ respectively, depends solely on the electric field at that exact point.\n\nIn physical reality, charge carriers must gain a certain threshold energy from the electric field before they are capable of impact ionization. This requires traversing a finite, non-zero distance known as the \"dead space,\" during which their probability of ionization is effectively zero. This phenomenon, which is a key component of *nonlocal* ionization theory, introduces a degree of determinism into the otherwise stochastic avalanche process. By reducing the randomness in the locations of ionization events, the dead space effect leads to a multiplication process that is more ordered and thus less noisy.\n\nConsequently, for a given multiplication gain $M$, a real APD where nonlocal effects are significant will exhibit a lower excess noise factor $F(M)$ than predicted by the local McIntyre model. If one attempts to fit the local model to experimental data from such a device, the measured $F_i$ values will be systematically lower than the model predicts. In our linearized form, this means the $y_i$ values are smaller than they \"should\" be for the corresponding $x_i$. This systematic discrepancy causes the OLS estimator, $\\hat{k}$, to be biased. Specifically, the extracted value $\\hat{k}$ will be an *underestimate* of the true physical ionization coefficient ratio $k=\\beta/\\alpha$. This bias is more pronounced in APDs with thin multiplication regions, where the dead space constitutes a larger fraction of the total length. Case $3$ of the test suite is designed to illustrate this very effect, where the provided $F$ values are systematically low, leading to a much smaller estimated $\\hat{k}$ compared to what might be expected for common semiconductor materials.\n\nThe provided algorithm is now applied to the four test cases. For each case, the given $M_i$ and $F_i$ data are used to compute the transformed variables $x_i$ and $y_i$. Then, the sums $\\sum x_i y_i$ and $\\sum x_i^2$ are calculated, and the ratio gives the estimated value $\\hat{k}$. The results are rounded to six decimal places as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the ionization coefficient ratio 'k' for four test cases\n    using a linearized McIntyre model and OLS regression through the origin.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"M\": np.array([2, 3, 5, 10]),\n            \"F\": np.array([1.580, 1.860, 2.275, 3.120])\n        },\n        {\n            \"M\": np.array([3, 7, 12, 20]),\n            \"F\": np.array([2.2, 3.914285714, 5.95, 9.17])\n        },\n        {\n            \"M\": np.array([2, 4, 8, 16]),\n            \"F\": np.array([1.4875, 1.778125, 2.06640625, 2.5087890625])\n        },\n        {\n            \"M\": np.array([1.2, 1.5, 2.0, 3.0]),\n            \"F\": np.array([1.1633333, 1.3716667, 1.597, 1.9353333])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        M = case[\"M\"]\n        F = case[\"F\"]\n        \n        # The problem requires a linear regression on transformed variables.\n        # The model is F(M) = k*M + (1-k)*(2 - 1/M).\n        # Rearranging gives: F - (2 - 1/M) = k * (M - 2 + 1/M).\n        # Let y = F - (2 - 1/M) and x = M - 2 + 1/M.\n        # The problem statement defines x as M - (2-1/M), which is M - 2 + 1/M.\n        \n        # Calculate the transformation term (2 - 1/M)\n        transformation_term = 2 - (1 / M)\n        \n        # Compute the transformed variables x and y\n        y = F - transformation_term\n        x = M - transformation_term\n\n        # Calculate the OLS estimator for regression through the origin:\n        # k_hat = sum(x*y) / sum(x^2)\n        sum_xy = np.sum(x * y)\n        sum_x_squared = np.sum(x**2)\n        \n        if sum_x_squared == 0:\n            # Avoid division by zero, although not expected with given data.\n            k_hat = 0.0\n        else:\n            k_hat = sum_xy / sum_x_squared\n            \n        results.append(k_hat)\n\n    # Format the results as a comma-separated string with six decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}