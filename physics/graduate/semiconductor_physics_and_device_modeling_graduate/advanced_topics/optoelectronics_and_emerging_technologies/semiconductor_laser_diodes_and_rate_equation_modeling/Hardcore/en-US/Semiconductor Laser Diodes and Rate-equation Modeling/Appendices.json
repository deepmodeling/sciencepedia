{
    "hands_on_practices": [
        {
            "introduction": "Before we can model the dynamics of an entire laser diode, we must first understand its heart: the active gain medium. This exercise focuses on a widely used logarithmic gain model for quantum well lasers and connects it to the fundamental concept of transparency—the point at which the material neither absorbs nor amplifies light. By working through this problem , you will practice extracting a critical physical parameter, the transparency carrier density $N_{\\mathrm{tr}}$, from experimental data, reinforcing the physical basis of the gain term that drives the laser rate equations.",
            "id": "3771999",
            "problem": "A single quantum well (QW) semiconductor laser diode is characterized by a material gain model of the form $g(N)=g_{0}\\ln\\!\\big(N/N_{\\mathrm{tr}}\\big)$, where $N$ is the areal carrier density in the QW (units $\\mathrm{cm}^{-2}$), $g(N)$ is the material gain (units $\\mathrm{cm}^{-1}$), $g_{0}$ is a positive constant, and $N_{\\mathrm{tr}}$ is the transparency carrier density (units $\\mathrm{cm}^{-2}$). In a separate characterization using spontaneous emission calibrated to carrier density, an operating point $N=N_{1}$ produced a measured material gain $g(N_{1})$. Assume the following experimentally determined values: $N_{1}=6.00\\times 10^{12}\\ \\mathrm{cm}^{-2}$, $g(N_{1})=600\\ \\mathrm{cm}^{-1}$, and $g_{0}=1500\\ \\mathrm{cm}^{-1}$. \n\nStarting from first principles appropriate to rate-equation modeling of semiconductor lasers, use the fundamental definition of transparency to derive an explicit expression for $N_{\\mathrm{tr}}$ in terms of $N_{1}$, $g(N_{1})$, and $g_{0}$, and then compute its numerical value. Round your final numerical answer to four significant figures and express it in $\\mathrm{cm}^{-2}$. In addition, explain the physical meaning of $g_{0}$ in the context of a QW laser, grounding your explanation in the microscopic origin of material gain rather than device-specific empirical correlations.\n\nYour final answer must be a single real number. Do not include units in the final boxed answer.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\nThe verbatim givens extracted from the problem statement are:\n- A single quantum well (QW) semiconductor laser diode is characterized by a material gain model of the form $g(N)=g_{0}\\ln\\!\\big(N/N_{\\mathrm{tr}}\\big)$.\n- $N$ is the areal carrier density in the QW (units $\\mathrm{cm}^{-2}$).\n- $g(N)$ is the material gain (units $\\mathrm{cm}^{-1}$).\n- $g_{0}$ is a positive constant.\n- $N_{\\mathrm{tr}}$ is the transparency carrier density (units $\\mathrm{cm}^{-2}$).\n- An operating point is $N=N_{1}$.\n- This point produced a measured material gain $g(N_{1})$.\n- $N_{1}=6.00\\times 10^{12}\\ \\mathrm{cm}^{-2}$.\n- $g(N_{1})=600\\ \\mathrm{cm}^{-1}$.\n- $g_{0}=1500\\ \\mathrm{cm}^{-1}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is grounded in the well-established field of semiconductor laser physics. The logarithmic gain model, $g(N)=g_{0}\\ln(N/N_{\\mathrm{tr}})$, is a standard and widely used empirical model for quantum well lasers, representing a good approximation of gain behavior derived from more fundamental theories involving Fermi-Dirac statistics in a two-dimensional system.\n2.  **Well-Posed**: The problem provides a specific model and sufficient data to determine the single unknown parameter, $N_{\\mathrm{tr}}$. The question is clearly stated, and a unique, stable solution exists.\n3.  **Objective**: The problem is expressed in precise, quantitative, and unbiased language.\n4.  **Completeness and Consistency**: All necessary parameters ($N_1$, $g(N_1)$, $g_0$) are provided to solve for $N_{\\mathrm{tr}}$. The units are consistent, and the given values are physically realistic for typical InGaAs/AlGaAs or similar QW laser systems.\n5.  **No other flaws detected**: The problem does not violate any of the other criteria for validity. It is a standard, solvable problem in optoelectronics.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be developed.\n\n### Solution Derivation\n\nThe solution consists of three parts: (1) deriving an explicit expression for the transparency carrier density $N_{\\mathrm{tr}}$, (2) computing its numerical value, and (3) explaining the physical meaning of the gain parameter $g_0$.\n\n**Part 1: Derivation of an expression for $N_{\\mathrm{tr}}$**\n\nThe derivation begins with the fundamental definition of transparency in the context of a gain medium. Transparency is the condition where the medium is neither amplifying nor absorbing light at the wavelength of interest. This occurs when the rate of stimulated emission is exactly equal to the rate of stimulated absorption. At this point, the net material gain $g(N)$ is zero. The carrier density at which this occurs is, by definition, the transparency carrier density, $N_{\\mathrm{tr}}$.\n\nMathematically, this is expressed as:\n$$\ng(N = N_{\\mathrm{tr}}) = 0\n$$\nThe problem provides the gain model for the quantum well laser:\n$$\ng(N) = g_0 \\ln\\left(\\frac{N}{N_{\\mathrm{tr}}}\\right)\n$$\nApplying the definition of transparency to this model, we can verify its internal consistency:\n$$\ng(N_{\\mathrm{tr}}) = g_0 \\ln\\left(\\frac{N_{\\mathrm{tr}}}{N_{\\mathrm{tr}}}\\right) = g_0 \\ln(1) = 0\n$$\nThis confirms that the parameter $N_{\\mathrm{tr}}$ in the model correctly represents the transparency carrier density.\n\nTo find an explicit expression for $N_{\\mathrm{tr}}$, we use the experimentally measured data point $(N_1, g(N_1))$. We substitute these values into the gain model equation:\n$$\ng(N_1) = g_0 \\ln\\left(\\frac{N_1}{N_{\\mathrm{tr}}}\\right)\n$$\nOur goal is to solve this equation for $N_{\\mathrm{tr}}$. We proceed with algebraic manipulation. First, divide both sides by $g_0$:\n$$\n\\frac{g(N_1)}{g_0} = \\ln\\left(\\frac{N_1}{N_{\\mathrm{tr}}}\\right)\n$$\nTo eliminate the natural logarithm, we exponentiate both sides of the equation (i.e., take $e$ to the power of each side):\n$$\n\\exp\\left(\\frac{g(N_1)}{g_0}\\right) = \\exp\\left(\\ln\\left(\\frac{N_1}{N_{\\mathrm{tr}}}\\right)\\right) = \\frac{N_1}{N_{\\mathrm{tr}}}\n$$\nFinally, we rearrange the equation to isolate $N_{\\mathrm{tr}}$:\n$$\nN_{\\mathrm{tr}} = \\frac{N_1}{\\exp\\left(\\frac{g(N_1)}{g_0}\\right)}\n$$\nThis expression can be written more compactly as:\n$$\nN_{\\mathrm{tr}} = N_1 \\exp\\left(-\\frac{g(N_1)}{g_0}\\right)\n$$\nThis is the required explicit expression for $N_{\\mathrm{tr}}$ in terms of the given quantities $N_1$, $g(N_1)$, and $g_0$.\n\n**Part 2: Numerical Calculation of $N_{\\mathrm{tr}}$**\n\nWe now substitute the provided numerical values into the derived expression:\n- $N_1 = 6.00 \\times 10^{12} \\ \\mathrm{cm}^{-2}$\n- $g(N_1) = 600 \\ \\mathrm{cm}^{-1}$\n- $g_0 = 1500 \\ \\mathrm{cm}^{-1}$\n\nThe ratio in the exponent is a dimensionless quantity, as required:\n$$\n\\frac{g(N_1)}{g_0} = \\frac{600}{1500} = \\frac{2}{5} = 0.4\n$$\nNow, substitute this into the expression for $N_{\\mathrm{tr}}$:\n$$\nN_{\\mathrm{tr}} = (6.00 \\times 10^{12}) \\times \\exp(-0.4)\n$$\nCalculating the value of the exponential term:\n$$\n\\exp(-0.4) \\approx 0.6703200459\n$$\nMultiplying by $N_1$:\n$$\nN_{\\mathrm{tr}} \\approx (6.00 \\times 10^{12}) \\times 0.6703200459 \\approx 4.021920275 \\times 10^{12}\n$$\nThe problem requires rounding the final answer to four significant figures.\n$$\nN_{\\mathrm{tr}} \\approx 4.022 \\times 10^{12} \\ \\mathrm{cm}^{-2}\n$$\n\n**Part 3: Physical Meaning of $g_0$**\n\nThe parameter $g_0$, often called the gain coefficient, is a phenomenological constant in the logarithmic gain model. Its physical meaning is rooted in the microscopic physics of light-matter interaction in the quantum well. Material gain $g$ arises from the net effect of stimulated emission and stimulated absorption. The rate of these processes depends on the density of available electronic states and the probability that these states are occupied by carriers (electrons and holes), as described by Fermi-Dirac statistics.\n\nThe gain at a photon energy $\\hbar\\omega$ is proportional to the joint density of states and the population inversion factor, $(f_c - f_v)$, where $f_c$ and $f_v$ are the Fermi-Dirac occupation probabilities for electrons in the conduction band and valence band, respectively. The logarithmic gain model is an empirical fit to the peak of this gain spectrum, $g_{\\mathrm{peak}}$, as a function of carrier density $N$.\n\nThe parameter $g_0$ is a composite term that quantifies the intrinsic efficiency of the gain medium. It lumps together two fundamental microscopic properties:\n1.  **The Optical Matrix Element:** This quantum mechanical term, $|M|^2$, quantifies the strength of the interaction between an electron-hole pair and a photon. A larger matrix element corresponds to a higher probability of a radiative transition (stimulated emission), leading to higher gain.\n2.  **The Density of States (DOS):** The gain is proportional to the number of available electronic states that can participate in the optical transition. Quantum wells exhibit a two-dimensional, step-like DOS, which concentrates states near the band edges. This concentration is a primary reason why QW lasers are more efficient and have higher gain coefficients than bulk lasers.\n\nEssentially, $g_0$ sets the scale for how effectively injected carriers are converted into material gain. A material with a strong optical transition (large matrix element) and a high density of states will exhibit a large $g_0$. This means that for a given fractional increase in carrier density above transparency (i.e., a given value of $\\ln(N/N_{\\mathrm{tr}})$), the material will produce a larger amount of gain. The differential gain, $dg/dN = g_0/N$, shows explicitly that $g_0$ scales the responsiveness of gain to changes in carrier density.",
            "answer": "$$\n\\boxed{4.022 \\times 10^{12}}\n$$"
        },
        {
            "introduction": "The dynamic response of a laser diode is critical for its primary application in high-speed optical communications. This behavior is governed by the coupled rate equations for carrier and photon densities, which describe their intricate dance. In this practice , you will use the powerful technique of small-signal analysis to linearize these equations and derive the laser's modulation frequency response, revealing the characteristic relaxation resonance that dictates its maximum speed.",
            "id": "3771994",
            "problem": "Consider a single-mode semiconductor Light Amplification by Stimulated Emission of Radiation (LASER) diode whose longitudinal photon density $S(t)$ and carrier density $N(t)$ are governed by the standard coupled rate equations for a uniform active region, neglecting spontaneous emission into the lasing mode above threshold:\n$$\\frac{dN}{dt}=\\frac{I(t)}{q V}-\\frac{N}{\\tau_{s}}-\\Gamma v_{g} g(N) S,$$\n$$\\frac{dS}{dt}=\\Gamma v_{g} g(N) S-\\frac{S}{\\tau_{p}},$$\nwhere $I(t)=I_{0}+I_{1}\\cos(\\omega t)$ is the injection current with a small sinusoidal modulation amplitude $I_{1}$ around a direct current bias $I_{0}$, $q$ is the elementary charge, $V$ is the electrically pumped active volume, $\\tau_{s}$ is the carrier lifetime, $\\tau_{p}$ is the photon lifetime, $\\Gamma$ is the optical confinement factor, $v_{g}$ is the group velocity, and $g(N)$ is the material gain. The material gain is assumed linearized around transparency as $g(N)=g_{d}\\big(N-N_{\\mathrm{tr}}\\big)$, where $g_{d}$ is the differential gain and $N_{\\mathrm{tr}}$ is the transparency carrier density.\n\nThe diode parameters are:\n- $\\Gamma=0.30$,\n- $v_{g}=8.0\\times 10^{7}\\,\\mathrm{m/s}$,\n- $g_{d}=2.0\\times 10^{-20}\\,\\mathrm{m}^{2}$,\n- $N_{\\mathrm{tr}}=1.0\\times 10^{24}\\,\\mathrm{m}^{-3}$,\n- $\\tau_{p}=2.0\\times 10^{-12}\\,\\mathrm{s}$,\n- $\\tau_{s}=1.0\\times 10^{-9}\\,\\mathrm{s}$,\n- $V=1.2\\times 10^{-16}\\,\\mathrm{m}^{3}$,\n- $q=1.602\\times 10^{-19}\\,\\mathrm{C}$,\n- $I_{0}=0.060\\,\\mathrm{A}$.\n\nAssume steady lasing operation above threshold and linearize the coupled rate equations about the steady state $\\big(N_{0},S_{0}\\big)$ produced by $I_{0}$. From first principles, derive the small-signal frequency response from $I_{1}\\cos(\\omega t)$ to the photon-density modulation $S(t)$ and use it to determine, at the relaxation resonance angular frequency $\\omega=\\omega_{r}$, the following quantities:\n- the amplitude of $S(t)$ relative to its direct current gain (i.e., the dimensionless ratio of the magnitude at $\\omega$ to the magnitude at $\\omega=0$),\n- the phase of $S(t)$ with respect to the injection current modulation, expressed in radians.\n\nRound the amplitude ratio to four significant figures. Express the phase in radians exactly. Report your final answer as a two-entry row matrix using the format specified, where the first entry is the dimensionless amplitude ratio and the second entry is the phase angle in radians.",
            "solution": "The user wants to solve a semiconductor laser diode problem.\n\n### Step 1: Extract Givens\nThe problem provides the following coupled rate equations for photon density $S(t)$ and carrier density $N(t)$:\n$$\n\\frac{dN}{dt} = \\frac{I(t)}{q V} - \\frac{N}{\\tau_{s}} - \\Gamma v_{g} g(N) S\n$$\n$$\n\\frac{dS}{dt} = \\Gamma v_{g} g(N) S - \\frac{S}{\\tau_{p}}\n$$\nThe injection current is $I(t) = I_{0} + I_{1}\\cos(\\omega t)$.\nThe material gain is linearized as $g(N) = g_{d}(N - N_{\\mathrm{tr}})$.\nThe given parameters are:\n- Optical confinement factor, $\\Gamma = 0.30$\n- Group velocity, $v_{g} = 8.0 \\times 10^{7}\\,\\mathrm{m/s}$\n- Differential gain, $g_{d} = 2.0 \\times 10^{-20}\\,\\mathrm{m}^{2}$\n- Transparency carrier density, $N_{\\mathrm{tr}} = 1.0 \\times 10^{24}\\,\\mathrm{m}^{-3}$\n- Photon lifetime, $\\tau_{p} = 2.0 \\times 10^{-12}\\,\\mathrm{s}$\n- Carrier lifetime, $\\tau_{s} = 1.0 \\times 10^{-9}\\,\\mathrm{s}$\n- Active volume, $V = 1.2 \\times 10^{-16}\\,\\mathrm{m}^{3}$\n- Elementary charge, $q = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n- DC bias current, $I_{0} = 0.060\\,\\mathrm{A}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is based on the standard rate-equation model for a single-mode semiconductor laser, a cornerstone of semiconductor optoelectronics. This model is scientifically well-established. The use of a linearized gain is a standard and valid approximation for small-signal analysis. All required parameters are provided, and their values are physically realistic for a typical laser diode. The problem asks for a small-signal frequency response analysis, which is a standard, well-posed technique in this field. The problem statement is self-contained, objective, and scientifically grounded. It does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe solution proceeds in four main steps:\n1.  Determine the steady-state operating point $(N_0, S_0)$ for the DC bias current $I_0$.\n2.  Linearize the rate equations around this steady-state point for small sinusoidal modulations.\n3.  Derive the small-signal frequency response transfer function $H(\\omega)$.\n4.  Evaluate the required quantities (amplitude ratio and phase) at the relaxation resonance frequency $\\omega_r$.\n\n**1. Steady-State Analysis**\n\nIn the steady state, the time derivatives are zero ($\\frac{dN}{dt} = 0$, $\\frac{dS}{dt} = 0$) and the current is the DC bias $I = I_0$. The rate equations become:\n$$\n0 = \\frac{I_0}{q V} - \\frac{N_0}{\\tau_s} - \\Gamma v_g g(N_0) S_0\n$$\n$$\n0 = \\Gamma v_g g(N_0) S_0 - \\frac{S_0}{\\tau_p}\n$$\nFor lasing to occur, the photon density must be non-zero ($S_0 > 0$). From the second equation, this implies:\n$$\n\\Gamma v_g g(N_0) = \\frac{1}{\\tau_p}\n$$\nThis condition means that the modal gain exactly balances the total cavity losses. The carrier density $N_0$ is thus clamped at the threshold value, $N_0 = N_{\\mathrm{th}}$. Substituting the linearized gain $g(N) = g_d(N - N_{\\mathrm{tr}})$:\n$$\n\\Gamma v_g g_d (N_0 - N_{\\mathrm{tr}}) = \\frac{1}{\\tau_p}\n$$\nSolving for $N_0$:\n$$\nN_0 = N_{\\mathrm{th}} = N_{\\mathrm{tr}} + \\frac{1}{\\Gamma v_g g_d \\tau_p}\n$$\nNow, substitute the gain-loss balance condition $\\Gamma v_g g(N_0) = 1/\\tau_p$ into the first steady-state equation to solve for $S_0$:\n$$\n0 = \\frac{I_0}{q V} - \\frac{N_0}{\\tau_s} - \\frac{S_0}{\\tau_p}\n$$\n$$\nS_0 = \\tau_p \\left( \\frac{I_0}{q V} - \\frac{N_0}{\\tau_s} \\right)\n$$\n\nFirst, we calculate the numerical value for $N_0$:\n$$\n\\Gamma v_g g_d \\tau_p = (0.30)(8.0 \\times 10^7 \\, \\mathrm{m/s})(2.0 \\times 10^{-20} \\, \\mathrm{m}^2)(2.0 \\times 10^{-12} \\, \\mathrm{s}) = 9.6 \\times 10^{-25} \\, \\mathrm{m}^3\n$$\n$$\nN_0 = 1.0 \\times 10^{24} \\, \\mathrm{m}^{-3} + \\frac{1}{9.6 \\times 10^{-25} \\, \\mathrm{m}^3} = 1.0 \\times 10^{24} + 1.04166\\overline{6} \\times 10^{24} \\, \\mathrm{m}^{-3} = 2.04166\\overline{6} \\times 10^{24} \\, \\mathrm{m}^{-3}\n$$\nNext, we calculate $S_0$:\n$$\n\\frac{I_0}{qV} = \\frac{0.060 \\, \\mathrm{A}}{(1.602 \\times 10^{-19} \\, \\mathrm{C})(1.2 \\times 10^{-16} \\, \\mathrm{m}^3)} = 3.12109... \\times 10^{33} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3}\n$$\n$$\n\\frac{N_0}{\\tau_s} = \\frac{2.04166\\overline{6} \\times 10^{24} \\, \\mathrm{m}^{-3}}{1.0 \\times 10^{-9} \\, \\mathrm{s}} = 2.04166\\overline{6} \\times 10^{33} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3}\n$$\n$$\nS_0 = (2.0 \\times 10^{-12} \\, \\mathrm{s}) \\left( 3.12109... \\times 10^{33} - 2.04166\\overline{6} \\times 10^{33} \\right) \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3} = 2.15886... \\times 10^{21} \\, \\mathrm{m}^{-3}\n$$\nSince $S_0 > 0$, the laser is operating above threshold, as assumed.\n\n**2. Small-Signal Linearization**\nLet $N(t) = N_0 + n(t)$, $S(t) = S_0 + s(t)$, and $I(t) = I_0 + i(t)$, where $n(t)$, $s(t)$, and $i(t)$ are small time-varying perturbations. We substitute these into the rate equations and keep only linear terms in the small quantities.\nFor the carrier rate equation:\n$$\n\\frac{d(N_0+n)}{dt} = \\frac{I_0+i}{qV} - \\frac{N_0+n}{\\tau_s} - \\Gamma v_g g_d(N_0+n-N_{\\mathrm{tr}})(S_0+s)\n$$\n$$\n\\frac{dn}{dt} = \\frac{i}{qV} - \\frac{n}{\\tau_s} - \\Gamma v_g g_d [ (N_0-N_{\\mathrm{tr}})s + nS_0 ] - \\mathcal{O}(ns)\n$$\nUsing $g(N_0) = g_d(N_0-N_{\\mathrm{tr}})$ and $\\Gamma v_g g(N_0) = 1/\\tau_p$:\n$$\n\\frac{dn}{dt} = \\frac{i}{qV} - \\frac{n}{\\tau_s} - \\frac{s}{\\tau_p} - \\Gamma v_g g_d S_0 n = \\frac{i}{qV} - \\left( \\frac{1}{\\tau_s} + \\Gamma v_g g_d S_0 \\right) n - \\frac{s}{\\tau_p}\n$$\nFor the photon rate equation:\n$$\n\\frac{d(S_0+s)}{dt} = \\Gamma v_g g_d(N_0+n-N_{\\mathrm{tr}})(S_0+s) - \\frac{S_0+s}{\\tau_p}\n$$\n$$\n\\frac{ds}{dt} = \\Gamma v_g g_d [ (N_0-N_{\\mathrm{tr}})s + nS_0 ] - \\frac{s}{\\tau_p} - \\mathcal{O}(ns)\n$$\nUsing $\\Gamma v_g g_d(N_0-N_{\\mathrm{tr}}) = 1/\\tau_p$:\n$$\n\\frac{ds}{dt} = \\frac{s}{\\tau_p} + (\\Gamma v_g g_d S_0) n - \\frac{s}{\\tau_p} = (\\Gamma v_g g_d S_0) n\n$$\nThe linearized system of equations is:\n$$\n\\frac{dn}{dt} = \\frac{i(t)}{qV} - \\gamma_N n(t) - \\frac{1}{\\tau_p} s(t)\n$$\n$$\n\\frac{ds}{dt} = G_0 n(t)\n$$\nwhere $G_0 = \\Gamma v_g g_d S_0$ is the differential stimulated emission rate and $\\gamma_N = \\frac{1}{\\tau_s} + G_0$ is the total carrier decay rate.\n\n**3. Frequency Response**\nWe analyze the system in the frequency domain by letting $i(t) = \\tilde{i}e^{j\\omega t}$, $n(t) = \\tilde{n}e^{j\\omega t}$, and $s(t) = \\tilde{s}e^{j\\omega t}$. The derivatives become multiplications by $j\\omega$:\n$$\nj\\omega \\tilde{n} = \\frac{\\tilde{i}}{qV} - \\gamma_N \\tilde{n} - \\frac{1}{\\tau_p} \\tilde{s}\n$$\n$$\nj\\omega \\tilde{s} = G_0 \\tilde{n}\n$$\nFrom the second equation, we express $\\tilde{n}$ in terms of $\\tilde{s}$: $\\tilde{n} = \\frac{j\\omega}{G_0} \\tilde{s}$. Substituting this into the first equation:\n$$\nj\\omega \\left( \\frac{j\\omega}{G_0} \\tilde{s} \\right) = \\frac{\\tilde{i}}{qV} - \\gamma_N \\left( \\frac{j\\omega}{G_0} \\tilde{s} \\right) - \\frac{1}{\\tau_p} \\tilde{s}\n$$\n$$\n\\frac{-\\omega^2}{G_0} \\tilde{s} = \\frac{\\tilde{i}}{qV} - \\frac{j\\omega \\gamma_N}{G_0} \\tilde{s} - \\frac{1}{\\tau_p} \\tilde{s}\n$$\nRearranging to find the transfer function $H(\\omega) = \\tilde{s}/\\tilde{i}$:\n$$\n\\tilde{s} \\left( \\frac{-\\omega^2}{G_0} + \\frac{j\\omega \\gamma_N}{G_0} + \\frac{1}{\\tau_p} \\right) = \\frac{\\tilde{i}}{qV}\n$$\n$$\n\\tilde{s} \\left( -\\omega^2 + j\\omega \\gamma_N + \\frac{G_0}{\\tau_p} \\right) = \\frac{G_0}{qV} \\tilde{i}\n$$\n$$\nH(\\omega) = \\frac{\\tilde{s}}{\\tilde{i}} = \\frac{G_0 / (qV)}{-\\omega^2 + j\\omega \\gamma_N + G_0/\\tau_p}\n$$\nThis is a second-order system. The undamped resonance angular frequency $\\omega_r$ is given by $\\omega_r^2 = G_0/\\tau_p$. The damping rate is $\\gamma = \\gamma_N$.\n$$\nH(\\omega) = \\frac{G_0/(qV)}{(\\omega_r^2 - \\omega^2) + j\\omega \\gamma}\n$$\n\n**4. Evaluation at Resonance**\nThe problem asks for quantities at the resonance frequency $\\omega = \\omega_r$.\nFirst, calculate $\\omega_r$ and $\\gamma$:\n$$\nG_0 = \\Gamma v_g g_d S_0 = (0.30)(8.0 \\times 10^7)(2.0 \\times 10^{-20})(2.15886... \\times 10^{21}) = 1.03625... \\times 10^9 \\, \\mathrm{s}^{-1}\n$$\n$$\n\\omega_r^2 = \\frac{G_0}{\\tau_p} = \\frac{1.03625... \\times 10^9 \\, \\mathrm{s}^{-1}}{2.0 \\times 10^{-12} \\, \\mathrm{s}} = 5.18127... \\times 10^{20} \\, \\mathrm{rad}^2/\\mathrm{s}^2\n$$\n$$\n\\omega_r = \\sqrt{5.18127... \\times 10^{20}} = 2.27624... \\times 10^{10} \\, \\mathrm{rad/s}\n$$\n$$\n\\gamma = \\gamma_N = \\frac{1}{\\tau_s} + G_0 = \\frac{1}{1.0 \\times 10^{-9} \\, \\mathrm{s}} + 1.03625... \\times 10^9 \\, \\mathrm{s}^{-1} = 10^9 + 1.03625... \\times 10^9 = 2.03625... \\times 10^9 \\, \\mathrm{s}^{-1}\n$$\n\n**Amplitude Ratio:**\nThe amplitude response is $|H(\\omega)|$. The DC gain is $|H(0)|$. The required amplitude ratio is the quality factor $Q$ of the resonance, which is the ratio of the magnitude at resonance to the DC gain.\n$$\n|H(0)| = \\frac{G_0/(qV)}{\\omega_r^2}\n$$\nAt resonance, $\\omega = \\omega_r$:\n$$\n|H(\\omega_r)| = \\left| \\frac{G_0/(qV)}{j\\omega_r \\gamma} \\right| = \\frac{G_0/(qV)}{\\omega_r \\gamma}\n$$\nThe ratio is:\n$$\n\\frac{|H(\\omega_r)|}{|H(0)|} = \\frac{G_0/(qV\\omega_r \\gamma)}{G_0/(qV\\omega_r^2)} = \\frac{\\omega_r^2}{\\omega_r \\gamma} = \\frac{\\omega_r}{\\gamma}\n$$\nNow compute the value:\n$$\n\\frac{\\omega_r}{\\gamma} = \\frac{2.27624... \\times 10^{10} \\, \\mathrm{rad/s}}{2.03625... \\times 10^9 \\, \\mathrm{s}^{-1}} = 11.1785...\n$$\nRounding to four significant figures, the amplitude ratio is $11.18$.\n\n**Phase:**\nThe phase of $S(t)$ with respect to $I(t)$ is the argument of the complex transfer function, $\\arg(H(\\omega))$. At resonance, $\\omega = \\omega_r$:\n$$\n\\arg(H(\\omega_r)) = \\arg \\left( \\frac{G_0/(qV)}{j\\omega_r \\gamma} \\right) = \\arg \\left( \\frac{1}{j} \\right) = \\arg(-j) = -\\frac{\\pi}{2} \\, \\mathrm{rad}\n$$\nThe phase is exactly $-\\frac{\\pi}{2}$ radians.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11.18  -\\frac{\\pi}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While small-signal analysis provides key insights, real-world digital signals involve large current steps, and idealized linear models neglect important nonlinearities. This advanced practice  transitions from analytical theory to computational modeling, a vital skill for modern photonics engineering. You will numerically solve the full rate equations to simulate a laser's large-signal step response, exploring the crucial role of gain compression—a nonlinear effect that dampens oscillations, reduces overshoot, and enables stable high-speed operation.",
            "id": "3771981",
            "problem": "You are to write a complete, runnable program that models large-signal step modulation of a semiconductor Light Amplification by Stimulated Emission of Radiation (LASER) diode using coupled rate equations and evaluates how gain compression changes the photon-density overshoot and settling time relative to the linear (no compression) model. The model must be scientifically consistent and derived from first principles of semiconductor physics and device modeling.\n\nStart from the standard coupled rate equations for carrier density and photon density in a single-mode semiconductor LASER diode active region. Let $N(t)$ denote the carrier density in $\\mathrm{m}^{-3}$, $S(t)$ denote the photon density in $\\mathrm{m}^{-3}$, and $I(t)$ denote the injection current in $\\mathrm{A}$. The model must use the following well-tested forms and definitions:\n\n- The carrier rate equation is $\\,\\dfrac{dN}{dt} = \\dfrac{I(t)}{q V} - \\dfrac{N}{\\tau_n} - G(N,S;\\varepsilon) \\, S\\,$.\n- The photon rate equation is $\\,\\dfrac{dS}{dt} = \\big(G(N,S;\\varepsilon) - \\dfrac{1}{\\tau_p}\\big) \\, S + \\beta_{\\mathrm{sp}} \\, \\dfrac{N}{\\tau_{\\mathrm{sp}}}\\,$.\n- The modal gain rate is $\\,G(N,S;\\varepsilon) = \\Gamma \\, v_g \\, g(N,S;\\varepsilon)\\,$ where $g$ is the material gain.\n- The material gain with gain compression is $\\,g(N,S;\\varepsilon) = a \\, \\dfrac{N - N_{\\mathrm{tr}}}{1 + \\varepsilon S}\\,$, where $a$ is the differential gain in $\\mathrm{m}^2$, $N_{\\mathrm{tr}}$ is the transparency carrier density, and $\\varepsilon$ is the gain compression coefficient in $\\mathrm{m}^3$.\n- The elementary charge is $\\,q\\,$. The active region volume is $\\,V\\,$. The optical confinement factor is $\\,\\Gamma\\,$. The group velocity is $\\,v_g\\,$. The carrier lifetime is $\\,\\tau_n\\,$. The photon lifetime is $\\,\\tau_p\\,$. The spontaneous recombination lifetime is $\\,\\tau_{\\mathrm{sp}}\\,$. The spontaneous emission coupling factor is $\\,\\beta_{\\mathrm{sp}}\\,$.\n\nThe injection current is a step: $\\,I(t) = I_2\\,$ for $\\,t \\ge 0\\,$ and $\\,I(t) = I_1\\,$ for $\\,t  0\\,$. The initial condition at $\\,t = 0^-\\,$ must be the steady state for $\\,I_1\\,$ obtained by solving $\\,\\dfrac{dN}{dt} = 0\\,$ and $\\,\\dfrac{dS}{dt} = 0\\,$. The target steady state for $\\,t \\to \\infty\\,$ at $\\,I_2\\,$ must also be obtained by solving the same steady-state equations.\n\nDefine the overshoot in photon density for a given model as the largest relative excursion above the final steady-state photon density. Specifically, let $\\,S_{\\max}\\,$ be the maximum of $\\,S(t)\\,$ over $\\,t \\ge 0\\,$ for the step response and let $\\,S_{\\mathrm{ss}}\\,$ be the steady-state photon density at $\\,I_2\\,$. The overshoot must be computed as $\\,\\max\\!\\big(0, \\dfrac{S_{\\max} - S_{\\mathrm{ss}}}{S_{\\mathrm{ss}}}\\big)\\,$ and must be expressed as a decimal fraction. The settling time must be defined as the smallest time $\\,t_{\\mathrm{settle}}\\,$ such that for all $\\,t' \\ge t_{\\mathrm{settle}}\\,$ one has $\\,\\left|S(t') - S_{\\mathrm{ss}}\\right| \\le 0.02\\, S_{\\mathrm{ss}}\\,$. The settling time must be expressed in seconds.\n\nFor the \"linear model\" set $\\,\\varepsilon = 0\\,$. For the \"gain-compressed model\" use the provided nonzero $\\,\\varepsilon\\,$. For each test case, run both models with identical physical parameters, identical $\\,I_1\\,$ and $\\,I_2\\,$ step inputs, and compute the overshoot and settling time for each model. Then compute the changes relative to the linear model as differences: $\\,\\Delta O = O_{\\mathrm{comp}} - O_{\\mathrm{lin}}\\,$ and $\\,\\Delta T = T_{\\mathrm{comp}} - T_{\\mathrm{lin}}\\,$, where $\\,O\\,$ denotes overshoot and $\\,T\\,$ denotes settling time.\n\nUse the following physical constants and device parameters in your program:\n- $\\,q = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}\\,$,\n- $\\,V = 3.0 \\times 10^{-16}\\,\\mathrm{m}^3\\,$,\n- $\\,\\Gamma = 0.3\\,$,\n- $\\,v_g = 8.0 \\times 10^{7}\\,\\mathrm{m/s}\\,$,\n- $\\,a = 3.0 \\times 10^{-16}\\,\\mathrm{m}^2\\,$,\n- $\\,N_{\\mathrm{tr}} = 1.0 \\times 10^{24}\\,\\mathrm{m}^{-3}\\,$,\n- $\\,\\tau_n = 1.0 \\times 10^{-9}\\,\\mathrm{s}\\,$,\n- $\\,\\tau_p = 2.0 \\times 10^{-12}\\,\\mathrm{s}\\,$,\n- $\\,\\tau_{\\mathrm{sp}} = 1.0 \\times 10^{-9}\\,\\mathrm{s}\\,$,\n- $\\,\\beta_{\\mathrm{sp}} = 1.0 \\times 10^{-4}\\,$.\n\nYour program must numerically integrate the coupled rate equations for $\\,t \\ge 0\\,$ with the initial condition obtained at $\\,I_1\\,$ for each model, and determine $\\,O\\,$ and $\\,T\\,$ as defined above. The integration horizon must be long enough to observe settling, and the method must be robust to stiffness implied by $\\,\\tau_p \\ll \\tau_n\\,$. All answers requiring physical units must be expressed in the units specified above; overshoot must be a decimal fraction, and settling time must be in seconds.\n\nTest suite. Your program must compute the results for the following set of step-modulation test cases, each defined by current levels (in $\\mathrm{mA}$) and gain compression coefficient (in $\\mathrm{m}^3$):\n\n- Case $\\,1\\,$: $\\,I_1 = 60.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 100.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 1.0 \\times 10^{-23}\\,\\mathrm{m}^3\\,$.\n- Case $\\,2\\,$: $\\,I_1 = 55.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 120.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 5.0 \\times 10^{-23}\\,\\mathrm{m}^3\\,$.\n- Case $\\,3\\,$: $\\,I_1 = 80.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 90.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 2.0 \\times 10^{-23}\\,\\mathrm{m}^3\\,$.\n- Case $\\,4\\,$: $\\,I_1 = 70.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 100.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 0.0\\,\\mathrm{m}^3\\,$.\n- Case $\\,5\\,$: $\\,I_1 = 60.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 200.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 1.0 \\times 10^{-22}\\,\\mathrm{m}^3\\,$.\n\nFor each case, compute $\\,\\Delta O\\,$ and $\\,\\Delta T\\,$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is a two-element list $[\\,\\Delta O,\\,\\Delta T\\,]$. For example, the output must have the form $[ [\\Delta O_1,\\Delta T_1], [\\Delta O_2,\\Delta T_2], \\dots ]$, with all numeric values printed in standard decimal notation in their specified units.",
            "solution": "The objective is to quantify how gain compression modifies large-signal step response characteristics, specifically overshoot and settling time, relative to the linear model. We begin from semiconductor LASER diode rate equations, which embody fundamental carrier-photon dynamics and originate from stimulated emission, spontaneous emission, and cavity photon loss.\n\nThe coupled rate equations for carrier density $\\,N(t)\\,$ and photon density $\\,S(t)\\,$ are\n$$\n\\frac{dN}{dt} = \\frac{I(t)}{q V} - \\frac{N}{\\tau_n} - G(N,S;\\varepsilon)\\, S,\n\\qquad\n\\frac{dS}{dt} = \\Big(G(N,S;\\varepsilon) - \\frac{1}{\\tau_p}\\Big)\\, S + \\beta_{\\mathrm{sp}}\\, \\frac{N}{\\tau_{\\mathrm{sp}}}.\n$$\nThe modal gain rate $\\,G(N,S;\\varepsilon)\\,$ is the product of the optical confinement factor $\\,\\Gamma\\,$, group velocity $\\,v_g\\,$, and material gain $\\,g(N,S;\\varepsilon)\\,$,\n$$\nG(N,S;\\varepsilon) = \\Gamma\\, v_g \\, g(N,S;\\varepsilon),\n\\quad\ng(N,S;\\varepsilon) = a \\, \\frac{N - N_{\\mathrm{tr}}}{1 + \\varepsilon S}.\n$$\nThe gain compression coefficient $\\,\\varepsilon\\,$ introduces saturation of gain with increasing photon density as a well-tested effect in practical devices and increases damping of relaxation oscillations. The linear model corresponds to setting $\\,\\varepsilon = 0\\,$ and thus $\\,g(N,S;0) = a (N - N_{\\mathrm{tr}})\\,$.\n\nA step modulation is defined by $\\,I(t) = I_2\\,$ for $\\,t \\ge 0\\,$ and $\\,I(t) = I_1\\,$ for $\\,t  0\\,$. The initial condition at $\\,t = 0^-\\,$ is the steady state for $\\,I_1\\,$. The steady state for a constant $\\,I\\,$ solves\n$$\n\\frac{I}{q V} - \\frac{N}{\\tau_n} - G(N,S;\\varepsilon)\\, S = 0,\n\\qquad\n\\Big(G(N,S;\\varepsilon) - \\frac{1}{\\tau_p}\\Big)\\, S + \\beta_{\\mathrm{sp}}\\, \\frac{N}{\\tau_{\\mathrm{sp}}} = 0.\n$$\nFor the linear model above threshold, an important property is carrier pinning near the threshold carrier density $\\,N_{\\mathrm{th}} = N_{\\mathrm{tr}} + \\frac{1}{\\Gamma v_g a \\tau_p}\\,$, which follows by equating the material gain to the cavity loss rate $\\,\\frac{1}{\\tau_p}\\,$. In that regime, the steady-state photon density can be approximated by\n$$\nS_{\\mathrm{ss}} \\approx \\tau_p\\left(\\frac{I}{q V} - \\frac{N_{\\mathrm{th}}}{\\tau_n}\\right),\n$$\nand the threshold current $\\,I_{\\mathrm{th}} = \\frac{q V N_{\\mathrm{th}}}{\\tau_n}\\,$ sets the onset of lasing. With gain compression $\\,(\\varepsilon > 0)\\,$, the effective gain is reduced at higher $\\,S\\,$, so the exact steady state must be obtained from the nonlinear equations above.\n\nFor large-signal dynamics after the step to $\\,I_2\\,$, we integrate the coupled ordinary differential equations forward in time starting from the steady state at $\\,I_1\\,$. Because $\\,\\tau_p \\ll \\tau_n\\,$, stiffness may be present, so an implicit method such as a stiff solver is appropriate. We use a numerical integration with a time horizon that spans multiple carrier lifetimes, ensuring convergence toward steady state.\n\nDefinitions needed for evaluation:\n- Let $\\,S_{\\mathrm{ss}}\\,$ denote the final steady-state photon density at $\\,I_2\\,$ for the selected model.\n- Let $\\,S_{\\max}\\,$ denote the maximum photon density observed during the transient $\\,t \\ge 0\\,$.\n- Overshoot is defined as\n$$\nO = \\max\\!\\left(0, \\frac{S_{\\max} - S_{\\mathrm{ss}}}{S_{\\mathrm{ss}}}\\right),\n$$\nwhich is a dimensionless decimal fraction by construction.\n- Settling time is defined as the minimal time $\\,t_{\\mathrm{settle}}\\,$ such that for all $\\,t' \\ge t_{\\mathrm{settle}}\\,$ one has $\\,|S(t') - S_{\\mathrm{ss}}| \\le 0.02\\, S_{\\mathrm{ss}}\\,$. This is computed by scanning the post-step trajectory to locate the last violation of the tolerance band and taking the next time sample as $\\,t_{\\mathrm{settle}}\\,$. If the tolerance band is never satisfied for the tail of the simulation interval, we report $\\,t_{\\mathrm{settle}} = \\mathrm{NaN}\\,$ to indicate non-settling within the chosen horizon.\n\nAlgorithm design:\n1. For each test case, construct two models: linear with $\\,\\varepsilon = 0\\,$ and gain-compressed with the provided $\\,\\varepsilon > 0\\,$.\n2. For each model and each of $\\,I_1\\,$ and $\\,I_2\\,$, compute the steady state $\\,\\{N_{\\mathrm{ss}}, S_{\\mathrm{ss}}\\}\\,$ by solving the algebraic system above. Use physically motivated initial guesses: carrier near $\\,N_{\\mathrm{th}} = N_{\\mathrm{tr}} + \\frac{1}{\\Gamma v_g a \\tau_p}\\,$ and photon density near $\\,\\tau_p\\left(\\frac{I}{q V} - \\frac{N_{\\mathrm{th}}}{\\tau_n}\\right)$ when above threshold.\n3. For each model, integrate the rate equations from $\\,t = 0\\,$ to an end time that is several carrier lifetimes (e.g., $\\,T_{\\mathrm{end}} = 2.0 \\times 10^{-8}\\,\\mathrm{s}\\,$) using a stiff solver with suitable tolerances, starting from the steady state at $\\,I_1\\,$ and with $\\,I = I_2\\,$ during integration.\n4. Compute $\\,O\\,$ and $\\,t_{\\mathrm{settle}}\\,$ from the simulated $\\,S(t)\\,$ and the final steady state at $\\,I_2\\,$.\n5. Report the changes relative to the linear model, $\\,\\Delta O = O_{\\mathrm{comp}} - O_{\\mathrm{lin}}\\,$ and $\\,\\Delta T = T_{\\mathrm{comp}} - T_{\\mathrm{lin}}\\,$, for each test case.\n\nPhysical expectations: Gain compression increases effective damping of relaxation oscillations by reducing $\\,G(N,S;\\varepsilon)\\,$ at high photon densities, which typically reduces overshoot $\\,O\\,$ and shortens settling time $\\,T\\,$ relative to the linear model, especially for large steps. The numerical procedure captures these effects without relying on any shortcut formulas, directly from the coupled rate dynamics.\n\nThe program outputs a single line in the exact format specified: a comma-separated list of two-element lists $[\\,\\Delta O,\\,\\Delta T\\,]$ for each test case, enclosed in square brackets. Overshoot differences are dimensionless decimal fractions, and settling time differences are in seconds.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root\n\n# Physical constants and device parameters (SI units)\nq = 1.602176634e-19  # Coulomb\nV = 3.0e-16          # m^3\nGamma = 0.3          # optical confinement factor\nvg = 8.0e7           # m/s\na = 3.0e-16          # m^2 (differential gain)\nN_tr = 1.0e24        # m^-3 (transparency carrier density)\ntau_n = 1.0e-9       # s (carrier lifetime)\ntau_p = 2.0e-12      # s (photon lifetime)\ntau_sp = 1.0e-9      # s (spontaneous lifetime)\nbeta_sp = 1.0e-4     # spontaneous coupling factor\n\n# Derived threshold carrier density (linear model concept, useful for initial guesses)\ndef N_threshold():\n    return N_tr + 1.0 / (Gamma * vg * a * tau_p)\n\ndef G_rate(N, S, eps):\n    # Modal gain rate G(N,S;eps) = Gamma * vg * a * (N - N_tr) / (1 + eps*S)\n    return Gamma * vg * a * max(N - N_tr, 0.0) / (1.0 + eps * max(S, 0.0))\n\ndef rate_equations(t, y, I, eps):\n    N, S = y\n    N = max(N, 0.0)\n    S = max(S, 0.0)\n    G = G_rate(N, S, eps)\n    dNdt = I / (q * V) - N / tau_n - G * S\n    dSdt = (G - 1.0 / tau_p) * S + beta_sp * N / tau_sp\n    return [dNdt, dSdt]\n\ndef steady_state(I, eps):\n    # Solve for steady-state (N,S) such that dN/dt=0, dS/dt=0 at constant current I\n    N_th = N_threshold()\n    # Initial guesses: carrier near threshold; photon density from linear pinned-carrier approximation\n    S_guess = tau_p * (I / (q * V) - N_th / tau_n)\n    if S_guess  0.0:\n        S_guess = 1.0e10  # a small positive photon density guess to avoid zero\n    N_guess = max(N_tr, N_th)\n    x0 = np.array([N_guess, S_guess])\n\n    def F(x):\n        N, S = x\n        # Penalize negative states to steer the solver away\n        if N  0 or S  0:\n            return np.array([1e6 + abs(N)*1e6, 1e6 + abs(S)*1e6])\n        G = G_rate(N, S, eps)\n        f1 = I / (q * V) - N / tau_n - G * S\n        f2 = (G - 1.0 / tau_p) * S + beta_sp * N / tau_sp\n        return np.array([f1, f2])\n\n    sol = root(F, x0, method='hybr')\n    if not sol.success:\n        # Try an alternative initial guess if the first attempt fails\n        x0_alt = np.array([I * tau_n / (q * V), max(S_guess, 1e10)])\n        sol = root(F, x0_alt, method='hybr')\n    N_ss, S_ss = sol.x\n    # Enforce non-negativity\n    N_ss = float(max(N_ss, 0.0))\n    S_ss = float(max(S_ss, 0.0))\n    return N_ss, S_ss\n\ndef simulate_step(I1, I2, eps, T_end=2.0e-8, num_points=10001):\n    # Get steady states for initial and final currents\n    N1, S1 = steady_state(I1, eps)\n    N2, S2 = steady_state(I2, eps)\n    # Integrate the ODEs after the step to I2\n    t_eval = np.linspace(0.0, T_end, num_points)\n    y0 = [N1, S1]\n    sol = solve_ivp(rate_equations, (0.0, T_end), y0, args=(I2, eps),\n                    method='Radau', t_eval=t_eval, rtol=1e-6, atol=1e-12)\n    t = sol.t\n    S = sol.y[1]\n    return t, S, S2\n\ndef overshoot_and_settling(t, S, S_ss, tol=0.02):\n    # Overshoot as max relative excursion above S_ss\n    S_peak = float(np.max(S))\n    overshoot = 0.0\n    if S_ss > 0.0 and S_peak > S_ss:\n        overshoot = (S_peak - S_ss) / S_ss\n    else:\n        overshoot = 0.0\n    # Settling time: earliest time after which all samples remain within tolerance band\n    if S_ss = 0.0:\n        # If the final steady-state photon density is zero, settling time is undefined / NaN\n        return overshoot, float('nan')\n    band = tol * S_ss\n    violations = np.abs(S - S_ss) > band\n    if not np.any(violations):\n        settle_time = 0.0\n    else:\n        last_bad_idx = np.where(violations)[0][-1]\n        if last_bad_idx >= len(t) - 1:\n            settle_time = float('nan')  # never settled within horizon\n        else:\n            settle_time = float(t[last_bad_idx + 1])\n    return overshoot, settle_time\n\ndef analyze_case(I1_mA, I2_mA, eps):\n    # Convert mA to A\n    I1 = I1_mA * 1e-3\n    I2 = I2_mA * 1e-3\n    # Linear model (eps_lin=0)\n    t_lin, S_lin, Sss_lin = simulate_step(I1, I2, eps=0.0)\n    O_lin, T_lin = overshoot_and_settling(t_lin, S_lin, Sss_lin, tol=0.02)\n    # Gain-compressed model (eps as given)\n    t_cmp, S_cmp, Sss_cmp = simulate_step(I1, I2, eps=eps)\n    O_cmp, T_cmp = overshoot_and_settling(t_cmp, S_cmp, Sss_cmp, tol=0.02)\n    # Differences relative to linear\n    dO = O_cmp - O_lin\n    # Settling time difference: if either is NaN, return NaN\n    if np.isnan(T_lin) or np.isnan(T_cmp):\n        dT = float('nan')\n    else:\n        dT = T_cmp - T_lin\n    return [dO, dT]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\"I1_mA\": 60.0, \"I2_mA\": 100.0, \"eps\": 1.0e-23},\n        {\"I1_mA\": 55.0, \"I2_mA\": 120.0, \"eps\": 5.0e-23},\n        {\"I1_mA\": 80.0, \"I2_mA\": 90.0,  \"eps\": 2.0e-23},\n        {\"I1_mA\": 70.0, \"I2_mA\": 100.0, \"eps\": 0.0e0},\n        {\"I1_mA\": 60.0, \"I2_mA\": 200.0, \"eps\": 1.0e-22},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_case(case[\"I1_mA\"], case[\"I2_mA\"], case[\"eps\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Results is a list of [dOvershoot, dSettleTime] lists.\n    # Print a single line: e.g., [[dO1,dT1],[dO2,dT2],...]\n    print(f\"[{','.join('[' + ','.join(map(str, r)) + ']' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}