{
    "hands_on_practices": [
        {
            "introduction": "半导体激光器的核心是其增益介质，它能放大光。本练习旨在通过一个实际的计算，加深您对量子阱激光器中材料增益模型的理解。您将使用标准的对数增益模型，从给定的实验数据中反向推导出透明载流子浓度这一基本参数，从而将理论模型与可测量的器件特性联系起来。",
            "id": "3771999",
            "problem": "一个单量子阱（QW）半导体激光二极管的材料增益模型由以下形式表征：$g(N)=g_{0}\\ln\\!\\big(N/N_{\\mathrm{tr}}\\big)$，其中 $N$ 是量子阱中的面载流子密度（单位为 $\\mathrm{cm}^{-2}$），$g(N)$ 是材料增益（单位为 $\\mathrm{cm}^{-1}$），$g_{0}$ 是一个正常数，$N_{\\mathrm{tr}}$ 是透明载流子密度（单位为 $\\mathrm{cm}^{-2}$）。在一次使用根据载流子密度校准的自发辐射进行的单独表征中，一个工作点 $N=N_{1}$ 产生了测得的材料增益 $g(N_{1})$。假设以下实验测定值：$N_{1}=6.00\\times 10^{12}\\ \\mathrm{cm}^{-2}$，$g(N_{1})=600\\ \\mathrm{cm}^{-1}$，以及 $g_{0}=1500\\ \\mathrm{cm}^{-1}$。\n\n请从适用于半导体激光器速率方程建模的第一性原理出发，使用透明度的基本定义推导出 $N_{\\mathrm{tr}}$ 关于 $N_{1}$、$g(N_{1})$ 和 $g_{0}$ 的显式表达式，然后计算其数值。将最终数值答案四舍五入至四位有效数字，并以 $\\mathrm{cm}^{-2}$ 为单位表示。此外，请解释 $g_{0}$ 在量子阱激光器背景下的物理意义，将你的解释建立在材料增益的微观起源上，而非特定于器件的经验相关性。\n\n你的最终答案必须是一个实数。不要在最终方框答案中包含单位。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n- 一个单量子阱（QW）半导体激光二极管的材料增益模型形式为 $g(N)=g_{0}\\ln\\!\\big(N/N_{\\mathrm{tr}}\\big)$。\n- $N$ 是量子阱中的面载流子密度（单位为 $\\mathrm{cm}^{-2}$）。\n- $g(N)$ 是材料增益（单位为 $\\mathrm{cm}^{-1}$）。\n- $g_{0}$ 是一个正常数。\n- $N_{\\mathrm{tr}}$ 是透明载流子密度（单位为 $\\mathrm{cm}^{-2}$）。\n- 一个工作点为 $N=N_{1}$。\n- 该点产生了测得的材料增益 $g(N_{1})$。\n- $N_{1}=6.00\\times 10^{12}\\ \\mathrm{cm}^{-2}$。\n- $g(N_{1})=600\\ \\mathrm{cm}^{-1}$。\n- $g_{0}=1500\\ \\mathrm{cm}^{-1}$。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于半导体激光物理这一成熟领域。对数增益模型 $g(N)=g_{0}\\ln(N/N_{\\mathrm{tr}})$ 是量子阱激光器的标准且广泛使用的经验模型，它很好地近似了从涉及二维系统中费米-狄拉克统计的更基本理论推导出的增益行为。\n2.  **适定性**：该问题提供了一个特定模型和足够的数据来确定唯一的未知参数 $N_{\\mathrm{tr}}$。问题陈述清晰，且存在唯一、稳定的解。\n3.  **客观性**：问题以精确、定量且无偏见的语言表述。\n4.  **完整性与一致性**：求解 $N_{\\mathrm{tr}}$ 所需的所有参数（$N_1$、$g(N_1)$、$g_0$）均已提供。单位一致，并且给定的数值对于典型的 InGaAs/AlGaAs 或类似的量子阱激光系统是物理上现实的。\n5.  **未检测到其他缺陷**：该问题不违反任何其他有效性标准。这是一个光电子学领域的标准可解问题。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将进行解答。\n\n### 解答推导\n\n解答包括三个部分：(1) 推导透明载流子密度 $N_{\\mathrm{tr}}$ 的显式表达式，(2) 计算其数值，以及 (3) 解释增益参数 $g_0$ 的物理意义。\n\n**第1部分：$N_{\\mathrm{tr}}$ 表达式的推导**\n\n推导从增益介质中透明度的基本定义开始。透明度是指介质在目标波长上既不放大也不吸收光的条件。这种情况发生在受激发射速率与受激吸收速率完全相等时。在这一点上，净材料增益 $g(N)$ 为零。发生这种情况时的载流子密度，根据定义，就是透明载流子密度 $N_{\\mathrmtr}$。\n\n在数学上，这表示为：\n$$\ng(N = N_{\\mathrm{tr}}) = 0\n$$\n问题给出了量子阱激光器的增益模型：\n$$\ng(N) = g_0 \\ln\\left(\\frac{N}{N_{\\mathrm{tr}}}\\right)\n$$\n将透明度的定义应用于此模型，我们可以验证其内部一致性：\n$$\ng(N_{\\mathrm{tr}}) = g_0 \\ln\\left(\\frac{N_{\\mathrm{tr}}}{N_{\\mathrm{tr}}}\\right) = g_0 \\ln(1) = 0\n$$\n这证实了模型中的参数 $N_{\\mathrm{tr}}$ 正确地代表了透明载流子密度。\n\n为了找到 $N_{\\mathrm{tr}}$ 的显式表达式，我们使用实验测量的数据点 $(N_1, g(N_1))$。我们将这些值代入增益模型方程：\n$$\ng(N_1) = g_0 \\ln\\left(\\frac{N_1}{N_{\\mathrm{tr}}}\\right)\n$$\n我们的目标是解出该方程中的 $N_{\\mathrmtr}$。我们进行代数运算。首先，两边同除以 $g_0$：\n$$\n\\frac{g(N_1)}{g_0} = \\ln\\left(\\frac{N_1}{N_{\\mathrm{tr}}}\\right)\n$$\n为了消去自然对数，我们对等式两边取指数（即，以 $e$ 为底对两边进行幂运算）：\n$$\n\\exp\\left(\\frac{g(N_1)}{g_0}\\right) = \\exp\\left(\\ln\\left(\\frac{N_1}{N_{\\mathrm{tr}}}\\right)\\right) = \\frac{N_1}{N_{\\mathrm{tr}}}\n$$\n最后，我们重新整理方程以分离出 $N_{\\mathrm{tr}}$：\n$$\nN_{\\mathrm{tr}} = \\frac{N_1}{\\exp\\left(\\frac{g(N_1)}{g_0}\\right)}\n$$\n这个表达式可以更紧凑地写为：\n$$\nN_{\\mathrm{tr}} = N_1 \\exp\\left(-\\frac{g(N_1)}{g_0}\\right)\n$$\n这就是所要求的用给定物理量 $N_1$、$g(N_1)$ 和 $g_0$ 表示的 $N_{\\mathrm{tr}}$ 的显式表达式。\n\n**第2部分：$N_{\\mathrm{tr}}$ 的数值计算**\n\n现在我们将提供的数值代入推导出的表达式中：\n- $N_1 = 6.00 \\times 10^{12} \\ \\mathrm{cm}^{-2}$\n- $g(N_1) = 600 \\ \\mathrm{cm}^{-1}$\n- $g_0 = 1500 \\ \\mathrm{cm}^{-1}$\n\n指数中的比率是一个无量纲的量，符合要求：\n$$\n\\frac{g(N_1)}{g_0} = \\frac{600}{1500} = \\frac{2}{5} = 0.4\n$$\n现在，将此值代入 $N_{\\mathrmtr}$ 的表达式中：\n$$\nN_{\\mathrm{tr}} = (6.00 \\times 10^{12}) \\times \\exp(-0.4)\n$$\n计算指数项的值：\n$$\n\\exp(-0.4) \\approx 0.6703200459\n$$\n乘以 $N_1$：\n$$\nN_{\\mathrmtr} \\approx (6.00 \\times 10^{12}) \\times 0.6703200459 \\approx 4.021920275 \\times 10^{12}\n$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\nN_{\\mathrmtr} \\approx 4.022 \\times 10^{12} \\ \\mathrm{cm}^{-2}\n$$\n\n**第3部分：$g_0$ 的物理意义**\n\n参数 $g_0$，通常称为增益系数，是对数增益模型中的一个唯象常数。其物理意义植根于量子阱中光与物质相互作用的微观物理学。材料增益 $g$ 源于受激发射和受激吸收的净效应。这些过程的速率取决于可用电子态的密度以及这些态被载流子（电子和空穴）占据的概率，这由费米-狄拉克统计描述。\n\n在光子能量 $\\hbar\\omega$ 处的增益与联合态密度和粒子数反转因子 $(f_c - f_v)$ 成正比，其中 $f_c$ 和 $f_v$ 分别是导带中电子和价带中电子的费米-狄拉克占据概率。对数增益模型是该增益谱峰值 $g_{\\mathrm{peak}}$ 作为载流子密度 $N$ 的函数的经验拟合。\n\n参数 $g_0$ 是一个量化增益介质本征效率的复合项。它综合了两个基本的微观特性：\n1.  **光学矩阵元：** 这个量子力学术语 $|M|^2$ 量化了电子-空穴对与光子之间相互作用的强度。更大的矩阵元对应于更高的辐射跃迁（受激发射）概率，从而导致更高的增益。\n2.  **态密度（DOS）：** 增益与可参与光学跃迁的可用电子态数量成正比。量子阱表现出二维的阶梯状态密度，它将态集中在能带边缘附近。这种态的集中是量子阱激光器比体材料激光器效率更高、增益系数更大的主要原因。\n\n本质上，$g_0$ 设定了注入的载流子如何有效地转化为材料增益的标度。具有强光学跃迁（大矩阵元）和高态密度的材料将表现出大的 $g_0$。这意味着对于高于透明度的载流子密度的给定分数增加（即，给定的 $\\ln(N/N_{\\mathrm{tr}})$ 值），该材料将产生更大量的增益。微分增益 $dg/dN = g_0/N$ 明确表明，$g_0$ 衡量了增益对载流子密度变化的响应程度。",
            "answer": "$$\n\\boxed{4.022 \\times 10^{12}}\n$$"
        },
        {
            "introduction": "在掌握了静态增益特性之后，我们将探索激光器的动态行为。载流子与光子之间的相互作用会产生一种固有的共振，这决定了激光器对快速变化的电流的响应能力。在本练习中，您将通过对速率方程进行线性化处理，来分析激光器对小信号调制的频率响应，并揭示决定其最大调制速度的关键概念——弛豫振荡频率。",
            "id": "3771994",
            "problem": "考虑一个单模半导体受激辐射光放大（LASER）二极管，其纵向光子密度 $S(t)$ 和载流子密度 $N(t)$ 由适用于均匀有源区的标准耦合速率方程描述，忽略阈值以上自发辐射对激射模式的贡献：\n$$\\frac{dN}{dt}=\\frac{I(t)}{q V}-\\frac{N}{\\tau_{s}}-\\Gamma v_{g} g(N) S,$$\n$$\\frac{dS}{dt}=\\Gamma v_{g} g(N) S-\\frac{S}{\\tau_{p}},$$\n其中 $I(t)=I_{0}+I_{1}\\cos(\\omega t)$ 是注入电流，它在直流偏置 $I_{0}$ 附近有一个小的正弦调制幅度 $I_{1}$，$q$ 是元电荷，$V$ 是电泵浦有源区体积，$\\tau_{s}$ 是载流子寿命，$\\tau_{p}$ 是光子寿命，$\\Gamma$ 是光限制因子，$v_{g}$ 是群速度，$g(N)$ 是材料增益。假设材料增益在透明点附近线性化为 $g(N)=g_{d}\\big(N-N_{\\mathrm{tr}}\\big)$，其中 $g_{d}$ 是微分增益，$N_{\\mathrm{tr}}$ 是透明载流子密度。\n\n二极管参数如下：\n- $\\Gamma=0.30$,\n- $v_{g}=8.0\\times 10^{7}\\,\\mathrm{m/s}$,\n- $g_{d}=2.0\\times 10^{-20}\\,\\mathrm{m}^{2}$,\n- $N_{\\mathrm{tr}}=1.0\\times 10^{24}\\,\\mathrm{m}^{-3}$,\n- $\\tau_{p}=2.0\\times 10^{-12}\\,\\mathrm{s}$,\n- $\\tau_{s}=1.0\\times 10^{-9}\\,\\mathrm{s}$,\n- $V=1.2\\times 10^{-16}\\,\\mathrm{m}^{3}$,\n- $q=1.602\\times 10^{-19}\\,\\mathrm{C}$,\n- $I_{0}=0.060\\,\\mathrm{A}$。\n\n假设激光器在阈值以上稳定工作，并将耦合速率方程围绕由 $I_{0}$ 产生的稳态点 $\\big(N_{0},S_{0}\\big)$ 进行线性化。从第一性原理出发，推导从 $I_{1}\\cos(\\omega t)$ 到光子密度调制 $S(t)$ 的小信号频率响应，并用它来确定在弛豫振荡角频率 $\\omega=\\omega_{r}$ 处，以下物理量：\n- $S(t)$ 的振幅相对于其直流增益的值（即，在 $\\omega$ 处的幅值与在 $\\omega=0$ 处的幅值之比的无量纲值），\n- $S(t)$ 相对于注入电流调制的相位，以弧度表示。\n\n将振幅比四舍五入到四位有效数字。相位以弧度精确表示。按指定格式，将最终答案以一个二元行矩阵的形式报告，其中第一个元素是无量纲振幅比，第二个元素是相位角（以弧度为单位）。",
            "solution": "用户希望解决一个半导体激光二极管问题。\n\n### 第一步：提取已知条件\n问题给出了描述光子密度 $S(t)$ 和载流子密度 $N(t)$ 的以下耦合速率方程：\n$$\n\\frac{dN}{dt} = \\frac{I(t)}{q V} - \\frac{N}{\\tau_{s}} - \\Gamma v_{g} g(N) S\n$$\n$$\n\\frac{dS}{dt} = \\Gamma v_{g} g(N) S - \\frac{S}{\\tau_{p}}\n$$\n注入电流为 $I(t) = I_{0} + I_{1}\\cos(\\omega t)$。\n材料增益线性化为 $g(N) = g_{d}(N - N_{\\mathrm{tr}})$。\n给定的参数为：\n- 光限制因子, $\\Gamma = 0.30$\n- 群速度, $v_{g} = 8.0 \\times 10^{7}\\,\\mathrm{m/s}$\n- 微分增益, $g_{d} = 2.0 \\times 10^{-20}\\,\\mathrm{m}^{2}$\n- 透明载流子密度, $N_{\\mathrm{tr}} = 1.0 \\times 10^{24}\\,\\mathrm{m}^{-3}$\n- 光子寿命, $\\tau_{p} = 2.0 \\times 10^{-12}\\,\\mathrm{s}$\n- 载流子寿命, $\\tau_{s} = 1.0 \\times 10^{-9}\\,\\mathrm{s}$\n- 有源区体积, $V = 1.2 \\times 10^{-16}\\,\\mathrm{m}^{3}$\n- 元电荷, $q = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n- 直流偏置电流, $I_{0} = 0.060\\,\\mathrm{A}$\n\n### 第二步：使用提取的已知条件进行验证\n该问题基于单模半导体激光器的标准速率方程模型，这是半导体光电子学的一个基石。该模型在科学上是公认的。使用线性化增益是进行小信号分析的标准且有效的近似方法。所有必需的参数均已提供，并且其数值对于典型的激光二极管而言是物理上现实的。问题要求进行小信号频率响应分析，这是该领域中一个标准的、适定的技术。问题陈述是自洽、客观且有科学依据的。它没有违反任何无效性标准。\n\n### 第三步：结论与行动\n该问题有效。将提供完整解答。\n\n### 解题推导\n解题过程主要分为四个步骤：\n1.  确定直流偏置电流 $I_0$ 下的稳态工作点 $(N_0, S_0)$。\n2.  针对小的正弦调制，围绕此稳态点对速率方程进行线性化。\n3.  推导小信号频率响应传递函数 $H(\\omega)$。\n4.  在弛豫振荡频率 $\\omega_r$ 处，计算所需物理量（振幅比和相位）。\n\n**1. 稳态分析**\n\n在稳态下，时间导数为零（$\\frac{dN}{dt} = 0$, $\\frac{dS}{dt} = 0$），电流为直流偏置 $I = I_0$。速率方程变为：\n$$\n0 = \\frac{I_0}{q V} - \\frac{N_0}{\\tau_s} - \\Gamma v_g g(N_0) S_0\n$$\n$$\n0 = \\Gamma v_g g(N_0) S_0 - \\frac{S_0}{\\tau_p}\n$$\n要发生激射，光子密度必须非零（$S_0  0$）。从第二个方程可知，这意味着：\n$$\n\\Gamma v_g g(N_0) = \\frac{1}{\\tau_p}\n$$\n这个条件意味着模式增益恰好平衡了总腔体损耗。因此，载流子密度 $N_0$ 被钳位在阈值 $N_0 = N_{\\mathrm{th}}$。代入线性化增益 $g(N) = g_d(N - N_{\\mathrm{tr}})$：\n$$\n\\Gamma v_g g_d (N_0 - N_{\\mathrm{tr}}) = \\frac{1}{\\tau_p}\n$$\n解出 $N_0$：\n$$\nN_0 = N_{\\mathrm{th}} = N_{\\mathrm{tr}} + \\frac{1}{\\Gamma v_g g_d \\tau_p}\n$$\n现在，将增益-损耗平衡条件 $\\Gamma v_g g(N_0) = 1/\\tau_p$ 代入第一个稳态方程以求解 $S_0$：\n$$\n0 = \\frac{I_0}{q V} - \\frac{N_0}{\\tau_s} - \\frac{S_0}{\\tau_p}\n$$\n$$\nS_0 = \\tau_p \\left( \\frac{I_0}{q V} - \\frac{N_0}{\\tau_s} \\right)\n$$\n\n首先，我们计算 $N_0$ 的数值：\n$$\n\\Gamma v_g g_d \\tau_p = (0.30)(8.0 \\times 10^7 \\, \\mathrm{m/s})(2.0 \\times 10^{-20} \\, \\mathrm{m}^2)(2.0 \\times 10^{-12} \\, \\mathrm{s}) = 9.6 \\times 10^{-25} \\, \\mathrm{m}^3\n$$\n$$\nN_0 = 1.0 \\times 10^{24} \\, \\mathrm{m}^{-3} + \\frac{1}{9.6 \\times 10^{-25} \\, \\mathrm{m}^3} = 1.0 \\times 10^{24} + 1.04166\\overline{6} \\times 10^{24} \\, \\mathrm{m}^{-3} = 2.04166\\overline{6} \\times 10^{24} \\, \\mathrm{m}^{-3}\n$$\n接下来，我们计算 $S_0$：\n$$\n\\frac{I_0}{qV} = \\frac{0.060 \\, \\mathrm{A}}{(1.602 \\times 10^{-19} \\, \\mathrm{C})(1.2 \\times 10^{-16} \\, \\mathrm{m}^3)} = 3.12109... \\times 10^{33} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3}\n$$\n$$\n\\frac{N_0}{\\tau_s} = \\frac{2.04166\\overline{6} \\times 10^{24} \\, \\mathrm{m}^{-3}}{1.0 \\times 10^{-9} \\, \\mathrm{s}} = 2.04166\\overline{6} \\times 10^{33} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3}\n$$\n$$\nS_0 = (2.0 \\times 10^{-12} \\, \\mathrm{s}) \\left( 3.12109... \\times 10^{33} - 2.04166\\overline{6} \\times 10^{33} \\right) \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3} = 2.15886... \\times 10^{21} \\, \\mathrm{m}^{-3}\n$$\n由于 $S_0  0$，激光器如假设一样工作在阈值以上。\n\n**2. 小信号线性化**\n令 $N(t) = N_0 + n(t)$、$S(t) = S_0 + s(t)$ 和 $I(t) = I_0 + i(t)$，其中 $n(t)$、$s(t)$ 和 $i(t)$ 是随时间变化的小扰动。我们将这些代入速率方程，并只保留小量的一阶项。\n对于载流子速率方程：\n$$\n\\frac{d(N_0+n)}{dt} = \\frac{I_0+i}{qV} - \\frac{N_0+n}{\\tau_s} - \\Gamma v_g g_d(N_0+n-N_{\\mathrm{tr}})(S_0+s)\n$$\n$$\n\\frac{dn}{dt} = \\frac{i}{qV} - \\frac{n}{\\tau_s} - \\Gamma v_g g_d [ (N_0-N_{\\mathrm{tr}})s + nS_0 ] - \\mathcal{O}(ns)\n$$\n使用 $g(N_0) = g_d(N_0-N_{\\mathrm{tr}})$ 和 $\\Gamma v_g g(N_0) = 1/\\tau_p$：\n$$\n\\frac{dn}{dt} = \\frac{i}{qV} - \\frac{n}{\\tau_s} - \\frac{s}{\\tau_p} - \\Gamma v_g g_d S_0 n = \\frac{i}{qV} - \\left( \\frac{1}{\\tau_s} + \\Gamma v_g g_d S_0 \\right) n - \\frac{s}{\\tau_p}\n$$\n对于光子速率方程：\n$$\n\\frac{d(S_0+s)}{dt} = \\Gamma v_g g_d(N_0+n-N_{\\mathrm{tr}})(S_0+s) - \\frac{S_0+s}{\\tau_p}\n$$\n$$\n\\frac{ds}{dt} = \\Gamma v_g g_d [ (N_0-N_{\\mathrm{tr}})s + nS_0 ] - \\frac{s}{\\tau_p} - \\mathcal{O}(ns)\n$$\n使用 $\\Gamma v_g g_d(N_0-N_{\\mathrm{tr}}) = 1/\\tau_p$：\n$$\n\\frac{ds}{dt} = \\frac{s}{\\tau_p} + (\\Gamma v_g g_d S_0) n - \\frac{s}{\\tau_p} = (\\Gamma v_g g_d S_0) n\n$$\n线性化方程组为：\n$$\n\\frac{dn}{dt} = \\frac{i(t)}{qV} - \\gamma_N n(t) - \\frac{1}{\\tau_p} s(t)\n$$\n$$\n\\frac{ds}{dt} = G_0 n(t)\n$$\n其中 $G_0 = \\Gamma v_g g_d S_0$ 是微分受激发射率，$\\gamma_N = \\frac{1}{\\tau_s} + G_0$ 是总载流子衰减率。\n\n**3. 频率响应**\n我们通过令 $i(t) = \\tilde{i}e^{j\\omega t}$、$n(t) = \\tilde{n}e^{j\\omega t}$ 和 $s(t) = \\tilde{s}e^{j\\omega t}$，在频域中分析该系统。导数变成乘以 $j\\omega$：\n$$\nj\\omega \\tilde{n} = \\frac{\\tilde{i}}{qV} - \\gamma_N \\tilde{n} - \\frac{1}{\\tau_p} \\tilde{s}\n$$\n$$\nj\\omega \\tilde{s} = G_0 \\tilde{n}\n$$\n从第二个方程，我们用 $\\tilde{s}$ 表示 $\\tilde{n}$：$\\tilde{n} = \\frac{j\\omega}{G_0} \\tilde{s}$。将此代入第一个方程：\n$$\nj\\omega \\left( \\frac{j\\omega}{G_0} \\tilde{s} \\right) = \\frac{\\tilde{i}}{qV} - \\gamma_N \\left( \\frac{j\\omega}{G_0} \\tilde{s} \\right) - \\frac{1}{\\tau_p} \\tilde{s}\n$$\n$$\n\\frac{-\\omega^2}{G_0} \\tilde{s} = \\frac{\\tilde{i}}{qV} - \\frac{j\\omega \\gamma_N}{G_0} \\tilde{s} - \\frac{1}{\\tau_p} \\tilde{s}\n$$\n重新整理以求传递函数 $H(\\omega) = \\tilde{s}/\\tilde{i}$：\n$$\n\\tilde{s} \\left( \\frac{-\\omega^2}{G_0} + \\frac{j\\omega \\gamma_N}{G_0} + \\frac{1}{\\tau_p} \\right) = \\frac{\\tilde{i}}{qV}\n$$\n$$\n\\tilde{s} \\left( -\\omega^2 + j\\omega \\gamma_N + \\frac{G_0}{\\tau_p} \\right) = \\frac{G_0}{qV} \\tilde{i}\n$$\n$$\nH(\\omega) = \\frac{\\tilde{s}}{\\tilde{i}} = \\frac{G_0 / (qV)}{-\\omega^2 + j\\omega \\gamma_N + G_0/\\tau_p}\n$$\n这是一个二阶系统。无阻尼共振角频率 $\\omega_r$ 由 $\\omega_r^2 = G_0/\\tau_p$ 给出。阻尼率为 $\\gamma = \\gamma_N$。\n$$\nH(\\omega) = \\frac{G_0/(qV)}{(\\omega_r^2 - \\omega^2) + j\\omega \\gamma}\n$$\n\n**4. 在共振点求值**\n问题要求在共振频率 $\\omega = \\omega_r$ 处的物理量。\n首先，计算 $\\omega_r$ 和 $\\gamma$：\n$$\nG_0 = \\Gamma v_g g_d S_0 = (0.30)(8.0 \\times 10^7)(2.0 \\times 10^{-20})(2.15886... \\times 10^{21}) = 1.03625... \\times 10^9 \\, \\mathrm{s}^{-1}\n$$\n$$\n\\omega_r^2 = \\frac{G_0}{\\tau_p} = \\frac{1.03625... \\times 10^9 \\, \\mathrm{s}^{-1}}{2.0 \\times 10^{-12} \\, \\mathrm{s}} = 5.18127... \\times 10^{20} \\, \\mathrm{rad}^2/\\mathrm{s}^2\n$$\n$$\n\\omega_r = \\sqrt{5.18127... \\times 10^{20}} = 2.27624... \\times 10^{10} \\, \\mathrm{rad/s}\n$$\n$$\n\\gamma = \\gamma_N = \\frac{1}{\\tau_s} + G_0 = \\frac{1}{1.0 \\times 10^{-9} \\, \\mathrm{s}} + 1.03625... \\times 10^9 \\, \\mathrm{s}^{-1} = 10^9 + 1.03625... \\times 10^9 = 2.03625... \\times 10^9 \\, \\mathrm{s}^{-1}\n$$\n\n**振幅比：**\n振幅响应是 $|H(\\omega)|$。直流增益是 $|H(0)|$。\n$$\n|H(0)| = \\left| \\frac{G_0/(qV)}{\\omega_r^2} \\right| = \\frac{G_0/(qV)}{G_0/\\tau_p} = \\frac{\\tau_p}{qV}\n$$\n在共振点，$\\omega = \\omega_r$：\n$$\nH(\\omega_r) = \\frac{G_0/(qV)}{(\\omega_r^2 - \\omega_r^2) + j\\omega_r \\gamma} = \\frac{G_0/(qV)}{j\\omega_r \\gamma}\n$$\n共振时的幅值为：\n$$\n|H(\\omega_r)| = \\frac{G_0/(qV)}{\\omega_r \\gamma}\n$$\n所需的振幅比是：\n$$\n\\frac{|H(\\omega_r)|}{|H(0)|} = \\frac{G_0 / (qV\\omega_r \\gamma)}{\\tau_p / (qV)} = \\frac{G_0 \\tau_p}{\\omega_r \\gamma}\n$$\n由于 $\\omega_r^2 = G_0/\\tau_p$，我们有 $G_0 = \\omega_r^2 \\tau_p$。代入此式：\n$$\n\\frac{|H(\\omega_r)|}{|H(0)|} = \\frac{(\\omega_r^2 \\tau_p) \\tau_p}{\\omega_r \\gamma} = \\frac{\\omega_r \\tau_p^2}{\\gamma} \\text{ 这也错了。}\n$$\n让我们使用更简单的方法。振幅比为：\n$$\n\\frac{|H(\\omega_r)|}{|H(0)|} = \\frac{|G_0/(qV) / (j \\omega_r \\gamma)|}{|G_0/(qV) / \\omega_r^2|} = \\frac{\\omega_r^2}{\\omega_r \\gamma} = \\frac{\\omega_r}{\\gamma}\n$$\n这是正确的表达式。现在计算数值：\n$$\n\\frac{\\omega_r}{\\gamma} = \\frac{2.27624... \\times 10^{10} \\, \\mathrm{rad/s}}{2.03625... \\times 10^9 \\, \\mathrm{s}^{-1}} = 11.1785...\n$$\n四舍五入到四位有效数字，振幅比为 $11.18$。\n\n**相位：**\n$S(t)$ 相对于 $I(t)$ 的相位是复传递函数的辐角，即 $\\arg(H(\\omega))$。在共振点 $\\omega = \\omega_r$：\n$$\n\\arg(H(\\omega_r)) = \\arg \\left( \\frac{G_0/(qV)}{j\\omega_r \\gamma} \\right) = \\arg \\left( \\frac{1}{j} \\right) = \\arg(-j) = -\\frac{\\pi}{2} \\, \\mathrm{rad}\n$$\n相位恰好是 $-\\frac{\\pi}{2}$ 弧度。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11.18  -\\frac{\\pi}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "线性近似为了解激光器动态学提供了深刻的见解，但实际应用，如数字光通信，通常涉及大信号调制，此时非线性效应变得至关重要。本练习要求您通过数值方法求解包含增益压缩效应的完整速率方程，来模拟激光器对电流阶跃的响应。这个实践将使您能够量化过冲和建立时间等关键性能指标，并直接评估非线性效应对激光器瞬态行为的影响。",
            "id": "3771981",
            "problem": "您需要编写一个完整、可运行的程序，该程序使用耦合速率方程对半导体受激辐射光放大（LASER）二极管的大信号阶跃调制进行建模，并评估增益压缩相对于线性（无压缩）模型如何改变光子密度过冲和稳定时间。该模型必须在科学上保持一致，并源于半导体物理和器件建模的基本原理。\n\n从单模半导体激光二极管有源区中载流子密度和光子密度的标准耦合速率方程开始。令 $N(t)$ 表示单位为 $\\mathrm{m}^{-3}$ 的载流子密度，$S(t)$ 表示单位为 $\\mathrm{m}^{-3}$ 的光子密度，$I(t)$ 表示单位为 $\\mathrm{A}$ 的注入电流。该模型必须使用以下经过充分检验的形式和定义：\n\n- 载流子速率方程为 $\\,\\dfrac{dN}{dt} = \\dfrac{I(t)}{q V} - \\dfrac{N}{\\tau_n} - G(N,S;\\varepsilon) \\, S\\,$。\n- 光子速率方程为 $\\,\\dfrac{dS}{dt} = \\big(G(N,S;\\varepsilon) - \\dfrac{1}{\\tau_p}\\big) \\, S + \\beta_{\\mathrm{sp}} \\, \\dfrac{N}{\\tau_{\\mathrm{sp}}}\\,$。\n- 模式增益率是 $\\,G(N,S;\\varepsilon) = \\Gamma \\, v_g \\, g(N,S;\\varepsilon)\\,$，其中 $g$ 是材料增益。\n- 带有增益压缩的材料增益为 $\\,g(N,S;\\varepsilon) = a \\, \\dfrac{N - N_{\\mathrm{tr}}}{1 + \\varepsilon S}\\,$，其中 $a$ 是单位为 $\\mathrm{m}^2$ 的微分增益，$N_{\\mathrm{tr}}$ 是透明载流子密度，$\\varepsilon$ 是单位为 $\\mathrm{m}^3$ 的增益压缩系数。\n- 元电荷为 $\\,q\\,$。有源区体积为 $\\,V\\,$。光学限制因子为 $\\,\\Gamma\\,$。群速度为 $\\,v_g\\,$。载流子寿命为 $\\,\\tau_n\\,$。光子寿命为 $\\,\\tau_p\\,$。自发复合寿命为 $\\,\\tau_{\\mathrm{sp}}\\,$。自发辐射耦合因子为 $\\,\\beta_{\\mathrm{sp}}\\,$。\n\n注入电流是一个阶跃：对于 $\\,t \\ge 0\\,$，$\\,I(t) = I_2\\,$；对于 $\\,t  0\\,$，$\\,I(t) = I_1\\,$。在 $\\,t = 0^-\\,$ 时的初始条件必须是通过求解 $\\,\\dfrac{dN}{dt} = 0\\,$ 和 $\\,\\dfrac{dS}{dt} = 0\\,$ 得到的 $\\,I_1\\,$ 的稳态。在 $\\,t \\to \\infty\\,$ 时，对应于 $\\,I_2\\,$ 的目标稳态也必须通过求解相同的稳态方程得到。\n\n对于给定的模型，将光子密度的过冲定义为超过最终稳态光子密度的最大相对偏移。具体来说，令 $\\,S_{\\max}\\,$ 为阶跃响应在 $\\,t \\ge 0\\,$ 期间 $\\,S(t)\\,$ 的最大值，令 $\\,S_{\\mathrm{ss}}\\,$ 为在 $\\,I_2\\,$ 时的稳态光子密度。过冲必须计算为 $\\,\\max\\!\\big(0, \\dfrac{S_{\\max} - S_{\\mathrm{ss}}}{S_{\\mathrm{ss}}}\\big)\\,$，并且必须表示为十进制小数。稳定时间必须定义为最小的时间 $\\,t_{\\mathrm{settle}}\\,$，使得对于所有 $\\,t' \\ge t_{\\mathrm{settle}}\\,$，都有 $\\,\\left|S(t') - S_{\\mathrm{ss}}\\right| \\le 0.02\\, S_{\\mathrm{ss}}\\,$。稳定时间必须以秒为单位表示。\n\n对于“线性模型”，设置 $\\,\\varepsilon = 0\\,$。对于“增益压缩模型”，使用提供的非零 $\\,\\varepsilon\\,$。对于每个测试用例，使用相同的物理参数、相同的 $\\,I_1\\,$ 和 $\\,I_2\\,$ 阶跃输入来运行两个模型，并为每个模型计算过冲和稳定时间。然后计算相对于线性模型的变化作为差值：$\\,\\Delta O = O_{\\mathrm{comp}} - O_{\\mathrm{lin}}\\,$ 和 $\\,\\Delta T = T_{\\mathrm{comp}} - T_{\\mathrm{lin}}\\,$，其中 $\\,O\\,$ 表示过冲，$\\,T\\,$ 表示稳定时间。\n\n在您的程序中使用以下物理常数和器件参数：\n- $\\,q = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}\\,$，\n- $\\,V = 3.0 \\times 10^{-16}\\,\\mathrm{m}^3\\,$，\n- $\\,\\Gamma = 0.3\\,$，\n- $\\,v_g = 8.0 \\times 10^{7}\\,\\mathrm{m/s}\\,$，\n- $\\,a = 3.0 \\times 10^{-20}\\,\\mathrm{m}^2\\,$，\n- $\\,N_{\\mathrm{tr}} = 1.0 \\times 10^{24}\\,\\mathrm{m}^{-3}\\,$，\n- $\\,\\tau_n = 1.0 \\times 10^{-9}\\,\\mathrm{s}\\,$，\n- $\\,\\tau_p = 2.0 \\times 10^{-12}\\,\\mathrm{s}\\,$，\n- $\\,\\tau_{\\mathrm{sp}} = 1.0 \\times 10^{-9}\\,\\mathrm{s}\\,$，\n- $\\,\\beta_{\\mathrm{sp}} = 1.0 \\times 10^{-4}\\,$。\n\n您的程序必须对每个模型在 $\\,t \\ge 0\\,$ 时，使用在 $\\,I_1\\,$ 处获得的初始条件对耦合速率方程进行数值积分，并确定如上定义的 $\\,O\\,$ 和 $\\,T\\,$。积分时域必须足够长以观察到稳定过程，并且该方法必须对 $\\,\\tau_p \\ll \\tau_n\\,$ 所暗示的刚性问题具有鲁棒性。所有需要物理单位的答案都必须以上述指定的单位表示；过冲必须是十进制小数，稳定时间必须以秒为单位。\n\n测试套件。您的程序必须为以下一组阶跃调制测试用例计算结果，每个用例由电流水平（单位为 $\\mathrm{mA}$）和增益压缩系数（单位为 $\\mathrm{m}^3$）定义：\n\n- 情况 $\\,1\\,$：$\\,I_1 = 60.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 100.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 1.0 \\times 10^{-23}\\,\\mathrm{m}^3\\,$。\n- 情况 $\\,2\\,$：$\\,I_1 = 55.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 120.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 5.0 \\times 10^{-23}\\,\\mathrm{m}^3\\,$。\n- 情况 $\\,3\\,$：$\\,I_1 = 80.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 90.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 2.0 \\times 10^{-23}\\,\\mathrm{m}^3\\,$。\n- 情况 $\\,4\\,$：$\\,I_1 = 70.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 100.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 0.0\\,\\mathrm{m}^3\\,$。\n- 情况 $\\,5\\,$：$\\,I_1 = 60.0\\,\\mathrm{mA}\\,$, $\\,I_2 = 200.0\\,\\mathrm{mA}\\,$, $\\,\\varepsilon = 1.0 \\times 10^{-22}\\,\\mathrm{m}^3\\,$。\n\n对于每种情况，计算如上定义的 $\\,\\Delta O\\,$ 和 $\\,\\Delta T\\,$。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且是一个双元素列表 $[\\,\\Delta O,\\,\\Delta T\\,]$。例如，输出必须具有形式 $[ [\\Delta O_1,\\Delta T_1], [\\Delta O_2,\\Delta T_2], \\dots ]$，所有数值均以标准十进制表示法按其指定单位打印。",
            "solution": "目标是量化增益压缩如何相对于线性模型改变大信号阶跃响应特性，特别是过冲和稳定时间。我们从半导体激光二极管速率方程开始，这些方程体现了基本的载流子-光子动力学，并源于受激辐射、自发辐射和腔光子损耗。\n\n载流子密度 $\\,N(t)\\,$ 和光子密度 $\\,S(t)\\,$ 的耦合速率方程为\n$$\n\\frac{dN}{dt} = \\frac{I(t)}{q V} - \\frac{N}{\\tau_n} - G(N,S;\\varepsilon)\\, S,\n\\qquad\n\\frac{dS}{dt} = \\Big(G(N,S;\\varepsilon) - \\frac{1}{\\tau_p}\\Big)\\, S + \\beta_{\\mathrm{sp}}\\, \\frac{N}{\\tau_{\\mathrm{sp}}}.\n$$\n模式增益率 $\\,G(N,S;\\varepsilon)\\,$ 是光学限制因子 $\\,\\Gamma\\,$、群速度 $\\,v_g\\,$ 和材料增益 $\\,g(N,S;\\varepsilon)\\,$ 的乘积，\n$$\nG(N,S;\\varepsilon) = \\Gamma\\, v_g \\, g(N,S;\\varepsilon),\n\\quad\ng(N,S;\\varepsilon) = a \\, \\frac{N - N_{\\mathrm{tr}}}{1 + \\varepsilon S}.\n$$\n增益压缩系数 $\\,\\varepsilon\\,$ 引入了增益随光子密度增加而饱和的效应，这是实际器件中经过充分检验的效应，并增加了张弛振荡的阻尼。线性模型对应于设置 $\\,\\varepsilon = 0\\,$，因此 $\\,g(N,S;0) = a (N - N_{\\mathrm{tr}})\\,$。\n\n阶跃调制由 $\\,t \\ge 0\\,$ 时的 $\\,I(t) = I_2\\,$ 和 $\\,t  0\\,$ 时的 $\\,I(t) = I_1\\,$ 定义。在 $\\,t = 0^-\\,$ 时的初始条件是 $\\,I_1\\,$ 的稳态。对于恒定电流 $\\,I\\,$ 的稳态求解\n$$\n\\frac{I}{q V} - \\frac{N}{\\tau_n} - G(N,S;\\varepsilon)\\, S = 0,\n\\qquad\n\\Big(G(N,S;\\varepsilon) - \\frac{1}{\\tau_p}\\Big)\\, S + \\beta_{\\mathrm{sp}}\\, \\frac{N}{\\tau_{\\mathrm{sp}}} = 0.\n$$\n对于高于阈值的线性模型，一个重要特性是载流子被钉扎在阈值载流子密度 $\\,N_{\\mathrm{th}} = N_{\\mathrm{tr}} + \\frac{1}{\\Gamma v_g a \\tau_p}\\,$ 附近，这是通过将材料增益等同于腔损耗率 $\\,\\frac{1}{\\tau_p}\\,$ 得出的。在该区域，稳态光子密度可以近似为\n$$\nS_{\\mathrm{ss}} \\approx \\tau_p\\left(\\frac{I}{q V} - \\frac{N_{\\mathrm{th}}}{\\tau_n}\\right),\n$$\n并且阈值电流 $\\,I_{\\mathrm{th}} = \\frac{q V N_{\\mathrm{th}}}{\\tau_n}\\,$ 设定了激射的起始点。对于增益压缩 $\\,(\\varepsilon  0)\\,$，有效增益在较高的 $\\,S\\,$ 时会减小，因此精确的稳态必须从上述非线性方程组中获得。\n\n对于阶跃到 $\\,I_2\\,$ 后的大信号动力学，我们从 $\\,I_1\\,$ 的稳态开始，对耦合常微分方程进行时间上的前向积分。因为 $\\,\\tau_p \\ll \\tau_n\\,$，可能存在刚性问题，所以使用隐式方法（如刚性求解器）是合适的。我们使用一个时间范围跨越多个载流子寿命的数值积分，确保向稳态收敛。\n\n评估所需的定义：\n- 令 $\\,S_{\\mathrm{ss}}\\,$ 表示所选模型在 $\\,I_2\\,$ 时的最终稳态光子密度。\n- 令 $\\,S_{\\max}\\,$ 表示在瞬态 $\\,t \\ge 0\\,$ 期间观察到的最大光子密度。\n- 过冲定义为\n$$\nO = \\max\\!\\left(0, \\frac{S_{\\max} - S_{\\mathrm{ss}}}{S_{\\mathrm{ss}}}\\right),\n$$\n根据构造，这是一个无量纲的十进制小数。\n- 稳定时间定义为最小时间 $\\,t_{\\mathrm{settle}}\\,$，使得对于所有 $\\,t' \\ge t_{\\mathrm{settle}}\\,$，都有 $\\,|S(t') - S_{\\mathrm{ss}}| \\le 0.02\\, S_{\\mathrm{ss}}\\,$。这是通过扫描阶跃后的轨迹来定位最后一个违反容差带的位置，并取下一个时间样本作为 $\\,t_{\\mathrm{settle}}\\,$ 来计算的。如果在模拟区间的尾部，容差带从未被满足，我们报告 $\\,t_{\\mathrm{settle}} = \\mathrm{NaN}\\,$ 以指示在所选时域内未稳定。\n\n算法设计：\n1. 对于每个测试用例，构建两个模型：$\\,\\varepsilon = 0\\,$ 的线形模型和使用给定 $\\,\\varepsilon  0\\,$ 的增益压缩模型。\n2. 对于每个模型以及 $\\,I_1\\,$ 和 $\\,I_2\\,$ 中的每一个，通过求解上述代数系统来计算稳态 $\\,\\{N_{\\mathrm{ss}}, S_{\\mathrm{ss}}\\}\\,$。使用物理上合理的初始猜测：载流子接近 $\\,N_{\\mathrm{th}} = N_{\\mathrm{tr}} + \\frac{1}{\\Gamma v_g a \\tau_p}\\,$，当高于阈值时，光子密度接近 $\\,\\tau_p\\left(\\frac{I}{q V} - \\frac{N_{\\mathrm{th}}}{\\tau_n}\\right)$。\n3. 对于每个模型，使用刚性求解器和适当的容差，从 $\\,I_1\\,$ 的稳态开始，并在积分期间使用 $\\,I = I_2\\,$，将速率方程从 $\\,t = 0\\,$ 积分到一个结束时间（例如，$\\,T_{\\mathrm{end}} = 2.0 \\times 10^{-8}\\,\\mathrm{s}\\,$），该时间是几个载流子寿命的长度。\n4. 从模拟的 $\\,S(t)\\,$ 和在 $\\,I_2\\,$ 时的最终稳态计算 $\\,O\\,$ 和 $\\,t_{\\mathrm{settle}}\\,$。\n5. 对于每个测试用例，报告相对于线性模型的变化，$\\,\\Delta O = O_{\\mathrm{comp}} - O_{\\mathrm{lin}}\\,$ 和 $\\,\\Delta T = T_{\\mathrm{comp}} - T_{\\mathrm{lin}}\\,$。\n\n物理预期：增益压缩通过在高峰值密度下降低 $\\,G(N,S;\\varepsilon)\\,$ 来增加张弛振荡的有效阻尼，这通常会相对于线性模型减少过冲 $\\,O\\,$ 并缩短稳定时间 $\\,T\\,$，尤其对于大阶跃。数值过程直接从耦合速率动力学中捕捉这些效应，而不依赖任何简化公式。\n\n程序以指定的确切格式输出一行：一个逗号分隔的列表，包含每个测试用例的双元素列表 $[\\,\\Delta O,\\,\\Delta T\\,]$，并用方括号括起来。过冲差异是无量纲的十进制小数，稳定时间差异以秒为单位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root\n\n# Physical constants and device parameters (SI units)\nq = 1.602176634e-19  # Coulomb\nV = 3.0e-16          # m^3\nGamma = 0.3          # optical confinement factor\nvg = 8.0e7           # m/s\na = 3.0e-20          # m^2 (differential gain)\nN_tr = 1.0e24        # m^-3 (transparency carrier density)\ntau_n = 1.0e-9       # s (carrier lifetime)\ntau_p = 2.0e-12      # s (photon lifetime)\ntau_sp = 1.0e-9      # s (spontaneous lifetime)\nbeta_sp = 1.0e-4     # spontaneous coupling factor\n\n# Derived threshold carrier density (linear model concept, useful for initial guesses)\ndef N_threshold():\n    return N_tr + 1.0 / (Gamma * vg * a * tau_p)\n\ndef G_rate(N, S, eps):\n    # Modal gain rate G(N,S;eps) = Gamma * vg * a * (N - N_tr) / (1 + eps*S)\n    return Gamma * vg * a * max(N - N_tr, 0.0) / (1.0 + eps * max(S, 0.0))\n\ndef rate_equations(t, y, I, eps):\n    N, S = y\n    N = max(N, 0.0)\n    S = max(S, 0.0)\n    G = G_rate(N, S, eps)\n    dNdt = I / (q * V) - N / tau_n - G * S\n    dSdt = (G - 1.0 / tau_p) * S + beta_sp * N / tau_sp\n    return [dNdt, dSdt]\n\ndef steady_state(I, eps):\n    # Solve for steady-state (N,S) such that dN/dt=0, dS/dt=0 at constant current I\n    N_th = N_threshold()\n    # Initial guesses: carrier near threshold; photon density from linear pinned-carrier approximation\n    S_guess = tau_p * (I / (q * V) - N_th / tau_n)\n    if S_guess  0.0:\n        S_guess = 1.0e10  # a small positive photon density guess to avoid zero\n    N_guess = max(N_tr, N_th)\n    x0 = np.array([N_guess, S_guess])\n\n    def F(x):\n        N, S = x\n        # Penalize negative states to steer the solver away\n        if N  0 or S  0:\n            return np.array([1e6 + abs(N)*1e6, 1e6 + abs(S)*1e6])\n        G = G_rate(N, S, eps)\n        f1 = I / (q * V) - N / tau_n - G * S\n        f2 = (G - 1.0 / tau_p) * S + beta_sp * N / tau_sp\n        return np.array([f1, f2])\n\n    sol = root(F, x0, method='hybr')\n    if not sol.success:\n        # Try an alternative initial guess if the first attempt fails\n        x0_alt = np.array([I * tau_n / (q * V), max(S_guess, 1e10)])\n        sol = root(F, x0_alt, method='hybr')\n    N_ss, S_ss = sol.x\n    # Enforce non-negativity\n    N_ss = float(max(N_ss, 0.0))\n    S_ss = float(max(S_ss, 0.0))\n    return N_ss, S_ss\n\ndef simulate_step(I1, I2, eps, T_end=2.0e-8, num_points=10001):\n    # Get steady states for initial and final currents\n    N1, S1 = steady_state(I1, eps)\n    N2, S2 = steady_state(I2, eps)\n    # Integrate the ODEs after the step to I2\n    t_eval = np.linspace(0.0, T_end, num_points)\n    y0 = [N1, S1]\n    sol = solve_ivp(rate_equations, (0.0, T_end), y0, args=(I2, eps),\n                    method='Radau', t_eval=t_eval, rtol=1e-6, atol=1e-12)\n    t = sol.t\n    S = sol.y[1]\n    return t, S, S2\n\ndef overshoot_and_settling(t, S, S_ss, tol=0.02):\n    # Overshoot as max relative excursion above S_ss\n    S_peak = float(np.max(S))\n    overshoot = 0.0\n    if S_ss > 0.0 and S_peak > S_ss:\n        overshoot = (S_peak - S_ss) / S_ss\n    else:\n        overshoot = 0.0\n    # Settling time: earliest time after which all samples remain within tolerance band\n    if S_ss = 0.0:\n        # If the final steady-state photon density is zero, settling time is undefined / NaN\n        return overshoot, float('nan')\n    band = tol * S_ss\n    violations = np.abs(S - S_ss) > band\n    if not np.any(violations):\n        settle_time = 0.0\n    else:\n        last_bad_idx = np.where(violations)[0][-1]\n        if last_bad_idx >= len(t) - 1:\n            settle_time = float('nan')  # never settled within horizon\n        else:\n            settle_time = float(t[last_bad_idx + 1])\n    return overshoot, settle_time\n\ndef analyze_case(I1_mA, I2_mA, eps):\n    # Convert mA to A\n    I1 = I1_mA * 1e-3\n    I2 = I2_mA * 1e-3\n    # Linear model (eps_lin=0)\n    t_lin, S_lin, Sss_lin = simulate_step(I1, I2, eps=0.0)\n    O_lin, T_lin = overshoot_and_settling(t_lin, S_lin, Sss_lin, tol=0.02)\n    # Gain-compressed model (eps as given)\n    t_cmp, S_cmp, Sss_cmp = simulate_step(I1, I2, eps=eps)\n    O_cmp, T_cmp = overshoot_and_settling(t_cmp, S_cmp, Sss_cmp, tol=0.02)\n    # Differences relative to linear\n    dO = O_cmp - O_lin\n    # Settling time difference: if either is NaN, return NaN\n    if np.isnan(T_lin) or np.isnan(T_cmp):\n        dT = float('nan')\n    else:\n        dT = T_cmp - T_lin\n    return [dO, dT]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\"I1_mA\": 60.0, \"I2_mA\": 100.0, \"eps\": 1.0e-23},\n        {\"I1_mA\": 55.0, \"I2_mA\": 120.0, \"eps\": 5.0e-23},\n        {\"I1_mA\": 80.0, \"I2_mA\": 90.0,  \"eps\": 2.0e-23},\n        {\"I1_mA\": 70.0, \"I2_mA\": 100.0, \"eps\": 0.0e0},\n        {\"I1_mA\": 60.0, \"I2_mA\": 200.0, \"eps\": 1.0e-22},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_case(case[\"I1_mA\"], case[\"I2_mA\"], case[\"eps\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Results is a list of [dOvershoot, dSettleTime] lists.\n    # Print a single line: e.g., [[dO1,dT1],[dO2,dT2],...]\n    print(f\"[{','.join('[' + ','.join(map(str, r)) + ']' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}