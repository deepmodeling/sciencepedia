{
    "hands_on_practices": [
        {
            "introduction": "在高电场下，半导体中的载流子从电场中获取能量的速率会超过它们通过晶格散射将能量释放给晶格的速率。这使得载流子群体达到一种准热力学平衡状态，其特征是拥有一个比晶格温度 $T_L$ 高的有效电子温度 $T_e$。这个练习  将引导你从能量平衡的基本原理出发，推导有效电子温度的表达式，为理解“热载流子”这一概念奠定定量的物理基础。",
            "id": "3753682",
            "problem": "一个均匀掺杂的非简并 $n$ 型半导体，在晶格温度为 $T_{L}$ 时，被施加一个空间均匀的静态电场 $E$。假设导带为单抛物线型，有效质量是各向同性的，并且电子系综可以通过一个有效电子温度 $T_{e}$ 来描述，该温度的定义是通过将每个电子的平均载流子能量与三维经典气体的能量相等来确定。忽略速度饱和以及迁移率对电场的任何依赖性。在弛豫时间近似下，使用单一的能量弛豫时间 $\\tau_{\\varepsilon}$ 来模拟与晶格的能量交换，并假设系统处于稳态。电荷输运由一个恒定的低场迁移率 $\\mu$ 描述，因此漂移电流密度满足 $J = q n \\mu E$，其中 $q$ 是元电荷，$n$ 是载流子浓度。\n\n从单位体积的焦耳热率与电子向晶格的能量损失率之间的功率平衡第一性原理出发，推导 $T_{e}$ 关于 $T_{L}$、$E$、$\\mu$、$q$、$k_{B}$ 和 $\\tau_{\\varepsilon}$ 的显式表达式，并说明在此模型中 $T_{e}$ 是否依赖于 $n$。使用你的结果，通过给出一个包含给定参数的电场不等式，来确定 $T_{e} \\approx T_{L}$ 的参数区域。\n\n最后，根据以下数据计算 $T_{e}$ 的值，将答案四舍五入至四位有效数字，并以开尔文为单位表示：\n- $T_{L} = 300\\,\\mathrm{K}$，\n- $E = 2.5 \\times 10^{5}\\,\\mathrm{V/m}$，\n- $\\mu = 0.80\\,\\mathrm{m^{2}/(V \\cdot s)}$，\n- $n = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$，\n- $\\tau_{\\varepsilon} = 1.20 \\times 10^{-13}\\,\\mathrm{s}$，\n- $q = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，\n- $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n\n你最终报告的量必须是以开尔文为单位的 $T_{e}$。不要将中间结果作为最终答案报告。将 $T_{e}$ 四舍五入至四位有效数字。",
            "solution": "问题要求推导在高电场下半导体中的有效电子温度 $T_e$。推导将基于稳态下的功率平衡原理：电子从电场中获得能量的速率必须等于其损失能量给晶格的速率。\n\n首先，我们确定每个电子从电场 $E$ 获得的能量增益率。电场每单位体积提供的功率由焦耳热公式给出，$P_{in} = \\vec{J} \\cdot \\vec{E}$。已知电荷输运由漂移电流密度 $J = q n \\mu E$ 描述，并假设在各向同性介质中电场和电流平行，则功率密度为 $P_{in} = J E = (q n \\mu E) E = q n \\mu E^2$。这是单位体积内传递给所有 $n$ 个电子的总功率。为了找到每个电子的功率增益，我们将其除以电子浓度 $n$：\n$$P_{gain, e} = \\frac{P_{in}}{n} = \\frac{q n \\mu E^2}{n} = q \\mu E^2$$\n\n接下来，我们对从“热”电子到“冷”晶格的能量损失率进行建模。题目指出，系综中一个电子的平均能量由具有有效温度 $T_e$ 的三维经典气体的表达式给出，即 $\\langle \\mathcal{E} \\rangle = \\frac{3}{2} k_B T_e$。在与温度为 $T_L$ 的晶格达到热平衡时，其平均能量应为 $\\langle \\mathcal{E}_0 \\rangle = \\frac{3}{2} k_B T_L$。因此，每个电子的超额平均能量为：\n$$\\Delta \\mathcal{E} = \\langle \\mathcal{E} \\rangle - \\langle \\mathcal{E}_0 \\rangle = \\frac{3}{2} k_B (T_e - T_L)$$\n问题指明能量交换是使用单一的能量弛豫时间 $\\tau_{\\varepsilon}$ 来建模的。在这种近似下，每个电子的能量损失率是超额能量除以弛豫时间：\n$$P_{loss, e} = \\frac{\\Delta \\mathcal{E}}{\\tau_{\\varepsilon}} = \\frac{\\frac{3}{2} k_B (T_e - T_L)}{\\tau_{\\varepsilon}}$$\n\n在稳态下，能量增益率必须等于能量损失率：$P_{gain, e} = P_{loss, e}$。\n$$q \\mu E^2 = \\frac{3 k_B (T_e - T_L)}{2 \\tau_{\\varepsilon}}$$\n我们现在求解这个方程以得到有效电子温度 $T_e$：\n$$T_e - T_L = \\frac{2 q \\mu \\tau_{\\varepsilon} E^2}{3 k_B}$$\n$$T_e = T_L + \\frac{2 q \\mu \\tau_{\\varepsilon}}{3 k_B} E^2$$\n这就是用给定参数表示的 $T_e$ 的显式表达式。\n\n问题询问 $T_e$ 是否依赖于载流子浓度 $n$。观察推导出的表达式，$T_e$ 是 $T_L$、$q$、$\\mu$、$\\tau_{\\varepsilon}$、$E$ 和 $k_B$ 的函数。载流子浓度 $n$ 没有出现在最终的表达式中。因此，在这个模型中，有效电子温度 $T_e$ 不依赖于 $n$。这是因为每个电子的功率输入和能量损失机制都独立于电子总数。\n\n接下来，我们确定电子温度约等于晶格温度（$T_e \\approx T_L$）的参数区域。当 $T_e$ 表达式中的第二项远小于 $T_L$ 时，该条件成立：\n$$\\frac{2 q \\mu \\tau_{\\varepsilon}}{3 k_B} E^2 \\ll T_L$$\n这可以重写为关于电场强度 $E$ 的一个不等式：\n$$E^2 \\ll \\frac{3 k_B T_L}{2 q \\mu \\tau_{\\varepsilon}}$$\n取平方根，我们得到低场区域的条件：\n$$|E| \\ll \\sqrt{\\frac{3 k_B T_L}{2 q \\mu \\tau_{\\varepsilon}}}$$\n\n最后，我们使用提供的数值数据计算 $T_e$：\n$T_{L} = 300\\,\\mathrm{K}$\n$E = 2.5 \\times 10^{5}\\,\\mathrm{V/m}$\n$\\mu = 0.80\\,\\mathrm{m^{2}/(V \\cdot s)}$\n$\\tau_{\\varepsilon} = 1.20 \\times 10^{-13}\\,\\mathrm{s}$\n$q = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n\n我们计算温度升高量 $\\Delta T = T_e - T_L$：\n$$\\Delta T = \\frac{2 q \\mu \\tau_{\\varepsilon} E^2}{3 k_B}$$\n代入数值：\n$$\\Delta T = \\frac{2 (1.602176634 \\times 10^{-19}) (0.80) (1.20 \\times 10^{-13}) (2.5 \\times 10^{5})^2}{3 (1.380649 \\times 10^{-23})}$$\n$$\\Delta T = \\frac{2 \\times 1.602176634 \\times 0.80 \\times 1.20 \\times 6.25 \\times 10^{-19} \\times 10^{-13} \\times 10^{10}}{3 \\times 1.380649 \\times 10^{-23}}\\,\\mathrm{K}$$\n$$\\Delta T = \\frac{1.9226119608 \\times 10^{-21}}{4.141947 \\times 10^{-23}}\\,\\mathrm{K}$$\n$$\\Delta T \\approx 46.418306\\,\\mathrm{K}$$\n有效电子温度是：\n$$T_e = T_L + \\Delta T = 300\\,\\mathrm{K} + 46.418306\\,\\mathrm{K} = 346.418306\\,\\mathrm{K}$$\n将最终答案四舍五入到四位有效数字，我们得到：\n$$T_e \\approx 346.4\\,\\mathrm{K}$$\n给定的载流子浓度值 $n = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$ 在此计算中是不需要的，正如推导出的公式所示。",
            "answer": "$$\\boxed{346.4}$$"
        },
        {
            "introduction": "热载流子效应的一个关键后果是碰撞电离，这可能导致载流子雪崩倍增，最终引起器件击穿。这个问题  让你在一个更接近实际pn结情况的非均匀电场中，对载流子倍增因子 $M$ 进行建模。通过将精确的数值积分结果与简化的均匀场近似值进行对比，你将深刻体会到碰撞电离过程的强非线性特性，并理解在器件建模中精确描述电场分布的重要性。",
            "id": "3753679",
            "problem": "考虑一个反向偏置的单边渐变半导体结中的电子引发的碰撞电离，在一个空间维度上建模，坐标为 $x \\in [0,W]$，从 $x=0$ 处的高场边缘到 $x=W$ 处的低场边缘。假设局部（位置相关）电场分布由下式给出\n$$\nE(x) = \\frac{E_0}{1 + \\frac{x}{L}},\n$$\n其中 $E_0$ 和 $L$ 是正常数，$W$ 是倍增区的长度。假设只有电子对碰撞电离有贡献（空穴电离可忽略不计），并忽略非局部（死区）效应，因此电离过程由一个局部电离系数描述。电子碰撞电离系数由广泛使用的 Chynoweth 定律建模\n$$\n\\alpha_n(E) = A \\exp\\!\\left(-\\frac{B}{E}\\right),\n$$\n其中 $A$ 和 $B$ 是正的材料参数。\n\n从粒子数守恒和局部产生的基本定义出发，考虑对于在 $x=0$ 处注入的单个电子，其电子期望数量是位置 $x$ 的函数 $m(x)$。在上述假设下，在无穷小距离 $\\mathrm{d}x$ 上载流子的平均增量与当前载流子数量乘以在 $\\mathrm{d}x$ 内发生电离的概率成正比，该概率为 $\\alpha_n(E(x))\\,\\mathrm{d}x$。以此原理为基础，推导 $m(x)$ 的控制微分方程，并以 $x$ 上的积分形式求解电子倍增因子 $M \\equiv m(W)$。您的推导必须从这一原理开始，并避免使用任何快捷公式。\n\n实现一个程序，对下面的每个参数集，执行以下任务：\n1. 使用给定的 $E(x)$ 和 $\\alpha_n(E)$，数值计算精确的倍增因子\n$$\nM_{\\mathrm{exact}} = \\exp\\!\\left(\\int_{0}^{W} \\alpha_n(E(x))\\,\\mathrm{d}x\\right)。\n$$\n2. 通过将非均匀场替换为其在 $[0,W]$ 上的空间平均值，形成一个均匀场近似，\n$$\nE_{\\mathrm{avg}} = \\frac{1}{W}\\int_0^W E(x)\\,\\mathrm{d}x,\n$$\n并计算\n$$\nM_{\\mathrm{uni}} = \\exp\\!\\left(\\alpha_n(E_{\\mathrm{avg}})\\,W\\right)。\n$$\n3. 将场非均匀性引入的误差量化为相对差异\n$$\n\\delta = \\frac{M_{\\mathrm{uni}} - M_{\\mathrm{exact}}}{M_{\\mathrm{exact}}}。\n$$\n\n所有物理量必须使用国际单位制。具体来说，$E_0$ 的单位是 $\\mathrm{V/m}$，$L$ 和 $W$ 的单位是 $\\mathrm{m}$，$A$ 的单位是 $\\mathrm{m}^{-1}$，$B$ 的单位是 $\\mathrm{V/m}$。倍增因子 $M_{\\mathrm{exact}}$ 和 $M_{\\mathrm{uni}}$ 是无量纲的。将误差 $\\delta$ 表示为小数（而非百分比）。\n\n使用以下代表室温下硅的材料参数：\n- $A = 7\\times 10^{7}\\,\\mathrm{m}^{-1}$，\n- $B = 1.23\\times 10^{8}\\,\\mathrm{V/m}$。\n\n测试套件：\n为以下四个参数集 $(E_0, L, W)$ 提供结果：\n- 情况1（近均匀场）：$E_0 = 4.0\\times 10^{7}\\,\\mathrm{V/m}$，$L = 2.0\\times 10^{-6}\\,\\mathrm{m}$，$W = 2.0\\times 10^{-7}\\,\\mathrm{m}$。\n- 情况2（强非均匀性）：$E_0 = 4.0\\times 10^{7}\\,\\mathrm{V/m}$，$L = 1.0\\times 10^{-7}\\,\\mathrm{m}$，$W = 3.0\\times 10^{-7}\\,\\mathrm{m}$。\n- 情况3（较低场，中等非均匀性）：$E_0 = 2.5\\times 10^{7}\\,\\mathrm{V/m}$，$L = 2.0\\times 10^{-7}\\,\\mathrm{m}$，$W = 3.0\\times 10^{-7}\\,\\mathrm{m}$。\n- 情况4（高场，强非均匀性）：$E_0 = 7.0\\times 10^{7}\\,\\mathrm{V/m}$，$L = 5.0\\times 10^{-8}\\,\\mathrm{m}$，$W = 3.0\\times 10^{-7}\\,\\mathrm{m}$。\n\n您的程序必须：\n- 数值计算 $M_{\\mathrm{exact}}$ 的积分，其精度需足以分辨不同情况之间的差异。\n- 使用由给定的 $E(x)$ 推导出的 $E_{\\mathrm{avg}}$ 的解析表达式。\n- 生成单行输出，包含以逗号分隔的列表形式的结果，并用方括号括起来，顺序为\n$$\n[M_{\\mathrm{exact}}^{(1)}, M_{\\mathrm{uni}}^{(1)}, \\delta^{(1)}, M_{\\mathrm{exact}}^{(2)}, M_{\\mathrm{uni}}^{(2)}, \\delta^{(2)}, M_{\\mathrm{exact}}^{(3)}, M_{\\mathrm{uni}}^{(3)}, \\delta^{(3)}, M_{\\mathrm{exact}}^{(4)}, M_{\\mathrm{uni}}^{(4)}, \\delta^{(4)}],\n$$\n其中上标 $^{(i)}$ 对应于情况 $i$。每个值必须是浮点数。由于 $M_{\\mathrm{exact}}$ 和 $M_{\\mathrm{uni}}$ 是无量纲的，因此输出中不需要单位。误差 $\\delta$ 必须表示为小数（例如，对于百分之五的相对误差，表示为 $0.05$）。",
            "solution": "该问题已经过验证，被认为是合理的。它具有科学依据，问题明确，客观，并包含完整解答所需的所有信息。所有模型和假设，例如电场分布、碰撞电离的 Chynoweth 定律以及局部场近似，都是半导体器件物理领域的标准模型和假设。任务定义清晰，能够导出一个唯一的、有意义的解。\n\n解答过程按要求分为三部分：首先，从基本原理推导电子倍增因子；其次，描述精确倍增因子和近似倍增因子的数值评估方法；第三，计算这两种模型之间的相对误差。\n\n**第1部分：电子倍增因子 $M$ 的推导**\n\n我们被要求推导电子期望数量 $m(x)$ 作为位置 $x$ 的函数的控制方程。我们从问题中陈述的原理开始：在无穷小距离 $\\mathrm{d}x$ 上载流子的平均增量 $\\mathrm{d}m$ 与当前载流子数量 $m(x)$ 以及单位长度的电离概率 $\\alpha_n(E(x))$ 成正比。\n\n这个物理原理可以表述为一个微分方程。在区间 $[x, x+\\mathrm{d}x]$ 内产生的新电子-空穴对的数量等于在 $x$ 处的电子数量 $m(x)$ 乘以这些电子中的一个在 $\\mathrm{d}x$ 内发生电离碰撞的概率。这个概率是 $\\alpha_n(E(x))\\,\\mathrm{d}x$。因此，电子数量的增加量为：\n$$\n\\mathrm{d}m = m(x) \\alpha_n(E(x))\\,\\mathrm{d}x\n$$\n这可以改写为一阶常微分方程：\n$$\n\\frac{\\mathrm{d}m(x)}{\\mathrm{d}x} = \\alpha_n(E(x)) m(x)\n$$\n这是一个可分离的微分方程。我们可以分离变量 $m$ 和 $x$ 得到：\n$$\n\\frac{\\mathrm{d}m}{m} = \\alpha_n(E(x))\\,\\mathrm{d}x\n$$\n为了找到倍增区末端 $x=W$ 处的总电子数，我们对两边进行积分。对 $m$ 的积分是从 $x=0$ 处的初始载流子数到 $x=W$ 处的最终载流子数。对 $x$ 的积分是遍及整个区域长度，从 $x=0$ 到 $x=W$。问题陈述中说明在 $x=0$ 处注入单个电子，所以初始条件是 $m(0)=1$。最终载流子数就是倍增因子本身，$M \\equiv m(W)$。\n$$\n\\int_{m(0)}^{m(W)} \\frac{\\mathrm{d}m}{m} = \\int_{0}^{W} \\alpha_n(E(x))\\,\\mathrm{d}x\n$$\n计算左侧积分：\n$$\n[\\ln|m|]_{1}^{M} = \\ln(M) - \\ln(1) = \\ln(M)\n$$\n将其与右侧相等得到：\n$$\n\\ln(M) = \\int_{0}^{W} \\alpha_n(E(x))\\,\\mathrm{d}x\n$$\n对两边取指数，得到电子倍增因子 $M$ 的表达式：\n$$\nM = \\exp\\left(\\int_{0}^{W} \\alpha_n(E(x))\\,\\mathrm{d}x\\right)\n$$\n这个推导出的表达式与问题陈述中为 $M_{\\mathrm{exact}}$ 提供的公式相匹配。\n\n**第2部分：$M_{\\mathrm{exact}}$ 和 $M_{\\mathrm{uni}}$ 的计算**\n\n对每个参数集 $(E_0, L, W)$ 的计算涉及三个步骤：计算 $M_{\\mathrm{exact}}$，计算 $M_{\\mathrm{uni}}$，然后计算相对误差 $\\delta$。\n\n**2.1. 精确倍增因子, $M_{\\mathrm{exact}}$**\n\n为了计算 $M_{\\mathrm{exact}}$，我们必须对上述推导出的积分进行数值评估。被积函数是一个复合函数，涉及局部电场 $E(x)$ 和电离系数 $\\alpha_n(E)$。\n\n电场分布由下式给出：\n$$\nE(x) = \\frac{E_0}{1 + \\frac{x}{L}}\n$$\n电子电离系数由 Chynoweth 定律给出：\n$$\n\\alpha_n(E) = A \\exp\\left(-\\frac{B}{E}\\right)\n$$\n将 $E(x)$ 代入 $\\alpha_n(E)$，被积函数变为：\n$$\n\\alpha_n(E(x)) = A \\exp\\left(-\\frac{B}{E_0/(1 + x/L)}\\right) = A \\exp\\left(-\\frac{B}{E_0}\\left(1 + \\frac{x}{L}\\right)\\right)\n$$\n所以，精确倍增因子为：\n$$\nM_{\\mathrm{exact}} = \\exp\\left(\\int_{0}^{W} A \\exp\\left(-\\frac{B}{E_0}\\left(1 + \\frac{x}{L}\\right)\\right)\\,\\mathrm{d}x\\right)\n$$\n对于每种情况，将使用数值方法（如梯形法则或更精确的自适应求积法，如科学计算库中提供的方法）来计算该积分。\n\n**2.2. 均匀场近似, $M_{\\mathrm{uni}}$**\n\n均匀场近似将位置相关的场 $E(x)$ 替换为其在区间 $[0, W]$ 上的空间平均值 $E_{\\mathrm{avg}}$。首先，我们必须找到 $E_{\\mathrm{avg}}$ 的解析表达式：\n$$\nE_{\\mathrm{avg}} = \\frac{1}{W}\\int_0^W E(x)\\,\\mathrm{d}x = \\frac{1}{W}\\int_0^W \\frac{E_0}{1 + \\frac{x}{L}}\\,\\mathrm{d}x\n$$\n为了评估该积分，我们进行换元。令 $u = 1 + x/L$，则 $\\mathrm{d}u = (1/L)\\,\\mathrm{d}x$。积分限从 $x=0$ 变为 $u=1$，从 $x=W$ 变为 $u=1+W/L$。\n$$\n\\int_0^W \\frac{E_0}{1 + \\frac{x}{L}}\\,\\mathrm{d}x = \\int_1^{1+W/L} \\frac{E_0}{u} L\\,\\mathrm{d}u = E_0 L \\int_1^{1+W/L} \\frac{1}{u}\\,\\mathrm{d}u = E_0 L [\\ln|u|]_1^{1+W/L}\n$$\n$$\n= E_0 L \\left(\\ln\\left(1 + \\frac{W}{L}\\right) - \\ln(1)\\right) = E_0 L \\ln\\left(1 + \\frac{W}{L}\\right)\n$$\n将此结果代回 $E_{\\mathrm{avg}}$ 的表达式中：\n$$\nE_{\\mathrm{avg}} = \\frac{E_0 L}{W} \\ln\\left(1 + \\frac{W}{L}\\right)\n$$\n在此近似下，倍增因子 $M_{\\mathrm{uni}}$ 假定在整个长度 $W$ 上具有恒定的电离系数 $\\alpha_n(E_{\\mathrm{avg}})$。指数中的积分简化为 $\\alpha_n(E_{\\mathrm{avg}}) \\times W$。\n$$\nM_{\\mathrm{uni}} = \\exp\\left(\\alpha_n(E_{\\mathrm{avg}}) \\cdot W\\right) = \\exp\\left(A \\exp\\left(-\\frac{B}{E_{\\mathrm{avg}}}\\right) \\cdot W\\right)\n$$\n\n**第3部分：相对误差, $\\delta$**\n\n相对误差 $\\delta$ 量化了由均匀场近似引入的差异。其定义为：\n$$\n\\delta = \\frac{M_{\\mathrm{uni}} - M_{\\mathrm{exact}}}{M_{\\mathrm{exact}}}\n$$\n$\\delta$ 的负值表示均匀场近似低估了倍增因子，这是预料之中的，因为 $\\alpha_n(E)$ 是 $E$ 的一个凸函数。\n\n数值实现将使用指定的硅材料参数：$A = 7 \\times 10^7 \\, \\mathrm{m}^{-1}$ 和 $B = 1.23 \\times 10^8 \\, \\mathrm{V/m}$。将对给定的4个测试用例进行计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Calculates the exact and uniform-field approximate multiplication factors\n    for electron-initiated impact ionization in a graded semiconductor junction.\n    \"\"\"\n\n    # Material parameters for Silicon (SI units)\n    A = 7.0e7  # m^-1\n    B = 1.23e8 # V/m\n\n    # Test suite: (E0_val, L_val, W_val) in SI units\n    # E0 in V/m, L in m, W in m\n    test_cases = [\n        # Case 1 (nearly uniform field)\n        (4.0e7, 2.0e-6, 2.0e-7),\n        # Case 2 (strong nonuniformity)\n        (4.0e7, 1.0e-7, 3.0e-7),\n        # Case 3 (lower field, modest nonuniformity)\n        (2.5e7, 2.0e-7, 3.0e-7),\n        # Case 4 (high field, strong nonuniformity)\n        (7.0e7, 5.0e-8, 3.0e-7),\n    ]\n\n    results = []\n    for case in test_cases:\n        E0, L, W = case\n\n        # --- Task 1: Calculate the exact multiplication factor, M_exact ---\n\n        # Define the position-dependent electric field E(x)\n        def electric_field(x):\n            return E0 / (1.0 + x / L)\n\n        # Define the electron ionization coefficient alpha_n(E)\n        def ionization_coeff(E):\n            # Avoid division by zero if E is somehow zero, although not expected here.\n            if E == 0:\n                return 0.0\n            return A * np.exp(-B / E)\n\n        # Define the integrand for the exact calculation\n        def integrand_exact(x):\n            return ionization_coeff(electric_field(x))\n\n        # Numerically evaluate the integral of alpha_n(E(x)) from 0 to W\n        # quad returns a tuple (integral_value, error_estimate)\n        integral_val, _ = integrate.quad(integrand_exact, 0, W)\n\n        # Calculate M_exact\n        M_exact = np.exp(integral_val)\n\n        # --- Task 2: Calculate the uniform-field approximation, M_uni ---\n\n        # Calculate the spatially-averaged electric field E_avg\n        # Using np.log1p(x) for log(1+x) is more accurate for small x\n        # E_avg = (E0 * L / W) * log(1 + W/L)\n        if W == 0:\n            E_avg = E0\n        else:\n            E_avg = (E0 * L / W) * np.log1p(W / L)\n        \n        # Calculate the ionization coefficient at the average field\n        alpha_n_avg = ionization_coeff(E_avg)\n\n        # Calculate M_uni\n        M_uni = np.exp(alpha_n_avg * W)\n        \n        # --- Task 3: Quantify the error, delta ---\n\n        # Calculate the relative difference\n        if M_exact == 0:\n           # This case should not occur with the given parameters\n           delta = np.nan\n        else:\n           delta = (M_uni - M_exact) / M_exact\n\n        # Append results for this case\n        results.extend([M_exact, M_uni, delta])\n\n    # Final print statement in the exact required format\n    # The map(str, results) converts all numbers to their string representations.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "为了将理论与实验测量联系起来，我们需要对像MOSFET中的衬底电流 $I_{sub}$ 这样的可测量物理量进行建模，它是碰撞电离的直接标志。这项高级实践  要求你使用两种强大的方法来计算 $I_{sub}$：一种是基于积分的确定性连续介质模型，另一种是基于随机过程的蒙特卡洛模拟。完成这项练习不仅能巩固你对碰撞电离作为随机过程的理解，还将让你掌握半导体器件研究和TCAD开发中广泛使用的现代计算技术。",
            "id": "3753678",
            "problem": "考虑一个短沟道金属-氧化物-半导体场效应晶体管 (MOSFET) 漏极区的一维表示，其中热电子输运导致碰撞电离以及随后的空穴被衬底收集。从电荷载流子的玻尔兹曼输运方程出发，采用漂移主导的一维路径描述，该路径沿沟道坐标 $x \\in [0,L]$ 展开，并具有给定的电场分布 $E(x)$ 和由 Chynoweth 定律描述的碰撞电离系数。您的任务是使用两种方法计算衬底电流：一种是跟踪碰撞电离产生的空穴位置的蒙特卡洛方法，另一种是基于路径积分的连续介质模型。您需要报告每个测试用例的两种计算结果。\n\n基本依据和定义：\n- 碰撞电离系数（每单位长度）的 Chynoweth 定律为 $ \\alpha(E) = A \\exp\\!\\left(-\\dfrac{B}{|E|}\\right) $，其中 $A$ 的单位是 $\\mathrm{m}^{-1}$，$B$ 的单位是 $\\mathrm{V}/\\mathrm{m}$。\n- 电子运动被限制在路径 $x$ 上，沿路径长度的碰撞电离事件被建模为一个强度为 $ \\lambda(x) = \\alpha(E(x)) $ 的非均匀泊松过程，这与将 $ \\alpha(E) $ 解释为每单位长度的平均电离事件数相一致。\n- 每次碰撞电离事件都会产生一个电子-空穴对；在位置 $x$ 产生的空穴被衬底收集的比例由收集效率 $p_{\\mathrm{sub}}(x)$ 建模，其中 $0 \\le p_{\\mathrm{sub}}(x) \\le 1$。\n- 对于每个穿过沟道的电子，衬底收集到的空穴的连续期望值为 $ \\int_{0}^{L} p_{\\mathrm{sub}}(x)\\,\\alpha(E(x))\\,dx $。如果漏极电流为 $I_{d}$，则连续介质模型下的衬底电流为 $ I_{\\mathrm{sub,cont}} = I_{d} \\int_{0}^{L} p_{\\mathrm{sub}}(x)\\,\\alpha(E(x))\\,dx $。\n- 在蒙特卡洛方法中，您必须模拟沿路径长度的碰撞电离事件的非均匀泊松过程，并在接受的事件位置上累加 $p_{\\mathrm{sub}}(x)$，以估计每个电子平均收集到的空穴数，然后乘以 $I_{d}$ 得到 $ I_{\\mathrm{sub,MC}} $。\n\n给定的分布和单位：\n- 电场分布给定为 $ E(x) = E_{\\mathrm{peak}} \\exp\\!\\left(-\\dfrac{L - x}{\\lambda_{E}}\\right) $，其中 $E_{\\mathrm{peak}}$ 的单位是 $ \\mathrm{V}/\\mathrm{m} $，$L$ 和 $\\lambda_{E}$ 的单位是 $ \\mathrm{m} $。\n- 衬底收集效率给定为 $ p_{\\mathrm{sub}}(x) = \\min\\!\\left(1,\\; p_{0} \\exp\\!\\left(-\\dfrac{L - x}{L_{\\mathrm{sub}}}\\right)\\right) $，其中 $p_{0}$ 是无量纲的，$L_{\\mathrm{sub}}$ 的单位是 $ \\mathrm{m} $。\n- 所有电流必须以 $ \\mathrm{A} $ (安培) 表示。\n\n蒙特卡洛方法要求：\n- 使用统计上正确的模拟方法，对强度为 $ \\lambda(x) = \\alpha(E(x)) $ 的非均匀泊松点过程在 $[0,L]$ 上进行模拟，以生成碰撞电离位置。一种有效的方法是使用稀疏法（thinning）：在区间长度 $L$ 上，对一个速率为 $ \\alpha_{\\max} = \\max_{x \\in [0,L]} \\alpha(E(x)) $ 的均匀泊松过程进行稀疏处理，以概率 $ \\alpha(E(x))/\\alpha_{\\max} $ 接受一个提议的位置 $x$。\n- 对于每个测试用例，模拟 $N_{e}$ 个独立的电子从 $x=0$ 穿行到 $x=L$ 的过程，通过将被接受的电离点上的 $p_{\\mathrm{sub}}(x)$ 值求和再除以 $N_{e}$，来估计每个电子平均收集到的衬底空穴数。将该平均值乘以 $I_{d}$ 得到以 $ \\mathrm{A} $ 为单位的 $ I_{\\mathrm{sub,MC}} $。\n\n连续介质模型要求：\n- 使用在 $[0,L]$ 上的数值稳定积分（quadrature）方法计算 $ I_{\\mathrm{sub,cont}} = I_{d} \\int_{0}^{L} p_{\\mathrm{sub}}(x)\\,\\alpha(E(x))\\,dx $。\n\n测试套件：\n对于以下每一组参数，计算并报告 $ I_{\\mathrm{sub,MC}} $ 和 $ I_{\\mathrm{sub,cont}} $。\n\n- 案例 $1$ (中等高场，短沟道)：\n  - $ L = 2.0 \\times 10^{-7}\\,\\mathrm{m} $\n  - $ E_{\\mathrm{peak}} = 8.0 \\times 10^{7}\\,\\mathrm{V}/\\mathrm{m} $\n  - $ \\lambda_{E} = 3.0 \\times 10^{-8}\\,\\mathrm{m} $\n  - $ A = 7.0 \\times 10^{7}\\,\\mathrm{m}^{-1} $\n  - $ B = 1.23 \\times 10^{8}\\,\\mathrm{V}/\\mathrm{m} $\n  - $ p_{0} = 0.6 $\n  - $ L_{\\mathrm{sub}} = 2.0 \\times 10^{-8}\\,\\mathrm{m} $\n  - $ I_{d} = 1.0 \\times 10^{-3}\\,\\mathrm{A} $\n  - $ N_{e} = 8.0 \\times 10^{4} $\n\n- 案例 $2$ (低场边缘情况)：\n  - $ L = 2.0 \\times 10^{-7}\\,\\mathrm{m} $\n  - $ E_{\\mathrm{peak}} = 2.0 \\times 10^{7}\\,\\mathrm{V}/\\mathrm{m} $\n  - $ \\lambda_{E} = 3.0 \\times 10^{-8}\\,\\mathrm{m} $\n  - $ A = 7.0 \\times 10^{7}\\,\\mathrm{m}^{-1} $\n  - $ B = 1.23 \\times 10^{8}\\,\\mathrm{V}/\\mathrm{m} $\n  - $ p_{0} = 0.5 $\n  - $ L_{\\mathrm{sub}} = 2.0 \\times 10^{-8}\\,\\mathrm{m} $\n  - $ I_{d} = 1.0 \\times 10^{-3}\\,\\mathrm{A} $\n  - $ N_{e} = 8.0 \\times 10^{4} $\n\n- 案例 $3$ (近击穿高场，更短沟道)：\n  - $ L = 1.5 \\times 10^{-7}\\,\\mathrm{m} $\n  - $ E_{\\mathrm{peak}} = 1.5 \\times 10^{8}\\,\\mathrm{V}/\\mathrm{m} $\n  - $ \\lambda_{E} = 1.0 \\times 10^{-8}\\,\\mathrm{m} $\n  - $ A = 7.0 \\times 10^{7}\\,\\mathrm{m}^{-1} $\n  - $ B = 1.23 \\times 10^{8}\\,\\mathrm{V}/\\mathrm{m} $\n  - $ p_{0} = 0.9 $\n  - $ L_{\\mathrm{sub}} = 1.5 \\times 10^{-8}\\,\\mathrm{m} $\n  - $ I_{d} = 2.0 \\times 10^{-3}\\,\\mathrm{A} $\n  - $ N_{e} = 8.0 \\times 10^{4} $\n\n实现与输出规范：\n- 实现程序以计算每个案例的 $ I_{\\mathrm{sub,MC}} $ 和 $ I_{\\mathrm{sub,cont}} $。所有电流单位必须是 $ \\mathrm{A} $。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个项目对应一个测试用例，并且本身是一个包含两个浮点数 $[I_{\\mathrm{sub,MC}}, I_{\\mathrm{sub,cont}}]$ 的列表。例如，打印的单行应类似于 $ [[\\ldots,\\ldots],[\\ldots,\\ldots],[\\ldots,\\ldots]] $。",
            "solution": "该问题要求在一个简化的 MOSFET 漏极区一维 ($1$D) 模型中计算衬底电流 $I_{\\mathrm{sub}}$。该电流由热电子引起的碰撞电离产生。需要采用两种不同的方法：一种是基于路径积分的连续介质模型，另一种是随机的蒙特卡洛模拟。对于给定的测试用例集，必须报告两种方法的结果 $I_{\\mathrm{sub,cont}}$ 和 $I_{\\mathrm{sub,MC}}$。\n\n物理模型定义在空间域 $x \\in [0, L]$ 上，其中 $x=0$ 代表沟道侧，$x=L$ 代表漏极末端。关键物理量以位置 $x$ 的函数形式给出。\n\n电场分布给定为：\n$$ E(x) = E_{\\mathrm{peak}} \\exp\\left(-\\frac{L - x}{\\lambda_{E}}\\right) $$\n该函数模拟了一个沿路径指数增长的电场，在漏极末端 $x=L$ 处达到其最大值 $E_{\\mathrm{peak}}$。\n\n碰撞电离的速率由 Chynoweth 定律决定，该定律给出了碰撞电离系数 $\\alpha$ 作为电场强度 $E$ 的函数：\n$$ \\alpha(E) = A \\exp\\left(-\\frac{B}{|E|}\\right) $$\n由于电场 $E$ 随位置 $x$ 变化，电离系数也成为位置的函数，$\\alpha(x) = \\alpha(E(x))$。由于在此模型中 $E(x)$ 始终为正，我们可以写成：\n$$ \\alpha(x) = A \\exp\\left(-\\frac{B}{E(x)}\\right) = A \\exp\\left(-\\frac{B}{E_{\\mathrm{peak}}} e^{\\frac{L-x}{\\lambda_{E}}}\\right) $$\n\n在位置 $x$ 处的一次碰撞电离事件会产生一个电子-空穴对。产生的空穴可能被衬底收集，从而对 $I_{\\mathrm{sub}}$ 做出贡献。这种情况发生的概率由收集效率函数 $p_{\\mathrm{sub}}(x)$ 给出：\n$$ p_{\\mathrm{sub}}(x) = \\min\\left(1, p_{0} \\exp\\left(-\\frac{L - x}{L_{\\mathrm{sub}}}\\right)\\right) $$\n该函数模型表明，越靠近漏极（即 $x \\to L$）产生的空穴，其收集概率越高。\n\n基于这些定义，我们将建立两种所需的计算方法。\n\n**$I_{\\mathrm{sub,cont}}$ 的连续介质模型**\n\n连续介质模型提供了对期望衬底电流的确定性计算。每个穿过路径的电子所对应的期望衬底收集空穴数，是通过将随位置变化的电离率 $\\alpha(x)$ 和随位置变化的收集效率 $p_{\\mathrm{sub}}(x)$ 的乘积在整个路径长度 $L$ 上积分得到的。总衬底电流是每个电子的这个期望值乘以作为电子通量的总漏极电流 $I_{d}$。\n\n因此，控制方程为：\n$$ I_{\\mathrm{sub,cont}} = I_{d} \\int_{0}^{L} p_{\\mathrm{sub}}(x)\\,\\alpha(x)\\,dx $$\n代入 $\\alpha(x)$ 和 $p_{\\mathrm{sub}}(x)$ 的完整表达式，我们得到：\n$$ I_{\\mathrm{sub,cont}} = I_{d} \\int_{0}^{L} \\left[ \\min\\left(1, p_{0} e^{-\\frac{L - x}{L_{\\mathrm{sub}}}}\\right) \\cdot A \\exp\\left(-\\frac{B}{E_{\\mathrm{peak}}} e^{\\frac{L-x}{\\lambda_{E}}}\\right) \\right] dx $$\n这个定积分很复杂，没有简单的解析解。因此，将使用数值积分（quadrature）算法进行计算，该算法能提供高精度的近似值。\n\n**$I_{\\mathrm{sub,MC}}$ 的蒙特卡洛模型**\n\n蒙特卡洛模型通过模拟大量单个电子 ($N_e$) 的物理过程，提供了衬底电流的随机估计。沿路径 $[0, L]$ 发生的碰撞电离事件是一个随机过程，必须建模为具有空间变化强度（速率）函数 $\\lambda(x) = \\alpha(x)$ 的非均匀泊松点过程。\n\n该模拟将使用稀疏法（或接受-拒绝法）实现，详述如下：\n$1$. **确定主导速率**：首先，我们找到强度函数在区间 $[0, L]$ 上的最大值 $\\alpha_{\\max}$。函数 $\\alpha(x)$ 随 $E(x)$ 单调递增，而 $E(x)$ 随 $x$ 单调递增。因此，最大值出现在 $x=L$ 处：\n$$ \\alpha_{\\max} = \\max_{x \\in [0,L]} \\alpha(x) = \\alpha(E_{\\mathrm{peak}}) = A \\exp\\left(-\\frac{B}{E_{\\mathrm{peak}}}\\right) $$\n$2$. **为每个电子进行模拟**：对于模拟的 $N_e$ 个电子中的每一个：\n    a. 一个速率恒为 $\\alpha_{\\max}$ 的均匀泊松过程在长度 $L$ 上平均会产生 $\\Lambda = \\alpha_{\\max} L$ 个事件。我们从均值为 $\\Lambda$ 的泊松分布中抽取当前电子的*潜在*电离事件数 $k$：$k \\sim \\mathrm{Poisson}(\\Lambda)$。\n    b. 对于这 $k$ 个潜在事件中的每一个，我们在 $[0, L]$ 内随机均匀地生成一个候选位置 $x_i$。\n    c. 我们对这组候选事件进行“稀疏”处理。每个位于 $x_i$ 的候选事件被接受的概率等于真实速率与最大速率之比：$p_{\\mathrm{accept}}(x_i) = \\frac{\\alpha(x_i)}{\\alpha_{\\max}}$。这通过抽取一个均匀随机数 $u_i \\in [0, 1)$ 并当 $u_i  p_{\\mathrm{accept}}(x_i)$ 时接受该事件来实现。\n    d. 对于每个被接受的事件位置 $x_{\\mathrm{acc}}$，我们计算其对收集空穴的贡献，即 $p_{\\mathrm{sub}}(x_{\\mathrm{acc}})$。\n$3$. **汇总结果**：收集到的总空穴数 $N_{\\mathrm{holes, total}}$ 是在所有 $N_e$ 个模拟电子中，所有被接受事件的 $p_{\\mathrm{sub}}(x_{\\mathrm{acc}})$ 值的总和。\n$4$. **计算平均值和电流**：每个穿行电子平均收集到的空穴数估计为 $\\langle p_{\\mathrm{coll}} \\rangle = \\frac{N_{\\mathrm{holes, total}}}{N_e}$。然后，衬底电流的蒙特卡洛估计值为：\n$$ I_{\\mathrm{sub,MC}} = I_d \\cdot \\langle p_{\\mathrm{coll}} \\rangle $$\n为确保随机结果的可复现性，在实现中使用了固定的随机种子。对于每个指定的测试用例，都将计算 $I_{\\mathrm{sub,cont}}$ 和 $I_{\\mathrm{sub,MC}}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Set a fixed random seed for reproducibility of the Monte Carlo simulation.\nnp.random.seed(42)\n\ndef solve():\n    \"\"\"\n    Main function to solve for substrate current using both continuum and\n    Monte Carlo models for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: moderate high field, short channel\n        {\n            \"L\": 2.0e-7, \"E_peak\": 8.0e7, \"lambda_E\": 3.0e-8,\n            \"A\": 7.0e7, \"B\": 1.23e8, \"p0\": 0.6, \"L_sub\": 2.0e-8,\n            \"Id\": 1.0e-3, \"Ne\": 80000\n        },\n        # Case 2: lower field edge case\n        {\n            \"L\": 2.0e-7, \"E_peak\": 2.0e7, \"lambda_E\": 3.0e-8,\n            \"A\": 7.0e7, \"B\": 1.23e8, \"p0\": 0.5, \"L_sub\": 2.0e-8,\n            \"Id\": 1.0e-3, \"Ne\": 80000\n        },\n        # Case 3: near-breakdown high field, shorter channel\n        {\n            \"L\": 1.5e-7, \"E_peak\": 1.5e8, \"lambda_E\": 1.0e-8,\n            \"A\": 7.0e7, \"B\": 1.23e8, \"p0\": 0.9, \"L_sub\": 1.5e-8,\n            \"Id\": 2.0e-3, \"Ne\": 80000\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        # Unpack parameters for clarity\n        L, E_peak, lambda_E = params[\"L\"], params[\"E_peak\"], params[\"lambda_E\"]\n        A, B = params[\"A\"], params[\"B\"]\n        p0, L_sub = params[\"p0\"], params[\"L_sub\"]\n        Id, Ne = params[\"Id\"], params[\"Ne\"]\n\n        # --- Define the physical functions ---\n        # Electric field E(x)\n        def E_field(x):\n            return E_peak * np.exp(-(L - x) / lambda_E)\n\n        # Impact ionization coefficient alpha(E)\n        def alpha(E):\n            # Using np.abs(E) for generality, though E is positive here\n            return A * np.exp(-B / np.abs(E))\n\n        # Composite function alpha(x) = alpha(E(x))\n        def alpha_x(x):\n            return alpha(E_field(x))\n\n        # Substrate collection efficiency p_sub(x)\n        def p_sub(x):\n            return np.minimum(1.0, p0 * np.exp(-(L - x) / L_sub))\n\n        # --- Continuum Model Calculation ---\n        # Integrand for the continuum model\n        def integrand(x):\n            return p_sub(x) * alpha_x(x)\n        \n        # Perform numerical integration over [0, L]\n        integral_val, _ = quad(integrand, 0, L)\n        I_sub_cont = Id * integral_val\n\n        # --- Monte Carlo Model Calculation ---\n        # Maximum ionization rate for the thinning method\n        alpha_max = alpha(E_peak)\n        \n        # Mean number of potential events in homogeneous Poisson process\n        Lambda = alpha_max * L\n        \n        # Vectorized simulation for efficiency\n        # Generate number of potential events for all electrons at once\n        num_potential_events_per_electron = np.random.poisson(Lambda, size=Ne)\n        total_potential_events = np.sum(num_potential_events_per_electron)\n        \n        total_p_sub_collected = 0.0\n        if total_potential_events > 0:\n            # Generate candidate positions for all potential events\n            x_candidates = np.random.uniform(0, L, size=total_potential_events)\n            \n            # Perform thinning\n            # Generate uniform random numbers for acceptance/rejection\n            u_thinning = np.random.uniform(0, 1, size=total_potential_events)\n            \n            # Acceptance condition\n            alpha_at_candidates = alpha_x(x_candidates)\n            is_accepted = u_thinning  (alpha_at_candidates / alpha_max)\n            \n            # Get positions of accepted events\n            x_accepted = x_candidates[is_accepted]\n            \n            # Sum the collection probabilities at the accepted positions\n            total_p_sub_collected = np.sum(p_sub(x_accepted))\n\n        # Calculate the mean collected holes per electron\n        mean_p_coll = total_p_sub_collected / Ne\n        \n        # Calculate the final MC substrate current\n        I_sub_mc = Id * mean_p_coll\n        \n        results.append([I_sub_mc, I_sub_cont])\n\n    # Print the final results in the specified format\n    print(results)\n\nsolve()\n```"
        }
    ]
}