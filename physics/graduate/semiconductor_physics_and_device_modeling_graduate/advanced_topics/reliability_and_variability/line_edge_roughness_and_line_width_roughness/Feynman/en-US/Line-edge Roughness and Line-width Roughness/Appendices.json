{
    "hands_on_practices": [
        {
            "introduction": "To effectively model device variability, we must first establish the fundamental relationship between the roughness on individual line edges (LER) and the resulting variation in the line's width (LWR). This practice guides you through a first-principles derivation that connects the variance of the line width, $\\sigma_{LWR}^2$, to the variance of the edges, $\\sigma_{LER}^2$, revealing the critical role of the correlation coefficient $\\rho$ between the two edges. Mastering this relationship is the first step toward building more complex roughness models. ",
            "id": "3757638",
            "problem": "In a lithographically defined line on a semiconductor wafer, model the lateral deviations of the left and right edge positions from their nominal locations at a fixed longitudinal coordinate as random variables $x_{L}$ and $x_{R}$ with zero mean. The line-edge roughness (LER) on each edge is defined as the standard deviation of the corresponding edge displacement, so that $\\sigma_{L} = \\sqrt{\\operatorname{Var}(x_{L})}$ and $\\sigma_{R} = \\sqrt{\\operatorname{Var}(x_{R})}$. The instantaneous line width deviation from its nominal value at that coordinate is given by $w = x_{R} - x_{L}$, and the line-width roughness (LWR) is defined as $\\sigma_{LWR} = \\sqrt{\\operatorname{Var}(w)}$. The statistical dependence between the two edges is characterized by the (dimensionless) Pearson correlation coefficient $\\rho = \\operatorname{Cov}(x_{L}, x_{R})/(\\sigma_{L}\\sigma_{R})$, where $|\\rho| \\leq 1$.\n\nStarting only from the definitions of variance, covariance, and correlation, and without assuming any specific distribution beyond finite second moments, derive an analytic expression for the ratio $r = \\sigma_{LWR}/\\sigma_{LER}$ in the special case where $\\sigma_{L} = \\sigma_{R} = \\sigma_{LER}$. Then evaluate $r$ for $\\rho = 0.85$.\n\nExpress your final answer as a pure number (dimensionless) and round to four significant figures.",
            "solution": "We are asked to relate the line-width roughness $\\sigma_{LWR}$ to the line-edge roughness $\\sigma_{LER}$ when both edges have the same standard deviation and are correlated with coefficient $\\rho$. The base concepts are the definitions of variance, covariance, and correlation for random variables with finite second moments.\n\nBy definition, the line width deviation is $w = x_{R} - x_{L}$. The variance of a linear combination of random variables is given by\n$$\n\\operatorname{Var}(aX + bY) = a^{2}\\operatorname{Var}(X) + b^{2}\\operatorname{Var}(Y) + 2ab\\,\\operatorname{Cov}(X,Y),\n$$\nfor real constants $a$ and $b$. Applying this to $w = 1\\cdot x_{R} + (-1)\\cdot x_{L}$ yields\n$$\n\\operatorname{Var}(w) = \\operatorname{Var}(x_{R}) + \\operatorname{Var}(x_{L}) - 2\\,\\operatorname{Cov}(x_{L}, x_{R}).\n$$\nLet $\\sigma_{R}^{2} = \\operatorname{Var}(x_{R})$ and $\\sigma_{L}^{2} = \\operatorname{Var}(x_{L})$. The covariance can be written in terms of the correlation coefficient as\n$$\n\\operatorname{Cov}(x_{L}, x_{R}) = \\rho\\,\\sigma_{L}\\,\\sigma_{R}.\n$$\nTherefore,\n$$\n\\operatorname{Var}(w) = \\sigma_{R}^{2} + \\sigma_{L}^{2} - 2\\rho\\,\\sigma_{L}\\,\\sigma_{R}.\n$$\nIn the special case $\\sigma_{L} = \\sigma_{R} = \\sigma_{LER}$, this simplifies to\n$$\n\\operatorname{Var}(w) = \\sigma_{LER}^{2} + \\sigma_{LER}^{2} - 2\\rho\\,\\sigma_{LER}\\,\\sigma_{LER} = 2\\sigma_{LER}^{2}(1 - \\rho).\n$$\nTaking the square root gives the line-width roughness\n$$\n\\sigma_{LWR} = \\sqrt{\\operatorname{Var}(w)} = \\sqrt{2\\sigma_{LER}^{2}(1 - \\rho)} = \\sigma_{LER}\\sqrt{2(1 - \\rho)}.\n$$\nThus, the ratio $r$ of the line-width roughness to the line-edge roughness is\n$$\nr = \\frac{\\sigma_{LWR}}{\\sigma_{LER}} = \\sqrt{2(1 - \\rho)}.\n$$\nNow evaluate this expression for $\\rho = 0.85$:\n$$\nr = \\sqrt{2(1 - 0.85)} = \\sqrt{2 \\times 0.15} = \\sqrt{0.30}.\n$$\nNumerically,\n$$\nr = \\sqrt{0.30} \\approx 0.5477225575\\ldots\n$$\nRounded to four significant figures,\n$$\nr \\approx 0.5477.\n$$\nSince $r$ is a ratio of standard deviations, it is dimensionless, and the requested form is a pure number rounded to four significant figures.",
            "answer": "$$\\boxed{0.5477}$$"
        },
        {
            "introduction": "While overall variance is a useful single-number metric, a complete picture of roughness requires analyzing its characteristics across different spatial frequencies, which is captured by the Power Spectral Density (PSD). This exercise demonstrates how to work with analytical models of the PSD to compute integral properties like the total line-width roughness variance, $\\sigma_{LWR}^2$, and the effective correlation length, $\\ell_{\\mathrm{eff}}$. This practice deepens your understanding of the Wiener–Khinchin theorem and its application to roughness characterization. ",
            "id": "3757608",
            "problem": "A lithographically patterned line in a Silicon-on-Insulator (SOI) process exhibits stochastic edge roughness. Let the left edge be described by a stationary random process with spatial coordinate $x$ and autocorrelation function $C_{L}(x)$, and similarly the right edge by $C_{R}(x)$. The line width $W(x)$ is defined as the difference between right and left edges, so $W(x)=R(x)-L(x)$. The Line-Edge Roughness (LER) of each edge and the Line-Width Roughness (LWR) of $W(x)$ are characterized by their Power Spectral Densities (PSDs), defined via the Wiener–Khinchin theorem: if $C_{Y}(x)$ is the autocorrelation of a stationary process $Y(x)$, then its PSD $S_{Y}(k)$ is the Fourier transform $S_{Y}(k)=\\int_{-\\infty}^{\\infty} C_{Y}(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$, and conversely $C_{Y}(x)=(1/2\\pi)\\int_{-\\infty}^{\\infty} S_{Y}(k)\\,\\exp(\\mathrm{i} k x)\\,dk$. The variance of $Y(x)$ is $C_{Y}(0)=(1/2\\pi)\\int_{-\\infty}^{\\infty} S_{Y}(k)\\,dk$.\n\nAssume both edges are statistically identical and jointly stationary so that $S_{L}(k)=S_{R}(k)$, and let the cross-PSD $S_{LR}(k)$ be defined as the Fourier transform of the cross-correlation $C_{LR}(x)$. The PSD of the width process $W(x)$ is $S_{W}(k)=S_{R}(k)+S_{L}(k)-2 S_{LR}(k)$.\n\nIn a metrology experiment, the measured and model-fitted PSDs over wavenumbers $k$ (in $\\mathrm{nm}^{-1}$) are given for all real $k$ and may be treated as valid over the entire axis ($k_{min}=-\\infty$, $k_{max}=+\\infty$). The fitted forms are even in $k$ and specified as\n$$\nS_{L}(k)=S_{R}(k)=\\sum_{i=1}^{2} \\frac{2 A_{i}\\,\\xi_{i}}{1+(k\\,\\xi_{i})^{2}},\\qquad\nS_{LR}(k)=\\rho\\,\\sum_{i=1}^{2} \\frac{2 A_{i}\\,\\xi_{i}}{1+(k\\,\\xi_{i})^{2}},\n$$\nwith parameters\n$$\nA_{1}=0.28~\\mathrm{nm}^{2},\\quad \\xi_{1}=6~\\mathrm{nm},\\qquad\nA_{2}=0.12~\\mathrm{nm}^{2},\\quad \\xi_{2}=18~\\mathrm{nm},\\qquad\n\\rho=0.63.\n$$\nHere $A_{i}$ are the component amplitudes of the edge autocorrelation at $x=0$ for two independent correlation channels, and $\\xi_{i}$ are their correlation lengths. The scalar $\\rho$ ($0\\leq \\rho \\leq 1$) is a dimensionless edge-to-edge correlation coefficient that scales the cross-PSD congruent with $S_{L}(k)$ and $S_{R}(k)$.\n\nTasks:\n1. Using the Wiener–Khinchin relations and the above PSDs, derive from first principles and then compute the Line-Width Roughness variance $\\sigma_{LWR}^{2}=C_{W}(0)$ of the width process $W(x)$. Express your final numerical value in $\\mathrm{nm}^{2}$.\n2. Define the effective width correlation length $\\ell_{\\mathrm{eff}}$ as the area under the normalized autocorrelation of $W(x)$,\n$$\n\\ell_{\\mathrm{eff}}=\\int_{0}^{\\infty} \\frac{C_{W}(x)}{C_{W}(0)}\\,dx,\n$$\nand compute its value from the given PSDs. Express your final numerical value in $\\mathrm{nm}$.\n\nRound both final numerical results to four significant figures. Report your answers in the order $\\sigma_{LWR}^{2}$ (in $\\mathrm{nm}^{2}$), then $\\ell_{\\mathrm{eff}}$ (in $\\mathrm{nm}$).",
            "solution": "The problem asks for the calculation of the line-width roughness variance, $\\sigma_{LWR}^{2}$, and the effective width correlation length, $\\ell_{\\mathrm{eff}}$, based on provided Power Spectral Density (PSD) models for the line edges.\n\n**Part 1: Calculation of Line-Width Roughness Variance ($\\sigma_{LWR}^{2}$)**\n\nThe variance of the line width process, $W(x)$, is denoted as $\\sigma_{LWR}^{2}$ and is equal to its autocorrelation function evaluated at zero lag, $C_{W}(0)$. According to the Wiener–Khinchin theorem, the autocorrelation function is the inverse Fourier transform of the PSD. Specifically, the variance can be computed by integrating the PSD over all wavenumbers $k$:\n$$\n\\sigma_{LWR}^{2} = C_{W}(0) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{W}(k)\\,dk\n$$\nThe problem provides the relationship between the PSD of the width, $S_{W}(k)$, and the PSDs of the individual edges:\n$$\nS_{W}(k) = S_{R}(k) + S_{L}(k) - 2 S_{LR}(k)\n$$\nWe are given that the edges are statistically identical, so $S_{L}(k) = S_{R}(k)$. We are also given that the cross-PSD is a scaled version of the edge PSD: $S_{LR}(k) = \\rho S_{L}(k)$. Substituting these into the expression for $S_{W}(k)$ yields:\n$$\nS_{W}(k) = S_{L}(k) + S_{L}(k) - 2 \\rho S_{L}(k) = 2 S_{L}(k) (1-\\rho)\n$$\nNow, we can substitute this simplified expression for $S_{W}(k)$ into the integral for the variance:\n$$\n\\sigma_{LWR}^{2} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} 2(1-\\rho) S_{L}(k)\\,dk = \\frac{1-\\rho}{\\pi} \\int_{-\\infty}^{\\infty} S_{L}(k)\\,dk\n$$\nThe PSD for a single edge, $S_{L}(k)$, is given as a sum of two Lorentzian-like components:\n$$\nS_{L}(k) = \\sum_{i=1}^{2} \\frac{2 A_{i}\\,\\xi_{i}}{1+(k\\,\\xi_{i})^{2}}\n$$\nWe can substitute this into the integral and exchange the order of integration and summation:\n$$\n\\sigma_{LWR}^{2} = \\frac{1-\\rho}{\\pi} \\sum_{i=1}^{2} \\int_{-\\infty}^{\\infty} \\frac{2 A_{i}\\,\\xi_{i}}{1+(k\\,\\xi_{i})^{2}}\\,dk\n$$\nLet's evaluate the integral for a single component $i$:\n$$\nI_{i} = \\int_{-\\infty}^{\\infty} \\frac{2 A_{i}\\,\\xi_{i}}{1+(k\\,\\xi_{i})^{2}}\\,dk\n$$\nLet $u = k\\xi_{i}$, which implies $dk = du/\\xi_{i}$. The limits of integration remain from $-\\infty$ to $\\infty$.\n$$\nI_{i} = \\int_{-\\infty}^{\\infty} \\frac{2 A_{i}\\,\\xi_{i}}{1+u^{2}}\\,\\frac{du}{\\xi_{i}} = 2 A_{i} \\int_{-\\infty}^{\\infty} \\frac{1}{1+u^{2}}\\,du\n$$\nThe integral of $\\frac{1}{1+u^{2}}$ is $\\arctan(u)$.\n$$\nI_{i} = 2 A_{i} \\left[ \\arctan(u) \\right]_{-\\infty}^{\\infty} = 2 A_{i} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = 2 A_{i} \\pi\n$$\nSubstituting this result back into the expression for $\\sigma_{LWR}^{2}$:\n$$\n\\sigma_{LWR}^{2} = \\frac{1-\\rho}{\\pi} \\sum_{i=1}^{2} (2 A_{i} \\pi) = 2(1-\\rho) \\sum_{i=1}^{2} A_{i} = 2(1-\\rho)(A_{1}+A_{2})\n$$\nThis expression provides the line-width roughness variance in terms of the given parameters. Now, we substitute the numerical values:\n$A_{1}=0.28~\\mathrm{nm}^{2}$, $A_{2}=0.12~\\mathrm{nm}^{2}$, and $\\rho=0.63$.\n$$\n\\sigma_{LWR}^{2} = 2(1 - 0.63)(0.28 + 0.12) = 2(0.37)(0.40) = 0.296~\\mathrm{nm}^{2}\n$$\nRounding to four significant figures, we get $\\sigma_{LWR}^{2} = 0.2960~\\mathrm{nm}^{2}$.\n\n**Part 2: Calculation of Effective Width Correlation Length ($\\ell_{\\mathrm{eff}}$)**\n\nThe effective width correlation length is defined as:\n$$\n\\ell_{\\mathrm{eff}} = \\int_{0}^{\\infty} \\frac{C_{W}(x)}{C_{W}(0)}\\,dx\n$$\nWe can derive a more direct path to this value using the properties of the Fourier transform. The PSD is the Fourier transform of the autocorrelation function: $S_{W}(k) = \\int_{-\\infty}^{\\infty} C_{W}(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$. Evaluating this at $k=0$ gives:\n$$\nS_{W}(0) = \\int_{-\\infty}^{\\infty} C_{W}(x)\\,dx\n$$\nThe problem states that the fitted PSDs are even functions of $k$. The inverse Fourier transform of a real and even function is also real and even. Therefore, $C_{W}(x)$ must be an even function, i.e., $C_{W}(x) = C_{W}(-x)$. This allows us to write the integral over the entire real axis as twice the integral over the positive half-axis:\n$$\nS_{W}(0) = 2 \\int_{0}^{\\infty} C_{W}(x)\\,dx\n$$\nRearranging this gives an expression for the integral in the definition of $\\ell_{\\mathrm{eff}}$:\n$$\n\\int_{0}^{\\infty} C_{W}(x)\\,dx = \\frac{1}{2} S_{W}(0)\n$$\nSubstituting this into the definition of $\\ell_{\\mathrm{eff}}$:\n$$\n\\ell_{\\mathrm{eff}} = \\frac{\\frac{1}{2} S_{W}(0)}{C_{W}(0)}\n$$\nWe have already calculated the denominator $C_{W}(0) = \\sigma_{LWR}^{2} = 2(1-\\rho)(A_{1}+A_{2})$.\nWe now need to find the numerator, $S_{W}(0)$. We use the expression $S_{W}(k) = 2(1-\\rho)S_{L}(k)$ and evaluate it at $k=0$:\n$$\nS_{W}(0) = 2(1-\\rho) S_{L}(0)\n$$\nFrom the given functional form of $S_{L}(k)$:\n$$\nS_{L}(0) = \\sum_{i=1}^{2} \\frac{2 A_{i}\\,\\xi_{i}}{1+(0 \\cdot \\xi_{i})^{2}} = \\sum_{i=1}^{2} 2 A_{i}\\,\\xi_{i} = 2(A_{1}\\xi_{1} + A_{2}\\xi_{2})\n$$\nSo, $S_{W}(0) = 2(1-\\rho) \\cdot 2(A_{1}\\xi_{1} + A_{2}\\xi_{2}) = 4(1-\\rho)(A_{1}\\xi_{1} + A_{2}\\xi_{2})$.\nNow, we substitute the expressions for $S_{W}(0)$ and $C_{W}(0)$ into the formula for $\\ell_{\\mathrm{eff}}$:\n$$\n\\ell_{\\mathrm{eff}} = \\frac{\\frac{1}{2} \\left[ 4(1-\\rho)(A_{1}\\xi_{1} + A_{2}\\xi_{2}) \\right]}{2(1-\\rho)(A_{1}+A_{2})} = \\frac{2(1-\\rho)(A_{1}\\xi_{1} + A_{2}\\xi_{2})}{2(1-\\rho)(A_{1}+A_{2})} = \\frac{A_{1}\\xi_{1} + A_{2}\\xi_{2}}{A_{1}+A_{2}}\n$$\nThis result shows that the effective correlation length is a weighted average of the individual component correlation lengths, where the weights are their respective amplitudes $A_{i}$. We proceed with the numerical calculation using the given values:\n$A_{1}=0.28~\\mathrm{nm}^{2}$, $\\xi_{1}=6~\\mathrm{nm}$, $A_{2}=0.12~\\mathrm{nm}^{2}$, $\\xi_{2}=18~\\mathrm{nm}$.\n$$\nA_{1}\\xi_{1} = (0.28)(6) = 1.68~\\mathrm{nm}^{3}\n$$\n$$\nA_{2}\\xi_{2} = (0.12)(18) = 2.16~\\mathrm{nm}^{3}\n$$\n$$\nA_{1}+A_{2} = 0.28 + 0.12 = 0.40~\\mathrm{nm}^{2}\n$$\n$$\n\\ell_{\\mathrm{eff}} = \\frac{1.68 + 2.16}{0.40} = \\frac{3.84}{0.40} = 9.6~\\mathrm{nm}\n$$\nRounding to four significant figures, we get $\\ell_{\\mathrm{eff}} = 9.600~\\mathrm{nm}$.\n\nThe final results are $\\sigma_{LWR}^{2} = 0.2960~\\mathrm{nm}^{2}$ and $\\ell_{\\mathrm{eff}} = 9.600~\\mathrm{nm}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.2960 & 9.600 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The truest test of a physical model is its ability to generate realistic phenomena, not just describe them. This computational practice challenges you to bridge the gap between theory and simulation by synthesizing a stochastic line-edge profile that conforms to a target Power Spectral Density (PSD). By constructing a rough edge in the frequency domain using random phases and then transforming it back to the spatial domain via an inverse FFT, you will gain a profound, hands-on intuition for how a spectral description translates into a physical morphology. ",
            "id": "3757646",
            "problem": "Implement a program that synthesizes one-dimensional line-edge roughness profiles and verifies power spectral density (PSD) conformity using first principles of Fourier analysis and the Wiener–Khinchin theorem. The synthesized edge displacement is denoted by $x(y)$, where $y$ is the coordinate along the line direction. The program must construct $x(y)$ on a finite domain using the inverse discrete Fourier transform of random-phase complex amplitudes with a magnitude set by a prescribed PSD shape.\n\nFundamental base:\n- The autocorrelation function $R(\\Delta y)$ of a stationary process and its Power Spectral Density (PSD), denoted $S(f)$, form a Fourier transform pair under the kernel $\\exp\\!\\left(i 2\\pi f \\Delta y\\right)$ in the cycles-per-unit convention. Specifically,\n$$\nR(\\Delta y) = \\int_{-\\infty}^{\\infty} S(f)\\, e^{i 2\\pi f \\Delta y}\\, df\n$$\nand the mean-square roughness satisfies\n$$\n\\sigma^2 = R(0) = \\int_{-\\infty}^{\\infty} S(f)\\, df.\n$$\n- On a finite interval of length $L$ discretized into $N$ samples at spacing $\\Delta y = L/N$, the discrete frequencies are $f_k = \\frac{k}{N \\Delta y}$ for integer $k$, and the discrete Fourier transform approximates the continuous transform via the rectangular rule. If $\\widehat{X}(f_k)$ denotes the continuous-frequency transform sampled on the grid, it is related to the discrete transform $X_{\\mathrm{dft}}[k]$ returned by a Fast Fourier Transform (FFT) implementation by\n$$\n\\widehat{X}(f_k) \\approx \\Delta y \\, X_{\\mathrm{dft}}[k].\n$$\n- A consistent finite-record PSD estimator that preserves the integral property is given by\n$$\nS_{\\mathrm{est}}(f_k) = \\frac{1}{L}\\, \\left|\\widehat{X}(f_k)\\right|^2,\n$$\nfor a zero-mean profile. This guarantees\n$$\n\\sum_k S_{\\mathrm{est}}(f_k) \\,\\Delta f \\approx \\frac{1}{L} \\sum_{n=0}^{N-1} x(y_n)^2 \\,\\Delta y,\n$$\nwith $\\Delta f = \\frac{1}{L}$, which approximates the mean-square roughness $\\sigma^2$.\n\nSynthesis directive:\n- To synthesize a real-valued rough edge with a target PSD $S(f)$ sampled at the discrete frequency grid $f_k$, construct random phases $\\phi_k$ independently drawn from a uniform distribution on $[0,2\\pi)$ for the strictly positive-frequency bins and enforce Hermitian symmetry for negative-frequency bins to ensure a real inverse transform. Define the continuous-frequency amplitudes by\n$$\n\\widehat{X}(f_k) = \\sqrt{L\\, S(f_k)}\\, e^{i \\phi_k}\n$$\nfor the positive-frequency bins, set the direct current component $k=0$ to zero to enforce zero mean, handle the Nyquist bin appropriately for even $N$ (set to zero), and use conjugate symmetry $\\widehat{X}(f_{-k}) = \\widehat{X}(f_k)^\\ast$ for negative-frequency bins. Map to the discrete transform by $X_{\\mathrm{dft}}[k] = \\widehat{X}(f_k)/\\Delta y$, then obtain $x(y_n)$ via inverse FFT.\n\nTarget PSD families in cycles-per-nanometer:\n1. Gaussian-shaped PSD:\n$$\nS_{\\mathrm{G}}(f; \\sigma, \\alpha) = \\frac{\\sigma^2}{\\sqrt{\\pi}\\, \\alpha} \\exp\\!\\left(-\\left(\\frac{f}{\\alpha}\\right)^2\\right),\n$$\nwhere $\\sigma$ is the desired root-mean-square roughness in nanometers, and $\\alpha$ is a width parameter in cycles per nanometer, chosen so that $\\int_{-\\infty}^{\\infty} S_{\\mathrm{G}}(f)\\, df = \\sigma^2$.\n2. Lorentzian-shaped PSD:\n$$\nS_{\\mathrm{L}}(f; \\sigma, \\alpha) = \\sigma^2 \\frac{\\alpha}{\\pi} \\frac{1}{f^2 + \\alpha^2},\n$$\nwith $\\alpha$ in cycles per nanometer, satisfying $\\int_{-\\infty}^{\\infty} S_{\\mathrm{L}}(f)\\, df = \\sigma^2$.\n3. Band-limited white PSD:\n$$\nS_{\\mathrm{W}}(f; \\sigma, f_c) = \n\\begin{cases}\n\\dfrac{\\sigma^2}{2 f_c}, & |f| \\le f_c,\\\\[6pt]\n0, & |f| > f_c,\n\\end{cases}\n$$\nwhere $f_c$ is the cutoff in cycles per nanometer, ensuring $\\int_{-\\infty}^{\\infty} S_{\\mathrm{W}}(f)\\, df = \\sigma^2$.\n\nVerification tasks:\n- Compute and report the relative $\\ell_2$ error between the target PSD $S(f_k)$ and the estimated PSD $S_{\\mathrm{est}}(f_k)$ on the full discrete frequency grid (including negative frequencies). The relative $\\ell_2$ error is defined as\n$$\n\\varepsilon_{\\mathrm{PSD}} = \\frac{\\left\\| S_{\\mathrm{est}} - S \\right\\|_2}{\\left\\| S \\right\\|_2},\n$$\nusing the Euclidean norm over discrete bins.\n- Independently estimate the root-mean-square roughness $\\sigma_{\\mathrm{est}}$ from the synthesized profile via\n$$\n\\sigma_{\\mathrm{est}} = \\sqrt{\\frac{1}{N}\\sum_{n=0}^{N-1} x(y_n)^2}.\n$$\n- A test case passes if both $\\varepsilon_{\\mathrm{PSD}} \\le 0.25$ and $\\left| \\sigma_{\\mathrm{est}} - \\sigma \\right| / \\sigma \\le 0.10$.\n\nUnits and conventions:\n- Use $y$ in nanometers, $x(y)$ in nanometers, discrete frequency $f$ in cycles per nanometer, and PSD $S(f)$ in nanometers squared per (cycles per nanometer). All reported booleans are unitless.\n- Angles (phases) are dimensionless; when sampling phases, the uniform distribution range is in radians.\n\nTest suite:\nProvide four test cases to exercise distinct PSD families and parameter regimes. For each case, define ($L$, $N$, family, parameters), where $L$ is the domain length in nanometers and $N$ is the number of samples.\n\n- Case 1 (Gaussian, general case): $L = 8192$ nanometers, $N = 2048$, $\\sigma = 1.0$ nanometers, $\\alpha = 0.030$ cycles per nanometer.\n- Case 2 (Lorentzian, general case): $L = 16384$ nanometers, $N = 4096$, $\\sigma = 1.5$ nanometers, $\\alpha = 0.020$ cycles per nanometer.\n- Case 3 (Band-limited white, boundary for flat spectrum within Nyquist): $L = 4096$ nanometers, $N = 1024$, $\\sigma = 0.8$ nanometers, $f_c = 0.080$ cycles per nanometer.\n- Case 4 (Gaussian, long correlation length edge case with narrow bandwidth): $L = 65536$ nanometers, $N = 4096$, $\\sigma = 2.0$ nanometers, $\\alpha = 0.005$ cycles per nanometer.\n\nProgram requirements:\n- Implement synthesis of $x(y)$ via inverse FFT as specified above, using random phases with Hermitian symmetry and setting the direct current and Nyquist bins to zero.\n- Compute the estimated PSD using the relationship $S_{\\mathrm{est}}(f_k) = \\frac{1}{L} \\left| \\Delta y \\cdot X_{\\mathrm{dft}}[k] \\right|^2$.\n- For each test case, output a boolean indicating whether both verification criteria are satisfied.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\").",
            "solution": "The problem requires the synthesis of one-dimensional line-edge roughness profiles, $x(y)$, conforming to a specified Power Spectral Density (PSD), $S(f)$, and subsequent verification of the synthesized profile against the target properties. This procedure is grounded in the principles of Fourier analysis and stochastic processes, particularly the Wiener-Khinchin theorem, which establishes that the PSD and the autocorrelation function of a stationary random process are a Fourier transform pair. The synthesis is conducted in the frequency domain, followed by an inverse Fourier transform to obtain the spatial profile.\n\nFirst, we establish the discrete domain for our computation. The continuous spatial coordinate $y$ along a line of length $L$ is discretized into $N$ samples, yielding a sampling interval of $\\Delta y = L/N$. This spatial discretization defines a corresponding grid of discrete frequencies, $f_k$, which are computed using the `numpy.fft.fftfreq` function as $f_k = k / (N \\Delta y)$, arranged in an order suitable for Fast Fourier Transform (FFT) algorithms. The frequency resolution is $\\Delta f = 1/L$.\n\nFor each test case, a target PSD model is specified: Gaussian $S_{\\mathrm{G}}(f)$, Lorentzian $S_{\\mathrm{L}}(f)$, or band-limited white $S_{\\mathrm{W}}(f)$. These continuous functions are evaluated on the discrete frequency grid $f_k$ to produce the target discrete PSD, which we denote $S[k] = S(f_k)$. The analytical forms of these PSDs are correctly normalized such that their integral over all frequencies equals the specified mean-square roughness, $\\sigma^2$, i.e., $\\int_{-\\infty}^{\\infty} S(f) df = \\sigma^2$.\n\nThe core of the synthesis method is the construction of the signal's Fourier transform, $\\widehat{X}(f_k)$, from the target PSD. The relationship between the PSD and the Fourier transform magnitude for a finite-length signal is given by $|\\widehat{X}(f_k)|^2 \\approx L S(f_k)$. To generate a specific random instance of the profile, we pair these deterministic magnitudes with random phases, $\\phi_k$, drawn from a uniform distribution over $[0, 2\\pi)$. The complex Fourier amplitude is thus constructed as $\\widehat{X}(f_k) = \\sqrt{L S(f_k)} e^{i\\phi_k}$.\n\nSeveral constraints must be enforced during the construction of $\\widehat{X}(f_k)$ to ensure the resulting spatial profile $x(y)$ has the desired physical properties:\n1.  **Real-valued Profile**: For $x(y)$ to be a real-valued function, its Fourier transform must exhibit Hermitian symmetry: $\\widehat{X}(-f) = \\widehat{X}(f)^*$. In our discrete framework, this translates to $\\widehat{X}[-k] = \\widehat{X}[k]^*$. We implement this by first generating amplitudes for the positive frequency components ($k=1, \\dots, N/2 - 1$) with random phases, and then setting the corresponding negative frequency components to their complex conjugates.\n2.  **Zero Mean**: A zero-mean profile, $\\langle x(y) \\rangle = 0$, requires the DC component ($k=0$) of the Fourier transform to be zero. Thus, we set $\\widehat{X}(f_0=0) = 0$.\n3.  **Nyquist Component**: As per the directive for an even number of samples $N$, the Nyquist frequency component ($k=N/2$) is also set to zero.\n\nOnce the array of complex amplitudes $\\widehat{X}(f_k)$ is fully constructed, it is scaled to the discrete Fourier transform (DFT) representation, $X_{\\mathrm{dft}}[k]$, as used by standard FFT libraries: $X_{\\mathrm{dft}}[k] = \\widehat{X}(f_k) / \\Delta y$. The spatial profile $x(y_n)$ is then obtained by applying the inverse FFT to $X_{\\mathrm{dft}}[k]$. Due to the enforced Hermitian symmetry, the imaginary part of the resulting profile is zero to within machine precision, and we take the real part to get our final profile $x(y_n)$.\n\nThe synthesized profile is then subjected to two verification tests:\n1.  **RMS Roughness Verification**: The RMS roughness of the generated profile is estimated directly from the spatial data using $\\sigma_{\\mathrm{est}} = \\sqrt{\\frac{1}{N}\\sum_{n=0}^{N-1} x(y_n)^2}$. Since the profile has zero mean, this is equivalent to its standard deviation. The relative error, $|\\sigma_{\\mathrm{est}} - \\sigma|/\\sigma$, is then compared against the tolerance of $0.10$. By Parseval's theorem and the relation $\\sigma^2 \\approx \\sum_k S(f_k)\\Delta f$, this error is expected to be small, primarily reflecting the error in approximating the continuous integral with a discrete sum.\n2.  **PSD Conformity Verification**: To confirm that the profile has the intended spectral content, we calculate its estimated PSD, $S_{\\mathrm{est}}(f_k)$. This is done by taking the FFT of the generated profile $x(y_n)$ to find $X_{\\mathrm{dft, est}}[k]$, and then applying the estimator formula from the problem statement: $S_{\\mathrm{est}}(f_k) = \\frac{1}{L} |\\Delta y \\cdot X_{\\mathrm{dft, est}}[k]|^2$. The conformity is quantified by the relative $\\ell_2$ error, $\\varepsilon_{\\mathrm{PSD}} = \\| S_{\\mathrm{est}} - S \\|_2 / \\| S \\|_2$, which must be less than or equal to $0.25$. Since the estimation process is numerically the inverse of the synthesis process, this error is expected to be very close to zero, limited only by floating-point precision.\n\nA test case is considered successful if and only if both verification criteria are met. The implementation is realized in Python using the `numpy` library, which provides robust functions for FFT operations, array manipulation, and random number generation. A fixed random seed is used to ensure the reproducibility of the results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for line-edge roughness synthesis and verification.\n    \"\"\"\n    # Use a fixed random seed for reproducible results.\n    np.random.seed(42)\n\n    def S_gaussian(f, sigma, alpha):\n        \"\"\"Calculates the Gaussian-shaped Power Spectral Density (PSD).\"\"\"\n        if alpha == 0:\n            # Avoid division by zero, though not expected in test cases.\n            return np.full_like(f, np.inf)\n        norm = sigma**2 / (np.sqrt(np.pi) * alpha)\n        return norm * np.exp(-(f / alpha)**2)\n\n    def S_lorentzian(f, sigma, alpha):\n        \"\"\"Calculates the Lorentzian-shaped Power Spectral Density (PSD).\"\"\"\n        if alpha == 0:\n            return np.full_like(f, np.inf)\n        norm = sigma**2 * alpha / np.pi\n        return norm / (f**2 + alpha**2)\n\n    def S_band_limited_white(f, sigma, f_c):\n        \"\"\"Calculates the band-limited white noise Power Spectral Density (PSD).\"\"\"\n        if f_c == 0:\n            return np.zeros_like(f)\n        val = sigma**2 / (2 * f_c)\n        return np.where(np.abs(f) <= f_c, val, 0.0)\n\n    def run_synthesis_and_verification(L, N, family, params):\n        \"\"\"\n        Synthesizes a roughness profile for one case and verifies its properties.\n\n        Args:\n            L (float): Domain length in nanometers.\n            N (int): Number of samples.\n            family (str): The PSD family ('gaussian', 'lorentzian', 'white').\n            params (tuple): Parameters for the PSD model.\n\n        Returns:\n            bool: True if both verification criteria are met, False otherwise.\n        \"\"\"\n        # Step 1: Unpack parameters and set up discretization\n        if family == 'gaussian':\n            sigma, alpha = params\n        elif family == 'lorentzian':\n            sigma, alpha = params\n        else:  # family == 'white'\n            sigma, f_c = params\n\n        Delta_y = L / float(N)\n\n        # Step 2: Generate frequency grid\n        f_k = np.fft.fftfreq(N, d=Delta_y)\n\n        # Step 3: Calculate target PSD on the discrete frequency grid\n        if family == 'gaussian':\n            S_target = S_gaussian(f_k, sigma, alpha)\n        elif family == 'lorentzian':\n            S_target = S_lorentzian(f_k, sigma, alpha)\n        else:  # family == 'white'\n            S_target = S_band_limited_white(f_k, sigma, f_c)\n\n        # Step 4: Synthesize the profile x(y) in the frequency domain\n        magnitudes = np.sqrt(L * S_target)\n        X_hat = np.zeros(N, dtype=complex)\n\n        # Generate random phases for positive frequencies (k=1 to N/2-1)\n        # N is always even in test cases\n        num_pos_freqs = (N // 2) - 1\n        if num_pos_freqs > 0:\n            phases = np.random.uniform(0, 2 * np.pi, size=num_pos_freqs)\n            pos_freq_indices = np.arange(1, N // 2)\n            X_hat[pos_freq_indices] = magnitudes[pos_freq_indices] * np.exp(1j * phases)\n            \n            # Enforce Hermitian symmetry: X(-f) = conj(X(f))\n            # In fftfreq order, f(-k) is at index N-k\n            X_hat[N - pos_freq_indices] = np.conj(X_hat[pos_freq_indices])\n\n        # DC (k=0) and Nyquist (k=N/2) components are set to zero for zero-mean and as per directive.\n        # This is handled by initializing X_hat to zeros.\n\n        # Scale to discrete transform and perform inverse FFT\n        X_dft = X_hat / Delta_y\n        x_profile = np.real(np.fft.ifft(X_dft))\n\n        # Step 5: Perform verification\n        # a. Estimate RMS roughness\n        sigma_est = np.std(x_profile)\n        \n        # b. Estimate PSD from the synthesized profile\n        X_dft_est = np.fft.fft(x_profile)\n        X_hat_est = Delta_y * X_dft_est\n        S_est = (1.0 / L) * np.abs(X_hat_est)**2\n\n        # c. Calculate errors\n        err_sigma_rel = np.abs(sigma_est - sigma) / sigma\n        \n        norm_S_target = np.linalg.norm(S_target)\n        if norm_S_target > 0:\n            err_psd = np.linalg.norm(S_est - S_target) / norm_S_target\n        else: # Should not happen in these test cases\n            err_psd = np.linalg.norm(S_est)\n\n        # d. Check pass criteria\n        is_passed = (err_psd <= 0.25) and (err_sigma_rel <= 0.10)\n        return is_passed\n\n    test_cases = [\n        {'L': 8192, 'N': 2048, 'family': 'gaussian', 'params': (1.0, 0.030)},\n        {'L': 16384, 'N': 4096, 'family': 'lorentzian', 'params': (1.5, 0.020)},\n        {'L': 4096, 'N': 1024, 'family': 'white', 'params': (0.8, 0.080)},\n        {'L': 65536, 'N': 4096, 'family': 'gaussian', 'params': (2.0, 0.005)}\n    ]\n\n    results = []\n    for case in test_cases:\n        passed = run_synthesis_and_verification(\n            case['L'], case['N'], case['family'], case['params']\n        )\n        results.append(passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}