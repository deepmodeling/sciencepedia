{
    "hands_on_practices": [
        {
            "introduction": "氮化镓（GaN）HEMT器件卓越性能的核心在于由极化效应形成的二维电子气（2DEG）。本练习将引导你深入探究这一现象的物理根源 。你将从第一性原理出发，利用各向异性弹性力学和压电理论，亲手计算由晶格失配引起的应变如何在AlGaN/GaN界面产生压电极化电荷。这项实践旨在让你牢固掌握2DEG形成的基本机制，这是理解和设计所有氮化物半导体器件的基础。",
            "id": "3748405",
            "problem": "考虑一个用于高电子迁移率晶体管 (HEMT) 的 c 轴取向的氮化铝镓 (Al$_x$Ga$_{1-x}$N)/氮化镓 (GaN) 异质结。一个组分为 $x = 0.25$ 的薄 Al$_x$Ga$_{1-x}$N 势垒层在弛豫的 GaN 缓冲层上赝晶生长，使得界面处的面内晶格常数匹配。假设 GaN 缓冲层很厚且完全弛豫（无应变），而 Al$_x$Ga$_{1-x}$N 势垒层是完全应变的。忽略自发极化和任何静电屏蔽效应。在纤锌矿晶体结构的各向异性弹性和压电性的线性范围内进行计算。\n\n仅使用以下数据和第一性原理，计算由 Al$_{0.25}$Ga$_{0.75}$N 势垒层中的应变引起的 Al$_{0.25}$Ga$_{0.75}$N/GaN 界面处的压电束缚面电荷密度。最终答案以 $\\mathrm{C/m^2}$ 为单位表示，并四舍五入到三位有效数字。\n\n材料参数（纤锌矿结构，室温），使用 Vegard 定律对合金进行插值计算：\n- GaN：面内晶格常数 $a_{\\mathrm{GaN}} = 3.189~\\text{\\AA}$，弹性常数 $c_{13,\\mathrm{GaN}} = 106~\\mathrm{GPa}$，$c_{33,\\mathrm{GaN}} = 398~\\mathrm{GPa}$，压电系数 $e_{31,\\mathrm{GaN}} = -0.49~\\mathrm{C/m^2}$，$e_{33,\\mathrm{GaN}} = 0.73~\\mathrm{C/m^2}$。\n- AlN：面内晶格常数 $a_{\\mathrm{AlN}} = 3.112~\\text{\\AA}$，弹性常数 $c_{13,\\mathrm{AlN}} = 108~\\mathrm{GPa}$，$c_{33,\\mathrm{AlN}} = 373~\\mathrm{GPa}$，压电系数 $e_{31,\\mathrm{AlN}} = -0.60~\\mathrm{C/m^2}$，$e_{33,\\mathrm{AlN}} = 1.46~\\mathrm{C/m^2}$。\n\n使用的假设和规则：\n- 对任何材料属性 $X$ 使用 Vegard 定律进行线性插值：$X(x) = x X_{\\mathrm{AlN}} + (1-x) X_{\\mathrm{GaN}}$。\n- Al$_x$Ga$_{1-x}$N 势垒层中的面内双轴应变为 $\\epsilon_{\\parallel} = \\epsilon_{xx} = \\epsilon_{yy} = \\dfrac{a_{\\mathrm{sub}} - a_{\\mathrm{layer}}}{a_{\\mathrm{layer}}}$，其中 $a_{\\mathrm{sub}} = a_{\\mathrm{GaN}}$ 且 $a_{\\mathrm{layer}} = a_{\\mathrm{Al}_x\\mathrm{Ga}_{1-x}\\mathrm{N}}$。\n- 在自由表面处，势垒层中的面外法向应力为零，并且势垒层在界面处与衬底弹性共格。\n- 从适用于六方晶体的通用线性的各向异性弹性和压电本构关系出发，推导所需的应变分量和极化表达式。不要使用任何简化的快捷公式。\n\n计算界面处的压电束缚面电荷密度，其定义为 $\\sigma_{\\mathrm{pe}} = P_{z,\\mathrm{pe}}^{\\mathrm{Al}_x\\mathrm{Ga}_{1-x}\\mathrm{N}} - P_{z,\\mathrm{pe}}^{\\mathrm{GaN}}$，其中 $P_{z,\\mathrm{pe}}$ 是沿 c 轴的压电极化强度。由于 GaN 缓冲层是弛豫的，取 $P_{z,\\mathrm{pe}}^{\\mathrm{GaN}} = 0$。",
            "solution": "该问题要求计算铝摩尔分数为 $x=0.25$ 的 c 面 Al$_x$Ga$_{1-x}$N/GaN 异质结界面处的压电束缚面电荷密度 $\\sigma_{\\mathrm{pe}}$。计算必须从纤锌矿晶体中弹性和压电性的基本本构关系开始。Al$_{0.25}$Ga$_{0.75}$N 势垒层在弛豫的 GaN 缓冲层上赝晶生长，这意味着它处于双轴应变下。GaN 缓冲层无应变。\n\n压电面电荷密度由界面两侧压电极化强度的不连续性给出：\n$$ \\sigma_{\\mathrm{pe}} = P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} - P_{z,\\mathrm{pe}}^{\\mathrm{GaN}} $$\n由于 GaN 缓冲层是弛豫的（无应变），其压电极化强度为零，$P_{z,\\mathrm{pe}}^{\\mathrm{GaN}} = 0$。因此，我们只需要计算应变的 Al$_{0.25}$Ga$_{0.75}$N 层中的压电极化强度，即 $\\sigma_{\\mathrm{pe}} = P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}}$。\n\n该问题涉及沿 c 轴（z 方向）生长的纤锌矿（六方晶系，6mm 点群）晶体。应力 ($\\sigma$) 和压电极化强度 ($P$) 关于应变 ($\\epsilon$) 的本构关系由以下公式给出：\n$$ \\sigma_{ij} = \\sum_{k,l} c_{ijkl} \\epsilon_{kl} $$\n$$ P_i = \\sum_{j,k} e_{ijk} \\epsilon_{jk} $$\n对于在 xy 平面内受双轴应变的纤锌矿晶体，其中 $\\epsilon_{xx} = \\epsilon_{yy} = \\epsilon_{\\parallel}$，且除 $\\epsilon_{zz}$ 外所有其他应变分量均为零，这些关系可简化。面外应力分量 $\\sigma_{zz}$ 和沿 c 轴的极化分量 $P_z$ 为：\n$$ \\sigma_{zz} = c_{13}\\epsilon_{xx} + c_{13}\\epsilon_{yy} + c_{33}\\epsilon_{zz} = 2c_{13}\\epsilon_{\\parallel} + c_{33}\\epsilon_{zz} $$\n$$ P_{z,\\mathrm{pe}} = e_{31}\\epsilon_{xx} + e_{31}\\epsilon_{yy} + e_{33}\\epsilon_{zz} = 2e_{31}\\epsilon_{\\parallel} + e_{33}\\epsilon_{zz} $$\n\n第一步是使用 Vegard 定律 $X(x) = x X_{\\mathrm{AlN}} + (1-x) X_{\\mathrm{GaN}}$（其中 $x=0.25$）来确定 Al$_{0.25}$Ga$_{0.75}$N 的材料参数：\n\n晶格常数 $a$:\n$$ a_{\\mathrm{AlGaN}} = 0.25 \\cdot a_{\\mathrm{AlN}} + 0.75 \\cdot a_{\\mathrm{GaN}} = 0.25 \\cdot (3.112~\\text{\\AA}) + 0.75 \\cdot (3.189~\\text{\\AA}) = 0.778~\\text{\\AA} + 2.39175~\\text{\\AA} = 3.16975~\\text{\\AA} $$\n弹性常数 $c_{13}$ 和 $c_{33}$:\n$$ c_{13,\\mathrm{AlGaN}} = 0.25 \\cdot c_{13,\\mathrm{AlN}} + 0.75 \\cdot c_{13,\\mathrm{GaN}} = 0.25 \\cdot (108~\\mathrm{GPa}) + 0.75 \\cdot (106~\\mathrm{GPa}) = 27~\\mathrm{GPa} + 79.5~\\mathrm{GPa} = 106.5~\\mathrm{GPa} $$\n$$ c_{33,\\mathrm{AlGaN}} = 0.25 \\cdot c_{33,\\mathrm{AlN}} + 0.75 \\cdot c_{33,\\mathrm{GaN}} = 0.25 \\cdot (373~\\mathrm{GPa}) + 0.75 \\cdot (398~\\mathrm{GPa}) = 93.25~\\mathrm{GPa} + 298.5~\\mathrm{GPa} = 391.75~\\mathrm{GPa} $$\n压电系数 $e_{31}$ 和 $e_{33}$:\n$$ e_{31,\\mathrm{AlGaN}} = 0.25 \\cdot e_{31,\\mathrm{AlN}} + 0.75 \\cdot e_{31,\\mathrm{GaN}} = 0.25 \\cdot (-0.60~\\mathrm{C/m^2}) + 0.75 \\cdot (-0.49~\\mathrm{C/m^2}) = -0.15~\\mathrm{C/m^2} - 0.3675~\\mathrm{C/m^2} = -0.5175~\\mathrm{C/m^2} $$\n$$ e_{33,\\mathrm{AlGaN}} = 0.25 \\cdot e_{33,\\mathrm{AlN}} + 0.75 \\cdot e_{33,\\mathrm{GaN}} = 0.25 \\cdot (1.46~\\mathrm{C/m^2}) + 0.75 \\cdot (0.73~\\mathrm{C/m^2}) = 0.365~\\mathrm{C/m^2} + 0.5475~\\mathrm{C/m^2} = 0.9125~\\mathrm{C/m^2} $$\n\n接下来，我们计算 AlGaN 层中的面内双轴应变 $\\epsilon_{\\parallel}$。AlGaN 层 ($a_{\\mathrm{layer}} = a_{\\mathrm{AlGaN}}$) 发生应变以匹配弛豫的 GaN 衬底 ($a_{\\mathrm{sub}} = a_{\\mathrm{GaN}}$) 的面内晶格常数。\n$$ \\epsilon_{\\parallel} = \\frac{a_{\\mathrm{sub}} - a_{\\mathrm{layer}}}{a_{\\mathrm{layer}}} = \\frac{a_{\\mathrm{GaN}} - a_{\\mathrm{AlGaN}}}{a_{\\mathrm{AlGaN}}} = \\frac{3.189~\\text{\\AA} - 3.16975~\\text{\\AA}}{3.16975~\\text{\\AA}} = \\frac{0.01925}{3.16975} \\approx 0.00607301 $$\n\nAlGaN 势垒层很薄，因此我们可以假设垂直于表面的应力分量为零，即 $\\sigma_{zz} = 0$。这个条件使我们能够确定面外应变 $\\epsilon_{zz}$：\n$$ \\sigma_{zz} = 2c_{13,\\mathrm{AlGaN}}\\epsilon_{\\parallel} + c_{33,\\mathrm{AlGaN}}\\epsilon_{zz} = 0 $$\n求解 $\\epsilon_{zz}$：\n$$ \\epsilon_{zz} = -2\\frac{c_{13,\\mathrm{AlGaN}}}{c_{33,\\mathrm{AlGaN}}}\\epsilon_{\\parallel} $$\n该表达式表示各向异性介质中的泊松效应。代入插值得到的值：\n$$ \\epsilon_{zz} = -2 \\cdot \\frac{106.5~\\mathrm{GPa}}{391.75~\\mathrm{GPa}} \\cdot (0.00607301) \\approx -0.54374 \\cdot (0.00607301) \\approx -0.0033022 $$\n\n现在，我们可以通过将应变分量 $\\epsilon_{\\parallel}$ 和 $\\epsilon_{zz}$ 代入极化方程来计算压电极化强度 $P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}}$：\n$$ P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} = 2e_{31,\\mathrm{AlGaN}}\\epsilon_{\\parallel} + e_{33,\\mathrm{AlGaN}}\\epsilon_{zz} $$\n代入 $\\epsilon_{zz}$ 的表达式：\n$$ P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} = 2e_{31,\\mathrm{AlGaN}}\\epsilon_{\\parallel} + e_{33,\\mathrm{AlGaN}}\\left(-2\\frac{c_{13,\\mathrm{AlGaN}}}{c_{33,\\mathrm{AlGaN}}}\\epsilon_{\\parallel}\\right) = 2\\epsilon_{\\parallel}\\left(e_{31,\\mathrm{AlGaN}} - \\frac{c_{13,\\mathrm{AlGaN}}}{c_{33,\\mathrm{AlGaN}}}e_{33,\\mathrm{AlGaN}}\\right) $$\n代入数值：\n$$ P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} = 2 \\cdot (0.00607301) \\cdot \\left(-0.5175~\\mathrm{C/m^2} - \\frac{106.5}{391.75} \\cdot (0.9125~\\mathrm{C/m^2})\\right) $$\n$$ P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} = 0.01214602 \\cdot \\left(-0.5175 - 0.271871 \\cdot 0.9125\\right)~\\mathrm{C/m^2} $$\n$$ P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} = 0.01214602 \\cdot \\left(-0.5175 - 0.24808\\right)~\\mathrm{C/m^2} $$\n$$ P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} = 0.01214602 \\cdot (-0.76558)~\\mathrm{C/m^2} $$\n$$ P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}} \\approx -0.0092988~\\mathrm{C/m^2} $$\n\n压电面电荷密度为 $\\sigma_{\\mathrm{pe}} = P_{z,\\mathrm{pe}}^{\\mathrm{AlGaN}}$。将结果四舍五入到三位有效数字，得到：\n$$ \\sigma_{\\mathrm{pe}} \\approx -0.00930~\\mathrm{C/m^2} $$\n这可以用科学记数法表示为 $-9.30 \\times 10^{-3}~\\mathrm{C/m^2}$。",
            "answer": "$$\\boxed{-9.30 \\times 10^{-3}}$$"
        },
        {
            "introduction": "理解了2DEG的理论成因后，下一步便是如何在实验中对其关键特性进行精确表征。本练习将向你介绍传输线模型（TLM），这是一种用于确定欧姆接触电阻和沟道薄层电阻的标准技术 。通过分析一组假设的实验数据，你将学习如何提取诸如薄层电阻$R_{sh}$和接触电阻$R_c$等关键参数。这项实践为你搭建了一座从抽象的器件物理到可量化实验数据的桥梁，是器件工程师必备的核心技能。",
            "id": "3748436",
            "problem": "在氮化铝镓/氮化镓 (AlGaN/GaN) 高电子迁移率晶体管 (HEMT) 上制造了一组传输长度法 (TLM) 结构。每个 TLM 结构由两个相同的宽度为 $W$ 的欧姆接触组成，它们放置在二维电子气 (2DEG) 沟道上，并由间距 $L$ 分隔。接触长度 $L_c$ 满足 $L_c \\gg L_T$，其中 $L_T$ 是特征传输长度，表示从金属注入的电流在二维电子气中横向扩散的距离。接触在小偏压下驱动，因此载流子输运是线性的，沟道是均匀的，其薄层电阻为 $R_{sh}$。\n\n给定宽度 $W$ 下，五个不同间距 $L$ 的相邻接触之间的端到端总电阻 $R_T$ 的测量值：\n- $W = 20\\,\\mu\\text{m}$，\n- $(L, R_T)$ 数据：$(1\\,\\mu\\text{m},\\,40.8\\,\\Omega)$、$(2\\,\\mu\\text{m},\\,64.8\\,\\Omega)$、$(4\\,\\mu\\text{m},\\,112.8\\,\\Omega)$、$(8\\,\\mu\\text{m},\\,208.8\\,\\Omega)$、$(16\\,\\mu\\text{m},\\,400.8\\,\\Omega)$。\n\n从欧姆金属下具有垂直电流注入的电阻性薄层的第一性原理出发，推导 $R_T$ 对 $L$ 的依赖关系，确定如何从 $R_T$ 对 $L$ 的线性拟合中提取薄层电阻 $R_{sh}$ 和传输长度 $L_T$，并使用所提供的数据进行提取。然后计算归一化到宽度的接触电阻 $R_c$，定义为单位宽度的接触电阻，单位为 $\\Omega\\cdot\\text{mm}$。\n\n以 $\\Omega\\cdot\\text{mm}$ 为单位表示 $R_c$ 的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "在 TLM 结构中，两个欧姆接触之间的总测量电阻 $R_T$ 是三个分量的总和：接触之间的半导体薄层的电阻，以及与两个接触中的每一个相关的电阻。\n$$R_T = R_{channel} + 2R_C'$$\n其中 $R_{channel}$ 是接触之间 2DEG 沟道段的电阻，$R_C'$ 是单个接触的电阻。\n\n沟道电阻由薄层电阻 $R_{sh}$ (单位为 $\\Omega/\\text{sq}$) 乘以方块数（即长宽比 $L/W$）给出。\n$$R_{channel} = R_{sh} \\frac{L}{W}$$\n\n为了确定接触电阻 $R_C'$，我们采用传输线模型。考虑一个长度为 $L_c$、宽度为 $W$ 的单个接触。设 $x$ 是沿接触长度方向的坐标，从与沟道相邻的边缘 ($x=0$) 开始。设 $V(x)$ 是半导体层中的电压，$I(x)$ 是在金属接触下半导体层中流动的电流。我们假设金属接触本身是等势的，我们将其电位置为 $0$。\n\n半导体中的电压梯度通过薄层电阻与电流相关：\n$$\\frac{dV}{dx} = -\\frac{R_{sh}}{W} I(x)$$\n从半导体注入到金属接触的电流是由于界面上的电位差 $V(x)$ 造成的，其特征是特定的接触电阻率 $\\rho_c$ (单位为 $\\Omega\\cdot\\text{m}^2$)。在微分长度 $dx$ 上半导体电流的变化是：\n$$\\frac{dI}{dx} = -\\frac{V(x)}{\\rho_c / W} = -\\frac{W}{\\rho_c} V(x)$$\n将第一个方程对 $x$ 求导，并代入第二个方程，得到一个关于 $V(x)$ 的二阶常微分方程：\n$$\\frac{d^2V}{dx^2} = -\\frac{R_{sh}}{W} \\frac{dI}{dx} = -\\frac{R_{sh}}{W} \\left( -\\frac{W}{\\rho_c} V(x) \\right) = \\frac{R_{sh}}{\\rho_c} V(x)$$\n我们定义特征传输长度 $L_T$ 为：\n$$L_T = \\sqrt{\\frac{\\rho_c}{R_{sh}}}$$\n微分方程变为：\n$$\\frac{d^2V}{dx^2} - \\frac{1}{L_T^2} V(x) = 0$$\n通解为 $V(x) = A \\cosh(x/L_T) + B \\sinh(x/L_T)$。电流由电压得出：\n$$I(x) = -\\frac{W}{R_{sh}} \\frac{dV}{dx} = -\\frac{W}{R_{sh}L_T} \\left( A \\sinh\\left(\\frac{x}{L_T}\\right) + B \\cosh\\left(\\frac{x}{L_T}\\right) \\right)$$\n边界条件是：\n1.  总电流 $I_0$ 在 $x=0$ 处从沟道进入接触区域，所以 $I(0)=I_0$。\n2.  在接触的远端，$x=L_c$ 处，没有电流进一步流入半导体，所以 $I(L_c)=0$。\n\n应用第二个边界条件：\n$$A \\sinh(L_c/L_T) + B \\cosh(L_c/L_T) = 0 \\implies B = -A \\tanh(L_c/L_T)$$\n应用第一个边界条件：\n$$I_0 = I(0) = -\\frac{W}{R_{sh}L_T} (B) \\implies B = -\\frac{I_0 R_{sh} L_T}{W}$$\n接触电阻 $R_C'$ 定义为接触前沿的电压降 $V(0)$ 除以总电流 $I_0$。\n$$V(0) = A \\cosh(0) + B \\sinh(0) = A$$\n我们有 $A = -B / \\tanh(L_c/L_T) = \\left(\\frac{I_0 R_{sh} L_T}{W}\\right) / \\tanh(L_c/L_T)$。\n因此，一个接触的电阻是：\n$$R_C' = \\frac{V(0)}{I_0} = \\frac{R_{sh} L_T}{W \\tanh(L_c/L_T)} = \\frac{R_{sh} L_T}{W} \\coth\\left(\\frac{L_c}{L_T}\\right)$$\n问题指出接触长度远大于传输长度，$L_c \\gg L_T$。在此极限下，$L_c/L_T \\to \\infty$，且 $\\coth(L_c/L_T) \\to 1$。因此，接触电阻简化为：\n$$R_C' \\approx \\frac{R_{sh} L_T}{W}$$\n将此结果和沟道电阻代入总电阻 $R_T$ 的表达式中：\n$$R_T = \\frac{R_{sh} L}{W} + 2 \\frac{R_{sh} L_T}{W} = \\frac{R_{sh}}{W} (L + 2L_T)$$\n这个方程表明 $R_T$ 是间距 $L$ 的线性函数。$R_T$ 对 $L$ 的图是一条直线，其斜率为 $m$，y轴截距为 $b$：\n$$m = \\frac{R_{sh}}{W}$$\n$$b = 2 R_C' = \\frac{2 R_{sh} L_T}{W}$$\n从这些关系中，薄层电阻 $R_{sh}$ 可以从斜率中提取：\n$$R_{sh} = m \\cdot W$$\n传输长度 $L_T$ 可以从斜率和截距中提取。例如，直线的x轴截距 $L_x$（即 $R_T=0$ 的地方）由 $L_x = -2L_T$ 给出。因此，$L_T = -L_x/2$。或者，通过将截距除以斜率：$\\frac{b}{m} = \\frac{2 R_{sh} L_T / W}{R_{sh} / W} = 2L_T$，得出 $L_T = \\frac{b}{2m}$。\n\n现在，我们将此模型应用于所提供的数据。数据点为 $(1, 40.8)$、$(2, 64.8)$、$(4, 112.8)$、$(8, 208.8)$、$(16, 400.8)$，其中 $L$ 的单位是 $\\mu\\text{m}$，$R_T$ 的单位是 $\\Omega$。我们对 $R_T = mL+b$ 进行线性拟合。\n我们观察到数据完全在一条直线上。斜率 $m$ 可以从任意两点计算得出。例如，使用前两个点：\n$$m = \\frac{64.8\\,\\Omega - 40.8\\,\\Omega}{2\\,\\mu\\text{m} - 1\\,\\mu\\text{m}} = \\frac{24\\,\\Omega}{1\\,\\mu\\text{m}} = 24\\,\\Omega/\\mu\\text{m}$$\n这个斜率在所有数据点中都是一致的。\ny轴截距 $b$ 可以通过外推到 $L=0$ 来找到：\n$$b = R_T - m L = 40.8\\,\\Omega - (24\\,\\Omega/\\mu\\text{m})(1\\,\\mu\\text{m}) = 16.8\\,\\Omega$$\n线性拟合结果是 $R_T(\\Omega) = 24 L(\\mu\\text{m}) + 16.8$。\n\n当 $W = 20\\,\\mu\\text{m}$ 时，我们现在可以提取 $R_{sh}$：\n$$R_{sh} = m \\cdot W = (24\\,\\Omega/\\mu\\text{m}) \\cdot (20\\,\\mu\\text{m}) = 480\\,\\Omega$$\n所以，薄层电阻是 $R_{sh} = 480\\,\\Omega/\\text{sq}$。\n\ny轴截距代表两个接触的总电阻，$2R_C' = 16.8\\,\\Omega$。\n单个接触的电阻是 $R_C' = 16.8\\,\\Omega / 2 = 8.4\\,\\Omega$。\n\n问题要求计算归一化到宽度的接触电阻 $R_c$，单位为 $\\Omega\\cdot\\text{mm}$。该量定义为 $R_c = R_C' \\cdot W$。\n$$R_c = (8.4\\,\\Omega) \\cdot (20\\,\\mu\\text{m}) = 168\\,\\Omega\\cdot\\mu\\text{m}$$\n我们必须将此结果转换为所需的单位 $\\Omega\\cdot\\text{mm}$。由于 $1\\,\\text{mm} = 1000\\,\\mu\\text{m}$，或者 $1\\,\\mu\\text{m} = 10^{-3}\\,\\text{mm}$：\n$$R_c = 168\\,\\Omega\\cdot\\mu\\text{m} \\times \\frac{1\\,\\text{mm}}{1000\\,\\mu\\text{m}} = 0.168\\,\\Omega\\cdot\\text{mm}$$\n最后，我们按照要求将结果四舍五入到四位有效数字。\n$$R_c = 0.1680\\,\\Omega\\cdot\\text{mm}$$\n\n作为一致性检查，我们可以计算传输长度 $L_T$：\n$$L_T = \\frac{b}{2m} = \\frac{16.8\\,\\Omega}{2 \\cdot (24\\,\\Omega/\\mu\\text{m})} = \\frac{16.8}{48}\\,\\mu\\text{m} = 0.35\\,\\mu\\text{m}$$\n简化模型的前提条件 $L_c \\gg L_T$ 对于制造中使用的典型接触长度是满足的（例如，$L_c > 5 L_T = 1.75\\,\\mu\\text{m}$）。对于 AlGaN/GaN 2DEG 的高质量欧姆接触，推导出的 $R_c$ 值在物理上是合理的。",
            "answer": "$$\\boxed{0.1680}$$"
        },
        {
            "introduction": "成功的器件设计往往是在相互制约的性能指标之间寻求最佳平衡。本练习聚焦于GaN HEMT中一个典型的工程权衡：击穿电压（$V_{BR}$）与高频性能（$f_{max}$）之间的矛盾 。你将通过编写一个计算程序，利用物理模型来量化场板结构对这两项关键指标的影响，并在此基础上寻找一个受约束的最优设计。这项实践旨在培养你利用计算模型来驾驭复杂工程权衡的能力，这是现代半导体器件设计的核心方法论。",
            "id": "3748365",
            "problem": "考虑一个氮化镓高电子迁移率晶体管 (Gallium Nitride High Electron Mobility Transistor, GaN HEMT)，其栅极连接一个长度为 $L_{\\mathrm{fp}}$ 的场板，该场板延伸到长度为 $L_{\\mathrm{gd}}$ 的栅漏アクセス区上方。场板降低了漏极侧栅极边缘附近的峰值电场，从而提高了击穿电压 $V_{\\mathrm{BR}}$，但它也增加了栅漏电容 $C_{\\mathrm{gd}}$，这会降低最大振荡频率 $f_{\\max}$。您的任务是编写一个完整、可运行的程序，针对每个指定的测试用例，计算在给定的电容增量约束下能使 $V_{\\mathrm{BR}}$ 最大化的场板长度，然后量化由增加的 $C_{\\mathrm{gd}}$ 引起的 $f_{\\max}$ 的劣化程度。\n\n基于半导体器件物理的出发点和建模假设：\n- 对 GaN 使用一维临界场击穿准则：当最大电场达到临界场 $E_{\\mathrm{crit}}$ 时，发生击穿。\n- 通过无量纲峰值因子 $k_{\\mathrm{peak}}(L_{\\mathrm{fp}})$ 对アクセス区的峰值电场进行建模，使得 $E_{\\mathrm{peak}}(L_{\\mathrm{fp}}) = k_{\\mathrm{peak}}(L_{\\mathrm{fp}}) V_D / L_{\\mathrm{gd}}$，其中 $V_D$ 是漏极电压。随着 $L_{\\mathrm{fp}}$ 的增加，场板会降低 $k_{\\mathrm{peak}}$，且收益递减。使用两个正常数 $\\alpha$ 和 $\\eta$ 通过以下公式来参数化这种降低：\n$$\nk_{\\mathrm{peak}}(L_{\\mathrm{fp}}) = \\frac{k_{\\mathrm{peak},0}}{1 + \\alpha \\left(1 - e^{-\\eta L_{\\mathrm{fp}}/L_{\\mathrm{gd}}}\\right)}.\n$$\n根据击穿准则 $E_{\\mathrm{peak}}(L_{\\mathrm{fp}}) = E_{\\mathrm{crit}}$，可以得出：\n$$\nV_{\\mathrm{BR}}(L_{\\mathrm{fp}}) = \\frac{E_{\\mathrm{crit}} L_{\\mathrm{gd}}}{k_{\\mathrm{peak}}(L_{\\mathrm{fp}})}.\n$$\n- 将场板重叠引起的附加栅漏电容建模为单位栅宽的平行板电容：\n$$\nC_{\\mathrm{add}}(L_{\\mathrm{fp}}) = \\frac{\\varepsilon_0 \\varepsilon_{\\mathrm{r,eff}} W L_{\\mathrm{fp}}}{t_{\\mathrm{ox}}},\n$$\n其中 $\\varepsilon_0$ 是真空介电常数，$\\varepsilon_{\\mathrm{r,eff}}$ 是钝化层的有效相对介电常数，$W$ 是归一化栅宽，$t_{\\mathrm{ox}}$ 是场板下方的电介质厚度。将 $C_{\\mathrm{add}}$ 及所有电容以 $\\mathrm{pF/mm}$ 为单位表示，其中 $W$ 理解为 $W = 1\\,\\mathrm{mm}$ 用于归一化。\n- 设基准栅漏电容为 $C_{\\mathrm{gd},0}$，基准栅源电容为 $C_{\\mathrm{gs},0}$，单位均为 $\\mathrm{pF/mm}$。总栅漏电容为 $C_{\\mathrm{gd}}(L_{\\mathrm{fp}}) = C_{\\mathrm{gd},0} + C_{\\mathrm{add}}(L_{\\mathrm{fp}})$。\n- 优化约束是栅漏电容增量的分数限制 $\\phi$，即强制要求\n$$\n\\frac{C_{\\mathrm{gd}}(L_{\\mathrm{fp}}) - C_{\\mathrm{gd},0}}{C_{\\mathrm{gd},0}} \\le \\phi,\n$$\n以及物理边界 $0 \\le L_{\\mathrm{fp}} \\le L_{\\max}$。\n\n需要推导和使用的小信号频率定义：\n- 通过短路电流增益为1的条件定义渡越频率 $f_t$。对于跨导为 $g_m$、总输入电容为 $C_{\\mathrm{in}} = C_{\\mathrm{gs}} + C_{\\mathrm{gd}}$ 的共源 HEMT，证明：\n$$\nf_t = \\frac{g_m}{2\\pi\\left(C_{\\mathrm{gs}} + C_{\\mathrm{gd}}\\right)}.\n$$\n- 从包含非零栅极电阻 $R_g$、非零漏极电导 $g_d$ 以及通过 $C_{\\mathrm{gd}}$ 的反馈的小信号混合-$\\pi$ 模型出发，使用 Mason 的单向功率增益 $U$ 和 $U=1$ 准则，推导最大振荡频率 $f_{\\max}$ 的隐式方程。证明一个自洽近似可得到以下不动点关系：\n$$\nf_{\\max} = \\frac{f_t}{2 \\sqrt{ R_g \\left( g_d + 2\\pi f_{\\max} C_{\\mathrm{gd}} \\right) }},\n$$\n当 $C_{\\mathrm{gd}} \\neq 0$ 时，必须通过迭代求解该方程以获得 $f_{\\max}$。\n\n每个测试用例的计算任务：\n1. 根据 $C_{\\mathrm{gd}}$ 的分数约束和平行板电容模型，计算电容限制的场板长度 $L_{\\mathrm{fp,cap}}$，然后设置 $L_{\\mathrm{fp,opt}} = \\min\\{L_{\\mathrm{fp,cap}}, L_{\\max}\\}$。\n2. 计算 $V_{\\mathrm{BR}}(L_{\\mathrm{fp,opt}})$，单位为 $\\mathrm{V}$。\n3. 使用上面的不动点关系，计算 $f_t$ 并求解使用 $C_{\\mathrm{gd}}(L_{\\mathrm{fp,opt}})$ 时的 $f_{\\max}$。将 $f_{\\max}$ 以 $\\mathrm{GHz}$ 为单位表示。\n4. 计算 $L_{\\mathrm{fp}} = 0$ 时的基准 $f_{\\max,0}$（即 $C_{\\mathrm{gd}} = C_{\\mathrm{gd},0}$），并以下列小数形式报告分数劣化度 $\\delta$：\n$$\n\\delta = \\frac{f_{\\max,0} - f_{\\max}(L_{\\mathrm{fp,opt}})}{f_{\\max,0}}.\n$$\n\n单位和输出格式要求：\n- 使用以下单位：$L_{\\mathrm{gd}}$ 和 $L_{\\mathrm{fp}}$ 以 $\\mu\\mathrm{m}$ 为单位，$t_{\\mathrm{ox}}$ 以 $\\mathrm{nm}$ 为单位，$E_{\\mathrm{crit}}$ 以 $\\mathrm{MV/cm}$ 为单位（内部转换为 $\\mathrm{V/m}$），$C_{\\mathrm{gd}}$ 和 $C_{\\mathrm{gs}}$ 以 $\\mathrm{pF/mm}$ 为单位，$g_m$ 和 $g_d$ 以 $\\mathrm{S/mm}$ 为单位，$R_g$ 以 $\\Omega$ 为单位，$f_{\\max}$ 以 $\\mathrm{GHz}$ 为单位。将每个测试用例的最终输出表示为一个包含四个浮点数的列表，顺序为 $[L_{\\mathrm{fp,opt}}\\,(\\mu\\mathrm{m}), V_{\\mathrm{BR}}\\,(\\mathrm{V}), f_{\\max}\\,(\\mathrm{GHz}), \\delta]$，并遵循以下四舍五入规则：$L_{\\mathrm{fp,opt}}$ 保留三位小数，$V_{\\mathrm{BR}}$ 保留一位小数，$f_{\\max}$ 保留一位小数，$\\delta$ 保留三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也是一个用方括号括起来的逗号分隔列表，例如 $[[\\ldots],[\\ldots],\\ldots]$。\n\n测试套件：\n对于每种情况，参数按以下顺序给出 $(L_{\\mathrm{gd}}\\,(\\mu\\mathrm{m}), L_{\\max}\\,(\\mu\\mathrm{m}), t_{\\mathrm{ox}}\\,(\\mathrm{nm}), \\varepsilon_{\\mathrm{r,eff}}, g_m\\,(\\mathrm{S/mm}), g_d\\,(\\mathrm{S/mm}), R_g\\,(\\Omega), C_{\\mathrm{gs},0}\\,(\\mathrm{pF/mm}), C_{\\mathrm{gd},0}\\,(\\mathrm{pF/mm}), E_{\\mathrm{crit}}\\,(\\mathrm{MV/cm}), k_{\\mathrm{peak},0}, \\alpha, \\eta, \\phi)$:\n- 情况1（典型的射频 GaN HEMT）：\n  $(1.0, 1.0, 100.0, 6.5, 0.30, 0.04, 0.40, 0.60, 0.20, 3.0, 1.80, 0.80, 1.00, 0.50)$.\n- 情况2（严格的电容限制）：\n  $(1.0, 1.0, 100.0, 6.5, 0.30, 0.04, 0.40, 0.60, 0.20, 3.0, 1.80, 0.80, 1.00, 0.10)$.\n- 情况3（具有更厚电介质和更大アクセス区的功率器件）：\n  $(3.0, 3.0, 200.0, 6.5, 0.20, 0.02, 0.60, 1.00, 0.30, 3.0, 1.60, 1.00, 1.20, 0.70)$.\n- 情况4（高基准 $C_{\\mathrm{gd},0}$ 的边缘情况）：\n  $(0.8, 0.8, 120.0, 6.5, 0.35, 0.05, 0.50, 0.70, 0.50, 3.0, 1.90, 0.70, 0.90, 0.30)$.\n- 情况5（由于 $L_{\\max}$ 边界，电容约束不具约束力）：\n  $(0.6, 0.6, 300.0, 6.5, 0.28, 0.04, 0.35, 0.50, 0.15, 3.0, 1.70, 0.90, 1.10, 1.50)$.\n\n您的程序必须实现以上定义，并生成包含5个四浮点数列表的单行括号输出，且顺序和四舍五入规则需符合要求。",
            "solution": "**1. 基本模型与原理**\n\n问题提供了一套分析模型，用于描述击穿电压 $V_{\\mathrm{BR}}$ 和最大振荡频率 $f_{\\max}$ 之间作为场板长度 $L_{\\mathrm{fp}}$ 函数的权衡关系。\n\n**电容和击穿电压：**\n由场板引起的单位宽度附加栅漏电容 $C'_{\\mathrm{add}}$ 由平行板电容器公式给出：\n$$C'_{\\mathrm{add}}(L_{\\mathrm{fp}}) = \\frac{\\varepsilon_0 \\varepsilon_{\\mathrm{r,eff}} L_{\\mathrm{fp}}}{t_{\\mathrm{ox}}}$$\n其中 $\\varepsilon_0$ 是真空介电常数，$\\varepsilon_{\\mathrm{r,eff}}$ 是电介质的有效相对介电常数，$L_{\\mathrm{fp}}$ 是场板长度，$t_{\\mathrm{ox}}$ 是电介质厚度。单位宽度的总栅漏电容为 $C'_{\\mathrm{gd}}(L_{\\mathrm{fp}}) = C'_{\\mathrm{gd},0} + C'_{\\mathrm{add}}(L_{\\mathrm{fp}})$，其中 $C'_{\\mathrm{gd},0}$ 是 $L_{\\mathrm{fp}}=0$ 时的基准电容。\n\n击穿电压 $V_{\\mathrm{BR}}$ 由临界场 $E_{\\mathrm{crit}}$ 和栅漏アクセス区的峰值电场决定。该峰值电场由场板根据无量纲因子 $k_{\\mathrm{peak}}(L_{\\mathrm{fp}})$ 进行调制：\n$$V_{\\mathrm{BR}}(L_{\\mathrm{fp}}) = \\frac{E_{\\mathrm{crit}} L_{\\mathrm{gd}}}{k_{\\mathrm{peak}}(L_{\\mathrm{fp}})}$$\n因子 $k_{\\mathrm{peak}}(L_{\\mathrm{fp}})$ 建模为：\n$$k_{\\mathrm{peak}}(L_{\\mathrm{fp}}) = \\frac{k_{\\mathrm{peak},0}}{1 + \\alpha \\left(1 - e^{-\\eta L_{\\mathrm{fp}}/L_{\\mathrm{gd}}}\\right)}$$\n由于参数 $\\alpha$ 和 $\\eta$ 是正数，增加 $L_{\\mathrm{fp}}$ 会导致 $k_{\\mathrm{peak}}(L_{\\mathrm{fp}})$ 单调减少，从而使 $V_{\\mathrm{BR}}(L_{\\mathrm{fp}})$ 单调增加。因此，要最大化 $V_{\\mathrm{BR}}$，必须选择尽可能大的 $L_{\\mathrm{fp}}$ 值。\n\n**场板长度的优化：**\n最大允许的 $L_{\\mathrm{fp}}$ 由两个约束决定：一个物理限制 $L_{\\max}$ 和一个电容限制。分数电容增量受 $\\phi$ 约束：\n$$\\frac{C'_{\\mathrm{add}}(L_{\\mathrm{fp}})}{C'_{\\mathrm{gd},0}} \\le \\phi$$\n代入 $C'_{\\mathrm{add}}$ 的表达式，我们可以解出电容限制的场板长度 $L_{\\mathrm{fp,cap}}$：\n$$L_{\\mathrm{fp,cap}} = \\frac{\\phi C'_{\\mathrm{gd},0} t_{\\mathrm{ox}}}{\\varepsilon_0 \\varepsilon_{\\mathrm{r,eff}}}$$\n在满足两个约束条件的同时最大化 $V_{\\mathrm{BR}}$ 的最优场板长度 $L_{\\mathrm{fp,opt}}$ 是这两个上界中的较小者：\n$$L_{\\mathrm{fp,opt}} = \\min(L_{\\mathrm{fp,cap}}, L_{\\max})$$\n\n**高频性能指标：**\n问题要求推导和使用渡越频率 $f_t$ 和最大振荡频率 $f_{\\max}$ 的公式。\n- 晶体管的短路电流增益 $h_{21}$ 是输出短路（$v_{out}=0$）时输出电流与输入电流之比。根据小信号模型，$i_{in} = j\\omega(C_{\\mathrm{gs}} + C_{\\mathrm{gd}})v_{in}$ 且 $i_{out} = g_m v_{in}$。因此，$|h_{21}(f)| = \\frac{g_m}{2\\pi f(C_{\\mathrm{gs}} + C_{\\mathrm{gd}})}$。渡越频率 $f_t$ 定义为 $|h_{21}|=1$ 时的频率，这直接得出：\n$$f_t = \\frac{g_m}{2\\pi(C_{\\mathrm{gs}} + C_{\\mathrm{gd}})}$$\n注意，由于所有参数（$g_m, C_{\\mathrm{gs}}, C_{\\mathrm{gd}}$）都是以单位宽度的值（例如 S/mm, F/m）给出，它们的比率正确地得出了单位为 Hz 的 $f_t$。\n\n- 最大振荡频率 $f_{\\max}$ 是单向功率增益 $U$ 变为1时的频率。推导 $U$ 的完整表达式很复杂。然而，一个常用且有效的近似考虑了关键的物理效应，包括输出电导 $g_d$、栅极电阻 $R_g$ 以及通过 $C_{\\mathrm{gd}}$ 的反馈。功率增益与输入电阻和输出电导的乘积成反比。在高频下，通过 $C_{\\mathrm{gd}}$ 的反馈对输出电导有一个额外的贡献，可以近似为 $2\\pi f C_{\\mathrm{gd}}$。在 $f = f_{\\max}$ 时以自洽的方式施加此条件，可得到有效输出电导为 $g_{d,eff} \\approx g_d + 2\\pi f_{\\max} C_{\\mathrm{gd}}$。在功率增益表达式中使用此结果并设置增益为1，可得到给定的 $f_{\\max}$ 隐式关系：\n$$f_{\\max} = \\frac{f_t}{2 \\sqrt{ R_g \\left( g_d + 2\\pi f_{\\max} C_{\\mathrm{gd}} \\right) }}$$\n此不动点方程必须迭代求解。参数 $g_d$ 和 $C_{\\mathrm{gd}}$ 是单位宽度的值，因此它们必须乘以一个参考宽度（此处为 $W=1\\,\\mathrm{mm}$），以便在量纲上与总电阻 $R_g$（单位为 $\\Omega$）保持一致。\n\n**2. 计算算法**\n\n对于每个测试用例，使用一套一致的国际单位制（SI）单位执行以下步骤。\n\n**单位转换：**\n- 设 $\\varepsilon_0 = 8.854 \\times 10^{-12} \\, \\mathrm{F/m}$。\n- 长度（$L_{\\mathrm{gd}}$, $L_{\\max}$, $L_{\\mathrm{fp}}$）从 $\\mu\\mathrm{m}$ 到 $\\mathrm{m}$：乘以 $10^{-6}$。\n- 厚度（$t_{\\mathrm{ox}}$）从 $\\mathrm{nm}$ 到 $\\mathrm{m}$：乘以 $10^{-9}$。\n- 电场（$E_{\\mathrm{crit}}$）从 $\\mathrm{MV/cm}$ 到 $\\mathrm{V/m}$：乘以 $10^8$。\n- 单位宽度电容（$C_{\\mathrm{gs},0}$, $C_{\\mathrm{gd},0}$）从 $\\mathrm{pF/mm}$ 到 $\\mathrm{F/m}$：乘以 $10^{-9}$。\n- 单位宽度电导（$g_m$, $g_d$）从 $\\mathrm{S/mm}$ 到 $\\mathrm{S/m}$：乘以 $10^3$。\n\n**分步计算：**\n1.  **计算 $L_{\\mathrm{fp,opt}}$：** 读取输入参数并将其转换为国际单位制（SI）单位。使用上面推导的公式计算以米为单位的 $L_{\\mathrm{fp,cap}}$。将结果转换为 $\\mu\\mathrm{m}$，并求出以 $\\mu\\mathrm{m}$ 为单位的 $L_{\\mathrm{fp,opt}} = \\min(L_{\\mathrm{fp,cap}}, L_{\\max})$。\n2.  **计算 $V_{\\mathrm{BR}}$：** 使用 $L_{\\mathrm{fp,opt}}$ 和 $L_{\\mathrm{gd}}$ 的 `µm` 值计算 $k_{\\mathrm{peak}}(L_{\\mathrm{fp,opt}})$，因为它们的比值是无量纲的。然后使用 $E_{\\mathrm{crit}}$ 和 $L_{\\mathrm{gd}}$ 的 SI 值计算以伏特为单位的 $V_{\\mathrm{BR}}$。\n3.  **定义 $f_{\\max}$ 的迭代求解器：** 创建一个函数，为 $f_{\\max}$ 方程实现不动点迭代 $f_{n+1} = G(f_n)$。迭代从一个初始猜测（例如，$f_0 = f_t$）开始，一直持续到变化量 $|f_{n+1} - f_n|$ 低于一个小的容差（例如，$100\\,\\mathrm{Hz}$）为止。\n4.  **计算基准 $f_{\\max,0}$：** 使用 $C'_{\\mathrm{gd},0}$ 和 $C'_{\\mathrm{gs},0}$（单位为 $\\mathrm{F/m}$）计算 $f_{t,0}$。使用迭代求解器找到以 Hz 为单位的 $f_{\\max,0}$，计算时使用宽度为 $1\\,\\mathrm{mm}$ 的器件的总参数（即，$g_{d,tot} = g'_d \\cdot 10^{-3}$，$C_{\\mathrm{gd,tot}} = C'_{\\mathrm{gd},0} \\cdot 10^{-3}$）。\n5.  **计算优化后的 $f_{\\max}$：** 计算单位宽度的附加电容 $C'_{\\mathrm{add}}(L_{\\mathrm{fp,opt}})$ 和新的单位宽度总栅漏电容 $C'_{\\mathrm{gd}} = C'_{\\mathrm{gd},0} + C'_{\\mathrm{add}}$。用这个更新后的电容计算新的渡越频率 $f_t$。使用迭代求解器找到新的以 Hz 为单位的 $f_{\\max}$。\n6.  **计算劣化度 $\\delta$：** 计算分数劣化度 $\\delta = (f_{\\max,0} - f_{\\max}) / f_{\\max,0}$。\n7.  **格式化输出：** 收集四个结果：$L_{\\mathrm{fp,opt}}$ ($\\mu\\mathrm{m}$)、$V_{\\mathrm{BR}}$ (V)、$f_{\\max}$ (GHz，将 Hz 值除以 $10^9$ 得出) 和 $\\delta$。将它们四舍五入到指定的小数位数，并存储在一个列表中。\n\n对所有测试用例重复此过程，并将最终的结果列表格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes GaN HEMT performance metrics based on field plate design.\n    \"\"\"\n    \n    # Physical constant\n    EPSILON_0 = 8.854e-12  # Vacuum permittivity in F/m\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (L_gd(um), L_max(um), t_ox(nm), eps_r, g_m(S/mm), g_d(S/mm), R_g(Ohm), C_gs0(pF/mm), C_gd0(pF/mm), E_crit(MV/cm), k_peak0, alpha, eta, phi)\n        (1.0, 1.0, 100.0, 6.5, 0.30, 0.04, 0.40, 0.60, 0.20, 3.0, 1.80, 0.80, 1.00, 0.50),\n        (1.0, 1.0, 100.0, 6.5, 0.30, 0.04, 0.40, 0.60, 0.20, 3.0, 1.80, 0.80, 1.00, 0.10),\n        (3.0, 3.0, 200.0, 6.5, 0.20, 0.02, 0.60, 1.00, 0.30, 3.0, 1.60, 1.00, 1.20, 0.70),\n        (0.8, 0.8, 120.0, 6.5, 0.35, 0.05, 0.50, 0.70, 0.50, 3.0, 1.90, 0.70, 0.90, 0.30),\n        (0.6, 0.6, 300.0, 6.5, 0.28, 0.04, 0.35, 0.50, 0.15, 3.0, 1.70, 0.90, 1.10, 1.50),\n    ]\n\n    all_results = []\n\n    def solve_fmax_iteratively(f_t, R_g, g_d_tot, C_gd_tot):\n        \"\"\"Solves for f_max using fixed-point iteration.\"\"\"\n        if f_t == 0:\n            return 0.0\n            \n        f_max = f_t  # Initial guess\n        \n        # Check for non-physical conditions to avoid math errors\n        if R_g * g_d_tot  0:\n            return 0.0\n\n        for _ in range(100): # Max 100 iterations for convergence\n            # Term under sqrt must be non-negative\n            term_in_sqrt = R_g * (g_d_tot + 2 * np.pi * f_max * C_gd_tot)\n            if term_in_sqrt  0:\n                # This can happen if g_d is negative, but problem states positive params.\n                # A more common issue is C_gd becoming negative, which is also unphysical here.\n                # Let's handle it robustly.\n                return 0.0 \n            \n            f_max_next = f_t / (2 * np.sqrt(term_in_sqrt))\n            \n            if abs(f_max_next - f_max)  1e3:  # Convergence tolerance (1 kHz)\n                return f_max_next\n            f_max = f_max_next\n            \n        return f_max\n\n    for case in test_cases:\n        L_gd_um, L_max_um, t_ox_nm, eps_r_eff, g_m_S_mm, g_d_S_mm, R_g_Ohm, \\\n        C_gs0_pF_mm, C_gd0_pF_mm, E_crit_MV_cm, k_peak0, alpha, eta, phi = case\n\n        # --- Unit conversions to SI base units ---\n        L_gd_m = L_gd_um * 1e-6\n        t_ox_m = t_ox_nm * 1e-9\n        C_gd0_F_m = C_gd0_pF_mm * 1e-9  # pF/mm  1e-12 F / 1e-3 m = 1e-9 F/m\n        C_gs0_F_m = C_gs0_pF_mm * 1e-9\n        E_crit_V_m = E_crit_MV_cm * 1e8    # MV/cm  1e6 V / 1e-2 m = 1e8 V/m\n        g_m_S_m = g_m_S_mm * 1e3\n        g_d_S_m = g_d_S_mm * 1e3\n        W_ref_m = 1e-3 # Reference width of 1 mm\n\n        # 1. Compute optimal field plate length L_fp,opt\n        L_fp_cap_m = (phi * C_gd0_F_m * t_ox_m) / (EPSILON_0 * eps_r_eff)\n        L_fp_cap_um = L_fp_cap_m * 1e6\n        L_fp_opt_um = min(L_fp_cap_um, L_max_um)\n        L_fp_opt_m = L_fp_opt_um * 1e-6\n\n        # 2. Compute breakdown voltage V_BR\n        exp_term = np.exp(-eta * L_fp_opt_um / L_gd_um)\n        k_peak = k_peak0 / (1 + alpha * (1 - exp_term))\n        V_BR = (E_crit_V_m * L_gd_m) / k_peak\n\n        # 3. Calculate baseline performance (L_fp = 0)\n        f_t0 = g_m_S_m / (2 * np.pi * (C_gs0_F_m + C_gd0_F_m))\n        g_d_tot0 = g_d_S_m * W_ref_m\n        C_gd_tot0 = C_gd0_F_m * W_ref_m\n        f_max0_hz = solve_fmax_iteratively(f_t0, R_g_Ohm, g_d_tot0, C_gd_tot0)\n\n        # 4. Calculate performance with L_fp,opt\n        C_add_F_m = (EPSILON_0 * eps_r_eff * L_fp_opt_m) / t_ox_m\n        C_gd_F_m = C_gd0_F_m + C_add_F_m\n        \n        f_t_opt = g_m_S_m / (2 * np.pi * (C_gs0_F_m + C_gd_F_m))\n        g_d_tot_opt = g_d_S_m * W_ref_m # same as baseline\n        C_gd_tot_opt = C_gd_F_m * W_ref_m\n        f_max_opt_hz = solve_fmax_iteratively(f_t_opt, R_g_Ohm, g_d_tot_opt, C_gd_tot_opt)\n\n        # 5. Compute degradation\n        delta = (f_max0_hz - f_max_opt_hz) / f_max0_hz if f_max0_hz > 0 else 0.0\n\n        # 6. Format results for output\n        f_max_opt_ghz = f_max_opt_hz / 1e9\n\n        result_case = [\n            round(L_fp_opt_um, 3),\n            round(V_BR, 1),\n            round(f_max_opt_ghz, 1),\n            round(delta, 3)\n        ]\n        all_results.append(result_case)\n\n    # Final print statement in the exact required format\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}