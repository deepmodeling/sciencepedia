{
    "hands_on_practices": [
        {
            "introduction": "The mathematical foundation of the Haynes-Shockley experiment is the drift-diffusion equation, which governs how a population of charge carriers evolves under the combined influence of an electric field and concentration gradients. Mastering this experiment begins with deriving its fundamental solution, or Green's function. This practice guides you through solving the governing partial differential equation for an idealized point-like injection, a core exercise in mathematical physics that yields the famous drifting and spreading Gaussian packet.",
            "id": "3779297",
            "problem": "Consider a one-dimensional Haynes–Shockley experiment (HS experiment) performed on a long, uniformly doped semiconductor bar with a spatially uniform electric field $E$ applied along the $+x$ direction. Under low-level injection, the minority carrier concentration $n(x,t)$ evolves according to the continuity equation and a linear drift–diffusion constitutive law with first-order recombination. Let the particle flux density be $F(x,t) = \\mu E\\, n(x,t) - D\\, \\frac{\\partial n}{\\partial x}(x,t)$, where $\\mu$ is the carrier mobility and $D$ is the diffusion coefficient, and let recombination be characterized by a single lifetime $\\tau$. The continuity equation reads $\\frac{\\partial n}{\\partial t}(x,t) + \\frac{\\partial F}{\\partial x}(x,t) = - \\frac{n(x,t)}{\\tau}$. Assume the domain is unbounded, $x \\in \\mathbb{R}$, and that at $t=0$ an ultrashort injection creates a narrow packet modeled by the Dirac delta function $\\delta(x-x_0)$ at position $x_0$, so that $n(x,0) = \\delta(x-x_0)$. Using the Fourier transform (FT) in space or the Laplace transform in time, and starting only from the given continuity equation, constitutive relation for $F(x,t)$, and the initial condition, derive the fundamental solution (Green’s function) $G(x,t;x_0)$ for $t>0$ on the unbounded domain that propagates and decays the initial delta-function packet under drift, diffusion, and recombination. Present your final answer as a single closed-form analytic expression for $G(x,t;x_0)$ in terms of $x$, $t$, $x_0$, $D$, $\\mu$, $E$, and $\\tau$. No numerical approximation is required.",
            "solution": "The problem is valid. It is a well-posed initial value problem for a linear partial differential equation with constant coefficients, grounded in the standard physical model of carrier transport in semiconductors. All necessary information is provided, and there are no contradictions or scientific inaccuracies. We can therefore proceed with the derivation.\n\nThe starting point is the one-dimensional continuity equation for minority carriers, $n(x,t)$, given as:\n$$\n\\frac{\\partial n}{\\partial t}(x,t) + \\frac{\\partial F}{\\partial x}(x,t) = - \\frac{n(x,t)}{\\tau}\n$$\nThe particle flux density, $F(x,t)$, is given by the drift-diffusion constitutive relation:\n$$\nF(x,t) = \\mu E\\, n(x,t) - D\\, \\frac{\\partial n}{\\partial x}(x,t)\n$$\nwhere $\\mu$ is the mobility, $E$ is the uniform electric field, $D$ is the diffusion coefficient, and $\\tau$ is the recombination lifetime. Substituting the expression for $F(x,t)$ into the continuity equation, we obtain the governing partial differential equation (PDE) for $n(x,t)$.\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( \\mu E n - D \\frac{\\partial n}{\\partial x} \\right) = - \\frac{n}{\\tau}\n$$\nSince $\\mu$, $E$, and $D$ are constants, this expands to:\n$$\n\\frac{\\partial n}{\\partial t} + \\mu E \\frac{\\partial n}{\\partial x} - D \\frac{\\partial^2 n}{\\partial x^2} = - \\frac{n}{\\tau}\n$$\nRearranging the terms, we have the advection-diffusion-reaction equation:\n$$\n\\frac{\\partial n}{\\partial t} = D \\frac{\\partial^2 n}{\\partial x^2} - v_d \\frac{\\partial n}{\\partial x} - \\frac{n}{\\tau}\n$$\nwhere we have defined the drift velocity $v_d = \\mu E$.\n\nThe problem is to find the fundamental solution (or Green's function) $G(x,t;x_0)$ corresponding to the initial condition $n(x,0) = \\delta(x-x_0)$ on the unbounded domain $x \\in \\mathbb{R}$. We will use the spatial Fourier transform method. Let $\\hat{n}(k,t)$ be the Fourier transform of $n(x,t)$ with respect to the spatial variable $x$. We define the transform pair as:\n$$\n\\hat{n}(k,t) = \\mathcal{F}\\{n(x,t)\\} = \\int_{-\\infty}^{\\infty} n(x,t) e^{-ikx} dx\n$$\n$$\nn(x,t) = \\mathcal{F}^{-1}\\{\\hat{n}(k,t)\\} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\hat{n}(k,t) e^{ikx} dk\n$$\nThe derivatives in the spatial domain transform as follows:\n$$\n\\mathcal{F}\\left\\{\\frac{\\partial n}{\\partial x}\\right\\} = ik \\hat{n}(k,t)\n$$\n$$\n\\mathcal{F}\\left\\{\\frac{\\partial^2 n}{\\partial x^2}\\right\\} = (ik)^2 \\hat{n}(k,t) = -k^2 \\hat{n}(k,t)\n$$\nApplying the Fourier transform to the entire PDE, we convert it into an ordinary differential equation (ODE) in time for $\\hat{n}(k,t)$:\n$$\n\\frac{d\\hat{n}}{dt} = D(-k^2 \\hat{n}) - v_d(ik \\hat{n}) - \\frac{\\hat{n}}{\\tau}\n$$\n$$\n\\frac{d\\hat{n}}{dt} = -\\left(Dk^2 + ikv_d + \\frac{1}{\\tau}\\right) \\hat{n}\n$$\nThis is a first-order linear homogeneous ODE with respect to $t$. The solution is of the form $\\hat{n}(k,t) = C(k) \\exp(\\lambda t)$, where $\\lambda = -(Dk^2 + ikv_d + 1/\\tau)$. The constant of integration, $C(k)$, is determined by the initial condition. The general solution is:\n$$\n\\hat{n}(k,t) = \\hat{n}(k,0) \\exp\\left(-\\left(Dk^2 + ikv_d + \\frac{1}{\\tau}\\right)t\\right)\n$$\nThe initial condition is $n(x,0) = \\delta(x-x_0)$. Its Fourier transform is:\n$$\n\\hat{n}(k,0) = \\int_{-\\infty}^{\\infty} \\delta(x-x_0) e^{-ikx} dx = e^{-ikx_0}\n$$\nSubstituting this into the solution for $\\hat{n}(k,t)$:\n$$\n\\hat{n}(k,t) = e^{-ikx_0} \\exp\\left(-Dk^2 t - ikv_d t - \\frac{t}{\\tau}\\right)\n$$\nWe can group the terms in the exponent:\n$$\n\\hat{n}(k,t) = \\exp\\left(-Dtk^2 - ik(x_0 + v_d t) - \\frac{t}{\\tau}\\right)\n$$\nTo find $n(x,t)$, we must now perform the inverse Fourier transform:\n$$\nn(x,t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\hat{n}(k,t) e^{ikx} dk\n$$\n$$\nn(x,t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp\\left(-Dtk^2 - ik(x_0 + v_d t) - \\frac{t}{\\tau}\\right) e^{ikx} dk\n$$\nThe term $\\exp(-t/\\tau)$ is independent of $k$ and can be factored out of the integral.\n$$\nn(x,t) = \\frac{e^{-t/\\tau}}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp\\left(-Dtk^2 - ik(x_0 + v_d t - x)\\right) dk\n$$\nThe integral is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} e^{-ak^2 - bk} dk$, where $a=Dt$ and $b=i(x_0 + v_d t - x)$. We solve this by completing the square in the exponent:\n$$\n-ak^2 - bk = -a\\left(k^2 + \\frac{b}{a}k\\right) = -a\\left(k + \\frac{b}{2a}\\right)^2 + \\frac{b^2}{4a}\n$$\nThe integral becomes:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-a\\left(k + \\frac{b}{2a}\\right)^2 + \\frac{b^2}{4a}\\right) dk = e^{b^2/4a} \\int_{-\\infty}^{\\infty} e^{-a(k + b/2a)^2} dk\n$$\nThe remaining integral is a standard Gaussian integral, $\\int_{-\\infty}^{\\infty} e^{-az^2}dz = \\sqrt{\\frac{\\pi}{a}}$. Thus, the integral evaluates to $\\sqrt{\\frac{\\pi}{a}}e^{b^2/4a}$.\nSubstituting $a = Dt$ and $b = i(x_0 + v_d t - x)$:\n$$\n\\frac{b^2}{4a} = \\frac{(i(x_0 + v_d t - x))^2}{4Dt} = \\frac{- (x_0 + v_d t - x)^2}{4Dt} = - \\frac{(x - x_0 - v_d t)^2}{4Dt}\n$$\nSo the integral value is:\n$$\n\\sqrt{\\frac{\\pi}{Dt}} \\exp\\left(-\\frac{(x - x_0 - v_d t)^2}{4Dt}\\right)\n$$\nSubstituting this back into the expression for $n(x,t)$:\n$$\nn(x,t) = \\frac{e^{-t/\\tau}}{2\\pi} \\left( \\sqrt{\\frac{\\pi}{Dt}} \\exp\\left(-\\frac{(x - x_0 - v_d t)^2}{4Dt}\\right) \\right)\n$$\nSimplifying and replacing $v_d$ with $\\mu E$:\n$$\nn(x,t) = \\frac{1}{2\\sqrt{\\pi Dt}} \\exp\\left(-\\frac{(x - x_0 - \\mu E t)^2}{4Dt}\\right) e^{-t/\\tau}\n$$\nThis can be written more compactly by combining the exponential terms. This function $n(x,t)$ is the requested fundamental solution (Green's function), $G(x,t;x_0)$.\n$$\nG(x,t;x_0) = \\frac{1}{\\sqrt{4\\pi Dt}} \\exp\\left(-\\frac{(x - x_0 - \\mu E t)^2}{4Dt} - \\frac{t}{\\tau}\\right)\n$$\nThis solution represents a Gaussian packet whose center drifts with velocity $\\mu E$, spreads diffusively with time as $\\sqrt{t}$, and whose total amplitude decays exponentially due to recombination with lifetime $\\tau$.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{4\\pi Dt}} \\exp\\left(-\\frac{(x - x_0 - \\mu E t)^2}{4Dt} - \\frac{t}{\\tau}\\right)}\n$$"
        },
        {
            "introduction": "Real-world experiments rarely conform to perfectly uniform conditions. This exercise challenges you to extend the ideal model to a more realistic scenario involving a spatially varying temperature profile, where transport coefficients like mobility $\\mu$ and diffusion coefficient $D$ are no longer constant. By analyzing the evolution of the carrier packet's statistical moments, you will discover how the apparent ratio $D_{\\text{app}}/\\mu_{\\text{app}}$ relates to the average temperature along the transit path. This problem provides a powerful lesson in how to handle non-uniformities and connects the macroscopic measurement to an average of microscopic properties.",
            "id": "3779266",
            "problem": "A pulse-based Haynes–Shockley (HS) measurement is performed on a one-dimensional $n$-type semiconductor bar of length $L$, along which a uniform electric field $E$ is applied in the $+x$ direction. A narrow minority-carrier packet is injected at $x=0$ at time $t=0$, and the packet is collected at $x=L$. The bar is held under a controlled, spatially varying temperature profile $T(x)$ that is stationary in time and varies slowly enough in space that transport coefficients can be regarded as locally defined. Assume low injection, nondegenerate statistics, negligible recombination over the transit (i.e., the carrier lifetime satisfies $\\tau \\gg L/(\\mu E)$), and negligible thermoelectric fields and band-edge shifts so that the local Einstein relation holds. Let the local drift mobility and diffusion coefficient be denoted by $\\mu(T(x))$ and $D(T(x))$, respectively, and assume the local Einstein relation $D(x)/\\mu(x) = k_B T(x)/q$, where $k_B$ is the Boltzmann constant and $q$ is the elementary charge.\n\nDefine the measured drift time $t_d$ to be the time at which the packet’s center-of-mass reaches $x=L$, and define the packet’s second central moment about its center-of-mass at arrival to be $\\sigma^2$, extracted from the HS signal at the collector. The apparent transport parameters used in standard HS analysis are defined by $D_{\\mathrm{app}} \\equiv \\sigma^2/(2 t_d)$ and $\\mu_{\\mathrm{app}} \\equiv L/(E t_d)$. Starting from the drift–diffusion description and fundamental definitions of the first and second moments of the carrier packet, derive an expression for the apparent ratio $D_{\\mathrm{app}}/\\mu_{\\mathrm{app}}$ in terms of $T(x)$ by integrating along the transit path. Then, for a linear temperature profile $T(x) = T_0 + \\alpha x$ with constants $T_0 > 0$ and $\\alpha$ satisfying $|\\alpha| L \\ll T_0$, obtain a closed-form analytic expression for $D_{\\mathrm{app}}/\\mu_{\\mathrm{app}}$ in terms of $k_B$, $q$, $T_0$, $\\alpha$, and $L$.\n\nExpress your final answer for the ratio $D_{\\mathrm{app}}/\\mu_{\\mathrm{app}}$ in Volts. No numerical values need be substituted. The final answer must be a single closed-form expression.",
            "solution": "The user wants me to solve a problem on the Haynes-Shockley experiment with a non-uniform temperature profile.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **System**: One-dimensional $n$-type semiconductor bar of length $L$.\n-   **Applied Field**: Uniform electric field $E$ in the $+x$ direction.\n-   **Injection**: A narrow minority-carrier packet is injected at $x=0$ at time $t=0$.\n-   **Collection**: The packet is collected at $x=L$.\n-   **Temperature Profile**: A stationary, spatially varying temperature profile $T(x)$ that varies slowly.\n-   **Assumptions**:\n    1.  Low injection level.\n    2.  Non-degenerate statistics.\n    3.  Negligible recombination: carrier lifetime $\\tau \\gg L/(\\mu E)$.\n    4.  Negligible thermoelectric fields and band-edge shifts.\n-   **Definitions**:\n    1.  Local drift mobility: $\\mu(T(x)) \\equiv \\mu(x)$.\n    2.  Local diffusion coefficient: $D(T(x)) \\equiv D(x)$.\n    3.  Local Einstein relation: $\\frac{D(x)}{\\mu(x)} = \\frac{k_B T(x)}{q}$, where $k_B$ is the Boltzmann constant and $q$ is the elementary charge.\n    4.  Measured drift time $t_d$: time at which the packet’s center-of-mass reaches $x=L$.\n    5.  Packet's second central moment at arrival: $\\sigma^2$.\n    6.  Apparent diffusion coefficient: $D_{\\mathrm{app}} \\equiv \\frac{\\sigma^2}{2 t_d}$.\n    7.  Apparent mobility: $\\mu_{\\mathrm{app}} \\equiv \\frac{L}{E t_d}$.\n-   **Specific Profile**: Linear temperature profile $T(x) = T_0 + \\alpha x$, with constraints $T_0 > 0$ and $|\\alpha| L \\ll T_0$.\n\n**1.2. Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded**: The problem is based on the well-established drift-diffusion model for charge transport in semiconductors, a cornerstone of solid-state physics. The Haynes-Shockley experiment is a classic method for measuring carrier mobility and diffusion. The inclusion of a temperature gradient is a valid and interesting extension. All principles are sound.\n2.  **Well-Posed**: The problem is well-posed. The assumptions, such as \"slowly varying\" temperature and \"narrow packet,\" are crucial for making the problem analytically tractable and lead to a unique solution.\n3.  **Objective**: The language is precise and quantitative. All terms are standard in semiconductor physics.\n4.  **Completeness and Consistency**: The problem provides all necessary physical laws, definitions, and boundary conditions to derive the requested quantities. The constraint $|\\alpha| L \\ll T_0$ is consistent with the assumption of a slowly varying temperature.\n5.  **Feasibility**: A controlled temperature gradient across a semiconductor bar is physically realizable in a laboratory setting.\n6.  **Other Flaws**: The problem is not trivial, metaphorical, or unverifiable. It is a substantive theoretical physics problem.\n\n**1.3. Verdict and Action**\n\nThe problem is valid. I will proceed to the solution.\n\n### Step 2: Derivation of the physical model and expressions\n\nThe evolution of the minority carrier packet (holes, in this $n$-type material), denoted by the concentration $p(x,t)$, is described by the one-dimensional drift-diffusion equation. Given that recombination is negligible, the continuity equation is:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} + \\frac{\\partial j_p(x,t)}{\\partial x} = 0\n$$\nwhere $j_p(x,t)$ is the particle current density. This current density has two components: drift due to the electric field $E$ and diffusion due to the concentration gradient.\n$$\nj_p(x,t) = p(x,t) v_d(x) - D(x) \\frac{\\partial p(x,t)}{\\partial x}\n$$\nThe drift velocity $v_d(x)$ is given by $v_d(x) = \\mu(x)E$. The transport coefficients $\\mu(x)$ and $D(x)$ are functions of position via their dependence on the temperature $T(x)$.\n\nThe center-of-mass of the packet, $\\bar{x}(t)$, is the first moment of the distribution:\n$$\n\\bar{x}(t) = \\frac{\\int_{-\\infty}^{\\infty} x p(x,t) dx}{\\int_{-\\infty}^{\\infty} p(x,t) dx}\n$$\nFor a narrow packet, we can approximate the velocity of the center-of-mass by the local drift velocity at that point:\n$$\n\\frac{d\\bar{x}}{dt} = v_d(\\bar{x}(t)) = E \\mu(\\bar{x}(t))\n$$\nThe drift time $t_d$ is the time taken for the center-of-mass to travel from $x=0$ to $x=L$. We can find this by integrating the reciprocal of the velocity over the path:\n$$\n\\int_0^{t_d} dt = \\int_0^L \\frac{d\\bar{x}}{E\\mu(\\bar{x})} \\implies t_d = \\frac{1}{E} \\int_0^L \\frac{dx'}{\\mu(x')}\n$$\n\nThe spreading of the packet is characterized by its variance, or second central moment, $\\sigma^2(t) = \\langle(x-\\bar{x}(t))^2\\rangle$. The initial packet is narrow, so we take $\\sigma^2(0)=0$. The rate of change of the variance is due to diffusion. For a narrow packet moving through a medium where the diffusion coefficient $D(x)$ varies slowly, the rate of spreading is governed by the local diffusion coefficient at the packet's center. This is a key approximation justified by the problem statement. Other effects, related to the gradients of $\\mu$ and $D$, are second-order and negligible under the \"slowly varying\" condition.\n$$\n\\frac{d\\sigma^2}{dt} \\approx 2D(\\bar{x}(t))\n$$\nTo find the total accumulated variance $\\sigma^2$ at the time of arrival $t_d$, we integrate this expression from $t=0$ to $t=t_d$:\n$$\n\\sigma^2 = \\sigma^2(t_d) = \\int_0^{t_d} 2D(\\bar{x}(t)) dt\n$$\nWe can change the variable of integration from time $t$ to position $x$ using the relation $dt = d\\bar{x}/(E\\mu(\\bar{x}))$. The integration limits for $x$ are from $0$ to $L$. Let's use $x'$ as the integration variable for clarity.\n$$\n\\sigma^2 = \\int_0^L 2D(x') \\frac{dx'}{E\\mu(x')} = \\frac{2}{E} \\int_0^L \\frac{D(x')}{\\mu(x')} dx'\n$$\n\nNow we can compute the ratio of the apparent transport parameters, $D_{\\mathrm{app}}/\\mu_{\\mathrm{app}}$. Using their definitions:\n$$\n\\frac{D_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}} = \\frac{\\sigma^2 / (2t_d)}{L / (Et_d)} = \\frac{E \\sigma^2}{2L}\n$$\nSubstituting our derived expression for $\\sigma^2$:\n$$\n\\frac{D_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}} = \\frac{E}{2L} \\left( \\frac{2}{E} \\int_0^L \\frac{D(x')}{\\mu(x')} dx' \\right) = \\frac{1}{L} \\int_0^L \\frac{D(x')}{\\mu(x')} dx'\n$$\nThis is a general result. The measured ratio is the spatial average of the local ratio of the transport coefficients.\n\nWe now use the local Einstein relation, $D(x)/\\mu(x) = k_B T(x)/q$, which is assumed to hold.\n$$\n\\frac{D_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}} = \\frac{1}{L} \\int_0^L \\frac{k_B T(x')}{q} dx' = \\frac{k_B}{qL} \\int_0^L T(x') dx'\n$$\nThis expression shows that the measured ratio $D_{\\mathrm{app}}/\\mu_{\\mathrmapp}$ is proportional to the average temperature over the length of the bar.\n\n### Step 3: Calculation for the Linear Temperature Profile\n\nThe problem specifies a linear temperature profile, $T(x) = T_0 + \\alpha x$. We compute the integral:\n$$\n\\int_0^L T(x') dx' = \\int_0^L (T_0 + \\alpha x') dx' = \\left[ T_0 x' + \\frac{1}{2}\\alpha(x')^2 \\right]_0^L = T_0 L + \\frac{1}{2}\\alpha L^2\n$$\nSubstituting this result into our expression for $D_{\\mathrm{app}}/\\mu_{\\mathrm{app}}$:\n$$\n\\frac{D_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}} = \\frac{k_B}{qL} \\left( T_0 L + \\frac{1}{2}\\alpha L^2 \\right)\n$$\nSimplifying the expression by factoring out $L$:\n$$\n\\frac{D_{\\mathrm{app}}}{\\mu_{\\mathrm{app}}} = \\frac{k_B}{q} \\left( T_0 + \\frac{1}{2}\\alpha L \\right)\n$$\nThe quantity $k_B T/q$ has units of Volts (it is the thermal voltage). Therefore, the final expression is in the correct units. The result is a closed-form analytic expression in terms of the given constants.",
            "answer": "$$\\boxed{\\frac{k_B}{q} \\left( T_0 + \\frac{1}{2}\\alpha L \\right)}$$"
        },
        {
            "introduction": "The classical Einstein relation, $D/\\mu = k_{\\mathrm{B}} T/q$, is a cornerstone of semiconductor device physics, but its validity is restricted to non-degenerate materials. In heavily doped semiconductors, where Fermi-Dirac statistics are necessary, this relation must be replaced by a generalized form involving Fermi-Dirac integrals. This computational practice requires you to quantify the significant errors that arise from misapplying the classical relation in a degenerate system. By implementing a numerical model, you will bridge the gap between quantum statistical mechanics and the practical interpretation of experimental data, a crucial skill in modern device modeling.",
            "id": "3779282",
            "problem": "Consider a one-dimensional carrier packet injected at position $x=0$ and time $t=0$ in a uniformly doped semiconductor, subjected to a constant electric field $E$. In the Haynes-Shockley experiment (HSE), the evolution of the packet is governed by drift and diffusion. Under the drift-diffusion model with constant coefficients, the carrier density $n(x,t)$ satisfies the partial differential equation\n$$\n\\frac{\\partial n}{\\partial t} = D \\frac{\\partial^2 n}{\\partial x^2} - \\mu E \\frac{\\partial n}{\\partial x} - \\frac{n}{\\tau},\n$$\nwhere $D$ is the diffusion coefficient, $\\mu$ is the mobility, $E$ is the electric field, and $\\tau$ is the recombination lifetime. For an initial narrow Gaussian packet with standard deviation $\\sigma_0$, the packet remains Gaussian, drifts with mean $\\langle x \\rangle = \\mu E t$, and broadens with standard deviation\n$$\n\\sigma(t) = \\sqrt{\\sigma_0^2 + 2 D t}.\n$$\nIn nondegenerate (Maxwell-Boltzmann) statistics, the classical Einstein relation $D/\\mu = k_{\\mathrm{B}} T/q$ holds, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $q$ is the elementary charge. When the carrier gas is degenerate (Fermi-Dirac statistics), the generalized Einstein relation is required:\n$$\n\\frac{D}{\\mu} = \\frac{k_{\\mathrm{B}} T}{q} \\, g(\\eta),\n$$\nwhere $\\eta$ is the reduced Fermi level and $g(\\eta)$ is the generalized Einstein factor. For a three-dimensional parabolic band with Fermi-Dirac statistics, the generalized Einstein factor can be expressed via normalized Fermi-Dirac integrals as\n$$\ng(\\eta) = \\frac{F_{1/2}^{\\mathrm{N}}(\\eta)}{F_{-1/2}^{\\mathrm{N}}(\\eta)},\n$$\nwith\n$$\nF_{j}^{\\mathrm{N}}(\\eta) = \\frac{1}{\\Gamma(j+1)} \\int_{0}^{\\infty} \\frac{\\epsilon^{j}}{1 + \\exp(\\epsilon - \\eta)} \\, d\\epsilon,\n$$\nwhere $\\Gamma(\\cdot)$ is the Gamma function.\n\nYour task is to quantify the error in $D$ and $\\mu$ extracted under the classical Einstein assumption when the carrier gas is degenerate by simulating expected deviations in pulse width. For each test case, compute:\n\n1. The true diffusion coefficient $D_{\\text{true}} = \\mu \\, (k_{\\mathrm{B}} T/q) \\, g(\\eta)$.\n\n2. The classically predicted diffusion coefficient $D_{\\text{classical}} = \\mu \\, (k_{\\mathrm{B}} T/q)$ that an analyst would assume if using the classical Einstein relation.\n\n3. The relative error in diffusion coefficient under the classical assumption:\n$$\ne_D = \\frac{D_{\\text{classical}} - D_{\\text{true}}}{D_{\\text{true}}}.\n$$\n\n4. The relative error in mobility if an analyst infers $\\mu$ from the measured width using the classical Einstein relation (i.e., uses $\\mu_{\\text{wrong}} = D_{\\text{true}} \\, q / (k_{\\mathrm{B}} T)$):\n$$\ne_{\\mu} = \\frac{\\mu_{\\text{wrong}} - \\mu}{\\mu}.\n$$\n\n5. The relative deviation in the standard deviation of the packet at time $t$ when using the classical prediction for width versus the true width:\n$$\ne_{\\sigma} = \\frac{\\sigma_{\\text{classical}} - \\sigma_{\\text{true}}}{\\sigma_{\\text{true}}},\n$$\nwith\n$$\n\\sigma_{\\text{true}} = \\sqrt{\\sigma_0^2 + 2 D_{\\text{true}} t}, \\quad \\sigma_{\\text{classical}} = \\sqrt{\\sigma_0^2 + 2 D_{\\text{classical}} t}.\n$$\n\nAll physical quantities must be handled in the International System of Units (SI): temperature in $\\mathrm{K}$, time in $\\mathrm{s}$, mobility in $\\mathrm{m}^2/\\mathrm{V}\\cdot\\mathrm{s}$, diffusion coefficient in $\\mathrm{m}^2/\\mathrm{s}$, and standard deviation (width) in $\\mathrm{m}$.\n\nUse the following test suite, which explores nondegenerate, moderate, and strong degeneracy regimes, as well as a short-time boundary case:\n\n- Test Case 1 (nondegenerate limit check): $T = 300$ $\\mathrm{K}$, $\\eta = -5$, $\\mu = 0.135$ $\\mathrm{m}^2/\\mathrm{V}\\cdot\\mathrm{s}$, $t = 1.0 \\times 10^{-6}$ $\\mathrm{s}$, $\\sigma_0 = 1.0 \\times 10^{-6}$ $\\mathrm{m}$.\n\n- Test Case 2 (moderate degeneracy): $T = 300$ $\\mathrm{K}$, $\\eta = 0$, $\\mu = 0.050$ $\\mathrm{m}^2/\\mathrm{V}\\cdot\\mathrm{s}$, $t = 5.0 \\times 10^{-6}$ $\\mathrm{s}$, $\\sigma_0 = 0$ $\\mathrm{m}$.\n\n- Test Case 3 (strong degeneracy): $T = 300$ $\\mathrm{K}$, $\\eta = 5$, $\\mu = 0.020$ $\\mathrm{m}^2/\\mathrm{V}\\cdot\\mathrm{s}$, $t = 1.0 \\times 10^{-5}$ $\\mathrm{s}$, $\\sigma_0 = 5.0 \\times 10^{-7}$ $\\mathrm{m}$.\n\n- Test Case 4 (short-time boundary): $T = 200$ $\\mathrm{K}$, $\\eta = 3$, $\\mu = 0.100$ $\\mathrm{m}^2/\\mathrm{V}\\cdot\\mathrm{s}$, $t = 1.0 \\times 10^{-9}$ $\\mathrm{s}$, $\\sigma_0 = 1.0 \\times 10^{-6}$ $\\mathrm{m}$.\n\nYour program should produce a single line of output containing one entry per test case. Each entry must be the list $[e_D, e_{\\mu}, e_{\\sigma}]$ using floating-point numbers. Aggregate the entries into a single comma-separated list enclosed in square brackets, for example, $[[e_{D1},e_{\\mu1},e_{\\sigma1}],[e_{D2},e_{\\mu2},e_{\\sigma2}],\\dots]$. The program must compute normalized Fermi-Dirac integrals numerically to obtain $g(\\eta)$ and may use numerical quadrature. No user input should be required, and the output must strictly follow the specified format.",
            "solution": "The problem statement has been meticulously reviewed and is determined to be valid. It is scientifically grounded in the principles of semiconductor carrier transport, well-posed with a clear and complete set of definitions and parameters, and computationally tractable. The problem requires quantifying the errors incurred by applying the classical Einstein relation to a degenerate carrier gas, a conceptually significant task in semiconductor physics. We will now proceed with a formal solution.\n\nThe core of the problem lies in the distinction between the classical Einstein relation, valid for nondegenerate semiconductors, and the generalized Einstein relation, required for degenerate semiconductors. The relationship between the diffusion coefficient $D$ and the mobility $\\mu$ is given by:\n$$\n\\frac{D}{\\mu} = \\frac{k_{\\mathrm{B}} T}{q}\n$$\nfor the classical (nondegenerate) case, and\n$$\n\\frac{D}{\\mu} = \\frac{k_{\\mathrm{B}} T}{q} \\, g(\\eta)\n$$\nfor the generalized (degenerate) case. Here, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, $q$ is the elementary charge, and $g(\\eta)$ is the generalized Einstein factor, which depends on the reduced Fermi level $\\eta = (E_F - E_C)/(k_{\\mathrm{B}} T)$, where $E_F$ is the Fermi level and $E_C$ is the conduction band edge energy. For $\\eta \\ll 0$, the system is nondegenerate and $g(\\eta) \\to 1$, recovering the classical relation. For $\\eta > 0$, the system is degenerate and $g(\\eta)$ deviates from $1$.\n\nFor a three-dimensional parabolic band structure, the factor $g(\\eta)$ is given by the ratio of normalized Fermi-Dirac integrals:\n$$\ng(\\eta) = \\frac{F_{1/2}^{\\mathrm{N}}(\\eta)}{F_{-1/2}^{\\mathrm{N}}(\\eta)}\n$$\nwhere the normalized Fermi-Dirac integral of order $j$ is defined as:\n$$\nF_{j}^{\\mathrm{N}}(\\eta) = \\frac{1}{\\Gamma(j+1)} \\int_{0}^{\\infty} \\frac{\\epsilon^{j}}{1 + \\exp(\\epsilon - \\eta)} \\, d\\epsilon,\n$$\nand $\\Gamma(\\cdot)$ is the Gamma function.\n\nThe computational procedure for each test case involves the following steps:\n\n1.  **Calculate the Generalized Einstein Factor $g(\\eta)$**: This requires numerical computation of two integrals. We define the unnormalized Fermi-Dirac integral as $I_j(\\eta) = \\int_{0}^{\\infty} \\frac{\\epsilon^{j}}{1 + \\exp(\\epsilon - \\eta)} \\, d\\epsilon$. Then, the factor $g(\\eta)$ can be expressed as:\n    $$\n    g(\\eta) = \\frac{I_{1/2}(\\eta) / \\Gamma(1/2+1)}{I_{-1/2}(\\eta) / \\Gamma(-1/2+1)} = \\frac{I_{1/2}(\\eta)}{I_{-1/2}(\\eta)} \\frac{\\Gamma(1/2)}{\\Gamma(3/2)}\n    $$\n    Using the property $\\Gamma(z+1)=z\\Gamma(z)$, we have $\\Gamma(3/2) = (1/2)\\Gamma(1/2)$. This simplifies the expression to:\n    $$\n    g(\\eta) = 2 \\frac{I_{1/2}(\\eta)}{I_{-1/2}(\\eta)} = 2 \\frac{\\int_{0}^{\\infty} \\frac{\\epsilon^{1/2}}{1 + \\exp(\\epsilon - \\eta)} \\, d\\epsilon}{\\int_{0}^{\\infty} \\frac{\\epsilon^{-1/2}}{1 + \\exp(\\epsilon - \\eta)} \\, d\\epsilon}\n    $$\n    These integrals will be computed using numerical quadrature.\n\n2.  **Calculate Diffusion Coefficients**: Given the true mobility $\\mu$, the thermal voltage $V_T = k_{\\mathrm{B}} T/q$, and the computed $g(\\eta)$, we find:\n    *   The true diffusion coefficient: $D_{\\text{true}} = \\mu V_T g(\\eta)$.\n    *   The classically assumed diffusion coefficient: $D_{\\text{classical}} = \\mu V_T$.\n\n3.  **Calculate Relative Errors**: We compute the three requested relative errors.\n    *   **Error in Diffusion Coefficient ($e_D$)**: This error arises from assuming $g(\\eta)=1$.\n        $$\n        e_D = \\frac{D_{\\text{classical}} - D_{\\text{true}}}{D_{\\text{true}}} = \\frac{\\mu V_T - \\mu V_T g(\\eta)}{\\mu V_T g(\\eta)} = \\frac{1 - g(\\eta)}{g(\\eta)} = \\frac{1}{g(\\eta)} - 1\n        $$\n    *   **Error in Mobility ($e_{\\mu}$)**: This error represents the mistake an analyst would make if they measured $D_{\\text{true}}$ (e.g., from packet broadening) and inferred mobility using the classical relation $\\mu_{\\text{wrong}} = D_{\\text{true}} / V_T$.\n        $$\n        \\mu_{\\text{wrong}} = \\frac{\\mu V_T g(\\eta)}{V_T} = \\mu g(\\eta) \\\\\n        e_{\\mu} = \\frac{\\mu_{\\text{wrong}} - \\mu}{\\mu} = \\frac{\\mu g(\\eta) - \\mu}{\\mu} = g(\\eta) - 1\n        $$\n        Note the useful relation $(1+e_D)(1+e_{\\mu})=1$.\n    *   **Error in Packet Width ($e_{\\sigma}$)**: This error compares the predicted packet standard deviation under the classical assumption to the true value.\n        $$\n        e_{\\sigma} = \\frac{\\sigma_{\\text{classical}} - \\sigma_{\\text{true}}}{\\sigma_{\\text{true}}} = \\frac{\\sqrt{\\sigma_0^2 + 2 D_{\\text{classical}} t}}{\\sqrt{\\sigma_0^2 + 2 D_{\\text{true}} t}} - 1\n        $$\n        where $\\sigma_0$ is the initial packet width and $t$ is the measurement time.\n\nThe implementation will use physical constants from `scipy.constants` and the numerical quadrature function `scipy.integrate.quad` to evaluate the Fermi-Dirac integrals for each set of parameters provided in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Calculates errors in diffusion coefficient and mobility under the classical\n    Einstein assumption for a degenerate semiconductor.\n    \"\"\"\n\n    # Physical constants from scipy in SI units\n    k_B = constants.k  # Boltzmann constant in J/K\n    q = constants.e    # Elementary charge in C\n\n    def fermi_dirac_integral(j, eta):\n        \"\"\"\n        Computes the unnormalized Fermi-Dirac integral of order j for a given\n        reduced Fermi level eta.\n        I_j(eta) = integral from 0 to inf of [eps^j / (1 + exp(eps - eta))] depsilon.\n        \"\"\"\n        integrand = lambda eps: np.power(eps, j) / (1.0 + np.exp(eps - eta))\n        # The integral for j=-0.5 has an integrable singularity at eps=0,\n        # which quad can handle.\n        result, _ = integrate.quad(integrand, 0, np.inf)\n        return result\n\n    def g_factor(eta):\n        \"\"\"\n        Calculates the generalized Einstein factor g(eta).\n        g(eta) = 2 * I_{1/2}(eta) / I_{-1/2}(eta)\n        \"\"\"\n        # For very non-degenerate cases, g(eta) -> 1. This avoids numerical\n        # issues with large exp(-eta) and speeds up computation.\n        if eta < -20:\n            return 1.0\n        \n        I_half = fermi_dirac_integral(0.5, eta)\n        I_neg_half = fermi_dirac_integral(-0.5, eta)\n\n        # Avoid division by zero, though I_neg_half should always be positive.\n        if I_neg_half == 0:\n            return np.inf # Or handle as an error\n            \n        return 2.0 * I_half / I_neg_half\n\n    # Test cases from the problem statement:\n    # (T [K], eta, mu [m^2/V.s], t [s], sigma_0 [m])\n    test_cases = [\n        (300.0, -5.0, 0.135, 1.0e-6, 1.0e-6),   # Nondegenerate limit\n        (300.0, 0.0, 0.050, 5.0e-6, 0.0),       # Moderate degeneracy\n        (300.0, 5.0, 0.020, 1.0e-5, 5.0e-7),    # Strong degeneracy\n        (200.0, 3.0, 0.100, 1.0e-9, 1.0e-6),    # Short-time boundary\n    ]\n\n    results = []\n    for case in test_cases:\n        T, eta, mu, t, sigma_0 = case\n\n        # Calculate the thermal voltage V_T = k_B * T / q\n        V_T = k_B * T / q\n\n        # Step 1: Calculate the generalized Einstein factor g(eta)\n        g = g_factor(eta)\n\n        # Step 2: Calculate diffusion coefficients\n        D_true = mu * V_T * g\n        D_classical = mu * V_T\n\n        # Step 3: Calculate relative errors\n        # Relative error in diffusion coefficient\n        e_D = 1.0 / g - 1.0\n\n        # Relative error in mobility\n        e_mu = g - 1.0\n\n        # Relative deviation in standard deviation\n        sigma_sq_true = sigma_0**2 + 2 * D_true * t\n        sigma_sq_classical = sigma_0**2 + 2 * D_classical * t\n\n        if sigma_sq_true == 0:\n            # This case happens if sigma_0=0 and t=0, which is not in test cases.\n            # If sigma_classical is also 0, error is 0. Otherwise inf.\n            e_sigma = 0.0 if sigma_sq_classical == 0 else np.inf\n        else:\n            e_sigma = np.sqrt(sigma_sq_classical / sigma_sq_true) - 1.0\n        \n        results.append([e_D, e_mu, e_sigma])\n\n    # Final print statement in the exact required format.\n    # The format [[a,b,c],[d,e,f]] is achieved by joining string representations\n    # of the inner lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}