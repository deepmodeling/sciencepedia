{
    "hands_on_practices": [
        {
            "introduction": "The interaction between mobile carriers and a fixed charged impurity is not a simple one-on-one Coulomb encounter; the surrounding sea of carriers dynamically rearranges to shield, or \"screen,\" the impurity's charge. This exercise  provides a foundational practice in deriving the mathematical description of this screening effect from first principles. By linearizing the carrier response to the impurity's potential, you will derive the Debye wavevector, a cornerstone concept that dictates the spatial range of the interaction and underpins the widely used Brooks-Herring model for ionized impurity scattering.",
            "id": "3756942",
            "problem": "A doped semiconductor at uniform temperature $T$ contains mobile charge carriers with total equilibrium density $n$ (the sum of equilibrium electron and hole densities). The material is nondegenerate so that the carriers obey Maxwell–Boltzmann statistics, and the electrostatics can be described within the linear response regime. The host lattice provides a spatially uniform dielectric environment characterized by permittivity $\\varepsilon=\\varepsilon_0 \\varepsilon_r$, where $\\varepsilon_0$ is the vacuum permittivity and $\\varepsilon_r$ is the relative dielectric constant.\n\nConsider introducing a weak, static, point-like ion of charge $Z e$ at the origin. Starting from the Poisson equation relating the electrostatic potential $\\phi(\\mathbf{r})$ to the charge density, and the Maxwell–Boltzmann dependence of the local carrier densities on the electrostatic potential, derive the linearized equation governing $\\phi(\\mathbf{r})$ by explicitly obtaining the first-order change in mobile charge density induced by $\\phi(\\mathbf{r})$. From this, identify the screening wavevector $k_D$ in the nondegenerate limit and provide the closed-form analytic expression for $k_D^2$ in terms of $e$, $n$, $\\varepsilon_0$, $\\varepsilon_r$, $k_B$, and $T$.\n\nFinally, briefly interpret how $k_D$ depends on $T$ and $n$ within the context of ionized impurity scattering, focusing on how changes in $T$ and $n$ modify the spatial range of the screened Coulomb potential and thus the qualitative strength of long-range scattering. Express your final result for $k_D^2$ as a single analytic expression. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective, representing a standard derivation in semiconductor physics.\n\nWe begin with the Poisson equation, which relates the electrostatic potential $\\phi(\\mathbf{r})$ to the total charge density $\\rho_{\\text{total}}(\\mathbf{r})$ in a medium with uniform dielectric permittivity $\\varepsilon = \\varepsilon_0 \\varepsilon_r$:\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho_{\\text{total}}(\\mathbf{r})}{\\varepsilon}\n$$\nThe total charge density is the sum of the charge density of the fixed point-like ion, $\\rho_{\\text{ion}}(\\mathbf{r})$, and the induced change in the mobile charge carrier density, $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$. The fixed ion of charge $Z e$ at the origin is represented by a Dirac delta function:\n$$\n\\rho_{\\text{ion}}(\\mathbf{r}) = Z e \\delta(\\mathbf{r})\n$$\nThe mobile charge carriers consist of electrons and holes. In the absence of the perturbing potential $\\phi(\\mathbf{r})$, the semiconductor is electrically neutral with uniform equilibrium densities of electrons, $n_0$, and holes, $p_0$. The problem states that the total equilibrium density of mobile carriers is $n = n_0 + p_0$.\n\nWhen the potential $\\phi(\\mathbf{r})$ is present, the local densities of electrons, $n(\\mathbf{r})$, and holes, $p(\\mathbf{r})$, are modulated. Since the carriers are nondegenerate, their local densities are described by Maxwell–Boltzmann statistics:\n$$\nn(\\mathbf{r}) = n_0 \\exp\\left(\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right)\n$$\n$$\np(\\mathbf{r}) = p_0 \\exp\\left(-\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right)\n$$\nwhere $-e$ is the electron charge, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. The local mobile charge density is therefore:\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) = e(p(\\mathbf{r}) - n(\\mathbf{r})) = e \\left[ p_0 \\exp\\left(-\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) - n_0 \\exp\\left(\\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) \\right]\n$$\nThe problem specifies that we are in the linear response regime, which corresponds to a weak potential, i.e., $|e \\phi(\\mathbf{r})| \\ll k_B T$. This justifies a first-order Taylor expansion of the exponential functions, $\\exp(x) \\approx 1 + x$ for small $x$. Applying this linearization yields:\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) \\approx e \\left[ p_0 \\left(1 - \\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) - n_0 \\left(1 + \\frac{e \\phi(\\mathbf{r})}{k_B T}\\right) \\right]\n$$\n$$\n\\rho_{\\text{mobile}}(\\mathbf{r}) \\approx e(p_0 - n_0) - \\frac{e^2}{k_B T}(p_0 + n_0) \\phi(\\mathbf{r})\n$$\nThe first term, $e(p_0 - n_0)$, represents the background mobile charge density, which is compensated by fixed, ionized dopants to ensure overall charge neutrality of the bulk material. The change in mobile charge density, $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$, is the second term, which is induced by the potential $\\phi(\\mathbf{r})$. This is the explicit first-order change requested:\n$$\n\\delta\\rho_{\\text{mobile}}(\\mathbf{r}) = -\\frac{e^2(p_0 + n_0)}{k_B T} \\phi(\\mathbf{r})\n$$\nUsing the given definition $n = n_0 + p_0$, this becomes:\n$$\n\\delta\\rho_{\\text{mobile}}(\\mathbf{r}) = -\\frac{n e^2}{k_B T} \\phi(\\mathbf{r})\n$$\nThe total charge density to be used in the Poisson equation is $\\rho_{\\text{total}}(\\mathbf{r}) = \\rho_{\\text{ion}}(\\mathbf{r}) + \\delta\\rho_{\\text{mobile}}(\\mathbf{r})$. Substituting this and the expression for $\\delta\\rho_{\\text{mobile}}(\\mathbf{r})$ into the Poisson equation, we get:\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\varepsilon} \\left( Z e \\delta(\\mathbf{r}) - \\frac{n e^2}{k_B T} \\phi(\\mathbf{r}) \\right)\n$$\nRearranging the terms, we obtain the linearized, screened Poisson equation:\n$$\n\\nabla^2 \\phi(\\mathbf{r}) - \\frac{n e^2}{\\varepsilon k_B T} \\phi(\\mathbf{r}) = -\\frac{Z e}{\\varepsilon} \\delta(\\mathbf{r})\n$$\nThis equation is of the general form $\\nabla^2 \\phi - k_D^2 \\phi = -\\rho_{\\text{ext}}/\\varepsilon$. By direct comparison, we can identify the square of the screening wavevector, $k_D^2$, as:\n$$\nk_D^2 = \\frac{n e^2}{\\varepsilon k_B T}\n$$\nSubstituting the expression for the permittivity, $\\varepsilon = \\varepsilon_0 \\varepsilon_r$, we arrive at the final closed-form expression for $k_D^2$:\n$$\nk_D^2 = \\frac{n e^2}{\\varepsilon_0 \\varepsilon_r k_B T}\n$$\nThe quantity $k_D$ is the Debye screening wavevector, and its inverse, $\\lambda_D = 1/k_D$, is the Debye screening length. The solution to the screened Poisson equation is a Yukawa or screened Coulomb potential, $\\phi(r) \\propto (1/r) \\exp(-k_D r)$, which shows that the potential decays at distances greater than $\\lambda_D$.\n\nThe dependence of $k_D$ on temperature $T$ and total mobile carrier density $n$ has a clear physical interpretation in the context of ionized impurity scattering.\n1.  **Dependence on $n$**: $k_D \\propto \\sqrt{n}$. An increase in the mobile carrier density $n$ leads to an increase in $k_D$ and therefore a decrease in the screening length $\\lambda_D$. With more mobile charges available, the screening of the impurity ion's Coulomb potential is more effective, and its influence is confined to a smaller spatial region. This makes the potential more short-ranged, weakening the effectiveness of long-range scattering.\n2.  **Dependence on $T$**: $k_D \\propto 1/\\sqrt{T}$. An increase in temperature $T$ provides the mobile carriers with greater thermal (kinetic) energy. They are less easily deflected or trapped by the impurity's potential. As a result, the screening cloud of carriers is more diffuse, and the screening is less effective. This corresponds to a decrease in $k_D$ and an increase in the screening length $\\lambda_D$. The potential becomes more long-ranged, which increases the scattering cross-section and thus enhances the strength of long-range ionized impurity scattering.",
            "answer": "$$\n\\boxed{\\frac{n e^2}{\\varepsilon_0 \\varepsilon_r k_B T}}\n$$"
        },
        {
            "introduction": "Beyond charged ions, neutral impurities also disrupt carrier transport, becoming particularly important at low temperatures where other scattering mechanisms weaken. This practice  delves into the classic Erginsoy model, which explains the characteristic temperature-independent mobility plateau observed in experiments. You will explore the specific energy dependence of the scattering cross-section that leads to this behavior and devise a procedure to extract the neutral impurity contribution from total mobility measurements, a common task in material characterization.",
            "id": "3756910",
            "problem": "A non-degenerate, $n$-type gallium arsenide (GaAs) epilayer exhibits a low-temperature drift mobility plateau. The material parameters are the electron effective mass $m^{\\ast} = 0.067\\,m_{e}$ and static dielectric constant $\\varepsilon_{s} = 12.9$. The donor and residual acceptor concentrations are $N_{D} = 3.0 \\times 10^{16}\\,\\mathrm{cm}^{-3}$ and $N_{A} = 5.0 \\times 10^{15}\\,\\mathrm{cm}^{-3}$, respectively. Between $T = 5\\,\\mathrm{K}$ and $T = 20\\,\\mathrm{K}$, the measured total drift mobility $\\mu_{\\mathrm{tot}}(T)$ is essentially constant at $\\mu_{\\mathrm{plateau}} = 1.10 \\times 10^{4}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$. Independent device and modeling estimates indicate that the ionized impurity-limited mobility and the acoustic phonon-limited mobility at $T = 5\\,\\mathrm{K}$ are $\\mu_{\\mathrm{ion}}(5\\,\\mathrm{K}) = 4.0 \\times 10^{5}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$ and $\\mu_{\\mathrm{ph}}(5\\,\\mathrm{K}) = 2.0 \\times 10^{7}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$, respectively.\n\nStarting from the Boltzmann transport framework and Matthiessen’s rule, and invoking the physical picture of neutral impurity scattering as formulated by Erginsoy (without using any pre-stated target formulas), do the following:\n\n1. Derive the qualitative speed dependence of the neutral impurity transport cross-section that leads to the temperature behavior of the neutral-impurity-limited mobility $\\mu_{N}(T)$ in a non-degenerate semiconductor. Clearly connect the dependence of the scattering rate on electron speed $v$ to the temperature dependence of $\\mu_{N}(T)$.\n\n2. Propose a procedure to quantify the neutral impurity concentration $N_{N}$ from the observed low-temperature mobility plateau using Matthiessen’s rule and the Erginsoy neutral scattering picture. Your proposal should indicate how to isolate the neutral scattering contribution from the measured $\\mu_{\\mathrm{tot}}(T)$ when $\\mu_{\\mathrm{ion}}$ and $\\mu_{\\mathrm{ph}}$ are known or can be bounded.\n\n3. Using your derivation and proposal, compute the ratio\n$$\nR \\equiv \\frac{\\mu_{N}(5\\,\\mathrm{K})}{\\mu_{N}(20\\,\\mathrm{K})}\n$$\npredicted by Erginsoy’s model for this GaAs sample. Express $R$ as a unitless number. No rounding is required.",
            "solution": "The problem requires a three-part analysis of neutral impurity scattering in a non-degenerate $n$-type GaAs sample, based on the Erginsoy model.\n\nPart 1: Derivation of the speed dependence of the neutral impurity cross-section.\n\nThe analysis begins with the Boltzmann transport theory for electrical conductivity, from which the drift mobility $\\mu$ is defined. For an ensemble of charge carriers (electrons in this case) with charge $-e$ and effective mass $m^*$, the mobility is related to the average momentum relaxation time, $\\langle \\tau_m \\rangle$, by\n$$\n\\mu = \\frac{e \\langle \\tau_m \\rangle}{m^*}\n$$\nIn a non-degenerate semiconductor, the carriers follow a Maxwell-Boltzmann distribution. The average momentum relaxation time is calculated by averaging the energy-dependent relaxation time, $\\tau_m(E)$, over this distribution. The standard formula for this average is:\n$$\n\\langle \\tau_m \\rangle = \\frac{\\int_{0}^{\\infty} \\tau_m(E) E^{3/2} \\exp(-E/k_B T) dE}{\\int_{0}^{\\infty} E^{3/2} \\exp(-E/k_B T) dE}\n$$\nwhere $E$ is the electron kinetic energy, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. The term $E^{3/2}$ arises from the product of the density of states in three dimensions, $g(E) \\propto E^{1/2}$, and a factor of $E$ that weights states by their contribution to transport.\n\nThe temperature dependence of the mobility $\\mu(T)$ is determined by the temperature dependence of $\\langle \\tau_m \\rangle$. Let's analyze the integral by substituting a general power-law dependence for the relaxation time, $\\tau_m(E) = \\tau_0 E^p$, where $p$ is a constant that characterizes the scattering mechanism.\nThe numerator becomes:\n$$\n\\int_{0}^{\\infty} (\\tau_0 E^p) E^{3/2} \\exp(-E/k_B T) dE = \\tau_0 \\int_{0}^{\\infty} E^{p+3/2} \\exp(-E/k_B T) dE\n$$\nUsing the substitution $x = E/k_B T$, so $E = x k_B T$ and $dE = k_B T dx$, the integral becomes:\n$$\n\\tau_0 (k_B T)^{p+3/2+1} \\int_{0}^{\\infty} x^{p+3/2} \\exp(-x) dx = \\tau_0 (k_B T)^{p+5/2} \\Gamma(p+5/2)\n$$\nwhere $\\Gamma(z)$ is the Gamma function.\nThe denominator is the case where $p=0$ (since $\\tau_m(E)$ is replaced by $1$):\n$$\n(k_B T)^{5/2} \\Gamma(5/2)\n$$\nThus, the temperature dependence of the average relaxation time is:\n$$\n\\langle \\tau_m \\rangle \\propto \\frac{(k_B T)^{p+5/2}}{(k_B T)^{5/2}} = (k_B T)^p\n$$\nConsequently, the mobility has a temperature dependence of $\\mu \\propto T^p$.\n\nThe Erginsoy model for neutral impurity scattering is used to explain experimental observations where, at very low temperatures, the mobility becomes independent of temperature. For the neutral-impurity-limited mobility $\\mu_N(T)$ to be temperature-independent, we must have $\\mu_N \\propto T^0$. This implies that the exponent $p$ for neutral impurity scattering must be $p=0$.\n\nIf $p=0$, then $\\tau_N(E) = \\tau_0 E^0 = \\text{constant}$. This means the momentum relaxation time for neutral impurity scattering, $\\tau_N$, must be independent of the electron's energy.\n\nNow, we connect this result to the scattering cross-section, $\\sigma_N$. The scattering rate, which is the inverse of the relaxation time, is given by:\n$$\n\\frac{1}{\\tau_N(v)} = N_N v \\sigma_N(v)\n$$\nwhere $N_N$ is the concentration of neutral impurities and $v$ is the electron speed.\nSince we require $\\tau_N$ to be constant (independent of energy and therefore speed), its inverse, the scattering rate, must also be constant.\n$$\nN_N v \\sigma_N(v) = \\text{constant}\n$$\nGiven that $N_N$ is a constant concentration, this condition directly implies a specific speed dependence for the cross-section:\n$$\n\\sigma_N(v) \\propto \\frac{1}{v}\n$$\nThis is the qualitative speed dependence of the neutral impurity transport cross-section that leads to the temperature-independent mobility characteristic of the Erginsoy model. The scattering rate's independence from electron speed ($v$) ensures that the relaxation time $\\tau_N$ is constant, which in turn makes the mobility $\\mu_N$ independent of temperature $T$.\n\nPart 2: Procedure to quantify the neutral impurity concentration $N_N$.\n\nThe proposed procedure leverages Matthiessen's rule and the theoretical result from the Erginsoy model.\n\n1.  **Apply Matthiessen's Rule**: The total mobility $\\mu_{\\mathrm{tot}}$ is limited by several independent scattering mechanisms. Matthiessen's rule states that the inverse of the total mobility is the sum of the inverses of the mobilities limited by each mechanism. For the given problem, the relevant mechanisms are ionized impurity, acoustic phonon, and neutral impurity scattering.\n    $$\n    \\frac{1}{\\mu_{\\mathrm{tot}}(T)} = \\frac{1}{\\mu_{\\mathrm{ion}}(T)} + \\frac{1}{\\mu_{\\mathrm{ph}}(T)} + \\frac{1}{\\mu_{N}(T)}\n    $$\n\n2.  **Isolate the Neutral Impurity Mobility**: Rearrange the equation to solve for the mobility limited by neutral impurities, $\\mu_N(T)$.\n    $$\n    \\frac{1}{\\mu_{N}(T)} = \\frac{1}{\\mu_{\\mathrm{tot}}(T)} - \\frac{1}{\\mu_{\\mathrm{ion}}(T)} - \\frac{1}{\\mu_{\\mathrm{ph}}(T)}\n    $$\n    This allows for the extraction of the neutral impurity contribution from the total measured mobility, provided the other contributions are known.\n\n3.  **Calculate $\\mu_N$ at a Specific Temperature**: Choose a temperature within the plateau region, for instance $T=5\\,\\mathrm{K}$, where all necessary data is available. Substitute the measured total mobility $\\mu_{\\mathrm{tot}}(5\\,\\mathrm{K}) = \\mu_{\\mathrm{plateau}} = 1.10 \\times 10^{4}\\,\\mathrm{cm}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$ and the given values for $\\mu_{\\mathrm{ion}}(5\\,\\mathrm{K})$ and $\\mu_{\\mathrm{ph}}(5\\,\\mathrm{K})$ into the rearranged equation from Step 2 to compute a numerical value for $\\mu_N(5\\,\\mathrm{K})$.\n\n4.  **Apply the Erginsoy Formula**: The Erginsoy model provides a theoretical expression for the temperature-independent neutral impurity mobility:\n    $$\n    \\mu_N = \\frac{e}{20 a_B^* \\hbar N_N}\n    $$\n    where $e$ is the elementary charge, $\\hbar$ is the reduced Planck constant, $N_N$ is the neutral impurity concentration, and $a_B^*$ is the effective Bohr radius in the semiconductor.\n\n5.  **Calculate the Effective Bohr Radius**: The effective Bohr radius in a material is given by:\n    $$\n    a_B^* = a_0 \\frac{\\varepsilon_s m_e}{m^*}\n    $$\n    where $a_0$ is the Bohr radius in vacuum ($a_0 = \\frac{4\\pi\\varepsilon_0\\hbar^2}{m_e e^2} \\approx 0.529 \\times 10^{-8}\\,\\mathrm{cm}$), $\\varepsilon_s$ is the static dielectric constant of the semiconductor, $m_e$ is the free electron mass, and $m^*$ is the electron effective mass. For the given GaAs sample, $\\varepsilon_s = 12.9$ and $m^* = 0.067\\,m_e$.\n\n6.  **Solve for $N_N$**: Rearrange the Erginsoy formula to solve for the neutral impurity concentration $N_N$:\n    $$\n    N_N = \\frac{e}{20 a_B^* \\hbar \\mu_N}\n    $$\n    Since the Erginsoy model predicts $\\mu_N$ is constant, the value calculated in Step 3 can be used in this equation. By substituting the values of the physical constants ($e, \\hbar$), the calculated $a_B^*$ from Step 5, and the calculated $\\mu_N$ from Step 3, the unknown concentration $N_N$ can be quantified.\n\nPart 3: Calculation of the ratio $R \\equiv \\frac{\\mu_{N}(5\\,\\mathrm{K})}{\\mu_{N}(20\\,\\mathrm{K})}$.\n\nThe question asks for the ratio of the neutral-impurity-limited mobility at two different temperatures, $T = 5\\,\\mathrm{K}$ and $T = 20\\,\\mathrm{K}$, as predicted by the Erginsoy model.\n\nAs established in Part 1, the theoretical foundation of the Erginsoy model, when formalized within the Boltzmann transport framework, is that the neutral impurity scattering time, $\\tau_N$, is independent of electron energy. This leads to an average scattering time, $\\langle \\tau_N \\rangle$, that is independent of temperature.\n\nSince the mobility is directly proportional to the average scattering time, $\\mu_N = \\frac{e \\langle \\tau_N \\rangle}{m^*}$, and $e$ and $m^*$ are constants, the neutral-impurity-limited mobility $\\mu_N$ is predicted to be independent of temperature.\n$$\n\\mu_N(T) = \\text{constant}\n$$\nThis theoretical prediction holds for any two temperatures within the model's range of validity. Therefore, the mobility at $T = 5\\,\\mathrm{K}$ is equal to the mobility at $T = 20\\,\\mathrm{K}$:\n$$\n\\mu_N(5\\,\\mathrm{K}) = \\mu_N(20\\,\\mathrm{K})\n$$\nThe required ratio $R$ is thus:\n$$\nR = \\frac{\\mu_{N}(5\\,\\mathrm{K})}{\\mu_{N}(20\\,\\mathrm{K})} = 1\n$$\nThe extensive numerical data provided in the problem statement serves to establish a physically realistic context where the Erginsoy model is relevant (i.e., a low-temperature regime where neutral impurity scattering is a dominant, T-independent mechanism), but the specific values are not needed for this particular calculation, which relies solely on the theoretical temperature dependence predicted by the model itself.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "This capstone exercise  synthesizes the concepts of both ionized and neutral impurity scattering into a practical, data-driven modeling framework that reflects the real work of a semiconductor physicist. You will build a complete analysis pipeline to fit experimental mobility data by implementing and contrasting two competing models for ionized impurity scattering—Brooks-Herring and Conwell-Weisskopf. The challenge involves not just applying the models, but also handling experimental uncertainties and using statistical tools like the Akaike Information Criterion (AIC) to perform quantitative model selection.",
            "id": "3756882",
            "problem": "You are asked to implement a complete, self-contained data-analysis pipeline that fits charge-carrier mobility versus impurity concentration and temperature by incorporating ionized and neutral impurity scattering using two rival ionized-impurity scattering models: the Brooks–Herring (BH) model and the Conwell–Weisskopf (CW) model. The program must account for measurement uncertainties and geometric correction factors. The goal is to select the more plausible ionized-impurity scattering model for each dataset via a quantitative criterion and to estimate the key model parameters with uncertainty-aware fitting.\n\nThe physical scenario is electrons in a three-dimensional semiconductor with a single parabolic conduction band and non-degenerate statistics. Use the following fundamental starting points and well-tested facts as the base for your derivation and implementation; no other assumptions should be introduced unless strictly needed for computational tractability and clearly justified by the preceding fundamentals.\n\n- Boltzmann transport in the relaxation-time approximation with an isotropic, parabolic band of effective mass $m^\\ast$.\n- The definition of mobility $ \\mu $ in terms of the electrical conductivity $ \\sigma $, electron density $ n $, and electron charge $ e $ via $ \\mu = \\sigma / (n e) $.\n- Matthiessen’s rule in energy-resolved form for independent scattering channels, $ \\tau_{\\mathrm{tot}}^{-1}(E) = \\sum_{j} \\tau_{j}^{-1}(E) $, where $ \\tau_j(E) $ is the energy-dependent relaxation time for scattering mechanism $ j $.\n- For non-degenerate carriers, the equilibrium distribution is Maxwell–Boltzmann, and thermal averages use the weight $ \\exp(-E/(k_{\\mathrm{B}} T)) $, where $ k_{\\mathrm{B}} $ is Boltzmann’s constant and $ T $ is absolute temperature.\n- The screened Coulomb potential for ionized impurities modeled as a Yukawa potential with inverse screening length given by the Debye wavevector $ k_{\\mathrm{D}} $, and first Born approximation for scattering, which is the basis of the Brooks–Herring model.\n- The unscreened Coulomb potential with impact-parameter cutoffs (large-distance and small-distance) mapped to scattering-angle cutoffs via the Rutherford relation, which is the basis of the Conwell–Weisskopf model.\n- Neutral impurity scattering treated as short-range collisions of electrons from neutral centers, modeled as energy-dependent relaxation time of the form $ \\tau_{\\mathrm{n}}(E) = 1/(N_{\\mathrm{n}} \\sigma_{0} v(E)) $, where $ N_{\\mathrm{n}} $ is the neutral center density, $ \\sigma_{0} $ is an effective transport cross-section to be fit, and $ v(E) $ is the carrier speed.\n\nYour program must implement the following principle-based construction.\n\n1) Thermal-average mobility from first principles. Start from the conductivity definition in the relaxation-time approximation for an isotropic, parabolic band and derive a thermal-average formula for mobility in terms of an energy integral that depends parametrically on $ T $, $ m^\\ast $, and the energy-dependent total relaxation time $ \\tau_{\\mathrm{tot}}(E) $. The derivation must be based on $ \\sigma = e^{2} \\int v_{x}^{2} \\tau(E) \\left( - \\frac{\\partial f_{0}}{\\partial E} \\right) g(E) \\, dE $, where $ f_{0} $ is the equilibrium distribution and $ g(E) $ is the density of states, and $ v_{x}^{2} = v^{2}/3 $ by isotropy. Use the non-degenerate Maxwell–Boltzmann limit. The final computable form you implement must be an energy integral over $ \\tau_{\\mathrm{tot}}(E) $ with a known closed-form denominator, leading to a single numerical integral per data point.\n\n2) Ionized-impurity scattering, two rival models.\n- Brooks–Herring (BH): Begin from a Yukawa potential $ V(r) = \\frac{Z e^{2}}{4 \\pi \\varepsilon_{\\mathrm{s}} r} e^{-k_{\\mathrm{D}} r} $, with $ Z $ the charge state (use $ Z = 1 $), $ e $ the elementary charge, and $ \\varepsilon_{\\mathrm{s}} $ the static permittivity. In the first Born approximation in three dimensions, the differential cross section depends on the Fourier transform $ V(\\mathbf{q}) $ with momentum transfer $ q = 2 k \\sin(\\theta/2) $, where $ k $ is the electron wavevector at kinetic energy $ E $. Use the transport cross section for screened Coulomb scattering and derive a computable expression $ \\sigma_{\\mathrm{tr}}^{\\mathrm{BH}}(E; N_{\\mathrm{i}}, T) $ in terms of $ k $, $ k_{\\mathrm{D}}(N_{\\mathrm{i}}, T) $, and material constants. Then $ \\tau_{\\mathrm{ii}}^{\\mathrm{BH}}(E) = 1/(N_{\\mathrm{i}} v(E) \\sigma_{\\mathrm{tr}}^{\\mathrm{BH}}(E)) $.\n- Conwell–Weisskopf (CW): Start from Rutherford scattering for an unscreened Coulomb potential with the mapping between impact parameter and scattering angle, $ \\tan(\\theta/2) $ as a function of $ b $ and $ E $. Impose a large-distance cutoff $ b_{\\max} $ equal to the Wigner–Seitz radius of the ionized impurities and a small-distance cutoff $ b_{\\min} $ given by the maximum of the classical distance of closest approach and the reduced de Broglie wavelength. Derive a closed-form expression for the transport cross section $ \\sigma_{\\mathrm{tr}}^{\\mathrm{CW}}(E; N_{\\mathrm{i}}) $ in terms of $ b_{\\min} $, $ b_{\\max} $, and $ E $. Then $ \\tau_{\\mathrm{ii}}^{\\mathrm{CW}}(E) = 1/(N_{\\mathrm{i}} v(E) \\sigma_{\\mathrm{tr}}^{\\mathrm{CW}}(E)) $.\n\n3) Neutral impurity scattering. Use $ \\tau_{\\mathrm{n}}(E) = 1/(N_{\\mathrm{n}} \\sigma_{0} v(E)) $ where $ \\sigma_{0} $ is a constant effective transport cross-section to be estimated from data. For simplicity and identifiability, take $ N_{\\mathrm{n}} = N_{\\mathrm{d}} $, where $ N_{\\mathrm{d}} $ is the total impurity (dopant) density.\n\n4) Ionization fraction. Let the ionized impurity density be $ N_{\\mathrm{i}} = \\alpha N_{\\mathrm{d}} $ with $ \\alpha \\in (0, 1] $ to be estimated from data for each dataset. Set $ Z = 1 $. Other material constants must be treated as known.\n\n5) Matthiessen combination in energy space. Combine ionized and neutral scattering as $ \\tau_{\\mathrm{tot}}^{-1}(E) = \\tau_{\\mathrm{ii}}^{-1}(E) + \\tau_{\\mathrm{n}}^{-1}(E) $.\n\n6) Geometry correction and uncertainty propagation. For each measurement, you are given a measured apparent mobility $ \\mu_{\\mathrm{app}} $ and a geometric correction factor $ g $ with uncertainties $ \\sigma_{\\mu} $ and $ \\sigma_{g} $. The true mobility is $ \\mu_{\\mathrm{true}} = g \\, \\mu_{\\mathrm{app}} $. Treat $ \\mu_{\\mathrm{app}} $ and $ g $ as independent measurements with standard deviations $ \\sigma_{\\mu} $ and $ \\sigma_{g} $, and propagate uncertainty by first-order error propagation for a product, so that the standard deviation of $ \\mu_{\\mathrm{true}} $ is\n$$\n\\sigma_{\\mathrm{true}} = \\sqrt{ (g \\, \\sigma_{\\mu})^{2} + (\\mu_{\\mathrm{app}} \\, \\sigma_{g})^{2} }.\n$$\nAll mobilities inside the fitting engine must be handled in the same system of units.\n\n7) Weighted nonlinear least squares and model selection. For each dataset and for each model (BH and CW), estimate $ \\alpha $ and $ \\sigma_{0} $ by minimizing the weighted residuals\n$$\nr_{i} = \\frac{ \\mu_{\\mathrm{model}}(N_{\\mathrm{d},i}, T_{i} ; \\alpha, \\sigma_{0}) - \\mu_{\\mathrm{true}, i}}{ \\sigma_{\\mathrm{true}, i} }.\n$$\nUse an information criterion to select the model: compute the Akaike Information Criterion (AIC) for each fit as\n$$\n\\mathrm{AIC} = 2 k + n \\ln\\!\\left( \\frac{1}{n} \\sum_{i=1}^{n} r_{i}^{2} \\right),\n$$\nwhere $ k = 2 $ is the number of fitted parameters and $ n $ is the number of data points in the dataset. Choose the model with the lower AIC.\n\n8) Material constants and units. Use the following material constants for silicon:\n- $ m^\\ast = 0.26 \\, m_{0} $, where $ m_{0} $ is the free-electron mass.\n- $ \\varepsilon_{\\mathrm{s}} = 11.7 \\, \\varepsilon_{0} $, where $ \\varepsilon_{0} $ is the vacuum permittivity.\n- $ Z = 1 $.\n- Use $ e $, $ \\hbar $, and $ k_{\\mathrm{B}} $ at their conventional values.\nBe explicit about unit conversions. The input impurity densities below are given in $ \\mathrm{cm^{-3}} $ and measured mobilities are given in $ \\mathrm{cm^{2}/(V \\cdot s)} $. Convert to the International System of Units (SI) inside the program for all physical computations. Express the fitted neutral cross section $ \\sigma_{0} $ in $ \\mathrm{m^{2}} $ and the ionization fraction $ \\alpha $ as a dimensionless number.\n\n9) Test suite. Fit the following three datasets. In each dataset, the data consist of tuples $ (N_{\\mathrm{d}}, T, \\mu_{\\mathrm{app}}, \\sigma_{\\mu}, g, \\sigma_{g}) $ with $ N_{\\mathrm{d}} $ in $ \\mathrm{cm^{-3}} $, $ T $ in $ \\mathrm{K} $, $ \\mu_{\\mathrm{app}} $ and $ \\sigma_{\\mu} $ in $ \\mathrm{cm^{2}/(V \\cdot s)} $, and $ g $ and $ \\sigma_{g} $ dimensionless.\n- Dataset $ \\#1 $ (moderate doping, BH-friendly regime):\n  - $ (1.0 \\times 10^{15}, 200, 1080.0, 30.0, 1.02, 0.01) $\n  - $ (1.0 \\times 10^{15}, 300, 1300.0, 30.0, 0.99, 0.01) $\n  - $ (3.0 \\times 10^{15}, 300, 900.0, 25.0, 1.00, 0.01) $\n  - $ (1.0 \\times 10^{16}, 300, 500.0, 20.0, 1.01, 0.01) $\n  - $ (1.0 \\times 10^{16}, 400, 600.0, 20.0, 0.98, 0.01) $\n- Dataset $ \\#2 $ (higher doping, CW-friendly regime):\n  - $ (3.0 \\times 10^{16}, 300, 300.0, 10.0, 1.01, 0.01) $\n  - $ (5.0 \\times 10^{16}, 200, 220.0, 10.0, 1.00, 0.01) $\n  - $ (5.0 \\times 10^{16}, 300, 240.0, 10.0, 0.99, 0.01) $\n  - $ (1.0 \\times 10^{17}, 300, 180.0, 10.0, 1.02, 0.01) $\n  - $ (1.0 \\times 10^{17}, 400, 200.0, 10.0, 0.98, 0.01) $\n- Dataset $ \\#3 $ (edge cases with larger geometry uncertainty):\n  - $ (1.0 \\times 10^{15}, 300, 1200.0, 50.0, 0.95, 0.05) $\n  - $ (1.0 \\times 10^{17}, 300, 150.0, 20.0, 1.05, 0.05) $\n  - $ (1.0 \\times 10^{16}, 250, 400.0, 30.0, 1.00, 0.02) $\n  - $ (1.0 \\times 10^{16}, 350, 450.0, 30.0, 1.00, 0.02) $\n\n10) Output. For each dataset in the given order, output the selected model identifier and fitted parameters as a flat list in the pattern $ [M_{1}, \\alpha_{1}, \\sigma_{0,1}, M_{2}, \\alpha_{2}, \\sigma_{0,2}, M_{3}, \\alpha_{3}, \\sigma_{0,3}] $, where $ M_{j} = 0 $ denotes Brooks–Herring and $ M_{j} = 1 $ denotes Conwell–Weisskopf. Express $ \\alpha_{j} $ as a decimal rounded to three significant figures, and express $ \\sigma_{0,j} $ in $ \\mathrm{m^{2}} $ rounded to three significant figures. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $ [0,0.912,3.21 \\times 10^{-20},\\dots] $.\n\nAngle units: All scattering angles in any intermediate derivation must be in radians.\n\nNote: All physical computations must be performed in SI units. Ensure that $ N_{\\mathrm{d}} $ given in $ \\mathrm{cm^{-3}} $ is converted to $ \\mathrm{m^{-3}} $ and that $ \\mu $ given in $ \\mathrm{cm^{2}/(V \\cdot s)} $ is converted to $ \\mathrm{m^{2}/(V \\cdot s)} $ via the factor $ 10^{-4} $.",
            "solution": "The user's request is to develop a data-analysis pipeline to fit charge-carrier mobility data in silicon against impurity concentration and temperature. The pipeline must implement and compare two rival models for ionized impurity scattering—Brooks–Herring (BH) and Conwell–Weisskopf (CW)—along with a model for neutral impurity scattering. The analysis involves propagating experimental uncertainties, performing weighted nonlinear least-squares fitting of model parameters, and using the Akaike Information Criterion (AIC) for model selection.\n\nThe problem is determined to be **valid**. It is scientifically well-grounded in standard semiconductor transport theory, provides a complete and self-contained set of instructions, models, and data, and poses a non-trivial but feasible computational physics problem. The specified modeling assumptions, such as taking the neutral impurity density $N_{\\mathrm{n}}$ to be the total dopant density $N_{\\mathrm{d}}$, are treated as explicit directives for the model's implementation, rather than as flaws in the problem statement.\n\nThe solution is constructed following a principled, step-by-step derivation and implementation plan.\n\n### 1. Thermal-Averaged Mobility\n\nThe mobility $\\mu$ is derived from the electrical conductivity $\\sigma$ under the relaxation-time approximation for a non-degenerate electron gas in an isotropic, parabolic band. The starting point is the Boltzmann transport equation result for conductivity:\n$$\n\\sigma = e^{2} \\int_{0}^{\\infty} v_{x}^{2} \\tau(E) \\left( - \\frac{\\partial f_{0}}{\\partial E} \\right) g(E) \\, dE\n$$\nwhere $e$ is the elementary charge, $\\tau(E)$ is the energy-dependent total relaxation time, $f_0(E)$ is the Maxwell-Boltzmann distribution, and $g(E)$ is the 3D density of states. For an isotropic system, the average squared velocity component is $v_x^2 = v(E)^2/3$. Using the relations $E = m^\\ast v^2/2$, $g(E) \\propto \\sqrt{E}$, and $-\\partial f_0/\\partial E = f_0/(k_B T)$, and the definition $\\mu = \\sigma/(ne)$, we arrive at the expression for the thermally averaged mobility:\n$$\n\\mu = \\frac{\\langle E \\tau(E) \\rangle}{\\langle E \\rangle} \\frac{2e}{3m^\\ast}\n$$\nwhere the thermal average of a quantity $A(E)$ is given by $\\langle A(E) \\rangle = \\int A(E) E^{1/2} e^{-E/k_B T} dE / \\int E^{1/2} e^{-E/k_B T} dE$. The average energy for a 3D non-degenerate gas is $\\langle E \\rangle = \\frac{3}{2} k_B T$. This leads to the well-known formula for drift mobility:\n$$\n\\mu = \\frac{e}{m^\\ast} \\langle \\tau \\rangle\n$$\nwhere $\\langle \\tau \\rangle$ is the thermally averaged relaxation time given by:\n$$\n\\langle \\tau \\rangle = \\frac{\\int_0^\\infty \\tau(E) E^{3/2} e^{-E/k_B T} dE}{\\int_0^\\infty E^{3/2} e^{-E/k_B T} dE} = \\frac{2}{3(k_B T)^{5/2}\\Gamma(5/2)} \\int_0^\\infty \\tau(E) E^{3/2} e^{-E/k_B T} dE\n$$\nA more direct derivation, without first evaluating $\\langle E \\rangle$, leads to the computationally convenient form. By substituting the expressions for $v_x^2$, $g(E)$, and $f_0(E)$ and normalizing, we obtain:\n$$\n\\mu = \\frac{2e}{3m^\\ast k_B T} \\frac{\\int_{0}^{\\infty} E \\tau(E) E^{1/2} e^{-E/k_B T} dE}{\\int_{0}^{\\infty} E^{1/2} e^{-E/k_B T} dE}\n$$\nThe denominator is $\\Gamma(3/2)(k_B T)^{3/2} = (\\sqrt{\\pi}/2)(k_B T)^{3/2}$. Making the substitution $x = E/(k_B T)$ yields the final formula for numerical implementation:\n$$\n\\mu = \\frac{4e}{3m^\\ast\\sqrt{\\pi}} \\int_0^\\infty x^{3/2} \\tau_{\\mathrm{tot}}(x k_B T) e^{-x} dx\n$$\nwhere $x$ is the dimensionless energy and $\\tau_{\\mathrm{tot}}$ is the total energy-dependent relaxation time.\n\n### 2. Scattering Mechanisms and Relaxation Times\n\nThe total relaxation time $\\tau_{\\mathrm{tot}}(E)$ is calculated using Matthiessen's rule, which adds the scattering rates from independent mechanisms:\n$$\n\\tau_{\\mathrm{tot}}^{-1}(E) = \\tau_{\\mathrm{ii}}^{-1}(E) + \\tau_{\\mathrm{n}}^{-1}(E)\n$$\nwhere $\\tau_{\\mathrm{ii}}$ is the relaxation time for ionized impurity scattering and $\\tau_{\\mathrm{n}}$ is for neutral impurity scattering. The model parameters to be fitted are the ionization fraction $\\alpha$ and the neutral impurity effective cross-section $\\sigma_0$. The ionized and neutral impurity densities are given by $N_{\\mathrm{i}} = \\alpha N_{\\mathrm{d}}$ and $N_{\\mathrm{n}} = N_{\\mathrm{d}}$, respectively, where $N_{\\mathrm{d}}$ is the total dopant concentration.\n\n#### 2.1. Brooks-Herring (BH) Model\nThis model treats scattering from a screened Coulomb (Yukawa) potential within the first Born approximation. The energy-dependent relaxation time is:\n$$\n\\tau_{\\mathrm{ii}}^{\\mathrm{BH}}(E) = \\frac{16 \\sqrt{2} \\pi \\varepsilon_{\\mathrm{s}}^2 \\sqrt{m^\\ast} E^{3/2}}{N_{\\mathrm{i}} Z^2 e^4 \\left[ \\ln(1+\\gamma) - \\frac{\\gamma}{1+\\gamma} \\right]}\n$$\nwith the screening parameter $\\gamma$ given by:\n$$\n\\gamma(E, T) = \\frac{8 m^\\ast E}{\\hbar^2 k_{\\mathrm{D}}^2}, \\quad \\text{where} \\quad k_{\\mathrm{D}}^2 = \\frac{N_{\\mathrm{i}} e^2}{\\varepsilon_{\\mathrm{s}} k_{\\mathrm{B}} T}\n$$\nHere, $\\varepsilon_{\\mathrm{s}}$ is the static permittivity, $m^\\ast$ is the effective mass, and $Z=1$ is the impurity charge state.\n\n#### 2.2. Conwell-Weisskopf (CW) Model\nThis model is based on Rutherford scattering from an unscreened Coulomb potential, with a cutoff on the impact parameter corresponding to half the average distance between impurities ($b_{\\max} = (2 N_{\\mathrm{i}}^{1/3})^{-1}$). The relaxation time is:\n$$\n\\tau_{\\mathrm{ii}}^{\\mathrm{CW}}(E) = \\frac{16 \\sqrt{2} \\pi \\varepsilon_{\\mathrm{s}}^2 \\sqrt{m^\\ast} E^{3/2}}{N_{\\mathrm{i}} Z^2 e^4 \\ln\\left(1+\\beta_{\\mathrm{CW}}^2\\right)}\n$$\nwith the parameter $\\beta_{\\mathrm{CW}}$ given by:\n$$\n\\beta_{\\mathrm{CW}}(E) = \\frac{4\\pi \\varepsilon_{\\mathrm{s}} E}{N_{\\mathrm{i}}^{1/3} Z e^2}\n$$\n\n#### 2.3. Neutral Impurity Scattering\nScattering from neutral impurities is modeled as short-range collisions. The relaxation time is inversely proportional to the carrier velocity $v(E) = \\sqrt{2E/m^\\ast}$:\n$$\n\\tau_{\\mathrm{n}}(E) = \\frac{1}{N_{\\mathrm{n}} \\sigma_{0} v(E)} = \\frac{\\sqrt{m^\\ast}}{N_{\\mathrm{d}} \\sigma_{0} \\sqrt{2E}}\n$$\nwhere $\\sigma_0$ is the constant effective transport cross-section, a fit parameter. As per the problem statement, the neutral impurity density $N_{\\mathrm{n}}$ is taken to be the total dopant density $N_{\\mathrm{d}}$.\n\n### 3. Computational Strategy and Fitting\n\nThe data analysis pipeline is implemented as follows:\n1.  **Data Preprocessing**: For each data point $(N_{\\mathrm{d}}, T, \\mu_{\\mathrm{app}}, \\sigma_{\\mu}, g, \\sigma_{g})$, all quantities are converted to SI units. The true mobility $\\mu_{\\mathrm{true}} = g \\mu_{\\mathrm{app}}$ and its uncertainty $\\sigma_{\\mathrm{true}} = \\sqrt{(g \\sigma_{\\mu})^2 + (\\mu_{\\mathrm{app}} \\sigma_{g})^2}$ are calculated using first-order error propagation.\n\n2.  **Model Mobility Calculation**: A function is implemented to compute the model mobility $\\mu_{\\mathrm{model}}(N_{\\mathrm{d}}, T; \\alpha, \\sigma_0)$ for a given set of parameters. This function constructs the appropriate $\\tau_{\\mathrm{tot}}(E)$ and evaluates the mobility integral numerically using `scipy.integrate.quad`.\n\n3.  **Weighted Least-Squares Fitting**: For each dataset and each model (BH and CW), the optimal parameters $(\\alpha, \\sigma_0)$ are found by minimizing the sum of squared weighted residuals, $\\chi^2$:\n    $$\n    \\chi^2(\\alpha, \\sigma_0) = \\sum_{i=1}^{n} \\left( \\frac{\\mu_{\\mathrm{model}}(N_{\\mathrm{d},i}, T_{i}; \\alpha, \\sigma_{0}) - \\mu_{\\mathrm{true},i}}{\\sigma_{\\mathrm{true},i}} \\right)^2\n    $$\n    The minimization is performed using `scipy.optimize.minimize` with bounds $0 < \\alpha \\le 1$ and $\\sigma_0 > 0$.\n\n4.  **Model Selection**: The Akaike Information Criterion (AIC) is used to select the more plausible model. For a model with $k=2$ parameters and $n$ data points, the AIC is calculated as:\n    $$\n    \\mathrm{AIC} = 2k + n \\ln\\left(\\frac{\\chi^2_{\\min}}{n}\\right)\n    $$\n    The model (BH or CW) with the lower AIC value is selected for each dataset.\n\n5.  **Output Generation**: The final results for each dataset—the selected model identifier ($0$ for BH, $1$ for CW), the fitted ionization fraction $\\alpha$, and the neutral scattering cross-section $\\sigma_0$—are formatted to three significant figures and presented in a single list as specified. Physical constants from `scipy.constants` are used, and all calculations are performed in SI units.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import e, m_e, hbar, k, epsilon_0\nfrom scipy.integrate import quad\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main function to run the entire data-analysis pipeline for fitting mobility data.\n    \"\"\"\n\n    # --- Container for Physical Constants (SI Units) ---\n    class SiConstants:\n        def __init__(self):\n            self.m_star = 0.26 * m_e  # Effective mass\n            self.eps_s = 11.7 * epsilon_0  # Static permittivity\n            self.Z = 1.0  # Impurity charge state\n            self.e = e\n            self.hbar = hbar\n            self.k_B = k\n\n    C = SiConstants()\n\n    # --- Test Datasets ---\n    # Format: (Nd [cm^-3], T [K], mu_app [cm^2/V.s], sigma_mu [cm^2/V.s], g, sigma_g)\n    datasets = [\n        # Dataset #1\n        [\n            (1.0e15, 200, 1080.0, 30.0, 1.02, 0.01),\n            (1.0e15, 300, 1300.0, 30.0, 0.99, 0.01),\n            (3.0e15, 300, 900.0, 25.0, 1.00, 0.01),\n            (1.0e16, 300, 500.0, 20.0, 1.01, 0.01),\n            (1.0e16, 400, 600.0, 20.0, 0.98, 0.01),\n        ],\n        # Dataset #2\n        [\n            (3.0e16, 300, 300.0, 10.0, 1.01, 0.01),\n            (5.0e16, 200, 220.0, 10.0, 1.00, 0.01),\n            (5.0e16, 300, 240.0, 10.0, 0.99, 0.01),\n            (1.0e17, 300, 180.0, 10.0, 1.02, 0.01),\n            (1.0e17, 400, 200.0, 10.0, 0.98, 0.01),\n        ],\n        # Dataset #3\n        [\n            (1.0e15, 300, 1200.0, 50.0, 0.95, 0.05),\n            (1.0e17, 300, 150.0, 20.0, 1.05, 0.05),\n            (1.0e16, 250, 400.0, 30.0, 1.00, 0.02),\n            (1.0e16, 350, 450.0, 30.0, 1.00, 0.02),\n        ],\n    ]\n\n    def tau_bh(E, Ni, T, C):\n        \"\"\"Brooks-Herring relaxation time.\"\"\"\n        if E = 0 or Ni = 0: return np.inf\n        k_D_sq = (Ni * C.e**2) / (C.eps_s * C.k_B * T)\n        gamma = (8 * C.m_star * E) / (C.hbar**2 * k_D_sq)\n        log_term = np.log(1 + gamma) - gamma / (1 + gamma)\n        if log_term = 0: return np.inf\n        \n        num = 16 * np.sqrt(2) * np.pi * C.eps_s**2 * np.sqrt(C.m_star) * E**1.5\n        den = Ni * C.Z**2 * C.e**4 * log_term\n        return num / den\n\n    def tau_cw(E, Ni, C):\n        \"\"\"Conwell-Weisskopf relaxation time.\"\"\"\n        if E = 0 or Ni = 0: return np.inf\n        beta_cw = (4 * np.pi * C.eps_s * E) / (Ni**(1/3) * C.Z * C.e**2)\n        log_term = np.log(1 + beta_cw**2)\n        if log_term = 0: return np.inf\n\n        num = 16 * np.sqrt(2) * np.pi * C.eps_s**2 * np.sqrt(C.m_star) * E**1.5\n        den = Ni * C.Z**2 * C.e**4 * log_term\n        return num / den\n\n    def tau_neutral(E, Nd, sigma0, C):\n        \"\"\"Neutral impurity scattering relaxation time.\"\"\"\n        if E = 0 or sigma0 = 0: return np.inf\n        v = np.sqrt(2 * E / C.m_star)\n        return 1 / (Nd * sigma0 * v)\n\n    def calculate_model_mobility(T, Nd, alpha, sigma0, model, C):\n        \"\"\"Calculates model mobility via numerical integration.\"\"\"\n        Ni = alpha * Nd\n\n        def integrand(x):\n            E = x * C.k_B * T\n            if E = 0: return 0.0\n            \n            if model == 'BH':\n                tau_ii_val = tau_bh(E, Ni, T, C)\n            else:  # CW\n                tau_ii_val = tau_cw(E, Ni, C)\n            \n            tau_n_val = tau_neutral(E, Nd, sigma0, C)\n            \n            tau_tot_inv = 1 / tau_ii_val + 1 / tau_n_val\n            tau_tot = 1 / tau_tot_inv if tau_tot_inv > 0 else np.inf\n            \n            return x**1.5 * tau_tot * np.exp(-x)\n\n        integral_val, _ = quad(integrand, 0, np.inf)\n        \n        prefactor = (4 * C.e) / (3 * C.m_star * np.sqrt(np.pi))\n        return prefactor * integral_val\n\n    def objective_function(params, data, model, C):\n        \"\"\"Computes chi-squared for a given set of parameters.\"\"\"\n        alpha, sigma0 = params\n        \n        # Parameter validation inside objective\n        if not (0  alpha = 1 and sigma0 > 0):\n            return np.inf\n\n        chi2 = 0.0\n        for (Nd_si, T, mu_true_si, sigma_true_si) in data:\n            mu_model = calculate_model_mobility(T, Nd_si, alpha, sigma0, model, C)\n            if not np.isfinite(mu_model) or mu_model = 0:\n                return np.inf # Penalize non-physical results\n            \n            residual = (mu_model - mu_true_si) / sigma_true_si\n            chi2 += residual**2\n\n        return chi2\n\n    # --- Main Analysis Loop ---\n    final_results = []\n    for dataset in datasets:\n        # 1. Pre-process data: unit conversion and uncertainty propagation\n        processed_data = []\n        for dp in dataset:\n            Nd, T, mu_app, sigma_mu, g, sigma_g = dp\n            \n            Nd_si = Nd * 1e6  # cm^-3 to m^-3\n            mu_app_si = mu_app * 1e-4  # cm^2/Vs to m^2/Vs\n            sigma_mu_si = sigma_mu * 1e-4\n\n            mu_true_si = g * mu_app_si\n            sigma_true_si = np.sqrt((g * sigma_mu_si)**2 + (mu_app_si * sigma_g)**2)\n            processed_data.append((Nd_si, T, mu_true_si, sigma_true_si))\n        \n        n_points = len(processed_data)\n        k_params = 2\n        \n        param_bounds = ((1e-9, 1.0), (1e-30, 1e-15))\n        initial_guess = [0.9, 1e-20]\n\n        # 2. Fit BH model\n        res_bh = minimize(objective_function, initial_guess, args=(processed_data, 'BH', C),\n                          method='L-BFGS-B', bounds=param_bounds)\n        chi2_bh = res_bh.fun\n        alpha_bh, sigma0_bh = res_bh.x\n        aic_bh = 2 * k_params + n_points * np.log(chi2_bh / n_points) if chi2_bh > 0 else np.inf\n\n        # 3. Fit CW model\n        res_cw = minimize(objective_function, initial_guess, args=(processed_data, 'CW', C),\n                          method='L-BFGS-B', bounds=param_bounds)\n        chi2_cw = res_cw.fun\n        alpha_cw, sigma0_cw = res_cw.x\n        aic_cw = 2 * k_params + n_points * np.log(chi2_cw / n_points) if chi2_cw > 0 else np.inf\n        \n        # 4. Model Selection and Result Formatting\n        if aic_bh = aic_cw:\n            model_id = 0\n            best_alpha = alpha_bh\n            best_sigma0 = sigma0_bh\n        else:\n            model_id = 1\n            best_alpha = alpha_cw\n            best_sigma0 = sigma0_cw\n            \n        final_results.extend([\n            model_id,\n            f\"{best_alpha:.3g}\",\n            f\"{best_sigma0:.2e}\"\n        ])\n\n    # 5. Final Output\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\nsolve()\n```"
        }
    ]
}