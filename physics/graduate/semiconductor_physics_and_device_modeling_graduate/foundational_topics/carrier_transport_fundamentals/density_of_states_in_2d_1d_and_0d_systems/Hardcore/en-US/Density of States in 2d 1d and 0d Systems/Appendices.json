{
    "hands_on_practices": [
        {
            "introduction": "The quantum dot, often called an 'artificial atom,' represents the ultimate limit of quantum confinement. To truly grasp the origin of its unique electronic properties, we must return to first principles. This practice  challenges you to solve the time-independent Schrödinger equation for a cubic quantum dot, a classic 'particle-in-a-box' problem. By deriving the discrete energy spectrum and expressing the density of states as a sum of Dirac delta functions, you will build a foundational understanding of how full spatial confinement transforms the continuous DOS of bulk materials into a discrete, atom-like spectrum.",
            "id": "3737310",
            "problem": "Consider a single noninteracting electron in a cubic semiconductor quantum dot of side length $L$ with infinite barrier confinement, under the parabolic-band effective mass approximation with electron effective mass $m^{*}$. The potential is $V(x,y,z)=0$ for $0<x<L$, $0<y<L$, $0<z<L$, and $V=\\infty$ outside. Work within the time-independent Schrödinger equation and impose the physically appropriate boundary conditions. Assume there is no valley degeneracy and that spin is not split, so the spin degeneracy is twofold. Define the density of states (DOS) for a zero-dimensional (0D) system as the spectral measure of the Hamiltonian given by a sum of Dirac delta distributions located at the discrete energy levels, each weighted by its degeneracy.\n\nStarting only from the time-independent Schrödinger equation and the boundary conditions specified above, derive the discrete energy spectrum and write the 0D DOS as a single closed-form analytic expression in terms of $L$, $m^{*}$, $\\hbar$, and the Dirac delta distribution. Your final expression must incorporate the twofold spin degeneracy and must account for the multiplicity of states via explicit summation over all allowed quantum numbers. No numerical evaluation is required. Express the final DOS in terms of energy $E$ and use the Dirac delta distribution notation. Provide your final answer as a single analytic expression.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- **System:** A single noninteracting electron in a cubic semiconductor quantum dot.\n- **Geometry:** Cubic with side length $L$.\n- **Potential:** $V(x,y,z)=0$ for $0<x<L$, $0<y<L$, $0<z<L$; and $V=\\infty$ outside this region.\n- **Model:** Parabolic-band effective mass approximation with electron effective mass $m^{*}$.\n- **Governing Equation:** Time-independent Schrödinger equation.\n- **Boundary Conditions:** Physically appropriate for infinite barrier confinement, implying the wavefunction must be zero at the boundaries of the cube.\n- **Degeneracy:** No valley degeneracy; twofold spin degeneracy.\n- **Definition of 0D DOS:** The density of states (DOS) for a zero-dimensional (0D) system is defined as the spectral measure of the Hamiltonian, given by a sum of Dirac delta distributions located at the discrete energy levels, each weighted by its degeneracy.\n- **Objective:** Derive the discrete energy spectrum and write the 0D DOS, $g_{0D}(E)$, as a single closed-form analytic expression in terms of $L$, $m^{*}$, $\\hbar$, and the Dirac delta distribution, incorporating spin degeneracy and summing over all allowed quantum numbers.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes the \"particle in a 3D box,\" a canonical problem in quantum mechanics. The use of the effective mass approximation is standard practice in semiconductor physics. The definition of the 0D DOS is correct for a system with a discrete energy spectrum. The problem is scientifically sound.\n- **Well-Posed:** All necessary information—the potential, boundary conditions, and relevant physical constants—is provided to solve the Schrödinger equation and derive the energy eigenvalues. The definition of the DOS is explicit and unambiguous. A unique, stable, and meaningful solution exists.\n- **Objective:** The problem statement is clear, precise, and uses standard scientific terminology without any subjectivity.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically grounded, well-posed, objective, and complete. It is therefore deemed **valid**. The solution process will now proceed.\n\n### Solution Derivation\nThe system is governed by the time-independent Schrödinger equation for the electron's envelope function $\\psi(x,y,z)$ with effective mass $m^{*}$. In three dimensions, this is:\n$$-\\frac{\\hbar^2}{2m^{*}} \\nabla^2 \\psi(x,y,z) + V(x,y,z) \\psi(x,y,z) = E \\psi(x,y,z)$$\nInside the quantum dot, i.e., for $x \\in (0,L)$, $y \\in (0,L)$, and $z \\in (0,L)$, the potential $V(x,y,z)=0$. The equation simplifies to:\n$$-\\frac{\\hbar^2}{2m^{*}} \\left( \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2} \\right) \\psi(x,y,z) = E \\psi(x,y,z)$$\nThe potential is infinite outside this region, which imposes the boundary condition that the wavefunction $\\psi$ must be zero on the faces of the cube.\n\nWe solve this partial differential equation using the method of separation of variables. Let the wavefunction be a product of three one-dimensional functions: $\\psi(x,y,z) = X(x)Y(y)Z(z)$. Substituting this into the equation and dividing by $\\psi(x,y,z)$ yields:\n$$-\\frac{\\hbar^2}{2m^{*}} \\left( \\frac{1}{X(x)}\\frac{d^2X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2Y}{dy^2} + \\frac{1}{Z(z)}\\frac{d^2Z}{dz^2} \\right) = E$$\nSince each term on the left-hand side depends on an independent variable, each must be equal to a constant. We can write:\n$$\\frac{d^2X}{dx^2} = -k_x^2 X(x)$$\n$$\\frac{d^2Y}{dy^2} = -k_y^2 Y(y)$$\n$$\\frac{d^2Z}{dz^2} = -k_z^2 Z(z)$$\nwhere the total energy $E$ is related to these separation constants by:\n$$E = \\frac{\\hbar^2}{2m^{*}} (k_x^2 + k_y^2 + k_z^2)$$\nLet's solve the equation for $X(x)$. The general solution is $X(x) = A \\sin(k_x x) + B \\cos(k_x x)$. The boundary conditions require $X(0) = 0$ and $X(L)=0$.\nFrom $X(0)=0$, we get $A \\sin(0) + B \\cos(0) = B = 0$.\nThe solution simplifies to $X(x) = A \\sin(k_x x)$.\nFrom $X(L)=0$, we get $A \\sin(k_x L) = 0$. For a non-trivial solution ($A \\neq 0$), we must have $\\sin(k_x L) = 0$. This implies $k_x L = n_x \\pi$, where $n_x$ is an integer. The value $n_x=0$ would lead to $k_x=0$ and thus $X(x)=0$, a trivial solution. Negative integers for $n_x$ do not produce new physical states, as they only change the sign of the wavefunction. Therefore, the quantum number $n_x$ must be a positive integer: $n_x \\in \\{1, 2, 3, \\dots\\}$.\nThe allowed values for the wavevector component $k_x$ are quantized:\n$$k_x = \\frac{n_x \\pi}{L}, \\quad n_x = 1, 2, 3, \\dots$$\nBy symmetry, the same logic applies to the $y$ and $z$ directions, yielding:\n$$k_y = \\frac{n_y \\pi}{L}, \\quad n_y = 1, 2, 3, \\dots$$\n$$k_z = \\frac{n_z \\pi}{L}, \\quad n_z = 1, 2, 3, \\dots$$\nThe discrete energy spectrum of the electron is found by substituting these quantized wavevectors into the expression for the total energy $E$:\n$$E_{n_x, n_y, n_z} = \\frac{\\hbar^2}{2m^{*}} \\left( \\left(\\frac{n_x \\pi}{L}\\right)^2 + \\left(\\frac{n_y \\pi}{L}\\right)^2 + \\left(\\frac{n_z \\pi}{L}\\right)^2 \\right)$$\n$$E_{n_x, n_y, n_z} = \\frac{\\pi^2 \\hbar^2}{2m^{*} L^2} (n_x^2 + n_y^2 + n_z^2)$$\nA unique spatial state is defined by a unique triplet of positive integer quantum numbers $(n_x, n_y, n_z)$.\n\nThe problem defines the density of states for this 0D system, $g_{0D}(E)$, as a sum of Dirac delta distributions at each allowed energy level, weighted by the level's degeneracy. We are asked to construct this as a sum over all allowed quantum numbers.\n\nA single spatial state defined by $(n_x, n_y, n_z)$ has energy $E_{n_x, n_y, n_z}$. The problem specifies a twofold spin degeneracy, meaning each spatial state can accommodate two electrons (spin-up and spin-down). Therefore, each unique triplet $(n_x, n_y, n_z)$ corresponds to 2 quantum states. The total density of states is the sum of contributions from all possible states. To account for all states, we sum over all allowed values of the quantum numbers $n_x$, $n_y$, and $n_z$.\n\nThe contribution of a single spatial state $(n_x, n_y, n_z)$, including its twofold spin degeneracy, to the total DOS is $2 \\cdot \\delta(E - E_{n_x, n_y, n_z})$.\n\nThe total density of states $g_{0D}(E)$ is the sum of these contributions over all possible combinations of positive integers $n_x, n_y, n_z$:\n$$g_{0D}(E) = \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} 2 \\cdot \\delta(E - E_{n_x, n_y, n_z})$$\nSubstituting the expression for the energy eigenvalues, we obtain the final expression for the density of states:\n$$g_{0D}(E) = 2 \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\delta\\left(E - \\frac{\\pi^2 \\hbar^2}{2m^{*} L^2} (n_x^2 + n_y^2 + n_z^2)\\right)$$\nThis expression represents the density of states as a series of infinitely sharp peaks at the discrete energy levels. The summation structure automatically accounts for the orbital degeneracy (multiple combinations of $\\{n_x, n_y, n_z\\}$ yielding the same sum of squares) and the prefactor of $2$ accounts for the spin degeneracy, as required.",
            "answer": "$$\\boxed{2 \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\delta\\left(E - \\frac{\\pi^2 \\hbar^2}{2m^{*} L^2} (n_x^2 + n_y^2 + n_z^2)\\right)}$$"
        },
        {
            "introduction": "When we relax confinement from three dimensions to one, creating a two-dimensional electron gas (2DEG), the discrete energy levels merge into continuous subbands. This exercise  moves beyond the idealized isotropic model to a more realistic scenario involving anisotropic effective masses, a common feature in many semiconductors. By deriving the 2D density of states for an elliptical energy dispersion, you will discover the remarkable result that the DOS remains constant with energy and see how this value depends on the geometry of the constant-energy surfaces in $k$-space.",
            "id": "3737344",
            "problem": "A two-dimensional electron gas is confined to the $x$–$y$ plane of a crystalline semiconductor whose conduction-band minimum exhibits an anisotropic parabolic dispersion described by\n$$\nE(\\mathbf{k}) \\;=\\; E_{c} \\;+\\; \\frac{\\hbar^{2}}{2}\\left(\\frac{k_{x}^{2}}{m_{x}} \\;+\\; \\frac{k_{y}^{2}}{m_{y}}\\right),\n$$\nwhere $E_{c}$ is the band edge, $\\hbar$ is the reduced Planck constant, $m_{x}$ and $m_{y}$ are positive effective masses along the $x$ and $y$ axes, and $\\mathbf{k}=(k_{x},k_{y})$ is the crystal wavevector. Assume a macroscopically large area $A$ with periodic boundary conditions so that the allowed $\\mathbf{k}$-states form a uniform lattice in $\\mathbf{k}$-space. Let $g_{s}$ denote the spin degeneracy and $g_{v}$ the valley degeneracy. \n\nStarting from the fundamental definition of the density of states (DOS) per unit area per unit energy as the number of allowed states in an energy interval divided by the area and the interval width, derive the two-dimensional density of states $g_{2\\mathrm{D}}(E)$ for energies $E \\ge E_{c}$. You may use only the following bases: the dispersion relation above; the fact that periodic boundary conditions yield a uniform density of $\\mathbf{k}$-states equal to $A/(2\\pi)^{2}$ per unit area in $\\mathbf{k}$-space; and standard properties of integrals and the Dirac delta function.\n\nReport your final result as a single closed-form analytic expression in terms of $g_{s}$, $g_{v}$, $\\hbar$, $m_{x}$, and $m_{y}$, valid for $E \\ge E_{c}$. Express the answer as a density of states per unit area per unit energy; do not include units in your final expression.",
            "solution": "We are asked to compute the two-dimensional density of states per unit area per unit energy for an anisotropic parabolic band. A fundamental definition of the density of states per unit area per unit energy is\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{g_{s} g_{v}}{A}\\sum_{\\mathbf{k}} \\delta\\!\\left(E - E(\\mathbf{k})\\right),\n$$\nwhere $A$ is the real-space area and the sum runs over all allowed $\\mathbf{k}$-states. Under periodic boundary conditions, the allowed $\\mathbf{k}$-states form a uniform grid with density $A/(2\\pi)^{2}$ per unit area in $\\mathbf{k}$-space. This allows us to replace the sum by an integral:\n$$\n\\frac{1}{A}\\sum_{\\mathbf{k}} \\;\\longrightarrow\\; \\frac{1}{(2\\pi)^{2}} \\int d^{2}\\mathbf{k},\n$$\nso that\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\int_{\\mathbb{R}^{2}} d k_{x}\\, d k_{y} \\; \\delta\\!\\left(E - E_{c} - \\frac{\\hbar^{2}}{2}\\left(\\frac{k_{x}^{2}}{m_{x}} + \\frac{k_{y}^{2}}{m_{y}}\\right)\\right).\n$$\n\nOne direct way to evaluate this integral is to compute the integrated number of states per unit area with energy less than or equal to $E$, and then differentiate with respect to $E$. Define\n$$\n\\frac{N(E)}{A} \\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\int_{E(\\mathbf{k}) \\le E} d^{2}\\mathbf{k}.\n$$\nFor $E \\ge E_{c}$, the region $E(\\mathbf{k}) \\le E$ is an ellipse in $\\mathbf{k}$-space given by\n$$\n\\frac{k_{x}^{2}}{\\alpha_{x}^{2}} + \\frac{k_{y}^{2}}{\\alpha_{y}^{2}} \\;\\le\\; 1,\n$$\nwith semi-axes\n$$\n\\alpha_{x} \\;=\\; \\sqrt{\\frac{2 m_{x} (E - E_{c})}{\\hbar^{2}}}, \n\\qquad\n\\alpha_{y} \\;=\\; \\sqrt{\\frac{2 m_{y} (E - E_{c})}{\\hbar^{2}}}.\n$$\nThe area in $\\mathbf{k}$-space enclosed by this ellipse is\n$$\nS_{\\mathbf{k}}(E) \\;=\\; \\pi \\alpha_{x} \\alpha_{y} \\;=\\; \\pi \\,\\frac{2 (E - E_{c})}{\\hbar^{2}} \\,\\sqrt{m_{x} m_{y}}.\n$$\nTherefore,\n$$\n\\frac{N(E)}{A} \\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\, S_{\\mathbf{k}}(E) \n\\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\left[ \\pi \\,\\frac{2 (E - E_{c})}{\\hbar^{2}} \\,\\sqrt{m_{x} m_{y}} \\right]\n\\;=\\; \\frac{g_{s} g_{v}}{2\\pi \\hbar^{2}} \\,\\sqrt{m_{x} m_{y}} \\, (E - E_{c}),\n$$\nvalid for $E \\ge E_{c}$, while $\\frac{N(E)}{A} = 0$ for $E < E_{c}$. The density of states per unit area per unit energy is the derivative with respect to $E$:\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{d}{dE}\\left(\\frac{N(E)}{A}\\right) \\;=\\; \\frac{g_{s} g_{v}}{2\\pi \\hbar^{2}} \\,\\sqrt{m_{x} m_{y}},\n$$\nfor $E \\ge E_{c}$. This result is independent of $E$ above the band edge. It is zero below $E_{c}$, which may be compactly encoded with a Heaviside step function $\\Theta(E - E_{c})$ if one desires a single expression valid for all $E$:\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{g_{s} g_{v}}{2\\pi \\hbar^{2}} \\,\\sqrt{m_{x} m_{y}} \\;\\Theta(E - E_{c}).\n$$\nSince the problem requests the expression for $E \\ge E_{c}$, the constant value displayed above is the final form.",
            "answer": "$$\\boxed{\\frac{g_s g_v}{2\\pi \\hbar^2}\\sqrt{m_x m_y}}$$"
        },
        {
            "introduction": "Analytical derivations provide deep insight, but many problems in device modeling require robust numerical solutions. This computational practice  bridges the gap between abstract theory and practical implementation by guiding you to calculate the 2D density of states from its fundamental definition in $k$-space. By discretizing the $k$-space integral and approximating the Dirac delta function, you will not only verify the constant nature of the 2D DOS but also gain practical experience with essential concepts of numerical simulation, such as convergence, discretization error, and the role of artificial broadening.",
            "id": "3737366",
            "problem": "You are to design and implement a complete, runnable program that computes the two-dimensional Density of States (DOS) using a first-principles discretization of $k$-space. The program must start from the following fundamental bases and facts:\n\n- The density of states (DOS) $g(E)$ is defined as the number of quantum states per unit area per unit energy at energy $E$ for a two-dimensional system.\n- Under periodic boundary conditions in real space of area $A$, discrete wave vectors $\\mathbf{k}$ in reciprocal space occupy a uniform grid, and the number of states per unit area corresponding to a differential area $d^2k$ in reciprocal space is $d^2k/(2\\pi)^2$.\n- For a two-dimensional parabolic conduction band, the energy dispersion is $E(\\mathbf{k}) = E_c + \\hbar^2\\lVert \\mathbf{k}\\rVert^2/(2m^\\ast)$, where $E_c$ is the band edge energy, $m^\\ast$ is the effective mass, and $\\hbar$ is the reduced Planck constant.\n- To numerically count states at energy $E$, represent the Dirac delta function $\\delta(E - E(\\mathbf{k}))$ by a normalized Gaussian of energy width $\\eta$,\n$$\n\\delta_\\eta\\big(E - E(\\mathbf{k})\\big) = \\frac{1}{\\sqrt{2\\pi}\\,\\eta}\\exp\\!\\left(-\\frac{\\big(E - E(\\mathbf{k})\\big)^2}{2\\eta^2}\\right),\n$$\nand approximate the $k$-space integral by a finite sum over a uniform square grid in $\\mathbf{k}$ with spacing $\\Delta k$ and domain cutoff $k_{\\max}$.\n\nAlgorithm specification:\n- Construct a square grid of $k_x$ and $k_y$ over $[-k_{\\max},k_{\\max}] \\times [-k_{\\max},k_{\\max}]$ with $N_k$ points per axis, spacing $\\Delta k = 2k_{\\max}/(N_k-1)$.\n- For each grid point, compute $E(\\mathbf{k})$ using the parabolic dispersion, and form the Gaussian weight $\\delta_\\eta\\big(E - E(\\mathbf{k})\\big)$.\n- Sum the weights over the grid, multiply by $\\Delta k^2$, and normalize by $(2\\pi)^2$ to obtain $g(E)$ per unit area. Include a spin degeneracy factor of $g_s = 2$ (no valley degeneracy).\n- The domain cutoff $k_{\\max}$ must be chosen as a multiple of the constant-energy circle radius $k_0$ that satisfies $E - E_c = \\hbar^2 k_0^2/(2m^\\ast)$, i.e., $k_{\\max} = f \\, k_0$ for a given factor $f$.\n\nYour program must evaluate the numerical DOS and compare it to the exact analytical DOS for a two-dimensional parabolic band with spin degeneracy $g_s = 2$ and zero valley degeneracy, which is constant for $E > E_c$. The analytical DOS per unit area per unit energy is\n$$\ng_{\\text{exact}}(E) = \\frac{g_s\\,m^\\ast}{2\\pi\\,\\hbar^2} \\quad \\text{for } E > E_c,\\quad \\text{and } g_{\\text{exact}}(E)=0 \\text{ for } E \\le E_c.\n$$\nYour program must compute the relative error as a dimensionless float,\n$$\n\\varepsilon = \\frac{\\big|g_{\\text{num}}(E) - g_{\\text{exact}}(E)\\big|}{g_{\\text{exact}}(E)},\n$$\nfor each test case where $E > E_c$.\n\nUnit specifications:\n- Energies $E$ and $E_c$ must be treated in electronvolts (eV) in the test suite and converted to joules (J) internally. The broadening $\\eta$ must be treated in electronvolts (eV) and converted to joules (J). The output relative errors are dimensionless floats (no unit).\n- Effective mass $m^\\ast$ is specified as a multiple of the electron mass $m_e$ (unitless multiplier), internally converted to kilograms (kg).\n- Wave vector $k$ has units of meters inverse ($\\mathrm{m}^{-1}$), handled internally.\n\nConvergence discussion requirement:\n- Your solution must reason from the base definitions to explain why the two-dimensional DOS is constant for a parabolic band and how the numerical scheme converges with finer $k$-space grid spacing $\\Delta k$ and sufficiently large $k_{\\max}$. Address the roles of discretization error, domain truncation error, and the choice of broadening $\\eta$ relative to the energy resolution implied by the $k$-grid spacing (through $\\mathrm{d}E/\\mathrm{d}k$).\n\nTest suite:\nFor each test case, use $E_c = 0\\,\\mathrm{eV}$ and spin degeneracy $g_s = 2$.\n\nProvide the following five parameter sets, each as a tuple $(f_{m^\\ast}, E\\,\\mathrm{(eV)}, N_k, \\eta\\,\\mathrm{(eV)}, f)$ where $f_{m^\\ast}$ is the multiplier on $m_e$ and $f$ sets $k_{\\max} = f\\,k_0$:\n\n1. $(0.067, 0.2, 601, 0.005, 3.0)$ — happy path: fine grid, moderate broadening, sufficiently large domain.\n2. $(0.067, 0.2, 81, 0.005, 3.0)$ — coarse grid: same energy and domain, smaller $N_k$ to test discretization error.\n3. $(0.067, 0.001, 601, 0.0002, 3.0)$ — near band edge: small energy and small broadening, tests sensitivity near $E_c$.\n4. $(0.067, 0.2, 401, 0.005, 0.8)$ — domain truncation: $f < 1$ so $k_{\\max}$ does not cover the constant-energy circle, tests truncation error.\n5. $(0.067, 0.2, 81, 0.03, 3.0)$ — coarse grid with large broadening: tests whether increasing $\\eta$ mitigates discretization effects.\n\nRequired final output format:\n- Your program should produce a single line of output containing the relative errors for the five test cases, as a comma-separated list enclosed in square brackets, in the same order as the test suite above. For example: \"[e1,e2,e3,e4,e5]\".",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a standard computational physics task rooted in the fundamental principles of semiconductor statistical mechanics. All necessary parameters and methods are explicitly defined, permitting a unique and meaningful solution.\n\nThe problem requires the calculation of the two-dimensional ($2$D) density of states (DOS), $g(E)$, for a parabolic energy band, both analytically and via a numerical k-space discretization, and to evaluate the relative error of the numerical method.\n\nFirst, we derive the analytical expression for the $2$D DOS for a parabolic band to establish the theoretical baseline and address the required discussion on why it is constant. The DOS per unit area is defined as the sum over all allowed quantum states $\\mathbf{k}$ per unit energy, including a spin degeneracy factor $g_s$. In the continuous limit for a large area $A$, the sum over discrete $\\mathbf{k}$-states is replaced by an integral over k-space:\n$$\ng(E) = \\frac{g_s}{A} \\sum_{\\mathbf{k}} \\delta(E - E(\\mathbf{k})) \\longrightarrow g_s \\int \\frac{d^2k}{(2\\pi)^2} \\delta(E - E(\\mathbf{k}))\n$$\nThe energy dispersion relation is given as $E(\\mathbf{k}) = E_c + \\frac{\\hbar^2 \\lVert \\mathbf{k} \\rVert^2}{2m^\\ast}$, where $E_c$ is the conduction band minimum, $m^\\ast$ is the effective mass, and $\\hbar$ is the reduced Planck constant. For simplicity, we express the energy in terms of the magnitude of the wave vector, $k = \\lVert \\mathbf{k} \\rVert$, as $E(k) = E_c + \\frac{\\hbar^2 k^2}{2m^\\ast}$.\n\nTo evaluate the integral, we transform to polar coordinates in k-space, where the differential area element is $d^2k = k \\, dk \\, d\\theta$.\n$$\ng(E) = g_s \\int_0^{2\\pi} d\\theta \\int_0^\\infty dk \\, \\frac{k}{(2\\pi)^2} \\delta\\left(E - \\left(E_c + \\frac{\\hbar^2 k^2}{2m^\\ast}\\right)\\right)\n$$\nThe integrand is independent of the angle $\\theta$, so the angular integral yields a factor of $2\\pi$:\n$$\ng(E) = \\frac{g_s}{2\\pi} \\int_0^\\infty k \\, dk \\, \\delta\\left(E - E_c - \\frac{\\hbar^2 k^2}{2m^\\ast}\\right)\n$$\nWe perform a change of variables to evaluate the remaining integral. Let $u = E_c + \\frac{\\hbar^2 k^2}{2m^\\ast}$. The differential is $du = \\frac{\\hbar^2 k}{m^\\ast} dk$, which gives $k \\, dk = \\frac{m^\\ast}{\\hbar^2} du$. The integration limits change from $k \\in [0, \\infty)$ to $u \\in [E_c, \\infty)$.\n$$\ng(E) = \\frac{g_s}{2\\pi} \\int_{E_c}^\\infty \\left(\\frac{m^\\ast}{\\hbar^2}\\right) du \\, \\delta((E-E_c) - (u-E_c)) = \\frac{g_s m^\\ast}{2\\pi \\hbar^2} \\int_{E_c}^\\infty du \\, \\delta(E - u)\n$$\nBy the sifting property of the Dirac delta function, the integral is $1$ if the point $u=E$ lies within the integration domain—that is, if $E > E_c$—and $0$ otherwise. Therefore, the analytical DOS for a $2$D parabolic band is:\n$$\ng_{\\text{exact}}(E) = \\begin{cases} \\frac{g_s m^\\ast}{2\\pi \\hbar^2} & \\text{for } E > E_c \\\\ 0 & \\text{for } E \\le E_c \\end{cases}\n$$\nThis result demonstrates that for energies above the band edge, the $2$D DOS is constant, a hallmark feature of a two-dimensional electron gas (2DEG).\n\nNext, we formalize the numerical procedure. The task is to approximate the k-space integral by a sum over a discrete grid. The Dirac delta function, $\\delta(x)$, is unsuited for direct numerical evaluation and is thus regularized using a normalized Gaussian function of width $\\eta$:\n$$\n\\delta(E - E(\\mathbf{k})) \\approx \\delta_\\eta(E - E(\\mathbf{k})) = \\frac{1}{\\sqrt{2\\pi}\\,\\eta}\\exp\\left(-\\frac{(E - E(\\mathbf{k}))^2}{2\\eta^2}\\right)\n$$\nThe continuous integral $\\iint dk_x dk_y$ is replaced by a sum over grid points $(k_{x,i}, k_{y,j})$ with a uniform spacing $\\Delta k$, such that the area element becomes $\\Delta k^2$. The numerical DOS, $g_{\\text{num}}(E)$, is then calculated as:\n$$\ng_{\\text{num}}(E) = \\frac{g_s}{(2\\pi)^2} \\sum_{i,j} \\delta_\\eta(E - E(k_{x,i}, k_{y,j})) \\Delta k^2\n$$\nThe sum is performed over a square grid in k-space defined by $k_x, k_y \\in [-k_{\\max}, k_{\\max}]$, with $N_k$ points along each axis and spacing $\\Delta k = 2k_{\\max}/(N_k-1)$.\n\nThe numerical accuracy of this method is subject to three primary sources of error, which we must analyze:\n$1$. Discretization Error: This arises from approximating the continuous integral with a finite Riemann sum. The accuracy depends on the grid density. A coarser grid (larger $\\Delta k$, smaller $N_k$) provides a poorer approximation of the integral. As $N_k \\rightarrow \\infty$ (and thus $\\Delta k \\rightarrow 0$), the sum converges to the integral, and this error diminishes. Test Case $2$ ($N_k=81$) is designed to exhibit larger discretization error compared to Test Case $1$ ($N_k=601$).\n$2$. Domain Truncation Error: The integral is taken over a finite square, $[-k_{\\max}, k_{\\max}]^2$, instead of the infinite k-plane. The integrand, $\\delta_\\eta(E - E(\\mathbf{k}))$, is maximally concentrated on the constant-energy circle defined by $E(\\mathbf{k}) = E$. The radius of this circle is $k_0 = \\sqrt{2m^\\ast(E-E_c)}/\\hbar$. If $k_{\\max}$ is not significantly larger than $k_0$ (i.e., the factor $f$ in $k_{\\max} = f \\cdot k_0$ is not large enough), the calculation will omit contributions from parts of k-space where the Gaussian is non-negligible, leading to an underestimation of the DOS. Test Case $4$ ($f=0.8$) deliberately truncates the domain before the constant-energy circle is fully enclosed, which is expected to produce a large error.\n$3$. Broadening Error: The Gaussian function is an approximation of the Dirac delta function. The choice of the broadening parameter, $\\eta$, is critical. For the approximation to be valid, $\\eta$ should be small. However, on a discrete grid, if $\\eta$ is smaller than the characteristic energy spacing between adjacent k-points, $\\Delta E_{\\text{grid}} \\approx \\frac{dE}{dk}|_{k_0} \\Delta k$, the Gaussian may become too narrow, \"falling between\" grid points and leading to a noisy, inaccurate sum. Conversely, a very large $\\eta$ over-smooths the DOS, reducing energy resolution and poorly approximating the delta function. A suitable $\\eta$ must be large enough to smoothly sample the discrete k-points but small enough to represent a sharp energy level. Test Case $5$ explores how a large $\\eta$ can mitigate the noise from a coarse grid by averaging over more states, potentially reducing the error observed in Test Case $2$ at the cost of physical resolution.\n\nThe implementation will proceed by first defining the physical constants and the test case parameters. For each case, all inputs in electronvolts (eV) are converted to SI units (Joules). The analytical DOS, $g_{\\text{exact}}$, is computed as a reference. The k-space grid is constructed according to the specified $N_k$ and $k_{\\max}$, which is derived from $E$ and $m^\\ast$. The energy $E(\\mathbf{k})$ is calculated for every point on the grid. Subsequently, the Gaussian weights are computed and summed, applying the appropriate normalization factors to obtain $g_{\\text{num}}$. Finally, the relative error, $\\varepsilon = |g_{\\text{num}} - g_{\\text{exact}}|/g_{\\text{exact}}$, is calculated and stored. This process is repeated for all five test cases. The final output is a list of these relative errors.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import hbar, m_e, e\n\ndef solve():\n    \"\"\"\n    Computes the 2D Density of States (DOS) numerically and compares it to the\n    analytical solution for a parabolic band to find the relative error.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (f_m_star, E_eV, N_k, eta_eV, f)\n    # f_m_star: effective mass as a multiplier of m_e\n    # E_eV: energy of interest in eV\n    # N_k: number of points per axis in the k-space grid\n    # eta_eV: Gaussian broadening in eV\n    # f: factor to set k_max = f * k_0\n    test_cases = [\n        (0.067, 0.2, 601, 0.005, 3.0),   # 1. Happy path: fine grid, sufficient domain\n        (0.067, 0.2, 81, 0.005, 3.0),    # 2. Coarse grid: tests discretization error\n        (0.067, 0.001, 601, 0.0002, 3.0), # 3. Near band edge: tests low energy/broadening\n        (0.067, 0.2, 401, 0.005, 0.8),    # 4. Domain truncation: tests truncation error\n        (0.067, 0.2, 81, 0.03, 3.0),     # 5. Coarse grid with large broadening\n    ]\n\n    results = []\n    for case in test_cases:\n        f_m_star, E_eV, N_k, eta_eV, f_k_max_factor = case\n        \n        # --- Parameter setup and unit conversion to SI ---\n        m_star = f_m_star * m_e  # Effective mass in kg\n        E_c_J = 0.0              # Band edge energy in Joules\n        E_J = E_eV * e           # Energy of interest in Joules\n        eta_J = eta_eV * e       # Broadening energy in Joules\n        g_s = 2.0                # Spin degeneracy factor\n\n        # All test cases have E > E_c, so g_exact is non-zero.\n        \n        # --- Analytical DOS Calculation ---\n        # For a 2D system with a parabolic band, the DOS is constant for E > E_c.\n        # g_exact(E) = g_s * m* / (2 * pi * hbar^2)\n        g_exact = (g_s * m_star) / (2.0 * np.pi * hbar**2)\n        \n        # --- Numerical DOS Calculation ---\n        \n        # 1. Determine k-space grid parameters\n        # From the dispersion E - E_c = hbar^2 * k_0^2 / (2 * m*), solve for k_0\n        k0 = np.sqrt(2.0 * m_star * (E_J - E_c_J)) / hbar\n        k_max = f_k_max_factor * k0\n        \n        # k-space grid spacing\n        # For N_k > 1, the spacing is 2*k_max / (N_k - 1)\n        if N_k <= 1:\n            # Handle edge case of a single point grid. Sum becomes a single term.\n            delta_k = 2.0 * k_max\n        else:\n            delta_k = 2.0 * k_max / (N_k - 1)\n        \n        # 2. Construct the k-space grid\n        k_axis = np.linspace(-k_max, k_max, N_k)\n        kx, ky = np.meshgrid(k_axis, k_axis)\n        \n        # 3. Compute energy dispersion E(k) on the grid\n        k_squared = kx**2 + ky**2\n        E_k_grid = E_c_J + (hbar**2 * k_squared) / (2.0 * m_star)\n        \n        # 4. Compute Gaussian weights representing the delta function\n        # delta_eta(E - E(k)) = (1/sqrt(2*pi)*eta) * exp(-(E-E(k))^2 / (2*eta^2))\n        exponent = -((E_J - E_k_grid)**2) / (2.0 * eta_J**2)\n        gaussian_weights = (1.0 / (np.sqrt(2.0 * np.pi) * eta_J)) * np.exp(exponent)\n        \n        # 5. Sum weights over the grid and apply normalization factors\n        # The integral is approximated by a sum: integral(f(k) d^2k) -> sum(f(k_ij) * delta_k^2)\n        # g_num(E) = (g_s / (2*pi)^2) * sum(delta_eta * delta_k^2)\n        g_num = (g_s / (4.0 * np.pi**2)) * np.sum(gaussian_weights) * delta_k**2\n        \n        # --- Relative Error Calculation ----\n        relative_error = np.abs(g_num - g_exact) / g_exact\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}