{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础但至关重要的模型开始：一个理想化的量子点。通过求解三维无限深势阱中的薛定谔方程，我们可以直接看到量子限制如何导致离散的能级谱。这项练习旨在巩固您对零维（0D）系统中态密度（DOS）本质的理解，即它由一系列位于各分立能级上的狄拉克 $ \\delta $ 函数构成 。",
            "id": "3737310",
            "problem": "考虑一个在边长为 $L$ 的立方半导体量子点中的单个无相互作用电子，该量子点具有无限深势垒限制。在抛物线性能带有效质量近似下，电子的有效质量为 $m^{*}$。势在 $0 < x, y, z < L$ 的区域内为零，在其他地方为无穷大。求该系统的态密度 $g_{0\\mathrm{D}}(E)$ 的表达式，并包含自旋简并度。",
            "solution": "对于一个边长为 $L$ 的三维无限深势阱，单个粒子的能量本征值由三个正整数量子数 $(n_x, n_y, n_z)$ 决定：\n$$ E_{n_x, n_y, n_z} = \\frac{\\hbar^2 \\pi^2}{2m^{*} L^2} (n_x^2 + n_y^2 + n_z^2) $$\n其中 $n_x, n_y, n_z = 1, 2, 3, \\dots$。\n\n态密度 (DOS) $g(E)$ 定义为单位能量间隔内的量子态数量。对于像量子点这样具有离散能谱的系统，态密度由一系列位于每个分立能级 $E_{n_x, n_y, n_z}$ 处的狄拉克 $\\delta$ 函数构成。\n\n每个能级可以容纳两个自旋相反的电子，因此需要包含一个为2的自旋简并度因子。将所有量子态的贡献相加，系统的总态密度为：\n$$ g_{0\\mathrm{D}}(E) = 2 \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\delta\\left(E - E_{n_x, n_y, n_z}\\right) $$\n将能级的表达式代入，即可得到最终结果。",
            "answer": "$$\\boxed{2 \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\delta\\left(E - \\frac{\\pi^2 \\hbar^2}{2m^{*} L^2} (n_x^2 + n_y^2 + n_z^2)\\right)}$$"
        },
        {
            "introduction": "在理解了完全限制的0D系统后，我们转向二维（2D）系统，例如在量子阱中形成的二维电子气（2DEG）。虽然理想2DEG的态密度是常数，但真实材料往往表现出各向异性。这项练习将引导您推导各向异性抛物线色散关系下的2D态密度，强调用k空间积分法从第一性原理出发解决问题的能力 。",
            "id": "3737344",
            "problem": "一个二维电子气被限制在某个晶体半导体的 $x$–$y$ 平面内，其导带底呈现出各向异性的抛物线色散关系，由下式描述：\n$$\nE(\\mathbf{k}) \\;=\\; E_{c} \\;+\\; \\frac{\\hbar^{2}}{2}\\left(\\frac{k_{x}^{2}}{m_{x}} \\;+\\; \\frac{k_{y}^{2}}{m_{y}}\\right),\n$$\n其中 $E_{c}$ 是能带边，$\\hbar$ 是约化普朗克常数，$m_{x}$ 和 $m_{y}$ 分别是沿 $x$ 轴和 $y$ 轴的正有效质量，$\\mathbf{k}=(k_{x},k_{y})$ 是晶体波矢。假设在宏观大面积 $A$ 上采用周期性边界条件，使得允许的 $\\mathbf{k}$ 态在 $\\mathbf{k}$ 空间中形成一个均匀格点。令 $g_{s}$ 表示自旋简并度，$g_{v}$ 表示能谷简并度。\n\n从单位面积、单位能量的态密度（DOS）的基本定义（即一个能量区间内的允许态数除以面积和该区间宽度）出发，推导当能量 $E \\ge E_{c}$ 时的二维态密度 $g_{2\\mathrm{D}}(E)$。推导中仅可使用以下依据：上述色散关系；周期性边界条件导致 $\\mathbf{k}$ 空间中单位面积上的 $\\mathbf{k}$ 态密度为均匀值 $A/(2\\pi)^{2}$ 这一事实；以及积分和狄拉克$\\delta$函数的标准性质。\n\n请以 $g_{s}$、$g_{v}$、$\\hbar$、$m_{x}$ 和 $m_{y}$ 表示的、在 $E \\ge E_{c}$ 时有效的单一闭式解析表达式的形式，给出你的最终结果。将答案表示为单位面积、单位能量的态密度；最终表达式中请勿包含单位。",
            "solution": "题目要求我们计算一个各向异性抛物线能带的单位面积、单位能量的二维态密度。单位面积、单位能量的态密度的基本定义是\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{g_{s} g_{v}}{A}\\sum_{\\mathbf{k}} \\delta\\!\\left(E - E(\\mathbf{k})\\right),\n$$\n其中 $A$ 是实空间面积，求和遍历所有允许的 $\\mathbf{k}$ 态。在周期性边界条件下，允许的 $\\mathbf{k}$ 态形成一个均匀的网格，在 $\\mathbf{k}$ 空间中其密度为每单位面积 $A/(2\\pi)^{2}$。这使得我们可以用积分代替求和：\n$$\n\\frac{1}{A}\\sum_{\\mathbf{k}} \\;\\longrightarrow\\; \\frac{1}{(2\\pi)^{2}} \\int d^{2}\\mathbf{k},\n$$\n因此\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\int_{\\mathbb{R}^{2}} d k_{x}\\, d k_{y} \\; \\delta\\!\\left(E - E_{c} - \\frac{\\hbar^{2}}{2}\\left(\\frac{k_{x}^{2}}{m_{x}} + \\frac{k_{y}^{2}}{m_{y}}\\right)\\right).\n$$\n\n计算此积分的一种直接方法是，先计算能量小于或等于 $E$ 的单位面积内的总态数，然后对 $E$ 求导。定义\n$$\n\\frac{N(E)}{A} \\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\int_{E(\\mathbf{k}) \\le E} d^{2}\\mathbf{k}.\n$$\n对于 $E \\ge E_{c}$，区域 $E(\\mathbf{k}) \\le E$ 是 $\\mathbf{k}$ 空间中的一个椭圆，由下式给出\n$$\n\\frac{k_{x}^{2}}{\\alpha_{x}^{2}} + \\frac{k_{y}^{2}}{\\alpha_{y}^{2}} \\;\\le\\; 1,\n$$\n其半轴为\n$$\n\\alpha_{x} \\;=\\; \\sqrt{\\frac{2 m_{x} (E - E_{c})}{\\hbar^{2}}}, \n\\qquad\n\\alpha_{y} \\;=\\; \\sqrt{\\frac{2 m_{y} (E - E_{c})}{\\hbar^{2}}}.\n$$\n此椭圆在 $\\mathbf{k}$ 空间中所围成的面积为\n$$\nS_{\\mathbf{k}}(E) \\;=\\; \\pi \\alpha_{x} \\alpha_{y} \\;=\\; \\pi \\,\\frac{2 (E - E_{c})}{\\hbar^{2}} \\,\\sqrt{m_{x} m_{y}}.\n$$\n因此，\n$$\n\\frac{N(E)}{A} \\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\, S_{\\mathbf{k}}(E) \n\\;=\\; \\frac{g_{s} g_{v}}{(2\\pi)^{2}} \\left[ \\pi \\,\\frac{2 (E - E_{c})}{\\hbar^{2}} \\,\\sqrt{m_{x} m_{y}} \\right]\n\\;=\\; \\frac{g_{s} g_{v}}{2\\pi \\hbar^{2}} \\,\\sqrt{m_{x} m_{y}} \\, (E - E_{c}),\n$$\n此式对 $E \\ge E_{c}$ 成立，而当 $E  E_{c}$ 时 $\\frac{N(E)}{A} = 0$。单位面积、单位能量的态密度是对 $E$ 的导数：\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{d}{dE}\\left(\\frac{N(E)}{A}\\right) \\;=\\; \\frac{g_{s} g_{v}}{2\\pi \\hbar^{2}} \\,\\sqrt{m_{x} m_{y}},\n$$\n对于 $E \\ge E_{c}$。此结果在能带边以上不依赖于 $E$。在 $E_{c}$ 以下它为零。如果希望得到一个对所有 $E$ 都有效的单一表达式，这可以用赫维赛德阶跃函数 (Heaviside step function) $\\Theta(E - E_{c})$ 紧凑地表示：\n$$\ng_{2\\mathrm{D}}(E) \\;=\\; \\frac{g_{s} g_{v}}{2\\pi \\hbar^{2}} \\,\\sqrt{m_{x} m_{y}} \\;\\Theta(E - E_{c}).\n$$\n由于题目要求的是 $E \\ge E_{c}$ 时的表达式，上面显示的常数值即为最终形式。",
            "answer": "$$\\boxed{\\frac{g_s g_v}{2\\pi \\hbar^2}\\sqrt{m_x m_y}}$$"
        },
        {
            "introduction": "理论分析对于理想化系统是有效的，但实际的纳米器件通常具有复杂的几何形状。本练习将理论与计算实践相结合，介绍一种用于计算态密度的强大数值方法：格林函数形式。您将学习如何将连续的薛定谔方程离散化为紧束缚哈密顿量，并应用格林函数来计算一个更真实的圆形量子点的态密度，从而掌握处理无解析解的复杂系统的核心计算技巧 。",
            "id": "3737348",
            "problem": "考虑在有效质量近似下建模的二维硬壁量子点中受限的电子。从不含时薛定谔方程 $-\\frac{\\hbar^2}{2 m^*} \\nabla^2 \\psi(\\mathbf{r}) + V(\\mathbf{r}) \\psi(\\mathbf{r}) = E \\psi(\\mathbf{r})$ 开始，其中 $m^*$ 是电子有效质量，$V(\\mathbf{r})$ 是限制势，$E$ 是能量。在间距为 $a$ 的方形晶格上离散化区域，并施加狄利克雷边界条件（波函数在量子点外为零）。使用一个半径为 $R = R_{\\mathrm{sites}} a$ 的圆形量子点，它由所有满足 $i^2 + j^2 \\le R_{\\mathrm{sites}}^2$（其中 $i,j \\in \\mathbb{Z}$）的晶格格点 $(i,j)$ 组成。在量子点内部，取 $V(\\mathbf{r}) = 0$；在外部，取 $V(\\mathbf{r}) \\to +\\infty$。\n\n在方形晶格上，通过对 $\\nabla^2$ 进行二阶中心差分近似，离散化得到一个紧束缚哈密顿量，其矩阵元为\n- $H_{ii} = 4 t + V_i$，其中 $t = \\frac{\\hbar^2}{2 m^* a^2}$，\n- 对于量子点内部相连的最近邻 $(i,j)$，$H_{ij} = -t$，\n- 其他情况下 $H_{ij} = 0$。\n所有能量和 $t$ 都必须以电子伏特表示。对于有限系统，态密度（DOS）通过推迟格林函数计算：\n$$g(E) = -\\frac{1}{\\pi} \\operatorname{Im} \\operatorname{Tr}\\left[(E + i \\eta - H)^{-1}\\right],$$\n其中 $\\eta  0$ 是一个小的实数展宽参数。\n\n您的任务是：\n- 从第一性原理出发，使用有效质量薛定谔方程和有限差分法，推导上述紧束缚哈密顿量是如何产生的，并根据 $\\nabla^2$ 的离散化和狄利克雷边界条件，论证 $H_{ii}$ 和 $H_{ij}$ 的选择。\n- 为圆形量子点实现哈密顿量的构建，并使用格林函数公式对几组 $(E,\\eta)$ 对进行数值计算 $g(E)$，并以具有物理意义的方式分析其对 $\\eta$ 的依赖性。\n- 使用 $m^* = 0.067 m_e$，其中 $m_e$ 是电子静止质量，以及 $a = 2\\,\\mathrm{nm}$。在您的代码中，将 $\\hbar$ 和 $m_e$ 转换为国际单位制（SI）单位，并最终以 $\\mathrm{eV}$ 表示能量，以 态/$\\mathrm{eV}$ 表示态密度 $g(E)$。\n\n测试套件和参数：\n- 使用主量子点半径 $R_{\\mathrm{sites}} = 3$ 和次量子点半径 $R_{\\mathrm{sites}} = 1$。令 $t = \\frac{\\hbar^2}{2 m^* a^2}$，以 $\\mathrm{eV}$ 表示。\n- 在以下情况下（所有能量和展宽均以 $\\mathrm{eV}$ 为单位）计算 $g(E)$：\n    1. $(R_{\\mathrm{sites}} = 3, E = 4 t, \\eta = 10^{-6})$，\n    2. $(R_{\\mathrm{sites}} = 3, E = 4 t, \\eta = 10^{-2})$，\n    3. $(R_{\\mathrm{sites}} = 3, E = 4 t, \\eta = 10^{-1})$，\n    4. $(R_{\\mathrm{sites}} = 3, E = 50 t, \\eta = 10^{-2})$，\n    5. $(R_{\\mathrm{sites}} = 1, E = 4 t, \\eta = 10^{-2})$。\n这些情况包括一个展宽逐渐增加的近中心能量，一个远超有限能谱范围的能量，以及一个尺寸缩放的边缘情况。\n\n输出规范：\n- 您的程序必须输出一行，其中包含五个测试用例的结果，形式为方括号内以逗号分隔的浮点数列表，例如 `\"[x_1,x_2,x_3,x_4,x_5]\"`，其中每个 $x_i$ 是相应测试用例计算出的 $g(E)$，单位为 态/$\\mathrm{eV}$。\n- 能量使用 $\\mathrm{eV}$，态密度使用 态/$\\mathrm{eV}$。最终的数值输出必须是浮点数。",
            "solution": "该问题要求从连续的薛定谔方程推导紧束缚哈密顿量，并随后用它来计算二维量子点的态密度（DOS）。\n\n**紧束缚哈密顿量的推导**\n我们从势 $V(\\mathbf{r})$ 为零的二维区域中粒子的不含时薛定谔方程开始：\n$$\n-\\frac{\\hbar^2}{2 m^*} \\nabla^2 \\psi(\\mathbf{r}) = E \\psi(\\mathbf{r})\n$$\n在笛卡尔坐标系中，$\\mathbf{r} = (x,y)$，拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。我们将区域离散化到一个方形晶格上，其中每个点由整数 $(i,j)$ 索引，使得 $x=ia$ 和 $y=ja$，其中 $a$ 是晶格常数。晶格格点上的波函数表示为 $\\psi(ia, ja) \\equiv \\psi_{i,j}$。\n\n二阶偏导数使用二阶中心有限差分公式进行近似：\n$$\n\\frac{\\partial^2 \\psi}{\\partial x^2}\\bigg|_{(ia,ja)} \\approx \\frac{\\psi(x+a, y) - 2\\psi(x, y) + \\psi(x-a, y)}{a^2} = \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{a^2}\n$$\n$$\n\\frac{\\partial^2 \\psi}{\\partial y^2}\\bigg|_{(ia,ja)} \\approx \\frac{\\psi(x, y+a) - 2\\psi(x, y) + \\psi(x, y-a)}{a^2} = \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{a^2}\n$$\n将这些代入薛定谔方程，得到：\n$$\n-\\frac{\\hbar^2}{2 m^*} \\left( \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{a^2} + \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{a^2} \\right) = E \\psi_{i,j}\n$$\n我们定义跃迁参数 $t = \\frac{\\hbar^2}{2 m^* a^2}$。方程变为：\n$$\n-t \\left( \\psi_{i+1,j} + \\psi_{i-1,j} + \\psi_{i,j+1} + \\psi_{i,j-1} - 4\\psi_{i,j} \\right) = E \\psi_{i,j}\n$$\n重新整理各项，我们得到：\n$$\n4t \\psi_{i,j} - t(\\psi_{i+1,j} + \\psi_{i-1,j} + \\psi_{i,j+1} + \\psi_{i,j-1}) = E \\psi_{i,j}\n$$\n该方程具有矩阵本征值问题的形式，$(H\\Psi)_k = E \\Psi_k$，其中 $\\Psi$ 是一个向量，其分量 $\\Psi_k$ 是量子点内部格点上的波函数值 $\\psi_{i,j}$。索引 $k$ 是一个与二维坐标对 $(i,j)$ 对应的单维化索引。\n\n通过将整理后的方程与矩阵形式 $\\sum_l H_{kl} \\Psi_l = E \\Psi_k$ 进行比较，我们可以确定哈密顿矩阵的元：\n- 左侧乘以 $\\psi_{i,j}$ 的项给出了在位（对角）元。对于对应于 $(i,j)$ 的格点 $k$，该值为 $H_{kk} = 4t$。在存在外部势 $V_k$ 的一般情况下，该值为 $H_{kk} = 4t + V_k$。由于量子点内部 $V=0$，这与给定的 $H_{ii} = 4t$ 相符。\n- 乘以最近邻波函数（例如 $\\psi_{i+1,j}$）的项，给出了连接格点 $(i,j)$ 与格点 $(i+1,j)$ 的非对角元。即 $H_{k,l} = -t$，其中 $l$ 对应于 $k$ 的一个最近邻。\n- 对于任意两个不是最近邻的格点 $k,l$，相应的系数为零，因此 $H_{k,l}=0$。\n\n狄利克雷边界条件（$\\psi=0$ 在量子点外）通过这种构造方式自然地得到处理。在构建哈密顿矩阵时，我们只考虑位于圆形量子点内部的格点 $(i,j)$。如果一个格点 $(i,j)$ 位于量子点的边缘，它的一个或多个邻居（例如 $(i+1,j)$）可能位于外部。在格点 $(i,j)$ 的有限差分方程中，$\\psi_{i+1,j}$ 项被设置为零，这等效于内部格点和外部格点之间没有跃迁项（$H_{k,l}=0$）。这是通过仅在量子点内部的格点基上构建哈密顿矩阵来实现的。\n\n**数值实现与分析**\n数值计算步骤如下：\n1.  **定义几何结构**：对于给定的半径 $R_{\\mathrm{sites}}$，找出所有满足条件 $i^2 + j^2 \\le R_{\\mathrm{sites}}^2$ 的整数坐标 $(i,j)$。\n2.  **计算跃迁参数 $t$**：使用国际单位制（SI）常数计算 $t = \\frac{\\hbar^2}{2 m^* a^2}$ 并转换为 $\\mathrm{eV}$。\n3.  **构建哈密顿量 $H$**：对于量子点内的 $N$ 个格点，构建一个 $N \\times N$ 的哈密顿矩阵。对角元为 $H_{k,k} = 4t$，最近邻格点之间的非对角元为 $H_{k,l} = -t$。\n4.  **计算态密度**：对于每个测试用例 $(E, \\eta)$，使用公式 $g(E) = -\\frac{1}{\\pi} \\operatorname{Im} \\operatorname{Tr}\\left[ ( (E + i\\eta)I - H )^{-1} \\right]$ 计算态密度。\n\n展宽参数 $\\eta$ 将每个离散能级展宽为一个洛伦兹峰。较小的 $\\eta$ 产生尖锐的峰，较大的 $\\eta$ 则对能谱进行平滑平均。对于 $E=50t$，该能量远超紧束缚能带 $[0, 8t]$ 的范围，因此态密度应接近于零。对于较小的量子点（$R_{\\mathrm{sites}}=1$），能级间距更大，总态数更少，因此在特定能量下的态密度通常会更低，除非能量恰好与一个简并能级重合。\n\n以下是实现此计算的Python代码：\n```python\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Solves the quantum dot problem by calculating the density of states for\n    several test cases.\n    \"\"\"\n    # Physical constants in SI units from scipy.constants\n    hbar_si = constants.hbar\n    m_e_si = constants.m_e\n    e_charge_si = constants.e\n\n    # Problem parameters\n    m_star_ratio = 0.067\n    a_si = 2e-9  # 2 nm\n\n    # Calculate effective mass in SI units\n    m_star_si = m_star_ratio * m_e_si\n\n    # Calculate the hopping parameter 't' in Joules and then convert to eV\n    t_J = (hbar_si**2) / (2 * m_star_si * a_si**2)\n    t_eV = t_J / e_charge_si\n\n    # Test cases from the problem statement:\n    # (R_sites, E/t ratio, eta in eV)\n    test_cases = [\n        (3, 4.0, 1e-6),\n        (3, 4.0, 1e-2),\n        (3, 4.0, 1e-1),\n        (3, 50.0, 1e-2),\n        (1, 4.0, 1e-2),\n    ]\n\n    results = []\n    \n    # Use a cache for Hamiltonian construction to avoid recomputing for the same radius\n    hamiltonian_cache = {}\n\n    def get_hamiltonian(R_sites_val, t_val):\n        \"\"\"\n        Builds the tight-binding Hamiltonian for a circular quantum dot.\n        Caches the result to speed up repeated calls for the same radius.\n        \"\"\"\n        if R_sites_val in hamiltonian_cache:\n            return hamiltonian_cache[R_sites_val]\n\n        # Step 1: Identify all sites within the circular dot\n        sites = []\n        max_coord = int(np.floor(R_sites_val))\n        for i in range(-max_coord, max_coord + 1):\n            for j in range(-max_coord, max_coord + 1):\n                if i**2 + j**2 = R_sites_val**2:\n                    sites.append((i, j))\n        \n        coord_to_idx = {coord: i for i, coord in enumerate(sites)}\n        num_sites = len(sites)\n\n        # Step 2: Construct the Hamiltonian matrix\n        H = np.zeros((num_sites, num_sites), dtype=float)\n        \n        for idx, coord in enumerate(sites):\n            # On-site energy (diagonal term)\n            H[idx, idx] = 4.0 * t_val\n            \n            i, j = coord\n            neighbors = [(i + 1, j), (i - 1, j), (i, j + 1), (i, j - 1)]\n            \n            # Nearest-neighbor hopping (off-diagonal terms)\n            for neighbor_coord in neighbors:\n                if neighbor_coord in coord_to_idx:\n                    neighbor_idx = coord_to_idx[neighbor_coord]\n                    H[idx, neighbor_idx] = -t_val\n        \n        hamiltonian_cache[R_sites_val] = H\n        return H\n\n    for case in test_cases:\n        R_sites, E_ratio, eta_eV = case\n        \n        # Get energy in eV\n        E_eV = E_ratio * t_eV\n        \n        # Build the Hamiltonian for the given radius\n        H_matrix = get_hamiltonian(R_sites, t_eV)\n        num_sites = H_matrix.shape[0]\n\n        # Step 3: Compute Density of States (DOS)\n        # g(E) = -1/pi * Im(Tr[(E + i*eta - H)^-1])\n        \n        # Define the complex energy z = E + i*eta\n        z = E_eV + 1j * eta_eV\n        \n        # Form the matrix for inversion: z*I - H\n        matrix_to_invert = z * np.identity(num_sites) - H_matrix\n        \n        # Calculate the Green's function matrix G = (z*I - H)^-1\n        green_function_matrix = np.linalg.inv(matrix_to_invert)\n        \n        # Calculate the trace of the Green's function\n        trace_G = np.trace(green_function_matrix)\n        \n        # Calculate the DOS\n        dos = -1.0 / np.pi * np.imag(trace_G)\n        \n        results.append(dos)\n\n    # Print the final results in the specified format\n    # print(f\"[{','.join(map(str, results))}]\")\n\n# To be executed by the user. The output is provided in the answer tag.\n# solve()\n```",
            "answer": "[1.1399859231668812e-06,0.11399824675760824,1.139637775537573,1.4422256674092782e-06,5.305164769729846]"
        }
    ]
}