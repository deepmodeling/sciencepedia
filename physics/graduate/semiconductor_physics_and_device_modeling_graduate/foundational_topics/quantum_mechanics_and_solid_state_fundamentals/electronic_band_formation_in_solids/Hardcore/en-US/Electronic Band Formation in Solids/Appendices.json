{
    "hands_on_practices": [
        {
            "introduction": "The nearly-free electron model provides the simplest yet most powerful illustration of how electronic bands form. This practice challenges you to apply perturbation theory to the case of nearly-degenerate states at the Brillouin zone boundary, allowing you to analytically derive the magnitude of the energy gap opened by a weak periodic potential. By working through this calculation , you will gain a concrete understanding of how the Fourier components of the crystal potential directly determine the band structure.",
            "id": "3741782",
            "problem": "Consider a one-dimensional electron subject to a weak, real, spatially periodic potential with lattice period $a$, so that the reciprocal lattice vector magnitude is $G = \\frac{2\\pi}{a}$. The single-electron Hamiltonian is\n$$\n\\hat{H} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + V(x),\n$$\nwith $V(x)$ periodic of period $a$. Assume the potential is\n$$\nV(x) = A\\cos\\!\\big(G x + \\phi_{1}\\big) + B\\cos\\!\\big(G x - \\phi_{2}\\big) + C\\cos\\!\\big(2G x + \\psi\\big),\n$$\nwhere $A$, $B$, and $C$ are real amplitudes and $\\phi_{1}$, $\\phi_{2}$, and $\\psi$ are real phases. The electron is treated within the nearly free electron approximation, and you are to analyze the formation of an energy gap at the first Brillouin zone (BZ) boundary due to Bragg scattering between the plane-wave states at wavevectors $k$ and $k-G$ when $k$ approaches $G/2$.\n\nStarting from the single-electron Schrödinger equation, use Bloch’s theorem and a plane-wave expansion to derive the minimal two-state secular equation that captures the coupling between the nearly degenerate basis $\\{e^{ikx}, e^{i(k-G)x}\\}$ at the zone boundary. Identify the Fourier coefficient of $V(x)$ that mediates this coupling and show how it determines the band-edge splitting at $k=G/2$. Then, for the specific parameter values\n$$\nA = 0.180\\,\\mathrm{eV},\\quad B = 0.120\\,\\mathrm{eV},\\quad C = 0.050\\,\\mathrm{eV},\\quad \\phi_{1} = 0.30,\\quad \\phi_{2} = 0.60,\\quad \\psi = 1.20,\n$$\nwith all angles in radians, compute the magnitude of the energy gap that opens at the first BZ boundary. Express your final numerical result in electronvolts (eV) and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the energy gap at the first Brillouin zone (BZ) boundary for an electron in a one-dimensional weak periodic potential within the nearly free electron approximation.\n\nThe single-electron Schrödinger equation is given by\n$$ \\hat{H}\\psi(x) = E\\psi(x) $$\nwhere the Hamiltonian is $\\hat{H} = \\hat{H}_0 + V(x)$, with $\\hat{H}_0 = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$ being the free-electron Hamiltonian and $V(x)$ being the periodic potential.\n\nAccording to Bloch's theorem, the wavefunction for an electron in a periodic potential can be written as a plane wave $e^{ikx}$ modulated by a function $u_k(x)$ that has the same periodicity as the lattice, i.e., $u_k(x+a)=u_k(x)$. We can expand both the periodic part of the wavefunction, $u_k(x)$, and the potential $V(x)$ into Fourier series over the reciprocal lattice vectors $K_n = nG = n(2\\pi/a)$:\n$$ \\psi_k(x) = \\sum_{K} C_{k-K} e^{i(k-K)x} $$\n$$ V(x) = \\sum_{K} V_K e^{iKx} $$\nSubstituting these expansions into the Schrödinger equation yields:\n$$ \\left( -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + \\sum_{K'} V_{K'} e^{iK'x} \\right) \\left( \\sum_{K} C_{k-K} e^{i(k-K)x} \\right) = E \\sum_{K} C_{k-K} e^{i(k-K)x} $$\nThe kinetic energy operator acting on a plane wave yields its energy eigenvalue:\n$$ -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} e^{i(k-K)x} = \\frac{\\hbar^2(k-K)^2}{2m} e^{i(k-K)x} = E_{k-K}^0 e^{i(k-K)x} $$\nwhere $E_{q}^0 = \\frac{\\hbar^{2}q^2}{2m}$ is the free-electron energy. The equation becomes:\n$$ \\sum_{K} E_{k-K}^0 C_{k-K} e^{i(k-K)x} + \\sum_{K'} \\sum_{K} V_{K'} C_{k-K} e^{i(k-K+K')x} = E \\sum_{K} C_{k-K} e^{i(k-K)x} $$\nTo find the equation for a specific coefficient, say $C_{k-K''}$, we match the terms with the same plane-wave factor $e^{i(k-K'')x}$. In the potential term, this requires $k-K+K' = k-K''$, or $K' = K-K''$. This leads to the central equations:\n$$ (E_{k-K''}^0 - E)C_{k-K''} + \\sum_{K} V_{K-K''}C_{k-K} = 0 $$\nThis is an infinite coupled system of linear equations.\n\nIn the nearly free electron model, the potential $V(x)$ is weak, so we can use perturbation theory. A significant effect occurs when two or more free-electron states are nearly degenerate. This happens at the Brillouin zone boundaries. For the first BZ boundary, the relevant wavevector is $k = G/2$. At this point, the free-electron state with wavevector $k$ is degenerate with the state with wavevector $k-G = G/2 - G = -G/2$, since $E_{G/2}^0 = E_{-G/2}^0$.\n\nFor $k \\approx G/2$, the states $|k\\rangle$ (represented by $e^{ikx}$) and $|k-G\\rangle$ (represented by $e^{i(k-G)x}$) are nearly degenerate. We can truncate the infinite system to a two-state model involving only the coefficients $C_k$ and $C_{k-G}$.\nThe two relevant central equations (setting $K''=0$ and $K''=G$) are:\n$$ (E_k^0 - E)C_k + V_0 C_k + V_{-G} C_{k-G} + \\dots = 0 $$\n$$ (E_{k-G}^0 - E)C_{k-G} + V_G C_k + V_0 C_{k-G} + \\dots = 0 $$\nHere, $V_0$ is the average potential, which causes a uniform shift in energy and can be absorbed into $E$. Neglecting higher-order terms and $V_0$, we obtain the minimal two-state secular equation:\n$$\n\\begin{pmatrix}\nE_k^0 - E & V_{-G} \\\\\nV_G & E_{k-G}^0 - E\n\\end{pmatrix}\n\\begin{pmatrix}\nC_k \\\\\nC_{k-G}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFor a non-trivial solution, the determinant of the matrix must be zero.\n\nThe next step is to find the Fourier coefficients of the potential $V(x)$. The potential is:\n$$ V(x) = A\\cos(Gx + \\phi_{1}) + B\\cos(Gx - \\phi_{2}) + C\\cos(2Gx + \\psi) $$\nUsing Euler's formula, $\\cos\\theta = \\frac{1}{2}(e^{i\\theta} + e^{-i\\theta})$, we can write $V(x)$ as a Fourier series:\n$$ V(x) = \\frac{A}{2}\\left( e^{i(Gx+\\phi_1)} + e^{-i(Gx+\\phi_1)} \\right) + \\frac{B}{2}\\left( e^{i(Gx-\\phi_2)} + e^{-i(Gx-\\phi_2)} \\right) + \\frac{C}{2}\\left( e^{i(2Gx+\\psi)} + e^{-i(2Gx+\\psi)} \\right) $$\n$$ V(x) = \\left( \\frac{A}{2}e^{i\\phi_1} + \\frac{B}{2}e^{-i\\phi_2} \\right)e^{iGx} + \\left( \\frac{A}{2}e^{-i\\phi_1} + \\frac{B}{2}e^{i\\phi_2} \\right)e^{-iGx} + \\left( \\frac{C}{2}e^{i\\psi} \\right)e^{i2Gx} + \\left( \\frac{C}{2}e^{-i\\psi} \\right)e^{-i2Gx} $$\nBy comparing this to the general Fourier series $V(x) = \\sum_K V_K e^{iKx}$, we identify the coefficients that mediate the coupling between the states $|k\\rangle$ and $|k-G\\rangle$. These are $V_G$ and $V_{-G}$.\n$$ V_G = \\frac{A}{2}e^{i\\phi_1} + \\frac{B}{2}e^{-i\\phi_2} $$\n$$ V_{-G} = \\frac{A}{2}e^{-i\\phi_1} + \\frac{B}{2}e^{i\\phi_2} $$\nFor a real potential $V(x)$, it must be that $V_{-G} = V_G^*$, which is satisfied by our expressions since $A$, $B$, $\\phi_{1}$, and $\\phi_{2}$ are real. The potential component with amplitude $C$ corresponds to $V_{2G}$ and $V_{-2G}$, which would couple states $k$ and $k-2G$. This is relevant for the gap at the second BZ boundary ($k=G$) but not the first.\n\nAt the first BZ boundary, $k=G/2$, the unperturbed energies are degenerate: $E_{G/2}^0 = E_{-G/2}^0 = E_{ZB}^0$. The secular determinant becomes:\n$$ \\det\\begin{pmatrix} E_{ZB}^0 - E & V_{-G} \\\\ V_G & E_{ZB}^0 - E \\end{pmatrix} = (E_{ZB}^0 - E)^2 - V_G V_{-G} = 0 $$\nSince $V_{-G}=V_G^*$, this simplifies to $(E_{ZB}^0 - E)^2 = |V_G|^2$.\nThe solutions for the energy $E$ are:\n$$ E = E_{ZB}^0 \\pm |V_G| $$\nThe degeneracy is lifted, and an energy gap opens at the zone boundary. The energy gap, $\\Delta E_g$, is the difference between the two new energy levels:\n$$ \\Delta E_g = (E_{ZB}^0 + |V_G|) - (E_{ZB}^0 - |V_G|) = 2|V_G| $$\nThis shows that the Fourier coefficient $V_G$ determines the splitting, and the magnitude of the gap is $2$ times the magnitude of $V_G$.\n\nTo compute the gap, we must find $|V_G|$.\n$$ V_G = \\frac{1}{2}\\left( A(\\cos\\phi_1 + i\\sin\\phi_1) + B(\\cos\\phi_2 - i\\sin\\phi_2) \\right) $$\n$$ V_G = \\frac{1}{2}\\left( (A\\cos\\phi_1 + B\\cos\\phi_2) + i(A\\sin\\phi_1 - B\\sin\\phi_2) \\right) $$\nThe magnitude squared is $|V_G|^2 = (\\text{Re}(V_G))^2 + (\\text{Im}(V_G))^2$:\n$$ |V_G|^2 = \\frac{1}{4}\\left( (A\\cos\\phi_1 + B\\cos\\phi_2)^2 + (A\\sin\\phi_1 - B\\sin\\phi_2)^2 \\right) $$\n$$ |V_G|^2 = \\frac{1}{4}\\left( A^2\\cos^2\\phi_1 + B^2\\cos^2\\phi_2 + 2AB\\cos\\phi_1\\cos\\phi_2 + A^2\\sin^2\\phi_1 + B^2\\sin^2\\phi_2 - 2AB\\sin\\phi_1\\sin\\phi_2 \\right) $$\n$$ |V_G|^2 = \\frac{1}{4}\\left( A^2(\\cos^2\\phi_1+\\sin^2\\phi_1) + B^2(\\cos^2\\phi_2+\\sin^2\\phi_2) + 2AB(\\cos\\phi_1\\cos\\phi_2 - \\sin\\phi_1\\sin\\phi_2) \\right) $$\nUsing trigonometric identities, this simplifies to:\n$$ |V_G|^2 = \\frac{1}{4}\\left( A^2 + B^2 + 2AB\\cos(\\phi_1 + \\phi_2) \\right) $$\nThe energy gap is therefore:\n$$ \\Delta E_g = 2|V_G| = \\sqrt{A^2 + B^2 + 2AB\\cos(\\phi_1 + \\phi_2)} $$\nNow we substitute the given numerical values:\n$A = 0.180\\,\\mathrm{eV}$, $B = 0.120\\,\\mathrm{eV}$, $\\phi_1 = 0.30\\,\\mathrm{rad}$, and $\\phi_2 = 0.60\\,\\mathrm{rad}$.\n\n$A^2 = (0.180)^2 = 0.0324$\n$B^2 = (0.120)^2 = 0.0144$\n$2AB = 2(0.180)(0.120) = 0.0432$\n$\\phi_1 + \\phi_2 = 0.30 + 0.60 = 0.90\\,\\mathrm{rad}$\n$\\cos(\\phi_1 + \\phi_2) = \\cos(0.90) \\approx 0.62161$\n\nNow, we calculate the square of the energy gap:\n$$ \\Delta E_g^2 = 0.0324 + 0.0144 + 0.0432 \\times \\cos(0.90) $$\n$$ \\Delta E_g^2 = 0.0468 + 0.0432 \\times 0.621610017... $$\n$$ \\Delta E_g^2 = 0.0468 + 0.026855552... $$\n$$ \\Delta E_g^2 = 0.073655552... $$\nTaking the square root to find the energy gap:\n$$ \\Delta E_g = \\sqrt{0.073655552...} \\approx 0.27139556... \\,\\mathrm{eV} $$\nRounding to four significant figures, the magnitude of the energy gap is $0.2714\\,\\mathrm{eV}$.",
            "answer": "$$\\boxed{0.2714}$$"
        },
        {
            "introduction": "While analytical models are invaluable for intuition, realistic band structure calculations require computational methods. This exercise  guides you through the process of implementing the plane-wave basis method, the workhorse of modern electronic structure theory. You will construct the Hamiltonian matrix for a general one-dimensional potential and numerically diagonalize it to find the energy bands, thereby bridging the gap between simplified theory and practical computation.",
            "id": "3741817",
            "problem": "Consider a one-dimensional crystal with lattice constant $a$ and a real, periodic pseudopotential $V(x)$ satisfying $V(x+a) = V(x)$. An electron of mass $m$ in this crystal obeys the time-independent Schrödinger equation $-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\psi(x) + V(x)\\psi(x) = E\\psi(x)$. Using Bloch's theorem, $\\psi_k(x) = e^{ikx}u_k(x)$ with $u_k(x+a) = u_k(x)$, expand $u_k(x)$ in a plane-wave basis over reciprocal lattice vectors $G = n\\frac{2\\pi}{a}$ for integer $n$, truncated symmetrically to a finite cutoff. The periodic pseudopotential can be written in a Fourier series $V(x) = \\sum_G V_G e^{iGx}$, where $V_G$ are the Fourier components and $V_{-G} = V_G^*$ for a real $V(x)$.\n\nYour tasks are:\n- Starting from the Schrödinger equation and Bloch's theorem, derive the finite-dimensional secular problem in the plane-wave basis by projecting onto $e^{i(k+G)x}$. Clearly identify the Hamiltonian matrix elements in terms of $k$, $G$, and the Fourier components $V_G$.\n- Implement a program that, for a given lattice constant $a$, a plane-wave cutoff $N_{\\text{max}}$ (meaning include $G = n\\frac{2\\pi}{a}$ for all integers $n$ with $-N_{\\text{max}} \\le n \\le N_{\\text{max}}$), and a finite set of nonzero Fourier components $\\{V_{m}\\}$ specified at harmonics $G = m\\frac{2\\pi}{a}$, constructs the Hamiltonian matrix at the Brillouin Zone (BZ) boundary wave vector $k = \\frac{\\pi}{a}$, diagonalizes it, and returns the band gap defined as the difference between the two lowest eigenvalues at this $k$.\n- In your implementation, use the electron rest mass $m = m_e$, reduced Planck's constant $\\hbar$, and convert energies to electronvolts. Express the final band gaps in electronvolts and round each to six decimal places.\n- The program must produce a single line of output containing the band gaps for all test cases as a comma-separated list enclosed in square brackets.\n\nPhysical constants must be treated as:\n- $m_e$ in $\\text{kg}$,\n- $\\hbar$ in $\\text{J}\\cdot\\text{s}$,\n- $1\\,\\text{eV}$ in $\\text{J}$.\n\nAssume the pseudopotential Fourier components are given as real-valued electronvolts associated with integer harmonics $m$, with $V_{-m} = V_m$ and $V_0$ allowed. The Hamiltonian truncation must be implemented by restricting to $-N_{\\text{max}} \\le n \\le N_{\\text{max}}$.\n\nTest suite:\n- Case A: $a = 5.0\\times 10^{-10}\\,\\text{m}$, $N_{\\text{max}} = 1$, $V_0 = 0.0\\,\\text{eV}$, $V_{+1} = 0.4\\,\\text{eV}$, $V_{-1} = 0.4\\,\\text{eV}$.\n- Case B: $a = 5.0\\times 10^{-10}\\,\\text{m}$, $N_{\\text{max}} = 1$, $V_0 = 0.0\\,\\text{eV}$, $V_{+1} = 0.05\\,\\text{eV}$, $V_{-1} = 0.05\\,\\text{eV}$.\n- Case C: $a = 4.0\\times 10^{-10}\\,\\text{m}$, $N_{\\text{max}} = 1$, $V_0 = 0.0\\,\\text{eV}$, $V_{+1} = 0.0\\,\\text{eV}$, $V_{-1} = 0.0\\,\\text{eV}$.\n- Case D: $a = 5.0\\times 10^{-10}\\,\\text{m}$, $N_{\\text{max}} = 2$, $V_0 = 0.0\\,\\text{eV}$, $V_{+1} = 0.2\\,\\text{eV}$, $V_{-1} = 0.2\\,\\text{eV}$, $V_{+2} = 0.1\\,\\text{eV}$, $V_{-2} = 0.1\\,\\text{eV}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC,resultD]\"), where each result is the band gap at $k = \\pi/a$ in $\\text{eV}$ rounded to six decimal places. No other text should be printed.",
            "solution": "The starting point is the one-dimensional, time-independent Schrödinger equation for an electron of mass $m$ in a periodic potential $V(x)$:\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$$\nThe potential is periodic with the lattice constant $a$, so $V(x+a) = V(x)$. According to Bloch's theorem, the wavefunction solutions $\\psi_k(x)$ can be written in the form $\\psi_k(x) = e^{ikx}u_k(x)$, where $u_k(x)$ has the same periodicity as the lattice, $u_k(x+a)=u_k(x)$. The crystal momentum $k$ is a good quantum number.\n\nSince both $u_k(x)$ and $V(x)$ are periodic with period $a$, they can be expanded in a Fourier series over the reciprocal lattice vectors $G = n\\frac{2\\pi}{a}$ for integer $n$:\n$$u_k(x) = \\sum_{G} C_G e^{iGx}$$\n$$V(x) = \\sum_{G} V_G e^{iGx}$$\nThe coefficients $C_G$ depend on $k$, which is omitted for brevity. Substituting the expansion for $u_k(x)$ into the Bloch form for $\\psi_k(x)$ gives a plane-wave expansion for the wavefunction:\n$$\\psi_k(x) = e^{ikx} \\sum_{G} C_G e^{iGx} = \\sum_{G} C_G e^{i(k+G)x}$$\n\nNow, we substitute the plane-wave expansions for $\\psi_k(x)$ and $V(x)$ into the Schrödinger equation:\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) + \\left(\\sum_{G''} V_{G''} e^{iG''x}\\right)\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) = E_k \\left(\\sum_{G} C_G e^{i(k+G)x}\\right)$$\nLet's evaluate each term. The kinetic energy term is:\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) = \\sum_{G} \\frac{\\hbar^2(k+G)^2}{2m} C_G e^{i(k+G)x}$$\nThe potential energy term is:\n$$\\left(\\sum_{G''} V_{G''} e^{iG''x}\\right)\\left(\\sum_{G} C_G e^{i(k+G)x}\\right) = \\sum_{G, G''} V_{G''} C_G e^{i(k+G+G'')x}$$\nThe equation becomes:\n$$\\sum_{G} \\frac{\\hbar^2(k+G)^2}{2m} C_G e^{i(k+G)x} + \\sum_{G, G''} V_{G''} C_G e^{i(k+G+G'')x} = E_k \\sum_{G} C_G e^{i(k+G)x}$$\nTo obtain a set of algebraic equations for the coefficients $C_G$, we project the entire equation onto a particular basis state, for example by multiplying by $e^{-i(k+G')x}$ and integrating over one unit cell (from $x=0$ to $x=a$):\n$$\\frac{1}{a} \\int_0^a dx\\; e^{-i(k+G')x} \\left[ \\dots \\right]$$\nThe orthogonality relation for these plane waves is $\\frac{1}{a} \\int_0^a e^{i(K-K')x} dx = \\delta_{K,K'}$. Applying this to each term yields:\n1.  Kinetic term: $\\frac{\\hbar^2(k+G')^2}{2m} C_{G'}$\n2.  Potential term: $\\sum_G V_{G'-G} C_G$\n3.  Energy term: $E_k C_{G'}$\n\nCombining these terms gives the central equation:\n$$\\frac{\\hbar^2(k+G')^2}{2m} C_{G'} + \\sum_{G} V_{G'-G} C_G = E_k C_{G'}$$\nRearranging this equation reveals a matrix eigenvalue problem:\n$$\\left( \\frac{\\hbar^2(k+G')^2}{2m} \\right) C_{G'} + \\sum_{G} V_{G'-G} C_G = E_k C_{G'}$$\nThis can be written as $\\sum_G H_{G',G} C_G = E_k C_{G'}$, which is the matrix equation $\\mathbf{H}\\mathbf{C} = E\\mathbf{C}$. The Hamiltonian matrix elements $H_{G',G}$ are given by:\n$$H_{G',G} = \\frac{\\hbar^2(k+G)^2}{2m}\\delta_{G',G} + V_{G'-G}$$\nThe diagonal elements ($G'=G$) are the free-electron kinetic energies plus the average potential $V_0$, and the off-diagonal elements are the Fourier components of the potential $V_{G'-G}$, which couple the different plane-wave states.\n\nFor the numerical implementation, the infinite set of basis functions must be truncated. The problem specifies a symmetric truncation where the reciprocal lattice vectors are $G_n = n\\frac{2\\pi}{a}$ for integers $n$ such that $-N_{\\text{max}} \\le n \\le N_{\\text{max}}$. This results in a finite-dimensional Hamiltonian matrix of size $(2N_{\\text{max}}+1) \\times (2N_{\\text{max}}+1)$. The indices of the matrix, say $i$ and $j$, run from $0$ to $2N_{\\text{max}}$ and can be mapped to the harmonic indices $n = i - N_{\\text{max}}$ and $m = j - N_{\\text{max}}$.\n\nThe problem asks for the band gap at the Brillouin Zone boundary, $k=\\frac{\\pi}{a}$. The matrix elements to be computed are:\n$$H_{ij} = \\frac{\\hbar^2}{2m}\\left(\\frac{\\pi}{a} + n_j\\frac{2\\pi}{a}\\right)^2 \\delta_{ij} + V_{n_i - n_j}$$\nwhere $n_i = i-N_{\\text{max}}$ and $n_j = j-N_{\\text{max}}$. The potential components $V_m$ are given in electronvolts (eV) and must be converted to Joules for consistency with the kinetic energy term calculated using SI units for $\\hbar$ and $m$.\n\nThe computational procedure is:\n1.  For a given test case ($a$, $N_{\\text{max}}$, $\\{V_m\\}$), define the dimension of the Hamiltonian matrix, $D = 2N_{\\text{max}}+1$.\n2.  Construct the $D \\times D$ Hamiltonian matrix $\\mathbf{H}$. The kinetic energy term forms the diagonal, and the potential components form the off-diagonal (and part of the diagonal, via $V_0$) elements. Ensure all energy units are in Joules.\n3.  The problem states that $V(x)$ is real and the given $V_m$ are real, implying $V_{-m} = V_m$. This makes the potential part of the matrix, $V_{n_i - n_j}$, real and symmetric. The full Hamiltonian matrix is therefore real and symmetric.\n4.  Diagonalize the matrix $\\mathbf{H}$ to find its eigenvalues. For a real symmetric matrix, these eigenvalues are real and represent the electron energy levels $E_0, E_1, \\dots, E_{D-1}$ at $k=\\frac{\\pi}{a}$.\n5.  Sort the eigenvalues in ascending order.\n6.  Convert the eigenvalues from Joules back to electronvolts (eV).\n7.  The band gap is defined as the difference between the two lowest eigenvalues: $E_{\\text{gap}} = E_1 - E_0$.\n8.  Round the final band gap value to six decimal places as required.\nThis procedure is implemented for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the electronic band gap problem for the provided test cases.\n    \"\"\"\n\n    # Physical constants in SI units\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J.s\n    M_E = 9.1093837015e-31   # Electron rest mass in kg\n    EV_TO_J = 1.602176634e-19 # Conversion factor from eV to Joules\n\n    # Test cases from the problem statement\n    test_cases = [\n        {'a': 5.0e-10, 'N_max': 1, 'V_comp': {0: 0.0, 1: 0.4, -1: 0.4}},\n        {'a': 5.0e-10, 'N_max': 1, 'V_comp': {0: 0.0, 1: 0.05, -1: 0.05}},\n        {'a': 4.0e-10, 'N_max': 1, 'V_comp': {0: 0.0, 1: 0.0, -1: 0.0}},\n        {'a': 5.0e-10, 'N_max': 2, 'V_comp': {0: 0.0, 1: 0.2, -1: 0.2, 2: 0.1, -2: 0.1}},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a = case['a']\n        N_max = case['N_max']\n        V_comp_ev = case['V_comp']\n        \n        # Convert potential components from eV to Joules\n        V_comp_joules = {m: val * EV_TO_J for m, val in V_comp_ev.items()}\n\n        # Wave vector at the Brillouin Zone boundary\n        k = np.pi / a\n\n        # Dimension of the Hamiltonian matrix\n        dim = 2 * N_max + 1\n        \n        # Array of integers n for G_n = n * 2*pi/a\n        n_values = np.arange(-N_max, N_max + 1)\n        \n        # Construct the Hamiltonian matrix H\n        H = np.zeros((dim, dim))\n\n        for i in range(dim):\n            for j in range(dim):\n                n_i = n_values[i]\n                n_j = n_values[j]\n\n                # Diagonal elements: kinetic energy\n                if i == j:\n                    # Wave vector k + G_n\n                    k_plus_G = k + n_j * (2 * np.pi / a)\n                    kinetic_energy = (HBAR**2 * k_plus_G**2) / (2 * M_E)\n                    H[i, j] = kinetic_energy\n                \n                # Potential energy terms (off-diagonal and diagonal)\n                harmonic_diff = n_i - n_j\n                if harmonic_diff in V_comp_joules:\n                    H[i, j] += V_comp_joules[harmonic_diff]\n\n        # Diagonalize the Hermitian matrix to find the eigenvalues (energies).\n        # eigh is efficient for Hermitian matrices and returns sorted eigenvalues.\n        eigenvalues_joules = eigh(H, eigvals_only=True)\n\n        # Convert eigenvalues from Joules to eV\n        eigenvalues_ev = eigenvalues_joules / EV_TO_J\n\n        # The band gap is the difference between the two lowest energy levels\n        band_gap = eigenvalues_ev[1] - eigenvalues_ev[0]\n        \n        results.append(band_gap)\n\n    # Format output as a comma-separated list of strings rounded to 6 decimal places\n    # enclosed in square brackets.\n    formatted_results = ','.join([f\"{res:.6f}\" for res in results])\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The delocalized Bloch waves of k-space are not the only valid description of electrons in a crystal; a complementary, localized picture is provided by Wannier functions. This exercise  explores this powerful real-space representation, which forms the rigorous foundation for tight-binding models. You will construct a maximally localized Wannier function for a simple two-band model and quantify its spatial spread, revealing the deep connection between the geometric properties of Bloch bands and the nature of chemical bonding in solids.",
            "id": "3741793",
            "problem": "Consider a one-dimensional crystal with lattice constant $a$ and two orthonormal tight-binding (TB) orbitals per unit cell: an orbital $\\lvert B_n \\rangle$ centered at position $x = n a$ and an orbital $\\lvert A_{n+1} \\rangle$ centered at position $x = (n+1)a$, where $n \\in \\mathbb{Z}$. Assume negligible intra-orbital spatial extent so that the real-space orbitals can be treated as position eigenstates at their site centers for the purpose of computing moments in $x$. The TB Hamiltonian has on-site energies $\\pm \\Delta/2$ on the $(A,B)$ sublattices and only a single intercell hopping $t$ that couples $\\lvert B_n \\rangle$ to $\\lvert A_{n+1} \\rangle$. In crystal momentum representation, the Bloch Hamiltonian in the $(A,B)$ sublattice basis is\n$$\nH(k) \\;=\\; \\begin{pmatrix}\n\\Delta/2 & t \\,\\exp(-\\mathrm{i} k a) \\\\\nt \\,\\exp(+\\mathrm{i} k a) & -\\Delta/2\n\\end{pmatrix},\n$$\nwith Brillouin Zone (BZ) $k \\in [-\\pi/a,\\pi/a]$.\n\nStarting from fundamental principles (Bloch’s theorem and the definition of Wannier functions as the inverse Fourier transform of Bloch eigenstates), do the following for the isolated lower-energy band of $H(k)$:\n\n1. Diagonalize $H(k)$ to obtain a smooth and BZ-periodic choice of the cell-periodic Bloch eigenvectors for the lower band. Construct the corresponding Wannier function $\\lvert W_0 \\rangle$ for the home cell by inverse Bloch transformation. Under the point-orbital approximation described above, write $\\lvert W_0 \\rangle$ explicitly as a normalized linear combination of the real-space orbitals $\\lvert B_0 \\rangle$ and $\\lvert A_1 \\rangle$ with coefficients that depend only on $t$ and $\\Delta$.\n\n2. Using the definition of the maximally localized Wannier function (MLWF) spread as the second central moment,\n$$\n\\Omega \\;=\\; \\langle W_0 \\rvert \\big(x - \\bar{x}\\big)^2 \\lvert W_0 \\rangle, \n\\quad \\text{where} \\quad \n\\bar{x} \\;=\\; \\langle W_0 \\rvert x \\lvert W_0 \\rangle,\n$$\ncompute $\\bar{x}$ and $\\Omega$ exactly for $\\lvert W_0 \\rangle$ derived in part 1. Treat the orbitals as point-like at $x=0$ for $\\lvert B_0 \\rangle$ and $x=a$ for $\\lvert A_1 \\rangle$.\n\nProvide your final result as a single closed-form expression for the MLWF spread $\\Omega$ in terms of $a$, $t$, and $\\Delta$. Express the final spread in square meters, taking $a$ in meters. However, only provide the symbolic expression; do not write units in the final boxed answer.",
            "solution": "The first step is to diagonalize the Bloch Hamiltonian $H(k)$ to find its eigenvalues and eigenvectors. The Hamiltonian is given as:\n$$\nH(k) = \\begin{pmatrix}\n\\frac{\\Delta}{2} & t \\exp(-\\mathrm{i} k a) \\\\\nt \\exp(\\mathrm{i} k a) & -\\frac{\\Delta}{2}\n\\end{pmatrix}\n$$\nThe eigenvalues $E$ are found by solving the characteristic equation $\\det(H(k) - E I) = 0$:\n$$\n\\left(\\frac{\\Delta}{2} - E\\right)\\left(-\\frac{\\Delta}{2} - E\\right) - \\left(t \\exp(-\\mathrm{i} k a)\\right)\\left(t \\exp(\\mathrm{i} k a)\\right) = 0\n$$\n$$\n-E^2 + \\left(\\frac{\\Delta}{2}\\right)^2 - t^2 = 0\n$$\n$$\nE^2 = t^2 + \\left(\\frac{\\Delta}{2}\\right)^2\n$$\nThe energy eigenvalues are independent of the crystal momentum $k$, indicating flat bands:\n$$\nE_{\\pm} = \\pm \\sqrt{t^2 + \\frac{\\Delta^2}{4}}\n$$\nWe are interested in the lower-energy band, with energy $E_{-} = - \\sqrt{t^2 + \\Delta^2/4}$. Let us denote $\\mathcal{E} = \\sqrt{t^2 + \\Delta^2/4}$ for simplicity. The lower band energy is $E_{-} = -\\mathcal{E}$.\n\nNext, we find the corresponding cell-periodic Bloch eigenvector $\\lvert u_{-}(k) \\rangle = \\begin{pmatrix} c_A(k) \\\\ c_B(k) \\end{pmatrix}$. It satisfies the equation $(H(k) - E_{-} I) \\lvert u_{-}(k) \\rangle = 0$:\n$$\n\\begin{pmatrix}\n\\frac{\\Delta}{2} + \\mathcal{E} & t \\exp(-\\mathrm{i} k a) \\\\\nt \\exp(\\mathrm{i} k a) & -\\frac{\\Delta}{2} + \\mathcal{E}\n\\end{pmatrix}\n\\begin{pmatrix}\nc_A(k) \\\\\nc_B(k)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFrom the first row, we get the relation:\n$$\n\\left(\\frac{\\Delta}{2} + \\mathcal{E}\\right) c_A(k) + t \\exp(-\\mathrm{i} k a) c_B(k) = 0\n$$\n$$\nc_A(k) = -\\frac{t \\exp(-\\mathrm{i} k a)}{\\mathcal{E} + \\frac{\\Delta}{2}} c_B(k)\n$$\nTo ensure a smooth and Brillouin Zone (BZ)-periodic choice for the eigenvector, we can choose $c_B(k)$ to be a positive real constant. The normalization condition $\\lvert c_A(k) \\rvert^2 + \\lvert c_B(k) \\rvert^2 = 1$ determines its value:\n$$\n\\left\\lvert -\\frac{t \\exp(-\\mathrm{i} k a)}{\\mathcal{E} + \\frac{\\Delta}{2}} \\right\\rvert^2 \\lvert c_B(k) \\rvert^2 + \\lvert c_B(k) \\rvert^2 = 1\n$$\n$$\n\\left(\\frac{t^2}{\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)^2} + 1\\right) \\lvert c_B(k) \\rvert^2 = 1\n$$\n$$\n\\frac{t^2 + \\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)^2}{\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)^2} \\lvert c_B(k) \\rvert^2 = 1\n$$\n$$\n\\frac{t^2 + \\mathcal{E}^2 + \\mathcal{E}\\Delta + \\frac{\\Delta^2}{4}}{\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)^2} \\lvert c_B(k) \\rvert^2 = 1\n$$\nSubstituting $\\mathcal{E}^2 = t^2 + \\Delta^2/4$:\n$$\n\\frac{\\mathcal{E}^2 - \\frac{\\Delta^2}{4} + \\mathcal{E}^2 + \\mathcal{E}\\Delta + \\frac{\\Delta^2}{4}}{\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)^2} \\lvert c_B(k) \\rvert^2 = 1\n$$\n$$\n\\frac{2\\mathcal{E}^2 + \\mathcal{E}\\Delta}{\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)^2} \\lvert c_B(k) \\rvert^2 = \\frac{2\\mathcal{E}\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)}{\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)^2} \\lvert c_B(k) \\rvert^2 = \\frac{2\\mathcal{E}}{\\mathcal{E} + \\frac{\\Delta}{2}} \\lvert c_B(k) \\rvert^2 = 1\n$$\nThus, we choose $c_B(k)$ to be the positive real constant:\n$$\nc_B(k) = \\sqrt{\\frac{\\mathcal{E} + \\frac{\\Delta}{2}}{2\\mathcal{E}}}\n$$\nAnd consequently, $c_A(k)$ is:\n$$\nc_A(k) = -\\frac{t \\exp(-\\mathrm{i} k a)}{\\mathcal{E} + \\frac{\\Delta}{2}} \\sqrt{\\frac{\\mathcal{E} + \\frac{\\Delta}{2}}{2\\mathcal{E}}} = -\\frac{t \\exp(-\\mathrm{i} k a)}{\\sqrt{2\\mathcal{E}\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)}}\n$$\nThe Wannier function for the home cell ($\\boldsymbol{R}=0$) is the inverse Fourier transform of the cell-periodic Bloch eigenvector:\n$$\n\\lvert W_0 \\rangle = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\lvert u_{-}(k) \\rangle dk\n$$\nIn the real-space tight-binding basis, $\\lvert W_0 \\rangle = \\sum_n (w_{A,n} \\lvert A_n \\rangle + w_{B,n} \\lvert B_n \\rangle)$, where the coefficients are given by the Fourier components of $c_A(k)$ and $c_B(k)$:\n$$\nw_{A,n} = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} c_A(k) \\exp(\\mathrm{i} k n a) dk \\quad \\text{and} \\quad w_{B,n} = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} c_B(k) \\exp(\\mathrm{i} k n a) dk\n$$\nSince $c_B(k)$ is a constant, its only non-zero Fourier component is for $n=0$:\n$$\nw_{B,n} = c_B \\cdot \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\exp(\\mathrm{i} k n a) dk = c_B \\cdot \\delta_{n,0}\n$$\nSo, only the coefficient for $\\lvert B_0 \\rangle$ is non-zero, $w_{B,0} = c_B$.\nFor the A-sublattice, $c_A(k)$ is proportional to $\\exp(-\\mathrm{i} k a)$. Its only non-zero Fourier component is for $n=1$:\n$$\nw_{A,n} = \\left( -\\frac{t}{\\sqrt{2\\mathcal{E}(\\mathcal{E} + \\Delta/2)}} \\right) \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\exp(-\\mathrm{i} k a) \\exp(\\mathrm{i} k n a) dk = \\left( -\\frac{t}{\\sqrt{2\\mathcal{E}(\\mathcal{E} + \\Delta/2)}} \\right) \\delta_{n,1}\n$$\nSo, only the coefficient for $\\lvert A_1 \\rangle$ is non-zero. Let us denote the coefficients as $c_{B_0} = w_{B,0}$ and $c_{A_1} = w_{A,1}$. The Wannier function is a superposition of just two orbitals:\n$$\n\\lvert W_0 \\rangle = c_{B_0} \\lvert B_0 \\rangle + c_{A_1} \\lvert A_1 \\rangle\n$$\nwith coefficients:\n$$\nc_{B_0} = \\sqrt{\\frac{\\mathcal{E} + \\frac{\\Delta}{2}}{2\\mathcal{E}}} \\quad \\text{and} \\quad c_{A_1} = -\\frac{t}{\\sqrt{2\\mathcal{E}\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)}}\n$$\n\nNow, we compute the spread $\\Omega$. According to the problem statement, the orbitals are treated as point-like at their centers: $\\hat{x}\\lvert B_0 \\rangle = 0 \\cdot \\lvert B_0 \\rangle$ and $\\hat{x}\\lvert A_1 \\rangle = a \\cdot \\lvert A_1 \\rangle$. The orbitals are orthonormal.\nThe mean position $\\bar{x}$ is:\n$$\n\\bar{x} = \\langle W_0 \\rvert \\hat{x} \\lvert W_0 \\rangle = \\left( c_{B_0}^* \\langle B_0 \\rvert + c_{A_1}^* \\langle A_1 \\rvert \\right) \\hat{x} \\left( c_{B_0} \\lvert B_0 \\rangle + c_{A_1} \\lvert A_1 \\rangle \\right)\n$$\n$$\n\\bar{x} = \\left( c_{B_0}^* \\langle B_0 \\rvert + c_{A_1}^* \\langle A_1 \\rvert \\right) \\left( 0 + c_{A_1} a \\lvert A_1 \\rangle \\right) = a \\lvert c_{A_1} \\rvert^2\n$$\nThe expectation value of $\\hat{x}^2$ is:\n$$\n\\langle \\hat{x}^2 \\rangle = \\langle W_0 \\rvert \\hat{x}^2 \\lvert W_0 \\rangle = \\left( c_{B_0}^* \\langle B_0 \\rvert + c_{A_1}^* \\langle A_1 \\rvert \\right) \\hat{x}^2 \\left( c_{B_0} \\lvert B_0 \\rangle + c_{A_1} \\lvert A_1 \\rangle \\right)\n$$\n$$\n\\langle \\hat{x}^2 \\rangle = \\left( c_{B_0}^* \\langle B_0 \\rvert + c_{A_1}^* \\langle A_1 \\rvert \\right) \\left( 0 + c_{A_1} a^2 \\lvert A_1 \\rangle \\right) = a^2 \\lvert c_{A_1} \\rvert^2\n$$\nThe spread $\\Omega$ is the second central moment:\n$$\n\\Omega = \\langle (\\hat{x}-\\bar{x})^2 \\rangle = \\langle \\hat{x}^2 \\rangle - \\bar{x}^2 = a^2 \\lvert c_{A_1} \\rvert^2 - (a \\lvert c_{A_1} \\rvert^2)^2 = a^2 \\lvert c_{A_1} \\rvert^2 (1 - \\lvert c_{A_1} \\rvert^2)\n$$\nFrom the normalization of $\\lvert W_0 \\rangle$, we have $\\lvert c_{B_0} \\rvert^2 + \\lvert c_{A_1} \\rvert^2 = 1$, so $1 - \\lvert c_{A_1} \\rvert^2 = \\lvert c_{B_0} \\rvert^2$.\n$$\n\\Omega = a^2 \\lvert c_{A_1} \\rvert^2 \\lvert c_{B_0} \\rvert^2\n$$\nNow, substitute the squared magnitudes of the coefficients:\n$$\n\\lvert c_{B_0} \\rvert^2 = \\frac{\\mathcal{E} + \\frac{\\Delta}{2}}{2\\mathcal{E}}\n$$\n$$\n\\lvert c_{A_1} \\rvert^2 = \\frac{t^2}{2\\mathcal{E}\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)}\n$$\nThe product is:\n$$\n\\Omega = a^2 \\left( \\frac{t^2}{2\\mathcal{E}\\left(\\mathcal{E} + \\frac{\\Delta}{2}\\right)} \\right) \\left( \\frac{\\mathcal{E} + \\frac{\\Delta}{2}}{2\\mathcal{E}} \\right) = a^2 \\frac{t^2}{4\\mathcal{E}^2}\n$$\nFinally, substitute back the expression for $\\mathcal{E}^2 = t^2 + \\Delta^2/4$:\n$$\n\\Omega = a^2 \\frac{t^2}{4\\left(t^2 + \\frac{\\Delta^2}{4}\\right)} = a^2 \\frac{t^2}{4t^2 + \\Delta^2}\n$$\nThis expression provides the spread of the maximally localized Wannier function in terms of the given physical parameters $a$, $t$, and $\\Delta$.",
            "answer": "$$\n\\boxed{\\frac{a^{2} t^{2}}{4t^{2} + \\Delta^{2}}}\n$$"
        }
    ]
}