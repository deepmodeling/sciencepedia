{
    "hands_on_practices": [
        {
            "introduction": "本练习使用简化的但功能强大的克龙尼格-彭尼模型和狄拉克函数势垒。我们将应用简并微扰理论（近自由电子近似的核心），亲眼见证一个微弱的周期性势如何打破自由电子的抛物线色散关系，并在布里渊区边界处打开一个能带隙。这个练习阐明了绝缘体和半导体存在的根本机制。",
            "id": "3730013",
            "problem": "考虑一个有效质量为 $m$ 的一维电子，处在一个晶格常数为 $a$ 的周期性狄拉克-德尔塔势垒阵列中，其势能模型为 $V(x) = V_{0} \\sum_{n \\in \\mathbb{Z}} \\delta(x - n a)$，其中 $V_{0} > 0$。定义无量纲势垒强度为 $P \\equiv \\frac{m V_{0} a}{\\hbar^{2}}$。以稳态薛定谔方程和布洛赫定理为基本依据，分析在晶体波矢 $k = \\frac{\\pi}{a}$ 处，即第一布里渊区（BZ）边界附近的能带结构。\n\n您的任务是：\n- 确定在 $k = \\frac{\\pi}{a}$ 处的第一能隙首次打开时的临界势垒强度 $P_{c}$。\n- 在小 $P$ 极限下，采用一级简并微扰分析（近自由电子模型）来量化布里渊区边界处最低能带顶与次低能带底之间的能隙宽度 $\\Delta E$。将 $\\Delta E$ 用 $\\hbar$、$m$、$a$ 和 $P$ 表示，能量单位使用焦耳。\n\n答案规格：\n- 以一个同时包含 $P_{c}$ 和 $\\Delta E$ 作为其组成部分的单一闭式解析表达式的形式提供您的最终结果。\n- 无需提供数值；请勿四舍五入。\n- 能量的单位应使用焦耳。",
            "solution": "首先对问题陈述进行严格的验证。\n\n### 步骤 1：提取已知条件\n- **系统**：一个有效质量为 $m$ 的一维电子。\n- **势能**：一个周期性的狄拉克-德尔塔势垒阵列，$V(x) = V_{0} \\sum_{n \\in \\mathbb{Z}} \\delta(x - n a)$。\n- **晶格常数**：$a$。\n- **势垒振幅**：$V_{0} > 0$。\n- **无量纲势垒强度**：$P \\equiv \\frac{m V_{0} a}{\\hbar^{2}}$。\n- **分析点**：第一布里渊区（BZ）边界，对应晶体波矢 $k = \\frac{\\pi}{a}$。\n- **任务 1**：确定在 $k = \\frac{\\pi}{a}$ 处的第一能隙首次打开时的临界势垒强度 $P_{c}$。\n- **任务 2**：在小 $P$ 极限下，使用一级简并微扰分析（近自由电子模型）求出在 $k = \\frac{\\pi}{a}$ 处的能隙宽度 $\\Delta E$。将 $\\Delta E$ 用 $\\hbar$、$m$、$a$ 和 $P$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是基础固态物理学中的一个标准练习题，具体涉及带有狄拉克梳势的 Kronig-Penney 模型。\n\n- **科学上成立**：该问题基于稳态薛定谔方程和布洛赫定理，这是周期势中量子力学的基本原理。Kronig-Penney 模型是用于阐释能带结构形成的典型、科学上成立的模型。\n- **问题适定**：该问题对物理系统给出了完整的描述，并要求求解定义明确的物理量（$P_c$ 和 $\\Delta E$）。给定的信息足以推导出唯一解。\n- **客观性**：该问题使用量子物理学和固态物理学中精确、客观和标准的术语进行陈述。没有主观或模糊的表述。\n\n所有验证标准均已满足。该问题不存在科学不成立、不完整或模糊等缺陷。关于“临界”势垒强度 $P_c$ 的问题是对一个基本概念的检验，而非缺陷，下文将对此进行证明。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整的解答。\n\n### 解题推导\n\n该问题包含两部分。首先，我们确定临界势垒强度 $P_c$。其次，我们使用简并微扰理论计算能隙 $\\Delta E$。\n\n**第一部分：确定临界势垒强度 $P_c$**\n\n在一维量子力学中，一个基本结论是：任何非平凡的周期势，无论多弱，都会在布里渊区的边界处打开能隙。没有能隙的自由电子模型对应于周期势为零的情况，即 $V(x) = 0$。\n\n本问题中的势能为 $V(x) = V_{0} \\sum_{n \\in \\mathbb{Z}} \\delta(x - n a)$。该势能为零当且仅当 $V_0 = 0$。无量纲势垒强度定义为 $P \\equiv \\frac{m V_{0} a}{\\hbar^{2}}$。由于 $m$、$a$ 和 $\\hbar$ 都是正常数，因此 $P=0$ 当且仅当 $V_0=0$。\n\n对于任何 $V_0 > 0$（对应于任何 $P > 0$），在 $k = \\frac{\\pi}{a}$ 处都存在能隙。能隙仅在 $V_0 \\to 0$ 的极限下（等价于 $P \\to 0$）才会闭合并完全消失。因此，能隙“首次打开”时的“临界”势垒强度值，是区分无能隙区域（$P=0$）与有能隙区域（$P>0$）的值。\n\n这个临界值为 $P_c = 0$。\n\n**第二部分：计算能隙 $\\Delta E$**\n\n我们按要求采用一级简并微扰理论。这正是近自由电子模型的精髓。未受微扰的系统是自由电子，由哈密顿量 $H_0 = -\\frac{\\hbar^2}{2m} \\frac{d^2}{dx^2}$ 描述。微扰项是周期势 $V(x)$。\n\n未受微扰的本征态是平面波 $\\psi_q(x) = \\frac{1}{\\sqrt{L}} \\exp(iqx)$，其能量为 $E_q^0 = \\frac{\\hbar^2 q^2}{2m}$。在第一布里渊区边界 $k = \\frac{\\pi}{a}$ 处，态 $\\psi_k(x)$ 与态 $\\psi_{k-G}(x)$ 简并，其中 $G = \\frac{2\\pi}{a}$ 是最小的非零倒格矢。\n\n在 $k = \\frac{\\pi}{a}$ 处的两个简并态是：\n- $|\\psi_1 \\rangle = |\\psi_{\\pi/a} \\rangle$，对应于 $q_1 = \\frac{\\pi}{a}$。\n- $|\\psi_2 \\rangle = |\\psi_{\\pi/a - 2\\pi/a} \\rangle = |\\psi_{-\\pi/a} \\rangle$，对应于 $q_2 = -\\frac{\\pi}{a}$。\n\n两个态具有相同的未受微扰能量：\n$E^0 = E_{\\pi/a}^0 = E_{-\\pi/a}^0 = \\frac{\\hbar^2 (\\pi/a)^2}{2m}$。\n\n在由 $\\{|\\psi_1 \\rangle, |\\psi_2 \\rangle\\}$ 张成的简并子空间中，我们必须对角化全哈密顿量 $H = H_0 + V$。$H$ 在此基下的矩阵表示为：\n$$\n\\mathbf{H} = \\begin{pmatrix}\n\\langle \\psi_1 | H | \\psi_1 \\rangle & \\langle \\psi_1 | H | \\psi_2 \\rangle \\\\\n\\langle \\psi_2 | H | \\psi_1 \\rangle & \\langle \\psi_2 | H | \\psi_2 \\rangle\n\\end{pmatrix}\n$$\n矩阵元为：$H_{ij} = \\langle \\psi_i | H_0 + V | \\psi_j \\rangle = E^0 \\delta_{ij} + V_{ij}$，其中 $V_{ij} = \\langle \\psi_i | V | \\psi_j \\rangle$。\n\n我们来计算势能 $V(x)$ 的矩阵元。这些是势能的傅里叶系数。$V(x)$ 的傅里叶级数为 $V(x) = \\sum_{G'} V_{G'} \\exp(iG'x)$，其中系数由下式给出：\n$$\nV_{G'} = \\frac{1}{a} \\int_{-a/2}^{a/2} V(x) \\exp(-iG'x) dx\n$$\n在我们的情况下，在以原点为一个晶胞的中心内，势能为 $V_0 \\delta(x)$。\n$$\nV_{G'} = \\frac{1}{a} \\int_{-a/2}^{a/2} V_0 \\delta(x) \\exp(-iG'x) dx = \\frac{V_0}{a} \\exp(0) = \\frac{V_0}{a}\n$$\n这意味着狄拉克梳势的所有傅里叶系数都等于 $\\frac{V_0}{a}$。\n\n矩阵元 $V_{ij}$ 为：\n- $V_{11} = \\langle \\psi_{\\pi/a} | V | \\psi_{\\pi/a} \\rangle = V_{G'=0} = \\frac{V_0}{a}$。\n- $V_{22} = \\langle \\psi_{-\\pi/a} | V | \\psi_{-\\pi/a} \\rangle = V_{G'=0} = \\frac{V_0}{a}$。\n- $V_{12} = \\langle \\psi_{\\pi/a} | V | \\psi_{-\\pi/a} \\rangle = V_{G' = (\\pi/a) - (-\\pi/a) = 2\\pi/a} = \\frac{V_0}{a}$。\n- $V_{21} = \\langle \\psi_{-\\pi/a} | V | \\psi_{\\pi/a} \\rangle = V_{G' = (-\\pi/a) - (\\pi/a) = -2\\pi/a} = \\frac{V_0}{a}$。\n\n哈密顿量矩阵变为：\n$$\n\\mathbf{H} = \\begin{pmatrix}\nE^0 + \\frac{V_0}{a} & \\frac{V_0}{a} \\\\\n\\frac{V_0}{a} & E^0 + \\frac{V_0}{a}\n\\end{pmatrix}\n$$\n通过求解特征方程 $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$ 来求得本征值 $E$：\n$$\n\\left( E^0 + \\frac{V_0}{a} - E \\right)^2 - \\left( \\frac{V_0}{a} \\right)^2 = 0\n$$\n$$\nE^0 + \\frac{V_0}{a} - E = \\pm \\frac{V_0}{a}\n$$\n这给出两个能量本征值：\n$E_+ = E^0 + \\frac{V_0}{a} + \\frac{V_0}{a} = E^0 + \\frac{2V_0}{a}$\n$E_- = E^0 + \\frac{V_0}{a} - \\frac{V_0}{a} = E^0$\n\n在第一布里渊区边界处的能隙 $\\Delta E$ 是这两个能级之差：\n$$\n\\Delta E = E_+ - E_- = \\left( E^0 + \\frac{2V_0}{a} \\right) - E^0 = \\frac{2V_0}{a}\n$$\n问题要求将此结果用 $P = \\frac{m V_{0} a}{\\hbar^{2}}$ 表示。我们求解 $V_0$：\n$$\nV_0 = \\frac{P \\hbar^2}{ma}\n$$\n将此代入 $\\Delta E$ 的表达式中：\n$$\n\\Delta E = \\frac{2}{a} \\left( \\frac{P \\hbar^2}{ma} \\right) = \\frac{2P\\hbar^2}{ma^2}\n$$\n此结果在小 $P$ 极限下有效，这与对弱势采用一级微扰理论是一致的。此即为所求的能隙，单位为焦耳。\n\n最终结果结合了 $P_c$ 的值和 $\\Delta E$ 的表达式。\n$P_c = 0$\n$\\Delta E = \\frac{2P\\hbar^2}{ma^2}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\frac{2P\\hbar^{2}}{ma^{2}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "超越微扰的观点，紧束缚模型从局域的原子轨道出发构建能带结构。本练习将指导您推导三维晶体的能量色散关系，然后用它来计算能带边缘附近的态密度（$DOS$）。这项技能对于理解材料的光学和输运性质至关重要。",
            "id": "3730002",
            "problem": "考虑一个三维简立方晶体，晶格常数为 $a$，每个晶格点上有一个轨道。假设一个最近邻紧束缚哈密顿量，其在位能为 $\\epsilon_{0}$，最近邻之间的跃迁振幅为 $t$，且 $t>0$。使用不含时薛定谔方程和紧束缚布洛赫拟设，推导单能带布洛赫色散关系 $E(\\mathbf{k})$，用 $k_{x}$、$k_{y}$、$k_{z}$ 表示，并确定能带最小值出现的波矢 $\\mathbf{k}$ 以及相应的能带边能量 $E_{\\min}$。在能带最小值附近，将色散关系对模长 $k=|\\mathbf{k}|$ 展开至二阶，并将其写成抛物线形式。从包含自旋简并度为2的单位体积态密度（DOS）的定义出发，\n$$\nD(E)=\\frac{g_{s}}{(2\\pi)^{3}}\\int d^{3}k\\,\\delta\\!\\left(E - E(\\mathbf{k})\\right),\\quad g_{s}=2,\n$$\n利用你得到的抛物线近似，计算能带最小值附近的低能态密度。将你的最终结果表示为低能态密度 $D_{\\text{low}}(E)$ 的一个单一、闭合形式的解析表达式，该表达式是 $E$、$\\epsilon_{0}$、$t$ 和 $a$ 的函数，且在 $E\\geq E_{\\min}$ 时有效。以 $\\mathrm{J}^{-1}\\,\\mathrm{m}^{-3}$ 为单位表示单位体积的态密度。无需取整。",
            "solution": "该问题要求推导由最近邻紧束缚模型描述的三维简立方晶体的低能态密度（DOS）。推导过程分为四个主要步骤：1. 推导能量色散关系 $E(\\mathbf{k})$。2. 确定能带最小值。3. 在最小值附近对色散关系进行近似。4. 使用此近似计算态密度。\n\n**1. 色散关系 $E(\\mathbf{k})$ 的推导**\n\n我们考虑一个晶格常数为 $a$ 的简立方晶格。晶格点由矢量 $\\mathbf{R} = n_1 a \\hat{x} + n_2 a \\hat{y} + n_3 a \\hat{z}$ 给出，其中 $n_1, n_2, n_3$ 为整数。紧束缚模型假设电子波函数可以写成位于每个晶格点 $\\mathbf{R}$ 的原子轨道 $|\\phi(\\mathbf{R})\\rangle$ 的线性组合。\n\n根据布洛赫定理，周期性势场中电子的波函数是布洛赫波。在紧束缚近似下，给定波矢 $\\mathbf{k}$ 的布洛赫波函数 $|\\psi(\\mathbf{k})\\rangle$ 构造如下：\n$$\n|\\psi(\\mathbf{k})\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}} e^{i\\mathbf{k} \\cdot \\mathbf{R}} |\\phi(\\mathbf{R})\\rangle\n$$\n其中 $N$ 是晶格点的数量。我们假设原子轨道是正交归一的：$\\langle\\phi(\\mathbf{R'})|\\phi(\\mathbf{R})\\rangle = \\delta_{\\mathbf{R'},\\mathbf{R}}$。\n\n能量色散 $E(\\mathbf{k})$ 是哈密顿量 $H$ 对于态 $|\\psi(\\mathbf{k})\\rangle$ 的本征值，由期望值给出：\n$$\nE(\\mathbf{k}) = \\langle\\psi(\\mathbf{k})|H|\\psi(\\mathbf{k})\\rangle = \\frac{1}{N} \\sum_{\\mathbf{R'},\\mathbf{R}} e^{i\\mathbf{k} \\cdot (\\mathbf{R} - \\mathbf{R'})} \\langle\\phi(\\mathbf{R'})|H|\\phi(\\mathbf{R})\\rangle\n$$\n题目指明了哈密顿量的矩阵元：\n- 在位能：$\\langle\\phi(\\mathbf{R})|H|\\phi(\\mathbf{R})\\rangle = \\epsilon_0$。\n- 最近邻跃迁：若 $\\mathbf{R'}$ 和 $\\mathbf{R}$ 是最近邻，则 $\\langle\\phi(\\mathbf{R'})|H|\\phi(\\mathbf{R})\\rangle = -t$。跃迁振幅 $t$ 被设定为正值 ($t>0$)。\n- 所有其他的非对角矩阵元均为零。\n\n令 $\\mathbf{R'} = \\mathbf{R} + \\boldsymbol{\\delta}$，其中 $\\boldsymbol{\\delta}$ 是连接一个格点到其某个邻居的矢量。求和可以重写为：\n$$\nE(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}} \\sum_{\\boldsymbol{\\delta}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} \\langle\\phi(\\mathbf{R}+\\boldsymbol{\\delta})|H|\\phi(\\mathbf{R})\\rangle\n$$\n对 $\\boldsymbol{\\delta}$ 的求和包括了 $\\boldsymbol{\\delta}=\\mathbf{0}$ 项（在位）和最近邻项。\n$$\nE(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}} \\left( \\langle\\phi(\\mathbf{R})|H|\\phi(\\mathbf{R})\\rangle + \\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} \\langle\\phi(\\mathbf{R}+\\boldsymbol{\\delta})|H|\\phi(\\mathbf{R})\\rangle \\right)\n$$\n括号内的项与 $\\mathbf{R}$ 无关。对 $N$ 个相同项求和得到该项的 $N$ 倍，这与前面的因子 $1/N$ 相消。\n$$\nE(\\mathbf{k}) = \\epsilon_0 + \\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} (-t) = \\epsilon_0 - t \\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}}\n$$\n对于简立方晶格，最近邻矢量 $\\boldsymbol{\\delta}$ 是 $\\pm a\\hat{x}$、$\\pm a\\hat{y}$ 和 $\\pm a\\hat{z}$。求和是针对这六个矢量的：\n$$\n\\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} = e^{-ik_x a} + e^{ik_x a} + e^{-ik_y a} + e^{ik_y a} + e^{-ik_z a} + e^{ik_z a}\n$$\n使用欧拉公式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，求和变为：\n$$\n2\\cos(k_x a) + 2\\cos(k_y a) + 2\\cos(k_z a)\n$$\n将此结果代回 $E(\\mathbf{k})$ 的表达式中，我们得到色散关系：\n$$\nE(\\mathbf{k}) = \\epsilon_0 - 2t(\\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a))\n$$\n\n**2. 确定能带最小值**\n\n为了找到能带的最小能量 $E_{\\min}$，我们需要找到 $E(\\mathbf{k})$ 的最小值。由于 $t > 0$，这对应于最大化 $(\\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a))$ 这一项。余弦函数的最大值为 $1$。当其自变量为 $2\\pi$ 的整数倍时达到最大值。在第一布里渊区（$-\\pi/a \\leq k_i \\leq \\pi/a$）内，此条件在 $k_x a = 0$、$k_y a = 0$ 和 $k_z a = 0$ 时满足。\n因此，能带最小值出现在波矢 $\\mathbf{k} = \\mathbf{0}$ 处（布里渊区的中心，或称 $\\Gamma$ 点）。\n\n最小能量 $E_{\\min}$ 是 $E(\\mathbf{k})$ 在 $\\mathbf{k}=\\mathbf{0}$ 处的值：\n$$\nE_{\\min} = E(\\mathbf{0}) = \\epsilon_0 - 2t(\\cos(0) + \\cos(0) + \\cos(0)) = \\epsilon_0 - 2t(1+1+1)\n$$\n$$\nE_{\\min} = \\epsilon_0 - 6t\n$$\n\n**3. 抛物线近似**\n\n对于低能量，电子占据能带最小值附近的状态，即对于小波矢 $|\\mathbf{k}|$。我们可以在 $\\mathbf{k}=\\mathbf{0}$ 附近对色散关系 $E(\\mathbf{k})$ 进行泰勒展开。我们使用余弦函数的二阶近似：对于小的 $\\theta$，$\\cos(\\theta) \\approx 1 - \\frac{\\theta^2}{2}$。\n令 $\\theta_x = k_x a$，$\\theta_y = k_y a$ 和 $\\theta_z = k_z a$。对于小的 $|\\mathbf{k}|$，这些都是小量。\n$$\nE(\\mathbf{k}) \\approx \\epsilon_0 - 2t \\left( \\left(1 - \\frac{(k_x a)^2}{2}\\right) + \\left(1 - \\frac{(k_y a)^2}{2}\\right) + \\left(1 - \\frac{(k_z a)^2}{2}\\right) \\right)\n$$\n$$\nE(\\mathbf{k}) \\approx \\epsilon_0 - 2t \\left( 3 - \\frac{a^2}{2}(k_x^2 + k_y^2 + k_z^2) \\right)\n$$\n$$\nE(\\mathbf{k}) \\approx \\epsilon_0 - 6t + t a^2 (k_x^2 + k_y^2 + k_z^2)\n$$\n注意到 $k^2 = |\\mathbf{k}|^2 = k_x^2 + k_y^2 + k_z^2$ 且 $E_{\\min} = \\epsilon_0 - 6t$，我们得到色散关系的抛物线近似：\n$$\nE(\\mathbf{k}) \\approx E_{\\min} + ta^2 k^2\n$$\n\n**4. 低能态密度（DOS）的计算**\n\n题目给出了单位体积态密度的定义，包括自旋简并度 $g_s=2$：\n$$\nD(E) = \\frac{g_s}{(2\\pi)^3} \\int d^3k \\, \\delta(E - E(\\mathbf{k}))\n$$\n我们通过使用 $E(\\mathbf{k})$ 的抛物线近似来计算低能态密度 $D_{\\text{low}}(E)$：\n$$\nD_{\\text{low}}(E) = \\frac{g_s}{(2\\pi)^3} \\int d^3k \\, \\delta(E - (E_{\\min} + ta^2 k^2))\n$$\n由于被积函数仅依赖于模长 $k=|\\mathbf{k}|$，我们可以在 $\\mathbf{k}$ 空间中切换到球坐标系，其体积元为 $d^3k = 4\\pi k^2 dk$。积分变为：\n$$\nD_{\\text{low}}(E) = \\frac{g_s}{(2\\pi)^3} \\int_0^\\infty 4\\pi k^2 \\delta(E - E_{\\min} - ta^2 k^2) dk = \\frac{g_s}{2\\pi^2} \\int_0^\\infty k^2 \\delta(E - E_{\\min} - ta^2 k^2) dk\n$$\n该积分仅在 $E \\ge E_{\\min}$ 时非零。为了计算包含狄拉克δ函数的积分，我们使用性质 $\\int f(x) \\delta(g(x)) dx = \\sum_i \\frac{f(x_i)}{|g'(x_i)|}$，其中 $x_i$ 是 $g(x)=0$ 的根。\n这里，变量是 $k$，$f(k) = k^2$，且 $g(k) = E - E_{\\min} - ta^2 k^2$。\n$g(k)=0$ 的根 $k_0$ 通过求解 $E - E_{\\min} - ta^2 k_0^2 = 0$ 得到：\n$$\nk_0^2 = \\frac{E - E_{\\min}}{ta^2} \\implies k_0 = \\sqrt{\\frac{E - E_{\\min}}{ta^2}}\n$$\n我们只考虑正根，因为积分区间是 $k \\in [0, \\infty)$。$g(k)$ 的导数是 $g'(k) = -2ta^2 k$。其在 $k_0$ 处的模长为：\n$$\n|g'(k_0)| = |-2ta^2 k_0| = 2ta^2 k_0\n$$\n那么积分的值为：\n$$\n\\frac{f(k_0)}{|g'(k_0)|} = \\frac{k_0^2}{2ta^2 k_0} = \\frac{k_0}{2ta^2} = \\frac{1}{2ta^2} \\sqrt{\\frac{E - E_{\\min}}{ta^2}} = \\frac{\\sqrt{E - E_{\\min}}}{2(ta^2)^{3/2}}\n$$\n将此结果代回 $D_{\\text{low}}(E)$ 的表达式中：\n$$\nD_{\\text{low}}(E) = \\frac{g_s}{2\\pi^2} \\left(\\frac{\\sqrt{E - E_{\\min}}}{2(ta^2)^{3/2}}\\right) = \\frac{g_s \\sqrt{E - E_{\\min}}}{4\\pi^2 (ta^2)^{3/2}}\n$$\n现在，我们代入给定的值 $g_s=2$ 和推导出的 $E_{\\min} = \\epsilon_0 - 6t$ 表达式：\n$$\nD_{\\text{low}}(E) = \\frac{2 \\sqrt{E - (\\epsilon_0 - 6t)}}{4\\pi^2 (ta^2)^{3/2}} = \\frac{\\sqrt{E - \\epsilon_0 + 6t}}{2\\pi^2 (ta^2)^{3/2}}\n$$\n该表达式在 $E \\ge E_{\\min}$ 时有效。对于 $E < E_{\\min}$，态密度为 $0$。题目要求的是 $E \\ge E_{\\min}$ 时的表达式。该表达式的单位是 $\\mathrm{J}^{-1}\\,\\mathrm{m}^{-3}$，因为能量参数（$E, \\epsilon_0, t$）的单位是焦耳，晶格常数 $a$ 的单位是米。\n\n低能态密度的最终结果是：\n$$\nD_{\\text{low}}(E) = \\frac{1}{2\\pi^2 (ta^2)^{3/2}} \\sqrt{E - \\epsilon_0 + 6t}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{E - \\epsilon_{0} + 6t}}{2\\pi^{2} (ta^{2})^{3/2}}}\n$$"
        },
        {
            "introduction": "虽然解析模型提供了宝贵的见解，但计算真实材料的能带结构需要借助计算方法。本练习涉及推导和实现平面波展开法，这是现代材料科学的基石。您将把薛定谔方程转化为一个矩阵本征值问题，并编写代码来求解能带，从而弥合量子理论与实际模拟之间的差距。",
            "id": "3729998",
            "problem": "你的任务是为一维周期势构建并实现平面波展开法，并推导出相应的能带矩阵本征值问题。其物理基础必须是非相对论性不含时薛定谔方程和布洛赫定理。然后，你必须编写一个程序，为一组给定的测试用例构建并求解该矩阵本征值问题。\n\n从一个质量为 $m$ 的电子在周期势 $V(x)$ 中的非相对论性不含时薛定谔方程开始，以原子单位（其中 $\\hbar = 1$ 且 $m = 1$）表示：\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\,\\psi(x).\n$$\n假设一个周期为 $a$ 的一维晶格，因此 $V(x + a) = V(x)$。定义倒格矢 $G = \\frac{2\\pi}{a}n$，其中 $n \\in \\mathbb{Z}$。根据布洛赫定理，晶体动量为 $k$ 的本征态可以写成 $\\psi_k(x) = e^{ikx} u_k(x)$，其中 $u_k(x+a) = u_k(x)$。将周期部分在平面波中展开，截断至 $|G|\\le G_{\\text{max}}$：\n$$\nu_k(x) = \\sum_{|G|\\le G_{\\text{max}}} c_{k,G}\\, e^{iGx},\n$$\n使得\n$$\n\\psi_k(x) = \\sum_{|G|\\le G_{\\text{max}}} c_{k,G}\\, e^{i(k+G)x}.\n$$\n假设周期势具有由下式定义的傅里叶级数系数 $V_q$\n$$\nV(x) = \\sum_{q} V_q \\, e^{iqx},\n$$\n其中 $q$ 仅限于倒格矢。为了具体起见并进行数值测试，考虑势\n$$\nV(x) = U_0 + V_0 \\cos\\left(\\frac{2\\pi}{a}x\\right) + V_1 \\cos\\left(\\frac{4\\pi}{a}x\\right),\n$$\n这意味着非零傅里叶分量为 $V_0 = U_0$、$V_{\\pm \\frac{2\\pi}{a}} = \\frac{V_0}{2}$、$V_{\\pm \\frac{4\\pi}{a}} = \\frac{V_1}{2}$，所有其他 $V_q = 0$。\n\n任务 $1$：从薛定谔方程出发，利用布洛赫定理和上述平面波展开，通过投影到基 $\\{e^{i(k+G)x}\\}$ 上，推导出系数 $c_{k,G}$ 的有限维矩阵本征值问题，\n$$\n\\sum_{|G'|\\le G_{\\text{max}}} H_{G,G'}(k)\\, c_{k,G'} = E(k)\\, c_{k,G},\n$$\n请用 $k$、$G$、$G'$ 和傅里叶分量 $V_{G-G'}$ 显式表示 $H_{G,G'}(k)$，并指明动能和势能的贡献。在推导过程中，除了周期性外，不要假设 $V(x)$ 有任何特殊形式；然后你可以具体化到上述的 $V(x)$ 以获得显式的非零 $V_q$。\n\n任务 $2$：实现一个程序，对于下面列出的每个测试用例，构造满足 $|G|\\le G_{\\text{max}}$ 的所有 $G$ 的截断哈密顿矩阵 $H_{G,G'}(k)$，并将其对角化以获得按升序排序的能量本征值 $E_n(k)$。使用原子单位，其中 $\\hbar = 1$ 和 $m = 1$，因此能量必须以这些原子单位报告。倒格矢间距为 $G_0 = \\frac{2\\pi}{a}$。包含的平面波集合必须由整数 $n$ 索引，其中 $G = n G_0$ 且 $|G|\\le G_{\\text{max}}$。请注意通过 $V_{G-G'}$ 来实现势矩阵元。在具体化到上述给定势 $V(x)$ 时，你可以通过倒格矢指标的整数差来处理傅里叶系数：$V_{0} = U_0$、$V_{\\pm 1} = \\frac{V_0}{2}$、$V_{\\pm 2} = \\frac{V_1}{2}$，其他为零，其中 $V_{m}$ 表示 $q = m G_0$ 处的系数。每个测试用例的输出必须是该 $k$ 值下所有计算出的能带能量的列表，按升序排列。\n\n数值单位：所有能量均以与 $\\hbar = 1$ 和 $m = 1$ 一致的原子单位（无量纲）报告。不需要角度单位，因为 $k$ 是倒易空间中的波矢，而不是角度。\n\n测试组：\n- 情况 $1$（通用正常路径）：$a = 1.0$, $U_0 = 0.0$, $V_0 = 0.5$, $V_1 = 0.2$, $G_{\\text{max}} = 4\\pi$, $k = 0.4\\pi$。\n- 情况 $2$（布里渊区边界）：$a = 1.0$, $U_0 = 0.0$, $V_0 = 0.6$, $V_1 = 0.0$, $G_{\\text{max}} = 2\\pi$, $k = \\pi$。\n- 情况 $3$（最小基组边缘情况）：$a = 1.0$, $U_0 = 0.0$, $V_0 = 0.8$, $V_1 = 0.0$, $G_{\\text{max}} = 0.0$, $k = 0.3\\pi$。\n- 情况 $4$（不同的晶格常数和非零平均势）：$a = 2.0$, $U_0 = 0.1$, $V_0 = 0.4$, $V_1 = 0.25$, $G_{\\text{max}} = 2\\pi$, $k = \\frac{\\pi}{2}$。\n\n最终输出格式：你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身是对应测试用例的浮点数能量列表（按升序排列）。例如，一个有效的输出格式是\n$$\n[\\,[E_{1}^{(1)},E_{2}^{(1)},\\dots],\\,[E_{1}^{(2)},E_{2}^{(2)},\\dots],\\,\\dots\\,]\n$$\n不含任何额外文本。上标表示测试用例索引，下标枚举能带。每个测试用例的能量数量等于该用例包含的平面波数量。",
            "solution": "目标是使用平面波方法推导一维周期势中电子能带结构的矩阵本征值问题，并实现一个数值解。\n\n### 任务1：矩阵本征值问题的推导\n\n我们从一维不含时薛定谔方程开始，采用原子单位（$\\hbar=1$, $m=1$）：\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\,\\psi(x)\n$$\n势 $V(x)$ 是周期性的，晶格常数为 $a$，因此 $V(x+a) = V(x)$。根据布洛赫定理，这种势中的本征函数具有形式 $\\psi_k(x) = e^{ikx}u_k(x)$，其中 $k$ 是晶体动量，$u_k(x)$ 与晶格具有相同的周期性，$u_k(x+a)=u_k(x)$。\n\n周期函数 $u_k(x)$ 可以展开为关于倒格矢 $G = n \\frac{2\\pi}{a}$（其中 $n \\in \\mathbb{Z}$）的傅里叶级数：\n$$\nu_k(x) = \\sum_{G} c_{k,G}\\, e^{iGx}\n$$\n这意味着布洛赫波函数 $\\psi_k(x)$ 可以在平面波基上展开：\n$$\n\\psi_k(x) = e^{ikx} \\sum_{G} c_{k,G}\\, e^{iGx} = \\sum_{G} c_{k,G}\\, e^{i(k+G)x}\n$$\n周期势 $V(x)$ 也可以在相同的倒格矢上展开为傅里叶级数：\n$$\nV(x) = \\sum_{q} V_q \\, e^{iqx}\n$$\n其中傅里叶系数由 $V_q = \\frac{1}{a} \\int_0^a V(x)e^{-iqx}dx$ 给出。\n\n现在我们将 $\\psi_k(x)$ 和 $V(x)$ 的平面波展开式代入薛定谔方程。首先，我们计算哈密顿算符作用于 $\\psi_k(x)$ 的结果。\n\n动能项是：\n$$\n-\\frac{1}{2}\\frac{d^2}{dx^2} \\psi_k(x) = -\\frac{1}{2}\\frac{d^2}{dx^2} \\sum_{G'} c_{k,G'}\\, e^{i(k+G')x} = \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 e^{i(k+G')x}\n$$\n势能项是：\n$$\nV(x)\\psi_k(x) = \\left(\\sum_{q} V_q e^{iqx}\\right) \\left(\\sum_{G'} c_{k,G'} e^{i(k+G')x}\\right) = \\sum_{q,G'} V_q c_{k,G'} e^{i(k+G'+q)x}\n$$\n将这些代入薛定谔方程得到：\n$$\n\\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 e^{i(k+G')x} + \\sum_{q,G'} V_q c_{k,G'} e^{i(k+G'+q)x} = E(k) \\sum_{G'} c_{k,G'} e^{i(k+G')x}\n$$\n为了得到系数 $c_{k,G}$ 的方程，我们将此方程投影到一个特定的基函数 $e^{i(k+G)x}$ 上。这通过乘以 $e^{-i(k+G)x}$ 并在一个晶胞（从 $0$ 到 $a$）上积分，然后除以长度 $a$ 来完成。\n\n让我们将此投影应用于每一项，利用正交关系 $\\frac{1}{a}\\int_0^a e^{i(G_1-G_2)x}dx = \\delta_{G_1, G_2}$：\n\n1.  动能项的投影：\n    $$\n    \\frac{1}{a}\\int_0^a dx\\, e^{-i(k+G)x} \\left( \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 e^{i(k+G')x} \\right) = \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 \\left( \\frac{1}{a}\\int_0^a e^{i(G'-G)x}dx \\right)\n    $$\n    $$\n    = \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 \\delta_{G,G'} = c_{k,G} \\frac{1}{2}(k+G)^2\n    $$\n\n2.  势能项的投影：\n    $$\n    \\frac{1}{a}\\int_0^a dx\\, e^{-i(k+G)x} \\left( \\sum_{q,G'} V_q c_{k,G'} e^{i(k+G'+q)x} \\right) = \\sum_{q,G'} V_q c_{k,G'} \\left( \\frac{1}{a}\\int_0^a e^{i(G'-G+q)x}dx \\right)\n    $$\n    仅当 $G'-G+q=0$ 时积分非零，这意味着 $q=G-G'$。对 $q$ 的求和对于每个 $G'$ 都塌缩为单项：\n    $$\n    = \\sum_{G'} V_{G-G'} c_{k,G'}\n    $$\n\n3.  右侧能量项的投影：\n    $$\n    \\frac{1}{a}\\int_0^a dx\\, e^{-i(k+G)x} \\left( E(k) \\sum_{G'} c_{k,G'} e^{i(k+G')x} \\right) = E(k) \\sum_{G'} c_{k,G'} \\left( \\frac{1}{a}\\int_0^a e^{i(G'-G)x}dx \\right)\n    $$\n    $$\n    = E(k) \\sum_{G'} c_{k,G'} \\delta_{G,G'} = E(k) c_{k,G}\n    $$\n结合这些投影项，我们对每个 $G$ 得到：\n$$\n\\frac{1}{2}(k+G)^2 c_{k,G} + \\sum_{G'} V_{G-G'} c_{k,G'} = E(k) c_{k,G}\n$$\n重新整理此方程，将包含系数 $c_{k,G'}$ 的项组合在一起：\n$$\n\\sum_{G'} \\left[ \\frac{1}{2}(k+G)^2 \\delta_{G,G'} + V_{G-G'} \\right] c_{k,G'} = E(k) c_{k,G}\n$$\n这是一个矩阵本征值问题，$\\sum_{G'} H_{G,G'}(k) c_{k,G'} = E(k) c_{k,G}$，其中哈密顿矩阵元 $H_{G,G'}(k)$ 由下式给出：\n$$\nH_{G,G'}(k) = \\frac{1}{2}(k+G)^2 \\delta_{G,G'} + V_{G-G'}\n$$\n第一项，$T_{G,G'} = \\frac{1}{2}(k+G)^2 \\delta_{G,G'}$，代表动能，在平面波基中是对角的。第二项，$U_{G,G'} = V_{G-G'}$，代表势能，它耦合了波矢相差一个倒格矢的平面波。\n\n对于特定势 $V(x) = U_0 + V_0 \\cos\\left(\\frac{2\\pi}{a}x\\right) + V_1 \\cos\\left(\\frac{4\\pi}{a}x\\right)$，我们使用欧拉恒等式 $\\cos(\\theta) = \\frac{e^{i\\theta} + e^{-i\\theta}}{2}$：\n$$\nV(x) = U_0 + \\frac{V_0}{2}\\left(e^{i\\frac{2\\pi}{a}x} + e^{-i\\frac{2\\pi}{a}x}\\right) + \\frac{V_1}{2}\\left(e^{i\\frac{4\\pi}{a}x} + e^{-i\\frac{4\\pi}{a}x}\\right)\n$$\n通过将其与一般傅里叶级数 $V(x) = \\sum_{q} V_q e^{iqx}$ 进行比较，我们确定了非零的傅里叶系数 $V_q$。令 $G_0 = \\frac{2\\pi}{a}$ 为基本倒格矢。则对于某个整数 $m$ 有 $q=mG_0$。非零系数为：\n-   $V_{q=0} = U_0$（对于 $m=0$）\n-   $V_{q=\\pm G_0} = \\frac{V_0}{2}$（对于 $m=\\pm 1$）\n-   $V_{q=\\pm 2G_0} = \\frac{V_1}{2}$（对于 $m=\\pm 2$）\n所有其他 $V_q$ 均为零。势矩阵元 $V_{G-G'}$ 取决于 $G=nG_0$ 和 $G'=n'G_0$ 的整数指标之差。令 $m=n-n'$。非零元是 $V_{(n-n')G_0}$，对应于 $m \\in \\{0, \\pm 1, \\pm 2\\}$。\n\n通过只包含满足 $|G| \\le G_{\\text{max}}$ 的倒格矢来截断展开。这个条件转化为 $|n \\frac{2\\pi}{a}| \\le G_{\\text{max}}$，或 $|n| \\le \\lfloor G_{\\text{max}} a / (2\\pi) \\rfloor$。这定义了一个有限的平面波集合，从而产生一个需要对角化的有限维哈密顿矩阵。\n\n### 任务2：实现细节\n\n数值实现涉及为每个测试用例构造和对角化截断的哈密顿矩阵。\n1.  对每个用例，确定原初倒格矢 $G_0 = \\frac{2\\pi}{a}$。\n2.  计算最大整数指标 $n_{\\text{max}} = \\lfloor G_{\\text{max}} / G_0 \\rfloor$。\n3.  基由 $G = nG_0$（其中 $n \\in \\{-n_{\\text{max}}, -n_{\\text{max}}+1, \\dots, n_{\\text{max}}\\}$）的平面波组成。哈密顿矩阵的维度是 $N = 2n_{\\text{max}}+1$。\n4.  构造 $N \\times N$ 矩阵 $H$。矩阵索引 $i, j$（从 $0$ 到 $N-1$）对应于整数索引 $n_i, n_j$（从 $-n_{\\text{max}}$ 到 $n_{\\text{max}}$）。\n5.  矩阵元填充如下：\n    -   对角元 ($i=j$): $H_{i,i}(k) = \\frac{1}{2}(k+n_i G_0)^2 + U_0$。\n    -   非对角元 ($i \\neq j$): $H_{i,j}(k)$ 的值由 $V_{G_i-G_j} = V_{(n_i-n_j)G_0}$ 确定。\n        -   如果 $|n_i - n_j| = 1$, $H_{i,j}(k) = \\frac{V_0}{2}$。\n        -   如果 $|n_i - n_j| = 2$, $H_{i,j}(k) = \\frac{V_1}{2}$。\n        -   否则，$H_{i,j}(k) = 0$。\n6.  所得矩阵是实对称的。其本征值代表能带 $E_n(k)$，可使用针对厄米矩阵的数值本征求解器求得。本征值按要求升序排列。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plane-wave expansion problem for a 1D periodic potential.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general happy path)\n        {\"a\": 1.0, \"U0\": 0.0, \"V0\": 0.5, \"V1\": 0.2, \"G_max\": 4 * np.pi, \"k\": 0.4 * np.pi},\n        # Case 2 (Brillouin zone boundary)\n        {\"a\": 1.0, \"U0\": 0.0, \"V0\": 0.6, \"V1\": 0.0, \"G_max\": 2 * np.pi, \"k\": np.pi},\n        # Case 3 (minimal basis edge case)\n        {\"a\": 1.0, \"U0\": 0.0, \"V0\": 0.8, \"V1\": 0.0, \"G_max\": 0.0, \"k\": 0.3 * np.pi},\n        # Case 4 (different lattice constant and nonzero average potential)\n        {\"a\": 2.0, \"U0\": 0.1, \"V0\": 0.4, \"V1\": 0.25, \"G_max\": 2 * np.pi, \"k\": np.pi / 2},\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        a = case[\"a\"]\n        U0 = case[\"U0\"]\n        V0 = case[\"V0\"]\n        V1 = case[\"V1\"]\n        G_max = case[\"G_max\"]\n        k = case[\"k\"]\n\n        # Calculate primitive reciprocal lattice vector\n        G0 = 2.0 * np.pi / a\n        \n        # Determine the range of integer indices n for G vectors\n        # Handle G_max = 0 case\n        if G0 > 1e-9:\n            n_max = int(np.floor(G_max / G0 + 1e-9)) # Add tolerance for floating point\n        else:\n            n_max = 0\n            \n        n_indices = np.arange(-n_max, n_max + 1)\n        num_basis_vectors = len(n_indices)\n        \n        # Initialize the Hamiltonian matrix\n        H = np.zeros((num_basis_vectors, num_basis_vectors))\n        \n        # Fourier coefficients of the potential\n        V_coeffs= {}\n        V_coeffs[0] = U0\n        V_coeffs[1] = V0 / 2.0\n        V_coeffs[-1] = V0 / 2.0\n        V_coeffs[2] = V1 / 2.0\n        V_coeffs[-2] = V1 / 2.0\n        \n        # Construct the Hamiltonian matrix\n        for i in range(num_basis_vectors):\n            for j in range(num_basis_vectors):\n                n_i = n_indices[i]\n                n_j = n_indices[j]\n                \n                # Potential energy part\n                m_diff = n_i - n_j\n                potential_term = V_coeffs.get(m_diff, 0.0)\n                \n                # Kinetic energy part (diagonal)\n                if i == j:\n                    G = n_i * G0\n                    kinetic_term = 0.5 * (k + G)**2\n                    H[i, j] = kinetic_term + potential_term\n                else:\n                    H[i, j] = potential_term\n\n        # Diagonalize the Hamiltonian to find the energy eigenvalues\n        # np.linalg.eigh is for Hermitian matrices and returns sorted real eigenvalues\n        eigenvalues = np.linalg.eigh(H)[0]\n        all_results.append(eigenvalues.tolist())\n\n    # Format the final output string exactly as specified\n    formatted_results = []\n    for eigvals in all_results:\n        # Format each list of energies into a string '[E1,E2,...]'\n        s = '[' + ','.join([f'{v:.8f}' for v in eigvals]) + ']'\n        formatted_results.append(s)\n    \n    final_str = '[' + ','.join(formatted_results) + ']'\n    print(final_str)\n\nsolve()\n```"
        }
    ]
}