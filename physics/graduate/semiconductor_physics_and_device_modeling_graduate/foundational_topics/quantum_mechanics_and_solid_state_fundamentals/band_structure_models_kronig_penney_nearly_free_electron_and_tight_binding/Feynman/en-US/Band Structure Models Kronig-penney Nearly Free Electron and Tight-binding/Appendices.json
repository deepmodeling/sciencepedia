{
    "hands_on_practices": [
        {
            "introduction": "The Nearly Free Electron (NFE) model provides a powerful intuition for how energy band gaps form in crystalline solids. This practice begins with the simple picture of free electrons and treats the periodic crystal potential as a small perturbation. You will use degenerate perturbation theory to demonstrate how this potential couples states at the Brillouin zone boundary, breaking the free-electron degeneracy and opening up a finite energy gap, a hallmark of semiconductors and insulators .",
            "id": "3730013",
            "problem": "Consider a one-dimensional electron of effective mass $m$ subject to a periodic array of Dirac-delta barriers with lattice constant $a$, modeled by the potential $V(x) = V_{0} \\sum_{n \\in \\mathbb{Z}} \\delta(x - n a)$, where $V_{0} > 0$. Define the dimensionless barrier strength by $P \\equiv \\frac{m V_{0} a}{\\hbar^{2}}$. Using the stationary Schrödinger equation and Bloch’s theorem as the fundamental base, analyze the band structure near the first Brillouin zone (BZ) boundary at crystal wavevector $k = \\frac{\\pi}{a}$. \n\nYour tasks are:\n- Determine the critical barrier strength $P_{c}$ at which the first energy band gap at $k = \\frac{\\pi}{a}$ first opens.\n- In the small-$P$ limit, perform a first-order degenerate perturbation analysis (nearly free electron) to quantify the energy gap width $\\Delta E$ between the top of the lowest band and the bottom of the next band at the BZ boundary. Express $\\Delta E$ in terms of $\\hbar$, $m$, $a$, and $P$, and use Joules for energy.\n\nAnswer specification:\n- Provide your final result as a single closed-form analytic expression that contains both $P_{c}$ and $\\Delta E$ as its components.\n- No numerical values are required; do not round.\n- For the energy, the unit to be used is Joules.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **System**: A one-dimensional electron with effective mass $m$.\n- **Potential**: A periodic array of Dirac-delta barriers, $V(x) = V_{0} \\sum_{n \\in \\mathbb{Z}} \\delta(x - n a)$.\n- **Lattice Constant**: $a$.\n- **Barrier Amplitude**: $V_{0} > 0$.\n- **Dimensionless Barrier Strength**: $P \\equiv \\frac{m V_{0} a}{\\hbar^{2}}$.\n- **Point of Analysis**: The first Brillouin zone (BZ) boundary, corresponding to crystal wavevector $k = \\frac{\\pi}{a}$.\n- **Task 1**: Determine the critical barrier strength $P_{c}$ at which the first energy band gap at $k = \\frac{\\pi}{a}$ first opens.\n- **Task 2**: In the small-$P$ limit, use first-order degenerate perturbation analysis (nearly free electron model) to find the energy gap width $\\Delta E$ at $k = \\frac{\\pi}{a}$. Express $\\Delta E$ in terms of $\\hbar$, $m$, $a$, and $P$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in elementary solid-state physics, specifically the Kronig-Penney model with a Dirac comb potential.\n\n- **Scientifically Grounded**: The problem is based on the stationary Schrödinger equation and Bloch's theorem, which are fundamental principles of quantum mechanics in periodic potentials. The Kronig-Penney model is a canonical, scientifically established model for illustrating band structure formation.\n- **Well-Posed**: The problem provides a complete description of the physical system and asks for well-defined physical quantities ($P_c$ and $\\Delta E$). The given information is sufficient to derive a unique solution.\n- **Objective**: The problem is stated using precise, objective, and standard terminology from quantum and solid-state physics. There are no subjective or ambiguous statements.\n\nAll validation criteria are met. The problem does not exhibit any flaws such as scientific unsoundness, incompleteness, or ambiguity. The question regarding the \"critical\" barrier strength $P_c$ is a test of a fundamental concept rather than a flaw, as will be demonstrated.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution Derivation\n\nThe problem consists of two parts. First, we determine the critical barrier strength $P_c$. Second, we calculate the energy gap $\\Delta E$ using degenerate perturbation theory.\n\n**Part 1: Determination of the Critical Barrier Strength $P_c$**\n\nIn one-dimensional quantum mechanics, it is a fundamental result that any non-trivial periodic potential, no matter how weak, will open an energy band gap at the boundaries of the Brillouin zones. The free-electron model, which has no band gaps, corresponds to the case where the periodic potential is zero, i.e., $V(x) = 0$.\n\nThe potential in this problem is $V(x) = V_{0} \\sum_{n \\in \\mathbb{Z}} \\delta(x - n a)$. This potential is zero if and only if $V_0 = 0$. The dimensionless barrier strength is defined as $P \\equiv \\frac{m V_{0} a}{\\hbar^{2}}$. Since $m$, $a$, and $\\hbar$ are all positive constants, $P=0$ if and only if $V_0=0$.\n\nA band gap exists at $k = \\frac{\\pi}{a}$ for any $V_0 > 0$, which corresponds to any $P > 0$. The gap closes and vanishes completely only in the limit $V_0 \\to 0$, which is equivalent to $P \\to 0$. Therefore, the \"critical\" value of the barrier strength at which the band gap \"first opens\" is the value that separates the no-gap regime ($P=0$) from the gapped regime ($P>0$).\n\nThis critical value is $P_c = 0$.\n\n**Part 2: Calculation of the Energy Gap $\\Delta E$**\n\nWe employ first-order degenerate perturbation theory, as stipulated. This is the essence of the nearly free electron model. The unperturbed system is a free electron described by the Hamiltonian $H_0 = -\\frac{\\hbar^2}{2m} \\frac{d^2}{dx^2}$. The perturbation is the periodic potential $V(x)$.\n\nThe unperturbed eigenstates are plane waves $\\psi_q(x) = \\frac{1}{\\sqrt{L}} \\exp(iqx)$, with energies $E_q^0 = \\frac{\\hbar^2 q^2}{2m}$. At the first Brillouin zone boundary, $k = \\frac{\\pi}{a}$, the state $\\psi_k(x)$ is degenerate with the state $\\psi_{k-G}(x)$, where $G = \\frac{2\\pi}{a}$ is the smallest non-zero reciprocal lattice vector.\n\nThe two degenerate states at $k = \\frac{\\pi}{a}$ are:\n- $|\\psi_1 \\rangle = |\\psi_{\\pi/a} \\rangle$, corresponding to $q_1 = \\frac{\\pi}{a}$.\n- $|\\psi_2 \\rangle = |\\psi_{\\pi/a - 2\\pi/a} \\rangle = |\\psi_{-\\pi/a} \\rangle$, corresponding to $q_2 = -\\frac{\\pi}{a}$.\n\nBoth states have the same unperturbed energy:\n$E^0 = E_{\\pi/a}^0 = E_{-\\pi/a}^0 = \\frac{\\hbar^2 (\\pi/a)^2}{2m}$.\n\nIn the degenerate subspace spanned by $\\{|\\psi_1 \\rangle, |\\psi_2 \\rangle\\}$, we must diagonalize the full Hamiltonian $H = H_0 + V$. The matrix representation of $H$ in this basis is:\n$$\n\\mathbf{H} = \\begin{pmatrix}\n\\langle \\psi_1 | H | \\psi_1 \\rangle & \\langle \\psi_1 | H | \\psi_2 \\rangle \\\\\n\\langle \\psi_2 | H | \\psi_1 \\rangle & \\langle \\psi_2 | H | \\psi_2 \\rangle\n\\end{pmatrix}\n$$\nThe matrix elements are:\n$H_{ij} = \\langle \\psi_i | H_0 + V | \\psi_j \\rangle = E^0 \\delta_{ij} + V_{ij}$, where $V_{ij} = \\langle \\psi_i | V | \\psi_j \\rangle$.\n\nLet's compute the matrix elements of the potential $V(x)$. These are the Fourier coefficients of the potential. The Fourier series of $V(x)$ is $V(x) = \\sum_{G'} V_{G'} \\exp(iG'x)$, where the coefficients are given by:\n$$\nV_{G'} = \\frac{1}{a} \\int_{-a/2}^{a/2} V(x) \\exp(-iG'x) dx\n$$\nIn our case, within one unit cell centered at the origin, the potential is $V_0 \\delta(x)$.\n$$\nV_{G'} = \\frac{1}{a} \\int_{-a/2}^{a/2} V_0 \\delta(x) \\exp(-iG'x) dx = \\frac{V_0}{a} \\exp(0) = \\frac{V_0}{a}\n$$\nThis means all Fourier coefficients of the Dirac comb potential are equal to $\\frac{V_0}{a}$.\n\nThe matrix elements $V_{ij}$ are:\n- $V_{11} = \\langle \\psi_{\\pi/a} | V | \\psi_{\\pi/a} \\rangle = V_{G'=0} = \\frac{V_0}{a}$.\n- $V_{22} = \\langle \\psi_{-\\pi/a} | V | \\psi_{-\\pi/a} \\rangle = V_{G'=0} = \\frac{V_0}{a}$.\n- $V_{12} = \\langle \\psi_{\\pi/a} | V | \\psi_{-\\pi/a} \\rangle = V_{G' = (\\pi/a) - (-\\pi/a) = 2\\pi/a} = \\frac{V_0}{a}$.\n- $V_{21} = \\langle \\psi_{-\\pi/a} | V | \\psi_{\\pi/a} \\rangle = V_{G' = (-\\pi/a) - (\\pi/a) = -2\\pi/a} = \\frac{V_0}{a}$.\n\nThe Hamiltonian matrix becomes:\n$$\n\\mathbf{H} = \\begin{pmatrix}\nE^0 + \\frac{V_0}{a} & \\frac{V_0}{a} \\\\\n\\frac{V_0}{a} & E^0 + \\frac{V_0}{a}\n\\end{pmatrix}\n$$\nThe eigenvalues $E$ are found by solving the characteristic equation $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$:\n$$\n\\left( E^0 + \\frac{V_0}{a} - E \\right)^2 - \\left( \\frac{V_0}{a} \\right)^2 = 0\n$$\n$$\nE^0 + \\frac{V_0}{a} - E = \\pm \\frac{V_0}{a}\n$$\nThis gives two energy eigenvalues:\n$E_+ = E^0 + \\frac{V_0}{a} + \\frac{V_0}{a} = E^0 + \\frac{2V_0}{a}$\n$E_- = E^0 + \\frac{V_0}{a} - \\frac{V_0}{a} = E^0$\n\nThe energy gap $\\Delta E$ at the first Brillouin zone boundary is the difference between these two energy levels:\n$$\n\\Delta E = E_+ - E_- = \\left( E^0 + \\frac{2V_0}{a} \\right) - E^0 = \\frac{2V_0}{a}\n$$\nThe problem requires this to be expressed in terms of $P = \\frac{m V_{0} a}{\\hbar^{2}}$. We solve for $V_0$:\n$$\nV_0 = \\frac{P \\hbar^2}{ma}\n$$\nSubstituting this into the expression for $\\Delta E$:\n$$\n\\Delta E = \\frac{2}{a} \\left( \\frac{P \\hbar^2}{ma} \\right) = \\frac{2P\\hbar^2}{ma^2}\n$$\nThis result is valid in the small-$P$ limit, consistent with the use of first-order perturbation theory for a weak potential. This is the energy gap in Joules, as required.\n\nThe final result combines the value for $P_c$ and the expression for $\\Delta E$.\n$P_c = 0$\n$\\Delta E = \\frac{2P\\hbar^2}{ma^2}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & \\frac{2P\\hbar^{2}}{ma^{2}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In contrast to the NFE model, the Tight-Binding (TB) model starts from the opposite limit: electrons tightly bound to individual atoms. This exercise challenges you to construct the band structure by considering the \"hopping\" of electrons between neighboring atomic orbitals in a three-dimensional simple cubic crystal. By deriving the full 3D dispersion relation $E(\\mathbf{k})$ and then calculating the low-energy density of states (DOS), you will see how the atomic-level interactions directly shape the macroscopic electronic properties of the material .",
            "id": "3730002",
            "problem": "Consider a three-dimensional simple cubic crystal with lattice constant $a$ and one orbital per lattice site. Assume a nearest-neighbor tight-binding Hamiltonian with on-site energy $\\epsilon_{0}$ and a hopping amplitude $t$ between nearest neighbors, with $t>0$. Using the time-independent Schrödinger equation and the tight-binding Bloch ansatz, derive the single-band Bloch dispersion $E(\\mathbf{k})$ in terms of $k_{x}$, $k_{y}$, $k_{z}$, and identify the wave vector $\\mathbf{k}$ at which the band minimum occurs together with the corresponding band-edge energy $E_{\\min}$. Linearize the dispersion to second order in the magnitude $k=|\\mathbf{k}|$ near the band minimum and write it in a parabolic form. Starting from the definition of the density of states (DOS) per unit volume including spin degeneracy of two, \n$$\nD(E)=\\frac{g_{s}}{(2\\pi)^{3}}\\int d^{3}k\\,\\delta\\!\\left(E - E(\\mathbf{k})\\right),\\quad g_{s}=2,\n$$\nevaluate the low-energy DOS near the band minimum by using the parabolic approximation you obtained. Express your final result as a single, closed-form analytic expression for the low-energy DOS $D_{\\text{low}}(E)$ as a function of $E$, $\\epsilon_{0}$, $t$, and $a$, valid for $E\\geq E_{\\min}$. Express the DOS per unit volume in units of $\\mathrm{J}^{-1}\\,\\mathrm{m}^{-3}$. No rounding is required.",
            "solution": "The problem asks for the derivation of the low-energy density of states (DOS) for a three-dimensional simple cubic crystal described by a nearest-neighbor tight-binding model. The derivation proceeds in four main steps: 1. Derivation of the energy dispersion relation $E(\\mathbf{k})$. 2. Identification of the band minimum. 3. Approximation of the dispersion near the minimum. 4. Calculation of the DOS using this approximation.\n\n**1. Derivation of the Dispersion Relation $E(\\mathbf{k})$**\n\nWe consider a simple cubic lattice with lattice constant $a$. The lattice sites are given by vectors $\\mathbf{R} = n_1 a \\hat{x} + n_2 a \\hat{y} + n_3 a \\hat{z}$ for integers $n_1, n_2, n_3$. The tight-binding model assumes that the electronic wavefunction can be written as a linear combination of atomic orbitals $|\\phi(\\mathbf{R})\\rangle$ localized at each lattice site $\\mathbf{R}$.\n\nAccording to Bloch's theorem, the wavefunction of an electron in a periodic potential is a Bloch wave. In the tight-binding approximation, the Bloch wavefunction $|\\psi(\\mathbf{k})\\rangle$ for a given wave vector $\\mathbf{k}$ is constructed as:\n$$\n|\\psi(\\mathbf{k})\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}} e^{i\\mathbf{k} \\cdot \\mathbf{R}} |\\phi(\\mathbf{R})\\rangle\n$$\nwhere $N$ is the number of lattice sites. We assume the atomic orbitals are orthonormal: $\\langle\\phi(\\mathbf{R'})|\\phi(\\mathbf{R})\\rangle = \\delta_{\\mathbf{R'},\\mathbf{R}}$.\n\nThe energy dispersion $E(\\mathbf{k})$ is the eigenvalue of the Hamiltonian $H$ for the state $|\\psi(\\mathbf{k})\\rangle$, given by the expectation value:\n$$\nE(\\mathbf{k}) = \\langle\\psi(\\mathbf{k})|H|\\psi(\\mathbf{k})\\rangle = \\frac{1}{N} \\sum_{\\mathbf{R'},\\mathbf{R}} e^{i\\mathbf{k} \\cdot (\\mathbf{R} - \\mathbf{R'})} \\langle\\phi(\\mathbf{R'})|H|\\phi(\\mathbf{R})\\rangle\n$$\nThe problem specifies the Hamiltonian matrix elements:\n- On-site energy: $\\langle\\phi(\\mathbf{R})|H|\\phi(\\mathbf{R})\\rangle = \\epsilon_0$.\n- Nearest-neighbor hopping: $\\langle\\phi(\\mathbf{R'})|H|\\phi(\\mathbf{R})\\rangle = -t$ if $\\mathbf{R'}$ and $\\mathbf{R}$ are nearest neighbors. The hopping amplitude $t$ is given as positive ($t>0$).\n- All other off-site matrix elements are zero.\n\nLet $\\mathbf{R'} = \\mathbf{R} + \\boldsymbol{\\delta}$, where $\\boldsymbol{\\delta}$ is a vector connecting a site to one of its neighbors. The sum can be rewritten as:\n$$\nE(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}} \\sum_{\\boldsymbol{\\delta}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} \\langle\\phi(\\mathbf{R}+\\boldsymbol{\\delta})|H|\\phi(\\mathbf{R})\\rangle\n$$\nThe sum over $\\boldsymbol{\\delta}$ includes the term $\\boldsymbol{\\delta}=\\mathbf{0}$ (on-site) and the nearest-neighbor terms.\n$$\nE(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}} \\left( \\langle\\phi(\\mathbf{R})|H|\\phi(\\mathbf{R})\\rangle + \\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} \\langle\\phi(\\mathbf{R}+\\boldsymbol{\\delta})|H|\\phi(\\mathbf{R})\\rangle \\right)\n$$\nThe term inside the parenthesis is independent of $\\mathbf{R}$. The sum over $N$ identical terms gives $N$ times the term, which cancels the $1/N$ prefactor.\n$$\nE(\\mathbf{k}) = \\epsilon_0 + \\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} (-t) = \\epsilon_0 - t \\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}}\n$$\nFor a simple cubic lattice, the nearest-neighbor vectors $\\boldsymbol{\\delta}$ are $\\pm a\\hat{x}$, $\\pm a\\hat{y}$, and $\\pm a\\hat{z}$. The sum is over these six vectors:\n$$\n\\sum_{\\boldsymbol{\\delta} \\neq \\mathbf{0}} e^{-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}} = e^{-ik_x a} + e^{ik_x a} + e^{-ik_y a} + e^{ik_y a} + e^{-ik_z a} + e^{ik_z a}\n$$\nUsing Euler's formula, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, the sum becomes:\n$$\n2\\cos(k_x a) + 2\\cos(k_y a) + 2\\cos(k_z a)\n$$\nSubstituting this back into the expression for $E(\\mathbf{k})$, we obtain the dispersion relation:\n$$\nE(\\mathbf{k}) = \\epsilon_0 - 2t(\\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a))\n$$\n\n**2. Identification of the Band Minimum**\n\nTo find the minimum energy of the band, $E_{\\min}$, we need to find the minimum value of $E(\\mathbf{k})$. Since $t > 0$, this corresponds to maximizing the term $(\\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a))$. The maximum value of the cosine function is $1$. This maximum occurs when its argument is an integer multiple of $2\\pi$. Within the first Brillouin zone ($-\\pi/a < k_i \\leq \\pi/a$), this condition is met at $k_x a = 0$, $k_y a = 0$, and $k_z a = 0$.\nThus, the band minimum occurs at the wave vector $\\mathbf{k} = \\mathbf{0}$ (the center of the Brillouin zone, or $\\Gamma$-point).\n\nThe minimum energy, $E_{\\min}$, is the value of $E(\\mathbf{k})$ at $\\mathbf{k}=\\mathbf{0}$:\n$$\nE_{\\min} = E(\\mathbf{0}) = \\epsilon_0 - 2t(\\cos(0) + \\cos(0) + \\cos(0)) = \\epsilon_0 - 2t(1+1+1)\n$$\n$$\nE_{\\min} = \\epsilon_0 - 6t\n$$\n\n**3. Parabolic Approximation**\n\nFor low energies, electrons occupy states near the band minimum, i.e., for small wave vectors $|\\mathbf{k}|$. We can Taylor expand the dispersion relation $E(\\mathbf{k})$ around $\\mathbf{k}=\\mathbf{0}$. We use the second-order approximation for the cosine function: $\\cos(\\theta) \\approx 1 - \\frac{\\theta^2}{2}$ for small $\\theta$.\nLet $\\theta_x = k_x a$, $\\theta_y = k_y a$, and $\\theta_z = k_z a$. For small $|\\mathbf{k}|$, these are small quantities.\n$$\nE(\\mathbf{k}) \\approx \\epsilon_0 - 2t \\left( \\left(1 - \\frac{(k_x a)^2}{2}\\right) + \\left(1 - \\frac{(k_y a)^2}{2}\\right) + \\left(1 - \\frac{(k_z a)^2}{2}\\right) \\right)\n$$\n$$\nE(\\mathbf{k}) \\approx \\epsilon_0 - 2t \\left( 3 - \\frac{a^2}{2}(k_x^2 + k_y^2 + k_z^2) \\right)\n$$\n$$\nE(\\mathbf{k}) \\approx \\epsilon_0 - 6t + t a^2 (k_x^2 + k_y^2 + k_z^2)\n$$\nRecognizing that $k^2 = |\\mathbf{k}|^2 = k_x^2 + k_y^2 + k_z^2$ and $E_{\\min} = \\epsilon_0 - 6t$, we obtain the parabolic approximation for the dispersion:\n$$\nE(\\mathbf{k}) \\approx E_{\\min} + ta^2 k^2\n$$\n\n**4. Calculation of the Low-Energy Density of States (DOS)**\n\nThe problem provides the definition for the DOS per unit volume, including spin degeneracy $g_s=2$:\n$$\nD(E) = \\frac{g_s}{(2\\pi)^3} \\int d^3k \\, \\delta(E - E(\\mathbf{k}))\n$$\nWe evaluate the low-energy DOS, $D_{\\text{low}}(E)$, by using the parabolic approximation for $E(\\mathbf{k})$:\n$$\nD_{\\text{low}}(E) = \\frac{g_s}{(2\\pi)^3} \\int d^3k \\, \\delta(E - (E_{\\min} + ta^2 k^2))\n$$\nSince the integrand depends only on the magnitude $k=|\\mathbf{k}|$, we can switch to spherical coordinates in $\\mathbf{k}$-space, where the volume element is $d^3k = 4\\pi k^2 dk$. The integral becomes:\n$$\nD_{\\text{low}}(E) = \\frac{g_s}{(2\\pi)^3} \\int_0^\\infty 4\\pi k^2 \\delta(E - E_{\\min} - ta^2 k^2) dk = \\frac{g_s}{2\\pi^2} \\int_0^\\infty k^2 \\delta(E - E_{\\min} - ta^2 k^2) dk\n$$\nThe integral is non-zero only for $E \\ge E_{\\min}$. To evaluate the integral involving the Dirac delta function, we use the property $\\int f(x) \\delta(g(x)) dx = \\sum_i \\frac{f(x_i)}{|g'(x_i)|}$, where $x_i$ are the roots of $g(x)=0$.\nHere, the variable is $k$, $f(k) = k^2$, and $g(k) = E - E_{\\min} - ta^2 k^2$.\nThe root $k_0$ of $g(k)=0$ is found by solving $E - E_{\\min} - ta^2 k_0^2 = 0$:\n$$\nk_0^2 = \\frac{E - E_{\\min}}{ta^2} \\implies k_0 = \\sqrt{\\frac{E - E_{\\min}}{ta^2}}\n$$\nWe consider only the positive root since the integration domain is $k \\in [0, \\infty)$. The derivative of $g(k)$ is $g'(k) = -2ta^2 k$. Its magnitude at $k_0$ is:\n$$\n|g'(k_0)| = |-2ta^2 k_0| = 2ta^2 k_0\n$$\nThe value of the integral is then:\n$$\n\\frac{f(k_0)}{|g'(k_0)|} = \\frac{k_0^2}{2ta^2 k_0} = \\frac{k_0}{2ta^2} = \\frac{1}{2ta^2} \\sqrt{\\frac{E - E_{\\min}}{ta^2}} = \\frac{\\sqrt{E - E_{\\min}}}{2(ta^2)^{3/2}}\n$$\nSubstituting this result back into the expression for $D_{\\text{low}}(E)$:\n$$\nD_{\\text{low}}(E) = \\frac{g_s}{2\\pi^2} \\left(\\frac{\\sqrt{E - E_{\\min}}}{2(ta^2)^{3/2}}\\right) = \\frac{g_s \\sqrt{E - E_{\\min}}}{4\\pi^2 (ta^2)^{3/2}}\n$$\nNow, we substitute the given value $g_s=2$ and the derived expression for $E_{\\min} = \\epsilon_0 - 6t$:\n$$\nD_{\\text{low}}(E) = \\frac{2 \\sqrt{E - (\\epsilon_0 - 6t)}}{4\\pi^2 (ta^2)^{3/2}} = \\frac{\\sqrt{E - \\epsilon_0 + 6t}}{2\\pi^2 (ta^2)^{3/2}}\n$$\nThis expression is valid for $E \\ge E_{\\min}$. For $E < E_{\\min}$, the DOS is $0$. The problem asks for the expression for $E \\ge E_{\\min}$. The units of this expression are $\\mathrm{J}^{-1}\\,\\mathrm{m}^{-3}$ as energy parameters ($E, \\epsilon_0, t$) are in Joules and the lattice constant $a$ is in meters.\n\nFinal result for the low-energy DOS is:\n$$\nD_{\\text{low}}(E) = \\frac{1}{2\\pi^2 (ta^2)^{3/2}} \\sqrt{E - \\epsilon_0 + 6t}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{E - \\epsilon_{0} + 6t}}{2\\pi^{2} (ta^{2})^{3/2}}}\n$$"
        },
        {
            "introduction": "While analytical models offer crucial insights, calculating the band structure of real materials requires robust computational methods. This practice guides you through the formulation and implementation of the plane-wave expansion method, the workhorse of modern electronic structure theory. You will transform the continuous Schrödinger differential equation into a discrete matrix eigenvalue problem, which can be solved numerically, and then write a program to compute the band energies for a given potential, bridging the gap between abstract theory and practical, quantitative prediction .",
            "id": "3729998",
            "problem": "You are asked to formulate and implement the plane-wave expansion method for a one-dimensional periodic potential and to derive the corresponding matrix eigenvalue problem for the energy bands. The physical basis must be the non-relativistic time-independent Schrödinger equation and Bloch’s theorem. You must then write a program that constructs and solves this matrix eigenvalue problem for a prescribed set of test cases.\n\nStart from the non-relativistic time-independent Schrödinger equation for a single electron of mass $m$ in a periodic potential $V(x)$, expressed in atomic units (where $\\hbar = 1$ and $m = 1$):\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\,\\psi(x).\n$$\nAssume a one-dimensional lattice of period $a$ so that $V(x + a) = V(x)$. Define the reciprocal lattice vectors $G = \\frac{2\\pi}{a}n$ where $n \\in \\mathbb{Z}$. By Bloch’s theorem, the eigenstates at crystal momentum $k$ can be written as $\\psi_k(x) = e^{ikx} u_k(x)$ where $u_k(x+a) = u_k(x)$. Expand the periodic part in plane waves up to a truncation $|G|\\le G_{\\text{max}}$:\n$$\nu_k(x) = \\sum_{|G|\\le G_{\\text{max}}} c_{k,G}\\, e^{iGx},\n$$\nso that\n$$\n\\psi_k(x) = \\sum_{|G|\\le G_{\\text{max}}} c_{k,G}\\, e^{i(k+G)x}.\n$$\nAssume the periodic potential has the Fourier series coefficients $V_q$ defined by\n$$\nV(x) = \\sum_{q} V_q \\, e^{iqx},\n$$\nwith $q$ restricted to reciprocal lattice vectors. For concreteness and to enable numerical tests, consider the potential\n$$\nV(x) = U_0 + V_0 \\cos\\left(\\frac{2\\pi}{a}x\\right) + V_1 \\cos\\left(\\frac{4\\pi}{a}x\\right),\n$$\nwhich implies nonzero Fourier components $V_0 = U_0$, $V_{\\pm \\frac{2\\pi}{a}} = \\frac{V_0}{2}$, $V_{\\pm \\frac{4\\pi}{a}} = \\frac{V_1}{2}$, and all other $V_q = 0$.\n\nTask $1$: Starting from the Schrödinger equation and using Bloch’s theorem and the above plane-wave expansion, derive the finite-dimensional matrix eigenvalue problem for the coefficients $c_{k,G}$,\n$$\n\\sum_{|G'|\\le G_{\\text{max}}} H_{G,G'}(k)\\, c_{k,G'} = E(k)\\, c_{k,G},\n$$\nby projecting onto the basis $\\{e^{i(k+G)x}\\}$. Express $H_{G,G'}(k)$ explicitly in terms of $k$, $G$, $G'$, and the Fourier components $V_{G-G'}$, and identify the kinetic and potential contributions. Do not assume any special form of $V(x)$ beyond periodicity while deriving; you may then specialize to the concrete $V(x)$ above to obtain explicit nonzero $V_q$.\n\nTask $2$: Implement a program that, for each test case listed below, constructs the truncated Hamiltonian matrix $H_{G,G'}(k)$ with all $G$ satisfying $|G|\\le G_{\\text{max}}$ and diagonalizes it to obtain the energy eigenvalues $E_n(k)$ sorted in ascending order. Use atomic units with $\\hbar = 1$ and $m = 1$, so energies must be reported in these atomic units. The reciprocal lattice spacing is $G_0 = \\frac{2\\pi}{a}$. The set of plane waves included must be indexed by integers $n$ with $G = n G_0$ such that $|G|\\le G_{\\text{max}}$. Be careful to implement the potential matrix elements via $V_{G-G'}$. In the specialization to the concrete potential $V(x)$ given above, you may treat the Fourier coefficients by integer differences of reciprocal indices: $V_{0} = U_0$, $V_{\\pm 1} = \\frac{V_0}{2}$, $V_{\\pm 2} = \\frac{V_1}{2}$, and otherwise zero, where $V_{m}$ denotes the coefficient at $q = m G_0$. The output for each test case must be the list of all computed band energies at that $k$, sorted ascending.\n\nNumerical units: Report all energies in atomic units (dimensionless) consistent with $\\hbar = 1$ and $m = 1$. No angle units are required because $k$ is a wavevector in reciprocal space, not an angle.\n\nTest suite:\n- Case $1$ (general happy path): $a = 1.0$, $U_0 = 0.0$, $V_0 = 0.5$, $V_1 = 0.2$, $G_{\\text{max}} = 4\\pi$, $k = 0.4\\pi$.\n- Case $2$ (Brillouin zone boundary): $a = 1.0$, $U_0 = 0.0$, $V_0 = 0.6$, $V_1 = 0.0$, $G_{\\text{max}} = 2\\pi$, $k = \\pi$.\n- Case $3$ (minimal basis edge case): $a = 1.0$, $U_0 = 0.0$, $V_0 = 0.8$, $V_1 = 0.0$, $G_{\\text{max}} = 0.0$, $k = 0.3\\pi$.\n- Case $4$ (different lattice constant and nonzero average potential): $a = 2.0$, $U_0 = 0.1$, $V_0 = 0.4$, $V_1 = 0.25$, $G_{\\text{max}} = 2\\pi$, $k = \\frac{\\pi}{2}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of floating-point energies in ascending order for the corresponding test case. For example, a valid output format is\n$$\n[\\,[E_{1}^{(1)},E_{2}^{(1)},\\dots],\\,[E_{1}^{(2)},E_{2}^{(2)},\\dots],\\,\\dots\\,]\n$$\nwith no additional text. The superscripts indicate the test case index, and the subscripts enumerate the bands. The number of energies per test case equals the number of included plane waves for that case.",
            "solution": "The objective is to derive the matrix eigenvalue problem for electronic band structure in a one-dimensional periodic potential using the plane-wave method and to implement a numerical solution.\n\n### Task 1: Derivation of the Matrix Eigenvalue Problem\n\nWe begin with the one-dimensional, time-independent Schrödinger equation in atomic units ($\\hbar=1$, $m=1$):\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\,\\psi(x)\n$$\nThe potential $V(x)$ is periodic with lattice constant $a$, so $V(x+a) = V(x)$. According to Bloch's theorem, the eigenfunctions in such a potential have the form $\\psi_k(x) = e^{ikx}u_k(x)$, where $k$ is the crystal momentum and $u_k(x)$ has the same periodicity as the lattice, $u_k(x+a)=u_k(x)$.\n\nThe periodic function $u_k(x)$ can be expanded in a Fourier series over the reciprocal lattice vectors $G = n \\frac{2\\pi}{a}$ for $n \\in \\mathbb{Z}$:\n$$\nu_k(x) = \\sum_{G} c_{k,G}\\, e^{iGx}\n$$\nThis implies that the Bloch wavefunction $\\psi_k(x)$ can be expanded in a basis of plane waves:\n$$\n\\psi_k(x) = e^{ikx} \\sum_{G} c_{k,G}\\, e^{iGx} = \\sum_{G} c_{k,G}\\, e^{i(k+G)x}\n$$\nThe periodic potential $V(x)$ can also be expanded in a Fourier series over the same reciprocal lattice vectors:\n$$\nV(x) = \\sum_{q} V_q \\, e^{iqx}\n$$\nwhere the Fourier coefficients are given by $V_q = \\frac{1}{a} \\int_0^a V(x)e^{-iqx}dx$.\n\nWe now substitute the plane-wave expansions for $\\psi_k(x)$ and $V(x)$ into the Schrödinger equation. First, we evaluate the action of the Hamiltonian operator on $\\psi_k(x)$.\n\nThe kinetic energy term is:\n$$\n-\\frac{1}{2}\\frac{d^2}{dx^2} \\psi_k(x) = -\\frac{1}{2}\\frac{d^2}{dx^2} \\sum_{G'} c_{k,G'}\\, e^{i(k+G')x} = \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 e^{i(k+G')x}\n$$\nThe potential energy term is:\n$$\nV(x)\\psi_k(x) = \\left(\\sum_{q} V_q e^{iqx}\\right) \\left(\\sum_{G'} c_{k,G'} e^{i(k+G')x}\\right) = \\sum_{q,G'} V_q c_{k,G'} e^{i(k+G'+q)x}\n$$\nSubstituting these into the Schrödinger equation yields:\n$$\n\\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 e^{i(k+G')x} + \\sum_{q,G'} V_q c_{k,G'} e^{i(k+G'+q)x} = E(k) \\sum_{G'} c_{k,G'} e^{i(k+G')x}\n$$\nTo obtain an equation for the coefficients $c_{k,G}$, we project this equation onto a specific basis function $e^{i(k+G)x}$. This is accomplished by multiplying by $e^{-i(k+G)x}$ and integrating over one unit cell (from $0$ to $a$), then dividing by the length $a$.\n\nLet's apply this projection to each term, using the orthogonality relation $\\frac{1}{a}\\int_0^a e^{i(G_1-G_2)x}dx = \\delta_{G_1, G_2}$:\n\n1.  Projection of the kinetic term:\n    $$\n    \\frac{1}{a}\\int_0^a dx\\, e^{-i(k+G)x} \\left( \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 e^{i(k+G')x} \\right) = \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 \\left( \\frac{1}{a}\\int_0^a e^{i(G'-G)x}dx \\right)\n    $$\n    $$\n    = \\sum_{G'} c_{k,G'} \\frac{1}{2}(k+G')^2 \\delta_{G,G'} = c_{k,G} \\frac{1}{2}(k+G)^2\n    $$\n\n2.  Projection of the potential term:\n    $$\n    \\frac{1}{a}\\int_0^a dx\\, e^{-i(k+G)x} \\left( \\sum_{q,G'} V_q c_{k,G'} e^{i(k+G'+q)x} \\right) = \\sum_{q,G'} V_q c_{k,G'} \\left( \\frac{1}{a}\\int_0^a e^{i(G'-G+q)x}dx \\right)\n    $$\n    The integral is non-zero only if $G'-G+q=0$, which implies $q=G-G'$. The sum over $q$ collapses to a single term for each $G'$:\n    $$\n    = \\sum_{G'} V_{G-G'} c_{k,G'}\n    $$\n\n3.  Projection of the energy term on the right-hand side:\n    $$\n    \\frac{1}{a}\\int_0^a dx\\, e^{-i(k+G)x} \\left( E(k) \\sum_{G'} c_{k,G'} e^{i(k+G')x} \\right) = E(k) \\sum_{G'} c_{k,G'} \\left( \\frac{1}{a}\\int_0^a e^{i(G'-G)x}dx \\right)\n    $$\n    $$\n    = E(k) \\sum_{G'} c_{k,G'} \\delta_{G,G'} = E(k) c_{k,G}\n    $$\nCombining these projected terms, we get for each $G$:\n$$\n\\frac{1}{2}(k+G)^2 c_{k,G} + \\sum_{G'} V_{G-G'} c_{k,G'} = E(k) c_{k,G}\n$$\nRearranging this equation to group terms involving the coefficients $c_{k,G'}$:\n$$\n\\sum_{G'} \\left[ \\frac{1}{2}(k+G)^2 \\delta_{G,G'} + V_{G-G'} \\right] c_{k,G'} = E(k) c_{k,G}\n$$\nThis is a matrix eigenvalue problem, $\\sum_{G'} H_{G,G'}(k) c_{k,G'} = E(k) c_{k,G}$, where the Hamiltonian matrix elements $H_{G,G'}(k)$ are given by:\n$$\nH_{G,G'}(k) = \\frac{1}{2}(k+G)^2 \\delta_{G,G'} + V_{G-G'}\n$$\nThe first term, $T_{G,G'} = \\frac{1}{2}(k+G)^2 \\delta_{G,G'}$, represents the kinetic energy and is diagonal in the plane-wave basis. The second term, $U_{G,G'} = V_{G-G'}$, represents the potential energy and couples plane waves whose wavevectors differ by a reciprocal lattice vector.\n\nFor the specific potential $V(x) = U_0 + V_0 \\cos\\left(\\frac{2\\pi}{a}x\\right) + V_1 \\cos\\left(\\frac{4\\pi}{a}x\\right)$, we use Euler's identity $\\cos(\\theta) = \\frac{e^{i\\theta} + e^{-i\\theta}}{2}$:\n$$\nV(x) = U_0 + \\frac{V_0}{2}\\left(e^{i\\frac{2\\pi}{a}x} + e^{-i\\frac{2\\pi}{a}x}\\right) + \\frac{V_1}{2}\\left(e^{i\\frac{4\\pi}{a}x} + e^{-i\\frac{4\\pi}{a}x}\\right)\n$$\nBy comparing this to the general Fourier series $V(x) = \\sum_{q} V_q e^{iqx}$, we identify the non-zero Fourier coefficients $V_q$. Let $G_0 = \\frac{2\\pi}{a}$ be the fundamental reciprocal lattice vector. Then $q=mG_0$ for some integer $m$. The non-zero coefficients are:\n-   $V_{q=0} = U_0$ (for $m=0$)\n-   $V_{q=\\pm G_0} = \\frac{V_0}{2}$ (for $m=\\pm 1$)\n-   $V_{q=\\pm 2G_0} = \\frac{V_1}{2}$ (for $m=\\pm 2$)\nAll other $V_q$ are zero. The potential matrix element $V_{G-G'}$ depends on the difference of the integer indices of $G=nG_0$ and $G'=n'G_0$. Let $m=n-n'$. The non-zero elements are $V_{(n-n')G_0}$, which correspond to $m \\in \\{0, \\pm 1, \\pm 2\\}$.\n\nThe expansion is truncated by including only reciprocal vectors $G$ such that $|G| \\le G_{\\text{max}}$. This condition translates to $|n \\frac{2\\pi}{a}| \\le G_{\\text{max}}$, or $|n| \\le \\lfloor G_{\\text{max}} a / (2\\pi) \\rfloor$. This defines a finite set of plane waves, resulting in a finite-dimensional Hamiltonian matrix to be diagonalized.\n\n### Task 2: Implementation Details\n\nThe numerical implementation involves constructing and diagonalizing the truncated Hamiltonian matrix for each test case.\n1.  For each case, determine the primitive reciprocal lattice vector $G_0 = \\frac{2\\pi}{a}$.\n2.  Calculate the maximum integer index $n_{\\text{max}} = \\lfloor G_{\\text{max}} / G_0 \\rfloor$.\n3.  The basis consists of plane waves with $G = nG_0$ for $n \\in \\{-n_{\\text{max}}, -n_{\\text{max}}+1, \\dots, n_{\\text{max}}\\}$. The dimension of the Hamiltonian matrix is $N = 2n_{\\text{max}}+1$.\n4.  Construct the $N \\times N$ matrix $H$. The matrix indices $i, j$ (from $0$ to $N-1$) correspond to integer indices $n_i, n_j$ (from $-n_{\\text{max}}$ to $n_{\\text{max}}$).\n5.  The matrix elements are populated as follows:\n    -   Diagonal elements ($i=j$): $H_{i,i}(k) = \\frac{1}{2}(k+n_i G_0)^2 + U_0$.\n    -   Off-diagonal elements ($i \\neq j$): The value $H_{i,j}(k)$ is determined by $V_{G_i-G_j} = V_{(n_i-n_j)G_0}$.\n        -   If $|n_i - n_j| = 1$, $H_{i,j}(k) = \\frac{V_0}{2}$.\n        -   If $|n_i - n_j| = 2$, $H_{i,j}(k) = \\frac{V_1}{2}$.\n        -   Otherwise, $H_{i,j}(k) = 0$.\n6.  The resulting matrix is real and symmetric. Its eigenvalues, representing the energy bands $E_n(k)$, are found using a numerical eigensolver for Hermitian matrices. The eigenvalues are sorted in ascending order as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plane-wave expansion problem for a 1D periodic potential.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general happy path)\n        {\"a\": 1.0, \"U0\": 0.0, \"V0\": 0.5, \"V1\": 0.2, \"G_max\": 4 * np.pi, \"k\": 0.4 * np.pi},\n        # Case 2 (Brillouin zone boundary)\n        {\"a\": 1.0, \"U0\": 0.0, \"V0\": 0.6, \"V1\": 0.0, \"G_max\": 2 * np.pi, \"k\": np.pi},\n        # Case 3 (minimal basis edge case)\n        {\"a\": 1.0, \"U0\": 0.0, \"V0\": 0.8, \"V1\": 0.0, \"G_max\": 0.0, \"k\": 0.3 * np.pi},\n        # Case 4 (different lattice constant and nonzero average potential)\n        {\"a\": 2.0, \"U0\": 0.1, \"V0\": 0.4, \"V1\": 0.25, \"G_max\": 2 * np.pi, \"k\": np.pi / 2},\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        a = case[\"a\"]\n        U0 = case[\"U0\"]\n        V0 = case[\"V0\"]\n        V1 = case[\"V1\"]\n        G_max = case[\"G_max\"]\n        k = case[\"k\"]\n\n        # Calculate primitive reciprocal lattice vector\n        G0 = 2.0 * np.pi / a\n        \n        # Determine the range of integer indices n for G vectors\n        # Handle G_max = 0 case\n        if G0 > 1e-9:\n            n_max = int(np.floor(G_max / G0 + 1e-9)) # Add tolerance for floating point\n        else:\n            n_max = 0\n            \n        n_indices = np.arange(-n_max, n_max + 1)\n        num_basis_vectors = len(n_indices)\n        \n        # Initialize the Hamiltonian matrix\n        H = np.zeros((num_basis_vectors, num_basis_vectors))\n        \n        # Fourier coefficients of the potential\n        V_coeffs= {}\n        V_coeffs[0] = U0\n        V_coeffs[1] = V0 / 2.0\n        V_coeffs[-1] = V0 / 2.0\n        V_coeffs[2] = V1 / 2.0\n        V_coeffs[-2] = V1 / 2.0\n        \n        # Construct the Hamiltonian matrix\n        for i in range(num_basis_vectors):\n            for j in range(num_basis_vectors):\n                n_i = n_indices[i]\n                n_j = n_indices[j]\n                \n                # Potential energy part\n                m_diff = n_i - n_j\n                potential_term = V_coeffs.get(m_diff, 0.0)\n                \n                # Kinetic energy part (diagonal)\n                if i == j:\n                    G = n_i * G0\n                    kinetic_term = 0.5 * (k + G)**2\n                    H[i, j] = kinetic_term + potential_term\n                else:\n                    H[i, j] = potential_term\n\n        # Diagonalize the Hamiltonian to find the energy eigenvalues\n        # np.linalg.eigh is for Hermitian matrices and returns sorted real eigenvalues\n        eigenvalues = np.linalg.eigh(H)[0]\n        all_results.append(eigenvalues.tolist())\n\n    # Format the final output string exactly as specified\n    formatted_results = []\n    for eigvals in all_results:\n        # Format each list of energies into a string '[E1,E2,...]'\n        s = '[' + ','.join([f'{v:.8f}' for v in eigvals]) + ']'\n        formatted_results.append(s)\n    \n    final_str = '[' + ','.join(formatted_results) + ']'\n    print(final_str)\n\nsolve()\n```"
        }
    ]
}