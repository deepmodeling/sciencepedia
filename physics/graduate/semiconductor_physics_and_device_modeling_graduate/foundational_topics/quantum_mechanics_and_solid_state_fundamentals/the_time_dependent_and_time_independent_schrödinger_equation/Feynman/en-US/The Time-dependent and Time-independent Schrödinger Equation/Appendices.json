{
    "hands_on_practices": [
        {
            "introduction": "Understanding quantum confinement is the first step in mastering the physics of nanostructures. This exercise guides you through the canonical problem of a finite potential well, a fundamental model for quantum dots and wells. By solving the time-independent Schrödinger equation and applying boundary conditions, you will derive the transcendental equations that reveal how energy quantization naturally arises from confinement .",
            "id": "2681130",
            "problem": "Consider a one-dimensional finite square well centered at the origin with potential energy $V(x)$ defined by $V(x) = -V_{0}$ for $|x| \\leq a$ and $V(x) = 0$ for $|x| > a$, where $V_{0} > 0$. A nonrelativistic particle of mass $m$ is confined by this potential. Bound states satisfy $E < 0$.\n\nStarting exclusively from the time-independent Schrödinger equation and the definition of the potential above, do the following:\n\n- Solve the time-independent Schrödinger equation piecewise in the interior region $|x| \\leq a$ and the exterior regions $|x| > a$. Enforce normalizability and continuity of the wavefunction and its first derivative at $x = \\pm a$.\n- Use spatial inversion symmetry to classify bound-state solutions by parity (even and odd), and derive the transcendental matching conditions that quantize the allowed bound-state energies. Introduce the dimensionless variables $z = k a$, $p = \\kappa a$, and $z_{0} = a \\sqrt{2 m V_{0}}/\\hbar$, where $k = \\sqrt{2 m (E + V_{0})}/\\hbar$ and $\\kappa = \\sqrt(-2 m E)/\\hbar$, to express your conditions in a fully dimensionless form.\n- Using only the structure of the transcendental equations and their domains, determine a general counting rule for how many bound states exist as a function of $z_{0}$.\n- Now evaluate that rule for an electron in a well with half-width $a = 0.50\\,\\mathrm{nm}$ and depth $V_{0} = 3.00\\,\\mathrm{eV}$. Use $m = m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$, $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$, and $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$. Compute $z_{0}$ numerically and determine the total number of bound states that the well supports.\n\nExpress the final answer as a single integer with no units. Do not round beyond what is necessary to determine the exact integer count of bound states.",
            "solution": "The prerequisite for solving this problem is its validation. The problem is a canonical exercise in quantum mechanics, specifically the application of the time-independent Schrödinger equation to a finite potential well. All givens are clearly stated, scientifically sound, and form a well-posed problem. The parameters provided are physically realistic for an electron in a nanostructure. No inconsistencies, ambiguities, or violations of scientific principles are present. The problem is deemed valid and a solution will be provided.\n\nThe time-independent Schrödinger equation (TISE) in one dimension is\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + V(x) \\psi(x) = E \\psi(x)\n$$\nWe seek bound-state solutions where the energy $E < 0$. The potential is given by\n$$\nV(x) = \\begin{cases} -V_{0} & \\text{for } |x| \\leq a \\\\ 0 & \\text{for } |x| > a \\end{cases}\n$$\nwhere $V_0 > 0$. For a bound state to exist, the energy must be in the range $-V_0 < E < 0$.\n\nWe solve the TISE piecewise in three regions:\nRegion I ($x < -a$): $V(x)=0$. The TISE is $\\frac{d^2\\psi_I}{dx^2} = \\frac{2mE}{\\hbar^2}\\psi_I$. With $E<0$, we define $\\kappa = \\sqrt{-2mE}/\\hbar > 0$. The equation becomes $\\frac{d^2\\psi_I}{dx^2} = \\kappa^2 \\psi_I$. The general solution is $\\psi_I(x) = C_1 e^{\\kappa x} + C_2 e^{-\\kappa x}$. For the wavefunction to be normalizable, $\\psi_I(x) \\to 0$ as $x \\to -\\infty$, which requires $C_2=0$. Thus, $\\psi_I(x) = A e^{\\kappa x}$.\n\nRegion III ($x > a$): $V(x)=0$. The equation is identical to Region I. The general solution is $\\psi_{III}(x) = D_1 e^{\\kappa x} + D_2 e^{-\\kappa x}$. Normalizability requires $\\psi_{III}(x) \\to 0$ as $x \\to +\\infty$, so $D_1=0$. Thus, $\\psi_{III}(x) = F e^{-\\kappa x}$.\n\nRegion II ($-a \\leq x \\leq a$): $V(x) = -V_0$. The TISE is $\\frac{d^2\\psi_{II}}{dx^2} = -\\frac{2m(E+V_0)}{\\hbar^2}\\psi_{II}$. Since $-V_0 < E < 0$, the term $E+V_0 > 0$. We define $k = \\sqrt{2m(E+V_0)}/\\hbar > 0$. The equation becomes $\\frac{d^2\\psi_{II}}{dx^2} = -k^2 \\psi_{II}$. The general solution is $\\psi_{II}(x) = B \\sin(kx) + C \\cos(kx)$.\n\nThe potential $V(x)$ is an even function, $V(x) = V(-x)$. Therefore, the stationary states $\\psi(x)$ can be chosen to have definite parity (even or odd).\n\nEven Solutions ($\\psi(-x) = \\psi(x)$):\nIn Region II, an even function requires the sine term to vanish, so $\\psi_{II}(x) = C \\cos(kx)$.\nIn the exterior regions, the condition $\\psi_I(-x) = \\psi_{III}(x)$ implies $A e^{-\\kappa x} = F e^{-\\kappa x}$, so $A=F$. The solution is $\\psi(x) = A e^{-\\kappa|x|}$ for $|x| > a$.\nWe enforce continuity of $\\psi(x)$ and its first derivative $\\psi'(x)$ at $x=a$:\n\\begin{align*}\nC \\cos(ka) &= A e^{-\\kappa a} \\quad &(1) \\\\\n-k C \\sin(ka) &= -\\kappa A e^{-\\kappa a} \\quad &(2)\n\\end{align*}\nDividing equation $(2)$ by equation $(1)$ (for non-trivial solutions where $A, C \\neq 0$) yields:\n$$\n\\frac{-k C \\sin(ka)}{C \\cos(ka)} = \\frac{-\\kappa A e^{-\\kappa a}}{A e^{-\\kappa a}} \\implies k \\tan(ka) = \\kappa\n$$\nThis is the transcendental equation for even-parity bound states.\n\nOdd Solutions ($\\psi(-x) = -\\psi(x)$):\nIn Region II, an odd function requires the cosine term to vanish, so $\\psi_{II}(x) = B \\sin(kx)$.\nIn the exterior regions, $\\psi_I(-x) = -\\psi_{III}(x)$ implies $A e^{-\\kappa x} = -F e^{-\\kappa x}$, so $A=-F$.\nWe enforce continuity at $x=a$:\n\\begin{align*}\nB \\sin(ka) &= F e^{-\\kappa a} \\quad &(3) \\\\\nk B \\cos(ka) &= -\\kappa F e^{-\\kappa a} \\quad &(4)\n\\end{align*}\nDividing equation $(4)$ by equation $(3)$ yields:\n$$\n\\frac{k B \\cos(ka)}{B \\sin(ka)} = \\frac{-\\kappa F e^{-\\kappa a}}{F e^{-\\kappa a}} \\implies k \\cot(ka) = -\\kappa\n$$\nThis is the transcendental equation for odd-parity bound states.\n\nTo express these in dimensionless form, we use the variables $z = ka$ and $p = \\kappa a$. The equations become:\nEven: $z \\tan(z) = p$\nOdd: $z \\cot(z) = -p$\nWe establish a constraint between $z$ and $p$. From their definitions:\n$z^2 = \\frac{2ma^2(E+V_0)}{\\hbar^2}$ and $p^2 = -\\frac{2ma^2E}{\\hbar^2}$.\nAdding these two gives:\n$z^2 + p^2 = \\frac{2ma^2V_0}{\\hbar^2}$.\nWe define the dimensionless well strength $z_0 = a\\sqrt{2mV_0}/\\hbar$, so $z^2+p^2=z_0^2$.\nSince $p>0$ (for a bound state $E<0$), we have $p = \\sqrt{z_0^2 - z^2}$. The dimensionless transcendental equations are:\nEven states: $\\tan(z) = \\frac{\\sqrt{z_0^2 - z^2}}{z}$\nOdd states: $\\cot(z) = -\\frac{\\sqrt{z_0^2 - z^2}}{z}$\nThe solutions correspond to the intersections of the functions of $z$ on the left-hand side with the function $\\sqrt{z_0^2 - z^2}/z$ on the right-hand side, for $0 < z < z_0$. Graphically, in the $(z,p)$ plane, we seek intersections of the circle $z^2+p^2=z_0^2$ (in the first quadrant) with the curves $p=z\\tan(z)$ and $p=-z\\cot(z)$.\nThe condition for the existence of the $n$-th bound state (ordered by energy, starting with $n=1$ for the ground state) is $z_0 > (n-1)\\frac{\\pi}{2}$. The $n$-th state is even if $n$ is odd, and odd if $n$ is even. The total number of bound states $N$ for a given $z_0$ is the number of integers $n \\geq 1$ satisfying this condition. This is equivalent to $N = 1 + \\lfloor \\frac{2z_0}{\\pi} \\rfloor$.\n\nNow we evaluate this for the given system.\nThe parameters are:\n$a = 0.50\\,\\mathrm{nm} = 0.50 \\times 10^{-9}\\,\\mathrm{m}$\n$V_0 = 3.00\\,\\mathrm{eV} = 3.00 \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J}) = 4.806529902 \\times 10^{-19}\\,\\mathrm{J}$\n$m = m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$\n$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$\nWe calculate $z_0$:\n$$\nz_0 = a \\frac{\\sqrt{2 m V_{0}}}{\\hbar}\n$$\nFirst, let's compute $z_0^2$:\n$$\nz_0^2 = \\frac{2 m a^2 V_0}{\\hbar^2} = \\frac{2 \\times (9.1093837015 \\times 10^{-31}) \\times (0.50 \\times 10^{-9})^2 \\times (4.806529902 \\times 10^{-19})}{(1.054571817 \\times 10^{-34})^2} \\approx 19.677\n$$\nTaking the square root to find $z_0$:\n$$\nz_0 = \\sqrt{19.677} \\approx 4.4359\n$$\nNow we apply the counting rule:\nThe number of states is the number of solutions, which occur in intervals of $\\pi/2$. The number of bound states is $N = 1 + \\lfloor z_0 / (\\pi/2) \\rfloor = 1 + \\lfloor 4.4359 / 1.5708 \\rfloor = 1 + \\lfloor 2.824 \\rfloor = 1 + 2 = 3$.\nThus, there are a total of $3$ bound states. The first and third (in energy) are even, and the second is odd.",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "While stationary states describe the allowed energy levels, real quantum phenomena involve dynamics—the evolution of wave packets in time. This practice shifts our focus to the time-dependent Schrödinger equation (TDSE) and its numerical solution, a cornerstone of modern device simulation. You will implement the robust Crank-Nicolson method, learning firsthand how to construct a stable, norm-conserving simulation that correctly models quantum evolution in complex heterostructures .",
            "id": "3781651",
            "problem": "Consider the one-dimensional time-dependent Schrödinger equation (TDSE) for a charge carrier in a semiconductor under the Effective Mass Approximation (EMA): $$i \\hbar \\frac{\\partial}{\\partial t} \\psi(x,t) = \\hat{H}\\,\\psi(x,t),$$ where the effective-mass Hamiltonian is $$\\hat{H} = -\\frac{\\hbar^2}{2}\\,\\frac{d}{dx}\\left(\\frac{1}{m^*(x)}\\frac{d}{dx}\\right) + V(x),$$ $m^*(x)$ is the position-dependent effective mass, $V(x)$ is the potential energy, and $\\hbar$ is the reduced Planck constant. Assume Dirichlet boundary conditions $ \\psi(0,t)=\\psi(L,t)=0 $ for a finite domain $ x \\in [0,L] $, and a uniform grid of $N$ points with spacing $ \\Delta x = L/(N-1) $. The goal is to implement an unconditionally stable, norm-conserving time integrator based on the implicit midpoint method (Crank–Nicolson), and to verify stability and norm conservation numerically using the EMA Hamiltonian discretized in a flux-conserving symmetric form.\n\nStarting from the TDSE and the flux form of the kinetic operator, derive a consistent discrete Hamiltonian matrix $H$ acting on the interior degrees of freedom corresponding to grid indices $i=1,\\dots,N-2$. Use the symmetric finite-difference form with half-point effective masses to ensure a Hermitian discretization: define half-point masses by a harmonic mean $$m^*_{i+\\frac{1}{2}} = \\frac{2 m^*_i m^*_{i+1}}{m^*_i + m^*_{i+1}},$$ and discretize the kinetic operator using $$-\\frac{\\hbar^2}{2}\\left[\\frac{1}{m^*_{i+\\frac{1}{2}}}\\frac{\\psi_{i+1}-\\psi_i}{\\Delta x^2} - \\frac{1}{m^*_{i-\\frac{1}{2}}}\\frac{\\psi_i-\\psi_{i-1}}{\\Delta x^2}\\right],$$ so that the resulting Hamiltonian is tridiagonal, real-symmetric, and thus Hermitian. The potential energy term contributes diagonally as $V_i \\psi_i$.\n\nImplement the implicit midpoint (Crank–Nicolson) scheme for the TDSE using this discrete Hamiltonian such that the update operator is unitary when the Hamiltonian is Hermitian. Use Physical constants in International System of Units (SI): $ \\hbar $ in joule-second (J·s), electron rest mass $ m_e $ in kilograms (kg), and potential energy in joules (J). Lengths must be in meters (m), time in seconds (s). The Dirichlet boundary conditions must be enforced at the endpoints. Normalize the initial state so that its discrete $L^2$ norm equals $1$ with respect to the Riemann sum, i.e., $$\\sum_{i=1}^{N-2} |\\psi_i|^2 \\Delta x = 1.$$\n\nYour program must:\n- Assemble the discrete EMA Hamiltonian $H$ as described.\n- Construct the Crank–Nicolson update using the Hamiltonian.\n- Propagate the wavefunction for a specified number of steps, recording the discrete $L^2$ norm at every step.\n- Compute the maximal relative deviation of the norm from unity over the propagation.\n- For a separate small-grid test, construct the one-step amplification matrix and compute all its eigenvalues to estimate the spectral radius and its deviation from one.\n\nUse the following three test cases (all constants and parameters in SI units):\n\n1. Uniform effective mass and zero potential (happy path):\n   - Domain length $L = 10 \\times 10^{-9}$.\n   - Grid points $N = 401$.\n   - Effective mass $m^*(x) = 0.067\\,m_e$ for all $x$.\n   - Potential $V(x) = 0$ for all $x$.\n   - Time step $\\Delta t = 5 \\times 10^{-18}$.\n   - Number of time steps: $300$.\n   - Initial state: a Gaussian wave packet $$\\psi(x,0) = \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right) \\exp(i k_0 x)$$ with $x_0 = L/3$, $\\sigma = 0.8 \\times 10^{-9}$, $k_0 = 4.0 \\times 10^{10}$. Enforce Dirichlet boundary conditions and renormalize to unit discrete norm.\n\n   Output for this case: the maximal relative deviation of the norm from unity over the 300 steps, reported as a float (dimensionless).\n\n2. Heterostructure with mass and potential step (large time step stress test):\n   - Domain length $L = 10 \\times 10^{-9}$.\n   - Grid points $N = 401$.\n   - Effective mass $m^*(x) = 0.067\\,m_e$ for $x < L/2$ and $m^*(x) = 0.19\\,m_e$ for $x \\ge L/2$.\n   - Potential $V(x) = 0$ for $x < L/2$ and $V(x) = 0.3\\,\\text{eV}$ for $x \\ge L/2$ (convert electronvolts to joules).\n   - Time step $\\Delta t = 5 \\times 10^{-16}$.\n   - Number of time steps: $100$.\n   - Initial state: a Gaussian wave packet as above with $x_0 = L/4$, $\\sigma = 0.8 \\times 10^{-9}$, $k_0 = 2.0 \\times 10^{10}$. Enforce Dirichlet boundary conditions and renormalize to unit discrete norm.\n\n   Output for this case: the maximal relative deviation of the norm from unity over the 100 steps, reported as a float (dimensionless).\n\n3. Spectral radius of the amplification operator (stability check on a small grid):\n   - Domain length $L = 10 \\times 10^{-9}$.\n   - Grid points $N = 81$.\n   - Effective mass $m^*(x) = 0.067\\,m_e$ for all $x$.\n   - Potential $V(x) = 0$ for all $x$.\n   - Time step $\\Delta t = 1.0 \\times 10^{-14}$.\n   - Assemble the Crank–Nicolson one-step amplification matrix on the interior grid and compute all eigenvalues.\n\n   Output for this case: the maximal absolute deviation of the modulus of the eigenvalues from $1$ (i.e., $$\\max_j \\left|\\,|\\lambda_j| - 1\\,\\right|$$), reported as a float (dimensionless).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the three test cases: $$[\\text{deviation\\_case1},\\text{deviation\\_case2},\\text{spectral\\_radius\\_deviation\\_case3}].$$\n- No units are required in the output because all three quantities are dimensionless floats.\n\nEnsure scientific realism by adhering strictly to the EMA Hamiltonian definition and Dirichlet boundary conditions, constructing a Hermitian discrete Hamiltonian, and using a norm-preserving implicit midpoint time integrator. Do not provide shortcut formulas; the derivation and implementation must follow from the fundamental TDSE and the stated discretization principles.",
            "solution": "The problem is assessed to be **valid**. It is scientifically grounded in the principles of quantum mechanics, specifically the time-dependent Schrödinger equation within the effective mass approximation, a standard framework in semiconductor physics. The problem is well-posed, providing all necessary physical parameters, mathematical formulations, and discretization schemes (Hermitian finite-difference and unitary Crank-Nicolson) required for a unique and stable numerical solution. The tasks are clearly defined, objective, and serve as a rigorous verification of the implemented numerical method's fundamental properties, namely norm conservation and unconditional stability.\n\n### Theoretical Formulation\n\n#### 1. Discrete Effective Mass Hamiltonian\nThe one-dimensional time-dependent Schrödinger equation (TDSE) under the effective mass approximation is given by:\n$$i \\hbar \\frac{\\partial}{\\partial t} \\psi(x,t) = \\hat{H}\\,\\psi(x,t)$$\nwhere the Hamiltonian is $\\hat{H} = \\hat{T} + \\hat{V}$, with the kinetic energy operator $\\hat{T} = -\\frac{\\hbar^2}{2}\\,\\frac{d}{dx}\\left(\\frac{1}{m^*(x)}\\frac{d}{dx}\\right)$ and potential energy operator $\\hat{V} = V(x)$. This form of the kinetic operator is essential for describing systems with spatially varying effective mass $m^*(x)$, such as semiconductor heterostructures.\n\nTo solve this equation numerically, we discretize the spatial domain $x \\in [0,L]$ into $N$ points $x_i = i \\Delta x$ for $i=0, \\dots, N-1$, with grid spacing $\\Delta x = L/(N-1)$. The wavefunction is represented by its values on these grid points, $\\psi_i(t) \\approx \\psi(x_i, t)$. The Dirichlet boundary conditions impose $\\psi_0(t) = \\psi_{N-1}(t) = 0$. The state of the system is described by the vector of interior points $\\vec{\\psi}(t) = [\\psi_1(t), \\dots, \\psi_{N-2}(t)]^T$, which has dimension $M=N-2$.\n\nThe potential energy term is local and its discretization is straightforward: $(V\\psi)_i = V(x_i)\\psi_i = V_i \\psi_i$. This contributes a diagonal matrix to the discrete Hamiltonian.\n\nThe kinetic operator is discretized using a symmetric finite-difference scheme that conserves particle flux. The operator $\\hat{T}$ can be seen as the divergence of a flux, $\\hat{T}\\psi = -\\frac{d}{dx}j(x)$, where $j(x) = -\\frac{\\hbar^2}{2m^*(x)}\\frac{d\\psi}{dx}$. We discretize the divergence at grid point $x_i$ using a central difference on fluxes evaluated at half-points:\n$$(T\\psi)_i \\approx -\\frac{j_{i+1/2} - j_{i-1/2}}{\\Delta x}$$\nThe fluxes are themselves discretized using central differences:\n$$j_{i+1/2} \\approx -\\frac{\\hbar^2}{2m^*_{i+1/2}} \\frac{\\psi_{i+1} - \\psi_i}{\\Delta x}$$\n$$j_{i-1/2} \\approx -\\frac{\\hbar^2}{2m^*_{i-1/2}} \\frac{\\psi_i - \\psi_{i-1}}{\\Delta x}$$\nwhere the effective mass at half-points, $m^*_{i+1/2}$, is defined by the harmonic mean to ensure flux continuity: $m^*_{i+1/2} = \\frac{2 m^*_i m^*_{i+1}}{m^*_i + m^*_{i+1}}$.\n\nCombining these expressions yields the discrete kinetic operator action on $\\psi_i$:\n$$(T\\psi)_i = -\\frac{\\hbar^2}{2\\Delta x^2} \\left[ \\frac{1}{m^*_{i+1/2}}(\\psi_{i+1}-\\psi_i) - \\frac{1}{m^*_{i-1/2}}(\\psi_i-\\psi_{i-1}) \\right]$$\nThis discretization results in a real, symmetric (Hermitian) tridiagonal matrix representation of the Hamiltonian $H$ for the interior grid points.\n\n#### 2. Crank–Nicolson Time Integration\nThe semi-discretized TDSE is a system of linear ordinary differential equations:\n$$\\frac{d\\vec{\\psi}}{dt} = -\\frac{i}{\\hbar}H\\vec{\\psi}$$\nWe integrate this system in time using the implicit midpoint method (Crank–Nicolson), which is second-order accurate and unconditionally stable for Hermitian Hamiltonians. Applying the trapezoidal rule for the time interval $[t_n, t_{n+1}]$:\n$$\\vec{\\psi}^{n+1} = \\vec{\\psi}^n + \\frac{\\Delta t}{2} \\left[ \\left(-\\frac{i}{\\hbar}H\\vec{\\psi}^n\\right) + \\left(-\\frac{i}{\\hbar}H\\vec{\\psi}^{n+1}\\right) \\right]$$\nRearranging to solve for the future state $\\vec{\\psi}^{n+1}$:\n$$\\left(I + \\frac{i\\Delta t}{2\\hbar} H\\right) \\vec{\\psi}^{n+1} = \\left(I - \\frac{i\\Delta t}{2\\hbar} H\\right) \\vec{\\psi}^n$$\nThis is a linear system of the form $A\\vec{\\psi}^{n+1} = B\\vec{\\psi}^n$, where $A = I + \\frac{i\\Delta t}{2\\hbar}H$ and $B = I - \\frac{i\\Delta t}{2\\hbar}H$. Since $H$ is tridiagonal, $A$ and $B$ are also tridiagonal, allowing for efficient solution using a tridiagonal matrix algorithm.\n\nThe one-step amplification matrix is $U = A^{-1}B$. Because $H$ is Hermitian, the operator $U$ is unitary, meaning it preserves the vector norm: $\\|\\vec{\\psi}^{n+1}\\|_2 = \\|U\\vec{\\psi}^n\\|_2 = \\|\\vec{\\psi}^n\\|_2$. This implies that the discrete $L^2$ norm, defined as $\\sqrt{\\sum_{i=1}^{N-2}|\\psi_i|^2 \\Delta x}$, is conserved throughout the simulation.\n\n#### Implementation\nThe following Python code implements the described numerical model to solve the problem and produce the required outputs.\n```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve_problem_2():\n    \"\"\"\n    Solves the 1D Time-Dependent Schrödinger Equation using the Crank-Nicolson\n    method for cases specified in the problem statement.\n    \"\"\"\n    # Physical constants in SI units\n    HBAR = 1.054571817e-34  # J·s\n    M_E = 9.1093837015e-31   # kg\n    E_CHARGE = 1.602176634e-19 # C (for eV to J conversion)\n\n    # --- Test Case 1: Uniform medium ---\n    def run_case_1():\n        L = 10e-9\n        N = 401\n        m_eff_val = 0.067 * M_E\n        V_val = 0.0\n        dt = 5e-18\n        num_steps = 300\n        x0 = L / 3.0\n        sigma = 0.8e-9\n        k0 = 4.0e10\n        \n        dx = L / (N - 1)\n        x = np.linspace(0, L, N)\n        M = N - 2\n        \n        # Define potential and effective mass profiles\n        m_star = np.full(N, m_eff_val)\n        V = np.full(N, V_val)\n        \n        # --- Hamiltonian Assembly ---\n        m_half = 2 * m_star[:-1] * m_star[1:] / (m_star[:-1] + m_star[1:])\n        \n        c = -HBAR**2 / (2 * dx**2)\n        \n        main_diag_T = -c * (1/m_half[1:] + 1/m_half[:-1])\n        off_diag_T = c / m_half[1:-1]\n        \n        H_main = main_diag_T + V[1:-1]\n        H_off = off_diag_T\n        \n        # --- Crank-Nicolson Matrices ---\n        alpha = dt / (2 * HBAR)\n        \n        A_main = 1 + 1j * alpha * H_main\n        A_off = 1j * alpha * H_off\n        \n        B_main = 1 - 1j * alpha * H_main\n        B_off = -1j * alpha * H_off\n\n        # For scipy.linalg.solve_banded\n        A_banded = np.zeros((3, M), dtype=np.complex128)\n        A_banded[0, 1:] = A_off\n        A_banded[1, :] = A_main\n        A_banded[2, :-1] = A_off\n\n        # --- Initial State ---\n        psi = np.exp(-(x - x0)**2 / (2 * sigma**2)) * np.exp(1j * k0 * x)\n        psi[0] = psi[-1] = 0.0 # Enforce Dirichlet boundary conditions\n        \n        psi_interior = psi[1:-1].astype(np.complex128)\n        norm_sq = np.sum(np.abs(psi_interior)**2) * dx\n        psi_interior /= np.sqrt(norm_sq) # Normalize to 1\n\n        # --- Time Evolution ---\n        norm_deviations = []\n        for _ in range(num_steps):\n            # Compute RHS vector: b = B @ psi\n            b = np.empty_like(psi_interior)\n            b[0] = B_main[0] * psi_interior[0] + B_off[0] * psi_interior[1]\n            b[-1] = B_main[-1] * psi_interior[-1] + B_off[-1] * psi_interior[-2]\n            b[1:-1] = B_off[:-1] * psi_interior[:-2] + B_main[1:-1] * psi_interior[1:-1] + B_off[1:] * psi_interior[2:]\n\n            psi_interior = linalg.solve_banded((1, 1), A_banded, b, check_finite=False)\n            \n            norm = np.sqrt(np.sum(np.abs(psi_interior)**2) * dx)\n            norm_deviations.append(np.abs(norm - 1.0))\n            \n        return max(norm_deviations)\n\n    # --- Test Case 2: Heterostructure ---\n    def run_case_2():\n        L = 10e-9\n        N = 401\n        dt = 5e-16\n        num_steps = 100\n        x0 = L / 4.0\n        sigma = 0.8e-9\n        k0 = 2.0e10\n        \n        dx = L / (N - 1)\n        x = np.linspace(0, L, N)\n        M = N - 2\n        \n        # Define potential and effective mass profiles\n        m_star = np.full(N, 0.067 * M_E)\n        V = np.full(N, 0.0)\n        \n        mid_idx = (N - 1) // 2\n        m_star[mid_idx:] = 0.19 * M_E\n        V[mid_idx:] = 0.3 * E_CHARGE\n        \n        # --- Hamiltonian Assembly ---\n        m_half = 2 * m_star[:-1] * m_star[1:] / (m_star[:-1] + m_star[1:])\n        \n        c = -HBAR**2 / (2 * dx**2)\n        \n        main_diag_T = -c * (1/m_half[1:] + 1/m_half[:-1])\n        off_diag_T = c / m_half[1:-1]\n        \n        H_main = main_diag_T + V[1:-1]\n        H_off = off_diag_T\n        \n        # --- Crank-Nicolson Matrices ---\n        alpha = dt / (2 * HBAR)\n        \n        A_main = 1 + 1j * alpha * H_main\n        A_off = 1j * alpha * H_off\n        \n        B_main = 1 - 1j * alpha * H_main\n        B_off = -1j * alpha * H_off\n\n        A_banded = np.zeros((3, M), dtype=np.complex128)\n        A_banded[0, 1:] = A_off\n        A_banded[1, :] = A_main\n        A_banded[2, :-1] = A_off\n\n        # --- Initial State ---\n        psi = np.exp(-(x - x0)**2 / (2 * sigma**2)) * np.exp(1j * k0 * x)\n        psi[0] = psi[-1] = 0.0\n        \n        psi_interior = psi[1:-1].astype(np.complex128)\n        norm_sq = np.sum(np.abs(psi_interior)**2) * dx\n        psi_interior /= np.sqrt(norm_sq)\n\n        # --- Time Evolution ---\n        norm_deviations = []\n        for _ in range(num_steps):\n            b = np.empty_like(psi_interior)\n            b[0] = B_main[0] * psi_interior[0] + B_off[0] * psi_interior[1]\n            b[-1] = B_main[-1] * psi_interior[-1] + B_off[-1] * psi_interior[-2]\n            b[1:-1] = B_off[:-1] * psi_interior[:-2] + B_main[1:-1] * psi_interior[1:-1] + B_off[1:] * psi_interior[2:]\n\n            psi_interior = linalg.solve_banded((1, 1), A_banded, b, check_finite=False)\n            \n            norm = np.sqrt(np.sum(np.abs(psi_interior)**2) * dx)\n            norm_deviations.append(np.abs(norm - 1.0))\n            \n        return max(norm_deviations)\n\n    # --- Test Case 3: Spectral Radius ---\n    def run_case_3():\n        L = 10e-9\n        N = 81\n        m_eff_val = 0.067 * M_E\n        V_val = 0.0\n        dt = 1.0e-14\n        \n        dx = L / (N - 1)\n        M = N - 2\n        \n        m_star = np.full(N, m_eff_val)\n        V = np.full(N, V_val)\n        \n        # --- Hamiltonian Assembly (Dense for eigenvalue problem) ---\n        m_half = 2 * m_star[:-1] * m_star[1:] / (m_star[:-1] + m_star[1:])\n        \n        c = HBAR**2 / (2 * dx**2)\n        \n        H = np.zeros((M, M), dtype=np.float64)\n        \n        main_diag_T_terms = c * (1/m_half[1:] + 1/m_half[:-1])\n        off_diag_T_terms = -c / m_half[1:-1]\n\n        np.fill_diagonal(H, main_diag_T_terms + V[1:-1])\n        np.fill_diagonal(H[1:, :], off_diag_T_terms)\n        np.fill_diagonal(H[:, 1:], off_diag_T_terms)\n        \n        # --- Construct A and B matrices ---\n        alpha = dt / (2 * HBAR)\n        I = np.eye(M, dtype=np.complex128)\n        \n        A = I + 1j * alpha * H\n        B = I - 1j * alpha * H\n        \n        # --- Solve Generalized Eigenvalue Problem ---\n        # Solves Bv = lambda * Av for eigenvalues lambda of U = A^-1 B\n        eigenvalues, _ = linalg.eig(B, A, right=True)\n        \n        # --- Calculate maximal deviation from unity ---\n        spectral_radii = np.abs(eigenvalues)\n        deviation = np.max(np.abs(spectral_radii - 1.0))\n        \n        return deviation\n\n    return [run_case_1(), run_case_2(), run_case_3()]\n```",
            "answer": "[2.220446049250313e-16,4.440892098500626e-16,8.881784197001252e-16]"
        },
        {
            "introduction": "To model realistic semiconductor devices, we must account for their connection to external circuits, which act as particle reservoirs. This requires moving beyond simple closed-system models to open quantum systems. In this advanced exercise, you will implement the Quantum Transmitting Boundary Method (QTBM) to solve the time-independent Schrödinger equation for a device connected to semi-infinite leads, enabling the accurate calculation of quantum transport properties like steady-state current .",
            "id": "3781625",
            "problem": "Consider a one-dimensional effective-mass electron model for a semiconductor device connected to two semi-infinite leads. The device region occupies a finite interval along the position coordinate $x$, discretized uniformly with spacing $a$ and $N$ grid points indexed by $i = 0, 1, \\dots, N-1$. The left and right leads are semi-infinite and are characterized by constant potentials $V_{\\mathrm{L}}$ and $V_{\\mathrm{R}}$, respectively. Electrons have effective mass $m^{\\ast}$ throughout. Assume coherent, elastic transport and stationary scattering states.\n\nStarting from first principles, use the time-independent Schrödinger equation for a single band with effective mass,\n$$\n-\\frac{\\hbar^2}{2 m^{\\ast}} \\frac{d^2 \\psi(x)}{dx^2} + V(x) \\psi(x) = E \\psi(x),\n$$\nand construct its central-difference finite-difference discretization on the uniform grid:\n$$\n- t \\, \\psi_{i-1} + \\left( 2 t + V_i - E \\right) \\psi_i - t \\, \\psi_{i+1} = 0,\n$$\nfor $i = 1, \\dots, N-2$, where $t = \\frac{\\hbar^2}{2 m^{\\ast} a^2}$ and $V_i$ is the potential at grid point $i$. At the device edges $i=0$ and $i=N-1$, enforce open-lead boundary conditions by eliminating the semi-infinite leads using the Quantum Transmitting Boundary Method (QTBM). To do this, derive and apply complex-valued boundary conditions that are consistent with a semi-infinite, uniform leads and an incident plane wave of unit amplitude from the left lead. Your construction must ensure:\n- The open boundary conditions for both leads are represented by energy-dependent, complex-valued quantities that couple to the edge grid points, consistent with a semi-infinite uniform chain discretization.\n- The injected field from the left lead corresponds to a unit-amplitude incident plane wave with wave number determined by the left lead dispersion and energy $E$.\n- The resulting finite system is linear and solvable to obtain $\\psi_i$ for $i = 0, \\dots, N-1$ at a given energy $E$.\n\nFrom the stationary solution $\\psi$, verify current conservation across the device by computing the probability current at the left and right ends using a discrete current formula derived from the probability continuity equation. Express the probability currents at the left and right edges as functions of the solution and model parameters, and verify that they are equal in steady state within a specified tolerance.\n\nYour program must implement the above model and boundary conditions and then evaluate the following test suite. All physical quantities must be handled internally in International System of Units (SI), but the test suite below specifies potentials and energies in electron volts and lengths in nanometers for convenience. You must convert these to SI units inside the program. Angles such as the Bloch wave number $k$ are to be treated in radians. The output of the program should be a single line containing a list of booleans, one per test case, where each boolean indicates whether the absolute difference between the left and right currents is less than a relative tolerance of $10^{-6}$ times the magnitude of the incoming current from the left lead. If the incoming current is numerically negligible, use an absolute tolerance of $10^{-30}$ in SI units.\n\nTest suite specification:\n- Use a uniform grid with spacing $a = 0.1$ nm and $N = 201$ points for all cases (total device length $L = 20$ nm).\n- Effective mass $m^{\\ast} = 0.067 \\, m_0$, where $m_0$ is the electron rest mass.\n- In all cases, the left lead potential is $V_{\\mathrm{L}} = 0.0$ eV.\n- Case 1 (square barrier, sub-barrier tunneling):\n    - Right lead potential $V_{\\mathrm{R}} = 0.0$ eV.\n    - Device potential: $V(x) = 0.2$ eV for $x \\in [8 \\text{ nm}, 12 \\text{ nm}]$, and $V(x) = 0$ eV elsewhere.\n    - Energy $E = 0.15$ eV.\n- Case 2 (square barrier, above-barrier transmission):\n    - Right lead potential $V_{\\mathrm{R}} = 0.0$ eV.\n    - Device potential: $V(x) = 0.2$ eV for $x \\in [8 \\text{ nm}, 12 \\text{ nm}]$, and $V(x) = 0$ eV elsewhere.\n    - Energy $E = 0.20$ eV.\n- Case 3 (asymmetric leads, step potential on right):\n    - Right lead potential $V_{\\mathrm{R}} = 0.05$ eV.\n    - Device potential: $V(x) = 0.2$ eV for $x \\in [8 \\text{ nm}, 12 \\text{ nm}]$, and $V(x) = 0$ eV elsewhere.\n    - Energy $E = 0.18$ eV.\n- Case 4 (evanescent right lead, no device barrier):\n    - Right lead potential $V_{\\mathrm{R}} = 0.30$ eV.\n    - Device potential: $V(x) = 0$ eV everywhere in the device.\n    - Energy $E = 0.20$ eV.\n\nAll implementations must ensure scientific realism through correct unit conversions and that the open boundary conditions correctly capture propagating or evanescent modes as appropriate. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\").",
            "solution": "### Theoretical Formulation\n\nThe problem requires solving the 1D time-independent Schrödinger equation (TISE) on a finite device region connected to semi-infinite leads. This constitutes an open quantum system where particles can enter from and exit into the leads. The Quantum Transmitting Boundary Method (QTBM) provides a way to solve this by replacing the infinite leads with energy-dependent, complex-valued boundary conditions that perfectly absorb outgoing waves.\n\n#### 1. Discretized Schrödinger Equation\nThe TISE is:\n$$\n-\\frac{\\hbar^2}{2 m^{\\ast}} \\frac{d^2 \\psi(x)}{dx^2} + V(x) \\psi(x) = E \\psi(x)\n$$\nUsing a central-difference approximation for the second derivative on a uniform grid with spacing $a$, $\\frac{d^2\\psi}{dx^2} \\approx \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{a^2}$, the TISE becomes:\n$$\n-\\frac{\\hbar^2}{2 m^{\\ast} a^2}(\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}) + V_i \\psi_i = E \\psi_i\n$$\nDefining the hopping parameter $t = \\frac{\\hbar^2}{2 m^{\\ast} a^2}$, this can be rearranged into the tight-binding form:\n$$\n-t \\psi_{i-1} + (2t + V_i - E) \\psi_i - t \\psi_{i+1} = 0\n$$\nThis equation holds for all interior points of the device. We need to establish special equations for the boundary points $i=0$ and $i=N-1$.\n\n#### 2. Open Boundary Conditions\nConsider a semi-infinite lead (e.g., the left lead, for $i \\leq 0$) with a constant potential $V_\\mathrm{L}$. The TISE is $-t \\psi_{i-1} + (2t + V_\\mathrm{L} - E) \\psi_i - t \\psi_{i+1} = 0$. Solutions are plane waves of the form $\\psi_i = e^{ik(ia)}$. Substituting this ansatz yields the dispersion relation for the lead:\n$$\n-t e^{-ika} + (2t + V_\\mathrm{L} - E) - t e^{ika} = 0 \\implies E = V_\\mathrm{L} + 2t(1 - \\cos(ka))\n$$\nThe wave number $k$ for a given energy $E$ is found by inverting this: $ka = \\arccos\\left(1 - \\frac{E-V_\\mathrm{L}}{2t}\\right)$. For $E > V_\\mathrm{L}$, $k$ is real, corresponding to a propagating wave. For $E  V_\\mathrm{L}$, $k$ is complex, corresponding to an evanescent (decaying) wave. The `arccos` function with a complex argument correctly handles both cases.\n\nFor an outgoing wave leaving the device at the boundary $i=0$ and traveling into the left lead ($x \\to -\\infty$), the wavefunction must have the form $\\psi_i \\propto e^{-ika i}$. This implies the relationship $\\psi_{-1} = \\psi_0 e^{ika}$. We substitute this into the TISE at $i=0$:\n$$\n-t \\psi_{-1} + (2t + V_0 - E) \\psi_0 - t \\psi_{1} = S_0\n$$\nwhere $S_0$ is a source term for the incident wave. Substituting $\\psi_{-1} = \\psi_0 e^{ik_L a}$:\n$$\n-t e^{ik_L a} \\psi_0 + (2t + V_0 - E) \\psi_0 - t \\psi_1 = S_0\n$$\nThe term $-t e^{ik_L a}$ is the complex \"self-energy\" that represents the coupling to the left lead. A similar derivation for the right lead (where an outgoing wave has the form $\\psi_i \\propto e^{ik_R a i}$) gives $\\psi_N = \\psi_{N-1} e^{ik_R a}$, leading to the equation at $i=N-1$:\n$$\n-t \\psi_{N-2} + (2t + V_{N-1} - E) \\psi_{N-1} - t e^{ik_R a} \\psi_{N-1} = 0\n$$\n\n#### 3. Source Term and Linear System\nWe consider a plane wave of unit amplitude incident from the left lead: $\\psi_i^{\\text{inc}} = e^{ik_L (ia)}$. The source term represents the injection of this wave into the device. The full problem is a linear system of equations $A\\vec{\\psi} = \\vec{b}$, where $\\vec{\\psi} = [\\psi_0, \\dots, \\psi_{N-1}]^T$. The matrix $A$ is tridiagonal except for the complex corner terms from the self-energies. The source vector $\\vec{b}$ is zero everywhere except for the first element, $b_0 = -2jt \\sin(k_L a)$, which corresponds to a unit-amplitude incident wave.\n\n#### 4. Probability Current\nThe probability current conservation equation, when discretized, gives the current $J$ flowing from site $i$ to $i+1$:\n$$\nJ_{i, i+1} = \\frac{2a}{\\hbar} \\text{Im}[ \\psi_i^* (-t \\psi_{i+1}) ] = \\frac{2 t a}{\\hbar} \\text{Im}[ \\psi_{i+1} \\psi_i^* ]\n$$\nFor a steady-state coherent transport problem, the current must be conserved throughout the device. We can verify our solution by computing the current at the input (e.g., between sites 0 and 1) and output (e.g., between sites N-2 and N-1) and checking that they are equal. The incident current from a unit-amplitude plane wave is $J_{\\text{in}} = \\frac{\\hbar k_L}{m^*} = \\frac{2ta}{\\hbar} \\sin(\\text{Re}[k_L a])$.\n\n### Implementation\nThe following Python code implements the QTBM model to solve the problem and verify current conservation for the specified test cases.\n```python\nimport numpy as np\n\ndef solve_problem_3():\n    \"\"\"\n    Solves the 1D time-independent Schrödinger equation for a semiconductor\n    device with open boundaries and verifies current conservation.\n    \"\"\"\n    # Physical constants in SI units\n    HBAR = 1.054571817e-34  # J*s\n    M0 = 9.1093837015e-31   # kg\n    E_CHARGE = 1.602176634e-19 # C\n\n    # --- Test suite specification ---\n    # Common parameters\n    a_nm = 0.1\n    N = 201\n    m_eff_factor = 0.067\n    V_L_ev = 0.0\n\n    # Test cases: (V_R_ev, V_dev_spec (V_barrier_ev, x_start_nm, x_end_nm), E_ev)\n    test_cases = [\n        (0.0, (0.2, 8.0, 12.0), 0.15),  # Case 1\n        (0.0, (0.2, 8.0, 12.0), 0.20),  # Case 2\n        (0.05, (0.2, 8.0, 12.0), 0.18), # Case 3\n        (0.30, (0.0, 0.0, 0.0), 0.20),  # Case 4\n    ]\n\n    results = []\n\n    for V_R_ev, v_dev_spec, E_ev in test_cases:\n        # --- Unit Conversions and Parameter Setup ---\n        a = a_nm * 1e-9  # Grid spacing in meters\n        x_coords = np.arange(N) * a\n        m_star = m_eff_factor * M0\n        \n        # Convert energies from eV to Joules\n        E = E_ev * E_CHARGE\n        V_L = V_L_ev * E_CHARGE\n        V_R = V_R_ev * E_CHARGE\n\n        # Hopping parameter (energy unit)\n        t = (HBAR**2) / (2 * m_star * a**2)\n\n        # --- Construct Device Potential Profile V_i ---\n        V_barrier_ev, x_start_nm, x_end_nm = v_dev_spec\n        V_barrier = V_barrier_ev * E_CHARGE\n        \n        V_device = np.full(N, V_L, dtype=float)\n        # Apply barrier if its height is non-zero\n        if V_barrier != 0.0:\n            barrier_start_idx = int(round(x_start_nm / a_nm))\n            barrier_end_idx = int(round(x_end_nm / a_nm))\n            # Potential V_i at grid point i\n            # For i in [start, end], the potential is applied\n            V_device[barrier_start_idx:barrier_end_idx+1] = V_barrier\n        \n        # The potential at the end points must match the leads\n        V_device[0] = V_L\n        V_device[N-1] = V_R\n\n        # --- Boundary Conditions: Wave Vectors in Leads ---\n        def get_lead_k_vector_a(energy, potential, t_param, is_right_lead):\n            arg = 1 - (energy - potential) / (2 * t_param)\n            \n            # Use complex arccos to handle both propagating and evanescent modes\n            ka_complex = np.arccos(complex(arg, 0))\n            \n            # For outgoing waves, Im(k) must lead to decay away from device.\n            # Right lead (x - +inf): need Im(k)  0\n            # Left lead (x - -inf, reflected wave ~e^{-ikx}): also need Im(k)  0\n            # The numpy arccos branch cut choice gives Im(ka) = 0.\n            # So, we flip the sign of the imaginary part if it's negative.\n            if ka_complex.imag  0:\n                ka_complex = -ka_complex\n\n            return ka_complex\n\n        kLa = get_lead_k_vector_a(E, V_L, t, is_right_lead=False)\n        kRa = get_lead_k_vector_a(E, V_R, t, is_right_lead=True)\n        \n        # --- Build and Solve the Linear System A*psi = b ---\n        # The equation is: -t*psi_{i-1} + (2t+V_i-E)*psi_i - t*psi_{i+1} = 0\n        A = np.zeros((N, N), dtype=complex)\n        \n        # Main diagonal\n        diag_terms = 2 * t + V_device - E\n        np.fill_diagonal(A, diag_terms)\n        \n        # Off-diagonals\n        off_diag_val = -t\n        np.fill_diagonal(A[1:], off_diag_val)\n        np.fill_diagonal(A[:, 1:], off_diag_val)\n\n        # Open Boundary Conditions (QTBM)\n        exp_ikLa = np.exp(1j * kLa)\n        exp_ikRa = np.exp(1j * kRa)\n\n        # Left boundary (i=0) modification\n        A[0, 0] -= t * exp_ikLa\n        \n        # Right boundary (i=N-1) modification\n        A[N-1, N-1] -= t * exp_ikRa\n\n        # Source term for unit amplitude wave from left\n        b = np.zeros(N, dtype=complex)\n        b[0] = -2j * t * np.sin(kLa)\n\n        # Solve for the wavefunction psi\n        psi = np.linalg.solve(A, b)\n\n        # --- Current Conservation Verification ---\n        # Discrete probability current J_{i, i+1}\n        current_factor = (2 * t * a) / HBAR\n        \n        # Current at the left end of the device\n        J_L_calc = current_factor * np.imag(np.conj(psi[0]) * psi[1])\n        \n        # Current at the right end of the device\n        J_R_calc = current_factor * np.imag(np.conj(psi[N - 2]) * psi[N - 1])\n        \n        # Incident current from the left lead\n        J_in = current_factor * np.sin(np.real(kLa)) # kLa is real for propagating incident wave\n        \n        # Tolerance check\n        abs_tol = 1e-30\n        rel_tol = 1e-6 * np.abs(J_in)\n        \n        tolerance = max(abs_tol, rel_tol)\n        is_conserved = np.abs(J_L_calc - J_R_calc)  tolerance\n        results.append(is_conserved)\n\n    return results\n```",
            "answer": "[True,True,True,True]"
        }
    ]
}