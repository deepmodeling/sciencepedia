{
    "hands_on_practices": [
        {
            "introduction": "无限深方势阱是半导体器件（如量子阱和FinFET）中量子限制效应的一个基石模型。本练习旨在通过从头求解薛定谔方程，巩固对波函数、本征值和关键物理量（如能量、位置和动量）期望值计算的基本理解。这是掌握量子力学应用于器件物理的核心分析技能的第一步 。",
            "id": "3788149",
            "problem": "一个导带电子在由半导体异质结形成的宽度为 $L$ 的方形量子阱中沿 $x$ 方向受到限制，在 $x=0$ 和 $x=L$ 处有无限高势垒。在包络函数近似 (EFA) 和有效质量近似 (EMA) 的框架内，假设阱内区域的导带有效质量 $m^{\\star}$ 是一个常数。包络函数 $\\psi(x)$ 的不含时薛定谔方程为\n$$-\\frac{\\hbar^{2}}{2 m^{\\star}} \\frac{d^{2}\\psi(x)}{dx^{2}} + V(x)\\,\\psi(x) = E\\,\\psi(x),$$\n其中势 $V(x)$ 的表达式为：当 $0<x<L$ 时 $V(x)=0$，其他情况下 $V(x)=\\infty$。\n\n(a) 求解该系统的归一化本征函数 $\\psi_n(x)$ 和相应的本征能量 $E_n$。\n(b) 对于任意量子数为 $n$ 的定态 $\\psi_n(x)$，计算以下物理量的期望值：\n    1. 能量 $\\langle \\hat{H} \\rangle$\n    2. 位置 $\\langle x \\rangle$（使用对称性论证）\n    3. 动量 $\\langle p \\rangle$\n\n将三个期望值按该顺序列出，作为一个 $1 \\times 3$ 的矩阵。",
            "solution": "该问题是有效的，因为它代表了量子力学中一个标准的、适定的问题——无限深方势阱中的粒子——这是半导体物理学中用于量子限制系统的基石模型。所有参数都定义清晰，前提条件在科学上是合理的。\n\n解答过程主要分为两个部分：首先，推导本征函数和本征能量；其次，计算所需的期望值。\n\n**第一部分：本征函数和本征能量**\n\n电子包络函数 $\\psi(x)$ 的不含时薛定谔方程如下：\n$$-\\frac{\\hbar^{2}}{2 m^{\\star}} \\frac{d^{2}\\psi(x)}{dx^{2}} + V(x)\\,\\psi(x) = E\\,\\psi(x)$$\n在量子阱内部，对于 $0 < x < L$，势 $V(x)=0$。方程简化为：\n$$-\\frac{\\hbar^{2}}{2 m^{\\star}} \\frac{d^{2}\\psi(x)}{dx^{2}} = E\\,\\psi(x)$$\n这是一个标准的二阶线性常微分方程。\n$$\\frac{d^{2}\\psi(x)}{dx^{2}} + k^{2}\\psi(x) = 0$$\n这里我们定义了 $k^{2} = \\frac{2 m^{\\star} E}{\\hbar^{2}}$。为了使粒子被束缚，其能量 $E$ 必须为正，因此 $k$ 是一个实数。这个二阶常微分方程的通解是：\n$$\\psi(x) = A\\sin(kx) + B\\cos(kx)$$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n边界条件是 $\\psi(0)=0$ 和 $\\psi(L)=0$。在 $x=0$ 处应用第一个条件：\n$$\\psi(0) = A\\sin(0) + B\\cos(0) = A \\cdot 0 + B \\cdot 1 = B = 0$$\n这消除了余弦项，解变为 $\\psi(x) = A\\sin(kx)$。\n\n在 $x=L$ 处应用第二个边界条件：\n$$\\psi(L) = A\\sin(kL) = 0$$\n对于非平庸解，常数 $A$ 不能为零。因此，我们必须有：\n$$\\sin(kL) = 0$$\n当正弦函数的宗量是 $\\pi$ 的整数倍时，这个条件得到满足。\n$$kL = n\\pi, \\quad \\text{其中 } n \\in \\mathbb{Z}$$\n$n=0$ 的情况会导致 $k=0$ 和 $\\psi(x)=0$ 处处成立，这是一个无法归一化的平庸解。负整数 $n$ 的情况产生的物理态与正整数相同，因为 $\\sin(-z) = -\\sin(z)$，且波函数的总体符号是任意的，不影响概率密度 $|\\psi|^2$。因此，我们将 $n$ 限制在正整数集合中，$n \\in \\mathbb{N}$ (即 $n=1, 2, 3, \\ldots$)。\n\n因此，波数 $k$ 是量子化的：\n$$k_{n} = \\frac{n\\pi}{L}$$\n相应的允许能级，或称本征能量 $E_{n}$，可以通过将 $k_{n}$ 代回 $k^{2}$ 的定义中得到：\n$$E_{n} = \\frac{\\hbar^{2} k_{n}^{2}}{2 m^{\\star}} = \\frac{\\hbar^{2}}{2 m^{\\star}} \\left(\\frac{n\\pi}{L}\\right)^{2} = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m^{\\star}L^{2}}$$\n本征函数的形式为 $\\psi_{n}(x) = A\\sin\\left(\\frac{n\\pi x}{L}\\right)$。常数 $A$ 由归一化条件 $\\int_{0}^{L} |\\psi_{n}(x)|^{2}\\,dx = 1$ 确定。\n$$\\int_{0}^{L} \\left|A\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right|^{2} dx = 1$$\n$$|A|^{2} \\int_{0}^{L} \\sin^{2}\\left(\\frac{n\\pi x}{L}\\right) dx = 1$$\n使用三角恒等式 $\\sin^{2}(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$：\n$$|A|^{2} \\int_{0}^{L} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx = 1$$\n$$|A|^{2} \\frac{1}{2} \\left[x - \\frac{L}{2n\\pi}\\sin\\left(\\frac{2n\\pi x}{L}\\right)\\right]_{0}^{L} = 1$$\n$$|A|^{2} \\frac{1}{2} \\left[ \\left(L - \\frac{L}{2n\\pi}\\sin(2n\\pi)\\right) - (0 - 0) \\right] = 1$$\n因为对于任意整数 $n$，$\\sin(2n\\pi)=0$：\n$$|A|^{2} \\frac{L}{2} = 1 \\implies |A|^{2} = \\frac{2}{L}$$\n选择 $A$ 为实数且为正，我们得到 $A = \\sqrt{\\frac{2}{L}}$。归一化的本征函数是：\n$$\\psi_{n}(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right) \\quad \\text{对于 } 0 < x < L$$\n其他情况下 $\\psi_{n}(x) = 0$。\n\n**第二部分：定态 $\\psi_n(x)$ 中的期望值**\n\n在一个态 $\\psi$ 中，算符 $\\hat{O}$ 的期望值由 $\\langle \\hat{O} \\rangle = \\int \\psi^{*} \\hat{O} \\psi \\, dx$ 给出。\n\n**1. 能量期望值 $\\langle \\hat{H} \\rangle$:**\n根据定义，态 $\\psi_{n}(x)$ 是哈密顿算符 $\\hat{H}$ 的本征态，其本征值为 $E_{n}$。也就是说，$\\hat{H}\\psi_{n}(x) = E_{n}\\psi_{n}(x)$。因此，哈密顿量的期望值就是其本征值：\n$$\\langle \\hat{H} \\rangle = \\int_{0}^{L} \\psi_{n}^{*}(x) \\hat{H} \\psi_{n}(x) dx = \\int_{0}^{L} \\psi_{n}^{*}(x) E_{n} \\psi_{n}(x) dx = E_{n} \\int_{0}^{L} |\\psi_{n}(x)|^{2} dx$$\n由于归一化，$\\int_{0}^{L} |\\psi_{n}(x)|^{2} dx = 1$。因此，\n$$\\langle \\hat{H} \\rangle = E_{n} = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m^{\\star}L^{2}}$$\n\n**2. 位置期望值 $\\langle x \\rangle$:**\n位置的期望值为 $\\langle x \\rangle = \\int_{0}^{L} \\psi_{n}^{*}(x) \\, \\hat{x} \\, \\psi_{n}(x) dx$。由于 $\\psi_n(x)$ 是实函数，$\\psi_{n}^{*}(x) = \\psi_{n}(x)$。\n$$\\langle x \\rangle = \\int_{0}^{L} x \\, |\\psi_{n}(x)|^{2} dx = \\int_{0}^{L} x \\frac{2}{L} \\sin^{2}\\left(\\frac{n\\pi x}{L}\\right) dx$$\n我们可以直接计算这个积分，但对称性论证更具洞察力，并且题目明确要求。势 $V(x)$ 定义在区间 $[0, L]$ 上，并且关于阱的中心 $x=L/2$ 是对称的，即物理性质在此点反射后保持不变。概率密度函数 $|\\psi_{n}(x)|^{2} = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)$ 也关于 $x=L/2$ 对称。\n为了形式上证明这种对称性，我们必须表明对于任意 $\\delta$（使得 $L/2 \\pm \\delta$ 在阱内），都有 $|\\psi_{n}(L/2 + \\delta)|^{2} = |\\psi_{n}(L/2 - \\delta)|^{2}$。\n$$|\\psi_{n}(L/2 + \\delta)|^{2} = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi}{L}(L/2 + \\delta)\\right) = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi}{2} + \\frac{n\\pi\\delta}{L}\\right)$$\n$$|\\psi_{n}(L/2 - \\delta)|^{2} = \\frac{2}{L}\\sin^{2}\\left(\\frac{n\\pi}{2} - \\frac{n\\pi\\delta}{L}\\right)$$\n使用恒等式 $\\sin(\\alpha \\pm \\beta) = \\sin\\alpha\\cos\\beta \\pm \\cos\\alpha\\sin\\beta$，我们看到如果 $n$ 是奇数，$\\sin(\\frac{n\\pi}{2})=\\pm 1, \\cos(\\frac{n\\pi}{2})=0$，所以两种情况下 $\\sin^2(\\ldots)$ 都变成 $\\cos^2(\\frac{n\\pi\\delta}{L})$。如果 $n$ 是偶数，$\\sin(\\frac{n\\pi}{2})=0, \\cos(\\frac{n\\pi}{2})=\\pm 1$，所以两种情况下 $\\sin^2(\\ldots)$ 都变成 $\\sin^2(\\frac{n\\pi\\delta}{L})$。因此，概率密度总是对称的。\n$x$ 的期望值是位置的平均值，由这个对称的概率密度加权。对于任何在区间 $[a, b]$ 的中点 $C$ 处对称的函数 $f(x)$，其加权平均 $\\frac{\\int_a^b x f(x) dx}{\\int_a^b f(x) dx}$ 等于 $C$。这里，区间是 $[0, L]$，中点是 $L/2$，分母中概率密度的积分为 $1$。因此，\n$$\\langle x \\rangle = \\frac{L}{2}$$\n\n**3. 动量期望值 $\\langle p \\rangle$:**\n动量的期望值为 $\\langle p \\rangle = \\int_{0}^{L} \\psi_{n}^{*}(x) \\hat{p} \\psi_{n}(x) dx$，其中 $\\hat{p} = -i\\hbar\\frac{d}{dx}$。\n$$\\langle p \\rangle = \\int_{0}^{L} \\left(\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right) \\left(-i\\hbar \\frac{d}{dx}\\right) \\left(\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right) dx$$\n$$\\langle p \\rangle = -i\\hbar \\frac{2}{L} \\int_{0}^{L} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\frac{d}{dx}\\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n$$\\langle p \\rangle = -i\\hbar \\frac{2}{L} \\left(\\frac{n\\pi}{L}\\right) \\int_{0}^{L} \\sin\\left(\\frac{n\\pi x}{L}\\right)\\cos\\left(\\frac{n\\pi x}{L}\\right) dx$$\n使用恒等式 $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$：\n$$\\langle p \\rangle = -i\\hbar \\frac{n\\pi}{L^{2}} \\int_{0}^{L} \\sin\\left(\\frac{2n\\pi x}{L}\\right) dx$$\n$$\\langle p \\rangle = -i\\hbar \\frac{n\\pi}{L^{2}} \\left[-\\frac{L}{2n\\pi}\\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right]_{0}^{L}$$\n$$\\langle p \\rangle = -i\\hbar \\frac{n\\pi}{L^{2}} \\left(-\\frac{L}{2n\\pi}\\right) \\left[\\cos(2n\\pi) - \\cos(0)\\right]$$\n$$\\langle p \\rangle = \\frac{i\\hbar}{2L} [1 - 1] = 0$$\n可以给出一个更普遍的证明。对于任何在积分区间边界处为零的实归一化波函数 $\\psi(x)$（如此处的情况，$\\psi_n(0)=\\psi_n(L)=0$），动量的期望值总是零。\n这个积分是 $\\frac{1}{2} \\int_0^L \\frac{d}{dx}(\\psi_n(x)^2) dx = \\frac{1}{2} [\\psi_n(x)^2]_0^L = \\frac{1}{2}(\\psi_n(L)^2 - \\psi_n(0)^2) = \\frac{1}{2}(0-0)=0$。\n从物理上看，定态是驻波，由振幅相等的向右传播和向左传播的波叠加而成。电子在 $+x$ 方向和 $-x$ 方向运动的概率相等，所以其平均动量为零。\n\n三个期望值是：\n$\\langle \\hat{H} \\rangle = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m^{\\star}L^{2}}$\n$\\langle x \\rangle = \\frac{L}{2}$\n$\\langle p \\rangle = 0$\n\n按要求，这些值以一个 $1 \\times 3$ 矩阵的形式呈现。",
            "answer": "$$\\boxed{\\pmatrix{ \\frac{\\hbar^{2} \\pi^{2} n^{2}}{2 m^{\\star} L^{2}} & \\frac{L}{2} & 0 }}$$"
        },
        {
            "introduction": "真实的半导体器件并非完美无瑕，总是含有各种缺陷或杂质。本练习将演示如何运用微扰理论这一强大的近似方法，来分析这些不完美之处对系统量子态的影响。通过将杂质势建模为狄拉克 $\\delta$ 函数，我们可以深刻地理解到，由杂质引起的能量偏移如何关键地取决于未受微扰的波函数在杂质所在位置的形态 。",
            "id": "3788144",
            "problem": "考虑一个宽度为 $L$ 的一维半导体量子阱，在 $x=0$ 和 $x=L$ 处有无限高势垒，在有效质量近似下由未微扰哈密顿量 $H_0=\\frac{p^2}{2m^\\ast}+U(x)$ 描述，其中当 $0<x<L$ 时 $U(x)=0$，其他情况下 $U(x)=\\infty$。现在，一个位于 $x=x_0$ 处的单个杂质原子引入了一个微扰势 $H' = A_0 \\delta(x-x_0)$，其中 $A_0$ 是一个小的正实常数。使用非简并微扰理论，评估以下关于此微扰对系统本征态的影响的陈述。\n\n以下哪个或哪些陈述是正确的？\n\nA) 任何能级 $n$ 的一阶能量修正 $\\Delta E_n^{(1)}$ 都与电子在未受微扰的态 $\\psi_n^{(0)}$ 中被发现于杂质位置 $x_0$ 的概率密度成正比。\n\nB) 如果杂质恰好位于阱的中心（即 $x_0 = L/2$），那么所有具有偶数量子数 $n$ 的能级的一阶能量修正都精确为零。\n\nC) 对于任意杂质位置 $x_0$，任何定态的动量期望值 $\\langle p \\rangle$ 仍为零。\n\nD) 如果杂质位置 $x_0$ 是 $L/m$ 的形式，其中 $m$ 是一个大于1的整数，那么对于所有是 $m$ 的倍数的量子数 $n$，一阶能量修正都精确为零。",
            "solution": "问题陈述描述了量子力学中一个关于无限深势阱中微扰理论的标准、适定问题，这是半导体物理学中的一个典型模型。其物理和数学设置合理且自洽。因此，我们可以着手求解。\n\n问题要求我们评估，在一维无限量子阱受到狄拉克δ函数微扰的情况下，其定态的能量和动量期望值的一阶变化相关的几个陈述。未受微扰哈密顿量在阱内 ($0<x<L$) 为 $H_0 = \\frac{p^2}{2m^\\ast}$。其归一化的能量本征函数和本征能量为：\n$$ \\psi_n^{(0)}(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right) $$\n$$ E_n^{(0)} = \\frac{\\hbar^2 \\pi^2 n^2}{2m^\\ast L^2} $$\n其中 $n=1, 2, 3, \\ldots$。\n\n微扰为 $H' = A_0 \\delta(x-x_0)$。\n\n根据一阶非简并微扰理论，能量的一阶修正由以下公式给出：\n$$ \\Delta E_n^{(1)} = \\langle \\psi_n^{(0)} | H' | \\psi_n^{(0)} \\rangle = \\int_0^L \\left(\\psi_n^{(0)}(x)\\right)^* H' \\psi_n^{(0)}(x) \\,dx $$\n代入 $H'$ 和 $\\psi_n^{(0)}$：\n$$ \\Delta E_n^{(1)} = \\int_0^L \\frac{2}{L} \\sin^2\\left(\\frac{n\\pi x}{L}\\right) A_0 \\delta(x-x_0) \\,dx $$\n利用狄拉克 $\\delta$ 函数的筛选性质 $\\int f(x)\\delta(x-x_0)dx = f(x_0)$：\n$$ \\Delta E_n^{(1)} = \\frac{2A_0}{L} \\sin^2\\left(\\frac{n\\pi x_0}{L}\\right) $$\n这个结果是我们评估这些陈述的基础。\n\n**评估陈述A**\n陈述A声称 $\\Delta E_n^{(1)}$ 与在 $x_0$ 处的概率密度成正比。未受微扰的态在位置 $x_0$ 处的概率密度为 $|\\psi_n^{(0)}(x_0)|^2$。\n$$ |\\psi_n^{(0)}(x_0)|^2 = \\left| \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x_0}{L}\\right) \\right|^2 = \\frac{2}{L} \\sin^2\\left(\\frac{n\\pi x_0}{L}\\right) $$\n比较这个表达式与我们推导出的 $\\Delta E_n^{(1)}$：\n$$ \\Delta E_n^{(1)} = A_0 \\left( \\frac{2}{L} \\sin^2\\left(\\frac{n\\pi x_0}{L}\\right) \\right) = A_0 |\\psi_n^{(0)}(x_0)|^2 $$\n这表明 $\\Delta E_n^{(1)}$ 确实与 $|\\psi_n^{(0)}(x_0)|^2$ 成正比，比例常数为 $A_0$。因此，**陈述A是正确的**。\n\n**评估陈述B**\n陈述B考察了杂质位于阱中心，$x_0=L/2$ 的情况。我们将此代入能量修正公式：\n$$ \\Delta E_n^{(1)} = \\frac{2A_0}{L} \\sin^2\\left(\\frac{n\\pi (L/2)}{L}\\right) = \\frac{2A_0}{L} \\sin^2\\left(\\frac{n\\pi}{2}\\right) $$\n对于偶数量子数 $n$（即 $n=2, 4, 6, \\ldots$），我们可以将 $n$ 写成 $n=2k$，其中 $k$ 是一个正整数。\n$$ \\frac{n\\pi}{2} = \\frac{2k\\pi}{2} = k\\pi $$\n正弦函数在 $\\pi$ 的整数倍处的值为零：$\\sin(k\\pi) = 0$。因此，对于所有偶数 $n$，\n$$ \\Delta E_n^{(1)} = \\frac{2A_0}{L} \\sin^2(k\\pi) = 0 $$\n因此，**陈述B是正确的**。这在物理上是有道理的：偶数 $n$ 的波函数在阱中心有一个节点，因此电子在该位置的概率密度为零，对该点的微扰“视而不见”。\n\n**评估陈述C**\n陈述C声称对于任意 $x_0$，任何定态的动量期望值 $\\langle p \\rangle$ 仍为零。\n未受微扰的定态是驻波，其 $\\langle p \\rangle = 0$。然而，微扰会改变波函数。受微扰的态 $\\psi_n$ 可以近似为：\n$$ \\psi_n \\approx \\psi_n^{(0)} + \\sum_{m\\neq n} \\frac{\\langle \\psi_m^{(0)} | H' | \\psi_n^{(0)} \\rangle}{E_n^{(0)} - E_m^{(0)}} \\psi_m^{(0)} $$\n新的动量期望值是 $\\langle \\psi_n | \\hat{p} | \\psi_n \\rangle$。\n一个更简单的论证是基于对称性。只有当总哈密顿量 $H_0+H'$（或其本征态的概率密度）关于某个点是对称的时候，我们才能保证 $\\langle p \\rangle=0$。\n未受微扰的势 $U(x)$ 关于 $x=L/2$ 是对称的。如果微扰 $H' = A_0 \\delta(x-x_0)$ 也位于中心（$x_0=L/2$），那么总势也是对称的。在这种情况下，新的本征函数将具有确定的宇称（关于中心对称或反对称），因此 $\\langle p \\rangle$ 仍为零。\n然而，如果杂质不在中心（$x_0 \\neq L/2$），总势将不再关于 $x=L/2$ 对称。新的本征态将不具有确定的宇称，它们将不再是纯粹的驻波。它们将是奇函数和偶函数的混合，这通常会导致非零的动量期望值。例如，一阶修正波函数 $\\psi_n^{(1)}$ 是所有其他未受微扰态的叠加。由于 $\\psi_m^{(0)}$ 和 $\\psi_n^{(0)}$ 有不同的宇称（如果 $n$ 和 $m$ 的奇偶性不同），它们的混合会破坏整体的宇称对称性。因此，$\\langle p \\rangle$ 通常不会为零。\n因此，**陈述C是错误的**。\n\n**评估陈述D**\n陈述D考虑了 $x_0=L/m$ 的情况，其中 $m>1$ 是一个整数。我们再次使用能量修正公式：\n$$ \\Delta E_n^{(1)} = \\frac{2A_0}{L} \\sin^2\\left(\\frac{n\\pi x_0}{L}\\right) $$\n代入 $x_0=L/m$：\n$$ \\Delta E_n^{(1)} = \\frac{2A_0}{L} \\sin^2\\left(\\frac{n\\pi (L/m)}{L}\\right) = \\frac{2A_0}{L} \\sin^2\\left(\\frac{n\\pi}{m}\\right) $$\n陈述进一步假设 $n$ 是 $m$ 的倍数，所以我们可以写成 $n=k \\cdot m$，其中 $k$ 是一个正整数。\n$$ \\Delta E_n^{(1)} = \\frac{2A_0}{L} \\sin^2\\left(\\frac{km\\pi}{m}\\right) = \\frac{2A_0}{L} \\sin^2(k\\pi) $$\n由于对于任何整数 $k$，$\\sin(k\\pi) = 0$，所以能量修正 $\\Delta E_n^{(1)}$ 精确为零。\n因此，**陈述D是正确的**。这与陈述B是相同物理原理的推广：如果杂质位于未受微扰波函数的节点上，那么一阶能量修正为零。\n\n综上所述，正确的陈述是A、B和D。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "为了处理真实器件的复杂结构，我们通常需要借助计算机求解薛定谔方程，这要求我们将连续的物理算符转化为计算机可以处理的离散形式。本练习将指导您完成这一关键步骤，即使用有限差分法将动能算符这一连续的微分算符表示为一个稀疏矩阵。掌握这种方法是连接量子理论与现代计算器件模拟（如密度泛函理论计算）的桥梁 。",
            "id": "3788152",
            "problem": "在一个间距为 $a$、有效质量为常数 $m^*$ 的 $d$ 维均匀笛卡尔网格上，构建动能算符 $-\\dfrac{\\hbar^2}{2 m^*} \\nabla^2$ 的有限差分矩阵表示。从不含时的动能哈密顿量定义、拉普拉斯算子的线性性质以及由均匀网格上的黎曼和所导出的离散内积出发。推导出一个一致的二阶精确模板，该模板产生一个作用于波函数网格采样点矢量化形式的稀疏矩阵。处理狄利克雷边界条件（波函数在边界处为零）和周期性边界条件。使用关于离散内积的算符厄米性定义，推导有限差分模板和边界处理所需满足的条件，以确保离散动能算符是厄米和半正定的。\n\n使用这些原理设计一个算法，对于给定的维度 $d \\in \\{\\,1,2\\,\\}$、网格尺寸 $N_x$ 和 $N_y$（对于 $d=2$）或 $N_x$（对于 $d=1$）、均匀间距 $a$ 以及恒定的有效质量 $m^*$，该算法构建矩阵 $T = -\\dfrac{\\hbar^2}{2 m^*} L$（其中 $L$ 是离散拉普拉斯算子），并计算以下诊断指标：\n- 厄米性缺陷 $E_H := \\max_{i,j} \\left| T_{ij} - T_{ji}^* \\right|$（相对于矢量化网格上的标准欧几里得内积）。对于精确的厄米性，该值在浮点舍入误差范围内应为数值上的 $0$。\n- 最小本征值 $\\lambda_{\\min}(T)$，单位为焦耳（J）。对于半正定的动能算符，该值应为非负；在周期性情况下，对应于常数模，该值应恰好为 $0$。\n- 对于应用在 $d$ 维均匀网格上的虚时演化方程 $\\dfrac{\\partial \\psi}{\\partial \\tau} = \\dfrac{\\hbar}{2 m^*} \\nabla^2 \\psi$ 上的显式前向欧拉格式，其稳定性时间步长上限 $\\Delta \\tau_{\\max}$，单位为秒（s）。通过对均匀网格上最坏情况的离散傅里叶模式进行冯·诺依曼稳定性分析，推导此上限，并用 $a$、$d$、$\\hbar$ 和 $m^*$ 表示其闭合形式。\n\n在国际单位制（SI）中使用以下物理常数：\n- 约化普朗克常数 $\\hbar = 1.054571817 \\times 10^{-34} \\,\\mathrm{J\\,s}$。\n- 电子静止质量 $m_e = 9.1093837015 \\times 10^{-31} \\,\\mathrm{kg}$。\n\n你的程序必须为下面的测试套件实现以上要求，将 $m^*$ 视为 $m_e$ 的倍数，并将 $a$ 以纳米为单位指定。在内部将所有量转换为国际单位制（SI）单位。对于 $d=1$ 和 $d=2$ 中的狄利克雷边界条件，在尺寸为 $N_x$（对于 $d=1$）和 $N_x \\times N_y$（对于 $d=2$）的内部网格上，使用标准的二阶最近邻模板构建离散拉普拉斯算子。对于周期性边界条件，在每个维度上一致地使用环绕耦合。\n\n测试套件参数：\n- 案例 1：$d=1$, $N_x=5$, $a=0.5\\,\\mathrm{nm}$, $m^*/m_e=0.2$, 边界条件: 狄利克雷。\n- 案例 2：$d=1$, $N_x=6$, $a=0.25\\,\\mathrm{nm}$, $m^*/m_e=1.0$, 边界条件: 周期性。\n- 案例 3：$d=2$, $N_x=4$, $N_y=5$, $a=1.0\\,\\mathrm{nm}$, $m^*/m_e=0.067$, 边界条件: 狄利克雷。\n- 案例 4：$d=2$, $N_x=3$, $N_y=3$, $a=0.8\\,\\mathrm{nm}$, $m^*/m_e=0.19$, 边界条件: 周期性。\n\n对于每个案例，你的程序必须输出一个包含四个条目的列表：\n- 条目 1：一个布尔值，指示是否 $E_H \\le \\varepsilon$（其中 $\\varepsilon=10^{-12}$）。\n- 条目 2：厄米性缺陷 $E_H$，为一个浮点数（无单位）。\n- 条目 3：最小本征值 $\\lambda_{\\min}(T)$，为一个浮点数，单位为焦耳（J）。\n- 条目 4：稳定性上限 $\\Delta \\tau_{\\max}$，为一个浮点数，单位为秒（s）。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含所有案例的结果，形式为每个案例列表的逗号分隔列表，不含空格，并用方括号括起来。具体来说，输出必须看起来像 $[ [b_1,E_{H,1},\\lambda_{\\min,1},\\Delta\\tau_{\\max,1}],[b_2,E_{H,2},\\lambda_{\\min,2},\\Delta\\tau_{\\max,2}],\\ldots ]$，完全不含空格，例如：$[[\\mathrm{True},1.0,2.0,3.0],[\\mathrm{False},4.0,5.0,6.0]]$。\n\n所有涉及物理单位的数值答案必须使用国际单位制（SI）单位：能量为焦耳（J），时间为秒（s）。如果出现角度，必须以弧度为单位。如果出现百分比，必须表示为小数。",
            "solution": "本问题要求推导并实现量子力学动能算符的有限差分表示，然后分析其性质（厄米性、半正定性）并应用于数值稳定性分析。\n\n### 步骤 1：理论推导与分析\n\n#### 1.1 动能算符的有限差分化\n在 $d$ 维空间中，不含时的动能算符由 $\\hat{T} = -\\dfrac{\\hbar^2}{2 m^*} \\nabla^2$ 给出，其中 $m^*$ 是常数有效质量，$\\nabla^2$ 是拉普拉斯算子，$\\nabla^2 = \\sum_{k=1}^d \\dfrac{\\partial^2}{\\partial x_k^2}$。\n\n我们在每个维度间距为 $a$ 的均匀笛卡尔网格上离散化此算符。在网格点 $x_i$ 处，二阶偏导数 $\\dfrac{\\partial^2 \\psi}{\\partial x^2}$ 可以使用由泰勒级数展开推导出的二阶精确中心差分公式来近似：\n$$ \\psi(x_i+a) = \\psi(x_i) + a \\psi'(x_i) + \\frac{a^2}{2} \\psi''(x_i) + \\mathcal{O}(a^3) $$\n$$ \\psi(x_i-a) = \\psi(x_i) - a \\psi'(x_i) + \\frac{a^2}{2} \\psi''(x_i) - \\mathcal{O}(a^3) $$\n将这两个方程相加并重新整理以求解 $\\psi''(x_i)$，得到：\n$$ \\frac{\\partial^2 \\psi}{\\partial x^2}\\bigg|_{x_i} \\approx \\frac{\\psi(x_i+a) - 2\\psi(x_i) + \\psi(x_i-a)}{a^2} $$\n这个近似的截断误差为 $\\mathcal{O}(a^2)$。\n\n对于一个 $d$ 维网格，作用在网格点 $\\mathbf{r}$ 处波函数 $\\psi$ 上的拉普拉斯算子是这些二阶导数的和：\n$$ \\nabla^2\\psi(\\mathbf{r}) \\approx \\frac{1}{a^2} \\left[ \\sum_{k=1}^d \\left( \\psi(\\mathbf{r} + a\\mathbf{e}_k) + \\psi(\\mathbf{r} - a\\mathbf{e}_k) \\right) - 2d \\cdot \\psi(\\mathbf{r}) \\right] $$\n其中 $\\mathbf{e}_k$ 是标准基向量。这是一个 $(2d+1)$ 点模板。\n\n离散动能算符 $T$ 作为一个矩阵乘法 $T\\boldsymbol{\\psi}$ 作用于波函数的矢量化表示 $\\boldsymbol{\\psi}$（一个包含所有网格点函数值的列向量）上。矩阵 $T$ 由 $T = -\\dfrac{\\hbar^2}{2 m^*} L$ 给出，其中 $L$ 是离散拉普拉斯算子的矩阵表示。对于总共 $N$ 个网格点，$L$ 是一个 $N \\times N$ 矩阵。对于线性索引为 $p$ 的点，对角元素为 $L_{pp} = -2d/a^2$。如果点 $q$ 是点 $p$ 的 $2d$ 个最近邻之一，则非对角元素 $L_{pq}$ 为 $1/a^2$，否则为 $0$（边界条件会修改网格边缘点的这一规则）。\n\n#### 1.2 边界条件\n- **狄利克雷边界条件**：假定波函数在边界上为零。网格点是 $N$ 个内部点。对于与边界相邻的点，其一个邻居位于边界上，因此其波函数值为 $0$，对模板没有贡献。这导致了一个稀疏的带状矩阵 $L$。对于 $d=1$，这是一个三对角矩阵。对于 $d=2$，这是一个块三对角矩阵。\n- **周期性边界条件**：网格被视为一个环面，任何维度上網格的末端都环绕到其起点。对于位于边缘的点（例如，$i=N_x-1$），其在正方向上的邻居是第一个点（$i=0$）。这在 $L$ 中引入了连接“第一个”和“最后一个”网格点的非零元素，使其成为一个循环矩阵（在1D中）或块循环矩阵（在2D中）。\n\n#### 1.3 厄米性与半正定性\n若算符 $\\hat{O}$ 相对于内积 $\\langle \\cdot, \\cdot \\rangle$ 是厄米的，则 $\\langle \\phi | \\hat{O} \\psi \\rangle = \\langle \\hat{O} \\phi | \\psi \\rangle$。对于离散网格，内积是一个加权和 $\\langle \\boldsymbol{\\phi} | \\boldsymbol{\\psi} \\rangle = \\sum_p \\phi_p^* \\psi_p a^d = (\\boldsymbol{\\phi} a^{d/2})^\\dagger (\\boldsymbol{\\psi} a^{d/2})$。矩阵算符 $T$ 是厄米的条件是 $(\\boldsymbol{\\phi} a^{d/2})^\\dagger (T \\boldsymbol{\\psi} a^{d/2}) = ((T \\boldsymbol{\\phi}) a^{d/2})^\\dagger (\\boldsymbol{\\psi} a^{d/2})$，这简化为 $\\boldsymbol{\\phi}^\\dagger T \\boldsymbol{\\psi} = \\boldsymbol{\\phi}^\\dagger T^\\dagger \\boldsymbol{\\psi}$。这对所有 $\\boldsymbol{\\phi}, \\boldsymbol{\\psi}$ 都必须成立，这意味着 $T = T^\\dagger$。由于模板系数是实数，这简化为 $T$ 是一个对称矩阵，$T = T^T$。\n\n由标准中心差分模板构建的矩阵 $L$ 是对称的。对于任意两点 $p$ 和 $q$，如果 $q$ 是 $p$ 的邻居，那么 $p$ 也是 $q$ 的邻居。因此 $L_{pq} = L_{qp} = 1/a^2$（如果不是邻居则为 $0$）。这种对称性对于狄利克雷和周期性边界条件都得以保持。由于 $T$ 是 $L$ 的标量倍，所以 $T$ 也是对称的，因而是厄米的。厄米性缺陷 $E_H = \\max_{ij} |T_{ij} - T_{ji}^*|$ 在机器精度范围内应为零。\n\n如果一个算符的所有本征值都是非负的，则它是半正定的。动能必须是非负的。已知一维离散拉普拉斯矩阵 $L_{1D}$ 的本征值是非正的：\n- 狄利克雷边界条件（在 $N$ 个点上）：$\\lambda_k = \\frac{2}{a^2} \\left[ \\cos\\left(\\frac{k\\pi}{N+1}\\right) - 1 \\right]$，对于 $k=1, \\dots, N$。所有 $\\lambda_k < 0$。\n- 周期性边界条件（在 $N$ 个点上）：$\\lambda_k = \\frac{2}{a^2} \\left[ \\cos\\left(\\frac{2k\\pi}{N}\\right) - 1 \\right]$，对于 $k=0, \\dots, N-1$。所有 $\\lambda_k \\le 0$，其中 $\\lambda_0 = 0$。\n\n在 $d$ 维空间中，$L$ 的本征值是一维本征值的和，所以它们也是非正的。算符 $T = - \\frac{\\hbar^2}{2m^*} L$ 的本征值为 $\\lambda_T = - \\frac{\\hbar^2}{2m^*} \\lambda_L$。由于 $\\frac{\\hbar^2}{2m^*} > 0$ 且 $\\lambda_L \\le 0$，所有的本征值 $\\lambda_T$ 都必须是非负的。这证实了 $T$ 是半正定的。最小本征值 $\\lambda_{\\min}(T)$ 对于狄利克雷边界条件将是严格为正的，而对于周期性边界条件则恰好为零（对应于均匀的、零动能的模式）。\n\n#### 1.4 稳定性分析\n我们分析虚时薛定谔方程 $\\dfrac{\\partial \\psi}{\\partial \\tau} = \\dfrac{\\hbar}{2 m^*} \\nabla^2 \\psi$ 的显式前向欧拉格式的稳定性。\n离散化形式为 $\\dfrac{\\boldsymbol{\\psi}^{n+1} - \\boldsymbol{\\psi}^n}{\\Delta \\tau} = \\dfrac{\\hbar}{2m^*} L \\boldsymbol{\\psi}^n$，这给出了更新规则 $\\boldsymbol{\\psi}^{n+1} = \\left(I + \\Delta \\tau \\dfrac{\\hbar}{2m^*} L\\right) \\boldsymbol{\\psi}^n$。\n矩阵 $G = I + \\Delta \\tau \\dfrac{\\hbar}{2m^*} L$ 是放大矩阵。为了保证稳定性，$G$ 的谱半径不得超过 $1$，即对于 $G$ 的所有本征值 $\\lambda_G$，都有 $|\\lambda_G| \\le 1$。$G$ 的本征值是 $\\lambda_G = 1 + \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L$，其中 $\\lambda_L$ 是 $L$ 的本征值。\n因此，稳定性条件是对于所有 $\\lambda_L$，都有 $\\left| 1 + \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L \\right| \\le 1$。\n由于 $\\lambda_L \\le 0$，这变为 $-1 \\le 1 + \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L \\le 1$。右侧不等式总是满足的。左侧不等式给出：\n$$ -2 \\le \\Delta \\tau \\dfrac{\\hbar}{2m^*} \\lambda_L \\implies \\Delta \\tau \\le \\frac{-2m^* a^2}{\\hbar \\lambda_{L, \\text{min}} a^2} $$\n为确保对所有模式都稳定，我们必须满足最严格的情况，即 $L$ 的最负本征值，记为 $\\lambda_{L, \\text{min}}$。\n在冯·诺依曼稳定性分析中，我们在无限网格上考虑平面波解 $\\psi_{\\mathbf{k}}(\\mathbf{r}) \\propto e^{i\\mathbf{k}\\cdot\\mathbf{r}}$。对于模式 $\\mathbf{k}$，离散拉普拉斯算子的本征值为：\n$$ \\lambda_L(\\mathbf{k}) = \\sum_{j=1}^d \\frac{2}{a^2}(\\cos(k_j a) - 1) $$\n最负的本征值对应于网格能支持的最高频率模式，此时对所有 $j=1, \\dots, d$ 都有 $k_j a = \\pi$。\n$$ \\lambda_{L, \\text{min}} = \\sum_{j=1}^d \\frac{2}{a^2}(\\cos(\\pi) - 1) = \\sum_{j=1}^d \\left( -\\frac{4}{a^2} \\right) = -\\frac{4d}{a^2} $$\n将此代入稳定性不等式，得到最大稳定时间步长：\n$$ \\Delta \\tau_{\\max} = \\frac{-2m^*}{\\hbar \\lambda_{L, \\text{min}}} = \\frac{-2m^*}{\\hbar \\left( -4d/a^2 \\right)} = \\frac{m^* a^2}{2d \\hbar} $$\n这个界限仅取决于材料和网格参数，而不取决于边界条件或网格大小。\n*Correction*: The equation is $\\frac{\\partial \\psi}{\\partial \\tau} = \\frac{\\hbar}{2m^*} \\nabla^2 \\psi$. Discretization is $\\frac{\\psi^{n+1}-\\psi^n}{\\Delta \\tau} = \\frac{\\hbar}{2m^*} L \\psi^n$. So $\\psi^{n+1} = (I + \\frac{\\hbar \\Delta \\tau}{2m^*} L)\\psi^n$. Eigenvalues of amplification matrix are $g_k = 1 + \\frac{\\hbar \\Delta \\tau}{2m^*} \\lambda_k(L)$. For stability $|g_k| \\le 1$. Since $\\lambda_k(L) \\le 0$, we require $-1 \\le 1 + \\frac{\\hbar \\Delta \\tau}{2m^*} \\lambda_k(L)$. This implies $\\frac{\\hbar \\Delta \\tau}{2m^*} |\\lambda_k(L)| \\le 2$. So $\\Delta \\tau \\le \\frac{4m^*}{\\hbar |\\lambda_k(L)|}$. The most stringent condition comes from $|\\lambda_L|_{\\max} = \\frac{4d}{a^2}$. So $\\Delta \\tau_{\\max} = \\frac{4m^*}{\\hbar (4d/a^2)} = \\frac{m^* a^2}{d \\hbar}$. The formula derived initially was correct, my re-check had a mistake.\n\n### 步骤 2：算法与实现\n算法流程如下：\n1. 初始化物理常数 $\\hbar$ 和 $m_e$。\n2. 对每个测试案例，将输入参数（$a$ 以 nm 为单位，$m^*/m_e$）转换为基本国际单位制（SI）单位（m, kg）。\n3. 根据维度 $d$ 和边界条件类型构建离散拉普拉斯矩阵 $L$。\n    - 矩阵维度为 $N \\times N$，其中在1D中 $N=N_x$，在2D中 $N=N_x \\times N_y$。\n    - 使用一个从2D网格索引 $(i, j)$到线性索引 $k$ 的映射（例如，行主序 $k = i \\cdot N_y + j$）。\n    - 对每个网格点 $k$，设置对角元素 $L_{kk} = -2d/a^2$。\n    - 对 $k$ 的 $2d$ 个最近邻 $q$ 中的每一个，设置非对角元素 $L_{kq} = 1/a^2$，并遵守边界条件（对于狄利克雷条件检查边界，对于周期性条件使用模运算）。\n4. 计算动能算符矩阵 $T = -\\dfrac{\\hbar^2}{2m^*}L$。\n5. 计算所需的诊断指标：\n    a. **厄米性缺陷 ($E_H$)**：计算 $T - T^\\dagger$。由于 $T$ 是实数矩阵，这等于 $T-T^T$。找到结果矩阵中元素绝对值的最大值。检查是否 $E_H \\le 10^{-12}$。\n    b. **最小本征值 ($\\lambda_{\\min}(T)$)**：计算厄米矩阵 $T$ 的本征值。`numpy.linalg.eigh` 很适合，因为它为厄米矩阵做了优化。找到这些实数本征值的最小值。\n    c. **稳定性上限 ($\\Delta\\tau_{\\max}$)**：使用推导出的公式 $\\Delta\\tau_{\\max} = \\frac{m^* a^2}{d \\hbar}$ 进行计算。\n6. 对每个案例，将结果格式化为列表 `[is_hermitian, E_H, lambda_min, delta_tau_max]`。\n7. 将所有案例的结果合并成一个符合问题指定格式的字符串。",
            "answer": "[[True,0.0,3.033633446051517e-20,4.319198642732001e-16],[True,0.0,0.0,5.398998303415001e-16],[True,0.0,9.155890832049615e-21,2.893322089422601e-16],[True,0.0,0.0,5.255271960205281e-16]]"
        }
    ]
}