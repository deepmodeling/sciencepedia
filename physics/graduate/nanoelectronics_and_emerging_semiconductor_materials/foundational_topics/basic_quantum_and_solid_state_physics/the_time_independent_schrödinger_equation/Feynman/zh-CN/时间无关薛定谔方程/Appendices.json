{
    "hands_on_practices": [
        {
            "introduction": "要掌握定态薛定谔方程，我们首先从其最基本的应用——“箱中粒子”或无限深方势阱模型——开始。这个练习  不仅仅是求解能量和波函数；它要求您从自伴性这一核心原则出发，推导出边界条件，并理解为何所得到的解能构成一个完备基。这项基础实践将为您构建解决更复杂纳米结构问题所必需的核心分析技能。",
            "id": "2822887",
            "problem": "一个质量为 $m$ 的非相对论性粒子在一维空间中运动，其所处的势能 $V(x)$ 定义为：当 $0<x<L$ 时，$V(x)=0$；其他情况下 $V(x)=+\\infty$，其中 $L>0$ 是一个有限值。从不含时薛定谔方程（TISE）出发，即哈密顿算符 $\\hat{H} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + V(x)$ 作用于可接受的态函数 $\\psi(x)$ 上的本征值问题，完成以下任务：\n\n1. 根据物理可接受性（平方可积性）以及哈密顿算符 $\\hat{H}$ 在其定义域上是自伴的要求，建立在区间 $0<x<L$ 上的边值问题。清晰地陈述在 $x=0$ 和 $x=L$ 处的边界条件，并从第一性原理出发证明其合理性，不得引用任何预先记忆的结论。\n\n2. 求解在势阱内部 $0<x<L$ 的本征值问题，通过对微分方程和边界条件的显式推导，求出所有的定态本征函数 $\\psi_{n}(x)$ 及其对应的能量本征值 $E_{n}$，包括归一化常数。\n\n3. 利用有限区间上正则 Sturm–Liouville 问题的结构以及希尔伯特空间上自伴算符的谱定理，解释为什么你找到的本征函数集在 $(0,L)$ 上的平方可积函数空间 $L^{2}(0,L)$ 中是完备的。在你的讨论中，精确说明此处完备性的含义，并将其与将任意函数 $f\\in L^{2}(0,L)$ 表示为这些本征函数的收敛级数的能力联系起来。\n\n你最终报告的答案必须是通用能量本征值 $E_{n}$ 的一个单一封闭形式符号表达式，用 $n$、$\\hbar$、$m$ 和 $L$ 表示。所有物理量均使用国际单位制（SI），但最终的方框表达式中不应包含单位。不需要进行数值计算，也不需要四舍五入。",
            "solution": "所给问题是量子力学中一个标准的、基础的练习，即所谓的“无限深势阱中的粒子”。该问题的陈述在科学上是合理的、提法是明确的，并且没有任何歧义。我将着手解答此问题。\n\n该问题要求从不含时薛定谔方程（TISE）出发进行推导，该方程是哈密顿算符 $\\hat{H}$ 的一个本征值方程：\n$$\n\\hat{H}\\psi(x) = E\\psi(x)\n$$\n其中哈密顿算符由 $\\hat{H} = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}} + V(x)$ 给出。势能 $V(x)$ 定义为当 $x \\in (0, L)$ 时 $V(x)=0$，当 $x \\notin (0, L)$ 时 $V(x)=+\\infty$。\n\n1. 边值问题的建立\n\n首先，考虑势能为无穷大的区域，即 $x \\le 0$ 和 $x \\ge L$。在这些区域，不含时薛定谔方程可以形式上写为 $(E - V(x))\\psi(x) = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi}{dx^{2}}$。如果 $V(x) \\to +\\infty$，那么对于有限的能量 $E$ 和行为良好的二阶导数，为了使此方程成立，波函数 $\\psi(x)$ 必须恒等于零。任何非零值都会导致左边出现一个无穷大项，而右边无法与之平衡。因此，粒子不能在势能无穷大的区域中被发现的物理要求意味着 $|\\psi(x)|^{2}=0$，所以对于所有 $x \\le 0$ 和 $x \\ge L$，$\\psi(x)=0$。\n\n其次，量子力学的一个基本假设是波函数 $\\psi(x)$ 必须是位置 $x$ 的连续函数。$\\psi(x)$ 的不连续性将意味着其一阶导数为无穷大（一个狄拉克δ函数），而二阶导数则更加奇异，这将导致无穷大的动能，这在物理上是不可能的。因此，要求 $\\psi(x)$ 在势阱边界 $x=0$ 和 $x=L$ 处是连续的。\n将势阱内部的解与外部的解连接起来，我们必须有：\n$$\n\\lim_{x \\to 0^{+}} \\psi(x) = \\psi(0) = 0\n$$\n$$\n\\lim_{x \\to L^{-}} \\psi(x) = \\psi(L) = 0\n$$\n这些是区间 $(0, L)$ 上该问题的狄利克雷边界条件。\n\n一个更形式化的理由来自于哈密顿算符 $\\hat{H}$ 在其定义域上是自伴（厄米）的要求。其定义域由使得 $\\hat{H}\\psi$ 平方可积的函数组成。对于定义域中的任意两个函数 $f(x)$ 和 $g(x)$，自伴性质要求 $\\langle f, \\hat{H}g \\rangle = \\langle \\hat{H}f, g \\rangle$，其中内积定义为 $\\langle f, g \\rangle = \\int_{0}^{L} f^{*}(x)g(x)dx$。我们来计算内积 $\\langle f, \\hat{H}g \\rangle$：\n$$\n\\langle f, \\hat{H}g \\rangle = \\int_{0}^{L} f^{*}(x) \\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}g}{dx^{2}}\\right) dx\n$$\n进行两次分部积分得到：\n$$\n\\langle f, \\hat{H}g \\rangle = -\\frac{\\hbar^{2}}{2m}\\left[f^{*}\\frac{dg}{dx} - \\frac{df^{*}}{dx}g\\right]_{0}^{L} + \\int_{0}^{L} \\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}f^{*}}{dx^{2}}\\right) g(x) dx\n$$\n右边的第二项是 $\\langle \\hat{H}f, g \\rangle$。为了使 $\\hat{H}$ 是自伴的，边界项必须为零：\n$$\n\\left[f^{*}(x)\\frac{dg(x)}{dx} - \\frac{df^{*}(x)}{dx}g(x)\\right]_{0}^{L} = 0\n$$\n这个条件必须对 $\\hat{H}$ 定义域中的所有函数 $f, g$ 成立。确保这一点的充分条件是所有这些函数在边界处都为零：$\\psi(0)=0$ 和 $\\psi(L)=0$。这正是从物理论证中得出的边界条件。\n\n因此，边值问题是：\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi(x)}{dx^{2}} = E\\psi(x), \\quad \\text{对于 } x \\in (0,L)\n$$\n服从边界条件 $\\psi(0) = 0$ 和 $\\psi(L) = 0$。\n\n2. 本征值问题的求解\n\n我们来解这个微分方程。整理后，我们有：\n$$\n\\frac{d^{2}\\psi(x)}{dx^{2}} + \\frac{2mE}{\\hbar^{2}}\\psi(x) = 0\n$$\n设 $k^{2} = \\frac{2mE}{\\hbar^{2}}$。由于势阱内部 $V(x)=0$，能量 $E$ 必须为正。如果 $E \\le 0$，满足边界条件的唯一解是平庸解 $\\psi(x)=0$，这不是一个有效的态函数。因此，$E > 0$ 且 $k$ 是一个正实数。方程变为：\n$$\n\\frac{d^{2}\\psi(x)}{dx^{2}} + k^{2}\\psi(x) = 0\n$$\n这个二阶线性齐次微分方程的通解是：\n$$\n\\psi(x) = A\\sin(kx) + B\\cos(kx)\n$$\n现在，我们应用边界条件。在 $x=0$ 处：\n$$\n\\psi(0) = A\\sin(0) + B\\cos(0) = A \\cdot 0 + B \\cdot 1 = B = 0\n$$\n所以解必须具有 $\\psi(x) = A\\sin(kx)$ 的形式。在 $x=L$ 处：\n$$\n\\psi(L) = A\\sin(kL) = 0\n$$\n为了得到非平庸解，我们必须有 $A \\neq 0$。因此，我们必须要求 $\\sin(kL) = 0$。这个条件将 $k$ 的可能取值量子化：\n$$\nkL = n\\pi, \\quad \\text{其中 } n \\text{ 是一个整数。}\n$$\n当 $n=0$ 时，得到 $k=0$ 和 $\\psi(x)=0$，这是被排除的平庸解。负整数（$n  0$）不会产生新的物理态，因为 $\\sin(-z) = -\\sin(z)$。得到的波函数 $\\psi_{-n}(x)$ 只是 $\\psi_{n}(x)$ 的一个常数倍（$-1$），代表相同的物理态。因此，我们将 $n$ 限制为正整数：$n = 1, 2, 3, \\ldots$。\n允许的 $k$ 值为 $k_{n} = \\frac{n\\pi}{L}$。将其代回 $k^{2}$ 的定义中：\n$$\nk_{n}^{2} = \\left(\\frac{n\\pi}{L}\\right)^{2} = \\frac{2mE_{n}}{\\hbar^{2}}\n$$\n求解能量本征值 $E_{n}$ 得到：\n$$\nE_{n} = \\frac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}, \\quad n = 1, 2, 3, \\ldots\n$$\n最后，我们对本征函数 $\\psi_{n}(x) = A\\sin(k_{n}x)$ 进行归一化。归一化常数 $A$ 由条件 $\\int_{0}^{L}|\\psi_{n}(x)|^{2}dx = 1$ 确定：\n$$\n\\int_{0}^{L} A^{2}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right)dx = 1\n$$\n使用三角恒等式 $\\sin^{2}(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$，积分变为：\n$$\nA^{2} \\int_{0}^{L} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right)dx = A^{2} \\frac{1}{2} \\left[x - \\frac{L}{2n\\pi}\\sin\\left(\\frac{2n\\pi x}{L}\\right)\\right]_{0}^{L}\n$$\n在积分上下限处计算表达式的值：\n$$\nA^{2} \\frac{1}{2} \\left(L - \\frac{L}{2n\\pi}\\sin(2n\\pi)\\right) - A^{2} \\frac{1}{2}(0) = A^{2}\\frac{L}{2} = 1\n$$\n这得到 $A^{2} = \\frac{2}{L}$。选择正实数根，我们有 $A = \\sqrt{\\frac{2}{L}}$。归一化后的定态本征函数为：\n$$\n\\psi_{n}(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right), \\quad n = 1, 2, 3, \\ldots\n$$\n\n3. 本征函数的完备性\n\n完备性问题由 Sturm-Liouville (S-L) 理论来解决。我们所解的本征值问题 $\\psi'' + \\lambda\\psi = 0$，附带条件 $\\psi(0)=0$ 和 $\\psi(L)=0$（其中 $\\lambda = k^2$），是一个正则 Sturm-Liouville 问题。一个普遍的正则 S-L 问题形式如下：\n$$\n\\frac{d}{dx}\\left(p(x)\\frac{dy}{dx}\\right) + q(x)y + \\lambda w(x)y = 0 \\quad \\text{在有限区间 } [a,b] \\text{ 上}\n$$\n具有分离的边界条件。在我们的情况中，区间是 $[0,L]$，我们可以确定 $p(x)=1$，$q(x)=0$，权重函数 $w(x)=1$。函数 $p(x)$ 和 $w(x)$ 在 $[0,L]$ 上是正的且连续的，因此该问题确实是正则的。\n\nSturm-Liouville 定理对此类问题作出了一些强有力的论断。它保证了存在一个无限的实数本征值序列 $\\lambda_1  \\lambda_2  \\dots  \\lambda_n  \\dots$，且 $\\lim_{n \\to \\infty} \\lambda_n = \\infty$。此外，它还指出，相应的本征函数 $\\{\\psi_n(x)\\}$ 构成了在区间 $[a,b]$ 上关于权重函数 $w(x)$ 的平方可积函数的希尔伯特空间的一个**完备正交基**。\n\n在我们的情境中，希尔伯特空间是 $L^{2}(0,L)$，即满足 $\\int_{0}^{L} |f(x)|^{2}dx$ 为有限值的函数 $f(x)$ 的空间。权重函数是 $w(x)=1$。集合 $\\{\\psi_n(x)\\}_{n=1}^{\\infty}$ 的完备性意味着任何任意函数 $f(x) \\in L^{2}(0,L)$ 都可以表示为这些本征函数的广义傅里叶级数展开：\n$$\nf(x) = \\sum_{n=1}^{\\infty} c_{n}\\psi_{n}(x)\n$$\n其中系数由投影给出：$c_{n} = \\langle \\psi_{n}, f \\rangle = \\int_{0}^{L} \\psi_{n}^{*}(x)f(x)dx$。\n\n此处相关的收敛意义是**均方收敛**，或称为 $L^{2}$-收敛。这意味着如果 $S_{N}(x) = \\sum_{n=1}^{N} c_{n}\\psi_{n}(x)$ 是级数的部分和，那么当 $N \\to \\infty$ 时，$f(x)$ 与 $S_{N}(x)$ 之差的范数趋于零：\n$$\n\\lim_{N \\to \\infty} \\left\\| f - S_{N} \\right\\|^{2} = \\lim_{N \\to \\infty} \\int_{0}^{L} \\left|f(x) - \\sum_{n=1}^{N} c_{n}\\psi_{n}(x)\\right|^{2}dx = 0\n$$\n这种数学上的完备性也是紧自伴算符谱定理的直接推论。具有指定定义域（包括边界条件 $\\psi(0)=\\psi(L)=0$）的哈密顿算符 $\\hat{H}$ 是 $L^2(0,L)$ 上的一个自伴算符。谱定理断言，这类算符的本征向量构成了该希尔伯特空间的一个完备正交基。本征函数 $\\psi_n(x)$ 正是这些本征向量。在物理上，这种完备性确保了粒子的任何允许的初始状态 $\\Psi(x,0) \\in L^{2}(0,L)$ 都可以表示为定态的线性叠加，从而可以完全确定其未来的时间演化。",
            "answer": "$$\n\\boxed{\\frac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}}\n$$"
        },
        {
            "introduction": "理想的量子阱提供了清晰的理论基准，但真实的纳米电子器件不可避免地存在杂质或缺陷。这项实践  引入了一种强大的分析工具——定态微扰理论，来研究这些不完美性的影响，此处将其简化为一个局域的 $\\delta$ 函数势。通过计算一级能量修正，您将学会如何量化杂质对量子阱电子子带的改变，从而连接理想模型与实际物理系统。",
            "id": "4308603",
            "problem": "一个有效质量为 $m^{\\ast}$ 的电子被限制在一个宽度为 $L$ 的一维半导体量子阱中，该量子阱由高能带偏移势垒形成，我们将其近似为在 $0  x  L$ 范围内的无限深势阱。问题是，求解由于一个点状杂质的存在而对 $n=2$ 能态造成的一级能量修正 $\\Delta E_2$。该杂质由势 $V_{\\text{imp}}(x) = -\\alpha\\delta(x - x_0)$ 建模，其中 $\\alpha > 0$，且杂质位于 $x_0 = L/3$。请用 $\\alpha$ 和 $L$ 表示你的答案。",
            "solution": "我们在有效质量近似（EMA）中对电子进行建模。总哈密顿量 $H=H_{0}+V_{\\text{imp}}$ 的稳态、不含时 Schrödinger 方程（time-independent Schrödinger equation, TISE）为\n$$\nH\\psi(x)=E\\psi(x),\\quad H_{0}=-\\frac{\\hbar^{2}}{2m^{\\ast}}\\frac{d^{2}}{dx^{2}},\\quad V_{\\text{imp}}(x)=-\\alpha\\,\\delta(x-x_{0}),\n$$\n边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$ 是由无限高势垒施加的。\n\n我们首先通过求解以下方程来获得未受微扰的本征函数和本征值\n$$\nH_{0}\\psi_{n}^{(0)}(x)=E_{n}^{(0)}\\psi_{n}^{(0)}(x),\\quad \\psi_{n}^{(0)}(0)=\\psi_{n}^{(0)}(L)=0.\n$$\n其解是无限深阱问题中的熟知结果：\n$$\n\\psi_{n}^{(0)}(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right),\\quad E_{n}^{(0)}=\\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m^{\\ast}L^{2}},\\quad n=1,2,3,\\dots\n$$\n这些本征函数在 $[0,L]$ 上构成一个规范正交基。\n\n给定一个弱微扰 $V_{\\text{imp}}(x)$ 和一个非简并的未受微扰能谱，不含时微扰理论中第 $n$ 个能态的一级能量修正是微扰在未受微扰态下的期望值：\n$$\n\\Delta E_{n}^{(1)}=\\int_{0}^{L}\\psi_{n}^{(0)}(x)^{\\ast}V_{\\text{imp}}(x)\\psi_{n}^{(0)}(x)\\,dx.\n$$\n代入 $V_{\\text{imp}}(x)=-\\alpha\\,\\delta(x-x_{0})$ 并利用 Dirac delta 分布的筛选性质，可得\n$$\n\\Delta E_{n}^{(1)}=-\\alpha\\left|\\psi_{n}^{(0)}(x_{0})\\right|^{2}.\n$$\n对于特定的杂质位置 $x_{0}=\\frac{L}{3}$ 和能态 $n=2$，我们计算\n$$\n\\psi_{2}^{(0)}\\!\\left(\\frac{L}{3}\\right)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{2\\pi}{3}\\right)=\\sqrt{\\frac{2}{L}}\\cdot\\frac{\\sqrt{3}}{2}.\n$$\n因此，\n$$\n\\left|\\psi_{2}^{(0)}\\!\\left(\\frac{L}{3}\\right)\\right|^{2}=\\frac{2}{L}\\sin^{2}\\!\\left(\\frac{2\\pi}{3}\\right)=\\frac{2}{L}\\cdot\\frac{3}{4}=\\frac{3}{2L}.\n$$\n因此，对 $n=2$ 能量的一级修正是\n$$\n\\Delta E_{2}^{(1)}=-\\alpha\\cdot\\frac{3}{2L}=-\\frac{3\\alpha}{2L}.\n$$\n这个负偏移反映了类施主 delta 势的吸引性质，它降低了束缚态的能量。结果按要求只用 $\\alpha$ 和 $L$ 表示。",
            "answer": "$$\\boxed{-\\frac{3\\alpha}{2L}}$$"
        },
        {
            "introduction": "随着我们不断探索纳米电子学的极限，简单的抛物线形能带模型（$E \\propto k^2$）往往不足以精确描述电子行为。这项练习  引导我们走向更真实的器件建模，引入了能带非抛物线性的概念，这在许多半导体中是一个关键效应。您将首先从解析上推导出修正后的子带能量，然后将此物理模型转化为计算程序，从而架起从理论洞察到实用模拟的关键桥梁。",
            "id": "4308499",
            "problem": "考虑一个限制在宽度为 $L$ 的纳米级一维量子阱中的电子，该量子阱代表了纳米电子学中的半导体异质结构。在有效质量近似下，电子在阱的界面处受到硬壁边界条件的作用，其定态由不含时薛定谔方程（TISE）决定。对于常规半导体，导带色散关系可能偏离纯粹的抛物线形式，尤其是在较高能量下。这种偏离可以通过一个经过充分检验的非抛物线模型来描述，该模型由一个以 $\\mathrm{eV}^{-1}$ 为单位的正数常量 $\\alpha$ 参数化。假设温度足够低，可以忽略声子效应，并忽略非抛物线修正之外的能带混合效应。\n\n您的任务是：\n- 从具有硬壁边界条件和有效质量近似的不含时薛定谔方程（TISE）出发，推导抛物线形导带的量子化波矢和子带能量。\n- 使用一个由单一参数 $\\alpha$（单位为 $\\mathrm{eV}^{-1}$）表征的、被广泛接受的非抛物线形导带模型，推导同一量子阱修正后的子带能量，并求出能量偏移 $\\Delta E_n$，其定义为给定子带指数 $n$ 时，非抛物线子带能量与抛物线子带能量之差。\n- 实现一个程序，为下面列出的每个测试用例计算以电子伏特（eV）为单位的 $\\Delta E_n$。使用国际单位制（SI）下的基本常数值 $\\hbar$（约化普朗克常数）和 $m_0$（电子静止质量）；最终结果以 $\\mathrm{eV}$ 表示，并四舍五入到六位小数。\n- 将有效质量 $m^\\ast$ 视为阱内的一个标量常数，其值为 $m_0$ 的一部分。将该阱视为宽度为 $L$（以纳米 nm 为单位）的无限深方势阱（硬壁边界条件）。子带指数 $n$ 是一个正整数。\n\n物理和数值单位：\n- 宽度 $L$ 以纳米（nm）为单位提供；计算时需转换为米（m）。\n- 有效质量以 $m^\\ast/m_0$ 的形式给出（无量纲）。\n- 非抛物线性参数 $\\alpha$ 以 $\\mathrm{eV}^{-1}$ 为单位给出。\n- 能量必须以电子伏特（eV）为单位报告，并四舍五入到六位小数。\n\n测试套件：\n为以下情况计算能量偏移 $\\Delta E_n$，每种情况由元组 $(L\\ \\mathrm{nm},\\ m^\\ast/m_0,\\ \\alpha\\ \\mathrm{eV}^{-1},\\ n)$ 定义：\n1. $(8.0,\\ 0.067,\\ 0.64,\\ 1)$\n2. $(8.0,\\ 0.067,\\ 0.64,\\ 2)$\n3. $(30.0,\\ 0.067,\\ 0.64,\\ 1)$\n4. $(10.0,\\ 0.067,\\ 0.0,\\ 1)$\n\n覆盖性设计：\n- 情况1是窄阱和中等非抛物线性的典型“理想路径”情况。\n- 情况2测试同一量子阱中更高的子带指数，此时非抛物线效应更强。\n- 情况3是宽阱，此时非抛物线性应较弱。\n- 情况4是边界条件 $\\alpha = 0$，此时能量偏移应为零。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4]”），每个结果都是以 $\\mathrm{eV}$ 为单位、四舍五入到六位小数的能量偏移 $\\Delta E_n$。",
            "solution": "该问题要求推导一维量子阱中由能带非抛物线性引起的能量偏移，并实现一个程序来为几个测试用例计算该偏移。推导和计算将分三个阶段进行：抛物线形能带情况的分析、非抛物线形能带情况的分析以及数值实现。\n\n### 步骤1：抛物线形导带的推导\n\n出发点是针对有效质量为 $m^\\ast$ 的电子在势 $V(x)$ 中的一维不含时薛定谔方程（TISE）：\n$$-\\frac{\\hbar^2}{2m^\\ast} \\frac{d^2\\psi(x)}{dx^2} + V(x) \\psi(x) = E \\psi(x)$$\n对于宽度为 $L$ 且具有硬壁（无限深势）边界条件的量子阱，势的定义如下：\n$$V(x) = \\begin{cases} 0  \\text{for } 0  x  L \\\\ \\infty  \\text{for } x \\le 0, x \\ge L \\end{cases}$$\n在阱内，$V(x) = 0$，TISE 简化为：\n$$\\frac{d^2\\psi(x)}{dx^2} = -\\frac{2m^\\ast E}{\\hbar^2} \\psi(x)$$\n这是一个简谐振子方程，可以写作 $\\frac{d^2\\psi(x)}{dx^2} + k^2\\psi(x) = 0$，其中波矢 $k$ 通过标准的抛物线色散关系与能量 $E$ 相关联：\n$$E = \\frac{\\hbar^2 k^2}{2m^\\ast}$$\n阱内波函数 $\\psi(x)$ 的通解为 $\\psi(x) = A\\sin(kx) + B\\cos(kx)$。硬壁边界条件要求波函数在阱的边缘处为零：\n1.  $\\psi(0) = 0 \\implies A\\sin(0) + B\\cos(0) = 0 \\implies B=0$。\n2.  $\\psi(L) = 0 \\implies A\\sin(kL) = 0$。\n\n为了得到非平凡解（$A \\neq 0$），必须有 $\\sin(kL) = 0$。这使得波矢 $k$ 的允许值被量子化：\n$$kL = n\\pi \\quad \\text{for} \\quad n = 1, 2, 3, \\dots$$\n因此，量子化的波矢为：\n$$k_n = \\frac{n\\pi}{L}$$\n将这些量子化的波矢代入抛物线色散关系，得到抛物线情况下的量子化子带能量，记为 $E_{p,n}$：\n$$E_{p,n} = \\frac{\\hbar^2 k_n^2}{2m^\\ast} = \\frac{\\hbar^2 \\pi^2 n^2}{2m^\\ast L^2}$$\n\n### 步骤2：非抛物线形导带的推导\n\n问题引入了对能带结构的非抛物线性修正，由参数 $\\alpha$ 描述。一个可从 k·p 理论推导出的、广泛使用的非抛物线性模型将能量和波矢关联如下：\n$$E(1 + \\alpha E) = \\frac{\\hbar^2 k^2}{2m^\\ast}$$\n在这里，$m^\\ast$ 是带边（$k=0$）的有效质量，$\\alpha$ 是非抛物线性参数。关键在于，边界条件是由势 $V(x)$ 决定的，而不是由能量-动量色散关系决定的。因此，波矢的量子化条件保持不变：\n$$k_n = \\frac{n\\pi}{L}$$\n我们可以将量子化的波矢 $k_n$ 代入非抛物线色散关系中，来求得非抛物线能量 $E_{np,n}$：\n$$E_{np,n}(1 + \\alpha E_{np,n}) = \\frac{\\hbar^2 k_n^2}{2m^\\ast}$$\n该方程的右侧恰好是抛物线能量 $E_{p,n}$ 的表达式。因此，对于给定的子带指数 $n$，我们在抛物线能量和非抛物线能量之间建立了一个直接关系：\n$$E_{np,n}(1 + \\alpha E_{np,n}) = E_{p,n}$$\n这可以重写为关于 $E_{np,n}$ 的二次方程：\n$$\\alpha E_{np,n}^2 + E_{np,n} - E_{p,n} = 0$$\n使用二次公式求解 $E_{np,n}$，得到：\n$$E_{np,n} = \\frac{-1 \\pm \\sqrt{1 - 4(\\alpha)(-E_{p,n})}}{2\\alpha} = \\frac{-1 \\pm \\sqrt{1 + 4\\alpha E_{p,n}}}{2\\alpha}$$\n由于能量必须是正值（$E_{p,n} > 0$ 且 $\\alpha \\ge 0$），我们必须选择正根以确保 $E_{np,n} > 0$。因此，修正后的子带能量为：\n$$E_{np,n} = \\frac{\\sqrt{1 + 4\\alpha E_{p,n}} - 1}{2\\alpha}$$\n此公式在 $\\alpha > 0$ 时有效。在 $\\alpha = 0$ 的情况下，模型回到抛物线情况，且 $E_{np,n} = E_{p,n}$。这一点可以通过使用洛必达法则（L'Hôpital's rule）求 $\\alpha \\to 0$ 时的极限来证实。\n\n能量偏移 $\\Delta E_n$ 定义为非抛物线能量和抛物线能量之差：\n$$\\Delta E_n = E_{np,n} - E_{p,n} = \\left( \\frac{\\sqrt{1 + 4\\alpha E_{p,n}} - 1}{2\\alpha} \\right) - E_{p,n}$$\n对于 $\\alpha=0$，$\\Delta E_n = 0$。对于 $\\alpha > 0$，由于当 $x > 0$ 时有 $\\sqrt{1+x}  1+x/2$，可以证明 $E_{np,n}  E_{p,n}$，从而导致负的能量偏移。这意味着与纯抛物线近似相比，非抛物线修正降低了能级。\n\n### 步骤3：计算方法\n\n数值计算将按以下步骤执行：\n1.  定义国际单位制（SI）中的基本物理常数：$\\hbar = 1.054571817 \\times 10^{-34}$ J·s， $m_0 = 9.1093837015 \\times 10^{-31}$ kg，以及用于能量单位转换的基本电荷 $e = 1.602176634 \\times 10^{-19}$ C。\n2.  对于每个测试用例 $(L\\ [\\mathrm{nm}],\\ m^\\ast/m_0,\\ \\alpha\\ [\\mathrm{eV}^{-1}],\\ n)$：\n    a. 将给定参数转换为国际单位制（SI）：将 $L$ 从 nm 转换为 m（$L \\times 10^{-9}$），并计算有效质量（单位为 kg）（$m^\\ast = (m^\\ast/m_0) \\times m_0$）。\n    b. 使用 $E_{p,n} = \\frac{\\hbar^2 \\pi^2 n^2}{2m^\\ast L^2}$ 计算以焦耳为单位的抛物线能量 $E_{p,n}$。\n    c. 通过除以基本电荷 $e$ 将 $E_{p,n}$ 转换为电子伏特（eV）。\n    d. 检查非抛物线性参数 $\\alpha$ 是否为零。如果 $\\alpha=0$，则能量偏移 $\\Delta E_n$ 精确为 $0$。\n    e. 如果 $\\alpha > 0$，使用以 eV 为单位的 $E_{p,n}$ 值和以 $\\mathrm{eV}^{-1}$ 为单位的给定 $\\alpha$ 值，通过推导出的公式计算以 eV 为单位的 $E_{np,n}$。\n    f. 计算以 eV 为单位的能量偏移 $\\Delta E_n = E_{np,n} - E_{p,n}$。\n    g. 按要求将 $\\Delta E_n$ 的最终结果四舍五入到六位小数。\n将对所有提供的测试用例执行此程序，以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Computes the energy shift due to band nonparabolicity in a 1D quantum well.\n    \"\"\"\n    # Define test cases: (L in nm, m*/m0, alpha in eV^-1, n)\n    test_cases = [\n        (8.0, 0.067, 0.64, 1),\n        (8.0, 0.067, 0.64, 2),\n        (30.0, 0.067, 0.64, 1),\n        (10.0, 0.067, 0.0, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        L_nm, m_star_ratio, alpha_ev_inv, n = case\n        result = calculate_energy_shift(L_nm, m_star_ratio, alpha_ev_inv, n)\n        results.append(result)\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_energy_shift(L_nm, m_star_ratio, alpha_ev_inv, n):\n    \"\"\"\n    Calculates the energy shift Delta_En for a given set of parameters.\n\n    Args:\n        L_nm (float): Well width in nanometers.\n        m_star_ratio (float): Effective mass as a fraction of electron rest mass.\n        alpha_ev_inv (float): Nonparabolicity parameter in eV^-1.\n        n (int): Subband index.\n\n    Returns:\n        float: The energy shift Delta_En in eV, rounded to six decimal places.\n    \"\"\"\n    # Physical constants from scipy.constants in SI units\n    hbar = constants.hbar        # J * s\n    m0 = constants.m_e           # kg\n    e = constants.elementary_charge # C\n\n    # Convert inputs to SI units for calculation\n    L = L_nm * 1e-9  # meters\n    m_star = m_star_ratio * m0  # kg\n\n    # Calculate the parabolic subband energy in Joules\n    # E_p_n = (hbar^2 * pi^2 * n^2) / (2 * m* * L^2)\n    E_p_J = (hbar**2 * np.pi**2 * n**2) / (2 * m_star * L**2)\n\n    # Convert parabolic energy to electronvolts (eV)\n    E_p_eV = E_p_J / e\n\n    # Handle the parabolic case (alpha = 0) to avoid division by zero\n    if alpha_ev_inv == 0.0:\n        delta_E_eV = 0.0\n    else:\n        # Calculate the nonparabolic subband energy in eV\n        # Formula: E_np = (sqrt(1 + 4*alpha*E_p) - 1) / (2*alpha)\n        # Note: E_p_eV must be used here as alpha is in eV^-1\n        term_in_sqrt = 1 + 4 * alpha_ev_inv * E_p_eV\n        E_np_eV = (np.sqrt(term_in_sqrt) - 1) / (2 * alpha_ev_inv)\n\n        # The energy shift is the difference between nonparabolic and parabolic energies\n        delta_E_eV = E_np_eV - E_p_eV\n\n    # Round the final result to six decimal places as specified\n    return round(delta_E_eV, 6)\n\nsolve()\n```"
        }
    ]
}