{
    "hands_on_practices": [
        {
            "introduction": "The first step toward understanding any crystalline material is to correctly identify its underlying symmetry, as captured by its Bravais lattice. This classification is not merely an academic exercise; it governs selection rules in spectroscopy, the anisotropy of transport properties, and the fundamental form of the electronic band structure. This practice will sharpen your skill in deducing a crystal's Bravais lattice type directly from its geometric parameters, a foundational ability for materials analysis .",
            "id": "4265800",
            "problem": "In nanoelectronics and emerging semiconductor materials, the Bravais lattice classification of a crystalline substrate or film constrains its electronic band symmetries and anisotropies, which in turn determine carrier transport and valley degeneracy. A Bravais lattice is defined by a set of primitive translation vectors whose metric parameters are conventionally summarized as lattice parameters $a$, $b$, $c$ and interaxial angles $\\alpha$, $\\beta$, $\\gamma$. The identification of the Bravais lattice type must be derived from the metric constraints (equalities among $a$, $b$, $c$ and special values of $\\alpha$, $\\beta$, $\\gamma$) together with the presence or absence of centering (primitive, body-centered, face-centered, base-centered, rhombohedral centering in a hexagonal setting). Consider three candidate crystalline substrates that could serve as templates for epitaxial growth of two-dimensional semiconductors. Each candidate is described by its conventional cell parameters and centering:\n\n- Case I: $a = 3.905\\ \\text{\\AA}$, $b = 3.905\\ \\text{\\AA}$, $c = 4.150\\ \\text{\\AA}$, $\\alpha = 90^\\circ$, $\\beta = 90^\\circ$, $\\gamma = 90^\\circ$, with body-centering present (one additional lattice point at the center of the conventional cell).\n- Case II: $a = 2.500\\ \\text{\\AA}$, $b = 2.500\\ \\text{\\AA}$, $c = 6.500\\ \\text{\\AA}$, $\\alpha = 90^\\circ$, $\\beta = 90^\\circ$, $\\gamma = 120^\\circ$, with no centering (primitive cell).\n- Case III: $a = 5.400\\ \\text{\\AA}$, $b = 6.100\\ \\text{\\AA}$, $c = 7.200\\ \\text{\\AA}$, $\\alpha = 90^\\circ$, $\\beta = 90^\\circ$, $\\gamma = 90^\\circ$, with face-centering present (lattice points at the centers of all faces of the conventional cell).\n\nUsing only fundamental definitions of Bravais lattices based on metric constraints and centering, deduce the Bravais lattice type for each case and justify each decision. Choose the option that provides the correct identification for all three cases.\n\nA. Case I: tetragonal body-centered; Case II: hexagonal primitive; Case III: orthorhombic face-centered\n\nB. Case I: cubic body-centered; Case II: hexagonal primitive; Case III: orthorhombic face-centered\n\nC. Case I: tetragonal body-centered; Case II: trigonal (rhombohedral) $R$-centered; Case III: cubic face-centered\n\nD. Case I: tetragonal primitive; Case II: hexagonal primitive; Case III: orthorhombic primitive\n\nE. Case I: tetragonal body-centered; Case II: hexagonal primitive; Case III: monoclinic base-centered",
            "solution": "The problem statement is first validated for scientific soundness, self-consistency, and clarity before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem provides data for three candidate crystalline structures, described by their conventional cell parameters ($a$, $b$, $c$, $\\alpha$, $\\beta$, $\\gamma$) and centering type.\n\n- **Case I:**\n    - Lattice parameters: $a = 3.905\\ \\text{\\AA}$, $b = 3.905\\ \\text{\\AA}$, $c = 4.150\\ \\text{\\AA}$\n    - Interaxial angles: $\\alpha = 90^\\circ$, $\\beta = 90^\\circ$, $\\gamma = 90^\\circ$\n    - Centering: Body-centered (one additional lattice point at the center of the conventional cell).\n\n- **Case II:**\n    - Lattice parameters: $a = 2.500\\ \\text{\\AA}$, $b = 2.500\\ \\text{\\AA}$, $c = 6.500\\ \\text{\\AA}$\n    - Interaxial angles: $\\alpha = 90^\\circ$, $\\beta = 90^\\circ$, $\\gamma = 120^\\circ$\n    - Centering: Primitive (no centering).\n\n- **Case III:**\n    - Lattice parameters: $a = 5.400\\ \\text{\\AA}$, $b = 6.100\\ \\text{\\AA}$, $c = 7.200\\ \\text{\\AA}$\n    - Interaxial angles: $\\alpha = 90^\\circ$, $\\beta = 90^\\circ$, $\\gamma = 90^\\circ$\n    - Centering: Face-centered (lattice points at the centers of all faces of the conventional cell).\n\nThe task is to deduce the Bravais lattice type for each of the three cases based on these fundamental definitions.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem is firmly rooted in the fundamental principles of crystallography and solid-state physics. The classification of Bravais lattices is a cornerstone of these fields. The given parameters are physically realistic for atomic-scale structures.\n2.  **Well-Posed:** The problem provides a complete set of metric parameters and centering information for each case. This information is sufficient and necessary to uniquely determine the Bravais lattice type according to standard crystallographic conventions. A unique and meaningful solution exists for each case.\n3.  **Objective:** The problem is stated using precise, unambiguous technical language. The parameters and definitions are objective and not subject to interpretation.\n\nThe problem statement passes all validation criteria. It is scientifically sound, well-posed, and objective. There are no logical contradictions, missing information, or factual errors.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A full solution will be derived.\n\n### Derivation and Analysis\n\nThe identification of a Bravais lattice relies on two components: the crystal system, which is determined by the rotational symmetries implied by the metric parameters of the conventional cell, and the centering type (P, I, F, C, R).\n\n**Analysis of Case I**\n\n-   **Metric Constraints:** The provided parameters are $a = b = 3.905\\ \\text{\\AA}$ and $c = 4.150\\ \\text{\\AA}$, so $a=b \\neq c$. The angles are $\\alpha = \\beta = \\gamma = 90^\\circ$. A lattice with three mutually perpendicular axes where two are of equal length belongs to the **tetragonal** crystal system. The conditions for other orthogonal systems are not met: for cubic, it would require $a=b=c$; for orthorhombic, it would require $a \\neq b \\neq c$ (in the general case).\n-   **Centering:** The problem specifies that the cell is **body-centered (I)**.\n-   **Conclusion:** The combination of a tetragonal system with body-centering defines the **tetragonal body-centered** Bravais lattice. This is one of the $14$ unique Bravais lattices.\n\n**Analysis of Case II**\n\n-   **Metric Constraints:** The parameters are $a = b = 2.500\\ \\text{\\AA}$ and $c = 6.500\\ \\text{\\AA}$, so $a=b \\neq c$. The angles are $\\alpha = \\beta = 90^\\circ$ and $\\gamma = 120^\\circ$. These are the defining metric relations for the conventional unit cell of the **hexagonal** crystal system. A trigonal lattice can also be described with a hexagonal cell, but this requires a specific rhombohedral centering.\n-   **Centering:** The problem specifies a **primitive (P)** cell with no centering.\n-   **Conclusion:** The combination of a hexagonal system with primitive centering defines the **hexagonal primitive** Bravais lattice. This is the only Bravais lattice in the hexagonal system.\n\n**Analysis of Case III**\n\n-   **Metric Constraints:** The parameters are $a = 5.400\\ \\text{\\AA}$, $b = 6.100\\ \\text{\\AA}$, and $c = 7.200\\ \\text{\\AA}$, such that $a \\neq b \\neq c$. The angles are $\\alpha = \\beta = \\gamma = 90^\\circ$. A lattice with three mutually perpendicular axes of unequal lengths belongs to the **orthorhombic** crystal system.\n-   **Centering:** The problem specifies that the cell is **face-centered (F)**.\n-   **Conclusion:** The combination of an orthorhombic system with face-centering defines the **orthorhombic face-centered** Bravais lattice. This is one of the four distinct Bravais lattices in the orthorhombic system (Primitive, Body-centered, Face-centered, and Base-centered).\n\n### Option-by-Option Evaluation\n\n-   **A. Case I: tetragonal body-centered; Case II: hexagonal primitive; Case III: orthorhombic face-centered**\n    -   Case I: Matches our derivation of tetragonal body-centered.\n    -   Case II: Matches our derivation of hexagonal primitive.\n    -   Case III: Matches our derivation of orthorhombic face-centered.\n    -   This option correctly identifies all three lattices.\n    -   Verdict: **Correct**.\n\n-   **B. Case I: cubic body-centered; Case II: hexagonal primitive; Case III: orthorhombic face-centered**\n    -   Case I: Incorrectly identifies the lattice as cubic body-centered. For a cubic lattice, the condition is $a=b=c$. In this case, $a=b \\neq c$ ($3.905\\ \\text{\\AA} \\neq 4.150\\ \\text{\\AA}$), which defines a tetragonal system.\n    -   Verdict: **Incorrect**.\n\n-   **C. Case I: tetragonal body-centered; Case II: trigonal (rhombohedral) $R$-centered; Case III: cubic face-centered**\n    -   Case II: Incorrectly identifies the lattice as trigonal ($R$-centered). A trigonal lattice described in a hexagonal setting has rhombohedral ($R$) centering. The problem specifies a primitive ($P$) cell, which, with hexagonal metric constraints, defines the hexagonal Bravais lattice.\n    -   Case III: Incorrectly identifies the lattice as cubic face-centered. A cubic lattice requires $a=b=c$. In this case, $a \\neq b \\neq c$ ($5.400\\ \\text{\\AA} \\neq 6.100\\ \\text{\\AA} \\neq 7.200\\ \\text{\\AA}$), which defines an orthorhombic system.\n    -   Verdict: **Incorrect**.\n\n-   **D. Case I: tetragonal primitive; Case II: hexagonal primitive; Case III: orthorhombic primitive**\n    -   Case I: Incorrectly identifies the centering as primitive. The problem explicitly states the lattice is body-centered.\n    -   Case III: Incorrectly identifies the centering as primitive. The problem explicitly states the lattice is face-centered.\n    -   Verdict: **Incorrect**.\n\n-   **E. Case I: tetragonal body-centered; Case II: hexagonal primitive; Case III: monoclinic base-centered**\n    -   Case III: Incorrectly identifies the crystal system as monoclinic and the centering as base-centered. A monoclinic system has metric constraints $\\alpha = \\gamma = 90^\\circ, \\beta \\neq 90^\\circ$ (by convention). The given parameters are $\\alpha = \\beta = \\gamma = 90^\\circ$, which define an orthorhombic system. Furthermore, the problem specifies face-centering, not base-centering.\n    -   Verdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The behavior of electrons and phonons in a crystal is best described in reciprocal space, where the first Brillouin zone (BZ) serves as the fundamental domain for wave vectors, denoted by $k$. This exercise provides essential practice in making the transition from a real-space lattice description to its reciprocal-space counterpart. By deriving the reciprocal lattice and constructing the first Brillouin zone for a 2D hexagonal lattice—a structure of immense importance for materials like graphene—you will build a concrete understanding of how real-space geometry dictates the arena for electronic property calculations .",
            "id": "4265827",
            "problem": "In nanoelectronics, two-dimensional materials such as graphene and transition-metal dichalcogenide monolayers are analyzed using their Bravais lattices and the associated reciprocal lattices to understand electron wave vectors and energy band structures. Consider a two-dimensional hexagonal (triangular) Bravais lattice with primitive direct lattice vectors $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$ satisfying $|\\mathbf{a}_{1}| = |\\mathbf{a}_{2}| = a$ and an inter-vector angle $\\gamma = 120^{\\circ}$. Starting from the fundamental definition of the reciprocal lattice as the dual basis to the direct lattice, namely $ \\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2\\pi \\delta_{ij}$ for $i,j \\in \\{1,2\\}$ where $\\delta_{ij}$ is the Kronecker delta, derive explicit closed-form expressions for the reciprocal lattice primitive vectors $\\mathbf{b}_{1}$ and $\\mathbf{b}_{2}$ in Cartesian coordinates. Then, using the Wigner–Seitz construction and the geometric property that the first Brillouin zone (BZ) of a triangular lattice is a regular hexagon centered at the origin formed by perpendicular bisectors of the vectors to the six nearest reciprocal lattice points, deduce the side length $L_{\\mathrm{BZ}}$ of this hexagon in terms of $a$. Your derivation must proceed from the stated dual-basis definition and basic Euclidean geometry; do not invoke any undeclared shortcut formulas. Treat $a$ as a symbolic positive length parameter.\n\nReport as your final answer only the analytic expression for the hexagon side length $L_{\\mathrm{BZ}}$ in terms of $a$. Express the side length in reciprocal length units (for example, $\\mathrm{m}^{-1}$ if $a$ is in $\\mathrm{m}$). No numerical substitution is required and no rounding is permitted.",
            "solution": "The user wants to find the side length of the first Brillouin Zone (BZ) for a two-dimensional hexagonal lattice. The validation process confirms that the problem is scientifically sound, well-posed, and contains all necessary information for a unique solution.\n\nThe derivation proceeds in two main stages: first, determining the reciprocal lattice vectors from the direct lattice vectors, and second, using the geometry of the Wigner-Seitz cell of the reciprocal lattice to find the side length of the resulting hexagonal BZ.\n\n**Part 1: Derivation of the Reciprocal Lattice Vectors**\n\nThe problem defines a 2D hexagonal Bravais lattice with primitive direct lattice vectors $\\mathbf{a}_1$ and $\\mathbf{a}_2$ such that their magnitudes are equal, $|\\mathbf{a}_1| = |\\mathbf{a}_2| = a$, and the angle between them is $\\gamma = 120^{\\circ}$.\n\nTo perform calculations, we first express these vectors in a Cartesian coordinate system. Let $\\mathbf{a}_1$ be aligned with the $x$-axis.\n$$\n\\mathbf{a}_1 = a(1, 0) = (a, 0)\n$$\nThe vector $\\mathbf{a}_2$ is then at an angle of $120^{\\circ}$ with respect to $\\mathbf{a}_1$.\n$$\n\\mathbf{a}_2 = a(\\cos(120^{\\circ}), \\sin(120^{\\circ})) = a(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}) = (-\\frac{a}{2}, \\frac{a\\sqrt{3}}{2})\n$$\n\nThe reciprocal lattice primitive vectors, $\\mathbf{b}_1$ and $\\mathbf{b}_2$, are defined by the relation $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. Let the reciprocal vectors in the same Cartesian basis be $\\mathbf{b}_1 = (b_{1x}, b_{1y})$ and $\\mathbf{b}_2 = (b_{2x}, b_{2y})$. We can solve for their components using the four equations from the defining relation.\n\n1.  $\\mathbf{a}_1 \\cdot \\mathbf{b}_1 = 2\\pi$:\n    $$\n    (a, 0) \\cdot (b_{1x}, b_{1y}) = a b_{1x} = 2\\pi \\implies b_{1x} = \\frac{2\\pi}{a}\n    $$\n2.  $\\mathbf{a}_1 \\cdot \\mathbf{b}_2 = 0$:\n    $$\n    (a, 0) \\cdot (b_{2x}, b_{2y}) = a b_{2x} = 0 \\implies b_{2x} = 0\n    $$\n3.  $\\mathbf{a}_2 \\cdot \\mathbf{b}_1 = 0$:\n    $$\n    (-\\frac{a}{2}, \\frac{a\\sqrt{3}}{2}) \\cdot (b_{1x}, b_{1y}) = (-\\frac{a}{2}) b_{1x} + (\\frac{a\\sqrt{3}}{2}) b_{1y} = 0\n    $$\n    Substituting $b_{1x} = \\frac{2\\pi}{a}$:\n    $$\n    (-\\frac{a}{2}) (\\frac{2\\pi}{a}) + (\\frac{a\\sqrt{3}}{2}) b_{1y} = 0 \\implies -\\pi + \\frac{a\\sqrt{3}}{2} b_{1y} = 0 \\implies b_{1y} = \\frac{2\\pi}{a\\sqrt{3}}\n    $$\n4.  $\\mathbf{a}_2 \\cdot \\mathbf{b}_2 = 2\\pi$:\n    $$\n    (-\\frac{a}{2}, \\frac{a\\sqrt{3}}{2}) \\cdot (b_{2x}, b_{2y}) = (-\\frac{a}{2}) b_{2x} + (\\frac{a\\sqrt{3}}{2}) b_{2y} = 2\\pi\n    $$\n    Substituting $b_{2x} = 0$:\n    $$\n    0 + (\\frac{a\\sqrt{3}}{2}) b_{2y} = 2\\pi \\implies b_{2y} = \\frac{4\\pi}{a\\sqrt{3}}\n    $$\n\nCombining these components, we find the explicit expressions for the reciprocal lattice vectors:\n$$\n\\mathbf{b}_1 = \\left(\\frac{2\\pi}{a}, \\frac{2\\pi}{a\\sqrt{3}}\\right)\n$$\n$$\n\\mathbf{b}_2 = \\left(0, \\frac{4\\pi}{a\\sqrt{3}}\\right)\n$$\n\nThe reciprocal lattice of a hexagonal lattice is also a hexagonal lattice. To verify this, we calculate the magnitudes of $\\mathbf{b}_1$ and $\\mathbf{b}_2$ and the angle between them.\n$$\n|\\mathbf{b}_1|^2 = \\left(\\frac{2\\pi}{a}\\right)^2 + \\left(\\frac{2\\pi}{a\\sqrt{3}}\\right)^2 = \\frac{4\\pi^2}{a^2} + \\frac{4\\pi^2}{3a^2} = \\frac{12\\pi^2 + 4\\pi^2}{3a^2} = \\frac{16\\pi^2}{3a^2}\n$$\n$$\n|\\mathbf{b}_2|^2 = 0^2 + \\left(\\frac{4\\pi}{a\\sqrt{3}}\\right)^2 = \\frac{16\\pi^2}{3a^2}\n$$\nThus, the magnitudes are equal: $|\\mathbf{b}_1| = |\\mathbf{b}_2| = \\frac{4\\pi}{a\\sqrt{3}}$. Let's denote this common magnitude as $b$.\nThe angle $\\theta$ between $\\mathbf{b}_1$ and $\\mathbf{b}_2$ is given by:\n$$\n\\cos(\\theta) = \\frac{\\mathbf{b}_1 \\cdot \\mathbf{b}_2}{|\\mathbf{b}_1||\\mathbf{b}_2|} = \\frac{(2\\pi/a)(0) + (2\\pi/(a\\sqrt{3}))(4\\pi/(a\\sqrt{3}))}{16\\pi^2/(3a^2)} = \\frac{8\\pi^2/(3a^2)}{16\\pi^2/(3a^2)} = \\frac{1}{2}\n$$\nSo, the angle is $\\theta = 60^{\\circ}$. This confirms that the reciprocal lattice is also a hexagonal (triangular) lattice, with primitive vectors of length $b = \\frac{4\\pi}{a\\sqrt{3}}$ and an inter-vector angle of $60^{\\circ}$.\n\n**Part 2: Geometry of the First Brillouin Zone**\n\nThe first Brillouin zone is defined as the Wigner-Seitz cell of the reciprocal lattice. It is the region of space closer to the origin (the $\\Gamma$ point) than to any other reciprocal lattice point. The BZ is therefore bounded by the planes (or lines in 2D) that are the perpendicular bisectors of the vectors from the origin to the nearest-neighbor reciprocal lattice points.\n\nThe nearest-neighbor reciprocal lattice points are those generated by the primitive vectors, such as $\\pm \\mathbf{b}_1$, $\\pm \\mathbf{b}_2$, and their sums/differences like $\\pm(\\mathbf{b}_1 - \\mathbf{b}_2)$. For the hexagonal lattice, there are six such nearest neighbors, all at the same distance $b = |\\mathbf{b}_1|$ from the origin. These six points form a regular hexagon. The perpendicular bisectors of the vectors to these six points form another regular hexagon centered at the origin, which is the first Brillouin zone.\n\nLet $L_{\\mathrm{BZ}}$ be the side length of this hexagonal Brillouin zone. The geometry of a regular hexagon relates its side length $L_{\\mathrm{BZ}}$ to the perpendicular distance $d$ from the center to the midpoint of a side. This relation is $d = L_{\\mathrm{BZ}} \\cos(30^\\circ) = L_{\\mathrm{BZ}} \\frac{\\sqrt{3}}{2}$.\n\nThe distance $d$ is precisely half the length of the vector connecting the origin to a nearest-neighbor reciprocal lattice point. Let's take any of a nearest neighbor vector, say $\\mathbf{G}$. The distance to this point is $|\\mathbf{G}| = b$. The perpendicular bisector line is at a distance $d = \\frac{1}{2}|\\mathbf{G}| = \\frac{b}{2}$ from the origin.\n\nBy equating the two expressions for $d$, we can solve for $L_{\\mathrm{BZ}}$:\n$$\nL_{\\mathrm{BZ}} \\frac{\\sqrt{3}}{2} = \\frac{b}{2}\n$$\n$$\nL_{\\mathrm{BZ}} = \\frac{b}{\\sqrt{3}}\n$$\n\nFinally, we substitute the expression we derived for $b$:\n$$\nL_{\\mathrm{BZ}} = \\frac{1}{\\sqrt{3}} \\left( \\frac{4\\pi}{a\\sqrt{3}} \\right) = \\frac{4\\pi}{a(\\sqrt{3})^2} = \\frac{4\\pi}{3a}\n$$\nThis is the analytic expression for the side length of the first Brillouin zone. The units are reciprocal length, consistent with the space of wave vectors.",
            "answer": "$$\n\\boxed{\\frac{4\\pi}{3a}}\n$$"
        },
        {
            "introduction": "Theoretical concepts become powerful tools when they are implemented computationally to predict material properties. This practice bridges the gap between abstract crystallographic theory and practical, quantitative analysis by guiding you through the implementation of a Monkhorst-Pack integration scheme . By tackling this coding challenge, you will develop a hands-on mastery of how to perform numerical integrals over the Brillouin zone for various lattices, a technique essential for calculating physical observables like the density of states or total energy.",
            "id": "4265784",
            "problem": "You are to implement a complete program that, for specified Bravais lattices, constructs Monkhorst-Pack (MP) grids in reciprocal space and estimates the error of numerical Brillouin zone integrals as a function of mesh density. The required final output is a single line containing a comma-separated list of relative errors, one per test case, enclosed in square brackets. The problem must be solved from first principles, starting from the definitions of a Bravais lattice, its reciprocal lattice, the Brillouin zone, and the construction of uniform sampling grids consistent with translational symmetry.\n\nDefinitions and foundational base to be used:\n- A Bravais lattice in real space is generated by primitive vectors $\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3$ in three dimensions (and analogously for two dimensions), forming the set $\\mathcal{L} = \\{n_1 \\mathbf{a}_1 + n_2 \\mathbf{a}_2 + n_3 \\mathbf{a}_3 \\mid n_i \\in \\mathbb{Z}\\}$. In two dimensions, only $\\mathbf{a}_1, \\mathbf{a}_2$ appear.\n- The reciprocal lattice is defined by primitive vectors $\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3$ satisfying $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$. If $\\mathbf{A}$ is the matrix whose columns are $\\mathbf{a}_i$, then the reciprocal matrix $\\mathbf{B}$ whose columns are $\\mathbf{b}_i$ satisfies $\\mathbf{A}^\\top \\mathbf{B} = 2\\pi \\mathbf{I}$, equivalently $\\mathbf{B} = 2\\pi (\\mathbf{A}^{-1})^\\top$, where $\\mathbf{I}$ is the identity matrix. The reciprocal primitive cell volume (or area in two dimensions) is $V^\\star = |\\det \\mathbf{B}|$.\n- The first Brillouin zone is the Wigner-Seitz cell of the reciprocal lattice. For functions $\\mathbf{k} \\mapsto f(\\mathbf{k})$ that are periodic with respect to the reciprocal lattice, integrals over the first Brillouin zone can be performed over any reciprocal primitive cell due to periodicity.\n- A uniform sampling consistent with translational symmetry in the reciprocal primitive cell can be constructed by dividing each reciprocal primitive direction into $N_i$ equal segments and placing sample points at midpoints to avoid boundary ambiguity and preserve inversion symmetry. This is the Monkhorst-Pack (MP) concept. If $\\mathbf{b}_i$ are the reciprocal primitive vectors, and $u_i$ are reduced coordinates along each reciprocal primitive direction, the sampling points are in reduced coordinates and the corresponding $\\mathbf{k}$-points are obtained via the linear map $\\mathbf{k} = \\sum_i u_i \\mathbf{b}_i$. Equal weights are appropriate for a uniform midpoint rule on a periodic, smooth integrand.\n\nYou will:\n- Construct MP grids in reduced coordinates $u_i$ and map them to $\\mathbf{k}$-space via the reciprocal primitive vectors.\n- Consider the separable, analytic, lattice-periodic integrand $f(\\mathbf{k}) = \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big)$, where $d$ is the spatial dimension, $\\beta$ is a real parameter, and $u_i$ are reduced coordinates defined by $\\mathbf{k} = \\mathbf{B} \\mathbf{u}$ with $\\mathbf{u} \\in [-\\tfrac{1}{2}, \\tfrac{1}{2})^d$. Angles in $\\cos(\\cdot)$ are in radians.\n- Compute the exact integral over the reciprocal primitive cell using the Jacobian of the coordinate transformation. Use the well-tested identity $\\int_{0}^{1} \\exp\\!\\big(\\beta \\cos(2\\pi u)\\big) \\, du = I_0(\\beta)$, where $I_0$ is the modified Bessel function of the first kind of order zero. Thus, the exact integral is $I_{\\mathrm{exact}} = V^\\star \\, [I_0(\\beta)]^d$.\n- Approximate the integral using the MP grid by the uniform midpoint rule on reduced coordinates, i.e., $I_{\\mathrm{MP}} = V^\\star \\, \\frac{1}{\\prod_i N_i} \\sum_{\\text{grid}} f(\\mathbf{k})$, with equal weights.\n- For each test case, compute the relative error $E = \\big|I_{\\mathrm{MP}} - I_{\\mathrm{exact}}\\big|/I_{\\mathrm{exact}}$ as a dimensionless decimal number.\n\nTest suite and parameter values to be used:\n- All lattice constants given in nanometers must be used in meters in the program. The program must perform the conversion internally. No other physical units are required in the output because the relative error is dimensionless.\n- Two-dimensional square lattice:\n  - Case $\\mathrm{T1}$: lattice constant $a = 0.3 \\,\\mathrm{nm}$, mesh $(N_1, N_2) = (1, 1)$, parameter $\\beta = 0.7$.\n  - Case $\\mathrm{T2}$: lattice constant $a = 0.3 \\,\\mathrm{nm}$, mesh $(N_1, N_2) = (4, 4)$, parameter $\\beta = 0.7$.\n  - Case $\\mathrm{T3}$: lattice constant $a = 0.3 \\,\\mathrm{nm}$, mesh $(N_1, N_2) = (16, 16)$, parameter $\\beta = 0.7$.\n- Two-dimensional triangular (hexagonal) lattice:\n  - Case $\\mathrm{T4}$: primitive real-space vectors $\\mathbf{a}_1 = a(1,0)$, $\\mathbf{a}_2 = a(\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2})$ with $a = 0.25 \\,\\mathrm{nm}$, mesh $(N_1, N_2) = (5, 5)$, parameter $\\beta = 0.7$.\n- Three-dimensional simple cubic lattice:\n  - Case $\\mathrm{T5}$: lattice constant $a = 0.5 \\,\\mathrm{nm}$, mesh $(N_1, N_2, N_3) = (2, 2, 2)$, parameter $\\beta = 0.5$.\n  - Case $\\mathrm{T6}$: lattice constant $a = 0.5 \\,\\mathrm{nm}$, mesh $(N_1, N_2, N_3) = (8, 8, 8)$, parameter $\\beta = 0.5$.\n- Three-dimensional body-centered cubic lattice (using primitive real-space vectors):\n  - Case $\\mathrm{T7}$: $\\mathbf{a}_1 = \\tfrac{a}{2}(1,1,-1)$, $\\mathbf{a}_2 = \\tfrac{a}{2}(-1,1,1)$, $\\mathbf{a}_3 = \\tfrac{a}{2}(1,-1,1)$ with $a = 0.35 \\,\\mathrm{nm}$, mesh $(N_1, N_2, N_3) = (3, 3, 3)$, parameter $\\beta = 1.0$.\n- Three-dimensional face-centered cubic lattice (using primitive real-space vectors):\n  - Case $\\mathrm{T8}$: $\\mathbf{a}_1 = \\tfrac{a}{2}(0,1,1)$, $\\mathbf{a}_2 = \\tfrac{a}{2}(1,0,1)$, $\\mathbf{a}_3 = \\tfrac{a}{2}(1,1,0)$ with $a = 0.35 \\,\\mathrm{nm}$, mesh $(N_1, N_2, N_3) = (5, 5, 5)$, parameter $\\beta = 0.6$.\n- Two-dimensional rectangular anisotropic lattice:\n  - Case $\\mathrm{T9}$: lattice constants $a_x = 0.4 \\,\\mathrm{nm}$, $a_y = 0.7 \\,\\mathrm{nm}$, mesh $(N_1, N_2) = (3, 5)$, parameter $\\beta = 0.9$.\n- Three-dimensional simple cubic lattice with constant integrand:\n  - Case $\\mathrm{T10}$: lattice constant $a = 0.5 \\,\\mathrm{nm}$, mesh $(N_1, N_2, N_3) = (3, 4, 5)$, parameter $\\beta = 0$.\n\nProgram requirements:\n- Construct reciprocal primitive matrices $\\mathbf{B}$ from the given real-space primitive matrices $\\mathbf{A}$ using $\\mathbf{B} = 2\\pi (\\mathbf{A}^{-1})^\\top$.\n- Construct the MP grid in reduced coordinates by placing one sample point at the midpoint of each uniform subinterval along every reciprocal primitive direction, and evaluate $f(\\mathbf{k})$ with angles in radians.\n- Compute $I_{\\mathrm{exact}} = V^\\star [I_0(\\beta)]^d$ and $I_{\\mathrm{MP}} = V^\\star \\, \\frac{1}{\\prod_i N_i} \\sum f(\\mathbf{k})$, then return $E = \\big|I_{\\mathrm{MP}} - I_{\\mathrm{exact}}\\big|/I_{\\mathrm{exact}}$ for each test case.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, [$r_1, r_2, r_3, \\dots$]), where each $r_i$ is the relative error for the corresponding test case in the exact order given above.\n\nNo user input is permitted. All angles must be handled in radians. All outputs must be dimensionless decimals.",
            "solution": "The supplied problem is deemed valid as it is scientifically grounded in solid-state physics, mathematically well-posed, and all necessary parameters and definitions are provided unambiguously. It presents a standard computational task without internal contradictions or reliance on pseudoscience.\n\nThe core of the problem is to compute the relative error of a numerical integration scheme, the Monkhorst-Pack (MP) method, for a specific function over the Brillouin zone (BZ) of various Bravais lattices. The solution is developed from first principles.\n\nA $d$-dimensional Bravais lattice in real space is defined by a set of $d$ linearly independent primitive vectors $\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_d$. These vectors form the columns of the real-space matrix $\\mathbf{A} = [\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_d]$. The volume of the real-space primitive cell is $V = |\\det(\\mathbf{A})|$. All lattice constants are provided in nanometers ($1 \\,\\mathrm{nm} = 10^{-9} \\,\\mathrm{m}$) and must be converted to SI units for calculation.\n\nThe reciprocal lattice, essential for describing periodic systems in momentum space (or $\\mathbf{k}$-space), is generated by a set of primitive reciprocal vectors $\\mathbf{b}_1, \\mathbf{b}_2, \\ldots, \\mathbf{b}_d$. These are defined by the duality condition $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. Arranging the reciprocal vectors as columns of a matrix $\\mathbf{B} = [\\mathbf{b}_1, \\mathbf{b}_2, \\ldots, \\mathbf{b}_d]$, the condition becomes the matrix equation $\\mathbf{A}^\\top \\mathbf{B} = 2\\pi \\mathbf{I}$, where $\\mathbf{I}$ is the $d \\times d$ identity matrix. The reciprocal matrix $\\mathbf{B}$ can thus be calculated from the real-space matrix $\\mathbf{A}$ using the relation $\\mathbf{B} = 2\\pi (\\mathbf{A}^{-1})^\\top$. The volume of the reciprocal primitive cell, which is identical to the volume of the first Brillouin zone, is given by $V^\\star = |\\det(\\mathbf{B})|$. A useful identity is $V^\\star = (2\\pi)^d / |\\det(\\mathbf{A})|$.\n\nIntegrals of lattice-periodic functions over the Brillouin zone are frequently encountered. The integral of a function $F(\\mathbf{k})$ over the BZ is $I = \\int_{\\text{BZ}} F(\\mathbf{k}) \\, d^d\\mathbf{k}$. Due to the periodicity of the integrand with respect to the reciprocal lattice, this integral is equivalent to the integral over any primitive reciprocal cell. It is computationally advantageous to perform a change of variables to dimensionless reduced coordinates $\\mathbf{u} = (u_1, u_2, \\ldots, u_d)$ via the linear transformation $\\mathbf{k} = \\mathbf{B}\\mathbf{u}$. The integration domain for $\\mathbf{u}$ transforms to a unit hypercube, which we choose as $[-\\frac{1}{2}, \\frac{1}{2})^d$. The Jacobian of this transformation is $J = |\\det(\\mathbf{B})| = V^\\star$, meaning the differential volume element transforms as $d^d\\mathbf{k} = V^\\star d^d\\mathbf{u}$. The integral is then expressed as:\n$$I = V^\\star \\int_{[-\\frac{1}{2}, \\frac{1}{2})^d} F(\\mathbf{B}\\mathbf{u}) \\, d^d\\mathbf{u}$$\n\nThe problem specifies the integrand $f(\\mathbf{k}) = \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big)$, where $\\beta$ is a real parameter. This function is separable in the reduced coordinates $u_i$. The exact value of the Brillouin zone integral, $I_{\\mathrm{exact}}$, is therefore:\n$$I_{\\mathrm{exact}} = V^\\star \\int_{[-\\frac{1}{2}, \\frac{1}{2})^d} \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big) \\, d^d\\mathbf{u}$$\nBy virtue of separability, the integral of the product is the product of the integrals:\n$$I_{\\mathrm{exact}} = V^\\star \\prod_{i=1}^{d} \\int_{-1/2}^{1/2} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big) \\, du_i$$\nGiven the identity $\\int_{0}^{1} \\exp\\!\\big(\\beta \\cos(2\\pi u)\\big) \\, du = I_0(\\beta)$, where $I_0$ is the modified Bessel function of the first kind of order zero, and noting the $1$-periodicity of the integrand $\\exp(\\beta\\cos(2\\pi u))$, the integral over $[-\\frac{1}{2}, \\frac{1}{2})$ is equivalent to the integral over $[0, 1)$. Thus, the exact integral evaluates to:\n$$I_{\\mathrm{exact}} = V^\\star [I_0(\\beta)]^d$$\n\nThe numerical approximation of this integral is performed using the Monkhorst-Pack scheme. This method replaces the continuous integral with a discrete sum over a uniform grid of sample points in the reciprocal primitive cell. The grid is defined by dividing the $i$-th reciprocal primitive axis into $N_i$ equal segments. To preserve inversion symmetry, the sample points are located at the midpoints of these segments. In reduced coordinates for the domain $[-\\frac{1}{2}, \\frac{1}{2})^d$, the coordinates of the grid points $\\mathbf{u}_{\\mathbf{j}}$ are given by:\n$$u_i = \\frac{j_i + 1/2}{N_i} - \\frac{1}{2}, \\quad \\text{for } j_i = 0, 1, \\ldots, N_i - 1$$\nThe total number of points in the grid is $N_{\\text{tot}} = \\prod_{i=1}^d N_i$. The integral is approximated by the midpoint rule, where each point carries an equal weight corresponding to a sub-volume of $V^\\star / N_{\\text{tot}}$. The numerical estimate of the integral, $I_{\\mathrm{MP}}$, is:\n$$I_{\\mathrm{MP}} = V^\\star \\frac{1}{N_{\\text{tot}}} \\sum_{\\text{grid}} f(\\mathbf{B}\\mathbf{u}_{\\mathbf{j}}) = V^\\star \\frac{1}{\\prod_i N_i} \\sum_{\\mathbf{j}} \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_{i,j_i})\\big)$$\n\nFor each test case, the final quantity to compute is the relative error $E$, defined as:\n$$E = \\frac{\\left|I_{\\mathrm{MP}} - I_{\\mathrm{exact}}\\right|}{\\left|I_{\\mathrm{exact}}\\right|}$$\nFor the special case where $\\beta = 0$, the integrand becomes $f(\\mathbf{k}) = 1$. Consequently, $I_0(0) = 1$, leading to $I_{\\mathrm{exact}} = V^\\star$. The numerical sum also yields $I_{\\mathrm{MP}} = V^\\star \\frac{1}{N_{\\text{tot}}} \\sum 1 = V^\\star$. Thus, the error must be exactly $E=0$, providing a robust validation check for the implementation.\n\nThe program logic proceeds by first defining the parameters for each test case. For each case, it constructs the real-space matrix $\\mathbf{A}$, computes the reciprocal matrix $\\mathbf{B}$ and volume $V^\\star$, calculates the exact integral $I_{\\mathrm{exact}}$, generates the MP grid points, evaluates the numerical integral $I_{\\mathrm{MP}}$, and finally computes the relative error $E$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    It calculates the relative error of Monkhorst-Pack integration for a given\n    integrand on various Bravais lattices.\n    \"\"\"\n\n    nm_to_m = 1e-9\n\n    # The test cases are defined as a list of dictionaries.\n    # Each dictionary contains all parameters for a single calculation.\n    test_cases = [\n        # T1: 2D square\n        {'name': 'T1', 'dim': 2, 'lattice_type': 'square', 'params': {'a': 0.3}, 'mesh': (1, 1), 'beta': 0.7},\n        # T2: 2D square\n        {'name': 'T2', 'dim': 2, 'lattice_type': 'square', 'params': {'a': 0.3}, 'mesh': (4, 4), 'beta': 0.7},\n        # T3: 2D square\n        {'name': 'T3', 'dim': 2, 'lattice_type': 'square', 'params': {'a': 0.3}, 'mesh': (16, 16), 'beta': 0.7},\n        # T4: 2D triangular\n        {'name': 'T4', 'dim': 2, 'lattice_type': 'triangular', 'params': {'a': 0.25}, 'mesh': (5, 5), 'beta': 0.7},\n        # T5: 3D simple cubic\n        {'name': 'T5', 'dim': 3, 'lattice_type': 'sc', 'params': {'a': 0.5}, 'mesh': (2, 2, 2), 'beta': 0.5},\n        # T6: 3D simple cubic\n        {'name': 'T6', 'dim': 3, 'lattice_type': 'sc', 'params': {'a': 0.5}, 'mesh': (8, 8, 8), 'beta': 0.5},\n        # T7: 3D BCC\n        {'name': 'T7', 'dim': 3, 'lattice_type': 'bcc', 'params': {'a': 0.35}, 'mesh': (3, 3, 3), 'beta': 1.0},\n        # T8: 3D FCC\n        {'name': 'T8', 'dim': 3, 'lattice_type': 'fcc', 'params': {'a': 0.35}, 'mesh': (5, 5, 5), 'beta': 0.6},\n        # T9: 2D rectangular\n        {'name': 'T9', 'dim': 2, 'lattice_type': 'rectangular', 'params': {'ax': 0.4, 'ay': 0.7}, 'mesh': (3, 5), 'beta': 0.9},\n        # T10: 3D simple cubic (beta=0)\n        {'name': 'T10', 'dim': 3, 'lattice_type': 'sc', 'params': {'a': 0.5}, 'mesh': (3, 4, 5), 'beta': 0.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        dim = case['dim']\n        lattice_type = case['lattice_type']\n        params = case['params']\n        N_mesh = case['mesh']\n        beta = case['beta']\n\n        # Construct the real-space primitive matrix A\n        A = None\n        if lattice_type == 'square':\n            a = params['a'] * nm_to_m\n            A = np.array([[a, 0], [0, a]])\n        elif lattice_type == 'triangular':\n            a = params['a'] * nm_to_m\n            A = a * np.array([[1, 0.5], [0, np.sqrt(3)/2]])\n        elif lattice_type == 'sc':\n            a = params['a'] * nm_to_m\n            A = a * np.identity(3)\n        elif lattice_type == 'bcc':\n            a = params['a'] * nm_to_m\n            A = (a / 2) * np.array([[1, -1, 1], [1, 1, -1], [-1, 1, 1]])\n        elif lattice_type == 'fcc':\n            a = params['a'] * nm_to_m\n            A = (a / 2) * np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n        elif lattice_type == 'rectangular':\n            ax = params['ax'] * nm_to_m\n            ay = params['ay'] * nm_to_m\n            A = np.array([[ax, 0], [0, ay]])\n\n        # Reciprocal lattice calculations\n        # B = 2*pi*(A^-1)^T\n        B = 2 * np.pi * np.linalg.inv(A).T\n        # Volume of reciprocal primitive cell\n        V_star = np.abs(np.linalg.det(B))\n\n        # Exact integral calculation\n        # I_exact = V_star * [I_0(beta)]^d\n        I_exact = V_star * (i0(beta) ** dim)\n\n        # Numerical integral using Monkhorst-Pack grid\n        # The integrand is separable, so we can compute the sum for each\n        # dimension independently and then multiply the results.\n        \n        one_dim_sums = []\n        for i in range(dim):\n            N_i = N_mesh[i]\n            # Generate midpoint grid in reduced coordinates [-0.5, 0.5)\n            u_i = (np.arange(N_i) + 0.5) / N_i - 0.5\n            # Evaluate the 1D part of the integrand at grid points\n            f_vals = np.exp(beta * np.cos(2 * np.pi * u_i))\n            # Sum the values\n            one_dim_sums.append(np.sum(f_vals))\n        \n        # Product of sums gives the total sum over the grid\n        total_sum = np.prod(one_dim_sums)\n        \n        # Calculate the numerical integral estimate\n        I_mp = V_star * total_sum / np.prod(N_mesh)\n\n        # Compute the relative error\n        # A check for I_exact == 0 avoids division by zero, although I_0(beta) >= 1 for real beta.\n        if np.abs(I_exact) < 1e-15:\n            # If exact is 0, error is 0 only if MP is also 0.\n            error = 0.0 if np.abs(I_mp) < 1e-15 else np.inf\n        else:\n            error = np.abs(I_mp - I_exact) / np.abs(I_exact)\n        \n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}