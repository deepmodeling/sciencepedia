{
    "hands_on_practices": [
        {
            "introduction": "理解倒易空间对于分析晶体中的波动现象（如电子衍射和能带结构）至关重要。本练习  将提供从正空间晶格矢量推导倒易晶格矢量的基础训练，并利用这些矢量构建第一布里渊区。掌握这一核心概念是分析材料电子或声子性质的基石。",
            "id": "4265827",
            "problem": "在纳米电子学中，石墨烯和过渡金属二硫属化物单层等二维材料通过其布拉菲晶格及相关的倒易晶格进行分析，以理解电子波矢和能带结构。考虑一个二维六方（三角）布拉菲晶格，其原胞正格矢 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$ 满足 $|\\mathbf{a}_{1}| = |\\mathbf{a}_{2}| = a$，且矢量间夹角 $\\gamma = 120^{\\circ}$。从倒易晶格是正格的对偶基这一基本定义出发，即 $ \\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2\\pi \\delta_{ij}$（其中 $i,j \\in \\{1,2\\}$ 且 $\\delta_{ij}$ 是克罗内克δ函数），推导倒易晶格原胞矢 $\\mathbf{b}_{1}$ 和 $\\mathbf{b}_{2}$ 在笛卡尔坐标系中的显式闭式表达式。然后，利用 Wigner–Seitz 构建法以及三角晶格的第一布里渊区 (BZ) 是一个以原点为中心、由指向六个最近邻倒易格点的矢量的垂直平分线构成的正六边形这一几何特性，推导出该六边形的边长 $L_{\\mathrm{BZ}}$（用 $a$ 表示）。您的推导必须从所述的对偶基定义和基本欧几里得几何出发；不要引用任何未声明的快捷公式。将 $a$ 视为一个符号化的正长度参数。\n\n仅报告用 $a$ 表示的六边形边长 $L_{\\mathrm{BZ}}$ 的解析表达式作为您的最终答案。边长应以倒易长度单位表示（例如，如果 $a$ 的单位是 $\\mathrm{m}$，则其单位为 $\\mathrm{m}^{-1}$）。不需要进行数值代入，也不允许四舍五入。",
            "solution": "用户希望求出二维六方晶格的第一布里渊区 (BZ) 的边长。验证过程确认该问题在科学上是合理的、提法恰当，并包含得出唯一解所需的所有信息。\n\n推导过程分为两个主要阶段：首先，从正格矢量确定倒易晶格矢量；其次，利用倒易晶格的 Wigner-Seitz 原胞的几何性质求出所得六边形 BZ 的边长。\n\n**第一部分：倒易晶格矢量的推导**\n\n问题定义了一个二维六方布拉菲晶格，其原胞正格矢为 $\\mathbf{a}_1$ 和 $\\mathbf{a}_2$，二者大小相等，即 $|\\mathbf{a}_1| = |\\mathbf{a}_2| = a$，且它们之间的夹角为 $\\gamma = 120^{\\circ}$。\n\n为了进行计算，我们首先在笛卡尔坐标系中表示这些矢量。设 $\\mathbf{a}_1$ 与 $x$ 轴对齐。\n$$\n\\mathbf{a}_1 = a(1, 0) = (a, 0)\n$$\n那么矢量 $\\mathbf{a}_2$ 与 $\\mathbf{a}_1$ 的夹角为 $120^{\\circ}$。\n$$\n\\mathbf{a}_2 = a(\\cos(120^{\\circ}), \\sin(120^{\\circ})) = a(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}) = (-\\frac{a}{2}, \\frac{a\\sqrt{3}}{2})\n$$\n\n倒易晶格原胞矢 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 由关系式 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克δ函数。设在同一笛卡尔基中的倒易矢量为 $\\mathbf{b}_1 = (b_{1x}, b_{1y})$ 和 $\\mathbf{b}_2 = (b_{2x}, b_{2y})$。我们可以利用定义关系式中的四个方程来求解它们的分量。\n\n1.  $\\mathbf{a}_1 \\cdot \\mathbf{b}_1 = 2\\pi$:\n    $$\n    (a, 0) \\cdot (b_{1x}, b_{1y}) = a b_{1x} = 2\\pi \\implies b_{1x} = \\frac{2\\pi}{a}\n    $$\n2.  $\\mathbf{a}_1 \\cdot \\mathbf{b}_2 = 0$:\n    $$\n    (a, 0) \\cdot (b_{2x}, b_{2y}) = a b_{2x} = 0 \\implies b_{2x} = 0\n    $$\n3.  $\\mathbf{a}_2 \\cdot \\mathbf{b}_1 = 0$:\n    $$\n    (-\\frac{a}{2}, \\frac{a\\sqrt{3}}{2}) \\cdot (b_{1x}, b_{1y}) = (-\\frac{a}{2}) b_{1x} + (\\frac{a\\sqrt{3}}{2}) b_{1y} = 0\n    $$\n    代入 $b_{1x} = \\frac{2\\pi}{a}$：\n    $$\n    (-\\frac{a}{2}) (\\frac{2\\pi}{a}) + (\\frac{a\\sqrt{3}}{2}) b_{1y} = 0 \\implies -\\pi + \\frac{a\\sqrt{3}}{2} b_{1y} = 0 \\implies b_{1y} = \\frac{2\\pi}{a\\sqrt{3}}\n    $$\n4.  $\\mathbf{a}_2 \\cdot \\mathbf{b}_2 = 2\\pi$:\n    $$\n    (-\\frac{a}{2}, \\frac{a\\sqrt{3}}{2}) \\cdot (b_{2x}, b_{2y}) = (-\\frac{a}{2}) b_{2x} + (\\frac{a\\sqrt{3}}{2}) b_{2y} = 2\\pi\n    $$\n    代入 $b_{2x} = 0$:\n    $$\n    0 + (\\frac{a\\sqrt{3}}{2}) b_{2y} = 2\\pi \\implies b_{2y} = \\frac{4\\pi}{a\\sqrt{3}}\n    $$\n\n综合这些分量，我们得到倒易晶格矢量的显式表达式：\n$$\n\\mathbf{b}_1 = \\left(\\frac{2\\pi}{a}, \\frac{2\\pi}{a\\sqrt{3}}\\right)\n$$\n$$\n\\mathbf{b}_2 = \\left(0, \\frac{4\\pi}{a\\sqrt{3}}\\right)\n$$\n\n六方晶格的倒易晶格也是六方晶格。为了验证这一点，我们计算 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 的大小以及它们之间的夹角。\n$$\n|\\mathbf{b}_1|^2 = \\left(\\frac{2\\pi}{a}\\right)^2 + \\left(\\frac{2\\pi}{a\\sqrt{3}}\\right)^2 = \\frac{4\\pi^2}{a^2} + \\frac{4\\pi^2}{3a^2} = \\frac{12\\pi^2 + 4\\pi^2}{3a^2} = \\frac{16\\pi^2}{3a^2}\n$$\n$$\n|\\mathbf{b}_2|^2 = 0^2 + \\left(\\frac{4\\pi}{a\\sqrt{3}}\\right)^2 = \\frac{16\\pi^2}{3a^2}\n$$\n因此，大小相等：$|\\mathbf{b}_1| = |\\mathbf{b}_2| = \\frac{4\\pi}{a\\sqrt{3}}$。我们将这个共同的大小记为 $b$。\n$\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 之间的夹角 $\\theta$ 由下式给出：\n$$\n\\cos(\\theta) = \\frac{\\mathbf{b}_1 \\cdot \\mathbf{b}_2}{|\\mathbf{b}_1||\\mathbf{b}_2|} = \\frac{(2\\pi/a)(0) + (2\\pi/(a\\sqrt{3}))(4\\pi/(a\\sqrt{3}))}{16\\pi^2/(3a^2)} = \\frac{8\\pi^2/(3a^2)}{16\\pi^2/(3a^2)} = \\frac{1}{2}\n$$\n所以，夹角为 $\\theta = 60^{\\circ}$。这证实了倒易晶格也是一个六方（三角）晶格，其原胞矢长度为 $b = \\frac{4\\pi}{a\\sqrt{3}}$，矢量间夹角为 $60^{\\circ}$。\n\n**第二部分：第一布里渊区的几何形状**\n\n第一布里渊区被定义为倒易晶格的 Wigner-Seitz 原胞。它是指在空间中，与原点（$\\Gamma$ 点）的距离比与任何其他倒易格点的距离都更近的区域。因此，BZ 的边界是由从原点到最近邻倒易格点的矢量的垂直平分面（在二维中是垂直平分线）所构成的。\n\n最近邻倒易格点是由原胞矢生成的那些点，例如 $\\pm \\mathbf{b}_1$、$\\pm \\mathbf{b}_2$ 以及它们的和/差，如 $\\pm(\\mathbf{b}_1 - \\mathbf{b}_2)$。对于六方晶格，有六个这样的最近邻，它们都与原点相距相同的距离 $b = |\\mathbf{b}_1|$。这六个点构成一个正六边形。指向这六个点的矢量的垂直平分线构成了另一个以原点为中心的正六边形，这就是第一布里渊区。\n\n设 $L_{\\mathrm{BZ}}$ 为该六边形布里渊区的边长。正六边形的几何性质将其边长 $L_{\\mathrm{BZ}}$ 与从中心到边中点的垂直距离 $d$ 联系起来。这个关系是 $d = L_{\\mathrm{BZ}} \\cos(30^\\circ) = L_{\\mathrm{BZ}} \\frac{\\sqrt{3}}{2}$。\n\n距离 $d$ 正是连接原点与一个最近邻倒易格点的矢量长度的一半。让我们取任意一个最近邻矢量，比如说 $\\mathbf{G}$。到这个点的距离是 $|\\mathbf{G}| = b$。垂直平分线与原点的距离为 $d = \\frac{1}{2}|\\mathbf{G}| = \\frac{b}{2}$。\n\n令两个关于 $d$ 的表达式相等，我们可以解出 $L_{\\mathrm{BZ}}$：\n$$\nL_{\\mathrm{BZ}} \\frac{\\sqrt{3}}{2} = \\frac{b}{2}\n$$\n$$\nL_{\\mathrm{BZ}} = \\frac{b}{\\sqrt{3}}\n$$\n\n最后，我们代入我们推导出的 $b$ 的表达式：\n$$\nL_{\\mathrm{BZ}} = \\frac{1}{\\sqrt{3}} \\left( \\frac{4\\pi}{a\\sqrt{3}} \\right) = \\frac{4\\pi}{a(\\sqrt{3})^2} = \\frac{4\\pi}{3a}\n$$\n这就是第一布里渊区边长的解析表达式。单位是倒易长度，与波矢空间一致。",
            "answer": "$$\n\\boxed{\\frac{4\\pi}{3a}}\n$$"
        },
        {
            "introduction": "本练习旨在将抽象的晶格理论与真实的材料科学问题联系起来。我们将探究物理形变，例如纳米异质结构中常见的外延应变，如何改变晶体的基本对称性 。通过对简单立方晶格施加剪切形变，您将亲眼见证其如何转变为单斜晶系，这一过程对材料的电子和光学性质具有深远影响。",
            "id": "4265805",
            "problem": "一种用作纳米电子异质结构中栅极电介质的立方钙钛矿氧化物，在衬底平面上会经历外延诱导的均匀剪切。将未畸变的晶体建模为一个简单立方布拉维晶格，其原胞基矢为 $\\mathbf{a}_{1}=a\\,\\hat{\\mathbf{x}}$, $\\mathbf{a}_{2}=a\\,\\hat{\\mathbf{y}}$, $\\mathbf{a}_{3}=a\\,\\hat{\\mathbf{z}}$，其中 $a$ 是立方晶格常数。一个大小为 $s$ 的均匀简单剪切在 $x$ 方向上施加于垂直于 $y$ 轴的平面上，由形变梯度描述：\n$$\n\\mathbf{F}(s)=\\begin{pmatrix}\n1  s  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}.\n$$\n仅使用布拉维晶格、原胞基矢、度规张量和晶系分类的基本定义，完成以下任务：\n\n1. 推导变换后的原胞基矢 $\\mathbf{a}_{i}'=\\mathbf{F}(s)\\,\\mathbf{a}_{i}$ 和度规张量 $g_{ij}=\\mathbf{a}_{i}'\\cdot\\mathbf{a}_{j}'$。\n2. 根据 $g_{ij}$，确定剪切后晶格的晶格参数 $a'$, $b'$, $c'$ 和轴间角 $\\alpha$, $\\beta$, $\\gamma$，并表示为 $a$ 和 $s$ 的函数。\n3. 使用三维布拉维晶格和晶系关于边长和轴间角的标准分类准则，识别当 $s\\neq 0$ 的一般情况下剪切后晶格的布拉维晶格类型和晶系，并说明在 $s=0$ 的特殊情况下它如何退化。\n4. 最后，报告剪切后晶格唯一一个非直角的轴间角的余弦值的解析表达式，该表达式是 $s$ 的函数。此余弦值是您必须给出的唯一最终答案。请以闭合形式的符号表达式给出，无需进行数值计算。\n\n无需进行数值取整。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，是适定的、客观的，并且包含足够的信息，可以根据晶体学和连续介质力学的基本原理推导出唯一解。\n\n解答过程通过执行问题陈述中概述的四个任务来进行。\n\n**1. 变换后的原胞基矢和度规张量**\n\n简单立方晶格的初始原胞基矢在笛卡尔坐标系中给出如下：\n$$\n\\mathbf{a}_{1} = a\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{a}_{2} = a\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{a}_{3} = a\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n该形变由形变梯度张量描述：\n$$\n\\mathbf{F}(s)=\\begin{pmatrix}\n1  s  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}\n$$\n变换后的原胞基矢 $\\mathbf{a}_{i}'$ 是通过将形变施加于原始基矢而获得的，即 $\\mathbf{a}_{i}' = \\mathbf{F}(s)\\mathbf{a}_{i}$。\n\n对于 $\\mathbf{a}_{1}'$：\n$$\n\\mathbf{a}_{1}' = \\begin{pmatrix} 1  s  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\left( a\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) = a\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = a\\,\\hat{\\mathbf{x}}\n$$\n\n对于 $\\mathbf{a}_{2}'$：\n$$\n\\mathbf{a}_{2}' = \\begin{pmatrix} 1  s  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\left( a\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) = a\\begin{pmatrix} s \\\\ 1 \\\\ 0 \\end{pmatrix} = a(s\\,\\hat{\\mathbf{x}} + \\hat{\\mathbf{y}})\n$$\n\n对于 $\\mathbf{a}_{3}'$：\n$$\n\\mathbf{a}_{3}' = \\begin{pmatrix} 1  s  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\left( a\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right) = a\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = a\\,\\hat{\\mathbf{z}}\n$$\n\n接下来，我们计算度规张量 $g_{ij} = \\mathbf{a}_{i}' \\cdot \\mathbf{a}_{j}'$。度规张量是一个 $3 \\times 3$ 的对称矩阵。\n\n对角元是新基矢长度的平方：\n$g_{11} = \\mathbf{a}_{1}' \\cdot \\mathbf{a}_{1}' = (a\\,\\hat{\\mathbf{x}}) \\cdot (a\\,\\hat{\\mathbf{x}}) = a^{2}$\n$g_{22} = \\mathbf{a}_{2}' \\cdot \\mathbf{a}_{2}' = a(s\\,\\hat{\\mathbf{x}} + \\hat{\\mathbf{y}}) \\cdot a(s\\,\\hat{\\mathbf{x}} + \\hat{\\mathbf{y}}) = a^{2}(s^{2} + 1)$\n$g_{33} = \\mathbf{a}_{3}' \\cdot \\mathbf{a}_{3}' = (a\\,\\hat{\\mathbf{z}}) \\cdot (a\\,\\hat{\\mathbf{z}}) = a^{2}$\n\n非对角元与新基矢之间的夹角相关：\n$g_{12} = \\mathbf{a}_{1}' \\cdot \\mathbf{a}_{2}' = (a\\,\\hat{\\mathbf{x}}) \\cdot a(s\\,\\hat{\\mathbf{x}} + \\hat{\\mathbf{y}}) = a^{2}s$\n$g_{13} = \\mathbf{a}_{1}' \\cdot \\mathbf{a}_{3}' = (a\\,\\hat{\\mathbf{x}}) \\cdot (a\\,\\hat{\\mathbf{z}}) = 0$\n$g_{23} = \\mathbf{a}_{2}' \\cdot \\mathbf{a}_{3}' = a(s\\,\\hat{\\mathbf{x}} + \\hat{\\mathbf{y}}) \\cdot (a\\,\\hat{\\mathbf{z}}) = 0$\n\n由于 $g_{ij}$ 是对称的，我们有 $g_{21}=g_{12}$，$g_{31}=g_{13}$ 和 $g_{32}=g_{23}$。完整的度规张量为：\n$$\n\\mathbf{g} = \\begin{pmatrix}\ng_{11}  g_{12}  g_{13} \\\\\ng_{21}  g_{22}  g_{23} \\\\\ng_{31}  g_{32}  g_{33}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\na^{2}  a^{2}s  0 \\\\\na^{2}s  a^{2}(1+s^{2})  0 \\\\\n0  0  a^{2}\n\\end{pmatrix}\n$$\n\n**2. 晶格参数和轴间角**\n\n晶格参数 $a'$, $b'$, $c'$（原胞基矢的长度）和轴间角 $\\alpha$, $\\beta$, $\\gamma$ 由度规张量推导得出。\n\n长度是 $\\mathbf{g}$ 的对角元的平方根：\n$a' = |\\mathbf{a}_{1}'| = \\sqrt{g_{11}} = \\sqrt{a^{2}} = a$\n$b' = |\\mathbf{a}_{2}'| = \\sqrt{g_{22}} = \\sqrt{a^{2}(1+s^{2})} = a\\sqrt{1+s^{2}}$\n$c' = |\\mathbf{a}_{3}'| = \\sqrt{g_{33}} = \\sqrt{a^{2}} = a$\n\n根据惯例，轴间角定义如下：$\\alpha$ 是 $\\mathbf{a}_{2}'$ 和 $\\mathbf{a}_{3}'$ 之间的夹角，$\\beta$ 是 $\\mathbf{a}_{1}'$ 和 $\\mathbf{a}_{3}'$ 之间的夹角，而 $\\gamma$ 是 $\\mathbf{a}_{1}'$ 和 $\\mathbf{a}_{2}'$ 之间的夹角。它们的余弦值由下式给出：\n$$\n\\cos\\alpha = \\frac{\\mathbf{a}_{2}' \\cdot \\mathbf{a}_{3}'}{|\\mathbf{a}_{2}'| |\\mathbf{a}_{3}'|} = \\frac{g_{23}}{\\sqrt{g_{22}g_{33}}}\n$$\n$$\n\\cos\\beta = \\frac{\\mathbf{a}_{1}' \\cdot \\mathbf{a}_{3}'}{|\\mathbf{a}_{1}'| |\\mathbf{a}_{3}'|} = \\frac{g_{13}}{\\sqrt{g_{11}g_{33}}}\n$$\n$$\n\\cos\\gamma = \\frac{\\mathbf{a}_{1}' \\cdot \\mathbf{a}_{2}'}{|\\mathbf{a}_{1}'| |\\mathbf{a}_{2}'|} = \\frac{g_{12}}{\\sqrt{g_{11}g_{22}}}\n$$\n代入推导出的值：\n$$\n\\cos\\alpha = \\frac{0}{\\sqrt{a^{2}(1+s^{2}) \\cdot a^{2}}} = 0 \\implies \\alpha = \\frac{\\pi}{2} \\text{ 弧度或 } 90^{\\circ}\n$$\n$$\n\\cos\\beta = \\frac{0}{\\sqrt{a^{2} \\cdot a^{2}}} = 0 \\implies \\beta = \\frac{\\pi}{2} \\text{ 弧度或 } 90^{\\circ}\n$$\n$$\n\\cos\\gamma = \\frac{a^{2}s}{\\sqrt{a^{2} \\cdot a^{2}(1+s^{2})}} = \\frac{a^{2}s}{a \\cdot a\\sqrt{1+s^{2}}} = \\frac{s}{\\sqrt{1+s^{2}}}\n$$\n\n**3. 布拉维晶格和晶系分类**\n\n分类取决于晶格参数和轴间角之间的关系。\n\n对于 $s \\neq 0$ 的一般剪切情况：\n晶格参数为 $a' = a$，$b' = a\\sqrt{1+s^{2}}$，$c' = a$。因此，$a'=c' \\neq b'$（因为 $s \\neq 0$）。\n轴间角为 $\\alpha = 90^{\\circ}$，$\\beta = 90^{\\circ}$，以及 $\\gamma = \\arccos\\left(\\frac{s}{\\sqrt{1+s^{2}}}\\right) \\neq 90^{\\circ}$。\n晶胞的条件是 $a' = c'$ 和 $\\alpha = \\beta = 90^{\\circ} \\neq \\gamma$。一个具有两个直角和一个非直角的晶系被归类为**单斜晶系**。推导出的原胞基矢 $(\\mathbf{a}_{1}', \\mathbf{a}_{2}', \\mathbf{a}_{3}')$ 构成一个原胞。因此，该布拉维晶格是**简单单斜**（或单斜P）。\n\n对于 $s=0$ 的特殊情况：\n形变梯度 $\\mathbf{F}(0)$ 成为单位矩阵，因此晶格未发生形变。\n晶格参数变为 $a' = a$，$b' = a\\sqrt{1+0^{2}} = a$，$c' = a$。所以，$a'=b'=c'=a$。\n轴间角变为 $\\alpha = 90^{\\circ}$，$\\beta = 90^{\\circ}$，以及 $\\cos\\gamma = \\frac{0}{\\sqrt{1+0^{2}}} = 0 \\implies \\gamma = 90^{\\circ}$。所以，$\\alpha = \\beta = \\gamma = 90^{\\circ}$。\n条件 $a'=b'=c'$ 和 $\\alpha=\\beta=\\gamma=90^{\\circ}$ 定义了**立方**晶系。由于原始晶格是简单立方，所得的布拉维晶格是**简单立方**（P）。\n这证实了剪切形变将一个简单立方晶格转变为一个简单单斜晶格。\n\n**4. 非直角轴间角的余弦**\n\n如第2部分和第3部分所确定的，对于任何 $s \\neq 0$，角 $\\alpha$ 和 $\\beta$ 都是直角（$90^{\\circ}$），而角 $\\gamma$ 不是。因此，$\\gamma$ 是唯一的非直角轴间角。其余弦的解析表达式为：\n$$\n\\cos\\gamma = \\frac{s}{\\sqrt{1+s^{2}}}\n$$\n该表达式即为所要求的最终答案。",
            "answer": "$$\n\\boxed{\\frac{s}{\\sqrt{1+s^{2}}}}\n$$"
        },
        {
            "introduction": "这项练习将引导您从解析理论走向计算实践，这是现代材料研究所必需的技能。您将学习并实现 Monkhorst-Pack 方法，这是一种在布里渊区上进行函数数值积分的标准算法 。这项实践不仅能巩固您对倒易空间的理解，还将提供一个具体的范例，展示理论概念如何转化为用于预测材料属性的计算工具。",
            "id": "4265784",
            "problem": "您需要实现一个完整的程序，该程序为指定的布拉菲晶格，在倒易空间中构建 Monkhorst-Pack (MP) 网格，并估算布里渊区数值积分的误差作为网格密度的函数。最终要求的输出为单行文本，其中包含一个用方括号括起来的、以逗号分隔的相对误差列表，每个测试用例对应一个误差值。该问题必须从第一性原理出发解决，从布拉菲晶格、其倒易晶格、布里渊区的定义，以及与平移对称性一致的均匀采样网格的构建开始。\n\n使用的定义和基础：\n- 实空间中的布拉菲晶格由三维空间中的原胞矢量 $\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3$（二维情况类似）生成，形成集合 $\\mathcal{L} = \\{n_1 \\mathbf{a}_1 + n_2 \\mathbf{a}_2 + n_3 \\mathbf{a}_3 \\mid n_i \\in \\mathbb{Z}\\}$。在二维情况下，只有 $\\mathbf{a}_1, \\mathbf{a}_2$。\n- 倒易晶格由原胞矢量 $\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3$ 定义，满足 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$。如果 $\\mathbf{A}$ 是以 $\\mathbf{a}_i$ 为列向量的矩阵，那么以 $\\mathbf{b}_i$ 为列向量的倒易矩阵 $\\mathbf{B}$ 满足 $\\mathbf{A}^\\top \\mathbf{B} = 2\\pi \\mathbf{I}$，等价于 $\\mathbf{B} = 2\\pi (\\mathbf{A}^{-1})^\\top$，其中 $\\mathbf{I}$ 是单位矩阵。倒易原胞体积（二维情况下为面积）是 $V^\\star = |\\det \\mathbf{B}|$。\n- 第一布里渊区是倒易晶格的 Wigner-Seitz 原胞。对于相对于倒易晶格呈周期性的函数 $\\mathbf{k} \\mapsto f(\\mathbf{k})$，由于周期性，对第一布里渊区的积分可以在任何倒易原胞上进行。\n- 在倒易原胞中，与平移对称性一致的均匀采样可以通过将每个倒易原胞方向分成 $N_i$ 个等分段，并将采样点置于中点来构建，以避免边界模糊性并保持反演对称性。这就是 Monkhorst-Pack (MP) 的概念。如果 $\\mathbf{b}_i$ 是倒易原胞矢量，$u_i$ 是沿每个倒易原胞方向的简约坐标，则采样点位于简约坐标中，相应的 $\\mathbf{k}$ 点通过线性映射 $\\mathbf{k} = \\sum_i u_i \\mathbf{b}_i$ 获得。对于周期性、光滑的被积函数，均匀中点法则采用相等的权重是合适的。\n\n您需要：\n- 在简约坐标 $u_i$ 中构建 MP 网格，并通过倒易原胞矢量将其映射到 $\\mathbf{k}$ 空间。\n- 考虑可分离的、解析的、晶格周期的被积函数 $f(\\mathbf{k}) = \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big)$，其中 $d$ 是空间维度，$\\beta$ 是一个实数参数，$u_i$ 是由 $\\mathbf{k} = \\mathbf{B} \\mathbf{u}$ 定义的简约坐标，其中 $\\mathbf{u} \\in [-\\tfrac{1}{2}, \\tfrac{1}{2})^d$。$\\cos(\\cdot)$ 中的角度以弧度为单位。\n- 使用坐标变换的雅可比行列式计算倒易原胞上的精确积分。使用经过充分检验的恒等式 $\\int_{0}^{1} \\exp\\!\\big(\\beta \\cos(2\\pi u)\\big) \\, du = I_0(\\beta)$，其中 $I_0$ 是第一类零阶修正贝塞尔函数。因此，精确积分为 $I_{\\mathrm{exact}} = V^\\star \\, [I_0(\\beta)]^d$。\n- 使用 MP 网格，通过简约坐标上的均匀中点法则来近似该积分，即 $I_{\\mathrm{MP}} = V^\\star \\, \\frac{1}{\\prod_i N_i} \\sum_{\\text{grid}} f(\\mathbf{k})$，采用相等的权重。\n- 对于每个测试用例，计算相对误差 $E = \\big|I_{\\mathrm{MP}} - I_{\\mathrm{exact}}\\big|/I_{\\mathrm{exact}}$，作为无量纲的小数。\n\n使用的测试套件和参数值：\n- 所有以纳米为单位给出的晶格常数，在程序中必须以米为单位使用。程序必须在内部执行转换。输出中不需要其他物理单位，因为相对误差是无量纲的。\n- 二维正方晶格：\n  - 用例 $\\mathrm{T1}$：晶格常数 $a = 0.3 \\,\\mathrm{nm}$，网格 $(N_1, N_2) = (1, 1)$，参数 $\\beta = 0.7$。\n  - 用例 $\\mathrm{T2}$：晶格常数 $a = 0.3 \\,\\mathrm{nm}$，网格 $(N_1, N_2) = (4, 4)$，参数 $\\beta = 0.7$。\n  - 用例 $\\mathrm{T3}$：晶格常数 $a = 0.3 \\,\\mathrm{nm}$，网格 $(N_1, N_2) = (16, 16)$，参数 $\\beta = 0.7$。\n- 二维三角（六方）晶格：\n  - 用例 $\\mathrm{T4}$：实空间原胞矢量 $\\mathbf{a}_1 = a(1,0)$, $\\mathbf{a}_2 = a(\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2})$，其中 $a = 0.25 \\,\\mathrm{nm}$，网格 $(N_1, N_2) = (5, 5)$，参数 $\\beta = 0.7$。\n- 三维简单立方晶格：\n  - 用例 $\\mathrm{T5}$：晶格常数 $a = 0.5 \\,\\mathrm{nm}$，网格 $(N_1, N_2, N_3) = (2, 2, 2)$，参数 $\\beta = 0.5$。\n  - 用例 $\\mathrm{T6}$：晶格常数 $a = 0.5 \\,\\mathrm{nm}$，网格 $(N_1, N_2, N_3) = (8, 8, 8)$，参数 $\\beta = 0.5$。\n- 三维体心立方晶格（使用实空间原胞矢量）：\n  - 用例 $\\mathrm{T7}$：$\\mathbf{a}_1 = \\tfrac{a}{2}(1,1,-1)$，$\\mathbf{a}_2 = \\tfrac{a}{2}(-1,1,1)$，$\\mathbf{a}_3 = \\tfrac{a}{2}(1,-1,1)$，其中 $a = 0.35 \\,\\mathrm{nm}$，网格 $(N_1, N_2, N_3) = (3, 3, 3)$，参数 $\\beta = 1.0$。\n- 三维面心立方晶格（使用实空间原胞矢量）：\n  - 用例 $\\mathrm{T8}$：$\\mathbf{a}_1 = \\tfrac{a}{2}(0,1,1)$，$\\mathbf{a}_2 = \\tfrac{a}{2}(1,0,1)$，$\\mathbf{a}_3 = \\tfrac{a}{2}(1,1,0)$，其中 $a = 0.35 \\,\\mathrm{nm}$，网格 $(N_1, N_2, N_3) = (5, 5, 5)$，参数 $\\beta = 0.6$。\n- 二维矩形各向异性晶格：\n  - 用例 $\\mathrm{T9}$：晶格常数 $a_x = 0.4 \\,\\mathrm{nm}$，$a_y = 0.7 \\,\\mathrm{nm}$，网格 $(N_1, N_2) = (3, 5)$，参数 $\\beta = 0.9$。\n- 具有常数被积函数的三维简单立方晶格：\n  - 用例 $\\mathrm{T10}$：晶格常数 $a = 0.5 \\,\\mathrm{nm}$，网格 $(N_1, N_2, N_3) = (3, 4, 5)$，参数 $\\beta = 0$。\n\n程序要求：\n- 根据给定的实空间原胞矩阵 $\\mathbf{A}$，使用 $\\mathbf{B} = 2\\pi (\\mathbf{A}^{-1})^\\top$ 构建倒易原胞矩阵 $\\mathbf{B}$。\n- 通过在每个倒易原胞方向的均匀子区间中点放置一个采样点来构建简约坐标下的 MP 网格，并计算 $f(\\mathbf{k})$，其中角度以弧度为单位。\n- 计算 $I_{\\mathrm{exact}} = V^\\star [I_0(\\beta)]^d$ 和 $I_{\\mathrm{MP}} = V^\\star \\, \\frac{1}{\\prod_i N_i} \\sum f(\\mathbf{k})$，然后为每个测试用例返回 $E = \\big|I_{\\mathrm{MP}} - I_{\\mathrm{exact}}\\big|/I_{\\mathrm{exact}}$。\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如，[$r_1, r_2, r_3, \\dots$]），其中每个 $r_i$ 是对应测试用例的相对误差，顺序与上面给出的一致。\n\n不允许用户输入。所有角度必须以弧度处理。所有输出必须是无量纲的小数。",
            "solution": "所提供的问题被认为是有效的，因为它在科学上基于固态物理学，在数学上是适定的，并且所有必要的参数和定义都已明确给出。它提出了一个标准的计算任务，没有内部矛盾或依赖伪科学。\n\n问题的核心是计算一种数值积分方案——Monkhorst-Pack (MP) 方法——在各种布拉菲晶格的布里渊区（BZ）上对一个特定函数积分的相对误差。该解决方案是从第一性原理出发推导的。\n\n一个 $d$ 维实空间布拉菲晶格由一组 $d$ 个线性无关的原胞矢量 $\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_d$ 定义。这些矢量构成了实空间矩阵 $\\mathbf{A} = [\\mathbf{a}_1, \\mathbf{a}_2, \\ldots, \\mathbf{a}_d]$ 的列。实空间原胞的体积是 $V = |\\det(\\mathbf{A})|$。所有晶格常数均以纳米（$1 \\,\\mathrm{nm} = 10^{-9} \\,\\mathrm{m}$）为单位提供，计算时必须转换为国际单位制（SI）单位。\n\n倒易晶格对于描述动量空间（或 $\\mathbf{k}$ 空间）中的周期性系统至关重要，它由一组原胞倒易矢量 $\\mathbf{b}_1, \\mathbf{b}_2, \\ldots, \\mathbf{b}_d$ 生成。这些矢量由对偶条件 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 δ。将倒易矢量排列成矩阵 $\\mathbf{B} = [\\mathbf{b}_1, \\mathbf{b}_2, \\ldots, \\mathbf{b}_d]$ 的列，该条件变为矩阵方程 $\\mathbf{A}^\\top \\mathbf{B} = 2\\pi \\mathbf{I}$，其中 $\\mathbf{I}$ 是 $d \\times d$ 单位矩阵。因此，倒易矩阵 $\\mathbf{B}$ 可以通过关系式 $\\mathbf{B} = 2\\pi (\\mathbf{A}^{-1})^\\top$ 从实空间矩阵 $\\mathbf{A}$ 计算得出。倒易原胞的体积，与第一布里渊区的体积相同，由 $V^\\star = |\\det(\\mathbf{B})|$ 给出。一个有用的恒等式是 $V^\\star = (2\\pi)^d / |\\det(\\mathbf{A})|$。\n\n对布里渊区上的晶格周期函数进行积分是经常遇到的问题。函数 $F(\\mathbf{k})$ 在布里渊区上的积分为 $I = \\int_{\\text{BZ}} F(\\mathbf{k}) \\, d^d\\mathbf{k}$。由于被积函数相对于倒易晶格具有周期性，该积分等价于在任何倒易原胞上的积分。在计算上，通过线性变换 $\\mathbf{k} = \\mathbf{B}\\mathbf{u}$，执行变量替换为无量纲的简约坐标 $\\mathbf{u} = (u_1, u_2, \\ldots, u_d)$ 是有利的。$\\mathbf{u}$ 的积分域变换为一个单位超立方体，我们选择其为 $[-\\frac{1}{2}, \\frac{1}{2})^d$。此变换的雅可比行列式是 $J = |\\det(\\mathbf{B})| = V^\\star$，意味着微分体积元变换为 $d^d\\mathbf{k} = V^\\star d^d\\mathbf{u}$。于是，积分表示为：\n$$I = V^\\star \\int_{[-\\frac{1}{2}, \\frac{1}{2})^d} F(\\mathbf{B}\\mathbf{u}) \\, d^d\\mathbf{u}$$\n\n问题指定了被积函数 $f(\\mathbf{k}) = \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big)$，其中 $\\beta$ 是一个实数参数。该函数在简约坐标 $u_i$ 中是可分离的。因此，布里渊区积分的精确值 $I_{\\mathrm{exact}}$ 为：\n$$I_{\\mathrm{exact}} = V^\\star \\int_{[-\\frac{1}{2}, \\frac{1}{2})^d} \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big) \\, d^d\\mathbf{u}$$\n根据可分离性，乘积的积分等于积分的乘积：\n$$I_{\\mathrm{exact}} = V^\\star \\prod_{i=1}^{d} \\int_{-1/2}^{1/2} \\exp\\!\\big(\\beta \\cos(2\\pi u_i)\\big) \\, du_i$$\n给定恒等式 $\\int_{0}^{1} \\exp\\!\\big(\\beta \\cos(2\\pi u)\\big) \\, du = I_0(\\beta)$，其中 $I_0$ 是第一类零阶修正贝塞尔函数，并注意到被积函数 $\\exp(\\beta\\cos(2\\pi u))$ 的周期为1，因此在 $[-\\frac{1}{2}, \\frac{1}{2})$ 上的积分等价于在 $[0, 1)$ 上的积分。于是，精确积分的计算结果为：\n$$I_{\\mathrm{exact}} = V^\\star [I_0(\\beta)]^d$$\n\n该积分的数值近似是使用 Monkhorst-Pack 方案进行的。该方法用在倒易原胞内均匀采样点网格上的离散和来代替连续积分。该网格通过将第 $i$ 个倒易原胞轴分成 $N_i$ 个等分段来定义。为了保持反演对称性，采样点位于这些分段的中点。对于域 $[-\\frac{1}{2}, \\frac{1}{2})^d$ 的简约坐标，网格点 $\\mathbf{u}_{\\mathbf{j}}$ 的坐标由以下公式给出：\n$$u_i = \\frac{j_i + 1/2}{N_i} - \\frac{1}{2}, \\quad \\text{for } j_i = 0, 1, \\ldots, N_i - 1$$\n网格中的总点数为 $N_{\\text{tot}} = \\prod_{i=1}^d N_i$。该积分通过中点法则进行近似，其中每个点带有相等的权重，对应于 $V^\\star / N_{\\text{tot}}$ 的子体积。积分的数值估计值 $I_{\\mathrm{MP}}$ 为：\n$$I_{\\mathrm{MP}} = V^\\star \\frac{1}{N_{\\text{tot}}} \\sum_{\\text{grid}} f(\\mathbf{B}\\mathbf{u}_{\\mathbf{j}}) = V^\\star \\frac{1}{\\prod_i N_i} \\sum_{\\mathbf{j}} \\prod_{i=1}^{d} \\exp\\!\\big(\\beta \\cos(2\\pi u_{i,j_i})\\big)$$\n\n对于每个测试用例，最终需要计算的量是相对误差 $E$，定义为：\n$$E = \\frac{\\left|I_{\\mathrm{MP}} - I_{\\mathrm{exact}}\\right|}{\\left|I_{\\mathrm{exact}}\\right|}$$\n对于 $\\beta = 0$ 的特殊情况，被积函数变为 $f(\\mathbf{k}) = 1$。因此，$I_0(0) = 1$，导致 $I_{\\mathrm{exact}} = V^\\star$。数值求和也得到 $I_{\\mathrm{MP}} = V^\\star \\frac{1}{N_{\\text{tot}}} \\sum 1 = V^\\star$。因此，误差必须精确为 $E=0$，这为实现提供了一个鲁棒的验证检查。\n\n程序逻辑首先为每个测试用例定义参数。对于每个用例，它构建实空间矩阵 $\\mathbf{A}$，计算倒易矩阵 $\\mathbf{B}$ 和体积 $V^\\star$，计算精确积分 $I_{\\mathrm{exact}}$，生成 MP 网格点，评估数值积分 $I_{\\mathrm{MP}}$，最后计算相对误差 $E$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    It calculates the relative error of Monkhorst-Pack integration for a given\n    integrand on various Bravais lattices.\n    \"\"\"\n\n    nm_to_m = 1e-9\n\n    # The test cases are defined as a list of dictionaries.\n    # Each dictionary contains all parameters for a single calculation.\n    test_cases = [\n        # T1: 2D square\n        {'name': 'T1', 'dim': 2, 'lattice_type': 'square', 'params': {'a': 0.3}, 'mesh': (1, 1), 'beta': 0.7},\n        # T2: 2D square\n        {'name': 'T2', 'dim': 2, 'lattice_type': 'square', 'params': {'a': 0.3}, 'mesh': (4, 4), 'beta': 0.7},\n        # T3: 2D square\n        {'name': 'T3', 'dim': 2, 'lattice_type': 'square', 'params': {'a': 0.3}, 'mesh': (16, 16), 'beta': 0.7},\n        # T4: 2D triangular\n        {'name': 'T4', 'dim': 2, 'lattice_type': 'triangular', 'params': {'a': 0.25}, 'mesh': (5, 5), 'beta': 0.7},\n        # T5: 3D simple cubic\n        {'name': 'T5', 'dim': 3, 'lattice_type': 'sc', 'params': {'a': 0.5}, 'mesh': (2, 2, 2), 'beta': 0.5},\n        # T6: 3D simple cubic\n        {'name': 'T6', 'dim': 3, 'lattice_type': 'sc', 'params': {'a': 0.5}, 'mesh': (8, 8, 8), 'beta': 0.5},\n        # T7: 3D BCC\n        {'name': 'T7', 'dim': 3, 'lattice_type': 'bcc', 'params': {'a': 0.35}, 'mesh': (3, 3, 3), 'beta': 1.0},\n        # T8: 3D FCC\n        {'name': 'T8', 'dim': 3, 'lattice_type': 'fcc', 'params': {'a': 0.35}, 'mesh': (5, 5, 5), 'beta': 0.6},\n        # T9: 2D rectangular\n        {'name': 'T9', 'dim': 2, 'lattice_type': 'rectangular', 'params': {'ax': 0.4, 'ay': 0.7}, 'mesh': (3, 5), 'beta': 0.9},\n        # T10: 3D simple cubic (beta=0)\n        {'name': 'T10', 'dim': 3, 'lattice_type': 'sc', 'params': {'a': 0.5}, 'mesh': (3, 4, 5), 'beta': 0.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        dim = case['dim']\n        lattice_type = case['lattice_type']\n        params = case['params']\n        N_mesh = case['mesh']\n        beta = case['beta']\n\n        # Construct the real-space primitive matrix A\n        A = None\n        if lattice_type == 'square':\n            a = params['a'] * nm_to_m\n            A = np.array([[a, 0], [0, a]])\n        elif lattice_type == 'triangular':\n            a = params['a'] * nm_to_m\n            A = a * np.array([[1, 0.5], [0, np.sqrt(3)/2]])\n        elif lattice_type == 'sc':\n            a = params['a'] * nm_to_m\n            A = a * np.identity(3)\n        elif lattice_type == 'bcc':\n            a = params['a'] * nm_to_m\n            A = (a / 2) * np.array([[1, -1, 1], [1, 1, -1], [-1, 1, 1]])\n        elif lattice_type == 'fcc':\n            a = params['a'] * nm_to_m\n            A = (a / 2) * np.array([[0, 1, 1], [1, 0, 1], [1, 1, 0]])\n        elif lattice_type == 'rectangular':\n            ax = params['ax'] * nm_to_m\n            ay = params['ay'] * nm_to_m\n            A = np.array([[ax, 0], [0, ay]])\n\n        # Reciprocal lattice calculations\n        # B = 2*pi*(A^-1)^T\n        B = 2 * np.pi * np.linalg.inv(A).T\n        # Volume of reciprocal primitive cell\n        V_star = np.abs(np.linalg.det(B))\n\n        # Exact integral calculation\n        # I_exact = V_star * [I_0(beta)]^d\n        I_exact = V_star * (i0(beta) ** dim)\n\n        # Numerical integral using Monkhorst-Pack grid\n        # The integrand is separable, so we can compute the sum for each\n        # dimension independently and then multiply the results.\n        \n        one_dim_sums = []\n        for i in range(dim):\n            N_i = N_mesh[i]\n            # Generate midpoint grid in reduced coordinates [-0.5, 0.5)\n            u_i = (np.arange(N_i) + 0.5) / N_i - 0.5\n            # Evaluate the 1D part of the integrand at grid points\n            f_vals = np.exp(beta * np.cos(2 * np.pi * u_i))\n            # Sum the values\n            one_dim_sums.append(np.sum(f_vals))\n        \n        # Product of sums gives the total sum over the grid\n        total_sum = np.prod(one_dim_sums)\n        \n        # Calculate the numerical integral estimate\n        I_mp = V_star * total_sum / np.prod(N_mesh)\n\n        # Compute the relative error\n        # A check for I_exact == 0 avoids division by zero, although I_0(beta) >= 1 for real beta.\n        if np.abs(I_exact)  1e-15:\n            # If exact is 0, error is 0 only if MP is also 0.\n            error = 0.0 if np.abs(I_mp)  1e-15 else np.inf\n        else:\n            error = np.abs(I_mp - I_exact) / np.abs(I_exact)\n        \n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}