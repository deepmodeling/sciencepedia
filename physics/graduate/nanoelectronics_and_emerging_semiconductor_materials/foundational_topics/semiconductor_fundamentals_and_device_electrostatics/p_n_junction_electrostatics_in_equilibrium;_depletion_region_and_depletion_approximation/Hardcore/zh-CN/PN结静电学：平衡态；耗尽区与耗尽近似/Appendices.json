{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握p-n结的静电学特性，第一步是建立其核心的数学模型。本练习将指导您从基本物理定律出发——即泊松方程和耗尽近似——来推导耗尽区内的电场和电势分布。通过这个推导，您将亲眼看到标志性的三角形电场和抛物线形电势轮廓是如何形成的，为理解p-n结的所有电学行为奠定坚实的数学基础。",
            "id": "4291232",
            "problem": "考虑一个处于热平衡状态的突变单维硅$p$-$n$结，该结由均匀掺杂的$p$型区和$n$型区构成，其受主密度和施主密度分别为$N_{A}$和$N_{D}$。设冶金结位于$x=0$处，$p$区占据$x<0$，$n$区占据$x>0$。假设采用耗尽近似：在耗尽区中忽略所有可动载流子，空间电荷仅由电离的施主和受主产生。该半导体具有空间均匀的介电常数$\\varepsilon$。用$q$表示元电荷量值，$p$区和$n$区的耗尽宽度分别用$x_{p}$和$x_{n}$表示，内建电势用$V_{\\text{bi}}$表示。\n\n从第一性原理出发——即，适用于一维静电学的微分形式高斯定律和电势的定义——推导耗尽区内$p$区和$n$区两侧的电场$E(x)$和静电势$\\phi(x)$的闭合形式表达式。施加适用于耗尽近似的物理上一致的边界条件和匹配条件（包括电场在耗尽区边缘为零，$E(x)$和$\\phi(x)$在$x=0$处连续，以及耗尽区的电中性），并消去$x_p$和$x_n$，用$N_{A}$、$N_{D}$、$\\varepsilon$、$q$和$V_{\\text{bi}}$来表示。\n\n你的最终表达式必须明确展示：\n- 结两侧关于$x$的线性（三角形）电场分布，以及\n- 结两侧关于$x$的二次（抛物线）电势分布。\n\n电场以伏特/米表示，静电势以伏特表示。仅以符号表达式提供最终答案；不要代入数值。最终答案必须包含完全显式的$E(x)$和$\\phi(x)$分布，以及用$N_{A}$、$N_{D}$、$\\varepsilon$、$q$和$V_{\\text{bi}}$表示的消去后的$x_p$和$x_n$形式。",
            "solution": "问题陈述已根据所需标准进行评估，并被认为是有效的。这是一个半导体器件物理学中标准的、适定的问题，其基础是基本的静电学原理。所有必要的条件和参数都已提供，不存在矛盾或科学上的不准确之处。\n\n在耗尽近似下，$p$-$n$结耗尽区内的电场$E(x)$和静电势$\\phi(x)$的推导从第一性原理出发，具体来说是泊松方程。\n\n**1. 基本方程**\n\n在一维情况下，泊松方程将静电势$\\phi(x)$与体电荷密度$\\rho(x)$联系起来：\n$$\n\\frac{d^2\\phi(x)}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon}\n$$\n其中$\\varepsilon$是半导体的介电常数。电场$E(x)$是电势的负梯度：\n$$\nE(x) = -\\frac{d\\phi(x)}{dx}\n$$\n将这两者结合起来，得到该一维系统的微分形式高斯定律：\n$$\n\\frac{dE(x)}{dx} = \\frac{\\rho(x)}{\\varepsilon}\n$$\n\n**2. 耗尽近似下的电荷密度**\n\n耗尽近似假设，在从$p$区的$x = -x_p$延伸到$n$区的$x = x_n$的耗尽区内，空间电荷仅由电离的、固定的掺杂原子产生。可动载流子（空穴和电子）被假定为完全耗尽。\n- 在$p$型区（$-x_p \\le x  0$），电荷密度来自带负电的电离受主：$\\rho(x) = -qN_A$。\n- 在$n$型区（$0  x \\le x_n$），电荷密度来自带正电的电离施主：$\\rho(x) = +qN_D$。\n在耗尽区之外（$x  -x_p$和$x > x_n$），材料是电中性的，因此$\\rho(x) = 0$。\n\n**3. 电场$E(x)$的推导**\n\n通过对高斯定律积分，并应用电场在耗尽区边缘必须为零的边界条件，即$E(-x_p) = 0$和$E(x_n) = 0$，可以求得电场。\n\n- **对于$p$区侧（$-x_p \\le x  0$）：**\n$$\n\\frac{dE}{dx} = -\\frac{qN_A}{\\varepsilon}\n$$\n从耗尽区边缘$-x_p$积分到该区域内的一点$x$：\n$$\n\\int_{E(-x_p)}^{E(x)} dE' = \\int_{-x_p}^{x} -\\frac{qN_A}{\\varepsilon} dx'\n$$\n$$\nE(x) - E(-x_p) = -\\frac{qN_A}{\\varepsilon}(x - (-x_p))\n$$\n由于$E(-x_p) = 0$，我们得到：\n$$\nE(x) = -\\frac{qN_A}{\\varepsilon}(x + x_p)\n$$\n此表达式显示$E$对$x$呈线性依赖关系。\n\n- **对于$n$区侧（$0  x \\le x_n$）：**\n$$\n\\frac{dE}{dx} = \\frac{qN_D}{\\varepsilon}\n$$\n从一点$x$积分到耗尽区边缘$x_n$：\n$$\n\\int_{E(x)}^{E(x_n)} dE' = \\int_{x}^{x_n} \\frac{qN_D}{\\varepsilon} dx'\n$$\n$$\nE(x_n) - E(x) = \\frac{qN_D}{\\varepsilon}(x_n - x)\n$$\n由于$E(x_n) = 0$，我们得到：\n$$\nE(x) = -\\frac{qN_D}{\\varepsilon}(x_n - x) = \\frac{qN_D}{\\varepsilon}(x - x_n)\n$$\n这也是$x$的线性函数。因此，电场分布是三角形的，在冶金结$x=0$处达到其最大量值（最负值）。\n\n**4. 电中性与耗尽宽度**\n\n整个耗尽区必须是电中性的。$p$区侧的总负电荷必须平衡$n$区侧的总正电荷。对于横截面积为$A$的结：\n$$\n(-qN_A)(x_p A) + (qN_D)(x_n A) = 0\n$$\n$$\nN_A x_p = N_D x_n\n$$\n该条件也保证了电场在$x=0$处的连续性。将我们得到的$E(x)$表达式在$x=0$处求值：\n$$\nE(0) = -\\frac{qN_A x_p}{\\varepsilon} = -\\frac{qN_D x_n}{\\varepsilon}\n$$\n这与电中性条件一致。\n\n**5. 静电势$\\phi(x)$的推导**\n\n通过对$E(x) = -d\\phi/dx$积分来求得电势$\\phi(x)$。我们必须设定一个电势参考点。一个方便的选择是将中性$p$区的电势设为零，即$\\phi(-x_p) = 0$。穿过结的总电势差是内建电势$V_{\\text{bi}}$，因此$\\phi(x_n) = V_{\\text{bi}}$。\n\n- **对于$p$区侧（$-x_p \\le x  0$）：**\n$$\n\\phi(x) - \\phi(-x_p) = -\\int_{-x_p}^{x} E(x') dx' = -\\int_{-x_p}^{x} \\left(-\\frac{qN_A}{\\varepsilon}(x' + x_p)\\right) dx'\n$$\n$$\n\\phi(x) - 0 = \\frac{qN_A}{\\varepsilon} \\left[ \\frac{(x' + x_p)^2}{2} \\right]_{-x_p}^{x}\n$$\n$$\n\\phi(x) = \\frac{qN_A}{2\\varepsilon}(x + x_p)^2\n$$\n该分布是关于$x$的二次（抛物线）函数。\n\n- **对于$n$区侧（$0  x \\le x_n$）：**\n我们从$x$积分到边界$x_n$：\n$$\n\\phi(x_n) - \\phi(x) = -\\int_{x}^{x_n} E(x') dx' = -\\int_{x}^{x_n} \\left(\\frac{qN_D}{\\varepsilon}(x' - x_n)\\right) dx'\n$$\n$$\nV_{\\text{bi}} - \\phi(x) = -\\frac{qN_D}{\\varepsilon} \\left[ \\frac{(x' - x_n)^2}{2} \\right]_{x}^{x_n} = -\\frac{qN_D}{\\varepsilon} \\left( 0 - \\frac{(x - x_n)^2}{2} \\right)\n$$\n$$\nV_{\\text{bi}} - \\phi(x) = \\frac{qN_D}{2\\varepsilon}(x - x_n)^2\n$$\n求解$\\phi(x)$：\n$$\n\\phi(x) = V_{\\text{bi}} - \\frac{qN_D}{2\\varepsilon}(x_n - x)^2\n$$\n该分布也是关于$x$的二次函数。$\\phi(x)$在$x=0$处的连续性由后续步骤保证。\n\n**6. $x_p$和$x_n$的最终确定**\n\n内建电势是整个耗尽区上的总电势降：$V_{\\text{bi}} = \\phi(x_n) - \\phi(-x_p)$。使用我们推导出的电势表达式，并在边界处求值：\n$$\nV_{\\text{bi}} = \\left(V_{\\text{bi}} - \\frac{qN_D}{2\\varepsilon}(x_n - x_n)^2\\right) - \\left(\\frac{qN_A}{2\\varepsilon}(-x_p + x_p)^2\\right) = V_{\\text{bi}}\n$$\n一个更有用的关系可以通过从$\\phi(-x_p)=0$开始，在整个区域上积分来计算$\\phi(x_n)$得到。这等价于令$\\phi(0)$的两个表达式相等。从$p$区侧的表达式，$\\phi(0) = \\frac{qN_A x_p^2}{2\\varepsilon}$。从$n$区侧，$\\phi(0) = V_{\\text{bi}} - \\frac{qN_D x_n^2}{2\\varepsilon}$。令它们相等：\n$$\n\\frac{qN_A x_p^2}{2\\varepsilon} = V_{\\text{bi}} - \\frac{qN_D x_n^2}{2\\varepsilon} \\implies V_{\\text{bi}} = \\frac{q}{2\\varepsilon}(N_A x_p^2 + N_D x_n^2)\n$$\n现在我们有一个关于$x_p$和$x_n$的方程组：\n1. $N_A x_p = N_D x_n$\n2. $V_{\\text{bi}} = \\frac{q}{2\\varepsilon}(N_A x_p^2 + N_D x_n^2)$\n\n从(1)式，我们将$x_n = \\frac{N_A}{N_D}x_p$代入(2)式：\n$$\nV_{\\text{bi}} = \\frac{q}{2\\varepsilon}\\left(N_A x_p^2 + N_D \\left(\\frac{N_A}{N_D}x_p\\right)^2\\right) = \\frac{qN_A x_p^2}{2\\varepsilon}\\left(1 + \\frac{N_A}{N_D}\\right) = \\frac{qN_A x_p^2}{2\\varepsilon}\\left(\\frac{N_A+N_D}{N_D}\\right)\n$$\n求解$x_p$：\n$$\nx_p = \\sqrt{\\frac{2\\varepsilon V_{\\text{bi}}}{q} \\frac{N_D}{N_A(N_A + N_D)}}\n$$\n类似地，将$x_p = \\frac{N_D}{N_A}x_n$代入(2)式并求解$x_n$：\n$$\nx_n = \\sqrt{\\frac{2\\varepsilon V_{\\text{bi}}}{q} \\frac{N_A}{N_D(N_A + N_D)}}\n$$\n这些就是用基本参数表示的耗尽宽度的显式表达式。推导完成。$E(x)$和$\\phi(x)$的表达式现在已完全确定。",
            "answer": "$$\n\\boxed{\n\\begin{align*}\nx_p = \\sqrt{\\frac{2\\varepsilon V_{\\text{bi}}}{q} \\frac{N_D}{N_A(N_A + N_D)}} \\\\\nx_n = \\sqrt{\\frac{2\\varepsilon V_{\\text{bi}}}{q} \\frac{N_A}{N_D(N_A + N_D)}} \\\\\nE(x) = \\begin{cases} -\\frac{q N_A}{\\varepsilon} (x + x_p)  \\text{ for } -x_p \\le x  0 \\\\ \\frac{q N_D}{\\varepsilon} (x - x_n)  \\text{ for } 0  x \\le x_n \\end{cases} \\\\\n\\phi(x) = \\begin{cases} \\frac{q N_A}{2\\varepsilon} (x + x_p)^{2}  \\text{ for } -x_p \\le x  0 \\\\ V_{\\text{bi}} - \\frac{q N_D}{2\\varepsilon} (x_n - x)^{2}  \\text{ for } 0  x \\le x_n \\end{cases}\n\\end{align*}\n}\n$$"
        },
        {
            "introduction": "理论模型在应用于实际器件时，常常可以通过合理的近似来简化，从而揭示关键的物理关系。本练习聚焦于一种非常常见的不对称结——单边结（$p^+n$结），其中一侧的掺杂浓度远高于另一侧。您将推导在这种极限情况下，耗尽区宽度、最大电场和电势降等关键参数的简化表达式，并进一步探讨这些静电学特性如何直接影响器件的击穿电压和结电容等重要性能指标。",
            "id": "4291216",
            "problem": "考虑一个在静态介电常数为 $\\varepsilon_s$ 的均匀半导体中形成的突变、平面、长 p-n 结。p 区的受主密度为 $N_A$，n 区的施主密度为 $N_D$，且 $N_A \\gg N_D$。该结处于热平衡状态，且耗尽近似成立：空间电荷区内的移动载流子可以忽略不计，电离的掺杂剂是均匀的，其密度在 p 区耗尽宽度内为 $-q N_A$，在 n 区耗尽宽度内为 $+q N_D$，其中 $q$ 是元电荷。设内建电势表示为 $V_{bi}$。\n\n从泊松方程、适当的静电边界条件以及整个耗尽区的电中性出发，推导在 $N_A \\gg N_D$ 极限下的简化表达式：\n- 总耗尽宽度 $W$，\n- 冶金结处的最大电场 $E_{\\mathrm{max}}$，\n- p 区耗尽区上的电势降 $V_p$，\n- n 区耗尽区上的电势降 $V_n$。\n\n你的最终结果只能用 $q$、$\\varepsilon_s$、$N_A$、$N_D$ 和 $V_{bi}$ 的符号表示。不要计算任何数值。\n\n然后，基于推导出的比例关系和耗尽近似，讨论单边极限 $N_A \\gg N_D$ 对击穿和单位面积小信号结电容的物理意义。\n\n你的最终答案必须按顺序将 $W$、$E_{\\mathrm{max}}$、$V_p$ 和 $V_n$ 的表达式列为一个单行矩阵。不需要数值取整；最终答案中不要包含单位。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n-   **系统**：在均匀半导体中形成的突变、平面、长 p-n 结。\n-   **静态介电常数**：$\\varepsilon_s$。\n-   **掺杂密度**：受主密度 $N_A$ (p 区)，施主密度 $N_D$ (n 区)。\n-   **掺杂不对称性**：$N_A \\gg N_D$。\n-   **状态**：热平衡。\n-   **模型**：耗尽近似成立。\n-   **电荷密度**：均匀，在 p 区耗尽区内值为 $-q N_A$，在 n 区耗尽区内值为 $+q N_D$。空间电荷区内的移动载流子可忽略不计。\n-   **常数**：$q$ (元电荷)。\n-   **电势**：内建电势为 $V_{bi}$。\n-   **目标**：在 $N_A \\gg N_D$ 极限下，推导总耗尽宽度 $W$、最大电场 $E_{\\mathrm{max}}$、p 区耗尽区上的电势降 $V_p$ 和 n 区耗尽区上的电势降 $V_n$ 的简化表达式。\n-   **结果约束**：结果仅用 $q$、$\\varepsilon_s$、$N_A$、$N_D$ 和 $V_{bi}$ 表示。\n-   **次要目标**：讨论对击穿和小信号结电容的物理意义。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据（关键）**：该问题基于半导体物理学中 p-n 结的标准基本模型。泊松方程、耗尽近似和内建电势的概念都是公认的原理。条件 $N_A \\gg N_D$ 描述了一个单边（或 $p^+n$）结，这是一种常见且物理上现实的配置。该问题在科学上是合理的。\n-   **适定性**：该问题提供了推导所需量所需的所有必要信息（掺杂密度、介电常数、内建电势）和清晰的物理模型（耗尽近似）。目标明确，可以推导出一组唯一的表达式。该问题是适定的。\n-   **客观性（关键）**：该问题使用半导体物理学中精确、标准的术语进行陈述。它不含主观语言、观点或偏见。\n-   **相关性**：该问题直接涉及提示上下文中指定的 *纳米电子学和新兴半导体材料* 领域内的 *平衡状态下的 p-n 结静电学；耗尽区和耗尽近似* 这一主题。\n\n### 步骤 3：结论与行动\n该问题有效。它是固态物理学中的一个标准教科书问题，并且是自洽、一致且科学合理的。我将继续进行解答。\n\n## 静电特性的推导\n\n我们从一维泊松方程开始，该方程将电场 $E(x)$ 的空间变化与净电荷密度 $\\rho(x)$ 联系起来：\n$$\n\\frac{dE}{dx} = \\frac{\\rho(x)}{\\varepsilon_s}\n$$\n设冶金结位于 $x=0$。p 区位于 $x0$，n 区位于 $x0$。耗尽区在 p 区从 $x=-x_p$ 延伸到 n 区的 $x=x_n$。在耗尽近似下，电荷密度 $\\rho(x)$ 由下式给出：\n$$\n\\rho(x) =\n\\begin{cases}\n-q N_A   \\text{对于 } -x_p  x  0 \\\\\n+q N_D   \\text{对于 } 0  x  x_n \\\\\n0   \\text{其他情况}\n\\end{cases}\n$$\n电场在耗尽区外为零，因此我们有边界条件 $E(-x_p) = 0$ 和 $E(x_n) = 0$。\n\n首先，我们对泊松方程积分以求得电场 $E(x)$。\n对于 p 区（$-x_p  x  0$）：\n$$\nE(x) = \\int_{-x_p}^{x} \\frac{-q N_A}{\\varepsilon_s} dx' = -\\frac{q N_A}{\\varepsilon_s} (x + x_p)\n$$\n对于 n 区（$0 \\leq x  x_n$）：\n$$\nE(x) = E(0) + \\int_{0}^{x} \\frac{q N_D}{\\varepsilon_s} dx'\n$$\n在 $x=0$ 处，电场是连续的。使用 p 区的表达式，我们得到 $E(0) = -\\frac{q N_A x_p}{\\varepsilon_s}$。\n将此代入 n 区的表达式中：\n$$\nE(x) = -\\frac{q N_A x_p}{\\varepsilon_s} + \\frac{q N_D x}{\\varepsilon_s}\n$$\n应用边界条件 $E(x_n) = 0$：\n$$\n0 = -\\frac{q N_A x_p}{\\varepsilon_s} + \\frac{q N_D x_n}{\\varepsilon_s} \\implies q N_A x_p = q N_D x_n\n$$\n这是电中性条件：p 区的总负电荷必须等于 n 区的总正电荷。\n\n最大电场强度 $E_{\\mathrm{max}}$ 出现在结处 $x=0$：\n$$\nE_{\\mathrm{max}} = |E(0)| = \\frac{q N_A x_p}{\\varepsilon_s} = \\frac{q N_D x_n}{\\varepsilon_s}\n$$\n总耗尽宽度为 $W = x_p + x_n$。根据电中性，我们可以写出 $x_p = \\frac{N_D}{N_A} x_n$。因此，$W = x_n (1 + \\frac{N_D}{N_A})$。\n\n内建电势 $V_{bi}$ 是跨越整个耗尽区的总电势降。它是电场从 $-x_p$ 到 $x_n$ 的负积分：\n$$\nV_{bi} = - \\int_{-x_p}^{x_n} E(x) dx\n$$\n这个积分表示三角形 $E(x)$ 分布面积的负值。\n$$\nV_{bi} = - \\left( \\frac{1}{2} \\cdot W \\cdot E(0) \\right) = \\frac{1}{2} W E_{\\mathrm{max}}\n$$\n代入 $W$ 和 $E_{\\mathrm{max}}$ 的表达式：\n$$\nV_{bi} = \\frac{1}{2} (x_p + x_n) \\left( \\frac{q N_D x_n}{\\varepsilon_s} \\right) = \\frac{1}{2} \\left(\\frac{N_D}{N_A}x_n + x_n\\right) \\left( \\frac{q N_D x_n}{\\varepsilon_s} \\right) = \\frac{q N_D}{2 \\varepsilon_s} x_n^2 \\left(1 + \\frac{N_D}{N_A}\\right)\n$$\n求解 $x_n$：\n$$\nx_n = \\sqrt{\\frac{2 \\varepsilon_s V_{bi}}{q N_D (1 + N_D/N_A)}} = \\sqrt{\\frac{2 \\varepsilon_s V_{bi} N_A}{q N_D (N_A + N_D)}}\n$$\n并使用 $x_p = \\frac{N_D}{N_A} x_n$ 求解 $x_p$：\n$$\nx_p = \\frac{N_D}{N_A} \\sqrt{\\frac{2 \\varepsilon_s V_{bi} N_A}{q N_D (N_A + N_D)}} = \\sqrt{\\frac{2 \\varepsilon_s V_{bi} N_D}{q N_A (N_A + N_D)}}\n$$\n总宽度 $W$ 为 $x_p + x_n$：\n$$\nW = \\sqrt{\\frac{2 \\varepsilon_s V_{bi}}{q}} \\left( \\sqrt{\\frac{N_D}{N_A(N_A+N_D)}} + \\sqrt{\\frac{N_A}{N_D(N_A+N_D)}} \\right) = \\sqrt{\\frac{2 \\varepsilon_s V_{bi} (N_A+N_D)}{q N_A N_D}}\n$$\n\n现在，我们对 $N_A \\gg N_D$ 的 $p^+n$ 结应用单边近似。在此极限下，$N_A + N_D \\approx N_A$。\n- **耗尽宽度 $W$**：\n耗尽区主要延伸到轻掺杂一侧。\n$x_p \\approx \\sqrt{\\frac{2 \\varepsilon_s V_{bi} N_D}{q N_A^2}} = \\frac{N_D}{N_A} \\sqrt{\\frac{2 \\varepsilon_s V_{bi}}{q N_D}}$。由于 $N_D/N_A \\ll 1$，$x_p$ 非常小。\n$x_n \\approx \\sqrt{\\frac{2 \\varepsilon_s V_{bi} N_A}{q N_D N_A}} = \\sqrt{\\frac{2 \\varepsilon_s V_{bi}}{q N_D}}$。\n总宽度 $W = x_p + x_n \\approx x_n$。\n$$\nW \\approx \\sqrt{\\frac{2 \\varepsilon_s V_{bi}}{q N_D}}\n$$\n- **最大电场 $E_{\\mathrm{max}}$**：\n使用 $E_{\\mathrm{max}} = \\frac{q N_D x_n}{\\varepsilon_s}$ 和 $x_n$ 的简化表达式：\n$$\nE_{\\mathrm{max}} \\approx \\frac{q N_D}{\\varepsilon_s} \\sqrt{\\frac{2 \\varepsilon_s V_{bi}}{q N_D}} = \\sqrt{\\frac{q^2 N_D^2}{\\varepsilon_s^2} \\frac{2 \\varepsilon_s V_{bi}}{q N_D}} = \\sqrt{\\frac{2 q N_D V_{bi}}{\\varepsilon_s}}\n$$\n- **电势降 $V_p$ 和 $V_n$**：\np 区的电势降为 $V_p = V(0) - V(-x_p) = \\frac{1}{2} x_p E_{\\mathrm{max}}$。\nn 区的电势降为 $V_n = V(x_n) - V(0) = \\frac{1}{2} x_n E_{\\mathrm{max}}$。\n比值为 $\\frac{V_p}{V_n} = \\frac{x_p}{x_n} = \\frac{N_D}{N_A}$。\n由于 $V_p + V_n = V_{bi}$，我们有 $V_p = V_{bi} - V_n$。\n代入比值中：$\\frac{V_{bi} - V_n}{V_n} = \\frac{N_D}{N_A} \\implies V_{bi} = V_n (1 + \\frac{N_D}{N_A}) = V_n \\frac{N_A+N_D}{N_A}$。\n因此，$V_n = V_{bi} \\frac{N_A}{N_A+N_D}$ 且 $V_p = V_{bi} \\frac{N_D}{N_A+N_D}$。\n应用极限 $N_A \\gg N_D$：\n$$\nV_n \\approx V_{bi} \\frac{N_A}{N_A} = V_{bi}\n$$\n$$\nV_p \\approx V_{bi} \\frac{N_D}{N_A}\n$$\n这证实了在单边结中，几乎整个内建电势都降落在轻掺杂一侧。\n\n## 物理意义\n\n为 $N_A \\gg N_D$ 极限推导出的比例关系对器件设计和表征具有重要意义。我们考虑一个施加了反向偏压 $V_R$ 的结，此时总电势降变为 $V_{bi} + V_R$。\n\n- **击穿电压**：当最大电场 $E_{\\mathrm{max}}$ 达到临界值 $E_{crit}$（一种材料属性）时，会发生雪崩击穿。对于反向偏置的结，$E_{\\mathrm{max}}$ 由下式给出：\n$$\nE_{\\mathrm{max}} \\approx \\sqrt{\\frac{2 q N_D (V_{bi} + V_R)}{\\varepsilon_s}}\n$$\n击穿电压 $V_{BR}$ 是当 $E_{\\mathrm{max}} = E_{crit}$ 时 $V_R$ 的值。\n$$\nE_{crit}^2 \\approx \\frac{2 q N_D (V_{bi} + V_{BR})}{\\varepsilon_s} \\implies V_{BR} + V_{bi} \\approx \\frac{\\varepsilon_s E_{crit}^2}{2 q N_D}\n$$\n由于通常 $V_{BR} \\gg V_{bi}$，我们发现 $V_{BR} \\propto \\frac{1}{N_D}$。击穿电压与轻掺杂一侧的掺杂浓度成反比。重掺杂一侧 ($N_A$) 的影响可以忽略不计。为了制造具有高击穿电压的二极管，结的一侧必须非常轻地掺杂。\n\n- **小信号结电容**：单位面积的结电容 $C_j$ 定义为单位面积存储的耗尽电荷 $Q$ 相对于所施加反向电压变化的改变量，即 $C_j = \\left| \\frac{dQ}{dV_R} \\right|$。存储的电荷为 $Q = q N_D x_n$。在反向偏置下的单边极限中，耗尽宽度为：\n$$\nW \\approx x_n \\approx \\sqrt{\\frac{2 \\varepsilon_s (V_{bi} + V_R)}{q N_D}}\n$$\n该电容可以建模为一个板间距为 $W$ 的平行板电容器：\n$$\nC_j = \\frac{\\varepsilon_s}{W} \\approx \\varepsilon_s \\left/ \\sqrt{\\frac{2 \\varepsilon_s (V_{bi} + V_R)}{q N_D}} \\right. = \\sqrt{\\frac{q \\varepsilon_s N_D}{2 (V_{bi} + V_R)}}\n$$\n这个表达式表明，电容由轻掺杂一侧的掺杂 ($N_D$) 和总电势降决定。随着反向偏压的增加，电容减小（因为 $W$ 增加）。$1/C_j^2$ 对 $V_R$ 的曲线图会得到一条直线：\n$$\n\\frac{1}{C_j^2} \\approx \\frac{2(V_{bi} + V_R)}{q \\varepsilon_s N_D}\n$$\n这条线的斜率为 $\\frac{2}{q \\varepsilon_s N_D}$，由此可以实验确定轻掺杂一侧的掺杂浓度 $N_D$。这是电容-电压 (C-V) 分析法的基础。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{2 \\varepsilon_s V_{bi}}{q N_D}}  \\sqrt{\\frac{2 q N_D V_{bi}}{\\varepsilon_s}}  V_{bi} \\frac{N_D}{N_A}  V_{bi}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "任何近似模型都有其适用范围，理解其局限性与掌握模型本身同样重要。本练习将引导您超越耗尽近似，通过数值方法求解更精确的泊松-玻尔兹曼方程。您将亲手编写程序，计算在不同掺杂条件下，由耗尽近似引入的内置电势和耗尽宽度的误差。这项实践不仅能加深您对耗尽近似本质的理解，也为您提供了从解析理论通往计算器件模拟的桥梁。",
            "id": "4291243",
            "problem": "考虑一个一维突变 $p$-$n$ 结，在静电平衡状态下，位于一个非简并、完全电离的半导体中，其中当 $x  0$ 时施主密度为 $N_D$，当 $x  0$ 时受主密度为 $N_A$。设本征载流子浓度为 $n_i$，绝对温度为 $T$，元电荷为 $q$，介电常数为 $\\epsilon = \\epsilon_r \\epsilon_0$（其中 $\\epsilon_0$ 为真空介电常数，$\\epsilon_r$ 为相对介电常数），热电压为 $V_T = k_B T / q$（其中 $k_B$ 为 Boltzmann 常数）。假设采用非简并 Boltzmann 统计，且掺杂剂完全电离。\n\n从以下基本定律和核心定义出发：\n\n- 一维静电学 Poisson 方程：$$\\frac{d^2 \\psi(x)}{dx^2} = -\\frac{\\rho(x)}{\\epsilon},$$ 其中 $\\psi(x)$ 是静电势，$\\rho(x)$ 是电荷密度。\n- 在非简并 Boltzmann 统计下，平衡状态的载流子浓度：$$n(x) = n_i e^{u(x)}, \\quad p(x) = n_i e^{-u(x)},$$ 其中归一化静电势 $u(x) = \\psi(x)/V_T$ 是相对于本征能级的。\n- 完全电离下的空间电荷密度：$$\\rho(x) = q\\left[p(x) - n(x) + N_D(x) - N_A(x)\\right],$$ 其中 $N_D(x)$ 在 $x  0$ 时为 $N_D$，否则为 $0$；$N_A(x)$ 在 $x  0$ 时为 $N_A$，否则为 $0$。\n- 远场准中性边界条件：$$u(-\\infty) = -\\ln\\!\\left(\\frac{N_A}{n_i}\\right), \\quad u(+\\infty) = +\\ln\\!\\left(\\frac{N_D}{n_i}\\right),$$ 这反映了在 $p$ 区和 $n$ 区远端由多数载流子主导的电中性。\n\n推导并实现一个数值方法，使用基于二阶有限差分法的牛顿法，在一个足够大的有限域上求解由此产生的 $u(x)$ 的 Poisson–Boltzmann 边值问题，以近似 $x \\to \\pm \\infty$ 的情况。根据计算出的电势 $\\psi(x) = V_T u(x)$，确定内建电势和工作耗尽宽度，并将它们与耗尽近似下的预测值进行比较。\n\n需计算的定义和量：\n\n1. 平衡状态下的真实内建电势：$$V_{bi,\\text{true}} = V_T \\ln\\!\\left(\\frac{N_A N_D}{n_i^2}\\right),$$ 该公式由费米能级相等和远场电中性条件推导得出。\n2. 通过 Poisson–Boltzmann 解数值确定的内建电势，即计算域两端的电势差：$$V_{bi,\\text{PB}} = \\psi(+L) - \\psi(-L),$$ 其中 $L$ 是半域尺寸，如下文所述，其大小需足够大。\n3. 耗尽近似预测耗尽区内的空间电荷为分段恒定，在其他区域为零，电场在结处连续，并在耗尽区边缘处为零。使用这些约束条件，推导以 $V_{bi}$、$N_A$、$N_D$、$q$ 和 $\\epsilon$ 表示的 $p$ 区和 $n$ 区的耗尽宽度以及总耗尽宽度 $W_{\\text{DA}}$。\n4. 由 Poisson–Boltzmann 解得到的工作耗尽宽度 $W_{\\text{PB}}$ 定义为包含总内建电势降 $\\alpha$ 分数的最小区间 $[x_1, x_2]$，其中 $\\alpha \\in (0,1)$。对于单调的 $\\psi(x)$，这等效于选择 $x_1$ 和 $x_2$ 使得：$$\\psi(x_1) = \\psi(-L) + \\frac{1-\\alpha}{2} V_{bi,\\text{true}}, \\quad \\psi(x_2) = \\psi(+L) - \\frac{1-\\alpha}{2} V_{bi,\\text{true}},$$ 并设 $$W_{\\text{PB}} = x_2 - x_1.$$\n\n您的程序必须：\n\n- 在对称域 $x \\in [-L,L]$ 上，求解归一化的 Poisson–Boltzmann 方程：$$\\frac{d^2 u(x)}{dx^2} = \\frac{q}{\\epsilon V_T}\\left[n_i\\left(e^{u(x)} - e^{-u(x)}\\right) - \\left(N_D(x) - N_A(x)\\right)\\right],$$ 边界条件为给定的 Dirichlet 边界条件 $u(-L)$ 和 $u(+L)$。选择 $$L = 10 \\max\\left(\\sqrt{\\frac{\\epsilon V_T}{q N_A}}, \\sqrt{\\frac{\\epsilon V_T}{q N_D}}\\right),$$ 这是较大一侧德拜长度的十倍，确保边界有效地呈准中性。\n- 使用至少包含 $N=2000$ 个点的均匀空间网格，并对内部点的二阶有限差分残差使用牛顿法，直到残差的无穷范数低于 $10^{-10}$，或达到最大迭代次数 $50$ 次。\n- 计算 $V_{bi,\\text{true}}$、$V_{bi,\\text{PB}}$、$W_{\\text{DA}}$（根据您推导的耗尽近似）和 $W_{\\text{PB}}$（使用 $\\alpha$ 分数定义，其中 $\\alpha = 0.99$）。\n- 报告内建电势的绝对误差 $$\\Delta V_{bi} = \\left|V_{bi,\\text{true}} - V_{bi,\\text{PB}}\\right|$$（以伏特表示）和耗尽宽度的绝对误差 $$\\Delta W = \\left|W_{\\text{DA}} - W_{\\text{PB}}\\right|$$（以米表示）。\n\n物理和数值单位：\n\n- 密度 $N_A$、$N_D$ 和 $n_i$ 的单位必须是 $\\mathrm{m}^{-3}$。\n- 温度 $T$ 的单位必须是 $\\mathrm{K}$。\n- 介电常数 $\\epsilon = \\epsilon_r \\epsilon_0$，其中 $\\epsilon_0$ 的单位是 $\\mathrm{F/m}$，$\\epsilon_r$ 是无量纲的。\n- 计算出的 $V_{bi}$ 必须以伏特表示，$W$ 必须以米表示。\n\n测试套件：\n\n使用以下四个测试用例，以覆盖一般情况、近本征情况和边界情况：\n\n1. $\\epsilon_r = 11.7$, $T = 300$, $n_i = 1.0 \\times 10^{16}$, $N_A = 2.0 \\times 10^{16}$, $N_D = 5.0 \\times 10^{16}$, $\\alpha = 0.99$.\n2. $\\epsilon_r = 11.7$, $T = 300$, $n_i = 1.0 \\times 10^{16}$, $N_A = 1.2 \\times 10^{16}$, $N_D = 1.3 \\times 10^{16}$, $\\alpha = 0.99$.\n3. $\\epsilon_r = 11.7$, $T = 300$, $n_i = 1.0 \\times 10^{16}$, $N_A = 1.0 \\times 10^{16}$, $N_D = 1.0 \\times 10^{16}$, $\\alpha = 0.99$.\n4. $\\epsilon_r = 20.0$, $T = 300$, $n_i = 5.0 \\times 10^{15}$, $N_A = 5.0 \\times 10^{16}$, $N_D = 1.1 \\times 10^{16}$, $\\alpha = 0.99$.\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个逗号分隔的浮点数扁平列表，结果按以下顺序排列：$$[\\Delta V_{bi}^{(1)}, \\Delta W^{(1)}, \\Delta V_{bi}^{(2)}, \\Delta W^{(2)}, \\Delta V_{bi}^{(3)}, \\Delta W^{(3)}, \\Delta V_{bi}^{(4)}, \\Delta W^{(4)}],$$ 其中上标 $(k)$ 表示上述顺序中的第 $k$ 个测试用例。$\\Delta V_{bi}$ 的单位必须是伏特，$\\Delta W$ 的单位必须是米，数值以十进制浮点数表示。",
            "solution": "该问题要求对一维 $p$-$n$ 结的 Poisson-Boltzmann 方程进行数值求解，并将关键参数——特别是内建电势和耗尽宽度——与耗尽近似的解析结果进行比较。该问题具有科学依据且定义明确，是计算半导体物理学中的一项实质性练习。\n\n一个关键的观察是，该问题为归一化电势 $u(\\pm L)$ 指定了 Dirichlet 边界条件，并使用了远场解析表达式。这意味着仿真域上的电势降 $V_{bi,\\text{PB}} = \\psi(+L) - \\psi(-L)$ 被固定为等于理论内建电势 $V_{bi,\\text{true}} = V_T \\ln(N_A N_D / n_i^2)$。因此，内建电势的绝对误差 $\\Delta V_{bi} = |V_{bi,\\text{true}} - V_{bi,\\text{PB}}|$ 将根据构造恒为零。虽然这简化了问题的一个方面，但核心挑战依然存在：数值确定电势分布 $\\psi(x)$，并由此计算工作耗尽宽度 $W_{\\text{PB}}$，这是一项非平凡的任务。\n\n求解过程分为三个主要阶段：\n1. 推导耗尽近似下的耗尽宽度 $W_{\\text{DA}}$。\n2. 构建求解 Poisson-Boltzmann 边值问题的数值方法。\n3. 计算工作耗尽宽度 $W_{\\text{PB}}$ 和所需的误差度量。\n\n**1. 耗尽近似宽度 ($W_{\\text{DA}}$)**\n\n耗尽近似假设存在一个耗尽了自由载流子的区域 $[-x_p, x_n]$，其中空间电荷密度 $\\rho(x)$ 完全由电离的掺杂浓度决定：\n$$\n\\rho(x) = \n\\begin{cases} \n-q N_A  \\text{for } -x_p  x  0 \\\\\n+q N_D  \\text{for } 0  x  x_n \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n全局电中性要求结两侧的总未补偿电荷量大小相等：\n$$q N_A x_p = q N_D x_n \\quad (1)$$\n对 Poisson 方程 $\\frac{dE}{dx} = \\frac{\\rho(x)}{\\epsilon}$ 进行积分，并使用边界条件 $E(-\\infty) = 0$，得到电场 $E(x)$。内建电势 $V_{bi}$ 是跨结的总电势降，通过对电场积分得到：$V_{bi} = -\\int_{-x_p}^{x_n} E(x) dx$。这个积分对应于三角形电场分布的面积：\n$$V_{bi} = \\frac{1}{2} (x_p + x_n) |E_{max}|$$\n其中 $|E_{max}| = |E(0)| = \\frac{q N_A x_p}{\\epsilon} = \\frac{q N_D x_n}{\\epsilon}$。\n设总耗尽宽度为 $W_{\\text{DA}} = x_p + x_n$。使用方程 $(1)$，我们可以用 $W_{\\text{DA}}$ 表示 $x_p$ 和 $x_n$：\n$$x_p = W_{\\text{DA}} \\frac{N_D}{N_A + N_D}, \\quad x_n = W_{\\text{DA}} \\frac{N_A}{N_A + N_D}$$\n将 $x_p$ 代入 $V_{bi}$ 的表达式中：\n$$V_{bi} = \\frac{1}{2} W_{\\text{DA}} \\left(\\frac{q N_A}{\\epsilon} x_p\\right) = \\frac{1}{2} W_{\\text{DA}} \\frac{q N_A}{\\epsilon} \\left(W_{\\text{DA}} \\frac{N_D}{N_A + N_D}\\right) = \\frac{q}{2\\epsilon} \\frac{N_A N_D}{N_A + N_D} W_{\\text{DA}}^2$$\n求解 $W_{\\text{DA}}$ 并使用理论内建电势 $V_{bi,\\text{true}}$ 代替 $V_{bi}$，我们得到以下公式：\n$$W_{\\text{DA}} = \\sqrt{\\frac{2\\epsilon V_{bi,\\text{true}}}{q} \\left(\\frac{N_A + N_D}{N_A N_D}\\right)} = \\sqrt{\\frac{2\\epsilon V_{bi,\\text{true}}}{q} \\left(\\frac{1}{N_A} + \\frac{1}{N_D}\\right)}$$\n\n**2. Poisson-Boltzmann 方程的数值解**\n\n该问题要求在域 $x \\in [-L, L]$ 上求解归一化的 Poisson-Boltzmann 方程：\n$$\\frac{d^2 u(x)}{dx^2} = \\frac{q}{\\epsilon V_T}\\left[2n_i \\sinh(u(x)) - C(x)\\right]$$\n其中 $C(x) = N_D(x) - N_A(x)$ 是净掺杂浓度，$u(x) = \\psi(x)/V_T$。这是一个非线性二阶边值问题。我们将域离散化为 $N+1$ 个点 $x_j$，间距为均匀的 $\\Delta x$，并使用二阶中心差分格式来近似二阶导数：\n$$\\frac{u_{j-1} - 2u_j + u_{j+1}}{\\Delta x^2} - \\frac{2qn_i}{\\epsilon V_T}\\sinh(u_j) + \\frac{qC(x_j)}{\\epsilon V_T} = 0$$\n这为内部网格点（$j=1, \\dots, N-1$）上未知的电势值 $u_j$ 产生了一个包含 $N-1$ 个非线性方程的方程组。边界上的值 $u_0 = u(-L)$ 和 $u_N = u(L)$ 由 Dirichlet 条件固定：\n$$u_0 = -\\ln(N_A/n_i), \\quad u_N = \\ln(N_D/n_i)$$\n这个方程组 $\\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$，其中 $\\mathbf{U} = [u_1, \\dots, u_{N-1}]^T$，使用牛顿法求解。从一个初始猜测 $\\mathbf{U}^{(0)}$（边界值之间的线性分布）开始，解被迭代优化：\n$$\\mathbf{U}^{(k+1)} = \\mathbf{U}^{(k)} - \\mathbf{J}(\\mathbf{U}^{(k)})^{-1} \\mathbf{F}(\\mathbf{U}^{(k)})$$\n其中 $\\mathbf{J}$ 是 $\\mathbf{F}$ 的雅可比矩阵。雅可比矩阵的元素 $J_{ij} = \\partial F_i / \\partial u_j$ 为：\n$$\nJ_{ij} = \n\\begin{cases} \n1/\\Delta x^2  \\text{if } j = i \\pm 1 \\\\\n-2/\\Delta x^2 - \\frac{2qn_i}{\\epsilon V_T}\\cosh(u_i)  \\text{if } j = i \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n在每次迭代中，求解线性系统 $\\mathbf{J} \\Delta\\mathbf{U} = -\\mathbf{F}$ 以获得更新量 $\\Delta\\mathbf{U}$。雅可比矩阵是三对角的，这使得可以使用稀疏线性代数例程进行高效求解。迭代持续进行，直到残差向量 $\\mathbf{F}$ 的无穷范数低于 $10^{-10}$ 的容差。\n\n**3. 计算输出**\n\n当 $u(x)$ 的数值解收敛后，每个网格点上的电势 $\\psi(x) = V_T u(x)$ 就已知了。然后按如下方式计算所需的输出：\n- **$V_{bi,\\text{true}}$ 和 $V_{bi,\\text{PB}}$**：$V_{bi,\\text{true}} = V_T \\ln(N_A N_D/n_i^2)$ 直接计算得出。如前所述，由于给定的边界条件，$V_{bi,\\text{PB}} = \\psi(L) - \\psi(-L)$ 等于 $V_{bi,\\text{true}}$。因此，$\\Delta V_{bi} = 0$。\n- **$W_{\\text{DA}}$**：使用第 1 部分推导的公式计算。\n- **$W_{\\text{PB}}$**：通过定位电势达到其总压降特定比例的位置 $x_1$ 和 $x_2$ 来找到工作宽度。我们必须找到 $x_1$ 和 $x_2$ 使得：\n$$\\psi(x_1) = \\psi(-L) + \\frac{1-\\alpha}{2} V_{bi,\\text{true}}$$\n$$\\psi(x_2) = \\psi(+L) - \\frac{1-\\alpha}{2} V_{bi,\\text{true}}$$\n由于离散解 $\\psi(x_j)$ 是已知的，我们使用线性插值在 $(\\psi_j, x_j)$ 数据上找到与这些目标电势值对应的精确 $x_1$ 和 $x_2$。然后宽度为 $W_{\\text{PB}} = x_2 - x_1$。\n- **$\\Delta W$**：耗尽宽度的绝对误差是 $\\Delta W = |W_{\\text{DA}} - W_{\\text{PB}}|$。\n\n对于 $N_A = N_D = n_i$ 的特殊情况，不存在结。半导体是均匀的本征半导体。在这种情况下，$V_{bi,\\text{true}} = 0$，导致 $W_{\\text{DA}} = 0$。数值边界条件变为 $u(\\pm L)=0$，平凡解为对所有 $x$ 都有 $u(x)=0$。这导致 $V_{bi,\\text{PB}} = 0$。$W_{\\text{PB}}$ 的主要定义是包含零电势降一部分的“最小区间”，这意味着 $W_{\\text{PB}}=0$。因此，对于这种情况，$\\Delta V_{bi}$ 和 $\\Delta W$ 均为零。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags\nfrom scipy.sparse.linalg import spsolve\nfrom scipy.constants import k, e, epsilon_0\n\ndef solve_pn_junction(case_params):\n    \"\"\"\n    Solves the 1D Poisson-Boltzmann equation for a p-n junction and compares\n    results with the depletion approximation.\n    \"\"\"\n    er, T, ni, NA, ND, alpha = case_params\n\n    # Physical constants in SI units\n    q = e\n    VT = k * T / q\n    epsilon = er * epsilon_0\n\n    # Special case: Homogeneous intrinsic semiconductor (p=i=n)\n    # Vbi, W_DA, and W_PB are all zero. The errors are thus zero.\n    if np.isclose(NA, ni) and np.isclose(ND, ni):\n        return 0.0, 0.0\n\n    # 1. Theoretical calculations\n    # True built-in potential (non-degenerate statistics)\n    V_bi_true = VT * np.log(NA * ND / ni**2)\n\n    # Depletion approximation width (W_DA)\n    if V_bi_true == 0:\n        W_da = 0.0\n    else:\n        W_da = np.sqrt(2 * epsilon * V_bi_true / q * (1/NA + 1/ND))\n\n    # 2. Setup for numerical Poisson-Boltzmann solution\n    # Domain size L based on extrinsic Debye lengths\n    L_debye_A = np.sqrt(epsilon * VT / (q * NA))\n    L_debye_D = np.sqrt(epsilon * VT / (q * ND))\n    L = 10 * max(L_debye_A, L_debye_D)\n\n    # Spatial grid\n    N = 2001  # Number of points (>= 2000 specified)\n    x, dx = np.linspace(-L, L, N, retstep=True)\n\n    # Boundary conditions for normalized potential u = psi/VT\n    u_bc_l = -np.log(NA / ni)\n    u_bc_r = np.log(ND / ni)\n    \n    # Net doping profile C(x) = N_D(x) - N_A(x)\n    doping_profile = np.zeros(N)\n    doping_profile[x > 0] = ND\n    doping_profile[x  0] = -NA\n    doping_internal = doping_profile[1:-1]\n    \n    # Initial guess for u(x): linear profile\n    u = np.linspace(u_bc_l, u_bc_r, N)\n\n    # 3. Newton-Raphson solver for the nonlinear BVP\n    max_iter = 50\n    tolerance = 1e-10\n    \n    # Normalization constants from the Poisson-Boltzmann equation\n    # d^2u/dx^2 = C1 * (e^u - e^-u) - C2 * (ND - NA)\n    # F = laplacian - 2*C1*sinh(u) + C2*doping = 0\n    C1 = q * ni / (epsilon * VT) \n    C2 = q / (epsilon * VT)\n\n    for _ in range(max_iter):\n        u_internal = u[1:-1]\n        \n        # Assemble the residual vector F\n        laplacian = (u[2:] - 2*u[1:-1] + u[:-2]) / dx**2\n        sinh_term = np.sinh(u_internal)\n        F = laplacian - 2 * C1 * sinh_term + C2 * doping_internal\n        \n        res_norm = np.linalg.norm(F, ord=np.inf)\n        if res_norm  tolerance:\n            break\n\n        # Assemble the Jacobian matrix J (tridiagonal)\n        # J_ii = dF_i/du_i = -2/dx^2 - 2*C1*cosh(u_i)\n        diag_J = -2/dx**2 - 2 * C1 * np.cosh(u_internal)\n        off_diag_val = 1/dx**2\n        \n        J = diags([off_diag_val, diag_J, off_diag_val], \n                  [-1, 0, 1], shape=(N-2, N-2), format='csc')\n        \n        # Solve the linear system J * du = -F for the update du\n        du = spsolve(J, -F)\n        \n        # Update the solution vector\n        u[1:-1] += du\n\n    # 4. Post-processing: Calculate required quantities from the numerical solution\n    psi = u * VT\n    \n    # Numerically determined built-in potential from domain boundaries\n    V_bi_pb = psi[-1] - psi[0]\n    \n    # Operational depletion width (W_PB) via interpolation\n    psi_target1 = psi[0] + (1 - alpha) / 2 * V_bi_true\n    psi_target2 = psi[-1] - (1 - alpha) / 2 * V_bi_true\n    \n    # np.interp finds the x-value for a given y-value (psi) from the (x,psi) data\n    x1 = np.interp(psi_target1, psi, x)\n    x2 = np.interp(psi_target2, psi, x)\n    W_pb = x2 - x1\n    \n    # 5. Calculate final error metrics\n    delta_V_bi = abs(V_bi_true - V_bi_pb)\n    delta_W = abs(W_da - W_pb)\n    \n    return delta_V_bi, delta_W\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test suite: [epsilon_r, T_K, n_i_m^-3, N_A_m^-3, N_D_m^-3, alpha]\n    test_cases = [\n        (11.7, 300, 1.0e16, 2.0e16, 5.0e16, 0.99),\n        (11.7, 300, 1.0e16, 1.2e16, 1.3e16, 0.99),\n        (11.7, 300, 1.0e16, 1.0e16, 1.0e16, 0.99),\n        (20.0, 300, 5.0e15, 5.0e16, 1.1e16, 0.99),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Convert densities from problem statement (assumed /cm^3) to /m^3? No, problem says m^-3.\n        # The values 1e16 are low for dopants but ok for n_i. We proceed as given.\n        delta_V, delta_W = solve_pn_junction(case)\n        results.extend([delta_V, delta_W])\n\n    # Format the final output as a comma-separated list of floats\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}