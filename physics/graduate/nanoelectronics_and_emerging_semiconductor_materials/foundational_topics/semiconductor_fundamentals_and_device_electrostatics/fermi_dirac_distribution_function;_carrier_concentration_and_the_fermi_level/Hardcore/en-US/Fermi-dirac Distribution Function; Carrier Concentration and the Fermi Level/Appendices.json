{
    "hands_on_practices": [
        {
            "introduction": "The electronic properties of a material are profoundly influenced by its dimensionality. This practice explores this principle by contrasting the behavior of the chemical potential, $\\mu(T)$, in two-dimensional (2D) and three-dimensional (3D) systems. By starting from first principles, you will analytically derive how $\\mu(T)$ adjusts to maintain a fixed carrier concentration, revealing a qualitatively different temperature dependence that stems directly from the distinct forms of the density of states in 2D and 3D . This exercise sharpens your analytical skills with tools like the Sommerfeld expansion and provides fundamental insight into the unique physics of nano-scale materials.",
            "id": "4275371",
            "problem": "A monolayer, two-dimensional ($2$D) semiconductor hosts electrons in a single isotropic parabolic conduction band of effective mass $m^\\ast$ with band edge at energy $E_c$. The spin degeneracy is $g_s$ and the valley degeneracy is $g_v$. Let the electron sheet density be fixed at $n_s$ by electrostatic gating. Consider also a three-dimensional ($3$D) bulk semiconductor with the same parabolic dispersion and degeneracies, and a fixed volume electron density $n$. Assume the bands extend to arbitrarily high energy and neglect band nonparabolicity and interactions.\n\nStarting only from (i) the definition of the Fermi-Dirac (FD) distribution $f(E)=\\left[1+\\exp\\left(\\frac{E-\\mu}{k_B T}\\right)\\right]^{-1}$, (ii) the construction of the density of states from $k$-space counting in $d$ dimensions for a parabolic band, and (iii) particle-number conservation, analyze how the chemical potential $\\mu(T)$ must evolve with temperature $T$ in the $2$D and $3$D cases to keep $n_s$ or $n$ fixed. In particular, focus on the low-temperature degenerate regime $k_B T \\ll \\varepsilon_F$ and the nondegenerate high-temperature regime.\n\nSelect all statements that are correct.\n\nA. In a $2$D parabolic band with a constant density of states above $E_c$ and fixed sheet density $n_s$, the low-temperature deviation of $\\mu(T)$ from its zero-temperature value $\\mu(0)=E_c+\\varepsilon_F$, where $\\varepsilon_F \\equiv n_s/D_{2\\mathrm{D}}$ and $D_{2\\mathrm{D}}$ is the $2$D density of states per unit area, is exponentially small: $\\mu(T)=E_c+\\varepsilon_F - O\\!\\left(e^{-\\varepsilon_F/(k_B T)}\\right)$ as $T\\to 0$. By contrast, in $3$D at fixed $n$, $\\mu(T)=E_F - O\\!\\left((k_B T)^2/E_F\\right)$ with a quadratic leading correction.\n\nB. In the nondegenerate high-temperature limit, the $2$D chemical potential measured from the band edge satisfies $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n_s}{D_{2\\mathrm{D}}\\,k_B T}\\right)$, whereas in $3$D one has $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n}{N_c(T)}\\right)$ with the effective density of states $N_c(T)\\propto T^{3/2}$.\n\nC. For a $2$D parabolic band at fixed sheet density $n_s$, $\\mu(T)$ is exactly independent of $T$ for all $T0$.\n\nD. For a $3$D parabolic band at fixed volume density $n$, $\\mu(T)$ increases above $E_F$ as $T$ rises from $T=0$ due to the energy dependence of the density of states.\n\nE. In $2$D at fixed $n_s$, $\\mu(T)$ necessarily satisfies $\\mu(T)E_c$ for all $T0$.",
            "solution": "The user wants a detailed analysis of the temperature dependence of the chemical potential in 2D and 3D systems with parabolic bands, based on first principles. I will first validate the problem statement and then proceed with the derivation and evaluation of the options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **System 1 (2D):** A monolayer, two-dimensional ($2$D) semiconductor.\n    *   Band structure: Single isotropic parabolic conduction band with effective mass $m^\\ast$.\n    *   Band edge energy: $E_c$.\n    *   Degeneracies: Spin degeneracy $g_s$, valley degeneracy $g_v$.\n    *   Carrier density: Fixed electron sheet density $n_s$.\n*   **System 2 (3D):** A three-dimensional ($3$D) bulk semiconductor.\n    *   Band structure: Same parabolic dispersion as 2D ($E(k) = E_c + \\hbar^2 k^2 / (2m^\\ast)$).\n    *   Degeneracies: Same $g_s$ and $g_v$.\n    *   Carrier density: Fixed volume electron density $n$.\n*   **Assumptions:**\n    *   Bands extend to arbitrarily high energy.\n    *   Band nonparabolicity and interactions are neglected.\n*   **Starting Principles:**\n    *   (i) Fermi-Dirac (FD) distribution: $f(E)=\\left[1+\\exp\\left(\\frac{E-\\mu}{k_B T}\\right)\\right]^{-1}$.\n    *   (ii) Density of states (DOS) from $k$-space counting in $d$ dimensions for a parabolic band.\n    *   (iii) Particle-number conservation.\n*   **Question:** Analyze how the chemical potential $\\mu(T)$ evolves with temperature $T$ in the $2$D and $3$D cases to keep $n_s$ or $n$ fixed, focusing on the low-temperature degenerate regime ($k_B T \\ll \\varepsilon_F$) and the nondegenerate high-temperature regime.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem describes a canonical model in semiconductor physics and solid-state statistical mechanics. The concepts of parabolic bands, effective mass, density of states, and the Fermi-Dirac distribution are fundamental principles. The model is a standard textbook case for studying electron statistics.\n2.  **Well-Posed:** The problem is well-posed. The constraint of fixed particle number, combined with the definitions of DOS and the FD distribution, implicitly defines a unique function $\\mu(T)$. The question asks to characterize the behavior of this function in specific limits, which is a solvable problem.\n3.  **Objective:** The problem statement uses precise, unbiased scientific language.\n4.  **No Flaws Identified:**\n    *   It does not violate any scientific laws.\n    *   It is a formalizable problem central to the topic.\n    *   The setup is complete for the analysis required. The physical parameters ($m^\\ast$, $g_s$, $g_v$) are given symbolically, which is appropriate.\n    *   The assumption of bands extending to infinity is an idealization but is standard for simplifying the integrals and does not invalidate the core physical behavior near the band edge.\n    *   The problem is neither trivial nor ill-posed.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. I will proceed to derive the solution from the given principles.\n\n### Derivation\n\nThe total carrier concentration in $d$ dimensions, $n_{d\\mathrm{D}}$, is given by the conservation of particle number:\n$$n_{d\\mathrm{D}} = \\int_{E_c}^{\\infty} D_{d\\mathrm{D}}(E) f(E) dE$$\nwhere $D_{d\\mathrm{D}}(E)$ is the density of states per unit area ($d=2$) or volume ($d=3$), and $f(E)$ is the Fermi-Dirac distribution.\n\n**1. Density of States (DOS)**\n\nFor an isotropic parabolic band $E(\\vec{k}) = E_c + \\frac{\\hbar^2 |\\vec{k}|^2}{2m^\\ast}$, the number of states (including spin and valley degeneracies) in a differential shell in $k$-space is $g_s g_v dN_k$. The volume of this shell in $d$ dimensions is $S_d k^{d-1} dk$, where $S_d$ is the surface area of a unit sphere in $d$ dimensions ($S_2=2\\pi$, $S_3=4\\pi$). The density of states in $k$-space per unit real-space volume/area is $1/(2\\pi)^d$.\n$$D_{d\\mathrm{D}}(E)dE = g_s g_v \\frac{S_d k^{d-1}}{(2\\pi)^d} dk$$\nFrom the dispersion relation, $k(E) = \\sqrt{2m^\\ast(E-E_c)}/\\hbar$, and $dk = \\frac{1}{\\hbar}\\sqrt{\\frac{m^\\ast}{2(E-E_c)}}dE$.\n\n*   **2D Case ($d=2$):**\n    $$D_{2\\mathrm{D}}(E) = g_s g_v \\frac{2\\pi k}{(2\\pi)^2} \\frac{dk}{dE} = \\frac{g_s g_v}{2\\pi} k(E) \\frac{dk}{dE}$$\n    Since $k \\frac{dk}{dE} = \\frac{m^\\ast}{\\hbar^2}$, we get:\n    $$D_{2\\mathrm{D}}(E) = \\frac{g_s g_v m^\\ast}{2\\pi\\hbar^2} \\equiv D_{2\\mathrm{D}} \\quad (\\text{for } E \\ge E_c)$$\n    The 2D DOS is a constant for $E \\ge E_c$.\n\n*   **3D Case ($d=3$):**\n    $$D_{3\\mathrm{D}}(E) = g_s g_v \\frac{4\\pi k^2}{(2\\pi)^3} \\frac{dk}{dE} = \\frac{g_s g_v}{2\\pi^2} k^2(E) \\frac{dk}{dE}$$\n    Substituting for $k^2$ and $dk/dE$:\n    $$D_{3\\mathrm{D}}(E) = \\frac{g_s g_v}{2\\pi^2} \\left(\\frac{2m^\\ast(E-E_c)}{\\hbar^2}\\right) \\left(\\frac{1}{\\hbar}\\sqrt{\\frac{m^\\ast}{2(E-E_c)}}\\right) = \\frac{g_s g_v}{2\\pi^2} \\left(\\frac{2m^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E-E_c}$$\n    The 3D DOS is proportional to $\\sqrt{E-E_c}$ for $E \\ge E_c$.\n\n**2. Chemical Potential $\\mu(T)$**\n\n**2.1. The 2D Case**\nThe particle conservation equation is:\n$$n_s = \\int_{E_c}^{\\infty} D_{2\\mathrm{D}} \\frac{1}{1 + e^{(E-\\mu)/(k_B T)}} dE$$\nThis integral can be solved exactly. Let $x = (E-\\mu)/(k_B T)$, so $dE = k_B T dx$.\n$$n_s = D_{2\\mathrm{D}} k_B T \\int_{(E_c-\\mu)/(k_B T)}^{\\infty} \\frac{dx}{1+e^x} = D_{2\\mathrm{D}} k_B T \\left[ -\\ln(1+e^{-x}) \\right]_{(E_c-\\mu)/(k_B T)}^{\\infty}$$\n$$n_s = D_{2\\mathrm{D}} k_B T \\ln\\left(1 + e^{- (E_c-\\mu)/(k_B T)}\\right) = D_{2\\mathrm{D}} k_B T \\ln\\left(1 + e^{(\\mu-E_c)/(k_B T)}\\right)$$\nSolving for $\\mu(T)$:\n$$e^{n_s/(D_{2\\mathrm{D}} k_B T)} = 1 + e^{(\\mu-E_c)/(k_B T)}$$\n$$\\mu(T) - E_c = k_B T \\ln\\left(e^{n_s/(D_{2\\mathrm{D}} k_B T)} - 1\\right)$$\n\n*   **Low-Temperature Limit ($T \\to 0$):**\n    At $T=0$, $f(E)$ is a step function. $\\mu(0)=E_F$.\n    $n_s = \\int_{E_c}^{E_F} D_{2\\mathrm{D}} dE = D_{2\\mathrm{D}}(E_F - E_c)$.\n    The Fermi energy measured from the band edge is $\\varepsilon_F \\equiv E_F - E_c = n_s/D_{2\\mathrm{D}}$. So $\\mu(0) = E_c + \\varepsilon_F$.\n    For small $T$, let $x = \\varepsilon_F / (k_B T) \\gg 1$.\n    $\\mu(T) - E_c = k_B T \\ln(e^x - 1) = k_B T \\ln(e^x(1-e^{-x})) = k_B T (x + \\ln(1-e^{-x}))$.\n    Using $\\ln(1-y) \\approx -y$ for small $y$:\n    $\\mu(T) - E_c \\approx k_B T \\left(\\frac{\\varepsilon_F}{k_B T} - e^{-\\varepsilon_F/(k_B T)}\\right) = \\varepsilon_F - k_B T e^{-\\varepsilon_F/(k_B T)}$.\n    So, $\\mu(T) \\approx (E_c + \\varepsilon_F) - k_B T e^{-\\varepsilon_F/(k_B T)}$. The deviation from $\\mu(0)$ is negative and exponentially small.\n\n*   **High-Temperature Limit (Nondegenerate):**\n    When $k_B T$ is large, the argument of the logarithm in the expression for $\\mu(T)$ can be approximated. This corresponds to the Maxwell-Boltzmann limit $f(E) \\approx e^{-(E-\\mu)/(k_B T)}$.\n    $n_s = \\int_{E_c}^{\\infty} D_{2\\mathrm{D}} e^{-(E-\\mu)/(k_B T)} dE = D_{2\\mathrm{D}} e^{(\\mu-E_c)/(k_B T)} \\int_{E_c}^{\\infty} e^{-(E-E_c)/(k_B T)} dE$.\n    The integral is $k_B T$.\n    $n_s = D_{2\\mathrm{D}} k_B T e^{(\\mu-E_c)/(k_B T)}$.\n    $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)$.\n\n**2.2. The 3D Case**\n$$n = \\int_{E_c}^{\\infty} C_3 \\sqrt{E-E_c} \\frac{1}{1 + e^{(E-\\mu)/(k_B T)}} dE$$\nwhere $C_3 = \\frac{g_s g_v}{2\\pi^2} (\\frac{2m^\\ast}{\\hbar^2})^{3/2}$. This integral does not have a simple closed-form solution.\n\n*   **Low-Temperature Limit ($T \\to 0$):**\n    We use the Sommerfeld expansion for an integral $I = \\int \\phi(E)f(E)dE$:\n    $I \\approx \\int_{E_c}^{\\mu} \\phi(E)dE + \\frac{\\pi^2}{6}(k_B T)^2 \\phi'(\\mu)$.\n    Here, $\\phi(E) = D_{3\\mathrm{D}}(E) = C_3 \\sqrt{E-E_c}$. The particle density $n$ is constant.\n    $n \\approx \\int_{E_c}^{\\mu} D_{3\\mathrm{D}}(E) dE + \\frac{\\pi^2}{6}(k_B T)^2 D'_{3\\mathrm{D}}(\\mu)$.\n    At $T=0$, $n = \\int_{E_c}^{E_F} D_{3\\mathrm{D}}(E) dE$, with $E_F = \\mu(0)$.\n    $\\int_{E_c}^{E_F} D_{3\\mathrm{D}} dE \\approx \\int_{E_c}^{\\mu} D_{3\\mathrm{D}} dE + \\frac{\\pi^2}{6}(k_B T)^2 D'_{3\\mathrm{D}}(\\mu)$.\n    Approximating the first term with a Taylor expansion around $E_F$: $\\int_{E_c}^{\\mu} D_{3\\mathrm{D}} dE \\approx \\int_{E_c}^{E_F} D_{3\\mathrm{D}} dE + (\\mu - E_F)D_{3\\mathrm{D}}(E_F)$. Also, in the correction term, we can set $\\mu \\approx E_F$.\n    $0 \\approx (\\mu - E_F)D_{3\\mathrm{D}}(E_F) + \\frac{\\pi^2}{6}(k_B T)^2 D'_{3\\mathrm{D}}(E_F)$.\n    $\\mu(T) - E_F \\approx -\\frac{\\pi^2}{6}(k_B T)^2 \\frac{D'_{3\\mathrm{D}}(E_F)}{D_{3\\mathrm{D}}(E_F)}$.\n    $D'_{3\\mathrm{D}}(E) = \\frac{C_3}{2\\sqrt{E-E_c}}$, so $\\frac{D'_{3\\mathrm{D}}(E)}{D_{3\\mathrm{D}}(E)} = \\frac{1}{2(E-E_c)}$.\n    At $E=E_F$, this ratio is $\\frac{1}{2(E_F-E_c)}$.\n    $\\mu(T) - E_F \\approx -\\frac{\\pi^2}{12} \\frac{(k_B T)^2}{E_F - E_c}$.\n    The chemical potential decreases quadratically with $T$ for low temperatures.\n\n*   **High-Temperature Limit (Nondegenerate):**\n    Using $f(E) \\approx e^{-(E-\\mu)/(k_B T)}$:\n    $n = \\int_{E_c}^{\\infty} C_3 \\sqrt{E-E_c} \\, e^{-(E-\\mu)/(k_B T)} dE = C_3 e^{(\\mu-E_c)/(k_B T)} \\int_{E_c}^{\\infty} \\sqrt{E-E_c} \\, e^{-(E-E_c)/(k_B T)} dE$.\n    Let $x=(E-E_c)/(k_B T)$. The integral is $(k_B T)^{3/2} \\int_0^\\infty \\sqrt{x} e^{-x} dx = (k_B T)^{3/2} \\Gamma(3/2) = (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2}$.\n    $n = C_3 (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2} e^{(\\mu-E_c)/(k_B T)}$.\n    This is commonly written as $n = N_c(T) e^{(\\mu-E_c)/(k_B T)}$, where the effective density of states is $N_c(T) = C_3 (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2} = g_s g_v \\cdot 2 \\left(\\frac{m^\\ast k_B T}{2\\pi \\hbar^2}\\right)^{3/2}$.\n    $N_c(T) \\propto T^{3/2}$.\n    Solving for $\\mu(T)$:\n    $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n}{N_c(T)}\\right)$.\n\n### Evaluation of Options\n\n**A. In a $2$D parabolic band with a constant density of states above $E_c$ and fixed sheet density $n_s$, the low-temperature deviation of $\\mu(T)$ from its zero-temperature value $\\mu(0)=E_c+\\varepsilon_F$, where $\\varepsilon_F \\equiv n_s/D_{2\\mathrm{D}}$ and $D_{2\\mathrm{D}}$ is the $2$D density of states per unit area, is exponentially small: $\\mu(T)=E_c+\\varepsilon_F - O\\!\\left(e^{-\\varepsilon_F/(k_B T)}\\right)$ as $T\\to 0$. By contrast, in $3$D at fixed $n$, $\\mu(T)=E_F - O\\!\\left((k_B T)^2/E_F\\right)$ with a quadratic leading correction.**\n*   **2D part:** My derivation shows $\\mu(T) \\approx (E_c + \\varepsilon_F) - k_B T e^{-\\varepsilon_F/(k_B T)}$. The correction term is indeed exponentially small. The polynomial factor $k_B T$ is sub-dominant to the exponential, so the order of magnitude notation $O(e^{-\\varepsilon_F/(k_B T)})$ is correct.\n*   **3D part:** My derivation shows $\\mu(T) - E_F \\approx -\\frac{\\pi^2}{12} \\frac{(k_B T)^2}{E_F - E_c}$. The leading correction is negative and proportional to $(k_B T)^2$. The notation $O((k_B T)^2/E_F)$ (assuming $E_F$ in the denominator represents the Fermi energy relative to the band edge, $E_F-E_c$) correctly captures this quadratic dependence.\n*   **Verdict:** Correct.\n\n**B. In the nondegenerate high-temperature limit, the $2$D chemical potential measured from the band edge satisfies $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n_s}{D_{2\\mathrm{D}}\\,k_B T}\\right)$, whereas in $3$D one has $\\mu(T)-E_c = k_B T \\ln\\!\\left(\\frac{n}{N_c(T)}\\right)$ with the effective density of states $N_c(T)\\propto T^{3/2}$.**\n*   **2D part:** My derivation for the high-temperature limit in 2D yielded exactly $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)$. This matches the statement.\n*   **3D part:** My derivation for the high-temperature limit in 3D yielded exactly $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n}{N_c(T)}\\right)$, with the definition of $N_c(T)$ showing that $N_c(T) \\propto T^{3/2}$. This also matches the statement.\n*   **Verdict:** Correct.\n\n**C. For a $2$D parabolic band at fixed sheet density $n_s$, $\\mu(T)$ is exactly independent of $T$ for all $T0$.**\n*   My exact expression for the 2D case is $\\mu(T) = E_c + k_B T \\ln\\left( e^{n_s/(D_{2\\mathrm{D}} k_B T)} - 1 \\right)$. This function is clearly dependent on $T$. For instance, in the low-temperature limit, it approaches $E_c+\\varepsilon_F$ with an exponential correction, and in the high-temperature limit, it behaves as $k_B T \\ln(C/T)$, which is also temperature-dependent. Thus, $\\mu(T)$ is not constant. This statement is false. The misconception of constant $\\mu(T)$ in 2D arises only if the DOS is constant and symmetric around $\\mu$ (e.g., extends from $-\\infty$ to $+\\infty$), which is not the case here due to the band edge at $E_c$.\n*   **Verdict:** Incorrect.\n\n**D. For a $3$D parabolic band at fixed volume density $n$, $\\mu(T)$ increases above $E_F$ as $T$ rises from $T=0$ due to the energy dependence of the density of states.**\n*   My low-temperature analysis for 3D showed $\\mu(T) \\approx E_F - \\frac{\\pi^2}{12} \\frac{(k_B T)^2}{E_F-E_c}$. Since the correction term is negative for $T0$, $\\mu(T)$ *decreases* below its zero-temperature value $E_F$. As temperature rises, the thermal smearing of the Fermi distribution populates states above $\\mu$. Since the 3D DOS increases with energy, more states are available at $E  \\mu$ than are lost at $E  \\mu$. To maintain a constant particle number $n$, the chemical potential $\\mu$ must decrease.\n*   **Verdict:** Incorrect.\n\n**E. In $2$D at fixed $n_s$, $\\mu(T)$ necessarily satisfies $\\mu(T)E_c$ for all $T0$.**\n*   Let's analyze the high-temperature expression: $\\mu(T) - E_c = k_B T \\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)$.\n*   For a sufficiently high temperature $T$, the argument of the logarithm, $\\frac{n_s}{D_{2\\mathrm{D}} k_B T}$, will become less than $1$. When a positive number is less than $1$, its natural logarithm is negative.\n*   Therefore, for $T  \\frac{n_s}{D_{2\\mathrm{D}} k_B}$, we have $\\ln\\left(\\frac{n_s}{D_{2\\mathrm{D}} k_B T}\\right)  0$, which implies $\\mu(T) - E_c  0$, or $\\mu(T)  E_c$.\n*   The statement that $\\mu(T)E_c$ for *all* $T0$ is therefore false. The chemical potential is above $E_c$ in the degenerate (low-T) regime but drops into the band gap in the non-degenerate (high-T) regime.\n*   **Verdict:** Incorrect.",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "While analytical derivations provide crucial physical intuition, quantitative analysis in nanoelectronics often demands numerical computation. This practice bridges the gap between theory and application by tasking you with calculating the sheet carrier concentration, $n_s$, in a model 2D semiconductor representative of modern materials like monolayer transition metal dichalcogenides. You will implement the fundamental integral of the density of states and the Fermi-Dirac distribution, translating an abstract formula into concrete numerical results and exploring the crossover between the degenerate and non-degenerate statistical regimes .",
            "id": "4275328",
            "problem": "Consider a two-dimensional semiconductor with a single parabolic conduction band characterized by the effective mass $m^\\*$ and valley degeneracy $g_v$, and spin degeneracy $g_s$. The conduction band edge is at energy $E_c$. The electron density of states (DOS) per unit area per unit energy for a two-dimensional parabolic band is constant above the conduction band edge and is given by the fundamental definition\n$$\ng_{2\\mathrm{D},J}(E) = \\frac{g_s g_v m^\\*}{2\\pi \\hbar^2}\\,\\Theta(E - E_c),\n$$\nwhere $\\Theta(\\cdot)$ is the Heaviside step function, $\\hbar$ is the reduced Planck constant, and $g_{2\\mathrm{D},J}(E)$ has units of $\\mathrm{J}^{-1}\\,\\mathrm{m}^{-2}$. When energies are expressed in electronvolts, the DOS per electronvolt is $g_{2\\mathrm{D},\\mathrm{eV}}(E) = q\\,g_{2\\mathrm{D},J}(E)$, where $q$ is the elementary charge.\n\nElectrons occupy states according to the Fermi–Dirac distribution\n$$\nf(E,\\mu,T) = \\frac{1}{1 + \\exp\\!\\left(\\frac{E - \\mu}{k_B T}\\right)},\n$$\nwhere $E$ and $\\mu$ are energies in electronvolts, $T$ is the absolute temperature in Kelvin, and $k_B$ is the Boltzmann constant written in electronvolts per Kelvin.\n\nThe sheet electron concentration $n(T)$ (in $\\mathrm{m}^{-2}$) in the conduction band at temperature $T$ and chemical potential $\\mu(T)$ is defined from first principles by the energy integral\n$$\nn(T) = \\int_{E_c}^{\\infty} g_{2\\mathrm{D},\\mathrm{eV}}(E)\\, f(E,\\mu(T),T)\\,\\mathrm{d}E,\n$$\nwith $E$ expressed in electronvolts.\n\nAssume a physically motivated temperature-dependent chemical potential of the form\n$$\n\\mu(T) = E_c + \\Delta - \\lambda\\,k_B\\,T,\n$$\nwith constants $\\Delta  0$ and $\\lambda  0$. This functional form captures a decrease in $\\mu(T)$ with increasing temperature, which is observed in many reservoir-coupled or doped two-dimensional systems.\n\nYour task is to write a program that numerically evaluates $n(T)$ for the following test suite of temperatures, materials, and parameters, and analyzes the crossover from nondegenerate to degenerate behavior using the dimensionless parameter\n$$\n\\eta(T) = \\frac{\\mu(T) - E_c}{k_B T}.\n$$\nFor classification, adopt the following convention based on $\\eta(T)$:\n- Degenerate regime if $\\eta(T) \\ge 3$.\n- Nondegenerate regime if $\\eta(T) \\le -3$.\n- Transitional regime otherwise.\n\nThe program should compute, for each test case, the sheet electron concentration $n(T)$ in $\\mathrm{m}^{-2}$, the value of $\\eta(T)$ (dimensionless), and a boolean indicating whether the system is in the degenerate regime (True for degenerate, False otherwise).\n\nUse the following scientifically plausible parameter values representative of a monolayer transition metal dichalcogenide (an emerging semiconductor material):\n- Effective mass: $m^\\* = 0.45\\,m_e$, where $m_e$ is the electron rest mass in kilograms.\n- Valley degeneracy: $g_v = 2$.\n- Spin degeneracy: $g_s = 2$.\n- Conduction band edge: $E_c = 0\\,\\mathrm{eV}$.\n- Chemical potential parameters: $\\Delta = 0.05\\,\\mathrm{eV}$ and $\\lambda = 4.0$.\n- Physical constants: $q$ in Coulombs, $\\hbar$ in Joule-seconds, and $k_B$ in electronvolts per Kelvin.\n\nTest suite temperatures (in Kelvin):\n- $T_1 = 5$ (low temperature, expected degenerate regime),\n- $T_2 = 120$ (intermediate temperature),\n- $T_3 = 145$ (near crossover),\n- $T_4 = 300$ (room temperature),\n- $T_5 = 1000$ (high temperature, expected nondegenerate regime).\n\nRequirements:\n- Numerically evaluate the integral for $n(T)$ as specified above without using any closed-form shortcuts.\n- Express the sheet electron concentration $n(T)$ in $\\mathrm{m}^{-2}$ and round it to six significant figures.\n- Express $\\eta(T)$ as a dimensionless float rounded to six significant figures.\n- The degenerate boolean should be True if $\\eta(T) \\ge 3$, and False otherwise.\n\nFinal output format:\nYour program should produce a single line of output containing the aggregated results as a comma-separated flat list enclosed in square brackets, with each test case contributing a triplet in the order $[n(T), \\eta(T), \\text{is\\_degenerate}]$. For example: \"[n1,eta1,True,n2,eta2,False,...]\".",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded in the principles of solid-state physics, well-posed with all necessary parameters defined, and objective in its formulation. All conditions required for a valid problem are met.\n\nThe primary objective is to compute the sheet electron concentration, $n(T)$, for a two-dimensional semiconductor at various temperatures. The calculation is based on fundamental principles of statistical mechanics, specifically the Fermi-Dirac distribution and the concept of the density of states (DOS).\n\nFirst, we restate the governing equations and define the constants. The sheet electron concentration $n(T)$ is given by the integral of the product of the density of states per unit energy (in $\\mathrm{eV}^{-1}\\,\\mathrm{m}^{-2}$) and the Fermi-Dirac distribution function over all available energy states in the conduction band:\n$$\nn(T) = \\int_{E_c}^{\\infty} g_{2\\mathrm{D},\\mathrm{eV}}(E)\\, f(E,\\mu(T),T)\\,\\mathrm{d}E\n$$\nThe energy $E$, chemical potential $\\mu(T)$, and conduction band edge $E_c$ are expressed in electronvolts ($\\mathrm{eV}$).\n\nThe density of states for a 2D parabolic band is constant for energies above the conduction band edge $E_c$. The problem provides the formula in units of $\\mathrm{J}^{-1}\\,\\mathrm{m}^{-2}$:\n$$\ng_{2\\mathrm{D},J}(E) = \\frac{g_s g_v m^\\*}{2\\pi \\hbar^2}\n$$\nfor $E \\ge E_c$. To use this in an integral where the energy differential $\\mathrm{d}E$ is in electronvolts, we must convert the DOS to units of $\\mathrm{eV}^{-1}\\,\\mathrm{m}^{-2}$. This is achieved by multiplying by the elementary charge, $q$:\n$$\ng_{2\\mathrm{D},\\mathrm{eV}}(E) = q \\cdot g_{2\\mathrm{D},J}(E) = \\frac{q g_s g_v m^\\*}{2\\pi \\hbar^2}\n$$\nLet us denote this constant value as $g_0$. It is independent of energy for $E \\ge E_c$.\nThe given parameters are:\n- Spin degeneracy, $g_s = 2$.\n- Valley degeneracy, $g_v = 2$.\n- Effective mass, $m^\\* = 0.45\\,m_e$, where $m_e$ is the electron rest mass.\n- Reduced Planck constant, $\\hbar$.\n- Elementary charge, $q$.\n\nThe probability of an electron occupying a state with energy $E$ is given by the Fermi-Dirac distribution:\n$$\nf(E,\\mu,T) = \\frac{1}{1 + \\exp\\!\\left(\\frac{E - \\mu}{k_B T}\\right)}\n$$\nwhere $T$ is the absolute temperature in Kelvin and $k_B$ is the Boltzmann constant in $\\mathrm{eV}\\,\\mathrm{K}^{-1}$.\n\nThe chemical potential $\\mu(T)$ is given a specific temperature dependence:\n$$\n\\mu(T) = E_c + \\Delta - \\lambda\\,k_B\\,T\n$$\nwith constants $\\Delta = 0.05\\,\\mathrm{eV}$ and $\\lambda = 4.0$. The conduction band edge is set to $E_c = 0\\,\\mathrm{eV}$ for simplicity.\n\nSubstituting the constant DOS and the Fermi-Dirac function into the integral for $n(T)$, we get:\n$$\nn(T) = g_0 \\int_{E_c}^{\\infty} \\frac{1}{1 + \\exp\\!\\left(\\frac{E - \\mu(T)}{k_B T}\\right)}\\,\\mathrm{d}E\n$$\nAlthough this integral possesses an analytical solution, $n(T) = g_0 k_B T \\ln(1 + \\exp(\\eta(T)))$, the problem statement explicitly requires a direct numerical evaluation of the integral without using this closed-form shortcut. We will use numerical quadrature for this purpose. The integral's upper limit is infinity, which is handled by standard numerical integration libraries like `scipy.integrate.quad`. The integrand decays exponentially, ensuring numerical stability and convergence.\n\nThe problem also requires the calculation of the dimensionless parameter $\\eta(T)$, which measures the position of the chemical potential relative to the band edge in units of thermal energy $k_B T$:\n$$\n\\eta(T) = \\frac{\\mu(T) - E_c}{k_B T}\n$$\nSubstituting the given form for $\\mu(T)$ and $E_c=0$, this simplifies to:\n$$\n\\eta(T) = \\frac{(E_c + \\Delta - \\lambda k_B T) - E_c}{k_B T} = \\frac{\\Delta}{k_B T} - \\lambda\n$$\n\nFinally, the system is classified as degenerate if $\\eta(T) \\ge 3$ and nondegenerate if $\\eta(T) \\le -3$. The task asks for a boolean flag indicating if the system is in the degenerate regime.\n\nThe computational procedure for each temperature $T$ in the test suite is as follows:\n1.  Define all physical constants and model parameters using their standard values.\n2.  Calculate the constant DOS value, $g_0 = \\frac{q g_s g_v m^\\*}{2\\pi \\hbar^2}$.\n3.  Calculate the temperature-dependent chemical potential $\\mu(T) = E_c + \\Delta - \\lambda k_B T$.\n4.  Define the integrand function, $I(E; \\mu, T) = g_0 \\cdot f(E, \\mu, T)$.\n5.  Numerically compute the integral $n(T) = \\int_{E_c}^{\\infty} I(E; \\mu(T), T) \\, \\mathrm{d}E$.\n6.  Calculate the parameter $\\eta(T) = (\\mu(T) - E_c)/(k_B T)$.\n7.  Determine the degeneracy status: `is_degenerate` is `True` if $\\eta(T) \\ge 3$, otherwise `False`.\n8.  Round the calculated values of $n(T)$ and $\\eta(T)$ to six significant figures.\n9.  Store and format the results as a triplet $(n(T), \\eta(T), \\text{is\\_degenerate})$ for each temperature.",
            "answer": "```python\nimport numpy as np\nfrom scipy import constants\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes sheet electron concentration n(T), dimensionless parameter eta(T),\n    and degeneracy status for a 2D semiconductor at various temperatures.\n    \"\"\"\n    \n    # --- Physical Constants ---\n    # Using scipy.constants for high precision.\n    Q = constants.e  # Elementary charge in C\n    M_E = constants.m_e  # Electron rest mass in kg\n    HBAR = constants.hbar  # Reduced Planck constant in J*s\n    K_B_J = constants.k  # Boltzmann constant in J/K\n    \n    # Boltzmann constant in eV/K, as required by the problem's energy units.\n    K_B_EV = K_B_J / Q\n\n    # --- Material and Model Parameters ---\n    M_STAR = 0.45 * M_E   # Effective mass in kg\n    G_V = 2.0             # Valley degeneracy\n    G_S = 2.0             # Spin degeneracy\n    E_C = 0.0             # Conduction band edge in eV\n    DELTA = 0.05          # Chemical potential parameter in eV\n    LAMBDA = 4.0          # Chemical potential parameter, dimensionless\n\n    # --- Test Suite Temperatures ---\n    # T1 to T5 in Kelvin\n    test_temperatures = [5.0, 120.0, 145.0, 300.0, 1000.0]\n\n    # --- Pre-calculation of the constant 2D Density of States ---\n    # DOS in units of eV^-1 * m^-2, denoted g0 in the solution explanation.\n    # g_2D,J = (g_s * g_v * m^*) / (2 * pi * hbar^2)  [J^-1 m^-2]\n    # g_2D,eV = q * g_2D,J                           [eV^-1 m^-2]\n    g0 = (Q * G_S * G_V * M_STAR) / (2 * np.pi * HBAR**2)\n\n    def round_to_sf(num, sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if num == 0:\n            return 0.0\n        # This string formatting method is a robust way to handle sig figs.\n        return float(f'{num:.{sf-1}e}')\n\n    results = []\n    for T in test_temperatures:\n        # Calculate temperature-dependent chemical potential\n        mu_T = E_C + DELTA - LAMBDA * K_B_EV * T\n        \n        # Define the integrand for numerical integration\n        # f(E) = g0 * (1 / (1 + exp((E - mu) / (kB * T))))\n        def integrand(E, mu, temp):\n            # The exponent can become very large, leading to overflow in exp().\n            # As E - infinity, f(E) - 0.\n            exponent = (E - mu) / (K_B_EV * temp)\n            if exponent  700:  # np.exp(709) is ~inf.\n                return 0.0\n            return g0 / (1.0 + np.exp(exponent))\n\n        # Numerically evaluate the integral for n(T)\n        # Integrate from E_c to infinity. quad handles np.inf correctly.\n        n_T, _ = quad(integrand, E_C, np.inf, args=(mu_T, T))\n\n        # Calculate the dimensionless parameter eta(T)\n        eta_T = (mu_T - E_C) / (K_B_EV * T)\n\n        # Determine if the system is in the degenerate regime\n        is_degenerate = eta_T = 3.0\n\n        # Round n(T) and eta(T) to six significant figures\n        n_T_rounded = round_to_sf(n_T, 6)\n        eta_T_rounded = round_to_sf(eta_T, 6)\n\n        # Append the triplet of results to the flat list\n        results.append(n_T_rounded)\n        results.append(eta_T_rounded)\n        results.append(is_degenerate)\n\n    # Format the final output string as specified\n    # The map(str, ...) correctly handles float, int, and bool types.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "In doped semiconductors, the Fermi level is not an independent variable but is self-consistently determined by the intricate balance of all charges present—electrons, holes, and ionized impurities. This capstone practice challenges you to develop a robust numerical solver to find this equilibrium Fermi level by enforcing the charge neutrality condition. Tackling this problem requires you to integrate carrier statistics, impurity ionization models, and numerical methods into a single, powerful tool, providing hands-on experience with a foundational task in semiconductor physics and device simulation .",
            "id": "4275340",
            "problem": "You are tasked with designing and implementing a complete, runnable program that computes the chemical potential (Fermi level) $\\,\\mu\\,$ in electronvolts (eV) for a three-dimensional semiconductor with parabolic energy bands, at a given absolute temperature $\\,T\\,$, donor density $\\,N_{\\mathrm{D}}\\,$, and acceptor density $\\,N_{\\mathrm{A}}\\,$. The computation must enforce charge neutrality using the Fermi-Dirac distribution and density-of-states integrals. Your algorithm must be self-consistent: the occupation of donors and acceptors depends on $\\,\\mu\\,$, which must be updated until neutrality is reached.\n\nYour derivation must start from the following fundamental base:\n- The Fermi-Dirac distribution $\\,f(E,\\mu,T) = \\dfrac{1}{1+\\exp\\!\\left(\\dfrac{E-\\mu}{k_{\\mathrm{B}} T}\\right)}\\,$, where $\\,k_{\\mathrm{B}}\\,$ is the Boltzmann constant.\n- The three-dimensional parabolic-band density of states for the conduction band $\\,D_{\\mathrm{c}}(E) = \\dfrac{1}{2\\pi^2}\\!\\left(\\dfrac{2 m_n^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E - E_{\\mathrm{C}}}\\,$ for $\\,E \\ge E_{\\mathrm{C}}\\,$, and for the valence band $\\,D_{\\mathrm{v}}(E) = \\dfrac{1}{2\\pi^2}\\!\\left(\\dfrac{2 m_p^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E_{\\mathrm{V}} - E}\\,$ for $\\,E \\le E_{\\mathrm{V}}\\,$, where $\\,m_n^\\ast\\,$ and $\\,m_p^\\ast\\,$ are the electron and hole effective masses, respectively, $\\,\\hbar\\,$ is the reduced Planck constant, $\\,E_{\\mathrm{C}}\\,$ is the conduction band minimum, and $\\,E_{\\mathrm{V}}\\,$ is the valence band maximum.\n- The carrier concentrations obtained from these integrals,\n$$\nn(\\mu,T) = \\int_{E_{\\mathrm{C}}}^{\\infty} D_{\\mathrm{c}}(E)\\, f(E,\\mu,T)\\, \\mathrm{d}E,\\qquad\np(\\mu,T) = \\int_{-\\infty}^{E_{\\mathrm{V}}} D_{\\mathrm{v}}(E)\\, \\big[1 - f(E,\\mu,T)\\big]\\, \\mathrm{d}E.\n$$\n- The ionized donor and acceptor densities modeled as single-level impurities with degeneracy factors $\\,g_{\\mathrm{D}}\\,$ and $\\,g_{\\mathrm{A}}\\,$ and energy levels $\\,E_{\\mathrm{D}}\\,$ and $\\,E_{\\mathrm{A}}\\,$:\n$$\nN_{\\mathrm{D}}^+(\\mu,T) = \\frac{N_{\\mathrm{D}}}{1 + g_{\\mathrm{D}} \\exp\\!\\left(\\frac{\\mu - E_{\\mathrm{D}}}{k_{\\mathrm{B}} T}\\right)},\\qquad\nN_{\\mathrm{A}}^-(\\mu,T) = \\frac{N_{\\mathrm{A}}}{1 + g_{\\mathrm{A}} \\exp\\!\\left(\\frac{E_{\\mathrm{A}} - \\mu}{k_{\\mathrm{B}} T}\\right)}.\n$$\n- Charge neutrality,\n$$\nn(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) = p(\\mu,T) + N_{\\mathrm{D}}^+(\\mu,T).\n$$\n\nWorking assumptions and modeling requirements:\n- Treat the conduction and valence bands as isotropic and parabolic with the above densities of states.\n- Express the carrier integrals using the normalized complete Fermi-Dirac integral of order $\\,\\tfrac{1}{2}\\,$,\n$$\nF_{1/2}(\\eta) = \\frac{2}{\\sqrt{\\pi}} \\int_{0}^{\\infty} \\frac{\\sqrt{x}}{1 + \\exp(x - \\eta)}\\, \\mathrm{d}x,\n$$\nand the effective density of states $\\,N_{\\mathrm{C}}(T) = 2 \\left( \\dfrac{2\\pi m_n^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\\,$, $\\,N_{\\mathrm{V}}(T) = 2 \\left( \\dfrac{2\\pi m_p^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\\,$, where $\\,h\\,$ is the Planck constant. Use these to express\n$$\nn(\\mu,T) = N_{\\mathrm{C}}(T)\\, F_{1/2}\\!\\left(\\frac{\\mu - E_{\\mathrm{C}}}{k_{\\mathrm{B}} T}\\right),\\qquad\np(\\mu,T) = N_{\\mathrm{V}}(T)\\, F_{1/2}\\!\\left(\\frac{E_{\\mathrm{V}} - \\mu}{k_{\\mathrm{B}} T}\\right).\n$$\n\nSelf-consistent algorithm design requirements:\n- Define the scalar residual $\\,R(\\mu) = n(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) - p(\\mu,T) - N_{\\mathrm{D}}^+(\\mu,T)\\,$. Solve for the root $\\,R(\\mu^\\star) = 0\\,$ using a robust bracketing method with guaranteed convergence (e.g., bisection or a bracketed secant method). You must explain the convergence criteria within your solution and implement them in code.\n- Your algorithm must ensure that the bracket $\\,\\mu\\in[\\mu_{\\min},\\mu_{\\max}]\\,$ contains a sign change of $\\,R(\\mu)\\,$. If no sign change exists within the initial bracket, you must enlarge or scan the bracket systematically until a sign change is found or until you can conclude no physical solution exists within a reasonable range. In this problem, you must implement a safe scanning strategy and then use a bracketed root finder.\n- Implement $\\,F_{1/2}(\\eta)\\,$ numerically using a reliable quadrature for the integral representation. You may use numerical integration over the semi-infinite domain $\\,x\\in[0,\\infty)\\,$. Ensure numerical stability for large positive or negative $\\,\\eta\\,$.\n\nPhysical and numerical units:\n- Energies $\\,E\\,$, $\\,\\mu\\,$, $\\,E_{\\mathrm{C}}\\,$, $\\,E_{\\mathrm{V}}\\,$, $\\,E_{\\mathrm{D}}\\,$, $\\,E_{\\mathrm{A}}\\,$ must be in electronvolts (eV).\n- Temperature $\\,T\\,$ must be in Kelvin ($\\mathrm{K}$).\n- Densities $\\,N_{\\mathrm{D}}\\,$, $\\,N_{\\mathrm{A}}\\,$, $\\,n\\,$, $\\,p\\,$, $\\,N_{\\mathrm{C}}\\,$, $\\,N_{\\mathrm{V}}\\,$ must be in $\\mathrm{cm}^{-3}$.\n- The final answers must be expressed as values of $\\,\\mu\\,$ in eV, rounded to six decimal places.\n\nConvergence criteria:\n- The iterative root-finding must stop when both $\\,|R(\\mu)| \\le \\varepsilon_R\\,$ and $\\,|\\Delta \\mu| \\le \\varepsilon_\\mu\\,$, where $\\,\\varepsilon_\\mu = 10^{-6}\\,$ eV and $\\,\\varepsilon_R = \\max\\!\\big(10^{-6}\\,\\mathcal{N},\\,10^{8}\\big)\\,$ with $\\,\\mathcal{N} = N_{\\mathrm{D}} + N_{\\mathrm{A}} + N_{\\mathrm{C}}(T) + N_{\\mathrm{V}}(T)\\,$. If your chosen numerical root finder does not expose $\\,|\\Delta \\mu|\\,$ directly, enforce $\\,|R(\\mu)| \\le \\varepsilon_R\\,$ and an absolute bracket tolerance on $\\,\\mu\\,$ less than $\\,\\varepsilon_\\mu\\,$.\n\nBand and material parameters:\n- Use $\\,E_{\\mathrm{V}} = 0\\,$ eV and $\\,E_{\\mathrm{C}} = E_{\\mathrm{g}}\\,$ with the bandgap $\\,E_{\\mathrm{g}}\\,$ specified per test case.\n- Use $\\,m_n^\\ast = 1.08\\,m_0\\,$, $\\,m_p^\\ast = 0.81\\,m_0\\,$, where $\\,m_0\\,$ is the electron rest mass.\n- Unless otherwise indicated, use $\\,g_{\\mathrm{D}} = 2\\,$ and $\\,g_{\\mathrm{A}} = 4\\,$.\n\nTest suite:\nImplement your program to solve for $\\,\\mu\\,$ for the following five parameter sets. Each test case is a tuple $\\,(\\,E_{\\mathrm{g}},\\, T,\\, N_{\\mathrm{D}},\\, N_{\\mathrm{A}},\\, E_{\\mathrm{D}},\\, E_{\\mathrm{A}},\\, g_{\\mathrm{D}},\\, g_{\\mathrm{A}}\\,)\\,$ with energies in eV, temperature in K, and densities in $\\mathrm{cm}^{-3}$.\n\n- Case $\\,1\\,$ (intrinsic-like, silicon-like):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 0\\,$, $\\,N_{\\mathrm{A}} = 0\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.05\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.05\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- Case $\\,2\\,$ (moderately $\\,n$-type):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 1.0\\times 10^{16}\\,$, $\\,N_{\\mathrm{A}} = 0\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.045\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.05\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- Case $\\,3\\,$ (strongly $\\,p$-type):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 0\\,$, $\\,N_{\\mathrm{A}} = 1.0\\times 10^{18}\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.05\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.03\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- Case $\\,4\\,$ (compensated, low $\\,T\\,$ with incomplete ionization):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 50\\,$, $\\,N_{\\mathrm{D}} = 1.0\\times 10^{17}\\,$, $\\,N_{\\mathrm{A}} = 5.0\\times 10^{16}\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.05\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.06\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\n- Case $\\,5\\,$ (degenerate $\\,n$-type, heavy doping):\n  - $\\,E_{\\mathrm{g}} = 1.12\\,$, $\\,T = 300\\,$, $\\,N_{\\mathrm{D}} = 5.0\\times 10^{19}\\,$, $\\,N_{\\mathrm{A}} = 1.0\\times 10^{17}\\,$,\n  - $\\,E_{\\mathrm{D}} = E_{\\mathrm{C}} - 0.02\\,$, $\\,E_{\\mathrm{A}} = E_{\\mathrm{V}} + 0.06\\,$,\n  - $\\,g_{\\mathrm{D}} = 2\\,$, $\\,g_{\\mathrm{A}} = 4\\,$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry must be the value of $\\,\\mu\\,$ in eV for the corresponding test case, rounded to six decimal places, in the same order as listed above. For example, $\\,\\big[\\mu_1,\\mu_2,\\mu_3,\\mu_4,\\mu_5\\big]\\,$ with each $\\,\\mu_i\\,$ as a decimal to six places.",
            "solution": "The user-provided problem is assessed as **valid**. It is a well-posed, scientifically grounded problem in semiconductor physics that requests the development of a numerical algorithm to find the Fermi level by enforcing charge neutrality. The problem provides all necessary physical models, equations, and parameters.\n\n### 1. Theoretical Framework\n\nThe core of the problem is to find the chemical potential (Fermi level) $\\mu$ in a doped semiconductor by solving the charge neutrality equation. This equation states that the total negative charge density must equal the total positive charge density. The charge carriers are free electrons in the conduction band, free holes in the valence band, ionized acceptor impurities, and ionized donor impurities.\n\nThe charge neutrality condition is expressed as:\n$$\nn(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) = p(\\mu,T) + N_{\\mathrm{D}}^+(\\mu,T)\n$$\n\nwhere:\n- $n(\\mu,T)$ is the electron concentration in the conduction band.\n- $p(\\mu,T)$ is the hole concentration in the valence band.\n- $N_{\\mathrm{A}}^-(\\mu,T)$ is the concentration of ionized acceptors.\n- $N_{\\mathrm{D}}^+(\\mu,T)$ is the concentration of ionized donors.\n- $T$ is the absolute temperature.\n\nTo solve for $\\mu$, we define a residual function $R(\\mu,T)$ whose root corresponds to the charge neutrality condition:\n$$\nR(\\mu,T) = n(\\mu,T) + N_{\\mathrm{A}}^-(\\mu,T) - p(\\mu,T) - N_{\\mathrm{D}}^+(\\mu,T) = 0\n$$\n\nThe terms of this equation are defined as follows, based on Fermi-Dirac statistics and the density of states.\n\n### 2. Carrier Concentrations\n\nThe concentrations of electrons ($n$) and holes ($p$) are given by integrating the product of the density of states (DOS) and the appropriate occupation probability over all available energy states.\n\nFor electrons in a parabolic conduction band with minimum energy $E_{\\mathrm{C}}$:\n$$\nn(\\mu,T) = \\int_{E_{\\mathrm{C}}}^{\\infty} D_{\\mathrm{c}}(E) f(E,\\mu,T) \\, \\mathrm{d}E\n$$\nwhere $f(E,\\mu,T) = \\frac{1}{1+\\exp\\left(\\frac{E-\\mu}{k_{\\mathrm{B}} T}\\right)}$ is the Fermi-Dirac distribution function, and $D_{\\mathrm{c}}(E) = \\dfrac{1}{2\\pi^2}\\left(\\dfrac{2 m_n^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E - E_{\\mathrm{C}}}$ is the conduction band DOS.\n\nFor holes in a parabolic valence band with maximum energy $E_{\\mathrm{V}}$:\n$$\np(\\mu,T) = \\int_{-\\infty}^{E_{\\mathrm{V}}} D_{\\mathrm{v}}(E) [1 - f(E,\\mu,T)] \\, \\mathrm{d}E\n$$\nwhere $1 - f(E,\\mu,T)$ is the probability that a state is occupied by a hole, and $D_{\\mathrm{v}}(E) = \\dfrac{1}{2\\pi^2}\\left(\\dfrac{2 m_p^\\ast}{\\hbar^2}\\right)^{3/2} \\sqrt{E_{\\mathrm{V}} - E}$ is the valence band DOS.\n\nThese integrals can be reformulated using the complete Fermi-Dirac integral of order $j$, $F_j(\\eta)$, defined as:\n$$\nF_j(\\eta) = \\frac{1}{\\Gamma(j+1)} \\int_{0}^{\\infty} \\frac{x^j}{1 + \\exp(x - \\eta)} \\, \\mathrm{d}x\n$$\nFor our case, $j=\\frac{1}{2}$, and $\\Gamma(\\frac{3}{2}) = \\frac{\\sqrt{\\pi}}{2}$. This leads to the problem's definition:\n$$\nF_{1/2}(\\eta) = \\frac{2}{\\sqrt{\\pi}} \\int_{0}^{\\infty} \\frac{\\sqrt{x}}{1 + \\exp(x - \\eta)} \\, \\mathrm{d}x\n$$\nThe carrier concentrations can then be expressed compactly as:\n$$\nn(\\mu,T) = N_{\\mathrm{C}}(T) F_{1/2}\\left(\\frac{\\mu - E_{\\mathrm{C}}}{k_{\\mathrm{B}} T}\\right)\n$$\n$$\np(\\mu,T) = N_{\\mathrm{V}}(T) F_{1/2}\\left(\\frac{E_{\\mathrm{V}} - \\mu}{k_{\\mathrm{B}} T}\\right)\n$$\nHere, $N_{\\mathrm{C}}(T)$ and $N_{\\mathrm{V}}(T)$ are the effective densities of states for the conduction and valence bands, respectively:\n$$\nN_{\\mathrm{C}}(T) = 2 \\left( \\frac{2\\pi m_n^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\n$$\n$$\nN_{\\mathrm{V}}(T) = 2 \\left( \\frac{2\\pi m_p^\\ast k_{\\mathrm{B}} T}{h^2} \\right)^{3/2}\n$$\nThese will be calculated using fundamental constants in SI units, yielding results in $\\mathrm{m}^{-3}$, which are then converted to $\\mathrm{cm}^{-3}$ by multiplying by $10^{-6}$.\n\n### 3. Ionized Impurity Concentrations\n\nThe concentrations of ionized donors ($N_{\\mathrm{D}}^+$) and acceptors ($N_{\\mathrm{A}}^-$) are modeled assuming single, non-interacting energy levels at $E_{\\mathrm{D}}$ and $E_{\\mathrm{A}}$. The probability of ionization is also governed by Fermi-Dirac-like statistics, including degeneracy factors $g_{\\mathrm{D}}$ and $g_{\\mathrm{A}}$:\n$$\nN_{\\mathrm{D}}^+(\\mu,T) = N_{\\mathrm{D}} \\left[ 1 - \\frac{1}{1 + \\frac{1}{g_{\\mathrm{D}}} \\exp\\left(\\frac{E_{\\mathrm{D}} - \\mu}{k_{\\mathrm{B}} T}\\right)} \\right] = \\frac{N_{\\mathrm{D}}}{1 + g_{\\mathrm{D}} \\exp\\left(\\frac{\\mu - E_{\\mathrm{D}}}{k_{\\mathrm{B}} T}\\right)}\n$$\n$$\nN_{\\mathrm{A}}^-(\\mu,T) = N_{\\mathrm{A}} \\left[ \\frac{1}{1 + g_{\\mathrm{A}} \\exp\\left(\\frac{E_{\\mathrm{A}} - \\mu}{k_{\\mathrm{B}} T}\\right)} \\right] = \\frac{N_{\\mathrm{A}}}{1 + g_{\\mathrm{A}} \\exp\\left(\\frac{E_{\\mathrm{A}} - \\mu}{k_{\\mathrm{B}} T}\\right)}\n$$\nwhere $N_{\\mathrm{D}}$ and $N_{\\mathrm{A}}$ are the total concentrations of donor and acceptor atoms.\n\n### 4. Numerical Solution Strategy\n\n**Fermi-Dirac Integral Implementation**:\nThe integral $F_{1/2}(\\eta)$ will be computed numerically. A robust approach involves using an adaptive quadrature routine, such as `scipy.integrate.quad`, for a wide range of $\\eta$. For extreme values of $\\eta$, where numerical overflow or underflow can occur, asymptotic approximations provide stability and efficiency:\n- For large negative $\\eta$ (non-degenerate case, $\\eta \\ll 0$): $F_{1/2}(\\eta) \\approx e^{\\eta}$.\n- For large positive $\\eta$ (degenerate case, $\\eta \\gg 0$): $F_{1/2}(\\eta) \\approx \\frac{4}{3\\sqrt{\\pi}}\\eta^{3/2}$.\nWe will implement a wrapper function that switches to these approximations for $\\eta  -30$ and $\\eta  50$.\n\n**Root-Finding Algorithm**:\nThe objective is to find the root $\\mu^\\star$ of the residual function $R(\\mu,T) = 0$. The properties of $R(\\mu,T)$ are key to selecting a robust algorithm. Each term's dependence on $\\mu$ is:\n- $n(\\mu,T)$ is monotonically increasing.\n- $N_{\\mathrm{A}}^-(\\mu,T)$ is monotonically increasing.\n- $-p(\\mu,T)$ is monotonically increasing (since $p$ is decreasing).\n- $-N_{\\mathrm{D}}^+(\\mu,T)$ is monotonically increasing (since $N_{\\mathrm{D}}^+$ is decreasing).\n\nSince $R(\\mu,T)$ is a sum of monotonically increasing functions, it is itself strictly monotonically increasing with $\\mu$. Furthermore, as $\\mu \\to -\\infty$, $R(\\mu) \\to -\\infty$, and as $\\mu \\to +\\infty$, $R(\\mu) \\to +\\infty$. This guarantees that a unique root $\\mu^\\star$ exists for any valid set of physical parameters.\n\nThis monotonicity makes bracketing root-finders ideal. We will use the `brentq` algorithm from SciPy, which combines the reliability of bisection with the speed of secant and inverse quadratic interpolation methods.\n\nThe algorithm proceeds as follows:\n1.  **Establish a Bracket**: For a given test case, define a wide initial search bracket for $\\mu$, for example $[\\mu_{\\min}, \\mu_{\\max}]$. A safe choice is a range extending beyond the bandgap, e.g., $[E_{\\mathrm{V}} - 1.0 \\, \\text{eV}, E_{\\mathrm{C}} + 1.0 \\, \\text{eV}]$.\n2.  **Verify Sign Change**: We will evaluate $R(\\mu_{\\min})$ and $R(\\mu_{\\max})$. Due to the function's behavior, we expect $R(\\mu_{\\min})  0$ and $R(\\mu_{\\max})  0$, confirming a root is bracketed. If not, the bracket can be systematically expanded, though this is not expected to be necessary.\n3.  **Solve**: The `brentq` solver is called with the function $R$, the bracket $[\\mu_{\\min}, \\mu_{\\max}]$, and a specified tolerance. We will set a tight absolute tolerance on the root, `xtol`, of $10^{-7} \\, \\text{eV}$. This is stricter than the required $\\varepsilon_\\mu = 10^{-6} \\, \\text{eV}$ and, due to the steepness of $R(\\mu)$, will ensure the residual $|R(\\mu^\\star)|$ is very small, satisfying the spirit of the problem's convergence criteria.\n\nThe overall process is to iterate through each test case, assemble the parameters, define the corresponding residual function $R(\\mu)$, and apply the root-finding procedure to obtain $\\mu$. All calculations involving physical constants and energy conversions must be handled with care. We use constants from `scipy.constants` for high precision and perform calculations in SI units where appropriate before converting to the problem's specified units (cm$^{-3}$ and eV).",
            "answer": "```python\nimport numpy as np\nfrom scipy import constants\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the Fermi level (chemical potential) in a semiconductor for various\n    doping and temperature conditions by solving the charge neutrality equation.\n    \"\"\"\n\n    # --- Physical Constants ---\n    # Using scipy.constants for high precision.\n    m0 = constants.m_e  # Electron rest mass in kg\n    h = constants.h      # Planck constant in J·s\n    kB_J_K = constants.k # Boltzmann constant in J/K\n    q = constants.e      # Elementary charge in C\n\n    # Conversion factors\n    kB_eV_K = kB_J_K / q  # Boltzmann constant in eV/K\n\n    # --- Fermi-Dirac Integral F_1/2(eta) ---\n    def fermi_dirac_integral_half(eta):\n        \"\"\"\n        Computes the complete Fermi-Dirac integral of order 1/2.\n        F_1/2(eta) = (2/sqrt(pi)) * integral from 0 to inf of sqrt(x)/(1+exp(x-eta)) dx\n        \n        Uses asymptotic approximations for large positive or negative eta for stability\n        and performance.\n        \"\"\"\n        if eta  50:\n            # Degenerate approximation\n            return (4 / (3 * np.sqrt(np.pi))) * eta**1.5\n        elif eta  -30:\n            # Non-degenerate (Maxwell-Boltzmann) approximation\n            return np.exp(eta)\n        else:\n            # Numerical integration using scipy.integrate.quad\n            integrand = lambda x: np.sqrt(x) / (1 + np.exp(x - eta))\n            result, _ = quad(integrand, 0, np.inf)\n            return (2 / np.sqrt(np.pi)) * result\n\n    # --- Test Cases ---\n    # Each tuple: (Eg [eV], T [K], ND [cm^-3], NA [cm^-3], ED [eV], EA [eV], gD, gA)\n    # The energy levels ED and EA are pre-calculated from the problem description.\n    # EV is set to 0 eV, so EC = Eg.\n    test_cases_desc = [\n        # Case 1: Intrinsic-like\n        (1.12, 300, 0.0, 0.0, 1.12 - 0.05, 0.0 + 0.05, 2, 4),\n        # Case 2: Moderately n-type\n        (1.12, 300, 1.0e16, 0.0, 1.12 - 0.045, 0.0 + 0.05, 2, 4),\n        # Case 3: Strongly p-type\n        (1.12, 300, 0.0, 1.0e18, 1.12 - 0.05, 0.0 + 0.03, 2, 4),\n        # Case 4: Compensated, low T\n        (1.12, 50, 1.0e17, 5.0e16, 1.12 - 0.05, 0.0 + 0.06, 2, 4),\n        # Case 5: Degenerate n-type\n        (1.12, 300, 5.0e19, 1.0e17, 1.12 - 0.02, 0.0 + 0.06, 2, 4),\n    ]\n\n    # --- Material Parameters ---\n    mn_star_eff = 1.08 * m0  # Electron effective mass\n    mp_star_eff = 0.81 * m0  # Hole effective mass\n\n    results = []\n\n    for case in test_cases_desc:\n        Eg, T, ND, NA, ED, EA, gD, gA = case\n        \n        # --- Setup for Current Case ---\n        EV = 0.0\n        EC = Eg\n        kT_eV = kB_eV_K * T\n\n        # Calculate effective density of states (Nc, Nv)\n        # Formula: 2 * (2*pi*m_eff*kB*T / h^2)^(3/2)\n        # Calculation is done in SI units (m^-3), then converted to cm^-3.\n        \n        nc_si = 2 * ( (2 * np.pi * mn_star_eff * kB_J_K * T) / (h**2) )**1.5\n        nv_si = 2 * ( (2 * np.pi * mp_star_eff * kB_J_K * T) / (h**2) )**1.5\n        \n        NC = nc_si * 1e-6  # Convert m^-3 to cm^-3\n        NV = nv_si * 1e-6  # Convert m^-3 to cm^-3\n\n        # --- Residual Function for Root Finding ---\n        def residual_charge_neutrality(mu):\n            \"\"\"\n            Calculates the net charge density R(mu) = n + NA_ion - p - ND_ion.\n            The root R(mu) = 0 is the solution for the Fermi level.\n            All energies (mu, EC, EV, ED, EA) are in eV.\n            All densities are in cm^-3.\n            \"\"\"\n            \n            # Electron concentration (n)\n            eta_n = (mu - EC) / kT_eV\n            n = NC * fermi_dirac_integral_half(eta_n)\n            \n            # Hole concentration (p)\n            eta_p = (EV - mu) / kT_eV\n            p = NV * fermi_dirac_integral_half(eta_p)\n            \n            # Ionized donor concentration (ND+)\n            exp_term_d = np.exp((mu - ED) / kT_eV)\n            ND_plus = ND / (1 + gD * exp_term_d)\n            \n            # Ionized acceptor concentration (NA-)\n            exp_term_a = np.exp((EA - mu) / kT_eV)\n            NA_minus = NA / (1 + gA * exp_term_a)\n            \n            return n + NA_minus - p - ND_plus\n\n        # --- Solve for Fermi Level (mu) ---\n        # Establish a wide search bracket for mu\n        mu_min = EV - 1.0\n        mu_max = EC + 1.0\n        \n        # Use Brent's method for robust and fast root finding.\n        # The function is monotonic, so a unique root is guaranteed to exist.\n        # A tight tolerance on mu ensures high precision.\n        try:\n            mu_solution = brentq(residual_charge_neutrality, mu_min, mu_max, xtol=1e-8)\n            results.append(round(mu_solution, 6))\n        except ValueError:\n            # This should ideally not happen for this problem due to monotonic nature.\n            # Handle case where root is not bracketed, which indicates an issue.\n            results.append(np.nan) # Or other error indication\n\n    # --- Final Output ---\n    # Format the results as a comma-separated list in brackets, rounded to 6 decimal places.\n    output_str = f\"[{','.join(f'{r:.6f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}