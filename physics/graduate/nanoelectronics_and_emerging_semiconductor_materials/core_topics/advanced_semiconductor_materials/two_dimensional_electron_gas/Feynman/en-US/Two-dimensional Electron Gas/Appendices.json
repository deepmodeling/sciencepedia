{
    "hands_on_practices": [
        {
            "introduction": "Our first exercise grounds us in the defining characteristic of a 2DEG: quantum confinement. We will use one of the most fundamental models in quantum mechanics—the particle in an infinite potential well—to estimate the ground state energy of an electron confined in a semiconductor quantum well. This calculation makes the abstract concept of energy subbands concrete, showing how their energy scale is determined by the physical dimensions of the device and the material's properties. ",
            "id": "1822396",
            "problem": "In semiconductor heterostructures, a thin layer of one material can be sandwiched between layers of another material with a larger bandgap. This creates a potential well that can confine electrons, forcing their motion to be essentially two-dimensional and forming what is known as a Two-Dimensional Electron Gas (2DEG).\n\nConsider an electron within such a heterostructure, specifically in a Gallium Arsenide (GaAs) quantum well. We can model the confinement in the direction perpendicular to the layer (let's call it the $z$-direction) as an infinitely deep one-dimensional potential well. The electron is free to move in the $x-y$ plane but is trapped in the $z$-direction. The width of this potential well is $L_z = 12.0$ nm. Due to the crystal lattice of GaAs, the electron behaves as if it has an effective mass $m^*$, which is different from its mass in free space.\n\nCalculate the ground state confinement energy of the electron, which is the lowest possible energy level associated with its motion in the $z$-direction.\n\nUse the following constants:\n- Effective mass of an electron in GaAs: $m^* = 0.067 \\, m_e$\n- Mass of a free electron: $m_e = 9.109 \\times 10^{-31}$ kg\n- Planck's constant: $h = 6.626 \\times 10^{-34}$ J·s\n- Elementary charge: $e = 1.602 \\times 10^{-19}$ C\n\nExpress your final answer in electron-volts (eV), rounded to three significant figures.",
            "solution": "The electron is confined along the $z$-direction by an infinite square well of width $L_{z}$, and free in the $x$-$y$ plane. The quantized confinement energies for a particle of mass $m^{*}$ in a one-dimensional infinite potential well are given by\n$$\nE_{n}^{(z)}=\\frac{n^{2} h^{2}}{8 m^{*} L_{z}^{2}}, \\quad n=1,2,3,\\dots\n$$\nThe ground state corresponds to $n=1$, so\n$$\nE_{1}^{(z)}=\\frac{h^{2}}{8 m^{*} L_{z}^{2}}.\n$$\nUsing the provided constants and converting the well width to SI units,\n$$\nm^{*}=0.067\\,m_{e}=0.067 \\times \\left(9.109 \\times 10^{-31}\\ \\text{kg}\\right)=6.10303 \\times 10^{-32}\\ \\text{kg},\n$$\n$$\nL_{z}=12.0\\ \\text{nm}=12.0 \\times 10^{-9}\\ \\text{m}, \\quad L_{z}^{2}=1.44 \\times 10^{-16}\\ \\text{m}^{2},\n$$\nand\n$$\nh=6.626 \\times 10^{-34}\\ \\text{J}\\cdot\\text{s}, \\quad h^{2}=4.3903876 \\times 10^{-67}\\ \\text{J}^{2}\\cdot\\text{s}^{2}.\n$$\nCompute the denominator:\n$$\n8 m^{*} L_{z}^{2}=8 \\times \\left(6.10303 \\times 10^{-32}\\right) \\times \\left(1.44 \\times 10^{-16}\\right)=7.03069056 \\times 10^{-47}\\ \\text{kg}\\cdot\\text{m}^{2}.\n$$\nThus the ground state confinement energy in joules is\n$$\nE_{1}^{(z)}=\\frac{4.3903876 \\times 10^{-67}}{7.03069056 \\times 10^{-47}}\\ \\text{J}\n=6.2446 \\times 10^{-21}\\ \\text{J}.\n$$\nConvert to electron-volts using $1\\ \\text{eV} = e\\ \\text{J}$ with $e=1.602 \\times 10^{-19}\\ \\text{C}$:\n$$\nE_{1}^{(z)}=\\frac{6.2446 \\times 10^{-21}\\ \\text{J}}{1.602 \\times 10^{-19}\\ \\text{J/eV}}\n=3.898 \\times 10^{-2}\\ \\text{eV}.\n$$\nRounded to three significant figures, the ground state confinement energy is $0.0390\\ \\text{eV}$.",
            "answer": "$$\\boxed{0.0390}$$"
        },
        {
            "introduction": "Having established the single-particle energy levels, we now consider the collective behavior of the vast number of electrons that form the 2DEG. This practice explores the statistical properties of the electron gas by calculating its Fermi temperature, $T_F$, a key parameter indicating when quantum effects dominate thermal effects. You will see how the unique, energy-independent density of states in two dimensions allows for a direct link between the Fermi energy and the measurable sheet carrier density. ",
            "id": "1822371",
            "problem": "In the field of semiconductor physics, a Two-Dimensional Electron Gas (2DEG) represents a system where electrons are free to move in two dimensions but are tightly confined in the third. Such systems are fundamental to modern electronic devices like High Electron Mobility Transistors (HEMTs). A crucial characteristic of a 2DEG is its 'degeneracy temperature', which marks the approximate threshold below which the quantum nature of electrons, governed by Fermi-Dirac statistics, becomes dominant over classical thermal behavior.\n\nConsider a 2DEG formed within a Gallium Arsenide (GaAs) quantum well. The sheet carrier density, which is the number of electrons per unit area, is measured to be $n_s = 3.50 \\times 10^{15} \\text{ m}^{-2}$. The electrons moving within the GaAs crystal have an effective mass of $m_e^* = 0.0670 m_e$, where $m_e$ is the rest mass of a free electron.\n\nCalculate the degeneracy temperature for this 2DEG.\n\nFor your calculation, use the following constants:\n- Reduced Planck constant, $\\hbar = 1.055 \\times 10^{-34} \\text{ J}\\cdot\\text{s}$\n- Boltzmann constant, $k_B = 1.381 \\times 10^{-23} \\text{ J/K}$\n- Electron rest mass, $m_e = 9.109 \\times 10^{-31} \\text{ kg}$\n\nExpress your final answer in Kelvin (K), rounded to three significant figures.",
            "solution": "The problem asks for the degeneracy temperature of a Two-Dimensional Electron Gas (2DEG). This temperature, often called the Fermi temperature $T_F$, is defined by the relation $E_F = k_B T_F$, where $E_F$ is the Fermi energy and $k_B$ is the Boltzmann constant. To find $T_F$, we must first determine the Fermi energy $E_F$ for a 2D system.\n\nThe Fermi energy is the highest energy level occupied by an electron at absolute zero temperature ($T=0$ K). To find its relationship with the sheet carrier density $n_s$, we first need the density of states (DOS) for a 2D system.\n\nFor a non-interacting electron gas in two dimensions, the allowed states in momentum space (or k-space) are quantized. In a square sample of area $A = L \\times L$, the allowed $k$-vectors form a grid where each state occupies an area of $(\\frac{2\\pi}{L})^2$. The number of states within a circle of radius $k$ in k-space is given by the area of the circle divided by the area per state, multiplied by a factor of 2 for spin degeneracy (spin-up and spin-down electrons):\n$$N(k) = 2 \\times \\frac{\\pi k^2}{\\left(\\frac{2\\pi}{L}\\right)^2} = 2 \\frac{\\pi k^2 L^2}{4\\pi^2} = \\frac{A k^2}{2\\pi}$$\nwhere $A = L^2$ is the real-space area of the 2DEG.\n\nThe energy $E$ of an electron with an effective mass $m_e^*$ is related to its wavevector magnitude $k$ by the parabolic dispersion relation:\n$$E = \\frac{\\hbar^2 k^2}{2m_e^*}$$\nWe can express $k^2$ in terms of energy:\n$$k^2 = \\frac{2m_e^* E}{\\hbar^2}$$\nSubstituting this expression for $k^2$ into the equation for $N(k)$ gives the number of states with energy less than or equal to $E$:\n$$N(E) = \\frac{A}{2\\pi} \\left(\\frac{2m_e^* E}{\\hbar^2}\\right) = \\frac{A m_e^* E}{\\pi \\hbar^2}$$\nThe 2D density of states, $g_{2D}(E)$, is the number of states per unit energy per unit area. We find this by differentiating $N(E)$ with respect to $E$ and dividing by the area $A$:\n$$g_{2D}(E) = \\frac{1}{A} \\frac{dN(E)}{dE} = \\frac{1}{A} \\frac{d}{dE} \\left(\\frac{A m_e^* E}{\\pi \\hbar^2}\\right) = \\frac{m_e^*}{\\pi \\hbar^2}$$\nNotably, the 2D density of states is constant and independent of energy.\n\nAt absolute zero, all electronic states up to the Fermi energy $E_F$ are filled. The sheet carrier density $n_s$ is the total number of electrons per unit area, which can be found by integrating the density of states from zero energy up to the Fermi energy:\n$$n_s = \\int_0^{E_F} g_{2D}(E) dE = \\int_0^{E_F} \\frac{m_e^*}{\\pi \\hbar^2} dE$$\nSince $g_{2D}(E)$ is constant, the integral is straightforward:\n$$n_s = \\frac{m_e^*}{\\pi \\hbar^2} [E]_0^{E_F} = \\frac{m_e^* E_F}{\\pi \\hbar^2}$$\nNow, we can solve for the Fermi energy $E_F$:\n$$E_F = \\frac{n_s \\pi \\hbar^2}{m_e^*}$$\nThe degeneracy temperature $T_F$ is then given by:\n$$T_F = \\frac{E_F}{k_B} = \\frac{n_s \\pi \\hbar^2}{k_B m_e^*}$$\nNow we substitute the given numerical values into this expression. First, calculate the effective mass $m_e^*$:\n$m_e^* = 0.0670 \\times m_e = 0.0670 \\times (9.109 \\times 10^{-31} \\text{ kg}) = 6.10303 \\times 10^{-32} \\text{ kg}$.\n\nNow, substitute all values into the expression for $T_F$:\n$$T_F = \\frac{(3.50 \\times 10^{15} \\text{ m}^{-2}) \\times \\pi \\times (1.055 \\times 10^{-34} \\text{ J}\\cdot\\text{s})^2}{(1.381 \\times 10^{-23} \\text{ J/K}) \\times (6.10303 \\times 10^{-32} \\text{ kg})}$$\nLet's calculate the numerator and denominator separately for clarity.\nNumerator:\n$(3.50 \\times 10^{15}) \\times 3.14159 \\times (1.055 \\times 10^{-34})^2 = (3.50 \\times 10^{15}) \\times 3.14159 \\times (1.113025 \\times 10^{-68}) = 1.2238 \\times 10^{-52} \\text{ J}^2 \\cdot \\text{s}^2 \\cdot \\text{m}^{-2}$\nDenominator:\n$(1.381 \\times 10^{-23}) \\times (6.10303 \\times 10^{-32}) = 8.4283 \\times 10^{-55} \\text{ J} \\cdot \\text{K}^{-1} \\cdot \\text{kg}$\n\nNow, we compute the ratio:\n$$T_F = \\frac{1.2238 \\times 10^{-52}}{8.4283 \\times 10^{-55}} \\text{ K} \\approx 145.199 \\text{ K}$$\nThe problem asks for the answer to be rounded to three significant figures.\n$$T_F \\approx 145 \\text{ K}$$",
            "answer": "$$\\boxed{145}$$"
        },
        {
            "introduction": "Our final practice takes a significant step from idealized models to the realistic simulations used in modern research. While non-interacting models are instructive, electron-electron interactions profoundly influence the properties of a 2DEG. This computational exercise challenges you to incorporate many-body effects through the Local Density Approximation (LDA), calculating how exchange and correlation potentials shift the subband energies to provide a more accurate picture of the system's electronic structure. ",
            "id": "4311193",
            "problem": "Consider a quasi-two-dimensional electron gas confined in the growth direction by an ideal infinite quantum well of width $w$ in a semiconductor with effective electron mass $m^\\ast$ and relative dielectric constant $\\varepsilon_r$. The system is spin-degenerate and at zero temperature. The in-plane motion is free, leading to subbands indexed by $n=1,2,\\dots$ arising from quantization along $z \\in [0,w]$. The normalized envelope wavefunctions are $ \\psi_n(z) = \\sqrt{2/w} \\sin\\left(n \\pi z / w\\right) $, and the noninteracting subband energies are $ E_n^{(0)} = \\frac{\\hbar^2 \\pi^2 n^2}{2 m^\\ast w^2} $. The total sheet density is $n_s$ (units $\\mathrm{m^{-2}}$). At zero temperature, the sheet occupancy of each subband $n$ is $n_n = g_{\\mathrm{2D}} \\max\\left(0, E_F - E_n^{(0)}\\right)$, where $E_F$ is the Fermi energy determined by the constraint $ n_s = \\sum_{n=1}^{\\infty} n_n $, and $ g_{\\mathrm{2D}} = \\frac{m^\\ast}{\\pi \\hbar^2} $ is the total two-dimensional density of states per unit area including spin degeneracy.\n\nWithin the Local Density Approximation (LDA), the exchange-correlation potential $V_{\\mathrm{xc}}(z)$ entering the one-dimensional Schrödinger equation is a local functional of the three-dimensional electron density $n(z)$, given by $ n(z) = \\sum_{n=1}^{\\infty} n_n |\\psi_n(z)|^2 $. In LDA, $ V_{\\mathrm{xc}}(z) = v_x\\left(n(z)\\right) + v_c\\left(n(z)\\right) $, where $ v_x $ is the exchange potential and $ v_c $ is the correlation potential. Use the standard Dirac exchange for a three-dimensional electron gas, $ v_x\\left(n\\right) = - \\left(\\frac{3}{\\pi}\\right)^{1/3} \\frac{e^2}{4 \\pi \\varepsilon_0 \\varepsilon_r} n^{1/3} $, and the Perdew–Zunger (Ceperley–Alder) spin-unpolarized high-density correlation in the following piecewise form expressed in effective atomic units:\n- Define the effective Bohr radius $ a_B^\\ast = \\frac{4 \\pi \\varepsilon_0 \\varepsilon_r \\hbar^2}{m^\\ast e^2} $ and the effective Hartree energy $ E_H^\\ast = \\frac{\\hbar^2}{m^\\ast a_B^{\\ast 2}} $. Let the Wigner–Seitz radius be $ r_s = \\left(\\frac{3}{4 \\pi n a_B^{\\ast 3}}\\right)^{1/3} $ (dimensionless).\n- The correlation energy per particle (in units of $E_H^\\ast$) is\n  for $ r_s < 1 $:\n  $ \\varepsilon_c(r_s) = A \\ln r_s + B + C r_s \\ln r_s + D r_s $,\n  with constants $ A = 0.0311 $, $ B = -0.048 $, $ C = 0.0020 $, $ D = -0.0116 $;\n  for $ r_s \\ge 1 $:\n  $ \\varepsilon_c(r_s) = -\\frac{\\alpha}{1 + \\beta_1 \\sqrt{r_s} + \\beta_2 r_s} $,\n  with $ \\alpha = 0.1423 $, $ \\beta_1 = 1.0529 $, $ \\beta_2 = 0.3334 $.\n- The correlation potential (in units of $E_H^\\ast$) is $ v_c(r_s) = \\varepsilon_c(r_s) - \\frac{r_s}{3} \\frac{d \\varepsilon_c}{d r_s} $, and the physical correlation potential is $ v_c(n) = v_c(r_s) E_H^\\ast $.\n\nAssume the effect of $ V_{\\mathrm{xc}}(z) $ on the subband energies can be computed to first order via perturbation theory as $ \\Delta E_n = \\int_0^w |\\psi_n(z)|^2 V_{\\mathrm{xc}}(z) \\, dz $, and define the exchange-correlation-induced change in the spacing between the first and second subbands as $ \\delta \\Delta E_{21} = \\left[E_2^{(0)} + \\Delta E_2 - \\left(E_1^{(0)} + \\Delta E_1\\right)\\right] - \\left(E_2^{(0)} - E_1^{(0)}\\right) = \\Delta E_2 - \\Delta E_1 $.\n\nStarting from the above foundations (Schrödinger quantization in an infinite well, two-dimensional density of states at zero temperature, and the Local Density Approximation with Dirac exchange and Perdew–Zunger correlation), write a program that:\n1. For each test case, determines $ E_F $ by solving $ n_s = \\sum_{n=1}^{N_{\\max}} g_{\\mathrm{2D}} \\max\\left(0, E_F - E_n^{(0)}\\right) $ for a sufficiently large $ N_{\\max} $ such that all contributing subbands are included.\n2. Computes $ n(z) $ on a uniform grid of $ z \\in [0,w] $ using the occupied subbands.\n3. Evaluates $ V_{\\mathrm{xc}}(z) $ on the grid using $ v_x(n(z)) $ and $ v_c(n(z)) $ as specified above.\n4. Computes $ \\Delta E_1 $ and $ \\Delta E_2 $ by numerical integration and outputs $ \\delta \\Delta E_{21} = \\Delta E_2 - \\Delta E_1 $ in electronvolts (eV) as a decimal float.\n\nExpress all final results in electronvolts (eV). The numerical integration must be performed in SI units and then converted to electronvolts at the end. The angle unit is not applicable. No percentages are involved.\n\nTest Suite:\n- Case 1 (happy path): $ m^\\ast/m_e = 0.067 $, $ \\varepsilon_r = 12.9 $, $ w = 10 \\,\\mathrm{nm} $, $ n_s = 3.0 \\times 10^{16} \\,\\mathrm{m^{-2}} $.\n- Case 2 (strong confinement edge): $ m^\\ast/m_e = 0.067 $, $ \\varepsilon_r = 12.9 $, $ w = 5 \\,\\mathrm{nm} $, $ n_s = 5.0 \\times 10^{16} \\,\\mathrm{m^{-2}} $.\n- Case 3 (high sheet density with wider well): $ m^\\ast/m_e = 0.067 $, $ \\varepsilon_r = 12.9 $, $ w = 20 \\,\\mathrm{nm} $, $ n_s = 1.0 \\times 10^{17} \\,\\mathrm{m^{-2}} $.\n- Case 4 (different material parameters): $ m^\\ast/m_e = 0.20 $, $ \\varepsilon_r = 9.5 $, $ w = 40 \\,\\mathrm{nm} $, $ n_s = 1.0 \\times 10^{17} \\,\\mathrm{m^{-2}} $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each \"result$i$\" is the float $ \\delta \\Delta E_{21} $ (in eV) for the corresponding test case.",
            "solution": "The user has provided a valid problem statement. The task is to compute the exchange-correlation induced change in the energy spacing between the first two subbands, $\\delta \\Delta E_{21}$, of a two-dimensional electron gas confined in an infinite quantum well. The calculation is to be performed within the Local Density Approximation (LDA) using first-order perturbation theory. The solution involves a series of computational steps for each set of given material and structural parameters. All calculations are performed in SI units, with the final result converted to electronvolts (eV).\n\nThe fundamental physical constants used in the calculation are the reduced Planck constant $\\hbar$, the electron rest mass $m_e$, the elementary charge $e$, and the vacuum permittivity $\\varepsilon_0$.\n\nThe overall procedure for each test case is as follows:\n\n1.  **Parameter Initialization**: The input parameters for each case are the effective mass ratio $m^\\ast/m_e$, the relative dielectric constant $\\varepsilon_r$, the quantum well width $w$, and the total sheet density $n_s$. From these, we derive the effective mass $m^\\ast = (m^\\ast/m_e) m_e$ and other system-specific constants in SI units.\n\n2.  **Subband Structure and Density of States**: The non-interacting subband energies for an infinite quantum well of width $w$ are given by\n    $$ E_n^{(0)} = \\frac{\\hbar^2 \\pi^2 n^2}{2 m^\\ast w^2} $$\n    for subband index $n=1, 2, 3, \\dots$. The two-dimensional density of states, including spin degeneracy, is constant with energy and is given by\n    $$ g_{\\mathrm{2D}} = \\frac{m^\\ast}{\\pi \\hbar^2} $$\n\n3.  **Determination of Fermi Level and Subband Occupancies**: At zero temperature ($T=0$), all states up to the Fermi energy $E_F$ are occupied. The sheet density of an individual subband $n$ is $n_n = g_{\\mathrm{2D}} (E_F - E_n^{(0)})$ if $E_F > E_n^{(0)}$, and $0$ otherwise. The total sheet density $n_s$ is the sum of individual subband occupancies: $n_s = \\sum_n n_n$.\n    To find the number of occupied subbands, $N_{\\mathrm{occ}}$, and the Fermi energy $E_F$, we can determine $N_{\\mathrm{occ}}$ by finding the integer $k$ for which the target density $n_s$ lies between the density required to populate the $k$-th subband and that required to populate the $(k+1)$-th subband. Let $n_s^{\\mathrm{crit}}(k) = \\sum_{i=1}^{k-1} g_{\\mathrm{2D}}(E_k^{(0)} - E_i^{(0)})$ be the density at which $E_F$ is exactly equal to $E_k^{(0)}$. We find $N_{\\mathrm{occ}}$ such that $n_s^{\\mathrm{crit}}(N_{\\mathrm{occ}}) < n_s \\le n_s^{\\mathrm{crit}}(N_{\\mathrm{occ}}+1)$.\n    Once $N_{\\mathrm{occ}}$ is known, $E_F$ is found by solving the linear equation:\n    $$ n_s = \\sum_{n=1}^{N_{\\mathrm{occ}}} g_{\\mathrm{2D}} (E_F - E_n^{(0)}) \\implies E_F = \\frac{n_s}{N_{\\mathrm{occ}} g_{\\mathrm{2D}}} + \\frac{1}{N_{\\mathrm{occ}}} \\sum_{n=1}^{N_{\\mathrm{occ}}} E_n^{(0)} $$\n    The individual subband occupancies $n_n$ are then calculated for $n = 1, \\dots, N_{\\mathrm{occ}}$.\n\n4.  **Electron Density Profile**: The three-dimensional electron density $n(z)$ along the confinement direction $z \\in [0, w]$ is constructed by summing the contributions from all occupied subbands:\n    $$ n(z) = \\sum_{n=1}^{N_{\\mathrm{occ}}} n_n |\\psi_n(z)|^2 = \\sum_{n=1}^{N_{\\mathrm{occ}}} n_n \\frac{2}{w} \\sin^2\\left(\\frac{n \\pi z}{w}\\right) $$\n    This density is computed on a fine, uniform grid of $z$ points for subsequent numerical calculations.\n\n5.  **Exchange-Correlation Potential**: The LDA potential $V_{\\mathrm{xc}}(z)$ is the sum of exchange $v_x(n(z))$ and correlation $v_c(n(z))$ components, evaluated at each point on the $z$ grid.\n    a.  **Exchange Potential**: The Dirac exchange potential is computed as:\n        $$ v_x(n) = - \\left(\\frac{3}{\\pi}\\right)^{1/3} \\frac{e^2}{4 \\pi \\varepsilon_0 \\varepsilon_r} n^{1/3} $$\n    b.  **Correlation Potential**: The Perdew-Zunger correlation potential requires translation into effective atomic units. The effective Bohr radius $a_B^\\ast$ and Hartree energy $E_H^\\ast$ are computed:\n        $$ a_B^\\ast = \\frac{4 \\pi \\varepsilon_0 \\varepsilon_r \\hbar^2}{m^\\ast e^2} \\quad , \\quad E_H^\\ast = \\frac{\\hbar^2}{m^\\ast (a_B^\\ast)^2} $$\n        For a given density $n(z)$, the dimensionless Wigner-Seitz radius is $r_s(z) = \\left(\\frac{3}{4 \\pi n(z) (a_B^\\ast)^3}\\right)^{1/3}$. The potential $v_c(n)$ is then calculated using the provided piecewise parameterization for the correlation energy $\\varepsilon_c(r_s)$ and its derivative, which gives the dimensionless potential $v_c(r_s) = \\varepsilon_c(r_s) - \\frac{r_s}{3} \\frac{d\\varepsilon_c}{dr_s}$. The physical potential is $v_c(n) = v_c(r_s) E_H^\\ast$. At points where $n(z) = 0$, the potential $V_{\\mathrm{xc}}(z)$ is also $0$.\n\n6.  **Energy Correction Calculation**: The first-order perturbative energy shifts for the first ($n=1$) and second ($n=2$) subbands are calculated by numerically integrating:\n    $$ \\Delta E_n = \\int_0^w |\\psi_n(z)|^2 V_{\\mathrm{xc}}(z) \\, dz = \\int_0^w \\frac{2}{w} \\sin^2\\left(\\frac{n \\pi z}{w}\\right) V_{\\mathrm{xc}}(z) \\, dz $$\n    This integration is performed using Simpson's rule for high accuracy.\n\n7.  **Final Result**: The desired quantity is the change in the subband spacing, $\\delta \\Delta E_{21} = \\Delta E_2 - \\Delta E_1$. This result, calculated in Joules, is converted to electronvolts by dividing by the elementary charge $e$.\n\nThis systematic procedure is implemented in the following Python program to solve for each of the test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import simpson\n\n# Define fundamental physical constants in SI units\nHBAR = 1.054571817e-34      # Reduced Planck constant (J*s)\nM_E = 9.1093837e-31         # Electron rest mass (kg)\nE_CHARGE = 1.602176634e-19  # Elementary charge (C)\nEPSILON_0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n\n# Constants for Perdew-Zunger 1981 correlation (spin-unpolarized)\n# For r_s < 1\nA = 0.0311\nB = -0.048\nC = 0.0020\nD = -0.0116\n# For r_s >= 1\nALPHA = 0.1423\nBETA_1 = 1.0529\nBETA_2 = 0.3334\n\ndef _compute_vc_potential_dimless(rs):\n    \"\"\"\n    Computes the dimensionless correlation potential v_c(r_s) using the\n    Perdew-Zunger parameterization.\n    v_c(r_s) = epsilon_c(r_s) - (r_s/3) * d(epsilon_c)/d(r_s)\n    \"\"\"\n    vc_dimless = np.zeros_like(rs)\n\n    # High-density region (r_s < 1)\n    mask_high_density = rs < 1\n    rs_hd = rs[mask_high_density]\n    if rs_hd.size > 0:\n        ln_rs = np.log(rs_hd)\n        # Simplified expression for v_c(r_s)\n        vc_hd = A * ln_rs + (B - A / 3) + (2 * C / 3) * rs_hd * ln_rs + ((2 * D - C) / 3) * rs_hd\n        vc_dimless[mask_high_density] = vc_hd\n\n    # Low-density region (r_s >= 1)\n    mask_low_density = rs >= 1\n    rs_ld = rs[mask_low_density]\n    if rs_ld.size > 0:\n        sqrt_rs = np.sqrt(rs_ld)\n        denominator = 1 + BETA_1 * sqrt_rs + BETA_2 * rs_ld\n        # Simplified expression for v_c(r_s)\n        numerator = ALPHA * (1 + (7/6) * BETA_1 * sqrt_rs + (4/3) * BETA_2 * rs_ld)\n        vc_ld = -numerator / (denominator**2)\n        vc_dimless[mask_low_density] = vc_ld\n        \n    return vc_dimless\n\ndef _calculate_xc_potential(n_z, m_star, eps_r):\n    \"\"\"\n    Calculates the exchange-correlation potential V_xc(z) on a grid.\n    \"\"\"\n    # Create mask for non-zero density regions to avoid division by zero\n    non_zero_mask = n_z > 0\n    v_xc_z = np.zeros_like(n_z)\n    \n    if not np.any(non_zero_mask):\n        return v_xc_z\n\n    n_vals = n_z[non_zero_mask]\n\n    # Exchange potential (v_x)\n    vx_coeff = -(3 / np.pi)**(1/3) * E_CHARGE**2 / (4 * np.pi * EPSILON_0 * eps_r)\n    v_x = vx_coeff * n_vals**(1/3)\n\n    # Correlation potential (v_c)\n    # Effective atomic units\n    a_B_star = (4 * np.pi * EPSILON_0 * eps_r * HBAR**2) / (m_star * E_CHARGE**2)\n    E_H_star = HBAR**2 / (m_star * a_B_star**2)\n\n    # Wigner-Seitz radius\n    rs = (3 / (4 * np.pi * n_vals * a_B_star**3))**(1/3)\n    \n    vc_dimless = _compute_vc_potential_dimless(rs)\n    v_c = vc_dimless * E_H_star\n    \n    v_xc_z[non_zero_mask] = v_x + v_c\n    return v_xc_z\n\ndef calculate_delta_E21(m_star_ratio, eps_r, w_nm, ns_m2):\n    \"\"\"\n    Performs the full calculation for a single test case.\n    \"\"\"\n    # 1. Parameter Initialization (convert to SI)\n    m_star = m_star_ratio * M_E\n    w = w_nm * 1e-9\n\n    # 2. Subband Structure and DOS\n    g_2d = m_star / (np.pi * HBAR**2)\n    E0_coeff = (HBAR**2 * np.pi**2) / (2 * m_star * w**2)\n    \n    N_MAX = 50  # Max subband index to consider\n    subband_indices = np.arange(1, N_MAX + 1)\n    E_n_0 = E0_coeff * subband_indices**2\n\n    # 3. Determine N_occ and E_F\n    N_occ = 0\n    # n_s_crit(k) is the density when E_F = E_k^0\n    n_s_crit = np.zeros(N_MAX + 1) # n_s_crit[k] corresponds to k\n    for k in range(2, N_MAX + 1):\n        i_vals = np.arange(1, k)\n        n_s_crit[k] = np.sum(g_2d * (E_n_0[k-1] - E_n_0[i_vals-1]))\n\n    for k in range(1, N_MAX):\n        if ns_m2 > n_s_crit[k] and ns_m2 <= n_s_crit[k+1]:\n            N_occ = k\n            break\n    if N_occ == 0: # Case where ns > n_s_crit[N_MAX]\n         N_occ = N_MAX # This should cover all subbands up to N_MAX\n    \n    E_n_0_occupied = E_n_0[:N_occ]\n    E_F = (ns_m2 / (N_occ * g_2d)) + np.mean(E_n_0_occupied)\n\n    # 4. Calculate Subband Occupancies\n    n_subbands = g_2d * (E_F - E_n_0_occupied)\n\n    # 5. Electron Density Profile n(z)\n    NUM_Z_POINTS = 1001\n    z_grid = np.linspace(0, w, NUM_Z_POINTS)\n    n_z = np.zeros_like(z_grid)\n    for i in range(N_occ):\n        n = i + 1\n        psi_n_sq = (2 / w) * np.sin(n * np.pi * z_grid / w)**2\n        n_z += n_subbands[i] * psi_n_sq\n\n    # 6. Exchange-Correlation Potential V_xc(z)\n    v_xc_z = _calculate_xc_potential(n_z, m_star, eps_r)\n\n    # 7. Energy Corrections Delta_E1 and Delta_E2\n    psi1_sq = (2 / w) * np.sin(1 * np.pi * z_grid / w)**2\n    integrand1 = psi1_sq * v_xc_z\n    delta_E1 = simpson(integrand1, z_grid)\n    \n    psi2_sq = (2 / w) * np.sin(2 * np.pi * z_grid / w)**2\n    integrand2 = psi2_sq * v_xc_z\n    delta_E2 = simpson(integrand2, z_grid)\n\n    # 8. Final Result\n    delta_E21_J = delta_E2 - delta_E1\n    delta_E21_eV = delta_E21_J / E_CHARGE\n    \n    return delta_E21_eV\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (m*/m_e, eps_r, w [nm], n_s [m^-2])\n        (0.067, 12.9, 10.0, 3.0e16),\n        (0.067, 12.9, 5.0, 5.0e16),\n        (0.067, 12.9, 20.0, 1.0e17),\n        (0.20, 9.5, 40.0, 1.0e17),\n    ]\n\n    results = []\n    for case in test_cases:\n        m_star_ratio, eps_r, w_nm, ns_m2 = case\n        result = calculate_delta_E21(m_star_ratio, eps_r, w_nm, ns_m2)\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}