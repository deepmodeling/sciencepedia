{
    "hands_on_practices": [
        {
            "introduction": "要理解双层石墨烯独特的电子性质，我们通常从一个多带紧束缚模型入手。这项实践将指导您掌握一项关键技能：从一个复杂的哈密顿量中推导出简化的低能有效哈密顿量 。掌握这一过程将揭示抛物线形能带结构的起源以及有效质量的概念，这是描述该材料中电荷输运的基础。",
            "id": "4265019",
            "problem": "考虑在没有层间偏压（“无偏压双层”）的情况下，伯纳尔堆叠的双层石墨烯。在狄拉克点 $\\mathbf{K}$ 附近，只考虑最近邻层内跳跃和主导的层间二聚体耦合的最小连续紧束缚模型，在子晶格基 $(\\psi_{A1}, \\psi_{B1}, \\psi_{A2}, \\psi_{B2})$ 下可以写成 $4 \\times 4$ 的哈密顿量：\n$$\nH(\\mathbf{p})=\\begin{pmatrix}\n0  v_{F}\\,\\pi^{\\dagger}  0  0 \\\\\nv_{F}\\,\\pi  0  \\gamma_{1}  0 \\\\\n0  \\gamma_{1}  0  v_{F}\\,\\pi^{\\dagger} \\\\\n0  0  v_{F}\\,\\pi  0\n\\end{pmatrix},\n$$\n其中 $\\pi=p_{x}+\\mathrm{i}p_{y}$，$\\mathbf{p}=(p_{x},p_{y})$ 是从 $\\mathbf{K}$ 点测量的晶格动量，$v_{F}$ 是单层石墨烯的费米速度，而 $\\gamma_{1}$ 是伯纳尔堆叠（二聚体）位点之间的层间耦合能。假设处于低能极限 $|E|\\ll \\gamma_{1}$，并忽略斜向层间跳跃和三角翘曲，仅关注 $H(\\mathbf{p})$ 中捕获的主导过程。\n\n从这个哈密顿量出发，使用受控的低能约化方法（例如，Löwdin划分或Schrieffer–Wolff变换）将其约化到非二聚体子空间 $(A_{1}, B_{2})$，推导出有效双带哈密顿量以及在无偏压双层中相应的低能色散关系 $E(\\mathbf{p})$。从该色散关系中，根据 $\\gamma_{1}$ 和 $v_{F}$ 确定载流子的各向同性有效质量 $m^{*}$。\n\n最后，使用典型参数 $v_{F}=1.0\\times 10^{6}\\ \\mathrm{m/s}$ 和 $\\gamma_{1}=0.39\\ \\mathrm{eV}$ 数值计算 $m^{*}$，取 $1\\ \\mathrm{eV}=1.602176634\\times 10^{-19}\\ \\mathrm{J}$，并将您的最终结果以千克表示。将答案四舍五入到四位有效数字。",
            "solution": "该问题要求从给定的 $4\\times 4$ 紧束缚哈密顿量出发，为无偏压伯纳尔堆叠双层石墨烯中的电荷载流子推导低能有效哈密顿量、能量色散关系和有效质量，并计算有效质量的数值。\n\n### 步骤1：验证与策略\n该问题科学上是合理的。它提出了一个凝聚态物理中标准的练习：通过下叠法（downfolding）从一个多带哈密顿量推导一个低能有效模型。给定的哈密顿量是描述伯纳尔堆叠双层石墨烯在狄拉克点附近的最小模型的标准形式。任务是清晰的，所有参数都有定义。\n\n### 步骤2：推导有效哈密顿量\n薛定谔方程为 $H(\\mathbf{p})\\Psi = E\\Psi$，其中 $\\Psi = (\\psi_{A1}, \\psi_{B1}, \\psi_{A2}, \\psi_{B2})^T$。我们的目标是找到一个有效的 $2\\times 2$ 哈密顿量 $H_{eff}$，它只作用于非二聚体位点 $(A_1, B_2)$ 的子空间。这些位点构成了低能自由度。剩下的二聚体位点 $(B_1, A_2)$ 被大能量尺度的 $\\gamma_1$ 直接耦合，构成了高能子空间。我们可以使用Löwdin划分来推导 $H_{eff}$。\n\n首先，我们通过将基矢重排为低能子空间 $L = (A_1, B_2)$ 和高能子空间 $H = (B_1, A_2)$ 来划分哈密顿量。置换后的基为 $(\\psi_{A1}, \\psi_{B2}, \\psi_{B1}, \\psi_{A2})$。重新排列后的哈密顿量 $H'$ 形式为：\n$$H' = \\begin{pmatrix} H_{LL}  H_{LH} \\\\ H_{HL}  H_{HH} \\end{pmatrix}$$\n根据原始 $H$ 和重排后的基，我们确定各个块：\n$H_{LL} = \\begin{pmatrix} H_{11}  H_{14} \\\\ H_{41}  H_{44} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$\n$H_{HH} = \\begin{pmatrix} H_{22}  H_{23} \\\\ H_{32}  H_{33} \\end{pmatrix} = \\begin{pmatrix} 0  \\gamma_1 \\\\ \\gamma_1  0 \\end{pmatrix}$\n$H_{LH} = \\begin{pmatrix} H_{12}  H_{13} \\\\ H_{42}  H_{43} \\end{pmatrix} = \\begin{pmatrix} v_F\\pi^\\dagger  0 \\\\ 0  v_F\\pi \\end{pmatrix}$\n$H_{HL} = \\begin{pmatrix} H_{21}  H_{24} \\\\ H_{31}  H_{34} \\end{pmatrix} = \\begin{pmatrix} v_F\\pi  0 \\\\ 0  v_F\\pi^\\dagger \\end{pmatrix}$\n我们可以验证 $H_{HL} = H_{LH}^\\dagger$，这是厄米哈密顿量的要求。\n\n低能子空间的精确有效哈密顿量由Löwdin公式给出：\n$$H_{eff}(E) = H_{LL} + H_{LH} (E \\cdot I - H_{HH})^{-1} H_{HL}$$\n在低能极限 $|E| \\ll \\gamma_1$ 下，我们可以近似 $E \\cdot I - H_{HH} \\approx - H_{HH}$。有效哈密顿量变为：\n$$H_{eff} \\approx H_{LL} - H_{LH} (H_{HH})^{-1} H_{HL}$$\n由于 $H_{LL}=0$，我们只需要计算第二项。首先，我们求 $H_{HH}$ 的逆：\n$$(H_{HH})^{-1} = \\begin{pmatrix} 0  \\gamma_1 \\\\ \\gamma_1  0 \\end{pmatrix}^{-1} = \\frac{1}{-\\gamma_1^2} \\begin{pmatrix} 0  -\\gamma_1 \\\\ -\\gamma_1  0 \\end{pmatrix} = \\frac{1}{\\gamma_1} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$$\n现在，我们计算完整的乘积：\n$$-H_{LH} (H_{HH})^{-1} H_{HL} = - \\begin{pmatrix} v_F\\pi^\\dagger  0 \\\\ 0  v_F\\pi \\end{pmatrix} \\left( \\frac{1}{\\gamma_1} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\right) \\begin{pmatrix} v_F\\pi  0 \\\\ 0  v_F\\pi^\\dagger \\end{pmatrix}$$\n$$= -\\frac{1}{\\gamma_1} \\begin{pmatrix} 0  v_F\\pi^\\dagger \\\\ v_F\\pi  0 \\end{pmatrix} \\begin{pmatrix} v_F\\pi  0 \\\\ 0  v_F\\pi^\\dagger \\end{pmatrix} = -\\frac{v_F^2}{\\gamma_1} \\begin{pmatrix} 0  (\\pi^\\dagger)^2 \\\\ \\pi^2  0 \\end{pmatrix}$$\n这就是为非二聚体子空间 $(A_1, B_2)$ 推导出的有效双带哈密顿量。\n\n### 步骤3：推导色散关系和有效质量\n接下来，我们通过计算 $H_{eff}$ 的本征值来找到能量色散关系 $E(\\mathbf{p})$。特征方程为 $\\det(H_{eff} - E \\cdot I) = 0$：\n$$\\begin{vmatrix} -E  -\\frac{v_F^2}{\\gamma_1}(\\pi^\\dagger)^2 \\\\ -\\frac{v_F^2}{\\gamma_1}\\pi^2  -E \\end{vmatrix} = 0$$\n$$E^2 - \\left(-\\frac{v_F^2}{\\gamma_1}(\\pi^\\dagger)^2\\right) \\left(-\\frac{v_F^2}{\\gamma_1}\\pi^2\\right) = 0 \\implies E^2 = \\frac{v_F^4}{\\gamma_1^2} (\\pi^\\dagger)^2 \\pi^2$$\n我们使用 $\\pi=p_x+\\mathrm{i}p_y$ 和 $\\pi^\\dagger=p_x-\\mathrm{i}p_y$。由于动量分量 $p_x$ 和 $p_y$ 是c数，它们对易，因此 $\\pi^\\dagger \\pi = \\pi \\pi^\\dagger = p_x^2+p_y^2=p^2$。所以 $(\\pi^\\dagger)^2 \\pi^2 = (\\pi^\\dagger \\pi)^2 = (p^2)^2 = p^4$。\n代入 $E^2$ 的方程：\n$$E^2 = \\frac{v_F^4 p^4}{\\gamma_1^2}$$\n取平方根得到低能色散关系：\n$$E(\\mathbf{p}) = \\pm \\frac{v_F^2 p^2}{\\gamma_1}$$\n这表明无偏压双层石墨烯中的低能载流子具有抛物线色散关系。\n\n最后的符号任务是找到有效质量 $m^*$。对于一个具有各向同性抛物线色散的非相对论性粒子，其能量-动量关系由 $E(p) = \\frac{p^2}{2m^*}$ 给出。我们考虑导带（正能量）：\n$$\\frac{p^2}{2m^*} = \\frac{v_F^2 p^2}{\\gamma_1}$$\n通过比较 $p^2$ 的系数，我们发现：\n$$\\frac{1}{2m^*} = \\frac{v_F^2}{\\gamma_1} \\implies m^* = \\frac{\\gamma_1}{2 v_F^2}$$\n这是各向同性有效质量的解析表达式。\n\n### 步骤4：数值计算\n最后，我们使用给定的参数数值计算 $m^*$。\n- $\\gamma_1 = 0.39\\ \\mathrm{eV} = 0.39 \\times (1.602176634\\times 10^{-19}\\ \\mathrm{J}) = 6.2484888726 \\times 10^{-20}\\ \\mathrm{J}$\n- $v_F = 1.0\\times 10^{6}\\ \\mathrm{m/s}$\n代入 $m^*$ 的表达式中：\n$$m^* = \\frac{6.2484888726 \\times 10^{-20}\\ \\mathrm{J}}{2 \\times (1.0\\times 10^{6}\\ \\mathrm{m/s})^2} = \\frac{6.2484888726 \\times 10^{-20}}{2 \\times 1.0 \\times 10^{12}}\\ \\mathrm{kg}$$\n$$m^* = 3.1242444363 \\times 10^{-32}\\ \\mathrm{kg}$$\n按要求将结果四舍五入到四位有效数字：\n$$m^* \\approx 3.124 \\times 10^{-32}\\ \\mathrm{kg}$$",
            "answer": "$$\\boxed{3.124 \\times 10^{-32}}$$"
        },
        {
            "introduction": "材料的能带结构如何体现在其电学输运特性中？本练习通过应用 Landauer-Büttiker 公式的思想来计算双层石墨烯的最小电导率，从而探讨了这个问题 。通过将结果与单层石墨烯进行比较，您将更深刻地理解抛物线色散关系如何导致独特的量子输运特征，特别是最小电导率的加倍。",
            "id": "4264967",
            "problem": "考虑一个洁净的、弹道输运的石墨烯器件，该器件由一个长度为 $L$、宽度为 $W$ 的矩形非掺杂沟道组成，其两侧与作为理想模式注入器和吸收器的重掺杂石墨烯电极相接触。假设在横向 ($y$) 方向上采用周期性边界条件，因此横向动量 $q$ 是守恒的。在电荷中性点 ($E=0$) 进行计算。\n\n从 Landauer–Büttiker 形式论以及在单谷点下 (i) 具有线性（Dirac）色散的单层石墨烯和 (ii) 在双带近似下具有抛物线色散的无偏压伯纳尔 (AB) 堆叠双层石墨烯的低能连续哈密顿量出发，完成以下任务：\n\n- 对于单层石墨烯，使用无质量狄拉克哈密顿量 $H_{\\text{M}}=\\hbar v_{F}(\\sigma_{x}p_{x}+\\sigma_{y}p_{y})$，其中 $v_{F}$ 是费米速度，$\\sigma_{x}$ 和 $\\sigma_{y}$ 是泡利矩阵，$p_{x}=-\\mathrm{i}\\hbar\\,\\partial_{x}$，$p_{y}=\\hbar q$。推导通过非掺杂沟道的零能、模式分辨的透射概率 $T_{\\text{M}}(q)$，并通过将模式求和转换为连续积分，在 $W \\gg L$ 的极限下计算最小电导率 $\\sigma_{\\text{M}}$。考虑自旋和谷简并度 $g_{s}=2$, $g_{v}=2$。\n\n- 对于无偏压 AB 双层石墨烯，使用低能双带哈密顿量 $H_{\\text{B}}=-\\frac{1}{2m^{\\ast}}\\begin{pmatrix}0  (\\pi^{\\dagger})^{2}\\\\ \\pi^{2}  0\\end{pmatrix}$，其中 $\\pi=p_{x}+\\mathrm{i}p_{y}$，$\\pi^{\\dagger}=p_{x}-\\mathrm{i}p_{y}$，$m^{\\ast}=\\gamma_{1}/(2v_{F}^{2})$ 是有效质量，$\\gamma_{1}$ 是主要的层间跳跃。在 $E=0$ 时，推导出一组独立的、模式分辨的透射概率 $\\{T_{\\text{B},m}(q)\\}$，并在相同的 $W \\gg L$ 极限下计算最小电导率 $\\sigma_{\\text{B}}$。\n\n讨论双层石墨烯中的抛物线色散与单层石墨烯相比，如何导致倏逝输运通道的多重性不同，并指出这种差异在推导中出现的具体位置。\n\n你的最终任务是提供单一的无量纲比值\n$$\nR=\\frac{\\sigma_{\\text{B}}}{\\sigma_{\\text{M}}}.\n$$\n不需要四舍五入。将最终答案表示为精确的实数 $R$。",
            "solution": "此问题要求使用 Landauer-Büttiker 形式论计算和比较单层石墨烯和无偏压双层石墨烯的最小电导率。分析在电荷中性点 $E=0$ 进行。\n\n首先，我们分析单层石墨烯（MLG）的情况。单谷的低能哈密顿量由 $H_{\\text{M}}=\\hbar v_{F}(\\sigma_{x}p_{x}+\\sigma_{y}p_{y})$ 给出。我们关心的是长度为 $L$ 的非掺杂沟道在零能量 $E=0$ 时的输运性质。动量算符为 $p_{x}=-\\mathrm{i}\\hbar\\,\\partial_{x}$ 和 $p_{y}=\\hbar q$，其中 $q$ 是守恒的横向动量。对于双分量旋量波函数 $\\psi(x,y) = e^{iqy} (\\psi_A(x), \\psi_B(x))^T$，不含时 Schrödinger 方程 $H_{\\text{M}}\\psi = E\\psi$ 变为 $H_{\\text{M}}\\psi=0$。以矩阵形式表示：\n$$\n\\hbar v_F \\begin{pmatrix} 0  p_x - i p_y \\\\ p_x + i p_y  0 \\end{pmatrix} \\begin{pmatrix} \\psi_A(x) \\\\ \\psi_B(x) \\end{pmatrix} = 0\n$$\n代入动量算符，我们得到一个一阶微分方程组：\n$$\n(-i\\hbar\\partial_x - i\\hbar q) \\psi_B(x) = 0 \\implies (\\partial_x + q) \\psi_B(x) = 0\n$$\n$$\n(-i\\hbar\\partial_x + i\\hbar q) \\psi_A(x) = 0 \\implies (\\partial_x - q) \\psi_A(x) = 0\n$$\n这些方程的解为 $\\psi_A(x) = c_A e^{qx}$ 和 $\\psi_B(x) = c_B e^{-qx}$。这些解描述了沟道内的倏逝模式，因为它们沿输运方向 $x$ 的波矢是纯虚数，$k_x = \\pm iq$。对于有限长度 $L$ 的沟道，这些倏逝模式允许量子隧穿。对于给定的模式 $q$，通过长度为 $L$ 的沟道在 $E=0$ 时的透射概率 $T_{\\text{M}}(q)$ 是一个标准结果：\n$$\nT_{\\text{M}}(q) = \\frac{1}{\\cosh^2(qL)}\n$$\n总电导 $G_{\\text{M}}$ 是通过 Landauer-Büttiker 公式对所有横向模式的贡献求和得到的，包括自旋（$g_s=2$）和谷（$g_v=2$）简并度：\n$$\nG_{\\text{M}} = g_s g_v \\frac{e^2}{h} \\sum_q T_{\\text{M}}(q) = \\frac{4e^2}{h} \\sum_q \\frac{1}{\\cosh^2(qL)}\n$$\n在指定的 $W \\gg L$ 极限下，对模式的离散求和可以被连续积分替换：$\\sum_q \\to \\frac{W}{2\\pi} \\int_{-\\infty}^{\\infty} dq$。\n$$\nG_{\\text{M}} = \\frac{4e^2}{h} \\frac{W}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{\\cosh^2(qL)} dq\n$$\n我们计算这个定积分。令 $u=qL$，则 $dq = du/L$：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{\\cosh^2(qL)} dq = \\frac{1}{L} \\int_{-\\infty}^{\\infty} \\text{sech}^2(u) du = \\frac{1}{L} [\\tanh(u)]_{-\\infty}^{\\infty} = \\frac{2}{L}\n$$\n将此结果代回电导的表达式中，得到：\n$$\nG_{\\text{M}} = \\frac{4e^2}{h} \\frac{W}{2\\pi} \\frac{2}{L} = \\frac{4e^2 W}{\\pi h L}\n$$\n二维电导率 $\\sigma$ 与电导的关系为 $G = \\sigma \\frac{W}{L}$。因此，单层石墨烯的最小电导率为：\n$$\n\\sigma_{\\text{M}} = \\frac{4e^2}{\\pi h}\n$$\n\n接下来，我们分析无偏压伯纳尔堆叠双层石墨烯（BLG）的情况。低能哈密顿量为 $H_{\\text{B}}=-\\frac{1}{2m^{\\ast}}\\begin{pmatrix}0  (\\pi^{\\dagger})^{2}\\\\ \\pi^{2}  0\\end{pmatrix}$，其中 $\\pi = p_x + ip_y$。在 $E=0$ 时，Schrödinger 方程 $H_{\\text{B}}\\psi=0$ 得出：\n$$\n(\\pi^\\dagger)^2 \\psi_B(x) = (p_x - ip_y)^2 \\psi_B(x) = (-i\\hbar\\partial_x + \\hbar q)^2 \\psi_B(x) = 0 \\implies (\\partial_x - q)^2 \\psi_B(x) = 0\n$$\n$$\n\\pi^2 \\psi_A(x) = (p_x + ip_y)^2 \\psi_A(x) = (-i\\hbar\\partial_x - \\hbar q)^2 \\psi_A(x) = 0 \\implies (\\partial_x + q)^2 \\psi_A(x) = 0\n$$\n这些是二阶常微分方程。这导致对于每个横向动量 $q$，沟道中有四个倏逝模式。这是与单层石墨烯情况的关键区别。对于MLG，线性色散关系导致特征方程为二阶，给出两个倏逝模式。对于BLG，抛物线色散关系导致特征方程为四阶，给出四种倏逝模式（两个二重简并的根）。这种根的更高多重性是倏逝输运通道数量增加的根源。\n\n更详细的分析表明，在 $E=0$ 时 BLG 的散射问题可以解耦为两个独立的通道，每个通道的行为都与单个 MLG 通道完全相同。因此，对于每个横向动量 $q$，有两个独立的透射概率 $\\{T_{\\text{B},m}(q)\\}$：\n$$\nT_{\\text{B},1}(q) = \\frac{1}{\\cosh^2(qL)} \\quad \\text{和} \\quad T_{\\text{B},2}(q) = \\frac{1}{\\cosh^2(qL)}\n$$\nBLG 的总电导 $G_{\\text{B}}$ 是通过对所有模式的这两个通道求和得到的：\n$$\nG_{\\text{B}} = g_s g_v \\frac{e^2}{h} \\sum_q (T_{\\text{B},1}(q) + T_{\\text{B},2}(q)) = 2 \\left( \\frac{4e^2}{h} \\sum_q \\frac{1}{\\cosh^2(qL)} \\right) = 2 G_{\\text{M}}\n$$\n使用我们先前推导出的 $G_{\\text{M}}$ 的结果：\n$$\nG_{\\text{B}} = 2 \\left( \\frac{4e^2 W}{\\pi h L} \\right) = \\frac{8e^2 W}{\\pi h L}\n$$\n因此，双层石墨烯的最小电导率 $\\sigma_{\\text{B}}$ 为：\n$$\n\\sigma_{\\text{B}} = G_{\\text{B}} \\frac{L}{W} = \\frac{8e^2}{\\pi h}\n$$\n\n最后，我们计算所需的无量纲比值 $R$：\n$$\nR = \\frac{\\sigma_{\\text{B}}}{\\sigma_{\\text{M}}} = \\frac{8e^2/(\\pi h)}{4e^2/(\\pi h)} = 2\n$$\n无偏压双层石墨烯的最小电导率恰好是单层石墨烯的两倍。这个因子 $2$ 是输运通道加倍的直接结果，而通道加倍本身源于抛物线型（而非线性）的能量-动量色散关系。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "真实的电子器件从来都不是完美无瑕的，并且通常在有感生带隙的情况下工作。这项高级实践将挑战您建立一个自洽的计算模型，以量化带隙双层石墨烯中带电杂质无序的影响 。通过实现 Thomas-Fermi 屏蔽理论，您将模拟电子-空穴“水坑”的形成，并计算由此产生的残余载流子浓度，这是衡量器件性能的一个关键指标。",
            "id": "4264924",
            "problem": "你需要实现一个针对有能隙双层石墨烯的自洽托马斯-费米屏蔽模型。其目标是量化带电杂质的随机分布如何产生局域势能涨落，并在电荷中性点通过电子和空穴“水坑”产生非零的残余载流子密度。你必须从第一性原理出发，并使用经过充分检验的关系式，而不引用任何目标公式。你的程序必须为每个提供的测试用例计算电荷中性点处的残余载流子密度（单位为 $\\mathrm{m}^{-2}$），并将所有结果汇总到最后指定的一行中。\n\n假设与基本出发点：\n- 考虑一个二维电子系统，其具有抛物线型的低能能带和一个可调带隙（双层石墨烯）。面密度为 $n_{\\mathrm{imp}}$ 的杂质随机分布在双层石墨烯平面上方距离为 $d$ 的位置。将衬底和环境视为均匀介电材料，其相对介电常数为 $\\varepsilon_{r}$，因此绝对介电常数为 $\\varepsilon = \\varepsilon_{r} \\varepsilon_{0}$。\n- 在二维空间中，点电荷的傅里叶变换裸库仑相互作用与 $1/q$ 成正比，而在托马斯-费米近似下的静态线性响应屏蔽将 $q$ 替换为 $q + q_{\\mathrm{TF}}$，其中 $q_{\\mathrm{TF}}$ 是托马斯-费米屏蔽波数。\n- 泊松方程将电荷与电势联系起来，而托马斯-费米关系通过热力学态密度将感应电荷密度与局域电化学势联系起来。\n- 在零温下，二维抛物线能带的态密度在能带内的能量区间是常数，在带隙内为零。对于双层石墨烯，取自旋简并度 $g_{s} = 2$ 和能谷简并度 $g_{v} = 2$。有效质量 $m^{\\star}$ 给出单位面积和单位能量下的常数态密度为 $D_{0} = \\dfrac{g_{s} g_{v} m^{\\star}}{2 \\pi \\hbar^{2}}$。\n\n在你的推导和计算中使用的定义：\n- 令 $U(\\mathbf{r})$ 表示在位置 $\\mathbf{r}$ 处由杂质引起的电子能带的局域势能移动，单位为焦耳。其傅里叶变换 $U(\\mathbf{q})$ 是由单位杂质电荷产生的屏蔽相互作用，乘以电荷大小 $e$（元电荷），并由由于有限的杂质-双层石墨烯距离 $d$ 产生的指数形式的形状因子 $e^{- q d}$ 进行修正。\n- 在傅里叶空间中，于静态托马斯-费米屏蔽下，单个杂质引起的势能形式为 $U(\\mathbf{q}) \\propto \\dfrac{1}{q + q_{\\mathrm{TF}}}$；由面密度为 $n_{\\mathrm{imp}}$ 的不相关杂质随机分布产生的总能量涨落谱是非相干叠加的。能量涨落的均方根 (RMS) $U_{\\mathrm{rms}}$ 是通过对所有 $\\mathbf{q}$ 的涨落功率谱密度进行积分得到的。\n- 屏蔽波数遵循 $q_{\\mathrm{TF}} = \\dfrac{2 \\pi e^{2}}{\\varepsilon} D_{\\mathrm{eff}}$，其中 $D_{\\mathrm{eff}}$ 是参与屏蔽的费米能级处的有效（空间平均的）热力学态密度。在有能隙系统的电荷中性点，只有局域 $|U(\\mathbf{r})|$ 超过带隙一半的区域才会贡献载流子；在其他地方 $D_{\\mathrm{eff}}$ 受到抑制。\n\n目标量：\n- 此处定义的电荷中性点处的残余载流子密度是，在存在带隙的情况下，由杂质引起的势能生成的局域载流子密度大小在空间上的平均值。在零温下，对于总宽度为 $E_{g}$ 的带隙中的导带，局域载流子出现在 $|U(\\mathbf{r})|  E_{g}/2$ 的地方。在这些区域，局域载流子密度大小等于 $D_{0}$ 乘以超出 $E_{g}/2$ 的能量。因此，如果假设 $U$ 的分布是均值为零、方差为 $\\sigma^{2}$ 的高斯分布，则残余密度为期望值 $\\langle n \\rangle = D_{0} \\, \\mathbb{E}\\!\\left[ \\left( |U| - E_{g}/2 \\right)_{+} \\right]$，其中 $(x)_{+} = \\max(x, 0)$。\n\n自洽性要求：\n- 进入 $q_{\\mathrm{TF}}$ 的有效态密度 $D_{\\mathrm{eff}}$ 取决于拥有载流子的面积分数，而该面积分数又取决于能量涨落的均方根 $\\sigma$。你必须自洽地整合这种反馈。使用以下逻辑结构：\n    1. 对于给定的 $q_{\\mathrm{TF}}$，通过对屏蔽杂质谱在波矢上积分来计算能量涨落的均方根 $\\sigma = U_{\\mathrm{rms}}$。由于有限的系统尺寸 $L$，施加一个具有物理动机的红外截止 $q_{\\min} = 1/L$，以避免在 $q \\to 0$ 时出现非物理的发散。\n    2. 根据对 $U$ 的高斯假设，计算 $|U|  E_{g}/2$ 的面积分数 $p$。更新 $D_{\\mathrm{eff}} = p \\, D_{0}$，从而更新 $q_{\\mathrm{TF}}$。\n    3. 迭代直至 $q_{\\mathrm{TF}}$ 和 $\\sigma$ 收敛。\n    4. 使用收敛后的 $\\sigma$，根据上面给出的高斯期望值计算残余载流子密度 $\\langle n \\rangle$。\n- 你必须将所有能量表示为焦耳，波数表示为 $\\mathrm{m}^{-1}$，密度表示为 $\\mathrm{m}^{-2}$。\n\n数值积分和常数：\n- 在对波数 $q$ 积分时，通过对二维 $\\mathbf{q}$ 空间的涨落功率积分来写出均方根能量；使用傅里叶空间中的屏蔽相互作用和杂质形状因子。通过截止值 $q_{\\min} = 1/L$ 和上限 $q \\to \\infty$ 确保数值稳定性。\n- 使用 $e$ 表示元电荷，$\\varepsilon_{0}$ 表示真空介电常数，$\\hbar$ 表示约化普朗克常数。取 $m^{\\star} = 0.033 \\, m_{e}$，其中 $m_{e}$ 是电子静止质量。\n\n测试组：\n- 对于每个测试用例，参数为 $(n_{\\mathrm{imp}}, d, \\varepsilon_{r}, E_{g}, L)$，单位如下：\n    - $n_{\\mathrm{imp}}$ 单位为 $\\mathrm{m}^{-2}$，\n    - $d$ 单位为 $\\mathrm{m}$，\n    - $\\varepsilon_{r}$ 无单位，\n    - $E_{g}$ 单位为电子伏特（在你的程序中转换为焦耳），\n    - $L$ 单位为 $\\mathrm{m}$。\n- 对所有测试用例，使用 $g_{s} = 2$，$g_{v} = 2$，以及 $m^{\\star} = 0.033 \\, m_{e}$。\n\n提供以下参数集测试组：\n- 用例 1：$(n_{\\mathrm{imp}} = 1.0 \\times 10^{15}, \\, d = 1.0 \\times 10^{-9}, \\, \\varepsilon_{r} = 4.0, \\, E_{g} = 0.10, \\, L = 1.0 \\times 10^{-6})$。\n- 用例 2：$(n_{\\mathrm{imp}} = 5.0 \\times 10^{15}, \\, d = 1.0 \\times 10^{-9}, \\, \\varepsilon_{r} = 4.0, \\, E_{g} = 0.010, \\, L = 2.0 \\times 10^{-6})$。\n- 用例 3：$(n_{\\mathrm{imp}} = 1.0 \\times 10^{15}, \\, d = 2.0 \\times 10^{-9}, \\, \\varepsilon_{r} = 10.0, \\, E_{g} = 0.30, \\, L = 5.0 \\times 10^{-6})$。\n- 用例 4：$(n_{\\mathrm{imp}} = 1.0 \\times 10^{16}, \\, d = 0.5 \\times 10^{-9}, \\, \\varepsilon_{r} = 2.5, \\, E_{g} = 0.050, \\, L = 1.0 \\times 10^{-6})$。\n\n你的程序必须：\n- 实现上述的自洽过程。\n- 对每个测试用例，计算电荷中性点处的残余载流子密度 $\\langle n \\rangle$（单位为 $\\mathrm{m}^{-2}$），结果为浮点数。\n- 生成单行输出，包含所有测试用例的结果，形式为逗号分隔的列表，并用方括号括起，例如 $\\,[x_{1}, x_{2}, x_{3}, x_{4}]\\,,$ 其中每个 $x_{i}$ 是残余密度，单位为 $\\mathrm{m}^{-2}$。\n\n不需要用户输入；所有参数均按上述规定固定。",
            "solution": "该问题是有效的，它科学地基于凝聚态物理的原理，问题设定良好，具有明确的目标和一组独立的参数。因此，我们可以着手提供完整的解决方案。\n\n目标是计算在电荷中性点时，有能隙双层石墨烯中的残余载流子密度 $\\langle n \\rangle$。该密度源于由随机分布的带电杂质引起的势能涨落。这需要一个自洽的托马斯-费米屏蔽模型。\n\n**1. 基本量与定义**\n\n首先，我们定义基本的物理常数和系统特定参数。所有量都将以国际单位制（SI）表示。\n- 元电荷：$e$\n- 约化普朗克常数：$\\hbar$\n- 电子静止质量：$m_e$\n- 真空介电常数：$\\varepsilon_0$\n- 自旋简并度：$g_s = 2$\n- 能谷简并度：$g_v = 2$\n- 双层石墨烯中的有效质量：$m^{\\star} = 0.033 \\, m_e$\n每个用例的输入参数是杂质密度 $n_{\\mathrm{imp}}$、杂质-平面距离 $d$、相对介电常数 $\\varepsilon_r$、带隙能量 $E_g$（以 eV 给出，需转换为焦耳）和系统尺寸 $L$。介质的绝对介电常数为 $\\varepsilon = \\varepsilon_r \\varepsilon_0$。\n\n假设有能隙双层石墨烯的低能能带是抛物线型的。在零温（$T=0$）下，单位面积和单位能量的态密度（DOS）在带隙外的能量范围内是常数。这个常数态密度 $D_0$ 由下式给出：\n$$D_0 = \\frac{g_s g_v m^{\\star}}{2 \\pi \\hbar^2}$$\n\n**2. 杂质引起的势能涨落**\n\n位于石墨烯层附近的带电杂质会产生一个空间变化的静电势，这转化为载流子的势能景观 $U(\\mathbf{r})$。我们假设杂质是随机且独立分布的。\n\n对于一个载流子，由单个带电杂质产生的屏蔽势能在傅里叶空间中描述为：\n$$U_1(q) = \\frac{e^2}{2\\varepsilon(q + q_{\\mathrm{TF}})} e^{-qd}$$\n其中 $q=|\\mathbf{q}|$ 是波矢大小，$q_{\\mathrm{TF}}$ 是托马斯-费米屏蔽波数。势能涨落的功率谱密度 $S_U(q)$ 是：\n$$S_U(q) = n_{\\mathrm{imp}} |U_1(q)|^2 = n_{\\mathrm{imp}} \\left( \\frac{e^2}{2\\varepsilon} \\right)^2 \\frac{e^{-2qd}}{(q + q_{\\mathrm{TF}})^2}$$\n\n势能涨落的方差 $\\sigma^2 = \\langle U(\\mathbf{r})^2 \\rangle$ 是通过在二维 $\\mathbf{q}$ 空间中对功率谱密度进行积分得到的。\n$$\\sigma^2 = \\int \\frac{d^2\\mathbf{q}}{(2\\pi)^2} S_U(q) = \\frac{n_{\\mathrm{imp}}}{2\\pi} \\left( \\frac{e^2}{2\\varepsilon} \\right)^2 \\int_{q_{\\min}}^{\\infty} \\frac{q \\, e^{-2qd}}{(q + q_{\\mathrm{TF}})^2} dq$$\n其中引入了一个下限截止值 $q_{\\min} = 1/L$ 来表示有限的系统尺寸 $L$。均方根涨落为 $\\sigma = \\sqrt{\\sigma^2}$。\n\n**3. 自洽屏蔽**\n\n屏蔽波数 $q_{\\mathrm{TF}}$ 取决于费米能级处的有效态密度 $D_{\\mathrm{eff}}$，而后者本身又取决于势能涨落。托马斯-费米屏蔽波数定义为：\n$$q_{\\mathrm{TF}} = \\frac{2 \\pi e^{2}}{\\varepsilon} D_{\\mathrm{eff}}$$\n在有能隙系统的电荷中性点，载流子仅存在于 $|U(\\mathbf{r})|  E_g/2$ 的区域。因此，有效态密度是裸态密度 $D_0$ 乘以满足此条件的面积分数 $p$：\n$$D_{\\mathrm{eff}} = p \\cdot D_0$$\n假设势能景观 $U(\\mathbf{r})$ 遵循均值为零、方差为 $\\sigma^2$ 的高斯分布，面积分数 $p$ 是 $|U|  E_g/2$ 的概率：\n$$p = P(|U|  E_g/2) = \\mathrm{erfc}\\left(\\frac{E_g}{2\\sqrt{2}\\sigma}\\right)$$\n其中 $\\mathrm{erfc}(x)$ 是互补误差函数。\n\n自洽过程如下：\n1. 初始化 $q_{\\mathrm{TF}}$（例如，假设 $p=1$）。\n2. 迭代以下步骤直至收敛：\n    a. 给定当前的 $q_{\\mathrm{TF}}$，通过数值积分计算 $\\sigma$。\n    b. 使用新的 $\\sigma$ 更新面积分数 $p$。\n    c. 计算新的 $q_{\\mathrm{TF}}' = \\frac{2\\pi e^2}{\\varepsilon} p D_0$。\n    d. 检查收敛性。如果收敛，则退出循环。否则，更新 $q_{\\mathrm{TF}}$ 并继续。\n\n**4. 残余载流子密度**\n\n一旦找到了自洽的 $\\sigma$ 和 $q_{\\mathrm{TF}}$ 值，我们就可以计算平均残余载流子密度 $\\langle n \\rangle$。这是局域载流子密度大小 $n(\\mathbf{r})$ 的空间平均值。在 $T=0$ 时，局域密度为 $n(\\mathbf{r}) = D_0(|U(\\mathbf{r})| - E_g/2)$，当 $|U(\\mathbf{r})|  E_g/2$ 时。平均密度是对高斯分布的期望值：\n$$\\langle n \\rangle = D_0 \\cdot \\mathbb{E}\\left[ \\max\\left(|U| - \\frac{E_g}{2}, 0\\right) \\right]$$\n该期望值可以解析求解，得到：\n$$\\langle n \\rangle = D_0 \\left( \\sqrt{\\frac{2}{\\pi}} \\sigma \\, e^{-E_g^2/(8\\sigma^2)} - \\frac{E_g}{2} \\, \\mathrm{erfc}\\left(\\frac{E_g}{2\\sqrt{2}\\sigma}\\right) \\right)$$\n\n这个最终表达式使用收敛后的 $\\sigma$ 值，给出了目标残余载流子密度。",
            "answer": "```python\nimport numpy as np\nfrom scipy import constants, integrate, special\n\ndef solve():\n    \"\"\"\n    Computes the residual carrier density in gapped bilayer graphene using a\n    self-consistent Thomas-Fermi screening model.\n    \"\"\"\n\n    # Physical constants from scipy.constants in SI units\n    e = constants.e\n    m_e = constants.m_e\n    hbar = constants.hbar\n    epsilon_0 = constants.epsilon_0\n\n    # Fixed parameters for bilayer graphene model\n    g_s = 2.0  # Spin degeneracy\n    g_v = 2.0  # Valley degeneracy\n    m_star = 0.033 * m_e  # Effective mass\n\n    # Constant density of states (DOS) per unit area and energy\n    D0 = (g_s * g_v * m_star) / (2 * np.pi * hbar**2)\n\n    # Test suite of parameters: (n_imp, d, eps_r, E_g, L)\n    test_cases = [\n        (1.0e15, 1.0e-9, 4.0, 0.10, 1.0e-6),\n        (5.0e15, 1.0e-9, 4.0, 0.010, 2.0e-6),\n        (1.0e15, 2.0e-9, 10.0, 0.30, 5.0e-6),\n        (1.0e16, 0.5e-9, 2.5, 0.050, 1.0e-6),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n_imp, d, eps_r, Eg_eV, L = case\n\n        # Convert parameters to SI units\n        Eg = Eg_eV * e\n        eps = eps_r * epsilon_0\n        q_min = 1.0 / L\n\n        # --- Self-consistent calculation ---\n        \n        # Initial guess for q_TF assumes gapless graphene (p=1)\n        q_tf = (2 * np.pi * e**2 / eps) * D0\n\n        # Iteration parameters\n        max_iter = 100\n        rel_tol = 1e-7\n        \n        for _ in range(max_iter):\n            q_tf_prev = q_tf\n\n            # 1. Calculate RMS potential fluctuation sigma\n            integral_coeff = (n_imp / (2 * np.pi)) * (e**2 / (2 * eps))**2\n            \n            def integrand(q):\n                return q * np.exp(-2 * q * d) / (q + q_tf_prev)**2\n            \n            integral_val, _ = integrate.quad(integrand, q_min, np.inf)\n            sigma_sq = integral_coeff * integral_val\n            \n            if sigma_sq = 0:\n                sigma = 0.0\n            else:\n                sigma = np.sqrt(sigma_sq)\n            \n            # 2. Update area fraction p\n            if sigma > 1e-30: # Avoid division by zero\n                p = special.erfc(Eg / (2 * np.sqrt(2) * sigma))\n            else:\n                p = 0.0\n            \n            # 3. Update q_TF\n            q_tf = (2 * np.pi * e**2 / eps) * p * D0\n            \n            # 4. Check for convergence\n            if abs(q_tf - q_tf_prev)  rel_tol * abs(q_tf_prev) or abs(q_tf - q_tf_prev)  1e-9:\n                break\n        \n        # --- Final calculation of residual density ---\n        \n        if sigma > 1e-30:\n            exp_term = np.exp(-Eg**2 / (8 * sigma**2))\n            erfc_term = special.erfc(Eg / (2 * np.sqrt(2) * sigma))\n            \n            term1 = np.sqrt(2 / np.pi) * sigma * exp_term\n            term2 = (Eg / 2) * erfc_term\n            \n            n_residual = D0 * (term1 - term2)\n        else:\n            n_residual = 0.0\n            \n        results.append(n_residual)\n\n    # Format the final output string as specified\n    print(f\"[{','.join([f'{r:.6e}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}