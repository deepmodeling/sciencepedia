{
    "hands_on_practices": [
        {
            "introduction": "电子各向异性的定量研究始于其核心参数——有效质量 $m_x^*$ 和 $m_y^*$ 的精确提取。这项实践将指导你完成一项模拟真实计算材料科学研究的任务：从第一性原理计算（如密度泛函理论，DFT）得到的能带结构数据中，通过最小二乘法拟合来提取这些关键的质量参数 。通过这项练习，你不仅将掌握从理论模型到实际数据分析的桥梁，还将学会如何评估非抛物线性对有效质量提取所带来的不确定性。",
            "id": "4293744",
            "problem": "考虑单层磷烯（黑磷），其在布里渊区中心 $\\Gamma$ 附近的低能导带表现出强烈的电子各向异性。在各向异性二维晶体中，单个能带中电子的半经典描述使用晶体动量 $\\mathbf{k}$ 和能带能量 $E(\\mathbf{k})$ 如下：速度为 $ \\mathbf{v} = \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k}) $，对微弱均匀力 $\\mathbf{F}$ 的响应通过能带极值点处 $E(\\mathbf{k})$ 的曲率来定义一个有效质量张量。在主方向 $x$ 和 $y$ 上，标量有效质量 $m_x^*$ 和 $m_y^*$ 分别与 $E(k_x,0)$ 和 $E(0,k_y)$ 的曲率相关。在 $\\Gamma$ 点附近，沿每个主方向的能带色散可以展开为关于波矢分量的泰勒级数，而主导的曲率项决定了有效质量。\n\n你的任务是：\n- 从上述定义出发，构建 $k=0$ 附近 $E(k)$ 的曲率系数与相应方向有效质量之间的关系。\n- 实现一个最小二乘法程序，将假设的由密度泛函理论 (DFT) 推导出的、沿 $\\Gamma$ 点附近 $x$ 和 $y$ 方向的一维能带能量拟合到一个关于 $k$ 的多项式模型，保留至 $k$ 的四阶项以捕捉非抛物性。\n- 从拟合模型中提取二次曲率系数 $\\alpha_x$ 和 $\\alpha_y$，然后计算 $m_x^*$ 和 $m_y^*$。\n- 通过在多个对称拟合窗口 $|k| \\leq k_{\\max}$ 上进行纯二次拟合，并报告所得方向有效质量的标准差，来量化由非抛物性引起的 $m_x^*$ 和 $m_y^*$ 的不确定度。当存在高阶项时，此方法可以分离出提取的质量对拟合范围的敏感性。\n\n所有波矢必须以 $\\mathrm{\\AA}^{-1}$ 为单位，所有能量以 $\\mathrm{eV}$ 为单位，最终的有效质量必须以无量綱比率 $m_x^*/m_0$ 和 $m_y^*/m_0$ 的形式报告，其中 $m_0$ 是电子静止质量。同样，不确定度也应报告为 $m_x^*/m_0$ 和 $m_y^*/m_0$ 的无量纲标准差。从曲率计算质量时，请使用与国际单位制（SI）一致的单位转换。\n\n对于每个测试用例，你将获得通过以下公式构建的、合成的、假设的类DFT能带能量\n$$\nE_x(k_x) = E_0 + \\alpha_x k_x^2 + \\beta_x k_x^4, \\quad E_y(k_y) = E_0 + \\alpha_y k_y^2 + \\beta_y k_y^4,\n$$\n其中 $E_0 = 0$ 和指定的 $\\alpha_{x,y}$ 和 $\\beta_{x,y}$，这些能量在指定的关于0对称的k网格上进行评估。\n\n请严格实现以下测试套件：\n\n- 测试用例 1 (理想情况，中等各向异性和轻度非抛物性):\n    - 两个方向的 $k$ 网格: $k \\in \\{-0.06,-0.05,-0.04,-0.03,-0.02,-0.01,0.00,0.01,0.02,0.03,0.04,0.05,0.06\\}$，单位 $\\mathrm{\\AA}^{-1}$。\n    - 参数: $\\alpha_x = 25.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$, $\\beta_x = 150.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^4$, $\\alpha_y = 5.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$, $\\beta_y = 50.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^4$。\n    - 用于纯二次拟合不确定度估计的拟合窗口: $k_{\\max} \\in \\{0.02, 0.04, 0.06\\}$，单位 $\\mathrm{\\AA}^{-1}$。\n\n- 测试用例 2 (一个方向具有显著非抛物性的边缘情况):\n    - 两个方向的 $k$ 网格: $k \\in \\{-0.06,-0.05,-0.04,-0.03,-0.02,-0.01,0.00,0.01,0.02,0.03,0.04,0.05,0.06\\}$，单位 $\\mathrm{\\AA}^{-1}$。\n    - 参数: $\\alpha_x = 12.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$, $\\beta_x = 600.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^4$, $\\alpha_y = 12.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$, $\\beta_y = 80.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^4$。\n    - 用于纯二次拟合不确定度估计的拟合窗口: $k_{\\max} \\in \\{0.02, 0.04, 0.06\\}$，单位 $\\mathrm{\\AA}^{-1}$。\n\n- 测试用例 3 (强各向异性和更窄采样窗口的边界情况):\n    - 两个方向的 $k$ 网格: $k \\in \\{-0.04,-0.03,-0.02,-0.01,0.00,0.01,0.02,0.03,0.04\\}$，单位 $\\mathrm{\\AA}^{-1}$。\n    - 参数: $\\alpha_x = 40.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$, $\\beta_x = 15.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^4$, $\\alpha_y = 3.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$, $\\beta_y = 25.0$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^4$。\n    - 用于纯二次拟合不确定度估计的拟合窗口: $k_{\\max} \\in \\{0.02, 0.03, 0.04\\}$，单位 $\\mathrm{\\AA}^{-1}$。\n\n算法要求:\n- 对于每个测试用例中的每个方向，使用最小二乘法将 $E(k)$ 拟合到模型 $E(k) = a_2 k^2 + a_4 k^4$，并令 $\\alpha$ 等于拟合得到的 $a_2$。\n- 使用你从第一性原理推导出的关系和正确的SI单位转换，将 $\\alpha$ 转换为 $m^*$。\n- 为了计算不确定度，在每个指定的窗口 $|k| \\leq k_{\\max}$ 上执行独立的纯二次拟合 $E(k) = \\tilde{a}_2 k^2$，计算相应的 $m^*$ 值，并将这些 $m^*$ 值的标准差（使用贝塞尔校正）作为由非抛物性引起的不确定度。\n\n最终输出格式:\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的、逗号分隔的结果列表。\n- 每个测试用例的结果必须是 $[\\alpha_x,\\alpha_y,m_x^*/m_0,m_y^*/m_0,\\sigma(m_x^*/m_0),\\sigma(m_y^*/m_0)]$ 形式的列表，所有条目格式化为六位小数。\n- 因此，最终输出必须在单行上呈现为 $[[\\dots],[\\dots],[\\dots]]$ 的形式，不含任何额外文本。\n\n所有使用的物理常数必须是标准值：$\\hbar$ 单位为 $\\mathrm{J}\\cdot\\mathrm{s}$，$m_0$ 单位为 $\\mathrm{kg}$，以及转换因子 $1~\\mathrm{eV} = 1.602176634\\times 10^{-19}~\\mathrm{J}$ 和 $1~\\mathrm{\\AA} = 1.0\\times 10^{-10}~\\mathrm{m}$。最终的质量和不确定度表示为相对于 $m_0$ 的无量纲比率，四舍五入到六位小数。",
            "solution": "核心目标是通过分析单层磷烯在布里淵区中心（$\\Gamma$点）附近的电子能带结构 $E(\\mathbf{k})$，来确定其载流子的各向异性有效质量。这包括建立能带曲率与有效质量之间的理论关系，然后应用数值技术从合成的能带结构数据中提取这些参数。\n\n首先，我们推导能带能量曲率与有效质量之间的基本关系。在半经典模型中，晶体中电子波包在外力 $\\mathbf{F}$ 作用下的运动方程为 $\\hbar \\frac{d\\mathbf{k}}{dt} = \\mathbf{F}$，其中 $\\hbar$ 是约化普朗克常数，$\\mathbf{k}$ 是晶体动量。波包的群速度为 $\\mathbf{v} = \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k})$。加速度 $\\mathbf{a}$ 是速度的时间导数：\n$$\n\\mathbf{a} = \\frac{d\\mathbf{v}}{dt} = \\frac{d}{dt}\\left(\\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k})\\right)\n$$\n使用链式法则，可得：\n$$\n\\mathbf{a} = \\frac{1}{\\hbar} \\left( \\frac{\\partial}{\\partial \\mathbf{k}} \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right) \\cdot \\frac{d\\mathbf{k}}{dt} = \\frac{1}{\\hbar} \\left( \\nabla_{\\mathbf{k}} \\otimes \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right) \\cdot \\frac{1}{\\hbar}\\mathbf{F}\n$$\n加速度矢量分量 $a_i$ 通过有效质量张量的逆 $(\\mathbf{M}^*)^{-1}$ 与力分量 $F_j$ 相关联：\n$$\na_i = \\sum_j (\\mathbf{M}^*)^{-1}_{ij} F_j \\quad \\text{其中} \\quad (\\mathbf{M}^*)^{-1}_{ij} = \\frac{1}{\\hbar^2} \\frac{\\partial^2 E(\\mathbf{k})}{\\partial k_i \\partial k_j}\n$$\n对于在 $\\mathbf{k}=\\mathbf{0}$ 处的能带极值点，并沿张量是对角化的晶体主轴（$x, y$），标量有效质量 $m_x^*$ 和 $m_y^*$ 由对角元给出：\n$$\n\\frac{1}{m_x^*} = \\frac{1}{\\hbar^2} \\frac{\\partial^2 E}{\\partial k_x^2} \\bigg|_{\\mathbf{k}=\\mathbf{0}} \\quad \\text{和} \\quad \\frac{1}{m_y^*} = \\frac{1}{\\hbar^2} \\frac{\\partial^2 E}{\\partial k_y^2} \\bigg|_{\\mathbf{k}=\\mathbf{0}}\n$$\n在 $\\Gamma$ 点附近，沿某一主方向（例如 $x$ 方向）的能带色散可由泰勒级数近似：$E(k_x) = E_0 + \\alpha_x k_x^2 + \\beta_x k_x^4 + \\dots$。在 $k_x=0$ 处的二阶导数为 $\\frac{\\partial^2 E}{\\partial k_x^2} \\big|_{k_x=0} = 2\\alpha_x$。将此代入有效质量关系式，可得：\n$$\nm_{x}^* = \\frac{\\hbar^2}{2\\alpha_x}\n$$\n对于 $y$ 方向，也存在类似的关系：$m_{y}^* = \\hbar^2 / (2\\alpha_y)$。\n\n为了计算无量綱有效质量比 $m^*/m_0$（其中 $m_0$ 是电子静止质量），我们必须进行仔细的单位转换。给定的参数 $\\alpha_{x,y}$ 的单位是 $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$。我们使用常数 $\\hbar = 1.054571817\\times 10^{-34}~\\mathrm{J}\\cdot\\mathrm{s}$，$m_0 = 9.1093837015\\times 10^{-31}~\\mathrm{kg}$，以及转换因子 $C_{eV \\to J} = 1.602176634\\times 10^{-19}~\\mathrm{J/eV}$ 和 $C_{\\AA \\to m} = 1.0\\times 10^{-10}~\\mathrm{m/\\AA}$。有效质量的国际单位制（SI）单位（$\\mathrm{kg}$）为：\n$$\nm^*~[\\mathrm{kg}] = \\frac{\\hbar^2}{2 \\cdot \\alpha~[\\mathrm{eV}\\cdot\\mathrm{\\AA}^2] \\cdot C_{eV \\to J} \\cdot (C_{\\AA \\to m})^2}\n$$\n无量綱比率则为：\n$$\n\\frac{m^*}{m_0} = \\frac{\\hbar^2}{2 m_0 \\alpha~[\\mathrm{eV}\\cdot\\mathrm{\\AA}^2] C_{eV \\to J} (C_{\\AA \\to m})^2} = \\frac{K}{\\alpha~[\\mathrm{eV}\\cdot\\mathrm{\\AA}^2]}\n$$\n其中常数 $K = \\frac{\\hbar^2}{2 m_0 C_{eV \\to J} (C_{\\AA \\to m})^2} \\approx 3.80998236~\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$。\n\n对于每个主方向，数值程序包括两个主要任务。\n首先，为了确定系数 $\\alpha$，我们将提供的合成能带结构数据 $(k_i, E_i)$ 拟合到非抛物线模型 $E(k) = a_2 k^2 + a_4 k^4$。这是一个线性最小二乘问题。我们寻求系数向量 $\\mathbf{x} = [a_2, a_4]^T$ 来最小化系统 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 的平方误差，其中设计矩阵 $\\mathbf{A}$ 的每一行是 $[k_i^2, k_i^4]$，$\\mathbf{b}$ 是能量 $E_i$ 的向量。解可以使用标准线性代数库找到。得到的系数 $a_2$ 为真实曲率参数 $\\alpha$ 提供了最佳估计。由于合成数据正是由这种模型形式生成的，因此该拟合应能高保真地恢复输入的 $\\alpha$ 和 $\\beta$ 值。\n\n其次，为了量化不确定度，我们评估在存在非抛物性的情况下，有效质量的计算如何受拟合范围的影响。这是通过在一系列嵌套的、对称的波矢窗口 $|k| \\leq k_{\\max}$ 上执行一系列更简单的纯二次拟合 $E(k) = \\tilde{a}_2 k^2$ 来实现的。对于每个窗口，都会得到一个不同的 $\\tilde{a}_2$ 值。真实能量中存在的 $k^4$ 项导致 $\\tilde{a}_2$ 随 $k_{\\max}$ 变化；更宽的窗口会给予非抛物线部分更大的权重，从而改变表观的二次曲率。对于每个 $\\tilde{a}_2$，计算一个相应的有效质量。这组质量的样本标准差（使用贝塞尔校正，即除以 $N-1$）被报告为不确定度 $\\sigma(m^*/m_0)$，它分离出了抛物线近似对拟合范围的敏感性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the final results.\n    \"\"\"\n    # Define physical constants and conversion factors.\n    H_BAR = 1.054571817e-34  # J*s\n    M0 = 9.1093837015e-31   # kg\n    EV_TO_J = 1.602176634e-19 # J/eV\n    A_TO_M = 1.0e-10         # m/Angstrom\n\n    # Pre-calculate the conversion constant K from alpha [eV*A^2] to m*/m0\n    # m*/m0 = (H_BAR^2 / (2 * M0 * EV_TO_J * A_TO_M^2)) / alpha\n    K_CONST = (H_BAR**2) / (2 * M0 * EV_TO_J * (A_TO_M**2))\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"k_grid\": np.array([-0.06, -0.05, -0.04, -0.03, -0.02, -0.01, 0.00, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06]),\n            \"params\": {\"x\": (25.0, 150.0), \"y\": (5.0, 50.0)}, # (alpha, beta)\n            \"k_max_windows\": [0.02, 0.04, 0.06]\n        },\n        {\n            \"k_grid\": np.array([-0.06, -0.05, -0.04, -0.03, -0.02, -0.01, 0.00, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06]),\n            \"params\": {\"x\": (12.0, 600.0), \"y\": (12.0, 80.0)},\n            \"k_max_windows\": [0.02, 0.04, 0.06]\n        },\n        {\n            \"k_grid\": np.array([-0.04, -0.03, -0.02, -0.01, 0.00, 0.01, 0.02, 0.03, 0.04]),\n            \"params\": {\"x\": (40.0, 15.0), \"y\": (3.0, 25.0)},\n            \"k_max_windows\": [0.02, 0.03, 0.04]\n        }\n    ]\n\n    def calculate_properties(case, k_const):\n        \"\"\"\n        Processes a single test case to calculate alpha, m*/m0, and uncertainty.\n        \"\"\"\n        results_dir = {}\n        for direction in ['x', 'y']:\n            k_values = case[\"k_grid\"]\n            alpha_true, beta_true = case[\"params\"][direction]\n\n            # Generate synthetic energy data: E(k) = alpha*k^2 + beta*k^4\n            E_values = alpha_true * k_values**2 + beta_true * k_values**4\n\n            # --- Part 1: Fit to quartic model to extract alpha ---\n            # Model: E = a2*k^2 + a4*k^4\n            # We solve Ax = b, where x = [a2, a4]^T\n            A_quartic = np.vstack([k_values**2, k_values**4]).T\n            # The point k=0 gives 0=0, providing no info, but is harmless\n            coeffs_quartic = np.linalg.lstsq(A_quartic, E_values, rcond=None)[0]\n            alpha_fit = coeffs_quartic[0]\n            mass_ratio_fit = k_const / alpha_fit\n            \n            # --- Part 2: Uncertainty estimation from quadratic fits ---\n            masses_for_std = []\n            for k_max in case[\"k_max_windows\"]:\n                # Filter data for the current window |k| = k_max\n                mask = np.abs(k_values) = k_max + 1e-9 # Add tolerance for float comparison\n                k_subset = k_values[mask]\n                E_subset = E_values[mask]\n\n                # Fit to quadratic model: E = a2_tilde * k^2\n                # We solve Ax = b where x = [a2_tilde]^T\n                A_quad = np.vstack([k_subset**2]).T\n                # Filter out the k=0 point for the matrix to not be all zeros\n                # if the window is very small, although lstsq handles it.\n                if np.all(A_quad == 0):\n                    # This case should not happen with given inputs\n                    continue\n                \n                a2_tilde = np.linalg.lstsq(A_quad, E_subset, rcond=None)[0][0]\n                mass_ratio_window = k_const / a2_tilde\n                masses_for_std.append(mass_ratio_window)\n            \n            # Calculate standard deviation with Bessel's correction (ddof=1)\n            uncertainty = np.std(masses_for_std, ddof=1) if len(masses_for_std) > 1 else 0.0\n\n            results_dir[direction] = (alpha_fit, mass_ratio_fit, uncertainty)\n\n        return [\n            results_dir['x'][0], results_dir['y'][0],  # alpha_x, alpha_y\n            results_dir['x'][1], results_dir['y'][1],  # m_x*/m0, m_y*/m0\n            results_dir['x'][2], results_dir['y'][2]   # sigma(m_x*/m0), sigma(m_y*/m0)\n        ]\n\n    final_results = []\n    for case in test_cases:\n        result = calculate_properties(case, K_CONST)\n        final_results.append(result)\n\n    # Format the output string exactly as required\n    output_parts = []\n    for result_list in final_results:\n        formatted_list = [f\"{val:.6f}\" for val in result_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在确定了有效质量之后，一个自然而然的问题是：这些参数对于电子输运意味着什么？这项实践将能带结构的曲率（通过有效质量体现）与载流子迁移率——衡量器件性能的关键指标——直接联系起来。通过推导和计算迁移率的各向异性比率 ，你将亲眼见证磷烯独特的褶皱晶格结构是如何导致其电导性质呈现出显著的方向依赖性的。",
            "id": "4293767",
            "problem": "磷烯（黑磷）是一种二维半导体，具有褶皱的晶格结构，这导致了其电子能带具有强烈的各向异性。考虑在主晶轴方向，即扶手椅型（$x$）和锯齿型（$y$）方向上，带边附近的导带可以用各向异性抛物线色散模型来描述，其有效质量分别为 $m_{x}^{*}$ 和 $m_{y}^{*}$。假设载流子的半经典动力学遵循玻尔兹曼输运方程（BTE），并采用弛豫时间近似，其中动量弛豫时间 $\\tau$ 与方向无关。从群速度的定义和线性化的BTE出发，推导沿主轴 $j \\in \\{x,y\\}$ 方向的漂移迁移率 $\\mu_{j}$ 的表达式，该表达式应使用元电荷 $e$、弛豫时间 $\\tau$ 和有效质量 $m_{j}^{*}$ 来表示。由此，求出各向异性比 $\\mu_{x}/\\mu_{y}$。\n\n使用代表磷烯各向异性的有效质量示例值，$m_{x}^{*}=0.15\\,m_{0}$ 和 $m_{y}^{*}=1.0\\,m_{0}$（其中 $m_{0}$ 是自由电子质量），计算该各向异性比。将最终答案表示为一个无量纲的数，并四舍五入到三位有效数字。",
            "solution": "问题陈述经过严格验证，确认有效。其科学依据扎根于固态物理学原理，问题提法恰当，并使用了客观、正式的语言。所有必要信息均已提供，可得出唯一解。\n\n该问题要求推导各向异性半导体的漂移迁移率 $\\mu_{j}$，并随后计算磷烯的迁移率各向异性比。\n\n推导从电子输运的半经典模型开始。对于在主轴 $x$ 和 $y$ 方向上具有各向异性抛物线能带的二维材料，其导带带边附近电子的能量-动量色散关系由下式给出：\n$$\nE(\\mathbf{k}) = E_{c} + \\frac{\\hbar^2 k_x^2}{2m_{x}^{*}} + \\frac{\\hbar^2 k_y^2}{2m_{y}^{*}}\n$$\n其中 $E_{c}$ 是导带底能量，$\\hbar$ 是约化普朗克常数，$\\mathbf{k} = (k_x, k_y)$ 是晶体动量波矢，$m_{x}^{*}$ 和 $m_{y}^{*}$ 分别是沿扶手椅型（$x$）和锯齿型（$y$）方向的有效质量。\n\n电子波包的群速度 $\\mathbf{v}_{g}$ 定义为能量色散在 $\\mathbf{k}$ 空间中的梯度：\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k})\n$$\n群速度的分量为：\n$$\nv_{g,x} = \\frac{1}{\\hbar} \\frac{\\partial E}{\\partial k_x} = \\frac{1}{\\hbar} \\left( \\frac{\\hbar^2 (2k_x)}{2m_{x}^{*}} \\right) = \\frac{\\hbar k_x}{m_{x}^{*}}\n$$\n$$\nv_{g,y} = \\frac{1}{\\hbar} \\frac{\\partial E}{\\partial k_y} = \\frac{1}{\\hbar} \\left( \\frac{\\hbar^2 (2k_y)}{2m_{y}^{*}} \\right) = \\frac{\\hbar k_y}{m_{y}^{*}}\n$$\n以矢量形式，这可以用逆有效质量张量 $M^{-1}$ 来表示：\n$$\n\\mathbf{v}_{g} = M^{-1} (\\hbar\\mathbf{k}), \\quad \\text{其中} \\quad M^{-1} = \\begin{pmatrix} 1/m_{x}^{*}  0 \\\\ 0  1/m_{y}^{*} \\end{pmatrix}\n$$\n\n接下来，我们使用弛豫时间近似下的线性化玻尔兹曼输运方程（BTE）。在稳恒且空间均匀的电场 $\\mathbf{E}$ 存在下，电子分布函数 $f(\\mathbf{k})$ 的BTE为：\n$$\n\\frac{-e\\mathbf{E}}{\\hbar} \\cdot \\nabla_{\\mathbf{k}} f = -\\frac{f - f_0}{\\tau}\n$$\n其中 $f_0$ 是平衡费米-狄拉克分布函数，$\\tau$ 是动量弛豫时间，假设其为各向同性。通过在方程左侧用 $f_0$ 近似 $f$ 来线性化方程，得到分布函数的一阶修正项 $f_1 = f - f_0$：\n$$\nf_1 = f - f_0 \\approx \\frac{e\\tau}{\\hbar} (\\mathbf{E} \\cdot \\nabla_{\\mathbf{k}} f_0)\n$$\n使用链式法则，$\\nabla_{\\mathbf{k}} f_0 = \\frac{\\partial f_0}{\\partial E} \\nabla_{\\mathbf{k}} E = \\frac{\\partial f_0}{\\partial E} (\\hbar \\mathbf{v}_{g})$。将其代入，我们得到：\n$$\nf(\\mathbf{k}) \\approx f_0(\\mathbf{k}) + e\\tau \\frac{\\partial f_0}{\\partial E} (\\mathbf{E} \\cdot \\mathbf{v}_{g}(\\mathbf{k}))\n$$\n\n漂移速度 $\\mathbf{v}_{d}$ 是载流子系综在电场影响下的平均速度。它是通过对受扰动的分布函数 $f(\\mathbf{k})$ 求群速度的平均值来计算的：\n$$\n\\mathbf{v}_{d} = \\frac{\\int \\mathbf{v}_{g}(\\mathbf{k}) f(\\mathbf{k}) d^2k}{\\int f(\\mathbf{k}) d^2k}\n$$\n由于 $E(\\mathbf{k})$ 和 $\\mathbf{v}_{g}(\\mathbf{k})$ 的对称性（它们分别是 $\\mathbf{k}$ 的偶函数和奇函数），$\\mathbf{v}_{g} f_0$ 的积分为零。对于小扰动，代表总载流子数的分母近似为 $\\int f_0 d^2k$。\n$$\n\\mathbf{v}_{d} \\approx \\frac{\\int \\mathbf{v}_{g} \\left( e\\tau \\frac{\\partial f_0}{\\partial E} (\\mathbf{E} \\cdot \\mathbf{v}_{g}) \\right) d^2k}{\\int f_0 d^2k}\n$$\n\n对于电子（电荷为 $-e$），漂移迁移率张量 $\\mu$ 由关系式 $\\mathbf{v}_{d} = -\\mu \\mathbf{E}$ 定义。我们考虑一个沿主轴之一施加的电场，例如 $\\mathbf{E} = E_x \\hat{\\mathbf{x}}$。产生的漂移速度也将在 $x$ 轴方向上，即 $v_{d,x}$。\n迁移率分量 $\\mu_x$ 由 $\\mu_x = -v_{d,x}/E_x$ 给出。\n$$\n\\mu_x = -\\frac{1}{E_x} \\frac{\\int v_{g,x} \\left( e\\tau \\frac{\\partial f_0}{\\partial E} (E_x v_{g,x}) \\right) d^2k}{\\int f_0 d^2k} = -e\\tau \\frac{\\int v_{g,x}^2 \\frac{\\partial f_0}{\\partial E} d^2k}{\\int f_0 d^2k}\n$$\n对于抛物线能带，该积分可以被计算出来。对于非简并（麦克斯韦-玻尔兹曼）和简并（费米-狄拉克）统计，该表达式都可以严格简化。一个更直接、物理上等效的方法是使用晶体动量 $\\mathbf{p} = \\hbar\\mathbf{k}$ 的半经典运动方程：\n$$\n\\frac{d\\mathbf{p}}{dt} = -e\\mathbf{E} - \\frac{\\mathbf{p}}{\\tau}\n$$\n在稳态下（$d\\mathbf{p}/dt = 0$），平均漂移动量 $\\mathbf{p}_{d}$ 为 $\\mathbf{p}_{d} = -e\\tau\\mathbf{E}$。相应的漂移速度为 $\\mathbf{v}_{d} = M^{-1} \\mathbf{p}_{d}$。\n$$\n\\mathbf{v}_{d} = M^{-1}(-e\\tau\\mathbf{E}) = -\\left(e\\tau M^{-1}\\right)\\mathbf{E}\n$$\n将此与定义式 $\\mathbf{v}_{d} = -\\mu\\mathbf{E}$ 比较，我们确定迁移率张量为：\n$$\n\\mu = e\\tau M^{-1} = e\\tau \\begin{pmatrix} 1/m_{x}^{*}  0 \\\\ 0  1/m_{y}^{*} \\end{pmatrix} = \\begin{pmatrix} e\\tau/m_{x}^{*}  0 \\\\ 0  e\\tau/m_{y}^{*} \\end{pmatrix}\n$$\n该张量的对角分量是沿主轴的迁移率。对于一个通用的主轴 $j \\in \\{x,y\\}$：\n$$\n\\mu_{j} = \\frac{e\\tau}{m_{j}^{*}}\n$$\n这个表达式表明，沿某一给定方向的迁移率与该方向的有效质量成反比。\n\n接下来，我们求迁移率各向异性比 $\\mu_x/\\mu_y$：\n$$\n\\frac{\\mu_x}{\\mu_y} = \\frac{e\\tau/m_{x}^{*}}{e\\tau/m_{y}^{*}}\n$$\n$e$ 和 $\\tau$ 项被消去，得到一个仅取决于有效质量的比率：\n$$\n\\frac{\\mu_x}{\\mu_y} = \\frac{m_{y}^{*}}{m_{x}^{*}}\n$$\n最后，我们使用给定的磷烯有效质量值来计算这个比率：$m_{x}^{*} = 0.15\\,m_{0}$ 和 $m_{y}^{*} = 1.0\\,m_{0}$。\n$$\n\\frac{\\mu_x}{\\mu_y} = \\frac{1.0\\,m_{0}}{0.15\\,m_{0}} = \\frac{1.0}{0.15} = \\frac{100}{15} = \\frac{20}{3} \\approx 6.666...\n$$\n按要求将结果四舍五入到三位有效数字，得到 $6.67$。",
            "answer": "$$\\boxed{6.67}$$"
        },
        {
            "introduction": "我们能否主动调控甚至反转这种固有的各向异性？这项高级实践将带你探索“应变工程”这一前沿领域。利用紧束缚模型，你将研究施加机械应变如何改变原子间的电子跃迁参数和晶格常数，并最终实现对有效质量和迁移率各向异性的调控 。这个练习清晰地展示了如何通过外部手段设计材料的基本属性，从而为开发新型电子器件开辟了道路。",
            "id": "4293685",
            "problem": "考虑一个旨在捕捉 phosphorene (black phosphorus) 低能电子结构的二维各向异性紧束缚模型，该材料表现出强的面内电子各向异性。假设晶体被建模为一个矩形晶格，其主轴分别与 armchair 方向 ($x$) 和 zigzag 方向 ($y$) 对齐。未应变时的晶格常数分别为 $a_{x0}$ 和 $a_{y0}$，沿这些方向的最近邻跃迁振幅分别为 $t_{x0}$ 和 $t_{y0}$。沿 $x$ 方向施加单轴应变，由应变标量 $\\epsilon$ 表征，沿 $y$ 方向的横向应变由 Poisson 响应给出，即 $\\epsilon_{y} = -\\nu \\epsilon$，其中 $\\nu$ 是 Poisson 比。\n\n仅从适用于此背景的、经过充分检验的事实和核心定义出发：\n- 在波矢 $\\mathbf{k} = \\mathbf{0}$（$\\Gamma$ 点）的能带极值附近，紧束缚能量色散可以展开到波矢的二阶，有效质量张量通过能量的曲率定义为 $m_{i}^{*} = \\hbar^{2} \\left(\\frac{\\partial^{2} E}{\\partial k_{i}^{2}}\\right)^{-1}$，其中 $i \\in \\{x,y\\}$。\n- 在矩形晶格上，具有方向依赖跃迁参数的最近邻紧束缚模型产生的色散关系为余弦能带结构，可以在极值点附近系统地展开为波矢的幂级数，以提取有效质量。\n- 原子间重叠随应变的变化可以通过跃迁参数对键长变化的指数依赖性来捕捉：对于应变的 $x$ 方向为 $t_{x}(\\epsilon) = t_{x0} \\exp(-\\beta_{x}\\,\\epsilon)$，对于由于 Poisson 响应产生的横向 $y$ 方向为 $t_{y}(\\epsilon) = t_{y0} \\exp\\!\\left(\\beta_{y}\\,\\nu\\,\\epsilon\\right)$。这些关系体现了广泛观察到的电子跃迁对键长的指数敏感性，其中 $\\beta_{x}$ 和 $\\beta_{y}$ 是依赖于材料的无量纲系数。\n- 在应变作用下，晶格常数在一阶上遵循线性弹性理论：$a_{x}(\\epsilon) = a_{x0}\\,(1+\\epsilon)$ 和 $a_{y}(\\epsilon) = a_{y0}\\,(1-\\nu\\,\\epsilon)$。\n\n您的任务是：\n$1.$ 从上述基础出发，推导出计算比率 $m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$ 所需的表达式，该表达式以紧束缚色散在 $\\mathbf{k}=\\mathbf{0}$ 处的二阶导数表示，并一致地考虑应变修正后的晶格常数和跃迁振幅。\n$2.$ 实现一个程序，用于为一组给定的参数和选定的应变值评估 $m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$，并判断相对于未应变状态是否发生迁移率各向异性反转。在具有方向无关散射时间的最简单近似中，迁移率与有效质量成反比，因此迁移率各向异性的反转等效于比率 $m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$ 相对于其未应变基线穿越值 $1$。形式上，通过检查 $\\left(m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon) - 1\\right)\\left(m_{x}^{*}(0)/m_{y}^{*}(0) - 1\\right)  0$ 来定义测试案例应变 $\\epsilon$ 是否发生反转。\n$3.$ 使用以下科学上合理的参数值，这些值反映了 phosphorene 的典型各向异性，同时确保探测到强应变状态：\n- $a_{x0} = 3.3\\times 10^{-10}\\,\\mathrm{m}$，\n- $a_{y0} = 4.6\\times 10^{-10}\\,\\mathrm{m}$，\n- $t_{x0} = -1.0\\,\\mathrm{eV}$，\n- $t_{y0} = -0.25\\,\\mathrm{eV}$，\n- $\\nu = 0.2$，\n- $\\beta_{x} = 7$，\n- $\\beta_{y} = 1$。\n\n$4.$ 对以下涵盖压缩、零、中等拉伸和强拉伸条件的测试应变值套件，评估比率 $m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$：\n- $\\epsilon = -0.10$，\n- $\\epsilon = 0.00$，\n- $\\epsilon = +0.10$，\n- $\\epsilon = +0.15$。\n\n所有计算出的比率 $m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$ 都是无量纲的；输出中不需要物理单位。对于每个测试用例，您的程序应生成一个配对，其中包含四舍五入到六位小数的比率和一个指示相对于未应变基线是否发生反转的布尔值，并将其聚合为单个列表。要求的最终输出格式是包含结果的单行，形式为方括号内以逗号分隔的列表，其中每个元素是一个双元素列表 $[r,\\mathrm{inv}]$，$r$ 是四舍五入的浮点数，$\\mathrm{inv}$ 是布尔值。例如：$[[r_{1},\\mathrm{inv}_{1}],[r_{2},\\mathrm{inv}_{2}],\\ldots]$。\n\n您的实现必须是一个完整、可运行的程序。它不能要求任何输入，并且必须完全按照上述规定使用参数和测试套件。",
            "solution": "已根据指定的验证标准对用户提供的问题进行了评估。\n\n### 第 1 步：提取已知条件\n- **模型**: phosphorene 在矩形晶格上的二维各向异性紧束缚模型。\n- **轴**: armchair ($x$) 方向，zigzag ($y$) 方向。\n- **未应变参数**:\n    - 晶格常数: $a_{x0}$, $a_{y0}$。\n    - 跃迁振幅: $t_{x0}$, $t_{y0}$。\n- **应变**: 沿 $x$ 方向的单轴应变 $\\epsilon$。\n- **Poisson 响应**: 横向应变 $\\epsilon_{y} = -\\nu \\epsilon$，其中 $\\nu$ 为 Poisson 比。\n- **基本定义与关系**:\n    - 在 $\\mathbf{k} = \\mathbf{0}$ 处的有效质量张量: $m_{i}^{*} = \\hbar^{2} \\left(\\frac{\\partial^{2} E}{\\partial k_{i}^{2}}\\right)^{-1}$，其中 $i \\in \\{x,y\\}$。\n    - 能量色散: 在矩形晶格上的最近邻紧束缚模型产生一个余弦能带结构，可在 $\\mathbf{k}=\\mathbf{0}$ 附近展开。\n    - 应变依赖的跃迁振幅: $t_{x}(\\epsilon) = t_{x0} \\exp(-\\beta_{x}\\,\\epsilon)$ 和 $t_{y}(\\epsilon) = t_{y0} \\exp(\\beta_{y}\\,\\nu\\,\\epsilon)$。\n    - 应变依赖的晶格常数: $a_{x}(\\epsilon) = a_{x0}\\,(1+\\epsilon)$ 和 $a_{y}(\\epsilon) = a_{y0}\\,(1-\\nu\\,\\epsilon)$。\n- **各向异性反转条件**: $\\left(m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon) - 1\\right)\\left(m_{x}^{*}(0)/m_{y}^{*}(0) - 1\\right)  0$。\n- **参数值**:\n    - $a_{x0} = 3.3\\times 10^{-10}\\,\\mathrm{m}$\n    - $a_{y0} = 4.6\\times 10^{-10}\\,\\mathrm{m}$\n    - $t_{x0} = -1.0\\,\\mathrm{eV}$\n    - $t_{y0} = -0.25\\,\\mathrm{eV}$\n    - $\\nu = 0.2$\n    - $\\beta_{x} = 7$\n    - $\\beta_{y} = 1$\n- **测试套件**: $\\epsilon \\in \\{-0.10, 0.00, +0.10, +0.15\\}$。\n- **输出要求**: 对于每个 $\\epsilon$，提供一个配对 $[r, \\mathrm{inv}]$，其中 $r$ 是比率 $m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$ 四舍五入到六位小数后的值，$\\mathrm{inv}$ 是一个指示是否发生各向异性反转的布尔值。最终输出必须是这些配对的单个列表。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据既定标准对问题进行严格评估。\n\n- **科学依据充分**: 该问题基于成熟的紧束缚模型，这是凝聚态物理中描述电子能带结构的标准理论工具。有效质量、应变、Poisson 比以及跃迁参数对键长的指数依赖性等概念都是标准的、物理上合理的原则。所给的参数值虽然是特定的，但说明了对于 phosphorene 是合理的。问题没有违反任何科学定律或原则。\n- **问题定义明确**: 问题定义清晰。它提供了推导唯一解所需的所有必要参数和方程。任务是具体的：推导解析表达式，然后实现一个程序来计算指定输入集的数值。\n- **客观性**: 语言精确且技术性强。它没有主观断言、推测或含糊不清之处。\n- **完整性与一致性**: 问题陈述是自洽的。提供的应变依赖参数方程与线性弹性原理以及固体中原子间相互作用的典型建模方法一致。没有矛盾之处。\n- **可行性**: 任务在计算上和分析上都是可行的。所需的计算是微积分和代数的直接应用。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。这是一个来自固态物理和纳米电子学领域的、定义明确、科学依据充分且客观的问题。我将继续进行求解。\n\n### 推导与求解方法\n目标是推导有效质量比 $m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$ 的表达式，并在各种应变条件下对其进行评估。\n\n二维矩形晶格上最近邻紧束缚模型的能量色散由以下公式给出：\n$$E(k_x, k_y) = E_c - 2t_x \\cos(k_x a_x) - 2t_y \\cos(k_y a_y)$$\n其中 $E_c$ 是一个恒定能量偏移，$t_x$ 和 $t_y$ 是跃迁参数，$a_x$ 和 $a_y$ 分别是沿 $x$ 和 $y$ 方向的晶格常数。\n\n问题指定应在 $\\Gamma$ 点，即 $\\mathbf{k} = (k_x, k_y) = (0, 0)$ 处计算有效质量。沿主方向 $i$ 的有效质量分量定义为 $m_{i}^{*} = \\hbar^{2} \\left( \\frac{\\partial^{2} E}{\\partial k_{i}^{2}} \\right)^{-1}$。我们必须首先计算色散关系式的二阶偏导数。\n\n一阶偏导数为：\n$$ \\frac{\\partial E}{\\partial k_x} = 2t_x a_x \\sin(k_x a_x) $$\n$$ \\frac{\\partial E}{\\partial k_y} = 2t_y a_y \\sin(k_y a_y) $$\n在 $\\mathbf{k} = (0, 0)$ 处，两个一阶导数均为零，证实了这是一个能带极值点。\n\n二阶偏导数为：\n$$ \\frac{\\partial^2 E}{\\partial k_x^2} = 2t_x a_x^2 \\cos(k_x a_x) $$\n$$ \\frac{\\partial^2 E}{\\partial k_y^2} = 2t_y a_y^2 \\cos(k_y a_y) $$\n在 $\\mathbf{k} = (0, 0)$ 处计算这些值：\n$$ \\left. \\frac{\\partial^2 E}{\\partial k_x^2} \\right|_{\\mathbf{k}=\\mathbf{0}} = 2t_x a_x^2 $$\n$$ \\left. \\frac{\\partial^2 E}{\\partial k_y^2} \\right|_{\\mathbf{k}=\\mathbf{0}} = 2t_y a_y^2 $$\n\n使用有效质量的定义，我们找到其分量：\n$$ m_x^* = \\frac{\\hbar^2}{2t_x a_x^2} $$\n$$ m_y^* = \\frac{\\hbar^2}{2t_y a_y^2} $$\n\n因此，所需的有效质量比为：\n$$ \\frac{m_x^*}{m_y^*} = \\frac{\\hbar^2 / (2t_x a_x^2)}{\\hbar^2 / (2t_y a_y^2)} = \\frac{t_y a_y^2}{t_x a_x^2} $$\n这个表达式对于矩形晶格是通用的。现在，我们引入应变依赖性。问题为沿 x 方向施加的单轴应变 $\\epsilon$ 提供了以下关系：\n- $a_x(\\epsilon) = a_{x0}(1+\\epsilon)$\n- $a_y(\\epsilon) = a_{y0}(1-\\nu\\epsilon)$\n- $t_x(\\epsilon) = t_{x0} \\exp(-\\beta_x \\epsilon)$\n- $t_y(\\epsilon) = t_{y0} \\exp(\\beta_y \\nu \\epsilon)$\n\n将这些关系代入质量比表达式，得到应变依赖的比率 $R(\\epsilon) = m_{x}^{*}(\\epsilon)/m_{y}^{*}(\\epsilon)$:\n$$ R(\\epsilon) = \\frac{t_y(\\epsilon) \\, a_y(\\epsilon)^2}{t_x(\\epsilon) \\, a_x(\\epsilon)^2} = \\frac{ \\left( t_{y0} \\exp(\\beta_y \\nu \\epsilon) \\right) \\left( a_{y0}(1-\\nu\\epsilon) \\right)^2 }{ \\left( t_{x0} \\exp(-\\beta_x \\epsilon) \\right) \\left( a_{x0}(1+\\epsilon) \\right)^2 } $$\n这个表达式可以方便地分解为未应变部分和一个应变依赖的修正因子：\n$$ R(\\epsilon) = \\left( \\frac{t_{y0} a_{y0}^2}{t_{x0} a_{x0}^2} \\right) \\cdot \\frac{\\exp(\\beta_y \\nu \\epsilon) (1-\\nu\\epsilon)^2}{\\exp(-\\beta_x \\epsilon) (1+\\epsilon)^2} $$\n第一个括号中的项是未应变比率，$R(0) = m_x^*(0)/m_y^*(0)$。完整的表达式可以更紧凑地写为：\n$$ R(\\epsilon) = R(0) \\cdot \\exp((\\beta_x + \\beta_y \\nu)\\epsilon) \\cdot \\left( \\frac{1-\\nu\\epsilon}{1+\\epsilon} \\right)^2 $$\n\n这是实现所需的最终解析表达式。程序将：\n1. 定义给定的常数：$a_{x0}$, $a_{y0}$, $t_{x0}$, $t_{y0}$, $\\nu$, $\\beta_x$, $\\beta_y$。\n2. 首先，计算未应变比率 $R(0)$。\n3. 对于测试套件 $\\{-0.10, 0.00, +0.10, +0.15\\}$ 中的每个应变值 $\\epsilon$，使用推导出的公式计算应变比率 $R(\\epsilon)$。\n4. 对于每个 $\\epsilon$，通过评估条件 $(R(\\epsilon) - 1)(R(0) - 1)  0$ 来确定各向异性反转的布尔值。\n5. 将计算出的比率 $R(\\epsilon)$ 四舍五入到六位小数。\n6. 将结果整理成 `[ratio, inversion_boolean]` 配对的列表，并按指定格式打印。将使用 `numpy` 库的指数函数 `exp`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the effective mass anisotropy ratio for a 2D tight-binding model of phosphorene\n    under uniaxial strain and determines if an anisotropy inversion occurs.\n    \"\"\"\n\n    # 1. Define scientifically plausible parameter values from the problem statement.\n    # Unstrained lattice constants (m)\n    a_x0 = 3.3e-10\n    a_y0 = 4.6e-10\n    # Unstrained nearest-neighbor hopping amplitudes (eV)\n    t_x0 = -1.0\n    t_y0 = -0.25\n    # Poisson ratio (dimensionless)\n    nu = 0.2\n    # Exponential dependence coefficients for hopping parameters (dimensionless)\n    beta_x = 7.0\n    beta_y = 1.0\n\n    # 2. Define the test suite of strain values.\n    strain_values = [-0.10, 0.00, 0.10, 0.15]\n\n    # 3. Define the function to calculate the mass ratio R(epsilon).\n    def calculate_mass_ratio(epsilon, params):\n        \"\"\"\n        Computes the ratio m_x*(epsilon) / m_y*(epsilon).\n        \n        The derived formula is:\n        R(epsilon) = (t_y0 * a_y0^2) / (t_x0 * a_x0^2) * \n                     exp((beta_x + beta_y * nu) * epsilon) * \n                     ((1 - nu * epsilon) / (1 + epsilon))^2\n        \"\"\"\n        a_x0_p, a_y0_p, t_x0_p, t_y0_p, nu_p, beta_x_p, beta_y_p = params\n        \n        # Unstrained ratio R(0)\n        unstrained_ratio_val = (t_y0_p * a_y0_p**2) / (t_x0_p * a_x0_p**2)\n        \n        # Strain-dependent correction factor\n        if 1 + epsilon == 0:\n            # Avoid division by zero, though not expected for given inputs\n            return np.inf\n\n        exp_term = np.exp((beta_x_p + beta_y_p * nu_p) * epsilon)\n        poly_term = ((1 - nu_p * epsilon) / (1 + epsilon))**2\n        \n        return unstrained_ratio_val * exp_term * poly_term\n\n    # Store all parameters in a tuple for easy passing\n    parameters = (a_x0, a_y0, t_x0, t_y0, nu, beta_x, beta_y)\n    \n    # 4. Calculate the baseline (unstrained) ratio to check for inversion.\n    ratio_at_zero_strain = calculate_mass_ratio(0.0, parameters)\n\n    results = []\n    for eps in strain_values:\n        # Calculate the ratio for the current strain value\n        ratio = calculate_mass_ratio(eps, parameters)\n        \n        # Check for anisotropy inversion\n        # The condition is True if the ratio crosses 1 compared to the unstrained state.\n        # (R(eps) - 1) and (R(0) - 1) must have opposite signs.\n        inversion_occurred = (ratio - 1) * (ratio_at_zero_strain - 1)  0\n        \n        # Round the ratio to six decimal places as required\n        rounded_ratio = round(ratio, 6)\n        \n        # Append the pair [rounded_ratio, inversion_boolean] to the results list\n        results.append([rounded_ratio, inversion_occurred])\n\n    # 5. Final print statement in the exact required format.\n    # The format should be a string representation of a list of lists.\n    # e.g., [[r1, True], [r2, False]]\n    # Using f-string with join and map(str) achieves this.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}