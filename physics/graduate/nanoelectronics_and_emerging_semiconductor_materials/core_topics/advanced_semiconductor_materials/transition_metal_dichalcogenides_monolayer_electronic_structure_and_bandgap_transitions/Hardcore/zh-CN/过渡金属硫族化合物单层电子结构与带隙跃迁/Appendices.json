{
    "hands_on_practices": [
        {
            "introduction": "应变工程是调控二维材料电子和光学性质的有力工具。本练习将引导你应用线性形变势理论，这是一个连接晶格应变与能带结构变化的基本框架。通过这个实践 ，你将学会如何定量计算单层TMD在双轴应变下直接带隙的变化，并批判性地评估线性模型的适用范围。",
            "id": "4310076",
            "problem": "考虑一个在布里渊区角点 $K$ 处具有直接带隙的单层过渡金属硫族化合物 (TMD)。在谐波弹性体系中，将均匀面内应变视为对晶体势的一个小微扰。对于一个等双轴应变状态，应变张量的分量可以写为 $\\epsilon_{xx}=\\epsilon$ 和 $\\epsilon_{yy}=\\epsilon$，其中 $\\epsilon_{xy}=0$，$\\epsilon$ 是所施加双轴应变的标量大小。在线性形变势理论中，带边能量的领头（一阶）修正由一个与应变张量标量不变量耦合的静水形变势决定。使用此框架和适用于单层TMD中 $K$ 谷的对称性考虑，从第一性原理推导带隙变化 $\\Delta E_{g}$ 的表达式，该表达式用导带和价带的静水形变势以及应变张量表示。然后，在静水形变势之差满足 $a_{c}-a_{v}=5\\,\\text{eV}$ 的条件下，计算在大小为 $\\epsilon=0.01$ 的微小等双轴拉伸应变下 $\\Delta E_{g}$ 的值。最后，在忽略对带边能量的高阶（二次）应变修正的背景下，讨论当 $\\epsilon=0.01$ 时线性区域的有效性。以电子伏特 (eV) 为单位表示 $\\Delta E_{g}$ 的最终数值，并将答案四舍五入到四位有效数字。",
            "solution": "题目要求推导单层过渡金属硫族化合物 (TMD) 在等双轴应变下直接带隙的变化，对特定应变下该变化的数值进行计算，并讨论所用线性模型的有效性。\n\n首先，我们验证问题陈述的有效性。\n**步骤1：提取已知条件**\n- 系统：在 $K$ 点具有直接带隙的单层TMD。\n- 物理背景：谐波弹性体系，小应变微扰。\n- 应变状态：等双轴，应变张量分量为 $\\epsilon_{xx}=\\epsilon$ 和 $\\epsilon_{yy}=\\epsilon$，且 $\\epsilon_{xy}=0$。\n- 理论模型：线性形变势理论。\n- 能量修正：$\\Delta E = a \\times (\\text{应变张量的标量不变量})$，其中 $a$ 是静水形变势。\n- 参数：静水形变势之差 $a_{c}-a_{v}=5\\,\\text{eV}$。拉伸应变的标量大小 $\\epsilon=0.01$。\n- 任务1：推导带隙变化 $\\Delta E_{g}$ 的表达式。\n- 任务2：根据给定参数计算 $\\Delta E_{g}$。\n- 任务3：讨论当 $\\epsilon=0.01$ 时线性区域的有效性。\n- 输出格式：$\\Delta E_{g}$ 的数值以 eV 为单位，四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了固态物理学的标准概念，如能带理论、应变张量和形变势理论。其语言客观且精确。该问题提法恰当，为求得唯一解提供了所有必要信息。在此主题的理论练习中，给定的数值在物理上是合理的。$\\epsilon = 0.01$（$1\\%$）的应变对于二维材料是实验上可实现的，并且位于线性近似通常被认为有效的范围的边缘，这使得对其有效性进行讨论的要求具有相关性和适当性。问题中没有矛盾、歧义或不可靠的前提。\n\n**步骤3：结论与行动**\n问题有效。我们开始求解。\n\n**第1部分：带隙变化 $\\Delta E_g$ 的推导**\n\n带隙 $E_g$ 定义为导带底 (CBM) 能量 $E_c$ 与价带顶 (VBM) 能量 $E_v$ 之差。对于 $K$ 点的直接带隙，我们有：\n$$E_g = E_c - E_v$$\n当材料受到应变时，带边能量会发生移动。根据问题中陈述的线性形变势理论，带边能量的一阶变化与应变张量的标量不变量成正比。对于一个二维系统，应变张量 $\\boldsymbol{\\epsilon}$ 由下式给出：\n$$\\boldsymbol{\\epsilon} = \\begin{pmatrix} \\epsilon_{xx} & \\epsilon_{xy} \\\\ \\epsilon_{yx} & \\epsilon_{yy} \\end{pmatrix}$$\n主标量不变量是该张量的迹，$\\mathrm{Tr}(\\boldsymbol{\\epsilon}) = \\epsilon_{xx} + \\epsilon_{yy}$。\n\nCBM能量的变化 $\\Delta E_c$ 由其通过导带静水形变势 $a_c$ 与应变的耦合给出：\n$$\\Delta E_c = a_c \\cdot \\mathrm{Tr}(\\boldsymbol{\\epsilon}) = a_c (\\epsilon_{xx} + \\epsilon_{yy})$$\n类似地，VBM能量的变化 $\\Delta E_v$ 由价带静水形变势 $a_v$ 决定：\n$$\\Delta E_v = a_v \\cdot \\mathrm{Tr}(\\boldsymbol{\\epsilon}) = a_v (\\epsilon_{xx} + \\epsilon_{yy})$$\n\n应变下的新带隙 $E'_g$ 是新带边能量之差：\n$$E'_g = (E_c + \\Delta E_c) - (E_v + \\Delta E_v)$$\n因此，带隙的变化 $\\Delta E_g$ 为：\n$$\\Delta E_g = E'_g - E_g = [(E_c + \\Delta E_c) - (E_v + \\Delta E_v)] - (E_c - E_v)$$\n$$\\Delta E_g = \\Delta E_c - \\Delta E_v$$\n代入 $\\Delta E_c$ 和 $\\Delta E_v$ 的表达式：\n$$\\Delta E_g = a_c (\\epsilon_{xx} + \\epsilon_{yy}) - a_v (\\epsilon_{xx} + \\epsilon_{yy})$$\n提出应变项，得到用形变势和应变张量分量表示的带隙变化通用表达式：\n$$\\Delta E_g = (a_c - a_v)(\\epsilon_{xx} + \\epsilon_{yy})$$\n对于所述的等双轴应变特定情况，我们有 $\\epsilon_{xx} = \\epsilon$ 和 $\\epsilon_{yy} = \\epsilon$。表达式简化为：\n$$\\Delta E_g = (a_c - a_v)(2\\epsilon)$$\n这就是推导出的带隙变化表达式。\n\n**第2部分：$\\Delta E_g$ 的数值计算**\n\n给定以下数值：\n- 拉伸应变的标量大小：$\\epsilon = 0.01$。由于是拉伸应变，$\\epsilon$ 为正。\n- 静水形变势之差：$a_c - a_v = 5\\,\\text{eV}$。\n\n将这些值代入我们推导的公式中：\n$$\\Delta E_g = (5\\,\\text{eV}) \\times (2 \\times 0.01)$$\n$$\\Delta E_g = (5\\,\\text{eV}) \\times (0.02)$$\n$$\\Delta E_g = 0.1\\,\\text{eV}$$\n题目要求答案四舍五入到四位有效数字。因此，我们将结果表示为 $0.1000\\,\\text{eV}$。正号表明，在这种特定的拉伸应变和给定的形变势下，带隙增大。\n\n**第3部分：关于线性区域有效性的讨论**\n\n线性形变势理论代表了带边能量对应变的泰勒级数展开的一阶项。完整展开式可以写为：\n$$E(\\epsilon) = E(0) + \\frac{\\partial E}{\\partial \\epsilon}\\bigg|_{\\epsilon=0} \\epsilon + \\frac{1}{2}\\frac{\\partial^2 E}{\\partial \\epsilon^2}\\bigg|_{\\epsilon=0} \\epsilon^2 + O(\\epsilon^3)$$\n如果线性项的贡献远大于二次及更高阶项的贡献，则线性近似是有效的。对于能量的变化，这意味着：\n$$|\\Delta E_{\\text{linear}}| = \\left| \\frac{\\partial E}{\\partial \\epsilon}\\bigg|_{\\epsilon=0} \\epsilon \\right| \\gg |\\Delta E_{\\text{quadratic}}| = \\left| \\frac{1}{2}\\frac{\\partial^2 E}{\\partial \\epsilon^2}\\bigg|_{\\epsilon=0} \\epsilon^2 \\right|$$\n给定的应变大小为 $\\epsilon = 0.01$，对应于 $1\\%$ 的晶格形变。在固态物理学中，$1\\%$ 的应变通常被认为是块状材料线性弹性区域的上限。对于像TMDs这样可能更具柔性的二维材料，这个值仍然相当大，并且处于电子结构中非线性效应可能变得明显的边界上。\n\n忽略二次项的有效性取决于二阶形变势（与 $\\frac{\\partial^2 E}{\\partial \\epsilon^2}$ 相关）相对于一阶势（$a_c$, $a_v$）的大小。在不知道这些二阶系数的情况下，无法对误差进行精确定量。然而，我们可以说，对于 $\\epsilon = 0.01$ 的应变，与 $\\epsilon^2 = 0.0001$ 成比例的二次项贡献可能并非完全可以忽略。对特定TMDs（如 $\\text{MoS}_2$ 或 $\\text{WSe}_2$）的实验和计算研究表明，带隙对应变可以表现出明显的非线性（通常是抛物线形）依赖关系，并且其他现象，如直接到间接带隙的转变，可能在 $1-2\\%$ 范围的应变水平下发生。\n\n总之，虽然线性模型提供了一个有价值且直接的一阶估计，但在 $\\epsilon=0.01$ 时应用它是一种近似。应该意识到，为了更准确的描述，可能需要高阶修正，并且计算出的值 $\\Delta E_g = 0.1000\\,\\text{eV}$ 应被理解为对总带隙变化的领头阶贡献。",
            "answer": "$$\\boxed{0.1000}$$"
        },
        {
            "introduction": "除了改变整体带隙，应变还可以破坏晶体的旋转对称性，从而导致电子能带的各向异性。本练习将带你深入研究 $k \\cdot p$ 微扰理论，这是一个描述布里渊区特定点附近能带色散的强大数学工具。通过这个实践 ，你将推导在单轴应变下，导带有效质量如何呈现各向异性，从而将宏观应变与微观载流子动力学联系起来。",
            "id": "4310018",
            "problem": "考虑一个在不等价能谷处具有直接带隙的单层过渡金属二硫族化物（TMDC），并关注标记为 $K$ 的晶体学点上的能谷。在没有应变的情况下，$K$ 点附近的低能带可以通过一个双带k·p（波矢-动量）哈密顿量来描述，该哈密顿量满足三重旋转对称性（$C_{3}$）和面内镜像对称性。用 $\\hbar$ 表示约化普朗克常数，选择坐标系，使得 $\\hat{x}$ 沿着 $K\\Gamma$ 方向，$\\hat{y}$ 沿着 $KM$ 方向，并令泡利矩阵为 $\\sigma_{x}$、$\\sigma_{y}$ 和 $\\sigma_{z}$。无应变时的哈密顿量形式为 $H_{0} = \\frac{\\Delta}{2}\\sigma_{z} + \\hbar v \\left(k_{x}\\sigma_{x} + k_{y}\\sigma_{y}\\right)$，其中 $\\Delta$ 是带隙，而 $v$ 是一个各向同性的速度参数。现在沿 $\\hat{x}$ 方向施加一个面内单轴应变，由一个小应变参数 $\\varepsilon$ 描述，使得应变张量唯一非零的分量是 $\\varepsilon_{xx} = \\varepsilon$（为简单起见，忽略泊松收缩），并假设对称性允许的对非对角k·p耦合的应变线性修正属于 $E_{2}$ 类型，这种修正破坏了三重旋转对称性，并沿 $\\hat{x}$ 和 $\\hat{y}$ 方向产生了各向异性的速度重整化。在最小的对称性自洽模型中，有应变时的哈密顿量可以写为\n$$\nH = \\frac{\\Delta}{2}\\sigma_{z} + \\hbar v\\left[(1 + \\beta \\varepsilon)k_{x}\\sigma_{x} + (1 - \\beta \\varepsilon)k_{y}\\sigma_{y}\\right],\n$$\n其中 $\\beta$ 是一个无量纲的耦合常数，它参数化了k·p耦合中随应变线变化的各向异性修正。\n\n仅从给定的哈密顿量结构和标准能带理论出发，完成以下任务：\n- 通过证明沿 $K\\Gamma$ 和 $KM$ 方向的色散关系不同，明确展示单轴应变如何破坏 $C_{3}$ 对称性。\n- 将导带色散关系推导至 $k_{x}$ 和 $k_{y}$ 的二次项，并通过在小 $\\boldsymbol{k}$ 极限下与抛物线形式 $E_{c} \\approx E_{c}(0) + \\frac{\\hbar^{2}k_{x}^{2}}{2 m_{x}} + \\frac{\\hbar^{2}k_{y}^{2}}{2 m_{y}}$ 进行匹配，确定沿 $K\\Gamma$ 和 $KM$ 方向的各向异性有效质量 $m_{x}$ 和 $m_{y}$。\n\n将从此应变哈密顿量导出的质量各向异性比率 $m_{x}/m_{y}$，用 $\\beta$ 和 $\\varepsilon$ 表示，作为一个单一的闭合形式解析表达式作为你的最终答案。无需进行数值计算，最终表达式中不应包含单位。",
            "solution": "基本出发点是描述一个有带隙能谷的双带k·p（波矢-动量）哈密顿量，其中导带和价带的基函数构成一个由泡利矩阵描述的有效赝自旋。在没有应变的情况下，$C_{3}$ 三重旋转对称性和面内镜像对称性的组合将 $K$ 点的主导阶k·p哈密顿量限制为各向同性的形式\n$$\nH_{0} = \\frac{\\Delta}{2}\\sigma_{z} + \\hbar v \\left(k_{x}\\sigma_{x} + k_{y}\\sigma_{y}\\right),\n$$\n其中 $\\Delta$ 是能隙，而 $v$ 是一个各向同性的速度参数。$H_{0}$ 的能谱为\n$$\nE_{\\pm}^{(0)}(\\boldsymbol{k}) = \\pm \\sqrt{\\left(\\frac{\\Delta}{2}\\right)^{2} + (\\hbar v)^{2}\\left(k_{x}^{2} + k_{y}^{2}\\right)},\n$$\n该能谱在 $\\boldsymbol{k}$ 空间中是各向同性的，正如 $C_{3}$ 对称性所要求的那样。\n\n在沿 $\\hat{x}$ 方向、由小应变参数 $\\varepsilon$ 描述的单轴应变作用下，且只有 $\\varepsilon_{xx} = \\varepsilon$ 非零（为简单起见，忽略泊松收缩和静水压引起的带隙重整化），应变在 $K$ 点的点群下按 $E_{2}$ 表示变换。k·p理论中不变量的对称性分析允许存在随应变线变化的修正项，这些修正项各向异性地重整化了非对角耦合。与降低了的对称性相符的最小线性应变形式为\n$$\nH = \\frac{\\Delta}{2}\\sigma_{z} + \\hbar v\\left[(1 + \\beta \\varepsilon)k_{x}\\sigma_{x} + (1 - \\beta \\varepsilon)k_{y}\\sigma_{y}\\right],\n$$\n其中 $\\beta$ 是一个无量纲耦合常数。这个哈密顿量显然破坏了三重旋转对称性（$C_{3}$），因为 $k_{x}\\sigma_{x}$ 和 $k_{y}\\sigma_{y}$ 的系数不再相等。因此，沿 $K\\Gamma$（$\\hat{x}$ 方向）和 $KM$（$\\hat{y}$ 方向）的色散关系发生劈裂。\n\n为了获得有应变时的色散关系，我们计算 $H$ 的本征值。哈密顿量的形式为\n$$\nH = \\frac{\\Delta}{2}\\sigma_{z} + \\hbar\\left(v_{x} k_{x}\\sigma_{x} + v_{y} k_{y}\\sigma_{y}\\right),\n$$\n其中速度与方向相关\n$$\nv_{x} = v(1 + \\beta \\varepsilon), \\quad v_{y} = v(1 - \\beta \\varepsilon).\n$$\n能谱为\n$$\nE_{\\pm}(\\boldsymbol{k}) = \\pm \\sqrt{\\left(\\frac{\\Delta}{2}\\right)^{2} + (\\hbar v_{x} k_{x})^{2} + (\\hbar v_{y} k_{y})^{2}}.\n$$\n我们关注导带 $E_{c}(\\boldsymbol{k}) = E_{+}(\\boldsymbol{k})$，并在小 $\\boldsymbol{k}$ 的情况下将其展开到 $k_{x}$ 和 $k_{y}$ 的二次项。使用泰勒展开式\n$$\n\\sqrt{a^{2} + x} = a + \\frac{x}{2a} - \\frac{x^{2}}{8 a^{3}} + \\cdots,\n$$\n并只保留 $\\boldsymbol{k}$ 的主导二次项，我们令 $a = \\Delta/2$ 和 $x = (\\hbar v_{x} k_{x})^{2} + (\\hbar v_{y} k_{y})^{2}$，得到\n$$\nE_{c}(\\boldsymbol{k}) \\approx \\frac{\\Delta}{2} + \\frac{(\\hbar v_{x} k_{x})^{2} + (\\hbar v_{y} k_{y})^{2}}{\\Delta}.\n$$\n为了确定有效质量，我们将其与抛物线形式进行匹配\n$$\nE_{c}(\\boldsymbol{k}) \\approx E_{c}(0) + \\frac{\\hbar^{2}k_{x}^{2}}{2 m_{x}} + \\frac{\\hbar^{2}k_{y}^{2}}{2 m_{y}}.\n$$\n比较系数，我们可以得出\n$$\n\\frac{\\hbar^{2}}{2 m_{x}} = \\frac{\\hbar^{2} v_{x}^{2}}{\\Delta}, \\quad \\frac{\\hbar^{2}}{2 m_{y}} = \\frac{\\hbar^{2} v_{y}^{2}}{\\Delta},\n$$\n这给出了各向异性的有效质量\n$$\nm_{x} = \\frac{\\Delta}{2 v_{x}^{2}} = \\frac{\\Delta}{2 v^{2}(1 + \\beta \\varepsilon)^{2}}, \\quad\nm_{y} = \\frac{\\Delta}{2 v_{y}^{2}} = \\frac{\\Delta}{2 v^{2}(1 - \\beta \\varepsilon)^{2}}.\n$$\n单轴应变通过导致 $v_{x} \\neq v_{y}$ 进而 $m_{x} \\neq m_{y}$ 而明确地破坏了 $C_{3}$ 对称性，这使得沿 $K\\Gamma$（$\\hat{x}$ 方向）和 $KM$（$\\hat{y}$ 方向）的色散关系变得不同。\n\n最后，质量各向异性比率直接可得：\n$$\n\\frac{m_{x}}{m_{y}} = \\frac{\\Delta / \\left[2 v^{2}(1 + \\beta \\varepsilon)^{2}\\right]}{\\Delta / \\left[2 v^{2}(1 - \\beta \\varepsilon)^{2}\\right]} = \\frac{(1 - \\beta \\varepsilon)^{2}}{(1 + \\beta \\varepsilon)^{2}}.\n$$\n这是一个闭合形式的表达式，在上述哈密顿量所使用的 $v_{x}$ 和 $v_{y}$ 的线性应变重整化框架内，对 $\\varepsilon$ 的所有阶次都有效。在小 $\\varepsilon$ 极限下，可以进一步展开得到 $\\frac{m_{x}}{m_{y}} \\approx 1 - 4 \\beta \\varepsilon$，但根据所述模型得到的精确表达式是\n$$\n\\frac{m_{x}}{m_{y}} = \\frac{(1 - \\beta \\varepsilon)^{2}}{(1 + \\beta \\varepsilon)^{2}}.\n$$",
            "answer": "$$\\boxed{\\frac{(1 - \\beta \\varepsilon)^{2}}{(1 + \\beta \\varepsilon)^{2}}}$$"
        },
        {
            "introduction": "理论模型最终需要与实验观测相结合。本练习旨在通过计算模拟，连接单层TMD中激子（电子-空穴对）的理论描述与可测量的吸收光谱。通过这个实践 ，你将学习如何将由自旋轨道耦合产生的A激子和B激子建模为洛伦兹线型，并模拟出完整的光谱，这为了解和解析实验数据提供了宝贵的实践经验。",
            "id": "4310084",
            "problem": "考虑一个单层过渡金属二硫属化物，其基带边附近的光学吸收主要由价带中的自旋轨道耦合产生的两种激子跃迁主导。A激子和B激子在能量上相差一个自旋轨道分裂值$\\Delta_v$，该分裂源于布里渊区角点处顶价带的分裂。在由于有限寿命引起的均匀展宽下，每个离散跃迁的谱线形状可以通过一个由指数衰减的偶极子响应产生的洛伦兹函数来建模。因此，吸收光谱是两个寿命展宽贡献的总和，它们分别以A和B跃迁能量为中心，其振子强度决定了它们的峰值大小。\n\n从以下原理和核心定义出发：\n- 一个阻尼二能级系统的时域偶极子响应是一个指数衰减的正弦波，其在频域中产生一个复极化率，其虚部是能量的洛伦兹函数。\n- 自旋轨道耦合分裂$\\Delta_v$使A和B激子跃迁能量相差$\\Delta_v$。\n- 均匀线宽参数$\\gamma$设定了半高半宽。\n- 振子强度与每个洛伦兹贡献的峰值大小成正比。\n\n您的任务是：\n1. 对于每组提供的参数集，模拟吸收光谱，该光谱为两个洛伦兹贡献的总和。\n2. 通过将双洛伦兹模型拟合到模拟数据，从模拟光谱中识别A和B峰的位置及其峰值强度。将能量较低的峰标记为A峰，能量较高的峰标记为B峰。\n3. 报告每组参数集识别出的峰能量和强度。\n\n所有能量必须以电子伏特（eV）表示。强度是无量纲的。将每个报告的数值输出四舍五入到$4$位小数。\n\n必须遵循的建模假设：\n- 使用从指数衰减偶极子导出的能量域洛伦兹线型，两种激子共享一个单一的均匀线宽参数$\\gamma$。\n- B激子能量是A激子能量加上自旋轨道分裂，即B能量等于A能量加上$\\Delta_v$。\n\n测试套件：\n为以下参数集提供结果，其中每个元组列出$(E_A,\\Delta_v,\\gamma,f_A,f_B,E_{\\min},E_{\\max},\\Delta E)$，所有能量单位均为eV：\n- 情况$1$（一般情况）：$(1.90, 0.18, 0.020, 1.0, 0.6, 1.70, 2.20, 0.0005)$。\n- 情况$2$（窄线宽）：$(2.00, 0.18, 0.005, 0.8, 0.8, 1.90, 2.20, 0.0010)$。\n- 情况$3$（弱B激子）：$(1.95, 0.18, 0.020, 1.0, 0.1, 1.80, 2.20, 0.0005)$。\n- 情况$4$（强重叠）：$(1.98, 0.03, 0.030, 1.0, 0.7, 1.90, 2.10, 0.0002)$。\n\n光谱构建：\n- 定义一个从$E_{\\min}$到$E_{\\max}$，步长为$\\Delta E$的均匀能量网格。\n- A峰的中心位于$E_A$。\n- B峰的中心位于$E_B = E_A + \\Delta_v$。\n- 总光谱是两个洛伦兹贡献的总和，它们具有相同的线宽$\\gamma$，峰值大小分别等于各自的振子强度$f_A$和$f_B$。\n\n峰识别：\n- 使用一个具有共同线宽$\\gamma$的双洛伦兹模型拟合模拟光谱，并提取拟合的峰能量和峰值大小。\n- 确保将能量较低的拟合峰标记为A，能量较高的拟合峰标记为B。\n\n答案规格：\n- 对于每种情况，输出一个列表$[E_A^{\\mathrm{fit}}, f_A^{\\mathrm{fit}}, E_B^{\\mathrm{fit}}, f_B^{\\mathrm{fit}}]$，四舍五入到$4$位小数，其中$E_A^{\\mathrm{fit}}$和$E_B^{\\mathrm{fit}}$的单位是eV，$f_A^{\\mathrm{fit}}$和$f_B^{\\mathrm{fit}}$是无量纲的。\n- 您的程序应生成单行输出，包含一个方括号括起来的逗号分隔列表形式的结果，其中每个情况的结果本身也是一个列表。例如，一个有效的输出格式是$[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\ldots]$。",
            "solution": "离散跃迁附近的吸收光谱可以从一个阻尼二能级系统的线性响应中导出。考虑一个偶极子，它对外电场的响应是时域极化，对于$t \\ge 0$，该极化与$e^{-t/\\tau} \\cos(\\omega_0 t)$成正比，其中$\\tau$是寿命，$\\omega_0$是共振频率。这个阻尼正弦波的傅里叶变换产生一个形式如下的复极化率：\n$$\n\\chi(\\omega) \\propto \\frac{1}{\\omega_0 - \\omega - i \\Gamma},\n$$\n其中阻尼率$\\Gamma$与寿命$\\tau$的关系是$\\Gamma = 1/\\tau$。$\\chi(\\omega)$的虚部是吸收部分，是频率的洛伦兹函数：\n$$\n\\operatorname{Im}\\,\\chi(\\omega) \\propto \\frac{\\Gamma}{(\\omega - \\omega_0)^2 + \\Gamma^2}.\n$$\n通过$E = \\hbar \\omega$映射到能量域，并定义一个能量域均匀线宽参数（半高半宽）为$\\gamma = \\hbar \\Gamma$，能量依赖关系变为\n$$\nL(E; E_0, \\gamma) \\propto \\frac{\\gamma}{(E - E_0)^2 + \\gamma^2}.\n$$\n为了方便算法实现并使振子强度直接等于峰值大小，我们使用重新标度的洛伦兹函数\n$$\n\\tilde{L}(E; E_0, \\gamma) = \\frac{1}{1 + \\left(\\frac{E - E_0}{\\gamma}\\right)^2},\n$$\n其在$E = E_0$处的最大值为$1$。由两个离散激子跃迁引起的吸收光谱被建模为\n$$\nS(E) = f_A \\,\\tilde{L}(E; E_A, \\gamma) + f_B \\,\\tilde{L}(E; E_B, \\gamma),\n$$\n其中$f_A$和$f_B$是振子强度（无量纲的峰值大小），$E_A$是A激子能量，$E_B$是B激子能量。价带中的自旋轨道耦合解除了顶价带的简并，导致两个允许的跃迁，它们相差一个分裂值$\\Delta_v$。在单层过渡金属二硫属化物中，这种分离体现在激子能量上，使得\n$$\nE_B = E_A + \\Delta_v.\n$$\n\n算法流程：\n1.  构建能量网格。对于每个测试用例，在从$E_{\\min}$到$E_{\\max}$的均匀网格上定义$E$，间距为$\\Delta E$。\n2.  使用$E_B = E_A + \\Delta_v$计算B激子能量。\n3.  对于每个网格点$E_j$，使用以下公式模拟光谱\n    $$\n    S(E_j) = f_A \\,\\tilde{L}(E_j; E_A, \\gamma) + f_B \\,\\tilde{L}(E_j; E_B, \\gamma)\n    $$\n4.  通过将一个双洛伦兹模型拟合到$S(E)$来识别峰，其中$\\gamma$保持固定：\n    -   定义模型\n        $$\n        S_{\\text{model}}(E; E_A^{\\mathrm{fit}}, f_A^{\\mathrm{fit}}, E_B^{\\mathrm{fit}}, f_B^{\\mathrm{fit}}) = f_A^{\\mathrm{fit}} \\,\\tilde{L}(E; E_A^{\\mathrm{fit}}, \\gamma) + f_B^{\\mathrm{fit}} \\,\\tilde{L}(E; E_B^{\\mathrm{fit}}, \\gamma).\n        $$\n    -   获取初始猜测值：\n        -   计算$S(E)$的全局最大值位置$E_{\\text{max}}$。\n        -   如果检测到两个不同的局部最大值，则使用它们的位置作为$E_A^{\\mathrm{fit}}$和$E_B^{\\mathrm{fit}}$的初始猜测值（按能量排序），并将初始$f_A^{\\mathrm{fit}}$和$f_B^{\\mathrm{fit}}$设置为这些位置的光谱值。\n        -   如果只检测到一个最大值（强重叠），则使用物理上合理的间隔来设置$E_A^{\\mathrm{fit}} = E_{\\text{max}} - \\Delta_v/2$和$E_B^{\\mathrm{fit}} = E_{\\text{max}} + \\Delta_v/2$，并将初始$f_A^{\\mathrm{fit}}$和$f_B^{\\mathrm{fit}}$设置为这些猜测位置的光谱值。\n    -   使用边界约束拟合：$E_A^{\\mathrm{fit}}$和$E_B^{\\mathrm{fit}}$在$[E_{\\min}, E_{\\max}]$内，且$f_A^{\\mathrm{fit}}, f_B^{\\mathrm{fit}} \\ge 0$。\n    -   执行非线性最小二乘拟合，以最小化网格上$S(E)$和$S_{\\text{model}}(E)$之间的平方误差。\n    -   拟合后，强制执行标记，使得能量较低的拟合峰为A，能量较高的拟合峰为B。如果$E_A^{\\mathrm{fit}} > E_B^{\\mathrm{fit}}$，则交换标签及其大小。\n5.  对每种情况，报告四舍五入到$4$位小数的$E_A^{\\mathrm{fit}}$、$f_A^{\\mathrm{fit}}$、$E_B^{\\mathrm{fit}}$、$f_B^{\\mathrm{fit}}$。\n\n模型合理性论证：\n-   洛伦兹线型$\\tilde{L}(E; E_0, \\gamma)$直接源于阻尼谐振子极化率的虚部，这是描述由均匀寿命效应引起的谱线展宽的标准模型。使用重新标度的形式可确保振子强度乘以峰值大小，而不会将振幅与线宽混淆。\n-   自旋轨道耦合分裂$\\Delta_v$是单层过渡金属二硫属化物在$K$点处一个公认的特征，导致以$\\Delta_v$分隔的不同的A和B激子系列。将它们的吸收建模为两个由$\\Delta_v$分隔并共享一个共同均匀线宽$\\gamma$的离散洛伦兹贡献，这与弱耦合、低温区域的情况一致，并且在没有非均匀展宽的情况下足以进行数值识别。\n\n数值考虑和边缘情况处理：\n-   当峰强重叠时（例如$\\Delta_v \\approx \\gamma$），直接检测局部最大值可能只得到一个最大值；使用已知的物理分离$\\Delta_v$围绕全局最大值初始化拟合可以稳定收敛。\n-   参数的边界可防止出现非物理的负强度，并将拟合能量保持在模拟窗口内。\n-   强制标签确保输出符合按能量排序的A/B命名约定。\n\n最终程序为指定的测试套件实现了上述算法，并在单行上打印所有情况的拟合结果$[E_A^{\\mathrm{fit}}, f_A^{\\mathrm{fit}}, E_B^{\\mathrm{fit}}, f_B^{\\mathrm{fit}}]$列表。能量单位为电子伏特，强度为无量纲，每个值都四舍五入到$4$位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.signal import find_peaks\n\ndef lorentzian_rescaled(E, E0, gamma):\n    \"\"\"\n    Rescaled Lorentzian lineshape:\n    L(E; E0, gamma) = 1 / (1 + ((E - E0)/gamma)^2)\n    Peak height is 1 at E=E0.\n    \"\"\"\n    x = (E - E0) / gamma\n    return 1.0 / (1.0 + x * x)\n\ndef spectrum_two_lorentzians(E, EA, EB, gamma, fA, fB):\n    \"\"\"\n    Sum of two rescaled Lorentzians with peak magnitudes fA and fB.\n    \"\"\"\n    return fA * lorentzian_rescaled(E, EA, gamma) + fB * lorentzian_rescaled(E, EB, gamma)\n\ndef two_lorentz_model(E, EA, fA, EB, fB, gamma):\n    \"\"\"\n    Model function for curve fitting: wrapper that fixes gamma.\n    \"\"\"\n    return spectrum_two_lorentzians(E, EA, EB, gamma, fA, fB)\n\ndef initial_guesses(E, S, delta_v, gamma):\n    \"\"\"\n    Generate robust initial guesses for EA, fA, EB, fB.\n    Use peak finding; if only one is found, place guesses symmetrically\n    around the global maximum using the known separation delta_v.\n    \"\"\"\n    # Find peaks with a small prominence to catch weak peaks\n    prominence = 0.02 * (np.max(S) if np.max(S) > 0 else 1.0)\n    peaks, props = find_peaks(S, prominence=prominence)\n    # Sort peaks by energy\n    peak_energies = E[peaks]\n    peak_heights = S[peaks]\n    # Order by energy\n    order = np.argsort(peak_energies)\n    peak_energies = peak_energies[order]\n    peak_heights = peak_heights[order]\n\n    if len(peak_energies) >= 2:\n        EA_guess = peak_energies[0]\n        EB_guess = peak_energies[1]\n        fA_guess = peak_heights[0]\n        fB_guess = peak_heights[1]\n    else:\n        # Strong overlap or single dominant peak\n        idx_max = np.argmax(S)\n        E_center = E[idx_max]\n        EA_guess = E_center - 0.5 * delta_v\n        EB_guess = E_center + 0.5 * delta_v\n        # Clamp to energy range if needed\n        EA_guess = np.clip(EA_guess, E[0], E[-1])\n        EB_guess = np.clip(EB_guess, E[0], E[-1])\n        # Estimate magnitudes from spectrum at guessed positions\n        fA_guess = S[np.argmin(np.abs(E - EA_guess))]\n        fB_guess = S[np.argmin(np.abs(E - EB_guess))]\n\n    # Ensure A is lower energy than B\n    if EA_guess > EB_guess:\n        EA_guess, EB_guess = EB_guess, EA_guess\n        fA_guess, fB_guess = fB_guess, fA_guess\n\n    # Avoid zero starting magnitudes\n    if fA_guess == 0:\n        fA_guess = np.max(S) * 0.5 if np.max(S) > 0 else 0.5\n    if fB_guess == 0:\n        fB_guess = np.max(S) * 0.3 if np.max(S) > 0 else 0.3\n\n    return EA_guess, fA_guess, EB_guess, fB_guess\n\ndef fit_peaks(E, S, gamma, E_min, E_max, delta_v):\n    \"\"\"\n    Fit the simulated spectrum with a two-Lorentzian model with fixed gamma.\n    Returns fitted EA, fA, EB, fB ensuring EA < EB (A is the lower-energy peak).\n    \"\"\"\n    EA0, fA0, EB0, fB0 = initial_guesses(E, S, delta_v, gamma)\n    # Bounds: energies within [E_min, E_max], magnitudes nonnegative, allow up to a large upper bound\n    maxS = float(np.max(S))\n    mag_upper = max(10.0, 5.0 * maxS)  # generous upper bound\n    bounds_lower = [E_min, 0.0, E_min, 0.0]\n    bounds_upper = [E_max, mag_upper, E_max, mag_upper]\n\n    # Define a wrapper for curve_fit with fixed gamma\n    def model_wrapper(Egrid, EA_fit, fA_fit, EB_fit, fB_fit):\n        return two_lorentz_model(Egrid, EA_fit, fA_fit, EB_fit, fB_fit, gamma)\n\n    # Perform the fit\n    try:\n        popt, _ = curve_fit(\n            model_wrapper,\n            E,\n            S,\n            p0=[EA0, fA0, EB0, fB0],\n            bounds=(bounds_lower, bounds_upper),\n            maxfev=20000\n        )\n    except Exception:\n        # Fallback: return initial guesses if fit fails\n        EA_fit, fA_fit, EB_fit, fB_fit = EA0, fA0, EB0, fB0\n    else:\n        EA_fit, fA_fit, EB_fit, fB_fit = popt\n\n    # Ensure A is lower energy than B\n    if EA_fit > EB_fit:\n        EA_fit, EB_fit = EB_fit, EA_fit\n        fA_fit, fB_fit = fB_fit, fA_fit\n\n    return EA_fit, fA_fit, EB_fit, fB_fit\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (E_A, delta_v, gamma, f_A, f_B, E_min, E_max, dE)\n    test_cases = [\n        (1.90, 0.18, 0.020, 1.0, 0.6, 1.70, 2.20, 0.0005),  # Case 1\n        (2.00, 0.18, 0.005, 0.8, 0.8, 1.90, 2.20, 0.0010),  # Case 2\n        (1.95, 0.18, 0.020, 1.0, 0.1, 1.80, 2.20, 0.0005),  # Case 3\n        (1.98, 0.03, 0.030, 1.0, 0.7, 1.90, 2.10, 0.0002),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        EA, delta_v, gamma, fA, fB, Emin, Emax, dE = case\n        EB = EA + delta_v\n        # Energy grid\n        n_steps = int(np.floor((Emax - Emin) / dE)) + 1\n        E = np.linspace(Emin, Emin + dE * (n_steps - 1), n_steps)\n        # Simulate spectrum\n        S = spectrum_two_lorentzians(E, EA, EB, gamma, fA, fB)\n        # Fit peaks\n        EA_fit, fA_fit, EB_fit, fB_fit = fit_peaks(E, S, gamma, Emin, Emax, delta_v)\n        # Round to 4 decimals\n        out = [\n            round(float(EA_fit), 4),\n            round(float(fA_fit), 4),\n            round(float(EB_fit), 4),\n            round(float(fB_fit), 4),\n        ]\n        results.append(out)\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of lists\n    def format_list(lst):\n        return \"[\" + \",\".join(map(str, lst)) + \"]\"\n    print(\"[\" + \",\".join(format_list(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}