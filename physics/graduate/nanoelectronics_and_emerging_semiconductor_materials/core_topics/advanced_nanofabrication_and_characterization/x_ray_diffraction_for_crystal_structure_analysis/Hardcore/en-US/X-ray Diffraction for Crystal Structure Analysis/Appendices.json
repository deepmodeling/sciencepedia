{
    "hands_on_practices": [
        {
            "introduction": "This exercise connects the abstract concept of crystal structure to the measurable intensities in a diffraction pattern. By calculating the structure factor, $F(hkl)$, for the diamond cubic lattice—a structure of immense importance in semiconductors—you will see how the specific arrangement of atoms within the unit cell leads to systematic extinctions and modulates peak intensities. This fundamental practice reinforces the core principle that a diffraction pattern is essentially the Fourier transform of the crystal's electron density distribution .",
            "id": "4312695",
            "problem": "In X-ray diffraction (XRD) of a diamond crystal of space group $Fd\\bar{3}m$ and lattice parameter $a$, the crystal can be represented as a face-centered cubic (fcc) Bravais lattice with primitive basis of two identical atoms located at fractional coordinates $\\mathbf{d}_{1} = (0,0,0)$ and $\\mathbf{d}_{2} = \\left(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4}\\right)$ relative to the conventional cubic cell. Consider a powder measurement using copper K$\\alpha$ radiation, and treat the atomic form factor $f(Q)$ as a scalar that depends only on the magnitude of the scattering vector $Q = |\\mathbf{G}|$, where $\\mathbf{G}$ is a reciprocal lattice vector associated with Miller indices $(hkl)$. The structure factor $F(\\mathbf{G})$ is defined by the fundamental expression\n$$\nF(\\mathbf{G}) = \\sum_{n} f_{n}(Q) \\exp\\!\\left(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{r}_{n}\\right),\n$$\nwhere the sum is over all atoms in the conventional cell at positions $\\mathbf{r}_{n} = \\mathbf{t}_{\\alpha} + \\mathbf{d}_{\\beta}$ with $\\mathbf{t}_{\\alpha}$ the fcc Bravais translations $\\mathbf{t}_{0} = (0,0,0)$, $\\mathbf{t}_{1} = \\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$, $\\mathbf{t}_{2} = \\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$, and $\\mathbf{t}_{3} = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$, and $\\mathbf{d}_{\\beta} \\in \\{\\mathbf{d}_{1}, \\mathbf{d}_{2}\\}$ as specified above. Assume the two basis atoms are identical (e.g., silicon) so that $f_{1}(Q) = f_{2}(Q) = f(Q)$, neglect thermal motion and extinction, and ignore Lorentz-polarization and absorption effects.\n\n(a) Starting from the above definition and the face-centered cubic (fcc) translations, derive the closed-form expression for the structure factor $F(hkl)$ for the diamond basis, and then specialize it to the case $(111)$ to obtain an explicit complex amplitude in terms of $f(Q)$.\n\n(b) Using the derived amplitudes, compute the powder intensity ratio $I_{111}/I_{220}$ by combining the squared structure factor magnitudes with the multiplicity $m_{hkl}$ of each family of planes in a cubic crystal. For the cubic multiplicities, use $m_{111} = 8$ and $m_{220} = 12$. To incorporate atomic form factor decay with increasing $Q$, use the following empirically reasonable values at the corresponding scattering vectors for silicon under copper K$\\alpha$ radiation: $f_{111} = 13.6$ (in electrons) and $f_{220} = 12.2$ (in electrons), where $f_{hkl}$ denotes $f(Q)$ evaluated at the $Q$ for $(hkl)$.\n\nExplain qualitatively, in addition to the calculation, why the $(111)$ reflection is weak relative to $(220)$ in the diamond structure by referring to the diamond basis interference and the multiplicity. Finally, provide the numerical value of $I_{111}/I_{220}$ and round your answer to $3$ significant figures. Express the final intensity ratio as a pure decimal (dimensionless).",
            "solution": "The problem asks for the derivation of the structure factor for a diamond cubic lattice, its application to the $(111)$ and $(220)$ reflections, a qualitative explanation for their relative intensities, and a calculation of the powder intensity ratio $I_{111}/I_{220}$.\n\n(a) Derivation of the Structure Factor $F(hkl)$ and $F(111)$\n\nThe structure factor $F(\\mathbf{G})$ for a crystal is defined as a sum over all atoms within one conventional unit cell. The position of an atom $n$ is given by $\\mathbf{r}_{n}$.\n$$\nF(\\mathbf{G}) = \\sum_{n} f_{n}(Q) \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{r}_{n})\n$$\nFor the diamond lattice, the atoms are identical, so $f_n(Q) = f(Q)$. The atom positions $\\mathbf{r}_n$ are specified as $\\mathbf{r}_{n} = \\mathbf{t}_{\\alpha} + \\mathbf{d}_{\\beta}$, where $\\mathbf{t}_{\\alpha}$ are the face-centered cubic (fcc) lattice translations and $\\mathbf{d}_{\\beta}$ are the basis vector positions. The sum can be factored into a product of a sum over the basis vectors and a sum over the lattice points:\n$$\nF(\\mathbf{G}) = f(Q) \\sum_{\\beta} \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{d}_{\\beta}) \\sum_{\\alpha} \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{t}_{\\alpha})\n$$\nThis can be written as $F(\\mathbf{G}) = f(Q) S_{\\text{basis}} S_{\\text{lattice}}$.\n\nA reciprocal lattice vector $\\mathbf{G}$ corresponding to Miller indices $(hkl)$ for a cubic lattice with parameter $a$ is $\\mathbf{G} = \\frac{2\\pi}{a}(h, k, l)$. The position vectors $\\mathbf{r}$ are given in fractional coordinates of the conventional cell axes, $\\mathbf{r} = a(u, v, w)$. The dot product in the exponential term is:\n$$\n\\mathbf{G} \\cdot \\mathbf{r} = \\frac{2\\pi}{a}(h, k, l) \\cdot a(u, v, w) = 2\\pi (hu + kv + lw)\n$$\nFirst, we evaluate the lattice sum $S_{\\text{lattice}}$ for the fcc translations $\\mathbf{t}_{0}=(0,0,0)$, $\\mathbf{t}_{1}=\\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$, $\\mathbf{t}_{2}=\\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$, and $\\mathbf{t}_{3}=\\left(\\frac{1}{2},\\frac{1}{2},0\\right)$.\n$$\nS_{\\text{lattice}} = \\sum_{\\alpha=0}^{3} \\exp(2\\pi i (h u_{\\alpha} + k v_{\\alpha} + l w_{\\alpha}))\n$$\n$$\nS_{\\text{lattice}} = \\exp(0) + \\exp\\left(2\\pi i \\left(k\\frac{1}{2} + l\\frac{1}{2}\\right)\\right) + \\exp\\left(2\\pi i \\left(h\\frac{1}{2} + l\\frac{1}{2}\\right)\\right) + \\exp\\left(2\\pi i \\left(h\\frac{1}{2} + k\\frac{1}{2}\\right)\\right)\n$$\n$$\nS_{\\text{lattice}} = 1 + \\exp(\\pi i (k+l)) + \\exp(\\pi i (h+l)) + \\exp(\\pi i (h+k))\n$$\nSince $\\exp(\\pi i n) = (-1)^n$ for integer $n$, this sum is non-zero only if the indices $h,k,l$ have unmixed parity (are all even or all odd). In that case, $k+l$, $h+l$, and $h+k$ are all even, and $S_{\\text{lattice}} = 1+1+1+1=4$. If the parities are mixed, the sum is $0$. This is the well-known selection rule for the fcc Bravais lattice.\n\nNext, we evaluate the basis structure factor $S_{\\text{basis}}$ for the two-atom basis at $\\mathbf{d}_{1}=(0,0,0)$ and $\\mathbf{d}_{2}=\\left(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4}\\right)$.\n$$\nS_{\\text{basis}} = \\sum_{\\beta=1}^{2} \\exp(2\\pi i (h u_{\\beta} + k v_{\\beta} + l w_{\\beta}))\n$$\n$$\nS_{\\text{basis}} = \\exp(0) + \\exp\\left(2\\pi i \\left(h\\frac{1}{4} + k\\frac{1}{4} + l\\frac{1}{4}\\right)\\right)\n$$\n$$\nS_{\\text{basis}} = 1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\n$$\nCombining these results, the structure factor for the diamond cubic lattice is:\n$$\nF(hkl) = f(Q) \\left[1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\\right] \\left[1 + \\exp(\\pi i (k+l)) + \\exp(\\pi i (h+l)) + \\exp(\\pi i (h+k))\\right]\n$$\nThis simplifies based on the selection rules. For non-zero reflections, $h,k,l$ must be all even or all odd, for which $S_{\\text{lattice}}=4$. Thus, for allowed reflections:\n$$\nF(hkl) = 4f(Q)\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\\right]\n$$\nWe must also consider the condition from $S_{\\text{basis}}$. If $h,k,l$ are all even, then $h+k+l$ is an even integer. Let $h+k+l = S$.\nIf $S=4n$ (e.g., for $(220)$, $S=4$), then $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2} (4n)) = 1+1=2$. So $F_{hkl} = 8f(Q)$.\nIf $S=4n+2$ (e.g., for $(200)$, $S=2$), then $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2} (4n+2)) = 1+\\exp(\\pi i) = 1-1=0$. So $F_{hkl} = 0$. This is the diamond glide extinction rule.\nIf $h,k,l$ are all odd, then $h+k+l$ is an odd integer, $S=2n+1$. Then $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2}(2n+1)) = 1 \\pm i$. So $|S_{\\text{basis}}|^2=2$.\nIn summary, the allowed reflections $(hkl)$ for the diamond cubic structure are those where $h,k,l$ are all odd, or all even with a sum $h+k+l=4n$.\n\nFor the specific case of $(hkl)=(111)$:\nThe indices are all odd. $h+k+l=1+1+1=3$. The fcc condition is satisfied.\n$$\nF(111) = 4f_{111}\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(3)\\right)\\right] = 4f_{111}\\left[1 + \\exp\\left(\\frac{3\\pi i}{2}\\right)\\right]\n$$\nSince $\\exp\\left(\\frac{3\\pi i}{2}\\right) = \\cos(\\frac{3\\pi}{2}) + i\\sin(\\frac{3\\pi}{2}) = 0 - i = -i$, the complex amplitude is:\n$$\nF(111) = 4f_{111}(1-i)\n$$\n\n(b) Intensity Ratio $I_{111}/I_{220}$ and Qualitative Explanation\n\nFirst, we find the structure factor for the $(220)$ reflection. The indices are all even, and their sum is $h+k+l = 2+2+0=4$. This is of the form $4n$ with $n=1$, so the reflection is allowed.\n$$\nF(220) = 4f_{220}\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(4)\\right)\\right] = 4f_{220}[1 + \\exp(2\\pi i)]\n$$\nSince $\\exp(2\\pi i) = 1$, the amplitude is:\n$$\nF(220) = 8f_{220}\n$$\nThe intensity of a powder diffraction peak is proportional to the multiplicity of the plane family $m_{hkl}$ and the squared magnitude of the structure factor $|F(hkl)|^2$.\n$$\nI_{hkl} \\propto m_{hkl} |F(hkl)|^2\n$$\nThe squared magnitudes are:\n$$\n|F(111)|^2 = |4f_{111}(1-i)|^2 = (4f_{111})^2 |1-i|^2 = 16f_{111}^2 (1^2 + (-1)^2) = 32f_{111}^2\n$$\n$$\n|F(220)|^2 = |8f_{220}|^2 = 64f_{220}^2\n$$\nThe intensity ratio is:\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{m_{111} |F(111)|^2}{m_{220} |F(220)|^2} = \\frac{8 \\times 32f_{111}^2}{12 \\times 64f_{220}^2}\n$$\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{256}{768} \\frac{f_{111}^2}{f_{220}^2} = \\frac{1}{3} \\left(\\frac{f_{111}}{f_{220}}\\right)^2\n$$\n\nQualitatively, the weakness of the $(111)$ reflection relative to the $(220)$ reflection is primarily due to two factors: the interference from the basis atoms and the multiplicity, which are partially offset by the atomic form factor.\n1.  Basis Interference: The term $|S_{\\text{basis}}|^2$ reflects the interference between waves scattered by the two atoms in the basis. For the $(111)$ reflection, the phase difference between the atoms at $(0,0,0)$ and $(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4})$ is $\\frac{\\pi}{2}(1+1+1) = \\frac{3\\pi}{2}$. The amplitudes add as $1+\\exp(i3\\pi/2) = 1-i$, leading to $|S_{\\text{basis}}|^2=2$ (partially destructive interference). For the $(220)$ reflection, the phase difference is $\\frac{\\pi}{2}(2+2+0) = 2\\pi$. The amplitudes add as $1+\\exp(i2\\pi) = 2$, leading to $|S_{\\text{basis}}|^2=4$ (fully constructive interference). This factor alone makes the $(220)$ reflection's $|F|^2$ contribution twice as strong as that of the $(111)$ reflection.\n2.  Multiplicity: The $\\{220\\}$ family of planes has a multiplicity $m_{220}=12$, while the $\\{111\\}$ family has $m_{111}=8$. This means there are $1.5$ times more planes contributing to the $(220)$ powder peak, further enhancing its intensity relative to the $(111)$ peak.\n3.  Atomic Form Factor: The form factor $f(Q)$ decreases with increasing scattering vector magnitude $Q$. Since $Q \\propto \\sqrt{h^2+k^2+l^2}$, $Q_{220} (\\propto \\sqrt{8})$ is greater than $Q_{111} (\\propto \\sqrt{3})$. Therefore, $f_{220}  f_{111}$. This effect tends to decrease the intensity of the $(220)$ reflection relative to $(111)$, but it is not strong enough to overcome the combined effects of basis interference and multiplicity.\n\nNow, we compute the numerical value using the provided data: $m_{111}=8$, $m_{220}=12$, $f_{111}=13.6$, and $f_{220}=12.2$.\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{1}{3} \\left(\\frac{13.6}{12.2}\\right)^2 \\approx \\frac{1}{3} (1.11475)^2 \\approx \\frac{1}{3} (1.24268) \\approx 0.414227\n$$\nRounding to $3$ significant figures, the intensity ratio is $0.414$.",
            "answer": "$$\n\\boxed{0.414}\n$$"
        },
        {
            "introduction": "An ideal diffraction pattern is rarely achieved in practice; experimental realities introduce systematic errors that must be understood and corrected. This practice delves into the origins of two common errors in Bragg–Brentano geometry: intensity loss due to absorption and peak position shifts due to sample displacement. By deriving the correction factors from first principles—the Beer–Lambert law and goniometer geometry—you will gain a deeper appreciation for the instrumental function and the necessity of careful sample preparation and alignment for accurate data analysis .",
            "id": "4312767",
            "problem": "A flat-plate thin film of a two-dimensional transition metal dichalcogenide used in nanoelectronics is measured in symmetric reflection geometry using X-ray diffraction (XRD). The diffractometer operates in Bragg–Brentano focusing with a goniometer circle of radius $R$, X-ray wavelength $\\lambda$, and linear attenuation coefficient of the film $\\mu$ at this wavelength. The film has thickness $t$ and crystallographic planes at spacing $d$ produce a Bragg peak at angle $\\theta$ that satisfies Bragg’s law. Due to imperfect mounting, the sample surface is displaced by a small amount $\\Delta$ along the axis normal to the diffractometer plane, with $\\Delta0$ defined as a displacement that raises the sample toward the source and detector.\n\nStarting only from the Beer–Lambert attenuation law and the geometric definition of Bragg–Brentano focusing (no pre-derived correction formulas), and assuming the kinematic scattering regime for integrated intensity, do the following:\n\n1. Derive the absorption correction factor for the integrated diffracted intensity of this flat-plate specimen in symmetric reflection as a function of $\\theta$, $\\mu$, and $t$, by integrating the contribution from depth $x$ within the film.\n\n2. Using the focusing-circle geometry and small-displacement linearization, derive the change in the reported peak position in terms of the $2\\theta$ angle due to the sample displacement $\\Delta$. Express the final $2\\theta$ shift as an analytic expression in terms of $\\Delta$, $R$, and $\\theta$, with the sign convention stipulated above.\n\nExpress the final angle shift in radians. The final answer must be a single closed-form analytic expression for the $2\\theta$ shift.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, and objective. It consists of two standard derivations in the field of X-ray diffraction theory based on fundamental principles.\n\nThe solution is presented in two parts as requested by the problem statement.\n\nPart 1: Derivation of the Absorption Correction Factor\n\nThe problem asks for the absorption correction factor for the integrated diffracted intensity from a flat-plate thin film of thickness $t$ in symmetric reflection geometry. We start from the Beer–Lambert law.\n\nIn symmetric reflection, the incident X-ray beam makes an angle $\\theta$ with the sample surface, and the diffracted beam also makes an angle $\\theta$ with the surface. The total angle between the incident and diffracted beams is $2\\theta$.\n\nLet us consider a differential layer of the film of thickness $dx$ at a depth $x$ below the surface, where $x$ is measured normal to the surface. For an X-ray to be diffracted by this layer and exit the sample, it must travel through the material.\n\nThe path length of the incident beam to reach this layer at depth $x$ is given by $L_{in} = \\frac{x}{\\sin\\theta}$.\nThe path length of the diffracted beam to exit the film from this same layer is $L_{out} = \\frac{x}{\\sin\\theta}$.\n\nThe total path length of the X-ray beam within the film for diffraction occurring at depth $x$ is the sum of the incident and exit path lengths:\n$$L(x) = L_{in} + L_{out} = \\frac{2x}{\\sin\\theta}$$\n\nAccording to the Beer–Lambert law, the intensity of an X-ray beam is attenuated by a factor of $\\exp(-\\mu L)$ after traveling a distance $L$ through a material with a linear attenuation coefficient $\\mu$. Therefore, the intensity of the beam diffracted from the layer at depth $x$ is reduced by a factor of $\\exp(-\\mu L(x))$.\n\nThe intensity diffracted by the differential layer $dx$ at depth $x$, denoted $dI$, is proportional to the incident intensity, the volume of the layer, and the attenuation factor. Assuming a beam of unit cross-sectional area illuminating the sample, the volume of the layer is proportional to $dx$. Thus:\n$$dI \\propto \\exp(-\\mu L(x)) \\, dx = \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) dx$$\n\nThe total integrated intensity, $I_{int}$, is obtained by integrating this contribution over the entire thickness of the film, from the surface ($x=0$) to the bottom of the film ($x=t$). This integrated value itself is the absorption correction factor, which we will denote as $A(\\theta, \\mu, t)$.\n$$A(\\theta, \\mu, t) = \\int_0^t \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) dx$$\n\nTo evaluate the integral, we can perform a direct integration with respect to $x$:\n$$A(\\theta, \\mu, t) = \\left[ \\frac{1}{-\\frac{2\\mu}{\\sin\\theta}} \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) \\right]_0^t$$\n$$A(\\theta, \\mu, t) = -\\frac{\\sin\\theta}{2\\mu} \\left[ \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) \\right]_0^t$$\n$$A(\\theta, \\mu, t) = -\\frac{\\sin\\theta}{2\\mu} \\left( \\exp\\left(-\\frac{2\\mu t}{\\sin\\theta}\\right) - \\exp(0) \\right)$$\n$$A(\\theta, \\mu, t) = \\frac{\\sin\\theta}{2\\mu} \\left( 1 - \\exp\\left(-\\frac{2\\mu t}{\\sin\\theta}\\right) \\right)$$\nThis expression is the absorption correction factor for the integrated intensity as a function of $\\theta$, $\\mu$, and $t$.\n\nPart 2: Derivation of the Peak Position Shift\n\nThe problem asks for the change in the reported peak position, $\\delta(2\\theta)$, due to a sample displacement $\\Delta$. The geometry is a Bragg–Brentano diffractometer with goniometer radius $R$. The displacement $\\Delta$ is along the normal to the sample surface, with $\\Delta  0$ indicating the sample is raised toward the source and detector, which is the standard convention for a sample surface that is \"too high\".\n\nLet us establish a coordinate system to analyze the geometry. Let the goniometer axis (the intended diffraction point) be at the origin $O=(0,0)$. Let the ideal sample surface lie along the x-axis. The sample surface normal is along the y-axis. The incident X-ray beam makes an angle $\\theta$ with the surface. For a beam arriving from the left, its path is described by the line $y = -x\\tan\\theta$, as it is aimed at the origin $O$.\n\nA displacement of $\\Delta$ raises the sample surface to the plane $y=\\Delta$. The incident beam, still aimed at $O$, will now intersect this displaced surface at a point $P$. To find the coordinates of $P$, we set $y=\\Delta$ in the equation for the beam path:\n$$\\Delta = -x_P \\tan\\theta \\implies x_P = -\\frac{\\Delta}{\\tan\\theta} = -\\Delta\\cot\\theta$$\nSo, the point of diffraction is $P = (-\\Delta\\cot\\theta, \\Delta)$. The vector from the ideal diffraction point $O$ to the actual diffraction point $P$ is $\\vec{OP} = (-\\Delta\\cot\\theta, \\Delta)$.\n\nIn the ideal case, the beam diffracted from $O$ travels towards the detector. The direction of this diffracted beam is at an angle $\\theta$ with the surface (the x-axis), so its unit direction vector is $\\hat{k}_{out} = (\\cos\\theta, \\sin\\theta)$. The detector is positioned at a distance $R$ from $O$ along this direction.\n\nDue to the displacement, the diffracted beam originates from $P$ but travels in the same direction $\\hat{k}_{out}$ (since the crystallographic orientation of the sample is unchanged). This means the new diffracted ray is parallel to the ideal one but is displaced. We need to find the effect of this displacement at the detector circle of radius $R$.\n\nThe lateral shift, $s$, of the diffracted beam is the perpendicular distance between the ideal ray (from $O$) and the actual ray (from $P$). This distance is the magnitude of the projection of the displacement vector $\\vec{OP}$ onto the direction perpendicular to the diffracted beam $\\hat{k}_{out}$.\n\nThe unit vector perpendicular to $\\hat{k}_{out}$ is $\\hat{n}_{out} = (-\\sin\\theta, \\cos\\theta)$. The lateral shift $s_{beam}$ is the absolute value of the scalar projection of $\\vec{OP}$ onto $\\hat{n}_{out}$:\n$$s_{beam} = |\\vec{OP} \\cdot \\hat{n}_{out}| = |(-\\Delta\\cot\\theta)(-\\sin\\theta) + (\\Delta)(\\cos\\theta)|$$\n$$s_{beam} = \\left|-\\Delta\\frac{\\cos\\theta}{\\sin\\theta}(-\\sin\\theta) + \\Delta\\cos\\theta\\right| = |\\Delta\\cos\\theta + \\Delta\\cos\\theta| = |2\\Delta\\cos\\theta|$$\nSince $\\Delta  0$ and for typical diffraction angles $0  \\theta  90^\\circ$, $\\cos\\theta  0$, the lateral displacement of the beam is $s = 2\\Delta\\cos\\theta$.\n\nThis lateral displacement $s$ causes the beam to strike the detector circle at a shifted angular position. The angular shift in the detector position, $\\delta(2\\theta)$, is given by the arc length divided by the radius $R$. For a small displacement, we can approximate the arc length by the lateral shift $s$.\n$$|\\delta(2\\theta)| \\approx \\frac{s}{R} = \\frac{2\\Delta\\cos\\theta}{R}$$\nThe result is in radians, as required.\n\nFinally, we must determine the sign of the shift. A positive displacement $\\Delta$ (sample too high) causes the beam to strike the sample at point $P$ before it reaches the intended point $O$. From our coordinate system, $x_P = -\\Delta\\cot\\theta$ is negative for $\\theta \\in (0, \\pi/2)$. The diffraction point $P$ is shifted \"upstream\" relative to the beam path. The diffracted ray path is likewise shifted. An observer at the detector circle would see the ray arriving from a position corresponding to a smaller angle. Therefore, the measured angle $2\\theta_{meas}$ is less than the true angle $2\\theta_{true}$, and the shift $\\delta(2\\theta) = 2\\theta_{meas} - 2\\theta_{true}$ is negative.\n\nThus, the change in the reported peak position is:\n$$\\delta(2\\theta) = -\\frac{2\\Delta\\cos\\theta}{R}$$\nThis expression gives the peak shift in radians as a function of $\\Delta$, $R$, and $\\theta$.",
            "answer": "$$\\boxed{-\\frac{2\\Delta\\cos\\theta}{R}}$$"
        },
        {
            "introduction": "Building on the understanding of systematic errors, this computational exercise introduces a powerful method for obtaining highly accurate lattice parameters. You will implement the Cohen extrapolation method, a classic technique that models the angular dependence of systematic errors (such as the sample displacement error derived in ) and extrapolates to an error-free value. This hands-on programming task bridges the gap between theoretical error analysis and practical, high-precision materials characterization .",
            "id": "4312758",
            "problem": "You will implement a program that refines the cubic lattice parameter $a$ from X-ray diffraction (XRD) measurements using the Cohen method to correct systematic errors such as sample displacement and transparency. The method proceeds by computing the per-peak lattice parameter $a_{hkl}(\\theta)$ from Bragg's law and the cubic geometry, then performing a linear regression of $\\Delta a$ versus the Cohen extrapolation function $f(\\theta) = \\cos^2 \\theta / \\sin \\theta$. The refined parameter $a_{\\text{refined}}$ is obtained by extrapolating to $f(\\theta) \\to 0$. All angles are specified in degrees and must be internally converted to radians for computation. The final answers must be expressed in ångströms (Å), rounded to five decimal places.\n\nFundamental base:\n- Bragg's law for first-order diffraction: $n \\lambda = 2 d \\sin \\theta$, with $n=1$.\n- Cubic crystal geometry: $d_{hkl} = a / \\sqrt{h^2 + k^2 + l^2}$.\n\nFrom these, compute the per-peak lattice parameter as:\n$$\na_{hkl}(\\theta) = \\frac{\\lambda \\sqrt{h^2 + k^2 + l^2}}{2 \\sin \\theta}.\n$$\nDefine the Cohen extrapolation function:\n$$\nf(\\theta) = \\frac{\\cos^2 \\theta}{\\sin \\theta}.\n$$\nDefine per-peak deviation relative to an initial reference $a_{\\mathrm{ref}}$:\n$$\n\\Delta a_i = a_{hkl,i} - a_{\\mathrm{ref}}.\n$$\nModel the systematic error via linear regression:\n$$\n\\Delta a_i \\approx m f(\\theta_i) + b,\n$$\nand obtain the refined lattice parameter by the extrapolated intercept:\n$$\na_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b.\n$$\n\nAlgorithmic requirements:\n1. For each test case, convert the provided $2\\theta$ values (in degrees) to $\\theta$ in radians via $\\theta = (2\\theta) / 2$ and degrees-to-radians conversion.\n2. For each peak $(h,k,l)$ and its $\\theta$, compute $a_{hkl}$ using the formulas above.\n3. Compute $\\Delta a_i$ for each peak relative to the given $a_{\\mathrm{ref}}$.\n4. Compute $f(\\theta_i)$ for each peak.\n5. Fit a straight line $\\Delta a_i$ versus $f(\\theta_i)$ using least squares to obtain slope $m$ and intercept $b$.\n6. Compute $a_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b$.\n7. Report $a_{\\mathrm{refined}}$ in ångströms (Å), rounded to five decimal places.\n\nAngle unit requirement:\n- All input angles are $2\\theta$ in degrees; you must convert them to $\\theta$ in radians before using trigonometric functions.\n\nFinal output format:\n- Your program should produce a single line of output containing the refined lattice parameters for all test cases as a comma-separated list enclosed in square brackets, each value rounded to five decimal places in ångströms (Å). For example: $[5.43100,5.65200,3.90500,5.64000]$.\n\nTest suite:\nProvide and process the following scientifically plausible test cases. Use the specified parameters without alteration.\n\n- Test Case 1 (silicon-like, multiple mid-angle peaks):\n  - Wavelength: $\\lambda = 1.5406$ Å.\n  - Initial reference: $a_{\\mathrm{ref}} = 5.4300$ Å.\n  - Reflections $(h,k,l)$: $(1,1,1)$, $(2,2,0)$, $(3,1,1)$, $(4,0,0)$.\n  - Measured $2\\theta$ (degrees): $28.44$, $47.29$, $56.18$, $69.12$.\n\n- Test Case 2 (gallium arsenide-like, high-angle peaks):\n  - Wavelength: $\\lambda = 1.5406$ Å.\n  - Initial reference: $a_{\\mathrm{ref}} = 5.6500$ Å.\n  - Reflections $(h,k,l)$: $(4,0,0)$, $(3,3,1)$, $(4,2,2)$.\n  - Measured $2\\theta$ (degrees): $66.10$, $72.89$, $75.17$.\n\n- Test Case 3 (strontium titanate-like, low-angle peaks, simple cubic):\n  - Wavelength: $\\lambda = 1.5406$ Å.\n  - Initial reference: $a_{\\mathrm{ref}} = 3.9000$ Å.\n  - Reflections $(h,k,l)$: $(1,0,0)$, $(1,1,0)$, $(1,1,1)$.\n  - Measured $2\\theta$ (degrees): $22.76$, $32.33$, $39.72$.\n\n- Test Case 4 (sodium chloride-like, minimal two peaks):\n  - Wavelength: $\\lambda = 1.5406$ Å.\n  - Initial reference: $a_{\\mathrm{ref}} = 5.6350$ Å.\n  - Reflections $(h,k,l)$: $(2,0,0)$, $(2,2,0)$.\n  - Measured $2\\theta$ (degrees): $31.68$, $45.48$.\n\nYour program must implement the above method and produce the final output line in the exact required format. No user input is allowed; all data must be embedded in the program.",
            "solution": "The problem presented requires the implementation of a computational procedure to refine the lattice parameter of a cubic crystal from X-ray diffraction (XRD) data. This will be accomplished using the Cohen method, a classical technique for systematic error correction. The validation of the problem statement confirms that it is scientifically sound, well-posed, and complete. All provided data and physical constants are plausible and consistent with established principles of crystallography and solid-state physics. We may therefore proceed with a formal solution.\n\nThe foundation of this analysis rests on two fundamental principles: Bragg's law and the geometry of a cubic lattice.\n\nFirst, Bragg's law describes the condition for constructive interference of X-rays diffracted by a set of parallel crystal planes. For first-order diffraction ($n=1$), it is expressed as:\n$$\n\\lambda = 2 d_{hkl} \\sin\\theta\n$$\nHere, $\\lambda$ is the wavelength of the incident X-rays, $d_{hkl}$ is the interplanar spacing for the set of crystallographic planes denoted by Miller indices $(h,k,l)$, and $\\theta$ is the angle of incidence, which is half the measured diffraction angle $2\\theta$.\n\nSecond, for a cubic crystal system, the interplanar spacing $d_{hkl}$ is related to the lattice parameter $a$ by the geometric relation:\n$$\nd_{hkl} = \\frac{a}{\\sqrt{h^2 + k^2 + l^2}}\n$$\n\nBy substituting the expression for $d_{hkl}$ into Bragg's law and rearranging, we can derive an expression for the apparent lattice parameter, $a_{hkl}$, calculated from a single diffraction peak $(h,k,l)$ observed at angle $\\theta$:\n$$\na_{hkl}(\\theta) = \\frac{\\lambda \\sqrt{h^2 + k^2 + l^2}}{2 \\sin\\theta}\n$$\nIn an ideal measurement, $a_{hkl}(\\theta)$ would be constant for all observed reflections. However, in practice, systematic experimental errors, such as sample displacement from the goniometer axis or X-ray absorption within a flat, thick sample, cause the calculated $a_{hkl}$ to vary systematically as a function of the diffraction angle $\\theta$.\n\nThe Cohen method provides a means to correct for these errors by modeling their angular dependence and extrapolating to a condition where their influence is minimized. The method assumes that the deviation of the apparent lattice parameter from a reference value, $\\Delta a_i = a_{hkl,i} - a_{\\mathrm{ref}}$, is a linear function of a specifically chosen extrapolation function, $f(\\theta_i)$. The problem specifies the use of the Cohen function:\n$$\nf(\\theta) = \\frac{\\cos^2\\theta}{\\sin\\theta}\n$$\nThis function is derived from considering the error introduced by sample displacement. The linear model is thus:\n$$\n\\Delta a_i \\approx m f(\\theta_i) + b\n$$\nwhere $m$ is a slope proportional to the magnitude of the systematic error, and $b$ is the intercept. The intercept $b$ represents the value of $\\Delta a$ in the limit as $f(\\theta) \\to 0$. This limit corresponds to $\\theta \\to 90^\\circ$ ($2\\theta \\to 180^\\circ$), a high-angle back-reflection geometry where systematic errors like sample displacement have a vanishing effect. Therefore, the intercept $b$ represents the true correction needed for the reference lattice parameter.\n\nTo determine the intercept $b$, we perform a linear least-squares regression on the set of data points $(x_i, y_i)$, where $x_i = f(\\theta_i)$ and $y_i = \\Delta a_i$. For a set of $N$ data points, the intercept $b$ is given by:\n$$\nb = \\bar{y} - m\\bar{x}\n$$\nwhere $\\bar{x}$ and $\\bar{y}$ are the means of the $x_i$ and $y_i$ values, respectively, and $m$ is the slope of the regression line.\n\nOnce $b$ is determined, the refined, error-corrected lattice parameter, $a_{\\mathrm{refined}}$, is obtained by adding this intercept to the initial reference value:\n$$\na_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b\n$$\nThis refined value is the best estimate of the true lattice parameter based on the provided experimental data.\n\nThe computational algorithm proceeds as follows for each test case:\n1.  For each provided diffraction angle $2\\theta_i$ (in degrees), the corresponding angle $\\theta_i$ is calculated in radians: $\\theta_i = \\frac{\\pi}{180} \\times \\frac{2\\theta_i}{2}$.\n2.  For each peak $i$ with Miller indices $(h_i, k_i, l_i)$ and angle $\\theta_i$, the following quantities are calculated:\n    a. The apparent lattice parameter: $a_i = \\frac{\\lambda \\sqrt{h_i^2 + k_i^2 + l_i^2}}{2 \\sin\\theta_i}$.\n    b. The deviation from the reference: $\\Delta a_i = a_i - a_{\\mathrm{ref}}$.\n    c. The value of the Cohen extrapolation function: $f(\\theta_i) = \\frac{\\cos^2\\theta_i}{\\sin\\theta_i}$.\n3.  A set of data points $\\{ (f(\\theta_i), \\Delta a_i) \\}$ is assembled.\n4.  A linear least-squares regression is performed on this dataset to find the y-intercept, $b$.\n5.  The refined lattice parameter is calculated as $a_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b$.\n6.  The final result, $a_{\\mathrm{refined}}$, is rounded to five decimal places as required.\n\nThis procedure will be systematically applied to each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Refines the cubic lattice parameter 'a' from XRD measurements using the Cohen method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test Case 1 (silicon-like)\",\n            \"lambda_\": 1.5406,  # Wavelength in Angstroms\n            \"a_ref\": 5.4300,    # Initial reference lattice parameter in Angstroms\n            \"reflections\": [(1, 1, 1), (2, 2, 0), (3, 1, 1), (4, 0, 0)],\n            \"two_thetas_deg\": [28.44, 47.29, 56.18, 69.12]\n        },\n        {\n            \"name\": \"Test Case 2 (gallium arsenide-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 5.6500,\n            \"reflections\": [(4, 0, 0), (3, 3, 1), (4, 2, 2)],\n            \"two_thetas_deg\": [66.10, 72.89, 75.17]\n        },\n        {\n            \"name\": \"Test Case 3 (strontium titanate-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 3.9000,\n            \"reflections\": [(1, 0, 0), (1, 1, 0), (1, 1, 1)],\n            \"two_thetas_deg\": [22.76, 32.33, 39.72]\n        },\n        {\n            \"name\": \"Test Case 4 (sodium chloride-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 5.6350,\n            \"reflections\": [(2, 0, 0), (2, 2, 0)],\n            \"two_thetas_deg\": [31.68, 45.48]\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        lambda_ = case[\"lambda_\"]\n        a_ref = case[\"a_ref\"]\n        reflections = case[\"reflections\"]\n        two_thetas_deg = case[\"two_thetas_deg\"]\n\n        delta_a_values = []\n        cohen_f_values = []\n\n        # Process each diffraction peak\n        for i in range(len(reflections)):\n            h, k, l = reflections[i]\n            two_theta_deg = two_thetas_deg[i]\n\n            # 1. Convert 2-theta (degrees) to theta (radians)\n            theta_rad = np.deg2rad(two_theta_deg / 2.0)\n\n            # 2. Compute a_hkl\n            hkl_sq_sum = h**2 + k**2 + l**2\n            a_hkl = (lambda_ * np.sqrt(hkl_sq_sum)) / (2 * np.sin(theta_rad))\n\n            # 3. Compute delta_a\n            delta_a = a_hkl - a_ref\n            delta_a_values.append(delta_a)\n\n            # 4. Compute f(theta)\n            cohen_f = (np.cos(theta_rad)**2) / np.sin(theta_rad)\n            cohen_f_values.append(cohen_f)\n\n        # Convert lists to numpy arrays for regression\n        x_data = np.array(cohen_f_values)\n        y_data = np.array(delta_a_values)\n\n        # 5. Fit a straight line using least squares to get the intercept 'b'\n        # The linregress function returns (slope, intercept, r_value, p_value, std_err)\n        # We only need the intercept.\n        if len(x_data)  1:\n            slope, intercept, r_value, p_value, std_err = linregress(x_data, y_data)\n        elif len(x_data) == 1:\n            # If there's only one point, regression is undefined.\n            # In this context, the best estimate is the single calculated value.\n            # a_refined = a_ref + delta_a_values[0] = a_hkl\n            # However, the problem ensures at least 2 points for regression.\n            # This is a fallback, but the intercept of a line through one point is ill-defined.\n            # Let's assume the error is entirely captured by the deviation itself.\n            # The prompt test cases have = 2 points.\n            intercept = delta_a_values[0] # Simplistic assumption.\n        else: # No data points\n            intercept = 0\n\n        # 6. Compute a_refined\n        a_refined = a_ref + intercept\n\n        # 7. Append the rounded result\n        results.append(f\"{a_refined:.5f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}