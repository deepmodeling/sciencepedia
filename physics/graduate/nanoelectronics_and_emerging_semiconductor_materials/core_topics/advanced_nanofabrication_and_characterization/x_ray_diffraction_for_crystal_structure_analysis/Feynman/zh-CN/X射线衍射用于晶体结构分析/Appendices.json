{
    "hands_on_practices": [
        {
            "introduction": "掌握了理论知识后，最重要的技能之一是从已知的晶体结构出发，预测其衍射图谱。本练习将引导你完成结构因子的计算，这是决定哪些衍射是允许的以及它们的相对强度的关键物理量。我们将以金刚石结构（半导体材料中的一种重要结构）为模型，通过亲手计算，你将直观地理解原子排布如何决定我们最终观测到的 X 射线衍射图样。",
            "id": "4312695",
            "problem": "在空间群为 $Fd\\bar{3}m$、晶格常数为 $a$ 的金刚石晶体的X射线衍射（XRD）中，该晶体可以表示为一个面心立方（fcc）布拉菲晶格，其原胞基元由两个相同的原子组成，相对于常规立方晶胞的分数坐标为 $\\mathbf{d}_{1} = (0,0,0)$ 和 $\\mathbf{d}_{2} = \\left(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4}\\right)$。考虑使用铜 $\\mathrm{K}\\alpha$ 辐射进行粉末测量，并将原子形状因子 $f(Q)$ 视为一个仅依赖于散射矢量 $Q = |\\mathbf{G}|$ 大小的标量，其中 $\\mathbf{G}$ 是与密勒指数 $(hkl)$ 相关的倒易点阵矢量。结构因子 $F(\\mathbf{G})$ 由基本表达式定义\n$$\nF(\\mathbf{G}) = \\sum_{n} f_{n}(Q) \\exp\\!\\left(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{r}_{n}\\right),\n$$\n其中，求和遍及常规晶胞内的所有原子，其位置为 $\\mathbf{r}_{n} = \\mathbf{t}_{\\alpha} + \\mathbf{d}_{\\beta}$，$\\mathbf{t}_{\\alpha}$ 是面心立方布拉菲平移矢量 $\\mathbf{t}_{0} = (0,0,0)$, $\\mathbf{t}_{1} = \\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$, $\\mathbf{t}_{2} = \\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$ 和 $\\mathbf{t}_{3} = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$，而 $\\mathbf{d}_{\\beta} \\in \\{\\mathbf{d}_{1}, \\mathbf{d}_{2}\\}$ 如上所述。假设两个基元原子相同（例如，硅），因此 $f_{1}(Q) = f_{2}(Q) = f(Q)$，忽略热运动和消光，并忽略洛伦兹-偏振和吸收效应。\n\n(a) 从上述定义和面心立方（fcc）平移矢量出发，推导金刚石基元的结构因子 $F(hkl)$ 的闭合形式表达式，然后将其应用于 $(111)$ 情况，以获得用 $f(Q)$ 表示的显式复振幅。\n\n(b) 使用推导出的振幅，通过将结构因子模的平方与立方晶体中每个晶面族的多重度 $m_{hkl}$ 相结合，计算粉末强度比 $I_{111}/I_{220}$。对于立方多重度，使用 $m_{111} = 8$ 和 $m_{220} = 12$。为了考虑原子形状因子随 $Q$ 增加而衰减，使用以下在相应散射矢量处对铜 $\\mathrm{K}\\alpha$ 辐射下的硅而言经验上合理的值：$f_{111} = 13.6$（以电子为单位）和 $f_{220} = 12.2$（以电子为单位），其中 $f_{hkl}$ 表示在对应 $(hkl)$ 的 $Q$ 值处计算的 $f(Q)$。\n\n除了计算之外，还需通过参考金刚石基元干涉和多重度，定性解释为什么在金刚石结构中 $(111)$ 衍射相对于 $(220)$ 衍射较弱。最后，提供 $I_{111}/I_{220}$ 的数值，并将答案四舍五入到 $3$ 位有效数字。将最终的强度比表示为纯小数（无量纲）。",
            "solution": "该问题要求推导金刚石立方晶格的结构因子，将其应用于 $(111)$ 和 $(220)$ 衍射，定性解释它们的相对强度，并计算粉末强度比 $I_{111}/I_{220}$。\n\n(a) 结构因子 $F(hkl)$ 和 $F(111)$ 的推导\n\n晶体的结构因子 $F(\\mathbf{G})$ 定义为对一个常规晶胞内所有原子的求和。原子 $n$ 的位置由 $\\mathbf{r}_{n}$ 给出。\n$$\nF(\\mathbf{G}) = \\sum_{n} f_{n}(Q) \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{r}_{n})\n$$\n对于金刚石晶格，原子是相同的，因此 $f_n(Q) = f(Q)$。原子位置 $\\mathbf{r}_n$ 表示为 $\\mathbf{r}_{n} = \\mathbf{t}_{\\alpha} + \\mathbf{d}_{\\beta}$，其中 $\\mathbf{t}_{\\alpha}$ 是面心立方（fcc）晶格平移矢量，$\\mathbf{d}_{\\beta}$ 是基元矢量位置。求和可以分解为一个对基元矢量求和与一个对晶格点求和的乘积：\n$$\nF(\\mathbf{G}) = f(Q) \\sum_{\\beta} \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{d}_{\\beta}) \\sum_{\\alpha} \\exp(2\\pi i\\, \\mathbf{G} \\cdot \\mathbf{t}_{\\alpha})\n$$\n这可以写成 $F(\\mathbf{G}) = f(Q) S_{\\text{basis}} S_{\\text{lattice}}$。\n\n对于晶格常数为 $a$ 的立方晶格，与密勒指数 $(hkl)$ 对应的倒易点阵矢量为 $\\mathbf{G} = \\frac{2\\pi}{a}(h, k, l)$。位置矢量 $\\mathbf{r}$ 以常规晶胞轴的分数坐标给出，$\\mathbf{r} = a(u, v, w)$。指数项中的点积为：\n$$\n\\mathbf{G} \\cdot \\mathbf{r} = \\frac{2\\pi}{a}(h, k, l) \\cdot a(u, v, w) = 2\\pi (hu + kv + lw)\n$$\n首先，我们计算 fcc 平移矢量 $\\mathbf{t}_{0}=(0,0,0)$, $\\mathbf{t}_{1}=\\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$, $\\mathbf{t}_{2}=\\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$ 和 $\\mathbf{t}_{3}=\\left(\\frac{1}{2},\\frac{1}{2},0\\right)$ 的晶格和 $S_{\\text{lattice}}$。\n$$\nS_{\\text{lattice}} = \\sum_{\\alpha=0}^{3} \\exp(2\\pi i (h u_{\\alpha} + k v_{\\alpha} + l w_{\\alpha}))\n$$\n$$\nS_{\\text{lattice}} = \\exp(0) + \\exp\\left(2\\pi i \\left(k\\frac{1}{2} + l\\frac{1}{2}\\right)\\right) + \\exp\\left(2\\pi i \\left(h\\frac{1}{2} + l\\frac{1}{2}\\right)\\right) + \\exp\\left(2\\pi i \\left(h\\frac{1}{2} + k\\frac{1}{2}\\right)\\right)\n$$\n$$\nS_{\\text{lattice}} = 1 + \\exp(\\pi i (k+l)) + \\exp(\\pi i (h+l)) + \\exp(\\pi i (h+k))\n$$\n由于对于整数 $n$，$\\exp(\\pi i n) = (-1)^n$，因此只有当指数 $h,k,l$ 的奇偶性一致（全为偶数或全为奇数）时，此和才非零。在这种情况下，$k+l$，$h+l$ 和 $h+k$ 都是偶数，且 $S_{\\text{lattice}} = 1+1+1+1=4$。如果奇偶性混合，则和为 $0$。这就是众所周知的 fcc 布拉菲晶格的选择定则。\n\n接下来，我们计算位于 $\\mathbf{d}_{1}=(0,0,0)$ 和 $\\mathbf{d}_{2}=\\left(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4}\\right)$ 的双原子基元的基元结构因子 $S_{\\text{basis}}$。\n$$\nS_{\\text{basis}} = \\sum_{\\beta=1}^{2} \\exp(2\\pi i (h u_{\\beta} + k v_{\\beta} + l w_{\\beta}))\n$$\n$$\nS_{\\text{basis}} = \\exp(0) + \\exp\\left(2\\pi i \\left(h\\frac{1}{4} + k\\frac{1}{4} + l\\frac{1}{4}\\right)\\right)\n$$\n$$\nS_{\\text{basis}} = 1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\n$$\n结合这些结果，金刚石立方晶格的结构因子为：\n$$\nF(hkl) = f(Q) \\left[1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\\right] \\left[1 + \\exp(\\pi i (k+l)) + \\exp(\\pi i (h+l)) + \\exp(\\pi i (h+k))\\right]\n$$\n根据选择定则，此表达式可以简化。对于非零衍射，$h,k,l$ 必须全为偶数或全为奇数，此时 $S_{\\text{lattice}}=4$。因此，对于允许的衍射：\n$$\nF(hkl) = 4f(Q)\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(h+k+l)\\right)\\right]\n$$\n我们还必须考虑来自 $S_{\\text{basis}}$ 的条件。如果 $h,k,l$ 全为偶数，则 $h+k+l$ 是一个偶数。设 $h+k+l = S$。\n如果 $S=4n$（例如，对于 $(220)$，$S=4$），则 $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2} (4n)) = 1+1=2$。所以 $F_{hkl} = 8f(Q)$。\n如果 $S=4n+2$（例如，对于 $(200)$，$S=2$），则 $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2} (4n+2)) = 1+\\exp(\\pi i) = 1-1=0$。所以 $F_{hkl} = 0$。这是金刚石滑移消光定则。\n如果 $h,k,l$ 全为奇数，则 $h+k+l$ 是一个奇数，$S=2n+1$。那么 $S_{\\text{basis}} = 1 + \\exp(\\frac{\\pi i}{2}(2n+1)) = 1 \\pm i$。所以 $|S_{\\text{basis}}|^2=2$。\n总之，金刚石立方结构允许的衍射 $(hkl)$ 是那些 $h,k,l$ 全为奇数，或者全为偶数且其和 $h+k+l=4n$ 的衍射。\n\n对于 $(hkl)=(111)$ 的特定情况：\n指数全为奇数。$h+k+l=1+1+1=3$。fcc 条件得到满足。\n$$\nF(111) = 4f_{111}\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(3)\\right)\\right] = 4f_{111}\\left[1 + \\exp\\left(\\frac{3\\pi i}{2}\\right)\\right]\n$$\n由于 $\\exp\\left(\\frac{3\\pi i}{2}\\right) = \\cos(\\frac{3\\pi}{2}) + i\\sin(\\frac{3\\pi}{2}) = 0 - i = -i$，复振幅为：\n$$\nF(111) = 4f_{111}(1-i)\n$$\n\n(b) 强度比 $I_{111}/I_{220}$ 与定性解释\n\n首先，我们求 $(220)$ 衍射的结构因子。指数全为偶数，其和为 $h+k+l = 2+2+0=4$。这是 $4n$ 的形式（$n=1$），因此该衍射是允许的。\n$$\nF(220) = 4f_{220}\\left[1 + \\exp\\left(\\frac{\\pi i}{2}(4)\\right)\\right] = 4f_{220}[1 + \\exp(2\\pi i)]\n$$\n由于 $\\exp(2\\pi i) = 1$，振幅为：\n$$\nF(220) = 4f_{220}(1+1) = 8f_{220}\n$$\n粉末衍射峰的强度与晶面族的多重度 $m_{hkl}$ 和结构因子模的平方 $|F(hkl)|^2$ 成正比。\n$$\nI_{hkl} \\propto m_{hkl} |F(hkl)|^2\n$$\n模的平方为：\n$$\n|F(111)|^2 = |4f_{111}(1-i)|^2 = (4f_{111})^2 |1-i|^2 = 16f_{111}^2 (1^2 + (-1)^2) = 32f_{111}^2\n$$\n$$\n|F(220)|^2 = |8f_{220}|^2 = 64f_{220}^2\n$$\n强度比为：\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{m_{111} |F(111)|^2}{m_{220} |F(220)|^2} = \\frac{8 \\times 32f_{111}^2}{12 \\times 64f_{220}^2}\n$$\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{256}{768} \\frac{f_{111}^2}{f_{220}^2} = \\frac{1}{3} \\left(\\frac{f_{111}}{f_{220}}\\right)^2\n$$\n\n定性地看，$(111)$ 衍射相对于 $(220)$ 衍射较弱，主要归因于两个因素：基元原子的干涉和多重度，而原子形状因子部分抵消了这种影响。\n1. 基元干涉：$|S_{\\text{basis}}|^2$ 项反映了基元中两个原子散射波之间的干涉。对于 $(111)$ 衍射，位于 $(0,0,0)$ 和 $(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4})$ 的原子之间的相位差为 $\\frac{\\pi}{2}(1+1+1) = \\frac{3\\pi}{2}$。振幅相加为 $1+\\exp(i3\\pi/2) = 1-i$，导致 $|S_{\\text{basis}}|^2=2$（部分相消干涉）。对于 $(220)$ 衍射，相位差为 $\\frac{\\pi}{2}(2+2+0) = 2\\pi$。振幅相加为 $1+\\exp(i2\\pi) = 2$，导致 $|S_{\\text{basis}}|^2=4$（完全相长干涉）。仅此因素就使得 $(220)$ 衍射的 $|F|^2$ 贡献是 $(111)$ 衍射的两倍。\n2. 多重度：$\\{220\\}$ 晶面族的多重度为 $m_{220}=12$，而 $\\{111\\}$ 晶面族的多重度为 $m_{111}=8$。这意味着对 $(220)$ 粉末峰有贡献的晶面数量是 $(111)$ 峰的 $1.5$ 倍，进一步增强了其相对于 $(111)$ 峰的强度。\n3. 原子形状因子：形状因子 $f(Q)$ 随着散射矢量大小 $Q$ 的增加而减小。由于 $Q \\propto \\sqrt{h^2+k^2+l^2}$，$Q_{220} (\\propto \\sqrt{8})$ 大于 $Q_{111} (\\propto \\sqrt{3})$。因此，$f_{220}  f_{111}$。这种效应倾向于降低 $(220)$ 衍射相对于 $(111)$ 衍射的强度，但其强度不足以克服基元干涉和多重度的综合效应。\n\n现在，我们使用所提供的数据计算数值：$m_{111}=8$, $m_{220}=12$, $f_{111}=13.6$, $f_{220}=12.2$。\n$$\n\\frac{I_{111}}{I_{220}} = \\frac{1}{3} \\left(\\frac{13.6}{12.2}\\right)^2 \\approx \\frac{1}{3} (1.11475)^2 \\approx \\frac{1}{3} (1.24268) \\approx 0.414227\n$$\n四舍五入到 $3$ 位有效数字，强度比为 $0.414$。",
            "answer": "$$\n\\boxed{0.414}\n$$"
        },
        {
            "introduction": "理想的理论模型是理解衍射现象的基础，但实际的实验数据总是受到仪器和样品本身因素的影响。本练习将引导你从第一性原理出发，分析在广泛使用的 Bragg-Brentano 几何构型中两种常见的系统效应：样品吸收和样品位移。通过推导它们对衍射强度和峰位的影响，你将深刻理解实验伪影的来源，并为后续进行精确的数据分析和修正打下坚实的基础。",
            "id": "4312767",
            "problem": "一块用于纳米电子学的二维过渡金属二硫族化物平板薄膜，使用X射线衍射（XRD）在对称反射几何中进行测量。衍射仪采用Bragg-Brentano聚焦方式，测角仪圆半径为$R$，X射线波长为$\\lambda$，薄膜在此波长下的线性衰减系数为$\\mu$。薄膜厚度为$t$，晶面间距为$d$的晶体学平面在满足布拉格定律的角度$\\theta$处产生一个布拉格峰。由于安装不完善，样品表面沿垂直于衍射仪平面的法线方向位移了微小量$\\Delta$，其中$\\Delta0$定义为样品向X射线源和探测器方向抬高的位移。\n\n仅从比尔-朗伯衰减定律和Bragg-Brentano聚焦的几何定义出发（不使用任何预先推导的校正公式），并假设积分强度处于运动学散射机制，完成以下任务：\n\n1. 通过对薄膜内部深度$x$的贡献进行积分，推导此平板样品在对称反射下的积分衍射强度的吸收校正因子，该因子是$\\theta$、$\\mu$和$t$的函数。\n\n2. 利用聚焦圆几何和小位移线性化，推导由于样品位移$\\Delta$导致的报告峰位在$2\\theta$角上的变化。将最终的$2\\theta$偏移表示为$\\Delta$、$R$和$\\theta$的解析表达式，并遵循上述规定的符号约定。\n\n最终的角度偏移以弧度表示。最终答案必须是关于$2\\theta$偏移的单个闭式解析表达式。",
            "solution": "该问题被评估为有效，因为它具有科学依据，提法明确且客观。它包含X射线衍射理论领域中基于基本原理的两个标准推导。\n\n按照题目要求，解答分为两部分。\n\n第一部分：吸收校正因子的推导\n\n问题要求推导厚度为$t$的平板薄膜在对称反射几何中积分衍射强度的吸收校正因子。我们从比尔-朗伯定律开始。\n\n在对称反射中，入射X射线束与样品表面成$\\theta$角，衍射束也与样品表面成$\\theta$角。入射束和衍射束之间的总夹角为$2\\theta$。\n\n让我们考虑薄膜表面下方深度为$x$处的一个厚度为$dx$的微分层，其中$x$是垂直于表面测量的。要让X射线被该层衍射并离开样品，它必须穿过该材料。\n\n入射束到达深度为$x$的这一层的路径长度由$L_{in} = \\frac{x}{\\sin\\theta}$给出。\n衍射束从同一层离开薄膜的路径长度为$L_{out} = \\frac{x}{\\sin\\theta}$。\n\n在深度$x$处发生衍射时，X射线束在薄膜内的总路径长度是入射和出射路径长度之和：\n$$L(x) = L_{in} + L_{out} = \\frac{x}{\\sin\\theta} + \\frac{x}{\\sin\\theta} = \\frac{2x}{\\sin\\theta}$$\n\n根据比尔-朗伯定律，X射线束穿过线性衰减系数为$\\mu$的材料一段距离$L$后，其强度会衰减因子$\\exp(-\\mu L)$。因此，从深度$x$处的层衍射的束流强度会减少因子$\\exp(-\\mu L(x))$。\n\n在深度$x$处，由微分层$dx$衍射的强度（记为$dI$）与入射强度、该层的体积以及衰减因子成正比。假设照射样品的束流横截面积为单位面积，则该层的体积与$dx$成正比。因此：\n$$dI \\propto \\exp(-\\mu L(x)) \\, dx = \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) dx$$\n\n总积分强度$I_{int}$是通过对整个薄膜厚度（从表面$x=0$到薄膜底部$x=t$）的贡献进行积分得到的。这个积分值本身就是吸收校正因子，我们将其表示为$A(\\theta, \\mu, t)$。\n$$A(\\theta, \\mu, t) = \\int_0^t \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) dx$$\n\n为了计算该积分，我们可以直接对$x$进行积分：\n$$A(\\theta, \\mu, t) = \\left[ \\frac{1}{-\\frac{2\\mu}{\\sin\\theta}} \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) \\right]_0^t$$\n$$A(\\theta, \\mu, t) = -\\frac{\\sin\\theta}{2\\mu} \\left[ \\exp\\left(-\\frac{2\\mu x}{\\sin\\theta}\\right) \\right]_0^t$$\n$$A(\\theta, \\mu, t) = -\\frac{\\sin\\theta}{2\\mu} \\left( \\exp\\left(-\\frac{2\\mu t}{\\sin\\theta}\\right) - \\exp(0) \\right)$$\n$$A(\\theta, \\mu, t) = \\frac{\\sin\\theta}{2\\mu} \\left( 1 - \\exp\\left(-\\frac{2\\mu t}{\\sin\\theta}\\right) \\right)$$\n这个表达式就是作为$\\theta$、$\\mu$和$t$的函数的积分强度的吸收校正因子。\n\n第二部分：峰位偏移的推导\n\n问题要求推导由于样品位移$\\Delta$导致的报告峰位变化$\\delta(2\\theta)$。几何结构是Bragg-Brentano衍射仪，测角仪半径为$R$。位移$\\Delta$是沿着样品表面的法线方向，$\\Delta  0$表示样品向X射线源和探测器方向抬高，这是样品表面“过高”的标准约定。\n\n让我们建立一个坐标系来分析这个几何问题。设测角仪轴（预期的衍射点）位于原点$O=(0,0)$。设理想的样品表面沿x轴。样品表面法线沿y轴。入射X射线束与表面成$\\theta$角。对于从左侧射入的光束，其路径由直线$y = -x\\tan\\theta$描述，因为它瞄准原点$O$。\n\n位移$\\Delta$将样品表面抬高到平面$y=\\Delta$。仍然瞄准$O$的入射束现在将与这个位移后的表面相交于点$P$。为了找到$P$的坐标，我们将$y=\\Delta$代入光束路径方程中：\n$$\\Delta = -x_P \\tan\\theta \\implies x_P = -\\frac{\\Delta}{\\tan\\theta} = -\\Delta\\cot\\theta$$\n所以，衍射点是$P = (-\\Delta\\cot\\theta, \\Delta)$。从理想衍射点$O$到实际衍射点$P$的向量是$\\vec{OP} = (-\\Delta\\cot\\theta, \\Delta)$。\n\n在理想情况下，从$O$点衍射的光束射向探测器。该衍射束的方向与表面（x轴）成$\\theta$角，所以其单位方向向量是$\\hat{k}_{out} = (\\cos\\theta, \\sin\\theta)$。探测器沿此方向距离$O$点$R$处。\n\n由于位移，衍射束从$P$点发出，但传播方向与$\\hat{k}_{out}$相同（因为样品的晶体取向未变）。这意味着新的衍射射线与理想射线平行，但发生了位移。我们需要找出这个位移在半径为$R$的探测器圆上的效应。\n\n衍射束的横向偏移$s$是理想射线（从$O$出发）和实际射线（从$P$出发）之间的垂直距离。这个距离是位移向量$\\vec{OP}$在垂直于衍射束$\\hat{k}_{out}$方向上的投影的大小。\n\n垂直于$\\hat{k}_{out}$的单位向量是$\\hat{n}_{out} = (-\\sin\\theta, \\cos\\theta)$。横向偏移$s_{beam}$是$\\vec{OP}$在$\\hat{n}_{out}$上标量投影的绝对值：\n$$s_{beam} = |\\vec{OP} \\cdot \\hat{n}_{out}| = |(-\\Delta\\cot\\theta)(-\\sin\\theta) + (\\Delta)(\\cos\\theta)|$$\n$$s_{beam} = \\left|-\\Delta\\frac{\\cos\\theta}{\\sin\\theta}(-\\sin\\theta) + \\Delta\\cos\\theta\\right| = |\\Delta\\cos\\theta + \\Delta\\cos\\theta| = |2\\Delta\\cos\\theta|$$\n由于$\\Delta  0$且对于典型的衍射角$0  \\theta  90^\\circ$，$\\cos\\theta  0$，所以光束的横向位移是$s = 2\\Delta\\cos\\theta$。\n\n这个横向位移$s$导致光束以一个偏移的角度位置击中探测器圆。探测器位置的角度偏移$\\delta(2\\theta)$由弧长除以半径$R$给出。对于小位移，我们可以用横向位移$s$来近似弧长。\n$$|\\delta(2\\theta)| \\approx \\frac{s}{R} = \\frac{2\\Delta\\cos\\theta}{R}$$\n结果以弧度为单位，符合要求。\n\n最后，我们必须确定偏移的符号。一个正位移$\\Delta$（样品过高）导致光束在到达预期点$O$之前击中样品上的点$P$。从我们的坐标系来看，对于$\\theta \\in (0, \\pi/2)$，$x_P = -\\Delta\\cot\\theta$是负的。衍射点$P$相对于光束路径“向上游”移动。衍射射线路径同样发生偏移。在探测器圆上的观察者会看到射线从一个对应于更小角度的位置到达。因此，测量的角度$2\\theta_{meas}$小于真实角度$2\\theta_{true}$，偏移$\\delta(2\\theta) = 2\\theta_{meas} - 2\\theta_{true}$是负的。\n\n因此，报告峰位的变化是：\n$$\\delta(2\\theta) = -\\frac{2\\Delta\\cos\\theta}{R}$$\n这个表达式给出了作为$\\Delta$、$R$和$\\theta$函数的峰位偏移（以弧度为单位）。",
            "answer": "$$\\boxed{-\\frac{2\\Delta\\cos\\theta}{R}}$$"
        },
        {
            "introduction": "在前一个练习中我们理解了系统误差的来源，那么我们如何利用这些知识来修正数据，从而提取高精度的物理信息呢？本练习将介绍经典的 Cohen 方法，这是一种通过对系统误差的角度依赖性进行建模和外推，来精确修正晶格常数的强大技术。通过这个计算实践，你将搭建起从原始数据到获得精确、具有物理意义的晶胞参数之间的桥梁。",
            "id": "4312758",
            "problem": "您将实现一个程序，该程序使用 Cohen 方法根据 X 射线衍射 (XRD) 测量数据精修立方晶格参数 $a$，以校正样品位移和透明度等系统误差。该方法通过布拉格定律和立方晶系几何结构计算每个衍射峰的晶格参数 $a_{hkl}(\\theta)$，然后对 $\\Delta a$ 与 Cohen 外推函数 $f(\\theta) = \\cos^2 \\theta / \\sin \\theta$ 进行线性回归。精修后的参数 $a_{\\text{refined}}$ 通过外推至 $f(\\theta) \\to 0$ 得到。所有角度均以度为单位指定，在计算时必须在内部转换为弧度。最终答案必须以埃 (Å) 为单位表示，并四舍五入到五位小数。\n\n基本原理：\n- 一级衍射的布拉格定律：$n \\lambda = 2 d \\sin \\theta$，其中 $n=1$。\n- 立方晶体几何结构：$d_{hkl} = a / \\sqrt{h^2 + k^2 + l^2}$。\n\n根据这些，计算每个衍射峰的晶格参数为：\n$$\na_{hkl}(\\theta) = \\frac{\\lambda \\sqrt{h^2 + k^2 + l^2}}{2 \\sin \\theta}。\n$$\n定义 Cohen 外推函数：\n$$\nf(\\theta) = \\frac{\\cos^2 \\theta}{\\sin \\theta}。\n$$\n定义相对于初始参考值 $a_{\\mathrm{ref}}$ 的每个衍射峰的偏差：\n$$\n\\Delta a_i = a_{hkl,i} - a_{\\mathrm{ref}}。\n$$\n通过线性回归对系统误差进行建模：\n$$\n\\Delta a_i \\approx m f(\\theta_i) + b,\n$$\n并通过外推得到的截距获得精修后的晶格参数：\n$$\na_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b。\n$$\n\n算法要求：\n1. 对于每个测试用例，将给定的 $2\\theta$ 值（单位：度）通过 $\\theta = (2\\theta) / 2$ 和度到弧度的转换，转换为以弧度为单位的 $\\theta$。\n2. 对于每个衍射峰 $(h,k,l)$ 及其 $\\theta$，使用上述公式计算 $a_{hkl}$。\n3. 对于每个衍射峰，计算其相对于给定 $a_{\\mathrm{ref}}$ 的 $\\Delta a_i$。\n4. 对于每个衍射峰，计算 $f(\\theta_i)$。\n5. 使用最小二乘法对 $\\Delta a_i$ 与 $f(\\theta_i)$ 进行直线拟合，得到斜率 $m$ 和截距 $b$。\n6. 计算 $a_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b$。\n7. 报告以埃 (Å) 为单位的 $a_{\\mathrm{refined}}$，四舍五入到五位小数。\n\n角度单位要求：\n- 所有输入角度均为 $2\\theta$（单位：度）；在使用三角函数前，必须将它们转换为以弧度为单位的 $\\theta$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含所有测试用例的精修晶格参数，形式为逗号分隔的列表，并用方括号括起来，每个值以埃 (Å) 为单位，四舍五入到五位小数。例如：$[5.43100,5.65200,3.90500,5.64000]$。\n\n测试套件：\n提供并处理以下科学上合理的测试用例。请使用指定的参数，不要改动。\n\n- 测试用例 1（类硅材料，多个中等角度衍射峰）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 5.4300\\,\\text{\\AA}$。\n  - 反射 $(h,k,l)$：$(1,1,1)$、$(2,2,0)$、$(3,1,1)$、$(4,0,0)$。\n  - 测量的 $2\\theta$ (度)：$28.44$、$47.29$、$56.18$、$69.12$。\n\n- 测试用例 2（类砷化镓材料，高角度衍射峰）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 5.6500\\,\\text{\\AA}$。\n  - 反射 $(h,k,l)$：$(4,0,0)$、$(3,3,1)$、$(4,2,2)$。\n  - 测量的 $2\\theta$ (度)：$66.10$、$72.89$、$75.17$。\n\n- 测试用例 3（类钛酸锶材料，低角度衍射峰，简单立方）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 3.9000\\,\\text{\\AA}$。\n  - 反射 $(h,k,l)$：$(1,0,0)$、$(1,1,0)$、$(1,1,1)$。\n  - 测量的 $2\\theta$ (度)：$22.76$、$32.33$、$39.72$。\n\n- 测试用例 4（类氯化钠材料，最少两个衍射峰）：\n  - 波长：$\\lambda = 1.5406\\,\\text{\\AA}$。\n  - 初始参考值：$a_{\\mathrm{ref}} = 5.6350\\,\\text{\\AA}$。\n  - 反射 $(h,k,l)$：$(2,0,0)$、$(2,2,0)$。\n  - 测量的 $2\\theta$ (度)：$31.68$、$45.48$。\n\n您的程序必须实现上述方法，并以所要求的确切格式生成最终输出行。不允许用户输入；所有数据必须嵌入在程序中。",
            "solution": "所提出的问题要求实现一个计算程序，以根据 X 射线衍射 (XRD) 数据精修立方晶体的晶格参数。这将通过使用 Cohen 方法来完成，这是一种用于校正系统误差的经典技术。对问题陈述的验证证实了其科学上的合理性、问题的适定性和完整性。所有提供的数据和物理常数都是合理的，并与晶体学和固态物理学的既定原理一致。因此，我们可以着手进行形式化的求解。\n\n此分析的基础依赖于两个基本原理：布拉格定律和立方晶格的几何结构。\n\n首先，布拉格定律描述了 X 射线被一组平行晶面衍射后发生相长干涉的条件。对于一级衍射 ($n=1$)，其表达式为：\n$$\n\\lambda = 2 d_{hkl} \\sin\\theta\n$$\n这里，$\\lambda$ 是入射 X 射线的波长，$d_{hkl}$ 是由米勒指数 $(h,k,l)$ 表示的晶面族的晶面间距，$\\theta$ 是入射角，等于测量到的衍射角 $2\\theta$ 的一半。\n\n其次，对于立方晶系，晶面间距 $d_{hkl}$ 与晶格参数 $a$ 之间存在以下几何关系：\n$$\nd_{hkl} = \\frac{a}{\\sqrt{h^2 + k^2 + l^2}}\n$$\n\n通过将 $d_{hkl}$ 的表达式代入布拉格定律并重新整理，我们可以推导出表观晶格参数 $a_{hkl}$ 的表达式，该参数是根据在角度 $\\theta$ 处观察到的单个衍射峰 $(h,k,l)$ 计算得出的：\n$$\na_{hkl}(\\theta) = \\frac{\\lambda \\sqrt{h^2 + k^2 + l^2}}{2 \\sin\\theta}\n$$\n在理想的测量中，对于所有观察到的反射，$a_{hkl}(\\theta)$ 都应该是一个常数。然而，在实践中，系统性的实验误差，例如样品偏离测角仪轴心，或 X 射线在平坦厚样品内的吸收，会导致计算出的 $a_{hkl}$ 随衍射角 $\\theta$ 系统性地变化。\n\nCohen 方法提供了一种校正这些误差的方法，它通过对其角度依赖性进行建模，并外推到一个误差影响最小化的条件。该方法假设表观晶格参数与参考值之间的偏差 $\\Delta a_i = a_{hkl,i} - a_{\\mathrm{ref}}$ 是一个特定选择的外推函数 $f(\\theta_i)$ 的线性函数。问题指定使用 Cohen 函数：\n$$\nf(\\theta) = \\frac{\\cos^2\\theta}{\\sin\\theta}\n$$\n该函数是基于考虑样品位移引入的误差而推导出来的。因此，线性模型为：\n$$\n\\Delta a_i \\approx m f(\\theta_i) + b\n$$\n其中，$m$ 是一个与系统误差大小成正比的斜率，$b$ 是截距。截距 $b$ 表示在 $f(\\theta) \\to 0$ 极限下的 $\\Delta a$ 值。这个极限对应于 $\\theta \\to 90^\\circ$ ($2\\theta \\to 180^\\circ$)，即高角度背反射几何，在这种几何条件下，样品位移等系统误差的影响会趋于消失。因此，截距 $b$ 代表了对参考晶格参数所需的真实校正值。\n\n为了确定截距 $b$，我们对一组数据点 $(x_i, y_i)$ 进行线性最小二乘回归，其中 $x_i = f(\\theta_i)$ 且 $y_i = \\Delta a_i$。对于一组 $N$ 个数据点，截距 $b$ 由下式给出：\n$$\nb = \\bar{y} - m\\bar{x}\n$$\n其中，$\\bar{x}$ 和 $\\bar{y}$ 分别是 $x_i$ 和 $y_i$ 值的平均值，$m$ 是回归线的斜率。\n\n一旦确定了 $b$，经过误差校正的精修晶格参数 $a_{\\mathrm{refined}}$ 通过将此截距加到初始参考值上得到：\n$$\na_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b\n$$\n这个精修值是基于所提供的实验数据对真实晶格参数的最佳估计。\n\n对于每个测试用例，计算算法按以下步骤进行：\n1.  对于每个给定的衍射角 $2\\theta_i$（单位：度），计算相应的弧度角 $\\theta_i$：$\\theta_i = \\frac{\\pi}{180} \\times \\frac{2\\theta_i}{2}$。\n2.  对于每个具有米勒指数 $(h_i, k_i, l_i)$ 和角度 $\\theta_i$ 的衍射峰 $i$，计算以下量：\n    a. 表观晶格参数：$a_i = \\frac{\\lambda \\sqrt{h_i^2 + k_i^2 + l_i^2}}{2 \\sin\\theta_i}$。\n    b. 与参考值的偏差：$\\Delta a_i = a_i - a_{\\mathrm{ref}}$。\n    c. Cohen 外推函数的值：$f(\\theta_i) = \\frac{\\cos^2\\theta_i}{\\sin\\theta_i}$。\n3.  组合成一组数据点 $\\{ (f(\\theta_i), \\Delta a_i) \\}$。\n4.  对此数据集进行线性最小二乘回归，以找到 y 轴截距 $b$。\n5.  计算精修晶格参数为 $a_{\\mathrm{refined}} = a_{\\mathrm{ref}} + b$。\n6.  最终结果 $a_{\\mathrm{refined}}$ 按要求四舍五入到五位小数。\n\n此过程将系统地应用于问题陈述中提供的每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Refines the cubic lattice parameter 'a' from XRD measurements using the Cohen method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test Case 1 (silicon-like)\",\n            \"lambda_\": 1.5406,  # Wavelength in Angstroms\n            \"a_ref\": 5.4300,    # Initial reference lattice parameter in Angstroms\n            \"reflections\": [(1, 1, 1), (2, 2, 0), (3, 1, 1), (4, 0, 0)],\n            \"two_thetas_deg\": [28.44, 47.29, 56.18, 69.12]\n        },\n        {\n            \"name\": \"Test Case 2 (gallium arsenide-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 5.6500,\n            \"reflections\": [(4, 0, 0), (3, 3, 1), (4, 2, 2)],\n            \"two_thetas_deg\": [66.10, 72.89, 75.17]\n        },\n        {\n            \"name\": \"Test Case 3 (strontium titanate-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 3.9000,\n            \"reflections\": [(1, 0, 0), (1, 1, 0), (1, 1, 1)],\n            \"two_thetas_deg\": [22.76, 32.33, 39.72]\n        },\n        {\n            \"name\": \"Test Case 4 (sodium chloride-like)\",\n            \"lambda_\": 1.5406,\n            \"a_ref\": 5.6350,\n            \"reflections\": [(2, 0, 0), (2, 2, 0)],\n            \"two_thetas_deg\": [31.68, 45.48]\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        lambda_ = case[\"lambda_\"]\n        a_ref = case[\"a_ref\"]\n        reflections = case[\"reflections\"]\n        two_thetas_deg = case[\"two_thetas_deg\"]\n\n        delta_a_values = []\n        cohen_f_values = []\n\n        # Process each diffraction peak\n        for i in range(len(reflections)):\n            h, k, l = reflections[i]\n            two_theta_deg = two_thetas_deg[i]\n\n            # 1. Convert 2-theta (degrees) to theta (radians)\n            theta_rad = np.deg2rad(two_theta_deg / 2.0)\n\n            # 2. Compute a_hkl\n            hkl_sq_sum = h**2 + k**2 + l**2\n            a_hkl = (lambda_ * np.sqrt(hkl_sq_sum)) / (2 * np.sin(theta_rad))\n\n            # 3. Compute delta_a\n            delta_a = a_hkl - a_ref\n            delta_a_values.append(delta_a)\n\n            # 4. Compute f(theta)\n            cohen_f = (np.cos(theta_rad)**2) / np.sin(theta_rad)\n            cohen_f_values.append(cohen_f)\n\n        # Convert lists to numpy arrays for regression\n        x_data = np.array(cohen_f_values)\n        y_data = np.array(delta_a_values)\n\n        # 5. Fit a straight line using least squares to get the intercept 'b'\n        # The linregress function returns (slope, intercept, r_value, p_value, std_err)\n        # We only need the intercept.\n        if len(x_data) > 1:\n            slope, intercept, r_value, p_value, std_err = linregress(x_data, y_data)\n        elif len(x_data) == 1:\n            # If there's only one point, regression is undefined.\n            # In this context, the best estimate is the single calculated value.\n            # a_refined = a_ref + delta_a_values[0] = a_hkl\n            # However, the problem ensures at least 2 points for regression.\n            # This is a fallback, but the intercept of a line through one point is ill-defined.\n            # Let's assume the error is entirely captured by the deviation itself.\n            # A more robust approach might be to flag this, but we follow the logic.\n            # The prompt test cases have >= 2 points.\n            intercept = delta_a_values[0] # Simplistic assumption.\n        else: # No data points\n            intercept = 0\n\n        # 6. Compute a_refined\n        a_refined = a_ref + intercept\n\n        # 7. Append the rounded result\n        results.append(f\"{a_refined:.5f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}