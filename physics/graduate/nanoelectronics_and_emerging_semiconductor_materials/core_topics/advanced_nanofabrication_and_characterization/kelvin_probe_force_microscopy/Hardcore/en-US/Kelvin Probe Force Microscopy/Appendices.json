{
    "hands_on_practices": [
        {
            "introduction": "A primary application of Kelvin Probe Force Microscopy (KPFM) is the characterization of electronic properties in semiconductor materials. This exercise bridges the gap between fundamental semiconductor physics and the practical interpretation of KPFM data. By working through this problem , you will calculate how surface phenomena like Fermi-level pinning induce band bending, and how this directly translates into a measurable shift in the contact potential difference ($V_{\\mathrm{CPD}}$).",
            "id": "4283894",
            "problem": "An amplitude-modulated Kelvin probe force microscopy (KPFM) measurement is performed on a uniformly doped, nondegenerate, $n$-type silicon surface with donor density $N_{D} = 1.00 \\times 10^{17}\\,\\text{cm}^{-3}$ at temperature $T = 300\\,\\text{K}$. The intrinsic carrier concentration of silicon at this temperature is $n_{i} = 1.00 \\times 10^{10}\\,\\text{cm}^{-3}$. Assume complete dopant ionization, no bandgap narrowing, and no surface dipole changes beyond electrostatic band bending.\n\nDefine the surface potential $\\psi_{s}$ to be positive when the electron energy bands at the surface are shifted upward by $q \\psi_{s}$ relative to the bulk, equivalently $E_{i}(\\text{surface}) - E_{i}(\\text{bulk}) = q \\psi_{s}$, where $E_{i}$ is the intrinsic energy level and $q$ is the magnitude of the elementary charge. Suppose surface states pin the Fermi level at midgap so that $E_{F}(\\text{surface}) = E_{i}(\\text{surface})$.\n\nIn KPFM, the contact potential difference is defined by\n\n$$\nV_{\\mathrm{CPD}} = \\frac{\\Phi_{\\text{sample}} - \\Phi_{\\text{tip}}}{q},\n$$\n\nwhere $\\Phi$ denotes the work function. Consider only the contribution of band bending to the sample work function, and assume that band bending increases $\\Phi_{\\text{sample}}$ by $q \\psi_{s}$ relative to the flat-band case.\n\nUsing only fundamental relations of nondegenerate semiconductors in thermal equilibrium and the above definitions, determine:\n- the surface potential $\\psi_{s}$ implied by midgap pinning, and\n- the corresponding contribution $\\Delta V_{\\mathrm{CPD}}$ of this band bending to $V_{\\mathrm{CPD}}$, independent of the absolute tip work function.\n\nUse $k_{B} = 1.380\\,649\\times 10^{-23}\\,\\text{J/K}$ and $q = 1.602\\,176\\,634\\times 10^{-19}\\,\\text{C}$. Express both $\\psi_{s}$ and $\\Delta V_{\\mathrm{CPD}}$ in volts, and round your answers to four significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded in semiconductor physics, well-posed, objective, and provides all necessary information for a unique solution.\n\nThe solution proceeds in two parts: first, we determine the surface potential $\\psi_{s}$, and second, we calculate the corresponding contribution to the contact potential difference, $\\Delta V_{\\mathrm{CPD}}$.\n\nPart 1: Determination of the surface potential $\\psi_{s}$\n\nThe surface potential, $\\psi_{s}$, arises from the difference in the position of the energy bands at the surface relative to the bulk. To find $\\psi_{s}$, we must first determine the position of the Fermi level, $E_{F}$, relative to the intrinsic energy level, $E_{i}$, in the bulk of the semiconductor.\n\nFor a non-degenerate $n$-type semiconductor in thermal equilibrium, the electron concentration in the bulk, $n_{0}$, is given by:\n$$\nn_{0} = n_{i} \\exp\\left(\\frac{E_{F}(\\text{bulk}) - E_{i}(\\text{bulk})}{k_{B} T}\\right)\n$$\nwhere $n_{i}$ is the intrinsic carrier concentration, $k_{B}$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nThe problem states that there is complete ionization of the donor atoms, so the bulk electron concentration is equal to the donor density, $n_{0} = N_{D}$. Substituting this into the equation above, we have:\n$$\nN_{D} = n_{i} \\exp\\left(\\frac{E_{F}(\\text{bulk}) - E_{i}(\\text{bulk})}{k_{B} T}\\right)\n$$\nWe can solve for the energy difference between the Fermi level and the intrinsic level in the bulk:\n$$\n\\frac{N_{D}}{n_{i}} = \\exp\\left(\\frac{E_{F}(\\text{bulk}) - E_{i}(\\text{bulk})}{k_{B} T}\\right)\n$$\n$$\nE_{F}(\\text{bulk}) - E_{i}(\\text{bulk}) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\nIn thermal equilibrium, the Fermi level $E_{F}$ is constant throughout the entire sample, from bulk to surface. Therefore, $E_{F}(\\text{bulk}) = E_{F}(\\text{surface}) = E_{F}$.\n\nThe problem states that surface states pin the Fermi level at midgap at the surface. This implies:\n$$\nE_{F}(\\text{surface}) = E_{i}(\\text{surface})\n$$\nor simply, $E_{F} = E_{i}(\\text{surface})$. This means the energy difference between the Fermi level and the intrinsic level at the surface is zero:\n$$\nE_{F} - E_{i}(\\text{surface}) = 0\n$$\nNow we have two expressions involving $E_{F}$:\n1.  $E_{F} - E_{i}(\\text{bulk}) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)$\n2.  $E_{F} - E_{i}(\\text{surface}) = 0$\n\nSubtracting the second equation from the first yields:\n$$\n(E_{F} - E_{i}(\\text{bulk})) - (E_{F} - E_{i}(\\text{surface})) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right) - 0\n$$\n$$\nE_{i}(\\text{surface}) - E_{i}(\\text{bulk}) = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\nThe problem defines the surface potential $\\psi_{s}$ such that the energy band shift is $q\\psi_{s}$, where $q$ is the elementary charge. Specifically, $q\\psi_{s} = E_{i}(\\text{surface}) - E_{i}(\\text{bulk})$.\nSubstituting this definition into our derived relation gives:\n$$\nq \\psi_{s} = k_{B} T \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\nFrom this, we obtain the expression for the surface potential:\n$$\n\\psi_{s} = \\frac{k_{B} T}{q} \\ln\\left(\\frac{N_{D}}{n_{i}}\\right)\n$$\nThe term $\\frac{k_{B} T}{q}$ is the thermal voltage, $V_{th}$. Now we substitute the given numerical values:\n$N_{D} = 1.00 \\times 10^{17}\\,\\text{cm}^{-3}$\n$n_{i} = 1.00 \\times 10^{10}\\,\\text{cm}^{-3}$\n$T = 300\\,\\text{K}$\n$k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$\n$q = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n\nFirst, we calculate the thermal voltage:\n$$\nV_{th} = \\frac{k_{B} T}{q} = \\frac{(1.380649 \\times 10^{-23}\\,\\text{J/K})(300\\,\\text{K})}{1.602176634 \\times 10^{-19}\\,\\text{C}} \\approx 0.025852\\,\\text{V}\n$$\nNext, we calculate the logarithmic term:\n$$\n\\ln\\left(\\frac{N_{D}}{n_{i}}\\right) = \\ln\\left(\\frac{1.00 \\times 10^{17}}{1.00 \\times 10^{10}}\\right) = \\ln(10^{7}) = 7 \\ln(10) \\approx 16.1181\n$$\nFinally, we compute $\\psi_{s}$:\n$$\n\\psi_{s} = (0.025852\\,\\text{V}) \\times (16.1181) \\approx 0.41669\\,\\text{V}\n$$\nRounding to four significant figures, the surface potential is $\\psi_{s} = 0.4167\\,\\text{V}$. The positive value indicates upward band bending, consistent with depleting an $n$-type surface.\n\nPart 2: Determination of the contribution $\\Delta V_{\\mathrm{CPD}}$\n\nThe contact potential difference, $V_{\\mathrm{CPD}}$, is defined as:\n$$\nV_{\\mathrm{CPD}} = \\frac{\\Phi_{\\text{sample}} - \\Phi_{\\text{tip}}}{q}\n$$\nwhere $\\Phi_{\\text{tip}}$ and $\\Phi_{\\text{sample}}$ are the work functions of the KPFM tip and the sample, respectively.\n\nThe problem states that band bending increases the sample work function $\\Phi_{\\text{sample}}$ by $q\\psi_{s}$ relative to the flat-band case. Let $\\Phi_{\\text{sample,FB}}$ be the work function under flat-band conditions ($\\psi_{s}=0$). The work function in the presence of band bending is therefore:\n$$\n\\Phi_{\\text{sample}} = \\Phi_{\\text{sample,FB}} + q\\psi_{s}\n$$\nSubstituting this into the expression for $V_{\\mathrm{CPD}}$:\n$$\nV_{\\mathrm{CPD}} = \\frac{(\\Phi_{\\text{sample,FB}} + q\\psi_{s}) - \\Phi_{\\text{tip}}}{q} = \\frac{\\Phi_{\\text{sample,FB}} - \\Phi_{\\text{tip}}}{q} + \\frac{q\\psi_{s}}{q}\n$$\nThe first term, $\\frac{\\Phi_{\\text{sample,FB}} - \\Phi_{\\text{tip}}}{q}$, represents the contact potential difference that would be measured under flat-band conditions, let's call it $V_{\\mathrm{CPD,FB}}$. Thus:\n$$\nV_{\\mathrm{CPD}} = V_{\\mathrm{CPD,FB}} + \\psi_{s}\n$$\nThe contribution of band bending to $V_{\\mathrm{CPD}}$ is the difference between the actual $V_{\\mathrm{CPD}}$ and the flat-band value $V_{\\mathrm{CPD,FB}}$. This contribution is denoted as $\\Delta V_{\\mathrm{CPD}}$:\n$$\n\\Delta V_{\\mathrm{CPD}} = V_{\\mathrm{CPD}} - V_{\\mathrm{CPD,FB}} = (V_{\\mathrm{CPD,FB}} + \\psi_{s}) - V_{\\mathrm{CPD,FB}} = +\\psi_{s}\n$$\nThis contribution is indeed independent of the tip work function, as required.\n\nUsing the value of $\\psi_{s}$ calculated in Part 1:\n$$\n\\Delta V_{\\mathrm{CPD}} = +0.4167\\,\\text{V}\n$$\n\nThe two required quantities are the surface potential $\\psi_{s}$ and the contribution of band bending to the contact potential difference $\\Delta V_{\\mathrm{CPD}}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4167 & 0.4167\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While KPFM provides nanoscale potential maps, it is essential to understand the inherent limitations on its spatial resolution. This practice  models the KPFM measurement as a spatial convolution, exploring how the long-range nature of electrostatic forces can broaden the apparent features in an image, such as the edge of a p-n junction. Mastering this concept is key to accurately determining the true dimensions and potential profiles of nanoscale electronic devices from broadened KPFM data.",
            "id": "4283902",
            "problem": "A Kelvin probe force microscopy (KPFM) map of an abrupt silicon $p$-$n$ junction is acquired in frequency-modulated mode while the junction is held under a uniform reverse bias. The true contact potential difference (CPD) across the junction is an ideal step of amplitude $\\Delta \\phi$, located at $x=0$. Due to the nonlocal nature of the tip–sample electrostatic coupling and the bias-altered electrostatic environment of the junction, the measured CPD profile is broadened by a lateral convolution kernel determined by electrostatics. Assume:\n- The sample is crystalline silicon with relative permittivity $\\epsilon_{r}=11.7$.\n- The $p$-side and $n$-side doping densities are $N_{A}=6.5\\times 10^{23}\\,\\mathrm{m}^{-3}$ and $N_{D}=1.3\\times 10^{24}\\,\\mathrm{m}^{-3}$, respectively.\n- The built-in potential is $V_{\\mathrm{bi}}=0.85\\,\\mathrm{V}$ and the applied reverse bias across the junction is $V_{\\mathrm{app}}=2.15\\,\\mathrm{V}$.\n- The tip–sample separation is $z=14\\,\\mathrm{nm}$.\n- The lateral kernel can be modeled as a normalized Lorentzian whose effective half-width is the sum of the geometric separation and a fraction $\\eta$ of the depletion width, with $\\eta=0.45$.\n\nStarting from electrostatics and the depletion approximation for an abrupt $p$-$n$ junction, and using the definition of the KPFM signal as a linear spatial convolution of the true CPD with the normalized kernel, derive the bias-dependent apparent $10$–$90$ edge width $w_{10-90}(V_{\\mathrm{app}})$ of the measured CPD profile. Then, briefly propose a physically principled method to correct the broadened edge profile in $p$-$n$ junction CPD maps using the known kernel. Finally, compute the numerical value of $w_{10-90}(V_{\\mathrm{app}})$ for the parameters given above. Round your answer to three significant figures and express it in nanometers.",
            "solution": "The problem is scientifically grounded, well-posed, and contains sufficient information for a unique solution. It describes a realistic scenario in nanoelectronics characterization using Kelvin probe force microscopy (KPFM) and is free from any scientific or logical flaws. We may therefore proceed with a full derivation.\n\nThe problem asks for three things: first, a derivation of the apparent $10$–$90$ edge width of the measured Contact Potential Difference (CPD) profile across a reverse-biased $p$-$n$ junction; second, a proposal for a method to correct the profile broadening; and third, a numerical calculation of this width for the given parameters.\n\nThe core of the problem lies in the convolution of the true CPD profile with a resolution kernel. The measured CPD, $\\phi_{\\text{meas}}(x)$, is given by the convolution of the true CPD, $\\phi_{\\text{true}}(x)$, with the lateral response kernel, $L(x)$:\n$$ \\phi_{\\text{meas}}(x) = (\\phi_{\\text{true}} * L)(x) = \\int_{-\\infty}^{\\infty} \\phi_{\\text{true}}(x') L(x - x') dx' $$\nThe true CPD is modeled as an ideal step function of amplitude $\\Delta\\phi$ at $x=0$. We can write this using the Heaviside step function $H(x)$:\n$$ \\phi_{\\text{true}}(x) = \\phi_{\\text{offset}} + \\Delta\\phi \\cdot H(x) $$\nThe constant offset $\\phi_{\\text{offset}}$ does not affect the shape or width of the transition, so for simplicity we set it to $0$. The kernel $L(x)$ is a normalized Lorentzian function with an effective half-width at half-maximum (HWHM), which we shall denote $\\gamma_{\\text{eff}}$:\n$$ L(x) = \\frac{1}{\\pi} \\frac{\\gamma_{\\text{eff}}}{x^2 + \\gamma_{\\text{eff}}^2} $$\nThe problem states that this effective half-width is the sum of the tip-sample separation, $z$, and a fraction, $\\eta$, of the total depletion width, $W$, of the $p$-$n$ junction:\n$$ \\gamma_{\\text{eff}}(V_{\\text{app}}) = z + \\eta W(V_{\\text{app}}) $$\nThe dependence on the applied reverse bias, $V_{\\text{app}}$, enters through the depletion width $W$. For an abrupt $p$-$n$ junction, the depletion approximation gives the total depletion width as:\n$$ W(V_{\\text{app}}) = \\sqrt{\\frac{2 \\epsilon_s}{e} \\left( \\frac{1}{N_A} + \\frac{1}{N_D} \\right) (V_{\\text{bi}} + V_{\\text{app}})} $$\nHere, $\\epsilon_s = \\epsilon_r \\epsilon_0$ is the permittivity of silicon, $e$ is the elementary charge, $N_A$ and $N_D$ are the acceptor and donor doping concentrations, $V_{\\text{bi}}$ is the built-in potential, and $V_{\\text{app}}$ is the magnitude of the applied reverse bias voltage.\n\nNow, we perform the convolution. The measured profile is:\n$$ \\phi_{\\text{meas}}(x) = \\int_{-\\infty}^{\\infty} \\Delta\\phi H(x') \\left( \\frac{1}{\\pi} \\frac{\\gamma_{\\text{eff}}}{(x-x')^2 + \\gamma_{\\text{eff}}^2} \\right) dx' $$\nSince $H(x')=0$ for $x'<0$ and $H(x')=1$ for $x'>0$, the integral becomes:\n$$ \\phi_{\\text{meas}}(x) = \\frac{\\Delta\\phi}{\\pi} \\int_{0}^{\\infty} \\frac{\\gamma_{\\text{eff}}}{(x-x')^2 + \\gamma_{\\text{eff}}^2} dx' $$\nLet $u = x - x'$, so $du = -dx'$. The integration limits are $x$ (for $x'=0$) and $-\\infty$ (for $x'=\\infty$).\n$$ \\phi_{\\text{meas}}(x) = \\frac{\\Delta\\phi}{\\pi} \\int_{x}^{-\\infty} \\frac{\\gamma_{\\text{eff}}}{u^2 + \\gamma_{\\text{eff}}^2} (-du) = \\frac{\\Delta\\phi}{\\pi} \\int_{-\\infty}^{x} \\frac{\\gamma_{\\text{eff}}}{u^2 + \\gamma_{\\text{eff}}^2} du $$\nThe integral of the Lorentzian is the arctangent function:\n$$ \\phi_{\\text{meas}}(x) = \\frac{\\Delta\\phi}{\\pi} \\left[ \\arctan\\left(\\frac{u}{\\gamma_{\\text{eff}}}\\right) \\right]_{-\\infty}^{x} = \\frac{\\Delta\\phi}{\\pi} \\left[ \\arctan\\left(\\frac{x}{\\gamma_{\\text{eff}}}\\right) - \\left(-\\frac{\\pi}{2}\\right) \\right] $$\n$$ \\phi_{\\text{meas}}(x) = \\Delta\\phi \\left( \\frac{1}{2} + \\frac{1}{\\pi} \\arctan\\left(\\frac{x}{\\gamma_{\\text{eff}}}\\right) \\right) $$\nThis expression describes the measured, broadened CPD profile. It varies from $0$ at $x \\to -\\infty$ to $\\Delta\\phi$ at $x \\to \\infty$.\n\nThe $10$–$90$ edge width, $w_{10-90}$, is defined as $x_{90} - x_{10}$, where $x_{10}$ and $x_{90}$ are the positions where the signal reaches $10\\%$ and $90\\%$ of its final value, respectively.\nFor the $10\\%$ point, $\\phi_{\\text{meas}}(x_{10}) = 0.1 \\Delta\\phi$:\n$$ 0.1 \\Delta\\phi = \\Delta\\phi \\left( \\frac{1}{2} + \\frac{1}{\\pi} \\arctan\\left(\\frac{x_{10}}{\\gamma_{\\text{eff}}}\\right) \\right) \\implies -0.4 = \\frac{1}{\\pi} \\arctan\\left(\\frac{x_{10}}{\\gamma_{\\text{eff}}}\\right) $$\n$$ x_{10} = \\gamma_{\\text{eff}} \\tan(-0.4\\pi) = -\\gamma_{\\text{eff}} \\tan(0.4\\pi) $$\nFor the $90\\%$ point, $\\phi_{\\text{meas}}(x_{90}) = 0.9 \\Delta\\phi$:\n$$ 0.9 \\Delta\\phi = \\Delta\\phi \\left( \\frac{1}{2} + \\frac{1}{\\pi} \\arctan\\left(\\frac{x_{90}}{\\gamma_{\\text{eff}}}\\right) \\right) \\implies 0.4 = \\frac{1}{\\pi} \\arctan\\left(\\frac{x_{90}}{\\gamma_{\\text{eff}}}\\right) $$\n$$ x_{90} = \\gamma_{\\text{eff}} \\tan(0.4\\pi) $$\nThe edge width is therefore:\n$$ w_{10-90} = x_{90} - x_{10} = \\gamma_{\\text{eff}} \\tan(0.4\\pi) - (-\\gamma_{\\text{eff}} \\tan(0.4\\pi)) = 2 \\gamma_{\\text{eff}} \\tan(0.4\\pi) $$\nSubstituting the expressions for $\\gamma_{\\text{eff}}$ and $W(V_{\\text{app}})$ yields the final derived expression for the bias-dependent apparent edge width:\n$$ w_{10-90}(V_{\\text{app}}) = 2 \\tan(0.4\\pi) \\left( z + \\eta \\sqrt{\\frac{2 \\epsilon_r \\epsilon_0}{e} \\left( \\frac{1}{N_A} + \\frac{1}{N_D} \\right) (V_{\\text{bi}} + V_{\\text{app}})} \\right) $$\n\nFor the second task, a physically principled method to correct the broadened profile is through deconvolution. Since the measurement process is modeled as a linear spatial convolution $\\phi_{\\text{meas}} = \\phi_{\\text{true}} * L$, one can recover an estimate of the true profile $\\phi_{\\text{true}}$ by inverting this operation. By the convolution theorem, the Fourier transform of the measured data, $\\Phi_{\\text{meas}}(k)$, is the product of the Fourier transforms of the true profile, $\\Phi_{\\text{true}}(k)$, and the kernel, $\\hat{L}(k)$. The correction procedure is thus:\n1.  Compute the Fourier transform of the measured KPFM line profile, $\\Phi_{\\text{meas}}(k) = \\mathcal{F}\\{\\phi_{\\text{meas}}(x)\\}$.\n2.  Analytically construct the Fourier transform of the known Lorentzian kernel, which is $\\hat{L}(k) = \\exp(-2\\pi\\gamma_{\\text{eff}}|k|)$. The parameter $\\gamma_{\\text{eff}}$ is calculated from the known experimental conditions.\n3.  Obtain the Fourier transform of the true profile by division in the frequency domain: $\\Phi_{\\text{true}}(k) = \\Phi_{\\text{meas}}(k) / \\hat{L}(k)$.\n4.  The corrected profile is obtained by applying the inverse Fourier transform: $\\phi_{\\text{true, corrected}}(x) = \\mathcal{F}^{-1}\\{\\Phi_{\\text{true}}(k)\\}$.\nIn any real experiment, noise is present. Direct division would cause catastrophic noise amplification at high spatial frequencies $k$ where $\\hat{L}(k)$ becomes very small. Therefore, a regularized deconvolution, such as a Wiener filter, must be employed. This filter optimally balances inverse filtering with noise suppression based on the signal-to-noise ratio at each frequency.\n\nFinally, we compute the numerical value of $w_{10-90}$ for the given parameters:\n- $N_A = 6.5 \\times 10^{23}\\,\\mathrm{m}^{-3}$\n- $N_D = 1.3 \\times 10^{24}\\,\\mathrm{m}^{-3}$\n- $\\epsilon_r = 11.7$\n- $V_{\\text{bi}} = 0.85\\,\\mathrm{V}$\n- $V_{\\text{app}} = 2.15\\,\\mathrm{V}$\n- $z = 14\\,\\mathrm{nm} = 1.4 \\times 10^{-8}\\,\\mathrm{m}$\n- $\\eta = 0.45$\nWe use the fundamental constants $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$ and $\\epsilon_0 = 8.854 \\times 10^{-12}\\,\\mathrm{F/m}$.\n\nFirst, calculate the depletion width $W$. The permittivity of silicon is $\\epsilon_s = \\epsilon_r \\epsilon_0 = 11.7 \\times (8.854 \\times 10^{-12}) \\approx 1.036 \\times 10^{-10}\\,\\mathrm{F/m}$. The total potential is $V_{\\text{total}} = V_{\\text{bi}} + V_{\\text{app}} = 0.85 + 2.15 = 3.00\\,\\mathrm{V}$.\n$$ W = \\sqrt{\\frac{2 (1.036 \\times 10^{-10})}{1.602 \\times 10^{-19}} \\left( \\frac{1}{6.5 \\times 10^{23}} + \\frac{1}{1.3 \\times 10^{24}} \\right) (3.00)} $$\n$$ W = \\sqrt{(1.294 \\times 10^9) \\left( 1.538 \\times 10^{-24} + 0.769 \\times 10^{-24} \\right) (3.00)} $$\n$$ W = \\sqrt{(1.294 \\times 10^9) (2.307 \\times 10^{-24}) (3.00)} = \\sqrt{8.95 \\times 10^{-15}}\\,\\mathrm{m} \\approx 9.46 \\times 10^{-8}\\,\\mathrm{m} = 94.6\\,\\mathrm{nm} $$\nNext, calculate the effective kernel half-width $\\gamma_{\\text{eff}}$:\n$$ \\gamma_{\\text{eff}} = z + \\eta W = 14\\,\\mathrm{nm} + 0.45 \\times 94.6\\,\\mathrm{nm} = 14 + 42.57\\,\\mathrm{nm} \\approx 56.57\\,\\mathrm{nm} $$\nFinally, calculate the $10$–$90$ edge width $w_{10-90}$:\nThe constant factor is $2 \\tan(0.4\\pi) = 2 \\tan(72^\\circ) \\approx 2 \\times 3.0777 = 6.1554$.\n$$ w_{10-90} = 2 \\tan(0.4\\pi) \\times \\gamma_{\\text{eff}} \\approx 6.1554 \\times 56.57\\,\\mathrm{nm} \\approx 348.24\\,\\mathrm{nm} $$\nRounding to three significant figures, the apparent edge width is $348\\,\\mathrm{nm}$.",
            "answer": "$$\n\\boxed{348}\n$$"
        },
        {
            "introduction": "Analytical models for the KPFM signal are invaluable for building intuition, but they are often insufficient for real-world samples with complex topographies and material compositions. This computational exercise  guides you in constructing a numerical model of the tip-sample capacitance derivative, $C'(z)$, from first principles. By discretizing the interaction, you can simulate the KPFM signal for surfaces with arbitrary roughness or patterning, providing a powerful tool for both predicting experimental outcomes and interpreting complex datasets.",
            "id": "4283915",
            "problem": "Consider Kelvin Probe Force Microscopy (KPFM), which measures the electrostatic interaction between a conductive tip and a sample to infer local contact potential differences. In amplitude-modulation modes, the signal depends on the derivative of the tip–sample capacitance with respect to the vertical separation. Let $C(z)$ denote the tip–sample capacitance at separation $z$ and $C'(z) = \\frac{\\partial C}{\\partial z}$ its vertical derivative. For rough or patterned samples and nontrivial tip geometries, analytical approximations that assume smooth, planar surfaces and simple shapes can be inaccurate.\n\nStarting from electrostatics and the definitions of capacitance, energy, and boundary conditions, design a numerical estimator for $C'(z)$ for an axisymmetric spherical tip placed above a sample with possibly rough or patterned surface topography and an optional dielectric overlayer. In the estimator, construct the local gap as a function of lateral coordinates $(x,y)$ using a paraxial approximation for the spherical tip apex. Let the local sample topography be represented by a scalar field $r(x,y)$, and if a dielectric film of thickness $t$ with relative permittivity $\\varepsilon_r$ is present, incorporate its effect by an effective series gap. Your estimator must discretize the lateral domain into finite area elements (rectangular elements of uniform size), aggregate local contributions, and return the signed value of $C'(z)$ in $\\mathrm{F/m}$.\n\nYou must also include a baseline analytical computation for the smooth, planar sample case with a spherical tip apex from first principles, and compare the numerical estimator to this baseline in one of the test cases by reporting the relative deviation as a unitless float. Provide a scientifically sound discussion in your solution about when analytical models fail and how a finite element strategy would address those limitations, but your program should implement the finite-area discretization described above.\n\nFundamental bases you may use include: Gauss’s law, electrostatic boundary conditions, the definition of capacitance $C = Q/V$, and electrostatic energy $U = \\frac{1}{2} C V^2$ under constant applied potential $V$. You must not assume any specialized shortcut formulas without derivation in your solution.\n\nAdopt the following modeling assumptions for your program:\n- The tip apex is approximated locally as a spherical surface of radius $R$; near the apex, the tip–sample gap contribution from tip curvature is $h_{\\mathrm{tip}}(x,y) \\approx \\frac{x^2 + y^2}{2R}$.\n- The effective local gap is $h_{\\mathrm{eff}}(x,y) = z + h_{\\mathrm{tip}}(x,y) - r(x,y) + \\frac{t}{\\varepsilon_r}$ for a dielectric film; if no film is present, take $t = 0$ and $\\varepsilon_r = 1$.\n- To avoid unphysical singularities, enforce a minimum effective gap $h_{\\min}$ such that $h_{\\mathrm{eff}}(x,y) \\ge h_{\\min}$ everywhere.\n- Use vacuum permittivity $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}$.\n- Discretize the lateral domain on a square of side $2L$, centered at the apex, with $N_x \\times N_y$ uniform elements; mid-point integration over elements is acceptable.\n- The final $C'(z)$ estimate must be computed by aggregating the local contributions over all elements and returned as a signed value in $\\mathrm{F/m}$.\n\nTest Suite:\nUse the following four test cases, each specified by $(R, z, r(x,y) \\text{ type and parameters}, t, \\varepsilon_r, L \\text{ scaling}, N_x, N_y, h_{\\min})$. All lengths must be in meters, and $C'(z)$ must be returned in $\\mathrm{F/m}$.\n\n1. Smooth planar baseline:\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - $r(x,y) = 0$ everywhere\n   - $t = 0$, $\\varepsilon_r = 1$\n   - Domain scaling: set $L = K \\sqrt{2 R z}$ with $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   Output the relative deviation between the numerical estimate and the smooth baseline analytic value, as a unitless float.\n\n2. Sinusoidal roughness:\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - $r(x,y) = A \\sin\\left(2\\pi x/\\lambda_x\\right) \\sin\\left(2\\pi y/\\lambda_y\\right)$ with $A = 1 \\times 10^{-9}$, $\\lambda_x = 20 \\times 10^{-9}$, $\\lambda_y = 20 \\times 10^{-9}$\n   - $t = 0$, $\\varepsilon_r = 1$\n   - $L = K \\sqrt{2 R z}$ with $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   Output the signed value of $C'(z)$ in $\\mathrm{F/m}$.\n\n3. Patterned trench:\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - $r(x,y) = -d$ for $\\lvert x \\rvert \\le w/2$ and $r(x,y) = 0$ otherwise, with $d = 3 \\times 10^{-9}$ and $w = 20 \\times 10^{-9}$\n   - $t = 0$, $\\varepsilon_r = 1$\n   - $L = K \\sqrt{2 R z}$ with $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   Output the signed value of $C'(z)$ in $\\mathrm{F/m}$.\n\n4. Dielectric overlayer with mild roughness:\n   - $R = 30 \\times 10^{-9}$\n   - $z = 5 \\times 10^{-9}$\n   - $r(x,y) = A \\sin\\left(2\\pi x/\\lambda_x\\right) \\sin\\left(2\\pi y/\\lambda_y\\right)$ with $A = 0.5 \\times 10^{-9}$, $\\lambda_x = 20 \\times 10^{-9}$, $\\lambda_y = 20 \\times 10^{-9}$\n   - Dielectric film thickness $t = 3 \\times 10^{-9}$, relative permittivity $\\varepsilon_r = 3.9$\n   - $L = K \\sqrt{2 R z}$ with $K = 8$\n   - $N_x = 600$, $N_y = 600$\n   - $h_{\\min} = 0.2 \\times 10^{-9}$\n   Output the signed value of $C'(z)$ in $\\mathrm{F/m}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the test cases, i.e., $[r_1,r_2,r_3,r_4]$, where $r_1$ is the unitless relative deviation for Case 1, and $r_2$, $r_3$, $r_4$ are the signed values of $C'(z)$ in $\\mathrm{F/m}$. No other text should be printed.",
            "solution": "The problem requires the design of a numerical estimator for the vertical derivative of the tip-sample capacitance, $C'(z) = \\frac{\\partial C}{\\partial z}$, in the context of Kelvin Probe Force Microscopy (KPFM). This value is crucial as it is directly related to the electrostatic force gradient measured in amplitude-modulation AFM modes. We will first derive the governing equations from fundamental electrostatic principles, then formulate a numerical solution based on a finite-area discretization, derive a companion analytical model for a baseline case, and finally discuss the model's scope and limitations.\n\nThe electrostatic energy stored in the tip-sample capacitor is given by $U = \\frac{1}{2} C V^2$, where $C$ is the capacitance and $V$ is the applied potential difference. The vertical component of the electrostatic force on the tip is the negative gradient of this energy with respect to the vertical separation $z$:\n$$F_z = -\\frac{\\partial U}{\\partial z} = -\\frac{\\partial}{\\partial z} \\left( \\frac{1}{2} C(z) V^2 \\right)$$\nAssuming the applied voltage $V$ is constant, the force becomes:\n$$F_z = -\\frac{1}{2} V^2 \\frac{\\partial C(z)}{\\partial z} = -\\frac{1}{2} V^2 C'(z)$$\nThe KPFM signal is proportional to this force or its gradient, making $C'(z)$ the central quantity of interest.\n\nTo model the capacitance $C(z)$, we employ a common approximation that treats the tip-sample system as a continuum of infinitesimal parallel-plate capacitors. Each elemental area $dA = dx\\,dy$ on the sample surface forms a capacitor with the corresponding area on the tip. The total capacitance is the sum of these elemental contributions, as they are all connected in parallel to the same potential source. The capacitance of an elemental parallel-plate capacitor is given by $dC = \\frac{\\varepsilon dA}{h}$, where $\\varepsilon$ is the permittivity of the medium and $h$ is the separation.\n\nIn our model, the local effective gap $h_{\\mathrm{eff}}(x,y)$ between the tip and the sample at lateral coordinates $(x,y)$ accounts for several factors: the nominal separation $z$, the tip's curvature, the sample's topography, and a potential dielectric film on the sample. The total effective gap is given as:\n$$h_{\\mathrm{eff}}(x,y) = z + h_{\\mathrm{tip}}(x,y) - r(x,y) + \\frac{t}{\\varepsilon_r}$$\nHere, $z$ is the minimum separation between the tip apex and the highest point of the sample datum plane. The term $h_{\\mathrm{tip}}(x,y) \\approx \\frac{x^2+y^2}{2R}$ represents the additional gap due to the curvature of the spherical tip of radius $R$ under a paraxial approximation. The function $r(x,y)$ describes the local surface height of the sample relative to a reference plane. The term $\\frac{t}{\\varepsilon_r}$ accounts for a dielectric film of thickness $t$ and relative permittivity $\\varepsilon_r$. This term arises from treating the vacuum gap and the dielectric layer as two capacitors in series. For an elemental area $dA$, the series capacitance is $dC = \\left( \\frac{h_{\\mathrm{vac}}}{\\varepsilon_0 dA} + \\frac{t}{\\varepsilon_r \\varepsilon_0 dA} \\right)^{-1} = \\frac{\\varepsilon_0 dA}{h_{\\mathrm{vac}} + t/\\varepsilon_r}$, where $h_{\\mathrm{vac}} = z + h_{\\mathrm{tip}}(x,y) - r(x,y)$. This confirms the expression for the effective gap where the medium is vacuum with permittivity $\\varepsilon_0$.\n\nThe total capacitance is the integral of the elemental contributions over the interaction area:\n$$C(z) = \\iint_A dC = \\iint_A \\frac{\\varepsilon_0}{h_{\\mathrm{eff}}(x,y)} dx\\,dy$$\nTo find $C'(z)$, we differentiate this expression with respect to $z$. Since the integration domain is independent of $z$, we can move the derivative inside the integral:\n$$C'(z) = \\frac{\\partial}{\\partial z} \\iint_A \\frac{\\varepsilon_0}{h_{\\mathrm{eff}}(x,y)} dx\\,dy = \\iint_A \\varepsilon_0 \\frac{\\partial}{\\partial z} \\left( \\frac{1}{h_{\\mathrm{eff}}(x,y)} \\right) dx\\,dy$$\nUsing the chain rule, $\\frac{\\partial}{\\partial z} (h_{\\mathrm{eff}}^{-1}) = -h_{\\mathrm{eff}}^{-2} \\frac{\\partial h_{\\mathrm{eff}}}{\\partial z}$. From the definition of $h_{\\mathrm{eff}}(x,y)$, we see that $\\frac{\\partial h_{\\mathrm{eff}}}{\\partial z} = 1$. Substituting this back gives the final integral expression for the capacitance derivative:\n$$C'(z) = -\\varepsilon_0 \\iint_A \\frac{1}{[h_{\\mathrm{eff}}(x,y)]^2} dx\\,dy$$\nThis expression serves as the basis for our numerical estimator. A negative sign is expected, as capacitance increases when separation decreases.\n\nFor the baseline case of a smooth, planar sample ($r(x,y)=0$) with no dielectric ($t=0, \\varepsilon_r=1$), we can derive an analytical solution. The effective gap simplifies to $h_{\\mathrm{eff}}(x,y) = z + \\frac{x^2+y^2}{2R}$. We convert the integral for $C'(z)$ to polar coordinates $(\\rho, \\phi)$, where $\\rho^2 = x^2+y^2$ and $dx\\,dy = \\rho\\,d\\rho\\,d\\phi$. The integration domain is taken over the entire plane ($\\rho$ from $0$ to $\\infty$) for the analytical model.\n$$C'_{\\mathrm{analytic}}(z) = -\\varepsilon_0 \\int_0^{2\\pi} \\int_0^\\infty \\frac{1}{(z + \\frac{\\rho^2}{2R})^2} \\rho\\,d\\rho\\,d\\phi = -2\\pi\\varepsilon_0 \\int_0^\\infty \\frac{\\rho}{(z + \\frac{\\rho^2}{2R})^2} d\\rho$$\nTo solve this integral, we use the substitution $u = z + \\frac{\\rho^2}{2R}$, which implies $du = \\frac{\\rho}{R} d\\rho$, or $\\rho\\,d\\rho = R\\,du$. The integration limits change from $\\rho=0 \\to u=z$ and $\\rho\\to\\infty \\to u\\to\\infty$.\n$$C'_{\\mathrm{analytic}}(z) = -2\\pi\\varepsilon_0 \\int_z^\\infty \\frac{R\\,du}{u^2} = -2\\pi\\varepsilon_0 R \\left[ -\\frac{1}{u} \\right]_z^\\infty = -2\\pi\\varepsilon_0 R \\left( 0 - \\left(-\\frac{1}{z}\\right) \\right)$$\nThis yields the well-known analytical result for the sphere-on-plane model within the paraxial approximation:\n$$C'_{\\mathrm{analytic}}(z) = -\\frac{2\\pi\\varepsilon_0 R}{z}$$\nThis result will be used to validate our numerical estimator in the first test case.\n\nThe numerical estimator is constructed by discretizing the integral for $C'(z)$. The integration domain is a square of side $2L$ centered at $(0,0)$, from $-L$ to $L$ in both $x$ and $y$. This domain is divided into an $N_x \\times N_y$ grid of rectangular elements, each with area $\\Delta A = \\Delta x \\Delta y = (\\frac{2L}{N_x})(\\frac{2L}{N_y})$. The integral is approximated by a Riemann sum using the midpoint rule:\n$$C'_{\\mathrm{numerical}}(z) \\approx \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} -\\frac{\\varepsilon_0}{[h_{\\mathrm{eff}}(x_i, y_j)]^2} \\Delta A$$\nwhere $(x_i, y_j)$ are the coordinates of the center of the $(i,j)$-th element. To prevent division by zero or unphysically small gaps, the calculated effective gap is regularized by enforcing a minimum value $h_{\\min}$: $h_{\\mathrm{eff}}(x_i, y_j) = \\max(h_{\\mathrm{eff, raw}}(x_i, y_j), h_{\\min})$.\n\nAnalytical models, like the one derived, are powerful but have significant limitations. They are only tractable for highly symmetric and idealized geometries, such as a perfect sphere over an infinite plane. They fail to accurately describe real-world scenarios involving:\n$1$. **Sample Roughness**: Arbitrary surface topography breaks the radial symmetry, making the integral for $C'(z)$ analytically intractable.\n$2$. **Patterned Nanostructures**: Samples in nanoelectronics often feature complex patterns like trenches, vias, or quantum dots, for which no simple analytical form of $h_{\\mathrm{eff}}(x,y)$ exists.\n$3$. **Complex Tip Geometry**: Real AFM tips are not perfect spheres and can have manufacturing defects, wear, or be intentionally shaped, invalidating the simple paraxial approximation.\n\nNumerical methods are essential to overcome these limitations. The finite-area discretization method implemented here is a first-order approach. It correctly captures the effect of complex topographies on the local gap distance. However, it still relies on the parallel-plate assumption for each element and neglects fringing fields, which is the electrostatic \"cross-talk\" between adjacent elements. A more advanced strategy, such as the Finite Element Method (FEM) or Boundary Element Method (BEM), would provide higher accuracy. These methods solve the Laplace equation $\\nabla^2V=0$ numerically within the tip-sample volume for the given boundary conditions. This directly computes the full electrostatic potential and field distribution, inherently accounting for arbitrary geometries and fringing field effects, at the cost of significantly higher computational complexity. Our chosen method provides a good balance between accuracy for complex topographies and computational feasibility.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the capacitance derivative C'(z) for various KPFM scenarios.\n    \"\"\"\n    \n    # Fundamental constant\n    EPSILON_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"smooth\"},\n            \"t\": 0.0, \"eps_r\": 1.0,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        },\n        {\n            \"case_id\": 2,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"sinusoidal\", \"A\": 1e-9, \"lambda_x\": 20e-9, \"lambda_y\": 20e-9},\n            \"t\": 0.0, \"eps_r\": 1.0,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        },\n        {\n            \"case_id\": 3,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"trench\", \"d\": 3e-9, \"w\": 20e-9},\n            \"t\": 0.0, \"eps_r\": 1.0,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        },\n        {\n            \"case_id\": 4,\n            \"R\": 30e-9, \"z\": 5e-9,\n            \"topo\": {\"type\": \"sinusoidal\", \"A\": 0.5e-9, \"lambda_x\": 20e-9, \"lambda_y\": 20e-9},\n            \"t\": 3e-9, \"eps_r\": 3.9,\n            \"K\": 8, \"Nx\": 600, \"Ny\": 600, \"h_min\": 0.2e-9\n        }\n    ]\n\n    results = []\n\n    for params in test_cases:\n        # Unpack parameters for clarity\n        R = params[\"R\"]\n        z = params[\"z\"]\n        t = params[\"t\"]\n        eps_r = params[\"eps_r\"]\n        K = params[\"K\"]\n        Nx = params[\"Nx\"]\n        Ny = params[\"Ny\"]\n        h_min = params[\"h_min\"]\n        \n        # Set up the spatial grid\n        L = K * np.sqrt(2 * R * z)\n        dx = 2 * L / Nx\n        dy = 2 * L / Ny\n        \n        # Create coordinate arrays representing the midpoints of grid cells\n        x_coords = np.linspace(-L + dx / 2, L - dx / 2, Nx)\n        y_coords = np.linspace(-L + dy / 2, L - dy / 2, Ny)\n        X, Y = np.meshgrid(x_coords, y_coords)\n        \n        # Calculate topography r(x,y)\n        topo_params = params[\"topo\"]\n        if topo_params[\"type\"] == \"smooth\":\n            r = np.zeros_like(X)\n        elif topo_params[\"type\"] == \"sinusoidal\":\n            A = topo_params[\"A\"]\n            lambda_x = topo_params[\"lambda_x\"]\n            lambda_y = topo_params[\"lambda_y\"]\n            r = A * np.sin(2 * np.pi * X / lambda_x) * np.sin(2 * np.pi * Y / lambda_y)\n        elif topo_params[\"type\"] == \"trench\":\n            d = topo_params[\"d\"]\n            w = topo_params[\"w\"]\n            r = np.where(np.abs(X) <= w / 2, -d, 0)\n\n        # Calculate the effective local gap, h_eff(x,y)\n        # 1. Tip curvature contribution\n        h_tip = (X**2 + Y**2) / (2 * R)\n        # 2. Dielectric film contribution\n        h_dielectric = t / eps_r\n        # 3. Total effective gap before regularization\n        h_eff_raw = z + h_tip - r + h_dielectric\n        \n        # Apply the minimum gap regularization\n        h_eff = np.maximum(h_eff_raw, h_min)\n        \n        # Calculate C'(z) using numerical integration (summation)\n        # The integrand is -epsilon_0 / h_eff^2\n        integrand = -EPSILON_0 / h_eff**2\n        \n        # The area of each elemental rectangle\n        dA = dx * dy\n        \n        C_prime_numerical = np.sum(integrand) * dA\n        \n        # Process output based on the test case\n        if params[\"case_id\"] == 1:\n            # Baseline case: compare with analytical result\n            # C'_analytic = -2 * pi * epsilon_0 * R / z\n            C_prime_analytic = -2 * np.pi * EPSILON_0 * R / z\n            # Relative deviation is |(numerical - analytical) / analytical|\n            relative_deviation = np.abs((C_prime_numerical - C_prime_analytic) / C_prime_analytic)\n            results.append(f\"{relative_deviation:.12f}\")\n        else:\n            # Other cases: output the signed value of C'(z)\n            results.append(f\"{C_prime_numerical:.12e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}